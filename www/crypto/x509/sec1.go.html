<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4300005">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4300060">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4300114">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4300165">package</span>&nbsp;<span class="ident" id="4300173">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4300179">import</span>&nbsp;<span class="op" id="4300186">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4300189">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4300205">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4300224">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4300241">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4300251">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4300258">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4300269">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4300272">const</span>&nbsp;<span class="ident" id="4300278">ecPrivKeyVersion</span>&nbsp;<span class="op" id="4300295">=</span>&nbsp;<span class="num" id="4300297">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4300300">//&nbsp;ecPrivateKey&nbsp;reflects&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="4300372">//&nbsp;References:</span><br>
<span class="lineno">20</span><span class="comment" id="4300387">//&nbsp;&nbsp;&nbsp;RFC5915</span><br>
<span class="lineno"></span><span class="comment" id="4300400">//&nbsp;&nbsp;&nbsp;SEC1&nbsp;-&nbsp;http://www.secg.org/download/aid-780/sec1-v2.pdf</span><br>
<span class="lineno"></span><span class="comment" id="4300461">//&nbsp;Per&nbsp;RFC5915&nbsp;the&nbsp;NamedCurveOID&nbsp;is&nbsp;marked&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL,&nbsp;however&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4300534">//&nbsp;most&nbsp;cases&nbsp;it&nbsp;is&nbsp;not.</span><br>
<span class="lineno"></span><span class="keyword" id="4300559">type</span>&nbsp;<span class="ident" id="4300564">ecPrivateKey</span>&nbsp;<span class="keyword" id="4300577">struct</span>&nbsp;<span class="op" id="4300584">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4300587">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4300601">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4300606">PrivateKey</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4300620">[</span><span class="op" id="4300621">]</span><span class="builtintype" id="4300622">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4300628">NamedCurveOID</span>&nbsp;<span class="ident" id="4300642"><a href="/crypto/x509/sec1.go.html#4300224">asn1</a></span><span class="op" id="4300646">.</span><span class="ident" id="4300647">ObjectIdentifier</span>&nbsp;<span class="string" id="4300664">`asn1:&#34;optional,explicit,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4300698">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4300712"><a href="/crypto/x509/sec1.go.html#4300224">asn1</a></span><span class="op" id="4300716">.</span><span class="ident" id="4300717">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4300734">`asn1:&#34;optional,explicit,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4300767">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="4300770">//&nbsp;ParseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="keyword" id="4300845">func</span>&nbsp;<span class="ident" id="4300850">ParseECPrivateKey</span><span class="op" id="4300867">(</span><span class="ident" id="4300868">der</span>&nbsp;<span class="op" id="4300872">[</span><span class="op" id="4300873">]</span><span class="builtintype" id="4300874">byte</span><span class="op" id="4300878">)</span>&nbsp;<span class="op" id="4300880">(</span><span class="ident" id="4300881">key</span>&nbsp;<span class="op" id="4300885">*</span><span class="ident" id="4300886"><a href="/crypto/x509/sec1.go.html#4300189">ecdsa</a></span><span class="op" id="4300891">.</span><span class="ident" id="4300892">PrivateKey</span><span class="op" id="4300902">,</span>&nbsp;<span class="ident" id="4300904">err</span>&nbsp;<span class="builtintype" id="4300908">error</span><span class="op" id="4300913">)</span>&nbsp;<span class="op" id="4300915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4300918">return</span>&nbsp;<span class="ident" id="4300925"><a href="/crypto/x509/sec1.go.html#4301690">parseECPrivateKey</a></span><span class="op" id="4300942">(</span><span class="ident" id="4300943">nil</span><span class="op" id="4300946">,</span>&nbsp;<span class="ident" id="4300948"><a href="/crypto/x509/sec1.go.html#4300868">der</a></span><span class="op" id="4300951">)</span><br>
<span class="lineno"></span><span class="op" id="4300953">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4300956">//&nbsp;MarshalECPrivateKey&nbsp;marshals&nbsp;an&nbsp;EC&nbsp;private&nbsp;key&nbsp;into&nbsp;ASN.1,&nbsp;DER&nbsp;format.</span><br>
<span class="lineno"></span><span class="keyword" id="4301030">func</span>&nbsp;<span class="ident" id="4301035">MarshalECPrivateKey</span><span class="op" id="4301054">(</span><span class="ident" id="4301055">key</span>&nbsp;<span class="op" id="4301059">*</span><span class="ident" id="4301060"><a href="/crypto/x509/sec1.go.html#4300189">ecdsa</a></span><span class="op" id="4301065">.</span><span class="ident" id="4301066">PrivateKey</span><span class="op" id="4301076">)</span>&nbsp;<span class="op" id="4301078">(</span><span class="op" id="4301079">[</span><span class="op" id="4301080">]</span><span class="builtintype" id="4301081">byte</span><span class="op" id="4301085">,</span>&nbsp;<span class="builtintype" id="4301087">error</span><span class="op" id="4301092">)</span>&nbsp;<span class="op" id="4301094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4301097">oid</span><span class="op" id="4301100">,</span>&nbsp;<span class="ident" id="4301102">ok</span>&nbsp;<span class="op" id="4301105">:=</span>&nbsp;<span class="ident" id="4301108"><a href="/crypto/x509/x509.go.html#4326546">oidFromNamedCurve</a></span><span class="op" id="4301125">(</span><span class="ident" id="4301126"><a href="/crypto/x509/sec1.go.html#4301055">key</a></span><span class="op" id="4301129">.</span><span class="ident" id="4301130">Curve</span><span class="op" id="4301135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4301138">if</span>&nbsp;<span class="op" id="4301141">!</span><span class="ident" id="4301142"><a href="/crypto/x509/sec1.go.html#4301102">ok</a></span>&nbsp;<span class="op" id="4301145">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4301149">return</span>&nbsp;<span class="ident" id="4301156">nil</span><span class="op" id="4301159">,</span>&nbsp;<span class="ident" id="4301161"><a href="/crypto/x509/sec1.go.html#4300241">errors</a></span><span class="op" id="4301167">.</span><span class="ident" id="4301168">New</span><span class="op" id="4301171">(</span><span class="string" id="4301172">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4301202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4301205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4301208">return</span>&nbsp;<span class="ident" id="4301215"><a href="/crypto/x509/sec1.go.html#4300224">asn1</a></span><span class="op" id="4301219">.</span><span class="ident" id="4301220">Marshal</span><span class="op" id="4301227">(</span><span class="ident" id="4301228"><a href="/crypto/x509/sec1.go.html#4300564">ecPrivateKey</a></span><span class="op" id="4301240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4301244">Version</span><span class="op" id="4301251">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4301259">1</span><span class="op" id="4301260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4301264">PrivateKey</span><span class="op" id="4301274">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4301279"><a href="/crypto/x509/sec1.go.html#4301055">key</a></span><span class="op" id="4301282">.</span><span class="ident" id="4301283">D</span><span class="op" id="4301284">.</span><span class="ident" id="4301285">Bytes</span><span class="op" id="4301290">(</span><span class="op" id="4301291">)</span><span class="op" id="4301292">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4301296">NamedCurveOID</span><span class="op" id="4301309">:</span>&nbsp;<span class="ident" id="4301311"><a href="/crypto/x509/sec1.go.html#4301097">oid</a></span><span class="op" id="4301314">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4301318">PublicKey</span><span class="op" id="4301327">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4301333"><a href="/crypto/x509/sec1.go.html#4300224">asn1</a></span><span class="op" id="4301337">.</span><span class="ident" id="4301338">BitString</span><span class="op" id="4301347">{</span><span class="ident" id="4301348">Bytes</span><span class="op" id="4301353">:</span>&nbsp;<span class="ident" id="4301355"><a href="/crypto/x509/sec1.go.html#4300205">elliptic</a></span><span class="op" id="4301363">.</span><span class="ident" id="4301364">Marshal</span><span class="op" id="4301371">(</span><span class="ident" id="4301372"><a href="/crypto/x509/sec1.go.html#4301055">key</a></span><span class="op" id="4301375">.</span><span class="ident" id="4301376">Curve</span><span class="op" id="4301381">,</span>&nbsp;<span class="ident" id="4301383"><a href="/crypto/x509/sec1.go.html#4301055">key</a></span><span class="op" id="4301386">.</span><span class="ident" id="4301387">X</span><span class="op" id="4301388">,</span>&nbsp;<span class="ident" id="4301390"><a href="/crypto/x509/sec1.go.html#4301055">key</a></span><span class="op" id="4301393">.</span><span class="ident" id="4301394">Y</span><span class="op" id="4301395">)</span><span class="op" id="4301396">}</span><span class="op" id="4301397">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4301400">}</span><span class="op" id="4301401">)</span><br>
<span class="lineno"></span><span class="op" id="4301403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="4301406">//&nbsp;parseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="4301481">//&nbsp;The&nbsp;OID&nbsp;for&nbsp;the&nbsp;named&nbsp;curve&nbsp;may&nbsp;be&nbsp;provided&nbsp;from&nbsp;another&nbsp;source&nbsp;(such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="4301557">//&nbsp;the&nbsp;PKCS8&nbsp;container)&nbsp;-&nbsp;if&nbsp;it&nbsp;is&nbsp;provided&nbsp;then&nbsp;use&nbsp;this&nbsp;instead&nbsp;of&nbsp;the&nbsp;OID</span><br>
<span class="lineno"></span><span class="comment" id="4301634">//&nbsp;that&nbsp;may&nbsp;exist&nbsp;in&nbsp;the&nbsp;EC&nbsp;private&nbsp;key&nbsp;structure.</span><br>
<span class="lineno"></span><span class="keyword" id="4301685">func</span>&nbsp;<span class="ident" id="4301690">parseECPrivateKey</span><span class="op" id="4301707">(</span><span class="ident" id="4301708">namedCurveOID</span>&nbsp;<span class="op" id="4301722">*</span><span class="ident" id="4301723"><a href="/crypto/x509/sec1.go.html#4300224">asn1</a></span><span class="op" id="4301727">.</span><span class="ident" id="4301728">ObjectIdentifier</span><span class="op" id="4301744">,</span>&nbsp;<span class="ident" id="4301746">der</span>&nbsp;<span class="op" id="4301750">[</span><span class="op" id="4301751">]</span><span class="builtintype" id="4301752">byte</span><span class="op" id="4301756">)</span>&nbsp;<span class="op" id="4301758">(</span><span class="ident" id="4301759">key</span>&nbsp;<span class="op" id="4301763">*</span><span class="ident" id="4301764"><a href="/crypto/x509/sec1.go.html#4300189">ecdsa</a></span><span class="op" id="4301769">.</span><span class="ident" id="4301770">PrivateKey</span><span class="op" id="4301780">,</span>&nbsp;<span class="ident" id="4301782">err</span>&nbsp;<span class="builtintype" id="4301786">error</span><span class="op" id="4301791">)</span>&nbsp;<span class="op" id="4301793">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4301796">var</span>&nbsp;<span class="ident" id="4301800">privKey</span>&nbsp;<span class="ident" id="4301808"><a href="/crypto/x509/sec1.go.html#4300564">ecPrivateKey</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4301822">if</span>&nbsp;<span class="ident" id="4301825">_</span><span class="op" id="4301826">,</span>&nbsp;<span class="ident" id="4301828">err</span>&nbsp;<span class="op" id="4301832">:=</span>&nbsp;<span class="ident" id="4301835"><a href="/crypto/x509/sec1.go.html#4300224">asn1</a></span><span class="op" id="4301839">.</span><span class="ident" id="4301840">Unmarshal</span><span class="op" id="4301849">(</span><span class="ident" id="4301850"><a href="/crypto/x509/sec1.go.html#4301746">der</a></span><span class="op" id="4301853">,</span>&nbsp;<span class="op" id="4301855">&amp;</span><span class="ident" id="4301856"><a href="/crypto/x509/sec1.go.html#4301800">privKey</a></span><span class="op" id="4301863">)</span><span class="op" id="4301864">;</span>&nbsp;<span class="ident" id="4301866"><a href="/crypto/x509/sec1.go.html#4301828">err</a></span>&nbsp;<span class="op" id="4301870">!=</span>&nbsp;<span class="ident" id="4301873">nil</span>&nbsp;<span class="op" id="4301877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4301881">return</span>&nbsp;<span class="ident" id="4301888">nil</span><span class="op" id="4301891">,</span>&nbsp;<span class="ident" id="4301893"><a href="/crypto/x509/sec1.go.html#4300241">errors</a></span><span class="op" id="4301899">.</span><span class="ident" id="4301900">New</span><span class="op" id="4301903">(</span><span class="string" id="4301904">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;EC&nbsp;private&nbsp;key:&nbsp;&#34;</span>&nbsp;<span class="op" id="4301945">+</span>&nbsp;<span class="ident" id="4301947"><a href="/crypto/x509/sec1.go.html#4301828">err</a></span><span class="op" id="4301950">.</span><span class="ident" id="4301951">Error</span><span class="op" id="4301956">(</span><span class="op" id="4301957">)</span><span class="op" id="4301958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4301961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4301964">if</span>&nbsp;<span class="ident" id="4301967"><a href="/crypto/x509/sec1.go.html#4301800">privKey</a></span><span class="op" id="4301974">.</span><span class="ident" id="4301975">Version</span>&nbsp;<span class="op" id="4301983">!=</span>&nbsp;<span class="ident" id="4301986"><a href="/crypto/x509/sec1.go.html#4300278">ecPrivKeyVersion</a></span>&nbsp;<span class="op" id="4302003">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4302007">return</span>&nbsp;<span class="ident" id="4302014">nil</span><span class="op" id="4302017">,</span>&nbsp;<span class="ident" id="4302019"><a href="/crypto/x509/sec1.go.html#4300251">fmt</a></span><span class="op" id="4302022">.</span><span class="ident" id="4302023">Errorf</span><span class="op" id="4302029">(</span><span class="string" id="4302030">&#34;x509:&nbsp;unknown&nbsp;EC&nbsp;private&nbsp;key&nbsp;version&nbsp;%d&#34;</span><span class="op" id="4302071">,</span>&nbsp;<span class="ident" id="4302073"><a href="/crypto/x509/sec1.go.html#4301800">privKey</a></span><span class="op" id="4302080">.</span><span class="ident" id="4302081">Version</span><span class="op" id="4302088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4302091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4302095">var</span>&nbsp;<span class="ident" id="4302099">curve</span>&nbsp;<span class="ident" id="4302105"><a href="/crypto/x509/sec1.go.html#4300205">elliptic</a></span><span class="op" id="4302113">.</span><span class="ident" id="4302114">Curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4302121">if</span>&nbsp;<span class="ident" id="4302124"><a href="/crypto/x509/sec1.go.html#4301708">namedCurveOID</a></span>&nbsp;<span class="op" id="4302138">!=</span>&nbsp;<span class="ident" id="4302141">nil</span>&nbsp;<span class="op" id="4302145">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4302149"><a href="/crypto/x509/sec1.go.html#4302099">curve</a></span>&nbsp;<span class="op" id="4302155">=</span>&nbsp;<span class="ident" id="4302157"><a href="/crypto/x509/x509.go.html#4326207">namedCurveFromOID</a></span><span class="op" id="4302174">(</span><span class="op" id="4302175">*</span><span class="ident" id="4302176"><a href="/crypto/x509/sec1.go.html#4301708">namedCurveOID</a></span><span class="op" id="4302189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4302192">}</span>&nbsp;<span class="keyword" id="4302194">else</span>&nbsp;<span class="op" id="4302199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4302203"><a href="/crypto/x509/sec1.go.html#4302099">curve</a></span>&nbsp;<span class="op" id="4302209">=</span>&nbsp;<span class="ident" id="4302211"><a href="/crypto/x509/x509.go.html#4326207">namedCurveFromOID</a></span><span class="op" id="4302228">(</span><span class="ident" id="4302229"><a href="/crypto/x509/sec1.go.html#4301800">privKey</a></span><span class="op" id="4302236">.</span><span class="ident" id="4302237">NamedCurveOID</span><span class="op" id="4302250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4302253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4302256">if</span>&nbsp;<span class="ident" id="4302259"><a href="/crypto/x509/sec1.go.html#4302099">curve</a></span>&nbsp;<span class="op" id="4302265">==</span>&nbsp;<span class="ident" id="4302268">nil</span>&nbsp;<span class="op" id="4302272">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4302276">return</span>&nbsp;<span class="ident" id="4302283">nil</span><span class="op" id="4302286">,</span>&nbsp;<span class="ident" id="4302288"><a href="/crypto/x509/sec1.go.html#4300241">errors</a></span><span class="op" id="4302294">.</span><span class="ident" id="4302295">New</span><span class="op" id="4302298">(</span><span class="string" id="4302299">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4302329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4302332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4302336">k</span>&nbsp;<span class="op" id="4302338">:=</span>&nbsp;<span class="builtinfunc" id="4302341">new</span><span class="op" id="4302344">(</span><span class="ident" id="4302345"><a href="/crypto/x509/sec1.go.html#4300258">big</a></span><span class="op" id="4302348">.</span><span class="ident" id="4302349">Int</span><span class="op" id="4302352">)</span><span class="op" id="4302353">.</span><span class="ident" id="4302354">SetBytes</span><span class="op" id="4302362">(</span><span class="ident" id="4302363"><a href="/crypto/x509/sec1.go.html#4301800">privKey</a></span><span class="op" id="4302370">.</span><span class="ident" id="4302371">PrivateKey</span><span class="op" id="4302381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4302384">if</span>&nbsp;<span class="ident" id="4302387"><a href="/crypto/x509/sec1.go.html#4302336">k</a></span><span class="op" id="4302388">.</span><span class="ident" id="4302389">Cmp</span><span class="op" id="4302392">(</span><span class="ident" id="4302393"><a href="/crypto/x509/sec1.go.html#4302099">curve</a></span><span class="op" id="4302398">.</span><span class="ident" id="4302399">Params</span><span class="op" id="4302405">(</span><span class="op" id="4302406">)</span><span class="op" id="4302407">.</span><span class="ident" id="4302408">N</span><span class="op" id="4302409">)</span>&nbsp;<span class="op" id="4302411">&gt;=</span>&nbsp;<span class="num" id="4302414">0</span>&nbsp;<span class="op" id="4302416">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4302420">return</span>&nbsp;<span class="ident" id="4302427">nil</span><span class="op" id="4302430">,</span>&nbsp;<span class="ident" id="4302432"><a href="/crypto/x509/sec1.go.html#4300241">errors</a></span><span class="op" id="4302438">.</span><span class="ident" id="4302439">New</span><span class="op" id="4302442">(</span><span class="string" id="4302443">&#34;x509:&nbsp;invalid&nbsp;elliptic&nbsp;curve&nbsp;private&nbsp;key&nbsp;value&#34;</span><span class="op" id="4302491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4302494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4302497">priv</span>&nbsp;<span class="op" id="4302502">:=</span>&nbsp;<span class="builtinfunc" id="4302505">new</span><span class="op" id="4302508">(</span><span class="ident" id="4302509"><a href="/crypto/x509/sec1.go.html#4300189">ecdsa</a></span><span class="op" id="4302514">.</span><span class="ident" id="4302515">PrivateKey</span><span class="op" id="4302525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4302528"><a href="/crypto/x509/sec1.go.html#4302497">priv</a></span><span class="op" id="4302532">.</span><span class="ident" id="4302533">Curve</span>&nbsp;<span class="op" id="4302539">=</span>&nbsp;<span class="ident" id="4302541"><a href="/crypto/x509/sec1.go.html#4302099">curve</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4302548"><a href="/crypto/x509/sec1.go.html#4302497">priv</a></span><span class="op" id="4302552">.</span><span class="ident" id="4302553">D</span>&nbsp;<span class="op" id="4302555">=</span>&nbsp;<span class="ident" id="4302557"><a href="/crypto/x509/sec1.go.html#4302336">k</a></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4302560"><a href="/crypto/x509/sec1.go.html#4302497">priv</a></span><span class="op" id="4302564">.</span><span class="ident" id="4302565">X</span><span class="op" id="4302566">,</span>&nbsp;<span class="ident" id="4302568"><a href="/crypto/x509/sec1.go.html#4302497">priv</a></span><span class="op" id="4302572">.</span><span class="ident" id="4302573">Y</span>&nbsp;<span class="op" id="4302575">=</span>&nbsp;<span class="ident" id="4302577"><a href="/crypto/x509/sec1.go.html#4302099">curve</a></span><span class="op" id="4302582">.</span><span class="ident" id="4302583">ScalarBaseMult</span><span class="op" id="4302597">(</span><span class="ident" id="4302598"><a href="/crypto/x509/sec1.go.html#4301800">privKey</a></span><span class="op" id="4302605">.</span><span class="ident" id="4302606">PrivateKey</span><span class="op" id="4302616">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4302620">return</span>&nbsp;<span class="ident" id="4302627"><a href="/crypto/x509/sec1.go.html#4302497">priv</a></span><span class="op" id="4302631">,</span>&nbsp;<span class="ident" id="4302633">nil</span><br>
<span class="lineno"></span><span class="op" id="4302637">}</span>
</div>
</body>
</html>
