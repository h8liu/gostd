<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html" class="current">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3545097">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3545152">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3545206">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3545257">//&nbsp;+build&nbsp;amd64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3545274">package</span>&nbsp;<span class="ident" id="3545282">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3545287">//&nbsp;defined&nbsp;in&nbsp;asm_$GOARCH.s</span><br>
<span class="lineno">10</span><span class="keyword" id="3545315">func</span>&nbsp;<span class="ident" id="3545320">hasAsm</span><span class="op" id="3545326">(</span><span class="op" id="3545327">)</span>&nbsp;<span class="builtintype" id="3545329">bool</span><br>
<span class="lineno"></span><span class="keyword" id="3545334">func</span>&nbsp;<span class="ident" id="3545339">encryptBlockAsm</span><span class="op" id="3545354">(</span><span class="ident" id="3545355">nr</span>&nbsp;<span class="builtintype" id="3545358">int</span><span class="op" id="3545361">,</span>&nbsp;<span class="ident" id="3545363">xk</span>&nbsp;<span class="op" id="3545366">*</span><span class="builtintype" id="3545367">uint32</span><span class="op" id="3545373">,</span>&nbsp;<span class="ident" id="3545375">dst</span><span class="op" id="3545378">,</span>&nbsp;<span class="ident" id="3545380">src</span>&nbsp;<span class="op" id="3545384">*</span><span class="builtintype" id="3545385">byte</span><span class="op" id="3545389">)</span><br>
<span class="lineno"></span><span class="keyword" id="3545391">func</span>&nbsp;<span class="ident" id="3545396">decryptBlockAsm</span><span class="op" id="3545411">(</span><span class="ident" id="3545412">nr</span>&nbsp;<span class="builtintype" id="3545415">int</span><span class="op" id="3545418">,</span>&nbsp;<span class="ident" id="3545420">xk</span>&nbsp;<span class="op" id="3545423">*</span><span class="builtintype" id="3545424">uint32</span><span class="op" id="3545430">,</span>&nbsp;<span class="ident" id="3545432">dst</span><span class="op" id="3545435">,</span>&nbsp;<span class="ident" id="3545437">src</span>&nbsp;<span class="op" id="3545441">*</span><span class="builtintype" id="3545442">byte</span><span class="op" id="3545446">)</span><br>
<span class="lineno"></span><span class="keyword" id="3545448">func</span>&nbsp;<span class="ident" id="3545453">expandKeyAsm</span><span class="op" id="3545465">(</span><span class="ident" id="3545466">nr</span>&nbsp;<span class="builtintype" id="3545469">int</span><span class="op" id="3545472">,</span>&nbsp;<span class="ident" id="3545474">key</span>&nbsp;<span class="op" id="3545478">*</span><span class="builtintype" id="3545479">byte</span><span class="op" id="3545483">,</span>&nbsp;<span class="ident" id="3545485">enc</span>&nbsp;<span class="op" id="3545489">*</span><span class="builtintype" id="3545490">uint32</span><span class="op" id="3545496">,</span>&nbsp;<span class="ident" id="3545498">dec</span>&nbsp;<span class="op" id="3545502">*</span><span class="builtintype" id="3545503">uint32</span><span class="op" id="3545509">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3545512">var</span>&nbsp;<span class="ident" id="3545516">useAsm</span>&nbsp;<span class="op" id="3545523">=</span>&nbsp;<span class="ident" id="3545525">hasAsm</span><span class="op" id="3545531">(</span><span class="op" id="3545532">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3545535">func</span>&nbsp;<span class="ident" id="3545540">encryptBlock</span><span class="op" id="3545552">(</span><span class="ident" id="3545553">xk</span>&nbsp;<span class="op" id="3545556">[</span><span class="op" id="3545557">]</span><span class="builtintype" id="3545558">uint32</span><span class="op" id="3545564">,</span>&nbsp;<span class="ident" id="3545566">dst</span><span class="op" id="3545569">,</span>&nbsp;<span class="ident" id="3545571">src</span>&nbsp;<span class="op" id="3545575">[</span><span class="op" id="3545576">]</span><span class="builtintype" id="3545577">byte</span><span class="op" id="3545581">)</span>&nbsp;<span class="op" id="3545583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3545586">if</span>&nbsp;<span class="ident" id="3545589">useAsm</span>&nbsp;<span class="op" id="3545596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3545600">encryptBlockAsm</span><span class="op" id="3545615">(</span><span class="builtinfunc" id="3545616">len</span><span class="op" id="3545619">(</span><span class="ident" id="3545620">xk</span><span class="op" id="3545622">)</span><span class="op" id="3545623">/</span><span class="num" id="3545624">4</span><span class="op" id="3545625">-</span><span class="num" id="3545626">1</span><span class="op" id="3545627">,</span>&nbsp;<span class="op" id="3545629">&amp;</span><span class="ident" id="3545630">xk</span><span class="op" id="3545632">[</span><span class="num" id="3545633">0</span><span class="op" id="3545634">]</span><span class="op" id="3545635">,</span>&nbsp;<span class="op" id="3545637">&amp;</span><span class="ident" id="3545638">dst</span><span class="op" id="3545641">[</span><span class="num" id="3545642">0</span><span class="op" id="3545643">]</span><span class="op" id="3545644">,</span>&nbsp;<span class="op" id="3545646">&amp;</span><span class="ident" id="3545647">src</span><span class="op" id="3545650">[</span><span class="num" id="3545651">0</span><span class="op" id="3545652">]</span><span class="op" id="3545653">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3545656">}</span>&nbsp;<span class="keyword" id="3545658">else</span>&nbsp;<span class="op" id="3545663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3545667">encryptBlockGo</span><span class="op" id="3545681">(</span><span class="ident" id="3545682">xk</span><span class="op" id="3545684">,</span>&nbsp;<span class="ident" id="3545686">dst</span><span class="op" id="3545689">,</span>&nbsp;<span class="ident" id="3545691">src</span><span class="op" id="3545694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3545697">}</span><br>
<span class="lineno"></span><span class="op" id="3545699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="3545702">func</span>&nbsp;<span class="ident" id="3545707">decryptBlock</span><span class="op" id="3545719">(</span><span class="ident" id="3545720">xk</span>&nbsp;<span class="op" id="3545723">[</span><span class="op" id="3545724">]</span><span class="builtintype" id="3545725">uint32</span><span class="op" id="3545731">,</span>&nbsp;<span class="ident" id="3545733">dst</span><span class="op" id="3545736">,</span>&nbsp;<span class="ident" id="3545738">src</span>&nbsp;<span class="op" id="3545742">[</span><span class="op" id="3545743">]</span><span class="builtintype" id="3545744">byte</span><span class="op" id="3545748">)</span>&nbsp;<span class="op" id="3545750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3545753">if</span>&nbsp;<span class="ident" id="3545756">useAsm</span>&nbsp;<span class="op" id="3545763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3545767">decryptBlockAsm</span><span class="op" id="3545782">(</span><span class="builtinfunc" id="3545783">len</span><span class="op" id="3545786">(</span><span class="ident" id="3545787">xk</span><span class="op" id="3545789">)</span><span class="op" id="3545790">/</span><span class="num" id="3545791">4</span><span class="op" id="3545792">-</span><span class="num" id="3545793">1</span><span class="op" id="3545794">,</span>&nbsp;<span class="op" id="3545796">&amp;</span><span class="ident" id="3545797">xk</span><span class="op" id="3545799">[</span><span class="num" id="3545800">0</span><span class="op" id="3545801">]</span><span class="op" id="3545802">,</span>&nbsp;<span class="op" id="3545804">&amp;</span><span class="ident" id="3545805">dst</span><span class="op" id="3545808">[</span><span class="num" id="3545809">0</span><span class="op" id="3545810">]</span><span class="op" id="3545811">,</span>&nbsp;<span class="op" id="3545813">&amp;</span><span class="ident" id="3545814">src</span><span class="op" id="3545817">[</span><span class="num" id="3545818">0</span><span class="op" id="3545819">]</span><span class="op" id="3545820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3545823">}</span>&nbsp;<span class="keyword" id="3545825">else</span>&nbsp;<span class="op" id="3545830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3545834">decryptBlockGo</span><span class="op" id="3545848">(</span><span class="ident" id="3545849">xk</span><span class="op" id="3545851">,</span>&nbsp;<span class="ident" id="3545853">dst</span><span class="op" id="3545856">,</span>&nbsp;<span class="ident" id="3545858">src</span><span class="op" id="3545861">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3545864">}</span><br>
<span class="lineno"></span><span class="op" id="3545866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3545869">func</span>&nbsp;<span class="ident" id="3545874">expandKey</span><span class="op" id="3545883">(</span><span class="ident" id="3545884">key</span>&nbsp;<span class="op" id="3545888">[</span><span class="op" id="3545889">]</span><span class="builtintype" id="3545890">byte</span><span class="op" id="3545894">,</span>&nbsp;<span class="ident" id="3545896">enc</span><span class="op" id="3545899">,</span>&nbsp;<span class="ident" id="3545901">dec</span>&nbsp;<span class="op" id="3545905">[</span><span class="op" id="3545906">]</span><span class="builtintype" id="3545907">uint32</span><span class="op" id="3545913">)</span>&nbsp;<span class="op" id="3545915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3545918">if</span>&nbsp;<span class="ident" id="3545921">useAsm</span>&nbsp;<span class="op" id="3545928">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3545932">rounds</span>&nbsp;<span class="op" id="3545939">:=</span>&nbsp;<span class="num" id="3545942">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3545947">switch</span>&nbsp;<span class="builtinfunc" id="3545954">len</span><span class="op" id="3545957">(</span><span class="ident" id="3545958">key</span><span class="op" id="3545961">)</span>&nbsp;<span class="op" id="3545963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3545967">case</span>&nbsp;<span class="num" id="3545972">128</span>&nbsp;<span class="op" id="3545976">/</span>&nbsp;<span class="num" id="3545978">8</span><span class="op" id="3545979">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3545984">rounds</span>&nbsp;<span class="op" id="3545991">=</span>&nbsp;<span class="num" id="3545993">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3545998">case</span>&nbsp;<span class="num" id="3546003">192</span>&nbsp;<span class="op" id="3546007">/</span>&nbsp;<span class="num" id="3546009">8</span><span class="op" id="3546010">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3546015">rounds</span>&nbsp;<span class="op" id="3546022">=</span>&nbsp;<span class="num" id="3546024">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3546029">case</span>&nbsp;<span class="num" id="3546034">256</span>&nbsp;<span class="op" id="3546038">/</span>&nbsp;<span class="num" id="3546040">8</span><span class="op" id="3546041">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3546046">rounds</span>&nbsp;<span class="op" id="3546053">=</span>&nbsp;<span class="num" id="3546055">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3546060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3546064">expandKeyAsm</span><span class="op" id="3546076">(</span><span class="ident" id="3546077">rounds</span><span class="op" id="3546083">,</span>&nbsp;<span class="op" id="3546085">&amp;</span><span class="ident" id="3546086">key</span><span class="op" id="3546089">[</span><span class="num" id="3546090">0</span><span class="op" id="3546091">]</span><span class="op" id="3546092">,</span>&nbsp;<span class="op" id="3546094">&amp;</span><span class="ident" id="3546095">enc</span><span class="op" id="3546098">[</span><span class="num" id="3546099">0</span><span class="op" id="3546100">]</span><span class="op" id="3546101">,</span>&nbsp;<span class="op" id="3546103">&amp;</span><span class="ident" id="3546104">dec</span><span class="op" id="3546107">[</span><span class="num" id="3546108">0</span><span class="op" id="3546109">]</span><span class="op" id="3546110">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3546113">}</span>&nbsp;<span class="keyword" id="3546115">else</span>&nbsp;<span class="op" id="3546120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3546124">expandKeyGo</span><span class="op" id="3546135">(</span><span class="ident" id="3546136">key</span><span class="op" id="3546139">,</span>&nbsp;<span class="ident" id="3546141">enc</span><span class="op" id="3546144">,</span>&nbsp;<span class="ident" id="3546146">dec</span><span class="op" id="3546149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3546152">}</span><br>
<span class="lineno"></span><span class="op" id="3546154">}</span>
</div>
</body>
</html>
