<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6498834">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6498889">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6498943">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6498994">package</span>&nbsp;<span class="ident" id="6499002">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6499009">import</span>&nbsp;<span class="string" id="6499016">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6499024">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="6499084">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="6499154">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="6499212">//</span><br>
<span class="lineno"></span><span class="comment" id="6499215">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="6499263">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="6499327">//</span><br>
<span class="lineno"></span><span class="comment" id="6499330">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="6499391">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6499461">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="6499536">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="6499603">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="6499676">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6499748">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="6499762">//</span><br>
<span class="lineno"></span><span class="comment" id="6499765">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="6499831">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="6499897">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="6499910">//</span><br>
<span class="lineno"></span><span class="comment" id="6499913">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="6499937">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="6499967">//&nbsp;Complex&nbsp;circular&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="6499995">//</span><br>
<span class="lineno"></span><span class="comment" id="6499998">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6500014">//</span><br>
<span class="lineno">35</span><span class="comment" id="6500017">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="6500023">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno"></span><span class="comment" id="6500042">//</span><br>
<span class="lineno"></span><span class="comment" id="6500045">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="6500053">//</span><br>
<span class="lineno">40</span><span class="comment" id="6500056">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;i&nbsp;sinh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="6500090">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;--------------------.</span><br>
<span class="lineno"></span><span class="comment" id="6500125">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;cosh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="6500158">//</span><br>
<span class="lineno"></span><span class="comment" id="6500161">//&nbsp;On&nbsp;the&nbsp;real&nbsp;axis&nbsp;the&nbsp;denominator&nbsp;is&nbsp;zero&nbsp;at&nbsp;odd&nbsp;multiples</span><br>
<span class="lineno">45</span><span class="comment" id="6500222">//&nbsp;of&nbsp;PI/2.&nbsp;&nbsp;The&nbsp;denominator&nbsp;is&nbsp;evaluated&nbsp;by&nbsp;its&nbsp;Taylor</span><br>
<span class="lineno"></span><span class="comment" id="6500278">//&nbsp;series&nbsp;near&nbsp;these&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="6500307">//</span><br>
<span class="lineno"></span><span class="comment" id="6500310">//&nbsp;ctan(z)&nbsp;=&nbsp;-i&nbsp;ctanh(iz).</span><br>
<span class="lineno"></span><span class="comment" id="6500337">//</span><br>
<span class="lineno">50</span><span class="comment" id="6500340">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="6500353">//</span><br>
<span class="lineno"></span><span class="comment" id="6500356">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6500396">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="6500454">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.1e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-17</span><br>
<span class="lineno">55</span><span class="comment" id="6500514">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="6500574">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;ctan&nbsp;*&nbsp;ccot&nbsp;=&nbsp;1&nbsp;and&nbsp;catan(ctan(z))&nbsp;&nbsp;=&nbsp;&nbsp;z.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6500635">//&nbsp;Tan&nbsp;returns&nbsp;the&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="6500668">func</span>&nbsp;<span class="ident" id="6500673">Tan</span><span class="op" id="6500676">(</span><span class="ident" id="6500677">x</span>&nbsp;<span class="builtintype" id="6500679">complex128</span><span class="op" id="6500689">)</span>&nbsp;<span class="builtintype" id="6500691">complex128</span>&nbsp;<span class="op" id="6500702">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500705">d</span>&nbsp;<span class="op" id="6500707">:=</span>&nbsp;<span class="ident" id="6500710"><a href="/math/cmplx/tan.go.html#6499016">math</a></span><span class="op" id="6500714">.</span><span class="ident" id="6500715">Cos</span><span class="op" id="6500718">(</span><span class="num" id="6500719">2</span><span class="op" id="6500720">*</span><span class="builtinfunc" id="6500721">real</span><span class="op" id="6500725">(</span><span class="ident" id="6500726"><a href="/math/cmplx/tan.go.html#6500677">x</a></span><span class="op" id="6500727">)</span><span class="op" id="6500728">)</span>&nbsp;<span class="op" id="6500730">+</span>&nbsp;<span class="ident" id="6500732"><a href="/math/cmplx/tan.go.html#6499016">math</a></span><span class="op" id="6500736">.</span><span class="ident" id="6500737">Cosh</span><span class="op" id="6500741">(</span><span class="num" id="6500742">2</span><span class="op" id="6500743">*</span><span class="builtinfunc" id="6500744">imag</span><span class="op" id="6500748">(</span><span class="ident" id="6500749"><a href="/math/cmplx/tan.go.html#6500677">x</a></span><span class="op" id="6500750">)</span><span class="op" id="6500751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6500754">if</span>&nbsp;<span class="ident" id="6500757"><a href="/math/cmplx/tan.go.html#6499016">math</a></span><span class="op" id="6500761">.</span><span class="ident" id="6500762">Abs</span><span class="op" id="6500765">(</span><span class="ident" id="6500766"><a href="/math/cmplx/tan.go.html#6500705">d</a></span><span class="op" id="6500767">)</span>&nbsp;<span class="op" id="6500769">&lt;</span>&nbsp;<span class="num" id="6500771">0.25</span>&nbsp;<span class="op" id="6500776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500780"><a href="/math/cmplx/tan.go.html#6500705">d</a></span>&nbsp;<span class="op" id="6500782">=</span>&nbsp;<span class="ident" id="6500784"><a href="/math/cmplx/tan.go.html#6501943">tanSeries</a></span><span class="op" id="6500793">(</span><span class="ident" id="6500794"><a href="/math/cmplx/tan.go.html#6500677">x</a></span><span class="op" id="6500795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6500801">if</span>&nbsp;<span class="ident" id="6500804"><a href="/math/cmplx/tan.go.html#6500705">d</a></span>&nbsp;<span class="op" id="6500806">==</span>&nbsp;<span class="num" id="6500809">0</span>&nbsp;<span class="op" id="6500811">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6500815">return</span>&nbsp;<span class="ident" id="6500822"><a href="/math/cmplx/isinf.go.html#6486465">Inf</a></span><span class="op" id="6500825">(</span><span class="op" id="6500826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6500832">return</span>&nbsp;<span class="builtinfunc" id="6500839">complex</span><span class="op" id="6500846">(</span><span class="ident" id="6500847"><a href="/math/cmplx/tan.go.html#6499016">math</a></span><span class="op" id="6500851">.</span><span class="ident" id="6500852">Sin</span><span class="op" id="6500855">(</span><span class="num" id="6500856">2</span><span class="op" id="6500857">*</span><span class="builtinfunc" id="6500858">real</span><span class="op" id="6500862">(</span><span class="ident" id="6500863"><a href="/math/cmplx/tan.go.html#6500677">x</a></span><span class="op" id="6500864">)</span><span class="op" id="6500865">)</span><span class="op" id="6500866">/</span><span class="ident" id="6500867"><a href="/math/cmplx/tan.go.html#6500705">d</a></span><span class="op" id="6500868">,</span>&nbsp;<span class="ident" id="6500870"><a href="/math/cmplx/tan.go.html#6499016">math</a></span><span class="op" id="6500874">.</span><span class="ident" id="6500875">Sinh</span><span class="op" id="6500879">(</span><span class="num" id="6500880">2</span><span class="op" id="6500881">*</span><span class="builtinfunc" id="6500882">imag</span><span class="op" id="6500886">(</span><span class="ident" id="6500887"><a href="/math/cmplx/tan.go.html#6500677">x</a></span><span class="op" id="6500888">)</span><span class="op" id="6500889">)</span><span class="op" id="6500890">/</span><span class="ident" id="6500891"><a href="/math/cmplx/tan.go.html#6500705">d</a></span><span class="op" id="6500892">)</span><br>
<span class="lineno"></span><span class="op" id="6500894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="6500897">//&nbsp;Complex&nbsp;hyperbolic&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="6500927">//</span><br>
<span class="lineno"></span><span class="comment" id="6500930">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6500946">//</span><br>
<span class="lineno"></span><span class="comment" id="6500949">//&nbsp;tanh&nbsp;z&nbsp;=&nbsp;(sinh&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;i&nbsp;sin&nbsp;2y)&nbsp;/&nbsp;(cosh&nbsp;2x&nbsp;+&nbsp;cos&nbsp;2y)&nbsp;.</span><br>
<span class="lineno">75</span><span class="comment" id="6501007">//</span><br>
<span class="lineno"></span><span class="comment" id="6501010">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="6501023">//</span><br>
<span class="lineno"></span><span class="comment" id="6501026">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6501066">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">80</span><span class="comment" id="6501124">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.7e-14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.4e-16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6501185">//&nbsp;Tanh&nbsp;returns&nbsp;the&nbsp;hyperbolic&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="6501230">func</span>&nbsp;<span class="ident" id="6501235">Tanh</span><span class="op" id="6501239">(</span><span class="ident" id="6501240">x</span>&nbsp;<span class="builtintype" id="6501242">complex128</span><span class="op" id="6501252">)</span>&nbsp;<span class="builtintype" id="6501254">complex128</span>&nbsp;<span class="op" id="6501265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501268">d</span>&nbsp;<span class="op" id="6501270">:=</span>&nbsp;<span class="ident" id="6501273"><a href="/math/cmplx/tan.go.html#6499016">math</a></span><span class="op" id="6501277">.</span><span class="ident" id="6501278">Cosh</span><span class="op" id="6501282">(</span><span class="num" id="6501283">2</span><span class="op" id="6501284">*</span><span class="builtinfunc" id="6501285">real</span><span class="op" id="6501289">(</span><span class="ident" id="6501290"><a href="/math/cmplx/tan.go.html#6501240">x</a></span><span class="op" id="6501291">)</span><span class="op" id="6501292">)</span>&nbsp;<span class="op" id="6501294">+</span>&nbsp;<span class="ident" id="6501296"><a href="/math/cmplx/tan.go.html#6499016">math</a></span><span class="op" id="6501300">.</span><span class="ident" id="6501301">Cos</span><span class="op" id="6501304">(</span><span class="num" id="6501305">2</span><span class="op" id="6501306">*</span><span class="builtinfunc" id="6501307">imag</span><span class="op" id="6501311">(</span><span class="ident" id="6501312"><a href="/math/cmplx/tan.go.html#6501240">x</a></span><span class="op" id="6501313">)</span><span class="op" id="6501314">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501317">if</span>&nbsp;<span class="ident" id="6501320"><a href="/math/cmplx/tan.go.html#6501268">d</a></span>&nbsp;<span class="op" id="6501322">==</span>&nbsp;<span class="num" id="6501325">0</span>&nbsp;<span class="op" id="6501327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501331">return</span>&nbsp;<span class="ident" id="6501338"><a href="/math/cmplx/isinf.go.html#6486465">Inf</a></span><span class="op" id="6501341">(</span><span class="op" id="6501342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501348">return</span>&nbsp;<span class="builtinfunc" id="6501355">complex</span><span class="op" id="6501362">(</span><span class="ident" id="6501363"><a href="/math/cmplx/tan.go.html#6499016">math</a></span><span class="op" id="6501367">.</span><span class="ident" id="6501368">Sinh</span><span class="op" id="6501372">(</span><span class="num" id="6501373">2</span><span class="op" id="6501374">*</span><span class="builtinfunc" id="6501375">real</span><span class="op" id="6501379">(</span><span class="ident" id="6501380"><a href="/math/cmplx/tan.go.html#6501240">x</a></span><span class="op" id="6501381">)</span><span class="op" id="6501382">)</span><span class="op" id="6501383">/</span><span class="ident" id="6501384"><a href="/math/cmplx/tan.go.html#6501268">d</a></span><span class="op" id="6501385">,</span>&nbsp;<span class="ident" id="6501387"><a href="/math/cmplx/tan.go.html#6499016">math</a></span><span class="op" id="6501391">.</span><span class="ident" id="6501392">Sin</span><span class="op" id="6501395">(</span><span class="num" id="6501396">2</span><span class="op" id="6501397">*</span><span class="builtinfunc" id="6501398">imag</span><span class="op" id="6501402">(</span><span class="ident" id="6501403"><a href="/math/cmplx/tan.go.html#6501240">x</a></span><span class="op" id="6501404">)</span><span class="op" id="6501405">)</span><span class="op" id="6501406">/</span><span class="ident" id="6501407"><a href="/math/cmplx/tan.go.html#6501268">d</a></span><span class="op" id="6501408">)</span><br>
<span class="lineno"></span><span class="op" id="6501410">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="6501413">//&nbsp;Program&nbsp;to&nbsp;subtract&nbsp;nearest&nbsp;integer&nbsp;multiple&nbsp;of&nbsp;PI</span><br>
<span class="lineno"></span><span class="keyword" id="6501467">func</span>&nbsp;<span class="ident" id="6501472">reducePi</span><span class="op" id="6501480">(</span><span class="ident" id="6501481">x</span>&nbsp;<span class="builtintype" id="6501483">float64</span><span class="op" id="6501490">)</span>&nbsp;<span class="builtintype" id="6501492">float64</span>&nbsp;<span class="op" id="6501500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501503">const</span>&nbsp;<span class="op" id="6501509">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6501513">//&nbsp;extended&nbsp;precision&nbsp;value&nbsp;of&nbsp;PI:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501550">DP1</span>&nbsp;<span class="op" id="6501554">=</span>&nbsp;<span class="num" id="6501556">3.14159265160560607910E0</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6501583">//&nbsp;??&nbsp;0x400921fb54000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501610">DP2</span>&nbsp;<span class="op" id="6501614">=</span>&nbsp;<span class="num" id="6501616">1.98418714791870343106E-9</span>&nbsp;&nbsp;<span class="comment" id="6501643">//&nbsp;??&nbsp;0x3e210b4610000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501670">DP3</span>&nbsp;<span class="op" id="6501674">=</span>&nbsp;<span class="num" id="6501676">1.14423774522196636802E-17</span>&nbsp;<span class="comment" id="6501703">//&nbsp;??&nbsp;0x3c6a62633145c06e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501732">t</span>&nbsp;<span class="op" id="6501734">:=</span>&nbsp;<span class="ident" id="6501737"><a href="/math/cmplx/tan.go.html#6501481">x</a></span>&nbsp;<span class="op" id="6501739">/</span>&nbsp;<span class="ident" id="6501741"><a href="/math/cmplx/tan.go.html#6499016">math</a></span><span class="op" id="6501745">.</span><span class="ident" id="6501746">Pi</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501750">if</span>&nbsp;<span class="ident" id="6501753"><a href="/math/cmplx/tan.go.html#6501732">t</a></span>&nbsp;<span class="op" id="6501755">&gt;=</span>&nbsp;<span class="num" id="6501758">0</span>&nbsp;<span class="op" id="6501760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501764"><a href="/math/cmplx/tan.go.html#6501732">t</a></span>&nbsp;<span class="op" id="6501766">+=</span>&nbsp;<span class="num" id="6501769">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501774">}</span>&nbsp;<span class="keyword" id="6501776">else</span>&nbsp;<span class="op" id="6501781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501785"><a href="/math/cmplx/tan.go.html#6501732">t</a></span>&nbsp;<span class="op" id="6501787">-=</span>&nbsp;<span class="num" id="6501790">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501795">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501798"><a href="/math/cmplx/tan.go.html#6501732">t</a></span>&nbsp;<span class="op" id="6501800">=</span>&nbsp;<span class="builtintype" id="6501802">float64</span><span class="op" id="6501809">(</span><span class="ident" id="6501810">int64</span><span class="op" id="6501815">(</span><span class="ident" id="6501816"><a href="/math/cmplx/tan.go.html#6501732">t</a></span><span class="op" id="6501817">)</span><span class="op" id="6501818">)</span>&nbsp;<span class="comment" id="6501820">//&nbsp;int64(t)&nbsp;=&nbsp;the&nbsp;multiple</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501848">return</span>&nbsp;<span class="op" id="6501855">(</span><span class="op" id="6501856">(</span><span class="ident" id="6501857"><a href="/math/cmplx/tan.go.html#6501481">x</a></span>&nbsp;<span class="op" id="6501859">-</span>&nbsp;<span class="ident" id="6501861"><a href="/math/cmplx/tan.go.html#6501732">t</a></span><span class="op" id="6501862">*</span><span class="ident" id="6501863"><a href="/math/cmplx/tan.go.html#6501550">DP1</a></span><span class="op" id="6501866">)</span>&nbsp;<span class="op" id="6501868">-</span>&nbsp;<span class="ident" id="6501870"><a href="/math/cmplx/tan.go.html#6501732">t</a></span><span class="op" id="6501871">*</span><span class="ident" id="6501872"><a href="/math/cmplx/tan.go.html#6501610">DP2</a></span><span class="op" id="6501875">)</span>&nbsp;<span class="op" id="6501877">-</span>&nbsp;<span class="ident" id="6501879"><a href="/math/cmplx/tan.go.html#6501732">t</a></span><span class="op" id="6501880">*</span><span class="ident" id="6501881"><a href="/math/cmplx/tan.go.html#6501670">DP3</a></span><br>
<span class="lineno"></span><span class="op" id="6501885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6501888">//&nbsp;Taylor&nbsp;series&nbsp;expansion&nbsp;for&nbsp;cosh(2y)&nbsp;-&nbsp;cos(2x)</span><br>
<span class="lineno">110</span><span class="keyword" id="6501938">func</span>&nbsp;<span class="ident" id="6501943">tanSeries</span><span class="op" id="6501952">(</span><span class="ident" id="6501953">z</span>&nbsp;<span class="builtintype" id="6501955">complex128</span><span class="op" id="6501965">)</span>&nbsp;<span class="builtintype" id="6501967">float64</span>&nbsp;<span class="op" id="6501975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501978">const</span>&nbsp;<span class="ident" id="6501984">MACHEP</span>&nbsp;<span class="op" id="6501991">=</span>&nbsp;<span class="num" id="6501993">1.0</span>&nbsp;<span class="op" id="6501997">/</span>&nbsp;<span class="op" id="6501999">(</span><span class="num" id="6502000">1</span>&nbsp;<span class="op" id="6502002">&lt;&lt;</span>&nbsp;<span class="num" id="6502005">53</span><span class="op" id="6502007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502010">x</span>&nbsp;<span class="op" id="6502012">:=</span>&nbsp;<span class="ident" id="6502015"><a href="/math/cmplx/tan.go.html#6499016">math</a></span><span class="op" id="6502019">.</span><span class="ident" id="6502020">Abs</span><span class="op" id="6502023">(</span><span class="num" id="6502024">2</span>&nbsp;<span class="op" id="6502026">*</span>&nbsp;<span class="builtinfunc" id="6502028">real</span><span class="op" id="6502032">(</span><span class="ident" id="6502033"><a href="/math/cmplx/tan.go.html#6501953">z</a></span><span class="op" id="6502034">)</span><span class="op" id="6502035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502038">y</span>&nbsp;<span class="op" id="6502040">:=</span>&nbsp;<span class="ident" id="6502043"><a href="/math/cmplx/tan.go.html#6499016">math</a></span><span class="op" id="6502047">.</span><span class="ident" id="6502048">Abs</span><span class="op" id="6502051">(</span><span class="num" id="6502052">2</span>&nbsp;<span class="op" id="6502054">*</span>&nbsp;<span class="builtinfunc" id="6502056">imag</span><span class="op" id="6502060">(</span><span class="ident" id="6502061"><a href="/math/cmplx/tan.go.html#6501953">z</a></span><span class="op" id="6502062">)</span><span class="op" id="6502063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502066"><a href="/math/cmplx/tan.go.html#6502010">x</a></span>&nbsp;<span class="op" id="6502068">=</span>&nbsp;<span class="ident" id="6502070"><a href="/math/cmplx/tan.go.html#6501472">reducePi</a></span><span class="op" id="6502078">(</span><span class="ident" id="6502079"><a href="/math/cmplx/tan.go.html#6502010">x</a></span><span class="op" id="6502080">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502083"><a href="/math/cmplx/tan.go.html#6502010">x</a></span>&nbsp;<span class="op" id="6502085">=</span>&nbsp;<span class="ident" id="6502087"><a href="/math/cmplx/tan.go.html#6502010">x</a></span>&nbsp;<span class="op" id="6502089">*</span>&nbsp;<span class="ident" id="6502091"><a href="/math/cmplx/tan.go.html#6502010">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502094"><a href="/math/cmplx/tan.go.html#6502038">y</a></span>&nbsp;<span class="op" id="6502096">=</span>&nbsp;<span class="ident" id="6502098"><a href="/math/cmplx/tan.go.html#6502038">y</a></span>&nbsp;<span class="op" id="6502100">*</span>&nbsp;<span class="ident" id="6502102"><a href="/math/cmplx/tan.go.html#6502038">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502105">x2</span>&nbsp;<span class="op" id="6502108">:=</span>&nbsp;<span class="num" id="6502111">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502116">y2</span>&nbsp;<span class="op" id="6502119">:=</span>&nbsp;<span class="num" id="6502122">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502127">f</span>&nbsp;<span class="op" id="6502129">:=</span>&nbsp;<span class="num" id="6502132">1.0</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502137">rn</span>&nbsp;<span class="op" id="6502140">:=</span>&nbsp;<span class="num" id="6502143">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502148">d</span>&nbsp;<span class="op" id="6502150">:=</span>&nbsp;<span class="num" id="6502153">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502158">for</span>&nbsp;<span class="op" id="6502162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502166"><a href="/math/cmplx/tan.go.html#6502137">rn</a></span>&nbsp;<span class="op" id="6502169">+=</span>&nbsp;<span class="num" id="6502172">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502176"><a href="/math/cmplx/tan.go.html#6502127">f</a></span>&nbsp;<span class="op" id="6502178">*=</span>&nbsp;<span class="ident" id="6502181"><a href="/math/cmplx/tan.go.html#6502137">rn</a></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502186"><a href="/math/cmplx/tan.go.html#6502137">rn</a></span>&nbsp;<span class="op" id="6502189">+=</span>&nbsp;<span class="num" id="6502192">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502196"><a href="/math/cmplx/tan.go.html#6502127">f</a></span>&nbsp;<span class="op" id="6502198">*=</span>&nbsp;<span class="ident" id="6502201"><a href="/math/cmplx/tan.go.html#6502137">rn</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502206"><a href="/math/cmplx/tan.go.html#6502105">x2</a></span>&nbsp;<span class="op" id="6502209">*=</span>&nbsp;<span class="ident" id="6502212"><a href="/math/cmplx/tan.go.html#6502010">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502216"><a href="/math/cmplx/tan.go.html#6502116">y2</a></span>&nbsp;<span class="op" id="6502219">*=</span>&nbsp;<span class="ident" id="6502222"><a href="/math/cmplx/tan.go.html#6502038">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502226">t</span>&nbsp;<span class="op" id="6502228">:=</span>&nbsp;<span class="ident" id="6502231"><a href="/math/cmplx/tan.go.html#6502116">y2</a></span>&nbsp;<span class="op" id="6502234">+</span>&nbsp;<span class="ident" id="6502236"><a href="/math/cmplx/tan.go.html#6502105">x2</a></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502241"><a href="/math/cmplx/tan.go.html#6502226">t</a></span>&nbsp;<span class="op" id="6502243">/=</span>&nbsp;<span class="ident" id="6502246"><a href="/math/cmplx/tan.go.html#6502127">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502250"><a href="/math/cmplx/tan.go.html#6502148">d</a></span>&nbsp;<span class="op" id="6502252">+=</span>&nbsp;<span class="ident" id="6502255"><a href="/math/cmplx/tan.go.html#6502226">t</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502260"><a href="/math/cmplx/tan.go.html#6502137">rn</a></span>&nbsp;<span class="op" id="6502263">+=</span>&nbsp;<span class="num" id="6502266">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502270"><a href="/math/cmplx/tan.go.html#6502127">f</a></span>&nbsp;<span class="op" id="6502272">*=</span>&nbsp;<span class="ident" id="6502275"><a href="/math/cmplx/tan.go.html#6502137">rn</a></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502280"><a href="/math/cmplx/tan.go.html#6502137">rn</a></span>&nbsp;<span class="op" id="6502283">+=</span>&nbsp;<span class="num" id="6502286">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502290"><a href="/math/cmplx/tan.go.html#6502127">f</a></span>&nbsp;<span class="op" id="6502292">*=</span>&nbsp;<span class="ident" id="6502295"><a href="/math/cmplx/tan.go.html#6502137">rn</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502300"><a href="/math/cmplx/tan.go.html#6502105">x2</a></span>&nbsp;<span class="op" id="6502303">*=</span>&nbsp;<span class="ident" id="6502306"><a href="/math/cmplx/tan.go.html#6502010">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502310"><a href="/math/cmplx/tan.go.html#6502116">y2</a></span>&nbsp;<span class="op" id="6502313">*=</span>&nbsp;<span class="ident" id="6502316"><a href="/math/cmplx/tan.go.html#6502038">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502320"><a href="/math/cmplx/tan.go.html#6502226">t</a></span>&nbsp;<span class="op" id="6502322">=</span>&nbsp;<span class="ident" id="6502324"><a href="/math/cmplx/tan.go.html#6502116">y2</a></span>&nbsp;<span class="op" id="6502327">-</span>&nbsp;<span class="ident" id="6502329"><a href="/math/cmplx/tan.go.html#6502105">x2</a></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502334"><a href="/math/cmplx/tan.go.html#6502226">t</a></span>&nbsp;<span class="op" id="6502336">/=</span>&nbsp;<span class="ident" id="6502339"><a href="/math/cmplx/tan.go.html#6502127">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502343"><a href="/math/cmplx/tan.go.html#6502148">d</a></span>&nbsp;<span class="op" id="6502345">+=</span>&nbsp;<span class="ident" id="6502348"><a href="/math/cmplx/tan.go.html#6502226">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502352">if</span>&nbsp;<span class="ident" id="6502355"><a href="/math/cmplx/tan.go.html#6499016">math</a></span><span class="op" id="6502359">.</span><span class="ident" id="6502360">Abs</span><span class="op" id="6502363">(</span><span class="ident" id="6502364"><a href="/math/cmplx/tan.go.html#6502226">t</a></span><span class="op" id="6502365">/</span><span class="ident" id="6502366"><a href="/math/cmplx/tan.go.html#6502148">d</a></span><span class="op" id="6502367">)</span>&nbsp;<span class="op" id="6502369">&lt;=</span>&nbsp;<span class="ident" id="6502372"><a href="/math/cmplx/tan.go.html#6501984">MACHEP</a></span>&nbsp;<span class="op" id="6502379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502384">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502392">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502398">return</span>&nbsp;<span class="ident" id="6502405"><a href="/math/cmplx/tan.go.html#6502148">d</a></span><br>
<span class="lineno"></span><span class="op" id="6502407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6502410">//&nbsp;Complex&nbsp;circular&nbsp;cotangent</span><br>
<span class="lineno">150</span><span class="comment" id="6502440">//</span><br>
<span class="lineno"></span><span class="comment" id="6502443">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6502459">//</span><br>
<span class="lineno"></span><span class="comment" id="6502462">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="6502468">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno">155</span><span class="comment" id="6502487">//</span><br>
<span class="lineno"></span><span class="comment" id="6502490">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="6502498">//</span><br>
<span class="lineno"></span><span class="comment" id="6502501">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin&nbsp;2x&nbsp;&nbsp;-&nbsp;&nbsp;i&nbsp;sinh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="6502535">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;--------------------.</span><br>
<span class="lineno">160</span><span class="comment" id="6502570">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cosh&nbsp;2y&nbsp;&nbsp;-&nbsp;&nbsp;cos&nbsp;2x</span><br>
<span class="lineno"></span><span class="comment" id="6502603">//</span><br>
<span class="lineno"></span><span class="comment" id="6502606">//&nbsp;On&nbsp;the&nbsp;real&nbsp;axis,&nbsp;the&nbsp;denominator&nbsp;has&nbsp;zeros&nbsp;at&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="6502661">//&nbsp;multiples&nbsp;of&nbsp;PI/2.&nbsp;&nbsp;Near&nbsp;these&nbsp;points&nbsp;it&nbsp;is&nbsp;evaluated</span><br>
<span class="lineno"></span><span class="comment" id="6502718">//&nbsp;by&nbsp;a&nbsp;Taylor&nbsp;series.</span><br>
<span class="lineno">165</span><span class="comment" id="6502741">//</span><br>
<span class="lineno"></span><span class="comment" id="6502744">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="6502757">//</span><br>
<span class="lineno"></span><span class="comment" id="6502760">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6502800">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">170</span><span class="comment" id="6502858">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.5e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-17</span><br>
<span class="lineno"></span><span class="comment" id="6502918">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.2e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="6502978">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;ctan&nbsp;*&nbsp;ccot&nbsp;=&nbsp;1&nbsp;+&nbsp;i0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6503019">//&nbsp;Cot&nbsp;returns&nbsp;the&nbsp;cotangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno">175</span><span class="keyword" id="6503054">func</span>&nbsp;<span class="ident" id="6503059">Cot</span><span class="op" id="6503062">(</span><span class="ident" id="6503063">x</span>&nbsp;<span class="builtintype" id="6503065">complex128</span><span class="op" id="6503075">)</span>&nbsp;<span class="builtintype" id="6503077">complex128</span>&nbsp;<span class="op" id="6503088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503091">d</span>&nbsp;<span class="op" id="6503093">:=</span>&nbsp;<span class="ident" id="6503096"><a href="/math/cmplx/tan.go.html#6499016">math</a></span><span class="op" id="6503100">.</span><span class="ident" id="6503101">Cosh</span><span class="op" id="6503105">(</span><span class="num" id="6503106">2</span><span class="op" id="6503107">*</span><span class="builtinfunc" id="6503108">imag</span><span class="op" id="6503112">(</span><span class="ident" id="6503113"><a href="/math/cmplx/tan.go.html#6503063">x</a></span><span class="op" id="6503114">)</span><span class="op" id="6503115">)</span>&nbsp;<span class="op" id="6503117">-</span>&nbsp;<span class="ident" id="6503119"><a href="/math/cmplx/tan.go.html#6499016">math</a></span><span class="op" id="6503123">.</span><span class="ident" id="6503124">Cos</span><span class="op" id="6503127">(</span><span class="num" id="6503128">2</span><span class="op" id="6503129">*</span><span class="builtinfunc" id="6503130">real</span><span class="op" id="6503134">(</span><span class="ident" id="6503135"><a href="/math/cmplx/tan.go.html#6503063">x</a></span><span class="op" id="6503136">)</span><span class="op" id="6503137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503140">if</span>&nbsp;<span class="ident" id="6503143"><a href="/math/cmplx/tan.go.html#6499016">math</a></span><span class="op" id="6503147">.</span><span class="ident" id="6503148">Abs</span><span class="op" id="6503151">(</span><span class="ident" id="6503152"><a href="/math/cmplx/tan.go.html#6503091">d</a></span><span class="op" id="6503153">)</span>&nbsp;<span class="op" id="6503155">&lt;</span>&nbsp;<span class="num" id="6503157">0.25</span>&nbsp;<span class="op" id="6503162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503166"><a href="/math/cmplx/tan.go.html#6503091">d</a></span>&nbsp;<span class="op" id="6503168">=</span>&nbsp;<span class="ident" id="6503170"><a href="/math/cmplx/tan.go.html#6501943">tanSeries</a></span><span class="op" id="6503179">(</span><span class="ident" id="6503180"><a href="/math/cmplx/tan.go.html#6503063">x</a></span><span class="op" id="6503181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6503184">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503187">if</span>&nbsp;<span class="ident" id="6503190"><a href="/math/cmplx/tan.go.html#6503091">d</a></span>&nbsp;<span class="op" id="6503192">==</span>&nbsp;<span class="num" id="6503195">0</span>&nbsp;<span class="op" id="6503197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503201">return</span>&nbsp;<span class="ident" id="6503208"><a href="/math/cmplx/isinf.go.html#6486465">Inf</a></span><span class="op" id="6503211">(</span><span class="op" id="6503212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6503215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503218">return</span>&nbsp;<span class="builtinfunc" id="6503225">complex</span><span class="op" id="6503232">(</span><span class="ident" id="6503233"><a href="/math/cmplx/tan.go.html#6499016">math</a></span><span class="op" id="6503237">.</span><span class="ident" id="6503238">Sin</span><span class="op" id="6503241">(</span><span class="num" id="6503242">2</span><span class="op" id="6503243">*</span><span class="builtinfunc" id="6503244">real</span><span class="op" id="6503248">(</span><span class="ident" id="6503249"><a href="/math/cmplx/tan.go.html#6503063">x</a></span><span class="op" id="6503250">)</span><span class="op" id="6503251">)</span><span class="op" id="6503252">/</span><span class="ident" id="6503253"><a href="/math/cmplx/tan.go.html#6503091">d</a></span><span class="op" id="6503254">,</span>&nbsp;<span class="op" id="6503256">-</span><span class="ident" id="6503257"><a href="/math/cmplx/tan.go.html#6499016">math</a></span><span class="op" id="6503261">.</span><span class="ident" id="6503262">Sinh</span><span class="op" id="6503266">(</span><span class="num" id="6503267">2</span><span class="op" id="6503268">*</span><span class="builtinfunc" id="6503269">imag</span><span class="op" id="6503273">(</span><span class="ident" id="6503274"><a href="/math/cmplx/tan.go.html#6503063">x</a></span><span class="op" id="6503275">)</span><span class="op" id="6503276">)</span><span class="op" id="6503277">/</span><span class="ident" id="6503278"><a href="/math/cmplx/tan.go.html#6503091">d</a></span><span class="op" id="6503279">)</span><br>
<span class="lineno"></span><span class="op" id="6503281">}</span>
</div>
</body>
</html>
