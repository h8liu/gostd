<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7801350">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7801405">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7801459">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7801510">package</span>&nbsp;<span class="ident" id="7801518">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7801523">import</span>&nbsp;<span class="op" id="7801530">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7801533">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7801543">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="7801546">func</span>&nbsp;<span class="ident" id="7801551">TestRoundUp</span><span class="op" id="7801562">(</span><span class="ident" id="7801563">t</span>&nbsp;<span class="op" id="7801565">*</span><span class="ident" id="7801566">testing</span><span class="op" id="7801573">.</span><span class="ident" id="7801574">T</span><span class="op" id="7801575">)</span>&nbsp;<span class="op" id="7801577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7801580">if</span>&nbsp;<span class="ident" id="7801583">roundUp</span><span class="op" id="7801590">(</span><span class="num" id="7801591">0</span><span class="op" id="7801592">,</span>&nbsp;<span class="num" id="7801594">16</span><span class="op" id="7801596">)</span>&nbsp;<span class="op" id="7801598">!=</span>&nbsp;<span class="num" id="7801601">0</span>&nbsp;<span class="op" id="7801603">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7801608">roundUp</span><span class="op" id="7801615">(</span><span class="num" id="7801616">1</span><span class="op" id="7801617">,</span>&nbsp;<span class="num" id="7801619">16</span><span class="op" id="7801621">)</span>&nbsp;<span class="op" id="7801623">!=</span>&nbsp;<span class="num" id="7801626">16</span>&nbsp;<span class="op" id="7801629">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7801634">roundUp</span><span class="op" id="7801641">(</span><span class="num" id="7801642">15</span><span class="op" id="7801644">,</span>&nbsp;<span class="num" id="7801646">16</span><span class="op" id="7801648">)</span>&nbsp;<span class="op" id="7801650">!=</span>&nbsp;<span class="num" id="7801653">16</span>&nbsp;<span class="op" id="7801656">||</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7801661">roundUp</span><span class="op" id="7801668">(</span><span class="num" id="7801669">16</span><span class="op" id="7801671">,</span>&nbsp;<span class="num" id="7801673">16</span><span class="op" id="7801675">)</span>&nbsp;<span class="op" id="7801677">!=</span>&nbsp;<span class="num" id="7801680">16</span>&nbsp;<span class="op" id="7801683">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7801688">roundUp</span><span class="op" id="7801695">(</span><span class="num" id="7801696">17</span><span class="op" id="7801698">,</span>&nbsp;<span class="num" id="7801700">16</span><span class="op" id="7801702">)</span>&nbsp;<span class="op" id="7801704">!=</span>&nbsp;<span class="num" id="7801707">32</span>&nbsp;<span class="op" id="7801710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7801714">t</span><span class="op" id="7801715">.</span><span class="ident" id="7801716">Error</span><span class="op" id="7801721">(</span><span class="string" id="7801722">&#34;roundUp&nbsp;broken&#34;</span><span class="op" id="7801738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7801741">}</span><br>
<span class="lineno"></span><span class="op" id="7801743">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="7801746">var</span>&nbsp;<span class="ident" id="7801750">paddingTests</span>&nbsp;<span class="op" id="7801763">=</span>&nbsp;<span class="op" id="7801765">[</span><span class="op" id="7801766">]</span><span class="keyword" id="7801767">struct</span>&nbsp;<span class="op" id="7801774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7801777">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7801789">[</span><span class="op" id="7801790">]</span><span class="builtintype" id="7801791">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7801797">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7801809">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7801815">expectedLen</span>&nbsp;<span class="builtintype" id="7801827">int</span><br>
<span class="lineno">25</span><span class="op" id="7801831">}</span><span class="op" id="7801832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7801835">{</span><span class="op" id="7801836">[</span><span class="op" id="7801837">]</span><span class="builtintype" id="7801838">byte</span><span class="op" id="7801842">{</span><span class="num" id="7801843">1</span><span class="op" id="7801844">,</span>&nbsp;<span class="num" id="7801846">2</span><span class="op" id="7801847">,</span>&nbsp;<span class="num" id="7801849">3</span><span class="op" id="7801850">,</span>&nbsp;<span class="num" id="7801852">4</span><span class="op" id="7801853">,</span>&nbsp;<span class="num" id="7801855">0</span><span class="op" id="7801856">}</span><span class="op" id="7801857">,</span>&nbsp;<span class="ident" id="7801859">true</span><span class="op" id="7801863">,</span>&nbsp;<span class="num" id="7801865">4</span><span class="op" id="7801866">}</span><span class="op" id="7801867">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7801870">{</span><span class="op" id="7801871">[</span><span class="op" id="7801872">]</span><span class="builtintype" id="7801873">byte</span><span class="op" id="7801877">{</span><span class="num" id="7801878">1</span><span class="op" id="7801879">,</span>&nbsp;<span class="num" id="7801881">2</span><span class="op" id="7801882">,</span>&nbsp;<span class="num" id="7801884">3</span><span class="op" id="7801885">,</span>&nbsp;<span class="num" id="7801887">4</span><span class="op" id="7801888">,</span>&nbsp;<span class="num" id="7801890">0</span><span class="op" id="7801891">,</span>&nbsp;<span class="num" id="7801893">1</span><span class="op" id="7801894">}</span><span class="op" id="7801895">,</span>&nbsp;<span class="ident" id="7801897">false</span><span class="op" id="7801902">,</span>&nbsp;<span class="num" id="7801904">0</span><span class="op" id="7801905">}</span><span class="op" id="7801906">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7801909">{</span><span class="op" id="7801910">[</span><span class="op" id="7801911">]</span><span class="builtintype" id="7801912">byte</span><span class="op" id="7801916">{</span><span class="num" id="7801917">1</span><span class="op" id="7801918">,</span>&nbsp;<span class="num" id="7801920">2</span><span class="op" id="7801921">,</span>&nbsp;<span class="num" id="7801923">3</span><span class="op" id="7801924">,</span>&nbsp;<span class="num" id="7801926">4</span><span class="op" id="7801927">,</span>&nbsp;<span class="num" id="7801929">99</span><span class="op" id="7801931">,</span>&nbsp;<span class="num" id="7801933">99</span><span class="op" id="7801935">}</span><span class="op" id="7801936">,</span>&nbsp;<span class="ident" id="7801938">false</span><span class="op" id="7801943">,</span>&nbsp;<span class="num" id="7801945">0</span><span class="op" id="7801946">}</span><span class="op" id="7801947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7801950">{</span><span class="op" id="7801951">[</span><span class="op" id="7801952">]</span><span class="builtintype" id="7801953">byte</span><span class="op" id="7801957">{</span><span class="num" id="7801958">1</span><span class="op" id="7801959">,</span>&nbsp;<span class="num" id="7801961">2</span><span class="op" id="7801962">,</span>&nbsp;<span class="num" id="7801964">3</span><span class="op" id="7801965">,</span>&nbsp;<span class="num" id="7801967">4</span><span class="op" id="7801968">,</span>&nbsp;<span class="num" id="7801970">1</span><span class="op" id="7801971">,</span>&nbsp;<span class="num" id="7801973">1</span><span class="op" id="7801974">}</span><span class="op" id="7801975">,</span>&nbsp;<span class="ident" id="7801977">true</span><span class="op" id="7801981">,</span>&nbsp;<span class="num" id="7801983">4</span><span class="op" id="7801984">}</span><span class="op" id="7801985">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7801988">{</span><span class="op" id="7801989">[</span><span class="op" id="7801990">]</span><span class="builtintype" id="7801991">byte</span><span class="op" id="7801995">{</span><span class="num" id="7801996">1</span><span class="op" id="7801997">,</span>&nbsp;<span class="num" id="7801999">2</span><span class="op" id="7802000">,</span>&nbsp;<span class="num" id="7802002">3</span><span class="op" id="7802003">,</span>&nbsp;<span class="num" id="7802005">2</span><span class="op" id="7802006">,</span>&nbsp;<span class="num" id="7802008">2</span><span class="op" id="7802009">,</span>&nbsp;<span class="num" id="7802011">2</span><span class="op" id="7802012">}</span><span class="op" id="7802013">,</span>&nbsp;<span class="ident" id="7802015">true</span><span class="op" id="7802019">,</span>&nbsp;<span class="num" id="7802021">3</span><span class="op" id="7802022">}</span><span class="op" id="7802023">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7802026">{</span><span class="op" id="7802027">[</span><span class="op" id="7802028">]</span><span class="builtintype" id="7802029">byte</span><span class="op" id="7802033">{</span><span class="num" id="7802034">1</span><span class="op" id="7802035">,</span>&nbsp;<span class="num" id="7802037">2</span><span class="op" id="7802038">,</span>&nbsp;<span class="num" id="7802040">3</span><span class="op" id="7802041">,</span>&nbsp;<span class="num" id="7802043">3</span><span class="op" id="7802044">,</span>&nbsp;<span class="num" id="7802046">3</span><span class="op" id="7802047">,</span>&nbsp;<span class="num" id="7802049">3</span><span class="op" id="7802050">}</span><span class="op" id="7802051">,</span>&nbsp;<span class="ident" id="7802053">true</span><span class="op" id="7802057">,</span>&nbsp;<span class="num" id="7802059">2</span><span class="op" id="7802060">}</span><span class="op" id="7802061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7802064">{</span><span class="op" id="7802065">[</span><span class="op" id="7802066">]</span><span class="builtintype" id="7802067">byte</span><span class="op" id="7802071">{</span><span class="num" id="7802072">1</span><span class="op" id="7802073">,</span>&nbsp;<span class="num" id="7802075">2</span><span class="op" id="7802076">,</span>&nbsp;<span class="num" id="7802078">3</span><span class="op" id="7802079">,</span>&nbsp;<span class="num" id="7802081">4</span><span class="op" id="7802082">,</span>&nbsp;<span class="num" id="7802084">3</span><span class="op" id="7802085">,</span>&nbsp;<span class="num" id="7802087">3</span><span class="op" id="7802088">}</span><span class="op" id="7802089">,</span>&nbsp;<span class="ident" id="7802091">false</span><span class="op" id="7802096">,</span>&nbsp;<span class="num" id="7802098">0</span><span class="op" id="7802099">}</span><span class="op" id="7802100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7802103">{</span><span class="op" id="7802104">[</span><span class="op" id="7802105">]</span><span class="builtintype" id="7802106">byte</span><span class="op" id="7802110">{</span><span class="num" id="7802111">1</span><span class="op" id="7802112">,</span>&nbsp;<span class="num" id="7802114">4</span><span class="op" id="7802115">,</span>&nbsp;<span class="num" id="7802117">4</span><span class="op" id="7802118">,</span>&nbsp;<span class="num" id="7802120">4</span><span class="op" id="7802121">,</span>&nbsp;<span class="num" id="7802123">4</span><span class="op" id="7802124">,</span>&nbsp;<span class="num" id="7802126">4</span><span class="op" id="7802127">}</span><span class="op" id="7802128">,</span>&nbsp;<span class="ident" id="7802130">true</span><span class="op" id="7802134">,</span>&nbsp;<span class="num" id="7802136">1</span><span class="op" id="7802137">}</span><span class="op" id="7802138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7802141">{</span><span class="op" id="7802142">[</span><span class="op" id="7802143">]</span><span class="builtintype" id="7802144">byte</span><span class="op" id="7802148">{</span><span class="num" id="7802149">5</span><span class="op" id="7802150">,</span>&nbsp;<span class="num" id="7802152">5</span><span class="op" id="7802153">,</span>&nbsp;<span class="num" id="7802155">5</span><span class="op" id="7802156">,</span>&nbsp;<span class="num" id="7802158">5</span><span class="op" id="7802159">,</span>&nbsp;<span class="num" id="7802161">5</span><span class="op" id="7802162">,</span>&nbsp;<span class="num" id="7802164">5</span><span class="op" id="7802165">}</span><span class="op" id="7802166">,</span>&nbsp;<span class="ident" id="7802168">true</span><span class="op" id="7802172">,</span>&nbsp;<span class="num" id="7802174">0</span><span class="op" id="7802175">}</span><span class="op" id="7802176">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7802179">{</span><span class="op" id="7802180">[</span><span class="op" id="7802181">]</span><span class="builtintype" id="7802182">byte</span><span class="op" id="7802186">{</span><span class="num" id="7802187">6</span><span class="op" id="7802188">,</span>&nbsp;<span class="num" id="7802190">6</span><span class="op" id="7802191">,</span>&nbsp;<span class="num" id="7802193">6</span><span class="op" id="7802194">,</span>&nbsp;<span class="num" id="7802196">6</span><span class="op" id="7802197">,</span>&nbsp;<span class="num" id="7802199">6</span><span class="op" id="7802200">,</span>&nbsp;<span class="num" id="7802202">6</span><span class="op" id="7802203">}</span><span class="op" id="7802204">,</span>&nbsp;<span class="ident" id="7802206">false</span><span class="op" id="7802211">,</span>&nbsp;<span class="num" id="7802213">0</span><span class="op" id="7802214">}</span><span class="op" id="7802215">,</span><br>
<span class="lineno"></span><span class="op" id="7802217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7802220">func</span>&nbsp;<span class="ident" id="7802225">TestRemovePadding</span><span class="op" id="7802242">(</span><span class="ident" id="7802243">t</span>&nbsp;<span class="op" id="7802245">*</span><span class="ident" id="7802246">testing</span><span class="op" id="7802253">.</span><span class="ident" id="7802254">T</span><span class="op" id="7802255">)</span>&nbsp;<span class="op" id="7802257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7802260">for</span>&nbsp;<span class="ident" id="7802264">i</span><span class="op" id="7802265">,</span>&nbsp;<span class="ident" id="7802267">test</span>&nbsp;<span class="op" id="7802272">:=</span>&nbsp;<span class="keyword" id="7802275">range</span>&nbsp;<span class="ident" id="7802281">paddingTests</span>&nbsp;<span class="op" id="7802294">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7802298">payload</span><span class="op" id="7802305">,</span>&nbsp;<span class="ident" id="7802307">good</span>&nbsp;<span class="op" id="7802312">:=</span>&nbsp;<span class="ident" id="7802315">removePadding</span><span class="op" id="7802328">(</span><span class="ident" id="7802329">test</span><span class="op" id="7802333">.</span><span class="ident" id="7802334">in</span><span class="op" id="7802336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7802340">expectedGood</span>&nbsp;<span class="op" id="7802353">:=</span>&nbsp;<span class="builtintype" id="7802356">byte</span><span class="op" id="7802360">(</span><span class="num" id="7802361">255</span><span class="op" id="7802364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7802368">if</span>&nbsp;<span class="op" id="7802371">!</span><span class="ident" id="7802372">test</span><span class="op" id="7802376">.</span><span class="ident" id="7802377">good</span>&nbsp;<span class="op" id="7802382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7802387">expectedGood</span>&nbsp;<span class="op" id="7802400">=</span>&nbsp;<span class="num" id="7802402">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7802406">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7802410">if</span>&nbsp;<span class="ident" id="7802413">good</span>&nbsp;<span class="op" id="7802418">!=</span>&nbsp;<span class="ident" id="7802421">expectedGood</span>&nbsp;<span class="op" id="7802434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7802439">t</span><span class="op" id="7802440">.</span><span class="ident" id="7802441">Errorf</span><span class="op" id="7802447">(</span><span class="string" id="7802448">&#34;#%d:&nbsp;wrong&nbsp;validity,&nbsp;want:%d&nbsp;got:%d&#34;</span><span class="op" id="7802485">,</span>&nbsp;<span class="ident" id="7802487">i</span><span class="op" id="7802488">,</span>&nbsp;<span class="ident" id="7802490">expectedGood</span><span class="op" id="7802502">,</span>&nbsp;<span class="ident" id="7802504">good</span><span class="op" id="7802508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7802512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7802516">if</span>&nbsp;<span class="ident" id="7802519">good</span>&nbsp;<span class="op" id="7802524">==</span>&nbsp;<span class="num" id="7802527">255</span>&nbsp;<span class="op" id="7802531">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="7802534">len</span><span class="op" id="7802537">(</span><span class="ident" id="7802538">payload</span><span class="op" id="7802545">)</span>&nbsp;<span class="op" id="7802547">!=</span>&nbsp;<span class="ident" id="7802550">test</span><span class="op" id="7802554">.</span><span class="ident" id="7802555">expectedLen</span>&nbsp;<span class="op" id="7802567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7802572">t</span><span class="op" id="7802573">.</span><span class="ident" id="7802574">Errorf</span><span class="op" id="7802580">(</span><span class="string" id="7802581">&#34;#%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7802603">,</span>&nbsp;<span class="ident" id="7802605">i</span><span class="op" id="7802606">,</span>&nbsp;<span class="builtinfunc" id="7802608">len</span><span class="op" id="7802611">(</span><span class="ident" id="7802612">payload</span><span class="op" id="7802619">)</span><span class="op" id="7802620">,</span>&nbsp;<span class="ident" id="7802622">test</span><span class="op" id="7802626">.</span><span class="ident" id="7802627">expectedLen</span><span class="op" id="7802638">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7802642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7802645">}</span><br>
<span class="lineno"></span><span class="op" id="7802647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7802650">var</span>&nbsp;<span class="ident" id="7802654">certExampleCom</span>&nbsp;<span class="op" id="7802669">=</span>&nbsp;<span class="string" id="7802671">`308201403081eda003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313138353835325a170d3132303933303138353835325a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31a301830160603551d11040f300d820b6578616d706c652e636f6d300b06092a864886f70d0101050341001a0b419d2c74474c6450654e5f10b32bf426ffdf55cad1c52602e7a9151513a3424c70f5960dcd682db0c33769cc1daa3fcdd3db10809d2392ed4a1bf50ced18`</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="7803323">var</span>&nbsp;<span class="ident" id="7803327">certWildcardExampleCom</span>&nbsp;<span class="op" id="7803350">=</span>&nbsp;<span class="string" id="7803352">`308201423081efa003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303034365a170d3132303933303139303034365a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31c301a30180603551d110411300f820d2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001676f0c9e7c33c1b656ed5a6476c4e2ee9ec8e62df7407accb1875272b2edd0a22096cb2c22598d11604104d604f810eb4b5987ca6bb319c7e6ce48725c54059`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7804008">var</span>&nbsp;<span class="ident" id="7804012">certFooExampleCom</span>&nbsp;<span class="op" id="7804030">=</span>&nbsp;<span class="string" id="7804032">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303131345a170d3132303933303139303131345a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f666f6f2e6578616d706c652e636f6d300b06092a864886f70d010105034100646a2a51f2aa2477add854b462cf5207ba16d3213ffb5d3d0eed473fbf09935019192d1d5b8ca6a2407b424cf04d97c4cd9197c83ecf81f0eab9464a1109d09f`</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="7804692">var</span>&nbsp;<span class="ident" id="7804696">certDoubleWildcardExampleCom</span>&nbsp;<span class="op" id="7804725">=</span>&nbsp;<span class="string" id="7804727">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303134315a170d3132303933303139303134315a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f2a2e2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001c3de267975f56ef57771c6218ef95ecc65102e57bd1defe6f7efea90d9b26cf40de5bd7ad75e46201c7f2a92aaa3e907451e9409f65e28ddb6db80d726290f6`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7805387">func</span>&nbsp;<span class="ident" id="7805392">TestCertificateSelection</span><span class="op" id="7805416">(</span><span class="ident" id="7805417">t</span>&nbsp;<span class="op" id="7805419">*</span><span class="ident" id="7805420">testing</span><span class="op" id="7805427">.</span><span class="ident" id="7805428">T</span><span class="op" id="7805429">)</span>&nbsp;<span class="op" id="7805431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7805434">config</span>&nbsp;<span class="op" id="7805441">:=</span>&nbsp;<span class="ident" id="7805444">Config</span><span class="op" id="7805450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7805454">Certificates</span><span class="op" id="7805466">:</span>&nbsp;<span class="op" id="7805468">[</span><span class="op" id="7805469">]</span><span class="ident" id="7805470">Certificate</span><span class="op" id="7805481">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7805486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7805492">Certificate</span><span class="op" id="7805503">:</span>&nbsp;<span class="op" id="7805505">[</span><span class="op" id="7805506">]</span><span class="op" id="7805507">[</span><span class="op" id="7805508">]</span><span class="builtintype" id="7805509">byte</span><span class="op" id="7805513">{</span><span class="ident" id="7805514">fromHex</span><span class="op" id="7805521">(</span><span class="ident" id="7805522">certExampleCom</span><span class="op" id="7805536">)</span><span class="op" id="7805537">}</span><span class="op" id="7805538">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7805543">}</span><span class="op" id="7805544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7805549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7805555">Certificate</span><span class="op" id="7805566">:</span>&nbsp;<span class="op" id="7805568">[</span><span class="op" id="7805569">]</span><span class="op" id="7805570">[</span><span class="op" id="7805571">]</span><span class="builtintype" id="7805572">byte</span><span class="op" id="7805576">{</span><span class="ident" id="7805577">fromHex</span><span class="op" id="7805584">(</span><span class="ident" id="7805585">certWildcardExampleCom</span><span class="op" id="7805607">)</span><span class="op" id="7805608">}</span><span class="op" id="7805609">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7805614">}</span><span class="op" id="7805615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7805620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7805626">Certificate</span><span class="op" id="7805637">:</span>&nbsp;<span class="op" id="7805639">[</span><span class="op" id="7805640">]</span><span class="op" id="7805641">[</span><span class="op" id="7805642">]</span><span class="builtintype" id="7805643">byte</span><span class="op" id="7805647">{</span><span class="ident" id="7805648">fromHex</span><span class="op" id="7805655">(</span><span class="ident" id="7805656">certFooExampleCom</span><span class="op" id="7805673">)</span><span class="op" id="7805674">}</span><span class="op" id="7805675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7805680">}</span><span class="op" id="7805681">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7805686">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7805692">Certificate</span><span class="op" id="7805703">:</span>&nbsp;<span class="op" id="7805705">[</span><span class="op" id="7805706">]</span><span class="op" id="7805707">[</span><span class="op" id="7805708">]</span><span class="builtintype" id="7805709">byte</span><span class="op" id="7805713">{</span><span class="ident" id="7805714">fromHex</span><span class="op" id="7805721">(</span><span class="ident" id="7805722">certDoubleWildcardExampleCom</span><span class="op" id="7805750">)</span><span class="op" id="7805751">}</span><span class="op" id="7805752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7805757">}</span><span class="op" id="7805758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7805762">}</span><span class="op" id="7805763">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7805766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7805770">config</span><span class="op" id="7805776">.</span><span class="ident" id="7805777">BuildNameToCertificate</span><span class="op" id="7805799">(</span><span class="op" id="7805800">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7805804">pointerToIndex</span>&nbsp;<span class="op" id="7805819">:=</span>&nbsp;<span class="keyword" id="7805822">func</span><span class="op" id="7805826">(</span><span class="ident" id="7805827">c</span>&nbsp;<span class="op" id="7805829">*</span><span class="ident" id="7805830">Certificate</span><span class="op" id="7805841">)</span>&nbsp;<span class="builtintype" id="7805843">int</span>&nbsp;<span class="op" id="7805847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7805851">for</span>&nbsp;<span class="ident" id="7805855">i</span>&nbsp;<span class="op" id="7805857">:=</span>&nbsp;<span class="keyword" id="7805860">range</span>&nbsp;<span class="ident" id="7805866">config</span><span class="op" id="7805872">.</span><span class="ident" id="7805873">Certificates</span>&nbsp;<span class="op" id="7805886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7805891">if</span>&nbsp;<span class="ident" id="7805894">c</span>&nbsp;<span class="op" id="7805896">==</span>&nbsp;<span class="op" id="7805899">&amp;</span><span class="ident" id="7805900">config</span><span class="op" id="7805906">.</span><span class="ident" id="7805907">Certificates</span><span class="op" id="7805919">[</span><span class="ident" id="7805920">i</span><span class="op" id="7805921">]</span>&nbsp;<span class="op" id="7805923">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7805929">return</span>&nbsp;<span class="ident" id="7805936">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7805941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7805945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7805949">return</span>&nbsp;<span class="op" id="7805956">-</span><span class="num" id="7805957">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7805960">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7805964">certificateForName</span>&nbsp;<span class="op" id="7805983">:=</span>&nbsp;<span class="keyword" id="7805986">func</span><span class="op" id="7805990">(</span><span class="ident" id="7805991">name</span>&nbsp;<span class="builtintype" id="7805996">string</span><span class="op" id="7806002">)</span>&nbsp;<span class="op" id="7806004">*</span><span class="ident" id="7806005">Certificate</span>&nbsp;<span class="op" id="7806017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7806021">clientHello</span>&nbsp;<span class="op" id="7806033">:=</span>&nbsp;<span class="op" id="7806036">&amp;</span><span class="ident" id="7806037">ClientHelloInfo</span><span class="op" id="7806052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7806057">ServerName</span><span class="op" id="7806067">:</span>&nbsp;<span class="ident" id="7806069">name</span><span class="op" id="7806073">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7806077">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7806081">if</span>&nbsp;<span class="ident" id="7806084">cert</span><span class="op" id="7806088">,</span>&nbsp;<span class="ident" id="7806090">err</span>&nbsp;<span class="op" id="7806094">:=</span>&nbsp;<span class="ident" id="7806097">config</span><span class="op" id="7806103">.</span><span class="ident" id="7806104">getCertificate</span><span class="op" id="7806118">(</span><span class="ident" id="7806119">clientHello</span><span class="op" id="7806130">)</span><span class="op" id="7806131">;</span>&nbsp;<span class="ident" id="7806133">err</span>&nbsp;<span class="op" id="7806137">!=</span>&nbsp;<span class="ident" id="7806140">nil</span>&nbsp;<span class="op" id="7806144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7806149">t</span><span class="op" id="7806150">.</span><span class="ident" id="7806151">Errorf</span><span class="op" id="7806157">(</span><span class="string" id="7806158">&#34;unable&nbsp;to&nbsp;get&nbsp;certificate&nbsp;for&nbsp;name&nbsp;&#39;%s&#39;:&nbsp;%s&#34;</span><span class="op" id="7806203">,</span>&nbsp;<span class="ident" id="7806205">name</span><span class="op" id="7806209">,</span>&nbsp;<span class="ident" id="7806211">err</span><span class="op" id="7806214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7806219">return</span>&nbsp;<span class="ident" id="7806226">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7806232">}</span>&nbsp;<span class="keyword" id="7806234">else</span>&nbsp;<span class="op" id="7806239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7806244">return</span>&nbsp;<span class="ident" id="7806251">cert</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7806258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7806261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7806265">if</span>&nbsp;<span class="ident" id="7806268">n</span>&nbsp;<span class="op" id="7806270">:=</span>&nbsp;<span class="ident" id="7806273">pointerToIndex</span><span class="op" id="7806287">(</span><span class="ident" id="7806288">certificateForName</span><span class="op" id="7806306">(</span><span class="string" id="7806307">&#34;example.com&#34;</span><span class="op" id="7806320">)</span><span class="op" id="7806321">)</span><span class="op" id="7806322">;</span>&nbsp;<span class="ident" id="7806324">n</span>&nbsp;<span class="op" id="7806326">!=</span>&nbsp;<span class="num" id="7806329">0</span>&nbsp;<span class="op" id="7806331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7806335">t</span><span class="op" id="7806336">.</span><span class="ident" id="7806337">Errorf</span><span class="op" id="7806343">(</span><span class="string" id="7806344">&#34;example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="7806388">,</span>&nbsp;<span class="ident" id="7806390">n</span><span class="op" id="7806391">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7806394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7806397">if</span>&nbsp;<span class="ident" id="7806400">n</span>&nbsp;<span class="op" id="7806402">:=</span>&nbsp;<span class="ident" id="7806405">pointerToIndex</span><span class="op" id="7806419">(</span><span class="ident" id="7806420">certificateForName</span><span class="op" id="7806438">(</span><span class="string" id="7806439">&#34;bar.example.com&#34;</span><span class="op" id="7806456">)</span><span class="op" id="7806457">)</span><span class="op" id="7806458">;</span>&nbsp;<span class="ident" id="7806460">n</span>&nbsp;<span class="op" id="7806462">!=</span>&nbsp;<span class="num" id="7806465">1</span>&nbsp;<span class="op" id="7806467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7806471">t</span><span class="op" id="7806472">.</span><span class="ident" id="7806473">Errorf</span><span class="op" id="7806479">(</span><span class="string" id="7806480">&#34;bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;1&#34;</span><span class="op" id="7806528">,</span>&nbsp;<span class="ident" id="7806530">n</span><span class="op" id="7806531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7806534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7806537">if</span>&nbsp;<span class="ident" id="7806540">n</span>&nbsp;<span class="op" id="7806542">:=</span>&nbsp;<span class="ident" id="7806545">pointerToIndex</span><span class="op" id="7806559">(</span><span class="ident" id="7806560">certificateForName</span><span class="op" id="7806578">(</span><span class="string" id="7806579">&#34;foo.example.com&#34;</span><span class="op" id="7806596">)</span><span class="op" id="7806597">)</span><span class="op" id="7806598">;</span>&nbsp;<span class="ident" id="7806600">n</span>&nbsp;<span class="op" id="7806602">!=</span>&nbsp;<span class="num" id="7806605">2</span>&nbsp;<span class="op" id="7806607">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7806611">t</span><span class="op" id="7806612">.</span><span class="ident" id="7806613">Errorf</span><span class="op" id="7806619">(</span><span class="string" id="7806620">&#34;foo.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;2&#34;</span><span class="op" id="7806668">,</span>&nbsp;<span class="ident" id="7806670">n</span><span class="op" id="7806671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7806674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7806677">if</span>&nbsp;<span class="ident" id="7806680">n</span>&nbsp;<span class="op" id="7806682">:=</span>&nbsp;<span class="ident" id="7806685">pointerToIndex</span><span class="op" id="7806699">(</span><span class="ident" id="7806700">certificateForName</span><span class="op" id="7806718">(</span><span class="string" id="7806719">&#34;foo.bar.example.com&#34;</span><span class="op" id="7806740">)</span><span class="op" id="7806741">)</span><span class="op" id="7806742">;</span>&nbsp;<span class="ident" id="7806744">n</span>&nbsp;<span class="op" id="7806746">!=</span>&nbsp;<span class="num" id="7806749">3</span>&nbsp;<span class="op" id="7806751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7806755">t</span><span class="op" id="7806756">.</span><span class="ident" id="7806757">Errorf</span><span class="op" id="7806763">(</span><span class="string" id="7806764">&#34;foo.bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;3&#34;</span><span class="op" id="7806816">,</span>&nbsp;<span class="ident" id="7806818">n</span><span class="op" id="7806819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7806822">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7806825">if</span>&nbsp;<span class="ident" id="7806828">n</span>&nbsp;<span class="op" id="7806830">:=</span>&nbsp;<span class="ident" id="7806833">pointerToIndex</span><span class="op" id="7806847">(</span><span class="ident" id="7806848">certificateForName</span><span class="op" id="7806866">(</span><span class="string" id="7806867">&#34;foo.bar.baz.example.com&#34;</span><span class="op" id="7806892">)</span><span class="op" id="7806893">)</span><span class="op" id="7806894">;</span>&nbsp;<span class="ident" id="7806896">n</span>&nbsp;<span class="op" id="7806898">!=</span>&nbsp;<span class="num" id="7806901">0</span>&nbsp;<span class="op" id="7806903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7806907">t</span><span class="op" id="7806908">.</span><span class="ident" id="7806909">Errorf</span><span class="op" id="7806915">(</span><span class="string" id="7806916">&#34;foo.bar.baz.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="7806972">,</span>&nbsp;<span class="ident" id="7806974">n</span><span class="op" id="7806975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7806978">}</span><br>
<span class="lineno"></span><span class="op" id="7806980">}</span>
</div>
</body>
</html>
