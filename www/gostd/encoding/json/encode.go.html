<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/json</h2>
<ul>
<li><a href="/gostd/encoding/json/bench_test.go.html">bench_test.go</a></li>
<li><a href="/gostd/encoding/json/decode.go.html">decode.go</a></li>
<li><a href="/gostd/encoding/json/decode_test.go.html">decode_test.go</a></li>
<li><a href="/gostd/encoding/json/encode.go.html" class="current">encode.go</a></li>
<li><a href="/gostd/encoding/json/encode_test.go.html">encode_test.go</a></li>
<li><a href="/gostd/encoding/json/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/json/fold.go.html">fold.go</a></li>
<li><a href="/gostd/encoding/json/fold_test.go.html">fold_test.go</a></li>
<li><a href="/gostd/encoding/json/indent.go.html">indent.go</a></li>
<li><a href="/gostd/encoding/json/scanner.go.html">scanner.go</a></li>
<li><a href="/gostd/encoding/json/scanner_test.go.html">scanner_test.go</a></li>
<li><a href="/gostd/encoding/json/stream.go.html">stream.go</a></li>
<li><a href="/gostd/encoding/json/stream_test.go.html">stream_test.go</a></li>
<li><a href="/gostd/encoding/json/tagkey_test.go.html">tagkey_test.go</a></li>
<li><a href="/gostd/encoding/json/tags.go.html">tags.go</a></li>
<li><a href="/gostd/encoding/json/tags_test.go.html">tags_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3989661">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3989717">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3989771">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3989822">//&nbsp;Package&nbsp;json&nbsp;implements&nbsp;encoding&nbsp;and&nbsp;decoding&nbsp;of&nbsp;JSON&nbsp;objects&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3989901">//&nbsp;RFC&nbsp;4627.&nbsp;The&nbsp;mapping&nbsp;between&nbsp;JSON&nbsp;objects&nbsp;and&nbsp;Go&nbsp;values&nbsp;is&nbsp;described</span><br>
<span class="lineno"></span><span class="comment" id="3989974">//&nbsp;in&nbsp;the&nbsp;documentation&nbsp;for&nbsp;the&nbsp;Marshal&nbsp;and&nbsp;Unmarshal&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="3990039">//</span><br>
<span class="lineno"></span><span class="comment" id="3990042">//&nbsp;See&nbsp;&#34;JSON&nbsp;and&nbsp;Go&#34;&nbsp;for&nbsp;an&nbsp;introduction&nbsp;to&nbsp;this&nbsp;package:</span><br>
<span class="lineno">10</span><span class="comment" id="3990100">//&nbsp;http://golang.org/doc/articles/json_and_go.html</span><br>
<span class="lineno"></span><span class="keyword" id="3990151">package</span>&nbsp;<span class="ident" id="3990159">json</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3990165">import</span>&nbsp;<span class="op" id="3990172">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3990175">&#34;bytes&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3990184">&#34;encoding&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3990196">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3990215">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3990223">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3990234">&#34;runtime&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3990245">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3990253">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3990264">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3990275">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3990283">&#34;unicode&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3990294">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3990309">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3990312">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;JSON&nbsp;encoding&nbsp;of&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="3990355">//</span><br>
<span class="lineno">30</span><span class="comment" id="3990358">//&nbsp;Marshal&nbsp;traverses&nbsp;the&nbsp;value&nbsp;v&nbsp;recursively.</span><br>
<span class="lineno"></span><span class="comment" id="3990404">//&nbsp;If&nbsp;an&nbsp;encountered&nbsp;value&nbsp;implements&nbsp;the&nbsp;Marshaler&nbsp;interface</span><br>
<span class="lineno"></span><span class="comment" id="3990466">//&nbsp;and&nbsp;is&nbsp;not&nbsp;a&nbsp;nil&nbsp;pointer,&nbsp;Marshal&nbsp;calls&nbsp;its&nbsp;MarshalJSON&nbsp;method</span><br>
<span class="lineno"></span><span class="comment" id="3990532">//&nbsp;to&nbsp;produce&nbsp;JSON.&nbsp;&nbsp;The&nbsp;nil&nbsp;pointer&nbsp;exception&nbsp;is&nbsp;not&nbsp;strictly&nbsp;necessary</span><br>
<span class="lineno"></span><span class="comment" id="3990605">//&nbsp;but&nbsp;mimics&nbsp;a&nbsp;similar,&nbsp;necessary&nbsp;exception&nbsp;in&nbsp;the&nbsp;behavior&nbsp;of</span><br>
<span class="lineno">35</span><span class="comment" id="3990669">//&nbsp;UnmarshalJSON.</span><br>
<span class="lineno"></span><span class="comment" id="3990687">//</span><br>
<span class="lineno"></span><span class="comment" id="3990690">//&nbsp;Otherwise,&nbsp;Marshal&nbsp;uses&nbsp;the&nbsp;following&nbsp;type-dependent&nbsp;default&nbsp;encodings:</span><br>
<span class="lineno"></span><span class="comment" id="3990765">//</span><br>
<span class="lineno"></span><span class="comment" id="3990768">//&nbsp;Boolean&nbsp;values&nbsp;encode&nbsp;as&nbsp;JSON&nbsp;booleans.</span><br>
<span class="lineno">40</span><span class="comment" id="3990811">//</span><br>
<span class="lineno"></span><span class="comment" id="3990814">//&nbsp;Floating&nbsp;point,&nbsp;integer,&nbsp;and&nbsp;Number&nbsp;values&nbsp;encode&nbsp;as&nbsp;JSON&nbsp;numbers.</span><br>
<span class="lineno"></span><span class="comment" id="3990884">//</span><br>
<span class="lineno"></span><span class="comment" id="3990887">//&nbsp;String&nbsp;values&nbsp;encode&nbsp;as&nbsp;JSON&nbsp;strings&nbsp;coerced&nbsp;to&nbsp;valid&nbsp;UTF-8,</span><br>
<span class="lineno"></span><span class="comment" id="3990951">//&nbsp;replacing&nbsp;invalid&nbsp;bytes&nbsp;with&nbsp;the&nbsp;Unicode&nbsp;replacement&nbsp;rune.</span><br>
<span class="lineno">45</span><span class="comment" id="3991013">//&nbsp;The&nbsp;angle&nbsp;brackets&nbsp;&#34;&lt;&#34;&nbsp;and&nbsp;&#34;&gt;&#34;&nbsp;are&nbsp;escaped&nbsp;to&nbsp;&#34;\u003c&#34;&nbsp;and&nbsp;&#34;\u003e&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3991084">//&nbsp;to&nbsp;keep&nbsp;some&nbsp;browsers&nbsp;from&nbsp;misinterpreting&nbsp;JSON&nbsp;output&nbsp;as&nbsp;HTML.</span><br>
<span class="lineno"></span><span class="comment" id="3991151">//&nbsp;Ampersand&nbsp;&#34;&amp;&#34;&nbsp;is&nbsp;also&nbsp;escaped&nbsp;to&nbsp;&#34;\u0026&#34;&nbsp;for&nbsp;the&nbsp;same&nbsp;reason.</span><br>
<span class="lineno"></span><span class="comment" id="3991217">//</span><br>
<span class="lineno"></span><span class="comment" id="3991220">//&nbsp;Array&nbsp;and&nbsp;slice&nbsp;values&nbsp;encode&nbsp;as&nbsp;JSON&nbsp;arrays,&nbsp;except&nbsp;that</span><br>
<span class="lineno">50</span><span class="comment" id="3991281">//&nbsp;[]byte&nbsp;encodes&nbsp;as&nbsp;a&nbsp;base64-encoded&nbsp;string,&nbsp;and&nbsp;a&nbsp;nil&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="3991343">//&nbsp;encodes&nbsp;as&nbsp;the&nbsp;null&nbsp;JSON&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="3991379">//</span><br>
<span class="lineno"></span><span class="comment" id="3991382">//&nbsp;Struct&nbsp;values&nbsp;encode&nbsp;as&nbsp;JSON&nbsp;objects.&nbsp;Each&nbsp;exported&nbsp;struct&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="3991450">//&nbsp;becomes&nbsp;a&nbsp;member&nbsp;of&nbsp;the&nbsp;object&nbsp;unless</span><br>
<span class="lineno">55</span><span class="comment" id="3991491">//&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;field&#39;s&nbsp;tag&nbsp;is&nbsp;&#34;-&#34;,&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="3991525">//&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;field&nbsp;is&nbsp;empty&nbsp;and&nbsp;its&nbsp;tag&nbsp;specifies&nbsp;the&nbsp;&#34;omitempty&#34;&nbsp;option.</span><br>
<span class="lineno"></span><span class="comment" id="3991597">//&nbsp;The&nbsp;empty&nbsp;values&nbsp;are&nbsp;false,&nbsp;0,&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="3991635">//&nbsp;nil&nbsp;pointer&nbsp;or&nbsp;interface&nbsp;value,&nbsp;and&nbsp;any&nbsp;array,&nbsp;slice,&nbsp;map,&nbsp;or&nbsp;string&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3991710">//&nbsp;length&nbsp;zero.&nbsp;The&nbsp;object&#39;s&nbsp;default&nbsp;key&nbsp;string&nbsp;is&nbsp;the&nbsp;struct&nbsp;field&nbsp;name</span><br>
<span class="lineno">60</span><span class="comment" id="3991783">//&nbsp;but&nbsp;can&nbsp;be&nbsp;specified&nbsp;in&nbsp;the&nbsp;struct&nbsp;field&#39;s&nbsp;tag&nbsp;value.&nbsp;The&nbsp;&#34;json&#34;&nbsp;key&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3991858">//&nbsp;the&nbsp;struct&nbsp;field&#39;s&nbsp;tag&nbsp;value&nbsp;is&nbsp;the&nbsp;key&nbsp;name,&nbsp;followed&nbsp;by&nbsp;an&nbsp;optional&nbsp;comma</span><br>
<span class="lineno"></span><span class="comment" id="3991937">//&nbsp;and&nbsp;options.&nbsp;Examples:</span><br>
<span class="lineno"></span><span class="comment" id="3991963">//</span><br>
<span class="lineno"></span><span class="comment" id="3991966">//&nbsp;&nbsp;&nbsp;//&nbsp;Field&nbsp;is&nbsp;ignored&nbsp;by&nbsp;this&nbsp;package.</span><br>
<span class="lineno">65</span><span class="comment" id="3992008">//&nbsp;&nbsp;&nbsp;Field&nbsp;int&nbsp;`json:&#34;-&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="3992034">//</span><br>
<span class="lineno"></span><span class="comment" id="3992037">//&nbsp;&nbsp;&nbsp;//&nbsp;Field&nbsp;appears&nbsp;in&nbsp;JSON&nbsp;as&nbsp;key&nbsp;&#34;myName&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3992084">//&nbsp;&nbsp;&nbsp;Field&nbsp;int&nbsp;`json:&#34;myName&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="3992115">//</span><br>
<span class="lineno">70</span><span class="comment" id="3992118">//&nbsp;&nbsp;&nbsp;//&nbsp;Field&nbsp;appears&nbsp;in&nbsp;JSON&nbsp;as&nbsp;key&nbsp;&#34;myName&#34;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3992168">//&nbsp;&nbsp;&nbsp;//&nbsp;the&nbsp;field&nbsp;is&nbsp;omitted&nbsp;from&nbsp;the&nbsp;object&nbsp;if&nbsp;its&nbsp;value&nbsp;is&nbsp;empty,</span><br>
<span class="lineno"></span><span class="comment" id="3992236">//&nbsp;&nbsp;&nbsp;//&nbsp;as&nbsp;defined&nbsp;above.</span><br>
<span class="lineno"></span><span class="comment" id="3992262">//&nbsp;&nbsp;&nbsp;Field&nbsp;int&nbsp;`json:&#34;myName,omitempty&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="3992303">//</span><br>
<span class="lineno">75</span><span class="comment" id="3992306">//&nbsp;&nbsp;&nbsp;//&nbsp;Field&nbsp;appears&nbsp;in&nbsp;JSON&nbsp;as&nbsp;key&nbsp;&#34;Field&#34;&nbsp;(the&nbsp;default),&nbsp;but</span><br>
<span class="lineno"></span><span class="comment" id="3992370">//&nbsp;&nbsp;&nbsp;//&nbsp;the&nbsp;field&nbsp;is&nbsp;skipped&nbsp;if&nbsp;empty.</span><br>
<span class="lineno"></span><span class="comment" id="3992409">//&nbsp;&nbsp;&nbsp;//&nbsp;Note&nbsp;the&nbsp;leading&nbsp;comma.</span><br>
<span class="lineno"></span><span class="comment" id="3992441">//&nbsp;&nbsp;&nbsp;Field&nbsp;int&nbsp;`json:&#34;,omitempty&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="3992476">//</span><br>
<span class="lineno">80</span><span class="comment" id="3992479">//&nbsp;The&nbsp;&#34;string&#34;&nbsp;option&nbsp;signals&nbsp;that&nbsp;a&nbsp;field&nbsp;is&nbsp;stored&nbsp;as&nbsp;JSON&nbsp;inside&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3992550">//&nbsp;JSON-encoded&nbsp;string.&nbsp;It&nbsp;applies&nbsp;only&nbsp;to&nbsp;fields&nbsp;of&nbsp;string,&nbsp;floating&nbsp;point,</span><br>
<span class="lineno"></span><span class="comment" id="3992627">//&nbsp;or&nbsp;integer&nbsp;types.&nbsp;This&nbsp;extra&nbsp;level&nbsp;of&nbsp;encoding&nbsp;is&nbsp;sometimes&nbsp;used&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="3992700">//&nbsp;communicating&nbsp;with&nbsp;JavaScript&nbsp;programs:</span><br>
<span class="lineno"></span><span class="comment" id="3992743">//</span><br>
<span class="lineno">85</span><span class="comment" id="3992746">//&nbsp;&nbsp;&nbsp;&nbsp;Int64String&nbsp;int64&nbsp;`json:&#34;,string&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="3992787">//</span><br>
<span class="lineno"></span><span class="comment" id="3992790">//&nbsp;The&nbsp;key&nbsp;name&nbsp;will&nbsp;be&nbsp;used&nbsp;if&nbsp;it&#39;s&nbsp;a&nbsp;non-empty&nbsp;string&nbsp;consisting&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3992860">//&nbsp;only&nbsp;Unicode&nbsp;letters,&nbsp;digits,&nbsp;dollar&nbsp;signs,&nbsp;percent&nbsp;signs,&nbsp;hyphens,</span><br>
<span class="lineno"></span><span class="comment" id="3992931">//&nbsp;underscores&nbsp;and&nbsp;slashes.</span><br>
<span class="lineno">90</span><span class="comment" id="3992959">//</span><br>
<span class="lineno"></span><span class="comment" id="3992962">//&nbsp;Anonymous&nbsp;struct&nbsp;fields&nbsp;are&nbsp;usually&nbsp;marshaled&nbsp;as&nbsp;if&nbsp;their&nbsp;inner&nbsp;exported&nbsp;fields</span><br>
<span class="lineno"></span><span class="comment" id="3993045">//&nbsp;were&nbsp;fields&nbsp;in&nbsp;the&nbsp;outer&nbsp;struct,&nbsp;subject&nbsp;to&nbsp;the&nbsp;usual&nbsp;Go&nbsp;visibility&nbsp;rules&nbsp;amended</span><br>
<span class="lineno"></span><span class="comment" id="3993130">//&nbsp;as&nbsp;described&nbsp;in&nbsp;the&nbsp;next&nbsp;paragraph.</span><br>
<span class="lineno"></span><span class="comment" id="3993169">//&nbsp;An&nbsp;anonymous&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name&nbsp;given&nbsp;in&nbsp;its&nbsp;JSON&nbsp;tag&nbsp;is&nbsp;treated&nbsp;as</span><br>
<span class="lineno">95</span><span class="comment" id="3993246">//&nbsp;having&nbsp;that&nbsp;name,&nbsp;rather&nbsp;than&nbsp;being&nbsp;anonymous.</span><br>
<span class="lineno"></span><span class="comment" id="3993296">//&nbsp;An&nbsp;anonymous&nbsp;struct&nbsp;field&nbsp;of&nbsp;interface&nbsp;type&nbsp;is&nbsp;treated&nbsp;the&nbsp;same&nbsp;as&nbsp;having</span><br>
<span class="lineno"></span><span class="comment" id="3993373">//&nbsp;that&nbsp;type&nbsp;as&nbsp;its&nbsp;name,&nbsp;rather&nbsp;than&nbsp;being&nbsp;anonymous.</span><br>
<span class="lineno"></span><span class="comment" id="3993428">//</span><br>
<span class="lineno"></span><span class="comment" id="3993431">//&nbsp;The&nbsp;Go&nbsp;visibility&nbsp;rules&nbsp;for&nbsp;struct&nbsp;fields&nbsp;are&nbsp;amended&nbsp;for&nbsp;JSON&nbsp;when</span><br>
<span class="lineno">100</span><span class="comment" id="3993502">//&nbsp;deciding&nbsp;which&nbsp;field&nbsp;to&nbsp;marshal&nbsp;or&nbsp;unmarshal.&nbsp;If&nbsp;there&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="3993564">//&nbsp;multiple&nbsp;fields&nbsp;at&nbsp;the&nbsp;same&nbsp;level,&nbsp;and&nbsp;that&nbsp;level&nbsp;is&nbsp;the&nbsp;least</span><br>
<span class="lineno"></span><span class="comment" id="3993630">//&nbsp;nested&nbsp;(and&nbsp;would&nbsp;therefore&nbsp;be&nbsp;the&nbsp;nesting&nbsp;level&nbsp;selected&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3993698">//&nbsp;usual&nbsp;Go&nbsp;rules),&nbsp;the&nbsp;following&nbsp;extra&nbsp;rules&nbsp;apply:</span><br>
<span class="lineno"></span><span class="comment" id="3993751">//</span><br>
<span class="lineno">105</span><span class="comment" id="3993754">//&nbsp;1)&nbsp;Of&nbsp;those&nbsp;fields,&nbsp;if&nbsp;any&nbsp;are&nbsp;JSON-tagged,&nbsp;only&nbsp;tagged&nbsp;fields&nbsp;are&nbsp;considered,</span><br>
<span class="lineno"></span><span class="comment" id="3993836">//&nbsp;even&nbsp;if&nbsp;there&nbsp;are&nbsp;multiple&nbsp;untagged&nbsp;fields&nbsp;that&nbsp;would&nbsp;otherwise&nbsp;conflict.</span><br>
<span class="lineno"></span><span class="comment" id="3993913">//&nbsp;2)&nbsp;If&nbsp;there&nbsp;is&nbsp;exactly&nbsp;one&nbsp;field&nbsp;(tagged&nbsp;or&nbsp;not&nbsp;according&nbsp;to&nbsp;the&nbsp;first&nbsp;rule),&nbsp;that&nbsp;is&nbsp;selected.</span><br>
<span class="lineno"></span><span class="comment" id="3994012">//&nbsp;3)&nbsp;Otherwise&nbsp;there&nbsp;are&nbsp;multiple&nbsp;fields,&nbsp;and&nbsp;all&nbsp;are&nbsp;ignored;&nbsp;no&nbsp;error&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="comment" id="3994093">//</span><br>
<span class="lineno">110</span><span class="comment" id="3994096">//&nbsp;Handling&nbsp;of&nbsp;anonymous&nbsp;struct&nbsp;fields&nbsp;is&nbsp;new&nbsp;in&nbsp;Go&nbsp;1.1.</span><br>
<span class="lineno"></span><span class="comment" id="3994153">//&nbsp;Prior&nbsp;to&nbsp;Go&nbsp;1.1,&nbsp;anonymous&nbsp;struct&nbsp;fields&nbsp;were&nbsp;ignored.&nbsp;To&nbsp;force&nbsp;ignoring&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3994232">//&nbsp;an&nbsp;anonymous&nbsp;struct&nbsp;field&nbsp;in&nbsp;both&nbsp;current&nbsp;and&nbsp;earlier&nbsp;versions,&nbsp;give&nbsp;the&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="3994314">//&nbsp;a&nbsp;JSON&nbsp;tag&nbsp;of&nbsp;&#34;-&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3994336">//</span><br>
<span class="lineno">115</span><span class="comment" id="3994339">//&nbsp;Map&nbsp;values&nbsp;encode&nbsp;as&nbsp;JSON&nbsp;objects.</span><br>
<span class="lineno"></span><span class="comment" id="3994377">//&nbsp;The&nbsp;map&#39;s&nbsp;key&nbsp;type&nbsp;must&nbsp;be&nbsp;string;&nbsp;the&nbsp;object&nbsp;keys&nbsp;are&nbsp;used&nbsp;directly</span><br>
<span class="lineno"></span><span class="comment" id="3994449">//&nbsp;as&nbsp;map&nbsp;keys.</span><br>
<span class="lineno"></span><span class="comment" id="3994465">//</span><br>
<span class="lineno"></span><span class="comment" id="3994468">//&nbsp;Pointer&nbsp;values&nbsp;encode&nbsp;as&nbsp;the&nbsp;value&nbsp;pointed&nbsp;to.</span><br>
<span class="lineno">120</span><span class="comment" id="3994518">//&nbsp;A&nbsp;nil&nbsp;pointer&nbsp;encodes&nbsp;as&nbsp;the&nbsp;null&nbsp;JSON&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="3994568">//</span><br>
<span class="lineno"></span><span class="comment" id="3994571">//&nbsp;Interface&nbsp;values&nbsp;encode&nbsp;as&nbsp;the&nbsp;value&nbsp;contained&nbsp;in&nbsp;the&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="3994639">//&nbsp;A&nbsp;nil&nbsp;interface&nbsp;value&nbsp;encodes&nbsp;as&nbsp;the&nbsp;null&nbsp;JSON&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="3994697">//</span><br>
<span class="lineno">125</span><span class="comment" id="3994700">//&nbsp;Channel,&nbsp;complex,&nbsp;and&nbsp;function&nbsp;values&nbsp;cannot&nbsp;be&nbsp;encoded&nbsp;in&nbsp;JSON.</span><br>
<span class="lineno"></span><span class="comment" id="3994768">//&nbsp;Attempting&nbsp;to&nbsp;encode&nbsp;such&nbsp;a&nbsp;value&nbsp;causes&nbsp;Marshal&nbsp;to&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="3994830">//&nbsp;an&nbsp;UnsupportedTypeError.</span><br>
<span class="lineno"></span><span class="comment" id="3994858">//</span><br>
<span class="lineno"></span><span class="comment" id="3994861">//&nbsp;JSON&nbsp;cannot&nbsp;represent&nbsp;cyclic&nbsp;data&nbsp;structures&nbsp;and&nbsp;Marshal&nbsp;does&nbsp;not</span><br>
<span class="lineno">130</span><span class="comment" id="3994930">//&nbsp;handle&nbsp;them.&nbsp;&nbsp;Passing&nbsp;cyclic&nbsp;structures&nbsp;to&nbsp;Marshal&nbsp;will&nbsp;result&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3994999">//&nbsp;an&nbsp;infinite&nbsp;recursion.</span><br>
<span class="lineno"></span><span class="comment" id="3995025">//</span><br>
<span class="lineno"></span><span class="keyword" id="3995028">func</span>&nbsp;<span class="ident" id="3995033">Marshal</span><span class="op" id="3995040">(</span><span class="ident" id="3995041">v</span>&nbsp;<span class="keyword" id="3995043">interface</span><span class="op" id="3995052">{</span><span class="op" id="3995053">}</span><span class="op" id="3995054">)</span>&nbsp;<span class="op" id="3995056">(</span><span class="op" id="3995057">[</span><span class="op" id="3995058">]</span><span class="builtintype" id="3995059">byte</span><span class="op" id="3995063">,</span>&nbsp;<span class="builtintype" id="3995065">error</span><span class="op" id="3995070">)</span>&nbsp;<span class="op" id="3995072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3995075">e</span>&nbsp;<span class="op" id="3995077">:=</span>&nbsp;<span class="op" id="3995080">&amp;</span><span class="ident" id="3995081"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="3995092">{</span><span class="op" id="3995093">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3995096">err</span>&nbsp;<span class="op" id="3995100">:=</span>&nbsp;<span class="ident" id="3995103"><a href="/gostd/encoding/json/encode.go.html#3995075">e</a></span><span class="op" id="3995104">.</span><span class="ident" id="3995105"><a href="/gostd/encoding/json/encode.go.html#3998390">marshal</a></span><span class="op" id="3995112">(</span><span class="ident" id="3995113"><a href="/gostd/encoding/json/encode.go.html#3995041">v</a></span><span class="op" id="3995114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3995117">if</span>&nbsp;<span class="ident" id="3995120"><a href="/gostd/encoding/json/encode.go.html#3995096">err</a></span>&nbsp;<span class="op" id="3995124">!=</span>&nbsp;<span class="builtintype" id="3995127">nil</span>&nbsp;<span class="op" id="3995131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3995135">return</span>&nbsp;<span class="builtintype" id="3995142">nil</span><span class="op" id="3995145">,</span>&nbsp;<span class="ident" id="3995147"><a href="/gostd/encoding/json/encode.go.html#3995096">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3995152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3995155">return</span>&nbsp;<span class="ident" id="3995162"><a href="/gostd/encoding/json/encode.go.html#3995075">e</a></span><span class="op" id="3995163">.</span><span class="ident" id="3995164"><a href="/gostd/bytes/buffer.go.html#1384454">Bytes</a></span><span class="op" id="3995169">(</span><span class="op" id="3995170">)</span><span class="op" id="3995171">,</span>&nbsp;<span class="builtintype" id="3995173">nil</span><br>
<span class="lineno">140</span><span class="op" id="3995177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3995180">//&nbsp;MarshalIndent&nbsp;is&nbsp;like&nbsp;Marshal&nbsp;but&nbsp;applies&nbsp;Indent&nbsp;to&nbsp;format&nbsp;the&nbsp;output.</span><br>
<span class="lineno"></span><span class="keyword" id="3995254">func</span>&nbsp;<span class="ident" id="3995259">MarshalIndent</span><span class="op" id="3995272">(</span><span class="ident" id="3995273">v</span>&nbsp;<span class="keyword" id="3995275">interface</span><span class="op" id="3995284">{</span><span class="op" id="3995285">}</span><span class="op" id="3995286">,</span>&nbsp;<span class="ident" id="3995288">prefix</span><span class="op" id="3995294">,</span>&nbsp;<span class="ident" id="3995296">indent</span>&nbsp;<span class="builtintype" id="3995303">string</span><span class="op" id="3995309">)</span>&nbsp;<span class="op" id="3995311">(</span><span class="op" id="3995312">[</span><span class="op" id="3995313">]</span><span class="builtintype" id="3995314">byte</span><span class="op" id="3995318">,</span>&nbsp;<span class="builtintype" id="3995320">error</span><span class="op" id="3995325">)</span>&nbsp;<span class="op" id="3995327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3995330">b</span><span class="op" id="3995331">,</span>&nbsp;<span class="ident" id="3995333">err</span>&nbsp;<span class="op" id="3995337">:=</span>&nbsp;<span class="ident" id="3995340"><a href="/gostd/encoding/json/encode.go.html#3995033">Marshal</a></span><span class="op" id="3995347">(</span><span class="ident" id="3995348"><a href="/gostd/encoding/json/encode.go.html#3995273">v</a></span><span class="op" id="3995349">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3995352">if</span>&nbsp;<span class="ident" id="3995355"><a href="/gostd/encoding/json/encode.go.html#3995333">err</a></span>&nbsp;<span class="op" id="3995359">!=</span>&nbsp;<span class="builtintype" id="3995362">nil</span>&nbsp;<span class="op" id="3995366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3995370">return</span>&nbsp;<span class="builtintype" id="3995377">nil</span><span class="op" id="3995380">,</span>&nbsp;<span class="ident" id="3995382"><a href="/gostd/encoding/json/encode.go.html#3995333">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3995387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3995390">var</span>&nbsp;<span class="ident" id="3995394">buf</span>&nbsp;<span class="ident" id="3995398"><a href="/gostd/encoding/json/encode.go.html#3990175">bytes</a></span><span class="op" id="3995403">.</span><span class="ident" id="3995404"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3995412"><a href="/gostd/encoding/json/encode.go.html#3995333">err</a></span>&nbsp;<span class="op" id="3995416">=</span>&nbsp;<span class="ident" id="3995418"><a href="/gostd/encoding/json/indent.go.html#4025963">Indent</a></span><span class="op" id="3995424">(</span><span class="op" id="3995425">&amp;</span><span class="ident" id="3995426"><a href="/gostd/encoding/json/encode.go.html#3995394">buf</a></span><span class="op" id="3995429">,</span>&nbsp;<span class="ident" id="3995431"><a href="/gostd/encoding/json/encode.go.html#3995330">b</a></span><span class="op" id="3995432">,</span>&nbsp;<span class="ident" id="3995434"><a href="/gostd/encoding/json/encode.go.html#3995288">prefix</a></span><span class="op" id="3995440">,</span>&nbsp;<span class="ident" id="3995442"><a href="/gostd/encoding/json/encode.go.html#3995296">indent</a></span><span class="op" id="3995448">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3995451">if</span>&nbsp;<span class="ident" id="3995454"><a href="/gostd/encoding/json/encode.go.html#3995333">err</a></span>&nbsp;<span class="op" id="3995458">!=</span>&nbsp;<span class="builtintype" id="3995461">nil</span>&nbsp;<span class="op" id="3995465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3995469">return</span>&nbsp;<span class="builtintype" id="3995476">nil</span><span class="op" id="3995479">,</span>&nbsp;<span class="ident" id="3995481"><a href="/gostd/encoding/json/encode.go.html#3995333">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3995486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3995489">return</span>&nbsp;<span class="ident" id="3995496"><a href="/gostd/encoding/json/encode.go.html#3995394">buf</a></span><span class="op" id="3995499">.</span><span class="ident" id="3995500"><a href="/gostd/bytes/buffer.go.html#1384454">Bytes</a></span><span class="op" id="3995505">(</span><span class="op" id="3995506">)</span><span class="op" id="3995507">,</span>&nbsp;<span class="builtintype" id="3995509">nil</span><br>
<span class="lineno"></span><span class="op" id="3995513">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="3995516">//&nbsp;HTMLEscape&nbsp;appends&nbsp;to&nbsp;dst&nbsp;the&nbsp;JSON-encoded&nbsp;src&nbsp;with&nbsp;&lt;,&nbsp;&gt;,&nbsp;&amp;,&nbsp;U+2028&nbsp;and&nbsp;U+2029</span><br>
<span class="lineno"></span><span class="comment" id="3995598">//&nbsp;characters&nbsp;inside&nbsp;string&nbsp;literals&nbsp;changed&nbsp;to&nbsp;\u003c,&nbsp;\u003e,&nbsp;\u0026,&nbsp;\u2028,&nbsp;\u2029</span><br>
<span class="lineno"></span><span class="comment" id="3995685">//&nbsp;so&nbsp;that&nbsp;the&nbsp;JSON&nbsp;will&nbsp;be&nbsp;safe&nbsp;to&nbsp;embed&nbsp;inside&nbsp;HTML&nbsp;&lt;script&gt;&nbsp;tags.</span><br>
<span class="lineno"></span><span class="comment" id="3995754">//&nbsp;For&nbsp;historical&nbsp;reasons,&nbsp;web&nbsp;browsers&nbsp;don&#39;t&nbsp;honor&nbsp;standard&nbsp;HTML</span><br>
<span class="lineno">160</span><span class="comment" id="3995820">//&nbsp;escaping&nbsp;within&nbsp;&lt;script&gt;&nbsp;tags,&nbsp;so&nbsp;an&nbsp;alternative&nbsp;JSON&nbsp;encoding&nbsp;must</span><br>
<span class="lineno"></span><span class="comment" id="3995891">//&nbsp;be&nbsp;used.</span><br>
<span class="lineno"></span><span class="keyword" id="3995903">func</span>&nbsp;<span class="ident" id="3995908">HTMLEscape</span><span class="op" id="3995918">(</span><span class="ident" id="3995919">dst</span>&nbsp;<span class="op" id="3995923">*</span><span class="ident" id="3995924"><a href="/gostd/encoding/json/encode.go.html#3990175">bytes</a></span><span class="op" id="3995929">.</span><span class="ident" id="3995930"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="3995936">,</span>&nbsp;<span class="ident" id="3995938">src</span>&nbsp;<span class="op" id="3995942">[</span><span class="op" id="3995943">]</span><span class="builtintype" id="3995944">byte</span><span class="op" id="3995948">)</span>&nbsp;<span class="op" id="3995950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3995953">//&nbsp;The&nbsp;characters&nbsp;can&nbsp;only&nbsp;appear&nbsp;in&nbsp;string&nbsp;literals,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3996008">//&nbsp;so&nbsp;just&nbsp;scan&nbsp;the&nbsp;string&nbsp;one&nbsp;byte&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3996056">start</span>&nbsp;<span class="op" id="3996062">:=</span>&nbsp;<span class="num" id="3996065">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3996068">for</span>&nbsp;<span class="ident" id="3996072">i</span><span class="op" id="3996073">,</span>&nbsp;<span class="ident" id="3996075">c</span>&nbsp;<span class="op" id="3996077">:=</span>&nbsp;<span class="keyword" id="3996080">range</span>&nbsp;<span class="ident" id="3996086"><a href="/gostd/encoding/json/encode.go.html#3995938">src</a></span>&nbsp;<span class="op" id="3996090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3996094">if</span>&nbsp;<span class="ident" id="3996097"><a href="/gostd/encoding/json/encode.go.html#3996075">c</a></span>&nbsp;<span class="op" id="3996099">==</span>&nbsp;<span class="string" id="3996102">&#39;&lt;&#39;</span>&nbsp;<span class="op" id="3996106">||</span>&nbsp;<span class="ident" id="3996109"><a href="/gostd/encoding/json/encode.go.html#3996075">c</a></span>&nbsp;<span class="op" id="3996111">==</span>&nbsp;<span class="string" id="3996114">&#39;&gt;&#39;</span>&nbsp;<span class="op" id="3996118">||</span>&nbsp;<span class="ident" id="3996121"><a href="/gostd/encoding/json/encode.go.html#3996075">c</a></span>&nbsp;<span class="op" id="3996123">==</span>&nbsp;<span class="string" id="3996126">&#39;&amp;&#39;</span>&nbsp;<span class="op" id="3996130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3996135">if</span>&nbsp;<span class="ident" id="3996138"><a href="/gostd/encoding/json/encode.go.html#3996056">start</a></span>&nbsp;<span class="op" id="3996144">&lt;</span>&nbsp;<span class="ident" id="3996146"><a href="/gostd/encoding/json/encode.go.html#3996072">i</a></span>&nbsp;<span class="op" id="3996148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3996154"><a href="/gostd/encoding/json/encode.go.html#3995919">dst</a></span><span class="op" id="3996157">.</span><span class="ident" id="3996158"><a href="/gostd/bytes/buffer.go.html#1387016">Write</a></span><span class="op" id="3996163">(</span><span class="ident" id="3996164"><a href="/gostd/encoding/json/encode.go.html#3995938">src</a></span><span class="op" id="3996167">[</span><span class="ident" id="3996168"><a href="/gostd/encoding/json/encode.go.html#3996056">start</a></span><span class="op" id="3996173">:</span><span class="ident" id="3996174"><a href="/gostd/encoding/json/encode.go.html#3996072">i</a></span><span class="op" id="3996175">]</span><span class="op" id="3996176">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3996181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3996186"><a href="/gostd/encoding/json/encode.go.html#3995919">dst</a></span><span class="op" id="3996189">.</span><span class="ident" id="3996190"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="3996201">(</span><span class="string" id="3996202">`\u00`</span><span class="op" id="3996208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3996213"><a href="/gostd/encoding/json/encode.go.html#3995919">dst</a></span><span class="op" id="3996216">.</span><span class="ident" id="3996217"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="3996226">(</span><span class="ident" id="3996227"><a href="/gostd/encoding/json/encode.go.html#3998013">hex</a></span><span class="op" id="3996230">[</span><span class="ident" id="3996231"><a href="/gostd/encoding/json/encode.go.html#3996075">c</a></span><span class="op" id="3996232">&gt;&gt;</span><span class="num" id="3996234">4</span><span class="op" id="3996235">]</span><span class="op" id="3996236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3996241"><a href="/gostd/encoding/json/encode.go.html#3995919">dst</a></span><span class="op" id="3996244">.</span><span class="ident" id="3996245"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="3996254">(</span><span class="ident" id="3996255"><a href="/gostd/encoding/json/encode.go.html#3998013">hex</a></span><span class="op" id="3996258">[</span><span class="ident" id="3996259"><a href="/gostd/encoding/json/encode.go.html#3996075">c</a></span><span class="op" id="3996260">&amp;</span><span class="num" id="3996261">0xF</span><span class="op" id="3996264">]</span><span class="op" id="3996265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3996270"><a href="/gostd/encoding/json/encode.go.html#3996056">start</a></span>&nbsp;<span class="op" id="3996276">=</span>&nbsp;<span class="ident" id="3996278"><a href="/gostd/encoding/json/encode.go.html#3996072">i</a></span>&nbsp;<span class="op" id="3996280">+</span>&nbsp;<span class="num" id="3996282">1</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3996286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3996290">//&nbsp;Convert&nbsp;U+2028&nbsp;and&nbsp;U+2029&nbsp;(E2&nbsp;80&nbsp;A8&nbsp;and&nbsp;E2&nbsp;80&nbsp;A9).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3996346">if</span>&nbsp;<span class="ident" id="3996349"><a href="/gostd/encoding/json/encode.go.html#3996075">c</a></span>&nbsp;<span class="op" id="3996351">==</span>&nbsp;<span class="num" id="3996354">0xE2</span>&nbsp;<span class="op" id="3996359">&amp;&amp;</span>&nbsp;<span class="ident" id="3996362"><a href="/gostd/encoding/json/encode.go.html#3996072">i</a></span><span class="op" id="3996363">+</span><span class="num" id="3996364">2</span>&nbsp;<span class="op" id="3996366">&lt;</span>&nbsp;<span class="builtinfunc" id="3996368">len</span><span class="op" id="3996371">(</span><span class="ident" id="3996372"><a href="/gostd/encoding/json/encode.go.html#3995938">src</a></span><span class="op" id="3996375">)</span>&nbsp;<span class="op" id="3996377">&amp;&amp;</span>&nbsp;<span class="ident" id="3996380"><a href="/gostd/encoding/json/encode.go.html#3995938">src</a></span><span class="op" id="3996383">[</span><span class="ident" id="3996384"><a href="/gostd/encoding/json/encode.go.html#3996072">i</a></span><span class="op" id="3996385">+</span><span class="num" id="3996386">1</span><span class="op" id="3996387">]</span>&nbsp;<span class="op" id="3996389">==</span>&nbsp;<span class="num" id="3996392">0x80</span>&nbsp;<span class="op" id="3996397">&amp;&amp;</span>&nbsp;<span class="ident" id="3996400"><a href="/gostd/encoding/json/encode.go.html#3995938">src</a></span><span class="op" id="3996403">[</span><span class="ident" id="3996404"><a href="/gostd/encoding/json/encode.go.html#3996072">i</a></span><span class="op" id="3996405">+</span><span class="num" id="3996406">2</span><span class="op" id="3996407">]</span><span class="op" id="3996408">&amp;^</span><span class="num" id="3996410">1</span>&nbsp;<span class="op" id="3996412">==</span>&nbsp;<span class="num" id="3996415">0xA8</span>&nbsp;<span class="op" id="3996420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3996425">if</span>&nbsp;<span class="ident" id="3996428"><a href="/gostd/encoding/json/encode.go.html#3996056">start</a></span>&nbsp;<span class="op" id="3996434">&lt;</span>&nbsp;<span class="ident" id="3996436"><a href="/gostd/encoding/json/encode.go.html#3996072">i</a></span>&nbsp;<span class="op" id="3996438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3996444"><a href="/gostd/encoding/json/encode.go.html#3995919">dst</a></span><span class="op" id="3996447">.</span><span class="ident" id="3996448"><a href="/gostd/bytes/buffer.go.html#1387016">Write</a></span><span class="op" id="3996453">(</span><span class="ident" id="3996454"><a href="/gostd/encoding/json/encode.go.html#3995938">src</a></span><span class="op" id="3996457">[</span><span class="ident" id="3996458"><a href="/gostd/encoding/json/encode.go.html#3996056">start</a></span><span class="op" id="3996463">:</span><span class="ident" id="3996464"><a href="/gostd/encoding/json/encode.go.html#3996072">i</a></span><span class="op" id="3996465">]</span><span class="op" id="3996466">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3996471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3996476"><a href="/gostd/encoding/json/encode.go.html#3995919">dst</a></span><span class="op" id="3996479">.</span><span class="ident" id="3996480"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="3996491">(</span><span class="string" id="3996492">`\u202`</span><span class="op" id="3996499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3996504"><a href="/gostd/encoding/json/encode.go.html#3995919">dst</a></span><span class="op" id="3996507">.</span><span class="ident" id="3996508"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="3996517">(</span><span class="ident" id="3996518"><a href="/gostd/encoding/json/encode.go.html#3998013">hex</a></span><span class="op" id="3996521">[</span><span class="ident" id="3996522"><a href="/gostd/encoding/json/encode.go.html#3995938">src</a></span><span class="op" id="3996525">[</span><span class="ident" id="3996526"><a href="/gostd/encoding/json/encode.go.html#3996072">i</a></span><span class="op" id="3996527">+</span><span class="num" id="3996528">2</span><span class="op" id="3996529">]</span><span class="op" id="3996530">&amp;</span><span class="num" id="3996531">0xF</span><span class="op" id="3996534">]</span><span class="op" id="3996535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3996540"><a href="/gostd/encoding/json/encode.go.html#3996056">start</a></span>&nbsp;<span class="op" id="3996546">=</span>&nbsp;<span class="ident" id="3996548"><a href="/gostd/encoding/json/encode.go.html#3996072">i</a></span>&nbsp;<span class="op" id="3996550">+</span>&nbsp;<span class="num" id="3996552">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3996556">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3996559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3996562">if</span>&nbsp;<span class="ident" id="3996565"><a href="/gostd/encoding/json/encode.go.html#3996056">start</a></span>&nbsp;<span class="op" id="3996571">&lt;</span>&nbsp;<span class="builtinfunc" id="3996573">len</span><span class="op" id="3996576">(</span><span class="ident" id="3996577"><a href="/gostd/encoding/json/encode.go.html#3995938">src</a></span><span class="op" id="3996580">)</span>&nbsp;<span class="op" id="3996582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3996586"><a href="/gostd/encoding/json/encode.go.html#3995919">dst</a></span><span class="op" id="3996589">.</span><span class="ident" id="3996590"><a href="/gostd/bytes/buffer.go.html#1387016">Write</a></span><span class="op" id="3996595">(</span><span class="ident" id="3996596"><a href="/gostd/encoding/json/encode.go.html#3995938">src</a></span><span class="op" id="3996599">[</span><span class="ident" id="3996600"><a href="/gostd/encoding/json/encode.go.html#3996056">start</a></span><span class="op" id="3996605">:</span><span class="op" id="3996606">]</span><span class="op" id="3996607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3996610">}</span><br>
<span class="lineno"></span><span class="op" id="3996612">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="3996615">//&nbsp;Marshaler&nbsp;is&nbsp;the&nbsp;interface&nbsp;implemented&nbsp;by&nbsp;objects&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3996673">//&nbsp;can&nbsp;marshal&nbsp;themselves&nbsp;into&nbsp;valid&nbsp;JSON.</span><br>
<span class="lineno"></span><span class="keyword" id="3996716">type</span>&nbsp;<span class="ident" id="3996721">Marshaler</span>&nbsp;<span class="keyword" id="3996731">interface</span>&nbsp;<span class="op" id="3996741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3996744">MarshalJSON</span><span class="op" id="3996755">(</span><span class="op" id="3996756">)</span>&nbsp;<span class="op" id="3996758">(</span><span class="op" id="3996759">[</span><span class="op" id="3996760">]</span><span class="builtintype" id="3996761">byte</span><span class="op" id="3996765">,</span>&nbsp;<span class="builtintype" id="3996767">error</span><span class="op" id="3996772">)</span><br>
<span class="lineno">195</span><span class="op" id="3996774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3996777">//&nbsp;An&nbsp;UnsupportedTypeError&nbsp;is&nbsp;returned&nbsp;by&nbsp;Marshal&nbsp;when&nbsp;attempting</span><br>
<span class="lineno"></span><span class="comment" id="3996843">//&nbsp;to&nbsp;encode&nbsp;an&nbsp;unsupported&nbsp;value&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3996883">type</span>&nbsp;<span class="ident" id="3996888">UnsupportedTypeError</span>&nbsp;<span class="keyword" id="3996909">struct</span>&nbsp;<span class="op" id="3996916">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3996919">Type</span>&nbsp;<span class="ident" id="3996924"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3996931">.</span><span class="ident" id="3996932"><a href="/gostd/reflect/type.go.html#2781467">Type</a></span><br>
<span class="lineno"></span><span class="op" id="3996937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3996940">func</span>&nbsp;<span class="op" id="3996945">(</span><span class="ident" id="3996946">e</span>&nbsp;<span class="op" id="3996948">*</span><span class="ident" id="3996949"><a href="/gostd/encoding/json/encode.go.html#3996888">UnsupportedTypeError</a></span><span class="op" id="3996969">)</span>&nbsp;<span class="ident" id="3996971">Error</span><span class="op" id="3996976">(</span><span class="op" id="3996977">)</span>&nbsp;<span class="builtintype" id="3996979">string</span>&nbsp;<span class="op" id="3996986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3996989">return</span>&nbsp;<span class="string" id="3996996">&#34;json:&nbsp;unsupported&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="3997023">+</span>&nbsp;<span class="ident" id="3997025"><a href="/gostd/encoding/json/encode.go.html#3996946">e</a></span><span class="op" id="3997026">.</span><span class="ident" id="3997027"><a href="/gostd/encoding/json/encode.go.html#3996919">Type</a></span><span class="op" id="3997031">.</span><span class="ident" id="3997032"><a href="/gostd/reflect/type.go.html#2783552">String</a></span><span class="op" id="3997038">(</span><span class="op" id="3997039">)</span><br>
<span class="lineno">205</span><span class="op" id="3997041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3997044">type</span>&nbsp;<span class="ident" id="3997049">UnsupportedValueError</span>&nbsp;<span class="keyword" id="3997071">struct</span>&nbsp;<span class="op" id="3997078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3997081">Value</span>&nbsp;<span class="ident" id="3997087"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3997094">.</span><span class="ident" id="3997095"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3997102">Str</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3997108">string</span><br>
<span class="lineno">210</span><span class="op" id="3997115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3997118">func</span>&nbsp;<span class="op" id="3997123">(</span><span class="ident" id="3997124">e</span>&nbsp;<span class="op" id="3997126">*</span><span class="ident" id="3997127"><a href="/gostd/encoding/json/encode.go.html#3997049">UnsupportedValueError</a></span><span class="op" id="3997148">)</span>&nbsp;<span class="ident" id="3997150">Error</span><span class="op" id="3997155">(</span><span class="op" id="3997156">)</span>&nbsp;<span class="builtintype" id="3997158">string</span>&nbsp;<span class="op" id="3997165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3997168">return</span>&nbsp;<span class="string" id="3997175">&#34;json:&nbsp;unsupported&nbsp;value:&nbsp;&#34;</span>&nbsp;<span class="op" id="3997203">+</span>&nbsp;<span class="ident" id="3997205"><a href="/gostd/encoding/json/encode.go.html#3997124">e</a></span><span class="op" id="3997206">.</span><span class="ident" id="3997207"><a href="/gostd/encoding/json/encode.go.html#3997102">Str</a></span><br>
<span class="lineno"></span><span class="op" id="3997211">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="comment" id="3997214">//&nbsp;Before&nbsp;Go&nbsp;1.2,&nbsp;an&nbsp;InvalidUTF8Error&nbsp;was&nbsp;returned&nbsp;by&nbsp;Marshal&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="3997281">//&nbsp;attempting&nbsp;to&nbsp;encode&nbsp;a&nbsp;string&nbsp;value&nbsp;with&nbsp;invalid&nbsp;UTF-8&nbsp;sequences.</span><br>
<span class="lineno"></span><span class="comment" id="3997350">//&nbsp;As&nbsp;of&nbsp;Go&nbsp;1.2,&nbsp;Marshal&nbsp;instead&nbsp;coerces&nbsp;the&nbsp;string&nbsp;to&nbsp;valid&nbsp;UTF-8&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3997420">//&nbsp;replacing&nbsp;invalid&nbsp;bytes&nbsp;with&nbsp;the&nbsp;Unicode&nbsp;replacement&nbsp;rune&nbsp;U+FFFD.</span><br>
<span class="lineno">220</span><span class="comment" id="3997489">//&nbsp;This&nbsp;error&nbsp;is&nbsp;no&nbsp;longer&nbsp;generated&nbsp;but&nbsp;is&nbsp;kept&nbsp;for&nbsp;backwards&nbsp;compatibility</span><br>
<span class="lineno"></span><span class="comment" id="3997566">//&nbsp;with&nbsp;programs&nbsp;that&nbsp;might&nbsp;mention&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3997606">type</span>&nbsp;<span class="ident" id="3997611">InvalidUTF8Error</span>&nbsp;<span class="keyword" id="3997628">struct</span>&nbsp;<span class="op" id="3997635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3997638">S</span>&nbsp;<span class="builtintype" id="3997640">string</span>&nbsp;<span class="comment" id="3997647">//&nbsp;the&nbsp;whole&nbsp;string&nbsp;value&nbsp;that&nbsp;caused&nbsp;the&nbsp;error</span><br>
<span class="lineno"></span><span class="op" id="3997695">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="keyword" id="3997698">func</span>&nbsp;<span class="op" id="3997703">(</span><span class="ident" id="3997704">e</span>&nbsp;<span class="op" id="3997706">*</span><span class="ident" id="3997707"><a href="/gostd/encoding/json/encode.go.html#3997611">InvalidUTF8Error</a></span><span class="op" id="3997723">)</span>&nbsp;<span class="ident" id="3997725">Error</span><span class="op" id="3997730">(</span><span class="op" id="3997731">)</span>&nbsp;<span class="builtintype" id="3997733">string</span>&nbsp;<span class="op" id="3997740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3997743">return</span>&nbsp;<span class="string" id="3997750">&#34;json:&nbsp;invalid&nbsp;UTF-8&nbsp;in&nbsp;string:&nbsp;&#34;</span>&nbsp;<span class="op" id="3997784">+</span>&nbsp;<span class="ident" id="3997786"><a href="/gostd/encoding/json/encode.go.html#3990253">strconv</a></span><span class="op" id="3997793">.</span><span class="ident" id="3997794"><a href="/gostd/strconv/quote.go.html#2412032">Quote</a></span><span class="op" id="3997799">(</span><span class="ident" id="3997800"><a href="/gostd/encoding/json/encode.go.html#3997704">e</a></span><span class="op" id="3997801">.</span><span class="ident" id="3997802"><a href="/gostd/encoding/json/encode.go.html#3997638">S</a></span><span class="op" id="3997803">)</span><br>
<span class="lineno"></span><span class="op" id="3997805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="3997808">type</span>&nbsp;<span class="ident" id="3997813">MarshalerError</span>&nbsp;<span class="keyword" id="3997828">struct</span>&nbsp;<span class="op" id="3997835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3997838">Type</span>&nbsp;<span class="ident" id="3997843"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3997850">.</span><span class="ident" id="3997851"><a href="/gostd/reflect/type.go.html#2781467">Type</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3997857">Err</span>&nbsp;&nbsp;<span class="builtintype" id="3997862">error</span><br>
<span class="lineno"></span><span class="op" id="3997868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="3997871">func</span>&nbsp;<span class="op" id="3997876">(</span><span class="ident" id="3997877">e</span>&nbsp;<span class="op" id="3997879">*</span><span class="ident" id="3997880"><a href="/gostd/encoding/json/encode.go.html#3997813">MarshalerError</a></span><span class="op" id="3997894">)</span>&nbsp;<span class="ident" id="3997896">Error</span><span class="op" id="3997901">(</span><span class="op" id="3997902">)</span>&nbsp;<span class="builtintype" id="3997904">string</span>&nbsp;<span class="op" id="3997911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3997914">return</span>&nbsp;<span class="string" id="3997921">&#34;json:&nbsp;error&nbsp;calling&nbsp;MarshalJSON&nbsp;for&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="3997965">+</span>&nbsp;<span class="ident" id="3997967"><a href="/gostd/encoding/json/encode.go.html#3997877">e</a></span><span class="op" id="3997968">.</span><span class="ident" id="3997969"><a href="/gostd/encoding/json/encode.go.html#3997838">Type</a></span><span class="op" id="3997973">.</span><span class="ident" id="3997974"><a href="/gostd/reflect/type.go.html#2783552">String</a></span><span class="op" id="3997980">(</span><span class="op" id="3997981">)</span>&nbsp;<span class="op" id="3997983">+</span>&nbsp;<span class="string" id="3997985">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="3997990">+</span>&nbsp;<span class="ident" id="3997992"><a href="/gostd/encoding/json/encode.go.html#3997877">e</a></span><span class="op" id="3997993">.</span><span class="ident" id="3997994"><a href="/gostd/encoding/json/encode.go.html#3997857">Err</a></span><span class="op" id="3997997">.</span><span class="ident" id="3997998">Error</span><span class="op" id="3998003">(</span><span class="op" id="3998004">)</span><br>
<span class="lineno"></span><span class="op" id="3998006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3998009">var</span>&nbsp;<span class="ident" id="3998013">hex</span>&nbsp;<span class="op" id="3998017">=</span>&nbsp;<span class="string" id="3998019">&#34;0123456789abcdef&#34;</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="comment" id="3998039">//&nbsp;An&nbsp;encodeState&nbsp;encodes&nbsp;JSON&nbsp;into&nbsp;a&nbsp;bytes.Buffer.</span><br>
<span class="lineno"></span><span class="keyword" id="3998091">type</span>&nbsp;<span class="ident" id="3998096">encodeState</span>&nbsp;<span class="keyword" id="3998108">struct</span>&nbsp;<span class="op" id="3998115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3998118"><a href="/gostd/encoding/json/encode.go.html#3990175">bytes</a></span><span class="op" id="3998123">.</span><span class="ident" id="3998124"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span>&nbsp;<span class="comment" id="3998131">//&nbsp;accumulated&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3998154">scratch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3998167">[</span><span class="num" id="3998168">64</span><span class="op" id="3998170">]</span><span class="builtintype" id="3998171">byte</span><br>
<span class="lineno">245</span><span class="op" id="3998176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3998179">var</span>&nbsp;<span class="ident" id="3998183">encodeStatePool</span>&nbsp;<span class="ident" id="3998199"><a href="/gostd/encoding/json/encode.go.html#3990275">sync</a></span><span class="op" id="3998203">.</span><span class="ident" id="3998204"><a href="/gostd/sync/pool.go.html#1448866">Pool</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3998210">func</span>&nbsp;<span class="ident" id="3998215">newEncodeState</span><span class="op" id="3998229">(</span><span class="op" id="3998230">)</span>&nbsp;<span class="op" id="3998232">*</span><span class="ident" id="3998233"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span>&nbsp;<span class="op" id="3998245">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3998248">if</span>&nbsp;<span class="ident" id="3998251">v</span>&nbsp;<span class="op" id="3998253">:=</span>&nbsp;<span class="ident" id="3998256"><a href="/gostd/encoding/json/encode.go.html#3998183">encodeStatePool</a></span><span class="op" id="3998271">.</span><span class="ident" id="3998272"><a href="/gostd/sync/pool.go.html#1450329">Get</a></span><span class="op" id="3998275">(</span><span class="op" id="3998276">)</span><span class="op" id="3998277">;</span>&nbsp;<span class="ident" id="3998279"><a href="/gostd/encoding/json/encode.go.html#3998251">v</a></span>&nbsp;<span class="op" id="3998281">!=</span>&nbsp;<span class="builtintype" id="3998284">nil</span>&nbsp;<span class="op" id="3998288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3998292">e</span>&nbsp;<span class="op" id="3998294">:=</span>&nbsp;<span class="ident" id="3998297"><a href="/gostd/encoding/json/encode.go.html#3998251">v</a></span><span class="op" id="3998298">.</span><span class="op" id="3998299">(</span><span class="op" id="3998300">*</span><span class="ident" id="3998301"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="3998312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3998316"><a href="/gostd/encoding/json/encode.go.html#3998292">e</a></span><span class="op" id="3998317">.</span><span class="ident" id="3998318"><a href="/gostd/bytes/buffer.go.html#1385417">Reset</a></span><span class="op" id="3998323">(</span><span class="op" id="3998324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3998328">return</span>&nbsp;<span class="ident" id="3998335"><a href="/gostd/encoding/json/encode.go.html#3998292">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3998338">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3998341">return</span>&nbsp;<span class="builtinfunc" id="3998348">new</span><span class="op" id="3998351">(</span><span class="ident" id="3998352"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="3998363">)</span><br>
<span class="lineno"></span><span class="op" id="3998365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3998368">func</span>&nbsp;<span class="op" id="3998373">(</span><span class="ident" id="3998374">e</span>&nbsp;<span class="op" id="3998376">*</span><span class="ident" id="3998377"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="3998388">)</span>&nbsp;<span class="ident" id="3998390">marshal</span><span class="op" id="3998397">(</span><span class="ident" id="3998398">v</span>&nbsp;<span class="keyword" id="3998400">interface</span><span class="op" id="3998409">{</span><span class="op" id="3998410">}</span><span class="op" id="3998411">)</span>&nbsp;<span class="op" id="3998413">(</span><span class="ident" id="3998414">err</span>&nbsp;<span class="builtintype" id="3998418">error</span><span class="op" id="3998423">)</span>&nbsp;<span class="op" id="3998425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3998428">defer</span>&nbsp;<span class="keyword" id="3998434">func</span><span class="op" id="3998438">(</span><span class="op" id="3998439">)</span>&nbsp;<span class="op" id="3998441">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3998445">if</span>&nbsp;<span class="ident" id="3998448">r</span>&nbsp;<span class="op" id="3998450">:=</span>&nbsp;<span class="builtinfunc" id="3998453">recover</span><span class="op" id="3998460">(</span><span class="op" id="3998461">)</span><span class="op" id="3998462">;</span>&nbsp;<span class="ident" id="3998464"><a href="/gostd/encoding/json/encode.go.html#3998448">r</a></span>&nbsp;<span class="op" id="3998466">!=</span>&nbsp;<span class="builtintype" id="3998469">nil</span>&nbsp;<span class="op" id="3998473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3998478">if</span>&nbsp;<span class="ident" id="3998481">_</span><span class="op" id="3998482">,</span>&nbsp;<span class="ident" id="3998484">ok</span>&nbsp;<span class="op" id="3998487">:=</span>&nbsp;<span class="ident" id="3998490"><a href="/gostd/encoding/json/encode.go.html#3998448">r</a></span><span class="op" id="3998491">.</span><span class="op" id="3998492">(</span><span class="ident" id="3998493"><a href="/gostd/encoding/json/encode.go.html#3990234">runtime</a></span><span class="op" id="3998500">.</span><span class="ident" id="3998501"><a href="/gostd/runtime/error.go.html#1524079">Error</a></span><span class="op" id="3998506">)</span><span class="op" id="3998507">;</span>&nbsp;<span class="ident" id="3998509"><a href="/gostd/encoding/json/encode.go.html#3998484">ok</a></span>&nbsp;<span class="op" id="3998512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3998518">panic</span><span class="op" id="3998523">(</span><span class="ident" id="3998524"><a href="/gostd/encoding/json/encode.go.html#3998448">r</a></span><span class="op" id="3998525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3998530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3998535">if</span>&nbsp;<span class="ident" id="3998538">s</span><span class="op" id="3998539">,</span>&nbsp;<span class="ident" id="3998541">ok</span>&nbsp;<span class="op" id="3998544">:=</span>&nbsp;<span class="ident" id="3998547"><a href="/gostd/encoding/json/encode.go.html#3998448">r</a></span><span class="op" id="3998548">.</span><span class="op" id="3998549">(</span><span class="builtintype" id="3998550">string</span><span class="op" id="3998556">)</span><span class="op" id="3998557">;</span>&nbsp;<span class="ident" id="3998559"><a href="/gostd/encoding/json/encode.go.html#3998541">ok</a></span>&nbsp;<span class="op" id="3998562">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3998568">panic</span><span class="op" id="3998573">(</span><span class="ident" id="3998574"><a href="/gostd/encoding/json/encode.go.html#3998538">s</a></span><span class="op" id="3998575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3998580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3998585"><a href="/gostd/encoding/json/encode.go.html#3998414">err</a></span>&nbsp;<span class="op" id="3998589">=</span>&nbsp;<span class="ident" id="3998591"><a href="/gostd/encoding/json/encode.go.html#3998448">r</a></span><span class="op" id="3998592">.</span><span class="op" id="3998593">(</span><span class="builtintype" id="3998594">error</span><span class="op" id="3998599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3998603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3998606">}</span><span class="op" id="3998607">(</span><span class="op" id="3998608">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3998611"><a href="/gostd/encoding/json/encode.go.html#3998374">e</a></span><span class="op" id="3998612">.</span><span class="ident" id="3998613"><a href="/gostd/encoding/json/encode.go.html#3999339">reflectValue</a></span><span class="op" id="3998625">(</span><span class="ident" id="3998626"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3998633">.</span><span class="ident" id="3998634"><a href="/gostd/reflect/value.go.html#2892536">ValueOf</a></span><span class="op" id="3998641">(</span><span class="ident" id="3998642"><a href="/gostd/encoding/json/encode.go.html#3998398">v</a></span><span class="op" id="3998643">)</span><span class="op" id="3998644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3998647">return</span>&nbsp;<span class="builtintype" id="3998654">nil</span><br>
<span class="lineno"></span><span class="op" id="3998658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3998661">func</span>&nbsp;<span class="op" id="3998666">(</span><span class="ident" id="3998667">e</span>&nbsp;<span class="op" id="3998669">*</span><span class="ident" id="3998670"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="3998681">)</span>&nbsp;<span class="builtintype" id="3998683">error</span><span class="op" id="3998688">(</span><span class="ident" id="3998689">err</span>&nbsp;<span class="builtintype" id="3998693">error</span><span class="op" id="3998698">)</span>&nbsp;<span class="op" id="3998700">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3998703">panic</span><span class="op" id="3998708">(</span><span class="ident" id="3998709"><a href="/gostd/encoding/json/encode.go.html#3998689">err</a></span><span class="op" id="3998712">)</span><br>
<span class="lineno"></span><span class="op" id="3998714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3998717">var</span>&nbsp;<span class="ident" id="3998721">byteSliceType</span>&nbsp;<span class="op" id="3998735">=</span>&nbsp;<span class="ident" id="3998737"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3998744">.</span><span class="ident" id="3998745"><a href="/gostd/reflect/type.go.html#2808718">TypeOf</a></span><span class="op" id="3998751">(</span><span class="op" id="3998752">[</span><span class="op" id="3998753">]</span><span class="builtintype" id="3998754">byte</span><span class="op" id="3998758">(</span><span class="builtintype" id="3998759">nil</span><span class="op" id="3998762">)</span><span class="op" id="3998763">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="3998766">func</span>&nbsp;<span class="ident" id="3998771">isEmptyValue</span><span class="op" id="3998783">(</span><span class="ident" id="3998784">v</span>&nbsp;<span class="ident" id="3998786"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3998793">.</span><span class="ident" id="3998794"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="3998799">)</span>&nbsp;<span class="builtintype" id="3998801">bool</span>&nbsp;<span class="op" id="3998806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3998809">switch</span>&nbsp;<span class="ident" id="3998816"><a href="/gostd/encoding/json/encode.go.html#3998784">v</a></span><span class="op" id="3998817">.</span><span class="ident" id="3998818"><a href="/gostd/reflect/value.go.html#2861487">Kind</a></span><span class="op" id="3998822">(</span><span class="op" id="3998823">)</span>&nbsp;<span class="op" id="3998825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3998828">case</span>&nbsp;<span class="ident" id="3998833"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3998840">.</span><span class="ident" id="3998841"><a href="/gostd/reflect/type.go.html#2788022">Array</a></span><span class="op" id="3998846">,</span>&nbsp;<span class="ident" id="3998848"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3998855">.</span><span class="ident" id="3998856"><a href="/gostd/reflect/type.go.html#2788052">Map</a></span><span class="op" id="3998859">,</span>&nbsp;<span class="ident" id="3998861"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3998868">.</span><span class="ident" id="3998869"><a href="/gostd/reflect/type.go.html#2788062">Slice</a></span><span class="op" id="3998874">,</span>&nbsp;<span class="ident" id="3998876"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3998883">.</span><span class="ident" id="3998884"><a href="/gostd/reflect/type.go.html#2788069">String</a></span><span class="op" id="3998890">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3998894">return</span>&nbsp;<span class="ident" id="3998901"><a href="/gostd/encoding/json/encode.go.html#3998784">v</a></span><span class="op" id="3998902">.</span><span class="ident" id="3998903"><a href="/gostd/reflect/value.go.html#2861631">Len</a></span><span class="op" id="3998906">(</span><span class="op" id="3998907">)</span>&nbsp;<span class="op" id="3998909">==</span>&nbsp;<span class="num" id="3998912">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3998915">case</span>&nbsp;<span class="ident" id="3998920"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3998927">.</span><span class="ident" id="3998928"><a href="/gostd/reflect/type.go.html#2787897">Bool</a></span><span class="op" id="3998932">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3998936">return</span>&nbsp;<span class="op" id="3998943">!</span><span class="ident" id="3998944"><a href="/gostd/encoding/json/encode.go.html#3998784">v</a></span><span class="op" id="3998945">.</span><span class="ident" id="3998946"><a href="/gostd/reflect/value.go.html#2839754">Bool</a></span><span class="op" id="3998950">(</span><span class="op" id="3998951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3998954">case</span>&nbsp;<span class="ident" id="3998959"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3998966">.</span><span class="ident" id="3998967"><a href="/gostd/reflect/type.go.html#2787903">Int</a></span><span class="op" id="3998970">,</span>&nbsp;<span class="ident" id="3998972"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3998979">.</span><span class="ident" id="3998980"><a href="/gostd/reflect/type.go.html#2787908">Int8</a></span><span class="op" id="3998984">,</span>&nbsp;<span class="ident" id="3998986"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3998993">.</span><span class="ident" id="3998994"><a href="/gostd/reflect/type.go.html#2787914">Int16</a></span><span class="op" id="3998999">,</span>&nbsp;<span class="ident" id="3999001"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3999008">.</span><span class="ident" id="3999009"><a href="/gostd/reflect/type.go.html#2787921">Int32</a></span><span class="op" id="3999014">,</span>&nbsp;<span class="ident" id="3999016"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3999023">.</span><span class="ident" id="3999024"><a href="/gostd/reflect/type.go.html#2787928">Int64</a></span><span class="op" id="3999029">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3999033">return</span>&nbsp;<span class="ident" id="3999040"><a href="/gostd/encoding/json/encode.go.html#3998784">v</a></span><span class="op" id="3999041">.</span><span class="ident" id="3999042"><a href="/gostd/reflect/value.go.html#2857929">Int</a></span><span class="op" id="3999045">(</span><span class="op" id="3999046">)</span>&nbsp;<span class="op" id="3999048">==</span>&nbsp;<span class="num" id="3999051">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3999054">case</span>&nbsp;<span class="ident" id="3999059"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3999066">.</span><span class="ident" id="3999067"><a href="/gostd/reflect/type.go.html#2787935">Uint</a></span><span class="op" id="3999071">,</span>&nbsp;<span class="ident" id="3999073"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3999080">.</span><span class="ident" id="3999081"><a href="/gostd/reflect/type.go.html#2787941">Uint8</a></span><span class="op" id="3999086">,</span>&nbsp;<span class="ident" id="3999088"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3999095">.</span><span class="ident" id="3999096"><a href="/gostd/reflect/type.go.html#2787948">Uint16</a></span><span class="op" id="3999102">,</span>&nbsp;<span class="ident" id="3999104"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3999111">.</span><span class="ident" id="3999112"><a href="/gostd/reflect/type.go.html#2787956">Uint32</a></span><span class="op" id="3999118">,</span>&nbsp;<span class="ident" id="3999120"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3999127">.</span><span class="ident" id="3999128"><a href="/gostd/reflect/type.go.html#2787964">Uint64</a></span><span class="op" id="3999134">,</span>&nbsp;<span class="ident" id="3999136"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3999143">.</span><span class="ident" id="3999144"><a href="/gostd/reflect/type.go.html#2787972">Uintptr</a></span><span class="op" id="3999151">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3999155">return</span>&nbsp;<span class="ident" id="3999162"><a href="/gostd/encoding/json/encode.go.html#3998784">v</a></span><span class="op" id="3999163">.</span><span class="ident" id="3999164"><a href="/gostd/reflect/value.go.html#2881772">Uint</a></span><span class="op" id="3999168">(</span><span class="op" id="3999169">)</span>&nbsp;<span class="op" id="3999171">==</span>&nbsp;<span class="num" id="3999174">0</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3999177">case</span>&nbsp;<span class="ident" id="3999182"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3999189">.</span><span class="ident" id="3999190"><a href="/gostd/reflect/type.go.html#2787981">Float32</a></span><span class="op" id="3999197">,</span>&nbsp;<span class="ident" id="3999199"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3999206">.</span><span class="ident" id="3999207"><a href="/gostd/reflect/type.go.html#2787990">Float64</a></span><span class="op" id="3999214">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3999218">return</span>&nbsp;<span class="ident" id="3999225"><a href="/gostd/encoding/json/encode.go.html#3998784">v</a></span><span class="op" id="3999226">.</span><span class="ident" id="3999227"><a href="/gostd/reflect/value.go.html#2856007">Float</a></span><span class="op" id="3999232">(</span><span class="op" id="3999233">)</span>&nbsp;<span class="op" id="3999235">==</span>&nbsp;<span class="num" id="3999238">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3999241">case</span>&nbsp;<span class="ident" id="3999246"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3999253">.</span><span class="ident" id="3999254"><a href="/gostd/reflect/type.go.html#2788041">Interface</a></span><span class="op" id="3999263">,</span>&nbsp;<span class="ident" id="3999265"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3999272">.</span><span class="ident" id="3999273"><a href="/gostd/reflect/type.go.html#2788057">Ptr</a></span><span class="op" id="3999276">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3999280">return</span>&nbsp;<span class="ident" id="3999287"><a href="/gostd/encoding/json/encode.go.html#3998784">v</a></span><span class="op" id="3999288">.</span><span class="ident" id="3999289"><a href="/gostd/reflect/value.go.html#2860565">IsNil</a></span><span class="op" id="3999294">(</span><span class="op" id="3999295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3999298">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3999301">return</span>&nbsp;<span class="builtintype" id="3999308">false</span><br>
<span class="lineno"></span><span class="op" id="3999314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3999317">func</span>&nbsp;<span class="op" id="3999322">(</span><span class="ident" id="3999323">e</span>&nbsp;<span class="op" id="3999325">*</span><span class="ident" id="3999326"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="3999337">)</span>&nbsp;<span class="ident" id="3999339">reflectValue</span><span class="op" id="3999351">(</span><span class="ident" id="3999352">v</span>&nbsp;<span class="ident" id="3999354"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3999361">.</span><span class="ident" id="3999362"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="3999367">)</span>&nbsp;<span class="op" id="3999369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3999372"><a href="/gostd/encoding/json/encode.go.html#3999553">valueEncoder</a></span><span class="op" id="3999384">(</span><span class="ident" id="3999385"><a href="/gostd/encoding/json/encode.go.html#3999352">v</a></span><span class="op" id="3999386">)</span><span class="op" id="3999387">(</span><span class="ident" id="3999388"><a href="/gostd/encoding/json/encode.go.html#3999323">e</a></span><span class="op" id="3999389">,</span>&nbsp;<span class="ident" id="3999391"><a href="/gostd/encoding/json/encode.go.html#3999352">v</a></span><span class="op" id="3999392">,</span>&nbsp;<span class="builtintype" id="3999394">false</span><span class="op" id="3999399">)</span><br>
<span class="lineno">300</span><span class="op" id="3999401">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3999404">type</span>&nbsp;<span class="ident" id="3999409">encoderFunc</span>&nbsp;<span class="keyword" id="3999421">func</span><span class="op" id="3999425">(</span><span class="ident" id="3999426">e</span>&nbsp;<span class="op" id="3999428">*</span><span class="ident" id="3999429"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="3999440">,</span>&nbsp;<span class="ident" id="3999442">v</span>&nbsp;<span class="ident" id="3999444"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3999451">.</span><span class="ident" id="3999452"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="3999457">,</span>&nbsp;<span class="ident" id="3999459">quoted</span>&nbsp;<span class="builtintype" id="3999466">bool</span><span class="op" id="3999470">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3999473">var</span>&nbsp;<span class="ident" id="3999477">encoderCache</span>&nbsp;<span class="keyword" id="3999490">struct</span>&nbsp;<span class="op" id="3999497">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3999500"><a href="/gostd/encoding/json/encode.go.html#3990275">sync</a></span><span class="op" id="3999504">.</span><span class="ident" id="3999505"><a href="/gostd/sync/rwmutex.go.html#1456076">RWMutex</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3999514">m</span>&nbsp;<span class="keyword" id="3999516">map</span><span class="op" id="3999519">[</span><span class="ident" id="3999520"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3999527">.</span><span class="ident" id="3999528"><a href="/gostd/reflect/type.go.html#2781467">Type</a></span><span class="op" id="3999532">]</span><span class="ident" id="3999533"><a href="/gostd/encoding/json/encode.go.html#3999409">encoderFunc</a></span><br>
<span class="lineno"></span><span class="op" id="3999545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3999548">func</span>&nbsp;<span class="ident" id="3999553">valueEncoder</span><span class="op" id="3999565">(</span><span class="ident" id="3999566">v</span>&nbsp;<span class="ident" id="3999568"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3999575">.</span><span class="ident" id="3999576"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="3999581">)</span>&nbsp;<span class="ident" id="3999583"><a href="/gostd/encoding/json/encode.go.html#3999409">encoderFunc</a></span>&nbsp;<span class="op" id="3999595">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3999598">if</span>&nbsp;<span class="op" id="3999601">!</span><span class="ident" id="3999602"><a href="/gostd/encoding/json/encode.go.html#3999566">v</a></span><span class="op" id="3999603">.</span><span class="ident" id="3999604"><a href="/gostd/reflect/value.go.html#2861333">IsValid</a></span><span class="op" id="3999611">(</span><span class="op" id="3999612">)</span>&nbsp;<span class="op" id="3999614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3999618">return</span>&nbsp;<span class="ident" id="3999625"><a href="/gostd/encoding/json/encode.go.html#4002135">invalidValueEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3999646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3999649">return</span>&nbsp;<span class="ident" id="3999656"><a href="/gostd/encoding/json/encode.go.html#3999686">typeEncoder</a></span><span class="op" id="3999667">(</span><span class="ident" id="3999668"><a href="/gostd/encoding/json/encode.go.html#3999566">v</a></span><span class="op" id="3999669">.</span><span class="ident" id="3999670"><a href="/gostd/reflect/value.go.html#2880910">Type</a></span><span class="op" id="3999674">(</span><span class="op" id="3999675">)</span><span class="op" id="3999676">)</span><br>
<span class="lineno"></span><span class="op" id="3999678">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="3999681">func</span>&nbsp;<span class="ident" id="3999686">typeEncoder</span><span class="op" id="3999697">(</span><span class="ident" id="3999698">t</span>&nbsp;<span class="ident" id="3999700"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="3999707">.</span><span class="ident" id="3999708"><a href="/gostd/reflect/type.go.html#2781467">Type</a></span><span class="op" id="3999712">)</span>&nbsp;<span class="ident" id="3999714"><a href="/gostd/encoding/json/encode.go.html#3999409">encoderFunc</a></span>&nbsp;<span class="op" id="3999726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3999729"><a href="/gostd/encoding/json/encode.go.html#3999477">encoderCache</a></span><span class="op" id="3999741">.</span><span class="ident" id="3999742"><a href="/gostd/sync/rwmutex.go.html#1456490">RLock</a></span><span class="op" id="3999747">(</span><span class="op" id="3999748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3999751">f</span>&nbsp;<span class="op" id="3999753">:=</span>&nbsp;<span class="ident" id="3999756"><a href="/gostd/encoding/json/encode.go.html#3999477">encoderCache</a></span><span class="op" id="3999768">.</span><span class="ident" id="3999769"><a href="/gostd/encoding/json/encode.go.html#3999514">m</a></span><span class="op" id="3999770">[</span><span class="ident" id="3999771"><a href="/gostd/encoding/json/encode.go.html#3999698">t</a></span><span class="op" id="3999772">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3999775"><a href="/gostd/encoding/json/encode.go.html#3999477">encoderCache</a></span><span class="op" id="3999787">.</span><span class="ident" id="3999788"><a href="/gostd/sync/rwmutex.go.html#1456952">RUnlock</a></span><span class="op" id="3999795">(</span><span class="op" id="3999796">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3999799">if</span>&nbsp;<span class="ident" id="3999802"><a href="/gostd/encoding/json/encode.go.html#3999751">f</a></span>&nbsp;<span class="op" id="3999804">!=</span>&nbsp;<span class="builtintype" id="3999807">nil</span>&nbsp;<span class="op" id="3999811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3999815">return</span>&nbsp;<span class="ident" id="3999822"><a href="/gostd/encoding/json/encode.go.html#3999751">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3999825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3999829">//&nbsp;To&nbsp;deal&nbsp;with&nbsp;recursive&nbsp;types,&nbsp;populate&nbsp;the&nbsp;map&nbsp;with&nbsp;an</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3999888">//&nbsp;indirect&nbsp;func&nbsp;before&nbsp;we&nbsp;build&nbsp;it.&nbsp;This&nbsp;type&nbsp;waits&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3999949">//&nbsp;real&nbsp;func&nbsp;(f)&nbsp;to&nbsp;be&nbsp;ready&nbsp;and&nbsp;then&nbsp;calls&nbsp;it.&nbsp;&nbsp;This&nbsp;indirect</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4000013">//&nbsp;func&nbsp;is&nbsp;only&nbsp;used&nbsp;for&nbsp;recursive&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4000056"><a href="/gostd/encoding/json/encode.go.html#3999477">encoderCache</a></span><span class="op" id="4000068">.</span><span class="ident" id="4000069"><a href="/gostd/sync/rwmutex.go.html#1457713">Lock</a></span><span class="op" id="4000073">(</span><span class="op" id="4000074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4000077">if</span>&nbsp;<span class="ident" id="4000080"><a href="/gostd/encoding/json/encode.go.html#3999477">encoderCache</a></span><span class="op" id="4000092">.</span><span class="ident" id="4000093"><a href="/gostd/encoding/json/encode.go.html#3999514">m</a></span>&nbsp;<span class="op" id="4000095">==</span>&nbsp;<span class="builtintype" id="4000098">nil</span>&nbsp;<span class="op" id="4000102">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4000106"><a href="/gostd/encoding/json/encode.go.html#3999477">encoderCache</a></span><span class="op" id="4000118">.</span><span class="ident" id="4000119"><a href="/gostd/encoding/json/encode.go.html#3999514">m</a></span>&nbsp;<span class="op" id="4000121">=</span>&nbsp;<span class="builtinfunc" id="4000123">make</span><span class="op" id="4000127">(</span><span class="keyword" id="4000128">map</span><span class="op" id="4000131">[</span><span class="ident" id="4000132"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4000139">.</span><span class="ident" id="4000140"><a href="/gostd/reflect/type.go.html#2781467">Type</a></span><span class="op" id="4000144">]</span><span class="ident" id="4000145"><a href="/gostd/encoding/json/encode.go.html#3999409">encoderFunc</a></span><span class="op" id="4000156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4000159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4000162">var</span>&nbsp;<span class="ident" id="4000166">wg</span>&nbsp;<span class="ident" id="4000169"><a href="/gostd/encoding/json/encode.go.html#3990275">sync</a></span><span class="op" id="4000173">.</span><span class="ident" id="4000174"><a href="/gostd/sync/waitgroup.go.html#1459933">WaitGroup</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4000185"><a href="/gostd/encoding/json/encode.go.html#4000166">wg</a></span><span class="op" id="4000187">.</span><span class="ident" id="4000188"><a href="/gostd/sync/waitgroup.go.html#1461154">Add</a></span><span class="op" id="4000191">(</span><span class="num" id="4000192">1</span><span class="op" id="4000193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4000196"><a href="/gostd/encoding/json/encode.go.html#3999477">encoderCache</a></span><span class="op" id="4000208">.</span><span class="ident" id="4000209"><a href="/gostd/encoding/json/encode.go.html#3999514">m</a></span><span class="op" id="4000210">[</span><span class="ident" id="4000211"><a href="/gostd/encoding/json/encode.go.html#3999698">t</a></span><span class="op" id="4000212">]</span>&nbsp;<span class="op" id="4000214">=</span>&nbsp;<span class="keyword" id="4000216">func</span><span class="op" id="4000220">(</span><span class="ident" id="4000221">e</span>&nbsp;<span class="op" id="4000223">*</span><span class="ident" id="4000224"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="4000235">,</span>&nbsp;<span class="ident" id="4000237">v</span>&nbsp;<span class="ident" id="4000239"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4000246">.</span><span class="ident" id="4000247"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="4000252">,</span>&nbsp;<span class="ident" id="4000254">quoted</span>&nbsp;<span class="builtintype" id="4000261">bool</span><span class="op" id="4000265">)</span>&nbsp;<span class="op" id="4000267">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4000271"><a href="/gostd/encoding/json/encode.go.html#4000166">wg</a></span><span class="op" id="4000273">.</span><span class="ident" id="4000274"><a href="/gostd/sync/waitgroup.go.html#1462162">Wait</a></span><span class="op" id="4000278">(</span><span class="op" id="4000279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4000283"><a href="/gostd/encoding/json/encode.go.html#3999751">f</a></span><span class="op" id="4000284">(</span><span class="ident" id="4000285"><a href="/gostd/encoding/json/encode.go.html#4000221">e</a></span><span class="op" id="4000286">,</span>&nbsp;<span class="ident" id="4000288"><a href="/gostd/encoding/json/encode.go.html#4000237">v</a></span><span class="op" id="4000289">,</span>&nbsp;<span class="ident" id="4000291"><a href="/gostd/encoding/json/encode.go.html#4000254">quoted</a></span><span class="op" id="4000297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4000300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4000303"><a href="/gostd/encoding/json/encode.go.html#3999477">encoderCache</a></span><span class="op" id="4000315">.</span><span class="ident" id="4000316"><a href="/gostd/sync/rwmutex.go.html#1458554">Unlock</a></span><span class="op" id="4000322">(</span><span class="op" id="4000323">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4000327">//&nbsp;Compute&nbsp;fields&nbsp;without&nbsp;lock.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4000360">//&nbsp;Might&nbsp;duplicate&nbsp;effort&nbsp;but&nbsp;won&#39;t&nbsp;hold&nbsp;other&nbsp;computations&nbsp;back.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4000427"><a href="/gostd/encoding/json/encode.go.html#3999751">f</a></span>&nbsp;<span class="op" id="4000429">=</span>&nbsp;<span class="ident" id="4000431"><a href="/gostd/encoding/json/encode.go.html#4000815">newTypeEncoder</a></span><span class="op" id="4000445">(</span><span class="ident" id="4000446"><a href="/gostd/encoding/json/encode.go.html#3999698">t</a></span><span class="op" id="4000447">,</span>&nbsp;<span class="builtintype" id="4000449">true</span><span class="op" id="4000453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4000456"><a href="/gostd/encoding/json/encode.go.html#4000166">wg</a></span><span class="op" id="4000458">.</span><span class="ident" id="4000459"><a href="/gostd/sync/waitgroup.go.html#1462065">Done</a></span><span class="op" id="4000463">(</span><span class="op" id="4000464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4000467"><a href="/gostd/encoding/json/encode.go.html#3999477">encoderCache</a></span><span class="op" id="4000479">.</span><span class="ident" id="4000480"><a href="/gostd/sync/rwmutex.go.html#1457713">Lock</a></span><span class="op" id="4000484">(</span><span class="op" id="4000485">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4000488"><a href="/gostd/encoding/json/encode.go.html#3999477">encoderCache</a></span><span class="op" id="4000500">.</span><span class="ident" id="4000501"><a href="/gostd/encoding/json/encode.go.html#3999514">m</a></span><span class="op" id="4000502">[</span><span class="ident" id="4000503"><a href="/gostd/encoding/json/encode.go.html#3999698">t</a></span><span class="op" id="4000504">]</span>&nbsp;<span class="op" id="4000506">=</span>&nbsp;<span class="ident" id="4000508"><a href="/gostd/encoding/json/encode.go.html#3999751">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4000511"><a href="/gostd/encoding/json/encode.go.html#3999477">encoderCache</a></span><span class="op" id="4000523">.</span><span class="ident" id="4000524"><a href="/gostd/sync/rwmutex.go.html#1458554">Unlock</a></span><span class="op" id="4000530">(</span><span class="op" id="4000531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4000534">return</span>&nbsp;<span class="ident" id="4000541"><a href="/gostd/encoding/json/encode.go.html#3999751">f</a></span><br>
<span class="lineno"></span><span class="op" id="4000543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="4000546">var</span>&nbsp;<span class="op" id="4000550">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4000553">marshalerType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4000571">=</span>&nbsp;<span class="ident" id="4000573"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4000580">.</span><span class="ident" id="4000581"><a href="/gostd/reflect/type.go.html#2808718">TypeOf</a></span><span class="op" id="4000587">(</span><span class="builtinfunc" id="4000588">new</span><span class="op" id="4000591">(</span><span class="ident" id="4000592"><a href="/gostd/encoding/json/encode.go.html#3996721">Marshaler</a></span><span class="op" id="4000601">)</span><span class="op" id="4000602">)</span><span class="op" id="4000603">.</span><span class="ident" id="4000604"><a href="/gostd/reflect/type.go.html#2785263">Elem</a></span><span class="op" id="4000608">(</span><span class="op" id="4000609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4000612">textMarshalerType</span>&nbsp;<span class="op" id="4000630">=</span>&nbsp;<span class="ident" id="4000632"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4000639">.</span><span class="ident" id="4000640"><a href="/gostd/reflect/type.go.html#2808718">TypeOf</a></span><span class="op" id="4000646">(</span><span class="builtinfunc" id="4000647">new</span><span class="op" id="4000650">(</span><span class="ident" id="4000651"><a href="/gostd/encoding/json/encode.go.html#3990184">encoding</a></span><span class="op" id="4000659">.</span><span class="ident" id="4000660"><a href="/gostd/encoding/encoding.go.html#4051330">TextMarshaler</a></span><span class="op" id="4000673">)</span><span class="op" id="4000674">)</span><span class="op" id="4000675">.</span><span class="ident" id="4000676"><a href="/gostd/reflect/type.go.html#2785263">Elem</a></span><span class="op" id="4000680">(</span><span class="op" id="4000681">)</span><br>
<span class="lineno"></span><span class="op" id="4000683">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="4000686">//&nbsp;newTypeEncoder&nbsp;constructs&nbsp;an&nbsp;encoderFunc&nbsp;for&nbsp;a&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4000742">//&nbsp;The&nbsp;returned&nbsp;encoder&nbsp;only&nbsp;checks&nbsp;CanAddr&nbsp;when&nbsp;allowAddr&nbsp;is&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="4000810">func</span>&nbsp;<span class="ident" id="4000815">newTypeEncoder</span><span class="op" id="4000829">(</span><span class="ident" id="4000830">t</span>&nbsp;<span class="ident" id="4000832"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4000839">.</span><span class="ident" id="4000840"><a href="/gostd/reflect/type.go.html#2781467">Type</a></span><span class="op" id="4000844">,</span>&nbsp;<span class="ident" id="4000846">allowAddr</span>&nbsp;<span class="builtintype" id="4000856">bool</span><span class="op" id="4000860">)</span>&nbsp;<span class="ident" id="4000862"><a href="/gostd/encoding/json/encode.go.html#3999409">encoderFunc</a></span>&nbsp;<span class="op" id="4000874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4000877">if</span>&nbsp;<span class="ident" id="4000880"><a href="/gostd/encoding/json/encode.go.html#4000830">t</a></span><span class="op" id="4000881">.</span><span class="ident" id="4000882"><a href="/gostd/reflect/type.go.html#2783706">Implements</a></span><span class="op" id="4000892">(</span><span class="ident" id="4000893"><a href="/gostd/encoding/json/encode.go.html#4000553">marshalerType</a></span><span class="op" id="4000906">)</span>&nbsp;<span class="op" id="4000908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4000912">return</span>&nbsp;<span class="ident" id="4000919"><a href="/gostd/encoding/json/encode.go.html#4002234">marshalerEncoder</a></span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4000937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4000940">if</span>&nbsp;<span class="ident" id="4000943"><a href="/gostd/encoding/json/encode.go.html#4000830">t</a></span><span class="op" id="4000944">.</span><span class="ident" id="4000945"><a href="/gostd/reflect/type.go.html#2783619">Kind</a></span><span class="op" id="4000949">(</span><span class="op" id="4000950">)</span>&nbsp;<span class="op" id="4000952">!=</span>&nbsp;<span class="ident" id="4000955"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4000962">.</span><span class="ident" id="4000963"><a href="/gostd/reflect/type.go.html#2788057">Ptr</a></span>&nbsp;<span class="op" id="4000967">&amp;&amp;</span>&nbsp;<span class="ident" id="4000970"><a href="/gostd/encoding/json/encode.go.html#4000846">allowAddr</a></span>&nbsp;<span class="op" id="4000980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4000984">if</span>&nbsp;<span class="ident" id="4000987"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4000994">.</span><span class="ident" id="4000995"><a href="/gostd/reflect/type.go.html#2809042">PtrTo</a></span><span class="op" id="4001000">(</span><span class="ident" id="4001001"><a href="/gostd/encoding/json/encode.go.html#4000830">t</a></span><span class="op" id="4001002">)</span><span class="op" id="4001003">.</span><span class="ident" id="4001004"><a href="/gostd/reflect/type.go.html#2783706">Implements</a></span><span class="op" id="4001014">(</span><span class="ident" id="4001015"><a href="/gostd/encoding/json/encode.go.html#4000553">marshalerType</a></span><span class="op" id="4001028">)</span>&nbsp;<span class="op" id="4001030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001035">return</span>&nbsp;<span class="ident" id="4001042"><a href="/gostd/encoding/json/encode.go.html#4008938">newCondAddrEncoder</a></span><span class="op" id="4001060">(</span><span class="ident" id="4001061"><a href="/gostd/encoding/json/encode.go.html#4002610">addrMarshalerEncoder</a></span><span class="op" id="4001081">,</span>&nbsp;<span class="ident" id="4001083"><a href="/gostd/encoding/json/encode.go.html#4000815">newTypeEncoder</a></span><span class="op" id="4001097">(</span><span class="ident" id="4001098"><a href="/gostd/encoding/json/encode.go.html#4000830">t</a></span><span class="op" id="4001099">,</span>&nbsp;<span class="builtintype" id="4001101">false</span><span class="op" id="4001106">)</span><span class="op" id="4001107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4001111">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4001114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001118">if</span>&nbsp;<span class="ident" id="4001121"><a href="/gostd/encoding/json/encode.go.html#4000830">t</a></span><span class="op" id="4001122">.</span><span class="ident" id="4001123"><a href="/gostd/reflect/type.go.html#2783706">Implements</a></span><span class="op" id="4001133">(</span><span class="ident" id="4001134"><a href="/gostd/encoding/json/encode.go.html#4000612">textMarshalerType</a></span><span class="op" id="4001151">)</span>&nbsp;<span class="op" id="4001153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001157">return</span>&nbsp;<span class="ident" id="4001164"><a href="/gostd/encoding/json/encode.go.html#4002981">textMarshalerEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4001186">}</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001189">if</span>&nbsp;<span class="ident" id="4001192"><a href="/gostd/encoding/json/encode.go.html#4000830">t</a></span><span class="op" id="4001193">.</span><span class="ident" id="4001194"><a href="/gostd/reflect/type.go.html#2783619">Kind</a></span><span class="op" id="4001198">(</span><span class="op" id="4001199">)</span>&nbsp;<span class="op" id="4001201">!=</span>&nbsp;<span class="ident" id="4001204"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4001211">.</span><span class="ident" id="4001212"><a href="/gostd/reflect/type.go.html#2788057">Ptr</a></span>&nbsp;<span class="op" id="4001216">&amp;&amp;</span>&nbsp;<span class="ident" id="4001219"><a href="/gostd/encoding/json/encode.go.html#4000846">allowAddr</a></span>&nbsp;<span class="op" id="4001229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001233">if</span>&nbsp;<span class="ident" id="4001236"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4001243">.</span><span class="ident" id="4001244"><a href="/gostd/reflect/type.go.html#2809042">PtrTo</a></span><span class="op" id="4001249">(</span><span class="ident" id="4001250"><a href="/gostd/encoding/json/encode.go.html#4000830">t</a></span><span class="op" id="4001251">)</span><span class="op" id="4001252">.</span><span class="ident" id="4001253"><a href="/gostd/reflect/type.go.html#2783706">Implements</a></span><span class="op" id="4001263">(</span><span class="ident" id="4001264"><a href="/gostd/encoding/json/encode.go.html#4000612">textMarshalerType</a></span><span class="op" id="4001281">)</span>&nbsp;<span class="op" id="4001283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001288">return</span>&nbsp;<span class="ident" id="4001295"><a href="/gostd/encoding/json/encode.go.html#4008938">newCondAddrEncoder</a></span><span class="op" id="4001313">(</span><span class="ident" id="4001314"><a href="/gostd/encoding/json/encode.go.html#4003319">addrTextMarshalerEncoder</a></span><span class="op" id="4001338">,</span>&nbsp;<span class="ident" id="4001340"><a href="/gostd/encoding/json/encode.go.html#4000815">newTypeEncoder</a></span><span class="op" id="4001354">(</span><span class="ident" id="4001355"><a href="/gostd/encoding/json/encode.go.html#4000830">t</a></span><span class="op" id="4001356">,</span>&nbsp;<span class="builtintype" id="4001358">false</span><span class="op" id="4001363">)</span><span class="op" id="4001364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4001368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4001371">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001375">switch</span>&nbsp;<span class="ident" id="4001382"><a href="/gostd/encoding/json/encode.go.html#4000830">t</a></span><span class="op" id="4001383">.</span><span class="ident" id="4001384"><a href="/gostd/reflect/type.go.html#2783619">Kind</a></span><span class="op" id="4001388">(</span><span class="op" id="4001389">)</span>&nbsp;<span class="op" id="4001391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001394">case</span>&nbsp;<span class="ident" id="4001399"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4001406">.</span><span class="ident" id="4001407"><a href="/gostd/reflect/type.go.html#2787897">Bool</a></span><span class="op" id="4001411">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001415">return</span>&nbsp;<span class="ident" id="4001422"><a href="/gostd/encoding/json/encode.go.html#4003652">boolEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001435">case</span>&nbsp;<span class="ident" id="4001440"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4001447">.</span><span class="ident" id="4001448"><a href="/gostd/reflect/type.go.html#2787903">Int</a></span><span class="op" id="4001451">,</span>&nbsp;<span class="ident" id="4001453"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4001460">.</span><span class="ident" id="4001461"><a href="/gostd/reflect/type.go.html#2787908">Int8</a></span><span class="op" id="4001465">,</span>&nbsp;<span class="ident" id="4001467"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4001474">.</span><span class="ident" id="4001475"><a href="/gostd/reflect/type.go.html#2787914">Int16</a></span><span class="op" id="4001480">,</span>&nbsp;<span class="ident" id="4001482"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4001489">.</span><span class="ident" id="4001490"><a href="/gostd/reflect/type.go.html#2787921">Int32</a></span><span class="op" id="4001495">,</span>&nbsp;<span class="ident" id="4001497"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4001504">.</span><span class="ident" id="4001505"><a href="/gostd/reflect/type.go.html#2787928">Int64</a></span><span class="op" id="4001510">:</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001514">return</span>&nbsp;<span class="ident" id="4001521"><a href="/gostd/encoding/json/encode.go.html#4003867">intEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001533">case</span>&nbsp;<span class="ident" id="4001538"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4001545">.</span><span class="ident" id="4001546"><a href="/gostd/reflect/type.go.html#2787935">Uint</a></span><span class="op" id="4001550">,</span>&nbsp;<span class="ident" id="4001552"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4001559">.</span><span class="ident" id="4001560"><a href="/gostd/reflect/type.go.html#2787941">Uint8</a></span><span class="op" id="4001565">,</span>&nbsp;<span class="ident" id="4001567"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4001574">.</span><span class="ident" id="4001575"><a href="/gostd/reflect/type.go.html#2787948">Uint16</a></span><span class="op" id="4001581">,</span>&nbsp;<span class="ident" id="4001583"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4001590">.</span><span class="ident" id="4001591"><a href="/gostd/reflect/type.go.html#2787956">Uint32</a></span><span class="op" id="4001597">,</span>&nbsp;<span class="ident" id="4001599"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4001606">.</span><span class="ident" id="4001607"><a href="/gostd/reflect/type.go.html#2787964">Uint64</a></span><span class="op" id="4001613">,</span>&nbsp;<span class="ident" id="4001615"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4001622">.</span><span class="ident" id="4001623"><a href="/gostd/reflect/type.go.html#2787972">Uintptr</a></span><span class="op" id="4001630">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001634">return</span>&nbsp;<span class="ident" id="4001641"><a href="/gostd/encoding/json/encode.go.html#4004068">uintEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001654">case</span>&nbsp;<span class="ident" id="4001659"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4001666">.</span><span class="ident" id="4001667"><a href="/gostd/reflect/type.go.html#2787981">Float32</a></span><span class="op" id="4001674">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001678">return</span>&nbsp;<span class="ident" id="4001685"><a href="/gostd/encoding/json/encode.go.html#4004684">float32Encoder</a></span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001701">case</span>&nbsp;<span class="ident" id="4001706"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4001713">.</span><span class="ident" id="4001714"><a href="/gostd/reflect/type.go.html#2787990">Float64</a></span><span class="op" id="4001721">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001725">return</span>&nbsp;<span class="ident" id="4001732"><a href="/gostd/encoding/json/encode.go.html#4004728">float64Encoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001748">case</span>&nbsp;<span class="ident" id="4001753"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4001760">.</span><span class="ident" id="4001761"><a href="/gostd/reflect/type.go.html#2788069">String</a></span><span class="op" id="4001767">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001771">return</span>&nbsp;<span class="ident" id="4001778"><a href="/gostd/encoding/json/encode.go.html#4004779">stringEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001793">case</span>&nbsp;<span class="ident" id="4001798"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4001805">.</span><span class="ident" id="4001806"><a href="/gostd/reflect/type.go.html#2788041">Interface</a></span><span class="op" id="4001815">:</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001819">return</span>&nbsp;<span class="ident" id="4001826"><a href="/gostd/encoding/json/encode.go.html#4005141">interfaceEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001844">case</span>&nbsp;<span class="ident" id="4001849"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4001856">.</span><span class="ident" id="4001857"><a href="/gostd/reflect/type.go.html#2788077">Struct</a></span><span class="op" id="4001863">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001867">return</span>&nbsp;<span class="ident" id="4001874"><a href="/gostd/encoding/json/encode.go.html#4005899">newStructEncoder</a></span><span class="op" id="4001890">(</span><span class="ident" id="4001891"><a href="/gostd/encoding/json/encode.go.html#4000830">t</a></span><span class="op" id="4001892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001895">case</span>&nbsp;<span class="ident" id="4001900"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4001907">.</span><span class="ident" id="4001908"><a href="/gostd/reflect/type.go.html#2788052">Map</a></span><span class="op" id="4001911">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001915">return</span>&nbsp;<span class="ident" id="4001922"><a href="/gostd/encoding/json/encode.go.html#4006591">newMapEncoder</a></span><span class="op" id="4001935">(</span><span class="ident" id="4001936"><a href="/gostd/encoding/json/encode.go.html#4000830">t</a></span><span class="op" id="4001937">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001940">case</span>&nbsp;<span class="ident" id="4001945"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4001952">.</span><span class="ident" id="4001953"><a href="/gostd/reflect/type.go.html#2788062">Slice</a></span><span class="op" id="4001958">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001962">return</span>&nbsp;<span class="ident" id="4001969"><a href="/gostd/encoding/json/encode.go.html#4007605">newSliceEncoder</a></span><span class="op" id="4001984">(</span><span class="ident" id="4001985"><a href="/gostd/encoding/json/encode.go.html#4000830">t</a></span><span class="op" id="4001986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4001989">case</span>&nbsp;<span class="ident" id="4001994"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4002001">.</span><span class="ident" id="4002002"><a href="/gostd/reflect/type.go.html#2788022">Array</a></span><span class="op" id="4002007">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4002011">return</span>&nbsp;<span class="ident" id="4002018"><a href="/gostd/encoding/json/encode.go.html#4008119">newArrayEncoder</a></span><span class="op" id="4002033">(</span><span class="ident" id="4002034"><a href="/gostd/encoding/json/encode.go.html#4000830">t</a></span><span class="op" id="4002035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4002038">case</span>&nbsp;<span class="ident" id="4002043"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4002050">.</span><span class="ident" id="4002051"><a href="/gostd/reflect/type.go.html#2788057">Ptr</a></span><span class="op" id="4002054">:</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4002058">return</span>&nbsp;<span class="ident" id="4002065"><a href="/gostd/encoding/json/encode.go.html#4008451">newPtrEncoder</a></span><span class="op" id="4002078">(</span><span class="ident" id="4002079"><a href="/gostd/encoding/json/encode.go.html#4000830">t</a></span><span class="op" id="4002080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4002083">default</span><span class="op" id="4002090">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4002094">return</span>&nbsp;<span class="ident" id="4002101"><a href="/gostd/encoding/json/encode.go.html#4005292">unsupportedTypeEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4002125">}</span><br>
<span class="lineno"></span><span class="op" id="4002127">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="keyword" id="4002130">func</span>&nbsp;<span class="ident" id="4002135">invalidValueEncoder</span><span class="op" id="4002154">(</span><span class="ident" id="4002155">e</span>&nbsp;<span class="op" id="4002157">*</span><span class="ident" id="4002158"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="4002169">,</span>&nbsp;<span class="ident" id="4002171">v</span>&nbsp;<span class="ident" id="4002173"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4002180">.</span><span class="ident" id="4002181"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="4002186">,</span>&nbsp;<span class="ident" id="4002188">quoted</span>&nbsp;<span class="builtintype" id="4002195">bool</span><span class="op" id="4002199">)</span>&nbsp;<span class="op" id="4002201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4002204"><a href="/gostd/encoding/json/encode.go.html#4002155">e</a></span><span class="op" id="4002205">.</span><span class="ident" id="4002206"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4002217">(</span><span class="string" id="4002218">&#34;null&#34;</span><span class="op" id="4002224">)</span><br>
<span class="lineno"></span><span class="op" id="4002226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="4002229">func</span>&nbsp;<span class="ident" id="4002234">marshalerEncoder</span><span class="op" id="4002250">(</span><span class="ident" id="4002251">e</span>&nbsp;<span class="op" id="4002253">*</span><span class="ident" id="4002254"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="4002265">,</span>&nbsp;<span class="ident" id="4002267">v</span>&nbsp;<span class="ident" id="4002269"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4002276">.</span><span class="ident" id="4002277"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="4002282">,</span>&nbsp;<span class="ident" id="4002284">quoted</span>&nbsp;<span class="builtintype" id="4002291">bool</span><span class="op" id="4002295">)</span>&nbsp;<span class="op" id="4002297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4002300">if</span>&nbsp;<span class="ident" id="4002303"><a href="/gostd/encoding/json/encode.go.html#4002267">v</a></span><span class="op" id="4002304">.</span><span class="ident" id="4002305"><a href="/gostd/reflect/value.go.html#2861487">Kind</a></span><span class="op" id="4002309">(</span><span class="op" id="4002310">)</span>&nbsp;<span class="op" id="4002312">==</span>&nbsp;<span class="ident" id="4002315"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4002322">.</span><span class="ident" id="4002323"><a href="/gostd/reflect/type.go.html#2788057">Ptr</a></span>&nbsp;<span class="op" id="4002327">&amp;&amp;</span>&nbsp;<span class="ident" id="4002330"><a href="/gostd/encoding/json/encode.go.html#4002267">v</a></span><span class="op" id="4002331">.</span><span class="ident" id="4002332"><a href="/gostd/reflect/value.go.html#2860565">IsNil</a></span><span class="op" id="4002337">(</span><span class="op" id="4002338">)</span>&nbsp;<span class="op" id="4002340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4002344"><a href="/gostd/encoding/json/encode.go.html#4002251">e</a></span><span class="op" id="4002345">.</span><span class="ident" id="4002346"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4002357">(</span><span class="string" id="4002358">&#34;null&#34;</span><span class="op" id="4002364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4002368">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4002376">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4002379">m</span>&nbsp;<span class="op" id="4002381">:=</span>&nbsp;<span class="ident" id="4002384"><a href="/gostd/encoding/json/encode.go.html#4002267">v</a></span><span class="op" id="4002385">.</span><span class="ident" id="4002386"><a href="/gostd/reflect/value.go.html#2858688">Interface</a></span><span class="op" id="4002395">(</span><span class="op" id="4002396">)</span><span class="op" id="4002397">.</span><span class="op" id="4002398">(</span><span class="ident" id="4002399"><a href="/gostd/encoding/json/encode.go.html#3996721">Marshaler</a></span><span class="op" id="4002408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4002411">b</span><span class="op" id="4002412">,</span>&nbsp;<span class="ident" id="4002414">err</span>&nbsp;<span class="op" id="4002418">:=</span>&nbsp;<span class="ident" id="4002421"><a href="/gostd/encoding/json/encode.go.html#4002379">m</a></span><span class="op" id="4002422">.</span><span class="ident" id="4002423"><a href="/gostd/encoding/json/encode.go.html#3996744">MarshalJSON</a></span><span class="op" id="4002434">(</span><span class="op" id="4002435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4002438">if</span>&nbsp;<span class="ident" id="4002441"><a href="/gostd/encoding/json/encode.go.html#4002414">err</a></span>&nbsp;<span class="op" id="4002445">==</span>&nbsp;<span class="builtintype" id="4002448">nil</span>&nbsp;<span class="op" id="4002452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4002456">//&nbsp;copy&nbsp;JSON&nbsp;into&nbsp;buffer,&nbsp;checking&nbsp;validity.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4002503"><a href="/gostd/encoding/json/encode.go.html#4002414">err</a></span>&nbsp;<span class="op" id="4002507">=</span>&nbsp;<span class="ident" id="4002509"><a href="/gostd/encoding/json/indent.go.html#4024418">compact</a></span><span class="op" id="4002516">(</span><span class="op" id="4002517">&amp;</span><span class="ident" id="4002518"><a href="/gostd/encoding/json/encode.go.html#4002251">e</a></span><span class="op" id="4002519">.</span><span class="ident" id="4002520"><a href="/gostd/encoding/json/encode.go.html#3998118">Buffer</a></span><span class="op" id="4002526">,</span>&nbsp;<span class="ident" id="4002528"><a href="/gostd/encoding/json/encode.go.html#4002411">b</a></span><span class="op" id="4002529">,</span>&nbsp;<span class="builtintype" id="4002531">true</span><span class="op" id="4002535">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4002538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4002541">if</span>&nbsp;<span class="ident" id="4002544"><a href="/gostd/encoding/json/encode.go.html#4002414">err</a></span>&nbsp;<span class="op" id="4002548">!=</span>&nbsp;<span class="builtintype" id="4002551">nil</span>&nbsp;<span class="op" id="4002555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4002559"><a href="/gostd/encoding/json/encode.go.html#4002251">e</a></span><span class="op" id="4002560">.</span><span class="builtintype" id="4002561"><a href="/gostd/encoding/json/encode.go.html#3998683">error</a></span><span class="op" id="4002566">(</span><span class="op" id="4002567">&amp;</span><span class="ident" id="4002568"><a href="/gostd/encoding/json/encode.go.html#3997813">MarshalerError</a></span><span class="op" id="4002582">{</span><span class="ident" id="4002583"><a href="/gostd/encoding/json/encode.go.html#4002267">v</a></span><span class="op" id="4002584">.</span><span class="ident" id="4002585"><a href="/gostd/reflect/value.go.html#2880910">Type</a></span><span class="op" id="4002589">(</span><span class="op" id="4002590">)</span><span class="op" id="4002591">,</span>&nbsp;<span class="ident" id="4002593"><a href="/gostd/encoding/json/encode.go.html#4002414">err</a></span><span class="op" id="4002596">}</span><span class="op" id="4002597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4002600">}</span><br>
<span class="lineno"></span><span class="op" id="4002602">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span><span class="keyword" id="4002605">func</span>&nbsp;<span class="ident" id="4002610">addrMarshalerEncoder</span><span class="op" id="4002630">(</span><span class="ident" id="4002631">e</span>&nbsp;<span class="op" id="4002633">*</span><span class="ident" id="4002634"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="4002645">,</span>&nbsp;<span class="ident" id="4002647">v</span>&nbsp;<span class="ident" id="4002649"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4002656">.</span><span class="ident" id="4002657"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="4002662">,</span>&nbsp;<span class="ident" id="4002664">quoted</span>&nbsp;<span class="builtintype" id="4002671">bool</span><span class="op" id="4002675">)</span>&nbsp;<span class="op" id="4002677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4002680">va</span>&nbsp;<span class="op" id="4002683">:=</span>&nbsp;<span class="ident" id="4002686"><a href="/gostd/encoding/json/encode.go.html#4002647">v</a></span><span class="op" id="4002687">.</span><span class="ident" id="4002688"><a href="/gostd/reflect/value.go.html#2839495">Addr</a></span><span class="op" id="4002692">(</span><span class="op" id="4002693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4002696">if</span>&nbsp;<span class="ident" id="4002699"><a href="/gostd/encoding/json/encode.go.html#4002680">va</a></span><span class="op" id="4002701">.</span><span class="ident" id="4002702"><a href="/gostd/reflect/value.go.html#2860565">IsNil</a></span><span class="op" id="4002707">(</span><span class="op" id="4002708">)</span>&nbsp;<span class="op" id="4002710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4002714"><a href="/gostd/encoding/json/encode.go.html#4002631">e</a></span><span class="op" id="4002715">.</span><span class="ident" id="4002716"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4002727">(</span><span class="string" id="4002728">&#34;null&#34;</span><span class="op" id="4002734">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4002738">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4002746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4002749">m</span>&nbsp;<span class="op" id="4002751">:=</span>&nbsp;<span class="ident" id="4002754"><a href="/gostd/encoding/json/encode.go.html#4002680">va</a></span><span class="op" id="4002756">.</span><span class="ident" id="4002757"><a href="/gostd/reflect/value.go.html#2858688">Interface</a></span><span class="op" id="4002766">(</span><span class="op" id="4002767">)</span><span class="op" id="4002768">.</span><span class="op" id="4002769">(</span><span class="ident" id="4002770"><a href="/gostd/encoding/json/encode.go.html#3996721">Marshaler</a></span><span class="op" id="4002779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4002782">b</span><span class="op" id="4002783">,</span>&nbsp;<span class="ident" id="4002785">err</span>&nbsp;<span class="op" id="4002789">:=</span>&nbsp;<span class="ident" id="4002792"><a href="/gostd/encoding/json/encode.go.html#4002749">m</a></span><span class="op" id="4002793">.</span><span class="ident" id="4002794"><a href="/gostd/encoding/json/encode.go.html#3996744">MarshalJSON</a></span><span class="op" id="4002805">(</span><span class="op" id="4002806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4002809">if</span>&nbsp;<span class="ident" id="4002812"><a href="/gostd/encoding/json/encode.go.html#4002785">err</a></span>&nbsp;<span class="op" id="4002816">==</span>&nbsp;<span class="builtintype" id="4002819">nil</span>&nbsp;<span class="op" id="4002823">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4002827">//&nbsp;copy&nbsp;JSON&nbsp;into&nbsp;buffer,&nbsp;checking&nbsp;validity.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4002874"><a href="/gostd/encoding/json/encode.go.html#4002785">err</a></span>&nbsp;<span class="op" id="4002878">=</span>&nbsp;<span class="ident" id="4002880"><a href="/gostd/encoding/json/indent.go.html#4024418">compact</a></span><span class="op" id="4002887">(</span><span class="op" id="4002888">&amp;</span><span class="ident" id="4002889"><a href="/gostd/encoding/json/encode.go.html#4002631">e</a></span><span class="op" id="4002890">.</span><span class="ident" id="4002891"><a href="/gostd/encoding/json/encode.go.html#3998118">Buffer</a></span><span class="op" id="4002897">,</span>&nbsp;<span class="ident" id="4002899"><a href="/gostd/encoding/json/encode.go.html#4002782">b</a></span><span class="op" id="4002900">,</span>&nbsp;<span class="builtintype" id="4002902">true</span><span class="op" id="4002906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4002909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4002912">if</span>&nbsp;<span class="ident" id="4002915"><a href="/gostd/encoding/json/encode.go.html#4002785">err</a></span>&nbsp;<span class="op" id="4002919">!=</span>&nbsp;<span class="builtintype" id="4002922">nil</span>&nbsp;<span class="op" id="4002926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4002930"><a href="/gostd/encoding/json/encode.go.html#4002631">e</a></span><span class="op" id="4002931">.</span><span class="builtintype" id="4002932"><a href="/gostd/encoding/json/encode.go.html#3998683">error</a></span><span class="op" id="4002937">(</span><span class="op" id="4002938">&amp;</span><span class="ident" id="4002939"><a href="/gostd/encoding/json/encode.go.html#3997813">MarshalerError</a></span><span class="op" id="4002953">{</span><span class="ident" id="4002954"><a href="/gostd/encoding/json/encode.go.html#4002647">v</a></span><span class="op" id="4002955">.</span><span class="ident" id="4002956"><a href="/gostd/reflect/value.go.html#2880910">Type</a></span><span class="op" id="4002960">(</span><span class="op" id="4002961">)</span><span class="op" id="4002962">,</span>&nbsp;<span class="ident" id="4002964"><a href="/gostd/encoding/json/encode.go.html#4002785">err</a></span><span class="op" id="4002967">}</span><span class="op" id="4002968">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4002971">}</span><br>
<span class="lineno"></span><span class="op" id="4002973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4002976">func</span>&nbsp;<span class="ident" id="4002981">textMarshalerEncoder</span><span class="op" id="4003001">(</span><span class="ident" id="4003002">e</span>&nbsp;<span class="op" id="4003004">*</span><span class="ident" id="4003005"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="4003016">,</span>&nbsp;<span class="ident" id="4003018">v</span>&nbsp;<span class="ident" id="4003020"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4003027">.</span><span class="ident" id="4003028"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="4003033">,</span>&nbsp;<span class="ident" id="4003035">quoted</span>&nbsp;<span class="builtintype" id="4003042">bool</span><span class="op" id="4003046">)</span>&nbsp;<span class="op" id="4003048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003051">if</span>&nbsp;<span class="ident" id="4003054"><a href="/gostd/encoding/json/encode.go.html#4003018">v</a></span><span class="op" id="4003055">.</span><span class="ident" id="4003056"><a href="/gostd/reflect/value.go.html#2861487">Kind</a></span><span class="op" id="4003060">(</span><span class="op" id="4003061">)</span>&nbsp;<span class="op" id="4003063">==</span>&nbsp;<span class="ident" id="4003066"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4003073">.</span><span class="ident" id="4003074"><a href="/gostd/reflect/type.go.html#2788057">Ptr</a></span>&nbsp;<span class="op" id="4003078">&amp;&amp;</span>&nbsp;<span class="ident" id="4003081"><a href="/gostd/encoding/json/encode.go.html#4003018">v</a></span><span class="op" id="4003082">.</span><span class="ident" id="4003083"><a href="/gostd/reflect/value.go.html#2860565">IsNil</a></span><span class="op" id="4003088">(</span><span class="op" id="4003089">)</span>&nbsp;<span class="op" id="4003091">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4003095"><a href="/gostd/encoding/json/encode.go.html#4003002">e</a></span><span class="op" id="4003096">.</span><span class="ident" id="4003097"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4003108">(</span><span class="string" id="4003109">&#34;null&#34;</span><span class="op" id="4003115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003119">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4003127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4003130">m</span>&nbsp;<span class="op" id="4003132">:=</span>&nbsp;<span class="ident" id="4003135"><a href="/gostd/encoding/json/encode.go.html#4003018">v</a></span><span class="op" id="4003136">.</span><span class="ident" id="4003137"><a href="/gostd/reflect/value.go.html#2858688">Interface</a></span><span class="op" id="4003146">(</span><span class="op" id="4003147">)</span><span class="op" id="4003148">.</span><span class="op" id="4003149">(</span><span class="ident" id="4003150"><a href="/gostd/encoding/json/encode.go.html#3990184">encoding</a></span><span class="op" id="4003158">.</span><span class="ident" id="4003159"><a href="/gostd/encoding/encoding.go.html#4051330">TextMarshaler</a></span><span class="op" id="4003172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4003175">b</span><span class="op" id="4003176">,</span>&nbsp;<span class="ident" id="4003178">err</span>&nbsp;<span class="op" id="4003182">:=</span>&nbsp;<span class="ident" id="4003185"><a href="/gostd/encoding/json/encode.go.html#4003130">m</a></span><span class="op" id="4003186">.</span><span class="ident" id="4003187"><a href="/gostd/encoding/encoding.go.html#4051357">MarshalText</a></span><span class="op" id="4003198">(</span><span class="op" id="4003199">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003202">if</span>&nbsp;<span class="ident" id="4003205"><a href="/gostd/encoding/json/encode.go.html#4003178">err</a></span>&nbsp;<span class="op" id="4003209">==</span>&nbsp;<span class="builtintype" id="4003212">nil</span>&nbsp;<span class="op" id="4003216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4003220">_</span><span class="op" id="4003221">,</span>&nbsp;<span class="ident" id="4003223"><a href="/gostd/encoding/json/encode.go.html#4003178">err</a></span>&nbsp;<span class="op" id="4003227">=</span>&nbsp;<span class="ident" id="4003229"><a href="/gostd/encoding/json/encode.go.html#4003002">e</a></span><span class="op" id="4003230">.</span><span class="ident" id="4003231"><a href="/gostd/encoding/json/encode.go.html#4012278">stringBytes</a></span><span class="op" id="4003242">(</span><span class="ident" id="4003243"><a href="/gostd/encoding/json/encode.go.html#4003175">b</a></span><span class="op" id="4003244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4003247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003250">if</span>&nbsp;<span class="ident" id="4003253"><a href="/gostd/encoding/json/encode.go.html#4003178">err</a></span>&nbsp;<span class="op" id="4003257">!=</span>&nbsp;<span class="builtintype" id="4003260">nil</span>&nbsp;<span class="op" id="4003264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4003268"><a href="/gostd/encoding/json/encode.go.html#4003002">e</a></span><span class="op" id="4003269">.</span><span class="builtintype" id="4003270"><a href="/gostd/encoding/json/encode.go.html#3998683">error</a></span><span class="op" id="4003275">(</span><span class="op" id="4003276">&amp;</span><span class="ident" id="4003277"><a href="/gostd/encoding/json/encode.go.html#3997813">MarshalerError</a></span><span class="op" id="4003291">{</span><span class="ident" id="4003292"><a href="/gostd/encoding/json/encode.go.html#4003018">v</a></span><span class="op" id="4003293">.</span><span class="ident" id="4003294"><a href="/gostd/reflect/value.go.html#2880910">Type</a></span><span class="op" id="4003298">(</span><span class="op" id="4003299">)</span><span class="op" id="4003300">,</span>&nbsp;<span class="ident" id="4003302"><a href="/gostd/encoding/json/encode.go.html#4003178">err</a></span><span class="op" id="4003305">}</span><span class="op" id="4003306">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4003309">}</span><br>
<span class="lineno"></span><span class="op" id="4003311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4003314">func</span>&nbsp;<span class="ident" id="4003319">addrTextMarshalerEncoder</span><span class="op" id="4003343">(</span><span class="ident" id="4003344">e</span>&nbsp;<span class="op" id="4003346">*</span><span class="ident" id="4003347"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="4003358">,</span>&nbsp;<span class="ident" id="4003360">v</span>&nbsp;<span class="ident" id="4003362"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4003369">.</span><span class="ident" id="4003370"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="4003375">,</span>&nbsp;<span class="ident" id="4003377">quoted</span>&nbsp;<span class="builtintype" id="4003384">bool</span><span class="op" id="4003388">)</span>&nbsp;<span class="op" id="4003390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4003393">va</span>&nbsp;<span class="op" id="4003396">:=</span>&nbsp;<span class="ident" id="4003399"><a href="/gostd/encoding/json/encode.go.html#4003360">v</a></span><span class="op" id="4003400">.</span><span class="ident" id="4003401"><a href="/gostd/reflect/value.go.html#2839495">Addr</a></span><span class="op" id="4003405">(</span><span class="op" id="4003406">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003409">if</span>&nbsp;<span class="ident" id="4003412"><a href="/gostd/encoding/json/encode.go.html#4003393">va</a></span><span class="op" id="4003414">.</span><span class="ident" id="4003415"><a href="/gostd/reflect/value.go.html#2860565">IsNil</a></span><span class="op" id="4003420">(</span><span class="op" id="4003421">)</span>&nbsp;<span class="op" id="4003423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4003427"><a href="/gostd/encoding/json/encode.go.html#4003344">e</a></span><span class="op" id="4003428">.</span><span class="ident" id="4003429"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4003440">(</span><span class="string" id="4003441">&#34;null&#34;</span><span class="op" id="4003447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003451">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4003459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4003462">m</span>&nbsp;<span class="op" id="4003464">:=</span>&nbsp;<span class="ident" id="4003467"><a href="/gostd/encoding/json/encode.go.html#4003393">va</a></span><span class="op" id="4003469">.</span><span class="ident" id="4003470"><a href="/gostd/reflect/value.go.html#2858688">Interface</a></span><span class="op" id="4003479">(</span><span class="op" id="4003480">)</span><span class="op" id="4003481">.</span><span class="op" id="4003482">(</span><span class="ident" id="4003483"><a href="/gostd/encoding/json/encode.go.html#3990184">encoding</a></span><span class="op" id="4003491">.</span><span class="ident" id="4003492"><a href="/gostd/encoding/encoding.go.html#4051330">TextMarshaler</a></span><span class="op" id="4003505">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4003508">b</span><span class="op" id="4003509">,</span>&nbsp;<span class="ident" id="4003511">err</span>&nbsp;<span class="op" id="4003515">:=</span>&nbsp;<span class="ident" id="4003518"><a href="/gostd/encoding/json/encode.go.html#4003462">m</a></span><span class="op" id="4003519">.</span><span class="ident" id="4003520"><a href="/gostd/encoding/encoding.go.html#4051357">MarshalText</a></span><span class="op" id="4003531">(</span><span class="op" id="4003532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003535">if</span>&nbsp;<span class="ident" id="4003538"><a href="/gostd/encoding/json/encode.go.html#4003511">err</a></span>&nbsp;<span class="op" id="4003542">==</span>&nbsp;<span class="builtintype" id="4003545">nil</span>&nbsp;<span class="op" id="4003549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4003553">_</span><span class="op" id="4003554">,</span>&nbsp;<span class="ident" id="4003556"><a href="/gostd/encoding/json/encode.go.html#4003511">err</a></span>&nbsp;<span class="op" id="4003560">=</span>&nbsp;<span class="ident" id="4003562"><a href="/gostd/encoding/json/encode.go.html#4003344">e</a></span><span class="op" id="4003563">.</span><span class="ident" id="4003564"><a href="/gostd/encoding/json/encode.go.html#4012278">stringBytes</a></span><span class="op" id="4003575">(</span><span class="ident" id="4003576"><a href="/gostd/encoding/json/encode.go.html#4003508">b</a></span><span class="op" id="4003577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4003580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003583">if</span>&nbsp;<span class="ident" id="4003586"><a href="/gostd/encoding/json/encode.go.html#4003511">err</a></span>&nbsp;<span class="op" id="4003590">!=</span>&nbsp;<span class="builtintype" id="4003593">nil</span>&nbsp;<span class="op" id="4003597">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4003601"><a href="/gostd/encoding/json/encode.go.html#4003344">e</a></span><span class="op" id="4003602">.</span><span class="builtintype" id="4003603"><a href="/gostd/encoding/json/encode.go.html#3998683">error</a></span><span class="op" id="4003608">(</span><span class="op" id="4003609">&amp;</span><span class="ident" id="4003610"><a href="/gostd/encoding/json/encode.go.html#3997813">MarshalerError</a></span><span class="op" id="4003624">{</span><span class="ident" id="4003625"><a href="/gostd/encoding/json/encode.go.html#4003360">v</a></span><span class="op" id="4003626">.</span><span class="ident" id="4003627"><a href="/gostd/reflect/value.go.html#2880910">Type</a></span><span class="op" id="4003631">(</span><span class="op" id="4003632">)</span><span class="op" id="4003633">,</span>&nbsp;<span class="ident" id="4003635"><a href="/gostd/encoding/json/encode.go.html#4003511">err</a></span><span class="op" id="4003638">}</span><span class="op" id="4003639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4003642">}</span><br>
<span class="lineno"></span><span class="op" id="4003644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4003647">func</span>&nbsp;<span class="ident" id="4003652">boolEncoder</span><span class="op" id="4003663">(</span><span class="ident" id="4003664">e</span>&nbsp;<span class="op" id="4003666">*</span><span class="ident" id="4003667"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="4003678">,</span>&nbsp;<span class="ident" id="4003680">v</span>&nbsp;<span class="ident" id="4003682"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4003689">.</span><span class="ident" id="4003690"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="4003695">,</span>&nbsp;<span class="ident" id="4003697">quoted</span>&nbsp;<span class="builtintype" id="4003704">bool</span><span class="op" id="4003708">)</span>&nbsp;<span class="op" id="4003710">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003713">if</span>&nbsp;<span class="ident" id="4003716"><a href="/gostd/encoding/json/encode.go.html#4003697">quoted</a></span>&nbsp;<span class="op" id="4003723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4003727"><a href="/gostd/encoding/json/encode.go.html#4003664">e</a></span><span class="op" id="4003728">.</span><span class="ident" id="4003729"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4003738">(</span><span class="string" id="4003739">&#39;&#34;&#39;</span><span class="op" id="4003742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4003745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003748">if</span>&nbsp;<span class="ident" id="4003751"><a href="/gostd/encoding/json/encode.go.html#4003680">v</a></span><span class="op" id="4003752">.</span><span class="ident" id="4003753"><a href="/gostd/reflect/value.go.html#2839754">Bool</a></span><span class="op" id="4003757">(</span><span class="op" id="4003758">)</span>&nbsp;<span class="op" id="4003760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4003764"><a href="/gostd/encoding/json/encode.go.html#4003664">e</a></span><span class="op" id="4003765">.</span><span class="ident" id="4003766"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4003777">(</span><span class="string" id="4003778">&#34;true&#34;</span><span class="op" id="4003784">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4003787">}</span>&nbsp;<span class="keyword" id="4003789">else</span>&nbsp;<span class="op" id="4003794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4003798"><a href="/gostd/encoding/json/encode.go.html#4003664">e</a></span><span class="op" id="4003799">.</span><span class="ident" id="4003800"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4003811">(</span><span class="string" id="4003812">&#34;false&#34;</span><span class="op" id="4003819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4003822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003825">if</span>&nbsp;<span class="ident" id="4003828"><a href="/gostd/encoding/json/encode.go.html#4003697">quoted</a></span>&nbsp;<span class="op" id="4003835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4003839"><a href="/gostd/encoding/json/encode.go.html#4003664">e</a></span><span class="op" id="4003840">.</span><span class="ident" id="4003841"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4003850">(</span><span class="string" id="4003851">&#39;&#34;&#39;</span><span class="op" id="4003854">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4003857">}</span><br>
<span class="lineno"></span><span class="op" id="4003859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4003862">func</span>&nbsp;<span class="ident" id="4003867">intEncoder</span><span class="op" id="4003877">(</span><span class="ident" id="4003878">e</span>&nbsp;<span class="op" id="4003880">*</span><span class="ident" id="4003881"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="4003892">,</span>&nbsp;<span class="ident" id="4003894">v</span>&nbsp;<span class="ident" id="4003896"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4003903">.</span><span class="ident" id="4003904"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="4003909">,</span>&nbsp;<span class="ident" id="4003911">quoted</span>&nbsp;<span class="builtintype" id="4003918">bool</span><span class="op" id="4003922">)</span>&nbsp;<span class="op" id="4003924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4003927">b</span>&nbsp;<span class="op" id="4003929">:=</span>&nbsp;<span class="ident" id="4003932"><a href="/gostd/encoding/json/encode.go.html#3990253">strconv</a></span><span class="op" id="4003939">.</span><span class="ident" id="4003940"><a href="/gostd/strconv/itoa.go.html#2407474">AppendInt</a></span><span class="op" id="4003949">(</span><span class="ident" id="4003950"><a href="/gostd/encoding/json/encode.go.html#4003878">e</a></span><span class="op" id="4003951">.</span><span class="ident" id="4003952"><a href="/gostd/encoding/json/encode.go.html#3998154">scratch</a></span><span class="op" id="4003959">[</span><span class="op" id="4003960">:</span><span class="num" id="4003961">0</span><span class="op" id="4003962">]</span><span class="op" id="4003963">,</span>&nbsp;<span class="ident" id="4003965"><a href="/gostd/encoding/json/encode.go.html#4003894">v</a></span><span class="op" id="4003966">.</span><span class="ident" id="4003967"><a href="/gostd/reflect/value.go.html#2857929">Int</a></span><span class="op" id="4003970">(</span><span class="op" id="4003971">)</span><span class="op" id="4003972">,</span>&nbsp;<span class="num" id="4003974">10</span><span class="op" id="4003976">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4003979">if</span>&nbsp;<span class="ident" id="4003982"><a href="/gostd/encoding/json/encode.go.html#4003911">quoted</a></span>&nbsp;<span class="op" id="4003989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4003993"><a href="/gostd/encoding/json/encode.go.html#4003878">e</a></span><span class="op" id="4003994">.</span><span class="ident" id="4003995"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4004004">(</span><span class="string" id="4004005">&#39;&#34;&#39;</span><span class="op" id="4004008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4004011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4004014"><a href="/gostd/encoding/json/encode.go.html#4003878">e</a></span><span class="op" id="4004015">.</span><span class="ident" id="4004016"><a href="/gostd/bytes/buffer.go.html#1387016">Write</a></span><span class="op" id="4004021">(</span><span class="ident" id="4004022"><a href="/gostd/encoding/json/encode.go.html#4003927">b</a></span><span class="op" id="4004023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004026">if</span>&nbsp;<span class="ident" id="4004029"><a href="/gostd/encoding/json/encode.go.html#4003911">quoted</a></span>&nbsp;<span class="op" id="4004036">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4004040"><a href="/gostd/encoding/json/encode.go.html#4003878">e</a></span><span class="op" id="4004041">.</span><span class="ident" id="4004042"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4004051">(</span><span class="string" id="4004052">&#39;&#34;&#39;</span><span class="op" id="4004055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4004058">}</span><br>
<span class="lineno"></span><span class="op" id="4004060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4004063">func</span>&nbsp;<span class="ident" id="4004068">uintEncoder</span><span class="op" id="4004079">(</span><span class="ident" id="4004080">e</span>&nbsp;<span class="op" id="4004082">*</span><span class="ident" id="4004083"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="4004094">,</span>&nbsp;<span class="ident" id="4004096">v</span>&nbsp;<span class="ident" id="4004098"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4004105">.</span><span class="ident" id="4004106"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="4004111">,</span>&nbsp;<span class="ident" id="4004113">quoted</span>&nbsp;<span class="builtintype" id="4004120">bool</span><span class="op" id="4004124">)</span>&nbsp;<span class="op" id="4004126">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4004129">b</span>&nbsp;<span class="op" id="4004131">:=</span>&nbsp;<span class="ident" id="4004134"><a href="/gostd/encoding/json/encode.go.html#3990253">strconv</a></span><span class="op" id="4004141">.</span><span class="ident" id="4004142"><a href="/gostd/strconv/itoa.go.html#2407736">AppendUint</a></span><span class="op" id="4004152">(</span><span class="ident" id="4004153"><a href="/gostd/encoding/json/encode.go.html#4004080">e</a></span><span class="op" id="4004154">.</span><span class="ident" id="4004155"><a href="/gostd/encoding/json/encode.go.html#3998154">scratch</a></span><span class="op" id="4004162">[</span><span class="op" id="4004163">:</span><span class="num" id="4004164">0</span><span class="op" id="4004165">]</span><span class="op" id="4004166">,</span>&nbsp;<span class="ident" id="4004168"><a href="/gostd/encoding/json/encode.go.html#4004096">v</a></span><span class="op" id="4004169">.</span><span class="ident" id="4004170"><a href="/gostd/reflect/value.go.html#2881772">Uint</a></span><span class="op" id="4004174">(</span><span class="op" id="4004175">)</span><span class="op" id="4004176">,</span>&nbsp;<span class="num" id="4004178">10</span><span class="op" id="4004180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004183">if</span>&nbsp;<span class="ident" id="4004186"><a href="/gostd/encoding/json/encode.go.html#4004113">quoted</a></span>&nbsp;<span class="op" id="4004193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4004197"><a href="/gostd/encoding/json/encode.go.html#4004080">e</a></span><span class="op" id="4004198">.</span><span class="ident" id="4004199"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4004208">(</span><span class="string" id="4004209">&#39;&#34;&#39;</span><span class="op" id="4004212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4004215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4004218"><a href="/gostd/encoding/json/encode.go.html#4004080">e</a></span><span class="op" id="4004219">.</span><span class="ident" id="4004220"><a href="/gostd/bytes/buffer.go.html#1387016">Write</a></span><span class="op" id="4004225">(</span><span class="ident" id="4004226"><a href="/gostd/encoding/json/encode.go.html#4004129">b</a></span><span class="op" id="4004227">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004230">if</span>&nbsp;<span class="ident" id="4004233"><a href="/gostd/encoding/json/encode.go.html#4004113">quoted</a></span>&nbsp;<span class="op" id="4004240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4004244"><a href="/gostd/encoding/json/encode.go.html#4004080">e</a></span><span class="op" id="4004245">.</span><span class="ident" id="4004246"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4004255">(</span><span class="string" id="4004256">&#39;&#34;&#39;</span><span class="op" id="4004259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4004262">}</span><br>
<span class="lineno"></span><span class="op" id="4004264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span><span class="keyword" id="4004267">type</span>&nbsp;<span class="ident" id="4004272">floatEncoder</span>&nbsp;<span class="builtintype" id="4004285">int</span>&nbsp;<span class="comment" id="4004289">//&nbsp;number&nbsp;of&nbsp;bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4004308">func</span>&nbsp;<span class="op" id="4004313">(</span><span class="ident" id="4004314">bits</span>&nbsp;<span class="ident" id="4004319"><a href="/gostd/encoding/json/encode.go.html#4004272">floatEncoder</a></span><span class="op" id="4004331">)</span>&nbsp;<span class="ident" id="4004333">encode</span><span class="op" id="4004339">(</span><span class="ident" id="4004340">e</span>&nbsp;<span class="op" id="4004342">*</span><span class="ident" id="4004343"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="4004354">,</span>&nbsp;<span class="ident" id="4004356">v</span>&nbsp;<span class="ident" id="4004358"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4004365">.</span><span class="ident" id="4004366"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="4004371">,</span>&nbsp;<span class="ident" id="4004373">quoted</span>&nbsp;<span class="builtintype" id="4004380">bool</span><span class="op" id="4004384">)</span>&nbsp;<span class="op" id="4004386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4004389">f</span>&nbsp;<span class="op" id="4004391">:=</span>&nbsp;<span class="ident" id="4004394"><a href="/gostd/encoding/json/encode.go.html#4004356">v</a></span><span class="op" id="4004395">.</span><span class="ident" id="4004396"><a href="/gostd/reflect/value.go.html#2856007">Float</a></span><span class="op" id="4004401">(</span><span class="op" id="4004402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004405">if</span>&nbsp;<span class="ident" id="4004408"><a href="/gostd/encoding/json/encode.go.html#3990215">math</a></span><span class="op" id="4004412">.</span><span class="ident" id="4004413"><a href="/gostd/math/bits.go.html#2211921">IsInf</a></span><span class="op" id="4004418">(</span><span class="ident" id="4004419"><a href="/gostd/encoding/json/encode.go.html#4004389">f</a></span><span class="op" id="4004420">,</span>&nbsp;<span class="num" id="4004422">0</span><span class="op" id="4004423">)</span>&nbsp;<span class="op" id="4004425">||</span>&nbsp;<span class="ident" id="4004428"><a href="/gostd/encoding/json/encode.go.html#3990215">math</a></span><span class="op" id="4004432">.</span><span class="ident" id="4004433"><a href="/gostd/math/bits.go.html#2211423">IsNaN</a></span><span class="op" id="4004438">(</span><span class="ident" id="4004439"><a href="/gostd/encoding/json/encode.go.html#4004389">f</a></span><span class="op" id="4004440">)</span>&nbsp;<span class="op" id="4004442">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4004446"><a href="/gostd/encoding/json/encode.go.html#4004340">e</a></span><span class="op" id="4004447">.</span><span class="builtintype" id="4004448"><a href="/gostd/encoding/json/encode.go.html#3998683">error</a></span><span class="op" id="4004453">(</span><span class="op" id="4004454">&amp;</span><span class="ident" id="4004455"><a href="/gostd/encoding/json/encode.go.html#3997049">UnsupportedValueError</a></span><span class="op" id="4004476">{</span><span class="ident" id="4004477"><a href="/gostd/encoding/json/encode.go.html#4004356">v</a></span><span class="op" id="4004478">,</span>&nbsp;<span class="ident" id="4004480"><a href="/gostd/encoding/json/encode.go.html#3990253">strconv</a></span><span class="op" id="4004487">.</span><span class="ident" id="4004488"><a href="/gostd/strconv/ftoa.go.html#2386940">FormatFloat</a></span><span class="op" id="4004499">(</span><span class="ident" id="4004500"><a href="/gostd/encoding/json/encode.go.html#4004389">f</a></span><span class="op" id="4004501">,</span>&nbsp;<span class="string" id="4004503">&#39;g&#39;</span><span class="op" id="4004506">,</span>&nbsp;<span class="op" id="4004508">-</span><span class="num" id="4004509">1</span><span class="op" id="4004510">,</span>&nbsp;<span class="builtintype" id="4004512">int</span><span class="op" id="4004515">(</span><span class="ident" id="4004516"><a href="/gostd/encoding/json/encode.go.html#4004314">bits</a></span><span class="op" id="4004520">)</span><span class="op" id="4004521">)</span><span class="op" id="4004522">}</span><span class="op" id="4004523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4004526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4004529">b</span>&nbsp;<span class="op" id="4004531">:=</span>&nbsp;<span class="ident" id="4004534"><a href="/gostd/encoding/json/encode.go.html#3990253">strconv</a></span><span class="op" id="4004541">.</span><span class="ident" id="4004542"><a href="/gostd/strconv/ftoa.go.html#2387237">AppendFloat</a></span><span class="op" id="4004553">(</span><span class="ident" id="4004554"><a href="/gostd/encoding/json/encode.go.html#4004340">e</a></span><span class="op" id="4004555">.</span><span class="ident" id="4004556"><a href="/gostd/encoding/json/encode.go.html#3998154">scratch</a></span><span class="op" id="4004563">[</span><span class="op" id="4004564">:</span><span class="num" id="4004565">0</span><span class="op" id="4004566">]</span><span class="op" id="4004567">,</span>&nbsp;<span class="ident" id="4004569"><a href="/gostd/encoding/json/encode.go.html#4004389">f</a></span><span class="op" id="4004570">,</span>&nbsp;<span class="string" id="4004572">&#39;g&#39;</span><span class="op" id="4004575">,</span>&nbsp;<span class="op" id="4004577">-</span><span class="num" id="4004578">1</span><span class="op" id="4004579">,</span>&nbsp;<span class="builtintype" id="4004581">int</span><span class="op" id="4004584">(</span><span class="ident" id="4004585"><a href="/gostd/encoding/json/encode.go.html#4004314">bits</a></span><span class="op" id="4004589">)</span><span class="op" id="4004590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004593">if</span>&nbsp;<span class="ident" id="4004596"><a href="/gostd/encoding/json/encode.go.html#4004373">quoted</a></span>&nbsp;<span class="op" id="4004603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4004607"><a href="/gostd/encoding/json/encode.go.html#4004340">e</a></span><span class="op" id="4004608">.</span><span class="ident" id="4004609"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4004618">(</span><span class="string" id="4004619">&#39;&#34;&#39;</span><span class="op" id="4004622">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4004625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4004628"><a href="/gostd/encoding/json/encode.go.html#4004340">e</a></span><span class="op" id="4004629">.</span><span class="ident" id="4004630"><a href="/gostd/bytes/buffer.go.html#1387016">Write</a></span><span class="op" id="4004635">(</span><span class="ident" id="4004636"><a href="/gostd/encoding/json/encode.go.html#4004529">b</a></span><span class="op" id="4004637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004640">if</span>&nbsp;<span class="ident" id="4004643"><a href="/gostd/encoding/json/encode.go.html#4004373">quoted</a></span>&nbsp;<span class="op" id="4004650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4004654"><a href="/gostd/encoding/json/encode.go.html#4004340">e</a></span><span class="op" id="4004655">.</span><span class="ident" id="4004656"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4004665">(</span><span class="string" id="4004666">&#39;&#34;&#39;</span><span class="op" id="4004669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4004672">}</span><br>
<span class="lineno">525</span><span class="op" id="4004674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4004677">var</span>&nbsp;<span class="op" id="4004681">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4004684">float32Encoder</span>&nbsp;<span class="op" id="4004699">=</span>&nbsp;<span class="op" id="4004701">(</span><span class="ident" id="4004702"><a href="/gostd/encoding/json/encode.go.html#4004272">floatEncoder</a></span><span class="op" id="4004714">(</span><span class="num" id="4004715">32</span><span class="op" id="4004717">)</span><span class="op" id="4004718">)</span><span class="op" id="4004719">.</span><span class="ident" id="4004720"><a href="/gostd/encoding/json/encode.go.html#4004333">encode</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4004728">float64Encoder</span>&nbsp;<span class="op" id="4004743">=</span>&nbsp;<span class="op" id="4004745">(</span><span class="ident" id="4004746"><a href="/gostd/encoding/json/encode.go.html#4004272">floatEncoder</a></span><span class="op" id="4004758">(</span><span class="num" id="4004759">64</span><span class="op" id="4004761">)</span><span class="op" id="4004762">)</span><span class="op" id="4004763">.</span><span class="ident" id="4004764"><a href="/gostd/encoding/json/encode.go.html#4004333">encode</a></span><br>
<span class="lineno">530</span><span class="op" id="4004771">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4004774">func</span>&nbsp;<span class="ident" id="4004779">stringEncoder</span><span class="op" id="4004792">(</span><span class="ident" id="4004793">e</span>&nbsp;<span class="op" id="4004795">*</span><span class="ident" id="4004796"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="4004807">,</span>&nbsp;<span class="ident" id="4004809">v</span>&nbsp;<span class="ident" id="4004811"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4004818">.</span><span class="ident" id="4004819"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="4004824">,</span>&nbsp;<span class="ident" id="4004826">quoted</span>&nbsp;<span class="builtintype" id="4004833">bool</span><span class="op" id="4004837">)</span>&nbsp;<span class="op" id="4004839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004842">if</span>&nbsp;<span class="ident" id="4004845"><a href="/gostd/encoding/json/encode.go.html#4004809">v</a></span><span class="op" id="4004846">.</span><span class="ident" id="4004847"><a href="/gostd/reflect/value.go.html#2880910">Type</a></span><span class="op" id="4004851">(</span><span class="op" id="4004852">)</span>&nbsp;<span class="op" id="4004854">==</span>&nbsp;<span class="ident" id="4004857"><a href="/gostd/encoding/json/decode.go.html#3979804">numberType</a></span>&nbsp;<span class="op" id="4004868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4004872">numStr</span>&nbsp;<span class="op" id="4004879">:=</span>&nbsp;<span class="ident" id="4004882"><a href="/gostd/encoding/json/encode.go.html#4004809">v</a></span><span class="op" id="4004883">.</span><span class="ident" id="4004884"><a href="/gostd/reflect/value.go.html#2879739">String</a></span><span class="op" id="4004890">(</span><span class="op" id="4004891">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004895">if</span>&nbsp;<span class="ident" id="4004898"><a href="/gostd/encoding/json/encode.go.html#4004872">numStr</a></span>&nbsp;<span class="op" id="4004905">==</span>&nbsp;<span class="string" id="4004908">&#34;&#34;</span>&nbsp;<span class="op" id="4004911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4004916"><a href="/gostd/encoding/json/encode.go.html#4004872">numStr</a></span>&nbsp;<span class="op" id="4004923">=</span>&nbsp;<span class="string" id="4004925">&#34;0&#34;</span>&nbsp;<span class="comment" id="4004929">//&nbsp;Number&#39;s&nbsp;zero-val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4004952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4004956"><a href="/gostd/encoding/json/encode.go.html#4004793">e</a></span><span class="op" id="4004957">.</span><span class="ident" id="4004958"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4004969">(</span><span class="ident" id="4004970"><a href="/gostd/encoding/json/encode.go.html#4004872">numStr</a></span><span class="op" id="4004976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004980">return</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4004988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4004991">if</span>&nbsp;<span class="ident" id="4004994"><a href="/gostd/encoding/json/encode.go.html#4004826">quoted</a></span>&nbsp;<span class="op" id="4005001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4005005">sb</span><span class="op" id="4005007">,</span>&nbsp;<span class="ident" id="4005009">err</span>&nbsp;<span class="op" id="4005013">:=</span>&nbsp;<span class="ident" id="4005016"><a href="/gostd/encoding/json/encode.go.html#3995033">Marshal</a></span><span class="op" id="4005023">(</span><span class="ident" id="4005024"><a href="/gostd/encoding/json/encode.go.html#4004809">v</a></span><span class="op" id="4005025">.</span><span class="ident" id="4005026"><a href="/gostd/reflect/value.go.html#2879739">String</a></span><span class="op" id="4005032">(</span><span class="op" id="4005033">)</span><span class="op" id="4005034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4005038">if</span>&nbsp;<span class="ident" id="4005041"><a href="/gostd/encoding/json/encode.go.html#4005009">err</a></span>&nbsp;<span class="op" id="4005045">!=</span>&nbsp;<span class="builtintype" id="4005048">nil</span>&nbsp;<span class="op" id="4005052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4005057"><a href="/gostd/encoding/json/encode.go.html#4004793">e</a></span><span class="op" id="4005058">.</span><span class="builtintype" id="4005059"><a href="/gostd/encoding/json/encode.go.html#3998683">error</a></span><span class="op" id="4005064">(</span><span class="ident" id="4005065"><a href="/gostd/encoding/json/encode.go.html#4005009">err</a></span><span class="op" id="4005068">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4005072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4005076"><a href="/gostd/encoding/json/encode.go.html#4004793">e</a></span><span class="op" id="4005077">.</span><span class="builtintype" id="4005078"><a href="/gostd/encoding/json/encode.go.html#4010394">string</a></span><span class="op" id="4005084">(</span><span class="builtintype" id="4005085">string</span><span class="op" id="4005091">(</span><span class="ident" id="4005092"><a href="/gostd/encoding/json/encode.go.html#4005005">sb</a></span><span class="op" id="4005094">)</span><span class="op" id="4005095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4005098">}</span>&nbsp;<span class="keyword" id="4005100">else</span>&nbsp;<span class="op" id="4005105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4005109"><a href="/gostd/encoding/json/encode.go.html#4004793">e</a></span><span class="op" id="4005110">.</span><span class="builtintype" id="4005111"><a href="/gostd/encoding/json/encode.go.html#4010394">string</a></span><span class="op" id="4005117">(</span><span class="ident" id="4005118"><a href="/gostd/encoding/json/encode.go.html#4004809">v</a></span><span class="op" id="4005119">.</span><span class="ident" id="4005120"><a href="/gostd/reflect/value.go.html#2879739">String</a></span><span class="op" id="4005126">(</span><span class="op" id="4005127">)</span><span class="op" id="4005128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4005131">}</span><br>
<span class="lineno">550</span><span class="op" id="4005133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4005136">func</span>&nbsp;<span class="ident" id="4005141">interfaceEncoder</span><span class="op" id="4005157">(</span><span class="ident" id="4005158">e</span>&nbsp;<span class="op" id="4005160">*</span><span class="ident" id="4005161"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="4005172">,</span>&nbsp;<span class="ident" id="4005174">v</span>&nbsp;<span class="ident" id="4005176"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4005183">.</span><span class="ident" id="4005184"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="4005189">,</span>&nbsp;<span class="ident" id="4005191">quoted</span>&nbsp;<span class="builtintype" id="4005198">bool</span><span class="op" id="4005202">)</span>&nbsp;<span class="op" id="4005204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4005207">if</span>&nbsp;<span class="ident" id="4005210"><a href="/gostd/encoding/json/encode.go.html#4005174">v</a></span><span class="op" id="4005211">.</span><span class="ident" id="4005212"><a href="/gostd/reflect/value.go.html#2860565">IsNil</a></span><span class="op" id="4005217">(</span><span class="op" id="4005218">)</span>&nbsp;<span class="op" id="4005220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4005224"><a href="/gostd/encoding/json/encode.go.html#4005158">e</a></span><span class="op" id="4005225">.</span><span class="ident" id="4005226"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4005237">(</span><span class="string" id="4005238">&#34;null&#34;</span><span class="op" id="4005244">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4005248">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4005256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4005259"><a href="/gostd/encoding/json/encode.go.html#4005158">e</a></span><span class="op" id="4005260">.</span><span class="ident" id="4005261"><a href="/gostd/encoding/json/encode.go.html#3999339">reflectValue</a></span><span class="op" id="4005273">(</span><span class="ident" id="4005274"><a href="/gostd/encoding/json/encode.go.html#4005174">v</a></span><span class="op" id="4005275">.</span><span class="ident" id="4005276"><a href="/gostd/reflect/value.go.html#2853087">Elem</a></span><span class="op" id="4005280">(</span><span class="op" id="4005281">)</span><span class="op" id="4005282">)</span><br>
<span class="lineno"></span><span class="op" id="4005284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="keyword" id="4005287">func</span>&nbsp;<span class="ident" id="4005292">unsupportedTypeEncoder</span><span class="op" id="4005314">(</span><span class="ident" id="4005315">e</span>&nbsp;<span class="op" id="4005317">*</span><span class="ident" id="4005318"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="4005329">,</span>&nbsp;<span class="ident" id="4005331">v</span>&nbsp;<span class="ident" id="4005333"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4005340">.</span><span class="ident" id="4005341"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="4005346">,</span>&nbsp;<span class="ident" id="4005348">quoted</span>&nbsp;<span class="builtintype" id="4005355">bool</span><span class="op" id="4005359">)</span>&nbsp;<span class="op" id="4005361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4005364"><a href="/gostd/encoding/json/encode.go.html#4005315">e</a></span><span class="op" id="4005365">.</span><span class="builtintype" id="4005366"><a href="/gostd/encoding/json/encode.go.html#3998683">error</a></span><span class="op" id="4005371">(</span><span class="op" id="4005372">&amp;</span><span class="ident" id="4005373"><a href="/gostd/encoding/json/encode.go.html#3996888">UnsupportedTypeError</a></span><span class="op" id="4005393">{</span><span class="ident" id="4005394"><a href="/gostd/encoding/json/encode.go.html#4005331">v</a></span><span class="op" id="4005395">.</span><span class="ident" id="4005396"><a href="/gostd/reflect/value.go.html#2880910">Type</a></span><span class="op" id="4005400">(</span><span class="op" id="4005401">)</span><span class="op" id="4005402">}</span><span class="op" id="4005403">)</span><br>
<span class="lineno"></span><span class="op" id="4005405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4005408">type</span>&nbsp;<span class="ident" id="4005413">structEncoder</span>&nbsp;<span class="keyword" id="4005427">struct</span>&nbsp;<span class="op" id="4005434">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4005437">fields</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4005447">[</span><span class="op" id="4005448">]</span><span class="ident" id="4005449"><a href="/gostd/encoding/json/encode.go.html#4014134">field</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4005456">fieldEncs</span>&nbsp;<span class="op" id="4005466">[</span><span class="op" id="4005467">]</span><span class="ident" id="4005468"><a href="/gostd/encoding/json/encode.go.html#3999409">encoderFunc</a></span><br>
<span class="lineno"></span><span class="op" id="4005480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4005483">func</span>&nbsp;<span class="op" id="4005488">(</span><span class="ident" id="4005489">se</span>&nbsp;<span class="op" id="4005492">*</span><span class="ident" id="4005493"><a href="/gostd/encoding/json/encode.go.html#4005413">structEncoder</a></span><span class="op" id="4005506">)</span>&nbsp;<span class="ident" id="4005508">encode</span><span class="op" id="4005514">(</span><span class="ident" id="4005515">e</span>&nbsp;<span class="op" id="4005517">*</span><span class="ident" id="4005518"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="4005529">,</span>&nbsp;<span class="ident" id="4005531">v</span>&nbsp;<span class="ident" id="4005533"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4005540">.</span><span class="ident" id="4005541"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="4005546">,</span>&nbsp;<span class="ident" id="4005548">quoted</span>&nbsp;<span class="builtintype" id="4005555">bool</span><span class="op" id="4005559">)</span>&nbsp;<span class="op" id="4005561">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4005564"><a href="/gostd/encoding/json/encode.go.html#4005515">e</a></span><span class="op" id="4005565">.</span><span class="ident" id="4005566"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4005575">(</span><span class="string" id="4005576">&#39;{&#39;</span><span class="op" id="4005579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4005582">first</span>&nbsp;<span class="op" id="4005588">:=</span>&nbsp;<span class="builtintype" id="4005591">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4005597">for</span>&nbsp;<span class="ident" id="4005601">i</span><span class="op" id="4005602">,</span>&nbsp;<span class="ident" id="4005604">f</span>&nbsp;<span class="op" id="4005606">:=</span>&nbsp;<span class="keyword" id="4005609">range</span>&nbsp;<span class="ident" id="4005615"><a href="/gostd/encoding/json/encode.go.html#4005489">se</a></span><span class="op" id="4005617">.</span><span class="ident" id="4005618"><a href="/gostd/encoding/json/encode.go.html#4005437">fields</a></span>&nbsp;<span class="op" id="4005625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4005629">fv</span>&nbsp;<span class="op" id="4005632">:=</span>&nbsp;<span class="ident" id="4005635"><a href="/gostd/encoding/json/encode.go.html#4009489">fieldByIndex</a></span><span class="op" id="4005647">(</span><span class="ident" id="4005648"><a href="/gostd/encoding/json/encode.go.html#4005531">v</a></span><span class="op" id="4005649">,</span>&nbsp;<span class="ident" id="4005651"><a href="/gostd/encoding/json/encode.go.html#4005604">f</a></span><span class="op" id="4005652">.</span><span class="ident" id="4005653"><a href="/gostd/encoding/json/encode.go.html#4014302">index</a></span><span class="op" id="4005658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4005662">if</span>&nbsp;<span class="op" id="4005665">!</span><span class="ident" id="4005666"><a href="/gostd/encoding/json/encode.go.html#4005629">fv</a></span><span class="op" id="4005668">.</span><span class="ident" id="4005669"><a href="/gostd/reflect/value.go.html#2861333">IsValid</a></span><span class="op" id="4005676">(</span><span class="op" id="4005677">)</span>&nbsp;<span class="op" id="4005679">||</span>&nbsp;<span class="ident" id="4005682"><a href="/gostd/encoding/json/encode.go.html#4005604">f</a></span><span class="op" id="4005683">.</span><span class="ident" id="4005684"><a href="/gostd/encoding/json/encode.go.html#4014343">omitEmpty</a></span>&nbsp;<span class="op" id="4005694">&amp;&amp;</span>&nbsp;<span class="ident" id="4005697"><a href="/gostd/encoding/json/encode.go.html#3998771">isEmptyValue</a></span><span class="op" id="4005709">(</span><span class="ident" id="4005710"><a href="/gostd/encoding/json/encode.go.html#4005629">fv</a></span><span class="op" id="4005712">)</span>&nbsp;<span class="op" id="4005714">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4005719">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4005730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4005734">if</span>&nbsp;<span class="ident" id="4005737"><a href="/gostd/encoding/json/encode.go.html#4005582">first</a></span>&nbsp;<span class="op" id="4005743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4005748"><a href="/gostd/encoding/json/encode.go.html#4005582">first</a></span>&nbsp;<span class="op" id="4005754">=</span>&nbsp;<span class="builtintype" id="4005756">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4005764">}</span>&nbsp;<span class="keyword" id="4005766">else</span>&nbsp;<span class="op" id="4005771">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4005776"><a href="/gostd/encoding/json/encode.go.html#4005515">e</a></span><span class="op" id="4005777">.</span><span class="ident" id="4005778"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4005787">(</span><span class="string" id="4005788">&#39;,&#39;</span><span class="op" id="4005791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4005795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4005799"><a href="/gostd/encoding/json/encode.go.html#4005515">e</a></span><span class="op" id="4005800">.</span><span class="builtintype" id="4005801"><a href="/gostd/encoding/json/encode.go.html#4010394">string</a></span><span class="op" id="4005807">(</span><span class="ident" id="4005808"><a href="/gostd/encoding/json/encode.go.html#4005604">f</a></span><span class="op" id="4005809">.</span><span class="ident" id="4005810"><a href="/gostd/encoding/json/encode.go.html#4014150">name</a></span><span class="op" id="4005814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4005818"><a href="/gostd/encoding/json/encode.go.html#4005515">e</a></span><span class="op" id="4005819">.</span><span class="ident" id="4005820"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4005829">(</span><span class="string" id="4005830">&#39;:&#39;</span><span class="op" id="4005833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4005837"><a href="/gostd/encoding/json/encode.go.html#4005489">se</a></span><span class="op" id="4005839">.</span><span class="ident" id="4005840"><a href="/gostd/encoding/json/encode.go.html#4005456">fieldEncs</a></span><span class="op" id="4005849">[</span><span class="ident" id="4005850"><a href="/gostd/encoding/json/encode.go.html#4005601">i</a></span><span class="op" id="4005851">]</span><span class="op" id="4005852">(</span><span class="ident" id="4005853"><a href="/gostd/encoding/json/encode.go.html#4005515">e</a></span><span class="op" id="4005854">,</span>&nbsp;<span class="ident" id="4005856"><a href="/gostd/encoding/json/encode.go.html#4005629">fv</a></span><span class="op" id="4005858">,</span>&nbsp;<span class="ident" id="4005860"><a href="/gostd/encoding/json/encode.go.html#4005604">f</a></span><span class="op" id="4005861">.</span><span class="ident" id="4005862"><a href="/gostd/encoding/json/encode.go.html#4014359">quoted</a></span><span class="op" id="4005868">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4005871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4005874"><a href="/gostd/encoding/json/encode.go.html#4005515">e</a></span><span class="op" id="4005875">.</span><span class="ident" id="4005876"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4005885">(</span><span class="string" id="4005886">&#39;}&#39;</span><span class="op" id="4005889">)</span><br>
<span class="lineno"></span><span class="op" id="4005891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4005894">func</span>&nbsp;<span class="ident" id="4005899">newStructEncoder</span><span class="op" id="4005915">(</span><span class="ident" id="4005916">t</span>&nbsp;<span class="ident" id="4005918"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4005925">.</span><span class="ident" id="4005926"><a href="/gostd/reflect/type.go.html#2781467">Type</a></span><span class="op" id="4005930">)</span>&nbsp;<span class="ident" id="4005932"><a href="/gostd/encoding/json/encode.go.html#3999409">encoderFunc</a></span>&nbsp;<span class="op" id="4005944">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4005947">fields</span>&nbsp;<span class="op" id="4005954">:=</span>&nbsp;<span class="ident" id="4005957"><a href="/gostd/encoding/json/encode.go.html#4020131">cachedTypeFields</a></span><span class="op" id="4005973">(</span><span class="ident" id="4005974"><a href="/gostd/encoding/json/encode.go.html#4005916">t</a></span><span class="op" id="4005975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4005978">se</span>&nbsp;<span class="op" id="4005981">:=</span>&nbsp;<span class="op" id="4005984">&amp;</span><span class="ident" id="4005985"><a href="/gostd/encoding/json/encode.go.html#4005413">structEncoder</a></span><span class="op" id="4005998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4006002"><a href="/gostd/encoding/json/encode.go.html#4005437">fields</a></span><span class="op" id="4006008">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4006013"><a href="/gostd/encoding/json/encode.go.html#4005947">fields</a></span><span class="op" id="4006019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4006023"><a href="/gostd/encoding/json/encode.go.html#4005456">fieldEncs</a></span><span class="op" id="4006032">:</span>&nbsp;<span class="builtinfunc" id="4006034">make</span><span class="op" id="4006038">(</span><span class="op" id="4006039">[</span><span class="op" id="4006040">]</span><span class="ident" id="4006041"><a href="/gostd/encoding/json/encode.go.html#3999409">encoderFunc</a></span><span class="op" id="4006052">,</span>&nbsp;<span class="builtinfunc" id="4006054">len</span><span class="op" id="4006057">(</span><span class="ident" id="4006058"><a href="/gostd/encoding/json/encode.go.html#4005947">fields</a></span><span class="op" id="4006064">)</span><span class="op" id="4006065">)</span><span class="op" id="4006066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4006069">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4006072">for</span>&nbsp;<span class="ident" id="4006076">i</span><span class="op" id="4006077">,</span>&nbsp;<span class="ident" id="4006079">f</span>&nbsp;<span class="op" id="4006081">:=</span>&nbsp;<span class="keyword" id="4006084">range</span>&nbsp;<span class="ident" id="4006090"><a href="/gostd/encoding/json/encode.go.html#4005947">fields</a></span>&nbsp;<span class="op" id="4006097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4006101"><a href="/gostd/encoding/json/encode.go.html#4005978">se</a></span><span class="op" id="4006103">.</span><span class="ident" id="4006104"><a href="/gostd/encoding/json/encode.go.html#4005456">fieldEncs</a></span><span class="op" id="4006113">[</span><span class="ident" id="4006114"><a href="/gostd/encoding/json/encode.go.html#4006076">i</a></span><span class="op" id="4006115">]</span>&nbsp;<span class="op" id="4006117">=</span>&nbsp;<span class="ident" id="4006119"><a href="/gostd/encoding/json/encode.go.html#3999686">typeEncoder</a></span><span class="op" id="4006130">(</span><span class="ident" id="4006131"><a href="/gostd/encoding/json/encode.go.html#4009714">typeByIndex</a></span><span class="op" id="4006142">(</span><span class="ident" id="4006143"><a href="/gostd/encoding/json/encode.go.html#4005916">t</a></span><span class="op" id="4006144">,</span>&nbsp;<span class="ident" id="4006146"><a href="/gostd/encoding/json/encode.go.html#4006079">f</a></span><span class="op" id="4006147">.</span><span class="ident" id="4006148"><a href="/gostd/encoding/json/encode.go.html#4014302">index</a></span><span class="op" id="4006153">)</span><span class="op" id="4006154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4006157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4006160">return</span>&nbsp;<span class="ident" id="4006167"><a href="/gostd/encoding/json/encode.go.html#4005978">se</a></span><span class="op" id="4006169">.</span><span class="ident" id="4006170"><a href="/gostd/encoding/json/encode.go.html#4005508">encode</a></span><br>
<span class="lineno"></span><span class="op" id="4006177">}</span><br>
<span class="lineno">600</span><br>
<span class="lineno"></span><span class="keyword" id="4006180">type</span>&nbsp;<span class="ident" id="4006185">mapEncoder</span>&nbsp;<span class="keyword" id="4006196">struct</span>&nbsp;<span class="op" id="4006203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4006206">elemEnc</span>&nbsp;<span class="ident" id="4006214"><a href="/gostd/encoding/json/encode.go.html#3999409">encoderFunc</a></span><br>
<span class="lineno"></span><span class="op" id="4006226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">605</span><span class="keyword" id="4006229">func</span>&nbsp;<span class="op" id="4006234">(</span><span class="ident" id="4006235">me</span>&nbsp;<span class="op" id="4006238">*</span><span class="ident" id="4006239"><a href="/gostd/encoding/json/encode.go.html#4006185">mapEncoder</a></span><span class="op" id="4006249">)</span>&nbsp;<span class="ident" id="4006251">encode</span><span class="op" id="4006257">(</span><span class="ident" id="4006258">e</span>&nbsp;<span class="op" id="4006260">*</span><span class="ident" id="4006261"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="4006272">,</span>&nbsp;<span class="ident" id="4006274">v</span>&nbsp;<span class="ident" id="4006276"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4006283">.</span><span class="ident" id="4006284"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="4006289">,</span>&nbsp;<span class="ident" id="4006291">_</span>&nbsp;<span class="builtintype" id="4006293">bool</span><span class="op" id="4006297">)</span>&nbsp;<span class="op" id="4006299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4006302">if</span>&nbsp;<span class="ident" id="4006305"><a href="/gostd/encoding/json/encode.go.html#4006274">v</a></span><span class="op" id="4006306">.</span><span class="ident" id="4006307"><a href="/gostd/reflect/value.go.html#2860565">IsNil</a></span><span class="op" id="4006312">(</span><span class="op" id="4006313">)</span>&nbsp;<span class="op" id="4006315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4006319"><a href="/gostd/encoding/json/encode.go.html#4006258">e</a></span><span class="op" id="4006320">.</span><span class="ident" id="4006321"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4006332">(</span><span class="string" id="4006333">&#34;null&#34;</span><span class="op" id="4006339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4006343">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4006351">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4006354"><a href="/gostd/encoding/json/encode.go.html#4006258">e</a></span><span class="op" id="4006355">.</span><span class="ident" id="4006356"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4006365">(</span><span class="string" id="4006366">&#39;{&#39;</span><span class="op" id="4006369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4006372">var</span>&nbsp;<span class="ident" id="4006376">sv</span>&nbsp;<span class="ident" id="4006379"><a href="/gostd/encoding/json/encode.go.html#4010013">stringValues</a></span>&nbsp;<span class="op" id="4006392">=</span>&nbsp;<span class="ident" id="4006394"><a href="/gostd/encoding/json/encode.go.html#4006274">v</a></span><span class="op" id="4006395">.</span><span class="ident" id="4006396"><a href="/gostd/reflect/value.go.html#2863601">MapKeys</a></span><span class="op" id="4006403">(</span><span class="op" id="4006404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4006407"><a href="/gostd/encoding/json/encode.go.html#3990245">sort</a></span><span class="op" id="4006411">.</span><span class="ident" id="4006412"><a href="/gostd/sort/sort.go.html#2015380">Sort</a></span><span class="op" id="4006416">(</span><span class="ident" id="4006417"><a href="/gostd/encoding/json/encode.go.html#4006376">sv</a></span><span class="op" id="4006419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4006422">for</span>&nbsp;<span class="ident" id="4006426">i</span><span class="op" id="4006427">,</span>&nbsp;<span class="ident" id="4006429">k</span>&nbsp;<span class="op" id="4006431">:=</span>&nbsp;<span class="keyword" id="4006434">range</span>&nbsp;<span class="ident" id="4006440"><a href="/gostd/encoding/json/encode.go.html#4006376">sv</a></span>&nbsp;<span class="op" id="4006443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4006447">if</span>&nbsp;<span class="ident" id="4006450"><a href="/gostd/encoding/json/encode.go.html#4006426">i</a></span>&nbsp;<span class="op" id="4006452">&gt;</span>&nbsp;<span class="num" id="4006454">0</span>&nbsp;<span class="op" id="4006456">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4006461"><a href="/gostd/encoding/json/encode.go.html#4006258">e</a></span><span class="op" id="4006462">.</span><span class="ident" id="4006463"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4006472">(</span><span class="string" id="4006473">&#39;,&#39;</span><span class="op" id="4006476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4006480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4006484"><a href="/gostd/encoding/json/encode.go.html#4006258">e</a></span><span class="op" id="4006485">.</span><span class="builtintype" id="4006486"><a href="/gostd/encoding/json/encode.go.html#4010394">string</a></span><span class="op" id="4006492">(</span><span class="ident" id="4006493"><a href="/gostd/encoding/json/encode.go.html#4006429">k</a></span><span class="op" id="4006494">.</span><span class="ident" id="4006495"><a href="/gostd/reflect/value.go.html#2879739">String</a></span><span class="op" id="4006501">(</span><span class="op" id="4006502">)</span><span class="op" id="4006503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4006507"><a href="/gostd/encoding/json/encode.go.html#4006258">e</a></span><span class="op" id="4006508">.</span><span class="ident" id="4006509"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4006518">(</span><span class="string" id="4006519">&#39;:&#39;</span><span class="op" id="4006522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4006526"><a href="/gostd/encoding/json/encode.go.html#4006235">me</a></span><span class="op" id="4006528">.</span><span class="ident" id="4006529"><a href="/gostd/encoding/json/encode.go.html#4006206">elemEnc</a></span><span class="op" id="4006536">(</span><span class="ident" id="4006537"><a href="/gostd/encoding/json/encode.go.html#4006258">e</a></span><span class="op" id="4006538">,</span>&nbsp;<span class="ident" id="4006540"><a href="/gostd/encoding/json/encode.go.html#4006274">v</a></span><span class="op" id="4006541">.</span><span class="ident" id="4006542"><a href="/gostd/reflect/value.go.html#2862367">MapIndex</a></span><span class="op" id="4006550">(</span><span class="ident" id="4006551"><a href="/gostd/encoding/json/encode.go.html#4006429">k</a></span><span class="op" id="4006552">)</span><span class="op" id="4006553">,</span>&nbsp;<span class="builtintype" id="4006555">false</span><span class="op" id="4006560">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4006563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4006566"><a href="/gostd/encoding/json/encode.go.html#4006258">e</a></span><span class="op" id="4006567">.</span><span class="ident" id="4006568"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4006577">(</span><span class="string" id="4006578">&#39;}&#39;</span><span class="op" id="4006581">)</span><br>
<span class="lineno"></span><span class="op" id="4006583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4006586">func</span>&nbsp;<span class="ident" id="4006591">newMapEncoder</span><span class="op" id="4006604">(</span><span class="ident" id="4006605">t</span>&nbsp;<span class="ident" id="4006607"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4006614">.</span><span class="ident" id="4006615"><a href="/gostd/reflect/type.go.html#2781467">Type</a></span><span class="op" id="4006619">)</span>&nbsp;<span class="ident" id="4006621"><a href="/gostd/encoding/json/encode.go.html#3999409">encoderFunc</a></span>&nbsp;<span class="op" id="4006633">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4006636">if</span>&nbsp;<span class="ident" id="4006639"><a href="/gostd/encoding/json/encode.go.html#4006605">t</a></span><span class="op" id="4006640">.</span><span class="ident" id="4006641"><a href="/gostd/reflect/type.go.html#2786340">Key</a></span><span class="op" id="4006644">(</span><span class="op" id="4006645">)</span><span class="op" id="4006646">.</span><span class="ident" id="4006647"><a href="/gostd/reflect/type.go.html#2783619">Kind</a></span><span class="op" id="4006651">(</span><span class="op" id="4006652">)</span>&nbsp;<span class="op" id="4006654">!=</span>&nbsp;<span class="ident" id="4006657"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4006664">.</span><span class="ident" id="4006665"><a href="/gostd/reflect/type.go.html#2788069">String</a></span>&nbsp;<span class="op" id="4006672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4006676">return</span>&nbsp;<span class="ident" id="4006683"><a href="/gostd/encoding/json/encode.go.html#4005292">unsupportedTypeEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4006707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4006710">me</span>&nbsp;<span class="op" id="4006713">:=</span>&nbsp;<span class="op" id="4006716">&amp;</span><span class="ident" id="4006717"><a href="/gostd/encoding/json/encode.go.html#4006185">mapEncoder</a></span><span class="op" id="4006727">{</span><span class="ident" id="4006728"><a href="/gostd/encoding/json/encode.go.html#3999686">typeEncoder</a></span><span class="op" id="4006739">(</span><span class="ident" id="4006740"><a href="/gostd/encoding/json/encode.go.html#4006605">t</a></span><span class="op" id="4006741">.</span><span class="ident" id="4006742"><a href="/gostd/reflect/type.go.html#2785263">Elem</a></span><span class="op" id="4006746">(</span><span class="op" id="4006747">)</span><span class="op" id="4006748">)</span><span class="op" id="4006749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4006752">return</span>&nbsp;<span class="ident" id="4006759"><a href="/gostd/encoding/json/encode.go.html#4006710">me</a></span><span class="op" id="4006761">.</span><span class="ident" id="4006762"><a href="/gostd/encoding/json/encode.go.html#4006251">encode</a></span><br>
<span class="lineno">630</span><span class="op" id="4006769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4006772">func</span>&nbsp;<span class="ident" id="4006777">encodeByteSlice</span><span class="op" id="4006792">(</span><span class="ident" id="4006793">e</span>&nbsp;<span class="op" id="4006795">*</span><span class="ident" id="4006796"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="4006807">,</span>&nbsp;<span class="ident" id="4006809">v</span>&nbsp;<span class="ident" id="4006811"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4006818">.</span><span class="ident" id="4006819"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="4006824">,</span>&nbsp;<span class="ident" id="4006826">_</span>&nbsp;<span class="builtintype" id="4006828">bool</span><span class="op" id="4006832">)</span>&nbsp;<span class="op" id="4006834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4006837">if</span>&nbsp;<span class="ident" id="4006840"><a href="/gostd/encoding/json/encode.go.html#4006809">v</a></span><span class="op" id="4006841">.</span><span class="ident" id="4006842"><a href="/gostd/reflect/value.go.html#2860565">IsNil</a></span><span class="op" id="4006847">(</span><span class="op" id="4006848">)</span>&nbsp;<span class="op" id="4006850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4006854"><a href="/gostd/encoding/json/encode.go.html#4006793">e</a></span><span class="op" id="4006855">.</span><span class="ident" id="4006856"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4006867">(</span><span class="string" id="4006868">&#34;null&#34;</span><span class="op" id="4006874">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4006878">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4006886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4006889">s</span>&nbsp;<span class="op" id="4006891">:=</span>&nbsp;<span class="ident" id="4006894"><a href="/gostd/encoding/json/encode.go.html#4006809">v</a></span><span class="op" id="4006895">.</span><span class="ident" id="4006896"><a href="/gostd/reflect/value.go.html#2839927">Bytes</a></span><span class="op" id="4006901">(</span><span class="op" id="4006902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4006905"><a href="/gostd/encoding/json/encode.go.html#4006793">e</a></span><span class="op" id="4006906">.</span><span class="ident" id="4006907"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4006916">(</span><span class="string" id="4006917">&#39;&#34;&#39;</span><span class="op" id="4006920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4006923">if</span>&nbsp;<span class="builtinfunc" id="4006926">len</span><span class="op" id="4006929">(</span><span class="ident" id="4006930"><a href="/gostd/encoding/json/encode.go.html#4006889">s</a></span><span class="op" id="4006931">)</span>&nbsp;<span class="op" id="4006933">&lt;</span>&nbsp;<span class="num" id="4006935">1024</span>&nbsp;<span class="op" id="4006940">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4006944">//&nbsp;for&nbsp;small&nbsp;buffers,&nbsp;using&nbsp;Encode&nbsp;directly&nbsp;is&nbsp;much&nbsp;faster.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4007006">dst</span>&nbsp;<span class="op" id="4007010">:=</span>&nbsp;<span class="builtinfunc" id="4007013">make</span><span class="op" id="4007017">(</span><span class="op" id="4007018">[</span><span class="op" id="4007019">]</span><span class="builtintype" id="4007020">byte</span><span class="op" id="4007024">,</span>&nbsp;<span class="ident" id="4007026"><a href="/gostd/encoding/json/encode.go.html#3990196">base64</a></span><span class="op" id="4007032">.</span><span class="ident" id="4007033"><a href="/gostd/encoding/base64/base64.go.html#4053069">StdEncoding</a></span><span class="op" id="4007044">.</span><span class="ident" id="4007045"><a href="/gostd/encoding/base64/base64.go.html#4056463">EncodedLen</a></span><span class="op" id="4007055">(</span><span class="builtinfunc" id="4007056">len</span><span class="op" id="4007059">(</span><span class="ident" id="4007060"><a href="/gostd/encoding/json/encode.go.html#4006889">s</a></span><span class="op" id="4007061">)</span><span class="op" id="4007062">)</span><span class="op" id="4007063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4007067"><a href="/gostd/encoding/json/encode.go.html#3990196">base64</a></span><span class="op" id="4007073">.</span><span class="ident" id="4007074"><a href="/gostd/encoding/base64/base64.go.html#4053069">StdEncoding</a></span><span class="op" id="4007085">.</span><span class="ident" id="4007086"><a href="/gostd/encoding/base64/base64.go.html#4053678">Encode</a></span><span class="op" id="4007092">(</span><span class="ident" id="4007093"><a href="/gostd/encoding/json/encode.go.html#4007006">dst</a></span><span class="op" id="4007096">,</span>&nbsp;<span class="ident" id="4007098"><a href="/gostd/encoding/json/encode.go.html#4006889">s</a></span><span class="op" id="4007099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4007103"><a href="/gostd/encoding/json/encode.go.html#4006793">e</a></span><span class="op" id="4007104">.</span><span class="ident" id="4007105"><a href="/gostd/bytes/buffer.go.html#1387016">Write</a></span><span class="op" id="4007110">(</span><span class="ident" id="4007111"><a href="/gostd/encoding/json/encode.go.html#4007006">dst</a></span><span class="op" id="4007114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4007117">}</span>&nbsp;<span class="keyword" id="4007119">else</span>&nbsp;<span class="op" id="4007124">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4007128">//&nbsp;for&nbsp;large&nbsp;buffers,&nbsp;avoid&nbsp;unnecessary&nbsp;extra&nbsp;temporary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4007186">//&nbsp;buffer&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4007205">enc</span>&nbsp;<span class="op" id="4007209">:=</span>&nbsp;<span class="ident" id="4007212"><a href="/gostd/encoding/json/encode.go.html#3990196">base64</a></span><span class="op" id="4007218">.</span><span class="ident" id="4007219"><a href="/gostd/encoding/base64/base64.go.html#4056250">NewEncoder</a></span><span class="op" id="4007229">(</span><span class="ident" id="4007230"><a href="/gostd/encoding/json/encode.go.html#3990196">base64</a></span><span class="op" id="4007236">.</span><span class="ident" id="4007237"><a href="/gostd/encoding/base64/base64.go.html#4053069">StdEncoding</a></span><span class="op" id="4007248">,</span>&nbsp;<span class="ident" id="4007250"><a href="/gostd/encoding/json/encode.go.html#4006793">e</a></span><span class="op" id="4007251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4007255"><a href="/gostd/encoding/json/encode.go.html#4007205">enc</a></span><span class="op" id="4007258">.</span><span class="ident" id="4007259"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4007264">(</span><span class="ident" id="4007265"><a href="/gostd/encoding/json/encode.go.html#4006889">s</a></span><span class="op" id="4007266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4007270"><a href="/gostd/encoding/json/encode.go.html#4007205">enc</a></span><span class="op" id="4007273">.</span><span class="ident" id="4007274"><a href="/gostd/io/io.go.html#1422583">Close</a></span><span class="op" id="4007279">(</span><span class="op" id="4007280">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4007283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4007286"><a href="/gostd/encoding/json/encode.go.html#4006793">e</a></span><span class="op" id="4007287">.</span><span class="ident" id="4007288"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4007297">(</span><span class="string" id="4007298">&#39;&#34;&#39;</span><span class="op" id="4007301">)</span><br>
<span class="lineno"></span><span class="op" id="4007303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4007306">//&nbsp;sliceEncoder&nbsp;just&nbsp;wraps&nbsp;an&nbsp;arrayEncoder,&nbsp;checking&nbsp;to&nbsp;make&nbsp;sure&nbsp;the&nbsp;value&nbsp;isn&#39;t&nbsp;nil.</span><br>
<span class="lineno">655</span><span class="keyword" id="4007393">type</span>&nbsp;<span class="ident" id="4007398">sliceEncoder</span>&nbsp;<span class="keyword" id="4007411">struct</span>&nbsp;<span class="op" id="4007418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4007421">arrayEnc</span>&nbsp;<span class="ident" id="4007430"><a href="/gostd/encoding/json/encode.go.html#3999409">encoderFunc</a></span><br>
<span class="lineno"></span><span class="op" id="4007442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4007445">func</span>&nbsp;<span class="op" id="4007450">(</span><span class="ident" id="4007451">se</span>&nbsp;<span class="op" id="4007454">*</span><span class="ident" id="4007455"><a href="/gostd/encoding/json/encode.go.html#4007398">sliceEncoder</a></span><span class="op" id="4007467">)</span>&nbsp;<span class="ident" id="4007469">encode</span><span class="op" id="4007475">(</span><span class="ident" id="4007476">e</span>&nbsp;<span class="op" id="4007478">*</span><span class="ident" id="4007479"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="4007490">,</span>&nbsp;<span class="ident" id="4007492">v</span>&nbsp;<span class="ident" id="4007494"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4007501">.</span><span class="ident" id="4007502"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="4007507">,</span>&nbsp;<span class="ident" id="4007509">_</span>&nbsp;<span class="builtintype" id="4007511">bool</span><span class="op" id="4007515">)</span>&nbsp;<span class="op" id="4007517">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4007520">if</span>&nbsp;<span class="ident" id="4007523"><a href="/gostd/encoding/json/encode.go.html#4007492">v</a></span><span class="op" id="4007524">.</span><span class="ident" id="4007525"><a href="/gostd/reflect/value.go.html#2860565">IsNil</a></span><span class="op" id="4007530">(</span><span class="op" id="4007531">)</span>&nbsp;<span class="op" id="4007533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4007537"><a href="/gostd/encoding/json/encode.go.html#4007476">e</a></span><span class="op" id="4007538">.</span><span class="ident" id="4007539"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4007550">(</span><span class="string" id="4007551">&#34;null&#34;</span><span class="op" id="4007557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4007561">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4007569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4007572"><a href="/gostd/encoding/json/encode.go.html#4007451">se</a></span><span class="op" id="4007574">.</span><span class="ident" id="4007575"><a href="/gostd/encoding/json/encode.go.html#4007421">arrayEnc</a></span><span class="op" id="4007583">(</span><span class="ident" id="4007584"><a href="/gostd/encoding/json/encode.go.html#4007476">e</a></span><span class="op" id="4007585">,</span>&nbsp;<span class="ident" id="4007587"><a href="/gostd/encoding/json/encode.go.html#4007492">v</a></span><span class="op" id="4007588">,</span>&nbsp;<span class="builtintype" id="4007590">false</span><span class="op" id="4007595">)</span><br>
<span class="lineno">665</span><span class="op" id="4007597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4007600">func</span>&nbsp;<span class="ident" id="4007605">newSliceEncoder</span><span class="op" id="4007620">(</span><span class="ident" id="4007621">t</span>&nbsp;<span class="ident" id="4007623"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4007630">.</span><span class="ident" id="4007631"><a href="/gostd/reflect/type.go.html#2781467">Type</a></span><span class="op" id="4007635">)</span>&nbsp;<span class="ident" id="4007637"><a href="/gostd/encoding/json/encode.go.html#3999409">encoderFunc</a></span>&nbsp;<span class="op" id="4007649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4007652">//&nbsp;Byte&nbsp;slices&nbsp;get&nbsp;special&nbsp;treatment;&nbsp;arrays&nbsp;don&#39;t.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4007705">if</span>&nbsp;<span class="ident" id="4007708"><a href="/gostd/encoding/json/encode.go.html#4007621">t</a></span><span class="op" id="4007709">.</span><span class="ident" id="4007710"><a href="/gostd/reflect/type.go.html#2785263">Elem</a></span><span class="op" id="4007714">(</span><span class="op" id="4007715">)</span><span class="op" id="4007716">.</span><span class="ident" id="4007717"><a href="/gostd/reflect/type.go.html#2783619">Kind</a></span><span class="op" id="4007721">(</span><span class="op" id="4007722">)</span>&nbsp;<span class="op" id="4007724">==</span>&nbsp;<span class="ident" id="4007727"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4007734">.</span><span class="ident" id="4007735"><a href="/gostd/reflect/type.go.html#2787941">Uint8</a></span>&nbsp;<span class="op" id="4007741">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4007745">return</span>&nbsp;<span class="ident" id="4007752"><a href="/gostd/encoding/json/encode.go.html#4006777">encodeByteSlice</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4007769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4007772">enc</span>&nbsp;<span class="op" id="4007776">:=</span>&nbsp;<span class="op" id="4007779">&amp;</span><span class="ident" id="4007780"><a href="/gostd/encoding/json/encode.go.html#4007398">sliceEncoder</a></span><span class="op" id="4007792">{</span><span class="ident" id="4007793"><a href="/gostd/encoding/json/encode.go.html#4008119">newArrayEncoder</a></span><span class="op" id="4007808">(</span><span class="ident" id="4007809"><a href="/gostd/encoding/json/encode.go.html#4007621">t</a></span><span class="op" id="4007810">)</span><span class="op" id="4007811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4007814">return</span>&nbsp;<span class="ident" id="4007821"><a href="/gostd/encoding/json/encode.go.html#4007772">enc</a></span><span class="op" id="4007824">.</span><span class="ident" id="4007825"><a href="/gostd/encoding/json/encode.go.html#4007469">encode</a></span><br>
<span class="lineno"></span><span class="op" id="4007832">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span><span class="keyword" id="4007835">type</span>&nbsp;<span class="ident" id="4007840">arrayEncoder</span>&nbsp;<span class="keyword" id="4007853">struct</span>&nbsp;<span class="op" id="4007860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4007863">elemEnc</span>&nbsp;<span class="ident" id="4007871"><a href="/gostd/encoding/json/encode.go.html#3999409">encoderFunc</a></span><br>
<span class="lineno"></span><span class="op" id="4007883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span><span class="keyword" id="4007886">func</span>&nbsp;<span class="op" id="4007891">(</span><span class="ident" id="4007892">ae</span>&nbsp;<span class="op" id="4007895">*</span><span class="ident" id="4007896"><a href="/gostd/encoding/json/encode.go.html#4007840">arrayEncoder</a></span><span class="op" id="4007908">)</span>&nbsp;<span class="ident" id="4007910">encode</span><span class="op" id="4007916">(</span><span class="ident" id="4007917">e</span>&nbsp;<span class="op" id="4007919">*</span><span class="ident" id="4007920"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="4007931">,</span>&nbsp;<span class="ident" id="4007933">v</span>&nbsp;<span class="ident" id="4007935"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4007942">.</span><span class="ident" id="4007943"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="4007948">,</span>&nbsp;<span class="ident" id="4007950">_</span>&nbsp;<span class="builtintype" id="4007952">bool</span><span class="op" id="4007956">)</span>&nbsp;<span class="op" id="4007958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4007961"><a href="/gostd/encoding/json/encode.go.html#4007917">e</a></span><span class="op" id="4007962">.</span><span class="ident" id="4007963"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4007972">(</span><span class="string" id="4007973">&#39;[&#39;</span><span class="op" id="4007976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4007979">n</span>&nbsp;<span class="op" id="4007981">:=</span>&nbsp;<span class="ident" id="4007984"><a href="/gostd/encoding/json/encode.go.html#4007933">v</a></span><span class="op" id="4007985">.</span><span class="ident" id="4007986"><a href="/gostd/reflect/value.go.html#2861631">Len</a></span><span class="op" id="4007989">(</span><span class="op" id="4007990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4007993">for</span>&nbsp;<span class="ident" id="4007997">i</span>&nbsp;<span class="op" id="4007999">:=</span>&nbsp;<span class="num" id="4008002">0</span><span class="op" id="4008003">;</span>&nbsp;<span class="ident" id="4008005"><a href="/gostd/encoding/json/encode.go.html#4007997">i</a></span>&nbsp;<span class="op" id="4008007">&lt;</span>&nbsp;<span class="ident" id="4008009"><a href="/gostd/encoding/json/encode.go.html#4007979">n</a></span><span class="op" id="4008010">;</span>&nbsp;<span class="ident" id="4008012"><a href="/gostd/encoding/json/encode.go.html#4007997">i</a></span><span class="op" id="4008013">++</span>&nbsp;<span class="op" id="4008016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4008020">if</span>&nbsp;<span class="ident" id="4008023"><a href="/gostd/encoding/json/encode.go.html#4007997">i</a></span>&nbsp;<span class="op" id="4008025">&gt;</span>&nbsp;<span class="num" id="4008027">0</span>&nbsp;<span class="op" id="4008029">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4008034"><a href="/gostd/encoding/json/encode.go.html#4007917">e</a></span><span class="op" id="4008035">.</span><span class="ident" id="4008036"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4008045">(</span><span class="string" id="4008046">&#39;,&#39;</span><span class="op" id="4008049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4008053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4008057"><a href="/gostd/encoding/json/encode.go.html#4007892">ae</a></span><span class="op" id="4008059">.</span><span class="ident" id="4008060"><a href="/gostd/encoding/json/encode.go.html#4007863">elemEnc</a></span><span class="op" id="4008067">(</span><span class="ident" id="4008068"><a href="/gostd/encoding/json/encode.go.html#4007917">e</a></span><span class="op" id="4008069">,</span>&nbsp;<span class="ident" id="4008071"><a href="/gostd/encoding/json/encode.go.html#4007933">v</a></span><span class="op" id="4008072">.</span><span class="ident" id="4008073"><a href="/gostd/reflect/value.go.html#2856377">Index</a></span><span class="op" id="4008078">(</span><span class="ident" id="4008079"><a href="/gostd/encoding/json/encode.go.html#4007997">i</a></span><span class="op" id="4008080">)</span><span class="op" id="4008081">,</span>&nbsp;<span class="builtintype" id="4008083">false</span><span class="op" id="4008088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4008091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4008094"><a href="/gostd/encoding/json/encode.go.html#4007917">e</a></span><span class="op" id="4008095">.</span><span class="ident" id="4008096"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4008105">(</span><span class="string" id="4008106">&#39;]&#39;</span><span class="op" id="4008109">)</span><br>
<span class="lineno">690</span><span class="op" id="4008111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4008114">func</span>&nbsp;<span class="ident" id="4008119">newArrayEncoder</span><span class="op" id="4008134">(</span><span class="ident" id="4008135">t</span>&nbsp;<span class="ident" id="4008137"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4008144">.</span><span class="ident" id="4008145"><a href="/gostd/reflect/type.go.html#2781467">Type</a></span><span class="op" id="4008149">)</span>&nbsp;<span class="ident" id="4008151"><a href="/gostd/encoding/json/encode.go.html#3999409">encoderFunc</a></span>&nbsp;<span class="op" id="4008163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4008166">enc</span>&nbsp;<span class="op" id="4008170">:=</span>&nbsp;<span class="op" id="4008173">&amp;</span><span class="ident" id="4008174"><a href="/gostd/encoding/json/encode.go.html#4007840">arrayEncoder</a></span><span class="op" id="4008186">{</span><span class="ident" id="4008187"><a href="/gostd/encoding/json/encode.go.html#3999686">typeEncoder</a></span><span class="op" id="4008198">(</span><span class="ident" id="4008199"><a href="/gostd/encoding/json/encode.go.html#4008135">t</a></span><span class="op" id="4008200">.</span><span class="ident" id="4008201"><a href="/gostd/reflect/type.go.html#2785263">Elem</a></span><span class="op" id="4008205">(</span><span class="op" id="4008206">)</span><span class="op" id="4008207">)</span><span class="op" id="4008208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4008211">return</span>&nbsp;<span class="ident" id="4008218"><a href="/gostd/encoding/json/encode.go.html#4008166">enc</a></span><span class="op" id="4008221">.</span><span class="ident" id="4008222"><a href="/gostd/encoding/json/encode.go.html#4007910">encode</a></span><br>
<span class="lineno">695</span><span class="op" id="4008229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4008232">type</span>&nbsp;<span class="ident" id="4008237">ptrEncoder</span>&nbsp;<span class="keyword" id="4008248">struct</span>&nbsp;<span class="op" id="4008255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4008258">elemEnc</span>&nbsp;<span class="ident" id="4008266"><a href="/gostd/encoding/json/encode.go.html#3999409">encoderFunc</a></span><br>
<span class="lineno"></span><span class="op" id="4008278">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span><span class="keyword" id="4008281">func</span>&nbsp;<span class="op" id="4008286">(</span><span class="ident" id="4008287">pe</span>&nbsp;<span class="op" id="4008290">*</span><span class="ident" id="4008291"><a href="/gostd/encoding/json/encode.go.html#4008237">ptrEncoder</a></span><span class="op" id="4008301">)</span>&nbsp;<span class="ident" id="4008303">encode</span><span class="op" id="4008309">(</span><span class="ident" id="4008310">e</span>&nbsp;<span class="op" id="4008312">*</span><span class="ident" id="4008313"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="4008324">,</span>&nbsp;<span class="ident" id="4008326">v</span>&nbsp;<span class="ident" id="4008328"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4008335">.</span><span class="ident" id="4008336"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="4008341">,</span>&nbsp;<span class="ident" id="4008343">quoted</span>&nbsp;<span class="builtintype" id="4008350">bool</span><span class="op" id="4008354">)</span>&nbsp;<span class="op" id="4008356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4008359">if</span>&nbsp;<span class="ident" id="4008362"><a href="/gostd/encoding/json/encode.go.html#4008326">v</a></span><span class="op" id="4008363">.</span><span class="ident" id="4008364"><a href="/gostd/reflect/value.go.html#2860565">IsNil</a></span><span class="op" id="4008369">(</span><span class="op" id="4008370">)</span>&nbsp;<span class="op" id="4008372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4008376"><a href="/gostd/encoding/json/encode.go.html#4008310">e</a></span><span class="op" id="4008377">.</span><span class="ident" id="4008378"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4008389">(</span><span class="string" id="4008390">&#34;null&#34;</span><span class="op" id="4008396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4008400">return</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4008408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4008411"><a href="/gostd/encoding/json/encode.go.html#4008287">pe</a></span><span class="op" id="4008413">.</span><span class="ident" id="4008414"><a href="/gostd/encoding/json/encode.go.html#4008258">elemEnc</a></span><span class="op" id="4008421">(</span><span class="ident" id="4008422"><a href="/gostd/encoding/json/encode.go.html#4008310">e</a></span><span class="op" id="4008423">,</span>&nbsp;<span class="ident" id="4008425"><a href="/gostd/encoding/json/encode.go.html#4008326">v</a></span><span class="op" id="4008426">.</span><span class="ident" id="4008427"><a href="/gostd/reflect/value.go.html#2853087">Elem</a></span><span class="op" id="4008431">(</span><span class="op" id="4008432">)</span><span class="op" id="4008433">,</span>&nbsp;<span class="ident" id="4008435"><a href="/gostd/encoding/json/encode.go.html#4008343">quoted</a></span><span class="op" id="4008441">)</span><br>
<span class="lineno"></span><span class="op" id="4008443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4008446">func</span>&nbsp;<span class="ident" id="4008451">newPtrEncoder</span><span class="op" id="4008464">(</span><span class="ident" id="4008465">t</span>&nbsp;<span class="ident" id="4008467"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4008474">.</span><span class="ident" id="4008475"><a href="/gostd/reflect/type.go.html#2781467">Type</a></span><span class="op" id="4008479">)</span>&nbsp;<span class="ident" id="4008481"><a href="/gostd/encoding/json/encode.go.html#3999409">encoderFunc</a></span>&nbsp;<span class="op" id="4008493">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4008496">enc</span>&nbsp;<span class="op" id="4008500">:=</span>&nbsp;<span class="op" id="4008503">&amp;</span><span class="ident" id="4008504"><a href="/gostd/encoding/json/encode.go.html#4008237">ptrEncoder</a></span><span class="op" id="4008514">{</span><span class="ident" id="4008515"><a href="/gostd/encoding/json/encode.go.html#3999686">typeEncoder</a></span><span class="op" id="4008526">(</span><span class="ident" id="4008527"><a href="/gostd/encoding/json/encode.go.html#4008465">t</a></span><span class="op" id="4008528">.</span><span class="ident" id="4008529"><a href="/gostd/reflect/type.go.html#2785263">Elem</a></span><span class="op" id="4008533">(</span><span class="op" id="4008534">)</span><span class="op" id="4008535">)</span><span class="op" id="4008536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4008539">return</span>&nbsp;<span class="ident" id="4008546"><a href="/gostd/encoding/json/encode.go.html#4008496">enc</a></span><span class="op" id="4008549">.</span><span class="ident" id="4008550"><a href="/gostd/encoding/json/encode.go.html#4008303">encode</a></span><br>
<span class="lineno"></span><span class="op" id="4008557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4008560">type</span>&nbsp;<span class="ident" id="4008565">condAddrEncoder</span>&nbsp;<span class="keyword" id="4008581">struct</span>&nbsp;<span class="op" id="4008588">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4008591">canAddrEnc</span><span class="op" id="4008601">,</span>&nbsp;<span class="ident" id="4008603">elseEnc</span>&nbsp;<span class="ident" id="4008611"><a href="/gostd/encoding/json/encode.go.html#3999409">encoderFunc</a></span><br>
<span class="lineno"></span><span class="op" id="4008623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4008626">func</span>&nbsp;<span class="op" id="4008631">(</span><span class="ident" id="4008632">ce</span>&nbsp;<span class="op" id="4008635">*</span><span class="ident" id="4008636"><a href="/gostd/encoding/json/encode.go.html#4008565">condAddrEncoder</a></span><span class="op" id="4008651">)</span>&nbsp;<span class="ident" id="4008653">encode</span><span class="op" id="4008659">(</span><span class="ident" id="4008660">e</span>&nbsp;<span class="op" id="4008662">*</span><span class="ident" id="4008663"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="4008674">,</span>&nbsp;<span class="ident" id="4008676">v</span>&nbsp;<span class="ident" id="4008678"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4008685">.</span><span class="ident" id="4008686"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="4008691">,</span>&nbsp;<span class="ident" id="4008693">quoted</span>&nbsp;<span class="builtintype" id="4008700">bool</span><span class="op" id="4008704">)</span>&nbsp;<span class="op" id="4008706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4008709">if</span>&nbsp;<span class="ident" id="4008712"><a href="/gostd/encoding/json/encode.go.html#4008676">v</a></span><span class="op" id="4008713">.</span><span class="ident" id="4008714"><a href="/gostd/reflect/value.go.html#2840824">CanAddr</a></span><span class="op" id="4008721">(</span><span class="op" id="4008722">)</span>&nbsp;<span class="op" id="4008724">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4008728"><a href="/gostd/encoding/json/encode.go.html#4008632">ce</a></span><span class="op" id="4008730">.</span><span class="ident" id="4008731"><a href="/gostd/encoding/json/encode.go.html#4008591">canAddrEnc</a></span><span class="op" id="4008741">(</span><span class="ident" id="4008742"><a href="/gostd/encoding/json/encode.go.html#4008660">e</a></span><span class="op" id="4008743">,</span>&nbsp;<span class="ident" id="4008745"><a href="/gostd/encoding/json/encode.go.html#4008676">v</a></span><span class="op" id="4008746">,</span>&nbsp;<span class="ident" id="4008748"><a href="/gostd/encoding/json/encode.go.html#4008693">quoted</a></span><span class="op" id="4008754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4008757">}</span>&nbsp;<span class="keyword" id="4008759">else</span>&nbsp;<span class="op" id="4008764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4008768"><a href="/gostd/encoding/json/encode.go.html#4008632">ce</a></span><span class="op" id="4008770">.</span><span class="ident" id="4008771"><a href="/gostd/encoding/json/encode.go.html#4008603">elseEnc</a></span><span class="op" id="4008778">(</span><span class="ident" id="4008779"><a href="/gostd/encoding/json/encode.go.html#4008660">e</a></span><span class="op" id="4008780">,</span>&nbsp;<span class="ident" id="4008782"><a href="/gostd/encoding/json/encode.go.html#4008676">v</a></span><span class="op" id="4008783">,</span>&nbsp;<span class="ident" id="4008785"><a href="/gostd/encoding/json/encode.go.html#4008693">quoted</a></span><span class="op" id="4008791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4008794">}</span><br>
<span class="lineno"></span><span class="op" id="4008796">}</span><br>
<span class="lineno">725</span><br>
<span class="lineno"></span><span class="comment" id="4008799">//&nbsp;newCondAddrEncoder&nbsp;returns&nbsp;an&nbsp;encoder&nbsp;that&nbsp;checks&nbsp;whether&nbsp;its&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="4008870">//&nbsp;CanAddr&nbsp;and&nbsp;delegates&nbsp;to&nbsp;canAddrEnc&nbsp;if&nbsp;so,&nbsp;else&nbsp;to&nbsp;elseEnc.</span><br>
<span class="lineno"></span><span class="keyword" id="4008933">func</span>&nbsp;<span class="ident" id="4008938">newCondAddrEncoder</span><span class="op" id="4008956">(</span><span class="ident" id="4008957">canAddrEnc</span><span class="op" id="4008967">,</span>&nbsp;<span class="ident" id="4008969">elseEnc</span>&nbsp;<span class="ident" id="4008977"><a href="/gostd/encoding/json/encode.go.html#3999409">encoderFunc</a></span><span class="op" id="4008988">)</span>&nbsp;<span class="ident" id="4008990"><a href="/gostd/encoding/json/encode.go.html#3999409">encoderFunc</a></span>&nbsp;<span class="op" id="4009002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4009005">enc</span>&nbsp;<span class="op" id="4009009">:=</span>&nbsp;<span class="op" id="4009012">&amp;</span><span class="ident" id="4009013"><a href="/gostd/encoding/json/encode.go.html#4008565">condAddrEncoder</a></span><span class="op" id="4009028">{</span><span class="ident" id="4009029"><a href="/gostd/encoding/json/encode.go.html#4008591">canAddrEnc</a></span><span class="op" id="4009039">:</span>&nbsp;<span class="ident" id="4009041"><a href="/gostd/encoding/json/encode.go.html#4008957">canAddrEnc</a></span><span class="op" id="4009051">,</span>&nbsp;<span class="ident" id="4009053"><a href="/gostd/encoding/json/encode.go.html#4008603">elseEnc</a></span><span class="op" id="4009060">:</span>&nbsp;<span class="ident" id="4009062"><a href="/gostd/encoding/json/encode.go.html#4008969">elseEnc</a></span><span class="op" id="4009069">}</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4009072">return</span>&nbsp;<span class="ident" id="4009079"><a href="/gostd/encoding/json/encode.go.html#4009005">enc</a></span><span class="op" id="4009082">.</span><span class="ident" id="4009083"><a href="/gostd/encoding/json/encode.go.html#4008653">encode</a></span><br>
<span class="lineno"></span><span class="op" id="4009090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4009093">func</span>&nbsp;<span class="ident" id="4009098">isValidTag</span><span class="op" id="4009108">(</span><span class="ident" id="4009109">s</span>&nbsp;<span class="builtintype" id="4009111">string</span><span class="op" id="4009117">)</span>&nbsp;<span class="builtintype" id="4009119">bool</span>&nbsp;<span class="op" id="4009124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4009127">if</span>&nbsp;<span class="ident" id="4009130"><a href="/gostd/encoding/json/encode.go.html#4009109">s</a></span>&nbsp;<span class="op" id="4009132">==</span>&nbsp;<span class="string" id="4009135">&#34;&#34;</span>&nbsp;<span class="op" id="4009138">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4009142">return</span>&nbsp;<span class="builtintype" id="4009149">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4009156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4009159">for</span>&nbsp;<span class="ident" id="4009163">_</span><span class="op" id="4009164">,</span>&nbsp;<span class="ident" id="4009166">c</span>&nbsp;<span class="op" id="4009168">:=</span>&nbsp;<span class="keyword" id="4009171">range</span>&nbsp;<span class="ident" id="4009177"><a href="/gostd/encoding/json/encode.go.html#4009109">s</a></span>&nbsp;<span class="op" id="4009179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4009183">switch</span>&nbsp;<span class="op" id="4009190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4009194">case</span>&nbsp;<span class="ident" id="4009199"><a href="/gostd/encoding/json/encode.go.html#3990264">strings</a></span><span class="op" id="4009206">.</span><span class="ident" id="4009207"><a href="/gostd/strings/strings.go.html#2968712">ContainsRune</a></span><span class="op" id="4009219">(</span><span class="string" id="4009220">&#34;!#$%&amp;()*+-./:&lt;=&gt;?@[]^_{|}~&nbsp;&#34;</span><span class="op" id="4009249">,</span>&nbsp;<span class="ident" id="4009251"><a href="/gostd/encoding/json/encode.go.html#4009166">c</a></span><span class="op" id="4009252">)</span><span class="op" id="4009253">:</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4009258">//&nbsp;Backslash&nbsp;and&nbsp;quote&nbsp;chars&nbsp;are&nbsp;reserved,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4009308">//&nbsp;otherwise&nbsp;any&nbsp;punctuation&nbsp;chars&nbsp;are&nbsp;allowed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4009358">//&nbsp;in&nbsp;a&nbsp;tag&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4009378">default</span><span class="op" id="4009385">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4009390">if</span>&nbsp;<span class="op" id="4009393">!</span><span class="ident" id="4009394"><a href="/gostd/encoding/json/encode.go.html#3990283">unicode</a></span><span class="op" id="4009401">.</span><span class="ident" id="4009402"><a href="/gostd/unicode/graphic.go.html#1819623">IsLetter</a></span><span class="op" id="4009410">(</span><span class="ident" id="4009411"><a href="/gostd/encoding/json/encode.go.html#4009166">c</a></span><span class="op" id="4009412">)</span>&nbsp;<span class="op" id="4009414">&amp;&amp;</span>&nbsp;<span class="op" id="4009417">!</span><span class="ident" id="4009418"><a href="/gostd/encoding/json/encode.go.html#3990283">unicode</a></span><span class="op" id="4009425">.</span><span class="ident" id="4009426"><a href="/gostd/unicode/digit.go.html#1816545">IsDigit</a></span><span class="op" id="4009433">(</span><span class="ident" id="4009434"><a href="/gostd/encoding/json/encode.go.html#4009166">c</a></span><span class="op" id="4009435">)</span>&nbsp;<span class="op" id="4009437">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4009443">return</span>&nbsp;<span class="builtintype" id="4009450">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4009459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4009463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4009466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4009469">return</span>&nbsp;<span class="builtintype" id="4009476">true</span><br>
<span class="lineno">750</span><span class="op" id="4009481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4009484">func</span>&nbsp;<span class="ident" id="4009489">fieldByIndex</span><span class="op" id="4009501">(</span><span class="ident" id="4009502">v</span>&nbsp;<span class="ident" id="4009504"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4009511">.</span><span class="ident" id="4009512"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="4009517">,</span>&nbsp;<span class="ident" id="4009519">index</span>&nbsp;<span class="op" id="4009525">[</span><span class="op" id="4009526">]</span><span class="builtintype" id="4009527">int</span><span class="op" id="4009530">)</span>&nbsp;<span class="ident" id="4009532"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4009539">.</span><span class="ident" id="4009540"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span>&nbsp;<span class="op" id="4009546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4009549">for</span>&nbsp;<span class="ident" id="4009553">_</span><span class="op" id="4009554">,</span>&nbsp;<span class="ident" id="4009556">i</span>&nbsp;<span class="op" id="4009558">:=</span>&nbsp;<span class="keyword" id="4009561">range</span>&nbsp;<span class="ident" id="4009567"><a href="/gostd/encoding/json/encode.go.html#4009519">index</a></span>&nbsp;<span class="op" id="4009573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4009577">if</span>&nbsp;<span class="ident" id="4009580"><a href="/gostd/encoding/json/encode.go.html#4009502">v</a></span><span class="op" id="4009581">.</span><span class="ident" id="4009582"><a href="/gostd/reflect/value.go.html#2861487">Kind</a></span><span class="op" id="4009586">(</span><span class="op" id="4009587">)</span>&nbsp;<span class="op" id="4009589">==</span>&nbsp;<span class="ident" id="4009592"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4009599">.</span><span class="ident" id="4009600"><a href="/gostd/reflect/type.go.html#2788057">Ptr</a></span>&nbsp;<span class="op" id="4009604">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4009609">if</span>&nbsp;<span class="ident" id="4009612"><a href="/gostd/encoding/json/encode.go.html#4009502">v</a></span><span class="op" id="4009613">.</span><span class="ident" id="4009614"><a href="/gostd/reflect/value.go.html#2860565">IsNil</a></span><span class="op" id="4009619">(</span><span class="op" id="4009620">)</span>&nbsp;<span class="op" id="4009622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4009628">return</span>&nbsp;<span class="ident" id="4009635"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4009642">.</span><span class="ident" id="4009643"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="4009648">{</span><span class="op" id="4009649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4009654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4009659"><a href="/gostd/encoding/json/encode.go.html#4009502">v</a></span>&nbsp;<span class="op" id="4009661">=</span>&nbsp;<span class="ident" id="4009663"><a href="/gostd/encoding/json/encode.go.html#4009502">v</a></span><span class="op" id="4009664">.</span><span class="ident" id="4009665"><a href="/gostd/reflect/value.go.html#2853087">Elem</a></span><span class="op" id="4009669">(</span><span class="op" id="4009670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4009674">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4009678"><a href="/gostd/encoding/json/encode.go.html#4009502">v</a></span>&nbsp;<span class="op" id="4009680">=</span>&nbsp;<span class="ident" id="4009682"><a href="/gostd/encoding/json/encode.go.html#4009502">v</a></span><span class="op" id="4009683">.</span><span class="ident" id="4009684"><a href="/gostd/reflect/value.go.html#2853921">Field</a></span><span class="op" id="4009689">(</span><span class="ident" id="4009690"><a href="/gostd/encoding/json/encode.go.html#4009556">i</a></span><span class="op" id="4009691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4009694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4009697">return</span>&nbsp;<span class="ident" id="4009704"><a href="/gostd/encoding/json/encode.go.html#4009502">v</a></span><br>
<span class="lineno"></span><span class="op" id="4009706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span><span class="keyword" id="4009709">func</span>&nbsp;<span class="ident" id="4009714">typeByIndex</span><span class="op" id="4009725">(</span><span class="ident" id="4009726">t</span>&nbsp;<span class="ident" id="4009728"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4009735">.</span><span class="ident" id="4009736"><a href="/gostd/reflect/type.go.html#2781467">Type</a></span><span class="op" id="4009740">,</span>&nbsp;<span class="ident" id="4009742">index</span>&nbsp;<span class="op" id="4009748">[</span><span class="op" id="4009749">]</span><span class="builtintype" id="4009750">int</span><span class="op" id="4009753">)</span>&nbsp;<span class="ident" id="4009755"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4009762">.</span><span class="ident" id="4009763"><a href="/gostd/reflect/type.go.html#2781467">Type</a></span>&nbsp;<span class="op" id="4009768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4009771">for</span>&nbsp;<span class="ident" id="4009775">_</span><span class="op" id="4009776">,</span>&nbsp;<span class="ident" id="4009778">i</span>&nbsp;<span class="op" id="4009780">:=</span>&nbsp;<span class="keyword" id="4009783">range</span>&nbsp;<span class="ident" id="4009789"><a href="/gostd/encoding/json/encode.go.html#4009742">index</a></span>&nbsp;<span class="op" id="4009795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4009799">if</span>&nbsp;<span class="ident" id="4009802"><a href="/gostd/encoding/json/encode.go.html#4009726">t</a></span><span class="op" id="4009803">.</span><span class="ident" id="4009804"><a href="/gostd/reflect/type.go.html#2783619">Kind</a></span><span class="op" id="4009808">(</span><span class="op" id="4009809">)</span>&nbsp;<span class="op" id="4009811">==</span>&nbsp;<span class="ident" id="4009814"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4009821">.</span><span class="ident" id="4009822"><a href="/gostd/reflect/type.go.html#2788057">Ptr</a></span>&nbsp;<span class="op" id="4009826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4009831"><a href="/gostd/encoding/json/encode.go.html#4009726">t</a></span>&nbsp;<span class="op" id="4009833">=</span>&nbsp;<span class="ident" id="4009835"><a href="/gostd/encoding/json/encode.go.html#4009726">t</a></span><span class="op" id="4009836">.</span><span class="ident" id="4009837"><a href="/gostd/reflect/type.go.html#2785263">Elem</a></span><span class="op" id="4009841">(</span><span class="op" id="4009842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4009846">}</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4009850"><a href="/gostd/encoding/json/encode.go.html#4009726">t</a></span>&nbsp;<span class="op" id="4009852">=</span>&nbsp;<span class="ident" id="4009854"><a href="/gostd/encoding/json/encode.go.html#4009726">t</a></span><span class="op" id="4009855">.</span><span class="ident" id="4009856"><a href="/gostd/reflect/type.go.html#2785427">Field</a></span><span class="op" id="4009861">(</span><span class="ident" id="4009862"><a href="/gostd/encoding/json/encode.go.html#4009778">i</a></span><span class="op" id="4009863">)</span><span class="op" id="4009864">.</span><span class="ident" id="4009865"><a href="/gostd/reflect/type.go.html#2801034">Type</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4009871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4009874">return</span>&nbsp;<span class="ident" id="4009881"><a href="/gostd/encoding/json/encode.go.html#4009726">t</a></span><br>
<span class="lineno"></span><span class="op" id="4009883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">775</span><span class="comment" id="4009886">//&nbsp;stringValues&nbsp;is&nbsp;a&nbsp;slice&nbsp;of&nbsp;reflect.Value&nbsp;holding&nbsp;*reflect.StringValue.</span><br>
<span class="lineno"></span><span class="comment" id="4009960">//&nbsp;It&nbsp;implements&nbsp;the&nbsp;methods&nbsp;to&nbsp;sort&nbsp;by&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4010008">type</span>&nbsp;<span class="ident" id="4010013">stringValues</span>&nbsp;<span class="op" id="4010026">[</span><span class="op" id="4010027">]</span><span class="ident" id="4010028"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4010035">.</span><span class="ident" id="4010036"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4010043">func</span>&nbsp;<span class="op" id="4010048">(</span><span class="ident" id="4010049">sv</span>&nbsp;<span class="ident" id="4010052"><a href="/gostd/encoding/json/encode.go.html#4010013">stringValues</a></span><span class="op" id="4010064">)</span>&nbsp;<span class="ident" id="4010066">Len</span><span class="op" id="4010069">(</span><span class="op" id="4010070">)</span>&nbsp;<span class="builtintype" id="4010072">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4010086">{</span>&nbsp;<span class="keyword" id="4010088">return</span>&nbsp;<span class="builtinfunc" id="4010095">len</span><span class="op" id="4010098">(</span><span class="ident" id="4010099"><a href="/gostd/encoding/json/encode.go.html#4010049">sv</a></span><span class="op" id="4010101">)</span>&nbsp;<span class="op" id="4010103">}</span><br>
<span class="lineno">780</span><span class="keyword" id="4010105">func</span>&nbsp;<span class="op" id="4010110">(</span><span class="ident" id="4010111">sv</span>&nbsp;<span class="ident" id="4010114"><a href="/gostd/encoding/json/encode.go.html#4010013">stringValues</a></span><span class="op" id="4010126">)</span>&nbsp;<span class="ident" id="4010128">Swap</span><span class="op" id="4010132">(</span><span class="ident" id="4010133">i</span><span class="op" id="4010134">,</span>&nbsp;<span class="ident" id="4010136">j</span>&nbsp;<span class="builtintype" id="4010138">int</span><span class="op" id="4010141">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4010148">{</span>&nbsp;<span class="ident" id="4010150"><a href="/gostd/encoding/json/encode.go.html#4010111">sv</a></span><span class="op" id="4010152">[</span><span class="ident" id="4010153"><a href="/gostd/encoding/json/encode.go.html#4010133">i</a></span><span class="op" id="4010154">]</span><span class="op" id="4010155">,</span>&nbsp;<span class="ident" id="4010157"><a href="/gostd/encoding/json/encode.go.html#4010111">sv</a></span><span class="op" id="4010159">[</span><span class="ident" id="4010160"><a href="/gostd/encoding/json/encode.go.html#4010136">j</a></span><span class="op" id="4010161">]</span>&nbsp;<span class="op" id="4010163">=</span>&nbsp;<span class="ident" id="4010165"><a href="/gostd/encoding/json/encode.go.html#4010111">sv</a></span><span class="op" id="4010167">[</span><span class="ident" id="4010168"><a href="/gostd/encoding/json/encode.go.html#4010136">j</a></span><span class="op" id="4010169">]</span><span class="op" id="4010170">,</span>&nbsp;<span class="ident" id="4010172"><a href="/gostd/encoding/json/encode.go.html#4010111">sv</a></span><span class="op" id="4010174">[</span><span class="ident" id="4010175"><a href="/gostd/encoding/json/encode.go.html#4010133">i</a></span><span class="op" id="4010176">]</span>&nbsp;<span class="op" id="4010178">}</span><br>
<span class="lineno"></span><span class="keyword" id="4010180">func</span>&nbsp;<span class="op" id="4010185">(</span><span class="ident" id="4010186">sv</span>&nbsp;<span class="ident" id="4010189"><a href="/gostd/encoding/json/encode.go.html#4010013">stringValues</a></span><span class="op" id="4010201">)</span>&nbsp;<span class="ident" id="4010203">Less</span><span class="op" id="4010207">(</span><span class="ident" id="4010208">i</span><span class="op" id="4010209">,</span>&nbsp;<span class="ident" id="4010211">j</span>&nbsp;<span class="builtintype" id="4010213">int</span><span class="op" id="4010216">)</span>&nbsp;<span class="builtintype" id="4010218">bool</span>&nbsp;<span class="op" id="4010223">{</span>&nbsp;<span class="keyword" id="4010225">return</span>&nbsp;<span class="ident" id="4010232"><a href="/gostd/encoding/json/encode.go.html#4010186">sv</a></span><span class="op" id="4010234">.</span><span class="ident" id="4010235"><a href="/gostd/encoding/json/encode.go.html#4010279">get</a></span><span class="op" id="4010238">(</span><span class="ident" id="4010239"><a href="/gostd/encoding/json/encode.go.html#4010208">i</a></span><span class="op" id="4010240">)</span>&nbsp;<span class="op" id="4010242">&lt;</span>&nbsp;<span class="ident" id="4010244"><a href="/gostd/encoding/json/encode.go.html#4010186">sv</a></span><span class="op" id="4010246">.</span><span class="ident" id="4010247"><a href="/gostd/encoding/json/encode.go.html#4010279">get</a></span><span class="op" id="4010250">(</span><span class="ident" id="4010251"><a href="/gostd/encoding/json/encode.go.html#4010211">j</a></span><span class="op" id="4010252">)</span>&nbsp;<span class="op" id="4010254">}</span><br>
<span class="lineno"></span><span class="keyword" id="4010256">func</span>&nbsp;<span class="op" id="4010261">(</span><span class="ident" id="4010262">sv</span>&nbsp;<span class="ident" id="4010265"><a href="/gostd/encoding/json/encode.go.html#4010013">stringValues</a></span><span class="op" id="4010277">)</span>&nbsp;<span class="ident" id="4010279">get</span><span class="op" id="4010282">(</span><span class="ident" id="4010283">i</span>&nbsp;<span class="builtintype" id="4010285">int</span><span class="op" id="4010288">)</span>&nbsp;<span class="builtintype" id="4010290">string</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4010299">{</span>&nbsp;<span class="keyword" id="4010301">return</span>&nbsp;<span class="ident" id="4010308"><a href="/gostd/encoding/json/encode.go.html#4010262">sv</a></span><span class="op" id="4010310">[</span><span class="ident" id="4010311"><a href="/gostd/encoding/json/encode.go.html#4010283">i</a></span><span class="op" id="4010312">]</span><span class="op" id="4010313">.</span><span class="ident" id="4010314"><a href="/gostd/reflect/value.go.html#2879739">String</a></span><span class="op" id="4010320">(</span><span class="op" id="4010321">)</span>&nbsp;<span class="op" id="4010323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4010326">//&nbsp;NOTE:&nbsp;keep&nbsp;in&nbsp;sync&nbsp;with&nbsp;stringBytes&nbsp;below.</span><br>
<span class="lineno">785</span><span class="keyword" id="4010372">func</span>&nbsp;<span class="op" id="4010377">(</span><span class="ident" id="4010378">e</span>&nbsp;<span class="op" id="4010380">*</span><span class="ident" id="4010381"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="4010392">)</span>&nbsp;<span class="builtintype" id="4010394">string</span><span class="op" id="4010400">(</span><span class="ident" id="4010401">s</span>&nbsp;<span class="builtintype" id="4010403">string</span><span class="op" id="4010409">)</span>&nbsp;<span class="op" id="4010411">(</span><span class="builtintype" id="4010412">int</span><span class="op" id="4010415">,</span>&nbsp;<span class="builtintype" id="4010417">error</span><span class="op" id="4010422">)</span>&nbsp;<span class="op" id="4010424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4010427">len0</span>&nbsp;<span class="op" id="4010432">:=</span>&nbsp;<span class="ident" id="4010435"><a href="/gostd/encoding/json/encode.go.html#4010378">e</a></span><span class="op" id="4010436">.</span><span class="ident" id="4010437"><a href="/gostd/bytes/buffer.go.html#1384893">Len</a></span><span class="op" id="4010440">(</span><span class="op" id="4010441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4010444"><a href="/gostd/encoding/json/encode.go.html#4010378">e</a></span><span class="op" id="4010445">.</span><span class="ident" id="4010446"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4010455">(</span><span class="string" id="4010456">&#39;&#34;&#39;</span><span class="op" id="4010459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4010462">start</span>&nbsp;<span class="op" id="4010468">:=</span>&nbsp;<span class="num" id="4010471">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4010474">for</span>&nbsp;<span class="ident" id="4010478">i</span>&nbsp;<span class="op" id="4010480">:=</span>&nbsp;<span class="num" id="4010483">0</span><span class="op" id="4010484">;</span>&nbsp;<span class="ident" id="4010486"><a href="/gostd/encoding/json/encode.go.html#4010478">i</a></span>&nbsp;<span class="op" id="4010488">&lt;</span>&nbsp;<span class="builtinfunc" id="4010490">len</span><span class="op" id="4010493">(</span><span class="ident" id="4010494"><a href="/gostd/encoding/json/encode.go.html#4010401">s</a></span><span class="op" id="4010495">)</span><span class="op" id="4010496">;</span>&nbsp;<span class="op" id="4010498">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4010502">if</span>&nbsp;<span class="ident" id="4010505">b</span>&nbsp;<span class="op" id="4010507">:=</span>&nbsp;<span class="ident" id="4010510"><a href="/gostd/encoding/json/encode.go.html#4010401">s</a></span><span class="op" id="4010511">[</span><span class="ident" id="4010512"><a href="/gostd/encoding/json/encode.go.html#4010478">i</a></span><span class="op" id="4010513">]</span><span class="op" id="4010514">;</span>&nbsp;<span class="ident" id="4010516"><a href="/gostd/encoding/json/encode.go.html#4010505">b</a></span>&nbsp;<span class="op" id="4010518">&lt;</span>&nbsp;<span class="ident" id="4010520"><a href="/gostd/encoding/json/encode.go.html#3990294">utf8</a></span><span class="op" id="4010524">.</span><span class="ident" id="4010525"><a href="/gostd/unicode/utf8/utf8.go.html#1805451">RuneSelf</a></span>&nbsp;<span class="op" id="4010534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4010539">if</span>&nbsp;<span class="num" id="4010542">0x20</span>&nbsp;<span class="op" id="4010547">&lt;=</span>&nbsp;<span class="ident" id="4010550"><a href="/gostd/encoding/json/encode.go.html#4010505">b</a></span>&nbsp;<span class="op" id="4010552">&amp;&amp;</span>&nbsp;<span class="ident" id="4010555"><a href="/gostd/encoding/json/encode.go.html#4010505">b</a></span>&nbsp;<span class="op" id="4010557">!=</span>&nbsp;<span class="string" id="4010560">&#39;\\&#39;</span>&nbsp;<span class="op" id="4010565">&amp;&amp;</span>&nbsp;<span class="ident" id="4010568"><a href="/gostd/encoding/json/encode.go.html#4010505">b</a></span>&nbsp;<span class="op" id="4010570">!=</span>&nbsp;<span class="string" id="4010573">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4010577">&amp;&amp;</span>&nbsp;<span class="ident" id="4010580"><a href="/gostd/encoding/json/encode.go.html#4010505">b</a></span>&nbsp;<span class="op" id="4010582">!=</span>&nbsp;<span class="string" id="4010585">&#39;&lt;&#39;</span>&nbsp;<span class="op" id="4010589">&amp;&amp;</span>&nbsp;<span class="ident" id="4010592"><a href="/gostd/encoding/json/encode.go.html#4010505">b</a></span>&nbsp;<span class="op" id="4010594">!=</span>&nbsp;<span class="string" id="4010597">&#39;&gt;&#39;</span>&nbsp;<span class="op" id="4010601">&amp;&amp;</span>&nbsp;<span class="ident" id="4010604"><a href="/gostd/encoding/json/encode.go.html#4010505">b</a></span>&nbsp;<span class="op" id="4010606">!=</span>&nbsp;<span class="string" id="4010609">&#39;&amp;&#39;</span>&nbsp;<span class="op" id="4010613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4010619"><a href="/gostd/encoding/json/encode.go.html#4010478">i</a></span><span class="op" id="4010620">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4010627">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4010639">}</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4010644">if</span>&nbsp;<span class="ident" id="4010647"><a href="/gostd/encoding/json/encode.go.html#4010462">start</a></span>&nbsp;<span class="op" id="4010653">&lt;</span>&nbsp;<span class="ident" id="4010655"><a href="/gostd/encoding/json/encode.go.html#4010478">i</a></span>&nbsp;<span class="op" id="4010657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4010663"><a href="/gostd/encoding/json/encode.go.html#4010378">e</a></span><span class="op" id="4010664">.</span><span class="ident" id="4010665"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4010676">(</span><span class="ident" id="4010677"><a href="/gostd/encoding/json/encode.go.html#4010401">s</a></span><span class="op" id="4010678">[</span><span class="ident" id="4010679"><a href="/gostd/encoding/json/encode.go.html#4010462">start</a></span><span class="op" id="4010684">:</span><span class="ident" id="4010685"><a href="/gostd/encoding/json/encode.go.html#4010478">i</a></span><span class="op" id="4010686">]</span><span class="op" id="4010687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4010692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4010697">switch</span>&nbsp;<span class="ident" id="4010704"><a href="/gostd/encoding/json/encode.go.html#4010505">b</a></span>&nbsp;<span class="op" id="4010706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4010711">case</span>&nbsp;<span class="string" id="4010716">&#39;\\&#39;</span><span class="op" id="4010720">,</span>&nbsp;<span class="string" id="4010722">&#39;&#34;&#39;</span><span class="op" id="4010725">:</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4010731"><a href="/gostd/encoding/json/encode.go.html#4010378">e</a></span><span class="op" id="4010732">.</span><span class="ident" id="4010733"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4010742">(</span><span class="string" id="4010743">&#39;\\&#39;</span><span class="op" id="4010747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4010753"><a href="/gostd/encoding/json/encode.go.html#4010378">e</a></span><span class="op" id="4010754">.</span><span class="ident" id="4010755"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4010764">(</span><span class="ident" id="4010765"><a href="/gostd/encoding/json/encode.go.html#4010505">b</a></span><span class="op" id="4010766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4010771">case</span>&nbsp;<span class="string" id="4010776">&#39;\n&#39;</span><span class="op" id="4010780">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4010786"><a href="/gostd/encoding/json/encode.go.html#4010378">e</a></span><span class="op" id="4010787">.</span><span class="ident" id="4010788"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4010797">(</span><span class="string" id="4010798">&#39;\\&#39;</span><span class="op" id="4010802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4010808"><a href="/gostd/encoding/json/encode.go.html#4010378">e</a></span><span class="op" id="4010809">.</span><span class="ident" id="4010810"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4010819">(</span><span class="string" id="4010820">&#39;n&#39;</span><span class="op" id="4010823">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4010828">case</span>&nbsp;<span class="string" id="4010833">&#39;\r&#39;</span><span class="op" id="4010837">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4010843"><a href="/gostd/encoding/json/encode.go.html#4010378">e</a></span><span class="op" id="4010844">.</span><span class="ident" id="4010845"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4010854">(</span><span class="string" id="4010855">&#39;\\&#39;</span><span class="op" id="4010859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4010865"><a href="/gostd/encoding/json/encode.go.html#4010378">e</a></span><span class="op" id="4010866">.</span><span class="ident" id="4010867"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4010876">(</span><span class="string" id="4010877">&#39;r&#39;</span><span class="op" id="4010880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4010885">case</span>&nbsp;<span class="string" id="4010890">&#39;\t&#39;</span><span class="op" id="4010894">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4010900"><a href="/gostd/encoding/json/encode.go.html#4010378">e</a></span><span class="op" id="4010901">.</span><span class="ident" id="4010902"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4010911">(</span><span class="string" id="4010912">&#39;\\&#39;</span><span class="op" id="4010916">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4010922"><a href="/gostd/encoding/json/encode.go.html#4010378">e</a></span><span class="op" id="4010923">.</span><span class="ident" id="4010924"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4010933">(</span><span class="string" id="4010934">&#39;t&#39;</span><span class="op" id="4010937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4010942">default</span><span class="op" id="4010949">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4010955">//&nbsp;This&nbsp;encodes&nbsp;bytes&nbsp;&lt;&nbsp;0x20&nbsp;except&nbsp;for&nbsp;\n&nbsp;and&nbsp;\r,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4011010">//&nbsp;as&nbsp;well&nbsp;as&nbsp;&lt;,&nbsp;&gt;&nbsp;and&nbsp;&amp;.&nbsp;The&nbsp;latter&nbsp;are&nbsp;escaped&nbsp;because&nbsp;they</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4011076">//&nbsp;can&nbsp;lead&nbsp;to&nbsp;security&nbsp;holes&nbsp;when&nbsp;user-controlled&nbsp;strings</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4011139">//&nbsp;are&nbsp;rendered&nbsp;into&nbsp;JSON&nbsp;and&nbsp;served&nbsp;to&nbsp;some&nbsp;browsers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4011198"><a href="/gostd/encoding/json/encode.go.html#4010378">e</a></span><span class="op" id="4011199">.</span><span class="ident" id="4011200"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4011211">(</span><span class="string" id="4011212">`\u00`</span><span class="op" id="4011218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4011224"><a href="/gostd/encoding/json/encode.go.html#4010378">e</a></span><span class="op" id="4011225">.</span><span class="ident" id="4011226"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4011235">(</span><span class="ident" id="4011236"><a href="/gostd/encoding/json/encode.go.html#3998013">hex</a></span><span class="op" id="4011239">[</span><span class="ident" id="4011240"><a href="/gostd/encoding/json/encode.go.html#4010505">b</a></span><span class="op" id="4011241">&gt;&gt;</span><span class="num" id="4011243">4</span><span class="op" id="4011244">]</span><span class="op" id="4011245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4011251"><a href="/gostd/encoding/json/encode.go.html#4010378">e</a></span><span class="op" id="4011252">.</span><span class="ident" id="4011253"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4011262">(</span><span class="ident" id="4011263"><a href="/gostd/encoding/json/encode.go.html#3998013">hex</a></span><span class="op" id="4011266">[</span><span class="ident" id="4011267"><a href="/gostd/encoding/json/encode.go.html#4010505">b</a></span><span class="op" id="4011268">&amp;</span><span class="num" id="4011269">0xF</span><span class="op" id="4011272">]</span><span class="op" id="4011273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4011278">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4011283"><a href="/gostd/encoding/json/encode.go.html#4010478">i</a></span><span class="op" id="4011284">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4011290"><a href="/gostd/encoding/json/encode.go.html#4010462">start</a></span>&nbsp;<span class="op" id="4011296">=</span>&nbsp;<span class="ident" id="4011298"><a href="/gostd/encoding/json/encode.go.html#4010478">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4011303">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4011314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4011318">c</span><span class="op" id="4011319">,</span>&nbsp;<span class="ident" id="4011321">size</span>&nbsp;<span class="op" id="4011326">:=</span>&nbsp;<span class="ident" id="4011329"><a href="/gostd/encoding/json/encode.go.html#3990294">utf8</a></span><span class="op" id="4011333">.</span><span class="ident" id="4011334"><a href="/gostd/unicode/utf8/utf8.go.html#1810428">DecodeRuneInString</a></span><span class="op" id="4011352">(</span><span class="ident" id="4011353"><a href="/gostd/encoding/json/encode.go.html#4010401">s</a></span><span class="op" id="4011354">[</span><span class="ident" id="4011355"><a href="/gostd/encoding/json/encode.go.html#4010478">i</a></span><span class="op" id="4011356">:</span><span class="op" id="4011357">]</span><span class="op" id="4011358">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4011362">if</span>&nbsp;<span class="ident" id="4011365"><a href="/gostd/encoding/json/encode.go.html#4011318">c</a></span>&nbsp;<span class="op" id="4011367">==</span>&nbsp;<span class="ident" id="4011370"><a href="/gostd/encoding/json/encode.go.html#3990294">utf8</a></span><span class="op" id="4011374">.</span><span class="ident" id="4011375"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span>&nbsp;<span class="op" id="4011385">&amp;&amp;</span>&nbsp;<span class="ident" id="4011388"><a href="/gostd/encoding/json/encode.go.html#4011321">size</a></span>&nbsp;<span class="op" id="4011393">==</span>&nbsp;<span class="num" id="4011396">1</span>&nbsp;<span class="op" id="4011398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4011403">if</span>&nbsp;<span class="ident" id="4011406"><a href="/gostd/encoding/json/encode.go.html#4010462">start</a></span>&nbsp;<span class="op" id="4011412">&lt;</span>&nbsp;<span class="ident" id="4011414"><a href="/gostd/encoding/json/encode.go.html#4010478">i</a></span>&nbsp;<span class="op" id="4011416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4011422"><a href="/gostd/encoding/json/encode.go.html#4010378">e</a></span><span class="op" id="4011423">.</span><span class="ident" id="4011424"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4011435">(</span><span class="ident" id="4011436"><a href="/gostd/encoding/json/encode.go.html#4010401">s</a></span><span class="op" id="4011437">[</span><span class="ident" id="4011438"><a href="/gostd/encoding/json/encode.go.html#4010462">start</a></span><span class="op" id="4011443">:</span><span class="ident" id="4011444"><a href="/gostd/encoding/json/encode.go.html#4010478">i</a></span><span class="op" id="4011445">]</span><span class="op" id="4011446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4011451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4011456"><a href="/gostd/encoding/json/encode.go.html#4010378">e</a></span><span class="op" id="4011457">.</span><span class="ident" id="4011458"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4011469">(</span><span class="string" id="4011470">`\ufffd`</span><span class="op" id="4011478">)</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4011483"><a href="/gostd/encoding/json/encode.go.html#4010478">i</a></span>&nbsp;<span class="op" id="4011485">+=</span>&nbsp;<span class="ident" id="4011488"><a href="/gostd/encoding/json/encode.go.html#4011321">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4011496"><a href="/gostd/encoding/json/encode.go.html#4010462">start</a></span>&nbsp;<span class="op" id="4011502">=</span>&nbsp;<span class="ident" id="4011504"><a href="/gostd/encoding/json/encode.go.html#4010478">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4011509">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4011520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4011524">//&nbsp;U+2028&nbsp;is&nbsp;LINE&nbsp;SEPARATOR.</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4011555">//&nbsp;U+2029&nbsp;is&nbsp;PARAGRAPH&nbsp;SEPARATOR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4011591">//&nbsp;They&nbsp;are&nbsp;both&nbsp;technically&nbsp;valid&nbsp;characters&nbsp;in&nbsp;JSON&nbsp;strings,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4011656">//&nbsp;but&nbsp;don&#39;t&nbsp;work&nbsp;in&nbsp;JSONP,&nbsp;which&nbsp;has&nbsp;to&nbsp;be&nbsp;evaluated&nbsp;as&nbsp;JavaScript,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4011727">//&nbsp;and&nbsp;can&nbsp;lead&nbsp;to&nbsp;security&nbsp;holes&nbsp;there.&nbsp;It&nbsp;is&nbsp;valid&nbsp;JSON&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4011790">//&nbsp;escape&nbsp;them,&nbsp;so&nbsp;we&nbsp;do&nbsp;so&nbsp;unconditionally.</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4011837">//&nbsp;See&nbsp;http://timelessrepo.com/json-isnt-a-javascript-subset&nbsp;for&nbsp;discussion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4011916">if</span>&nbsp;<span class="ident" id="4011919"><a href="/gostd/encoding/json/encode.go.html#4011318">c</a></span>&nbsp;<span class="op" id="4011921">==</span>&nbsp;<span class="string" id="4011924">&#39;\u2028&#39;</span>&nbsp;<span class="op" id="4011933">||</span>&nbsp;<span class="ident" id="4011936"><a href="/gostd/encoding/json/encode.go.html#4011318">c</a></span>&nbsp;<span class="op" id="4011938">==</span>&nbsp;<span class="string" id="4011941">&#39;\u2029&#39;</span>&nbsp;<span class="op" id="4011950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4011955">if</span>&nbsp;<span class="ident" id="4011958"><a href="/gostd/encoding/json/encode.go.html#4010462">start</a></span>&nbsp;<span class="op" id="4011964">&lt;</span>&nbsp;<span class="ident" id="4011966"><a href="/gostd/encoding/json/encode.go.html#4010478">i</a></span>&nbsp;<span class="op" id="4011968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4011974"><a href="/gostd/encoding/json/encode.go.html#4010378">e</a></span><span class="op" id="4011975">.</span><span class="ident" id="4011976"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4011987">(</span><span class="ident" id="4011988"><a href="/gostd/encoding/json/encode.go.html#4010401">s</a></span><span class="op" id="4011989">[</span><span class="ident" id="4011990"><a href="/gostd/encoding/json/encode.go.html#4010462">start</a></span><span class="op" id="4011995">:</span><span class="ident" id="4011996"><a href="/gostd/encoding/json/encode.go.html#4010478">i</a></span><span class="op" id="4011997">]</span><span class="op" id="4011998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4012003">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012008"><a href="/gostd/encoding/json/encode.go.html#4010378">e</a></span><span class="op" id="4012009">.</span><span class="ident" id="4012010"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4012021">(</span><span class="string" id="4012022">`\u202`</span><span class="op" id="4012029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012034"><a href="/gostd/encoding/json/encode.go.html#4010378">e</a></span><span class="op" id="4012035">.</span><span class="ident" id="4012036"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4012045">(</span><span class="ident" id="4012046"><a href="/gostd/encoding/json/encode.go.html#3998013">hex</a></span><span class="op" id="4012049">[</span><span class="ident" id="4012050"><a href="/gostd/encoding/json/encode.go.html#4011318">c</a></span><span class="op" id="4012051">&amp;</span><span class="num" id="4012052">0xF</span><span class="op" id="4012055">]</span><span class="op" id="4012056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012061"><a href="/gostd/encoding/json/encode.go.html#4010478">i</a></span>&nbsp;<span class="op" id="4012063">+=</span>&nbsp;<span class="ident" id="4012066"><a href="/gostd/encoding/json/encode.go.html#4011321">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012074"><a href="/gostd/encoding/json/encode.go.html#4010462">start</a></span>&nbsp;<span class="op" id="4012080">=</span>&nbsp;<span class="ident" id="4012082"><a href="/gostd/encoding/json/encode.go.html#4010478">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4012087">continue</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4012098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012102"><a href="/gostd/encoding/json/encode.go.html#4010478">i</a></span>&nbsp;<span class="op" id="4012104">+=</span>&nbsp;<span class="ident" id="4012107"><a href="/gostd/encoding/json/encode.go.html#4011321">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4012113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4012116">if</span>&nbsp;<span class="ident" id="4012119"><a href="/gostd/encoding/json/encode.go.html#4010462">start</a></span>&nbsp;<span class="op" id="4012125">&lt;</span>&nbsp;<span class="builtinfunc" id="4012127">len</span><span class="op" id="4012130">(</span><span class="ident" id="4012131"><a href="/gostd/encoding/json/encode.go.html#4010401">s</a></span><span class="op" id="4012132">)</span>&nbsp;<span class="op" id="4012134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012138"><a href="/gostd/encoding/json/encode.go.html#4010378">e</a></span><span class="op" id="4012139">.</span><span class="ident" id="4012140"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4012151">(</span><span class="ident" id="4012152"><a href="/gostd/encoding/json/encode.go.html#4010401">s</a></span><span class="op" id="4012153">[</span><span class="ident" id="4012154"><a href="/gostd/encoding/json/encode.go.html#4010462">start</a></span><span class="op" id="4012159">:</span><span class="op" id="4012160">]</span><span class="op" id="4012161">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4012164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012167"><a href="/gostd/encoding/json/encode.go.html#4010378">e</a></span><span class="op" id="4012168">.</span><span class="ident" id="4012169"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4012178">(</span><span class="string" id="4012179">&#39;&#34;&#39;</span><span class="op" id="4012182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4012185">return</span>&nbsp;<span class="ident" id="4012192"><a href="/gostd/encoding/json/encode.go.html#4010378">e</a></span><span class="op" id="4012193">.</span><span class="ident" id="4012194"><a href="/gostd/bytes/buffer.go.html#1384893">Len</a></span><span class="op" id="4012197">(</span><span class="op" id="4012198">)</span>&nbsp;<span class="op" id="4012200">-</span>&nbsp;<span class="ident" id="4012202"><a href="/gostd/encoding/json/encode.go.html#4010427">len0</a></span><span class="op" id="4012206">,</span>&nbsp;<span class="builtintype" id="4012208">nil</span><br>
<span class="lineno"></span><span class="op" id="4012212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="comment" id="4012215">//&nbsp;NOTE:&nbsp;keep&nbsp;in&nbsp;sync&nbsp;with&nbsp;string&nbsp;above.</span><br>
<span class="lineno"></span><span class="keyword" id="4012256">func</span>&nbsp;<span class="op" id="4012261">(</span><span class="ident" id="4012262">e</span>&nbsp;<span class="op" id="4012264">*</span><span class="ident" id="4012265"><a href="/gostd/encoding/json/encode.go.html#3998096">encodeState</a></span><span class="op" id="4012276">)</span>&nbsp;<span class="ident" id="4012278">stringBytes</span><span class="op" id="4012289">(</span><span class="ident" id="4012290">s</span>&nbsp;<span class="op" id="4012292">[</span><span class="op" id="4012293">]</span><span class="builtintype" id="4012294">byte</span><span class="op" id="4012298">)</span>&nbsp;<span class="op" id="4012300">(</span><span class="builtintype" id="4012301">int</span><span class="op" id="4012304">,</span>&nbsp;<span class="builtintype" id="4012306">error</span><span class="op" id="4012311">)</span>&nbsp;<span class="op" id="4012313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012316">len0</span>&nbsp;<span class="op" id="4012321">:=</span>&nbsp;<span class="ident" id="4012324"><a href="/gostd/encoding/json/encode.go.html#4012262">e</a></span><span class="op" id="4012325">.</span><span class="ident" id="4012326"><a href="/gostd/bytes/buffer.go.html#1384893">Len</a></span><span class="op" id="4012329">(</span><span class="op" id="4012330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012333"><a href="/gostd/encoding/json/encode.go.html#4012262">e</a></span><span class="op" id="4012334">.</span><span class="ident" id="4012335"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4012344">(</span><span class="string" id="4012345">&#39;&#34;&#39;</span><span class="op" id="4012348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012351">start</span>&nbsp;<span class="op" id="4012357">:=</span>&nbsp;<span class="num" id="4012360">0</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4012363">for</span>&nbsp;<span class="ident" id="4012367">i</span>&nbsp;<span class="op" id="4012369">:=</span>&nbsp;<span class="num" id="4012372">0</span><span class="op" id="4012373">;</span>&nbsp;<span class="ident" id="4012375"><a href="/gostd/encoding/json/encode.go.html#4012367">i</a></span>&nbsp;<span class="op" id="4012377">&lt;</span>&nbsp;<span class="builtinfunc" id="4012379">len</span><span class="op" id="4012382">(</span><span class="ident" id="4012383"><a href="/gostd/encoding/json/encode.go.html#4012290">s</a></span><span class="op" id="4012384">)</span><span class="op" id="4012385">;</span>&nbsp;<span class="op" id="4012387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4012391">if</span>&nbsp;<span class="ident" id="4012394">b</span>&nbsp;<span class="op" id="4012396">:=</span>&nbsp;<span class="ident" id="4012399"><a href="/gostd/encoding/json/encode.go.html#4012290">s</a></span><span class="op" id="4012400">[</span><span class="ident" id="4012401"><a href="/gostd/encoding/json/encode.go.html#4012367">i</a></span><span class="op" id="4012402">]</span><span class="op" id="4012403">;</span>&nbsp;<span class="ident" id="4012405"><a href="/gostd/encoding/json/encode.go.html#4012394">b</a></span>&nbsp;<span class="op" id="4012407">&lt;</span>&nbsp;<span class="ident" id="4012409"><a href="/gostd/encoding/json/encode.go.html#3990294">utf8</a></span><span class="op" id="4012413">.</span><span class="ident" id="4012414"><a href="/gostd/unicode/utf8/utf8.go.html#1805451">RuneSelf</a></span>&nbsp;<span class="op" id="4012423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4012428">if</span>&nbsp;<span class="num" id="4012431">0x20</span>&nbsp;<span class="op" id="4012436">&lt;=</span>&nbsp;<span class="ident" id="4012439"><a href="/gostd/encoding/json/encode.go.html#4012394">b</a></span>&nbsp;<span class="op" id="4012441">&amp;&amp;</span>&nbsp;<span class="ident" id="4012444"><a href="/gostd/encoding/json/encode.go.html#4012394">b</a></span>&nbsp;<span class="op" id="4012446">!=</span>&nbsp;<span class="string" id="4012449">&#39;\\&#39;</span>&nbsp;<span class="op" id="4012454">&amp;&amp;</span>&nbsp;<span class="ident" id="4012457"><a href="/gostd/encoding/json/encode.go.html#4012394">b</a></span>&nbsp;<span class="op" id="4012459">!=</span>&nbsp;<span class="string" id="4012462">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4012466">&amp;&amp;</span>&nbsp;<span class="ident" id="4012469"><a href="/gostd/encoding/json/encode.go.html#4012394">b</a></span>&nbsp;<span class="op" id="4012471">!=</span>&nbsp;<span class="string" id="4012474">&#39;&lt;&#39;</span>&nbsp;<span class="op" id="4012478">&amp;&amp;</span>&nbsp;<span class="ident" id="4012481"><a href="/gostd/encoding/json/encode.go.html#4012394">b</a></span>&nbsp;<span class="op" id="4012483">!=</span>&nbsp;<span class="string" id="4012486">&#39;&gt;&#39;</span>&nbsp;<span class="op" id="4012490">&amp;&amp;</span>&nbsp;<span class="ident" id="4012493"><a href="/gostd/encoding/json/encode.go.html#4012394">b</a></span>&nbsp;<span class="op" id="4012495">!=</span>&nbsp;<span class="string" id="4012498">&#39;&amp;&#39;</span>&nbsp;<span class="op" id="4012502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012508"><a href="/gostd/encoding/json/encode.go.html#4012367">i</a></span><span class="op" id="4012509">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4012516">continue</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4012528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4012533">if</span>&nbsp;<span class="ident" id="4012536"><a href="/gostd/encoding/json/encode.go.html#4012351">start</a></span>&nbsp;<span class="op" id="4012542">&lt;</span>&nbsp;<span class="ident" id="4012544"><a href="/gostd/encoding/json/encode.go.html#4012367">i</a></span>&nbsp;<span class="op" id="4012546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012552"><a href="/gostd/encoding/json/encode.go.html#4012262">e</a></span><span class="op" id="4012553">.</span><span class="ident" id="4012554"><a href="/gostd/bytes/buffer.go.html#1387016">Write</a></span><span class="op" id="4012559">(</span><span class="ident" id="4012560"><a href="/gostd/encoding/json/encode.go.html#4012290">s</a></span><span class="op" id="4012561">[</span><span class="ident" id="4012562"><a href="/gostd/encoding/json/encode.go.html#4012351">start</a></span><span class="op" id="4012567">:</span><span class="ident" id="4012568"><a href="/gostd/encoding/json/encode.go.html#4012367">i</a></span><span class="op" id="4012569">]</span><span class="op" id="4012570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4012575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4012580">switch</span>&nbsp;<span class="ident" id="4012587"><a href="/gostd/encoding/json/encode.go.html#4012394">b</a></span>&nbsp;<span class="op" id="4012589">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4012594">case</span>&nbsp;<span class="string" id="4012599">&#39;\\&#39;</span><span class="op" id="4012603">,</span>&nbsp;<span class="string" id="4012605">&#39;&#34;&#39;</span><span class="op" id="4012608">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012614"><a href="/gostd/encoding/json/encode.go.html#4012262">e</a></span><span class="op" id="4012615">.</span><span class="ident" id="4012616"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4012625">(</span><span class="string" id="4012626">&#39;\\&#39;</span><span class="op" id="4012630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012636"><a href="/gostd/encoding/json/encode.go.html#4012262">e</a></span><span class="op" id="4012637">.</span><span class="ident" id="4012638"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4012647">(</span><span class="ident" id="4012648"><a href="/gostd/encoding/json/encode.go.html#4012394">b</a></span><span class="op" id="4012649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4012654">case</span>&nbsp;<span class="string" id="4012659">&#39;\n&#39;</span><span class="op" id="4012663">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012669"><a href="/gostd/encoding/json/encode.go.html#4012262">e</a></span><span class="op" id="4012670">.</span><span class="ident" id="4012671"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4012680">(</span><span class="string" id="4012681">&#39;\\&#39;</span><span class="op" id="4012685">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012691"><a href="/gostd/encoding/json/encode.go.html#4012262">e</a></span><span class="op" id="4012692">.</span><span class="ident" id="4012693"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4012702">(</span><span class="string" id="4012703">&#39;n&#39;</span><span class="op" id="4012706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4012711">case</span>&nbsp;<span class="string" id="4012716">&#39;\r&#39;</span><span class="op" id="4012720">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012726"><a href="/gostd/encoding/json/encode.go.html#4012262">e</a></span><span class="op" id="4012727">.</span><span class="ident" id="4012728"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4012737">(</span><span class="string" id="4012738">&#39;\\&#39;</span><span class="op" id="4012742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012748"><a href="/gostd/encoding/json/encode.go.html#4012262">e</a></span><span class="op" id="4012749">.</span><span class="ident" id="4012750"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4012759">(</span><span class="string" id="4012760">&#39;r&#39;</span><span class="op" id="4012763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4012768">case</span>&nbsp;<span class="string" id="4012773">&#39;\t&#39;</span><span class="op" id="4012777">:</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012783"><a href="/gostd/encoding/json/encode.go.html#4012262">e</a></span><span class="op" id="4012784">.</span><span class="ident" id="4012785"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4012794">(</span><span class="string" id="4012795">&#39;\\&#39;</span><span class="op" id="4012799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4012805"><a href="/gostd/encoding/json/encode.go.html#4012262">e</a></span><span class="op" id="4012806">.</span><span class="ident" id="4012807"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4012816">(</span><span class="string" id="4012817">&#39;t&#39;</span><span class="op" id="4012820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4012825">default</span><span class="op" id="4012832">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4012838">//&nbsp;This&nbsp;encodes&nbsp;bytes&nbsp;&lt;&nbsp;0x20&nbsp;except&nbsp;for&nbsp;\n&nbsp;and&nbsp;\r,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4012893">//&nbsp;as&nbsp;well&nbsp;as&nbsp;&lt;,&nbsp;&gt;,&nbsp;and&nbsp;&amp;.&nbsp;The&nbsp;latter&nbsp;are&nbsp;escaped&nbsp;because&nbsp;they</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4012960">//&nbsp;can&nbsp;lead&nbsp;to&nbsp;security&nbsp;holes&nbsp;when&nbsp;user-controlled&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4013023">//&nbsp;are&nbsp;rendered&nbsp;into&nbsp;JSON&nbsp;and&nbsp;served&nbsp;to&nbsp;some&nbsp;browsers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013082"><a href="/gostd/encoding/json/encode.go.html#4012262">e</a></span><span class="op" id="4013083">.</span><span class="ident" id="4013084"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4013095">(</span><span class="string" id="4013096">`\u00`</span><span class="op" id="4013102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013108"><a href="/gostd/encoding/json/encode.go.html#4012262">e</a></span><span class="op" id="4013109">.</span><span class="ident" id="4013110"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4013119">(</span><span class="ident" id="4013120"><a href="/gostd/encoding/json/encode.go.html#3998013">hex</a></span><span class="op" id="4013123">[</span><span class="ident" id="4013124"><a href="/gostd/encoding/json/encode.go.html#4012394">b</a></span><span class="op" id="4013125">&gt;&gt;</span><span class="num" id="4013127">4</span><span class="op" id="4013128">]</span><span class="op" id="4013129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013135"><a href="/gostd/encoding/json/encode.go.html#4012262">e</a></span><span class="op" id="4013136">.</span><span class="ident" id="4013137"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4013146">(</span><span class="ident" id="4013147"><a href="/gostd/encoding/json/encode.go.html#3998013">hex</a></span><span class="op" id="4013150">[</span><span class="ident" id="4013151"><a href="/gostd/encoding/json/encode.go.html#4012394">b</a></span><span class="op" id="4013152">&amp;</span><span class="num" id="4013153">0xF</span><span class="op" id="4013156">]</span><span class="op" id="4013157">)</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4013162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013167"><a href="/gostd/encoding/json/encode.go.html#4012367">i</a></span><span class="op" id="4013168">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013174"><a href="/gostd/encoding/json/encode.go.html#4012351">start</a></span>&nbsp;<span class="op" id="4013180">=</span>&nbsp;<span class="ident" id="4013182"><a href="/gostd/encoding/json/encode.go.html#4012367">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4013187">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4013198">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013202">c</span><span class="op" id="4013203">,</span>&nbsp;<span class="ident" id="4013205">size</span>&nbsp;<span class="op" id="4013210">:=</span>&nbsp;<span class="ident" id="4013213"><a href="/gostd/encoding/json/encode.go.html#3990294">utf8</a></span><span class="op" id="4013217">.</span><span class="ident" id="4013218"><a href="/gostd/unicode/utf8/utf8.go.html#1809912">DecodeRune</a></span><span class="op" id="4013228">(</span><span class="ident" id="4013229"><a href="/gostd/encoding/json/encode.go.html#4012290">s</a></span><span class="op" id="4013230">[</span><span class="ident" id="4013231"><a href="/gostd/encoding/json/encode.go.html#4012367">i</a></span><span class="op" id="4013232">:</span><span class="op" id="4013233">]</span><span class="op" id="4013234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4013238">if</span>&nbsp;<span class="ident" id="4013241"><a href="/gostd/encoding/json/encode.go.html#4013202">c</a></span>&nbsp;<span class="op" id="4013243">==</span>&nbsp;<span class="ident" id="4013246"><a href="/gostd/encoding/json/encode.go.html#3990294">utf8</a></span><span class="op" id="4013250">.</span><span class="ident" id="4013251"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span>&nbsp;<span class="op" id="4013261">&amp;&amp;</span>&nbsp;<span class="ident" id="4013264"><a href="/gostd/encoding/json/encode.go.html#4013205">size</a></span>&nbsp;<span class="op" id="4013269">==</span>&nbsp;<span class="num" id="4013272">1</span>&nbsp;<span class="op" id="4013274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4013279">if</span>&nbsp;<span class="ident" id="4013282"><a href="/gostd/encoding/json/encode.go.html#4012351">start</a></span>&nbsp;<span class="op" id="4013288">&lt;</span>&nbsp;<span class="ident" id="4013290"><a href="/gostd/encoding/json/encode.go.html#4012367">i</a></span>&nbsp;<span class="op" id="4013292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013298"><a href="/gostd/encoding/json/encode.go.html#4012262">e</a></span><span class="op" id="4013299">.</span><span class="ident" id="4013300"><a href="/gostd/bytes/buffer.go.html#1387016">Write</a></span><span class="op" id="4013305">(</span><span class="ident" id="4013306"><a href="/gostd/encoding/json/encode.go.html#4012290">s</a></span><span class="op" id="4013307">[</span><span class="ident" id="4013308"><a href="/gostd/encoding/json/encode.go.html#4012351">start</a></span><span class="op" id="4013313">:</span><span class="ident" id="4013314"><a href="/gostd/encoding/json/encode.go.html#4012367">i</a></span><span class="op" id="4013315">]</span><span class="op" id="4013316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4013321">}</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013326"><a href="/gostd/encoding/json/encode.go.html#4012262">e</a></span><span class="op" id="4013327">.</span><span class="ident" id="4013328"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4013339">(</span><span class="string" id="4013340">`\ufffd`</span><span class="op" id="4013348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013353"><a href="/gostd/encoding/json/encode.go.html#4012367">i</a></span>&nbsp;<span class="op" id="4013355">+=</span>&nbsp;<span class="ident" id="4013358"><a href="/gostd/encoding/json/encode.go.html#4013205">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013366"><a href="/gostd/encoding/json/encode.go.html#4012351">start</a></span>&nbsp;<span class="op" id="4013372">=</span>&nbsp;<span class="ident" id="4013374"><a href="/gostd/encoding/json/encode.go.html#4012367">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4013379">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4013390">}</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4013394">//&nbsp;U+2028&nbsp;is&nbsp;LINE&nbsp;SEPARATOR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4013425">//&nbsp;U+2029&nbsp;is&nbsp;PARAGRAPH&nbsp;SEPARATOR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4013461">//&nbsp;They&nbsp;are&nbsp;both&nbsp;technically&nbsp;valid&nbsp;characters&nbsp;in&nbsp;JSON&nbsp;strings,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4013526">//&nbsp;but&nbsp;don&#39;t&nbsp;work&nbsp;in&nbsp;JSONP,&nbsp;which&nbsp;has&nbsp;to&nbsp;be&nbsp;evaluated&nbsp;as&nbsp;JavaScript,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4013597">//&nbsp;and&nbsp;can&nbsp;lead&nbsp;to&nbsp;security&nbsp;holes&nbsp;there.&nbsp;It&nbsp;is&nbsp;valid&nbsp;JSON&nbsp;to</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4013660">//&nbsp;escape&nbsp;them,&nbsp;so&nbsp;we&nbsp;do&nbsp;so&nbsp;unconditionally.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4013707">//&nbsp;See&nbsp;http://timelessrepo.com/json-isnt-a-javascript-subset&nbsp;for&nbsp;discussion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4013786">if</span>&nbsp;<span class="ident" id="4013789"><a href="/gostd/encoding/json/encode.go.html#4013202">c</a></span>&nbsp;<span class="op" id="4013791">==</span>&nbsp;<span class="string" id="4013794">&#39;\u2028&#39;</span>&nbsp;<span class="op" id="4013803">||</span>&nbsp;<span class="ident" id="4013806"><a href="/gostd/encoding/json/encode.go.html#4013202">c</a></span>&nbsp;<span class="op" id="4013808">==</span>&nbsp;<span class="string" id="4013811">&#39;\u2029&#39;</span>&nbsp;<span class="op" id="4013820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4013825">if</span>&nbsp;<span class="ident" id="4013828"><a href="/gostd/encoding/json/encode.go.html#4012351">start</a></span>&nbsp;<span class="op" id="4013834">&lt;</span>&nbsp;<span class="ident" id="4013836"><a href="/gostd/encoding/json/encode.go.html#4012367">i</a></span>&nbsp;<span class="op" id="4013838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013844"><a href="/gostd/encoding/json/encode.go.html#4012262">e</a></span><span class="op" id="4013845">.</span><span class="ident" id="4013846"><a href="/gostd/bytes/buffer.go.html#1387016">Write</a></span><span class="op" id="4013851">(</span><span class="ident" id="4013852"><a href="/gostd/encoding/json/encode.go.html#4012290">s</a></span><span class="op" id="4013853">[</span><span class="ident" id="4013854"><a href="/gostd/encoding/json/encode.go.html#4012351">start</a></span><span class="op" id="4013859">:</span><span class="ident" id="4013860"><a href="/gostd/encoding/json/encode.go.html#4012367">i</a></span><span class="op" id="4013861">]</span><span class="op" id="4013862">)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4013867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013872"><a href="/gostd/encoding/json/encode.go.html#4012262">e</a></span><span class="op" id="4013873">.</span><span class="ident" id="4013874"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4013885">(</span><span class="string" id="4013886">`\u202`</span><span class="op" id="4013893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013898"><a href="/gostd/encoding/json/encode.go.html#4012262">e</a></span><span class="op" id="4013899">.</span><span class="ident" id="4013900"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4013909">(</span><span class="ident" id="4013910"><a href="/gostd/encoding/json/encode.go.html#3998013">hex</a></span><span class="op" id="4013913">[</span><span class="ident" id="4013914"><a href="/gostd/encoding/json/encode.go.html#4013202">c</a></span><span class="op" id="4013915">&amp;</span><span class="num" id="4013916">0xF</span><span class="op" id="4013919">]</span><span class="op" id="4013920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013925"><a href="/gostd/encoding/json/encode.go.html#4012367">i</a></span>&nbsp;<span class="op" id="4013927">+=</span>&nbsp;<span class="ident" id="4013930"><a href="/gostd/encoding/json/encode.go.html#4013205">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013938"><a href="/gostd/encoding/json/encode.go.html#4012351">start</a></span>&nbsp;<span class="op" id="4013944">=</span>&nbsp;<span class="ident" id="4013946"><a href="/gostd/encoding/json/encode.go.html#4012367">i</a></span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4013951">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4013962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4013966"><a href="/gostd/encoding/json/encode.go.html#4012367">i</a></span>&nbsp;<span class="op" id="4013968">+=</span>&nbsp;<span class="ident" id="4013971"><a href="/gostd/encoding/json/encode.go.html#4013205">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4013977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4013980">if</span>&nbsp;<span class="ident" id="4013983"><a href="/gostd/encoding/json/encode.go.html#4012351">start</a></span>&nbsp;<span class="op" id="4013989">&lt;</span>&nbsp;<span class="builtinfunc" id="4013991">len</span><span class="op" id="4013994">(</span><span class="ident" id="4013995"><a href="/gostd/encoding/json/encode.go.html#4012290">s</a></span><span class="op" id="4013996">)</span>&nbsp;<span class="op" id="4013998">{</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014002"><a href="/gostd/encoding/json/encode.go.html#4012262">e</a></span><span class="op" id="4014003">.</span><span class="ident" id="4014004"><a href="/gostd/bytes/buffer.go.html#1387016">Write</a></span><span class="op" id="4014009">(</span><span class="ident" id="4014010"><a href="/gostd/encoding/json/encode.go.html#4012290">s</a></span><span class="op" id="4014011">[</span><span class="ident" id="4014012"><a href="/gostd/encoding/json/encode.go.html#4012351">start</a></span><span class="op" id="4014017">:</span><span class="op" id="4014018">]</span><span class="op" id="4014019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4014022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014025"><a href="/gostd/encoding/json/encode.go.html#4012262">e</a></span><span class="op" id="4014026">.</span><span class="ident" id="4014027"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4014036">(</span><span class="string" id="4014037">&#39;&#34;&#39;</span><span class="op" id="4014040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4014043">return</span>&nbsp;<span class="ident" id="4014050"><a href="/gostd/encoding/json/encode.go.html#4012262">e</a></span><span class="op" id="4014051">.</span><span class="ident" id="4014052"><a href="/gostd/bytes/buffer.go.html#1384893">Len</a></span><span class="op" id="4014055">(</span><span class="op" id="4014056">)</span>&nbsp;<span class="op" id="4014058">-</span>&nbsp;<span class="ident" id="4014060"><a href="/gostd/encoding/json/encode.go.html#4012316">len0</a></span><span class="op" id="4014064">,</span>&nbsp;<span class="builtintype" id="4014066">nil</span><br>
<span class="lineno"></span><span class="op" id="4014070">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span><span class="comment" id="4014073">//&nbsp;A&nbsp;field&nbsp;represents&nbsp;a&nbsp;single&nbsp;field&nbsp;found&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span><span class="keyword" id="4014129">type</span>&nbsp;<span class="ident" id="4014134">field</span>&nbsp;<span class="keyword" id="4014140">struct</span>&nbsp;<span class="op" id="4014147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014150">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4014160">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014168">nameBytes</span>&nbsp;<span class="op" id="4014178">[</span><span class="op" id="4014179">]</span><span class="builtintype" id="4014180">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4014201">//&nbsp;[]byte(name)</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014218">equalFold</span>&nbsp;<span class="keyword" id="4014228">func</span><span class="op" id="4014232">(</span><span class="ident" id="4014233">s</span><span class="op" id="4014234">,</span>&nbsp;<span class="ident" id="4014236">t</span>&nbsp;<span class="op" id="4014238">[</span><span class="op" id="4014239">]</span><span class="builtintype" id="4014240">byte</span><span class="op" id="4014244">)</span>&nbsp;<span class="builtintype" id="4014246">bool</span>&nbsp;<span class="comment" id="4014251">//&nbsp;bytes.EqualFold&nbsp;or&nbsp;equivalent</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014286">tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4014296">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014302">index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4014312">[</span><span class="op" id="4014313">]</span><span class="builtintype" id="4014314">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014319">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014329"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4014336">.</span><span class="ident" id="4014337"><a href="/gostd/reflect/type.go.html#2781467">Type</a></span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014343">omitEmpty</span>&nbsp;<span class="builtintype" id="4014353">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014359">quoted</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4014369">bool</span><br>
<span class="lineno"></span><span class="op" id="4014374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4014377">func</span>&nbsp;<span class="ident" id="4014382">fillField</span><span class="op" id="4014391">(</span><span class="ident" id="4014392">f</span>&nbsp;<span class="ident" id="4014394"><a href="/gostd/encoding/json/encode.go.html#4014134">field</a></span><span class="op" id="4014399">)</span>&nbsp;<span class="ident" id="4014401"><a href="/gostd/encoding/json/encode.go.html#4014134">field</a></span>&nbsp;<span class="op" id="4014407">{</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014410"><a href="/gostd/encoding/json/encode.go.html#4014392">f</a></span><span class="op" id="4014411">.</span><span class="ident" id="4014412"><a href="/gostd/encoding/json/encode.go.html#4014168">nameBytes</a></span>&nbsp;<span class="op" id="4014422">=</span>&nbsp;<span class="op" id="4014424">[</span><span class="op" id="4014425">]</span><span class="builtintype" id="4014426">byte</span><span class="op" id="4014430">(</span><span class="ident" id="4014431"><a href="/gostd/encoding/json/encode.go.html#4014392">f</a></span><span class="op" id="4014432">.</span><span class="ident" id="4014433"><a href="/gostd/encoding/json/encode.go.html#4014150">name</a></span><span class="op" id="4014437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014440"><a href="/gostd/encoding/json/encode.go.html#4014392">f</a></span><span class="op" id="4014441">.</span><span class="ident" id="4014442"><a href="/gostd/encoding/json/encode.go.html#4014218">equalFold</a></span>&nbsp;<span class="op" id="4014452">=</span>&nbsp;<span class="ident" id="4014454"><a href="/gostd/encoding/json/fold.go.html#4021681">foldFunc</a></span><span class="op" id="4014462">(</span><span class="ident" id="4014463"><a href="/gostd/encoding/json/encode.go.html#4014392">f</a></span><span class="op" id="4014464">.</span><span class="ident" id="4014465"><a href="/gostd/encoding/json/encode.go.html#4014168">nameBytes</a></span><span class="op" id="4014474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4014477">return</span>&nbsp;<span class="ident" id="4014484"><a href="/gostd/encoding/json/encode.go.html#4014392">f</a></span><br>
<span class="lineno"></span><span class="op" id="4014486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">955</span><span class="comment" id="4014489">//&nbsp;byName&nbsp;sorts&nbsp;field&nbsp;by&nbsp;name,&nbsp;breaking&nbsp;ties&nbsp;with&nbsp;depth,</span><br>
<span class="lineno"></span><span class="comment" id="4014546">//&nbsp;then&nbsp;breaking&nbsp;ties&nbsp;with&nbsp;&#34;name&nbsp;came&nbsp;from&nbsp;json&nbsp;tag&#34;,&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="4014605">//&nbsp;breaking&nbsp;ties&nbsp;with&nbsp;index&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="keyword" id="4014643">type</span>&nbsp;<span class="ident" id="4014648">byName</span>&nbsp;<span class="op" id="4014655">[</span><span class="op" id="4014656">]</span><span class="ident" id="4014657"><a href="/gostd/encoding/json/encode.go.html#4014134">field</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">960</span><span class="keyword" id="4014664">func</span>&nbsp;<span class="op" id="4014669">(</span><span class="ident" id="4014670">x</span>&nbsp;<span class="ident" id="4014672"><a href="/gostd/encoding/json/encode.go.html#4014648">byName</a></span><span class="op" id="4014678">)</span>&nbsp;<span class="ident" id="4014680">Len</span><span class="op" id="4014683">(</span><span class="op" id="4014684">)</span>&nbsp;<span class="builtintype" id="4014686">int</span>&nbsp;<span class="op" id="4014690">{</span>&nbsp;<span class="keyword" id="4014692">return</span>&nbsp;<span class="builtinfunc" id="4014699">len</span><span class="op" id="4014702">(</span><span class="ident" id="4014703"><a href="/gostd/encoding/json/encode.go.html#4014670">x</a></span><span class="op" id="4014704">)</span>&nbsp;<span class="op" id="4014706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4014709">func</span>&nbsp;<span class="op" id="4014714">(</span><span class="ident" id="4014715">x</span>&nbsp;<span class="ident" id="4014717"><a href="/gostd/encoding/json/encode.go.html#4014648">byName</a></span><span class="op" id="4014723">)</span>&nbsp;<span class="ident" id="4014725">Swap</span><span class="op" id="4014729">(</span><span class="ident" id="4014730">i</span><span class="op" id="4014731">,</span>&nbsp;<span class="ident" id="4014733">j</span>&nbsp;<span class="builtintype" id="4014735">int</span><span class="op" id="4014738">)</span>&nbsp;<span class="op" id="4014740">{</span>&nbsp;<span class="ident" id="4014742"><a href="/gostd/encoding/json/encode.go.html#4014715">x</a></span><span class="op" id="4014743">[</span><span class="ident" id="4014744"><a href="/gostd/encoding/json/encode.go.html#4014730">i</a></span><span class="op" id="4014745">]</span><span class="op" id="4014746">,</span>&nbsp;<span class="ident" id="4014748"><a href="/gostd/encoding/json/encode.go.html#4014715">x</a></span><span class="op" id="4014749">[</span><span class="ident" id="4014750"><a href="/gostd/encoding/json/encode.go.html#4014733">j</a></span><span class="op" id="4014751">]</span>&nbsp;<span class="op" id="4014753">=</span>&nbsp;<span class="ident" id="4014755"><a href="/gostd/encoding/json/encode.go.html#4014715">x</a></span><span class="op" id="4014756">[</span><span class="ident" id="4014757"><a href="/gostd/encoding/json/encode.go.html#4014733">j</a></span><span class="op" id="4014758">]</span><span class="op" id="4014759">,</span>&nbsp;<span class="ident" id="4014761"><a href="/gostd/encoding/json/encode.go.html#4014715">x</a></span><span class="op" id="4014762">[</span><span class="ident" id="4014763"><a href="/gostd/encoding/json/encode.go.html#4014730">i</a></span><span class="op" id="4014764">]</span>&nbsp;<span class="op" id="4014766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4014769">func</span>&nbsp;<span class="op" id="4014774">(</span><span class="ident" id="4014775">x</span>&nbsp;<span class="ident" id="4014777"><a href="/gostd/encoding/json/encode.go.html#4014648">byName</a></span><span class="op" id="4014783">)</span>&nbsp;<span class="ident" id="4014785">Less</span><span class="op" id="4014789">(</span><span class="ident" id="4014790">i</span><span class="op" id="4014791">,</span>&nbsp;<span class="ident" id="4014793">j</span>&nbsp;<span class="builtintype" id="4014795">int</span><span class="op" id="4014798">)</span>&nbsp;<span class="builtintype" id="4014800">bool</span>&nbsp;<span class="op" id="4014805">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4014808">if</span>&nbsp;<span class="ident" id="4014811"><a href="/gostd/encoding/json/encode.go.html#4014775">x</a></span><span class="op" id="4014812">[</span><span class="ident" id="4014813"><a href="/gostd/encoding/json/encode.go.html#4014790">i</a></span><span class="op" id="4014814">]</span><span class="op" id="4014815">.</span><span class="ident" id="4014816"><a href="/gostd/encoding/json/encode.go.html#4014150">name</a></span>&nbsp;<span class="op" id="4014821">!=</span>&nbsp;<span class="ident" id="4014824"><a href="/gostd/encoding/json/encode.go.html#4014775">x</a></span><span class="op" id="4014825">[</span><span class="ident" id="4014826"><a href="/gostd/encoding/json/encode.go.html#4014793">j</a></span><span class="op" id="4014827">]</span><span class="op" id="4014828">.</span><span class="ident" id="4014829"><a href="/gostd/encoding/json/encode.go.html#4014150">name</a></span>&nbsp;<span class="op" id="4014834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4014838">return</span>&nbsp;<span class="ident" id="4014845"><a href="/gostd/encoding/json/encode.go.html#4014775">x</a></span><span class="op" id="4014846">[</span><span class="ident" id="4014847"><a href="/gostd/encoding/json/encode.go.html#4014790">i</a></span><span class="op" id="4014848">]</span><span class="op" id="4014849">.</span><span class="ident" id="4014850"><a href="/gostd/encoding/json/encode.go.html#4014150">name</a></span>&nbsp;<span class="op" id="4014855">&lt;</span>&nbsp;<span class="ident" id="4014857"><a href="/gostd/encoding/json/encode.go.html#4014775">x</a></span><span class="op" id="4014858">[</span><span class="ident" id="4014859"><a href="/gostd/encoding/json/encode.go.html#4014793">j</a></span><span class="op" id="4014860">]</span><span class="op" id="4014861">.</span><span class="ident" id="4014862"><a href="/gostd/encoding/json/encode.go.html#4014150">name</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4014868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4014871">if</span>&nbsp;<span class="builtinfunc" id="4014874">len</span><span class="op" id="4014877">(</span><span class="ident" id="4014878"><a href="/gostd/encoding/json/encode.go.html#4014775">x</a></span><span class="op" id="4014879">[</span><span class="ident" id="4014880"><a href="/gostd/encoding/json/encode.go.html#4014790">i</a></span><span class="op" id="4014881">]</span><span class="op" id="4014882">.</span><span class="ident" id="4014883"><a href="/gostd/encoding/json/encode.go.html#4014302">index</a></span><span class="op" id="4014888">)</span>&nbsp;<span class="op" id="4014890">!=</span>&nbsp;<span class="builtinfunc" id="4014893">len</span><span class="op" id="4014896">(</span><span class="ident" id="4014897"><a href="/gostd/encoding/json/encode.go.html#4014775">x</a></span><span class="op" id="4014898">[</span><span class="ident" id="4014899"><a href="/gostd/encoding/json/encode.go.html#4014793">j</a></span><span class="op" id="4014900">]</span><span class="op" id="4014901">.</span><span class="ident" id="4014902"><a href="/gostd/encoding/json/encode.go.html#4014302">index</a></span><span class="op" id="4014907">)</span>&nbsp;<span class="op" id="4014909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4014913">return</span>&nbsp;<span class="builtinfunc" id="4014920">len</span><span class="op" id="4014923">(</span><span class="ident" id="4014924"><a href="/gostd/encoding/json/encode.go.html#4014775">x</a></span><span class="op" id="4014925">[</span><span class="ident" id="4014926"><a href="/gostd/encoding/json/encode.go.html#4014790">i</a></span><span class="op" id="4014927">]</span><span class="op" id="4014928">.</span><span class="ident" id="4014929"><a href="/gostd/encoding/json/encode.go.html#4014302">index</a></span><span class="op" id="4014934">)</span>&nbsp;<span class="op" id="4014936">&lt;</span>&nbsp;<span class="builtinfunc" id="4014938">len</span><span class="op" id="4014941">(</span><span class="ident" id="4014942"><a href="/gostd/encoding/json/encode.go.html#4014775">x</a></span><span class="op" id="4014943">[</span><span class="ident" id="4014944"><a href="/gostd/encoding/json/encode.go.html#4014793">j</a></span><span class="op" id="4014945">]</span><span class="op" id="4014946">.</span><span class="ident" id="4014947"><a href="/gostd/encoding/json/encode.go.html#4014302">index</a></span><span class="op" id="4014952">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4014955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4014958">if</span>&nbsp;<span class="ident" id="4014961"><a href="/gostd/encoding/json/encode.go.html#4014775">x</a></span><span class="op" id="4014962">[</span><span class="ident" id="4014963"><a href="/gostd/encoding/json/encode.go.html#4014790">i</a></span><span class="op" id="4014964">]</span><span class="op" id="4014965">.</span><span class="ident" id="4014966"><a href="/gostd/encoding/json/encode.go.html#4014286">tag</a></span>&nbsp;<span class="op" id="4014970">!=</span>&nbsp;<span class="ident" id="4014973"><a href="/gostd/encoding/json/encode.go.html#4014775">x</a></span><span class="op" id="4014974">[</span><span class="ident" id="4014975"><a href="/gostd/encoding/json/encode.go.html#4014793">j</a></span><span class="op" id="4014976">]</span><span class="op" id="4014977">.</span><span class="ident" id="4014978"><a href="/gostd/encoding/json/encode.go.html#4014286">tag</a></span>&nbsp;<span class="op" id="4014982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4014986">return</span>&nbsp;<span class="ident" id="4014993"><a href="/gostd/encoding/json/encode.go.html#4014775">x</a></span><span class="op" id="4014994">[</span><span class="ident" id="4014995"><a href="/gostd/encoding/json/encode.go.html#4014790">i</a></span><span class="op" id="4014996">]</span><span class="op" id="4014997">.</span><span class="ident" id="4014998"><a href="/gostd/encoding/json/encode.go.html#4014286">tag</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4015003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4015006">return</span>&nbsp;<span class="ident" id="4015013"><a href="/gostd/encoding/json/encode.go.html#4015085">byIndex</a></span><span class="op" id="4015020">(</span><span class="ident" id="4015021"><a href="/gostd/encoding/json/encode.go.html#4014775">x</a></span><span class="op" id="4015022">)</span><span class="op" id="4015023">.</span><span class="ident" id="4015024"><a href="/gostd/encoding/json/encode.go.html#4015226">Less</a></span><span class="op" id="4015028">(</span><span class="ident" id="4015029"><a href="/gostd/encoding/json/encode.go.html#4014790">i</a></span><span class="op" id="4015030">,</span>&nbsp;<span class="ident" id="4015032"><a href="/gostd/encoding/json/encode.go.html#4014793">j</a></span><span class="op" id="4015033">)</span><br>
<span class="lineno">975</span><span class="op" id="4015035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4015038">//&nbsp;byIndex&nbsp;sorts&nbsp;field&nbsp;by&nbsp;index&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="keyword" id="4015080">type</span>&nbsp;<span class="ident" id="4015085">byIndex</span>&nbsp;<span class="op" id="4015093">[</span><span class="op" id="4015094">]</span><span class="ident" id="4015095"><a href="/gostd/encoding/json/encode.go.html#4014134">field</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">980</span><span class="keyword" id="4015102">func</span>&nbsp;<span class="op" id="4015107">(</span><span class="ident" id="4015108">x</span>&nbsp;<span class="ident" id="4015110"><a href="/gostd/encoding/json/encode.go.html#4015085">byIndex</a></span><span class="op" id="4015117">)</span>&nbsp;<span class="ident" id="4015119">Len</span><span class="op" id="4015122">(</span><span class="op" id="4015123">)</span>&nbsp;<span class="builtintype" id="4015125">int</span>&nbsp;<span class="op" id="4015129">{</span>&nbsp;<span class="keyword" id="4015131">return</span>&nbsp;<span class="builtinfunc" id="4015138">len</span><span class="op" id="4015141">(</span><span class="ident" id="4015142"><a href="/gostd/encoding/json/encode.go.html#4015108">x</a></span><span class="op" id="4015143">)</span>&nbsp;<span class="op" id="4015145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4015148">func</span>&nbsp;<span class="op" id="4015153">(</span><span class="ident" id="4015154">x</span>&nbsp;<span class="ident" id="4015156"><a href="/gostd/encoding/json/encode.go.html#4015085">byIndex</a></span><span class="op" id="4015163">)</span>&nbsp;<span class="ident" id="4015165">Swap</span><span class="op" id="4015169">(</span><span class="ident" id="4015170">i</span><span class="op" id="4015171">,</span>&nbsp;<span class="ident" id="4015173">j</span>&nbsp;<span class="builtintype" id="4015175">int</span><span class="op" id="4015178">)</span>&nbsp;<span class="op" id="4015180">{</span>&nbsp;<span class="ident" id="4015182"><a href="/gostd/encoding/json/encode.go.html#4015154">x</a></span><span class="op" id="4015183">[</span><span class="ident" id="4015184"><a href="/gostd/encoding/json/encode.go.html#4015170">i</a></span><span class="op" id="4015185">]</span><span class="op" id="4015186">,</span>&nbsp;<span class="ident" id="4015188"><a href="/gostd/encoding/json/encode.go.html#4015154">x</a></span><span class="op" id="4015189">[</span><span class="ident" id="4015190"><a href="/gostd/encoding/json/encode.go.html#4015173">j</a></span><span class="op" id="4015191">]</span>&nbsp;<span class="op" id="4015193">=</span>&nbsp;<span class="ident" id="4015195"><a href="/gostd/encoding/json/encode.go.html#4015154">x</a></span><span class="op" id="4015196">[</span><span class="ident" id="4015197"><a href="/gostd/encoding/json/encode.go.html#4015173">j</a></span><span class="op" id="4015198">]</span><span class="op" id="4015199">,</span>&nbsp;<span class="ident" id="4015201"><a href="/gostd/encoding/json/encode.go.html#4015154">x</a></span><span class="op" id="4015202">[</span><span class="ident" id="4015203"><a href="/gostd/encoding/json/encode.go.html#4015170">i</a></span><span class="op" id="4015204">]</span>&nbsp;<span class="op" id="4015206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4015209">func</span>&nbsp;<span class="op" id="4015214">(</span><span class="ident" id="4015215">x</span>&nbsp;<span class="ident" id="4015217"><a href="/gostd/encoding/json/encode.go.html#4015085">byIndex</a></span><span class="op" id="4015224">)</span>&nbsp;<span class="ident" id="4015226">Less</span><span class="op" id="4015230">(</span><span class="ident" id="4015231">i</span><span class="op" id="4015232">,</span>&nbsp;<span class="ident" id="4015234">j</span>&nbsp;<span class="builtintype" id="4015236">int</span><span class="op" id="4015239">)</span>&nbsp;<span class="builtintype" id="4015241">bool</span>&nbsp;<span class="op" id="4015246">{</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4015249">for</span>&nbsp;<span class="ident" id="4015253">k</span><span class="op" id="4015254">,</span>&nbsp;<span class="ident" id="4015256">xik</span>&nbsp;<span class="op" id="4015260">:=</span>&nbsp;<span class="keyword" id="4015263">range</span>&nbsp;<span class="ident" id="4015269"><a href="/gostd/encoding/json/encode.go.html#4015215">x</a></span><span class="op" id="4015270">[</span><span class="ident" id="4015271"><a href="/gostd/encoding/json/encode.go.html#4015231">i</a></span><span class="op" id="4015272">]</span><span class="op" id="4015273">.</span><span class="ident" id="4015274"><a href="/gostd/encoding/json/encode.go.html#4014302">index</a></span>&nbsp;<span class="op" id="4015280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4015284">if</span>&nbsp;<span class="ident" id="4015287"><a href="/gostd/encoding/json/encode.go.html#4015253">k</a></span>&nbsp;<span class="op" id="4015289">&gt;=</span>&nbsp;<span class="builtinfunc" id="4015292">len</span><span class="op" id="4015295">(</span><span class="ident" id="4015296"><a href="/gostd/encoding/json/encode.go.html#4015215">x</a></span><span class="op" id="4015297">[</span><span class="ident" id="4015298"><a href="/gostd/encoding/json/encode.go.html#4015234">j</a></span><span class="op" id="4015299">]</span><span class="op" id="4015300">.</span><span class="ident" id="4015301"><a href="/gostd/encoding/json/encode.go.html#4014302">index</a></span><span class="op" id="4015306">)</span>&nbsp;<span class="op" id="4015308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4015313">return</span>&nbsp;<span class="builtintype" id="4015320">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4015328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4015332">if</span>&nbsp;<span class="ident" id="4015335"><a href="/gostd/encoding/json/encode.go.html#4015256">xik</a></span>&nbsp;<span class="op" id="4015339">!=</span>&nbsp;<span class="ident" id="4015342"><a href="/gostd/encoding/json/encode.go.html#4015215">x</a></span><span class="op" id="4015343">[</span><span class="ident" id="4015344"><a href="/gostd/encoding/json/encode.go.html#4015234">j</a></span><span class="op" id="4015345">]</span><span class="op" id="4015346">.</span><span class="ident" id="4015347"><a href="/gostd/encoding/json/encode.go.html#4014302">index</a></span><span class="op" id="4015352">[</span><span class="ident" id="4015353"><a href="/gostd/encoding/json/encode.go.html#4015253">k</a></span><span class="op" id="4015354">]</span>&nbsp;<span class="op" id="4015356">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4015361">return</span>&nbsp;<span class="ident" id="4015368"><a href="/gostd/encoding/json/encode.go.html#4015256">xik</a></span>&nbsp;<span class="op" id="4015372">&lt;</span>&nbsp;<span class="ident" id="4015374"><a href="/gostd/encoding/json/encode.go.html#4015215">x</a></span><span class="op" id="4015375">[</span><span class="ident" id="4015376"><a href="/gostd/encoding/json/encode.go.html#4015234">j</a></span><span class="op" id="4015377">]</span><span class="op" id="4015378">.</span><span class="ident" id="4015379"><a href="/gostd/encoding/json/encode.go.html#4014302">index</a></span><span class="op" id="4015384">[</span><span class="ident" id="4015385"><a href="/gostd/encoding/json/encode.go.html#4015253">k</a></span><span class="op" id="4015386">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4015390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4015393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4015396">return</span>&nbsp;<span class="builtinfunc" id="4015403">len</span><span class="op" id="4015406">(</span><span class="ident" id="4015407"><a href="/gostd/encoding/json/encode.go.html#4015215">x</a></span><span class="op" id="4015408">[</span><span class="ident" id="4015409"><a href="/gostd/encoding/json/encode.go.html#4015231">i</a></span><span class="op" id="4015410">]</span><span class="op" id="4015411">.</span><span class="ident" id="4015412"><a href="/gostd/encoding/json/encode.go.html#4014302">index</a></span><span class="op" id="4015417">)</span>&nbsp;<span class="op" id="4015419">&lt;</span>&nbsp;<span class="builtinfunc" id="4015421">len</span><span class="op" id="4015424">(</span><span class="ident" id="4015425"><a href="/gostd/encoding/json/encode.go.html#4015215">x</a></span><span class="op" id="4015426">[</span><span class="ident" id="4015427"><a href="/gostd/encoding/json/encode.go.html#4015234">j</a></span><span class="op" id="4015428">]</span><span class="op" id="4015429">.</span><span class="ident" id="4015430"><a href="/gostd/encoding/json/encode.go.html#4014302">index</a></span><span class="op" id="4015435">)</span><br>
<span class="lineno"></span><span class="op" id="4015437">}</span><br>
<span class="lineno">995</span><br>
<span class="lineno"></span><span class="comment" id="4015440">//&nbsp;typeFields&nbsp;returns&nbsp;a&nbsp;list&nbsp;of&nbsp;fields&nbsp;that&nbsp;JSON&nbsp;should&nbsp;recognize&nbsp;for&nbsp;the&nbsp;given&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4015526">//&nbsp;The&nbsp;algorithm&nbsp;is&nbsp;breadth-first&nbsp;search&nbsp;over&nbsp;the&nbsp;set&nbsp;of&nbsp;structs&nbsp;to&nbsp;include&nbsp;-&nbsp;the&nbsp;top&nbsp;struct</span><br>
<span class="lineno"></span><span class="comment" id="4015619">//&nbsp;and&nbsp;then&nbsp;any&nbsp;reachable&nbsp;anonymous&nbsp;structs.</span><br>
<span class="lineno"></span><span class="keyword" id="4015664">func</span>&nbsp;<span class="ident" id="4015669">typeFields</span><span class="op" id="4015679">(</span><span class="ident" id="4015680">t</span>&nbsp;<span class="ident" id="4015682"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4015689">.</span><span class="ident" id="4015690"><a href="/gostd/reflect/type.go.html#2781467">Type</a></span><span class="op" id="4015694">)</span>&nbsp;<span class="op" id="4015696">[</span><span class="op" id="4015697">]</span><span class="ident" id="4015698"><a href="/gostd/encoding/json/encode.go.html#4014134">field</a></span>&nbsp;<span class="op" id="4015704">{</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4015707">//&nbsp;Anonymous&nbsp;fields&nbsp;to&nbsp;explore&nbsp;at&nbsp;the&nbsp;current&nbsp;level&nbsp;and&nbsp;the&nbsp;next.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4015774">current</span>&nbsp;<span class="op" id="4015782">:=</span>&nbsp;<span class="op" id="4015785">[</span><span class="op" id="4015786">]</span><span class="ident" id="4015787"><a href="/gostd/encoding/json/encode.go.html#4014134">field</a></span><span class="op" id="4015792">{</span><span class="op" id="4015793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4015796">next</span>&nbsp;<span class="op" id="4015801">:=</span>&nbsp;<span class="op" id="4015804">[</span><span class="op" id="4015805">]</span><span class="ident" id="4015806"><a href="/gostd/encoding/json/encode.go.html#4014134">field</a></span><span class="op" id="4015811">{</span><span class="op" id="4015812">{</span><span class="ident" id="4015813"><a href="/gostd/encoding/json/encode.go.html#4014319">typ</a></span><span class="op" id="4015816">:</span>&nbsp;<span class="ident" id="4015818"><a href="/gostd/encoding/json/encode.go.html#4015680">t</a></span><span class="op" id="4015819">}</span><span class="op" id="4015820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4015824">//&nbsp;Count&nbsp;of&nbsp;queued&nbsp;names&nbsp;for&nbsp;current&nbsp;level&nbsp;and&nbsp;the&nbsp;next.</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4015882">count</span>&nbsp;<span class="op" id="4015888">:=</span>&nbsp;<span class="keyword" id="4015891">map</span><span class="op" id="4015894">[</span><span class="ident" id="4015895"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4015902">.</span><span class="ident" id="4015903"><a href="/gostd/reflect/type.go.html#2781467">Type</a></span><span class="op" id="4015907">]</span><span class="builtintype" id="4015908">int</span><span class="op" id="4015911">{</span><span class="op" id="4015912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4015915">nextCount</span>&nbsp;<span class="op" id="4015925">:=</span>&nbsp;<span class="keyword" id="4015928">map</span><span class="op" id="4015931">[</span><span class="ident" id="4015932"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4015939">.</span><span class="ident" id="4015940"><a href="/gostd/reflect/type.go.html#2781467">Type</a></span><span class="op" id="4015944">]</span><span class="builtintype" id="4015945">int</span><span class="op" id="4015948">{</span><span class="op" id="4015949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4015953">//&nbsp;Types&nbsp;already&nbsp;visited&nbsp;at&nbsp;an&nbsp;earlier&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016000">visited</span>&nbsp;<span class="op" id="4016008">:=</span>&nbsp;<span class="keyword" id="4016011">map</span><span class="op" id="4016014">[</span><span class="ident" id="4016015"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4016022">.</span><span class="ident" id="4016023"><a href="/gostd/reflect/type.go.html#2781467">Type</a></span><span class="op" id="4016027">]</span><span class="builtintype" id="4016028">bool</span><span class="op" id="4016032">{</span><span class="op" id="4016033">}</span><br>
<span class="lineno">1010</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4016037">//&nbsp;Fields&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4016055">var</span>&nbsp;<span class="ident" id="4016059">fields</span>&nbsp;<span class="op" id="4016066">[</span><span class="op" id="4016067">]</span><span class="ident" id="4016068"><a href="/gostd/encoding/json/encode.go.html#4014134">field</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4016076">for</span>&nbsp;<span class="builtinfunc" id="4016080">len</span><span class="op" id="4016083">(</span><span class="ident" id="4016084"><a href="/gostd/encoding/json/encode.go.html#4015796">next</a></span><span class="op" id="4016088">)</span>&nbsp;<span class="op" id="4016090">&gt;</span>&nbsp;<span class="num" id="4016092">0</span>&nbsp;<span class="op" id="4016094">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016098"><a href="/gostd/encoding/json/encode.go.html#4015774">current</a></span><span class="op" id="4016105">,</span>&nbsp;<span class="ident" id="4016107"><a href="/gostd/encoding/json/encode.go.html#4015796">next</a></span>&nbsp;<span class="op" id="4016112">=</span>&nbsp;<span class="ident" id="4016114"><a href="/gostd/encoding/json/encode.go.html#4015796">next</a></span><span class="op" id="4016118">,</span>&nbsp;<span class="ident" id="4016120"><a href="/gostd/encoding/json/encode.go.html#4015774">current</a></span><span class="op" id="4016127">[</span><span class="op" id="4016128">:</span><span class="num" id="4016129">0</span><span class="op" id="4016130">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016134"><a href="/gostd/encoding/json/encode.go.html#4015882">count</a></span><span class="op" id="4016139">,</span>&nbsp;<span class="ident" id="4016141"><a href="/gostd/encoding/json/encode.go.html#4015915">nextCount</a></span>&nbsp;<span class="op" id="4016151">=</span>&nbsp;<span class="ident" id="4016153"><a href="/gostd/encoding/json/encode.go.html#4015915">nextCount</a></span><span class="op" id="4016162">,</span>&nbsp;<span class="keyword" id="4016164">map</span><span class="op" id="4016167">[</span><span class="ident" id="4016168"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4016175">.</span><span class="ident" id="4016176"><a href="/gostd/reflect/type.go.html#2781467">Type</a></span><span class="op" id="4016180">]</span><span class="builtintype" id="4016181">int</span><span class="op" id="4016184">{</span><span class="op" id="4016185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4016190">for</span>&nbsp;<span class="ident" id="4016194">_</span><span class="op" id="4016195">,</span>&nbsp;<span class="ident" id="4016197">f</span>&nbsp;<span class="op" id="4016199">:=</span>&nbsp;<span class="keyword" id="4016202">range</span>&nbsp;<span class="ident" id="4016208"><a href="/gostd/encoding/json/encode.go.html#4015774">current</a></span>&nbsp;<span class="op" id="4016216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4016221">if</span>&nbsp;<span class="ident" id="4016224"><a href="/gostd/encoding/json/encode.go.html#4016000">visited</a></span><span class="op" id="4016231">[</span><span class="ident" id="4016232"><a href="/gostd/encoding/json/encode.go.html#4016197">f</a></span><span class="op" id="4016233">.</span><span class="ident" id="4016234"><a href="/gostd/encoding/json/encode.go.html#4014319">typ</a></span><span class="op" id="4016237">]</span>&nbsp;<span class="op" id="4016239">{</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4016245">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4016257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016262"><a href="/gostd/encoding/json/encode.go.html#4016000">visited</a></span><span class="op" id="4016269">[</span><span class="ident" id="4016270"><a href="/gostd/encoding/json/encode.go.html#4016197">f</a></span><span class="op" id="4016271">.</span><span class="ident" id="4016272"><a href="/gostd/encoding/json/encode.go.html#4014319">typ</a></span><span class="op" id="4016275">]</span>&nbsp;<span class="op" id="4016277">=</span>&nbsp;<span class="builtintype" id="4016279">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4016288">//&nbsp;Scan&nbsp;f.typ&nbsp;for&nbsp;fields&nbsp;to&nbsp;include.</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4016328">for</span>&nbsp;<span class="ident" id="4016332">i</span>&nbsp;<span class="op" id="4016334">:=</span>&nbsp;<span class="num" id="4016337">0</span><span class="op" id="4016338">;</span>&nbsp;<span class="ident" id="4016340"><a href="/gostd/encoding/json/encode.go.html#4016332">i</a></span>&nbsp;<span class="op" id="4016342">&lt;</span>&nbsp;<span class="ident" id="4016344"><a href="/gostd/encoding/json/encode.go.html#4016197">f</a></span><span class="op" id="4016345">.</span><span class="ident" id="4016346"><a href="/gostd/encoding/json/encode.go.html#4014319">typ</a></span><span class="op" id="4016349">.</span><span class="ident" id="4016350"><a href="/gostd/reflect/type.go.html#2786550">NumField</a></span><span class="op" id="4016358">(</span><span class="op" id="4016359">)</span><span class="op" id="4016360">;</span>&nbsp;<span class="ident" id="4016362"><a href="/gostd/encoding/json/encode.go.html#4016332">i</a></span><span class="op" id="4016363">++</span>&nbsp;<span class="op" id="4016366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016372">sf</span>&nbsp;<span class="op" id="4016375">:=</span>&nbsp;<span class="ident" id="4016378"><a href="/gostd/encoding/json/encode.go.html#4016197">f</a></span><span class="op" id="4016379">.</span><span class="ident" id="4016380"><a href="/gostd/encoding/json/encode.go.html#4014319">typ</a></span><span class="op" id="4016383">.</span><span class="ident" id="4016384"><a href="/gostd/reflect/type.go.html#2785427">Field</a></span><span class="op" id="4016389">(</span><span class="ident" id="4016390"><a href="/gostd/encoding/json/encode.go.html#4016332">i</a></span><span class="op" id="4016391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4016397">if</span>&nbsp;<span class="ident" id="4016400"><a href="/gostd/encoding/json/encode.go.html#4016372">sf</a></span><span class="op" id="4016402">.</span><span class="ident" id="4016403"><a href="/gostd/reflect/type.go.html#2801017">PkgPath</a></span>&nbsp;<span class="op" id="4016411">!=</span>&nbsp;<span class="string" id="4016414">&#34;&#34;</span>&nbsp;<span class="op" id="4016417">{</span>&nbsp;<span class="comment" id="4016419">//&nbsp;unexported</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4016438">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4016451">}</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016457">tag</span>&nbsp;<span class="op" id="4016461">:=</span>&nbsp;<span class="ident" id="4016464"><a href="/gostd/encoding/json/encode.go.html#4016372">sf</a></span><span class="op" id="4016466">.</span><span class="ident" id="4016467"><a href="/gostd/reflect/type.go.html#2801069">Tag</a></span><span class="op" id="4016470">.</span><span class="ident" id="4016471"><a href="/gostd/reflect/type.go.html#2801940">Get</a></span><span class="op" id="4016474">(</span><span class="string" id="4016475">&#34;json&#34;</span><span class="op" id="4016481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4016487">if</span>&nbsp;<span class="ident" id="4016490"><a href="/gostd/encoding/json/encode.go.html#4016457">tag</a></span>&nbsp;<span class="op" id="4016494">==</span>&nbsp;<span class="string" id="4016497">&#34;-&#34;</span>&nbsp;<span class="op" id="4016501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4016508">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4016521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016527">name</span><span class="op" id="4016531">,</span>&nbsp;<span class="ident" id="4016533">opts</span>&nbsp;<span class="op" id="4016538">:=</span>&nbsp;<span class="ident" id="4016541"><a href="/gostd/encoding/json/tags.go.html#4049214">parseTag</a></span><span class="op" id="4016549">(</span><span class="ident" id="4016550"><a href="/gostd/encoding/json/encode.go.html#4016457">tag</a></span><span class="op" id="4016553">)</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4016559">if</span>&nbsp;<span class="op" id="4016562">!</span><span class="ident" id="4016563"><a href="/gostd/encoding/json/encode.go.html#4009098">isValidTag</a></span><span class="op" id="4016573">(</span><span class="ident" id="4016574"><a href="/gostd/encoding/json/encode.go.html#4016527">name</a></span><span class="op" id="4016578">)</span>&nbsp;<span class="op" id="4016580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016587"><a href="/gostd/encoding/json/encode.go.html#4016527">name</a></span>&nbsp;<span class="op" id="4016592">=</span>&nbsp;<span class="string" id="4016594">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4016601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016607">index</span>&nbsp;<span class="op" id="4016613">:=</span>&nbsp;<span class="builtinfunc" id="4016616">make</span><span class="op" id="4016620">(</span><span class="op" id="4016621">[</span><span class="op" id="4016622">]</span><span class="builtintype" id="4016623">int</span><span class="op" id="4016626">,</span>&nbsp;<span class="builtinfunc" id="4016628">len</span><span class="op" id="4016631">(</span><span class="ident" id="4016632"><a href="/gostd/encoding/json/encode.go.html#4016197">f</a></span><span class="op" id="4016633">.</span><span class="ident" id="4016634"><a href="/gostd/encoding/json/encode.go.html#4014302">index</a></span><span class="op" id="4016639">)</span><span class="op" id="4016640">+</span><span class="num" id="4016641">1</span><span class="op" id="4016642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4016648">copy</span><span class="op" id="4016652">(</span><span class="ident" id="4016653"><a href="/gostd/encoding/json/encode.go.html#4016607">index</a></span><span class="op" id="4016658">,</span>&nbsp;<span class="ident" id="4016660"><a href="/gostd/encoding/json/encode.go.html#4016197">f</a></span><span class="op" id="4016661">.</span><span class="ident" id="4016662"><a href="/gostd/encoding/json/encode.go.html#4014302">index</a></span><span class="op" id="4016667">)</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016673"><a href="/gostd/encoding/json/encode.go.html#4016607">index</a></span><span class="op" id="4016678">[</span><span class="builtinfunc" id="4016679">len</span><span class="op" id="4016682">(</span><span class="ident" id="4016683"><a href="/gostd/encoding/json/encode.go.html#4016197">f</a></span><span class="op" id="4016684">.</span><span class="ident" id="4016685"><a href="/gostd/encoding/json/encode.go.html#4014302">index</a></span><span class="op" id="4016690">)</span><span class="op" id="4016691">]</span>&nbsp;<span class="op" id="4016693">=</span>&nbsp;<span class="ident" id="4016695"><a href="/gostd/encoding/json/encode.go.html#4016332">i</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016702">ft</span>&nbsp;<span class="op" id="4016705">:=</span>&nbsp;<span class="ident" id="4016708"><a href="/gostd/encoding/json/encode.go.html#4016372">sf</a></span><span class="op" id="4016710">.</span><span class="ident" id="4016711"><a href="/gostd/reflect/type.go.html#2801034">Type</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4016720">if</span>&nbsp;<span class="ident" id="4016723"><a href="/gostd/encoding/json/encode.go.html#4016702">ft</a></span><span class="op" id="4016725">.</span><span class="ident" id="4016726"><a href="/gostd/reflect/type.go.html#2782837">Name</a></span><span class="op" id="4016730">(</span><span class="op" id="4016731">)</span>&nbsp;<span class="op" id="4016733">==</span>&nbsp;<span class="string" id="4016736">&#34;&#34;</span>&nbsp;<span class="op" id="4016739">&amp;&amp;</span>&nbsp;<span class="ident" id="4016742"><a href="/gostd/encoding/json/encode.go.html#4016702">ft</a></span><span class="op" id="4016744">.</span><span class="ident" id="4016745"><a href="/gostd/reflect/type.go.html#2783619">Kind</a></span><span class="op" id="4016749">(</span><span class="op" id="4016750">)</span>&nbsp;<span class="op" id="4016752">==</span>&nbsp;<span class="ident" id="4016755"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4016762">.</span><span class="ident" id="4016763"><a href="/gostd/reflect/type.go.html#2788057">Ptr</a></span>&nbsp;<span class="op" id="4016767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4016774">//&nbsp;Follow&nbsp;pointer.</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016798"><a href="/gostd/encoding/json/encode.go.html#4016702">ft</a></span>&nbsp;<span class="op" id="4016801">=</span>&nbsp;<span class="ident" id="4016803"><a href="/gostd/encoding/json/encode.go.html#4016702">ft</a></span><span class="op" id="4016805">.</span><span class="ident" id="4016806"><a href="/gostd/reflect/type.go.html#2785263">Elem</a></span><span class="op" id="4016810">(</span><span class="op" id="4016811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4016817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4016824">//&nbsp;Record&nbsp;found&nbsp;field&nbsp;and&nbsp;index&nbsp;sequence.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4016870">if</span>&nbsp;<span class="ident" id="4016873"><a href="/gostd/encoding/json/encode.go.html#4016527">name</a></span>&nbsp;<span class="op" id="4016878">!=</span>&nbsp;<span class="string" id="4016881">&#34;&#34;</span>&nbsp;<span class="op" id="4016884">||</span>&nbsp;<span class="op" id="4016887">!</span><span class="ident" id="4016888"><a href="/gostd/encoding/json/encode.go.html#4016372">sf</a></span><span class="op" id="4016890">.</span><span class="ident" id="4016891"><a href="/gostd/reflect/type.go.html#2801226">Anonymous</a></span>&nbsp;<span class="op" id="4016901">||</span>&nbsp;<span class="ident" id="4016904"><a href="/gostd/encoding/json/encode.go.html#4016702">ft</a></span><span class="op" id="4016906">.</span><span class="ident" id="4016907"><a href="/gostd/reflect/type.go.html#2783619">Kind</a></span><span class="op" id="4016911">(</span><span class="op" id="4016912">)</span>&nbsp;<span class="op" id="4016914">!=</span>&nbsp;<span class="ident" id="4016917"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4016924">.</span><span class="ident" id="4016925"><a href="/gostd/reflect/type.go.html#2788077">Struct</a></span>&nbsp;<span class="op" id="4016932">{</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016939">tagged</span>&nbsp;<span class="op" id="4016946">:=</span>&nbsp;<span class="ident" id="4016949"><a href="/gostd/encoding/json/encode.go.html#4016527">name</a></span>&nbsp;<span class="op" id="4016954">!=</span>&nbsp;<span class="string" id="4016957">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4016965">if</span>&nbsp;<span class="ident" id="4016968"><a href="/gostd/encoding/json/encode.go.html#4016527">name</a></span>&nbsp;<span class="op" id="4016973">==</span>&nbsp;<span class="string" id="4016976">&#34;&#34;</span>&nbsp;<span class="op" id="4016979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4016987"><a href="/gostd/encoding/json/encode.go.html#4016527">name</a></span>&nbsp;<span class="op" id="4016992">=</span>&nbsp;<span class="ident" id="4016994"><a href="/gostd/encoding/json/encode.go.html#4016372">sf</a></span><span class="op" id="4016996">.</span><span class="ident" id="4016997"><a href="/gostd/reflect/type.go.html#2801001">Name</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4017007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017014"><a href="/gostd/encoding/json/encode.go.html#4016059">fields</a></span>&nbsp;<span class="op" id="4017021">=</span>&nbsp;<span class="builtinfunc" id="4017023">append</span><span class="op" id="4017029">(</span><span class="ident" id="4017030"><a href="/gostd/encoding/json/encode.go.html#4016059">fields</a></span><span class="op" id="4017036">,</span>&nbsp;<span class="ident" id="4017038"><a href="/gostd/encoding/json/encode.go.html#4014382">fillField</a></span><span class="op" id="4017047">(</span><span class="ident" id="4017048"><a href="/gostd/encoding/json/encode.go.html#4014134">field</a></span><span class="op" id="4017053">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017061"><a href="/gostd/encoding/json/encode.go.html#4014150">name</a></span><span class="op" id="4017065">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017072"><a href="/gostd/encoding/json/encode.go.html#4016527">name</a></span><span class="op" id="4017076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017084"><a href="/gostd/encoding/json/encode.go.html#4014286">tag</a></span><span class="op" id="4017087">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017095"><a href="/gostd/encoding/json/encode.go.html#4016939">tagged</a></span><span class="op" id="4017101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017109"><a href="/gostd/encoding/json/encode.go.html#4014302">index</a></span><span class="op" id="4017114">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017120"><a href="/gostd/encoding/json/encode.go.html#4016607">index</a></span><span class="op" id="4017125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017133"><a href="/gostd/encoding/json/encode.go.html#4014319">typ</a></span><span class="op" id="4017136">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017144"><a href="/gostd/encoding/json/encode.go.html#4016702">ft</a></span><span class="op" id="4017146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017154"><a href="/gostd/encoding/json/encode.go.html#4014343">omitEmpty</a></span><span class="op" id="4017163">:</span>&nbsp;<span class="ident" id="4017165"><a href="/gostd/encoding/json/encode.go.html#4016533">opts</a></span><span class="op" id="4017169">.</span><span class="ident" id="4017170"><a href="/gostd/encoding/json/tags.go.html#4049565">Contains</a></span><span class="op" id="4017178">(</span><span class="string" id="4017179">&#34;omitempty&#34;</span><span class="op" id="4017190">)</span><span class="op" id="4017191">,</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017199"><a href="/gostd/encoding/json/encode.go.html#4014359">quoted</a></span><span class="op" id="4017205">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017210"><a href="/gostd/encoding/json/encode.go.html#4016533">opts</a></span><span class="op" id="4017214">.</span><span class="ident" id="4017215"><a href="/gostd/encoding/json/tags.go.html#4049565">Contains</a></span><span class="op" id="4017223">(</span><span class="string" id="4017224">&#34;string&#34;</span><span class="op" id="4017232">)</span><span class="op" id="4017233">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4017240">}</span><span class="op" id="4017241">)</span><span class="op" id="4017242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4017249">if</span>&nbsp;<span class="ident" id="4017252"><a href="/gostd/encoding/json/encode.go.html#4015882">count</a></span><span class="op" id="4017257">[</span><span class="ident" id="4017258"><a href="/gostd/encoding/json/encode.go.html#4016197">f</a></span><span class="op" id="4017259">.</span><span class="ident" id="4017260"><a href="/gostd/encoding/json/encode.go.html#4014319">typ</a></span><span class="op" id="4017263">]</span>&nbsp;<span class="op" id="4017265">&gt;</span>&nbsp;<span class="num" id="4017267">1</span>&nbsp;<span class="op" id="4017269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4017277">//&nbsp;If&nbsp;there&nbsp;were&nbsp;multiple&nbsp;instances,&nbsp;add&nbsp;a&nbsp;second,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4017334">//&nbsp;so&nbsp;that&nbsp;the&nbsp;annihilation&nbsp;code&nbsp;will&nbsp;see&nbsp;a&nbsp;duplicate.</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4017395">//&nbsp;It&nbsp;only&nbsp;cares&nbsp;about&nbsp;the&nbsp;distinction&nbsp;between&nbsp;1&nbsp;or&nbsp;2,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4017456">//&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;generating&nbsp;any&nbsp;more&nbsp;copies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017509"><a href="/gostd/encoding/json/encode.go.html#4016059">fields</a></span>&nbsp;<span class="op" id="4017516">=</span>&nbsp;<span class="builtinfunc" id="4017518">append</span><span class="op" id="4017524">(</span><span class="ident" id="4017525"><a href="/gostd/encoding/json/encode.go.html#4016059">fields</a></span><span class="op" id="4017531">,</span>&nbsp;<span class="ident" id="4017533"><a href="/gostd/encoding/json/encode.go.html#4016059">fields</a></span><span class="op" id="4017539">[</span><span class="builtinfunc" id="4017540">len</span><span class="op" id="4017543">(</span><span class="ident" id="4017544"><a href="/gostd/encoding/json/encode.go.html#4016059">fields</a></span><span class="op" id="4017550">)</span><span class="op" id="4017551">-</span><span class="num" id="4017552">1</span><span class="op" id="4017553">]</span><span class="op" id="4017554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4017561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4017568">continue</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4017581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4017588">//&nbsp;Record&nbsp;new&nbsp;anonymous&nbsp;struct&nbsp;to&nbsp;explore&nbsp;in&nbsp;next&nbsp;round.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017649"><a href="/gostd/encoding/json/encode.go.html#4015915">nextCount</a></span><span class="op" id="4017658">[</span><span class="ident" id="4017659"><a href="/gostd/encoding/json/encode.go.html#4016702">ft</a></span><span class="op" id="4017661">]</span><span class="op" id="4017662">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4017669">if</span>&nbsp;<span class="ident" id="4017672"><a href="/gostd/encoding/json/encode.go.html#4015915">nextCount</a></span><span class="op" id="4017681">[</span><span class="ident" id="4017682"><a href="/gostd/encoding/json/encode.go.html#4016702">ft</a></span><span class="op" id="4017684">]</span>&nbsp;<span class="op" id="4017686">==</span>&nbsp;<span class="num" id="4017689">1</span>&nbsp;<span class="op" id="4017691">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017698"><a href="/gostd/encoding/json/encode.go.html#4015796">next</a></span>&nbsp;<span class="op" id="4017703">=</span>&nbsp;<span class="builtinfunc" id="4017705">append</span><span class="op" id="4017711">(</span><span class="ident" id="4017712"><a href="/gostd/encoding/json/encode.go.html#4015796">next</a></span><span class="op" id="4017716">,</span>&nbsp;<span class="ident" id="4017718"><a href="/gostd/encoding/json/encode.go.html#4014382">fillField</a></span><span class="op" id="4017727">(</span><span class="ident" id="4017728"><a href="/gostd/encoding/json/encode.go.html#4014134">field</a></span><span class="op" id="4017733">{</span><span class="ident" id="4017734"><a href="/gostd/encoding/json/encode.go.html#4014150">name</a></span><span class="op" id="4017738">:</span>&nbsp;<span class="ident" id="4017740"><a href="/gostd/encoding/json/encode.go.html#4016702">ft</a></span><span class="op" id="4017742">.</span><span class="ident" id="4017743"><a href="/gostd/reflect/type.go.html#2782837">Name</a></span><span class="op" id="4017747">(</span><span class="op" id="4017748">)</span><span class="op" id="4017749">,</span>&nbsp;<span class="ident" id="4017751"><a href="/gostd/encoding/json/encode.go.html#4014302">index</a></span><span class="op" id="4017756">:</span>&nbsp;<span class="ident" id="4017758"><a href="/gostd/encoding/json/encode.go.html#4016607">index</a></span><span class="op" id="4017763">,</span>&nbsp;<span class="ident" id="4017765"><a href="/gostd/encoding/json/encode.go.html#4014319">typ</a></span><span class="op" id="4017768">:</span>&nbsp;<span class="ident" id="4017770"><a href="/gostd/encoding/json/encode.go.html#4016702">ft</a></span><span class="op" id="4017772">}</span><span class="op" id="4017773">)</span><span class="op" id="4017774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4017780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4017785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4017789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4017792">}</span><br>
<span class="lineno">1080</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4017796"><a href="/gostd/encoding/json/encode.go.html#3990245">sort</a></span><span class="op" id="4017800">.</span><span class="ident" id="4017801"><a href="/gostd/sort/sort.go.html#2015380">Sort</a></span><span class="op" id="4017805">(</span><span class="ident" id="4017806"><a href="/gostd/encoding/json/encode.go.html#4014648">byName</a></span><span class="op" id="4017812">(</span><span class="ident" id="4017813"><a href="/gostd/encoding/json/encode.go.html#4016059">fields</a></span><span class="op" id="4017819">)</span><span class="op" id="4017820">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4017824">//&nbsp;Delete&nbsp;all&nbsp;fields&nbsp;that&nbsp;are&nbsp;hidden&nbsp;by&nbsp;the&nbsp;Go&nbsp;rules&nbsp;for&nbsp;embedded&nbsp;fields,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4017899">//&nbsp;except&nbsp;that&nbsp;fields&nbsp;with&nbsp;JSON&nbsp;tags&nbsp;are&nbsp;promoted.</span><br>
<span class="lineno">1085</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4017952">//&nbsp;The&nbsp;fields&nbsp;are&nbsp;sorted&nbsp;in&nbsp;primary&nbsp;order&nbsp;of&nbsp;name,&nbsp;secondary&nbsp;order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4018020">//&nbsp;of&nbsp;field&nbsp;index&nbsp;length.&nbsp;Loop&nbsp;over&nbsp;names;&nbsp;for&nbsp;each&nbsp;name,&nbsp;delete</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4018086">//&nbsp;hidden&nbsp;fields&nbsp;by&nbsp;choosing&nbsp;the&nbsp;one&nbsp;dominant&nbsp;field&nbsp;that&nbsp;survives.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4018154">out</span>&nbsp;<span class="op" id="4018158">:=</span>&nbsp;<span class="ident" id="4018161"><a href="/gostd/encoding/json/encode.go.html#4016059">fields</a></span><span class="op" id="4018167">[</span><span class="op" id="4018168">:</span><span class="num" id="4018169">0</span><span class="op" id="4018170">]</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4018173">for</span>&nbsp;<span class="ident" id="4018177">advance</span><span class="op" id="4018184">,</span>&nbsp;<span class="ident" id="4018186">i</span>&nbsp;<span class="op" id="4018188">:=</span>&nbsp;<span class="num" id="4018191">0</span><span class="op" id="4018192">,</span>&nbsp;<span class="num" id="4018194">0</span><span class="op" id="4018195">;</span>&nbsp;<span class="ident" id="4018197"><a href="/gostd/encoding/json/encode.go.html#4018186">i</a></span>&nbsp;<span class="op" id="4018199">&lt;</span>&nbsp;<span class="builtinfunc" id="4018201">len</span><span class="op" id="4018204">(</span><span class="ident" id="4018205"><a href="/gostd/encoding/json/encode.go.html#4016059">fields</a></span><span class="op" id="4018211">)</span><span class="op" id="4018212">;</span>&nbsp;<span class="ident" id="4018214"><a href="/gostd/encoding/json/encode.go.html#4018186">i</a></span>&nbsp;<span class="op" id="4018216">+=</span>&nbsp;<span class="ident" id="4018219"><a href="/gostd/encoding/json/encode.go.html#4018177">advance</a></span>&nbsp;<span class="op" id="4018227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4018231">//&nbsp;One&nbsp;iteration&nbsp;per&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4018260">//&nbsp;Find&nbsp;the&nbsp;sequence&nbsp;of&nbsp;fields&nbsp;with&nbsp;the&nbsp;name&nbsp;of&nbsp;this&nbsp;first&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4018328">fi</span>&nbsp;<span class="op" id="4018331">:=</span>&nbsp;<span class="ident" id="4018334"><a href="/gostd/encoding/json/encode.go.html#4016059">fields</a></span><span class="op" id="4018340">[</span><span class="ident" id="4018341"><a href="/gostd/encoding/json/encode.go.html#4018186">i</a></span><span class="op" id="4018342">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4018346">name</span>&nbsp;<span class="op" id="4018351">:=</span>&nbsp;<span class="ident" id="4018354"><a href="/gostd/encoding/json/encode.go.html#4018328">fi</a></span><span class="op" id="4018356">.</span><span class="ident" id="4018357"><a href="/gostd/encoding/json/encode.go.html#4014150">name</a></span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4018364">for</span>&nbsp;<span class="ident" id="4018368"><a href="/gostd/encoding/json/encode.go.html#4018177">advance</a></span>&nbsp;<span class="op" id="4018376">=</span>&nbsp;<span class="num" id="4018378">1</span><span class="op" id="4018379">;</span>&nbsp;<span class="ident" id="4018381"><a href="/gostd/encoding/json/encode.go.html#4018186">i</a></span><span class="op" id="4018382">+</span><span class="ident" id="4018383"><a href="/gostd/encoding/json/encode.go.html#4018177">advance</a></span>&nbsp;<span class="op" id="4018391">&lt;</span>&nbsp;<span class="builtinfunc" id="4018393">len</span><span class="op" id="4018396">(</span><span class="ident" id="4018397"><a href="/gostd/encoding/json/encode.go.html#4016059">fields</a></span><span class="op" id="4018403">)</span><span class="op" id="4018404">;</span>&nbsp;<span class="ident" id="4018406"><a href="/gostd/encoding/json/encode.go.html#4018177">advance</a></span><span class="op" id="4018413">++</span>&nbsp;<span class="op" id="4018416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4018421">fj</span>&nbsp;<span class="op" id="4018424">:=</span>&nbsp;<span class="ident" id="4018427"><a href="/gostd/encoding/json/encode.go.html#4016059">fields</a></span><span class="op" id="4018433">[</span><span class="ident" id="4018434"><a href="/gostd/encoding/json/encode.go.html#4018186">i</a></span><span class="op" id="4018435">+</span><span class="ident" id="4018436"><a href="/gostd/encoding/json/encode.go.html#4018177">advance</a></span><span class="op" id="4018443">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4018448">if</span>&nbsp;<span class="ident" id="4018451"><a href="/gostd/encoding/json/encode.go.html#4018421">fj</a></span><span class="op" id="4018453">.</span><span class="ident" id="4018454"><a href="/gostd/encoding/json/encode.go.html#4014150">name</a></span>&nbsp;<span class="op" id="4018459">!=</span>&nbsp;<span class="ident" id="4018462"><a href="/gostd/encoding/json/encode.go.html#4018346">name</a></span>&nbsp;<span class="op" id="4018467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4018473">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4018482">}</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4018486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4018490">if</span>&nbsp;<span class="ident" id="4018493"><a href="/gostd/encoding/json/encode.go.html#4018177">advance</a></span>&nbsp;<span class="op" id="4018501">==</span>&nbsp;<span class="num" id="4018504">1</span>&nbsp;<span class="op" id="4018506">{</span>&nbsp;<span class="comment" id="4018508">//&nbsp;Only&nbsp;one&nbsp;field&nbsp;with&nbsp;this&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4018544"><a href="/gostd/encoding/json/encode.go.html#4018154">out</a></span>&nbsp;<span class="op" id="4018548">=</span>&nbsp;<span class="builtinfunc" id="4018550">append</span><span class="op" id="4018556">(</span><span class="ident" id="4018557"><a href="/gostd/encoding/json/encode.go.html#4018154">out</a></span><span class="op" id="4018560">,</span>&nbsp;<span class="ident" id="4018562"><a href="/gostd/encoding/json/encode.go.html#4018328">fi</a></span><span class="op" id="4018564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4018569">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4018580">}</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4018584">dominant</span><span class="op" id="4018592">,</span>&nbsp;<span class="ident" id="4018594">ok</span>&nbsp;<span class="op" id="4018597">:=</span>&nbsp;<span class="ident" id="4018600"><a href="/gostd/encoding/json/encode.go.html#4019102">dominantField</a></span><span class="op" id="4018613">(</span><span class="ident" id="4018614"><a href="/gostd/encoding/json/encode.go.html#4016059">fields</a></span><span class="op" id="4018620">[</span><span class="ident" id="4018621"><a href="/gostd/encoding/json/encode.go.html#4018186">i</a></span>&nbsp;<span class="op" id="4018623">:</span>&nbsp;<span class="ident" id="4018625"><a href="/gostd/encoding/json/encode.go.html#4018186">i</a></span><span class="op" id="4018626">+</span><span class="ident" id="4018627"><a href="/gostd/encoding/json/encode.go.html#4018177">advance</a></span><span class="op" id="4018634">]</span><span class="op" id="4018635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4018639">if</span>&nbsp;<span class="ident" id="4018642"><a href="/gostd/encoding/json/encode.go.html#4018594">ok</a></span>&nbsp;<span class="op" id="4018645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4018650"><a href="/gostd/encoding/json/encode.go.html#4018154">out</a></span>&nbsp;<span class="op" id="4018654">=</span>&nbsp;<span class="builtinfunc" id="4018656">append</span><span class="op" id="4018662">(</span><span class="ident" id="4018663"><a href="/gostd/encoding/json/encode.go.html#4018154">out</a></span><span class="op" id="4018666">,</span>&nbsp;<span class="ident" id="4018668"><a href="/gostd/encoding/json/encode.go.html#4018584">dominant</a></span><span class="op" id="4018676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4018680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4018683">}</span><br>
<span class="lineno">1110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4018687"><a href="/gostd/encoding/json/encode.go.html#4016059">fields</a></span>&nbsp;<span class="op" id="4018694">=</span>&nbsp;<span class="ident" id="4018696"><a href="/gostd/encoding/json/encode.go.html#4018154">out</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4018701"><a href="/gostd/encoding/json/encode.go.html#3990245">sort</a></span><span class="op" id="4018705">.</span><span class="ident" id="4018706"><a href="/gostd/sort/sort.go.html#2015380">Sort</a></span><span class="op" id="4018710">(</span><span class="ident" id="4018711"><a href="/gostd/encoding/json/encode.go.html#4015085">byIndex</a></span><span class="op" id="4018718">(</span><span class="ident" id="4018719"><a href="/gostd/encoding/json/encode.go.html#4016059">fields</a></span><span class="op" id="4018725">)</span><span class="op" id="4018726">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4018730">return</span>&nbsp;<span class="ident" id="4018737"><a href="/gostd/encoding/json/encode.go.html#4016059">fields</a></span><br>
<span class="lineno">1115</span><span class="op" id="4018744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4018747">//&nbsp;dominantField&nbsp;looks&nbsp;through&nbsp;the&nbsp;fields,&nbsp;all&nbsp;of&nbsp;which&nbsp;are&nbsp;known&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4018816">//&nbsp;have&nbsp;the&nbsp;same&nbsp;name,&nbsp;to&nbsp;find&nbsp;the&nbsp;single&nbsp;field&nbsp;that&nbsp;dominates&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4018883">//&nbsp;others&nbsp;using&nbsp;Go&#39;s&nbsp;embedding&nbsp;rules,&nbsp;modified&nbsp;by&nbsp;the&nbsp;presence&nbsp;of</span><br>
<span class="lineno">1120</span><span class="comment" id="4018949">//&nbsp;JSON&nbsp;tags.&nbsp;If&nbsp;there&nbsp;are&nbsp;multiple&nbsp;top-level&nbsp;fields,&nbsp;the&nbsp;boolean</span><br>
<span class="lineno"></span><span class="comment" id="4019015">//&nbsp;will&nbsp;be&nbsp;false:&nbsp;This&nbsp;condition&nbsp;is&nbsp;an&nbsp;error&nbsp;in&nbsp;Go&nbsp;and&nbsp;we&nbsp;skip&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="4019082">//&nbsp;the&nbsp;fields.</span><br>
<span class="lineno"></span><span class="keyword" id="4019097">func</span>&nbsp;<span class="ident" id="4019102">dominantField</span><span class="op" id="4019115">(</span><span class="ident" id="4019116">fields</span>&nbsp;<span class="op" id="4019123">[</span><span class="op" id="4019124">]</span><span class="ident" id="4019125"><a href="/gostd/encoding/json/encode.go.html#4014134">field</a></span><span class="op" id="4019130">)</span>&nbsp;<span class="op" id="4019132">(</span><span class="ident" id="4019133"><a href="/gostd/encoding/json/encode.go.html#4014134">field</a></span><span class="op" id="4019138">,</span>&nbsp;<span class="builtintype" id="4019140">bool</span><span class="op" id="4019144">)</span>&nbsp;<span class="op" id="4019146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4019149">//&nbsp;The&nbsp;fields&nbsp;are&nbsp;sorted&nbsp;in&nbsp;increasing&nbsp;index-length&nbsp;order.&nbsp;The&nbsp;winner</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4019220">//&nbsp;must&nbsp;therefore&nbsp;be&nbsp;one&nbsp;with&nbsp;the&nbsp;shortest&nbsp;index&nbsp;length.&nbsp;Drop&nbsp;all</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4019287">//&nbsp;longer&nbsp;entries,&nbsp;which&nbsp;is&nbsp;easy:&nbsp;just&nbsp;truncate&nbsp;the&nbsp;slice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4019347">length</span>&nbsp;<span class="op" id="4019354">:=</span>&nbsp;<span class="builtinfunc" id="4019357">len</span><span class="op" id="4019360">(</span><span class="ident" id="4019361"><a href="/gostd/encoding/json/encode.go.html#4019116">fields</a></span><span class="op" id="4019367">[</span><span class="num" id="4019368">0</span><span class="op" id="4019369">]</span><span class="op" id="4019370">.</span><span class="ident" id="4019371"><a href="/gostd/encoding/json/encode.go.html#4014302">index</a></span><span class="op" id="4019376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4019379">tagged</span>&nbsp;<span class="op" id="4019386">:=</span>&nbsp;<span class="op" id="4019389">-</span><span class="num" id="4019390">1</span>&nbsp;<span class="comment" id="4019392">//&nbsp;Index&nbsp;of&nbsp;first&nbsp;tagged&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4019425">for</span>&nbsp;<span class="ident" id="4019429">i</span><span class="op" id="4019430">,</span>&nbsp;<span class="ident" id="4019432">f</span>&nbsp;<span class="op" id="4019434">:=</span>&nbsp;<span class="keyword" id="4019437">range</span>&nbsp;<span class="ident" id="4019443"><a href="/gostd/encoding/json/encode.go.html#4019116">fields</a></span>&nbsp;<span class="op" id="4019450">{</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4019454">if</span>&nbsp;<span class="builtinfunc" id="4019457">len</span><span class="op" id="4019460">(</span><span class="ident" id="4019461"><a href="/gostd/encoding/json/encode.go.html#4019432">f</a></span><span class="op" id="4019462">.</span><span class="ident" id="4019463"><a href="/gostd/encoding/json/encode.go.html#4014302">index</a></span><span class="op" id="4019468">)</span>&nbsp;<span class="op" id="4019470">&gt;</span>&nbsp;<span class="ident" id="4019472"><a href="/gostd/encoding/json/encode.go.html#4019347">length</a></span>&nbsp;<span class="op" id="4019479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4019484"><a href="/gostd/encoding/json/encode.go.html#4019116">fields</a></span>&nbsp;<span class="op" id="4019491">=</span>&nbsp;<span class="ident" id="4019493"><a href="/gostd/encoding/json/encode.go.html#4019116">fields</a></span><span class="op" id="4019499">[</span><span class="op" id="4019500">:</span><span class="ident" id="4019501"><a href="/gostd/encoding/json/encode.go.html#4019429">i</a></span><span class="op" id="4019502">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4019507">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4019515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4019519">if</span>&nbsp;<span class="ident" id="4019522"><a href="/gostd/encoding/json/encode.go.html#4019432">f</a></span><span class="op" id="4019523">.</span><span class="ident" id="4019524"><a href="/gostd/encoding/json/encode.go.html#4014286">tag</a></span>&nbsp;<span class="op" id="4019528">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4019533">if</span>&nbsp;<span class="ident" id="4019536"><a href="/gostd/encoding/json/encode.go.html#4019379">tagged</a></span>&nbsp;<span class="op" id="4019543">&gt;=</span>&nbsp;<span class="num" id="4019546">0</span>&nbsp;<span class="op" id="4019548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4019554">//&nbsp;Multiple&nbsp;tagged&nbsp;fields&nbsp;at&nbsp;the&nbsp;same&nbsp;level:&nbsp;conflict.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4019613">//&nbsp;Return&nbsp;no&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4019637">return</span>&nbsp;<span class="ident" id="4019644"><a href="/gostd/encoding/json/encode.go.html#4014134">field</a></span><span class="op" id="4019649">{</span><span class="op" id="4019650">}</span><span class="op" id="4019651">,</span>&nbsp;<span class="builtintype" id="4019653">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4019662">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4019667"><a href="/gostd/encoding/json/encode.go.html#4019379">tagged</a></span>&nbsp;<span class="op" id="4019674">=</span>&nbsp;<span class="ident" id="4019676"><a href="/gostd/encoding/json/encode.go.html#4019429">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4019680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4019683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4019686">if</span>&nbsp;<span class="ident" id="4019689"><a href="/gostd/encoding/json/encode.go.html#4019379">tagged</a></span>&nbsp;<span class="op" id="4019696">&gt;=</span>&nbsp;<span class="num" id="4019699">0</span>&nbsp;<span class="op" id="4019701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4019705">return</span>&nbsp;<span class="ident" id="4019712"><a href="/gostd/encoding/json/encode.go.html#4019116">fields</a></span><span class="op" id="4019718">[</span><span class="ident" id="4019719"><a href="/gostd/encoding/json/encode.go.html#4019379">tagged</a></span><span class="op" id="4019725">]</span><span class="op" id="4019726">,</span>&nbsp;<span class="builtintype" id="4019728">true</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4019734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4019737">//&nbsp;All&nbsp;remaining&nbsp;fields&nbsp;have&nbsp;the&nbsp;same&nbsp;length.&nbsp;If&nbsp;there&#39;s&nbsp;more&nbsp;than&nbsp;one,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4019810">//&nbsp;we&nbsp;have&nbsp;a&nbsp;conflict&nbsp;(two&nbsp;fields&nbsp;named&nbsp;&#34;X&#34;&nbsp;at&nbsp;the&nbsp;same&nbsp;level)&nbsp;and&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4019881">//&nbsp;return&nbsp;no&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4019902">if</span>&nbsp;<span class="builtinfunc" id="4019905">len</span><span class="op" id="4019908">(</span><span class="ident" id="4019909"><a href="/gostd/encoding/json/encode.go.html#4019116">fields</a></span><span class="op" id="4019915">)</span>&nbsp;<span class="op" id="4019917">&gt;</span>&nbsp;<span class="num" id="4019919">1</span>&nbsp;<span class="op" id="4019921">{</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4019925">return</span>&nbsp;<span class="ident" id="4019932"><a href="/gostd/encoding/json/encode.go.html#4014134">field</a></span><span class="op" id="4019937">{</span><span class="op" id="4019938">}</span><span class="op" id="4019939">,</span>&nbsp;<span class="builtintype" id="4019941">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4019948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4019951">return</span>&nbsp;<span class="ident" id="4019958"><a href="/gostd/encoding/json/encode.go.html#4019116">fields</a></span><span class="op" id="4019964">[</span><span class="num" id="4019965">0</span><span class="op" id="4019966">]</span><span class="op" id="4019967">,</span>&nbsp;<span class="builtintype" id="4019969">true</span><br>
<span class="lineno"></span><span class="op" id="4019974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1155</span><span class="keyword" id="4019977">var</span>&nbsp;<span class="ident" id="4019981">fieldCache</span>&nbsp;<span class="keyword" id="4019992">struct</span>&nbsp;<span class="op" id="4019999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4020002"><a href="/gostd/encoding/json/encode.go.html#3990275">sync</a></span><span class="op" id="4020006">.</span><span class="ident" id="4020007"><a href="/gostd/sync/rwmutex.go.html#1456076">RWMutex</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4020016">m</span>&nbsp;<span class="keyword" id="4020018">map</span><span class="op" id="4020021">[</span><span class="ident" id="4020022"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4020029">.</span><span class="ident" id="4020030"><a href="/gostd/reflect/type.go.html#2781467">Type</a></span><span class="op" id="4020034">]</span><span class="op" id="4020035">[</span><span class="op" id="4020036">]</span><span class="ident" id="4020037"><a href="/gostd/encoding/json/encode.go.html#4014134">field</a></span><br>
<span class="lineno"></span><span class="op" id="4020043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1160</span><span class="comment" id="4020046">//&nbsp;cachedTypeFields&nbsp;is&nbsp;like&nbsp;typeFields&nbsp;but&nbsp;uses&nbsp;a&nbsp;cache&nbsp;to&nbsp;avoid&nbsp;repeated&nbsp;work.</span><br>
<span class="lineno"></span><span class="keyword" id="4020126">func</span>&nbsp;<span class="ident" id="4020131">cachedTypeFields</span><span class="op" id="4020147">(</span><span class="ident" id="4020148">t</span>&nbsp;<span class="ident" id="4020150"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4020157">.</span><span class="ident" id="4020158"><a href="/gostd/reflect/type.go.html#2781467">Type</a></span><span class="op" id="4020162">)</span>&nbsp;<span class="op" id="4020164">[</span><span class="op" id="4020165">]</span><span class="ident" id="4020166"><a href="/gostd/encoding/json/encode.go.html#4014134">field</a></span>&nbsp;<span class="op" id="4020172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4020175"><a href="/gostd/encoding/json/encode.go.html#4019981">fieldCache</a></span><span class="op" id="4020185">.</span><span class="ident" id="4020186"><a href="/gostd/sync/rwmutex.go.html#1456490">RLock</a></span><span class="op" id="4020191">(</span><span class="op" id="4020192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4020195">f</span>&nbsp;<span class="op" id="4020197">:=</span>&nbsp;<span class="ident" id="4020200"><a href="/gostd/encoding/json/encode.go.html#4019981">fieldCache</a></span><span class="op" id="4020210">.</span><span class="ident" id="4020211"><a href="/gostd/encoding/json/encode.go.html#4020016">m</a></span><span class="op" id="4020212">[</span><span class="ident" id="4020213"><a href="/gostd/encoding/json/encode.go.html#4020148">t</a></span><span class="op" id="4020214">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4020217"><a href="/gostd/encoding/json/encode.go.html#4019981">fieldCache</a></span><span class="op" id="4020227">.</span><span class="ident" id="4020228"><a href="/gostd/sync/rwmutex.go.html#1456952">RUnlock</a></span><span class="op" id="4020235">(</span><span class="op" id="4020236">)</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4020239">if</span>&nbsp;<span class="ident" id="4020242"><a href="/gostd/encoding/json/encode.go.html#4020195">f</a></span>&nbsp;<span class="op" id="4020244">!=</span>&nbsp;<span class="builtintype" id="4020247">nil</span>&nbsp;<span class="op" id="4020251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4020255">return</span>&nbsp;<span class="ident" id="4020262"><a href="/gostd/encoding/json/encode.go.html#4020195">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4020265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4020269">//&nbsp;Compute&nbsp;fields&nbsp;without&nbsp;lock.</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4020302">//&nbsp;Might&nbsp;duplicate&nbsp;effort&nbsp;but&nbsp;won&#39;t&nbsp;hold&nbsp;other&nbsp;computations&nbsp;back.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4020369"><a href="/gostd/encoding/json/encode.go.html#4020195">f</a></span>&nbsp;<span class="op" id="4020371">=</span>&nbsp;<span class="ident" id="4020373"><a href="/gostd/encoding/json/encode.go.html#4015669">typeFields</a></span><span class="op" id="4020383">(</span><span class="ident" id="4020384"><a href="/gostd/encoding/json/encode.go.html#4020148">t</a></span><span class="op" id="4020385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4020388">if</span>&nbsp;<span class="ident" id="4020391"><a href="/gostd/encoding/json/encode.go.html#4020195">f</a></span>&nbsp;<span class="op" id="4020393">==</span>&nbsp;<span class="builtintype" id="4020396">nil</span>&nbsp;<span class="op" id="4020400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4020404"><a href="/gostd/encoding/json/encode.go.html#4020195">f</a></span>&nbsp;<span class="op" id="4020406">=</span>&nbsp;<span class="op" id="4020408">[</span><span class="op" id="4020409">]</span><span class="ident" id="4020410"><a href="/gostd/encoding/json/encode.go.html#4014134">field</a></span><span class="op" id="4020415">{</span><span class="op" id="4020416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4020419">}</span><br>
<span class="lineno">1175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4020423"><a href="/gostd/encoding/json/encode.go.html#4019981">fieldCache</a></span><span class="op" id="4020433">.</span><span class="ident" id="4020434"><a href="/gostd/sync/rwmutex.go.html#1457713">Lock</a></span><span class="op" id="4020438">(</span><span class="op" id="4020439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4020442">if</span>&nbsp;<span class="ident" id="4020445"><a href="/gostd/encoding/json/encode.go.html#4019981">fieldCache</a></span><span class="op" id="4020455">.</span><span class="ident" id="4020456"><a href="/gostd/encoding/json/encode.go.html#4020016">m</a></span>&nbsp;<span class="op" id="4020458">==</span>&nbsp;<span class="builtintype" id="4020461">nil</span>&nbsp;<span class="op" id="4020465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4020469"><a href="/gostd/encoding/json/encode.go.html#4019981">fieldCache</a></span><span class="op" id="4020479">.</span><span class="ident" id="4020480"><a href="/gostd/encoding/json/encode.go.html#4020016">m</a></span>&nbsp;<span class="op" id="4020482">=</span>&nbsp;<span class="keyword" id="4020484">map</span><span class="op" id="4020487">[</span><span class="ident" id="4020488"><a href="/gostd/encoding/json/encode.go.html#3990223">reflect</a></span><span class="op" id="4020495">.</span><span class="ident" id="4020496"><a href="/gostd/reflect/type.go.html#2781467">Type</a></span><span class="op" id="4020500">]</span><span class="op" id="4020501">[</span><span class="op" id="4020502">]</span><span class="ident" id="4020503"><a href="/gostd/encoding/json/encode.go.html#4014134">field</a></span><span class="op" id="4020508">{</span><span class="op" id="4020509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4020512">}</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4020515"><a href="/gostd/encoding/json/encode.go.html#4019981">fieldCache</a></span><span class="op" id="4020525">.</span><span class="ident" id="4020526"><a href="/gostd/encoding/json/encode.go.html#4020016">m</a></span><span class="op" id="4020527">[</span><span class="ident" id="4020528"><a href="/gostd/encoding/json/encode.go.html#4020148">t</a></span><span class="op" id="4020529">]</span>&nbsp;<span class="op" id="4020531">=</span>&nbsp;<span class="ident" id="4020533"><a href="/gostd/encoding/json/encode.go.html#4020195">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4020536"><a href="/gostd/encoding/json/encode.go.html#4019981">fieldCache</a></span><span class="op" id="4020546">.</span><span class="ident" id="4020547"><a href="/gostd/sync/rwmutex.go.html#1458554">Unlock</a></span><span class="op" id="4020553">(</span><span class="op" id="4020554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4020557">return</span>&nbsp;<span class="ident" id="4020564"><a href="/gostd/encoding/json/encode.go.html#4020195">f</a></span><br>
<span class="lineno"></span><span class="op" id="4020566">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
