<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4119025">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4119081">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4119135">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4119186">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4119251">package</span>&nbsp;<span class="ident" id="4119259">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4119264">import</span>&nbsp;<span class="op" id="4119271">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4119274">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4119284">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="4119291">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4119294">var</span>&nbsp;<span class="ident" id="4119298">onceReadProtocols</span>&nbsp;<span class="ident" id="4119316">sync</span><span class="op" id="4119320">.</span><span class="ident" id="4119321">Once</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="4119327">//&nbsp;readProtocols&nbsp;loads&nbsp;contents&nbsp;of&nbsp;/etc/protocols&nbsp;into&nbsp;protocols&nbsp;map</span><br>
<span class="lineno"></span><span class="comment" id="4119396">//&nbsp;for&nbsp;quick&nbsp;access.</span><br>
<span class="lineno"></span><span class="keyword" id="4119417">func</span>&nbsp;<span class="ident" id="4119422">readProtocols</span><span class="op" id="4119435">(</span><span class="op" id="4119436">)</span>&nbsp;<span class="op" id="4119438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4119441">if</span>&nbsp;<span class="ident" id="4119444">file</span><span class="op" id="4119448">,</span>&nbsp;<span class="ident" id="4119450">err</span>&nbsp;<span class="op" id="4119454">:=</span>&nbsp;<span class="ident" id="4119457">open</span><span class="op" id="4119461">(</span><span class="string" id="4119462">&#34;/etc/protocols&#34;</span><span class="op" id="4119478">)</span><span class="op" id="4119479">;</span>&nbsp;<span class="ident" id="4119481">err</span>&nbsp;<span class="op" id="4119485">==</span>&nbsp;<span class="ident" id="4119488">nil</span>&nbsp;<span class="op" id="4119492">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4119496">for</span>&nbsp;<span class="ident" id="4119500">line</span><span class="op" id="4119504">,</span>&nbsp;<span class="ident" id="4119506">ok</span>&nbsp;<span class="op" id="4119509">:=</span>&nbsp;<span class="ident" id="4119512">file</span><span class="op" id="4119516">.</span><span class="ident" id="4119517">readLine</span><span class="op" id="4119525">(</span><span class="op" id="4119526">)</span><span class="op" id="4119527">;</span>&nbsp;<span class="ident" id="4119529">ok</span><span class="op" id="4119531">;</span>&nbsp;<span class="ident" id="4119533">line</span><span class="op" id="4119537">,</span>&nbsp;<span class="ident" id="4119539">ok</span>&nbsp;<span class="op" id="4119542">=</span>&nbsp;<span class="ident" id="4119544">file</span><span class="op" id="4119548">.</span><span class="ident" id="4119549">readLine</span><span class="op" id="4119557">(</span><span class="op" id="4119558">)</span>&nbsp;<span class="op" id="4119560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119565">//&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;TCP&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;transmission&nbsp;control&nbsp;protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4119621">if</span>&nbsp;<span class="ident" id="4119624">i</span>&nbsp;<span class="op" id="4119626">:=</span>&nbsp;<span class="ident" id="4119629">byteIndex</span><span class="op" id="4119638">(</span><span class="ident" id="4119639">line</span><span class="op" id="4119643">,</span>&nbsp;<span class="string" id="4119645">&#39;#&#39;</span><span class="op" id="4119648">)</span><span class="op" id="4119649">;</span>&nbsp;<span class="ident" id="4119651">i</span>&nbsp;<span class="op" id="4119653">&gt;=</span>&nbsp;<span class="num" id="4119656">0</span>&nbsp;<span class="op" id="4119658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119664">line</span>&nbsp;<span class="op" id="4119669">=</span>&nbsp;<span class="ident" id="4119671">line</span><span class="op" id="4119675">[</span><span class="num" id="4119676">0</span><span class="op" id="4119677">:</span><span class="ident" id="4119678">i</span><span class="op" id="4119679">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4119684">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119689">f</span>&nbsp;<span class="op" id="4119691">:=</span>&nbsp;<span class="ident" id="4119694">getFields</span><span class="op" id="4119703">(</span><span class="ident" id="4119704">line</span><span class="op" id="4119708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4119713">if</span>&nbsp;<span class="builtinfunc" id="4119716">len</span><span class="op" id="4119719">(</span><span class="ident" id="4119720">f</span><span class="op" id="4119721">)</span>&nbsp;<span class="op" id="4119723">&lt;</span>&nbsp;<span class="num" id="4119725">2</span>&nbsp;<span class="op" id="4119727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4119733">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4119745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4119750">if</span>&nbsp;<span class="ident" id="4119753">proto</span><span class="op" id="4119758">,</span>&nbsp;<span class="ident" id="4119760">_</span><span class="op" id="4119761">,</span>&nbsp;<span class="ident" id="4119763">ok</span>&nbsp;<span class="op" id="4119766">:=</span>&nbsp;<span class="ident" id="4119769">dtoi</span><span class="op" id="4119773">(</span><span class="ident" id="4119774">f</span><span class="op" id="4119775">[</span><span class="num" id="4119776">1</span><span class="op" id="4119777">]</span><span class="op" id="4119778">,</span>&nbsp;<span class="num" id="4119780">0</span><span class="op" id="4119781">)</span><span class="op" id="4119782">;</span>&nbsp;<span class="ident" id="4119784">ok</span>&nbsp;<span class="op" id="4119787">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4119793">if</span>&nbsp;<span class="ident" id="4119796">_</span><span class="op" id="4119797">,</span>&nbsp;<span class="ident" id="4119799">ok</span>&nbsp;<span class="op" id="4119802">:=</span>&nbsp;<span class="ident" id="4119805">protocols</span><span class="op" id="4119814">[</span><span class="ident" id="4119815">f</span><span class="op" id="4119816">[</span><span class="num" id="4119817">0</span><span class="op" id="4119818">]</span><span class="op" id="4119819">]</span><span class="op" id="4119820">;</span>&nbsp;<span class="op" id="4119822">!</span><span class="ident" id="4119823">ok</span>&nbsp;<span class="op" id="4119826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119833">protocols</span><span class="op" id="4119842">[</span><span class="ident" id="4119843">f</span><span class="op" id="4119844">[</span><span class="num" id="4119845">0</span><span class="op" id="4119846">]</span><span class="op" id="4119847">]</span>&nbsp;<span class="op" id="4119849">=</span>&nbsp;<span class="ident" id="4119851">proto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4119861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4119867">for</span>&nbsp;<span class="ident" id="4119871">_</span><span class="op" id="4119872">,</span>&nbsp;<span class="ident" id="4119874">alias</span>&nbsp;<span class="op" id="4119880">:=</span>&nbsp;<span class="keyword" id="4119883">range</span>&nbsp;<span class="ident" id="4119889">f</span><span class="op" id="4119890">[</span><span class="num" id="4119891">2</span><span class="op" id="4119892">:</span><span class="op" id="4119893">]</span>&nbsp;<span class="op" id="4119895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4119902">if</span>&nbsp;<span class="ident" id="4119905">_</span><span class="op" id="4119906">,</span>&nbsp;<span class="ident" id="4119908">ok</span>&nbsp;<span class="op" id="4119911">:=</span>&nbsp;<span class="ident" id="4119914">protocols</span><span class="op" id="4119923">[</span><span class="ident" id="4119924">alias</span><span class="op" id="4119929">]</span><span class="op" id="4119930">;</span>&nbsp;<span class="op" id="4119932">!</span><span class="ident" id="4119933">ok</span>&nbsp;<span class="op" id="4119936">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119944">protocols</span><span class="op" id="4119953">[</span><span class="ident" id="4119954">alias</span><span class="op" id="4119959">]</span>&nbsp;<span class="op" id="4119961">=</span>&nbsp;<span class="ident" id="4119963">proto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4119974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4119980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4119985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4119989">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119993">file</span><span class="op" id="4119997">.</span><span class="builtinfunc" id="4119998">close</span><span class="op" id="4120003">(</span><span class="op" id="4120004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4120007">}</span><br>
<span class="lineno"></span><span class="op" id="4120009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4120012">//&nbsp;lookupProtocol&nbsp;looks&nbsp;up&nbsp;IP&nbsp;protocol&nbsp;name&nbsp;in&nbsp;/etc/protocols&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="4120078">//&nbsp;returns&nbsp;correspondent&nbsp;protocol&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="4120120">func</span>&nbsp;<span class="ident" id="4120125">lookupProtocol</span><span class="op" id="4120139">(</span><span class="ident" id="4120140">name</span>&nbsp;<span class="builtintype" id="4120145">string</span><span class="op" id="4120151">)</span>&nbsp;<span class="op" id="4120153">(</span><span class="ident" id="4120154">proto</span>&nbsp;<span class="builtintype" id="4120160">int</span><span class="op" id="4120163">,</span>&nbsp;<span class="ident" id="4120165">err</span>&nbsp;<span class="builtintype" id="4120169">error</span><span class="op" id="4120174">)</span>&nbsp;<span class="op" id="4120176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120179">onceReadProtocols</span><span class="op" id="4120196">.</span><span class="ident" id="4120197">Do</span><span class="op" id="4120199">(</span><span class="ident" id="4120200">readProtocols</span><span class="op" id="4120213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120216">proto</span><span class="op" id="4120221">,</span>&nbsp;<span class="ident" id="4120223">found</span>&nbsp;<span class="op" id="4120229">:=</span>&nbsp;<span class="ident" id="4120232">protocols</span><span class="op" id="4120241">[</span><span class="ident" id="4120242">name</span><span class="op" id="4120246">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120249">if</span>&nbsp;<span class="op" id="4120252">!</span><span class="ident" id="4120253">found</span>&nbsp;<span class="op" id="4120259">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120263">return</span>&nbsp;<span class="num" id="4120270">0</span><span class="op" id="4120271">,</span>&nbsp;<span class="ident" id="4120273">errors</span><span class="op" id="4120279">.</span><span class="ident" id="4120280">New</span><span class="op" id="4120283">(</span><span class="string" id="4120284">&#34;unknown&nbsp;IP&nbsp;protocol&nbsp;specified:&nbsp;&#34;</span>&nbsp;<span class="op" id="4120318">+</span>&nbsp;<span class="ident" id="4120320">name</span><span class="op" id="4120324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4120327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120330">return</span><br>
<span class="lineno"></span><span class="op" id="4120337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="4120340">func</span>&nbsp;<span class="ident" id="4120345">lookupHost</span><span class="op" id="4120355">(</span><span class="ident" id="4120356">host</span>&nbsp;<span class="builtintype" id="4120361">string</span><span class="op" id="4120367">)</span>&nbsp;<span class="op" id="4120369">(</span><span class="ident" id="4120370">addrs</span>&nbsp;<span class="op" id="4120376">[</span><span class="op" id="4120377">]</span><span class="builtintype" id="4120378">string</span><span class="op" id="4120384">,</span>&nbsp;<span class="ident" id="4120386">err</span>&nbsp;<span class="builtintype" id="4120390">error</span><span class="op" id="4120395">)</span>&nbsp;<span class="op" id="4120397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120400">addrs</span><span class="op" id="4120405">,</span>&nbsp;<span class="ident" id="4120407">err</span><span class="op" id="4120410">,</span>&nbsp;<span class="ident" id="4120412">ok</span>&nbsp;<span class="op" id="4120415">:=</span>&nbsp;<span class="ident" id="4120418">cgoLookupHost</span><span class="op" id="4120431">(</span><span class="ident" id="4120432">host</span><span class="op" id="4120436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120439">if</span>&nbsp;<span class="op" id="4120442">!</span><span class="ident" id="4120443">ok</span>&nbsp;<span class="op" id="4120446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120450">addrs</span><span class="op" id="4120455">,</span>&nbsp;<span class="ident" id="4120457">err</span>&nbsp;<span class="op" id="4120461">=</span>&nbsp;<span class="ident" id="4120463">goLookupHost</span><span class="op" id="4120475">(</span><span class="ident" id="4120476">host</span><span class="op" id="4120480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4120483">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120486">return</span><br>
<span class="lineno"></span><span class="op" id="4120493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4120496">func</span>&nbsp;<span class="ident" id="4120501">lookupIP</span><span class="op" id="4120509">(</span><span class="ident" id="4120510">host</span>&nbsp;<span class="builtintype" id="4120515">string</span><span class="op" id="4120521">)</span>&nbsp;<span class="op" id="4120523">(</span><span class="ident" id="4120524">addrs</span>&nbsp;<span class="op" id="4120530">[</span><span class="op" id="4120531">]</span><span class="ident" id="4120532">IP</span><span class="op" id="4120534">,</span>&nbsp;<span class="ident" id="4120536">err</span>&nbsp;<span class="builtintype" id="4120540">error</span><span class="op" id="4120545">)</span>&nbsp;<span class="op" id="4120547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120550">addrs</span><span class="op" id="4120555">,</span>&nbsp;<span class="ident" id="4120557">err</span><span class="op" id="4120560">,</span>&nbsp;<span class="ident" id="4120562">ok</span>&nbsp;<span class="op" id="4120565">:=</span>&nbsp;<span class="ident" id="4120568">cgoLookupIP</span><span class="op" id="4120579">(</span><span class="ident" id="4120580">host</span><span class="op" id="4120584">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120587">if</span>&nbsp;<span class="op" id="4120590">!</span><span class="ident" id="4120591">ok</span>&nbsp;<span class="op" id="4120594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120598">addrs</span><span class="op" id="4120603">,</span>&nbsp;<span class="ident" id="4120605">err</span>&nbsp;<span class="op" id="4120609">=</span>&nbsp;<span class="ident" id="4120611">goLookupIP</span><span class="op" id="4120621">(</span><span class="ident" id="4120622">host</span><span class="op" id="4120626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4120629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120632">return</span><br>
<span class="lineno"></span><span class="op" id="4120639">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="4120642">func</span>&nbsp;<span class="ident" id="4120647">lookupPort</span><span class="op" id="4120657">(</span><span class="ident" id="4120658">network</span><span class="op" id="4120665">,</span>&nbsp;<span class="ident" id="4120667">service</span>&nbsp;<span class="builtintype" id="4120675">string</span><span class="op" id="4120681">)</span>&nbsp;<span class="op" id="4120683">(</span><span class="ident" id="4120684">port</span>&nbsp;<span class="builtintype" id="4120689">int</span><span class="op" id="4120692">,</span>&nbsp;<span class="ident" id="4120694">err</span>&nbsp;<span class="builtintype" id="4120698">error</span><span class="op" id="4120703">)</span>&nbsp;<span class="op" id="4120705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120708">port</span><span class="op" id="4120712">,</span>&nbsp;<span class="ident" id="4120714">err</span><span class="op" id="4120717">,</span>&nbsp;<span class="ident" id="4120719">ok</span>&nbsp;<span class="op" id="4120722">:=</span>&nbsp;<span class="ident" id="4120725">cgoLookupPort</span><span class="op" id="4120738">(</span><span class="ident" id="4120739">network</span><span class="op" id="4120746">,</span>&nbsp;<span class="ident" id="4120748">service</span><span class="op" id="4120755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120758">if</span>&nbsp;<span class="op" id="4120761">!</span><span class="ident" id="4120762">ok</span>&nbsp;<span class="op" id="4120765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120769">port</span><span class="op" id="4120773">,</span>&nbsp;<span class="ident" id="4120775">err</span>&nbsp;<span class="op" id="4120779">=</span>&nbsp;<span class="ident" id="4120781">goLookupPort</span><span class="op" id="4120793">(</span><span class="ident" id="4120794">network</span><span class="op" id="4120801">,</span>&nbsp;<span class="ident" id="4120803">service</span><span class="op" id="4120810">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4120813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120816">return</span><br>
<span class="lineno"></span><span class="op" id="4120823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4120826">func</span>&nbsp;<span class="ident" id="4120831">lookupCNAME</span><span class="op" id="4120842">(</span><span class="ident" id="4120843">name</span>&nbsp;<span class="builtintype" id="4120848">string</span><span class="op" id="4120854">)</span>&nbsp;<span class="op" id="4120856">(</span><span class="ident" id="4120857">cname</span>&nbsp;<span class="builtintype" id="4120863">string</span><span class="op" id="4120869">,</span>&nbsp;<span class="ident" id="4120871">err</span>&nbsp;<span class="builtintype" id="4120875">error</span><span class="op" id="4120880">)</span>&nbsp;<span class="op" id="4120882">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120885">cname</span><span class="op" id="4120890">,</span>&nbsp;<span class="ident" id="4120892">err</span><span class="op" id="4120895">,</span>&nbsp;<span class="ident" id="4120897">ok</span>&nbsp;<span class="op" id="4120900">:=</span>&nbsp;<span class="ident" id="4120903">cgoLookupCNAME</span><span class="op" id="4120917">(</span><span class="ident" id="4120918">name</span><span class="op" id="4120922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120925">if</span>&nbsp;<span class="op" id="4120928">!</span><span class="ident" id="4120929">ok</span>&nbsp;<span class="op" id="4120932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120936">cname</span><span class="op" id="4120941">,</span>&nbsp;<span class="ident" id="4120943">err</span>&nbsp;<span class="op" id="4120947">=</span>&nbsp;<span class="ident" id="4120949">goLookupCNAME</span><span class="op" id="4120962">(</span><span class="ident" id="4120963">name</span><span class="op" id="4120967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4120970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120973">return</span><br>
<span class="lineno">85</span><span class="op" id="4120980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4120983">func</span>&nbsp;<span class="ident" id="4120988">lookupSRV</span><span class="op" id="4120997">(</span><span class="ident" id="4120998">service</span><span class="op" id="4121005">,</span>&nbsp;<span class="ident" id="4121007">proto</span><span class="op" id="4121012">,</span>&nbsp;<span class="ident" id="4121014">name</span>&nbsp;<span class="builtintype" id="4121019">string</span><span class="op" id="4121025">)</span>&nbsp;<span class="op" id="4121027">(</span><span class="ident" id="4121028">cname</span>&nbsp;<span class="builtintype" id="4121034">string</span><span class="op" id="4121040">,</span>&nbsp;<span class="ident" id="4121042">addrs</span>&nbsp;<span class="op" id="4121048">[</span><span class="op" id="4121049">]</span><span class="op" id="4121050">*</span><span class="ident" id="4121051">SRV</span><span class="op" id="4121054">,</span>&nbsp;<span class="ident" id="4121056">err</span>&nbsp;<span class="builtintype" id="4121060">error</span><span class="op" id="4121065">)</span>&nbsp;<span class="op" id="4121067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121070">var</span>&nbsp;<span class="ident" id="4121074">target</span>&nbsp;<span class="builtintype" id="4121081">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121089">if</span>&nbsp;<span class="ident" id="4121092">service</span>&nbsp;<span class="op" id="4121100">==</span>&nbsp;<span class="string" id="4121103">&#34;&#34;</span>&nbsp;<span class="op" id="4121106">&amp;&amp;</span>&nbsp;<span class="ident" id="4121109">proto</span>&nbsp;<span class="op" id="4121115">==</span>&nbsp;<span class="string" id="4121118">&#34;&#34;</span>&nbsp;<span class="op" id="4121121">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121125">target</span>&nbsp;<span class="op" id="4121132">=</span>&nbsp;<span class="ident" id="4121134">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4121140">}</span>&nbsp;<span class="keyword" id="4121142">else</span>&nbsp;<span class="op" id="4121147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121151">target</span>&nbsp;<span class="op" id="4121158">=</span>&nbsp;<span class="string" id="4121160">&#34;_&#34;</span>&nbsp;<span class="op" id="4121164">+</span>&nbsp;<span class="ident" id="4121166">service</span>&nbsp;<span class="op" id="4121174">+</span>&nbsp;<span class="string" id="4121176">&#34;._&#34;</span>&nbsp;<span class="op" id="4121181">+</span>&nbsp;<span class="ident" id="4121183">proto</span>&nbsp;<span class="op" id="4121189">+</span>&nbsp;<span class="string" id="4121191">&#34;.&#34;</span>&nbsp;<span class="op" id="4121195">+</span>&nbsp;<span class="ident" id="4121197">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4121203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121206">var</span>&nbsp;<span class="ident" id="4121210">records</span>&nbsp;<span class="op" id="4121218">[</span><span class="op" id="4121219">]</span><span class="ident" id="4121220">dnsRR</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121227">cname</span><span class="op" id="4121232">,</span>&nbsp;<span class="ident" id="4121234">records</span><span class="op" id="4121241">,</span>&nbsp;<span class="ident" id="4121243">err</span>&nbsp;<span class="op" id="4121247">=</span>&nbsp;<span class="ident" id="4121249">lookup</span><span class="op" id="4121255">(</span><span class="ident" id="4121256">target</span><span class="op" id="4121262">,</span>&nbsp;<span class="ident" id="4121264">dnsTypeSRV</span><span class="op" id="4121274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121277">if</span>&nbsp;<span class="ident" id="4121280">err</span>&nbsp;<span class="op" id="4121284">!=</span>&nbsp;<span class="ident" id="4121287">nil</span>&nbsp;<span class="op" id="4121291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121295">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4121303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121306">addrs</span>&nbsp;<span class="op" id="4121312">=</span>&nbsp;<span class="builtinfunc" id="4121314">make</span><span class="op" id="4121318">(</span><span class="op" id="4121319">[</span><span class="op" id="4121320">]</span><span class="op" id="4121321">*</span><span class="ident" id="4121322">SRV</span><span class="op" id="4121325">,</span>&nbsp;<span class="builtinfunc" id="4121327">len</span><span class="op" id="4121330">(</span><span class="ident" id="4121331">records</span><span class="op" id="4121338">)</span><span class="op" id="4121339">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121342">for</span>&nbsp;<span class="ident" id="4121346">i</span><span class="op" id="4121347">,</span>&nbsp;<span class="ident" id="4121349">rr</span>&nbsp;<span class="op" id="4121352">:=</span>&nbsp;<span class="keyword" id="4121355">range</span>&nbsp;<span class="ident" id="4121361">records</span>&nbsp;<span class="op" id="4121369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121373">r</span>&nbsp;<span class="op" id="4121375">:=</span>&nbsp;<span class="ident" id="4121378">rr</span><span class="op" id="4121380">.</span><span class="op" id="4121381">(</span><span class="op" id="4121382">*</span><span class="ident" id="4121383">dnsRR_SRV</span><span class="op" id="4121392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121396">addrs</span><span class="op" id="4121401">[</span><span class="ident" id="4121402">i</span><span class="op" id="4121403">]</span>&nbsp;<span class="op" id="4121405">=</span>&nbsp;<span class="op" id="4121407">&amp;</span><span class="ident" id="4121408">SRV</span><span class="op" id="4121411">{</span><span class="ident" id="4121412">r</span><span class="op" id="4121413">.</span><span class="ident" id="4121414">Target</span><span class="op" id="4121420">,</span>&nbsp;<span class="ident" id="4121422">r</span><span class="op" id="4121423">.</span><span class="ident" id="4121424">Port</span><span class="op" id="4121428">,</span>&nbsp;<span class="ident" id="4121430">r</span><span class="op" id="4121431">.</span><span class="ident" id="4121432">Priority</span><span class="op" id="4121440">,</span>&nbsp;<span class="ident" id="4121442">r</span><span class="op" id="4121443">.</span><span class="ident" id="4121444">Weight</span><span class="op" id="4121450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4121453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121456">byPriorityWeight</span><span class="op" id="4121472">(</span><span class="ident" id="4121473">addrs</span><span class="op" id="4121478">)</span><span class="op" id="4121479">.</span><span class="ident" id="4121480">sort</span><span class="op" id="4121484">(</span><span class="op" id="4121485">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121488">return</span><br>
<span class="lineno"></span><span class="op" id="4121495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4121498">func</span>&nbsp;<span class="ident" id="4121503">lookupMX</span><span class="op" id="4121511">(</span><span class="ident" id="4121512">name</span>&nbsp;<span class="builtintype" id="4121517">string</span><span class="op" id="4121523">)</span>&nbsp;<span class="op" id="4121525">(</span><span class="ident" id="4121526">mx</span>&nbsp;<span class="op" id="4121529">[</span><span class="op" id="4121530">]</span><span class="op" id="4121531">*</span><span class="ident" id="4121532">MX</span><span class="op" id="4121534">,</span>&nbsp;<span class="ident" id="4121536">err</span>&nbsp;<span class="builtintype" id="4121540">error</span><span class="op" id="4121545">)</span>&nbsp;<span class="op" id="4121547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121550">_</span><span class="op" id="4121551">,</span>&nbsp;<span class="ident" id="4121553">records</span><span class="op" id="4121560">,</span>&nbsp;<span class="ident" id="4121562">err</span>&nbsp;<span class="op" id="4121566">:=</span>&nbsp;<span class="ident" id="4121569">lookup</span><span class="op" id="4121575">(</span><span class="ident" id="4121576">name</span><span class="op" id="4121580">,</span>&nbsp;<span class="ident" id="4121582">dnsTypeMX</span><span class="op" id="4121591">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121594">if</span>&nbsp;<span class="ident" id="4121597">err</span>&nbsp;<span class="op" id="4121601">!=</span>&nbsp;<span class="ident" id="4121604">nil</span>&nbsp;<span class="op" id="4121608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121612">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4121620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121623">mx</span>&nbsp;<span class="op" id="4121626">=</span>&nbsp;<span class="builtinfunc" id="4121628">make</span><span class="op" id="4121632">(</span><span class="op" id="4121633">[</span><span class="op" id="4121634">]</span><span class="op" id="4121635">*</span><span class="ident" id="4121636">MX</span><span class="op" id="4121638">,</span>&nbsp;<span class="builtinfunc" id="4121640">len</span><span class="op" id="4121643">(</span><span class="ident" id="4121644">records</span><span class="op" id="4121651">)</span><span class="op" id="4121652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121655">for</span>&nbsp;<span class="ident" id="4121659">i</span><span class="op" id="4121660">,</span>&nbsp;<span class="ident" id="4121662">rr</span>&nbsp;<span class="op" id="4121665">:=</span>&nbsp;<span class="keyword" id="4121668">range</span>&nbsp;<span class="ident" id="4121674">records</span>&nbsp;<span class="op" id="4121682">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121686">r</span>&nbsp;<span class="op" id="4121688">:=</span>&nbsp;<span class="ident" id="4121691">rr</span><span class="op" id="4121693">.</span><span class="op" id="4121694">(</span><span class="op" id="4121695">*</span><span class="ident" id="4121696">dnsRR_MX</span><span class="op" id="4121704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121708">mx</span><span class="op" id="4121710">[</span><span class="ident" id="4121711">i</span><span class="op" id="4121712">]</span>&nbsp;<span class="op" id="4121714">=</span>&nbsp;<span class="op" id="4121716">&amp;</span><span class="ident" id="4121717">MX</span><span class="op" id="4121719">{</span><span class="ident" id="4121720">r</span><span class="op" id="4121721">.</span><span class="ident" id="4121722">Mx</span><span class="op" id="4121724">,</span>&nbsp;<span class="ident" id="4121726">r</span><span class="op" id="4121727">.</span><span class="ident" id="4121728">Pref</span><span class="op" id="4121732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4121735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121738">byPref</span><span class="op" id="4121744">(</span><span class="ident" id="4121745">mx</span><span class="op" id="4121747">)</span><span class="op" id="4121748">.</span><span class="ident" id="4121749">sort</span><span class="op" id="4121753">(</span><span class="op" id="4121754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121757">return</span><br>
<span class="lineno">120</span><span class="op" id="4121764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4121767">func</span>&nbsp;<span class="ident" id="4121772">lookupNS</span><span class="op" id="4121780">(</span><span class="ident" id="4121781">name</span>&nbsp;<span class="builtintype" id="4121786">string</span><span class="op" id="4121792">)</span>&nbsp;<span class="op" id="4121794">(</span><span class="ident" id="4121795">ns</span>&nbsp;<span class="op" id="4121798">[</span><span class="op" id="4121799">]</span><span class="op" id="4121800">*</span><span class="ident" id="4121801">NS</span><span class="op" id="4121803">,</span>&nbsp;<span class="ident" id="4121805">err</span>&nbsp;<span class="builtintype" id="4121809">error</span><span class="op" id="4121814">)</span>&nbsp;<span class="op" id="4121816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121819">_</span><span class="op" id="4121820">,</span>&nbsp;<span class="ident" id="4121822">records</span><span class="op" id="4121829">,</span>&nbsp;<span class="ident" id="4121831">err</span>&nbsp;<span class="op" id="4121835">:=</span>&nbsp;<span class="ident" id="4121838">lookup</span><span class="op" id="4121844">(</span><span class="ident" id="4121845">name</span><span class="op" id="4121849">,</span>&nbsp;<span class="ident" id="4121851">dnsTypeNS</span><span class="op" id="4121860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121863">if</span>&nbsp;<span class="ident" id="4121866">err</span>&nbsp;<span class="op" id="4121870">!=</span>&nbsp;<span class="ident" id="4121873">nil</span>&nbsp;<span class="op" id="4121877">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121881">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4121889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121892">ns</span>&nbsp;<span class="op" id="4121895">=</span>&nbsp;<span class="builtinfunc" id="4121897">make</span><span class="op" id="4121901">(</span><span class="op" id="4121902">[</span><span class="op" id="4121903">]</span><span class="op" id="4121904">*</span><span class="ident" id="4121905">NS</span><span class="op" id="4121907">,</span>&nbsp;<span class="builtinfunc" id="4121909">len</span><span class="op" id="4121912">(</span><span class="ident" id="4121913">records</span><span class="op" id="4121920">)</span><span class="op" id="4121921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121924">for</span>&nbsp;<span class="ident" id="4121928">i</span><span class="op" id="4121929">,</span>&nbsp;<span class="ident" id="4121931">r</span>&nbsp;<span class="op" id="4121933">:=</span>&nbsp;<span class="keyword" id="4121936">range</span>&nbsp;<span class="ident" id="4121942">records</span>&nbsp;<span class="op" id="4121950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121954">r</span>&nbsp;<span class="op" id="4121956">:=</span>&nbsp;<span class="ident" id="4121959">r</span><span class="op" id="4121960">.</span><span class="op" id="4121961">(</span><span class="op" id="4121962">*</span><span class="ident" id="4121963">dnsRR_NS</span><span class="op" id="4121971">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121975">ns</span><span class="op" id="4121977">[</span><span class="ident" id="4121978">i</span><span class="op" id="4121979">]</span>&nbsp;<span class="op" id="4121981">=</span>&nbsp;<span class="op" id="4121983">&amp;</span><span class="ident" id="4121984">NS</span><span class="op" id="4121986">{</span><span class="ident" id="4121987">r</span><span class="op" id="4121988">.</span><span class="ident" id="4121989">Ns</span><span class="op" id="4121991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4121994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121997">return</span><br>
<span class="lineno"></span><span class="op" id="4122004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="4122007">func</span>&nbsp;<span class="ident" id="4122012">lookupTXT</span><span class="op" id="4122021">(</span><span class="ident" id="4122022">name</span>&nbsp;<span class="builtintype" id="4122027">string</span><span class="op" id="4122033">)</span>&nbsp;<span class="op" id="4122035">(</span><span class="ident" id="4122036">txt</span>&nbsp;<span class="op" id="4122040">[</span><span class="op" id="4122041">]</span><span class="builtintype" id="4122042">string</span><span class="op" id="4122048">,</span>&nbsp;<span class="ident" id="4122050">err</span>&nbsp;<span class="builtintype" id="4122054">error</span><span class="op" id="4122059">)</span>&nbsp;<span class="op" id="4122061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4122064">_</span><span class="op" id="4122065">,</span>&nbsp;<span class="ident" id="4122067">records</span><span class="op" id="4122074">,</span>&nbsp;<span class="ident" id="4122076">err</span>&nbsp;<span class="op" id="4122080">:=</span>&nbsp;<span class="ident" id="4122083">lookup</span><span class="op" id="4122089">(</span><span class="ident" id="4122090">name</span><span class="op" id="4122094">,</span>&nbsp;<span class="ident" id="4122096">dnsTypeTXT</span><span class="op" id="4122106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122109">if</span>&nbsp;<span class="ident" id="4122112">err</span>&nbsp;<span class="op" id="4122116">!=</span>&nbsp;<span class="ident" id="4122119">nil</span>&nbsp;<span class="op" id="4122123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122127">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122135">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4122138">txt</span>&nbsp;<span class="op" id="4122142">=</span>&nbsp;<span class="builtinfunc" id="4122144">make</span><span class="op" id="4122148">(</span><span class="op" id="4122149">[</span><span class="op" id="4122150">]</span><span class="builtintype" id="4122151">string</span><span class="op" id="4122157">,</span>&nbsp;<span class="builtinfunc" id="4122159">len</span><span class="op" id="4122162">(</span><span class="ident" id="4122163">records</span><span class="op" id="4122170">)</span><span class="op" id="4122171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122174">for</span>&nbsp;<span class="ident" id="4122178">i</span><span class="op" id="4122179">,</span>&nbsp;<span class="ident" id="4122181">r</span>&nbsp;<span class="op" id="4122183">:=</span>&nbsp;<span class="keyword" id="4122186">range</span>&nbsp;<span class="ident" id="4122192">records</span>&nbsp;<span class="op" id="4122200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4122204">txt</span><span class="op" id="4122207">[</span><span class="ident" id="4122208">i</span><span class="op" id="4122209">]</span>&nbsp;<span class="op" id="4122211">=</span>&nbsp;<span class="ident" id="4122213">r</span><span class="op" id="4122214">.</span><span class="op" id="4122215">(</span><span class="op" id="4122216">*</span><span class="ident" id="4122217">dnsRR_TXT</span><span class="op" id="4122226">)</span><span class="op" id="4122227">.</span><span class="ident" id="4122228">Txt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122236">return</span><br>
<span class="lineno">145</span><span class="op" id="4122243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4122246">func</span>&nbsp;<span class="ident" id="4122251">lookupAddr</span><span class="op" id="4122261">(</span><span class="ident" id="4122262">addr</span>&nbsp;<span class="builtintype" id="4122267">string</span><span class="op" id="4122273">)</span>&nbsp;<span class="op" id="4122275">(</span><span class="ident" id="4122276">name</span>&nbsp;<span class="op" id="4122281">[</span><span class="op" id="4122282">]</span><span class="builtintype" id="4122283">string</span><span class="op" id="4122289">,</span>&nbsp;<span class="ident" id="4122291">err</span>&nbsp;<span class="builtintype" id="4122295">error</span><span class="op" id="4122300">)</span>&nbsp;<span class="op" id="4122302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4122305">name</span>&nbsp;<span class="op" id="4122310">=</span>&nbsp;<span class="ident" id="4122312">lookupStaticAddr</span><span class="op" id="4122328">(</span><span class="ident" id="4122329">addr</span><span class="op" id="4122333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122336">if</span>&nbsp;<span class="builtinfunc" id="4122339">len</span><span class="op" id="4122342">(</span><span class="ident" id="4122343">name</span><span class="op" id="4122347">)</span>&nbsp;<span class="op" id="4122349">&gt;</span>&nbsp;<span class="num" id="4122351">0</span>&nbsp;<span class="op" id="4122353">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122357">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122368">var</span>&nbsp;<span class="ident" id="4122372">arpa</span>&nbsp;<span class="builtintype" id="4122377">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4122385">arpa</span><span class="op" id="4122389">,</span>&nbsp;<span class="ident" id="4122391">err</span>&nbsp;<span class="op" id="4122395">=</span>&nbsp;<span class="ident" id="4122397">reverseaddr</span><span class="op" id="4122408">(</span><span class="ident" id="4122409">addr</span><span class="op" id="4122413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122416">if</span>&nbsp;<span class="ident" id="4122419">err</span>&nbsp;<span class="op" id="4122423">!=</span>&nbsp;<span class="ident" id="4122426">nil</span>&nbsp;<span class="op" id="4122430">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122434">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122445">var</span>&nbsp;<span class="ident" id="4122449">records</span>&nbsp;<span class="op" id="4122457">[</span><span class="op" id="4122458">]</span><span class="ident" id="4122459">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4122466">_</span><span class="op" id="4122467">,</span>&nbsp;<span class="ident" id="4122469">records</span><span class="op" id="4122476">,</span>&nbsp;<span class="ident" id="4122478">err</span>&nbsp;<span class="op" id="4122482">=</span>&nbsp;<span class="ident" id="4122484">lookup</span><span class="op" id="4122490">(</span><span class="ident" id="4122491">arpa</span><span class="op" id="4122495">,</span>&nbsp;<span class="ident" id="4122497">dnsTypePTR</span><span class="op" id="4122507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122510">if</span>&nbsp;<span class="ident" id="4122513">err</span>&nbsp;<span class="op" id="4122517">!=</span>&nbsp;<span class="ident" id="4122520">nil</span>&nbsp;<span class="op" id="4122524">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122528">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4122539">name</span>&nbsp;<span class="op" id="4122544">=</span>&nbsp;<span class="builtinfunc" id="4122546">make</span><span class="op" id="4122550">(</span><span class="op" id="4122551">[</span><span class="op" id="4122552">]</span><span class="builtintype" id="4122553">string</span><span class="op" id="4122559">,</span>&nbsp;<span class="builtinfunc" id="4122561">len</span><span class="op" id="4122564">(</span><span class="ident" id="4122565">records</span><span class="op" id="4122572">)</span><span class="op" id="4122573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122576">for</span>&nbsp;<span class="ident" id="4122580">i</span>&nbsp;<span class="op" id="4122582">:=</span>&nbsp;<span class="keyword" id="4122585">range</span>&nbsp;<span class="ident" id="4122591">records</span>&nbsp;<span class="op" id="4122599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4122603">r</span>&nbsp;<span class="op" id="4122605">:=</span>&nbsp;<span class="ident" id="4122608">records</span><span class="op" id="4122615">[</span><span class="ident" id="4122616">i</span><span class="op" id="4122617">]</span><span class="op" id="4122618">.</span><span class="op" id="4122619">(</span><span class="op" id="4122620">*</span><span class="ident" id="4122621">dnsRR_PTR</span><span class="op" id="4122630">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4122634">name</span><span class="op" id="4122638">[</span><span class="ident" id="4122639">i</span><span class="op" id="4122640">]</span>&nbsp;<span class="op" id="4122642">=</span>&nbsp;<span class="ident" id="4122644">r</span><span class="op" id="4122645">.</span><span class="ident" id="4122646">Ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122654">return</span><br>
<span class="lineno"></span><span class="op" id="4122661">}</span>
</div>
</body>
</html>
