<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8170614">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8170669">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8170723">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8170774">package</span>&nbsp;<span class="ident" id="8170782">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8170787">import</span>&nbsp;<span class="op" id="8170794">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8170797">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8170813">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="8170823">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8170826">type</span>&nbsp;<span class="ident" id="8170831">testSplitPreMasterSecretTest</span>&nbsp;<span class="keyword" id="8170860">struct</span>&nbsp;<span class="op" id="8170867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8170870">in</span><span class="op" id="8170872">,</span>&nbsp;<span class="ident" id="8170874">out1</span><span class="op" id="8170878">,</span>&nbsp;<span class="ident" id="8170880">out2</span>&nbsp;<span class="builtintype" id="8170885">string</span><br>
<span class="lineno"></span><span class="op" id="8170892">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="8170895">var</span>&nbsp;<span class="ident" id="8170899">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="8170929">=</span>&nbsp;<span class="op" id="8170931">[</span><span class="op" id="8170932">]</span><span class="ident" id="8170933">testSplitPreMasterSecretTest</span><span class="op" id="8170961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8170964">{</span><span class="string" id="8170965">&#34;&#34;</span><span class="op" id="8170967">,</span>&nbsp;<span class="string" id="8170969">&#34;&#34;</span><span class="op" id="8170971">,</span>&nbsp;<span class="string" id="8170973">&#34;&#34;</span><span class="op" id="8170975">}</span><span class="op" id="8170976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8170979">{</span><span class="string" id="8170980">&#34;00&#34;</span><span class="op" id="8170984">,</span>&nbsp;<span class="string" id="8170986">&#34;00&#34;</span><span class="op" id="8170990">,</span>&nbsp;<span class="string" id="8170992">&#34;00&#34;</span><span class="op" id="8170996">}</span><span class="op" id="8170997">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8171000">{</span><span class="string" id="8171001">&#34;0011&#34;</span><span class="op" id="8171007">,</span>&nbsp;<span class="string" id="8171009">&#34;00&#34;</span><span class="op" id="8171013">,</span>&nbsp;<span class="string" id="8171015">&#34;11&#34;</span><span class="op" id="8171019">}</span><span class="op" id="8171020">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8171023">{</span><span class="string" id="8171024">&#34;001122&#34;</span><span class="op" id="8171032">,</span>&nbsp;<span class="string" id="8171034">&#34;0011&#34;</span><span class="op" id="8171040">,</span>&nbsp;<span class="string" id="8171042">&#34;1122&#34;</span><span class="op" id="8171048">}</span><span class="op" id="8171049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8171052">{</span><span class="string" id="8171053">&#34;00112233&#34;</span><span class="op" id="8171063">,</span>&nbsp;<span class="string" id="8171065">&#34;0011&#34;</span><span class="op" id="8171071">,</span>&nbsp;<span class="string" id="8171073">&#34;2233&#34;</span><span class="op" id="8171079">}</span><span class="op" id="8171080">,</span><br>
<span class="lineno"></span><span class="op" id="8171082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8171085">func</span>&nbsp;<span class="ident" id="8171090">TestSplitPreMasterSecret</span><span class="op" id="8171114">(</span><span class="ident" id="8171115">t</span>&nbsp;<span class="op" id="8171117">*</span><span class="ident" id="8171118">testing</span><span class="op" id="8171125">.</span><span class="ident" id="8171126">T</span><span class="op" id="8171127">)</span>&nbsp;<span class="op" id="8171129">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8171132">for</span>&nbsp;<span class="ident" id="8171136">i</span><span class="op" id="8171137">,</span>&nbsp;<span class="ident" id="8171139">test</span>&nbsp;<span class="op" id="8171144">:=</span>&nbsp;<span class="keyword" id="8171147">range</span>&nbsp;<span class="ident" id="8171153">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="8171183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8171187">in</span><span class="op" id="8171189">,</span>&nbsp;<span class="ident" id="8171191">_</span>&nbsp;<span class="op" id="8171193">:=</span>&nbsp;<span class="ident" id="8171196">hex</span><span class="op" id="8171199">.</span><span class="ident" id="8171200">DecodeString</span><span class="op" id="8171212">(</span><span class="ident" id="8171213">test</span><span class="op" id="8171217">.</span><span class="ident" id="8171218">in</span><span class="op" id="8171220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8171224">out1</span><span class="op" id="8171228">,</span>&nbsp;<span class="ident" id="8171230">out2</span>&nbsp;<span class="op" id="8171235">:=</span>&nbsp;<span class="ident" id="8171238">splitPreMasterSecret</span><span class="op" id="8171258">(</span><span class="ident" id="8171259">in</span><span class="op" id="8171261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8171265">s1</span>&nbsp;<span class="op" id="8171268">:=</span>&nbsp;<span class="ident" id="8171271">hex</span><span class="op" id="8171274">.</span><span class="ident" id="8171275">EncodeToString</span><span class="op" id="8171289">(</span><span class="ident" id="8171290">out1</span><span class="op" id="8171294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8171298">s2</span>&nbsp;<span class="op" id="8171301">:=</span>&nbsp;<span class="ident" id="8171304">hex</span><span class="op" id="8171307">.</span><span class="ident" id="8171308">EncodeToString</span><span class="op" id="8171322">(</span><span class="ident" id="8171323">out2</span><span class="op" id="8171327">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8171331">if</span>&nbsp;<span class="ident" id="8171334">s1</span>&nbsp;<span class="op" id="8171337">!=</span>&nbsp;<span class="ident" id="8171340">test</span><span class="op" id="8171344">.</span><span class="ident" id="8171345">out1</span>&nbsp;<span class="op" id="8171350">||</span>&nbsp;<span class="ident" id="8171353">s2</span>&nbsp;<span class="op" id="8171356">!=</span>&nbsp;<span class="ident" id="8171359">test</span><span class="op" id="8171363">.</span><span class="ident" id="8171364">out2</span>&nbsp;<span class="op" id="8171369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8171374">t</span><span class="op" id="8171375">.</span><span class="ident" id="8171376">Errorf</span><span class="op" id="8171382">(</span><span class="string" id="8171383">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s)&#34;</span><span class="op" id="8171418">,</span>&nbsp;<span class="ident" id="8171420">i</span><span class="op" id="8171421">,</span>&nbsp;<span class="ident" id="8171423">s1</span><span class="op" id="8171425">,</span>&nbsp;<span class="ident" id="8171427">s2</span><span class="op" id="8171429">,</span>&nbsp;<span class="ident" id="8171431">test</span><span class="op" id="8171435">.</span><span class="ident" id="8171436">out1</span><span class="op" id="8171440">,</span>&nbsp;<span class="ident" id="8171442">test</span><span class="op" id="8171446">.</span><span class="ident" id="8171447">out2</span><span class="op" id="8171451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8171455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8171458">}</span><br>
<span class="lineno"></span><span class="op" id="8171460">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="8171463">type</span>&nbsp;<span class="ident" id="8171468">testKeysFromTest</span>&nbsp;<span class="keyword" id="8171485">struct</span>&nbsp;<span class="op" id="8171492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8171495">version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8171522">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8171530">preMasterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8171557">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8171565">clientRandom</span><span class="op" id="8171577">,</span>&nbsp;<span class="ident" id="8171579">serverRandom</span>&nbsp;<span class="builtintype" id="8171592">string</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8171600">masterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8171627">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8171635">clientMAC</span><span class="op" id="8171644">,</span>&nbsp;<span class="ident" id="8171646">serverMAC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8171662">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8171670">clientKey</span><span class="op" id="8171679">,</span>&nbsp;<span class="ident" id="8171681">serverKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8171697">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8171705">macLen</span><span class="op" id="8171711">,</span>&nbsp;<span class="ident" id="8171713">keyLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8171732">int</span><br>
<span class="lineno"></span><span class="op" id="8171736">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="8171739">func</span>&nbsp;<span class="ident" id="8171744">TestKeysFromPreMasterSecret</span><span class="op" id="8171771">(</span><span class="ident" id="8171772">t</span>&nbsp;<span class="op" id="8171774">*</span><span class="ident" id="8171775">testing</span><span class="op" id="8171782">.</span><span class="ident" id="8171783">T</span><span class="op" id="8171784">)</span>&nbsp;<span class="op" id="8171786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8171789">for</span>&nbsp;<span class="ident" id="8171793">i</span><span class="op" id="8171794">,</span>&nbsp;<span class="ident" id="8171796">test</span>&nbsp;<span class="op" id="8171801">:=</span>&nbsp;<span class="keyword" id="8171804">range</span>&nbsp;<span class="ident" id="8171810">testKeysFromTests</span>&nbsp;<span class="op" id="8171828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8171832">in</span><span class="op" id="8171834">,</span>&nbsp;<span class="ident" id="8171836">_</span>&nbsp;<span class="op" id="8171838">:=</span>&nbsp;<span class="ident" id="8171841">hex</span><span class="op" id="8171844">.</span><span class="ident" id="8171845">DecodeString</span><span class="op" id="8171857">(</span><span class="ident" id="8171858">test</span><span class="op" id="8171862">.</span><span class="ident" id="8171863">preMasterSecret</span><span class="op" id="8171878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8171882">clientRandom</span><span class="op" id="8171894">,</span>&nbsp;<span class="ident" id="8171896">_</span>&nbsp;<span class="op" id="8171898">:=</span>&nbsp;<span class="ident" id="8171901">hex</span><span class="op" id="8171904">.</span><span class="ident" id="8171905">DecodeString</span><span class="op" id="8171917">(</span><span class="ident" id="8171918">test</span><span class="op" id="8171922">.</span><span class="ident" id="8171923">clientRandom</span><span class="op" id="8171935">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8171939">serverRandom</span><span class="op" id="8171951">,</span>&nbsp;<span class="ident" id="8171953">_</span>&nbsp;<span class="op" id="8171955">:=</span>&nbsp;<span class="ident" id="8171958">hex</span><span class="op" id="8171961">.</span><span class="ident" id="8171962">DecodeString</span><span class="op" id="8171974">(</span><span class="ident" id="8171975">test</span><span class="op" id="8171979">.</span><span class="ident" id="8171980">serverRandom</span><span class="op" id="8171992">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8171997">masterSecret</span>&nbsp;<span class="op" id="8172010">:=</span>&nbsp;<span class="ident" id="8172013">masterFromPreMasterSecret</span><span class="op" id="8172038">(</span><span class="ident" id="8172039">test</span><span class="op" id="8172043">.</span><span class="ident" id="8172044">version</span><span class="op" id="8172051">,</span>&nbsp;<span class="ident" id="8172053">in</span><span class="op" id="8172055">,</span>&nbsp;<span class="ident" id="8172057">clientRandom</span><span class="op" id="8172069">,</span>&nbsp;<span class="ident" id="8172071">serverRandom</span><span class="op" id="8172083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8172087">if</span>&nbsp;<span class="ident" id="8172090">s</span>&nbsp;<span class="op" id="8172092">:=</span>&nbsp;<span class="ident" id="8172095">hex</span><span class="op" id="8172098">.</span><span class="ident" id="8172099">EncodeToString</span><span class="op" id="8172113">(</span><span class="ident" id="8172114">masterSecret</span><span class="op" id="8172126">)</span><span class="op" id="8172127">;</span>&nbsp;<span class="ident" id="8172129">s</span>&nbsp;<span class="op" id="8172131">!=</span>&nbsp;<span class="ident" id="8172134">test</span><span class="op" id="8172138">.</span><span class="ident" id="8172139">masterSecret</span>&nbsp;<span class="op" id="8172152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8172157">t</span><span class="op" id="8172158">.</span><span class="ident" id="8172159">Errorf</span><span class="op" id="8172165">(</span><span class="string" id="8172166">&#34;#%d:&nbsp;bad&nbsp;master&nbsp;secret&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8172202">,</span>&nbsp;<span class="ident" id="8172204">i</span><span class="op" id="8172205">,</span>&nbsp;<span class="ident" id="8172207">s</span><span class="op" id="8172208">,</span>&nbsp;<span class="ident" id="8172210">test</span><span class="op" id="8172214">.</span><span class="ident" id="8172215">masterSecret</span><span class="op" id="8172227">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8172232">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8172243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8172248">clientMAC</span><span class="op" id="8172257">,</span>&nbsp;<span class="ident" id="8172259">serverMAC</span><span class="op" id="8172268">,</span>&nbsp;<span class="ident" id="8172270">clientKey</span><span class="op" id="8172279">,</span>&nbsp;<span class="ident" id="8172281">serverKey</span><span class="op" id="8172290">,</span>&nbsp;<span class="ident" id="8172292">_</span><span class="op" id="8172293">,</span>&nbsp;<span class="ident" id="8172295">_</span>&nbsp;<span class="op" id="8172297">:=</span>&nbsp;<span class="ident" id="8172300">keysFromMasterSecret</span><span class="op" id="8172320">(</span><span class="ident" id="8172321">test</span><span class="op" id="8172325">.</span><span class="ident" id="8172326">version</span><span class="op" id="8172333">,</span>&nbsp;<span class="ident" id="8172335">masterSecret</span><span class="op" id="8172347">,</span>&nbsp;<span class="ident" id="8172349">clientRandom</span><span class="op" id="8172361">,</span>&nbsp;<span class="ident" id="8172363">serverRandom</span><span class="op" id="8172375">,</span>&nbsp;<span class="ident" id="8172377">test</span><span class="op" id="8172381">.</span><span class="ident" id="8172382">macLen</span><span class="op" id="8172388">,</span>&nbsp;<span class="ident" id="8172390">test</span><span class="op" id="8172394">.</span><span class="ident" id="8172395">keyLen</span><span class="op" id="8172401">,</span>&nbsp;<span class="num" id="8172403">0</span><span class="op" id="8172404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8172408">clientMACString</span>&nbsp;<span class="op" id="8172424">:=</span>&nbsp;<span class="ident" id="8172427">hex</span><span class="op" id="8172430">.</span><span class="ident" id="8172431">EncodeToString</span><span class="op" id="8172445">(</span><span class="ident" id="8172446">clientMAC</span><span class="op" id="8172455">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8172459">serverMACString</span>&nbsp;<span class="op" id="8172475">:=</span>&nbsp;<span class="ident" id="8172478">hex</span><span class="op" id="8172481">.</span><span class="ident" id="8172482">EncodeToString</span><span class="op" id="8172496">(</span><span class="ident" id="8172497">serverMAC</span><span class="op" id="8172506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8172510">clientKeyString</span>&nbsp;<span class="op" id="8172526">:=</span>&nbsp;<span class="ident" id="8172529">hex</span><span class="op" id="8172532">.</span><span class="ident" id="8172533">EncodeToString</span><span class="op" id="8172547">(</span><span class="ident" id="8172548">clientKey</span><span class="op" id="8172557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8172561">serverKeyString</span>&nbsp;<span class="op" id="8172577">:=</span>&nbsp;<span class="ident" id="8172580">hex</span><span class="op" id="8172583">.</span><span class="ident" id="8172584">EncodeToString</span><span class="op" id="8172598">(</span><span class="ident" id="8172599">serverKey</span><span class="op" id="8172608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8172612">if</span>&nbsp;<span class="ident" id="8172615">clientMACString</span>&nbsp;<span class="op" id="8172631">!=</span>&nbsp;<span class="ident" id="8172634">test</span><span class="op" id="8172638">.</span><span class="ident" id="8172639">clientMAC</span>&nbsp;<span class="op" id="8172649">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8172655">serverMACString</span>&nbsp;<span class="op" id="8172671">!=</span>&nbsp;<span class="ident" id="8172674">test</span><span class="op" id="8172678">.</span><span class="ident" id="8172679">serverMAC</span>&nbsp;<span class="op" id="8172689">||</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8172695">clientKeyString</span>&nbsp;<span class="op" id="8172711">!=</span>&nbsp;<span class="ident" id="8172714">test</span><span class="op" id="8172718">.</span><span class="ident" id="8172719">clientKey</span>&nbsp;<span class="op" id="8172729">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8172735">serverKeyString</span>&nbsp;<span class="op" id="8172751">!=</span>&nbsp;<span class="ident" id="8172754">test</span><span class="op" id="8172758">.</span><span class="ident" id="8172759">serverKey</span>&nbsp;<span class="op" id="8172769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8172774">t</span><span class="op" id="8172775">.</span><span class="ident" id="8172776">Errorf</span><span class="op" id="8172782">(</span><span class="string" id="8172783">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&#34;</span><span class="op" id="8172834">,</span>&nbsp;<span class="ident" id="8172836">i</span><span class="op" id="8172837">,</span>&nbsp;<span class="ident" id="8172839">clientMACString</span><span class="op" id="8172854">,</span>&nbsp;<span class="ident" id="8172856">serverMACString</span><span class="op" id="8172871">,</span>&nbsp;<span class="ident" id="8172873">clientKeyString</span><span class="op" id="8172888">,</span>&nbsp;<span class="ident" id="8172890">serverKeyString</span><span class="op" id="8172905">,</span>&nbsp;<span class="ident" id="8172907">test</span><span class="op" id="8172911">.</span><span class="ident" id="8172912">clientMAC</span><span class="op" id="8172921">,</span>&nbsp;<span class="ident" id="8172923">test</span><span class="op" id="8172927">.</span><span class="ident" id="8172928">serverMAC</span><span class="op" id="8172937">,</span>&nbsp;<span class="ident" id="8172939">test</span><span class="op" id="8172943">.</span><span class="ident" id="8172944">clientKey</span><span class="op" id="8172953">,</span>&nbsp;<span class="ident" id="8172955">test</span><span class="op" id="8172959">.</span><span class="ident" id="8172960">serverKey</span><span class="op" id="8172969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8172973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8172976">}</span><br>
<span class="lineno">70</span><span class="op" id="8172978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8172981">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;from&nbsp;GnuTLS&nbsp;using&nbsp;`gnutls-cli&nbsp;--insecure&nbsp;-d&nbsp;9&nbsp;`</span><br>
<span class="lineno"></span><span class="keyword" id="8173066">var</span>&nbsp;<span class="ident" id="8173070">testKeysFromTests</span>&nbsp;<span class="op" id="8173088">=</span>&nbsp;<span class="op" id="8173090">[</span><span class="op" id="8173091">]</span><span class="ident" id="8173092">testKeysFromTest</span><span class="op" id="8173108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8173111">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173115">VersionTLS10</span><span class="op" id="8173127">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8173131">&#34;0302cac83ad4b1db3b9ab49ad05957de2a504a634a386fc600889321e1a971f57479466830ac3e6f468e87f5385fa0c5&#34;</span><span class="op" id="8173229">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8173233">&#34;4ae66303755184a3917fcb44880605fcc53baa01912b22ed94473fc69cebd558&#34;</span><span class="op" id="8173299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8173303">&#34;4ae663020ec16e6bb5130be918cfcafd4d765979a3136a5d50c593446e4e44db&#34;</span><span class="op" id="8173369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8173373">&#34;3d851bab6e5556e959a16bc36d66cfae32f672bfa9ecdef6096cbb1b23472df1da63dbbd9827606413221d149ed08ceb&#34;</span><span class="op" id="8173471">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8173475">&#34;805aaa19b3d2c0a0759a4b6c9959890e08480119&#34;</span><span class="op" id="8173517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8173521">&#34;2d22f9fe519c075c16448305ceee209fc24ad109&#34;</span><span class="op" id="8173563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8173567">&#34;d50b5771244f850cd8117a9ccafe2cf1&#34;</span><span class="op" id="8173601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8173605">&#34;e076e33206b30507a85c32855acd0919&#34;</span><span class="op" id="8173639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8173643">20</span><span class="op" id="8173645">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8173649">16</span><span class="op" id="8173651">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8173654">}</span><span class="op" id="8173655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8173658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173662">VersionTLS10</span><span class="op" id="8173674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8173678">&#34;03023f7527316bc12cbcd69e4b9e8275d62c028f27e65c745cfcddc7ce01bd3570a111378b63848127f1c36e5f9e4890&#34;</span><span class="op" id="8173776">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8173780">&#34;4ae66364b5ea56b20ce4e25555aed2d7e67f42788dd03f3fee4adae0459ab106&#34;</span><span class="op" id="8173846">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8173850">&#34;4ae66363ab815cbf6a248b87d6b556184e945e9b97fbdf247858b0bdafacfa1c&#34;</span><span class="op" id="8173916">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8173920">&#34;7d64be7c80c59b740200b4b9c26d0baaa1c5ae56705acbcf2307fe62beb4728c19392c83f20483801cce022c77645460&#34;</span><span class="op" id="8174018">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8174022">&#34;97742ed60a0554ca13f04f97ee193177b971e3b0&#34;</span><span class="op" id="8174064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8174068">&#34;37068751700400e03a8477a5c7eec0813ab9e0dc&#34;</span><span class="op" id="8174110">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8174114">&#34;207cddbc600d2a200abac6502053ee5c&#34;</span><span class="op" id="8174148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8174152">&#34;df3f94f6e1eacc753b815fe16055cd43&#34;</span><span class="op" id="8174186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8174190">20</span><span class="op" id="8174192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8174196">16</span><span class="op" id="8174198">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8174201">}</span><span class="op" id="8174202">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8174205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8174209">VersionTLS10</span><span class="op" id="8174221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8174225">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="8174483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8174487">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="8174553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8174557">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="8174623">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8174627">&#34;1aff2e7a2c4279d0126f57a65a77a8d9d0087cf2733366699bec27eb53d5740705a8574bb1acc2abbe90e44f0dd28d6c&#34;</span><span class="op" id="8174725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8174729">&#34;3c7647c93c1379a31a609542aa44e7f117a70085&#34;</span><span class="op" id="8174771">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8174775">&#34;0d73102994be74a575a3ead8532590ca32a526d4&#34;</span><span class="op" id="8174817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8174821">&#34;ac7581b0b6c10d85bbd905ffbf36c65e&#34;</span><span class="op" id="8174855">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8174859">&#34;ff07edde49682b45466bd2e39464b306&#34;</span><span class="op" id="8174893">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8174897">20</span><span class="op" id="8174899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8174903">16</span><span class="op" id="8174905">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8174908">}</span><span class="op" id="8174909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8174912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8174916">VersionSSL30</span><span class="op" id="8174928">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8174932">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="8175190">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8175194">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="8175260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8175264">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="8175330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8175334">&#34;a614863e56299dcffeea2938f22c2ba023768dbe4b3f6877bc9c346c6ae529b51d9cb87ff9695ea4d01f2205584405b2&#34;</span><span class="op" id="8175432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8175436">&#34;2c450d5b6f6e2013ac6bea6a0b32200d4e1ffb94&#34;</span><span class="op" id="8175478">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8175482">&#34;7a7a7438769536f2fb1ae49a61f0703b79b2dc53&#34;</span><span class="op" id="8175524">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8175528">&#34;f8f6b26c10f12855c9aafb1e0e839ccf&#34;</span><span class="op" id="8175562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8175566">&#34;2b9d4b4a60cb7f396780ebff50650419&#34;</span><span class="op" id="8175600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8175604">20</span><span class="op" id="8175606">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8175610">16</span><span class="op" id="8175612">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8175615">}</span><span class="op" id="8175616">,</span><br>
<span class="lineno"></span><span class="op" id="8175618">}</span>
</div>
</body>
</html>
