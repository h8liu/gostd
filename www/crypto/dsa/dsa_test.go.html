<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6549854">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6549909">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6549963">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6550014">package</span>&nbsp;<span class="ident" id="6550022">dsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6550027">import</span>&nbsp;<span class="op" id="6550034">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6550037">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6550052">&#34;math/big&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6550064">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6550074">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6550077">func</span>&nbsp;<span class="ident" id="6550082">testSignAndVerify</span><span class="op" id="6550099">(</span><span class="ident" id="6550100">t</span>&nbsp;<span class="op" id="6550102">*</span><span class="ident" id="6550103"><a href="/crypto/dsa/dsa_test.go.html#6550064">testing</a></span><span class="op" id="6550110">.</span><span class="ident" id="6550111">T</span><span class="op" id="6550112">,</span>&nbsp;<span class="ident" id="6550114">i</span>&nbsp;<span class="builtintype" id="6550116">int</span><span class="op" id="6550119">,</span>&nbsp;<span class="ident" id="6550121">priv</span>&nbsp;<span class="op" id="6550126">*</span><span class="ident" id="6550127"><a href="/crypto/dsa/dsa.go.html#4270559">PrivateKey</a></span><span class="op" id="6550137">)</span>&nbsp;<span class="op" id="6550139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550142">hashed</span>&nbsp;<span class="op" id="6550149">:=</span>&nbsp;<span class="op" id="6550152">[</span><span class="op" id="6550153">]</span><span class="builtintype" id="6550154">byte</span><span class="op" id="6550158">(</span><span class="string" id="6550159">&#34;testing&#34;</span><span class="op" id="6550168">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550171">r</span><span class="op" id="6550172">,</span>&nbsp;<span class="ident" id="6550174">s</span><span class="op" id="6550175">,</span>&nbsp;<span class="ident" id="6550177">err</span>&nbsp;<span class="op" id="6550181">:=</span>&nbsp;<span class="ident" id="6550184"><a href="/crypto/dsa/dsa.go.html#4274564">Sign</a></span><span class="op" id="6550188">(</span><span class="ident" id="6550189"><a href="/crypto/dsa/dsa_test.go.html#6550037">rand</a></span><span class="op" id="6550193">.</span><span class="ident" id="6550194">Reader</span><span class="op" id="6550200">,</span>&nbsp;<span class="ident" id="6550202"><a href="/crypto/dsa/dsa_test.go.html#6550121">priv</a></span><span class="op" id="6550206">,</span>&nbsp;<span class="ident" id="6550208"><a href="/crypto/dsa/dsa_test.go.html#6550142">hashed</a></span><span class="op" id="6550214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6550217">if</span>&nbsp;<span class="ident" id="6550220"><a href="/crypto/dsa/dsa_test.go.html#6550177">err</a></span>&nbsp;<span class="op" id="6550224">!=</span>&nbsp;<span class="ident" id="6550227">nil</span>&nbsp;<span class="op" id="6550231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550235"><a href="/crypto/dsa/dsa_test.go.html#6550100">t</a></span><span class="op" id="6550236">.</span><span class="ident" id="6550237">Errorf</span><span class="op" id="6550243">(</span><span class="string" id="6550244">&#34;%d:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="6550267">,</span>&nbsp;<span class="ident" id="6550269"><a href="/crypto/dsa/dsa_test.go.html#6550114">i</a></span><span class="op" id="6550270">,</span>&nbsp;<span class="ident" id="6550272"><a href="/crypto/dsa/dsa_test.go.html#6550177">err</a></span><span class="op" id="6550275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6550279">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550287">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6550291">if</span>&nbsp;<span class="op" id="6550294">!</span><span class="ident" id="6550295"><a href="/crypto/dsa/dsa.go.html#4275593">Verify</a></span><span class="op" id="6550301">(</span><span class="op" id="6550302">&amp;</span><span class="ident" id="6550303"><a href="/crypto/dsa/dsa_test.go.html#6550121">priv</a></span><span class="op" id="6550307">.</span><span class="ident" id="6550308">PublicKey</span><span class="op" id="6550317">,</span>&nbsp;<span class="ident" id="6550319"><a href="/crypto/dsa/dsa_test.go.html#6550142">hashed</a></span><span class="op" id="6550325">,</span>&nbsp;<span class="ident" id="6550327"><a href="/crypto/dsa/dsa_test.go.html#6550171">r</a></span><span class="op" id="6550328">,</span>&nbsp;<span class="ident" id="6550330"><a href="/crypto/dsa/dsa_test.go.html#6550174">s</a></span><span class="op" id="6550331">)</span>&nbsp;<span class="op" id="6550333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550337"><a href="/crypto/dsa/dsa_test.go.html#6550100">t</a></span><span class="op" id="6550338">.</span><span class="ident" id="6550339">Errorf</span><span class="op" id="6550345">(</span><span class="string" id="6550346">&#34;%d:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="6550365">,</span>&nbsp;<span class="ident" id="6550367"><a href="/crypto/dsa/dsa_test.go.html#6550114">i</a></span><span class="op" id="6550368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550371">}</span><br>
<span class="lineno"></span><span class="op" id="6550373">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="6550376">func</span>&nbsp;<span class="ident" id="6550381">testParameterGeneration</span><span class="op" id="6550404">(</span><span class="ident" id="6550405">t</span>&nbsp;<span class="op" id="6550407">*</span><span class="ident" id="6550408"><a href="/crypto/dsa/dsa_test.go.html#6550064">testing</a></span><span class="op" id="6550415">.</span><span class="ident" id="6550416">T</span><span class="op" id="6550417">,</span>&nbsp;<span class="ident" id="6550419">sizes</span>&nbsp;<span class="ident" id="6550425"><a href="/crypto/dsa/dsa.go.html#4271084">ParameterSizes</a></span><span class="op" id="6550439">,</span>&nbsp;<span class="ident" id="6550441">L</span><span class="op" id="6550442">,</span>&nbsp;<span class="ident" id="6550444">N</span>&nbsp;<span class="builtintype" id="6550446">int</span><span class="op" id="6550449">)</span>&nbsp;<span class="op" id="6550451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6550454">var</span>&nbsp;<span class="ident" id="6550458">priv</span>&nbsp;<span class="ident" id="6550463"><a href="/crypto/dsa/dsa.go.html#4270559">PrivateKey</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550475">params</span>&nbsp;<span class="op" id="6550482">:=</span>&nbsp;<span class="op" id="6550485">&amp;</span><span class="ident" id="6550486"><a href="/crypto/dsa/dsa_test.go.html#6550458">priv</a></span><span class="op" id="6550490">.</span><span class="ident" id="6550491">Parameters</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550504">err</span>&nbsp;<span class="op" id="6550508">:=</span>&nbsp;<span class="ident" id="6550511"><a href="/crypto/dsa/dsa.go.html#4271496">GenerateParameters</a></span><span class="op" id="6550529">(</span><span class="ident" id="6550530"><a href="/crypto/dsa/dsa_test.go.html#6550475">params</a></span><span class="op" id="6550536">,</span>&nbsp;<span class="ident" id="6550538"><a href="/crypto/dsa/dsa_test.go.html#6550037">rand</a></span><span class="op" id="6550542">.</span><span class="ident" id="6550543">Reader</span><span class="op" id="6550549">,</span>&nbsp;<span class="ident" id="6550551"><a href="/crypto/dsa/dsa_test.go.html#6550419">sizes</a></span><span class="op" id="6550556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6550559">if</span>&nbsp;<span class="ident" id="6550562"><a href="/crypto/dsa/dsa_test.go.html#6550504">err</a></span>&nbsp;<span class="op" id="6550566">!=</span>&nbsp;<span class="ident" id="6550569">nil</span>&nbsp;<span class="op" id="6550573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550577"><a href="/crypto/dsa/dsa_test.go.html#6550405">t</a></span><span class="op" id="6550578">.</span><span class="ident" id="6550579">Errorf</span><span class="op" id="6550585">(</span><span class="string" id="6550586">&#34;%d:&nbsp;%s&#34;</span><span class="op" id="6550594">,</span>&nbsp;<span class="builtintype" id="6550596">int</span><span class="op" id="6550599">(</span><span class="ident" id="6550600"><a href="/crypto/dsa/dsa_test.go.html#6550419">sizes</a></span><span class="op" id="6550605">)</span><span class="op" id="6550606">,</span>&nbsp;<span class="ident" id="6550608"><a href="/crypto/dsa/dsa_test.go.html#6550504">err</a></span><span class="op" id="6550611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6550615">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550623">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6550627">if</span>&nbsp;<span class="ident" id="6550630"><a href="/crypto/dsa/dsa_test.go.html#6550475">params</a></span><span class="op" id="6550636">.</span><span class="ident" id="6550637">P</span><span class="op" id="6550638">.</span><span class="ident" id="6550639">BitLen</span><span class="op" id="6550645">(</span><span class="op" id="6550646">)</span>&nbsp;<span class="op" id="6550648">!=</span>&nbsp;<span class="ident" id="6550651"><a href="/crypto/dsa/dsa_test.go.html#6550441">L</a></span>&nbsp;<span class="op" id="6550653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550657"><a href="/crypto/dsa/dsa_test.go.html#6550405">t</a></span><span class="op" id="6550658">.</span><span class="ident" id="6550659">Errorf</span><span class="op" id="6550665">(</span><span class="string" id="6550666">&#34;%d:&nbsp;params.BitLen&nbsp;got:%d&nbsp;want:%d&#34;</span><span class="op" id="6550700">,</span>&nbsp;<span class="builtintype" id="6550702">int</span><span class="op" id="6550705">(</span><span class="ident" id="6550706"><a href="/crypto/dsa/dsa_test.go.html#6550419">sizes</a></span><span class="op" id="6550711">)</span><span class="op" id="6550712">,</span>&nbsp;<span class="ident" id="6550714"><a href="/crypto/dsa/dsa_test.go.html#6550475">params</a></span><span class="op" id="6550720">.</span><span class="ident" id="6550721">P</span><span class="op" id="6550722">.</span><span class="ident" id="6550723">BitLen</span><span class="op" id="6550729">(</span><span class="op" id="6550730">)</span><span class="op" id="6550731">,</span>&nbsp;<span class="ident" id="6550733"><a href="/crypto/dsa/dsa_test.go.html#6550441">L</a></span><span class="op" id="6550734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6550741">if</span>&nbsp;<span class="ident" id="6550744"><a href="/crypto/dsa/dsa_test.go.html#6550475">params</a></span><span class="op" id="6550750">.</span><span class="ident" id="6550751">Q</span><span class="op" id="6550752">.</span><span class="ident" id="6550753">BitLen</span><span class="op" id="6550759">(</span><span class="op" id="6550760">)</span>&nbsp;<span class="op" id="6550762">!=</span>&nbsp;<span class="ident" id="6550765"><a href="/crypto/dsa/dsa_test.go.html#6550444">N</a></span>&nbsp;<span class="op" id="6550767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550771"><a href="/crypto/dsa/dsa_test.go.html#6550405">t</a></span><span class="op" id="6550772">.</span><span class="ident" id="6550773">Errorf</span><span class="op" id="6550779">(</span><span class="string" id="6550780">&#34;%d:&nbsp;q.BitLen&nbsp;got:%d&nbsp;want:%d&#34;</span><span class="op" id="6550809">,</span>&nbsp;<span class="builtintype" id="6550811">int</span><span class="op" id="6550814">(</span><span class="ident" id="6550815"><a href="/crypto/dsa/dsa_test.go.html#6550419">sizes</a></span><span class="op" id="6550820">)</span><span class="op" id="6550821">,</span>&nbsp;<span class="ident" id="6550823"><a href="/crypto/dsa/dsa_test.go.html#6550475">params</a></span><span class="op" id="6550829">.</span><span class="ident" id="6550830">Q</span><span class="op" id="6550831">.</span><span class="ident" id="6550832">BitLen</span><span class="op" id="6550838">(</span><span class="op" id="6550839">)</span><span class="op" id="6550840">,</span>&nbsp;<span class="ident" id="6550842"><a href="/crypto/dsa/dsa_test.go.html#6550441">L</a></span><span class="op" id="6550843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550850">one</span>&nbsp;<span class="op" id="6550854">:=</span>&nbsp;<span class="builtinfunc" id="6550857">new</span><span class="op" id="6550860">(</span><span class="ident" id="6550861"><a href="/crypto/dsa/dsa_test.go.html#6550052">big</a></span><span class="op" id="6550864">.</span><span class="ident" id="6550865">Int</span><span class="op" id="6550868">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550871"><a href="/crypto/dsa/dsa_test.go.html#6550850">one</a></span><span class="op" id="6550874">.</span><span class="ident" id="6550875">SetInt64</span><span class="op" id="6550883">(</span><span class="num" id="6550884">1</span><span class="op" id="6550885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550888">pm1</span>&nbsp;<span class="op" id="6550892">:=</span>&nbsp;<span class="builtinfunc" id="6550895">new</span><span class="op" id="6550898">(</span><span class="ident" id="6550899"><a href="/crypto/dsa/dsa_test.go.html#6550052">big</a></span><span class="op" id="6550902">.</span><span class="ident" id="6550903">Int</span><span class="op" id="6550906">)</span><span class="op" id="6550907">.</span><span class="ident" id="6550908">Sub</span><span class="op" id="6550911">(</span><span class="ident" id="6550912"><a href="/crypto/dsa/dsa_test.go.html#6550475">params</a></span><span class="op" id="6550918">.</span><span class="ident" id="6550919">P</span><span class="op" id="6550920">,</span>&nbsp;<span class="ident" id="6550922"><a href="/crypto/dsa/dsa_test.go.html#6550850">one</a></span><span class="op" id="6550925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550928">quo</span><span class="op" id="6550931">,</span>&nbsp;<span class="ident" id="6550933">rem</span>&nbsp;<span class="op" id="6550937">:=</span>&nbsp;<span class="builtinfunc" id="6550940">new</span><span class="op" id="6550943">(</span><span class="ident" id="6550944"><a href="/crypto/dsa/dsa_test.go.html#6550052">big</a></span><span class="op" id="6550947">.</span><span class="ident" id="6550948">Int</span><span class="op" id="6550951">)</span><span class="op" id="6550952">.</span><span class="ident" id="6550953">DivMod</span><span class="op" id="6550959">(</span><span class="ident" id="6550960"><a href="/crypto/dsa/dsa_test.go.html#6550888">pm1</a></span><span class="op" id="6550963">,</span>&nbsp;<span class="ident" id="6550965"><a href="/crypto/dsa/dsa_test.go.html#6550475">params</a></span><span class="op" id="6550971">.</span><span class="ident" id="6550972">Q</span><span class="op" id="6550973">,</span>&nbsp;<span class="builtinfunc" id="6550975">new</span><span class="op" id="6550978">(</span><span class="ident" id="6550979"><a href="/crypto/dsa/dsa_test.go.html#6550052">big</a></span><span class="op" id="6550982">.</span><span class="ident" id="6550983">Int</span><span class="op" id="6550986">)</span><span class="op" id="6550987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6550990">if</span>&nbsp;<span class="ident" id="6550993"><a href="/crypto/dsa/dsa_test.go.html#6550933">rem</a></span><span class="op" id="6550996">.</span><span class="ident" id="6550997">Sign</span><span class="op" id="6551001">(</span><span class="op" id="6551002">)</span>&nbsp;<span class="op" id="6551004">!=</span>&nbsp;<span class="num" id="6551007">0</span>&nbsp;<span class="op" id="6551009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551013"><a href="/crypto/dsa/dsa_test.go.html#6550405">t</a></span><span class="op" id="6551014">.</span><span class="ident" id="6551015">Errorf</span><span class="op" id="6551021">(</span><span class="string" id="6551022">&#34;%d:&nbsp;p-1&nbsp;mod&nbsp;q&nbsp;!=&nbsp;0&#34;</span><span class="op" id="6551042">,</span>&nbsp;<span class="builtintype" id="6551044">int</span><span class="op" id="6551047">(</span><span class="ident" id="6551048"><a href="/crypto/dsa/dsa_test.go.html#6550419">sizes</a></span><span class="op" id="6551053">)</span><span class="op" id="6551054">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551060">x</span>&nbsp;<span class="op" id="6551062">:=</span>&nbsp;<span class="builtinfunc" id="6551065">new</span><span class="op" id="6551068">(</span><span class="ident" id="6551069"><a href="/crypto/dsa/dsa_test.go.html#6550052">big</a></span><span class="op" id="6551072">.</span><span class="ident" id="6551073">Int</span><span class="op" id="6551076">)</span><span class="op" id="6551077">.</span><span class="ident" id="6551078">Exp</span><span class="op" id="6551081">(</span><span class="ident" id="6551082"><a href="/crypto/dsa/dsa_test.go.html#6550475">params</a></span><span class="op" id="6551088">.</span><span class="ident" id="6551089">G</span><span class="op" id="6551090">,</span>&nbsp;<span class="ident" id="6551092"><a href="/crypto/dsa/dsa_test.go.html#6550928">quo</a></span><span class="op" id="6551095">,</span>&nbsp;<span class="ident" id="6551097"><a href="/crypto/dsa/dsa_test.go.html#6550475">params</a></span><span class="op" id="6551103">.</span><span class="ident" id="6551104">P</span><span class="op" id="6551105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6551108">if</span>&nbsp;<span class="ident" id="6551111"><a href="/crypto/dsa/dsa_test.go.html#6551060">x</a></span><span class="op" id="6551112">.</span><span class="ident" id="6551113">Cmp</span><span class="op" id="6551116">(</span><span class="ident" id="6551117"><a href="/crypto/dsa/dsa_test.go.html#6550850">one</a></span><span class="op" id="6551120">)</span>&nbsp;<span class="op" id="6551122">==</span>&nbsp;<span class="num" id="6551125">0</span>&nbsp;<span class="op" id="6551127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551131"><a href="/crypto/dsa/dsa_test.go.html#6550405">t</a></span><span class="op" id="6551132">.</span><span class="ident" id="6551133">Errorf</span><span class="op" id="6551139">(</span><span class="string" id="6551140">&#34;%d:&nbsp;invalid&nbsp;generator&#34;</span><span class="op" id="6551163">,</span>&nbsp;<span class="builtintype" id="6551165">int</span><span class="op" id="6551168">(</span><span class="ident" id="6551169"><a href="/crypto/dsa/dsa_test.go.html#6550419">sizes</a></span><span class="op" id="6551174">)</span><span class="op" id="6551175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551178">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551182"><a href="/crypto/dsa/dsa_test.go.html#6550504">err</a></span>&nbsp;<span class="op" id="6551186">=</span>&nbsp;<span class="ident" id="6551188"><a href="/crypto/dsa/dsa.go.html#4273226">GenerateKey</a></span><span class="op" id="6551199">(</span><span class="op" id="6551200">&amp;</span><span class="ident" id="6551201"><a href="/crypto/dsa/dsa_test.go.html#6550458">priv</a></span><span class="op" id="6551205">,</span>&nbsp;<span class="ident" id="6551207"><a href="/crypto/dsa/dsa_test.go.html#6550037">rand</a></span><span class="op" id="6551211">.</span><span class="ident" id="6551212">Reader</span><span class="op" id="6551218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6551221">if</span>&nbsp;<span class="ident" id="6551224"><a href="/crypto/dsa/dsa_test.go.html#6550504">err</a></span>&nbsp;<span class="op" id="6551228">!=</span>&nbsp;<span class="ident" id="6551231">nil</span>&nbsp;<span class="op" id="6551235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551239"><a href="/crypto/dsa/dsa_test.go.html#6550405">t</a></span><span class="op" id="6551240">.</span><span class="ident" id="6551241">Errorf</span><span class="op" id="6551247">(</span><span class="string" id="6551248">&#34;error&nbsp;generating&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6551274">,</span>&nbsp;<span class="ident" id="6551276"><a href="/crypto/dsa/dsa_test.go.html#6550504">err</a></span><span class="op" id="6551279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6551283">return</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551295"><a href="/crypto/dsa/dsa_test.go.html#6550082">testSignAndVerify</a></span><span class="op" id="6551312">(</span><span class="ident" id="6551313"><a href="/crypto/dsa/dsa_test.go.html#6550405">t</a></span><span class="op" id="6551314">,</span>&nbsp;<span class="builtintype" id="6551316">int</span><span class="op" id="6551319">(</span><span class="ident" id="6551320"><a href="/crypto/dsa/dsa_test.go.html#6550419">sizes</a></span><span class="op" id="6551325">)</span><span class="op" id="6551326">,</span>&nbsp;<span class="op" id="6551328">&amp;</span><span class="ident" id="6551329"><a href="/crypto/dsa/dsa_test.go.html#6550458">priv</a></span><span class="op" id="6551333">)</span><br>
<span class="lineno"></span><span class="op" id="6551335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="6551338">func</span>&nbsp;<span class="ident" id="6551343">TestParameterGeneration</span><span class="op" id="6551366">(</span><span class="ident" id="6551367">t</span>&nbsp;<span class="op" id="6551369">*</span><span class="ident" id="6551370"><a href="/crypto/dsa/dsa_test.go.html#6550064">testing</a></span><span class="op" id="6551377">.</span><span class="ident" id="6551378">T</span><span class="op" id="6551379">)</span>&nbsp;<span class="op" id="6551381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6551384">if</span>&nbsp;<span class="ident" id="6551387"><a href="/crypto/dsa/dsa_test.go.html#6550064">testing</a></span><span class="op" id="6551394">.</span><span class="ident" id="6551395">Short</span><span class="op" id="6551400">(</span><span class="op" id="6551401">)</span>&nbsp;<span class="op" id="6551403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551407"><a href="/crypto/dsa/dsa_test.go.html#6551367">t</a></span><span class="op" id="6551408">.</span><span class="ident" id="6551409">Skip</span><span class="op" id="6551413">(</span><span class="string" id="6551414">&#34;skipping&nbsp;parameter&nbsp;generation&nbsp;test&nbsp;in&nbsp;short&nbsp;mode&#34;</span><span class="op" id="6551464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551471"><a href="/crypto/dsa/dsa_test.go.html#6550381">testParameterGeneration</a></span><span class="op" id="6551494">(</span><span class="ident" id="6551495"><a href="/crypto/dsa/dsa_test.go.html#6551367">t</a></span><span class="op" id="6551496">,</span>&nbsp;<span class="ident" id="6551498"><a href="/crypto/dsa/dsa.go.html#4271113">L1024N160</a></span><span class="op" id="6551507">,</span>&nbsp;<span class="num" id="6551509">1024</span><span class="op" id="6551513">,</span>&nbsp;<span class="num" id="6551515">160</span><span class="op" id="6551518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551521"><a href="/crypto/dsa/dsa_test.go.html#6550381">testParameterGeneration</a></span><span class="op" id="6551544">(</span><span class="ident" id="6551545"><a href="/crypto/dsa/dsa_test.go.html#6551367">t</a></span><span class="op" id="6551546">,</span>&nbsp;<span class="ident" id="6551548"><a href="/crypto/dsa/dsa.go.html#4271146">L2048N224</a></span><span class="op" id="6551557">,</span>&nbsp;<span class="num" id="6551559">2048</span><span class="op" id="6551563">,</span>&nbsp;<span class="num" id="6551565">224</span><span class="op" id="6551568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551571"><a href="/crypto/dsa/dsa_test.go.html#6550381">testParameterGeneration</a></span><span class="op" id="6551594">(</span><span class="ident" id="6551595"><a href="/crypto/dsa/dsa_test.go.html#6551367">t</a></span><span class="op" id="6551596">,</span>&nbsp;<span class="ident" id="6551598"><a href="/crypto/dsa/dsa.go.html#4271157">L2048N256</a></span><span class="op" id="6551607">,</span>&nbsp;<span class="num" id="6551609">2048</span><span class="op" id="6551613">,</span>&nbsp;<span class="num" id="6551615">256</span><span class="op" id="6551618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551621"><a href="/crypto/dsa/dsa_test.go.html#6550381">testParameterGeneration</a></span><span class="op" id="6551644">(</span><span class="ident" id="6551645"><a href="/crypto/dsa/dsa_test.go.html#6551367">t</a></span><span class="op" id="6551646">,</span>&nbsp;<span class="ident" id="6551648"><a href="/crypto/dsa/dsa.go.html#4271168">L3072N256</a></span><span class="op" id="6551657">,</span>&nbsp;<span class="num" id="6551659">3072</span><span class="op" id="6551663">,</span>&nbsp;<span class="num" id="6551665">256</span><span class="op" id="6551668">)</span><br>
<span class="lineno"></span><span class="op" id="6551670">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="6551673">func</span>&nbsp;<span class="ident" id="6551678">TestSignAndVerify</span><span class="op" id="6551695">(</span><span class="ident" id="6551696">t</span>&nbsp;<span class="op" id="6551698">*</span><span class="ident" id="6551699"><a href="/crypto/dsa/dsa_test.go.html#6550064">testing</a></span><span class="op" id="6551706">.</span><span class="ident" id="6551707">T</span><span class="op" id="6551708">)</span>&nbsp;<span class="op" id="6551710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6551713">var</span>&nbsp;<span class="ident" id="6551717">priv</span>&nbsp;<span class="ident" id="6551722"><a href="/crypto/dsa/dsa.go.html#4270559">PrivateKey</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551734"><a href="/crypto/dsa/dsa_test.go.html#6551717">priv</a></span><span class="op" id="6551738">.</span><span class="ident" id="6551739">P</span><span class="op" id="6551740">,</span>&nbsp;<span class="ident" id="6551742">_</span>&nbsp;<span class="op" id="6551744">=</span>&nbsp;<span class="builtinfunc" id="6551746">new</span><span class="op" id="6551749">(</span><span class="ident" id="6551750"><a href="/crypto/dsa/dsa_test.go.html#6550052">big</a></span><span class="op" id="6551753">.</span><span class="ident" id="6551754">Int</span><span class="op" id="6551757">)</span><span class="op" id="6551758">.</span><span class="ident" id="6551759">SetString</span><span class="op" id="6551768">(</span><span class="string" id="6551769">&#34;A9B5B793FB4785793D246BAE77E8FF63CA52F442DA763C440259919FE1BC1D6065A9350637A04F75A2F039401D49F08E066C4D275A5A65DA5684BC563C14289D7AB8A67163BFBF79D85972619AD2CFF55AB0EE77A9002B0EF96293BDD0F42685EBB2C66C327079F6C98000FBCB79AACDE1BC6F9D5C7B1A97E3D9D54ED7951FEF&#34;</span><span class="op" id="6552027">,</span>&nbsp;<span class="num" id="6552029">16</span><span class="op" id="6552031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552034"><a href="/crypto/dsa/dsa_test.go.html#6551717">priv</a></span><span class="op" id="6552038">.</span><span class="ident" id="6552039">Q</span><span class="op" id="6552040">,</span>&nbsp;<span class="ident" id="6552042">_</span>&nbsp;<span class="op" id="6552044">=</span>&nbsp;<span class="builtinfunc" id="6552046">new</span><span class="op" id="6552049">(</span><span class="ident" id="6552050"><a href="/crypto/dsa/dsa_test.go.html#6550052">big</a></span><span class="op" id="6552053">.</span><span class="ident" id="6552054">Int</span><span class="op" id="6552057">)</span><span class="op" id="6552058">.</span><span class="ident" id="6552059">SetString</span><span class="op" id="6552068">(</span><span class="string" id="6552069">&#34;E1D3391245933D68A0714ED34BBCB7A1F422B9C1&#34;</span><span class="op" id="6552111">,</span>&nbsp;<span class="num" id="6552113">16</span><span class="op" id="6552115">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552118"><a href="/crypto/dsa/dsa_test.go.html#6551717">priv</a></span><span class="op" id="6552122">.</span><span class="ident" id="6552123">G</span><span class="op" id="6552124">,</span>&nbsp;<span class="ident" id="6552126">_</span>&nbsp;<span class="op" id="6552128">=</span>&nbsp;<span class="builtinfunc" id="6552130">new</span><span class="op" id="6552133">(</span><span class="ident" id="6552134"><a href="/crypto/dsa/dsa_test.go.html#6550052">big</a></span><span class="op" id="6552137">.</span><span class="ident" id="6552138">Int</span><span class="op" id="6552141">)</span><span class="op" id="6552142">.</span><span class="ident" id="6552143">SetString</span><span class="op" id="6552152">(</span><span class="string" id="6552153">&#34;634364FC25248933D01D1993ECABD0657CC0CB2CEED7ED2E3E8AECDFCDC4A25C3B15E9E3B163ACA2984B5539181F3EFF1A5E8903D71D5B95DA4F27202B77D2C44B430BB53741A8D59A8F86887525C9F2A6A5980A195EAA7F2FF910064301DEF89D3AA213E1FAC7768D89365318E370AF54A112EFBA9246D9158386BA1B4EEFDA&#34;</span><span class="op" id="6552411">,</span>&nbsp;<span class="num" id="6552413">16</span><span class="op" id="6552415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552418"><a href="/crypto/dsa/dsa_test.go.html#6551717">priv</a></span><span class="op" id="6552422">.</span><span class="ident" id="6552423">Y</span><span class="op" id="6552424">,</span>&nbsp;<span class="ident" id="6552426">_</span>&nbsp;<span class="op" id="6552428">=</span>&nbsp;<span class="builtinfunc" id="6552430">new</span><span class="op" id="6552433">(</span><span class="ident" id="6552434"><a href="/crypto/dsa/dsa_test.go.html#6550052">big</a></span><span class="op" id="6552437">.</span><span class="ident" id="6552438">Int</span><span class="op" id="6552441">)</span><span class="op" id="6552442">.</span><span class="ident" id="6552443">SetString</span><span class="op" id="6552452">(</span><span class="string" id="6552453">&#34;32969E5780CFE1C849A1C276D7AEB4F38A23B591739AA2FE197349AEEBD31366AEE5EB7E6C6DDB7C57D02432B30DB5AA66D9884299FAA72568944E4EEDC92EA3FBC6F39F53412FBCC563208F7C15B737AC8910DBC2D9C9B8C001E72FDC40EB694AB1F06A5A2DBD18D9E36C66F31F566742F11EC0A52E9F7B89355C02FB5D32D2&#34;</span><span class="op" id="6552711">,</span>&nbsp;<span class="num" id="6552713">16</span><span class="op" id="6552715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552718"><a href="/crypto/dsa/dsa_test.go.html#6551717">priv</a></span><span class="op" id="6552722">.</span><span class="ident" id="6552723">X</span><span class="op" id="6552724">,</span>&nbsp;<span class="ident" id="6552726">_</span>&nbsp;<span class="op" id="6552728">=</span>&nbsp;<span class="builtinfunc" id="6552730">new</span><span class="op" id="6552733">(</span><span class="ident" id="6552734"><a href="/crypto/dsa/dsa_test.go.html#6550052">big</a></span><span class="op" id="6552737">.</span><span class="ident" id="6552738">Int</span><span class="op" id="6552741">)</span><span class="op" id="6552742">.</span><span class="ident" id="6552743">SetString</span><span class="op" id="6552752">(</span><span class="string" id="6552753">&#34;5078D4D29795CBE76D3AACFE48C9AF0BCDBEE91A&#34;</span><span class="op" id="6552795">,</span>&nbsp;<span class="num" id="6552797">16</span><span class="op" id="6552799">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552803"><a href="/crypto/dsa/dsa_test.go.html#6550082">testSignAndVerify</a></span><span class="op" id="6552820">(</span><span class="ident" id="6552821"><a href="/crypto/dsa/dsa_test.go.html#6551696">t</a></span><span class="op" id="6552822">,</span>&nbsp;<span class="num" id="6552824">0</span><span class="op" id="6552825">,</span>&nbsp;<span class="op" id="6552827">&amp;</span><span class="ident" id="6552828"><a href="/crypto/dsa/dsa_test.go.html#6551717">priv</a></span><span class="op" id="6552832">)</span><br>
<span class="lineno">85</span><span class="op" id="6552834">}</span>
</div>
</body>
</html>
