<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1433059">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1433115">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1433169">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1433220">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1433298">package</span>&nbsp;<span class="ident" id="1433306">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1433311">import</span>&nbsp;<span class="op" id="1433318">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1433321">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1433332">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="1433339">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1433342">//&nbsp;BUG(mikio):&nbsp;On&nbsp;every&nbsp;POSIX&nbsp;platform,&nbsp;reads&nbsp;from&nbsp;the&nbsp;&#34;ip4&#34;&nbsp;network</span><br>
<span class="lineno">15</span><span class="comment" id="1433411">//&nbsp;using&nbsp;the&nbsp;ReadFrom&nbsp;or&nbsp;ReadFromIP&nbsp;method&nbsp;might&nbsp;not&nbsp;return&nbsp;a&nbsp;complete</span><br>
<span class="lineno"></span><span class="comment" id="1433482">//&nbsp;IPv4&nbsp;packet,&nbsp;including&nbsp;its&nbsp;header,&nbsp;even&nbsp;if&nbsp;there&nbsp;is&nbsp;space</span><br>
<span class="lineno"></span><span class="comment" id="1433543">//&nbsp;available.&nbsp;This&nbsp;can&nbsp;occur&nbsp;even&nbsp;in&nbsp;cases&nbsp;where&nbsp;Read&nbsp;or&nbsp;ReadMsgIP</span><br>
<span class="lineno"></span><span class="comment" id="1433610">//&nbsp;could&nbsp;return&nbsp;a&nbsp;complete&nbsp;packet.&nbsp;For&nbsp;this&nbsp;reason,&nbsp;it&nbsp;is&nbsp;recommended</span><br>
<span class="lineno"></span><span class="comment" id="1433680">//&nbsp;that&nbsp;you&nbsp;do&nbsp;not&nbsp;uses&nbsp;these&nbsp;methods&nbsp;if&nbsp;it&nbsp;is&nbsp;important&nbsp;to&nbsp;receive&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="1433750">//&nbsp;full&nbsp;packet.</span><br>
<span class="lineno"></span><span class="comment" id="1433766">//</span><br>
<span class="lineno"></span><span class="comment" id="1433769">//&nbsp;The&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines&nbsp;make&nbsp;it&nbsp;impossible&nbsp;for&nbsp;us&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="1433835">//&nbsp;change&nbsp;the&nbsp;behavior&nbsp;of&nbsp;these&nbsp;methods;&nbsp;use&nbsp;Read&nbsp;or&nbsp;ReadMsgIP</span><br>
<span class="lineno"></span><span class="comment" id="1433898">//&nbsp;instead.</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="1433911">func</span>&nbsp;<span class="ident" id="1433916">sockaddrToIP</span><span class="op" id="1433928">(</span><span class="ident" id="1433929">sa</span>&nbsp;<span class="ident" id="1433932"><a href="/net/iprawsock_posix.go.html#1433321">syscall</a></span><span class="op" id="1433939">.</span><span class="ident" id="1433940">Sockaddr</span><span class="op" id="1433948">)</span>&nbsp;<span class="ident" id="1433950"><a href="/net/net.go.html#1465097">Addr</a></span>&nbsp;<span class="op" id="1433955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1433958">switch</span>&nbsp;<span class="ident" id="1433965">sa</span>&nbsp;<span class="op" id="1433968">:=</span>&nbsp;<span class="ident" id="1433971"><a href="/net/iprawsock_posix.go.html#1433929">sa</a></span><span class="op" id="1433973">.</span><span class="op" id="1433974">(</span><span class="keyword" id="1433975">type</span><span class="op" id="1433979">)</span>&nbsp;<span class="op" id="1433981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1433984">case</span>&nbsp;<span class="op" id="1433989">*</span><span class="ident" id="1433990"><a href="/net/iprawsock_posix.go.html#1433321">syscall</a></span><span class="op" id="1433997">.</span><span class="ident" id="1433998">SockaddrInet4</span><span class="op" id="1434011">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1434015">return</span>&nbsp;<span class="op" id="1434022">&amp;</span><span class="ident" id="1434023"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="1434029">{</span><span class="ident" id="1434030">IP</span><span class="op" id="1434032">:</span>&nbsp;<span class="ident" id="1434034"><a href="/net/iprawsock_posix.go.html#1433965">sa</a></span><span class="op" id="1434036">.</span><span class="ident" id="1434037">Addr</span><span class="op" id="1434041">[</span><span class="num" id="1434042">0</span><span class="op" id="1434043">:</span><span class="op" id="1434044">]</span><span class="op" id="1434045">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1434048">case</span>&nbsp;<span class="op" id="1434053">*</span><span class="ident" id="1434054"><a href="/net/iprawsock_posix.go.html#1433321">syscall</a></span><span class="op" id="1434061">.</span><span class="ident" id="1434062">SockaddrInet6</span><span class="op" id="1434075">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1434079">return</span>&nbsp;<span class="op" id="1434086">&amp;</span><span class="ident" id="1434087"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="1434093">{</span><span class="ident" id="1434094">IP</span><span class="op" id="1434096">:</span>&nbsp;<span class="ident" id="1434098"><a href="/net/iprawsock_posix.go.html#1433965">sa</a></span><span class="op" id="1434100">.</span><span class="ident" id="1434101">Addr</span><span class="op" id="1434105">[</span><span class="num" id="1434106">0</span><span class="op" id="1434107">:</span><span class="op" id="1434108">]</span><span class="op" id="1434109">,</span>&nbsp;<span class="ident" id="1434111">Zone</span><span class="op" id="1434115">:</span>&nbsp;<span class="ident" id="1434117"><a href="/net/ipsock.go.html#1448067">zoneToString</a></span><span class="op" id="1434129">(</span><span class="builtintype" id="1434130">int</span><span class="op" id="1434133">(</span><span class="ident" id="1434134"><a href="/net/iprawsock_posix.go.html#1433965">sa</a></span><span class="op" id="1434136">.</span><span class="ident" id="1434137">ZoneId</span><span class="op" id="1434143">)</span><span class="op" id="1434144">)</span><span class="op" id="1434145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1434148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1434151">return</span>&nbsp;<span class="ident" id="1434158">nil</span><br>
<span class="lineno"></span><span class="op" id="1434162">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="1434165">func</span>&nbsp;<span class="op" id="1434170">(</span><span class="ident" id="1434171">a</span>&nbsp;<span class="op" id="1434173">*</span><span class="ident" id="1434174"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="1434180">)</span>&nbsp;<span class="ident" id="1434182">family</span><span class="op" id="1434188">(</span><span class="op" id="1434189">)</span>&nbsp;<span class="builtintype" id="1434191">int</span>&nbsp;<span class="op" id="1434195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1434198">if</span>&nbsp;<span class="ident" id="1434201"><a href="/net/iprawsock_posix.go.html#1434171">a</a></span>&nbsp;<span class="op" id="1434203">==</span>&nbsp;<span class="ident" id="1434206">nil</span>&nbsp;<span class="op" id="1434210">||</span>&nbsp;<span class="builtinfunc" id="1434213">len</span><span class="op" id="1434216">(</span><span class="ident" id="1434217"><a href="/net/iprawsock_posix.go.html#1434171">a</a></span><span class="op" id="1434218">.</span><span class="ident" id="1434219">IP</span><span class="op" id="1434221">)</span>&nbsp;<span class="op" id="1434223">&lt;=</span>&nbsp;<span class="ident" id="1434226"><a href="/net/ip.go.html#1416769">IPv4len</a></span>&nbsp;<span class="op" id="1434234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1434238">return</span>&nbsp;<span class="ident" id="1434245"><a href="/net/iprawsock_posix.go.html#1433321">syscall</a></span><span class="op" id="1434252">.</span><span class="ident" id="1434253">AF_INET</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1434262">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1434265">if</span>&nbsp;<span class="ident" id="1434268"><a href="/net/iprawsock_posix.go.html#1434171">a</a></span><span class="op" id="1434269">.</span><span class="ident" id="1434270">IP</span><span class="op" id="1434272">.</span><span class="ident" id="1434273">To4</span><span class="op" id="1434276">(</span><span class="op" id="1434277">)</span>&nbsp;<span class="op" id="1434279">!=</span>&nbsp;<span class="ident" id="1434282">nil</span>&nbsp;<span class="op" id="1434286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1434290">return</span>&nbsp;<span class="ident" id="1434297"><a href="/net/iprawsock_posix.go.html#1433321">syscall</a></span><span class="op" id="1434304">.</span><span class="ident" id="1434305">AF_INET</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1434314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1434317">return</span>&nbsp;<span class="ident" id="1434324"><a href="/net/iprawsock_posix.go.html#1433321">syscall</a></span><span class="op" id="1434331">.</span><span class="ident" id="1434332">AF_INET6</span><br>
<span class="lineno"></span><span class="op" id="1434341">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="1434344">func</span>&nbsp;<span class="op" id="1434349">(</span><span class="ident" id="1434350">a</span>&nbsp;<span class="op" id="1434352">*</span><span class="ident" id="1434353"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="1434359">)</span>&nbsp;<span class="ident" id="1434361">isWildcard</span><span class="op" id="1434371">(</span><span class="op" id="1434372">)</span>&nbsp;<span class="builtintype" id="1434374">bool</span>&nbsp;<span class="op" id="1434379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1434382">if</span>&nbsp;<span class="ident" id="1434385"><a href="/net/iprawsock_posix.go.html#1434350">a</a></span>&nbsp;<span class="op" id="1434387">==</span>&nbsp;<span class="ident" id="1434390">nil</span>&nbsp;<span class="op" id="1434394">||</span>&nbsp;<span class="ident" id="1434397"><a href="/net/iprawsock_posix.go.html#1434350">a</a></span><span class="op" id="1434398">.</span><span class="ident" id="1434399">IP</span>&nbsp;<span class="op" id="1434402">==</span>&nbsp;<span class="ident" id="1434405">nil</span>&nbsp;<span class="op" id="1434409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1434413">return</span>&nbsp;<span class="builtintype" id="1434420">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1434426">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1434429">return</span>&nbsp;<span class="ident" id="1434436"><a href="/net/iprawsock_posix.go.html#1434350">a</a></span><span class="op" id="1434437">.</span><span class="ident" id="1434438">IP</span><span class="op" id="1434440">.</span><span class="ident" id="1434441">IsUnspecified</span><span class="op" id="1434454">(</span><span class="op" id="1434455">)</span><br>
<span class="lineno"></span><span class="op" id="1434457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1434460">func</span>&nbsp;<span class="op" id="1434465">(</span><span class="ident" id="1434466">a</span>&nbsp;<span class="op" id="1434468">*</span><span class="ident" id="1434469"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="1434475">)</span>&nbsp;<span class="ident" id="1434477">sockaddr</span><span class="op" id="1434485">(</span><span class="ident" id="1434486">family</span>&nbsp;<span class="builtintype" id="1434493">int</span><span class="op" id="1434496">)</span>&nbsp;<span class="op" id="1434498">(</span><span class="ident" id="1434499"><a href="/net/iprawsock_posix.go.html#1433321">syscall</a></span><span class="op" id="1434506">.</span><span class="ident" id="1434507">Sockaddr</span><span class="op" id="1434515">,</span>&nbsp;<span class="builtintype" id="1434517">error</span><span class="op" id="1434522">)</span>&nbsp;<span class="op" id="1434524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1434527">if</span>&nbsp;<span class="ident" id="1434530"><a href="/net/iprawsock_posix.go.html#1434466">a</a></span>&nbsp;<span class="op" id="1434532">==</span>&nbsp;<span class="ident" id="1434535">nil</span>&nbsp;<span class="op" id="1434539">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1434543">return</span>&nbsp;<span class="ident" id="1434550">nil</span><span class="op" id="1434553">,</span>&nbsp;<span class="ident" id="1434555">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1434560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1434563">return</span>&nbsp;<span class="ident" id="1434570"><a href="/net/ipsock_posix.go.html#1453030">ipToSockaddr</a></span><span class="op" id="1434582">(</span><span class="ident" id="1434583"><a href="/net/iprawsock_posix.go.html#1434486">family</a></span><span class="op" id="1434589">,</span>&nbsp;<span class="ident" id="1434591"><a href="/net/iprawsock_posix.go.html#1434466">a</a></span><span class="op" id="1434592">.</span><span class="ident" id="1434593">IP</span><span class="op" id="1434595">,</span>&nbsp;<span class="num" id="1434597">0</span><span class="op" id="1434598">,</span>&nbsp;<span class="ident" id="1434600"><a href="/net/iprawsock_posix.go.html#1434466">a</a></span><span class="op" id="1434601">.</span><span class="ident" id="1434602">Zone</span><span class="op" id="1434606">)</span><br>
<span class="lineno"></span><span class="op" id="1434608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="1434611">//&nbsp;IPConn&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;the&nbsp;Conn&nbsp;and&nbsp;PacketConn&nbsp;interfaces</span><br>
<span class="lineno"></span><span class="comment" id="1434681">//&nbsp;for&nbsp;IP&nbsp;network&nbsp;connections.</span><br>
<span class="lineno"></span><span class="keyword" id="1434712">type</span>&nbsp;<span class="ident" id="1434717">IPConn</span>&nbsp;<span class="keyword" id="1434724">struct</span>&nbsp;<span class="op" id="1434731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1434734"><a href="/net/net.go.html#1467102">conn</a></span><br>
<span class="lineno"></span><span class="op" id="1434739">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="1434742">func</span>&nbsp;<span class="ident" id="1434747">newIPConn</span><span class="op" id="1434756">(</span><span class="ident" id="1434757">fd</span>&nbsp;<span class="op" id="1434760">*</span><span class="ident" id="1434761"><a href="/net/fd_unix.go.html#1388279">netFD</a></span><span class="op" id="1434766">)</span>&nbsp;<span class="op" id="1434768">*</span><span class="ident" id="1434769"><a href="/net/iprawsock_posix.go.html#1434717">IPConn</a></span>&nbsp;<span class="op" id="1434776">{</span>&nbsp;<span class="keyword" id="1434778">return</span>&nbsp;<span class="op" id="1434785">&amp;</span><span class="ident" id="1434786"><a href="/net/iprawsock_posix.go.html#1434717">IPConn</a></span><span class="op" id="1434792">{</span><span class="ident" id="1434793"><a href="/net/net.go.html#1467102">conn</a></span><span class="op" id="1434797">{</span><span class="ident" id="1434798"><a href="/net/iprawsock_posix.go.html#1434757">fd</a></span><span class="op" id="1434800">}</span><span class="op" id="1434801">}</span>&nbsp;<span class="op" id="1434803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1434806">//&nbsp;ReadFromIP&nbsp;reads&nbsp;an&nbsp;IP&nbsp;packet&nbsp;from&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload&nbsp;into&nbsp;b.</span><br>
<span class="lineno"></span><span class="comment" id="1434875">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;b&nbsp;and&nbsp;the&nbsp;return&nbsp;address</span><br>
<span class="lineno">70</span><span class="comment" id="1434946">//&nbsp;that&nbsp;was&nbsp;on&nbsp;the&nbsp;packet.</span><br>
<span class="lineno"></span><span class="comment" id="1434973">//</span><br>
<span class="lineno"></span><span class="comment" id="1434976">//&nbsp;ReadFromIP&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;an&nbsp;error&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="1435039">//&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1435106">//&nbsp;SetReadDeadline.</span><br>
<span class="lineno">75</span><span class="keyword" id="1435126">func</span>&nbsp;<span class="op" id="1435131">(</span><span class="ident" id="1435132">c</span>&nbsp;<span class="op" id="1435134">*</span><span class="ident" id="1435135"><a href="/net/iprawsock_posix.go.html#1434717">IPConn</a></span><span class="op" id="1435141">)</span>&nbsp;<span class="ident" id="1435143">ReadFromIP</span><span class="op" id="1435153">(</span><span class="ident" id="1435154">b</span>&nbsp;<span class="op" id="1435156">[</span><span class="op" id="1435157">]</span><span class="builtintype" id="1435158">byte</span><span class="op" id="1435162">)</span>&nbsp;<span class="op" id="1435164">(</span><span class="builtintype" id="1435165">int</span><span class="op" id="1435168">,</span>&nbsp;<span class="op" id="1435170">*</span><span class="ident" id="1435171"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="1435177">,</span>&nbsp;<span class="builtintype" id="1435179">error</span><span class="op" id="1435184">)</span>&nbsp;<span class="op" id="1435186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1435189">if</span>&nbsp;<span class="op" id="1435192">!</span><span class="ident" id="1435193"><a href="/net/iprawsock_posix.go.html#1435132">c</a></span><span class="op" id="1435194">.</span><span class="ident" id="1435195">ok</span><span class="op" id="1435197">(</span><span class="op" id="1435198">)</span>&nbsp;<span class="op" id="1435200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1435204">return</span>&nbsp;<span class="num" id="1435211">0</span><span class="op" id="1435212">,</span>&nbsp;<span class="ident" id="1435214">nil</span><span class="op" id="1435217">,</span>&nbsp;<span class="ident" id="1435219"><a href="/net/iprawsock_posix.go.html#1433321">syscall</a></span><span class="op" id="1435226">.</span><span class="ident" id="1435227">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1435235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1435238">//&nbsp;TODO(cw,rsc):&nbsp;consider&nbsp;using&nbsp;readv&nbsp;if&nbsp;we&nbsp;know&nbsp;the&nbsp;family</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1435299">//&nbsp;type&nbsp;to&nbsp;avoid&nbsp;the&nbsp;header&nbsp;trim/copy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1435338">var</span>&nbsp;<span class="ident" id="1435342">addr</span>&nbsp;<span class="op" id="1435347">*</span><span class="ident" id="1435348"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1435356">n</span><span class="op" id="1435357">,</span>&nbsp;<span class="ident" id="1435359">sa</span><span class="op" id="1435361">,</span>&nbsp;<span class="ident" id="1435363">err</span>&nbsp;<span class="op" id="1435367">:=</span>&nbsp;<span class="ident" id="1435370"><a href="/net/iprawsock_posix.go.html#1435132">c</a></span><span class="op" id="1435371">.</span><span class="ident" id="1435372">fd</span><span class="op" id="1435374">.</span><span class="ident" id="1435375">readFrom</span><span class="op" id="1435383">(</span><span class="ident" id="1435384"><a href="/net/iprawsock_posix.go.html#1435154">b</a></span><span class="op" id="1435385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1435388">switch</span>&nbsp;<span class="ident" id="1435395">sa</span>&nbsp;<span class="op" id="1435398">:=</span>&nbsp;<span class="ident" id="1435401"><a href="/net/iprawsock_posix.go.html#1435359">sa</a></span><span class="op" id="1435403">.</span><span class="op" id="1435404">(</span><span class="keyword" id="1435405">type</span><span class="op" id="1435409">)</span>&nbsp;<span class="op" id="1435411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1435414">case</span>&nbsp;<span class="op" id="1435419">*</span><span class="ident" id="1435420"><a href="/net/iprawsock_posix.go.html#1433321">syscall</a></span><span class="op" id="1435427">.</span><span class="ident" id="1435428">SockaddrInet4</span><span class="op" id="1435441">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1435445"><a href="/net/iprawsock_posix.go.html#1435342">addr</a></span>&nbsp;<span class="op" id="1435450">=</span>&nbsp;<span class="op" id="1435452">&amp;</span><span class="ident" id="1435453"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="1435459">{</span><span class="ident" id="1435460">IP</span><span class="op" id="1435462">:</span>&nbsp;<span class="ident" id="1435464"><a href="/net/iprawsock_posix.go.html#1435395">sa</a></span><span class="op" id="1435466">.</span><span class="ident" id="1435467">Addr</span><span class="op" id="1435471">[</span><span class="num" id="1435472">0</span><span class="op" id="1435473">:</span><span class="op" id="1435474">]</span><span class="op" id="1435475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1435479">if</span>&nbsp;<span class="builtinfunc" id="1435482">len</span><span class="op" id="1435485">(</span><span class="ident" id="1435486"><a href="/net/iprawsock_posix.go.html#1435154">b</a></span><span class="op" id="1435487">)</span>&nbsp;<span class="op" id="1435489">&gt;=</span>&nbsp;<span class="ident" id="1435492"><a href="/net/ip.go.html#1416769">IPv4len</a></span>&nbsp;<span class="op" id="1435500">{</span>&nbsp;<span class="comment" id="1435502">//&nbsp;discard&nbsp;ipv4&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1435528">hsize</span>&nbsp;<span class="op" id="1435534">:=</span>&nbsp;<span class="op" id="1435537">(</span><span class="builtintype" id="1435538">int</span><span class="op" id="1435541">(</span><span class="ident" id="1435542"><a href="/net/iprawsock_posix.go.html#1435154">b</a></span><span class="op" id="1435543">[</span><span class="num" id="1435544">0</span><span class="op" id="1435545">]</span><span class="op" id="1435546">)</span>&nbsp;<span class="op" id="1435548">&amp;</span>&nbsp;<span class="num" id="1435550">0xf</span><span class="op" id="1435553">)</span>&nbsp;<span class="op" id="1435555">*</span>&nbsp;<span class="num" id="1435557">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1435562">copy</span><span class="op" id="1435566">(</span><span class="ident" id="1435567"><a href="/net/iprawsock_posix.go.html#1435154">b</a></span><span class="op" id="1435568">,</span>&nbsp;<span class="ident" id="1435570"><a href="/net/iprawsock_posix.go.html#1435154">b</a></span><span class="op" id="1435571">[</span><span class="ident" id="1435572"><a href="/net/iprawsock_posix.go.html#1435528">hsize</a></span><span class="op" id="1435577">:</span><span class="op" id="1435578">]</span><span class="op" id="1435579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1435584"><a href="/net/iprawsock_posix.go.html#1435356">n</a></span>&nbsp;<span class="op" id="1435586">-=</span>&nbsp;<span class="ident" id="1435589"><a href="/net/iprawsock_posix.go.html#1435528">hsize</a></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1435597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1435600">case</span>&nbsp;<span class="op" id="1435605">*</span><span class="ident" id="1435606"><a href="/net/iprawsock_posix.go.html#1433321">syscall</a></span><span class="op" id="1435613">.</span><span class="ident" id="1435614">SockaddrInet6</span><span class="op" id="1435627">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1435631"><a href="/net/iprawsock_posix.go.html#1435342">addr</a></span>&nbsp;<span class="op" id="1435636">=</span>&nbsp;<span class="op" id="1435638">&amp;</span><span class="ident" id="1435639"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="1435645">{</span><span class="ident" id="1435646">IP</span><span class="op" id="1435648">:</span>&nbsp;<span class="ident" id="1435650"><a href="/net/iprawsock_posix.go.html#1435395">sa</a></span><span class="op" id="1435652">.</span><span class="ident" id="1435653">Addr</span><span class="op" id="1435657">[</span><span class="num" id="1435658">0</span><span class="op" id="1435659">:</span><span class="op" id="1435660">]</span><span class="op" id="1435661">,</span>&nbsp;<span class="ident" id="1435663">Zone</span><span class="op" id="1435667">:</span>&nbsp;<span class="ident" id="1435669"><a href="/net/ipsock.go.html#1448067">zoneToString</a></span><span class="op" id="1435681">(</span><span class="builtintype" id="1435682">int</span><span class="op" id="1435685">(</span><span class="ident" id="1435686"><a href="/net/iprawsock_posix.go.html#1435395">sa</a></span><span class="op" id="1435688">.</span><span class="ident" id="1435689">ZoneId</span><span class="op" id="1435695">)</span><span class="op" id="1435696">)</span><span class="op" id="1435697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1435700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1435703">return</span>&nbsp;<span class="ident" id="1435710"><a href="/net/iprawsock_posix.go.html#1435356">n</a></span><span class="op" id="1435711">,</span>&nbsp;<span class="ident" id="1435713"><a href="/net/iprawsock_posix.go.html#1435342">addr</a></span><span class="op" id="1435717">,</span>&nbsp;<span class="ident" id="1435719"><a href="/net/iprawsock_posix.go.html#1435363">err</a></span><br>
<span class="lineno">95</span><span class="op" id="1435723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1435726">//&nbsp;ReadFrom&nbsp;implements&nbsp;the&nbsp;PacketConn&nbsp;ReadFrom&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="1435781">func</span>&nbsp;<span class="op" id="1435786">(</span><span class="ident" id="1435787">c</span>&nbsp;<span class="op" id="1435789">*</span><span class="ident" id="1435790"><a href="/net/iprawsock_posix.go.html#1434717">IPConn</a></span><span class="op" id="1435796">)</span>&nbsp;<span class="ident" id="1435798">ReadFrom</span><span class="op" id="1435806">(</span><span class="ident" id="1435807">b</span>&nbsp;<span class="op" id="1435809">[</span><span class="op" id="1435810">]</span><span class="builtintype" id="1435811">byte</span><span class="op" id="1435815">)</span>&nbsp;<span class="op" id="1435817">(</span><span class="builtintype" id="1435818">int</span><span class="op" id="1435821">,</span>&nbsp;<span class="ident" id="1435823"><a href="/net/net.go.html#1465097">Addr</a></span><span class="op" id="1435827">,</span>&nbsp;<span class="builtintype" id="1435829">error</span><span class="op" id="1435834">)</span>&nbsp;<span class="op" id="1435836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1435839">if</span>&nbsp;<span class="op" id="1435842">!</span><span class="ident" id="1435843"><a href="/net/iprawsock_posix.go.html#1435787">c</a></span><span class="op" id="1435844">.</span><span class="ident" id="1435845">ok</span><span class="op" id="1435847">(</span><span class="op" id="1435848">)</span>&nbsp;<span class="op" id="1435850">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1435854">return</span>&nbsp;<span class="num" id="1435861">0</span><span class="op" id="1435862">,</span>&nbsp;<span class="ident" id="1435864">nil</span><span class="op" id="1435867">,</span>&nbsp;<span class="ident" id="1435869"><a href="/net/iprawsock_posix.go.html#1433321">syscall</a></span><span class="op" id="1435876">.</span><span class="ident" id="1435877">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1435885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1435888">n</span><span class="op" id="1435889">,</span>&nbsp;<span class="ident" id="1435891">addr</span><span class="op" id="1435895">,</span>&nbsp;<span class="ident" id="1435897">err</span>&nbsp;<span class="op" id="1435901">:=</span>&nbsp;<span class="ident" id="1435904"><a href="/net/iprawsock_posix.go.html#1435787">c</a></span><span class="op" id="1435905">.</span><span class="ident" id="1435906">ReadFromIP</span><span class="op" id="1435916">(</span><span class="ident" id="1435917"><a href="/net/iprawsock_posix.go.html#1435807">b</a></span><span class="op" id="1435918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1435921">return</span>&nbsp;<span class="ident" id="1435928"><a href="/net/iprawsock_posix.go.html#1435888">n</a></span><span class="op" id="1435929">,</span>&nbsp;<span class="ident" id="1435931"><a href="/net/iprawsock_posix.go.html#1435891">addr</a></span><span class="op" id="1435935">.</span><span class="ident" id="1435936">toAddr</span><span class="op" id="1435942">(</span><span class="op" id="1435943">)</span><span class="op" id="1435944">,</span>&nbsp;<span class="ident" id="1435946"><a href="/net/iprawsock_posix.go.html#1435897">err</a></span><br>
<span class="lineno"></span><span class="op" id="1435950">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="1435953">//&nbsp;ReadMsgIP&nbsp;reads&nbsp;a&nbsp;packet&nbsp;from&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload&nbsp;into&nbsp;b&nbsp;and&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1436024">//&nbsp;associated&nbsp;out-of-band&nbsp;data&nbsp;into&nbsp;oob.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1436091">//&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;b,&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;oob,&nbsp;the&nbsp;flags</span><br>
<span class="lineno"></span><span class="comment" id="1436162">//&nbsp;that&nbsp;were&nbsp;set&nbsp;on&nbsp;the&nbsp;packet&nbsp;and&nbsp;the&nbsp;source&nbsp;address&nbsp;of&nbsp;the&nbsp;packet.</span><br>
<span class="lineno">110</span><span class="keyword" id="1436231">func</span>&nbsp;<span class="op" id="1436236">(</span><span class="ident" id="1436237">c</span>&nbsp;<span class="op" id="1436239">*</span><span class="ident" id="1436240"><a href="/net/iprawsock_posix.go.html#1434717">IPConn</a></span><span class="op" id="1436246">)</span>&nbsp;<span class="ident" id="1436248">ReadMsgIP</span><span class="op" id="1436257">(</span><span class="ident" id="1436258">b</span><span class="op" id="1436259">,</span>&nbsp;<span class="ident" id="1436261">oob</span>&nbsp;<span class="op" id="1436265">[</span><span class="op" id="1436266">]</span><span class="builtintype" id="1436267">byte</span><span class="op" id="1436271">)</span>&nbsp;<span class="op" id="1436273">(</span><span class="ident" id="1436274">n</span><span class="op" id="1436275">,</span>&nbsp;<span class="ident" id="1436277">oobn</span><span class="op" id="1436281">,</span>&nbsp;<span class="ident" id="1436283">flags</span>&nbsp;<span class="builtintype" id="1436289">int</span><span class="op" id="1436292">,</span>&nbsp;<span class="ident" id="1436294">addr</span>&nbsp;<span class="op" id="1436299">*</span><span class="ident" id="1436300"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="1436306">,</span>&nbsp;<span class="ident" id="1436308">err</span>&nbsp;<span class="builtintype" id="1436312">error</span><span class="op" id="1436317">)</span>&nbsp;<span class="op" id="1436319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1436322">if</span>&nbsp;<span class="op" id="1436325">!</span><span class="ident" id="1436326"><a href="/net/iprawsock_posix.go.html#1436237">c</a></span><span class="op" id="1436327">.</span><span class="ident" id="1436328">ok</span><span class="op" id="1436330">(</span><span class="op" id="1436331">)</span>&nbsp;<span class="op" id="1436333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1436337">return</span>&nbsp;<span class="num" id="1436344">0</span><span class="op" id="1436345">,</span>&nbsp;<span class="num" id="1436347">0</span><span class="op" id="1436348">,</span>&nbsp;<span class="num" id="1436350">0</span><span class="op" id="1436351">,</span>&nbsp;<span class="ident" id="1436353">nil</span><span class="op" id="1436356">,</span>&nbsp;<span class="ident" id="1436358"><a href="/net/iprawsock_posix.go.html#1433321">syscall</a></span><span class="op" id="1436365">.</span><span class="ident" id="1436366">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1436374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1436377">var</span>&nbsp;<span class="ident" id="1436381">sa</span>&nbsp;<span class="ident" id="1436384"><a href="/net/iprawsock_posix.go.html#1433321">syscall</a></span><span class="op" id="1436391">.</span><span class="ident" id="1436392">Sockaddr</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1436402"><a href="/net/iprawsock_posix.go.html#1436274">n</a></span><span class="op" id="1436403">,</span>&nbsp;<span class="ident" id="1436405"><a href="/net/iprawsock_posix.go.html#1436277">oobn</a></span><span class="op" id="1436409">,</span>&nbsp;<span class="ident" id="1436411"><a href="/net/iprawsock_posix.go.html#1436283">flags</a></span><span class="op" id="1436416">,</span>&nbsp;<span class="ident" id="1436418"><a href="/net/iprawsock_posix.go.html#1436381">sa</a></span><span class="op" id="1436420">,</span>&nbsp;<span class="ident" id="1436422"><a href="/net/iprawsock_posix.go.html#1436308">err</a></span>&nbsp;<span class="op" id="1436426">=</span>&nbsp;<span class="ident" id="1436428"><a href="/net/iprawsock_posix.go.html#1436237">c</a></span><span class="op" id="1436429">.</span><span class="ident" id="1436430">fd</span><span class="op" id="1436432">.</span><span class="ident" id="1436433">readMsg</span><span class="op" id="1436440">(</span><span class="ident" id="1436441"><a href="/net/iprawsock_posix.go.html#1436258">b</a></span><span class="op" id="1436442">,</span>&nbsp;<span class="ident" id="1436444"><a href="/net/iprawsock_posix.go.html#1436261">oob</a></span><span class="op" id="1436447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1436450">switch</span>&nbsp;<span class="ident" id="1436457">sa</span>&nbsp;<span class="op" id="1436460">:=</span>&nbsp;<span class="ident" id="1436463"><a href="/net/iprawsock_posix.go.html#1436381">sa</a></span><span class="op" id="1436465">.</span><span class="op" id="1436466">(</span><span class="keyword" id="1436467">type</span><span class="op" id="1436471">)</span>&nbsp;<span class="op" id="1436473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1436476">case</span>&nbsp;<span class="op" id="1436481">*</span><span class="ident" id="1436482"><a href="/net/iprawsock_posix.go.html#1433321">syscall</a></span><span class="op" id="1436489">.</span><span class="ident" id="1436490">SockaddrInet4</span><span class="op" id="1436503">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1436507"><a href="/net/iprawsock_posix.go.html#1436294">addr</a></span>&nbsp;<span class="op" id="1436512">=</span>&nbsp;<span class="op" id="1436514">&amp;</span><span class="ident" id="1436515"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="1436521">{</span><span class="ident" id="1436522">IP</span><span class="op" id="1436524">:</span>&nbsp;<span class="ident" id="1436526"><a href="/net/iprawsock_posix.go.html#1436457">sa</a></span><span class="op" id="1436528">.</span><span class="ident" id="1436529">Addr</span><span class="op" id="1436533">[</span><span class="num" id="1436534">0</span><span class="op" id="1436535">:</span><span class="op" id="1436536">]</span><span class="op" id="1436537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1436540">case</span>&nbsp;<span class="op" id="1436545">*</span><span class="ident" id="1436546"><a href="/net/iprawsock_posix.go.html#1433321">syscall</a></span><span class="op" id="1436553">.</span><span class="ident" id="1436554">SockaddrInet6</span><span class="op" id="1436567">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1436571"><a href="/net/iprawsock_posix.go.html#1436294">addr</a></span>&nbsp;<span class="op" id="1436576">=</span>&nbsp;<span class="op" id="1436578">&amp;</span><span class="ident" id="1436579"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="1436585">{</span><span class="ident" id="1436586">IP</span><span class="op" id="1436588">:</span>&nbsp;<span class="ident" id="1436590"><a href="/net/iprawsock_posix.go.html#1436457">sa</a></span><span class="op" id="1436592">.</span><span class="ident" id="1436593">Addr</span><span class="op" id="1436597">[</span><span class="num" id="1436598">0</span><span class="op" id="1436599">:</span><span class="op" id="1436600">]</span><span class="op" id="1436601">,</span>&nbsp;<span class="ident" id="1436603">Zone</span><span class="op" id="1436607">:</span>&nbsp;<span class="ident" id="1436609"><a href="/net/ipsock.go.html#1448067">zoneToString</a></span><span class="op" id="1436621">(</span><span class="builtintype" id="1436622">int</span><span class="op" id="1436625">(</span><span class="ident" id="1436626"><a href="/net/iprawsock_posix.go.html#1436457">sa</a></span><span class="op" id="1436628">.</span><span class="ident" id="1436629">ZoneId</span><span class="op" id="1436635">)</span><span class="op" id="1436636">)</span><span class="op" id="1436637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1436640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1436643">return</span><br>
<span class="lineno"></span><span class="op" id="1436650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="1436653">//&nbsp;WriteToIP&nbsp;writes&nbsp;an&nbsp;IP&nbsp;packet&nbsp;to&nbsp;addr&nbsp;via&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload</span><br>
<span class="lineno"></span><span class="comment" id="1436721">//&nbsp;from&nbsp;b.</span><br>
<span class="lineno"></span><span class="comment" id="1436732">//</span><br>
<span class="lineno"></span><span class="comment" id="1436735">//&nbsp;WriteToIP&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;an&nbsp;error&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="1436797">//&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and</span><br>
<span class="lineno">130</span><span class="comment" id="1436864">//&nbsp;SetWriteDeadline.&nbsp;&nbsp;On&nbsp;packet-oriented&nbsp;connections,&nbsp;write&nbsp;timeouts</span><br>
<span class="lineno"></span><span class="comment" id="1436933">//&nbsp;are&nbsp;rare.</span><br>
<span class="lineno"></span><span class="keyword" id="1436946">func</span>&nbsp;<span class="op" id="1436951">(</span><span class="ident" id="1436952">c</span>&nbsp;<span class="op" id="1436954">*</span><span class="ident" id="1436955"><a href="/net/iprawsock_posix.go.html#1434717">IPConn</a></span><span class="op" id="1436961">)</span>&nbsp;<span class="ident" id="1436963">WriteToIP</span><span class="op" id="1436972">(</span><span class="ident" id="1436973">b</span>&nbsp;<span class="op" id="1436975">[</span><span class="op" id="1436976">]</span><span class="builtintype" id="1436977">byte</span><span class="op" id="1436981">,</span>&nbsp;<span class="ident" id="1436983">addr</span>&nbsp;<span class="op" id="1436988">*</span><span class="ident" id="1436989"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="1436995">)</span>&nbsp;<span class="op" id="1436997">(</span><span class="builtintype" id="1436998">int</span><span class="op" id="1437001">,</span>&nbsp;<span class="builtintype" id="1437003">error</span><span class="op" id="1437008">)</span>&nbsp;<span class="op" id="1437010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1437013">if</span>&nbsp;<span class="op" id="1437016">!</span><span class="ident" id="1437017"><a href="/net/iprawsock_posix.go.html#1436952">c</a></span><span class="op" id="1437018">.</span><span class="ident" id="1437019">ok</span><span class="op" id="1437021">(</span><span class="op" id="1437022">)</span>&nbsp;<span class="op" id="1437024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1437028">return</span>&nbsp;<span class="num" id="1437035">0</span><span class="op" id="1437036">,</span>&nbsp;<span class="ident" id="1437038"><a href="/net/iprawsock_posix.go.html#1433321">syscall</a></span><span class="op" id="1437045">.</span><span class="ident" id="1437046">EINVAL</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1437054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1437057">if</span>&nbsp;<span class="ident" id="1437060"><a href="/net/iprawsock_posix.go.html#1436952">c</a></span><span class="op" id="1437061">.</span><span class="ident" id="1437062">fd</span><span class="op" id="1437064">.</span><span class="ident" id="1437065">isConnected</span>&nbsp;<span class="op" id="1437077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1437081">return</span>&nbsp;<span class="num" id="1437088">0</span><span class="op" id="1437089">,</span>&nbsp;<span class="op" id="1437091">&amp;</span><span class="ident" id="1437092"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1437099">{</span><span class="ident" id="1437100">Op</span><span class="op" id="1437102">:</span>&nbsp;<span class="string" id="1437104">&#34;write&#34;</span><span class="op" id="1437111">,</span>&nbsp;<span class="ident" id="1437113">Net</span><span class="op" id="1437116">:</span>&nbsp;<span class="ident" id="1437118"><a href="/net/iprawsock_posix.go.html#1436952">c</a></span><span class="op" id="1437119">.</span><span class="ident" id="1437120">fd</span><span class="op" id="1437122">.</span><span class="ident" id="1437123">net</span><span class="op" id="1437126">,</span>&nbsp;<span class="ident" id="1437128">Addr</span><span class="op" id="1437132">:</span>&nbsp;<span class="ident" id="1437134"><a href="/net/iprawsock_posix.go.html#1436983">addr</a></span><span class="op" id="1437138">,</span>&nbsp;<span class="ident" id="1437140">Err</span><span class="op" id="1437143">:</span>&nbsp;<span class="ident" id="1437145"><a href="/net/net.go.html#1472233">ErrWriteToConnected</a></span><span class="op" id="1437164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1437167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1437170">if</span>&nbsp;<span class="ident" id="1437173"><a href="/net/iprawsock_posix.go.html#1436983">addr</a></span>&nbsp;<span class="op" id="1437178">==</span>&nbsp;<span class="ident" id="1437181">nil</span>&nbsp;<span class="op" id="1437185">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1437189">return</span>&nbsp;<span class="num" id="1437196">0</span><span class="op" id="1437197">,</span>&nbsp;<span class="op" id="1437199">&amp;</span><span class="ident" id="1437200"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1437207">{</span><span class="ident" id="1437208">Op</span><span class="op" id="1437210">:</span>&nbsp;<span class="string" id="1437212">&#34;write&#34;</span><span class="op" id="1437219">,</span>&nbsp;<span class="ident" id="1437221">Net</span><span class="op" id="1437224">:</span>&nbsp;<span class="ident" id="1437226"><a href="/net/iprawsock_posix.go.html#1436952">c</a></span><span class="op" id="1437227">.</span><span class="ident" id="1437228">fd</span><span class="op" id="1437230">.</span><span class="ident" id="1437231">net</span><span class="op" id="1437234">,</span>&nbsp;<span class="ident" id="1437236">Addr</span><span class="op" id="1437240">:</span>&nbsp;<span class="ident" id="1437242">nil</span><span class="op" id="1437245">,</span>&nbsp;<span class="ident" id="1437247">Err</span><span class="op" id="1437250">:</span>&nbsp;<span class="ident" id="1437252"><a href="/net/net.go.html#1472020">errMissingAddress</a></span><span class="op" id="1437269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1437272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1437275">sa</span><span class="op" id="1437277">,</span>&nbsp;<span class="ident" id="1437279">err</span>&nbsp;<span class="op" id="1437283">:=</span>&nbsp;<span class="ident" id="1437286"><a href="/net/iprawsock_posix.go.html#1436983">addr</a></span><span class="op" id="1437290">.</span><span class="ident" id="1437291">sockaddr</span><span class="op" id="1437299">(</span><span class="ident" id="1437300"><a href="/net/iprawsock_posix.go.html#1436952">c</a></span><span class="op" id="1437301">.</span><span class="ident" id="1437302">fd</span><span class="op" id="1437304">.</span><span class="ident" id="1437305">family</span><span class="op" id="1437311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1437314">if</span>&nbsp;<span class="ident" id="1437317"><a href="/net/iprawsock_posix.go.html#1437279">err</a></span>&nbsp;<span class="op" id="1437321">!=</span>&nbsp;<span class="ident" id="1437324">nil</span>&nbsp;<span class="op" id="1437328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1437332">return</span>&nbsp;<span class="num" id="1437339">0</span><span class="op" id="1437340">,</span>&nbsp;<span class="op" id="1437342">&amp;</span><span class="ident" id="1437343"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1437350">{</span><span class="string" id="1437351">&#34;write&#34;</span><span class="op" id="1437358">,</span>&nbsp;<span class="ident" id="1437360"><a href="/net/iprawsock_posix.go.html#1436952">c</a></span><span class="op" id="1437361">.</span><span class="ident" id="1437362">fd</span><span class="op" id="1437364">.</span><span class="ident" id="1437365">net</span><span class="op" id="1437368">,</span>&nbsp;<span class="ident" id="1437370"><a href="/net/iprawsock_posix.go.html#1436983">addr</a></span><span class="op" id="1437374">,</span>&nbsp;<span class="ident" id="1437376"><a href="/net/iprawsock_posix.go.html#1437279">err</a></span><span class="op" id="1437379">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1437382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1437385">return</span>&nbsp;<span class="ident" id="1437392"><a href="/net/iprawsock_posix.go.html#1436952">c</a></span><span class="op" id="1437393">.</span><span class="ident" id="1437394">fd</span><span class="op" id="1437396">.</span><span class="ident" id="1437397">writeTo</span><span class="op" id="1437404">(</span><span class="ident" id="1437405"><a href="/net/iprawsock_posix.go.html#1436973">b</a></span><span class="op" id="1437406">,</span>&nbsp;<span class="ident" id="1437408"><a href="/net/iprawsock_posix.go.html#1437275">sa</a></span><span class="op" id="1437410">)</span><br>
<span class="lineno"></span><span class="op" id="1437412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1437415">//&nbsp;WriteTo&nbsp;implements&nbsp;the&nbsp;PacketConn&nbsp;WriteTo&nbsp;method.</span><br>
<span class="lineno">150</span><span class="keyword" id="1437468">func</span>&nbsp;<span class="op" id="1437473">(</span><span class="ident" id="1437474">c</span>&nbsp;<span class="op" id="1437476">*</span><span class="ident" id="1437477"><a href="/net/iprawsock_posix.go.html#1434717">IPConn</a></span><span class="op" id="1437483">)</span>&nbsp;<span class="ident" id="1437485">WriteTo</span><span class="op" id="1437492">(</span><span class="ident" id="1437493">b</span>&nbsp;<span class="op" id="1437495">[</span><span class="op" id="1437496">]</span><span class="builtintype" id="1437497">byte</span><span class="op" id="1437501">,</span>&nbsp;<span class="ident" id="1437503">addr</span>&nbsp;<span class="ident" id="1437508"><a href="/net/net.go.html#1465097">Addr</a></span><span class="op" id="1437512">)</span>&nbsp;<span class="op" id="1437514">(</span><span class="builtintype" id="1437515">int</span><span class="op" id="1437518">,</span>&nbsp;<span class="builtintype" id="1437520">error</span><span class="op" id="1437525">)</span>&nbsp;<span class="op" id="1437527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1437530">if</span>&nbsp;<span class="op" id="1437533">!</span><span class="ident" id="1437534"><a href="/net/iprawsock_posix.go.html#1437474">c</a></span><span class="op" id="1437535">.</span><span class="ident" id="1437536">ok</span><span class="op" id="1437538">(</span><span class="op" id="1437539">)</span>&nbsp;<span class="op" id="1437541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1437545">return</span>&nbsp;<span class="num" id="1437552">0</span><span class="op" id="1437553">,</span>&nbsp;<span class="ident" id="1437555"><a href="/net/iprawsock_posix.go.html#1433321">syscall</a></span><span class="op" id="1437562">.</span><span class="ident" id="1437563">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1437571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1437574">a</span><span class="op" id="1437575">,</span>&nbsp;<span class="ident" id="1437577">ok</span>&nbsp;<span class="op" id="1437580">:=</span>&nbsp;<span class="ident" id="1437583"><a href="/net/iprawsock_posix.go.html#1437503">addr</a></span><span class="op" id="1437587">.</span><span class="op" id="1437588">(</span><span class="op" id="1437589">*</span><span class="ident" id="1437590"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="1437596">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1437599">if</span>&nbsp;<span class="op" id="1437602">!</span><span class="ident" id="1437603"><a href="/net/iprawsock_posix.go.html#1437577">ok</a></span>&nbsp;<span class="op" id="1437606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1437610">return</span>&nbsp;<span class="num" id="1437617">0</span><span class="op" id="1437618">,</span>&nbsp;<span class="op" id="1437620">&amp;</span><span class="ident" id="1437621"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1437628">{</span><span class="string" id="1437629">&#34;write&#34;</span><span class="op" id="1437636">,</span>&nbsp;<span class="ident" id="1437638"><a href="/net/iprawsock_posix.go.html#1437474">c</a></span><span class="op" id="1437639">.</span><span class="ident" id="1437640">fd</span><span class="op" id="1437642">.</span><span class="ident" id="1437643">net</span><span class="op" id="1437646">,</span>&nbsp;<span class="ident" id="1437648"><a href="/net/iprawsock_posix.go.html#1437503">addr</a></span><span class="op" id="1437652">,</span>&nbsp;<span class="ident" id="1437654"><a href="/net/iprawsock_posix.go.html#1433321">syscall</a></span><span class="op" id="1437661">.</span><span class="ident" id="1437662">EINVAL</span><span class="op" id="1437668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1437671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1437674">return</span>&nbsp;<span class="ident" id="1437681"><a href="/net/iprawsock_posix.go.html#1437474">c</a></span><span class="op" id="1437682">.</span><span class="ident" id="1437683">WriteToIP</span><span class="op" id="1437692">(</span><span class="ident" id="1437693"><a href="/net/iprawsock_posix.go.html#1437493">b</a></span><span class="op" id="1437694">,</span>&nbsp;<span class="ident" id="1437696"><a href="/net/iprawsock_posix.go.html#1437574">a</a></span><span class="op" id="1437697">)</span><br>
<span class="lineno"></span><span class="op" id="1437699">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="comment" id="1437702">//&nbsp;WriteMsgIP&nbsp;writes&nbsp;a&nbsp;packet&nbsp;to&nbsp;addr&nbsp;via&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="1437772">//&nbsp;b&nbsp;and&nbsp;the&nbsp;associated&nbsp;out-of-band&nbsp;data&nbsp;from&nbsp;oob.&nbsp;&nbsp;It&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1437839">//&nbsp;number&nbsp;of&nbsp;payload&nbsp;and&nbsp;out-of-band&nbsp;bytes&nbsp;written.</span><br>
<span class="lineno"></span><span class="keyword" id="1437891">func</span>&nbsp;<span class="op" id="1437896">(</span><span class="ident" id="1437897">c</span>&nbsp;<span class="op" id="1437899">*</span><span class="ident" id="1437900"><a href="/net/iprawsock_posix.go.html#1434717">IPConn</a></span><span class="op" id="1437906">)</span>&nbsp;<span class="ident" id="1437908">WriteMsgIP</span><span class="op" id="1437918">(</span><span class="ident" id="1437919">b</span><span class="op" id="1437920">,</span>&nbsp;<span class="ident" id="1437922">oob</span>&nbsp;<span class="op" id="1437926">[</span><span class="op" id="1437927">]</span><span class="builtintype" id="1437928">byte</span><span class="op" id="1437932">,</span>&nbsp;<span class="ident" id="1437934">addr</span>&nbsp;<span class="op" id="1437939">*</span><span class="ident" id="1437940"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="1437946">)</span>&nbsp;<span class="op" id="1437948">(</span><span class="ident" id="1437949">n</span><span class="op" id="1437950">,</span>&nbsp;<span class="ident" id="1437952">oobn</span>&nbsp;<span class="builtintype" id="1437957">int</span><span class="op" id="1437960">,</span>&nbsp;<span class="ident" id="1437962">err</span>&nbsp;<span class="builtintype" id="1437966">error</span><span class="op" id="1437971">)</span>&nbsp;<span class="op" id="1437973">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1437976">if</span>&nbsp;<span class="op" id="1437979">!</span><span class="ident" id="1437980"><a href="/net/iprawsock_posix.go.html#1437897">c</a></span><span class="op" id="1437981">.</span><span class="ident" id="1437982">ok</span><span class="op" id="1437984">(</span><span class="op" id="1437985">)</span>&nbsp;<span class="op" id="1437987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1437991">return</span>&nbsp;<span class="num" id="1437998">0</span><span class="op" id="1437999">,</span>&nbsp;<span class="num" id="1438001">0</span><span class="op" id="1438002">,</span>&nbsp;<span class="ident" id="1438004"><a href="/net/iprawsock_posix.go.html#1433321">syscall</a></span><span class="op" id="1438011">.</span><span class="ident" id="1438012">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1438020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1438023">if</span>&nbsp;<span class="ident" id="1438026"><a href="/net/iprawsock_posix.go.html#1437897">c</a></span><span class="op" id="1438027">.</span><span class="ident" id="1438028">fd</span><span class="op" id="1438030">.</span><span class="ident" id="1438031">isConnected</span>&nbsp;<span class="op" id="1438043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1438047">return</span>&nbsp;<span class="num" id="1438054">0</span><span class="op" id="1438055">,</span>&nbsp;<span class="num" id="1438057">0</span><span class="op" id="1438058">,</span>&nbsp;<span class="op" id="1438060">&amp;</span><span class="ident" id="1438061"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1438068">{</span><span class="ident" id="1438069">Op</span><span class="op" id="1438071">:</span>&nbsp;<span class="string" id="1438073">&#34;write&#34;</span><span class="op" id="1438080">,</span>&nbsp;<span class="ident" id="1438082">Net</span><span class="op" id="1438085">:</span>&nbsp;<span class="ident" id="1438087"><a href="/net/iprawsock_posix.go.html#1437897">c</a></span><span class="op" id="1438088">.</span><span class="ident" id="1438089">fd</span><span class="op" id="1438091">.</span><span class="ident" id="1438092">net</span><span class="op" id="1438095">,</span>&nbsp;<span class="ident" id="1438097">Addr</span><span class="op" id="1438101">:</span>&nbsp;<span class="ident" id="1438103"><a href="/net/iprawsock_posix.go.html#1437934">addr</a></span><span class="op" id="1438107">,</span>&nbsp;<span class="ident" id="1438109">Err</span><span class="op" id="1438112">:</span>&nbsp;<span class="ident" id="1438114"><a href="/net/net.go.html#1472233">ErrWriteToConnected</a></span><span class="op" id="1438133">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1438136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1438139">if</span>&nbsp;<span class="ident" id="1438142"><a href="/net/iprawsock_posix.go.html#1437934">addr</a></span>&nbsp;<span class="op" id="1438147">==</span>&nbsp;<span class="ident" id="1438150">nil</span>&nbsp;<span class="op" id="1438154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1438158">return</span>&nbsp;<span class="num" id="1438165">0</span><span class="op" id="1438166">,</span>&nbsp;<span class="num" id="1438168">0</span><span class="op" id="1438169">,</span>&nbsp;<span class="op" id="1438171">&amp;</span><span class="ident" id="1438172"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1438179">{</span><span class="ident" id="1438180">Op</span><span class="op" id="1438182">:</span>&nbsp;<span class="string" id="1438184">&#34;write&#34;</span><span class="op" id="1438191">,</span>&nbsp;<span class="ident" id="1438193">Net</span><span class="op" id="1438196">:</span>&nbsp;<span class="ident" id="1438198"><a href="/net/iprawsock_posix.go.html#1437897">c</a></span><span class="op" id="1438199">.</span><span class="ident" id="1438200">fd</span><span class="op" id="1438202">.</span><span class="ident" id="1438203">net</span><span class="op" id="1438206">,</span>&nbsp;<span class="ident" id="1438208">Addr</span><span class="op" id="1438212">:</span>&nbsp;<span class="ident" id="1438214">nil</span><span class="op" id="1438217">,</span>&nbsp;<span class="ident" id="1438219">Err</span><span class="op" id="1438222">:</span>&nbsp;<span class="ident" id="1438224"><a href="/net/net.go.html#1472020">errMissingAddress</a></span><span class="op" id="1438241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1438244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1438247">sa</span><span class="op" id="1438249">,</span>&nbsp;<span class="ident" id="1438251"><a href="/net/iprawsock_posix.go.html#1437962">err</a></span>&nbsp;<span class="op" id="1438255">:=</span>&nbsp;<span class="ident" id="1438258"><a href="/net/iprawsock_posix.go.html#1437934">addr</a></span><span class="op" id="1438262">.</span><span class="ident" id="1438263">sockaddr</span><span class="op" id="1438271">(</span><span class="ident" id="1438272"><a href="/net/iprawsock_posix.go.html#1437897">c</a></span><span class="op" id="1438273">.</span><span class="ident" id="1438274">fd</span><span class="op" id="1438276">.</span><span class="ident" id="1438277">family</span><span class="op" id="1438283">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1438286">if</span>&nbsp;<span class="ident" id="1438289"><a href="/net/iprawsock_posix.go.html#1437962">err</a></span>&nbsp;<span class="op" id="1438293">!=</span>&nbsp;<span class="ident" id="1438296">nil</span>&nbsp;<span class="op" id="1438300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1438304">return</span>&nbsp;<span class="num" id="1438311">0</span><span class="op" id="1438312">,</span>&nbsp;<span class="num" id="1438314">0</span><span class="op" id="1438315">,</span>&nbsp;<span class="op" id="1438317">&amp;</span><span class="ident" id="1438318"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1438325">{</span><span class="string" id="1438326">&#34;write&#34;</span><span class="op" id="1438333">,</span>&nbsp;<span class="ident" id="1438335"><a href="/net/iprawsock_posix.go.html#1437897">c</a></span><span class="op" id="1438336">.</span><span class="ident" id="1438337">fd</span><span class="op" id="1438339">.</span><span class="ident" id="1438340">net</span><span class="op" id="1438343">,</span>&nbsp;<span class="ident" id="1438345"><a href="/net/iprawsock_posix.go.html#1437934">addr</a></span><span class="op" id="1438349">,</span>&nbsp;<span class="ident" id="1438351"><a href="/net/iprawsock_posix.go.html#1437962">err</a></span><span class="op" id="1438354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1438357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1438360">return</span>&nbsp;<span class="ident" id="1438367"><a href="/net/iprawsock_posix.go.html#1437897">c</a></span><span class="op" id="1438368">.</span><span class="ident" id="1438369">fd</span><span class="op" id="1438371">.</span><span class="ident" id="1438372">writeMsg</span><span class="op" id="1438380">(</span><span class="ident" id="1438381"><a href="/net/iprawsock_posix.go.html#1437919">b</a></span><span class="op" id="1438382">,</span>&nbsp;<span class="ident" id="1438384"><a href="/net/iprawsock_posix.go.html#1437922">oob</a></span><span class="op" id="1438387">,</span>&nbsp;<span class="ident" id="1438389"><a href="/net/iprawsock_posix.go.html#1438247">sa</a></span><span class="op" id="1438391">)</span><br>
<span class="lineno"></span><span class="op" id="1438393">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="1438396">//&nbsp;DialIP&nbsp;connects&nbsp;to&nbsp;the&nbsp;remote&nbsp;address&nbsp;raddr&nbsp;on&nbsp;the&nbsp;network&nbsp;protocol</span><br>
<span class="lineno"></span><span class="comment" id="1438467">//&nbsp;netProto,&nbsp;which&nbsp;must&nbsp;be&nbsp;&#34;ip&#34;,&nbsp;&#34;ip4&#34;,&nbsp;or&nbsp;&#34;ip6&#34;&nbsp;followed&nbsp;by&nbsp;a&nbsp;colon</span><br>
<span class="lineno"></span><span class="comment" id="1438536">//&nbsp;and&nbsp;a&nbsp;protocol&nbsp;number&nbsp;or&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="1438570">func</span>&nbsp;<span class="ident" id="1438575">DialIP</span><span class="op" id="1438581">(</span><span class="ident" id="1438582">netProto</span>&nbsp;<span class="builtintype" id="1438591">string</span><span class="op" id="1438597">,</span>&nbsp;<span class="ident" id="1438599">laddr</span><span class="op" id="1438604">,</span>&nbsp;<span class="ident" id="1438606">raddr</span>&nbsp;<span class="op" id="1438612">*</span><span class="ident" id="1438613"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="1438619">)</span>&nbsp;<span class="op" id="1438621">(</span><span class="op" id="1438622">*</span><span class="ident" id="1438623"><a href="/net/iprawsock_posix.go.html#1434717">IPConn</a></span><span class="op" id="1438629">,</span>&nbsp;<span class="builtintype" id="1438631">error</span><span class="op" id="1438636">)</span>&nbsp;<span class="op" id="1438638">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1438641">return</span>&nbsp;<span class="ident" id="1438648"><a href="/net/iprawsock_posix.go.html#1438699">dialIP</a></span><span class="op" id="1438654">(</span><span class="ident" id="1438655"><a href="/net/iprawsock_posix.go.html#1438582">netProto</a></span><span class="op" id="1438663">,</span>&nbsp;<span class="ident" id="1438665"><a href="/net/iprawsock_posix.go.html#1438599">laddr</a></span><span class="op" id="1438670">,</span>&nbsp;<span class="ident" id="1438672"><a href="/net/iprawsock_posix.go.html#1438606">raddr</a></span><span class="op" id="1438677">,</span>&nbsp;<span class="ident" id="1438679"><a href="/net/net.go.html#1473194">noDeadline</a></span><span class="op" id="1438689">)</span><br>
<span class="lineno"></span><span class="op" id="1438691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1438694">func</span>&nbsp;<span class="ident" id="1438699">dialIP</span><span class="op" id="1438705">(</span><span class="ident" id="1438706">netProto</span>&nbsp;<span class="builtintype" id="1438715">string</span><span class="op" id="1438721">,</span>&nbsp;<span class="ident" id="1438723">laddr</span><span class="op" id="1438728">,</span>&nbsp;<span class="ident" id="1438730">raddr</span>&nbsp;<span class="op" id="1438736">*</span><span class="ident" id="1438737"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="1438743">,</span>&nbsp;<span class="ident" id="1438745">deadline</span>&nbsp;<span class="ident" id="1438754"><a href="/net/iprawsock_posix.go.html#1433332">time</a></span><span class="op" id="1438758">.</span><span class="ident" id="1438759">Time</span><span class="op" id="1438763">)</span>&nbsp;<span class="op" id="1438765">(</span><span class="op" id="1438766">*</span><span class="ident" id="1438767"><a href="/net/iprawsock_posix.go.html#1434717">IPConn</a></span><span class="op" id="1438773">,</span>&nbsp;<span class="builtintype" id="1438775">error</span><span class="op" id="1438780">)</span>&nbsp;<span class="op" id="1438782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1438785">net</span><span class="op" id="1438788">,</span>&nbsp;<span class="ident" id="1438790">proto</span><span class="op" id="1438795">,</span>&nbsp;<span class="ident" id="1438797">err</span>&nbsp;<span class="op" id="1438801">:=</span>&nbsp;<span class="ident" id="1438804"><a href="/net/dial.go.html#1332358">parseNetwork</a></span><span class="op" id="1438816">(</span><span class="ident" id="1438817"><a href="/net/iprawsock_posix.go.html#1438706">netProto</a></span><span class="op" id="1438825">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1438828">if</span>&nbsp;<span class="ident" id="1438831"><a href="/net/iprawsock_posix.go.html#1438797">err</a></span>&nbsp;<span class="op" id="1438835">!=</span>&nbsp;<span class="ident" id="1438838">nil</span>&nbsp;<span class="op" id="1438842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1438846">return</span>&nbsp;<span class="ident" id="1438853">nil</span><span class="op" id="1438856">,</span>&nbsp;<span class="op" id="1438858">&amp;</span><span class="ident" id="1438859"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1438866">{</span><span class="ident" id="1438867">Op</span><span class="op" id="1438869">:</span>&nbsp;<span class="string" id="1438871">&#34;dial&#34;</span><span class="op" id="1438877">,</span>&nbsp;<span class="ident" id="1438879">Net</span><span class="op" id="1438882">:</span>&nbsp;<span class="ident" id="1438884"><a href="/net/iprawsock_posix.go.html#1438706">netProto</a></span><span class="op" id="1438892">,</span>&nbsp;<span class="ident" id="1438894">Addr</span><span class="op" id="1438898">:</span>&nbsp;<span class="ident" id="1438900"><a href="/net/iprawsock_posix.go.html#1438730">raddr</a></span><span class="op" id="1438905">,</span>&nbsp;<span class="ident" id="1438907">Err</span><span class="op" id="1438910">:</span>&nbsp;<span class="ident" id="1438912"><a href="/net/iprawsock_posix.go.html#1438797">err</a></span><span class="op" id="1438915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1438918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1438921">switch</span>&nbsp;<span class="ident" id="1438928"><a href="/net/iprawsock_posix.go.html#1438785">net</a></span>&nbsp;<span class="op" id="1438932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1438935">case</span>&nbsp;<span class="string" id="1438940">&#34;ip&#34;</span><span class="op" id="1438944">,</span>&nbsp;<span class="string" id="1438946">&#34;ip4&#34;</span><span class="op" id="1438951">,</span>&nbsp;<span class="string" id="1438953">&#34;ip6&#34;</span><span class="op" id="1438958">:</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1438961">default</span><span class="op" id="1438968">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1438972">return</span>&nbsp;<span class="ident" id="1438979">nil</span><span class="op" id="1438982">,</span>&nbsp;<span class="op" id="1438984">&amp;</span><span class="ident" id="1438985"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1438992">{</span><span class="ident" id="1438993">Op</span><span class="op" id="1438995">:</span>&nbsp;<span class="string" id="1438997">&#34;dial&#34;</span><span class="op" id="1439003">,</span>&nbsp;<span class="ident" id="1439005">Net</span><span class="op" id="1439008">:</span>&nbsp;<span class="ident" id="1439010"><a href="/net/iprawsock_posix.go.html#1438706">netProto</a></span><span class="op" id="1439018">,</span>&nbsp;<span class="ident" id="1439020">Addr</span><span class="op" id="1439024">:</span>&nbsp;<span class="ident" id="1439026"><a href="/net/iprawsock_posix.go.html#1438730">raddr</a></span><span class="op" id="1439031">,</span>&nbsp;<span class="ident" id="1439033">Err</span><span class="op" id="1439036">:</span>&nbsp;<span class="ident" id="1439038"><a href="/net/net.go.html#1473867">UnknownNetworkError</a></span><span class="op" id="1439057">(</span><span class="ident" id="1439058"><a href="/net/iprawsock_posix.go.html#1438706">netProto</a></span><span class="op" id="1439066">)</span><span class="op" id="1439067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1439070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1439073">if</span>&nbsp;<span class="ident" id="1439076"><a href="/net/iprawsock_posix.go.html#1438730">raddr</a></span>&nbsp;<span class="op" id="1439082">==</span>&nbsp;<span class="ident" id="1439085">nil</span>&nbsp;<span class="op" id="1439089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1439093">return</span>&nbsp;<span class="ident" id="1439100">nil</span><span class="op" id="1439103">,</span>&nbsp;<span class="op" id="1439105">&amp;</span><span class="ident" id="1439106"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1439113">{</span><span class="ident" id="1439114">Op</span><span class="op" id="1439116">:</span>&nbsp;<span class="string" id="1439118">&#34;dial&#34;</span><span class="op" id="1439124">,</span>&nbsp;<span class="ident" id="1439126">Net</span><span class="op" id="1439129">:</span>&nbsp;<span class="ident" id="1439131"><a href="/net/iprawsock_posix.go.html#1438706">netProto</a></span><span class="op" id="1439139">,</span>&nbsp;<span class="ident" id="1439141">Addr</span><span class="op" id="1439145">:</span>&nbsp;<span class="ident" id="1439147">nil</span><span class="op" id="1439150">,</span>&nbsp;<span class="ident" id="1439152">Err</span><span class="op" id="1439155">:</span>&nbsp;<span class="ident" id="1439157"><a href="/net/net.go.html#1472020">errMissingAddress</a></span><span class="op" id="1439174">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1439177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1439180">fd</span><span class="op" id="1439182">,</span>&nbsp;<span class="ident" id="1439184"><a href="/net/iprawsock_posix.go.html#1438797">err</a></span>&nbsp;<span class="op" id="1439188">:=</span>&nbsp;<span class="ident" id="1439191"><a href="/net/ipsock_posix.go.html#1452753">internetSocket</a></span><span class="op" id="1439205">(</span><span class="ident" id="1439206"><a href="/net/iprawsock_posix.go.html#1438785">net</a></span><span class="op" id="1439209">,</span>&nbsp;<span class="ident" id="1439211"><a href="/net/iprawsock_posix.go.html#1438723">laddr</a></span><span class="op" id="1439216">,</span>&nbsp;<span class="ident" id="1439218"><a href="/net/iprawsock_posix.go.html#1438730">raddr</a></span><span class="op" id="1439223">,</span>&nbsp;<span class="ident" id="1439225"><a href="/net/iprawsock_posix.go.html#1438745">deadline</a></span><span class="op" id="1439233">,</span>&nbsp;<span class="ident" id="1439235"><a href="/net/iprawsock_posix.go.html#1433321">syscall</a></span><span class="op" id="1439242">.</span><span class="ident" id="1439243">SOCK_RAW</span><span class="op" id="1439251">,</span>&nbsp;<span class="ident" id="1439253"><a href="/net/iprawsock_posix.go.html#1438790">proto</a></span><span class="op" id="1439258">,</span>&nbsp;<span class="string" id="1439260">&#34;dial&#34;</span><span class="op" id="1439266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1439269">if</span>&nbsp;<span class="ident" id="1439272"><a href="/net/iprawsock_posix.go.html#1438797">err</a></span>&nbsp;<span class="op" id="1439276">!=</span>&nbsp;<span class="ident" id="1439279">nil</span>&nbsp;<span class="op" id="1439283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1439287">return</span>&nbsp;<span class="ident" id="1439294">nil</span><span class="op" id="1439297">,</span>&nbsp;<span class="op" id="1439299">&amp;</span><span class="ident" id="1439300"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1439307">{</span><span class="ident" id="1439308">Op</span><span class="op" id="1439310">:</span>&nbsp;<span class="string" id="1439312">&#34;dial&#34;</span><span class="op" id="1439318">,</span>&nbsp;<span class="ident" id="1439320">Net</span><span class="op" id="1439323">:</span>&nbsp;<span class="ident" id="1439325"><a href="/net/iprawsock_posix.go.html#1438706">netProto</a></span><span class="op" id="1439333">,</span>&nbsp;<span class="ident" id="1439335">Addr</span><span class="op" id="1439339">:</span>&nbsp;<span class="ident" id="1439341"><a href="/net/iprawsock_posix.go.html#1438730">raddr</a></span><span class="op" id="1439346">,</span>&nbsp;<span class="ident" id="1439348">Err</span><span class="op" id="1439351">:</span>&nbsp;<span class="ident" id="1439353"><a href="/net/iprawsock_posix.go.html#1438797">err</a></span><span class="op" id="1439356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1439359">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1439362">return</span>&nbsp;<span class="ident" id="1439369"><a href="/net/iprawsock_posix.go.html#1434747">newIPConn</a></span><span class="op" id="1439378">(</span><span class="ident" id="1439379"><a href="/net/iprawsock_posix.go.html#1439180">fd</a></span><span class="op" id="1439381">)</span><span class="op" id="1439382">,</span>&nbsp;<span class="ident" id="1439384">nil</span><br>
<span class="lineno"></span><span class="op" id="1439388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1439391">//&nbsp;ListenIP&nbsp;listens&nbsp;for&nbsp;incoming&nbsp;IP&nbsp;packets&nbsp;addressed&nbsp;to&nbsp;the&nbsp;local</span><br>
<span class="lineno"></span><span class="comment" id="1439458">//&nbsp;address&nbsp;laddr.&nbsp;&nbsp;The&nbsp;returned&nbsp;connection&#39;s&nbsp;ReadFrom&nbsp;and&nbsp;WriteTo</span><br>
<span class="lineno">210</span><span class="comment" id="1439524">//&nbsp;methods&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;receive&nbsp;and&nbsp;send&nbsp;IP&nbsp;packets&nbsp;with&nbsp;per-packet</span><br>
<span class="lineno"></span><span class="comment" id="1439594">//&nbsp;addressing.</span><br>
<span class="lineno"></span><span class="keyword" id="1439609">func</span>&nbsp;<span class="ident" id="1439614">ListenIP</span><span class="op" id="1439622">(</span><span class="ident" id="1439623">netProto</span>&nbsp;<span class="builtintype" id="1439632">string</span><span class="op" id="1439638">,</span>&nbsp;<span class="ident" id="1439640">laddr</span>&nbsp;<span class="op" id="1439646">*</span><span class="ident" id="1439647"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="1439653">)</span>&nbsp;<span class="op" id="1439655">(</span><span class="op" id="1439656">*</span><span class="ident" id="1439657"><a href="/net/iprawsock_posix.go.html#1434717">IPConn</a></span><span class="op" id="1439663">,</span>&nbsp;<span class="builtintype" id="1439665">error</span><span class="op" id="1439670">)</span>&nbsp;<span class="op" id="1439672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1439675">net</span><span class="op" id="1439678">,</span>&nbsp;<span class="ident" id="1439680">proto</span><span class="op" id="1439685">,</span>&nbsp;<span class="ident" id="1439687">err</span>&nbsp;<span class="op" id="1439691">:=</span>&nbsp;<span class="ident" id="1439694"><a href="/net/dial.go.html#1332358">parseNetwork</a></span><span class="op" id="1439706">(</span><span class="ident" id="1439707"><a href="/net/iprawsock_posix.go.html#1439623">netProto</a></span><span class="op" id="1439715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1439718">if</span>&nbsp;<span class="ident" id="1439721"><a href="/net/iprawsock_posix.go.html#1439687">err</a></span>&nbsp;<span class="op" id="1439725">!=</span>&nbsp;<span class="ident" id="1439728">nil</span>&nbsp;<span class="op" id="1439732">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1439736">return</span>&nbsp;<span class="ident" id="1439743">nil</span><span class="op" id="1439746">,</span>&nbsp;<span class="op" id="1439748">&amp;</span><span class="ident" id="1439749"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1439756">{</span><span class="ident" id="1439757">Op</span><span class="op" id="1439759">:</span>&nbsp;<span class="string" id="1439761">&#34;dial&#34;</span><span class="op" id="1439767">,</span>&nbsp;<span class="ident" id="1439769">Net</span><span class="op" id="1439772">:</span>&nbsp;<span class="ident" id="1439774"><a href="/net/iprawsock_posix.go.html#1439623">netProto</a></span><span class="op" id="1439782">,</span>&nbsp;<span class="ident" id="1439784">Addr</span><span class="op" id="1439788">:</span>&nbsp;<span class="ident" id="1439790"><a href="/net/iprawsock_posix.go.html#1439640">laddr</a></span><span class="op" id="1439795">,</span>&nbsp;<span class="ident" id="1439797">Err</span><span class="op" id="1439800">:</span>&nbsp;<span class="ident" id="1439802"><a href="/net/iprawsock_posix.go.html#1439687">err</a></span><span class="op" id="1439805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1439808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1439811">switch</span>&nbsp;<span class="ident" id="1439818"><a href="/net/iprawsock_posix.go.html#1439675">net</a></span>&nbsp;<span class="op" id="1439822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1439825">case</span>&nbsp;<span class="string" id="1439830">&#34;ip&#34;</span><span class="op" id="1439834">,</span>&nbsp;<span class="string" id="1439836">&#34;ip4&#34;</span><span class="op" id="1439841">,</span>&nbsp;<span class="string" id="1439843">&#34;ip6&#34;</span><span class="op" id="1439848">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1439851">default</span><span class="op" id="1439858">:</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1439862">return</span>&nbsp;<span class="ident" id="1439869">nil</span><span class="op" id="1439872">,</span>&nbsp;<span class="op" id="1439874">&amp;</span><span class="ident" id="1439875"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1439882">{</span><span class="ident" id="1439883">Op</span><span class="op" id="1439885">:</span>&nbsp;<span class="string" id="1439887">&#34;listen&#34;</span><span class="op" id="1439895">,</span>&nbsp;<span class="ident" id="1439897">Net</span><span class="op" id="1439900">:</span>&nbsp;<span class="ident" id="1439902"><a href="/net/iprawsock_posix.go.html#1439623">netProto</a></span><span class="op" id="1439910">,</span>&nbsp;<span class="ident" id="1439912">Addr</span><span class="op" id="1439916">:</span>&nbsp;<span class="ident" id="1439918"><a href="/net/iprawsock_posix.go.html#1439640">laddr</a></span><span class="op" id="1439923">,</span>&nbsp;<span class="ident" id="1439925">Err</span><span class="op" id="1439928">:</span>&nbsp;<span class="ident" id="1439930"><a href="/net/net.go.html#1473867">UnknownNetworkError</a></span><span class="op" id="1439949">(</span><span class="ident" id="1439950"><a href="/net/iprawsock_posix.go.html#1439623">netProto</a></span><span class="op" id="1439958">)</span><span class="op" id="1439959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1439962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1439965">fd</span><span class="op" id="1439967">,</span>&nbsp;<span class="ident" id="1439969"><a href="/net/iprawsock_posix.go.html#1439687">err</a></span>&nbsp;<span class="op" id="1439973">:=</span>&nbsp;<span class="ident" id="1439976"><a href="/net/ipsock_posix.go.html#1452753">internetSocket</a></span><span class="op" id="1439990">(</span><span class="ident" id="1439991"><a href="/net/iprawsock_posix.go.html#1439675">net</a></span><span class="op" id="1439994">,</span>&nbsp;<span class="ident" id="1439996"><a href="/net/iprawsock_posix.go.html#1439640">laddr</a></span><span class="op" id="1440001">,</span>&nbsp;<span class="ident" id="1440003">nil</span><span class="op" id="1440006">,</span>&nbsp;<span class="ident" id="1440008"><a href="/net/net.go.html#1473194">noDeadline</a></span><span class="op" id="1440018">,</span>&nbsp;<span class="ident" id="1440020"><a href="/net/iprawsock_posix.go.html#1433321">syscall</a></span><span class="op" id="1440027">.</span><span class="ident" id="1440028">SOCK_RAW</span><span class="op" id="1440036">,</span>&nbsp;<span class="ident" id="1440038"><a href="/net/iprawsock_posix.go.html#1439680">proto</a></span><span class="op" id="1440043">,</span>&nbsp;<span class="string" id="1440045">&#34;listen&#34;</span><span class="op" id="1440053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1440056">if</span>&nbsp;<span class="ident" id="1440059"><a href="/net/iprawsock_posix.go.html#1439687">err</a></span>&nbsp;<span class="op" id="1440063">!=</span>&nbsp;<span class="ident" id="1440066">nil</span>&nbsp;<span class="op" id="1440070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1440074">return</span>&nbsp;<span class="ident" id="1440081">nil</span><span class="op" id="1440084">,</span>&nbsp;<span class="op" id="1440086">&amp;</span><span class="ident" id="1440087"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1440094">{</span><span class="ident" id="1440095">Op</span><span class="op" id="1440097">:</span>&nbsp;<span class="string" id="1440099">&#34;listen&#34;</span><span class="op" id="1440107">,</span>&nbsp;<span class="ident" id="1440109">Net</span><span class="op" id="1440112">:</span>&nbsp;<span class="ident" id="1440114"><a href="/net/iprawsock_posix.go.html#1439623">netProto</a></span><span class="op" id="1440122">,</span>&nbsp;<span class="ident" id="1440124">Addr</span><span class="op" id="1440128">:</span>&nbsp;<span class="ident" id="1440130"><a href="/net/iprawsock_posix.go.html#1439640">laddr</a></span><span class="op" id="1440135">,</span>&nbsp;<span class="ident" id="1440137">Err</span><span class="op" id="1440140">:</span>&nbsp;<span class="ident" id="1440142"><a href="/net/iprawsock_posix.go.html#1439687">err</a></span><span class="op" id="1440145">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1440148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1440151">return</span>&nbsp;<span class="ident" id="1440158"><a href="/net/iprawsock_posix.go.html#1434747">newIPConn</a></span><span class="op" id="1440167">(</span><span class="ident" id="1440168"><a href="/net/iprawsock_posix.go.html#1439965">fd</a></span><span class="op" id="1440170">)</span><span class="op" id="1440171">,</span>&nbsp;<span class="ident" id="1440173">nil</span><br>
<span class="lineno"></span><span class="op" id="1440177">}</span>
</div>
</body>
</html>
