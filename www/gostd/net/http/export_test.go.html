<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html" class="current">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7848923">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7848979">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7849033">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="7849084">//&nbsp;Bridge&nbsp;package&nbsp;to&nbsp;expose&nbsp;http&nbsp;internals&nbsp;to&nbsp;tests&nbsp;in&nbsp;the&nbsp;http_test</span><br>
<span class="lineno"></span><span class="comment" id="7849153">//&nbsp;package.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7849166">package</span>&nbsp;<span class="ident" id="7849174">http</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="7849180">import</span>&nbsp;<span class="op" id="7849187">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7849190">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7849197">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7849208">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7849215">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7849218">func</span>&nbsp;<span class="ident" id="7849223">NewLoggingConn</span><span class="op" id="7849237">(</span><span class="ident" id="7849238">baseName</span>&nbsp;<span class="builtintype" id="7849247">string</span><span class="op" id="7849253">,</span>&nbsp;<span class="ident" id="7849255">c</span>&nbsp;<span class="ident" id="7849257">net</span><span class="op" id="7849260">.</span><span class="ident" id="7849261">Conn</span><span class="op" id="7849265">)</span>&nbsp;<span class="ident" id="7849267">net</span><span class="op" id="7849270">.</span><span class="ident" id="7849271">Conn</span>&nbsp;<span class="op" id="7849276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7849279">return</span>&nbsp;<span class="ident" id="7849286">newLoggingConn</span><span class="op" id="7849300">(</span><span class="ident" id="7849301">baseName</span><span class="op" id="7849309">,</span>&nbsp;<span class="ident" id="7849311">c</span><span class="op" id="7849312">)</span><br>
<span class="lineno"></span><span class="op" id="7849314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="7849317">var</span>&nbsp;<span class="ident" id="7849321">ExportAppendTime</span>&nbsp;<span class="op" id="7849338">=</span>&nbsp;<span class="ident" id="7849340">appendTime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7849352">func</span>&nbsp;<span class="op" id="7849357">(</span><span class="ident" id="7849358">t</span>&nbsp;<span class="op" id="7849360">*</span><span class="ident" id="7849361">Transport</span><span class="op" id="7849370">)</span>&nbsp;<span class="ident" id="7849372">NumPendingRequestsForTesting</span><span class="op" id="7849400">(</span><span class="op" id="7849401">)</span>&nbsp;<span class="builtintype" id="7849403">int</span>&nbsp;<span class="op" id="7849407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7849410">t</span><span class="op" id="7849411">.</span><span class="ident" id="7849412">reqMu</span><span class="op" id="7849417">.</span><span class="ident" id="7849418">Lock</span><span class="op" id="7849422">(</span><span class="op" id="7849423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7849426">defer</span>&nbsp;<span class="ident" id="7849432">t</span><span class="op" id="7849433">.</span><span class="ident" id="7849434">reqMu</span><span class="op" id="7849439">.</span><span class="ident" id="7849440">Unlock</span><span class="op" id="7849446">(</span><span class="op" id="7849447">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7849450">return</span>&nbsp;<span class="builtinfunc" id="7849457">len</span><span class="op" id="7849460">(</span><span class="ident" id="7849461">t</span><span class="op" id="7849462">.</span><span class="ident" id="7849463">reqCanceler</span><span class="op" id="7849474">)</span><br>
<span class="lineno"></span><span class="op" id="7849476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7849479">func</span>&nbsp;<span class="op" id="7849484">(</span><span class="ident" id="7849485">t</span>&nbsp;<span class="op" id="7849487">*</span><span class="ident" id="7849488">Transport</span><span class="op" id="7849497">)</span>&nbsp;<span class="ident" id="7849499">IdleConnKeysForTesting</span><span class="op" id="7849521">(</span><span class="op" id="7849522">)</span>&nbsp;<span class="op" id="7849524">(</span><span class="ident" id="7849525">keys</span>&nbsp;<span class="op" id="7849530">[</span><span class="op" id="7849531">]</span><span class="builtintype" id="7849532">string</span><span class="op" id="7849538">)</span>&nbsp;<span class="op" id="7849540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7849543">keys</span>&nbsp;<span class="op" id="7849548">=</span>&nbsp;<span class="builtinfunc" id="7849550">make</span><span class="op" id="7849554">(</span><span class="op" id="7849555">[</span><span class="op" id="7849556">]</span><span class="builtintype" id="7849557">string</span><span class="op" id="7849563">,</span>&nbsp;<span class="num" id="7849565">0</span><span class="op" id="7849566">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7849569">t</span><span class="op" id="7849570">.</span><span class="ident" id="7849571">idleMu</span><span class="op" id="7849577">.</span><span class="ident" id="7849578">Lock</span><span class="op" id="7849582">(</span><span class="op" id="7849583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7849586">defer</span>&nbsp;<span class="ident" id="7849592">t</span><span class="op" id="7849593">.</span><span class="ident" id="7849594">idleMu</span><span class="op" id="7849600">.</span><span class="ident" id="7849601">Unlock</span><span class="op" id="7849607">(</span><span class="op" id="7849608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7849611">if</span>&nbsp;<span class="ident" id="7849614">t</span><span class="op" id="7849615">.</span><span class="ident" id="7849616">idleConn</span>&nbsp;<span class="op" id="7849625">==</span>&nbsp;<span class="builtintype" id="7849628">nil</span>&nbsp;<span class="op" id="7849632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7849636">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7849644">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7849647">for</span>&nbsp;<span class="ident" id="7849651">key</span>&nbsp;<span class="op" id="7849655">:=</span>&nbsp;<span class="keyword" id="7849658">range</span>&nbsp;<span class="ident" id="7849664">t</span><span class="op" id="7849665">.</span><span class="ident" id="7849666">idleConn</span>&nbsp;<span class="op" id="7849675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7849679">keys</span>&nbsp;<span class="op" id="7849684">=</span>&nbsp;<span class="builtinfunc" id="7849686">append</span><span class="op" id="7849692">(</span><span class="ident" id="7849693">keys</span><span class="op" id="7849697">,</span>&nbsp;<span class="ident" id="7849699">key</span><span class="op" id="7849702">.</span><span class="ident" id="7849703">String</span><span class="op" id="7849709">(</span><span class="op" id="7849710">)</span><span class="op" id="7849711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7849714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7849717">return</span><br>
<span class="lineno"></span><span class="op" id="7849724">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="7849727">func</span>&nbsp;<span class="op" id="7849732">(</span><span class="ident" id="7849733">t</span>&nbsp;<span class="op" id="7849735">*</span><span class="ident" id="7849736">Transport</span><span class="op" id="7849745">)</span>&nbsp;<span class="ident" id="7849747">IdleConnCountForTesting</span><span class="op" id="7849770">(</span><span class="ident" id="7849771">cacheKey</span>&nbsp;<span class="builtintype" id="7849780">string</span><span class="op" id="7849786">)</span>&nbsp;<span class="builtintype" id="7849788">int</span>&nbsp;<span class="op" id="7849792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7849795">t</span><span class="op" id="7849796">.</span><span class="ident" id="7849797">idleMu</span><span class="op" id="7849803">.</span><span class="ident" id="7849804">Lock</span><span class="op" id="7849808">(</span><span class="op" id="7849809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7849812">defer</span>&nbsp;<span class="ident" id="7849818">t</span><span class="op" id="7849819">.</span><span class="ident" id="7849820">idleMu</span><span class="op" id="7849826">.</span><span class="ident" id="7849827">Unlock</span><span class="op" id="7849833">(</span><span class="op" id="7849834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7849837">if</span>&nbsp;<span class="ident" id="7849840">t</span><span class="op" id="7849841">.</span><span class="ident" id="7849842">idleConn</span>&nbsp;<span class="op" id="7849851">==</span>&nbsp;<span class="builtintype" id="7849854">nil</span>&nbsp;<span class="op" id="7849858">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7849862">return</span>&nbsp;<span class="num" id="7849869">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7849872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7849875">for</span>&nbsp;<span class="ident" id="7849879">k</span><span class="op" id="7849880">,</span>&nbsp;<span class="ident" id="7849882">conns</span>&nbsp;<span class="op" id="7849888">:=</span>&nbsp;<span class="keyword" id="7849891">range</span>&nbsp;<span class="ident" id="7849897">t</span><span class="op" id="7849898">.</span><span class="ident" id="7849899">idleConn</span>&nbsp;<span class="op" id="7849908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7849912">if</span>&nbsp;<span class="ident" id="7849915">k</span><span class="op" id="7849916">.</span><span class="ident" id="7849917">String</span><span class="op" id="7849923">(</span><span class="op" id="7849924">)</span>&nbsp;<span class="op" id="7849926">==</span>&nbsp;<span class="ident" id="7849929">cacheKey</span>&nbsp;<span class="op" id="7849938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7849943">return</span>&nbsp;<span class="builtinfunc" id="7849950">len</span><span class="op" id="7849953">(</span><span class="ident" id="7849954">conns</span><span class="op" id="7849959">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7849963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7849966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7849969">return</span>&nbsp;<span class="num" id="7849976">0</span><br>
<span class="lineno"></span><span class="op" id="7849978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="7849981">func</span>&nbsp;<span class="op" id="7849986">(</span><span class="ident" id="7849987">t</span>&nbsp;<span class="op" id="7849989">*</span><span class="ident" id="7849990">Transport</span><span class="op" id="7849999">)</span>&nbsp;<span class="ident" id="7850001">IdleConnChMapSizeForTesting</span><span class="op" id="7850028">(</span><span class="op" id="7850029">)</span>&nbsp;<span class="builtintype" id="7850031">int</span>&nbsp;<span class="op" id="7850035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7850038">t</span><span class="op" id="7850039">.</span><span class="ident" id="7850040">idleMu</span><span class="op" id="7850046">.</span><span class="ident" id="7850047">Lock</span><span class="op" id="7850051">(</span><span class="op" id="7850052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7850055">defer</span>&nbsp;<span class="ident" id="7850061">t</span><span class="op" id="7850062">.</span><span class="ident" id="7850063">idleMu</span><span class="op" id="7850069">.</span><span class="ident" id="7850070">Unlock</span><span class="op" id="7850076">(</span><span class="op" id="7850077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7850080">return</span>&nbsp;<span class="builtinfunc" id="7850087">len</span><span class="op" id="7850090">(</span><span class="ident" id="7850091">t</span><span class="op" id="7850092">.</span><span class="ident" id="7850093">idleConnCh</span><span class="op" id="7850103">)</span><br>
<span class="lineno"></span><span class="op" id="7850105">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="7850108">func</span>&nbsp;<span class="op" id="7850113">(</span><span class="ident" id="7850114">t</span>&nbsp;<span class="op" id="7850116">*</span><span class="ident" id="7850117">Transport</span><span class="op" id="7850126">)</span>&nbsp;<span class="ident" id="7850128">IsIdleForTesting</span><span class="op" id="7850144">(</span><span class="op" id="7850145">)</span>&nbsp;<span class="builtintype" id="7850147">bool</span>&nbsp;<span class="op" id="7850152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7850155">t</span><span class="op" id="7850156">.</span><span class="ident" id="7850157">idleMu</span><span class="op" id="7850163">.</span><span class="ident" id="7850164">Lock</span><span class="op" id="7850168">(</span><span class="op" id="7850169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7850172">defer</span>&nbsp;<span class="ident" id="7850178">t</span><span class="op" id="7850179">.</span><span class="ident" id="7850180">idleMu</span><span class="op" id="7850186">.</span><span class="ident" id="7850187">Unlock</span><span class="op" id="7850193">(</span><span class="op" id="7850194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7850197">return</span>&nbsp;<span class="ident" id="7850204">t</span><span class="op" id="7850205">.</span><span class="ident" id="7850206">wantIdle</span><br>
<span class="lineno">65</span><span class="op" id="7850215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7850218">func</span>&nbsp;<span class="op" id="7850223">(</span><span class="ident" id="7850224">t</span>&nbsp;<span class="op" id="7850226">*</span><span class="ident" id="7850227">Transport</span><span class="op" id="7850236">)</span>&nbsp;<span class="ident" id="7850238">RequestIdleConnChForTesting</span><span class="op" id="7850265">(</span><span class="op" id="7850266">)</span>&nbsp;<span class="op" id="7850268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7850271">t</span><span class="op" id="7850272">.</span><span class="ident" id="7850273">getIdleConnCh</span><span class="op" id="7850286">(</span><span class="ident" id="7850287">connectMethod</span><span class="op" id="7850300">{</span><span class="builtintype" id="7850301">nil</span><span class="op" id="7850304">,</span>&nbsp;<span class="string" id="7850306">&#34;http&#34;</span><span class="op" id="7850312">,</span>&nbsp;<span class="string" id="7850314">&#34;example.com&#34;</span><span class="op" id="7850327">}</span><span class="op" id="7850328">)</span><br>
<span class="lineno"></span><span class="op" id="7850330">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="7850333">func</span>&nbsp;<span class="op" id="7850338">(</span><span class="ident" id="7850339">t</span>&nbsp;<span class="op" id="7850341">*</span><span class="ident" id="7850342">Transport</span><span class="op" id="7850351">)</span>&nbsp;<span class="ident" id="7850353">PutIdleTestConn</span><span class="op" id="7850368">(</span><span class="op" id="7850369">)</span>&nbsp;<span class="builtintype" id="7850371">bool</span>&nbsp;<span class="op" id="7850376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7850379">c</span><span class="op" id="7850380">,</span>&nbsp;<span class="ident" id="7850382">_</span>&nbsp;<span class="op" id="7850384">:=</span>&nbsp;<span class="ident" id="7850387">net</span><span class="op" id="7850390">.</span><span class="ident" id="7850391">Pipe</span><span class="op" id="7850395">(</span><span class="op" id="7850396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7850399">return</span>&nbsp;<span class="ident" id="7850406">t</span><span class="op" id="7850407">.</span><span class="ident" id="7850408">putIdleConn</span><span class="op" id="7850419">(</span><span class="op" id="7850420">&amp;</span><span class="ident" id="7850421">persistConn</span><span class="op" id="7850432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7850436">t</span><span class="op" id="7850437">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7850446">t</span><span class="op" id="7850447">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7850451">conn</span><span class="op" id="7850455">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7850461">c</span><span class="op" id="7850462">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7850482">//&nbsp;dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7850493">closech</span><span class="op" id="7850500">:</span>&nbsp;&nbsp;<span class="builtinfunc" id="7850503">make</span><span class="op" id="7850507">(</span><span class="keyword" id="7850508">chan</span>&nbsp;<span class="keyword" id="7850513">struct</span><span class="op" id="7850519">{</span><span class="op" id="7850520">}</span><span class="op" id="7850521">)</span><span class="op" id="7850522">,</span>&nbsp;<span class="comment" id="7850524">//&nbsp;so&nbsp;it&nbsp;can&nbsp;be&nbsp;closed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7850549">cacheKey</span><span class="op" id="7850557">:</span>&nbsp;<span class="ident" id="7850559">connectMethodKey</span><span class="op" id="7850575">{</span><span class="string" id="7850576">&#34;&#34;</span><span class="op" id="7850578">,</span>&nbsp;<span class="string" id="7850580">&#34;http&#34;</span><span class="op" id="7850586">,</span>&nbsp;<span class="string" id="7850588">&#34;example.com&#34;</span><span class="op" id="7850601">}</span><span class="op" id="7850602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7850605">}</span><span class="op" id="7850606">)</span><br>
<span class="lineno"></span><span class="op" id="7850608">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="keyword" id="7850611">func</span>&nbsp;<span class="ident" id="7850616">NewTestTimeoutHandler</span><span class="op" id="7850637">(</span><span class="ident" id="7850638">handler</span>&nbsp;<span class="ident" id="7850646">Handler</span><span class="op" id="7850653">,</span>&nbsp;<span class="ident" id="7850655">ch</span>&nbsp;<span class="op" id="7850658">&lt;-</span><span class="keyword" id="7850660">chan</span>&nbsp;<span class="ident" id="7850665">time</span><span class="op" id="7850669">.</span><span class="ident" id="7850670">Time</span><span class="op" id="7850674">)</span>&nbsp;<span class="ident" id="7850676">Handler</span>&nbsp;<span class="op" id="7850684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7850687">f</span>&nbsp;<span class="op" id="7850689">:=</span>&nbsp;<span class="keyword" id="7850692">func</span><span class="op" id="7850696">(</span><span class="op" id="7850697">)</span>&nbsp;<span class="op" id="7850699">&lt;-</span><span class="keyword" id="7850701">chan</span>&nbsp;<span class="ident" id="7850706">time</span><span class="op" id="7850710">.</span><span class="ident" id="7850711">Time</span>&nbsp;<span class="op" id="7850716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7850720">return</span>&nbsp;<span class="ident" id="7850727">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7850731">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7850734">return</span>&nbsp;<span class="op" id="7850741">&amp;</span><span class="ident" id="7850742">timeoutHandler</span><span class="op" id="7850756">{</span><span class="ident" id="7850757">handler</span><span class="op" id="7850764">,</span>&nbsp;<span class="ident" id="7850766">f</span><span class="op" id="7850767">,</span>&nbsp;<span class="string" id="7850769">&#34;&#34;</span><span class="op" id="7850771">}</span><br>
<span class="lineno"></span><span class="op" id="7850773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7850776">func</span>&nbsp;<span class="ident" id="7850781">ResetCachedEnvironment</span><span class="op" id="7850803">(</span><span class="op" id="7850804">)</span>&nbsp;<span class="op" id="7850806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7850809">httpProxyEnv</span><span class="op" id="7850821">.</span><span class="ident" id="7850822">reset</span><span class="op" id="7850827">(</span><span class="op" id="7850828">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7850831">httpsProxyEnv</span><span class="op" id="7850844">.</span><span class="ident" id="7850845">reset</span><span class="op" id="7850850">(</span><span class="op" id="7850851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7850854">noProxyEnv</span><span class="op" id="7850864">.</span><span class="ident" id="7850865">reset</span><span class="op" id="7850870">(</span><span class="op" id="7850871">)</span><br>
<span class="lineno"></span><span class="op" id="7850873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7850876">var</span>&nbsp;<span class="ident" id="7850880">DefaultUserAgent</span>&nbsp;<span class="op" id="7850897">=</span>&nbsp;<span class="ident" id="7850899">defaultUserAgent</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="7850917">func</span>&nbsp;<span class="ident" id="7850922">ExportRefererForURL</span><span class="op" id="7850941">(</span><span class="ident" id="7850942">lastReq</span><span class="op" id="7850949">,</span>&nbsp;<span class="ident" id="7850951">newReq</span>&nbsp;<span class="op" id="7850958">*</span><span class="ident" id="7850959">url</span><span class="op" id="7850962">.</span><span class="ident" id="7850963">URL</span><span class="op" id="7850966">)</span>&nbsp;<span class="builtintype" id="7850968">string</span>&nbsp;<span class="op" id="7850975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7850978">return</span>&nbsp;<span class="ident" id="7850985">refererForURL</span><span class="op" id="7850998">(</span><span class="ident" id="7850999">lastReq</span><span class="op" id="7851006">,</span>&nbsp;<span class="ident" id="7851008">newReq</span><span class="op" id="7851014">)</span><br>
<span class="lineno"></span><span class="op" id="7851016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="7851019">//&nbsp;SetPendingDialHooks&nbsp;sets&nbsp;the&nbsp;hooks&nbsp;that&nbsp;run&nbsp;before&nbsp;and&nbsp;after&nbsp;handling</span><br>
<span class="lineno"></span><span class="comment" id="7851092">//&nbsp;pending&nbsp;dials.</span><br>
<span class="lineno"></span><span class="keyword" id="7851110">func</span>&nbsp;<span class="ident" id="7851115">SetPendingDialHooks</span><span class="op" id="7851134">(</span><span class="ident" id="7851135">before</span><span class="op" id="7851141">,</span>&nbsp;<span class="ident" id="7851143">after</span>&nbsp;<span class="keyword" id="7851149">func</span><span class="op" id="7851153">(</span><span class="op" id="7851154">)</span><span class="op" id="7851155">)</span>&nbsp;<span class="op" id="7851157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7851160">prePendingDial</span><span class="op" id="7851174">,</span>&nbsp;<span class="ident" id="7851176">postPendingDial</span>&nbsp;<span class="op" id="7851192">=</span>&nbsp;<span class="ident" id="7851194">before</span><span class="op" id="7851200">,</span>&nbsp;<span class="ident" id="7851202">after</span><br>
<span class="lineno"></span><span class="op" id="7851208">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="keyword" id="7851211">var</span>&nbsp;<span class="ident" id="7851215">ExportServerNewConn</span>&nbsp;<span class="op" id="7851235">=</span>&nbsp;<span class="op" id="7851237">(</span><span class="op" id="7851238">*</span><span class="ident" id="7851239">Server</span><span class="op" id="7851245">)</span><span class="op" id="7851246">.</span><span class="ident" id="7851247">newConn</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7851256">var</span>&nbsp;<span class="ident" id="7851260">ExportCloseWriteAndWait</span>&nbsp;<span class="op" id="7851284">=</span>&nbsp;<span class="op" id="7851286">(</span><span class="op" id="7851287">*</span><span class="ident" id="7851288">conn</span><span class="op" id="7851292">)</span><span class="op" id="7851293">.</span><span class="ident" id="7851294">closeWriteAndWait</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
