<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html" class="current">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7674582">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7674637">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7674691">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7674742">package</span>&nbsp;<span class="ident" id="7674750">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7674760">//&nbsp;Tests&nbsp;for&nbsp;mulitple-template&nbsp;parsing&nbsp;and&nbsp;execution.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7674815">import</span>&nbsp;<span class="op" id="7674822">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7674825">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7674834">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7674841">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7674852">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7674863">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7674885">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7674888">const</span>&nbsp;<span class="op" id="7674894">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7674897">noError</span>&nbsp;&nbsp;<span class="op" id="7674906">=</span>&nbsp;<span class="builtintype" id="7674908">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7674914">hasError</span>&nbsp;<span class="op" id="7674923">=</span>&nbsp;<span class="builtintype" id="7674925">false</span><br>
<span class="lineno">20</span><span class="op" id="7674931">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7674934">type</span>&nbsp;<span class="ident" id="7674939">multiParseTest</span>&nbsp;<span class="keyword" id="7674954">struct</span>&nbsp;<span class="op" id="7674961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7674964">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7674972">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7674980">input</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7674988">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7674996">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7675004">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7675010">names</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7675018">[</span><span class="op" id="7675019">]</span><span class="builtintype" id="7675020">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7675028">results</span>&nbsp;<span class="op" id="7675036">[</span><span class="op" id="7675037">]</span><span class="builtintype" id="7675038">string</span><br>
<span class="lineno"></span><span class="op" id="7675045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="7675048">var</span>&nbsp;<span class="ident" id="7675052">multiParseTests</span>&nbsp;<span class="op" id="7675068">=</span>&nbsp;<span class="op" id="7675070">[</span><span class="op" id="7675071">]</span><span class="ident" id="7675072">multiParseTest</span><span class="op" id="7675086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7675089">{</span><span class="string" id="7675090">&#34;empty&#34;</span><span class="op" id="7675097">,</span>&nbsp;<span class="string" id="7675099">&#34;&#34;</span><span class="op" id="7675101">,</span>&nbsp;<span class="ident" id="7675103">noError</span><span class="op" id="7675110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7675114">nil</span><span class="op" id="7675117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7675121">nil</span><span class="op" id="7675124">}</span><span class="op" id="7675125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7675128">{</span><span class="string" id="7675129">&#34;one&#34;</span><span class="op" id="7675134">,</span>&nbsp;<span class="string" id="7675136">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}`</span><span class="op" id="7675166">,</span>&nbsp;<span class="ident" id="7675168">noError</span><span class="op" id="7675175">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7675179">[</span><span class="op" id="7675180">]</span><span class="builtintype" id="7675181">string</span><span class="op" id="7675187">{</span><span class="string" id="7675188">&#34;foo&#34;</span><span class="op" id="7675193">}</span><span class="op" id="7675194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7675198">[</span><span class="op" id="7675199">]</span><span class="builtintype" id="7675200">string</span><span class="op" id="7675206">{</span><span class="string" id="7675207">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="7675214">}</span><span class="op" id="7675215">}</span><span class="op" id="7675216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7675219">{</span><span class="string" id="7675220">&#34;two&#34;</span><span class="op" id="7675225">,</span>&nbsp;<span class="string" id="7675227">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}{{define&nbsp;&#34;bar&#34;}}&nbsp;BAR&nbsp;{{end}}`</span><span class="op" id="7675285">,</span>&nbsp;<span class="ident" id="7675287">noError</span><span class="op" id="7675294">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7675298">[</span><span class="op" id="7675299">]</span><span class="builtintype" id="7675300">string</span><span class="op" id="7675306">{</span><span class="string" id="7675307">&#34;foo&#34;</span><span class="op" id="7675312">,</span>&nbsp;<span class="string" id="7675314">&#34;bar&#34;</span><span class="op" id="7675319">}</span><span class="op" id="7675320">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7675324">[</span><span class="op" id="7675325">]</span><span class="builtintype" id="7675326">string</span><span class="op" id="7675332">{</span><span class="string" id="7675333">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="7675340">,</span>&nbsp;<span class="string" id="7675342">&#34;&nbsp;BAR&nbsp;&#34;</span><span class="op" id="7675349">}</span><span class="op" id="7675350">}</span><span class="op" id="7675351">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7675354">//&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7675365">{</span><span class="string" id="7675366">&#34;missing&nbsp;end&#34;</span><span class="op" id="7675379">,</span>&nbsp;<span class="string" id="7675381">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;`</span><span class="op" id="7675404">,</span>&nbsp;<span class="ident" id="7675406">hasError</span><span class="op" id="7675414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7675418">nil</span><span class="op" id="7675421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7675425">nil</span><span class="op" id="7675428">}</span><span class="op" id="7675429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7675432">{</span><span class="string" id="7675433">&#34;malformed&nbsp;name&#34;</span><span class="op" id="7675449">,</span>&nbsp;<span class="string" id="7675451">`{{define&nbsp;&#34;foo}}&nbsp;FOO&nbsp;`</span><span class="op" id="7675473">,</span>&nbsp;<span class="ident" id="7675475">hasError</span><span class="op" id="7675483">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7675487">nil</span><span class="op" id="7675490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7675494">nil</span><span class="op" id="7675497">}</span><span class="op" id="7675498">,</span><br>
<span class="lineno"></span><span class="op" id="7675500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7675503">func</span>&nbsp;<span class="ident" id="7675508">TestMultiParse</span><span class="op" id="7675522">(</span><span class="ident" id="7675523">t</span>&nbsp;<span class="op" id="7675525">*</span><span class="ident" id="7675526">testing</span><span class="op" id="7675533">.</span><span class="ident" id="7675534">T</span><span class="op" id="7675535">)</span>&nbsp;<span class="op" id="7675537">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7675540">for</span>&nbsp;<span class="ident" id="7675544">_</span><span class="op" id="7675545">,</span>&nbsp;<span class="ident" id="7675547">test</span>&nbsp;<span class="op" id="7675552">:=</span>&nbsp;<span class="keyword" id="7675555">range</span>&nbsp;<span class="ident" id="7675561">multiParseTests</span>&nbsp;<span class="op" id="7675577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7675581">template</span><span class="op" id="7675589">,</span>&nbsp;<span class="ident" id="7675591">err</span>&nbsp;<span class="op" id="7675595">:=</span>&nbsp;<span class="ident" id="7675598">New</span><span class="op" id="7675601">(</span><span class="string" id="7675602">&#34;root&#34;</span><span class="op" id="7675608">)</span><span class="op" id="7675609">.</span><span class="ident" id="7675610">Parse</span><span class="op" id="7675615">(</span><span class="ident" id="7675616">test</span><span class="op" id="7675620">.</span><span class="ident" id="7675621">input</span><span class="op" id="7675626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7675630">switch</span>&nbsp;<span class="op" id="7675637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7675641">case</span>&nbsp;<span class="ident" id="7675646">err</span>&nbsp;<span class="op" id="7675650">==</span>&nbsp;<span class="ident" id="7675653">nil</span>&nbsp;<span class="op" id="7675657">&amp;&amp;</span>&nbsp;<span class="op" id="7675660">!</span><span class="ident" id="7675661">test</span><span class="op" id="7675665">.</span><span class="ident" id="7675666">ok</span><span class="op" id="7675668">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7675673">t</span><span class="op" id="7675674">.</span><span class="ident" id="7675675">Errorf</span><span class="op" id="7675681">(</span><span class="string" id="7675682">&#34;%q:&nbsp;expected&nbsp;error;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7675712">,</span>&nbsp;<span class="ident" id="7675714">test</span><span class="op" id="7675718">.</span><span class="ident" id="7675719">name</span><span class="op" id="7675723">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7675728">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7675739">case</span>&nbsp;<span class="ident" id="7675744">err</span>&nbsp;<span class="op" id="7675748">!=</span>&nbsp;<span class="ident" id="7675751">nil</span>&nbsp;<span class="op" id="7675755">&amp;&amp;</span>&nbsp;<span class="ident" id="7675758">test</span><span class="op" id="7675762">.</span><span class="ident" id="7675763">ok</span><span class="op" id="7675765">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7675770">t</span><span class="op" id="7675771">.</span><span class="ident" id="7675772">Errorf</span><span class="op" id="7675778">(</span><span class="string" id="7675779">&#34;%q:&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7675805">,</span>&nbsp;<span class="ident" id="7675807">test</span><span class="op" id="7675811">.</span><span class="ident" id="7675812">name</span><span class="op" id="7675816">,</span>&nbsp;<span class="ident" id="7675818">err</span><span class="op" id="7675821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7675826">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7675837">case</span>&nbsp;<span class="ident" id="7675842">err</span>&nbsp;<span class="op" id="7675846">!=</span>&nbsp;<span class="ident" id="7675849">nil</span>&nbsp;<span class="op" id="7675853">&amp;&amp;</span>&nbsp;<span class="op" id="7675856">!</span><span class="ident" id="7675857">test</span><span class="op" id="7675861">.</span><span class="ident" id="7675862">ok</span><span class="op" id="7675864">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7675869">//&nbsp;expected&nbsp;error,&nbsp;got&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7675899">if</span>&nbsp;<span class="op" id="7675902">*</span><span class="ident" id="7675903">debug</span>&nbsp;<span class="op" id="7675909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7675915">fmt</span><span class="op" id="7675918">.</span><span class="ident" id="7675919">Printf</span><span class="op" id="7675925">(</span><span class="string" id="7675926">&#34;%s:&nbsp;%s\n\t%s\n&#34;</span><span class="op" id="7675942">,</span>&nbsp;<span class="ident" id="7675944">test</span><span class="op" id="7675948">.</span><span class="ident" id="7675949">name</span><span class="op" id="7675953">,</span>&nbsp;<span class="ident" id="7675955">test</span><span class="op" id="7675959">.</span><span class="ident" id="7675960">input</span><span class="op" id="7675965">,</span>&nbsp;<span class="ident" id="7675967">err</span><span class="op" id="7675970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7675975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7675980">continue</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7675991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7675995">if</span>&nbsp;<span class="ident" id="7675998">template</span>&nbsp;<span class="op" id="7676007">==</span>&nbsp;<span class="ident" id="7676010">nil</span>&nbsp;<span class="op" id="7676014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7676019">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7676030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7676034">if</span>&nbsp;<span class="builtinfunc" id="7676037">len</span><span class="op" id="7676040">(</span><span class="ident" id="7676041">template</span><span class="op" id="7676049">.</span><span class="ident" id="7676050">tmpl</span><span class="op" id="7676054">)</span>&nbsp;<span class="op" id="7676056">!=</span>&nbsp;<span class="builtinfunc" id="7676059">len</span><span class="op" id="7676062">(</span><span class="ident" id="7676063">test</span><span class="op" id="7676067">.</span><span class="ident" id="7676068">names</span><span class="op" id="7676073">)</span><span class="op" id="7676074">+</span><span class="num" id="7676075">1</span>&nbsp;<span class="op" id="7676077">{</span>&nbsp;<span class="comment" id="7676079">//&nbsp;+1&nbsp;for&nbsp;root</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7676097">t</span><span class="op" id="7676098">.</span><span class="ident" id="7676099">Errorf</span><span class="op" id="7676105">(</span><span class="string" id="7676106">&#34;%s:&nbsp;wrong&nbsp;number&nbsp;of&nbsp;templates;&nbsp;wanted&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7676155">,</span>&nbsp;<span class="ident" id="7676157">test</span><span class="op" id="7676161">.</span><span class="ident" id="7676162">name</span><span class="op" id="7676166">,</span>&nbsp;<span class="builtinfunc" id="7676168">len</span><span class="op" id="7676171">(</span><span class="ident" id="7676172">test</span><span class="op" id="7676176">.</span><span class="ident" id="7676177">names</span><span class="op" id="7676182">)</span><span class="op" id="7676183">,</span>&nbsp;<span class="builtinfunc" id="7676185">len</span><span class="op" id="7676188">(</span><span class="ident" id="7676189">template</span><span class="op" id="7676197">.</span><span class="ident" id="7676198">tmpl</span><span class="op" id="7676202">)</span><span class="op" id="7676203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7676208">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7676219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7676223">for</span>&nbsp;<span class="ident" id="7676227">i</span><span class="op" id="7676228">,</span>&nbsp;<span class="ident" id="7676230">name</span>&nbsp;<span class="op" id="7676235">:=</span>&nbsp;<span class="keyword" id="7676238">range</span>&nbsp;<span class="ident" id="7676244">test</span><span class="op" id="7676248">.</span><span class="ident" id="7676249">names</span>&nbsp;<span class="op" id="7676255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7676260">tmpl</span><span class="op" id="7676264">,</span>&nbsp;<span class="ident" id="7676266">ok</span>&nbsp;<span class="op" id="7676269">:=</span>&nbsp;<span class="ident" id="7676272">template</span><span class="op" id="7676280">.</span><span class="ident" id="7676281">tmpl</span><span class="op" id="7676285">[</span><span class="ident" id="7676286">name</span><span class="op" id="7676290">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7676295">if</span>&nbsp;<span class="op" id="7676298">!</span><span class="ident" id="7676299">ok</span>&nbsp;<span class="op" id="7676302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7676308">t</span><span class="op" id="7676309">.</span><span class="ident" id="7676310">Errorf</span><span class="op" id="7676316">(</span><span class="string" id="7676317">&#34;%s:&nbsp;can&#39;t&nbsp;find&nbsp;template&nbsp;%q&#34;</span><span class="op" id="7676345">,</span>&nbsp;<span class="ident" id="7676347">test</span><span class="op" id="7676351">.</span><span class="ident" id="7676352">name</span><span class="op" id="7676356">,</span>&nbsp;<span class="ident" id="7676358">name</span><span class="op" id="7676362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7676368">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7676380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7676385">result</span>&nbsp;<span class="op" id="7676392">:=</span>&nbsp;<span class="ident" id="7676395">tmpl</span><span class="op" id="7676399">.</span><span class="ident" id="7676400">Root</span><span class="op" id="7676404">.</span><span class="ident" id="7676405">String</span><span class="op" id="7676411">(</span><span class="op" id="7676412">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7676417">if</span>&nbsp;<span class="ident" id="7676420">result</span>&nbsp;<span class="op" id="7676427">!=</span>&nbsp;<span class="ident" id="7676430">test</span><span class="op" id="7676434">.</span><span class="ident" id="7676435">results</span><span class="op" id="7676442">[</span><span class="ident" id="7676443">i</span><span class="op" id="7676444">]</span>&nbsp;<span class="op" id="7676446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7676452">t</span><span class="op" id="7676453">.</span><span class="ident" id="7676454">Errorf</span><span class="op" id="7676460">(</span><span class="string" id="7676461">&#34;%s=(%q):&nbsp;got\n\t%v\nexpected\n\t%v&#34;</span><span class="op" id="7676497">,</span>&nbsp;<span class="ident" id="7676499">test</span><span class="op" id="7676503">.</span><span class="ident" id="7676504">name</span><span class="op" id="7676508">,</span>&nbsp;<span class="ident" id="7676510">test</span><span class="op" id="7676514">.</span><span class="ident" id="7676515">input</span><span class="op" id="7676520">,</span>&nbsp;<span class="ident" id="7676522">result</span><span class="op" id="7676528">,</span>&nbsp;<span class="ident" id="7676530">test</span><span class="op" id="7676534">.</span><span class="ident" id="7676535">results</span><span class="op" id="7676542">[</span><span class="ident" id="7676543">i</span><span class="op" id="7676544">]</span><span class="op" id="7676545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7676550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7676554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7676557">}</span><br>
<span class="lineno">85</span><span class="op" id="7676559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7676562">var</span>&nbsp;<span class="ident" id="7676566">multiExecTests</span>&nbsp;<span class="op" id="7676581">=</span>&nbsp;<span class="op" id="7676583">[</span><span class="op" id="7676584">]</span><span class="ident" id="7676585">execTest</span><span class="op" id="7676593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7676596">{</span><span class="string" id="7676597">&#34;empty&#34;</span><span class="op" id="7676604">,</span>&nbsp;<span class="string" id="7676606">&#34;&#34;</span><span class="op" id="7676608">,</span>&nbsp;<span class="string" id="7676610">&#34;&#34;</span><span class="op" id="7676612">,</span>&nbsp;<span class="ident" id="7676614">nil</span><span class="op" id="7676617">,</span>&nbsp;<span class="builtintype" id="7676619">true</span><span class="op" id="7676623">}</span><span class="op" id="7676624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7676627">{</span><span class="string" id="7676628">&#34;text&#34;</span><span class="op" id="7676634">,</span>&nbsp;<span class="string" id="7676636">&#34;some&nbsp;text&#34;</span><span class="op" id="7676647">,</span>&nbsp;<span class="string" id="7676649">&#34;some&nbsp;text&#34;</span><span class="op" id="7676660">,</span>&nbsp;<span class="ident" id="7676662">nil</span><span class="op" id="7676665">,</span>&nbsp;<span class="builtintype" id="7676667">true</span><span class="op" id="7676671">}</span><span class="op" id="7676672">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7676675">{</span><span class="string" id="7676676">&#34;invoke&nbsp;x&#34;</span><span class="op" id="7676686">,</span>&nbsp;<span class="string" id="7676688">`{{template&nbsp;&#34;x&#34;&nbsp;.SI}}`</span><span class="op" id="7676710">,</span>&nbsp;<span class="string" id="7676712">&#34;TEXT&#34;</span><span class="op" id="7676718">,</span>&nbsp;<span class="ident" id="7676720">tVal</span><span class="op" id="7676724">,</span>&nbsp;<span class="builtintype" id="7676726">true</span><span class="op" id="7676730">}</span><span class="op" id="7676731">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7676734">{</span><span class="string" id="7676735">&#34;invoke&nbsp;x&nbsp;no&nbsp;args&#34;</span><span class="op" id="7676753">,</span>&nbsp;<span class="string" id="7676755">`{{template&nbsp;&#34;x&#34;}}`</span><span class="op" id="7676773">,</span>&nbsp;<span class="string" id="7676775">&#34;TEXT&#34;</span><span class="op" id="7676781">,</span>&nbsp;<span class="ident" id="7676783">tVal</span><span class="op" id="7676787">,</span>&nbsp;<span class="builtintype" id="7676789">true</span><span class="op" id="7676793">}</span><span class="op" id="7676794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7676797">{</span><span class="string" id="7676798">&#34;invoke&nbsp;dot&nbsp;int&#34;</span><span class="op" id="7676814">,</span>&nbsp;<span class="string" id="7676816">`{{template&nbsp;&#34;dot&#34;&nbsp;.I}}`</span><span class="op" id="7676839">,</span>&nbsp;<span class="string" id="7676841">&#34;17&#34;</span><span class="op" id="7676845">,</span>&nbsp;<span class="ident" id="7676847">tVal</span><span class="op" id="7676851">,</span>&nbsp;<span class="builtintype" id="7676853">true</span><span class="op" id="7676857">}</span><span class="op" id="7676858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7676861">{</span><span class="string" id="7676862">&#34;invoke&nbsp;dot&nbsp;[]int&#34;</span><span class="op" id="7676880">,</span>&nbsp;<span class="string" id="7676882">`{{template&nbsp;&#34;dot&#34;&nbsp;.SI}}`</span><span class="op" id="7676906">,</span>&nbsp;<span class="string" id="7676908">&#34;[3&nbsp;4&nbsp;5]&#34;</span><span class="op" id="7676917">,</span>&nbsp;<span class="ident" id="7676919">tVal</span><span class="op" id="7676923">,</span>&nbsp;<span class="builtintype" id="7676925">true</span><span class="op" id="7676929">}</span><span class="op" id="7676930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7676933">{</span><span class="string" id="7676934">&#34;invoke&nbsp;dotV&#34;</span><span class="op" id="7676947">,</span>&nbsp;<span class="string" id="7676949">`{{template&nbsp;&#34;dotV&#34;&nbsp;.U}}`</span><span class="op" id="7676973">,</span>&nbsp;<span class="string" id="7676975">&#34;v&#34;</span><span class="op" id="7676978">,</span>&nbsp;<span class="ident" id="7676980">tVal</span><span class="op" id="7676984">,</span>&nbsp;<span class="builtintype" id="7676986">true</span><span class="op" id="7676990">}</span><span class="op" id="7676991">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7676994">{</span><span class="string" id="7676995">&#34;invoke&nbsp;nested&nbsp;int&#34;</span><span class="op" id="7677014">,</span>&nbsp;<span class="string" id="7677016">`{{template&nbsp;&#34;nested&#34;&nbsp;.I}}`</span><span class="op" id="7677042">,</span>&nbsp;<span class="string" id="7677044">&#34;17&#34;</span><span class="op" id="7677048">,</span>&nbsp;<span class="ident" id="7677050">tVal</span><span class="op" id="7677054">,</span>&nbsp;<span class="builtintype" id="7677056">true</span><span class="op" id="7677060">}</span><span class="op" id="7677061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7677064">{</span><span class="string" id="7677065">&#34;variable&nbsp;declared&nbsp;by&nbsp;template&#34;</span><span class="op" id="7677096">,</span>&nbsp;<span class="string" id="7677098">`{{template&nbsp;&#34;nested&#34;&nbsp;$x:=.SI}},{{index&nbsp;$x&nbsp;1}}`</span><span class="op" id="7677144">,</span>&nbsp;<span class="string" id="7677146">&#34;[3&nbsp;4&nbsp;5],4&#34;</span><span class="op" id="7677157">,</span>&nbsp;<span class="ident" id="7677159">tVal</span><span class="op" id="7677163">,</span>&nbsp;<span class="builtintype" id="7677165">true</span><span class="op" id="7677169">}</span><span class="op" id="7677170">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7677174">//&nbsp;User-defined&nbsp;function:&nbsp;test&nbsp;argument&nbsp;evaluator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7677226">{</span><span class="string" id="7677227">&#34;testFunc&nbsp;literal&#34;</span><span class="op" id="7677245">,</span>&nbsp;<span class="string" id="7677247">`{{oneArg&nbsp;&#34;joe&#34;}}`</span><span class="op" id="7677265">,</span>&nbsp;<span class="string" id="7677267">&#34;oneArg=joe&#34;</span><span class="op" id="7677279">,</span>&nbsp;<span class="ident" id="7677281">tVal</span><span class="op" id="7677285">,</span>&nbsp;<span class="builtintype" id="7677287">true</span><span class="op" id="7677291">}</span><span class="op" id="7677292">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7677295">{</span><span class="string" id="7677296">&#34;testFunc&nbsp;.&#34;</span><span class="op" id="7677308">,</span>&nbsp;<span class="string" id="7677310">`{{oneArg&nbsp;.}}`</span><span class="op" id="7677324">,</span>&nbsp;<span class="string" id="7677326">&#34;oneArg=joe&#34;</span><span class="op" id="7677338">,</span>&nbsp;<span class="string" id="7677340">&#34;joe&#34;</span><span class="op" id="7677345">,</span>&nbsp;<span class="builtintype" id="7677347">true</span><span class="op" id="7677351">}</span><span class="op" id="7677352">,</span><br>
<span class="lineno"></span><span class="op" id="7677354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7677357">//&nbsp;These&nbsp;strings&nbsp;are&nbsp;also&nbsp;in&nbsp;testdata/*.</span><br>
<span class="lineno"></span><span class="keyword" id="7677398">const</span>&nbsp;<span class="ident" id="7677404">multiText1</span>&nbsp;<span class="op" id="7677415">=</span>&nbsp;<span class="string" id="7677417">`<br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;{{define&nbsp;&#34;x&#34;}}TEXT{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;{{define&nbsp;&#34;dotV&#34;}}{{.V}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7677481">const</span>&nbsp;<span class="ident" id="7677487">multiText2</span>&nbsp;<span class="op" id="7677498">=</span>&nbsp;<span class="string" id="7677500">`<br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;{{define&nbsp;&#34;dot&#34;}}{{.}}{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;{{define&nbsp;&#34;nested&#34;}}{{template&nbsp;&#34;dot&#34;&nbsp;.}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7677583">func</span>&nbsp;<span class="ident" id="7677588">TestMultiExecute</span><span class="op" id="7677604">(</span><span class="ident" id="7677605">t</span>&nbsp;<span class="op" id="7677607">*</span><span class="ident" id="7677608">testing</span><span class="op" id="7677615">.</span><span class="ident" id="7677616">T</span><span class="op" id="7677617">)</span>&nbsp;<span class="op" id="7677619">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7677622">//&nbsp;Declare&nbsp;a&nbsp;couple&nbsp;of&nbsp;templates&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7677663">template</span><span class="op" id="7677671">,</span>&nbsp;<span class="ident" id="7677673">err</span>&nbsp;<span class="op" id="7677677">:=</span>&nbsp;<span class="ident" id="7677680">New</span><span class="op" id="7677683">(</span><span class="string" id="7677684">&#34;root&#34;</span><span class="op" id="7677690">)</span><span class="op" id="7677691">.</span><span class="ident" id="7677692">Parse</span><span class="op" id="7677697">(</span><span class="ident" id="7677698">multiText1</span><span class="op" id="7677708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7677711">if</span>&nbsp;<span class="ident" id="7677714">err</span>&nbsp;<span class="op" id="7677718">!=</span>&nbsp;<span class="ident" id="7677721">nil</span>&nbsp;<span class="op" id="7677725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7677729">t</span><span class="op" id="7677730">.</span><span class="ident" id="7677731">Fatalf</span><span class="op" id="7677737">(</span><span class="string" id="7677738">&#34;parse&nbsp;error&nbsp;for&nbsp;1:&nbsp;%s&#34;</span><span class="op" id="7677761">,</span>&nbsp;<span class="ident" id="7677763">err</span><span class="op" id="7677766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7677769">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7677772">_</span><span class="op" id="7677773">,</span>&nbsp;<span class="ident" id="7677775">err</span>&nbsp;<span class="op" id="7677779">=</span>&nbsp;<span class="ident" id="7677781">template</span><span class="op" id="7677789">.</span><span class="ident" id="7677790">Parse</span><span class="op" id="7677795">(</span><span class="ident" id="7677796">multiText2</span><span class="op" id="7677806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7677809">if</span>&nbsp;<span class="ident" id="7677812">err</span>&nbsp;<span class="op" id="7677816">!=</span>&nbsp;<span class="ident" id="7677819">nil</span>&nbsp;<span class="op" id="7677823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7677827">t</span><span class="op" id="7677828">.</span><span class="ident" id="7677829">Fatalf</span><span class="op" id="7677835">(</span><span class="string" id="7677836">&#34;parse&nbsp;error&nbsp;for&nbsp;2:&nbsp;%s&#34;</span><span class="op" id="7677859">,</span>&nbsp;<span class="ident" id="7677861">err</span><span class="op" id="7677864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7677867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7677870">testExecute</span><span class="op" id="7677881">(</span><span class="ident" id="7677882">multiExecTests</span><span class="op" id="7677896">,</span>&nbsp;<span class="ident" id="7677898">template</span><span class="op" id="7677906">,</span>&nbsp;<span class="ident" id="7677908">t</span><span class="op" id="7677909">)</span><br>
<span class="lineno">125</span><span class="op" id="7677911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7677914">func</span>&nbsp;<span class="ident" id="7677919">TestParseFiles</span><span class="op" id="7677933">(</span><span class="ident" id="7677934">t</span>&nbsp;<span class="op" id="7677936">*</span><span class="ident" id="7677937">testing</span><span class="op" id="7677944">.</span><span class="ident" id="7677945">T</span><span class="op" id="7677946">)</span>&nbsp;<span class="op" id="7677948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7677951">_</span><span class="op" id="7677952">,</span>&nbsp;<span class="ident" id="7677954">err</span>&nbsp;<span class="op" id="7677958">:=</span>&nbsp;<span class="ident" id="7677961">ParseFiles</span><span class="op" id="7677971">(</span><span class="string" id="7677972">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="7677988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7677991">if</span>&nbsp;<span class="ident" id="7677994">err</span>&nbsp;<span class="op" id="7677998">==</span>&nbsp;<span class="ident" id="7678001">nil</span>&nbsp;<span class="op" id="7678005">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7678009">t</span><span class="op" id="7678010">.</span><span class="ident" id="7678011">Error</span><span class="op" id="7678016">(</span><span class="string" id="7678017">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7678065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7678068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7678071">template</span>&nbsp;<span class="op" id="7678080">:=</span>&nbsp;<span class="ident" id="7678083">New</span><span class="op" id="7678086">(</span><span class="string" id="7678087">&#34;root&#34;</span><span class="op" id="7678093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7678096">_</span><span class="op" id="7678097">,</span>&nbsp;<span class="ident" id="7678099">err</span>&nbsp;<span class="op" id="7678103">=</span>&nbsp;<span class="ident" id="7678105">template</span><span class="op" id="7678113">.</span><span class="ident" id="7678114">ParseFiles</span><span class="op" id="7678124">(</span><span class="string" id="7678125">&#34;testdata/file1.tmpl&#34;</span><span class="op" id="7678146">,</span>&nbsp;<span class="string" id="7678148">&#34;testdata/file2.tmpl&#34;</span><span class="op" id="7678169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7678172">if</span>&nbsp;<span class="ident" id="7678175">err</span>&nbsp;<span class="op" id="7678179">!=</span>&nbsp;<span class="ident" id="7678182">nil</span>&nbsp;<span class="op" id="7678186">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7678190">t</span><span class="op" id="7678191">.</span><span class="ident" id="7678192">Fatalf</span><span class="op" id="7678198">(</span><span class="string" id="7678199">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7678224">,</span>&nbsp;<span class="ident" id="7678226">err</span><span class="op" id="7678229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7678232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7678235">testExecute</span><span class="op" id="7678246">(</span><span class="ident" id="7678247">multiExecTests</span><span class="op" id="7678261">,</span>&nbsp;<span class="ident" id="7678263">template</span><span class="op" id="7678271">,</span>&nbsp;<span class="ident" id="7678273">t</span><span class="op" id="7678274">)</span><br>
<span class="lineno"></span><span class="op" id="7678276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="7678279">func</span>&nbsp;<span class="ident" id="7678284">TestParseGlob</span><span class="op" id="7678297">(</span><span class="ident" id="7678298">t</span>&nbsp;<span class="op" id="7678300">*</span><span class="ident" id="7678301">testing</span><span class="op" id="7678308">.</span><span class="ident" id="7678309">T</span><span class="op" id="7678310">)</span>&nbsp;<span class="op" id="7678312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7678315">_</span><span class="op" id="7678316">,</span>&nbsp;<span class="ident" id="7678318">err</span>&nbsp;<span class="op" id="7678322">:=</span>&nbsp;<span class="ident" id="7678325">ParseGlob</span><span class="op" id="7678334">(</span><span class="string" id="7678335">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="7678351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7678354">if</span>&nbsp;<span class="ident" id="7678357">err</span>&nbsp;<span class="op" id="7678361">==</span>&nbsp;<span class="ident" id="7678364">nil</span>&nbsp;<span class="op" id="7678368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7678372">t</span><span class="op" id="7678373">.</span><span class="ident" id="7678374">Error</span><span class="op" id="7678379">(</span><span class="string" id="7678380">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7678428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7678431">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7678434">_</span><span class="op" id="7678435">,</span>&nbsp;<span class="ident" id="7678437">err</span>&nbsp;<span class="op" id="7678441">=</span>&nbsp;<span class="ident" id="7678443">New</span><span class="op" id="7678446">(</span><span class="string" id="7678447">&#34;error&#34;</span><span class="op" id="7678454">)</span><span class="op" id="7678455">.</span><span class="ident" id="7678456">ParseGlob</span><span class="op" id="7678465">(</span><span class="string" id="7678466">&#34;[x&#34;</span><span class="op" id="7678470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7678473">if</span>&nbsp;<span class="ident" id="7678476">err</span>&nbsp;<span class="op" id="7678480">==</span>&nbsp;<span class="ident" id="7678483">nil</span>&nbsp;<span class="op" id="7678487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7678491">t</span><span class="op" id="7678492">.</span><span class="ident" id="7678493">Error</span><span class="op" id="7678498">(</span><span class="string" id="7678499">&#34;expected&nbsp;error&nbsp;for&nbsp;bad&nbsp;pattern;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7678541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7678544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7678547">template</span>&nbsp;<span class="op" id="7678556">:=</span>&nbsp;<span class="ident" id="7678559">New</span><span class="op" id="7678562">(</span><span class="string" id="7678563">&#34;root&#34;</span><span class="op" id="7678569">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7678572">_</span><span class="op" id="7678573">,</span>&nbsp;<span class="ident" id="7678575">err</span>&nbsp;<span class="op" id="7678579">=</span>&nbsp;<span class="ident" id="7678581">template</span><span class="op" id="7678589">.</span><span class="ident" id="7678590">ParseGlob</span><span class="op" id="7678599">(</span><span class="string" id="7678600">&#34;testdata/file*.tmpl&#34;</span><span class="op" id="7678621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7678624">if</span>&nbsp;<span class="ident" id="7678627">err</span>&nbsp;<span class="op" id="7678631">!=</span>&nbsp;<span class="ident" id="7678634">nil</span>&nbsp;<span class="op" id="7678638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7678642">t</span><span class="op" id="7678643">.</span><span class="ident" id="7678644">Fatalf</span><span class="op" id="7678650">(</span><span class="string" id="7678651">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7678676">,</span>&nbsp;<span class="ident" id="7678678">err</span><span class="op" id="7678681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7678684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7678687">testExecute</span><span class="op" id="7678698">(</span><span class="ident" id="7678699">multiExecTests</span><span class="op" id="7678713">,</span>&nbsp;<span class="ident" id="7678715">template</span><span class="op" id="7678723">,</span>&nbsp;<span class="ident" id="7678725">t</span><span class="op" id="7678726">)</span><br>
<span class="lineno">155</span><span class="op" id="7678728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7678731">//&nbsp;In&nbsp;these&nbsp;tests,&nbsp;actual&nbsp;content&nbsp;(not&nbsp;just&nbsp;template&nbsp;definitions)&nbsp;comes&nbsp;from&nbsp;the&nbsp;parsed&nbsp;files.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7678827">var</span>&nbsp;<span class="ident" id="7678831">templateFileExecTests</span>&nbsp;<span class="op" id="7678853">=</span>&nbsp;<span class="op" id="7678855">[</span><span class="op" id="7678856">]</span><span class="ident" id="7678857">execTest</span><span class="op" id="7678865">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7678868">{</span><span class="string" id="7678869">&#34;test&#34;</span><span class="op" id="7678875">,</span>&nbsp;<span class="string" id="7678877">`{{template&nbsp;&#34;tmpl1.tmpl&#34;}}{{template&nbsp;&#34;tmpl2.tmpl&#34;}}`</span><span class="op" id="7678929">,</span>&nbsp;<span class="string" id="7678931">&#34;template1\n\ny\ntemplate2\n\nx\n&#34;</span><span class="op" id="7678965">,</span>&nbsp;<span class="num" id="7678967">0</span><span class="op" id="7678968">,</span>&nbsp;<span class="builtintype" id="7678970">true</span><span class="op" id="7678974">}</span><span class="op" id="7678975">,</span><br>
<span class="lineno"></span><span class="op" id="7678977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7678980">func</span>&nbsp;<span class="ident" id="7678985">TestParseFilesWithData</span><span class="op" id="7679007">(</span><span class="ident" id="7679008">t</span>&nbsp;<span class="op" id="7679010">*</span><span class="ident" id="7679011">testing</span><span class="op" id="7679018">.</span><span class="ident" id="7679019">T</span><span class="op" id="7679020">)</span>&nbsp;<span class="op" id="7679022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7679025">template</span><span class="op" id="7679033">,</span>&nbsp;<span class="ident" id="7679035">err</span>&nbsp;<span class="op" id="7679039">:=</span>&nbsp;<span class="ident" id="7679042">New</span><span class="op" id="7679045">(</span><span class="string" id="7679046">&#34;root&#34;</span><span class="op" id="7679052">)</span><span class="op" id="7679053">.</span><span class="ident" id="7679054">ParseFiles</span><span class="op" id="7679064">(</span><span class="string" id="7679065">&#34;testdata/tmpl1.tmpl&#34;</span><span class="op" id="7679086">,</span>&nbsp;<span class="string" id="7679088">&#34;testdata/tmpl2.tmpl&#34;</span><span class="op" id="7679109">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7679112">if</span>&nbsp;<span class="ident" id="7679115">err</span>&nbsp;<span class="op" id="7679119">!=</span>&nbsp;<span class="ident" id="7679122">nil</span>&nbsp;<span class="op" id="7679126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7679130">t</span><span class="op" id="7679131">.</span><span class="ident" id="7679132">Fatalf</span><span class="op" id="7679138">(</span><span class="string" id="7679139">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7679164">,</span>&nbsp;<span class="ident" id="7679166">err</span><span class="op" id="7679169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7679172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7679175">testExecute</span><span class="op" id="7679186">(</span><span class="ident" id="7679187">templateFileExecTests</span><span class="op" id="7679208">,</span>&nbsp;<span class="ident" id="7679210">template</span><span class="op" id="7679218">,</span>&nbsp;<span class="ident" id="7679220">t</span><span class="op" id="7679221">)</span><br>
<span class="lineno"></span><span class="op" id="7679223">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="7679226">func</span>&nbsp;<span class="ident" id="7679231">TestParseGlobWithData</span><span class="op" id="7679252">(</span><span class="ident" id="7679253">t</span>&nbsp;<span class="op" id="7679255">*</span><span class="ident" id="7679256">testing</span><span class="op" id="7679263">.</span><span class="ident" id="7679264">T</span><span class="op" id="7679265">)</span>&nbsp;<span class="op" id="7679267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7679270">template</span><span class="op" id="7679278">,</span>&nbsp;<span class="ident" id="7679280">err</span>&nbsp;<span class="op" id="7679284">:=</span>&nbsp;<span class="ident" id="7679287">New</span><span class="op" id="7679290">(</span><span class="string" id="7679291">&#34;root&#34;</span><span class="op" id="7679297">)</span><span class="op" id="7679298">.</span><span class="ident" id="7679299">ParseGlob</span><span class="op" id="7679308">(</span><span class="string" id="7679309">&#34;testdata/tmpl*.tmpl&#34;</span><span class="op" id="7679330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7679333">if</span>&nbsp;<span class="ident" id="7679336">err</span>&nbsp;<span class="op" id="7679340">!=</span>&nbsp;<span class="ident" id="7679343">nil</span>&nbsp;<span class="op" id="7679347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7679351">t</span><span class="op" id="7679352">.</span><span class="ident" id="7679353">Fatalf</span><span class="op" id="7679359">(</span><span class="string" id="7679360">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7679385">,</span>&nbsp;<span class="ident" id="7679387">err</span><span class="op" id="7679390">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7679393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7679396">testExecute</span><span class="op" id="7679407">(</span><span class="ident" id="7679408">templateFileExecTests</span><span class="op" id="7679429">,</span>&nbsp;<span class="ident" id="7679431">template</span><span class="op" id="7679439">,</span>&nbsp;<span class="ident" id="7679441">t</span><span class="op" id="7679442">)</span><br>
<span class="lineno"></span><span class="op" id="7679444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7679447">const</span>&nbsp;<span class="op" id="7679453">(</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7679456">cloneText1</span>&nbsp;<span class="op" id="7679467">=</span>&nbsp;<span class="string" id="7679469">`{{define&nbsp;&#34;a&#34;}}{{template&nbsp;&#34;b&#34;}}{{template&nbsp;&#34;c&#34;}}{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7679526">cloneText2</span>&nbsp;<span class="op" id="7679537">=</span>&nbsp;<span class="string" id="7679539">`{{define&nbsp;&#34;b&#34;}}b{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7679565">cloneText3</span>&nbsp;<span class="op" id="7679576">=</span>&nbsp;<span class="string" id="7679578">`{{define&nbsp;&#34;c&#34;}}root{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7679607">cloneText4</span>&nbsp;<span class="op" id="7679618">=</span>&nbsp;<span class="string" id="7679620">`{{define&nbsp;&#34;c&#34;}}clone{{end}}`</span><br>
<span class="lineno"></span><span class="op" id="7679649">)</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="7679652">func</span>&nbsp;<span class="ident" id="7679657">TestClone</span><span class="op" id="7679666">(</span><span class="ident" id="7679667">t</span>&nbsp;<span class="op" id="7679669">*</span><span class="ident" id="7679670">testing</span><span class="op" id="7679677">.</span><span class="ident" id="7679678">T</span><span class="op" id="7679679">)</span>&nbsp;<span class="op" id="7679681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7679684">//&nbsp;Create&nbsp;some&nbsp;templates&nbsp;and&nbsp;clone&nbsp;the&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7679730">root</span><span class="op" id="7679734">,</span>&nbsp;<span class="ident" id="7679736">err</span>&nbsp;<span class="op" id="7679740">:=</span>&nbsp;<span class="ident" id="7679743">New</span><span class="op" id="7679746">(</span><span class="string" id="7679747">&#34;root&#34;</span><span class="op" id="7679753">)</span><span class="op" id="7679754">.</span><span class="ident" id="7679755">Parse</span><span class="op" id="7679760">(</span><span class="ident" id="7679761">cloneText1</span><span class="op" id="7679771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7679774">if</span>&nbsp;<span class="ident" id="7679777">err</span>&nbsp;<span class="op" id="7679781">!=</span>&nbsp;<span class="ident" id="7679784">nil</span>&nbsp;<span class="op" id="7679788">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7679792">t</span><span class="op" id="7679793">.</span><span class="ident" id="7679794">Fatal</span><span class="op" id="7679799">(</span><span class="ident" id="7679800">err</span><span class="op" id="7679803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7679806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7679809">_</span><span class="op" id="7679810">,</span>&nbsp;<span class="ident" id="7679812">err</span>&nbsp;<span class="op" id="7679816">=</span>&nbsp;<span class="ident" id="7679818">root</span><span class="op" id="7679822">.</span><span class="ident" id="7679823">Parse</span><span class="op" id="7679828">(</span><span class="ident" id="7679829">cloneText2</span><span class="op" id="7679839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7679842">if</span>&nbsp;<span class="ident" id="7679845">err</span>&nbsp;<span class="op" id="7679849">!=</span>&nbsp;<span class="ident" id="7679852">nil</span>&nbsp;<span class="op" id="7679856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7679860">t</span><span class="op" id="7679861">.</span><span class="ident" id="7679862">Fatal</span><span class="op" id="7679867">(</span><span class="ident" id="7679868">err</span><span class="op" id="7679871">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7679874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7679877">clone</span>&nbsp;<span class="op" id="7679883">:=</span>&nbsp;<span class="ident" id="7679886">Must</span><span class="op" id="7679890">(</span><span class="ident" id="7679891">root</span><span class="op" id="7679895">.</span><span class="ident" id="7679896">Clone</span><span class="op" id="7679901">(</span><span class="op" id="7679902">)</span><span class="op" id="7679903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7679906">//&nbsp;Add&nbsp;variants&nbsp;to&nbsp;both.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7679932">_</span><span class="op" id="7679933">,</span>&nbsp;<span class="ident" id="7679935">err</span>&nbsp;<span class="op" id="7679939">=</span>&nbsp;<span class="ident" id="7679941">root</span><span class="op" id="7679945">.</span><span class="ident" id="7679946">Parse</span><span class="op" id="7679951">(</span><span class="ident" id="7679952">cloneText3</span><span class="op" id="7679962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7679965">if</span>&nbsp;<span class="ident" id="7679968">err</span>&nbsp;<span class="op" id="7679972">!=</span>&nbsp;<span class="ident" id="7679975">nil</span>&nbsp;<span class="op" id="7679979">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7679983">t</span><span class="op" id="7679984">.</span><span class="ident" id="7679985">Fatal</span><span class="op" id="7679990">(</span><span class="ident" id="7679991">err</span><span class="op" id="7679994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7679997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7680000">_</span><span class="op" id="7680001">,</span>&nbsp;<span class="ident" id="7680003">err</span>&nbsp;<span class="op" id="7680007">=</span>&nbsp;<span class="ident" id="7680009">clone</span><span class="op" id="7680014">.</span><span class="ident" id="7680015">Parse</span><span class="op" id="7680020">(</span><span class="ident" id="7680021">cloneText4</span><span class="op" id="7680031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7680034">if</span>&nbsp;<span class="ident" id="7680037">err</span>&nbsp;<span class="op" id="7680041">!=</span>&nbsp;<span class="ident" id="7680044">nil</span>&nbsp;<span class="op" id="7680048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7680052">t</span><span class="op" id="7680053">.</span><span class="ident" id="7680054">Fatal</span><span class="op" id="7680059">(</span><span class="ident" id="7680060">err</span><span class="op" id="7680063">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7680066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7680069">//&nbsp;Verify&nbsp;that&nbsp;the&nbsp;clone&nbsp;is&nbsp;self-consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7680115">for</span>&nbsp;<span class="ident" id="7680119">k</span><span class="op" id="7680120">,</span>&nbsp;<span class="ident" id="7680122">v</span>&nbsp;<span class="op" id="7680124">:=</span>&nbsp;<span class="keyword" id="7680127">range</span>&nbsp;<span class="ident" id="7680133">clone</span><span class="op" id="7680138">.</span><span class="ident" id="7680139">tmpl</span>&nbsp;<span class="op" id="7680144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7680148">if</span>&nbsp;<span class="ident" id="7680151">k</span>&nbsp;<span class="op" id="7680153">==</span>&nbsp;<span class="ident" id="7680156">clone</span><span class="op" id="7680161">.</span><span class="ident" id="7680162">name</span>&nbsp;<span class="op" id="7680167">&amp;&amp;</span>&nbsp;<span class="ident" id="7680170">v</span><span class="op" id="7680171">.</span><span class="ident" id="7680172">tmpl</span><span class="op" id="7680176">[</span><span class="ident" id="7680177">k</span><span class="op" id="7680178">]</span>&nbsp;<span class="op" id="7680180">!=</span>&nbsp;<span class="ident" id="7680183">clone</span>&nbsp;<span class="op" id="7680189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7680194">t</span><span class="op" id="7680195">.</span><span class="ident" id="7680196">Error</span><span class="op" id="7680201">(</span><span class="string" id="7680202">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;root&#34;</span><span class="op" id="7680231">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7680235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7680239">if</span>&nbsp;<span class="ident" id="7680242">v</span>&nbsp;<span class="op" id="7680244">!=</span>&nbsp;<span class="ident" id="7680247">v</span><span class="op" id="7680248">.</span><span class="ident" id="7680249">tmpl</span><span class="op" id="7680253">[</span><span class="ident" id="7680254">v</span><span class="op" id="7680255">.</span><span class="ident" id="7680256">name</span><span class="op" id="7680260">]</span>&nbsp;<span class="op" id="7680262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7680267">t</span><span class="op" id="7680268">.</span><span class="ident" id="7680269">Errorf</span><span class="op" id="7680275">(</span><span class="string" id="7680276">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;self&nbsp;for&nbsp;%q&#34;</span><span class="op" id="7680312">,</span>&nbsp;<span class="ident" id="7680314">k</span><span class="op" id="7680315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7680319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7680322">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7680325">//&nbsp;Execute&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7680343">var</span>&nbsp;<span class="ident" id="7680347">b</span>&nbsp;<span class="ident" id="7680349">bytes</span><span class="op" id="7680354">.</span><span class="ident" id="7680355">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7680363">err</span>&nbsp;<span class="op" id="7680367">=</span>&nbsp;<span class="ident" id="7680369">root</span><span class="op" id="7680373">.</span><span class="ident" id="7680374">ExecuteTemplate</span><span class="op" id="7680389">(</span><span class="op" id="7680390">&amp;</span><span class="ident" id="7680391">b</span><span class="op" id="7680392">,</span>&nbsp;<span class="string" id="7680394">&#34;a&#34;</span><span class="op" id="7680397">,</span>&nbsp;<span class="num" id="7680399">0</span><span class="op" id="7680400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7680403">if</span>&nbsp;<span class="ident" id="7680406">err</span>&nbsp;<span class="op" id="7680410">!=</span>&nbsp;<span class="ident" id="7680413">nil</span>&nbsp;<span class="op" id="7680417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7680421">t</span><span class="op" id="7680422">.</span><span class="ident" id="7680423">Fatal</span><span class="op" id="7680428">(</span><span class="ident" id="7680429">err</span><span class="op" id="7680432">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7680435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7680438">if</span>&nbsp;<span class="ident" id="7680441">b</span><span class="op" id="7680442">.</span><span class="ident" id="7680443">String</span><span class="op" id="7680449">(</span><span class="op" id="7680450">)</span>&nbsp;<span class="op" id="7680452">!=</span>&nbsp;<span class="string" id="7680455">&#34;broot&#34;</span>&nbsp;<span class="op" id="7680463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7680467">t</span><span class="op" id="7680468">.</span><span class="ident" id="7680469">Errorf</span><span class="op" id="7680475">(</span><span class="string" id="7680476">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7680496">,</span>&nbsp;<span class="string" id="7680498">&#34;broot&#34;</span><span class="op" id="7680505">,</span>&nbsp;<span class="ident" id="7680507">b</span><span class="op" id="7680508">.</span><span class="ident" id="7680509">String</span><span class="op" id="7680515">(</span><span class="op" id="7680516">)</span><span class="op" id="7680517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7680520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7680523">//&nbsp;Execute&nbsp;copy.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7680541">b</span><span class="op" id="7680542">.</span><span class="ident" id="7680543">Reset</span><span class="op" id="7680548">(</span><span class="op" id="7680549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7680552">err</span>&nbsp;<span class="op" id="7680556">=</span>&nbsp;<span class="ident" id="7680558">clone</span><span class="op" id="7680563">.</span><span class="ident" id="7680564">ExecuteTemplate</span><span class="op" id="7680579">(</span><span class="op" id="7680580">&amp;</span><span class="ident" id="7680581">b</span><span class="op" id="7680582">,</span>&nbsp;<span class="string" id="7680584">&#34;a&#34;</span><span class="op" id="7680587">,</span>&nbsp;<span class="num" id="7680589">0</span><span class="op" id="7680590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7680593">if</span>&nbsp;<span class="ident" id="7680596">err</span>&nbsp;<span class="op" id="7680600">!=</span>&nbsp;<span class="ident" id="7680603">nil</span>&nbsp;<span class="op" id="7680607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7680611">t</span><span class="op" id="7680612">.</span><span class="ident" id="7680613">Fatal</span><span class="op" id="7680618">(</span><span class="ident" id="7680619">err</span><span class="op" id="7680622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7680625">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7680628">if</span>&nbsp;<span class="ident" id="7680631">b</span><span class="op" id="7680632">.</span><span class="ident" id="7680633">String</span><span class="op" id="7680639">(</span><span class="op" id="7680640">)</span>&nbsp;<span class="op" id="7680642">!=</span>&nbsp;<span class="string" id="7680645">&#34;bclone&#34;</span>&nbsp;<span class="op" id="7680654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7680658">t</span><span class="op" id="7680659">.</span><span class="ident" id="7680660">Errorf</span><span class="op" id="7680666">(</span><span class="string" id="7680667">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7680687">,</span>&nbsp;<span class="string" id="7680689">&#34;bclone&#34;</span><span class="op" id="7680697">,</span>&nbsp;<span class="ident" id="7680699">b</span><span class="op" id="7680700">.</span><span class="ident" id="7680701">String</span><span class="op" id="7680707">(</span><span class="op" id="7680708">)</span><span class="op" id="7680709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7680712">}</span><br>
<span class="lineno"></span><span class="op" id="7680714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="7680717">func</span>&nbsp;<span class="ident" id="7680722">TestAddParseTree</span><span class="op" id="7680738">(</span><span class="ident" id="7680739">t</span>&nbsp;<span class="op" id="7680741">*</span><span class="ident" id="7680742">testing</span><span class="op" id="7680749">.</span><span class="ident" id="7680750">T</span><span class="op" id="7680751">)</span>&nbsp;<span class="op" id="7680753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7680756">//&nbsp;Create&nbsp;some&nbsp;templates.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7680783">root</span><span class="op" id="7680787">,</span>&nbsp;<span class="ident" id="7680789">err</span>&nbsp;<span class="op" id="7680793">:=</span>&nbsp;<span class="ident" id="7680796">New</span><span class="op" id="7680799">(</span><span class="string" id="7680800">&#34;root&#34;</span><span class="op" id="7680806">)</span><span class="op" id="7680807">.</span><span class="ident" id="7680808">Parse</span><span class="op" id="7680813">(</span><span class="ident" id="7680814">cloneText1</span><span class="op" id="7680824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7680827">if</span>&nbsp;<span class="ident" id="7680830">err</span>&nbsp;<span class="op" id="7680834">!=</span>&nbsp;<span class="ident" id="7680837">nil</span>&nbsp;<span class="op" id="7680841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7680845">t</span><span class="op" id="7680846">.</span><span class="ident" id="7680847">Fatal</span><span class="op" id="7680852">(</span><span class="ident" id="7680853">err</span><span class="op" id="7680856">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7680859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7680862">_</span><span class="op" id="7680863">,</span>&nbsp;<span class="ident" id="7680865">err</span>&nbsp;<span class="op" id="7680869">=</span>&nbsp;<span class="ident" id="7680871">root</span><span class="op" id="7680875">.</span><span class="ident" id="7680876">Parse</span><span class="op" id="7680881">(</span><span class="ident" id="7680882">cloneText2</span><span class="op" id="7680892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7680895">if</span>&nbsp;<span class="ident" id="7680898">err</span>&nbsp;<span class="op" id="7680902">!=</span>&nbsp;<span class="ident" id="7680905">nil</span>&nbsp;<span class="op" id="7680909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7680913">t</span><span class="op" id="7680914">.</span><span class="ident" id="7680915">Fatal</span><span class="op" id="7680920">(</span><span class="ident" id="7680921">err</span><span class="op" id="7680924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7680927">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7680930">//&nbsp;Add&nbsp;a&nbsp;new&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7680956">tree</span><span class="op" id="7680960">,</span>&nbsp;<span class="ident" id="7680962">err</span>&nbsp;<span class="op" id="7680966">:=</span>&nbsp;<span class="ident" id="7680969">parse</span><span class="op" id="7680974">.</span><span class="ident" id="7680975">Parse</span><span class="op" id="7680980">(</span><span class="string" id="7680981">&#34;cloneText3&#34;</span><span class="op" id="7680993">,</span>&nbsp;<span class="ident" id="7680995">cloneText3</span><span class="op" id="7681005">,</span>&nbsp;<span class="string" id="7681007">&#34;&#34;</span><span class="op" id="7681009">,</span>&nbsp;<span class="string" id="7681011">&#34;&#34;</span><span class="op" id="7681013">,</span>&nbsp;<span class="ident" id="7681015">nil</span><span class="op" id="7681018">,</span>&nbsp;<span class="ident" id="7681020">builtins</span><span class="op" id="7681028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7681031">if</span>&nbsp;<span class="ident" id="7681034">err</span>&nbsp;<span class="op" id="7681038">!=</span>&nbsp;<span class="ident" id="7681041">nil</span>&nbsp;<span class="op" id="7681045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7681049">t</span><span class="op" id="7681050">.</span><span class="ident" id="7681051">Fatal</span><span class="op" id="7681056">(</span><span class="ident" id="7681057">err</span><span class="op" id="7681060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7681063">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7681066">added</span><span class="op" id="7681071">,</span>&nbsp;<span class="ident" id="7681073">err</span>&nbsp;<span class="op" id="7681077">:=</span>&nbsp;<span class="ident" id="7681080">root</span><span class="op" id="7681084">.</span><span class="ident" id="7681085">AddParseTree</span><span class="op" id="7681097">(</span><span class="string" id="7681098">&#34;c&#34;</span><span class="op" id="7681101">,</span>&nbsp;<span class="ident" id="7681103">tree</span><span class="op" id="7681107">[</span><span class="string" id="7681108">&#34;c&#34;</span><span class="op" id="7681111">]</span><span class="op" id="7681112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7681115">//&nbsp;Execute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7681128">var</span>&nbsp;<span class="ident" id="7681132">b</span>&nbsp;<span class="ident" id="7681134">bytes</span><span class="op" id="7681139">.</span><span class="ident" id="7681140">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7681148">err</span>&nbsp;<span class="op" id="7681152">=</span>&nbsp;<span class="ident" id="7681154">added</span><span class="op" id="7681159">.</span><span class="ident" id="7681160">ExecuteTemplate</span><span class="op" id="7681175">(</span><span class="op" id="7681176">&amp;</span><span class="ident" id="7681177">b</span><span class="op" id="7681178">,</span>&nbsp;<span class="string" id="7681180">&#34;a&#34;</span><span class="op" id="7681183">,</span>&nbsp;<span class="num" id="7681185">0</span><span class="op" id="7681186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7681189">if</span>&nbsp;<span class="ident" id="7681192">err</span>&nbsp;<span class="op" id="7681196">!=</span>&nbsp;<span class="ident" id="7681199">nil</span>&nbsp;<span class="op" id="7681203">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7681207">t</span><span class="op" id="7681208">.</span><span class="ident" id="7681209">Fatal</span><span class="op" id="7681214">(</span><span class="ident" id="7681215">err</span><span class="op" id="7681218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7681221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7681224">if</span>&nbsp;<span class="ident" id="7681227">b</span><span class="op" id="7681228">.</span><span class="ident" id="7681229">String</span><span class="op" id="7681235">(</span><span class="op" id="7681236">)</span>&nbsp;<span class="op" id="7681238">!=</span>&nbsp;<span class="string" id="7681241">&#34;broot&#34;</span>&nbsp;<span class="op" id="7681249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7681253">t</span><span class="op" id="7681254">.</span><span class="ident" id="7681255">Errorf</span><span class="op" id="7681261">(</span><span class="string" id="7681262">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7681282">,</span>&nbsp;<span class="string" id="7681284">&#34;broot&#34;</span><span class="op" id="7681291">,</span>&nbsp;<span class="ident" id="7681293">b</span><span class="op" id="7681294">.</span><span class="ident" id="7681295">String</span><span class="op" id="7681301">(</span><span class="op" id="7681302">)</span><span class="op" id="7681303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7681306">}</span><br>
<span class="lineno">260</span><span class="op" id="7681308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7681311">//&nbsp;Issue&nbsp;7032</span><br>
<span class="lineno"></span><span class="keyword" id="7681325">func</span>&nbsp;<span class="ident" id="7681330">TestAddParseTreeToUnparsedTemplate</span><span class="op" id="7681364">(</span><span class="ident" id="7681365">t</span>&nbsp;<span class="op" id="7681367">*</span><span class="ident" id="7681368">testing</span><span class="op" id="7681375">.</span><span class="ident" id="7681376">T</span><span class="op" id="7681377">)</span>&nbsp;<span class="op" id="7681379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7681382">master</span>&nbsp;<span class="op" id="7681389">:=</span>&nbsp;<span class="string" id="7681392">&#34;{{define&nbsp;\&#34;master\&#34;}}{{end}}&#34;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7681424">tmpl</span>&nbsp;<span class="op" id="7681429">:=</span>&nbsp;<span class="ident" id="7681432">New</span><span class="op" id="7681435">(</span><span class="string" id="7681436">&#34;master&#34;</span><span class="op" id="7681444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7681447">tree</span><span class="op" id="7681451">,</span>&nbsp;<span class="ident" id="7681453">err</span>&nbsp;<span class="op" id="7681457">:=</span>&nbsp;<span class="ident" id="7681460">parse</span><span class="op" id="7681465">.</span><span class="ident" id="7681466">Parse</span><span class="op" id="7681471">(</span><span class="string" id="7681472">&#34;master&#34;</span><span class="op" id="7681480">,</span>&nbsp;<span class="ident" id="7681482">master</span><span class="op" id="7681488">,</span>&nbsp;<span class="string" id="7681490">&#34;&#34;</span><span class="op" id="7681492">,</span>&nbsp;<span class="string" id="7681494">&#34;&#34;</span><span class="op" id="7681496">,</span>&nbsp;<span class="ident" id="7681498">nil</span><span class="op" id="7681501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7681504">if</span>&nbsp;<span class="ident" id="7681507">err</span>&nbsp;<span class="op" id="7681511">!=</span>&nbsp;<span class="ident" id="7681514">nil</span>&nbsp;<span class="op" id="7681518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7681522">t</span><span class="op" id="7681523">.</span><span class="ident" id="7681524">Fatalf</span><span class="op" id="7681530">(</span><span class="string" id="7681531">&#34;unexpected&nbsp;parse&nbsp;err:&nbsp;%v&#34;</span><span class="op" id="7681557">,</span>&nbsp;<span class="ident" id="7681559">err</span><span class="op" id="7681562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7681565">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7681568">masterTree</span>&nbsp;<span class="op" id="7681579">:=</span>&nbsp;<span class="ident" id="7681582">tree</span><span class="op" id="7681586">[</span><span class="string" id="7681587">&#34;master&#34;</span><span class="op" id="7681595">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7681598">tmpl</span><span class="op" id="7681602">.</span><span class="ident" id="7681603">AddParseTree</span><span class="op" id="7681615">(</span><span class="string" id="7681616">&#34;master&#34;</span><span class="op" id="7681624">,</span>&nbsp;<span class="ident" id="7681626">masterTree</span><span class="op" id="7681636">)</span>&nbsp;<span class="comment" id="7681638">//&nbsp;used&nbsp;to&nbsp;panic</span><br>
<span class="lineno"></span><span class="op" id="7681655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7681658">func</span>&nbsp;<span class="ident" id="7681663">TestRedefinition</span><span class="op" id="7681679">(</span><span class="ident" id="7681680">t</span>&nbsp;<span class="op" id="7681682">*</span><span class="ident" id="7681683">testing</span><span class="op" id="7681690">.</span><span class="ident" id="7681691">T</span><span class="op" id="7681692">)</span>&nbsp;<span class="op" id="7681694">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7681697">var</span>&nbsp;<span class="ident" id="7681701">tmpl</span>&nbsp;<span class="op" id="7681706">*</span><span class="ident" id="7681707">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7681717">var</span>&nbsp;<span class="ident" id="7681721">err</span>&nbsp;<span class="builtintype" id="7681725">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7681732">if</span>&nbsp;<span class="ident" id="7681735">tmpl</span><span class="op" id="7681739">,</span>&nbsp;<span class="ident" id="7681741">err</span>&nbsp;<span class="op" id="7681745">=</span>&nbsp;<span class="ident" id="7681747">New</span><span class="op" id="7681750">(</span><span class="string" id="7681751">&#34;tmpl1&#34;</span><span class="op" id="7681758">)</span><span class="op" id="7681759">.</span><span class="ident" id="7681760">Parse</span><span class="op" id="7681765">(</span><span class="string" id="7681766">`{{define&nbsp;&#34;test&#34;}}foo{{end}}`</span><span class="op" id="7681795">)</span><span class="op" id="7681796">;</span>&nbsp;<span class="ident" id="7681798">err</span>&nbsp;<span class="op" id="7681802">!=</span>&nbsp;<span class="ident" id="7681805">nil</span>&nbsp;<span class="op" id="7681809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7681813">t</span><span class="op" id="7681814">.</span><span class="ident" id="7681815">Fatalf</span><span class="op" id="7681821">(</span><span class="string" id="7681822">&#34;parse&nbsp;1:&nbsp;%v&#34;</span><span class="op" id="7681835">,</span>&nbsp;<span class="ident" id="7681837">err</span><span class="op" id="7681840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7681843">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7681846">if</span>&nbsp;<span class="ident" id="7681849">_</span><span class="op" id="7681850">,</span>&nbsp;<span class="ident" id="7681852">err</span>&nbsp;<span class="op" id="7681856">=</span>&nbsp;<span class="ident" id="7681858">tmpl</span><span class="op" id="7681862">.</span><span class="ident" id="7681863">Parse</span><span class="op" id="7681868">(</span><span class="string" id="7681869">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="7681898">)</span><span class="op" id="7681899">;</span>&nbsp;<span class="ident" id="7681901">err</span>&nbsp;<span class="op" id="7681905">==</span>&nbsp;<span class="ident" id="7681908">nil</span>&nbsp;<span class="op" id="7681912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7681916">t</span><span class="op" id="7681917">.</span><span class="ident" id="7681918">Fatal</span><span class="op" id="7681923">(</span><span class="string" id="7681924">&#34;expected&nbsp;error&#34;</span><span class="op" id="7681940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7681943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7681946">if</span>&nbsp;<span class="op" id="7681949">!</span><span class="ident" id="7681950">strings</span><span class="op" id="7681957">.</span><span class="ident" id="7681958">Contains</span><span class="op" id="7681966">(</span><span class="ident" id="7681967">err</span><span class="op" id="7681970">.</span><span class="ident" id="7681971">Error</span><span class="op" id="7681976">(</span><span class="op" id="7681977">)</span><span class="op" id="7681978">,</span>&nbsp;<span class="string" id="7681980">&#34;redefinition&#34;</span><span class="op" id="7681994">)</span>&nbsp;<span class="op" id="7681996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7682000">t</span><span class="op" id="7682001">.</span><span class="ident" id="7682002">Fatalf</span><span class="op" id="7682008">(</span><span class="string" id="7682009">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7682046">,</span>&nbsp;<span class="ident" id="7682048">err</span><span class="op" id="7682051">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7682054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7682057">if</span>&nbsp;<span class="ident" id="7682060">_</span><span class="op" id="7682061">,</span>&nbsp;<span class="ident" id="7682063">err</span>&nbsp;<span class="op" id="7682067">=</span>&nbsp;<span class="ident" id="7682069">tmpl</span><span class="op" id="7682073">.</span><span class="ident" id="7682074">New</span><span class="op" id="7682077">(</span><span class="string" id="7682078">&#34;tmpl2&#34;</span><span class="op" id="7682085">)</span><span class="op" id="7682086">.</span><span class="ident" id="7682087">Parse</span><span class="op" id="7682092">(</span><span class="string" id="7682093">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="7682122">)</span><span class="op" id="7682123">;</span>&nbsp;<span class="ident" id="7682125">err</span>&nbsp;<span class="op" id="7682129">==</span>&nbsp;<span class="ident" id="7682132">nil</span>&nbsp;<span class="op" id="7682136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7682140">t</span><span class="op" id="7682141">.</span><span class="ident" id="7682142">Fatal</span><span class="op" id="7682147">(</span><span class="string" id="7682148">&#34;expected&nbsp;error&#34;</span><span class="op" id="7682164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7682167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7682170">if</span>&nbsp;<span class="op" id="7682173">!</span><span class="ident" id="7682174">strings</span><span class="op" id="7682181">.</span><span class="ident" id="7682182">Contains</span><span class="op" id="7682190">(</span><span class="ident" id="7682191">err</span><span class="op" id="7682194">.</span><span class="ident" id="7682195">Error</span><span class="op" id="7682200">(</span><span class="op" id="7682201">)</span><span class="op" id="7682202">,</span>&nbsp;<span class="string" id="7682204">&#34;redefinition&#34;</span><span class="op" id="7682218">)</span>&nbsp;<span class="op" id="7682220">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7682224">t</span><span class="op" id="7682225">.</span><span class="ident" id="7682226">Fatalf</span><span class="op" id="7682232">(</span><span class="string" id="7682233">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7682270">,</span>&nbsp;<span class="ident" id="7682272">err</span><span class="op" id="7682275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7682278">}</span><br>
<span class="lineno"></span><span class="op" id="7682280">}</span>
</div>
</body>
</html>
