<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2207598">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2207653">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2207707">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2207758">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2207836">package</span>&nbsp;<span class="ident" id="2207844">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2207848">import</span>&nbsp;<span class="op" id="2207855">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2207858">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="2207868">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2207871">//&nbsp;The&nbsp;only&nbsp;signal&nbsp;values&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;present&nbsp;on&nbsp;all&nbsp;systems</span><br>
<span class="lineno"></span><span class="comment" id="2207937">//&nbsp;are&nbsp;Interrupt&nbsp;(send&nbsp;the&nbsp;process&nbsp;an&nbsp;interrupt)&nbsp;and&nbsp;Kill&nbsp;(force</span><br>
<span class="lineno">15</span><span class="comment" id="2208002">//&nbsp;the&nbsp;process&nbsp;to&nbsp;exit).</span><br>
<span class="lineno"></span><span class="keyword" id="2208027">var</span>&nbsp;<span class="op" id="2208031">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208034">Interrupt</span>&nbsp;<span class="ident" id="2208044">Signal</span>&nbsp;<span class="op" id="2208051">=</span>&nbsp;<span class="ident" id="2208053">syscall</span><span class="op" id="2208060">.</span><span class="ident" id="2208061">SIGINT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208069">Kill</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2208079">Signal</span>&nbsp;<span class="op" id="2208086">=</span>&nbsp;<span class="ident" id="2208088">syscall</span><span class="op" id="2208095">.</span><span class="ident" id="2208096">SIGKILL</span><br>
<span class="lineno"></span><span class="op" id="2208104">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="2208107">func</span>&nbsp;<span class="ident" id="2208112">startProcess</span><span class="op" id="2208124">(</span><span class="ident" id="2208125">name</span>&nbsp;<span class="builtintype" id="2208130">string</span><span class="op" id="2208136">,</span>&nbsp;<span class="ident" id="2208138">argv</span>&nbsp;<span class="op" id="2208143">[</span><span class="op" id="2208144">]</span><span class="builtintype" id="2208145">string</span><span class="op" id="2208151">,</span>&nbsp;<span class="ident" id="2208153">attr</span>&nbsp;<span class="op" id="2208158">*</span><span class="ident" id="2208159">ProcAttr</span><span class="op" id="2208167">)</span>&nbsp;<span class="op" id="2208169">(</span><span class="ident" id="2208170">p</span>&nbsp;<span class="op" id="2208172">*</span><span class="ident" id="2208173">Process</span><span class="op" id="2208180">,</span>&nbsp;<span class="ident" id="2208182">err</span>&nbsp;<span class="builtintype" id="2208186">error</span><span class="op" id="2208191">)</span>&nbsp;<span class="op" id="2208193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2208196">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;SysProcAttr&nbsp;(ie.&nbsp;no&nbsp;Chroot&nbsp;or&nbsp;changed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2208253">//&nbsp;UID/GID),&nbsp;double-check&nbsp;existence&nbsp;of&nbsp;the&nbsp;directory&nbsp;we&nbsp;want</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2208315">//&nbsp;to&nbsp;chdir&nbsp;into.&nbsp;&nbsp;We&nbsp;can&nbsp;make&nbsp;the&nbsp;error&nbsp;clearer&nbsp;this&nbsp;way.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2208375">if</span>&nbsp;<span class="ident" id="2208378">attr</span>&nbsp;<span class="op" id="2208383">!=</span>&nbsp;<span class="ident" id="2208386">nil</span>&nbsp;<span class="op" id="2208390">&amp;&amp;</span>&nbsp;<span class="ident" id="2208393">attr</span><span class="op" id="2208397">.</span><span class="ident" id="2208398">Sys</span>&nbsp;<span class="op" id="2208402">==</span>&nbsp;<span class="ident" id="2208405">nil</span>&nbsp;<span class="op" id="2208409">&amp;&amp;</span>&nbsp;<span class="ident" id="2208412">attr</span><span class="op" id="2208416">.</span><span class="ident" id="2208417">Dir</span>&nbsp;<span class="op" id="2208421">!=</span>&nbsp;<span class="string" id="2208424">&#34;&#34;</span>&nbsp;<span class="op" id="2208427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2208431">if</span>&nbsp;<span class="ident" id="2208434">_</span><span class="op" id="2208435">,</span>&nbsp;<span class="ident" id="2208437">err</span>&nbsp;<span class="op" id="2208441">:=</span>&nbsp;<span class="ident" id="2208444">Stat</span><span class="op" id="2208448">(</span><span class="ident" id="2208449">attr</span><span class="op" id="2208453">.</span><span class="ident" id="2208454">Dir</span><span class="op" id="2208457">)</span><span class="op" id="2208458">;</span>&nbsp;<span class="ident" id="2208460">err</span>&nbsp;<span class="op" id="2208464">!=</span>&nbsp;<span class="ident" id="2208467">nil</span>&nbsp;<span class="op" id="2208471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208476">pe</span>&nbsp;<span class="op" id="2208479">:=</span>&nbsp;<span class="ident" id="2208482">err</span><span class="op" id="2208485">.</span><span class="op" id="2208486">(</span><span class="op" id="2208487">*</span><span class="ident" id="2208488">PathError</span><span class="op" id="2208497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208502">pe</span><span class="op" id="2208504">.</span><span class="ident" id="2208505">Op</span>&nbsp;<span class="op" id="2208508">=</span>&nbsp;<span class="string" id="2208510">&#34;chdir&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2208521">return</span>&nbsp;<span class="ident" id="2208528">nil</span><span class="op" id="2208531">,</span>&nbsp;<span class="ident" id="2208533">pe</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2208538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2208541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208545">sysattr</span>&nbsp;<span class="op" id="2208553">:=</span>&nbsp;<span class="op" id="2208556">&amp;</span><span class="ident" id="2208557">syscall</span><span class="op" id="2208564">.</span><span class="ident" id="2208565">ProcAttr</span><span class="op" id="2208573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208577">Dir</span><span class="op" id="2208580">:</span>&nbsp;<span class="ident" id="2208582">attr</span><span class="op" id="2208586">.</span><span class="ident" id="2208587">Dir</span><span class="op" id="2208590">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208594">Env</span><span class="op" id="2208597">:</span>&nbsp;<span class="ident" id="2208599">attr</span><span class="op" id="2208603">.</span><span class="ident" id="2208604">Env</span><span class="op" id="2208607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208611">Sys</span><span class="op" id="2208614">:</span>&nbsp;<span class="ident" id="2208616">attr</span><span class="op" id="2208620">.</span><span class="ident" id="2208621">Sys</span><span class="op" id="2208624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2208627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2208630">if</span>&nbsp;<span class="ident" id="2208633">sysattr</span><span class="op" id="2208640">.</span><span class="ident" id="2208641">Env</span>&nbsp;<span class="op" id="2208645">==</span>&nbsp;<span class="ident" id="2208648">nil</span>&nbsp;<span class="op" id="2208652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208656">sysattr</span><span class="op" id="2208663">.</span><span class="ident" id="2208664">Env</span>&nbsp;<span class="op" id="2208668">=</span>&nbsp;<span class="ident" id="2208670">Environ</span><span class="op" id="2208677">(</span><span class="op" id="2208678">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2208681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2208684">for</span>&nbsp;<span class="ident" id="2208688">_</span><span class="op" id="2208689">,</span>&nbsp;<span class="ident" id="2208691">f</span>&nbsp;<span class="op" id="2208693">:=</span>&nbsp;<span class="keyword" id="2208696">range</span>&nbsp;<span class="ident" id="2208702">attr</span><span class="op" id="2208706">.</span><span class="ident" id="2208707">Files</span>&nbsp;<span class="op" id="2208713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208717">sysattr</span><span class="op" id="2208724">.</span><span class="ident" id="2208725">Files</span>&nbsp;<span class="op" id="2208731">=</span>&nbsp;<span class="builtinfunc" id="2208733">append</span><span class="op" id="2208739">(</span><span class="ident" id="2208740">sysattr</span><span class="op" id="2208747">.</span><span class="ident" id="2208748">Files</span><span class="op" id="2208753">,</span>&nbsp;<span class="ident" id="2208755">f</span><span class="op" id="2208756">.</span><span class="ident" id="2208757">Fd</span><span class="op" id="2208759">(</span><span class="op" id="2208760">)</span><span class="op" id="2208761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2208764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208768">pid</span><span class="op" id="2208771">,</span>&nbsp;<span class="ident" id="2208773">h</span><span class="op" id="2208774">,</span>&nbsp;<span class="ident" id="2208776">e</span>&nbsp;<span class="op" id="2208778">:=</span>&nbsp;<span class="ident" id="2208781">syscall</span><span class="op" id="2208788">.</span><span class="ident" id="2208789">StartProcess</span><span class="op" id="2208801">(</span><span class="ident" id="2208802">name</span><span class="op" id="2208806">,</span>&nbsp;<span class="ident" id="2208808">argv</span><span class="op" id="2208812">,</span>&nbsp;<span class="ident" id="2208814">sysattr</span><span class="op" id="2208821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2208824">if</span>&nbsp;<span class="ident" id="2208827">e</span>&nbsp;<span class="op" id="2208829">!=</span>&nbsp;<span class="ident" id="2208832">nil</span>&nbsp;<span class="op" id="2208836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2208840">return</span>&nbsp;<span class="ident" id="2208847">nil</span><span class="op" id="2208850">,</span>&nbsp;<span class="op" id="2208852">&amp;</span><span class="ident" id="2208853">PathError</span><span class="op" id="2208862">{</span><span class="string" id="2208863">&#34;fork/exec&#34;</span><span class="op" id="2208874">,</span>&nbsp;<span class="ident" id="2208876">name</span><span class="op" id="2208880">,</span>&nbsp;<span class="ident" id="2208882">e</span><span class="op" id="2208883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2208886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2208889">return</span>&nbsp;<span class="ident" id="2208896">newProcess</span><span class="op" id="2208906">(</span><span class="ident" id="2208907">pid</span><span class="op" id="2208910">,</span>&nbsp;<span class="ident" id="2208912">h</span><span class="op" id="2208913">)</span><span class="op" id="2208914">,</span>&nbsp;<span class="ident" id="2208916">nil</span><br>
<span class="lineno">50</span><span class="op" id="2208920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2208923">func</span>&nbsp;<span class="op" id="2208928">(</span><span class="ident" id="2208929">p</span>&nbsp;<span class="op" id="2208931">*</span><span class="ident" id="2208932">Process</span><span class="op" id="2208939">)</span>&nbsp;<span class="ident" id="2208941">kill</span><span class="op" id="2208945">(</span><span class="op" id="2208946">)</span>&nbsp;<span class="builtintype" id="2208948">error</span>&nbsp;<span class="op" id="2208954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2208957">return</span>&nbsp;<span class="ident" id="2208964">p</span><span class="op" id="2208965">.</span><span class="ident" id="2208966">Signal</span><span class="op" id="2208972">(</span><span class="ident" id="2208973">Kill</span><span class="op" id="2208977">)</span><br>
<span class="lineno"></span><span class="op" id="2208979">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="2208982">//&nbsp;ProcessState&nbsp;stores&nbsp;information&nbsp;about&nbsp;a&nbsp;process,&nbsp;as&nbsp;reported&nbsp;by&nbsp;Wait.</span><br>
<span class="lineno"></span><span class="keyword" id="2209055">type</span>&nbsp;<span class="ident" id="2209060">ProcessState</span>&nbsp;<span class="keyword" id="2209073">struct</span>&nbsp;<span class="op" id="2209080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209083">pid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2209090">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2209109">//&nbsp;The&nbsp;process&#39;s&nbsp;id.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209131">status</span>&nbsp;<span class="ident" id="2209138">syscall</span><span class="op" id="2209145">.</span><span class="ident" id="2209146">WaitStatus</span>&nbsp;<span class="comment" id="2209157">//&nbsp;System-dependent&nbsp;status&nbsp;info.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209191">rusage</span>&nbsp;<span class="op" id="2209198">*</span><span class="ident" id="2209199">syscall</span><span class="op" id="2209206">.</span><span class="ident" id="2209207">Rusage</span><br>
<span class="lineno"></span><span class="op" id="2209214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2209217">//&nbsp;Pid&nbsp;returns&nbsp;the&nbsp;process&nbsp;id&nbsp;of&nbsp;the&nbsp;exited&nbsp;process.</span><br>
<span class="lineno"></span><span class="keyword" id="2209270">func</span>&nbsp;<span class="op" id="2209275">(</span><span class="ident" id="2209276">p</span>&nbsp;<span class="op" id="2209278">*</span><span class="ident" id="2209279">ProcessState</span><span class="op" id="2209291">)</span>&nbsp;<span class="ident" id="2209293">Pid</span><span class="op" id="2209296">(</span><span class="op" id="2209297">)</span>&nbsp;<span class="builtintype" id="2209299">int</span>&nbsp;<span class="op" id="2209303">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2209306">return</span>&nbsp;<span class="ident" id="2209313">p</span><span class="op" id="2209314">.</span><span class="ident" id="2209315">pid</span><br>
<span class="lineno"></span><span class="op" id="2209319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2209322">func</span>&nbsp;<span class="op" id="2209327">(</span><span class="ident" id="2209328">p</span>&nbsp;<span class="op" id="2209330">*</span><span class="ident" id="2209331">ProcessState</span><span class="op" id="2209343">)</span>&nbsp;<span class="ident" id="2209345">exited</span><span class="op" id="2209351">(</span><span class="op" id="2209352">)</span>&nbsp;<span class="builtintype" id="2209354">bool</span>&nbsp;<span class="op" id="2209359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2209362">return</span>&nbsp;<span class="ident" id="2209369">p</span><span class="op" id="2209370">.</span><span class="ident" id="2209371">status</span><span class="op" id="2209377">.</span><span class="ident" id="2209378">Exited</span><span class="op" id="2209384">(</span><span class="op" id="2209385">)</span><br>
<span class="lineno">70</span><span class="op" id="2209387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2209390">func</span>&nbsp;<span class="op" id="2209395">(</span><span class="ident" id="2209396">p</span>&nbsp;<span class="op" id="2209398">*</span><span class="ident" id="2209399">ProcessState</span><span class="op" id="2209411">)</span>&nbsp;<span class="ident" id="2209413">success</span><span class="op" id="2209420">(</span><span class="op" id="2209421">)</span>&nbsp;<span class="builtintype" id="2209423">bool</span>&nbsp;<span class="op" id="2209428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2209431">return</span>&nbsp;<span class="ident" id="2209438">p</span><span class="op" id="2209439">.</span><span class="ident" id="2209440">status</span><span class="op" id="2209446">.</span><span class="ident" id="2209447">ExitStatus</span><span class="op" id="2209457">(</span><span class="op" id="2209458">)</span>&nbsp;<span class="op" id="2209460">==</span>&nbsp;<span class="num" id="2209463">0</span><br>
<span class="lineno"></span><span class="op" id="2209465">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="2209468">func</span>&nbsp;<span class="op" id="2209473">(</span><span class="ident" id="2209474">p</span>&nbsp;<span class="op" id="2209476">*</span><span class="ident" id="2209477">ProcessState</span><span class="op" id="2209489">)</span>&nbsp;<span class="ident" id="2209491">sys</span><span class="op" id="2209494">(</span><span class="op" id="2209495">)</span>&nbsp;<span class="keyword" id="2209497">interface</span><span class="op" id="2209506">{</span><span class="op" id="2209507">}</span>&nbsp;<span class="op" id="2209509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2209512">return</span>&nbsp;<span class="ident" id="2209519">p</span><span class="op" id="2209520">.</span><span class="ident" id="2209521">status</span><br>
<span class="lineno"></span><span class="op" id="2209528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="2209531">func</span>&nbsp;<span class="op" id="2209536">(</span><span class="ident" id="2209537">p</span>&nbsp;<span class="op" id="2209539">*</span><span class="ident" id="2209540">ProcessState</span><span class="op" id="2209552">)</span>&nbsp;<span class="ident" id="2209554">sysUsage</span><span class="op" id="2209562">(</span><span class="op" id="2209563">)</span>&nbsp;<span class="keyword" id="2209565">interface</span><span class="op" id="2209574">{</span><span class="op" id="2209575">}</span>&nbsp;<span class="op" id="2209577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2209580">return</span>&nbsp;<span class="ident" id="2209587">p</span><span class="op" id="2209588">.</span><span class="ident" id="2209589">rusage</span><br>
<span class="lineno"></span><span class="op" id="2209596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2209599">//&nbsp;Convert&nbsp;i&nbsp;to&nbsp;decimal&nbsp;string.</span><br>
<span class="lineno">85</span><span class="keyword" id="2209631">func</span>&nbsp;<span class="ident" id="2209636">itod</span><span class="op" id="2209640">(</span><span class="ident" id="2209641">i</span>&nbsp;<span class="builtintype" id="2209643">int</span><span class="op" id="2209646">)</span>&nbsp;<span class="builtintype" id="2209648">string</span>&nbsp;<span class="op" id="2209655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2209658">if</span>&nbsp;<span class="ident" id="2209661">i</span>&nbsp;<span class="op" id="2209663">==</span>&nbsp;<span class="num" id="2209666">0</span>&nbsp;<span class="op" id="2209668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2209672">return</span>&nbsp;<span class="string" id="2209679">&#34;0&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2209684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209688">u</span>&nbsp;<span class="op" id="2209690">:=</span>&nbsp;<span class="ident" id="2209693">uint64</span><span class="op" id="2209699">(</span><span class="ident" id="2209700">i</span><span class="op" id="2209701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2209704">if</span>&nbsp;<span class="ident" id="2209707">i</span>&nbsp;<span class="op" id="2209709">&lt;</span>&nbsp;<span class="num" id="2209711">0</span>&nbsp;<span class="op" id="2209713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209717">u</span>&nbsp;<span class="op" id="2209719">=</span>&nbsp;<span class="op" id="2209721">-</span><span class="ident" id="2209722">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2209725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2209729">//&nbsp;Assemble&nbsp;decimal&nbsp;in&nbsp;reverse&nbsp;order.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2209768">var</span>&nbsp;<span class="ident" id="2209772">b</span>&nbsp;<span class="op" id="2209774">[</span><span class="num" id="2209775">32</span><span class="op" id="2209777">]</span><span class="builtintype" id="2209778">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209784">bp</span>&nbsp;<span class="op" id="2209787">:=</span>&nbsp;<span class="builtinfunc" id="2209790">len</span><span class="op" id="2209793">(</span><span class="ident" id="2209794">b</span><span class="op" id="2209795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2209798">for</span>&nbsp;<span class="op" id="2209802">;</span>&nbsp;<span class="ident" id="2209804">u</span>&nbsp;<span class="op" id="2209806">&gt;</span>&nbsp;<span class="num" id="2209808">0</span><span class="op" id="2209809">;</span>&nbsp;<span class="ident" id="2209811">u</span>&nbsp;<span class="op" id="2209813">/=</span>&nbsp;<span class="num" id="2209816">10</span>&nbsp;<span class="op" id="2209819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209823">bp</span><span class="op" id="2209825">--</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209830">b</span><span class="op" id="2209831">[</span><span class="ident" id="2209832">bp</span><span class="op" id="2209834">]</span>&nbsp;<span class="op" id="2209836">=</span>&nbsp;<span class="builtintype" id="2209838">byte</span><span class="op" id="2209842">(</span><span class="ident" id="2209843">u</span><span class="op" id="2209844">%</span><span class="num" id="2209845">10</span><span class="op" id="2209847">)</span>&nbsp;<span class="op" id="2209849">+</span>&nbsp;<span class="string" id="2209851">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2209856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2209860">if</span>&nbsp;<span class="ident" id="2209863">i</span>&nbsp;<span class="op" id="2209865">&lt;</span>&nbsp;<span class="num" id="2209867">0</span>&nbsp;<span class="op" id="2209869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209873">bp</span><span class="op" id="2209875">--</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209880">b</span><span class="op" id="2209881">[</span><span class="ident" id="2209882">bp</span><span class="op" id="2209884">]</span>&nbsp;<span class="op" id="2209886">=</span>&nbsp;<span class="string" id="2209888">&#39;-&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2209893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2209897">return</span>&nbsp;<span class="builtintype" id="2209904">string</span><span class="op" id="2209910">(</span><span class="ident" id="2209911">b</span><span class="op" id="2209912">[</span><span class="ident" id="2209913">bp</span><span class="op" id="2209915">:</span><span class="op" id="2209916">]</span><span class="op" id="2209917">)</span><br>
<span class="lineno"></span><span class="op" id="2209919">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="keyword" id="2209922">func</span>&nbsp;<span class="op" id="2209927">(</span><span class="ident" id="2209928">p</span>&nbsp;<span class="op" id="2209930">*</span><span class="ident" id="2209931">ProcessState</span><span class="op" id="2209943">)</span>&nbsp;<span class="ident" id="2209945">String</span><span class="op" id="2209951">(</span><span class="op" id="2209952">)</span>&nbsp;<span class="builtintype" id="2209954">string</span>&nbsp;<span class="op" id="2209961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2209964">if</span>&nbsp;<span class="ident" id="2209967">p</span>&nbsp;<span class="op" id="2209969">==</span>&nbsp;<span class="ident" id="2209972">nil</span>&nbsp;<span class="op" id="2209976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2209980">return</span>&nbsp;<span class="string" id="2209987">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2209996">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209999">status</span>&nbsp;<span class="op" id="2210006">:=</span>&nbsp;<span class="ident" id="2210009">p</span><span class="op" id="2210010">.</span><span class="ident" id="2210011">Sys</span><span class="op" id="2210014">(</span><span class="op" id="2210015">)</span><span class="op" id="2210016">.</span><span class="op" id="2210017">(</span><span class="ident" id="2210018">syscall</span><span class="op" id="2210025">.</span><span class="ident" id="2210026">WaitStatus</span><span class="op" id="2210036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2210039">res</span>&nbsp;<span class="op" id="2210043">:=</span>&nbsp;<span class="string" id="2210046">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2210050">switch</span>&nbsp;<span class="op" id="2210057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2210060">case</span>&nbsp;<span class="ident" id="2210065">status</span><span class="op" id="2210071">.</span><span class="ident" id="2210072">Exited</span><span class="op" id="2210078">(</span><span class="op" id="2210079">)</span><span class="op" id="2210080">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2210084">res</span>&nbsp;<span class="op" id="2210088">=</span>&nbsp;<span class="string" id="2210090">&#34;exit&nbsp;status&nbsp;&#34;</span>&nbsp;<span class="op" id="2210105">+</span>&nbsp;<span class="ident" id="2210107">itod</span><span class="op" id="2210111">(</span><span class="ident" id="2210112">status</span><span class="op" id="2210118">.</span><span class="ident" id="2210119">ExitStatus</span><span class="op" id="2210129">(</span><span class="op" id="2210130">)</span><span class="op" id="2210131">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2210134">case</span>&nbsp;<span class="ident" id="2210139">status</span><span class="op" id="2210145">.</span><span class="ident" id="2210146">Signaled</span><span class="op" id="2210154">(</span><span class="op" id="2210155">)</span><span class="op" id="2210156">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2210160">res</span>&nbsp;<span class="op" id="2210164">=</span>&nbsp;<span class="string" id="2210166">&#34;signal:&nbsp;&#34;</span>&nbsp;<span class="op" id="2210177">+</span>&nbsp;<span class="ident" id="2210179">status</span><span class="op" id="2210185">.</span><span class="ident" id="2210186">Signal</span><span class="op" id="2210192">(</span><span class="op" id="2210193">)</span><span class="op" id="2210194">.</span><span class="ident" id="2210195">String</span><span class="op" id="2210201">(</span><span class="op" id="2210202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2210205">case</span>&nbsp;<span class="ident" id="2210210">status</span><span class="op" id="2210216">.</span><span class="ident" id="2210217">Stopped</span><span class="op" id="2210224">(</span><span class="op" id="2210225">)</span><span class="op" id="2210226">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2210230">res</span>&nbsp;<span class="op" id="2210234">=</span>&nbsp;<span class="string" id="2210236">&#34;stop&nbsp;signal:&nbsp;&#34;</span>&nbsp;<span class="op" id="2210252">+</span>&nbsp;<span class="ident" id="2210254">status</span><span class="op" id="2210260">.</span><span class="ident" id="2210261">StopSignal</span><span class="op" id="2210271">(</span><span class="op" id="2210272">)</span><span class="op" id="2210273">.</span><span class="ident" id="2210274">String</span><span class="op" id="2210280">(</span><span class="op" id="2210281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2210285">if</span>&nbsp;<span class="ident" id="2210288">status</span><span class="op" id="2210294">.</span><span class="ident" id="2210295">StopSignal</span><span class="op" id="2210305">(</span><span class="op" id="2210306">)</span>&nbsp;<span class="op" id="2210308">==</span>&nbsp;<span class="ident" id="2210311">syscall</span><span class="op" id="2210318">.</span><span class="ident" id="2210319">SIGTRAP</span>&nbsp;<span class="op" id="2210327">&amp;&amp;</span>&nbsp;<span class="ident" id="2210330">status</span><span class="op" id="2210336">.</span><span class="ident" id="2210337">TrapCause</span><span class="op" id="2210346">(</span><span class="op" id="2210347">)</span>&nbsp;<span class="op" id="2210349">!=</span>&nbsp;<span class="num" id="2210352">0</span>&nbsp;<span class="op" id="2210354">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2210359">res</span>&nbsp;<span class="op" id="2210363">+=</span>&nbsp;<span class="string" id="2210366">&#34;&nbsp;(trap&nbsp;&#34;</span>&nbsp;<span class="op" id="2210376">+</span>&nbsp;<span class="ident" id="2210378">itod</span><span class="op" id="2210382">(</span><span class="ident" id="2210383">status</span><span class="op" id="2210389">.</span><span class="ident" id="2210390">TrapCause</span><span class="op" id="2210399">(</span><span class="op" id="2210400">)</span><span class="op" id="2210401">)</span>&nbsp;<span class="op" id="2210403">+</span>&nbsp;<span class="string" id="2210405">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2210411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2210414">case</span>&nbsp;<span class="ident" id="2210419">status</span><span class="op" id="2210425">.</span><span class="ident" id="2210426">Continued</span><span class="op" id="2210435">(</span><span class="op" id="2210436">)</span><span class="op" id="2210437">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2210441">res</span>&nbsp;<span class="op" id="2210445">=</span>&nbsp;<span class="string" id="2210447">&#34;continued&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2210460">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2210463">if</span>&nbsp;<span class="ident" id="2210466">status</span><span class="op" id="2210472">.</span><span class="ident" id="2210473">CoreDump</span><span class="op" id="2210481">(</span><span class="op" id="2210482">)</span>&nbsp;<span class="op" id="2210484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2210488">res</span>&nbsp;<span class="op" id="2210492">+=</span>&nbsp;<span class="string" id="2210495">&#34;&nbsp;(core&nbsp;dumped)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2210513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2210516">return</span>&nbsp;<span class="ident" id="2210523">res</span><br>
<span class="lineno"></span><span class="op" id="2210527">}</span>
</div>
</body>
</html>
