<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/scanner</h2>
<ul>
<li><a href="/gostd/text/scanner/scanner.go.html" class="current">scanner.go</a></li>
<li><a href="/gostd/text/scanner/scanner_test.go.html">scanner_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6361407">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6361462">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6361516">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6361567">//&nbsp;Package&nbsp;scanner&nbsp;provides&nbsp;a&nbsp;scanner&nbsp;and&nbsp;tokenizer&nbsp;for&nbsp;UTF-8-encoded&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="6361643">//&nbsp;It&nbsp;takes&nbsp;an&nbsp;io.Reader&nbsp;providing&nbsp;the&nbsp;source,&nbsp;which&nbsp;then&nbsp;can&nbsp;be&nbsp;tokenized</span><br>
<span class="lineno"></span><span class="comment" id="6361718">//&nbsp;through&nbsp;repeated&nbsp;calls&nbsp;to&nbsp;the&nbsp;Scan&nbsp;function.&nbsp;&nbsp;For&nbsp;compatibility&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="6361790">//&nbsp;existing&nbsp;tools,&nbsp;the&nbsp;NUL&nbsp;character&nbsp;is&nbsp;not&nbsp;allowed.&nbsp;If&nbsp;the&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="6361866">//&nbsp;in&nbsp;the&nbsp;source&nbsp;is&nbsp;a&nbsp;UTF-8&nbsp;encoded&nbsp;byte&nbsp;order&nbsp;mark&nbsp;(BOM),&nbsp;it&nbsp;is&nbsp;discarded.</span><br>
<span class="lineno">10</span><span class="comment" id="6361942">//</span><br>
<span class="lineno"></span><span class="comment" id="6361945">//&nbsp;By&nbsp;default,&nbsp;a&nbsp;Scanner&nbsp;skips&nbsp;white&nbsp;space&nbsp;and&nbsp;Go&nbsp;comments&nbsp;and&nbsp;recognizes&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="6362023">//&nbsp;literals&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;Go&nbsp;language&nbsp;specification.&nbsp;&nbsp;It&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="6362091">//&nbsp;customized&nbsp;to&nbsp;recognize&nbsp;only&nbsp;a&nbsp;subset&nbsp;of&nbsp;those&nbsp;literals&nbsp;and&nbsp;to&nbsp;recognize</span><br>
<span class="lineno"></span><span class="comment" id="6362167">//&nbsp;different&nbsp;identifier&nbsp;and&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno">15</span><span class="comment" id="6362219">//</span><br>
<span class="lineno"></span><span class="comment" id="6362222">//&nbsp;Basic&nbsp;usage&nbsp;pattern:</span><br>
<span class="lineno"></span><span class="comment" id="6362246">//</span><br>
<span class="lineno"></span><span class="comment" id="6362249">//&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;s&nbsp;scanner.Scanner</span><br>
<span class="lineno"></span><span class="comment" id="6362274">//&nbsp;&nbsp;&nbsp;&nbsp;s.Init(src)</span><br>
<span class="lineno">20</span><span class="comment" id="6362289">//&nbsp;&nbsp;&nbsp;&nbsp;tok&nbsp;:=&nbsp;s.Scan()</span><br>
<span class="lineno"></span><span class="comment" id="6362308">//&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;tok&nbsp;!=&nbsp;scanner.EOF&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6362336">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;do&nbsp;something&nbsp;with&nbsp;tok</span><br>
<span class="lineno"></span><span class="comment" id="6362365">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tok&nbsp;=&nbsp;s.Scan()</span><br>
<span class="lineno"></span><span class="comment" id="6362384">//&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno">25</span><span class="comment" id="6362389">//</span><br>
<span class="lineno"></span><span class="keyword" id="6362392">package</span>&nbsp;<span class="ident" id="6362400">scanner</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6362409">import</span>&nbsp;<span class="op" id="6362416">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6362419">&#34;bytes&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6362428">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6362435">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6362441">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6362447">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6362458">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">35</span><span class="op" id="6362473">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6362476">//&nbsp;A&nbsp;source&nbsp;position&nbsp;is&nbsp;represented&nbsp;by&nbsp;a&nbsp;Position&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="6362533">//&nbsp;A&nbsp;position&nbsp;is&nbsp;valid&nbsp;if&nbsp;Line&nbsp;&gt;&nbsp;0.</span><br>
<span class="lineno"></span><span class="keyword" id="6362569">type</span>&nbsp;<span class="ident" id="6362574">Position</span>&nbsp;<span class="keyword" id="6362583">struct</span>&nbsp;<span class="op" id="6362590">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6362593">Filename</span>&nbsp;<span class="builtintype" id="6362602">string</span>&nbsp;<span class="comment" id="6362609">//&nbsp;filename,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6362630">Offset</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6362639">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6362646">//&nbsp;byte&nbsp;offset,&nbsp;starting&nbsp;at&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6362677">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6362686">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6362693">//&nbsp;line&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6362724">Column</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6362733">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6362740">//&nbsp;column&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1&nbsp;(character&nbsp;count&nbsp;per&nbsp;line)</span><br>
<span class="lineno"></span><span class="op" id="6362799">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="6362802">//&nbsp;IsValid&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;position&nbsp;is&nbsp;valid.</span><br>
<span class="lineno"></span><span class="keyword" id="6362852">func</span>&nbsp;<span class="op" id="6362857">(</span><span class="ident" id="6362858">pos</span>&nbsp;<span class="op" id="6362862">*</span><span class="ident" id="6362863">Position</span><span class="op" id="6362871">)</span>&nbsp;<span class="ident" id="6362873">IsValid</span><span class="op" id="6362880">(</span><span class="op" id="6362881">)</span>&nbsp;<span class="builtintype" id="6362883">bool</span>&nbsp;<span class="op" id="6362888">{</span>&nbsp;<span class="keyword" id="6362890">return</span>&nbsp;<span class="ident" id="6362897">pos</span><span class="op" id="6362900">.</span><span class="ident" id="6362901">Line</span>&nbsp;<span class="op" id="6362906">&gt;</span>&nbsp;<span class="num" id="6362908">0</span>&nbsp;<span class="op" id="6362910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6362913">func</span>&nbsp;<span class="op" id="6362918">(</span><span class="ident" id="6362919">pos</span>&nbsp;<span class="ident" id="6362923">Position</span><span class="op" id="6362931">)</span>&nbsp;<span class="ident" id="6362933">String</span><span class="op" id="6362939">(</span><span class="op" id="6362940">)</span>&nbsp;<span class="builtintype" id="6362942">string</span>&nbsp;<span class="op" id="6362949">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6362952">s</span>&nbsp;<span class="op" id="6362954">:=</span>&nbsp;<span class="ident" id="6362957">pos</span><span class="op" id="6362960">.</span><span class="ident" id="6362961">Filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6362971">if</span>&nbsp;<span class="ident" id="6362974">pos</span><span class="op" id="6362977">.</span><span class="ident" id="6362978">IsValid</span><span class="op" id="6362985">(</span><span class="op" id="6362986">)</span>&nbsp;<span class="op" id="6362988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6362992">if</span>&nbsp;<span class="ident" id="6362995">s</span>&nbsp;<span class="op" id="6362997">!=</span>&nbsp;<span class="string" id="6363000">&#34;&#34;</span>&nbsp;<span class="op" id="6363003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6363008">s</span>&nbsp;<span class="op" id="6363010">+=</span>&nbsp;<span class="string" id="6363013">&#34;:&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6363019">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6363023">s</span>&nbsp;<span class="op" id="6363025">+=</span>&nbsp;<span class="ident" id="6363028">fmt</span><span class="op" id="6363031">.</span><span class="ident" id="6363032">Sprintf</span><span class="op" id="6363039">(</span><span class="string" id="6363040">&#34;%d:%d&#34;</span><span class="op" id="6363047">,</span>&nbsp;<span class="ident" id="6363049">pos</span><span class="op" id="6363052">.</span><span class="ident" id="6363053">Line</span><span class="op" id="6363057">,</span>&nbsp;<span class="ident" id="6363059">pos</span><span class="op" id="6363062">.</span><span class="ident" id="6363063">Column</span><span class="op" id="6363069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6363072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6363075">if</span>&nbsp;<span class="ident" id="6363078">s</span>&nbsp;<span class="op" id="6363080">==</span>&nbsp;<span class="string" id="6363083">&#34;&#34;</span>&nbsp;<span class="op" id="6363086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6363090">s</span>&nbsp;<span class="op" id="6363092">=</span>&nbsp;<span class="string" id="6363094">&#34;???&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6363101">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6363104">return</span>&nbsp;<span class="ident" id="6363111">s</span><br>
<span class="lineno"></span><span class="op" id="6363113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6363116">//&nbsp;Predefined&nbsp;mode&nbsp;bits&nbsp;to&nbsp;control&nbsp;recognition&nbsp;of&nbsp;tokens.&nbsp;For&nbsp;instance,</span><br>
<span class="lineno"></span><span class="comment" id="6363188">//&nbsp;to&nbsp;configure&nbsp;a&nbsp;Scanner&nbsp;such&nbsp;that&nbsp;it&nbsp;only&nbsp;recognizes&nbsp;(Go)&nbsp;identifiers,</span><br>
<span class="lineno">65</span><span class="comment" id="6363261">//&nbsp;integers,&nbsp;and&nbsp;skips&nbsp;comments,&nbsp;set&nbsp;the&nbsp;Scanner&#39;s&nbsp;Mode&nbsp;field&nbsp;to:</span><br>
<span class="lineno"></span><span class="comment" id="6363327">//</span><br>
<span class="lineno"></span><span class="comment" id="6363330">//&nbsp;&nbsp;&nbsp;&nbsp;ScanIdents&nbsp;|&nbsp;ScanInts&nbsp;|&nbsp;SkipComments</span><br>
<span class="lineno"></span><span class="comment" id="6363370">//</span><br>
<span class="lineno"></span><span class="comment" id="6363373">//&nbsp;With&nbsp;the&nbsp;exceptions&nbsp;of&nbsp;comments,&nbsp;which&nbsp;are&nbsp;skipped&nbsp;if&nbsp;SkipComments&nbsp;is</span><br>
<span class="lineno">70</span><span class="comment" id="6363446">//&nbsp;set,&nbsp;unrecognized&nbsp;tokens&nbsp;are&nbsp;not&nbsp;ignored.&nbsp;Instead,&nbsp;the&nbsp;scanner&nbsp;simply</span><br>
<span class="lineno"></span><span class="comment" id="6363519">//&nbsp;returns&nbsp;the&nbsp;respective&nbsp;individual&nbsp;characters&nbsp;(or&nbsp;possibly&nbsp;sub-tokens).</span><br>
<span class="lineno"></span><span class="comment" id="6363593">//&nbsp;For&nbsp;instance,&nbsp;if&nbsp;the&nbsp;mode&nbsp;is&nbsp;ScanIdents&nbsp;(not&nbsp;ScanStrings),&nbsp;the&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="6363666">//&nbsp;&#34;foo&#34;&nbsp;is&nbsp;scanned&nbsp;as&nbsp;the&nbsp;token&nbsp;sequence&nbsp;&#39;&#34;&#39;&nbsp;Ident&nbsp;&#39;&#34;&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="6363723">//</span><br>
<span class="lineno">75</span><span class="keyword" id="6363726">const</span>&nbsp;<span class="op" id="6363732">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6363735">ScanIdents</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6363750">=</span>&nbsp;<span class="num" id="6363752">1</span>&nbsp;<span class="op" id="6363754">&lt;&lt;</span>&nbsp;<span class="op" id="6363757">-</span><span class="ident" id="6363758">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6363765">ScanInts</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6363780">=</span>&nbsp;<span class="num" id="6363782">1</span>&nbsp;<span class="op" id="6363784">&lt;&lt;</span>&nbsp;<span class="op" id="6363787">-</span><span class="ident" id="6363788">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6363793">ScanFloats</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6363808">=</span>&nbsp;<span class="num" id="6363810">1</span>&nbsp;<span class="op" id="6363812">&lt;&lt;</span>&nbsp;<span class="op" id="6363815">-</span><span class="ident" id="6363816">Float</span>&nbsp;<span class="comment" id="6363822">//&nbsp;includes&nbsp;Ints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6363840">ScanChars</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6363855">=</span>&nbsp;<span class="num" id="6363857">1</span>&nbsp;<span class="op" id="6363859">&lt;&lt;</span>&nbsp;<span class="op" id="6363862">-</span><span class="ident" id="6363863">Char</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6363869">ScanStrings</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6363884">=</span>&nbsp;<span class="num" id="6363886">1</span>&nbsp;<span class="op" id="6363888">&lt;&lt;</span>&nbsp;<span class="op" id="6363891">-</span><span class="ident" id="6363892">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6363900">ScanRawStrings</span>&nbsp;<span class="op" id="6363915">=</span>&nbsp;<span class="num" id="6363917">1</span>&nbsp;<span class="op" id="6363919">&lt;&lt;</span>&nbsp;<span class="op" id="6363922">-</span><span class="ident" id="6363923">RawString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6363934">ScanComments</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6363949">=</span>&nbsp;<span class="num" id="6363951">1</span>&nbsp;<span class="op" id="6363953">&lt;&lt;</span>&nbsp;<span class="op" id="6363956">-</span><span class="ident" id="6363957">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6363966">SkipComments</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6363981">=</span>&nbsp;<span class="num" id="6363983">1</span>&nbsp;<span class="op" id="6363985">&lt;&lt;</span>&nbsp;<span class="op" id="6363988">-</span><span class="ident" id="6363989">skipComment</span>&nbsp;<span class="comment" id="6364001">//&nbsp;if&nbsp;set&nbsp;with&nbsp;ScanComments,&nbsp;comments&nbsp;become&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6364059">GoTokens</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6364074">=</span>&nbsp;<span class="ident" id="6364076">ScanIdents</span>&nbsp;<span class="op" id="6364087">|</span>&nbsp;<span class="ident" id="6364089">ScanFloats</span>&nbsp;<span class="op" id="6364100">|</span>&nbsp;<span class="ident" id="6364102">ScanChars</span>&nbsp;<span class="op" id="6364112">|</span>&nbsp;<span class="ident" id="6364114">ScanStrings</span>&nbsp;<span class="op" id="6364126">|</span>&nbsp;<span class="ident" id="6364128">ScanRawStrings</span>&nbsp;<span class="op" id="6364143">|</span>&nbsp;<span class="ident" id="6364145">ScanComments</span>&nbsp;<span class="op" id="6364158">|</span>&nbsp;<span class="ident" id="6364160">SkipComments</span><br>
<span class="lineno">85</span><span class="op" id="6364173">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6364176">//&nbsp;The&nbsp;result&nbsp;of&nbsp;Scan&nbsp;is&nbsp;one&nbsp;of&nbsp;the&nbsp;following&nbsp;tokens&nbsp;or&nbsp;a&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="6364253">const</span>&nbsp;<span class="op" id="6364259">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6364262">EOF</span>&nbsp;<span class="op" id="6364266">=</span>&nbsp;<span class="op" id="6364268">-</span><span class="op" id="6364269">(</span><span class="ident" id="6364270">iota</span>&nbsp;<span class="op" id="6364275">+</span>&nbsp;<span class="num" id="6364277">1</span><span class="op" id="6364278">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6364281">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6364288">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6364293">Float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6364300">Char</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6364306">String</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6364314">RawString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6364325">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6364334">skipComment</span><br>
<span class="lineno"></span><span class="op" id="6364346">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="6364349">var</span>&nbsp;<span class="ident" id="6364353">tokenString</span>&nbsp;<span class="op" id="6364365">=</span>&nbsp;<span class="keyword" id="6364367">map</span><span class="op" id="6364370">[</span><span class="builtintype" id="6364371">rune</span><span class="op" id="6364375">]</span><span class="builtintype" id="6364376">string</span><span class="op" id="6364382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6364385">EOF</span><span class="op" id="6364388">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6364396">&#34;EOF&#34;</span><span class="op" id="6364401">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6364404">Ident</span><span class="op" id="6364409">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6364415">&#34;Ident&#34;</span><span class="op" id="6364422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6364425">Int</span><span class="op" id="6364428">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6364436">&#34;Int&#34;</span><span class="op" id="6364441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6364444">Float</span><span class="op" id="6364449">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6364455">&#34;Float&#34;</span><span class="op" id="6364462">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6364465">Char</span><span class="op" id="6364469">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6364476">&#34;Char&#34;</span><span class="op" id="6364482">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6364485">String</span><span class="op" id="6364491">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6364496">&#34;String&#34;</span><span class="op" id="6364504">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6364507">RawString</span><span class="op" id="6364516">:</span>&nbsp;<span class="string" id="6364518">&#34;RawString&#34;</span><span class="op" id="6364529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6364532">Comment</span><span class="op" id="6364539">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6364543">&#34;Comment&#34;</span><span class="op" id="6364552">,</span><br>
<span class="lineno"></span><span class="op" id="6364554">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="6364557">//&nbsp;TokenString&nbsp;returns&nbsp;a&nbsp;printable&nbsp;string&nbsp;for&nbsp;a&nbsp;token&nbsp;or&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="6364633">func</span>&nbsp;<span class="ident" id="6364638">TokenString</span><span class="op" id="6364649">(</span><span class="ident" id="6364650">tok</span>&nbsp;<span class="builtintype" id="6364654">rune</span><span class="op" id="6364658">)</span>&nbsp;<span class="builtintype" id="6364660">string</span>&nbsp;<span class="op" id="6364667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6364670">if</span>&nbsp;<span class="ident" id="6364673">s</span><span class="op" id="6364674">,</span>&nbsp;<span class="ident" id="6364676">found</span>&nbsp;<span class="op" id="6364682">:=</span>&nbsp;<span class="ident" id="6364685">tokenString</span><span class="op" id="6364696">[</span><span class="ident" id="6364697">tok</span><span class="op" id="6364700">]</span><span class="op" id="6364701">;</span>&nbsp;<span class="ident" id="6364703">found</span>&nbsp;<span class="op" id="6364709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6364713">return</span>&nbsp;<span class="ident" id="6364720">s</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6364723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6364726">return</span>&nbsp;<span class="ident" id="6364733">fmt</span><span class="op" id="6364736">.</span><span class="ident" id="6364737">Sprintf</span><span class="op" id="6364744">(</span><span class="string" id="6364745">&#34;%q&#34;</span><span class="op" id="6364749">,</span>&nbsp;<span class="builtintype" id="6364751">string</span><span class="op" id="6364757">(</span><span class="ident" id="6364758">tok</span><span class="op" id="6364761">)</span><span class="op" id="6364762">)</span><br>
<span class="lineno"></span><span class="op" id="6364764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6364767">//&nbsp;GoWhitespace&nbsp;is&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;the&nbsp;Scanner&#39;s&nbsp;Whitespace&nbsp;field.</span><br>
<span class="lineno">120</span><span class="comment" id="6364840">//&nbsp;Its&nbsp;value&nbsp;selects&nbsp;Go&#39;s&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="6364890">const</span>&nbsp;<span class="ident" id="6364896">GoWhitespace</span>&nbsp;<span class="op" id="6364909">=</span>&nbsp;<span class="num" id="6364911">1</span><span class="op" id="6364912">&lt;&lt;</span><span class="string" id="6364914">&#39;\t&#39;</span>&nbsp;<span class="op" id="6364919">|</span>&nbsp;<span class="num" id="6364921">1</span><span class="op" id="6364922">&lt;&lt;</span><span class="string" id="6364924">&#39;\n&#39;</span>&nbsp;<span class="op" id="6364929">|</span>&nbsp;<span class="num" id="6364931">1</span><span class="op" id="6364932">&lt;&lt;</span><span class="string" id="6364934">&#39;\r&#39;</span>&nbsp;<span class="op" id="6364939">|</span>&nbsp;<span class="num" id="6364941">1</span><span class="op" id="6364942">&lt;&lt;</span><span class="string" id="6364944">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6364949">const</span>&nbsp;<span class="ident" id="6364955">bufLen</span>&nbsp;<span class="op" id="6364962">=</span>&nbsp;<span class="num" id="6364964">1024</span>&nbsp;<span class="comment" id="6364969">//&nbsp;at&nbsp;least&nbsp;utf8.UTFMax</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="6364994">//&nbsp;A&nbsp;Scanner&nbsp;implements&nbsp;reading&nbsp;of&nbsp;Unicode&nbsp;characters&nbsp;and&nbsp;tokens&nbsp;from&nbsp;an&nbsp;io.Reader.</span><br>
<span class="lineno"></span><span class="keyword" id="6365078">type</span>&nbsp;<span class="ident" id="6365083">Scanner</span>&nbsp;<span class="keyword" id="6365091">struct</span>&nbsp;<span class="op" id="6365098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6365101">//&nbsp;Input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6365111">src</span>&nbsp;<span class="ident" id="6365115">io</span><span class="op" id="6365117">.</span><span class="ident" id="6365118">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6365127">//&nbsp;Source&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6365145">srcBuf</span>&nbsp;<span class="op" id="6365152">[</span><span class="ident" id="6365153">bufLen</span>&nbsp;<span class="op" id="6365160">+</span>&nbsp;<span class="num" id="6365162">1</span><span class="op" id="6365163">]</span><span class="builtintype" id="6365164">byte</span>&nbsp;<span class="comment" id="6365169">//&nbsp;+1&nbsp;for&nbsp;sentinel&nbsp;for&nbsp;common&nbsp;case&nbsp;of&nbsp;s.next()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6365217">srcPos</span>&nbsp;<span class="builtintype" id="6365224">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6365241">//&nbsp;reading&nbsp;position&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6365277">srcEnd</span>&nbsp;<span class="builtintype" id="6365284">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6365301">//&nbsp;source&nbsp;end&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6365332">//&nbsp;Source&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6365352">srcBufOffset</span>&nbsp;<span class="builtintype" id="6365365">int</span>&nbsp;<span class="comment" id="6365369">//&nbsp;byte&nbsp;offset&nbsp;of&nbsp;srcBuf[0]&nbsp;in&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6365408">line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6365421">int</span>&nbsp;<span class="comment" id="6365425">//&nbsp;line&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6365440">column</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6365453">int</span>&nbsp;<span class="comment" id="6365457">//&nbsp;character&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6365477">lastLineLen</span>&nbsp;&nbsp;<span class="builtintype" id="6365490">int</span>&nbsp;<span class="comment" id="6365494">//&nbsp;length&nbsp;of&nbsp;last&nbsp;line&nbsp;in&nbsp;characters&nbsp;(for&nbsp;correct&nbsp;column&nbsp;reporting)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6365563">lastCharLen</span>&nbsp;&nbsp;<span class="builtintype" id="6365576">int</span>&nbsp;<span class="comment" id="6365580">//&nbsp;length&nbsp;of&nbsp;last&nbsp;character&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6365619">//&nbsp;Token&nbsp;text&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6365641">//&nbsp;Typically,&nbsp;token&nbsp;text&nbsp;is&nbsp;stored&nbsp;completely&nbsp;in&nbsp;srcBuf,&nbsp;but&nbsp;in&nbsp;general</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6365714">//&nbsp;the&nbsp;token&nbsp;text&#39;s&nbsp;head&nbsp;may&nbsp;be&nbsp;buffered&nbsp;in&nbsp;tokBuf&nbsp;while&nbsp;the&nbsp;token&nbsp;text&#39;s</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6365789">//&nbsp;tail&nbsp;is&nbsp;stored&nbsp;in&nbsp;srcBuf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6365819">tokBuf</span>&nbsp;<span class="ident" id="6365826">bytes</span><span class="op" id="6365831">.</span><span class="ident" id="6365832">Buffer</span>&nbsp;<span class="comment" id="6365839">//&nbsp;token&nbsp;text&nbsp;head&nbsp;that&nbsp;is&nbsp;not&nbsp;in&nbsp;srcBuf&nbsp;anymore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6365889">tokPos</span>&nbsp;<span class="builtintype" id="6365896">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6365909">//&nbsp;token&nbsp;text&nbsp;tail&nbsp;position&nbsp;(srcBuf&nbsp;index);&nbsp;valid&nbsp;if&nbsp;&gt;=&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6365968">tokEnd</span>&nbsp;<span class="builtintype" id="6365975">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6365988">//&nbsp;token&nbsp;text&nbsp;tail&nbsp;end&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6366028">//&nbsp;One&nbsp;character&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6366057">ch</span>&nbsp;<span class="builtintype" id="6366060">rune</span>&nbsp;<span class="comment" id="6366065">//&nbsp;character&nbsp;before&nbsp;current&nbsp;srcPos</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6366102">//&nbsp;Error&nbsp;is&nbsp;called&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered.&nbsp;If&nbsp;no&nbsp;Error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6366162">//&nbsp;function&nbsp;is&nbsp;set,&nbsp;the&nbsp;error&nbsp;is&nbsp;reported&nbsp;to&nbsp;os.Stderr.</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6366219">Error</span>&nbsp;<span class="keyword" id="6366225">func</span><span class="op" id="6366229">(</span><span class="ident" id="6366230">s</span>&nbsp;<span class="op" id="6366232">*</span><span class="ident" id="6366233">Scanner</span><span class="op" id="6366240">,</span>&nbsp;<span class="ident" id="6366242">msg</span>&nbsp;<span class="builtintype" id="6366246">string</span><span class="op" id="6366252">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6366256">//&nbsp;ErrorCount&nbsp;is&nbsp;incremented&nbsp;by&nbsp;one&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6366321">ErrorCount</span>&nbsp;<span class="builtintype" id="6366332">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6366338">//&nbsp;The&nbsp;Mode&nbsp;field&nbsp;controls&nbsp;which&nbsp;tokens&nbsp;are&nbsp;recognized.&nbsp;For&nbsp;instance,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6366409">//&nbsp;to&nbsp;recognize&nbsp;Ints,&nbsp;set&nbsp;the&nbsp;ScanInts&nbsp;bit&nbsp;in&nbsp;Mode.&nbsp;The&nbsp;field&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6366479">//&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6366504">Mode</span>&nbsp;<span class="builtintype" id="6366509">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6366516">//&nbsp;The&nbsp;Whitespace&nbsp;field&nbsp;controls&nbsp;which&nbsp;characters&nbsp;are&nbsp;recognized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6366582">//&nbsp;as&nbsp;white&nbsp;space.&nbsp;To&nbsp;recognize&nbsp;a&nbsp;character&nbsp;ch&nbsp;&lt;=&nbsp;&#39;&nbsp;&#39;&nbsp;as&nbsp;white&nbsp;space,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6366653">//&nbsp;set&nbsp;the&nbsp;ch&#39;th&nbsp;bit&nbsp;in&nbsp;Whitespace&nbsp;(the&nbsp;Scanner&#39;s&nbsp;behavior&nbsp;is&nbsp;undefined</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6366726">//&nbsp;for&nbsp;values&nbsp;ch&nbsp;&gt;&nbsp;&#39;&nbsp;&#39;).&nbsp;The&nbsp;field&nbsp;may&nbsp;be&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6366790">Whitespace</span>&nbsp;<span class="ident" id="6366801">uint64</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6366810">//&nbsp;IsIdentRune&nbsp;is&nbsp;a&nbsp;predicate&nbsp;controlling&nbsp;the&nbsp;characters&nbsp;accepted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6366877">//&nbsp;as&nbsp;the&nbsp;ith&nbsp;rune&nbsp;in&nbsp;an&nbsp;identifier.&nbsp;The&nbsp;set&nbsp;of&nbsp;valid&nbsp;characters</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6366943">//&nbsp;must&nbsp;not&nbsp;intersect&nbsp;with&nbsp;the&nbsp;set&nbsp;of&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6367006">//&nbsp;If&nbsp;no&nbsp;IsIdentRune&nbsp;function&nbsp;is&nbsp;set,&nbsp;regular&nbsp;Go&nbsp;identifiers&nbsp;are</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6367072">//&nbsp;accepted&nbsp;instead.&nbsp;The&nbsp;field&nbsp;may&nbsp;be&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6367132">IsIdentRune</span>&nbsp;<span class="keyword" id="6367144">func</span><span class="op" id="6367148">(</span><span class="ident" id="6367149">ch</span>&nbsp;<span class="builtintype" id="6367152">rune</span><span class="op" id="6367156">,</span>&nbsp;<span class="ident" id="6367158">i</span>&nbsp;<span class="builtintype" id="6367160">int</span><span class="op" id="6367163">)</span>&nbsp;<span class="builtintype" id="6367165">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6367172">//&nbsp;Start&nbsp;position&nbsp;of&nbsp;most&nbsp;recently&nbsp;scanned&nbsp;token;&nbsp;set&nbsp;by&nbsp;Scan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6367236">//&nbsp;Calling&nbsp;Init&nbsp;or&nbsp;Next&nbsp;invalidates&nbsp;the&nbsp;position&nbsp;(Line&nbsp;==&nbsp;0).</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6367299">//&nbsp;The&nbsp;Filename&nbsp;field&nbsp;is&nbsp;always&nbsp;left&nbsp;untouched&nbsp;by&nbsp;the&nbsp;Scanner.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6367363">//&nbsp;If&nbsp;an&nbsp;error&nbsp;is&nbsp;reported&nbsp;(via&nbsp;Error)&nbsp;and&nbsp;Position&nbsp;is&nbsp;invalid,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6367428">//&nbsp;the&nbsp;scanner&nbsp;is&nbsp;not&nbsp;inside&nbsp;a&nbsp;token.&nbsp;Call&nbsp;Pos&nbsp;to&nbsp;obtain&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6367495">//&nbsp;position&nbsp;in&nbsp;that&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6367522">Position</span><br>
<span class="lineno">185</span><span class="op" id="6367531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6367534">//&nbsp;Init&nbsp;initializes&nbsp;a&nbsp;Scanner&nbsp;with&nbsp;a&nbsp;new&nbsp;source&nbsp;and&nbsp;returns&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="6367597">//&nbsp;Error&nbsp;is&nbsp;set&nbsp;to&nbsp;nil,&nbsp;ErrorCount&nbsp;is&nbsp;set&nbsp;to&nbsp;0,&nbsp;Mode&nbsp;is&nbsp;set&nbsp;to&nbsp;GoTokens,</span><br>
<span class="lineno"></span><span class="comment" id="6367670">//&nbsp;and&nbsp;Whitespace&nbsp;is&nbsp;set&nbsp;to&nbsp;GoWhitespace.</span><br>
<span class="lineno">190</span><span class="keyword" id="6367712">func</span>&nbsp;<span class="op" id="6367717">(</span><span class="ident" id="6367718">s</span>&nbsp;<span class="op" id="6367720">*</span><span class="ident" id="6367721">Scanner</span><span class="op" id="6367728">)</span>&nbsp;<span class="ident" id="6367730">Init</span><span class="op" id="6367734">(</span><span class="ident" id="6367735">src</span>&nbsp;<span class="ident" id="6367739">io</span><span class="op" id="6367741">.</span><span class="ident" id="6367742">Reader</span><span class="op" id="6367748">)</span>&nbsp;<span class="op" id="6367750">*</span><span class="ident" id="6367751">Scanner</span>&nbsp;<span class="op" id="6367759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6367762">s</span><span class="op" id="6367763">.</span><span class="ident" id="6367764">src</span>&nbsp;<span class="op" id="6367768">=</span>&nbsp;<span class="ident" id="6367770">src</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6367776">//&nbsp;initialize&nbsp;source&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6367805">//&nbsp;(the&nbsp;first&nbsp;call&nbsp;to&nbsp;next()&nbsp;will&nbsp;fill&nbsp;it&nbsp;by&nbsp;calling&nbsp;src.Read)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6367869">s</span><span class="op" id="6367870">.</span><span class="ident" id="6367871">srcBuf</span><span class="op" id="6367877">[</span><span class="num" id="6367878">0</span><span class="op" id="6367879">]</span>&nbsp;<span class="op" id="6367881">=</span>&nbsp;<span class="ident" id="6367883">utf8</span><span class="op" id="6367887">.</span><span class="ident" id="6367888">RuneSelf</span>&nbsp;<span class="comment" id="6367897">//&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6367910">s</span><span class="op" id="6367911">.</span><span class="ident" id="6367912">srcPos</span>&nbsp;<span class="op" id="6367919">=</span>&nbsp;<span class="num" id="6367921">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6367924">s</span><span class="op" id="6367925">.</span><span class="ident" id="6367926">srcEnd</span>&nbsp;<span class="op" id="6367933">=</span>&nbsp;<span class="num" id="6367935">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6367939">//&nbsp;initialize&nbsp;source&nbsp;position</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6367970">s</span><span class="op" id="6367971">.</span><span class="ident" id="6367972">srcBufOffset</span>&nbsp;<span class="op" id="6367985">=</span>&nbsp;<span class="num" id="6367987">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6367990">s</span><span class="op" id="6367991">.</span><span class="ident" id="6367992">line</span>&nbsp;<span class="op" id="6367997">=</span>&nbsp;<span class="num" id="6367999">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6368002">s</span><span class="op" id="6368003">.</span><span class="ident" id="6368004">column</span>&nbsp;<span class="op" id="6368011">=</span>&nbsp;<span class="num" id="6368013">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6368016">s</span><span class="op" id="6368017">.</span><span class="ident" id="6368018">lastLineLen</span>&nbsp;<span class="op" id="6368030">=</span>&nbsp;<span class="num" id="6368032">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6368035">s</span><span class="op" id="6368036">.</span><span class="ident" id="6368037">lastCharLen</span>&nbsp;<span class="op" id="6368049">=</span>&nbsp;<span class="num" id="6368051">0</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6368055">//&nbsp;initialize&nbsp;token&nbsp;text&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6368088">//&nbsp;(required&nbsp;for&nbsp;first&nbsp;call&nbsp;to&nbsp;next()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6368129">s</span><span class="op" id="6368130">.</span><span class="ident" id="6368131">tokPos</span>&nbsp;<span class="op" id="6368138">=</span>&nbsp;<span class="op" id="6368140">-</span><span class="num" id="6368141">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6368145">//&nbsp;initialize&nbsp;one&nbsp;character&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6368185">s</span><span class="op" id="6368186">.</span><span class="ident" id="6368187">ch</span>&nbsp;<span class="op" id="6368190">=</span>&nbsp;<span class="op" id="6368192">-</span><span class="num" id="6368193">1</span>&nbsp;<span class="comment" id="6368195">//&nbsp;no&nbsp;char&nbsp;read&nbsp;yet</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6368217">//&nbsp;initialize&nbsp;public&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6368246">s</span><span class="op" id="6368247">.</span><span class="ident" id="6368248">Error</span>&nbsp;<span class="op" id="6368254">=</span>&nbsp;<span class="ident" id="6368256">nil</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6368261">s</span><span class="op" id="6368262">.</span><span class="ident" id="6368263">ErrorCount</span>&nbsp;<span class="op" id="6368274">=</span>&nbsp;<span class="num" id="6368276">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6368279">s</span><span class="op" id="6368280">.</span><span class="ident" id="6368281">Mode</span>&nbsp;<span class="op" id="6368286">=</span>&nbsp;<span class="ident" id="6368288">GoTokens</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6368298">s</span><span class="op" id="6368299">.</span><span class="ident" id="6368300">Whitespace</span>&nbsp;<span class="op" id="6368311">=</span>&nbsp;<span class="ident" id="6368313">GoWhitespace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6368327">s</span><span class="op" id="6368328">.</span><span class="ident" id="6368329">Line</span>&nbsp;<span class="op" id="6368334">=</span>&nbsp;<span class="num" id="6368336">0</span>&nbsp;<span class="comment" id="6368338">//&nbsp;invalidate&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6368369">return</span>&nbsp;<span class="ident" id="6368376">s</span><br>
<span class="lineno"></span><span class="op" id="6368378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6368381">//&nbsp;next&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character.&nbsp;It&nbsp;is&nbsp;designed&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="6368455">//&nbsp;that&nbsp;only&nbsp;a&nbsp;minimal&nbsp;amount&nbsp;of&nbsp;work&nbsp;needs&nbsp;to&nbsp;be&nbsp;done&nbsp;in&nbsp;the&nbsp;common&nbsp;ASCII</span><br>
<span class="lineno">225</span><span class="comment" id="6368530">//&nbsp;case&nbsp;(one&nbsp;test&nbsp;to&nbsp;check&nbsp;for&nbsp;both&nbsp;ASCII&nbsp;and&nbsp;end-of-buffer,&nbsp;and&nbsp;one&nbsp;test</span><br>
<span class="lineno"></span><span class="comment" id="6368604">//&nbsp;to&nbsp;check&nbsp;for&nbsp;newlines).</span><br>
<span class="lineno"></span><span class="keyword" id="6368631">func</span>&nbsp;<span class="op" id="6368636">(</span><span class="ident" id="6368637">s</span>&nbsp;<span class="op" id="6368639">*</span><span class="ident" id="6368640">Scanner</span><span class="op" id="6368647">)</span>&nbsp;<span class="ident" id="6368649">next</span><span class="op" id="6368653">(</span><span class="op" id="6368654">)</span>&nbsp;<span class="builtintype" id="6368656">rune</span>&nbsp;<span class="op" id="6368661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6368664">ch</span><span class="op" id="6368666">,</span>&nbsp;<span class="ident" id="6368668">width</span>&nbsp;<span class="op" id="6368674">:=</span>&nbsp;<span class="builtintype" id="6368677">rune</span><span class="op" id="6368681">(</span><span class="ident" id="6368682">s</span><span class="op" id="6368683">.</span><span class="ident" id="6368684">srcBuf</span><span class="op" id="6368690">[</span><span class="ident" id="6368691">s</span><span class="op" id="6368692">.</span><span class="ident" id="6368693">srcPos</span><span class="op" id="6368699">]</span><span class="op" id="6368700">)</span><span class="op" id="6368701">,</span>&nbsp;<span class="num" id="6368703">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6368707">if</span>&nbsp;<span class="ident" id="6368710">ch</span>&nbsp;<span class="op" id="6368713">&gt;=</span>&nbsp;<span class="ident" id="6368716">utf8</span><span class="op" id="6368720">.</span><span class="ident" id="6368721">RuneSelf</span>&nbsp;<span class="op" id="6368730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6368734">//&nbsp;uncommon&nbsp;case:&nbsp;not&nbsp;ASCII&nbsp;or&nbsp;not&nbsp;enough&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6368784">for</span>&nbsp;<span class="ident" id="6368788">s</span><span class="op" id="6368789">.</span><span class="ident" id="6368790">srcPos</span><span class="op" id="6368796">+</span><span class="ident" id="6368797">utf8</span><span class="op" id="6368801">.</span><span class="ident" id="6368802">UTFMax</span>&nbsp;<span class="op" id="6368809">&gt;</span>&nbsp;<span class="ident" id="6368811">s</span><span class="op" id="6368812">.</span><span class="ident" id="6368813">srcEnd</span>&nbsp;<span class="op" id="6368820">&amp;&amp;</span>&nbsp;<span class="op" id="6368823">!</span><span class="ident" id="6368824">utf8</span><span class="op" id="6368828">.</span><span class="ident" id="6368829">FullRune</span><span class="op" id="6368837">(</span><span class="ident" id="6368838">s</span><span class="op" id="6368839">.</span><span class="ident" id="6368840">srcBuf</span><span class="op" id="6368846">[</span><span class="ident" id="6368847">s</span><span class="op" id="6368848">.</span><span class="ident" id="6368849">srcPos</span><span class="op" id="6368855">:</span><span class="ident" id="6368856">s</span><span class="op" id="6368857">.</span><span class="ident" id="6368858">srcEnd</span><span class="op" id="6368864">]</span><span class="op" id="6368865">)</span>&nbsp;<span class="op" id="6368867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6368872">//&nbsp;not&nbsp;enough&nbsp;bytes:&nbsp;read&nbsp;some&nbsp;more,&nbsp;but&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6368922">//&nbsp;save&nbsp;away&nbsp;token&nbsp;text&nbsp;if&nbsp;any</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6368956">if</span>&nbsp;<span class="ident" id="6368959">s</span><span class="op" id="6368960">.</span><span class="ident" id="6368961">tokPos</span>&nbsp;<span class="op" id="6368968">&gt;=</span>&nbsp;<span class="num" id="6368971">0</span>&nbsp;<span class="op" id="6368973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6368979">s</span><span class="op" id="6368980">.</span><span class="ident" id="6368981">tokBuf</span><span class="op" id="6368987">.</span><span class="ident" id="6368988">Write</span><span class="op" id="6368993">(</span><span class="ident" id="6368994">s</span><span class="op" id="6368995">.</span><span class="ident" id="6368996">srcBuf</span><span class="op" id="6369002">[</span><span class="ident" id="6369003">s</span><span class="op" id="6369004">.</span><span class="ident" id="6369005">tokPos</span><span class="op" id="6369011">:</span><span class="ident" id="6369012">s</span><span class="op" id="6369013">.</span><span class="ident" id="6369014">srcPos</span><span class="op" id="6369020">]</span><span class="op" id="6369021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6369027">s</span><span class="op" id="6369028">.</span><span class="ident" id="6369029">tokPos</span>&nbsp;<span class="op" id="6369036">=</span>&nbsp;<span class="num" id="6369038">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6369044">//&nbsp;s.tokEnd&nbsp;is&nbsp;set&nbsp;by&nbsp;Scan()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6369076">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6369081">//&nbsp;move&nbsp;unread&nbsp;bytes&nbsp;to&nbsp;beginning&nbsp;of&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6369128">copy</span><span class="op" id="6369132">(</span><span class="ident" id="6369133">s</span><span class="op" id="6369134">.</span><span class="ident" id="6369135">srcBuf</span><span class="op" id="6369141">[</span><span class="num" id="6369142">0</span><span class="op" id="6369143">:</span><span class="op" id="6369144">]</span><span class="op" id="6369145">,</span>&nbsp;<span class="ident" id="6369147">s</span><span class="op" id="6369148">.</span><span class="ident" id="6369149">srcBuf</span><span class="op" id="6369155">[</span><span class="ident" id="6369156">s</span><span class="op" id="6369157">.</span><span class="ident" id="6369158">srcPos</span><span class="op" id="6369164">:</span><span class="ident" id="6369165">s</span><span class="op" id="6369166">.</span><span class="ident" id="6369167">srcEnd</span><span class="op" id="6369173">]</span><span class="op" id="6369174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6369179">s</span><span class="op" id="6369180">.</span><span class="ident" id="6369181">srcBufOffset</span>&nbsp;<span class="op" id="6369194">+=</span>&nbsp;<span class="ident" id="6369197">s</span><span class="op" id="6369198">.</span><span class="ident" id="6369199">srcPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6369209">//&nbsp;read&nbsp;more&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6369231">//&nbsp;(an&nbsp;io.Reader&nbsp;must&nbsp;return&nbsp;io.EOF&nbsp;when&nbsp;it&nbsp;reaches</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6369286">//&nbsp;the&nbsp;end&nbsp;of&nbsp;what&nbsp;it&nbsp;is&nbsp;reading&nbsp;-&nbsp;simply&nbsp;returning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6369341">//&nbsp;n&nbsp;==&nbsp;0&nbsp;will&nbsp;make&nbsp;this&nbsp;loop&nbsp;retry&nbsp;forever;&nbsp;but&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6369397">//&nbsp;error&nbsp;is&nbsp;in&nbsp;the&nbsp;reader&nbsp;implementation&nbsp;in&nbsp;that&nbsp;case)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6369455">i</span>&nbsp;<span class="op" id="6369457">:=</span>&nbsp;<span class="ident" id="6369460">s</span><span class="op" id="6369461">.</span><span class="ident" id="6369462">srcEnd</span>&nbsp;<span class="op" id="6369469">-</span>&nbsp;<span class="ident" id="6369471">s</span><span class="op" id="6369472">.</span><span class="ident" id="6369473">srcPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6369483">n</span><span class="op" id="6369484">,</span>&nbsp;<span class="ident" id="6369486">err</span>&nbsp;<span class="op" id="6369490">:=</span>&nbsp;<span class="ident" id="6369493">s</span><span class="op" id="6369494">.</span><span class="ident" id="6369495">src</span><span class="op" id="6369498">.</span><span class="ident" id="6369499">Read</span><span class="op" id="6369503">(</span><span class="ident" id="6369504">s</span><span class="op" id="6369505">.</span><span class="ident" id="6369506">srcBuf</span><span class="op" id="6369512">[</span><span class="ident" id="6369513">i</span><span class="op" id="6369514">:</span><span class="ident" id="6369515">bufLen</span><span class="op" id="6369521">]</span><span class="op" id="6369522">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6369527">s</span><span class="op" id="6369528">.</span><span class="ident" id="6369529">srcPos</span>&nbsp;<span class="op" id="6369536">=</span>&nbsp;<span class="num" id="6369538">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6369543">s</span><span class="op" id="6369544">.</span><span class="ident" id="6369545">srcEnd</span>&nbsp;<span class="op" id="6369552">=</span>&nbsp;<span class="ident" id="6369554">i</span>&nbsp;<span class="op" id="6369556">+</span>&nbsp;<span class="ident" id="6369558">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6369563">s</span><span class="op" id="6369564">.</span><span class="ident" id="6369565">srcBuf</span><span class="op" id="6369571">[</span><span class="ident" id="6369572">s</span><span class="op" id="6369573">.</span><span class="ident" id="6369574">srcEnd</span><span class="op" id="6369580">]</span>&nbsp;<span class="op" id="6369582">=</span>&nbsp;<span class="ident" id="6369584">utf8</span><span class="op" id="6369588">.</span><span class="ident" id="6369589">RuneSelf</span>&nbsp;<span class="comment" id="6369598">//&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6369613">if</span>&nbsp;<span class="ident" id="6369616">err</span>&nbsp;<span class="op" id="6369620">!=</span>&nbsp;<span class="ident" id="6369623">nil</span>&nbsp;<span class="op" id="6369627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6369633">if</span>&nbsp;<span class="ident" id="6369636">err</span>&nbsp;<span class="op" id="6369640">!=</span>&nbsp;<span class="ident" id="6369643">io</span><span class="op" id="6369645">.</span><span class="ident" id="6369646">EOF</span>&nbsp;<span class="op" id="6369650">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6369657">s</span><span class="op" id="6369658">.</span><span class="builtintype" id="6369659">error</span><span class="op" id="6369664">(</span><span class="ident" id="6369665">err</span><span class="op" id="6369668">.</span><span class="ident" id="6369669">Error</span><span class="op" id="6369674">(</span><span class="op" id="6369675">)</span><span class="op" id="6369676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6369682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6369688">if</span>&nbsp;<span class="ident" id="6369691">s</span><span class="op" id="6369692">.</span><span class="ident" id="6369693">srcEnd</span>&nbsp;<span class="op" id="6369700">==</span>&nbsp;<span class="num" id="6369703">0</span>&nbsp;<span class="op" id="6369705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6369712">if</span>&nbsp;<span class="ident" id="6369715">s</span><span class="op" id="6369716">.</span><span class="ident" id="6369717">lastCharLen</span>&nbsp;<span class="op" id="6369729">&gt;</span>&nbsp;<span class="num" id="6369731">0</span>&nbsp;<span class="op" id="6369733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6369741">//&nbsp;previous&nbsp;character&nbsp;was&nbsp;not&nbsp;EOF</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6369781">s</span><span class="op" id="6369782">.</span><span class="ident" id="6369783">column</span><span class="op" id="6369789">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6369797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6369804">s</span><span class="op" id="6369805">.</span><span class="ident" id="6369806">lastCharLen</span>&nbsp;<span class="op" id="6369818">=</span>&nbsp;<span class="num" id="6369820">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6369827">return</span>&nbsp;<span class="ident" id="6369834">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6369842">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6369848">//&nbsp;If&nbsp;err&nbsp;==&nbsp;EOF,&nbsp;we&nbsp;won&#39;t&nbsp;be&nbsp;getting&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6369895">//&nbsp;bytes;&nbsp;break&nbsp;to&nbsp;avoid&nbsp;infinite&nbsp;loop.&nbsp;If</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6369942">//&nbsp;err&nbsp;is&nbsp;something&nbsp;else,&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6369989">//&nbsp;we&nbsp;can&nbsp;get&nbsp;more&nbsp;bytes;&nbsp;thus&nbsp;also&nbsp;break.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6370036">break</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6370045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6370049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6370053">//&nbsp;at&nbsp;least&nbsp;one&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6370076">ch</span>&nbsp;<span class="op" id="6370079">=</span>&nbsp;<span class="builtintype" id="6370081">rune</span><span class="op" id="6370085">(</span><span class="ident" id="6370086">s</span><span class="op" id="6370087">.</span><span class="ident" id="6370088">srcBuf</span><span class="op" id="6370094">[</span><span class="ident" id="6370095">s</span><span class="op" id="6370096">.</span><span class="ident" id="6370097">srcPos</span><span class="op" id="6370103">]</span><span class="op" id="6370104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6370108">if</span>&nbsp;<span class="ident" id="6370111">ch</span>&nbsp;<span class="op" id="6370114">&gt;=</span>&nbsp;<span class="ident" id="6370117">utf8</span><span class="op" id="6370121">.</span><span class="ident" id="6370122">RuneSelf</span>&nbsp;<span class="op" id="6370131">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6370136">//&nbsp;uncommon&nbsp;case:&nbsp;not&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6370167">ch</span><span class="op" id="6370169">,</span>&nbsp;<span class="ident" id="6370171">width</span>&nbsp;<span class="op" id="6370177">=</span>&nbsp;<span class="ident" id="6370179">utf8</span><span class="op" id="6370183">.</span><span class="ident" id="6370184">DecodeRune</span><span class="op" id="6370194">(</span><span class="ident" id="6370195">s</span><span class="op" id="6370196">.</span><span class="ident" id="6370197">srcBuf</span><span class="op" id="6370203">[</span><span class="ident" id="6370204">s</span><span class="op" id="6370205">.</span><span class="ident" id="6370206">srcPos</span><span class="op" id="6370212">:</span><span class="ident" id="6370213">s</span><span class="op" id="6370214">.</span><span class="ident" id="6370215">srcEnd</span><span class="op" id="6370221">]</span><span class="op" id="6370222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6370227">if</span>&nbsp;<span class="ident" id="6370230">ch</span>&nbsp;<span class="op" id="6370233">==</span>&nbsp;<span class="ident" id="6370236">utf8</span><span class="op" id="6370240">.</span><span class="ident" id="6370241">RuneError</span>&nbsp;<span class="op" id="6370251">&amp;&amp;</span>&nbsp;<span class="ident" id="6370254">width</span>&nbsp;<span class="op" id="6370260">==</span>&nbsp;<span class="num" id="6370263">1</span>&nbsp;<span class="op" id="6370265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6370271">//&nbsp;advance&nbsp;for&nbsp;correct&nbsp;error&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6370313">s</span><span class="op" id="6370314">.</span><span class="ident" id="6370315">srcPos</span>&nbsp;<span class="op" id="6370322">+=</span>&nbsp;<span class="ident" id="6370325">width</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6370335">s</span><span class="op" id="6370336">.</span><span class="ident" id="6370337">lastCharLen</span>&nbsp;<span class="op" id="6370349">=</span>&nbsp;<span class="ident" id="6370351">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6370361">s</span><span class="op" id="6370362">.</span><span class="ident" id="6370363">column</span><span class="op" id="6370369">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6370376">s</span><span class="op" id="6370377">.</span><span class="builtintype" id="6370378">error</span><span class="op" id="6370383">(</span><span class="string" id="6370384">&#34;illegal&nbsp;UTF-8&nbsp;encoding&#34;</span><span class="op" id="6370408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6370414">return</span>&nbsp;<span class="ident" id="6370421">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6370427">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6370431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6370434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6370438">//&nbsp;advance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6370450">s</span><span class="op" id="6370451">.</span><span class="ident" id="6370452">srcPos</span>&nbsp;<span class="op" id="6370459">+=</span>&nbsp;<span class="ident" id="6370462">width</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6370469">s</span><span class="op" id="6370470">.</span><span class="ident" id="6370471">lastCharLen</span>&nbsp;<span class="op" id="6370483">=</span>&nbsp;<span class="ident" id="6370485">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6370492">s</span><span class="op" id="6370493">.</span><span class="ident" id="6370494">column</span><span class="op" id="6370500">++</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6370505">//&nbsp;special&nbsp;situations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6370528">switch</span>&nbsp;<span class="ident" id="6370535">ch</span>&nbsp;<span class="op" id="6370538">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6370541">case</span>&nbsp;<span class="num" id="6370546">0</span><span class="op" id="6370547">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6370551">//&nbsp;for&nbsp;compatibility&nbsp;with&nbsp;other&nbsp;tools</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6370591">s</span><span class="op" id="6370592">.</span><span class="builtintype" id="6370593">error</span><span class="op" id="6370598">(</span><span class="string" id="6370599">&#34;illegal&nbsp;character&nbsp;NUL&#34;</span><span class="op" id="6370622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6370625">case</span>&nbsp;<span class="string" id="6370630">&#39;\n&#39;</span><span class="op" id="6370634">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6370638">s</span><span class="op" id="6370639">.</span><span class="ident" id="6370640">line</span><span class="op" id="6370644">++</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6370649">s</span><span class="op" id="6370650">.</span><span class="ident" id="6370651">lastLineLen</span>&nbsp;<span class="op" id="6370663">=</span>&nbsp;<span class="ident" id="6370665">s</span><span class="op" id="6370666">.</span><span class="ident" id="6370667">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6370676">s</span><span class="op" id="6370677">.</span><span class="ident" id="6370678">column</span>&nbsp;<span class="op" id="6370685">=</span>&nbsp;<span class="num" id="6370687">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6370690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6370694">return</span>&nbsp;<span class="ident" id="6370701">ch</span><br>
<span class="lineno">305</span><span class="op" id="6370704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6370707">//&nbsp;Next&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="6370761">//&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source.&nbsp;It&nbsp;reports</span><br>
<span class="lineno"></span><span class="comment" id="6370816">//&nbsp;a&nbsp;read&nbsp;error&nbsp;by&nbsp;calling&nbsp;s.Error,&nbsp;if&nbsp;not&nbsp;nil;&nbsp;otherwise</span><br>
<span class="lineno">310</span><span class="comment" id="6370874">//&nbsp;it&nbsp;prints&nbsp;an&nbsp;error&nbsp;message&nbsp;to&nbsp;os.Stderr.&nbsp;Next&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="6370932">//&nbsp;update&nbsp;the&nbsp;Scanner&#39;s&nbsp;Position&nbsp;field;&nbsp;use&nbsp;Pos()&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="6370985">//&nbsp;get&nbsp;the&nbsp;current&nbsp;position.</span><br>
<span class="lineno"></span><span class="keyword" id="6371014">func</span>&nbsp;<span class="op" id="6371019">(</span><span class="ident" id="6371020">s</span>&nbsp;<span class="op" id="6371022">*</span><span class="ident" id="6371023">Scanner</span><span class="op" id="6371030">)</span>&nbsp;<span class="ident" id="6371032">Next</span><span class="op" id="6371036">(</span><span class="op" id="6371037">)</span>&nbsp;<span class="builtintype" id="6371039">rune</span>&nbsp;<span class="op" id="6371044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6371047">s</span><span class="op" id="6371048">.</span><span class="ident" id="6371049">tokPos</span>&nbsp;<span class="op" id="6371056">=</span>&nbsp;<span class="op" id="6371058">-</span><span class="num" id="6371059">1</span>&nbsp;<span class="comment" id="6371061">//&nbsp;don&#39;t&nbsp;collect&nbsp;token&nbsp;text</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6371090">s</span><span class="op" id="6371091">.</span><span class="ident" id="6371092">Line</span>&nbsp;<span class="op" id="6371097">=</span>&nbsp;<span class="num" id="6371099">0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6371104">//&nbsp;invalidate&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6371134">ch</span>&nbsp;<span class="op" id="6371137">:=</span>&nbsp;<span class="ident" id="6371140">s</span><span class="op" id="6371141">.</span><span class="ident" id="6371142">Peek</span><span class="op" id="6371146">(</span><span class="op" id="6371147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6371150">s</span><span class="op" id="6371151">.</span><span class="ident" id="6371152">ch</span>&nbsp;<span class="op" id="6371155">=</span>&nbsp;<span class="ident" id="6371157">s</span><span class="op" id="6371158">.</span><span class="ident" id="6371159">next</span><span class="op" id="6371163">(</span><span class="op" id="6371164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6371167">return</span>&nbsp;<span class="ident" id="6371174">ch</span><br>
<span class="lineno"></span><span class="op" id="6371177">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="6371180">//&nbsp;Peek&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character&nbsp;in&nbsp;the&nbsp;source&nbsp;without&nbsp;advancing</span><br>
<span class="lineno"></span><span class="comment" id="6371255">//&nbsp;the&nbsp;scanner.&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;if&nbsp;the&nbsp;scanner&#39;s&nbsp;position&nbsp;is&nbsp;at&nbsp;the&nbsp;last</span><br>
<span class="lineno"></span><span class="comment" id="6371327">//&nbsp;character&nbsp;of&nbsp;the&nbsp;source.</span><br>
<span class="lineno"></span><span class="keyword" id="6371355">func</span>&nbsp;<span class="op" id="6371360">(</span><span class="ident" id="6371361">s</span>&nbsp;<span class="op" id="6371363">*</span><span class="ident" id="6371364">Scanner</span><span class="op" id="6371371">)</span>&nbsp;<span class="ident" id="6371373">Peek</span><span class="op" id="6371377">(</span><span class="op" id="6371378">)</span>&nbsp;<span class="builtintype" id="6371380">rune</span>&nbsp;<span class="op" id="6371385">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6371388">if</span>&nbsp;<span class="ident" id="6371391">s</span><span class="op" id="6371392">.</span><span class="ident" id="6371393">ch</span>&nbsp;<span class="op" id="6371396">&lt;</span>&nbsp;<span class="num" id="6371398">0</span>&nbsp;<span class="op" id="6371400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6371404">//&nbsp;this&nbsp;code&nbsp;is&nbsp;only&nbsp;run&nbsp;for&nbsp;the&nbsp;very&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6371460">s</span><span class="op" id="6371461">.</span><span class="ident" id="6371462">ch</span>&nbsp;<span class="op" id="6371465">=</span>&nbsp;<span class="ident" id="6371467">s</span><span class="op" id="6371468">.</span><span class="ident" id="6371469">next</span><span class="op" id="6371473">(</span><span class="op" id="6371474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6371478">if</span>&nbsp;<span class="ident" id="6371481">s</span><span class="op" id="6371482">.</span><span class="ident" id="6371483">ch</span>&nbsp;<span class="op" id="6371486">==</span>&nbsp;<span class="string" id="6371489">&#39;\uFEFF&#39;</span>&nbsp;<span class="op" id="6371498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6371503">s</span><span class="op" id="6371504">.</span><span class="ident" id="6371505">ch</span>&nbsp;<span class="op" id="6371508">=</span>&nbsp;<span class="ident" id="6371510">s</span><span class="op" id="6371511">.</span><span class="ident" id="6371512">next</span><span class="op" id="6371516">(</span><span class="op" id="6371517">)</span>&nbsp;<span class="comment" id="6371519">//&nbsp;ignore&nbsp;BOM</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6371535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6371538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6371541">return</span>&nbsp;<span class="ident" id="6371548">s</span><span class="op" id="6371549">.</span><span class="ident" id="6371550">ch</span><br>
<span class="lineno"></span><span class="op" id="6371553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="6371556">func</span>&nbsp;<span class="op" id="6371561">(</span><span class="ident" id="6371562">s</span>&nbsp;<span class="op" id="6371564">*</span><span class="ident" id="6371565">Scanner</span><span class="op" id="6371572">)</span>&nbsp;<span class="builtintype" id="6371574">error</span><span class="op" id="6371579">(</span><span class="ident" id="6371580">msg</span>&nbsp;<span class="builtintype" id="6371584">string</span><span class="op" id="6371590">)</span>&nbsp;<span class="op" id="6371592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6371595">s</span><span class="op" id="6371596">.</span><span class="ident" id="6371597">ErrorCount</span><span class="op" id="6371607">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6371611">if</span>&nbsp;<span class="ident" id="6371614">s</span><span class="op" id="6371615">.</span><span class="ident" id="6371616">Error</span>&nbsp;<span class="op" id="6371622">!=</span>&nbsp;<span class="ident" id="6371625">nil</span>&nbsp;<span class="op" id="6371629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6371633">s</span><span class="op" id="6371634">.</span><span class="ident" id="6371635">Error</span><span class="op" id="6371640">(</span><span class="ident" id="6371641">s</span><span class="op" id="6371642">,</span>&nbsp;<span class="ident" id="6371644">msg</span><span class="op" id="6371647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6371651">return</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6371659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6371662">pos</span>&nbsp;<span class="op" id="6371666">:=</span>&nbsp;<span class="ident" id="6371669">s</span><span class="op" id="6371670">.</span><span class="ident" id="6371671">Position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6371681">if</span>&nbsp;<span class="op" id="6371684">!</span><span class="ident" id="6371685">pos</span><span class="op" id="6371688">.</span><span class="ident" id="6371689">IsValid</span><span class="op" id="6371696">(</span><span class="op" id="6371697">)</span>&nbsp;<span class="op" id="6371699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6371703">pos</span>&nbsp;<span class="op" id="6371707">=</span>&nbsp;<span class="ident" id="6371709">s</span><span class="op" id="6371710">.</span><span class="ident" id="6371711">Pos</span><span class="op" id="6371714">(</span><span class="op" id="6371715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6371718">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6371721">fmt</span><span class="op" id="6371724">.</span><span class="ident" id="6371725">Fprintf</span><span class="op" id="6371732">(</span><span class="ident" id="6371733">os</span><span class="op" id="6371735">.</span><span class="ident" id="6371736">Stderr</span><span class="op" id="6371742">,</span>&nbsp;<span class="string" id="6371744">&#34;%s:&nbsp;%s\n&#34;</span><span class="op" id="6371754">,</span>&nbsp;<span class="ident" id="6371756">pos</span><span class="op" id="6371759">,</span>&nbsp;<span class="ident" id="6371761">msg</span><span class="op" id="6371764">)</span><br>
<span class="lineno"></span><span class="op" id="6371766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6371769">func</span>&nbsp;<span class="op" id="6371774">(</span><span class="ident" id="6371775">s</span>&nbsp;<span class="op" id="6371777">*</span><span class="ident" id="6371778">Scanner</span><span class="op" id="6371785">)</span>&nbsp;<span class="ident" id="6371787">isIdentRune</span><span class="op" id="6371798">(</span><span class="ident" id="6371799">ch</span>&nbsp;<span class="builtintype" id="6371802">rune</span><span class="op" id="6371806">,</span>&nbsp;<span class="ident" id="6371808">i</span>&nbsp;<span class="builtintype" id="6371810">int</span><span class="op" id="6371813">)</span>&nbsp;<span class="builtintype" id="6371815">bool</span>&nbsp;<span class="op" id="6371820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6371823">if</span>&nbsp;<span class="ident" id="6371826">s</span><span class="op" id="6371827">.</span><span class="ident" id="6371828">IsIdentRune</span>&nbsp;<span class="op" id="6371840">!=</span>&nbsp;<span class="ident" id="6371843">nil</span>&nbsp;<span class="op" id="6371847">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6371851">return</span>&nbsp;<span class="ident" id="6371858">s</span><span class="op" id="6371859">.</span><span class="ident" id="6371860">IsIdentRune</span><span class="op" id="6371871">(</span><span class="ident" id="6371872">ch</span><span class="op" id="6371874">,</span>&nbsp;<span class="ident" id="6371876">i</span><span class="op" id="6371877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6371880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6371883">return</span>&nbsp;<span class="ident" id="6371890">ch</span>&nbsp;<span class="op" id="6371893">==</span>&nbsp;<span class="string" id="6371896">&#39;_&#39;</span>&nbsp;<span class="op" id="6371900">||</span>&nbsp;<span class="ident" id="6371903">unicode</span><span class="op" id="6371910">.</span><span class="ident" id="6371911">IsLetter</span><span class="op" id="6371919">(</span><span class="ident" id="6371920">ch</span><span class="op" id="6371922">)</span>&nbsp;<span class="op" id="6371924">||</span>&nbsp;<span class="ident" id="6371927">unicode</span><span class="op" id="6371934">.</span><span class="ident" id="6371935">IsDigit</span><span class="op" id="6371942">(</span><span class="ident" id="6371943">ch</span><span class="op" id="6371945">)</span>&nbsp;<span class="op" id="6371947">&amp;&amp;</span>&nbsp;<span class="ident" id="6371950">i</span>&nbsp;<span class="op" id="6371952">&gt;</span>&nbsp;<span class="num" id="6371954">0</span><br>
<span class="lineno"></span><span class="op" id="6371956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="keyword" id="6371959">func</span>&nbsp;<span class="op" id="6371964">(</span><span class="ident" id="6371965">s</span>&nbsp;<span class="op" id="6371967">*</span><span class="ident" id="6371968">Scanner</span><span class="op" id="6371975">)</span>&nbsp;<span class="ident" id="6371977">scanIdentifier</span><span class="op" id="6371991">(</span><span class="op" id="6371992">)</span>&nbsp;<span class="builtintype" id="6371994">rune</span>&nbsp;<span class="op" id="6371999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6372002">//&nbsp;we&nbsp;know&nbsp;the&nbsp;zero&#39;th&nbsp;rune&nbsp;is&nbsp;OK;&nbsp;start&nbsp;scanning&nbsp;at&nbsp;the&nbsp;next&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6372069">ch</span>&nbsp;<span class="op" id="6372072">:=</span>&nbsp;<span class="ident" id="6372075">s</span><span class="op" id="6372076">.</span><span class="ident" id="6372077">next</span><span class="op" id="6372081">(</span><span class="op" id="6372082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6372085">for</span>&nbsp;<span class="ident" id="6372089">i</span>&nbsp;<span class="op" id="6372091">:=</span>&nbsp;<span class="num" id="6372094">1</span><span class="op" id="6372095">;</span>&nbsp;<span class="ident" id="6372097">s</span><span class="op" id="6372098">.</span><span class="ident" id="6372099">isIdentRune</span><span class="op" id="6372110">(</span><span class="ident" id="6372111">ch</span><span class="op" id="6372113">,</span>&nbsp;<span class="ident" id="6372115">i</span><span class="op" id="6372116">)</span><span class="op" id="6372117">;</span>&nbsp;<span class="ident" id="6372119">i</span><span class="op" id="6372120">++</span>&nbsp;<span class="op" id="6372123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6372127">ch</span>&nbsp;<span class="op" id="6372130">=</span>&nbsp;<span class="ident" id="6372132">s</span><span class="op" id="6372133">.</span><span class="ident" id="6372134">next</span><span class="op" id="6372138">(</span><span class="op" id="6372139">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6372142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6372145">return</span>&nbsp;<span class="ident" id="6372152">ch</span><br>
<span class="lineno"></span><span class="op" id="6372155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6372158">func</span>&nbsp;<span class="ident" id="6372163">digitVal</span><span class="op" id="6372171">(</span><span class="ident" id="6372172">ch</span>&nbsp;<span class="builtintype" id="6372175">rune</span><span class="op" id="6372179">)</span>&nbsp;<span class="builtintype" id="6372181">int</span>&nbsp;<span class="op" id="6372185">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6372188">switch</span>&nbsp;<span class="op" id="6372195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6372198">case</span>&nbsp;<span class="string" id="6372203">&#39;0&#39;</span>&nbsp;<span class="op" id="6372207">&lt;=</span>&nbsp;<span class="ident" id="6372210">ch</span>&nbsp;<span class="op" id="6372213">&amp;&amp;</span>&nbsp;<span class="ident" id="6372216">ch</span>&nbsp;<span class="op" id="6372219">&lt;=</span>&nbsp;<span class="string" id="6372222">&#39;9&#39;</span><span class="op" id="6372225">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6372229">return</span>&nbsp;<span class="builtintype" id="6372236">int</span><span class="op" id="6372239">(</span><span class="ident" id="6372240">ch</span>&nbsp;<span class="op" id="6372243">-</span>&nbsp;<span class="string" id="6372245">&#39;0&#39;</span><span class="op" id="6372248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6372251">case</span>&nbsp;<span class="string" id="6372256">&#39;a&#39;</span>&nbsp;<span class="op" id="6372260">&lt;=</span>&nbsp;<span class="ident" id="6372263">ch</span>&nbsp;<span class="op" id="6372266">&amp;&amp;</span>&nbsp;<span class="ident" id="6372269">ch</span>&nbsp;<span class="op" id="6372272">&lt;=</span>&nbsp;<span class="string" id="6372275">&#39;f&#39;</span><span class="op" id="6372278">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6372282">return</span>&nbsp;<span class="builtintype" id="6372289">int</span><span class="op" id="6372292">(</span><span class="ident" id="6372293">ch</span>&nbsp;<span class="op" id="6372296">-</span>&nbsp;<span class="string" id="6372298">&#39;a&#39;</span>&nbsp;<span class="op" id="6372302">+</span>&nbsp;<span class="num" id="6372304">10</span><span class="op" id="6372306">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6372309">case</span>&nbsp;<span class="string" id="6372314">&#39;A&#39;</span>&nbsp;<span class="op" id="6372318">&lt;=</span>&nbsp;<span class="ident" id="6372321">ch</span>&nbsp;<span class="op" id="6372324">&amp;&amp;</span>&nbsp;<span class="ident" id="6372327">ch</span>&nbsp;<span class="op" id="6372330">&lt;=</span>&nbsp;<span class="string" id="6372333">&#39;F&#39;</span><span class="op" id="6372336">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6372340">return</span>&nbsp;<span class="builtintype" id="6372347">int</span><span class="op" id="6372350">(</span><span class="ident" id="6372351">ch</span>&nbsp;<span class="op" id="6372354">-</span>&nbsp;<span class="string" id="6372356">&#39;A&#39;</span>&nbsp;<span class="op" id="6372360">+</span>&nbsp;<span class="num" id="6372362">10</span><span class="op" id="6372364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6372367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6372370">return</span>&nbsp;<span class="num" id="6372377">16</span>&nbsp;<span class="comment" id="6372380">//&nbsp;larger&nbsp;than&nbsp;any&nbsp;legal&nbsp;digit&nbsp;val</span><br>
<span class="lineno"></span><span class="op" id="6372415">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span><span class="keyword" id="6372418">func</span>&nbsp;<span class="ident" id="6372423">isDecimal</span><span class="op" id="6372432">(</span><span class="ident" id="6372433">ch</span>&nbsp;<span class="builtintype" id="6372436">rune</span><span class="op" id="6372440">)</span>&nbsp;<span class="builtintype" id="6372442">bool</span>&nbsp;<span class="op" id="6372447">{</span>&nbsp;<span class="keyword" id="6372449">return</span>&nbsp;<span class="string" id="6372456">&#39;0&#39;</span>&nbsp;<span class="op" id="6372460">&lt;=</span>&nbsp;<span class="ident" id="6372463">ch</span>&nbsp;<span class="op" id="6372466">&amp;&amp;</span>&nbsp;<span class="ident" id="6372469">ch</span>&nbsp;<span class="op" id="6372472">&lt;=</span>&nbsp;<span class="string" id="6372475">&#39;9&#39;</span>&nbsp;<span class="op" id="6372479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6372482">func</span>&nbsp;<span class="op" id="6372487">(</span><span class="ident" id="6372488">s</span>&nbsp;<span class="op" id="6372490">*</span><span class="ident" id="6372491">Scanner</span><span class="op" id="6372498">)</span>&nbsp;<span class="ident" id="6372500">scanMantissa</span><span class="op" id="6372512">(</span><span class="ident" id="6372513">ch</span>&nbsp;<span class="builtintype" id="6372516">rune</span><span class="op" id="6372520">)</span>&nbsp;<span class="builtintype" id="6372522">rune</span>&nbsp;<span class="op" id="6372527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6372530">for</span>&nbsp;<span class="ident" id="6372534">isDecimal</span><span class="op" id="6372543">(</span><span class="ident" id="6372544">ch</span><span class="op" id="6372546">)</span>&nbsp;<span class="op" id="6372548">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6372552">ch</span>&nbsp;<span class="op" id="6372555">=</span>&nbsp;<span class="ident" id="6372557">s</span><span class="op" id="6372558">.</span><span class="ident" id="6372559">next</span><span class="op" id="6372563">(</span><span class="op" id="6372564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6372567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6372570">return</span>&nbsp;<span class="ident" id="6372577">ch</span><br>
<span class="lineno"></span><span class="op" id="6372580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="6372583">func</span>&nbsp;<span class="op" id="6372588">(</span><span class="ident" id="6372589">s</span>&nbsp;<span class="op" id="6372591">*</span><span class="ident" id="6372592">Scanner</span><span class="op" id="6372599">)</span>&nbsp;<span class="ident" id="6372601">scanFraction</span><span class="op" id="6372613">(</span><span class="ident" id="6372614">ch</span>&nbsp;<span class="builtintype" id="6372617">rune</span><span class="op" id="6372621">)</span>&nbsp;<span class="builtintype" id="6372623">rune</span>&nbsp;<span class="op" id="6372628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6372631">if</span>&nbsp;<span class="ident" id="6372634">ch</span>&nbsp;<span class="op" id="6372637">==</span>&nbsp;<span class="string" id="6372640">&#39;.&#39;</span>&nbsp;<span class="op" id="6372644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6372648">ch</span>&nbsp;<span class="op" id="6372651">=</span>&nbsp;<span class="ident" id="6372653">s</span><span class="op" id="6372654">.</span><span class="ident" id="6372655">scanMantissa</span><span class="op" id="6372667">(</span><span class="ident" id="6372668">s</span><span class="op" id="6372669">.</span><span class="ident" id="6372670">next</span><span class="op" id="6372674">(</span><span class="op" id="6372675">)</span><span class="op" id="6372676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6372679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6372682">return</span>&nbsp;<span class="ident" id="6372689">ch</span><br>
<span class="lineno">390</span><span class="op" id="6372692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6372695">func</span>&nbsp;<span class="op" id="6372700">(</span><span class="ident" id="6372701">s</span>&nbsp;<span class="op" id="6372703">*</span><span class="ident" id="6372704">Scanner</span><span class="op" id="6372711">)</span>&nbsp;<span class="ident" id="6372713">scanExponent</span><span class="op" id="6372725">(</span><span class="ident" id="6372726">ch</span>&nbsp;<span class="builtintype" id="6372729">rune</span><span class="op" id="6372733">)</span>&nbsp;<span class="builtintype" id="6372735">rune</span>&nbsp;<span class="op" id="6372740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6372743">if</span>&nbsp;<span class="ident" id="6372746">ch</span>&nbsp;<span class="op" id="6372749">==</span>&nbsp;<span class="string" id="6372752">&#39;e&#39;</span>&nbsp;<span class="op" id="6372756">||</span>&nbsp;<span class="ident" id="6372759">ch</span>&nbsp;<span class="op" id="6372762">==</span>&nbsp;<span class="string" id="6372765">&#39;E&#39;</span>&nbsp;<span class="op" id="6372769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6372773">ch</span>&nbsp;<span class="op" id="6372776">=</span>&nbsp;<span class="ident" id="6372778">s</span><span class="op" id="6372779">.</span><span class="ident" id="6372780">next</span><span class="op" id="6372784">(</span><span class="op" id="6372785">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6372789">if</span>&nbsp;<span class="ident" id="6372792">ch</span>&nbsp;<span class="op" id="6372795">==</span>&nbsp;<span class="string" id="6372798">&#39;-&#39;</span>&nbsp;<span class="op" id="6372802">||</span>&nbsp;<span class="ident" id="6372805">ch</span>&nbsp;<span class="op" id="6372808">==</span>&nbsp;<span class="string" id="6372811">&#39;+&#39;</span>&nbsp;<span class="op" id="6372815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6372820">ch</span>&nbsp;<span class="op" id="6372823">=</span>&nbsp;<span class="ident" id="6372825">s</span><span class="op" id="6372826">.</span><span class="ident" id="6372827">next</span><span class="op" id="6372831">(</span><span class="op" id="6372832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6372836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6372840">ch</span>&nbsp;<span class="op" id="6372843">=</span>&nbsp;<span class="ident" id="6372845">s</span><span class="op" id="6372846">.</span><span class="ident" id="6372847">scanMantissa</span><span class="op" id="6372859">(</span><span class="ident" id="6372860">ch</span><span class="op" id="6372862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6372865">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6372868">return</span>&nbsp;<span class="ident" id="6372875">ch</span><br>
<span class="lineno"></span><span class="op" id="6372878">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6372881">func</span>&nbsp;<span class="op" id="6372886">(</span><span class="ident" id="6372887">s</span>&nbsp;<span class="op" id="6372889">*</span><span class="ident" id="6372890">Scanner</span><span class="op" id="6372897">)</span>&nbsp;<span class="ident" id="6372899">scanNumber</span><span class="op" id="6372909">(</span><span class="ident" id="6372910">ch</span>&nbsp;<span class="builtintype" id="6372913">rune</span><span class="op" id="6372917">)</span>&nbsp;<span class="op" id="6372919">(</span><span class="builtintype" id="6372920">rune</span><span class="op" id="6372924">,</span>&nbsp;<span class="builtintype" id="6372926">rune</span><span class="op" id="6372930">)</span>&nbsp;<span class="op" id="6372932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6372935">//&nbsp;isDecimal(ch)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6372953">if</span>&nbsp;<span class="ident" id="6372956">ch</span>&nbsp;<span class="op" id="6372959">==</span>&nbsp;<span class="string" id="6372962">&#39;0&#39;</span>&nbsp;<span class="op" id="6372966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6372970">//&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6372988">ch</span>&nbsp;<span class="op" id="6372991">=</span>&nbsp;<span class="ident" id="6372993">s</span><span class="op" id="6372994">.</span><span class="ident" id="6372995">next</span><span class="op" id="6372999">(</span><span class="op" id="6373000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6373004">if</span>&nbsp;<span class="ident" id="6373007">ch</span>&nbsp;<span class="op" id="6373010">==</span>&nbsp;<span class="string" id="6373013">&#39;x&#39;</span>&nbsp;<span class="op" id="6373017">||</span>&nbsp;<span class="ident" id="6373020">ch</span>&nbsp;<span class="op" id="6373023">==</span>&nbsp;<span class="string" id="6373026">&#39;X&#39;</span>&nbsp;<span class="op" id="6373030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6373035">//&nbsp;hexadecimal&nbsp;int</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6373057">ch</span>&nbsp;<span class="op" id="6373060">=</span>&nbsp;<span class="ident" id="6373062">s</span><span class="op" id="6373063">.</span><span class="ident" id="6373064">next</span><span class="op" id="6373068">(</span><span class="op" id="6373069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6373074">hasMantissa</span>&nbsp;<span class="op" id="6373086">:=</span>&nbsp;<span class="builtintype" id="6373089">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6373098">for</span>&nbsp;<span class="ident" id="6373102">digitVal</span><span class="op" id="6373110">(</span><span class="ident" id="6373111">ch</span><span class="op" id="6373113">)</span>&nbsp;<span class="op" id="6373115">&lt;</span>&nbsp;<span class="num" id="6373117">16</span>&nbsp;<span class="op" id="6373120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6373126">ch</span>&nbsp;<span class="op" id="6373129">=</span>&nbsp;<span class="ident" id="6373131">s</span><span class="op" id="6373132">.</span><span class="ident" id="6373133">next</span><span class="op" id="6373137">(</span><span class="op" id="6373138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6373144">hasMantissa</span>&nbsp;<span class="op" id="6373156">=</span>&nbsp;<span class="builtintype" id="6373158">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6373166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6373171">if</span>&nbsp;<span class="op" id="6373174">!</span><span class="ident" id="6373175">hasMantissa</span>&nbsp;<span class="op" id="6373187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6373193">s</span><span class="op" id="6373194">.</span><span class="builtintype" id="6373195">error</span><span class="op" id="6373200">(</span><span class="string" id="6373201">&#34;illegal&nbsp;hexadecimal&nbsp;number&#34;</span><span class="op" id="6373229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6373234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6373238">}</span>&nbsp;<span class="keyword" id="6373240">else</span>&nbsp;<span class="op" id="6373245">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6373250">//&nbsp;octal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6373275">has8or9</span>&nbsp;<span class="op" id="6373283">:=</span>&nbsp;<span class="builtintype" id="6373286">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6373295">for</span>&nbsp;<span class="ident" id="6373299">isDecimal</span><span class="op" id="6373308">(</span><span class="ident" id="6373309">ch</span><span class="op" id="6373311">)</span>&nbsp;<span class="op" id="6373313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6373319">if</span>&nbsp;<span class="ident" id="6373322">ch</span>&nbsp;<span class="op" id="6373325">&gt;</span>&nbsp;<span class="string" id="6373327">&#39;7&#39;</span>&nbsp;<span class="op" id="6373331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6373338">has8or9</span>&nbsp;<span class="op" id="6373346">=</span>&nbsp;<span class="builtintype" id="6373348">true</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6373357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6373363">ch</span>&nbsp;<span class="op" id="6373366">=</span>&nbsp;<span class="ident" id="6373368">s</span><span class="op" id="6373369">.</span><span class="ident" id="6373370">next</span><span class="op" id="6373374">(</span><span class="op" id="6373375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6373380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6373385">if</span>&nbsp;<span class="ident" id="6373388">s</span><span class="op" id="6373389">.</span><span class="ident" id="6373390">Mode</span><span class="op" id="6373394">&amp;</span><span class="ident" id="6373395">ScanFloats</span>&nbsp;<span class="op" id="6373406">!=</span>&nbsp;<span class="num" id="6373409">0</span>&nbsp;<span class="op" id="6373411">&amp;&amp;</span>&nbsp;<span class="op" id="6373414">(</span><span class="ident" id="6373415">ch</span>&nbsp;<span class="op" id="6373418">==</span>&nbsp;<span class="string" id="6373421">&#39;.&#39;</span>&nbsp;<span class="op" id="6373425">||</span>&nbsp;<span class="ident" id="6373428">ch</span>&nbsp;<span class="op" id="6373431">==</span>&nbsp;<span class="string" id="6373434">&#39;e&#39;</span>&nbsp;<span class="op" id="6373438">||</span>&nbsp;<span class="ident" id="6373441">ch</span>&nbsp;<span class="op" id="6373444">==</span>&nbsp;<span class="string" id="6373447">&#39;E&#39;</span><span class="op" id="6373450">)</span>&nbsp;<span class="op" id="6373452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6373458">//&nbsp;float</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6373471">ch</span>&nbsp;<span class="op" id="6373474">=</span>&nbsp;<span class="ident" id="6373476">s</span><span class="op" id="6373477">.</span><span class="ident" id="6373478">scanFraction</span><span class="op" id="6373490">(</span><span class="ident" id="6373491">ch</span><span class="op" id="6373493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6373499">ch</span>&nbsp;<span class="op" id="6373502">=</span>&nbsp;<span class="ident" id="6373504">s</span><span class="op" id="6373505">.</span><span class="ident" id="6373506">scanExponent</span><span class="op" id="6373518">(</span><span class="ident" id="6373519">ch</span><span class="op" id="6373521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6373527">return</span>&nbsp;<span class="ident" id="6373534">Float</span><span class="op" id="6373539">,</span>&nbsp;<span class="ident" id="6373541">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6373547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6373552">//&nbsp;octal&nbsp;int</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6373568">if</span>&nbsp;<span class="ident" id="6373571">has8or9</span>&nbsp;<span class="op" id="6373579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6373585">s</span><span class="op" id="6373586">.</span><span class="builtintype" id="6373587">error</span><span class="op" id="6373592">(</span><span class="string" id="6373593">&#34;illegal&nbsp;octal&nbsp;number&#34;</span><span class="op" id="6373615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6373620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6373624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6373628">return</span>&nbsp;<span class="ident" id="6373635">Int</span><span class="op" id="6373638">,</span>&nbsp;<span class="ident" id="6373640">ch</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6373644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6373647">//&nbsp;decimal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6373672">ch</span>&nbsp;<span class="op" id="6373675">=</span>&nbsp;<span class="ident" id="6373677">s</span><span class="op" id="6373678">.</span><span class="ident" id="6373679">scanMantissa</span><span class="op" id="6373691">(</span><span class="ident" id="6373692">ch</span><span class="op" id="6373694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6373697">if</span>&nbsp;<span class="ident" id="6373700">s</span><span class="op" id="6373701">.</span><span class="ident" id="6373702">Mode</span><span class="op" id="6373706">&amp;</span><span class="ident" id="6373707">ScanFloats</span>&nbsp;<span class="op" id="6373718">!=</span>&nbsp;<span class="num" id="6373721">0</span>&nbsp;<span class="op" id="6373723">&amp;&amp;</span>&nbsp;<span class="op" id="6373726">(</span><span class="ident" id="6373727">ch</span>&nbsp;<span class="op" id="6373730">==</span>&nbsp;<span class="string" id="6373733">&#39;.&#39;</span>&nbsp;<span class="op" id="6373737">||</span>&nbsp;<span class="ident" id="6373740">ch</span>&nbsp;<span class="op" id="6373743">==</span>&nbsp;<span class="string" id="6373746">&#39;e&#39;</span>&nbsp;<span class="op" id="6373750">||</span>&nbsp;<span class="ident" id="6373753">ch</span>&nbsp;<span class="op" id="6373756">==</span>&nbsp;<span class="string" id="6373759">&#39;E&#39;</span><span class="op" id="6373762">)</span>&nbsp;<span class="op" id="6373764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6373768">//&nbsp;float</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6373779">ch</span>&nbsp;<span class="op" id="6373782">=</span>&nbsp;<span class="ident" id="6373784">s</span><span class="op" id="6373785">.</span><span class="ident" id="6373786">scanFraction</span><span class="op" id="6373798">(</span><span class="ident" id="6373799">ch</span><span class="op" id="6373801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6373805">ch</span>&nbsp;<span class="op" id="6373808">=</span>&nbsp;<span class="ident" id="6373810">s</span><span class="op" id="6373811">.</span><span class="ident" id="6373812">scanExponent</span><span class="op" id="6373824">(</span><span class="ident" id="6373825">ch</span><span class="op" id="6373827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6373831">return</span>&nbsp;<span class="ident" id="6373838">Float</span><span class="op" id="6373843">,</span>&nbsp;<span class="ident" id="6373845">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6373849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6373852">return</span>&nbsp;<span class="ident" id="6373859">Int</span><span class="op" id="6373862">,</span>&nbsp;<span class="ident" id="6373864">ch</span><br>
<span class="lineno">450</span><span class="op" id="6373867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6373870">func</span>&nbsp;<span class="op" id="6373875">(</span><span class="ident" id="6373876">s</span>&nbsp;<span class="op" id="6373878">*</span><span class="ident" id="6373879">Scanner</span><span class="op" id="6373886">)</span>&nbsp;<span class="ident" id="6373888">scanDigits</span><span class="op" id="6373898">(</span><span class="ident" id="6373899">ch</span>&nbsp;<span class="builtintype" id="6373902">rune</span><span class="op" id="6373906">,</span>&nbsp;<span class="ident" id="6373908">base</span><span class="op" id="6373912">,</span>&nbsp;<span class="ident" id="6373914">n</span>&nbsp;<span class="builtintype" id="6373916">int</span><span class="op" id="6373919">)</span>&nbsp;<span class="builtintype" id="6373921">rune</span>&nbsp;<span class="op" id="6373926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6373929">for</span>&nbsp;<span class="ident" id="6373933">n</span>&nbsp;<span class="op" id="6373935">&gt;</span>&nbsp;<span class="num" id="6373937">0</span>&nbsp;<span class="op" id="6373939">&amp;&amp;</span>&nbsp;<span class="ident" id="6373942">digitVal</span><span class="op" id="6373950">(</span><span class="ident" id="6373951">ch</span><span class="op" id="6373953">)</span>&nbsp;<span class="op" id="6373955">&lt;</span>&nbsp;<span class="ident" id="6373957">base</span>&nbsp;<span class="op" id="6373962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6373966">ch</span>&nbsp;<span class="op" id="6373969">=</span>&nbsp;<span class="ident" id="6373971">s</span><span class="op" id="6373972">.</span><span class="ident" id="6373973">next</span><span class="op" id="6373977">(</span><span class="op" id="6373978">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6373982">n</span><span class="op" id="6373983">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6373987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6373990">if</span>&nbsp;<span class="ident" id="6373993">n</span>&nbsp;<span class="op" id="6373995">&gt;</span>&nbsp;<span class="num" id="6373997">0</span>&nbsp;<span class="op" id="6373999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6374003">s</span><span class="op" id="6374004">.</span><span class="builtintype" id="6374005">error</span><span class="op" id="6374010">(</span><span class="string" id="6374011">&#34;illegal&nbsp;char&nbsp;escape&#34;</span><span class="op" id="6374032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6374035">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6374038">return</span>&nbsp;<span class="ident" id="6374045">ch</span><br>
<span class="lineno"></span><span class="op" id="6374048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6374051">func</span>&nbsp;<span class="op" id="6374056">(</span><span class="ident" id="6374057">s</span>&nbsp;<span class="op" id="6374059">*</span><span class="ident" id="6374060">Scanner</span><span class="op" id="6374067">)</span>&nbsp;<span class="ident" id="6374069">scanEscape</span><span class="op" id="6374079">(</span><span class="ident" id="6374080">quote</span>&nbsp;<span class="builtintype" id="6374086">rune</span><span class="op" id="6374090">)</span>&nbsp;<span class="builtintype" id="6374092">rune</span>&nbsp;<span class="op" id="6374097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6374100">ch</span>&nbsp;<span class="op" id="6374103">:=</span>&nbsp;<span class="ident" id="6374106">s</span><span class="op" id="6374107">.</span><span class="ident" id="6374108">next</span><span class="op" id="6374112">(</span><span class="op" id="6374113">)</span>&nbsp;<span class="comment" id="6374115">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#39;/&#39;</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6374144">switch</span>&nbsp;<span class="ident" id="6374151">ch</span>&nbsp;<span class="op" id="6374154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6374157">case</span>&nbsp;<span class="string" id="6374162">&#39;a&#39;</span><span class="op" id="6374165">,</span>&nbsp;<span class="string" id="6374167">&#39;b&#39;</span><span class="op" id="6374170">,</span>&nbsp;<span class="string" id="6374172">&#39;f&#39;</span><span class="op" id="6374175">,</span>&nbsp;<span class="string" id="6374177">&#39;n&#39;</span><span class="op" id="6374180">,</span>&nbsp;<span class="string" id="6374182">&#39;r&#39;</span><span class="op" id="6374185">,</span>&nbsp;<span class="string" id="6374187">&#39;t&#39;</span><span class="op" id="6374190">,</span>&nbsp;<span class="string" id="6374192">&#39;v&#39;</span><span class="op" id="6374195">,</span>&nbsp;<span class="string" id="6374197">&#39;\\&#39;</span><span class="op" id="6374201">,</span>&nbsp;<span class="ident" id="6374203">quote</span><span class="op" id="6374208">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6374212">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6374231">ch</span>&nbsp;<span class="op" id="6374234">=</span>&nbsp;<span class="ident" id="6374236">s</span><span class="op" id="6374237">.</span><span class="ident" id="6374238">next</span><span class="op" id="6374242">(</span><span class="op" id="6374243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6374246">case</span>&nbsp;<span class="string" id="6374251">&#39;0&#39;</span><span class="op" id="6374254">,</span>&nbsp;<span class="string" id="6374256">&#39;1&#39;</span><span class="op" id="6374259">,</span>&nbsp;<span class="string" id="6374261">&#39;2&#39;</span><span class="op" id="6374264">,</span>&nbsp;<span class="string" id="6374266">&#39;3&#39;</span><span class="op" id="6374269">,</span>&nbsp;<span class="string" id="6374271">&#39;4&#39;</span><span class="op" id="6374274">,</span>&nbsp;<span class="string" id="6374276">&#39;5&#39;</span><span class="op" id="6374279">,</span>&nbsp;<span class="string" id="6374281">&#39;6&#39;</span><span class="op" id="6374284">,</span>&nbsp;<span class="string" id="6374286">&#39;7&#39;</span><span class="op" id="6374289">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6374293">ch</span>&nbsp;<span class="op" id="6374296">=</span>&nbsp;<span class="ident" id="6374298">s</span><span class="op" id="6374299">.</span><span class="ident" id="6374300">scanDigits</span><span class="op" id="6374310">(</span><span class="ident" id="6374311">ch</span><span class="op" id="6374313">,</span>&nbsp;<span class="num" id="6374315">8</span><span class="op" id="6374316">,</span>&nbsp;<span class="num" id="6374318">3</span><span class="op" id="6374319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6374322">case</span>&nbsp;<span class="string" id="6374327">&#39;x&#39;</span><span class="op" id="6374330">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6374334">ch</span>&nbsp;<span class="op" id="6374337">=</span>&nbsp;<span class="ident" id="6374339">s</span><span class="op" id="6374340">.</span><span class="ident" id="6374341">scanDigits</span><span class="op" id="6374351">(</span><span class="ident" id="6374352">s</span><span class="op" id="6374353">.</span><span class="ident" id="6374354">next</span><span class="op" id="6374358">(</span><span class="op" id="6374359">)</span><span class="op" id="6374360">,</span>&nbsp;<span class="num" id="6374362">16</span><span class="op" id="6374364">,</span>&nbsp;<span class="num" id="6374366">2</span><span class="op" id="6374367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6374370">case</span>&nbsp;<span class="string" id="6374375">&#39;u&#39;</span><span class="op" id="6374378">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6374382">ch</span>&nbsp;<span class="op" id="6374385">=</span>&nbsp;<span class="ident" id="6374387">s</span><span class="op" id="6374388">.</span><span class="ident" id="6374389">scanDigits</span><span class="op" id="6374399">(</span><span class="ident" id="6374400">s</span><span class="op" id="6374401">.</span><span class="ident" id="6374402">next</span><span class="op" id="6374406">(</span><span class="op" id="6374407">)</span><span class="op" id="6374408">,</span>&nbsp;<span class="num" id="6374410">16</span><span class="op" id="6374412">,</span>&nbsp;<span class="num" id="6374414">4</span><span class="op" id="6374415">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6374418">case</span>&nbsp;<span class="string" id="6374423">&#39;U&#39;</span><span class="op" id="6374426">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6374430">ch</span>&nbsp;<span class="op" id="6374433">=</span>&nbsp;<span class="ident" id="6374435">s</span><span class="op" id="6374436">.</span><span class="ident" id="6374437">scanDigits</span><span class="op" id="6374447">(</span><span class="ident" id="6374448">s</span><span class="op" id="6374449">.</span><span class="ident" id="6374450">next</span><span class="op" id="6374454">(</span><span class="op" id="6374455">)</span><span class="op" id="6374456">,</span>&nbsp;<span class="num" id="6374458">16</span><span class="op" id="6374460">,</span>&nbsp;<span class="num" id="6374462">8</span><span class="op" id="6374463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6374466">default</span><span class="op" id="6374473">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6374477">s</span><span class="op" id="6374478">.</span><span class="builtintype" id="6374479">error</span><span class="op" id="6374484">(</span><span class="string" id="6374485">&#34;illegal&nbsp;char&nbsp;escape&#34;</span><span class="op" id="6374506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6374509">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6374512">return</span>&nbsp;<span class="ident" id="6374519">ch</span><br>
<span class="lineno"></span><span class="op" id="6374522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6374525">func</span>&nbsp;<span class="op" id="6374530">(</span><span class="ident" id="6374531">s</span>&nbsp;<span class="op" id="6374533">*</span><span class="ident" id="6374534">Scanner</span><span class="op" id="6374541">)</span>&nbsp;<span class="ident" id="6374543">scanString</span><span class="op" id="6374553">(</span><span class="ident" id="6374554">quote</span>&nbsp;<span class="builtintype" id="6374560">rune</span><span class="op" id="6374564">)</span>&nbsp;<span class="op" id="6374566">(</span><span class="ident" id="6374567">n</span>&nbsp;<span class="builtintype" id="6374569">int</span><span class="op" id="6374572">)</span>&nbsp;<span class="op" id="6374574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6374577">ch</span>&nbsp;<span class="op" id="6374580">:=</span>&nbsp;<span class="ident" id="6374583">s</span><span class="op" id="6374584">.</span><span class="ident" id="6374585">next</span><span class="op" id="6374589">(</span><span class="op" id="6374590">)</span>&nbsp;<span class="comment" id="6374592">//&nbsp;read&nbsp;character&nbsp;after&nbsp;quote</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6374623">for</span>&nbsp;<span class="ident" id="6374627">ch</span>&nbsp;<span class="op" id="6374630">!=</span>&nbsp;<span class="ident" id="6374633">quote</span>&nbsp;<span class="op" id="6374639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6374643">if</span>&nbsp;<span class="ident" id="6374646">ch</span>&nbsp;<span class="op" id="6374649">==</span>&nbsp;<span class="string" id="6374652">&#39;\n&#39;</span>&nbsp;<span class="op" id="6374657">||</span>&nbsp;<span class="ident" id="6374660">ch</span>&nbsp;<span class="op" id="6374663">&lt;</span>&nbsp;<span class="num" id="6374665">0</span>&nbsp;<span class="op" id="6374667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6374672">s</span><span class="op" id="6374673">.</span><span class="builtintype" id="6374674">error</span><span class="op" id="6374679">(</span><span class="string" id="6374680">&#34;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="6374704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6374709">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6374718">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6374722">if</span>&nbsp;<span class="ident" id="6374725">ch</span>&nbsp;<span class="op" id="6374728">==</span>&nbsp;<span class="string" id="6374731">&#39;\\&#39;</span>&nbsp;<span class="op" id="6374736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6374741">ch</span>&nbsp;<span class="op" id="6374744">=</span>&nbsp;<span class="ident" id="6374746">s</span><span class="op" id="6374747">.</span><span class="ident" id="6374748">scanEscape</span><span class="op" id="6374758">(</span><span class="ident" id="6374759">quote</span><span class="op" id="6374764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6374768">}</span>&nbsp;<span class="keyword" id="6374770">else</span>&nbsp;<span class="op" id="6374775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6374780">ch</span>&nbsp;<span class="op" id="6374783">=</span>&nbsp;<span class="ident" id="6374785">s</span><span class="op" id="6374786">.</span><span class="ident" id="6374787">next</span><span class="op" id="6374791">(</span><span class="op" id="6374792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6374796">}</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6374800">n</span><span class="op" id="6374801">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6374805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6374808">return</span><br>
<span class="lineno"></span><span class="op" id="6374815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="6374818">func</span>&nbsp;<span class="op" id="6374823">(</span><span class="ident" id="6374824">s</span>&nbsp;<span class="op" id="6374826">*</span><span class="ident" id="6374827">Scanner</span><span class="op" id="6374834">)</span>&nbsp;<span class="ident" id="6374836">scanRawString</span><span class="op" id="6374849">(</span><span class="op" id="6374850">)</span>&nbsp;<span class="op" id="6374852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6374855">ch</span>&nbsp;<span class="op" id="6374858">:=</span>&nbsp;<span class="ident" id="6374861">s</span><span class="op" id="6374862">.</span><span class="ident" id="6374863">next</span><span class="op" id="6374867">(</span><span class="op" id="6374868">)</span>&nbsp;<span class="comment" id="6374870">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#39;`&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6374899">for</span>&nbsp;<span class="ident" id="6374903">ch</span>&nbsp;<span class="op" id="6374906">!=</span>&nbsp;<span class="string" id="6374909">&#39;`&#39;</span>&nbsp;<span class="op" id="6374913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6374917">if</span>&nbsp;<span class="ident" id="6374920">ch</span>&nbsp;<span class="op" id="6374923">&lt;</span>&nbsp;<span class="num" id="6374925">0</span>&nbsp;<span class="op" id="6374927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6374932">s</span><span class="op" id="6374933">.</span><span class="builtintype" id="6374934">error</span><span class="op" id="6374939">(</span><span class="string" id="6374940">&#34;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="6374964">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6374969">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6374978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6374982">ch</span>&nbsp;<span class="op" id="6374985">=</span>&nbsp;<span class="ident" id="6374987">s</span><span class="op" id="6374988">.</span><span class="ident" id="6374989">next</span><span class="op" id="6374993">(</span><span class="op" id="6374994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6374997">}</span><br>
<span class="lineno"></span><span class="op" id="6374999">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span><span class="keyword" id="6375002">func</span>&nbsp;<span class="op" id="6375007">(</span><span class="ident" id="6375008">s</span>&nbsp;<span class="op" id="6375010">*</span><span class="ident" id="6375011">Scanner</span><span class="op" id="6375018">)</span>&nbsp;<span class="ident" id="6375020">scanChar</span><span class="op" id="6375028">(</span><span class="op" id="6375029">)</span>&nbsp;<span class="op" id="6375031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6375034">if</span>&nbsp;<span class="ident" id="6375037">s</span><span class="op" id="6375038">.</span><span class="ident" id="6375039">scanString</span><span class="op" id="6375049">(</span><span class="string" id="6375050">&#39;\&#39;&#39;</span><span class="op" id="6375054">)</span>&nbsp;<span class="op" id="6375056">!=</span>&nbsp;<span class="num" id="6375059">1</span>&nbsp;<span class="op" id="6375061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6375065">s</span><span class="op" id="6375066">.</span><span class="builtintype" id="6375067">error</span><span class="op" id="6375072">(</span><span class="string" id="6375073">&#34;illegal&nbsp;char&nbsp;literal&#34;</span><span class="op" id="6375095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6375098">}</span><br>
<span class="lineno">515</span><span class="op" id="6375100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6375103">func</span>&nbsp;<span class="op" id="6375108">(</span><span class="ident" id="6375109">s</span>&nbsp;<span class="op" id="6375111">*</span><span class="ident" id="6375112">Scanner</span><span class="op" id="6375119">)</span>&nbsp;<span class="ident" id="6375121">scanComment</span><span class="op" id="6375132">(</span><span class="ident" id="6375133">ch</span>&nbsp;<span class="builtintype" id="6375136">rune</span><span class="op" id="6375140">)</span>&nbsp;<span class="builtintype" id="6375142">rune</span>&nbsp;<span class="op" id="6375147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6375150">//&nbsp;ch&nbsp;==&nbsp;&#39;/&#39;&nbsp;||&nbsp;ch&nbsp;==&nbsp;&#39;*&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6375177">if</span>&nbsp;<span class="ident" id="6375180">ch</span>&nbsp;<span class="op" id="6375183">==</span>&nbsp;<span class="string" id="6375186">&#39;/&#39;</span>&nbsp;<span class="op" id="6375190">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6375194">//&nbsp;line&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6375212">ch</span>&nbsp;<span class="op" id="6375215">=</span>&nbsp;<span class="ident" id="6375217">s</span><span class="op" id="6375218">.</span><span class="ident" id="6375219">next</span><span class="op" id="6375223">(</span><span class="op" id="6375224">)</span>&nbsp;<span class="comment" id="6375226">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#34;//&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6375257">for</span>&nbsp;<span class="ident" id="6375261">ch</span>&nbsp;<span class="op" id="6375264">!=</span>&nbsp;<span class="string" id="6375267">&#39;\n&#39;</span>&nbsp;<span class="op" id="6375272">&amp;&amp;</span>&nbsp;<span class="ident" id="6375275">ch</span>&nbsp;<span class="op" id="6375278">&gt;=</span>&nbsp;<span class="num" id="6375281">0</span>&nbsp;<span class="op" id="6375283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6375288">ch</span>&nbsp;<span class="op" id="6375291">=</span>&nbsp;<span class="ident" id="6375293">s</span><span class="op" id="6375294">.</span><span class="ident" id="6375295">next</span><span class="op" id="6375299">(</span><span class="op" id="6375300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6375304">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6375308">return</span>&nbsp;<span class="ident" id="6375315">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6375319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6375323">//&nbsp;general&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6375343">ch</span>&nbsp;<span class="op" id="6375346">=</span>&nbsp;<span class="ident" id="6375348">s</span><span class="op" id="6375349">.</span><span class="ident" id="6375350">next</span><span class="op" id="6375354">(</span><span class="op" id="6375355">)</span>&nbsp;<span class="comment" id="6375357">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#34;/*&#34;</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6375387">for</span>&nbsp;<span class="op" id="6375391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6375395">if</span>&nbsp;<span class="ident" id="6375398">ch</span>&nbsp;<span class="op" id="6375401">&lt;</span>&nbsp;<span class="num" id="6375403">0</span>&nbsp;<span class="op" id="6375405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6375410">s</span><span class="op" id="6375411">.</span><span class="builtintype" id="6375412">error</span><span class="op" id="6375417">(</span><span class="string" id="6375418">&#34;comment&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="6375442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6375447">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6375455">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6375459">ch0</span>&nbsp;<span class="op" id="6375463">:=</span>&nbsp;<span class="ident" id="6375466">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6375471">ch</span>&nbsp;<span class="op" id="6375474">=</span>&nbsp;<span class="ident" id="6375476">s</span><span class="op" id="6375477">.</span><span class="ident" id="6375478">next</span><span class="op" id="6375482">(</span><span class="op" id="6375483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6375487">if</span>&nbsp;<span class="ident" id="6375490">ch0</span>&nbsp;<span class="op" id="6375494">==</span>&nbsp;<span class="string" id="6375497">&#39;*&#39;</span>&nbsp;<span class="op" id="6375501">&amp;&amp;</span>&nbsp;<span class="ident" id="6375504">ch</span>&nbsp;<span class="op" id="6375507">==</span>&nbsp;<span class="string" id="6375510">&#39;/&#39;</span>&nbsp;<span class="op" id="6375514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6375519">ch</span>&nbsp;<span class="op" id="6375522">=</span>&nbsp;<span class="ident" id="6375524">s</span><span class="op" id="6375525">.</span><span class="ident" id="6375526">next</span><span class="op" id="6375530">(</span><span class="op" id="6375531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6375536">break</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6375544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6375547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6375550">return</span>&nbsp;<span class="ident" id="6375557">ch</span><br>
<span class="lineno"></span><span class="op" id="6375560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span><span class="comment" id="6375563">//&nbsp;Scan&nbsp;reads&nbsp;the&nbsp;next&nbsp;token&nbsp;or&nbsp;Unicode&nbsp;character&nbsp;from&nbsp;source&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="6375641">//&nbsp;It&nbsp;only&nbsp;recognizes&nbsp;tokens&nbsp;t&nbsp;for&nbsp;which&nbsp;the&nbsp;respective&nbsp;Mode&nbsp;bit&nbsp;(1&lt;&lt;-t)&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="6375722">//&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source.&nbsp;It&nbsp;reports&nbsp;scanner&nbsp;errors&nbsp;(read&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6375802">//&nbsp;token&nbsp;errors)&nbsp;by&nbsp;calling&nbsp;s.Error,&nbsp;if&nbsp;not&nbsp;nil;&nbsp;otherwise&nbsp;it&nbsp;prints&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="6375880">//&nbsp;message&nbsp;to&nbsp;os.Stderr.</span><br>
<span class="lineno">550</span><span class="keyword" id="6375905">func</span>&nbsp;<span class="op" id="6375910">(</span><span class="ident" id="6375911">s</span>&nbsp;<span class="op" id="6375913">*</span><span class="ident" id="6375914">Scanner</span><span class="op" id="6375921">)</span>&nbsp;<span class="ident" id="6375923">Scan</span><span class="op" id="6375927">(</span><span class="op" id="6375928">)</span>&nbsp;<span class="builtintype" id="6375930">rune</span>&nbsp;<span class="op" id="6375935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6375938">ch</span>&nbsp;<span class="op" id="6375941">:=</span>&nbsp;<span class="ident" id="6375944">s</span><span class="op" id="6375945">.</span><span class="ident" id="6375946">Peek</span><span class="op" id="6375950">(</span><span class="op" id="6375951">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6375955">//&nbsp;reset&nbsp;token&nbsp;text&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6375985">s</span><span class="op" id="6375986">.</span><span class="ident" id="6375987">tokPos</span>&nbsp;<span class="op" id="6375994">=</span>&nbsp;<span class="op" id="6375996">-</span><span class="num" id="6375997">1</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6376000">s</span><span class="op" id="6376001">.</span><span class="ident" id="6376002">Line</span>&nbsp;<span class="op" id="6376007">=</span>&nbsp;<span class="num" id="6376009">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="6376012">redo</span><span class="op" id="6376016">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6376019">//&nbsp;skip&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6376040">for</span>&nbsp;<span class="ident" id="6376044">s</span><span class="op" id="6376045">.</span><span class="ident" id="6376046">Whitespace</span><span class="op" id="6376056">&amp;</span><span class="op" id="6376057">(</span><span class="num" id="6376058">1</span><span class="op" id="6376059">&lt;&lt;</span><span class="builtintype" id="6376061">uint</span><span class="op" id="6376065">(</span><span class="ident" id="6376066">ch</span><span class="op" id="6376068">)</span><span class="op" id="6376069">)</span>&nbsp;<span class="op" id="6376071">!=</span>&nbsp;<span class="num" id="6376074">0</span>&nbsp;<span class="op" id="6376076">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6376080">ch</span>&nbsp;<span class="op" id="6376083">=</span>&nbsp;<span class="ident" id="6376085">s</span><span class="op" id="6376086">.</span><span class="ident" id="6376087">next</span><span class="op" id="6376091">(</span><span class="op" id="6376092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6376095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6376099">//&nbsp;start&nbsp;collecting&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6376131">s</span><span class="op" id="6376132">.</span><span class="ident" id="6376133">tokBuf</span><span class="op" id="6376139">.</span><span class="ident" id="6376140">Reset</span><span class="op" id="6376145">(</span><span class="op" id="6376146">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6376149">s</span><span class="op" id="6376150">.</span><span class="ident" id="6376151">tokPos</span>&nbsp;<span class="op" id="6376158">=</span>&nbsp;<span class="ident" id="6376160">s</span><span class="op" id="6376161">.</span><span class="ident" id="6376162">srcPos</span>&nbsp;<span class="op" id="6376169">-</span>&nbsp;<span class="ident" id="6376171">s</span><span class="op" id="6376172">.</span><span class="ident" id="6376173">lastCharLen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6376187">//&nbsp;set&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6376210">//&nbsp;(this&nbsp;is&nbsp;a&nbsp;slightly&nbsp;optimized&nbsp;version&nbsp;of&nbsp;the&nbsp;code&nbsp;in&nbsp;Pos())</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6376274">s</span><span class="op" id="6376275">.</span><span class="ident" id="6376276">Offset</span>&nbsp;<span class="op" id="6376283">=</span>&nbsp;<span class="ident" id="6376285">s</span><span class="op" id="6376286">.</span><span class="ident" id="6376287">srcBufOffset</span>&nbsp;<span class="op" id="6376300">+</span>&nbsp;<span class="ident" id="6376302">s</span><span class="op" id="6376303">.</span><span class="ident" id="6376304">tokPos</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6376312">if</span>&nbsp;<span class="ident" id="6376315">s</span><span class="op" id="6376316">.</span><span class="ident" id="6376317">column</span>&nbsp;<span class="op" id="6376324">&gt;</span>&nbsp;<span class="num" id="6376326">0</span>&nbsp;<span class="op" id="6376328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6376332">//&nbsp;common&nbsp;case:&nbsp;last&nbsp;character&nbsp;was&nbsp;not&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6376380">s</span><span class="op" id="6376381">.</span><span class="ident" id="6376382">Line</span>&nbsp;<span class="op" id="6376387">=</span>&nbsp;<span class="ident" id="6376389">s</span><span class="op" id="6376390">.</span><span class="ident" id="6376391">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6376398">s</span><span class="op" id="6376399">.</span><span class="ident" id="6376400">Column</span>&nbsp;<span class="op" id="6376407">=</span>&nbsp;<span class="ident" id="6376409">s</span><span class="op" id="6376410">.</span><span class="ident" id="6376411">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6376419">}</span>&nbsp;<span class="keyword" id="6376421">else</span>&nbsp;<span class="op" id="6376426">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6376430">//&nbsp;last&nbsp;character&nbsp;was&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6376461">//&nbsp;(we&nbsp;cannot&nbsp;be&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6376511">//&nbsp;since&nbsp;we&nbsp;have&nbsp;called&nbsp;next()&nbsp;at&nbsp;least&nbsp;once)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6376559">s</span><span class="op" id="6376560">.</span><span class="ident" id="6376561">Line</span>&nbsp;<span class="op" id="6376566">=</span>&nbsp;<span class="ident" id="6376568">s</span><span class="op" id="6376569">.</span><span class="ident" id="6376570">line</span>&nbsp;<span class="op" id="6376575">-</span>&nbsp;<span class="num" id="6376577">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6376581">s</span><span class="op" id="6376582">.</span><span class="ident" id="6376583">Column</span>&nbsp;<span class="op" id="6376590">=</span>&nbsp;<span class="ident" id="6376592">s</span><span class="op" id="6376593">.</span><span class="ident" id="6376594">lastLineLen</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6376607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6376611">//&nbsp;determine&nbsp;token&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6376637">tok</span>&nbsp;<span class="op" id="6376641">:=</span>&nbsp;<span class="ident" id="6376644">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6376648">switch</span>&nbsp;<span class="op" id="6376655">{</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6376658">case</span>&nbsp;<span class="ident" id="6376663">s</span><span class="op" id="6376664">.</span><span class="ident" id="6376665">isIdentRune</span><span class="op" id="6376676">(</span><span class="ident" id="6376677">ch</span><span class="op" id="6376679">,</span>&nbsp;<span class="num" id="6376681">0</span><span class="op" id="6376682">)</span><span class="op" id="6376683">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6376687">if</span>&nbsp;<span class="ident" id="6376690">s</span><span class="op" id="6376691">.</span><span class="ident" id="6376692">Mode</span><span class="op" id="6376696">&amp;</span><span class="ident" id="6376697">ScanIdents</span>&nbsp;<span class="op" id="6376708">!=</span>&nbsp;<span class="num" id="6376711">0</span>&nbsp;<span class="op" id="6376713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6376718">tok</span>&nbsp;<span class="op" id="6376722">=</span>&nbsp;<span class="ident" id="6376724">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6376733">ch</span>&nbsp;<span class="op" id="6376736">=</span>&nbsp;<span class="ident" id="6376738">s</span><span class="op" id="6376739">.</span><span class="ident" id="6376740">scanIdentifier</span><span class="op" id="6376754">(</span><span class="op" id="6376755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6376759">}</span>&nbsp;<span class="keyword" id="6376761">else</span>&nbsp;<span class="op" id="6376766">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6376771">ch</span>&nbsp;<span class="op" id="6376774">=</span>&nbsp;<span class="ident" id="6376776">s</span><span class="op" id="6376777">.</span><span class="ident" id="6376778">next</span><span class="op" id="6376782">(</span><span class="op" id="6376783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6376787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6376790">case</span>&nbsp;<span class="ident" id="6376795">isDecimal</span><span class="op" id="6376804">(</span><span class="ident" id="6376805">ch</span><span class="op" id="6376807">)</span><span class="op" id="6376808">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6376812">if</span>&nbsp;<span class="ident" id="6376815">s</span><span class="op" id="6376816">.</span><span class="ident" id="6376817">Mode</span><span class="op" id="6376821">&amp;</span><span class="op" id="6376822">(</span><span class="ident" id="6376823">ScanInts</span><span class="op" id="6376831">|</span><span class="ident" id="6376832">ScanFloats</span><span class="op" id="6376842">)</span>&nbsp;<span class="op" id="6376844">!=</span>&nbsp;<span class="num" id="6376847">0</span>&nbsp;<span class="op" id="6376849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6376854">tok</span><span class="op" id="6376857">,</span>&nbsp;<span class="ident" id="6376859">ch</span>&nbsp;<span class="op" id="6376862">=</span>&nbsp;<span class="ident" id="6376864">s</span><span class="op" id="6376865">.</span><span class="ident" id="6376866">scanNumber</span><span class="op" id="6376876">(</span><span class="ident" id="6376877">ch</span><span class="op" id="6376879">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6376883">}</span>&nbsp;<span class="keyword" id="6376885">else</span>&nbsp;<span class="op" id="6376890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6376895">ch</span>&nbsp;<span class="op" id="6376898">=</span>&nbsp;<span class="ident" id="6376900">s</span><span class="op" id="6376901">.</span><span class="ident" id="6376902">next</span><span class="op" id="6376906">(</span><span class="op" id="6376907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6376911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6376914">default</span><span class="op" id="6376921">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6376925">switch</span>&nbsp;<span class="ident" id="6376932">ch</span>&nbsp;<span class="op" id="6376935">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6376939">case</span>&nbsp;<span class="string" id="6376944">&#39;&#34;&#39;</span><span class="op" id="6376947">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6376952">if</span>&nbsp;<span class="ident" id="6376955">s</span><span class="op" id="6376956">.</span><span class="ident" id="6376957">Mode</span><span class="op" id="6376961">&amp;</span><span class="ident" id="6376962">ScanStrings</span>&nbsp;<span class="op" id="6376974">!=</span>&nbsp;<span class="num" id="6376977">0</span>&nbsp;<span class="op" id="6376979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6376985">s</span><span class="op" id="6376986">.</span><span class="ident" id="6376987">scanString</span><span class="op" id="6376997">(</span><span class="string" id="6376998">&#39;&#34;&#39;</span><span class="op" id="6377001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377007">tok</span>&nbsp;<span class="op" id="6377011">=</span>&nbsp;<span class="ident" id="6377013">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6377023">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377028">ch</span>&nbsp;<span class="op" id="6377031">=</span>&nbsp;<span class="ident" id="6377033">s</span><span class="op" id="6377034">.</span><span class="ident" id="6377035">next</span><span class="op" id="6377039">(</span><span class="op" id="6377040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6377044">case</span>&nbsp;<span class="string" id="6377049">&#39;\&#39;&#39;</span><span class="op" id="6377053">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6377058">if</span>&nbsp;<span class="ident" id="6377061">s</span><span class="op" id="6377062">.</span><span class="ident" id="6377063">Mode</span><span class="op" id="6377067">&amp;</span><span class="ident" id="6377068">ScanChars</span>&nbsp;<span class="op" id="6377078">!=</span>&nbsp;<span class="num" id="6377081">0</span>&nbsp;<span class="op" id="6377083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377089">s</span><span class="op" id="6377090">.</span><span class="ident" id="6377091">scanChar</span><span class="op" id="6377099">(</span><span class="op" id="6377100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377106">tok</span>&nbsp;<span class="op" id="6377110">=</span>&nbsp;<span class="ident" id="6377112">Char</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6377120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377125">ch</span>&nbsp;<span class="op" id="6377128">=</span>&nbsp;<span class="ident" id="6377130">s</span><span class="op" id="6377131">.</span><span class="ident" id="6377132">next</span><span class="op" id="6377136">(</span><span class="op" id="6377137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6377141">case</span>&nbsp;<span class="string" id="6377146">&#39;.&#39;</span><span class="op" id="6377149">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377154">ch</span>&nbsp;<span class="op" id="6377157">=</span>&nbsp;<span class="ident" id="6377159">s</span><span class="op" id="6377160">.</span><span class="ident" id="6377161">next</span><span class="op" id="6377165">(</span><span class="op" id="6377166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6377171">if</span>&nbsp;<span class="ident" id="6377174">isDecimal</span><span class="op" id="6377183">(</span><span class="ident" id="6377184">ch</span><span class="op" id="6377186">)</span>&nbsp;<span class="op" id="6377188">&amp;&amp;</span>&nbsp;<span class="ident" id="6377191">s</span><span class="op" id="6377192">.</span><span class="ident" id="6377193">Mode</span><span class="op" id="6377197">&amp;</span><span class="ident" id="6377198">ScanFloats</span>&nbsp;<span class="op" id="6377209">!=</span>&nbsp;<span class="num" id="6377212">0</span>&nbsp;<span class="op" id="6377214">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377220">tok</span>&nbsp;<span class="op" id="6377224">=</span>&nbsp;<span class="ident" id="6377226">Float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377236">ch</span>&nbsp;<span class="op" id="6377239">=</span>&nbsp;<span class="ident" id="6377241">s</span><span class="op" id="6377242">.</span><span class="ident" id="6377243">scanMantissa</span><span class="op" id="6377255">(</span><span class="ident" id="6377256">ch</span><span class="op" id="6377258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377264">ch</span>&nbsp;<span class="op" id="6377267">=</span>&nbsp;<span class="ident" id="6377269">s</span><span class="op" id="6377270">.</span><span class="ident" id="6377271">scanExponent</span><span class="op" id="6377283">(</span><span class="ident" id="6377284">ch</span><span class="op" id="6377286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6377291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6377295">case</span>&nbsp;<span class="string" id="6377300">&#39;/&#39;</span><span class="op" id="6377303">:</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377308">ch</span>&nbsp;<span class="op" id="6377311">=</span>&nbsp;<span class="ident" id="6377313">s</span><span class="op" id="6377314">.</span><span class="ident" id="6377315">next</span><span class="op" id="6377319">(</span><span class="op" id="6377320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6377325">if</span>&nbsp;<span class="op" id="6377328">(</span><span class="ident" id="6377329">ch</span>&nbsp;<span class="op" id="6377332">==</span>&nbsp;<span class="string" id="6377335">&#39;/&#39;</span>&nbsp;<span class="op" id="6377339">||</span>&nbsp;<span class="ident" id="6377342">ch</span>&nbsp;<span class="op" id="6377345">==</span>&nbsp;<span class="string" id="6377348">&#39;*&#39;</span><span class="op" id="6377351">)</span>&nbsp;<span class="op" id="6377353">&amp;&amp;</span>&nbsp;<span class="ident" id="6377356">s</span><span class="op" id="6377357">.</span><span class="ident" id="6377358">Mode</span><span class="op" id="6377362">&amp;</span><span class="ident" id="6377363">ScanComments</span>&nbsp;<span class="op" id="6377376">!=</span>&nbsp;<span class="num" id="6377379">0</span>&nbsp;<span class="op" id="6377381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6377387">if</span>&nbsp;<span class="ident" id="6377390">s</span><span class="op" id="6377391">.</span><span class="ident" id="6377392">Mode</span><span class="op" id="6377396">&amp;</span><span class="ident" id="6377397">SkipComments</span>&nbsp;<span class="op" id="6377410">!=</span>&nbsp;<span class="num" id="6377413">0</span>&nbsp;<span class="op" id="6377415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377422">s</span><span class="op" id="6377423">.</span><span class="ident" id="6377424">tokPos</span>&nbsp;<span class="op" id="6377431">=</span>&nbsp;<span class="op" id="6377433">-</span><span class="num" id="6377434">1</span>&nbsp;<span class="comment" id="6377436">//&nbsp;don&#39;t&nbsp;collect&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377469">ch</span>&nbsp;<span class="op" id="6377472">=</span>&nbsp;<span class="ident" id="6377474">s</span><span class="op" id="6377475">.</span><span class="ident" id="6377476">scanComment</span><span class="op" id="6377487">(</span><span class="ident" id="6377488">ch</span><span class="op" id="6377490">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6377497">goto</span>&nbsp;<span class="ident" id="6377502">redo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6377511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377517">ch</span>&nbsp;<span class="op" id="6377520">=</span>&nbsp;<span class="ident" id="6377522">s</span><span class="op" id="6377523">.</span><span class="ident" id="6377524">scanComment</span><span class="op" id="6377535">(</span><span class="ident" id="6377536">ch</span><span class="op" id="6377538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377544">tok</span>&nbsp;<span class="op" id="6377548">=</span>&nbsp;<span class="ident" id="6377550">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6377561">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6377565">case</span>&nbsp;<span class="string" id="6377570">&#39;`&#39;</span><span class="op" id="6377573">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6377578">if</span>&nbsp;<span class="ident" id="6377581">s</span><span class="op" id="6377582">.</span><span class="ident" id="6377583">Mode</span><span class="op" id="6377587">&amp;</span><span class="ident" id="6377588">ScanRawStrings</span>&nbsp;<span class="op" id="6377603">!=</span>&nbsp;<span class="num" id="6377606">0</span>&nbsp;<span class="op" id="6377608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377614">s</span><span class="op" id="6377615">.</span><span class="ident" id="6377616">scanRawString</span><span class="op" id="6377629">(</span><span class="op" id="6377630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377636">tok</span>&nbsp;<span class="op" id="6377640">=</span>&nbsp;<span class="ident" id="6377642">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6377652">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377657">ch</span>&nbsp;<span class="op" id="6377660">=</span>&nbsp;<span class="ident" id="6377662">s</span><span class="op" id="6377663">.</span><span class="ident" id="6377664">next</span><span class="op" id="6377668">(</span><span class="op" id="6377669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6377673">default</span><span class="op" id="6377680">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377685">ch</span>&nbsp;<span class="op" id="6377688">=</span>&nbsp;<span class="ident" id="6377690">s</span><span class="op" id="6377691">.</span><span class="ident" id="6377692">next</span><span class="op" id="6377696">(</span><span class="op" id="6377697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6377701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6377704">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6377708">//&nbsp;end&nbsp;of&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377730">s</span><span class="op" id="6377731">.</span><span class="ident" id="6377732">tokEnd</span>&nbsp;<span class="op" id="6377739">=</span>&nbsp;<span class="ident" id="6377741">s</span><span class="op" id="6377742">.</span><span class="ident" id="6377743">srcPos</span>&nbsp;<span class="op" id="6377750">-</span>&nbsp;<span class="ident" id="6377752">s</span><span class="op" id="6377753">.</span><span class="ident" id="6377754">lastCharLen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377768">s</span><span class="op" id="6377769">.</span><span class="ident" id="6377770">ch</span>&nbsp;<span class="op" id="6377773">=</span>&nbsp;<span class="ident" id="6377775">ch</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6377779">return</span>&nbsp;<span class="ident" id="6377786">tok</span><br>
<span class="lineno"></span><span class="op" id="6377790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6377793">//&nbsp;Pos&nbsp;returns&nbsp;the&nbsp;position&nbsp;of&nbsp;the&nbsp;character&nbsp;immediately&nbsp;after</span><br>
<span class="lineno"></span><span class="comment" id="6377856">//&nbsp;the&nbsp;character&nbsp;or&nbsp;token&nbsp;returned&nbsp;by&nbsp;the&nbsp;last&nbsp;call&nbsp;to&nbsp;Next&nbsp;or&nbsp;Scan.</span><br>
<span class="lineno">650</span><span class="keyword" id="6377925">func</span>&nbsp;<span class="op" id="6377930">(</span><span class="ident" id="6377931">s</span>&nbsp;<span class="op" id="6377933">*</span><span class="ident" id="6377934">Scanner</span><span class="op" id="6377941">)</span>&nbsp;<span class="ident" id="6377943">Pos</span><span class="op" id="6377946">(</span><span class="op" id="6377947">)</span>&nbsp;<span class="op" id="6377949">(</span><span class="ident" id="6377950">pos</span>&nbsp;<span class="ident" id="6377954">Position</span><span class="op" id="6377962">)</span>&nbsp;<span class="op" id="6377964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377967">pos</span><span class="op" id="6377970">.</span><span class="ident" id="6377971">Filename</span>&nbsp;<span class="op" id="6377980">=</span>&nbsp;<span class="ident" id="6377982">s</span><span class="op" id="6377983">.</span><span class="ident" id="6377984">Filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377994">pos</span><span class="op" id="6377997">.</span><span class="ident" id="6377998">Offset</span>&nbsp;<span class="op" id="6378005">=</span>&nbsp;<span class="ident" id="6378007">s</span><span class="op" id="6378008">.</span><span class="ident" id="6378009">srcBufOffset</span>&nbsp;<span class="op" id="6378022">+</span>&nbsp;<span class="ident" id="6378024">s</span><span class="op" id="6378025">.</span><span class="ident" id="6378026">srcPos</span>&nbsp;<span class="op" id="6378033">-</span>&nbsp;<span class="ident" id="6378035">s</span><span class="op" id="6378036">.</span><span class="ident" id="6378037">lastCharLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6378050">switch</span>&nbsp;<span class="op" id="6378057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6378060">case</span>&nbsp;<span class="ident" id="6378065">s</span><span class="op" id="6378066">.</span><span class="ident" id="6378067">column</span>&nbsp;<span class="op" id="6378074">&gt;</span>&nbsp;<span class="num" id="6378076">0</span><span class="op" id="6378077">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6378081">//&nbsp;common&nbsp;case:&nbsp;last&nbsp;character&nbsp;was&nbsp;not&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6378129">pos</span><span class="op" id="6378132">.</span><span class="ident" id="6378133">Line</span>&nbsp;<span class="op" id="6378138">=</span>&nbsp;<span class="ident" id="6378140">s</span><span class="op" id="6378141">.</span><span class="ident" id="6378142">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6378149">pos</span><span class="op" id="6378152">.</span><span class="ident" id="6378153">Column</span>&nbsp;<span class="op" id="6378160">=</span>&nbsp;<span class="ident" id="6378162">s</span><span class="op" id="6378163">.</span><span class="ident" id="6378164">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6378172">case</span>&nbsp;<span class="ident" id="6378177">s</span><span class="op" id="6378178">.</span><span class="ident" id="6378179">lastLineLen</span>&nbsp;<span class="op" id="6378191">&gt;</span>&nbsp;<span class="num" id="6378193">0</span><span class="op" id="6378194">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6378198">//&nbsp;last&nbsp;character&nbsp;was&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6378229">pos</span><span class="op" id="6378232">.</span><span class="ident" id="6378233">Line</span>&nbsp;<span class="op" id="6378238">=</span>&nbsp;<span class="ident" id="6378240">s</span><span class="op" id="6378241">.</span><span class="ident" id="6378242">line</span>&nbsp;<span class="op" id="6378247">-</span>&nbsp;<span class="num" id="6378249">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6378253">pos</span><span class="op" id="6378256">.</span><span class="ident" id="6378257">Column</span>&nbsp;<span class="op" id="6378264">=</span>&nbsp;<span class="ident" id="6378266">s</span><span class="op" id="6378267">.</span><span class="ident" id="6378268">lastLineLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6378281">default</span><span class="op" id="6378288">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6378292">//&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6378328">pos</span><span class="op" id="6378331">.</span><span class="ident" id="6378332">Line</span>&nbsp;<span class="op" id="6378337">=</span>&nbsp;<span class="num" id="6378339">1</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6378343">pos</span><span class="op" id="6378346">.</span><span class="ident" id="6378347">Column</span>&nbsp;<span class="op" id="6378354">=</span>&nbsp;<span class="num" id="6378356">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6378359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6378362">return</span><br>
<span class="lineno"></span><span class="op" id="6378369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="comment" id="6378372">//&nbsp;TokenText&nbsp;returns&nbsp;the&nbsp;string&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;most&nbsp;recently&nbsp;scanned&nbsp;token.</span><br>
<span class="lineno"></span><span class="comment" id="6378454">//&nbsp;Valid&nbsp;after&nbsp;calling&nbsp;Scan().</span><br>
<span class="lineno"></span><span class="keyword" id="6378485">func</span>&nbsp;<span class="op" id="6378490">(</span><span class="ident" id="6378491">s</span>&nbsp;<span class="op" id="6378493">*</span><span class="ident" id="6378494">Scanner</span><span class="op" id="6378501">)</span>&nbsp;<span class="ident" id="6378503">TokenText</span><span class="op" id="6378512">(</span><span class="op" id="6378513">)</span>&nbsp;<span class="builtintype" id="6378515">string</span>&nbsp;<span class="op" id="6378522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6378525">if</span>&nbsp;<span class="ident" id="6378528">s</span><span class="op" id="6378529">.</span><span class="ident" id="6378530">tokPos</span>&nbsp;<span class="op" id="6378537">&lt;</span>&nbsp;<span class="num" id="6378539">0</span>&nbsp;<span class="op" id="6378541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6378545">//&nbsp;no&nbsp;token&nbsp;text</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6378564">return</span>&nbsp;<span class="string" id="6378571">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6378575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6378579">if</span>&nbsp;<span class="ident" id="6378582">s</span><span class="op" id="6378583">.</span><span class="ident" id="6378584">tokEnd</span>&nbsp;<span class="op" id="6378591">&lt;</span>&nbsp;<span class="num" id="6378593">0</span>&nbsp;<span class="op" id="6378595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6378599">//&nbsp;if&nbsp;EOF&nbsp;was&nbsp;reached,&nbsp;s.tokEnd&nbsp;is&nbsp;set&nbsp;to&nbsp;-1&nbsp;(s.srcPos&nbsp;==&nbsp;0)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6378662">s</span><span class="op" id="6378663">.</span><span class="ident" id="6378664">tokEnd</span>&nbsp;<span class="op" id="6378671">=</span>&nbsp;<span class="ident" id="6378673">s</span><span class="op" id="6378674">.</span><span class="ident" id="6378675">tokPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6378683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6378687">if</span>&nbsp;<span class="ident" id="6378690">s</span><span class="op" id="6378691">.</span><span class="ident" id="6378692">tokBuf</span><span class="op" id="6378698">.</span><span class="ident" id="6378699">Len</span><span class="op" id="6378702">(</span><span class="op" id="6378703">)</span>&nbsp;<span class="op" id="6378705">==</span>&nbsp;<span class="num" id="6378708">0</span>&nbsp;<span class="op" id="6378710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6378714">//&nbsp;common&nbsp;case:&nbsp;the&nbsp;entire&nbsp;token&nbsp;text&nbsp;is&nbsp;still&nbsp;in&nbsp;srcBuf</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6378773">return</span>&nbsp;<span class="builtintype" id="6378780">string</span><span class="op" id="6378786">(</span><span class="ident" id="6378787">s</span><span class="op" id="6378788">.</span><span class="ident" id="6378789">srcBuf</span><span class="op" id="6378795">[</span><span class="ident" id="6378796">s</span><span class="op" id="6378797">.</span><span class="ident" id="6378798">tokPos</span><span class="op" id="6378804">:</span><span class="ident" id="6378805">s</span><span class="op" id="6378806">.</span><span class="ident" id="6378807">tokEnd</span><span class="op" id="6378813">]</span><span class="op" id="6378814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6378817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6378821">//&nbsp;part&nbsp;of&nbsp;the&nbsp;token&nbsp;text&nbsp;was&nbsp;saved&nbsp;in&nbsp;tokBuf:&nbsp;save&nbsp;the&nbsp;rest&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6378886">//&nbsp;tokBuf&nbsp;as&nbsp;well&nbsp;and&nbsp;return&nbsp;its&nbsp;content</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6378928">s</span><span class="op" id="6378929">.</span><span class="ident" id="6378930">tokBuf</span><span class="op" id="6378936">.</span><span class="ident" id="6378937">Write</span><span class="op" id="6378942">(</span><span class="ident" id="6378943">s</span><span class="op" id="6378944">.</span><span class="ident" id="6378945">srcBuf</span><span class="op" id="6378951">[</span><span class="ident" id="6378952">s</span><span class="op" id="6378953">.</span><span class="ident" id="6378954">tokPos</span><span class="op" id="6378960">:</span><span class="ident" id="6378961">s</span><span class="op" id="6378962">.</span><span class="ident" id="6378963">tokEnd</span><span class="op" id="6378969">]</span><span class="op" id="6378970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6378973">s</span><span class="op" id="6378974">.</span><span class="ident" id="6378975">tokPos</span>&nbsp;<span class="op" id="6378982">=</span>&nbsp;<span class="ident" id="6378984">s</span><span class="op" id="6378985">.</span><span class="ident" id="6378986">tokEnd</span>&nbsp;<span class="comment" id="6378993">//&nbsp;ensure&nbsp;idempotency&nbsp;of&nbsp;TokenText()&nbsp;call</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6379036">return</span>&nbsp;<span class="ident" id="6379043">s</span><span class="op" id="6379044">.</span><span class="ident" id="6379045">tokBuf</span><span class="op" id="6379051">.</span><span class="ident" id="6379052">String</span><span class="op" id="6379058">(</span><span class="op" id="6379059">)</span><br>
<span class="lineno"></span><span class="op" id="6379061">}</span>
</div>
</body>
</html>
