<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3395453">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3395509">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3395563">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3395614">package</span>&nbsp;<span class="ident" id="3395622">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3395627">import</span>&nbsp;<span class="op" id="3395634">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3395637">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3395643">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3395653">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3395656">func</span>&nbsp;<span class="ident" id="3395661">setIPv4MulticastInterface</span><span class="op" id="3395686">(</span><span class="ident" id="3395687">fd</span>&nbsp;<span class="op" id="3395690">*</span><span class="ident" id="3395691">netFD</span><span class="op" id="3395696">,</span>&nbsp;<span class="ident" id="3395698">ifi</span>&nbsp;<span class="op" id="3395702">*</span><span class="ident" id="3395703">Interface</span><span class="op" id="3395712">)</span>&nbsp;<span class="builtintype" id="3395714">error</span>&nbsp;<span class="op" id="3395720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3395723">var</span>&nbsp;<span class="ident" id="3395727">v</span>&nbsp;<span class="builtintype" id="3395729">int32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3395736">if</span>&nbsp;<span class="ident" id="3395739">ifi</span>&nbsp;<span class="op" id="3395743">!=</span>&nbsp;<span class="ident" id="3395746">nil</span>&nbsp;<span class="op" id="3395750">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3395754">v</span>&nbsp;<span class="op" id="3395756">=</span>&nbsp;<span class="builtintype" id="3395758">int32</span><span class="op" id="3395763">(</span><span class="ident" id="3395764">ifi</span><span class="op" id="3395767">.</span><span class="ident" id="3395768">Index</span><span class="op" id="3395773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3395776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3395779">mreq</span>&nbsp;<span class="op" id="3395784">:=</span>&nbsp;<span class="op" id="3395787">&amp;</span><span class="ident" id="3395788">syscall</span><span class="op" id="3395795">.</span><span class="ident" id="3395796">IPMreqn</span><span class="op" id="3395803">{</span><span class="ident" id="3395804">Ifindex</span><span class="op" id="3395811">:</span>&nbsp;<span class="ident" id="3395813">v</span><span class="op" id="3395814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3395817">if</span>&nbsp;<span class="ident" id="3395820">err</span>&nbsp;<span class="op" id="3395824">:=</span>&nbsp;<span class="ident" id="3395827">fd</span><span class="op" id="3395829">.</span><span class="ident" id="3395830">incref</span><span class="op" id="3395836">(</span><span class="op" id="3395837">)</span><span class="op" id="3395838">;</span>&nbsp;<span class="ident" id="3395840">err</span>&nbsp;<span class="op" id="3395844">!=</span>&nbsp;<span class="ident" id="3395847">nil</span>&nbsp;<span class="op" id="3395851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3395855">return</span>&nbsp;<span class="ident" id="3395862">err</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3395867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3395870">defer</span>&nbsp;<span class="ident" id="3395876">fd</span><span class="op" id="3395878">.</span><span class="ident" id="3395879">decref</span><span class="op" id="3395885">(</span><span class="op" id="3395886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3395889">return</span>&nbsp;<span class="ident" id="3395896">os</span><span class="op" id="3395898">.</span><span class="ident" id="3395899">NewSyscallError</span><span class="op" id="3395914">(</span><span class="string" id="3395915">&#34;setsockopt&#34;</span><span class="op" id="3395927">,</span>&nbsp;<span class="ident" id="3395929">syscall</span><span class="op" id="3395936">.</span><span class="ident" id="3395937">SetsockoptIPMreqn</span><span class="op" id="3395954">(</span><span class="ident" id="3395955">fd</span><span class="op" id="3395957">.</span><span class="ident" id="3395958">sysfd</span><span class="op" id="3395963">,</span>&nbsp;<span class="ident" id="3395965">syscall</span><span class="op" id="3395972">.</span><span class="ident" id="3395973">IPPROTO_IP</span><span class="op" id="3395983">,</span>&nbsp;<span class="ident" id="3395985">syscall</span><span class="op" id="3395992">.</span><span class="ident" id="3395993">IP_MULTICAST_IF</span><span class="op" id="3396008">,</span>&nbsp;<span class="ident" id="3396010">mreq</span><span class="op" id="3396014">)</span><span class="op" id="3396015">)</span><br>
<span class="lineno"></span><span class="op" id="3396017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="3396020">func</span>&nbsp;<span class="ident" id="3396025">setIPv4MulticastLoopback</span><span class="op" id="3396049">(</span><span class="ident" id="3396050">fd</span>&nbsp;<span class="op" id="3396053">*</span><span class="ident" id="3396054">netFD</span><span class="op" id="3396059">,</span>&nbsp;<span class="ident" id="3396061">v</span>&nbsp;<span class="builtintype" id="3396063">bool</span><span class="op" id="3396067">)</span>&nbsp;<span class="builtintype" id="3396069">error</span>&nbsp;<span class="op" id="3396075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3396078">if</span>&nbsp;<span class="ident" id="3396081">err</span>&nbsp;<span class="op" id="3396085">:=</span>&nbsp;<span class="ident" id="3396088">fd</span><span class="op" id="3396090">.</span><span class="ident" id="3396091">incref</span><span class="op" id="3396097">(</span><span class="op" id="3396098">)</span><span class="op" id="3396099">;</span>&nbsp;<span class="ident" id="3396101">err</span>&nbsp;<span class="op" id="3396105">!=</span>&nbsp;<span class="ident" id="3396108">nil</span>&nbsp;<span class="op" id="3396112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3396116">return</span>&nbsp;<span class="ident" id="3396123">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3396128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3396131">defer</span>&nbsp;<span class="ident" id="3396137">fd</span><span class="op" id="3396139">.</span><span class="ident" id="3396140">decref</span><span class="op" id="3396146">(</span><span class="op" id="3396147">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3396150">return</span>&nbsp;<span class="ident" id="3396157">os</span><span class="op" id="3396159">.</span><span class="ident" id="3396160">NewSyscallError</span><span class="op" id="3396175">(</span><span class="string" id="3396176">&#34;setsockopt&#34;</span><span class="op" id="3396188">,</span>&nbsp;<span class="ident" id="3396190">syscall</span><span class="op" id="3396197">.</span><span class="ident" id="3396198">SetsockoptInt</span><span class="op" id="3396211">(</span><span class="ident" id="3396212">fd</span><span class="op" id="3396214">.</span><span class="ident" id="3396215">sysfd</span><span class="op" id="3396220">,</span>&nbsp;<span class="ident" id="3396222">syscall</span><span class="op" id="3396229">.</span><span class="ident" id="3396230">IPPROTO_IP</span><span class="op" id="3396240">,</span>&nbsp;<span class="ident" id="3396242">syscall</span><span class="op" id="3396249">.</span><span class="ident" id="3396250">IP_MULTICAST_LOOP</span><span class="op" id="3396267">,</span>&nbsp;<span class="ident" id="3396269">boolint</span><span class="op" id="3396276">(</span><span class="ident" id="3396277">v</span><span class="op" id="3396278">)</span><span class="op" id="3396279">)</span><span class="op" id="3396280">)</span><br>
<span class="lineno"></span><span class="op" id="3396282">}</span>
</div>
</body>
</html>
