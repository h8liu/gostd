<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/json</h2>
<ul>
<li><a href="/gostd/encoding/json/bench_test.go.html">bench_test.go</a></li>
<li><a href="/gostd/encoding/json/decode.go.html">decode.go</a></li>
<li><a href="/gostd/encoding/json/decode_test.go.html">decode_test.go</a></li>
<li><a href="/gostd/encoding/json/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/json/encode_test.go.html">encode_test.go</a></li>
<li><a href="/gostd/encoding/json/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/json/fold.go.html">fold.go</a></li>
<li><a href="/gostd/encoding/json/fold_test.go.html">fold_test.go</a></li>
<li><a href="/gostd/encoding/json/indent.go.html">indent.go</a></li>
<li><a href="/gostd/encoding/json/scanner.go.html" class="current">scanner.go</a></li>
<li><a href="/gostd/encoding/json/scanner_test.go.html">scanner_test.go</a></li>
<li><a href="/gostd/encoding/json/stream.go.html">stream.go</a></li>
<li><a href="/gostd/encoding/json/stream_test.go.html">stream_test.go</a></li>
<li><a href="/gostd/encoding/json/tagkey_test.go.html">tagkey_test.go</a></li>
<li><a href="/gostd/encoding/json/tags.go.html">tags.go</a></li>
<li><a href="/gostd/encoding/json/tags_test.go.html">tags_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5292189">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5292245">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5292299">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5292350">package</span>&nbsp;<span class="ident" id="5292358">json</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5292364">//&nbsp;JSON&nbsp;value&nbsp;parser&nbsp;state&nbsp;machine.</span><br>
<span class="lineno"></span><span class="comment" id="5292400">//&nbsp;Just&nbsp;about&nbsp;at&nbsp;the&nbsp;limit&nbsp;of&nbsp;what&nbsp;is&nbsp;reasonable&nbsp;to&nbsp;write&nbsp;by&nbsp;hand.</span><br>
<span class="lineno"></span><span class="comment" id="5292467">//&nbsp;Some&nbsp;parts&nbsp;are&nbsp;a&nbsp;bit&nbsp;tedious,&nbsp;but&nbsp;overall&nbsp;it&nbsp;nicely&nbsp;factors&nbsp;out&nbsp;the</span><br>
<span class="lineno">10</span><span class="comment" id="5292538">//&nbsp;otherwise&nbsp;common&nbsp;code&nbsp;from&nbsp;the&nbsp;multiple&nbsp;scanning&nbsp;functions</span><br>
<span class="lineno"></span><span class="comment" id="5292600">//&nbsp;in&nbsp;this&nbsp;package&nbsp;(Compact,&nbsp;Indent,&nbsp;checkValid,&nbsp;nextValue,&nbsp;etc).</span><br>
<span class="lineno"></span><span class="comment" id="5292666">//</span><br>
<span class="lineno"></span><span class="comment" id="5292669">//&nbsp;This&nbsp;file&nbsp;starts&nbsp;with&nbsp;two&nbsp;simple&nbsp;examples&nbsp;using&nbsp;the&nbsp;scanner</span><br>
<span class="lineno"></span><span class="comment" id="5292732">//&nbsp;before&nbsp;diving&nbsp;into&nbsp;the&nbsp;scanner&nbsp;itself.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="5292775">import</span>&nbsp;<span class="string" id="5292782">&#34;strconv&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5292793">//&nbsp;checkValid&nbsp;verifies&nbsp;that&nbsp;data&nbsp;is&nbsp;valid&nbsp;JSON-encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="5292854">//&nbsp;scan&nbsp;is&nbsp;passed&nbsp;in&nbsp;for&nbsp;use&nbsp;by&nbsp;checkValid&nbsp;to&nbsp;avoid&nbsp;an&nbsp;allocation.</span><br>
<span class="lineno">20</span><span class="keyword" id="5292921">func</span>&nbsp;<span class="ident" id="5292926">checkValid</span><span class="op" id="5292936">(</span><span class="ident" id="5292937">data</span>&nbsp;<span class="op" id="5292942">[</span><span class="op" id="5292943">]</span><span class="builtintype" id="5292944">byte</span><span class="op" id="5292948">,</span>&nbsp;<span class="ident" id="5292950">scan</span>&nbsp;<span class="op" id="5292955">*</span><span class="ident" id="5292956">scanner</span><span class="op" id="5292963">)</span>&nbsp;<span class="builtintype" id="5292965">error</span>&nbsp;<span class="op" id="5292971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5292974">scan</span><span class="op" id="5292978">.</span><span class="ident" id="5292979">reset</span><span class="op" id="5292984">(</span><span class="op" id="5292985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5292988">for</span>&nbsp;<span class="ident" id="5292992">_</span><span class="op" id="5292993">,</span>&nbsp;<span class="ident" id="5292995">c</span>&nbsp;<span class="op" id="5292997">:=</span>&nbsp;<span class="keyword" id="5293000">range</span>&nbsp;<span class="ident" id="5293006">data</span>&nbsp;<span class="op" id="5293011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5293015">scan</span><span class="op" id="5293019">.</span><span class="ident" id="5293020">bytes</span><span class="op" id="5293025">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5293030">if</span>&nbsp;<span class="ident" id="5293033">scan</span><span class="op" id="5293037">.</span><span class="ident" id="5293038">step</span><span class="op" id="5293042">(</span><span class="ident" id="5293043">scan</span><span class="op" id="5293047">,</span>&nbsp;<span class="builtintype" id="5293049">int</span><span class="op" id="5293052">(</span><span class="ident" id="5293053">c</span><span class="op" id="5293054">)</span><span class="op" id="5293055">)</span>&nbsp;<span class="op" id="5293057">==</span>&nbsp;<span class="ident" id="5293060">scanError</span>&nbsp;<span class="op" id="5293070">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5293075">return</span>&nbsp;<span class="ident" id="5293082">scan</span><span class="op" id="5293086">.</span><span class="ident" id="5293087">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5293093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5293096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5293099">if</span>&nbsp;<span class="ident" id="5293102">scan</span><span class="op" id="5293106">.</span><span class="ident" id="5293107">eof</span><span class="op" id="5293110">(</span><span class="op" id="5293111">)</span>&nbsp;<span class="op" id="5293113">==</span>&nbsp;<span class="ident" id="5293116">scanError</span>&nbsp;<span class="op" id="5293126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5293130">return</span>&nbsp;<span class="ident" id="5293137">scan</span><span class="op" id="5293141">.</span><span class="ident" id="5293142">err</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5293147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5293150">return</span>&nbsp;<span class="ident" id="5293157">nil</span><br>
<span class="lineno"></span><span class="op" id="5293161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5293164">//&nbsp;nextValue&nbsp;splits&nbsp;data&nbsp;after&nbsp;the&nbsp;next&nbsp;whole&nbsp;JSON&nbsp;value,</span><br>
<span class="lineno">35</span><span class="comment" id="5293222">//&nbsp;returning&nbsp;that&nbsp;value&nbsp;and&nbsp;the&nbsp;bytes&nbsp;that&nbsp;follow&nbsp;it&nbsp;as&nbsp;separate&nbsp;slices.</span><br>
<span class="lineno"></span><span class="comment" id="5293295">//&nbsp;scan&nbsp;is&nbsp;passed&nbsp;in&nbsp;for&nbsp;use&nbsp;by&nbsp;nextValue&nbsp;to&nbsp;avoid&nbsp;an&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="5293361">func</span>&nbsp;<span class="ident" id="5293366">nextValue</span><span class="op" id="5293375">(</span><span class="ident" id="5293376">data</span>&nbsp;<span class="op" id="5293381">[</span><span class="op" id="5293382">]</span><span class="builtintype" id="5293383">byte</span><span class="op" id="5293387">,</span>&nbsp;<span class="ident" id="5293389">scan</span>&nbsp;<span class="op" id="5293394">*</span><span class="ident" id="5293395">scanner</span><span class="op" id="5293402">)</span>&nbsp;<span class="op" id="5293404">(</span><span class="ident" id="5293405">value</span><span class="op" id="5293410">,</span>&nbsp;<span class="ident" id="5293412">rest</span>&nbsp;<span class="op" id="5293417">[</span><span class="op" id="5293418">]</span><span class="builtintype" id="5293419">byte</span><span class="op" id="5293423">,</span>&nbsp;<span class="ident" id="5293425">err</span>&nbsp;<span class="builtintype" id="5293429">error</span><span class="op" id="5293434">)</span>&nbsp;<span class="op" id="5293436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5293439">scan</span><span class="op" id="5293443">.</span><span class="ident" id="5293444">reset</span><span class="op" id="5293449">(</span><span class="op" id="5293450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5293453">for</span>&nbsp;<span class="ident" id="5293457">i</span><span class="op" id="5293458">,</span>&nbsp;<span class="ident" id="5293460">c</span>&nbsp;<span class="op" id="5293462">:=</span>&nbsp;<span class="keyword" id="5293465">range</span>&nbsp;<span class="ident" id="5293471">data</span>&nbsp;<span class="op" id="5293476">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5293480">v</span>&nbsp;<span class="op" id="5293482">:=</span>&nbsp;<span class="ident" id="5293485">scan</span><span class="op" id="5293489">.</span><span class="ident" id="5293490">step</span><span class="op" id="5293494">(</span><span class="ident" id="5293495">scan</span><span class="op" id="5293499">,</span>&nbsp;<span class="builtintype" id="5293501">int</span><span class="op" id="5293504">(</span><span class="ident" id="5293505">c</span><span class="op" id="5293506">)</span><span class="op" id="5293507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5293511">if</span>&nbsp;<span class="ident" id="5293514">v</span>&nbsp;<span class="op" id="5293516">&gt;=</span>&nbsp;<span class="ident" id="5293519">scanEnd</span>&nbsp;<span class="op" id="5293527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5293532">switch</span>&nbsp;<span class="ident" id="5293539">v</span>&nbsp;<span class="op" id="5293541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5293546">case</span>&nbsp;<span class="ident" id="5293551">scanError</span><span class="op" id="5293560">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5293566">return</span>&nbsp;<span class="ident" id="5293573">nil</span><span class="op" id="5293576">,</span>&nbsp;<span class="ident" id="5293578">nil</span><span class="op" id="5293581">,</span>&nbsp;<span class="ident" id="5293583">scan</span><span class="op" id="5293587">.</span><span class="ident" id="5293588">err</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5293595">case</span>&nbsp;<span class="ident" id="5293600">scanEnd</span><span class="op" id="5293607">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5293613">return</span>&nbsp;<span class="ident" id="5293620">data</span><span class="op" id="5293624">[</span><span class="num" id="5293625">0</span><span class="op" id="5293626">:</span><span class="ident" id="5293627">i</span><span class="op" id="5293628">]</span><span class="op" id="5293629">,</span>&nbsp;<span class="ident" id="5293631">data</span><span class="op" id="5293635">[</span><span class="ident" id="5293636">i</span><span class="op" id="5293637">:</span><span class="op" id="5293638">]</span><span class="op" id="5293639">,</span>&nbsp;<span class="ident" id="5293641">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5293648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5293652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5293655">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5293658">if</span>&nbsp;<span class="ident" id="5293661">scan</span><span class="op" id="5293665">.</span><span class="ident" id="5293666">eof</span><span class="op" id="5293669">(</span><span class="op" id="5293670">)</span>&nbsp;<span class="op" id="5293672">==</span>&nbsp;<span class="ident" id="5293675">scanError</span>&nbsp;<span class="op" id="5293685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5293689">return</span>&nbsp;<span class="ident" id="5293696">nil</span><span class="op" id="5293699">,</span>&nbsp;<span class="ident" id="5293701">nil</span><span class="op" id="5293704">,</span>&nbsp;<span class="ident" id="5293706">scan</span><span class="op" id="5293710">.</span><span class="ident" id="5293711">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5293716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5293719">return</span>&nbsp;<span class="ident" id="5293726">data</span><span class="op" id="5293730">,</span>&nbsp;<span class="ident" id="5293732">nil</span><span class="op" id="5293735">,</span>&nbsp;<span class="ident" id="5293737">nil</span><br>
<span class="lineno"></span><span class="op" id="5293741">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="5293744">//&nbsp;A&nbsp;SyntaxError&nbsp;is&nbsp;a&nbsp;description&nbsp;of&nbsp;a&nbsp;JSON&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5293802">type</span>&nbsp;<span class="ident" id="5293807">SyntaxError</span>&nbsp;<span class="keyword" id="5293819">struct</span>&nbsp;<span class="op" id="5293826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5293829">msg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5293836">string</span>&nbsp;<span class="comment" id="5293843">//&nbsp;description&nbsp;of&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5293868">Offset</span>&nbsp;<span class="ident" id="5293875">int64</span>&nbsp;&nbsp;<span class="comment" id="5293882">//&nbsp;error&nbsp;occurred&nbsp;after&nbsp;reading&nbsp;Offset&nbsp;bytes</span><br>
<span class="lineno">60</span><span class="op" id="5293927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5293930">func</span>&nbsp;<span class="op" id="5293935">(</span><span class="ident" id="5293936">e</span>&nbsp;<span class="op" id="5293938">*</span><span class="ident" id="5293939">SyntaxError</span><span class="op" id="5293950">)</span>&nbsp;<span class="ident" id="5293952">Error</span><span class="op" id="5293957">(</span><span class="op" id="5293958">)</span>&nbsp;<span class="builtintype" id="5293960">string</span>&nbsp;<span class="op" id="5293967">{</span>&nbsp;<span class="keyword" id="5293969">return</span>&nbsp;<span class="ident" id="5293976">e</span><span class="op" id="5293977">.</span><span class="ident" id="5293978">msg</span>&nbsp;<span class="op" id="5293982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5293985">//&nbsp;A&nbsp;scanner&nbsp;is&nbsp;a&nbsp;JSON&nbsp;scanning&nbsp;state&nbsp;machine.</span><br>
<span class="lineno">65</span><span class="comment" id="5294032">//&nbsp;Callers&nbsp;call&nbsp;scan.reset()&nbsp;and&nbsp;then&nbsp;pass&nbsp;bytes&nbsp;in&nbsp;one&nbsp;at&nbsp;a&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="5294098">//&nbsp;by&nbsp;calling&nbsp;scan.step(&amp;scan,&nbsp;c)&nbsp;for&nbsp;each&nbsp;byte.</span><br>
<span class="lineno"></span><span class="comment" id="5294147">//&nbsp;The&nbsp;return&nbsp;value,&nbsp;referred&nbsp;to&nbsp;as&nbsp;an&nbsp;opcode,&nbsp;tells&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5294204">//&nbsp;caller&nbsp;about&nbsp;significant&nbsp;parsing&nbsp;events&nbsp;like&nbsp;beginning</span><br>
<span class="lineno"></span><span class="comment" id="5294262">//&nbsp;and&nbsp;ending&nbsp;literals,&nbsp;objects,&nbsp;and&nbsp;arrays,&nbsp;so&nbsp;that&nbsp;the</span><br>
<span class="lineno">70</span><span class="comment" id="5294319">//&nbsp;caller&nbsp;can&nbsp;follow&nbsp;along&nbsp;if&nbsp;it&nbsp;wishes.</span><br>
<span class="lineno"></span><span class="comment" id="5294360">//&nbsp;The&nbsp;return&nbsp;value&nbsp;scanEnd&nbsp;indicates&nbsp;that&nbsp;a&nbsp;single&nbsp;top-level</span><br>
<span class="lineno"></span><span class="comment" id="5294422">//&nbsp;JSON&nbsp;value&nbsp;has&nbsp;been&nbsp;completed,&nbsp;*before*&nbsp;the&nbsp;byte&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5294479">//&nbsp;just&nbsp;got&nbsp;passed&nbsp;in.&nbsp;&nbsp;(The&nbsp;indication&nbsp;must&nbsp;be&nbsp;delayed&nbsp;in&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="5294544">//&nbsp;to&nbsp;recognize&nbsp;the&nbsp;end&nbsp;of&nbsp;numbers:&nbsp;is&nbsp;123&nbsp;a&nbsp;whole&nbsp;value&nbsp;or</span><br>
<span class="lineno">75</span><span class="comment" id="5294604">//&nbsp;the&nbsp;beginning&nbsp;of&nbsp;12345e+6?).</span><br>
<span class="lineno"></span><span class="keyword" id="5294636">type</span>&nbsp;<span class="ident" id="5294641">scanner</span>&nbsp;<span class="keyword" id="5294649">struct</span>&nbsp;<span class="op" id="5294656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5294659">//&nbsp;The&nbsp;step&nbsp;is&nbsp;a&nbsp;func&nbsp;to&nbsp;be&nbsp;called&nbsp;to&nbsp;execute&nbsp;the&nbsp;next&nbsp;transition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5294727">//&nbsp;Also&nbsp;tried&nbsp;using&nbsp;an&nbsp;integer&nbsp;constant&nbsp;and&nbsp;a&nbsp;single&nbsp;func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5294786">//&nbsp;with&nbsp;a&nbsp;switch,&nbsp;but&nbsp;using&nbsp;the&nbsp;func&nbsp;directly&nbsp;was&nbsp;10%&nbsp;faster</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5294848">//&nbsp;on&nbsp;a&nbsp;64-bit&nbsp;Mac&nbsp;Mini,&nbsp;and&nbsp;it&#39;s&nbsp;nicer&nbsp;to&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5294898">step</span>&nbsp;<span class="keyword" id="5294903">func</span><span class="op" id="5294907">(</span><span class="op" id="5294908">*</span><span class="ident" id="5294909">scanner</span><span class="op" id="5294916">,</span>&nbsp;<span class="builtintype" id="5294918">int</span><span class="op" id="5294921">)</span>&nbsp;<span class="builtintype" id="5294923">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5294929">//&nbsp;Reached&nbsp;end&nbsp;of&nbsp;top-level&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5294965">endTop</span>&nbsp;<span class="builtintype" id="5294972">bool</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5294979">//&nbsp;Stack&nbsp;of&nbsp;what&nbsp;we&#39;re&nbsp;in&nbsp;the&nbsp;middle&nbsp;of&nbsp;-&nbsp;array&nbsp;values,&nbsp;object&nbsp;keys,&nbsp;object&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5295064">parseState</span>&nbsp;<span class="op" id="5295075">[</span><span class="op" id="5295076">]</span><span class="builtintype" id="5295077">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5295083">//&nbsp;Error&nbsp;that&nbsp;happened,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5295116">err</span>&nbsp;<span class="builtintype" id="5295120">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5295128">//&nbsp;1-byte&nbsp;redo&nbsp;(see&nbsp;undo&nbsp;method)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5295162">redo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5295172">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5295178">redoCode</span>&nbsp;&nbsp;<span class="builtintype" id="5295188">int</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5295193">redoState</span>&nbsp;<span class="keyword" id="5295203">func</span><span class="op" id="5295207">(</span><span class="op" id="5295208">*</span><span class="ident" id="5295209">scanner</span><span class="op" id="5295216">,</span>&nbsp;<span class="builtintype" id="5295218">int</span><span class="op" id="5295221">)</span>&nbsp;<span class="builtintype" id="5295223">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5295229">//&nbsp;total&nbsp;bytes&nbsp;consumed,&nbsp;updated&nbsp;by&nbsp;decoder.Decode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5295281">bytes</span>&nbsp;<span class="ident" id="5295287">int64</span><br>
<span class="lineno"></span><span class="op" id="5295293">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="5295296">//&nbsp;These&nbsp;values&nbsp;are&nbsp;returned&nbsp;by&nbsp;the&nbsp;state&nbsp;transition&nbsp;functions</span><br>
<span class="lineno"></span><span class="comment" id="5295359">//&nbsp;assigned&nbsp;to&nbsp;scanner.state&nbsp;and&nbsp;the&nbsp;method&nbsp;scanner.eof.</span><br>
<span class="lineno"></span><span class="comment" id="5295416">//&nbsp;They&nbsp;give&nbsp;details&nbsp;about&nbsp;the&nbsp;current&nbsp;state&nbsp;of&nbsp;the&nbsp;scan&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5295478">//&nbsp;callers&nbsp;might&nbsp;be&nbsp;interested&nbsp;to&nbsp;know&nbsp;about.</span><br>
<span class="lineno">105</span><span class="comment" id="5295524">//&nbsp;It&nbsp;is&nbsp;okay&nbsp;to&nbsp;ignore&nbsp;the&nbsp;return&nbsp;value&nbsp;of&nbsp;any&nbsp;particular</span><br>
<span class="lineno"></span><span class="comment" id="5295583">//&nbsp;call&nbsp;to&nbsp;scanner.state:&nbsp;if&nbsp;one&nbsp;call&nbsp;returns&nbsp;scanError,</span><br>
<span class="lineno"></span><span class="comment" id="5295640">//&nbsp;every&nbsp;subsequent&nbsp;call&nbsp;will&nbsp;return&nbsp;scanError&nbsp;too.</span><br>
<span class="lineno"></span><span class="keyword" id="5295692">const</span>&nbsp;<span class="op" id="5295698">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5295701">//&nbsp;Continue.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5295715">scanContinue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5295732">=</span>&nbsp;<span class="ident" id="5295734">iota</span>&nbsp;<span class="comment" id="5295739">//&nbsp;uninteresting&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5295762">scanBeginLiteral</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5295786">//&nbsp;end&nbsp;implied&nbsp;by&nbsp;next&nbsp;result&nbsp;!=&nbsp;scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5295833">scanBeginObject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5295857">//&nbsp;begin&nbsp;object</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5295874">scanObjectKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5295898">//&nbsp;just&nbsp;finished&nbsp;object&nbsp;key&nbsp;(string)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5295936">scanObjectValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5295960">//&nbsp;just&nbsp;finished&nbsp;non-last&nbsp;object&nbsp;value</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5296000">scanEndObject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5296024">//&nbsp;end&nbsp;object&nbsp;(implies&nbsp;scanObjectValue&nbsp;if&nbsp;possible)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5296077">scanBeginArray</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5296101">//&nbsp;begin&nbsp;array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5296117">scanArrayValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5296141">//&nbsp;just&nbsp;finished&nbsp;array&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5296171">scanEndArray</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5296195">//&nbsp;end&nbsp;array&nbsp;(implies&nbsp;scanArrayValue&nbsp;if&nbsp;possible)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5296246">scanSkipSpace</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5296270">//&nbsp;space&nbsp;byte;&nbsp;can&nbsp;skip;&nbsp;known&nbsp;to&nbsp;be&nbsp;last&nbsp;&#34;continue&#34;&nbsp;result</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5296332">//&nbsp;Stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5296342">scanEnd</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5296352">//&nbsp;top-level&nbsp;value&nbsp;ended&nbsp;*before*&nbsp;this&nbsp;byte;&nbsp;known&nbsp;to&nbsp;be&nbsp;first&nbsp;&#34;stop&#34;&nbsp;result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5296430">scanError</span>&nbsp;<span class="comment" id="5296440">//&nbsp;hit&nbsp;an&nbsp;error,&nbsp;scanner.err.</span><br>
<span class="lineno"></span><span class="op" id="5296470">)</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="5296473">//&nbsp;These&nbsp;values&nbsp;are&nbsp;stored&nbsp;in&nbsp;the&nbsp;parseState&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="5296525">//&nbsp;They&nbsp;give&nbsp;the&nbsp;current&nbsp;state&nbsp;of&nbsp;a&nbsp;composite&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="5296577">//&nbsp;being&nbsp;scanned.&nbsp;&nbsp;If&nbsp;the&nbsp;parser&nbsp;is&nbsp;inside&nbsp;a&nbsp;nested&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="5296635">//&nbsp;the&nbsp;parseState&nbsp;describes&nbsp;the&nbsp;nested&nbsp;state,&nbsp;outermost&nbsp;at&nbsp;entry&nbsp;0.</span><br>
<span class="lineno">130</span><span class="keyword" id="5296703">const</span>&nbsp;<span class="op" id="5296709">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5296712">parseObjectKey</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5296729">=</span>&nbsp;<span class="ident" id="5296731">iota</span>&nbsp;<span class="comment" id="5296736">//&nbsp;parsing&nbsp;object&nbsp;key&nbsp;(before&nbsp;colon)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5296774">parseObjectValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5296798">//&nbsp;parsing&nbsp;object&nbsp;value&nbsp;(after&nbsp;colon)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5296837">parseArrayValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5296861">//&nbsp;parsing&nbsp;array&nbsp;value</span><br>
<span class="lineno"></span><span class="op" id="5296884">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="5296887">//&nbsp;reset&nbsp;prepares&nbsp;the&nbsp;scanner&nbsp;for&nbsp;use.</span><br>
<span class="lineno"></span><span class="comment" id="5296926">//&nbsp;It&nbsp;must&nbsp;be&nbsp;called&nbsp;before&nbsp;calling&nbsp;s.step.</span><br>
<span class="lineno"></span><span class="keyword" id="5296970">func</span>&nbsp;<span class="op" id="5296975">(</span><span class="ident" id="5296976">s</span>&nbsp;<span class="op" id="5296978">*</span><span class="ident" id="5296979">scanner</span><span class="op" id="5296986">)</span>&nbsp;<span class="ident" id="5296988">reset</span><span class="op" id="5296993">(</span><span class="op" id="5296994">)</span>&nbsp;<span class="op" id="5296996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5296999">s</span><span class="op" id="5297000">.</span><span class="ident" id="5297001">step</span>&nbsp;<span class="op" id="5297006">=</span>&nbsp;<span class="ident" id="5297008">stateBeginValue</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5297025">s</span><span class="op" id="5297026">.</span><span class="ident" id="5297027">parseState</span>&nbsp;<span class="op" id="5297038">=</span>&nbsp;<span class="ident" id="5297040">s</span><span class="op" id="5297041">.</span><span class="ident" id="5297042">parseState</span><span class="op" id="5297052">[</span><span class="num" id="5297053">0</span><span class="op" id="5297054">:</span><span class="num" id="5297055">0</span><span class="op" id="5297056">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5297059">s</span><span class="op" id="5297060">.</span><span class="ident" id="5297061">err</span>&nbsp;<span class="op" id="5297065">=</span>&nbsp;<span class="ident" id="5297067">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5297072">s</span><span class="op" id="5297073">.</span><span class="ident" id="5297074">redo</span>&nbsp;<span class="op" id="5297079">=</span>&nbsp;<span class="builtintype" id="5297081">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5297088">s</span><span class="op" id="5297089">.</span><span class="ident" id="5297090">endTop</span>&nbsp;<span class="op" id="5297097">=</span>&nbsp;<span class="builtintype" id="5297099">false</span><br>
<span class="lineno"></span><span class="op" id="5297105">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="5297108">//&nbsp;eof&nbsp;tells&nbsp;the&nbsp;scanner&nbsp;that&nbsp;the&nbsp;end&nbsp;of&nbsp;input&nbsp;has&nbsp;been&nbsp;reached.</span><br>
<span class="lineno"></span><span class="comment" id="5297173">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;scan&nbsp;status&nbsp;just&nbsp;as&nbsp;s.step&nbsp;does.</span><br>
<span class="lineno"></span><span class="keyword" id="5297222">func</span>&nbsp;<span class="op" id="5297227">(</span><span class="ident" id="5297228">s</span>&nbsp;<span class="op" id="5297230">*</span><span class="ident" id="5297231">scanner</span><span class="op" id="5297238">)</span>&nbsp;<span class="ident" id="5297240">eof</span><span class="op" id="5297243">(</span><span class="op" id="5297244">)</span>&nbsp;<span class="builtintype" id="5297246">int</span>&nbsp;<span class="op" id="5297250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5297253">if</span>&nbsp;<span class="ident" id="5297256">s</span><span class="op" id="5297257">.</span><span class="ident" id="5297258">err</span>&nbsp;<span class="op" id="5297262">!=</span>&nbsp;<span class="ident" id="5297265">nil</span>&nbsp;<span class="op" id="5297269">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5297273">return</span>&nbsp;<span class="ident" id="5297280">scanError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5297291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5297294">if</span>&nbsp;<span class="ident" id="5297297">s</span><span class="op" id="5297298">.</span><span class="ident" id="5297299">endTop</span>&nbsp;<span class="op" id="5297306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5297310">return</span>&nbsp;<span class="ident" id="5297317">scanEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5297326">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5297329">s</span><span class="op" id="5297330">.</span><span class="ident" id="5297331">step</span><span class="op" id="5297335">(</span><span class="ident" id="5297336">s</span><span class="op" id="5297337">,</span>&nbsp;<span class="string" id="5297339">&#39;&nbsp;&#39;</span><span class="op" id="5297342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5297345">if</span>&nbsp;<span class="ident" id="5297348">s</span><span class="op" id="5297349">.</span><span class="ident" id="5297350">endTop</span>&nbsp;<span class="op" id="5297357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5297361">return</span>&nbsp;<span class="ident" id="5297368">scanEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5297377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5297380">if</span>&nbsp;<span class="ident" id="5297383">s</span><span class="op" id="5297384">.</span><span class="ident" id="5297385">err</span>&nbsp;<span class="op" id="5297389">==</span>&nbsp;<span class="ident" id="5297392">nil</span>&nbsp;<span class="op" id="5297396">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5297400">s</span><span class="op" id="5297401">.</span><span class="ident" id="5297402">err</span>&nbsp;<span class="op" id="5297406">=</span>&nbsp;<span class="op" id="5297408">&amp;</span><span class="ident" id="5297409">SyntaxError</span><span class="op" id="5297420">{</span><span class="string" id="5297421">&#34;unexpected&nbsp;end&nbsp;of&nbsp;JSON&nbsp;input&#34;</span><span class="op" id="5297451">,</span>&nbsp;<span class="ident" id="5297453">s</span><span class="op" id="5297454">.</span><span class="ident" id="5297455">bytes</span><span class="op" id="5297460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5297463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5297466">return</span>&nbsp;<span class="ident" id="5297473">scanError</span><br>
<span class="lineno"></span><span class="op" id="5297483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="5297486">//&nbsp;pushParseState&nbsp;pushes&nbsp;a&nbsp;new&nbsp;parse&nbsp;state&nbsp;p&nbsp;onto&nbsp;the&nbsp;parse&nbsp;stack.</span><br>
<span class="lineno"></span><span class="keyword" id="5297553">func</span>&nbsp;<span class="op" id="5297558">(</span><span class="ident" id="5297559">s</span>&nbsp;<span class="op" id="5297561">*</span><span class="ident" id="5297562">scanner</span><span class="op" id="5297569">)</span>&nbsp;<span class="ident" id="5297571">pushParseState</span><span class="op" id="5297585">(</span><span class="ident" id="5297586">p</span>&nbsp;<span class="builtintype" id="5297588">int</span><span class="op" id="5297591">)</span>&nbsp;<span class="op" id="5297593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5297596">s</span><span class="op" id="5297597">.</span><span class="ident" id="5297598">parseState</span>&nbsp;<span class="op" id="5297609">=</span>&nbsp;<span class="builtinfunc" id="5297611">append</span><span class="op" id="5297617">(</span><span class="ident" id="5297618">s</span><span class="op" id="5297619">.</span><span class="ident" id="5297620">parseState</span><span class="op" id="5297630">,</span>&nbsp;<span class="ident" id="5297632">p</span><span class="op" id="5297633">)</span><br>
<span class="lineno"></span><span class="op" id="5297635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="comment" id="5297638">//&nbsp;popParseState&nbsp;pops&nbsp;a&nbsp;parse&nbsp;state&nbsp;(already&nbsp;obtained)&nbsp;off&nbsp;the&nbsp;stack</span><br>
<span class="lineno"></span><span class="comment" id="5297707">//&nbsp;and&nbsp;updates&nbsp;s.step&nbsp;accordingly.</span><br>
<span class="lineno"></span><span class="keyword" id="5297742">func</span>&nbsp;<span class="op" id="5297747">(</span><span class="ident" id="5297748">s</span>&nbsp;<span class="op" id="5297750">*</span><span class="ident" id="5297751">scanner</span><span class="op" id="5297758">)</span>&nbsp;<span class="ident" id="5297760">popParseState</span><span class="op" id="5297773">(</span><span class="op" id="5297774">)</span>&nbsp;<span class="op" id="5297776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5297779">n</span>&nbsp;<span class="op" id="5297781">:=</span>&nbsp;<span class="builtinfunc" id="5297784">len</span><span class="op" id="5297787">(</span><span class="ident" id="5297788">s</span><span class="op" id="5297789">.</span><span class="ident" id="5297790">parseState</span><span class="op" id="5297800">)</span>&nbsp;<span class="op" id="5297802">-</span>&nbsp;<span class="num" id="5297804">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5297807">s</span><span class="op" id="5297808">.</span><span class="ident" id="5297809">parseState</span>&nbsp;<span class="op" id="5297820">=</span>&nbsp;<span class="ident" id="5297822">s</span><span class="op" id="5297823">.</span><span class="ident" id="5297824">parseState</span><span class="op" id="5297834">[</span><span class="num" id="5297835">0</span><span class="op" id="5297836">:</span><span class="ident" id="5297837">n</span><span class="op" id="5297838">]</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5297841">s</span><span class="op" id="5297842">.</span><span class="ident" id="5297843">redo</span>&nbsp;<span class="op" id="5297848">=</span>&nbsp;<span class="builtintype" id="5297850">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5297857">if</span>&nbsp;<span class="ident" id="5297860">n</span>&nbsp;<span class="op" id="5297862">==</span>&nbsp;<span class="num" id="5297865">0</span>&nbsp;<span class="op" id="5297867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5297871">s</span><span class="op" id="5297872">.</span><span class="ident" id="5297873">step</span>&nbsp;<span class="op" id="5297878">=</span>&nbsp;<span class="ident" id="5297880">stateEndTop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5297894">s</span><span class="op" id="5297895">.</span><span class="ident" id="5297896">endTop</span>&nbsp;<span class="op" id="5297903">=</span>&nbsp;<span class="builtintype" id="5297905">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5297911">}</span>&nbsp;<span class="keyword" id="5297913">else</span>&nbsp;<span class="op" id="5297918">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5297922">s</span><span class="op" id="5297923">.</span><span class="ident" id="5297924">step</span>&nbsp;<span class="op" id="5297929">=</span>&nbsp;<span class="ident" id="5297931">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5297946">}</span><br>
<span class="lineno"></span><span class="op" id="5297948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5297951">func</span>&nbsp;<span class="ident" id="5297956">isSpace</span><span class="op" id="5297963">(</span><span class="ident" id="5297964">c</span>&nbsp;<span class="builtintype" id="5297966">rune</span><span class="op" id="5297970">)</span>&nbsp;<span class="builtintype" id="5297972">bool</span>&nbsp;<span class="op" id="5297977">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5297980">return</span>&nbsp;<span class="ident" id="5297987">c</span>&nbsp;<span class="op" id="5297989">==</span>&nbsp;<span class="string" id="5297992">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5297996">||</span>&nbsp;<span class="ident" id="5297999">c</span>&nbsp;<span class="op" id="5298001">==</span>&nbsp;<span class="string" id="5298004">&#39;\t&#39;</span>&nbsp;<span class="op" id="5298009">||</span>&nbsp;<span class="ident" id="5298012">c</span>&nbsp;<span class="op" id="5298014">==</span>&nbsp;<span class="string" id="5298017">&#39;\r&#39;</span>&nbsp;<span class="op" id="5298022">||</span>&nbsp;<span class="ident" id="5298025">c</span>&nbsp;<span class="op" id="5298027">==</span>&nbsp;<span class="string" id="5298030">&#39;\n&#39;</span><br>
<span class="lineno"></span><span class="op" id="5298035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5298038">//&nbsp;stateBeginValueOrEmpty&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`[`.</span><br>
<span class="lineno"></span><span class="keyword" id="5298096">func</span>&nbsp;<span class="ident" id="5298101">stateBeginValueOrEmpty</span><span class="op" id="5298123">(</span><span class="ident" id="5298124">s</span>&nbsp;<span class="op" id="5298126">*</span><span class="ident" id="5298127">scanner</span><span class="op" id="5298134">,</span>&nbsp;<span class="ident" id="5298136">c</span>&nbsp;<span class="builtintype" id="5298138">int</span><span class="op" id="5298141">)</span>&nbsp;<span class="builtintype" id="5298143">int</span>&nbsp;<span class="op" id="5298147">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5298150">if</span>&nbsp;<span class="ident" id="5298153">c</span>&nbsp;<span class="op" id="5298155">&lt;=</span>&nbsp;<span class="string" id="5298158">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5298162">&amp;&amp;</span>&nbsp;<span class="ident" id="5298165">isSpace</span><span class="op" id="5298172">(</span><span class="builtintype" id="5298173">rune</span><span class="op" id="5298177">(</span><span class="ident" id="5298178">c</span><span class="op" id="5298179">)</span><span class="op" id="5298180">)</span>&nbsp;<span class="op" id="5298182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5298186">return</span>&nbsp;<span class="ident" id="5298193">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5298208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5298211">if</span>&nbsp;<span class="ident" id="5298214">c</span>&nbsp;<span class="op" id="5298216">==</span>&nbsp;<span class="string" id="5298219">&#39;]&#39;</span>&nbsp;<span class="op" id="5298223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5298227">return</span>&nbsp;<span class="ident" id="5298234">stateEndValue</span><span class="op" id="5298247">(</span><span class="ident" id="5298248">s</span><span class="op" id="5298249">,</span>&nbsp;<span class="ident" id="5298251">c</span><span class="op" id="5298252">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5298255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5298258">return</span>&nbsp;<span class="ident" id="5298265">stateBeginValue</span><span class="op" id="5298280">(</span><span class="ident" id="5298281">s</span><span class="op" id="5298282">,</span>&nbsp;<span class="ident" id="5298284">c</span><span class="op" id="5298285">)</span><br>
<span class="lineno"></span><span class="op" id="5298287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5298290">//&nbsp;stateBeginValue&nbsp;is&nbsp;the&nbsp;state&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;input.</span><br>
<span class="lineno">200</span><span class="keyword" id="5298353">func</span>&nbsp;<span class="ident" id="5298358">stateBeginValue</span><span class="op" id="5298373">(</span><span class="ident" id="5298374">s</span>&nbsp;<span class="op" id="5298376">*</span><span class="ident" id="5298377">scanner</span><span class="op" id="5298384">,</span>&nbsp;<span class="ident" id="5298386">c</span>&nbsp;<span class="builtintype" id="5298388">int</span><span class="op" id="5298391">)</span>&nbsp;<span class="builtintype" id="5298393">int</span>&nbsp;<span class="op" id="5298397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5298400">if</span>&nbsp;<span class="ident" id="5298403">c</span>&nbsp;<span class="op" id="5298405">&lt;=</span>&nbsp;<span class="string" id="5298408">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5298412">&amp;&amp;</span>&nbsp;<span class="ident" id="5298415">isSpace</span><span class="op" id="5298422">(</span><span class="builtintype" id="5298423">rune</span><span class="op" id="5298427">(</span><span class="ident" id="5298428">c</span><span class="op" id="5298429">)</span><span class="op" id="5298430">)</span>&nbsp;<span class="op" id="5298432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5298436">return</span>&nbsp;<span class="ident" id="5298443">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5298458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5298461">switch</span>&nbsp;<span class="ident" id="5298468">c</span>&nbsp;<span class="op" id="5298470">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5298473">case</span>&nbsp;<span class="string" id="5298478">&#39;{&#39;</span><span class="op" id="5298481">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5298485">s</span><span class="op" id="5298486">.</span><span class="ident" id="5298487">step</span>&nbsp;<span class="op" id="5298492">=</span>&nbsp;<span class="ident" id="5298494">stateBeginStringOrEmpty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5298520">s</span><span class="op" id="5298521">.</span><span class="ident" id="5298522">pushParseState</span><span class="op" id="5298536">(</span><span class="ident" id="5298537">parseObjectKey</span><span class="op" id="5298551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5298555">return</span>&nbsp;<span class="ident" id="5298562">scanBeginObject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5298579">case</span>&nbsp;<span class="string" id="5298584">&#39;[&#39;</span><span class="op" id="5298587">:</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5298591">s</span><span class="op" id="5298592">.</span><span class="ident" id="5298593">step</span>&nbsp;<span class="op" id="5298598">=</span>&nbsp;<span class="ident" id="5298600">stateBeginValueOrEmpty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5298625">s</span><span class="op" id="5298626">.</span><span class="ident" id="5298627">pushParseState</span><span class="op" id="5298641">(</span><span class="ident" id="5298642">parseArrayValue</span><span class="op" id="5298657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5298661">return</span>&nbsp;<span class="ident" id="5298668">scanBeginArray</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5298684">case</span>&nbsp;<span class="string" id="5298689">&#39;&#34;&#39;</span><span class="op" id="5298692">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5298696">s</span><span class="op" id="5298697">.</span><span class="ident" id="5298698">step</span>&nbsp;<span class="op" id="5298703">=</span>&nbsp;<span class="ident" id="5298705">stateInString</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5298721">return</span>&nbsp;<span class="ident" id="5298728">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5298746">case</span>&nbsp;<span class="string" id="5298751">&#39;-&#39;</span><span class="op" id="5298754">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5298758">s</span><span class="op" id="5298759">.</span><span class="ident" id="5298760">step</span>&nbsp;<span class="op" id="5298765">=</span>&nbsp;<span class="ident" id="5298767">stateNeg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5298778">return</span>&nbsp;<span class="ident" id="5298785">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5298803">case</span>&nbsp;<span class="string" id="5298808">&#39;0&#39;</span><span class="op" id="5298811">:</span>&nbsp;<span class="comment" id="5298813">//&nbsp;beginning&nbsp;of&nbsp;0.123</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5298837">s</span><span class="op" id="5298838">.</span><span class="ident" id="5298839">step</span>&nbsp;<span class="op" id="5298844">=</span>&nbsp;<span class="ident" id="5298846">state0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5298855">return</span>&nbsp;<span class="ident" id="5298862">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5298880">case</span>&nbsp;<span class="string" id="5298885">&#39;t&#39;</span><span class="op" id="5298888">:</span>&nbsp;<span class="comment" id="5298890">//&nbsp;beginning&nbsp;of&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5298913">s</span><span class="op" id="5298914">.</span><span class="ident" id="5298915">step</span>&nbsp;<span class="op" id="5298920">=</span>&nbsp;<span class="ident" id="5298922">stateT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5298931">return</span>&nbsp;<span class="ident" id="5298938">scanBeginLiteral</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5298956">case</span>&nbsp;<span class="string" id="5298961">&#39;f&#39;</span><span class="op" id="5298964">:</span>&nbsp;<span class="comment" id="5298966">//&nbsp;beginning&nbsp;of&nbsp;false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5298990">s</span><span class="op" id="5298991">.</span><span class="ident" id="5298992">step</span>&nbsp;<span class="op" id="5298997">=</span>&nbsp;<span class="ident" id="5298999">stateF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5299008">return</span>&nbsp;<span class="ident" id="5299015">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5299033">case</span>&nbsp;<span class="string" id="5299038">&#39;n&#39;</span><span class="op" id="5299041">:</span>&nbsp;<span class="comment" id="5299043">//&nbsp;beginning&nbsp;of&nbsp;null</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5299066">s</span><span class="op" id="5299067">.</span><span class="ident" id="5299068">step</span>&nbsp;<span class="op" id="5299073">=</span>&nbsp;<span class="ident" id="5299075">stateN</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5299084">return</span>&nbsp;<span class="ident" id="5299091">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5299109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5299112">if</span>&nbsp;<span class="string" id="5299115">&#39;1&#39;</span>&nbsp;<span class="op" id="5299119">&lt;=</span>&nbsp;<span class="ident" id="5299122">c</span>&nbsp;<span class="op" id="5299124">&amp;&amp;</span>&nbsp;<span class="ident" id="5299127">c</span>&nbsp;<span class="op" id="5299129">&lt;=</span>&nbsp;<span class="string" id="5299132">&#39;9&#39;</span>&nbsp;<span class="op" id="5299136">{</span>&nbsp;<span class="comment" id="5299138">//&nbsp;beginning&nbsp;of&nbsp;1234.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5299163">s</span><span class="op" id="5299164">.</span><span class="ident" id="5299165">step</span>&nbsp;<span class="op" id="5299170">=</span>&nbsp;<span class="ident" id="5299172">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5299181">return</span>&nbsp;<span class="ident" id="5299188">scanBeginLiteral</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5299206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5299209">return</span>&nbsp;<span class="ident" id="5299216">s</span><span class="op" id="5299217">.</span><span class="builtintype" id="5299218">error</span><span class="op" id="5299223">(</span><span class="ident" id="5299224">c</span><span class="op" id="5299225">,</span>&nbsp;<span class="string" id="5299227">&#34;looking&nbsp;for&nbsp;beginning&nbsp;of&nbsp;value&#34;</span><span class="op" id="5299259">)</span><br>
<span class="lineno"></span><span class="op" id="5299261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5299264">//&nbsp;stateBeginStringOrEmpty&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`{`.</span><br>
<span class="lineno">240</span><span class="keyword" id="5299323">func</span>&nbsp;<span class="ident" id="5299328">stateBeginStringOrEmpty</span><span class="op" id="5299351">(</span><span class="ident" id="5299352">s</span>&nbsp;<span class="op" id="5299354">*</span><span class="ident" id="5299355">scanner</span><span class="op" id="5299362">,</span>&nbsp;<span class="ident" id="5299364">c</span>&nbsp;<span class="builtintype" id="5299366">int</span><span class="op" id="5299369">)</span>&nbsp;<span class="builtintype" id="5299371">int</span>&nbsp;<span class="op" id="5299375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5299378">if</span>&nbsp;<span class="ident" id="5299381">c</span>&nbsp;<span class="op" id="5299383">&lt;=</span>&nbsp;<span class="string" id="5299386">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5299390">&amp;&amp;</span>&nbsp;<span class="ident" id="5299393">isSpace</span><span class="op" id="5299400">(</span><span class="builtintype" id="5299401">rune</span><span class="op" id="5299405">(</span><span class="ident" id="5299406">c</span><span class="op" id="5299407">)</span><span class="op" id="5299408">)</span>&nbsp;<span class="op" id="5299410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5299414">return</span>&nbsp;<span class="ident" id="5299421">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5299436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5299439">if</span>&nbsp;<span class="ident" id="5299442">c</span>&nbsp;<span class="op" id="5299444">==</span>&nbsp;<span class="string" id="5299447">&#39;}&#39;</span>&nbsp;<span class="op" id="5299451">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5299455">n</span>&nbsp;<span class="op" id="5299457">:=</span>&nbsp;<span class="builtinfunc" id="5299460">len</span><span class="op" id="5299463">(</span><span class="ident" id="5299464">s</span><span class="op" id="5299465">.</span><span class="ident" id="5299466">parseState</span><span class="op" id="5299476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5299480">s</span><span class="op" id="5299481">.</span><span class="ident" id="5299482">parseState</span><span class="op" id="5299492">[</span><span class="ident" id="5299493">n</span><span class="op" id="5299494">-</span><span class="num" id="5299495">1</span><span class="op" id="5299496">]</span>&nbsp;<span class="op" id="5299498">=</span>&nbsp;<span class="ident" id="5299500">parseObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5299519">return</span>&nbsp;<span class="ident" id="5299526">stateEndValue</span><span class="op" id="5299539">(</span><span class="ident" id="5299540">s</span><span class="op" id="5299541">,</span>&nbsp;<span class="ident" id="5299543">c</span><span class="op" id="5299544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5299547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5299550">return</span>&nbsp;<span class="ident" id="5299557">stateBeginString</span><span class="op" id="5299573">(</span><span class="ident" id="5299574">s</span><span class="op" id="5299575">,</span>&nbsp;<span class="ident" id="5299577">c</span><span class="op" id="5299578">)</span><br>
<span class="lineno">250</span><span class="op" id="5299580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5299583">//&nbsp;stateBeginString&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`{&#34;key&#34;:&nbsp;value,`.</span><br>
<span class="lineno"></span><span class="keyword" id="5299648">func</span>&nbsp;<span class="ident" id="5299653">stateBeginString</span><span class="op" id="5299669">(</span><span class="ident" id="5299670">s</span>&nbsp;<span class="op" id="5299672">*</span><span class="ident" id="5299673">scanner</span><span class="op" id="5299680">,</span>&nbsp;<span class="ident" id="5299682">c</span>&nbsp;<span class="builtintype" id="5299684">int</span><span class="op" id="5299687">)</span>&nbsp;<span class="builtintype" id="5299689">int</span>&nbsp;<span class="op" id="5299693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5299696">if</span>&nbsp;<span class="ident" id="5299699">c</span>&nbsp;<span class="op" id="5299701">&lt;=</span>&nbsp;<span class="string" id="5299704">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5299708">&amp;&amp;</span>&nbsp;<span class="ident" id="5299711">isSpace</span><span class="op" id="5299718">(</span><span class="builtintype" id="5299719">rune</span><span class="op" id="5299723">(</span><span class="ident" id="5299724">c</span><span class="op" id="5299725">)</span><span class="op" id="5299726">)</span>&nbsp;<span class="op" id="5299728">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5299732">return</span>&nbsp;<span class="ident" id="5299739">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5299754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5299757">if</span>&nbsp;<span class="ident" id="5299760">c</span>&nbsp;<span class="op" id="5299762">==</span>&nbsp;<span class="string" id="5299765">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5299769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5299773">s</span><span class="op" id="5299774">.</span><span class="ident" id="5299775">step</span>&nbsp;<span class="op" id="5299780">=</span>&nbsp;<span class="ident" id="5299782">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5299798">return</span>&nbsp;<span class="ident" id="5299805">scanBeginLiteral</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5299823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5299826">return</span>&nbsp;<span class="ident" id="5299833">s</span><span class="op" id="5299834">.</span><span class="builtintype" id="5299835">error</span><span class="op" id="5299840">(</span><span class="ident" id="5299841">c</span><span class="op" id="5299842">,</span>&nbsp;<span class="string" id="5299844">&#34;looking&nbsp;for&nbsp;beginning&nbsp;of&nbsp;object&nbsp;key&nbsp;string&#34;</span><span class="op" id="5299888">)</span><br>
<span class="lineno"></span><span class="op" id="5299890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5299893">//&nbsp;stateEndValue&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;completing&nbsp;a&nbsp;value,</span><br>
<span class="lineno">265</span><span class="comment" id="5299949">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`{}`&nbsp;or&nbsp;`true`&nbsp;or&nbsp;`[&#34;x&#34;`.</span><br>
<span class="lineno"></span><span class="keyword" id="5300000">func</span>&nbsp;<span class="ident" id="5300005">stateEndValue</span><span class="op" id="5300018">(</span><span class="ident" id="5300019">s</span>&nbsp;<span class="op" id="5300021">*</span><span class="ident" id="5300022">scanner</span><span class="op" id="5300029">,</span>&nbsp;<span class="ident" id="5300031">c</span>&nbsp;<span class="builtintype" id="5300033">int</span><span class="op" id="5300036">)</span>&nbsp;<span class="builtintype" id="5300038">int</span>&nbsp;<span class="op" id="5300042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5300045">n</span>&nbsp;<span class="op" id="5300047">:=</span>&nbsp;<span class="builtinfunc" id="5300050">len</span><span class="op" id="5300053">(</span><span class="ident" id="5300054">s</span><span class="op" id="5300055">.</span><span class="ident" id="5300056">parseState</span><span class="op" id="5300066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5300069">if</span>&nbsp;<span class="ident" id="5300072">n</span>&nbsp;<span class="op" id="5300074">==</span>&nbsp;<span class="num" id="5300077">0</span>&nbsp;<span class="op" id="5300079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5300083">//&nbsp;Completed&nbsp;top-level&nbsp;before&nbsp;the&nbsp;current&nbsp;byte.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5300133">s</span><span class="op" id="5300134">.</span><span class="ident" id="5300135">step</span>&nbsp;<span class="op" id="5300140">=</span>&nbsp;<span class="ident" id="5300142">stateEndTop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5300156">s</span><span class="op" id="5300157">.</span><span class="ident" id="5300158">endTop</span>&nbsp;<span class="op" id="5300165">=</span>&nbsp;<span class="builtintype" id="5300167">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5300174">return</span>&nbsp;<span class="ident" id="5300181">stateEndTop</span><span class="op" id="5300192">(</span><span class="ident" id="5300193">s</span><span class="op" id="5300194">,</span>&nbsp;<span class="ident" id="5300196">c</span><span class="op" id="5300197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5300200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5300203">if</span>&nbsp;<span class="ident" id="5300206">c</span>&nbsp;<span class="op" id="5300208">&lt;=</span>&nbsp;<span class="string" id="5300211">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5300215">&amp;&amp;</span>&nbsp;<span class="ident" id="5300218">isSpace</span><span class="op" id="5300225">(</span><span class="builtintype" id="5300226">rune</span><span class="op" id="5300230">(</span><span class="ident" id="5300231">c</span><span class="op" id="5300232">)</span><span class="op" id="5300233">)</span>&nbsp;<span class="op" id="5300235">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5300239">s</span><span class="op" id="5300240">.</span><span class="ident" id="5300241">step</span>&nbsp;<span class="op" id="5300246">=</span>&nbsp;<span class="ident" id="5300248">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5300264">return</span>&nbsp;<span class="ident" id="5300271">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5300286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5300289">ps</span>&nbsp;<span class="op" id="5300292">:=</span>&nbsp;<span class="ident" id="5300295">s</span><span class="op" id="5300296">.</span><span class="ident" id="5300297">parseState</span><span class="op" id="5300307">[</span><span class="ident" id="5300308">n</span><span class="op" id="5300309">-</span><span class="num" id="5300310">1</span><span class="op" id="5300311">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5300314">switch</span>&nbsp;<span class="ident" id="5300321">ps</span>&nbsp;<span class="op" id="5300324">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5300327">case</span>&nbsp;<span class="ident" id="5300332">parseObjectKey</span><span class="op" id="5300346">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5300350">if</span>&nbsp;<span class="ident" id="5300353">c</span>&nbsp;<span class="op" id="5300355">==</span>&nbsp;<span class="string" id="5300358">&#39;:&#39;</span>&nbsp;<span class="op" id="5300362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5300367">s</span><span class="op" id="5300368">.</span><span class="ident" id="5300369">parseState</span><span class="op" id="5300379">[</span><span class="ident" id="5300380">n</span><span class="op" id="5300381">-</span><span class="num" id="5300382">1</span><span class="op" id="5300383">]</span>&nbsp;<span class="op" id="5300385">=</span>&nbsp;<span class="ident" id="5300387">parseObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5300407">s</span><span class="op" id="5300408">.</span><span class="ident" id="5300409">step</span>&nbsp;<span class="op" id="5300414">=</span>&nbsp;<span class="ident" id="5300416">stateBeginValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5300435">return</span>&nbsp;<span class="ident" id="5300442">scanObjectKey</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5300458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5300462">return</span>&nbsp;<span class="ident" id="5300469">s</span><span class="op" id="5300470">.</span><span class="builtintype" id="5300471">error</span><span class="op" id="5300476">(</span><span class="ident" id="5300477">c</span><span class="op" id="5300478">,</span>&nbsp;<span class="string" id="5300480">&#34;after&nbsp;object&nbsp;key&#34;</span><span class="op" id="5300498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5300501">case</span>&nbsp;<span class="ident" id="5300506">parseObjectValue</span><span class="op" id="5300522">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5300526">if</span>&nbsp;<span class="ident" id="5300529">c</span>&nbsp;<span class="op" id="5300531">==</span>&nbsp;<span class="string" id="5300534">&#39;,&#39;</span>&nbsp;<span class="op" id="5300538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5300543">s</span><span class="op" id="5300544">.</span><span class="ident" id="5300545">parseState</span><span class="op" id="5300555">[</span><span class="ident" id="5300556">n</span><span class="op" id="5300557">-</span><span class="num" id="5300558">1</span><span class="op" id="5300559">]</span>&nbsp;<span class="op" id="5300561">=</span>&nbsp;<span class="ident" id="5300563">parseObjectKey</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5300581">s</span><span class="op" id="5300582">.</span><span class="ident" id="5300583">step</span>&nbsp;<span class="op" id="5300588">=</span>&nbsp;<span class="ident" id="5300590">stateBeginString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5300610">return</span>&nbsp;<span class="ident" id="5300617">scanObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5300635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5300639">if</span>&nbsp;<span class="ident" id="5300642">c</span>&nbsp;<span class="op" id="5300644">==</span>&nbsp;<span class="string" id="5300647">&#39;}&#39;</span>&nbsp;<span class="op" id="5300651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5300656">s</span><span class="op" id="5300657">.</span><span class="ident" id="5300658">popParseState</span><span class="op" id="5300671">(</span><span class="op" id="5300672">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5300677">return</span>&nbsp;<span class="ident" id="5300684">scanEndObject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5300700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5300704">return</span>&nbsp;<span class="ident" id="5300711">s</span><span class="op" id="5300712">.</span><span class="builtintype" id="5300713">error</span><span class="op" id="5300718">(</span><span class="ident" id="5300719">c</span><span class="op" id="5300720">,</span>&nbsp;<span class="string" id="5300722">&#34;after&nbsp;object&nbsp;key:value&nbsp;pair&#34;</span><span class="op" id="5300751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5300754">case</span>&nbsp;<span class="ident" id="5300759">parseArrayValue</span><span class="op" id="5300774">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5300778">if</span>&nbsp;<span class="ident" id="5300781">c</span>&nbsp;<span class="op" id="5300783">==</span>&nbsp;<span class="string" id="5300786">&#39;,&#39;</span>&nbsp;<span class="op" id="5300790">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5300795">s</span><span class="op" id="5300796">.</span><span class="ident" id="5300797">step</span>&nbsp;<span class="op" id="5300802">=</span>&nbsp;<span class="ident" id="5300804">stateBeginValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5300823">return</span>&nbsp;<span class="ident" id="5300830">scanArrayValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5300847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5300851">if</span>&nbsp;<span class="ident" id="5300854">c</span>&nbsp;<span class="op" id="5300856">==</span>&nbsp;<span class="string" id="5300859">&#39;]&#39;</span>&nbsp;<span class="op" id="5300863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5300868">s</span><span class="op" id="5300869">.</span><span class="ident" id="5300870">popParseState</span><span class="op" id="5300883">(</span><span class="op" id="5300884">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5300889">return</span>&nbsp;<span class="ident" id="5300896">scanEndArray</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5300911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5300915">return</span>&nbsp;<span class="ident" id="5300922">s</span><span class="op" id="5300923">.</span><span class="builtintype" id="5300924">error</span><span class="op" id="5300929">(</span><span class="ident" id="5300930">c</span><span class="op" id="5300931">,</span>&nbsp;<span class="string" id="5300933">&#34;after&nbsp;array&nbsp;element&#34;</span><span class="op" id="5300954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5300957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5300960">return</span>&nbsp;<span class="ident" id="5300967">s</span><span class="op" id="5300968">.</span><span class="builtintype" id="5300969">error</span><span class="op" id="5300974">(</span><span class="ident" id="5300975">c</span><span class="op" id="5300976">,</span>&nbsp;<span class="string" id="5300978">&#34;&#34;</span><span class="op" id="5300980">)</span><br>
<span class="lineno">310</span><span class="op" id="5300982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5300985">//&nbsp;stateEndTop&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;finishing&nbsp;the&nbsp;top-level&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="5301050">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`{}`&nbsp;or&nbsp;`[1,2,3]`.</span><br>
<span class="lineno"></span><span class="comment" id="5301094">//&nbsp;Only&nbsp;space&nbsp;characters&nbsp;should&nbsp;be&nbsp;seen&nbsp;now.</span><br>
<span class="lineno">315</span><span class="keyword" id="5301139">func</span>&nbsp;<span class="ident" id="5301144">stateEndTop</span><span class="op" id="5301155">(</span><span class="ident" id="5301156">s</span>&nbsp;<span class="op" id="5301158">*</span><span class="ident" id="5301159">scanner</span><span class="op" id="5301166">,</span>&nbsp;<span class="ident" id="5301168">c</span>&nbsp;<span class="builtintype" id="5301170">int</span><span class="op" id="5301173">)</span>&nbsp;<span class="builtintype" id="5301175">int</span>&nbsp;<span class="op" id="5301179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5301182">if</span>&nbsp;<span class="ident" id="5301185">c</span>&nbsp;<span class="op" id="5301187">!=</span>&nbsp;<span class="string" id="5301190">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5301194">&amp;&amp;</span>&nbsp;<span class="ident" id="5301197">c</span>&nbsp;<span class="op" id="5301199">!=</span>&nbsp;<span class="string" id="5301202">&#39;\t&#39;</span>&nbsp;<span class="op" id="5301207">&amp;&amp;</span>&nbsp;<span class="ident" id="5301210">c</span>&nbsp;<span class="op" id="5301212">!=</span>&nbsp;<span class="string" id="5301215">&#39;\r&#39;</span>&nbsp;<span class="op" id="5301220">&amp;&amp;</span>&nbsp;<span class="ident" id="5301223">c</span>&nbsp;<span class="op" id="5301225">!=</span>&nbsp;<span class="string" id="5301228">&#39;\n&#39;</span>&nbsp;<span class="op" id="5301233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5301237">//&nbsp;Complain&nbsp;about&nbsp;non-space&nbsp;byte&nbsp;on&nbsp;next&nbsp;call.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5301286">s</span><span class="op" id="5301287">.</span><span class="builtintype" id="5301288">error</span><span class="op" id="5301293">(</span><span class="ident" id="5301294">c</span><span class="op" id="5301295">,</span>&nbsp;<span class="string" id="5301297">&#34;after&nbsp;top-level&nbsp;value&#34;</span><span class="op" id="5301320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5301323">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5301326">return</span>&nbsp;<span class="ident" id="5301333">scanEnd</span><br>
<span class="lineno"></span><span class="op" id="5301341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5301344">//&nbsp;stateInString&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;`.</span><br>
<span class="lineno"></span><span class="keyword" id="5301393">func</span>&nbsp;<span class="ident" id="5301398">stateInString</span><span class="op" id="5301411">(</span><span class="ident" id="5301412">s</span>&nbsp;<span class="op" id="5301414">*</span><span class="ident" id="5301415">scanner</span><span class="op" id="5301422">,</span>&nbsp;<span class="ident" id="5301424">c</span>&nbsp;<span class="builtintype" id="5301426">int</span><span class="op" id="5301429">)</span>&nbsp;<span class="builtintype" id="5301431">int</span>&nbsp;<span class="op" id="5301435">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5301438">if</span>&nbsp;<span class="ident" id="5301441">c</span>&nbsp;<span class="op" id="5301443">==</span>&nbsp;<span class="string" id="5301446">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5301450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5301454">s</span><span class="op" id="5301455">.</span><span class="ident" id="5301456">step</span>&nbsp;<span class="op" id="5301461">=</span>&nbsp;<span class="ident" id="5301463">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5301479">return</span>&nbsp;<span class="ident" id="5301486">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5301500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5301503">if</span>&nbsp;<span class="ident" id="5301506">c</span>&nbsp;<span class="op" id="5301508">==</span>&nbsp;<span class="string" id="5301511">&#39;\\&#39;</span>&nbsp;<span class="op" id="5301516">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5301520">s</span><span class="op" id="5301521">.</span><span class="ident" id="5301522">step</span>&nbsp;<span class="op" id="5301527">=</span>&nbsp;<span class="ident" id="5301529">stateInStringEsc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5301548">return</span>&nbsp;<span class="ident" id="5301555">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5301569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5301572">if</span>&nbsp;<span class="ident" id="5301575">c</span>&nbsp;<span class="op" id="5301577">&lt;</span>&nbsp;<span class="num" id="5301579">0x20</span>&nbsp;<span class="op" id="5301584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5301588">return</span>&nbsp;<span class="ident" id="5301595">s</span><span class="op" id="5301596">.</span><span class="builtintype" id="5301597">error</span><span class="op" id="5301602">(</span><span class="ident" id="5301603">c</span><span class="op" id="5301604">,</span>&nbsp;<span class="string" id="5301606">&#34;in&nbsp;string&nbsp;literal&#34;</span><span class="op" id="5301625">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5301628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5301631">return</span>&nbsp;<span class="ident" id="5301638">scanContinue</span><br>
<span class="lineno"></span><span class="op" id="5301651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5301654">//&nbsp;stateInStringEsc&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">340</span><span class="keyword" id="5301730">func</span>&nbsp;<span class="ident" id="5301735">stateInStringEsc</span><span class="op" id="5301751">(</span><span class="ident" id="5301752">s</span>&nbsp;<span class="op" id="5301754">*</span><span class="ident" id="5301755">scanner</span><span class="op" id="5301762">,</span>&nbsp;<span class="ident" id="5301764">c</span>&nbsp;<span class="builtintype" id="5301766">int</span><span class="op" id="5301769">)</span>&nbsp;<span class="builtintype" id="5301771">int</span>&nbsp;<span class="op" id="5301775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5301778">switch</span>&nbsp;<span class="ident" id="5301785">c</span>&nbsp;<span class="op" id="5301787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5301790">case</span>&nbsp;<span class="string" id="5301795">&#39;b&#39;</span><span class="op" id="5301798">,</span>&nbsp;<span class="string" id="5301800">&#39;f&#39;</span><span class="op" id="5301803">,</span>&nbsp;<span class="string" id="5301805">&#39;n&#39;</span><span class="op" id="5301808">,</span>&nbsp;<span class="string" id="5301810">&#39;r&#39;</span><span class="op" id="5301813">,</span>&nbsp;<span class="string" id="5301815">&#39;t&#39;</span><span class="op" id="5301818">,</span>&nbsp;<span class="string" id="5301820">&#39;\\&#39;</span><span class="op" id="5301824">,</span>&nbsp;<span class="string" id="5301826">&#39;/&#39;</span><span class="op" id="5301829">,</span>&nbsp;<span class="string" id="5301831">&#39;&#34;&#39;</span><span class="op" id="5301834">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5301838">s</span><span class="op" id="5301839">.</span><span class="ident" id="5301840">step</span>&nbsp;<span class="op" id="5301845">=</span>&nbsp;<span class="ident" id="5301847">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5301863">return</span>&nbsp;<span class="ident" id="5301870">scanContinue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5301884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5301887">if</span>&nbsp;<span class="ident" id="5301890">c</span>&nbsp;<span class="op" id="5301892">==</span>&nbsp;<span class="string" id="5301895">&#39;u&#39;</span>&nbsp;<span class="op" id="5301899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5301903">s</span><span class="op" id="5301904">.</span><span class="ident" id="5301905">step</span>&nbsp;<span class="op" id="5301910">=</span>&nbsp;<span class="ident" id="5301912">stateInStringEscU</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5301932">return</span>&nbsp;<span class="ident" id="5301939">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5301953">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5301956">return</span>&nbsp;<span class="ident" id="5301963">s</span><span class="op" id="5301964">.</span><span class="builtintype" id="5301965">error</span><span class="op" id="5301970">(</span><span class="ident" id="5301971">c</span><span class="op" id="5301972">,</span>&nbsp;<span class="string" id="5301974">&#34;in&nbsp;string&nbsp;escape&nbsp;code&#34;</span><span class="op" id="5301997">)</span><br>
<span class="lineno"></span><span class="op" id="5301999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5302002">//&nbsp;stateInStringEscU&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5302080">func</span>&nbsp;<span class="ident" id="5302085">stateInStringEscU</span><span class="op" id="5302102">(</span><span class="ident" id="5302103">s</span>&nbsp;<span class="op" id="5302105">*</span><span class="ident" id="5302106">scanner</span><span class="op" id="5302113">,</span>&nbsp;<span class="ident" id="5302115">c</span>&nbsp;<span class="builtintype" id="5302117">int</span><span class="op" id="5302120">)</span>&nbsp;<span class="builtintype" id="5302122">int</span>&nbsp;<span class="op" id="5302126">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5302129">if</span>&nbsp;<span class="string" id="5302132">&#39;0&#39;</span>&nbsp;<span class="op" id="5302136">&lt;=</span>&nbsp;<span class="ident" id="5302139">c</span>&nbsp;<span class="op" id="5302141">&amp;&amp;</span>&nbsp;<span class="ident" id="5302144">c</span>&nbsp;<span class="op" id="5302146">&lt;=</span>&nbsp;<span class="string" id="5302149">&#39;9&#39;</span>&nbsp;<span class="op" id="5302153">||</span>&nbsp;<span class="string" id="5302156">&#39;a&#39;</span>&nbsp;<span class="op" id="5302160">&lt;=</span>&nbsp;<span class="ident" id="5302163">c</span>&nbsp;<span class="op" id="5302165">&amp;&amp;</span>&nbsp;<span class="ident" id="5302168">c</span>&nbsp;<span class="op" id="5302170">&lt;=</span>&nbsp;<span class="string" id="5302173">&#39;f&#39;</span>&nbsp;<span class="op" id="5302177">||</span>&nbsp;<span class="string" id="5302180">&#39;A&#39;</span>&nbsp;<span class="op" id="5302184">&lt;=</span>&nbsp;<span class="ident" id="5302187">c</span>&nbsp;<span class="op" id="5302189">&amp;&amp;</span>&nbsp;<span class="ident" id="5302192">c</span>&nbsp;<span class="op" id="5302194">&lt;=</span>&nbsp;<span class="string" id="5302197">&#39;F&#39;</span>&nbsp;<span class="op" id="5302201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5302205">s</span><span class="op" id="5302206">.</span><span class="ident" id="5302207">step</span>&nbsp;<span class="op" id="5302212">=</span>&nbsp;<span class="ident" id="5302214">stateInStringEscU1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5302235">return</span>&nbsp;<span class="ident" id="5302242">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5302256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5302259">//&nbsp;numbers</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5302271">return</span>&nbsp;<span class="ident" id="5302278">s</span><span class="op" id="5302279">.</span><span class="builtintype" id="5302280">error</span><span class="op" id="5302285">(</span><span class="ident" id="5302286">c</span><span class="op" id="5302287">,</span>&nbsp;<span class="string" id="5302289">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="5302326">)</span><br>
<span class="lineno"></span><span class="op" id="5302328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5302331">//&nbsp;stateInStringEscU1&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u1`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5302411">func</span>&nbsp;<span class="ident" id="5302416">stateInStringEscU1</span><span class="op" id="5302434">(</span><span class="ident" id="5302435">s</span>&nbsp;<span class="op" id="5302437">*</span><span class="ident" id="5302438">scanner</span><span class="op" id="5302445">,</span>&nbsp;<span class="ident" id="5302447">c</span>&nbsp;<span class="builtintype" id="5302449">int</span><span class="op" id="5302452">)</span>&nbsp;<span class="builtintype" id="5302454">int</span>&nbsp;<span class="op" id="5302458">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5302461">if</span>&nbsp;<span class="string" id="5302464">&#39;0&#39;</span>&nbsp;<span class="op" id="5302468">&lt;=</span>&nbsp;<span class="ident" id="5302471">c</span>&nbsp;<span class="op" id="5302473">&amp;&amp;</span>&nbsp;<span class="ident" id="5302476">c</span>&nbsp;<span class="op" id="5302478">&lt;=</span>&nbsp;<span class="string" id="5302481">&#39;9&#39;</span>&nbsp;<span class="op" id="5302485">||</span>&nbsp;<span class="string" id="5302488">&#39;a&#39;</span>&nbsp;<span class="op" id="5302492">&lt;=</span>&nbsp;<span class="ident" id="5302495">c</span>&nbsp;<span class="op" id="5302497">&amp;&amp;</span>&nbsp;<span class="ident" id="5302500">c</span>&nbsp;<span class="op" id="5302502">&lt;=</span>&nbsp;<span class="string" id="5302505">&#39;f&#39;</span>&nbsp;<span class="op" id="5302509">||</span>&nbsp;<span class="string" id="5302512">&#39;A&#39;</span>&nbsp;<span class="op" id="5302516">&lt;=</span>&nbsp;<span class="ident" id="5302519">c</span>&nbsp;<span class="op" id="5302521">&amp;&amp;</span>&nbsp;<span class="ident" id="5302524">c</span>&nbsp;<span class="op" id="5302526">&lt;=</span>&nbsp;<span class="string" id="5302529">&#39;F&#39;</span>&nbsp;<span class="op" id="5302533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5302537">s</span><span class="op" id="5302538">.</span><span class="ident" id="5302539">step</span>&nbsp;<span class="op" id="5302544">=</span>&nbsp;<span class="ident" id="5302546">stateInStringEscU12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5302568">return</span>&nbsp;<span class="ident" id="5302575">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5302589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5302592">//&nbsp;numbers</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5302604">return</span>&nbsp;<span class="ident" id="5302611">s</span><span class="op" id="5302612">.</span><span class="builtintype" id="5302613">error</span><span class="op" id="5302618">(</span><span class="ident" id="5302619">c</span><span class="op" id="5302620">,</span>&nbsp;<span class="string" id="5302622">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="5302659">)</span><br>
<span class="lineno"></span><span class="op" id="5302661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5302664">//&nbsp;stateInStringEscU12&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u12`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5302746">func</span>&nbsp;<span class="ident" id="5302751">stateInStringEscU12</span><span class="op" id="5302770">(</span><span class="ident" id="5302771">s</span>&nbsp;<span class="op" id="5302773">*</span><span class="ident" id="5302774">scanner</span><span class="op" id="5302781">,</span>&nbsp;<span class="ident" id="5302783">c</span>&nbsp;<span class="builtintype" id="5302785">int</span><span class="op" id="5302788">)</span>&nbsp;<span class="builtintype" id="5302790">int</span>&nbsp;<span class="op" id="5302794">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5302797">if</span>&nbsp;<span class="string" id="5302800">&#39;0&#39;</span>&nbsp;<span class="op" id="5302804">&lt;=</span>&nbsp;<span class="ident" id="5302807">c</span>&nbsp;<span class="op" id="5302809">&amp;&amp;</span>&nbsp;<span class="ident" id="5302812">c</span>&nbsp;<span class="op" id="5302814">&lt;=</span>&nbsp;<span class="string" id="5302817">&#39;9&#39;</span>&nbsp;<span class="op" id="5302821">||</span>&nbsp;<span class="string" id="5302824">&#39;a&#39;</span>&nbsp;<span class="op" id="5302828">&lt;=</span>&nbsp;<span class="ident" id="5302831">c</span>&nbsp;<span class="op" id="5302833">&amp;&amp;</span>&nbsp;<span class="ident" id="5302836">c</span>&nbsp;<span class="op" id="5302838">&lt;=</span>&nbsp;<span class="string" id="5302841">&#39;f&#39;</span>&nbsp;<span class="op" id="5302845">||</span>&nbsp;<span class="string" id="5302848">&#39;A&#39;</span>&nbsp;<span class="op" id="5302852">&lt;=</span>&nbsp;<span class="ident" id="5302855">c</span>&nbsp;<span class="op" id="5302857">&amp;&amp;</span>&nbsp;<span class="ident" id="5302860">c</span>&nbsp;<span class="op" id="5302862">&lt;=</span>&nbsp;<span class="string" id="5302865">&#39;F&#39;</span>&nbsp;<span class="op" id="5302869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5302873">s</span><span class="op" id="5302874">.</span><span class="ident" id="5302875">step</span>&nbsp;<span class="op" id="5302880">=</span>&nbsp;<span class="ident" id="5302882">stateInStringEscU123</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5302905">return</span>&nbsp;<span class="ident" id="5302912">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5302926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5302929">//&nbsp;numbers</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5302941">return</span>&nbsp;<span class="ident" id="5302948">s</span><span class="op" id="5302949">.</span><span class="builtintype" id="5302950">error</span><span class="op" id="5302955">(</span><span class="ident" id="5302956">c</span><span class="op" id="5302957">,</span>&nbsp;<span class="string" id="5302959">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="5302996">)</span><br>
<span class="lineno"></span><span class="op" id="5302998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5303001">//&nbsp;stateInStringEscU123&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u123`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5303085">func</span>&nbsp;<span class="ident" id="5303090">stateInStringEscU123</span><span class="op" id="5303110">(</span><span class="ident" id="5303111">s</span>&nbsp;<span class="op" id="5303113">*</span><span class="ident" id="5303114">scanner</span><span class="op" id="5303121">,</span>&nbsp;<span class="ident" id="5303123">c</span>&nbsp;<span class="builtintype" id="5303125">int</span><span class="op" id="5303128">)</span>&nbsp;<span class="builtintype" id="5303130">int</span>&nbsp;<span class="op" id="5303134">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5303137">if</span>&nbsp;<span class="string" id="5303140">&#39;0&#39;</span>&nbsp;<span class="op" id="5303144">&lt;=</span>&nbsp;<span class="ident" id="5303147">c</span>&nbsp;<span class="op" id="5303149">&amp;&amp;</span>&nbsp;<span class="ident" id="5303152">c</span>&nbsp;<span class="op" id="5303154">&lt;=</span>&nbsp;<span class="string" id="5303157">&#39;9&#39;</span>&nbsp;<span class="op" id="5303161">||</span>&nbsp;<span class="string" id="5303164">&#39;a&#39;</span>&nbsp;<span class="op" id="5303168">&lt;=</span>&nbsp;<span class="ident" id="5303171">c</span>&nbsp;<span class="op" id="5303173">&amp;&amp;</span>&nbsp;<span class="ident" id="5303176">c</span>&nbsp;<span class="op" id="5303178">&lt;=</span>&nbsp;<span class="string" id="5303181">&#39;f&#39;</span>&nbsp;<span class="op" id="5303185">||</span>&nbsp;<span class="string" id="5303188">&#39;A&#39;</span>&nbsp;<span class="op" id="5303192">&lt;=</span>&nbsp;<span class="ident" id="5303195">c</span>&nbsp;<span class="op" id="5303197">&amp;&amp;</span>&nbsp;<span class="ident" id="5303200">c</span>&nbsp;<span class="op" id="5303202">&lt;=</span>&nbsp;<span class="string" id="5303205">&#39;F&#39;</span>&nbsp;<span class="op" id="5303209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5303213">s</span><span class="op" id="5303214">.</span><span class="ident" id="5303215">step</span>&nbsp;<span class="op" id="5303220">=</span>&nbsp;<span class="ident" id="5303222">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5303238">return</span>&nbsp;<span class="ident" id="5303245">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5303259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5303262">//&nbsp;numbers</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5303274">return</span>&nbsp;<span class="ident" id="5303281">s</span><span class="op" id="5303282">.</span><span class="builtintype" id="5303283">error</span><span class="op" id="5303288">(</span><span class="ident" id="5303289">c</span><span class="op" id="5303290">,</span>&nbsp;<span class="string" id="5303292">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="5303329">)</span><br>
<span class="lineno"></span><span class="op" id="5303331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5303334">//&nbsp;stateNeg&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`-`&nbsp;during&nbsp;a&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="5303394">func</span>&nbsp;<span class="ident" id="5303399">stateNeg</span><span class="op" id="5303407">(</span><span class="ident" id="5303408">s</span>&nbsp;<span class="op" id="5303410">*</span><span class="ident" id="5303411">scanner</span><span class="op" id="5303418">,</span>&nbsp;<span class="ident" id="5303420">c</span>&nbsp;<span class="builtintype" id="5303422">int</span><span class="op" id="5303425">)</span>&nbsp;<span class="builtintype" id="5303427">int</span>&nbsp;<span class="op" id="5303431">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5303434">if</span>&nbsp;<span class="ident" id="5303437">c</span>&nbsp;<span class="op" id="5303439">==</span>&nbsp;<span class="string" id="5303442">&#39;0&#39;</span>&nbsp;<span class="op" id="5303446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5303450">s</span><span class="op" id="5303451">.</span><span class="ident" id="5303452">step</span>&nbsp;<span class="op" id="5303457">=</span>&nbsp;<span class="ident" id="5303459">state0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5303468">return</span>&nbsp;<span class="ident" id="5303475">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5303489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5303492">if</span>&nbsp;<span class="string" id="5303495">&#39;1&#39;</span>&nbsp;<span class="op" id="5303499">&lt;=</span>&nbsp;<span class="ident" id="5303502">c</span>&nbsp;<span class="op" id="5303504">&amp;&amp;</span>&nbsp;<span class="ident" id="5303507">c</span>&nbsp;<span class="op" id="5303509">&lt;=</span>&nbsp;<span class="string" id="5303512">&#39;9&#39;</span>&nbsp;<span class="op" id="5303516">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5303520">s</span><span class="op" id="5303521">.</span><span class="ident" id="5303522">step</span>&nbsp;<span class="op" id="5303527">=</span>&nbsp;<span class="ident" id="5303529">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5303538">return</span>&nbsp;<span class="ident" id="5303545">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5303559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5303562">return</span>&nbsp;<span class="ident" id="5303569">s</span><span class="op" id="5303570">.</span><span class="builtintype" id="5303571">error</span><span class="op" id="5303576">(</span><span class="ident" id="5303577">c</span><span class="op" id="5303578">,</span>&nbsp;<span class="string" id="5303580">&#34;in&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="5303600">)</span><br>
<span class="lineno"></span><span class="op" id="5303602">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="comment" id="5303605">//&nbsp;state1&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;a&nbsp;non-zero&nbsp;integer&nbsp;during&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="5303678">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`1`&nbsp;or&nbsp;`100`&nbsp;but&nbsp;not&nbsp;`0`.</span><br>
<span class="lineno"></span><span class="keyword" id="5303729">func</span>&nbsp;<span class="ident" id="5303734">state1</span><span class="op" id="5303740">(</span><span class="ident" id="5303741">s</span>&nbsp;<span class="op" id="5303743">*</span><span class="ident" id="5303744">scanner</span><span class="op" id="5303751">,</span>&nbsp;<span class="ident" id="5303753">c</span>&nbsp;<span class="builtintype" id="5303755">int</span><span class="op" id="5303758">)</span>&nbsp;<span class="builtintype" id="5303760">int</span>&nbsp;<span class="op" id="5303764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5303767">if</span>&nbsp;<span class="string" id="5303770">&#39;0&#39;</span>&nbsp;<span class="op" id="5303774">&lt;=</span>&nbsp;<span class="ident" id="5303777">c</span>&nbsp;<span class="op" id="5303779">&amp;&amp;</span>&nbsp;<span class="ident" id="5303782">c</span>&nbsp;<span class="op" id="5303784">&lt;=</span>&nbsp;<span class="string" id="5303787">&#39;9&#39;</span>&nbsp;<span class="op" id="5303791">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5303795">s</span><span class="op" id="5303796">.</span><span class="ident" id="5303797">step</span>&nbsp;<span class="op" id="5303802">=</span>&nbsp;<span class="ident" id="5303804">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5303813">return</span>&nbsp;<span class="ident" id="5303820">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5303834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5303837">return</span>&nbsp;<span class="ident" id="5303844">state0</span><span class="op" id="5303850">(</span><span class="ident" id="5303851">s</span><span class="op" id="5303852">,</span>&nbsp;<span class="ident" id="5303854">c</span><span class="op" id="5303855">)</span><br>
<span class="lineno"></span><span class="op" id="5303857">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="comment" id="5303860">//&nbsp;state0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`0`&nbsp;during&nbsp;a&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="5303918">func</span>&nbsp;<span class="ident" id="5303923">state0</span><span class="op" id="5303929">(</span><span class="ident" id="5303930">s</span>&nbsp;<span class="op" id="5303932">*</span><span class="ident" id="5303933">scanner</span><span class="op" id="5303940">,</span>&nbsp;<span class="ident" id="5303942">c</span>&nbsp;<span class="builtintype" id="5303944">int</span><span class="op" id="5303947">)</span>&nbsp;<span class="builtintype" id="5303949">int</span>&nbsp;<span class="op" id="5303953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5303956">if</span>&nbsp;<span class="ident" id="5303959">c</span>&nbsp;<span class="op" id="5303961">==</span>&nbsp;<span class="string" id="5303964">&#39;.&#39;</span>&nbsp;<span class="op" id="5303968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5303972">s</span><span class="op" id="5303973">.</span><span class="ident" id="5303974">step</span>&nbsp;<span class="op" id="5303979">=</span>&nbsp;<span class="ident" id="5303981">stateDot</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5303992">return</span>&nbsp;<span class="ident" id="5303999">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5304013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5304016">if</span>&nbsp;<span class="ident" id="5304019">c</span>&nbsp;<span class="op" id="5304021">==</span>&nbsp;<span class="string" id="5304024">&#39;e&#39;</span>&nbsp;<span class="op" id="5304028">||</span>&nbsp;<span class="ident" id="5304031">c</span>&nbsp;<span class="op" id="5304033">==</span>&nbsp;<span class="string" id="5304036">&#39;E&#39;</span>&nbsp;<span class="op" id="5304040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5304044">s</span><span class="op" id="5304045">.</span><span class="ident" id="5304046">step</span>&nbsp;<span class="op" id="5304051">=</span>&nbsp;<span class="ident" id="5304053">stateE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5304062">return</span>&nbsp;<span class="ident" id="5304069">scanContinue</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5304083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5304086">return</span>&nbsp;<span class="ident" id="5304093">stateEndValue</span><span class="op" id="5304106">(</span><span class="ident" id="5304107">s</span><span class="op" id="5304108">,</span>&nbsp;<span class="ident" id="5304110">c</span><span class="op" id="5304111">)</span><br>
<span class="lineno"></span><span class="op" id="5304113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5304116">//&nbsp;stateDot&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;integer&nbsp;and&nbsp;decimal&nbsp;point&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno">430</span><span class="comment" id="5304198">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`1.`.</span><br>
<span class="lineno"></span><span class="keyword" id="5304229">func</span>&nbsp;<span class="ident" id="5304234">stateDot</span><span class="op" id="5304242">(</span><span class="ident" id="5304243">s</span>&nbsp;<span class="op" id="5304245">*</span><span class="ident" id="5304246">scanner</span><span class="op" id="5304253">,</span>&nbsp;<span class="ident" id="5304255">c</span>&nbsp;<span class="builtintype" id="5304257">int</span><span class="op" id="5304260">)</span>&nbsp;<span class="builtintype" id="5304262">int</span>&nbsp;<span class="op" id="5304266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5304269">if</span>&nbsp;<span class="string" id="5304272">&#39;0&#39;</span>&nbsp;<span class="op" id="5304276">&lt;=</span>&nbsp;<span class="ident" id="5304279">c</span>&nbsp;<span class="op" id="5304281">&amp;&amp;</span>&nbsp;<span class="ident" id="5304284">c</span>&nbsp;<span class="op" id="5304286">&lt;=</span>&nbsp;<span class="string" id="5304289">&#39;9&#39;</span>&nbsp;<span class="op" id="5304293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5304297">s</span><span class="op" id="5304298">.</span><span class="ident" id="5304299">step</span>&nbsp;<span class="op" id="5304304">=</span>&nbsp;<span class="ident" id="5304306">stateDot0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5304318">return</span>&nbsp;<span class="ident" id="5304325">scanContinue</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5304339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5304342">return</span>&nbsp;<span class="ident" id="5304349">s</span><span class="op" id="5304350">.</span><span class="builtintype" id="5304351">error</span><span class="op" id="5304356">(</span><span class="ident" id="5304357">c</span><span class="op" id="5304358">,</span>&nbsp;<span class="string" id="5304360">&#34;after&nbsp;decimal&nbsp;point&nbsp;in&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="5304400">)</span><br>
<span class="lineno"></span><span class="op" id="5304402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5304405">//&nbsp;stateDot0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;integer,&nbsp;decimal&nbsp;point,&nbsp;and&nbsp;subsequent</span><br>
<span class="lineno">440</span><span class="comment" id="5304488">//&nbsp;digits&nbsp;of&nbsp;a&nbsp;number,&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`3.14`.</span><br>
<span class="lineno"></span><span class="keyword" id="5304541">func</span>&nbsp;<span class="ident" id="5304546">stateDot0</span><span class="op" id="5304555">(</span><span class="ident" id="5304556">s</span>&nbsp;<span class="op" id="5304558">*</span><span class="ident" id="5304559">scanner</span><span class="op" id="5304566">,</span>&nbsp;<span class="ident" id="5304568">c</span>&nbsp;<span class="builtintype" id="5304570">int</span><span class="op" id="5304573">)</span>&nbsp;<span class="builtintype" id="5304575">int</span>&nbsp;<span class="op" id="5304579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5304582">if</span>&nbsp;<span class="string" id="5304585">&#39;0&#39;</span>&nbsp;<span class="op" id="5304589">&lt;=</span>&nbsp;<span class="ident" id="5304592">c</span>&nbsp;<span class="op" id="5304594">&amp;&amp;</span>&nbsp;<span class="ident" id="5304597">c</span>&nbsp;<span class="op" id="5304599">&lt;=</span>&nbsp;<span class="string" id="5304602">&#39;9&#39;</span>&nbsp;<span class="op" id="5304606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5304610">s</span><span class="op" id="5304611">.</span><span class="ident" id="5304612">step</span>&nbsp;<span class="op" id="5304617">=</span>&nbsp;<span class="ident" id="5304619">stateDot0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5304631">return</span>&nbsp;<span class="ident" id="5304638">scanContinue</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5304652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5304655">if</span>&nbsp;<span class="ident" id="5304658">c</span>&nbsp;<span class="op" id="5304660">==</span>&nbsp;<span class="string" id="5304663">&#39;e&#39;</span>&nbsp;<span class="op" id="5304667">||</span>&nbsp;<span class="ident" id="5304670">c</span>&nbsp;<span class="op" id="5304672">==</span>&nbsp;<span class="string" id="5304675">&#39;E&#39;</span>&nbsp;<span class="op" id="5304679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5304683">s</span><span class="op" id="5304684">.</span><span class="ident" id="5304685">step</span>&nbsp;<span class="op" id="5304690">=</span>&nbsp;<span class="ident" id="5304692">stateE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5304701">return</span>&nbsp;<span class="ident" id="5304708">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5304722">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5304725">return</span>&nbsp;<span class="ident" id="5304732">stateEndValue</span><span class="op" id="5304745">(</span><span class="ident" id="5304746">s</span><span class="op" id="5304747">,</span>&nbsp;<span class="ident" id="5304749">c</span><span class="op" id="5304750">)</span><br>
<span class="lineno"></span><span class="op" id="5304752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5304755">//&nbsp;stateE&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa&nbsp;and&nbsp;e&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="5304824">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e`&nbsp;or&nbsp;`0.314e`.</span><br>
<span class="lineno">455</span><span class="keyword" id="5304869">func</span>&nbsp;<span class="ident" id="5304874">stateE</span><span class="op" id="5304880">(</span><span class="ident" id="5304881">s</span>&nbsp;<span class="op" id="5304883">*</span><span class="ident" id="5304884">scanner</span><span class="op" id="5304891">,</span>&nbsp;<span class="ident" id="5304893">c</span>&nbsp;<span class="builtintype" id="5304895">int</span><span class="op" id="5304898">)</span>&nbsp;<span class="builtintype" id="5304900">int</span>&nbsp;<span class="op" id="5304904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5304907">if</span>&nbsp;<span class="ident" id="5304910">c</span>&nbsp;<span class="op" id="5304912">==</span>&nbsp;<span class="string" id="5304915">&#39;+&#39;</span>&nbsp;<span class="op" id="5304919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5304923">s</span><span class="op" id="5304924">.</span><span class="ident" id="5304925">step</span>&nbsp;<span class="op" id="5304930">=</span>&nbsp;<span class="ident" id="5304932">stateESign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5304945">return</span>&nbsp;<span class="ident" id="5304952">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5304966">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5304969">if</span>&nbsp;<span class="ident" id="5304972">c</span>&nbsp;<span class="op" id="5304974">==</span>&nbsp;<span class="string" id="5304977">&#39;-&#39;</span>&nbsp;<span class="op" id="5304981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5304985">s</span><span class="op" id="5304986">.</span><span class="ident" id="5304987">step</span>&nbsp;<span class="op" id="5304992">=</span>&nbsp;<span class="ident" id="5304994">stateESign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5305007">return</span>&nbsp;<span class="ident" id="5305014">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5305028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5305031">return</span>&nbsp;<span class="ident" id="5305038">stateESign</span><span class="op" id="5305048">(</span><span class="ident" id="5305049">s</span><span class="op" id="5305050">,</span>&nbsp;<span class="ident" id="5305052">c</span><span class="op" id="5305053">)</span><br>
<span class="lineno">465</span><span class="op" id="5305055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5305058">//&nbsp;stateESign&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa,&nbsp;e,&nbsp;and&nbsp;sign&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="5305138">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e-`&nbsp;or&nbsp;`0.314e+`.</span><br>
<span class="lineno"></span><span class="keyword" id="5305185">func</span>&nbsp;<span class="ident" id="5305190">stateESign</span><span class="op" id="5305200">(</span><span class="ident" id="5305201">s</span>&nbsp;<span class="op" id="5305203">*</span><span class="ident" id="5305204">scanner</span><span class="op" id="5305211">,</span>&nbsp;<span class="ident" id="5305213">c</span>&nbsp;<span class="builtintype" id="5305215">int</span><span class="op" id="5305218">)</span>&nbsp;<span class="builtintype" id="5305220">int</span>&nbsp;<span class="op" id="5305224">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5305227">if</span>&nbsp;<span class="string" id="5305230">&#39;0&#39;</span>&nbsp;<span class="op" id="5305234">&lt;=</span>&nbsp;<span class="ident" id="5305237">c</span>&nbsp;<span class="op" id="5305239">&amp;&amp;</span>&nbsp;<span class="ident" id="5305242">c</span>&nbsp;<span class="op" id="5305244">&lt;=</span>&nbsp;<span class="string" id="5305247">&#39;9&#39;</span>&nbsp;<span class="op" id="5305251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5305255">s</span><span class="op" id="5305256">.</span><span class="ident" id="5305257">step</span>&nbsp;<span class="op" id="5305262">=</span>&nbsp;<span class="ident" id="5305264">stateE0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5305274">return</span>&nbsp;<span class="ident" id="5305281">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5305295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5305298">return</span>&nbsp;<span class="ident" id="5305305">s</span><span class="op" id="5305306">.</span><span class="builtintype" id="5305307">error</span><span class="op" id="5305312">(</span><span class="ident" id="5305313">c</span><span class="op" id="5305314">,</span>&nbsp;<span class="string" id="5305316">&#34;in&nbsp;exponent&nbsp;of&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="5305348">)</span><br>
<span class="lineno">475</span><span class="op" id="5305350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5305353">//&nbsp;stateE0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa,&nbsp;e,&nbsp;optional&nbsp;sign,</span><br>
<span class="lineno"></span><span class="comment" id="5305423">//&nbsp;and&nbsp;at&nbsp;least&nbsp;one&nbsp;digit&nbsp;of&nbsp;the&nbsp;exponent&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="5305478">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e-2`&nbsp;or&nbsp;`0.314e+1`&nbsp;or&nbsp;`3.14e0`.</span><br>
<span class="lineno">480</span><span class="keyword" id="5305539">func</span>&nbsp;<span class="ident" id="5305544">stateE0</span><span class="op" id="5305551">(</span><span class="ident" id="5305552">s</span>&nbsp;<span class="op" id="5305554">*</span><span class="ident" id="5305555">scanner</span><span class="op" id="5305562">,</span>&nbsp;<span class="ident" id="5305564">c</span>&nbsp;<span class="builtintype" id="5305566">int</span><span class="op" id="5305569">)</span>&nbsp;<span class="builtintype" id="5305571">int</span>&nbsp;<span class="op" id="5305575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5305578">if</span>&nbsp;<span class="string" id="5305581">&#39;0&#39;</span>&nbsp;<span class="op" id="5305585">&lt;=</span>&nbsp;<span class="ident" id="5305588">c</span>&nbsp;<span class="op" id="5305590">&amp;&amp;</span>&nbsp;<span class="ident" id="5305593">c</span>&nbsp;<span class="op" id="5305595">&lt;=</span>&nbsp;<span class="string" id="5305598">&#39;9&#39;</span>&nbsp;<span class="op" id="5305602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5305606">s</span><span class="op" id="5305607">.</span><span class="ident" id="5305608">step</span>&nbsp;<span class="op" id="5305613">=</span>&nbsp;<span class="ident" id="5305615">stateE0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5305625">return</span>&nbsp;<span class="ident" id="5305632">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5305646">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5305649">return</span>&nbsp;<span class="ident" id="5305656">stateEndValue</span><span class="op" id="5305669">(</span><span class="ident" id="5305670">s</span><span class="op" id="5305671">,</span>&nbsp;<span class="ident" id="5305673">c</span><span class="op" id="5305674">)</span><br>
<span class="lineno"></span><span class="op" id="5305676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5305679">//&nbsp;stateT&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`t`.</span><br>
<span class="lineno"></span><span class="keyword" id="5305721">func</span>&nbsp;<span class="ident" id="5305726">stateT</span><span class="op" id="5305732">(</span><span class="ident" id="5305733">s</span>&nbsp;<span class="op" id="5305735">*</span><span class="ident" id="5305736">scanner</span><span class="op" id="5305743">,</span>&nbsp;<span class="ident" id="5305745">c</span>&nbsp;<span class="builtintype" id="5305747">int</span><span class="op" id="5305750">)</span>&nbsp;<span class="builtintype" id="5305752">int</span>&nbsp;<span class="op" id="5305756">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5305759">if</span>&nbsp;<span class="ident" id="5305762">c</span>&nbsp;<span class="op" id="5305764">==</span>&nbsp;<span class="string" id="5305767">&#39;r&#39;</span>&nbsp;<span class="op" id="5305771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5305775">s</span><span class="op" id="5305776">.</span><span class="ident" id="5305777">step</span>&nbsp;<span class="op" id="5305782">=</span>&nbsp;<span class="ident" id="5305784">stateTr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5305794">return</span>&nbsp;<span class="ident" id="5305801">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5305815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5305818">return</span>&nbsp;<span class="ident" id="5305825">s</span><span class="op" id="5305826">.</span><span class="builtintype" id="5305827">error</span><span class="op" id="5305832">(</span><span class="ident" id="5305833">c</span><span class="op" id="5305834">,</span>&nbsp;<span class="string" id="5305836">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;r&#39;)&#34;</span><span class="op" id="5305869">)</span><br>
<span class="lineno">495</span><span class="op" id="5305871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5305874">//&nbsp;stateTr&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`tr`.</span><br>
<span class="lineno"></span><span class="keyword" id="5305918">func</span>&nbsp;<span class="ident" id="5305923">stateTr</span><span class="op" id="5305930">(</span><span class="ident" id="5305931">s</span>&nbsp;<span class="op" id="5305933">*</span><span class="ident" id="5305934">scanner</span><span class="op" id="5305941">,</span>&nbsp;<span class="ident" id="5305943">c</span>&nbsp;<span class="builtintype" id="5305945">int</span><span class="op" id="5305948">)</span>&nbsp;<span class="builtintype" id="5305950">int</span>&nbsp;<span class="op" id="5305954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5305957">if</span>&nbsp;<span class="ident" id="5305960">c</span>&nbsp;<span class="op" id="5305962">==</span>&nbsp;<span class="string" id="5305965">&#39;u&#39;</span>&nbsp;<span class="op" id="5305969">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5305973">s</span><span class="op" id="5305974">.</span><span class="ident" id="5305975">step</span>&nbsp;<span class="op" id="5305980">=</span>&nbsp;<span class="ident" id="5305982">stateTru</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5305993">return</span>&nbsp;<span class="ident" id="5306000">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5306014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5306017">return</span>&nbsp;<span class="ident" id="5306024">s</span><span class="op" id="5306025">.</span><span class="builtintype" id="5306026">error</span><span class="op" id="5306031">(</span><span class="ident" id="5306032">c</span><span class="op" id="5306033">,</span>&nbsp;<span class="string" id="5306035">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;u&#39;)&#34;</span><span class="op" id="5306068">)</span><br>
<span class="lineno"></span><span class="op" id="5306070">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="5306073">//&nbsp;stateTru&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`tru`.</span><br>
<span class="lineno"></span><span class="keyword" id="5306119">func</span>&nbsp;<span class="ident" id="5306124">stateTru</span><span class="op" id="5306132">(</span><span class="ident" id="5306133">s</span>&nbsp;<span class="op" id="5306135">*</span><span class="ident" id="5306136">scanner</span><span class="op" id="5306143">,</span>&nbsp;<span class="ident" id="5306145">c</span>&nbsp;<span class="builtintype" id="5306147">int</span><span class="op" id="5306150">)</span>&nbsp;<span class="builtintype" id="5306152">int</span>&nbsp;<span class="op" id="5306156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5306159">if</span>&nbsp;<span class="ident" id="5306162">c</span>&nbsp;<span class="op" id="5306164">==</span>&nbsp;<span class="string" id="5306167">&#39;e&#39;</span>&nbsp;<span class="op" id="5306171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5306175">s</span><span class="op" id="5306176">.</span><span class="ident" id="5306177">step</span>&nbsp;<span class="op" id="5306182">=</span>&nbsp;<span class="ident" id="5306184">stateEndValue</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5306200">return</span>&nbsp;<span class="ident" id="5306207">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5306221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5306224">return</span>&nbsp;<span class="ident" id="5306231">s</span><span class="op" id="5306232">.</span><span class="builtintype" id="5306233">error</span><span class="op" id="5306238">(</span><span class="ident" id="5306239">c</span><span class="op" id="5306240">,</span>&nbsp;<span class="string" id="5306242">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;e&#39;)&#34;</span><span class="op" id="5306275">)</span><br>
<span class="lineno"></span><span class="op" id="5306277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="comment" id="5306280">//&nbsp;stateF&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`f`.</span><br>
<span class="lineno"></span><span class="keyword" id="5306322">func</span>&nbsp;<span class="ident" id="5306327">stateF</span><span class="op" id="5306333">(</span><span class="ident" id="5306334">s</span>&nbsp;<span class="op" id="5306336">*</span><span class="ident" id="5306337">scanner</span><span class="op" id="5306344">,</span>&nbsp;<span class="ident" id="5306346">c</span>&nbsp;<span class="builtintype" id="5306348">int</span><span class="op" id="5306351">)</span>&nbsp;<span class="builtintype" id="5306353">int</span>&nbsp;<span class="op" id="5306357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5306360">if</span>&nbsp;<span class="ident" id="5306363">c</span>&nbsp;<span class="op" id="5306365">==</span>&nbsp;<span class="string" id="5306368">&#39;a&#39;</span>&nbsp;<span class="op" id="5306372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5306376">s</span><span class="op" id="5306377">.</span><span class="ident" id="5306378">step</span>&nbsp;<span class="op" id="5306383">=</span>&nbsp;<span class="ident" id="5306385">stateFa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5306395">return</span>&nbsp;<span class="ident" id="5306402">scanContinue</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5306416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5306419">return</span>&nbsp;<span class="ident" id="5306426">s</span><span class="op" id="5306427">.</span><span class="builtintype" id="5306428">error</span><span class="op" id="5306433">(</span><span class="ident" id="5306434">c</span><span class="op" id="5306435">,</span>&nbsp;<span class="string" id="5306437">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;a&#39;)&#34;</span><span class="op" id="5306471">)</span><br>
<span class="lineno"></span><span class="op" id="5306473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5306476">//&nbsp;stateFa&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fa`.</span><br>
<span class="lineno">525</span><span class="keyword" id="5306520">func</span>&nbsp;<span class="ident" id="5306525">stateFa</span><span class="op" id="5306532">(</span><span class="ident" id="5306533">s</span>&nbsp;<span class="op" id="5306535">*</span><span class="ident" id="5306536">scanner</span><span class="op" id="5306543">,</span>&nbsp;<span class="ident" id="5306545">c</span>&nbsp;<span class="builtintype" id="5306547">int</span><span class="op" id="5306550">)</span>&nbsp;<span class="builtintype" id="5306552">int</span>&nbsp;<span class="op" id="5306556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5306559">if</span>&nbsp;<span class="ident" id="5306562">c</span>&nbsp;<span class="op" id="5306564">==</span>&nbsp;<span class="string" id="5306567">&#39;l&#39;</span>&nbsp;<span class="op" id="5306571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5306575">s</span><span class="op" id="5306576">.</span><span class="ident" id="5306577">step</span>&nbsp;<span class="op" id="5306582">=</span>&nbsp;<span class="ident" id="5306584">stateFal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5306595">return</span>&nbsp;<span class="ident" id="5306602">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5306616">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5306619">return</span>&nbsp;<span class="ident" id="5306626">s</span><span class="op" id="5306627">.</span><span class="builtintype" id="5306628">error</span><span class="op" id="5306633">(</span><span class="ident" id="5306634">c</span><span class="op" id="5306635">,</span>&nbsp;<span class="string" id="5306637">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="5306671">)</span><br>
<span class="lineno"></span><span class="op" id="5306673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5306676">//&nbsp;stateFal&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fal`.</span><br>
<span class="lineno"></span><span class="keyword" id="5306722">func</span>&nbsp;<span class="ident" id="5306727">stateFal</span><span class="op" id="5306735">(</span><span class="ident" id="5306736">s</span>&nbsp;<span class="op" id="5306738">*</span><span class="ident" id="5306739">scanner</span><span class="op" id="5306746">,</span>&nbsp;<span class="ident" id="5306748">c</span>&nbsp;<span class="builtintype" id="5306750">int</span><span class="op" id="5306753">)</span>&nbsp;<span class="builtintype" id="5306755">int</span>&nbsp;<span class="op" id="5306759">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5306762">if</span>&nbsp;<span class="ident" id="5306765">c</span>&nbsp;<span class="op" id="5306767">==</span>&nbsp;<span class="string" id="5306770">&#39;s&#39;</span>&nbsp;<span class="op" id="5306774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5306778">s</span><span class="op" id="5306779">.</span><span class="ident" id="5306780">step</span>&nbsp;<span class="op" id="5306785">=</span>&nbsp;<span class="ident" id="5306787">stateFals</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5306799">return</span>&nbsp;<span class="ident" id="5306806">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5306820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5306823">return</span>&nbsp;<span class="ident" id="5306830">s</span><span class="op" id="5306831">.</span><span class="builtintype" id="5306832">error</span><span class="op" id="5306837">(</span><span class="ident" id="5306838">c</span><span class="op" id="5306839">,</span>&nbsp;<span class="string" id="5306841">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;s&#39;)&#34;</span><span class="op" id="5306875">)</span><br>
<span class="lineno">540</span><span class="op" id="5306877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5306880">//&nbsp;stateFals&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fals`.</span><br>
<span class="lineno"></span><span class="keyword" id="5306928">func</span>&nbsp;<span class="ident" id="5306933">stateFals</span><span class="op" id="5306942">(</span><span class="ident" id="5306943">s</span>&nbsp;<span class="op" id="5306945">*</span><span class="ident" id="5306946">scanner</span><span class="op" id="5306953">,</span>&nbsp;<span class="ident" id="5306955">c</span>&nbsp;<span class="builtintype" id="5306957">int</span><span class="op" id="5306960">)</span>&nbsp;<span class="builtintype" id="5306962">int</span>&nbsp;<span class="op" id="5306966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5306969">if</span>&nbsp;<span class="ident" id="5306972">c</span>&nbsp;<span class="op" id="5306974">==</span>&nbsp;<span class="string" id="5306977">&#39;e&#39;</span>&nbsp;<span class="op" id="5306981">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5306985">s</span><span class="op" id="5306986">.</span><span class="ident" id="5306987">step</span>&nbsp;<span class="op" id="5306992">=</span>&nbsp;<span class="ident" id="5306994">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5307010">return</span>&nbsp;<span class="ident" id="5307017">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5307031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5307034">return</span>&nbsp;<span class="ident" id="5307041">s</span><span class="op" id="5307042">.</span><span class="builtintype" id="5307043">error</span><span class="op" id="5307048">(</span><span class="ident" id="5307049">c</span><span class="op" id="5307050">,</span>&nbsp;<span class="string" id="5307052">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;e&#39;)&#34;</span><span class="op" id="5307086">)</span><br>
<span class="lineno"></span><span class="op" id="5307088">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span><span class="comment" id="5307091">//&nbsp;stateN&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`n`.</span><br>
<span class="lineno"></span><span class="keyword" id="5307133">func</span>&nbsp;<span class="ident" id="5307138">stateN</span><span class="op" id="5307144">(</span><span class="ident" id="5307145">s</span>&nbsp;<span class="op" id="5307147">*</span><span class="ident" id="5307148">scanner</span><span class="op" id="5307155">,</span>&nbsp;<span class="ident" id="5307157">c</span>&nbsp;<span class="builtintype" id="5307159">int</span><span class="op" id="5307162">)</span>&nbsp;<span class="builtintype" id="5307164">int</span>&nbsp;<span class="op" id="5307168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5307171">if</span>&nbsp;<span class="ident" id="5307174">c</span>&nbsp;<span class="op" id="5307176">==</span>&nbsp;<span class="string" id="5307179">&#39;u&#39;</span>&nbsp;<span class="op" id="5307183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5307187">s</span><span class="op" id="5307188">.</span><span class="ident" id="5307189">step</span>&nbsp;<span class="op" id="5307194">=</span>&nbsp;<span class="ident" id="5307196">stateNu</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5307206">return</span>&nbsp;<span class="ident" id="5307213">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5307227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5307230">return</span>&nbsp;<span class="ident" id="5307237">s</span><span class="op" id="5307238">.</span><span class="builtintype" id="5307239">error</span><span class="op" id="5307244">(</span><span class="ident" id="5307245">c</span><span class="op" id="5307246">,</span>&nbsp;<span class="string" id="5307248">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;u&#39;)&#34;</span><span class="op" id="5307281">)</span><br>
<span class="lineno"></span><span class="op" id="5307283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="comment" id="5307286">//&nbsp;stateNu&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`nu`.</span><br>
<span class="lineno"></span><span class="keyword" id="5307330">func</span>&nbsp;<span class="ident" id="5307335">stateNu</span><span class="op" id="5307342">(</span><span class="ident" id="5307343">s</span>&nbsp;<span class="op" id="5307345">*</span><span class="ident" id="5307346">scanner</span><span class="op" id="5307353">,</span>&nbsp;<span class="ident" id="5307355">c</span>&nbsp;<span class="builtintype" id="5307357">int</span><span class="op" id="5307360">)</span>&nbsp;<span class="builtintype" id="5307362">int</span>&nbsp;<span class="op" id="5307366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5307369">if</span>&nbsp;<span class="ident" id="5307372">c</span>&nbsp;<span class="op" id="5307374">==</span>&nbsp;<span class="string" id="5307377">&#39;l&#39;</span>&nbsp;<span class="op" id="5307381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5307385">s</span><span class="op" id="5307386">.</span><span class="ident" id="5307387">step</span>&nbsp;<span class="op" id="5307392">=</span>&nbsp;<span class="ident" id="5307394">stateNul</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5307405">return</span>&nbsp;<span class="ident" id="5307412">scanContinue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5307426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5307429">return</span>&nbsp;<span class="ident" id="5307436">s</span><span class="op" id="5307437">.</span><span class="builtintype" id="5307438">error</span><span class="op" id="5307443">(</span><span class="ident" id="5307444">c</span><span class="op" id="5307445">,</span>&nbsp;<span class="string" id="5307447">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="5307480">)</span><br>
<span class="lineno"></span><span class="op" id="5307482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5307485">//&nbsp;stateNul&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`nul`.</span><br>
<span class="lineno">570</span><span class="keyword" id="5307531">func</span>&nbsp;<span class="ident" id="5307536">stateNul</span><span class="op" id="5307544">(</span><span class="ident" id="5307545">s</span>&nbsp;<span class="op" id="5307547">*</span><span class="ident" id="5307548">scanner</span><span class="op" id="5307555">,</span>&nbsp;<span class="ident" id="5307557">c</span>&nbsp;<span class="builtintype" id="5307559">int</span><span class="op" id="5307562">)</span>&nbsp;<span class="builtintype" id="5307564">int</span>&nbsp;<span class="op" id="5307568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5307571">if</span>&nbsp;<span class="ident" id="5307574">c</span>&nbsp;<span class="op" id="5307576">==</span>&nbsp;<span class="string" id="5307579">&#39;l&#39;</span>&nbsp;<span class="op" id="5307583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5307587">s</span><span class="op" id="5307588">.</span><span class="ident" id="5307589">step</span>&nbsp;<span class="op" id="5307594">=</span>&nbsp;<span class="ident" id="5307596">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5307612">return</span>&nbsp;<span class="ident" id="5307619">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5307633">}</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5307636">return</span>&nbsp;<span class="ident" id="5307643">s</span><span class="op" id="5307644">.</span><span class="builtintype" id="5307645">error</span><span class="op" id="5307650">(</span><span class="ident" id="5307651">c</span><span class="op" id="5307652">,</span>&nbsp;<span class="string" id="5307654">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="5307687">)</span><br>
<span class="lineno"></span><span class="op" id="5307689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5307692">//&nbsp;stateError&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reaching&nbsp;a&nbsp;syntax&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="5307750">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`[1}`&nbsp;or&nbsp;`5.1.2`.</span><br>
<span class="lineno">580</span><span class="keyword" id="5307793">func</span>&nbsp;<span class="ident" id="5307798">stateError</span><span class="op" id="5307808">(</span><span class="ident" id="5307809">s</span>&nbsp;<span class="op" id="5307811">*</span><span class="ident" id="5307812">scanner</span><span class="op" id="5307819">,</span>&nbsp;<span class="ident" id="5307821">c</span>&nbsp;<span class="builtintype" id="5307823">int</span><span class="op" id="5307826">)</span>&nbsp;<span class="builtintype" id="5307828">int</span>&nbsp;<span class="op" id="5307832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5307835">return</span>&nbsp;<span class="ident" id="5307842">scanError</span><br>
<span class="lineno"></span><span class="op" id="5307852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5307855">//&nbsp;error&nbsp;records&nbsp;an&nbsp;error&nbsp;and&nbsp;switches&nbsp;to&nbsp;the&nbsp;error&nbsp;state.</span><br>
<span class="lineno">585</span><span class="keyword" id="5307914">func</span>&nbsp;<span class="op" id="5307919">(</span><span class="ident" id="5307920">s</span>&nbsp;<span class="op" id="5307922">*</span><span class="ident" id="5307923">scanner</span><span class="op" id="5307930">)</span>&nbsp;<span class="builtintype" id="5307932">error</span><span class="op" id="5307937">(</span><span class="ident" id="5307938">c</span>&nbsp;<span class="builtintype" id="5307940">int</span><span class="op" id="5307943">,</span>&nbsp;<span class="ident" id="5307945">context</span>&nbsp;<span class="builtintype" id="5307953">string</span><span class="op" id="5307959">)</span>&nbsp;<span class="builtintype" id="5307961">int</span>&nbsp;<span class="op" id="5307965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5307968">s</span><span class="op" id="5307969">.</span><span class="ident" id="5307970">step</span>&nbsp;<span class="op" id="5307975">=</span>&nbsp;<span class="ident" id="5307977">stateError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5307989">s</span><span class="op" id="5307990">.</span><span class="ident" id="5307991">err</span>&nbsp;<span class="op" id="5307995">=</span>&nbsp;<span class="op" id="5307997">&amp;</span><span class="ident" id="5307998">SyntaxError</span><span class="op" id="5308009">{</span><span class="string" id="5308010">&#34;invalid&nbsp;character&nbsp;&#34;</span>&nbsp;<span class="op" id="5308031">+</span>&nbsp;<span class="ident" id="5308033">quoteChar</span><span class="op" id="5308042">(</span><span class="ident" id="5308043">c</span><span class="op" id="5308044">)</span>&nbsp;<span class="op" id="5308046">+</span>&nbsp;<span class="string" id="5308048">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="5308052">+</span>&nbsp;<span class="ident" id="5308054">context</span><span class="op" id="5308061">,</span>&nbsp;<span class="ident" id="5308063">s</span><span class="op" id="5308064">.</span><span class="ident" id="5308065">bytes</span><span class="op" id="5308070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308073">return</span>&nbsp;<span class="ident" id="5308080">scanError</span><br>
<span class="lineno"></span><span class="op" id="5308090">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="5308093">//&nbsp;quoteChar&nbsp;formats&nbsp;c&nbsp;as&nbsp;a&nbsp;quoted&nbsp;character&nbsp;literal</span><br>
<span class="lineno"></span><span class="keyword" id="5308146">func</span>&nbsp;<span class="ident" id="5308151">quoteChar</span><span class="op" id="5308160">(</span><span class="ident" id="5308161">c</span>&nbsp;<span class="builtintype" id="5308163">int</span><span class="op" id="5308166">)</span>&nbsp;<span class="builtintype" id="5308168">string</span>&nbsp;<span class="op" id="5308175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5308178">//&nbsp;special&nbsp;cases&nbsp;-&nbsp;different&nbsp;from&nbsp;quoted&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308228">if</span>&nbsp;<span class="ident" id="5308231">c</span>&nbsp;<span class="op" id="5308233">==</span>&nbsp;<span class="string" id="5308236">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="5308241">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308245">return</span>&nbsp;<span class="string" id="5308252">`&#39;\&#39;&#39;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5308260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308263">if</span>&nbsp;<span class="ident" id="5308266">c</span>&nbsp;<span class="op" id="5308268">==</span>&nbsp;<span class="string" id="5308271">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5308275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308279">return</span>&nbsp;<span class="string" id="5308286">`&#39;&#34;&#39;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5308293">}</span><br>
<span class="lineno">600</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5308297">//&nbsp;use&nbsp;quoted&nbsp;string&nbsp;with&nbsp;different&nbsp;quotation&nbsp;marks</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5308350">s</span>&nbsp;<span class="op" id="5308352">:=</span>&nbsp;<span class="ident" id="5308355">strconv</span><span class="op" id="5308362">.</span><span class="ident" id="5308363">Quote</span><span class="op" id="5308368">(</span><span class="builtintype" id="5308369">string</span><span class="op" id="5308375">(</span><span class="ident" id="5308376">c</span><span class="op" id="5308377">)</span><span class="op" id="5308378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308381">return</span>&nbsp;<span class="string" id="5308388">&#34;&#39;&#34;</span>&nbsp;<span class="op" id="5308392">+</span>&nbsp;<span class="ident" id="5308394">s</span><span class="op" id="5308395">[</span><span class="num" id="5308396">1</span><span class="op" id="5308397">:</span><span class="builtinfunc" id="5308398">len</span><span class="op" id="5308401">(</span><span class="ident" id="5308402">s</span><span class="op" id="5308403">)</span><span class="op" id="5308404">-</span><span class="num" id="5308405">1</span><span class="op" id="5308406">]</span>&nbsp;<span class="op" id="5308408">+</span>&nbsp;<span class="string" id="5308410">&#34;&#39;&#34;</span><br>
<span class="lineno"></span><span class="op" id="5308414">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span><span class="comment" id="5308417">//&nbsp;undo&nbsp;causes&nbsp;the&nbsp;scanner&nbsp;to&nbsp;return&nbsp;scanCode&nbsp;from&nbsp;the&nbsp;next&nbsp;state&nbsp;transition.</span><br>
<span class="lineno"></span><span class="comment" id="5308495">//&nbsp;This&nbsp;gives&nbsp;callers&nbsp;a&nbsp;simple&nbsp;1-byte&nbsp;undo&nbsp;mechanism.</span><br>
<span class="lineno"></span><span class="keyword" id="5308549">func</span>&nbsp;<span class="op" id="5308554">(</span><span class="ident" id="5308555">s</span>&nbsp;<span class="op" id="5308557">*</span><span class="ident" id="5308558">scanner</span><span class="op" id="5308565">)</span>&nbsp;<span class="ident" id="5308567">undo</span><span class="op" id="5308571">(</span><span class="ident" id="5308572">scanCode</span>&nbsp;<span class="builtintype" id="5308581">int</span><span class="op" id="5308584">)</span>&nbsp;<span class="op" id="5308586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308589">if</span>&nbsp;<span class="ident" id="5308592">s</span><span class="op" id="5308593">.</span><span class="ident" id="5308594">redo</span>&nbsp;<span class="op" id="5308599">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5308603">panic</span><span class="op" id="5308608">(</span><span class="string" id="5308609">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;scanner&#34;</span><span class="op" id="5308639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5308642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5308645">s</span><span class="op" id="5308646">.</span><span class="ident" id="5308647">redoCode</span>&nbsp;<span class="op" id="5308656">=</span>&nbsp;<span class="ident" id="5308658">scanCode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5308668">s</span><span class="op" id="5308669">.</span><span class="ident" id="5308670">redoState</span>&nbsp;<span class="op" id="5308680">=</span>&nbsp;<span class="ident" id="5308682">s</span><span class="op" id="5308683">.</span><span class="ident" id="5308684">step</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5308690">s</span><span class="op" id="5308691">.</span><span class="ident" id="5308692">step</span>&nbsp;<span class="op" id="5308697">=</span>&nbsp;<span class="ident" id="5308699">stateRedo</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5308710">s</span><span class="op" id="5308711">.</span><span class="ident" id="5308712">redo</span>&nbsp;<span class="op" id="5308717">=</span>&nbsp;<span class="builtintype" id="5308719">true</span><br>
<span class="lineno"></span><span class="op" id="5308724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5308727">//&nbsp;stateRedo&nbsp;helps&nbsp;implement&nbsp;the&nbsp;scanner&#39;s&nbsp;1-byte&nbsp;undo.</span><br>
<span class="lineno"></span><span class="keyword" id="5308783">func</span>&nbsp;<span class="ident" id="5308788">stateRedo</span><span class="op" id="5308797">(</span><span class="ident" id="5308798">s</span>&nbsp;<span class="op" id="5308800">*</span><span class="ident" id="5308801">scanner</span><span class="op" id="5308808">,</span>&nbsp;<span class="ident" id="5308810">c</span>&nbsp;<span class="builtintype" id="5308812">int</span><span class="op" id="5308815">)</span>&nbsp;<span class="builtintype" id="5308817">int</span>&nbsp;<span class="op" id="5308821">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5308824">s</span><span class="op" id="5308825">.</span><span class="ident" id="5308826">redo</span>&nbsp;<span class="op" id="5308831">=</span>&nbsp;<span class="builtintype" id="5308833">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5308840">s</span><span class="op" id="5308841">.</span><span class="ident" id="5308842">step</span>&nbsp;<span class="op" id="5308847">=</span>&nbsp;<span class="ident" id="5308849">s</span><span class="op" id="5308850">.</span><span class="ident" id="5308851">redoState</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308862">return</span>&nbsp;<span class="ident" id="5308869">s</span><span class="op" id="5308870">.</span><span class="ident" id="5308871">redoCode</span><br>
<span class="lineno"></span><span class="op" id="5308880">}</span>
</div>
</body>
</html>
