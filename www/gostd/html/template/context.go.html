<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2798889">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2798944">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2798998">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2799049">package</span>&nbsp;<span class="ident" id="2799057">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2799067">import</span>&nbsp;<span class="op" id="2799074">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2799077">&#34;fmt&#34;</span><br>
<span class="lineno"></span><span class="op" id="2799083">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2799086">//&nbsp;context&nbsp;describes&nbsp;the&nbsp;state&nbsp;an&nbsp;HTML&nbsp;parser&nbsp;must&nbsp;be&nbsp;in&nbsp;when&nbsp;it&nbsp;reaches&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2799163">//&nbsp;portion&nbsp;of&nbsp;HTML&nbsp;produced&nbsp;by&nbsp;evaluating&nbsp;a&nbsp;particular&nbsp;template&nbsp;node.</span><br>
<span class="lineno"></span><span class="comment" id="2799233">//</span><br>
<span class="lineno"></span><span class="comment" id="2799236">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;of&nbsp;type&nbsp;context&nbsp;is&nbsp;the&nbsp;start&nbsp;context&nbsp;for&nbsp;a&nbsp;template&nbsp;that</span><br>
<span class="lineno">15</span><span class="comment" id="2799311">//&nbsp;produces&nbsp;an&nbsp;HTML&nbsp;fragment&nbsp;as&nbsp;defined&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="2799354">//&nbsp;http://www.w3.org/TR/html5/syntax.html#the-end</span><br>
<span class="lineno"></span><span class="comment" id="2799404">//&nbsp;where&nbsp;the&nbsp;context&nbsp;element&nbsp;is&nbsp;null.</span><br>
<span class="lineno"></span><span class="keyword" id="2799442">type</span>&nbsp;<span class="ident" id="2799447">context</span>&nbsp;<span class="keyword" id="2799455">struct</span>&nbsp;<span class="op" id="2799462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799465">state</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2799473">state</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799480">delim</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2799488">delim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799495">urlPart</span>&nbsp;<span class="ident" id="2799503">urlPart</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799512">jsCtx</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2799520">jsCtx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799527">attr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799535">attr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799541">element</span>&nbsp;<span class="ident" id="2799549">element</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799558">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2799566">*</span><span class="ident" id="2799567">Error</span><br>
<span class="lineno"></span><span class="op" id="2799573">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2799576">func</span>&nbsp;<span class="op" id="2799581">(</span><span class="ident" id="2799582">c</span>&nbsp;<span class="ident" id="2799584">context</span><span class="op" id="2799591">)</span>&nbsp;<span class="ident" id="2799593">String</span><span class="op" id="2799599">(</span><span class="op" id="2799600">)</span>&nbsp;<span class="builtintype" id="2799602">string</span>&nbsp;<span class="op" id="2799609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2799612">return</span>&nbsp;<span class="ident" id="2799619">fmt</span><span class="op" id="2799622">.</span><span class="ident" id="2799623">Sprintf</span><span class="op" id="2799630">(</span><span class="string" id="2799631">&#34;{%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v}&#34;</span><span class="op" id="2799655">,</span>&nbsp;<span class="ident" id="2799657">c</span><span class="op" id="2799658">.</span><span class="ident" id="2799659">state</span><span class="op" id="2799664">,</span>&nbsp;<span class="ident" id="2799666">c</span><span class="op" id="2799667">.</span><span class="ident" id="2799668">delim</span><span class="op" id="2799673">,</span>&nbsp;<span class="ident" id="2799675">c</span><span class="op" id="2799676">.</span><span class="ident" id="2799677">urlPart</span><span class="op" id="2799684">,</span>&nbsp;<span class="ident" id="2799686">c</span><span class="op" id="2799687">.</span><span class="ident" id="2799688">jsCtx</span><span class="op" id="2799693">,</span>&nbsp;<span class="ident" id="2799695">c</span><span class="op" id="2799696">.</span><span class="ident" id="2799697">attr</span><span class="op" id="2799701">,</span>&nbsp;<span class="ident" id="2799703">c</span><span class="op" id="2799704">.</span><span class="ident" id="2799705">element</span><span class="op" id="2799712">,</span>&nbsp;<span class="ident" id="2799714">c</span><span class="op" id="2799715">.</span><span class="ident" id="2799716">err</span><span class="op" id="2799719">)</span><br>
<span class="lineno">30</span><span class="op" id="2799721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2799724">//&nbsp;eq&nbsp;reports&nbsp;whether&nbsp;two&nbsp;contexts&nbsp;are&nbsp;equal.</span><br>
<span class="lineno"></span><span class="keyword" id="2799770">func</span>&nbsp;<span class="op" id="2799775">(</span><span class="ident" id="2799776">c</span>&nbsp;<span class="ident" id="2799778">context</span><span class="op" id="2799785">)</span>&nbsp;<span class="ident" id="2799787">eq</span><span class="op" id="2799789">(</span><span class="ident" id="2799790">d</span>&nbsp;<span class="ident" id="2799792">context</span><span class="op" id="2799799">)</span>&nbsp;<span class="builtintype" id="2799801">bool</span>&nbsp;<span class="op" id="2799806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2799809">return</span>&nbsp;<span class="ident" id="2799816">c</span><span class="op" id="2799817">.</span><span class="ident" id="2799818">state</span>&nbsp;<span class="op" id="2799824">==</span>&nbsp;<span class="ident" id="2799827">d</span><span class="op" id="2799828">.</span><span class="ident" id="2799829">state</span>&nbsp;<span class="op" id="2799835">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799840">c</span><span class="op" id="2799841">.</span><span class="ident" id="2799842">delim</span>&nbsp;<span class="op" id="2799848">==</span>&nbsp;<span class="ident" id="2799851">d</span><span class="op" id="2799852">.</span><span class="ident" id="2799853">delim</span>&nbsp;<span class="op" id="2799859">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799864">c</span><span class="op" id="2799865">.</span><span class="ident" id="2799866">urlPart</span>&nbsp;<span class="op" id="2799874">==</span>&nbsp;<span class="ident" id="2799877">d</span><span class="op" id="2799878">.</span><span class="ident" id="2799879">urlPart</span>&nbsp;<span class="op" id="2799887">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799892">c</span><span class="op" id="2799893">.</span><span class="ident" id="2799894">jsCtx</span>&nbsp;<span class="op" id="2799900">==</span>&nbsp;<span class="ident" id="2799903">d</span><span class="op" id="2799904">.</span><span class="ident" id="2799905">jsCtx</span>&nbsp;<span class="op" id="2799911">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799916">c</span><span class="op" id="2799917">.</span><span class="ident" id="2799918">attr</span>&nbsp;<span class="op" id="2799923">==</span>&nbsp;<span class="ident" id="2799926">d</span><span class="op" id="2799927">.</span><span class="ident" id="2799928">attr</span>&nbsp;<span class="op" id="2799933">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799938">c</span><span class="op" id="2799939">.</span><span class="ident" id="2799940">element</span>&nbsp;<span class="op" id="2799948">==</span>&nbsp;<span class="ident" id="2799951">d</span><span class="op" id="2799952">.</span><span class="ident" id="2799953">element</span>&nbsp;<span class="op" id="2799961">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2799966">c</span><span class="op" id="2799967">.</span><span class="ident" id="2799968">err</span>&nbsp;<span class="op" id="2799972">==</span>&nbsp;<span class="ident" id="2799975">d</span><span class="op" id="2799976">.</span><span class="ident" id="2799977">err</span><br>
<span class="lineno"></span><span class="op" id="2799981">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2799984">//&nbsp;mangle&nbsp;produces&nbsp;an&nbsp;identifier&nbsp;that&nbsp;includes&nbsp;a&nbsp;suffix&nbsp;that&nbsp;distinguishes&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="2800062">//&nbsp;from&nbsp;template&nbsp;names&nbsp;mangled&nbsp;with&nbsp;different&nbsp;contexts.</span><br>
<span class="lineno">45</span><span class="keyword" id="2800118">func</span>&nbsp;<span class="op" id="2800123">(</span><span class="ident" id="2800124">c</span>&nbsp;<span class="ident" id="2800126">context</span><span class="op" id="2800133">)</span>&nbsp;<span class="ident" id="2800135">mangle</span><span class="op" id="2800141">(</span><span class="ident" id="2800142">templateName</span>&nbsp;<span class="builtintype" id="2800155">string</span><span class="op" id="2800161">)</span>&nbsp;<span class="builtintype" id="2800163">string</span>&nbsp;<span class="op" id="2800170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2800173">//&nbsp;The&nbsp;mangled&nbsp;name&nbsp;for&nbsp;the&nbsp;default&nbsp;context&nbsp;is&nbsp;the&nbsp;input&nbsp;templateName.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800245">if</span>&nbsp;<span class="ident" id="2800248">c</span><span class="op" id="2800249">.</span><span class="ident" id="2800250">state</span>&nbsp;<span class="op" id="2800256">==</span>&nbsp;<span class="ident" id="2800259">stateText</span>&nbsp;<span class="op" id="2800269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800273">return</span>&nbsp;<span class="ident" id="2800280">templateName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2800294">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800297">s</span>&nbsp;<span class="op" id="2800299">:=</span>&nbsp;<span class="ident" id="2800302">templateName</span>&nbsp;<span class="op" id="2800315">+</span>&nbsp;<span class="string" id="2800317">&#34;$htmltemplate_&#34;</span>&nbsp;<span class="op" id="2800334">+</span>&nbsp;<span class="ident" id="2800336">c</span><span class="op" id="2800337">.</span><span class="ident" id="2800338">state</span><span class="op" id="2800343">.</span><span class="ident" id="2800344">String</span><span class="op" id="2800350">(</span><span class="op" id="2800351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800354">if</span>&nbsp;<span class="ident" id="2800357">c</span><span class="op" id="2800358">.</span><span class="ident" id="2800359">delim</span>&nbsp;<span class="op" id="2800365">!=</span>&nbsp;<span class="num" id="2800368">0</span>&nbsp;<span class="op" id="2800370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800374">s</span>&nbsp;<span class="op" id="2800376">+=</span>&nbsp;<span class="string" id="2800379">&#34;_&#34;</span>&nbsp;<span class="op" id="2800383">+</span>&nbsp;<span class="ident" id="2800385">c</span><span class="op" id="2800386">.</span><span class="ident" id="2800387">delim</span><span class="op" id="2800392">.</span><span class="ident" id="2800393">String</span><span class="op" id="2800399">(</span><span class="op" id="2800400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2800403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800406">if</span>&nbsp;<span class="ident" id="2800409">c</span><span class="op" id="2800410">.</span><span class="ident" id="2800411">urlPart</span>&nbsp;<span class="op" id="2800419">!=</span>&nbsp;<span class="num" id="2800422">0</span>&nbsp;<span class="op" id="2800424">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800428">s</span>&nbsp;<span class="op" id="2800430">+=</span>&nbsp;<span class="string" id="2800433">&#34;_&#34;</span>&nbsp;<span class="op" id="2800437">+</span>&nbsp;<span class="ident" id="2800439">c</span><span class="op" id="2800440">.</span><span class="ident" id="2800441">urlPart</span><span class="op" id="2800448">.</span><span class="ident" id="2800449">String</span><span class="op" id="2800455">(</span><span class="op" id="2800456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2800459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800462">if</span>&nbsp;<span class="ident" id="2800465">c</span><span class="op" id="2800466">.</span><span class="ident" id="2800467">jsCtx</span>&nbsp;<span class="op" id="2800473">!=</span>&nbsp;<span class="num" id="2800476">0</span>&nbsp;<span class="op" id="2800478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800482">s</span>&nbsp;<span class="op" id="2800484">+=</span>&nbsp;<span class="string" id="2800487">&#34;_&#34;</span>&nbsp;<span class="op" id="2800491">+</span>&nbsp;<span class="ident" id="2800493">c</span><span class="op" id="2800494">.</span><span class="ident" id="2800495">jsCtx</span><span class="op" id="2800500">.</span><span class="ident" id="2800501">String</span><span class="op" id="2800507">(</span><span class="op" id="2800508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2800511">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800514">if</span>&nbsp;<span class="ident" id="2800517">c</span><span class="op" id="2800518">.</span><span class="ident" id="2800519">attr</span>&nbsp;<span class="op" id="2800524">!=</span>&nbsp;<span class="num" id="2800527">0</span>&nbsp;<span class="op" id="2800529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800533">s</span>&nbsp;<span class="op" id="2800535">+=</span>&nbsp;<span class="string" id="2800538">&#34;_&#34;</span>&nbsp;<span class="op" id="2800542">+</span>&nbsp;<span class="ident" id="2800544">c</span><span class="op" id="2800545">.</span><span class="ident" id="2800546">attr</span><span class="op" id="2800550">.</span><span class="ident" id="2800551">String</span><span class="op" id="2800557">(</span><span class="op" id="2800558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2800561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800564">if</span>&nbsp;<span class="ident" id="2800567">c</span><span class="op" id="2800568">.</span><span class="ident" id="2800569">element</span>&nbsp;<span class="op" id="2800577">!=</span>&nbsp;<span class="num" id="2800580">0</span>&nbsp;<span class="op" id="2800582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2800586">s</span>&nbsp;<span class="op" id="2800588">+=</span>&nbsp;<span class="string" id="2800591">&#34;_&#34;</span>&nbsp;<span class="op" id="2800595">+</span>&nbsp;<span class="ident" id="2800597">c</span><span class="op" id="2800598">.</span><span class="ident" id="2800599">element</span><span class="op" id="2800606">.</span><span class="ident" id="2800607">String</span><span class="op" id="2800613">(</span><span class="op" id="2800614">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2800617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2800620">return</span>&nbsp;<span class="ident" id="2800627">s</span><br>
<span class="lineno"></span><span class="op" id="2800629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2800632">//&nbsp;state&nbsp;describes&nbsp;a&nbsp;high-level&nbsp;HTML&nbsp;parser&nbsp;state.</span><br>
<span class="lineno">70</span><span class="comment" id="2800683">//</span><br>
<span class="lineno"></span><span class="comment" id="2800686">//&nbsp;It&nbsp;bounds&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;element&nbsp;stack,&nbsp;and&nbsp;by&nbsp;extension&nbsp;the&nbsp;HTML&nbsp;insertion</span><br>
<span class="lineno"></span><span class="comment" id="2800765">//&nbsp;mode,&nbsp;but&nbsp;also&nbsp;contains&nbsp;state&nbsp;that&nbsp;does&nbsp;not&nbsp;correspond&nbsp;to&nbsp;anything&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2800842">//&nbsp;HTML5&nbsp;parsing&nbsp;algorithm&nbsp;because&nbsp;a&nbsp;single&nbsp;token&nbsp;production&nbsp;in&nbsp;the&nbsp;HTML</span><br>
<span class="lineno"></span><span class="comment" id="2800915">//&nbsp;grammar&nbsp;may&nbsp;contain&nbsp;embedded&nbsp;actions&nbsp;in&nbsp;a&nbsp;template.&nbsp;For&nbsp;instance,&nbsp;the&nbsp;quoted</span><br>
<span class="lineno">75</span><span class="comment" id="2800995">//&nbsp;HTML&nbsp;attribute&nbsp;produced&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2801025">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;title=&#34;Hello&nbsp;{{.World}}&#34;&gt;</span><br>
<span class="lineno"></span><span class="comment" id="2801063">//&nbsp;is&nbsp;a&nbsp;single&nbsp;token&nbsp;in&nbsp;HTML&#39;s&nbsp;grammar&nbsp;but&nbsp;in&nbsp;a&nbsp;template&nbsp;spans&nbsp;several&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="2801141">type</span>&nbsp;<span class="ident" id="2801146">state</span>&nbsp;<span class="builtintype" id="2801152">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="2801159">const</span>&nbsp;<span class="op" id="2801165">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2801168">//&nbsp;stateText&nbsp;is&nbsp;parsed&nbsp;character&nbsp;data.&nbsp;An&nbsp;HTML&nbsp;parser&nbsp;is&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2801229">//&nbsp;this&nbsp;state&nbsp;when&nbsp;its&nbsp;parse&nbsp;position&nbsp;is&nbsp;outside&nbsp;an&nbsp;HTML&nbsp;tag,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2801292">//&nbsp;directive,&nbsp;comment,&nbsp;and&nbsp;special&nbsp;element&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2801342">stateText</span>&nbsp;<span class="ident" id="2801352">state</span>&nbsp;<span class="op" id="2801358">=</span>&nbsp;<span class="ident" id="2801360">iota</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2801366">//&nbsp;stateTag&nbsp;occurs&nbsp;before&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;or&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;tag.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2801432">stateTag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2801442">//&nbsp;stateAttrName&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;attribute&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2801493">//&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;^name^&nbsp;=&nbsp;value`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2801545">stateAttrName</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2801560">//&nbsp;stateAfterName&nbsp;occurs&nbsp;after&nbsp;an&nbsp;attr&nbsp;name&nbsp;has&nbsp;ended&nbsp;but&nbsp;before&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2801630">//&nbsp;equals&nbsp;sign.&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;name^&nbsp;^=&nbsp;value`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2801695">stateAfterName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2801711">//&nbsp;stateBeforeValue&nbsp;occurs&nbsp;after&nbsp;the&nbsp;equals&nbsp;sign&nbsp;but&nbsp;before&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2801783">//&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;name&nbsp;=^&nbsp;^value`.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2801835">stateBeforeValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2801853">//&nbsp;stateHTMLCmt&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;&lt;!--&nbsp;HTML&nbsp;comment&nbsp;--&gt;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2801910">stateHTMLCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2801924">//&nbsp;stateRCDATA&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;RCDATA&nbsp;element&nbsp;(&lt;textarea&gt;&nbsp;or&nbsp;&lt;title&gt;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2801996">//&nbsp;as&nbsp;described&nbsp;at&nbsp;http://www.w3.org/TR/html5/syntax.html#elements-0</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2802066">stateRCDATA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2802079">//&nbsp;stateAttr&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;whose&nbsp;content&nbsp;is&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2802148">stateAttr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2802159">//&nbsp;stateURL&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;whose&nbsp;content&nbsp;is&nbsp;a&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2802228">stateURL</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2802238">//&nbsp;stateJS&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;event&nbsp;handler&nbsp;or&nbsp;script&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2802300">stateJS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2802309">//&nbsp;stateJSDqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;double&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2802375">stateJSDqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2802389">//&nbsp;stateJSSqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;single&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2802455">stateJSSqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2802469">//&nbsp;stateJSRegexp&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;regexp&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2802530">stateJSRegexp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2802545">//&nbsp;stateJSBlockCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;/*&nbsp;block&nbsp;comment&nbsp;*/.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2802613">stateJSBlockCmt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2802630">//&nbsp;stateJSLineCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;//&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2802693">stateJSLineCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2802709">//&nbsp;stateCSS&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;&lt;style&gt;&nbsp;element&nbsp;or&nbsp;style&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2802774">stateCSS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2802784">//&nbsp;stateCSSDqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;double&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2802844">stateCSSDqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2802859">//&nbsp;stateCSSSqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;single&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2802919">stateCSSSqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2802934">//&nbsp;stateCSSDqURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;double&nbsp;quoted&nbsp;url(&#34;...&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2802998">stateCSSDqURL</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2803013">//&nbsp;stateCSSSqURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;single&nbsp;quoted&nbsp;url(&#39;...&#39;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803077">stateCSSSqURL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2803092">//&nbsp;stateCSSURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;unquoted&nbsp;url(...).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803147">stateCSSURL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2803160">//&nbsp;stateCSSBlockCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;/*&nbsp;block&nbsp;comment&nbsp;*/.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803222">stateCSSBlockCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2803240">//&nbsp;stateCSSLineCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;//&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803297">stateCSSLineCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2803314">//&nbsp;stateError&nbsp;is&nbsp;an&nbsp;infectious&nbsp;error&nbsp;state&nbsp;outside&nbsp;any&nbsp;valid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2803376">//&nbsp;HTML/CSS/JS&nbsp;construct.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803403">stateError</span><br>
<span class="lineno"></span><span class="op" id="2803414">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2803417">var</span>&nbsp;<span class="ident" id="2803421">stateNames</span>&nbsp;<span class="op" id="2803432">=</span>&nbsp;<span class="op" id="2803434">[</span><span class="op" id="2803435">...</span><span class="op" id="2803438">]</span><span class="builtintype" id="2803439">string</span><span class="op" id="2803445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803448">stateText</span><span class="op" id="2803457">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2803466">&#34;stateText&#34;</span><span class="op" id="2803477">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803480">stateTag</span><span class="op" id="2803488">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2803498">&#34;stateTag&#34;</span><span class="op" id="2803508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803511">stateAttrName</span><span class="op" id="2803524">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2803529">&#34;stateAttrName&#34;</span><span class="op" id="2803544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803547">stateAfterName</span><span class="op" id="2803561">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2803565">&#34;stateAfterName&#34;</span><span class="op" id="2803581">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803584">stateBeforeValue</span><span class="op" id="2803600">:</span>&nbsp;<span class="string" id="2803602">&#34;stateBeforeValue&#34;</span><span class="op" id="2803620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803623">stateHTMLCmt</span><span class="op" id="2803635">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2803641">&#34;stateHTMLCmt&#34;</span><span class="op" id="2803655">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803658">stateRCDATA</span><span class="op" id="2803669">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2803676">&#34;stateRCDATA&#34;</span><span class="op" id="2803689">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803692">stateAttr</span><span class="op" id="2803701">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2803710">&#34;stateAttr&#34;</span><span class="op" id="2803721">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803724">stateURL</span><span class="op" id="2803732">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2803742">&#34;stateURL&#34;</span><span class="op" id="2803752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803755">stateJS</span><span class="op" id="2803762">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2803773">&#34;stateJS&#34;</span><span class="op" id="2803782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803785">stateJSDqStr</span><span class="op" id="2803797">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2803803">&#34;stateJSDqStr&#34;</span><span class="op" id="2803817">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803820">stateJSSqStr</span><span class="op" id="2803832">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2803838">&#34;stateJSSqStr&#34;</span><span class="op" id="2803852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803855">stateJSRegexp</span><span class="op" id="2803868">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2803873">&#34;stateJSRegexp&#34;</span><span class="op" id="2803888">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803891">stateJSBlockCmt</span><span class="op" id="2803906">:</span>&nbsp;&nbsp;<span class="string" id="2803909">&#34;stateJSBlockCmt&#34;</span><span class="op" id="2803926">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803929">stateJSLineCmt</span><span class="op" id="2803943">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2803947">&#34;stateJSLineCmt&#34;</span><span class="op" id="2803963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803966">stateCSS</span><span class="op" id="2803974">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2803984">&#34;stateCSS&#34;</span><span class="op" id="2803994">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2803997">stateCSSDqStr</span><span class="op" id="2804010">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2804015">&#34;stateCSSDqStr&#34;</span><span class="op" id="2804030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2804033">stateCSSSqStr</span><span class="op" id="2804046">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2804051">&#34;stateCSSSqStr&#34;</span><span class="op" id="2804066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2804069">stateCSSDqURL</span><span class="op" id="2804082">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2804087">&#34;stateCSSDqURL&#34;</span><span class="op" id="2804102">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2804105">stateCSSSqURL</span><span class="op" id="2804118">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2804123">&#34;stateCSSSqURL&#34;</span><span class="op" id="2804138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2804141">stateCSSURL</span><span class="op" id="2804152">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2804159">&#34;stateCSSURL&#34;</span><span class="op" id="2804172">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2804175">stateCSSBlockCmt</span><span class="op" id="2804191">:</span>&nbsp;<span class="string" id="2804193">&#34;stateCSSBlockCmt&#34;</span><span class="op" id="2804211">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2804214">stateCSSLineCmt</span><span class="op" id="2804229">:</span>&nbsp;&nbsp;<span class="string" id="2804232">&#34;stateCSSLineCmt&#34;</span><span class="op" id="2804249">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2804252">stateError</span><span class="op" id="2804262">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2804270">&#34;stateError&#34;</span><span class="op" id="2804282">,</span><br>
<span class="lineno"></span><span class="op" id="2804284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="2804287">func</span>&nbsp;<span class="op" id="2804292">(</span><span class="ident" id="2804293">s</span>&nbsp;<span class="ident" id="2804295">state</span><span class="op" id="2804300">)</span>&nbsp;<span class="ident" id="2804302">String</span><span class="op" id="2804308">(</span><span class="op" id="2804309">)</span>&nbsp;<span class="builtintype" id="2804311">string</span>&nbsp;<span class="op" id="2804318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2804321">if</span>&nbsp;<span class="builtintype" id="2804324">int</span><span class="op" id="2804327">(</span><span class="ident" id="2804328">s</span><span class="op" id="2804329">)</span>&nbsp;<span class="op" id="2804331">&lt;</span>&nbsp;<span class="builtinfunc" id="2804333">len</span><span class="op" id="2804336">(</span><span class="ident" id="2804337">stateNames</span><span class="op" id="2804347">)</span>&nbsp;<span class="op" id="2804349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2804353">return</span>&nbsp;<span class="ident" id="2804360">stateNames</span><span class="op" id="2804370">[</span><span class="ident" id="2804371">s</span><span class="op" id="2804372">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2804375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2804378">return</span>&nbsp;<span class="ident" id="2804385">fmt</span><span class="op" id="2804388">.</span><span class="ident" id="2804389">Sprintf</span><span class="op" id="2804396">(</span><span class="string" id="2804397">&#34;illegal&nbsp;state&nbsp;%d&#34;</span><span class="op" id="2804415">,</span>&nbsp;<span class="builtintype" id="2804417">int</span><span class="op" id="2804420">(</span><span class="ident" id="2804421">s</span><span class="op" id="2804422">)</span><span class="op" id="2804423">)</span><br>
<span class="lineno">170</span><span class="op" id="2804425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2804428">//&nbsp;isComment&nbsp;is&nbsp;true&nbsp;for&nbsp;any&nbsp;state&nbsp;that&nbsp;contains&nbsp;content&nbsp;meant&nbsp;for&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="2804504">//&nbsp;authors&nbsp;&amp;&nbsp;maintainers,&nbsp;not&nbsp;for&nbsp;end-users&nbsp;or&nbsp;machines.</span><br>
<span class="lineno"></span><span class="keyword" id="2804561">func</span>&nbsp;<span class="ident" id="2804566">isComment</span><span class="op" id="2804575">(</span><span class="ident" id="2804576">s</span>&nbsp;<span class="ident" id="2804578">state</span><span class="op" id="2804583">)</span>&nbsp;<span class="builtintype" id="2804585">bool</span>&nbsp;<span class="op" id="2804590">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2804593">switch</span>&nbsp;<span class="ident" id="2804600">s</span>&nbsp;<span class="op" id="2804602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2804605">case</span>&nbsp;<span class="ident" id="2804610">stateHTMLCmt</span><span class="op" id="2804622">,</span>&nbsp;<span class="ident" id="2804624">stateJSBlockCmt</span><span class="op" id="2804639">,</span>&nbsp;<span class="ident" id="2804641">stateJSLineCmt</span><span class="op" id="2804655">,</span>&nbsp;<span class="ident" id="2804657">stateCSSBlockCmt</span><span class="op" id="2804673">,</span>&nbsp;<span class="ident" id="2804675">stateCSSLineCmt</span><span class="op" id="2804690">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2804694">return</span>&nbsp;<span class="builtintype" id="2804701">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2804707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2804710">return</span>&nbsp;<span class="builtintype" id="2804717">false</span><br>
<span class="lineno">180</span><span class="op" id="2804723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2804726">//&nbsp;isInTag&nbsp;return&nbsp;whether&nbsp;s&nbsp;occurs&nbsp;solely&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="2804788">func</span>&nbsp;<span class="ident" id="2804793">isInTag</span><span class="op" id="2804800">(</span><span class="ident" id="2804801">s</span>&nbsp;<span class="ident" id="2804803">state</span><span class="op" id="2804808">)</span>&nbsp;<span class="builtintype" id="2804810">bool</span>&nbsp;<span class="op" id="2804815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2804818">switch</span>&nbsp;<span class="ident" id="2804825">s</span>&nbsp;<span class="op" id="2804827">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2804830">case</span>&nbsp;<span class="ident" id="2804835">stateTag</span><span class="op" id="2804843">,</span>&nbsp;<span class="ident" id="2804845">stateAttrName</span><span class="op" id="2804858">,</span>&nbsp;<span class="ident" id="2804860">stateAfterName</span><span class="op" id="2804874">,</span>&nbsp;<span class="ident" id="2804876">stateBeforeValue</span><span class="op" id="2804892">,</span>&nbsp;<span class="ident" id="2804894">stateAttr</span><span class="op" id="2804903">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2804907">return</span>&nbsp;<span class="builtintype" id="2804914">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2804920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2804923">return</span>&nbsp;<span class="builtintype" id="2804930">false</span><br>
<span class="lineno"></span><span class="op" id="2804936">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="2804939">//&nbsp;delim&nbsp;is&nbsp;the&nbsp;delimiter&nbsp;that&nbsp;will&nbsp;end&nbsp;the&nbsp;current&nbsp;HTML&nbsp;attribute.</span><br>
<span class="lineno"></span><span class="keyword" id="2805007">type</span>&nbsp;<span class="ident" id="2805012">delim</span>&nbsp;<span class="builtintype" id="2805018">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2805025">const</span>&nbsp;<span class="op" id="2805031">(</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2805034">//&nbsp;delimNone&nbsp;occurs&nbsp;outside&nbsp;any&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805078">delimNone</span>&nbsp;<span class="ident" id="2805088">delim</span>&nbsp;<span class="op" id="2805094">=</span>&nbsp;<span class="ident" id="2805096">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2805102">//&nbsp;delimDoubleQuote&nbsp;occurs&nbsp;when&nbsp;a&nbsp;double&nbsp;quote&nbsp;(&#34;)&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805176">delimDoubleQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2805194">//&nbsp;delimSingleQuote&nbsp;occurs&nbsp;when&nbsp;a&nbsp;single&nbsp;quote&nbsp;(&#39;)&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805268">delimSingleQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2805286">//&nbsp;delimSpaceOrTagEnd&nbsp;occurs&nbsp;when&nbsp;a&nbsp;space&nbsp;or&nbsp;right&nbsp;angle&nbsp;bracket&nbsp;(&gt;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2805356">//&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805382">delimSpaceOrTagEnd</span><br>
<span class="lineno"></span><span class="op" id="2805401">)</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="2805404">var</span>&nbsp;<span class="ident" id="2805408">delimNames</span>&nbsp;<span class="op" id="2805419">=</span>&nbsp;<span class="op" id="2805421">[</span><span class="op" id="2805422">...</span><span class="op" id="2805425">]</span><span class="builtintype" id="2805426">string</span><span class="op" id="2805432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805435">delimNone</span><span class="op" id="2805444">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2805455">&#34;delimNone&#34;</span><span class="op" id="2805466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805469">delimDoubleQuote</span><span class="op" id="2805485">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2805489">&#34;delimDoubleQuote&#34;</span><span class="op" id="2805507">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805510">delimSingleQuote</span><span class="op" id="2805526">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2805530">&#34;delimSingleQuote&#34;</span><span class="op" id="2805548">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805551">delimSpaceOrTagEnd</span><span class="op" id="2805569">:</span>&nbsp;<span class="string" id="2805571">&#34;delimSpaceOrTagEnd&#34;</span><span class="op" id="2805591">,</span><br>
<span class="lineno"></span><span class="op" id="2805593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2805596">func</span>&nbsp;<span class="op" id="2805601">(</span><span class="ident" id="2805602">d</span>&nbsp;<span class="ident" id="2805604">delim</span><span class="op" id="2805609">)</span>&nbsp;<span class="ident" id="2805611">String</span><span class="op" id="2805617">(</span><span class="op" id="2805618">)</span>&nbsp;<span class="builtintype" id="2805620">string</span>&nbsp;<span class="op" id="2805627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2805630">if</span>&nbsp;<span class="builtintype" id="2805633">int</span><span class="op" id="2805636">(</span><span class="ident" id="2805637">d</span><span class="op" id="2805638">)</span>&nbsp;<span class="op" id="2805640">&lt;</span>&nbsp;<span class="builtinfunc" id="2805642">len</span><span class="op" id="2805645">(</span><span class="ident" id="2805646">delimNames</span><span class="op" id="2805656">)</span>&nbsp;<span class="op" id="2805658">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2805662">return</span>&nbsp;<span class="ident" id="2805669">delimNames</span><span class="op" id="2805679">[</span><span class="ident" id="2805680">d</span><span class="op" id="2805681">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2805684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2805687">return</span>&nbsp;<span class="ident" id="2805694">fmt</span><span class="op" id="2805697">.</span><span class="ident" id="2805698">Sprintf</span><span class="op" id="2805705">(</span><span class="string" id="2805706">&#34;illegal&nbsp;delim&nbsp;%d&#34;</span><span class="op" id="2805724">,</span>&nbsp;<span class="builtintype" id="2805726">int</span><span class="op" id="2805729">(</span><span class="ident" id="2805730">d</span><span class="op" id="2805731">)</span><span class="op" id="2805732">)</span><br>
<span class="lineno"></span><span class="op" id="2805734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2805737">//&nbsp;urlPart&nbsp;identifies&nbsp;a&nbsp;part&nbsp;in&nbsp;an&nbsp;RFC&nbsp;3986&nbsp;hierarchical&nbsp;URL&nbsp;to&nbsp;allow&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="2805817">//&nbsp;encoding&nbsp;strategies.</span><br>
<span class="lineno"></span><span class="keyword" id="2805841">type</span>&nbsp;<span class="ident" id="2805846">urlPart</span>&nbsp;<span class="builtintype" id="2805854">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2805861">const</span>&nbsp;<span class="op" id="2805867">(</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2805870">//&nbsp;urlPartNone&nbsp;occurs&nbsp;when&nbsp;not&nbsp;in&nbsp;a&nbsp;URL,&nbsp;or&nbsp;possibly&nbsp;at&nbsp;the&nbsp;start:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2805938">//&nbsp;^&nbsp;in&nbsp;&#34;^http://auth/path?k=v#frag&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2805977">urlPartNone</span>&nbsp;<span class="ident" id="2805989">urlPart</span>&nbsp;<span class="op" id="2805997">=</span>&nbsp;<span class="ident" id="2805999">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806005">//&nbsp;urlPartPreQuery&nbsp;occurs&nbsp;in&nbsp;the&nbsp;scheme,&nbsp;authority,&nbsp;or&nbsp;path;&nbsp;between&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806079">//&nbsp;^s&nbsp;in&nbsp;&#34;h^ttp://auth/path^?k=v#frag&#34;.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2806120">urlPartPreQuery</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806137">//&nbsp;urlPartQueryOrFrag&nbsp;occurs&nbsp;in&nbsp;the&nbsp;query&nbsp;portion&nbsp;between&nbsp;the&nbsp;^s&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806206">//&nbsp;&#34;http://auth/path?^k=v#frag^&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2806241">urlPartQueryOrFrag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806261">//&nbsp;urlPartUnknown&nbsp;occurs&nbsp;due&nbsp;to&nbsp;joining&nbsp;of&nbsp;contexts&nbsp;both&nbsp;before&nbsp;and</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806330">//&nbsp;after&nbsp;the&nbsp;query&nbsp;separator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2806361">urlPartUnknown</span><br>
<span class="lineno"></span><span class="op" id="2806376">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2806379">var</span>&nbsp;<span class="ident" id="2806383">urlPartNames</span>&nbsp;<span class="op" id="2806396">=</span>&nbsp;<span class="op" id="2806398">[</span><span class="op" id="2806399">...</span><span class="op" id="2806402">]</span><span class="builtintype" id="2806403">string</span><span class="op" id="2806409">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2806412">urlPartNone</span><span class="op" id="2806423">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2806432">&#34;urlPartNone&#34;</span><span class="op" id="2806445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2806448">urlPartPreQuery</span><span class="op" id="2806463">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2806468">&#34;urlPartPreQuery&#34;</span><span class="op" id="2806485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2806488">urlPartQueryOrFrag</span><span class="op" id="2806506">:</span>&nbsp;<span class="string" id="2806508">&#34;urlPartQueryOrFrag&#34;</span><span class="op" id="2806528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2806531">urlPartUnknown</span><span class="op" id="2806545">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2806551">&#34;urlPartUnknown&#34;</span><span class="op" id="2806567">,</span><br>
<span class="lineno"></span><span class="op" id="2806569">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="2806572">func</span>&nbsp;<span class="op" id="2806577">(</span><span class="ident" id="2806578">u</span>&nbsp;<span class="ident" id="2806580">urlPart</span><span class="op" id="2806587">)</span>&nbsp;<span class="ident" id="2806589">String</span><span class="op" id="2806595">(</span><span class="op" id="2806596">)</span>&nbsp;<span class="builtintype" id="2806598">string</span>&nbsp;<span class="op" id="2806605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2806608">if</span>&nbsp;<span class="builtintype" id="2806611">int</span><span class="op" id="2806614">(</span><span class="ident" id="2806615">u</span><span class="op" id="2806616">)</span>&nbsp;<span class="op" id="2806618">&lt;</span>&nbsp;<span class="builtinfunc" id="2806620">len</span><span class="op" id="2806623">(</span><span class="ident" id="2806624">urlPartNames</span><span class="op" id="2806636">)</span>&nbsp;<span class="op" id="2806638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2806642">return</span>&nbsp;<span class="ident" id="2806649">urlPartNames</span><span class="op" id="2806661">[</span><span class="ident" id="2806662">u</span><span class="op" id="2806663">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2806666">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2806669">return</span>&nbsp;<span class="ident" id="2806676">fmt</span><span class="op" id="2806679">.</span><span class="ident" id="2806680">Sprintf</span><span class="op" id="2806687">(</span><span class="string" id="2806688">&#34;illegal&nbsp;urlPart&nbsp;%d&#34;</span><span class="op" id="2806708">,</span>&nbsp;<span class="builtintype" id="2806710">int</span><span class="op" id="2806713">(</span><span class="ident" id="2806714">u</span><span class="op" id="2806715">)</span><span class="op" id="2806716">)</span><br>
<span class="lineno"></span><span class="op" id="2806718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2806721">//&nbsp;jsCtx&nbsp;determines&nbsp;whether&nbsp;a&nbsp;&#39;/&#39;&nbsp;starts&nbsp;a&nbsp;regular&nbsp;expression&nbsp;literal&nbsp;or&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2806796">//&nbsp;division&nbsp;operator.</span><br>
<span class="lineno">255</span><span class="keyword" id="2806818">type</span>&nbsp;<span class="ident" id="2806823">jsCtx</span>&nbsp;<span class="builtintype" id="2806829">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2806836">const</span>&nbsp;<span class="op" id="2806842">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806845">//&nbsp;jsCtxRegexp&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;would&nbsp;start&nbsp;a&nbsp;regexp&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2806910">jsCtxRegexp</span>&nbsp;<span class="ident" id="2806922">jsCtx</span>&nbsp;<span class="op" id="2806928">=</span>&nbsp;<span class="ident" id="2806930">iota</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2806936">//&nbsp;jsCtxDivOp&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;would&nbsp;start&nbsp;a&nbsp;division&nbsp;operator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2807003">jsCtxDivOp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2807015">//&nbsp;jsCtxUnknown&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;is&nbsp;ambiguous&nbsp;due&nbsp;to&nbsp;context&nbsp;joining.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2807088">jsCtxUnknown</span><br>
<span class="lineno"></span><span class="op" id="2807101">)</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="2807104">func</span>&nbsp;<span class="op" id="2807109">(</span><span class="ident" id="2807110">c</span>&nbsp;<span class="ident" id="2807112">jsCtx</span><span class="op" id="2807117">)</span>&nbsp;<span class="ident" id="2807119">String</span><span class="op" id="2807125">(</span><span class="op" id="2807126">)</span>&nbsp;<span class="builtintype" id="2807128">string</span>&nbsp;<span class="op" id="2807135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2807138">switch</span>&nbsp;<span class="ident" id="2807145">c</span>&nbsp;<span class="op" id="2807147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2807150">case</span>&nbsp;<span class="ident" id="2807155">jsCtxRegexp</span><span class="op" id="2807166">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2807170">return</span>&nbsp;<span class="string" id="2807177">&#34;jsCtxRegexp&#34;</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2807192">case</span>&nbsp;<span class="ident" id="2807197">jsCtxDivOp</span><span class="op" id="2807207">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2807211">return</span>&nbsp;<span class="string" id="2807218">&#34;jsCtxDivOp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2807232">case</span>&nbsp;<span class="ident" id="2807237">jsCtxUnknown</span><span class="op" id="2807249">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2807253">return</span>&nbsp;<span class="string" id="2807260">&#34;jsCtxUnknown&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2807276">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2807279">return</span>&nbsp;<span class="ident" id="2807286">fmt</span><span class="op" id="2807289">.</span><span class="ident" id="2807290">Sprintf</span><span class="op" id="2807297">(</span><span class="string" id="2807298">&#34;illegal&nbsp;jsCtx&nbsp;%d&#34;</span><span class="op" id="2807316">,</span>&nbsp;<span class="builtintype" id="2807318">int</span><span class="op" id="2807321">(</span><span class="ident" id="2807322">c</span><span class="op" id="2807323">)</span><span class="op" id="2807324">)</span><br>
<span class="lineno"></span><span class="op" id="2807326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2807329">//&nbsp;element&nbsp;identifies&nbsp;the&nbsp;HTML&nbsp;element&nbsp;when&nbsp;inside&nbsp;a&nbsp;start&nbsp;tag&nbsp;or&nbsp;special&nbsp;body.</span><br>
<span class="lineno"></span><span class="comment" id="2807409">//&nbsp;Certain&nbsp;HTML&nbsp;element&nbsp;(for&nbsp;example&nbsp;&lt;script&gt;&nbsp;and&nbsp;&lt;style&gt;)&nbsp;have&nbsp;bodies&nbsp;that&nbsp;are</span><br>
<span class="lineno">280</span><span class="comment" id="2807489">//&nbsp;treated&nbsp;differently&nbsp;from&nbsp;stateText&nbsp;so&nbsp;the&nbsp;element&nbsp;type&nbsp;is&nbsp;necessary&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2807563">//&nbsp;transition&nbsp;into&nbsp;the&nbsp;correct&nbsp;context&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;tag&nbsp;and&nbsp;to&nbsp;identify&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2807642">//&nbsp;end&nbsp;delimiter&nbsp;for&nbsp;the&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="2807673">type</span>&nbsp;<span class="ident" id="2807678">element</span>&nbsp;<span class="builtintype" id="2807686">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="2807693">const</span>&nbsp;<span class="op" id="2807699">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2807702">//&nbsp;elementNone&nbsp;occurs&nbsp;outside&nbsp;a&nbsp;special&nbsp;tag&nbsp;or&nbsp;special&nbsp;element&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2807772">elementNone</span>&nbsp;<span class="ident" id="2807784">element</span>&nbsp;<span class="op" id="2807792">=</span>&nbsp;<span class="ident" id="2807794">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2807800">//&nbsp;elementScript&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;raw&nbsp;text&nbsp;&lt;script&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2807864">elementScript</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2807879">//&nbsp;elementStyle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;raw&nbsp;text&nbsp;&lt;style&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2807941">elementStyle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2807955">//&nbsp;elementTextarea&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;RCDATA&nbsp;&lt;textarea&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808021">elementTextarea</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2808038">//&nbsp;elementTitle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;RCDATA&nbsp;&lt;title&gt;&nbsp;element.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808098">elementTitle</span><br>
<span class="lineno"></span><span class="op" id="2808111">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2808114">var</span>&nbsp;<span class="ident" id="2808118">elementNames</span>&nbsp;<span class="op" id="2808131">=</span>&nbsp;<span class="op" id="2808133">[</span><span class="op" id="2808134">...</span><span class="op" id="2808137">]</span><span class="builtintype" id="2808138">string</span><span class="op" id="2808144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808147">elementNone</span><span class="op" id="2808158">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2808164">&#34;elementNone&#34;</span><span class="op" id="2808177">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808180">elementScript</span><span class="op" id="2808193">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2808197">&#34;elementScript&#34;</span><span class="op" id="2808212">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808215">elementStyle</span><span class="op" id="2808227">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2808232">&#34;elementStyle&#34;</span><span class="op" id="2808246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808249">elementTextarea</span><span class="op" id="2808264">:</span>&nbsp;<span class="string" id="2808266">&#34;elementTextarea&#34;</span><span class="op" id="2808283">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808286">elementTitle</span><span class="op" id="2808298">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2808303">&#34;elementTitle&#34;</span><span class="op" id="2808317">,</span><br>
<span class="lineno"></span><span class="op" id="2808319">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="keyword" id="2808322">func</span>&nbsp;<span class="op" id="2808327">(</span><span class="ident" id="2808328">e</span>&nbsp;<span class="ident" id="2808330">element</span><span class="op" id="2808337">)</span>&nbsp;<span class="ident" id="2808339">String</span><span class="op" id="2808345">(</span><span class="op" id="2808346">)</span>&nbsp;<span class="builtintype" id="2808348">string</span>&nbsp;<span class="op" id="2808355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2808358">if</span>&nbsp;<span class="builtintype" id="2808361">int</span><span class="op" id="2808364">(</span><span class="ident" id="2808365">e</span><span class="op" id="2808366">)</span>&nbsp;<span class="op" id="2808368">&lt;</span>&nbsp;<span class="builtinfunc" id="2808370">len</span><span class="op" id="2808373">(</span><span class="ident" id="2808374">elementNames</span><span class="op" id="2808386">)</span>&nbsp;<span class="op" id="2808388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2808392">return</span>&nbsp;<span class="ident" id="2808399">elementNames</span><span class="op" id="2808411">[</span><span class="ident" id="2808412">e</span><span class="op" id="2808413">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2808416">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2808419">return</span>&nbsp;<span class="ident" id="2808426">fmt</span><span class="op" id="2808429">.</span><span class="ident" id="2808430">Sprintf</span><span class="op" id="2808437">(</span><span class="string" id="2808438">&#34;illegal&nbsp;element&nbsp;%d&#34;</span><span class="op" id="2808458">,</span>&nbsp;<span class="builtintype" id="2808460">int</span><span class="op" id="2808463">(</span><span class="ident" id="2808464">e</span><span class="op" id="2808465">)</span><span class="op" id="2808466">)</span><br>
<span class="lineno"></span><span class="op" id="2808468">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2808471">//&nbsp;attr&nbsp;identifies&nbsp;the&nbsp;most&nbsp;recent&nbsp;HTML&nbsp;attribute&nbsp;when&nbsp;inside&nbsp;a&nbsp;start&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="2808546">type</span>&nbsp;<span class="ident" id="2808551">attr</span>&nbsp;<span class="builtintype" id="2808556">uint8</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="2808563">const</span>&nbsp;<span class="op" id="2808569">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2808572">//&nbsp;attrNone&nbsp;corresponds&nbsp;to&nbsp;a&nbsp;normal&nbsp;attribute&nbsp;or&nbsp;no&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808636">attrNone</span>&nbsp;<span class="ident" id="2808645">attr</span>&nbsp;<span class="op" id="2808650">=</span>&nbsp;<span class="ident" id="2808652">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2808658">//&nbsp;attrScript&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;event&nbsp;handler&nbsp;attribute.</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808716">attrScript</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2808728">//&nbsp;attrStyle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;style&nbsp;attribute&nbsp;whose&nbsp;value&nbsp;is&nbsp;CSS.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808797">attrStyle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2808808">//&nbsp;attrURL&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;attribute&nbsp;whose&nbsp;value&nbsp;is&nbsp;a&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808870">attrURL</span><br>
<span class="lineno">325</span><span class="op" id="2808878">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2808881">var</span>&nbsp;<span class="ident" id="2808885">attrNames</span>&nbsp;<span class="op" id="2808895">=</span>&nbsp;<span class="op" id="2808897">[</span><span class="op" id="2808898">...</span><span class="op" id="2808901">]</span><span class="builtintype" id="2808902">string</span><span class="op" id="2808908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808911">attrNone</span><span class="op" id="2808919">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2808923">&#34;attrNone&#34;</span><span class="op" id="2808933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808936">attrScript</span><span class="op" id="2808946">:</span>&nbsp;<span class="string" id="2808948">&#34;attrScript&#34;</span><span class="op" id="2808960">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808963">attrStyle</span><span class="op" id="2808972">:</span>&nbsp;&nbsp;<span class="string" id="2808975">&#34;attrStyle&#34;</span><span class="op" id="2808986">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2808989">attrURL</span><span class="op" id="2808996">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2809001">&#34;attrURL&#34;</span><span class="op" id="2809010">,</span><br>
<span class="lineno"></span><span class="op" id="2809012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2809015">func</span>&nbsp;<span class="op" id="2809020">(</span><span class="ident" id="2809021">a</span>&nbsp;<span class="ident" id="2809023">attr</span><span class="op" id="2809027">)</span>&nbsp;<span class="ident" id="2809029">String</span><span class="op" id="2809035">(</span><span class="op" id="2809036">)</span>&nbsp;<span class="builtintype" id="2809038">string</span>&nbsp;<span class="op" id="2809045">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2809048">if</span>&nbsp;<span class="builtintype" id="2809051">int</span><span class="op" id="2809054">(</span><span class="ident" id="2809055">a</span><span class="op" id="2809056">)</span>&nbsp;<span class="op" id="2809058">&lt;</span>&nbsp;<span class="builtinfunc" id="2809060">len</span><span class="op" id="2809063">(</span><span class="ident" id="2809064">attrNames</span><span class="op" id="2809073">)</span>&nbsp;<span class="op" id="2809075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2809079">return</span>&nbsp;<span class="ident" id="2809086">attrNames</span><span class="op" id="2809095">[</span><span class="ident" id="2809096">a</span><span class="op" id="2809097">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2809100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2809103">return</span>&nbsp;<span class="ident" id="2809110">fmt</span><span class="op" id="2809113">.</span><span class="ident" id="2809114">Sprintf</span><span class="op" id="2809121">(</span><span class="string" id="2809122">&#34;illegal&nbsp;attr&nbsp;%d&#34;</span><span class="op" id="2809139">,</span>&nbsp;<span class="builtintype" id="2809141">int</span><span class="op" id="2809144">(</span><span class="ident" id="2809145">a</span><span class="op" id="2809146">)</span><span class="op" id="2809147">)</span><br>
<span class="lineno"></span><span class="op" id="2809149">}</span>
</div>
</body>
</html>
