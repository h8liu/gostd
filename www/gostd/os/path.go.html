<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2495287">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2495342">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2495396">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2495447">package</span>&nbsp;<span class="ident" id="2495455">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2495459">import</span>&nbsp;<span class="op" id="2495466">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2495469">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2495475">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2495485">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2495488">//&nbsp;MkdirAll&nbsp;creates&nbsp;a&nbsp;directory&nbsp;named&nbsp;path,</span><br>
<span class="lineno"></span><span class="comment" id="2495532">//&nbsp;along&nbsp;with&nbsp;any&nbsp;necessary&nbsp;parents,&nbsp;and&nbsp;returns&nbsp;nil,</span><br>
<span class="lineno"></span><span class="comment" id="2495586">//&nbsp;or&nbsp;else&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno">15</span><span class="comment" id="2495615">//&nbsp;The&nbsp;permission&nbsp;bits&nbsp;perm&nbsp;are&nbsp;used&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2495660">//&nbsp;directories&nbsp;that&nbsp;MkdirAll&nbsp;creates.</span><br>
<span class="lineno"></span><span class="comment" id="2495698">//&nbsp;If&nbsp;path&nbsp;is&nbsp;already&nbsp;a&nbsp;directory,&nbsp;MkdirAll&nbsp;does&nbsp;nothing</span><br>
<span class="lineno"></span><span class="comment" id="2495755">//&nbsp;and&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2495775">func</span>&nbsp;<span class="ident" id="2495780">MkdirAll</span><span class="op" id="2495788">(</span><span class="ident" id="2495789">path</span>&nbsp;<span class="builtintype" id="2495794">string</span><span class="op" id="2495800">,</span>&nbsp;<span class="ident" id="2495802">perm</span>&nbsp;<span class="ident" id="2495807">FileMode</span><span class="op" id="2495815">)</span>&nbsp;<span class="builtintype" id="2495817">error</span>&nbsp;<span class="op" id="2495823">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2495826">//&nbsp;Fast&nbsp;path:&nbsp;if&nbsp;we&nbsp;can&nbsp;tell&nbsp;whether&nbsp;path&nbsp;is&nbsp;a&nbsp;directory&nbsp;or&nbsp;file,&nbsp;stop&nbsp;with&nbsp;success&nbsp;or&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2495921">dir</span><span class="op" id="2495924">,</span>&nbsp;<span class="ident" id="2495926">err</span>&nbsp;<span class="op" id="2495930">:=</span>&nbsp;<span class="ident" id="2495933">Stat</span><span class="op" id="2495937">(</span><span class="ident" id="2495938">path</span><span class="op" id="2495942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2495945">if</span>&nbsp;<span class="ident" id="2495948">err</span>&nbsp;<span class="op" id="2495952">==</span>&nbsp;<span class="ident" id="2495955">nil</span>&nbsp;<span class="op" id="2495959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2495963">if</span>&nbsp;<span class="ident" id="2495966">dir</span><span class="op" id="2495969">.</span><span class="ident" id="2495970">IsDir</span><span class="op" id="2495975">(</span><span class="op" id="2495976">)</span>&nbsp;<span class="op" id="2495978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2495983">return</span>&nbsp;<span class="ident" id="2495990">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2495996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2496000">return</span>&nbsp;<span class="op" id="2496007">&amp;</span><span class="ident" id="2496008">PathError</span><span class="op" id="2496017">{</span><span class="string" id="2496018">&#34;mkdir&#34;</span><span class="op" id="2496025">,</span>&nbsp;<span class="ident" id="2496027">path</span><span class="op" id="2496031">,</span>&nbsp;<span class="ident" id="2496033">syscall</span><span class="op" id="2496040">.</span><span class="ident" id="2496041">ENOTDIR</span><span class="op" id="2496048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2496051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2496055">//&nbsp;Slow&nbsp;path:&nbsp;make&nbsp;sure&nbsp;parent&nbsp;exists&nbsp;and&nbsp;then&nbsp;call&nbsp;Mkdir&nbsp;for&nbsp;path.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2496124">i</span>&nbsp;<span class="op" id="2496126">:=</span>&nbsp;<span class="builtinfunc" id="2496129">len</span><span class="op" id="2496132">(</span><span class="ident" id="2496133">path</span><span class="op" id="2496137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2496140">for</span>&nbsp;<span class="ident" id="2496144">i</span>&nbsp;<span class="op" id="2496146">&gt;</span>&nbsp;<span class="num" id="2496148">0</span>&nbsp;<span class="op" id="2496150">&amp;&amp;</span>&nbsp;<span class="ident" id="2496153">IsPathSeparator</span><span class="op" id="2496168">(</span><span class="ident" id="2496169">path</span><span class="op" id="2496173">[</span><span class="ident" id="2496174">i</span><span class="op" id="2496175">-</span><span class="num" id="2496176">1</span><span class="op" id="2496177">]</span><span class="op" id="2496178">)</span>&nbsp;<span class="op" id="2496180">{</span>&nbsp;<span class="comment" id="2496182">//&nbsp;Skip&nbsp;trailing&nbsp;path&nbsp;separator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2496217">i</span><span class="op" id="2496218">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2496222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2496226">j</span>&nbsp;<span class="op" id="2496228">:=</span>&nbsp;<span class="ident" id="2496231">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2496234">for</span>&nbsp;<span class="ident" id="2496238">j</span>&nbsp;<span class="op" id="2496240">&gt;</span>&nbsp;<span class="num" id="2496242">0</span>&nbsp;<span class="op" id="2496244">&amp;&amp;</span>&nbsp;<span class="op" id="2496247">!</span><span class="ident" id="2496248">IsPathSeparator</span><span class="op" id="2496263">(</span><span class="ident" id="2496264">path</span><span class="op" id="2496268">[</span><span class="ident" id="2496269">j</span><span class="op" id="2496270">-</span><span class="num" id="2496271">1</span><span class="op" id="2496272">]</span><span class="op" id="2496273">)</span>&nbsp;<span class="op" id="2496275">{</span>&nbsp;<span class="comment" id="2496277">//&nbsp;Scan&nbsp;backward&nbsp;over&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2496310">j</span><span class="op" id="2496311">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2496315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2496319">if</span>&nbsp;<span class="ident" id="2496322">j</span>&nbsp;<span class="op" id="2496324">&gt;</span>&nbsp;<span class="num" id="2496326">1</span>&nbsp;<span class="op" id="2496328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2496332">//&nbsp;Create&nbsp;parent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2496351">err</span>&nbsp;<span class="op" id="2496355">=</span>&nbsp;<span class="ident" id="2496357">MkdirAll</span><span class="op" id="2496365">(</span><span class="ident" id="2496366">path</span><span class="op" id="2496370">[</span><span class="num" id="2496371">0</span><span class="op" id="2496372">:</span><span class="ident" id="2496373">j</span><span class="op" id="2496374">-</span><span class="num" id="2496375">1</span><span class="op" id="2496376">]</span><span class="op" id="2496377">,</span>&nbsp;<span class="ident" id="2496379">perm</span><span class="op" id="2496383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2496387">if</span>&nbsp;<span class="ident" id="2496390">err</span>&nbsp;<span class="op" id="2496394">!=</span>&nbsp;<span class="ident" id="2496397">nil</span>&nbsp;<span class="op" id="2496401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2496406">return</span>&nbsp;<span class="ident" id="2496413">err</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2496419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2496422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2496426">//&nbsp;Parent&nbsp;now&nbsp;exists;&nbsp;invoke&nbsp;Mkdir&nbsp;and&nbsp;use&nbsp;its&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2496482">err</span>&nbsp;<span class="op" id="2496486">=</span>&nbsp;<span class="ident" id="2496488">Mkdir</span><span class="op" id="2496493">(</span><span class="ident" id="2496494">path</span><span class="op" id="2496498">,</span>&nbsp;<span class="ident" id="2496500">perm</span><span class="op" id="2496504">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2496507">if</span>&nbsp;<span class="ident" id="2496510">err</span>&nbsp;<span class="op" id="2496514">!=</span>&nbsp;<span class="ident" id="2496517">nil</span>&nbsp;<span class="op" id="2496521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2496525">//&nbsp;Handle&nbsp;arguments&nbsp;like&nbsp;&#34;foo/.&#34;&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2496563">//&nbsp;double-checking&nbsp;that&nbsp;directory&nbsp;doesn&#39;t&nbsp;exist.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2496614">dir</span><span class="op" id="2496617">,</span>&nbsp;<span class="ident" id="2496619">err1</span>&nbsp;<span class="op" id="2496624">:=</span>&nbsp;<span class="ident" id="2496627">Lstat</span><span class="op" id="2496632">(</span><span class="ident" id="2496633">path</span><span class="op" id="2496637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2496641">if</span>&nbsp;<span class="ident" id="2496644">err1</span>&nbsp;<span class="op" id="2496649">==</span>&nbsp;<span class="ident" id="2496652">nil</span>&nbsp;<span class="op" id="2496656">&amp;&amp;</span>&nbsp;<span class="ident" id="2496659">dir</span><span class="op" id="2496662">.</span><span class="ident" id="2496663">IsDir</span><span class="op" id="2496668">(</span><span class="op" id="2496669">)</span>&nbsp;<span class="op" id="2496671">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2496676">return</span>&nbsp;<span class="ident" id="2496683">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2496689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2496693">return</span>&nbsp;<span class="ident" id="2496700">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2496705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2496708">return</span>&nbsp;<span class="ident" id="2496715">nil</span><br>
<span class="lineno">60</span><span class="op" id="2496719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2496722">//&nbsp;RemoveAll&nbsp;removes&nbsp;path&nbsp;and&nbsp;any&nbsp;children&nbsp;it&nbsp;contains.</span><br>
<span class="lineno"></span><span class="comment" id="2496778">//&nbsp;It&nbsp;removes&nbsp;everything&nbsp;it&nbsp;can&nbsp;but&nbsp;returns&nbsp;the&nbsp;first&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2496838">//&nbsp;it&nbsp;encounters.&nbsp;&nbsp;If&nbsp;the&nbsp;path&nbsp;does&nbsp;not&nbsp;exist,&nbsp;RemoveAll</span><br>
<span class="lineno">65</span><span class="comment" id="2496895">//&nbsp;returns&nbsp;nil&nbsp;(no&nbsp;error).</span><br>
<span class="lineno"></span><span class="keyword" id="2496922">func</span>&nbsp;<span class="ident" id="2496927">RemoveAll</span><span class="op" id="2496936">(</span><span class="ident" id="2496937">path</span>&nbsp;<span class="builtintype" id="2496942">string</span><span class="op" id="2496948">)</span>&nbsp;<span class="builtintype" id="2496950">error</span>&nbsp;<span class="op" id="2496956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2496959">//&nbsp;Simple&nbsp;case:&nbsp;if&nbsp;Remove&nbsp;works,&nbsp;we&#39;re&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2497005">err</span>&nbsp;<span class="op" id="2497009">:=</span>&nbsp;<span class="ident" id="2497012">Remove</span><span class="op" id="2497018">(</span><span class="ident" id="2497019">path</span><span class="op" id="2497023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497026">if</span>&nbsp;<span class="ident" id="2497029">err</span>&nbsp;<span class="op" id="2497033">==</span>&nbsp;<span class="ident" id="2497036">nil</span>&nbsp;<span class="op" id="2497040">||</span>&nbsp;<span class="ident" id="2497043">IsNotExist</span><span class="op" id="2497053">(</span><span class="ident" id="2497054">err</span><span class="op" id="2497057">)</span>&nbsp;<span class="op" id="2497059">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497063">return</span>&nbsp;<span class="ident" id="2497070">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2497075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2497079">//&nbsp;Otherwise,&nbsp;is&nbsp;this&nbsp;a&nbsp;directory&nbsp;we&nbsp;need&nbsp;to&nbsp;recurse&nbsp;into?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2497139">dir</span><span class="op" id="2497142">,</span>&nbsp;<span class="ident" id="2497144">serr</span>&nbsp;<span class="op" id="2497149">:=</span>&nbsp;<span class="ident" id="2497152">Lstat</span><span class="op" id="2497157">(</span><span class="ident" id="2497158">path</span><span class="op" id="2497162">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497165">if</span>&nbsp;<span class="ident" id="2497168">serr</span>&nbsp;<span class="op" id="2497173">!=</span>&nbsp;<span class="ident" id="2497176">nil</span>&nbsp;<span class="op" id="2497180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497184">if</span>&nbsp;<span class="ident" id="2497187">serr</span><span class="op" id="2497191">,</span>&nbsp;<span class="ident" id="2497193">ok</span>&nbsp;<span class="op" id="2497196">:=</span>&nbsp;<span class="ident" id="2497199">serr</span><span class="op" id="2497203">.</span><span class="op" id="2497204">(</span><span class="op" id="2497205">*</span><span class="ident" id="2497206">PathError</span><span class="op" id="2497215">)</span><span class="op" id="2497216">;</span>&nbsp;<span class="ident" id="2497218">ok</span>&nbsp;<span class="op" id="2497221">&amp;&amp;</span>&nbsp;<span class="op" id="2497224">(</span><span class="ident" id="2497225">IsNotExist</span><span class="op" id="2497235">(</span><span class="ident" id="2497236">serr</span><span class="op" id="2497240">.</span><span class="ident" id="2497241">Err</span><span class="op" id="2497244">)</span>&nbsp;<span class="op" id="2497246">||</span>&nbsp;<span class="ident" id="2497249">serr</span><span class="op" id="2497253">.</span><span class="ident" id="2497254">Err</span>&nbsp;<span class="op" id="2497258">==</span>&nbsp;<span class="ident" id="2497261">syscall</span><span class="op" id="2497268">.</span><span class="ident" id="2497269">ENOTDIR</span><span class="op" id="2497276">)</span>&nbsp;<span class="op" id="2497278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497283">return</span>&nbsp;<span class="ident" id="2497290">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2497296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497300">return</span>&nbsp;<span class="ident" id="2497307">serr</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2497313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497316">if</span>&nbsp;<span class="op" id="2497319">!</span><span class="ident" id="2497320">dir</span><span class="op" id="2497323">.</span><span class="ident" id="2497324">IsDir</span><span class="op" id="2497329">(</span><span class="op" id="2497330">)</span>&nbsp;<span class="op" id="2497332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2497336">//&nbsp;Not&nbsp;a&nbsp;directory;&nbsp;return&nbsp;the&nbsp;error&nbsp;from&nbsp;Remove.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497388">return</span>&nbsp;<span class="ident" id="2497395">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2497400">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2497404">//&nbsp;Directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2497419">fd</span><span class="op" id="2497421">,</span>&nbsp;<span class="ident" id="2497423">err</span>&nbsp;<span class="op" id="2497427">:=</span>&nbsp;<span class="ident" id="2497430">Open</span><span class="op" id="2497434">(</span><span class="ident" id="2497435">path</span><span class="op" id="2497439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497442">if</span>&nbsp;<span class="ident" id="2497445">err</span>&nbsp;<span class="op" id="2497449">!=</span>&nbsp;<span class="ident" id="2497452">nil</span>&nbsp;<span class="op" id="2497456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497460">if</span>&nbsp;<span class="ident" id="2497463">IsNotExist</span><span class="op" id="2497473">(</span><span class="ident" id="2497474">err</span><span class="op" id="2497477">)</span>&nbsp;<span class="op" id="2497479">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2497484">//&nbsp;Race.&nbsp;It&nbsp;was&nbsp;deleted&nbsp;between&nbsp;the&nbsp;Lstat&nbsp;and&nbsp;Open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2497539">//&nbsp;Return&nbsp;nil&nbsp;per&nbsp;RemoveAll&#39;s&nbsp;docs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497578">return</span>&nbsp;<span class="ident" id="2497585">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2497591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497595">return</span>&nbsp;<span class="ident" id="2497602">err</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2497607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2497611">//&nbsp;Remove&nbsp;contents&nbsp;&amp;&nbsp;return&nbsp;first&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2497653">err</span>&nbsp;<span class="op" id="2497657">=</span>&nbsp;<span class="ident" id="2497659">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497664">for</span>&nbsp;<span class="op" id="2497668">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2497672">names</span><span class="op" id="2497677">,</span>&nbsp;<span class="ident" id="2497679">err1</span>&nbsp;<span class="op" id="2497684">:=</span>&nbsp;<span class="ident" id="2497687">fd</span><span class="op" id="2497689">.</span><span class="ident" id="2497690">Readdirnames</span><span class="op" id="2497702">(</span><span class="num" id="2497703">100</span><span class="op" id="2497706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497710">for</span>&nbsp;<span class="ident" id="2497714">_</span><span class="op" id="2497715">,</span>&nbsp;<span class="ident" id="2497717">name</span>&nbsp;<span class="op" id="2497722">:=</span>&nbsp;<span class="keyword" id="2497725">range</span>&nbsp;<span class="ident" id="2497731">names</span>&nbsp;<span class="op" id="2497737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2497742">err1</span>&nbsp;<span class="op" id="2497747">:=</span>&nbsp;<span class="ident" id="2497750">RemoveAll</span><span class="op" id="2497759">(</span><span class="ident" id="2497760">path</span>&nbsp;<span class="op" id="2497765">+</span>&nbsp;<span class="builtintype" id="2497767">string</span><span class="op" id="2497773">(</span><span class="ident" id="2497774">PathSeparator</span><span class="op" id="2497787">)</span>&nbsp;<span class="op" id="2497789">+</span>&nbsp;<span class="ident" id="2497791">name</span><span class="op" id="2497795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497800">if</span>&nbsp;<span class="ident" id="2497803">err</span>&nbsp;<span class="op" id="2497807">==</span>&nbsp;<span class="ident" id="2497810">nil</span>&nbsp;<span class="op" id="2497814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2497820">err</span>&nbsp;<span class="op" id="2497824">=</span>&nbsp;<span class="ident" id="2497826">err1</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2497834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2497838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497842">if</span>&nbsp;<span class="ident" id="2497845">err1</span>&nbsp;<span class="op" id="2497850">==</span>&nbsp;<span class="ident" id="2497853">io</span><span class="op" id="2497855">.</span><span class="ident" id="2497856">EOF</span>&nbsp;<span class="op" id="2497860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497865">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2497873">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2497877">//&nbsp;If&nbsp;Readdirnames&nbsp;returned&nbsp;an&nbsp;error,&nbsp;use&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497925">if</span>&nbsp;<span class="ident" id="2497928">err</span>&nbsp;<span class="op" id="2497932">==</span>&nbsp;<span class="ident" id="2497935">nil</span>&nbsp;<span class="op" id="2497939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2497944">err</span>&nbsp;<span class="op" id="2497948">=</span>&nbsp;<span class="ident" id="2497950">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2497957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497961">if</span>&nbsp;<span class="builtinfunc" id="2497964">len</span><span class="op" id="2497967">(</span><span class="ident" id="2497968">names</span><span class="op" id="2497973">)</span>&nbsp;<span class="op" id="2497975">==</span>&nbsp;<span class="num" id="2497978">0</span>&nbsp;<span class="op" id="2497980">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2497985">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2497993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2497996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2498000">//&nbsp;Close&nbsp;directory,&nbsp;because&nbsp;windows&nbsp;won&#39;t&nbsp;remove&nbsp;opened&nbsp;directory.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2498068">fd</span><span class="op" id="2498070">.</span><span class="ident" id="2498071">Close</span><span class="op" id="2498076">(</span><span class="op" id="2498077">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2498081">//&nbsp;Remove&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2498103">err1</span>&nbsp;<span class="op" id="2498108">:=</span>&nbsp;<span class="ident" id="2498111">Remove</span><span class="op" id="2498117">(</span><span class="ident" id="2498118">path</span><span class="op" id="2498122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2498125">if</span>&nbsp;<span class="ident" id="2498128">err1</span>&nbsp;<span class="op" id="2498133">==</span>&nbsp;<span class="ident" id="2498136">nil</span>&nbsp;<span class="op" id="2498140">||</span>&nbsp;<span class="ident" id="2498143">IsNotExist</span><span class="op" id="2498153">(</span><span class="ident" id="2498154">err1</span><span class="op" id="2498158">)</span>&nbsp;<span class="op" id="2498160">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2498164">return</span>&nbsp;<span class="ident" id="2498171">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2498176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2498179">if</span>&nbsp;<span class="ident" id="2498182">err</span>&nbsp;<span class="op" id="2498186">==</span>&nbsp;<span class="ident" id="2498189">nil</span>&nbsp;<span class="op" id="2498193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2498197">err</span>&nbsp;<span class="op" id="2498201">=</span>&nbsp;<span class="ident" id="2498203">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2498209">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2498212">return</span>&nbsp;<span class="ident" id="2498219">err</span><br>
<span class="lineno"></span><span class="op" id="2498223">}</span>
</div>
</body>
</html>
