<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5080789">package</span>&nbsp;<span class="ident" id="5080797">asm8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5080803">import</span>&nbsp;<span class="op" id="5080810">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5080813">&#34;lonnie.io/e8vm/lex8&#34;</span><br>
<span class="lineno">5</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5080836">&#34;lonnie.io/e8vm/link8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5080859">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5080862">//&nbsp;buildFunc&nbsp;builds&nbsp;a&nbsp;function&nbsp;object&nbsp;from&nbsp;a&nbsp;function&nbsp;AST&nbsp;node.</span><br>
<span class="lineno"></span><span class="keyword" id="5080926">func</span>&nbsp;<span class="ident" id="5080931">buildFunc</span><span class="op" id="5080940">(</span><span class="ident" id="5080941">b</span>&nbsp;<span class="op" id="5080943">*</span><span class="ident" id="5080944">builder</span><span class="op" id="5080951">,</span>&nbsp;<span class="ident" id="5080953">f</span>&nbsp;<span class="op" id="5080955">*</span><span class="ident" id="5080956">funcDecl</span><span class="op" id="5080964">)</span>&nbsp;<span class="op" id="5080966">*</span><span class="ident" id="5080967">link8</span><span class="op" id="5080972">.</span><span class="ident" id="5080973">Func</span>&nbsp;<span class="op" id="5080978">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5080981">b</span><span class="op" id="5080982">.</span><span class="ident" id="5080983">scope</span><span class="op" id="5080988">.</span><span class="ident" id="5080989">Push</span><span class="op" id="5080993">(</span><span class="op" id="5080994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5080997">defer</span>&nbsp;<span class="ident" id="5081003">b</span><span class="op" id="5081004">.</span><span class="ident" id="5081005">scope</span><span class="op" id="5081010">.</span><span class="ident" id="5081011">Pop</span><span class="op" id="5081014">(</span><span class="op" id="5081015">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5081019">b</span><span class="op" id="5081020">.</span><span class="ident" id="5081021">clearErr</span><span class="op" id="5081029">(</span><span class="op" id="5081030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5081033">declareLabels</span><span class="op" id="5081046">(</span><span class="ident" id="5081047">b</span><span class="op" id="5081048">,</span>&nbsp;<span class="ident" id="5081050">f</span><span class="op" id="5081051">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5081054">if</span>&nbsp;<span class="op" id="5081057">!</span><span class="ident" id="5081058">b</span><span class="op" id="5081059">.</span><span class="ident" id="5081060">hasError</span>&nbsp;<span class="op" id="5081069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5081073">setOffsets</span><span class="op" id="5081083">(</span><span class="ident" id="5081084">b</span><span class="op" id="5081085">,</span>&nbsp;<span class="ident" id="5081087">f</span><span class="op" id="5081088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5081092">fillLabels</span><span class="op" id="5081102">(</span><span class="ident" id="5081103">b</span><span class="op" id="5081104">,</span>&nbsp;<span class="ident" id="5081106">f</span><span class="op" id="5081107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5081110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5081114">return</span>&nbsp;<span class="ident" id="5081121">makeFuncObj</span><span class="op" id="5081132">(</span><span class="ident" id="5081133">b</span><span class="op" id="5081134">,</span>&nbsp;<span class="ident" id="5081136">f</span><span class="op" id="5081137">)</span><br>
<span class="lineno"></span><span class="op" id="5081139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5081142">//&nbsp;declareLabels&nbsp;adds&nbsp;the&nbsp;labels&nbsp;into&nbsp;the&nbsp;scope,</span><br>
<span class="lineno"></span><span class="comment" id="5081191">//&nbsp;so&nbsp;that&nbsp;later&nbsp;they&nbsp;can&nbsp;be&nbsp;queried&nbsp;for&nbsp;filling.</span><br>
<span class="lineno">25</span><span class="keyword" id="5081241">func</span>&nbsp;<span class="ident" id="5081246">declareLabels</span><span class="op" id="5081259">(</span><span class="ident" id="5081260">b</span>&nbsp;<span class="op" id="5081262">*</span><span class="ident" id="5081263">builder</span><span class="op" id="5081270">,</span>&nbsp;<span class="ident" id="5081272">f</span>&nbsp;<span class="op" id="5081274">*</span><span class="ident" id="5081275">funcDecl</span><span class="op" id="5081283">)</span>&nbsp;<span class="op" id="5081285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5081288">for</span>&nbsp;<span class="ident" id="5081292">_</span><span class="op" id="5081293">,</span>&nbsp;<span class="ident" id="5081295">stmt</span>&nbsp;<span class="op" id="5081300">:=</span>&nbsp;<span class="keyword" id="5081303">range</span>&nbsp;<span class="ident" id="5081309">f</span><span class="op" id="5081310">.</span><span class="ident" id="5081311">stmts</span>&nbsp;<span class="op" id="5081317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5081321">if</span>&nbsp;<span class="op" id="5081324">!</span><span class="ident" id="5081325">stmt</span><span class="op" id="5081329">.</span><span class="ident" id="5081330">isLabel</span><span class="op" id="5081337">(</span><span class="op" id="5081338">)</span>&nbsp;<span class="op" id="5081340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5081345">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5081356">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5081361">lab</span>&nbsp;<span class="op" id="5081365">:=</span>&nbsp;<span class="ident" id="5081368">stmt</span><span class="op" id="5081372">.</span><span class="ident" id="5081373">label</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5081381">op</span>&nbsp;<span class="op" id="5081384">:=</span>&nbsp;<span class="ident" id="5081387">stmt</span><span class="op" id="5081391">.</span><span class="ident" id="5081392">ops</span><span class="op" id="5081395">[</span><span class="num" id="5081396">0</span><span class="op" id="5081397">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5081401">sym</span>&nbsp;<span class="op" id="5081405">:=</span>&nbsp;<span class="op" id="5081408">&amp;</span><span class="ident" id="5081409">symbol</span><span class="op" id="5081415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5081420">Name</span><span class="op" id="5081424">:</span>&nbsp;<span class="ident" id="5081426">lab</span><span class="op" id="5081429">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5081434">Type</span><span class="op" id="5081438">:</span>&nbsp;<span class="ident" id="5081440">SymLabel</span><span class="op" id="5081448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5081453">Item</span><span class="op" id="5081457">:</span>&nbsp;<span class="ident" id="5081459">stmt</span><span class="op" id="5081463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5081468">Pos</span><span class="op" id="5081471">:</span>&nbsp;&nbsp;<span class="ident" id="5081474">op</span><span class="op" id="5081476">.</span><span class="ident" id="5081477">Pos</span><span class="op" id="5081480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5081484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5081489">decl</span>&nbsp;<span class="op" id="5081494">:=</span>&nbsp;<span class="ident" id="5081497">b</span><span class="op" id="5081498">.</span><span class="ident" id="5081499">scope</span><span class="op" id="5081504">.</span><span class="ident" id="5081505">Declare</span><span class="op" id="5081512">(</span><span class="ident" id="5081513">sym</span><span class="op" id="5081516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5081520">if</span>&nbsp;<span class="ident" id="5081523">decl</span>&nbsp;<span class="op" id="5081528">!=</span>&nbsp;<span class="ident" id="5081531">nil</span>&nbsp;<span class="op" id="5081535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5081540">b</span><span class="op" id="5081541">.</span><span class="ident" id="5081542">err</span><span class="op" id="5081545">(</span><span class="ident" id="5081546">op</span><span class="op" id="5081548">.</span><span class="ident" id="5081549">Pos</span><span class="op" id="5081552">,</span>&nbsp;<span class="string" id="5081554">&#34;%q&nbsp;already&nbsp;declared&#34;</span><span class="op" id="5081575">,</span>&nbsp;<span class="ident" id="5081577">lab</span><span class="op" id="5081580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5081585">b</span><span class="op" id="5081586">.</span><span class="ident" id="5081587">err</span><span class="op" id="5081590">(</span><span class="ident" id="5081591">decl</span><span class="op" id="5081595">.</span><span class="ident" id="5081596">Pos</span><span class="op" id="5081599">,</span>&nbsp;<span class="string" id="5081601">&#34;&nbsp;&nbsp;here&nbsp;as&nbsp;a&nbsp;%s&#34;</span><span class="op" id="5081617">,</span>&nbsp;<span class="ident" id="5081619">symStr</span><span class="op" id="5081625">(</span><span class="ident" id="5081626">decl</span><span class="op" id="5081630">.</span><span class="ident" id="5081631">Type</span><span class="op" id="5081635">)</span><span class="op" id="5081636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5081641">continue</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5081652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5081655">}</span><br>
<span class="lineno"></span><span class="op" id="5081657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5081660">//&nbsp;setOffsets&nbsp;calculates&nbsp;the&nbsp;offset&nbsp;in&nbsp;function&nbsp;for&nbsp;each&nbsp;instruction.</span><br>
<span class="lineno">50</span><span class="keyword" id="5081730">func</span>&nbsp;<span class="ident" id="5081735">setOffsets</span><span class="op" id="5081745">(</span><span class="ident" id="5081746">b</span>&nbsp;<span class="op" id="5081748">*</span><span class="ident" id="5081749">builder</span><span class="op" id="5081756">,</span>&nbsp;<span class="ident" id="5081758">f</span>&nbsp;<span class="op" id="5081760">*</span><span class="ident" id="5081761">funcDecl</span><span class="op" id="5081769">)</span>&nbsp;<span class="op" id="5081771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5081774">offset</span>&nbsp;<span class="op" id="5081781">:=</span>&nbsp;<span class="builtintype" id="5081784">uint32</span><span class="op" id="5081790">(</span><span class="num" id="5081791">0</span><span class="op" id="5081792">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5081796">for</span>&nbsp;<span class="ident" id="5081800">_</span><span class="op" id="5081801">,</span>&nbsp;<span class="ident" id="5081803">s</span>&nbsp;<span class="op" id="5081805">:=</span>&nbsp;<span class="keyword" id="5081808">range</span>&nbsp;<span class="ident" id="5081814">f</span><span class="op" id="5081815">.</span><span class="ident" id="5081816">stmts</span>&nbsp;<span class="op" id="5081822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5081826">s</span><span class="op" id="5081827">.</span><span class="ident" id="5081828">offset</span>&nbsp;<span class="op" id="5081835">=</span>&nbsp;<span class="ident" id="5081837">offset</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5081846">if</span>&nbsp;<span class="ident" id="5081849">s</span><span class="op" id="5081850">.</span><span class="ident" id="5081851">isLabel</span><span class="op" id="5081858">(</span><span class="op" id="5081859">)</span>&nbsp;<span class="op" id="5081861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5081866">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5081877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5081882">offset</span>&nbsp;<span class="op" id="5081889">+=</span>&nbsp;<span class="num" id="5081892">4</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5081895">}</span><br>
<span class="lineno"></span><span class="op" id="5081897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5081900">//&nbsp;fillDelta&nbsp;will&nbsp;fill&nbsp;the&nbsp;particular&nbsp;instruction</span><br>
<span class="lineno"></span><span class="comment" id="5081950">//&nbsp;with&nbsp;a&nbsp;jumping/branching&nbsp;offset&nbsp;d.</span><br>
<span class="lineno">65</span><span class="keyword" id="5081988">func</span>&nbsp;<span class="ident" id="5081993">fillDelta</span><span class="op" id="5082002">(</span><span class="ident" id="5082003">b</span>&nbsp;<span class="op" id="5082005">*</span><span class="ident" id="5082006">builder</span><span class="op" id="5082013">,</span>&nbsp;<span class="ident" id="5082015">t</span>&nbsp;<span class="op" id="5082017">*</span><span class="ident" id="5082018">lex8</span><span class="op" id="5082022">.</span><span class="ident" id="5082023">Token</span><span class="op" id="5082028">,</span>&nbsp;<span class="ident" id="5082030">inst</span>&nbsp;<span class="op" id="5082035">*</span><span class="builtintype" id="5082036">uint32</span><span class="op" id="5082042">,</span>&nbsp;<span class="ident" id="5082044">d</span>&nbsp;<span class="builtintype" id="5082046">uint32</span><span class="op" id="5082052">)</span>&nbsp;<span class="op" id="5082054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5082057">if</span>&nbsp;<span class="ident" id="5082060">isJump</span><span class="op" id="5082066">(</span><span class="op" id="5082067">*</span><span class="ident" id="5082068">inst</span><span class="op" id="5082072">)</span>&nbsp;<span class="op" id="5082074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5082078">*</span><span class="ident" id="5082079">inst</span>&nbsp;<span class="op" id="5082084">|=</span>&nbsp;<span class="ident" id="5082087">d</span>&nbsp;<span class="op" id="5082089">&amp;</span>&nbsp;<span class="num" id="5082091">0x3fffffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5082103">}</span>&nbsp;<span class="keyword" id="5082105">else</span>&nbsp;<span class="op" id="5082110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5082114">//&nbsp;it&nbsp;is&nbsp;a&nbsp;branch</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5082134">if</span>&nbsp;<span class="op" id="5082137">!</span><span class="ident" id="5082138">inBrRange</span><span class="op" id="5082147">(</span><span class="ident" id="5082148">d</span><span class="op" id="5082149">)</span>&nbsp;<span class="op" id="5082151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5082156">b</span><span class="op" id="5082157">.</span><span class="ident" id="5082158">err</span><span class="op" id="5082161">(</span><span class="ident" id="5082162">t</span><span class="op" id="5082163">.</span><span class="ident" id="5082164">Pos</span><span class="op" id="5082167">,</span>&nbsp;<span class="string" id="5082169">&#34;%q&nbsp;is&nbsp;out&nbsp;of&nbsp;branch&nbsp;range&#34;</span><span class="op" id="5082196">,</span>&nbsp;<span class="ident" id="5082198">t</span><span class="op" id="5082199">.</span><span class="ident" id="5082200">Lit</span><span class="op" id="5082203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5082207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5082211">*</span><span class="ident" id="5082212">inst</span>&nbsp;<span class="op" id="5082217">|=</span>&nbsp;<span class="ident" id="5082220">d</span>&nbsp;<span class="op" id="5082222">&amp;</span>&nbsp;<span class="num" id="5082224">0x3ffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5082233">}</span><br>
<span class="lineno">75</span><span class="op" id="5082235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5082238">//&nbsp;fillLabels&nbsp;fills&nbsp;all&nbsp;the&nbsp;labels&nbsp;in&nbsp;the&nbsp;function.&nbsp;After&nbsp;the&nbsp;filling,&nbsp;all&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5082317">//&nbsp;symbols&nbsp;left&nbsp;will&nbsp;be&nbsp;fillLink,&nbsp;fillHigh&nbsp;and&nbsp;fillLow&nbsp;and&nbsp;all&nbsp;branches&nbsp;(which</span><br>
<span class="lineno"></span><span class="comment" id="5082396">//&nbsp;must&nbsp;use&nbsp;labels)&nbsp;will&nbsp;be&nbsp;filled.</span><br>
<span class="lineno">80</span><span class="keyword" id="5082432">func</span>&nbsp;<span class="ident" id="5082437">fillLabels</span><span class="op" id="5082447">(</span><span class="ident" id="5082448">b</span>&nbsp;<span class="op" id="5082450">*</span><span class="ident" id="5082451">builder</span><span class="op" id="5082458">,</span>&nbsp;<span class="ident" id="5082460">f</span>&nbsp;<span class="op" id="5082462">*</span><span class="ident" id="5082463">funcDecl</span><span class="op" id="5082471">)</span>&nbsp;<span class="op" id="5082473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5082476">for</span>&nbsp;<span class="ident" id="5082480">_</span><span class="op" id="5082481">,</span>&nbsp;<span class="ident" id="5082483">s</span>&nbsp;<span class="op" id="5082485">:=</span>&nbsp;<span class="keyword" id="5082488">range</span>&nbsp;<span class="ident" id="5082494">f</span><span class="op" id="5082495">.</span><span class="ident" id="5082496">stmts</span>&nbsp;<span class="op" id="5082502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5082506">if</span>&nbsp;<span class="ident" id="5082509">s</span><span class="op" id="5082510">.</span><span class="ident" id="5082511">isLabel</span><span class="op" id="5082518">(</span><span class="op" id="5082519">)</span>&nbsp;<span class="op" id="5082521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5082526">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5082537">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5082541">if</span>&nbsp;<span class="ident" id="5082544">s</span><span class="op" id="5082545">.</span><span class="ident" id="5082546">fill</span>&nbsp;<span class="op" id="5082551">!=</span>&nbsp;<span class="ident" id="5082554">fillLabel</span>&nbsp;<span class="op" id="5082564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5082569">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5082580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5082584">if</span>&nbsp;<span class="ident" id="5082587">s</span><span class="op" id="5082588">.</span><span class="ident" id="5082589">pack</span>&nbsp;<span class="op" id="5082594">!=</span>&nbsp;<span class="string" id="5082597">&#34;&#34;</span>&nbsp;<span class="op" id="5082600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5082605">panic</span><span class="op" id="5082610">(</span><span class="string" id="5082611">&#34;fill&nbsp;label&nbsp;with&nbsp;pack&nbsp;symbol&#34;</span><span class="op" id="5082640">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5082644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5082649">t</span>&nbsp;<span class="op" id="5082651">:=</span>&nbsp;<span class="ident" id="5082654">s</span><span class="op" id="5082655">.</span><span class="ident" id="5082656">symTok</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5082666">sym</span>&nbsp;<span class="op" id="5082670">:=</span>&nbsp;<span class="ident" id="5082673">b</span><span class="op" id="5082674">.</span><span class="ident" id="5082675">scope</span><span class="op" id="5082680">.</span><span class="ident" id="5082681">Query</span><span class="op" id="5082686">(</span><span class="ident" id="5082687">s</span><span class="op" id="5082688">.</span><span class="ident" id="5082689">symbol</span><span class="op" id="5082695">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5082699">if</span>&nbsp;<span class="ident" id="5082702">sym</span>&nbsp;<span class="op" id="5082706">==</span>&nbsp;<span class="ident" id="5082709">nil</span>&nbsp;<span class="op" id="5082713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5082718">b</span><span class="op" id="5082719">.</span><span class="ident" id="5082720">err</span><span class="op" id="5082723">(</span><span class="ident" id="5082724">t</span><span class="op" id="5082725">.</span><span class="ident" id="5082726">Pos</span><span class="op" id="5082729">,</span>&nbsp;<span class="string" id="5082731">&#34;label&nbsp;%q&nbsp;not&nbsp;declared&#34;</span><span class="op" id="5082754">,</span>&nbsp;<span class="ident" id="5082756">t</span><span class="op" id="5082757">.</span><span class="ident" id="5082758">Lit</span><span class="op" id="5082761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5082766">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5082777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5082782">if</span>&nbsp;<span class="ident" id="5082785">sym</span><span class="op" id="5082788">.</span><span class="ident" id="5082789">Type</span>&nbsp;<span class="op" id="5082794">!=</span>&nbsp;<span class="ident" id="5082797">SymLabel</span>&nbsp;<span class="op" id="5082806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5082811">panic</span><span class="op" id="5082816">(</span><span class="string" id="5082817">&#34;not&nbsp;a&nbsp;label&#34;</span><span class="op" id="5082830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5082834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5082839">lab</span>&nbsp;<span class="op" id="5082843">:=</span>&nbsp;<span class="ident" id="5082846">sym</span><span class="op" id="5082849">.</span><span class="ident" id="5082850">Item</span><span class="op" id="5082854">.</span><span class="op" id="5082855">(</span><span class="op" id="5082856">*</span><span class="ident" id="5082857">funcStmt</span><span class="op" id="5082865">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5082869">delta</span>&nbsp;<span class="op" id="5082875">:=</span>&nbsp;<span class="builtintype" id="5082878">uint32</span><span class="op" id="5082884">(</span><span class="builtintype" id="5082885">int32</span><span class="op" id="5082890">(</span><span class="ident" id="5082891">lab</span><span class="op" id="5082894">.</span><span class="ident" id="5082895">offset</span><span class="op" id="5082901">-</span><span class="ident" id="5082902">s</span><span class="op" id="5082903">.</span><span class="ident" id="5082904">offset</span><span class="op" id="5082910">-</span><span class="num" id="5082911">4</span><span class="op" id="5082912">)</span>&nbsp;<span class="op" id="5082914">&gt;&gt;</span>&nbsp;<span class="num" id="5082917">2</span><span class="op" id="5082918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5082922">fillDelta</span><span class="op" id="5082931">(</span><span class="ident" id="5082932">b</span><span class="op" id="5082933">,</span>&nbsp;<span class="ident" id="5082935">t</span><span class="op" id="5082936">,</span>&nbsp;<span class="op" id="5082938">&amp;</span><span class="ident" id="5082939">s</span><span class="op" id="5082940">.</span><span class="ident" id="5082941">inst</span><span class="op" id="5082945">.</span><span class="ident" id="5082946">inst</span><span class="op" id="5082950">,</span>&nbsp;<span class="ident" id="5082952">delta</span><span class="op" id="5082957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5082960">}</span><br>
<span class="lineno"></span><span class="op" id="5082962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="5082965">func</span>&nbsp;<span class="ident" id="5082970">queryPkg</span><span class="op" id="5082978">(</span><span class="ident" id="5082979">b</span>&nbsp;<span class="op" id="5082981">*</span><span class="ident" id="5082982">builder</span><span class="op" id="5082989">,</span>&nbsp;<span class="ident" id="5082991">t</span>&nbsp;<span class="op" id="5082993">*</span><span class="ident" id="5082994">lex8</span><span class="op" id="5082998">.</span><span class="ident" id="5082999">Token</span><span class="op" id="5083004">,</span>&nbsp;<span class="ident" id="5083006">pack</span>&nbsp;<span class="builtintype" id="5083011">string</span><span class="op" id="5083017">)</span>&nbsp;<span class="op" id="5083019">*</span><span class="ident" id="5083020">lib</span>&nbsp;<span class="op" id="5083024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5083027">sym</span>&nbsp;<span class="op" id="5083031">:=</span>&nbsp;<span class="ident" id="5083034">b</span><span class="op" id="5083035">.</span><span class="ident" id="5083036">scope</span><span class="op" id="5083041">.</span><span class="ident" id="5083042">Query</span><span class="op" id="5083047">(</span><span class="ident" id="5083048">pack</span><span class="op" id="5083052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5083055">if</span>&nbsp;<span class="ident" id="5083058">sym</span>&nbsp;<span class="op" id="5083062">==</span>&nbsp;<span class="ident" id="5083065">nil</span>&nbsp;<span class="op" id="5083069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5083073">b</span><span class="op" id="5083074">.</span><span class="ident" id="5083075">err</span><span class="op" id="5083078">(</span><span class="ident" id="5083079">t</span><span class="op" id="5083080">.</span><span class="ident" id="5083081">Pos</span><span class="op" id="5083084">,</span>&nbsp;<span class="string" id="5083086">&#34;package&nbsp;%q&nbsp;not&nbsp;found&#34;</span><span class="op" id="5083108">,</span>&nbsp;<span class="ident" id="5083110">pack</span><span class="op" id="5083114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5083118">return</span>&nbsp;<span class="ident" id="5083125">nil</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5083130">}</span>&nbsp;<span class="keyword" id="5083132">else</span>&nbsp;<span class="keyword" id="5083137">if</span>&nbsp;<span class="ident" id="5083140">sym</span><span class="op" id="5083143">.</span><span class="ident" id="5083144">Type</span>&nbsp;<span class="op" id="5083149">!=</span>&nbsp;<span class="ident" id="5083152">SymImport</span>&nbsp;<span class="op" id="5083162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5083166">b</span><span class="op" id="5083167">.</span><span class="ident" id="5083168">err</span><span class="op" id="5083171">(</span><span class="ident" id="5083172">t</span><span class="op" id="5083173">.</span><span class="ident" id="5083174">Pos</span><span class="op" id="5083177">,</span>&nbsp;<span class="string" id="5083179">&#34;%q&nbsp;is&nbsp;a&nbsp;%s,&nbsp;not&nbsp;a&nbsp;package&#34;</span><span class="op" id="5083206">,</span>&nbsp;<span class="ident" id="5083208">t</span><span class="op" id="5083209">.</span><span class="ident" id="5083210">Lit</span><span class="op" id="5083213">,</span>&nbsp;<span class="ident" id="5083215">symStr</span><span class="op" id="5083221">(</span><span class="ident" id="5083222">sym</span><span class="op" id="5083225">.</span><span class="ident" id="5083226">Type</span><span class="op" id="5083230">)</span><span class="op" id="5083231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5083235">return</span>&nbsp;<span class="ident" id="5083242">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5083247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5083250">return</span>&nbsp;<span class="ident" id="5083257">sym</span><span class="op" id="5083260">.</span><span class="ident" id="5083261">Item</span><span class="op" id="5083265">.</span><span class="op" id="5083266">(</span><span class="op" id="5083267">*</span><span class="ident" id="5083268">lib</span><span class="op" id="5083271">)</span><br>
<span class="lineno">120</span><span class="op" id="5083273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5083276">func</span>&nbsp;<span class="ident" id="5083281">init</span><span class="op" id="5083285">(</span><span class="op" id="5083286">)</span>&nbsp;<span class="op" id="5083288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5083291">as</span>&nbsp;<span class="op" id="5083294">:=</span>&nbsp;<span class="keyword" id="5083297">func</span><span class="op" id="5083301">(</span><span class="ident" id="5083302">b</span>&nbsp;<span class="builtintype" id="5083304">bool</span><span class="op" id="5083308">)</span>&nbsp;<span class="op" id="5083310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5083314">if</span>&nbsp;<span class="op" id="5083317">!</span><span class="ident" id="5083318">b</span>&nbsp;<span class="op" id="5083320">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5083325">panic</span><span class="op" id="5083330">(</span><span class="string" id="5083331">&#34;bug&#34;</span><span class="op" id="5083336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5083340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5083343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5083346">as</span><span class="op" id="5083348">(</span><span class="ident" id="5083349">fillNone</span>&nbsp;<span class="op" id="5083358">==</span>&nbsp;<span class="num" id="5083361">0</span>&nbsp;<span class="op" id="5083363">&amp;&amp;</span>&nbsp;<span class="ident" id="5083366">fillLabel</span>&nbsp;<span class="op" id="5083376">==</span>&nbsp;<span class="num" id="5083379">4</span><span class="op" id="5083380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5083383">as</span><span class="op" id="5083385">(</span><span class="ident" id="5083386">fillLink</span>&nbsp;<span class="op" id="5083395">==</span>&nbsp;<span class="ident" id="5083398">link8</span><span class="op" id="5083403">.</span><span class="ident" id="5083404">FillLink</span><span class="op" id="5083412">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5083415">as</span><span class="op" id="5083417">(</span><span class="ident" id="5083418">fillHigh</span>&nbsp;<span class="op" id="5083427">==</span>&nbsp;<span class="ident" id="5083430">link8</span><span class="op" id="5083435">.</span><span class="ident" id="5083436">FillHigh</span><span class="op" id="5083444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5083447">as</span><span class="op" id="5083449">(</span><span class="ident" id="5083450">fillLow</span>&nbsp;<span class="op" id="5083458">==</span>&nbsp;<span class="ident" id="5083461">link8</span><span class="op" id="5083466">.</span><span class="ident" id="5083467">FillLow</span><span class="op" id="5083474">)</span><br>
<span class="lineno"></span><span class="op" id="5083476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5083479">//&nbsp;resolveSymbol&nbsp;resolves&nbsp;the&nbsp;symbol&nbsp;in&nbsp;the&nbsp;statement,</span><br>
<span class="lineno">135</span><span class="comment" id="5083534">//&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;linking&nbsp;object&nbsp;and&nbsp;its&nbsp;&lt;sym,&nbsp;pkg&gt;&nbsp;index&nbsp;pair</span><br>
<span class="lineno"></span><span class="comment" id="5083601">//&nbsp;in&nbsp;the&nbsp;current&nbsp;package&nbsp;context.</span><br>
<span class="lineno"></span><span class="keyword" id="5083636">func</span>&nbsp;<span class="ident" id="5083641">resolveSymbol</span><span class="op" id="5083654">(</span><span class="ident" id="5083655">b</span>&nbsp;<span class="op" id="5083657">*</span><span class="ident" id="5083658">builder</span><span class="op" id="5083665">,</span>&nbsp;<span class="ident" id="5083667">s</span>&nbsp;<span class="op" id="5083669">*</span><span class="ident" id="5083670">funcStmt</span><span class="op" id="5083678">)</span>&nbsp;<span class="op" id="5083680">(</span><span class="ident" id="5083681">ret</span>&nbsp;<span class="op" id="5083685">*</span><span class="ident" id="5083686">symbol</span><span class="op" id="5083692">,</span>&nbsp;<span class="ident" id="5083694">pkg</span><span class="op" id="5083697">,</span>&nbsp;<span class="ident" id="5083699">index</span>&nbsp;<span class="builtintype" id="5083705">uint32</span><span class="op" id="5083711">)</span>&nbsp;<span class="op" id="5083713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5083716">t</span>&nbsp;<span class="op" id="5083718">:=</span>&nbsp;<span class="ident" id="5083721">s</span><span class="op" id="5083722">.</span><span class="ident" id="5083723">symTok</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5083732">if</span>&nbsp;<span class="ident" id="5083735">s</span><span class="op" id="5083736">.</span><span class="ident" id="5083737">pack</span>&nbsp;<span class="op" id="5083742">==</span>&nbsp;<span class="string" id="5083745">&#34;&#34;</span>&nbsp;<span class="op" id="5083748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5083752">ret</span>&nbsp;<span class="op" id="5083756">=</span>&nbsp;<span class="ident" id="5083758">b</span><span class="op" id="5083759">.</span><span class="ident" id="5083760">scope</span><span class="op" id="5083765">.</span><span class="ident" id="5083766">Query</span><span class="op" id="5083771">(</span><span class="ident" id="5083772">s</span><span class="op" id="5083773">.</span><span class="ident" id="5083774">symbol</span><span class="op" id="5083780">)</span>&nbsp;<span class="comment" id="5083782">//&nbsp;find&nbsp;the&nbsp;symbol&nbsp;in&nbsp;scope</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5083812">if</span>&nbsp;<span class="ident" id="5083815">ret</span>&nbsp;<span class="op" id="5083819">!=</span>&nbsp;<span class="ident" id="5083822">nil</span>&nbsp;<span class="op" id="5083826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5083831">var</span>&nbsp;<span class="ident" id="5083835">p</span>&nbsp;<span class="op" id="5083837">*</span><span class="ident" id="5083838">lib</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5083845">p</span><span class="op" id="5083846">,</span>&nbsp;<span class="ident" id="5083848">pkg</span>&nbsp;<span class="op" id="5083852">=</span>&nbsp;<span class="ident" id="5083854">b</span><span class="op" id="5083855">.</span><span class="ident" id="5083856">curPkg</span><span class="op" id="5083862">.</span><span class="ident" id="5083863">LibIndex</span><span class="op" id="5083871">(</span><span class="ident" id="5083872">ret</span><span class="op" id="5083875">.</span><span class="ident" id="5083876">Package</span><span class="op" id="5083883">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5083888">index</span>&nbsp;<span class="op" id="5083894">=</span>&nbsp;<span class="ident" id="5083896">p</span><span class="op" id="5083897">.</span><span class="ident" id="5083898">SymIndex</span><span class="op" id="5083906">(</span><span class="ident" id="5083907">ret</span><span class="op" id="5083910">.</span><span class="ident" id="5083911">Name</span><span class="op" id="5083915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5083919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5083922">}</span>&nbsp;<span class="keyword" id="5083924">else</span>&nbsp;<span class="op" id="5083929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5083933">p</span>&nbsp;<span class="op" id="5083935">:=</span>&nbsp;<span class="ident" id="5083938">queryPkg</span><span class="op" id="5083946">(</span><span class="ident" id="5083947">b</span><span class="op" id="5083948">,</span>&nbsp;<span class="ident" id="5083950">t</span><span class="op" id="5083951">,</span>&nbsp;<span class="ident" id="5083953">s</span><span class="op" id="5083954">.</span><span class="ident" id="5083955">pack</span><span class="op" id="5083959">)</span>&nbsp;<span class="comment" id="5083961">//&nbsp;find&nbsp;the&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5083983">if</span>&nbsp;<span class="ident" id="5083986">p</span>&nbsp;<span class="op" id="5083988">==</span>&nbsp;<span class="ident" id="5083991">nil</span>&nbsp;<span class="op" id="5083995">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5084000">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5084009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5084014">path</span>&nbsp;<span class="op" id="5084019">:=</span>&nbsp;<span class="ident" id="5084022">p</span><span class="op" id="5084023">.</span><span class="ident" id="5084024">Path</span><span class="op" id="5084028">(</span><span class="op" id="5084029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5084033">_</span><span class="op" id="5084034">,</span>&nbsp;<span class="ident" id="5084036">pkg</span>&nbsp;<span class="op" id="5084040">=</span>&nbsp;<span class="ident" id="5084042">b</span><span class="op" id="5084043">.</span><span class="ident" id="5084044">curPkg</span><span class="op" id="5084050">.</span><span class="ident" id="5084051">LibIndex</span><span class="op" id="5084059">(</span><span class="ident" id="5084060">path</span><span class="op" id="5084064">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5084068">ret</span><span class="op" id="5084071">,</span>&nbsp;<span class="ident" id="5084073">index</span>&nbsp;<span class="op" id="5084079">=</span>&nbsp;<span class="ident" id="5084081">p</span><span class="op" id="5084082">.</span><span class="ident" id="5084083">Query</span><span class="op" id="5084088">(</span><span class="ident" id="5084089">s</span><span class="op" id="5084090">.</span><span class="ident" id="5084091">symbol</span><span class="op" id="5084097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5084101">if</span>&nbsp;<span class="ident" id="5084104">ret</span>&nbsp;<span class="op" id="5084108">!=</span>&nbsp;<span class="ident" id="5084111">nil</span>&nbsp;<span class="op" id="5084115">&amp;&amp;</span>&nbsp;<span class="ident" id="5084118">ret</span><span class="op" id="5084121">.</span><span class="ident" id="5084122">Package</span>&nbsp;<span class="op" id="5084130">!=</span>&nbsp;<span class="ident" id="5084133">path</span>&nbsp;<span class="op" id="5084138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5084143">panic</span><span class="op" id="5084148">(</span><span class="string" id="5084149">&#34;bug&#34;</span><span class="op" id="5084154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5084158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5084161">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5084165">if</span>&nbsp;<span class="ident" id="5084168">ret</span>&nbsp;<span class="op" id="5084172">==</span>&nbsp;<span class="ident" id="5084175">nil</span>&nbsp;<span class="op" id="5084179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5084183">b</span><span class="op" id="5084184">.</span><span class="ident" id="5084185">err</span><span class="op" id="5084188">(</span><span class="ident" id="5084189">t</span><span class="op" id="5084190">.</span><span class="ident" id="5084191">Pos</span><span class="op" id="5084194">,</span>&nbsp;<span class="string" id="5084196">&#34;%q&nbsp;not&nbsp;found&#34;</span><span class="op" id="5084210">,</span>&nbsp;<span class="ident" id="5084212">t</span><span class="op" id="5084213">.</span><span class="ident" id="5084214">Lit</span><span class="op" id="5084217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5084221">return</span>&nbsp;<span class="ident" id="5084228">nil</span><span class="op" id="5084231">,</span>&nbsp;<span class="num" id="5084233">0</span><span class="op" id="5084234">,</span>&nbsp;<span class="num" id="5084236">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5084239">}</span>&nbsp;<span class="keyword" id="5084241">else</span>&nbsp;<span class="keyword" id="5084246">if</span>&nbsp;<span class="ident" id="5084249">ret</span><span class="op" id="5084252">.</span><span class="ident" id="5084253">Type</span>&nbsp;<span class="op" id="5084258">==</span>&nbsp;<span class="ident" id="5084261">SymConst</span>&nbsp;<span class="op" id="5084270">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5084274">return</span>&nbsp;<span class="ident" id="5084281">nil</span><span class="op" id="5084284">,</span>&nbsp;<span class="num" id="5084286">0</span><span class="op" id="5084287">,</span>&nbsp;<span class="num" id="5084289">0</span>&nbsp;<span class="comment" id="5084291">//&nbsp;not&nbsp;my&nbsp;job&nbsp;to&nbsp;fill&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5084319">}</span>&nbsp;<span class="keyword" id="5084321">else</span>&nbsp;<span class="keyword" id="5084326">if</span>&nbsp;<span class="ident" id="5084329">ret</span><span class="op" id="5084332">.</span><span class="ident" id="5084333">Type</span>&nbsp;<span class="op" id="5084338">==</span>&nbsp;<span class="ident" id="5084341">SymImport</span>&nbsp;<span class="op" id="5084351">||</span>&nbsp;<span class="ident" id="5084354">ret</span><span class="op" id="5084357">.</span><span class="ident" id="5084358">Type</span>&nbsp;<span class="op" id="5084363">==</span>&nbsp;<span class="ident" id="5084366">SymLabel</span>&nbsp;<span class="op" id="5084375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5084379">b</span><span class="op" id="5084380">.</span><span class="ident" id="5084381">err</span><span class="op" id="5084384">(</span><span class="ident" id="5084385">t</span><span class="op" id="5084386">.</span><span class="ident" id="5084387">Pos</span><span class="op" id="5084390">,</span>&nbsp;<span class="string" id="5084392">&#34;%s&nbsp;%q&nbsp;not&nbsp;a&nbsp;symbol&#34;</span><span class="op" id="5084412">,</span>&nbsp;<span class="ident" id="5084414">symStr</span><span class="op" id="5084420">(</span><span class="ident" id="5084421">ret</span><span class="op" id="5084424">.</span><span class="ident" id="5084425">Type</span><span class="op" id="5084429">)</span><span class="op" id="5084430">,</span>&nbsp;<span class="ident" id="5084432">t</span><span class="op" id="5084433">.</span><span class="ident" id="5084434">Lit</span><span class="op" id="5084437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5084441">return</span>&nbsp;<span class="ident" id="5084448">nil</span><span class="op" id="5084451">,</span>&nbsp;<span class="num" id="5084453">0</span><span class="op" id="5084454">,</span>&nbsp;<span class="num" id="5084456">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5084459">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5084463">return</span><br>
<span class="lineno"></span><span class="op" id="5084470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5084473">func</span>&nbsp;<span class="ident" id="5084478">linkSymbol</span><span class="op" id="5084488">(</span><span class="ident" id="5084489">b</span>&nbsp;<span class="op" id="5084491">*</span><span class="ident" id="5084492">builder</span><span class="op" id="5084499">,</span>&nbsp;<span class="ident" id="5084501">s</span>&nbsp;<span class="op" id="5084503">*</span><span class="ident" id="5084504">funcStmt</span><span class="op" id="5084512">,</span>&nbsp;<span class="ident" id="5084514">f</span>&nbsp;<span class="op" id="5084516">*</span><span class="ident" id="5084517">link8</span><span class="op" id="5084522">.</span><span class="ident" id="5084523">Func</span><span class="op" id="5084527">)</span>&nbsp;<span class="op" id="5084529">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5084532">t</span>&nbsp;<span class="op" id="5084534">:=</span>&nbsp;<span class="ident" id="5084537">s</span><span class="op" id="5084538">.</span><span class="ident" id="5084539">symTok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5084547">if</span>&nbsp;<span class="ident" id="5084550">b</span><span class="op" id="5084551">.</span><span class="ident" id="5084552">curPkg</span>&nbsp;<span class="op" id="5084559">==</span>&nbsp;<span class="ident" id="5084562">nil</span>&nbsp;<span class="op" id="5084566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5084570">b</span><span class="op" id="5084571">.</span><span class="ident" id="5084572">err</span><span class="op" id="5084575">(</span><span class="ident" id="5084576">t</span><span class="op" id="5084577">.</span><span class="ident" id="5084578">Pos</span><span class="op" id="5084581">,</span>&nbsp;<span class="string" id="5084583">&#34;no&nbsp;context&nbsp;for&nbsp;resolving&nbsp;%q&#34;</span><span class="op" id="5084612">,</span>&nbsp;<span class="ident" id="5084614">t</span><span class="op" id="5084615">.</span><span class="ident" id="5084616">Lit</span><span class="op" id="5084619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5084623">return</span>&nbsp;<span class="comment" id="5084630">//&nbsp;this&nbsp;may&nbsp;happen&nbsp;for&nbsp;bare&nbsp;function</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5084668">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5084672">sym</span><span class="op" id="5084675">,</span>&nbsp;<span class="ident" id="5084677">pkg</span><span class="op" id="5084680">,</span>&nbsp;<span class="ident" id="5084682">index</span>&nbsp;<span class="op" id="5084688">:=</span>&nbsp;<span class="ident" id="5084691">resolveSymbol</span><span class="op" id="5084704">(</span><span class="ident" id="5084705">b</span><span class="op" id="5084706">,</span>&nbsp;<span class="ident" id="5084708">s</span><span class="op" id="5084709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5084712">if</span>&nbsp;<span class="ident" id="5084715">sym</span>&nbsp;<span class="op" id="5084719">==</span>&nbsp;<span class="ident" id="5084722">nil</span>&nbsp;<span class="op" id="5084726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5084730">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5084738">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5084742">if</span>&nbsp;<span class="ident" id="5084745">s</span><span class="op" id="5084746">.</span><span class="ident" id="5084747">fill</span>&nbsp;<span class="op" id="5084752">==</span>&nbsp;<span class="ident" id="5084755">fillLink</span>&nbsp;<span class="op" id="5084764">&amp;&amp;</span>&nbsp;<span class="ident" id="5084767">sym</span><span class="op" id="5084770">.</span><span class="ident" id="5084771">Type</span>&nbsp;<span class="op" id="5084776">!=</span>&nbsp;<span class="ident" id="5084779">SymFunc</span>&nbsp;<span class="op" id="5084787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5084791">b</span><span class="op" id="5084792">.</span><span class="ident" id="5084793">err</span><span class="op" id="5084796">(</span><span class="ident" id="5084797">t</span><span class="op" id="5084798">.</span><span class="ident" id="5084799">Pos</span><span class="op" id="5084802">,</span>&nbsp;<span class="string" id="5084804">&#34;%s&nbsp;%q&nbsp;is&nbsp;not&nbsp;a&nbsp;function&#34;</span><span class="op" id="5084829">,</span>&nbsp;<span class="ident" id="5084831">symStr</span><span class="op" id="5084837">(</span><span class="ident" id="5084838">sym</span><span class="op" id="5084841">.</span><span class="ident" id="5084842">Type</span><span class="op" id="5084846">)</span><span class="op" id="5084847">,</span>&nbsp;<span class="ident" id="5084849">t</span><span class="op" id="5084850">.</span><span class="ident" id="5084851">Lit</span><span class="op" id="5084854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5084858">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5084866">}</span>&nbsp;<span class="keyword" id="5084868">else</span>&nbsp;<span class="keyword" id="5084873">if</span>&nbsp;<span class="ident" id="5084876">pkg</span>&nbsp;<span class="op" id="5084880">&gt;</span>&nbsp;<span class="num" id="5084882">0</span>&nbsp;<span class="op" id="5084884">&amp;&amp;</span>&nbsp;<span class="op" id="5084887">!</span><span class="ident" id="5084888">isPublic</span><span class="op" id="5084896">(</span><span class="ident" id="5084897">sym</span><span class="op" id="5084900">.</span><span class="ident" id="5084901">Name</span><span class="op" id="5084905">)</span>&nbsp;<span class="op" id="5084907">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5084911">//&nbsp;for&nbsp;imported&nbsp;package,&nbsp;check&nbsp;if&nbsp;it&nbsp;is&nbsp;public</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5084960">b</span><span class="op" id="5084961">.</span><span class="ident" id="5084962">err</span><span class="op" id="5084965">(</span><span class="ident" id="5084966">t</span><span class="op" id="5084967">.</span><span class="ident" id="5084968">Pos</span><span class="op" id="5084971">,</span>&nbsp;<span class="string" id="5084973">&#34;%q&nbsp;is&nbsp;not&nbsp;public&#34;</span><span class="op" id="5084991">,</span>&nbsp;<span class="ident" id="5084993">t</span><span class="op" id="5084994">.</span><span class="ident" id="5084995">Lit</span><span class="op" id="5084998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5085002">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5085010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5085014">//&nbsp;save&nbsp;the&nbsp;link</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5085032">f</span><span class="op" id="5085033">.</span><span class="ident" id="5085034">AddLink</span><span class="op" id="5085041">(</span><span class="ident" id="5085042">s</span><span class="op" id="5085043">.</span><span class="ident" id="5085044">fill</span><span class="op" id="5085048">,</span>&nbsp;<span class="ident" id="5085050">pkg</span><span class="op" id="5085053">,</span>&nbsp;<span class="ident" id="5085055">index</span><span class="op" id="5085060">)</span><br>
<span class="lineno"></span><span class="op" id="5085062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5085065">//&nbsp;makeFuncObj&nbsp;converts&nbsp;a&nbsp;function&nbsp;AST&nbsp;node&nbsp;f&nbsp;into&nbsp;a&nbsp;function&nbsp;object.&nbsp;It</span><br>
<span class="lineno">200</span><span class="comment" id="5085138">//&nbsp;resolves&nbsp;the&nbsp;symbols&nbsp;of&nbsp;fillLink,&nbsp;fillHigh&nbsp;and&nbsp;fillLow&nbsp;into&nbsp;&lt;pack,&nbsp;sym&gt;</span><br>
<span class="lineno"></span><span class="comment" id="5085213">//&nbsp;index&nbsp;pairs,&nbsp;using&nbsp;the&nbsp;symbol&nbsp;scope&nbsp;and&nbsp;the&nbsp;curPkg&nbsp;context&nbsp;in&nbsp;the&nbsp;Builder&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="5085293">func</span>&nbsp;<span class="ident" id="5085298">makeFuncObj</span><span class="op" id="5085309">(</span><span class="ident" id="5085310">b</span>&nbsp;<span class="op" id="5085312">*</span><span class="ident" id="5085313">builder</span><span class="op" id="5085320">,</span>&nbsp;<span class="ident" id="5085322">f</span>&nbsp;<span class="op" id="5085324">*</span><span class="ident" id="5085325">funcDecl</span><span class="op" id="5085333">)</span>&nbsp;<span class="op" id="5085335">*</span><span class="ident" id="5085336">link8</span><span class="op" id="5085341">.</span><span class="ident" id="5085342">Func</span>&nbsp;<span class="op" id="5085347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5085350">ret</span>&nbsp;<span class="op" id="5085354">:=</span>&nbsp;<span class="ident" id="5085357">link8</span><span class="op" id="5085362">.</span><span class="ident" id="5085363">NewFunc</span><span class="op" id="5085370">(</span><span class="op" id="5085371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5085374">for</span>&nbsp;<span class="ident" id="5085378">_</span><span class="op" id="5085379">,</span>&nbsp;<span class="ident" id="5085381">s</span>&nbsp;<span class="op" id="5085383">:=</span>&nbsp;<span class="keyword" id="5085386">range</span>&nbsp;<span class="ident" id="5085392">f</span><span class="op" id="5085393">.</span><span class="ident" id="5085394">stmts</span>&nbsp;<span class="op" id="5085400">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5085404">if</span>&nbsp;<span class="ident" id="5085407">s</span><span class="op" id="5085408">.</span><span class="ident" id="5085409">isLabel</span><span class="op" id="5085416">(</span><span class="op" id="5085417">)</span>&nbsp;<span class="op" id="5085419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5085424">continue</span>&nbsp;<span class="comment" id="5085433">//&nbsp;skip&nbsp;labels</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5085450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5085454">ret</span><span class="op" id="5085457">.</span><span class="ident" id="5085458">AddInst</span><span class="op" id="5085465">(</span><span class="ident" id="5085466">s</span><span class="op" id="5085467">.</span><span class="ident" id="5085468">inst</span><span class="op" id="5085472">.</span><span class="ident" id="5085473">inst</span><span class="op" id="5085477">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5085482">if</span>&nbsp;<span class="op" id="5085485">!</span><span class="op" id="5085486">(</span><span class="ident" id="5085487">s</span><span class="op" id="5085488">.</span><span class="ident" id="5085489">fill</span>&nbsp;<span class="op" id="5085494">&gt;</span>&nbsp;<span class="ident" id="5085496">fillNone</span>&nbsp;<span class="op" id="5085505">&amp;&amp;</span>&nbsp;<span class="ident" id="5085508">s</span><span class="op" id="5085509">.</span><span class="ident" id="5085510">fill</span>&nbsp;<span class="op" id="5085515">&lt;</span>&nbsp;<span class="ident" id="5085517">fillLabel</span><span class="op" id="5085526">)</span>&nbsp;<span class="op" id="5085528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5085533">continue</span>&nbsp;<span class="comment" id="5085542">//&nbsp;only&nbsp;care&nbsp;about&nbsp;fillHigh,&nbsp;fillLow&nbsp;and&nbsp;fillLink</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5085594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5085599">linkSymbol</span><span class="op" id="5085609">(</span><span class="ident" id="5085610">b</span><span class="op" id="5085611">,</span>&nbsp;<span class="ident" id="5085613">s</span><span class="op" id="5085614">,</span>&nbsp;<span class="ident" id="5085616">ret</span><span class="op" id="5085619">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5085622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5085626">if</span>&nbsp;<span class="ident" id="5085629">ret</span><span class="op" id="5085632">.</span><span class="ident" id="5085633">TooLarge</span><span class="op" id="5085641">(</span><span class="op" id="5085642">)</span>&nbsp;<span class="op" id="5085644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5085648">b</span><span class="op" id="5085649">.</span><span class="ident" id="5085650">err</span><span class="op" id="5085653">(</span><span class="ident" id="5085654">f</span><span class="op" id="5085655">.</span><span class="ident" id="5085656">name</span><span class="op" id="5085660">.</span><span class="ident" id="5085661">Pos</span><span class="op" id="5085664">,</span>&nbsp;<span class="string" id="5085666">&#34;too&nbsp;many&nbsp;instructions&nbsp;in&nbsp;func&#34;</span><span class="op" id="5085697">,</span>&nbsp;<span class="ident" id="5085699">f</span><span class="op" id="5085700">.</span><span class="ident" id="5085701">name</span><span class="op" id="5085705">.</span><span class="ident" id="5085706">Lit</span><span class="op" id="5085709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5085712">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5085716">return</span>&nbsp;<span class="ident" id="5085723">ret</span><br>
<span class="lineno"></span><span class="op" id="5085727">}</span>
</div>
</body>
</html>
