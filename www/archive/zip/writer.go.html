<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5704763">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5704818">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5704872">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5704923">package</span>&nbsp;<span class="ident" id="5704931">zip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5704936">import</span>&nbsp;<span class="op" id="5704943">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5704946">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5704955">&#34;encoding/binary&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5704974">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5704984">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5704992">&#34;hash/crc32&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705006">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="5705011">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="5705014">//&nbsp;TODO(adg):&nbsp;support&nbsp;zip&nbsp;file&nbsp;comments</span><br>
<span class="lineno"></span><span class="comment" id="5705054">//&nbsp;TODO(adg):&nbsp;support&nbsp;specifying&nbsp;deflate&nbsp;level</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5705102">//&nbsp;Writer&nbsp;implements&nbsp;a&nbsp;zip&nbsp;file&nbsp;writer.</span><br>
<span class="lineno">20</span><span class="keyword" id="5705142">type</span>&nbsp;<span class="ident" id="5705147">Writer</span>&nbsp;<span class="keyword" id="5705154">struct</span>&nbsp;<span class="op" id="5705161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5705164">cw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5705171">*</span><span class="ident" id="5705172"><a href="/archive/zip/writer.go.html#5713800">countWriter</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5705185">dir</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5705192">[</span><span class="op" id="5705193">]</span><span class="op" id="5705194">*</span><span class="ident" id="5705195"><a href="/archive/zip/writer.go.html#5705243">header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5705203">last</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5705210">*</span><span class="ident" id="5705211"><a href="/archive/zip/writer.go.html#5712049">fileWriter</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5705223">closed</span>&nbsp;<span class="builtintype" id="5705230">bool</span><br>
<span class="lineno">25</span><span class="op" id="5705235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5705238">type</span>&nbsp;<span class="ident" id="5705243">header</span>&nbsp;<span class="keyword" id="5705250">struct</span>&nbsp;<span class="op" id="5705257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5705260">*</span><span class="ident" id="5705261"><a href="/archive/zip/struct.go.html#5698331">FileHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5705273">offset</span>&nbsp;<span class="ident" id="5705280">uint64</span><br>
<span class="lineno">30</span><span class="op" id="5705287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5705290">//&nbsp;NewWriter&nbsp;returns&nbsp;a&nbsp;new&nbsp;Writer&nbsp;writing&nbsp;a&nbsp;zip&nbsp;file&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="5705349">func</span>&nbsp;<span class="ident" id="5705354">NewWriter</span><span class="op" id="5705363">(</span><span class="ident" id="5705364">w</span>&nbsp;<span class="ident" id="5705366"><a href="/archive/zip/writer.go.html#5705006">io</a></span><span class="op" id="5705368">.</span><span class="ident" id="5705369">Writer</span><span class="op" id="5705375">)</span>&nbsp;<span class="op" id="5705377">*</span><span class="ident" id="5705378"><a href="/archive/zip/writer.go.html#5705147">Writer</a></span>&nbsp;<span class="op" id="5705385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5705388">return</span>&nbsp;<span class="op" id="5705395">&amp;</span><span class="ident" id="5705396"><a href="/archive/zip/writer.go.html#5705147">Writer</a></span><span class="op" id="5705402">{</span><span class="ident" id="5705403">cw</span><span class="op" id="5705405">:</span>&nbsp;<span class="op" id="5705407">&amp;</span><span class="ident" id="5705408"><a href="/archive/zip/writer.go.html#5713800">countWriter</a></span><span class="op" id="5705419">{</span><span class="ident" id="5705420">w</span><span class="op" id="5705421">:</span>&nbsp;<span class="ident" id="5705423"><a href="/archive/zip/writer.go.html#5704946">bufio</a></span><span class="op" id="5705428">.</span><span class="ident" id="5705429">NewWriter</span><span class="op" id="5705438">(</span><span class="ident" id="5705439"><a href="/archive/zip/writer.go.html#5705364">w</a></span><span class="op" id="5705440">)</span><span class="op" id="5705441">}</span><span class="op" id="5705442">}</span><br>
<span class="lineno">35</span><span class="op" id="5705444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5705447">//&nbsp;Flush&nbsp;flushes&nbsp;any&nbsp;buffered&nbsp;data&nbsp;to&nbsp;the&nbsp;underlying&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="5705508">//&nbsp;Calling&nbsp;Flush&nbsp;is&nbsp;not&nbsp;normally&nbsp;necessary;&nbsp;calling&nbsp;Close&nbsp;is&nbsp;sufficient.</span><br>
<span class="lineno"></span><span class="keyword" id="5705581">func</span>&nbsp;<span class="op" id="5705586">(</span><span class="ident" id="5705587">w</span>&nbsp;<span class="op" id="5705589">*</span><span class="ident" id="5705590"><a href="/archive/zip/writer.go.html#5705147">Writer</a></span><span class="op" id="5705596">)</span>&nbsp;<span class="ident" id="5705598">Flush</span><span class="op" id="5705603">(</span><span class="op" id="5705604">)</span>&nbsp;<span class="builtintype" id="5705606">error</span>&nbsp;<span class="op" id="5705612">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5705615">return</span>&nbsp;<span class="ident" id="5705622"><a href="/archive/zip/writer.go.html#5705587">w</a></span><span class="op" id="5705623">.</span><span class="ident" id="5705624">cw</span><span class="op" id="5705626">.</span><span class="ident" id="5705627">w</span><span class="op" id="5705628">.</span><span class="op" id="5705629">(</span><span class="op" id="5705630">*</span><span class="ident" id="5705631"><a href="/archive/zip/writer.go.html#5704946">bufio</a></span><span class="op" id="5705636">.</span><span class="ident" id="5705637">Writer</span><span class="op" id="5705643">)</span><span class="op" id="5705644">.</span><span class="ident" id="5705645">Flush</span><span class="op" id="5705650">(</span><span class="op" id="5705651">)</span><br>
<span class="lineno"></span><span class="op" id="5705653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5705656">//&nbsp;Close&nbsp;finishes&nbsp;writing&nbsp;the&nbsp;zip&nbsp;file&nbsp;by&nbsp;writing&nbsp;the&nbsp;central&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="5705729">//&nbsp;It&nbsp;does&nbsp;not&nbsp;(and&nbsp;can&nbsp;not)&nbsp;close&nbsp;the&nbsp;underlying&nbsp;writer.</span><br>
<span class="lineno">45</span><span class="keyword" id="5705787">func</span>&nbsp;<span class="op" id="5705792">(</span><span class="ident" id="5705793">w</span>&nbsp;<span class="op" id="5705795">*</span><span class="ident" id="5705796"><a href="/archive/zip/writer.go.html#5705147">Writer</a></span><span class="op" id="5705802">)</span>&nbsp;<span class="ident" id="5705804">Close</span><span class="op" id="5705809">(</span><span class="op" id="5705810">)</span>&nbsp;<span class="builtintype" id="5705812">error</span>&nbsp;<span class="op" id="5705818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5705821">if</span>&nbsp;<span class="ident" id="5705824"><a href="/archive/zip/writer.go.html#5705793">w</a></span><span class="op" id="5705825">.</span><span class="ident" id="5705826">last</span>&nbsp;<span class="op" id="5705831">!=</span>&nbsp;<span class="ident" id="5705834">nil</span>&nbsp;<span class="op" id="5705838">&amp;&amp;</span>&nbsp;<span class="op" id="5705841">!</span><span class="ident" id="5705842"><a href="/archive/zip/writer.go.html#5705793">w</a></span><span class="op" id="5705843">.</span><span class="ident" id="5705844">last</span><span class="op" id="5705848">.</span><span class="ident" id="5705849">closed</span>&nbsp;<span class="op" id="5705856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5705860">if</span>&nbsp;<span class="ident" id="5705863">err</span>&nbsp;<span class="op" id="5705867">:=</span>&nbsp;<span class="ident" id="5705870"><a href="/archive/zip/writer.go.html#5705793">w</a></span><span class="op" id="5705871">.</span><span class="ident" id="5705872">last</span><span class="op" id="5705876">.</span><span class="builtinfunc" id="5705877">close</span><span class="op" id="5705882">(</span><span class="op" id="5705883">)</span><span class="op" id="5705884">;</span>&nbsp;<span class="ident" id="5705886"><a href="/archive/zip/writer.go.html#5705863">err</a></span>&nbsp;<span class="op" id="5705890">!=</span>&nbsp;<span class="ident" id="5705893">nil</span>&nbsp;<span class="op" id="5705897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5705902">return</span>&nbsp;<span class="ident" id="5705909"><a href="/archive/zip/writer.go.html#5705863">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5705915">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5705919"><a href="/archive/zip/writer.go.html#5705793">w</a></span><span class="op" id="5705920">.</span><span class="ident" id="5705921">last</span>&nbsp;<span class="op" id="5705926">=</span>&nbsp;<span class="ident" id="5705928">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5705933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5705936">if</span>&nbsp;<span class="ident" id="5705939"><a href="/archive/zip/writer.go.html#5705793">w</a></span><span class="op" id="5705940">.</span><span class="ident" id="5705941">closed</span>&nbsp;<span class="op" id="5705948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5705952">return</span>&nbsp;<span class="ident" id="5705959"><a href="/archive/zip/writer.go.html#5704974">errors</a></span><span class="op" id="5705965">.</span><span class="ident" id="5705966">New</span><span class="op" id="5705969">(</span><span class="string" id="5705970">&#34;zip:&nbsp;writer&nbsp;closed&nbsp;twice&#34;</span><span class="op" id="5705996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5705999">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706002"><a href="/archive/zip/writer.go.html#5705793">w</a></span><span class="op" id="5706003">.</span><span class="ident" id="5706004">closed</span>&nbsp;<span class="op" id="5706011">=</span>&nbsp;<span class="builtintype" id="5706013">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5706020">//&nbsp;write&nbsp;central&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706048">start</span>&nbsp;<span class="op" id="5706054">:=</span>&nbsp;<span class="ident" id="5706057"><a href="/archive/zip/writer.go.html#5705793">w</a></span><span class="op" id="5706058">.</span><span class="ident" id="5706059">cw</span><span class="op" id="5706061">.</span><span class="ident" id="5706062">count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5706069">for</span>&nbsp;<span class="ident" id="5706073">_</span><span class="op" id="5706074">,</span>&nbsp;<span class="ident" id="5706076">h</span>&nbsp;<span class="op" id="5706078">:=</span>&nbsp;<span class="keyword" id="5706081">range</span>&nbsp;<span class="ident" id="5706087"><a href="/archive/zip/writer.go.html#5705793">w</a></span><span class="op" id="5706088">.</span><span class="ident" id="5706089">dir</span>&nbsp;<span class="op" id="5706093">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5706097">var</span>&nbsp;<span class="ident" id="5706101">buf</span>&nbsp;<span class="op" id="5706105">[</span><span class="ident" id="5706106"><a href="/archive/zip/struct.go.html#5697418">directoryHeaderLen</a></span><span class="op" id="5706124">]</span><span class="builtintype" id="5706125">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706132">b</span>&nbsp;<span class="op" id="5706134">:=</span>&nbsp;<span class="ident" id="5706137"><a href="/archive/zip/writer.go.html#5714063">writeBuf</a></span><span class="op" id="5706145">(</span><span class="ident" id="5706146"><a href="/archive/zip/writer.go.html#5706101">buf</a></span><span class="op" id="5706149">[</span><span class="op" id="5706150">:</span><span class="op" id="5706151">]</span><span class="op" id="5706152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706156"><a href="/archive/zip/writer.go.html#5706132">b</a></span><span class="op" id="5706157">.</span><span class="builtintype" id="5706158">uint32</span><span class="op" id="5706164">(</span><span class="builtintype" id="5706165">uint32</span><span class="op" id="5706171">(</span><span class="ident" id="5706172"><a href="/archive/zip/struct.go.html#5697116">directoryHeaderSignature</a></span><span class="op" id="5706196">)</span><span class="op" id="5706197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706201"><a href="/archive/zip/writer.go.html#5706132">b</a></span><span class="op" id="5706202">.</span><span class="builtintype" id="5706203">uint16</span><span class="op" id="5706209">(</span><span class="ident" id="5706210"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5706211">.</span><span class="ident" id="5706212">CreatorVersion</span><span class="op" id="5706226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706230"><a href="/archive/zip/writer.go.html#5706132">b</a></span><span class="op" id="5706231">.</span><span class="builtintype" id="5706232">uint16</span><span class="op" id="5706238">(</span><span class="ident" id="5706239"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5706240">.</span><span class="ident" id="5706241">ReaderVersion</span><span class="op" id="5706254">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706258"><a href="/archive/zip/writer.go.html#5706132">b</a></span><span class="op" id="5706259">.</span><span class="builtintype" id="5706260">uint16</span><span class="op" id="5706266">(</span><span class="ident" id="5706267"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5706268">.</span><span class="ident" id="5706269">Flags</span><span class="op" id="5706274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706278"><a href="/archive/zip/writer.go.html#5706132">b</a></span><span class="op" id="5706279">.</span><span class="builtintype" id="5706280">uint16</span><span class="op" id="5706286">(</span><span class="ident" id="5706287"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5706288">.</span><span class="ident" id="5706289">Method</span><span class="op" id="5706295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706299"><a href="/archive/zip/writer.go.html#5706132">b</a></span><span class="op" id="5706300">.</span><span class="builtintype" id="5706301">uint16</span><span class="op" id="5706307">(</span><span class="ident" id="5706308"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5706309">.</span><span class="ident" id="5706310">ModifiedTime</span><span class="op" id="5706322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706326"><a href="/archive/zip/writer.go.html#5706132">b</a></span><span class="op" id="5706327">.</span><span class="builtintype" id="5706328">uint16</span><span class="op" id="5706334">(</span><span class="ident" id="5706335"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5706336">.</span><span class="ident" id="5706337">ModifiedDate</span><span class="op" id="5706349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706353"><a href="/archive/zip/writer.go.html#5706132">b</a></span><span class="op" id="5706354">.</span><span class="builtintype" id="5706355">uint32</span><span class="op" id="5706361">(</span><span class="ident" id="5706362"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5706363">.</span><span class="ident" id="5706364">CRC32</span><span class="op" id="5706369">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5706373">if</span>&nbsp;<span class="ident" id="5706376"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5706377">.</span><span class="ident" id="5706378">isZip64</span><span class="op" id="5706385">(</span><span class="op" id="5706386">)</span>&nbsp;<span class="op" id="5706388">||</span>&nbsp;<span class="ident" id="5706391"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5706392">.</span><span class="ident" id="5706393">offset</span>&nbsp;<span class="op" id="5706400">&gt;</span>&nbsp;<span class="ident" id="5706402"><a href="/archive/zip/struct.go.html#5698126">uint32max</a></span>&nbsp;<span class="op" id="5706412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5706417">//&nbsp;the&nbsp;file&nbsp;needs&nbsp;a&nbsp;zip64&nbsp;header.&nbsp;store&nbsp;maxint&nbsp;in&nbsp;both</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5706475">//&nbsp;32&nbsp;bit&nbsp;size&nbsp;fields&nbsp;(and&nbsp;offset&nbsp;later)&nbsp;to&nbsp;signal&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5706538">//&nbsp;zip64&nbsp;extra&nbsp;header&nbsp;should&nbsp;be&nbsp;used.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706579"><a href="/archive/zip/writer.go.html#5706132">b</a></span><span class="op" id="5706580">.</span><span class="builtintype" id="5706581">uint32</span><span class="op" id="5706587">(</span><span class="ident" id="5706588"><a href="/archive/zip/struct.go.html#5698126">uint32max</a></span><span class="op" id="5706597">)</span>&nbsp;<span class="comment" id="5706599">//&nbsp;compressed&nbsp;size</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706621"><a href="/archive/zip/writer.go.html#5706132">b</a></span><span class="op" id="5706622">.</span><span class="builtintype" id="5706623">uint32</span><span class="op" id="5706629">(</span><span class="ident" id="5706630"><a href="/archive/zip/struct.go.html#5698126">uint32max</a></span><span class="op" id="5706639">)</span>&nbsp;<span class="comment" id="5706641">//&nbsp;uncompressed&nbsp;size</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5706666">//&nbsp;append&nbsp;a&nbsp;zip64&nbsp;extra&nbsp;block&nbsp;to&nbsp;Extra</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5706708">var</span>&nbsp;<span class="ident" id="5706712">buf</span>&nbsp;<span class="op" id="5706716">[</span><span class="num" id="5706717">28</span><span class="op" id="5706719">]</span><span class="builtintype" id="5706720">byte</span>&nbsp;<span class="comment" id="5706725">//&nbsp;2x&nbsp;uint16&nbsp;+&nbsp;3x&nbsp;uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706753">eb</span>&nbsp;<span class="op" id="5706756">:=</span>&nbsp;<span class="ident" id="5706759"><a href="/archive/zip/writer.go.html#5714063">writeBuf</a></span><span class="op" id="5706767">(</span><span class="ident" id="5706768"><a href="/archive/zip/writer.go.html#5706712">buf</a></span><span class="op" id="5706771">[</span><span class="op" id="5706772">:</span><span class="op" id="5706773">]</span><span class="op" id="5706774">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706779"><a href="/archive/zip/writer.go.html#5706753">eb</a></span><span class="op" id="5706781">.</span><span class="builtintype" id="5706782">uint16</span><span class="op" id="5706788">(</span><span class="ident" id="5706789"><a href="/archive/zip/struct.go.html#5698176">zip64ExtraId</a></span><span class="op" id="5706801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706806"><a href="/archive/zip/writer.go.html#5706753">eb</a></span><span class="op" id="5706808">.</span><span class="builtintype" id="5706809">uint16</span><span class="op" id="5706815">(</span><span class="num" id="5706816">24</span><span class="op" id="5706818">)</span>&nbsp;<span class="comment" id="5706820">//&nbsp;size&nbsp;=&nbsp;3x&nbsp;uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706843"><a href="/archive/zip/writer.go.html#5706753">eb</a></span><span class="op" id="5706845">.</span><span class="ident" id="5706846">uint64</span><span class="op" id="5706852">(</span><span class="ident" id="5706853"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5706854">.</span><span class="ident" id="5706855">UncompressedSize64</span><span class="op" id="5706873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706878"><a href="/archive/zip/writer.go.html#5706753">eb</a></span><span class="op" id="5706880">.</span><span class="ident" id="5706881">uint64</span><span class="op" id="5706887">(</span><span class="ident" id="5706888"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5706889">.</span><span class="ident" id="5706890">CompressedSize64</span><span class="op" id="5706906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706911"><a href="/archive/zip/writer.go.html#5706753">eb</a></span><span class="op" id="5706913">.</span><span class="ident" id="5706914">uint64</span><span class="op" id="5706920">(</span><span class="ident" id="5706921"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5706922">.</span><span class="ident" id="5706923">offset</span><span class="op" id="5706929">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706934"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5706935">.</span><span class="ident" id="5706936">Extra</span>&nbsp;<span class="op" id="5706942">=</span>&nbsp;<span class="builtinfunc" id="5706944">append</span><span class="op" id="5706950">(</span><span class="ident" id="5706951"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5706952">.</span><span class="ident" id="5706953">Extra</span><span class="op" id="5706958">,</span>&nbsp;<span class="ident" id="5706960"><a href="/archive/zip/writer.go.html#5706712">buf</a></span><span class="op" id="5706963">[</span><span class="op" id="5706964">:</span><span class="op" id="5706965">]</span><span class="op" id="5706966">...</span><span class="op" id="5706969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5706973">}</span>&nbsp;<span class="keyword" id="5706975">else</span>&nbsp;<span class="op" id="5706980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706985"><a href="/archive/zip/writer.go.html#5706132">b</a></span><span class="op" id="5706986">.</span><span class="builtintype" id="5706987">uint32</span><span class="op" id="5706993">(</span><span class="ident" id="5706994"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5706995">.</span><span class="ident" id="5706996">CompressedSize</span><span class="op" id="5707010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707015"><a href="/archive/zip/writer.go.html#5706132">b</a></span><span class="op" id="5707016">.</span><span class="builtintype" id="5707017">uint32</span><span class="op" id="5707023">(</span><span class="ident" id="5707024"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5707025">.</span><span class="ident" id="5707026">UncompressedSize</span><span class="op" id="5707042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5707046">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707050"><a href="/archive/zip/writer.go.html#5706132">b</a></span><span class="op" id="5707051">.</span><span class="builtintype" id="5707052">uint16</span><span class="op" id="5707058">(</span><span class="builtintype" id="5707059">uint16</span><span class="op" id="5707065">(</span><span class="builtinfunc" id="5707066">len</span><span class="op" id="5707069">(</span><span class="ident" id="5707070"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5707071">.</span><span class="ident" id="5707072">Name</span><span class="op" id="5707076">)</span><span class="op" id="5707077">)</span><span class="op" id="5707078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707082"><a href="/archive/zip/writer.go.html#5706132">b</a></span><span class="op" id="5707083">.</span><span class="builtintype" id="5707084">uint16</span><span class="op" id="5707090">(</span><span class="builtintype" id="5707091">uint16</span><span class="op" id="5707097">(</span><span class="builtinfunc" id="5707098">len</span><span class="op" id="5707101">(</span><span class="ident" id="5707102"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5707103">.</span><span class="ident" id="5707104">Extra</span><span class="op" id="5707109">)</span><span class="op" id="5707110">)</span><span class="op" id="5707111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707115"><a href="/archive/zip/writer.go.html#5706132">b</a></span><span class="op" id="5707116">.</span><span class="builtintype" id="5707117">uint16</span><span class="op" id="5707123">(</span><span class="builtintype" id="5707124">uint16</span><span class="op" id="5707130">(</span><span class="builtinfunc" id="5707131">len</span><span class="op" id="5707134">(</span><span class="ident" id="5707135"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5707136">.</span><span class="ident" id="5707137">Comment</span><span class="op" id="5707144">)</span><span class="op" id="5707145">)</span><span class="op" id="5707146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707150"><a href="/archive/zip/writer.go.html#5706132">b</a></span>&nbsp;<span class="op" id="5707152">=</span>&nbsp;<span class="ident" id="5707154"><a href="/archive/zip/writer.go.html#5706132">b</a></span><span class="op" id="5707155">[</span><span class="num" id="5707156">4</span><span class="op" id="5707157">:</span><span class="op" id="5707158">]</span>&nbsp;<span class="comment" id="5707160">//&nbsp;skip&nbsp;disk&nbsp;number&nbsp;start&nbsp;and&nbsp;internal&nbsp;file&nbsp;attr&nbsp;(2x&nbsp;uint16)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707223"><a href="/archive/zip/writer.go.html#5706132">b</a></span><span class="op" id="5707224">.</span><span class="builtintype" id="5707225">uint32</span><span class="op" id="5707231">(</span><span class="ident" id="5707232"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5707233">.</span><span class="ident" id="5707234">ExternalAttrs</span><span class="op" id="5707247">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707251">if</span>&nbsp;<span class="ident" id="5707254"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5707255">.</span><span class="ident" id="5707256">offset</span>&nbsp;<span class="op" id="5707263">&gt;</span>&nbsp;<span class="ident" id="5707265"><a href="/archive/zip/struct.go.html#5698126">uint32max</a></span>&nbsp;<span class="op" id="5707275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707280"><a href="/archive/zip/writer.go.html#5706132">b</a></span><span class="op" id="5707281">.</span><span class="builtintype" id="5707282">uint32</span><span class="op" id="5707288">(</span><span class="ident" id="5707289"><a href="/archive/zip/struct.go.html#5698126">uint32max</a></span><span class="op" id="5707298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5707302">}</span>&nbsp;<span class="keyword" id="5707304">else</span>&nbsp;<span class="op" id="5707309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707314"><a href="/archive/zip/writer.go.html#5706132">b</a></span><span class="op" id="5707315">.</span><span class="builtintype" id="5707316">uint32</span><span class="op" id="5707322">(</span><span class="builtintype" id="5707323">uint32</span><span class="op" id="5707329">(</span><span class="ident" id="5707330"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5707331">.</span><span class="ident" id="5707332">offset</span><span class="op" id="5707338">)</span><span class="op" id="5707339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5707343">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707347">if</span>&nbsp;<span class="ident" id="5707350">_</span><span class="op" id="5707351">,</span>&nbsp;<span class="ident" id="5707353">err</span>&nbsp;<span class="op" id="5707357">:=</span>&nbsp;<span class="ident" id="5707360"><a href="/archive/zip/writer.go.html#5705793">w</a></span><span class="op" id="5707361">.</span><span class="ident" id="5707362">cw</span><span class="op" id="5707364">.</span><span class="ident" id="5707365">Write</span><span class="op" id="5707370">(</span><span class="ident" id="5707371"><a href="/archive/zip/writer.go.html#5706101">buf</a></span><span class="op" id="5707374">[</span><span class="op" id="5707375">:</span><span class="op" id="5707376">]</span><span class="op" id="5707377">)</span><span class="op" id="5707378">;</span>&nbsp;<span class="ident" id="5707380"><a href="/archive/zip/writer.go.html#5707353">err</a></span>&nbsp;<span class="op" id="5707384">!=</span>&nbsp;<span class="ident" id="5707387">nil</span>&nbsp;<span class="op" id="5707391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707396">return</span>&nbsp;<span class="ident" id="5707403"><a href="/archive/zip/writer.go.html#5707353">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5707409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707413">if</span>&nbsp;<span class="ident" id="5707416">_</span><span class="op" id="5707417">,</span>&nbsp;<span class="ident" id="5707419">err</span>&nbsp;<span class="op" id="5707423">:=</span>&nbsp;<span class="ident" id="5707426"><a href="/archive/zip/writer.go.html#5705006">io</a></span><span class="op" id="5707428">.</span><span class="ident" id="5707429">WriteString</span><span class="op" id="5707440">(</span><span class="ident" id="5707441"><a href="/archive/zip/writer.go.html#5705793">w</a></span><span class="op" id="5707442">.</span><span class="ident" id="5707443">cw</span><span class="op" id="5707445">,</span>&nbsp;<span class="ident" id="5707447"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5707448">.</span><span class="ident" id="5707449">Name</span><span class="op" id="5707453">)</span><span class="op" id="5707454">;</span>&nbsp;<span class="ident" id="5707456"><a href="/archive/zip/writer.go.html#5707419">err</a></span>&nbsp;<span class="op" id="5707460">!=</span>&nbsp;<span class="ident" id="5707463">nil</span>&nbsp;<span class="op" id="5707467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707472">return</span>&nbsp;<span class="ident" id="5707479"><a href="/archive/zip/writer.go.html#5707419">err</a></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5707485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707489">if</span>&nbsp;<span class="ident" id="5707492">_</span><span class="op" id="5707493">,</span>&nbsp;<span class="ident" id="5707495">err</span>&nbsp;<span class="op" id="5707499">:=</span>&nbsp;<span class="ident" id="5707502"><a href="/archive/zip/writer.go.html#5705793">w</a></span><span class="op" id="5707503">.</span><span class="ident" id="5707504">cw</span><span class="op" id="5707506">.</span><span class="ident" id="5707507">Write</span><span class="op" id="5707512">(</span><span class="ident" id="5707513"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5707514">.</span><span class="ident" id="5707515">Extra</span><span class="op" id="5707520">)</span><span class="op" id="5707521">;</span>&nbsp;<span class="ident" id="5707523"><a href="/archive/zip/writer.go.html#5707495">err</a></span>&nbsp;<span class="op" id="5707527">!=</span>&nbsp;<span class="ident" id="5707530">nil</span>&nbsp;<span class="op" id="5707534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707539">return</span>&nbsp;<span class="ident" id="5707546"><a href="/archive/zip/writer.go.html#5707495">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5707552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707556">if</span>&nbsp;<span class="ident" id="5707559">_</span><span class="op" id="5707560">,</span>&nbsp;<span class="ident" id="5707562">err</span>&nbsp;<span class="op" id="5707566">:=</span>&nbsp;<span class="ident" id="5707569"><a href="/archive/zip/writer.go.html#5705006">io</a></span><span class="op" id="5707571">.</span><span class="ident" id="5707572">WriteString</span><span class="op" id="5707583">(</span><span class="ident" id="5707584"><a href="/archive/zip/writer.go.html#5705793">w</a></span><span class="op" id="5707585">.</span><span class="ident" id="5707586">cw</span><span class="op" id="5707588">,</span>&nbsp;<span class="ident" id="5707590"><a href="/archive/zip/writer.go.html#5706076">h</a></span><span class="op" id="5707591">.</span><span class="ident" id="5707592">Comment</span><span class="op" id="5707599">)</span><span class="op" id="5707600">;</span>&nbsp;<span class="ident" id="5707602"><a href="/archive/zip/writer.go.html#5707562">err</a></span>&nbsp;<span class="op" id="5707606">!=</span>&nbsp;<span class="ident" id="5707609">nil</span>&nbsp;<span class="op" id="5707613">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707618">return</span>&nbsp;<span class="ident" id="5707625"><a href="/archive/zip/writer.go.html#5707562">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5707631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5707634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707637">end</span>&nbsp;<span class="op" id="5707641">:=</span>&nbsp;<span class="ident" id="5707644"><a href="/archive/zip/writer.go.html#5705793">w</a></span><span class="op" id="5707645">.</span><span class="ident" id="5707646">cw</span><span class="op" id="5707648">.</span><span class="ident" id="5707649">count</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707657">records</span>&nbsp;<span class="op" id="5707665">:=</span>&nbsp;<span class="ident" id="5707668">uint64</span><span class="op" id="5707674">(</span><span class="builtinfunc" id="5707675">len</span><span class="op" id="5707678">(</span><span class="ident" id="5707679"><a href="/archive/zip/writer.go.html#5705793">w</a></span><span class="op" id="5707680">.</span><span class="ident" id="5707681">dir</span><span class="op" id="5707684">)</span><span class="op" id="5707685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707688">size</span>&nbsp;<span class="op" id="5707693">:=</span>&nbsp;<span class="ident" id="5707696">uint64</span><span class="op" id="5707702">(</span><span class="ident" id="5707703"><a href="/archive/zip/writer.go.html#5707637">end</a></span>&nbsp;<span class="op" id="5707707">-</span>&nbsp;<span class="ident" id="5707709"><a href="/archive/zip/writer.go.html#5706048">start</a></span><span class="op" id="5707714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707717">offset</span>&nbsp;<span class="op" id="5707724">:=</span>&nbsp;<span class="ident" id="5707727">uint64</span><span class="op" id="5707733">(</span><span class="ident" id="5707734"><a href="/archive/zip/writer.go.html#5706048">start</a></span><span class="op" id="5707739">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707743">if</span>&nbsp;<span class="ident" id="5707746"><a href="/archive/zip/writer.go.html#5707657">records</a></span>&nbsp;<span class="op" id="5707754">&gt;</span>&nbsp;<span class="ident" id="5707756"><a href="/archive/zip/struct.go.html#5698099">uint16max</a></span>&nbsp;<span class="op" id="5707766">||</span>&nbsp;<span class="ident" id="5707769"><a href="/archive/zip/writer.go.html#5707688">size</a></span>&nbsp;<span class="op" id="5707774">&gt;</span>&nbsp;<span class="ident" id="5707776"><a href="/archive/zip/struct.go.html#5698126">uint32max</a></span>&nbsp;<span class="op" id="5707786">||</span>&nbsp;<span class="ident" id="5707789"><a href="/archive/zip/writer.go.html#5707717">offset</a></span>&nbsp;<span class="op" id="5707796">&gt;</span>&nbsp;<span class="ident" id="5707798"><a href="/archive/zip/struct.go.html#5698126">uint32max</a></span>&nbsp;<span class="op" id="5707808">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707812">var</span>&nbsp;<span class="ident" id="5707816">buf</span>&nbsp;<span class="op" id="5707820">[</span><span class="ident" id="5707821"><a href="/archive/zip/struct.go.html#5697760">directory64EndLen</a></span>&nbsp;<span class="op" id="5707839">+</span>&nbsp;<span class="ident" id="5707841"><a href="/archive/zip/struct.go.html#5697718">directory64LocLen</a></span><span class="op" id="5707858">]</span><span class="builtintype" id="5707859">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707866">b</span>&nbsp;<span class="op" id="5707868">:=</span>&nbsp;<span class="ident" id="5707871"><a href="/archive/zip/writer.go.html#5714063">writeBuf</a></span><span class="op" id="5707879">(</span><span class="ident" id="5707880"><a href="/archive/zip/writer.go.html#5707816">buf</a></span><span class="op" id="5707883">[</span><span class="op" id="5707884">:</span><span class="op" id="5707885">]</span><span class="op" id="5707886">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5707891">//&nbsp;zip64&nbsp;end&nbsp;of&nbsp;central&nbsp;directory&nbsp;record</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707934"><a href="/archive/zip/writer.go.html#5707866">b</a></span><span class="op" id="5707935">.</span><span class="builtintype" id="5707936">uint32</span><span class="op" id="5707942">(</span><span class="ident" id="5707943"><a href="/archive/zip/struct.go.html#5697233">directory64EndSignature</a></span><span class="op" id="5707966">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707970"><a href="/archive/zip/writer.go.html#5707866">b</a></span><span class="op" id="5707971">.</span><span class="ident" id="5707972">uint64</span><span class="op" id="5707978">(</span><span class="ident" id="5707979"><a href="/archive/zip/struct.go.html#5697760">directory64EndLen</a></span><span class="op" id="5707996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708000"><a href="/archive/zip/writer.go.html#5707866">b</a></span><span class="op" id="5708001">.</span><span class="builtintype" id="5708002">uint16</span><span class="op" id="5708008">(</span><span class="ident" id="5708009"><a href="/archive/zip/struct.go.html#5698007">zipVersion45</a></span><span class="op" id="5708021">)</span>&nbsp;<span class="comment" id="5708023">//&nbsp;version&nbsp;made&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708044"><a href="/archive/zip/writer.go.html#5707866">b</a></span><span class="op" id="5708045">.</span><span class="builtintype" id="5708046">uint16</span><span class="op" id="5708052">(</span><span class="ident" id="5708053"><a href="/archive/zip/struct.go.html#5698007">zipVersion45</a></span><span class="op" id="5708065">)</span>&nbsp;<span class="comment" id="5708067">//&nbsp;version&nbsp;needed&nbsp;to&nbsp;extract</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708098"><a href="/archive/zip/writer.go.html#5707866">b</a></span><span class="op" id="5708099">.</span><span class="builtintype" id="5708100">uint32</span><span class="op" id="5708106">(</span><span class="num" id="5708107">0</span><span class="op" id="5708108">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5708121">//&nbsp;number&nbsp;of&nbsp;this&nbsp;disk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708146"><a href="/archive/zip/writer.go.html#5707866">b</a></span><span class="op" id="5708147">.</span><span class="builtintype" id="5708148">uint32</span><span class="op" id="5708154">(</span><span class="num" id="5708155">0</span><span class="op" id="5708156">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5708169">//&nbsp;number&nbsp;of&nbsp;the&nbsp;disk&nbsp;with&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;central&nbsp;directory</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708233"><a href="/archive/zip/writer.go.html#5707866">b</a></span><span class="op" id="5708234">.</span><span class="ident" id="5708235">uint64</span><span class="op" id="5708241">(</span><span class="ident" id="5708242"><a href="/archive/zip/writer.go.html#5707657">records</a></span><span class="op" id="5708249">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5708256">//&nbsp;total&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;the&nbsp;central&nbsp;directory&nbsp;on&nbsp;this&nbsp;disk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708323"><a href="/archive/zip/writer.go.html#5707866">b</a></span><span class="op" id="5708324">.</span><span class="ident" id="5708325">uint64</span><span class="op" id="5708331">(</span><span class="ident" id="5708332"><a href="/archive/zip/writer.go.html#5707657">records</a></span><span class="op" id="5708339">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5708346">//&nbsp;total&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;the&nbsp;central&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708400"><a href="/archive/zip/writer.go.html#5707866">b</a></span><span class="op" id="5708401">.</span><span class="ident" id="5708402">uint64</span><span class="op" id="5708408">(</span><span class="ident" id="5708409"><a href="/archive/zip/writer.go.html#5707688">size</a></span><span class="op" id="5708413">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5708423">//&nbsp;size&nbsp;of&nbsp;the&nbsp;central&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708458"><a href="/archive/zip/writer.go.html#5707866">b</a></span><span class="op" id="5708459">.</span><span class="ident" id="5708460">uint64</span><span class="op" id="5708466">(</span><span class="ident" id="5708467"><a href="/archive/zip/writer.go.html#5707717">offset</a></span><span class="op" id="5708473">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5708481">//&nbsp;offset&nbsp;of&nbsp;start&nbsp;of&nbsp;central&nbsp;directory&nbsp;with&nbsp;respect&nbsp;to&nbsp;the&nbsp;starting&nbsp;disk&nbsp;number</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5708565">//&nbsp;zip64&nbsp;end&nbsp;of&nbsp;central&nbsp;directory&nbsp;locator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708609"><a href="/archive/zip/writer.go.html#5707866">b</a></span><span class="op" id="5708610">.</span><span class="builtintype" id="5708611">uint32</span><span class="op" id="5708617">(</span><span class="ident" id="5708618"><a href="/archive/zip/struct.go.html#5697194">directory64LocSignature</a></span><span class="op" id="5708641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708645"><a href="/archive/zip/writer.go.html#5707866">b</a></span><span class="op" id="5708646">.</span><span class="builtintype" id="5708647">uint32</span><span class="op" id="5708653">(</span><span class="num" id="5708654">0</span><span class="op" id="5708655">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5708667">//&nbsp;number&nbsp;of&nbsp;the&nbsp;disk&nbsp;with&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;zip64&nbsp;end&nbsp;of&nbsp;central&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708744"><a href="/archive/zip/writer.go.html#5707866">b</a></span><span class="op" id="5708745">.</span><span class="ident" id="5708746">uint64</span><span class="op" id="5708752">(</span><span class="ident" id="5708753">uint64</span><span class="op" id="5708759">(</span><span class="ident" id="5708760"><a href="/archive/zip/writer.go.html#5707637">end</a></span><span class="op" id="5708763">)</span><span class="op" id="5708764">)</span>&nbsp;<span class="comment" id="5708766">//&nbsp;relative&nbsp;offset&nbsp;of&nbsp;the&nbsp;zip64&nbsp;end&nbsp;of&nbsp;central&nbsp;directory&nbsp;record</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708832"><a href="/archive/zip/writer.go.html#5707866">b</a></span><span class="op" id="5708833">.</span><span class="builtintype" id="5708834">uint32</span><span class="op" id="5708840">(</span><span class="num" id="5708841">1</span><span class="op" id="5708842">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5708854">//&nbsp;total&nbsp;number&nbsp;of&nbsp;disks</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5708882">if</span>&nbsp;<span class="ident" id="5708885">_</span><span class="op" id="5708886">,</span>&nbsp;<span class="ident" id="5708888">err</span>&nbsp;<span class="op" id="5708892">:=</span>&nbsp;<span class="ident" id="5708895"><a href="/archive/zip/writer.go.html#5705793">w</a></span><span class="op" id="5708896">.</span><span class="ident" id="5708897">cw</span><span class="op" id="5708899">.</span><span class="ident" id="5708900">Write</span><span class="op" id="5708905">(</span><span class="ident" id="5708906"><a href="/archive/zip/writer.go.html#5707816">buf</a></span><span class="op" id="5708909">[</span><span class="op" id="5708910">:</span><span class="op" id="5708911">]</span><span class="op" id="5708912">)</span><span class="op" id="5708913">;</span>&nbsp;<span class="ident" id="5708915"><a href="/archive/zip/writer.go.html#5708888">err</a></span>&nbsp;<span class="op" id="5708919">!=</span>&nbsp;<span class="ident" id="5708922">nil</span>&nbsp;<span class="op" id="5708926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5708931">return</span>&nbsp;<span class="ident" id="5708938"><a href="/archive/zip/writer.go.html#5708888">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5708944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5708949">//&nbsp;store&nbsp;max&nbsp;values&nbsp;in&nbsp;the&nbsp;regular&nbsp;end&nbsp;record&nbsp;to&nbsp;signal&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5709012">//&nbsp;that&nbsp;the&nbsp;zip64&nbsp;values&nbsp;should&nbsp;be&nbsp;used&nbsp;instead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709062"><a href="/archive/zip/writer.go.html#5707657">records</a></span>&nbsp;<span class="op" id="5709070">=</span>&nbsp;<span class="ident" id="5709072"><a href="/archive/zip/struct.go.html#5698099">uint16max</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709084"><a href="/archive/zip/writer.go.html#5707688">size</a></span>&nbsp;<span class="op" id="5709089">=</span>&nbsp;<span class="ident" id="5709091"><a href="/archive/zip/struct.go.html#5698126">uint32max</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709103"><a href="/archive/zip/writer.go.html#5707717">offset</a></span>&nbsp;<span class="op" id="5709110">=</span>&nbsp;<span class="ident" id="5709112"><a href="/archive/zip/struct.go.html#5698126">uint32max</a></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5709123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5709127">//&nbsp;write&nbsp;end&nbsp;record</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5709148">var</span>&nbsp;<span class="ident" id="5709152">buf</span>&nbsp;<span class="op" id="5709156">[</span><span class="ident" id="5709157"><a href="/archive/zip/struct.go.html#5697489">directoryEndLen</a></span><span class="op" id="5709172">]</span><span class="builtintype" id="5709173">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709179">b</span>&nbsp;<span class="op" id="5709181">:=</span>&nbsp;<span class="ident" id="5709184"><a href="/archive/zip/writer.go.html#5714063">writeBuf</a></span><span class="op" id="5709192">(</span><span class="ident" id="5709193"><a href="/archive/zip/writer.go.html#5709152">buf</a></span><span class="op" id="5709196">[</span><span class="op" id="5709197">:</span><span class="op" id="5709198">]</span><span class="op" id="5709199">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709202"><a href="/archive/zip/writer.go.html#5709179">b</a></span><span class="op" id="5709203">.</span><span class="builtintype" id="5709204">uint32</span><span class="op" id="5709210">(</span><span class="builtintype" id="5709211">uint32</span><span class="op" id="5709217">(</span><span class="ident" id="5709218"><a href="/archive/zip/struct.go.html#5697155">directoryEndSignature</a></span><span class="op" id="5709239">)</span><span class="op" id="5709240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709243"><a href="/archive/zip/writer.go.html#5709179">b</a></span>&nbsp;<span class="op" id="5709245">=</span>&nbsp;<span class="ident" id="5709247"><a href="/archive/zip/writer.go.html#5709179">b</a></span><span class="op" id="5709248">[</span><span class="num" id="5709249">4</span><span class="op" id="5709250">:</span><span class="op" id="5709251">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5709269">//&nbsp;skip&nbsp;over&nbsp;disk&nbsp;number&nbsp;and&nbsp;first&nbsp;disk&nbsp;number&nbsp;(2x&nbsp;uint16)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709329"><a href="/archive/zip/writer.go.html#5709179">b</a></span><span class="op" id="5709330">.</span><span class="builtintype" id="5709331">uint16</span><span class="op" id="5709337">(</span><span class="builtintype" id="5709338">uint16</span><span class="op" id="5709344">(</span><span class="ident" id="5709345"><a href="/archive/zip/writer.go.html#5707657">records</a></span><span class="op" id="5709352">)</span><span class="op" id="5709353">)</span>&nbsp;<span class="comment" id="5709355">//&nbsp;number&nbsp;of&nbsp;entries&nbsp;this&nbsp;disk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709387"><a href="/archive/zip/writer.go.html#5709179">b</a></span><span class="op" id="5709388">.</span><span class="builtintype" id="5709389">uint16</span><span class="op" id="5709395">(</span><span class="builtintype" id="5709396">uint16</span><span class="op" id="5709402">(</span><span class="ident" id="5709403"><a href="/archive/zip/writer.go.html#5707657">records</a></span><span class="op" id="5709410">)</span><span class="op" id="5709411">)</span>&nbsp;<span class="comment" id="5709413">//&nbsp;number&nbsp;of&nbsp;entries&nbsp;total</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709441"><a href="/archive/zip/writer.go.html#5709179">b</a></span><span class="op" id="5709442">.</span><span class="builtintype" id="5709443">uint32</span><span class="op" id="5709449">(</span><span class="builtintype" id="5709450">uint32</span><span class="op" id="5709456">(</span><span class="ident" id="5709457"><a href="/archive/zip/writer.go.html#5707688">size</a></span><span class="op" id="5709461">)</span><span class="op" id="5709462">)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5709467">//&nbsp;size&nbsp;of&nbsp;directory</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709489"><a href="/archive/zip/writer.go.html#5709179">b</a></span><span class="op" id="5709490">.</span><span class="builtintype" id="5709491">uint32</span><span class="op" id="5709497">(</span><span class="builtintype" id="5709498">uint32</span><span class="op" id="5709504">(</span><span class="ident" id="5709505"><a href="/archive/zip/writer.go.html#5707717">offset</a></span><span class="op" id="5709511">)</span><span class="op" id="5709512">)</span>&nbsp;&nbsp;<span class="comment" id="5709515">//&nbsp;start&nbsp;of&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5709538">//&nbsp;skipped&nbsp;size&nbsp;of&nbsp;comment&nbsp;(always&nbsp;zero)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5709580">if</span>&nbsp;<span class="ident" id="5709583">_</span><span class="op" id="5709584">,</span>&nbsp;<span class="ident" id="5709586">err</span>&nbsp;<span class="op" id="5709590">:=</span>&nbsp;<span class="ident" id="5709593"><a href="/archive/zip/writer.go.html#5705793">w</a></span><span class="op" id="5709594">.</span><span class="ident" id="5709595">cw</span><span class="op" id="5709597">.</span><span class="ident" id="5709598">Write</span><span class="op" id="5709603">(</span><span class="ident" id="5709604"><a href="/archive/zip/writer.go.html#5709152">buf</a></span><span class="op" id="5709607">[</span><span class="op" id="5709608">:</span><span class="op" id="5709609">]</span><span class="op" id="5709610">)</span><span class="op" id="5709611">;</span>&nbsp;<span class="ident" id="5709613"><a href="/archive/zip/writer.go.html#5709586">err</a></span>&nbsp;<span class="op" id="5709617">!=</span>&nbsp;<span class="ident" id="5709620">nil</span>&nbsp;<span class="op" id="5709624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5709628">return</span>&nbsp;<span class="ident" id="5709635"><a href="/archive/zip/writer.go.html#5709586">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5709640">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5709644">return</span>&nbsp;<span class="ident" id="5709651"><a href="/archive/zip/writer.go.html#5705793">w</a></span><span class="op" id="5709652">.</span><span class="ident" id="5709653">cw</span><span class="op" id="5709655">.</span><span class="ident" id="5709656">w</span><span class="op" id="5709657">.</span><span class="op" id="5709658">(</span><span class="op" id="5709659">*</span><span class="ident" id="5709660"><a href="/archive/zip/writer.go.html#5704946">bufio</a></span><span class="op" id="5709665">.</span><span class="ident" id="5709666">Writer</span><span class="op" id="5709672">)</span><span class="op" id="5709673">.</span><span class="ident" id="5709674">Flush</span><span class="op" id="5709679">(</span><span class="op" id="5709680">)</span><br>
<span class="lineno"></span><span class="op" id="5709682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5709685">//&nbsp;Create&nbsp;adds&nbsp;a&nbsp;file&nbsp;to&nbsp;the&nbsp;zip&nbsp;file&nbsp;using&nbsp;the&nbsp;provided&nbsp;name.</span><br>
<span class="lineno">170</span><span class="comment" id="5709748">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;Writer&nbsp;to&nbsp;which&nbsp;the&nbsp;file&nbsp;contents&nbsp;should&nbsp;be&nbsp;written.</span><br>
<span class="lineno"></span><span class="comment" id="5709817">//&nbsp;The&nbsp;name&nbsp;must&nbsp;be&nbsp;a&nbsp;relative&nbsp;path:&nbsp;it&nbsp;must&nbsp;not&nbsp;start&nbsp;with&nbsp;a&nbsp;drive</span><br>
<span class="lineno"></span><span class="comment" id="5709885">//&nbsp;letter&nbsp;(e.g.&nbsp;C:)&nbsp;or&nbsp;leading&nbsp;slash,&nbsp;and&nbsp;only&nbsp;forward&nbsp;slashes&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="5709952">//&nbsp;allowed.</span><br>
<span class="lineno"></span><span class="comment" id="5709964">//&nbsp;The&nbsp;file&#39;s&nbsp;contents&nbsp;must&nbsp;be&nbsp;written&nbsp;to&nbsp;the&nbsp;io.Writer&nbsp;before&nbsp;the&nbsp;next</span><br>
<span class="lineno">175</span><span class="comment" id="5710036">//&nbsp;call&nbsp;to&nbsp;Create,&nbsp;CreateHeader,&nbsp;or&nbsp;Close.</span><br>
<span class="lineno"></span><span class="keyword" id="5710079">func</span>&nbsp;<span class="op" id="5710084">(</span><span class="ident" id="5710085">w</span>&nbsp;<span class="op" id="5710087">*</span><span class="ident" id="5710088"><a href="/archive/zip/writer.go.html#5705147">Writer</a></span><span class="op" id="5710094">)</span>&nbsp;<span class="ident" id="5710096">Create</span><span class="op" id="5710102">(</span><span class="ident" id="5710103">name</span>&nbsp;<span class="builtintype" id="5710108">string</span><span class="op" id="5710114">)</span>&nbsp;<span class="op" id="5710116">(</span><span class="ident" id="5710117"><a href="/archive/zip/writer.go.html#5705006">io</a></span><span class="op" id="5710119">.</span><span class="ident" id="5710120">Writer</span><span class="op" id="5710126">,</span>&nbsp;<span class="builtintype" id="5710128">error</span><span class="op" id="5710133">)</span>&nbsp;<span class="op" id="5710135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710138">header</span>&nbsp;<span class="op" id="5710145">:=</span>&nbsp;<span class="op" id="5710148">&amp;</span><span class="ident" id="5710149"><a href="/archive/zip/struct.go.html#5698331">FileHeader</a></span><span class="op" id="5710159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710163">Name</span><span class="op" id="5710167">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5710171"><a href="/archive/zip/writer.go.html#5710103">name</a></span><span class="op" id="5710175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710179">Method</span><span class="op" id="5710185">:</span>&nbsp;<span class="ident" id="5710187"><a href="/archive/zip/struct.go.html#5697046">Deflate</a></span><span class="op" id="5710194">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5710197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710200">return</span>&nbsp;<span class="ident" id="5710207"><a href="/archive/zip/writer.go.html#5710085">w</a></span><span class="op" id="5710208">.</span><span class="ident" id="5710209">CreateHeader</span><span class="op" id="5710221">(</span><span class="ident" id="5710222"><a href="/archive/zip/writer.go.html#5710138">header</a></span><span class="op" id="5710228">)</span><br>
<span class="lineno"></span><span class="op" id="5710230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5710233">//&nbsp;CreateHeader&nbsp;adds&nbsp;a&nbsp;file&nbsp;to&nbsp;the&nbsp;zip&nbsp;file&nbsp;using&nbsp;the&nbsp;provided&nbsp;FileHeader</span><br>
<span class="lineno">185</span><span class="comment" id="5710307">//&nbsp;for&nbsp;the&nbsp;file&nbsp;metadata.</span><br>
<span class="lineno"></span><span class="comment" id="5710333">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;Writer&nbsp;to&nbsp;which&nbsp;the&nbsp;file&nbsp;contents&nbsp;should&nbsp;be&nbsp;written.</span><br>
<span class="lineno"></span><span class="comment" id="5710402">//&nbsp;The&nbsp;file&#39;s&nbsp;contents&nbsp;must&nbsp;be&nbsp;written&nbsp;to&nbsp;the&nbsp;io.Writer&nbsp;before&nbsp;the&nbsp;next</span><br>
<span class="lineno"></span><span class="comment" id="5710474">//&nbsp;call&nbsp;to&nbsp;Create,&nbsp;CreateHeader,&nbsp;or&nbsp;Close.</span><br>
<span class="lineno"></span><span class="keyword" id="5710517">func</span>&nbsp;<span class="op" id="5710522">(</span><span class="ident" id="5710523">w</span>&nbsp;<span class="op" id="5710525">*</span><span class="ident" id="5710526"><a href="/archive/zip/writer.go.html#5705147">Writer</a></span><span class="op" id="5710532">)</span>&nbsp;<span class="ident" id="5710534">CreateHeader</span><span class="op" id="5710546">(</span><span class="ident" id="5710547">fh</span>&nbsp;<span class="op" id="5710550">*</span><span class="ident" id="5710551"><a href="/archive/zip/struct.go.html#5698331">FileHeader</a></span><span class="op" id="5710561">)</span>&nbsp;<span class="op" id="5710563">(</span><span class="ident" id="5710564"><a href="/archive/zip/writer.go.html#5705006">io</a></span><span class="op" id="5710566">.</span><span class="ident" id="5710567">Writer</span><span class="op" id="5710573">,</span>&nbsp;<span class="builtintype" id="5710575">error</span><span class="op" id="5710580">)</span>&nbsp;<span class="op" id="5710582">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710585">if</span>&nbsp;<span class="ident" id="5710588"><a href="/archive/zip/writer.go.html#5710523">w</a></span><span class="op" id="5710589">.</span><span class="ident" id="5710590">last</span>&nbsp;<span class="op" id="5710595">!=</span>&nbsp;<span class="ident" id="5710598">nil</span>&nbsp;<span class="op" id="5710602">&amp;&amp;</span>&nbsp;<span class="op" id="5710605">!</span><span class="ident" id="5710606"><a href="/archive/zip/writer.go.html#5710523">w</a></span><span class="op" id="5710607">.</span><span class="ident" id="5710608">last</span><span class="op" id="5710612">.</span><span class="ident" id="5710613">closed</span>&nbsp;<span class="op" id="5710620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710624">if</span>&nbsp;<span class="ident" id="5710627">err</span>&nbsp;<span class="op" id="5710631">:=</span>&nbsp;<span class="ident" id="5710634"><a href="/archive/zip/writer.go.html#5710523">w</a></span><span class="op" id="5710635">.</span><span class="ident" id="5710636">last</span><span class="op" id="5710640">.</span><span class="builtinfunc" id="5710641">close</span><span class="op" id="5710646">(</span><span class="op" id="5710647">)</span><span class="op" id="5710648">;</span>&nbsp;<span class="ident" id="5710650"><a href="/archive/zip/writer.go.html#5710627">err</a></span>&nbsp;<span class="op" id="5710654">!=</span>&nbsp;<span class="ident" id="5710657">nil</span>&nbsp;<span class="op" id="5710661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710666">return</span>&nbsp;<span class="ident" id="5710673">nil</span><span class="op" id="5710676">,</span>&nbsp;<span class="ident" id="5710678"><a href="/archive/zip/writer.go.html#5710627">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5710684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5710687">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710691"><a href="/archive/zip/writer.go.html#5710547">fh</a></span><span class="op" id="5710693">.</span><span class="ident" id="5710694">Flags</span>&nbsp;<span class="op" id="5710700">|=</span>&nbsp;<span class="num" id="5710703">0x8</span>&nbsp;<span class="comment" id="5710707">//&nbsp;we&nbsp;will&nbsp;write&nbsp;a&nbsp;data&nbsp;descriptor</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710744"><a href="/archive/zip/writer.go.html#5710547">fh</a></span><span class="op" id="5710746">.</span><span class="ident" id="5710747">CreatorVersion</span>&nbsp;<span class="op" id="5710762">=</span>&nbsp;<span class="ident" id="5710764"><a href="/archive/zip/writer.go.html#5710547">fh</a></span><span class="op" id="5710766">.</span><span class="ident" id="5710767">CreatorVersion</span><span class="op" id="5710781">&amp;</span><span class="num" id="5710782">0xff00</span>&nbsp;<span class="op" id="5710789">|</span>&nbsp;<span class="ident" id="5710791"><a href="/archive/zip/struct.go.html#5697981">zipVersion20</a></span>&nbsp;<span class="comment" id="5710804">//&nbsp;preserve&nbsp;compatibility&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710836"><a href="/archive/zip/writer.go.html#5710547">fh</a></span><span class="op" id="5710838">.</span><span class="ident" id="5710839">ReaderVersion</span>&nbsp;<span class="op" id="5710853">=</span>&nbsp;<span class="ident" id="5710855"><a href="/archive/zip/struct.go.html#5697981">zipVersion20</a></span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710870">fw</span>&nbsp;<span class="op" id="5710873">:=</span>&nbsp;<span class="op" id="5710876">&amp;</span><span class="ident" id="5710877"><a href="/archive/zip/writer.go.html#5712049">fileWriter</a></span><span class="op" id="5710887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710891">zipw</span><span class="op" id="5710895">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5710902"><a href="/archive/zip/writer.go.html#5710523">w</a></span><span class="op" id="5710903">.</span><span class="ident" id="5710904">cw</span><span class="op" id="5710906">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710910">compCount</span><span class="op" id="5710919">:</span>&nbsp;<span class="op" id="5710921">&amp;</span><span class="ident" id="5710922"><a href="/archive/zip/writer.go.html#5713800">countWriter</a></span><span class="op" id="5710933">{</span><span class="ident" id="5710934">w</span><span class="op" id="5710935">:</span>&nbsp;<span class="ident" id="5710937"><a href="/archive/zip/writer.go.html#5710523">w</a></span><span class="op" id="5710938">.</span><span class="ident" id="5710939">cw</span><span class="op" id="5710941">}</span><span class="op" id="5710942">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710946">crc32</span><span class="op" id="5710951">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5710957"><a href="/archive/zip/writer.go.html#5704992">crc32</a></span><span class="op" id="5710962">.</span><span class="ident" id="5710963">NewIEEE</span><span class="op" id="5710970">(</span><span class="op" id="5710971">)</span><span class="op" id="5710972">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5710975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710978">comp</span>&nbsp;<span class="op" id="5710983">:=</span>&nbsp;<span class="ident" id="5710986"><a href="/archive/zip/register.go.html#5696062">compressor</a></span><span class="op" id="5710996">(</span><span class="ident" id="5710997"><a href="/archive/zip/writer.go.html#5710547">fh</a></span><span class="op" id="5710999">.</span><span class="ident" id="5711000">Method</span><span class="op" id="5711006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711009">if</span>&nbsp;<span class="ident" id="5711012"><a href="/archive/zip/writer.go.html#5710978">comp</a></span>&nbsp;<span class="op" id="5711017">==</span>&nbsp;<span class="ident" id="5711020">nil</span>&nbsp;<span class="op" id="5711024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711028">return</span>&nbsp;<span class="ident" id="5711035">nil</span><span class="op" id="5711038">,</span>&nbsp;<span class="ident" id="5711040"><a href="/archive/zip/reader.go.html#5681526">ErrAlgorithm</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5711054">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711057">var</span>&nbsp;<span class="ident" id="5711061">err</span>&nbsp;<span class="builtintype" id="5711065">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711072"><a href="/archive/zip/writer.go.html#5710870">fw</a></span><span class="op" id="5711074">.</span><span class="ident" id="5711075">comp</span><span class="op" id="5711079">,</span>&nbsp;<span class="ident" id="5711081"><a href="/archive/zip/writer.go.html#5711061">err</a></span>&nbsp;<span class="op" id="5711085">=</span>&nbsp;<span class="ident" id="5711087"><a href="/archive/zip/writer.go.html#5710978">comp</a></span><span class="op" id="5711091">(</span><span class="ident" id="5711092"><a href="/archive/zip/writer.go.html#5710870">fw</a></span><span class="op" id="5711094">.</span><span class="ident" id="5711095">compCount</span><span class="op" id="5711104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711107">if</span>&nbsp;<span class="ident" id="5711110"><a href="/archive/zip/writer.go.html#5711061">err</a></span>&nbsp;<span class="op" id="5711114">!=</span>&nbsp;<span class="ident" id="5711117">nil</span>&nbsp;<span class="op" id="5711121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711125">return</span>&nbsp;<span class="ident" id="5711132">nil</span><span class="op" id="5711135">,</span>&nbsp;<span class="ident" id="5711137"><a href="/archive/zip/writer.go.html#5711061">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5711142">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711145"><a href="/archive/zip/writer.go.html#5710870">fw</a></span><span class="op" id="5711147">.</span><span class="ident" id="5711148">rawCount</span>&nbsp;<span class="op" id="5711157">=</span>&nbsp;<span class="op" id="5711159">&amp;</span><span class="ident" id="5711160"><a href="/archive/zip/writer.go.html#5713800">countWriter</a></span><span class="op" id="5711171">{</span><span class="ident" id="5711172">w</span><span class="op" id="5711173">:</span>&nbsp;<span class="ident" id="5711175"><a href="/archive/zip/writer.go.html#5710870">fw</a></span><span class="op" id="5711177">.</span><span class="ident" id="5711178">comp</span><span class="op" id="5711182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711186">h</span>&nbsp;<span class="op" id="5711188">:=</span>&nbsp;<span class="op" id="5711191">&amp;</span><span class="ident" id="5711192"><a href="/archive/zip/writer.go.html#5705243">header</a></span><span class="op" id="5711198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711202">FileHeader</span><span class="op" id="5711212">:</span>&nbsp;<span class="ident" id="5711214"><a href="/archive/zip/writer.go.html#5710547">fh</a></span><span class="op" id="5711216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711220">offset</span><span class="op" id="5711226">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5711232">uint64</span><span class="op" id="5711238">(</span><span class="ident" id="5711239"><a href="/archive/zip/writer.go.html#5710523">w</a></span><span class="op" id="5711240">.</span><span class="ident" id="5711241">cw</span><span class="op" id="5711243">.</span><span class="ident" id="5711244">count</span><span class="op" id="5711249">)</span><span class="op" id="5711250">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5711253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711256"><a href="/archive/zip/writer.go.html#5710523">w</a></span><span class="op" id="5711257">.</span><span class="ident" id="5711258">dir</span>&nbsp;<span class="op" id="5711262">=</span>&nbsp;<span class="builtinfunc" id="5711264">append</span><span class="op" id="5711270">(</span><span class="ident" id="5711271"><a href="/archive/zip/writer.go.html#5710523">w</a></span><span class="op" id="5711272">.</span><span class="ident" id="5711273">dir</span><span class="op" id="5711276">,</span>&nbsp;<span class="ident" id="5711278"><a href="/archive/zip/writer.go.html#5711186">h</a></span><span class="op" id="5711279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711282"><a href="/archive/zip/writer.go.html#5710870">fw</a></span><span class="op" id="5711284">.</span><span class="ident" id="5711285">header</span>&nbsp;<span class="op" id="5711292">=</span>&nbsp;<span class="ident" id="5711294"><a href="/archive/zip/writer.go.html#5711186">h</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711298">if</span>&nbsp;<span class="ident" id="5711301">err</span>&nbsp;<span class="op" id="5711305">:=</span>&nbsp;<span class="ident" id="5711308"><a href="/archive/zip/writer.go.html#5711403">writeHeader</a></span><span class="op" id="5711319">(</span><span class="ident" id="5711320"><a href="/archive/zip/writer.go.html#5710523">w</a></span><span class="op" id="5711321">.</span><span class="ident" id="5711322">cw</span><span class="op" id="5711324">,</span>&nbsp;<span class="ident" id="5711326"><a href="/archive/zip/writer.go.html#5710547">fh</a></span><span class="op" id="5711328">)</span><span class="op" id="5711329">;</span>&nbsp;<span class="ident" id="5711331"><a href="/archive/zip/writer.go.html#5711301">err</a></span>&nbsp;<span class="op" id="5711335">!=</span>&nbsp;<span class="ident" id="5711338">nil</span>&nbsp;<span class="op" id="5711342">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711346">return</span>&nbsp;<span class="ident" id="5711353">nil</span><span class="op" id="5711356">,</span>&nbsp;<span class="ident" id="5711358"><a href="/archive/zip/writer.go.html#5711301">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5711363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711367"><a href="/archive/zip/writer.go.html#5710523">w</a></span><span class="op" id="5711368">.</span><span class="ident" id="5711369">last</span>&nbsp;<span class="op" id="5711374">=</span>&nbsp;<span class="ident" id="5711376"><a href="/archive/zip/writer.go.html#5710870">fw</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711380">return</span>&nbsp;<span class="ident" id="5711387"><a href="/archive/zip/writer.go.html#5710870">fw</a></span><span class="op" id="5711389">,</span>&nbsp;<span class="ident" id="5711391">nil</span><br>
<span class="lineno">230</span><span class="op" id="5711395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5711398">func</span>&nbsp;<span class="ident" id="5711403">writeHeader</span><span class="op" id="5711414">(</span><span class="ident" id="5711415">w</span>&nbsp;<span class="ident" id="5711417"><a href="/archive/zip/writer.go.html#5705006">io</a></span><span class="op" id="5711419">.</span><span class="ident" id="5711420">Writer</span><span class="op" id="5711426">,</span>&nbsp;<span class="ident" id="5711428">h</span>&nbsp;<span class="op" id="5711430">*</span><span class="ident" id="5711431"><a href="/archive/zip/struct.go.html#5698331">FileHeader</a></span><span class="op" id="5711441">)</span>&nbsp;<span class="builtintype" id="5711443">error</span>&nbsp;<span class="op" id="5711449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711452">var</span>&nbsp;<span class="ident" id="5711456">buf</span>&nbsp;<span class="op" id="5711460">[</span><span class="ident" id="5711461"><a href="/archive/zip/struct.go.html#5697357">fileHeaderLen</a></span><span class="op" id="5711474">]</span><span class="builtintype" id="5711475">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711481">b</span>&nbsp;<span class="op" id="5711483">:=</span>&nbsp;<span class="ident" id="5711486"><a href="/archive/zip/writer.go.html#5714063">writeBuf</a></span><span class="op" id="5711494">(</span><span class="ident" id="5711495"><a href="/archive/zip/writer.go.html#5711456">buf</a></span><span class="op" id="5711498">[</span><span class="op" id="5711499">:</span><span class="op" id="5711500">]</span><span class="op" id="5711501">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711504"><a href="/archive/zip/writer.go.html#5711481">b</a></span><span class="op" id="5711505">.</span><span class="builtintype" id="5711506">uint32</span><span class="op" id="5711512">(</span><span class="builtintype" id="5711513">uint32</span><span class="op" id="5711519">(</span><span class="ident" id="5711520"><a href="/archive/zip/struct.go.html#5697077">fileHeaderSignature</a></span><span class="op" id="5711539">)</span><span class="op" id="5711540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711543"><a href="/archive/zip/writer.go.html#5711481">b</a></span><span class="op" id="5711544">.</span><span class="builtintype" id="5711545">uint16</span><span class="op" id="5711551">(</span><span class="ident" id="5711552"><a href="/archive/zip/writer.go.html#5711428">h</a></span><span class="op" id="5711553">.</span><span class="ident" id="5711554">ReaderVersion</span><span class="op" id="5711567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711570"><a href="/archive/zip/writer.go.html#5711481">b</a></span><span class="op" id="5711571">.</span><span class="builtintype" id="5711572">uint16</span><span class="op" id="5711578">(</span><span class="ident" id="5711579"><a href="/archive/zip/writer.go.html#5711428">h</a></span><span class="op" id="5711580">.</span><span class="ident" id="5711581">Flags</span><span class="op" id="5711586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711589"><a href="/archive/zip/writer.go.html#5711481">b</a></span><span class="op" id="5711590">.</span><span class="builtintype" id="5711591">uint16</span><span class="op" id="5711597">(</span><span class="ident" id="5711598"><a href="/archive/zip/writer.go.html#5711428">h</a></span><span class="op" id="5711599">.</span><span class="ident" id="5711600">Method</span><span class="op" id="5711606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711609"><a href="/archive/zip/writer.go.html#5711481">b</a></span><span class="op" id="5711610">.</span><span class="builtintype" id="5711611">uint16</span><span class="op" id="5711617">(</span><span class="ident" id="5711618"><a href="/archive/zip/writer.go.html#5711428">h</a></span><span class="op" id="5711619">.</span><span class="ident" id="5711620">ModifiedTime</span><span class="op" id="5711632">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711635"><a href="/archive/zip/writer.go.html#5711481">b</a></span><span class="op" id="5711636">.</span><span class="builtintype" id="5711637">uint16</span><span class="op" id="5711643">(</span><span class="ident" id="5711644"><a href="/archive/zip/writer.go.html#5711428">h</a></span><span class="op" id="5711645">.</span><span class="ident" id="5711646">ModifiedDate</span><span class="op" id="5711658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711661"><a href="/archive/zip/writer.go.html#5711481">b</a></span><span class="op" id="5711662">.</span><span class="builtintype" id="5711663">uint32</span><span class="op" id="5711669">(</span><span class="num" id="5711670">0</span><span class="op" id="5711671">)</span>&nbsp;<span class="comment" id="5711673">//&nbsp;since&nbsp;we&nbsp;are&nbsp;writing&nbsp;a&nbsp;data&nbsp;descriptor&nbsp;crc32,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711723"><a href="/archive/zip/writer.go.html#5711481">b</a></span><span class="op" id="5711724">.</span><span class="builtintype" id="5711725">uint32</span><span class="op" id="5711731">(</span><span class="num" id="5711732">0</span><span class="op" id="5711733">)</span>&nbsp;<span class="comment" id="5711735">//&nbsp;compressed&nbsp;size,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711756"><a href="/archive/zip/writer.go.html#5711481">b</a></span><span class="op" id="5711757">.</span><span class="builtintype" id="5711758">uint32</span><span class="op" id="5711764">(</span><span class="num" id="5711765">0</span><span class="op" id="5711766">)</span>&nbsp;<span class="comment" id="5711768">//&nbsp;and&nbsp;uncompressed&nbsp;size&nbsp;should&nbsp;be&nbsp;zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711809"><a href="/archive/zip/writer.go.html#5711481">b</a></span><span class="op" id="5711810">.</span><span class="builtintype" id="5711811">uint16</span><span class="op" id="5711817">(</span><span class="builtintype" id="5711818">uint16</span><span class="op" id="5711824">(</span><span class="builtinfunc" id="5711825">len</span><span class="op" id="5711828">(</span><span class="ident" id="5711829"><a href="/archive/zip/writer.go.html#5711428">h</a></span><span class="op" id="5711830">.</span><span class="ident" id="5711831">Name</span><span class="op" id="5711835">)</span><span class="op" id="5711836">)</span><span class="op" id="5711837">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711840"><a href="/archive/zip/writer.go.html#5711481">b</a></span><span class="op" id="5711841">.</span><span class="builtintype" id="5711842">uint16</span><span class="op" id="5711848">(</span><span class="builtintype" id="5711849">uint16</span><span class="op" id="5711855">(</span><span class="builtinfunc" id="5711856">len</span><span class="op" id="5711859">(</span><span class="ident" id="5711860"><a href="/archive/zip/writer.go.html#5711428">h</a></span><span class="op" id="5711861">.</span><span class="ident" id="5711862">Extra</span><span class="op" id="5711867">)</span><span class="op" id="5711868">)</span><span class="op" id="5711869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711872">if</span>&nbsp;<span class="ident" id="5711875">_</span><span class="op" id="5711876">,</span>&nbsp;<span class="ident" id="5711878">err</span>&nbsp;<span class="op" id="5711882">:=</span>&nbsp;<span class="ident" id="5711885"><a href="/archive/zip/writer.go.html#5711415">w</a></span><span class="op" id="5711886">.</span><span class="ident" id="5711887">Write</span><span class="op" id="5711892">(</span><span class="ident" id="5711893"><a href="/archive/zip/writer.go.html#5711456">buf</a></span><span class="op" id="5711896">[</span><span class="op" id="5711897">:</span><span class="op" id="5711898">]</span><span class="op" id="5711899">)</span><span class="op" id="5711900">;</span>&nbsp;<span class="ident" id="5711902"><a href="/archive/zip/writer.go.html#5711878">err</a></span>&nbsp;<span class="op" id="5711906">!=</span>&nbsp;<span class="ident" id="5711909">nil</span>&nbsp;<span class="op" id="5711913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711917">return</span>&nbsp;<span class="ident" id="5711924"><a href="/archive/zip/writer.go.html#5711878">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5711929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711932">if</span>&nbsp;<span class="ident" id="5711935">_</span><span class="op" id="5711936">,</span>&nbsp;<span class="ident" id="5711938">err</span>&nbsp;<span class="op" id="5711942">:=</span>&nbsp;<span class="ident" id="5711945"><a href="/archive/zip/writer.go.html#5705006">io</a></span><span class="op" id="5711947">.</span><span class="ident" id="5711948">WriteString</span><span class="op" id="5711959">(</span><span class="ident" id="5711960"><a href="/archive/zip/writer.go.html#5711415">w</a></span><span class="op" id="5711961">,</span>&nbsp;<span class="ident" id="5711963"><a href="/archive/zip/writer.go.html#5711428">h</a></span><span class="op" id="5711964">.</span><span class="ident" id="5711965">Name</span><span class="op" id="5711969">)</span><span class="op" id="5711970">;</span>&nbsp;<span class="ident" id="5711972"><a href="/archive/zip/writer.go.html#5711938">err</a></span>&nbsp;<span class="op" id="5711976">!=</span>&nbsp;<span class="ident" id="5711979">nil</span>&nbsp;<span class="op" id="5711983">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711987">return</span>&nbsp;<span class="ident" id="5711994"><a href="/archive/zip/writer.go.html#5711938">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5711999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712002">_</span><span class="op" id="5712003">,</span>&nbsp;<span class="ident" id="5712005">err</span>&nbsp;<span class="op" id="5712009">:=</span>&nbsp;<span class="ident" id="5712012"><a href="/archive/zip/writer.go.html#5711415">w</a></span><span class="op" id="5712013">.</span><span class="ident" id="5712014">Write</span><span class="op" id="5712019">(</span><span class="ident" id="5712020"><a href="/archive/zip/writer.go.html#5711428">h</a></span><span class="op" id="5712021">.</span><span class="ident" id="5712022">Extra</span><span class="op" id="5712027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712030">return</span>&nbsp;<span class="ident" id="5712037"><a href="/archive/zip/writer.go.html#5712005">err</a></span><br>
<span class="lineno"></span><span class="op" id="5712041">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span><span class="keyword" id="5712044">type</span>&nbsp;<span class="ident" id="5712049">fileWriter</span>&nbsp;<span class="keyword" id="5712060">struct</span>&nbsp;<span class="op" id="5712067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5712070">*</span><span class="ident" id="5712071"><a href="/archive/zip/writer.go.html#5705243">header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712079">zipw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5712089"><a href="/archive/zip/writer.go.html#5705006">io</a></span><span class="op" id="5712091">.</span><span class="ident" id="5712092">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712100">rawCount</span>&nbsp;&nbsp;<span class="op" id="5712110">*</span><span class="ident" id="5712111"><a href="/archive/zip/writer.go.html#5713800">countWriter</a></span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712124">comp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5712134"><a href="/archive/zip/writer.go.html#5705006">io</a></span><span class="op" id="5712136">.</span><span class="ident" id="5712137">WriteCloser</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712150">compCount</span>&nbsp;<span class="op" id="5712160">*</span><span class="ident" id="5712161"><a href="/archive/zip/writer.go.html#5713800">countWriter</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712174">crc32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5712184"><a href="/archive/zip/writer.go.html#5704984">hash</a></span><span class="op" id="5712188">.</span><span class="ident" id="5712189">Hash32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712197">closed</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5712207">bool</span><br>
<span class="lineno"></span><span class="op" id="5712212">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="5712215">func</span>&nbsp;<span class="op" id="5712220">(</span><span class="ident" id="5712221">w</span>&nbsp;<span class="op" id="5712223">*</span><span class="ident" id="5712224"><a href="/archive/zip/writer.go.html#5712049">fileWriter</a></span><span class="op" id="5712234">)</span>&nbsp;<span class="ident" id="5712236">Write</span><span class="op" id="5712241">(</span><span class="ident" id="5712242">p</span>&nbsp;<span class="op" id="5712244">[</span><span class="op" id="5712245">]</span><span class="builtintype" id="5712246">byte</span><span class="op" id="5712250">)</span>&nbsp;<span class="op" id="5712252">(</span><span class="builtintype" id="5712253">int</span><span class="op" id="5712256">,</span>&nbsp;<span class="builtintype" id="5712258">error</span><span class="op" id="5712263">)</span>&nbsp;<span class="op" id="5712265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712268">if</span>&nbsp;<span class="ident" id="5712271"><a href="/archive/zip/writer.go.html#5712221">w</a></span><span class="op" id="5712272">.</span><span class="ident" id="5712273">closed</span>&nbsp;<span class="op" id="5712280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712284">return</span>&nbsp;<span class="num" id="5712291">0</span><span class="op" id="5712292">,</span>&nbsp;<span class="ident" id="5712294"><a href="/archive/zip/writer.go.html#5704974">errors</a></span><span class="op" id="5712300">.</span><span class="ident" id="5712301">New</span><span class="op" id="5712304">(</span><span class="string" id="5712305">&#34;zip:&nbsp;write&nbsp;to&nbsp;closed&nbsp;file&#34;</span><span class="op" id="5712332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5712335">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712338"><a href="/archive/zip/writer.go.html#5712221">w</a></span><span class="op" id="5712339">.</span><span class="ident" id="5712340">crc32</span><span class="op" id="5712345">.</span><span class="ident" id="5712346">Write</span><span class="op" id="5712351">(</span><span class="ident" id="5712352"><a href="/archive/zip/writer.go.html#5712242">p</a></span><span class="op" id="5712353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712356">return</span>&nbsp;<span class="ident" id="5712363"><a href="/archive/zip/writer.go.html#5712221">w</a></span><span class="op" id="5712364">.</span><span class="ident" id="5712365">rawCount</span><span class="op" id="5712373">.</span><span class="ident" id="5712374">Write</span><span class="op" id="5712379">(</span><span class="ident" id="5712380"><a href="/archive/zip/writer.go.html#5712242">p</a></span><span class="op" id="5712381">)</span><br>
<span class="lineno"></span><span class="op" id="5712383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5712386">func</span>&nbsp;<span class="op" id="5712391">(</span><span class="ident" id="5712392">w</span>&nbsp;<span class="op" id="5712394">*</span><span class="ident" id="5712395"><a href="/archive/zip/writer.go.html#5712049">fileWriter</a></span><span class="op" id="5712405">)</span>&nbsp;<span class="builtinfunc" id="5712407">close</span><span class="op" id="5712412">(</span><span class="op" id="5712413">)</span>&nbsp;<span class="builtintype" id="5712415">error</span>&nbsp;<span class="op" id="5712421">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712424">if</span>&nbsp;<span class="ident" id="5712427"><a href="/archive/zip/writer.go.html#5712392">w</a></span><span class="op" id="5712428">.</span><span class="ident" id="5712429">closed</span>&nbsp;<span class="op" id="5712436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712440">return</span>&nbsp;<span class="ident" id="5712447"><a href="/archive/zip/writer.go.html#5704974">errors</a></span><span class="op" id="5712453">.</span><span class="ident" id="5712454">New</span><span class="op" id="5712457">(</span><span class="string" id="5712458">&#34;zip:&nbsp;file&nbsp;closed&nbsp;twice&#34;</span><span class="op" id="5712482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5712485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712488"><a href="/archive/zip/writer.go.html#5712392">w</a></span><span class="op" id="5712489">.</span><span class="ident" id="5712490">closed</span>&nbsp;<span class="op" id="5712497">=</span>&nbsp;<span class="builtintype" id="5712499">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712505">if</span>&nbsp;<span class="ident" id="5712508">err</span>&nbsp;<span class="op" id="5712512">:=</span>&nbsp;<span class="ident" id="5712515"><a href="/archive/zip/writer.go.html#5712392">w</a></span><span class="op" id="5712516">.</span><span class="ident" id="5712517">comp</span><span class="op" id="5712521">.</span><span class="ident" id="5712522">Close</span><span class="op" id="5712527">(</span><span class="op" id="5712528">)</span><span class="op" id="5712529">;</span>&nbsp;<span class="ident" id="5712531"><a href="/archive/zip/writer.go.html#5712508">err</a></span>&nbsp;<span class="op" id="5712535">!=</span>&nbsp;<span class="ident" id="5712538">nil</span>&nbsp;<span class="op" id="5712542">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712546">return</span>&nbsp;<span class="ident" id="5712553"><a href="/archive/zip/writer.go.html#5712508">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5712558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5712562">//&nbsp;update&nbsp;FileHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712584">fh</span>&nbsp;<span class="op" id="5712587">:=</span>&nbsp;<span class="ident" id="5712590"><a href="/archive/zip/writer.go.html#5712392">w</a></span><span class="op" id="5712591">.</span><span class="ident" id="5712592">header</span><span class="op" id="5712598">.</span><span class="ident" id="5712599">FileHeader</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712611"><a href="/archive/zip/writer.go.html#5712584">fh</a></span><span class="op" id="5712613">.</span><span class="ident" id="5712614">CRC32</span>&nbsp;<span class="op" id="5712620">=</span>&nbsp;<span class="ident" id="5712622"><a href="/archive/zip/writer.go.html#5712392">w</a></span><span class="op" id="5712623">.</span><span class="ident" id="5712624">crc32</span><span class="op" id="5712629">.</span><span class="ident" id="5712630">Sum32</span><span class="op" id="5712635">(</span><span class="op" id="5712636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712639"><a href="/archive/zip/writer.go.html#5712584">fh</a></span><span class="op" id="5712641">.</span><span class="ident" id="5712642">CompressedSize64</span>&nbsp;<span class="op" id="5712659">=</span>&nbsp;<span class="ident" id="5712661">uint64</span><span class="op" id="5712667">(</span><span class="ident" id="5712668"><a href="/archive/zip/writer.go.html#5712392">w</a></span><span class="op" id="5712669">.</span><span class="ident" id="5712670">compCount</span><span class="op" id="5712679">.</span><span class="ident" id="5712680">count</span><span class="op" id="5712685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712688"><a href="/archive/zip/writer.go.html#5712584">fh</a></span><span class="op" id="5712690">.</span><span class="ident" id="5712691">UncompressedSize64</span>&nbsp;<span class="op" id="5712710">=</span>&nbsp;<span class="ident" id="5712712">uint64</span><span class="op" id="5712718">(</span><span class="ident" id="5712719"><a href="/archive/zip/writer.go.html#5712392">w</a></span><span class="op" id="5712720">.</span><span class="ident" id="5712721">rawCount</span><span class="op" id="5712729">.</span><span class="ident" id="5712730">count</span><span class="op" id="5712735">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712739">if</span>&nbsp;<span class="ident" id="5712742"><a href="/archive/zip/writer.go.html#5712584">fh</a></span><span class="op" id="5712744">.</span><span class="ident" id="5712745">isZip64</span><span class="op" id="5712752">(</span><span class="op" id="5712753">)</span>&nbsp;<span class="op" id="5712755">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712759"><a href="/archive/zip/writer.go.html#5712584">fh</a></span><span class="op" id="5712761">.</span><span class="ident" id="5712762">CompressedSize</span>&nbsp;<span class="op" id="5712777">=</span>&nbsp;<span class="ident" id="5712779"><a href="/archive/zip/struct.go.html#5698126">uint32max</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712791"><a href="/archive/zip/writer.go.html#5712584">fh</a></span><span class="op" id="5712793">.</span><span class="ident" id="5712794">UncompressedSize</span>&nbsp;<span class="op" id="5712811">=</span>&nbsp;<span class="ident" id="5712813"><a href="/archive/zip/struct.go.html#5698126">uint32max</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712825"><a href="/archive/zip/writer.go.html#5712584">fh</a></span><span class="op" id="5712827">.</span><span class="ident" id="5712828">ReaderVersion</span>&nbsp;<span class="op" id="5712842">=</span>&nbsp;<span class="ident" id="5712844"><a href="/archive/zip/struct.go.html#5698007">zipVersion45</a></span>&nbsp;<span class="comment" id="5712857">//&nbsp;requires&nbsp;4.5&nbsp;-&nbsp;File&nbsp;uses&nbsp;ZIP64&nbsp;format&nbsp;extensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5712910">}</span>&nbsp;<span class="keyword" id="5712912">else</span>&nbsp;<span class="op" id="5712917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712921"><a href="/archive/zip/writer.go.html#5712584">fh</a></span><span class="op" id="5712923">.</span><span class="ident" id="5712924">CompressedSize</span>&nbsp;<span class="op" id="5712939">=</span>&nbsp;<span class="builtintype" id="5712941">uint32</span><span class="op" id="5712947">(</span><span class="ident" id="5712948"><a href="/archive/zip/writer.go.html#5712584">fh</a></span><span class="op" id="5712950">.</span><span class="ident" id="5712951">CompressedSize64</span><span class="op" id="5712967">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712971"><a href="/archive/zip/writer.go.html#5712584">fh</a></span><span class="op" id="5712973">.</span><span class="ident" id="5712974">UncompressedSize</span>&nbsp;<span class="op" id="5712991">=</span>&nbsp;<span class="builtintype" id="5712993">uint32</span><span class="op" id="5712999">(</span><span class="ident" id="5713000"><a href="/archive/zip/writer.go.html#5712584">fh</a></span><span class="op" id="5713002">.</span><span class="ident" id="5713003">UncompressedSize64</span><span class="op" id="5713021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5713024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5713028">//&nbsp;Write&nbsp;data&nbsp;descriptor.&nbsp;This&nbsp;is&nbsp;more&nbsp;complicated&nbsp;than&nbsp;one&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5713095">//&nbsp;think,&nbsp;see&nbsp;e.g.&nbsp;comments&nbsp;in&nbsp;zipfile.c:putextended()&nbsp;and</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5713155">//&nbsp;http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=7073588.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5713219">//&nbsp;The&nbsp;approach&nbsp;here&nbsp;is&nbsp;to&nbsp;write&nbsp;8&nbsp;byte&nbsp;sizes&nbsp;if&nbsp;needed&nbsp;without</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5713284">//&nbsp;adding&nbsp;a&nbsp;zip64&nbsp;extra&nbsp;in&nbsp;the&nbsp;local&nbsp;header&nbsp;(too&nbsp;late&nbsp;anyway).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713348">var</span>&nbsp;<span class="ident" id="5713352">buf</span>&nbsp;<span class="op" id="5713356">[</span><span class="op" id="5713357">]</span><span class="builtintype" id="5713358">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713364">if</span>&nbsp;<span class="ident" id="5713367"><a href="/archive/zip/writer.go.html#5712584">fh</a></span><span class="op" id="5713369">.</span><span class="ident" id="5713370">isZip64</span><span class="op" id="5713377">(</span><span class="op" id="5713378">)</span>&nbsp;<span class="op" id="5713380">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713384"><a href="/archive/zip/writer.go.html#5713352">buf</a></span>&nbsp;<span class="op" id="5713388">=</span>&nbsp;<span class="builtinfunc" id="5713390">make</span><span class="op" id="5713394">(</span><span class="op" id="5713395">[</span><span class="op" id="5713396">]</span><span class="builtintype" id="5713397">byte</span><span class="op" id="5713401">,</span>&nbsp;<span class="ident" id="5713403"><a href="/archive/zip/struct.go.html#5697647">dataDescriptor64Len</a></span><span class="op" id="5713422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5713425">}</span>&nbsp;<span class="keyword" id="5713427">else</span>&nbsp;<span class="op" id="5713432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713436"><a href="/archive/zip/writer.go.html#5713352">buf</a></span>&nbsp;<span class="op" id="5713440">=</span>&nbsp;<span class="builtinfunc" id="5713442">make</span><span class="op" id="5713446">(</span><span class="op" id="5713447">[</span><span class="op" id="5713448">]</span><span class="builtintype" id="5713449">byte</span><span class="op" id="5713453">,</span>&nbsp;<span class="ident" id="5713455"><a href="/archive/zip/struct.go.html#5697541">dataDescriptorLen</a></span><span class="op" id="5713472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5713475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713478">b</span>&nbsp;<span class="op" id="5713480">:=</span>&nbsp;<span class="ident" id="5713483"><a href="/archive/zip/writer.go.html#5714063">writeBuf</a></span><span class="op" id="5713491">(</span><span class="ident" id="5713492"><a href="/archive/zip/writer.go.html#5713352">buf</a></span><span class="op" id="5713495">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713498"><a href="/archive/zip/writer.go.html#5713478">b</a></span><span class="op" id="5713499">.</span><span class="builtintype" id="5713500">uint32</span><span class="op" id="5713506">(</span><span class="ident" id="5713507"><a href="/archive/zip/struct.go.html#5697272">dataDescriptorSignature</a></span><span class="op" id="5713530">)</span>&nbsp;<span class="comment" id="5713532">//&nbsp;de-facto&nbsp;standard,&nbsp;required&nbsp;by&nbsp;OS&nbsp;X</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713572"><a href="/archive/zip/writer.go.html#5713478">b</a></span><span class="op" id="5713573">.</span><span class="builtintype" id="5713574">uint32</span><span class="op" id="5713580">(</span><span class="ident" id="5713581"><a href="/archive/zip/writer.go.html#5712584">fh</a></span><span class="op" id="5713583">.</span><span class="ident" id="5713584">CRC32</span><span class="op" id="5713589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713592">if</span>&nbsp;<span class="ident" id="5713595"><a href="/archive/zip/writer.go.html#5712584">fh</a></span><span class="op" id="5713597">.</span><span class="ident" id="5713598">isZip64</span><span class="op" id="5713605">(</span><span class="op" id="5713606">)</span>&nbsp;<span class="op" id="5713608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713612"><a href="/archive/zip/writer.go.html#5713478">b</a></span><span class="op" id="5713613">.</span><span class="ident" id="5713614">uint64</span><span class="op" id="5713620">(</span><span class="ident" id="5713621"><a href="/archive/zip/writer.go.html#5712584">fh</a></span><span class="op" id="5713623">.</span><span class="ident" id="5713624">CompressedSize64</span><span class="op" id="5713640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713644"><a href="/archive/zip/writer.go.html#5713478">b</a></span><span class="op" id="5713645">.</span><span class="ident" id="5713646">uint64</span><span class="op" id="5713652">(</span><span class="ident" id="5713653"><a href="/archive/zip/writer.go.html#5712584">fh</a></span><span class="op" id="5713655">.</span><span class="ident" id="5713656">UncompressedSize64</span><span class="op" id="5713674">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5713677">}</span>&nbsp;<span class="keyword" id="5713679">else</span>&nbsp;<span class="op" id="5713684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713688"><a href="/archive/zip/writer.go.html#5713478">b</a></span><span class="op" id="5713689">.</span><span class="builtintype" id="5713690">uint32</span><span class="op" id="5713696">(</span><span class="ident" id="5713697"><a href="/archive/zip/writer.go.html#5712584">fh</a></span><span class="op" id="5713699">.</span><span class="ident" id="5713700">CompressedSize</span><span class="op" id="5713714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713718"><a href="/archive/zip/writer.go.html#5713478">b</a></span><span class="op" id="5713719">.</span><span class="builtintype" id="5713720">uint32</span><span class="op" id="5713726">(</span><span class="ident" id="5713727"><a href="/archive/zip/writer.go.html#5712584">fh</a></span><span class="op" id="5713729">.</span><span class="ident" id="5713730">UncompressedSize</span><span class="op" id="5713746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5713749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713752">_</span><span class="op" id="5713753">,</span>&nbsp;<span class="ident" id="5713755">err</span>&nbsp;<span class="op" id="5713759">:=</span>&nbsp;<span class="ident" id="5713762"><a href="/archive/zip/writer.go.html#5712392">w</a></span><span class="op" id="5713763">.</span><span class="ident" id="5713764">zipw</span><span class="op" id="5713768">.</span><span class="ident" id="5713769">Write</span><span class="op" id="5713774">(</span><span class="ident" id="5713775"><a href="/archive/zip/writer.go.html#5713352">buf</a></span><span class="op" id="5713778">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713781">return</span>&nbsp;<span class="ident" id="5713788"><a href="/archive/zip/writer.go.html#5713755">err</a></span><br>
<span class="lineno"></span><span class="op" id="5713792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5713795">type</span>&nbsp;<span class="ident" id="5713800">countWriter</span>&nbsp;<span class="keyword" id="5713812">struct</span>&nbsp;<span class="op" id="5713819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713822">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5713828"><a href="/archive/zip/writer.go.html#5705006">io</a></span><span class="op" id="5713830">.</span><span class="ident" id="5713831">Writer</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713839">count</span>&nbsp;<span class="ident" id="5713845">int64</span><br>
<span class="lineno"></span><span class="op" id="5713851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5713854">func</span>&nbsp;<span class="op" id="5713859">(</span><span class="ident" id="5713860">w</span>&nbsp;<span class="op" id="5713862">*</span><span class="ident" id="5713863"><a href="/archive/zip/writer.go.html#5713800">countWriter</a></span><span class="op" id="5713874">)</span>&nbsp;<span class="ident" id="5713876">Write</span><span class="op" id="5713881">(</span><span class="ident" id="5713882">p</span>&nbsp;<span class="op" id="5713884">[</span><span class="op" id="5713885">]</span><span class="builtintype" id="5713886">byte</span><span class="op" id="5713890">)</span>&nbsp;<span class="op" id="5713892">(</span><span class="builtintype" id="5713893">int</span><span class="op" id="5713896">,</span>&nbsp;<span class="builtintype" id="5713898">error</span><span class="op" id="5713903">)</span>&nbsp;<span class="op" id="5713905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713908">n</span><span class="op" id="5713909">,</span>&nbsp;<span class="ident" id="5713911">err</span>&nbsp;<span class="op" id="5713915">:=</span>&nbsp;<span class="ident" id="5713918"><a href="/archive/zip/writer.go.html#5713860">w</a></span><span class="op" id="5713919">.</span><span class="ident" id="5713920">w</span><span class="op" id="5713921">.</span><span class="ident" id="5713922">Write</span><span class="op" id="5713927">(</span><span class="ident" id="5713928"><a href="/archive/zip/writer.go.html#5713882">p</a></span><span class="op" id="5713929">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713932"><a href="/archive/zip/writer.go.html#5713860">w</a></span><span class="op" id="5713933">.</span><span class="ident" id="5713934">count</span>&nbsp;<span class="op" id="5713940">+=</span>&nbsp;<span class="ident" id="5713943">int64</span><span class="op" id="5713948">(</span><span class="ident" id="5713949"><a href="/archive/zip/writer.go.html#5713908">n</a></span><span class="op" id="5713950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713953">return</span>&nbsp;<span class="ident" id="5713960"><a href="/archive/zip/writer.go.html#5713908">n</a></span><span class="op" id="5713961">,</span>&nbsp;<span class="ident" id="5713963"><a href="/archive/zip/writer.go.html#5713911">err</a></span><br>
<span class="lineno"></span><span class="op" id="5713967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5713970">type</span>&nbsp;<span class="ident" id="5713975">nopCloser</span>&nbsp;<span class="keyword" id="5713985">struct</span>&nbsp;<span class="op" id="5713992">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713995"><a href="/archive/zip/writer.go.html#5705006">io</a></span><span class="op" id="5713997">.</span><span class="ident" id="5713998">Writer</span><br>
<span class="lineno"></span><span class="op" id="5714005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5714008">func</span>&nbsp;<span class="op" id="5714013">(</span><span class="ident" id="5714014">w</span>&nbsp;<span class="ident" id="5714016"><a href="/archive/zip/writer.go.html#5713975">nopCloser</a></span><span class="op" id="5714025">)</span>&nbsp;<span class="ident" id="5714027">Close</span><span class="op" id="5714032">(</span><span class="op" id="5714033">)</span>&nbsp;<span class="builtintype" id="5714035">error</span>&nbsp;<span class="op" id="5714041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5714044">return</span>&nbsp;<span class="ident" id="5714051">nil</span><br>
<span class="lineno">340</span><span class="op" id="5714055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5714058">type</span>&nbsp;<span class="ident" id="5714063">writeBuf</span>&nbsp;<span class="op" id="5714072">[</span><span class="op" id="5714073">]</span><span class="builtintype" id="5714074">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5714080">func</span>&nbsp;<span class="op" id="5714085">(</span><span class="ident" id="5714086">b</span>&nbsp;<span class="op" id="5714088">*</span><span class="ident" id="5714089"><a href="/archive/zip/writer.go.html#5714063">writeBuf</a></span><span class="op" id="5714097">)</span>&nbsp;<span class="builtintype" id="5714099">uint16</span><span class="op" id="5714105">(</span><span class="ident" id="5714106">v</span>&nbsp;<span class="builtintype" id="5714108">uint16</span><span class="op" id="5714114">)</span>&nbsp;<span class="op" id="5714116">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5714119"><a href="/archive/zip/writer.go.html#5704955">binary</a></span><span class="op" id="5714125">.</span><span class="ident" id="5714126">LittleEndian</span><span class="op" id="5714138">.</span><span class="ident" id="5714139">PutUint16</span><span class="op" id="5714148">(</span><span class="op" id="5714149">*</span><span class="ident" id="5714150"><a href="/archive/zip/writer.go.html#5714086">b</a></span><span class="op" id="5714151">,</span>&nbsp;<span class="ident" id="5714153"><a href="/archive/zip/writer.go.html#5714106">v</a></span><span class="op" id="5714154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5714157">*</span><span class="ident" id="5714158"><a href="/archive/zip/writer.go.html#5714086">b</a></span>&nbsp;<span class="op" id="5714160">=</span>&nbsp;<span class="op" id="5714162">(</span><span class="op" id="5714163">*</span><span class="ident" id="5714164"><a href="/archive/zip/writer.go.html#5714086">b</a></span><span class="op" id="5714165">)</span><span class="op" id="5714166">[</span><span class="num" id="5714167">2</span><span class="op" id="5714168">:</span><span class="op" id="5714169">]</span><br>
<span class="lineno"></span><span class="op" id="5714171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5714174">func</span>&nbsp;<span class="op" id="5714179">(</span><span class="ident" id="5714180">b</span>&nbsp;<span class="op" id="5714182">*</span><span class="ident" id="5714183"><a href="/archive/zip/writer.go.html#5714063">writeBuf</a></span><span class="op" id="5714191">)</span>&nbsp;<span class="builtintype" id="5714193">uint32</span><span class="op" id="5714199">(</span><span class="ident" id="5714200">v</span>&nbsp;<span class="builtintype" id="5714202">uint32</span><span class="op" id="5714208">)</span>&nbsp;<span class="op" id="5714210">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5714213"><a href="/archive/zip/writer.go.html#5704955">binary</a></span><span class="op" id="5714219">.</span><span class="ident" id="5714220">LittleEndian</span><span class="op" id="5714232">.</span><span class="ident" id="5714233">PutUint32</span><span class="op" id="5714242">(</span><span class="op" id="5714243">*</span><span class="ident" id="5714244"><a href="/archive/zip/writer.go.html#5714180">b</a></span><span class="op" id="5714245">,</span>&nbsp;<span class="ident" id="5714247"><a href="/archive/zip/writer.go.html#5714200">v</a></span><span class="op" id="5714248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5714251">*</span><span class="ident" id="5714252"><a href="/archive/zip/writer.go.html#5714180">b</a></span>&nbsp;<span class="op" id="5714254">=</span>&nbsp;<span class="op" id="5714256">(</span><span class="op" id="5714257">*</span><span class="ident" id="5714258"><a href="/archive/zip/writer.go.html#5714180">b</a></span><span class="op" id="5714259">)</span><span class="op" id="5714260">[</span><span class="num" id="5714261">4</span><span class="op" id="5714262">:</span><span class="op" id="5714263">]</span><br>
<span class="lineno"></span><span class="op" id="5714265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5714268">func</span>&nbsp;<span class="op" id="5714273">(</span><span class="ident" id="5714274">b</span>&nbsp;<span class="op" id="5714276">*</span><span class="ident" id="5714277"><a href="/archive/zip/writer.go.html#5714063">writeBuf</a></span><span class="op" id="5714285">)</span>&nbsp;<span class="ident" id="5714287">uint64</span><span class="op" id="5714293">(</span><span class="ident" id="5714294">v</span>&nbsp;<span class="ident" id="5714296">uint64</span><span class="op" id="5714302">)</span>&nbsp;<span class="op" id="5714304">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5714307"><a href="/archive/zip/writer.go.html#5704955">binary</a></span><span class="op" id="5714313">.</span><span class="ident" id="5714314">LittleEndian</span><span class="op" id="5714326">.</span><span class="ident" id="5714327">PutUint64</span><span class="op" id="5714336">(</span><span class="op" id="5714337">*</span><span class="ident" id="5714338"><a href="/archive/zip/writer.go.html#5714274">b</a></span><span class="op" id="5714339">,</span>&nbsp;<span class="ident" id="5714341"><a href="/archive/zip/writer.go.html#5714294">v</a></span><span class="op" id="5714342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5714345">*</span><span class="ident" id="5714346"><a href="/archive/zip/writer.go.html#5714274">b</a></span>&nbsp;<span class="op" id="5714348">=</span>&nbsp;<span class="op" id="5714350">(</span><span class="op" id="5714351">*</span><span class="ident" id="5714352"><a href="/archive/zip/writer.go.html#5714274">b</a></span><span class="op" id="5714353">)</span><span class="op" id="5714354">[</span><span class="num" id="5714355">8</span><span class="op" id="5714356">:</span><span class="op" id="5714357">]</span><br>
<span class="lineno"></span><span class="op" id="5714359">}</span>
</div>
</body>
</html>
