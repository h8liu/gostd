<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime/pprof</h2>
<ul>
<li><a href="/gostd/runtime/pprof/mprof_test.go.html">mprof_test.go</a></li>
<li><a href="/gostd/runtime/pprof/pprof.go.html" class="current">pprof.go</a></li>
<li><a href="/gostd/runtime/pprof/pprof_test.go.html">pprof_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5489733">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5489789">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5489843">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5489894">//&nbsp;Package&nbsp;pprof&nbsp;writes&nbsp;runtime&nbsp;profiling&nbsp;data&nbsp;in&nbsp;the&nbsp;format&nbsp;expected</span><br>
<span class="lineno"></span><span class="comment" id="5489964">//&nbsp;by&nbsp;the&nbsp;pprof&nbsp;visualization&nbsp;tool.</span><br>
<span class="lineno"></span><span class="comment" id="5490000">//&nbsp;For&nbsp;more&nbsp;information&nbsp;about&nbsp;pprof,&nbsp;see</span><br>
<span class="lineno"></span><span class="comment" id="5490041">//&nbsp;http://code.google.com/p/google-perftools/.</span><br>
<span class="lineno"></span><span class="keyword" id="5490088">package</span>&nbsp;<span class="ident" id="5490096">pprof</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="5490103">import</span>&nbsp;<span class="op" id="5490110">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5490113">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5490122">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5490131">&#34;fmt&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5490138">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5490144">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5490155">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5490163">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5490174">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5490182">&#34;text/tabwriter&#34;</span><br>
<span class="lineno"></span><span class="op" id="5490199">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5490202">//&nbsp;BUG(rsc):&nbsp;Profiles&nbsp;are&nbsp;incomplete&nbsp;and&nbsp;inaccurate&nbsp;on&nbsp;NetBSD&nbsp;and&nbsp;OS&nbsp;X.</span><br>
<span class="lineno"></span><span class="comment" id="5490274">//&nbsp;See&nbsp;http://golang.org/issue/6047&nbsp;for&nbsp;details.</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="5490324">//&nbsp;A&nbsp;Profile&nbsp;is&nbsp;a&nbsp;collection&nbsp;of&nbsp;stack&nbsp;traces&nbsp;showing&nbsp;the&nbsp;call&nbsp;sequences</span><br>
<span class="lineno"></span><span class="comment" id="5490396">//&nbsp;that&nbsp;led&nbsp;to&nbsp;instances&nbsp;of&nbsp;a&nbsp;particular&nbsp;event,&nbsp;such&nbsp;as&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="comment" id="5490464">//&nbsp;Packages&nbsp;can&nbsp;create&nbsp;and&nbsp;maintain&nbsp;their&nbsp;own&nbsp;profiles;&nbsp;the&nbsp;most&nbsp;common</span><br>
<span class="lineno"></span><span class="comment" id="5490536">//&nbsp;use&nbsp;is&nbsp;for&nbsp;tracking&nbsp;resources&nbsp;that&nbsp;must&nbsp;be&nbsp;explicitly&nbsp;closed,&nbsp;such&nbsp;as&nbsp;files</span><br>
<span class="lineno">30</span><span class="comment" id="5490615">//&nbsp;or&nbsp;network&nbsp;connections.</span><br>
<span class="lineno"></span><span class="comment" id="5490642">//</span><br>
<span class="lineno"></span><span class="comment" id="5490645">//&nbsp;A&nbsp;Profile&#39;s&nbsp;methods&nbsp;can&nbsp;be&nbsp;called&nbsp;from&nbsp;multiple&nbsp;goroutines&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="comment" id="5490723">//</span><br>
<span class="lineno"></span><span class="comment" id="5490726">//&nbsp;Each&nbsp;Profile&nbsp;has&nbsp;a&nbsp;unique&nbsp;name.&nbsp;&nbsp;A&nbsp;few&nbsp;profiles&nbsp;are&nbsp;predefined:</span><br>
<span class="lineno">35</span><span class="comment" id="5490793">//</span><br>
<span class="lineno"></span><span class="comment" id="5490796">//&nbsp;&nbsp;&nbsp;&nbsp;goroutine&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;stack&nbsp;traces&nbsp;of&nbsp;all&nbsp;current&nbsp;goroutines</span><br>
<span class="lineno"></span><span class="comment" id="5490853">//&nbsp;&nbsp;&nbsp;&nbsp;heap&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;sampling&nbsp;of&nbsp;all&nbsp;heap&nbsp;allocations</span><br>
<span class="lineno"></span><span class="comment" id="5490906">//&nbsp;&nbsp;&nbsp;&nbsp;threadcreate&nbsp;-&nbsp;stack&nbsp;traces&nbsp;that&nbsp;led&nbsp;to&nbsp;the&nbsp;creation&nbsp;of&nbsp;new&nbsp;OS&nbsp;threads</span><br>
<span class="lineno"></span><span class="comment" id="5490980">//&nbsp;&nbsp;&nbsp;&nbsp;block&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;stack&nbsp;traces&nbsp;that&nbsp;led&nbsp;to&nbsp;blocking&nbsp;on&nbsp;synchronization&nbsp;primitives</span><br>
<span class="lineno">40</span><span class="comment" id="5491062">//</span><br>
<span class="lineno"></span><span class="comment" id="5491065">//&nbsp;These&nbsp;predefined&nbsp;profiles&nbsp;maintain&nbsp;themselves&nbsp;and&nbsp;panic&nbsp;on&nbsp;an&nbsp;explicit</span><br>
<span class="lineno"></span><span class="comment" id="5491139">//&nbsp;Add&nbsp;or&nbsp;Remove&nbsp;method&nbsp;call.</span><br>
<span class="lineno"></span><span class="comment" id="5491169">//</span><br>
<span class="lineno"></span><span class="comment" id="5491172">//&nbsp;The&nbsp;CPU&nbsp;profile&nbsp;is&nbsp;not&nbsp;available&nbsp;as&nbsp;a&nbsp;Profile.&nbsp;&nbsp;It&nbsp;has&nbsp;a&nbsp;special&nbsp;API,</span><br>
<span class="lineno">45</span><span class="comment" id="5491245">//&nbsp;the&nbsp;StartCPUProfile&nbsp;and&nbsp;StopCPUProfile&nbsp;functions,&nbsp;because&nbsp;it&nbsp;streams</span><br>
<span class="lineno"></span><span class="comment" id="5491317">//&nbsp;output&nbsp;to&nbsp;a&nbsp;writer&nbsp;during&nbsp;profiling.</span><br>
<span class="lineno"></span><span class="comment" id="5491357">//</span><br>
<span class="lineno"></span><span class="keyword" id="5491360">type</span>&nbsp;<span class="ident" id="5491365">Profile</span>&nbsp;<span class="keyword" id="5491373">struct</span>&nbsp;<span class="op" id="5491380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5491383">name</span>&nbsp;&nbsp;<span class="builtintype" id="5491389">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5491397">mu</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5491403"><a href="/gostd/runtime/pprof/pprof.go.html#5490174">sync</a></span><span class="op" id="5491407">.</span><span class="ident" id="5491408"><a href="/gostd/sync/mutex.go.html#1443974">Mutex</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5491415">m</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5491421">map</span><span class="op" id="5491424">[</span><span class="keyword" id="5491425">interface</span><span class="op" id="5491434">{</span><span class="op" id="5491435">}</span><span class="op" id="5491436">]</span><span class="op" id="5491437">[</span><span class="op" id="5491438">]</span><span class="builtintype" id="5491439">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5491448">count</span>&nbsp;<span class="keyword" id="5491454">func</span><span class="op" id="5491458">(</span><span class="op" id="5491459">)</span>&nbsp;<span class="builtintype" id="5491461">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5491466">write</span>&nbsp;<span class="keyword" id="5491472">func</span><span class="op" id="5491476">(</span><span class="ident" id="5491477"><a href="/gostd/runtime/pprof/pprof.go.html#5490138">io</a></span><span class="op" id="5491479">.</span><span class="ident" id="5491480"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="5491486">,</span>&nbsp;<span class="builtintype" id="5491488">int</span><span class="op" id="5491491">)</span>&nbsp;<span class="builtintype" id="5491493">error</span><br>
<span class="lineno"></span><span class="op" id="5491499">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="5491502">//&nbsp;profiles&nbsp;records&nbsp;all&nbsp;registered&nbsp;profiles.</span><br>
<span class="lineno"></span><span class="keyword" id="5491547">var</span>&nbsp;<span class="ident" id="5491551">profiles</span>&nbsp;<span class="keyword" id="5491560">struct</span>&nbsp;<span class="op" id="5491567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5491570">mu</span>&nbsp;<span class="ident" id="5491573"><a href="/gostd/runtime/pprof/pprof.go.html#5490174">sync</a></span><span class="op" id="5491577">.</span><span class="ident" id="5491578"><a href="/gostd/sync/mutex.go.html#1443974">Mutex</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5491585">m</span>&nbsp;&nbsp;<span class="keyword" id="5491588">map</span><span class="op" id="5491591">[</span><span class="builtintype" id="5491592">string</span><span class="op" id="5491598">]</span><span class="op" id="5491599">*</span><span class="ident" id="5491600"><a href="/gostd/runtime/pprof/pprof.go.html#5491365">Profile</a></span><br>
<span class="lineno">60</span><span class="op" id="5491608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5491611">var</span>&nbsp;<span class="ident" id="5491615">goroutineProfile</span>&nbsp;<span class="op" id="5491632">=</span>&nbsp;<span class="op" id="5491634">&amp;</span><span class="ident" id="5491635"><a href="/gostd/runtime/pprof/pprof.go.html#5491365">Profile</a></span><span class="op" id="5491642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5491645"><a href="/gostd/runtime/pprof/pprof.go.html#5491383">name</a></span><span class="op" id="5491649">:</span>&nbsp;&nbsp;<span class="string" id="5491652">&#34;goroutine&#34;</span><span class="op" id="5491663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5491666"><a href="/gostd/runtime/pprof/pprof.go.html#5491448">count</a></span><span class="op" id="5491671">:</span>&nbsp;<span class="ident" id="5491673"><a href="/gostd/runtime/pprof/pprof.go.html#5503707">countGoroutine</a></span><span class="op" id="5491687">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5491690"><a href="/gostd/runtime/pprof/pprof.go.html#5491466">write</a></span><span class="op" id="5491695">:</span>&nbsp;<span class="ident" id="5491697"><a href="/gostd/runtime/pprof/pprof.go.html#5503837">writeGoroutine</a></span><span class="op" id="5491711">,</span><br>
<span class="lineno"></span><span class="op" id="5491713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5491716">var</span>&nbsp;<span class="ident" id="5491720">threadcreateProfile</span>&nbsp;<span class="op" id="5491740">=</span>&nbsp;<span class="op" id="5491742">&amp;</span><span class="ident" id="5491743"><a href="/gostd/runtime/pprof/pprof.go.html#5491365">Profile</a></span><span class="op" id="5491750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5491753"><a href="/gostd/runtime/pprof/pprof.go.html#5491383">name</a></span><span class="op" id="5491757">:</span>&nbsp;&nbsp;<span class="string" id="5491760">&#34;threadcreate&#34;</span><span class="op" id="5491774">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5491777"><a href="/gostd/runtime/pprof/pprof.go.html#5491448">count</a></span><span class="op" id="5491782">:</span>&nbsp;<span class="ident" id="5491784"><a href="/gostd/runtime/pprof/pprof.go.html#5503354">countThreadCreate</a></span><span class="op" id="5491801">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5491804"><a href="/gostd/runtime/pprof/pprof.go.html#5491466">write</a></span><span class="op" id="5491809">:</span>&nbsp;<span class="ident" id="5491811"><a href="/gostd/runtime/pprof/pprof.go.html#5503514">writeThreadCreate</a></span><span class="op" id="5491828">,</span><br>
<span class="lineno"></span><span class="op" id="5491830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5491833">var</span>&nbsp;<span class="ident" id="5491837">heapProfile</span>&nbsp;<span class="op" id="5491849">=</span>&nbsp;<span class="op" id="5491851">&amp;</span><span class="ident" id="5491852"><a href="/gostd/runtime/pprof/pprof.go.html#5491365">Profile</a></span><span class="op" id="5491859">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5491862"><a href="/gostd/runtime/pprof/pprof.go.html#5491383">name</a></span><span class="op" id="5491866">:</span>&nbsp;&nbsp;<span class="string" id="5491869">&#34;heap&#34;</span><span class="op" id="5491875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5491878"><a href="/gostd/runtime/pprof/pprof.go.html#5491448">count</a></span><span class="op" id="5491883">:</span>&nbsp;<span class="ident" id="5491885"><a href="/gostd/runtime/pprof/pprof.go.html#5500004">countHeap</a></span><span class="op" id="5491894">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5491897"><a href="/gostd/runtime/pprof/pprof.go.html#5491466">write</a></span><span class="op" id="5491902">:</span>&nbsp;<span class="ident" id="5491904"><a href="/gostd/runtime/pprof/pprof.go.html#5500138">writeHeap</a></span><span class="op" id="5491913">,</span><br>
<span class="lineno"></span><span class="op" id="5491915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="5491918">var</span>&nbsp;<span class="ident" id="5491922">blockProfile</span>&nbsp;<span class="op" id="5491935">=</span>&nbsp;<span class="op" id="5491937">&amp;</span><span class="ident" id="5491938"><a href="/gostd/runtime/pprof/pprof.go.html#5491365">Profile</a></span><span class="op" id="5491945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5491948"><a href="/gostd/runtime/pprof/pprof.go.html#5491383">name</a></span><span class="op" id="5491952">:</span>&nbsp;&nbsp;<span class="string" id="5491955">&#34;block&#34;</span><span class="op" id="5491962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5491965"><a href="/gostd/runtime/pprof/pprof.go.html#5491448">count</a></span><span class="op" id="5491970">:</span>&nbsp;<span class="ident" id="5491972"><a href="/gostd/runtime/pprof/pprof.go.html#5507452">countBlock</a></span><span class="op" id="5491982">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5491985"><a href="/gostd/runtime/pprof/pprof.go.html#5491466">write</a></span><span class="op" id="5491990">:</span>&nbsp;<span class="ident" id="5491992"><a href="/gostd/runtime/pprof/pprof.go.html#5507580">writeBlock</a></span><span class="op" id="5492002">,</span><br>
<span class="lineno"></span><span class="op" id="5492004">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="5492007">func</span>&nbsp;<span class="ident" id="5492012">lockProfiles</span><span class="op" id="5492024">(</span><span class="op" id="5492025">)</span>&nbsp;<span class="op" id="5492027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5492030"><a href="/gostd/runtime/pprof/pprof.go.html#5491551">profiles</a></span><span class="op" id="5492038">.</span><span class="ident" id="5492039"><a href="/gostd/runtime/pprof/pprof.go.html#5491570">mu</a></span><span class="op" id="5492041">.</span><span class="ident" id="5492042"><a href="/gostd/sync/mutex.go.html#1444351">Lock</a></span><span class="op" id="5492046">(</span><span class="op" id="5492047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5492050">if</span>&nbsp;<span class="ident" id="5492053"><a href="/gostd/runtime/pprof/pprof.go.html#5491551">profiles</a></span><span class="op" id="5492061">.</span><span class="ident" id="5492062"><a href="/gostd/runtime/pprof/pprof.go.html#5491585">m</a></span>&nbsp;<span class="op" id="5492064">==</span>&nbsp;<span class="builtintype" id="5492067">nil</span>&nbsp;<span class="op" id="5492071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5492075">//&nbsp;Initial&nbsp;built-in&nbsp;profiles.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5492107"><a href="/gostd/runtime/pprof/pprof.go.html#5491551">profiles</a></span><span class="op" id="5492115">.</span><span class="ident" id="5492116"><a href="/gostd/runtime/pprof/pprof.go.html#5491585">m</a></span>&nbsp;<span class="op" id="5492118">=</span>&nbsp;<span class="keyword" id="5492120">map</span><span class="op" id="5492123">[</span><span class="builtintype" id="5492124">string</span><span class="op" id="5492130">]</span><span class="op" id="5492131">*</span><span class="ident" id="5492132"><a href="/gostd/runtime/pprof/pprof.go.html#5491365">Profile</a></span><span class="op" id="5492139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5492144">&#34;goroutine&#34;</span><span class="op" id="5492155">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5492160"><a href="/gostd/runtime/pprof/pprof.go.html#5491615">goroutineProfile</a></span><span class="op" id="5492176">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5492181">&#34;threadcreate&#34;</span><span class="op" id="5492195">:</span>&nbsp;<span class="ident" id="5492197"><a href="/gostd/runtime/pprof/pprof.go.html#5491720">threadcreateProfile</a></span><span class="op" id="5492216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5492221">&#34;heap&#34;</span><span class="op" id="5492227">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5492237"><a href="/gostd/runtime/pprof/pprof.go.html#5491837">heapProfile</a></span><span class="op" id="5492248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5492253">&#34;block&#34;</span><span class="op" id="5492260">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5492269"><a href="/gostd/runtime/pprof/pprof.go.html#5491922">blockProfile</a></span><span class="op" id="5492281">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5492285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5492288">}</span><br>
<span class="lineno"></span><span class="op" id="5492290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5492293">func</span>&nbsp;<span class="ident" id="5492298">unlockProfiles</span><span class="op" id="5492312">(</span><span class="op" id="5492313">)</span>&nbsp;<span class="op" id="5492315">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5492318"><a href="/gostd/runtime/pprof/pprof.go.html#5491551">profiles</a></span><span class="op" id="5492326">.</span><span class="ident" id="5492327"><a href="/gostd/runtime/pprof/pprof.go.html#5491570">mu</a></span><span class="op" id="5492329">.</span><span class="ident" id="5492330"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="5492336">(</span><span class="op" id="5492337">)</span><br>
<span class="lineno"></span><span class="op" id="5492339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5492342">//&nbsp;NewProfile&nbsp;creates&nbsp;a&nbsp;new&nbsp;profile&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="5492399">//&nbsp;If&nbsp;a&nbsp;profile&nbsp;with&nbsp;that&nbsp;name&nbsp;already&nbsp;exists,&nbsp;NewProfile&nbsp;panics.</span><br>
<span class="lineno">105</span><span class="comment" id="5492465">//&nbsp;The&nbsp;convention&nbsp;is&nbsp;to&nbsp;use&nbsp;a&nbsp;&#39;import/path.&#39;&nbsp;prefix&nbsp;to&nbsp;create</span><br>
<span class="lineno"></span><span class="comment" id="5492527">//&nbsp;separate&nbsp;name&nbsp;spaces&nbsp;for&nbsp;each&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="5492569">func</span>&nbsp;<span class="ident" id="5492574">NewProfile</span><span class="op" id="5492584">(</span><span class="ident" id="5492585">name</span>&nbsp;<span class="builtintype" id="5492590">string</span><span class="op" id="5492596">)</span>&nbsp;<span class="op" id="5492598">*</span><span class="ident" id="5492599"><a href="/gostd/runtime/pprof/pprof.go.html#5491365">Profile</a></span>&nbsp;<span class="op" id="5492607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5492610"><a href="/gostd/runtime/pprof/pprof.go.html#5492012">lockProfiles</a></span><span class="op" id="5492622">(</span><span class="op" id="5492623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5492626">defer</span>&nbsp;<span class="ident" id="5492632"><a href="/gostd/runtime/pprof/pprof.go.html#5492298">unlockProfiles</a></span><span class="op" id="5492646">(</span><span class="op" id="5492647">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5492650">if</span>&nbsp;<span class="ident" id="5492653"><a href="/gostd/runtime/pprof/pprof.go.html#5492585">name</a></span>&nbsp;<span class="op" id="5492658">==</span>&nbsp;<span class="string" id="5492661">&#34;&#34;</span>&nbsp;<span class="op" id="5492664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5492668">panic</span><span class="op" id="5492673">(</span><span class="string" id="5492674">&#34;pprof:&nbsp;NewProfile&nbsp;with&nbsp;empty&nbsp;name&#34;</span><span class="op" id="5492709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5492712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5492715">if</span>&nbsp;<span class="ident" id="5492718"><a href="/gostd/runtime/pprof/pprof.go.html#5491551">profiles</a></span><span class="op" id="5492726">.</span><span class="ident" id="5492727"><a href="/gostd/runtime/pprof/pprof.go.html#5491585">m</a></span><span class="op" id="5492728">[</span><span class="ident" id="5492729"><a href="/gostd/runtime/pprof/pprof.go.html#5492585">name</a></span><span class="op" id="5492733">]</span>&nbsp;<span class="op" id="5492735">!=</span>&nbsp;<span class="builtintype" id="5492738">nil</span>&nbsp;<span class="op" id="5492742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5492746">panic</span><span class="op" id="5492751">(</span><span class="string" id="5492752">&#34;pprof:&nbsp;NewProfile&nbsp;name&nbsp;already&nbsp;in&nbsp;use:&nbsp;&#34;</span>&nbsp;<span class="op" id="5492794">+</span>&nbsp;<span class="ident" id="5492796"><a href="/gostd/runtime/pprof/pprof.go.html#5492585">name</a></span><span class="op" id="5492800">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5492803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5492806">p</span>&nbsp;<span class="op" id="5492808">:=</span>&nbsp;<span class="op" id="5492811">&amp;</span><span class="ident" id="5492812"><a href="/gostd/runtime/pprof/pprof.go.html#5491365">Profile</a></span><span class="op" id="5492819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5492823"><a href="/gostd/runtime/pprof/pprof.go.html#5491383">name</a></span><span class="op" id="5492827">:</span>&nbsp;<span class="ident" id="5492829"><a href="/gostd/runtime/pprof/pprof.go.html#5492585">name</a></span><span class="op" id="5492833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5492837"><a href="/gostd/runtime/pprof/pprof.go.html#5491415">m</a></span><span class="op" id="5492838">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5492843">map</span><span class="op" id="5492846">[</span><span class="keyword" id="5492847">interface</span><span class="op" id="5492856">{</span><span class="op" id="5492857">}</span><span class="op" id="5492858">]</span><span class="op" id="5492859">[</span><span class="op" id="5492860">]</span><span class="builtintype" id="5492861">uintptr</span><span class="op" id="5492868">{</span><span class="op" id="5492869">}</span><span class="op" id="5492870">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5492873">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5492876"><a href="/gostd/runtime/pprof/pprof.go.html#5491551">profiles</a></span><span class="op" id="5492884">.</span><span class="ident" id="5492885"><a href="/gostd/runtime/pprof/pprof.go.html#5491585">m</a></span><span class="op" id="5492886">[</span><span class="ident" id="5492887"><a href="/gostd/runtime/pprof/pprof.go.html#5492585">name</a></span><span class="op" id="5492891">]</span>&nbsp;<span class="op" id="5492893">=</span>&nbsp;<span class="ident" id="5492895"><a href="/gostd/runtime/pprof/pprof.go.html#5492806">p</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5492898">return</span>&nbsp;<span class="ident" id="5492905"><a href="/gostd/runtime/pprof/pprof.go.html#5492806">p</a></span><br>
<span class="lineno"></span><span class="op" id="5492907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5492910">//&nbsp;Lookup&nbsp;returns&nbsp;the&nbsp;profile&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such&nbsp;profile&nbsp;exists.</span><br>
<span class="lineno">125</span><span class="keyword" id="5492995">func</span>&nbsp;<span class="ident" id="5493000">Lookup</span><span class="op" id="5493006">(</span><span class="ident" id="5493007">name</span>&nbsp;<span class="builtintype" id="5493012">string</span><span class="op" id="5493018">)</span>&nbsp;<span class="op" id="5493020">*</span><span class="ident" id="5493021"><a href="/gostd/runtime/pprof/pprof.go.html#5491365">Profile</a></span>&nbsp;<span class="op" id="5493029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5493032"><a href="/gostd/runtime/pprof/pprof.go.html#5492012">lockProfiles</a></span><span class="op" id="5493044">(</span><span class="op" id="5493045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5493048">defer</span>&nbsp;<span class="ident" id="5493054"><a href="/gostd/runtime/pprof/pprof.go.html#5492298">unlockProfiles</a></span><span class="op" id="5493068">(</span><span class="op" id="5493069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5493072">return</span>&nbsp;<span class="ident" id="5493079"><a href="/gostd/runtime/pprof/pprof.go.html#5491551">profiles</a></span><span class="op" id="5493087">.</span><span class="ident" id="5493088"><a href="/gostd/runtime/pprof/pprof.go.html#5491585">m</a></span><span class="op" id="5493089">[</span><span class="ident" id="5493090"><a href="/gostd/runtime/pprof/pprof.go.html#5493007">name</a></span><span class="op" id="5493094">]</span><br>
<span class="lineno"></span><span class="op" id="5493096">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="5493099">//&nbsp;Profiles&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;the&nbsp;known&nbsp;profiles,&nbsp;sorted&nbsp;by&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="5493170">func</span>&nbsp;<span class="ident" id="5493175">Profiles</span><span class="op" id="5493183">(</span><span class="op" id="5493184">)</span>&nbsp;<span class="op" id="5493186">[</span><span class="op" id="5493187">]</span><span class="op" id="5493188">*</span><span class="ident" id="5493189"><a href="/gostd/runtime/pprof/pprof.go.html#5491365">Profile</a></span>&nbsp;<span class="op" id="5493197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5493200"><a href="/gostd/runtime/pprof/pprof.go.html#5492012">lockProfiles</a></span><span class="op" id="5493212">(</span><span class="op" id="5493213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5493216">defer</span>&nbsp;<span class="ident" id="5493222"><a href="/gostd/runtime/pprof/pprof.go.html#5492298">unlockProfiles</a></span><span class="op" id="5493236">(</span><span class="op" id="5493237">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5493241">var</span>&nbsp;<span class="ident" id="5493245">all</span>&nbsp;<span class="op" id="5493249">[</span><span class="op" id="5493250">]</span><span class="op" id="5493251">*</span><span class="ident" id="5493252"><a href="/gostd/runtime/pprof/pprof.go.html#5491365">Profile</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5493261">for</span>&nbsp;<span class="ident" id="5493265">_</span><span class="op" id="5493266">,</span>&nbsp;<span class="ident" id="5493268">p</span>&nbsp;<span class="op" id="5493270">:=</span>&nbsp;<span class="keyword" id="5493273">range</span>&nbsp;<span class="ident" id="5493279"><a href="/gostd/runtime/pprof/pprof.go.html#5491551">profiles</a></span><span class="op" id="5493287">.</span><span class="ident" id="5493288"><a href="/gostd/runtime/pprof/pprof.go.html#5491585">m</a></span>&nbsp;<span class="op" id="5493290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5493294"><a href="/gostd/runtime/pprof/pprof.go.html#5493245">all</a></span>&nbsp;<span class="op" id="5493298">=</span>&nbsp;<span class="builtinfunc" id="5493300">append</span><span class="op" id="5493306">(</span><span class="ident" id="5493307"><a href="/gostd/runtime/pprof/pprof.go.html#5493245">all</a></span><span class="op" id="5493310">,</span>&nbsp;<span class="ident" id="5493312"><a href="/gostd/runtime/pprof/pprof.go.html#5493268">p</a></span><span class="op" id="5493313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5493316">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5493320"><a href="/gostd/runtime/pprof/pprof.go.html#5490155">sort</a></span><span class="op" id="5493324">.</span><span class="ident" id="5493325"><a href="/gostd/sort/sort.go.html#2015380">Sort</a></span><span class="op" id="5493329">(</span><span class="ident" id="5493330"><a href="/gostd/runtime/pprof/pprof.go.html#5493363">byName</a></span><span class="op" id="5493336">(</span><span class="ident" id="5493337"><a href="/gostd/runtime/pprof/pprof.go.html#5493245">all</a></span><span class="op" id="5493340">)</span><span class="op" id="5493341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5493344">return</span>&nbsp;<span class="ident" id="5493351"><a href="/gostd/runtime/pprof/pprof.go.html#5493245">all</a></span><br>
<span class="lineno"></span><span class="op" id="5493355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="keyword" id="5493358">type</span>&nbsp;<span class="ident" id="5493363">byName</span>&nbsp;<span class="op" id="5493370">[</span><span class="op" id="5493371">]</span><span class="op" id="5493372">*</span><span class="ident" id="5493373"><a href="/gostd/runtime/pprof/pprof.go.html#5491365">Profile</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5493382">func</span>&nbsp;<span class="op" id="5493387">(</span><span class="ident" id="5493388">x</span>&nbsp;<span class="ident" id="5493390"><a href="/gostd/runtime/pprof/pprof.go.html#5493363">byName</a></span><span class="op" id="5493396">)</span>&nbsp;<span class="ident" id="5493398">Len</span><span class="op" id="5493401">(</span><span class="op" id="5493402">)</span>&nbsp;<span class="builtintype" id="5493404">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5493418">{</span>&nbsp;<span class="keyword" id="5493420">return</span>&nbsp;<span class="builtinfunc" id="5493427">len</span><span class="op" id="5493430">(</span><span class="ident" id="5493431"><a href="/gostd/runtime/pprof/pprof.go.html#5493388">x</a></span><span class="op" id="5493432">)</span>&nbsp;<span class="op" id="5493434">}</span><br>
<span class="lineno"></span><span class="keyword" id="5493436">func</span>&nbsp;<span class="op" id="5493441">(</span><span class="ident" id="5493442">x</span>&nbsp;<span class="ident" id="5493444"><a href="/gostd/runtime/pprof/pprof.go.html#5493363">byName</a></span><span class="op" id="5493450">)</span>&nbsp;<span class="ident" id="5493452">Swap</span><span class="op" id="5493456">(</span><span class="ident" id="5493457">i</span><span class="op" id="5493458">,</span>&nbsp;<span class="ident" id="5493460">j</span>&nbsp;<span class="builtintype" id="5493462">int</span><span class="op" id="5493465">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5493472">{</span>&nbsp;<span class="ident" id="5493474"><a href="/gostd/runtime/pprof/pprof.go.html#5493442">x</a></span><span class="op" id="5493475">[</span><span class="ident" id="5493476"><a href="/gostd/runtime/pprof/pprof.go.html#5493457">i</a></span><span class="op" id="5493477">]</span><span class="op" id="5493478">,</span>&nbsp;<span class="ident" id="5493480"><a href="/gostd/runtime/pprof/pprof.go.html#5493442">x</a></span><span class="op" id="5493481">[</span><span class="ident" id="5493482"><a href="/gostd/runtime/pprof/pprof.go.html#5493460">j</a></span><span class="op" id="5493483">]</span>&nbsp;<span class="op" id="5493485">=</span>&nbsp;<span class="ident" id="5493487"><a href="/gostd/runtime/pprof/pprof.go.html#5493442">x</a></span><span class="op" id="5493488">[</span><span class="ident" id="5493489"><a href="/gostd/runtime/pprof/pprof.go.html#5493460">j</a></span><span class="op" id="5493490">]</span><span class="op" id="5493491">,</span>&nbsp;<span class="ident" id="5493493"><a href="/gostd/runtime/pprof/pprof.go.html#5493442">x</a></span><span class="op" id="5493494">[</span><span class="ident" id="5493495"><a href="/gostd/runtime/pprof/pprof.go.html#5493457">i</a></span><span class="op" id="5493496">]</span>&nbsp;<span class="op" id="5493498">}</span><br>
<span class="lineno"></span><span class="keyword" id="5493500">func</span>&nbsp;<span class="op" id="5493505">(</span><span class="ident" id="5493506">x</span>&nbsp;<span class="ident" id="5493508"><a href="/gostd/runtime/pprof/pprof.go.html#5493363">byName</a></span><span class="op" id="5493514">)</span>&nbsp;<span class="ident" id="5493516">Less</span><span class="op" id="5493520">(</span><span class="ident" id="5493521">i</span><span class="op" id="5493522">,</span>&nbsp;<span class="ident" id="5493524">j</span>&nbsp;<span class="builtintype" id="5493526">int</span><span class="op" id="5493529">)</span>&nbsp;<span class="builtintype" id="5493531">bool</span>&nbsp;<span class="op" id="5493536">{</span>&nbsp;<span class="keyword" id="5493538">return</span>&nbsp;<span class="ident" id="5493545"><a href="/gostd/runtime/pprof/pprof.go.html#5493506">x</a></span><span class="op" id="5493546">[</span><span class="ident" id="5493547"><a href="/gostd/runtime/pprof/pprof.go.html#5493521">i</a></span><span class="op" id="5493548">]</span><span class="op" id="5493549">.</span><span class="ident" id="5493550"><a href="/gostd/runtime/pprof/pprof.go.html#5491383">name</a></span>&nbsp;<span class="op" id="5493555">&lt;</span>&nbsp;<span class="ident" id="5493557"><a href="/gostd/runtime/pprof/pprof.go.html#5493506">x</a></span><span class="op" id="5493558">[</span><span class="ident" id="5493559"><a href="/gostd/runtime/pprof/pprof.go.html#5493524">j</a></span><span class="op" id="5493560">]</span><span class="op" id="5493561">.</span><span class="ident" id="5493562"><a href="/gostd/runtime/pprof/pprof.go.html#5491383">name</a></span>&nbsp;<span class="op" id="5493567">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="comment" id="5493570">//&nbsp;Name&nbsp;returns&nbsp;this&nbsp;profile&#39;s&nbsp;name,&nbsp;which&nbsp;can&nbsp;be&nbsp;passed&nbsp;to&nbsp;Lookup&nbsp;to&nbsp;reobtain&nbsp;the&nbsp;profile.</span><br>
<span class="lineno"></span><span class="keyword" id="5493662">func</span>&nbsp;<span class="op" id="5493667">(</span><span class="ident" id="5493668">p</span>&nbsp;<span class="op" id="5493670">*</span><span class="ident" id="5493671"><a href="/gostd/runtime/pprof/pprof.go.html#5491365">Profile</a></span><span class="op" id="5493678">)</span>&nbsp;<span class="ident" id="5493680">Name</span><span class="op" id="5493684">(</span><span class="op" id="5493685">)</span>&nbsp;<span class="builtintype" id="5493687">string</span>&nbsp;<span class="op" id="5493694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5493697">return</span>&nbsp;<span class="ident" id="5493704"><a href="/gostd/runtime/pprof/pprof.go.html#5493668">p</a></span><span class="op" id="5493705">.</span><span class="ident" id="5493706"><a href="/gostd/runtime/pprof/pprof.go.html#5491383">name</a></span><br>
<span class="lineno"></span><span class="op" id="5493711">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="5493714">//&nbsp;Count&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;execution&nbsp;stacks&nbsp;currently&nbsp;in&nbsp;the&nbsp;profile.</span><br>
<span class="lineno"></span><span class="keyword" id="5493788">func</span>&nbsp;<span class="op" id="5493793">(</span><span class="ident" id="5493794">p</span>&nbsp;<span class="op" id="5493796">*</span><span class="ident" id="5493797"><a href="/gostd/runtime/pprof/pprof.go.html#5491365">Profile</a></span><span class="op" id="5493804">)</span>&nbsp;<span class="ident" id="5493806">Count</span><span class="op" id="5493811">(</span><span class="op" id="5493812">)</span>&nbsp;<span class="builtintype" id="5493814">int</span>&nbsp;<span class="op" id="5493818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5493821"><a href="/gostd/runtime/pprof/pprof.go.html#5493794">p</a></span><span class="op" id="5493822">.</span><span class="ident" id="5493823"><a href="/gostd/runtime/pprof/pprof.go.html#5491397">mu</a></span><span class="op" id="5493825">.</span><span class="ident" id="5493826"><a href="/gostd/sync/mutex.go.html#1444351">Lock</a></span><span class="op" id="5493830">(</span><span class="op" id="5493831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5493834">defer</span>&nbsp;<span class="ident" id="5493840"><a href="/gostd/runtime/pprof/pprof.go.html#5493794">p</a></span><span class="op" id="5493841">.</span><span class="ident" id="5493842"><a href="/gostd/runtime/pprof/pprof.go.html#5491397">mu</a></span><span class="op" id="5493844">.</span><span class="ident" id="5493845"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="5493851">(</span><span class="op" id="5493852">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5493855">if</span>&nbsp;<span class="ident" id="5493858"><a href="/gostd/runtime/pprof/pprof.go.html#5493794">p</a></span><span class="op" id="5493859">.</span><span class="ident" id="5493860"><a href="/gostd/runtime/pprof/pprof.go.html#5491448">count</a></span>&nbsp;<span class="op" id="5493866">!=</span>&nbsp;<span class="builtintype" id="5493869">nil</span>&nbsp;<span class="op" id="5493873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5493877">return</span>&nbsp;<span class="ident" id="5493884"><a href="/gostd/runtime/pprof/pprof.go.html#5493794">p</a></span><span class="op" id="5493885">.</span><span class="ident" id="5493886"><a href="/gostd/runtime/pprof/pprof.go.html#5491448">count</a></span><span class="op" id="5493891">(</span><span class="op" id="5493892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5493895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5493898">return</span>&nbsp;<span class="builtinfunc" id="5493905">len</span><span class="op" id="5493908">(</span><span class="ident" id="5493909"><a href="/gostd/runtime/pprof/pprof.go.html#5493794">p</a></span><span class="op" id="5493910">.</span><span class="ident" id="5493911"><a href="/gostd/runtime/pprof/pprof.go.html#5491415">m</a></span><span class="op" id="5493912">)</span><br>
<span class="lineno"></span><span class="op" id="5493914">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="5493917">//&nbsp;Add&nbsp;adds&nbsp;the&nbsp;current&nbsp;execution&nbsp;stack&nbsp;to&nbsp;the&nbsp;profile,&nbsp;associated&nbsp;with&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="5493996">//&nbsp;Add&nbsp;stores&nbsp;value&nbsp;in&nbsp;an&nbsp;internal&nbsp;map,&nbsp;so&nbsp;value&nbsp;must&nbsp;be&nbsp;suitable&nbsp;for&nbsp;use&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="5494073">//&nbsp;a&nbsp;map&nbsp;key&nbsp;and&nbsp;will&nbsp;not&nbsp;be&nbsp;garbage&nbsp;collected&nbsp;until&nbsp;the&nbsp;corresponding</span><br>
<span class="lineno"></span><span class="comment" id="5494144">//&nbsp;call&nbsp;to&nbsp;Remove.&nbsp;&nbsp;Add&nbsp;panics&nbsp;if&nbsp;the&nbsp;profile&nbsp;already&nbsp;contains&nbsp;a&nbsp;stack&nbsp;for&nbsp;value.</span><br>
<span class="lineno">170</span><span class="comment" id="5494226">//</span><br>
<span class="lineno"></span><span class="comment" id="5494229">//&nbsp;The&nbsp;skip&nbsp;parameter&nbsp;has&nbsp;the&nbsp;same&nbsp;meaning&nbsp;as&nbsp;runtime.Caller&#39;s&nbsp;skip</span><br>
<span class="lineno"></span><span class="comment" id="5494297">//&nbsp;and&nbsp;controls&nbsp;where&nbsp;the&nbsp;stack&nbsp;trace&nbsp;begins.&nbsp;&nbsp;Passing&nbsp;skip=0&nbsp;begins&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5494370">//&nbsp;trace&nbsp;in&nbsp;the&nbsp;function&nbsp;calling&nbsp;Add.&nbsp;&nbsp;For&nbsp;example,&nbsp;given&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="5494433">//&nbsp;execution&nbsp;stack:</span><br>
<span class="lineno">175</span><span class="comment" id="5494453">//</span><br>
<span class="lineno"></span><span class="comment" id="5494456">//&nbsp;&nbsp;&nbsp;&nbsp;Add</span><br>
<span class="lineno"></span><span class="comment" id="5494463">//&nbsp;&nbsp;&nbsp;&nbsp;called&nbsp;from&nbsp;rpc.NewClient</span><br>
<span class="lineno"></span><span class="comment" id="5494492">//&nbsp;&nbsp;&nbsp;&nbsp;called&nbsp;from&nbsp;mypkg.Run</span><br>
<span class="lineno"></span><span class="comment" id="5494517">//&nbsp;&nbsp;&nbsp;&nbsp;called&nbsp;from&nbsp;main.main</span><br>
<span class="lineno">180</span><span class="comment" id="5494542">//</span><br>
<span class="lineno"></span><span class="comment" id="5494545">//&nbsp;Passing&nbsp;skip=0&nbsp;begins&nbsp;the&nbsp;stack&nbsp;trace&nbsp;at&nbsp;the&nbsp;call&nbsp;to&nbsp;Add&nbsp;inside&nbsp;rpc.NewClient.</span><br>
<span class="lineno"></span><span class="comment" id="5494627">//&nbsp;Passing&nbsp;skip=1&nbsp;begins&nbsp;the&nbsp;stack&nbsp;trace&nbsp;at&nbsp;the&nbsp;call&nbsp;to&nbsp;NewClient&nbsp;inside&nbsp;mypkg.Run.</span><br>
<span class="lineno"></span><span class="comment" id="5494711">//</span><br>
<span class="lineno"></span><span class="keyword" id="5494714">func</span>&nbsp;<span class="op" id="5494719">(</span><span class="ident" id="5494720">p</span>&nbsp;<span class="op" id="5494722">*</span><span class="ident" id="5494723"><a href="/gostd/runtime/pprof/pprof.go.html#5491365">Profile</a></span><span class="op" id="5494730">)</span>&nbsp;<span class="ident" id="5494732">Add</span><span class="op" id="5494735">(</span><span class="ident" id="5494736">value</span>&nbsp;<span class="keyword" id="5494742">interface</span><span class="op" id="5494751">{</span><span class="op" id="5494752">}</span><span class="op" id="5494753">,</span>&nbsp;<span class="ident" id="5494755">skip</span>&nbsp;<span class="builtintype" id="5494760">int</span><span class="op" id="5494763">)</span>&nbsp;<span class="op" id="5494765">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5494768">if</span>&nbsp;<span class="ident" id="5494771"><a href="/gostd/runtime/pprof/pprof.go.html#5494720">p</a></span><span class="op" id="5494772">.</span><span class="ident" id="5494773"><a href="/gostd/runtime/pprof/pprof.go.html#5491383">name</a></span>&nbsp;<span class="op" id="5494778">==</span>&nbsp;<span class="string" id="5494781">&#34;&#34;</span>&nbsp;<span class="op" id="5494784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5494788">panic</span><span class="op" id="5494793">(</span><span class="string" id="5494794">&#34;pprof:&nbsp;use&nbsp;of&nbsp;uninitialized&nbsp;Profile&#34;</span><span class="op" id="5494831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5494834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5494837">if</span>&nbsp;<span class="ident" id="5494840"><a href="/gostd/runtime/pprof/pprof.go.html#5494720">p</a></span><span class="op" id="5494841">.</span><span class="ident" id="5494842"><a href="/gostd/runtime/pprof/pprof.go.html#5491466">write</a></span>&nbsp;<span class="op" id="5494848">!=</span>&nbsp;<span class="builtintype" id="5494851">nil</span>&nbsp;<span class="op" id="5494855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5494859">panic</span><span class="op" id="5494864">(</span><span class="string" id="5494865">&#34;pprof:&nbsp;Add&nbsp;called&nbsp;on&nbsp;built-in&nbsp;Profile&nbsp;&#34;</span>&nbsp;<span class="op" id="5494906">+</span>&nbsp;<span class="ident" id="5494908"><a href="/gostd/runtime/pprof/pprof.go.html#5494720">p</a></span><span class="op" id="5494909">.</span><span class="ident" id="5494910"><a href="/gostd/runtime/pprof/pprof.go.html#5491383">name</a></span><span class="op" id="5494914">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5494917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5494921">stk</span>&nbsp;<span class="op" id="5494925">:=</span>&nbsp;<span class="builtinfunc" id="5494928">make</span><span class="op" id="5494932">(</span><span class="op" id="5494933">[</span><span class="op" id="5494934">]</span><span class="builtintype" id="5494935">uintptr</span><span class="op" id="5494942">,</span>&nbsp;<span class="num" id="5494944">32</span><span class="op" id="5494946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5494949">n</span>&nbsp;<span class="op" id="5494951">:=</span>&nbsp;<span class="ident" id="5494954"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5494961">.</span><span class="ident" id="5494962"><a href="/gostd/runtime/extern.go.html#1532841">Callers</a></span><span class="op" id="5494969">(</span><span class="ident" id="5494970"><a href="/gostd/runtime/pprof/pprof.go.html#5494755">skip</a></span><span class="op" id="5494974">+</span><span class="num" id="5494975">1</span><span class="op" id="5494976">,</span>&nbsp;<span class="ident" id="5494978"><a href="/gostd/runtime/pprof/pprof.go.html#5494921">stk</a></span><span class="op" id="5494981">[</span><span class="op" id="5494982">:</span><span class="op" id="5494983">]</span><span class="op" id="5494984">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5494988"><a href="/gostd/runtime/pprof/pprof.go.html#5494720">p</a></span><span class="op" id="5494989">.</span><span class="ident" id="5494990"><a href="/gostd/runtime/pprof/pprof.go.html#5491397">mu</a></span><span class="op" id="5494992">.</span><span class="ident" id="5494993"><a href="/gostd/sync/mutex.go.html#1444351">Lock</a></span><span class="op" id="5494997">(</span><span class="op" id="5494998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5495001">defer</span>&nbsp;<span class="ident" id="5495007"><a href="/gostd/runtime/pprof/pprof.go.html#5494720">p</a></span><span class="op" id="5495008">.</span><span class="ident" id="5495009"><a href="/gostd/runtime/pprof/pprof.go.html#5491397">mu</a></span><span class="op" id="5495011">.</span><span class="ident" id="5495012"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="5495018">(</span><span class="op" id="5495019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5495022">if</span>&nbsp;<span class="ident" id="5495025"><a href="/gostd/runtime/pprof/pprof.go.html#5494720">p</a></span><span class="op" id="5495026">.</span><span class="ident" id="5495027"><a href="/gostd/runtime/pprof/pprof.go.html#5491415">m</a></span><span class="op" id="5495028">[</span><span class="ident" id="5495029"><a href="/gostd/runtime/pprof/pprof.go.html#5494736">value</a></span><span class="op" id="5495034">]</span>&nbsp;<span class="op" id="5495036">!=</span>&nbsp;<span class="builtintype" id="5495039">nil</span>&nbsp;<span class="op" id="5495043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5495047">panic</span><span class="op" id="5495052">(</span><span class="string" id="5495053">&#34;pprof:&nbsp;Profile.Add&nbsp;of&nbsp;duplicate&nbsp;value&#34;</span><span class="op" id="5495092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5495095">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5495098"><a href="/gostd/runtime/pprof/pprof.go.html#5494720">p</a></span><span class="op" id="5495099">.</span><span class="ident" id="5495100"><a href="/gostd/runtime/pprof/pprof.go.html#5491415">m</a></span><span class="op" id="5495101">[</span><span class="ident" id="5495102"><a href="/gostd/runtime/pprof/pprof.go.html#5494736">value</a></span><span class="op" id="5495107">]</span>&nbsp;<span class="op" id="5495109">=</span>&nbsp;<span class="ident" id="5495111"><a href="/gostd/runtime/pprof/pprof.go.html#5494921">stk</a></span><span class="op" id="5495114">[</span><span class="op" id="5495115">:</span><span class="ident" id="5495116"><a href="/gostd/runtime/pprof/pprof.go.html#5494949">n</a></span><span class="op" id="5495117">]</span><br>
<span class="lineno"></span><span class="op" id="5495119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5495122">//&nbsp;Remove&nbsp;removes&nbsp;the&nbsp;execution&nbsp;stack&nbsp;associated&nbsp;with&nbsp;value&nbsp;from&nbsp;the&nbsp;profile.</span><br>
<span class="lineno"></span><span class="comment" id="5495200">//&nbsp;It&nbsp;is&nbsp;a&nbsp;no-op&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;profile.</span><br>
<span class="lineno">205</span><span class="keyword" id="5495253">func</span>&nbsp;<span class="op" id="5495258">(</span><span class="ident" id="5495259">p</span>&nbsp;<span class="op" id="5495261">*</span><span class="ident" id="5495262"><a href="/gostd/runtime/pprof/pprof.go.html#5491365">Profile</a></span><span class="op" id="5495269">)</span>&nbsp;<span class="ident" id="5495271">Remove</span><span class="op" id="5495277">(</span><span class="ident" id="5495278">value</span>&nbsp;<span class="keyword" id="5495284">interface</span><span class="op" id="5495293">{</span><span class="op" id="5495294">}</span><span class="op" id="5495295">)</span>&nbsp;<span class="op" id="5495297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5495300"><a href="/gostd/runtime/pprof/pprof.go.html#5495259">p</a></span><span class="op" id="5495301">.</span><span class="ident" id="5495302"><a href="/gostd/runtime/pprof/pprof.go.html#5491397">mu</a></span><span class="op" id="5495304">.</span><span class="ident" id="5495305"><a href="/gostd/sync/mutex.go.html#1444351">Lock</a></span><span class="op" id="5495309">(</span><span class="op" id="5495310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5495313">defer</span>&nbsp;<span class="ident" id="5495319"><a href="/gostd/runtime/pprof/pprof.go.html#5495259">p</a></span><span class="op" id="5495320">.</span><span class="ident" id="5495321"><a href="/gostd/runtime/pprof/pprof.go.html#5491397">mu</a></span><span class="op" id="5495323">.</span><span class="ident" id="5495324"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="5495330">(</span><span class="op" id="5495331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5495334">delete</span><span class="op" id="5495340">(</span><span class="ident" id="5495341"><a href="/gostd/runtime/pprof/pprof.go.html#5495259">p</a></span><span class="op" id="5495342">.</span><span class="ident" id="5495343"><a href="/gostd/runtime/pprof/pprof.go.html#5491415">m</a></span><span class="op" id="5495344">,</span>&nbsp;<span class="ident" id="5495346"><a href="/gostd/runtime/pprof/pprof.go.html#5495278">value</a></span><span class="op" id="5495351">)</span><br>
<span class="lineno"></span><span class="op" id="5495353">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="comment" id="5495356">//&nbsp;WriteTo&nbsp;writes&nbsp;a&nbsp;pprof-formatted&nbsp;snapshot&nbsp;of&nbsp;the&nbsp;profile&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="5495422">//&nbsp;If&nbsp;a&nbsp;write&nbsp;to&nbsp;w&nbsp;returns&nbsp;an&nbsp;error,&nbsp;WriteTo&nbsp;returns&nbsp;that&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="5495487">//&nbsp;Otherwise,&nbsp;WriteTo&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="5495522">//</span><br>
<span class="lineno">215</span><span class="comment" id="5495525">//&nbsp;The&nbsp;debug&nbsp;parameter&nbsp;enables&nbsp;additional&nbsp;output.</span><br>
<span class="lineno"></span><span class="comment" id="5495575">//&nbsp;Passing&nbsp;debug=0&nbsp;prints&nbsp;only&nbsp;the&nbsp;hexadecimal&nbsp;addresses&nbsp;that&nbsp;pprof&nbsp;needs.</span><br>
<span class="lineno"></span><span class="comment" id="5495650">//&nbsp;Passing&nbsp;debug=1&nbsp;adds&nbsp;comments&nbsp;translating&nbsp;addresses&nbsp;to&nbsp;function&nbsp;names</span><br>
<span class="lineno"></span><span class="comment" id="5495723">//&nbsp;and&nbsp;line&nbsp;numbers,&nbsp;so&nbsp;that&nbsp;a&nbsp;programmer&nbsp;can&nbsp;read&nbsp;the&nbsp;profile&nbsp;without&nbsp;tools.</span><br>
<span class="lineno"></span><span class="comment" id="5495801">//</span><br>
<span class="lineno">220</span><span class="comment" id="5495804">//&nbsp;The&nbsp;predefined&nbsp;profiles&nbsp;may&nbsp;assign&nbsp;meaning&nbsp;to&nbsp;other&nbsp;debug&nbsp;values;</span><br>
<span class="lineno"></span><span class="comment" id="5495873">//&nbsp;for&nbsp;example,&nbsp;when&nbsp;printing&nbsp;the&nbsp;&#34;goroutine&#34;&nbsp;profile,&nbsp;debug=2&nbsp;means&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5495945">//&nbsp;print&nbsp;the&nbsp;goroutine&nbsp;stacks&nbsp;in&nbsp;the&nbsp;same&nbsp;form&nbsp;that&nbsp;a&nbsp;Go&nbsp;program&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="5496015">//&nbsp;when&nbsp;dying&nbsp;due&nbsp;to&nbsp;an&nbsp;unrecovered&nbsp;panic.</span><br>
<span class="lineno"></span><span class="keyword" id="5496058">func</span>&nbsp;<span class="op" id="5496063">(</span><span class="ident" id="5496064">p</span>&nbsp;<span class="op" id="5496066">*</span><span class="ident" id="5496067"><a href="/gostd/runtime/pprof/pprof.go.html#5491365">Profile</a></span><span class="op" id="5496074">)</span>&nbsp;<span class="ident" id="5496076">WriteTo</span><span class="op" id="5496083">(</span><span class="ident" id="5496084">w</span>&nbsp;<span class="ident" id="5496086"><a href="/gostd/runtime/pprof/pprof.go.html#5490138">io</a></span><span class="op" id="5496088">.</span><span class="ident" id="5496089"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="5496095">,</span>&nbsp;<span class="ident" id="5496097">debug</span>&nbsp;<span class="builtintype" id="5496103">int</span><span class="op" id="5496106">)</span>&nbsp;<span class="builtintype" id="5496108">error</span>&nbsp;<span class="op" id="5496114">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5496117">if</span>&nbsp;<span class="ident" id="5496120"><a href="/gostd/runtime/pprof/pprof.go.html#5496064">p</a></span><span class="op" id="5496121">.</span><span class="ident" id="5496122"><a href="/gostd/runtime/pprof/pprof.go.html#5491383">name</a></span>&nbsp;<span class="op" id="5496127">==</span>&nbsp;<span class="string" id="5496130">&#34;&#34;</span>&nbsp;<span class="op" id="5496133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5496137">panic</span><span class="op" id="5496142">(</span><span class="string" id="5496143">&#34;pprof:&nbsp;use&nbsp;of&nbsp;zero&nbsp;Profile&#34;</span><span class="op" id="5496171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5496174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5496177">if</span>&nbsp;<span class="ident" id="5496180"><a href="/gostd/runtime/pprof/pprof.go.html#5496064">p</a></span><span class="op" id="5496181">.</span><span class="ident" id="5496182"><a href="/gostd/runtime/pprof/pprof.go.html#5491466">write</a></span>&nbsp;<span class="op" id="5496188">!=</span>&nbsp;<span class="builtintype" id="5496191">nil</span>&nbsp;<span class="op" id="5496195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5496199">return</span>&nbsp;<span class="ident" id="5496206"><a href="/gostd/runtime/pprof/pprof.go.html#5496064">p</a></span><span class="op" id="5496207">.</span><span class="ident" id="5496208"><a href="/gostd/runtime/pprof/pprof.go.html#5491466">write</a></span><span class="op" id="5496213">(</span><span class="ident" id="5496214"><a href="/gostd/runtime/pprof/pprof.go.html#5496084">w</a></span><span class="op" id="5496215">,</span>&nbsp;<span class="ident" id="5496217"><a href="/gostd/runtime/pprof/pprof.go.html#5496097">debug</a></span><span class="op" id="5496222">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5496225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5496229">//&nbsp;Obtain&nbsp;consistent&nbsp;snapshot&nbsp;under&nbsp;lock;&nbsp;then&nbsp;process&nbsp;without&nbsp;lock.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5496299">var</span>&nbsp;<span class="ident" id="5496303">all</span>&nbsp;<span class="op" id="5496307">[</span><span class="op" id="5496308">]</span><span class="op" id="5496309">[</span><span class="op" id="5496310">]</span><span class="builtintype" id="5496311">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5496320"><a href="/gostd/runtime/pprof/pprof.go.html#5496064">p</a></span><span class="op" id="5496321">.</span><span class="ident" id="5496322"><a href="/gostd/runtime/pprof/pprof.go.html#5491397">mu</a></span><span class="op" id="5496324">.</span><span class="ident" id="5496325"><a href="/gostd/sync/mutex.go.html#1444351">Lock</a></span><span class="op" id="5496329">(</span><span class="op" id="5496330">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5496333">for</span>&nbsp;<span class="ident" id="5496337">_</span><span class="op" id="5496338">,</span>&nbsp;<span class="ident" id="5496340">stk</span>&nbsp;<span class="op" id="5496344">:=</span>&nbsp;<span class="keyword" id="5496347">range</span>&nbsp;<span class="ident" id="5496353"><a href="/gostd/runtime/pprof/pprof.go.html#5496064">p</a></span><span class="op" id="5496354">.</span><span class="ident" id="5496355"><a href="/gostd/runtime/pprof/pprof.go.html#5491415">m</a></span>&nbsp;<span class="op" id="5496357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5496361"><a href="/gostd/runtime/pprof/pprof.go.html#5496303">all</a></span>&nbsp;<span class="op" id="5496365">=</span>&nbsp;<span class="builtinfunc" id="5496367">append</span><span class="op" id="5496373">(</span><span class="ident" id="5496374"><a href="/gostd/runtime/pprof/pprof.go.html#5496303">all</a></span><span class="op" id="5496377">,</span>&nbsp;<span class="ident" id="5496379"><a href="/gostd/runtime/pprof/pprof.go.html#5496340">stk</a></span><span class="op" id="5496382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5496385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5496388"><a href="/gostd/runtime/pprof/pprof.go.html#5496064">p</a></span><span class="op" id="5496389">.</span><span class="ident" id="5496390"><a href="/gostd/runtime/pprof/pprof.go.html#5491397">mu</a></span><span class="op" id="5496392">.</span><span class="ident" id="5496393"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="5496399">(</span><span class="op" id="5496400">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5496404">//&nbsp;Map&nbsp;order&nbsp;is&nbsp;non-deterministic;&nbsp;make&nbsp;output&nbsp;deterministic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5496467"><a href="/gostd/runtime/pprof/pprof.go.html#5490155">sort</a></span><span class="op" id="5496471">.</span><span class="ident" id="5496472"><a href="/gostd/sort/sort.go.html#2015380">Sort</a></span><span class="op" id="5496476">(</span><span class="ident" id="5496477"><a href="/gostd/runtime/pprof/pprof.go.html#5496568">stackProfile</a></span><span class="op" id="5496489">(</span><span class="ident" id="5496490"><a href="/gostd/runtime/pprof/pprof.go.html#5496303">all</a></span><span class="op" id="5496493">)</span><span class="op" id="5496494">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5496498">return</span>&nbsp;<span class="ident" id="5496505"><a href="/gostd/runtime/pprof/pprof.go.html#5497357">printCountProfile</a></span><span class="op" id="5496522">(</span><span class="ident" id="5496523"><a href="/gostd/runtime/pprof/pprof.go.html#5496084">w</a></span><span class="op" id="5496524">,</span>&nbsp;<span class="ident" id="5496526"><a href="/gostd/runtime/pprof/pprof.go.html#5496097">debug</a></span><span class="op" id="5496531">,</span>&nbsp;<span class="ident" id="5496533"><a href="/gostd/runtime/pprof/pprof.go.html#5496064">p</a></span><span class="op" id="5496534">.</span><span class="ident" id="5496535"><a href="/gostd/runtime/pprof/pprof.go.html#5491383">name</a></span><span class="op" id="5496539">,</span>&nbsp;<span class="ident" id="5496541"><a href="/gostd/runtime/pprof/pprof.go.html#5496568">stackProfile</a></span><span class="op" id="5496553">(</span><span class="ident" id="5496554"><a href="/gostd/runtime/pprof/pprof.go.html#5496303">all</a></span><span class="op" id="5496557">)</span><span class="op" id="5496558">)</span><br>
<span class="lineno"></span><span class="op" id="5496560">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="5496563">type</span>&nbsp;<span class="ident" id="5496568">stackProfile</span>&nbsp;<span class="op" id="5496581">[</span><span class="op" id="5496582">]</span><span class="op" id="5496583">[</span><span class="op" id="5496584">]</span><span class="builtintype" id="5496585">uintptr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5496594">func</span>&nbsp;<span class="op" id="5496599">(</span><span class="ident" id="5496600">x</span>&nbsp;<span class="ident" id="5496602"><a href="/gostd/runtime/pprof/pprof.go.html#5496568">stackProfile</a></span><span class="op" id="5496614">)</span>&nbsp;<span class="ident" id="5496616">Len</span><span class="op" id="5496619">(</span><span class="op" id="5496620">)</span>&nbsp;<span class="builtintype" id="5496622">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5496639">{</span>&nbsp;<span class="keyword" id="5496641">return</span>&nbsp;<span class="builtinfunc" id="5496648">len</span><span class="op" id="5496651">(</span><span class="ident" id="5496652"><a href="/gostd/runtime/pprof/pprof.go.html#5496600">x</a></span><span class="op" id="5496653">)</span>&nbsp;<span class="op" id="5496655">}</span><br>
<span class="lineno"></span><span class="keyword" id="5496657">func</span>&nbsp;<span class="op" id="5496662">(</span><span class="ident" id="5496663">x</span>&nbsp;<span class="ident" id="5496665"><a href="/gostd/runtime/pprof/pprof.go.html#5496568">stackProfile</a></span><span class="op" id="5496677">)</span>&nbsp;<span class="ident" id="5496679">Stack</span><span class="op" id="5496684">(</span><span class="ident" id="5496685">i</span>&nbsp;<span class="builtintype" id="5496687">int</span><span class="op" id="5496690">)</span>&nbsp;<span class="op" id="5496692">[</span><span class="op" id="5496693">]</span><span class="builtintype" id="5496694">uintptr</span>&nbsp;<span class="op" id="5496702">{</span>&nbsp;<span class="keyword" id="5496704">return</span>&nbsp;<span class="ident" id="5496711"><a href="/gostd/runtime/pprof/pprof.go.html#5496663">x</a></span><span class="op" id="5496712">[</span><span class="ident" id="5496713"><a href="/gostd/runtime/pprof/pprof.go.html#5496685">i</a></span><span class="op" id="5496714">]</span>&nbsp;<span class="op" id="5496716">}</span><br>
<span class="lineno">250</span><span class="keyword" id="5496718">func</span>&nbsp;<span class="op" id="5496723">(</span><span class="ident" id="5496724">x</span>&nbsp;<span class="ident" id="5496726"><a href="/gostd/runtime/pprof/pprof.go.html#5496568">stackProfile</a></span><span class="op" id="5496738">)</span>&nbsp;<span class="ident" id="5496740">Swap</span><span class="op" id="5496744">(</span><span class="ident" id="5496745">i</span><span class="op" id="5496746">,</span>&nbsp;<span class="ident" id="5496748">j</span>&nbsp;<span class="builtintype" id="5496750">int</span><span class="op" id="5496753">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5496763">{</span>&nbsp;<span class="ident" id="5496765"><a href="/gostd/runtime/pprof/pprof.go.html#5496724">x</a></span><span class="op" id="5496766">[</span><span class="ident" id="5496767"><a href="/gostd/runtime/pprof/pprof.go.html#5496745">i</a></span><span class="op" id="5496768">]</span><span class="op" id="5496769">,</span>&nbsp;<span class="ident" id="5496771"><a href="/gostd/runtime/pprof/pprof.go.html#5496724">x</a></span><span class="op" id="5496772">[</span><span class="ident" id="5496773"><a href="/gostd/runtime/pprof/pprof.go.html#5496748">j</a></span><span class="op" id="5496774">]</span>&nbsp;<span class="op" id="5496776">=</span>&nbsp;<span class="ident" id="5496778"><a href="/gostd/runtime/pprof/pprof.go.html#5496724">x</a></span><span class="op" id="5496779">[</span><span class="ident" id="5496780"><a href="/gostd/runtime/pprof/pprof.go.html#5496748">j</a></span><span class="op" id="5496781">]</span><span class="op" id="5496782">,</span>&nbsp;<span class="ident" id="5496784"><a href="/gostd/runtime/pprof/pprof.go.html#5496724">x</a></span><span class="op" id="5496785">[</span><span class="ident" id="5496786"><a href="/gostd/runtime/pprof/pprof.go.html#5496745">i</a></span><span class="op" id="5496787">]</span>&nbsp;<span class="op" id="5496789">}</span><br>
<span class="lineno"></span><span class="keyword" id="5496791">func</span>&nbsp;<span class="op" id="5496796">(</span><span class="ident" id="5496797">x</span>&nbsp;<span class="ident" id="5496799"><a href="/gostd/runtime/pprof/pprof.go.html#5496568">stackProfile</a></span><span class="op" id="5496811">)</span>&nbsp;<span class="ident" id="5496813">Less</span><span class="op" id="5496817">(</span><span class="ident" id="5496818">i</span><span class="op" id="5496819">,</span>&nbsp;<span class="ident" id="5496821">j</span>&nbsp;<span class="builtintype" id="5496823">int</span><span class="op" id="5496826">)</span>&nbsp;<span class="builtintype" id="5496828">bool</span>&nbsp;<span class="op" id="5496833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5496836">t</span><span class="op" id="5496837">,</span>&nbsp;<span class="ident" id="5496839">u</span>&nbsp;<span class="op" id="5496841">:=</span>&nbsp;<span class="ident" id="5496844"><a href="/gostd/runtime/pprof/pprof.go.html#5496797">x</a></span><span class="op" id="5496845">[</span><span class="ident" id="5496846"><a href="/gostd/runtime/pprof/pprof.go.html#5496818">i</a></span><span class="op" id="5496847">]</span><span class="op" id="5496848">,</span>&nbsp;<span class="ident" id="5496850"><a href="/gostd/runtime/pprof/pprof.go.html#5496797">x</a></span><span class="op" id="5496851">[</span><span class="ident" id="5496852"><a href="/gostd/runtime/pprof/pprof.go.html#5496821">j</a></span><span class="op" id="5496853">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5496856">for</span>&nbsp;<span class="ident" id="5496860">k</span>&nbsp;<span class="op" id="5496862">:=</span>&nbsp;<span class="num" id="5496865">0</span><span class="op" id="5496866">;</span>&nbsp;<span class="ident" id="5496868"><a href="/gostd/runtime/pprof/pprof.go.html#5496860">k</a></span>&nbsp;<span class="op" id="5496870">&lt;</span>&nbsp;<span class="builtinfunc" id="5496872">len</span><span class="op" id="5496875">(</span><span class="ident" id="5496876"><a href="/gostd/runtime/pprof/pprof.go.html#5496836">t</a></span><span class="op" id="5496877">)</span>&nbsp;<span class="op" id="5496879">&amp;&amp;</span>&nbsp;<span class="ident" id="5496882"><a href="/gostd/runtime/pprof/pprof.go.html#5496860">k</a></span>&nbsp;<span class="op" id="5496884">&lt;</span>&nbsp;<span class="builtinfunc" id="5496886">len</span><span class="op" id="5496889">(</span><span class="ident" id="5496890"><a href="/gostd/runtime/pprof/pprof.go.html#5496839">u</a></span><span class="op" id="5496891">)</span><span class="op" id="5496892">;</span>&nbsp;<span class="ident" id="5496894"><a href="/gostd/runtime/pprof/pprof.go.html#5496860">k</a></span><span class="op" id="5496895">++</span>&nbsp;<span class="op" id="5496898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5496902">if</span>&nbsp;<span class="ident" id="5496905"><a href="/gostd/runtime/pprof/pprof.go.html#5496836">t</a></span><span class="op" id="5496906">[</span><span class="ident" id="5496907"><a href="/gostd/runtime/pprof/pprof.go.html#5496860">k</a></span><span class="op" id="5496908">]</span>&nbsp;<span class="op" id="5496910">!=</span>&nbsp;<span class="ident" id="5496913"><a href="/gostd/runtime/pprof/pprof.go.html#5496839">u</a></span><span class="op" id="5496914">[</span><span class="ident" id="5496915"><a href="/gostd/runtime/pprof/pprof.go.html#5496860">k</a></span><span class="op" id="5496916">]</span>&nbsp;<span class="op" id="5496918">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5496923">return</span>&nbsp;<span class="ident" id="5496930"><a href="/gostd/runtime/pprof/pprof.go.html#5496836">t</a></span><span class="op" id="5496931">[</span><span class="ident" id="5496932"><a href="/gostd/runtime/pprof/pprof.go.html#5496860">k</a></span><span class="op" id="5496933">]</span>&nbsp;<span class="op" id="5496935">&lt;</span>&nbsp;<span class="ident" id="5496937"><a href="/gostd/runtime/pprof/pprof.go.html#5496839">u</a></span><span class="op" id="5496938">[</span><span class="ident" id="5496939"><a href="/gostd/runtime/pprof/pprof.go.html#5496860">k</a></span><span class="op" id="5496940">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5496944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5496947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5496950">return</span>&nbsp;<span class="builtinfunc" id="5496957">len</span><span class="op" id="5496960">(</span><span class="ident" id="5496961"><a href="/gostd/runtime/pprof/pprof.go.html#5496836">t</a></span><span class="op" id="5496962">)</span>&nbsp;<span class="op" id="5496964">&lt;</span>&nbsp;<span class="builtinfunc" id="5496966">len</span><span class="op" id="5496969">(</span><span class="ident" id="5496970"><a href="/gostd/runtime/pprof/pprof.go.html#5496839">u</a></span><span class="op" id="5496971">)</span><br>
<span class="lineno"></span><span class="op" id="5496973">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="comment" id="5496976">//&nbsp;A&nbsp;countProfile&nbsp;is&nbsp;a&nbsp;set&nbsp;of&nbsp;stack&nbsp;traces&nbsp;to&nbsp;be&nbsp;printed&nbsp;as&nbsp;counts</span><br>
<span class="lineno"></span><span class="comment" id="5497043">//&nbsp;grouped&nbsp;by&nbsp;stack&nbsp;trace.&nbsp;&nbsp;There&nbsp;are&nbsp;multiple&nbsp;implementations:</span><br>
<span class="lineno"></span><span class="comment" id="5497107">//&nbsp;all&nbsp;that&nbsp;matters&nbsp;is&nbsp;that&nbsp;we&nbsp;can&nbsp;find&nbsp;out&nbsp;how&nbsp;many&nbsp;traces&nbsp;there&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="5497177">//&nbsp;and&nbsp;obtain&nbsp;each&nbsp;trace&nbsp;in&nbsp;turn.</span><br>
<span class="lineno">265</span><span class="keyword" id="5497211">type</span>&nbsp;<span class="ident" id="5497216">countProfile</span>&nbsp;<span class="keyword" id="5497229">interface</span>&nbsp;<span class="op" id="5497239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5497242">Len</span><span class="op" id="5497245">(</span><span class="op" id="5497246">)</span>&nbsp;<span class="builtintype" id="5497248">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5497253">Stack</span><span class="op" id="5497258">(</span><span class="ident" id="5497259">i</span>&nbsp;<span class="builtintype" id="5497261">int</span><span class="op" id="5497264">)</span>&nbsp;<span class="op" id="5497266">[</span><span class="op" id="5497267">]</span><span class="builtintype" id="5497268">uintptr</span><br>
<span class="lineno"></span><span class="op" id="5497276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span><span class="comment" id="5497279">//&nbsp;printCountProfile&nbsp;prints&nbsp;a&nbsp;countProfile&nbsp;at&nbsp;the&nbsp;specified&nbsp;debug&nbsp;level.</span><br>
<span class="lineno"></span><span class="keyword" id="5497352">func</span>&nbsp;<span class="ident" id="5497357">printCountProfile</span><span class="op" id="5497374">(</span><span class="ident" id="5497375">w</span>&nbsp;<span class="ident" id="5497377"><a href="/gostd/runtime/pprof/pprof.go.html#5490138">io</a></span><span class="op" id="5497379">.</span><span class="ident" id="5497380"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="5497386">,</span>&nbsp;<span class="ident" id="5497388">debug</span>&nbsp;<span class="builtintype" id="5497394">int</span><span class="op" id="5497397">,</span>&nbsp;<span class="ident" id="5497399">name</span>&nbsp;<span class="builtintype" id="5497404">string</span><span class="op" id="5497410">,</span>&nbsp;<span class="ident" id="5497412">p</span>&nbsp;<span class="ident" id="5497414"><a href="/gostd/runtime/pprof/pprof.go.html#5497216">countProfile</a></span><span class="op" id="5497426">)</span>&nbsp;<span class="builtintype" id="5497428">error</span>&nbsp;<span class="op" id="5497434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5497437">b</span>&nbsp;<span class="op" id="5497439">:=</span>&nbsp;<span class="ident" id="5497442"><a href="/gostd/runtime/pprof/pprof.go.html#5490113">bufio</a></span><span class="op" id="5497447">.</span><span class="ident" id="5497448"><a href="/gostd/bufio/bufio.go.html#1367149">NewWriter</a></span><span class="op" id="5497457">(</span><span class="ident" id="5497458"><a href="/gostd/runtime/pprof/pprof.go.html#5497375">w</a></span><span class="op" id="5497459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5497462">var</span>&nbsp;<span class="ident" id="5497466">tw</span>&nbsp;<span class="op" id="5497469">*</span><span class="ident" id="5497470"><a href="/gostd/runtime/pprof/pprof.go.html#5490182">tabwriter</a></span><span class="op" id="5497479">.</span><span class="ident" id="5497480"><a href="/gostd/text/tabwriter/tabwriter.go.html#5511646">Writer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5497488"><a href="/gostd/runtime/pprof/pprof.go.html#5497375">w</a></span>&nbsp;<span class="op" id="5497490">=</span>&nbsp;<span class="ident" id="5497492"><a href="/gostd/runtime/pprof/pprof.go.html#5497437">b</a></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5497495">if</span>&nbsp;<span class="ident" id="5497498"><a href="/gostd/runtime/pprof/pprof.go.html#5497388">debug</a></span>&nbsp;<span class="op" id="5497504">&gt;</span>&nbsp;<span class="num" id="5497506">0</span>&nbsp;<span class="op" id="5497508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5497512"><a href="/gostd/runtime/pprof/pprof.go.html#5497466">tw</a></span>&nbsp;<span class="op" id="5497515">=</span>&nbsp;<span class="ident" id="5497517"><a href="/gostd/runtime/pprof/pprof.go.html#5490182">tabwriter</a></span><span class="op" id="5497526">.</span><span class="ident" id="5497527"><a href="/gostd/text/tabwriter/tabwriter.go.html#5524689">NewWriter</a></span><span class="op" id="5497536">(</span><span class="ident" id="5497537"><a href="/gostd/runtime/pprof/pprof.go.html#5497375">w</a></span><span class="op" id="5497538">,</span>&nbsp;<span class="num" id="5497540">1</span><span class="op" id="5497541">,</span>&nbsp;<span class="num" id="5497543">8</span><span class="op" id="5497544">,</span>&nbsp;<span class="num" id="5497546">1</span><span class="op" id="5497547">,</span>&nbsp;<span class="string" id="5497549">&#39;\t&#39;</span><span class="op" id="5497553">,</span>&nbsp;<span class="num" id="5497555">0</span><span class="op" id="5497556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5497560"><a href="/gostd/runtime/pprof/pprof.go.html#5497375">w</a></span>&nbsp;<span class="op" id="5497562">=</span>&nbsp;<span class="ident" id="5497564"><a href="/gostd/runtime/pprof/pprof.go.html#5497466">tw</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5497568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5497572"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5497575">.</span><span class="ident" id="5497576"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5497583">(</span><span class="ident" id="5497584"><a href="/gostd/runtime/pprof/pprof.go.html#5497375">w</a></span><span class="op" id="5497585">,</span>&nbsp;<span class="string" id="5497587">&#34;%s&nbsp;profile:&nbsp;total&nbsp;%d\n&#34;</span><span class="op" id="5497611">,</span>&nbsp;<span class="ident" id="5497613"><a href="/gostd/runtime/pprof/pprof.go.html#5497399">name</a></span><span class="op" id="5497617">,</span>&nbsp;<span class="ident" id="5497619"><a href="/gostd/runtime/pprof/pprof.go.html#5497412">p</a></span><span class="op" id="5497620">.</span><span class="ident" id="5497621"><a href="/gostd/runtime/pprof/pprof.go.html#5497242">Len</a></span><span class="op" id="5497624">(</span><span class="op" id="5497625">)</span><span class="op" id="5497626">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5497630">//&nbsp;Build&nbsp;count&nbsp;of&nbsp;each&nbsp;stack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5497661">var</span>&nbsp;<span class="ident" id="5497665">buf</span>&nbsp;<span class="ident" id="5497669"><a href="/gostd/runtime/pprof/pprof.go.html#5490122">bytes</a></span><span class="op" id="5497674">.</span><span class="ident" id="5497675"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5497683">key</span>&nbsp;<span class="op" id="5497687">:=</span>&nbsp;<span class="keyword" id="5497690">func</span><span class="op" id="5497694">(</span><span class="ident" id="5497695">stk</span>&nbsp;<span class="op" id="5497699">[</span><span class="op" id="5497700">]</span><span class="builtintype" id="5497701">uintptr</span><span class="op" id="5497708">)</span>&nbsp;<span class="builtintype" id="5497710">string</span>&nbsp;<span class="op" id="5497717">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5497721"><a href="/gostd/runtime/pprof/pprof.go.html#5497665">buf</a></span><span class="op" id="5497724">.</span><span class="ident" id="5497725"><a href="/gostd/bytes/buffer.go.html#1385417">Reset</a></span><span class="op" id="5497730">(</span><span class="op" id="5497731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5497735"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5497738">.</span><span class="ident" id="5497739"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5497746">(</span><span class="op" id="5497747">&amp;</span><span class="ident" id="5497748"><a href="/gostd/runtime/pprof/pprof.go.html#5497665">buf</a></span><span class="op" id="5497751">,</span>&nbsp;<span class="string" id="5497753">&#34;@&#34;</span><span class="op" id="5497756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5497760">for</span>&nbsp;<span class="ident" id="5497764">_</span><span class="op" id="5497765">,</span>&nbsp;<span class="ident" id="5497767">pc</span>&nbsp;<span class="op" id="5497770">:=</span>&nbsp;<span class="keyword" id="5497773">range</span>&nbsp;<span class="ident" id="5497779"><a href="/gostd/runtime/pprof/pprof.go.html#5497695">stk</a></span>&nbsp;<span class="op" id="5497783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5497788"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5497791">.</span><span class="ident" id="5497792"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5497799">(</span><span class="op" id="5497800">&amp;</span><span class="ident" id="5497801"><a href="/gostd/runtime/pprof/pprof.go.html#5497665">buf</a></span><span class="op" id="5497804">,</span>&nbsp;<span class="string" id="5497806">&#34;&nbsp;%#x&#34;</span><span class="op" id="5497812">,</span>&nbsp;<span class="ident" id="5497814"><a href="/gostd/runtime/pprof/pprof.go.html#5497767">pc</a></span><span class="op" id="5497816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5497820">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5497824">return</span>&nbsp;<span class="ident" id="5497831"><a href="/gostd/runtime/pprof/pprof.go.html#5497665">buf</a></span><span class="op" id="5497834">.</span><span class="ident" id="5497835"><a href="/gostd/bytes/buffer.go.html#1384648">String</a></span><span class="op" id="5497841">(</span><span class="op" id="5497842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5497845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5497848">m</span>&nbsp;<span class="op" id="5497850">:=</span>&nbsp;<span class="keyword" id="5497853">map</span><span class="op" id="5497856">[</span><span class="builtintype" id="5497857">string</span><span class="op" id="5497863">]</span><span class="builtintype" id="5497864">int</span><span class="op" id="5497867">{</span><span class="op" id="5497868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5497871">n</span>&nbsp;<span class="op" id="5497873">:=</span>&nbsp;<span class="ident" id="5497876"><a href="/gostd/runtime/pprof/pprof.go.html#5497412">p</a></span><span class="op" id="5497877">.</span><span class="ident" id="5497878"><a href="/gostd/runtime/pprof/pprof.go.html#5497242">Len</a></span><span class="op" id="5497881">(</span><span class="op" id="5497882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5497885">for</span>&nbsp;<span class="ident" id="5497889">i</span>&nbsp;<span class="op" id="5497891">:=</span>&nbsp;<span class="num" id="5497894">0</span><span class="op" id="5497895">;</span>&nbsp;<span class="ident" id="5497897"><a href="/gostd/runtime/pprof/pprof.go.html#5497889">i</a></span>&nbsp;<span class="op" id="5497899">&lt;</span>&nbsp;<span class="ident" id="5497901"><a href="/gostd/runtime/pprof/pprof.go.html#5497871">n</a></span><span class="op" id="5497902">;</span>&nbsp;<span class="ident" id="5497904"><a href="/gostd/runtime/pprof/pprof.go.html#5497889">i</a></span><span class="op" id="5497905">++</span>&nbsp;<span class="op" id="5497908">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5497912"><a href="/gostd/runtime/pprof/pprof.go.html#5497848">m</a></span><span class="op" id="5497913">[</span><span class="ident" id="5497914"><a href="/gostd/runtime/pprof/pprof.go.html#5497683">key</a></span><span class="op" id="5497917">(</span><span class="ident" id="5497918"><a href="/gostd/runtime/pprof/pprof.go.html#5497412">p</a></span><span class="op" id="5497919">.</span><span class="ident" id="5497920"><a href="/gostd/runtime/pprof/pprof.go.html#5497253">Stack</a></span><span class="op" id="5497925">(</span><span class="ident" id="5497926"><a href="/gostd/runtime/pprof/pprof.go.html#5497889">i</a></span><span class="op" id="5497927">)</span><span class="op" id="5497928">)</span><span class="op" id="5497929">]</span><span class="op" id="5497930">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5497934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5497938">//&nbsp;Print&nbsp;stacks,&nbsp;listing&nbsp;count&nbsp;on&nbsp;first&nbsp;occurrence&nbsp;of&nbsp;a&nbsp;unique&nbsp;stack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5498009">for</span>&nbsp;<span class="ident" id="5498013">i</span>&nbsp;<span class="op" id="5498015">:=</span>&nbsp;<span class="num" id="5498018">0</span><span class="op" id="5498019">;</span>&nbsp;<span class="ident" id="5498021"><a href="/gostd/runtime/pprof/pprof.go.html#5498013">i</a></span>&nbsp;<span class="op" id="5498023">&lt;</span>&nbsp;<span class="ident" id="5498025"><a href="/gostd/runtime/pprof/pprof.go.html#5497871">n</a></span><span class="op" id="5498026">;</span>&nbsp;<span class="ident" id="5498028"><a href="/gostd/runtime/pprof/pprof.go.html#5498013">i</a></span><span class="op" id="5498029">++</span>&nbsp;<span class="op" id="5498032">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5498036">stk</span>&nbsp;<span class="op" id="5498040">:=</span>&nbsp;<span class="ident" id="5498043"><a href="/gostd/runtime/pprof/pprof.go.html#5497412">p</a></span><span class="op" id="5498044">.</span><span class="ident" id="5498045"><a href="/gostd/runtime/pprof/pprof.go.html#5497253">Stack</a></span><span class="op" id="5498050">(</span><span class="ident" id="5498051"><a href="/gostd/runtime/pprof/pprof.go.html#5498013">i</a></span><span class="op" id="5498052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5498056">s</span>&nbsp;<span class="op" id="5498058">:=</span>&nbsp;<span class="ident" id="5498061"><a href="/gostd/runtime/pprof/pprof.go.html#5497683">key</a></span><span class="op" id="5498064">(</span><span class="ident" id="5498065"><a href="/gostd/runtime/pprof/pprof.go.html#5498036">stk</a></span><span class="op" id="5498068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5498072">if</span>&nbsp;<span class="ident" id="5498075">count</span>&nbsp;<span class="op" id="5498081">:=</span>&nbsp;<span class="ident" id="5498084"><a href="/gostd/runtime/pprof/pprof.go.html#5497848">m</a></span><span class="op" id="5498085">[</span><span class="ident" id="5498086"><a href="/gostd/runtime/pprof/pprof.go.html#5498056">s</a></span><span class="op" id="5498087">]</span><span class="op" id="5498088">;</span>&nbsp;<span class="ident" id="5498090"><a href="/gostd/runtime/pprof/pprof.go.html#5498075">count</a></span>&nbsp;<span class="op" id="5498096">!=</span>&nbsp;<span class="num" id="5498099">0</span>&nbsp;<span class="op" id="5498101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5498106"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5498109">.</span><span class="ident" id="5498110"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5498117">(</span><span class="ident" id="5498118"><a href="/gostd/runtime/pprof/pprof.go.html#5497375">w</a></span><span class="op" id="5498119">,</span>&nbsp;<span class="string" id="5498121">&#34;%d&nbsp;%s\n&#34;</span><span class="op" id="5498130">,</span>&nbsp;<span class="ident" id="5498132"><a href="/gostd/runtime/pprof/pprof.go.html#5498075">count</a></span><span class="op" id="5498137">,</span>&nbsp;<span class="ident" id="5498139"><a href="/gostd/runtime/pprof/pprof.go.html#5498056">s</a></span><span class="op" id="5498140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5498145">if</span>&nbsp;<span class="ident" id="5498148"><a href="/gostd/runtime/pprof/pprof.go.html#5497388">debug</a></span>&nbsp;<span class="op" id="5498154">&gt;</span>&nbsp;<span class="num" id="5498156">0</span>&nbsp;<span class="op" id="5498158">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5498164"><a href="/gostd/runtime/pprof/pprof.go.html#5498378">printStackRecord</a></span><span class="op" id="5498180">(</span><span class="ident" id="5498181"><a href="/gostd/runtime/pprof/pprof.go.html#5497375">w</a></span><span class="op" id="5498182">,</span>&nbsp;<span class="ident" id="5498184"><a href="/gostd/runtime/pprof/pprof.go.html#5498036">stk</a></span><span class="op" id="5498187">,</span>&nbsp;<span class="builtintype" id="5498189">false</span><span class="op" id="5498194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5498199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5498204">delete</span><span class="op" id="5498210">(</span><span class="ident" id="5498211"><a href="/gostd/runtime/pprof/pprof.go.html#5497848">m</a></span><span class="op" id="5498212">,</span>&nbsp;<span class="ident" id="5498214"><a href="/gostd/runtime/pprof/pprof.go.html#5498056">s</a></span><span class="op" id="5498215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5498219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5498222">}</span><br>
<span class="lineno">310</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5498226">if</span>&nbsp;<span class="ident" id="5498229"><a href="/gostd/runtime/pprof/pprof.go.html#5497466">tw</a></span>&nbsp;<span class="op" id="5498232">!=</span>&nbsp;<span class="builtintype" id="5498235">nil</span>&nbsp;<span class="op" id="5498239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5498243"><a href="/gostd/runtime/pprof/pprof.go.html#5497466">tw</a></span><span class="op" id="5498245">.</span><span class="ident" id="5498246"><a href="/gostd/text/tabwriter/tabwriter.go.html#5522354">Flush</a></span><span class="op" id="5498251">(</span><span class="op" id="5498252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5498255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5498258">return</span>&nbsp;<span class="ident" id="5498265"><a href="/gostd/runtime/pprof/pprof.go.html#5497437">b</a></span><span class="op" id="5498266">.</span><span class="ident" id="5498267"><a href="/gostd/bufio/bufio.go.html#1367486">Flush</a></span><span class="op" id="5498272">(</span><span class="op" id="5498273">)</span><br>
<span class="lineno">315</span><span class="op" id="5498275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5498278">//&nbsp;printStackRecord&nbsp;prints&nbsp;the&nbsp;function&nbsp;+&nbsp;source&nbsp;line&nbsp;information</span><br>
<span class="lineno"></span><span class="comment" id="5498344">//&nbsp;for&nbsp;a&nbsp;single&nbsp;stack&nbsp;trace.</span><br>
<span class="lineno"></span><span class="keyword" id="5498373">func</span>&nbsp;<span class="ident" id="5498378">printStackRecord</span><span class="op" id="5498394">(</span><span class="ident" id="5498395">w</span>&nbsp;<span class="ident" id="5498397"><a href="/gostd/runtime/pprof/pprof.go.html#5490138">io</a></span><span class="op" id="5498399">.</span><span class="ident" id="5498400"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="5498406">,</span>&nbsp;<span class="ident" id="5498408">stk</span>&nbsp;<span class="op" id="5498412">[</span><span class="op" id="5498413">]</span><span class="builtintype" id="5498414">uintptr</span><span class="op" id="5498421">,</span>&nbsp;<span class="ident" id="5498423">allFrames</span>&nbsp;<span class="builtintype" id="5498433">bool</span><span class="op" id="5498437">)</span>&nbsp;<span class="op" id="5498439">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5498442">show</span>&nbsp;<span class="op" id="5498447">:=</span>&nbsp;<span class="ident" id="5498450"><a href="/gostd/runtime/pprof/pprof.go.html#5498423">allFrames</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5498461">wasPanic</span>&nbsp;<span class="op" id="5498470">:=</span>&nbsp;<span class="builtintype" id="5498473">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5498480">for</span>&nbsp;<span class="ident" id="5498484">i</span><span class="op" id="5498485">,</span>&nbsp;<span class="ident" id="5498487">pc</span>&nbsp;<span class="op" id="5498490">:=</span>&nbsp;<span class="keyword" id="5498493">range</span>&nbsp;<span class="ident" id="5498499"><a href="/gostd/runtime/pprof/pprof.go.html#5498408">stk</a></span>&nbsp;<span class="op" id="5498503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5498507">f</span>&nbsp;<span class="op" id="5498509">:=</span>&nbsp;<span class="ident" id="5498512"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5498519">.</span><span class="ident" id="5498520"><a href="/gostd/runtime/symtab.go.html#1752271">FuncForPC</a></span><span class="op" id="5498529">(</span><span class="ident" id="5498530"><a href="/gostd/runtime/pprof/pprof.go.html#5498487">pc</a></span><span class="op" id="5498532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5498536">if</span>&nbsp;<span class="ident" id="5498539"><a href="/gostd/runtime/pprof/pprof.go.html#5498507">f</a></span>&nbsp;<span class="op" id="5498541">==</span>&nbsp;<span class="builtintype" id="5498544">nil</span>&nbsp;<span class="op" id="5498548">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5498553"><a href="/gostd/runtime/pprof/pprof.go.html#5498442">show</a></span>&nbsp;<span class="op" id="5498558">=</span>&nbsp;<span class="builtintype" id="5498560">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5498568"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5498571">.</span><span class="ident" id="5498572"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5498579">(</span><span class="ident" id="5498580"><a href="/gostd/runtime/pprof/pprof.go.html#5498395">w</a></span><span class="op" id="5498581">,</span>&nbsp;<span class="string" id="5498583">&#34;#\t%#x\n&#34;</span><span class="op" id="5498593">,</span>&nbsp;<span class="ident" id="5498595"><a href="/gostd/runtime/pprof/pprof.go.html#5498487">pc</a></span><span class="op" id="5498597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5498602"><a href="/gostd/runtime/pprof/pprof.go.html#5498461">wasPanic</a></span>&nbsp;<span class="op" id="5498611">=</span>&nbsp;<span class="builtintype" id="5498613">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5498621">}</span>&nbsp;<span class="keyword" id="5498623">else</span>&nbsp;<span class="op" id="5498628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5498633">tracepc</span>&nbsp;<span class="op" id="5498641">:=</span>&nbsp;<span class="ident" id="5498644"><a href="/gostd/runtime/pprof/pprof.go.html#5498487">pc</a></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5498650">//&nbsp;Back&nbsp;up&nbsp;to&nbsp;call&nbsp;instruction.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5498685">if</span>&nbsp;<span class="ident" id="5498688"><a href="/gostd/runtime/pprof/pprof.go.html#5498484">i</a></span>&nbsp;<span class="op" id="5498690">&gt;</span>&nbsp;<span class="num" id="5498692">0</span>&nbsp;<span class="op" id="5498694">&amp;&amp;</span>&nbsp;<span class="ident" id="5498697"><a href="/gostd/runtime/pprof/pprof.go.html#5498487">pc</a></span>&nbsp;<span class="op" id="5498700">&gt;</span>&nbsp;<span class="ident" id="5498702"><a href="/gostd/runtime/pprof/pprof.go.html#5498507">f</a></span><span class="op" id="5498703">.</span><span class="ident" id="5498704"><a href="/gostd/runtime/symtab.go.html#1752521">Entry</a></span><span class="op" id="5498709">(</span><span class="op" id="5498710">)</span>&nbsp;<span class="op" id="5498712">&amp;&amp;</span>&nbsp;<span class="op" id="5498715">!</span><span class="ident" id="5498716"><a href="/gostd/runtime/pprof/pprof.go.html#5498461">wasPanic</a></span>&nbsp;<span class="op" id="5498725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5498731">if</span>&nbsp;<span class="ident" id="5498734"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5498741">.</span><span class="ident" id="5498742"><a href="/gostd/runtime/extern.go.html#1533781">GOARCH</a></span>&nbsp;<span class="op" id="5498749">==</span>&nbsp;<span class="string" id="5498752">&#34;386&#34;</span>&nbsp;<span class="op" id="5498758">||</span>&nbsp;<span class="ident" id="5498761"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5498768">.</span><span class="ident" id="5498769"><a href="/gostd/runtime/extern.go.html#1533781">GOARCH</a></span>&nbsp;<span class="op" id="5498776">==</span>&nbsp;<span class="string" id="5498779">&#34;amd64&#34;</span>&nbsp;<span class="op" id="5498787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5498794"><a href="/gostd/runtime/pprof/pprof.go.html#5498633">tracepc</a></span><span class="op" id="5498801">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5498808">}</span>&nbsp;<span class="keyword" id="5498810">else</span>&nbsp;<span class="op" id="5498815">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5498822"><a href="/gostd/runtime/pprof/pprof.go.html#5498633">tracepc</a></span>&nbsp;<span class="op" id="5498830">-=</span>&nbsp;<span class="num" id="5498833">4</span>&nbsp;<span class="comment" id="5498835">//&nbsp;arm,&nbsp;etc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5498851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5498856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5498861">file</span><span class="op" id="5498865">,</span>&nbsp;<span class="ident" id="5498867">line</span>&nbsp;<span class="op" id="5498872">:=</span>&nbsp;<span class="ident" id="5498875"><a href="/gostd/runtime/pprof/pprof.go.html#5498507">f</a></span><span class="op" id="5498876">.</span><span class="ident" id="5498877"><a href="/gostd/runtime/symtab.go.html#1752771">FileLine</a></span><span class="op" id="5498885">(</span><span class="ident" id="5498886"><a href="/gostd/runtime/pprof/pprof.go.html#5498633">tracepc</a></span><span class="op" id="5498893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5498898">name</span>&nbsp;<span class="op" id="5498903">:=</span>&nbsp;<span class="ident" id="5498906"><a href="/gostd/runtime/pprof/pprof.go.html#5498507">f</a></span><span class="op" id="5498907">.</span><span class="ident" id="5498908"><a href="/gostd/runtime/symtab.go.html#1752407">Name</a></span><span class="op" id="5498912">(</span><span class="op" id="5498913">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5498918">//&nbsp;Hide&nbsp;runtime.goexit&nbsp;and&nbsp;any&nbsp;runtime&nbsp;functions&nbsp;at&nbsp;the&nbsp;beginning.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5498988">//&nbsp;This&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;allocation&nbsp;traces.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5499039"><a href="/gostd/runtime/pprof/pprof.go.html#5498461">wasPanic</a></span>&nbsp;<span class="op" id="5499048">=</span>&nbsp;<span class="ident" id="5499050"><a href="/gostd/runtime/pprof/pprof.go.html#5498898">name</a></span>&nbsp;<span class="op" id="5499055">==</span>&nbsp;<span class="string" id="5499058">&#34;runtime.panic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5499077">if</span>&nbsp;<span class="ident" id="5499080"><a href="/gostd/runtime/pprof/pprof.go.html#5498898">name</a></span>&nbsp;<span class="op" id="5499085">==</span>&nbsp;<span class="string" id="5499088">&#34;runtime.goexit&#34;</span>&nbsp;<span class="op" id="5499105">||</span>&nbsp;<span class="op" id="5499108">!</span><span class="ident" id="5499109"><a href="/gostd/runtime/pprof/pprof.go.html#5498442">show</a></span>&nbsp;<span class="op" id="5499114">&amp;&amp;</span>&nbsp;<span class="ident" id="5499117"><a href="/gostd/runtime/pprof/pprof.go.html#5490163">strings</a></span><span class="op" id="5499124">.</span><span class="ident" id="5499125"><a href="/gostd/strings/strings.go.html#2975366">HasPrefix</a></span><span class="op" id="5499134">(</span><span class="ident" id="5499135"><a href="/gostd/runtime/pprof/pprof.go.html#5498898">name</a></span><span class="op" id="5499139">,</span>&nbsp;<span class="string" id="5499141">&#34;runtime.&#34;</span><span class="op" id="5499151">)</span>&nbsp;<span class="op" id="5499153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5499159">continue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5499171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5499176"><a href="/gostd/runtime/pprof/pprof.go.html#5498442">show</a></span>&nbsp;<span class="op" id="5499181">=</span>&nbsp;<span class="builtintype" id="5499183">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5499191"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5499194">.</span><span class="ident" id="5499195"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5499202">(</span><span class="ident" id="5499203"><a href="/gostd/runtime/pprof/pprof.go.html#5498395">w</a></span><span class="op" id="5499204">,</span>&nbsp;<span class="string" id="5499206">&#34;#\t%#x\t%s+%#x\t%s:%d\n&#34;</span><span class="op" id="5499231">,</span>&nbsp;<span class="ident" id="5499233"><a href="/gostd/runtime/pprof/pprof.go.html#5498487">pc</a></span><span class="op" id="5499235">,</span>&nbsp;<span class="ident" id="5499237"><a href="/gostd/runtime/pprof/pprof.go.html#5498898">name</a></span><span class="op" id="5499241">,</span>&nbsp;<span class="ident" id="5499243"><a href="/gostd/runtime/pprof/pprof.go.html#5498487">pc</a></span><span class="op" id="5499245">-</span><span class="ident" id="5499246"><a href="/gostd/runtime/pprof/pprof.go.html#5498507">f</a></span><span class="op" id="5499247">.</span><span class="ident" id="5499248"><a href="/gostd/runtime/symtab.go.html#1752521">Entry</a></span><span class="op" id="5499253">(</span><span class="op" id="5499254">)</span><span class="op" id="5499255">,</span>&nbsp;<span class="ident" id="5499257"><a href="/gostd/runtime/pprof/pprof.go.html#5498861">file</a></span><span class="op" id="5499261">,</span>&nbsp;<span class="ident" id="5499263"><a href="/gostd/runtime/pprof/pprof.go.html#5498867">line</a></span><span class="op" id="5499267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5499271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5499274">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5499277">if</span>&nbsp;<span class="op" id="5499280">!</span><span class="ident" id="5499281"><a href="/gostd/runtime/pprof/pprof.go.html#5498442">show</a></span>&nbsp;<span class="op" id="5499286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5499290">//&nbsp;We&nbsp;didn&#39;t&nbsp;print&nbsp;anything;&nbsp;do&nbsp;it&nbsp;again,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5499334">//&nbsp;and&nbsp;this&nbsp;time&nbsp;include&nbsp;runtime&nbsp;functions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5499380"><a href="/gostd/runtime/pprof/pprof.go.html#5498378">printStackRecord</a></span><span class="op" id="5499396">(</span><span class="ident" id="5499397"><a href="/gostd/runtime/pprof/pprof.go.html#5498395">w</a></span><span class="op" id="5499398">,</span>&nbsp;<span class="ident" id="5499400"><a href="/gostd/runtime/pprof/pprof.go.html#5498408">stk</a></span><span class="op" id="5499403">,</span>&nbsp;<span class="builtintype" id="5499405">true</span><span class="op" id="5499409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5499413">return</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5499421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5499424"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5499427">.</span><span class="ident" id="5499428"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5499435">(</span><span class="ident" id="5499436"><a href="/gostd/runtime/pprof/pprof.go.html#5498395">w</a></span><span class="op" id="5499437">,</span>&nbsp;<span class="string" id="5499439">&#34;\n&#34;</span><span class="op" id="5499443">)</span><br>
<span class="lineno"></span><span class="op" id="5499445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5499448">//&nbsp;Interface&nbsp;to&nbsp;system&nbsp;profiles.</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="5499482">type</span>&nbsp;<span class="ident" id="5499487">byInUseBytes</span>&nbsp;<span class="op" id="5499500">[</span><span class="op" id="5499501">]</span><span class="ident" id="5499502"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5499509">.</span><span class="ident" id="5499510"><a href="/gostd/runtime/mprof.go.html#1628795">MemProfileRecord</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5499528">func</span>&nbsp;<span class="op" id="5499533">(</span><span class="ident" id="5499534">x</span>&nbsp;<span class="ident" id="5499536"><a href="/gostd/runtime/pprof/pprof.go.html#5499487">byInUseBytes</a></span><span class="op" id="5499548">)</span>&nbsp;<span class="ident" id="5499550">Len</span><span class="op" id="5499553">(</span><span class="op" id="5499554">)</span>&nbsp;<span class="builtintype" id="5499556">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5499570">{</span>&nbsp;<span class="keyword" id="5499572">return</span>&nbsp;<span class="builtinfunc" id="5499579">len</span><span class="op" id="5499582">(</span><span class="ident" id="5499583"><a href="/gostd/runtime/pprof/pprof.go.html#5499534">x</a></span><span class="op" id="5499584">)</span>&nbsp;<span class="op" id="5499586">}</span><br>
<span class="lineno"></span><span class="keyword" id="5499588">func</span>&nbsp;<span class="op" id="5499593">(</span><span class="ident" id="5499594">x</span>&nbsp;<span class="ident" id="5499596"><a href="/gostd/runtime/pprof/pprof.go.html#5499487">byInUseBytes</a></span><span class="op" id="5499608">)</span>&nbsp;<span class="ident" id="5499610">Swap</span><span class="op" id="5499614">(</span><span class="ident" id="5499615">i</span><span class="op" id="5499616">,</span>&nbsp;<span class="ident" id="5499618">j</span>&nbsp;<span class="builtintype" id="5499620">int</span><span class="op" id="5499623">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5499630">{</span>&nbsp;<span class="ident" id="5499632"><a href="/gostd/runtime/pprof/pprof.go.html#5499594">x</a></span><span class="op" id="5499633">[</span><span class="ident" id="5499634"><a href="/gostd/runtime/pprof/pprof.go.html#5499615">i</a></span><span class="op" id="5499635">]</span><span class="op" id="5499636">,</span>&nbsp;<span class="ident" id="5499638"><a href="/gostd/runtime/pprof/pprof.go.html#5499594">x</a></span><span class="op" id="5499639">[</span><span class="ident" id="5499640"><a href="/gostd/runtime/pprof/pprof.go.html#5499618">j</a></span><span class="op" id="5499641">]</span>&nbsp;<span class="op" id="5499643">=</span>&nbsp;<span class="ident" id="5499645"><a href="/gostd/runtime/pprof/pprof.go.html#5499594">x</a></span><span class="op" id="5499646">[</span><span class="ident" id="5499647"><a href="/gostd/runtime/pprof/pprof.go.html#5499618">j</a></span><span class="op" id="5499648">]</span><span class="op" id="5499649">,</span>&nbsp;<span class="ident" id="5499651"><a href="/gostd/runtime/pprof/pprof.go.html#5499594">x</a></span><span class="op" id="5499652">[</span><span class="ident" id="5499653"><a href="/gostd/runtime/pprof/pprof.go.html#5499615">i</a></span><span class="op" id="5499654">]</span>&nbsp;<span class="op" id="5499656">}</span><br>
<span class="lineno">365</span><span class="keyword" id="5499658">func</span>&nbsp;<span class="op" id="5499663">(</span><span class="ident" id="5499664">x</span>&nbsp;<span class="ident" id="5499666"><a href="/gostd/runtime/pprof/pprof.go.html#5499487">byInUseBytes</a></span><span class="op" id="5499678">)</span>&nbsp;<span class="ident" id="5499680">Less</span><span class="op" id="5499684">(</span><span class="ident" id="5499685">i</span><span class="op" id="5499686">,</span>&nbsp;<span class="ident" id="5499688">j</span>&nbsp;<span class="builtintype" id="5499690">int</span><span class="op" id="5499693">)</span>&nbsp;<span class="builtintype" id="5499695">bool</span>&nbsp;<span class="op" id="5499700">{</span>&nbsp;<span class="keyword" id="5499702">return</span>&nbsp;<span class="ident" id="5499709"><a href="/gostd/runtime/pprof/pprof.go.html#5499664">x</a></span><span class="op" id="5499710">[</span><span class="ident" id="5499711"><a href="/gostd/runtime/pprof/pprof.go.html#5499685">i</a></span><span class="op" id="5499712">]</span><span class="op" id="5499713">.</span><span class="ident" id="5499714"><a href="/gostd/runtime/mprof.go.html#1629171">InUseBytes</a></span><span class="op" id="5499724">(</span><span class="op" id="5499725">)</span>&nbsp;<span class="op" id="5499727">&gt;</span>&nbsp;<span class="ident" id="5499729"><a href="/gostd/runtime/pprof/pprof.go.html#5499664">x</a></span><span class="op" id="5499730">[</span><span class="ident" id="5499731"><a href="/gostd/runtime/pprof/pprof.go.html#5499688">j</a></span><span class="op" id="5499732">]</span><span class="op" id="5499733">.</span><span class="ident" id="5499734"><a href="/gostd/runtime/mprof.go.html#1629171">InUseBytes</a></span><span class="op" id="5499744">(</span><span class="op" id="5499745">)</span>&nbsp;<span class="op" id="5499747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5499750">//&nbsp;WriteHeapProfile&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;Lookup(&#34;heap&#34;).WriteTo(w,&nbsp;0).</span><br>
<span class="lineno"></span><span class="comment" id="5499817">//&nbsp;It&nbsp;is&nbsp;preserved&nbsp;for&nbsp;backwards&nbsp;compatibility.</span><br>
<span class="lineno"></span><span class="keyword" id="5499865">func</span>&nbsp;<span class="ident" id="5499870">WriteHeapProfile</span><span class="op" id="5499886">(</span><span class="ident" id="5499887">w</span>&nbsp;<span class="ident" id="5499889"><a href="/gostd/runtime/pprof/pprof.go.html#5490138">io</a></span><span class="op" id="5499891">.</span><span class="ident" id="5499892"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="5499898">)</span>&nbsp;<span class="builtintype" id="5499900">error</span>&nbsp;<span class="op" id="5499906">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5499909">return</span>&nbsp;<span class="ident" id="5499916"><a href="/gostd/runtime/pprof/pprof.go.html#5500138">writeHeap</a></span><span class="op" id="5499925">(</span><span class="ident" id="5499926"><a href="/gostd/runtime/pprof/pprof.go.html#5499887">w</a></span><span class="op" id="5499927">,</span>&nbsp;<span class="num" id="5499929">0</span><span class="op" id="5499930">)</span><br>
<span class="lineno"></span><span class="op" id="5499932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5499935">//&nbsp;countHeap&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;records&nbsp;in&nbsp;the&nbsp;heap&nbsp;profile.</span><br>
<span class="lineno"></span><span class="keyword" id="5499999">func</span>&nbsp;<span class="ident" id="5500004">countHeap</span><span class="op" id="5500013">(</span><span class="op" id="5500014">)</span>&nbsp;<span class="builtintype" id="5500016">int</span>&nbsp;<span class="op" id="5500020">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5500023">n</span><span class="op" id="5500024">,</span>&nbsp;<span class="ident" id="5500026">_</span>&nbsp;<span class="op" id="5500028">:=</span>&nbsp;<span class="ident" id="5500031"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5500038">.</span><span class="ident" id="5500039"><a href="/gostd/runtime/mprof.go.html#1630241">MemProfile</a></span><span class="op" id="5500049">(</span><span class="builtintype" id="5500050">nil</span><span class="op" id="5500053">,</span>&nbsp;<span class="builtintype" id="5500055">true</span><span class="op" id="5500059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5500062">return</span>&nbsp;<span class="ident" id="5500069"><a href="/gostd/runtime/pprof/pprof.go.html#5500023">n</a></span><br>
<span class="lineno"></span><span class="op" id="5500071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5500074">//&nbsp;writeHeap&nbsp;writes&nbsp;the&nbsp;current&nbsp;runtime&nbsp;heap&nbsp;profile&nbsp;to&nbsp;w.</span><br>
<span class="lineno">380</span><span class="keyword" id="5500133">func</span>&nbsp;<span class="ident" id="5500138">writeHeap</span><span class="op" id="5500147">(</span><span class="ident" id="5500148">w</span>&nbsp;<span class="ident" id="5500150"><a href="/gostd/runtime/pprof/pprof.go.html#5490138">io</a></span><span class="op" id="5500152">.</span><span class="ident" id="5500153"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="5500159">,</span>&nbsp;<span class="ident" id="5500161">debug</span>&nbsp;<span class="builtintype" id="5500167">int</span><span class="op" id="5500170">)</span>&nbsp;<span class="builtintype" id="5500172">error</span>&nbsp;<span class="op" id="5500178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5500181">//&nbsp;Find&nbsp;out&nbsp;how&nbsp;many&nbsp;records&nbsp;there&nbsp;are&nbsp;(MemProfile(nil,&nbsp;true)),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5500246">//&nbsp;allocate&nbsp;that&nbsp;many&nbsp;records,&nbsp;and&nbsp;get&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5500296">//&nbsp;There&#39;s&nbsp;a&nbsp;racemore&nbsp;records&nbsp;might&nbsp;be&nbsp;added&nbsp;between</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5500353">//&nbsp;the&nbsp;two&nbsp;callsso&nbsp;allocate&nbsp;a&nbsp;few&nbsp;extra&nbsp;records&nbsp;for&nbsp;safety</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5500416">//&nbsp;and&nbsp;also&nbsp;try&nbsp;again&nbsp;if&nbsp;we&#39;re&nbsp;very&nbsp;unlucky.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5500462">//&nbsp;The&nbsp;loop&nbsp;should&nbsp;only&nbsp;execute&nbsp;one&nbsp;iteration&nbsp;in&nbsp;the&nbsp;common&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5500529">var</span>&nbsp;<span class="ident" id="5500533">p</span>&nbsp;<span class="op" id="5500535">[</span><span class="op" id="5500536">]</span><span class="ident" id="5500537"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5500544">.</span><span class="ident" id="5500545"><a href="/gostd/runtime/mprof.go.html#1628795">MemProfileRecord</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5500563">n</span><span class="op" id="5500564">,</span>&nbsp;<span class="ident" id="5500566">ok</span>&nbsp;<span class="op" id="5500569">:=</span>&nbsp;<span class="ident" id="5500572"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5500579">.</span><span class="ident" id="5500580"><a href="/gostd/runtime/mprof.go.html#1630241">MemProfile</a></span><span class="op" id="5500590">(</span><span class="builtintype" id="5500591">nil</span><span class="op" id="5500594">,</span>&nbsp;<span class="builtintype" id="5500596">true</span><span class="op" id="5500600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5500603">for</span>&nbsp;<span class="op" id="5500607">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5500611">//&nbsp;Allocate&nbsp;room&nbsp;for&nbsp;a&nbsp;slightly&nbsp;bigger&nbsp;profile,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5500661">//&nbsp;in&nbsp;case&nbsp;a&nbsp;few&nbsp;more&nbsp;entries&nbsp;have&nbsp;been&nbsp;added</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5500709">//&nbsp;since&nbsp;the&nbsp;call&nbsp;to&nbsp;MemProfile.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5500744"><a href="/gostd/runtime/pprof/pprof.go.html#5500533">p</a></span>&nbsp;<span class="op" id="5500746">=</span>&nbsp;<span class="builtinfunc" id="5500748">make</span><span class="op" id="5500752">(</span><span class="op" id="5500753">[</span><span class="op" id="5500754">]</span><span class="ident" id="5500755"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5500762">.</span><span class="ident" id="5500763"><a href="/gostd/runtime/mprof.go.html#1628795">MemProfileRecord</a></span><span class="op" id="5500779">,</span>&nbsp;<span class="ident" id="5500781"><a href="/gostd/runtime/pprof/pprof.go.html#5500563">n</a></span><span class="op" id="5500782">+</span><span class="num" id="5500783">50</span><span class="op" id="5500785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5500789"><a href="/gostd/runtime/pprof/pprof.go.html#5500563">n</a></span><span class="op" id="5500790">,</span>&nbsp;<span class="ident" id="5500792"><a href="/gostd/runtime/pprof/pprof.go.html#5500566">ok</a></span>&nbsp;<span class="op" id="5500795">=</span>&nbsp;<span class="ident" id="5500797"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5500804">.</span><span class="ident" id="5500805"><a href="/gostd/runtime/mprof.go.html#1630241">MemProfile</a></span><span class="op" id="5500815">(</span><span class="ident" id="5500816"><a href="/gostd/runtime/pprof/pprof.go.html#5500533">p</a></span><span class="op" id="5500817">,</span>&nbsp;<span class="builtintype" id="5500819">true</span><span class="op" id="5500823">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5500827">if</span>&nbsp;<span class="ident" id="5500830"><a href="/gostd/runtime/pprof/pprof.go.html#5500566">ok</a></span>&nbsp;<span class="op" id="5500833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5500838"><a href="/gostd/runtime/pprof/pprof.go.html#5500533">p</a></span>&nbsp;<span class="op" id="5500840">=</span>&nbsp;<span class="ident" id="5500842"><a href="/gostd/runtime/pprof/pprof.go.html#5500533">p</a></span><span class="op" id="5500843">[</span><span class="num" id="5500844">0</span><span class="op" id="5500845">:</span><span class="ident" id="5500846"><a href="/gostd/runtime/pprof/pprof.go.html#5500563">n</a></span><span class="op" id="5500847">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5500852">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5500860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5500864">//&nbsp;Profile&nbsp;grew;&nbsp;try&nbsp;again.</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5500893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5500897"><a href="/gostd/runtime/pprof/pprof.go.html#5490155">sort</a></span><span class="op" id="5500901">.</span><span class="ident" id="5500902"><a href="/gostd/sort/sort.go.html#2015380">Sort</a></span><span class="op" id="5500906">(</span><span class="ident" id="5500907"><a href="/gostd/runtime/pprof/pprof.go.html#5499487">byInUseBytes</a></span><span class="op" id="5500919">(</span><span class="ident" id="5500920"><a href="/gostd/runtime/pprof/pprof.go.html#5500533">p</a></span><span class="op" id="5500921">)</span><span class="op" id="5500922">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5500926">b</span>&nbsp;<span class="op" id="5500928">:=</span>&nbsp;<span class="ident" id="5500931"><a href="/gostd/runtime/pprof/pprof.go.html#5490113">bufio</a></span><span class="op" id="5500936">.</span><span class="ident" id="5500937"><a href="/gostd/bufio/bufio.go.html#1367149">NewWriter</a></span><span class="op" id="5500946">(</span><span class="ident" id="5500947"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5500948">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5500951">var</span>&nbsp;<span class="ident" id="5500955">tw</span>&nbsp;<span class="op" id="5500958">*</span><span class="ident" id="5500959"><a href="/gostd/runtime/pprof/pprof.go.html#5490182">tabwriter</a></span><span class="op" id="5500968">.</span><span class="ident" id="5500969"><a href="/gostd/text/tabwriter/tabwriter.go.html#5511646">Writer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5500977"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span>&nbsp;<span class="op" id="5500979">=</span>&nbsp;<span class="ident" id="5500981"><a href="/gostd/runtime/pprof/pprof.go.html#5500926">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5500984">if</span>&nbsp;<span class="ident" id="5500987"><a href="/gostd/runtime/pprof/pprof.go.html#5500161">debug</a></span>&nbsp;<span class="op" id="5500993">&gt;</span>&nbsp;<span class="num" id="5500995">0</span>&nbsp;<span class="op" id="5500997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5501001"><a href="/gostd/runtime/pprof/pprof.go.html#5500955">tw</a></span>&nbsp;<span class="op" id="5501004">=</span>&nbsp;<span class="ident" id="5501006"><a href="/gostd/runtime/pprof/pprof.go.html#5490182">tabwriter</a></span><span class="op" id="5501015">.</span><span class="ident" id="5501016"><a href="/gostd/text/tabwriter/tabwriter.go.html#5524689">NewWriter</a></span><span class="op" id="5501025">(</span><span class="ident" id="5501026"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5501027">,</span>&nbsp;<span class="num" id="5501029">1</span><span class="op" id="5501030">,</span>&nbsp;<span class="num" id="5501032">8</span><span class="op" id="5501033">,</span>&nbsp;<span class="num" id="5501035">1</span><span class="op" id="5501036">,</span>&nbsp;<span class="string" id="5501038">&#39;\t&#39;</span><span class="op" id="5501042">,</span>&nbsp;<span class="num" id="5501044">0</span><span class="op" id="5501045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5501049"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span>&nbsp;<span class="op" id="5501051">=</span>&nbsp;<span class="ident" id="5501053"><a href="/gostd/runtime/pprof/pprof.go.html#5500955">tw</a></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5501057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5501061">var</span>&nbsp;<span class="ident" id="5501065">total</span>&nbsp;<span class="ident" id="5501071"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5501078">.</span><span class="ident" id="5501079"><a href="/gostd/runtime/mprof.go.html#1628795">MemProfileRecord</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5501097">for</span>&nbsp;<span class="ident" id="5501101">i</span>&nbsp;<span class="op" id="5501103">:=</span>&nbsp;<span class="keyword" id="5501106">range</span>&nbsp;<span class="ident" id="5501112"><a href="/gostd/runtime/pprof/pprof.go.html#5500533">p</a></span>&nbsp;<span class="op" id="5501114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5501118">r</span>&nbsp;<span class="op" id="5501120">:=</span>&nbsp;<span class="op" id="5501123">&amp;</span><span class="ident" id="5501124"><a href="/gostd/runtime/pprof/pprof.go.html#5500533">p</a></span><span class="op" id="5501125">[</span><span class="ident" id="5501126"><a href="/gostd/runtime/pprof/pprof.go.html#5501101">i</a></span><span class="op" id="5501127">]</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5501131"><a href="/gostd/runtime/pprof/pprof.go.html#5501065">total</a></span><span class="op" id="5501136">.</span><span class="ident" id="5501137"><a href="/gostd/runtime/mprof.go.html#1628822">AllocBytes</a></span>&nbsp;<span class="op" id="5501148">+=</span>&nbsp;<span class="ident" id="5501151"><a href="/gostd/runtime/pprof/pprof.go.html#5501118">r</a></span><span class="op" id="5501152">.</span><span class="ident" id="5501153"><a href="/gostd/runtime/mprof.go.html#1628822">AllocBytes</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5501166"><a href="/gostd/runtime/pprof/pprof.go.html#5501065">total</a></span><span class="op" id="5501171">.</span><span class="ident" id="5501172"><a href="/gostd/runtime/mprof.go.html#1628897">AllocObjects</a></span>&nbsp;<span class="op" id="5501185">+=</span>&nbsp;<span class="ident" id="5501188"><a href="/gostd/runtime/pprof/pprof.go.html#5501118">r</a></span><span class="op" id="5501189">.</span><span class="ident" id="5501190"><a href="/gostd/runtime/mprof.go.html#1628897">AllocObjects</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5501205"><a href="/gostd/runtime/pprof/pprof.go.html#5501065">total</a></span><span class="op" id="5501210">.</span><span class="ident" id="5501211"><a href="/gostd/runtime/mprof.go.html#1628834">FreeBytes</a></span>&nbsp;<span class="op" id="5501221">+=</span>&nbsp;<span class="ident" id="5501224"><a href="/gostd/runtime/pprof/pprof.go.html#5501118">r</a></span><span class="op" id="5501225">.</span><span class="ident" id="5501226"><a href="/gostd/runtime/mprof.go.html#1628834">FreeBytes</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5501238"><a href="/gostd/runtime/pprof/pprof.go.html#5501065">total</a></span><span class="op" id="5501243">.</span><span class="ident" id="5501244"><a href="/gostd/runtime/mprof.go.html#1628911">FreeObjects</a></span>&nbsp;<span class="op" id="5501256">+=</span>&nbsp;<span class="ident" id="5501259"><a href="/gostd/runtime/pprof/pprof.go.html#5501118">r</a></span><span class="op" id="5501260">.</span><span class="ident" id="5501261"><a href="/gostd/runtime/mprof.go.html#1628911">FreeObjects</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5501274">}</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5501278">//&nbsp;Technically&nbsp;the&nbsp;rate&nbsp;is&nbsp;MemProfileRate&nbsp;not&nbsp;2*MemProfileRate,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5501343">//&nbsp;but&nbsp;early&nbsp;versions&nbsp;of&nbsp;the&nbsp;C++&nbsp;heap&nbsp;profiler&nbsp;reported&nbsp;2*MemProfileRate,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5501418">//&nbsp;so&nbsp;that&#39;s&nbsp;what&nbsp;pprof&nbsp;has&nbsp;come&nbsp;to&nbsp;expect.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5501463"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5501466">.</span><span class="ident" id="5501467"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5501474">(</span><span class="ident" id="5501475"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5501476">,</span>&nbsp;<span class="string" id="5501478">&#34;heap&nbsp;profile:&nbsp;%d:&nbsp;%d&nbsp;[%d:&nbsp;%d]&nbsp;@&nbsp;heap/%d\n&#34;</span><span class="op" id="5501521">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5501525"><a href="/gostd/runtime/pprof/pprof.go.html#5501065">total</a></span><span class="op" id="5501530">.</span><span class="ident" id="5501531"><a href="/gostd/runtime/mprof.go.html#1629339">InUseObjects</a></span><span class="op" id="5501543">(</span><span class="op" id="5501544">)</span><span class="op" id="5501545">,</span>&nbsp;<span class="ident" id="5501547"><a href="/gostd/runtime/pprof/pprof.go.html#5501065">total</a></span><span class="op" id="5501552">.</span><span class="ident" id="5501553"><a href="/gostd/runtime/mprof.go.html#1629171">InUseBytes</a></span><span class="op" id="5501563">(</span><span class="op" id="5501564">)</span><span class="op" id="5501565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5501569"><a href="/gostd/runtime/pprof/pprof.go.html#5501065">total</a></span><span class="op" id="5501574">.</span><span class="ident" id="5501575"><a href="/gostd/runtime/mprof.go.html#1628897">AllocObjects</a></span><span class="op" id="5501587">,</span>&nbsp;<span class="ident" id="5501589"><a href="/gostd/runtime/pprof/pprof.go.html#5501065">total</a></span><span class="op" id="5501594">.</span><span class="ident" id="5501595"><a href="/gostd/runtime/mprof.go.html#1628822">AllocBytes</a></span><span class="op" id="5501605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5501609">2</span><span class="op" id="5501610">*</span><span class="ident" id="5501611"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5501618">.</span><span class="ident" id="5501619"><a href="/gostd/runtime/mprof.go.html#1628650">MemProfileRate</a></span><span class="op" id="5501633">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5501637">for</span>&nbsp;<span class="ident" id="5501641">i</span>&nbsp;<span class="op" id="5501643">:=</span>&nbsp;<span class="keyword" id="5501646">range</span>&nbsp;<span class="ident" id="5501652"><a href="/gostd/runtime/pprof/pprof.go.html#5500533">p</a></span>&nbsp;<span class="op" id="5501654">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5501658">r</span>&nbsp;<span class="op" id="5501660">:=</span>&nbsp;<span class="op" id="5501663">&amp;</span><span class="ident" id="5501664"><a href="/gostd/runtime/pprof/pprof.go.html#5500533">p</a></span><span class="op" id="5501665">[</span><span class="ident" id="5501666"><a href="/gostd/runtime/pprof/pprof.go.html#5501641">i</a></span><span class="op" id="5501667">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5501671"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5501674">.</span><span class="ident" id="5501675"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5501682">(</span><span class="ident" id="5501683"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5501684">,</span>&nbsp;<span class="string" id="5501686">&#34;%d:&nbsp;%d&nbsp;[%d:&nbsp;%d]&nbsp;@&#34;</span><span class="op" id="5501705">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5501710"><a href="/gostd/runtime/pprof/pprof.go.html#5501658">r</a></span><span class="op" id="5501711">.</span><span class="ident" id="5501712"><a href="/gostd/runtime/mprof.go.html#1629339">InUseObjects</a></span><span class="op" id="5501724">(</span><span class="op" id="5501725">)</span><span class="op" id="5501726">,</span>&nbsp;<span class="ident" id="5501728"><a href="/gostd/runtime/pprof/pprof.go.html#5501658">r</a></span><span class="op" id="5501729">.</span><span class="ident" id="5501730"><a href="/gostd/runtime/mprof.go.html#1629171">InUseBytes</a></span><span class="op" id="5501740">(</span><span class="op" id="5501741">)</span><span class="op" id="5501742">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5501747"><a href="/gostd/runtime/pprof/pprof.go.html#5501658">r</a></span><span class="op" id="5501748">.</span><span class="ident" id="5501749"><a href="/gostd/runtime/mprof.go.html#1628897">AllocObjects</a></span><span class="op" id="5501761">,</span>&nbsp;<span class="ident" id="5501763"><a href="/gostd/runtime/pprof/pprof.go.html#5501658">r</a></span><span class="op" id="5501764">.</span><span class="ident" id="5501765"><a href="/gostd/runtime/mprof.go.html#1628822">AllocBytes</a></span><span class="op" id="5501775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5501779">for</span>&nbsp;<span class="ident" id="5501783">_</span><span class="op" id="5501784">,</span>&nbsp;<span class="ident" id="5501786">pc</span>&nbsp;<span class="op" id="5501789">:=</span>&nbsp;<span class="keyword" id="5501792">range</span>&nbsp;<span class="ident" id="5501798"><a href="/gostd/runtime/pprof/pprof.go.html#5501658">r</a></span><span class="op" id="5501799">.</span><span class="ident" id="5501800"><a href="/gostd/runtime/mprof.go.html#1629517">Stack</a></span><span class="op" id="5501805">(</span><span class="op" id="5501806">)</span>&nbsp;<span class="op" id="5501808">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5501813"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5501816">.</span><span class="ident" id="5501817"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5501824">(</span><span class="ident" id="5501825"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5501826">,</span>&nbsp;<span class="string" id="5501828">&#34;&nbsp;%#x&#34;</span><span class="op" id="5501834">,</span>&nbsp;<span class="ident" id="5501836"><a href="/gostd/runtime/pprof/pprof.go.html#5501786">pc</a></span><span class="op" id="5501838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5501842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5501846"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5501849">.</span><span class="ident" id="5501850"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5501857">(</span><span class="ident" id="5501858"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5501859">,</span>&nbsp;<span class="string" id="5501861">&#34;\n&#34;</span><span class="op" id="5501865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5501869">if</span>&nbsp;<span class="ident" id="5501872"><a href="/gostd/runtime/pprof/pprof.go.html#5500161">debug</a></span>&nbsp;<span class="op" id="5501878">&gt;</span>&nbsp;<span class="num" id="5501880">0</span>&nbsp;<span class="op" id="5501882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5501887"><a href="/gostd/runtime/pprof/pprof.go.html#5498378">printStackRecord</a></span><span class="op" id="5501903">(</span><span class="ident" id="5501904"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5501905">,</span>&nbsp;<span class="ident" id="5501907"><a href="/gostd/runtime/pprof/pprof.go.html#5501658">r</a></span><span class="op" id="5501908">.</span><span class="ident" id="5501909"><a href="/gostd/runtime/mprof.go.html#1629517">Stack</a></span><span class="op" id="5501914">(</span><span class="op" id="5501915">)</span><span class="op" id="5501916">,</span>&nbsp;<span class="builtintype" id="5501918">false</span><span class="op" id="5501923">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5501927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5501930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5501934">//&nbsp;Print&nbsp;memstats&nbsp;information&nbsp;too.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5501970">//&nbsp;Pprof&nbsp;will&nbsp;ignore,&nbsp;but&nbsp;useful&nbsp;for&nbsp;people</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5502015">if</span>&nbsp;<span class="ident" id="5502018"><a href="/gostd/runtime/pprof/pprof.go.html#5500161">debug</a></span>&nbsp;<span class="op" id="5502024">&gt;</span>&nbsp;<span class="num" id="5502026">0</span>&nbsp;<span class="op" id="5502028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5502032">s</span>&nbsp;<span class="op" id="5502034">:=</span>&nbsp;<span class="builtinfunc" id="5502037">new</span><span class="op" id="5502040">(</span><span class="ident" id="5502041"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5502048">.</span><span class="ident" id="5502049"><a href="/gostd/runtime/mem.go.html#1613431">MemStats</a></span><span class="op" id="5502057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5502061"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5502068">.</span><span class="ident" id="5502069"><a href="/gostd/runtime/mem.go.html#1615506">ReadMemStats</a></span><span class="op" id="5502081">(</span><span class="ident" id="5502082"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5502083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5502087"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5502090">.</span><span class="ident" id="5502091"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5502098">(</span><span class="ident" id="5502099"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5502100">,</span>&nbsp;<span class="string" id="5502102">&#34;\n#&nbsp;runtime.MemStats\n&#34;</span><span class="op" id="5502126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5502130"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5502133">.</span><span class="ident" id="5502134"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5502141">(</span><span class="ident" id="5502142"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5502143">,</span>&nbsp;<span class="string" id="5502145">&#34;#&nbsp;Alloc&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="5502161">,</span>&nbsp;<span class="ident" id="5502163"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5502164">.</span><span class="ident" id="5502165"><a href="/gostd/runtime/mem.go.html#1613474">Alloc</a></span><span class="op" id="5502170">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5502174"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5502177">.</span><span class="ident" id="5502178"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5502185">(</span><span class="ident" id="5502186"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5502187">,</span>&nbsp;<span class="string" id="5502189">&#34;#&nbsp;TotalAlloc&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="5502210">,</span>&nbsp;<span class="ident" id="5502212"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5502213">.</span><span class="ident" id="5502214"><a href="/gostd/runtime/mem.go.html#1613529">TotalAlloc</a></span><span class="op" id="5502224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5502228"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5502231">.</span><span class="ident" id="5502232"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5502239">(</span><span class="ident" id="5502240"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5502241">,</span>&nbsp;<span class="string" id="5502243">&#34;#&nbsp;Sys&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="5502257">,</span>&nbsp;<span class="ident" id="5502259"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5502260">.</span><span class="ident" id="5502261"><a href="/gostd/runtime/mem.go.html#1613583">Sys</a></span><span class="op" id="5502264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5502268"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5502271">.</span><span class="ident" id="5502272"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5502279">(</span><span class="ident" id="5502280"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5502281">,</span>&nbsp;<span class="string" id="5502283">&#34;#&nbsp;Lookups&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="5502301">,</span>&nbsp;<span class="ident" id="5502303"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5502304">.</span><span class="ident" id="5502305"><a href="/gostd/runtime/mem.go.html#1613654">Lookups</a></span><span class="op" id="5502312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5502316"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5502319">.</span><span class="ident" id="5502320"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5502327">(</span><span class="ident" id="5502328"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5502329">,</span>&nbsp;<span class="string" id="5502331">&#34;#&nbsp;Mallocs&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="5502349">,</span>&nbsp;<span class="ident" id="5502351"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5502352">.</span><span class="ident" id="5502353"><a href="/gostd/runtime/mem.go.html#1613702">Mallocs</a></span><span class="op" id="5502360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5502364"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5502367">.</span><span class="ident" id="5502368"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5502375">(</span><span class="ident" id="5502376"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5502377">,</span>&nbsp;<span class="string" id="5502379">&#34;#&nbsp;Frees&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="5502395">,</span>&nbsp;<span class="ident" id="5502397"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5502398">.</span><span class="ident" id="5502399"><a href="/gostd/runtime/mem.go.html#1613742">Frees</a></span><span class="op" id="5502404">)</span><br>
<span class="lineno">455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5502409"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5502412">.</span><span class="ident" id="5502413"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5502420">(</span><span class="ident" id="5502421"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5502422">,</span>&nbsp;<span class="string" id="5502424">&#34;#&nbsp;HeapAlloc&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="5502444">,</span>&nbsp;<span class="ident" id="5502446"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5502447">.</span><span class="ident" id="5502448"><a href="/gostd/runtime/mem.go.html#1613818">HeapAlloc</a></span><span class="op" id="5502457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5502461"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5502464">.</span><span class="ident" id="5502465"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5502472">(</span><span class="ident" id="5502473"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5502474">,</span>&nbsp;<span class="string" id="5502476">&#34;#&nbsp;HeapSys&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="5502494">,</span>&nbsp;<span class="ident" id="5502496"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5502497">.</span><span class="ident" id="5502498"><a href="/gostd/runtime/mem.go.html#1613875">HeapSys</a></span><span class="op" id="5502505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5502509"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5502512">.</span><span class="ident" id="5502513"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5502520">(</span><span class="ident" id="5502521"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5502522">,</span>&nbsp;<span class="string" id="5502524">&#34;#&nbsp;HeapIdle&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="5502543">,</span>&nbsp;<span class="ident" id="5502545"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5502546">.</span><span class="ident" id="5502547"><a href="/gostd/runtime/mem.go.html#1613926">HeapIdle</a></span><span class="op" id="5502555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5502559"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5502562">.</span><span class="ident" id="5502563"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5502570">(</span><span class="ident" id="5502571"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5502572">,</span>&nbsp;<span class="string" id="5502574">&#34;#&nbsp;HeapInuse&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="5502594">,</span>&nbsp;<span class="ident" id="5502596"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5502597">.</span><span class="ident" id="5502598"><a href="/gostd/runtime/mem.go.html#1613970">HeapInuse</a></span><span class="op" id="5502607">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5502611"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5502614">.</span><span class="ident" id="5502615"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5502622">(</span><span class="ident" id="5502623"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5502624">,</span>&nbsp;<span class="string" id="5502626">&#34;#&nbsp;HeapReleased&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="5502649">,</span>&nbsp;<span class="ident" id="5502651"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5502652">.</span><span class="ident" id="5502653"><a href="/gostd/runtime/mem.go.html#1614017">HeapReleased</a></span><span class="op" id="5502665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5502669"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5502672">.</span><span class="ident" id="5502673"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5502680">(</span><span class="ident" id="5502681"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5502682">,</span>&nbsp;<span class="string" id="5502684">&#34;#&nbsp;HeapObjects&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="5502706">,</span>&nbsp;<span class="ident" id="5502708"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5502709">.</span><span class="ident" id="5502710"><a href="/gostd/runtime/mem.go.html#1614066">HeapObjects</a></span><span class="op" id="5502721">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5502726"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5502729">.</span><span class="ident" id="5502730"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5502737">(</span><span class="ident" id="5502738"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5502739">,</span>&nbsp;<span class="string" id="5502741">&#34;#&nbsp;Stack&nbsp;=&nbsp;%d&nbsp;/&nbsp;%d\n&#34;</span><span class="op" id="5502762">,</span>&nbsp;<span class="ident" id="5502764"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5502765">.</span><span class="ident" id="5502766"><a href="/gostd/runtime/mem.go.html#1614250">StackInuse</a></span><span class="op" id="5502776">,</span>&nbsp;<span class="ident" id="5502778"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5502779">.</span><span class="ident" id="5502780"><a href="/gostd/runtime/mem.go.html#1614303">StackSys</a></span><span class="op" id="5502788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5502792"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5502795">.</span><span class="ident" id="5502796"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5502803">(</span><span class="ident" id="5502804"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5502805">,</span>&nbsp;<span class="string" id="5502807">&#34;#&nbsp;MSpan&nbsp;=&nbsp;%d&nbsp;/&nbsp;%d\n&#34;</span><span class="op" id="5502828">,</span>&nbsp;<span class="ident" id="5502830"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5502831">.</span><span class="ident" id="5502832"><a href="/gostd/runtime/mem.go.html#1614323">MSpanInuse</a></span><span class="op" id="5502842">,</span>&nbsp;<span class="ident" id="5502844"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5502845">.</span><span class="ident" id="5502846"><a href="/gostd/runtime/mem.go.html#1614363">MSpanSys</a></span><span class="op" id="5502854">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5502858"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5502861">.</span><span class="ident" id="5502862"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5502869">(</span><span class="ident" id="5502870"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5502871">,</span>&nbsp;<span class="string" id="5502873">&#34;#&nbsp;MCache&nbsp;=&nbsp;%d&nbsp;/&nbsp;%d\n&#34;</span><span class="op" id="5502895">,</span>&nbsp;<span class="ident" id="5502897"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5502898">.</span><span class="ident" id="5502899"><a href="/gostd/runtime/mem.go.html#1614383">MCacheInuse</a></span><span class="op" id="5502910">,</span>&nbsp;<span class="ident" id="5502912"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5502913">.</span><span class="ident" id="5502914"><a href="/gostd/runtime/mem.go.html#1614424">MCacheSys</a></span><span class="op" id="5502923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5502927"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5502930">.</span><span class="ident" id="5502931"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5502938">(</span><span class="ident" id="5502939"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5502940">,</span>&nbsp;<span class="string" id="5502942">&#34;#&nbsp;BuckHashSys&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="5502964">,</span>&nbsp;<span class="ident" id="5502966"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5502967">.</span><span class="ident" id="5502968"><a href="/gostd/runtime/mem.go.html#1614444">BuckHashSys</a></span><span class="op" id="5502979">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5502984"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5502987">.</span><span class="ident" id="5502988"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5502995">(</span><span class="ident" id="5502996"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5502997">,</span>&nbsp;<span class="string" id="5502999">&#34;#&nbsp;NextGC&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="5503016">,</span>&nbsp;<span class="ident" id="5503018"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5503019">.</span><span class="ident" id="5503020"><a href="/gostd/runtime/mem.go.html#1614613">NextGC</a></span><span class="op" id="5503026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5503030"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5503033">.</span><span class="ident" id="5503034"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5503041">(</span><span class="ident" id="5503042"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5503043">,</span>&nbsp;<span class="string" id="5503045">&#34;#&nbsp;PauseNs&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="5503063">,</span>&nbsp;<span class="ident" id="5503065"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5503066">.</span><span class="ident" id="5503067"><a href="/gostd/runtime/mem.go.html#1614794">PauseNs</a></span><span class="op" id="5503074">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5503078"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5503081">.</span><span class="ident" id="5503082"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5503089">(</span><span class="ident" id="5503090"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5503091">,</span>&nbsp;<span class="string" id="5503093">&#34;#&nbsp;NumGC&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="5503109">,</span>&nbsp;<span class="ident" id="5503111"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5503112">.</span><span class="ident" id="5503113"><a href="/gostd/runtime/mem.go.html#1614976">NumGC</a></span><span class="op" id="5503118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5503122"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5503125">.</span><span class="ident" id="5503126"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5503133">(</span><span class="ident" id="5503134"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5503135">,</span>&nbsp;<span class="string" id="5503137">&#34;#&nbsp;EnableGC&nbsp;=&nbsp;%v\n&#34;</span><span class="op" id="5503156">,</span>&nbsp;<span class="ident" id="5503158"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5503159">.</span><span class="ident" id="5503160"><a href="/gostd/runtime/mem.go.html#1614997">EnableGC</a></span><span class="op" id="5503168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5503172"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5503175">.</span><span class="ident" id="5503176"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5503183">(</span><span class="ident" id="5503184"><a href="/gostd/runtime/pprof/pprof.go.html#5500148">w</a></span><span class="op" id="5503185">,</span>&nbsp;<span class="string" id="5503187">&#34;#&nbsp;DebugGC&nbsp;=&nbsp;%v\n&#34;</span><span class="op" id="5503205">,</span>&nbsp;<span class="ident" id="5503207"><a href="/gostd/runtime/pprof/pprof.go.html#5502032">s</a></span><span class="op" id="5503208">.</span><span class="ident" id="5503209"><a href="/gostd/runtime/mem.go.html#1615016">DebugGC</a></span><span class="op" id="5503216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5503219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5503223">if</span>&nbsp;<span class="ident" id="5503226"><a href="/gostd/runtime/pprof/pprof.go.html#5500955">tw</a></span>&nbsp;<span class="op" id="5503229">!=</span>&nbsp;<span class="builtintype" id="5503232">nil</span>&nbsp;<span class="op" id="5503236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5503240"><a href="/gostd/runtime/pprof/pprof.go.html#5500955">tw</a></span><span class="op" id="5503242">.</span><span class="ident" id="5503243"><a href="/gostd/text/tabwriter/tabwriter.go.html#5522354">Flush</a></span><span class="op" id="5503248">(</span><span class="op" id="5503249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5503252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5503255">return</span>&nbsp;<span class="ident" id="5503262"><a href="/gostd/runtime/pprof/pprof.go.html#5500926">b</a></span><span class="op" id="5503263">.</span><span class="ident" id="5503264"><a href="/gostd/bufio/bufio.go.html#1367486">Flush</a></span><span class="op" id="5503269">(</span><span class="op" id="5503270">)</span><br>
<span class="lineno"></span><span class="op" id="5503272">}</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span><span class="comment" id="5503275">//&nbsp;countThreadCreate&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;current&nbsp;ThreadCreateProfile.</span><br>
<span class="lineno"></span><span class="keyword" id="5503349">func</span>&nbsp;<span class="ident" id="5503354">countThreadCreate</span><span class="op" id="5503371">(</span><span class="op" id="5503372">)</span>&nbsp;<span class="builtintype" id="5503374">int</span>&nbsp;<span class="op" id="5503378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5503381">n</span><span class="op" id="5503382">,</span>&nbsp;<span class="ident" id="5503384">_</span>&nbsp;<span class="op" id="5503386">:=</span>&nbsp;<span class="ident" id="5503389"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5503396">.</span><span class="ident" id="5503397"><a href="/gostd/runtime/mprof.go.html#1633163">ThreadCreateProfile</a></span><span class="op" id="5503416">(</span><span class="builtintype" id="5503417">nil</span><span class="op" id="5503420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5503423">return</span>&nbsp;<span class="ident" id="5503430"><a href="/gostd/runtime/pprof/pprof.go.html#5503381">n</a></span><br>
<span class="lineno">485</span><span class="op" id="5503432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5503435">//&nbsp;writeThreadCreate&nbsp;writes&nbsp;the&nbsp;current&nbsp;runtime&nbsp;ThreadCreateProfile&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="5503509">func</span>&nbsp;<span class="ident" id="5503514">writeThreadCreate</span><span class="op" id="5503531">(</span><span class="ident" id="5503532">w</span>&nbsp;<span class="ident" id="5503534"><a href="/gostd/runtime/pprof/pprof.go.html#5490138">io</a></span><span class="op" id="5503536">.</span><span class="ident" id="5503537"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="5503543">,</span>&nbsp;<span class="ident" id="5503545">debug</span>&nbsp;<span class="builtintype" id="5503551">int</span><span class="op" id="5503554">)</span>&nbsp;<span class="builtintype" id="5503556">error</span>&nbsp;<span class="op" id="5503562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5503565">return</span>&nbsp;<span class="ident" id="5503572"><a href="/gostd/runtime/pprof/pprof.go.html#5504551">writeRuntimeProfile</a></span><span class="op" id="5503591">(</span><span class="ident" id="5503592"><a href="/gostd/runtime/pprof/pprof.go.html#5503532">w</a></span><span class="op" id="5503593">,</span>&nbsp;<span class="ident" id="5503595"><a href="/gostd/runtime/pprof/pprof.go.html#5503545">debug</a></span><span class="op" id="5503600">,</span>&nbsp;<span class="string" id="5503602">&#34;threadcreate&#34;</span><span class="op" id="5503616">,</span>&nbsp;<span class="ident" id="5503618"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5503625">.</span><span class="ident" id="5503626"><a href="/gostd/runtime/mprof.go.html#1633163">ThreadCreateProfile</a></span><span class="op" id="5503645">)</span><br>
<span class="lineno">490</span><span class="op" id="5503647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5503650">//&nbsp;countGoroutine&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="keyword" id="5503702">func</span>&nbsp;<span class="ident" id="5503707">countGoroutine</span><span class="op" id="5503721">(</span><span class="op" id="5503722">)</span>&nbsp;<span class="builtintype" id="5503724">int</span>&nbsp;<span class="op" id="5503728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5503731">return</span>&nbsp;<span class="ident" id="5503738"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5503745">.</span><span class="ident" id="5503746"><a href="/gostd/runtime/debug.go.html#1522186">NumGoroutine</a></span><span class="op" id="5503758">(</span><span class="op" id="5503759">)</span><br>
<span class="lineno">495</span><span class="op" id="5503761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5503764">//&nbsp;writeGoroutine&nbsp;writes&nbsp;the&nbsp;current&nbsp;runtime&nbsp;GoroutineProfile&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="5503832">func</span>&nbsp;<span class="ident" id="5503837">writeGoroutine</span><span class="op" id="5503851">(</span><span class="ident" id="5503852">w</span>&nbsp;<span class="ident" id="5503854"><a href="/gostd/runtime/pprof/pprof.go.html#5490138">io</a></span><span class="op" id="5503856">.</span><span class="ident" id="5503857"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="5503863">,</span>&nbsp;<span class="ident" id="5503865">debug</span>&nbsp;<span class="builtintype" id="5503871">int</span><span class="op" id="5503874">)</span>&nbsp;<span class="builtintype" id="5503876">error</span>&nbsp;<span class="op" id="5503882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5503885">if</span>&nbsp;<span class="ident" id="5503888"><a href="/gostd/runtime/pprof/pprof.go.html#5503865">debug</a></span>&nbsp;<span class="op" id="5503894">&gt;=</span>&nbsp;<span class="num" id="5503897">2</span>&nbsp;<span class="op" id="5503899">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5503903">return</span>&nbsp;<span class="ident" id="5503910"><a href="/gostd/runtime/pprof/pprof.go.html#5504022">writeGoroutineStacks</a></span><span class="op" id="5503930">(</span><span class="ident" id="5503931"><a href="/gostd/runtime/pprof/pprof.go.html#5503852">w</a></span><span class="op" id="5503932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5503935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5503938">return</span>&nbsp;<span class="ident" id="5503945"><a href="/gostd/runtime/pprof/pprof.go.html#5504551">writeRuntimeProfile</a></span><span class="op" id="5503964">(</span><span class="ident" id="5503965"><a href="/gostd/runtime/pprof/pprof.go.html#5503852">w</a></span><span class="op" id="5503966">,</span>&nbsp;<span class="ident" id="5503968"><a href="/gostd/runtime/pprof/pprof.go.html#5503865">debug</a></span><span class="op" id="5503973">,</span>&nbsp;<span class="string" id="5503975">&#34;goroutine&#34;</span><span class="op" id="5503986">,</span>&nbsp;<span class="ident" id="5503988"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5503995">.</span><span class="ident" id="5503996"><a href="/gostd/runtime/mprof.go.html#1633912">GoroutineProfile</a></span><span class="op" id="5504012">)</span><br>
<span class="lineno"></span><span class="op" id="5504014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">505</span><span class="keyword" id="5504017">func</span>&nbsp;<span class="ident" id="5504022">writeGoroutineStacks</span><span class="op" id="5504042">(</span><span class="ident" id="5504043">w</span>&nbsp;<span class="ident" id="5504045"><a href="/gostd/runtime/pprof/pprof.go.html#5490138">io</a></span><span class="op" id="5504047">.</span><span class="ident" id="5504048"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="5504054">)</span>&nbsp;<span class="builtintype" id="5504056">error</span>&nbsp;<span class="op" id="5504062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5504065">//&nbsp;We&nbsp;don&#39;t&nbsp;know&nbsp;how&nbsp;big&nbsp;the&nbsp;buffer&nbsp;needs&nbsp;to&nbsp;be&nbsp;to&nbsp;collect</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5504125">//&nbsp;all&nbsp;the&nbsp;goroutines.&nbsp;&nbsp;Start&nbsp;with&nbsp;1&nbsp;MB&nbsp;and&nbsp;try&nbsp;a&nbsp;few&nbsp;times,&nbsp;doubling&nbsp;each&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5504207">//&nbsp;Give&nbsp;up&nbsp;and&nbsp;use&nbsp;a&nbsp;truncated&nbsp;trace&nbsp;if&nbsp;64&nbsp;MB&nbsp;is&nbsp;not&nbsp;enough.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5504269">buf</span>&nbsp;<span class="op" id="5504273">:=</span>&nbsp;<span class="builtinfunc" id="5504276">make</span><span class="op" id="5504280">(</span><span class="op" id="5504281">[</span><span class="op" id="5504282">]</span><span class="builtintype" id="5504283">byte</span><span class="op" id="5504287">,</span>&nbsp;<span class="num" id="5504289">1</span><span class="op" id="5504290">&lt;&lt;</span><span class="num" id="5504292">20</span><span class="op" id="5504294">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5504297">for</span>&nbsp;<span class="ident" id="5504301">i</span>&nbsp;<span class="op" id="5504303">:=</span>&nbsp;<span class="num" id="5504306">0</span><span class="op" id="5504307">;</span>&nbsp;<span class="op" id="5504309">;</span>&nbsp;<span class="ident" id="5504311"><a href="/gostd/runtime/pprof/pprof.go.html#5504301">i</a></span><span class="op" id="5504312">++</span>&nbsp;<span class="op" id="5504315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5504319">n</span>&nbsp;<span class="op" id="5504321">:=</span>&nbsp;<span class="ident" id="5504324"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5504331">.</span><span class="ident" id="5504332"><a href="/gostd/runtime/mprof.go.html#1634979">Stack</a></span><span class="op" id="5504337">(</span><span class="ident" id="5504338"><a href="/gostd/runtime/pprof/pprof.go.html#5504269">buf</a></span><span class="op" id="5504341">,</span>&nbsp;<span class="builtintype" id="5504343">true</span><span class="op" id="5504347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5504351">if</span>&nbsp;<span class="ident" id="5504354"><a href="/gostd/runtime/pprof/pprof.go.html#5504319">n</a></span>&nbsp;<span class="op" id="5504356">&lt;</span>&nbsp;<span class="builtinfunc" id="5504358">len</span><span class="op" id="5504361">(</span><span class="ident" id="5504362"><a href="/gostd/runtime/pprof/pprof.go.html#5504269">buf</a></span><span class="op" id="5504365">)</span>&nbsp;<span class="op" id="5504367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5504372"><a href="/gostd/runtime/pprof/pprof.go.html#5504269">buf</a></span>&nbsp;<span class="op" id="5504376">=</span>&nbsp;<span class="ident" id="5504378"><a href="/gostd/runtime/pprof/pprof.go.html#5504269">buf</a></span><span class="op" id="5504381">[</span><span class="op" id="5504382">:</span><span class="ident" id="5504383"><a href="/gostd/runtime/pprof/pprof.go.html#5504319">n</a></span><span class="op" id="5504384">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5504389">break</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5504397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5504401">if</span>&nbsp;<span class="builtinfunc" id="5504404">len</span><span class="op" id="5504407">(</span><span class="ident" id="5504408"><a href="/gostd/runtime/pprof/pprof.go.html#5504269">buf</a></span><span class="op" id="5504411">)</span>&nbsp;<span class="op" id="5504413">&gt;=</span>&nbsp;<span class="num" id="5504416">64</span><span class="op" id="5504418">&lt;&lt;</span><span class="num" id="5504420">20</span>&nbsp;<span class="op" id="5504423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5504428">//&nbsp;Filled&nbsp;64&nbsp;MB&nbsp;-&nbsp;stop&nbsp;there.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5504461">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5504469">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5504473"><a href="/gostd/runtime/pprof/pprof.go.html#5504269">buf</a></span>&nbsp;<span class="op" id="5504477">=</span>&nbsp;<span class="builtinfunc" id="5504479">make</span><span class="op" id="5504483">(</span><span class="op" id="5504484">[</span><span class="op" id="5504485">]</span><span class="builtintype" id="5504486">byte</span><span class="op" id="5504490">,</span>&nbsp;<span class="num" id="5504492">2</span><span class="op" id="5504493">*</span><span class="builtinfunc" id="5504494">len</span><span class="op" id="5504497">(</span><span class="ident" id="5504498"><a href="/gostd/runtime/pprof/pprof.go.html#5504269">buf</a></span><span class="op" id="5504501">)</span><span class="op" id="5504502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5504505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5504508">_</span><span class="op" id="5504509">,</span>&nbsp;<span class="ident" id="5504511">err</span>&nbsp;<span class="op" id="5504515">:=</span>&nbsp;<span class="ident" id="5504518"><a href="/gostd/runtime/pprof/pprof.go.html#5504043">w</a></span><span class="op" id="5504519">.</span><span class="ident" id="5504520"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="5504525">(</span><span class="ident" id="5504526"><a href="/gostd/runtime/pprof/pprof.go.html#5504269">buf</a></span><span class="op" id="5504529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5504532">return</span>&nbsp;<span class="ident" id="5504539"><a href="/gostd/runtime/pprof/pprof.go.html#5504511">err</a></span><br>
<span class="lineno"></span><span class="op" id="5504543">}</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span><span class="keyword" id="5504546">func</span>&nbsp;<span class="ident" id="5504551">writeRuntimeProfile</span><span class="op" id="5504570">(</span><span class="ident" id="5504571">w</span>&nbsp;<span class="ident" id="5504573"><a href="/gostd/runtime/pprof/pprof.go.html#5490138">io</a></span><span class="op" id="5504575">.</span><span class="ident" id="5504576"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="5504582">,</span>&nbsp;<span class="ident" id="5504584">debug</span>&nbsp;<span class="builtintype" id="5504590">int</span><span class="op" id="5504593">,</span>&nbsp;<span class="ident" id="5504595">name</span>&nbsp;<span class="builtintype" id="5504600">string</span><span class="op" id="5504606">,</span>&nbsp;<span class="ident" id="5504608">fetch</span>&nbsp;<span class="keyword" id="5504614">func</span><span class="op" id="5504618">(</span><span class="op" id="5504619">[</span><span class="op" id="5504620">]</span><span class="ident" id="5504621"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5504628">.</span><span class="ident" id="5504629"><a href="/gostd/runtime/mprof.go.html#1627625">StackRecord</a></span><span class="op" id="5504640">)</span>&nbsp;<span class="op" id="5504642">(</span><span class="builtintype" id="5504643">int</span><span class="op" id="5504646">,</span>&nbsp;<span class="builtintype" id="5504648">bool</span><span class="op" id="5504652">)</span><span class="op" id="5504653">)</span>&nbsp;<span class="builtintype" id="5504655">error</span>&nbsp;<span class="op" id="5504661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5504664">//&nbsp;Find&nbsp;out&nbsp;how&nbsp;many&nbsp;records&nbsp;there&nbsp;are&nbsp;(fetch(nil)),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5504718">//&nbsp;allocate&nbsp;that&nbsp;many&nbsp;records,&nbsp;and&nbsp;get&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5504768">//&nbsp;There&#39;s&nbsp;a&nbsp;racemore&nbsp;records&nbsp;might&nbsp;be&nbsp;added&nbsp;between</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5504825">//&nbsp;the&nbsp;two&nbsp;callsso&nbsp;allocate&nbsp;a&nbsp;few&nbsp;extra&nbsp;records&nbsp;for&nbsp;safety</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5504888">//&nbsp;and&nbsp;also&nbsp;try&nbsp;again&nbsp;if&nbsp;we&#39;re&nbsp;very&nbsp;unlucky.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5504934">//&nbsp;The&nbsp;loop&nbsp;should&nbsp;only&nbsp;execute&nbsp;one&nbsp;iteration&nbsp;in&nbsp;the&nbsp;common&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5505001">var</span>&nbsp;<span class="ident" id="5505005">p</span>&nbsp;<span class="op" id="5505007">[</span><span class="op" id="5505008">]</span><span class="ident" id="5505009"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5505016">.</span><span class="ident" id="5505017"><a href="/gostd/runtime/mprof.go.html#1627625">StackRecord</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5505030">n</span><span class="op" id="5505031">,</span>&nbsp;<span class="ident" id="5505033">ok</span>&nbsp;<span class="op" id="5505036">:=</span>&nbsp;<span class="ident" id="5505039"><a href="/gostd/runtime/pprof/pprof.go.html#5504608">fetch</a></span><span class="op" id="5505044">(</span><span class="builtintype" id="5505045">nil</span><span class="op" id="5505048">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5505051">for</span>&nbsp;<span class="op" id="5505055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5505059">//&nbsp;Allocate&nbsp;room&nbsp;for&nbsp;a&nbsp;slightly&nbsp;bigger&nbsp;profile,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5505109">//&nbsp;in&nbsp;case&nbsp;a&nbsp;few&nbsp;more&nbsp;entries&nbsp;have&nbsp;been&nbsp;added</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5505157">//&nbsp;since&nbsp;the&nbsp;call&nbsp;to&nbsp;ThreadProfile.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5505195"><a href="/gostd/runtime/pprof/pprof.go.html#5505005">p</a></span>&nbsp;<span class="op" id="5505197">=</span>&nbsp;<span class="builtinfunc" id="5505199">make</span><span class="op" id="5505203">(</span><span class="op" id="5505204">[</span><span class="op" id="5505205">]</span><span class="ident" id="5505206"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5505213">.</span><span class="ident" id="5505214"><a href="/gostd/runtime/mprof.go.html#1627625">StackRecord</a></span><span class="op" id="5505225">,</span>&nbsp;<span class="ident" id="5505227"><a href="/gostd/runtime/pprof/pprof.go.html#5505030">n</a></span><span class="op" id="5505228">+</span><span class="num" id="5505229">10</span><span class="op" id="5505231">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5505235"><a href="/gostd/runtime/pprof/pprof.go.html#5505030">n</a></span><span class="op" id="5505236">,</span>&nbsp;<span class="ident" id="5505238"><a href="/gostd/runtime/pprof/pprof.go.html#5505033">ok</a></span>&nbsp;<span class="op" id="5505241">=</span>&nbsp;<span class="ident" id="5505243"><a href="/gostd/runtime/pprof/pprof.go.html#5504608">fetch</a></span><span class="op" id="5505248">(</span><span class="ident" id="5505249"><a href="/gostd/runtime/pprof/pprof.go.html#5505005">p</a></span><span class="op" id="5505250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5505254">if</span>&nbsp;<span class="ident" id="5505257"><a href="/gostd/runtime/pprof/pprof.go.html#5505033">ok</a></span>&nbsp;<span class="op" id="5505260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5505265"><a href="/gostd/runtime/pprof/pprof.go.html#5505005">p</a></span>&nbsp;<span class="op" id="5505267">=</span>&nbsp;<span class="ident" id="5505269"><a href="/gostd/runtime/pprof/pprof.go.html#5505005">p</a></span><span class="op" id="5505270">[</span><span class="num" id="5505271">0</span><span class="op" id="5505272">:</span><span class="ident" id="5505273"><a href="/gostd/runtime/pprof/pprof.go.html#5505030">n</a></span><span class="op" id="5505274">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5505279">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5505287">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5505291">//&nbsp;Profile&nbsp;grew;&nbsp;try&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5505320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5505324">return</span>&nbsp;<span class="ident" id="5505331"><a href="/gostd/runtime/pprof/pprof.go.html#5497357">printCountProfile</a></span><span class="op" id="5505348">(</span><span class="ident" id="5505349"><a href="/gostd/runtime/pprof/pprof.go.html#5504571">w</a></span><span class="op" id="5505350">,</span>&nbsp;<span class="ident" id="5505352"><a href="/gostd/runtime/pprof/pprof.go.html#5504584">debug</a></span><span class="op" id="5505357">,</span>&nbsp;<span class="ident" id="5505359"><a href="/gostd/runtime/pprof/pprof.go.html#5504595">name</a></span><span class="op" id="5505363">,</span>&nbsp;<span class="ident" id="5505365"><a href="/gostd/runtime/pprof/pprof.go.html#5505392">runtimeProfile</a></span><span class="op" id="5505379">(</span><span class="ident" id="5505380"><a href="/gostd/runtime/pprof/pprof.go.html#5505005">p</a></span><span class="op" id="5505381">)</span><span class="op" id="5505382">)</span><br>
<span class="lineno"></span><span class="op" id="5505384">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span><span class="keyword" id="5505387">type</span>&nbsp;<span class="ident" id="5505392">runtimeProfile</span>&nbsp;<span class="op" id="5505407">[</span><span class="op" id="5505408">]</span><span class="ident" id="5505409"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5505416">.</span><span class="ident" id="5505417"><a href="/gostd/runtime/mprof.go.html#1627625">StackRecord</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5505430">func</span>&nbsp;<span class="op" id="5505435">(</span><span class="ident" id="5505436">p</span>&nbsp;<span class="ident" id="5505438"><a href="/gostd/runtime/pprof/pprof.go.html#5505392">runtimeProfile</a></span><span class="op" id="5505452">)</span>&nbsp;<span class="ident" id="5505454">Len</span><span class="op" id="5505457">(</span><span class="op" id="5505458">)</span>&nbsp;<span class="builtintype" id="5505460">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5505477">{</span>&nbsp;<span class="keyword" id="5505479">return</span>&nbsp;<span class="builtinfunc" id="5505486">len</span><span class="op" id="5505489">(</span><span class="ident" id="5505490"><a href="/gostd/runtime/pprof/pprof.go.html#5505436">p</a></span><span class="op" id="5505491">)</span>&nbsp;<span class="op" id="5505493">}</span><br>
<span class="lineno"></span><span class="keyword" id="5505495">func</span>&nbsp;<span class="op" id="5505500">(</span><span class="ident" id="5505501">p</span>&nbsp;<span class="ident" id="5505503"><a href="/gostd/runtime/pprof/pprof.go.html#5505392">runtimeProfile</a></span><span class="op" id="5505517">)</span>&nbsp;<span class="ident" id="5505519">Stack</span><span class="op" id="5505524">(</span><span class="ident" id="5505525">i</span>&nbsp;<span class="builtintype" id="5505527">int</span><span class="op" id="5505530">)</span>&nbsp;<span class="op" id="5505532">[</span><span class="op" id="5505533">]</span><span class="builtintype" id="5505534">uintptr</span>&nbsp;<span class="op" id="5505542">{</span>&nbsp;<span class="keyword" id="5505544">return</span>&nbsp;<span class="ident" id="5505551"><a href="/gostd/runtime/pprof/pprof.go.html#5505501">p</a></span><span class="op" id="5505552">[</span><span class="ident" id="5505553"><a href="/gostd/runtime/pprof/pprof.go.html#5505525">i</a></span><span class="op" id="5505554">]</span><span class="op" id="5505555">.</span><span class="ident" id="5505556"><a href="/gostd/runtime/mprof.go.html#1627831">Stack</a></span><span class="op" id="5505561">(</span><span class="op" id="5505562">)</span>&nbsp;<span class="op" id="5505564">}</span><br>
<span class="lineno">555</span><br>
<span class="lineno"></span><span class="keyword" id="5505567">var</span>&nbsp;<span class="ident" id="5505571">cpu</span>&nbsp;<span class="keyword" id="5505575">struct</span>&nbsp;<span class="op" id="5505582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5505585"><a href="/gostd/runtime/pprof/pprof.go.html#5490174">sync</a></span><span class="op" id="5505589">.</span><span class="ident" id="5505590"><a href="/gostd/sync/mutex.go.html#1443974">Mutex</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5505597">profiling</span>&nbsp;<span class="builtintype" id="5505607">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5505613">done</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5505623">chan</span>&nbsp;<span class="builtintype" id="5505628">bool</span><br>
<span class="lineno">560</span><span class="op" id="5505633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5505636">//&nbsp;StartCPUProfile&nbsp;enables&nbsp;CPU&nbsp;profiling&nbsp;for&nbsp;the&nbsp;current&nbsp;process.</span><br>
<span class="lineno"></span><span class="comment" id="5505702">//&nbsp;While&nbsp;profiling,&nbsp;the&nbsp;profile&nbsp;will&nbsp;be&nbsp;buffered&nbsp;and&nbsp;written&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="5505769">//&nbsp;StartCPUProfile&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;profiling&nbsp;is&nbsp;already&nbsp;enabled.</span><br>
<span class="lineno">565</span><span class="keyword" id="5505838">func</span>&nbsp;<span class="ident" id="5505843">StartCPUProfile</span><span class="op" id="5505858">(</span><span class="ident" id="5505859">w</span>&nbsp;<span class="ident" id="5505861"><a href="/gostd/runtime/pprof/pprof.go.html#5490138">io</a></span><span class="op" id="5505863">.</span><span class="ident" id="5505864"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="5505870">)</span>&nbsp;<span class="builtintype" id="5505872">error</span>&nbsp;<span class="op" id="5505878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5505881">//&nbsp;The&nbsp;runtime&nbsp;routines&nbsp;allow&nbsp;a&nbsp;variable&nbsp;profiling&nbsp;rate,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5505939">//&nbsp;but&nbsp;in&nbsp;practice&nbsp;operating&nbsp;systems&nbsp;cannot&nbsp;trigger&nbsp;signals</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5506000">//&nbsp;at&nbsp;more&nbsp;than&nbsp;about&nbsp;500&nbsp;Hz,&nbsp;and&nbsp;our&nbsp;processing&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5506057">//&nbsp;signal&nbsp;is&nbsp;not&nbsp;cheap&nbsp;(mostly&nbsp;getting&nbsp;the&nbsp;stack&nbsp;trace).</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5506115">//&nbsp;100&nbsp;Hz&nbsp;is&nbsp;a&nbsp;reasonable&nbsp;choice:&nbsp;it&nbsp;is&nbsp;frequent&nbsp;enough&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5506175">//&nbsp;produce&nbsp;useful&nbsp;data,&nbsp;rare&nbsp;enough&nbsp;not&nbsp;to&nbsp;bog&nbsp;down&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5506232">//&nbsp;system,&nbsp;and&nbsp;a&nbsp;nice&nbsp;round&nbsp;number&nbsp;to&nbsp;make&nbsp;it&nbsp;easy&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5506287">//&nbsp;convert&nbsp;sample&nbsp;counts&nbsp;to&nbsp;seconds.&nbsp;&nbsp;Instead&nbsp;of&nbsp;requiring</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5506347">//&nbsp;each&nbsp;client&nbsp;to&nbsp;specify&nbsp;the&nbsp;frequency,&nbsp;we&nbsp;hard&nbsp;code&nbsp;it.</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5506406">const</span>&nbsp;<span class="ident" id="5506412">hz</span>&nbsp;<span class="op" id="5506415">=</span>&nbsp;<span class="num" id="5506417">100</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5506423"><a href="/gostd/runtime/pprof/pprof.go.html#5505571">cpu</a></span><span class="op" id="5506426">.</span><span class="ident" id="5506427"><a href="/gostd/sync/mutex.go.html#1444351">Lock</a></span><span class="op" id="5506431">(</span><span class="op" id="5506432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5506435">defer</span>&nbsp;<span class="ident" id="5506441"><a href="/gostd/runtime/pprof/pprof.go.html#5505571">cpu</a></span><span class="op" id="5506444">.</span><span class="ident" id="5506445"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="5506451">(</span><span class="op" id="5506452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5506455">if</span>&nbsp;<span class="ident" id="5506458"><a href="/gostd/runtime/pprof/pprof.go.html#5505571">cpu</a></span><span class="op" id="5506461">.</span><span class="ident" id="5506462"><a href="/gostd/runtime/pprof/pprof.go.html#5505613">done</a></span>&nbsp;<span class="op" id="5506467">==</span>&nbsp;<span class="builtintype" id="5506470">nil</span>&nbsp;<span class="op" id="5506474">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5506478"><a href="/gostd/runtime/pprof/pprof.go.html#5505571">cpu</a></span><span class="op" id="5506481">.</span><span class="ident" id="5506482"><a href="/gostd/runtime/pprof/pprof.go.html#5505613">done</a></span>&nbsp;<span class="op" id="5506487">=</span>&nbsp;<span class="builtinfunc" id="5506489">make</span><span class="op" id="5506493">(</span><span class="keyword" id="5506494">chan</span>&nbsp;<span class="builtintype" id="5506499">bool</span><span class="op" id="5506503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5506506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5506509">//&nbsp;Double-check.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5506527">if</span>&nbsp;<span class="ident" id="5506530"><a href="/gostd/runtime/pprof/pprof.go.html#5505571">cpu</a></span><span class="op" id="5506533">.</span><span class="ident" id="5506534"><a href="/gostd/runtime/pprof/pprof.go.html#5505597">profiling</a></span>&nbsp;<span class="op" id="5506544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5506548">return</span>&nbsp;<span class="ident" id="5506555"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5506558">.</span><span class="ident" id="5506559"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="5506565">(</span><span class="string" id="5506566">&#34;cpu&nbsp;profiling&nbsp;already&nbsp;in&nbsp;use&#34;</span><span class="op" id="5506596">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5506599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5506602"><a href="/gostd/runtime/pprof/pprof.go.html#5505571">cpu</a></span><span class="op" id="5506605">.</span><span class="ident" id="5506606"><a href="/gostd/runtime/pprof/pprof.go.html#5505597">profiling</a></span>&nbsp;<span class="op" id="5506616">=</span>&nbsp;<span class="builtintype" id="5506618">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5506624"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5506631">.</span><span class="ident" id="5506632"><a href="/gostd/runtime/cpuprof.go.html#1513043">SetCPUProfileRate</a></span><span class="op" id="5506649">(</span><span class="ident" id="5506650"><a href="/gostd/runtime/pprof/pprof.go.html#5506412">hz</a></span><span class="op" id="5506652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5506655">go</span>&nbsp;<span class="ident" id="5506658"><a href="/gostd/runtime/pprof/pprof.go.html#5506695">profileWriter</a></span><span class="op" id="5506671">(</span><span class="ident" id="5506672"><a href="/gostd/runtime/pprof/pprof.go.html#5505859">w</a></span><span class="op" id="5506673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5506676">return</span>&nbsp;<span class="builtintype" id="5506683">nil</span><br>
<span class="lineno">590</span><span class="op" id="5506687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5506690">func</span>&nbsp;<span class="ident" id="5506695">profileWriter</span><span class="op" id="5506708">(</span><span class="ident" id="5506709">w</span>&nbsp;<span class="ident" id="5506711"><a href="/gostd/runtime/pprof/pprof.go.html#5490138">io</a></span><span class="op" id="5506713">.</span><span class="ident" id="5506714"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="5506720">)</span>&nbsp;<span class="op" id="5506722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5506725">for</span>&nbsp;<span class="op" id="5506729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5506733">data</span>&nbsp;<span class="op" id="5506738">:=</span>&nbsp;<span class="ident" id="5506741"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5506748">.</span><span class="ident" id="5506749"><a href="/gostd/runtime/cpuprof.go.html#1520305">CPUProfile</a></span><span class="op" id="5506759">(</span><span class="op" id="5506760">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5506764">if</span>&nbsp;<span class="ident" id="5506767"><a href="/gostd/runtime/pprof/pprof.go.html#5506733">data</a></span>&nbsp;<span class="op" id="5506772">==</span>&nbsp;<span class="builtintype" id="5506775">nil</span>&nbsp;<span class="op" id="5506779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5506784">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5506792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5506796"><a href="/gostd/runtime/pprof/pprof.go.html#5506709">w</a></span><span class="op" id="5506797">.</span><span class="ident" id="5506798"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="5506803">(</span><span class="ident" id="5506804"><a href="/gostd/runtime/pprof/pprof.go.html#5506733">data</a></span><span class="op" id="5506808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5506811">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5506814"><a href="/gostd/runtime/pprof/pprof.go.html#5505571">cpu</a></span><span class="op" id="5506817">.</span><span class="ident" id="5506818"><a href="/gostd/runtime/pprof/pprof.go.html#5505613">done</a></span>&nbsp;<span class="op" id="5506823">&lt;-</span>&nbsp;<span class="builtintype" id="5506826">true</span><br>
<span class="lineno"></span><span class="op" id="5506831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5506834">//&nbsp;StopCPUProfile&nbsp;stops&nbsp;the&nbsp;current&nbsp;CPU&nbsp;profile,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span><span class="comment" id="5506891">//&nbsp;StopCPUProfile&nbsp;only&nbsp;returns&nbsp;after&nbsp;all&nbsp;the&nbsp;writes&nbsp;for&nbsp;the</span><br>
<span class="lineno">605</span><span class="comment" id="5506951">//&nbsp;profile&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="keyword" id="5506978">func</span>&nbsp;<span class="ident" id="5506983">StopCPUProfile</span><span class="op" id="5506997">(</span><span class="op" id="5506998">)</span>&nbsp;<span class="op" id="5507000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5507003"><a href="/gostd/runtime/pprof/pprof.go.html#5505571">cpu</a></span><span class="op" id="5507006">.</span><span class="ident" id="5507007"><a href="/gostd/sync/mutex.go.html#1444351">Lock</a></span><span class="op" id="5507011">(</span><span class="op" id="5507012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5507015">defer</span>&nbsp;<span class="ident" id="5507021"><a href="/gostd/runtime/pprof/pprof.go.html#5505571">cpu</a></span><span class="op" id="5507024">.</span><span class="ident" id="5507025"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="5507031">(</span><span class="op" id="5507032">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5507036">if</span>&nbsp;<span class="op" id="5507039">!</span><span class="ident" id="5507040"><a href="/gostd/runtime/pprof/pprof.go.html#5505571">cpu</a></span><span class="op" id="5507043">.</span><span class="ident" id="5507044"><a href="/gostd/runtime/pprof/pprof.go.html#5505597">profiling</a></span>&nbsp;<span class="op" id="5507054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5507058">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5507066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5507069"><a href="/gostd/runtime/pprof/pprof.go.html#5505571">cpu</a></span><span class="op" id="5507072">.</span><span class="ident" id="5507073"><a href="/gostd/runtime/pprof/pprof.go.html#5505597">profiling</a></span>&nbsp;<span class="op" id="5507083">=</span>&nbsp;<span class="builtintype" id="5507085">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5507092"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5507099">.</span><span class="ident" id="5507100"><a href="/gostd/runtime/cpuprof.go.html#1513043">SetCPUProfileRate</a></span><span class="op" id="5507117">(</span><span class="num" id="5507118">0</span><span class="op" id="5507119">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5507122">&lt;-</span><span class="ident" id="5507124"><a href="/gostd/runtime/pprof/pprof.go.html#5505571">cpu</a></span><span class="op" id="5507127">.</span><span class="ident" id="5507128"><a href="/gostd/runtime/pprof/pprof.go.html#5505613">done</a></span><br>
<span class="lineno"></span><span class="op" id="5507133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5507136">type</span>&nbsp;<span class="ident" id="5507141">byCycles</span>&nbsp;<span class="op" id="5507150">[</span><span class="op" id="5507151">]</span><span class="ident" id="5507152"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5507159">.</span><span class="ident" id="5507160"><a href="/gostd/runtime/mprof.go.html#1631897">BlockProfileRecord</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">620</span><span class="keyword" id="5507180">func</span>&nbsp;<span class="op" id="5507185">(</span><span class="ident" id="5507186">x</span>&nbsp;<span class="ident" id="5507188"><a href="/gostd/runtime/pprof/pprof.go.html#5507141">byCycles</a></span><span class="op" id="5507196">)</span>&nbsp;<span class="ident" id="5507198">Len</span><span class="op" id="5507201">(</span><span class="op" id="5507202">)</span>&nbsp;<span class="builtintype" id="5507204">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5507218">{</span>&nbsp;<span class="keyword" id="5507220">return</span>&nbsp;<span class="builtinfunc" id="5507227">len</span><span class="op" id="5507230">(</span><span class="ident" id="5507231"><a href="/gostd/runtime/pprof/pprof.go.html#5507186">x</a></span><span class="op" id="5507232">)</span>&nbsp;<span class="op" id="5507234">}</span><br>
<span class="lineno"></span><span class="keyword" id="5507236">func</span>&nbsp;<span class="op" id="5507241">(</span><span class="ident" id="5507242">x</span>&nbsp;<span class="ident" id="5507244"><a href="/gostd/runtime/pprof/pprof.go.html#5507141">byCycles</a></span><span class="op" id="5507252">)</span>&nbsp;<span class="ident" id="5507254">Swap</span><span class="op" id="5507258">(</span><span class="ident" id="5507259">i</span><span class="op" id="5507260">,</span>&nbsp;<span class="ident" id="5507262">j</span>&nbsp;<span class="builtintype" id="5507264">int</span><span class="op" id="5507267">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5507274">{</span>&nbsp;<span class="ident" id="5507276"><a href="/gostd/runtime/pprof/pprof.go.html#5507242">x</a></span><span class="op" id="5507277">[</span><span class="ident" id="5507278"><a href="/gostd/runtime/pprof/pprof.go.html#5507259">i</a></span><span class="op" id="5507279">]</span><span class="op" id="5507280">,</span>&nbsp;<span class="ident" id="5507282"><a href="/gostd/runtime/pprof/pprof.go.html#5507242">x</a></span><span class="op" id="5507283">[</span><span class="ident" id="5507284"><a href="/gostd/runtime/pprof/pprof.go.html#5507262">j</a></span><span class="op" id="5507285">]</span>&nbsp;<span class="op" id="5507287">=</span>&nbsp;<span class="ident" id="5507289"><a href="/gostd/runtime/pprof/pprof.go.html#5507242">x</a></span><span class="op" id="5507290">[</span><span class="ident" id="5507291"><a href="/gostd/runtime/pprof/pprof.go.html#5507262">j</a></span><span class="op" id="5507292">]</span><span class="op" id="5507293">,</span>&nbsp;<span class="ident" id="5507295"><a href="/gostd/runtime/pprof/pprof.go.html#5507242">x</a></span><span class="op" id="5507296">[</span><span class="ident" id="5507297"><a href="/gostd/runtime/pprof/pprof.go.html#5507259">i</a></span><span class="op" id="5507298">]</span>&nbsp;<span class="op" id="5507300">}</span><br>
<span class="lineno"></span><span class="keyword" id="5507302">func</span>&nbsp;<span class="op" id="5507307">(</span><span class="ident" id="5507308">x</span>&nbsp;<span class="ident" id="5507310"><a href="/gostd/runtime/pprof/pprof.go.html#5507141">byCycles</a></span><span class="op" id="5507318">)</span>&nbsp;<span class="ident" id="5507320">Less</span><span class="op" id="5507324">(</span><span class="ident" id="5507325">i</span><span class="op" id="5507326">,</span>&nbsp;<span class="ident" id="5507328">j</span>&nbsp;<span class="builtintype" id="5507330">int</span><span class="op" id="5507333">)</span>&nbsp;<span class="builtintype" id="5507335">bool</span>&nbsp;<span class="op" id="5507340">{</span>&nbsp;<span class="keyword" id="5507342">return</span>&nbsp;<span class="ident" id="5507349"><a href="/gostd/runtime/pprof/pprof.go.html#5507308">x</a></span><span class="op" id="5507350">[</span><span class="ident" id="5507351"><a href="/gostd/runtime/pprof/pprof.go.html#5507325">i</a></span><span class="op" id="5507352">]</span><span class="op" id="5507353">.</span><span class="ident" id="5507354"><a href="/gostd/runtime/mprof.go.html#1631940">Cycles</a></span>&nbsp;<span class="op" id="5507361">&gt;</span>&nbsp;<span class="ident" id="5507363"><a href="/gostd/runtime/pprof/pprof.go.html#5507308">x</a></span><span class="op" id="5507364">[</span><span class="ident" id="5507365"><a href="/gostd/runtime/pprof/pprof.go.html#5507328">j</a></span><span class="op" id="5507366">]</span><span class="op" id="5507367">.</span><span class="ident" id="5507368"><a href="/gostd/runtime/mprof.go.html#1631940">Cycles</a></span>&nbsp;<span class="op" id="5507375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5507378">//&nbsp;countBlock&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;records&nbsp;in&nbsp;the&nbsp;blocking&nbsp;profile.</span><br>
<span class="lineno">625</span><span class="keyword" id="5507447">func</span>&nbsp;<span class="ident" id="5507452">countBlock</span><span class="op" id="5507462">(</span><span class="op" id="5507463">)</span>&nbsp;<span class="builtintype" id="5507465">int</span>&nbsp;<span class="op" id="5507469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5507472">n</span><span class="op" id="5507473">,</span>&nbsp;<span class="ident" id="5507475">_</span>&nbsp;<span class="op" id="5507477">:=</span>&nbsp;<span class="ident" id="5507480"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5507487">.</span><span class="ident" id="5507488"><a href="/gostd/runtime/mprof.go.html#1632359">BlockProfile</a></span><span class="op" id="5507500">(</span><span class="builtintype" id="5507501">nil</span><span class="op" id="5507504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5507507">return</span>&nbsp;<span class="ident" id="5507514"><a href="/gostd/runtime/pprof/pprof.go.html#5507472">n</a></span><br>
<span class="lineno"></span><span class="op" id="5507516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">630</span><span class="comment" id="5507519">//&nbsp;writeBlock&nbsp;writes&nbsp;the&nbsp;current&nbsp;blocking&nbsp;profile&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="5507575">func</span>&nbsp;<span class="ident" id="5507580">writeBlock</span><span class="op" id="5507590">(</span><span class="ident" id="5507591">w</span>&nbsp;<span class="ident" id="5507593"><a href="/gostd/runtime/pprof/pprof.go.html#5490138">io</a></span><span class="op" id="5507595">.</span><span class="ident" id="5507596"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="5507602">,</span>&nbsp;<span class="ident" id="5507604">debug</span>&nbsp;<span class="builtintype" id="5507610">int</span><span class="op" id="5507613">)</span>&nbsp;<span class="builtintype" id="5507615">error</span>&nbsp;<span class="op" id="5507621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5507624">var</span>&nbsp;<span class="ident" id="5507628">p</span>&nbsp;<span class="op" id="5507630">[</span><span class="op" id="5507631">]</span><span class="ident" id="5507632"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5507639">.</span><span class="ident" id="5507640"><a href="/gostd/runtime/mprof.go.html#1631897">BlockProfileRecord</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5507660">n</span><span class="op" id="5507661">,</span>&nbsp;<span class="ident" id="5507663">ok</span>&nbsp;<span class="op" id="5507666">:=</span>&nbsp;<span class="ident" id="5507669"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5507676">.</span><span class="ident" id="5507677"><a href="/gostd/runtime/mprof.go.html#1632359">BlockProfile</a></span><span class="op" id="5507689">(</span><span class="builtintype" id="5507690">nil</span><span class="op" id="5507693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5507696">for</span>&nbsp;<span class="op" id="5507700">{</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5507704"><a href="/gostd/runtime/pprof/pprof.go.html#5507628">p</a></span>&nbsp;<span class="op" id="5507706">=</span>&nbsp;<span class="builtinfunc" id="5507708">make</span><span class="op" id="5507712">(</span><span class="op" id="5507713">[</span><span class="op" id="5507714">]</span><span class="ident" id="5507715"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5507722">.</span><span class="ident" id="5507723"><a href="/gostd/runtime/mprof.go.html#1631897">BlockProfileRecord</a></span><span class="op" id="5507741">,</span>&nbsp;<span class="ident" id="5507743"><a href="/gostd/runtime/pprof/pprof.go.html#5507660">n</a></span><span class="op" id="5507744">+</span><span class="num" id="5507745">50</span><span class="op" id="5507747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5507751"><a href="/gostd/runtime/pprof/pprof.go.html#5507660">n</a></span><span class="op" id="5507752">,</span>&nbsp;<span class="ident" id="5507754"><a href="/gostd/runtime/pprof/pprof.go.html#5507663">ok</a></span>&nbsp;<span class="op" id="5507757">=</span>&nbsp;<span class="ident" id="5507759"><a href="/gostd/runtime/pprof/pprof.go.html#5490144">runtime</a></span><span class="op" id="5507766">.</span><span class="ident" id="5507767"><a href="/gostd/runtime/mprof.go.html#1632359">BlockProfile</a></span><span class="op" id="5507779">(</span><span class="ident" id="5507780"><a href="/gostd/runtime/pprof/pprof.go.html#5507628">p</a></span><span class="op" id="5507781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5507785">if</span>&nbsp;<span class="ident" id="5507788"><a href="/gostd/runtime/pprof/pprof.go.html#5507663">ok</a></span>&nbsp;<span class="op" id="5507791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5507796"><a href="/gostd/runtime/pprof/pprof.go.html#5507628">p</a></span>&nbsp;<span class="op" id="5507798">=</span>&nbsp;<span class="ident" id="5507800"><a href="/gostd/runtime/pprof/pprof.go.html#5507628">p</a></span><span class="op" id="5507801">[</span><span class="op" id="5507802">:</span><span class="ident" id="5507803"><a href="/gostd/runtime/pprof/pprof.go.html#5507660">n</a></span><span class="op" id="5507804">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5507809">break</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5507817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5507820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5507824"><a href="/gostd/runtime/pprof/pprof.go.html#5490155">sort</a></span><span class="op" id="5507828">.</span><span class="ident" id="5507829"><a href="/gostd/sort/sort.go.html#2015380">Sort</a></span><span class="op" id="5507833">(</span><span class="ident" id="5507834"><a href="/gostd/runtime/pprof/pprof.go.html#5507141">byCycles</a></span><span class="op" id="5507842">(</span><span class="ident" id="5507843"><a href="/gostd/runtime/pprof/pprof.go.html#5507628">p</a></span><span class="op" id="5507844">)</span><span class="op" id="5507845">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5507849">b</span>&nbsp;<span class="op" id="5507851">:=</span>&nbsp;<span class="ident" id="5507854"><a href="/gostd/runtime/pprof/pprof.go.html#5490113">bufio</a></span><span class="op" id="5507859">.</span><span class="ident" id="5507860"><a href="/gostd/bufio/bufio.go.html#1367149">NewWriter</a></span><span class="op" id="5507869">(</span><span class="ident" id="5507870"><a href="/gostd/runtime/pprof/pprof.go.html#5507591">w</a></span><span class="op" id="5507871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5507874">var</span>&nbsp;<span class="ident" id="5507878">tw</span>&nbsp;<span class="op" id="5507881">*</span><span class="ident" id="5507882"><a href="/gostd/runtime/pprof/pprof.go.html#5490182">tabwriter</a></span><span class="op" id="5507891">.</span><span class="ident" id="5507892"><a href="/gostd/text/tabwriter/tabwriter.go.html#5511646">Writer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5507900"><a href="/gostd/runtime/pprof/pprof.go.html#5507591">w</a></span>&nbsp;<span class="op" id="5507902">=</span>&nbsp;<span class="ident" id="5507904"><a href="/gostd/runtime/pprof/pprof.go.html#5507849">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5507907">if</span>&nbsp;<span class="ident" id="5507910"><a href="/gostd/runtime/pprof/pprof.go.html#5507604">debug</a></span>&nbsp;<span class="op" id="5507916">&gt;</span>&nbsp;<span class="num" id="5507918">0</span>&nbsp;<span class="op" id="5507920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5507924"><a href="/gostd/runtime/pprof/pprof.go.html#5507878">tw</a></span>&nbsp;<span class="op" id="5507927">=</span>&nbsp;<span class="ident" id="5507929"><a href="/gostd/runtime/pprof/pprof.go.html#5490182">tabwriter</a></span><span class="op" id="5507938">.</span><span class="ident" id="5507939"><a href="/gostd/text/tabwriter/tabwriter.go.html#5524689">NewWriter</a></span><span class="op" id="5507948">(</span><span class="ident" id="5507949"><a href="/gostd/runtime/pprof/pprof.go.html#5507591">w</a></span><span class="op" id="5507950">,</span>&nbsp;<span class="num" id="5507952">1</span><span class="op" id="5507953">,</span>&nbsp;<span class="num" id="5507955">8</span><span class="op" id="5507956">,</span>&nbsp;<span class="num" id="5507958">1</span><span class="op" id="5507959">,</span>&nbsp;<span class="string" id="5507961">&#39;\t&#39;</span><span class="op" id="5507965">,</span>&nbsp;<span class="num" id="5507967">0</span><span class="op" id="5507968">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5507972"><a href="/gostd/runtime/pprof/pprof.go.html#5507591">w</a></span>&nbsp;<span class="op" id="5507974">=</span>&nbsp;<span class="ident" id="5507976"><a href="/gostd/runtime/pprof/pprof.go.html#5507878">tw</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5507980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5507984"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5507987">.</span><span class="ident" id="5507988"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5507995">(</span><span class="ident" id="5507996"><a href="/gostd/runtime/pprof/pprof.go.html#5507591">w</a></span><span class="op" id="5507997">,</span>&nbsp;<span class="string" id="5507999">&#34;---&nbsp;contention:\n&#34;</span><span class="op" id="5508018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5508021"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5508024">.</span><span class="ident" id="5508025"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5508032">(</span><span class="ident" id="5508033"><a href="/gostd/runtime/pprof/pprof.go.html#5507591">w</a></span><span class="op" id="5508034">,</span>&nbsp;<span class="string" id="5508036">&#34;cycles/second=%v\n&#34;</span><span class="op" id="5508056">,</span>&nbsp;<span class="ident" id="5508058"><a href="/gostd/runtime/pprof/pprof.go.html#5508377">runtime_cyclesPerSecond</a></span><span class="op" id="5508081">(</span><span class="op" id="5508082">)</span><span class="op" id="5508083">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5508086">for</span>&nbsp;<span class="ident" id="5508090">i</span>&nbsp;<span class="op" id="5508092">:=</span>&nbsp;<span class="keyword" id="5508095">range</span>&nbsp;<span class="ident" id="5508101"><a href="/gostd/runtime/pprof/pprof.go.html#5507628">p</a></span>&nbsp;<span class="op" id="5508103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5508107">r</span>&nbsp;<span class="op" id="5508109">:=</span>&nbsp;<span class="op" id="5508112">&amp;</span><span class="ident" id="5508113"><a href="/gostd/runtime/pprof/pprof.go.html#5507628">p</a></span><span class="op" id="5508114">[</span><span class="ident" id="5508115"><a href="/gostd/runtime/pprof/pprof.go.html#5508090">i</a></span><span class="op" id="5508116">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5508120"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5508123">.</span><span class="ident" id="5508124"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5508131">(</span><span class="ident" id="5508132"><a href="/gostd/runtime/pprof/pprof.go.html#5507591">w</a></span><span class="op" id="5508133">,</span>&nbsp;<span class="string" id="5508135">&#34;%v&nbsp;%v&nbsp;@&#34;</span><span class="op" id="5508144">,</span>&nbsp;<span class="ident" id="5508146"><a href="/gostd/runtime/pprof/pprof.go.html#5508107">r</a></span><span class="op" id="5508147">.</span><span class="ident" id="5508148"><a href="/gostd/runtime/mprof.go.html#1631940">Cycles</a></span><span class="op" id="5508154">,</span>&nbsp;<span class="ident" id="5508156"><a href="/gostd/runtime/pprof/pprof.go.html#5508107">r</a></span><span class="op" id="5508157">.</span><span class="ident" id="5508158"><a href="/gostd/runtime/mprof.go.html#1631926">Count</a></span><span class="op" id="5508163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5508167">for</span>&nbsp;<span class="ident" id="5508171">_</span><span class="op" id="5508172">,</span>&nbsp;<span class="ident" id="5508174">pc</span>&nbsp;<span class="op" id="5508177">:=</span>&nbsp;<span class="keyword" id="5508180">range</span>&nbsp;<span class="ident" id="5508186"><a href="/gostd/runtime/pprof/pprof.go.html#5508107">r</a></span><span class="op" id="5508187">.</span><span class="ident" id="5508188"><a href="/gostd/runtime/mprof.go.html#1627831">Stack</a></span><span class="op" id="5508193">(</span><span class="op" id="5508194">)</span>&nbsp;<span class="op" id="5508196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5508201"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5508204">.</span><span class="ident" id="5508205"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="5508212">(</span><span class="ident" id="5508213"><a href="/gostd/runtime/pprof/pprof.go.html#5507591">w</a></span><span class="op" id="5508214">,</span>&nbsp;<span class="string" id="5508216">&#34;&nbsp;%#x&#34;</span><span class="op" id="5508222">,</span>&nbsp;<span class="ident" id="5508224"><a href="/gostd/runtime/pprof/pprof.go.html#5508174">pc</a></span><span class="op" id="5508226">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5508230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5508234"><a href="/gostd/runtime/pprof/pprof.go.html#5490131">fmt</a></span><span class="op" id="5508237">.</span><span class="ident" id="5508238"><a href="/gostd/fmt/print.go.html#2144247">Fprint</a></span><span class="op" id="5508244">(</span><span class="ident" id="5508245"><a href="/gostd/runtime/pprof/pprof.go.html#5507591">w</a></span><span class="op" id="5508246">,</span>&nbsp;<span class="string" id="5508248">&#34;\n&#34;</span><span class="op" id="5508252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5508256">if</span>&nbsp;<span class="ident" id="5508259"><a href="/gostd/runtime/pprof/pprof.go.html#5507604">debug</a></span>&nbsp;<span class="op" id="5508265">&gt;</span>&nbsp;<span class="num" id="5508267">0</span>&nbsp;<span class="op" id="5508269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5508274"><a href="/gostd/runtime/pprof/pprof.go.html#5498378">printStackRecord</a></span><span class="op" id="5508290">(</span><span class="ident" id="5508291"><a href="/gostd/runtime/pprof/pprof.go.html#5507591">w</a></span><span class="op" id="5508292">,</span>&nbsp;<span class="ident" id="5508294"><a href="/gostd/runtime/pprof/pprof.go.html#5508107">r</a></span><span class="op" id="5508295">.</span><span class="ident" id="5508296"><a href="/gostd/runtime/mprof.go.html#1627831">Stack</a></span><span class="op" id="5508301">(</span><span class="op" id="5508302">)</span><span class="op" id="5508303">,</span>&nbsp;<span class="builtintype" id="5508305">true</span><span class="op" id="5508309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5508313">}</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5508316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5508320">if</span>&nbsp;<span class="ident" id="5508323"><a href="/gostd/runtime/pprof/pprof.go.html#5507878">tw</a></span>&nbsp;<span class="op" id="5508326">!=</span>&nbsp;<span class="builtintype" id="5508329">nil</span>&nbsp;<span class="op" id="5508333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5508337"><a href="/gostd/runtime/pprof/pprof.go.html#5507878">tw</a></span><span class="op" id="5508339">.</span><span class="ident" id="5508340"><a href="/gostd/text/tabwriter/tabwriter.go.html#5522354">Flush</a></span><span class="op" id="5508345">(</span><span class="op" id="5508346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5508349">}</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5508352">return</span>&nbsp;<span class="ident" id="5508359"><a href="/gostd/runtime/pprof/pprof.go.html#5507849">b</a></span><span class="op" id="5508360">.</span><span class="ident" id="5508361"><a href="/gostd/bufio/bufio.go.html#1367486">Flush</a></span><span class="op" id="5508366">(</span><span class="op" id="5508367">)</span><br>
<span class="lineno"></span><span class="op" id="5508369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5508372">func</span>&nbsp;<span class="ident" id="5508377">runtime_cyclesPerSecond</span><span class="op" id="5508400">(</span><span class="op" id="5508401">)</span>&nbsp;<span class="builtintype" id="5508403">int64</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
