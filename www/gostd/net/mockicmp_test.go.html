<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html" class="current">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6715089">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6715145">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6715199">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6715250">package</span>&nbsp;<span class="ident" id="6715258">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6715263">import</span>&nbsp;<span class="string" id="6715270">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6715280">const</span>&nbsp;<span class="op" id="6715286">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6715289">icmpv4EchoRequest</span>&nbsp;<span class="op" id="6715307">=</span>&nbsp;<span class="num" id="6715309">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6715312">icmpv4EchoReply</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6715330">=</span>&nbsp;<span class="num" id="6715332">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6715335">icmpv6EchoRequest</span>&nbsp;<span class="op" id="6715353">=</span>&nbsp;<span class="num" id="6715355">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6715360">icmpv6EchoReply</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6715378">=</span>&nbsp;<span class="num" id="6715380">129</span><br>
<span class="lineno"></span><span class="op" id="6715384">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="6715387">//&nbsp;icmpMessage&nbsp;represents&nbsp;an&nbsp;ICMP&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="6715430">type</span>&nbsp;<span class="ident" id="6715435">icmpMessage</span>&nbsp;<span class="keyword" id="6715447">struct</span>&nbsp;<span class="op" id="6715454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6715457">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6715466">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6715482">//&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6715491">Code</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6715500">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6715516">//&nbsp;code</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6715525">Checksum</span>&nbsp;<span class="builtintype" id="6715534">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6715550">//&nbsp;checksum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6715563">Body</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6715572"><a href="/gostd/net/mockicmp_test.go.html#6715656">icmpMessageBody</a></span>&nbsp;<span class="comment" id="6715588">//&nbsp;body</span><br>
<span class="lineno"></span><span class="op" id="6715596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6715599">//&nbsp;icmpMessageBody&nbsp;represents&nbsp;an&nbsp;ICMP&nbsp;message&nbsp;body.</span><br>
<span class="lineno">25</span><span class="keyword" id="6715651">type</span>&nbsp;<span class="ident" id="6715656">icmpMessageBody</span>&nbsp;<span class="keyword" id="6715672">interface</span>&nbsp;<span class="op" id="6715682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6715685">Len</span><span class="op" id="6715688">(</span><span class="op" id="6715689">)</span>&nbsp;<span class="builtintype" id="6715691">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6715696">Marshal</span><span class="op" id="6715703">(</span><span class="op" id="6715704">)</span>&nbsp;<span class="op" id="6715706">(</span><span class="op" id="6715707">[</span><span class="op" id="6715708">]</span><span class="builtintype" id="6715709">byte</span><span class="op" id="6715713">,</span>&nbsp;<span class="builtintype" id="6715715">error</span><span class="op" id="6715720">)</span><br>
<span class="lineno"></span><span class="op" id="6715722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="6715725">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;binary&nbsp;enconding&nbsp;of&nbsp;the&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6715793">//&nbsp;reply&nbsp;message&nbsp;m.</span><br>
<span class="lineno"></span><span class="keyword" id="6715813">func</span>&nbsp;<span class="op" id="6715818">(</span><span class="ident" id="6715819">m</span>&nbsp;<span class="op" id="6715821">*</span><span class="ident" id="6715822"><a href="/gostd/net/mockicmp_test.go.html#6715435">icmpMessage</a></span><span class="op" id="6715833">)</span>&nbsp;<span class="ident" id="6715835">Marshal</span><span class="op" id="6715842">(</span><span class="op" id="6715843">)</span>&nbsp;<span class="op" id="6715845">(</span><span class="op" id="6715846">[</span><span class="op" id="6715847">]</span><span class="builtintype" id="6715848">byte</span><span class="op" id="6715852">,</span>&nbsp;<span class="builtintype" id="6715854">error</span><span class="op" id="6715859">)</span>&nbsp;<span class="op" id="6715861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6715864">b</span>&nbsp;<span class="op" id="6715866">:=</span>&nbsp;<span class="op" id="6715869">[</span><span class="op" id="6715870">]</span><span class="builtintype" id="6715871">byte</span><span class="op" id="6715875">{</span><span class="builtintype" id="6715876">byte</span><span class="op" id="6715880">(</span><span class="ident" id="6715881"><a href="/gostd/net/mockicmp_test.go.html#6715819">m</a></span><span class="op" id="6715882">.</span><span class="ident" id="6715883"><a href="/gostd/net/mockicmp_test.go.html#6715457">Type</a></span><span class="op" id="6715887">)</span><span class="op" id="6715888">,</span>&nbsp;<span class="builtintype" id="6715890">byte</span><span class="op" id="6715894">(</span><span class="ident" id="6715895"><a href="/gostd/net/mockicmp_test.go.html#6715819">m</a></span><span class="op" id="6715896">.</span><span class="ident" id="6715897"><a href="/gostd/net/mockicmp_test.go.html#6715491">Code</a></span><span class="op" id="6715901">)</span><span class="op" id="6715902">,</span>&nbsp;<span class="num" id="6715904">0</span><span class="op" id="6715905">,</span>&nbsp;<span class="num" id="6715907">0</span><span class="op" id="6715908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6715911">if</span>&nbsp;<span class="ident" id="6715914"><a href="/gostd/net/mockicmp_test.go.html#6715819">m</a></span><span class="op" id="6715915">.</span><span class="ident" id="6715916"><a href="/gostd/net/mockicmp_test.go.html#6715563">Body</a></span>&nbsp;<span class="op" id="6715921">!=</span>&nbsp;<span class="builtintype" id="6715924">nil</span>&nbsp;<span class="op" id="6715928">&amp;&amp;</span>&nbsp;<span class="ident" id="6715931"><a href="/gostd/net/mockicmp_test.go.html#6715819">m</a></span><span class="op" id="6715932">.</span><span class="ident" id="6715933"><a href="/gostd/net/mockicmp_test.go.html#6715563">Body</a></span><span class="op" id="6715937">.</span><span class="ident" id="6715938"><a href="/gostd/net/mockicmp_test.go.html#6715685">Len</a></span><span class="op" id="6715941">(</span><span class="op" id="6715942">)</span>&nbsp;<span class="op" id="6715944">!=</span>&nbsp;<span class="num" id="6715947">0</span>&nbsp;<span class="op" id="6715949">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6715953">mb</span><span class="op" id="6715955">,</span>&nbsp;<span class="ident" id="6715957">err</span>&nbsp;<span class="op" id="6715961">:=</span>&nbsp;<span class="ident" id="6715964"><a href="/gostd/net/mockicmp_test.go.html#6715819">m</a></span><span class="op" id="6715965">.</span><span class="ident" id="6715966"><a href="/gostd/net/mockicmp_test.go.html#6715563">Body</a></span><span class="op" id="6715970">.</span><span class="ident" id="6715971"><a href="/gostd/net/mockicmp_test.go.html#6715696">Marshal</a></span><span class="op" id="6715978">(</span><span class="op" id="6715979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6715983">if</span>&nbsp;<span class="ident" id="6715986"><a href="/gostd/net/mockicmp_test.go.html#6715957">err</a></span>&nbsp;<span class="op" id="6715990">!=</span>&nbsp;<span class="builtintype" id="6715993">nil</span>&nbsp;<span class="op" id="6715997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6716002">return</span>&nbsp;<span class="builtintype" id="6716009">nil</span><span class="op" id="6716012">,</span>&nbsp;<span class="ident" id="6716014"><a href="/gostd/net/mockicmp_test.go.html#6715957">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6716020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6716024"><a href="/gostd/net/mockicmp_test.go.html#6715864">b</a></span>&nbsp;<span class="op" id="6716026">=</span>&nbsp;<span class="builtinfunc" id="6716028">append</span><span class="op" id="6716034">(</span><span class="ident" id="6716035"><a href="/gostd/net/mockicmp_test.go.html#6715864">b</a></span><span class="op" id="6716036">,</span>&nbsp;<span class="ident" id="6716038"><a href="/gostd/net/mockicmp_test.go.html#6715953">mb</a></span><span class="op" id="6716040">...</span><span class="op" id="6716043">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6716046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6716049">switch</span>&nbsp;<span class="ident" id="6716056"><a href="/gostd/net/mockicmp_test.go.html#6715819">m</a></span><span class="op" id="6716057">.</span><span class="ident" id="6716058"><a href="/gostd/net/mockicmp_test.go.html#6715457">Type</a></span>&nbsp;<span class="op" id="6716063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6716066">case</span>&nbsp;<span class="ident" id="6716071"><a href="/gostd/net/mockicmp_test.go.html#6715335">icmpv6EchoRequest</a></span><span class="op" id="6716088">,</span>&nbsp;<span class="ident" id="6716090"><a href="/gostd/net/mockicmp_test.go.html#6715360">icmpv6EchoReply</a></span><span class="op" id="6716105">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6716109">return</span>&nbsp;<span class="ident" id="6716116"><a href="/gostd/net/mockicmp_test.go.html#6715864">b</a></span><span class="op" id="6716117">,</span>&nbsp;<span class="builtintype" id="6716119">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6716124">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6716127">csumcv</span>&nbsp;<span class="op" id="6716134">:=</span>&nbsp;<span class="builtinfunc" id="6716137">len</span><span class="op" id="6716140">(</span><span class="ident" id="6716141"><a href="/gostd/net/mockicmp_test.go.html#6715864">b</a></span><span class="op" id="6716142">)</span>&nbsp;<span class="op" id="6716144">-</span>&nbsp;<span class="num" id="6716146">1</span>&nbsp;<span class="comment" id="6716148">//&nbsp;checksum&nbsp;coverage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6716170">s</span>&nbsp;<span class="op" id="6716172">:=</span>&nbsp;<span class="builtintype" id="6716175">uint32</span><span class="op" id="6716181">(</span><span class="num" id="6716182">0</span><span class="op" id="6716183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6716186">for</span>&nbsp;<span class="ident" id="6716190">i</span>&nbsp;<span class="op" id="6716192">:=</span>&nbsp;<span class="num" id="6716195">0</span><span class="op" id="6716196">;</span>&nbsp;<span class="ident" id="6716198"><a href="/gostd/net/mockicmp_test.go.html#6716190">i</a></span>&nbsp;<span class="op" id="6716200">&lt;</span>&nbsp;<span class="ident" id="6716202"><a href="/gostd/net/mockicmp_test.go.html#6716127">csumcv</a></span><span class="op" id="6716208">;</span>&nbsp;<span class="ident" id="6716210"><a href="/gostd/net/mockicmp_test.go.html#6716190">i</a></span>&nbsp;<span class="op" id="6716212">+=</span>&nbsp;<span class="num" id="6716215">2</span>&nbsp;<span class="op" id="6716217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6716221"><a href="/gostd/net/mockicmp_test.go.html#6716170">s</a></span>&nbsp;<span class="op" id="6716223">+=</span>&nbsp;<span class="builtintype" id="6716226">uint32</span><span class="op" id="6716232">(</span><span class="ident" id="6716233"><a href="/gostd/net/mockicmp_test.go.html#6715864">b</a></span><span class="op" id="6716234">[</span><span class="ident" id="6716235"><a href="/gostd/net/mockicmp_test.go.html#6716190">i</a></span><span class="op" id="6716236">+</span><span class="num" id="6716237">1</span><span class="op" id="6716238">]</span><span class="op" id="6716239">)</span><span class="op" id="6716240">&lt;&lt;</span><span class="num" id="6716242">8</span>&nbsp;<span class="op" id="6716244">|</span>&nbsp;<span class="builtintype" id="6716246">uint32</span><span class="op" id="6716252">(</span><span class="ident" id="6716253"><a href="/gostd/net/mockicmp_test.go.html#6715864">b</a></span><span class="op" id="6716254">[</span><span class="ident" id="6716255"><a href="/gostd/net/mockicmp_test.go.html#6716190">i</a></span><span class="op" id="6716256">]</span><span class="op" id="6716257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6716260">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6716263">if</span>&nbsp;<span class="ident" id="6716266"><a href="/gostd/net/mockicmp_test.go.html#6716127">csumcv</a></span><span class="op" id="6716272">&amp;</span><span class="num" id="6716273">1</span>&nbsp;<span class="op" id="6716275">==</span>&nbsp;<span class="num" id="6716278">0</span>&nbsp;<span class="op" id="6716280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6716284"><a href="/gostd/net/mockicmp_test.go.html#6716170">s</a></span>&nbsp;<span class="op" id="6716286">+=</span>&nbsp;<span class="builtintype" id="6716289">uint32</span><span class="op" id="6716295">(</span><span class="ident" id="6716296"><a href="/gostd/net/mockicmp_test.go.html#6715864">b</a></span><span class="op" id="6716297">[</span><span class="ident" id="6716298"><a href="/gostd/net/mockicmp_test.go.html#6716127">csumcv</a></span><span class="op" id="6716304">]</span><span class="op" id="6716305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6716308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6716311"><a href="/gostd/net/mockicmp_test.go.html#6716170">s</a></span>&nbsp;<span class="op" id="6716313">=</span>&nbsp;<span class="ident" id="6716315"><a href="/gostd/net/mockicmp_test.go.html#6716170">s</a></span><span class="op" id="6716316">&gt;&gt;</span><span class="num" id="6716318">16</span>&nbsp;<span class="op" id="6716321">+</span>&nbsp;<span class="ident" id="6716323"><a href="/gostd/net/mockicmp_test.go.html#6716170">s</a></span><span class="op" id="6716324">&amp;</span><span class="num" id="6716325">0xffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6716333"><a href="/gostd/net/mockicmp_test.go.html#6716170">s</a></span>&nbsp;<span class="op" id="6716335">=</span>&nbsp;<span class="ident" id="6716337"><a href="/gostd/net/mockicmp_test.go.html#6716170">s</a></span>&nbsp;<span class="op" id="6716339">+</span>&nbsp;<span class="ident" id="6716341"><a href="/gostd/net/mockicmp_test.go.html#6716170">s</a></span><span class="op" id="6716342">&gt;&gt;</span><span class="num" id="6716344">16</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6716348">//&nbsp;Place&nbsp;checksum&nbsp;back&nbsp;in&nbsp;header;&nbsp;using&nbsp;^=&nbsp;avoids&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6716403">//&nbsp;assumption&nbsp;the&nbsp;checksum&nbsp;bytes&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6716447"><a href="/gostd/net/mockicmp_test.go.html#6715864">b</a></span><span class="op" id="6716448">[</span><span class="num" id="6716449">2</span><span class="op" id="6716450">]</span>&nbsp;<span class="op" id="6716452">^=</span>&nbsp;<span class="builtintype" id="6716455">byte</span><span class="op" id="6716459">(</span><span class="op" id="6716460">^</span><span class="ident" id="6716461"><a href="/gostd/net/mockicmp_test.go.html#6716170">s</a></span><span class="op" id="6716462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6716465"><a href="/gostd/net/mockicmp_test.go.html#6715864">b</a></span><span class="op" id="6716466">[</span><span class="num" id="6716467">3</span><span class="op" id="6716468">]</span>&nbsp;<span class="op" id="6716470">^=</span>&nbsp;<span class="builtintype" id="6716473">byte</span><span class="op" id="6716477">(</span><span class="op" id="6716478">^</span><span class="ident" id="6716479"><a href="/gostd/net/mockicmp_test.go.html#6716170">s</a></span>&nbsp;<span class="op" id="6716481">&gt;&gt;</span>&nbsp;<span class="num" id="6716484">8</span><span class="op" id="6716485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6716488">return</span>&nbsp;<span class="ident" id="6716495"><a href="/gostd/net/mockicmp_test.go.html#6715864">b</a></span><span class="op" id="6716496">,</span>&nbsp;<span class="builtintype" id="6716498">nil</span><br>
<span class="lineno">60</span><span class="op" id="6716502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6716505">//&nbsp;parseICMPMessage&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;ICMP&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="6716554">func</span>&nbsp;<span class="ident" id="6716559">parseICMPMessage</span><span class="op" id="6716575">(</span><span class="ident" id="6716576">b</span>&nbsp;<span class="op" id="6716578">[</span><span class="op" id="6716579">]</span><span class="builtintype" id="6716580">byte</span><span class="op" id="6716584">)</span>&nbsp;<span class="op" id="6716586">(</span><span class="op" id="6716587">*</span><span class="ident" id="6716588"><a href="/gostd/net/mockicmp_test.go.html#6715435">icmpMessage</a></span><span class="op" id="6716599">,</span>&nbsp;<span class="builtintype" id="6716601">error</span><span class="op" id="6716606">)</span>&nbsp;<span class="op" id="6716608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6716611">msglen</span>&nbsp;<span class="op" id="6716618">:=</span>&nbsp;<span class="builtinfunc" id="6716621">len</span><span class="op" id="6716624">(</span><span class="ident" id="6716625"><a href="/gostd/net/mockicmp_test.go.html#6716576">b</a></span><span class="op" id="6716626">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6716629">if</span>&nbsp;<span class="ident" id="6716632"><a href="/gostd/net/mockicmp_test.go.html#6716611">msglen</a></span>&nbsp;<span class="op" id="6716639">&lt;</span>&nbsp;<span class="num" id="6716641">4</span>&nbsp;<span class="op" id="6716643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6716647">return</span>&nbsp;<span class="builtintype" id="6716654">nil</span><span class="op" id="6716657">,</span>&nbsp;<span class="ident" id="6716659"><a href="/gostd/net/mockicmp_test.go.html#6715270">errors</a></span><span class="op" id="6716665">.</span><span class="ident" id="6716666"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="6716669">(</span><span class="string" id="6716670">&#34;message&nbsp;too&nbsp;short&#34;</span><span class="op" id="6716689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6716692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6716695">m</span>&nbsp;<span class="op" id="6716697">:=</span>&nbsp;<span class="op" id="6716700">&amp;</span><span class="ident" id="6716701"><a href="/gostd/net/mockicmp_test.go.html#6715435">icmpMessage</a></span><span class="op" id="6716712">{</span><span class="ident" id="6716713"><a href="/gostd/net/mockicmp_test.go.html#6715457">Type</a></span><span class="op" id="6716717">:</span>&nbsp;<span class="builtintype" id="6716719">int</span><span class="op" id="6716722">(</span><span class="ident" id="6716723"><a href="/gostd/net/mockicmp_test.go.html#6716576">b</a></span><span class="op" id="6716724">[</span><span class="num" id="6716725">0</span><span class="op" id="6716726">]</span><span class="op" id="6716727">)</span><span class="op" id="6716728">,</span>&nbsp;<span class="ident" id="6716730"><a href="/gostd/net/mockicmp_test.go.html#6715491">Code</a></span><span class="op" id="6716734">:</span>&nbsp;<span class="builtintype" id="6716736">int</span><span class="op" id="6716739">(</span><span class="ident" id="6716740"><a href="/gostd/net/mockicmp_test.go.html#6716576">b</a></span><span class="op" id="6716741">[</span><span class="num" id="6716742">1</span><span class="op" id="6716743">]</span><span class="op" id="6716744">)</span><span class="op" id="6716745">,</span>&nbsp;<span class="ident" id="6716747"><a href="/gostd/net/mockicmp_test.go.html#6715525">Checksum</a></span><span class="op" id="6716755">:</span>&nbsp;<span class="builtintype" id="6716757">int</span><span class="op" id="6716760">(</span><span class="ident" id="6716761"><a href="/gostd/net/mockicmp_test.go.html#6716576">b</a></span><span class="op" id="6716762">[</span><span class="num" id="6716763">2</span><span class="op" id="6716764">]</span><span class="op" id="6716765">)</span><span class="op" id="6716766">&lt;&lt;</span><span class="num" id="6716768">8</span>&nbsp;<span class="op" id="6716770">|</span>&nbsp;<span class="builtintype" id="6716772">int</span><span class="op" id="6716775">(</span><span class="ident" id="6716776"><a href="/gostd/net/mockicmp_test.go.html#6716576">b</a></span><span class="op" id="6716777">[</span><span class="num" id="6716778">3</span><span class="op" id="6716779">]</span><span class="op" id="6716780">)</span><span class="op" id="6716781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6716784">if</span>&nbsp;<span class="ident" id="6716787"><a href="/gostd/net/mockicmp_test.go.html#6716611">msglen</a></span>&nbsp;<span class="op" id="6716794">&gt;</span>&nbsp;<span class="num" id="6716796">4</span>&nbsp;<span class="op" id="6716798">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6716802">var</span>&nbsp;<span class="ident" id="6716806">err</span>&nbsp;<span class="builtintype" id="6716810">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6716818">switch</span>&nbsp;<span class="ident" id="6716825"><a href="/gostd/net/mockicmp_test.go.html#6716695">m</a></span><span class="op" id="6716826">.</span><span class="ident" id="6716827"><a href="/gostd/net/mockicmp_test.go.html#6715457">Type</a></span>&nbsp;<span class="op" id="6716832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6716836">case</span>&nbsp;<span class="ident" id="6716841"><a href="/gostd/net/mockicmp_test.go.html#6715289">icmpv4EchoRequest</a></span><span class="op" id="6716858">,</span>&nbsp;<span class="ident" id="6716860"><a href="/gostd/net/mockicmp_test.go.html#6715312">icmpv4EchoReply</a></span><span class="op" id="6716875">,</span>&nbsp;<span class="ident" id="6716877"><a href="/gostd/net/mockicmp_test.go.html#6715335">icmpv6EchoRequest</a></span><span class="op" id="6716894">,</span>&nbsp;<span class="ident" id="6716896"><a href="/gostd/net/mockicmp_test.go.html#6715360">icmpv6EchoReply</a></span><span class="op" id="6716911">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6716916"><a href="/gostd/net/mockicmp_test.go.html#6716695">m</a></span><span class="op" id="6716917">.</span><span class="ident" id="6716918"><a href="/gostd/net/mockicmp_test.go.html#6715563">Body</a></span><span class="op" id="6716922">,</span>&nbsp;<span class="ident" id="6716924"><a href="/gostd/net/mockicmp_test.go.html#6716806">err</a></span>&nbsp;<span class="op" id="6716928">=</span>&nbsp;<span class="ident" id="6716930"><a href="/gostd/net/mockicmp_test.go.html#6717657">parseICMPEcho</a></span><span class="op" id="6716943">(</span><span class="ident" id="6716944"><a href="/gostd/net/mockicmp_test.go.html#6716576">b</a></span><span class="op" id="6716945">[</span><span class="num" id="6716946">4</span><span class="op" id="6716947">:</span><span class="op" id="6716948">]</span><span class="op" id="6716949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6716954">if</span>&nbsp;<span class="ident" id="6716957"><a href="/gostd/net/mockicmp_test.go.html#6716806">err</a></span>&nbsp;<span class="op" id="6716961">!=</span>&nbsp;<span class="builtintype" id="6716964">nil</span>&nbsp;<span class="op" id="6716968">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6716974">return</span>&nbsp;<span class="builtintype" id="6716981">nil</span><span class="op" id="6716984">,</span>&nbsp;<span class="ident" id="6716986"><a href="/gostd/net/mockicmp_test.go.html#6716806">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6716993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6716997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6717000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6717003">return</span>&nbsp;<span class="ident" id="6717010"><a href="/gostd/net/mockicmp_test.go.html#6716695">m</a></span><span class="op" id="6717011">,</span>&nbsp;<span class="builtintype" id="6717013">nil</span><br>
<span class="lineno">80</span><span class="op" id="6717017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6717020">//&nbsp;imcpEcho&nbsp;represenets&nbsp;an&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or&nbsp;reply&nbsp;message&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="6717088">type</span>&nbsp;<span class="ident" id="6717093">icmpEcho</span>&nbsp;<span class="keyword" id="6717102">struct</span>&nbsp;<span class="op" id="6717109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6717112">ID</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6717117">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6717124">//&nbsp;identifier</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6717139">Seq</span>&nbsp;&nbsp;<span class="builtintype" id="6717144">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6717151">//&nbsp;sequence&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6717171">Data</span>&nbsp;<span class="op" id="6717176">[</span><span class="op" id="6717177">]</span><span class="builtintype" id="6717178">byte</span>&nbsp;<span class="comment" id="6717183">//&nbsp;data</span><br>
<span class="lineno"></span><span class="op" id="6717191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6717194">func</span>&nbsp;<span class="op" id="6717199">(</span><span class="ident" id="6717200">p</span>&nbsp;<span class="op" id="6717202">*</span><span class="ident" id="6717203"><a href="/gostd/net/mockicmp_test.go.html#6717093">icmpEcho</a></span><span class="op" id="6717211">)</span>&nbsp;<span class="ident" id="6717213">Len</span><span class="op" id="6717216">(</span><span class="op" id="6717217">)</span>&nbsp;<span class="builtintype" id="6717219">int</span>&nbsp;<span class="op" id="6717223">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6717226">if</span>&nbsp;<span class="ident" id="6717229"><a href="/gostd/net/mockicmp_test.go.html#6717200">p</a></span>&nbsp;<span class="op" id="6717231">==</span>&nbsp;<span class="builtintype" id="6717234">nil</span>&nbsp;<span class="op" id="6717238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6717242">return</span>&nbsp;<span class="num" id="6717249">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6717252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6717255">return</span>&nbsp;<span class="num" id="6717262">4</span>&nbsp;<span class="op" id="6717264">+</span>&nbsp;<span class="builtinfunc" id="6717266">len</span><span class="op" id="6717269">(</span><span class="ident" id="6717270"><a href="/gostd/net/mockicmp_test.go.html#6717200">p</a></span><span class="op" id="6717271">.</span><span class="ident" id="6717272"><a href="/gostd/net/mockicmp_test.go.html#6717171">Data</a></span><span class="op" id="6717276">)</span><br>
<span class="lineno"></span><span class="op" id="6717278">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="6717281">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;binary&nbsp;enconding&nbsp;of&nbsp;the&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6717349">//&nbsp;reply&nbsp;message&nbsp;body&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="6717374">func</span>&nbsp;<span class="op" id="6717379">(</span><span class="ident" id="6717380">p</span>&nbsp;<span class="op" id="6717382">*</span><span class="ident" id="6717383"><a href="/gostd/net/mockicmp_test.go.html#6717093">icmpEcho</a></span><span class="op" id="6717391">)</span>&nbsp;<span class="ident" id="6717393">Marshal</span><span class="op" id="6717400">(</span><span class="op" id="6717401">)</span>&nbsp;<span class="op" id="6717403">(</span><span class="op" id="6717404">[</span><span class="op" id="6717405">]</span><span class="builtintype" id="6717406">byte</span><span class="op" id="6717410">,</span>&nbsp;<span class="builtintype" id="6717412">error</span><span class="op" id="6717417">)</span>&nbsp;<span class="op" id="6717419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6717422">b</span>&nbsp;<span class="op" id="6717424">:=</span>&nbsp;<span class="builtinfunc" id="6717427">make</span><span class="op" id="6717431">(</span><span class="op" id="6717432">[</span><span class="op" id="6717433">]</span><span class="builtintype" id="6717434">byte</span><span class="op" id="6717438">,</span>&nbsp;<span class="num" id="6717440">4</span><span class="op" id="6717441">+</span><span class="builtinfunc" id="6717442">len</span><span class="op" id="6717445">(</span><span class="ident" id="6717446"><a href="/gostd/net/mockicmp_test.go.html#6717380">p</a></span><span class="op" id="6717447">.</span><span class="ident" id="6717448"><a href="/gostd/net/mockicmp_test.go.html#6717171">Data</a></span><span class="op" id="6717452">)</span><span class="op" id="6717453">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6717456"><a href="/gostd/net/mockicmp_test.go.html#6717422">b</a></span><span class="op" id="6717457">[</span><span class="num" id="6717458">0</span><span class="op" id="6717459">]</span><span class="op" id="6717460">,</span>&nbsp;<span class="ident" id="6717462"><a href="/gostd/net/mockicmp_test.go.html#6717422">b</a></span><span class="op" id="6717463">[</span><span class="num" id="6717464">1</span><span class="op" id="6717465">]</span>&nbsp;<span class="op" id="6717467">=</span>&nbsp;<span class="builtintype" id="6717469">byte</span><span class="op" id="6717473">(</span><span class="ident" id="6717474"><a href="/gostd/net/mockicmp_test.go.html#6717380">p</a></span><span class="op" id="6717475">.</span><span class="ident" id="6717476"><a href="/gostd/net/mockicmp_test.go.html#6717112">ID</a></span><span class="op" id="6717478">&gt;&gt;</span><span class="num" id="6717480">8</span><span class="op" id="6717481">)</span><span class="op" id="6717482">,</span>&nbsp;<span class="builtintype" id="6717484">byte</span><span class="op" id="6717488">(</span><span class="ident" id="6717489"><a href="/gostd/net/mockicmp_test.go.html#6717380">p</a></span><span class="op" id="6717490">.</span><span class="ident" id="6717491"><a href="/gostd/net/mockicmp_test.go.html#6717112">ID</a></span><span class="op" id="6717493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6717496"><a href="/gostd/net/mockicmp_test.go.html#6717422">b</a></span><span class="op" id="6717497">[</span><span class="num" id="6717498">2</span><span class="op" id="6717499">]</span><span class="op" id="6717500">,</span>&nbsp;<span class="ident" id="6717502"><a href="/gostd/net/mockicmp_test.go.html#6717422">b</a></span><span class="op" id="6717503">[</span><span class="num" id="6717504">3</span><span class="op" id="6717505">]</span>&nbsp;<span class="op" id="6717507">=</span>&nbsp;<span class="builtintype" id="6717509">byte</span><span class="op" id="6717513">(</span><span class="ident" id="6717514"><a href="/gostd/net/mockicmp_test.go.html#6717380">p</a></span><span class="op" id="6717515">.</span><span class="ident" id="6717516"><a href="/gostd/net/mockicmp_test.go.html#6717139">Seq</a></span><span class="op" id="6717519">&gt;&gt;</span><span class="num" id="6717521">8</span><span class="op" id="6717522">)</span><span class="op" id="6717523">,</span>&nbsp;<span class="builtintype" id="6717525">byte</span><span class="op" id="6717529">(</span><span class="ident" id="6717530"><a href="/gostd/net/mockicmp_test.go.html#6717380">p</a></span><span class="op" id="6717531">.</span><span class="ident" id="6717532"><a href="/gostd/net/mockicmp_test.go.html#6717139">Seq</a></span><span class="op" id="6717535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6717538">copy</span><span class="op" id="6717542">(</span><span class="ident" id="6717543"><a href="/gostd/net/mockicmp_test.go.html#6717422">b</a></span><span class="op" id="6717544">[</span><span class="num" id="6717545">4</span><span class="op" id="6717546">:</span><span class="op" id="6717547">]</span><span class="op" id="6717548">,</span>&nbsp;<span class="ident" id="6717550"><a href="/gostd/net/mockicmp_test.go.html#6717380">p</a></span><span class="op" id="6717551">.</span><span class="ident" id="6717552"><a href="/gostd/net/mockicmp_test.go.html#6717171">Data</a></span><span class="op" id="6717556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6717559">return</span>&nbsp;<span class="ident" id="6717566"><a href="/gostd/net/mockicmp_test.go.html#6717422">b</a></span><span class="op" id="6717567">,</span>&nbsp;<span class="builtintype" id="6717569">nil</span><br>
<span class="lineno"></span><span class="op" id="6717573">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="6717576">//&nbsp;parseICMPEcho&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or&nbsp;reply&nbsp;message</span><br>
<span class="lineno"></span><span class="comment" id="6717643">//&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="6717652">func</span>&nbsp;<span class="ident" id="6717657">parseICMPEcho</span><span class="op" id="6717670">(</span><span class="ident" id="6717671">b</span>&nbsp;<span class="op" id="6717673">[</span><span class="op" id="6717674">]</span><span class="builtintype" id="6717675">byte</span><span class="op" id="6717679">)</span>&nbsp;<span class="op" id="6717681">(</span><span class="op" id="6717682">*</span><span class="ident" id="6717683"><a href="/gostd/net/mockicmp_test.go.html#6717093">icmpEcho</a></span><span class="op" id="6717691">,</span>&nbsp;<span class="builtintype" id="6717693">error</span><span class="op" id="6717698">)</span>&nbsp;<span class="op" id="6717700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6717703">bodylen</span>&nbsp;<span class="op" id="6717711">:=</span>&nbsp;<span class="builtinfunc" id="6717714">len</span><span class="op" id="6717717">(</span><span class="ident" id="6717718"><a href="/gostd/net/mockicmp_test.go.html#6717671">b</a></span><span class="op" id="6717719">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6717722">p</span>&nbsp;<span class="op" id="6717724">:=</span>&nbsp;<span class="op" id="6717727">&amp;</span><span class="ident" id="6717728"><a href="/gostd/net/mockicmp_test.go.html#6717093">icmpEcho</a></span><span class="op" id="6717736">{</span><span class="ident" id="6717737"><a href="/gostd/net/mockicmp_test.go.html#6717112">ID</a></span><span class="op" id="6717739">:</span>&nbsp;<span class="builtintype" id="6717741">int</span><span class="op" id="6717744">(</span><span class="ident" id="6717745"><a href="/gostd/net/mockicmp_test.go.html#6717671">b</a></span><span class="op" id="6717746">[</span><span class="num" id="6717747">0</span><span class="op" id="6717748">]</span><span class="op" id="6717749">)</span><span class="op" id="6717750">&lt;&lt;</span><span class="num" id="6717752">8</span>&nbsp;<span class="op" id="6717754">|</span>&nbsp;<span class="builtintype" id="6717756">int</span><span class="op" id="6717759">(</span><span class="ident" id="6717760"><a href="/gostd/net/mockicmp_test.go.html#6717671">b</a></span><span class="op" id="6717761">[</span><span class="num" id="6717762">1</span><span class="op" id="6717763">]</span><span class="op" id="6717764">)</span><span class="op" id="6717765">,</span>&nbsp;<span class="ident" id="6717767"><a href="/gostd/net/mockicmp_test.go.html#6717139">Seq</a></span><span class="op" id="6717770">:</span>&nbsp;<span class="builtintype" id="6717772">int</span><span class="op" id="6717775">(</span><span class="ident" id="6717776"><a href="/gostd/net/mockicmp_test.go.html#6717671">b</a></span><span class="op" id="6717777">[</span><span class="num" id="6717778">2</span><span class="op" id="6717779">]</span><span class="op" id="6717780">)</span><span class="op" id="6717781">&lt;&lt;</span><span class="num" id="6717783">8</span>&nbsp;<span class="op" id="6717785">|</span>&nbsp;<span class="builtintype" id="6717787">int</span><span class="op" id="6717790">(</span><span class="ident" id="6717791"><a href="/gostd/net/mockicmp_test.go.html#6717671">b</a></span><span class="op" id="6717792">[</span><span class="num" id="6717793">3</span><span class="op" id="6717794">]</span><span class="op" id="6717795">)</span><span class="op" id="6717796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6717799">if</span>&nbsp;<span class="ident" id="6717802"><a href="/gostd/net/mockicmp_test.go.html#6717703">bodylen</a></span>&nbsp;<span class="op" id="6717810">&gt;</span>&nbsp;<span class="num" id="6717812">4</span>&nbsp;<span class="op" id="6717814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6717818"><a href="/gostd/net/mockicmp_test.go.html#6717722">p</a></span><span class="op" id="6717819">.</span><span class="ident" id="6717820"><a href="/gostd/net/mockicmp_test.go.html#6717171">Data</a></span>&nbsp;<span class="op" id="6717825">=</span>&nbsp;<span class="builtinfunc" id="6717827">make</span><span class="op" id="6717831">(</span><span class="op" id="6717832">[</span><span class="op" id="6717833">]</span><span class="builtintype" id="6717834">byte</span><span class="op" id="6717838">,</span>&nbsp;<span class="ident" id="6717840"><a href="/gostd/net/mockicmp_test.go.html#6717703">bodylen</a></span><span class="op" id="6717847">-</span><span class="num" id="6717848">4</span><span class="op" id="6717849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6717853">copy</span><span class="op" id="6717857">(</span><span class="ident" id="6717858"><a href="/gostd/net/mockicmp_test.go.html#6717722">p</a></span><span class="op" id="6717859">.</span><span class="ident" id="6717860"><a href="/gostd/net/mockicmp_test.go.html#6717171">Data</a></span><span class="op" id="6717864">,</span>&nbsp;<span class="ident" id="6717866"><a href="/gostd/net/mockicmp_test.go.html#6717671">b</a></span><span class="op" id="6717867">[</span><span class="num" id="6717868">4</span><span class="op" id="6717869">:</span><span class="op" id="6717870">]</span><span class="op" id="6717871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6717874">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6717877">return</span>&nbsp;<span class="ident" id="6717884"><a href="/gostd/net/mockicmp_test.go.html#6717722">p</a></span><span class="op" id="6717885">,</span>&nbsp;<span class="builtintype" id="6717887">nil</span><br>
<span class="lineno"></span><span class="op" id="6717891">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
