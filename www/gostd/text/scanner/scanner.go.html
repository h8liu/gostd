<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/scanner</h2>
<ul>
<li><a href="/gostd/text/scanner/scanner.go.html">scanner.go</a></li>
<li><a href="/gostd/text/scanner/scanner_test.go.html">scanner_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5880977">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5881032">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5881086">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5881137">//&nbsp;Package&nbsp;scanner&nbsp;provides&nbsp;a&nbsp;scanner&nbsp;and&nbsp;tokenizer&nbsp;for&nbsp;UTF-8-encoded&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="5881213">//&nbsp;It&nbsp;takes&nbsp;an&nbsp;io.Reader&nbsp;providing&nbsp;the&nbsp;source,&nbsp;which&nbsp;then&nbsp;can&nbsp;be&nbsp;tokenized</span><br>
<span class="lineno"></span><span class="comment" id="5881288">//&nbsp;through&nbsp;repeated&nbsp;calls&nbsp;to&nbsp;the&nbsp;Scan&nbsp;function.&nbsp;&nbsp;For&nbsp;compatibility&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5881360">//&nbsp;existing&nbsp;tools,&nbsp;the&nbsp;NUL&nbsp;character&nbsp;is&nbsp;not&nbsp;allowed.&nbsp;If&nbsp;the&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="5881436">//&nbsp;in&nbsp;the&nbsp;source&nbsp;is&nbsp;a&nbsp;UTF-8&nbsp;encoded&nbsp;byte&nbsp;order&nbsp;mark&nbsp;(BOM),&nbsp;it&nbsp;is&nbsp;discarded.</span><br>
<span class="lineno">10</span><span class="comment" id="5881512">//</span><br>
<span class="lineno"></span><span class="comment" id="5881515">//&nbsp;By&nbsp;default,&nbsp;a&nbsp;Scanner&nbsp;skips&nbsp;white&nbsp;space&nbsp;and&nbsp;Go&nbsp;comments&nbsp;and&nbsp;recognizes&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="5881593">//&nbsp;literals&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;Go&nbsp;language&nbsp;specification.&nbsp;&nbsp;It&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5881661">//&nbsp;customized&nbsp;to&nbsp;recognize&nbsp;only&nbsp;a&nbsp;subset&nbsp;of&nbsp;those&nbsp;literals&nbsp;and&nbsp;to&nbsp;recognize</span><br>
<span class="lineno"></span><span class="comment" id="5881737">//&nbsp;different&nbsp;identifier&nbsp;and&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno">15</span><span class="comment" id="5881789">//</span><br>
<span class="lineno"></span><span class="comment" id="5881792">//&nbsp;Basic&nbsp;usage&nbsp;pattern:</span><br>
<span class="lineno"></span><span class="comment" id="5881816">//</span><br>
<span class="lineno"></span><span class="comment" id="5881819">//&nbsp;&nbsp;&nbsp;&nbspvar&nbsp;s&nbsp;scanner.Scanner</span><br>
<span class="lineno"></span><span class="comment" id="5881844">//&nbsp;&nbsp;&nbsp;&nbsps.Init(src)</span><br>
<span class="lineno">20</span><span class="comment" id="5881859">//&nbsp;&nbsp;&nbsp;&nbsptok&nbsp;:=&nbsp;s.Scan()</span><br>
<span class="lineno"></span><span class="comment" id="5881878">//&nbsp;&nbsp;&nbsp;&nbspfor&nbsp;tok&nbsp;!=&nbsp;scanner.EOF&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="5881906">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;do&nbsp;something&nbsp;with&nbsp;tok</span><br>
<span class="lineno"></span><span class="comment" id="5881935">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsptok&nbsp;=&nbsp;s.Scan()</span><br>
<span class="lineno"></span><span class="comment" id="5881954">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno">25</span><span class="comment" id="5881959">//</span><br>
<span class="lineno"></span><span class="keyword" id="5881962">package</span>&nbsp;<span class="ident" id="5881970">scanner</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5881979">import</span>&nbsp;<span class="op" id="5881986">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5881989">&#34;bytes&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5881998">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5882005">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5882011">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5882017">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5882028">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">35</span><span class="op" id="5882043">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5882046">//&nbsp;A&nbsp;source&nbsp;position&nbsp;is&nbsp;represented&nbsp;by&nbsp;a&nbsp;Position&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="5882103">//&nbsp;A&nbsp;position&nbsp;is&nbsp;valid&nbsp;if&nbsp;Line&nbsp;&gt;&nbsp;0.</span><br>
<span class="lineno"></span><span class="keyword" id="5882139">type</span>&nbsp;<span class="ident" id="5882144">Position</span>&nbsp;<span class="keyword" id="5882153">struct</span>&nbsp;<span class="op" id="5882160">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882163">Filename</span>&nbsp;<span class="builtintype" id="5882172">string</span>&nbsp;<span class="comment" id="5882179">//&nbsp;filename,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882200">Offset</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5882209">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5882216">//&nbsp;byte&nbsp;offset,&nbsp;starting&nbsp;at&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882247">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5882256">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5882263">//&nbsp;line&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882294">Column</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5882303">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5882310">//&nbsp;column&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1&nbsp;(character&nbsp;count&nbsp;per&nbsp;line)</span><br>
<span class="lineno"></span><span class="op" id="5882369">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="5882372">//&nbsp;IsValid&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;position&nbsp;is&nbsp;valid.</span><br>
<span class="lineno"></span><span class="keyword" id="5882422">func</span>&nbsp;<span class="op" id="5882427">(</span><span class="ident" id="5882428">pos</span>&nbsp;<span class="op" id="5882432">*</span><span class="ident" id="5882433">Position</span><span class="op" id="5882441">)</span>&nbsp;<span class="ident" id="5882443">IsValid</span><span class="op" id="5882450">(</span><span class="op" id="5882451">)</span>&nbsp;<span class="builtintype" id="5882453">bool</span>&nbsp;<span class="op" id="5882458">{</span>&nbsp;<span class="keyword" id="5882460">return</span>&nbsp;<span class="ident" id="5882467">pos</span><span class="op" id="5882470">.</span><span class="ident" id="5882471">Line</span>&nbsp;<span class="op" id="5882476">&gt;</span>&nbsp;<span class="num" id="5882478">0</span>&nbsp;<span class="op" id="5882480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5882483">func</span>&nbsp;<span class="op" id="5882488">(</span><span class="ident" id="5882489">pos</span>&nbsp;<span class="ident" id="5882493">Position</span><span class="op" id="5882501">)</span>&nbsp;<span class="ident" id="5882503">String</span><span class="op" id="5882509">(</span><span class="op" id="5882510">)</span>&nbsp;<span class="builtintype" id="5882512">string</span>&nbsp;<span class="op" id="5882519">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882522">s</span>&nbsp;<span class="op" id="5882524">:=</span>&nbsp;<span class="ident" id="5882527">pos</span><span class="op" id="5882530">.</span><span class="ident" id="5882531">Filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5882541">if</span>&nbsp;<span class="ident" id="5882544">pos</span><span class="op" id="5882547">.</span><span class="ident" id="5882548">IsValid</span><span class="op" id="5882555">(</span><span class="op" id="5882556">)</span>&nbsp;<span class="op" id="5882558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5882562">if</span>&nbsp;<span class="ident" id="5882565">s</span>&nbsp;<span class="op" id="5882567">!=</span>&nbsp;<span class="string" id="5882570">&#34;&#34;</span>&nbsp;<span class="op" id="5882573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882578">s</span>&nbsp;<span class="op" id="5882580">+=</span>&nbsp;<span class="string" id="5882583">&#34;:&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5882589">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882593">s</span>&nbsp;<span class="op" id="5882595">+=</span>&nbsp;<span class="ident" id="5882598">fmt</span><span class="op" id="5882601">.</span><span class="ident" id="5882602">Sprintf</span><span class="op" id="5882609">(</span><span class="string" id="5882610">&#34;%d:%d&#34;</span><span class="op" id="5882617">,</span>&nbsp;<span class="ident" id="5882619">pos</span><span class="op" id="5882622">.</span><span class="ident" id="5882623">Line</span><span class="op" id="5882627">,</span>&nbsp;<span class="ident" id="5882629">pos</span><span class="op" id="5882632">.</span><span class="ident" id="5882633">Column</span><span class="op" id="5882639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5882642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5882645">if</span>&nbsp;<span class="ident" id="5882648">s</span>&nbsp;<span class="op" id="5882650">==</span>&nbsp;<span class="string" id="5882653">&#34;&#34;</span>&nbsp;<span class="op" id="5882656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882660">s</span>&nbsp;<span class="op" id="5882662">=</span>&nbsp;<span class="string" id="5882664">&#34;???&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5882671">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5882674">return</span>&nbsp;<span class="ident" id="5882681">s</span><br>
<span class="lineno"></span><span class="op" id="5882683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5882686">//&nbsp;Predefined&nbsp;mode&nbsp;bits&nbsp;to&nbsp;control&nbsp;recognition&nbsp;of&nbsp;tokens.&nbsp;For&nbsp;instance,</span><br>
<span class="lineno"></span><span class="comment" id="5882758">//&nbsp;to&nbsp;configure&nbsp;a&nbsp;Scanner&nbsp;such&nbsp;that&nbsp;it&nbsp;only&nbsp;recognizes&nbsp;(Go)&nbsp;identifiers,</span><br>
<span class="lineno">65</span><span class="comment" id="5882831">//&nbsp;integers,&nbsp;and&nbsp;skips&nbsp;comments,&nbsp;set&nbsp;the&nbsp;Scanner&#39;s&nbsp;Mode&nbsp;field&nbsp;to:</span><br>
<span class="lineno"></span><span class="comment" id="5882897">//</span><br>
<span class="lineno"></span><span class="comment" id="5882900">//&nbsp;&nbsp;&nbsp;&nbspScanIdents&nbsp;|&nbsp;ScanInts&nbsp;|&nbsp;SkipComments</span><br>
<span class="lineno"></span><span class="comment" id="5882940">//</span><br>
<span class="lineno"></span><span class="comment" id="5882943">//&nbsp;With&nbsp;the&nbsp;exceptions&nbsp;of&nbsp;comments,&nbsp;which&nbsp;are&nbsp;skipped&nbsp;if&nbsp;SkipComments&nbsp;is</span><br>
<span class="lineno">70</span><span class="comment" id="5883016">//&nbsp;set,&nbsp;unrecognized&nbsp;tokens&nbsp;are&nbsp;not&nbsp;ignored.&nbsp;Instead,&nbsp;the&nbsp;scanner&nbsp;simply</span><br>
<span class="lineno"></span><span class="comment" id="5883089">//&nbsp;returns&nbsp;the&nbsp;respective&nbsp;individual&nbsp;characters&nbsp;(or&nbsp;possibly&nbsp;sub-tokens).</span><br>
<span class="lineno"></span><span class="comment" id="5883163">//&nbsp;For&nbsp;instance,&nbsp;if&nbsp;the&nbsp;mode&nbsp;is&nbsp;ScanIdents&nbsp;(not&nbsp;ScanStrings),&nbsp;the&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="5883236">//&nbsp;&#34;foo&#34;&nbsp;is&nbsp;scanned&nbsp;as&nbsp;the&nbsp;token&nbsp;sequence&nbsp;&#39;&#34;&#39;&nbsp;Ident&nbsp;&#39;&#34;&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="5883293">//</span><br>
<span class="lineno">75</span><span class="keyword" id="5883296">const</span>&nbsp;<span class="op" id="5883302">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883305">ScanIdents</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5883320">=</span>&nbsp;<span class="num" id="5883322">1</span>&nbsp;<span class="op" id="5883324">&lt;&lt;</span>&nbsp;<span class="op" id="5883327">-</span><span class="ident" id="5883328">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883335">ScanInts</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5883350">=</span>&nbsp;<span class="num" id="5883352">1</span>&nbsp;<span class="op" id="5883354">&lt;&lt;</span>&nbsp;<span class="op" id="5883357">-</span><span class="ident" id="5883358">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883363">ScanFloats</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5883378">=</span>&nbsp;<span class="num" id="5883380">1</span>&nbsp;<span class="op" id="5883382">&lt;&lt;</span>&nbsp;<span class="op" id="5883385">-</span><span class="ident" id="5883386">Float</span>&nbsp;<span class="comment" id="5883392">//&nbsp;includes&nbsp;Ints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883410">ScanChars</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5883425">=</span>&nbsp;<span class="num" id="5883427">1</span>&nbsp;<span class="op" id="5883429">&lt;&lt;</span>&nbsp;<span class="op" id="5883432">-</span><span class="ident" id="5883433">Char</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883439">ScanStrings</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5883454">=</span>&nbsp;<span class="num" id="5883456">1</span>&nbsp;<span class="op" id="5883458">&lt;&lt;</span>&nbsp;<span class="op" id="5883461">-</span><span class="ident" id="5883462">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883470">ScanRawStrings</span>&nbsp;<span class="op" id="5883485">=</span>&nbsp;<span class="num" id="5883487">1</span>&nbsp;<span class="op" id="5883489">&lt;&lt;</span>&nbsp;<span class="op" id="5883492">-</span><span class="ident" id="5883493">RawString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883504">ScanComments</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5883519">=</span>&nbsp;<span class="num" id="5883521">1</span>&nbsp;<span class="op" id="5883523">&lt;&lt;</span>&nbsp;<span class="op" id="5883526">-</span><span class="ident" id="5883527">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883536">SkipComments</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5883551">=</span>&nbsp;<span class="num" id="5883553">1</span>&nbsp;<span class="op" id="5883555">&lt;&lt;</span>&nbsp;<span class="op" id="5883558">-</span><span class="ident" id="5883559">skipComment</span>&nbsp;<span class="comment" id="5883571">//&nbsp;if&nbsp;set&nbsp;with&nbsp;ScanComments,&nbsp;comments&nbsp;become&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883629">GoTokens</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5883644">=</span>&nbsp;<span class="ident" id="5883646">ScanIdents</span>&nbsp;<span class="op" id="5883657">|</span>&nbsp;<span class="ident" id="5883659">ScanFloats</span>&nbsp;<span class="op" id="5883670">|</span>&nbsp;<span class="ident" id="5883672">ScanChars</span>&nbsp;<span class="op" id="5883682">|</span>&nbsp;<span class="ident" id="5883684">ScanStrings</span>&nbsp;<span class="op" id="5883696">|</span>&nbsp;<span class="ident" id="5883698">ScanRawStrings</span>&nbsp;<span class="op" id="5883713">|</span>&nbsp;<span class="ident" id="5883715">ScanComments</span>&nbsp;<span class="op" id="5883728">|</span>&nbsp;<span class="ident" id="5883730">SkipComments</span><br>
<span class="lineno">85</span><span class="op" id="5883743">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5883746">//&nbsp;The&nbsp;result&nbsp;of&nbsp;Scan&nbsp;is&nbsp;one&nbsp;of&nbsp;the&nbsp;following&nbsp;tokens&nbsp;or&nbsp;a&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="5883823">const</span>&nbsp;<span class="op" id="5883829">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883832">EOF</span>&nbsp;<span class="op" id="5883836">=</span>&nbsp;<span class="op" id="5883838">-</span><span class="op" id="5883839">(</span><span class="ident" id="5883840">iota</span>&nbsp;<span class="op" id="5883845">+</span>&nbsp;<span class="num" id="5883847">1</span><span class="op" id="5883848">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883851">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883858">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883863">Float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883870">Char</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883876">String</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883884">RawString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883895">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883904">skipComment</span><br>
<span class="lineno"></span><span class="op" id="5883916">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="5883919">var</span>&nbsp;<span class="ident" id="5883923">tokenString</span>&nbsp;<span class="op" id="5883935">=</span>&nbsp;<span class="keyword" id="5883937">map</span><span class="op" id="5883940">[</span><span class="builtintype" id="5883941">rune</span><span class="op" id="5883945">]</span><span class="builtintype" id="5883946">string</span><span class="op" id="5883952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883955">EOF</span><span class="op" id="5883958">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5883966">&#34;EOF&#34;</span><span class="op" id="5883971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883974">Ident</span><span class="op" id="5883979">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5883985">&#34;Ident&#34;</span><span class="op" id="5883992">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883995">Int</span><span class="op" id="5883998">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5884006">&#34;Int&#34;</span><span class="op" id="5884011">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884014">Float</span><span class="op" id="5884019">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5884025">&#34;Float&#34;</span><span class="op" id="5884032">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884035">Char</span><span class="op" id="5884039">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5884046">&#34;Char&#34;</span><span class="op" id="5884052">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884055">String</span><span class="op" id="5884061">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5884066">&#34;String&#34;</span><span class="op" id="5884074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884077">RawString</span><span class="op" id="5884086">:</span>&nbsp;<span class="string" id="5884088">&#34;RawString&#34;</span><span class="op" id="5884099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884102">Comment</span><span class="op" id="5884109">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5884113">&#34;Comment&#34;</span><span class="op" id="5884122">,</span><br>
<span class="lineno"></span><span class="op" id="5884124">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="5884127">//&nbsp;TokenString&nbsp;returns&nbsp;a&nbsp;printable&nbsp;string&nbsp;for&nbsp;a&nbsp;token&nbsp;or&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="5884203">func</span>&nbsp;<span class="ident" id="5884208">TokenString</span><span class="op" id="5884219">(</span><span class="ident" id="5884220">tok</span>&nbsp;<span class="builtintype" id="5884224">rune</span><span class="op" id="5884228">)</span>&nbsp;<span class="builtintype" id="5884230">string</span>&nbsp;<span class="op" id="5884237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884240">if</span>&nbsp;<span class="ident" id="5884243">s</span><span class="op" id="5884244">,</span>&nbsp;<span class="ident" id="5884246">found</span>&nbsp;<span class="op" id="5884252">:=</span>&nbsp;<span class="ident" id="5884255">tokenString</span><span class="op" id="5884266">[</span><span class="ident" id="5884267">tok</span><span class="op" id="5884270">]</span><span class="op" id="5884271">;</span>&nbsp;<span class="ident" id="5884273">found</span>&nbsp;<span class="op" id="5884279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884283">return</span>&nbsp;<span class="ident" id="5884290">s</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5884293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884296">return</span>&nbsp;<span class="ident" id="5884303">fmt</span><span class="op" id="5884306">.</span><span class="ident" id="5884307">Sprintf</span><span class="op" id="5884314">(</span><span class="string" id="5884315">&#34;%q&#34;</span><span class="op" id="5884319">,</span>&nbsp;<span class="builtintype" id="5884321">string</span><span class="op" id="5884327">(</span><span class="ident" id="5884328">tok</span><span class="op" id="5884331">)</span><span class="op" id="5884332">)</span><br>
<span class="lineno"></span><span class="op" id="5884334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5884337">//&nbsp;GoWhitespace&nbsp;is&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;the&nbsp;Scanner&#39;s&nbsp;Whitespace&nbsp;field.</span><br>
<span class="lineno">120</span><span class="comment" id="5884410">//&nbsp;Its&nbsp;value&nbsp;selects&nbsp;Go&#39;s&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="5884460">const</span>&nbsp;<span class="ident" id="5884466">GoWhitespace</span>&nbsp;<span class="op" id="5884479">=</span>&nbsp;<span class="num" id="5884481">1</span><span class="op" id="5884482">&lt;&lt;</span><span class="string" id="5884484">&#39;\t&#39;</span>&nbsp;<span class="op" id="5884489">|</span>&nbsp;<span class="num" id="5884491">1</span><span class="op" id="5884492">&lt;&lt;</span><span class="string" id="5884494">&#39;\n&#39;</span>&nbsp;<span class="op" id="5884499">|</span>&nbsp;<span class="num" id="5884501">1</span><span class="op" id="5884502">&lt;&lt;</span><span class="string" id="5884504">&#39;\r&#39;</span>&nbsp;<span class="op" id="5884509">|</span>&nbsp;<span class="num" id="5884511">1</span><span class="op" id="5884512">&lt;&lt;</span><span class="string" id="5884514">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5884519">const</span>&nbsp;<span class="ident" id="5884525">bufLen</span>&nbsp;<span class="op" id="5884532">=</span>&nbsp;<span class="num" id="5884534">1024</span>&nbsp;<span class="comment" id="5884539">//&nbsp;at&nbsp;least&nbsp;utf8.UTFMax</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="5884564">//&nbsp;A&nbsp;Scanner&nbsp;implements&nbsp;reading&nbsp;of&nbsp;Unicode&nbsp;characters&nbsp;and&nbsp;tokens&nbsp;from&nbsp;an&nbsp;io.Reader.</span><br>
<span class="lineno"></span><span class="keyword" id="5884648">type</span>&nbsp;<span class="ident" id="5884653">Scanner</span>&nbsp;<span class="keyword" id="5884661">struct</span>&nbsp;<span class="op" id="5884668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5884671">//&nbsp;Input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884681">src</span>&nbsp;<span class="ident" id="5884685">io</span><span class="op" id="5884687">.</span><span class="ident" id="5884688">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5884697">//&nbsp;Source&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884715">srcBuf</span>&nbsp;<span class="op" id="5884722">[</span><span class="ident" id="5884723">bufLen</span>&nbsp;<span class="op" id="5884730">+</span>&nbsp;<span class="num" id="5884732">1</span><span class="op" id="5884733">]</span><span class="builtintype" id="5884734">byte</span>&nbsp;<span class="comment" id="5884739">//&nbsp;+1&nbsp;for&nbsp;sentinel&nbsp;for&nbsp;common&nbsp;case&nbsp;of&nbsp;s.next()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884787">srcPos</span>&nbsp;<span class="builtintype" id="5884794">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5884811">//&nbsp;reading&nbsp;position&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884847">srcEnd</span>&nbsp;<span class="builtintype" id="5884854">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5884871">//&nbsp;source&nbsp;end&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5884902">//&nbsp;Source&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884922">srcBufOffset</span>&nbsp;<span class="builtintype" id="5884935">int</span>&nbsp;<span class="comment" id="5884939">//&nbsp;byte&nbsp;offset&nbsp;of&nbsp;srcBuf[0]&nbsp;in&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884978">line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5884991">int</span>&nbsp;<span class="comment" id="5884995">//&nbsp;line&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5885010">column</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5885023">int</span>&nbsp;<span class="comment" id="5885027">//&nbsp;character&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5885047">lastLineLen</span>&nbsp;&nbsp;<span class="builtintype" id="5885060">int</span>&nbsp;<span class="comment" id="5885064">//&nbsp;length&nbsp;of&nbsp;last&nbsp;line&nbsp;in&nbsp;characters&nbsp;(for&nbsp;correct&nbsp;column&nbsp;reporting)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5885133">lastCharLen</span>&nbsp;&nbsp;<span class="builtintype" id="5885146">int</span>&nbsp;<span class="comment" id="5885150">//&nbsp;length&nbsp;of&nbsp;last&nbsp;character&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5885189">//&nbsp;Token&nbsp;text&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5885211">//&nbsp;Typically,&nbsp;token&nbsp;text&nbsp;is&nbsp;stored&nbsp;completely&nbsp;in&nbsp;srcBuf,&nbsp;but&nbsp;in&nbsp;general</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5885284">//&nbsp;the&nbsp;token&nbsp;text&#39;s&nbsp;head&nbsp;may&nbsp;be&nbsp;buffered&nbsp;in&nbsp;tokBuf&nbsp;while&nbsp;the&nbsp;token&nbsp;text&#39;s</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5885359">//&nbsp;tail&nbsp;is&nbsp;stored&nbsp;in&nbsp;srcBuf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5885389">tokBuf</span>&nbsp;<span class="ident" id="5885396">bytes</span><span class="op" id="5885401">.</span><span class="ident" id="5885402">Buffer</span>&nbsp;<span class="comment" id="5885409">//&nbsp;token&nbsp;text&nbsp;head&nbsp;that&nbsp;is&nbsp;not&nbsp;in&nbsp;srcBuf&nbsp;anymore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5885459">tokPos</span>&nbsp;<span class="builtintype" id="5885466">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5885479">//&nbsp;token&nbsp;text&nbsp;tail&nbsp;position&nbsp;(srcBuf&nbsp;index);&nbsp;valid&nbsp;if&nbsp;&gt;=&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5885538">tokEnd</span>&nbsp;<span class="builtintype" id="5885545">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5885558">//&nbsp;token&nbsp;text&nbsp;tail&nbsp;end&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5885598">//&nbsp;One&nbsp;character&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5885627">ch</span>&nbsp;<span class="builtintype" id="5885630">rune</span>&nbsp;<span class="comment" id="5885635">//&nbsp;character&nbsp;before&nbsp;current&nbsp;srcPos</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5885672">//&nbsp;Error&nbsp;is&nbsp;called&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered.&nbsp;If&nbsp;no&nbsp;Error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5885732">//&nbsp;function&nbsp;is&nbsp;set,&nbsp;the&nbsp;error&nbsp;is&nbsp;reported&nbsp;to&nbsp;os.Stderr.</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5885789">Error</span>&nbsp;<span class="keyword" id="5885795">func</span><span class="op" id="5885799">(</span><span class="ident" id="5885800">s</span>&nbsp;<span class="op" id="5885802">*</span><span class="ident" id="5885803">Scanner</span><span class="op" id="5885810">,</span>&nbsp;<span class="ident" id="5885812">msg</span>&nbsp;<span class="builtintype" id="5885816">string</span><span class="op" id="5885822">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5885826">//&nbsp;ErrorCount&nbsp;is&nbsp;incremented&nbsp;by&nbsp;one&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5885891">ErrorCount</span>&nbsp;<span class="builtintype" id="5885902">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5885908">//&nbsp;The&nbsp;Mode&nbsp;field&nbsp;controls&nbsp;which&nbsp;tokens&nbsp;are&nbsp;recognized.&nbsp;For&nbsp;instance,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5885979">//&nbsp;to&nbsp;recognize&nbsp;Ints,&nbsp;set&nbsp;the&nbsp;ScanInts&nbsp;bit&nbsp;in&nbsp;Mode.&nbsp;The&nbsp;field&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5886049">//&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5886074">Mode</span>&nbsp;<span class="builtintype" id="5886079">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5886086">//&nbsp;The&nbsp;Whitespace&nbsp;field&nbsp;controls&nbsp;which&nbsp;characters&nbsp;are&nbsp;recognized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5886152">//&nbsp;as&nbsp;white&nbsp;space.&nbsp;To&nbsp;recognize&nbsp;a&nbsp;character&nbsp;ch&nbsp;&lt;=&nbsp;&#39;&nbsp;&#39;&nbsp;as&nbsp;white&nbsp;space,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5886223">//&nbsp;set&nbsp;the&nbsp;ch&#39;th&nbsp;bit&nbsp;in&nbsp;Whitespace&nbsp;(the&nbsp;Scanner&#39;s&nbsp;behavior&nbsp;is&nbsp;undefined</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5886296">//&nbsp;for&nbsp;values&nbsp;ch&nbsp;&gt;&nbsp;&#39;&nbsp;&#39;).&nbsp;The&nbsp;field&nbsp;may&nbsp;be&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5886360">Whitespace</span>&nbsp;<span class="ident" id="5886371">uint64</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5886380">//&nbsp;IsIdentRune&nbsp;is&nbsp;a&nbsp;predicate&nbsp;controlling&nbsp;the&nbsp;characters&nbsp;accepted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5886447">//&nbsp;as&nbsp;the&nbsp;ith&nbsp;rune&nbsp;in&nbsp;an&nbsp;identifier.&nbsp;The&nbsp;set&nbsp;of&nbsp;valid&nbsp;characters</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5886513">//&nbsp;must&nbsp;not&nbsp;intersect&nbsp;with&nbsp;the&nbsp;set&nbsp;of&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5886576">//&nbsp;If&nbsp;no&nbsp;IsIdentRune&nbsp;function&nbsp;is&nbsp;set,&nbsp;regular&nbsp;Go&nbsp;identifiers&nbsp;are</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5886642">//&nbsp;accepted&nbsp;instead.&nbsp;The&nbsp;field&nbsp;may&nbsp;be&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5886702">IsIdentRune</span>&nbsp;<span class="keyword" id="5886714">func</span><span class="op" id="5886718">(</span><span class="ident" id="5886719">ch</span>&nbsp;<span class="builtintype" id="5886722">rune</span><span class="op" id="5886726">,</span>&nbsp;<span class="ident" id="5886728">i</span>&nbsp;<span class="builtintype" id="5886730">int</span><span class="op" id="5886733">)</span>&nbsp;<span class="builtintype" id="5886735">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5886742">//&nbsp;Start&nbsp;position&nbsp;of&nbsp;most&nbsp;recently&nbsp;scanned&nbsp;token;&nbsp;set&nbsp;by&nbsp;Scan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5886806">//&nbsp;Calling&nbsp;Init&nbsp;or&nbsp;Next&nbsp;invalidates&nbsp;the&nbsp;position&nbsp;(Line&nbsp;==&nbsp;0).</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5886869">//&nbsp;The&nbsp;Filename&nbsp;field&nbsp;is&nbsp;always&nbsp;left&nbsp;untouched&nbsp;by&nbsp;the&nbsp;Scanner.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5886933">//&nbsp;If&nbsp;an&nbsp;error&nbsp;is&nbsp;reported&nbsp;(via&nbsp;Error)&nbsp;and&nbsp;Position&nbsp;is&nbsp;invalid,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5886998">//&nbsp;the&nbsp;scanner&nbsp;is&nbsp;not&nbsp;inside&nbsp;a&nbsp;token.&nbsp;Call&nbsp;Pos&nbsp;to&nbsp;obtain&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5887065">//&nbsp;position&nbsp;in&nbsp;that&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5887092">Position</span><br>
<span class="lineno">185</span><span class="op" id="5887101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5887104">//&nbsp;Init&nbsp;initializes&nbsp;a&nbsp;Scanner&nbsp;with&nbsp;a&nbsp;new&nbsp;source&nbsp;and&nbsp;returns&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="5887167">//&nbsp;Error&nbsp;is&nbsp;set&nbsp;to&nbsp;nil,&nbsp;ErrorCount&nbsp;is&nbsp;set&nbsp;to&nbsp;0,&nbsp;Mode&nbsp;is&nbsp;set&nbsp;to&nbsp;GoTokens,</span><br>
<span class="lineno"></span><span class="comment" id="5887240">//&nbsp;and&nbsp;Whitespace&nbsp;is&nbsp;set&nbsp;to&nbsp;GoWhitespace.</span><br>
<span class="lineno">190</span><span class="keyword" id="5887282">func</span>&nbsp;<span class="op" id="5887287">(</span><span class="ident" id="5887288">s</span>&nbsp;<span class="op" id="5887290">*</span><span class="ident" id="5887291">Scanner</span><span class="op" id="5887298">)</span>&nbsp;<span class="ident" id="5887300">Init</span><span class="op" id="5887304">(</span><span class="ident" id="5887305">src</span>&nbsp;<span class="ident" id="5887309">io</span><span class="op" id="5887311">.</span><span class="ident" id="5887312">Reader</span><span class="op" id="5887318">)</span>&nbsp;<span class="op" id="5887320">*</span><span class="ident" id="5887321">Scanner</span>&nbsp;<span class="op" id="5887329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5887332">s</span><span class="op" id="5887333">.</span><span class="ident" id="5887334">src</span>&nbsp;<span class="op" id="5887338">=</span>&nbsp;<span class="ident" id="5887340">src</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5887346">//&nbsp;initialize&nbsp;source&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5887375">//&nbsp;(the&nbsp;first&nbsp;call&nbsp;to&nbsp;next()&nbsp;will&nbsp;fill&nbsp;it&nbsp;by&nbsp;calling&nbsp;src.Read)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5887439">s</span><span class="op" id="5887440">.</span><span class="ident" id="5887441">srcBuf</span><span class="op" id="5887447">[</span><span class="num" id="5887448">0</span><span class="op" id="5887449">]</span>&nbsp;<span class="op" id="5887451">=</span>&nbsp;<span class="ident" id="5887453">utf8</span><span class="op" id="5887457">.</span><span class="ident" id="5887458">RuneSelf</span>&nbsp;<span class="comment" id="5887467">//&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5887480">s</span><span class="op" id="5887481">.</span><span class="ident" id="5887482">srcPos</span>&nbsp;<span class="op" id="5887489">=</span>&nbsp;<span class="num" id="5887491">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5887494">s</span><span class="op" id="5887495">.</span><span class="ident" id="5887496">srcEnd</span>&nbsp;<span class="op" id="5887503">=</span>&nbsp;<span class="num" id="5887505">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5887509">//&nbsp;initialize&nbsp;source&nbsp;position</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5887540">s</span><span class="op" id="5887541">.</span><span class="ident" id="5887542">srcBufOffset</span>&nbsp;<span class="op" id="5887555">=</span>&nbsp;<span class="num" id="5887557">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5887560">s</span><span class="op" id="5887561">.</span><span class="ident" id="5887562">line</span>&nbsp;<span class="op" id="5887567">=</span>&nbsp;<span class="num" id="5887569">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5887572">s</span><span class="op" id="5887573">.</span><span class="ident" id="5887574">column</span>&nbsp;<span class="op" id="5887581">=</span>&nbsp;<span class="num" id="5887583">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5887586">s</span><span class="op" id="5887587">.</span><span class="ident" id="5887588">lastLineLen</span>&nbsp;<span class="op" id="5887600">=</span>&nbsp;<span class="num" id="5887602">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5887605">s</span><span class="op" id="5887606">.</span><span class="ident" id="5887607">lastCharLen</span>&nbsp;<span class="op" id="5887619">=</span>&nbsp;<span class="num" id="5887621">0</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5887625">//&nbsp;initialize&nbsp;token&nbsp;text&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5887658">//&nbsp;(required&nbsp;for&nbsp;first&nbsp;call&nbsp;to&nbsp;next()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5887699">s</span><span class="op" id="5887700">.</span><span class="ident" id="5887701">tokPos</span>&nbsp;<span class="op" id="5887708">=</span>&nbsp;<span class="op" id="5887710">-</span><span class="num" id="5887711">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5887715">//&nbsp;initialize&nbsp;one&nbsp;character&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5887755">s</span><span class="op" id="5887756">.</span><span class="ident" id="5887757">ch</span>&nbsp;<span class="op" id="5887760">=</span>&nbsp;<span class="op" id="5887762">-</span><span class="num" id="5887763">1</span>&nbsp;<span class="comment" id="5887765">//&nbsp;no&nbsp;char&nbsp;read&nbsp;yet</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5887787">//&nbsp;initialize&nbsp;public&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5887816">s</span><span class="op" id="5887817">.</span><span class="ident" id="5887818">Error</span>&nbsp;<span class="op" id="5887824">=</span>&nbsp;<span class="ident" id="5887826">nil</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5887831">s</span><span class="op" id="5887832">.</span><span class="ident" id="5887833">ErrorCount</span>&nbsp;<span class="op" id="5887844">=</span>&nbsp;<span class="num" id="5887846">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5887849">s</span><span class="op" id="5887850">.</span><span class="ident" id="5887851">Mode</span>&nbsp;<span class="op" id="5887856">=</span>&nbsp;<span class="ident" id="5887858">GoTokens</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5887868">s</span><span class="op" id="5887869">.</span><span class="ident" id="5887870">Whitespace</span>&nbsp;<span class="op" id="5887881">=</span>&nbsp;<span class="ident" id="5887883">GoWhitespace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5887897">s</span><span class="op" id="5887898">.</span><span class="ident" id="5887899">Line</span>&nbsp;<span class="op" id="5887904">=</span>&nbsp;<span class="num" id="5887906">0</span>&nbsp;<span class="comment" id="5887908">//&nbsp;invalidate&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5887939">return</span>&nbsp;<span class="ident" id="5887946">s</span><br>
<span class="lineno"></span><span class="op" id="5887948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5887951">//&nbsp;next&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character.&nbsp;It&nbsp;is&nbsp;designed&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5888025">//&nbsp;that&nbsp;only&nbsp;a&nbsp;minimal&nbsp;amount&nbsp;of&nbsp;work&nbsp;needs&nbsp;to&nbsp;be&nbsp;done&nbsp;in&nbsp;the&nbsp;common&nbsp;ASCII</span><br>
<span class="lineno">225</span><span class="comment" id="5888100">//&nbsp;case&nbsp;(one&nbsp;test&nbsp;to&nbsp;check&nbsp;for&nbsp;both&nbsp;ASCII&nbsp;and&nbsp;end-of-buffer,&nbsp;and&nbsp;one&nbsp;test</span><br>
<span class="lineno"></span><span class="comment" id="5888174">//&nbsp;to&nbsp;check&nbsp;for&nbsp;newlines).</span><br>
<span class="lineno"></span><span class="keyword" id="5888201">func</span>&nbsp;<span class="op" id="5888206">(</span><span class="ident" id="5888207">s</span>&nbsp;<span class="op" id="5888209">*</span><span class="ident" id="5888210">Scanner</span><span class="op" id="5888217">)</span>&nbsp;<span class="ident" id="5888219">next</span><span class="op" id="5888223">(</span><span class="op" id="5888224">)</span>&nbsp;<span class="builtintype" id="5888226">rune</span>&nbsp;<span class="op" id="5888231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5888234">ch</span><span class="op" id="5888236">,</span>&nbsp;<span class="ident" id="5888238">width</span>&nbsp;<span class="op" id="5888244">:=</span>&nbsp;<span class="builtintype" id="5888247">rune</span><span class="op" id="5888251">(</span><span class="ident" id="5888252">s</span><span class="op" id="5888253">.</span><span class="ident" id="5888254">srcBuf</span><span class="op" id="5888260">[</span><span class="ident" id="5888261">s</span><span class="op" id="5888262">.</span><span class="ident" id="5888263">srcPos</span><span class="op" id="5888269">]</span><span class="op" id="5888270">)</span><span class="op" id="5888271">,</span>&nbsp;<span class="num" id="5888273">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5888277">if</span>&nbsp;<span class="ident" id="5888280">ch</span>&nbsp;<span class="op" id="5888283">&gt;=</span>&nbsp;<span class="ident" id="5888286">utf8</span><span class="op" id="5888290">.</span><span class="ident" id="5888291">RuneSelf</span>&nbsp;<span class="op" id="5888300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5888304">//&nbsp;uncommon&nbsp;case:&nbsp;not&nbsp;ASCII&nbsp;or&nbsp;not&nbsp;enough&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5888354">for</span>&nbsp;<span class="ident" id="5888358">s</span><span class="op" id="5888359">.</span><span class="ident" id="5888360">srcPos</span><span class="op" id="5888366">+</span><span class="ident" id="5888367">utf8</span><span class="op" id="5888371">.</span><span class="ident" id="5888372">UTFMax</span>&nbsp;<span class="op" id="5888379">&gt;</span>&nbsp;<span class="ident" id="5888381">s</span><span class="op" id="5888382">.</span><span class="ident" id="5888383">srcEnd</span>&nbsp;<span class="op" id="5888390">&amp;&amp;</span>&nbsp;<span class="op" id="5888393">!</span><span class="ident" id="5888394">utf8</span><span class="op" id="5888398">.</span><span class="ident" id="5888399">FullRune</span><span class="op" id="5888407">(</span><span class="ident" id="5888408">s</span><span class="op" id="5888409">.</span><span class="ident" id="5888410">srcBuf</span><span class="op" id="5888416">[</span><span class="ident" id="5888417">s</span><span class="op" id="5888418">.</span><span class="ident" id="5888419">srcPos</span><span class="op" id="5888425">:</span><span class="ident" id="5888426">s</span><span class="op" id="5888427">.</span><span class="ident" id="5888428">srcEnd</span><span class="op" id="5888434">]</span><span class="op" id="5888435">)</span>&nbsp;<span class="op" id="5888437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5888442">//&nbsp;not&nbsp;enough&nbsp;bytes:&nbsp;read&nbsp;some&nbsp;more,&nbsp;but&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5888492">//&nbsp;save&nbsp;away&nbsp;token&nbsp;text&nbsp;if&nbsp;any</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5888526">if</span>&nbsp;<span class="ident" id="5888529">s</span><span class="op" id="5888530">.</span><span class="ident" id="5888531">tokPos</span>&nbsp;<span class="op" id="5888538">&gt;=</span>&nbsp;<span class="num" id="5888541">0</span>&nbsp;<span class="op" id="5888543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5888549">s</span><span class="op" id="5888550">.</span><span class="ident" id="5888551">tokBuf</span><span class="op" id="5888557">.</span><span class="ident" id="5888558">Write</span><span class="op" id="5888563">(</span><span class="ident" id="5888564">s</span><span class="op" id="5888565">.</span><span class="ident" id="5888566">srcBuf</span><span class="op" id="5888572">[</span><span class="ident" id="5888573">s</span><span class="op" id="5888574">.</span><span class="ident" id="5888575">tokPos</span><span class="op" id="5888581">:</span><span class="ident" id="5888582">s</span><span class="op" id="5888583">.</span><span class="ident" id="5888584">srcPos</span><span class="op" id="5888590">]</span><span class="op" id="5888591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5888597">s</span><span class="op" id="5888598">.</span><span class="ident" id="5888599">tokPos</span>&nbsp;<span class="op" id="5888606">=</span>&nbsp;<span class="num" id="5888608">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5888614">//&nbsp;s.tokEnd&nbsp;is&nbsp;set&nbsp;by&nbsp;Scan()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5888646">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5888651">//&nbsp;move&nbsp;unread&nbsp;bytes&nbsp;to&nbsp;beginning&nbsp;of&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5888698">copy</span><span class="op" id="5888702">(</span><span class="ident" id="5888703">s</span><span class="op" id="5888704">.</span><span class="ident" id="5888705">srcBuf</span><span class="op" id="5888711">[</span><span class="num" id="5888712">0</span><span class="op" id="5888713">:</span><span class="op" id="5888714">]</span><span class="op" id="5888715">,</span>&nbsp;<span class="ident" id="5888717">s</span><span class="op" id="5888718">.</span><span class="ident" id="5888719">srcBuf</span><span class="op" id="5888725">[</span><span class="ident" id="5888726">s</span><span class="op" id="5888727">.</span><span class="ident" id="5888728">srcPos</span><span class="op" id="5888734">:</span><span class="ident" id="5888735">s</span><span class="op" id="5888736">.</span><span class="ident" id="5888737">srcEnd</span><span class="op" id="5888743">]</span><span class="op" id="5888744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5888749">s</span><span class="op" id="5888750">.</span><span class="ident" id="5888751">srcBufOffset</span>&nbsp;<span class="op" id="5888764">+=</span>&nbsp;<span class="ident" id="5888767">s</span><span class="op" id="5888768">.</span><span class="ident" id="5888769">srcPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5888779">//&nbsp;read&nbsp;more&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5888801">//&nbsp;(an&nbsp;io.Reader&nbsp;must&nbsp;return&nbsp;io.EOF&nbsp;when&nbsp;it&nbsp;reaches</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5888856">//&nbsp;the&nbsp;end&nbsp;of&nbsp;what&nbsp;it&nbsp;is&nbsp;reading&nbsp;-&nbsp;simply&nbsp;returning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5888911">//&nbsp;n&nbsp;==&nbsp;0&nbsp;will&nbsp;make&nbsp;this&nbsp;loop&nbsp;retry&nbsp;forever;&nbsp;but&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5888967">//&nbsp;error&nbsp;is&nbsp;in&nbsp;the&nbsp;reader&nbsp;implementation&nbsp;in&nbsp;that&nbsp;case)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889025">i</span>&nbsp;<span class="op" id="5889027">:=</span>&nbsp;<span class="ident" id="5889030">s</span><span class="op" id="5889031">.</span><span class="ident" id="5889032">srcEnd</span>&nbsp;<span class="op" id="5889039">-</span>&nbsp;<span class="ident" id="5889041">s</span><span class="op" id="5889042">.</span><span class="ident" id="5889043">srcPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889053">n</span><span class="op" id="5889054">,</span>&nbsp;<span class="ident" id="5889056">err</span>&nbsp;<span class="op" id="5889060">:=</span>&nbsp;<span class="ident" id="5889063">s</span><span class="op" id="5889064">.</span><span class="ident" id="5889065">src</span><span class="op" id="5889068">.</span><span class="ident" id="5889069">Read</span><span class="op" id="5889073">(</span><span class="ident" id="5889074">s</span><span class="op" id="5889075">.</span><span class="ident" id="5889076">srcBuf</span><span class="op" id="5889082">[</span><span class="ident" id="5889083">i</span><span class="op" id="5889084">:</span><span class="ident" id="5889085">bufLen</span><span class="op" id="5889091">]</span><span class="op" id="5889092">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889097">s</span><span class="op" id="5889098">.</span><span class="ident" id="5889099">srcPos</span>&nbsp;<span class="op" id="5889106">=</span>&nbsp;<span class="num" id="5889108">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889113">s</span><span class="op" id="5889114">.</span><span class="ident" id="5889115">srcEnd</span>&nbsp;<span class="op" id="5889122">=</span>&nbsp;<span class="ident" id="5889124">i</span>&nbsp;<span class="op" id="5889126">+</span>&nbsp;<span class="ident" id="5889128">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889133">s</span><span class="op" id="5889134">.</span><span class="ident" id="5889135">srcBuf</span><span class="op" id="5889141">[</span><span class="ident" id="5889142">s</span><span class="op" id="5889143">.</span><span class="ident" id="5889144">srcEnd</span><span class="op" id="5889150">]</span>&nbsp;<span class="op" id="5889152">=</span>&nbsp;<span class="ident" id="5889154">utf8</span><span class="op" id="5889158">.</span><span class="ident" id="5889159">RuneSelf</span>&nbsp;<span class="comment" id="5889168">//&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5889183">if</span>&nbsp;<span class="ident" id="5889186">err</span>&nbsp;<span class="op" id="5889190">!=</span>&nbsp;<span class="ident" id="5889193">nil</span>&nbsp;<span class="op" id="5889197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5889203">if</span>&nbsp;<span class="ident" id="5889206">err</span>&nbsp;<span class="op" id="5889210">!=</span>&nbsp;<span class="ident" id="5889213">io</span><span class="op" id="5889215">.</span><span class="ident" id="5889216">EOF</span>&nbsp;<span class="op" id="5889220">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889227">s</span><span class="op" id="5889228">.</span><span class="builtintype" id="5889229">error</span><span class="op" id="5889234">(</span><span class="ident" id="5889235">err</span><span class="op" id="5889238">.</span><span class="ident" id="5889239">Error</span><span class="op" id="5889244">(</span><span class="op" id="5889245">)</span><span class="op" id="5889246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5889252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5889258">if</span>&nbsp;<span class="ident" id="5889261">s</span><span class="op" id="5889262">.</span><span class="ident" id="5889263">srcEnd</span>&nbsp;<span class="op" id="5889270">==</span>&nbsp;<span class="num" id="5889273">0</span>&nbsp;<span class="op" id="5889275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5889282">if</span>&nbsp;<span class="ident" id="5889285">s</span><span class="op" id="5889286">.</span><span class="ident" id="5889287">lastCharLen</span>&nbsp;<span class="op" id="5889299">&gt;</span>&nbsp;<span class="num" id="5889301">0</span>&nbsp;<span class="op" id="5889303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5889311">//&nbsp;previous&nbsp;character&nbsp;was&nbsp;not&nbsp;EOF</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889351">s</span><span class="op" id="5889352">.</span><span class="ident" id="5889353">column</span><span class="op" id="5889359">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5889367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889374">s</span><span class="op" id="5889375">.</span><span class="ident" id="5889376">lastCharLen</span>&nbsp;<span class="op" id="5889388">=</span>&nbsp;<span class="num" id="5889390">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5889397">return</span>&nbsp;<span class="ident" id="5889404">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5889412">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5889418">//&nbsp;If&nbsp;err&nbsp;==&nbsp;EOF,&nbsp;we&nbsp;won&#39;t&nbsp;be&nbsp;getting&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5889465">//&nbsp;bytes;&nbsp;break&nbsp;to&nbsp;avoid&nbsp;infinite&nbsp;loop.&nbsp;If</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5889512">//&nbsp;err&nbsp;is&nbsp;something&nbsp;else,&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5889559">//&nbsp;we&nbsp;can&nbsp;get&nbsp;more&nbsp;bytes;&nbsp;thus&nbsp;also&nbsp;break.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5889606">break</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5889615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5889619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5889623">//&nbsp;at&nbsp;least&nbsp;one&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889646">ch</span>&nbsp;<span class="op" id="5889649">=</span>&nbsp;<span class="builtintype" id="5889651">rune</span><span class="op" id="5889655">(</span><span class="ident" id="5889656">s</span><span class="op" id="5889657">.</span><span class="ident" id="5889658">srcBuf</span><span class="op" id="5889664">[</span><span class="ident" id="5889665">s</span><span class="op" id="5889666">.</span><span class="ident" id="5889667">srcPos</span><span class="op" id="5889673">]</span><span class="op" id="5889674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5889678">if</span>&nbsp;<span class="ident" id="5889681">ch</span>&nbsp;<span class="op" id="5889684">&gt;=</span>&nbsp;<span class="ident" id="5889687">utf8</span><span class="op" id="5889691">.</span><span class="ident" id="5889692">RuneSelf</span>&nbsp;<span class="op" id="5889701">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5889706">//&nbsp;uncommon&nbsp;case:&nbsp;not&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889737">ch</span><span class="op" id="5889739">,</span>&nbsp;<span class="ident" id="5889741">width</span>&nbsp;<span class="op" id="5889747">=</span>&nbsp;<span class="ident" id="5889749">utf8</span><span class="op" id="5889753">.</span><span class="ident" id="5889754">DecodeRune</span><span class="op" id="5889764">(</span><span class="ident" id="5889765">s</span><span class="op" id="5889766">.</span><span class="ident" id="5889767">srcBuf</span><span class="op" id="5889773">[</span><span class="ident" id="5889774">s</span><span class="op" id="5889775">.</span><span class="ident" id="5889776">srcPos</span><span class="op" id="5889782">:</span><span class="ident" id="5889783">s</span><span class="op" id="5889784">.</span><span class="ident" id="5889785">srcEnd</span><span class="op" id="5889791">]</span><span class="op" id="5889792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5889797">if</span>&nbsp;<span class="ident" id="5889800">ch</span>&nbsp;<span class="op" id="5889803">==</span>&nbsp;<span class="ident" id="5889806">utf8</span><span class="op" id="5889810">.</span><span class="ident" id="5889811">RuneError</span>&nbsp;<span class="op" id="5889821">&amp;&amp;</span>&nbsp;<span class="ident" id="5889824">width</span>&nbsp;<span class="op" id="5889830">==</span>&nbsp;<span class="num" id="5889833">1</span>&nbsp;<span class="op" id="5889835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5889841">//&nbsp;advance&nbsp;for&nbsp;correct&nbsp;error&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889883">s</span><span class="op" id="5889884">.</span><span class="ident" id="5889885">srcPos</span>&nbsp;<span class="op" id="5889892">+=</span>&nbsp;<span class="ident" id="5889895">width</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889905">s</span><span class="op" id="5889906">.</span><span class="ident" id="5889907">lastCharLen</span>&nbsp;<span class="op" id="5889919">=</span>&nbsp;<span class="ident" id="5889921">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889931">s</span><span class="op" id="5889932">.</span><span class="ident" id="5889933">column</span><span class="op" id="5889939">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889946">s</span><span class="op" id="5889947">.</span><span class="builtintype" id="5889948">error</span><span class="op" id="5889953">(</span><span class="string" id="5889954">&#34;illegal&nbsp;UTF-8&nbsp;encoding&#34;</span><span class="op" id="5889978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5889984">return</span>&nbsp;<span class="ident" id="5889991">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5889997">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5890001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5890004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5890008">//&nbsp;advance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890020">s</span><span class="op" id="5890021">.</span><span class="ident" id="5890022">srcPos</span>&nbsp;<span class="op" id="5890029">+=</span>&nbsp;<span class="ident" id="5890032">width</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890039">s</span><span class="op" id="5890040">.</span><span class="ident" id="5890041">lastCharLen</span>&nbsp;<span class="op" id="5890053">=</span>&nbsp;<span class="ident" id="5890055">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890062">s</span><span class="op" id="5890063">.</span><span class="ident" id="5890064">column</span><span class="op" id="5890070">++</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5890075">//&nbsp;special&nbsp;situations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5890098">switch</span>&nbsp;<span class="ident" id="5890105">ch</span>&nbsp;<span class="op" id="5890108">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5890111">case</span>&nbsp;<span class="num" id="5890116">0</span><span class="op" id="5890117">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5890121">//&nbsp;for&nbsp;compatibility&nbsp;with&nbsp;other&nbsp;tools</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890161">s</span><span class="op" id="5890162">.</span><span class="builtintype" id="5890163">error</span><span class="op" id="5890168">(</span><span class="string" id="5890169">&#34;illegal&nbsp;character&nbsp;NUL&#34;</span><span class="op" id="5890192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5890195">case</span>&nbsp;<span class="string" id="5890200">&#39;\n&#39;</span><span class="op" id="5890204">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890208">s</span><span class="op" id="5890209">.</span><span class="ident" id="5890210">line</span><span class="op" id="5890214">++</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890219">s</span><span class="op" id="5890220">.</span><span class="ident" id="5890221">lastLineLen</span>&nbsp;<span class="op" id="5890233">=</span>&nbsp;<span class="ident" id="5890235">s</span><span class="op" id="5890236">.</span><span class="ident" id="5890237">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890246">s</span><span class="op" id="5890247">.</span><span class="ident" id="5890248">column</span>&nbsp;<span class="op" id="5890255">=</span>&nbsp;<span class="num" id="5890257">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5890260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5890264">return</span>&nbsp;<span class="ident" id="5890271">ch</span><br>
<span class="lineno">305</span><span class="op" id="5890274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5890277">//&nbsp;Next&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="5890331">//&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source.&nbsp;It&nbsp;reports</span><br>
<span class="lineno"></span><span class="comment" id="5890386">//&nbsp;a&nbsp;read&nbsp;error&nbsp;by&nbsp;calling&nbsp;s.Error,&nbsp;if&nbsp;not&nbsp;nil;&nbsp;otherwise</span><br>
<span class="lineno">310</span><span class="comment" id="5890444">//&nbsp;it&nbsp;prints&nbsp;an&nbsp;error&nbsp;message&nbsp;to&nbsp;os.Stderr.&nbsp;Next&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="5890502">//&nbsp;update&nbsp;the&nbsp;Scanner&#39;s&nbsp;Position&nbsp;field;&nbsp;use&nbsp;Pos()&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5890555">//&nbsp;get&nbsp;the&nbsp;current&nbsp;position.</span><br>
<span class="lineno"></span><span class="keyword" id="5890584">func</span>&nbsp;<span class="op" id="5890589">(</span><span class="ident" id="5890590">s</span>&nbsp;<span class="op" id="5890592">*</span><span class="ident" id="5890593">Scanner</span><span class="op" id="5890600">)</span>&nbsp;<span class="ident" id="5890602">Next</span><span class="op" id="5890606">(</span><span class="op" id="5890607">)</span>&nbsp;<span class="builtintype" id="5890609">rune</span>&nbsp;<span class="op" id="5890614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890617">s</span><span class="op" id="5890618">.</span><span class="ident" id="5890619">tokPos</span>&nbsp;<span class="op" id="5890626">=</span>&nbsp;<span class="op" id="5890628">-</span><span class="num" id="5890629">1</span>&nbsp;<span class="comment" id="5890631">//&nbsp;don&#39;t&nbsp;collect&nbsp;token&nbsp;text</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890660">s</span><span class="op" id="5890661">.</span><span class="ident" id="5890662">Line</span>&nbsp;<span class="op" id="5890667">=</span>&nbsp;<span class="num" id="5890669">0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5890674">//&nbsp;invalidate&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890704">ch</span>&nbsp;<span class="op" id="5890707">:=</span>&nbsp;<span class="ident" id="5890710">s</span><span class="op" id="5890711">.</span><span class="ident" id="5890712">Peek</span><span class="op" id="5890716">(</span><span class="op" id="5890717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890720">s</span><span class="op" id="5890721">.</span><span class="ident" id="5890722">ch</span>&nbsp;<span class="op" id="5890725">=</span>&nbsp;<span class="ident" id="5890727">s</span><span class="op" id="5890728">.</span><span class="ident" id="5890729">next</span><span class="op" id="5890733">(</span><span class="op" id="5890734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5890737">return</span>&nbsp;<span class="ident" id="5890744">ch</span><br>
<span class="lineno"></span><span class="op" id="5890747">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="5890750">//&nbsp;Peek&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character&nbsp;in&nbsp;the&nbsp;source&nbsp;without&nbsp;advancing</span><br>
<span class="lineno"></span><span class="comment" id="5890825">//&nbsp;the&nbsp;scanner.&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;if&nbsp;the&nbsp;scanner&#39;s&nbsp;position&nbsp;is&nbsp;at&nbsp;the&nbsp;last</span><br>
<span class="lineno"></span><span class="comment" id="5890897">//&nbsp;character&nbsp;of&nbsp;the&nbsp;source.</span><br>
<span class="lineno"></span><span class="keyword" id="5890925">func</span>&nbsp;<span class="op" id="5890930">(</span><span class="ident" id="5890931">s</span>&nbsp;<span class="op" id="5890933">*</span><span class="ident" id="5890934">Scanner</span><span class="op" id="5890941">)</span>&nbsp;<span class="ident" id="5890943">Peek</span><span class="op" id="5890947">(</span><span class="op" id="5890948">)</span>&nbsp;<span class="builtintype" id="5890950">rune</span>&nbsp;<span class="op" id="5890955">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5890958">if</span>&nbsp;<span class="ident" id="5890961">s</span><span class="op" id="5890962">.</span><span class="ident" id="5890963">ch</span>&nbsp;<span class="op" id="5890966">&lt;</span>&nbsp;<span class="num" id="5890968">0</span>&nbsp;<span class="op" id="5890970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5890974">//&nbsp;this&nbsp;code&nbsp;is&nbsp;only&nbsp;run&nbsp;for&nbsp;the&nbsp;very&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891030">s</span><span class="op" id="5891031">.</span><span class="ident" id="5891032">ch</span>&nbsp;<span class="op" id="5891035">=</span>&nbsp;<span class="ident" id="5891037">s</span><span class="op" id="5891038">.</span><span class="ident" id="5891039">next</span><span class="op" id="5891043">(</span><span class="op" id="5891044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891048">if</span>&nbsp;<span class="ident" id="5891051">s</span><span class="op" id="5891052">.</span><span class="ident" id="5891053">ch</span>&nbsp;<span class="op" id="5891056">==</span>&nbsp;<span class="string" id="5891059">&#39;\uFEFF&#39;</span>&nbsp;<span class="op" id="5891068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891073">s</span><span class="op" id="5891074">.</span><span class="ident" id="5891075">ch</span>&nbsp;<span class="op" id="5891078">=</span>&nbsp;<span class="ident" id="5891080">s</span><span class="op" id="5891081">.</span><span class="ident" id="5891082">next</span><span class="op" id="5891086">(</span><span class="op" id="5891087">)</span>&nbsp;<span class="comment" id="5891089">//&nbsp;ignore&nbsp;BOM</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5891105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5891108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891111">return</span>&nbsp;<span class="ident" id="5891118">s</span><span class="op" id="5891119">.</span><span class="ident" id="5891120">ch</span><br>
<span class="lineno"></span><span class="op" id="5891123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="5891126">func</span>&nbsp;<span class="op" id="5891131">(</span><span class="ident" id="5891132">s</span>&nbsp;<span class="op" id="5891134">*</span><span class="ident" id="5891135">Scanner</span><span class="op" id="5891142">)</span>&nbsp;<span class="builtintype" id="5891144">error</span><span class="op" id="5891149">(</span><span class="ident" id="5891150">msg</span>&nbsp;<span class="builtintype" id="5891154">string</span><span class="op" id="5891160">)</span>&nbsp;<span class="op" id="5891162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891165">s</span><span class="op" id="5891166">.</span><span class="ident" id="5891167">ErrorCount</span><span class="op" id="5891177">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891181">if</span>&nbsp;<span class="ident" id="5891184">s</span><span class="op" id="5891185">.</span><span class="ident" id="5891186">Error</span>&nbsp;<span class="op" id="5891192">!=</span>&nbsp;<span class="ident" id="5891195">nil</span>&nbsp;<span class="op" id="5891199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891203">s</span><span class="op" id="5891204">.</span><span class="ident" id="5891205">Error</span><span class="op" id="5891210">(</span><span class="ident" id="5891211">s</span><span class="op" id="5891212">,</span>&nbsp;<span class="ident" id="5891214">msg</span><span class="op" id="5891217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891221">return</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5891229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891232">pos</span>&nbsp;<span class="op" id="5891236">:=</span>&nbsp;<span class="ident" id="5891239">s</span><span class="op" id="5891240">.</span><span class="ident" id="5891241">Position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891251">if</span>&nbsp;<span class="op" id="5891254">!</span><span class="ident" id="5891255">pos</span><span class="op" id="5891258">.</span><span class="ident" id="5891259">IsValid</span><span class="op" id="5891266">(</span><span class="op" id="5891267">)</span>&nbsp;<span class="op" id="5891269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891273">pos</span>&nbsp;<span class="op" id="5891277">=</span>&nbsp;<span class="ident" id="5891279">s</span><span class="op" id="5891280">.</span><span class="ident" id="5891281">Pos</span><span class="op" id="5891284">(</span><span class="op" id="5891285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5891288">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891291">fmt</span><span class="op" id="5891294">.</span><span class="ident" id="5891295">Fprintf</span><span class="op" id="5891302">(</span><span class="ident" id="5891303">os</span><span class="op" id="5891305">.</span><span class="ident" id="5891306">Stderr</span><span class="op" id="5891312">,</span>&nbsp;<span class="string" id="5891314">&#34;%s:&nbsp;%s\n&#34;</span><span class="op" id="5891324">,</span>&nbsp;<span class="ident" id="5891326">pos</span><span class="op" id="5891329">,</span>&nbsp;<span class="ident" id="5891331">msg</span><span class="op" id="5891334">)</span><br>
<span class="lineno"></span><span class="op" id="5891336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5891339">func</span>&nbsp;<span class="op" id="5891344">(</span><span class="ident" id="5891345">s</span>&nbsp;<span class="op" id="5891347">*</span><span class="ident" id="5891348">Scanner</span><span class="op" id="5891355">)</span>&nbsp;<span class="ident" id="5891357">isIdentRune</span><span class="op" id="5891368">(</span><span class="ident" id="5891369">ch</span>&nbsp;<span class="builtintype" id="5891372">rune</span><span class="op" id="5891376">,</span>&nbsp;<span class="ident" id="5891378">i</span>&nbsp;<span class="builtintype" id="5891380">int</span><span class="op" id="5891383">)</span>&nbsp;<span class="builtintype" id="5891385">bool</span>&nbsp;<span class="op" id="5891390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891393">if</span>&nbsp;<span class="ident" id="5891396">s</span><span class="op" id="5891397">.</span><span class="ident" id="5891398">IsIdentRune</span>&nbsp;<span class="op" id="5891410">!=</span>&nbsp;<span class="ident" id="5891413">nil</span>&nbsp;<span class="op" id="5891417">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891421">return</span>&nbsp;<span class="ident" id="5891428">s</span><span class="op" id="5891429">.</span><span class="ident" id="5891430">IsIdentRune</span><span class="op" id="5891441">(</span><span class="ident" id="5891442">ch</span><span class="op" id="5891444">,</span>&nbsp;<span class="ident" id="5891446">i</span><span class="op" id="5891447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5891450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891453">return</span>&nbsp;<span class="ident" id="5891460">ch</span>&nbsp;<span class="op" id="5891463">==</span>&nbsp;<span class="string" id="5891466">&#39;_&#39;</span>&nbsp;<span class="op" id="5891470">||</span>&nbsp;<span class="ident" id="5891473">unicode</span><span class="op" id="5891480">.</span><span class="ident" id="5891481">IsLetter</span><span class="op" id="5891489">(</span><span class="ident" id="5891490">ch</span><span class="op" id="5891492">)</span>&nbsp;<span class="op" id="5891494">||</span>&nbsp;<span class="ident" id="5891497">unicode</span><span class="op" id="5891504">.</span><span class="ident" id="5891505">IsDigit</span><span class="op" id="5891512">(</span><span class="ident" id="5891513">ch</span><span class="op" id="5891515">)</span>&nbsp;<span class="op" id="5891517">&amp;&amp;</span>&nbsp;<span class="ident" id="5891520">i</span>&nbsp;<span class="op" id="5891522">&gt;</span>&nbsp;<span class="num" id="5891524">0</span><br>
<span class="lineno"></span><span class="op" id="5891526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="keyword" id="5891529">func</span>&nbsp;<span class="op" id="5891534">(</span><span class="ident" id="5891535">s</span>&nbsp;<span class="op" id="5891537">*</span><span class="ident" id="5891538">Scanner</span><span class="op" id="5891545">)</span>&nbsp;<span class="ident" id="5891547">scanIdentifier</span><span class="op" id="5891561">(</span><span class="op" id="5891562">)</span>&nbsp;<span class="builtintype" id="5891564">rune</span>&nbsp;<span class="op" id="5891569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5891572">//&nbsp;we&nbsp;know&nbsp;the&nbsp;zero&#39;th&nbsp;rune&nbsp;is&nbsp;OK;&nbsp;start&nbsp;scanning&nbsp;at&nbsp;the&nbsp;next&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891639">ch</span>&nbsp;<span class="op" id="5891642">:=</span>&nbsp;<span class="ident" id="5891645">s</span><span class="op" id="5891646">.</span><span class="ident" id="5891647">next</span><span class="op" id="5891651">(</span><span class="op" id="5891652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891655">for</span>&nbsp;<span class="ident" id="5891659">i</span>&nbsp;<span class="op" id="5891661">:=</span>&nbsp;<span class="num" id="5891664">1</span><span class="op" id="5891665">;</span>&nbsp;<span class="ident" id="5891667">s</span><span class="op" id="5891668">.</span><span class="ident" id="5891669">isIdentRune</span><span class="op" id="5891680">(</span><span class="ident" id="5891681">ch</span><span class="op" id="5891683">,</span>&nbsp;<span class="ident" id="5891685">i</span><span class="op" id="5891686">)</span><span class="op" id="5891687">;</span>&nbsp;<span class="ident" id="5891689">i</span><span class="op" id="5891690">++</span>&nbsp;<span class="op" id="5891693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891697">ch</span>&nbsp;<span class="op" id="5891700">=</span>&nbsp;<span class="ident" id="5891702">s</span><span class="op" id="5891703">.</span><span class="ident" id="5891704">next</span><span class="op" id="5891708">(</span><span class="op" id="5891709">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5891712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891715">return</span>&nbsp;<span class="ident" id="5891722">ch</span><br>
<span class="lineno"></span><span class="op" id="5891725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5891728">func</span>&nbsp;<span class="ident" id="5891733">digitVal</span><span class="op" id="5891741">(</span><span class="ident" id="5891742">ch</span>&nbsp;<span class="builtintype" id="5891745">rune</span><span class="op" id="5891749">)</span>&nbsp;<span class="builtintype" id="5891751">int</span>&nbsp;<span class="op" id="5891755">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891758">switch</span>&nbsp;<span class="op" id="5891765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891768">case</span>&nbsp;<span class="string" id="5891773">&#39;0&#39;</span>&nbsp;<span class="op" id="5891777">&lt;=</span>&nbsp;<span class="ident" id="5891780">ch</span>&nbsp;<span class="op" id="5891783">&amp;&amp;</span>&nbsp;<span class="ident" id="5891786">ch</span>&nbsp;<span class="op" id="5891789">&lt;=</span>&nbsp;<span class="string" id="5891792">&#39;9&#39;</span><span class="op" id="5891795">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891799">return</span>&nbsp;<span class="builtintype" id="5891806">int</span><span class="op" id="5891809">(</span><span class="ident" id="5891810">ch</span>&nbsp;<span class="op" id="5891813">-</span>&nbsp;<span class="string" id="5891815">&#39;0&#39;</span><span class="op" id="5891818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891821">case</span>&nbsp;<span class="string" id="5891826">&#39;a&#39;</span>&nbsp;<span class="op" id="5891830">&lt;=</span>&nbsp;<span class="ident" id="5891833">ch</span>&nbsp;<span class="op" id="5891836">&amp;&amp;</span>&nbsp;<span class="ident" id="5891839">ch</span>&nbsp;<span class="op" id="5891842">&lt;=</span>&nbsp;<span class="string" id="5891845">&#39;f&#39;</span><span class="op" id="5891848">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891852">return</span>&nbsp;<span class="builtintype" id="5891859">int</span><span class="op" id="5891862">(</span><span class="ident" id="5891863">ch</span>&nbsp;<span class="op" id="5891866">-</span>&nbsp;<span class="string" id="5891868">&#39;a&#39;</span>&nbsp;<span class="op" id="5891872">+</span>&nbsp;<span class="num" id="5891874">10</span><span class="op" id="5891876">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891879">case</span>&nbsp;<span class="string" id="5891884">&#39;A&#39;</span>&nbsp;<span class="op" id="5891888">&lt;=</span>&nbsp;<span class="ident" id="5891891">ch</span>&nbsp;<span class="op" id="5891894">&amp;&amp;</span>&nbsp;<span class="ident" id="5891897">ch</span>&nbsp;<span class="op" id="5891900">&lt;=</span>&nbsp;<span class="string" id="5891903">&#39;F&#39;</span><span class="op" id="5891906">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891910">return</span>&nbsp;<span class="builtintype" id="5891917">int</span><span class="op" id="5891920">(</span><span class="ident" id="5891921">ch</span>&nbsp;<span class="op" id="5891924">-</span>&nbsp;<span class="string" id="5891926">&#39;A&#39;</span>&nbsp;<span class="op" id="5891930">+</span>&nbsp;<span class="num" id="5891932">10</span><span class="op" id="5891934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5891937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891940">return</span>&nbsp;<span class="num" id="5891947">16</span>&nbsp;<span class="comment" id="5891950">//&nbsp;larger&nbsp;than&nbsp;any&nbsp;legal&nbsp;digit&nbsp;val</span><br>
<span class="lineno"></span><span class="op" id="5891985">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span><span class="keyword" id="5891988">func</span>&nbsp;<span class="ident" id="5891993">isDecimal</span><span class="op" id="5892002">(</span><span class="ident" id="5892003">ch</span>&nbsp;<span class="builtintype" id="5892006">rune</span><span class="op" id="5892010">)</span>&nbsp;<span class="builtintype" id="5892012">bool</span>&nbsp;<span class="op" id="5892017">{</span>&nbsp;<span class="keyword" id="5892019">return</span>&nbsp;<span class="string" id="5892026">&#39;0&#39;</span>&nbsp;<span class="op" id="5892030">&lt;=</span>&nbsp;<span class="ident" id="5892033">ch</span>&nbsp;<span class="op" id="5892036">&amp;&amp;</span>&nbsp;<span class="ident" id="5892039">ch</span>&nbsp;<span class="op" id="5892042">&lt;=</span>&nbsp;<span class="string" id="5892045">&#39;9&#39;</span>&nbsp;<span class="op" id="5892049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5892052">func</span>&nbsp;<span class="op" id="5892057">(</span><span class="ident" id="5892058">s</span>&nbsp;<span class="op" id="5892060">*</span><span class="ident" id="5892061">Scanner</span><span class="op" id="5892068">)</span>&nbsp;<span class="ident" id="5892070">scanMantissa</span><span class="op" id="5892082">(</span><span class="ident" id="5892083">ch</span>&nbsp;<span class="builtintype" id="5892086">rune</span><span class="op" id="5892090">)</span>&nbsp;<span class="builtintype" id="5892092">rune</span>&nbsp;<span class="op" id="5892097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5892100">for</span>&nbsp;<span class="ident" id="5892104">isDecimal</span><span class="op" id="5892113">(</span><span class="ident" id="5892114">ch</span><span class="op" id="5892116">)</span>&nbsp;<span class="op" id="5892118">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892122">ch</span>&nbsp;<span class="op" id="5892125">=</span>&nbsp;<span class="ident" id="5892127">s</span><span class="op" id="5892128">.</span><span class="ident" id="5892129">next</span><span class="op" id="5892133">(</span><span class="op" id="5892134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5892137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5892140">return</span>&nbsp;<span class="ident" id="5892147">ch</span><br>
<span class="lineno"></span><span class="op" id="5892150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="5892153">func</span>&nbsp;<span class="op" id="5892158">(</span><span class="ident" id="5892159">s</span>&nbsp;<span class="op" id="5892161">*</span><span class="ident" id="5892162">Scanner</span><span class="op" id="5892169">)</span>&nbsp;<span class="ident" id="5892171">scanFraction</span><span class="op" id="5892183">(</span><span class="ident" id="5892184">ch</span>&nbsp;<span class="builtintype" id="5892187">rune</span><span class="op" id="5892191">)</span>&nbsp;<span class="builtintype" id="5892193">rune</span>&nbsp;<span class="op" id="5892198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5892201">if</span>&nbsp;<span class="ident" id="5892204">ch</span>&nbsp;<span class="op" id="5892207">==</span>&nbsp;<span class="string" id="5892210">&#39;.&#39;</span>&nbsp;<span class="op" id="5892214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892218">ch</span>&nbsp;<span class="op" id="5892221">=</span>&nbsp;<span class="ident" id="5892223">s</span><span class="op" id="5892224">.</span><span class="ident" id="5892225">scanMantissa</span><span class="op" id="5892237">(</span><span class="ident" id="5892238">s</span><span class="op" id="5892239">.</span><span class="ident" id="5892240">next</span><span class="op" id="5892244">(</span><span class="op" id="5892245">)</span><span class="op" id="5892246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5892249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5892252">return</span>&nbsp;<span class="ident" id="5892259">ch</span><br>
<span class="lineno">390</span><span class="op" id="5892262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5892265">func</span>&nbsp;<span class="op" id="5892270">(</span><span class="ident" id="5892271">s</span>&nbsp;<span class="op" id="5892273">*</span><span class="ident" id="5892274">Scanner</span><span class="op" id="5892281">)</span>&nbsp;<span class="ident" id="5892283">scanExponent</span><span class="op" id="5892295">(</span><span class="ident" id="5892296">ch</span>&nbsp;<span class="builtintype" id="5892299">rune</span><span class="op" id="5892303">)</span>&nbsp;<span class="builtintype" id="5892305">rune</span>&nbsp;<span class="op" id="5892310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5892313">if</span>&nbsp;<span class="ident" id="5892316">ch</span>&nbsp;<span class="op" id="5892319">==</span>&nbsp;<span class="string" id="5892322">&#39;e&#39;</span>&nbsp;<span class="op" id="5892326">||</span>&nbsp;<span class="ident" id="5892329">ch</span>&nbsp;<span class="op" id="5892332">==</span>&nbsp;<span class="string" id="5892335">&#39;E&#39;</span>&nbsp;<span class="op" id="5892339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892343">ch</span>&nbsp;<span class="op" id="5892346">=</span>&nbsp;<span class="ident" id="5892348">s</span><span class="op" id="5892349">.</span><span class="ident" id="5892350">next</span><span class="op" id="5892354">(</span><span class="op" id="5892355">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5892359">if</span>&nbsp;<span class="ident" id="5892362">ch</span>&nbsp;<span class="op" id="5892365">==</span>&nbsp;<span class="string" id="5892368">&#39;-&#39;</span>&nbsp;<span class="op" id="5892372">||</span>&nbsp;<span class="ident" id="5892375">ch</span>&nbsp;<span class="op" id="5892378">==</span>&nbsp;<span class="string" id="5892381">&#39;+&#39;</span>&nbsp;<span class="op" id="5892385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892390">ch</span>&nbsp;<span class="op" id="5892393">=</span>&nbsp;<span class="ident" id="5892395">s</span><span class="op" id="5892396">.</span><span class="ident" id="5892397">next</span><span class="op" id="5892401">(</span><span class="op" id="5892402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5892406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892410">ch</span>&nbsp;<span class="op" id="5892413">=</span>&nbsp;<span class="ident" id="5892415">s</span><span class="op" id="5892416">.</span><span class="ident" id="5892417">scanMantissa</span><span class="op" id="5892429">(</span><span class="ident" id="5892430">ch</span><span class="op" id="5892432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5892435">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5892438">return</span>&nbsp;<span class="ident" id="5892445">ch</span><br>
<span class="lineno"></span><span class="op" id="5892448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5892451">func</span>&nbsp;<span class="op" id="5892456">(</span><span class="ident" id="5892457">s</span>&nbsp;<span class="op" id="5892459">*</span><span class="ident" id="5892460">Scanner</span><span class="op" id="5892467">)</span>&nbsp;<span class="ident" id="5892469">scanNumber</span><span class="op" id="5892479">(</span><span class="ident" id="5892480">ch</span>&nbsp;<span class="builtintype" id="5892483">rune</span><span class="op" id="5892487">)</span>&nbsp;<span class="op" id="5892489">(</span><span class="builtintype" id="5892490">rune</span><span class="op" id="5892494">,</span>&nbsp;<span class="builtintype" id="5892496">rune</span><span class="op" id="5892500">)</span>&nbsp;<span class="op" id="5892502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5892505">//&nbsp;isDecimal(ch)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5892523">if</span>&nbsp;<span class="ident" id="5892526">ch</span>&nbsp;<span class="op" id="5892529">==</span>&nbsp;<span class="string" id="5892532">&#39;0&#39;</span>&nbsp;<span class="op" id="5892536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5892540">//&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892558">ch</span>&nbsp;<span class="op" id="5892561">=</span>&nbsp;<span class="ident" id="5892563">s</span><span class="op" id="5892564">.</span><span class="ident" id="5892565">next</span><span class="op" id="5892569">(</span><span class="op" id="5892570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5892574">if</span>&nbsp;<span class="ident" id="5892577">ch</span>&nbsp;<span class="op" id="5892580">==</span>&nbsp;<span class="string" id="5892583">&#39;x&#39;</span>&nbsp;<span class="op" id="5892587">||</span>&nbsp;<span class="ident" id="5892590">ch</span>&nbsp;<span class="op" id="5892593">==</span>&nbsp;<span class="string" id="5892596">&#39;X&#39;</span>&nbsp;<span class="op" id="5892600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5892605">//&nbsp;hexadecimal&nbsp;int</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892627">ch</span>&nbsp;<span class="op" id="5892630">=</span>&nbsp;<span class="ident" id="5892632">s</span><span class="op" id="5892633">.</span><span class="ident" id="5892634">next</span><span class="op" id="5892638">(</span><span class="op" id="5892639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892644">hasMantissa</span>&nbsp;<span class="op" id="5892656">:=</span>&nbsp;<span class="builtintype" id="5892659">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5892668">for</span>&nbsp;<span class="ident" id="5892672">digitVal</span><span class="op" id="5892680">(</span><span class="ident" id="5892681">ch</span><span class="op" id="5892683">)</span>&nbsp;<span class="op" id="5892685">&lt;</span>&nbsp;<span class="num" id="5892687">16</span>&nbsp;<span class="op" id="5892690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892696">ch</span>&nbsp;<span class="op" id="5892699">=</span>&nbsp;<span class="ident" id="5892701">s</span><span class="op" id="5892702">.</span><span class="ident" id="5892703">next</span><span class="op" id="5892707">(</span><span class="op" id="5892708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892714">hasMantissa</span>&nbsp;<span class="op" id="5892726">=</span>&nbsp;<span class="builtintype" id="5892728">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5892736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5892741">if</span>&nbsp;<span class="op" id="5892744">!</span><span class="ident" id="5892745">hasMantissa</span>&nbsp;<span class="op" id="5892757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892763">s</span><span class="op" id="5892764">.</span><span class="builtintype" id="5892765">error</span><span class="op" id="5892770">(</span><span class="string" id="5892771">&#34;illegal&nbsp;hexadecimal&nbsp;number&#34;</span><span class="op" id="5892799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5892804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5892808">}</span>&nbsp;<span class="keyword" id="5892810">else</span>&nbsp;<span class="op" id="5892815">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5892820">//&nbsp;octal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892845">has8or9</span>&nbsp;<span class="op" id="5892853">:=</span>&nbsp;<span class="builtintype" id="5892856">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5892865">for</span>&nbsp;<span class="ident" id="5892869">isDecimal</span><span class="op" id="5892878">(</span><span class="ident" id="5892879">ch</span><span class="op" id="5892881">)</span>&nbsp;<span class="op" id="5892883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5892889">if</span>&nbsp;<span class="ident" id="5892892">ch</span>&nbsp;<span class="op" id="5892895">&gt;</span>&nbsp;<span class="string" id="5892897">&#39;7&#39;</span>&nbsp;<span class="op" id="5892901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892908">has8or9</span>&nbsp;<span class="op" id="5892916">=</span>&nbsp;<span class="builtintype" id="5892918">true</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5892927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892933">ch</span>&nbsp;<span class="op" id="5892936">=</span>&nbsp;<span class="ident" id="5892938">s</span><span class="op" id="5892939">.</span><span class="ident" id="5892940">next</span><span class="op" id="5892944">(</span><span class="op" id="5892945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5892950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5892955">if</span>&nbsp;<span class="ident" id="5892958">s</span><span class="op" id="5892959">.</span><span class="ident" id="5892960">Mode</span><span class="op" id="5892964">&amp;</span><span class="ident" id="5892965">ScanFloats</span>&nbsp;<span class="op" id="5892976">!=</span>&nbsp;<span class="num" id="5892979">0</span>&nbsp;<span class="op" id="5892981">&amp;&amp;</span>&nbsp;<span class="op" id="5892984">(</span><span class="ident" id="5892985">ch</span>&nbsp;<span class="op" id="5892988">==</span>&nbsp;<span class="string" id="5892991">&#39;.&#39;</span>&nbsp;<span class="op" id="5892995">||</span>&nbsp;<span class="ident" id="5892998">ch</span>&nbsp;<span class="op" id="5893001">==</span>&nbsp;<span class="string" id="5893004">&#39;e&#39;</span>&nbsp;<span class="op" id="5893008">||</span>&nbsp;<span class="ident" id="5893011">ch</span>&nbsp;<span class="op" id="5893014">==</span>&nbsp;<span class="string" id="5893017">&#39;E&#39;</span><span class="op" id="5893020">)</span>&nbsp;<span class="op" id="5893022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5893028">//&nbsp;float</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893041">ch</span>&nbsp;<span class="op" id="5893044">=</span>&nbsp;<span class="ident" id="5893046">s</span><span class="op" id="5893047">.</span><span class="ident" id="5893048">scanFraction</span><span class="op" id="5893060">(</span><span class="ident" id="5893061">ch</span><span class="op" id="5893063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893069">ch</span>&nbsp;<span class="op" id="5893072">=</span>&nbsp;<span class="ident" id="5893074">s</span><span class="op" id="5893075">.</span><span class="ident" id="5893076">scanExponent</span><span class="op" id="5893088">(</span><span class="ident" id="5893089">ch</span><span class="op" id="5893091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5893097">return</span>&nbsp;<span class="ident" id="5893104">Float</span><span class="op" id="5893109">,</span>&nbsp;<span class="ident" id="5893111">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5893117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5893122">//&nbsp;octal&nbsp;int</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5893138">if</span>&nbsp;<span class="ident" id="5893141">has8or9</span>&nbsp;<span class="op" id="5893149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893155">s</span><span class="op" id="5893156">.</span><span class="builtintype" id="5893157">error</span><span class="op" id="5893162">(</span><span class="string" id="5893163">&#34;illegal&nbsp;octal&nbsp;number&#34;</span><span class="op" id="5893185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5893190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5893194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5893198">return</span>&nbsp;<span class="ident" id="5893205">Int</span><span class="op" id="5893208">,</span>&nbsp;<span class="ident" id="5893210">ch</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5893214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5893217">//&nbsp;decimal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893242">ch</span>&nbsp;<span class="op" id="5893245">=</span>&nbsp;<span class="ident" id="5893247">s</span><span class="op" id="5893248">.</span><span class="ident" id="5893249">scanMantissa</span><span class="op" id="5893261">(</span><span class="ident" id="5893262">ch</span><span class="op" id="5893264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5893267">if</span>&nbsp;<span class="ident" id="5893270">s</span><span class="op" id="5893271">.</span><span class="ident" id="5893272">Mode</span><span class="op" id="5893276">&amp;</span><span class="ident" id="5893277">ScanFloats</span>&nbsp;<span class="op" id="5893288">!=</span>&nbsp;<span class="num" id="5893291">0</span>&nbsp;<span class="op" id="5893293">&amp;&amp;</span>&nbsp;<span class="op" id="5893296">(</span><span class="ident" id="5893297">ch</span>&nbsp;<span class="op" id="5893300">==</span>&nbsp;<span class="string" id="5893303">&#39;.&#39;</span>&nbsp;<span class="op" id="5893307">||</span>&nbsp;<span class="ident" id="5893310">ch</span>&nbsp;<span class="op" id="5893313">==</span>&nbsp;<span class="string" id="5893316">&#39;e&#39;</span>&nbsp;<span class="op" id="5893320">||</span>&nbsp;<span class="ident" id="5893323">ch</span>&nbsp;<span class="op" id="5893326">==</span>&nbsp;<span class="string" id="5893329">&#39;E&#39;</span><span class="op" id="5893332">)</span>&nbsp;<span class="op" id="5893334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5893338">//&nbsp;float</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893349">ch</span>&nbsp;<span class="op" id="5893352">=</span>&nbsp;<span class="ident" id="5893354">s</span><span class="op" id="5893355">.</span><span class="ident" id="5893356">scanFraction</span><span class="op" id="5893368">(</span><span class="ident" id="5893369">ch</span><span class="op" id="5893371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893375">ch</span>&nbsp;<span class="op" id="5893378">=</span>&nbsp;<span class="ident" id="5893380">s</span><span class="op" id="5893381">.</span><span class="ident" id="5893382">scanExponent</span><span class="op" id="5893394">(</span><span class="ident" id="5893395">ch</span><span class="op" id="5893397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5893401">return</span>&nbsp;<span class="ident" id="5893408">Float</span><span class="op" id="5893413">,</span>&nbsp;<span class="ident" id="5893415">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5893419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5893422">return</span>&nbsp;<span class="ident" id="5893429">Int</span><span class="op" id="5893432">,</span>&nbsp;<span class="ident" id="5893434">ch</span><br>
<span class="lineno">450</span><span class="op" id="5893437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5893440">func</span>&nbsp;<span class="op" id="5893445">(</span><span class="ident" id="5893446">s</span>&nbsp;<span class="op" id="5893448">*</span><span class="ident" id="5893449">Scanner</span><span class="op" id="5893456">)</span>&nbsp;<span class="ident" id="5893458">scanDigits</span><span class="op" id="5893468">(</span><span class="ident" id="5893469">ch</span>&nbsp;<span class="builtintype" id="5893472">rune</span><span class="op" id="5893476">,</span>&nbsp;<span class="ident" id="5893478">base</span><span class="op" id="5893482">,</span>&nbsp;<span class="ident" id="5893484">n</span>&nbsp;<span class="builtintype" id="5893486">int</span><span class="op" id="5893489">)</span>&nbsp;<span class="builtintype" id="5893491">rune</span>&nbsp;<span class="op" id="5893496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5893499">for</span>&nbsp;<span class="ident" id="5893503">n</span>&nbsp;<span class="op" id="5893505">&gt;</span>&nbsp;<span class="num" id="5893507">0</span>&nbsp;<span class="op" id="5893509">&amp;&amp;</span>&nbsp;<span class="ident" id="5893512">digitVal</span><span class="op" id="5893520">(</span><span class="ident" id="5893521">ch</span><span class="op" id="5893523">)</span>&nbsp;<span class="op" id="5893525">&lt;</span>&nbsp;<span class="ident" id="5893527">base</span>&nbsp;<span class="op" id="5893532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893536">ch</span>&nbsp;<span class="op" id="5893539">=</span>&nbsp;<span class="ident" id="5893541">s</span><span class="op" id="5893542">.</span><span class="ident" id="5893543">next</span><span class="op" id="5893547">(</span><span class="op" id="5893548">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893552">n</span><span class="op" id="5893553">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5893557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5893560">if</span>&nbsp;<span class="ident" id="5893563">n</span>&nbsp;<span class="op" id="5893565">&gt;</span>&nbsp;<span class="num" id="5893567">0</span>&nbsp;<span class="op" id="5893569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893573">s</span><span class="op" id="5893574">.</span><span class="builtintype" id="5893575">error</span><span class="op" id="5893580">(</span><span class="string" id="5893581">&#34;illegal&nbsp;char&nbsp;escape&#34;</span><span class="op" id="5893602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5893605">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5893608">return</span>&nbsp;<span class="ident" id="5893615">ch</span><br>
<span class="lineno"></span><span class="op" id="5893618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5893621">func</span>&nbsp;<span class="op" id="5893626">(</span><span class="ident" id="5893627">s</span>&nbsp;<span class="op" id="5893629">*</span><span class="ident" id="5893630">Scanner</span><span class="op" id="5893637">)</span>&nbsp;<span class="ident" id="5893639">scanEscape</span><span class="op" id="5893649">(</span><span class="ident" id="5893650">quote</span>&nbsp;<span class="builtintype" id="5893656">rune</span><span class="op" id="5893660">)</span>&nbsp;<span class="builtintype" id="5893662">rune</span>&nbsp;<span class="op" id="5893667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893670">ch</span>&nbsp;<span class="op" id="5893673">:=</span>&nbsp;<span class="ident" id="5893676">s</span><span class="op" id="5893677">.</span><span class="ident" id="5893678">next</span><span class="op" id="5893682">(</span><span class="op" id="5893683">)</span>&nbsp;<span class="comment" id="5893685">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#39;/&#39;</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5893714">switch</span>&nbsp;<span class="ident" id="5893721">ch</span>&nbsp;<span class="op" id="5893724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5893727">case</span>&nbsp;<span class="string" id="5893732">&#39;a&#39;</span><span class="op" id="5893735">,</span>&nbsp;<span class="string" id="5893737">&#39;b&#39;</span><span class="op" id="5893740">,</span>&nbsp;<span class="string" id="5893742">&#39;f&#39;</span><span class="op" id="5893745">,</span>&nbsp;<span class="string" id="5893747">&#39;n&#39;</span><span class="op" id="5893750">,</span>&nbsp;<span class="string" id="5893752">&#39;r&#39;</span><span class="op" id="5893755">,</span>&nbsp;<span class="string" id="5893757">&#39;t&#39;</span><span class="op" id="5893760">,</span>&nbsp;<span class="string" id="5893762">&#39;v&#39;</span><span class="op" id="5893765">,</span>&nbsp;<span class="string" id="5893767">&#39;\\&#39;</span><span class="op" id="5893771">,</span>&nbsp;<span class="ident" id="5893773">quote</span><span class="op" id="5893778">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5893782">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893801">ch</span>&nbsp;<span class="op" id="5893804">=</span>&nbsp;<span class="ident" id="5893806">s</span><span class="op" id="5893807">.</span><span class="ident" id="5893808">next</span><span class="op" id="5893812">(</span><span class="op" id="5893813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5893816">case</span>&nbsp;<span class="string" id="5893821">&#39;0&#39;</span><span class="op" id="5893824">,</span>&nbsp;<span class="string" id="5893826">&#39;1&#39;</span><span class="op" id="5893829">,</span>&nbsp;<span class="string" id="5893831">&#39;2&#39;</span><span class="op" id="5893834">,</span>&nbsp;<span class="string" id="5893836">&#39;3&#39;</span><span class="op" id="5893839">,</span>&nbsp;<span class="string" id="5893841">&#39;4&#39;</span><span class="op" id="5893844">,</span>&nbsp;<span class="string" id="5893846">&#39;5&#39;</span><span class="op" id="5893849">,</span>&nbsp;<span class="string" id="5893851">&#39;6&#39;</span><span class="op" id="5893854">,</span>&nbsp;<span class="string" id="5893856">&#39;7&#39;</span><span class="op" id="5893859">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893863">ch</span>&nbsp;<span class="op" id="5893866">=</span>&nbsp;<span class="ident" id="5893868">s</span><span class="op" id="5893869">.</span><span class="ident" id="5893870">scanDigits</span><span class="op" id="5893880">(</span><span class="ident" id="5893881">ch</span><span class="op" id="5893883">,</span>&nbsp;<span class="num" id="5893885">8</span><span class="op" id="5893886">,</span>&nbsp;<span class="num" id="5893888">3</span><span class="op" id="5893889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5893892">case</span>&nbsp;<span class="string" id="5893897">&#39;x&#39;</span><span class="op" id="5893900">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893904">ch</span>&nbsp;<span class="op" id="5893907">=</span>&nbsp;<span class="ident" id="5893909">s</span><span class="op" id="5893910">.</span><span class="ident" id="5893911">scanDigits</span><span class="op" id="5893921">(</span><span class="ident" id="5893922">s</span><span class="op" id="5893923">.</span><span class="ident" id="5893924">next</span><span class="op" id="5893928">(</span><span class="op" id="5893929">)</span><span class="op" id="5893930">,</span>&nbsp;<span class="num" id="5893932">16</span><span class="op" id="5893934">,</span>&nbsp;<span class="num" id="5893936">2</span><span class="op" id="5893937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5893940">case</span>&nbsp;<span class="string" id="5893945">&#39;u&#39;</span><span class="op" id="5893948">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893952">ch</span>&nbsp;<span class="op" id="5893955">=</span>&nbsp;<span class="ident" id="5893957">s</span><span class="op" id="5893958">.</span><span class="ident" id="5893959">scanDigits</span><span class="op" id="5893969">(</span><span class="ident" id="5893970">s</span><span class="op" id="5893971">.</span><span class="ident" id="5893972">next</span><span class="op" id="5893976">(</span><span class="op" id="5893977">)</span><span class="op" id="5893978">,</span>&nbsp;<span class="num" id="5893980">16</span><span class="op" id="5893982">,</span>&nbsp;<span class="num" id="5893984">4</span><span class="op" id="5893985">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5893988">case</span>&nbsp;<span class="string" id="5893993">&#39;U&#39;</span><span class="op" id="5893996">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5894000">ch</span>&nbsp;<span class="op" id="5894003">=</span>&nbsp;<span class="ident" id="5894005">s</span><span class="op" id="5894006">.</span><span class="ident" id="5894007">scanDigits</span><span class="op" id="5894017">(</span><span class="ident" id="5894018">s</span><span class="op" id="5894019">.</span><span class="ident" id="5894020">next</span><span class="op" id="5894024">(</span><span class="op" id="5894025">)</span><span class="op" id="5894026">,</span>&nbsp;<span class="num" id="5894028">16</span><span class="op" id="5894030">,</span>&nbsp;<span class="num" id="5894032">8</span><span class="op" id="5894033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5894036">default</span><span class="op" id="5894043">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5894047">s</span><span class="op" id="5894048">.</span><span class="builtintype" id="5894049">error</span><span class="op" id="5894054">(</span><span class="string" id="5894055">&#34;illegal&nbsp;char&nbsp;escape&#34;</span><span class="op" id="5894076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5894079">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5894082">return</span>&nbsp;<span class="ident" id="5894089">ch</span><br>
<span class="lineno"></span><span class="op" id="5894092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5894095">func</span>&nbsp;<span class="op" id="5894100">(</span><span class="ident" id="5894101">s</span>&nbsp;<span class="op" id="5894103">*</span><span class="ident" id="5894104">Scanner</span><span class="op" id="5894111">)</span>&nbsp;<span class="ident" id="5894113">scanString</span><span class="op" id="5894123">(</span><span class="ident" id="5894124">quote</span>&nbsp;<span class="builtintype" id="5894130">rune</span><span class="op" id="5894134">)</span>&nbsp;<span class="op" id="5894136">(</span><span class="ident" id="5894137">n</span>&nbsp;<span class="builtintype" id="5894139">int</span><span class="op" id="5894142">)</span>&nbsp;<span class="op" id="5894144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5894147">ch</span>&nbsp;<span class="op" id="5894150">:=</span>&nbsp;<span class="ident" id="5894153">s</span><span class="op" id="5894154">.</span><span class="ident" id="5894155">next</span><span class="op" id="5894159">(</span><span class="op" id="5894160">)</span>&nbsp;<span class="comment" id="5894162">//&nbsp;read&nbsp;character&nbsp;after&nbsp;quote</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5894193">for</span>&nbsp;<span class="ident" id="5894197">ch</span>&nbsp;<span class="op" id="5894200">!=</span>&nbsp;<span class="ident" id="5894203">quote</span>&nbsp;<span class="op" id="5894209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5894213">if</span>&nbsp;<span class="ident" id="5894216">ch</span>&nbsp;<span class="op" id="5894219">==</span>&nbsp;<span class="string" id="5894222">&#39;\n&#39;</span>&nbsp;<span class="op" id="5894227">||</span>&nbsp;<span class="ident" id="5894230">ch</span>&nbsp;<span class="op" id="5894233">&lt;</span>&nbsp;<span class="num" id="5894235">0</span>&nbsp;<span class="op" id="5894237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5894242">s</span><span class="op" id="5894243">.</span><span class="builtintype" id="5894244">error</span><span class="op" id="5894249">(</span><span class="string" id="5894250">&#34;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="5894274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5894279">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5894288">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5894292">if</span>&nbsp;<span class="ident" id="5894295">ch</span>&nbsp;<span class="op" id="5894298">==</span>&nbsp;<span class="string" id="5894301">&#39;\\&#39;</span>&nbsp;<span class="op" id="5894306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5894311">ch</span>&nbsp;<span class="op" id="5894314">=</span>&nbsp;<span class="ident" id="5894316">s</span><span class="op" id="5894317">.</span><span class="ident" id="5894318">scanEscape</span><span class="op" id="5894328">(</span><span class="ident" id="5894329">quote</span><span class="op" id="5894334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5894338">}</span>&nbsp;<span class="keyword" id="5894340">else</span>&nbsp;<span class="op" id="5894345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5894350">ch</span>&nbsp;<span class="op" id="5894353">=</span>&nbsp;<span class="ident" id="5894355">s</span><span class="op" id="5894356">.</span><span class="ident" id="5894357">next</span><span class="op" id="5894361">(</span><span class="op" id="5894362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5894366">}</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5894370">n</span><span class="op" id="5894371">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5894375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5894378">return</span><br>
<span class="lineno"></span><span class="op" id="5894385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="5894388">func</span>&nbsp;<span class="op" id="5894393">(</span><span class="ident" id="5894394">s</span>&nbsp;<span class="op" id="5894396">*</span><span class="ident" id="5894397">Scanner</span><span class="op" id="5894404">)</span>&nbsp;<span class="ident" id="5894406">scanRawString</span><span class="op" id="5894419">(</span><span class="op" id="5894420">)</span>&nbsp;<span class="op" id="5894422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5894425">ch</span>&nbsp;<span class="op" id="5894428">:=</span>&nbsp;<span class="ident" id="5894431">s</span><span class="op" id="5894432">.</span><span class="ident" id="5894433">next</span><span class="op" id="5894437">(</span><span class="op" id="5894438">)</span>&nbsp;<span class="comment" id="5894440">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#39;`&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5894469">for</span>&nbsp;<span class="ident" id="5894473">ch</span>&nbsp;<span class="op" id="5894476">!=</span>&nbsp;<span class="string" id="5894479">&#39;`&#39;</span>&nbsp;<span class="op" id="5894483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5894487">if</span>&nbsp;<span class="ident" id="5894490">ch</span>&nbsp;<span class="op" id="5894493">&lt;</span>&nbsp;<span class="num" id="5894495">0</span>&nbsp;<span class="op" id="5894497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5894502">s</span><span class="op" id="5894503">.</span><span class="builtintype" id="5894504">error</span><span class="op" id="5894509">(</span><span class="string" id="5894510">&#34;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="5894534">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5894539">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5894548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5894552">ch</span>&nbsp;<span class="op" id="5894555">=</span>&nbsp;<span class="ident" id="5894557">s</span><span class="op" id="5894558">.</span><span class="ident" id="5894559">next</span><span class="op" id="5894563">(</span><span class="op" id="5894564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5894567">}</span><br>
<span class="lineno"></span><span class="op" id="5894569">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span><span class="keyword" id="5894572">func</span>&nbsp;<span class="op" id="5894577">(</span><span class="ident" id="5894578">s</span>&nbsp;<span class="op" id="5894580">*</span><span class="ident" id="5894581">Scanner</span><span class="op" id="5894588">)</span>&nbsp;<span class="ident" id="5894590">scanChar</span><span class="op" id="5894598">(</span><span class="op" id="5894599">)</span>&nbsp;<span class="op" id="5894601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5894604">if</span>&nbsp;<span class="ident" id="5894607">s</span><span class="op" id="5894608">.</span><span class="ident" id="5894609">scanString</span><span class="op" id="5894619">(</span><span class="string" id="5894620">&#39;\&#39;&#39;</span><span class="op" id="5894624">)</span>&nbsp;<span class="op" id="5894626">!=</span>&nbsp;<span class="num" id="5894629">1</span>&nbsp;<span class="op" id="5894631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5894635">s</span><span class="op" id="5894636">.</span><span class="builtintype" id="5894637">error</span><span class="op" id="5894642">(</span><span class="string" id="5894643">&#34;illegal&nbsp;char&nbsp;literal&#34;</span><span class="op" id="5894665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5894668">}</span><br>
<span class="lineno">515</span><span class="op" id="5894670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5894673">func</span>&nbsp;<span class="op" id="5894678">(</span><span class="ident" id="5894679">s</span>&nbsp;<span class="op" id="5894681">*</span><span class="ident" id="5894682">Scanner</span><span class="op" id="5894689">)</span>&nbsp;<span class="ident" id="5894691">scanComment</span><span class="op" id="5894702">(</span><span class="ident" id="5894703">ch</span>&nbsp;<span class="builtintype" id="5894706">rune</span><span class="op" id="5894710">)</span>&nbsp;<span class="builtintype" id="5894712">rune</span>&nbsp;<span class="op" id="5894717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5894720">//&nbsp;ch&nbsp;==&nbsp;&#39;/&#39;&nbsp;||&nbsp;ch&nbsp;==&nbsp;&#39;*&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5894747">if</span>&nbsp;<span class="ident" id="5894750">ch</span>&nbsp;<span class="op" id="5894753">==</span>&nbsp;<span class="string" id="5894756">&#39;/&#39;</span>&nbsp;<span class="op" id="5894760">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5894764">//&nbsp;line&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5894782">ch</span>&nbsp;<span class="op" id="5894785">=</span>&nbsp;<span class="ident" id="5894787">s</span><span class="op" id="5894788">.</span><span class="ident" id="5894789">next</span><span class="op" id="5894793">(</span><span class="op" id="5894794">)</span>&nbsp;<span class="comment" id="5894796">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#34;//&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5894827">for</span>&nbsp;<span class="ident" id="5894831">ch</span>&nbsp;<span class="op" id="5894834">!=</span>&nbsp;<span class="string" id="5894837">&#39;\n&#39;</span>&nbsp;<span class="op" id="5894842">&amp;&amp;</span>&nbsp;<span class="ident" id="5894845">ch</span>&nbsp;<span class="op" id="5894848">&gt;=</span>&nbsp;<span class="num" id="5894851">0</span>&nbsp;<span class="op" id="5894853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5894858">ch</span>&nbsp;<span class="op" id="5894861">=</span>&nbsp;<span class="ident" id="5894863">s</span><span class="op" id="5894864">.</span><span class="ident" id="5894865">next</span><span class="op" id="5894869">(</span><span class="op" id="5894870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5894874">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5894878">return</span>&nbsp;<span class="ident" id="5894885">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5894889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5894893">//&nbsp;general&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5894913">ch</span>&nbsp;<span class="op" id="5894916">=</span>&nbsp;<span class="ident" id="5894918">s</span><span class="op" id="5894919">.</span><span class="ident" id="5894920">next</span><span class="op" id="5894924">(</span><span class="op" id="5894925">)</span>&nbsp;<span class="comment" id="5894927">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#34;/*&#34;</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5894957">for</span>&nbsp;<span class="op" id="5894961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5894965">if</span>&nbsp;<span class="ident" id="5894968">ch</span>&nbsp;<span class="op" id="5894971">&lt;</span>&nbsp;<span class="num" id="5894973">0</span>&nbsp;<span class="op" id="5894975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5894980">s</span><span class="op" id="5894981">.</span><span class="builtintype" id="5894982">error</span><span class="op" id="5894987">(</span><span class="string" id="5894988">&#34;comment&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="5895012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5895017">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5895025">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895029">ch0</span>&nbsp;<span class="op" id="5895033">:=</span>&nbsp;<span class="ident" id="5895036">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895041">ch</span>&nbsp;<span class="op" id="5895044">=</span>&nbsp;<span class="ident" id="5895046">s</span><span class="op" id="5895047">.</span><span class="ident" id="5895048">next</span><span class="op" id="5895052">(</span><span class="op" id="5895053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5895057">if</span>&nbsp;<span class="ident" id="5895060">ch0</span>&nbsp;<span class="op" id="5895064">==</span>&nbsp;<span class="string" id="5895067">&#39;*&#39;</span>&nbsp;<span class="op" id="5895071">&amp;&amp;</span>&nbsp;<span class="ident" id="5895074">ch</span>&nbsp;<span class="op" id="5895077">==</span>&nbsp;<span class="string" id="5895080">&#39;/&#39;</span>&nbsp;<span class="op" id="5895084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895089">ch</span>&nbsp;<span class="op" id="5895092">=</span>&nbsp;<span class="ident" id="5895094">s</span><span class="op" id="5895095">.</span><span class="ident" id="5895096">next</span><span class="op" id="5895100">(</span><span class="op" id="5895101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5895106">break</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5895114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5895117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5895120">return</span>&nbsp;<span class="ident" id="5895127">ch</span><br>
<span class="lineno"></span><span class="op" id="5895130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span><span class="comment" id="5895133">//&nbsp;Scan&nbsp;reads&nbsp;the&nbsp;next&nbsp;token&nbsp;or&nbsp;Unicode&nbsp;character&nbsp;from&nbsp;source&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="5895211">//&nbsp;It&nbsp;only&nbsp;recognizes&nbsp;tokens&nbsp;t&nbsp;for&nbsp;which&nbsp;the&nbsp;respective&nbsp;Mode&nbsp;bit&nbsp;(1&lt;&lt;-t)&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="5895292">//&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source.&nbsp;It&nbsp;reports&nbsp;scanner&nbsp;errors&nbsp;(read&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5895372">//&nbsp;token&nbsp;errors)&nbsp;by&nbsp;calling&nbsp;s.Error,&nbsp;if&nbsp;not&nbsp;nil;&nbsp;otherwise&nbsp;it&nbsp;prints&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="5895450">//&nbsp;message&nbsp;to&nbsp;os.Stderr.</span><br>
<span class="lineno">550</span><span class="keyword" id="5895475">func</span>&nbsp;<span class="op" id="5895480">(</span><span class="ident" id="5895481">s</span>&nbsp;<span class="op" id="5895483">*</span><span class="ident" id="5895484">Scanner</span><span class="op" id="5895491">)</span>&nbsp;<span class="ident" id="5895493">Scan</span><span class="op" id="5895497">(</span><span class="op" id="5895498">)</span>&nbsp;<span class="builtintype" id="5895500">rune</span>&nbsp;<span class="op" id="5895505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895508">ch</span>&nbsp;<span class="op" id="5895511">:=</span>&nbsp;<span class="ident" id="5895514">s</span><span class="op" id="5895515">.</span><span class="ident" id="5895516">Peek</span><span class="op" id="5895520">(</span><span class="op" id="5895521">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5895525">//&nbsp;reset&nbsp;token&nbsp;text&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895555">s</span><span class="op" id="5895556">.</span><span class="ident" id="5895557">tokPos</span>&nbsp;<span class="op" id="5895564">=</span>&nbsp;<span class="op" id="5895566">-</span><span class="num" id="5895567">1</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895570">s</span><span class="op" id="5895571">.</span><span class="ident" id="5895572">Line</span>&nbsp;<span class="op" id="5895577">=</span>&nbsp;<span class="num" id="5895579">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="5895582">redo</span><span class="op" id="5895586">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5895589">//&nbsp;skip&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5895610">for</span>&nbsp;<span class="ident" id="5895614">s</span><span class="op" id="5895615">.</span><span class="ident" id="5895616">Whitespace</span><span class="op" id="5895626">&amp;</span><span class="op" id="5895627">(</span><span class="num" id="5895628">1</span><span class="op" id="5895629">&lt;&lt;</span><span class="builtintype" id="5895631">uint</span><span class="op" id="5895635">(</span><span class="ident" id="5895636">ch</span><span class="op" id="5895638">)</span><span class="op" id="5895639">)</span>&nbsp;<span class="op" id="5895641">!=</span>&nbsp;<span class="num" id="5895644">0</span>&nbsp;<span class="op" id="5895646">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895650">ch</span>&nbsp;<span class="op" id="5895653">=</span>&nbsp;<span class="ident" id="5895655">s</span><span class="op" id="5895656">.</span><span class="ident" id="5895657">next</span><span class="op" id="5895661">(</span><span class="op" id="5895662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5895665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5895669">//&nbsp;start&nbsp;collecting&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895701">s</span><span class="op" id="5895702">.</span><span class="ident" id="5895703">tokBuf</span><span class="op" id="5895709">.</span><span class="ident" id="5895710">Reset</span><span class="op" id="5895715">(</span><span class="op" id="5895716">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895719">s</span><span class="op" id="5895720">.</span><span class="ident" id="5895721">tokPos</span>&nbsp;<span class="op" id="5895728">=</span>&nbsp;<span class="ident" id="5895730">s</span><span class="op" id="5895731">.</span><span class="ident" id="5895732">srcPos</span>&nbsp;<span class="op" id="5895739">-</span>&nbsp;<span class="ident" id="5895741">s</span><span class="op" id="5895742">.</span><span class="ident" id="5895743">lastCharLen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5895757">//&nbsp;set&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5895780">//&nbsp;(this&nbsp;is&nbsp;a&nbsp;slightly&nbsp;optimized&nbsp;version&nbsp;of&nbsp;the&nbsp;code&nbsp;in&nbsp;Pos())</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895844">s</span><span class="op" id="5895845">.</span><span class="ident" id="5895846">Offset</span>&nbsp;<span class="op" id="5895853">=</span>&nbsp;<span class="ident" id="5895855">s</span><span class="op" id="5895856">.</span><span class="ident" id="5895857">srcBufOffset</span>&nbsp;<span class="op" id="5895870">+</span>&nbsp;<span class="ident" id="5895872">s</span><span class="op" id="5895873">.</span><span class="ident" id="5895874">tokPos</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5895882">if</span>&nbsp;<span class="ident" id="5895885">s</span><span class="op" id="5895886">.</span><span class="ident" id="5895887">column</span>&nbsp;<span class="op" id="5895894">&gt;</span>&nbsp;<span class="num" id="5895896">0</span>&nbsp;<span class="op" id="5895898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5895902">//&nbsp;common&nbsp;case:&nbsp;last&nbsp;character&nbsp;was&nbsp;not&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895950">s</span><span class="op" id="5895951">.</span><span class="ident" id="5895952">Line</span>&nbsp;<span class="op" id="5895957">=</span>&nbsp;<span class="ident" id="5895959">s</span><span class="op" id="5895960">.</span><span class="ident" id="5895961">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895968">s</span><span class="op" id="5895969">.</span><span class="ident" id="5895970">Column</span>&nbsp;<span class="op" id="5895977">=</span>&nbsp;<span class="ident" id="5895979">s</span><span class="op" id="5895980">.</span><span class="ident" id="5895981">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5895989">}</span>&nbsp;<span class="keyword" id="5895991">else</span>&nbsp;<span class="op" id="5895996">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5896000">//&nbsp;last&nbsp;character&nbsp;was&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5896031">//&nbsp;(we&nbsp;cannot&nbsp;be&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5896081">//&nbsp;since&nbsp;we&nbsp;have&nbsp;called&nbsp;next()&nbsp;at&nbsp;least&nbsp;once)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896129">s</span><span class="op" id="5896130">.</span><span class="ident" id="5896131">Line</span>&nbsp;<span class="op" id="5896136">=</span>&nbsp;<span class="ident" id="5896138">s</span><span class="op" id="5896139">.</span><span class="ident" id="5896140">line</span>&nbsp;<span class="op" id="5896145">-</span>&nbsp;<span class="num" id="5896147">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896151">s</span><span class="op" id="5896152">.</span><span class="ident" id="5896153">Column</span>&nbsp;<span class="op" id="5896160">=</span>&nbsp;<span class="ident" id="5896162">s</span><span class="op" id="5896163">.</span><span class="ident" id="5896164">lastLineLen</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5896177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5896181">//&nbsp;determine&nbsp;token&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896207">tok</span>&nbsp;<span class="op" id="5896211">:=</span>&nbsp;<span class="ident" id="5896214">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896218">switch</span>&nbsp;<span class="op" id="5896225">{</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896228">case</span>&nbsp;<span class="ident" id="5896233">s</span><span class="op" id="5896234">.</span><span class="ident" id="5896235">isIdentRune</span><span class="op" id="5896246">(</span><span class="ident" id="5896247">ch</span><span class="op" id="5896249">,</span>&nbsp;<span class="num" id="5896251">0</span><span class="op" id="5896252">)</span><span class="op" id="5896253">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896257">if</span>&nbsp;<span class="ident" id="5896260">s</span><span class="op" id="5896261">.</span><span class="ident" id="5896262">Mode</span><span class="op" id="5896266">&amp;</span><span class="ident" id="5896267">ScanIdents</span>&nbsp;<span class="op" id="5896278">!=</span>&nbsp;<span class="num" id="5896281">0</span>&nbsp;<span class="op" id="5896283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896288">tok</span>&nbsp;<span class="op" id="5896292">=</span>&nbsp;<span class="ident" id="5896294">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896303">ch</span>&nbsp;<span class="op" id="5896306">=</span>&nbsp;<span class="ident" id="5896308">s</span><span class="op" id="5896309">.</span><span class="ident" id="5896310">scanIdentifier</span><span class="op" id="5896324">(</span><span class="op" id="5896325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5896329">}</span>&nbsp;<span class="keyword" id="5896331">else</span>&nbsp;<span class="op" id="5896336">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896341">ch</span>&nbsp;<span class="op" id="5896344">=</span>&nbsp;<span class="ident" id="5896346">s</span><span class="op" id="5896347">.</span><span class="ident" id="5896348">next</span><span class="op" id="5896352">(</span><span class="op" id="5896353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5896357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896360">case</span>&nbsp;<span class="ident" id="5896365">isDecimal</span><span class="op" id="5896374">(</span><span class="ident" id="5896375">ch</span><span class="op" id="5896377">)</span><span class="op" id="5896378">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896382">if</span>&nbsp;<span class="ident" id="5896385">s</span><span class="op" id="5896386">.</span><span class="ident" id="5896387">Mode</span><span class="op" id="5896391">&amp;</span><span class="op" id="5896392">(</span><span class="ident" id="5896393">ScanInts</span><span class="op" id="5896401">|</span><span class="ident" id="5896402">ScanFloats</span><span class="op" id="5896412">)</span>&nbsp;<span class="op" id="5896414">!=</span>&nbsp;<span class="num" id="5896417">0</span>&nbsp;<span class="op" id="5896419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896424">tok</span><span class="op" id="5896427">,</span>&nbsp;<span class="ident" id="5896429">ch</span>&nbsp;<span class="op" id="5896432">=</span>&nbsp;<span class="ident" id="5896434">s</span><span class="op" id="5896435">.</span><span class="ident" id="5896436">scanNumber</span><span class="op" id="5896446">(</span><span class="ident" id="5896447">ch</span><span class="op" id="5896449">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5896453">}</span>&nbsp;<span class="keyword" id="5896455">else</span>&nbsp;<span class="op" id="5896460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896465">ch</span>&nbsp;<span class="op" id="5896468">=</span>&nbsp;<span class="ident" id="5896470">s</span><span class="op" id="5896471">.</span><span class="ident" id="5896472">next</span><span class="op" id="5896476">(</span><span class="op" id="5896477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5896481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896484">default</span><span class="op" id="5896491">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896495">switch</span>&nbsp;<span class="ident" id="5896502">ch</span>&nbsp;<span class="op" id="5896505">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896509">case</span>&nbsp;<span class="string" id="5896514">&#39;&#34;&#39;</span><span class="op" id="5896517">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896522">if</span>&nbsp;<span class="ident" id="5896525">s</span><span class="op" id="5896526">.</span><span class="ident" id="5896527">Mode</span><span class="op" id="5896531">&amp;</span><span class="ident" id="5896532">ScanStrings</span>&nbsp;<span class="op" id="5896544">!=</span>&nbsp;<span class="num" id="5896547">0</span>&nbsp;<span class="op" id="5896549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896555">s</span><span class="op" id="5896556">.</span><span class="ident" id="5896557">scanString</span><span class="op" id="5896567">(</span><span class="string" id="5896568">&#39;&#34;&#39;</span><span class="op" id="5896571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896577">tok</span>&nbsp;<span class="op" id="5896581">=</span>&nbsp;<span class="ident" id="5896583">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5896593">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896598">ch</span>&nbsp;<span class="op" id="5896601">=</span>&nbsp;<span class="ident" id="5896603">s</span><span class="op" id="5896604">.</span><span class="ident" id="5896605">next</span><span class="op" id="5896609">(</span><span class="op" id="5896610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896614">case</span>&nbsp;<span class="string" id="5896619">&#39;\&#39;&#39;</span><span class="op" id="5896623">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896628">if</span>&nbsp;<span class="ident" id="5896631">s</span><span class="op" id="5896632">.</span><span class="ident" id="5896633">Mode</span><span class="op" id="5896637">&amp;</span><span class="ident" id="5896638">ScanChars</span>&nbsp;<span class="op" id="5896648">!=</span>&nbsp;<span class="num" id="5896651">0</span>&nbsp;<span class="op" id="5896653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896659">s</span><span class="op" id="5896660">.</span><span class="ident" id="5896661">scanChar</span><span class="op" id="5896669">(</span><span class="op" id="5896670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896676">tok</span>&nbsp;<span class="op" id="5896680">=</span>&nbsp;<span class="ident" id="5896682">Char</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5896690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896695">ch</span>&nbsp;<span class="op" id="5896698">=</span>&nbsp;<span class="ident" id="5896700">s</span><span class="op" id="5896701">.</span><span class="ident" id="5896702">next</span><span class="op" id="5896706">(</span><span class="op" id="5896707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896711">case</span>&nbsp;<span class="string" id="5896716">&#39;.&#39;</span><span class="op" id="5896719">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896724">ch</span>&nbsp;<span class="op" id="5896727">=</span>&nbsp;<span class="ident" id="5896729">s</span><span class="op" id="5896730">.</span><span class="ident" id="5896731">next</span><span class="op" id="5896735">(</span><span class="op" id="5896736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896741">if</span>&nbsp;<span class="ident" id="5896744">isDecimal</span><span class="op" id="5896753">(</span><span class="ident" id="5896754">ch</span><span class="op" id="5896756">)</span>&nbsp;<span class="op" id="5896758">&amp;&amp;</span>&nbsp;<span class="ident" id="5896761">s</span><span class="op" id="5896762">.</span><span class="ident" id="5896763">Mode</span><span class="op" id="5896767">&amp;</span><span class="ident" id="5896768">ScanFloats</span>&nbsp;<span class="op" id="5896779">!=</span>&nbsp;<span class="num" id="5896782">0</span>&nbsp;<span class="op" id="5896784">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896790">tok</span>&nbsp;<span class="op" id="5896794">=</span>&nbsp;<span class="ident" id="5896796">Float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896806">ch</span>&nbsp;<span class="op" id="5896809">=</span>&nbsp;<span class="ident" id="5896811">s</span><span class="op" id="5896812">.</span><span class="ident" id="5896813">scanMantissa</span><span class="op" id="5896825">(</span><span class="ident" id="5896826">ch</span><span class="op" id="5896828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896834">ch</span>&nbsp;<span class="op" id="5896837">=</span>&nbsp;<span class="ident" id="5896839">s</span><span class="op" id="5896840">.</span><span class="ident" id="5896841">scanExponent</span><span class="op" id="5896853">(</span><span class="ident" id="5896854">ch</span><span class="op" id="5896856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5896861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896865">case</span>&nbsp;<span class="string" id="5896870">&#39;/&#39;</span><span class="op" id="5896873">:</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896878">ch</span>&nbsp;<span class="op" id="5896881">=</span>&nbsp;<span class="ident" id="5896883">s</span><span class="op" id="5896884">.</span><span class="ident" id="5896885">next</span><span class="op" id="5896889">(</span><span class="op" id="5896890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896895">if</span>&nbsp;<span class="op" id="5896898">(</span><span class="ident" id="5896899">ch</span>&nbsp;<span class="op" id="5896902">==</span>&nbsp;<span class="string" id="5896905">&#39;/&#39;</span>&nbsp;<span class="op" id="5896909">||</span>&nbsp;<span class="ident" id="5896912">ch</span>&nbsp;<span class="op" id="5896915">==</span>&nbsp;<span class="string" id="5896918">&#39;*&#39;</span><span class="op" id="5896921">)</span>&nbsp;<span class="op" id="5896923">&amp;&amp;</span>&nbsp;<span class="ident" id="5896926">s</span><span class="op" id="5896927">.</span><span class="ident" id="5896928">Mode</span><span class="op" id="5896932">&amp;</span><span class="ident" id="5896933">ScanComments</span>&nbsp;<span class="op" id="5896946">!=</span>&nbsp;<span class="num" id="5896949">0</span>&nbsp;<span class="op" id="5896951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896957">if</span>&nbsp;<span class="ident" id="5896960">s</span><span class="op" id="5896961">.</span><span class="ident" id="5896962">Mode</span><span class="op" id="5896966">&amp;</span><span class="ident" id="5896967">SkipComments</span>&nbsp;<span class="op" id="5896980">!=</span>&nbsp;<span class="num" id="5896983">0</span>&nbsp;<span class="op" id="5896985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896992">s</span><span class="op" id="5896993">.</span><span class="ident" id="5896994">tokPos</span>&nbsp;<span class="op" id="5897001">=</span>&nbsp;<span class="op" id="5897003">-</span><span class="num" id="5897004">1</span>&nbsp;<span class="comment" id="5897006">//&nbsp;don&#39;t&nbsp;collect&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897039">ch</span>&nbsp;<span class="op" id="5897042">=</span>&nbsp;<span class="ident" id="5897044">s</span><span class="op" id="5897045">.</span><span class="ident" id="5897046">scanComment</span><span class="op" id="5897057">(</span><span class="ident" id="5897058">ch</span><span class="op" id="5897060">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5897067">goto</span>&nbsp;<span class="ident" id="5897072">redo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5897081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897087">ch</span>&nbsp;<span class="op" id="5897090">=</span>&nbsp;<span class="ident" id="5897092">s</span><span class="op" id="5897093">.</span><span class="ident" id="5897094">scanComment</span><span class="op" id="5897105">(</span><span class="ident" id="5897106">ch</span><span class="op" id="5897108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897114">tok</span>&nbsp;<span class="op" id="5897118">=</span>&nbsp;<span class="ident" id="5897120">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5897131">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5897135">case</span>&nbsp;<span class="string" id="5897140">&#39;`&#39;</span><span class="op" id="5897143">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5897148">if</span>&nbsp;<span class="ident" id="5897151">s</span><span class="op" id="5897152">.</span><span class="ident" id="5897153">Mode</span><span class="op" id="5897157">&amp;</span><span class="ident" id="5897158">ScanRawStrings</span>&nbsp;<span class="op" id="5897173">!=</span>&nbsp;<span class="num" id="5897176">0</span>&nbsp;<span class="op" id="5897178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897184">s</span><span class="op" id="5897185">.</span><span class="ident" id="5897186">scanRawString</span><span class="op" id="5897199">(</span><span class="op" id="5897200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897206">tok</span>&nbsp;<span class="op" id="5897210">=</span>&nbsp;<span class="ident" id="5897212">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5897222">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897227">ch</span>&nbsp;<span class="op" id="5897230">=</span>&nbsp;<span class="ident" id="5897232">s</span><span class="op" id="5897233">.</span><span class="ident" id="5897234">next</span><span class="op" id="5897238">(</span><span class="op" id="5897239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5897243">default</span><span class="op" id="5897250">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897255">ch</span>&nbsp;<span class="op" id="5897258">=</span>&nbsp;<span class="ident" id="5897260">s</span><span class="op" id="5897261">.</span><span class="ident" id="5897262">next</span><span class="op" id="5897266">(</span><span class="op" id="5897267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5897271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5897274">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5897278">//&nbsp;end&nbsp;of&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897300">s</span><span class="op" id="5897301">.</span><span class="ident" id="5897302">tokEnd</span>&nbsp;<span class="op" id="5897309">=</span>&nbsp;<span class="ident" id="5897311">s</span><span class="op" id="5897312">.</span><span class="ident" id="5897313">srcPos</span>&nbsp;<span class="op" id="5897320">-</span>&nbsp;<span class="ident" id="5897322">s</span><span class="op" id="5897323">.</span><span class="ident" id="5897324">lastCharLen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897338">s</span><span class="op" id="5897339">.</span><span class="ident" id="5897340">ch</span>&nbsp;<span class="op" id="5897343">=</span>&nbsp;<span class="ident" id="5897345">ch</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5897349">return</span>&nbsp;<span class="ident" id="5897356">tok</span><br>
<span class="lineno"></span><span class="op" id="5897360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5897363">//&nbsp;Pos&nbsp;returns&nbsp;the&nbsp;position&nbsp;of&nbsp;the&nbsp;character&nbsp;immediately&nbsp;after</span><br>
<span class="lineno"></span><span class="comment" id="5897426">//&nbsp;the&nbsp;character&nbsp;or&nbsp;token&nbsp;returned&nbsp;by&nbsp;the&nbsp;last&nbsp;call&nbsp;to&nbsp;Next&nbsp;or&nbsp;Scan.</span><br>
<span class="lineno">650</span><span class="keyword" id="5897495">func</span>&nbsp;<span class="op" id="5897500">(</span><span class="ident" id="5897501">s</span>&nbsp;<span class="op" id="5897503">*</span><span class="ident" id="5897504">Scanner</span><span class="op" id="5897511">)</span>&nbsp;<span class="ident" id="5897513">Pos</span><span class="op" id="5897516">(</span><span class="op" id="5897517">)</span>&nbsp;<span class="op" id="5897519">(</span><span class="ident" id="5897520">pos</span>&nbsp;<span class="ident" id="5897524">Position</span><span class="op" id="5897532">)</span>&nbsp;<span class="op" id="5897534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897537">pos</span><span class="op" id="5897540">.</span><span class="ident" id="5897541">Filename</span>&nbsp;<span class="op" id="5897550">=</span>&nbsp;<span class="ident" id="5897552">s</span><span class="op" id="5897553">.</span><span class="ident" id="5897554">Filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897564">pos</span><span class="op" id="5897567">.</span><span class="ident" id="5897568">Offset</span>&nbsp;<span class="op" id="5897575">=</span>&nbsp;<span class="ident" id="5897577">s</span><span class="op" id="5897578">.</span><span class="ident" id="5897579">srcBufOffset</span>&nbsp;<span class="op" id="5897592">+</span>&nbsp;<span class="ident" id="5897594">s</span><span class="op" id="5897595">.</span><span class="ident" id="5897596">srcPos</span>&nbsp;<span class="op" id="5897603">-</span>&nbsp;<span class="ident" id="5897605">s</span><span class="op" id="5897606">.</span><span class="ident" id="5897607">lastCharLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5897620">switch</span>&nbsp;<span class="op" id="5897627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5897630">case</span>&nbsp;<span class="ident" id="5897635">s</span><span class="op" id="5897636">.</span><span class="ident" id="5897637">column</span>&nbsp;<span class="op" id="5897644">&gt;</span>&nbsp;<span class="num" id="5897646">0</span><span class="op" id="5897647">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5897651">//&nbsp;common&nbsp;case:&nbsp;last&nbsp;character&nbsp;was&nbsp;not&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897699">pos</span><span class="op" id="5897702">.</span><span class="ident" id="5897703">Line</span>&nbsp;<span class="op" id="5897708">=</span>&nbsp;<span class="ident" id="5897710">s</span><span class="op" id="5897711">.</span><span class="ident" id="5897712">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897719">pos</span><span class="op" id="5897722">.</span><span class="ident" id="5897723">Column</span>&nbsp;<span class="op" id="5897730">=</span>&nbsp;<span class="ident" id="5897732">s</span><span class="op" id="5897733">.</span><span class="ident" id="5897734">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5897742">case</span>&nbsp;<span class="ident" id="5897747">s</span><span class="op" id="5897748">.</span><span class="ident" id="5897749">lastLineLen</span>&nbsp;<span class="op" id="5897761">&gt;</span>&nbsp;<span class="num" id="5897763">0</span><span class="op" id="5897764">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5897768">//&nbsp;last&nbsp;character&nbsp;was&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897799">pos</span><span class="op" id="5897802">.</span><span class="ident" id="5897803">Line</span>&nbsp;<span class="op" id="5897808">=</span>&nbsp;<span class="ident" id="5897810">s</span><span class="op" id="5897811">.</span><span class="ident" id="5897812">line</span>&nbsp;<span class="op" id="5897817">-</span>&nbsp;<span class="num" id="5897819">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897823">pos</span><span class="op" id="5897826">.</span><span class="ident" id="5897827">Column</span>&nbsp;<span class="op" id="5897834">=</span>&nbsp;<span class="ident" id="5897836">s</span><span class="op" id="5897837">.</span><span class="ident" id="5897838">lastLineLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5897851">default</span><span class="op" id="5897858">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5897862">//&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897898">pos</span><span class="op" id="5897901">.</span><span class="ident" id="5897902">Line</span>&nbsp;<span class="op" id="5897907">=</span>&nbsp;<span class="num" id="5897909">1</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897913">pos</span><span class="op" id="5897916">.</span><span class="ident" id="5897917">Column</span>&nbsp;<span class="op" id="5897924">=</span>&nbsp;<span class="num" id="5897926">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5897929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5897932">return</span><br>
<span class="lineno"></span><span class="op" id="5897939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="comment" id="5897942">//&nbsp;TokenText&nbsp;returns&nbsp;the&nbsp;string&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;most&nbsp;recently&nbsp;scanned&nbsp;token.</span><br>
<span class="lineno"></span><span class="comment" id="5898024">//&nbsp;Valid&nbsp;after&nbsp;calling&nbsp;Scan().</span><br>
<span class="lineno"></span><span class="keyword" id="5898055">func</span>&nbsp;<span class="op" id="5898060">(</span><span class="ident" id="5898061">s</span>&nbsp;<span class="op" id="5898063">*</span><span class="ident" id="5898064">Scanner</span><span class="op" id="5898071">)</span>&nbsp;<span class="ident" id="5898073">TokenText</span><span class="op" id="5898082">(</span><span class="op" id="5898083">)</span>&nbsp;<span class="builtintype" id="5898085">string</span>&nbsp;<span class="op" id="5898092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5898095">if</span>&nbsp;<span class="ident" id="5898098">s</span><span class="op" id="5898099">.</span><span class="ident" id="5898100">tokPos</span>&nbsp;<span class="op" id="5898107">&lt;</span>&nbsp;<span class="num" id="5898109">0</span>&nbsp;<span class="op" id="5898111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5898115">//&nbsp;no&nbsp;token&nbsp;text</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5898134">return</span>&nbsp;<span class="string" id="5898141">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5898145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5898149">if</span>&nbsp;<span class="ident" id="5898152">s</span><span class="op" id="5898153">.</span><span class="ident" id="5898154">tokEnd</span>&nbsp;<span class="op" id="5898161">&lt;</span>&nbsp;<span class="num" id="5898163">0</span>&nbsp;<span class="op" id="5898165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5898169">//&nbsp;if&nbsp;EOF&nbsp;was&nbsp;reached,&nbsp;s.tokEnd&nbsp;is&nbsp;set&nbsp;to&nbsp;-1&nbsp;(s.srcPos&nbsp;==&nbsp;0)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5898232">s</span><span class="op" id="5898233">.</span><span class="ident" id="5898234">tokEnd</span>&nbsp;<span class="op" id="5898241">=</span>&nbsp;<span class="ident" id="5898243">s</span><span class="op" id="5898244">.</span><span class="ident" id="5898245">tokPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5898253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5898257">if</span>&nbsp;<span class="ident" id="5898260">s</span><span class="op" id="5898261">.</span><span class="ident" id="5898262">tokBuf</span><span class="op" id="5898268">.</span><span class="ident" id="5898269">Len</span><span class="op" id="5898272">(</span><span class="op" id="5898273">)</span>&nbsp;<span class="op" id="5898275">==</span>&nbsp;<span class="num" id="5898278">0</span>&nbsp;<span class="op" id="5898280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5898284">//&nbsp;common&nbsp;case:&nbsp;the&nbsp;entire&nbsp;token&nbsp;text&nbsp;is&nbsp;still&nbsp;in&nbsp;srcBuf</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5898343">return</span>&nbsp;<span class="builtintype" id="5898350">string</span><span class="op" id="5898356">(</span><span class="ident" id="5898357">s</span><span class="op" id="5898358">.</span><span class="ident" id="5898359">srcBuf</span><span class="op" id="5898365">[</span><span class="ident" id="5898366">s</span><span class="op" id="5898367">.</span><span class="ident" id="5898368">tokPos</span><span class="op" id="5898374">:</span><span class="ident" id="5898375">s</span><span class="op" id="5898376">.</span><span class="ident" id="5898377">tokEnd</span><span class="op" id="5898383">]</span><span class="op" id="5898384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5898387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5898391">//&nbsp;part&nbsp;of&nbsp;the&nbsp;token&nbsp;text&nbsp;was&nbsp;saved&nbsp;in&nbsp;tokBuf:&nbsp;save&nbsp;the&nbsp;rest&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5898456">//&nbsp;tokBuf&nbsp;as&nbsp;well&nbsp;and&nbsp;return&nbsp;its&nbsp;content</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5898498">s</span><span class="op" id="5898499">.</span><span class="ident" id="5898500">tokBuf</span><span class="op" id="5898506">.</span><span class="ident" id="5898507">Write</span><span class="op" id="5898512">(</span><span class="ident" id="5898513">s</span><span class="op" id="5898514">.</span><span class="ident" id="5898515">srcBuf</span><span class="op" id="5898521">[</span><span class="ident" id="5898522">s</span><span class="op" id="5898523">.</span><span class="ident" id="5898524">tokPos</span><span class="op" id="5898530">:</span><span class="ident" id="5898531">s</span><span class="op" id="5898532">.</span><span class="ident" id="5898533">tokEnd</span><span class="op" id="5898539">]</span><span class="op" id="5898540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5898543">s</span><span class="op" id="5898544">.</span><span class="ident" id="5898545">tokPos</span>&nbsp;<span class="op" id="5898552">=</span>&nbsp;<span class="ident" id="5898554">s</span><span class="op" id="5898555">.</span><span class="ident" id="5898556">tokEnd</span>&nbsp;<span class="comment" id="5898563">//&nbsp;ensure&nbsp;idempotency&nbsp;of&nbsp;TokenText()&nbsp;call</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5898606">return</span>&nbsp;<span class="ident" id="5898613">s</span><span class="op" id="5898614">.</span><span class="ident" id="5898615">tokBuf</span><span class="op" id="5898621">.</span><span class="ident" id="5898622">String</span><span class="op" id="5898628">(</span><span class="op" id="5898629">)</span><br>
<span class="lineno"></span><span class="op" id="5898631">}</span>
</div>
</body>
</html>
