<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html" class="current">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7930032">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7930087">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7930141">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7930192">package</span>&nbsp;<span class="ident" id="7930200">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7930206">import</span>&nbsp;<span class="op" id="7930213">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7930216">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7930226">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="7930229">var</span>&nbsp;<span class="ident" id="7930233">typeTests</span>&nbsp;<span class="op" id="7930243">=</span>&nbsp;<span class="ident" id="7930245">initMimeForTests</span><span class="op" id="7930261">(</span><span class="op" id="7930262">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7930265">func</span>&nbsp;<span class="ident" id="7930270">TestTypeByExtension</span><span class="op" id="7930289">(</span><span class="ident" id="7930290">t</span>&nbsp;<span class="op" id="7930292">*</span><span class="ident" id="7930293">testing</span><span class="op" id="7930300">.</span><span class="ident" id="7930301">T</span><span class="op" id="7930302">)</span>&nbsp;<span class="op" id="7930304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930307">for</span>&nbsp;<span class="ident" id="7930311">ext</span><span class="op" id="7930314">,</span>&nbsp;<span class="ident" id="7930316">want</span>&nbsp;<span class="op" id="7930321">:=</span>&nbsp;<span class="keyword" id="7930324">range</span>&nbsp;<span class="ident" id="7930330">typeTests</span>&nbsp;<span class="op" id="7930340">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930344">val</span>&nbsp;<span class="op" id="7930348">:=</span>&nbsp;<span class="ident" id="7930351">TypeByExtension</span><span class="op" id="7930366">(</span><span class="ident" id="7930367">ext</span><span class="op" id="7930370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930374">if</span>&nbsp;<span class="ident" id="7930377">val</span>&nbsp;<span class="op" id="7930381">!=</span>&nbsp;<span class="ident" id="7930384">want</span>&nbsp;<span class="op" id="7930389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930394">t</span><span class="op" id="7930395">.</span><span class="ident" id="7930396">Errorf</span><span class="op" id="7930402">(</span><span class="string" id="7930403">&#34;TypeByExtension(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7930438">,</span>&nbsp;<span class="ident" id="7930440">ext</span><span class="op" id="7930443">,</span>&nbsp;<span class="ident" id="7930445">val</span><span class="op" id="7930448">,</span>&nbsp;<span class="ident" id="7930450">want</span><span class="op" id="7930454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930461">}</span><br>
<span class="lineno">20</span><span class="op" id="7930463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7930466">func</span>&nbsp;<span class="ident" id="7930471">TestTypeByExtensionCase</span><span class="op" id="7930494">(</span><span class="ident" id="7930495">t</span>&nbsp;<span class="op" id="7930497">*</span><span class="ident" id="7930498">testing</span><span class="op" id="7930505">.</span><span class="ident" id="7930506">T</span><span class="op" id="7930507">)</span>&nbsp;<span class="op" id="7930509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930512">const</span>&nbsp;<span class="ident" id="7930518">custom</span>&nbsp;<span class="op" id="7930525">=</span>&nbsp;<span class="string" id="7930527">&#34;test/test;&nbsp;charset=iso-8859-1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930560">const</span>&nbsp;<span class="ident" id="7930566">caps</span>&nbsp;<span class="op" id="7930571">=</span>&nbsp;<span class="string" id="7930573">&#34;test/test;&nbsp;WAS=ALLCAPS&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930599">if</span>&nbsp;<span class="ident" id="7930602">err</span>&nbsp;<span class="op" id="7930606">:=</span>&nbsp;<span class="ident" id="7930609">AddExtensionType</span><span class="op" id="7930625">(</span><span class="string" id="7930626">&#34;.TEST&#34;</span><span class="op" id="7930633">,</span>&nbsp;<span class="ident" id="7930635">caps</span><span class="op" id="7930639">)</span><span class="op" id="7930640">;</span>&nbsp;<span class="ident" id="7930642">err</span>&nbsp;<span class="op" id="7930646">!=</span>&nbsp;<span class="ident" id="7930649">nil</span>&nbsp;<span class="op" id="7930653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930657">t</span><span class="op" id="7930658">.</span><span class="ident" id="7930659">Fatalf</span><span class="op" id="7930665">(</span><span class="string" id="7930666">&#34;error&nbsp;%s&nbsp;for&nbsp;AddExtension(%s)&#34;</span><span class="op" id="7930697">,</span>&nbsp;<span class="ident" id="7930699">err</span><span class="op" id="7930702">,</span>&nbsp;<span class="ident" id="7930704">custom</span><span class="op" id="7930710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930716">if</span>&nbsp;<span class="ident" id="7930719">err</span>&nbsp;<span class="op" id="7930723">:=</span>&nbsp;<span class="ident" id="7930726">AddExtensionType</span><span class="op" id="7930742">(</span><span class="string" id="7930743">&#34;.tesT&#34;</span><span class="op" id="7930750">,</span>&nbsp;<span class="ident" id="7930752">custom</span><span class="op" id="7930758">)</span><span class="op" id="7930759">;</span>&nbsp;<span class="ident" id="7930761">err</span>&nbsp;<span class="op" id="7930765">!=</span>&nbsp;<span class="ident" id="7930768">nil</span>&nbsp;<span class="op" id="7930772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930776">t</span><span class="op" id="7930777">.</span><span class="ident" id="7930778">Fatalf</span><span class="op" id="7930784">(</span><span class="string" id="7930785">&#34;error&nbsp;%s&nbsp;for&nbsp;AddExtension(%s)&#34;</span><span class="op" id="7930816">,</span>&nbsp;<span class="ident" id="7930818">err</span><span class="op" id="7930821">,</span>&nbsp;<span class="ident" id="7930823">custom</span><span class="op" id="7930829">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7930836">//&nbsp;case-sensitive&nbsp;lookup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930862">if</span>&nbsp;<span class="ident" id="7930865">got</span>&nbsp;<span class="op" id="7930869">:=</span>&nbsp;<span class="ident" id="7930872">TypeByExtension</span><span class="op" id="7930887">(</span><span class="string" id="7930888">&#34;.tesT&#34;</span><span class="op" id="7930895">)</span><span class="op" id="7930896">;</span>&nbsp;<span class="ident" id="7930898">got</span>&nbsp;<span class="op" id="7930902">!=</span>&nbsp;<span class="ident" id="7930905">custom</span>&nbsp;<span class="op" id="7930912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930916">t</span><span class="op" id="7930917">.</span><span class="ident" id="7930918">Fatalf</span><span class="op" id="7930924">(</span><span class="string" id="7930925">&#34;for&nbsp;.tesT,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7930953">,</span>&nbsp;<span class="ident" id="7930955">got</span><span class="op" id="7930958">,</span>&nbsp;<span class="ident" id="7930960">custom</span><span class="op" id="7930966">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930972">if</span>&nbsp;<span class="ident" id="7930975">got</span>&nbsp;<span class="op" id="7930979">:=</span>&nbsp;<span class="ident" id="7930982">TypeByExtension</span><span class="op" id="7930997">(</span><span class="string" id="7930998">&#34;.TEST&#34;</span><span class="op" id="7931005">)</span><span class="op" id="7931006">;</span>&nbsp;<span class="ident" id="7931008">got</span>&nbsp;<span class="op" id="7931012">!=</span>&nbsp;<span class="ident" id="7931015">caps</span>&nbsp;<span class="op" id="7931020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931024">t</span><span class="op" id="7931025">.</span><span class="ident" id="7931026">Fatalf</span><span class="op" id="7931032">(</span><span class="string" id="7931033">&#34;for&nbsp;.TEST,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7931061">,</span>&nbsp;<span class="ident" id="7931063">got</span><span class="op" id="7931066">,</span>&nbsp;<span class="ident" id="7931068">caps</span><span class="op" id="7931072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7931079">//&nbsp;case-insensitive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931100">if</span>&nbsp;<span class="ident" id="7931103">got</span>&nbsp;<span class="op" id="7931107">:=</span>&nbsp;<span class="ident" id="7931110">TypeByExtension</span><span class="op" id="7931125">(</span><span class="string" id="7931126">&#34;.TesT&#34;</span><span class="op" id="7931133">)</span><span class="op" id="7931134">;</span>&nbsp;<span class="ident" id="7931136">got</span>&nbsp;<span class="op" id="7931140">!=</span>&nbsp;<span class="ident" id="7931143">custom</span>&nbsp;<span class="op" id="7931150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931154">t</span><span class="op" id="7931155">.</span><span class="ident" id="7931156">Fatalf</span><span class="op" id="7931162">(</span><span class="string" id="7931163">&#34;for&nbsp;.TesT,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7931191">,</span>&nbsp;<span class="ident" id="7931193">got</span><span class="op" id="7931196">,</span>&nbsp;<span class="ident" id="7931198">custom</span><span class="op" id="7931204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931207">}</span><br>
<span class="lineno"></span><span class="op" id="7931209">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7931212">func</span>&nbsp;<span class="ident" id="7931217">TestLookupMallocs</span><span class="op" id="7931234">(</span><span class="ident" id="7931235">t</span>&nbsp;<span class="op" id="7931237">*</span><span class="ident" id="7931238">testing</span><span class="op" id="7931245">.</span><span class="ident" id="7931246">T</span><span class="op" id="7931247">)</span>&nbsp;<span class="op" id="7931249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931252">n</span>&nbsp;<span class="op" id="7931254">:=</span>&nbsp;<span class="ident" id="7931257">testing</span><span class="op" id="7931264">.</span><span class="ident" id="7931265">AllocsPerRun</span><span class="op" id="7931277">(</span><span class="num" id="7931278">10000</span><span class="op" id="7931283">,</span>&nbsp;<span class="keyword" id="7931285">func</span><span class="op" id="7931289">(</span><span class="op" id="7931290">)</span>&nbsp;<span class="op" id="7931292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931296">TypeByExtension</span><span class="op" id="7931311">(</span><span class="string" id="7931312">&#34;.html&#34;</span><span class="op" id="7931319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931323">TypeByExtension</span><span class="op" id="7931338">(</span><span class="string" id="7931339">&#34;.HtML&#34;</span><span class="op" id="7931346">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931349">}</span><span class="op" id="7931350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931353">if</span>&nbsp;<span class="ident" id="7931356">n</span>&nbsp;<span class="op" id="7931358">&gt;</span>&nbsp;<span class="num" id="7931360">0</span>&nbsp;<span class="op" id="7931362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931366">t</span><span class="op" id="7931367">.</span><span class="ident" id="7931368">Errorf</span><span class="op" id="7931374">(</span><span class="string" id="7931375">&#34;allocs&nbsp;=&nbsp;%v;&nbsp;want&nbsp;0&#34;</span><span class="op" id="7931396">,</span>&nbsp;<span class="ident" id="7931398">n</span><span class="op" id="7931399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931402">}</span><br>
<span class="lineno"></span><span class="op" id="7931404">}</span>
</div>
</body>
</html>
