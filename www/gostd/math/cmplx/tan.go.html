<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/cmplx</h2>
<ul>
<li><a href="/gostd/math/cmplx/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/cmplx/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/cmplx/cmath_test.go.html">cmath_test.go</a></li>
<li><a href="/gostd/math/cmplx/conj.go.html">conj.go</a></li>
<li><a href="/gostd/math/cmplx/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/cmplx/isinf.go.html">isinf.go</a></li>
<li><a href="/gostd/math/cmplx/isnan.go.html">isnan.go</a></li>
<li><a href="/gostd/math/cmplx/log.go.html">log.go</a></li>
<li><a href="/gostd/math/cmplx/phase.go.html">phase.go</a></li>
<li><a href="/gostd/math/cmplx/polar.go.html">polar.go</a></li>
<li><a href="/gostd/math/cmplx/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/cmplx/rect.go.html">rect.go</a></li>
<li><a href="/gostd/math/cmplx/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/cmplx/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/cmplx/tan.go.html">tan.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5861529">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5861584">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5861638">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5861689">package</span>&nbsp;<span class="ident" id="5861697">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5861704">import</span>&nbsp;<span class="string" id="5861711">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5861719">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="5861779">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="5861849">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="5861907">//</span><br>
<span class="lineno"></span><span class="comment" id="5861910">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="5861958">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="5862022">//</span><br>
<span class="lineno"></span><span class="comment" id="5862025">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="5862086">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5862156">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="5862231">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="5862298">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="5862371">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5862443">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="5862457">//</span><br>
<span class="lineno"></span><span class="comment" id="5862460">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="5862526">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="5862592">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="5862605">//</span><br>
<span class="lineno"></span><span class="comment" id="5862608">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="5862632">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5862662">//&nbsp;Complex&nbsp;circular&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="5862690">//</span><br>
<span class="lineno"></span><span class="comment" id="5862693">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5862709">//</span><br>
<span class="lineno">35</span><span class="comment" id="5862712">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="5862718">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno"></span><span class="comment" id="5862737">//</span><br>
<span class="lineno"></span><span class="comment" id="5862740">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="5862748">//</span><br>
<span class="lineno">40</span><span class="comment" id="5862751">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;i&nbsp;sinh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="5862785">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;--------------------.</span><br>
<span class="lineno"></span><span class="comment" id="5862820">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;cosh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="5862853">//</span><br>
<span class="lineno"></span><span class="comment" id="5862856">//&nbsp;On&nbsp;the&nbsp;real&nbsp;axis&nbsp;the&nbsp;denominator&nbsp;is&nbsp;zero&nbsp;at&nbsp;odd&nbsp;multiples</span><br>
<span class="lineno">45</span><span class="comment" id="5862917">//&nbsp;of&nbsp;PI/2.&nbsp;&nbsp;The&nbsp;denominator&nbsp;is&nbsp;evaluated&nbsp;by&nbsp;its&nbsp;Taylor</span><br>
<span class="lineno"></span><span class="comment" id="5862973">//&nbsp;series&nbsp;near&nbsp;these&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="5863002">//</span><br>
<span class="lineno"></span><span class="comment" id="5863005">//&nbsp;ctan(z)&nbsp;=&nbsp;-i&nbsp;ctanh(iz).</span><br>
<span class="lineno"></span><span class="comment" id="5863032">//</span><br>
<span class="lineno">50</span><span class="comment" id="5863035">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="5863048">//</span><br>
<span class="lineno"></span><span class="comment" id="5863051">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5863091">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="5863149">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.1e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-17</span><br>
<span class="lineno">55</span><span class="comment" id="5863209">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="5863269">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;ctan&nbsp;*&nbsp;ccot&nbsp;=&nbsp;1&nbsp;and&nbsp;catan(ctan(z))&nbsp;&nbsp;=&nbsp;&nbsp;z.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5863330">//&nbsp;Tan&nbsp;returns&nbsp;the&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="5863363">func</span>&nbsp;<span class="ident" id="5863368">Tan</span><span class="op" id="5863371">(</span><span class="ident" id="5863372">x</span>&nbsp;<span class="builtintype" id="5863374">complex128</span><span class="op" id="5863384">)</span>&nbsp;<span class="builtintype" id="5863386">complex128</span>&nbsp;<span class="op" id="5863397">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5863400">d</span>&nbsp;<span class="op" id="5863402">:=</span>&nbsp;<span class="ident" id="5863405">math</span><span class="op" id="5863409">.</span><span class="ident" id="5863410">Cos</span><span class="op" id="5863413">(</span><span class="num" id="5863414">2</span><span class="op" id="5863415">*</span><span class="builtinfunc" id="5863416">real</span><span class="op" id="5863420">(</span><span class="ident" id="5863421">x</span><span class="op" id="5863422">)</span><span class="op" id="5863423">)</span>&nbsp;<span class="op" id="5863425">+</span>&nbsp;<span class="ident" id="5863427">math</span><span class="op" id="5863431">.</span><span class="ident" id="5863432">Cosh</span><span class="op" id="5863436">(</span><span class="num" id="5863437">2</span><span class="op" id="5863438">*</span><span class="builtinfunc" id="5863439">imag</span><span class="op" id="5863443">(</span><span class="ident" id="5863444">x</span><span class="op" id="5863445">)</span><span class="op" id="5863446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5863449">if</span>&nbsp;<span class="ident" id="5863452">math</span><span class="op" id="5863456">.</span><span class="ident" id="5863457">Abs</span><span class="op" id="5863460">(</span><span class="ident" id="5863461">d</span><span class="op" id="5863462">)</span>&nbsp;<span class="op" id="5863464">&lt;</span>&nbsp;<span class="num" id="5863466">0.25</span>&nbsp;<span class="op" id="5863471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5863475">d</span>&nbsp;<span class="op" id="5863477">=</span>&nbsp;<span class="ident" id="5863479">tanSeries</span><span class="op" id="5863488">(</span><span class="ident" id="5863489">x</span><span class="op" id="5863490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5863493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5863496">if</span>&nbsp;<span class="ident" id="5863499">d</span>&nbsp;<span class="op" id="5863501">==</span>&nbsp;<span class="num" id="5863504">0</span>&nbsp;<span class="op" id="5863506">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5863510">return</span>&nbsp;<span class="ident" id="5863517">Inf</span><span class="op" id="5863520">(</span><span class="op" id="5863521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5863524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5863527">return</span>&nbsp;<span class="builtinfunc" id="5863534">complex</span><span class="op" id="5863541">(</span><span class="ident" id="5863542">math</span><span class="op" id="5863546">.</span><span class="ident" id="5863547">Sin</span><span class="op" id="5863550">(</span><span class="num" id="5863551">2</span><span class="op" id="5863552">*</span><span class="builtinfunc" id="5863553">real</span><span class="op" id="5863557">(</span><span class="ident" id="5863558">x</span><span class="op" id="5863559">)</span><span class="op" id="5863560">)</span><span class="op" id="5863561">/</span><span class="ident" id="5863562">d</span><span class="op" id="5863563">,</span>&nbsp;<span class="ident" id="5863565">math</span><span class="op" id="5863569">.</span><span class="ident" id="5863570">Sinh</span><span class="op" id="5863574">(</span><span class="num" id="5863575">2</span><span class="op" id="5863576">*</span><span class="builtinfunc" id="5863577">imag</span><span class="op" id="5863581">(</span><span class="ident" id="5863582">x</span><span class="op" id="5863583">)</span><span class="op" id="5863584">)</span><span class="op" id="5863585">/</span><span class="ident" id="5863586">d</span><span class="op" id="5863587">)</span><br>
<span class="lineno"></span><span class="op" id="5863589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="5863592">//&nbsp;Complex&nbsp;hyperbolic&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="5863622">//</span><br>
<span class="lineno"></span><span class="comment" id="5863625">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5863641">//</span><br>
<span class="lineno"></span><span class="comment" id="5863644">//&nbsp;tanh&nbsp;z&nbsp;=&nbsp;(sinh&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;i&nbsp;sin&nbsp;2y)&nbsp;/&nbsp;(cosh&nbsp;2x&nbsp;+&nbsp;cos&nbsp;2y)&nbsp;.</span><br>
<span class="lineno">75</span><span class="comment" id="5863702">//</span><br>
<span class="lineno"></span><span class="comment" id="5863705">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="5863718">//</span><br>
<span class="lineno"></span><span class="comment" id="5863721">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5863761">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">80</span><span class="comment" id="5863819">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.7e-14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.4e-16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5863880">//&nbsp;Tanh&nbsp;returns&nbsp;the&nbsp;hyperbolic&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="5863925">func</span>&nbsp;<span class="ident" id="5863930">Tanh</span><span class="op" id="5863934">(</span><span class="ident" id="5863935">x</span>&nbsp;<span class="builtintype" id="5863937">complex128</span><span class="op" id="5863947">)</span>&nbsp;<span class="builtintype" id="5863949">complex128</span>&nbsp;<span class="op" id="5863960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5863963">d</span>&nbsp;<span class="op" id="5863965">:=</span>&nbsp;<span class="ident" id="5863968">math</span><span class="op" id="5863972">.</span><span class="ident" id="5863973">Cosh</span><span class="op" id="5863977">(</span><span class="num" id="5863978">2</span><span class="op" id="5863979">*</span><span class="builtinfunc" id="5863980">real</span><span class="op" id="5863984">(</span><span class="ident" id="5863985">x</span><span class="op" id="5863986">)</span><span class="op" id="5863987">)</span>&nbsp;<span class="op" id="5863989">+</span>&nbsp;<span class="ident" id="5863991">math</span><span class="op" id="5863995">.</span><span class="ident" id="5863996">Cos</span><span class="op" id="5863999">(</span><span class="num" id="5864000">2</span><span class="op" id="5864001">*</span><span class="builtinfunc" id="5864002">imag</span><span class="op" id="5864006">(</span><span class="ident" id="5864007">x</span><span class="op" id="5864008">)</span><span class="op" id="5864009">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5864012">if</span>&nbsp;<span class="ident" id="5864015">d</span>&nbsp;<span class="op" id="5864017">==</span>&nbsp;<span class="num" id="5864020">0</span>&nbsp;<span class="op" id="5864022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5864026">return</span>&nbsp;<span class="ident" id="5864033">Inf</span><span class="op" id="5864036">(</span><span class="op" id="5864037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5864040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5864043">return</span>&nbsp;<span class="builtinfunc" id="5864050">complex</span><span class="op" id="5864057">(</span><span class="ident" id="5864058">math</span><span class="op" id="5864062">.</span><span class="ident" id="5864063">Sinh</span><span class="op" id="5864067">(</span><span class="num" id="5864068">2</span><span class="op" id="5864069">*</span><span class="builtinfunc" id="5864070">real</span><span class="op" id="5864074">(</span><span class="ident" id="5864075">x</span><span class="op" id="5864076">)</span><span class="op" id="5864077">)</span><span class="op" id="5864078">/</span><span class="ident" id="5864079">d</span><span class="op" id="5864080">,</span>&nbsp;<span class="ident" id="5864082">math</span><span class="op" id="5864086">.</span><span class="ident" id="5864087">Sin</span><span class="op" id="5864090">(</span><span class="num" id="5864091">2</span><span class="op" id="5864092">*</span><span class="builtinfunc" id="5864093">imag</span><span class="op" id="5864097">(</span><span class="ident" id="5864098">x</span><span class="op" id="5864099">)</span><span class="op" id="5864100">)</span><span class="op" id="5864101">/</span><span class="ident" id="5864102">d</span><span class="op" id="5864103">)</span><br>
<span class="lineno"></span><span class="op" id="5864105">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="5864108">//&nbsp;Program&nbsp;to&nbsp;subtract&nbsp;nearest&nbsp;integer&nbsp;multiple&nbsp;of&nbsp;PI</span><br>
<span class="lineno"></span><span class="keyword" id="5864162">func</span>&nbsp;<span class="ident" id="5864167">reducePi</span><span class="op" id="5864175">(</span><span class="ident" id="5864176">x</span>&nbsp;<span class="builtintype" id="5864178">float64</span><span class="op" id="5864185">)</span>&nbsp;<span class="builtintype" id="5864187">float64</span>&nbsp;<span class="op" id="5864195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5864198">const</span>&nbsp;<span class="op" id="5864204">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5864208">//&nbsp;extended&nbsp;precision&nbsp;value&nbsp;of&nbsp;PI:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864245">DP1</span>&nbsp;<span class="op" id="5864249">=</span>&nbsp;<span class="num" id="5864251">3.14159265160560607910E0</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5864278">//&nbsp;??&nbsp;0x400921fb54000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864305">DP2</span>&nbsp;<span class="op" id="5864309">=</span>&nbsp;<span class="num" id="5864311">1.98418714791870343106E-9</span>&nbsp;&nbsp;<span class="comment" id="5864338">//&nbsp;??&nbsp;0x3e210b4610000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864365">DP3</span>&nbsp;<span class="op" id="5864369">=</span>&nbsp;<span class="num" id="5864371">1.14423774522196636802E-17</span>&nbsp;<span class="comment" id="5864398">//&nbsp;??&nbsp;0x3c6a62633145c06e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5864424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864427">t</span>&nbsp;<span class="op" id="5864429">:=</span>&nbsp;<span class="ident" id="5864432">x</span>&nbsp;<span class="op" id="5864434">/</span>&nbsp;<span class="ident" id="5864436">math</span><span class="op" id="5864440">.</span><span class="ident" id="5864441">Pi</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5864445">if</span>&nbsp;<span class="ident" id="5864448">t</span>&nbsp;<span class="op" id="5864450">&gt;=</span>&nbsp;<span class="num" id="5864453">0</span>&nbsp;<span class="op" id="5864455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864459">t</span>&nbsp;<span class="op" id="5864461">+=</span>&nbsp;<span class="num" id="5864464">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5864469">}</span>&nbsp;<span class="keyword" id="5864471">else</span>&nbsp;<span class="op" id="5864476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864480">t</span>&nbsp;<span class="op" id="5864482">-=</span>&nbsp;<span class="num" id="5864485">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5864490">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864493">t</span>&nbsp;<span class="op" id="5864495">=</span>&nbsp;<span class="builtintype" id="5864497">float64</span><span class="op" id="5864504">(</span><span class="ident" id="5864505">int64</span><span class="op" id="5864510">(</span><span class="ident" id="5864511">t</span><span class="op" id="5864512">)</span><span class="op" id="5864513">)</span>&nbsp;<span class="comment" id="5864515">//&nbsp;int64(t)&nbsp;=&nbsp;the&nbsp;multiple</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5864543">return</span>&nbsp;<span class="op" id="5864550">(</span><span class="op" id="5864551">(</span><span class="ident" id="5864552">x</span>&nbsp;<span class="op" id="5864554">-</span>&nbsp;<span class="ident" id="5864556">t</span><span class="op" id="5864557">*</span><span class="ident" id="5864558">DP1</span><span class="op" id="5864561">)</span>&nbsp;<span class="op" id="5864563">-</span>&nbsp;<span class="ident" id="5864565">t</span><span class="op" id="5864566">*</span><span class="ident" id="5864567">DP2</span><span class="op" id="5864570">)</span>&nbsp;<span class="op" id="5864572">-</span>&nbsp;<span class="ident" id="5864574">t</span><span class="op" id="5864575">*</span><span class="ident" id="5864576">DP3</span><br>
<span class="lineno"></span><span class="op" id="5864580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5864583">//&nbsp;Taylor&nbsp;series&nbsp;expansion&nbsp;for&nbsp;cosh(2y)&nbsp;-&nbsp;cos(2x)</span><br>
<span class="lineno">110</span><span class="keyword" id="5864633">func</span>&nbsp;<span class="ident" id="5864638">tanSeries</span><span class="op" id="5864647">(</span><span class="ident" id="5864648">z</span>&nbsp;<span class="builtintype" id="5864650">complex128</span><span class="op" id="5864660">)</span>&nbsp;<span class="builtintype" id="5864662">float64</span>&nbsp;<span class="op" id="5864670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5864673">const</span>&nbsp;<span class="ident" id="5864679">MACHEP</span>&nbsp;<span class="op" id="5864686">=</span>&nbsp;<span class="num" id="5864688">1.0</span>&nbsp;<span class="op" id="5864692">/</span>&nbsp;<span class="op" id="5864694">(</span><span class="num" id="5864695">1</span>&nbsp;<span class="op" id="5864697">&lt;&lt;</span>&nbsp;<span class="num" id="5864700">53</span><span class="op" id="5864702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864705">x</span>&nbsp;<span class="op" id="5864707">:=</span>&nbsp;<span class="ident" id="5864710">math</span><span class="op" id="5864714">.</span><span class="ident" id="5864715">Abs</span><span class="op" id="5864718">(</span><span class="num" id="5864719">2</span>&nbsp;<span class="op" id="5864721">*</span>&nbsp;<span class="builtinfunc" id="5864723">real</span><span class="op" id="5864727">(</span><span class="ident" id="5864728">z</span><span class="op" id="5864729">)</span><span class="op" id="5864730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864733">y</span>&nbsp;<span class="op" id="5864735">:=</span>&nbsp;<span class="ident" id="5864738">math</span><span class="op" id="5864742">.</span><span class="ident" id="5864743">Abs</span><span class="op" id="5864746">(</span><span class="num" id="5864747">2</span>&nbsp;<span class="op" id="5864749">*</span>&nbsp;<span class="builtinfunc" id="5864751">imag</span><span class="op" id="5864755">(</span><span class="ident" id="5864756">z</span><span class="op" id="5864757">)</span><span class="op" id="5864758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864761">x</span>&nbsp;<span class="op" id="5864763">=</span>&nbsp;<span class="ident" id="5864765">reducePi</span><span class="op" id="5864773">(</span><span class="ident" id="5864774">x</span><span class="op" id="5864775">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864778">x</span>&nbsp;<span class="op" id="5864780">=</span>&nbsp;<span class="ident" id="5864782">x</span>&nbsp;<span class="op" id="5864784">*</span>&nbsp;<span class="ident" id="5864786">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864789">y</span>&nbsp;<span class="op" id="5864791">=</span>&nbsp;<span class="ident" id="5864793">y</span>&nbsp;<span class="op" id="5864795">*</span>&nbsp;<span class="ident" id="5864797">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864800">x2</span>&nbsp;<span class="op" id="5864803">:=</span>&nbsp;<span class="num" id="5864806">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864811">y2</span>&nbsp;<span class="op" id="5864814">:=</span>&nbsp;<span class="num" id="5864817">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864822">f</span>&nbsp;<span class="op" id="5864824">:=</span>&nbsp;<span class="num" id="5864827">1.0</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864832">rn</span>&nbsp;<span class="op" id="5864835">:=</span>&nbsp;<span class="num" id="5864838">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864843">d</span>&nbsp;<span class="op" id="5864845">:=</span>&nbsp;<span class="num" id="5864848">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5864853">for</span>&nbsp;<span class="op" id="5864857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864861">rn</span>&nbsp;<span class="op" id="5864864">+=</span>&nbsp;<span class="num" id="5864867">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864871">f</span>&nbsp;<span class="op" id="5864873">*=</span>&nbsp;<span class="ident" id="5864876">rn</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864881">rn</span>&nbsp;<span class="op" id="5864884">+=</span>&nbsp;<span class="num" id="5864887">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864891">f</span>&nbsp;<span class="op" id="5864893">*=</span>&nbsp;<span class="ident" id="5864896">rn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864901">x2</span>&nbsp;<span class="op" id="5864904">*=</span>&nbsp;<span class="ident" id="5864907">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864911">y2</span>&nbsp;<span class="op" id="5864914">*=</span>&nbsp;<span class="ident" id="5864917">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864921">t</span>&nbsp;<span class="op" id="5864923">:=</span>&nbsp;<span class="ident" id="5864926">y2</span>&nbsp;<span class="op" id="5864929">+</span>&nbsp;<span class="ident" id="5864931">x2</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864936">t</span>&nbsp;<span class="op" id="5864938">/=</span>&nbsp;<span class="ident" id="5864941">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864945">d</span>&nbsp;<span class="op" id="5864947">+=</span>&nbsp;<span class="ident" id="5864950">t</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864955">rn</span>&nbsp;<span class="op" id="5864958">+=</span>&nbsp;<span class="num" id="5864961">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864965">f</span>&nbsp;<span class="op" id="5864967">*=</span>&nbsp;<span class="ident" id="5864970">rn</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864975">rn</span>&nbsp;<span class="op" id="5864978">+=</span>&nbsp;<span class="num" id="5864981">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864985">f</span>&nbsp;<span class="op" id="5864987">*=</span>&nbsp;<span class="ident" id="5864990">rn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864995">x2</span>&nbsp;<span class="op" id="5864998">*=</span>&nbsp;<span class="ident" id="5865001">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5865005">y2</span>&nbsp;<span class="op" id="5865008">*=</span>&nbsp;<span class="ident" id="5865011">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5865015">t</span>&nbsp;<span class="op" id="5865017">=</span>&nbsp;<span class="ident" id="5865019">y2</span>&nbsp;<span class="op" id="5865022">-</span>&nbsp;<span class="ident" id="5865024">x2</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5865029">t</span>&nbsp;<span class="op" id="5865031">/=</span>&nbsp;<span class="ident" id="5865034">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5865038">d</span>&nbsp;<span class="op" id="5865040">+=</span>&nbsp;<span class="ident" id="5865043">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865047">if</span>&nbsp;<span class="ident" id="5865050">math</span><span class="op" id="5865054">.</span><span class="ident" id="5865055">Abs</span><span class="op" id="5865058">(</span><span class="ident" id="5865059">t</span><span class="op" id="5865060">/</span><span class="ident" id="5865061">d</span><span class="op" id="5865062">)</span>&nbsp;<span class="op" id="5865064">&lt;=</span>&nbsp;<span class="ident" id="5865067">MACHEP</span>&nbsp;<span class="op" id="5865074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865079">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5865087">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5865090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865093">return</span>&nbsp;<span class="ident" id="5865100">d</span><br>
<span class="lineno"></span><span class="op" id="5865102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5865105">//&nbsp;Complex&nbsp;circular&nbsp;cotangent</span><br>
<span class="lineno">150</span><span class="comment" id="5865135">//</span><br>
<span class="lineno"></span><span class="comment" id="5865138">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5865154">//</span><br>
<span class="lineno"></span><span class="comment" id="5865157">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="5865163">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno">155</span><span class="comment" id="5865182">//</span><br>
<span class="lineno"></span><span class="comment" id="5865185">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="5865193">//</span><br>
<span class="lineno"></span><span class="comment" id="5865196">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin&nbsp;2x&nbsp;&nbsp;-&nbsp;&nbsp;i&nbsp;sinh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="5865230">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;--------------------.</span><br>
<span class="lineno">160</span><span class="comment" id="5865265">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cosh&nbsp;2y&nbsp;&nbsp;-&nbsp;&nbsp;cos&nbsp;2x</span><br>
<span class="lineno"></span><span class="comment" id="5865298">//</span><br>
<span class="lineno"></span><span class="comment" id="5865301">//&nbsp;On&nbsp;the&nbsp;real&nbsp;axis,&nbsp;the&nbsp;denominator&nbsp;has&nbsp;zeros&nbsp;at&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="5865356">//&nbsp;multiples&nbsp;of&nbsp;PI/2.&nbsp;&nbsp;Near&nbsp;these&nbsp;points&nbsp;it&nbsp;is&nbsp;evaluated</span><br>
<span class="lineno"></span><span class="comment" id="5865413">//&nbsp;by&nbsp;a&nbsp;Taylor&nbsp;series.</span><br>
<span class="lineno">165</span><span class="comment" id="5865436">//</span><br>
<span class="lineno"></span><span class="comment" id="5865439">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="5865452">//</span><br>
<span class="lineno"></span><span class="comment" id="5865455">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5865495">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">170</span><span class="comment" id="5865553">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.5e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-17</span><br>
<span class="lineno"></span><span class="comment" id="5865613">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.2e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="5865673">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;ctan&nbsp;*&nbsp;ccot&nbsp;=&nbsp;1&nbsp;+&nbsp;i0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5865714">//&nbsp;Cot&nbsp;returns&nbsp;the&nbsp;cotangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno">175</span><span class="keyword" id="5865749">func</span>&nbsp;<span class="ident" id="5865754">Cot</span><span class="op" id="5865757">(</span><span class="ident" id="5865758">x</span>&nbsp;<span class="builtintype" id="5865760">complex128</span><span class="op" id="5865770">)</span>&nbsp;<span class="builtintype" id="5865772">complex128</span>&nbsp;<span class="op" id="5865783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5865786">d</span>&nbsp;<span class="op" id="5865788">:=</span>&nbsp;<span class="ident" id="5865791">math</span><span class="op" id="5865795">.</span><span class="ident" id="5865796">Cosh</span><span class="op" id="5865800">(</span><span class="num" id="5865801">2</span><span class="op" id="5865802">*</span><span class="builtinfunc" id="5865803">imag</span><span class="op" id="5865807">(</span><span class="ident" id="5865808">x</span><span class="op" id="5865809">)</span><span class="op" id="5865810">)</span>&nbsp;<span class="op" id="5865812">-</span>&nbsp;<span class="ident" id="5865814">math</span><span class="op" id="5865818">.</span><span class="ident" id="5865819">Cos</span><span class="op" id="5865822">(</span><span class="num" id="5865823">2</span><span class="op" id="5865824">*</span><span class="builtinfunc" id="5865825">real</span><span class="op" id="5865829">(</span><span class="ident" id="5865830">x</span><span class="op" id="5865831">)</span><span class="op" id="5865832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865835">if</span>&nbsp;<span class="ident" id="5865838">math</span><span class="op" id="5865842">.</span><span class="ident" id="5865843">Abs</span><span class="op" id="5865846">(</span><span class="ident" id="5865847">d</span><span class="op" id="5865848">)</span>&nbsp;<span class="op" id="5865850">&lt;</span>&nbsp;<span class="num" id="5865852">0.25</span>&nbsp;<span class="op" id="5865857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5865861">d</span>&nbsp;<span class="op" id="5865863">=</span>&nbsp;<span class="ident" id="5865865">tanSeries</span><span class="op" id="5865874">(</span><span class="ident" id="5865875">x</span><span class="op" id="5865876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5865879">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865882">if</span>&nbsp;<span class="ident" id="5865885">d</span>&nbsp;<span class="op" id="5865887">==</span>&nbsp;<span class="num" id="5865890">0</span>&nbsp;<span class="op" id="5865892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865896">return</span>&nbsp;<span class="ident" id="5865903">Inf</span><span class="op" id="5865906">(</span><span class="op" id="5865907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5865910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865913">return</span>&nbsp;<span class="builtinfunc" id="5865920">complex</span><span class="op" id="5865927">(</span><span class="ident" id="5865928">math</span><span class="op" id="5865932">.</span><span class="ident" id="5865933">Sin</span><span class="op" id="5865936">(</span><span class="num" id="5865937">2</span><span class="op" id="5865938">*</span><span class="builtinfunc" id="5865939">real</span><span class="op" id="5865943">(</span><span class="ident" id="5865944">x</span><span class="op" id="5865945">)</span><span class="op" id="5865946">)</span><span class="op" id="5865947">/</span><span class="ident" id="5865948">d</span><span class="op" id="5865949">,</span>&nbsp;<span class="op" id="5865951">-</span><span class="ident" id="5865952">math</span><span class="op" id="5865956">.</span><span class="ident" id="5865957">Sinh</span><span class="op" id="5865961">(</span><span class="num" id="5865962">2</span><span class="op" id="5865963">*</span><span class="builtinfunc" id="5865964">imag</span><span class="op" id="5865968">(</span><span class="ident" id="5865969">x</span><span class="op" id="5865970">)</span><span class="op" id="5865971">)</span><span class="op" id="5865972">/</span><span class="ident" id="5865973">d</span><span class="op" id="5865974">)</span><br>
<span class="lineno"></span><span class="op" id="5865976">}</span>
</div>
</body>
</html>
