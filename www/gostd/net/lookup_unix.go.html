<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3687692">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3687748">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3687802">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3687853">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3687918">package</span>&nbsp;<span class="ident" id="3687926">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3687931">import</span>&nbsp;<span class="op" id="3687938">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3687941">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3687951">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="3687958">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3687961">var</span>&nbsp;<span class="ident" id="3687965">onceReadProtocols</span>&nbsp;<span class="ident" id="3687983">sync</span><span class="op" id="3687987">.</span><span class="ident" id="3687988">Once</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3687994">//&nbsp;readProtocols&nbsp;loads&nbsp;contents&nbsp;of&nbsp;/etc/protocols&nbsp;into&nbsp;protocols&nbsp;map</span><br>
<span class="lineno"></span><span class="comment" id="3688063">//&nbsp;for&nbsp;quick&nbsp;access.</span><br>
<span class="lineno"></span><span class="keyword" id="3688084">func</span>&nbsp;<span class="ident" id="3688089">readProtocols</span><span class="op" id="3688102">(</span><span class="op" id="3688103">)</span>&nbsp;<span class="op" id="3688105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3688108">if</span>&nbsp;<span class="ident" id="3688111">file</span><span class="op" id="3688115">,</span>&nbsp;<span class="ident" id="3688117">err</span>&nbsp;<span class="op" id="3688121">:=</span>&nbsp;<span class="ident" id="3688124">open</span><span class="op" id="3688128">(</span><span class="string" id="3688129">&#34;/etc/protocols&#34;</span><span class="op" id="3688145">)</span><span class="op" id="3688146">;</span>&nbsp;<span class="ident" id="3688148">err</span>&nbsp;<span class="op" id="3688152">==</span>&nbsp;<span class="ident" id="3688155">nil</span>&nbsp;<span class="op" id="3688159">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3688163">for</span>&nbsp;<span class="ident" id="3688167">line</span><span class="op" id="3688171">,</span>&nbsp;<span class="ident" id="3688173">ok</span>&nbsp;<span class="op" id="3688176">:=</span>&nbsp;<span class="ident" id="3688179">file</span><span class="op" id="3688183">.</span><span class="ident" id="3688184">readLine</span><span class="op" id="3688192">(</span><span class="op" id="3688193">)</span><span class="op" id="3688194">;</span>&nbsp;<span class="ident" id="3688196">ok</span><span class="op" id="3688198">;</span>&nbsp;<span class="ident" id="3688200">line</span><span class="op" id="3688204">,</span>&nbsp;<span class="ident" id="3688206">ok</span>&nbsp;<span class="op" id="3688209">=</span>&nbsp;<span class="ident" id="3688211">file</span><span class="op" id="3688215">.</span><span class="ident" id="3688216">readLine</span><span class="op" id="3688224">(</span><span class="op" id="3688225">)</span>&nbsp;<span class="op" id="3688227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3688232">//&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;TCP&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;transmission&nbsp;control&nbsp;protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3688288">if</span>&nbsp;<span class="ident" id="3688291">i</span>&nbsp;<span class="op" id="3688293">:=</span>&nbsp;<span class="ident" id="3688296">byteIndex</span><span class="op" id="3688305">(</span><span class="ident" id="3688306">line</span><span class="op" id="3688310">,</span>&nbsp;<span class="string" id="3688312">&#39;#&#39;</span><span class="op" id="3688315">)</span><span class="op" id="3688316">;</span>&nbsp;<span class="ident" id="3688318">i</span>&nbsp;<span class="op" id="3688320">&gt;=</span>&nbsp;<span class="num" id="3688323">0</span>&nbsp;<span class="op" id="3688325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688331">line</span>&nbsp;<span class="op" id="3688336">=</span>&nbsp;<span class="ident" id="3688338">line</span><span class="op" id="3688342">[</span><span class="num" id="3688343">0</span><span class="op" id="3688344">:</span><span class="ident" id="3688345">i</span><span class="op" id="3688346">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3688351">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688356">f</span>&nbsp;<span class="op" id="3688358">:=</span>&nbsp;<span class="ident" id="3688361">getFields</span><span class="op" id="3688370">(</span><span class="ident" id="3688371">line</span><span class="op" id="3688375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3688380">if</span>&nbsp;<span class="builtinfunc" id="3688383">len</span><span class="op" id="3688386">(</span><span class="ident" id="3688387">f</span><span class="op" id="3688388">)</span>&nbsp;<span class="op" id="3688390">&lt;</span>&nbsp;<span class="num" id="3688392">2</span>&nbsp;<span class="op" id="3688394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3688400">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3688412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3688417">if</span>&nbsp;<span class="ident" id="3688420">proto</span><span class="op" id="3688425">,</span>&nbsp;<span class="ident" id="3688427">_</span><span class="op" id="3688428">,</span>&nbsp;<span class="ident" id="3688430">ok</span>&nbsp;<span class="op" id="3688433">:=</span>&nbsp;<span class="ident" id="3688436">dtoi</span><span class="op" id="3688440">(</span><span class="ident" id="3688441">f</span><span class="op" id="3688442">[</span><span class="num" id="3688443">1</span><span class="op" id="3688444">]</span><span class="op" id="3688445">,</span>&nbsp;<span class="num" id="3688447">0</span><span class="op" id="3688448">)</span><span class="op" id="3688449">;</span>&nbsp;<span class="ident" id="3688451">ok</span>&nbsp;<span class="op" id="3688454">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3688460">if</span>&nbsp;<span class="ident" id="3688463">_</span><span class="op" id="3688464">,</span>&nbsp;<span class="ident" id="3688466">ok</span>&nbsp;<span class="op" id="3688469">:=</span>&nbsp;<span class="ident" id="3688472">protocols</span><span class="op" id="3688481">[</span><span class="ident" id="3688482">f</span><span class="op" id="3688483">[</span><span class="num" id="3688484">0</span><span class="op" id="3688485">]</span><span class="op" id="3688486">]</span><span class="op" id="3688487">;</span>&nbsp;<span class="op" id="3688489">!</span><span class="ident" id="3688490">ok</span>&nbsp;<span class="op" id="3688493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688500">protocols</span><span class="op" id="3688509">[</span><span class="ident" id="3688510">f</span><span class="op" id="3688511">[</span><span class="num" id="3688512">0</span><span class="op" id="3688513">]</span><span class="op" id="3688514">]</span>&nbsp;<span class="op" id="3688516">=</span>&nbsp;<span class="ident" id="3688518">proto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3688528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3688534">for</span>&nbsp;<span class="ident" id="3688538">_</span><span class="op" id="3688539">,</span>&nbsp;<span class="ident" id="3688541">alias</span>&nbsp;<span class="op" id="3688547">:=</span>&nbsp;<span class="keyword" id="3688550">range</span>&nbsp;<span class="ident" id="3688556">f</span><span class="op" id="3688557">[</span><span class="num" id="3688558">2</span><span class="op" id="3688559">:</span><span class="op" id="3688560">]</span>&nbsp;<span class="op" id="3688562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3688569">if</span>&nbsp;<span class="ident" id="3688572">_</span><span class="op" id="3688573">,</span>&nbsp;<span class="ident" id="3688575">ok</span>&nbsp;<span class="op" id="3688578">:=</span>&nbsp;<span class="ident" id="3688581">protocols</span><span class="op" id="3688590">[</span><span class="ident" id="3688591">alias</span><span class="op" id="3688596">]</span><span class="op" id="3688597">;</span>&nbsp;<span class="op" id="3688599">!</span><span class="ident" id="3688600">ok</span>&nbsp;<span class="op" id="3688603">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688611">protocols</span><span class="op" id="3688620">[</span><span class="ident" id="3688621">alias</span><span class="op" id="3688626">]</span>&nbsp;<span class="op" id="3688628">=</span>&nbsp;<span class="ident" id="3688630">proto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3688641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3688647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3688652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3688656">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688660">file</span><span class="op" id="3688664">.</span><span class="builtinfunc" id="3688665">close</span><span class="op" id="3688670">(</span><span class="op" id="3688671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3688674">}</span><br>
<span class="lineno"></span><span class="op" id="3688676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3688679">//&nbsp;lookupProtocol&nbsp;looks&nbsp;up&nbsp;IP&nbsp;protocol&nbsp;name&nbsp;in&nbsp;/etc/protocols&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="3688745">//&nbsp;returns&nbsp;correspondent&nbsp;protocol&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="3688787">func</span>&nbsp;<span class="ident" id="3688792">lookupProtocol</span><span class="op" id="3688806">(</span><span class="ident" id="3688807">name</span>&nbsp;<span class="builtintype" id="3688812">string</span><span class="op" id="3688818">)</span>&nbsp;<span class="op" id="3688820">(</span><span class="ident" id="3688821">proto</span>&nbsp;<span class="builtintype" id="3688827">int</span><span class="op" id="3688830">,</span>&nbsp;<span class="ident" id="3688832">err</span>&nbsp;<span class="builtintype" id="3688836">error</span><span class="op" id="3688841">)</span>&nbsp;<span class="op" id="3688843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688846">onceReadProtocols</span><span class="op" id="3688863">.</span><span class="ident" id="3688864">Do</span><span class="op" id="3688866">(</span><span class="ident" id="3688867">readProtocols</span><span class="op" id="3688880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688883">proto</span><span class="op" id="3688888">,</span>&nbsp;<span class="ident" id="3688890">found</span>&nbsp;<span class="op" id="3688896">:=</span>&nbsp;<span class="ident" id="3688899">protocols</span><span class="op" id="3688908">[</span><span class="ident" id="3688909">name</span><span class="op" id="3688913">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3688916">if</span>&nbsp;<span class="op" id="3688919">!</span><span class="ident" id="3688920">found</span>&nbsp;<span class="op" id="3688926">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3688930">return</span>&nbsp;<span class="num" id="3688937">0</span><span class="op" id="3688938">,</span>&nbsp;<span class="ident" id="3688940">errors</span><span class="op" id="3688946">.</span><span class="ident" id="3688947">New</span><span class="op" id="3688950">(</span><span class="string" id="3688951">&#34;unknown&nbsp;IP&nbsp;protocol&nbsp;specified:&nbsp;&#34;</span>&nbsp;<span class="op" id="3688985">+</span>&nbsp;<span class="ident" id="3688987">name</span><span class="op" id="3688991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3688994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3688997">return</span><br>
<span class="lineno"></span><span class="op" id="3689004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3689007">func</span>&nbsp;<span class="ident" id="3689012">lookupHost</span><span class="op" id="3689022">(</span><span class="ident" id="3689023">host</span>&nbsp;<span class="builtintype" id="3689028">string</span><span class="op" id="3689034">)</span>&nbsp;<span class="op" id="3689036">(</span><span class="ident" id="3689037">addrs</span>&nbsp;<span class="op" id="3689043">[</span><span class="op" id="3689044">]</span><span class="builtintype" id="3689045">string</span><span class="op" id="3689051">,</span>&nbsp;<span class="ident" id="3689053">err</span>&nbsp;<span class="builtintype" id="3689057">error</span><span class="op" id="3689062">)</span>&nbsp;<span class="op" id="3689064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689067">addrs</span><span class="op" id="3689072">,</span>&nbsp;<span class="ident" id="3689074">err</span><span class="op" id="3689077">,</span>&nbsp;<span class="ident" id="3689079">ok</span>&nbsp;<span class="op" id="3689082">:=</span>&nbsp;<span class="ident" id="3689085">cgoLookupHost</span><span class="op" id="3689098">(</span><span class="ident" id="3689099">host</span><span class="op" id="3689103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689106">if</span>&nbsp;<span class="op" id="3689109">!</span><span class="ident" id="3689110">ok</span>&nbsp;<span class="op" id="3689113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689117">addrs</span><span class="op" id="3689122">,</span>&nbsp;<span class="ident" id="3689124">err</span>&nbsp;<span class="op" id="3689128">=</span>&nbsp;<span class="ident" id="3689130">goLookupHost</span><span class="op" id="3689142">(</span><span class="ident" id="3689143">host</span><span class="op" id="3689147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689150">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689153">return</span><br>
<span class="lineno"></span><span class="op" id="3689160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3689163">func</span>&nbsp;<span class="ident" id="3689168">lookupIP</span><span class="op" id="3689176">(</span><span class="ident" id="3689177">host</span>&nbsp;<span class="builtintype" id="3689182">string</span><span class="op" id="3689188">)</span>&nbsp;<span class="op" id="3689190">(</span><span class="ident" id="3689191">addrs</span>&nbsp;<span class="op" id="3689197">[</span><span class="op" id="3689198">]</span><span class="ident" id="3689199">IP</span><span class="op" id="3689201">,</span>&nbsp;<span class="ident" id="3689203">err</span>&nbsp;<span class="builtintype" id="3689207">error</span><span class="op" id="3689212">)</span>&nbsp;<span class="op" id="3689214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689217">addrs</span><span class="op" id="3689222">,</span>&nbsp;<span class="ident" id="3689224">err</span><span class="op" id="3689227">,</span>&nbsp;<span class="ident" id="3689229">ok</span>&nbsp;<span class="op" id="3689232">:=</span>&nbsp;<span class="ident" id="3689235">cgoLookupIP</span><span class="op" id="3689246">(</span><span class="ident" id="3689247">host</span><span class="op" id="3689251">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689254">if</span>&nbsp;<span class="op" id="3689257">!</span><span class="ident" id="3689258">ok</span>&nbsp;<span class="op" id="3689261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689265">addrs</span><span class="op" id="3689270">,</span>&nbsp;<span class="ident" id="3689272">err</span>&nbsp;<span class="op" id="3689276">=</span>&nbsp;<span class="ident" id="3689278">goLookupIP</span><span class="op" id="3689288">(</span><span class="ident" id="3689289">host</span><span class="op" id="3689293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689299">return</span><br>
<span class="lineno"></span><span class="op" id="3689306">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="3689309">func</span>&nbsp;<span class="ident" id="3689314">lookupPort</span><span class="op" id="3689324">(</span><span class="ident" id="3689325">network</span><span class="op" id="3689332">,</span>&nbsp;<span class="ident" id="3689334">service</span>&nbsp;<span class="builtintype" id="3689342">string</span><span class="op" id="3689348">)</span>&nbsp;<span class="op" id="3689350">(</span><span class="ident" id="3689351">port</span>&nbsp;<span class="builtintype" id="3689356">int</span><span class="op" id="3689359">,</span>&nbsp;<span class="ident" id="3689361">err</span>&nbsp;<span class="builtintype" id="3689365">error</span><span class="op" id="3689370">)</span>&nbsp;<span class="op" id="3689372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689375">port</span><span class="op" id="3689379">,</span>&nbsp;<span class="ident" id="3689381">err</span><span class="op" id="3689384">,</span>&nbsp;<span class="ident" id="3689386">ok</span>&nbsp;<span class="op" id="3689389">:=</span>&nbsp;<span class="ident" id="3689392">cgoLookupPort</span><span class="op" id="3689405">(</span><span class="ident" id="3689406">network</span><span class="op" id="3689413">,</span>&nbsp;<span class="ident" id="3689415">service</span><span class="op" id="3689422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689425">if</span>&nbsp;<span class="op" id="3689428">!</span><span class="ident" id="3689429">ok</span>&nbsp;<span class="op" id="3689432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689436">port</span><span class="op" id="3689440">,</span>&nbsp;<span class="ident" id="3689442">err</span>&nbsp;<span class="op" id="3689446">=</span>&nbsp;<span class="ident" id="3689448">goLookupPort</span><span class="op" id="3689460">(</span><span class="ident" id="3689461">network</span><span class="op" id="3689468">,</span>&nbsp;<span class="ident" id="3689470">service</span><span class="op" id="3689477">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689483">return</span><br>
<span class="lineno"></span><span class="op" id="3689490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3689493">func</span>&nbsp;<span class="ident" id="3689498">lookupCNAME</span><span class="op" id="3689509">(</span><span class="ident" id="3689510">name</span>&nbsp;<span class="builtintype" id="3689515">string</span><span class="op" id="3689521">)</span>&nbsp;<span class="op" id="3689523">(</span><span class="ident" id="3689524">cname</span>&nbsp;<span class="builtintype" id="3689530">string</span><span class="op" id="3689536">,</span>&nbsp;<span class="ident" id="3689538">err</span>&nbsp;<span class="builtintype" id="3689542">error</span><span class="op" id="3689547">)</span>&nbsp;<span class="op" id="3689549">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689552">cname</span><span class="op" id="3689557">,</span>&nbsp;<span class="ident" id="3689559">err</span><span class="op" id="3689562">,</span>&nbsp;<span class="ident" id="3689564">ok</span>&nbsp;<span class="op" id="3689567">:=</span>&nbsp;<span class="ident" id="3689570">cgoLookupCNAME</span><span class="op" id="3689584">(</span><span class="ident" id="3689585">name</span><span class="op" id="3689589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689592">if</span>&nbsp;<span class="op" id="3689595">!</span><span class="ident" id="3689596">ok</span>&nbsp;<span class="op" id="3689599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689603">cname</span><span class="op" id="3689608">,</span>&nbsp;<span class="ident" id="3689610">err</span>&nbsp;<span class="op" id="3689614">=</span>&nbsp;<span class="ident" id="3689616">goLookupCNAME</span><span class="op" id="3689629">(</span><span class="ident" id="3689630">name</span><span class="op" id="3689634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689640">return</span><br>
<span class="lineno">85</span><span class="op" id="3689647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3689650">func</span>&nbsp;<span class="ident" id="3689655">lookupSRV</span><span class="op" id="3689664">(</span><span class="ident" id="3689665">service</span><span class="op" id="3689672">,</span>&nbsp;<span class="ident" id="3689674">proto</span><span class="op" id="3689679">,</span>&nbsp;<span class="ident" id="3689681">name</span>&nbsp;<span class="builtintype" id="3689686">string</span><span class="op" id="3689692">)</span>&nbsp;<span class="op" id="3689694">(</span><span class="ident" id="3689695">cname</span>&nbsp;<span class="builtintype" id="3689701">string</span><span class="op" id="3689707">,</span>&nbsp;<span class="ident" id="3689709">addrs</span>&nbsp;<span class="op" id="3689715">[</span><span class="op" id="3689716">]</span><span class="op" id="3689717">*</span><span class="ident" id="3689718">SRV</span><span class="op" id="3689721">,</span>&nbsp;<span class="ident" id="3689723">err</span>&nbsp;<span class="builtintype" id="3689727">error</span><span class="op" id="3689732">)</span>&nbsp;<span class="op" id="3689734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689737">var</span>&nbsp;<span class="ident" id="3689741">target</span>&nbsp;<span class="builtintype" id="3689748">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689756">if</span>&nbsp;<span class="ident" id="3689759">service</span>&nbsp;<span class="op" id="3689767">==</span>&nbsp;<span class="string" id="3689770">&#34;&#34;</span>&nbsp;<span class="op" id="3689773">&amp;&amp;</span>&nbsp;<span class="ident" id="3689776">proto</span>&nbsp;<span class="op" id="3689782">==</span>&nbsp;<span class="string" id="3689785">&#34;&#34;</span>&nbsp;<span class="op" id="3689788">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689792">target</span>&nbsp;<span class="op" id="3689799">=</span>&nbsp;<span class="ident" id="3689801">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689807">}</span>&nbsp;<span class="keyword" id="3689809">else</span>&nbsp;<span class="op" id="3689814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689818">target</span>&nbsp;<span class="op" id="3689825">=</span>&nbsp;<span class="string" id="3689827">&#34;_&#34;</span>&nbsp;<span class="op" id="3689831">+</span>&nbsp;<span class="ident" id="3689833">service</span>&nbsp;<span class="op" id="3689841">+</span>&nbsp;<span class="string" id="3689843">&#34;._&#34;</span>&nbsp;<span class="op" id="3689848">+</span>&nbsp;<span class="ident" id="3689850">proto</span>&nbsp;<span class="op" id="3689856">+</span>&nbsp;<span class="string" id="3689858">&#34;.&#34;</span>&nbsp;<span class="op" id="3689862">+</span>&nbsp;<span class="ident" id="3689864">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689873">var</span>&nbsp;<span class="ident" id="3689877">records</span>&nbsp;<span class="op" id="3689885">[</span><span class="op" id="3689886">]</span><span class="ident" id="3689887">dnsRR</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689894">cname</span><span class="op" id="3689899">,</span>&nbsp;<span class="ident" id="3689901">records</span><span class="op" id="3689908">,</span>&nbsp;<span class="ident" id="3689910">err</span>&nbsp;<span class="op" id="3689914">=</span>&nbsp;<span class="ident" id="3689916">lookup</span><span class="op" id="3689922">(</span><span class="ident" id="3689923">target</span><span class="op" id="3689929">,</span>&nbsp;<span class="ident" id="3689931">dnsTypeSRV</span><span class="op" id="3689941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689944">if</span>&nbsp;<span class="ident" id="3689947">err</span>&nbsp;<span class="op" id="3689951">!=</span>&nbsp;<span class="ident" id="3689954">nil</span>&nbsp;<span class="op" id="3689958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689962">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689973">addrs</span>&nbsp;<span class="op" id="3689979">=</span>&nbsp;<span class="builtinfunc" id="3689981">make</span><span class="op" id="3689985">(</span><span class="op" id="3689986">[</span><span class="op" id="3689987">]</span><span class="op" id="3689988">*</span><span class="ident" id="3689989">SRV</span><span class="op" id="3689992">,</span>&nbsp;<span class="builtinfunc" id="3689994">len</span><span class="op" id="3689997">(</span><span class="ident" id="3689998">records</span><span class="op" id="3690005">)</span><span class="op" id="3690006">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690009">for</span>&nbsp;<span class="ident" id="3690013">i</span><span class="op" id="3690014">,</span>&nbsp;<span class="ident" id="3690016">rr</span>&nbsp;<span class="op" id="3690019">:=</span>&nbsp;<span class="keyword" id="3690022">range</span>&nbsp;<span class="ident" id="3690028">records</span>&nbsp;<span class="op" id="3690036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690040">r</span>&nbsp;<span class="op" id="3690042">:=</span>&nbsp;<span class="ident" id="3690045">rr</span><span class="op" id="3690047">.</span><span class="op" id="3690048">(</span><span class="op" id="3690049">*</span><span class="ident" id="3690050">dnsRR_SRV</span><span class="op" id="3690059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690063">addrs</span><span class="op" id="3690068">[</span><span class="ident" id="3690069">i</span><span class="op" id="3690070">]</span>&nbsp;<span class="op" id="3690072">=</span>&nbsp;<span class="op" id="3690074">&amp;</span><span class="ident" id="3690075">SRV</span><span class="op" id="3690078">{</span><span class="ident" id="3690079">r</span><span class="op" id="3690080">.</span><span class="ident" id="3690081">Target</span><span class="op" id="3690087">,</span>&nbsp;<span class="ident" id="3690089">r</span><span class="op" id="3690090">.</span><span class="ident" id="3690091">Port</span><span class="op" id="3690095">,</span>&nbsp;<span class="ident" id="3690097">r</span><span class="op" id="3690098">.</span><span class="ident" id="3690099">Priority</span><span class="op" id="3690107">,</span>&nbsp;<span class="ident" id="3690109">r</span><span class="op" id="3690110">.</span><span class="ident" id="3690111">Weight</span><span class="op" id="3690117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3690120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690123">byPriorityWeight</span><span class="op" id="3690139">(</span><span class="ident" id="3690140">addrs</span><span class="op" id="3690145">)</span><span class="op" id="3690146">.</span><span class="ident" id="3690147">sort</span><span class="op" id="3690151">(</span><span class="op" id="3690152">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690155">return</span><br>
<span class="lineno"></span><span class="op" id="3690162">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3690165">func</span>&nbsp;<span class="ident" id="3690170">lookupMX</span><span class="op" id="3690178">(</span><span class="ident" id="3690179">name</span>&nbsp;<span class="builtintype" id="3690184">string</span><span class="op" id="3690190">)</span>&nbsp;<span class="op" id="3690192">(</span><span class="ident" id="3690193">mx</span>&nbsp;<span class="op" id="3690196">[</span><span class="op" id="3690197">]</span><span class="op" id="3690198">*</span><span class="ident" id="3690199">MX</span><span class="op" id="3690201">,</span>&nbsp;<span class="ident" id="3690203">err</span>&nbsp;<span class="builtintype" id="3690207">error</span><span class="op" id="3690212">)</span>&nbsp;<span class="op" id="3690214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690217">_</span><span class="op" id="3690218">,</span>&nbsp;<span class="ident" id="3690220">records</span><span class="op" id="3690227">,</span>&nbsp;<span class="ident" id="3690229">err</span>&nbsp;<span class="op" id="3690233">:=</span>&nbsp;<span class="ident" id="3690236">lookup</span><span class="op" id="3690242">(</span><span class="ident" id="3690243">name</span><span class="op" id="3690247">,</span>&nbsp;<span class="ident" id="3690249">dnsTypeMX</span><span class="op" id="3690258">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690261">if</span>&nbsp;<span class="ident" id="3690264">err</span>&nbsp;<span class="op" id="3690268">!=</span>&nbsp;<span class="ident" id="3690271">nil</span>&nbsp;<span class="op" id="3690275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690279">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3690287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690290">mx</span>&nbsp;<span class="op" id="3690293">=</span>&nbsp;<span class="builtinfunc" id="3690295">make</span><span class="op" id="3690299">(</span><span class="op" id="3690300">[</span><span class="op" id="3690301">]</span><span class="op" id="3690302">*</span><span class="ident" id="3690303">MX</span><span class="op" id="3690305">,</span>&nbsp;<span class="builtinfunc" id="3690307">len</span><span class="op" id="3690310">(</span><span class="ident" id="3690311">records</span><span class="op" id="3690318">)</span><span class="op" id="3690319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690322">for</span>&nbsp;<span class="ident" id="3690326">i</span><span class="op" id="3690327">,</span>&nbsp;<span class="ident" id="3690329">rr</span>&nbsp;<span class="op" id="3690332">:=</span>&nbsp;<span class="keyword" id="3690335">range</span>&nbsp;<span class="ident" id="3690341">records</span>&nbsp;<span class="op" id="3690349">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690353">r</span>&nbsp;<span class="op" id="3690355">:=</span>&nbsp;<span class="ident" id="3690358">rr</span><span class="op" id="3690360">.</span><span class="op" id="3690361">(</span><span class="op" id="3690362">*</span><span class="ident" id="3690363">dnsRR_MX</span><span class="op" id="3690371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690375">mx</span><span class="op" id="3690377">[</span><span class="ident" id="3690378">i</span><span class="op" id="3690379">]</span>&nbsp;<span class="op" id="3690381">=</span>&nbsp;<span class="op" id="3690383">&amp;</span><span class="ident" id="3690384">MX</span><span class="op" id="3690386">{</span><span class="ident" id="3690387">r</span><span class="op" id="3690388">.</span><span class="ident" id="3690389">Mx</span><span class="op" id="3690391">,</span>&nbsp;<span class="ident" id="3690393">r</span><span class="op" id="3690394">.</span><span class="ident" id="3690395">Pref</span><span class="op" id="3690399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3690402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690405">byPref</span><span class="op" id="3690411">(</span><span class="ident" id="3690412">mx</span><span class="op" id="3690414">)</span><span class="op" id="3690415">.</span><span class="ident" id="3690416">sort</span><span class="op" id="3690420">(</span><span class="op" id="3690421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690424">return</span><br>
<span class="lineno">120</span><span class="op" id="3690431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3690434">func</span>&nbsp;<span class="ident" id="3690439">lookupNS</span><span class="op" id="3690447">(</span><span class="ident" id="3690448">name</span>&nbsp;<span class="builtintype" id="3690453">string</span><span class="op" id="3690459">)</span>&nbsp;<span class="op" id="3690461">(</span><span class="ident" id="3690462">ns</span>&nbsp;<span class="op" id="3690465">[</span><span class="op" id="3690466">]</span><span class="op" id="3690467">*</span><span class="ident" id="3690468">NS</span><span class="op" id="3690470">,</span>&nbsp;<span class="ident" id="3690472">err</span>&nbsp;<span class="builtintype" id="3690476">error</span><span class="op" id="3690481">)</span>&nbsp;<span class="op" id="3690483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690486">_</span><span class="op" id="3690487">,</span>&nbsp;<span class="ident" id="3690489">records</span><span class="op" id="3690496">,</span>&nbsp;<span class="ident" id="3690498">err</span>&nbsp;<span class="op" id="3690502">:=</span>&nbsp;<span class="ident" id="3690505">lookup</span><span class="op" id="3690511">(</span><span class="ident" id="3690512">name</span><span class="op" id="3690516">,</span>&nbsp;<span class="ident" id="3690518">dnsTypeNS</span><span class="op" id="3690527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690530">if</span>&nbsp;<span class="ident" id="3690533">err</span>&nbsp;<span class="op" id="3690537">!=</span>&nbsp;<span class="ident" id="3690540">nil</span>&nbsp;<span class="op" id="3690544">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690548">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3690556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690559">ns</span>&nbsp;<span class="op" id="3690562">=</span>&nbsp;<span class="builtinfunc" id="3690564">make</span><span class="op" id="3690568">(</span><span class="op" id="3690569">[</span><span class="op" id="3690570">]</span><span class="op" id="3690571">*</span><span class="ident" id="3690572">NS</span><span class="op" id="3690574">,</span>&nbsp;<span class="builtinfunc" id="3690576">len</span><span class="op" id="3690579">(</span><span class="ident" id="3690580">records</span><span class="op" id="3690587">)</span><span class="op" id="3690588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690591">for</span>&nbsp;<span class="ident" id="3690595">i</span><span class="op" id="3690596">,</span>&nbsp;<span class="ident" id="3690598">r</span>&nbsp;<span class="op" id="3690600">:=</span>&nbsp;<span class="keyword" id="3690603">range</span>&nbsp;<span class="ident" id="3690609">records</span>&nbsp;<span class="op" id="3690617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690621">r</span>&nbsp;<span class="op" id="3690623">:=</span>&nbsp;<span class="ident" id="3690626">r</span><span class="op" id="3690627">.</span><span class="op" id="3690628">(</span><span class="op" id="3690629">*</span><span class="ident" id="3690630">dnsRR_NS</span><span class="op" id="3690638">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690642">ns</span><span class="op" id="3690644">[</span><span class="ident" id="3690645">i</span><span class="op" id="3690646">]</span>&nbsp;<span class="op" id="3690648">=</span>&nbsp;<span class="op" id="3690650">&amp;</span><span class="ident" id="3690651">NS</span><span class="op" id="3690653">{</span><span class="ident" id="3690654">r</span><span class="op" id="3690655">.</span><span class="ident" id="3690656">Ns</span><span class="op" id="3690658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3690661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690664">return</span><br>
<span class="lineno"></span><span class="op" id="3690671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="3690674">func</span>&nbsp;<span class="ident" id="3690679">lookupTXT</span><span class="op" id="3690688">(</span><span class="ident" id="3690689">name</span>&nbsp;<span class="builtintype" id="3690694">string</span><span class="op" id="3690700">)</span>&nbsp;<span class="op" id="3690702">(</span><span class="ident" id="3690703">txt</span>&nbsp;<span class="op" id="3690707">[</span><span class="op" id="3690708">]</span><span class="builtintype" id="3690709">string</span><span class="op" id="3690715">,</span>&nbsp;<span class="ident" id="3690717">err</span>&nbsp;<span class="builtintype" id="3690721">error</span><span class="op" id="3690726">)</span>&nbsp;<span class="op" id="3690728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690731">_</span><span class="op" id="3690732">,</span>&nbsp;<span class="ident" id="3690734">records</span><span class="op" id="3690741">,</span>&nbsp;<span class="ident" id="3690743">err</span>&nbsp;<span class="op" id="3690747">:=</span>&nbsp;<span class="ident" id="3690750">lookup</span><span class="op" id="3690756">(</span><span class="ident" id="3690757">name</span><span class="op" id="3690761">,</span>&nbsp;<span class="ident" id="3690763">dnsTypeTXT</span><span class="op" id="3690773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690776">if</span>&nbsp;<span class="ident" id="3690779">err</span>&nbsp;<span class="op" id="3690783">!=</span>&nbsp;<span class="ident" id="3690786">nil</span>&nbsp;<span class="op" id="3690790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690794">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3690802">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690805">txt</span>&nbsp;<span class="op" id="3690809">=</span>&nbsp;<span class="builtinfunc" id="3690811">make</span><span class="op" id="3690815">(</span><span class="op" id="3690816">[</span><span class="op" id="3690817">]</span><span class="builtintype" id="3690818">string</span><span class="op" id="3690824">,</span>&nbsp;<span class="builtinfunc" id="3690826">len</span><span class="op" id="3690829">(</span><span class="ident" id="3690830">records</span><span class="op" id="3690837">)</span><span class="op" id="3690838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690841">for</span>&nbsp;<span class="ident" id="3690845">i</span><span class="op" id="3690846">,</span>&nbsp;<span class="ident" id="3690848">r</span>&nbsp;<span class="op" id="3690850">:=</span>&nbsp;<span class="keyword" id="3690853">range</span>&nbsp;<span class="ident" id="3690859">records</span>&nbsp;<span class="op" id="3690867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690871">txt</span><span class="op" id="3690874">[</span><span class="ident" id="3690875">i</span><span class="op" id="3690876">]</span>&nbsp;<span class="op" id="3690878">=</span>&nbsp;<span class="ident" id="3690880">r</span><span class="op" id="3690881">.</span><span class="op" id="3690882">(</span><span class="op" id="3690883">*</span><span class="ident" id="3690884">dnsRR_TXT</span><span class="op" id="3690893">)</span><span class="op" id="3690894">.</span><span class="ident" id="3690895">Txt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3690900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690903">return</span><br>
<span class="lineno">145</span><span class="op" id="3690910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3690913">func</span>&nbsp;<span class="ident" id="3690918">lookupAddr</span><span class="op" id="3690928">(</span><span class="ident" id="3690929">addr</span>&nbsp;<span class="builtintype" id="3690934">string</span><span class="op" id="3690940">)</span>&nbsp;<span class="op" id="3690942">(</span><span class="ident" id="3690943">name</span>&nbsp;<span class="op" id="3690948">[</span><span class="op" id="3690949">]</span><span class="builtintype" id="3690950">string</span><span class="op" id="3690956">,</span>&nbsp;<span class="ident" id="3690958">err</span>&nbsp;<span class="builtintype" id="3690962">error</span><span class="op" id="3690967">)</span>&nbsp;<span class="op" id="3690969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690972">name</span>&nbsp;<span class="op" id="3690977">=</span>&nbsp;<span class="ident" id="3690979">lookupStaticAddr</span><span class="op" id="3690995">(</span><span class="ident" id="3690996">addr</span><span class="op" id="3691000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691003">if</span>&nbsp;<span class="builtinfunc" id="3691006">len</span><span class="op" id="3691009">(</span><span class="ident" id="3691010">name</span><span class="op" id="3691014">)</span>&nbsp;<span class="op" id="3691016">&gt;</span>&nbsp;<span class="num" id="3691018">0</span>&nbsp;<span class="op" id="3691020">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691024">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3691032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691035">var</span>&nbsp;<span class="ident" id="3691039">arpa</span>&nbsp;<span class="builtintype" id="3691044">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691052">arpa</span><span class="op" id="3691056">,</span>&nbsp;<span class="ident" id="3691058">err</span>&nbsp;<span class="op" id="3691062">=</span>&nbsp;<span class="ident" id="3691064">reverseaddr</span><span class="op" id="3691075">(</span><span class="ident" id="3691076">addr</span><span class="op" id="3691080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691083">if</span>&nbsp;<span class="ident" id="3691086">err</span>&nbsp;<span class="op" id="3691090">!=</span>&nbsp;<span class="ident" id="3691093">nil</span>&nbsp;<span class="op" id="3691097">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691101">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3691109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691112">var</span>&nbsp;<span class="ident" id="3691116">records</span>&nbsp;<span class="op" id="3691124">[</span><span class="op" id="3691125">]</span><span class="ident" id="3691126">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691133">_</span><span class="op" id="3691134">,</span>&nbsp;<span class="ident" id="3691136">records</span><span class="op" id="3691143">,</span>&nbsp;<span class="ident" id="3691145">err</span>&nbsp;<span class="op" id="3691149">=</span>&nbsp;<span class="ident" id="3691151">lookup</span><span class="op" id="3691157">(</span><span class="ident" id="3691158">arpa</span><span class="op" id="3691162">,</span>&nbsp;<span class="ident" id="3691164">dnsTypePTR</span><span class="op" id="3691174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691177">if</span>&nbsp;<span class="ident" id="3691180">err</span>&nbsp;<span class="op" id="3691184">!=</span>&nbsp;<span class="ident" id="3691187">nil</span>&nbsp;<span class="op" id="3691191">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691195">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3691203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691206">name</span>&nbsp;<span class="op" id="3691211">=</span>&nbsp;<span class="builtinfunc" id="3691213">make</span><span class="op" id="3691217">(</span><span class="op" id="3691218">[</span><span class="op" id="3691219">]</span><span class="builtintype" id="3691220">string</span><span class="op" id="3691226">,</span>&nbsp;<span class="builtinfunc" id="3691228">len</span><span class="op" id="3691231">(</span><span class="ident" id="3691232">records</span><span class="op" id="3691239">)</span><span class="op" id="3691240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691243">for</span>&nbsp;<span class="ident" id="3691247">i</span>&nbsp;<span class="op" id="3691249">:=</span>&nbsp;<span class="keyword" id="3691252">range</span>&nbsp;<span class="ident" id="3691258">records</span>&nbsp;<span class="op" id="3691266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691270">r</span>&nbsp;<span class="op" id="3691272">:=</span>&nbsp;<span class="ident" id="3691275">records</span><span class="op" id="3691282">[</span><span class="ident" id="3691283">i</span><span class="op" id="3691284">]</span><span class="op" id="3691285">.</span><span class="op" id="3691286">(</span><span class="op" id="3691287">*</span><span class="ident" id="3691288">dnsRR_PTR</span><span class="op" id="3691297">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691301">name</span><span class="op" id="3691305">[</span><span class="ident" id="3691306">i</span><span class="op" id="3691307">]</span>&nbsp;<span class="op" id="3691309">=</span>&nbsp;<span class="ident" id="3691311">r</span><span class="op" id="3691312">.</span><span class="ident" id="3691313">Ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3691318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691321">return</span><br>
<span class="lineno"></span><span class="op" id="3691328">}</span>
</div>
</body>
</html>
