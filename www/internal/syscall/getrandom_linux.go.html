<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4019491">//&nbsp;Copyright&nbsp;2014&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4019547">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4019601">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4019652">package</span>&nbsp;<span class="ident" id="4019660">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4019669">import</span>&nbsp;<span class="op" id="4019676">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4019679">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4019690">&#34;sync/atomic&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019705">stdsyscall</span>&nbsp;<span class="string" id="4019716">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4019727">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="4019736">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4019739">var</span>&nbsp;<span class="ident" id="4019743">randomTrap</span>&nbsp;<span class="op" id="4019754">=</span>&nbsp;<span class="keyword" id="4019756">map</span><span class="op" id="4019759">[</span><span class="builtintype" id="4019760">string</span><span class="op" id="4019766">]</span><span class="builtintype" id="4019767">uintptr</span><span class="op" id="4019774">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4019777">&#34;386&#34;</span><span class="op" id="4019782">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="4019786">355</span><span class="op" id="4019789">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4019792">&#34;amd64&#34;</span><span class="op" id="4019799">:</span>&nbsp;<span class="num" id="4019801">318</span><span class="op" id="4019804">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4019807">&#34;arm&#34;</span><span class="op" id="4019812">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="4019816">384</span><span class="op" id="4019819">,</span><br>
<span class="lineno"></span><span class="op" id="4019821">}</span><span class="op" id="4019822">[</span><span class="ident" id="4019823"><a href="/internal/syscall/getrandom_linux.go.html#4019679">runtime</a></span><span class="op" id="4019830">.</span><span class="ident" id="4019831">GOARCH</span><span class="op" id="4019837">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="4019840">var</span>&nbsp;<span class="ident" id="4019844">randomUnsupported</span>&nbsp;<span class="builtintype" id="4019862">int32</span>&nbsp;<span class="comment" id="4019868">//&nbsp;atomic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4019879">//&nbsp;GetRandomFlag&nbsp;is&nbsp;a&nbsp;flag&nbsp;supported&nbsp;by&nbsp;the&nbsp;getrandom&nbsp;system&nbsp;call.</span><br>
<span class="lineno"></span><span class="keyword" id="4019946">type</span>&nbsp;<span class="ident" id="4019951">GetRandomFlag</span>&nbsp;<span class="builtintype" id="4019965">uintptr</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="4019974">const</span>&nbsp;<span class="op" id="4019980">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4019983">//&nbsp;GRND_NONBLOCK&nbsp;means&nbsp;return&nbsp;EAGAIN&nbsp;rather&nbsp;than&nbsp;blocking.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020043">GRND_NONBLOCK</span>&nbsp;<span class="ident" id="4020057"><a href="/internal/syscall/getrandom_linux.go.html#4019951">GetRandomFlag</a></span>&nbsp;<span class="op" id="4020071">=</span>&nbsp;<span class="num" id="4020073">0x0001</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4020082">//&nbsp;GRND_RANDOM&nbsp;means&nbsp;use&nbsp;the&nbsp;/dev/random&nbsp;pool&nbsp;instead&nbsp;of&nbsp;/dev/urandom.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020154">GRND_RANDOM</span>&nbsp;<span class="ident" id="4020166"><a href="/internal/syscall/getrandom_linux.go.html#4019951">GetRandomFlag</a></span>&nbsp;<span class="op" id="4020180">=</span>&nbsp;<span class="num" id="4020182">0x0002</span><br>
<span class="lineno"></span><span class="op" id="4020189">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4020192">//&nbsp;GetRandom&nbsp;calls&nbsp;the&nbsp;Linux&nbsp;getrandom&nbsp;system&nbsp;call.</span><br>
<span class="lineno"></span><span class="comment" id="4020244">//&nbsp;See&nbsp;https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=c6e9d6f38894798696f23c8084ca7edbf16ee895</span><br>
<span class="lineno">35</span><span class="keyword" id="4020367">func</span>&nbsp;<span class="ident" id="4020372">GetRandom</span><span class="op" id="4020381">(</span><span class="ident" id="4020382">p</span>&nbsp;<span class="op" id="4020384">[</span><span class="op" id="4020385">]</span><span class="builtintype" id="4020386">byte</span><span class="op" id="4020390">,</span>&nbsp;<span class="ident" id="4020392">flags</span>&nbsp;<span class="ident" id="4020398"><a href="/internal/syscall/getrandom_linux.go.html#4019951">GetRandomFlag</a></span><span class="op" id="4020411">)</span>&nbsp;<span class="op" id="4020413">(</span><span class="ident" id="4020414">n</span>&nbsp;<span class="builtintype" id="4020416">int</span><span class="op" id="4020419">,</span>&nbsp;<span class="ident" id="4020421">err</span>&nbsp;<span class="builtintype" id="4020425">error</span><span class="op" id="4020430">)</span>&nbsp;<span class="op" id="4020432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4020435">if</span>&nbsp;<span class="ident" id="4020438"><a href="/internal/syscall/getrandom_linux.go.html#4019743">randomTrap</a></span>&nbsp;<span class="op" id="4020449">==</span>&nbsp;<span class="num" id="4020452">0</span>&nbsp;<span class="op" id="4020454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4020458">return</span>&nbsp;<span class="num" id="4020465">0</span><span class="op" id="4020466">,</span>&nbsp;<span class="ident" id="4020468"><a href="/internal/syscall/getrandom_linux.go.html#4019705">stdsyscall</a></span><span class="op" id="4020478">.</span><span class="ident" id="4020479">ENOSYS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4020487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4020490">if</span>&nbsp;<span class="builtinfunc" id="4020493">len</span><span class="op" id="4020496">(</span><span class="ident" id="4020497"><a href="/internal/syscall/getrandom_linux.go.html#4020382">p</a></span><span class="op" id="4020498">)</span>&nbsp;<span class="op" id="4020500">==</span>&nbsp;<span class="num" id="4020503">0</span>&nbsp;<span class="op" id="4020505">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4020509">return</span>&nbsp;<span class="num" id="4020516">0</span><span class="op" id="4020517">,</span>&nbsp;<span class="ident" id="4020519">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4020524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4020527">if</span>&nbsp;<span class="ident" id="4020530"><a href="/internal/syscall/getrandom_linux.go.html#4019690">atomic</a></span><span class="op" id="4020536">.</span><span class="ident" id="4020537">LoadInt32</span><span class="op" id="4020546">(</span><span class="op" id="4020547">&amp;</span><span class="ident" id="4020548"><a href="/internal/syscall/getrandom_linux.go.html#4019844">randomUnsupported</a></span><span class="op" id="4020565">)</span>&nbsp;<span class="op" id="4020567">!=</span>&nbsp;<span class="num" id="4020570">0</span>&nbsp;<span class="op" id="4020572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4020576">return</span>&nbsp;<span class="num" id="4020583">0</span><span class="op" id="4020584">,</span>&nbsp;<span class="ident" id="4020586"><a href="/internal/syscall/getrandom_linux.go.html#4019705">stdsyscall</a></span><span class="op" id="4020596">.</span><span class="ident" id="4020597">ENOSYS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4020605">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020608">r1</span><span class="op" id="4020610">,</span>&nbsp;<span class="ident" id="4020612">_</span><span class="op" id="4020613">,</span>&nbsp;<span class="ident" id="4020615">errno</span>&nbsp;<span class="op" id="4020621">:=</span>&nbsp;<span class="ident" id="4020624"><a href="/internal/syscall/getrandom_linux.go.html#4019705">stdsyscall</a></span><span class="op" id="4020634">.</span><span class="ident" id="4020635">Syscall</span><span class="op" id="4020642">(</span><span class="ident" id="4020643"><a href="/internal/syscall/getrandom_linux.go.html#4019743">randomTrap</a></span><span class="op" id="4020653">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4020657">uintptr</span><span class="op" id="4020664">(</span><span class="ident" id="4020665"><a href="/internal/syscall/getrandom_linux.go.html#4019727">unsafe</a></span><span class="op" id="4020671">.</span><span class="ident" id="4020672">Pointer</span><span class="op" id="4020679">(</span><span class="op" id="4020680">&amp;</span><span class="ident" id="4020681"><a href="/internal/syscall/getrandom_linux.go.html#4020382">p</a></span><span class="op" id="4020682">[</span><span class="num" id="4020683">0</span><span class="op" id="4020684">]</span><span class="op" id="4020685">)</span><span class="op" id="4020686">)</span><span class="op" id="4020687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4020691">uintptr</span><span class="op" id="4020698">(</span><span class="builtinfunc" id="4020699">len</span><span class="op" id="4020702">(</span><span class="ident" id="4020703"><a href="/internal/syscall/getrandom_linux.go.html#4020382">p</a></span><span class="op" id="4020704">)</span><span class="op" id="4020705">)</span><span class="op" id="4020706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4020710">uintptr</span><span class="op" id="4020717">(</span><span class="ident" id="4020718"><a href="/internal/syscall/getrandom_linux.go.html#4020392">flags</a></span><span class="op" id="4020723">)</span><span class="op" id="4020724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4020727">if</span>&nbsp;<span class="ident" id="4020730"><a href="/internal/syscall/getrandom_linux.go.html#4020615">errno</a></span>&nbsp;<span class="op" id="4020736">!=</span>&nbsp;<span class="num" id="4020739">0</span>&nbsp;<span class="op" id="4020741">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4020745">if</span>&nbsp;<span class="ident" id="4020748"><a href="/internal/syscall/getrandom_linux.go.html#4020615">errno</a></span>&nbsp;<span class="op" id="4020754">==</span>&nbsp;<span class="ident" id="4020757"><a href="/internal/syscall/getrandom_linux.go.html#4019705">stdsyscall</a></span><span class="op" id="4020767">.</span><span class="ident" id="4020768">ENOSYS</span>&nbsp;<span class="op" id="4020775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020780"><a href="/internal/syscall/getrandom_linux.go.html#4019690">atomic</a></span><span class="op" id="4020786">.</span><span class="ident" id="4020787">StoreInt32</span><span class="op" id="4020797">(</span><span class="op" id="4020798">&amp;</span><span class="ident" id="4020799"><a href="/internal/syscall/getrandom_linux.go.html#4019844">randomUnsupported</a></span><span class="op" id="4020816">,</span>&nbsp;<span class="num" id="4020818">1</span><span class="op" id="4020819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4020823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4020827">return</span>&nbsp;<span class="num" id="4020834">0</span><span class="op" id="4020835">,</span>&nbsp;<span class="ident" id="4020837"><a href="/internal/syscall/getrandom_linux.go.html#4020615">errno</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4020844">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4020847">return</span>&nbsp;<span class="builtintype" id="4020854">int</span><span class="op" id="4020857">(</span><span class="ident" id="4020858"><a href="/internal/syscall/getrandom_linux.go.html#4020608">r1</a></span><span class="op" id="4020860">)</span><span class="op" id="4020861">,</span>&nbsp;<span class="ident" id="4020863">nil</span><br>
<span class="lineno"></span><span class="op" id="4020867">}</span>
</div>
</body>
</html>
