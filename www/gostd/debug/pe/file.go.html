<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/pe</h2>
<ul>
<li><a href="/gostd/debug/pe/file.go.html" class="current">file.go</a></li>
<li><a href="/gostd/debug/pe/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/pe/pe.go.html">pe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6102447">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6102503">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6102557">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6102608">//&nbsp;Package&nbsp;pe&nbsp;implements&nbsp;access&nbsp;to&nbsp;PE&nbsp;(Microsoft&nbsp;Windows&nbsp;Portable&nbsp;Executable)&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="6102693">package</span>&nbsp;<span class="ident" id="6102701">pe</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6102705">import</span>&nbsp;<span class="op" id="6102712">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6102715">&#34;debug/dwarf&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6102730">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6102749">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6102759">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6102766">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6102772">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6102778">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="6102788">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6102791">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;PE&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6102829">type</span>&nbsp;<span class="ident" id="6102834">File</span>&nbsp;<span class="keyword" id="6102839">struct</span>&nbsp;<span class="op" id="6102846">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102849">FileHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102861">OptionalHeader</span>&nbsp;<span class="keyword" id="6102876">interface</span><span class="op" id="6102885">{</span><span class="op" id="6102886">}</span>&nbsp;<span class="comment" id="6102888">//&nbsp;of&nbsp;type&nbsp;*OptionalHeader32&nbsp;or&nbsp;*OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102939">Sections</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6102954">[</span><span class="op" id="6102955">]</span><span class="op" id="6102956">*</span><span class="ident" id="6102957">Section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102966">Symbols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6102981">[</span><span class="op" id="6102982">]</span><span class="op" id="6102983">*</span><span class="ident" id="6102984">Symbol</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6102993">closer</span>&nbsp;<span class="ident" id="6103000">io</span><span class="op" id="6103002">.</span><span class="ident" id="6103003">Closer</span><br>
<span class="lineno"></span><span class="op" id="6103010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6103013">type</span>&nbsp;<span class="ident" id="6103018">SectionHeader</span>&nbsp;<span class="keyword" id="6103032">struct</span>&nbsp;<span class="op" id="6103039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103042">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6103063">string</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103071">VirtualSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6103092">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103100">VirtualAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6103121">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103129">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6103150">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103158">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6103179">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103187">PointerToRelocations</span>&nbsp;<span class="builtintype" id="6103208">uint32</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103216">PointerToLineNumbers</span>&nbsp;<span class="builtintype" id="6103237">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103245">NumberOfRelocations</span>&nbsp;&nbsp;<span class="builtintype" id="6103266">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103274">NumberOfLineNumbers</span>&nbsp;&nbsp;<span class="builtintype" id="6103295">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103303">Characteristics</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6103324">uint32</span><br>
<span class="lineno"></span><span class="op" id="6103331">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="6103334">type</span>&nbsp;<span class="ident" id="6103339">Section</span>&nbsp;<span class="keyword" id="6103347">struct</span>&nbsp;<span class="op" id="6103354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103357">SectionHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6103373">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6103411">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6103451">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6103486">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6103534">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6103584">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103608">io</span><span class="op" id="6103610">.</span><span class="ident" id="6103611">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103621">sr</span>&nbsp;<span class="op" id="6103624">*</span><span class="ident" id="6103625">io</span><span class="op" id="6103627">.</span><span class="ident" id="6103628">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="6103642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6103645">type</span>&nbsp;<span class="ident" id="6103650">Symbol</span>&nbsp;<span class="keyword" id="6103657">struct</span>&nbsp;<span class="op" id="6103664">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103667">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6103681">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103689">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6103703">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103711">SectionNumber</span>&nbsp;<span class="builtintype" id="6103725">int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103732">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6103746">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103754">StorageClass</span>&nbsp;&nbsp;<span class="builtintype" id="6103768">uint8</span><br>
<span class="lineno">60</span><span class="op" id="6103774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6103777">type</span>&nbsp;<span class="ident" id="6103782">ImportDirectory</span>&nbsp;<span class="keyword" id="6103798">struct</span>&nbsp;<span class="op" id="6103805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103808">OriginalFirstThunk</span>&nbsp;<span class="builtintype" id="6103827">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103835">TimeDateStamp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6103854">uint32</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103862">ForwarderChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6103881">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103889">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6103908">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103916">FirstThunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6103935">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6103944">dll</span>&nbsp;<span class="builtintype" id="6103948">string</span><br>
<span class="lineno">70</span><span class="op" id="6103955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6103958">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6104016">func</span>&nbsp;<span class="op" id="6104021">(</span><span class="ident" id="6104022">s</span>&nbsp;<span class="op" id="6104024">*</span><span class="ident" id="6104025">Section</span><span class="op" id="6104032">)</span>&nbsp;<span class="ident" id="6104034">Data</span><span class="op" id="6104038">(</span><span class="op" id="6104039">)</span>&nbsp;<span class="op" id="6104041">(</span><span class="op" id="6104042">[</span><span class="op" id="6104043">]</span><span class="builtintype" id="6104044">byte</span><span class="op" id="6104048">,</span>&nbsp;<span class="builtintype" id="6104050">error</span><span class="op" id="6104055">)</span>&nbsp;<span class="op" id="6104057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6104060">dat</span>&nbsp;<span class="op" id="6104064">:=</span>&nbsp;<span class="builtinfunc" id="6104067">make</span><span class="op" id="6104071">(</span><span class="op" id="6104072">[</span><span class="op" id="6104073">]</span><span class="builtintype" id="6104074">byte</span><span class="op" id="6104078">,</span>&nbsp;<span class="ident" id="6104080">s</span><span class="op" id="6104081">.</span><span class="ident" id="6104082">sr</span><span class="op" id="6104084">.</span><span class="ident" id="6104085">Size</span><span class="op" id="6104089">(</span><span class="op" id="6104090">)</span><span class="op" id="6104091">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6104094">n</span><span class="op" id="6104095">,</span>&nbsp;<span class="ident" id="6104097">err</span>&nbsp;<span class="op" id="6104101">:=</span>&nbsp;<span class="ident" id="6104104">s</span><span class="op" id="6104105">.</span><span class="ident" id="6104106">sr</span><span class="op" id="6104108">.</span><span class="ident" id="6104109">ReadAt</span><span class="op" id="6104115">(</span><span class="ident" id="6104116">dat</span><span class="op" id="6104119">,</span>&nbsp;<span class="num" id="6104121">0</span><span class="op" id="6104122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6104125">if</span>&nbsp;<span class="ident" id="6104128">n</span>&nbsp;<span class="op" id="6104130">==</span>&nbsp;<span class="builtinfunc" id="6104133">len</span><span class="op" id="6104136">(</span><span class="ident" id="6104137">dat</span><span class="op" id="6104140">)</span>&nbsp;<span class="op" id="6104142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6104146">err</span>&nbsp;<span class="op" id="6104150">=</span>&nbsp;<span class="ident" id="6104152">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6104157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6104160">return</span>&nbsp;<span class="ident" id="6104167">dat</span><span class="op" id="6104170">[</span><span class="num" id="6104171">0</span><span class="op" id="6104172">:</span><span class="ident" id="6104173">n</span><span class="op" id="6104174">]</span><span class="op" id="6104175">,</span>&nbsp;<span class="ident" id="6104177">err</span><br>
<span class="lineno">80</span><span class="op" id="6104181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6104184">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6104241">func</span>&nbsp;<span class="op" id="6104246">(</span><span class="ident" id="6104247">s</span>&nbsp;<span class="op" id="6104249">*</span><span class="ident" id="6104250">Section</span><span class="op" id="6104257">)</span>&nbsp;<span class="ident" id="6104259">Open</span><span class="op" id="6104263">(</span><span class="op" id="6104264">)</span>&nbsp;<span class="ident" id="6104266">io</span><span class="op" id="6104268">.</span><span class="ident" id="6104269">ReadSeeker</span>&nbsp;<span class="op" id="6104280">{</span>&nbsp;<span class="keyword" id="6104282">return</span>&nbsp;<span class="ident" id="6104289">io</span><span class="op" id="6104291">.</span><span class="ident" id="6104292">NewSectionReader</span><span class="op" id="6104308">(</span><span class="ident" id="6104309">s</span><span class="op" id="6104310">.</span><span class="ident" id="6104311">sr</span><span class="op" id="6104313">,</span>&nbsp;<span class="num" id="6104315">0</span><span class="op" id="6104316">,</span>&nbsp;<span class="num" id="6104318">1</span><span class="op" id="6104319">&lt;&lt;</span><span class="num" id="6104321">63</span><span class="op" id="6104323">-</span><span class="num" id="6104324">1</span><span class="op" id="6104325">)</span>&nbsp;<span class="op" id="6104327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="6104330">type</span>&nbsp;<span class="ident" id="6104335">FormatError</span>&nbsp;<span class="keyword" id="6104347">struct</span>&nbsp;<span class="op" id="6104354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6104357">off</span>&nbsp;<span class="ident" id="6104361">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6104368">msg</span>&nbsp;<span class="builtintype" id="6104372">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6104380">val</span>&nbsp;<span class="keyword" id="6104384">interface</span><span class="op" id="6104393">{</span><span class="op" id="6104394">}</span><br>
<span class="lineno"></span><span class="op" id="6104396">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="6104399">func</span>&nbsp;<span class="op" id="6104404">(</span><span class="ident" id="6104405">e</span>&nbsp;<span class="op" id="6104407">*</span><span class="ident" id="6104408">FormatError</span><span class="op" id="6104419">)</span>&nbsp;<span class="ident" id="6104421">Error</span><span class="op" id="6104426">(</span><span class="op" id="6104427">)</span>&nbsp;<span class="builtintype" id="6104429">string</span>&nbsp;<span class="op" id="6104436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6104439">msg</span>&nbsp;<span class="op" id="6104443">:=</span>&nbsp;<span class="ident" id="6104446">e</span><span class="op" id="6104447">.</span><span class="ident" id="6104448">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6104453">if</span>&nbsp;<span class="ident" id="6104456">e</span><span class="op" id="6104457">.</span><span class="ident" id="6104458">val</span>&nbsp;<span class="op" id="6104462">!=</span>&nbsp;<span class="ident" id="6104465">nil</span>&nbsp;<span class="op" id="6104469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6104473">msg</span>&nbsp;<span class="op" id="6104477">+=</span>&nbsp;<span class="ident" id="6104480">fmt</span><span class="op" id="6104483">.</span><span class="ident" id="6104484">Sprintf</span><span class="op" id="6104491">(</span><span class="string" id="6104492">&#34;&nbsp;&#39;%v&#39;&#34;</span><span class="op" id="6104499">,</span>&nbsp;<span class="ident" id="6104501">e</span><span class="op" id="6104502">.</span><span class="ident" id="6104503">val</span><span class="op" id="6104506">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6104509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6104512">msg</span>&nbsp;<span class="op" id="6104516">+=</span>&nbsp;<span class="ident" id="6104519">fmt</span><span class="op" id="6104522">.</span><span class="ident" id="6104523">Sprintf</span><span class="op" id="6104530">(</span><span class="string" id="6104531">&#34;&nbsp;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="6104555">,</span>&nbsp;<span class="ident" id="6104557">e</span><span class="op" id="6104558">.</span><span class="ident" id="6104559">off</span><span class="op" id="6104562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6104565">return</span>&nbsp;<span class="ident" id="6104572">msg</span><br>
<span class="lineno"></span><span class="op" id="6104576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="6104579">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;a&nbsp;PE&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="6104662">func</span>&nbsp;<span class="ident" id="6104667">Open</span><span class="op" id="6104671">(</span><span class="ident" id="6104672">name</span>&nbsp;<span class="builtintype" id="6104677">string</span><span class="op" id="6104683">)</span>&nbsp;<span class="op" id="6104685">(</span><span class="op" id="6104686">*</span><span class="ident" id="6104687">File</span><span class="op" id="6104691">,</span>&nbsp;<span class="builtintype" id="6104693">error</span><span class="op" id="6104698">)</span>&nbsp;<span class="op" id="6104700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6104703">f</span><span class="op" id="6104704">,</span>&nbsp;<span class="ident" id="6104706">err</span>&nbsp;<span class="op" id="6104710">:=</span>&nbsp;<span class="ident" id="6104713">os</span><span class="op" id="6104715">.</span><span class="ident" id="6104716">Open</span><span class="op" id="6104720">(</span><span class="ident" id="6104721">name</span><span class="op" id="6104725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6104728">if</span>&nbsp;<span class="ident" id="6104731">err</span>&nbsp;<span class="op" id="6104735">!=</span>&nbsp;<span class="ident" id="6104738">nil</span>&nbsp;<span class="op" id="6104742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6104746">return</span>&nbsp;<span class="ident" id="6104753">nil</span><span class="op" id="6104756">,</span>&nbsp;<span class="ident" id="6104758">err</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6104763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6104766">ff</span><span class="op" id="6104768">,</span>&nbsp;<span class="ident" id="6104770">err</span>&nbsp;<span class="op" id="6104774">:=</span>&nbsp;<span class="ident" id="6104777">NewFile</span><span class="op" id="6104784">(</span><span class="ident" id="6104785">f</span><span class="op" id="6104786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6104789">if</span>&nbsp;<span class="ident" id="6104792">err</span>&nbsp;<span class="op" id="6104796">!=</span>&nbsp;<span class="ident" id="6104799">nil</span>&nbsp;<span class="op" id="6104803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6104807">f</span><span class="op" id="6104808">.</span><span class="ident" id="6104809">Close</span><span class="op" id="6104814">(</span><span class="op" id="6104815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6104819">return</span>&nbsp;<span class="ident" id="6104826">nil</span><span class="op" id="6104829">,</span>&nbsp;<span class="ident" id="6104831">err</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6104836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6104839">ff</span><span class="op" id="6104841">.</span><span class="ident" id="6104842">closer</span>&nbsp;<span class="op" id="6104849">=</span>&nbsp;<span class="ident" id="6104851">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6104854">return</span>&nbsp;<span class="ident" id="6104861">ff</span><span class="op" id="6104863">,</span>&nbsp;<span class="ident" id="6104865">nil</span><br>
<span class="lineno"></span><span class="op" id="6104869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="6104872">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="6104898">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno"></span><span class="comment" id="6104965">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="6104989">func</span>&nbsp;<span class="op" id="6104994">(</span><span class="ident" id="6104995">f</span>&nbsp;<span class="op" id="6104997">*</span><span class="ident" id="6104998">File</span><span class="op" id="6105002">)</span>&nbsp;<span class="ident" id="6105004">Close</span><span class="op" id="6105009">(</span><span class="op" id="6105010">)</span>&nbsp;<span class="builtintype" id="6105012">error</span>&nbsp;<span class="op" id="6105018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105021">var</span>&nbsp;<span class="ident" id="6105025">err</span>&nbsp;<span class="builtintype" id="6105029">error</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105036">if</span>&nbsp;<span class="ident" id="6105039">f</span><span class="op" id="6105040">.</span><span class="ident" id="6105041">closer</span>&nbsp;<span class="op" id="6105048">!=</span>&nbsp;<span class="ident" id="6105051">nil</span>&nbsp;<span class="op" id="6105055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6105059">err</span>&nbsp;<span class="op" id="6105063">=</span>&nbsp;<span class="ident" id="6105065">f</span><span class="op" id="6105066">.</span><span class="ident" id="6105067">closer</span><span class="op" id="6105073">.</span><span class="ident" id="6105074">Close</span><span class="op" id="6105079">(</span><span class="op" id="6105080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6105084">f</span><span class="op" id="6105085">.</span><span class="ident" id="6105086">closer</span>&nbsp;<span class="op" id="6105093">=</span>&nbsp;<span class="ident" id="6105095">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6105100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105103">return</span>&nbsp;<span class="ident" id="6105110">err</span><br>
<span class="lineno">125</span><span class="op" id="6105114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6105117">var</span>&nbsp;<span class="op" id="6105121">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6105124">sizeofOptionalHeader32</span>&nbsp;<span class="op" id="6105147">=</span>&nbsp;<span class="builtintype" id="6105149">uint16</span><span class="op" id="6105155">(</span><span class="ident" id="6105156">binary</span><span class="op" id="6105162">.</span><span class="ident" id="6105163">Size</span><span class="op" id="6105167">(</span><span class="ident" id="6105168">OptionalHeader32</span><span class="op" id="6105184">{</span><span class="op" id="6105185">}</span><span class="op" id="6105186">)</span><span class="op" id="6105187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6105190">sizeofOptionalHeader64</span>&nbsp;<span class="op" id="6105213">=</span>&nbsp;<span class="builtintype" id="6105215">uint16</span><span class="op" id="6105221">(</span><span class="ident" id="6105222">binary</span><span class="op" id="6105228">.</span><span class="ident" id="6105229">Size</span><span class="op" id="6105233">(</span><span class="ident" id="6105234">OptionalHeader64</span><span class="op" id="6105250">{</span><span class="op" id="6105251">}</span><span class="op" id="6105252">)</span><span class="op" id="6105253">)</span><br>
<span class="lineno">130</span><span class="op" id="6105255">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6105258">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;a&nbsp;PE&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="keyword" id="6105339">func</span>&nbsp;<span class="ident" id="6105344">NewFile</span><span class="op" id="6105351">(</span><span class="ident" id="6105352">r</span>&nbsp;<span class="ident" id="6105354">io</span><span class="op" id="6105356">.</span><span class="ident" id="6105357">ReaderAt</span><span class="op" id="6105365">)</span>&nbsp;<span class="op" id="6105367">(</span><span class="op" id="6105368">*</span><span class="ident" id="6105369">File</span><span class="op" id="6105373">,</span>&nbsp;<span class="builtintype" id="6105375">error</span><span class="op" id="6105380">)</span>&nbsp;<span class="op" id="6105382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6105385">f</span>&nbsp;<span class="op" id="6105387">:=</span>&nbsp;<span class="builtinfunc" id="6105390">new</span><span class="op" id="6105393">(</span><span class="ident" id="6105394">File</span><span class="op" id="6105398">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6105401">sr</span>&nbsp;<span class="op" id="6105404">:=</span>&nbsp;<span class="ident" id="6105407">io</span><span class="op" id="6105409">.</span><span class="ident" id="6105410">NewSectionReader</span><span class="op" id="6105426">(</span><span class="ident" id="6105427">r</span><span class="op" id="6105428">,</span>&nbsp;<span class="num" id="6105430">0</span><span class="op" id="6105431">,</span>&nbsp;<span class="num" id="6105433">1</span><span class="op" id="6105434">&lt;&lt;</span><span class="num" id="6105436">63</span><span class="op" id="6105438">-</span><span class="num" id="6105439">1</span><span class="op" id="6105440">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105444">var</span>&nbsp;<span class="ident" id="6105448">dosheader</span>&nbsp;<span class="op" id="6105458">[</span><span class="num" id="6105459">96</span><span class="op" id="6105461">]</span><span class="builtintype" id="6105462">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105468">if</span>&nbsp;<span class="ident" id="6105471">_</span><span class="op" id="6105472">,</span>&nbsp;<span class="ident" id="6105474">err</span>&nbsp;<span class="op" id="6105478">:=</span>&nbsp;<span class="ident" id="6105481">r</span><span class="op" id="6105482">.</span><span class="ident" id="6105483">ReadAt</span><span class="op" id="6105489">(</span><span class="ident" id="6105490">dosheader</span><span class="op" id="6105499">[</span><span class="num" id="6105500">0</span><span class="op" id="6105501">:</span><span class="op" id="6105502">]</span><span class="op" id="6105503">,</span>&nbsp;<span class="num" id="6105505">0</span><span class="op" id="6105506">)</span><span class="op" id="6105507">;</span>&nbsp;<span class="ident" id="6105509">err</span>&nbsp;<span class="op" id="6105513">!=</span>&nbsp;<span class="ident" id="6105516">nil</span>&nbsp;<span class="op" id="6105520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105524">return</span>&nbsp;<span class="ident" id="6105531">nil</span><span class="op" id="6105534">,</span>&nbsp;<span class="ident" id="6105536">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6105541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105544">var</span>&nbsp;<span class="ident" id="6105548">base</span>&nbsp;<span class="ident" id="6105553">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105560">if</span>&nbsp;<span class="ident" id="6105563">dosheader</span><span class="op" id="6105572">[</span><span class="num" id="6105573">0</span><span class="op" id="6105574">]</span>&nbsp;<span class="op" id="6105576">==</span>&nbsp;<span class="string" id="6105579">&#39;M&#39;</span>&nbsp;<span class="op" id="6105583">&amp;&amp;</span>&nbsp;<span class="ident" id="6105586">dosheader</span><span class="op" id="6105595">[</span><span class="num" id="6105596">1</span><span class="op" id="6105597">]</span>&nbsp;<span class="op" id="6105599">==</span>&nbsp;<span class="string" id="6105602">&#39;Z&#39;</span>&nbsp;<span class="op" id="6105606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6105610">signoff</span>&nbsp;<span class="op" id="6105618">:=</span>&nbsp;<span class="ident" id="6105621">int64</span><span class="op" id="6105626">(</span><span class="ident" id="6105627">binary</span><span class="op" id="6105633">.</span><span class="ident" id="6105634">LittleEndian</span><span class="op" id="6105646">.</span><span class="ident" id="6105647">Uint32</span><span class="op" id="6105653">(</span><span class="ident" id="6105654">dosheader</span><span class="op" id="6105663">[</span><span class="num" id="6105664">0x3c</span><span class="op" id="6105668">:</span><span class="op" id="6105669">]</span><span class="op" id="6105670">)</span><span class="op" id="6105671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105675">var</span>&nbsp;<span class="ident" id="6105679">sign</span>&nbsp;<span class="op" id="6105684">[</span><span class="num" id="6105685">4</span><span class="op" id="6105686">]</span><span class="builtintype" id="6105687">byte</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6105694">r</span><span class="op" id="6105695">.</span><span class="ident" id="6105696">ReadAt</span><span class="op" id="6105702">(</span><span class="ident" id="6105703">sign</span><span class="op" id="6105707">[</span><span class="op" id="6105708">:</span><span class="op" id="6105709">]</span><span class="op" id="6105710">,</span>&nbsp;<span class="ident" id="6105712">signoff</span><span class="op" id="6105719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105723">if</span>&nbsp;<span class="op" id="6105726">!</span><span class="op" id="6105727">(</span><span class="ident" id="6105728">sign</span><span class="op" id="6105732">[</span><span class="num" id="6105733">0</span><span class="op" id="6105734">]</span>&nbsp;<span class="op" id="6105736">==</span>&nbsp;<span class="string" id="6105739">&#39;P&#39;</span>&nbsp;<span class="op" id="6105743">&amp;&amp;</span>&nbsp;<span class="ident" id="6105746">sign</span><span class="op" id="6105750">[</span><span class="num" id="6105751">1</span><span class="op" id="6105752">]</span>&nbsp;<span class="op" id="6105754">==</span>&nbsp;<span class="string" id="6105757">&#39;E&#39;</span>&nbsp;<span class="op" id="6105761">&amp;&amp;</span>&nbsp;<span class="ident" id="6105764">sign</span><span class="op" id="6105768">[</span><span class="num" id="6105769">2</span><span class="op" id="6105770">]</span>&nbsp;<span class="op" id="6105772">==</span>&nbsp;<span class="num" id="6105775">0</span>&nbsp;<span class="op" id="6105777">&amp;&amp;</span>&nbsp;<span class="ident" id="6105780">sign</span><span class="op" id="6105784">[</span><span class="num" id="6105785">3</span><span class="op" id="6105786">]</span>&nbsp;<span class="op" id="6105788">==</span>&nbsp;<span class="num" id="6105791">0</span><span class="op" id="6105792">)</span>&nbsp;<span class="op" id="6105794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105799">return</span>&nbsp;<span class="ident" id="6105806">nil</span><span class="op" id="6105809">,</span>&nbsp;<span class="ident" id="6105811">errors</span><span class="op" id="6105817">.</span><span class="ident" id="6105818">New</span><span class="op" id="6105821">(</span><span class="string" id="6105822">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="6105847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6105851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6105855">base</span>&nbsp;<span class="op" id="6105860">=</span>&nbsp;<span class="ident" id="6105862">signoff</span>&nbsp;<span class="op" id="6105870">+</span>&nbsp;<span class="num" id="6105872">4</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6105875">}</span>&nbsp;<span class="keyword" id="6105877">else</span>&nbsp;<span class="op" id="6105882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6105886">base</span>&nbsp;<span class="op" id="6105891">=</span>&nbsp;<span class="ident" id="6105893">int64</span><span class="op" id="6105898">(</span><span class="num" id="6105899">0</span><span class="op" id="6105900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6105903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6105906">sr</span><span class="op" id="6105908">.</span><span class="ident" id="6105909">Seek</span><span class="op" id="6105913">(</span><span class="ident" id="6105914">base</span><span class="op" id="6105918">,</span>&nbsp;<span class="ident" id="6105920">os</span><span class="op" id="6105922">.</span><span class="ident" id="6105923">SEEK_SET</span><span class="op" id="6105931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6105934">if</span>&nbsp;<span class="ident" id="6105937">err</span>&nbsp;<span class="op" id="6105941">:=</span>&nbsp;<span class="ident" id="6105944">binary</span><span class="op" id="6105950">.</span><span class="ident" id="6105951">Read</span><span class="op" id="6105955">(</span><span class="ident" id="6105956">sr</span><span class="op" id="6105958">,</span>&nbsp;<span class="ident" id="6105960">binary</span><span class="op" id="6105966">.</span><span class="ident" id="6105967">LittleEndian</span><span class="op" id="6105979">,</span>&nbsp;<span class="op" id="6105981">&amp;</span><span class="ident" id="6105982">f</span><span class="op" id="6105983">.</span><span class="ident" id="6105984">FileHeader</span><span class="op" id="6105994">)</span><span class="op" id="6105995">;</span>&nbsp;<span class="ident" id="6105997">err</span>&nbsp;<span class="op" id="6106001">!=</span>&nbsp;<span class="ident" id="6106004">nil</span>&nbsp;<span class="op" id="6106008">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6106012">return</span>&nbsp;<span class="ident" id="6106019">nil</span><span class="op" id="6106022">,</span>&nbsp;<span class="ident" id="6106024">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6106029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6106032">if</span>&nbsp;<span class="ident" id="6106035">f</span><span class="op" id="6106036">.</span><span class="ident" id="6106037">FileHeader</span><span class="op" id="6106047">.</span><span class="ident" id="6106048">Machine</span>&nbsp;<span class="op" id="6106056">!=</span>&nbsp;<span class="ident" id="6106059">IMAGE_FILE_MACHINE_UNKNOWN</span>&nbsp;<span class="op" id="6106086">&amp;&amp;</span>&nbsp;<span class="ident" id="6106089">f</span><span class="op" id="6106090">.</span><span class="ident" id="6106091">FileHeader</span><span class="op" id="6106101">.</span><span class="ident" id="6106102">Machine</span>&nbsp;<span class="op" id="6106110">!=</span>&nbsp;<span class="ident" id="6106113">IMAGE_FILE_MACHINE_AMD64</span>&nbsp;<span class="op" id="6106138">&amp;&amp;</span>&nbsp;<span class="ident" id="6106141">f</span><span class="op" id="6106142">.</span><span class="ident" id="6106143">FileHeader</span><span class="op" id="6106153">.</span><span class="ident" id="6106154">Machine</span>&nbsp;<span class="op" id="6106162">!=</span>&nbsp;<span class="ident" id="6106165">IMAGE_FILE_MACHINE_I386</span>&nbsp;<span class="op" id="6106189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6106193">return</span>&nbsp;<span class="ident" id="6106200">nil</span><span class="op" id="6106203">,</span>&nbsp;<span class="ident" id="6106205">errors</span><span class="op" id="6106211">.</span><span class="ident" id="6106212">New</span><span class="op" id="6106215">(</span><span class="string" id="6106216">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="6106241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6106244">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6106248">var</span>&nbsp;<span class="ident" id="6106252">ss</span>&nbsp;<span class="op" id="6106255">[</span><span class="op" id="6106256">]</span><span class="builtintype" id="6106257">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6106263">if</span>&nbsp;<span class="ident" id="6106266">f</span><span class="op" id="6106267">.</span><span class="ident" id="6106268">FileHeader</span><span class="op" id="6106278">.</span><span class="ident" id="6106279">NumberOfSymbols</span>&nbsp;<span class="op" id="6106295">&gt;</span>&nbsp;<span class="num" id="6106297">0</span>&nbsp;<span class="op" id="6106299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6106303">//&nbsp;Get&nbsp;COFF&nbsp;string&nbsp;table,&nbsp;which&nbsp;is&nbsp;located&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6106385">sr</span><span class="op" id="6106387">.</span><span class="ident" id="6106388">Seek</span><span class="op" id="6106392">(</span><span class="ident" id="6106393">int64</span><span class="op" id="6106398">(</span><span class="ident" id="6106399">f</span><span class="op" id="6106400">.</span><span class="ident" id="6106401">FileHeader</span><span class="op" id="6106411">.</span><span class="ident" id="6106412">PointerToSymbolTable</span><span class="op" id="6106432">+</span><span class="ident" id="6106433">COFFSymbolSize</span><span class="op" id="6106447">*</span><span class="ident" id="6106448">f</span><span class="op" id="6106449">.</span><span class="ident" id="6106450">FileHeader</span><span class="op" id="6106460">.</span><span class="ident" id="6106461">NumberOfSymbols</span><span class="op" id="6106476">)</span><span class="op" id="6106477">,</span>&nbsp;<span class="ident" id="6106479">os</span><span class="op" id="6106481">.</span><span class="ident" id="6106482">SEEK_SET</span><span class="op" id="6106490">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6106494">var</span>&nbsp;<span class="ident" id="6106498">l</span>&nbsp;<span class="builtintype" id="6106500">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6106509">if</span>&nbsp;<span class="ident" id="6106512">err</span>&nbsp;<span class="op" id="6106516">:=</span>&nbsp;<span class="ident" id="6106519">binary</span><span class="op" id="6106525">.</span><span class="ident" id="6106526">Read</span><span class="op" id="6106530">(</span><span class="ident" id="6106531">sr</span><span class="op" id="6106533">,</span>&nbsp;<span class="ident" id="6106535">binary</span><span class="op" id="6106541">.</span><span class="ident" id="6106542">LittleEndian</span><span class="op" id="6106554">,</span>&nbsp;<span class="op" id="6106556">&amp;</span><span class="ident" id="6106557">l</span><span class="op" id="6106558">)</span><span class="op" id="6106559">;</span>&nbsp;<span class="ident" id="6106561">err</span>&nbsp;<span class="op" id="6106565">!=</span>&nbsp;<span class="ident" id="6106568">nil</span>&nbsp;<span class="op" id="6106572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6106577">return</span>&nbsp;<span class="ident" id="6106584">nil</span><span class="op" id="6106587">,</span>&nbsp;<span class="ident" id="6106589">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6106595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6106599">ss</span>&nbsp;<span class="op" id="6106602">=</span>&nbsp;<span class="builtinfunc" id="6106604">make</span><span class="op" id="6106608">(</span><span class="op" id="6106609">[</span><span class="op" id="6106610">]</span><span class="builtintype" id="6106611">byte</span><span class="op" id="6106615">,</span>&nbsp;<span class="ident" id="6106617">l</span><span class="op" id="6106618">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6106622">if</span>&nbsp;<span class="ident" id="6106625">_</span><span class="op" id="6106626">,</span>&nbsp;<span class="ident" id="6106628">err</span>&nbsp;<span class="op" id="6106632">:=</span>&nbsp;<span class="ident" id="6106635">r</span><span class="op" id="6106636">.</span><span class="ident" id="6106637">ReadAt</span><span class="op" id="6106643">(</span><span class="ident" id="6106644">ss</span><span class="op" id="6106646">,</span>&nbsp;<span class="ident" id="6106648">int64</span><span class="op" id="6106653">(</span><span class="ident" id="6106654">f</span><span class="op" id="6106655">.</span><span class="ident" id="6106656">FileHeader</span><span class="op" id="6106666">.</span><span class="ident" id="6106667">PointerToSymbolTable</span><span class="op" id="6106687">+</span><span class="ident" id="6106688">COFFSymbolSize</span><span class="op" id="6106702">*</span><span class="ident" id="6106703">f</span><span class="op" id="6106704">.</span><span class="ident" id="6106705">FileHeader</span><span class="op" id="6106715">.</span><span class="ident" id="6106716">NumberOfSymbols</span><span class="op" id="6106731">)</span><span class="op" id="6106732">)</span><span class="op" id="6106733">;</span>&nbsp;<span class="ident" id="6106735">err</span>&nbsp;<span class="op" id="6106739">!=</span>&nbsp;<span class="ident" id="6106742">nil</span>&nbsp;<span class="op" id="6106746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6106751">return</span>&nbsp;<span class="ident" id="6106758">nil</span><span class="op" id="6106761">,</span>&nbsp;<span class="ident" id="6106763">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6106769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6106774">//&nbsp;Process&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6106806">sr</span><span class="op" id="6106808">.</span><span class="ident" id="6106809">Seek</span><span class="op" id="6106813">(</span><span class="ident" id="6106814">int64</span><span class="op" id="6106819">(</span><span class="ident" id="6106820">f</span><span class="op" id="6106821">.</span><span class="ident" id="6106822">FileHeader</span><span class="op" id="6106832">.</span><span class="ident" id="6106833">PointerToSymbolTable</span><span class="op" id="6106853">)</span><span class="op" id="6106854">,</span>&nbsp;<span class="ident" id="6106856">os</span><span class="op" id="6106858">.</span><span class="ident" id="6106859">SEEK_SET</span><span class="op" id="6106867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6106871">aux</span>&nbsp;<span class="op" id="6106875">:=</span>&nbsp;<span class="builtintype" id="6106878">uint8</span><span class="op" id="6106883">(</span><span class="num" id="6106884">0</span><span class="op" id="6106885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6106889">for</span>&nbsp;<span class="ident" id="6106893">i</span>&nbsp;<span class="op" id="6106895">:=</span>&nbsp;<span class="num" id="6106898">0</span><span class="op" id="6106899">;</span>&nbsp;<span class="ident" id="6106901">i</span>&nbsp;<span class="op" id="6106903">&lt;</span>&nbsp;<span class="builtintype" id="6106905">int</span><span class="op" id="6106908">(</span><span class="ident" id="6106909">f</span><span class="op" id="6106910">.</span><span class="ident" id="6106911">FileHeader</span><span class="op" id="6106921">.</span><span class="ident" id="6106922">NumberOfSymbols</span><span class="op" id="6106937">)</span><span class="op" id="6106938">;</span>&nbsp;<span class="ident" id="6106940">i</span><span class="op" id="6106941">++</span>&nbsp;<span class="op" id="6106944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6106949">cs</span>&nbsp;<span class="op" id="6106952">:=</span>&nbsp;<span class="builtinfunc" id="6106955">new</span><span class="op" id="6106958">(</span><span class="ident" id="6106959">COFFSymbol</span><span class="op" id="6106969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6106974">if</span>&nbsp;<span class="ident" id="6106977">err</span>&nbsp;<span class="op" id="6106981">:=</span>&nbsp;<span class="ident" id="6106984">binary</span><span class="op" id="6106990">.</span><span class="ident" id="6106991">Read</span><span class="op" id="6106995">(</span><span class="ident" id="6106996">sr</span><span class="op" id="6106998">,</span>&nbsp;<span class="ident" id="6107000">binary</span><span class="op" id="6107006">.</span><span class="ident" id="6107007">LittleEndian</span><span class="op" id="6107019">,</span>&nbsp;<span class="ident" id="6107021">cs</span><span class="op" id="6107023">)</span><span class="op" id="6107024">;</span>&nbsp;<span class="ident" id="6107026">err</span>&nbsp;<span class="op" id="6107030">!=</span>&nbsp;<span class="ident" id="6107033">nil</span>&nbsp;<span class="op" id="6107037">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107043">return</span>&nbsp;<span class="ident" id="6107050">nil</span><span class="op" id="6107053">,</span>&nbsp;<span class="ident" id="6107055">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6107062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107067">if</span>&nbsp;<span class="ident" id="6107070">aux</span>&nbsp;<span class="op" id="6107074">&gt;</span>&nbsp;<span class="num" id="6107076">0</span>&nbsp;<span class="op" id="6107078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107084">aux</span><span class="op" id="6107087">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107094">continue</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6107106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107111">var</span>&nbsp;<span class="ident" id="6107115">name</span>&nbsp;<span class="builtintype" id="6107120">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107130">if</span>&nbsp;<span class="ident" id="6107133">cs</span><span class="op" id="6107135">.</span><span class="ident" id="6107136">Name</span><span class="op" id="6107140">[</span><span class="num" id="6107141">0</span><span class="op" id="6107142">]</span>&nbsp;<span class="op" id="6107144">==</span>&nbsp;<span class="num" id="6107147">0</span>&nbsp;<span class="op" id="6107149">&amp;&amp;</span>&nbsp;<span class="ident" id="6107152">cs</span><span class="op" id="6107154">.</span><span class="ident" id="6107155">Name</span><span class="op" id="6107159">[</span><span class="num" id="6107160">1</span><span class="op" id="6107161">]</span>&nbsp;<span class="op" id="6107163">==</span>&nbsp;<span class="num" id="6107166">0</span>&nbsp;<span class="op" id="6107168">&amp;&amp;</span>&nbsp;<span class="ident" id="6107171">cs</span><span class="op" id="6107173">.</span><span class="ident" id="6107174">Name</span><span class="op" id="6107178">[</span><span class="num" id="6107179">2</span><span class="op" id="6107180">]</span>&nbsp;<span class="op" id="6107182">==</span>&nbsp;<span class="num" id="6107185">0</span>&nbsp;<span class="op" id="6107187">&amp;&amp;</span>&nbsp;<span class="ident" id="6107190">cs</span><span class="op" id="6107192">.</span><span class="ident" id="6107193">Name</span><span class="op" id="6107197">[</span><span class="num" id="6107198">3</span><span class="op" id="6107199">]</span>&nbsp;<span class="op" id="6107201">==</span>&nbsp;<span class="num" id="6107204">0</span>&nbsp;<span class="op" id="6107206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107212">si</span>&nbsp;<span class="op" id="6107215">:=</span>&nbsp;<span class="builtintype" id="6107218">int</span><span class="op" id="6107221">(</span><span class="ident" id="6107222">binary</span><span class="op" id="6107228">.</span><span class="ident" id="6107229">LittleEndian</span><span class="op" id="6107241">.</span><span class="ident" id="6107242">Uint32</span><span class="op" id="6107248">(</span><span class="ident" id="6107249">cs</span><span class="op" id="6107251">.</span><span class="ident" id="6107252">Name</span><span class="op" id="6107256">[</span><span class="num" id="6107257">4</span><span class="op" id="6107258">:</span><span class="op" id="6107259">]</span><span class="op" id="6107260">)</span><span class="op" id="6107261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107267">name</span><span class="op" id="6107271">,</span>&nbsp;<span class="ident" id="6107273">_</span>&nbsp;<span class="op" id="6107275">=</span>&nbsp;<span class="ident" id="6107277">getString</span><span class="op" id="6107286">(</span><span class="ident" id="6107287">ss</span><span class="op" id="6107289">,</span>&nbsp;<span class="ident" id="6107291">si</span><span class="op" id="6107293">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6107298">}</span>&nbsp;<span class="keyword" id="6107300">else</span>&nbsp;<span class="op" id="6107305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107311">name</span>&nbsp;<span class="op" id="6107316">=</span>&nbsp;<span class="ident" id="6107318">cstring</span><span class="op" id="6107325">(</span><span class="ident" id="6107326">cs</span><span class="op" id="6107328">.</span><span class="ident" id="6107329">Name</span><span class="op" id="6107333">[</span><span class="op" id="6107334">:</span><span class="op" id="6107335">]</span><span class="op" id="6107336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6107341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107346">aux</span>&nbsp;<span class="op" id="6107350">=</span>&nbsp;<span class="ident" id="6107352">cs</span><span class="op" id="6107354">.</span><span class="ident" id="6107355">NumberOfAuxSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107377">s</span>&nbsp;<span class="op" id="6107379">:=</span>&nbsp;<span class="op" id="6107382">&amp;</span><span class="ident" id="6107383">Symbol</span><span class="op" id="6107389">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107395">Name</span><span class="op" id="6107399">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107410">name</span><span class="op" id="6107414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107420">Value</span><span class="op" id="6107425">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107435">cs</span><span class="op" id="6107437">.</span><span class="ident" id="6107438">Value</span><span class="op" id="6107443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107449">SectionNumber</span><span class="op" id="6107462">:</span>&nbsp;<span class="ident" id="6107464">cs</span><span class="op" id="6107466">.</span><span class="ident" id="6107467">SectionNumber</span><span class="op" id="6107480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107486">Type</span><span class="op" id="6107490">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6107501">cs</span><span class="op" id="6107503">.</span><span class="ident" id="6107504">Type</span><span class="op" id="6107508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107514">StorageClass</span><span class="op" id="6107526">:</span>&nbsp;&nbsp;<span class="ident" id="6107529">cs</span><span class="op" id="6107531">.</span><span class="ident" id="6107532">StorageClass</span><span class="op" id="6107544">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6107549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107554">f</span><span class="op" id="6107555">.</span><span class="ident" id="6107556">Symbols</span>&nbsp;<span class="op" id="6107564">=</span>&nbsp;<span class="builtinfunc" id="6107566">append</span><span class="op" id="6107572">(</span><span class="ident" id="6107573">f</span><span class="op" id="6107574">.</span><span class="ident" id="6107575">Symbols</span><span class="op" id="6107582">,</span>&nbsp;<span class="ident" id="6107584">s</span><span class="op" id="6107585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6107589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6107592">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6107596">//&nbsp;Read&nbsp;optional&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6107622">sr</span><span class="op" id="6107624">.</span><span class="ident" id="6107625">Seek</span><span class="op" id="6107629">(</span><span class="ident" id="6107630">base</span><span class="op" id="6107634">,</span>&nbsp;<span class="ident" id="6107636">os</span><span class="op" id="6107638">.</span><span class="ident" id="6107639">SEEK_SET</span><span class="op" id="6107647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107650">if</span>&nbsp;<span class="ident" id="6107653">err</span>&nbsp;<span class="op" id="6107657">:=</span>&nbsp;<span class="ident" id="6107660">binary</span><span class="op" id="6107666">.</span><span class="ident" id="6107667">Read</span><span class="op" id="6107671">(</span><span class="ident" id="6107672">sr</span><span class="op" id="6107674">,</span>&nbsp;<span class="ident" id="6107676">binary</span><span class="op" id="6107682">.</span><span class="ident" id="6107683">LittleEndian</span><span class="op" id="6107695">,</span>&nbsp;<span class="op" id="6107697">&amp;</span><span class="ident" id="6107698">f</span><span class="op" id="6107699">.</span><span class="ident" id="6107700">FileHeader</span><span class="op" id="6107710">)</span><span class="op" id="6107711">;</span>&nbsp;<span class="ident" id="6107713">err</span>&nbsp;<span class="op" id="6107717">!=</span>&nbsp;<span class="ident" id="6107720">nil</span>&nbsp;<span class="op" id="6107724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107728">return</span>&nbsp;<span class="ident" id="6107735">nil</span><span class="op" id="6107738">,</span>&nbsp;<span class="ident" id="6107740">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6107745">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107748">var</span>&nbsp;<span class="ident" id="6107752">oh32</span>&nbsp;<span class="ident" id="6107757">OptionalHeader32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107775">var</span>&nbsp;<span class="ident" id="6107779">oh64</span>&nbsp;<span class="ident" id="6107784">OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107802">switch</span>&nbsp;<span class="ident" id="6107809">f</span><span class="op" id="6107810">.</span><span class="ident" id="6107811">FileHeader</span><span class="op" id="6107821">.</span><span class="ident" id="6107822">SizeOfOptionalHeader</span>&nbsp;<span class="op" id="6107843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107846">case</span>&nbsp;<span class="ident" id="6107851">sizeofOptionalHeader32</span><span class="op" id="6107873">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107877">if</span>&nbsp;<span class="ident" id="6107880">err</span>&nbsp;<span class="op" id="6107884">:=</span>&nbsp;<span class="ident" id="6107887">binary</span><span class="op" id="6107893">.</span><span class="ident" id="6107894">Read</span><span class="op" id="6107898">(</span><span class="ident" id="6107899">sr</span><span class="op" id="6107901">,</span>&nbsp;<span class="ident" id="6107903">binary</span><span class="op" id="6107909">.</span><span class="ident" id="6107910">LittleEndian</span><span class="op" id="6107922">,</span>&nbsp;<span class="op" id="6107924">&amp;</span><span class="ident" id="6107925">oh32</span><span class="op" id="6107929">)</span><span class="op" id="6107930">;</span>&nbsp;<span class="ident" id="6107932">err</span>&nbsp;<span class="op" id="6107936">!=</span>&nbsp;<span class="ident" id="6107939">nil</span>&nbsp;<span class="op" id="6107943">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107948">return</span>&nbsp;<span class="ident" id="6107955">nil</span><span class="op" id="6107958">,</span>&nbsp;<span class="ident" id="6107960">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6107966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6107970">if</span>&nbsp;<span class="ident" id="6107973">oh32</span><span class="op" id="6107977">.</span><span class="ident" id="6107978">Magic</span>&nbsp;<span class="op" id="6107984">!=</span>&nbsp;<span class="num" id="6107987">0x10b</span>&nbsp;<span class="op" id="6107993">{</span>&nbsp;<span class="comment" id="6107995">//&nbsp;PE32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108006">return</span>&nbsp;<span class="ident" id="6108013">nil</span><span class="op" id="6108016">,</span>&nbsp;<span class="ident" id="6108018">fmt</span><span class="op" id="6108021">.</span><span class="ident" id="6108022">Errorf</span><span class="op" id="6108028">(</span><span class="string" id="6108029">&#34;pe32&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="6108080">,</span>&nbsp;<span class="ident" id="6108082">oh32</span><span class="op" id="6108086">.</span><span class="ident" id="6108087">Magic</span><span class="op" id="6108092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6108096">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108100">f</span><span class="op" id="6108101">.</span><span class="ident" id="6108102">OptionalHeader</span>&nbsp;<span class="op" id="6108117">=</span>&nbsp;<span class="op" id="6108119">&amp;</span><span class="ident" id="6108120">oh32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108126">case</span>&nbsp;<span class="ident" id="6108131">sizeofOptionalHeader64</span><span class="op" id="6108153">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108157">if</span>&nbsp;<span class="ident" id="6108160">err</span>&nbsp;<span class="op" id="6108164">:=</span>&nbsp;<span class="ident" id="6108167">binary</span><span class="op" id="6108173">.</span><span class="ident" id="6108174">Read</span><span class="op" id="6108178">(</span><span class="ident" id="6108179">sr</span><span class="op" id="6108181">,</span>&nbsp;<span class="ident" id="6108183">binary</span><span class="op" id="6108189">.</span><span class="ident" id="6108190">LittleEndian</span><span class="op" id="6108202">,</span>&nbsp;<span class="op" id="6108204">&amp;</span><span class="ident" id="6108205">oh64</span><span class="op" id="6108209">)</span><span class="op" id="6108210">;</span>&nbsp;<span class="ident" id="6108212">err</span>&nbsp;<span class="op" id="6108216">!=</span>&nbsp;<span class="ident" id="6108219">nil</span>&nbsp;<span class="op" id="6108223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108228">return</span>&nbsp;<span class="ident" id="6108235">nil</span><span class="op" id="6108238">,</span>&nbsp;<span class="ident" id="6108240">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6108246">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108250">if</span>&nbsp;<span class="ident" id="6108253">oh64</span><span class="op" id="6108257">.</span><span class="ident" id="6108258">Magic</span>&nbsp;<span class="op" id="6108264">!=</span>&nbsp;<span class="num" id="6108267">0x20b</span>&nbsp;<span class="op" id="6108273">{</span>&nbsp;<span class="comment" id="6108275">//&nbsp;PE32+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108287">return</span>&nbsp;<span class="ident" id="6108294">nil</span><span class="op" id="6108297">,</span>&nbsp;<span class="ident" id="6108299">fmt</span><span class="op" id="6108302">.</span><span class="ident" id="6108303">Errorf</span><span class="op" id="6108309">(</span><span class="string" id="6108310">&#34;pe32+&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="6108362">,</span>&nbsp;<span class="ident" id="6108364">oh64</span><span class="op" id="6108368">.</span><span class="ident" id="6108369">Magic</span><span class="op" id="6108374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6108378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108382">f</span><span class="op" id="6108383">.</span><span class="ident" id="6108384">OptionalHeader</span>&nbsp;<span class="op" id="6108399">=</span>&nbsp;<span class="op" id="6108401">&amp;</span><span class="ident" id="6108402">oh64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6108408">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6108412">//&nbsp;Process&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108434">f</span><span class="op" id="6108435">.</span><span class="ident" id="6108436">Sections</span>&nbsp;<span class="op" id="6108445">=</span>&nbsp;<span class="builtinfunc" id="6108447">make</span><span class="op" id="6108451">(</span><span class="op" id="6108452">[</span><span class="op" id="6108453">]</span><span class="op" id="6108454">*</span><span class="ident" id="6108455">Section</span><span class="op" id="6108462">,</span>&nbsp;<span class="ident" id="6108464">f</span><span class="op" id="6108465">.</span><span class="ident" id="6108466">FileHeader</span><span class="op" id="6108476">.</span><span class="ident" id="6108477">NumberOfSections</span><span class="op" id="6108493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108496">for</span>&nbsp;<span class="ident" id="6108500">i</span>&nbsp;<span class="op" id="6108502">:=</span>&nbsp;<span class="num" id="6108505">0</span><span class="op" id="6108506">;</span>&nbsp;<span class="ident" id="6108508">i</span>&nbsp;<span class="op" id="6108510">&lt;</span>&nbsp;<span class="builtintype" id="6108512">int</span><span class="op" id="6108515">(</span><span class="ident" id="6108516">f</span><span class="op" id="6108517">.</span><span class="ident" id="6108518">FileHeader</span><span class="op" id="6108528">.</span><span class="ident" id="6108529">NumberOfSections</span><span class="op" id="6108545">)</span><span class="op" id="6108546">;</span>&nbsp;<span class="ident" id="6108548">i</span><span class="op" id="6108549">++</span>&nbsp;<span class="op" id="6108552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108556">sh</span>&nbsp;<span class="op" id="6108559">:=</span>&nbsp;<span class="builtinfunc" id="6108562">new</span><span class="op" id="6108565">(</span><span class="ident" id="6108566">SectionHeader32</span><span class="op" id="6108581">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108585">if</span>&nbsp;<span class="ident" id="6108588">err</span>&nbsp;<span class="op" id="6108592">:=</span>&nbsp;<span class="ident" id="6108595">binary</span><span class="op" id="6108601">.</span><span class="ident" id="6108602">Read</span><span class="op" id="6108606">(</span><span class="ident" id="6108607">sr</span><span class="op" id="6108609">,</span>&nbsp;<span class="ident" id="6108611">binary</span><span class="op" id="6108617">.</span><span class="ident" id="6108618">LittleEndian</span><span class="op" id="6108630">,</span>&nbsp;<span class="ident" id="6108632">sh</span><span class="op" id="6108634">)</span><span class="op" id="6108635">;</span>&nbsp;<span class="ident" id="6108637">err</span>&nbsp;<span class="op" id="6108641">!=</span>&nbsp;<span class="ident" id="6108644">nil</span>&nbsp;<span class="op" id="6108648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108653">return</span>&nbsp;<span class="ident" id="6108660">nil</span><span class="op" id="6108663">,</span>&nbsp;<span class="ident" id="6108665">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6108671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108675">var</span>&nbsp;<span class="ident" id="6108679">name</span>&nbsp;<span class="builtintype" id="6108684">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6108693">if</span>&nbsp;<span class="ident" id="6108696">sh</span><span class="op" id="6108698">.</span><span class="ident" id="6108699">Name</span><span class="op" id="6108703">[</span><span class="num" id="6108704">0</span><span class="op" id="6108705">]</span>&nbsp;<span class="op" id="6108707">==</span>&nbsp;<span class="string" id="6108710">&#39;\x2F&#39;</span>&nbsp;<span class="op" id="6108717">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108722">si</span><span class="op" id="6108724">,</span>&nbsp;<span class="ident" id="6108726">_</span>&nbsp;<span class="op" id="6108728">:=</span>&nbsp;<span class="ident" id="6108731">strconv</span><span class="op" id="6108738">.</span><span class="ident" id="6108739">Atoi</span><span class="op" id="6108743">(</span><span class="ident" id="6108744">cstring</span><span class="op" id="6108751">(</span><span class="ident" id="6108752">sh</span><span class="op" id="6108754">.</span><span class="ident" id="6108755">Name</span><span class="op" id="6108759">[</span><span class="num" id="6108760">1</span><span class="op" id="6108761">:</span><span class="op" id="6108762">]</span><span class="op" id="6108763">)</span><span class="op" id="6108764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108769">name</span><span class="op" id="6108773">,</span>&nbsp;<span class="ident" id="6108775">_</span>&nbsp;<span class="op" id="6108777">=</span>&nbsp;<span class="ident" id="6108779">getString</span><span class="op" id="6108788">(</span><span class="ident" id="6108789">ss</span><span class="op" id="6108791">,</span>&nbsp;<span class="ident" id="6108793">si</span><span class="op" id="6108795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6108799">}</span>&nbsp;<span class="keyword" id="6108801">else</span>&nbsp;<span class="op" id="6108806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108811">name</span>&nbsp;<span class="op" id="6108816">=</span>&nbsp;<span class="ident" id="6108818">cstring</span><span class="op" id="6108825">(</span><span class="ident" id="6108826">sh</span><span class="op" id="6108828">.</span><span class="ident" id="6108829">Name</span><span class="op" id="6108833">[</span><span class="num" id="6108834">0</span><span class="op" id="6108835">:</span><span class="op" id="6108836">]</span><span class="op" id="6108837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6108841">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108845">s</span>&nbsp;<span class="op" id="6108847">:=</span>&nbsp;<span class="builtinfunc" id="6108850">new</span><span class="op" id="6108853">(</span><span class="ident" id="6108854">Section</span><span class="op" id="6108861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108865">s</span><span class="op" id="6108866">.</span><span class="ident" id="6108867">SectionHeader</span>&nbsp;<span class="op" id="6108881">=</span>&nbsp;<span class="ident" id="6108883">SectionHeader</span><span class="op" id="6108896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108901">Name</span><span class="op" id="6108905">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6108923">name</span><span class="op" id="6108927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108932">VirtualSize</span><span class="op" id="6108943">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6108954">sh</span><span class="op" id="6108956">.</span><span class="ident" id="6108957">VirtualSize</span><span class="op" id="6108968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6108973">VirtualAddress</span><span class="op" id="6108987">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6108995">sh</span><span class="op" id="6108997">.</span><span class="ident" id="6108998">VirtualAddress</span><span class="op" id="6109012">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109017">Size</span><span class="op" id="6109021">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6109039">sh</span><span class="op" id="6109041">.</span><span class="ident" id="6109042">SizeOfRawData</span><span class="op" id="6109055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109060">Offset</span><span class="op" id="6109066">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6109082">sh</span><span class="op" id="6109084">.</span><span class="ident" id="6109085">PointerToRawData</span><span class="op" id="6109101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109106">PointerToRelocations</span><span class="op" id="6109126">:</span>&nbsp;<span class="ident" id="6109128">sh</span><span class="op" id="6109130">.</span><span class="ident" id="6109131">PointerToRelocations</span><span class="op" id="6109151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109156">PointerToLineNumbers</span><span class="op" id="6109176">:</span>&nbsp;<span class="ident" id="6109178">sh</span><span class="op" id="6109180">.</span><span class="ident" id="6109181">PointerToLineNumbers</span><span class="op" id="6109201">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109206">NumberOfRelocations</span><span class="op" id="6109225">:</span>&nbsp;&nbsp;<span class="ident" id="6109228">sh</span><span class="op" id="6109230">.</span><span class="ident" id="6109231">NumberOfRelocations</span><span class="op" id="6109250">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109255">NumberOfLineNumbers</span><span class="op" id="6109274">:</span>&nbsp;&nbsp;<span class="ident" id="6109277">sh</span><span class="op" id="6109279">.</span><span class="ident" id="6109280">NumberOfLineNumbers</span><span class="op" id="6109299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109304">Characteristics</span><span class="op" id="6109319">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6109326">sh</span><span class="op" id="6109328">.</span><span class="ident" id="6109329">Characteristics</span><span class="op" id="6109344">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6109348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109352">s</span><span class="op" id="6109353">.</span><span class="ident" id="6109354">sr</span>&nbsp;<span class="op" id="6109357">=</span>&nbsp;<span class="ident" id="6109359">io</span><span class="op" id="6109361">.</span><span class="ident" id="6109362">NewSectionReader</span><span class="op" id="6109378">(</span><span class="ident" id="6109379">r</span><span class="op" id="6109380">,</span>&nbsp;<span class="ident" id="6109382">int64</span><span class="op" id="6109387">(</span><span class="ident" id="6109388">s</span><span class="op" id="6109389">.</span><span class="ident" id="6109390">SectionHeader</span><span class="op" id="6109403">.</span><span class="ident" id="6109404">Offset</span><span class="op" id="6109410">)</span><span class="op" id="6109411">,</span>&nbsp;<span class="ident" id="6109413">int64</span><span class="op" id="6109418">(</span><span class="ident" id="6109419">s</span><span class="op" id="6109420">.</span><span class="ident" id="6109421">SectionHeader</span><span class="op" id="6109434">.</span><span class="ident" id="6109435">Size</span><span class="op" id="6109439">)</span><span class="op" id="6109440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109444">s</span><span class="op" id="6109445">.</span><span class="ident" id="6109446">ReaderAt</span>&nbsp;<span class="op" id="6109455">=</span>&nbsp;<span class="ident" id="6109457">s</span><span class="op" id="6109458">.</span><span class="ident" id="6109459">sr</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6109464">f</span><span class="op" id="6109465">.</span><span class="ident" id="6109466">Sections</span><span class="op" id="6109474">[</span><span class="ident" id="6109475">i</span><span class="op" id="6109476">]</span>&nbsp;<span class="op" id="6109478">=</span>&nbsp;<span class="ident" id="6109480">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6109483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109486">return</span>&nbsp;<span class="ident" id="6109493">f</span><span class="op" id="6109494">,</span>&nbsp;<span class="ident" id="6109496">nil</span><br>
<span class="lineno"></span><span class="op" id="6109500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="6109503">func</span>&nbsp;<span class="ident" id="6109508">cstring</span><span class="op" id="6109515">(</span><span class="ident" id="6109516">b</span>&nbsp;<span class="op" id="6109518">[</span><span class="op" id="6109519">]</span><span class="builtintype" id="6109520">byte</span><span class="op" id="6109524">)</span>&nbsp;<span class="builtintype" id="6109526">string</span>&nbsp;<span class="op" id="6109533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109536">var</span>&nbsp;<span class="ident" id="6109540">i</span>&nbsp;<span class="builtintype" id="6109542">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109547">for</span>&nbsp;<span class="ident" id="6109551">i</span>&nbsp;<span class="op" id="6109553">=</span>&nbsp;<span class="num" id="6109555">0</span><span class="op" id="6109556">;</span>&nbsp;<span class="ident" id="6109558">i</span>&nbsp;<span class="op" id="6109560">&lt;</span>&nbsp;<span class="builtinfunc" id="6109562">len</span><span class="op" id="6109565">(</span><span class="ident" id="6109566">b</span><span class="op" id="6109567">)</span>&nbsp;<span class="op" id="6109569">&amp;&amp;</span>&nbsp;<span class="ident" id="6109572">b</span><span class="op" id="6109573">[</span><span class="ident" id="6109574">i</span><span class="op" id="6109575">]</span>&nbsp;<span class="op" id="6109577">!=</span>&nbsp;<span class="num" id="6109580">0</span><span class="op" id="6109581">;</span>&nbsp;<span class="ident" id="6109583">i</span><span class="op" id="6109584">++</span>&nbsp;<span class="op" id="6109587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6109590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109593">return</span>&nbsp;<span class="builtintype" id="6109600">string</span><span class="op" id="6109606">(</span><span class="ident" id="6109607">b</span><span class="op" id="6109608">[</span><span class="num" id="6109609">0</span><span class="op" id="6109610">:</span><span class="ident" id="6109611">i</span><span class="op" id="6109612">]</span><span class="op" id="6109613">)</span><br>
<span class="lineno">270</span><span class="op" id="6109615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6109618">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;symbol&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="6109675">func</span>&nbsp;<span class="ident" id="6109680">getString</span><span class="op" id="6109689">(</span><span class="ident" id="6109690">section</span>&nbsp;<span class="op" id="6109698">[</span><span class="op" id="6109699">]</span><span class="builtintype" id="6109700">byte</span><span class="op" id="6109704">,</span>&nbsp;<span class="ident" id="6109706">start</span>&nbsp;<span class="builtintype" id="6109712">int</span><span class="op" id="6109715">)</span>&nbsp;<span class="op" id="6109717">(</span><span class="builtintype" id="6109718">string</span><span class="op" id="6109724">,</span>&nbsp;<span class="builtintype" id="6109726">bool</span><span class="op" id="6109730">)</span>&nbsp;<span class="op" id="6109732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109735">if</span>&nbsp;<span class="ident" id="6109738">start</span>&nbsp;<span class="op" id="6109744">&lt;</span>&nbsp;<span class="num" id="6109746">0</span>&nbsp;<span class="op" id="6109748">||</span>&nbsp;<span class="ident" id="6109751">start</span>&nbsp;<span class="op" id="6109757">&gt;=</span>&nbsp;<span class="builtinfunc" id="6109760">len</span><span class="op" id="6109763">(</span><span class="ident" id="6109764">section</span><span class="op" id="6109771">)</span>&nbsp;<span class="op" id="6109773">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109777">return</span>&nbsp;<span class="string" id="6109784">&#34;&#34;</span><span class="op" id="6109786">,</span>&nbsp;<span class="builtintype" id="6109788">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6109795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109799">for</span>&nbsp;<span class="ident" id="6109803">end</span>&nbsp;<span class="op" id="6109807">:=</span>&nbsp;<span class="ident" id="6109810">start</span><span class="op" id="6109815">;</span>&nbsp;<span class="ident" id="6109817">end</span>&nbsp;<span class="op" id="6109821">&lt;</span>&nbsp;<span class="builtinfunc" id="6109823">len</span><span class="op" id="6109826">(</span><span class="ident" id="6109827">section</span><span class="op" id="6109834">)</span><span class="op" id="6109835">;</span>&nbsp;<span class="ident" id="6109837">end</span><span class="op" id="6109840">++</span>&nbsp;<span class="op" id="6109843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109847">if</span>&nbsp;<span class="ident" id="6109850">section</span><span class="op" id="6109857">[</span><span class="ident" id="6109858">end</span><span class="op" id="6109861">]</span>&nbsp;<span class="op" id="6109863">==</span>&nbsp;<span class="num" id="6109866">0</span>&nbsp;<span class="op" id="6109868">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109873">return</span>&nbsp;<span class="builtintype" id="6109880">string</span><span class="op" id="6109886">(</span><span class="ident" id="6109887">section</span><span class="op" id="6109894">[</span><span class="ident" id="6109895">start</span><span class="op" id="6109900">:</span><span class="ident" id="6109901">end</span><span class="op" id="6109904">]</span><span class="op" id="6109905">)</span><span class="op" id="6109906">,</span>&nbsp;<span class="builtintype" id="6109908">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6109915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6109918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6109921">return</span>&nbsp;<span class="string" id="6109928">&#34;&#34;</span><span class="op" id="6109930">,</span>&nbsp;<span class="builtintype" id="6109932">false</span><br>
<span class="lineno"></span><span class="op" id="6109938">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="6109941">//&nbsp;Section&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="6110017">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="6110036">func</span>&nbsp;<span class="op" id="6110041">(</span><span class="ident" id="6110042">f</span>&nbsp;<span class="op" id="6110044">*</span><span class="ident" id="6110045">File</span><span class="op" id="6110049">)</span>&nbsp;<span class="ident" id="6110051">Section</span><span class="op" id="6110058">(</span><span class="ident" id="6110059">name</span>&nbsp;<span class="builtintype" id="6110064">string</span><span class="op" id="6110070">)</span>&nbsp;<span class="op" id="6110072">*</span><span class="ident" id="6110073">Section</span>&nbsp;<span class="op" id="6110081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110084">for</span>&nbsp;<span class="ident" id="6110088">_</span><span class="op" id="6110089">,</span>&nbsp;<span class="ident" id="6110091">s</span>&nbsp;<span class="op" id="6110093">:=</span>&nbsp;<span class="keyword" id="6110096">range</span>&nbsp;<span class="ident" id="6110102">f</span><span class="op" id="6110103">.</span><span class="ident" id="6110104">Sections</span>&nbsp;<span class="op" id="6110113">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110117">if</span>&nbsp;<span class="ident" id="6110120">s</span><span class="op" id="6110121">.</span><span class="ident" id="6110122">Name</span>&nbsp;<span class="op" id="6110127">==</span>&nbsp;<span class="ident" id="6110130">name</span>&nbsp;<span class="op" id="6110135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110140">return</span>&nbsp;<span class="ident" id="6110147">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6110151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6110154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110157">return</span>&nbsp;<span class="ident" id="6110164">nil</span><br>
<span class="lineno">295</span><span class="op" id="6110168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6110171">func</span>&nbsp;<span class="op" id="6110176">(</span><span class="ident" id="6110177">f</span>&nbsp;<span class="op" id="6110179">*</span><span class="ident" id="6110180">File</span><span class="op" id="6110184">)</span>&nbsp;<span class="ident" id="6110186">DWARF</span><span class="op" id="6110191">(</span><span class="op" id="6110192">)</span>&nbsp;<span class="op" id="6110194">(</span><span class="op" id="6110195">*</span><span class="ident" id="6110196">dwarf</span><span class="op" id="6110201">.</span><span class="ident" id="6110202">Data</span><span class="op" id="6110206">,</span>&nbsp;<span class="builtintype" id="6110208">error</span><span class="op" id="6110213">)</span>&nbsp;<span class="op" id="6110215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6110218">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6110269">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6110324">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110383">var</span>&nbsp;<span class="ident" id="6110387">names</span>&nbsp;<span class="op" id="6110393">=</span>&nbsp;<span class="op" id="6110395">[</span><span class="op" id="6110396">...</span><span class="op" id="6110399">]</span><span class="builtintype" id="6110400">string</span><span class="op" id="6110406">{</span><span class="string" id="6110407">&#34;abbrev&#34;</span><span class="op" id="6110415">,</span>&nbsp;<span class="string" id="6110417">&#34;info&#34;</span><span class="op" id="6110423">,</span>&nbsp;<span class="string" id="6110425">&#34;str&#34;</span><span class="op" id="6110430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110433">var</span>&nbsp;<span class="ident" id="6110437">dat</span>&nbsp;<span class="op" id="6110441">[</span><span class="builtinfunc" id="6110442">len</span><span class="op" id="6110445">(</span><span class="ident" id="6110446">names</span><span class="op" id="6110451">)</span><span class="op" id="6110452">]</span><span class="op" id="6110453">[</span><span class="op" id="6110454">]</span><span class="builtintype" id="6110455">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110461">for</span>&nbsp;<span class="ident" id="6110465">i</span><span class="op" id="6110466">,</span>&nbsp;<span class="ident" id="6110468">name</span>&nbsp;<span class="op" id="6110473">:=</span>&nbsp;<span class="keyword" id="6110476">range</span>&nbsp;<span class="ident" id="6110482">names</span>&nbsp;<span class="op" id="6110488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110492">name</span>&nbsp;<span class="op" id="6110497">=</span>&nbsp;<span class="string" id="6110499">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="6110509">+</span>&nbsp;<span class="ident" id="6110511">name</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110518">s</span>&nbsp;<span class="op" id="6110520">:=</span>&nbsp;<span class="ident" id="6110523">f</span><span class="op" id="6110524">.</span><span class="ident" id="6110525">Section</span><span class="op" id="6110532">(</span><span class="ident" id="6110533">name</span><span class="op" id="6110537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110541">if</span>&nbsp;<span class="ident" id="6110544">s</span>&nbsp;<span class="op" id="6110546">==</span>&nbsp;<span class="ident" id="6110549">nil</span>&nbsp;<span class="op" id="6110553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110558">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6110569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110573">b</span><span class="op" id="6110574">,</span>&nbsp;<span class="ident" id="6110576">err</span>&nbsp;<span class="op" id="6110580">:=</span>&nbsp;<span class="ident" id="6110583">s</span><span class="op" id="6110584">.</span><span class="ident" id="6110585">Data</span><span class="op" id="6110589">(</span><span class="op" id="6110590">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110594">if</span>&nbsp;<span class="ident" id="6110597">err</span>&nbsp;<span class="op" id="6110601">!=</span>&nbsp;<span class="ident" id="6110604">nil</span>&nbsp;<span class="op" id="6110608">&amp;&amp;</span>&nbsp;<span class="builtintype" id="6110611">uint32</span><span class="op" id="6110617">(</span><span class="builtinfunc" id="6110618">len</span><span class="op" id="6110621">(</span><span class="ident" id="6110622">b</span><span class="op" id="6110623">)</span><span class="op" id="6110624">)</span>&nbsp;<span class="op" id="6110626">&lt;</span>&nbsp;<span class="ident" id="6110628">s</span><span class="op" id="6110629">.</span><span class="ident" id="6110630">Size</span>&nbsp;<span class="op" id="6110635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110640">return</span>&nbsp;<span class="ident" id="6110647">nil</span><span class="op" id="6110650">,</span>&nbsp;<span class="ident" id="6110652">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6110658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110662">dat</span><span class="op" id="6110665">[</span><span class="ident" id="6110666">i</span><span class="op" id="6110667">]</span>&nbsp;<span class="op" id="6110669">=</span>&nbsp;<span class="ident" id="6110671">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6110674">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6110678">abbrev</span><span class="op" id="6110684">,</span>&nbsp;<span class="ident" id="6110686">info</span><span class="op" id="6110690">,</span>&nbsp;<span class="ident" id="6110692">str</span>&nbsp;<span class="op" id="6110696">:=</span>&nbsp;<span class="ident" id="6110699">dat</span><span class="op" id="6110702">[</span><span class="num" id="6110703">0</span><span class="op" id="6110704">]</span><span class="op" id="6110705">,</span>&nbsp;<span class="ident" id="6110707">dat</span><span class="op" id="6110710">[</span><span class="num" id="6110711">1</span><span class="op" id="6110712">]</span><span class="op" id="6110713">,</span>&nbsp;<span class="ident" id="6110715">dat</span><span class="op" id="6110718">[</span><span class="num" id="6110719">2</span><span class="op" id="6110720">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6110723">return</span>&nbsp;<span class="ident" id="6110730">dwarf</span><span class="op" id="6110735">.</span><span class="ident" id="6110736">New</span><span class="op" id="6110739">(</span><span class="ident" id="6110740">abbrev</span><span class="op" id="6110746">,</span>&nbsp;<span class="ident" id="6110748">nil</span><span class="op" id="6110751">,</span>&nbsp;<span class="ident" id="6110753">nil</span><span class="op" id="6110756">,</span>&nbsp;<span class="ident" id="6110758">info</span><span class="op" id="6110762">,</span>&nbsp;<span class="ident" id="6110764">nil</span><span class="op" id="6110767">,</span>&nbsp;<span class="ident" id="6110769">nil</span><span class="op" id="6110772">,</span>&nbsp;<span class="ident" id="6110774">nil</span><span class="op" id="6110777">,</span>&nbsp;<span class="ident" id="6110779">str</span><span class="op" id="6110782">)</span><br>
<span class="lineno"></span><span class="op" id="6110784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="6110787">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="6110839">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="6110894">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="6110948">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="6110984">func</span>&nbsp;<span class="op" id="6110989">(</span><span class="ident" id="6110990">f</span>&nbsp;<span class="op" id="6110992">*</span><span class="ident" id="6110993">File</span><span class="op" id="6110997">)</span>&nbsp;<span class="ident" id="6110999">ImportedSymbols</span><span class="op" id="6111014">(</span><span class="op" id="6111015">)</span>&nbsp;<span class="op" id="6111017">(</span><span class="op" id="6111018">[</span><span class="op" id="6111019">]</span><span class="builtintype" id="6111020">string</span><span class="op" id="6111026">,</span>&nbsp;<span class="builtintype" id="6111028">error</span><span class="op" id="6111033">)</span>&nbsp;<span class="op" id="6111035">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111038">pe64</span>&nbsp;<span class="op" id="6111043">:=</span>&nbsp;<span class="ident" id="6111046">f</span><span class="op" id="6111047">.</span><span class="ident" id="6111048">Machine</span>&nbsp;<span class="op" id="6111056">==</span>&nbsp;<span class="ident" id="6111059">IMAGE_FILE_MACHINE_AMD64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111085">ds</span>&nbsp;<span class="op" id="6111088">:=</span>&nbsp;<span class="ident" id="6111091">f</span><span class="op" id="6111092">.</span><span class="ident" id="6111093">Section</span><span class="op" id="6111100">(</span><span class="string" id="6111101">&#34;.idata&#34;</span><span class="op" id="6111109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111112">if</span>&nbsp;<span class="ident" id="6111115">ds</span>&nbsp;<span class="op" id="6111118">==</span>&nbsp;<span class="ident" id="6111121">nil</span>&nbsp;<span class="op" id="6111125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6111129">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111163">return</span>&nbsp;<span class="ident" id="6111170">nil</span><span class="op" id="6111173">,</span>&nbsp;<span class="ident" id="6111175">nil</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6111180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111183">d</span><span class="op" id="6111184">,</span>&nbsp;<span class="ident" id="6111186">err</span>&nbsp;<span class="op" id="6111190">:=</span>&nbsp;<span class="ident" id="6111193">ds</span><span class="op" id="6111195">.</span><span class="ident" id="6111196">Data</span><span class="op" id="6111200">(</span><span class="op" id="6111201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111204">if</span>&nbsp;<span class="ident" id="6111207">err</span>&nbsp;<span class="op" id="6111211">!=</span>&nbsp;<span class="ident" id="6111214">nil</span>&nbsp;<span class="op" id="6111218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111222">return</span>&nbsp;<span class="ident" id="6111229">nil</span><span class="op" id="6111232">,</span>&nbsp;<span class="ident" id="6111234">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6111239">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111242">var</span>&nbsp;<span class="ident" id="6111246">ida</span>&nbsp;<span class="op" id="6111250">[</span><span class="op" id="6111251">]</span><span class="ident" id="6111252">ImportDirectory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111269">for</span>&nbsp;<span class="builtinfunc" id="6111273">len</span><span class="op" id="6111276">(</span><span class="ident" id="6111277">d</span><span class="op" id="6111278">)</span>&nbsp;<span class="op" id="6111280">&gt;</span>&nbsp;<span class="num" id="6111282">0</span>&nbsp;<span class="op" id="6111284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111288">var</span>&nbsp;<span class="ident" id="6111292">dt</span>&nbsp;<span class="ident" id="6111295">ImportDirectory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111313">dt</span><span class="op" id="6111315">.</span><span class="ident" id="6111316">OriginalFirstThunk</span>&nbsp;<span class="op" id="6111335">=</span>&nbsp;<span class="ident" id="6111337">binary</span><span class="op" id="6111343">.</span><span class="ident" id="6111344">LittleEndian</span><span class="op" id="6111356">.</span><span class="ident" id="6111357">Uint32</span><span class="op" id="6111363">(</span><span class="ident" id="6111364">d</span><span class="op" id="6111365">[</span><span class="num" id="6111366">0</span><span class="op" id="6111367">:</span><span class="num" id="6111368">4</span><span class="op" id="6111369">]</span><span class="op" id="6111370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111374">dt</span><span class="op" id="6111376">.</span><span class="ident" id="6111377">Name</span>&nbsp;<span class="op" id="6111382">=</span>&nbsp;<span class="ident" id="6111384">binary</span><span class="op" id="6111390">.</span><span class="ident" id="6111391">LittleEndian</span><span class="op" id="6111403">.</span><span class="ident" id="6111404">Uint32</span><span class="op" id="6111410">(</span><span class="ident" id="6111411">d</span><span class="op" id="6111412">[</span><span class="num" id="6111413">12</span><span class="op" id="6111415">:</span><span class="num" id="6111416">16</span><span class="op" id="6111418">]</span><span class="op" id="6111419">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111423">dt</span><span class="op" id="6111425">.</span><span class="ident" id="6111426">FirstThunk</span>&nbsp;<span class="op" id="6111437">=</span>&nbsp;<span class="ident" id="6111439">binary</span><span class="op" id="6111445">.</span><span class="ident" id="6111446">LittleEndian</span><span class="op" id="6111458">.</span><span class="ident" id="6111459">Uint32</span><span class="op" id="6111465">(</span><span class="ident" id="6111466">d</span><span class="op" id="6111467">[</span><span class="num" id="6111468">16</span><span class="op" id="6111470">:</span><span class="num" id="6111471">20</span><span class="op" id="6111473">]</span><span class="op" id="6111474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111478">d</span>&nbsp;<span class="op" id="6111480">=</span>&nbsp;<span class="ident" id="6111482">d</span><span class="op" id="6111483">[</span><span class="num" id="6111484">20</span><span class="op" id="6111486">:</span><span class="op" id="6111487">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111491">if</span>&nbsp;<span class="ident" id="6111494">dt</span><span class="op" id="6111496">.</span><span class="ident" id="6111497">OriginalFirstThunk</span>&nbsp;<span class="op" id="6111516">==</span>&nbsp;<span class="num" id="6111519">0</span>&nbsp;<span class="op" id="6111521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111526">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6111534">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111538">ida</span>&nbsp;<span class="op" id="6111542">=</span>&nbsp;<span class="builtinfunc" id="6111544">append</span><span class="op" id="6111550">(</span><span class="ident" id="6111551">ida</span><span class="op" id="6111554">,</span>&nbsp;<span class="ident" id="6111556">dt</span><span class="op" id="6111558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6111561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111564">names</span><span class="op" id="6111569">,</span>&nbsp;<span class="ident" id="6111571">_</span>&nbsp;<span class="op" id="6111573">:=</span>&nbsp;<span class="ident" id="6111576">ds</span><span class="op" id="6111578">.</span><span class="ident" id="6111579">Data</span><span class="op" id="6111583">(</span><span class="op" id="6111584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111587">var</span>&nbsp;<span class="ident" id="6111591">all</span>&nbsp;<span class="op" id="6111595">[</span><span class="op" id="6111596">]</span><span class="builtintype" id="6111597">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111605">for</span>&nbsp;<span class="ident" id="6111609">_</span><span class="op" id="6111610">,</span>&nbsp;<span class="ident" id="6111612">dt</span>&nbsp;<span class="op" id="6111615">:=</span>&nbsp;<span class="keyword" id="6111618">range</span>&nbsp;<span class="ident" id="6111624">ida</span>&nbsp;<span class="op" id="6111628">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111632">dt</span><span class="op" id="6111634">.</span><span class="ident" id="6111635">dll</span><span class="op" id="6111638">,</span>&nbsp;<span class="ident" id="6111640">_</span>&nbsp;<span class="op" id="6111642">=</span>&nbsp;<span class="ident" id="6111644">getString</span><span class="op" id="6111653">(</span><span class="ident" id="6111654">names</span><span class="op" id="6111659">,</span>&nbsp;<span class="builtintype" id="6111661">int</span><span class="op" id="6111664">(</span><span class="ident" id="6111665">dt</span><span class="op" id="6111667">.</span><span class="ident" id="6111668">Name</span><span class="op" id="6111672">-</span><span class="ident" id="6111673">ds</span><span class="op" id="6111675">.</span><span class="ident" id="6111676">VirtualAddress</span><span class="op" id="6111690">)</span><span class="op" id="6111691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111695">d</span><span class="op" id="6111696">,</span>&nbsp;<span class="ident" id="6111698">_</span>&nbsp;<span class="op" id="6111700">=</span>&nbsp;<span class="ident" id="6111702">ds</span><span class="op" id="6111704">.</span><span class="ident" id="6111705">Data</span><span class="op" id="6111709">(</span><span class="op" id="6111710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6111714">//&nbsp;seek&nbsp;to&nbsp;OriginalFirstThunk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111746">d</span>&nbsp;<span class="op" id="6111748">=</span>&nbsp;<span class="ident" id="6111750">d</span><span class="op" id="6111751">[</span><span class="ident" id="6111752">dt</span><span class="op" id="6111754">.</span><span class="ident" id="6111755">OriginalFirstThunk</span><span class="op" id="6111773">-</span><span class="ident" id="6111774">ds</span><span class="op" id="6111776">.</span><span class="ident" id="6111777">VirtualAddress</span><span class="op" id="6111791">:</span><span class="op" id="6111792">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111796">for</span>&nbsp;<span class="builtinfunc" id="6111800">len</span><span class="op" id="6111803">(</span><span class="ident" id="6111804">d</span><span class="op" id="6111805">)</span>&nbsp;<span class="op" id="6111807">&gt;</span>&nbsp;<span class="num" id="6111809">0</span>&nbsp;<span class="op" id="6111811">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111816">if</span>&nbsp;<span class="ident" id="6111819">pe64</span>&nbsp;<span class="op" id="6111824">{</span>&nbsp;<span class="comment" id="6111826">//&nbsp;64bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111839">va</span>&nbsp;<span class="op" id="6111842">:=</span>&nbsp;<span class="ident" id="6111845">binary</span><span class="op" id="6111851">.</span><span class="ident" id="6111852">LittleEndian</span><span class="op" id="6111864">.</span><span class="ident" id="6111865">Uint64</span><span class="op" id="6111871">(</span><span class="ident" id="6111872">d</span><span class="op" id="6111873">[</span><span class="num" id="6111874">0</span><span class="op" id="6111875">:</span><span class="num" id="6111876">8</span><span class="op" id="6111877">]</span><span class="op" id="6111878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6111884">d</span>&nbsp;<span class="op" id="6111886">=</span>&nbsp;<span class="ident" id="6111888">d</span><span class="op" id="6111889">[</span><span class="num" id="6111890">8</span><span class="op" id="6111891">:</span><span class="op" id="6111892">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111898">if</span>&nbsp;<span class="ident" id="6111901">va</span>&nbsp;<span class="op" id="6111904">==</span>&nbsp;<span class="num" id="6111907">0</span>&nbsp;<span class="op" id="6111909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111916">break</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6111926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6111932">if</span>&nbsp;<span class="ident" id="6111935">va</span><span class="op" id="6111937">&amp;</span><span class="num" id="6111938">0x8000000000000000</span>&nbsp;<span class="op" id="6111957">&gt;</span>&nbsp;<span class="num" id="6111959">0</span>&nbsp;<span class="op" id="6111961">{</span>&nbsp;<span class="comment" id="6111963">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6111982">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6112025">}</span>&nbsp;<span class="keyword" id="6112027">else</span>&nbsp;<span class="op" id="6112032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6112039">fn</span><span class="op" id="6112041">,</span>&nbsp;<span class="ident" id="6112043">_</span>&nbsp;<span class="op" id="6112045">:=</span>&nbsp;<span class="ident" id="6112048">getString</span><span class="op" id="6112057">(</span><span class="ident" id="6112058">names</span><span class="op" id="6112063">,</span>&nbsp;<span class="builtintype" id="6112065">int</span><span class="op" id="6112068">(</span><span class="builtintype" id="6112069">uint32</span><span class="op" id="6112075">(</span><span class="ident" id="6112076">va</span><span class="op" id="6112078">)</span><span class="op" id="6112079">-</span><span class="ident" id="6112080">ds</span><span class="op" id="6112082">.</span><span class="ident" id="6112083">VirtualAddress</span><span class="op" id="6112097">+</span><span class="num" id="6112098">2</span><span class="op" id="6112099">)</span><span class="op" id="6112100">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6112107">all</span>&nbsp;<span class="op" id="6112111">=</span>&nbsp;<span class="builtinfunc" id="6112113">append</span><span class="op" id="6112119">(</span><span class="ident" id="6112120">all</span><span class="op" id="6112123">,</span>&nbsp;<span class="ident" id="6112125">fn</span><span class="op" id="6112127">+</span><span class="string" id="6112128">&#34;:&#34;</span><span class="op" id="6112131">+</span><span class="ident" id="6112132">dt</span><span class="op" id="6112134">.</span><span class="ident" id="6112135">dll</span><span class="op" id="6112138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6112144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6112149">}</span>&nbsp;<span class="keyword" id="6112151">else</span>&nbsp;<span class="op" id="6112156">{</span>&nbsp;<span class="comment" id="6112158">//&nbsp;32bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6112171">va</span>&nbsp;<span class="op" id="6112174">:=</span>&nbsp;<span class="ident" id="6112177">binary</span><span class="op" id="6112183">.</span><span class="ident" id="6112184">LittleEndian</span><span class="op" id="6112196">.</span><span class="ident" id="6112197">Uint32</span><span class="op" id="6112203">(</span><span class="ident" id="6112204">d</span><span class="op" id="6112205">[</span><span class="num" id="6112206">0</span><span class="op" id="6112207">:</span><span class="num" id="6112208">4</span><span class="op" id="6112209">]</span><span class="op" id="6112210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6112216">d</span>&nbsp;<span class="op" id="6112218">=</span>&nbsp;<span class="ident" id="6112220">d</span><span class="op" id="6112221">[</span><span class="num" id="6112222">4</span><span class="op" id="6112223">:</span><span class="op" id="6112224">]</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6112230">if</span>&nbsp;<span class="ident" id="6112233">va</span>&nbsp;<span class="op" id="6112236">==</span>&nbsp;<span class="num" id="6112239">0</span>&nbsp;<span class="op" id="6112241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6112248">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6112258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6112264">if</span>&nbsp;<span class="ident" id="6112267">va</span><span class="op" id="6112269">&amp;</span><span class="num" id="6112270">0x80000000</span>&nbsp;<span class="op" id="6112281">&gt;</span>&nbsp;<span class="num" id="6112283">0</span>&nbsp;<span class="op" id="6112285">{</span>&nbsp;<span class="comment" id="6112287">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6112306">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6112350">//ord&nbsp;:=&nbsp;va&amp;0x0000FFFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6112377">}</span>&nbsp;<span class="keyword" id="6112379">else</span>&nbsp;<span class="op" id="6112384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6112391">fn</span><span class="op" id="6112393">,</span>&nbsp;<span class="ident" id="6112395">_</span>&nbsp;<span class="op" id="6112397">:=</span>&nbsp;<span class="ident" id="6112400">getString</span><span class="op" id="6112409">(</span><span class="ident" id="6112410">names</span><span class="op" id="6112415">,</span>&nbsp;<span class="builtintype" id="6112417">int</span><span class="op" id="6112420">(</span><span class="ident" id="6112421">va</span><span class="op" id="6112423">-</span><span class="ident" id="6112424">ds</span><span class="op" id="6112426">.</span><span class="ident" id="6112427">VirtualAddress</span><span class="op" id="6112441">+</span><span class="num" id="6112442">2</span><span class="op" id="6112443">)</span><span class="op" id="6112444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6112451">all</span>&nbsp;<span class="op" id="6112455">=</span>&nbsp;<span class="builtinfunc" id="6112457">append</span><span class="op" id="6112463">(</span><span class="ident" id="6112464">all</span><span class="op" id="6112467">,</span>&nbsp;<span class="ident" id="6112469">fn</span><span class="op" id="6112471">+</span><span class="string" id="6112472">&#34;:&#34;</span><span class="op" id="6112475">+</span><span class="ident" id="6112476">dt</span><span class="op" id="6112478">.</span><span class="ident" id="6112479">dll</span><span class="op" id="6112482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6112488">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6112493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6112497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6112500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6112504">return</span>&nbsp;<span class="ident" id="6112511">all</span><span class="op" id="6112514">,</span>&nbsp;<span class="ident" id="6112516">nil</span><br>
<span class="lineno">385</span><span class="op" id="6112520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6112523">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="6112579">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="6112634">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno">390</span><span class="keyword" id="6112682">func</span>&nbsp;<span class="op" id="6112687">(</span><span class="ident" id="6112688">f</span>&nbsp;<span class="op" id="6112690">*</span><span class="ident" id="6112691">File</span><span class="op" id="6112695">)</span>&nbsp;<span class="ident" id="6112697">ImportedLibraries</span><span class="op" id="6112714">(</span><span class="op" id="6112715">)</span>&nbsp;<span class="op" id="6112717">(</span><span class="op" id="6112718">[</span><span class="op" id="6112719">]</span><span class="builtintype" id="6112720">string</span><span class="op" id="6112726">,</span>&nbsp;<span class="builtintype" id="6112728">error</span><span class="op" id="6112733">)</span>&nbsp;<span class="op" id="6112735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6112738">//&nbsp;TODO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6112747">//&nbsp;cgo&nbsp;-dynimport&nbsp;don&#39;t&nbsp;use&nbsp;this&nbsp;for&nbsp;windows&nbsp;PE,&nbsp;so&nbsp;just&nbsp;return.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6112813">return</span>&nbsp;<span class="ident" id="6112820">nil</span><span class="op" id="6112823">,</span>&nbsp;<span class="ident" id="6112825">nil</span><br>
<span class="lineno"></span><span class="op" id="6112829">}</span>
</div>
</body>
</html>
