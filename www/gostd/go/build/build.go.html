<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/build</h2>
<ul>
<li><a href="/gostd/go/build/build.go.html">build.go</a></li>
<li><a href="/gostd/go/build/build_test.go.html">build_test.go</a></li>
<li><a href="/gostd/go/build/deps_test.go.html">deps_test.go</a></li>
<li><a href="/gostd/go/build/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/build/read.go.html">read.go</a></li>
<li><a href="/gostd/go/build/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/go/build/syslist.go.html">syslist.go</a></li>
<li><a href="/gostd/go/build/syslist_test.go.html">syslist_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6238037">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6238093">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6238147">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6238198">package</span>&nbsp;<span class="ident" id="6238206">build</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6238213">import</span>&nbsp;<span class="op" id="6238220">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6238223">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6238232">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6238242">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6238249">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6238259">&#34;go/doc&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6238269">&#34;go/parser&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6238282">&#34;go/token&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6238294">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6238300">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6238313">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6238320">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238326">pathpkg</span>&nbsp;<span class="string" id="6238334">&#34;path&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6238342">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6238359">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6238370">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6238378">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6238389">&#34;strings&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6238400">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6238411">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="6238426">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6238429">//&nbsp;A&nbsp;Context&nbsp;specifies&nbsp;the&nbsp;supporting&nbsp;context&nbsp;for&nbsp;a&nbsp;build.</span><br>
<span class="lineno">30</span><span class="keyword" id="6238488">type</span>&nbsp;<span class="ident" id="6238493">Context</span>&nbsp;<span class="keyword" id="6238501">struct</span>&nbsp;<span class="op" id="6238508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238511">GOARCH</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6238523">string</span>&nbsp;<span class="comment" id="6238530">//&nbsp;target&nbsp;architecture</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238554">GOOS</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6238566">string</span>&nbsp;<span class="comment" id="6238573">//&nbsp;target&nbsp;operating&nbsp;system</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238601">GOROOT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6238613">string</span>&nbsp;<span class="comment" id="6238620">//&nbsp;Go&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238632">GOPATH</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6238644">string</span>&nbsp;<span class="comment" id="6238651">//&nbsp;Go&nbsp;path</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238663">CgoEnabled</span>&nbsp;&nbsp;<span class="builtintype" id="6238675">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6238682">//&nbsp;whether&nbsp;cgo&nbsp;can&nbsp;be&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238710">UseAllFiles</span>&nbsp;<span class="builtintype" id="6238722">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6238729">//&nbsp;use&nbsp;files&nbsp;regardless&nbsp;of&nbsp;+build&nbsp;lines,&nbsp;file&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238782">Compiler</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6238794">string</span>&nbsp;<span class="comment" id="6238801">//&nbsp;compiler&nbsp;to&nbsp;assume&nbsp;when&nbsp;computing&nbsp;target&nbsp;paths</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6238853">//&nbsp;The&nbsp;build&nbsp;and&nbsp;release&nbsp;tags&nbsp;specify&nbsp;build&nbsp;constraints</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6238910">//&nbsp;that&nbsp;should&nbsp;be&nbsp;considered&nbsp;satisfied&nbsp;when&nbsp;processing&nbsp;+build&nbsp;lines.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6238980">//&nbsp;Clients&nbsp;creating&nbsp;a&nbsp;new&nbsp;context&nbsp;may&nbsp;customize&nbsp;BuildTags,&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6239046">//&nbsp;defaults&nbsp;to&nbsp;empty,&nbsp;but&nbsp;it&nbsp;is&nbsp;usually&nbsp;an&nbsp;error&nbsp;to&nbsp;customize&nbsp;ReleaseTags,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6239122">//&nbsp;which&nbsp;defaults&nbsp;to&nbsp;the&nbsp;list&nbsp;of&nbsp;Go&nbsp;releases&nbsp;the&nbsp;current&nbsp;release&nbsp;is&nbsp;compatible&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6239208">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;BuildTags&nbsp;and&nbsp;ReleaseTags,&nbsp;build&nbsp;constraints</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6239276">//&nbsp;consider&nbsp;the&nbsp;values&nbsp;of&nbsp;GOARCH&nbsp;and&nbsp;GOOS&nbsp;as&nbsp;satisfied&nbsp;tags.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6239338">BuildTags</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6239350">[</span><span class="op" id="6239351">]</span><span class="builtintype" id="6239352">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6239360">ReleaseTags</span>&nbsp;<span class="op" id="6239372">[</span><span class="op" id="6239373">]</span><span class="builtintype" id="6239374">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6239383">//&nbsp;The&nbsp;install&nbsp;suffix&nbsp;specifies&nbsp;a&nbsp;suffix&nbsp;to&nbsp;use&nbsp;in&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;installation</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6239464">//&nbsp;directory.&nbsp;By&nbsp;default&nbsp;it&nbsp;is&nbsp;empty,&nbsp;but&nbsp;custom&nbsp;builds&nbsp;that&nbsp;need&nbsp;to&nbsp;keep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6239539">//&nbsp;their&nbsp;outputs&nbsp;separate&nbsp;can&nbsp;set&nbsp;InstallSuffix&nbsp;to&nbsp;do&nbsp;so.&nbsp;For&nbsp;example,&nbsp;when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6239616">//&nbsp;using&nbsp;the&nbsp;race&nbsp;detector,&nbsp;the&nbsp;go&nbsp;command&nbsp;uses&nbsp;InstallSuffix&nbsp;=&nbsp;&#34;race&#34;,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6239692">//&nbsp;that&nbsp;on&nbsp;a&nbsp;Linux/386&nbsp;system,&nbsp;packages&nbsp;are&nbsp;written&nbsp;to&nbsp;a&nbsp;directory&nbsp;named</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6239766">//&nbsp;&#34;linux_386_race&#34;&nbsp;instead&nbsp;of&nbsp;the&nbsp;usual&nbsp;&#34;linux_386&#34;.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6239821">InstallSuffix</span>&nbsp;<span class="builtintype" id="6239835">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6239844">//&nbsp;By&nbsp;default,&nbsp;Import&nbsp;uses&nbsp;the&nbsp;operating&nbsp;system&#39;s&nbsp;file&nbsp;system&nbsp;calls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6239913">//&nbsp;to&nbsp;read&nbsp;directories&nbsp;and&nbsp;files.&nbsp;&nbsp;To&nbsp;read&nbsp;from&nbsp;other&nbsp;sources,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6239977">//&nbsp;callers&nbsp;can&nbsp;set&nbsp;the&nbsp;following&nbsp;functions.&nbsp;&nbsp;They&nbsp;all&nbsp;have&nbsp;default</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6240045">//&nbsp;behaviors&nbsp;that&nbsp;use&nbsp;the&nbsp;local&nbsp;file&nbsp;system,&nbsp;so&nbsp;clients&nbsp;need&nbsp;only&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6240116">//&nbsp;the&nbsp;functions&nbsp;whose&nbsp;behaviors&nbsp;they&nbsp;wish&nbsp;to&nbsp;change.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6240172">//&nbsp;JoinPath&nbsp;joins&nbsp;the&nbsp;sequence&nbsp;of&nbsp;path&nbsp;fragments&nbsp;into&nbsp;a&nbsp;single&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6240242">//&nbsp;If&nbsp;JoinPath&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.Join.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240293">JoinPath</span>&nbsp;<span class="keyword" id="6240302">func</span><span class="op" id="6240306">(</span><span class="ident" id="6240307">elem</span>&nbsp;<span class="op" id="6240312">...</span><span class="builtintype" id="6240315">string</span><span class="op" id="6240321">)</span>&nbsp;<span class="builtintype" id="6240323">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6240332">//&nbsp;SplitPathList&nbsp;splits&nbsp;the&nbsp;path&nbsp;list&nbsp;into&nbsp;a&nbsp;slice&nbsp;of&nbsp;individual&nbsp;paths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6240405">//&nbsp;If&nbsp;SplitPathList&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.SplitList.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240466">SplitPathList</span>&nbsp;<span class="keyword" id="6240480">func</span><span class="op" id="6240484">(</span><span class="ident" id="6240485">list</span>&nbsp;<span class="builtintype" id="6240490">string</span><span class="op" id="6240496">)</span>&nbsp;<span class="op" id="6240498">[</span><span class="op" id="6240499">]</span><span class="builtintype" id="6240500">string</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6240509">//&nbsp;IsAbsPath&nbsp;reports&nbsp;whether&nbsp;path&nbsp;is&nbsp;an&nbsp;absolute&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6240565">//&nbsp;If&nbsp;IsAbsPath&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.IsAbs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240618">IsAbsPath</span>&nbsp;<span class="keyword" id="6240628">func</span><span class="op" id="6240632">(</span><span class="ident" id="6240633">path</span>&nbsp;<span class="builtintype" id="6240638">string</span><span class="op" id="6240644">)</span>&nbsp;<span class="builtintype" id="6240646">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6240653">//&nbsp;IsDir&nbsp;reports&nbsp;whether&nbsp;the&nbsp;path&nbsp;names&nbsp;a&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6240707">//&nbsp;If&nbsp;IsDir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;calls&nbsp;os.Stat&nbsp;and&nbsp;uses&nbsp;the&nbsp;result&#39;s&nbsp;IsDir&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240785">IsDir</span>&nbsp;<span class="keyword" id="6240791">func</span><span class="op" id="6240795">(</span><span class="ident" id="6240796">path</span>&nbsp;<span class="builtintype" id="6240801">string</span><span class="op" id="6240807">)</span>&nbsp;<span class="builtintype" id="6240809">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6240816">//&nbsp;HasSubdir&nbsp;reports&nbsp;whether&nbsp;dir&nbsp;is&nbsp;a&nbsp;subdirectory&nbsp;of</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6240871">//&nbsp;(perhaps&nbsp;multiple&nbsp;levels&nbsp;below)&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6240913">//&nbsp;If&nbsp;so,&nbsp;HasSubdir&nbsp;sets&nbsp;rel&nbsp;to&nbsp;a&nbsp;slash-separated&nbsp;path&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6240974">//&nbsp;can&nbsp;be&nbsp;joined&nbsp;to&nbsp;root&nbsp;to&nbsp;produce&nbsp;a&nbsp;path&nbsp;equivalent&nbsp;to&nbsp;dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6241037">//&nbsp;If&nbsp;HasSubdir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;an&nbsp;implementation&nbsp;built&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6241101">//&nbsp;filepath.EvalSymlinks.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241128">HasSubdir</span>&nbsp;<span class="keyword" id="6241138">func</span><span class="op" id="6241142">(</span><span class="ident" id="6241143">root</span><span class="op" id="6241147">,</span>&nbsp;<span class="ident" id="6241149">dir</span>&nbsp;<span class="builtintype" id="6241153">string</span><span class="op" id="6241159">)</span>&nbsp;<span class="op" id="6241161">(</span><span class="ident" id="6241162">rel</span>&nbsp;<span class="builtintype" id="6241166">string</span><span class="op" id="6241172">,</span>&nbsp;<span class="ident" id="6241174">ok</span>&nbsp;<span class="builtintype" id="6241177">bool</span><span class="op" id="6241181">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6241185">//&nbsp;ReadDir&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;os.FileInfo,&nbsp;sorted&nbsp;by&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6241245">//&nbsp;describing&nbsp;the&nbsp;content&nbsp;of&nbsp;the&nbsp;named&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6241296">//&nbsp;If&nbsp;ReadDir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;ioutil.ReadDir.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241347">ReadDir</span>&nbsp;<span class="keyword" id="6241355">func</span><span class="op" id="6241359">(</span><span class="ident" id="6241360">dir</span>&nbsp;<span class="builtintype" id="6241364">string</span><span class="op" id="6241370">)</span>&nbsp;<span class="op" id="6241372">(</span><span class="ident" id="6241373">fi</span>&nbsp;<span class="op" id="6241376">[</span><span class="op" id="6241377">]</span><span class="ident" id="6241378">os</span><span class="op" id="6241380">.</span><span class="ident" id="6241381">FileInfo</span><span class="op" id="6241389">,</span>&nbsp;<span class="ident" id="6241391">err</span>&nbsp;<span class="builtintype" id="6241395">error</span><span class="op" id="6241400">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6241404">//&nbsp;OpenFile&nbsp;opens&nbsp;a&nbsp;file&nbsp;(not&nbsp;a&nbsp;directory)&nbsp;for&nbsp;reading.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6241461">//&nbsp;If&nbsp;OpenFile&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;os.Open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241506">OpenFile</span>&nbsp;<span class="keyword" id="6241515">func</span><span class="op" id="6241519">(</span><span class="ident" id="6241520">path</span>&nbsp;<span class="builtintype" id="6241525">string</span><span class="op" id="6241531">)</span>&nbsp;<span class="op" id="6241533">(</span><span class="ident" id="6241534">r</span>&nbsp;<span class="ident" id="6241536">io</span><span class="op" id="6241538">.</span><span class="ident" id="6241539">ReadCloser</span><span class="op" id="6241549">,</span>&nbsp;<span class="ident" id="6241551">err</span>&nbsp;<span class="builtintype" id="6241555">error</span><span class="op" id="6241560">)</span><br>
<span class="lineno">95</span><span class="op" id="6241562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6241565">//&nbsp;joinPath&nbsp;calls&nbsp;ctxt.JoinPath&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.Join.</span><br>
<span class="lineno"></span><span class="keyword" id="6241633">func</span>&nbsp;<span class="op" id="6241638">(</span><span class="ident" id="6241639">ctxt</span>&nbsp;<span class="op" id="6241644">*</span><span class="ident" id="6241645">Context</span><span class="op" id="6241652">)</span>&nbsp;<span class="ident" id="6241654">joinPath</span><span class="op" id="6241662">(</span><span class="ident" id="6241663">elem</span>&nbsp;<span class="op" id="6241668">...</span><span class="builtintype" id="6241671">string</span><span class="op" id="6241677">)</span>&nbsp;<span class="builtintype" id="6241679">string</span>&nbsp;<span class="op" id="6241686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241689">if</span>&nbsp;<span class="ident" id="6241692">f</span>&nbsp;<span class="op" id="6241694">:=</span>&nbsp;<span class="ident" id="6241697">ctxt</span><span class="op" id="6241701">.</span><span class="ident" id="6241702">JoinPath</span><span class="op" id="6241710">;</span>&nbsp;<span class="ident" id="6241712">f</span>&nbsp;<span class="op" id="6241714">!=</span>&nbsp;<span class="ident" id="6241717">nil</span>&nbsp;<span class="op" id="6241721">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241725">return</span>&nbsp;<span class="ident" id="6241732">f</span><span class="op" id="6241733">(</span><span class="ident" id="6241734">elem</span><span class="op" id="6241738">...</span><span class="op" id="6241741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6241744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241747">return</span>&nbsp;<span class="ident" id="6241754">filepath</span><span class="op" id="6241762">.</span><span class="ident" id="6241763">Join</span><span class="op" id="6241767">(</span><span class="ident" id="6241768">elem</span><span class="op" id="6241772">...</span><span class="op" id="6241775">)</span><br>
<span class="lineno"></span><span class="op" id="6241777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="6241780">//&nbsp;splitPathList&nbsp;calls&nbsp;ctxt.SplitPathList&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.SplitList.</span><br>
<span class="lineno"></span><span class="keyword" id="6241863">func</span>&nbsp;<span class="op" id="6241868">(</span><span class="ident" id="6241869">ctxt</span>&nbsp;<span class="op" id="6241874">*</span><span class="ident" id="6241875">Context</span><span class="op" id="6241882">)</span>&nbsp;<span class="ident" id="6241884">splitPathList</span><span class="op" id="6241897">(</span><span class="ident" id="6241898">s</span>&nbsp;<span class="builtintype" id="6241900">string</span><span class="op" id="6241906">)</span>&nbsp;<span class="op" id="6241908">[</span><span class="op" id="6241909">]</span><span class="builtintype" id="6241910">string</span>&nbsp;<span class="op" id="6241917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241920">if</span>&nbsp;<span class="ident" id="6241923">f</span>&nbsp;<span class="op" id="6241925">:=</span>&nbsp;<span class="ident" id="6241928">ctxt</span><span class="op" id="6241932">.</span><span class="ident" id="6241933">SplitPathList</span><span class="op" id="6241946">;</span>&nbsp;<span class="ident" id="6241948">f</span>&nbsp;<span class="op" id="6241950">!=</span>&nbsp;<span class="ident" id="6241953">nil</span>&nbsp;<span class="op" id="6241957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241961">return</span>&nbsp;<span class="ident" id="6241968">f</span><span class="op" id="6241969">(</span><span class="ident" id="6241970">s</span><span class="op" id="6241971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6241974">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241977">return</span>&nbsp;<span class="ident" id="6241984">filepath</span><span class="op" id="6241992">.</span><span class="ident" id="6241993">SplitList</span><span class="op" id="6242002">(</span><span class="ident" id="6242003">s</span><span class="op" id="6242004">)</span><br>
<span class="lineno"></span><span class="op" id="6242006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6242009">//&nbsp;isAbsPath&nbsp;calls&nbsp;ctxt.IsAbsSPath&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.IsAbs.</span><br>
<span class="lineno"></span><span class="keyword" id="6242081">func</span>&nbsp;<span class="op" id="6242086">(</span><span class="ident" id="6242087">ctxt</span>&nbsp;<span class="op" id="6242092">*</span><span class="ident" id="6242093">Context</span><span class="op" id="6242100">)</span>&nbsp;<span class="ident" id="6242102">isAbsPath</span><span class="op" id="6242111">(</span><span class="ident" id="6242112">path</span>&nbsp;<span class="builtintype" id="6242117">string</span><span class="op" id="6242123">)</span>&nbsp;<span class="builtintype" id="6242125">bool</span>&nbsp;<span class="op" id="6242130">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242133">if</span>&nbsp;<span class="ident" id="6242136">f</span>&nbsp;<span class="op" id="6242138">:=</span>&nbsp;<span class="ident" id="6242141">ctxt</span><span class="op" id="6242145">.</span><span class="ident" id="6242146">IsAbsPath</span><span class="op" id="6242155">;</span>&nbsp;<span class="ident" id="6242157">f</span>&nbsp;<span class="op" id="6242159">!=</span>&nbsp;<span class="ident" id="6242162">nil</span>&nbsp;<span class="op" id="6242166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242170">return</span>&nbsp;<span class="ident" id="6242177">f</span><span class="op" id="6242178">(</span><span class="ident" id="6242179">path</span><span class="op" id="6242183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6242186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242189">return</span>&nbsp;<span class="ident" id="6242196">filepath</span><span class="op" id="6242204">.</span><span class="ident" id="6242205">IsAbs</span><span class="op" id="6242210">(</span><span class="ident" id="6242211">path</span><span class="op" id="6242215">)</span><br>
<span class="lineno"></span><span class="op" id="6242217">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="comment" id="6242220">//&nbsp;isDir&nbsp;calls&nbsp;ctxt.IsDir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;uses&nbsp;os.Stat.</span><br>
<span class="lineno"></span><span class="keyword" id="6242281">func</span>&nbsp;<span class="op" id="6242286">(</span><span class="ident" id="6242287">ctxt</span>&nbsp;<span class="op" id="6242292">*</span><span class="ident" id="6242293">Context</span><span class="op" id="6242300">)</span>&nbsp;<span class="ident" id="6242302">isDir</span><span class="op" id="6242307">(</span><span class="ident" id="6242308">path</span>&nbsp;<span class="builtintype" id="6242313">string</span><span class="op" id="6242319">)</span>&nbsp;<span class="builtintype" id="6242321">bool</span>&nbsp;<span class="op" id="6242326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242329">if</span>&nbsp;<span class="ident" id="6242332">f</span>&nbsp;<span class="op" id="6242334">:=</span>&nbsp;<span class="ident" id="6242337">ctxt</span><span class="op" id="6242341">.</span><span class="ident" id="6242342">IsDir</span><span class="op" id="6242347">;</span>&nbsp;<span class="ident" id="6242349">f</span>&nbsp;<span class="op" id="6242351">!=</span>&nbsp;<span class="ident" id="6242354">nil</span>&nbsp;<span class="op" id="6242358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242362">return</span>&nbsp;<span class="ident" id="6242369">f</span><span class="op" id="6242370">(</span><span class="ident" id="6242371">path</span><span class="op" id="6242375">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6242378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6242381">fi</span><span class="op" id="6242383">,</span>&nbsp;<span class="ident" id="6242385">err</span>&nbsp;<span class="op" id="6242389">:=</span>&nbsp;<span class="ident" id="6242392">os</span><span class="op" id="6242394">.</span><span class="ident" id="6242395">Stat</span><span class="op" id="6242399">(</span><span class="ident" id="6242400">path</span><span class="op" id="6242404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242407">return</span>&nbsp;<span class="ident" id="6242414">err</span>&nbsp;<span class="op" id="6242418">==</span>&nbsp;<span class="ident" id="6242421">nil</span>&nbsp;<span class="op" id="6242425">&amp;&amp;</span>&nbsp;<span class="ident" id="6242428">fi</span><span class="op" id="6242430">.</span><span class="ident" id="6242431">IsDir</span><span class="op" id="6242436">(</span><span class="op" id="6242437">)</span><br>
<span class="lineno"></span><span class="op" id="6242439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="6242442">//&nbsp;hasSubdir&nbsp;calls&nbsp;ctxt.HasSubdir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="6242502">//&nbsp;the&nbsp;local&nbsp;file&nbsp;system&nbsp;to&nbsp;answer&nbsp;the&nbsp;question.</span><br>
<span class="lineno"></span><span class="keyword" id="6242551">func</span>&nbsp;<span class="op" id="6242556">(</span><span class="ident" id="6242557">ctxt</span>&nbsp;<span class="op" id="6242562">*</span><span class="ident" id="6242563">Context</span><span class="op" id="6242570">)</span>&nbsp;<span class="ident" id="6242572">hasSubdir</span><span class="op" id="6242581">(</span><span class="ident" id="6242582">root</span><span class="op" id="6242586">,</span>&nbsp;<span class="ident" id="6242588">dir</span>&nbsp;<span class="builtintype" id="6242592">string</span><span class="op" id="6242598">)</span>&nbsp;<span class="op" id="6242600">(</span><span class="ident" id="6242601">rel</span>&nbsp;<span class="builtintype" id="6242605">string</span><span class="op" id="6242611">,</span>&nbsp;<span class="ident" id="6242613">ok</span>&nbsp;<span class="builtintype" id="6242616">bool</span><span class="op" id="6242620">)</span>&nbsp;<span class="op" id="6242622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242625">if</span>&nbsp;<span class="ident" id="6242628">f</span>&nbsp;<span class="op" id="6242630">:=</span>&nbsp;<span class="ident" id="6242633">ctxt</span><span class="op" id="6242637">.</span><span class="ident" id="6242638">HasSubdir</span><span class="op" id="6242647">;</span>&nbsp;<span class="ident" id="6242649">f</span>&nbsp;<span class="op" id="6242651">!=</span>&nbsp;<span class="ident" id="6242654">nil</span>&nbsp;<span class="op" id="6242658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242662">return</span>&nbsp;<span class="ident" id="6242669">f</span><span class="op" id="6242670">(</span><span class="ident" id="6242671">root</span><span class="op" id="6242675">,</span>&nbsp;<span class="ident" id="6242677">dir</span><span class="op" id="6242680">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6242683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6242687">//&nbsp;Try&nbsp;using&nbsp;paths&nbsp;we&nbsp;received.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242720">if</span>&nbsp;<span class="ident" id="6242723">rel</span><span class="op" id="6242726">,</span>&nbsp;<span class="ident" id="6242728">ok</span>&nbsp;<span class="op" id="6242731">=</span>&nbsp;<span class="ident" id="6242733">hasSubdir</span><span class="op" id="6242742">(</span><span class="ident" id="6242743">root</span><span class="op" id="6242747">,</span>&nbsp;<span class="ident" id="6242749">dir</span><span class="op" id="6242752">)</span><span class="op" id="6242753">;</span>&nbsp;<span class="ident" id="6242755">ok</span>&nbsp;<span class="op" id="6242758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242762">return</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6242770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6242774">//&nbsp;Try&nbsp;expanding&nbsp;symlinks&nbsp;and&nbsp;comparing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6242815">//&nbsp;expanded&nbsp;against&nbsp;unexpanded&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6242851">//&nbsp;expanded&nbsp;against&nbsp;expanded.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6242882">rootSym</span><span class="op" id="6242889">,</span>&nbsp;<span class="ident" id="6242891">_</span>&nbsp;<span class="op" id="6242893">:=</span>&nbsp;<span class="ident" id="6242896">filepath</span><span class="op" id="6242904">.</span><span class="ident" id="6242905">EvalSymlinks</span><span class="op" id="6242917">(</span><span class="ident" id="6242918">root</span><span class="op" id="6242922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6242925">dirSym</span><span class="op" id="6242931">,</span>&nbsp;<span class="ident" id="6242933">_</span>&nbsp;<span class="op" id="6242935">:=</span>&nbsp;<span class="ident" id="6242938">filepath</span><span class="op" id="6242946">.</span><span class="ident" id="6242947">EvalSymlinks</span><span class="op" id="6242959">(</span><span class="ident" id="6242960">dir</span><span class="op" id="6242963">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242967">if</span>&nbsp;<span class="ident" id="6242970">rel</span><span class="op" id="6242973">,</span>&nbsp;<span class="ident" id="6242975">ok</span>&nbsp;<span class="op" id="6242978">=</span>&nbsp;<span class="ident" id="6242980">hasSubdir</span><span class="op" id="6242989">(</span><span class="ident" id="6242990">rootSym</span><span class="op" id="6242997">,</span>&nbsp;<span class="ident" id="6242999">dir</span><span class="op" id="6243002">)</span><span class="op" id="6243003">;</span>&nbsp;<span class="ident" id="6243005">ok</span>&nbsp;<span class="op" id="6243008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243012">return</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6243020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243023">if</span>&nbsp;<span class="ident" id="6243026">rel</span><span class="op" id="6243029">,</span>&nbsp;<span class="ident" id="6243031">ok</span>&nbsp;<span class="op" id="6243034">=</span>&nbsp;<span class="ident" id="6243036">hasSubdir</span><span class="op" id="6243045">(</span><span class="ident" id="6243046">root</span><span class="op" id="6243050">,</span>&nbsp;<span class="ident" id="6243052">dirSym</span><span class="op" id="6243058">)</span><span class="op" id="6243059">;</span>&nbsp;<span class="ident" id="6243061">ok</span>&nbsp;<span class="op" id="6243064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243068">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6243076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243079">return</span>&nbsp;<span class="ident" id="6243086">hasSubdir</span><span class="op" id="6243095">(</span><span class="ident" id="6243096">rootSym</span><span class="op" id="6243103">,</span>&nbsp;<span class="ident" id="6243105">dirSym</span><span class="op" id="6243111">)</span><br>
<span class="lineno">155</span><span class="op" id="6243113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6243116">func</span>&nbsp;<span class="ident" id="6243121">hasSubdir</span><span class="op" id="6243130">(</span><span class="ident" id="6243131">root</span><span class="op" id="6243135">,</span>&nbsp;<span class="ident" id="6243137">dir</span>&nbsp;<span class="builtintype" id="6243141">string</span><span class="op" id="6243147">)</span>&nbsp;<span class="op" id="6243149">(</span><span class="ident" id="6243150">rel</span>&nbsp;<span class="builtintype" id="6243154">string</span><span class="op" id="6243160">,</span>&nbsp;<span class="ident" id="6243162">ok</span>&nbsp;<span class="builtintype" id="6243165">bool</span><span class="op" id="6243169">)</span>&nbsp;<span class="op" id="6243171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243174">const</span>&nbsp;<span class="ident" id="6243180">sep</span>&nbsp;<span class="op" id="6243184">=</span>&nbsp;<span class="builtintype" id="6243186">string</span><span class="op" id="6243192">(</span><span class="ident" id="6243193">filepath</span><span class="op" id="6243201">.</span><span class="ident" id="6243202">Separator</span><span class="op" id="6243211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243214">root</span>&nbsp;<span class="op" id="6243219">=</span>&nbsp;<span class="ident" id="6243221">filepath</span><span class="op" id="6243229">.</span><span class="ident" id="6243230">Clean</span><span class="op" id="6243235">(</span><span class="ident" id="6243236">root</span><span class="op" id="6243240">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243243">if</span>&nbsp;<span class="op" id="6243246">!</span><span class="ident" id="6243247">strings</span><span class="op" id="6243254">.</span><span class="ident" id="6243255">HasSuffix</span><span class="op" id="6243264">(</span><span class="ident" id="6243265">root</span><span class="op" id="6243269">,</span>&nbsp;<span class="ident" id="6243271">sep</span><span class="op" id="6243274">)</span>&nbsp;<span class="op" id="6243276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243280">root</span>&nbsp;<span class="op" id="6243285">+=</span>&nbsp;<span class="ident" id="6243288">sep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6243293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243296">dir</span>&nbsp;<span class="op" id="6243300">=</span>&nbsp;<span class="ident" id="6243302">filepath</span><span class="op" id="6243310">.</span><span class="ident" id="6243311">Clean</span><span class="op" id="6243316">(</span><span class="ident" id="6243317">dir</span><span class="op" id="6243320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243323">if</span>&nbsp;<span class="op" id="6243326">!</span><span class="ident" id="6243327">strings</span><span class="op" id="6243334">.</span><span class="ident" id="6243335">HasPrefix</span><span class="op" id="6243344">(</span><span class="ident" id="6243345">dir</span><span class="op" id="6243348">,</span>&nbsp;<span class="ident" id="6243350">root</span><span class="op" id="6243354">)</span>&nbsp;<span class="op" id="6243356">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243360">return</span>&nbsp;<span class="string" id="6243367">&#34;&#34;</span><span class="op" id="6243369">,</span>&nbsp;<span class="builtintype" id="6243371">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6243378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243381">return</span>&nbsp;<span class="ident" id="6243388">filepath</span><span class="op" id="6243396">.</span><span class="ident" id="6243397">ToSlash</span><span class="op" id="6243404">(</span><span class="ident" id="6243405">dir</span><span class="op" id="6243408">[</span><span class="builtinfunc" id="6243409">len</span><span class="op" id="6243412">(</span><span class="ident" id="6243413">root</span><span class="op" id="6243417">)</span><span class="op" id="6243418">:</span><span class="op" id="6243419">]</span><span class="op" id="6243420">)</span><span class="op" id="6243421">,</span>&nbsp;<span class="builtintype" id="6243423">true</span><br>
<span class="lineno"></span><span class="op" id="6243428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="comment" id="6243431">//&nbsp;readDir&nbsp;calls&nbsp;ctxt.ReadDir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;ioutil.ReadDir.</span><br>
<span class="lineno"></span><span class="keyword" id="6243498">func</span>&nbsp;<span class="op" id="6243503">(</span><span class="ident" id="6243504">ctxt</span>&nbsp;<span class="op" id="6243509">*</span><span class="ident" id="6243510">Context</span><span class="op" id="6243517">)</span>&nbsp;<span class="ident" id="6243519">readDir</span><span class="op" id="6243526">(</span><span class="ident" id="6243527">path</span>&nbsp;<span class="builtintype" id="6243532">string</span><span class="op" id="6243538">)</span>&nbsp;<span class="op" id="6243540">(</span><span class="op" id="6243541">[</span><span class="op" id="6243542">]</span><span class="ident" id="6243543">os</span><span class="op" id="6243545">.</span><span class="ident" id="6243546">FileInfo</span><span class="op" id="6243554">,</span>&nbsp;<span class="builtintype" id="6243556">error</span><span class="op" id="6243561">)</span>&nbsp;<span class="op" id="6243563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243566">if</span>&nbsp;<span class="ident" id="6243569">f</span>&nbsp;<span class="op" id="6243571">:=</span>&nbsp;<span class="ident" id="6243574">ctxt</span><span class="op" id="6243578">.</span><span class="ident" id="6243579">ReadDir</span><span class="op" id="6243586">;</span>&nbsp;<span class="ident" id="6243588">f</span>&nbsp;<span class="op" id="6243590">!=</span>&nbsp;<span class="ident" id="6243593">nil</span>&nbsp;<span class="op" id="6243597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243601">return</span>&nbsp;<span class="ident" id="6243608">f</span><span class="op" id="6243609">(</span><span class="ident" id="6243610">path</span><span class="op" id="6243614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6243617">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243620">return</span>&nbsp;<span class="ident" id="6243627">ioutil</span><span class="op" id="6243633">.</span><span class="ident" id="6243634">ReadDir</span><span class="op" id="6243641">(</span><span class="ident" id="6243642">path</span><span class="op" id="6243646">)</span><br>
<span class="lineno"></span><span class="op" id="6243648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6243651">//&nbsp;openFile&nbsp;calls&nbsp;ctxt.OpenFile&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;os.Open.</span><br>
<span class="lineno"></span><span class="keyword" id="6243713">func</span>&nbsp;<span class="op" id="6243718">(</span><span class="ident" id="6243719">ctxt</span>&nbsp;<span class="op" id="6243724">*</span><span class="ident" id="6243725">Context</span><span class="op" id="6243732">)</span>&nbsp;<span class="ident" id="6243734">openFile</span><span class="op" id="6243742">(</span><span class="ident" id="6243743">path</span>&nbsp;<span class="builtintype" id="6243748">string</span><span class="op" id="6243754">)</span>&nbsp;<span class="op" id="6243756">(</span><span class="ident" id="6243757">io</span><span class="op" id="6243759">.</span><span class="ident" id="6243760">ReadCloser</span><span class="op" id="6243770">,</span>&nbsp;<span class="builtintype" id="6243772">error</span><span class="op" id="6243777">)</span>&nbsp;<span class="op" id="6243779">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243782">if</span>&nbsp;<span class="ident" id="6243785">fn</span>&nbsp;<span class="op" id="6243788">:=</span>&nbsp;<span class="ident" id="6243791">ctxt</span><span class="op" id="6243795">.</span><span class="ident" id="6243796">OpenFile</span><span class="op" id="6243804">;</span>&nbsp;<span class="ident" id="6243806">fn</span>&nbsp;<span class="op" id="6243809">!=</span>&nbsp;<span class="ident" id="6243812">nil</span>&nbsp;<span class="op" id="6243816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243820">return</span>&nbsp;<span class="ident" id="6243827">fn</span><span class="op" id="6243829">(</span><span class="ident" id="6243830">path</span><span class="op" id="6243834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6243837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243841">f</span><span class="op" id="6243842">,</span>&nbsp;<span class="ident" id="6243844">err</span>&nbsp;<span class="op" id="6243848">:=</span>&nbsp;<span class="ident" id="6243851">os</span><span class="op" id="6243853">.</span><span class="ident" id="6243854">Open</span><span class="op" id="6243858">(</span><span class="ident" id="6243859">path</span><span class="op" id="6243863">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243866">if</span>&nbsp;<span class="ident" id="6243869">err</span>&nbsp;<span class="op" id="6243873">!=</span>&nbsp;<span class="ident" id="6243876">nil</span>&nbsp;<span class="op" id="6243880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243884">return</span>&nbsp;<span class="ident" id="6243891">nil</span><span class="op" id="6243894">,</span>&nbsp;<span class="ident" id="6243896">err</span>&nbsp;<span class="comment" id="6243900">//&nbsp;nil&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6243918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243921">return</span>&nbsp;<span class="ident" id="6243928">f</span><span class="op" id="6243929">,</span>&nbsp;<span class="ident" id="6243931">nil</span><br>
<span class="lineno"></span><span class="op" id="6243935">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="6243938">//&nbsp;isFile&nbsp;determines&nbsp;whether&nbsp;path&nbsp;is&nbsp;a&nbsp;file&nbsp;by&nbsp;trying&nbsp;to&nbsp;open&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="6244004">//&nbsp;It&nbsp;reuses&nbsp;openFile&nbsp;instead&nbsp;of&nbsp;adding&nbsp;another&nbsp;function&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6244068">//&nbsp;list&nbsp;in&nbsp;Context.</span><br>
<span class="lineno"></span><span class="keyword" id="6244088">func</span>&nbsp;<span class="op" id="6244093">(</span><span class="ident" id="6244094">ctxt</span>&nbsp;<span class="op" id="6244099">*</span><span class="ident" id="6244100">Context</span><span class="op" id="6244107">)</span>&nbsp;<span class="ident" id="6244109">isFile</span><span class="op" id="6244115">(</span><span class="ident" id="6244116">path</span>&nbsp;<span class="builtintype" id="6244121">string</span><span class="op" id="6244127">)</span>&nbsp;<span class="builtintype" id="6244129">bool</span>&nbsp;<span class="op" id="6244134">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244137">f</span><span class="op" id="6244138">,</span>&nbsp;<span class="ident" id="6244140">err</span>&nbsp;<span class="op" id="6244144">:=</span>&nbsp;<span class="ident" id="6244147">ctxt</span><span class="op" id="6244151">.</span><span class="ident" id="6244152">openFile</span><span class="op" id="6244160">(</span><span class="ident" id="6244161">path</span><span class="op" id="6244165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244168">if</span>&nbsp;<span class="ident" id="6244171">err</span>&nbsp;<span class="op" id="6244175">!=</span>&nbsp;<span class="ident" id="6244178">nil</span>&nbsp;<span class="op" id="6244182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244186">return</span>&nbsp;<span class="builtintype" id="6244193">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6244200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244203">f</span><span class="op" id="6244204">.</span><span class="ident" id="6244205">Close</span><span class="op" id="6244210">(</span><span class="op" id="6244211">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244214">return</span>&nbsp;<span class="builtintype" id="6244221">true</span><br>
<span class="lineno"></span><span class="op" id="6244226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6244229">//&nbsp;gopath&nbsp;returns&nbsp;the&nbsp;list&nbsp;of&nbsp;Go&nbsp;path&nbsp;directories.</span><br>
<span class="lineno"></span><span class="keyword" id="6244280">func</span>&nbsp;<span class="op" id="6244285">(</span><span class="ident" id="6244286">ctxt</span>&nbsp;<span class="op" id="6244291">*</span><span class="ident" id="6244292">Context</span><span class="op" id="6244299">)</span>&nbsp;<span class="ident" id="6244301">gopath</span><span class="op" id="6244307">(</span><span class="op" id="6244308">)</span>&nbsp;<span class="op" id="6244310">[</span><span class="op" id="6244311">]</span><span class="builtintype" id="6244312">string</span>&nbsp;<span class="op" id="6244319">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244322">var</span>&nbsp;<span class="ident" id="6244326">all</span>&nbsp;<span class="op" id="6244330">[</span><span class="op" id="6244331">]</span><span class="builtintype" id="6244332">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244340">for</span>&nbsp;<span class="ident" id="6244344">_</span><span class="op" id="6244345">,</span>&nbsp;<span class="ident" id="6244347">p</span>&nbsp;<span class="op" id="6244349">:=</span>&nbsp;<span class="keyword" id="6244352">range</span>&nbsp;<span class="ident" id="6244358">ctxt</span><span class="op" id="6244362">.</span><span class="ident" id="6244363">splitPathList</span><span class="op" id="6244376">(</span><span class="ident" id="6244377">ctxt</span><span class="op" id="6244381">.</span><span class="ident" id="6244382">GOPATH</span><span class="op" id="6244388">)</span>&nbsp;<span class="op" id="6244390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244394">if</span>&nbsp;<span class="ident" id="6244397">p</span>&nbsp;<span class="op" id="6244399">==</span>&nbsp;<span class="string" id="6244402">&#34;&#34;</span>&nbsp;<span class="op" id="6244405">||</span>&nbsp;<span class="ident" id="6244408">p</span>&nbsp;<span class="op" id="6244410">==</span>&nbsp;<span class="ident" id="6244413">ctxt</span><span class="op" id="6244417">.</span><span class="ident" id="6244418">GOROOT</span>&nbsp;<span class="op" id="6244425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6244430">//&nbsp;Empty&nbsp;paths&nbsp;are&nbsp;uninteresting.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6244467">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;the&nbsp;GOROOT,&nbsp;ignore&nbsp;it.</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6244511">//&nbsp;People&nbsp;sometimes&nbsp;set&nbsp;GOPATH=$GOROOT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6244554">//&nbsp;Do&nbsp;not&nbsp;get&nbsp;confused&nbsp;by&nbsp;this&nbsp;common&nbsp;mistake.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244604">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6244615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244619">if</span>&nbsp;<span class="ident" id="6244622">strings</span><span class="op" id="6244629">.</span><span class="ident" id="6244630">HasPrefix</span><span class="op" id="6244639">(</span><span class="ident" id="6244640">p</span><span class="op" id="6244641">,</span>&nbsp;<span class="string" id="6244643">&#34;~&#34;</span><span class="op" id="6244646">)</span>&nbsp;<span class="op" id="6244648">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6244653">//&nbsp;Path&nbsp;segments&nbsp;starting&nbsp;with&nbsp;~&nbsp;on&nbsp;Unix&nbsp;are&nbsp;almost&nbsp;always</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6244715">//&nbsp;users&nbsp;who&nbsp;have&nbsp;incorrectly&nbsp;quoted&nbsp;~&nbsp;while&nbsp;setting&nbsp;GOPATH,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6244779">//&nbsp;preventing&nbsp;it&nbsp;from&nbsp;expanding&nbsp;to&nbsp;$HOME.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6244824">//&nbsp;The&nbsp;situation&nbsp;is&nbsp;made&nbsp;more&nbsp;confusing&nbsp;by&nbsp;the&nbsp;fact&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6244884">//&nbsp;bash&nbsp;allows&nbsp;quoted&nbsp;~&nbsp;in&nbsp;$PATH&nbsp;(most&nbsp;shells&nbsp;do&nbsp;not).</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6244942">//&nbsp;Do&nbsp;not&nbsp;get&nbsp;confused&nbsp;by&nbsp;this,&nbsp;and&nbsp;do&nbsp;not&nbsp;try&nbsp;to&nbsp;use&nbsp;the&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6245009">//&nbsp;It&nbsp;does&nbsp;not&nbsp;exist,&nbsp;and&nbsp;printing&nbsp;errors&nbsp;about&nbsp;it&nbsp;confuses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6245072">//&nbsp;those&nbsp;users&nbsp;even&nbsp;more,&nbsp;because&nbsp;they&nbsp;think&nbsp;&#34;sure&nbsp;~&nbsp;exists!&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6245138">//&nbsp;The&nbsp;go&nbsp;command&nbsp;diagnoses&nbsp;this&nbsp;situation&nbsp;and&nbsp;prints&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6245197">//&nbsp;useful&nbsp;error.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6245217">//&nbsp;On&nbsp;Windows,&nbsp;~&nbsp;is&nbsp;used&nbsp;in&nbsp;short&nbsp;names,&nbsp;such&nbsp;as&nbsp;c:\progra~1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6245281">//&nbsp;for&nbsp;c:\program&nbsp;files.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245309">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6245320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245324">all</span>&nbsp;<span class="op" id="6245328">=</span>&nbsp;<span class="builtinfunc" id="6245330">append</span><span class="op" id="6245336">(</span><span class="ident" id="6245337">all</span><span class="op" id="6245340">,</span>&nbsp;<span class="ident" id="6245342">p</span><span class="op" id="6245343">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6245346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245349">return</span>&nbsp;<span class="ident" id="6245356">all</span><br>
<span class="lineno"></span><span class="op" id="6245360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6245363">//&nbsp;SrcDirs&nbsp;returns&nbsp;a&nbsp;list&nbsp;of&nbsp;package&nbsp;source&nbsp;root&nbsp;directories.</span><br>
<span class="lineno">235</span><span class="comment" id="6245425">//&nbsp;It&nbsp;draws&nbsp;from&nbsp;the&nbsp;current&nbsp;Go&nbsp;root&nbsp;and&nbsp;Go&nbsp;path&nbsp;but&nbsp;omits&nbsp;directories</span><br>
<span class="lineno"></span><span class="comment" id="6245496">//&nbsp;that&nbsp;do&nbsp;not&nbsp;exist.</span><br>
<span class="lineno"></span><span class="keyword" id="6245518">func</span>&nbsp;<span class="op" id="6245523">(</span><span class="ident" id="6245524">ctxt</span>&nbsp;<span class="op" id="6245529">*</span><span class="ident" id="6245530">Context</span><span class="op" id="6245537">)</span>&nbsp;<span class="ident" id="6245539">SrcDirs</span><span class="op" id="6245546">(</span><span class="op" id="6245547">)</span>&nbsp;<span class="op" id="6245549">[</span><span class="op" id="6245550">]</span><span class="builtintype" id="6245551">string</span>&nbsp;<span class="op" id="6245558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245561">var</span>&nbsp;<span class="ident" id="6245565">all</span>&nbsp;<span class="op" id="6245569">[</span><span class="op" id="6245570">]</span><span class="builtintype" id="6245571">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245579">if</span>&nbsp;<span class="ident" id="6245582">ctxt</span><span class="op" id="6245586">.</span><span class="ident" id="6245587">GOROOT</span>&nbsp;<span class="op" id="6245594">!=</span>&nbsp;<span class="string" id="6245597">&#34;&#34;</span>&nbsp;<span class="op" id="6245600">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245604">dir</span>&nbsp;<span class="op" id="6245608">:=</span>&nbsp;<span class="ident" id="6245611">ctxt</span><span class="op" id="6245615">.</span><span class="ident" id="6245616">joinPath</span><span class="op" id="6245624">(</span><span class="ident" id="6245625">ctxt</span><span class="op" id="6245629">.</span><span class="ident" id="6245630">GOROOT</span><span class="op" id="6245636">,</span>&nbsp;<span class="string" id="6245638">&#34;src&#34;</span><span class="op" id="6245643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245647">if</span>&nbsp;<span class="ident" id="6245650">ctxt</span><span class="op" id="6245654">.</span><span class="ident" id="6245655">isDir</span><span class="op" id="6245660">(</span><span class="ident" id="6245661">dir</span><span class="op" id="6245664">)</span>&nbsp;<span class="op" id="6245666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245671">all</span>&nbsp;<span class="op" id="6245675">=</span>&nbsp;<span class="builtinfunc" id="6245677">append</span><span class="op" id="6245683">(</span><span class="ident" id="6245684">all</span><span class="op" id="6245687">,</span>&nbsp;<span class="ident" id="6245689">dir</span><span class="op" id="6245692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6245696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6245699">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245702">for</span>&nbsp;<span class="ident" id="6245706">_</span><span class="op" id="6245707">,</span>&nbsp;<span class="ident" id="6245709">p</span>&nbsp;<span class="op" id="6245711">:=</span>&nbsp;<span class="keyword" id="6245714">range</span>&nbsp;<span class="ident" id="6245720">ctxt</span><span class="op" id="6245724">.</span><span class="ident" id="6245725">gopath</span><span class="op" id="6245731">(</span><span class="op" id="6245732">)</span>&nbsp;<span class="op" id="6245734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245738">dir</span>&nbsp;<span class="op" id="6245742">:=</span>&nbsp;<span class="ident" id="6245745">ctxt</span><span class="op" id="6245749">.</span><span class="ident" id="6245750">joinPath</span><span class="op" id="6245758">(</span><span class="ident" id="6245759">p</span><span class="op" id="6245760">,</span>&nbsp;<span class="string" id="6245762">&#34;src&#34;</span><span class="op" id="6245767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245771">if</span>&nbsp;<span class="ident" id="6245774">ctxt</span><span class="op" id="6245778">.</span><span class="ident" id="6245779">isDir</span><span class="op" id="6245784">(</span><span class="ident" id="6245785">dir</span><span class="op" id="6245788">)</span>&nbsp;<span class="op" id="6245790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245795">all</span>&nbsp;<span class="op" id="6245799">=</span>&nbsp;<span class="builtinfunc" id="6245801">append</span><span class="op" id="6245807">(</span><span class="ident" id="6245808">all</span><span class="op" id="6245811">,</span>&nbsp;<span class="ident" id="6245813">dir</span><span class="op" id="6245816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6245820">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6245823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245826">return</span>&nbsp;<span class="ident" id="6245833">all</span><br>
<span class="lineno"></span><span class="op" id="6245837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6245840">//&nbsp;Default&nbsp;is&nbsp;the&nbsp;default&nbsp;Context&nbsp;for&nbsp;builds.</span><br>
<span class="lineno">255</span><span class="comment" id="6245886">//&nbsp;It&nbsp;uses&nbsp;the&nbsp;GOARCH,&nbsp;GOOS,&nbsp;GOROOT,&nbsp;and&nbsp;GOPATH&nbsp;environment&nbsp;variables</span><br>
<span class="lineno"></span><span class="comment" id="6245956">//&nbsp;if&nbsp;set,&nbsp;or&nbsp;else&nbsp;the&nbsp;compiled&nbsp;code&#39;s&nbsp;GOARCH,&nbsp;GOOS,&nbsp;and&nbsp;GOROOT.</span><br>
<span class="lineno"></span><span class="keyword" id="6246021">var</span>&nbsp;<span class="ident" id="6246025">Default</span>&nbsp;<span class="ident" id="6246033">Context</span>&nbsp;<span class="op" id="6246041">=</span>&nbsp;<span class="ident" id="6246043">defaultContext</span><span class="op" id="6246057">(</span><span class="op" id="6246058">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6246061">var</span>&nbsp;<span class="ident" id="6246065">cgoEnabled</span>&nbsp;<span class="op" id="6246076">=</span>&nbsp;<span class="keyword" id="6246078">map</span><span class="op" id="6246081">[</span><span class="builtintype" id="6246082">string</span><span class="op" id="6246088">]</span><span class="builtintype" id="6246089">bool</span><span class="op" id="6246093">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6246096">&#34;darwin/386&#34;</span><span class="op" id="6246108">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6246115">true</span><span class="op" id="6246119">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6246122">&#34;darwin/amd64&#34;</span><span class="op" id="6246136">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6246141">true</span><span class="op" id="6246145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6246148">&#34;dragonfly/386&#34;</span><span class="op" id="6246163">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6246167">true</span><span class="op" id="6246171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6246174">&#34;dragonfly/amd64&#34;</span><span class="op" id="6246191">:</span>&nbsp;<span class="builtintype" id="6246193">true</span><span class="op" id="6246197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6246200">&#34;freebsd/386&#34;</span><span class="op" id="6246213">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6246219">true</span><span class="op" id="6246223">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6246226">&#34;freebsd/amd64&#34;</span><span class="op" id="6246241">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6246245">true</span><span class="op" id="6246249">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6246252">&#34;freebsd/arm&#34;</span><span class="op" id="6246265">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6246271">true</span><span class="op" id="6246275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6246278">&#34;linux/386&#34;</span><span class="op" id="6246289">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6246297">true</span><span class="op" id="6246301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6246304">&#34;linux/amd64&#34;</span><span class="op" id="6246317">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6246323">true</span><span class="op" id="6246327">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6246330">&#34;linux/arm&#34;</span><span class="op" id="6246341">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6246349">true</span><span class="op" id="6246353">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6246356">&#34;android/386&#34;</span><span class="op" id="6246369">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6246375">true</span><span class="op" id="6246379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6246382">&#34;android/amd64&#34;</span><span class="op" id="6246397">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6246401">true</span><span class="op" id="6246405">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6246408">&#34;android/arm&#34;</span><span class="op" id="6246421">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6246427">true</span><span class="op" id="6246431">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6246434">&#34;netbsd/386&#34;</span><span class="op" id="6246446">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6246453">true</span><span class="op" id="6246457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6246460">&#34;netbsd/amd64&#34;</span><span class="op" id="6246474">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6246479">true</span><span class="op" id="6246483">,</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6246486">&#34;netbsd/arm&#34;</span><span class="op" id="6246498">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6246505">true</span><span class="op" id="6246509">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6246512">&#34;openbsd/386&#34;</span><span class="op" id="6246525">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6246531">true</span><span class="op" id="6246535">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6246538">&#34;openbsd/amd64&#34;</span><span class="op" id="6246553">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6246557">true</span><span class="op" id="6246561">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6246564">&#34;windows/386&#34;</span><span class="op" id="6246577">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6246583">true</span><span class="op" id="6246587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6246590">&#34;windows/amd64&#34;</span><span class="op" id="6246605">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6246609">true</span><span class="op" id="6246613">,</span><br>
<span class="lineno">280</span><span class="op" id="6246615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6246618">func</span>&nbsp;<span class="ident" id="6246623">defaultContext</span><span class="op" id="6246637">(</span><span class="op" id="6246638">)</span>&nbsp;<span class="ident" id="6246640">Context</span>&nbsp;<span class="op" id="6246648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246651">var</span>&nbsp;<span class="ident" id="6246655">c</span>&nbsp;<span class="ident" id="6246657">Context</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246667">c</span><span class="op" id="6246668">.</span><span class="ident" id="6246669">GOARCH</span>&nbsp;<span class="op" id="6246676">=</span>&nbsp;<span class="ident" id="6246678">envOr</span><span class="op" id="6246683">(</span><span class="string" id="6246684">&#34;GOARCH&#34;</span><span class="op" id="6246692">,</span>&nbsp;<span class="ident" id="6246694">runtime</span><span class="op" id="6246701">.</span><span class="ident" id="6246702">GOARCH</span><span class="op" id="6246708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246711">c</span><span class="op" id="6246712">.</span><span class="ident" id="6246713">GOOS</span>&nbsp;<span class="op" id="6246718">=</span>&nbsp;<span class="ident" id="6246720">envOr</span><span class="op" id="6246725">(</span><span class="string" id="6246726">&#34;GOOS&#34;</span><span class="op" id="6246732">,</span>&nbsp;<span class="ident" id="6246734">runtime</span><span class="op" id="6246741">.</span><span class="ident" id="6246742">GOOS</span><span class="op" id="6246746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246749">c</span><span class="op" id="6246750">.</span><span class="ident" id="6246751">GOROOT</span>&nbsp;<span class="op" id="6246758">=</span>&nbsp;<span class="ident" id="6246760">runtime</span><span class="op" id="6246767">.</span><span class="ident" id="6246768">GOROOT</span><span class="op" id="6246774">(</span><span class="op" id="6246775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246778">c</span><span class="op" id="6246779">.</span><span class="ident" id="6246780">GOPATH</span>&nbsp;<span class="op" id="6246787">=</span>&nbsp;<span class="ident" id="6246789">envOr</span><span class="op" id="6246794">(</span><span class="string" id="6246795">&#34;GOPATH&#34;</span><span class="op" id="6246803">,</span>&nbsp;<span class="string" id="6246805">&#34;&#34;</span><span class="op" id="6246807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246810">c</span><span class="op" id="6246811">.</span><span class="ident" id="6246812">Compiler</span>&nbsp;<span class="op" id="6246821">=</span>&nbsp;<span class="ident" id="6246823">runtime</span><span class="op" id="6246830">.</span><span class="ident" id="6246831">Compiler</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6246842">//&nbsp;Each&nbsp;major&nbsp;Go&nbsp;release&nbsp;in&nbsp;the&nbsp;Go&nbsp;1.x&nbsp;series&nbsp;should&nbsp;add&nbsp;a&nbsp;tag&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6246912">//&nbsp;Old&nbsp;tags&nbsp;should&nbsp;not&nbsp;be&nbsp;removed.&nbsp;That&nbsp;is,&nbsp;the&nbsp;go1.x&nbsp;tag&nbsp;is&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6246982">//&nbsp;in&nbsp;all&nbsp;releases&nbsp;&gt;=&nbsp;Go&nbsp;1.x.&nbsp;Code&nbsp;that&nbsp;requires&nbsp;Go&nbsp;1.x&nbsp;or&nbsp;later&nbsp;should</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6247055">//&nbsp;say&nbsp;&#34;+build&nbsp;go1.x&#34;,&nbsp;and&nbsp;code&nbsp;that&nbsp;should&nbsp;only&nbsp;be&nbsp;built&nbsp;before&nbsp;Go&nbsp;1.x</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6247128">//&nbsp;(perhaps&nbsp;it&nbsp;is&nbsp;the&nbsp;stub&nbsp;to&nbsp;use&nbsp;in&nbsp;that&nbsp;case)&nbsp;should&nbsp;say&nbsp;&#34;+build&nbsp;!go1.x&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6247205">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6247209">//&nbsp;When&nbsp;we&nbsp;reach&nbsp;Go&nbsp;1.5&nbsp;the&nbsp;line&nbsp;will&nbsp;read</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6247253">//&nbsp;&nbsp;&nbsp;&nbspc.ReleaseTags&nbsp;=&nbsp;[]string{&#34;go1.1&#34;,&nbsp;&#34;go1.2&#34;,&nbsp;&#34;go1.3&#34;,&nbsp;&#34;go1.4&#34;,&nbsp;&#34;go1.5&#34;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6247327">//&nbsp;and&nbsp;so&nbsp;on.</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247342">c</span><span class="op" id="6247343">.</span><span class="ident" id="6247344">ReleaseTags</span>&nbsp;<span class="op" id="6247356">=</span>&nbsp;<span class="op" id="6247358">[</span><span class="op" id="6247359">]</span><span class="builtintype" id="6247360">string</span><span class="op" id="6247366">{</span><span class="string" id="6247367">&#34;go1.1&#34;</span><span class="op" id="6247374">,</span>&nbsp;<span class="string" id="6247376">&#34;go1.2&#34;</span><span class="op" id="6247383">,</span>&nbsp;<span class="string" id="6247385">&#34;go1.3&#34;</span><span class="op" id="6247392">,</span>&nbsp;<span class="string" id="6247394">&#34;go1.4&#34;</span><span class="op" id="6247401">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247405">switch</span>&nbsp;<span class="ident" id="6247412">os</span><span class="op" id="6247414">.</span><span class="ident" id="6247415">Getenv</span><span class="op" id="6247421">(</span><span class="string" id="6247422">&#34;CGO_ENABLED&#34;</span><span class="op" id="6247435">)</span>&nbsp;<span class="op" id="6247437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247440">case</span>&nbsp;<span class="string" id="6247445">&#34;1&#34;</span><span class="op" id="6247448">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247452">c</span><span class="op" id="6247453">.</span><span class="ident" id="6247454">CgoEnabled</span>&nbsp;<span class="op" id="6247465">=</span>&nbsp;<span class="builtintype" id="6247467">true</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247473">case</span>&nbsp;<span class="string" id="6247478">&#34;0&#34;</span><span class="op" id="6247481">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247485">c</span><span class="op" id="6247486">.</span><span class="ident" id="6247487">CgoEnabled</span>&nbsp;<span class="op" id="6247498">=</span>&nbsp;<span class="builtintype" id="6247500">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247507">default</span><span class="op" id="6247514">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6247518">//&nbsp;cgo&nbsp;must&nbsp;be&nbsp;explicitly&nbsp;enabled&nbsp;for&nbsp;cross&nbsp;compilation&nbsp;builds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247583">if</span>&nbsp;<span class="ident" id="6247586">runtime</span><span class="op" id="6247593">.</span><span class="ident" id="6247594">GOARCH</span>&nbsp;<span class="op" id="6247601">==</span>&nbsp;<span class="ident" id="6247604">c</span><span class="op" id="6247605">.</span><span class="ident" id="6247606">GOARCH</span>&nbsp;<span class="op" id="6247613">&amp;&amp;</span>&nbsp;<span class="ident" id="6247616">runtime</span><span class="op" id="6247623">.</span><span class="ident" id="6247624">GOOS</span>&nbsp;<span class="op" id="6247629">==</span>&nbsp;<span class="ident" id="6247632">c</span><span class="op" id="6247633">.</span><span class="ident" id="6247634">GOOS</span>&nbsp;<span class="op" id="6247639">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247644">c</span><span class="op" id="6247645">.</span><span class="ident" id="6247646">CgoEnabled</span>&nbsp;<span class="op" id="6247657">=</span>&nbsp;<span class="ident" id="6247659">cgoEnabled</span><span class="op" id="6247669">[</span><span class="ident" id="6247670">c</span><span class="op" id="6247671">.</span><span class="ident" id="6247672">GOOS</span><span class="op" id="6247676">+</span><span class="string" id="6247677">&#34;/&#34;</span><span class="op" id="6247680">+</span><span class="ident" id="6247681">c</span><span class="op" id="6247682">.</span><span class="ident" id="6247683">GOARCH</span><span class="op" id="6247689">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247694">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6247702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247706">c</span><span class="op" id="6247707">.</span><span class="ident" id="6247708">CgoEnabled</span>&nbsp;<span class="op" id="6247719">=</span>&nbsp;<span class="builtintype" id="6247721">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6247728">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247732">return</span>&nbsp;<span class="ident" id="6247739">c</span><br>
<span class="lineno"></span><span class="op" id="6247741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6247744">func</span>&nbsp;<span class="ident" id="6247749">envOr</span><span class="op" id="6247754">(</span><span class="ident" id="6247755">name</span><span class="op" id="6247759">,</span>&nbsp;<span class="ident" id="6247761">def</span>&nbsp;<span class="builtintype" id="6247765">string</span><span class="op" id="6247771">)</span>&nbsp;<span class="builtintype" id="6247773">string</span>&nbsp;<span class="op" id="6247780">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247783">s</span>&nbsp;<span class="op" id="6247785">:=</span>&nbsp;<span class="ident" id="6247788">os</span><span class="op" id="6247790">.</span><span class="ident" id="6247791">Getenv</span><span class="op" id="6247797">(</span><span class="ident" id="6247798">name</span><span class="op" id="6247802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247805">if</span>&nbsp;<span class="ident" id="6247808">s</span>&nbsp;<span class="op" id="6247810">==</span>&nbsp;<span class="string" id="6247813">&#34;&#34;</span>&nbsp;<span class="op" id="6247816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247820">return</span>&nbsp;<span class="ident" id="6247827">def</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6247832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247835">return</span>&nbsp;<span class="ident" id="6247842">s</span><br>
<span class="lineno">325</span><span class="op" id="6247844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6247847">//&nbsp;An&nbsp;ImportMode&nbsp;controls&nbsp;the&nbsp;behavior&nbsp;of&nbsp;the&nbsp;Import&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="6247908">type</span>&nbsp;<span class="ident" id="6247913">ImportMode</span>&nbsp;<span class="builtintype" id="6247924">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="6247930">const</span>&nbsp;<span class="op" id="6247936">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6247939">//&nbsp;If&nbsp;FindOnly&nbsp;is&nbsp;set,&nbsp;Import&nbsp;stops&nbsp;after&nbsp;locating&nbsp;the&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6248005">//&nbsp;that&nbsp;should&nbsp;contain&nbsp;the&nbsp;sources&nbsp;for&nbsp;a&nbsp;package.&nbsp;&nbsp;It&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6248069">//&nbsp;read&nbsp;any&nbsp;files&nbsp;in&nbsp;the&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248106">FindOnly</span>&nbsp;<span class="ident" id="6248115">ImportMode</span>&nbsp;<span class="op" id="6248126">=</span>&nbsp;<span class="num" id="6248128">1</span>&nbsp;<span class="op" id="6248130">&lt;&lt;</span>&nbsp;<span class="ident" id="6248133">iota</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6248140">//&nbsp;If&nbsp;AllowBinary&nbsp;is&nbsp;set,&nbsp;Import&nbsp;can&nbsp;be&nbsp;satisfied&nbsp;by&nbsp;a&nbsp;compiled</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6248205">//&nbsp;package&nbsp;object&nbsp;without&nbsp;corresponding&nbsp;sources.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248255">AllowBinary</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6248269">//&nbsp;If&nbsp;ImportComment&nbsp;is&nbsp;set,&nbsp;parse&nbsp;import&nbsp;comments&nbsp;on&nbsp;package&nbsp;statements.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6248343">//&nbsp;Import&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;finds&nbsp;a&nbsp;comment&nbsp;it&nbsp;cannot&nbsp;understand</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6248414">//&nbsp;or&nbsp;finds&nbsp;conflicting&nbsp;comments&nbsp;in&nbsp;multiple&nbsp;source&nbsp;files.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6248474">//&nbsp;See&nbsp;golang.org/s/go14customimport&nbsp;for&nbsp;more&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248534">ImportComment</span><br>
<span class="lineno">345</span><span class="op" id="6248548">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6248551">//&nbsp;A&nbsp;Package&nbsp;describes&nbsp;the&nbsp;Go&nbsp;package&nbsp;found&nbsp;in&nbsp;a&nbsp;directory.</span><br>
<span class="lineno"></span><span class="keyword" id="6248611">type</span>&nbsp;<span class="ident" id="6248616">Package</span>&nbsp;<span class="keyword" id="6248624">struct</span>&nbsp;<span class="op" id="6248631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248634">Dir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6248648">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6248657">//&nbsp;directory&nbsp;containing&nbsp;package&nbsp;sources</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248698">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6248712">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6248721">//&nbsp;package&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248738">ImportComment</span>&nbsp;<span class="builtintype" id="6248752">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6248761">//&nbsp;path&nbsp;in&nbsp;import&nbsp;comment&nbsp;on&nbsp;package&nbsp;statement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248809">Doc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6248823">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6248832">//&nbsp;documentation&nbsp;synopsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248859">ImportPath</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6248873">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6248882">//&nbsp;import&nbsp;path&nbsp;of&nbsp;package&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248925">Root</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6248939">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6248948">//&nbsp;root&nbsp;of&nbsp;Go&nbsp;tree&nbsp;where&nbsp;this&nbsp;package&nbsp;lives</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248993">SrcRoot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6249007">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6249016">//&nbsp;package&nbsp;source&nbsp;root&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249066">PkgRoot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6249080">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6249089">//&nbsp;package&nbsp;install&nbsp;root&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249140">BinDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6249154">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6249163">//&nbsp;command&nbsp;install&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249209">Goroot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6249223">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6249232">//&nbsp;package&nbsp;found&nbsp;in&nbsp;Go&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249261">PkgObj</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6249275">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6249284">//&nbsp;installed&nbsp;.a&nbsp;file</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249306">AllTags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6249320">[</span><span class="op" id="6249321">]</span><span class="builtintype" id="6249322">string</span>&nbsp;<span class="comment" id="6249329">//&nbsp;tags&nbsp;that&nbsp;can&nbsp;influence&nbsp;file&nbsp;selection&nbsp;in&nbsp;this&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249390">ConflictDir</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6249404">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6249413">//&nbsp;this&nbsp;directory&nbsp;shadows&nbsp;Dir&nbsp;in&nbsp;$GOPATH</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6249456">//&nbsp;Source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249473">GoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6249488">[</span><span class="op" id="6249489">]</span><span class="builtintype" id="6249490">string</span>&nbsp;<span class="comment" id="6249497">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;(excluding&nbsp;CgoFiles,&nbsp;TestGoFiles,&nbsp;XTestGoFiles)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249566">CgoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6249581">[</span><span class="op" id="6249582">]</span><span class="builtintype" id="6249583">string</span>&nbsp;<span class="comment" id="6249590">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;that&nbsp;import&nbsp;&#34;C&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249627">IgnoredGoFiles</span>&nbsp;<span class="op" id="6249642">[</span><span class="op" id="6249643">]</span><span class="builtintype" id="6249644">string</span>&nbsp;<span class="comment" id="6249651">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;ignored&nbsp;for&nbsp;this&nbsp;build</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249695">CFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6249710">[</span><span class="op" id="6249711">]</span><span class="builtintype" id="6249712">string</span>&nbsp;<span class="comment" id="6249719">//&nbsp;.c&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249739">CXXFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6249754">[</span><span class="op" id="6249755">]</span><span class="builtintype" id="6249756">string</span>&nbsp;<span class="comment" id="6249763">//&nbsp;.cc,&nbsp;.cpp&nbsp;and&nbsp;.cxx&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249799">MFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6249814">[</span><span class="op" id="6249815">]</span><span class="builtintype" id="6249816">string</span>&nbsp;<span class="comment" id="6249823">//&nbsp;.m&nbsp;(Objective-C)&nbsp;source&nbsp;files</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249857">HFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6249872">[</span><span class="op" id="6249873">]</span><span class="builtintype" id="6249874">string</span>&nbsp;<span class="comment" id="6249881">//&nbsp;.h,&nbsp;.hh,&nbsp;.hpp&nbsp;and&nbsp;.hxx&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249921">SFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6249936">[</span><span class="op" id="6249937">]</span><span class="builtintype" id="6249938">string</span>&nbsp;<span class="comment" id="6249945">//&nbsp;.s&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249965">SwigFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6249980">[</span><span class="op" id="6249981">]</span><span class="builtintype" id="6249982">string</span>&nbsp;<span class="comment" id="6249989">//&nbsp;.swig&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250005">SwigCXXFiles</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6250020">[</span><span class="op" id="6250021">]</span><span class="builtintype" id="6250022">string</span>&nbsp;<span class="comment" id="6250029">//&nbsp;.swigcxx&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250048">SysoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6250063">[</span><span class="op" id="6250064">]</span><span class="builtintype" id="6250065">string</span>&nbsp;<span class="comment" id="6250072">//&nbsp;.syso&nbsp;system&nbsp;object&nbsp;files&nbsp;to&nbsp;add&nbsp;to&nbsp;archive</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6250121">//&nbsp;Cgo&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250140">CgoCFLAGS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6250153">[</span><span class="op" id="6250154">]</span><span class="builtintype" id="6250155">string</span>&nbsp;<span class="comment" id="6250162">//&nbsp;Cgo&nbsp;CFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250188">CgoCPPFLAGS</span>&nbsp;&nbsp;<span class="op" id="6250201">[</span><span class="op" id="6250202">]</span><span class="builtintype" id="6250203">string</span>&nbsp;<span class="comment" id="6250210">//&nbsp;Cgo&nbsp;CPPFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250238">CgoCXXFLAGS</span>&nbsp;&nbsp;<span class="op" id="6250251">[</span><span class="op" id="6250252">]</span><span class="builtintype" id="6250253">string</span>&nbsp;<span class="comment" id="6250260">//&nbsp;Cgo&nbsp;CXXFLAGS&nbsp;directives</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250288">CgoLDFLAGS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6250301">[</span><span class="op" id="6250302">]</span><span class="builtintype" id="6250303">string</span>&nbsp;<span class="comment" id="6250310">//&nbsp;Cgo&nbsp;LDFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250337">CgoPkgConfig</span>&nbsp;<span class="op" id="6250350">[</span><span class="op" id="6250351">]</span><span class="builtintype" id="6250352">string</span>&nbsp;<span class="comment" id="6250359">//&nbsp;Cgo&nbsp;pkg-config&nbsp;directives</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6250390">//&nbsp;Dependency&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250417">Imports</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6250427">[</span><span class="op" id="6250428">]</span><span class="builtintype" id="6250429">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6250455">//&nbsp;imports&nbsp;from&nbsp;GoFiles,&nbsp;CgoFiles</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250490">ImportPos</span>&nbsp;<span class="keyword" id="6250500">map</span><span class="op" id="6250503">[</span><span class="builtintype" id="6250504">string</span><span class="op" id="6250510">]</span><span class="op" id="6250511">[</span><span class="op" id="6250512">]</span><span class="ident" id="6250513">token</span><span class="op" id="6250518">.</span><span class="ident" id="6250519">Position</span>&nbsp;<span class="comment" id="6250528">//&nbsp;line&nbsp;information&nbsp;for&nbsp;Imports</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6250562">//&nbsp;Test&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250583">TestGoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6250598">[</span><span class="op" id="6250599">]</span><span class="builtintype" id="6250600">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6250626">//&nbsp;_test.go&nbsp;files&nbsp;in&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250656">TestImports</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6250671">[</span><span class="op" id="6250672">]</span><span class="builtintype" id="6250673">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6250699">//&nbsp;imports&nbsp;from&nbsp;TestGoFiles</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250728">TestImportPos</span>&nbsp;&nbsp;<span class="keyword" id="6250743">map</span><span class="op" id="6250746">[</span><span class="builtintype" id="6250747">string</span><span class="op" id="6250753">]</span><span class="op" id="6250754">[</span><span class="op" id="6250755">]</span><span class="ident" id="6250756">token</span><span class="op" id="6250761">.</span><span class="ident" id="6250762">Position</span>&nbsp;<span class="comment" id="6250771">//&nbsp;line&nbsp;information&nbsp;for&nbsp;TestImports</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250808">XTestGoFiles</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6250823">[</span><span class="op" id="6250824">]</span><span class="builtintype" id="6250825">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6250851">//&nbsp;_test.go&nbsp;files&nbsp;outside&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250886">XTestImports</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6250901">[</span><span class="op" id="6250902">]</span><span class="builtintype" id="6250903">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6250929">//&nbsp;imports&nbsp;from&nbsp;XTestGoFiles</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250959">XTestImportPos</span>&nbsp;<span class="keyword" id="6250974">map</span><span class="op" id="6250977">[</span><span class="builtintype" id="6250978">string</span><span class="op" id="6250984">]</span><span class="op" id="6250985">[</span><span class="op" id="6250986">]</span><span class="ident" id="6250987">token</span><span class="op" id="6250992">.</span><span class="ident" id="6250993">Position</span>&nbsp;<span class="comment" id="6251002">//&nbsp;line&nbsp;information&nbsp;for&nbsp;XTestImports</span><br>
<span class="lineno"></span><span class="op" id="6251039">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="6251042">//&nbsp;IsCommand&nbsp;reports&nbsp;whether&nbsp;the&nbsp;package&nbsp;is&nbsp;considered&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="6251099">//&nbsp;command&nbsp;to&nbsp;be&nbsp;installed&nbsp;(not&nbsp;just&nbsp;a&nbsp;library).</span><br>
<span class="lineno"></span><span class="comment" id="6251148">//&nbsp;Packages&nbsp;named&nbsp;&#34;main&#34;&nbsp;are&nbsp;treated&nbsp;as&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="6251198">func</span>&nbsp;<span class="op" id="6251203">(</span><span class="ident" id="6251204">p</span>&nbsp;<span class="op" id="6251206">*</span><span class="ident" id="6251207">Package</span><span class="op" id="6251214">)</span>&nbsp;<span class="ident" id="6251216">IsCommand</span><span class="op" id="6251225">(</span><span class="op" id="6251226">)</span>&nbsp;<span class="builtintype" id="6251228">bool</span>&nbsp;<span class="op" id="6251233">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251236">return</span>&nbsp;<span class="ident" id="6251243">p</span><span class="op" id="6251244">.</span><span class="ident" id="6251245">Name</span>&nbsp;<span class="op" id="6251250">==</span>&nbsp;<span class="string" id="6251253">&#34;main&#34;</span><br>
<span class="lineno"></span><span class="op" id="6251260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6251263">//&nbsp;ImportDir&nbsp;is&nbsp;like&nbsp;Import&nbsp;but&nbsp;processes&nbsp;the&nbsp;Go&nbsp;package&nbsp;found&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="6251329">//&nbsp;the&nbsp;named&nbsp;directory.</span><br>
<span class="lineno">405</span><span class="keyword" id="6251353">func</span>&nbsp;<span class="op" id="6251358">(</span><span class="ident" id="6251359">ctxt</span>&nbsp;<span class="op" id="6251364">*</span><span class="ident" id="6251365">Context</span><span class="op" id="6251372">)</span>&nbsp;<span class="ident" id="6251374">ImportDir</span><span class="op" id="6251383">(</span><span class="ident" id="6251384">dir</span>&nbsp;<span class="builtintype" id="6251388">string</span><span class="op" id="6251394">,</span>&nbsp;<span class="ident" id="6251396">mode</span>&nbsp;<span class="ident" id="6251401">ImportMode</span><span class="op" id="6251411">)</span>&nbsp;<span class="op" id="6251413">(</span><span class="op" id="6251414">*</span><span class="ident" id="6251415">Package</span><span class="op" id="6251422">,</span>&nbsp;<span class="builtintype" id="6251424">error</span><span class="op" id="6251429">)</span>&nbsp;<span class="op" id="6251431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251434">return</span>&nbsp;<span class="ident" id="6251441">ctxt</span><span class="op" id="6251445">.</span><span class="ident" id="6251446">Import</span><span class="op" id="6251452">(</span><span class="string" id="6251453">&#34;.&#34;</span><span class="op" id="6251456">,</span>&nbsp;<span class="ident" id="6251458">dir</span><span class="op" id="6251461">,</span>&nbsp;<span class="ident" id="6251463">mode</span><span class="op" id="6251467">)</span><br>
<span class="lineno"></span><span class="op" id="6251469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6251472">//&nbsp;NoGoError&nbsp;is&nbsp;the&nbsp;error&nbsp;used&nbsp;by&nbsp;Import&nbsp;to&nbsp;describe&nbsp;a&nbsp;directory</span><br>
<span class="lineno">410</span><span class="comment" id="6251537">//&nbsp;containing&nbsp;no&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files.&nbsp;(It&nbsp;may&nbsp;still&nbsp;contain</span><br>
<span class="lineno"></span><span class="comment" id="6251603">//&nbsp;test&nbsp;files,&nbsp;files&nbsp;hidden&nbsp;by&nbsp;build&nbsp;tags,&nbsp;and&nbsp;so&nbsp;on.)</span><br>
<span class="lineno"></span><span class="keyword" id="6251658">type</span>&nbsp;<span class="ident" id="6251663">NoGoError</span>&nbsp;<span class="keyword" id="6251673">struct</span>&nbsp;<span class="op" id="6251680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251683">Dir</span>&nbsp;<span class="builtintype" id="6251687">string</span><br>
<span class="lineno"></span><span class="op" id="6251694">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="keyword" id="6251697">func</span>&nbsp;<span class="op" id="6251702">(</span><span class="ident" id="6251703">e</span>&nbsp;<span class="op" id="6251705">*</span><span class="ident" id="6251706">NoGoError</span><span class="op" id="6251715">)</span>&nbsp;<span class="ident" id="6251717">Error</span><span class="op" id="6251722">(</span><span class="op" id="6251723">)</span>&nbsp;<span class="builtintype" id="6251725">string</span>&nbsp;<span class="op" id="6251732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251735">return</span>&nbsp;<span class="string" id="6251742">&#34;no&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files&nbsp;in&nbsp;&#34;</span>&nbsp;<span class="op" id="6251777">+</span>&nbsp;<span class="ident" id="6251779">e</span><span class="op" id="6251780">.</span><span class="ident" id="6251781">Dir</span><br>
<span class="lineno"></span><span class="op" id="6251785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="6251788">//&nbsp;MultiplePackageError&nbsp;describes&nbsp;a&nbsp;directory&nbsp;containing</span><br>
<span class="lineno"></span><span class="comment" id="6251845">//&nbsp;multiple&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files&nbsp;for&nbsp;multiple&nbsp;packages.</span><br>
<span class="lineno"></span><span class="keyword" id="6251906">type</span>&nbsp;<span class="ident" id="6251911">MultiplePackageError</span>&nbsp;<span class="keyword" id="6251932">struct</span>&nbsp;<span class="op" id="6251939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251942">Dir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6251951">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6251960">//&nbsp;directory&nbsp;containing&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251991">Packages</span>&nbsp;<span class="op" id="6252000">[</span><span class="op" id="6252001">]</span><span class="builtintype" id="6252002">string</span>&nbsp;<span class="comment" id="6252009">//&nbsp;package&nbsp;names&nbsp;found</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6252033">Files</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6252042">[</span><span class="op" id="6252043">]</span><span class="builtintype" id="6252044">string</span>&nbsp;<span class="comment" id="6252051">//&nbsp;corresponding&nbsp;files:&nbsp;Files[i]&nbsp;declares&nbsp;package&nbsp;Packages[i]</span><br>
<span class="lineno"></span><span class="op" id="6252113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6252116">func</span>&nbsp;<span class="op" id="6252121">(</span><span class="ident" id="6252122">e</span>&nbsp;<span class="op" id="6252124">*</span><span class="ident" id="6252125">MultiplePackageError</span><span class="op" id="6252145">)</span>&nbsp;<span class="ident" id="6252147">Error</span><span class="op" id="6252152">(</span><span class="op" id="6252153">)</span>&nbsp;<span class="builtintype" id="6252155">string</span>&nbsp;<span class="op" id="6252162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6252165">//&nbsp;Error&nbsp;string&nbsp;limited&nbsp;to&nbsp;two&nbsp;entries&nbsp;for&nbsp;compatibility.</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6252224">return</span>&nbsp;<span class="ident" id="6252231">fmt</span><span class="op" id="6252234">.</span><span class="ident" id="6252235">Sprintf</span><span class="op" id="6252242">(</span><span class="string" id="6252243">&#34;found&nbsp;packages&nbsp;%s&nbsp;(%s)&nbsp;and&nbsp;%s&nbsp;(%s)&nbsp;in&nbsp;%s&#34;</span><span class="op" id="6252285">,</span>&nbsp;<span class="ident" id="6252287">e</span><span class="op" id="6252288">.</span><span class="ident" id="6252289">Packages</span><span class="op" id="6252297">[</span><span class="num" id="6252298">0</span><span class="op" id="6252299">]</span><span class="op" id="6252300">,</span>&nbsp;<span class="ident" id="6252302">e</span><span class="op" id="6252303">.</span><span class="ident" id="6252304">Files</span><span class="op" id="6252309">[</span><span class="num" id="6252310">0</span><span class="op" id="6252311">]</span><span class="op" id="6252312">,</span>&nbsp;<span class="ident" id="6252314">e</span><span class="op" id="6252315">.</span><span class="ident" id="6252316">Packages</span><span class="op" id="6252324">[</span><span class="num" id="6252325">1</span><span class="op" id="6252326">]</span><span class="op" id="6252327">,</span>&nbsp;<span class="ident" id="6252329">e</span><span class="op" id="6252330">.</span><span class="ident" id="6252331">Files</span><span class="op" id="6252336">[</span><span class="num" id="6252337">1</span><span class="op" id="6252338">]</span><span class="op" id="6252339">,</span>&nbsp;<span class="ident" id="6252341">e</span><span class="op" id="6252342">.</span><span class="ident" id="6252343">Dir</span><span class="op" id="6252346">)</span><br>
<span class="lineno"></span><span class="op" id="6252348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6252351">func</span>&nbsp;<span class="ident" id="6252356">nameExt</span><span class="op" id="6252363">(</span><span class="ident" id="6252364">name</span>&nbsp;<span class="builtintype" id="6252369">string</span><span class="op" id="6252375">)</span>&nbsp;<span class="builtintype" id="6252377">string</span>&nbsp;<span class="op" id="6252384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6252387">i</span>&nbsp;<span class="op" id="6252389">:=</span>&nbsp;<span class="ident" id="6252392">strings</span><span class="op" id="6252399">.</span><span class="ident" id="6252400">LastIndex</span><span class="op" id="6252409">(</span><span class="ident" id="6252410">name</span><span class="op" id="6252414">,</span>&nbsp;<span class="string" id="6252416">&#34;.&#34;</span><span class="op" id="6252419">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6252422">if</span>&nbsp;<span class="ident" id="6252425">i</span>&nbsp;<span class="op" id="6252427">&lt;</span>&nbsp;<span class="num" id="6252429">0</span>&nbsp;<span class="op" id="6252431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6252435">return</span>&nbsp;<span class="string" id="6252442">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6252446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6252449">return</span>&nbsp;<span class="ident" id="6252456">name</span><span class="op" id="6252460">[</span><span class="ident" id="6252461">i</span><span class="op" id="6252462">:</span><span class="op" id="6252463">]</span><br>
<span class="lineno"></span><span class="op" id="6252465">}</span><br>
<span class="lineno">440</span><br>
<span class="lineno"></span><span class="comment" id="6252468">//&nbsp;Import&nbsp;returns&nbsp;details&nbsp;about&nbsp;the&nbsp;Go&nbsp;package&nbsp;named&nbsp;by&nbsp;the&nbsp;import&nbsp;path,</span><br>
<span class="lineno"></span><span class="comment" id="6252541">//&nbsp;interpreting&nbsp;local&nbsp;import&nbsp;paths&nbsp;relative&nbsp;to&nbsp;the&nbsp;srcDir&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="6252610">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;a&nbsp;local&nbsp;import&nbsp;path&nbsp;naming&nbsp;a&nbsp;package&nbsp;that&nbsp;can&nbsp;be&nbsp;imported</span><br>
<span class="lineno"></span><span class="comment" id="6252686">//&nbsp;using&nbsp;a&nbsp;standard&nbsp;import&nbsp;path,&nbsp;the&nbsp;returned&nbsp;package&nbsp;will&nbsp;set&nbsp;p.ImportPath</span><br>
<span class="lineno">445</span><span class="comment" id="6252762">//&nbsp;to&nbsp;that&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="6252779">//</span><br>
<span class="lineno"></span><span class="comment" id="6252782">//&nbsp;In&nbsp;the&nbsp;directory&nbsp;containing&nbsp;the&nbsp;package,&nbsp;.go,&nbsp;.c,&nbsp;.h,&nbsp;and&nbsp;.s&nbsp;files&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="6252856">//&nbsp;considered&nbsp;part&nbsp;of&nbsp;the&nbsp;package&nbsp;except&nbsp;for:</span><br>
<span class="lineno"></span><span class="comment" id="6252902">//</span><br>
<span class="lineno">450</span><span class="comment" id="6252905">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;.go&nbsp;files&nbsp;in&nbsp;package&nbsp;documentation</span><br>
<span class="lineno"></span><span class="comment" id="6252945">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;files&nbsp;starting&nbsp;with&nbsp;_&nbsp;or&nbsp;.&nbsp;(likely&nbsp;editor&nbsp;temporary&nbsp;files)</span><br>
<span class="lineno"></span><span class="comment" id="6253009">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;files&nbsp;with&nbsp;build&nbsp;constraints&nbsp;not&nbsp;satisfied&nbsp;by&nbsp;the&nbsp;context</span><br>
<span class="lineno"></span><span class="comment" id="6253072">//</span><br>
<span class="lineno"></span><span class="comment" id="6253075">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;Import&nbsp;returns&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;and&nbsp;a&nbsp;non-nil</span><br>
<span class="lineno">455</span><span class="comment" id="6253143">//&nbsp;*Package&nbsp;containing&nbsp;partial&nbsp;information.</span><br>
<span class="lineno"></span><span class="comment" id="6253187">//</span><br>
<span class="lineno"></span><span class="keyword" id="6253190">func</span>&nbsp;<span class="op" id="6253195">(</span><span class="ident" id="6253196">ctxt</span>&nbsp;<span class="op" id="6253201">*</span><span class="ident" id="6253202">Context</span><span class="op" id="6253209">)</span>&nbsp;<span class="ident" id="6253211">Import</span><span class="op" id="6253217">(</span><span class="ident" id="6253218">path</span>&nbsp;<span class="builtintype" id="6253223">string</span><span class="op" id="6253229">,</span>&nbsp;<span class="ident" id="6253231">srcDir</span>&nbsp;<span class="builtintype" id="6253238">string</span><span class="op" id="6253244">,</span>&nbsp;<span class="ident" id="6253246">mode</span>&nbsp;<span class="ident" id="6253251">ImportMode</span><span class="op" id="6253261">)</span>&nbsp;<span class="op" id="6253263">(</span><span class="op" id="6253264">*</span><span class="ident" id="6253265">Package</span><span class="op" id="6253272">,</span>&nbsp;<span class="builtintype" id="6253274">error</span><span class="op" id="6253279">)</span>&nbsp;<span class="op" id="6253281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253284">p</span>&nbsp;<span class="op" id="6253286">:=</span>&nbsp;<span class="op" id="6253289">&amp;</span><span class="ident" id="6253290">Package</span><span class="op" id="6253297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253301">ImportPath</span><span class="op" id="6253311">:</span>&nbsp;<span class="ident" id="6253313">path</span><span class="op" id="6253317">,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6253320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253323">if</span>&nbsp;<span class="ident" id="6253326">path</span>&nbsp;<span class="op" id="6253331">==</span>&nbsp;<span class="string" id="6253334">&#34;&#34;</span>&nbsp;<span class="op" id="6253337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253341">return</span>&nbsp;<span class="ident" id="6253348">p</span><span class="op" id="6253349">,</span>&nbsp;<span class="ident" id="6253351">fmt</span><span class="op" id="6253354">.</span><span class="ident" id="6253355">Errorf</span><span class="op" id="6253361">(</span><span class="string" id="6253362">&#34;import&nbsp;%q:&nbsp;invalid&nbsp;import&nbsp;path&#34;</span><span class="op" id="6253394">,</span>&nbsp;<span class="ident" id="6253396">path</span><span class="op" id="6253400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6253403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253407">var</span>&nbsp;<span class="ident" id="6253411">pkga</span>&nbsp;<span class="builtintype" id="6253416">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253424">var</span>&nbsp;<span class="ident" id="6253428">pkgerr</span>&nbsp;<span class="builtintype" id="6253435">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253442">switch</span>&nbsp;<span class="ident" id="6253449">ctxt</span><span class="op" id="6253453">.</span><span class="ident" id="6253454">Compiler</span>&nbsp;<span class="op" id="6253463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253466">case</span>&nbsp;<span class="string" id="6253471">&#34;gccgo&#34;</span><span class="op" id="6253478">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253482">dir</span><span class="op" id="6253485">,</span>&nbsp;<span class="ident" id="6253487">elem</span>&nbsp;<span class="op" id="6253492">:=</span>&nbsp;<span class="ident" id="6253495">pathpkg</span><span class="op" id="6253502">.</span><span class="ident" id="6253503">Split</span><span class="op" id="6253508">(</span><span class="ident" id="6253509">p</span><span class="op" id="6253510">.</span><span class="ident" id="6253511">ImportPath</span><span class="op" id="6253521">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253525">pkga</span>&nbsp;<span class="op" id="6253530">=</span>&nbsp;<span class="string" id="6253532">&#34;pkg/gccgo_&#34;</span>&nbsp;<span class="op" id="6253545">+</span>&nbsp;<span class="ident" id="6253547">ctxt</span><span class="op" id="6253551">.</span><span class="ident" id="6253552">GOOS</span>&nbsp;<span class="op" id="6253557">+</span>&nbsp;<span class="string" id="6253559">&#34;_&#34;</span>&nbsp;<span class="op" id="6253563">+</span>&nbsp;<span class="ident" id="6253565">ctxt</span><span class="op" id="6253569">.</span><span class="ident" id="6253570">GOARCH</span>&nbsp;<span class="op" id="6253577">+</span>&nbsp;<span class="string" id="6253579">&#34;/&#34;</span>&nbsp;<span class="op" id="6253583">+</span>&nbsp;<span class="ident" id="6253585">dir</span>&nbsp;<span class="op" id="6253589">+</span>&nbsp;<span class="string" id="6253591">&#34;lib&#34;</span>&nbsp;<span class="op" id="6253597">+</span>&nbsp;<span class="ident" id="6253599">elem</span>&nbsp;<span class="op" id="6253604">+</span>&nbsp;<span class="string" id="6253606">&#34;.a&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253612">case</span>&nbsp;<span class="string" id="6253617">&#34;gc&#34;</span><span class="op" id="6253621">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253625">suffix</span>&nbsp;<span class="op" id="6253632">:=</span>&nbsp;<span class="string" id="6253635">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253640">if</span>&nbsp;<span class="ident" id="6253643">ctxt</span><span class="op" id="6253647">.</span><span class="ident" id="6253648">InstallSuffix</span>&nbsp;<span class="op" id="6253662">!=</span>&nbsp;<span class="string" id="6253665">&#34;&#34;</span>&nbsp;<span class="op" id="6253668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253673">suffix</span>&nbsp;<span class="op" id="6253680">=</span>&nbsp;<span class="string" id="6253682">&#34;_&#34;</span>&nbsp;<span class="op" id="6253686">+</span>&nbsp;<span class="ident" id="6253688">ctxt</span><span class="op" id="6253692">.</span><span class="ident" id="6253693">InstallSuffix</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6253709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253713">pkga</span>&nbsp;<span class="op" id="6253718">=</span>&nbsp;<span class="string" id="6253720">&#34;pkg/&#34;</span>&nbsp;<span class="op" id="6253727">+</span>&nbsp;<span class="ident" id="6253729">ctxt</span><span class="op" id="6253733">.</span><span class="ident" id="6253734">GOOS</span>&nbsp;<span class="op" id="6253739">+</span>&nbsp;<span class="string" id="6253741">&#34;_&#34;</span>&nbsp;<span class="op" id="6253745">+</span>&nbsp;<span class="ident" id="6253747">ctxt</span><span class="op" id="6253751">.</span><span class="ident" id="6253752">GOARCH</span>&nbsp;<span class="op" id="6253759">+</span>&nbsp;<span class="ident" id="6253761">suffix</span>&nbsp;<span class="op" id="6253768">+</span>&nbsp;<span class="string" id="6253770">&#34;/&#34;</span>&nbsp;<span class="op" id="6253774">+</span>&nbsp;<span class="ident" id="6253776">p</span><span class="op" id="6253777">.</span><span class="ident" id="6253778">ImportPath</span>&nbsp;<span class="op" id="6253789">+</span>&nbsp;<span class="string" id="6253791">&#34;.a&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253797">default</span><span class="op" id="6253804">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6253808">//&nbsp;Save&nbsp;error&nbsp;for&nbsp;end&nbsp;of&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253845">pkgerr</span>&nbsp;<span class="op" id="6253852">=</span>&nbsp;<span class="ident" id="6253854">fmt</span><span class="op" id="6253857">.</span><span class="ident" id="6253858">Errorf</span><span class="op" id="6253864">(</span><span class="string" id="6253865">&#34;import&nbsp;%q:&nbsp;unknown&nbsp;compiler&nbsp;%q&#34;</span><span class="op" id="6253897">,</span>&nbsp;<span class="ident" id="6253899">path</span><span class="op" id="6253903">,</span>&nbsp;<span class="ident" id="6253905">ctxt</span><span class="op" id="6253909">.</span><span class="ident" id="6253910">Compiler</span><span class="op" id="6253918">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6253921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253925">binaryOnly</span>&nbsp;<span class="op" id="6253936">:=</span>&nbsp;<span class="builtintype" id="6253939">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253946">if</span>&nbsp;<span class="ident" id="6253949">IsLocalImport</span><span class="op" id="6253962">(</span><span class="ident" id="6253963">path</span><span class="op" id="6253967">)</span>&nbsp;<span class="op" id="6253969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253973">pkga</span>&nbsp;<span class="op" id="6253978">=</span>&nbsp;<span class="string" id="6253980">&#34;&#34;</span>&nbsp;<span class="comment" id="6253983">//&nbsp;local&nbsp;imports&nbsp;have&nbsp;no&nbsp;installed&nbsp;path</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254025">if</span>&nbsp;<span class="ident" id="6254028">srcDir</span>&nbsp;<span class="op" id="6254035">==</span>&nbsp;<span class="string" id="6254038">&#34;&#34;</span>&nbsp;<span class="op" id="6254041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254046">return</span>&nbsp;<span class="ident" id="6254053">p</span><span class="op" id="6254054">,</span>&nbsp;<span class="ident" id="6254056">fmt</span><span class="op" id="6254059">.</span><span class="ident" id="6254060">Errorf</span><span class="op" id="6254066">(</span><span class="string" id="6254067">&#34;import&nbsp;%q:&nbsp;import&nbsp;relative&nbsp;to&nbsp;unknown&nbsp;directory&#34;</span><span class="op" id="6254116">,</span>&nbsp;<span class="ident" id="6254118">path</span><span class="op" id="6254122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6254126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254130">if</span>&nbsp;<span class="op" id="6254133">!</span><span class="ident" id="6254134">ctxt</span><span class="op" id="6254138">.</span><span class="ident" id="6254139">isAbsPath</span><span class="op" id="6254148">(</span><span class="ident" id="6254149">path</span><span class="op" id="6254153">)</span>&nbsp;<span class="op" id="6254155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6254160">p</span><span class="op" id="6254161">.</span><span class="ident" id="6254162">Dir</span>&nbsp;<span class="op" id="6254166">=</span>&nbsp;<span class="ident" id="6254168">ctxt</span><span class="op" id="6254172">.</span><span class="ident" id="6254173">joinPath</span><span class="op" id="6254181">(</span><span class="ident" id="6254182">srcDir</span><span class="op" id="6254188">,</span>&nbsp;<span class="ident" id="6254190">path</span><span class="op" id="6254194">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6254198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6254202">//&nbsp;Determine&nbsp;canonical&nbsp;import&nbsp;path,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254248">if</span>&nbsp;<span class="ident" id="6254251">ctxt</span><span class="op" id="6254255">.</span><span class="ident" id="6254256">GOROOT</span>&nbsp;<span class="op" id="6254263">!=</span>&nbsp;<span class="string" id="6254266">&#34;&#34;</span>&nbsp;<span class="op" id="6254269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6254274">root</span>&nbsp;<span class="op" id="6254279">:=</span>&nbsp;<span class="ident" id="6254282">ctxt</span><span class="op" id="6254286">.</span><span class="ident" id="6254287">joinPath</span><span class="op" id="6254295">(</span><span class="ident" id="6254296">ctxt</span><span class="op" id="6254300">.</span><span class="ident" id="6254301">GOROOT</span><span class="op" id="6254307">,</span>&nbsp;<span class="string" id="6254309">&#34;src&#34;</span><span class="op" id="6254314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254319">if</span>&nbsp;<span class="ident" id="6254322">sub</span><span class="op" id="6254325">,</span>&nbsp;<span class="ident" id="6254327">ok</span>&nbsp;<span class="op" id="6254330">:=</span>&nbsp;<span class="ident" id="6254333">ctxt</span><span class="op" id="6254337">.</span><span class="ident" id="6254338">hasSubdir</span><span class="op" id="6254347">(</span><span class="ident" id="6254348">root</span><span class="op" id="6254352">,</span>&nbsp;<span class="ident" id="6254354">p</span><span class="op" id="6254355">.</span><span class="ident" id="6254356">Dir</span><span class="op" id="6254359">)</span><span class="op" id="6254360">;</span>&nbsp;<span class="ident" id="6254362">ok</span>&nbsp;<span class="op" id="6254365">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6254371">p</span><span class="op" id="6254372">.</span><span class="ident" id="6254373">Goroot</span>&nbsp;<span class="op" id="6254380">=</span>&nbsp;<span class="builtintype" id="6254382">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6254391">p</span><span class="op" id="6254392">.</span><span class="ident" id="6254393">ImportPath</span>&nbsp;<span class="op" id="6254404">=</span>&nbsp;<span class="ident" id="6254406">sub</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6254414">p</span><span class="op" id="6254415">.</span><span class="ident" id="6254416">Root</span>&nbsp;<span class="op" id="6254421">=</span>&nbsp;<span class="ident" id="6254423">ctxt</span><span class="op" id="6254427">.</span><span class="ident" id="6254428">GOROOT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254439">goto</span>&nbsp;<span class="ident" id="6254444">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6254453">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6254457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6254461">all</span>&nbsp;<span class="op" id="6254465">:=</span>&nbsp;<span class="ident" id="6254468">ctxt</span><span class="op" id="6254472">.</span><span class="ident" id="6254473">gopath</span><span class="op" id="6254479">(</span><span class="op" id="6254480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254484">for</span>&nbsp;<span class="ident" id="6254488">i</span><span class="op" id="6254489">,</span>&nbsp;<span class="ident" id="6254491">root</span>&nbsp;<span class="op" id="6254496">:=</span>&nbsp;<span class="keyword" id="6254499">range</span>&nbsp;<span class="ident" id="6254505">all</span>&nbsp;<span class="op" id="6254509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6254514">rootsrc</span>&nbsp;<span class="op" id="6254522">:=</span>&nbsp;<span class="ident" id="6254525">ctxt</span><span class="op" id="6254529">.</span><span class="ident" id="6254530">joinPath</span><span class="op" id="6254538">(</span><span class="ident" id="6254539">root</span><span class="op" id="6254543">,</span>&nbsp;<span class="string" id="6254545">&#34;src&#34;</span><span class="op" id="6254550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254555">if</span>&nbsp;<span class="ident" id="6254558">sub</span><span class="op" id="6254561">,</span>&nbsp;<span class="ident" id="6254563">ok</span>&nbsp;<span class="op" id="6254566">:=</span>&nbsp;<span class="ident" id="6254569">ctxt</span><span class="op" id="6254573">.</span><span class="ident" id="6254574">hasSubdir</span><span class="op" id="6254583">(</span><span class="ident" id="6254584">rootsrc</span><span class="op" id="6254591">,</span>&nbsp;<span class="ident" id="6254593">p</span><span class="op" id="6254594">.</span><span class="ident" id="6254595">Dir</span><span class="op" id="6254598">)</span><span class="op" id="6254599">;</span>&nbsp;<span class="ident" id="6254601">ok</span>&nbsp;<span class="op" id="6254604">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6254610">//&nbsp;We&nbsp;found&nbsp;a&nbsp;potential&nbsp;import&nbsp;path&nbsp;for&nbsp;dir,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6254659">//&nbsp;but&nbsp;check&nbsp;that&nbsp;using&nbsp;it&nbsp;wouldn&#39;t&nbsp;find&nbsp;something</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6254714">//&nbsp;else&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254733">if</span>&nbsp;<span class="ident" id="6254736">ctxt</span><span class="op" id="6254740">.</span><span class="ident" id="6254741">GOROOT</span>&nbsp;<span class="op" id="6254748">!=</span>&nbsp;<span class="string" id="6254751">&#34;&#34;</span>&nbsp;<span class="op" id="6254754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254761">if</span>&nbsp;<span class="ident" id="6254764">dir</span>&nbsp;<span class="op" id="6254768">:=</span>&nbsp;<span class="ident" id="6254771">ctxt</span><span class="op" id="6254775">.</span><span class="ident" id="6254776">joinPath</span><span class="op" id="6254784">(</span><span class="ident" id="6254785">ctxt</span><span class="op" id="6254789">.</span><span class="ident" id="6254790">GOROOT</span><span class="op" id="6254796">,</span>&nbsp;<span class="string" id="6254798">&#34;src&#34;</span><span class="op" id="6254803">,</span>&nbsp;<span class="ident" id="6254805">sub</span><span class="op" id="6254808">)</span><span class="op" id="6254809">;</span>&nbsp;<span class="ident" id="6254811">ctxt</span><span class="op" id="6254815">.</span><span class="ident" id="6254816">isDir</span><span class="op" id="6254821">(</span><span class="ident" id="6254822">dir</span><span class="op" id="6254825">)</span>&nbsp;<span class="op" id="6254827">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6254835">p</span><span class="op" id="6254836">.</span><span class="ident" id="6254837">ConflictDir</span>&nbsp;<span class="op" id="6254849">=</span>&nbsp;<span class="ident" id="6254851">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254861">goto</span>&nbsp;<span class="ident" id="6254866">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6254877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6254883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254889">for</span>&nbsp;<span class="ident" id="6254893">_</span><span class="op" id="6254894">,</span>&nbsp;<span class="ident" id="6254896">earlyRoot</span>&nbsp;<span class="op" id="6254906">:=</span>&nbsp;<span class="keyword" id="6254909">range</span>&nbsp;<span class="ident" id="6254915">all</span><span class="op" id="6254918">[</span><span class="op" id="6254919">:</span><span class="ident" id="6254920">i</span><span class="op" id="6254921">]</span>&nbsp;<span class="op" id="6254923">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254930">if</span>&nbsp;<span class="ident" id="6254933">dir</span>&nbsp;<span class="op" id="6254937">:=</span>&nbsp;<span class="ident" id="6254940">ctxt</span><span class="op" id="6254944">.</span><span class="ident" id="6254945">joinPath</span><span class="op" id="6254953">(</span><span class="ident" id="6254954">earlyRoot</span><span class="op" id="6254963">,</span>&nbsp;<span class="string" id="6254965">&#34;src&#34;</span><span class="op" id="6254970">,</span>&nbsp;<span class="ident" id="6254972">sub</span><span class="op" id="6254975">)</span><span class="op" id="6254976">;</span>&nbsp;<span class="ident" id="6254978">ctxt</span><span class="op" id="6254982">.</span><span class="ident" id="6254983">isDir</span><span class="op" id="6254988">(</span><span class="ident" id="6254989">dir</span><span class="op" id="6254992">)</span>&nbsp;<span class="op" id="6254994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255002">p</span><span class="op" id="6255003">.</span><span class="ident" id="6255004">ConflictDir</span>&nbsp;<span class="op" id="6255016">=</span>&nbsp;<span class="ident" id="6255018">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6255028">goto</span>&nbsp;<span class="ident" id="6255033">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6255044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6255050">}</span><br>
<span class="lineno">520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6255057">//&nbsp;sub&nbsp;would&nbsp;not&nbsp;name&nbsp;some&nbsp;other&nbsp;directory&nbsp;instead&nbsp;of&nbsp;this&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6255125">//&nbsp;Record&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255143">p</span><span class="op" id="6255144">.</span><span class="ident" id="6255145">ImportPath</span>&nbsp;<span class="op" id="6255156">=</span>&nbsp;<span class="ident" id="6255158">sub</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255166">p</span><span class="op" id="6255167">.</span><span class="ident" id="6255168">Root</span>&nbsp;<span class="op" id="6255173">=</span>&nbsp;<span class="ident" id="6255175">root</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6255184">goto</span>&nbsp;<span class="ident" id="6255189">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6255198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6255202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6255206">//&nbsp;It&#39;s&nbsp;okay&nbsp;that&nbsp;we&nbsp;didn&#39;t&nbsp;find&nbsp;a&nbsp;root&nbsp;containing&nbsp;dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6255264">//&nbsp;Keep&nbsp;going&nbsp;with&nbsp;the&nbsp;information&nbsp;we&nbsp;have.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6255309">}</span>&nbsp;<span class="keyword" id="6255311">else</span>&nbsp;<span class="op" id="6255316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6255320">if</span>&nbsp;<span class="ident" id="6255323">strings</span><span class="op" id="6255330">.</span><span class="ident" id="6255331">HasPrefix</span><span class="op" id="6255340">(</span><span class="ident" id="6255341">path</span><span class="op" id="6255345">,</span>&nbsp;<span class="string" id="6255347">&#34;/&#34;</span><span class="op" id="6255350">)</span>&nbsp;<span class="op" id="6255352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6255357">return</span>&nbsp;<span class="ident" id="6255364">p</span><span class="op" id="6255365">,</span>&nbsp;<span class="ident" id="6255367">fmt</span><span class="op" id="6255370">.</span><span class="ident" id="6255371">Errorf</span><span class="op" id="6255377">(</span><span class="string" id="6255378">&#34;import&nbsp;%q:&nbsp;cannot&nbsp;import&nbsp;absolute&nbsp;path&#34;</span><span class="op" id="6255418">,</span>&nbsp;<span class="ident" id="6255420">path</span><span class="op" id="6255424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6255428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6255433">//&nbsp;tried&nbsp;records&nbsp;the&nbsp;location&nbsp;of&nbsp;unsuccessful&nbsp;package&nbsp;lookups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6255497">var</span>&nbsp;<span class="ident" id="6255501">tried</span>&nbsp;<span class="keyword" id="6255507">struct</span>&nbsp;<span class="op" id="6255514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255519">goroot</span>&nbsp;<span class="builtintype" id="6255526">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255536">gopath</span>&nbsp;<span class="op" id="6255543">[</span><span class="op" id="6255544">]</span><span class="builtintype" id="6255545">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6255554">}</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6255559">//&nbsp;Determine&nbsp;directory&nbsp;from&nbsp;import&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6255602">if</span>&nbsp;<span class="ident" id="6255605">ctxt</span><span class="op" id="6255609">.</span><span class="ident" id="6255610">GOROOT</span>&nbsp;<span class="op" id="6255617">!=</span>&nbsp;<span class="string" id="6255620">&#34;&#34;</span>&nbsp;<span class="op" id="6255623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255628">dir</span>&nbsp;<span class="op" id="6255632">:=</span>&nbsp;<span class="ident" id="6255635">ctxt</span><span class="op" id="6255639">.</span><span class="ident" id="6255640">joinPath</span><span class="op" id="6255648">(</span><span class="ident" id="6255649">ctxt</span><span class="op" id="6255653">.</span><span class="ident" id="6255654">GOROOT</span><span class="op" id="6255660">,</span>&nbsp;<span class="string" id="6255662">&#34;src&#34;</span><span class="op" id="6255667">,</span>&nbsp;<span class="ident" id="6255669">path</span><span class="op" id="6255673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255678">isDir</span>&nbsp;<span class="op" id="6255684">:=</span>&nbsp;<span class="ident" id="6255687">ctxt</span><span class="op" id="6255691">.</span><span class="ident" id="6255692">isDir</span><span class="op" id="6255697">(</span><span class="ident" id="6255698">dir</span><span class="op" id="6255701">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255706">binaryOnly</span>&nbsp;<span class="op" id="6255717">=</span>&nbsp;<span class="op" id="6255719">!</span><span class="ident" id="6255720">isDir</span>&nbsp;<span class="op" id="6255726">&amp;&amp;</span>&nbsp;<span class="ident" id="6255729">mode</span><span class="op" id="6255733">&amp;</span><span class="ident" id="6255734">AllowBinary</span>&nbsp;<span class="op" id="6255746">!=</span>&nbsp;<span class="num" id="6255749">0</span>&nbsp;<span class="op" id="6255751">&amp;&amp;</span>&nbsp;<span class="ident" id="6255754">pkga</span>&nbsp;<span class="op" id="6255759">!=</span>&nbsp;<span class="string" id="6255762">&#34;&#34;</span>&nbsp;<span class="op" id="6255765">&amp;&amp;</span>&nbsp;<span class="ident" id="6255768">ctxt</span><span class="op" id="6255772">.</span><span class="ident" id="6255773">isFile</span><span class="op" id="6255779">(</span><span class="ident" id="6255780">ctxt</span><span class="op" id="6255784">.</span><span class="ident" id="6255785">joinPath</span><span class="op" id="6255793">(</span><span class="ident" id="6255794">ctxt</span><span class="op" id="6255798">.</span><span class="ident" id="6255799">GOROOT</span><span class="op" id="6255805">,</span>&nbsp;<span class="ident" id="6255807">pkga</span><span class="op" id="6255811">)</span><span class="op" id="6255812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6255817">if</span>&nbsp;<span class="ident" id="6255820">isDir</span>&nbsp;<span class="op" id="6255826">||</span>&nbsp;<span class="ident" id="6255829">binaryOnly</span>&nbsp;<span class="op" id="6255840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255846">p</span><span class="op" id="6255847">.</span><span class="ident" id="6255848">Dir</span>&nbsp;<span class="op" id="6255852">=</span>&nbsp;<span class="ident" id="6255854">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255862">p</span><span class="op" id="6255863">.</span><span class="ident" id="6255864">Goroot</span>&nbsp;<span class="op" id="6255871">=</span>&nbsp;<span class="builtintype" id="6255873">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255882">p</span><span class="op" id="6255883">.</span><span class="ident" id="6255884">Root</span>&nbsp;<span class="op" id="6255889">=</span>&nbsp;<span class="ident" id="6255891">ctxt</span><span class="op" id="6255895">.</span><span class="ident" id="6255896">GOROOT</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6255907">goto</span>&nbsp;<span class="ident" id="6255912">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6255921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255926">tried</span><span class="op" id="6255931">.</span><span class="ident" id="6255932">goroot</span>&nbsp;<span class="op" id="6255939">=</span>&nbsp;<span class="ident" id="6255941">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6255947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6255951">for</span>&nbsp;<span class="ident" id="6255955">_</span><span class="op" id="6255956">,</span>&nbsp;<span class="ident" id="6255958">root</span>&nbsp;<span class="op" id="6255963">:=</span>&nbsp;<span class="keyword" id="6255966">range</span>&nbsp;<span class="ident" id="6255972">ctxt</span><span class="op" id="6255976">.</span><span class="ident" id="6255977">gopath</span><span class="op" id="6255983">(</span><span class="op" id="6255984">)</span>&nbsp;<span class="op" id="6255986">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255991">dir</span>&nbsp;<span class="op" id="6255995">:=</span>&nbsp;<span class="ident" id="6255998">ctxt</span><span class="op" id="6256002">.</span><span class="ident" id="6256003">joinPath</span><span class="op" id="6256011">(</span><span class="ident" id="6256012">root</span><span class="op" id="6256016">,</span>&nbsp;<span class="string" id="6256018">&#34;src&#34;</span><span class="op" id="6256023">,</span>&nbsp;<span class="ident" id="6256025">path</span><span class="op" id="6256029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6256034">isDir</span>&nbsp;<span class="op" id="6256040">:=</span>&nbsp;<span class="ident" id="6256043">ctxt</span><span class="op" id="6256047">.</span><span class="ident" id="6256048">isDir</span><span class="op" id="6256053">(</span><span class="ident" id="6256054">dir</span><span class="op" id="6256057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6256062">binaryOnly</span>&nbsp;<span class="op" id="6256073">=</span>&nbsp;<span class="op" id="6256075">!</span><span class="ident" id="6256076">isDir</span>&nbsp;<span class="op" id="6256082">&amp;&amp;</span>&nbsp;<span class="ident" id="6256085">mode</span><span class="op" id="6256089">&amp;</span><span class="ident" id="6256090">AllowBinary</span>&nbsp;<span class="op" id="6256102">!=</span>&nbsp;<span class="num" id="6256105">0</span>&nbsp;<span class="op" id="6256107">&amp;&amp;</span>&nbsp;<span class="ident" id="6256110">pkga</span>&nbsp;<span class="op" id="6256115">!=</span>&nbsp;<span class="string" id="6256118">&#34;&#34;</span>&nbsp;<span class="op" id="6256121">&amp;&amp;</span>&nbsp;<span class="ident" id="6256124">ctxt</span><span class="op" id="6256128">.</span><span class="ident" id="6256129">isFile</span><span class="op" id="6256135">(</span><span class="ident" id="6256136">ctxt</span><span class="op" id="6256140">.</span><span class="ident" id="6256141">joinPath</span><span class="op" id="6256149">(</span><span class="ident" id="6256150">root</span><span class="op" id="6256154">,</span>&nbsp;<span class="ident" id="6256156">pkga</span><span class="op" id="6256160">)</span><span class="op" id="6256161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6256166">if</span>&nbsp;<span class="ident" id="6256169">isDir</span>&nbsp;<span class="op" id="6256175">||</span>&nbsp;<span class="ident" id="6256178">binaryOnly</span>&nbsp;<span class="op" id="6256189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6256195">p</span><span class="op" id="6256196">.</span><span class="ident" id="6256197">Dir</span>&nbsp;<span class="op" id="6256201">=</span>&nbsp;<span class="ident" id="6256203">dir</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6256211">p</span><span class="op" id="6256212">.</span><span class="ident" id="6256213">Root</span>&nbsp;<span class="op" id="6256218">=</span>&nbsp;<span class="ident" id="6256220">root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6256229">goto</span>&nbsp;<span class="ident" id="6256234">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6256243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6256248">tried</span><span class="op" id="6256253">.</span><span class="ident" id="6256254">gopath</span>&nbsp;<span class="op" id="6256261">=</span>&nbsp;<span class="builtinfunc" id="6256263">append</span><span class="op" id="6256269">(</span><span class="ident" id="6256270">tried</span><span class="op" id="6256275">.</span><span class="ident" id="6256276">gopath</span><span class="op" id="6256282">,</span>&nbsp;<span class="ident" id="6256284">dir</span><span class="op" id="6256287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6256291">}</span><br>
<span class="lineno">565</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6256296">//&nbsp;package&nbsp;was&nbsp;not&nbsp;found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6256323">var</span>&nbsp;<span class="ident" id="6256327">paths</span>&nbsp;<span class="op" id="6256333">[</span><span class="op" id="6256334">]</span><span class="builtintype" id="6256335">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6256344">if</span>&nbsp;<span class="ident" id="6256347">tried</span><span class="op" id="6256352">.</span><span class="ident" id="6256353">goroot</span>&nbsp;<span class="op" id="6256360">!=</span>&nbsp;<span class="string" id="6256363">&#34;&#34;</span>&nbsp;<span class="op" id="6256366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6256371">paths</span>&nbsp;<span class="op" id="6256377">=</span>&nbsp;<span class="builtinfunc" id="6256379">append</span><span class="op" id="6256385">(</span><span class="ident" id="6256386">paths</span><span class="op" id="6256391">,</span>&nbsp;<span class="ident" id="6256393">fmt</span><span class="op" id="6256396">.</span><span class="ident" id="6256397">Sprintf</span><span class="op" id="6256404">(</span><span class="string" id="6256405">&#34;\t%s&nbsp;(from&nbsp;$GOROOT)&#34;</span><span class="op" id="6256426">,</span>&nbsp;<span class="ident" id="6256428">tried</span><span class="op" id="6256433">.</span><span class="ident" id="6256434">goroot</span><span class="op" id="6256440">)</span><span class="op" id="6256441">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6256445">}</span>&nbsp;<span class="keyword" id="6256447">else</span>&nbsp;<span class="op" id="6256452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6256457">paths</span>&nbsp;<span class="op" id="6256463">=</span>&nbsp;<span class="builtinfunc" id="6256465">append</span><span class="op" id="6256471">(</span><span class="ident" id="6256472">paths</span><span class="op" id="6256477">,</span>&nbsp;<span class="string" id="6256479">&#34;\t($GOROOT&nbsp;not&nbsp;set)&#34;</span><span class="op" id="6256500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6256504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6256508">var</span>&nbsp;<span class="ident" id="6256512">i</span>&nbsp;<span class="builtintype" id="6256514">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6256520">var</span>&nbsp;<span class="ident" id="6256524">format</span>&nbsp;<span class="op" id="6256531">=</span>&nbsp;<span class="string" id="6256533">&#34;\t%s&nbsp;(from&nbsp;$GOPATH)&#34;</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6256557">for</span>&nbsp;<span class="op" id="6256561">;</span>&nbsp;<span class="ident" id="6256563">i</span>&nbsp;<span class="op" id="6256565">&lt;</span>&nbsp;<span class="builtinfunc" id="6256567">len</span><span class="op" id="6256570">(</span><span class="ident" id="6256571">tried</span><span class="op" id="6256576">.</span><span class="ident" id="6256577">gopath</span><span class="op" id="6256583">)</span><span class="op" id="6256584">;</span>&nbsp;<span class="ident" id="6256586">i</span><span class="op" id="6256587">++</span>&nbsp;<span class="op" id="6256590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6256595">if</span>&nbsp;<span class="ident" id="6256598">i</span>&nbsp;<span class="op" id="6256600">&gt;</span>&nbsp;<span class="num" id="6256602">0</span>&nbsp;<span class="op" id="6256604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6256610">format</span>&nbsp;<span class="op" id="6256617">=</span>&nbsp;<span class="string" id="6256619">&#34;\t%s&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6256629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6256634">paths</span>&nbsp;<span class="op" id="6256640">=</span>&nbsp;<span class="builtinfunc" id="6256642">append</span><span class="op" id="6256648">(</span><span class="ident" id="6256649">paths</span><span class="op" id="6256654">,</span>&nbsp;<span class="ident" id="6256656">fmt</span><span class="op" id="6256659">.</span><span class="ident" id="6256660">Sprintf</span><span class="op" id="6256667">(</span><span class="ident" id="6256668">format</span><span class="op" id="6256674">,</span>&nbsp;<span class="ident" id="6256676">tried</span><span class="op" id="6256681">.</span><span class="ident" id="6256682">gopath</span><span class="op" id="6256688">[</span><span class="ident" id="6256689">i</span><span class="op" id="6256690">]</span><span class="op" id="6256691">)</span><span class="op" id="6256692">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6256696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6256700">if</span>&nbsp;<span class="ident" id="6256703">i</span>&nbsp;<span class="op" id="6256705">==</span>&nbsp;<span class="num" id="6256708">0</span>&nbsp;<span class="op" id="6256710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6256715">paths</span>&nbsp;<span class="op" id="6256721">=</span>&nbsp;<span class="builtinfunc" id="6256723">append</span><span class="op" id="6256729">(</span><span class="ident" id="6256730">paths</span><span class="op" id="6256735">,</span>&nbsp;<span class="string" id="6256737">&#34;\t($GOPATH&nbsp;not&nbsp;set)&#34;</span><span class="op" id="6256758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6256762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6256766">return</span>&nbsp;<span class="ident" id="6256773">p</span><span class="op" id="6256774">,</span>&nbsp;<span class="ident" id="6256776">fmt</span><span class="op" id="6256779">.</span><span class="ident" id="6256780">Errorf</span><span class="op" id="6256786">(</span><span class="string" id="6256787">&#34;cannot&nbsp;find&nbsp;package&nbsp;%q&nbsp;in&nbsp;any&nbsp;of:\n%s&#34;</span><span class="op" id="6256826">,</span>&nbsp;<span class="ident" id="6256828">path</span><span class="op" id="6256832">,</span>&nbsp;<span class="ident" id="6256834">strings</span><span class="op" id="6256841">.</span><span class="ident" id="6256842">Join</span><span class="op" id="6256846">(</span><span class="ident" id="6256847">paths</span><span class="op" id="6256852">,</span>&nbsp;<span class="string" id="6256854">&#34;\n&#34;</span><span class="op" id="6256858">)</span><span class="op" id="6256859">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6256862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="6256865">Found</span><span class="op" id="6256870">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6256873">if</span>&nbsp;<span class="ident" id="6256876">p</span><span class="op" id="6256877">.</span><span class="ident" id="6256878">Root</span>&nbsp;<span class="op" id="6256883">!=</span>&nbsp;<span class="string" id="6256886">&#34;&#34;</span>&nbsp;<span class="op" id="6256889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6256893">p</span><span class="op" id="6256894">.</span><span class="ident" id="6256895">SrcRoot</span>&nbsp;<span class="op" id="6256903">=</span>&nbsp;<span class="ident" id="6256905">ctxt</span><span class="op" id="6256909">.</span><span class="ident" id="6256910">joinPath</span><span class="op" id="6256918">(</span><span class="ident" id="6256919">p</span><span class="op" id="6256920">.</span><span class="ident" id="6256921">Root</span><span class="op" id="6256925">,</span>&nbsp;<span class="string" id="6256927">&#34;src&#34;</span><span class="op" id="6256932">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6256936">p</span><span class="op" id="6256937">.</span><span class="ident" id="6256938">PkgRoot</span>&nbsp;<span class="op" id="6256946">=</span>&nbsp;<span class="ident" id="6256948">ctxt</span><span class="op" id="6256952">.</span><span class="ident" id="6256953">joinPath</span><span class="op" id="6256961">(</span><span class="ident" id="6256962">p</span><span class="op" id="6256963">.</span><span class="ident" id="6256964">Root</span><span class="op" id="6256968">,</span>&nbsp;<span class="string" id="6256970">&#34;pkg&#34;</span><span class="op" id="6256975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6256979">p</span><span class="op" id="6256980">.</span><span class="ident" id="6256981">BinDir</span>&nbsp;<span class="op" id="6256988">=</span>&nbsp;<span class="ident" id="6256990">ctxt</span><span class="op" id="6256994">.</span><span class="ident" id="6256995">joinPath</span><span class="op" id="6257003">(</span><span class="ident" id="6257004">p</span><span class="op" id="6257005">.</span><span class="ident" id="6257006">Root</span><span class="op" id="6257010">,</span>&nbsp;<span class="string" id="6257012">&#34;bin&#34;</span><span class="op" id="6257017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257021">if</span>&nbsp;<span class="ident" id="6257024">pkga</span>&nbsp;<span class="op" id="6257029">!=</span>&nbsp;<span class="string" id="6257032">&#34;&#34;</span>&nbsp;<span class="op" id="6257035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6257040">p</span><span class="op" id="6257041">.</span><span class="ident" id="6257042">PkgObj</span>&nbsp;<span class="op" id="6257049">=</span>&nbsp;<span class="ident" id="6257051">ctxt</span><span class="op" id="6257055">.</span><span class="ident" id="6257056">joinPath</span><span class="op" id="6257064">(</span><span class="ident" id="6257065">p</span><span class="op" id="6257066">.</span><span class="ident" id="6257067">Root</span><span class="op" id="6257071">,</span>&nbsp;<span class="ident" id="6257073">pkga</span><span class="op" id="6257077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6257081">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6257084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257088">if</span>&nbsp;<span class="ident" id="6257091">mode</span><span class="op" id="6257095">&amp;</span><span class="ident" id="6257096">FindOnly</span>&nbsp;<span class="op" id="6257105">!=</span>&nbsp;<span class="num" id="6257108">0</span>&nbsp;<span class="op" id="6257110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257114">return</span>&nbsp;<span class="ident" id="6257121">p</span><span class="op" id="6257122">,</span>&nbsp;<span class="ident" id="6257124">pkgerr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6257132">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257135">if</span>&nbsp;<span class="ident" id="6257138">binaryOnly</span>&nbsp;<span class="op" id="6257149">&amp;&amp;</span>&nbsp;<span class="op" id="6257152">(</span><span class="ident" id="6257153">mode</span><span class="op" id="6257157">&amp;</span><span class="ident" id="6257158">AllowBinary</span><span class="op" id="6257169">)</span>&nbsp;<span class="op" id="6257171">!=</span>&nbsp;<span class="num" id="6257174">0</span>&nbsp;<span class="op" id="6257176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257180">return</span>&nbsp;<span class="ident" id="6257187">p</span><span class="op" id="6257188">,</span>&nbsp;<span class="ident" id="6257190">pkgerr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6257198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6257202">dirs</span><span class="op" id="6257206">,</span>&nbsp;<span class="ident" id="6257208">err</span>&nbsp;<span class="op" id="6257212">:=</span>&nbsp;<span class="ident" id="6257215">ctxt</span><span class="op" id="6257219">.</span><span class="ident" id="6257220">readDir</span><span class="op" id="6257227">(</span><span class="ident" id="6257228">p</span><span class="op" id="6257229">.</span><span class="ident" id="6257230">Dir</span><span class="op" id="6257233">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257236">if</span>&nbsp;<span class="ident" id="6257239">err</span>&nbsp;<span class="op" id="6257243">!=</span>&nbsp;<span class="ident" id="6257246">nil</span>&nbsp;<span class="op" id="6257250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257254">return</span>&nbsp;<span class="ident" id="6257261">p</span><span class="op" id="6257262">,</span>&nbsp;<span class="ident" id="6257264">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6257269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257273">var</span>&nbsp;<span class="ident" id="6257277">Sfiles</span>&nbsp;<span class="op" id="6257284">[</span><span class="op" id="6257285">]</span><span class="builtintype" id="6257286">string</span>&nbsp;<span class="comment" id="6257293">//&nbsp;files&nbsp;with&nbsp;&#34;.S&#34;&nbsp;(capital&nbsp;S)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257325">var</span>&nbsp;<span class="ident" id="6257329">firstFile</span><span class="op" id="6257338">,</span>&nbsp;<span class="ident" id="6257340">firstCommentFile</span>&nbsp;<span class="builtintype" id="6257357">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6257365">imported</span>&nbsp;<span class="op" id="6257374">:=</span>&nbsp;<span class="builtinfunc" id="6257377">make</span><span class="op" id="6257381">(</span><span class="keyword" id="6257382">map</span><span class="op" id="6257385">[</span><span class="builtintype" id="6257386">string</span><span class="op" id="6257392">]</span><span class="op" id="6257393">[</span><span class="op" id="6257394">]</span><span class="ident" id="6257395">token</span><span class="op" id="6257400">.</span><span class="ident" id="6257401">Position</span><span class="op" id="6257409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6257412">testImported</span>&nbsp;<span class="op" id="6257425">:=</span>&nbsp;<span class="builtinfunc" id="6257428">make</span><span class="op" id="6257432">(</span><span class="keyword" id="6257433">map</span><span class="op" id="6257436">[</span><span class="builtintype" id="6257437">string</span><span class="op" id="6257443">]</span><span class="op" id="6257444">[</span><span class="op" id="6257445">]</span><span class="ident" id="6257446">token</span><span class="op" id="6257451">.</span><span class="ident" id="6257452">Position</span><span class="op" id="6257460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6257463">xTestImported</span>&nbsp;<span class="op" id="6257477">:=</span>&nbsp;<span class="builtinfunc" id="6257480">make</span><span class="op" id="6257484">(</span><span class="keyword" id="6257485">map</span><span class="op" id="6257488">[</span><span class="builtintype" id="6257489">string</span><span class="op" id="6257495">]</span><span class="op" id="6257496">[</span><span class="op" id="6257497">]</span><span class="ident" id="6257498">token</span><span class="op" id="6257503">.</span><span class="ident" id="6257504">Position</span><span class="op" id="6257512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6257515">allTags</span>&nbsp;<span class="op" id="6257523">:=</span>&nbsp;<span class="builtinfunc" id="6257526">make</span><span class="op" id="6257530">(</span><span class="keyword" id="6257531">map</span><span class="op" id="6257534">[</span><span class="builtintype" id="6257535">string</span><span class="op" id="6257541">]</span><span class="builtintype" id="6257542">bool</span><span class="op" id="6257546">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6257549">fset</span>&nbsp;<span class="op" id="6257554">:=</span>&nbsp;<span class="ident" id="6257557">token</span><span class="op" id="6257562">.</span><span class="ident" id="6257563">NewFileSet</span><span class="op" id="6257573">(</span><span class="op" id="6257574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257577">for</span>&nbsp;<span class="ident" id="6257581">_</span><span class="op" id="6257582">,</span>&nbsp;<span class="ident" id="6257584">d</span>&nbsp;<span class="op" id="6257586">:=</span>&nbsp;<span class="keyword" id="6257589">range</span>&nbsp;<span class="ident" id="6257595">dirs</span>&nbsp;<span class="op" id="6257600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257604">if</span>&nbsp;<span class="ident" id="6257607">d</span><span class="op" id="6257608">.</span><span class="ident" id="6257609">IsDir</span><span class="op" id="6257614">(</span><span class="op" id="6257615">)</span>&nbsp;<span class="op" id="6257617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257622">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6257633">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6257638">name</span>&nbsp;<span class="op" id="6257643">:=</span>&nbsp;<span class="ident" id="6257646">d</span><span class="op" id="6257647">.</span><span class="ident" id="6257648">Name</span><span class="op" id="6257652">(</span><span class="op" id="6257653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6257657">ext</span>&nbsp;<span class="op" id="6257661">:=</span>&nbsp;<span class="ident" id="6257664">nameExt</span><span class="op" id="6257671">(</span><span class="ident" id="6257672">name</span><span class="op" id="6257676">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6257681">match</span><span class="op" id="6257686">,</span>&nbsp;<span class="ident" id="6257688">data</span><span class="op" id="6257692">,</span>&nbsp;<span class="ident" id="6257694">filename</span><span class="op" id="6257702">,</span>&nbsp;<span class="ident" id="6257704">err</span>&nbsp;<span class="op" id="6257708">:=</span>&nbsp;<span class="ident" id="6257711">ctxt</span><span class="op" id="6257715">.</span><span class="ident" id="6257716">matchFile</span><span class="op" id="6257725">(</span><span class="ident" id="6257726">p</span><span class="op" id="6257727">.</span><span class="ident" id="6257728">Dir</span><span class="op" id="6257731">,</span>&nbsp;<span class="ident" id="6257733">name</span><span class="op" id="6257737">,</span>&nbsp;<span class="builtintype" id="6257739">true</span><span class="op" id="6257743">,</span>&nbsp;<span class="ident" id="6257745">allTags</span><span class="op" id="6257752">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257756">if</span>&nbsp;<span class="ident" id="6257759">err</span>&nbsp;<span class="op" id="6257763">!=</span>&nbsp;<span class="ident" id="6257766">nil</span>&nbsp;<span class="op" id="6257770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257775">return</span>&nbsp;<span class="ident" id="6257782">p</span><span class="op" id="6257783">,</span>&nbsp;<span class="ident" id="6257785">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6257791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257795">if</span>&nbsp;<span class="op" id="6257798">!</span><span class="ident" id="6257799">match</span>&nbsp;<span class="op" id="6257805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257810">if</span>&nbsp;<span class="ident" id="6257813">ext</span>&nbsp;<span class="op" id="6257817">==</span>&nbsp;<span class="string" id="6257820">&#34;.go&#34;</span>&nbsp;<span class="op" id="6257826">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6257832">p</span><span class="op" id="6257833">.</span><span class="ident" id="6257834">IgnoredGoFiles</span>&nbsp;<span class="op" id="6257849">=</span>&nbsp;<span class="builtinfunc" id="6257851">append</span><span class="op" id="6257857">(</span><span class="ident" id="6257858">p</span><span class="op" id="6257859">.</span><span class="ident" id="6257860">IgnoredGoFiles</span><span class="op" id="6257874">,</span>&nbsp;<span class="ident" id="6257876">name</span><span class="op" id="6257880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6257885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257890">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6257901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6257906">//&nbsp;Going&nbsp;to&nbsp;save&nbsp;the&nbsp;file.&nbsp;&nbsp;For&nbsp;non-Go&nbsp;files,&nbsp;can&nbsp;stop&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257969">switch</span>&nbsp;<span class="ident" id="6257976">ext</span>&nbsp;<span class="op" id="6257980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257984">case</span>&nbsp;<span class="string" id="6257989">&#34;.c&#34;</span><span class="op" id="6257993">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6257998">p</span><span class="op" id="6257999">.</span><span class="ident" id="6258000">CFiles</span>&nbsp;<span class="op" id="6258007">=</span>&nbsp;<span class="builtinfunc" id="6258009">append</span><span class="op" id="6258015">(</span><span class="ident" id="6258016">p</span><span class="op" id="6258017">.</span><span class="ident" id="6258018">CFiles</span><span class="op" id="6258024">,</span>&nbsp;<span class="ident" id="6258026">name</span><span class="op" id="6258030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258035">continue</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258046">case</span>&nbsp;<span class="string" id="6258051">&#34;.cc&#34;</span><span class="op" id="6258056">,</span>&nbsp;<span class="string" id="6258058">&#34;.cpp&#34;</span><span class="op" id="6258064">,</span>&nbsp;<span class="string" id="6258066">&#34;.cxx&#34;</span><span class="op" id="6258072">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6258077">p</span><span class="op" id="6258078">.</span><span class="ident" id="6258079">CXXFiles</span>&nbsp;<span class="op" id="6258088">=</span>&nbsp;<span class="builtinfunc" id="6258090">append</span><span class="op" id="6258096">(</span><span class="ident" id="6258097">p</span><span class="op" id="6258098">.</span><span class="ident" id="6258099">CXXFiles</span><span class="op" id="6258107">,</span>&nbsp;<span class="ident" id="6258109">name</span><span class="op" id="6258113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258118">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258129">case</span>&nbsp;<span class="string" id="6258134">&#34;.m&#34;</span><span class="op" id="6258138">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6258143">p</span><span class="op" id="6258144">.</span><span class="ident" id="6258145">MFiles</span>&nbsp;<span class="op" id="6258152">=</span>&nbsp;<span class="builtinfunc" id="6258154">append</span><span class="op" id="6258160">(</span><span class="ident" id="6258161">p</span><span class="op" id="6258162">.</span><span class="ident" id="6258163">MFiles</span><span class="op" id="6258169">,</span>&nbsp;<span class="ident" id="6258171">name</span><span class="op" id="6258175">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258180">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258191">case</span>&nbsp;<span class="string" id="6258196">&#34;.h&#34;</span><span class="op" id="6258200">,</span>&nbsp;<span class="string" id="6258202">&#34;.hh&#34;</span><span class="op" id="6258207">,</span>&nbsp;<span class="string" id="6258209">&#34;.hpp&#34;</span><span class="op" id="6258215">,</span>&nbsp;<span class="string" id="6258217">&#34;.hxx&#34;</span><span class="op" id="6258223">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6258228">p</span><span class="op" id="6258229">.</span><span class="ident" id="6258230">HFiles</span>&nbsp;<span class="op" id="6258237">=</span>&nbsp;<span class="builtinfunc" id="6258239">append</span><span class="op" id="6258245">(</span><span class="ident" id="6258246">p</span><span class="op" id="6258247">.</span><span class="ident" id="6258248">HFiles</span><span class="op" id="6258254">,</span>&nbsp;<span class="ident" id="6258256">name</span><span class="op" id="6258260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258265">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258276">case</span>&nbsp;<span class="string" id="6258281">&#34;.s&#34;</span><span class="op" id="6258285">:</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6258290">p</span><span class="op" id="6258291">.</span><span class="ident" id="6258292">SFiles</span>&nbsp;<span class="op" id="6258299">=</span>&nbsp;<span class="builtinfunc" id="6258301">append</span><span class="op" id="6258307">(</span><span class="ident" id="6258308">p</span><span class="op" id="6258309">.</span><span class="ident" id="6258310">SFiles</span><span class="op" id="6258316">,</span>&nbsp;<span class="ident" id="6258318">name</span><span class="op" id="6258322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258327">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258338">case</span>&nbsp;<span class="string" id="6258343">&#34;.S&#34;</span><span class="op" id="6258347">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6258352">Sfiles</span>&nbsp;<span class="op" id="6258359">=</span>&nbsp;<span class="builtinfunc" id="6258361">append</span><span class="op" id="6258367">(</span><span class="ident" id="6258368">Sfiles</span><span class="op" id="6258374">,</span>&nbsp;<span class="ident" id="6258376">name</span><span class="op" id="6258380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258385">continue</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258396">case</span>&nbsp;<span class="string" id="6258401">&#34;.swig&#34;</span><span class="op" id="6258408">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6258413">p</span><span class="op" id="6258414">.</span><span class="ident" id="6258415">SwigFiles</span>&nbsp;<span class="op" id="6258425">=</span>&nbsp;<span class="builtinfunc" id="6258427">append</span><span class="op" id="6258433">(</span><span class="ident" id="6258434">p</span><span class="op" id="6258435">.</span><span class="ident" id="6258436">SwigFiles</span><span class="op" id="6258445">,</span>&nbsp;<span class="ident" id="6258447">name</span><span class="op" id="6258451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258456">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258467">case</span>&nbsp;<span class="string" id="6258472">&#34;.swigcxx&#34;</span><span class="op" id="6258482">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6258487">p</span><span class="op" id="6258488">.</span><span class="ident" id="6258489">SwigCXXFiles</span>&nbsp;<span class="op" id="6258502">=</span>&nbsp;<span class="builtinfunc" id="6258504">append</span><span class="op" id="6258510">(</span><span class="ident" id="6258511">p</span><span class="op" id="6258512">.</span><span class="ident" id="6258513">SwigCXXFiles</span><span class="op" id="6258525">,</span>&nbsp;<span class="ident" id="6258527">name</span><span class="op" id="6258531">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258536">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258547">case</span>&nbsp;<span class="string" id="6258552">&#34;.syso&#34;</span><span class="op" id="6258559">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6258564">//&nbsp;binary&nbsp;objects&nbsp;to&nbsp;add&nbsp;to&nbsp;package&nbsp;archive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6258611">//&nbsp;Likely&nbsp;of&nbsp;the&nbsp;form&nbsp;foo_windows.syso,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6258658">//&nbsp;the&nbsp;name&nbsp;was&nbsp;vetted&nbsp;above&nbsp;with&nbsp;goodOSArchFile.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6258711">p</span><span class="op" id="6258712">.</span><span class="ident" id="6258713">SysoFiles</span>&nbsp;<span class="op" id="6258723">=</span>&nbsp;<span class="builtinfunc" id="6258725">append</span><span class="op" id="6258731">(</span><span class="ident" id="6258732">p</span><span class="op" id="6258733">.</span><span class="ident" id="6258734">SysoFiles</span><span class="op" id="6258743">,</span>&nbsp;<span class="ident" id="6258745">name</span><span class="op" id="6258749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258754">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6258765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6258770">pf</span><span class="op" id="6258772">,</span>&nbsp;<span class="ident" id="6258774">err</span>&nbsp;<span class="op" id="6258778">:=</span>&nbsp;<span class="ident" id="6258781">parser</span><span class="op" id="6258787">.</span><span class="ident" id="6258788">ParseFile</span><span class="op" id="6258797">(</span><span class="ident" id="6258798">fset</span><span class="op" id="6258802">,</span>&nbsp;<span class="ident" id="6258804">filename</span><span class="op" id="6258812">,</span>&nbsp;<span class="ident" id="6258814">data</span><span class="op" id="6258818">,</span>&nbsp;<span class="ident" id="6258820">parser</span><span class="op" id="6258826">.</span><span class="ident" id="6258827">ImportsOnly</span><span class="op" id="6258838">|</span><span class="ident" id="6258839">parser</span><span class="op" id="6258845">.</span><span class="ident" id="6258846">ParseComments</span><span class="op" id="6258859">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258863">if</span>&nbsp;<span class="ident" id="6258866">err</span>&nbsp;<span class="op" id="6258870">!=</span>&nbsp;<span class="ident" id="6258873">nil</span>&nbsp;<span class="op" id="6258877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258882">return</span>&nbsp;<span class="ident" id="6258889">p</span><span class="op" id="6258890">,</span>&nbsp;<span class="ident" id="6258892">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6258898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6258903">pkg</span>&nbsp;<span class="op" id="6258907">:=</span>&nbsp;<span class="ident" id="6258910">pf</span><span class="op" id="6258912">.</span><span class="ident" id="6258913">Name</span><span class="op" id="6258917">.</span><span class="ident" id="6258918">Name</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258925">if</span>&nbsp;<span class="ident" id="6258928">pkg</span>&nbsp;<span class="op" id="6258932">==</span>&nbsp;<span class="string" id="6258935">&#34;documentation&#34;</span>&nbsp;<span class="op" id="6258951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6258956">p</span><span class="op" id="6258957">.</span><span class="ident" id="6258958">IgnoredGoFiles</span>&nbsp;<span class="op" id="6258973">=</span>&nbsp;<span class="builtinfunc" id="6258975">append</span><span class="op" id="6258981">(</span><span class="ident" id="6258982">p</span><span class="op" id="6258983">.</span><span class="ident" id="6258984">IgnoredGoFiles</span><span class="op" id="6258998">,</span>&nbsp;<span class="ident" id="6259000">name</span><span class="op" id="6259004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6259009">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6259020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6259025">isTest</span>&nbsp;<span class="op" id="6259032">:=</span>&nbsp;<span class="ident" id="6259035">strings</span><span class="op" id="6259042">.</span><span class="ident" id="6259043">HasSuffix</span><span class="op" id="6259052">(</span><span class="ident" id="6259053">name</span><span class="op" id="6259057">,</span>&nbsp;<span class="string" id="6259059">&#34;_test.go&#34;</span><span class="op" id="6259069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6259073">isXTest</span>&nbsp;<span class="op" id="6259081">:=</span>&nbsp;<span class="builtintype" id="6259084">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6259092">if</span>&nbsp;<span class="ident" id="6259095">isTest</span>&nbsp;<span class="op" id="6259102">&amp;&amp;</span>&nbsp;<span class="ident" id="6259105">strings</span><span class="op" id="6259112">.</span><span class="ident" id="6259113">HasSuffix</span><span class="op" id="6259122">(</span><span class="ident" id="6259123">pkg</span><span class="op" id="6259126">,</span>&nbsp;<span class="string" id="6259128">&#34;_test&#34;</span><span class="op" id="6259135">)</span>&nbsp;<span class="op" id="6259137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6259142">isXTest</span>&nbsp;<span class="op" id="6259150">=</span>&nbsp;<span class="builtintype" id="6259152">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6259160">pkg</span>&nbsp;<span class="op" id="6259164">=</span>&nbsp;<span class="ident" id="6259166">pkg</span><span class="op" id="6259169">[</span><span class="op" id="6259170">:</span><span class="builtinfunc" id="6259171">len</span><span class="op" id="6259174">(</span><span class="ident" id="6259175">pkg</span><span class="op" id="6259178">)</span><span class="op" id="6259179">-</span><span class="builtinfunc" id="6259180">len</span><span class="op" id="6259183">(</span><span class="string" id="6259184">&#34;_test&#34;</span><span class="op" id="6259191">)</span><span class="op" id="6259192">]</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6259196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6259201">if</span>&nbsp;<span class="ident" id="6259204">p</span><span class="op" id="6259205">.</span><span class="ident" id="6259206">Name</span>&nbsp;<span class="op" id="6259211">==</span>&nbsp;<span class="string" id="6259214">&#34;&#34;</span>&nbsp;<span class="op" id="6259217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6259222">p</span><span class="op" id="6259223">.</span><span class="ident" id="6259224">Name</span>&nbsp;<span class="op" id="6259229">=</span>&nbsp;<span class="ident" id="6259231">pkg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6259238">firstFile</span>&nbsp;<span class="op" id="6259248">=</span>&nbsp;<span class="ident" id="6259250">name</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6259257">}</span>&nbsp;<span class="keyword" id="6259259">else</span>&nbsp;<span class="keyword" id="6259264">if</span>&nbsp;<span class="ident" id="6259267">pkg</span>&nbsp;<span class="op" id="6259271">!=</span>&nbsp;<span class="ident" id="6259274">p</span><span class="op" id="6259275">.</span><span class="ident" id="6259276">Name</span>&nbsp;<span class="op" id="6259281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6259286">return</span>&nbsp;<span class="ident" id="6259293">p</span><span class="op" id="6259294">,</span>&nbsp;<span class="op" id="6259296">&amp;</span><span class="ident" id="6259297">MultiplePackageError</span><span class="op" id="6259317">{</span><span class="ident" id="6259318">p</span><span class="op" id="6259319">.</span><span class="ident" id="6259320">Dir</span><span class="op" id="6259323">,</span>&nbsp;<span class="op" id="6259325">[</span><span class="op" id="6259326">]</span><span class="builtintype" id="6259327">string</span><span class="op" id="6259333">{</span><span class="ident" id="6259334">firstFile</span><span class="op" id="6259343">,</span>&nbsp;<span class="ident" id="6259345">name</span><span class="op" id="6259349">}</span><span class="op" id="6259350">,</span>&nbsp;<span class="op" id="6259352">[</span><span class="op" id="6259353">]</span><span class="builtintype" id="6259354">string</span><span class="op" id="6259360">{</span><span class="ident" id="6259361">p</span><span class="op" id="6259362">.</span><span class="ident" id="6259363">Name</span><span class="op" id="6259367">,</span>&nbsp;<span class="ident" id="6259369">pkg</span><span class="op" id="6259372">}</span><span class="op" id="6259373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6259377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6259381">if</span>&nbsp;<span class="ident" id="6259384">pf</span><span class="op" id="6259386">.</span><span class="ident" id="6259387">Doc</span>&nbsp;<span class="op" id="6259391">!=</span>&nbsp;<span class="ident" id="6259394">nil</span>&nbsp;<span class="op" id="6259398">&amp;&amp;</span>&nbsp;<span class="ident" id="6259401">p</span><span class="op" id="6259402">.</span><span class="ident" id="6259403">Doc</span>&nbsp;<span class="op" id="6259407">==</span>&nbsp;<span class="string" id="6259410">&#34;&#34;</span>&nbsp;<span class="op" id="6259413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6259418">p</span><span class="op" id="6259419">.</span><span class="ident" id="6259420">Doc</span>&nbsp;<span class="op" id="6259424">=</span>&nbsp;<span class="ident" id="6259426">doc</span><span class="op" id="6259429">.</span><span class="ident" id="6259430">Synopsis</span><span class="op" id="6259438">(</span><span class="ident" id="6259439">pf</span><span class="op" id="6259441">.</span><span class="ident" id="6259442">Doc</span><span class="op" id="6259445">.</span><span class="ident" id="6259446">Text</span><span class="op" id="6259450">(</span><span class="op" id="6259451">)</span><span class="op" id="6259452">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6259456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6259461">if</span>&nbsp;<span class="ident" id="6259464">mode</span><span class="op" id="6259468">&amp;</span><span class="ident" id="6259469">ImportComment</span>&nbsp;<span class="op" id="6259483">!=</span>&nbsp;<span class="num" id="6259486">0</span>&nbsp;<span class="op" id="6259488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6259493">qcom</span><span class="op" id="6259497">,</span>&nbsp;<span class="ident" id="6259499">line</span>&nbsp;<span class="op" id="6259504">:=</span>&nbsp;<span class="ident" id="6259507">findImportComment</span><span class="op" id="6259524">(</span><span class="ident" id="6259525">data</span><span class="op" id="6259529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6259534">if</span>&nbsp;<span class="ident" id="6259537">line</span>&nbsp;<span class="op" id="6259542">!=</span>&nbsp;<span class="num" id="6259545">0</span>&nbsp;<span class="op" id="6259547">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6259553">com</span><span class="op" id="6259556">,</span>&nbsp;<span class="ident" id="6259558">err</span>&nbsp;<span class="op" id="6259562">:=</span>&nbsp;<span class="ident" id="6259565">strconv</span><span class="op" id="6259572">.</span><span class="ident" id="6259573">Unquote</span><span class="op" id="6259580">(</span><span class="ident" id="6259581">qcom</span><span class="op" id="6259585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6259591">if</span>&nbsp;<span class="ident" id="6259594">err</span>&nbsp;<span class="op" id="6259598">!=</span>&nbsp;<span class="ident" id="6259601">nil</span>&nbsp;<span class="op" id="6259605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6259612">return</span>&nbsp;<span class="ident" id="6259619">p</span><span class="op" id="6259620">,</span>&nbsp;<span class="ident" id="6259622">fmt</span><span class="op" id="6259625">.</span><span class="ident" id="6259626">Errorf</span><span class="op" id="6259632">(</span><span class="string" id="6259633">&#34;%s:%d:&nbsp;cannot&nbsp;parse&nbsp;import&nbsp;comment&#34;</span><span class="op" id="6259669">,</span>&nbsp;<span class="ident" id="6259671">filename</span><span class="op" id="6259679">,</span>&nbsp;<span class="ident" id="6259681">line</span><span class="op" id="6259685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6259691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6259697">if</span>&nbsp;<span class="ident" id="6259700">p</span><span class="op" id="6259701">.</span><span class="ident" id="6259702">ImportComment</span>&nbsp;<span class="op" id="6259716">==</span>&nbsp;<span class="string" id="6259719">&#34;&#34;</span>&nbsp;<span class="op" id="6259722">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6259729">p</span><span class="op" id="6259730">.</span><span class="ident" id="6259731">ImportComment</span>&nbsp;<span class="op" id="6259745">=</span>&nbsp;<span class="ident" id="6259747">com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6259756">firstCommentFile</span>&nbsp;<span class="op" id="6259773">=</span>&nbsp;<span class="ident" id="6259775">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6259784">}</span>&nbsp;<span class="keyword" id="6259786">else</span>&nbsp;<span class="keyword" id="6259791">if</span>&nbsp;<span class="ident" id="6259794">p</span><span class="op" id="6259795">.</span><span class="ident" id="6259796">ImportComment</span>&nbsp;<span class="op" id="6259810">!=</span>&nbsp;<span class="ident" id="6259813">com</span>&nbsp;<span class="op" id="6259817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6259824">return</span>&nbsp;<span class="ident" id="6259831">p</span><span class="op" id="6259832">,</span>&nbsp;<span class="ident" id="6259834">fmt</span><span class="op" id="6259837">.</span><span class="ident" id="6259838">Errorf</span><span class="op" id="6259844">(</span><span class="string" id="6259845">&#34;found&nbsp;import&nbsp;comments&nbsp;%q&nbsp;(%s)&nbsp;and&nbsp;%q&nbsp;(%s)&nbsp;in&nbsp;%s&#34;</span><span class="op" id="6259894">,</span>&nbsp;<span class="ident" id="6259896">p</span><span class="op" id="6259897">.</span><span class="ident" id="6259898">ImportComment</span><span class="op" id="6259911">,</span>&nbsp;<span class="ident" id="6259913">firstCommentFile</span><span class="op" id="6259929">,</span>&nbsp;<span class="ident" id="6259931">com</span><span class="op" id="6259934">,</span>&nbsp;<span class="ident" id="6259936">name</span><span class="op" id="6259940">,</span>&nbsp;<span class="ident" id="6259942">p</span><span class="op" id="6259943">.</span><span class="ident" id="6259944">Dir</span><span class="op" id="6259947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6259953">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6259958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6259962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6259967">//&nbsp;Record&nbsp;imports&nbsp;and&nbsp;information&nbsp;about&nbsp;cgo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6260014">isCgo</span>&nbsp;<span class="op" id="6260020">:=</span>&nbsp;<span class="builtintype" id="6260023">false</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6260031">for</span>&nbsp;<span class="ident" id="6260035">_</span><span class="op" id="6260036">,</span>&nbsp;<span class="ident" id="6260038">decl</span>&nbsp;<span class="op" id="6260043">:=</span>&nbsp;<span class="keyword" id="6260046">range</span>&nbsp;<span class="ident" id="6260052">pf</span><span class="op" id="6260054">.</span><span class="ident" id="6260055">Decls</span>&nbsp;<span class="op" id="6260061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6260066">d</span><span class="op" id="6260067">,</span>&nbsp;<span class="ident" id="6260069">ok</span>&nbsp;<span class="op" id="6260072">:=</span>&nbsp;<span class="ident" id="6260075">decl</span><span class="op" id="6260079">.</span><span class="op" id="6260080">(</span><span class="op" id="6260081">*</span><span class="ident" id="6260082">ast</span><span class="op" id="6260085">.</span><span class="ident" id="6260086">GenDecl</span><span class="op" id="6260093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6260098">if</span>&nbsp;<span class="op" id="6260101">!</span><span class="ident" id="6260102">ok</span>&nbsp;<span class="op" id="6260105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6260111">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6260123">}</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6260128">for</span>&nbsp;<span class="ident" id="6260132">_</span><span class="op" id="6260133">,</span>&nbsp;<span class="ident" id="6260135">dspec</span>&nbsp;<span class="op" id="6260141">:=</span>&nbsp;<span class="keyword" id="6260144">range</span>&nbsp;<span class="ident" id="6260150">d</span><span class="op" id="6260151">.</span><span class="ident" id="6260152">Specs</span>&nbsp;<span class="op" id="6260158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6260164">spec</span><span class="op" id="6260168">,</span>&nbsp;<span class="ident" id="6260170">ok</span>&nbsp;<span class="op" id="6260173">:=</span>&nbsp;<span class="ident" id="6260176">dspec</span><span class="op" id="6260181">.</span><span class="op" id="6260182">(</span><span class="op" id="6260183">*</span><span class="ident" id="6260184">ast</span><span class="op" id="6260187">.</span><span class="ident" id="6260188">ImportSpec</span><span class="op" id="6260198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6260204">if</span>&nbsp;<span class="op" id="6260207">!</span><span class="ident" id="6260208">ok</span>&nbsp;<span class="op" id="6260211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6260218">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6260231">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6260237">quoted</span>&nbsp;<span class="op" id="6260244">:=</span>&nbsp;<span class="ident" id="6260247">spec</span><span class="op" id="6260251">.</span><span class="ident" id="6260252">Path</span><span class="op" id="6260256">.</span><span class="ident" id="6260257">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6260267">path</span><span class="op" id="6260271">,</span>&nbsp;<span class="ident" id="6260273">err</span>&nbsp;<span class="op" id="6260277">:=</span>&nbsp;<span class="ident" id="6260280">strconv</span><span class="op" id="6260287">.</span><span class="ident" id="6260288">Unquote</span><span class="op" id="6260295">(</span><span class="ident" id="6260296">quoted</span><span class="op" id="6260302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6260308">if</span>&nbsp;<span class="ident" id="6260311">err</span>&nbsp;<span class="op" id="6260315">!=</span>&nbsp;<span class="ident" id="6260318">nil</span>&nbsp;<span class="op" id="6260322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6260329">log</span><span class="op" id="6260332">.</span><span class="ident" id="6260333">Panicf</span><span class="op" id="6260339">(</span><span class="string" id="6260340">&#34;%s:&nbsp;parser&nbsp;returned&nbsp;invalid&nbsp;quoted&nbsp;string:&nbsp;&lt;%s&gt;&#34;</span><span class="op" id="6260389">,</span>&nbsp;<span class="ident" id="6260391">filename</span><span class="op" id="6260399">,</span>&nbsp;<span class="ident" id="6260401">quoted</span><span class="op" id="6260407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6260413">}</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6260419">if</span>&nbsp;<span class="ident" id="6260422">isXTest</span>&nbsp;<span class="op" id="6260430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6260437">xTestImported</span><span class="op" id="6260450">[</span><span class="ident" id="6260451">path</span><span class="op" id="6260455">]</span>&nbsp;<span class="op" id="6260457">=</span>&nbsp;<span class="builtinfunc" id="6260459">append</span><span class="op" id="6260465">(</span><span class="ident" id="6260466">xTestImported</span><span class="op" id="6260479">[</span><span class="ident" id="6260480">path</span><span class="op" id="6260484">]</span><span class="op" id="6260485">,</span>&nbsp;<span class="ident" id="6260487">fset</span><span class="op" id="6260491">.</span><span class="ident" id="6260492">Position</span><span class="op" id="6260500">(</span><span class="ident" id="6260501">spec</span><span class="op" id="6260505">.</span><span class="ident" id="6260506">Pos</span><span class="op" id="6260509">(</span><span class="op" id="6260510">)</span><span class="op" id="6260511">)</span><span class="op" id="6260512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6260518">}</span>&nbsp;<span class="keyword" id="6260520">else</span>&nbsp;<span class="keyword" id="6260525">if</span>&nbsp;<span class="ident" id="6260528">isTest</span>&nbsp;<span class="op" id="6260535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6260542">testImported</span><span class="op" id="6260554">[</span><span class="ident" id="6260555">path</span><span class="op" id="6260559">]</span>&nbsp;<span class="op" id="6260561">=</span>&nbsp;<span class="builtinfunc" id="6260563">append</span><span class="op" id="6260569">(</span><span class="ident" id="6260570">testImported</span><span class="op" id="6260582">[</span><span class="ident" id="6260583">path</span><span class="op" id="6260587">]</span><span class="op" id="6260588">,</span>&nbsp;<span class="ident" id="6260590">fset</span><span class="op" id="6260594">.</span><span class="ident" id="6260595">Position</span><span class="op" id="6260603">(</span><span class="ident" id="6260604">spec</span><span class="op" id="6260608">.</span><span class="ident" id="6260609">Pos</span><span class="op" id="6260612">(</span><span class="op" id="6260613">)</span><span class="op" id="6260614">)</span><span class="op" id="6260615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6260621">}</span>&nbsp;<span class="keyword" id="6260623">else</span>&nbsp;<span class="op" id="6260628">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6260635">imported</span><span class="op" id="6260643">[</span><span class="ident" id="6260644">path</span><span class="op" id="6260648">]</span>&nbsp;<span class="op" id="6260650">=</span>&nbsp;<span class="builtinfunc" id="6260652">append</span><span class="op" id="6260658">(</span><span class="ident" id="6260659">imported</span><span class="op" id="6260667">[</span><span class="ident" id="6260668">path</span><span class="op" id="6260672">]</span><span class="op" id="6260673">,</span>&nbsp;<span class="ident" id="6260675">fset</span><span class="op" id="6260679">.</span><span class="ident" id="6260680">Position</span><span class="op" id="6260688">(</span><span class="ident" id="6260689">spec</span><span class="op" id="6260693">.</span><span class="ident" id="6260694">Pos</span><span class="op" id="6260697">(</span><span class="op" id="6260698">)</span><span class="op" id="6260699">)</span><span class="op" id="6260700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6260706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6260712">if</span>&nbsp;<span class="ident" id="6260715">path</span>&nbsp;<span class="op" id="6260720">==</span>&nbsp;<span class="string" id="6260723">&#34;C&#34;</span>&nbsp;<span class="op" id="6260727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6260734">if</span>&nbsp;<span class="ident" id="6260737">isTest</span>&nbsp;<span class="op" id="6260744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6260752">return</span>&nbsp;<span class="ident" id="6260759">p</span><span class="op" id="6260760">,</span>&nbsp;<span class="ident" id="6260762">fmt</span><span class="op" id="6260765">.</span><span class="ident" id="6260766">Errorf</span><span class="op" id="6260772">(</span><span class="string" id="6260773">&#34;use&nbsp;of&nbsp;cgo&nbsp;in&nbsp;test&nbsp;%s&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6260810">,</span>&nbsp;<span class="ident" id="6260812">filename</span><span class="op" id="6260820">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6260827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6260834">cg</span>&nbsp;<span class="op" id="6260837">:=</span>&nbsp;<span class="ident" id="6260840">spec</span><span class="op" id="6260844">.</span><span class="ident" id="6260845">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6260854">if</span>&nbsp;<span class="ident" id="6260857">cg</span>&nbsp;<span class="op" id="6260860">==</span>&nbsp;<span class="ident" id="6260863">nil</span>&nbsp;<span class="op" id="6260867">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6260870">len</span><span class="op" id="6260873">(</span><span class="ident" id="6260874">d</span><span class="op" id="6260875">.</span><span class="ident" id="6260876">Specs</span><span class="op" id="6260881">)</span>&nbsp;<span class="op" id="6260883">==</span>&nbsp;<span class="num" id="6260886">1</span>&nbsp;<span class="op" id="6260888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6260896">cg</span>&nbsp;<span class="op" id="6260899">=</span>&nbsp;<span class="ident" id="6260901">d</span><span class="op" id="6260902">.</span><span class="ident" id="6260903">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6260912">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6260919">if</span>&nbsp;<span class="ident" id="6260922">cg</span>&nbsp;<span class="op" id="6260925">!=</span>&nbsp;<span class="ident" id="6260928">nil</span>&nbsp;<span class="op" id="6260932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6260940">if</span>&nbsp;<span class="ident" id="6260943">err</span>&nbsp;<span class="op" id="6260947">:=</span>&nbsp;<span class="ident" id="6260950">ctxt</span><span class="op" id="6260954">.</span><span class="ident" id="6260955">saveCgo</span><span class="op" id="6260962">(</span><span class="ident" id="6260963">filename</span><span class="op" id="6260971">,</span>&nbsp;<span class="ident" id="6260973">p</span><span class="op" id="6260974">,</span>&nbsp;<span class="ident" id="6260976">cg</span><span class="op" id="6260978">)</span><span class="op" id="6260979">;</span>&nbsp;<span class="ident" id="6260981">err</span>&nbsp;<span class="op" id="6260985">!=</span>&nbsp;<span class="ident" id="6260988">nil</span>&nbsp;<span class="op" id="6260992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261001">return</span>&nbsp;<span class="ident" id="6261008">p</span><span class="op" id="6261009">,</span>&nbsp;<span class="ident" id="6261011">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261028">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6261035">isCgo</span>&nbsp;<span class="op" id="6261041">=</span>&nbsp;<span class="builtintype" id="6261043">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261065">if</span>&nbsp;<span class="ident" id="6261068">isCgo</span>&nbsp;<span class="op" id="6261074">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6261079">allTags</span><span class="op" id="6261086">[</span><span class="string" id="6261087">&#34;cgo&#34;</span><span class="op" id="6261092">]</span>&nbsp;<span class="op" id="6261094">=</span>&nbsp;<span class="builtintype" id="6261096">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261104">if</span>&nbsp;<span class="ident" id="6261107">ctxt</span><span class="op" id="6261111">.</span><span class="ident" id="6261112">CgoEnabled</span>&nbsp;<span class="op" id="6261123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6261129">p</span><span class="op" id="6261130">.</span><span class="ident" id="6261131">CgoFiles</span>&nbsp;<span class="op" id="6261140">=</span>&nbsp;<span class="builtinfunc" id="6261142">append</span><span class="op" id="6261148">(</span><span class="ident" id="6261149">p</span><span class="op" id="6261150">.</span><span class="ident" id="6261151">CgoFiles</span><span class="op" id="6261159">,</span>&nbsp;<span class="ident" id="6261161">name</span><span class="op" id="6261165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261170">}</span>&nbsp;<span class="keyword" id="6261172">else</span>&nbsp;<span class="op" id="6261177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6261183">p</span><span class="op" id="6261184">.</span><span class="ident" id="6261185">IgnoredGoFiles</span>&nbsp;<span class="op" id="6261200">=</span>&nbsp;<span class="builtinfunc" id="6261202">append</span><span class="op" id="6261208">(</span><span class="ident" id="6261209">p</span><span class="op" id="6261210">.</span><span class="ident" id="6261211">IgnoredGoFiles</span><span class="op" id="6261225">,</span>&nbsp;<span class="ident" id="6261227">name</span><span class="op" id="6261231">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261240">}</span>&nbsp;<span class="keyword" id="6261242">else</span>&nbsp;<span class="keyword" id="6261247">if</span>&nbsp;<span class="ident" id="6261250">isXTest</span>&nbsp;<span class="op" id="6261258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6261263">p</span><span class="op" id="6261264">.</span><span class="ident" id="6261265">XTestGoFiles</span>&nbsp;<span class="op" id="6261278">=</span>&nbsp;<span class="builtinfunc" id="6261280">append</span><span class="op" id="6261286">(</span><span class="ident" id="6261287">p</span><span class="op" id="6261288">.</span><span class="ident" id="6261289">XTestGoFiles</span><span class="op" id="6261301">,</span>&nbsp;<span class="ident" id="6261303">name</span><span class="op" id="6261307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261311">}</span>&nbsp;<span class="keyword" id="6261313">else</span>&nbsp;<span class="keyword" id="6261318">if</span>&nbsp;<span class="ident" id="6261321">isTest</span>&nbsp;<span class="op" id="6261328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6261333">p</span><span class="op" id="6261334">.</span><span class="ident" id="6261335">TestGoFiles</span>&nbsp;<span class="op" id="6261347">=</span>&nbsp;<span class="builtinfunc" id="6261349">append</span><span class="op" id="6261355">(</span><span class="ident" id="6261356">p</span><span class="op" id="6261357">.</span><span class="ident" id="6261358">TestGoFiles</span><span class="op" id="6261369">,</span>&nbsp;<span class="ident" id="6261371">name</span><span class="op" id="6261375">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261379">}</span>&nbsp;<span class="keyword" id="6261381">else</span>&nbsp;<span class="op" id="6261386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6261391">p</span><span class="op" id="6261392">.</span><span class="ident" id="6261393">GoFiles</span>&nbsp;<span class="op" id="6261401">=</span>&nbsp;<span class="builtinfunc" id="6261403">append</span><span class="op" id="6261409">(</span><span class="ident" id="6261410">p</span><span class="op" id="6261411">.</span><span class="ident" id="6261412">GoFiles</span><span class="op" id="6261419">,</span>&nbsp;<span class="ident" id="6261421">name</span><span class="op" id="6261425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261435">if</span>&nbsp;<span class="builtinfunc" id="6261438">len</span><span class="op" id="6261441">(</span><span class="ident" id="6261442">p</span><span class="op" id="6261443">.</span><span class="ident" id="6261444">GoFiles</span><span class="op" id="6261451">)</span><span class="op" id="6261452">+</span><span class="builtinfunc" id="6261453">len</span><span class="op" id="6261456">(</span><span class="ident" id="6261457">p</span><span class="op" id="6261458">.</span><span class="ident" id="6261459">CgoFiles</span><span class="op" id="6261467">)</span><span class="op" id="6261468">+</span><span class="builtinfunc" id="6261469">len</span><span class="op" id="6261472">(</span><span class="ident" id="6261473">p</span><span class="op" id="6261474">.</span><span class="ident" id="6261475">TestGoFiles</span><span class="op" id="6261486">)</span><span class="op" id="6261487">+</span><span class="builtinfunc" id="6261488">len</span><span class="op" id="6261491">(</span><span class="ident" id="6261492">p</span><span class="op" id="6261493">.</span><span class="ident" id="6261494">XTestGoFiles</span><span class="op" id="6261506">)</span>&nbsp;<span class="op" id="6261508">==</span>&nbsp;<span class="num" id="6261511">0</span>&nbsp;<span class="op" id="6261513">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261517">return</span>&nbsp;<span class="ident" id="6261524">p</span><span class="op" id="6261525">,</span>&nbsp;<span class="op" id="6261527">&amp;</span><span class="ident" id="6261528">NoGoError</span><span class="op" id="6261537">{</span><span class="ident" id="6261538">p</span><span class="op" id="6261539">.</span><span class="ident" id="6261540">Dir</span><span class="op" id="6261543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261550">for</span>&nbsp;<span class="ident" id="6261554">tag</span>&nbsp;<span class="op" id="6261558">:=</span>&nbsp;<span class="keyword" id="6261561">range</span>&nbsp;<span class="ident" id="6261567">allTags</span>&nbsp;<span class="op" id="6261575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6261579">p</span><span class="op" id="6261580">.</span><span class="ident" id="6261581">AllTags</span>&nbsp;<span class="op" id="6261589">=</span>&nbsp;<span class="builtinfunc" id="6261591">append</span><span class="op" id="6261597">(</span><span class="ident" id="6261598">p</span><span class="op" id="6261599">.</span><span class="ident" id="6261600">AllTags</span><span class="op" id="6261607">,</span>&nbsp;<span class="ident" id="6261609">tag</span><span class="op" id="6261612">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6261618">sort</span><span class="op" id="6261622">.</span><span class="ident" id="6261623">Strings</span><span class="op" id="6261630">(</span><span class="ident" id="6261631">p</span><span class="op" id="6261632">.</span><span class="ident" id="6261633">AllTags</span><span class="op" id="6261640">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6261644">p</span><span class="op" id="6261645">.</span><span class="ident" id="6261646">Imports</span><span class="op" id="6261653">,</span>&nbsp;<span class="ident" id="6261655">p</span><span class="op" id="6261656">.</span><span class="ident" id="6261657">ImportPos</span>&nbsp;<span class="op" id="6261667">=</span>&nbsp;<span class="ident" id="6261669">cleanImports</span><span class="op" id="6261681">(</span><span class="ident" id="6261682">imported</span><span class="op" id="6261690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6261693">p</span><span class="op" id="6261694">.</span><span class="ident" id="6261695">TestImports</span><span class="op" id="6261706">,</span>&nbsp;<span class="ident" id="6261708">p</span><span class="op" id="6261709">.</span><span class="ident" id="6261710">TestImportPos</span>&nbsp;<span class="op" id="6261724">=</span>&nbsp;<span class="ident" id="6261726">cleanImports</span><span class="op" id="6261738">(</span><span class="ident" id="6261739">testImported</span><span class="op" id="6261751">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6261754">p</span><span class="op" id="6261755">.</span><span class="ident" id="6261756">XTestImports</span><span class="op" id="6261768">,</span>&nbsp;<span class="ident" id="6261770">p</span><span class="op" id="6261771">.</span><span class="ident" id="6261772">XTestImportPos</span>&nbsp;<span class="op" id="6261787">=</span>&nbsp;<span class="ident" id="6261789">cleanImports</span><span class="op" id="6261801">(</span><span class="ident" id="6261802">xTestImported</span><span class="op" id="6261815">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6261819">//&nbsp;add&nbsp;the&nbsp;.S&nbsp;files&nbsp;only&nbsp;if&nbsp;we&nbsp;are&nbsp;using&nbsp;cgo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6261865">//&nbsp;(which&nbsp;means&nbsp;gcc&nbsp;will&nbsp;compile&nbsp;them).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6261906">//&nbsp;The&nbsp;standard&nbsp;assemblers&nbsp;expect&nbsp;.s&nbsp;files.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261951">if</span>&nbsp;<span class="builtinfunc" id="6261954">len</span><span class="op" id="6261957">(</span><span class="ident" id="6261958">p</span><span class="op" id="6261959">.</span><span class="ident" id="6261960">CgoFiles</span><span class="op" id="6261968">)</span>&nbsp;<span class="op" id="6261970">&gt;</span>&nbsp;<span class="num" id="6261972">0</span>&nbsp;<span class="op" id="6261974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6261978">p</span><span class="op" id="6261979">.</span><span class="ident" id="6261980">SFiles</span>&nbsp;<span class="op" id="6261987">=</span>&nbsp;<span class="builtinfunc" id="6261989">append</span><span class="op" id="6261995">(</span><span class="ident" id="6261996">p</span><span class="op" id="6261997">.</span><span class="ident" id="6261998">SFiles</span><span class="op" id="6262004">,</span>&nbsp;<span class="ident" id="6262006">Sfiles</span><span class="op" id="6262012">...</span><span class="op" id="6262015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6262019">sort</span><span class="op" id="6262023">.</span><span class="ident" id="6262024">Strings</span><span class="op" id="6262031">(</span><span class="ident" id="6262032">p</span><span class="op" id="6262033">.</span><span class="ident" id="6262034">SFiles</span><span class="op" id="6262040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6262043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6262047">return</span>&nbsp;<span class="ident" id="6262054">p</span><span class="op" id="6262055">,</span>&nbsp;<span class="ident" id="6262057">pkgerr</span><br>
<span class="lineno"></span><span class="op" id="6262064">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6262067">func</span>&nbsp;<span class="ident" id="6262072">findImportComment</span><span class="op" id="6262089">(</span><span class="ident" id="6262090">data</span>&nbsp;<span class="op" id="6262095">[</span><span class="op" id="6262096">]</span><span class="builtintype" id="6262097">byte</span><span class="op" id="6262101">)</span>&nbsp;<span class="op" id="6262103">(</span><span class="ident" id="6262104">s</span>&nbsp;<span class="builtintype" id="6262106">string</span><span class="op" id="6262112">,</span>&nbsp;<span class="ident" id="6262114">line</span>&nbsp;<span class="builtintype" id="6262119">int</span><span class="op" id="6262122">)</span>&nbsp;<span class="op" id="6262124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6262127">//&nbsp;expect&nbsp;keyword&nbsp;package</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6262154">word</span><span class="op" id="6262158">,</span>&nbsp;<span class="ident" id="6262160">data</span>&nbsp;<span class="op" id="6262165">:=</span>&nbsp;<span class="ident" id="6262168">parseWord</span><span class="op" id="6262177">(</span><span class="ident" id="6262178">data</span><span class="op" id="6262182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6262185">if</span>&nbsp;<span class="builtintype" id="6262188">string</span><span class="op" id="6262194">(</span><span class="ident" id="6262195">word</span><span class="op" id="6262199">)</span>&nbsp;<span class="op" id="6262201">!=</span>&nbsp;<span class="string" id="6262204">&#34;package&#34;</span>&nbsp;<span class="op" id="6262214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6262218">return</span>&nbsp;<span class="string" id="6262225">&#34;&#34;</span><span class="op" id="6262227">,</span>&nbsp;<span class="num" id="6262229">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6262232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6262236">//&nbsp;expect&nbsp;package&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6262260">_</span><span class="op" id="6262261">,</span>&nbsp;<span class="ident" id="6262263">data</span>&nbsp;<span class="op" id="6262268">=</span>&nbsp;<span class="ident" id="6262270">parseWord</span><span class="op" id="6262279">(</span><span class="ident" id="6262280">data</span><span class="op" id="6262284">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6262288">//&nbsp;now&nbsp;ready&nbsp;for&nbsp;import&nbsp;comment,&nbsp;a&nbsp;//&nbsp;or&nbsp;/*&nbsp;*/&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6262344">//&nbsp;beginning&nbsp;and&nbsp;ending&nbsp;on&nbsp;the&nbsp;current&nbsp;line.</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6262390">for</span>&nbsp;<span class="builtinfunc" id="6262394">len</span><span class="op" id="6262397">(</span><span class="ident" id="6262398">data</span><span class="op" id="6262402">)</span>&nbsp;<span class="op" id="6262404">&gt;</span>&nbsp;<span class="num" id="6262406">0</span>&nbsp;<span class="op" id="6262408">&amp;&amp;</span>&nbsp;<span class="op" id="6262411">(</span><span class="ident" id="6262412">data</span><span class="op" id="6262416">[</span><span class="num" id="6262417">0</span><span class="op" id="6262418">]</span>&nbsp;<span class="op" id="6262420">==</span>&nbsp;<span class="string" id="6262423">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="6262427">||</span>&nbsp;<span class="ident" id="6262430">data</span><span class="op" id="6262434">[</span><span class="num" id="6262435">0</span><span class="op" id="6262436">]</span>&nbsp;<span class="op" id="6262438">==</span>&nbsp;<span class="string" id="6262441">&#39;\t&#39;</span>&nbsp;<span class="op" id="6262446">||</span>&nbsp;<span class="ident" id="6262449">data</span><span class="op" id="6262453">[</span><span class="num" id="6262454">0</span><span class="op" id="6262455">]</span>&nbsp;<span class="op" id="6262457">==</span>&nbsp;<span class="string" id="6262460">&#39;\r&#39;</span><span class="op" id="6262464">)</span>&nbsp;<span class="op" id="6262466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6262470">data</span>&nbsp;<span class="op" id="6262475">=</span>&nbsp;<span class="ident" id="6262477">data</span><span class="op" id="6262481">[</span><span class="num" id="6262482">1</span><span class="op" id="6262483">:</span><span class="op" id="6262484">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6262487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6262491">var</span>&nbsp;<span class="ident" id="6262495">comment</span>&nbsp;<span class="op" id="6262503">[</span><span class="op" id="6262504">]</span><span class="builtintype" id="6262505">byte</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6262511">switch</span>&nbsp;<span class="op" id="6262518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6262521">case</span>&nbsp;<span class="ident" id="6262526">bytes</span><span class="op" id="6262531">.</span><span class="ident" id="6262532">HasPrefix</span><span class="op" id="6262541">(</span><span class="ident" id="6262542">data</span><span class="op" id="6262546">,</span>&nbsp;<span class="ident" id="6262548">slashSlash</span><span class="op" id="6262558">)</span><span class="op" id="6262559">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6262563">i</span>&nbsp;<span class="op" id="6262565">:=</span>&nbsp;<span class="ident" id="6262568">bytes</span><span class="op" id="6262573">.</span><span class="ident" id="6262574">Index</span><span class="op" id="6262579">(</span><span class="ident" id="6262580">data</span><span class="op" id="6262584">,</span>&nbsp;<span class="ident" id="6262586">newline</span><span class="op" id="6262593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6262597">if</span>&nbsp;<span class="ident" id="6262600">i</span>&nbsp;<span class="op" id="6262602">&lt;</span>&nbsp;<span class="num" id="6262604">0</span>&nbsp;<span class="op" id="6262606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6262611">i</span>&nbsp;<span class="op" id="6262613">=</span>&nbsp;<span class="builtinfunc" id="6262615">len</span><span class="op" id="6262618">(</span><span class="ident" id="6262619">data</span><span class="op" id="6262623">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6262627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6262631">comment</span>&nbsp;<span class="op" id="6262639">=</span>&nbsp;<span class="ident" id="6262641">data</span><span class="op" id="6262645">[</span><span class="num" id="6262646">2</span><span class="op" id="6262647">:</span><span class="ident" id="6262648">i</span><span class="op" id="6262649">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6262652">case</span>&nbsp;<span class="ident" id="6262657">bytes</span><span class="op" id="6262662">.</span><span class="ident" id="6262663">HasPrefix</span><span class="op" id="6262672">(</span><span class="ident" id="6262673">data</span><span class="op" id="6262677">,</span>&nbsp;<span class="ident" id="6262679">slashStar</span><span class="op" id="6262688">)</span><span class="op" id="6262689">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6262693">data</span>&nbsp;<span class="op" id="6262698">=</span>&nbsp;<span class="ident" id="6262700">data</span><span class="op" id="6262704">[</span><span class="num" id="6262705">2</span><span class="op" id="6262706">:</span><span class="op" id="6262707">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6262711">i</span>&nbsp;<span class="op" id="6262713">:=</span>&nbsp;<span class="ident" id="6262716">bytes</span><span class="op" id="6262721">.</span><span class="ident" id="6262722">Index</span><span class="op" id="6262727">(</span><span class="ident" id="6262728">data</span><span class="op" id="6262732">,</span>&nbsp;<span class="ident" id="6262734">starSlash</span><span class="op" id="6262743">)</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6262747">if</span>&nbsp;<span class="ident" id="6262750">i</span>&nbsp;<span class="op" id="6262752">&lt;</span>&nbsp;<span class="num" id="6262754">0</span>&nbsp;<span class="op" id="6262756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6262761">//&nbsp;malformed&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6262785">return</span>&nbsp;<span class="string" id="6262792">&#34;&#34;</span><span class="op" id="6262794">,</span>&nbsp;<span class="num" id="6262796">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6262800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6262804">comment</span>&nbsp;<span class="op" id="6262812">=</span>&nbsp;<span class="ident" id="6262814">data</span><span class="op" id="6262818">[</span><span class="op" id="6262819">:</span><span class="ident" id="6262820">i</span><span class="op" id="6262821">]</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6262825">if</span>&nbsp;<span class="ident" id="6262828">bytes</span><span class="op" id="6262833">.</span><span class="ident" id="6262834">Contains</span><span class="op" id="6262842">(</span><span class="ident" id="6262843">comment</span><span class="op" id="6262850">,</span>&nbsp;<span class="ident" id="6262852">newline</span><span class="op" id="6262859">)</span>&nbsp;<span class="op" id="6262861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6262866">return</span>&nbsp;<span class="string" id="6262873">&#34;&#34;</span><span class="op" id="6262875">,</span>&nbsp;<span class="num" id="6262877">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6262881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6262884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6262887">comment</span>&nbsp;<span class="op" id="6262895">=</span>&nbsp;<span class="ident" id="6262897">bytes</span><span class="op" id="6262902">.</span><span class="ident" id="6262903">TrimSpace</span><span class="op" id="6262912">(</span><span class="ident" id="6262913">comment</span><span class="op" id="6262920">)</span><br>
<span class="lineno">830</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6262924">//&nbsp;split&nbsp;comment&nbsp;into&nbsp;`import`,&nbsp;`&#34;pkg&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6262965">word</span><span class="op" id="6262969">,</span>&nbsp;<span class="ident" id="6262971">arg</span>&nbsp;<span class="op" id="6262975">:=</span>&nbsp;<span class="ident" id="6262978">parseWord</span><span class="op" id="6262987">(</span><span class="ident" id="6262988">comment</span><span class="op" id="6262995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6262998">if</span>&nbsp;<span class="builtintype" id="6263001">string</span><span class="op" id="6263007">(</span><span class="ident" id="6263008">word</span><span class="op" id="6263012">)</span>&nbsp;<span class="op" id="6263014">!=</span>&nbsp;<span class="string" id="6263017">&#34;import&#34;</span>&nbsp;<span class="op" id="6263026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263030">return</span>&nbsp;<span class="string" id="6263037">&#34;&#34;</span><span class="op" id="6263039">,</span>&nbsp;<span class="num" id="6263041">0</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6263044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6263048">line</span>&nbsp;<span class="op" id="6263053">=</span>&nbsp;<span class="num" id="6263055">1</span>&nbsp;<span class="op" id="6263057">+</span>&nbsp;<span class="ident" id="6263059">bytes</span><span class="op" id="6263064">.</span><span class="ident" id="6263065">Count</span><span class="op" id="6263070">(</span><span class="ident" id="6263071">data</span><span class="op" id="6263075">[</span><span class="op" id="6263076">:</span><span class="builtinfunc" id="6263077">cap</span><span class="op" id="6263080">(</span><span class="ident" id="6263081">data</span><span class="op" id="6263085">)</span><span class="op" id="6263086">-</span><span class="builtinfunc" id="6263087">cap</span><span class="op" id="6263090">(</span><span class="ident" id="6263091">arg</span><span class="op" id="6263094">)</span><span class="op" id="6263095">]</span><span class="op" id="6263096">,</span>&nbsp;<span class="ident" id="6263098">newline</span><span class="op" id="6263105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263108">return</span>&nbsp;<span class="ident" id="6263115">strings</span><span class="op" id="6263122">.</span><span class="ident" id="6263123">TrimSpace</span><span class="op" id="6263132">(</span><span class="builtintype" id="6263133">string</span><span class="op" id="6263139">(</span><span class="ident" id="6263140">arg</span><span class="op" id="6263143">)</span><span class="op" id="6263144">)</span><span class="op" id="6263145">,</span>&nbsp;<span class="ident" id="6263147">line</span><br>
<span class="lineno"></span><span class="op" id="6263152">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span><span class="keyword" id="6263155">var</span>&nbsp;<span class="op" id="6263159">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6263162">slashSlash</span>&nbsp;<span class="op" id="6263173">=</span>&nbsp;<span class="op" id="6263175">[</span><span class="op" id="6263176">]</span><span class="builtintype" id="6263177">byte</span><span class="op" id="6263181">(</span><span class="string" id="6263182">&#34;//&#34;</span><span class="op" id="6263186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6263189">slashStar</span>&nbsp;&nbsp;<span class="op" id="6263200">=</span>&nbsp;<span class="op" id="6263202">[</span><span class="op" id="6263203">]</span><span class="builtintype" id="6263204">byte</span><span class="op" id="6263208">(</span><span class="string" id="6263209">&#34;/*&#34;</span><span class="op" id="6263213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6263216">starSlash</span>&nbsp;&nbsp;<span class="op" id="6263227">=</span>&nbsp;<span class="op" id="6263229">[</span><span class="op" id="6263230">]</span><span class="builtintype" id="6263231">byte</span><span class="op" id="6263235">(</span><span class="string" id="6263236">&#34;*/&#34;</span><span class="op" id="6263240">)</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6263243">newline</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6263254">=</span>&nbsp;<span class="op" id="6263256">[</span><span class="op" id="6263257">]</span><span class="builtintype" id="6263258">byte</span><span class="op" id="6263262">(</span><span class="string" id="6263263">&#34;\n&#34;</span><span class="op" id="6263267">)</span><br>
<span class="lineno"></span><span class="op" id="6263269">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6263272">//&nbsp;skipSpaceOrComment&nbsp;returns&nbsp;data&nbsp;with&nbsp;any&nbsp;leading&nbsp;spaces&nbsp;or&nbsp;comments&nbsp;removed.</span><br>
<span class="lineno"></span><span class="keyword" id="6263352">func</span>&nbsp;<span class="ident" id="6263357">skipSpaceOrComment</span><span class="op" id="6263375">(</span><span class="ident" id="6263376">data</span>&nbsp;<span class="op" id="6263381">[</span><span class="op" id="6263382">]</span><span class="builtintype" id="6263383">byte</span><span class="op" id="6263387">)</span>&nbsp;<span class="op" id="6263389">[</span><span class="op" id="6263390">]</span><span class="builtintype" id="6263391">byte</span>&nbsp;<span class="op" id="6263396">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263399">for</span>&nbsp;<span class="builtinfunc" id="6263403">len</span><span class="op" id="6263406">(</span><span class="ident" id="6263407">data</span><span class="op" id="6263411">)</span>&nbsp;<span class="op" id="6263413">&gt;</span>&nbsp;<span class="num" id="6263415">0</span>&nbsp;<span class="op" id="6263417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263421">switch</span>&nbsp;<span class="ident" id="6263428">data</span><span class="op" id="6263432">[</span><span class="num" id="6263433">0</span><span class="op" id="6263434">]</span>&nbsp;<span class="op" id="6263436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263440">case</span>&nbsp;<span class="string" id="6263445">&#39;&nbsp;&#39;</span><span class="op" id="6263448">,</span>&nbsp;<span class="string" id="6263450">&#39;\t&#39;</span><span class="op" id="6263454">,</span>&nbsp;<span class="string" id="6263456">&#39;\r&#39;</span><span class="op" id="6263460">,</span>&nbsp;<span class="string" id="6263462">&#39;\n&#39;</span><span class="op" id="6263466">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6263471">data</span>&nbsp;<span class="op" id="6263476">=</span>&nbsp;<span class="ident" id="6263478">data</span><span class="op" id="6263482">[</span><span class="num" id="6263483">1</span><span class="op" id="6263484">:</span><span class="op" id="6263485">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263490">continue</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263501">case</span>&nbsp;<span class="string" id="6263506">&#39;/&#39;</span><span class="op" id="6263509">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263514">if</span>&nbsp;<span class="ident" id="6263517">bytes</span><span class="op" id="6263522">.</span><span class="ident" id="6263523">HasPrefix</span><span class="op" id="6263532">(</span><span class="ident" id="6263533">data</span><span class="op" id="6263537">,</span>&nbsp;<span class="ident" id="6263539">slashSlash</span><span class="op" id="6263549">)</span>&nbsp;<span class="op" id="6263551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6263557">i</span>&nbsp;<span class="op" id="6263559">:=</span>&nbsp;<span class="ident" id="6263562">bytes</span><span class="op" id="6263567">.</span><span class="ident" id="6263568">Index</span><span class="op" id="6263573">(</span><span class="ident" id="6263574">data</span><span class="op" id="6263578">,</span>&nbsp;<span class="ident" id="6263580">newline</span><span class="op" id="6263587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263593">if</span>&nbsp;<span class="ident" id="6263596">i</span>&nbsp;<span class="op" id="6263598">&lt;</span>&nbsp;<span class="num" id="6263600">0</span>&nbsp;<span class="op" id="6263602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263609">return</span>&nbsp;<span class="ident" id="6263616">nil</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6263624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6263630">data</span>&nbsp;<span class="op" id="6263635">=</span>&nbsp;<span class="ident" id="6263637">data</span><span class="op" id="6263641">[</span><span class="ident" id="6263642">i</span><span class="op" id="6263643">+</span><span class="num" id="6263644">1</span><span class="op" id="6263645">:</span><span class="op" id="6263646">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263652">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6263664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263669">if</span>&nbsp;<span class="ident" id="6263672">bytes</span><span class="op" id="6263677">.</span><span class="ident" id="6263678">HasPrefix</span><span class="op" id="6263687">(</span><span class="ident" id="6263688">data</span><span class="op" id="6263692">,</span>&nbsp;<span class="ident" id="6263694">slashStar</span><span class="op" id="6263703">)</span>&nbsp;<span class="op" id="6263705">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6263711">data</span>&nbsp;<span class="op" id="6263716">=</span>&nbsp;<span class="ident" id="6263718">data</span><span class="op" id="6263722">[</span><span class="num" id="6263723">2</span><span class="op" id="6263724">:</span><span class="op" id="6263725">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6263731">i</span>&nbsp;<span class="op" id="6263733">:=</span>&nbsp;<span class="ident" id="6263736">bytes</span><span class="op" id="6263741">.</span><span class="ident" id="6263742">Index</span><span class="op" id="6263747">(</span><span class="ident" id="6263748">data</span><span class="op" id="6263752">,</span>&nbsp;<span class="ident" id="6263754">starSlash</span><span class="op" id="6263763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263769">if</span>&nbsp;<span class="ident" id="6263772">i</span>&nbsp;<span class="op" id="6263774">&lt;</span>&nbsp;<span class="num" id="6263776">0</span>&nbsp;<span class="op" id="6263778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263785">return</span>&nbsp;<span class="ident" id="6263792">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6263800">}</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6263806">data</span>&nbsp;<span class="op" id="6263811">=</span>&nbsp;<span class="ident" id="6263813">data</span><span class="op" id="6263817">[</span><span class="ident" id="6263818">i</span><span class="op" id="6263819">+</span><span class="num" id="6263820">2</span><span class="op" id="6263821">:</span><span class="op" id="6263822">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263828">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6263840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6263844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263848">break</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6263855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263858">return</span>&nbsp;<span class="ident" id="6263865">data</span><br>
<span class="lineno"></span><span class="op" id="6263870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6263873">//&nbsp;parseWord&nbsp;skips&nbsp;any&nbsp;leading&nbsp;spaces&nbsp;or&nbsp;comments&nbsp;in&nbsp;data</span><br>
<span class="lineno">880</span><span class="comment" id="6263931">//&nbsp;and&nbsp;then&nbsp;parses&nbsp;the&nbsp;beginning&nbsp;of&nbsp;data&nbsp;as&nbsp;an&nbsp;identifier&nbsp;or&nbsp;keyword,</span><br>
<span class="lineno"></span><span class="comment" id="6264001">//&nbsp;returning&nbsp;that&nbsp;word&nbsp;and&nbsp;what&nbsp;remains&nbsp;after&nbsp;the&nbsp;word.</span><br>
<span class="lineno"></span><span class="keyword" id="6264057">func</span>&nbsp;<span class="ident" id="6264062">parseWord</span><span class="op" id="6264071">(</span><span class="ident" id="6264072">data</span>&nbsp;<span class="op" id="6264077">[</span><span class="op" id="6264078">]</span><span class="builtintype" id="6264079">byte</span><span class="op" id="6264083">)</span>&nbsp;<span class="op" id="6264085">(</span><span class="ident" id="6264086">word</span><span class="op" id="6264090">,</span>&nbsp;<span class="ident" id="6264092">rest</span>&nbsp;<span class="op" id="6264097">[</span><span class="op" id="6264098">]</span><span class="builtintype" id="6264099">byte</span><span class="op" id="6264103">)</span>&nbsp;<span class="op" id="6264105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6264108">data</span>&nbsp;<span class="op" id="6264113">=</span>&nbsp;<span class="ident" id="6264115">skipSpaceOrComment</span><span class="op" id="6264133">(</span><span class="ident" id="6264134">data</span><span class="op" id="6264138">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6264142">//&nbsp;Parse&nbsp;past&nbsp;leading&nbsp;word&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6264182">rest</span>&nbsp;<span class="op" id="6264187">=</span>&nbsp;<span class="ident" id="6264189">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6264195">for</span>&nbsp;<span class="op" id="6264199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6264203">r</span><span class="op" id="6264204">,</span>&nbsp;<span class="ident" id="6264206">size</span>&nbsp;<span class="op" id="6264211">:=</span>&nbsp;<span class="ident" id="6264214">utf8</span><span class="op" id="6264218">.</span><span class="ident" id="6264219">DecodeRune</span><span class="op" id="6264229">(</span><span class="ident" id="6264230">rest</span><span class="op" id="6264234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6264238">if</span>&nbsp;<span class="ident" id="6264241">unicode</span><span class="op" id="6264248">.</span><span class="ident" id="6264249">IsLetter</span><span class="op" id="6264257">(</span><span class="ident" id="6264258">r</span><span class="op" id="6264259">)</span>&nbsp;<span class="op" id="6264261">||</span>&nbsp;<span class="string" id="6264264">&#39;0&#39;</span>&nbsp;<span class="op" id="6264268">&lt;=</span>&nbsp;<span class="ident" id="6264271">r</span>&nbsp;<span class="op" id="6264273">&amp;&amp;</span>&nbsp;<span class="ident" id="6264276">r</span>&nbsp;<span class="op" id="6264278">&lt;=</span>&nbsp;<span class="string" id="6264281">&#39;9&#39;</span>&nbsp;<span class="op" id="6264285">||</span>&nbsp;<span class="ident" id="6264288">r</span>&nbsp;<span class="op" id="6264290">==</span>&nbsp;<span class="string" id="6264293">&#39;_&#39;</span>&nbsp;<span class="op" id="6264297">{</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6264302">rest</span>&nbsp;<span class="op" id="6264307">=</span>&nbsp;<span class="ident" id="6264309">rest</span><span class="op" id="6264313">[</span><span class="ident" id="6264314">size</span><span class="op" id="6264318">:</span><span class="op" id="6264319">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6264324">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6264335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6264339">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6264346">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6264350">word</span>&nbsp;<span class="op" id="6264355">=</span>&nbsp;<span class="ident" id="6264357">data</span><span class="op" id="6264361">[</span><span class="op" id="6264362">:</span><span class="builtinfunc" id="6264363">len</span><span class="op" id="6264366">(</span><span class="ident" id="6264367">data</span><span class="op" id="6264371">)</span><span class="op" id="6264372">-</span><span class="builtinfunc" id="6264373">len</span><span class="op" id="6264376">(</span><span class="ident" id="6264377">rest</span><span class="op" id="6264381">)</span><span class="op" id="6264382">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6264385">if</span>&nbsp;<span class="builtinfunc" id="6264388">len</span><span class="op" id="6264391">(</span><span class="ident" id="6264392">word</span><span class="op" id="6264396">)</span>&nbsp;<span class="op" id="6264398">==</span>&nbsp;<span class="num" id="6264401">0</span>&nbsp;<span class="op" id="6264403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6264407">return</span>&nbsp;<span class="ident" id="6264414">nil</span><span class="op" id="6264417">,</span>&nbsp;<span class="ident" id="6264419">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6264424">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6264428">return</span>&nbsp;<span class="ident" id="6264435">word</span><span class="op" id="6264439">,</span>&nbsp;<span class="ident" id="6264441">rest</span><br>
<span class="lineno"></span><span class="op" id="6264446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6264449">//&nbsp;MatchFile&nbsp;reports&nbsp;whether&nbsp;the&nbsp;file&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;given&nbsp;directory</span><br>
<span class="lineno">905</span><span class="comment" id="6264530">//&nbsp;matches&nbsp;the&nbsp;context&nbsp;and&nbsp;would&nbsp;be&nbsp;included&nbsp;in&nbsp;a&nbsp;Package&nbsp;created&nbsp;by&nbsp;ImportDir</span><br>
<span class="lineno"></span><span class="comment" id="6264609">//&nbsp;of&nbsp;that&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="6264631">//</span><br>
<span class="lineno"></span><span class="comment" id="6264634">//&nbsp;MatchFile&nbsp;considers&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;file&nbsp;and&nbsp;may&nbsp;use&nbsp;ctxt.OpenFile&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="6264707">//&nbsp;read&nbsp;some&nbsp;or&nbsp;all&nbsp;of&nbsp;the&nbsp;file&#39;s&nbsp;content.</span><br>
<span class="lineno">910</span><span class="keyword" id="6264750">func</span>&nbsp;<span class="op" id="6264755">(</span><span class="ident" id="6264756">ctxt</span>&nbsp;<span class="op" id="6264761">*</span><span class="ident" id="6264762">Context</span><span class="op" id="6264769">)</span>&nbsp;<span class="ident" id="6264771">MatchFile</span><span class="op" id="6264780">(</span><span class="ident" id="6264781">dir</span><span class="op" id="6264784">,</span>&nbsp;<span class="ident" id="6264786">name</span>&nbsp;<span class="builtintype" id="6264791">string</span><span class="op" id="6264797">)</span>&nbsp;<span class="op" id="6264799">(</span><span class="ident" id="6264800">match</span>&nbsp;<span class="builtintype" id="6264806">bool</span><span class="op" id="6264810">,</span>&nbsp;<span class="ident" id="6264812">err</span>&nbsp;<span class="builtintype" id="6264816">error</span><span class="op" id="6264821">)</span>&nbsp;<span class="op" id="6264823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6264826">match</span><span class="op" id="6264831">,</span>&nbsp;<span class="ident" id="6264833">_</span><span class="op" id="6264834">,</span>&nbsp;<span class="ident" id="6264836">_</span><span class="op" id="6264837">,</span>&nbsp;<span class="ident" id="6264839">err</span>&nbsp;<span class="op" id="6264843">=</span>&nbsp;<span class="ident" id="6264845">ctxt</span><span class="op" id="6264849">.</span><span class="ident" id="6264850">matchFile</span><span class="op" id="6264859">(</span><span class="ident" id="6264860">dir</span><span class="op" id="6264863">,</span>&nbsp;<span class="ident" id="6264865">name</span><span class="op" id="6264869">,</span>&nbsp;<span class="builtintype" id="6264871">false</span><span class="op" id="6264876">,</span>&nbsp;<span class="ident" id="6264878">nil</span><span class="op" id="6264881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6264884">return</span><br>
<span class="lineno"></span><span class="op" id="6264891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">915</span><span class="comment" id="6264894">//&nbsp;matchFile&nbsp;determines&nbsp;whether&nbsp;the&nbsp;file&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;given&nbsp;directory</span><br>
<span class="lineno"></span><span class="comment" id="6264978">//&nbsp;should&nbsp;be&nbsp;included&nbsp;in&nbsp;the&nbsp;package&nbsp;being&nbsp;constructed.</span><br>
<span class="lineno"></span><span class="comment" id="6265034">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;data&nbsp;read&nbsp;from&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="6265077">//&nbsp;If&nbsp;returnImports&nbsp;is&nbsp;true&nbsp;and&nbsp;name&nbsp;denotes&nbsp;a&nbsp;Go&nbsp;program,&nbsp;matchFile&nbsp;reads</span><br>
<span class="lineno"></span><span class="comment" id="6265152">//&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;imports&nbsp;(and&nbsp;returns&nbsp;that&nbsp;data)&nbsp;even&nbsp;though&nbsp;it&nbsp;only</span><br>
<span class="lineno">920</span><span class="comment" id="6265228">//&nbsp;considers&nbsp;text&nbsp;until&nbsp;the&nbsp;first&nbsp;non-comment.</span><br>
<span class="lineno"></span><span class="comment" id="6265275">//&nbsp;If&nbsp;allTags&nbsp;is&nbsp;non-nil,&nbsp;matchFile&nbsp;records&nbsp;any&nbsp;encountered&nbsp;build&nbsp;tag</span><br>
<span class="lineno"></span><span class="comment" id="6265345">//&nbsp;by&nbsp;setting&nbsp;allTags[tag]&nbsp;=&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="6265380">func</span>&nbsp;<span class="op" id="6265385">(</span><span class="ident" id="6265386">ctxt</span>&nbsp;<span class="op" id="6265391">*</span><span class="ident" id="6265392">Context</span><span class="op" id="6265399">)</span>&nbsp;<span class="ident" id="6265401">matchFile</span><span class="op" id="6265410">(</span><span class="ident" id="6265411">dir</span><span class="op" id="6265414">,</span>&nbsp;<span class="ident" id="6265416">name</span>&nbsp;<span class="builtintype" id="6265421">string</span><span class="op" id="6265427">,</span>&nbsp;<span class="ident" id="6265429">returnImports</span>&nbsp;<span class="builtintype" id="6265443">bool</span><span class="op" id="6265447">,</span>&nbsp;<span class="ident" id="6265449">allTags</span>&nbsp;<span class="keyword" id="6265457">map</span><span class="op" id="6265460">[</span><span class="builtintype" id="6265461">string</span><span class="op" id="6265467">]</span><span class="builtintype" id="6265468">bool</span><span class="op" id="6265472">)</span>&nbsp;<span class="op" id="6265474">(</span><span class="ident" id="6265475">match</span>&nbsp;<span class="builtintype" id="6265481">bool</span><span class="op" id="6265485">,</span>&nbsp;<span class="ident" id="6265487">data</span>&nbsp;<span class="op" id="6265492">[</span><span class="op" id="6265493">]</span><span class="builtintype" id="6265494">byte</span><span class="op" id="6265498">,</span>&nbsp;<span class="ident" id="6265500">filename</span>&nbsp;<span class="builtintype" id="6265509">string</span><span class="op" id="6265515">,</span>&nbsp;<span class="ident" id="6265517">err</span>&nbsp;<span class="builtintype" id="6265521">error</span><span class="op" id="6265526">)</span>&nbsp;<span class="op" id="6265528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6265531">if</span>&nbsp;<span class="ident" id="6265534">strings</span><span class="op" id="6265541">.</span><span class="ident" id="6265542">HasPrefix</span><span class="op" id="6265551">(</span><span class="ident" id="6265552">name</span><span class="op" id="6265556">,</span>&nbsp;<span class="string" id="6265558">&#34;_&#34;</span><span class="op" id="6265561">)</span>&nbsp;<span class="op" id="6265563">||</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6265568">strings</span><span class="op" id="6265575">.</span><span class="ident" id="6265576">HasPrefix</span><span class="op" id="6265585">(</span><span class="ident" id="6265586">name</span><span class="op" id="6265590">,</span>&nbsp;<span class="string" id="6265592">&#34;.&#34;</span><span class="op" id="6265595">)</span>&nbsp;<span class="op" id="6265597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6265601">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6265609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6265613">i</span>&nbsp;<span class="op" id="6265615">:=</span>&nbsp;<span class="ident" id="6265618">strings</span><span class="op" id="6265625">.</span><span class="ident" id="6265626">LastIndex</span><span class="op" id="6265635">(</span><span class="ident" id="6265636">name</span><span class="op" id="6265640">,</span>&nbsp;<span class="string" id="6265642">&#34;.&#34;</span><span class="op" id="6265645">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6265648">if</span>&nbsp;<span class="ident" id="6265651">i</span>&nbsp;<span class="op" id="6265653">&lt;</span>&nbsp;<span class="num" id="6265655">0</span>&nbsp;<span class="op" id="6265657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6265661">i</span>&nbsp;<span class="op" id="6265663">=</span>&nbsp;<span class="builtinfunc" id="6265665">len</span><span class="op" id="6265668">(</span><span class="ident" id="6265669">name</span><span class="op" id="6265673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6265676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6265679">ext</span>&nbsp;<span class="op" id="6265683">:=</span>&nbsp;<span class="ident" id="6265686">name</span><span class="op" id="6265690">[</span><span class="ident" id="6265691">i</span><span class="op" id="6265692">:</span><span class="op" id="6265693">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6265697">if</span>&nbsp;<span class="op" id="6265700">!</span><span class="ident" id="6265701">ctxt</span><span class="op" id="6265705">.</span><span class="ident" id="6265706">goodOSArchFile</span><span class="op" id="6265720">(</span><span class="ident" id="6265721">name</span><span class="op" id="6265725">,</span>&nbsp;<span class="ident" id="6265727">allTags</span><span class="op" id="6265734">)</span>&nbsp;<span class="op" id="6265736">&amp;&amp;</span>&nbsp;<span class="op" id="6265739">!</span><span class="ident" id="6265740">ctxt</span><span class="op" id="6265744">.</span><span class="ident" id="6265745">UseAllFiles</span>&nbsp;<span class="op" id="6265757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6265761">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6265769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6265773">switch</span>&nbsp;<span class="ident" id="6265780">ext</span>&nbsp;<span class="op" id="6265784">{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6265787">case</span>&nbsp;<span class="string" id="6265792">&#34;.go&#34;</span><span class="op" id="6265797">,</span>&nbsp;<span class="string" id="6265799">&#34;.c&#34;</span><span class="op" id="6265803">,</span>&nbsp;<span class="string" id="6265805">&#34;.cc&#34;</span><span class="op" id="6265810">,</span>&nbsp;<span class="string" id="6265812">&#34;.cxx&#34;</span><span class="op" id="6265818">,</span>&nbsp;<span class="string" id="6265820">&#34;.cpp&#34;</span><span class="op" id="6265826">,</span>&nbsp;<span class="string" id="6265828">&#34;.m&#34;</span><span class="op" id="6265832">,</span>&nbsp;<span class="string" id="6265834">&#34;.s&#34;</span><span class="op" id="6265838">,</span>&nbsp;<span class="string" id="6265840">&#34;.h&#34;</span><span class="op" id="6265844">,</span>&nbsp;<span class="string" id="6265846">&#34;.hh&#34;</span><span class="op" id="6265851">,</span>&nbsp;<span class="string" id="6265853">&#34;.hpp&#34;</span><span class="op" id="6265859">,</span>&nbsp;<span class="string" id="6265861">&#34;.hxx&#34;</span><span class="op" id="6265867">,</span>&nbsp;<span class="string" id="6265869">&#34;.S&#34;</span><span class="op" id="6265873">,</span>&nbsp;<span class="string" id="6265875">&#34;.swig&#34;</span><span class="op" id="6265882">,</span>&nbsp;<span class="string" id="6265884">&#34;.swigcxx&#34;</span><span class="op" id="6265894">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6265898">//&nbsp;tentatively&nbsp;okay&nbsp;-&nbsp;read&nbsp;to&nbsp;make&nbsp;sure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6265939">case</span>&nbsp;<span class="string" id="6265944">&#34;.syso&#34;</span><span class="op" id="6265951">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6265955">//&nbsp;binary,&nbsp;no&nbsp;reading</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6265979">match</span>&nbsp;<span class="op" id="6265985">=</span>&nbsp;<span class="builtintype" id="6265987">true</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6265994">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6266002">default</span><span class="op" id="6266009">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6266013">//&nbsp;skip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6266023">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6266031">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6266035">filename</span>&nbsp;<span class="op" id="6266044">=</span>&nbsp;<span class="ident" id="6266046">ctxt</span><span class="op" id="6266050">.</span><span class="ident" id="6266051">joinPath</span><span class="op" id="6266059">(</span><span class="ident" id="6266060">dir</span><span class="op" id="6266063">,</span>&nbsp;<span class="ident" id="6266065">name</span><span class="op" id="6266069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6266072">f</span><span class="op" id="6266073">,</span>&nbsp;<span class="ident" id="6266075">err</span>&nbsp;<span class="op" id="6266079">:=</span>&nbsp;<span class="ident" id="6266082">ctxt</span><span class="op" id="6266086">.</span><span class="ident" id="6266087">openFile</span><span class="op" id="6266095">(</span><span class="ident" id="6266096">filename</span><span class="op" id="6266104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6266107">if</span>&nbsp;<span class="ident" id="6266110">err</span>&nbsp;<span class="op" id="6266114">!=</span>&nbsp;<span class="ident" id="6266117">nil</span>&nbsp;<span class="op" id="6266121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6266125">return</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6266133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6266137">if</span>&nbsp;<span class="ident" id="6266140">strings</span><span class="op" id="6266147">.</span><span class="ident" id="6266148">HasSuffix</span><span class="op" id="6266157">(</span><span class="ident" id="6266158">filename</span><span class="op" id="6266166">,</span>&nbsp;<span class="string" id="6266168">&#34;.go&#34;</span><span class="op" id="6266173">)</span>&nbsp;<span class="op" id="6266175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6266179">data</span><span class="op" id="6266183">,</span>&nbsp;<span class="ident" id="6266185">err</span>&nbsp;<span class="op" id="6266189">=</span>&nbsp;<span class="ident" id="6266191">readImports</span><span class="op" id="6266202">(</span><span class="ident" id="6266203">f</span><span class="op" id="6266204">,</span>&nbsp;<span class="builtintype" id="6266206">false</span><span class="op" id="6266211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6266214">}</span>&nbsp;<span class="keyword" id="6266216">else</span>&nbsp;<span class="op" id="6266221">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6266225">data</span><span class="op" id="6266229">,</span>&nbsp;<span class="ident" id="6266231">err</span>&nbsp;<span class="op" id="6266235">=</span>&nbsp;<span class="ident" id="6266237">readComments</span><span class="op" id="6266249">(</span><span class="ident" id="6266250">f</span><span class="op" id="6266251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6266254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6266257">f</span><span class="op" id="6266258">.</span><span class="ident" id="6266259">Close</span><span class="op" id="6266264">(</span><span class="op" id="6266265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6266268">if</span>&nbsp;<span class="ident" id="6266271">err</span>&nbsp;<span class="op" id="6266275">!=</span>&nbsp;<span class="ident" id="6266278">nil</span>&nbsp;<span class="op" id="6266282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6266286">err</span>&nbsp;<span class="op" id="6266290">=</span>&nbsp;<span class="ident" id="6266292">fmt</span><span class="op" id="6266295">.</span><span class="ident" id="6266296">Errorf</span><span class="op" id="6266302">(</span><span class="string" id="6266303">&#34;read&nbsp;%s:&nbsp;%v&#34;</span><span class="op" id="6266316">,</span>&nbsp;<span class="ident" id="6266318">filename</span><span class="op" id="6266326">,</span>&nbsp;<span class="ident" id="6266328">err</span><span class="op" id="6266331">)</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6266335">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6266343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6266347">//&nbsp;Look&nbsp;for&nbsp;+build&nbsp;comments&nbsp;to&nbsp;accept&nbsp;or&nbsp;reject&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6266406">if</span>&nbsp;<span class="op" id="6266409">!</span><span class="ident" id="6266410">ctxt</span><span class="op" id="6266414">.</span><span class="ident" id="6266415">shouldBuild</span><span class="op" id="6266426">(</span><span class="ident" id="6266427">data</span><span class="op" id="6266431">,</span>&nbsp;<span class="ident" id="6266433">allTags</span><span class="op" id="6266440">)</span>&nbsp;<span class="op" id="6266442">&amp;&amp;</span>&nbsp;<span class="op" id="6266445">!</span><span class="ident" id="6266446">ctxt</span><span class="op" id="6266450">.</span><span class="ident" id="6266451">UseAllFiles</span>&nbsp;<span class="op" id="6266463">{</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6266467">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6266475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6266479">match</span>&nbsp;<span class="op" id="6266485">=</span>&nbsp;<span class="builtintype" id="6266487">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6266493">return</span><br>
<span class="lineno">975</span><span class="op" id="6266500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6266503">func</span>&nbsp;<span class="ident" id="6266508">cleanImports</span><span class="op" id="6266520">(</span><span class="ident" id="6266521">m</span>&nbsp;<span class="keyword" id="6266523">map</span><span class="op" id="6266526">[</span><span class="builtintype" id="6266527">string</span><span class="op" id="6266533">]</span><span class="op" id="6266534">[</span><span class="op" id="6266535">]</span><span class="ident" id="6266536">token</span><span class="op" id="6266541">.</span><span class="ident" id="6266542">Position</span><span class="op" id="6266550">)</span>&nbsp;<span class="op" id="6266552">(</span><span class="op" id="6266553">[</span><span class="op" id="6266554">]</span><span class="builtintype" id="6266555">string</span><span class="op" id="6266561">,</span>&nbsp;<span class="keyword" id="6266563">map</span><span class="op" id="6266566">[</span><span class="builtintype" id="6266567">string</span><span class="op" id="6266573">]</span><span class="op" id="6266574">[</span><span class="op" id="6266575">]</span><span class="ident" id="6266576">token</span><span class="op" id="6266581">.</span><span class="ident" id="6266582">Position</span><span class="op" id="6266590">)</span>&nbsp;<span class="op" id="6266592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6266595">all</span>&nbsp;<span class="op" id="6266599">:=</span>&nbsp;<span class="builtinfunc" id="6266602">make</span><span class="op" id="6266606">(</span><span class="op" id="6266607">[</span><span class="op" id="6266608">]</span><span class="builtintype" id="6266609">string</span><span class="op" id="6266615">,</span>&nbsp;<span class="num" id="6266617">0</span><span class="op" id="6266618">,</span>&nbsp;<span class="builtinfunc" id="6266620">len</span><span class="op" id="6266623">(</span><span class="ident" id="6266624">m</span><span class="op" id="6266625">)</span><span class="op" id="6266626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6266629">for</span>&nbsp;<span class="ident" id="6266633">path</span>&nbsp;<span class="op" id="6266638">:=</span>&nbsp;<span class="keyword" id="6266641">range</span>&nbsp;<span class="ident" id="6266647">m</span>&nbsp;<span class="op" id="6266649">{</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6266653">all</span>&nbsp;<span class="op" id="6266657">=</span>&nbsp;<span class="builtinfunc" id="6266659">append</span><span class="op" id="6266665">(</span><span class="ident" id="6266666">all</span><span class="op" id="6266669">,</span>&nbsp;<span class="ident" id="6266671">path</span><span class="op" id="6266675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6266678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6266681">sort</span><span class="op" id="6266685">.</span><span class="ident" id="6266686">Strings</span><span class="op" id="6266693">(</span><span class="ident" id="6266694">all</span><span class="op" id="6266697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6266700">return</span>&nbsp;<span class="ident" id="6266707">all</span><span class="op" id="6266710">,</span>&nbsp;<span class="ident" id="6266712">m</span><br>
<span class="lineno"></span><span class="op" id="6266714">}</span><br>
<span class="lineno">985</span><br>
<span class="lineno"></span><span class="comment" id="6266717">//&nbsp;Import&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;Default.Import.</span><br>
<span class="lineno"></span><span class="keyword" id="6266760">func</span>&nbsp;<span class="ident" id="6266765">Import</span><span class="op" id="6266771">(</span><span class="ident" id="6266772">path</span><span class="op" id="6266776">,</span>&nbsp;<span class="ident" id="6266778">srcDir</span>&nbsp;<span class="builtintype" id="6266785">string</span><span class="op" id="6266791">,</span>&nbsp;<span class="ident" id="6266793">mode</span>&nbsp;<span class="ident" id="6266798">ImportMode</span><span class="op" id="6266808">)</span>&nbsp;<span class="op" id="6266810">(</span><span class="op" id="6266811">*</span><span class="ident" id="6266812">Package</span><span class="op" id="6266819">,</span>&nbsp;<span class="builtintype" id="6266821">error</span><span class="op" id="6266826">)</span>&nbsp;<span class="op" id="6266828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6266831">return</span>&nbsp;<span class="ident" id="6266838">Default</span><span class="op" id="6266845">.</span><span class="ident" id="6266846">Import</span><span class="op" id="6266852">(</span><span class="ident" id="6266853">path</span><span class="op" id="6266857">,</span>&nbsp;<span class="ident" id="6266859">srcDir</span><span class="op" id="6266865">,</span>&nbsp;<span class="ident" id="6266867">mode</span><span class="op" id="6266871">)</span><br>
<span class="lineno"></span><span class="op" id="6266873">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span><span class="comment" id="6266876">//&nbsp;ImportDir&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;Default.ImportDir.</span><br>
<span class="lineno"></span><span class="keyword" id="6266925">func</span>&nbsp;<span class="ident" id="6266930">ImportDir</span><span class="op" id="6266939">(</span><span class="ident" id="6266940">dir</span>&nbsp;<span class="builtintype" id="6266944">string</span><span class="op" id="6266950">,</span>&nbsp;<span class="ident" id="6266952">mode</span>&nbsp;<span class="ident" id="6266957">ImportMode</span><span class="op" id="6266967">)</span>&nbsp;<span class="op" id="6266969">(</span><span class="op" id="6266970">*</span><span class="ident" id="6266971">Package</span><span class="op" id="6266978">,</span>&nbsp;<span class="builtintype" id="6266980">error</span><span class="op" id="6266985">)</span>&nbsp;<span class="op" id="6266987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6266990">return</span>&nbsp;<span class="ident" id="6266997">Default</span><span class="op" id="6267004">.</span><span class="ident" id="6267005">ImportDir</span><span class="op" id="6267014">(</span><span class="ident" id="6267015">dir</span><span class="op" id="6267018">,</span>&nbsp;<span class="ident" id="6267020">mode</span><span class="op" id="6267024">)</span><br>
<span class="lineno"></span><span class="op" id="6267026">}</span><br>
<span class="lineno">995</span><br>
<span class="lineno"></span><span class="keyword" id="6267029">var</span>&nbsp;<span class="ident" id="6267033">slashslash</span>&nbsp;<span class="op" id="6267044">=</span>&nbsp;<span class="op" id="6267046">[</span><span class="op" id="6267047">]</span><span class="builtintype" id="6267048">byte</span><span class="op" id="6267052">(</span><span class="string" id="6267053">&#34;//&#34;</span><span class="op" id="6267057">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6267060">//&nbsp;shouldBuild&nbsp;reports&nbsp;whether&nbsp;it&nbsp;is&nbsp;okay&nbsp;to&nbsp;use&nbsp;this&nbsp;file,</span><br>
<span class="lineno"></span><span class="comment" id="6267120">//&nbsp;The&nbsp;rule&nbsp;is&nbsp;that&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;leading&nbsp;run&nbsp;of&nbsp;//&nbsp;comments</span><br>
<span class="lineno">1000</span><span class="comment" id="6267181">//&nbsp;and&nbsp;blank&nbsp;lines,&nbsp;which&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;blank&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="6267240">//&nbsp;(to&nbsp;avoid&nbsp;including&nbsp;a&nbsp;Go&nbsp;package&nbsp;clause&nbsp;doc&nbsp;comment),</span><br>
<span class="lineno"></span><span class="comment" id="6267297">//&nbsp;lines&nbsp;beginning&nbsp;with&nbsp;&#39;//&nbsp;+build&#39;&nbsp;are&nbsp;taken&nbsp;as&nbsp;build&nbsp;directives.</span><br>
<span class="lineno"></span><span class="comment" id="6267364">//</span><br>
<span class="lineno"></span><span class="comment" id="6267367">//&nbsp;The&nbsp;file&nbsp;is&nbsp;accepted&nbsp;only&nbsp;if&nbsp;each&nbsp;such&nbsp;line&nbsp;lists&nbsp;something</span><br>
<span class="lineno">1005</span><span class="comment" id="6267430">//&nbsp;matching&nbsp;the&nbsp;file.&nbsp;&nbsp;For&nbsp;example:</span><br>
<span class="lineno"></span><span class="comment" id="6267466">//</span><br>
<span class="lineno"></span><span class="comment" id="6267469">//&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;+build&nbsp;windows&nbsp;linux</span><br>
<span class="lineno"></span><span class="comment" id="6267496">//</span><br>
<span class="lineno"></span><span class="comment" id="6267499">//&nbsp;marks&nbsp;the&nbsp;file&nbsp;as&nbsp;applicable&nbsp;only&nbsp;on&nbsp;Windows&nbsp;and&nbsp;Linux.</span><br>
<span class="lineno">1010</span><span class="comment" id="6267558">//</span><br>
<span class="lineno"></span><span class="keyword" id="6267561">func</span>&nbsp;<span class="op" id="6267566">(</span><span class="ident" id="6267567">ctxt</span>&nbsp;<span class="op" id="6267572">*</span><span class="ident" id="6267573">Context</span><span class="op" id="6267580">)</span>&nbsp;<span class="ident" id="6267582">shouldBuild</span><span class="op" id="6267593">(</span><span class="ident" id="6267594">content</span>&nbsp;<span class="op" id="6267602">[</span><span class="op" id="6267603">]</span><span class="builtintype" id="6267604">byte</span><span class="op" id="6267608">,</span>&nbsp;<span class="ident" id="6267610">allTags</span>&nbsp;<span class="keyword" id="6267618">map</span><span class="op" id="6267621">[</span><span class="builtintype" id="6267622">string</span><span class="op" id="6267628">]</span><span class="builtintype" id="6267629">bool</span><span class="op" id="6267633">)</span>&nbsp;<span class="builtintype" id="6267635">bool</span>&nbsp;<span class="op" id="6267640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6267643">//&nbsp;Pass&nbsp;1.&nbsp;Identify&nbsp;leading&nbsp;run&nbsp;of&nbsp;//&nbsp;comments&nbsp;and&nbsp;blank&nbsp;lines,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6267708">//&nbsp;which&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;blank&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6267752">end</span>&nbsp;<span class="op" id="6267756">:=</span>&nbsp;<span class="num" id="6267759">0</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6267762">p</span>&nbsp;<span class="op" id="6267764">:=</span>&nbsp;<span class="ident" id="6267767">content</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6267776">for</span>&nbsp;<span class="builtinfunc" id="6267780">len</span><span class="op" id="6267783">(</span><span class="ident" id="6267784">p</span><span class="op" id="6267785">)</span>&nbsp;<span class="op" id="6267787">&gt;</span>&nbsp;<span class="num" id="6267789">0</span>&nbsp;<span class="op" id="6267791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6267795">line</span>&nbsp;<span class="op" id="6267800">:=</span>&nbsp;<span class="ident" id="6267803">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6267807">if</span>&nbsp;<span class="ident" id="6267810">i</span>&nbsp;<span class="op" id="6267812">:=</span>&nbsp;<span class="ident" id="6267815">bytes</span><span class="op" id="6267820">.</span><span class="ident" id="6267821">IndexByte</span><span class="op" id="6267830">(</span><span class="ident" id="6267831">line</span><span class="op" id="6267835">,</span>&nbsp;<span class="string" id="6267837">&#39;\n&#39;</span><span class="op" id="6267841">)</span><span class="op" id="6267842">;</span>&nbsp;<span class="ident" id="6267844">i</span>&nbsp;<span class="op" id="6267846">&gt;=</span>&nbsp;<span class="num" id="6267849">0</span>&nbsp;<span class="op" id="6267851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6267856">line</span><span class="op" id="6267860">,</span>&nbsp;<span class="ident" id="6267862">p</span>&nbsp;<span class="op" id="6267864">=</span>&nbsp;<span class="ident" id="6267866">line</span><span class="op" id="6267870">[</span><span class="op" id="6267871">:</span><span class="ident" id="6267872">i</span><span class="op" id="6267873">]</span><span class="op" id="6267874">,</span>&nbsp;<span class="ident" id="6267876">p</span><span class="op" id="6267877">[</span><span class="ident" id="6267878">i</span><span class="op" id="6267879">+</span><span class="num" id="6267880">1</span><span class="op" id="6267881">:</span><span class="op" id="6267882">]</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6267886">}</span>&nbsp;<span class="keyword" id="6267888">else</span>&nbsp;<span class="op" id="6267893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6267898">p</span>&nbsp;<span class="op" id="6267900">=</span>&nbsp;<span class="ident" id="6267902">p</span><span class="op" id="6267903">[</span><span class="builtinfunc" id="6267904">len</span><span class="op" id="6267907">(</span><span class="ident" id="6267908">p</span><span class="op" id="6267909">)</span><span class="op" id="6267910">:</span><span class="op" id="6267911">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6267915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6267919">line</span>&nbsp;<span class="op" id="6267924">=</span>&nbsp;<span class="ident" id="6267926">bytes</span><span class="op" id="6267931">.</span><span class="ident" id="6267932">TrimSpace</span><span class="op" id="6267941">(</span><span class="ident" id="6267942">line</span><span class="op" id="6267946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6267950">if</span>&nbsp;<span class="builtinfunc" id="6267953">len</span><span class="op" id="6267956">(</span><span class="ident" id="6267957">line</span><span class="op" id="6267961">)</span>&nbsp;<span class="op" id="6267963">==</span>&nbsp;<span class="num" id="6267966">0</span>&nbsp;<span class="op" id="6267968">{</span>&nbsp;<span class="comment" id="6267970">//&nbsp;Blank&nbsp;line</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6267987">end</span>&nbsp;<span class="op" id="6267991">=</span>&nbsp;<span class="builtinfunc" id="6267993">len</span><span class="op" id="6267996">(</span><span class="ident" id="6267997">content</span><span class="op" id="6268004">)</span>&nbsp;<span class="op" id="6268006">-</span>&nbsp;<span class="builtinfunc" id="6268008">len</span><span class="op" id="6268011">(</span><span class="ident" id="6268012">p</span><span class="op" id="6268013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6268018">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6268029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6268033">if</span>&nbsp;<span class="op" id="6268036">!</span><span class="ident" id="6268037">bytes</span><span class="op" id="6268042">.</span><span class="ident" id="6268043">HasPrefix</span><span class="op" id="6268052">(</span><span class="ident" id="6268053">line</span><span class="op" id="6268057">,</span>&nbsp;<span class="ident" id="6268059">slashslash</span><span class="op" id="6268069">)</span>&nbsp;<span class="op" id="6268071">{</span>&nbsp;<span class="comment" id="6268073">//&nbsp;Not&nbsp;comment&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6268096">break</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6268104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6268107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6268110">content</span>&nbsp;<span class="op" id="6268118">=</span>&nbsp;<span class="ident" id="6268120">content</span><span class="op" id="6268127">[</span><span class="op" id="6268128">:</span><span class="ident" id="6268129">end</span><span class="op" id="6268132">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6268136">//&nbsp;Pass&nbsp;2.&nbsp;&nbsp;Process&nbsp;each&nbsp;line&nbsp;in&nbsp;the&nbsp;run.</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6268179">p</span>&nbsp;<span class="op" id="6268181">=</span>&nbsp;<span class="ident" id="6268183">content</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6268192">allok</span>&nbsp;<span class="op" id="6268198">:=</span>&nbsp;<span class="builtintype" id="6268201">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6268207">for</span>&nbsp;<span class="builtinfunc" id="6268211">len</span><span class="op" id="6268214">(</span><span class="ident" id="6268215">p</span><span class="op" id="6268216">)</span>&nbsp;<span class="op" id="6268218">&gt;</span>&nbsp;<span class="num" id="6268220">0</span>&nbsp;<span class="op" id="6268222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6268226">line</span>&nbsp;<span class="op" id="6268231">:=</span>&nbsp;<span class="ident" id="6268234">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6268238">if</span>&nbsp;<span class="ident" id="6268241">i</span>&nbsp;<span class="op" id="6268243">:=</span>&nbsp;<span class="ident" id="6268246">bytes</span><span class="op" id="6268251">.</span><span class="ident" id="6268252">IndexByte</span><span class="op" id="6268261">(</span><span class="ident" id="6268262">line</span><span class="op" id="6268266">,</span>&nbsp;<span class="string" id="6268268">&#39;\n&#39;</span><span class="op" id="6268272">)</span><span class="op" id="6268273">;</span>&nbsp;<span class="ident" id="6268275">i</span>&nbsp;<span class="op" id="6268277">&gt;=</span>&nbsp;<span class="num" id="6268280">0</span>&nbsp;<span class="op" id="6268282">{</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6268287">line</span><span class="op" id="6268291">,</span>&nbsp;<span class="ident" id="6268293">p</span>&nbsp;<span class="op" id="6268295">=</span>&nbsp;<span class="ident" id="6268297">line</span><span class="op" id="6268301">[</span><span class="op" id="6268302">:</span><span class="ident" id="6268303">i</span><span class="op" id="6268304">]</span><span class="op" id="6268305">,</span>&nbsp;<span class="ident" id="6268307">p</span><span class="op" id="6268308">[</span><span class="ident" id="6268309">i</span><span class="op" id="6268310">+</span><span class="num" id="6268311">1</span><span class="op" id="6268312">:</span><span class="op" id="6268313">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6268317">}</span>&nbsp;<span class="keyword" id="6268319">else</span>&nbsp;<span class="op" id="6268324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6268329">p</span>&nbsp;<span class="op" id="6268331">=</span>&nbsp;<span class="ident" id="6268333">p</span><span class="op" id="6268334">[</span><span class="builtinfunc" id="6268335">len</span><span class="op" id="6268338">(</span><span class="ident" id="6268339">p</span><span class="op" id="6268340">)</span><span class="op" id="6268341">:</span><span class="op" id="6268342">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6268346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6268350">line</span>&nbsp;<span class="op" id="6268355">=</span>&nbsp;<span class="ident" id="6268357">bytes</span><span class="op" id="6268362">.</span><span class="ident" id="6268363">TrimSpace</span><span class="op" id="6268372">(</span><span class="ident" id="6268373">line</span><span class="op" id="6268377">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6268381">if</span>&nbsp;<span class="ident" id="6268384">bytes</span><span class="op" id="6268389">.</span><span class="ident" id="6268390">HasPrefix</span><span class="op" id="6268399">(</span><span class="ident" id="6268400">line</span><span class="op" id="6268404">,</span>&nbsp;<span class="ident" id="6268406">slashslash</span><span class="op" id="6268416">)</span>&nbsp;<span class="op" id="6268418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6268423">line</span>&nbsp;<span class="op" id="6268428">=</span>&nbsp;<span class="ident" id="6268430">bytes</span><span class="op" id="6268435">.</span><span class="ident" id="6268436">TrimSpace</span><span class="op" id="6268445">(</span><span class="ident" id="6268446">line</span><span class="op" id="6268450">[</span><span class="builtinfunc" id="6268451">len</span><span class="op" id="6268454">(</span><span class="ident" id="6268455">slashslash</span><span class="op" id="6268465">)</span><span class="op" id="6268466">:</span><span class="op" id="6268467">]</span><span class="op" id="6268468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6268473">if</span>&nbsp;<span class="builtinfunc" id="6268476">len</span><span class="op" id="6268479">(</span><span class="ident" id="6268480">line</span><span class="op" id="6268484">)</span>&nbsp;<span class="op" id="6268486">&gt;</span>&nbsp;<span class="num" id="6268488">0</span>&nbsp;<span class="op" id="6268490">&amp;&amp;</span>&nbsp;<span class="ident" id="6268493">line</span><span class="op" id="6268497">[</span><span class="num" id="6268498">0</span><span class="op" id="6268499">]</span>&nbsp;<span class="op" id="6268501">==</span>&nbsp;<span class="string" id="6268504">&#39;+&#39;</span>&nbsp;<span class="op" id="6268508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6268514">//&nbsp;Looks&nbsp;like&nbsp;a&nbsp;comment&nbsp;+line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6268549">f</span>&nbsp;<span class="op" id="6268551">:=</span>&nbsp;<span class="ident" id="6268554">strings</span><span class="op" id="6268561">.</span><span class="ident" id="6268562">Fields</span><span class="op" id="6268568">(</span><span class="builtintype" id="6268569">string</span><span class="op" id="6268575">(</span><span class="ident" id="6268576">line</span><span class="op" id="6268580">)</span><span class="op" id="6268581">)</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6268587">if</span>&nbsp;<span class="ident" id="6268590">f</span><span class="op" id="6268591">[</span><span class="num" id="6268592">0</span><span class="op" id="6268593">]</span>&nbsp;<span class="op" id="6268595">==</span>&nbsp;<span class="string" id="6268598">&#34;+build&#34;</span>&nbsp;<span class="op" id="6268607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6268614">ok</span>&nbsp;<span class="op" id="6268617">:=</span>&nbsp;<span class="builtintype" id="6268620">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6268631">for</span>&nbsp;<span class="ident" id="6268635">_</span><span class="op" id="6268636">,</span>&nbsp;<span class="ident" id="6268638">tok</span>&nbsp;<span class="op" id="6268642">:=</span>&nbsp;<span class="keyword" id="6268645">range</span>&nbsp;<span class="ident" id="6268651">f</span><span class="op" id="6268652">[</span><span class="num" id="6268653">1</span><span class="op" id="6268654">:</span><span class="op" id="6268655">]</span>&nbsp;<span class="op" id="6268657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6268665">if</span>&nbsp;<span class="ident" id="6268668">ctxt</span><span class="op" id="6268672">.</span><span class="ident" id="6268673">match</span><span class="op" id="6268678">(</span><span class="ident" id="6268679">tok</span><span class="op" id="6268682">,</span>&nbsp;<span class="ident" id="6268684">allTags</span><span class="op" id="6268691">)</span>&nbsp;<span class="op" id="6268693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6268702">ok</span>&nbsp;<span class="op" id="6268705">=</span>&nbsp;<span class="builtintype" id="6268707">true</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6268718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6268725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6268732">if</span>&nbsp;<span class="op" id="6268735">!</span><span class="ident" id="6268736">ok</span>&nbsp;<span class="op" id="6268739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6268747">allok</span>&nbsp;<span class="op" id="6268753">=</span>&nbsp;<span class="builtintype" id="6268755">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6268766">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6268772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6268777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6268781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6268784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6268788">return</span>&nbsp;<span class="ident" id="6268795">allok</span><br>
<span class="lineno"></span><span class="op" id="6268801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6268804">//&nbsp;saveCgo&nbsp;saves&nbsp;the&nbsp;information&nbsp;from&nbsp;the&nbsp;#cgo&nbsp;lines&nbsp;in&nbsp;the&nbsp;import&nbsp;&#34;C&#34;&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="6268884">//&nbsp;These&nbsp;lines&nbsp;set&nbsp;CFLAGS,&nbsp;CPPFLAGS,&nbsp;CXXFLAGS&nbsp;and&nbsp;LDFLAGS&nbsp;and&nbsp;pkg-config&nbsp;directives</span><br>
<span class="lineno">1070</span><span class="comment" id="6268968">//&nbsp;that&nbsp;affect&nbsp;the&nbsp;way&nbsp;cgo&#39;s&nbsp;C&nbsp;code&nbsp;is&nbsp;built.</span><br>
<span class="lineno"></span><span class="comment" id="6269014">//</span><br>
<span class="lineno"></span><span class="comment" id="6269017">//&nbsp;TODO(rsc):&nbsp;This&nbsp;duplicates&nbsp;code&nbsp;in&nbsp;cgo.</span><br>
<span class="lineno"></span><span class="comment" id="6269060">//&nbsp;Once&nbsp;the&nbsp;dust&nbsp;settles,&nbsp;remove&nbsp;this&nbsp;code&nbsp;from&nbsp;cgo.</span><br>
<span class="lineno"></span><span class="keyword" id="6269113">func</span>&nbsp;<span class="op" id="6269118">(</span><span class="ident" id="6269119">ctxt</span>&nbsp;<span class="op" id="6269124">*</span><span class="ident" id="6269125">Context</span><span class="op" id="6269132">)</span>&nbsp;<span class="ident" id="6269134">saveCgo</span><span class="op" id="6269141">(</span><span class="ident" id="6269142">filename</span>&nbsp;<span class="builtintype" id="6269151">string</span><span class="op" id="6269157">,</span>&nbsp;<span class="ident" id="6269159">di</span>&nbsp;<span class="op" id="6269162">*</span><span class="ident" id="6269163">Package</span><span class="op" id="6269170">,</span>&nbsp;<span class="ident" id="6269172">cg</span>&nbsp;<span class="op" id="6269175">*</span><span class="ident" id="6269176">ast</span><span class="op" id="6269179">.</span><span class="ident" id="6269180">CommentGroup</span><span class="op" id="6269192">)</span>&nbsp;<span class="builtintype" id="6269194">error</span>&nbsp;<span class="op" id="6269200">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269203">text</span>&nbsp;<span class="op" id="6269208">:=</span>&nbsp;<span class="ident" id="6269211">cg</span><span class="op" id="6269213">.</span><span class="ident" id="6269214">Text</span><span class="op" id="6269218">(</span><span class="op" id="6269219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6269222">for</span>&nbsp;<span class="ident" id="6269226">_</span><span class="op" id="6269227">,</span>&nbsp;<span class="ident" id="6269229">line</span>&nbsp;<span class="op" id="6269234">:=</span>&nbsp;<span class="keyword" id="6269237">range</span>&nbsp;<span class="ident" id="6269243">strings</span><span class="op" id="6269250">.</span><span class="ident" id="6269251">Split</span><span class="op" id="6269256">(</span><span class="ident" id="6269257">text</span><span class="op" id="6269261">,</span>&nbsp;<span class="string" id="6269263">&#34;\n&#34;</span><span class="op" id="6269267">)</span>&nbsp;<span class="op" id="6269269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269273">orig</span>&nbsp;<span class="op" id="6269278">:=</span>&nbsp;<span class="ident" id="6269281">line</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6269289">//&nbsp;Line&nbsp;is</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6269302">//&nbsp;&nbsp;&nbsp;&nbsp#cgo&nbsp;[GOOS/GOARCH...]&nbsp;LDFLAGS:&nbsp;stuff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6269344">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269349">line</span>&nbsp;<span class="op" id="6269354">=</span>&nbsp;<span class="ident" id="6269356">strings</span><span class="op" id="6269363">.</span><span class="ident" id="6269364">TrimSpace</span><span class="op" id="6269373">(</span><span class="ident" id="6269374">line</span><span class="op" id="6269378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6269382">if</span>&nbsp;<span class="builtinfunc" id="6269385">len</span><span class="op" id="6269388">(</span><span class="ident" id="6269389">line</span><span class="op" id="6269393">)</span>&nbsp;<span class="op" id="6269395">&lt;</span>&nbsp;<span class="num" id="6269397">5</span>&nbsp;<span class="op" id="6269399">||</span>&nbsp;<span class="ident" id="6269402">line</span><span class="op" id="6269406">[</span><span class="op" id="6269407">:</span><span class="num" id="6269408">4</span><span class="op" id="6269409">]</span>&nbsp;<span class="op" id="6269411">!=</span>&nbsp;<span class="string" id="6269414">&#34;#cgo&#34;</span>&nbsp;<span class="op" id="6269421">||</span>&nbsp;<span class="op" id="6269424">(</span><span class="ident" id="6269425">line</span><span class="op" id="6269429">[</span><span class="num" id="6269430">4</span><span class="op" id="6269431">]</span>&nbsp;<span class="op" id="6269433">!=</span>&nbsp;<span class="string" id="6269436">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="6269440">&amp;&amp;</span>&nbsp;<span class="ident" id="6269443">line</span><span class="op" id="6269447">[</span><span class="num" id="6269448">4</span><span class="op" id="6269449">]</span>&nbsp;<span class="op" id="6269451">!=</span>&nbsp;<span class="string" id="6269454">&#39;\t&#39;</span><span class="op" id="6269458">)</span>&nbsp;<span class="op" id="6269460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6269465">continue</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6269476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6269481">//&nbsp;Split&nbsp;at&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269502">line</span>&nbsp;<span class="op" id="6269507">=</span>&nbsp;<span class="ident" id="6269509">strings</span><span class="op" id="6269516">.</span><span class="ident" id="6269517">TrimSpace</span><span class="op" id="6269526">(</span><span class="ident" id="6269527">line</span><span class="op" id="6269531">[</span><span class="num" id="6269532">4</span><span class="op" id="6269533">:</span><span class="op" id="6269534">]</span><span class="op" id="6269535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269539">i</span>&nbsp;<span class="op" id="6269541">:=</span>&nbsp;<span class="ident" id="6269544">strings</span><span class="op" id="6269551">.</span><span class="ident" id="6269552">Index</span><span class="op" id="6269557">(</span><span class="ident" id="6269558">line</span><span class="op" id="6269562">,</span>&nbsp;<span class="string" id="6269564">&#34;:&#34;</span><span class="op" id="6269567">)</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6269571">if</span>&nbsp;<span class="ident" id="6269574">i</span>&nbsp;<span class="op" id="6269576">&lt;</span>&nbsp;<span class="num" id="6269578">0</span>&nbsp;<span class="op" id="6269580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6269585">return</span>&nbsp;<span class="ident" id="6269592">fmt</span><span class="op" id="6269595">.</span><span class="ident" id="6269596">Errorf</span><span class="op" id="6269602">(</span><span class="string" id="6269603">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="6269630">,</span>&nbsp;<span class="ident" id="6269632">filename</span><span class="op" id="6269640">,</span>&nbsp;<span class="ident" id="6269642">orig</span><span class="op" id="6269646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6269650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269654">line</span><span class="op" id="6269658">,</span>&nbsp;<span class="ident" id="6269660">argstr</span>&nbsp;<span class="op" id="6269667">:=</span>&nbsp;<span class="ident" id="6269670">line</span><span class="op" id="6269674">[</span><span class="op" id="6269675">:</span><span class="ident" id="6269676">i</span><span class="op" id="6269677">]</span><span class="op" id="6269678">,</span>&nbsp;<span class="ident" id="6269680">line</span><span class="op" id="6269684">[</span><span class="ident" id="6269685">i</span><span class="op" id="6269686">+</span><span class="num" id="6269687">1</span><span class="op" id="6269688">:</span><span class="op" id="6269689">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6269694">//&nbsp;Parse&nbsp;GOOS/GOARCH&nbsp;stuff.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269724">f</span>&nbsp;<span class="op" id="6269726">:=</span>&nbsp;<span class="ident" id="6269729">strings</span><span class="op" id="6269736">.</span><span class="ident" id="6269737">Fields</span><span class="op" id="6269743">(</span><span class="ident" id="6269744">line</span><span class="op" id="6269748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6269752">if</span>&nbsp;<span class="builtinfunc" id="6269755">len</span><span class="op" id="6269758">(</span><span class="ident" id="6269759">f</span><span class="op" id="6269760">)</span>&nbsp;<span class="op" id="6269762">&lt;</span>&nbsp;<span class="num" id="6269764">1</span>&nbsp;<span class="op" id="6269766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6269771">return</span>&nbsp;<span class="ident" id="6269778">fmt</span><span class="op" id="6269781">.</span><span class="ident" id="6269782">Errorf</span><span class="op" id="6269788">(</span><span class="string" id="6269789">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="6269816">,</span>&nbsp;<span class="ident" id="6269818">filename</span><span class="op" id="6269826">,</span>&nbsp;<span class="ident" id="6269828">orig</span><span class="op" id="6269832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6269836">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269841">cond</span><span class="op" id="6269845">,</span>&nbsp;<span class="ident" id="6269847">verb</span>&nbsp;<span class="op" id="6269852">:=</span>&nbsp;<span class="ident" id="6269855">f</span><span class="op" id="6269856">[</span><span class="op" id="6269857">:</span><span class="builtinfunc" id="6269858">len</span><span class="op" id="6269861">(</span><span class="ident" id="6269862">f</span><span class="op" id="6269863">)</span><span class="op" id="6269864">-</span><span class="num" id="6269865">1</span><span class="op" id="6269866">]</span><span class="op" id="6269867">,</span>&nbsp;<span class="ident" id="6269869">f</span><span class="op" id="6269870">[</span><span class="builtinfunc" id="6269871">len</span><span class="op" id="6269874">(</span><span class="ident" id="6269875">f</span><span class="op" id="6269876">)</span><span class="op" id="6269877">-</span><span class="num" id="6269878">1</span><span class="op" id="6269879">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6269883">if</span>&nbsp;<span class="builtinfunc" id="6269886">len</span><span class="op" id="6269889">(</span><span class="ident" id="6269890">cond</span><span class="op" id="6269894">)</span>&nbsp;<span class="op" id="6269896">&gt;</span>&nbsp;<span class="num" id="6269898">0</span>&nbsp;<span class="op" id="6269900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269905">ok</span>&nbsp;<span class="op" id="6269908">:=</span>&nbsp;<span class="builtintype" id="6269911">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6269920">for</span>&nbsp;<span class="ident" id="6269924">_</span><span class="op" id="6269925">,</span>&nbsp;<span class="ident" id="6269927">c</span>&nbsp;<span class="op" id="6269929">:=</span>&nbsp;<span class="keyword" id="6269932">range</span>&nbsp;<span class="ident" id="6269938">cond</span>&nbsp;<span class="op" id="6269943">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6269949">if</span>&nbsp;<span class="ident" id="6269952">ctxt</span><span class="op" id="6269956">.</span><span class="ident" id="6269957">match</span><span class="op" id="6269962">(</span><span class="ident" id="6269963">c</span><span class="op" id="6269964">,</span>&nbsp;<span class="ident" id="6269966">nil</span><span class="op" id="6269969">)</span>&nbsp;<span class="op" id="6269971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269978">ok</span>&nbsp;<span class="op" id="6269981">=</span>&nbsp;<span class="builtintype" id="6269983">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6269993">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6270003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6270008">}</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270013">if</span>&nbsp;<span class="op" id="6270016">!</span><span class="ident" id="6270017">ok</span>&nbsp;<span class="op" id="6270020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270026">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6270038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6270042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6270047">args</span><span class="op" id="6270051">,</span>&nbsp;<span class="ident" id="6270053">err</span>&nbsp;<span class="op" id="6270057">:=</span>&nbsp;<span class="ident" id="6270060">splitQuoted</span><span class="op" id="6270071">(</span><span class="ident" id="6270072">argstr</span><span class="op" id="6270078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270082">if</span>&nbsp;<span class="ident" id="6270085">err</span>&nbsp;<span class="op" id="6270089">!=</span>&nbsp;<span class="ident" id="6270092">nil</span>&nbsp;<span class="op" id="6270096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270101">return</span>&nbsp;<span class="ident" id="6270108">fmt</span><span class="op" id="6270111">.</span><span class="ident" id="6270112">Errorf</span><span class="op" id="6270118">(</span><span class="string" id="6270119">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="6270146">,</span>&nbsp;<span class="ident" id="6270148">filename</span><span class="op" id="6270156">,</span>&nbsp;<span class="ident" id="6270158">orig</span><span class="op" id="6270162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6270166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270170">for</span>&nbsp;<span class="ident" id="6270174">_</span><span class="op" id="6270175">,</span>&nbsp;<span class="ident" id="6270177">arg</span>&nbsp;<span class="op" id="6270181">:=</span>&nbsp;<span class="keyword" id="6270184">range</span>&nbsp;<span class="ident" id="6270190">args</span>&nbsp;<span class="op" id="6270195">{</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270200">if</span>&nbsp;<span class="op" id="6270203">!</span><span class="ident" id="6270204">safeCgoName</span><span class="op" id="6270215">(</span><span class="ident" id="6270216">arg</span><span class="op" id="6270219">)</span>&nbsp;<span class="op" id="6270221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270227">return</span>&nbsp;<span class="ident" id="6270234">fmt</span><span class="op" id="6270237">.</span><span class="ident" id="6270238">Errorf</span><span class="op" id="6270244">(</span><span class="string" id="6270245">&#34;%s:&nbsp;malformed&nbsp;#cgo&nbsp;argument:&nbsp;%s&#34;</span><span class="op" id="6270278">,</span>&nbsp;<span class="ident" id="6270280">filename</span><span class="op" id="6270288">,</span>&nbsp;<span class="ident" id="6270290">arg</span><span class="op" id="6270293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6270298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6270302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270307">switch</span>&nbsp;<span class="ident" id="6270314">verb</span>&nbsp;<span class="op" id="6270319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270323">case</span>&nbsp;<span class="string" id="6270328">&#34;CFLAGS&#34;</span><span class="op" id="6270336">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6270341">di</span><span class="op" id="6270343">.</span><span class="ident" id="6270344">CgoCFLAGS</span>&nbsp;<span class="op" id="6270354">=</span>&nbsp;<span class="builtinfunc" id="6270356">append</span><span class="op" id="6270362">(</span><span class="ident" id="6270363">di</span><span class="op" id="6270365">.</span><span class="ident" id="6270366">CgoCFLAGS</span><span class="op" id="6270375">,</span>&nbsp;<span class="ident" id="6270377">args</span><span class="op" id="6270381">...</span><span class="op" id="6270384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270388">case</span>&nbsp;<span class="string" id="6270393">&#34;CPPFLAGS&#34;</span><span class="op" id="6270403">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6270408">di</span><span class="op" id="6270410">.</span><span class="ident" id="6270411">CgoCPPFLAGS</span>&nbsp;<span class="op" id="6270423">=</span>&nbsp;<span class="builtinfunc" id="6270425">append</span><span class="op" id="6270431">(</span><span class="ident" id="6270432">di</span><span class="op" id="6270434">.</span><span class="ident" id="6270435">CgoCPPFLAGS</span><span class="op" id="6270446">,</span>&nbsp;<span class="ident" id="6270448">args</span><span class="op" id="6270452">...</span><span class="op" id="6270455">)</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270459">case</span>&nbsp;<span class="string" id="6270464">&#34;CXXFLAGS&#34;</span><span class="op" id="6270474">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6270479">di</span><span class="op" id="6270481">.</span><span class="ident" id="6270482">CgoCXXFLAGS</span>&nbsp;<span class="op" id="6270494">=</span>&nbsp;<span class="builtinfunc" id="6270496">append</span><span class="op" id="6270502">(</span><span class="ident" id="6270503">di</span><span class="op" id="6270505">.</span><span class="ident" id="6270506">CgoCXXFLAGS</span><span class="op" id="6270517">,</span>&nbsp;<span class="ident" id="6270519">args</span><span class="op" id="6270523">...</span><span class="op" id="6270526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270530">case</span>&nbsp;<span class="string" id="6270535">&#34;LDFLAGS&#34;</span><span class="op" id="6270544">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6270549">di</span><span class="op" id="6270551">.</span><span class="ident" id="6270552">CgoLDFLAGS</span>&nbsp;<span class="op" id="6270563">=</span>&nbsp;<span class="builtinfunc" id="6270565">append</span><span class="op" id="6270571">(</span><span class="ident" id="6270572">di</span><span class="op" id="6270574">.</span><span class="ident" id="6270575">CgoLDFLAGS</span><span class="op" id="6270585">,</span>&nbsp;<span class="ident" id="6270587">args</span><span class="op" id="6270591">...</span><span class="op" id="6270594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270598">case</span>&nbsp;<span class="string" id="6270603">&#34;pkg-config&#34;</span><span class="op" id="6270615">:</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6270620">di</span><span class="op" id="6270622">.</span><span class="ident" id="6270623">CgoPkgConfig</span>&nbsp;<span class="op" id="6270636">=</span>&nbsp;<span class="builtinfunc" id="6270638">append</span><span class="op" id="6270644">(</span><span class="ident" id="6270645">di</span><span class="op" id="6270647">.</span><span class="ident" id="6270648">CgoPkgConfig</span><span class="op" id="6270660">,</span>&nbsp;<span class="ident" id="6270662">args</span><span class="op" id="6270666">...</span><span class="op" id="6270669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270673">default</span><span class="op" id="6270680">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270685">return</span>&nbsp;<span class="ident" id="6270692">fmt</span><span class="op" id="6270695">.</span><span class="ident" id="6270696">Errorf</span><span class="op" id="6270702">(</span><span class="string" id="6270703">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;verb:&nbsp;%s&#34;</span><span class="op" id="6270730">,</span>&nbsp;<span class="ident" id="6270732">filename</span><span class="op" id="6270740">,</span>&nbsp;<span class="ident" id="6270742">orig</span><span class="op" id="6270746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6270750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6270753">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270756">return</span>&nbsp;<span class="ident" id="6270763">nil</span><br>
<span class="lineno"></span><span class="op" id="6270767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6270770">//&nbsp;NOTE:&nbsp;$&nbsp;is&nbsp;not&nbsp;safe&nbsp;for&nbsp;the&nbsp;shell,&nbsp;but&nbsp;it&nbsp;is&nbsp;allowed&nbsp;here&nbsp;because&nbsp;of&nbsp;linker&nbsp;options&nbsp;like&nbsp;-Wl,$ORIGIN.</span><br>
<span class="lineno"></span><span class="comment" id="6270875">//&nbsp;We&nbsp;never&nbsp;pass&nbsp;these&nbsp;arguments&nbsp;to&nbsp;a&nbsp;shell&nbsp;(just&nbsp;to&nbsp;programs&nbsp;we&nbsp;construct&nbsp;argv&nbsp;for),&nbsp;so&nbsp;this&nbsp;should&nbsp;be&nbsp;okay.</span><br>
<span class="lineno">1145</span><span class="comment" id="6270985">//&nbsp;See&nbsp;golang.org/issue/6038.</span><br>
<span class="lineno"></span><span class="keyword" id="6271015">var</span>&nbsp;<span class="ident" id="6271019">safeBytes</span>&nbsp;<span class="op" id="6271029">=</span>&nbsp;<span class="op" id="6271031">[</span><span class="op" id="6271032">]</span><span class="builtintype" id="6271033">byte</span><span class="op" id="6271037">(</span><span class="string" id="6271038">&#34;+-.,/0123456789=ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz:$&#34;</span><span class="op" id="6271111">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6271114">func</span>&nbsp;<span class="ident" id="6271119">safeCgoName</span><span class="op" id="6271130">(</span><span class="ident" id="6271131">s</span>&nbsp;<span class="builtintype" id="6271133">string</span><span class="op" id="6271139">)</span>&nbsp;<span class="builtintype" id="6271141">bool</span>&nbsp;<span class="op" id="6271146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6271149">if</span>&nbsp;<span class="ident" id="6271152">s</span>&nbsp;<span class="op" id="6271154">==</span>&nbsp;<span class="string" id="6271157">&#34;&#34;</span>&nbsp;<span class="op" id="6271160">{</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6271164">return</span>&nbsp;<span class="builtintype" id="6271171">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6271178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6271181">for</span>&nbsp;<span class="ident" id="6271185">i</span>&nbsp;<span class="op" id="6271187">:=</span>&nbsp;<span class="num" id="6271190">0</span><span class="op" id="6271191">;</span>&nbsp;<span class="ident" id="6271193">i</span>&nbsp;<span class="op" id="6271195">&lt;</span>&nbsp;<span class="builtinfunc" id="6271197">len</span><span class="op" id="6271200">(</span><span class="ident" id="6271201">s</span><span class="op" id="6271202">)</span><span class="op" id="6271203">;</span>&nbsp;<span class="ident" id="6271205">i</span><span class="op" id="6271206">++</span>&nbsp;<span class="op" id="6271209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6271213">if</span>&nbsp;<span class="ident" id="6271216">c</span>&nbsp;<span class="op" id="6271218">:=</span>&nbsp;<span class="ident" id="6271221">s</span><span class="op" id="6271222">[</span><span class="ident" id="6271223">i</span><span class="op" id="6271224">]</span><span class="op" id="6271225">;</span>&nbsp;<span class="ident" id="6271227">c</span>&nbsp;<span class="op" id="6271229">&lt;</span>&nbsp;<span class="num" id="6271231">0x80</span>&nbsp;<span class="op" id="6271236">&amp;&amp;</span>&nbsp;<span class="ident" id="6271239">bytes</span><span class="op" id="6271244">.</span><span class="ident" id="6271245">IndexByte</span><span class="op" id="6271254">(</span><span class="ident" id="6271255">safeBytes</span><span class="op" id="6271264">,</span>&nbsp;<span class="ident" id="6271266">c</span><span class="op" id="6271267">)</span>&nbsp;<span class="op" id="6271269">&lt;</span>&nbsp;<span class="num" id="6271271">0</span>&nbsp;<span class="op" id="6271273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6271278">return</span>&nbsp;<span class="builtintype" id="6271285">false</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6271293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6271296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6271299">return</span>&nbsp;<span class="builtintype" id="6271306">true</span><br>
<span class="lineno"></span><span class="op" id="6271311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1160</span><span class="comment" id="6271314">//&nbsp;splitQuoted&nbsp;splits&nbsp;the&nbsp;string&nbsp;s&nbsp;around&nbsp;each&nbsp;instance&nbsp;of&nbsp;one&nbsp;or&nbsp;more&nbsp;consecutive</span><br>
<span class="lineno"></span><span class="comment" id="6271397">//&nbsp;white&nbsp;space&nbsp;characters&nbsp;while&nbsp;taking&nbsp;into&nbsp;account&nbsp;quotes&nbsp;and&nbsp;escaping,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6271474">//&nbsp;returns&nbsp;an&nbsp;array&nbsp;of&nbsp;substrings&nbsp;of&nbsp;s&nbsp;or&nbsp;an&nbsp;empty&nbsp;list&nbsp;if&nbsp;s&nbsp;contains&nbsp;only&nbsp;white&nbsp;space.</span><br>
<span class="lineno"></span><span class="comment" id="6271562">//&nbsp;Single&nbsp;quotes&nbsp;and&nbsp;double&nbsp;quotes&nbsp;are&nbsp;recognized&nbsp;to&nbsp;prevent&nbsp;splitting&nbsp;within&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6271644">//&nbsp;quoted&nbsp;region,&nbsp;and&nbsp;are&nbsp;removed&nbsp;from&nbsp;the&nbsp;resulting&nbsp;substrings.&nbsp;If&nbsp;a&nbsp;quote&nbsp;in&nbsp;s</span><br>
<span class="lineno">1165</span><span class="comment" id="6271725">//&nbsp;isn&#39;t&nbsp;closed&nbsp;err&nbsp;will&nbsp;be&nbsp;set&nbsp;and&nbsp;r&nbsp;will&nbsp;have&nbsp;the&nbsp;unclosed&nbsp;argument&nbsp;as&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6271802">//&nbsp;last&nbsp;element.&nbsp;&nbsp;The&nbsp;backslash&nbsp;is&nbsp;used&nbsp;for&nbsp;escaping.</span><br>
<span class="lineno"></span><span class="comment" id="6271856">//</span><br>
<span class="lineno"></span><span class="comment" id="6271859">//&nbsp;For&nbsp;example,&nbsp;the&nbsp;following&nbsp;string:</span><br>
<span class="lineno"></span><span class="comment" id="6271897">//</span><br>
<span class="lineno">1170</span><span class="comment" id="6271900">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;b:&#34;c&nbsp;d&#34;&nbsp;&#39;e&#39;&#39;f&#39;&nbsp;&nbsp;&#34;g\&#34;&#34;</span><br>
<span class="lineno"></span><span class="comment" id="6271931">//</span><br>
<span class="lineno"></span><span class="comment" id="6271934">//&nbsp;Would&nbsp;be&nbsp;parsed&nbsp;as:</span><br>
<span class="lineno"></span><span class="comment" id="6271957">//</span><br>
<span class="lineno"></span><span class="comment" id="6271960">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]string{&#34;a&#34;,&nbsp;&#34;b:c&nbsp;d&#34;,&nbsp;&#34;ef&#34;,&nbsp;`g&#34;`}</span><br>
<span class="lineno">1175</span><span class="comment" id="6272002">//</span><br>
<span class="lineno"></span><span class="keyword" id="6272005">func</span>&nbsp;<span class="ident" id="6272010">splitQuoted</span><span class="op" id="6272021">(</span><span class="ident" id="6272022">s</span>&nbsp;<span class="builtintype" id="6272024">string</span><span class="op" id="6272030">)</span>&nbsp;<span class="op" id="6272032">(</span><span class="ident" id="6272033">r</span>&nbsp;<span class="op" id="6272035">[</span><span class="op" id="6272036">]</span><span class="builtintype" id="6272037">string</span><span class="op" id="6272043">,</span>&nbsp;<span class="ident" id="6272045">err</span>&nbsp;<span class="builtintype" id="6272049">error</span><span class="op" id="6272054">)</span>&nbsp;<span class="op" id="6272056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6272059">var</span>&nbsp;<span class="ident" id="6272063">args</span>&nbsp;<span class="op" id="6272068">[</span><span class="op" id="6272069">]</span><span class="builtintype" id="6272070">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6272078">arg</span>&nbsp;<span class="op" id="6272082">:=</span>&nbsp;<span class="builtinfunc" id="6272085">make</span><span class="op" id="6272089">(</span><span class="op" id="6272090">[</span><span class="op" id="6272091">]</span><span class="builtintype" id="6272092">rune</span><span class="op" id="6272096">,</span>&nbsp;<span class="builtinfunc" id="6272098">len</span><span class="op" id="6272101">(</span><span class="ident" id="6272102">s</span><span class="op" id="6272103">)</span><span class="op" id="6272104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6272107">escaped</span>&nbsp;<span class="op" id="6272115">:=</span>&nbsp;<span class="builtintype" id="6272118">false</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6272125">quoted</span>&nbsp;<span class="op" id="6272132">:=</span>&nbsp;<span class="builtintype" id="6272135">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6272142">quote</span>&nbsp;<span class="op" id="6272148">:=</span>&nbsp;<span class="string" id="6272151">&#39;\x00&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6272159">i</span>&nbsp;<span class="op" id="6272161">:=</span>&nbsp;<span class="num" id="6272164">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6272167">for</span>&nbsp;<span class="ident" id="6272171">_</span><span class="op" id="6272172">,</span>&nbsp;<span class="builtintype" id="6272174">rune</span>&nbsp;<span class="op" id="6272179">:=</span>&nbsp;<span class="keyword" id="6272182">range</span>&nbsp;<span class="ident" id="6272188">s</span>&nbsp;<span class="op" id="6272190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6272194">switch</span>&nbsp;<span class="op" id="6272201">{</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6272205">case</span>&nbsp;<span class="ident" id="6272210">escaped</span><span class="op" id="6272217">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6272222">escaped</span>&nbsp;<span class="op" id="6272230">=</span>&nbsp;<span class="builtintype" id="6272232">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6272240">case</span>&nbsp;<span class="builtintype" id="6272245">rune</span>&nbsp;<span class="op" id="6272250">==</span>&nbsp;<span class="string" id="6272253">&#39;\\&#39;</span><span class="op" id="6272257">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6272262">escaped</span>&nbsp;<span class="op" id="6272270">=</span>&nbsp;<span class="builtintype" id="6272272">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6272280">continue</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6272291">case</span>&nbsp;<span class="ident" id="6272296">quote</span>&nbsp;<span class="op" id="6272302">!=</span>&nbsp;<span class="string" id="6272305">&#39;\x00&#39;</span><span class="op" id="6272311">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6272316">if</span>&nbsp;<span class="builtintype" id="6272319">rune</span>&nbsp;<span class="op" id="6272324">==</span>&nbsp;<span class="ident" id="6272327">quote</span>&nbsp;<span class="op" id="6272333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6272339">quote</span>&nbsp;<span class="op" id="6272345">=</span>&nbsp;<span class="string" id="6272347">&#39;\x00&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6272358">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6272370">}</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6272374">case</span>&nbsp;<span class="builtintype" id="6272379">rune</span>&nbsp;<span class="op" id="6272384">==</span>&nbsp;<span class="string" id="6272387">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="6272391">||</span>&nbsp;<span class="builtintype" id="6272394">rune</span>&nbsp;<span class="op" id="6272399">==</span>&nbsp;<span class="string" id="6272402">&#39;\&#39;&#39;</span><span class="op" id="6272406">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6272411">quoted</span>&nbsp;<span class="op" id="6272418">=</span>&nbsp;<span class="builtintype" id="6272420">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6272428">quote</span>&nbsp;<span class="op" id="6272434">=</span>&nbsp;<span class="builtintype" id="6272436">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6272444">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6272455">case</span>&nbsp;<span class="ident" id="6272460">unicode</span><span class="op" id="6272467">.</span><span class="ident" id="6272468">IsSpace</span><span class="op" id="6272475">(</span><span class="builtintype" id="6272476">rune</span><span class="op" id="6272480">)</span><span class="op" id="6272481">:</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6272486">if</span>&nbsp;<span class="ident" id="6272489">quoted</span>&nbsp;<span class="op" id="6272496">||</span>&nbsp;<span class="ident" id="6272499">i</span>&nbsp;<span class="op" id="6272501">&gt;</span>&nbsp;<span class="num" id="6272503">0</span>&nbsp;<span class="op" id="6272505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6272511">quoted</span>&nbsp;<span class="op" id="6272518">=</span>&nbsp;<span class="builtintype" id="6272520">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6272530">args</span>&nbsp;<span class="op" id="6272535">=</span>&nbsp;<span class="builtinfunc" id="6272537">append</span><span class="op" id="6272543">(</span><span class="ident" id="6272544">args</span><span class="op" id="6272548">,</span>&nbsp;<span class="builtintype" id="6272550">string</span><span class="op" id="6272556">(</span><span class="ident" id="6272557">arg</span><span class="op" id="6272560">[</span><span class="op" id="6272561">:</span><span class="ident" id="6272562">i</span><span class="op" id="6272563">]</span><span class="op" id="6272564">)</span><span class="op" id="6272565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6272571">i</span>&nbsp;<span class="op" id="6272573">=</span>&nbsp;<span class="num" id="6272575">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6272580">}</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6272585">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6272596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6272600">arg</span><span class="op" id="6272603">[</span><span class="ident" id="6272604">i</span><span class="op" id="6272605">]</span>&nbsp;<span class="op" id="6272607">=</span>&nbsp;<span class="builtintype" id="6272609">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6272616">i</span><span class="op" id="6272617">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6272621">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6272624">if</span>&nbsp;<span class="ident" id="6272627">quoted</span>&nbsp;<span class="op" id="6272634">||</span>&nbsp;<span class="ident" id="6272637">i</span>&nbsp;<span class="op" id="6272639">&gt;</span>&nbsp;<span class="num" id="6272641">0</span>&nbsp;<span class="op" id="6272643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6272647">args</span>&nbsp;<span class="op" id="6272652">=</span>&nbsp;<span class="builtinfunc" id="6272654">append</span><span class="op" id="6272660">(</span><span class="ident" id="6272661">args</span><span class="op" id="6272665">,</span>&nbsp;<span class="builtintype" id="6272667">string</span><span class="op" id="6272673">(</span><span class="ident" id="6272674">arg</span><span class="op" id="6272677">[</span><span class="op" id="6272678">:</span><span class="ident" id="6272679">i</span><span class="op" id="6272680">]</span><span class="op" id="6272681">)</span><span class="op" id="6272682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6272685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6272688">if</span>&nbsp;<span class="ident" id="6272691">quote</span>&nbsp;<span class="op" id="6272697">!=</span>&nbsp;<span class="num" id="6272700">0</span>&nbsp;<span class="op" id="6272702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6272706">err</span>&nbsp;<span class="op" id="6272710">=</span>&nbsp;<span class="ident" id="6272712">errors</span><span class="op" id="6272718">.</span><span class="ident" id="6272719">New</span><span class="op" id="6272722">(</span><span class="string" id="6272723">&#34;unclosed&nbsp;quote&#34;</span><span class="op" id="6272739">)</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6272742">}</span>&nbsp;<span class="keyword" id="6272744">else</span>&nbsp;<span class="keyword" id="6272749">if</span>&nbsp;<span class="ident" id="6272752">escaped</span>&nbsp;<span class="op" id="6272760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6272764">err</span>&nbsp;<span class="op" id="6272768">=</span>&nbsp;<span class="ident" id="6272770">errors</span><span class="op" id="6272776">.</span><span class="ident" id="6272777">New</span><span class="op" id="6272780">(</span><span class="string" id="6272781">&#34;unfinished&nbsp;escaping&#34;</span><span class="op" id="6272802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6272805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6272808">return</span>&nbsp;<span class="ident" id="6272815">args</span><span class="op" id="6272819">,</span>&nbsp;<span class="ident" id="6272821">err</span><br>
<span class="lineno"></span><span class="op" id="6272825">}</span><br>
<span class="lineno">1220</span><br>
<span class="lineno"></span><span class="comment" id="6272828">//&nbsp;match&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;name&nbsp;is&nbsp;one&nbsp;of:</span><br>
<span class="lineno"></span><span class="comment" id="6272873">//</span><br>
<span class="lineno"></span><span class="comment" id="6272876">//&nbsp;&nbsp;&nbsp;&nbsp$GOOS</span><br>
<span class="lineno"></span><span class="comment" id="6272885">//&nbsp;&nbsp;&nbsp;&nbsp$GOARCH</span><br>
<span class="lineno">1225</span><span class="comment" id="6272896">//&nbsp;&nbsp;&nbsp;&nbspcgo&nbsp;(if&nbsp;cgo&nbsp;is&nbsp;enabled)</span><br>
<span class="lineno"></span><span class="comment" id="6272923">//&nbsp;&nbsp;&nbsp;&nbsp!cgo&nbsp;(if&nbsp;cgo&nbsp;is&nbsp;disabled)</span><br>
<span class="lineno"></span><span class="comment" id="6272952">//&nbsp;&nbsp;&nbsp;&nbspctxt.Compiler</span><br>
<span class="lineno"></span><span class="comment" id="6272969">//&nbsp;&nbsp;&nbsp;&nbsp!ctxt.Compiler</span><br>
<span class="lineno"></span><span class="comment" id="6272987">//&nbsp;&nbsp;&nbsp;&nbsptag&nbsp;(if&nbsp;tag&nbsp;is&nbsp;listed&nbsp;in&nbsp;ctxt.BuildTags&nbsp;or&nbsp;ctxt.ReleaseTags)</span><br>
<span class="lineno">1230</span><span class="comment" id="6273051">//&nbsp;&nbsp;&nbsp;&nbsp!tag&nbsp;(if&nbsp;tag&nbsp;is&nbsp;not&nbsp;listed&nbsp;in&nbsp;ctxt.BuildTags&nbsp;or&nbsp;ctxt.ReleaseTags)</span><br>
<span class="lineno"></span><span class="comment" id="6273120">//&nbsp;&nbsp;&nbsp;&nbspa&nbsp;comma-separated&nbsp;list&nbsp;of&nbsp;any&nbsp;of&nbsp;these</span><br>
<span class="lineno"></span><span class="comment" id="6273162">//</span><br>
<span class="lineno"></span><span class="keyword" id="6273165">func</span>&nbsp;<span class="op" id="6273170">(</span><span class="ident" id="6273171">ctxt</span>&nbsp;<span class="op" id="6273176">*</span><span class="ident" id="6273177">Context</span><span class="op" id="6273184">)</span>&nbsp;<span class="ident" id="6273186">match</span><span class="op" id="6273191">(</span><span class="ident" id="6273192">name</span>&nbsp;<span class="builtintype" id="6273197">string</span><span class="op" id="6273203">,</span>&nbsp;<span class="ident" id="6273205">allTags</span>&nbsp;<span class="keyword" id="6273213">map</span><span class="op" id="6273216">[</span><span class="builtintype" id="6273217">string</span><span class="op" id="6273223">]</span><span class="builtintype" id="6273224">bool</span><span class="op" id="6273228">)</span>&nbsp;<span class="builtintype" id="6273230">bool</span>&nbsp;<span class="op" id="6273235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6273238">if</span>&nbsp;<span class="ident" id="6273241">name</span>&nbsp;<span class="op" id="6273246">==</span>&nbsp;<span class="string" id="6273249">&#34;&#34;</span>&nbsp;<span class="op" id="6273252">{</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6273256">if</span>&nbsp;<span class="ident" id="6273259">allTags</span>&nbsp;<span class="op" id="6273267">!=</span>&nbsp;<span class="ident" id="6273270">nil</span>&nbsp;<span class="op" id="6273274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6273279">allTags</span><span class="op" id="6273286">[</span><span class="ident" id="6273287">name</span><span class="op" id="6273291">]</span>&nbsp;<span class="op" id="6273293">=</span>&nbsp;<span class="builtintype" id="6273295">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6273302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6273306">return</span>&nbsp;<span class="builtintype" id="6273313">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6273320">}</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6273323">if</span>&nbsp;<span class="ident" id="6273326">i</span>&nbsp;<span class="op" id="6273328">:=</span>&nbsp;<span class="ident" id="6273331">strings</span><span class="op" id="6273338">.</span><span class="ident" id="6273339">Index</span><span class="op" id="6273344">(</span><span class="ident" id="6273345">name</span><span class="op" id="6273349">,</span>&nbsp;<span class="string" id="6273351">&#34;,&#34;</span><span class="op" id="6273354">)</span><span class="op" id="6273355">;</span>&nbsp;<span class="ident" id="6273357">i</span>&nbsp;<span class="op" id="6273359">&gt;=</span>&nbsp;<span class="num" id="6273362">0</span>&nbsp;<span class="op" id="6273364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6273368">//&nbsp;comma-separated&nbsp;list</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6273394">ok1</span>&nbsp;<span class="op" id="6273398">:=</span>&nbsp;<span class="ident" id="6273401">ctxt</span><span class="op" id="6273405">.</span><span class="ident" id="6273406">match</span><span class="op" id="6273411">(</span><span class="ident" id="6273412">name</span><span class="op" id="6273416">[</span><span class="op" id="6273417">:</span><span class="ident" id="6273418">i</span><span class="op" id="6273419">]</span><span class="op" id="6273420">,</span>&nbsp;<span class="ident" id="6273422">allTags</span><span class="op" id="6273429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6273433">ok2</span>&nbsp;<span class="op" id="6273437">:=</span>&nbsp;<span class="ident" id="6273440">ctxt</span><span class="op" id="6273444">.</span><span class="ident" id="6273445">match</span><span class="op" id="6273450">(</span><span class="ident" id="6273451">name</span><span class="op" id="6273455">[</span><span class="ident" id="6273456">i</span><span class="op" id="6273457">+</span><span class="num" id="6273458">1</span><span class="op" id="6273459">:</span><span class="op" id="6273460">]</span><span class="op" id="6273461">,</span>&nbsp;<span class="ident" id="6273463">allTags</span><span class="op" id="6273470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6273474">return</span>&nbsp;<span class="ident" id="6273481">ok1</span>&nbsp;<span class="op" id="6273485">&amp;&amp;</span>&nbsp;<span class="ident" id="6273488">ok2</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6273493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6273496">if</span>&nbsp;<span class="ident" id="6273499">strings</span><span class="op" id="6273506">.</span><span class="ident" id="6273507">HasPrefix</span><span class="op" id="6273516">(</span><span class="ident" id="6273517">name</span><span class="op" id="6273521">,</span>&nbsp;<span class="string" id="6273523">&#34;!!&#34;</span><span class="op" id="6273527">)</span>&nbsp;<span class="op" id="6273529">{</span>&nbsp;<span class="comment" id="6273531">//&nbsp;bad&nbsp;syntax,&nbsp;reject&nbsp;always</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6273562">return</span>&nbsp;<span class="builtintype" id="6273569">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6273576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6273579">if</span>&nbsp;<span class="ident" id="6273582">strings</span><span class="op" id="6273589">.</span><span class="ident" id="6273590">HasPrefix</span><span class="op" id="6273599">(</span><span class="ident" id="6273600">name</span><span class="op" id="6273604">,</span>&nbsp;<span class="string" id="6273606">&#34;!&#34;</span><span class="op" id="6273609">)</span>&nbsp;<span class="op" id="6273611">{</span>&nbsp;<span class="comment" id="6273613">//&nbsp;negation</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6273627">return</span>&nbsp;<span class="builtinfunc" id="6273634">len</span><span class="op" id="6273637">(</span><span class="ident" id="6273638">name</span><span class="op" id="6273642">)</span>&nbsp;<span class="op" id="6273644">&gt;</span>&nbsp;<span class="num" id="6273646">1</span>&nbsp;<span class="op" id="6273648">&amp;&amp;</span>&nbsp;<span class="op" id="6273651">!</span><span class="ident" id="6273652">ctxt</span><span class="op" id="6273656">.</span><span class="ident" id="6273657">match</span><span class="op" id="6273662">(</span><span class="ident" id="6273663">name</span><span class="op" id="6273667">[</span><span class="num" id="6273668">1</span><span class="op" id="6273669">:</span><span class="op" id="6273670">]</span><span class="op" id="6273671">,</span>&nbsp;<span class="ident" id="6273673">allTags</span><span class="op" id="6273680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6273683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6273687">if</span>&nbsp;<span class="ident" id="6273690">allTags</span>&nbsp;<span class="op" id="6273698">!=</span>&nbsp;<span class="ident" id="6273701">nil</span>&nbsp;<span class="op" id="6273705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6273709">allTags</span><span class="op" id="6273716">[</span><span class="ident" id="6273717">name</span><span class="op" id="6273721">]</span>&nbsp;<span class="op" id="6273723">=</span>&nbsp;<span class="builtintype" id="6273725">true</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6273731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6273735">//&nbsp;Tags&nbsp;must&nbsp;be&nbsp;letters,&nbsp;digits,&nbsp;underscores&nbsp;or&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6273790">//&nbsp;Unlike&nbsp;in&nbsp;Go&nbsp;identifiers,&nbsp;all&nbsp;digits&nbsp;are&nbsp;fine&nbsp;(e.g.,&nbsp;&#34;386&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6273855">for</span>&nbsp;<span class="ident" id="6273859">_</span><span class="op" id="6273860">,</span>&nbsp;<span class="ident" id="6273862">c</span>&nbsp;<span class="op" id="6273864">:=</span>&nbsp;<span class="keyword" id="6273867">range</span>&nbsp;<span class="ident" id="6273873">name</span>&nbsp;<span class="op" id="6273878">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6273882">if</span>&nbsp;<span class="op" id="6273885">!</span><span class="ident" id="6273886">unicode</span><span class="op" id="6273893">.</span><span class="ident" id="6273894">IsLetter</span><span class="op" id="6273902">(</span><span class="ident" id="6273903">c</span><span class="op" id="6273904">)</span>&nbsp;<span class="op" id="6273906">&amp;&amp;</span>&nbsp;<span class="op" id="6273909">!</span><span class="ident" id="6273910">unicode</span><span class="op" id="6273917">.</span><span class="ident" id="6273918">IsDigit</span><span class="op" id="6273925">(</span><span class="ident" id="6273926">c</span><span class="op" id="6273927">)</span>&nbsp;<span class="op" id="6273929">&amp;&amp;</span>&nbsp;<span class="ident" id="6273932">c</span>&nbsp;<span class="op" id="6273934">!=</span>&nbsp;<span class="string" id="6273937">&#39;_&#39;</span>&nbsp;<span class="op" id="6273941">&amp;&amp;</span>&nbsp;<span class="ident" id="6273944">c</span>&nbsp;<span class="op" id="6273946">!=</span>&nbsp;<span class="string" id="6273949">&#39;.&#39;</span>&nbsp;<span class="op" id="6273953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6273958">return</span>&nbsp;<span class="builtintype" id="6273965">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6273973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6273976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6273980">//&nbsp;special&nbsp;tags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6273997">if</span>&nbsp;<span class="ident" id="6274000">ctxt</span><span class="op" id="6274004">.</span><span class="ident" id="6274005">CgoEnabled</span>&nbsp;<span class="op" id="6274016">&amp;&amp;</span>&nbsp;<span class="ident" id="6274019">name</span>&nbsp;<span class="op" id="6274024">==</span>&nbsp;<span class="string" id="6274027">&#34;cgo&#34;</span>&nbsp;<span class="op" id="6274033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6274037">return</span>&nbsp;<span class="builtintype" id="6274044">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6274050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6274053">if</span>&nbsp;<span class="ident" id="6274056">name</span>&nbsp;<span class="op" id="6274061">==</span>&nbsp;<span class="ident" id="6274064">ctxt</span><span class="op" id="6274068">.</span><span class="ident" id="6274069">GOOS</span>&nbsp;<span class="op" id="6274074">||</span>&nbsp;<span class="ident" id="6274077">name</span>&nbsp;<span class="op" id="6274082">==</span>&nbsp;<span class="ident" id="6274085">ctxt</span><span class="op" id="6274089">.</span><span class="ident" id="6274090">GOARCH</span>&nbsp;<span class="op" id="6274097">||</span>&nbsp;<span class="ident" id="6274100">name</span>&nbsp;<span class="op" id="6274105">==</span>&nbsp;<span class="ident" id="6274108">ctxt</span><span class="op" id="6274112">.</span><span class="ident" id="6274113">Compiler</span>&nbsp;<span class="op" id="6274122">{</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6274126">return</span>&nbsp;<span class="builtintype" id="6274133">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6274139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6274142">if</span>&nbsp;<span class="ident" id="6274145">ctxt</span><span class="op" id="6274149">.</span><span class="ident" id="6274150">GOOS</span>&nbsp;<span class="op" id="6274155">==</span>&nbsp;<span class="string" id="6274158">&#34;android&#34;</span>&nbsp;<span class="op" id="6274168">&amp;&amp;</span>&nbsp;<span class="ident" id="6274171">name</span>&nbsp;<span class="op" id="6274176">==</span>&nbsp;<span class="string" id="6274179">&#34;linux&#34;</span>&nbsp;<span class="op" id="6274187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6274191">return</span>&nbsp;<span class="builtintype" id="6274198">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6274204">}</span><br>
<span class="lineno">1275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6274208">//&nbsp;other&nbsp;tags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6274223">for</span>&nbsp;<span class="ident" id="6274227">_</span><span class="op" id="6274228">,</span>&nbsp;<span class="ident" id="6274230">tag</span>&nbsp;<span class="op" id="6274234">:=</span>&nbsp;<span class="keyword" id="6274237">range</span>&nbsp;<span class="ident" id="6274243">ctxt</span><span class="op" id="6274247">.</span><span class="ident" id="6274248">BuildTags</span>&nbsp;<span class="op" id="6274258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6274262">if</span>&nbsp;<span class="ident" id="6274265">tag</span>&nbsp;<span class="op" id="6274269">==</span>&nbsp;<span class="ident" id="6274272">name</span>&nbsp;<span class="op" id="6274277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6274282">return</span>&nbsp;<span class="builtintype" id="6274289">true</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6274296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6274299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6274302">for</span>&nbsp;<span class="ident" id="6274306">_</span><span class="op" id="6274307">,</span>&nbsp;<span class="ident" id="6274309">tag</span>&nbsp;<span class="op" id="6274313">:=</span>&nbsp;<span class="keyword" id="6274316">range</span>&nbsp;<span class="ident" id="6274322">ctxt</span><span class="op" id="6274326">.</span><span class="ident" id="6274327">ReleaseTags</span>&nbsp;<span class="op" id="6274339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6274343">if</span>&nbsp;<span class="ident" id="6274346">tag</span>&nbsp;<span class="op" id="6274350">==</span>&nbsp;<span class="ident" id="6274353">name</span>&nbsp;<span class="op" id="6274358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6274363">return</span>&nbsp;<span class="builtintype" id="6274370">true</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6274377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6274380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6274384">return</span>&nbsp;<span class="builtintype" id="6274391">false</span><br>
<span class="lineno"></span><span class="op" id="6274397">}</span><br>
<span class="lineno">1290</span><br>
<span class="lineno"></span><span class="comment" id="6274400">//&nbsp;goodOSArchFile&nbsp;returns&nbsp;false&nbsp;if&nbsp;the&nbsp;name&nbsp;contains&nbsp;a&nbsp;$GOOS&nbsp;or&nbsp;$GOARCH</span><br>
<span class="lineno"></span><span class="comment" id="6274472">//&nbsp;suffix&nbsp;which&nbsp;does&nbsp;not&nbsp;match&nbsp;the&nbsp;current&nbsp;system.</span><br>
<span class="lineno"></span><span class="comment" id="6274523">//&nbsp;The&nbsp;recognized&nbsp;name&nbsp;formats&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="6274559">//</span><br>
<span class="lineno">1295</span><span class="comment" id="6274562">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS).*</span><br>
<span class="lineno"></span><span class="comment" id="6274584">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOARCH).*</span><br>
<span class="lineno"></span><span class="comment" id="6274608">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_$(GOARCH).*</span><br>
<span class="lineno"></span><span class="comment" id="6274640">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_test.*</span><br>
<span class="lineno"></span><span class="comment" id="6274667">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOARCH)_test.*</span><br>
<span class="lineno">1300</span><span class="comment" id="6274696">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_$(GOARCH)_test.*</span><br>
<span class="lineno"></span><span class="comment" id="6274733">//</span><br>
<span class="lineno"></span><span class="comment" id="6274736">//&nbsp;An&nbsp;exception:&nbsp;if&nbsp;GOOS=android,&nbsp;then&nbsp;files&nbsp;with&nbsp;GOOS=linux&nbsp;are&nbsp;also&nbsp;matched.</span><br>
<span class="lineno"></span><span class="keyword" id="6274815">func</span>&nbsp;<span class="op" id="6274820">(</span><span class="ident" id="6274821">ctxt</span>&nbsp;<span class="op" id="6274826">*</span><span class="ident" id="6274827">Context</span><span class="op" id="6274834">)</span>&nbsp;<span class="ident" id="6274836">goodOSArchFile</span><span class="op" id="6274850">(</span><span class="ident" id="6274851">name</span>&nbsp;<span class="builtintype" id="6274856">string</span><span class="op" id="6274862">,</span>&nbsp;<span class="ident" id="6274864">allTags</span>&nbsp;<span class="keyword" id="6274872">map</span><span class="op" id="6274875">[</span><span class="builtintype" id="6274876">string</span><span class="op" id="6274882">]</span><span class="builtintype" id="6274883">bool</span><span class="op" id="6274887">)</span>&nbsp;<span class="builtintype" id="6274889">bool</span>&nbsp;<span class="op" id="6274894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6274897">if</span>&nbsp;<span class="ident" id="6274900">dot</span>&nbsp;<span class="op" id="6274904">:=</span>&nbsp;<span class="ident" id="6274907">strings</span><span class="op" id="6274914">.</span><span class="ident" id="6274915">Index</span><span class="op" id="6274920">(</span><span class="ident" id="6274921">name</span><span class="op" id="6274925">,</span>&nbsp;<span class="string" id="6274927">&#34;.&#34;</span><span class="op" id="6274930">)</span><span class="op" id="6274931">;</span>&nbsp;<span class="ident" id="6274933">dot</span>&nbsp;<span class="op" id="6274937">!=</span>&nbsp;<span class="op" id="6274940">-</span><span class="num" id="6274941">1</span>&nbsp;<span class="op" id="6274943">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6274947">name</span>&nbsp;<span class="op" id="6274952">=</span>&nbsp;<span class="ident" id="6274954">name</span><span class="op" id="6274958">[</span><span class="op" id="6274959">:</span><span class="ident" id="6274960">dot</span><span class="op" id="6274963">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6274966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6274970">//&nbsp;Before&nbsp;Go&nbsp;1.4,&nbsp;a&nbsp;file&nbsp;called&nbsp;&#34;linux.go&#34;&nbsp;would&nbsp;be&nbsp;equivalent&nbsp;to&nbsp;having&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6275046">//&nbsp;build&nbsp;tag&nbsp;&#34;linux&#34;&nbsp;in&nbsp;that&nbsp;file.&nbsp;For&nbsp;Go&nbsp;1.4&nbsp;and&nbsp;beyond,&nbsp;we&nbsp;require&nbsp;this</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6275121">//&nbsp;auto-tagging&nbsp;to&nbsp;apply&nbsp;only&nbsp;to&nbsp;files&nbsp;with&nbsp;a&nbsp;non-empty&nbsp;prefix,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6275189">//&nbsp;&#34;foo_linux.go&#34;&nbsp;is&nbsp;tagged&nbsp;but&nbsp;&#34;linux.go&#34;&nbsp;is&nbsp;not.&nbsp;This&nbsp;allows&nbsp;new&nbsp;operating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6275267">//&nbsp;sytems,&nbsp;such&nbsp;as&nbsp;android,&nbsp;to&nbsp;arrive&nbsp;without&nbsp;breaking&nbsp;existing&nbsp;code&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6275342">//&nbsp;innocuous&nbsp;source&nbsp;code&nbsp;in&nbsp;&#34;android.go&#34;.&nbsp;The&nbsp;easiest&nbsp;fix:&nbsp;cut&nbsp;everything</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6275417">//&nbsp;in&nbsp;the&nbsp;name&nbsp;before&nbsp;the&nbsp;initial&nbsp;_.</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6275455">i</span>&nbsp;<span class="op" id="6275457">:=</span>&nbsp;<span class="ident" id="6275460">strings</span><span class="op" id="6275467">.</span><span class="ident" id="6275468">Index</span><span class="op" id="6275473">(</span><span class="ident" id="6275474">name</span><span class="op" id="6275478">,</span>&nbsp;<span class="string" id="6275480">&#34;_&#34;</span><span class="op" id="6275483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6275486">if</span>&nbsp;<span class="ident" id="6275489">i</span>&nbsp;<span class="op" id="6275491">&lt;</span>&nbsp;<span class="num" id="6275493">0</span>&nbsp;<span class="op" id="6275495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6275499">return</span>&nbsp;<span class="builtintype" id="6275506">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6275512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6275515">name</span>&nbsp;<span class="op" id="6275520">=</span>&nbsp;<span class="ident" id="6275522">name</span><span class="op" id="6275526">[</span><span class="ident" id="6275527">i</span><span class="op" id="6275528">:</span><span class="op" id="6275529">]</span>&nbsp;<span class="comment" id="6275531">//&nbsp;ignore&nbsp;everything&nbsp;before&nbsp;first&nbsp;_</span><br>
<span class="lineno">1320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6275569">l</span>&nbsp;<span class="op" id="6275571">:=</span>&nbsp;<span class="ident" id="6275574">strings</span><span class="op" id="6275581">.</span><span class="ident" id="6275582">Split</span><span class="op" id="6275587">(</span><span class="ident" id="6275588">name</span><span class="op" id="6275592">,</span>&nbsp;<span class="string" id="6275594">&#34;_&#34;</span><span class="op" id="6275597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6275600">if</span>&nbsp;<span class="ident" id="6275603">n</span>&nbsp;<span class="op" id="6275605">:=</span>&nbsp;<span class="builtinfunc" id="6275608">len</span><span class="op" id="6275611">(</span><span class="ident" id="6275612">l</span><span class="op" id="6275613">)</span><span class="op" id="6275614">;</span>&nbsp;<span class="ident" id="6275616">n</span>&nbsp;<span class="op" id="6275618">&gt;</span>&nbsp;<span class="num" id="6275620">0</span>&nbsp;<span class="op" id="6275622">&amp;&amp;</span>&nbsp;<span class="ident" id="6275625">l</span><span class="op" id="6275626">[</span><span class="ident" id="6275627">n</span><span class="op" id="6275628">-</span><span class="num" id="6275629">1</span><span class="op" id="6275630">]</span>&nbsp;<span class="op" id="6275632">==</span>&nbsp;<span class="string" id="6275635">&#34;test&#34;</span>&nbsp;<span class="op" id="6275642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6275646">l</span>&nbsp;<span class="op" id="6275648">=</span>&nbsp;<span class="ident" id="6275650">l</span><span class="op" id="6275651">[</span><span class="op" id="6275652">:</span><span class="ident" id="6275653">n</span><span class="op" id="6275654">-</span><span class="num" id="6275655">1</span><span class="op" id="6275656">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6275659">}</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6275662">n</span>&nbsp;<span class="op" id="6275664">:=</span>&nbsp;<span class="builtinfunc" id="6275667">len</span><span class="op" id="6275670">(</span><span class="ident" id="6275671">l</span><span class="op" id="6275672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6275675">if</span>&nbsp;<span class="ident" id="6275678">n</span>&nbsp;<span class="op" id="6275680">&gt;=</span>&nbsp;<span class="num" id="6275683">2</span>&nbsp;<span class="op" id="6275685">&amp;&amp;</span>&nbsp;<span class="ident" id="6275688">knownOS</span><span class="op" id="6275695">[</span><span class="ident" id="6275696">l</span><span class="op" id="6275697">[</span><span class="ident" id="6275698">n</span><span class="op" id="6275699">-</span><span class="num" id="6275700">2</span><span class="op" id="6275701">]</span><span class="op" id="6275702">]</span>&nbsp;<span class="op" id="6275704">&amp;&amp;</span>&nbsp;<span class="ident" id="6275707">knownArch</span><span class="op" id="6275716">[</span><span class="ident" id="6275717">l</span><span class="op" id="6275718">[</span><span class="ident" id="6275719">n</span><span class="op" id="6275720">-</span><span class="num" id="6275721">1</span><span class="op" id="6275722">]</span><span class="op" id="6275723">]</span>&nbsp;<span class="op" id="6275725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6275729">if</span>&nbsp;<span class="ident" id="6275732">allTags</span>&nbsp;<span class="op" id="6275740">!=</span>&nbsp;<span class="ident" id="6275743">nil</span>&nbsp;<span class="op" id="6275747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6275752">allTags</span><span class="op" id="6275759">[</span><span class="ident" id="6275760">l</span><span class="op" id="6275761">[</span><span class="ident" id="6275762">n</span><span class="op" id="6275763">-</span><span class="num" id="6275764">2</span><span class="op" id="6275765">]</span><span class="op" id="6275766">]</span>&nbsp;<span class="op" id="6275768">=</span>&nbsp;<span class="builtintype" id="6275770">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6275778">allTags</span><span class="op" id="6275785">[</span><span class="ident" id="6275786">l</span><span class="op" id="6275787">[</span><span class="ident" id="6275788">n</span><span class="op" id="6275789">-</span><span class="num" id="6275790">1</span><span class="op" id="6275791">]</span><span class="op" id="6275792">]</span>&nbsp;<span class="op" id="6275794">=</span>&nbsp;<span class="builtintype" id="6275796">true</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6275803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6275807">if</span>&nbsp;<span class="ident" id="6275810">l</span><span class="op" id="6275811">[</span><span class="ident" id="6275812">n</span><span class="op" id="6275813">-</span><span class="num" id="6275814">1</span><span class="op" id="6275815">]</span>&nbsp;<span class="op" id="6275817">!=</span>&nbsp;<span class="ident" id="6275820">ctxt</span><span class="op" id="6275824">.</span><span class="ident" id="6275825">GOARCH</span>&nbsp;<span class="op" id="6275832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6275837">return</span>&nbsp;<span class="builtintype" id="6275844">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6275852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6275856">if</span>&nbsp;<span class="ident" id="6275859">ctxt</span><span class="op" id="6275863">.</span><span class="ident" id="6275864">GOOS</span>&nbsp;<span class="op" id="6275869">==</span>&nbsp;<span class="string" id="6275872">&#34;android&#34;</span>&nbsp;<span class="op" id="6275882">&amp;&amp;</span>&nbsp;<span class="ident" id="6275885">l</span><span class="op" id="6275886">[</span><span class="ident" id="6275887">n</span><span class="op" id="6275888">-</span><span class="num" id="6275889">2</span><span class="op" id="6275890">]</span>&nbsp;<span class="op" id="6275892">==</span>&nbsp;<span class="string" id="6275895">&#34;linux&#34;</span>&nbsp;<span class="op" id="6275903">{</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6275908">return</span>&nbsp;<span class="builtintype" id="6275915">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6275922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6275926">return</span>&nbsp;<span class="ident" id="6275933">l</span><span class="op" id="6275934">[</span><span class="ident" id="6275935">n</span><span class="op" id="6275936">-</span><span class="num" id="6275937">2</span><span class="op" id="6275938">]</span>&nbsp;<span class="op" id="6275940">==</span>&nbsp;<span class="ident" id="6275943">ctxt</span><span class="op" id="6275947">.</span><span class="ident" id="6275948">GOOS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6275954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6275957">if</span>&nbsp;<span class="ident" id="6275960">n</span>&nbsp;<span class="op" id="6275962">&gt;=</span>&nbsp;<span class="num" id="6275965">1</span>&nbsp;<span class="op" id="6275967">&amp;&amp;</span>&nbsp;<span class="ident" id="6275970">knownOS</span><span class="op" id="6275977">[</span><span class="ident" id="6275978">l</span><span class="op" id="6275979">[</span><span class="ident" id="6275980">n</span><span class="op" id="6275981">-</span><span class="num" id="6275982">1</span><span class="op" id="6275983">]</span><span class="op" id="6275984">]</span>&nbsp;<span class="op" id="6275986">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6275990">if</span>&nbsp;<span class="ident" id="6275993">allTags</span>&nbsp;<span class="op" id="6276001">!=</span>&nbsp;<span class="ident" id="6276004">nil</span>&nbsp;<span class="op" id="6276008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6276013">allTags</span><span class="op" id="6276020">[</span><span class="ident" id="6276021">l</span><span class="op" id="6276022">[</span><span class="ident" id="6276023">n</span><span class="op" id="6276024">-</span><span class="num" id="6276025">1</span><span class="op" id="6276026">]</span><span class="op" id="6276027">]</span>&nbsp;<span class="op" id="6276029">=</span>&nbsp;<span class="builtintype" id="6276031">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6276038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6276042">if</span>&nbsp;<span class="ident" id="6276045">ctxt</span><span class="op" id="6276049">.</span><span class="ident" id="6276050">GOOS</span>&nbsp;<span class="op" id="6276055">==</span>&nbsp;<span class="string" id="6276058">&#34;android&#34;</span>&nbsp;<span class="op" id="6276068">&amp;&amp;</span>&nbsp;<span class="ident" id="6276071">l</span><span class="op" id="6276072">[</span><span class="ident" id="6276073">n</span><span class="op" id="6276074">-</span><span class="num" id="6276075">1</span><span class="op" id="6276076">]</span>&nbsp;<span class="op" id="6276078">==</span>&nbsp;<span class="string" id="6276081">&#34;linux&#34;</span>&nbsp;<span class="op" id="6276089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6276094">return</span>&nbsp;<span class="builtintype" id="6276101">true</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6276108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6276112">return</span>&nbsp;<span class="ident" id="6276119">l</span><span class="op" id="6276120">[</span><span class="ident" id="6276121">n</span><span class="op" id="6276122">-</span><span class="num" id="6276123">1</span><span class="op" id="6276124">]</span>&nbsp;<span class="op" id="6276126">==</span>&nbsp;<span class="ident" id="6276129">ctxt</span><span class="op" id="6276133">.</span><span class="ident" id="6276134">GOOS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6276140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6276143">if</span>&nbsp;<span class="ident" id="6276146">n</span>&nbsp;<span class="op" id="6276148">&gt;=</span>&nbsp;<span class="num" id="6276151">1</span>&nbsp;<span class="op" id="6276153">&amp;&amp;</span>&nbsp;<span class="ident" id="6276156">knownArch</span><span class="op" id="6276165">[</span><span class="ident" id="6276166">l</span><span class="op" id="6276167">[</span><span class="ident" id="6276168">n</span><span class="op" id="6276169">-</span><span class="num" id="6276170">1</span><span class="op" id="6276171">]</span><span class="op" id="6276172">]</span>&nbsp;<span class="op" id="6276174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6276178">if</span>&nbsp;<span class="ident" id="6276181">allTags</span>&nbsp;<span class="op" id="6276189">!=</span>&nbsp;<span class="ident" id="6276192">nil</span>&nbsp;<span class="op" id="6276196">{</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6276201">allTags</span><span class="op" id="6276208">[</span><span class="ident" id="6276209">l</span><span class="op" id="6276210">[</span><span class="ident" id="6276211">n</span><span class="op" id="6276212">-</span><span class="num" id="6276213">1</span><span class="op" id="6276214">]</span><span class="op" id="6276215">]</span>&nbsp;<span class="op" id="6276217">=</span>&nbsp;<span class="builtintype" id="6276219">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6276226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6276230">return</span>&nbsp;<span class="ident" id="6276237">l</span><span class="op" id="6276238">[</span><span class="ident" id="6276239">n</span><span class="op" id="6276240">-</span><span class="num" id="6276241">1</span><span class="op" id="6276242">]</span>&nbsp;<span class="op" id="6276244">==</span>&nbsp;<span class="ident" id="6276247">ctxt</span><span class="op" id="6276251">.</span><span class="ident" id="6276252">GOARCH</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6276260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6276263">return</span>&nbsp;<span class="builtintype" id="6276270">true</span><br>
<span class="lineno">1355</span><span class="op" id="6276275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6276278">var</span>&nbsp;<span class="ident" id="6276282">knownOS</span>&nbsp;<span class="op" id="6276290">=</span>&nbsp;<span class="builtinfunc" id="6276292">make</span><span class="op" id="6276296">(</span><span class="keyword" id="6276297">map</span><span class="op" id="6276300">[</span><span class="builtintype" id="6276301">string</span><span class="op" id="6276307">]</span><span class="builtintype" id="6276308">bool</span><span class="op" id="6276312">)</span><br>
<span class="lineno"></span><span class="keyword" id="6276314">var</span>&nbsp;<span class="ident" id="6276318">knownArch</span>&nbsp;<span class="op" id="6276328">=</span>&nbsp;<span class="builtinfunc" id="6276330">make</span><span class="op" id="6276334">(</span><span class="keyword" id="6276335">map</span><span class="op" id="6276338">[</span><span class="builtintype" id="6276339">string</span><span class="op" id="6276345">]</span><span class="builtintype" id="6276346">bool</span><span class="op" id="6276350">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span><span class="keyword" id="6276353">func</span>&nbsp;<span class="ident" id="6276358">init</span><span class="op" id="6276362">(</span><span class="op" id="6276363">)</span>&nbsp;<span class="op" id="6276365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6276368">for</span>&nbsp;<span class="ident" id="6276372">_</span><span class="op" id="6276373">,</span>&nbsp;<span class="ident" id="6276375">v</span>&nbsp;<span class="op" id="6276377">:=</span>&nbsp;<span class="keyword" id="6276380">range</span>&nbsp;<span class="ident" id="6276386">strings</span><span class="op" id="6276393">.</span><span class="ident" id="6276394">Fields</span><span class="op" id="6276400">(</span><span class="ident" id="6276401">goosList</span><span class="op" id="6276409">)</span>&nbsp;<span class="op" id="6276411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6276415">knownOS</span><span class="op" id="6276422">[</span><span class="ident" id="6276423">v</span><span class="op" id="6276424">]</span>&nbsp;<span class="op" id="6276426">=</span>&nbsp;<span class="builtintype" id="6276428">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6276434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6276437">for</span>&nbsp;<span class="ident" id="6276441">_</span><span class="op" id="6276442">,</span>&nbsp;<span class="ident" id="6276444">v</span>&nbsp;<span class="op" id="6276446">:=</span>&nbsp;<span class="keyword" id="6276449">range</span>&nbsp;<span class="ident" id="6276455">strings</span><span class="op" id="6276462">.</span><span class="ident" id="6276463">Fields</span><span class="op" id="6276469">(</span><span class="ident" id="6276470">goarchList</span><span class="op" id="6276480">)</span>&nbsp;<span class="op" id="6276482">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6276486">knownArch</span><span class="op" id="6276495">[</span><span class="ident" id="6276496">v</span><span class="op" id="6276497">]</span>&nbsp;<span class="op" id="6276499">=</span>&nbsp;<span class="builtintype" id="6276501">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6276507">}</span><br>
<span class="lineno"></span><span class="op" id="6276509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6276512">//&nbsp;ToolDir&nbsp;is&nbsp;the&nbsp;directory&nbsp;containing&nbsp;build&nbsp;tools.</span><br>
<span class="lineno">1370</span><span class="keyword" id="6276564">var</span>&nbsp;<span class="ident" id="6276568">ToolDir</span>&nbsp;<span class="op" id="6276576">=</span>&nbsp;<span class="ident" id="6276578">filepath</span><span class="op" id="6276586">.</span><span class="ident" id="6276587">Join</span><span class="op" id="6276591">(</span><span class="ident" id="6276592">runtime</span><span class="op" id="6276599">.</span><span class="ident" id="6276600">GOROOT</span><span class="op" id="6276606">(</span><span class="op" id="6276607">)</span><span class="op" id="6276608">,</span>&nbsp;<span class="string" id="6276610">&#34;pkg/tool/&#34;</span><span class="op" id="6276621">+</span><span class="ident" id="6276622">runtime</span><span class="op" id="6276629">.</span><span class="ident" id="6276630">GOOS</span><span class="op" id="6276634">+</span><span class="string" id="6276635">&#34;_&#34;</span><span class="op" id="6276638">+</span><span class="ident" id="6276639">runtime</span><span class="op" id="6276646">.</span><span class="ident" id="6276647">GOARCH</span><span class="op" id="6276653">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6276656">//&nbsp;IsLocalImport&nbsp;reports&nbsp;whether&nbsp;the&nbsp;import&nbsp;path&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="6276708">//&nbsp;a&nbsp;local&nbsp;import&nbsp;path,&nbsp;like&nbsp;&#34;.&#34;,&nbsp;&#34;..&#34;,&nbsp;&#34;./foo&#34;,&nbsp;or&nbsp;&#34;../foo&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="6276770">func</span>&nbsp;<span class="ident" id="6276775">IsLocalImport</span><span class="op" id="6276788">(</span><span class="ident" id="6276789">path</span>&nbsp;<span class="builtintype" id="6276794">string</span><span class="op" id="6276800">)</span>&nbsp;<span class="builtintype" id="6276802">bool</span>&nbsp;<span class="op" id="6276807">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6276810">return</span>&nbsp;<span class="ident" id="6276817">path</span>&nbsp;<span class="op" id="6276822">==</span>&nbsp;<span class="string" id="6276825">&#34;.&#34;</span>&nbsp;<span class="op" id="6276829">||</span>&nbsp;<span class="ident" id="6276832">path</span>&nbsp;<span class="op" id="6276837">==</span>&nbsp;<span class="string" id="6276840">&#34;..&#34;</span>&nbsp;<span class="op" id="6276845">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6276850">strings</span><span class="op" id="6276857">.</span><span class="ident" id="6276858">HasPrefix</span><span class="op" id="6276867">(</span><span class="ident" id="6276868">path</span><span class="op" id="6276872">,</span>&nbsp;<span class="string" id="6276874">&#34;./&#34;</span><span class="op" id="6276878">)</span>&nbsp;<span class="op" id="6276880">||</span>&nbsp;<span class="ident" id="6276883">strings</span><span class="op" id="6276890">.</span><span class="ident" id="6276891">HasPrefix</span><span class="op" id="6276900">(</span><span class="ident" id="6276901">path</span><span class="op" id="6276905">,</span>&nbsp;<span class="string" id="6276907">&#34;../&#34;</span><span class="op" id="6276912">)</span><br>
<span class="lineno"></span><span class="op" id="6276914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6276917">//&nbsp;ArchChar&nbsp;returns&nbsp;the&nbsp;architecture&nbsp;character&nbsp;for&nbsp;the&nbsp;given&nbsp;goarch.</span><br>
<span class="lineno">1380</span><span class="comment" id="6276986">//&nbsp;For&nbsp;example,&nbsp;ArchChar(&#34;amd64&#34;)&nbsp;returns&nbsp;&#34;6&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="6277033">func</span>&nbsp;<span class="ident" id="6277038">ArchChar</span><span class="op" id="6277046">(</span><span class="ident" id="6277047">goarch</span>&nbsp;<span class="builtintype" id="6277054">string</span><span class="op" id="6277060">)</span>&nbsp;<span class="op" id="6277062">(</span><span class="builtintype" id="6277063">string</span><span class="op" id="6277069">,</span>&nbsp;<span class="builtintype" id="6277071">error</span><span class="op" id="6277076">)</span>&nbsp;<span class="op" id="6277078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6277081">switch</span>&nbsp;<span class="ident" id="6277088">goarch</span>&nbsp;<span class="op" id="6277095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6277098">case</span>&nbsp;<span class="string" id="6277103">&#34;386&#34;</span><span class="op" id="6277108">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6277112">return</span>&nbsp;<span class="string" id="6277119">&#34;8&#34;</span><span class="op" id="6277122">,</span>&nbsp;<span class="ident" id="6277124">nil</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6277129">case</span>&nbsp;<span class="string" id="6277134">&#34;amd64&#34;</span><span class="op" id="6277141">,</span>&nbsp;<span class="string" id="6277143">&#34;amd64p32&#34;</span><span class="op" id="6277153">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6277157">return</span>&nbsp;<span class="string" id="6277164">&#34;6&#34;</span><span class="op" id="6277167">,</span>&nbsp;<span class="ident" id="6277169">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6277174">case</span>&nbsp;<span class="string" id="6277179">&#34;arm&#34;</span><span class="op" id="6277184">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6277188">return</span>&nbsp;<span class="string" id="6277195">&#34;5&#34;</span><span class="op" id="6277198">,</span>&nbsp;<span class="ident" id="6277200">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6277205">}</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6277208">return</span>&nbsp;<span class="string" id="6277215">&#34;&#34;</span><span class="op" id="6277217">,</span>&nbsp;<span class="ident" id="6277219">errors</span><span class="op" id="6277225">.</span><span class="ident" id="6277226">New</span><span class="op" id="6277229">(</span><span class="string" id="6277230">&#34;unsupported&nbsp;GOARCH&nbsp;&#34;</span>&nbsp;<span class="op" id="6277252">+</span>&nbsp;<span class="ident" id="6277254">goarch</span><span class="op" id="6277260">)</span><br>
<span class="lineno"></span><span class="op" id="6277262">}</span>
</div>
</body>
</html>
