<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/jpeg</h2>
<ul>
<li><a href="/gostd/image/jpeg/dct_test.go.html">dct_test.go</a></li>
<li><a href="/gostd/image/jpeg/fdct.go.html">fdct.go</a></li>
<li><a href="/gostd/image/jpeg/huffman.go.html">huffman.go</a></li>
<li><a href="/gostd/image/jpeg/idct.go.html">idct.go</a></li>
<li><a href="/gostd/image/jpeg/reader.go.html">reader.go</a></li>
<li><a href="/gostd/image/jpeg/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/image/jpeg/scan.go.html">scan.go</a></li>
<li><a href="/gostd/image/jpeg/writer.go.html">writer.go</a></li>
<li><a href="/gostd/image/jpeg/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7900486">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7900541">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7900595">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7900646">package</span>&nbsp;<span class="ident" id="7900654">jpeg</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7900660">import</span>&nbsp;<span class="op" id="7900667">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7900670">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7900679">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7900686">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7900695">&#34;image/color&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7900710">&#34;image/png&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7900723">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7900736">&#34;math/rand&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7900749">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7900755">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7900765">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7900768">//&nbsp;zigzag&nbsp;maps&nbsp;from&nbsp;the&nbsp;natural&nbsp;ordering&nbsp;to&nbsp;the&nbsp;zig-zag&nbsp;ordering.&nbsp;For&nbsp;example,</span><br>
<span class="lineno">20</span><span class="comment" id="7900847">//&nbsp;zigzag[0*8&nbsp;+&nbsp;3]&nbsp;is&nbsp;the&nbsp;zig-zag&nbsp;sequence&nbsp;number&nbsp;of&nbsp;the&nbsp;element&nbsp;in&nbsp;the&nbsp;fourth</span><br>
<span class="lineno"></span><span class="comment" id="7900926">//&nbsp;column&nbsp;and&nbsp;first&nbsp;row.</span><br>
<span class="lineno"></span><span class="keyword" id="7900951">var</span>&nbsp;<span class="ident" id="7900955">zigzag</span>&nbsp;<span class="op" id="7900962">=</span>&nbsp;<span class="op" id="7900964">[</span><span class="ident" id="7900965">blockSize</span><span class="op" id="7900974">]</span><span class="builtintype" id="7900975">int</span><span class="op" id="7900978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7900981">0</span><span class="op" id="7900982">,</span>&nbsp;<span class="num" id="7900984">1</span><span class="op" id="7900985">,</span>&nbsp;<span class="num" id="7900987">5</span><span class="op" id="7900988">,</span>&nbsp;<span class="num" id="7900990">6</span><span class="op" id="7900991">,</span>&nbsp;<span class="num" id="7900993">14</span><span class="op" id="7900995">,</span>&nbsp;<span class="num" id="7900997">15</span><span class="op" id="7900999">,</span>&nbsp;<span class="num" id="7901001">27</span><span class="op" id="7901003">,</span>&nbsp;<span class="num" id="7901005">28</span><span class="op" id="7901007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7901010">2</span><span class="op" id="7901011">,</span>&nbsp;<span class="num" id="7901013">4</span><span class="op" id="7901014">,</span>&nbsp;<span class="num" id="7901016">7</span><span class="op" id="7901017">,</span>&nbsp;<span class="num" id="7901019">13</span><span class="op" id="7901021">,</span>&nbsp;<span class="num" id="7901023">16</span><span class="op" id="7901025">,</span>&nbsp;<span class="num" id="7901027">26</span><span class="op" id="7901029">,</span>&nbsp;<span class="num" id="7901031">29</span><span class="op" id="7901033">,</span>&nbsp;<span class="num" id="7901035">42</span><span class="op" id="7901037">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7901040">3</span><span class="op" id="7901041">,</span>&nbsp;<span class="num" id="7901043">8</span><span class="op" id="7901044">,</span>&nbsp;<span class="num" id="7901046">12</span><span class="op" id="7901048">,</span>&nbsp;<span class="num" id="7901050">17</span><span class="op" id="7901052">,</span>&nbsp;<span class="num" id="7901054">25</span><span class="op" id="7901056">,</span>&nbsp;<span class="num" id="7901058">30</span><span class="op" id="7901060">,</span>&nbsp;<span class="num" id="7901062">41</span><span class="op" id="7901064">,</span>&nbsp;<span class="num" id="7901066">43</span><span class="op" id="7901068">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7901071">9</span><span class="op" id="7901072">,</span>&nbsp;<span class="num" id="7901074">11</span><span class="op" id="7901076">,</span>&nbsp;<span class="num" id="7901078">18</span><span class="op" id="7901080">,</span>&nbsp;<span class="num" id="7901082">24</span><span class="op" id="7901084">,</span>&nbsp;<span class="num" id="7901086">31</span><span class="op" id="7901088">,</span>&nbsp;<span class="num" id="7901090">40</span><span class="op" id="7901092">,</span>&nbsp;<span class="num" id="7901094">44</span><span class="op" id="7901096">,</span>&nbsp;<span class="num" id="7901098">53</span><span class="op" id="7901100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7901103">10</span><span class="op" id="7901105">,</span>&nbsp;<span class="num" id="7901107">19</span><span class="op" id="7901109">,</span>&nbsp;<span class="num" id="7901111">23</span><span class="op" id="7901113">,</span>&nbsp;<span class="num" id="7901115">32</span><span class="op" id="7901117">,</span>&nbsp;<span class="num" id="7901119">39</span><span class="op" id="7901121">,</span>&nbsp;<span class="num" id="7901123">45</span><span class="op" id="7901125">,</span>&nbsp;<span class="num" id="7901127">52</span><span class="op" id="7901129">,</span>&nbsp;<span class="num" id="7901131">54</span><span class="op" id="7901133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7901136">20</span><span class="op" id="7901138">,</span>&nbsp;<span class="num" id="7901140">22</span><span class="op" id="7901142">,</span>&nbsp;<span class="num" id="7901144">33</span><span class="op" id="7901146">,</span>&nbsp;<span class="num" id="7901148">38</span><span class="op" id="7901150">,</span>&nbsp;<span class="num" id="7901152">46</span><span class="op" id="7901154">,</span>&nbsp;<span class="num" id="7901156">51</span><span class="op" id="7901158">,</span>&nbsp;<span class="num" id="7901160">55</span><span class="op" id="7901162">,</span>&nbsp;<span class="num" id="7901164">60</span><span class="op" id="7901166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7901169">21</span><span class="op" id="7901171">,</span>&nbsp;<span class="num" id="7901173">34</span><span class="op" id="7901175">,</span>&nbsp;<span class="num" id="7901177">37</span><span class="op" id="7901179">,</span>&nbsp;<span class="num" id="7901181">47</span><span class="op" id="7901183">,</span>&nbsp;<span class="num" id="7901185">50</span><span class="op" id="7901187">,</span>&nbsp;<span class="num" id="7901189">56</span><span class="op" id="7901191">,</span>&nbsp;<span class="num" id="7901193">59</span><span class="op" id="7901195">,</span>&nbsp;<span class="num" id="7901197">61</span><span class="op" id="7901199">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7901202">35</span><span class="op" id="7901204">,</span>&nbsp;<span class="num" id="7901206">36</span><span class="op" id="7901208">,</span>&nbsp;<span class="num" id="7901210">48</span><span class="op" id="7901212">,</span>&nbsp;<span class="num" id="7901214">49</span><span class="op" id="7901216">,</span>&nbsp;<span class="num" id="7901218">57</span><span class="op" id="7901220">,</span>&nbsp;<span class="num" id="7901222">58</span><span class="op" id="7901224">,</span>&nbsp;<span class="num" id="7901226">62</span><span class="op" id="7901228">,</span>&nbsp;<span class="num" id="7901230">63</span><span class="op" id="7901232">,</span><br>
<span class="lineno"></span><span class="op" id="7901234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7901237">func</span>&nbsp;<span class="ident" id="7901242">TestZigUnzig</span><span class="op" id="7901254">(</span><span class="ident" id="7901255">t</span>&nbsp;<span class="op" id="7901257">*</span><span class="ident" id="7901258">testing</span><span class="op" id="7901265">.</span><span class="ident" id="7901266">T</span><span class="op" id="7901267">)</span>&nbsp;<span class="op" id="7901269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7901272">for</span>&nbsp;<span class="ident" id="7901276">i</span>&nbsp;<span class="op" id="7901278">:=</span>&nbsp;<span class="num" id="7901281">0</span><span class="op" id="7901282">;</span>&nbsp;<span class="ident" id="7901284">i</span>&nbsp;<span class="op" id="7901286">&lt;</span>&nbsp;<span class="ident" id="7901288">blockSize</span><span class="op" id="7901297">;</span>&nbsp;<span class="ident" id="7901299">i</span><span class="op" id="7901300">++</span>&nbsp;<span class="op" id="7901303">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7901307">if</span>&nbsp;<span class="ident" id="7901310">unzig</span><span class="op" id="7901315">[</span><span class="ident" id="7901316">zigzag</span><span class="op" id="7901322">[</span><span class="ident" id="7901323">i</span><span class="op" id="7901324">]</span><span class="op" id="7901325">]</span>&nbsp;<span class="op" id="7901327">!=</span>&nbsp;<span class="ident" id="7901330">i</span>&nbsp;<span class="op" id="7901332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7901337">t</span><span class="op" id="7901338">.</span><span class="ident" id="7901339">Errorf</span><span class="op" id="7901345">(</span><span class="string" id="7901346">&#34;unzig[zigzag[%d]]&nbsp;==&nbsp;%d&#34;</span><span class="op" id="7901371">,</span>&nbsp;<span class="ident" id="7901373">i</span><span class="op" id="7901374">,</span>&nbsp;<span class="ident" id="7901376">unzig</span><span class="op" id="7901381">[</span><span class="ident" id="7901382">zigzag</span><span class="op" id="7901388">[</span><span class="ident" id="7901389">i</span><span class="op" id="7901390">]</span><span class="op" id="7901391">]</span><span class="op" id="7901392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7901396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7901400">if</span>&nbsp;<span class="ident" id="7901403">zigzag</span><span class="op" id="7901409">[</span><span class="ident" id="7901410">unzig</span><span class="op" id="7901415">[</span><span class="ident" id="7901416">i</span><span class="op" id="7901417">]</span><span class="op" id="7901418">]</span>&nbsp;<span class="op" id="7901420">!=</span>&nbsp;<span class="ident" id="7901423">i</span>&nbsp;<span class="op" id="7901425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7901430">t</span><span class="op" id="7901431">.</span><span class="ident" id="7901432">Errorf</span><span class="op" id="7901438">(</span><span class="string" id="7901439">&#34;zigzag[unzig[%d]]&nbsp;==&nbsp;%d&#34;</span><span class="op" id="7901464">,</span>&nbsp;<span class="ident" id="7901466">i</span><span class="op" id="7901467">,</span>&nbsp;<span class="ident" id="7901469">zigzag</span><span class="op" id="7901475">[</span><span class="ident" id="7901476">unzig</span><span class="op" id="7901481">[</span><span class="ident" id="7901482">i</span><span class="op" id="7901483">]</span><span class="op" id="7901484">]</span><span class="op" id="7901485">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7901489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7901492">}</span><br>
<span class="lineno"></span><span class="op" id="7901494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7901497">//&nbsp;unscaledQuantInNaturalOrder&nbsp;are&nbsp;the&nbsp;unscaled&nbsp;quantization&nbsp;tables&nbsp;in</span><br>
<span class="lineno">45</span><span class="comment" id="7901568">//&nbsp;natural&nbsp;(not&nbsp;zig-zag)&nbsp;order,&nbsp;as&nbsp;specified&nbsp;in&nbsp;section&nbsp;K.1.</span><br>
<span class="lineno"></span><span class="keyword" id="7901629">var</span>&nbsp;<span class="ident" id="7901633">unscaledQuantInNaturalOrder</span>&nbsp;<span class="op" id="7901661">=</span>&nbsp;<span class="op" id="7901663">[</span><span class="ident" id="7901664">nQuantIndex</span><span class="op" id="7901675">]</span><span class="op" id="7901676">[</span><span class="ident" id="7901677">blockSize</span><span class="op" id="7901686">]</span><span class="builtintype" id="7901687">byte</span><span class="op" id="7901691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7901694">//&nbsp;Luminance.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7901709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7901713">16</span><span class="op" id="7901715">,</span>&nbsp;<span class="num" id="7901717">11</span><span class="op" id="7901719">,</span>&nbsp;<span class="num" id="7901721">10</span><span class="op" id="7901723">,</span>&nbsp;<span class="num" id="7901725">16</span><span class="op" id="7901727">,</span>&nbsp;<span class="num" id="7901729">24</span><span class="op" id="7901731">,</span>&nbsp;<span class="num" id="7901733">40</span><span class="op" id="7901735">,</span>&nbsp;<span class="num" id="7901737">51</span><span class="op" id="7901739">,</span>&nbsp;<span class="num" id="7901741">61</span><span class="op" id="7901743">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7901747">12</span><span class="op" id="7901749">,</span>&nbsp;<span class="num" id="7901751">12</span><span class="op" id="7901753">,</span>&nbsp;<span class="num" id="7901755">14</span><span class="op" id="7901757">,</span>&nbsp;<span class="num" id="7901759">19</span><span class="op" id="7901761">,</span>&nbsp;<span class="num" id="7901763">26</span><span class="op" id="7901765">,</span>&nbsp;<span class="num" id="7901767">58</span><span class="op" id="7901769">,</span>&nbsp;<span class="num" id="7901771">60</span><span class="op" id="7901773">,</span>&nbsp;<span class="num" id="7901775">55</span><span class="op" id="7901777">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7901781">14</span><span class="op" id="7901783">,</span>&nbsp;<span class="num" id="7901785">13</span><span class="op" id="7901787">,</span>&nbsp;<span class="num" id="7901789">16</span><span class="op" id="7901791">,</span>&nbsp;<span class="num" id="7901793">24</span><span class="op" id="7901795">,</span>&nbsp;<span class="num" id="7901797">40</span><span class="op" id="7901799">,</span>&nbsp;<span class="num" id="7901801">57</span><span class="op" id="7901803">,</span>&nbsp;<span class="num" id="7901805">69</span><span class="op" id="7901807">,</span>&nbsp;<span class="num" id="7901809">56</span><span class="op" id="7901811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7901815">14</span><span class="op" id="7901817">,</span>&nbsp;<span class="num" id="7901819">17</span><span class="op" id="7901821">,</span>&nbsp;<span class="num" id="7901823">22</span><span class="op" id="7901825">,</span>&nbsp;<span class="num" id="7901827">29</span><span class="op" id="7901829">,</span>&nbsp;<span class="num" id="7901831">51</span><span class="op" id="7901833">,</span>&nbsp;<span class="num" id="7901835">87</span><span class="op" id="7901837">,</span>&nbsp;<span class="num" id="7901839">80</span><span class="op" id="7901841">,</span>&nbsp;<span class="num" id="7901843">62</span><span class="op" id="7901845">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7901849">18</span><span class="op" id="7901851">,</span>&nbsp;<span class="num" id="7901853">22</span><span class="op" id="7901855">,</span>&nbsp;<span class="num" id="7901857">37</span><span class="op" id="7901859">,</span>&nbsp;<span class="num" id="7901861">56</span><span class="op" id="7901863">,</span>&nbsp;<span class="num" id="7901865">68</span><span class="op" id="7901867">,</span>&nbsp;<span class="num" id="7901869">109</span><span class="op" id="7901872">,</span>&nbsp;<span class="num" id="7901874">103</span><span class="op" id="7901877">,</span>&nbsp;<span class="num" id="7901879">77</span><span class="op" id="7901881">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7901885">24</span><span class="op" id="7901887">,</span>&nbsp;<span class="num" id="7901889">35</span><span class="op" id="7901891">,</span>&nbsp;<span class="num" id="7901893">55</span><span class="op" id="7901895">,</span>&nbsp;<span class="num" id="7901897">64</span><span class="op" id="7901899">,</span>&nbsp;<span class="num" id="7901901">81</span><span class="op" id="7901903">,</span>&nbsp;<span class="num" id="7901905">104</span><span class="op" id="7901908">,</span>&nbsp;<span class="num" id="7901910">113</span><span class="op" id="7901913">,</span>&nbsp;<span class="num" id="7901915">92</span><span class="op" id="7901917">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7901921">49</span><span class="op" id="7901923">,</span>&nbsp;<span class="num" id="7901925">64</span><span class="op" id="7901927">,</span>&nbsp;<span class="num" id="7901929">78</span><span class="op" id="7901931">,</span>&nbsp;<span class="num" id="7901933">87</span><span class="op" id="7901935">,</span>&nbsp;<span class="num" id="7901937">103</span><span class="op" id="7901940">,</span>&nbsp;<span class="num" id="7901942">121</span><span class="op" id="7901945">,</span>&nbsp;<span class="num" id="7901947">120</span><span class="op" id="7901950">,</span>&nbsp;<span class="num" id="7901952">101</span><span class="op" id="7901955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7901959">72</span><span class="op" id="7901961">,</span>&nbsp;<span class="num" id="7901963">92</span><span class="op" id="7901965">,</span>&nbsp;<span class="num" id="7901967">95</span><span class="op" id="7901969">,</span>&nbsp;<span class="num" id="7901971">98</span><span class="op" id="7901973">,</span>&nbsp;<span class="num" id="7901975">112</span><span class="op" id="7901978">,</span>&nbsp;<span class="num" id="7901980">100</span><span class="op" id="7901983">,</span>&nbsp;<span class="num" id="7901985">103</span><span class="op" id="7901988">,</span>&nbsp;<span class="num" id="7901990">99</span><span class="op" id="7901992">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7901995">}</span><span class="op" id="7901996">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7901999">//&nbsp;Chrominance.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7902016">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7902020">17</span><span class="op" id="7902022">,</span>&nbsp;<span class="num" id="7902024">18</span><span class="op" id="7902026">,</span>&nbsp;<span class="num" id="7902028">24</span><span class="op" id="7902030">,</span>&nbsp;<span class="num" id="7902032">47</span><span class="op" id="7902034">,</span>&nbsp;<span class="num" id="7902036">99</span><span class="op" id="7902038">,</span>&nbsp;<span class="num" id="7902040">99</span><span class="op" id="7902042">,</span>&nbsp;<span class="num" id="7902044">99</span><span class="op" id="7902046">,</span>&nbsp;<span class="num" id="7902048">99</span><span class="op" id="7902050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7902054">18</span><span class="op" id="7902056">,</span>&nbsp;<span class="num" id="7902058">21</span><span class="op" id="7902060">,</span>&nbsp;<span class="num" id="7902062">26</span><span class="op" id="7902064">,</span>&nbsp;<span class="num" id="7902066">66</span><span class="op" id="7902068">,</span>&nbsp;<span class="num" id="7902070">99</span><span class="op" id="7902072">,</span>&nbsp;<span class="num" id="7902074">99</span><span class="op" id="7902076">,</span>&nbsp;<span class="num" id="7902078">99</span><span class="op" id="7902080">,</span>&nbsp;<span class="num" id="7902082">99</span><span class="op" id="7902084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7902088">24</span><span class="op" id="7902090">,</span>&nbsp;<span class="num" id="7902092">26</span><span class="op" id="7902094">,</span>&nbsp;<span class="num" id="7902096">56</span><span class="op" id="7902098">,</span>&nbsp;<span class="num" id="7902100">99</span><span class="op" id="7902102">,</span>&nbsp;<span class="num" id="7902104">99</span><span class="op" id="7902106">,</span>&nbsp;<span class="num" id="7902108">99</span><span class="op" id="7902110">,</span>&nbsp;<span class="num" id="7902112">99</span><span class="op" id="7902114">,</span>&nbsp;<span class="num" id="7902116">99</span><span class="op" id="7902118">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7902122">47</span><span class="op" id="7902124">,</span>&nbsp;<span class="num" id="7902126">66</span><span class="op" id="7902128">,</span>&nbsp;<span class="num" id="7902130">99</span><span class="op" id="7902132">,</span>&nbsp;<span class="num" id="7902134">99</span><span class="op" id="7902136">,</span>&nbsp;<span class="num" id="7902138">99</span><span class="op" id="7902140">,</span>&nbsp;<span class="num" id="7902142">99</span><span class="op" id="7902144">,</span>&nbsp;<span class="num" id="7902146">99</span><span class="op" id="7902148">,</span>&nbsp;<span class="num" id="7902150">99</span><span class="op" id="7902152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7902156">99</span><span class="op" id="7902158">,</span>&nbsp;<span class="num" id="7902160">99</span><span class="op" id="7902162">,</span>&nbsp;<span class="num" id="7902164">99</span><span class="op" id="7902166">,</span>&nbsp;<span class="num" id="7902168">99</span><span class="op" id="7902170">,</span>&nbsp;<span class="num" id="7902172">99</span><span class="op" id="7902174">,</span>&nbsp;<span class="num" id="7902176">99</span><span class="op" id="7902178">,</span>&nbsp;<span class="num" id="7902180">99</span><span class="op" id="7902182">,</span>&nbsp;<span class="num" id="7902184">99</span><span class="op" id="7902186">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7902190">99</span><span class="op" id="7902192">,</span>&nbsp;<span class="num" id="7902194">99</span><span class="op" id="7902196">,</span>&nbsp;<span class="num" id="7902198">99</span><span class="op" id="7902200">,</span>&nbsp;<span class="num" id="7902202">99</span><span class="op" id="7902204">,</span>&nbsp;<span class="num" id="7902206">99</span><span class="op" id="7902208">,</span>&nbsp;<span class="num" id="7902210">99</span><span class="op" id="7902212">,</span>&nbsp;<span class="num" id="7902214">99</span><span class="op" id="7902216">,</span>&nbsp;<span class="num" id="7902218">99</span><span class="op" id="7902220">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7902224">99</span><span class="op" id="7902226">,</span>&nbsp;<span class="num" id="7902228">99</span><span class="op" id="7902230">,</span>&nbsp;<span class="num" id="7902232">99</span><span class="op" id="7902234">,</span>&nbsp;<span class="num" id="7902236">99</span><span class="op" id="7902238">,</span>&nbsp;<span class="num" id="7902240">99</span><span class="op" id="7902242">,</span>&nbsp;<span class="num" id="7902244">99</span><span class="op" id="7902246">,</span>&nbsp;<span class="num" id="7902248">99</span><span class="op" id="7902250">,</span>&nbsp;<span class="num" id="7902252">99</span><span class="op" id="7902254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7902258">99</span><span class="op" id="7902260">,</span>&nbsp;<span class="num" id="7902262">99</span><span class="op" id="7902264">,</span>&nbsp;<span class="num" id="7902266">99</span><span class="op" id="7902268">,</span>&nbsp;<span class="num" id="7902270">99</span><span class="op" id="7902272">,</span>&nbsp;<span class="num" id="7902274">99</span><span class="op" id="7902276">,</span>&nbsp;<span class="num" id="7902278">99</span><span class="op" id="7902280">,</span>&nbsp;<span class="num" id="7902282">99</span><span class="op" id="7902284">,</span>&nbsp;<span class="num" id="7902286">99</span><span class="op" id="7902288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7902291">}</span><span class="op" id="7902292">,</span><br>
<span class="lineno"></span><span class="op" id="7902294">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="7902297">func</span>&nbsp;<span class="ident" id="7902302">TestUnscaledQuant</span><span class="op" id="7902319">(</span><span class="ident" id="7902320">t</span>&nbsp;<span class="op" id="7902322">*</span><span class="ident" id="7902323">testing</span><span class="op" id="7902330">.</span><span class="ident" id="7902331">T</span><span class="op" id="7902332">)</span>&nbsp;<span class="op" id="7902334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7902337">bad</span>&nbsp;<span class="op" id="7902341">:=</span>&nbsp;<span class="builtintype" id="7902344">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7902351">for</span>&nbsp;<span class="ident" id="7902355">i</span>&nbsp;<span class="op" id="7902357">:=</span>&nbsp;<span class="ident" id="7902360">quantIndex</span><span class="op" id="7902370">(</span><span class="num" id="7902371">0</span><span class="op" id="7902372">)</span><span class="op" id="7902373">;</span>&nbsp;<span class="ident" id="7902375">i</span>&nbsp;<span class="op" id="7902377">&lt;</span>&nbsp;<span class="ident" id="7902379">nQuantIndex</span><span class="op" id="7902390">;</span>&nbsp;<span class="ident" id="7902392">i</span><span class="op" id="7902393">++</span>&nbsp;<span class="op" id="7902396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7902400">for</span>&nbsp;<span class="ident" id="7902404">zig</span>&nbsp;<span class="op" id="7902408">:=</span>&nbsp;<span class="num" id="7902411">0</span><span class="op" id="7902412">;</span>&nbsp;<span class="ident" id="7902414">zig</span>&nbsp;<span class="op" id="7902418">&lt;</span>&nbsp;<span class="ident" id="7902420">blockSize</span><span class="op" id="7902429">;</span>&nbsp;<span class="ident" id="7902431">zig</span><span class="op" id="7902434">++</span>&nbsp;<span class="op" id="7902437">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7902442">got</span>&nbsp;<span class="op" id="7902446">:=</span>&nbsp;<span class="ident" id="7902449">unscaledQuant</span><span class="op" id="7902462">[</span><span class="ident" id="7902463">i</span><span class="op" id="7902464">]</span><span class="op" id="7902465">[</span><span class="ident" id="7902466">zig</span><span class="op" id="7902469">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7902474">want</span>&nbsp;<span class="op" id="7902479">:=</span>&nbsp;<span class="ident" id="7902482">unscaledQuantInNaturalOrder</span><span class="op" id="7902509">[</span><span class="ident" id="7902510">i</span><span class="op" id="7902511">]</span><span class="op" id="7902512">[</span><span class="ident" id="7902513">unzig</span><span class="op" id="7902518">[</span><span class="ident" id="7902519">zig</span><span class="op" id="7902522">]</span><span class="op" id="7902523">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7902528">if</span>&nbsp;<span class="ident" id="7902531">got</span>&nbsp;<span class="op" id="7902535">!=</span>&nbsp;<span class="ident" id="7902538">want</span>&nbsp;<span class="op" id="7902543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7902549">t</span><span class="op" id="7902550">.</span><span class="ident" id="7902551">Errorf</span><span class="op" id="7902557">(</span><span class="string" id="7902558">&#34;i=%d,&nbsp;zig=%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7902589">,</span>&nbsp;<span class="ident" id="7902591">i</span><span class="op" id="7902592">,</span>&nbsp;<span class="ident" id="7902594">zig</span><span class="op" id="7902597">,</span>&nbsp;<span class="ident" id="7902599">got</span><span class="op" id="7902602">,</span>&nbsp;<span class="ident" id="7902604">want</span><span class="op" id="7902608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7902614">bad</span>&nbsp;<span class="op" id="7902618">=</span>&nbsp;<span class="builtintype" id="7902620">true</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7902628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7902632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7902635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7902638">if</span>&nbsp;<span class="ident" id="7902641">bad</span>&nbsp;<span class="op" id="7902645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7902649">names</span>&nbsp;<span class="op" id="7902655">:=</span>&nbsp;<span class="op" id="7902658">[</span><span class="ident" id="7902659">nQuantIndex</span><span class="op" id="7902670">]</span><span class="builtintype" id="7902671">string</span><span class="op" id="7902677">{</span><span class="string" id="7902678">&#34;Luminance&#34;</span><span class="op" id="7902689">,</span>&nbsp;<span class="string" id="7902691">&#34;Chrominance&#34;</span><span class="op" id="7902704">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7902708">buf</span>&nbsp;<span class="op" id="7902712">:=</span>&nbsp;<span class="op" id="7902715">&amp;</span><span class="ident" id="7902716">bytes</span><span class="op" id="7902721">.</span><span class="ident" id="7902722">Buffer</span><span class="op" id="7902728">{</span><span class="op" id="7902729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7902733">for</span>&nbsp;<span class="ident" id="7902737">i</span><span class="op" id="7902738">,</span>&nbsp;<span class="ident" id="7902740">name</span>&nbsp;<span class="op" id="7902745">:=</span>&nbsp;<span class="keyword" id="7902748">range</span>&nbsp;<span class="ident" id="7902754">names</span>&nbsp;<span class="op" id="7902760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7902765">fmt</span><span class="op" id="7902768">.</span><span class="ident" id="7902769">Fprintf</span><span class="op" id="7902776">(</span><span class="ident" id="7902777">buf</span><span class="op" id="7902780">,</span>&nbsp;<span class="string" id="7902782">&#34;//&nbsp;%s.\n{\n&#34;</span><span class="op" id="7902795">,</span>&nbsp;<span class="ident" id="7902797">name</span><span class="op" id="7902801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7902806">for</span>&nbsp;<span class="ident" id="7902810">zig</span>&nbsp;<span class="op" id="7902814">:=</span>&nbsp;<span class="num" id="7902817">0</span><span class="op" id="7902818">;</span>&nbsp;<span class="ident" id="7902820">zig</span>&nbsp;<span class="op" id="7902824">&lt;</span>&nbsp;<span class="ident" id="7902826">blockSize</span><span class="op" id="7902835">;</span>&nbsp;<span class="ident" id="7902837">zig</span><span class="op" id="7902840">++</span>&nbsp;<span class="op" id="7902843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7902849">fmt</span><span class="op" id="7902852">.</span><span class="ident" id="7902853">Fprintf</span><span class="op" id="7902860">(</span><span class="ident" id="7902861">buf</span><span class="op" id="7902864">,</span>&nbsp;<span class="string" id="7902866">&#34;%d,&nbsp;&#34;</span><span class="op" id="7902872">,</span>&nbsp;<span class="ident" id="7902874">unscaledQuantInNaturalOrder</span><span class="op" id="7902901">[</span><span class="ident" id="7902902">i</span><span class="op" id="7902903">]</span><span class="op" id="7902904">[</span><span class="ident" id="7902905">unzig</span><span class="op" id="7902910">[</span><span class="ident" id="7902911">zig</span><span class="op" id="7902914">]</span><span class="op" id="7902915">]</span><span class="op" id="7902916">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7902922">if</span>&nbsp;<span class="ident" id="7902925">zig</span><span class="op" id="7902928">%</span><span class="num" id="7902929">8</span>&nbsp;<span class="op" id="7902931">==</span>&nbsp;<span class="num" id="7902934">7</span>&nbsp;<span class="op" id="7902936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7902943">buf</span><span class="op" id="7902946">.</span><span class="ident" id="7902947">WriteString</span><span class="op" id="7902958">(</span><span class="string" id="7902959">&#34;\n&#34;</span><span class="op" id="7902963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7902969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7902974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7902979">buf</span><span class="op" id="7902982">.</span><span class="ident" id="7902983">WriteString</span><span class="op" id="7902994">(</span><span class="string" id="7902995">&#34;},\n&#34;</span><span class="op" id="7903001">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903009">t</span><span class="op" id="7903010">.</span><span class="ident" id="7903011">Logf</span><span class="op" id="7903015">(</span><span class="string" id="7903016">&#34;expected&nbsp;unscaledQuant&nbsp;values:\n%s&#34;</span><span class="op" id="7903052">,</span>&nbsp;<span class="ident" id="7903054">buf</span><span class="op" id="7903057">.</span><span class="ident" id="7903058">String</span><span class="op" id="7903064">(</span><span class="op" id="7903065">)</span><span class="op" id="7903066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903069">}</span><br>
<span class="lineno"></span><span class="op" id="7903071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="7903074">var</span>&nbsp;<span class="ident" id="7903078">testCase</span>&nbsp;<span class="op" id="7903087">=</span>&nbsp;<span class="op" id="7903089">[</span><span class="op" id="7903090">]</span><span class="keyword" id="7903091">struct</span>&nbsp;<span class="op" id="7903098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903101">filename</span>&nbsp;&nbsp;<span class="builtintype" id="7903111">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903119">quality</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7903129">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903134">tolerance</span>&nbsp;<span class="ident" id="7903144">int64</span><br>
<span class="lineno"></span><span class="op" id="7903150">}</span><span class="op" id="7903151">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903154">{</span><span class="string" id="7903155">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7903182">,</span>&nbsp;<span class="num" id="7903184">1</span><span class="op" id="7903185">,</span>&nbsp;<span class="num" id="7903187">24</span>&nbsp;<span class="op" id="7903190">&lt;&lt;</span>&nbsp;<span class="num" id="7903193">8</span><span class="op" id="7903194">}</span><span class="op" id="7903195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903198">{</span><span class="string" id="7903199">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7903226">,</span>&nbsp;<span class="num" id="7903228">20</span><span class="op" id="7903230">,</span>&nbsp;<span class="num" id="7903232">12</span>&nbsp;<span class="op" id="7903235">&lt;&lt;</span>&nbsp;<span class="num" id="7903238">8</span><span class="op" id="7903239">}</span><span class="op" id="7903240">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903243">{</span><span class="string" id="7903244">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7903271">,</span>&nbsp;<span class="num" id="7903273">60</span><span class="op" id="7903275">,</span>&nbsp;<span class="num" id="7903277">8</span>&nbsp;<span class="op" id="7903279">&lt;&lt;</span>&nbsp;<span class="num" id="7903282">8</span><span class="op" id="7903283">}</span><span class="op" id="7903284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903287">{</span><span class="string" id="7903288">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7903315">,</span>&nbsp;<span class="num" id="7903317">80</span><span class="op" id="7903319">,</span>&nbsp;<span class="num" id="7903321">6</span>&nbsp;<span class="op" id="7903323">&lt;&lt;</span>&nbsp;<span class="num" id="7903326">8</span><span class="op" id="7903327">}</span><span class="op" id="7903328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903331">{</span><span class="string" id="7903332">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7903359">,</span>&nbsp;<span class="num" id="7903361">90</span><span class="op" id="7903363">,</span>&nbsp;<span class="num" id="7903365">4</span>&nbsp;<span class="op" id="7903367">&lt;&lt;</span>&nbsp;<span class="num" id="7903370">8</span><span class="op" id="7903371">}</span><span class="op" id="7903372">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903375">{</span><span class="string" id="7903376">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7903403">,</span>&nbsp;<span class="num" id="7903405">100</span><span class="op" id="7903408">,</span>&nbsp;<span class="num" id="7903410">2</span>&nbsp;<span class="op" id="7903412">&lt;&lt;</span>&nbsp;<span class="num" id="7903415">8</span><span class="op" id="7903416">}</span><span class="op" id="7903417">,</span><br>
<span class="lineno"></span><span class="op" id="7903419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7903422">func</span>&nbsp;<span class="ident" id="7903427">delta</span><span class="op" id="7903432">(</span><span class="ident" id="7903433">u0</span><span class="op" id="7903435">,</span>&nbsp;<span class="ident" id="7903437">u1</span>&nbsp;<span class="builtintype" id="7903440">uint32</span><span class="op" id="7903446">)</span>&nbsp;<span class="ident" id="7903448">int64</span>&nbsp;<span class="op" id="7903454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903457">d</span>&nbsp;<span class="op" id="7903459">:=</span>&nbsp;<span class="ident" id="7903462">int64</span><span class="op" id="7903467">(</span><span class="ident" id="7903468">u0</span><span class="op" id="7903470">)</span>&nbsp;<span class="op" id="7903472">-</span>&nbsp;<span class="ident" id="7903474">int64</span><span class="op" id="7903479">(</span><span class="ident" id="7903480">u1</span><span class="op" id="7903482">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7903485">if</span>&nbsp;<span class="ident" id="7903488">d</span>&nbsp;<span class="op" id="7903490">&lt;</span>&nbsp;<span class="num" id="7903492">0</span>&nbsp;<span class="op" id="7903494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7903498">return</span>&nbsp;<span class="op" id="7903505">-</span><span class="ident" id="7903506">d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7903512">return</span>&nbsp;<span class="ident" id="7903519">d</span><br>
<span class="lineno"></span><span class="op" id="7903521">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="7903524">func</span>&nbsp;<span class="ident" id="7903529">readPng</span><span class="op" id="7903536">(</span><span class="ident" id="7903537">filename</span>&nbsp;<span class="builtintype" id="7903546">string</span><span class="op" id="7903552">)</span>&nbsp;<span class="op" id="7903554">(</span><span class="ident" id="7903555">image</span><span class="op" id="7903560">.</span><span class="ident" id="7903561">Image</span><span class="op" id="7903566">,</span>&nbsp;<span class="builtintype" id="7903568">error</span><span class="op" id="7903573">)</span>&nbsp;<span class="op" id="7903575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903578">f</span><span class="op" id="7903579">,</span>&nbsp;<span class="ident" id="7903581">err</span>&nbsp;<span class="op" id="7903585">:=</span>&nbsp;<span class="ident" id="7903588">os</span><span class="op" id="7903590">.</span><span class="ident" id="7903591">Open</span><span class="op" id="7903595">(</span><span class="ident" id="7903596">filename</span><span class="op" id="7903604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7903607">if</span>&nbsp;<span class="ident" id="7903610">err</span>&nbsp;<span class="op" id="7903614">!=</span>&nbsp;<span class="ident" id="7903617">nil</span>&nbsp;<span class="op" id="7903621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7903625">return</span>&nbsp;<span class="ident" id="7903632">nil</span><span class="op" id="7903635">,</span>&nbsp;<span class="ident" id="7903637">err</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7903645">defer</span>&nbsp;<span class="ident" id="7903651">f</span><span class="op" id="7903652">.</span><span class="ident" id="7903653">Close</span><span class="op" id="7903658">(</span><span class="op" id="7903659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7903662">return</span>&nbsp;<span class="ident" id="7903669">png</span><span class="op" id="7903672">.</span><span class="ident" id="7903673">Decode</span><span class="op" id="7903679">(</span><span class="ident" id="7903680">f</span><span class="op" id="7903681">)</span><br>
<span class="lineno"></span><span class="op" id="7903683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="7903686">func</span>&nbsp;<span class="ident" id="7903691">TestWriter</span><span class="op" id="7903701">(</span><span class="ident" id="7903702">t</span>&nbsp;<span class="op" id="7903704">*</span><span class="ident" id="7903705">testing</span><span class="op" id="7903712">.</span><span class="ident" id="7903713">T</span><span class="op" id="7903714">)</span>&nbsp;<span class="op" id="7903716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7903719">for</span>&nbsp;<span class="ident" id="7903723">_</span><span class="op" id="7903724">,</span>&nbsp;<span class="ident" id="7903726">tc</span>&nbsp;<span class="op" id="7903729">:=</span>&nbsp;<span class="keyword" id="7903732">range</span>&nbsp;<span class="ident" id="7903738">testCase</span>&nbsp;<span class="op" id="7903747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7903751">//&nbsp;Read&nbsp;the&nbsp;image.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903772">m0</span><span class="op" id="7903774">,</span>&nbsp;<span class="ident" id="7903776">err</span>&nbsp;<span class="op" id="7903780">:=</span>&nbsp;<span class="ident" id="7903783">readPng</span><span class="op" id="7903790">(</span><span class="ident" id="7903791">tc</span><span class="op" id="7903793">.</span><span class="ident" id="7903794">filename</span><span class="op" id="7903802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7903806">if</span>&nbsp;<span class="ident" id="7903809">err</span>&nbsp;<span class="op" id="7903813">!=</span>&nbsp;<span class="ident" id="7903816">nil</span>&nbsp;<span class="op" id="7903820">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903825">t</span><span class="op" id="7903826">.</span><span class="ident" id="7903827">Error</span><span class="op" id="7903832">(</span><span class="ident" id="7903833">tc</span><span class="op" id="7903835">.</span><span class="ident" id="7903836">filename</span><span class="op" id="7903844">,</span>&nbsp;<span class="ident" id="7903846">err</span><span class="op" id="7903849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7903854">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7903869">//&nbsp;Encode&nbsp;that&nbsp;image&nbsp;as&nbsp;JPEG.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7903901">var</span>&nbsp;<span class="ident" id="7903905">buf</span>&nbsp;<span class="ident" id="7903909">bytes</span><span class="op" id="7903914">.</span><span class="ident" id="7903915">Buffer</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903924">err</span>&nbsp;<span class="op" id="7903928">=</span>&nbsp;<span class="ident" id="7903930">Encode</span><span class="op" id="7903936">(</span><span class="op" id="7903937">&amp;</span><span class="ident" id="7903938">buf</span><span class="op" id="7903941">,</span>&nbsp;<span class="ident" id="7903943">m0</span><span class="op" id="7903945">,</span>&nbsp;<span class="op" id="7903947">&amp;</span><span class="ident" id="7903948">Options</span><span class="op" id="7903955">{</span><span class="ident" id="7903956">Quality</span><span class="op" id="7903963">:</span>&nbsp;<span class="ident" id="7903965">tc</span><span class="op" id="7903967">.</span><span class="ident" id="7903968">quality</span><span class="op" id="7903975">}</span><span class="op" id="7903976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7903980">if</span>&nbsp;<span class="ident" id="7903983">err</span>&nbsp;<span class="op" id="7903987">!=</span>&nbsp;<span class="ident" id="7903990">nil</span>&nbsp;<span class="op" id="7903994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903999">t</span><span class="op" id="7904000">.</span><span class="ident" id="7904001">Error</span><span class="op" id="7904006">(</span><span class="ident" id="7904007">tc</span><span class="op" id="7904009">.</span><span class="ident" id="7904010">filename</span><span class="op" id="7904018">,</span>&nbsp;<span class="ident" id="7904020">err</span><span class="op" id="7904023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904028">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904039">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7904043">//&nbsp;Decode&nbsp;that&nbsp;JPEG.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7904066">m1</span><span class="op" id="7904068">,</span>&nbsp;<span class="ident" id="7904070">err</span>&nbsp;<span class="op" id="7904074">:=</span>&nbsp;<span class="ident" id="7904077">Decode</span><span class="op" id="7904083">(</span><span class="op" id="7904084">&amp;</span><span class="ident" id="7904085">buf</span><span class="op" id="7904088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904092">if</span>&nbsp;<span class="ident" id="7904095">err</span>&nbsp;<span class="op" id="7904099">!=</span>&nbsp;<span class="ident" id="7904102">nil</span>&nbsp;<span class="op" id="7904106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7904111">t</span><span class="op" id="7904112">.</span><span class="ident" id="7904113">Error</span><span class="op" id="7904118">(</span><span class="ident" id="7904119">tc</span><span class="op" id="7904121">.</span><span class="ident" id="7904122">filename</span><span class="op" id="7904130">,</span>&nbsp;<span class="ident" id="7904132">err</span><span class="op" id="7904135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904140">continue</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904155">if</span>&nbsp;<span class="ident" id="7904158">m0</span><span class="op" id="7904160">.</span><span class="ident" id="7904161">Bounds</span><span class="op" id="7904167">(</span><span class="op" id="7904168">)</span>&nbsp;<span class="op" id="7904170">!=</span>&nbsp;<span class="ident" id="7904173">m1</span><span class="op" id="7904175">.</span><span class="ident" id="7904176">Bounds</span><span class="op" id="7904182">(</span><span class="op" id="7904183">)</span>&nbsp;<span class="op" id="7904185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7904190">t</span><span class="op" id="7904191">.</span><span class="ident" id="7904192">Errorf</span><span class="op" id="7904198">(</span><span class="string" id="7904199">&#34;%s,&nbsp;bounds&nbsp;differ:&nbsp;%v&nbsp;and&nbsp;%v&#34;</span><span class="op" id="7904229">,</span>&nbsp;<span class="ident" id="7904231">tc</span><span class="op" id="7904233">.</span><span class="ident" id="7904234">filename</span><span class="op" id="7904242">,</span>&nbsp;<span class="ident" id="7904244">m0</span><span class="op" id="7904246">.</span><span class="ident" id="7904247">Bounds</span><span class="op" id="7904253">(</span><span class="op" id="7904254">)</span><span class="op" id="7904255">,</span>&nbsp;<span class="ident" id="7904257">m1</span><span class="op" id="7904259">.</span><span class="ident" id="7904260">Bounds</span><span class="op" id="7904266">(</span><span class="op" id="7904267">)</span><span class="op" id="7904268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904273">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904284">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7904288">//&nbsp;Compare&nbsp;the&nbsp;average&nbsp;delta&nbsp;to&nbsp;the&nbsp;tolerance&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904343">if</span>&nbsp;<span class="ident" id="7904346">averageDelta</span><span class="op" id="7904358">(</span><span class="ident" id="7904359">m0</span><span class="op" id="7904361">,</span>&nbsp;<span class="ident" id="7904363">m1</span><span class="op" id="7904365">)</span>&nbsp;<span class="op" id="7904367">&gt;</span>&nbsp;<span class="ident" id="7904369">tc</span><span class="op" id="7904371">.</span><span class="ident" id="7904372">tolerance</span>&nbsp;<span class="op" id="7904382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7904387">t</span><span class="op" id="7904388">.</span><span class="ident" id="7904389">Errorf</span><span class="op" id="7904395">(</span><span class="string" id="7904396">&#34;%s,&nbsp;quality=%d:&nbsp;average&nbsp;delta&nbsp;is&nbsp;too&nbsp;high&#34;</span><span class="op" id="7904439">,</span>&nbsp;<span class="ident" id="7904441">tc</span><span class="op" id="7904443">.</span><span class="ident" id="7904444">filename</span><span class="op" id="7904452">,</span>&nbsp;<span class="ident" id="7904454">tc</span><span class="op" id="7904456">.</span><span class="ident" id="7904457">quality</span><span class="op" id="7904464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904469">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904480">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904483">}</span><br>
<span class="lineno"></span><span class="op" id="7904485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7904488">//&nbsp;TestWriteGrayscale&nbsp;tests&nbsp;that&nbsp;a&nbsp;grayscale&nbsp;images&nbsp;survives&nbsp;a&nbsp;round-trip</span><br>
<span class="lineno"></span><span class="comment" id="7904562">//&nbsp;through&nbsp;encode/decode&nbsp;cycle.</span><br>
<span class="lineno">165</span><span class="keyword" id="7904594">func</span>&nbsp;<span class="ident" id="7904599">TestWriteGrayscale</span><span class="op" id="7904617">(</span><span class="ident" id="7904618">t</span>&nbsp;<span class="op" id="7904620">*</span><span class="ident" id="7904621">testing</span><span class="op" id="7904628">.</span><span class="ident" id="7904629">T</span><span class="op" id="7904630">)</span>&nbsp;<span class="op" id="7904632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7904635">m0</span>&nbsp;<span class="op" id="7904638">:=</span>&nbsp;<span class="ident" id="7904641">image</span><span class="op" id="7904646">.</span><span class="ident" id="7904647">NewGray</span><span class="op" id="7904654">(</span><span class="ident" id="7904655">image</span><span class="op" id="7904660">.</span><span class="ident" id="7904661">Rect</span><span class="op" id="7904665">(</span><span class="num" id="7904666">0</span><span class="op" id="7904667">,</span>&nbsp;<span class="num" id="7904669">0</span><span class="op" id="7904670">,</span>&nbsp;<span class="num" id="7904672">32</span><span class="op" id="7904674">,</span>&nbsp;<span class="num" id="7904676">32</span><span class="op" id="7904678">)</span><span class="op" id="7904679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904682">for</span>&nbsp;<span class="ident" id="7904686">i</span>&nbsp;<span class="op" id="7904688">:=</span>&nbsp;<span class="keyword" id="7904691">range</span>&nbsp;<span class="ident" id="7904697">m0</span><span class="op" id="7904699">.</span><span class="ident" id="7904700">Pix</span>&nbsp;<span class="op" id="7904704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7904708">m0</span><span class="op" id="7904710">.</span><span class="ident" id="7904711">Pix</span><span class="op" id="7904714">[</span><span class="ident" id="7904715">i</span><span class="op" id="7904716">]</span>&nbsp;<span class="op" id="7904718">=</span>&nbsp;<span class="builtintype" id="7904720">uint8</span><span class="op" id="7904725">(</span><span class="ident" id="7904726">i</span><span class="op" id="7904727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904730">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904733">var</span>&nbsp;<span class="ident" id="7904737">buf</span>&nbsp;<span class="ident" id="7904741">bytes</span><span class="op" id="7904746">.</span><span class="ident" id="7904747">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904755">if</span>&nbsp;<span class="ident" id="7904758">err</span>&nbsp;<span class="op" id="7904762">:=</span>&nbsp;<span class="ident" id="7904765">Encode</span><span class="op" id="7904771">(</span><span class="op" id="7904772">&amp;</span><span class="ident" id="7904773">buf</span><span class="op" id="7904776">,</span>&nbsp;<span class="ident" id="7904778">m0</span><span class="op" id="7904780">,</span>&nbsp;<span class="ident" id="7904782">nil</span><span class="op" id="7904785">)</span><span class="op" id="7904786">;</span>&nbsp;<span class="ident" id="7904788">err</span>&nbsp;<span class="op" id="7904792">!=</span>&nbsp;<span class="ident" id="7904795">nil</span>&nbsp;<span class="op" id="7904799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7904803">t</span><span class="op" id="7904804">.</span><span class="ident" id="7904805">Fatal</span><span class="op" id="7904810">(</span><span class="ident" id="7904811">err</span><span class="op" id="7904814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7904820">m1</span><span class="op" id="7904822">,</span>&nbsp;<span class="ident" id="7904824">err</span>&nbsp;<span class="op" id="7904828">:=</span>&nbsp;<span class="ident" id="7904831">Decode</span><span class="op" id="7904837">(</span><span class="op" id="7904838">&amp;</span><span class="ident" id="7904839">buf</span><span class="op" id="7904842">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904845">if</span>&nbsp;<span class="ident" id="7904848">err</span>&nbsp;<span class="op" id="7904852">!=</span>&nbsp;<span class="ident" id="7904855">nil</span>&nbsp;<span class="op" id="7904859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7904863">t</span><span class="op" id="7904864">.</span><span class="ident" id="7904865">Fatal</span><span class="op" id="7904870">(</span><span class="ident" id="7904871">err</span><span class="op" id="7904874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904880">if</span>&nbsp;<span class="ident" id="7904883">m0</span><span class="op" id="7904885">.</span><span class="ident" id="7904886">Bounds</span><span class="op" id="7904892">(</span><span class="op" id="7904893">)</span>&nbsp;<span class="op" id="7904895">!=</span>&nbsp;<span class="ident" id="7904898">m1</span><span class="op" id="7904900">.</span><span class="ident" id="7904901">Bounds</span><span class="op" id="7904907">(</span><span class="op" id="7904908">)</span>&nbsp;<span class="op" id="7904910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7904914">t</span><span class="op" id="7904915">.</span><span class="ident" id="7904916">Fatalf</span><span class="op" id="7904922">(</span><span class="string" id="7904923">&#34;bounds&nbsp;differ:&nbsp;%v&nbsp;and&nbsp;%v&#34;</span><span class="op" id="7904949">,</span>&nbsp;<span class="ident" id="7904951">m0</span><span class="op" id="7904953">.</span><span class="ident" id="7904954">Bounds</span><span class="op" id="7904960">(</span><span class="op" id="7904961">)</span><span class="op" id="7904962">,</span>&nbsp;<span class="ident" id="7904964">m1</span><span class="op" id="7904966">.</span><span class="ident" id="7904967">Bounds</span><span class="op" id="7904973">(</span><span class="op" id="7904974">)</span><span class="op" id="7904975">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904981">if</span>&nbsp;<span class="ident" id="7904984">_</span><span class="op" id="7904985">,</span>&nbsp;<span class="ident" id="7904987">ok</span>&nbsp;<span class="op" id="7904990">:=</span>&nbsp;<span class="ident" id="7904993">m1</span><span class="op" id="7904995">.</span><span class="op" id="7904996">(</span><span class="op" id="7904997">*</span><span class="ident" id="7904998">image</span><span class="op" id="7905003">.</span><span class="ident" id="7905004">Gray</span><span class="op" id="7905008">)</span><span class="op" id="7905009">;</span>&nbsp;<span class="op" id="7905011">!</span><span class="ident" id="7905012">ok</span>&nbsp;<span class="op" id="7905015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905019">t</span><span class="op" id="7905020">.</span><span class="ident" id="7905021">Errorf</span><span class="op" id="7905027">(</span><span class="string" id="7905028">&#34;got&nbsp;%T,&nbsp;want&nbsp;*image.Gray&#34;</span><span class="op" id="7905054">,</span>&nbsp;<span class="ident" id="7905056">m1</span><span class="op" id="7905058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7905061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7905064">//&nbsp;Compare&nbsp;the&nbsp;average&nbsp;delta&nbsp;to&nbsp;the&nbsp;tolerance&nbsp;level.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905118">want</span>&nbsp;<span class="op" id="7905123">:=</span>&nbsp;<span class="ident" id="7905126">int64</span><span class="op" id="7905131">(</span><span class="num" id="7905132">2</span>&nbsp;<span class="op" id="7905134">&lt;&lt;</span>&nbsp;<span class="num" id="7905137">8</span><span class="op" id="7905138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7905141">if</span>&nbsp;<span class="ident" id="7905144">got</span>&nbsp;<span class="op" id="7905148">:=</span>&nbsp;<span class="ident" id="7905151">averageDelta</span><span class="op" id="7905163">(</span><span class="ident" id="7905164">m0</span><span class="op" id="7905166">,</span>&nbsp;<span class="ident" id="7905168">m1</span><span class="op" id="7905170">)</span><span class="op" id="7905171">;</span>&nbsp;<span class="ident" id="7905173">got</span>&nbsp;<span class="op" id="7905177">&gt;</span>&nbsp;<span class="ident" id="7905179">want</span>&nbsp;<span class="op" id="7905184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905188">t</span><span class="op" id="7905189">.</span><span class="ident" id="7905190">Errorf</span><span class="op" id="7905196">(</span><span class="string" id="7905197">&#34;average&nbsp;delta&nbsp;too&nbsp;high;&nbsp;got&nbsp;%d,&nbsp;want&nbsp;&lt;=&nbsp;%d&#34;</span><span class="op" id="7905241">,</span>&nbsp;<span class="ident" id="7905243">got</span><span class="op" id="7905246">,</span>&nbsp;<span class="ident" id="7905248">want</span><span class="op" id="7905252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7905255">}</span><br>
<span class="lineno"></span><span class="op" id="7905257">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="7905260">//&nbsp;averageDelta&nbsp;returns&nbsp;the&nbsp;average&nbsp;delta&nbsp;in&nbsp;RGB&nbsp;space.&nbsp;The&nbsp;two&nbsp;images&nbsp;must</span><br>
<span class="lineno"></span><span class="comment" id="7905336">//&nbsp;have&nbsp;the&nbsp;same&nbsp;bounds.</span><br>
<span class="lineno"></span><span class="keyword" id="7905361">func</span>&nbsp;<span class="ident" id="7905366">averageDelta</span><span class="op" id="7905378">(</span><span class="ident" id="7905379">m0</span><span class="op" id="7905381">,</span>&nbsp;<span class="ident" id="7905383">m1</span>&nbsp;<span class="ident" id="7905386">image</span><span class="op" id="7905391">.</span><span class="ident" id="7905392">Image</span><span class="op" id="7905397">)</span>&nbsp;<span class="ident" id="7905399">int64</span>&nbsp;<span class="op" id="7905405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905408">b</span>&nbsp;<span class="op" id="7905410">:=</span>&nbsp;<span class="ident" id="7905413">m0</span><span class="op" id="7905415">.</span><span class="ident" id="7905416">Bounds</span><span class="op" id="7905422">(</span><span class="op" id="7905423">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7905426">var</span>&nbsp;<span class="ident" id="7905430">sum</span><span class="op" id="7905433">,</span>&nbsp;<span class="ident" id="7905435">n</span>&nbsp;<span class="ident" id="7905437">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7905444">for</span>&nbsp;<span class="ident" id="7905448">y</span>&nbsp;<span class="op" id="7905450">:=</span>&nbsp;<span class="ident" id="7905453">b</span><span class="op" id="7905454">.</span><span class="ident" id="7905455">Min</span><span class="op" id="7905458">.</span><span class="ident" id="7905459">Y</span><span class="op" id="7905460">;</span>&nbsp;<span class="ident" id="7905462">y</span>&nbsp;<span class="op" id="7905464">&lt;</span>&nbsp;<span class="ident" id="7905466">b</span><span class="op" id="7905467">.</span><span class="ident" id="7905468">Max</span><span class="op" id="7905471">.</span><span class="ident" id="7905472">Y</span><span class="op" id="7905473">;</span>&nbsp;<span class="ident" id="7905475">y</span><span class="op" id="7905476">++</span>&nbsp;<span class="op" id="7905479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7905483">for</span>&nbsp;<span class="ident" id="7905487">x</span>&nbsp;<span class="op" id="7905489">:=</span>&nbsp;<span class="ident" id="7905492">b</span><span class="op" id="7905493">.</span><span class="ident" id="7905494">Min</span><span class="op" id="7905497">.</span><span class="ident" id="7905498">X</span><span class="op" id="7905499">;</span>&nbsp;<span class="ident" id="7905501">x</span>&nbsp;<span class="op" id="7905503">&lt;</span>&nbsp;<span class="ident" id="7905505">b</span><span class="op" id="7905506">.</span><span class="ident" id="7905507">Max</span><span class="op" id="7905510">.</span><span class="ident" id="7905511">X</span><span class="op" id="7905512">;</span>&nbsp;<span class="ident" id="7905514">x</span><span class="op" id="7905515">++</span>&nbsp;<span class="op" id="7905518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905523">c0</span>&nbsp;<span class="op" id="7905526">:=</span>&nbsp;<span class="ident" id="7905529">m0</span><span class="op" id="7905531">.</span><span class="ident" id="7905532">At</span><span class="op" id="7905534">(</span><span class="ident" id="7905535">x</span><span class="op" id="7905536">,</span>&nbsp;<span class="ident" id="7905538">y</span><span class="op" id="7905539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905544">c1</span>&nbsp;<span class="op" id="7905547">:=</span>&nbsp;<span class="ident" id="7905550">m1</span><span class="op" id="7905552">.</span><span class="ident" id="7905553">At</span><span class="op" id="7905555">(</span><span class="ident" id="7905556">x</span><span class="op" id="7905557">,</span>&nbsp;<span class="ident" id="7905559">y</span><span class="op" id="7905560">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905565">r0</span><span class="op" id="7905567">,</span>&nbsp;<span class="ident" id="7905569">g0</span><span class="op" id="7905571">,</span>&nbsp;<span class="ident" id="7905573">b0</span><span class="op" id="7905575">,</span>&nbsp;<span class="ident" id="7905577">_</span>&nbsp;<span class="op" id="7905579">:=</span>&nbsp;<span class="ident" id="7905582">c0</span><span class="op" id="7905584">.</span><span class="ident" id="7905585">RGBA</span><span class="op" id="7905589">(</span><span class="op" id="7905590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905595">r1</span><span class="op" id="7905597">,</span>&nbsp;<span class="ident" id="7905599">g1</span><span class="op" id="7905601">,</span>&nbsp;<span class="ident" id="7905603">b1</span><span class="op" id="7905605">,</span>&nbsp;<span class="ident" id="7905607">_</span>&nbsp;<span class="op" id="7905609">:=</span>&nbsp;<span class="ident" id="7905612">c1</span><span class="op" id="7905614">.</span><span class="ident" id="7905615">RGBA</span><span class="op" id="7905619">(</span><span class="op" id="7905620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905625">sum</span>&nbsp;<span class="op" id="7905629">+=</span>&nbsp;<span class="ident" id="7905632">delta</span><span class="op" id="7905637">(</span><span class="ident" id="7905638">r0</span><span class="op" id="7905640">,</span>&nbsp;<span class="ident" id="7905642">r1</span><span class="op" id="7905644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905649">sum</span>&nbsp;<span class="op" id="7905653">+=</span>&nbsp;<span class="ident" id="7905656">delta</span><span class="op" id="7905661">(</span><span class="ident" id="7905662">g0</span><span class="op" id="7905664">,</span>&nbsp;<span class="ident" id="7905666">g1</span><span class="op" id="7905668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905673">sum</span>&nbsp;<span class="op" id="7905677">+=</span>&nbsp;<span class="ident" id="7905680">delta</span><span class="op" id="7905685">(</span><span class="ident" id="7905686">b0</span><span class="op" id="7905688">,</span>&nbsp;<span class="ident" id="7905690">b1</span><span class="op" id="7905692">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905697">n</span>&nbsp;<span class="op" id="7905699">+=</span>&nbsp;<span class="num" id="7905702">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7905706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7905709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7905712">return</span>&nbsp;<span class="ident" id="7905719">sum</span>&nbsp;<span class="op" id="7905723">/</span>&nbsp;<span class="ident" id="7905725">n</span><br>
<span class="lineno"></span><span class="op" id="7905727">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="7905730">func</span>&nbsp;<span class="ident" id="7905735">BenchmarkEncode</span><span class="op" id="7905750">(</span><span class="ident" id="7905751">b</span>&nbsp;<span class="op" id="7905753">*</span><span class="ident" id="7905754">testing</span><span class="op" id="7905761">.</span><span class="ident" id="7905762">B</span><span class="op" id="7905763">)</span>&nbsp;<span class="op" id="7905765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905768">b</span><span class="op" id="7905769">.</span><span class="ident" id="7905770">StopTimer</span><span class="op" id="7905779">(</span><span class="op" id="7905780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905783">img</span>&nbsp;<span class="op" id="7905787">:=</span>&nbsp;<span class="ident" id="7905790">image</span><span class="op" id="7905795">.</span><span class="ident" id="7905796">NewRGBA</span><span class="op" id="7905803">(</span><span class="ident" id="7905804">image</span><span class="op" id="7905809">.</span><span class="ident" id="7905810">Rect</span><span class="op" id="7905814">(</span><span class="num" id="7905815">0</span><span class="op" id="7905816">,</span>&nbsp;<span class="num" id="7905818">0</span><span class="op" id="7905819">,</span>&nbsp;<span class="num" id="7905821">640</span><span class="op" id="7905824">,</span>&nbsp;<span class="num" id="7905826">480</span><span class="op" id="7905829">)</span><span class="op" id="7905830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905833">bo</span>&nbsp;<span class="op" id="7905836">:=</span>&nbsp;<span class="ident" id="7905839">img</span><span class="op" id="7905842">.</span><span class="ident" id="7905843">Bounds</span><span class="op" id="7905849">(</span><span class="op" id="7905850">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905853">rnd</span>&nbsp;<span class="op" id="7905857">:=</span>&nbsp;<span class="ident" id="7905860">rand</span><span class="op" id="7905864">.</span><span class="ident" id="7905865">New</span><span class="op" id="7905868">(</span><span class="ident" id="7905869">rand</span><span class="op" id="7905873">.</span><span class="ident" id="7905874">NewSource</span><span class="op" id="7905883">(</span><span class="num" id="7905884">123</span><span class="op" id="7905887">)</span><span class="op" id="7905888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7905891">for</span>&nbsp;<span class="ident" id="7905895">y</span>&nbsp;<span class="op" id="7905897">:=</span>&nbsp;<span class="ident" id="7905900">bo</span><span class="op" id="7905902">.</span><span class="ident" id="7905903">Min</span><span class="op" id="7905906">.</span><span class="ident" id="7905907">Y</span><span class="op" id="7905908">;</span>&nbsp;<span class="ident" id="7905910">y</span>&nbsp;<span class="op" id="7905912">&lt;</span>&nbsp;<span class="ident" id="7905914">bo</span><span class="op" id="7905916">.</span><span class="ident" id="7905917">Max</span><span class="op" id="7905920">.</span><span class="ident" id="7905921">Y</span><span class="op" id="7905922">;</span>&nbsp;<span class="ident" id="7905924">y</span><span class="op" id="7905925">++</span>&nbsp;<span class="op" id="7905928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7905932">for</span>&nbsp;<span class="ident" id="7905936">x</span>&nbsp;<span class="op" id="7905938">:=</span>&nbsp;<span class="ident" id="7905941">bo</span><span class="op" id="7905943">.</span><span class="ident" id="7905944">Min</span><span class="op" id="7905947">.</span><span class="ident" id="7905948">X</span><span class="op" id="7905949">;</span>&nbsp;<span class="ident" id="7905951">x</span>&nbsp;<span class="op" id="7905953">&lt;</span>&nbsp;<span class="ident" id="7905955">bo</span><span class="op" id="7905957">.</span><span class="ident" id="7905958">Max</span><span class="op" id="7905961">.</span><span class="ident" id="7905962">X</span><span class="op" id="7905963">;</span>&nbsp;<span class="ident" id="7905965">x</span><span class="op" id="7905966">++</span>&nbsp;<span class="op" id="7905969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905974">img</span><span class="op" id="7905977">.</span><span class="ident" id="7905978">SetRGBA</span><span class="op" id="7905985">(</span><span class="ident" id="7905986">x</span><span class="op" id="7905987">,</span>&nbsp;<span class="ident" id="7905989">y</span><span class="op" id="7905990">,</span>&nbsp;<span class="ident" id="7905992">color</span><span class="op" id="7905997">.</span><span class="ident" id="7905998">RGBA</span><span class="op" id="7906002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="7906008">uint8</span><span class="op" id="7906013">(</span><span class="ident" id="7906014">rnd</span><span class="op" id="7906017">.</span><span class="ident" id="7906018">Intn</span><span class="op" id="7906022">(</span><span class="num" id="7906023">256</span><span class="op" id="7906026">)</span><span class="op" id="7906027">)</span><span class="op" id="7906028">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="7906034">uint8</span><span class="op" id="7906039">(</span><span class="ident" id="7906040">rnd</span><span class="op" id="7906043">.</span><span class="ident" id="7906044">Intn</span><span class="op" id="7906048">(</span><span class="num" id="7906049">256</span><span class="op" id="7906052">)</span><span class="op" id="7906053">)</span><span class="op" id="7906054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="7906060">uint8</span><span class="op" id="7906065">(</span><span class="ident" id="7906066">rnd</span><span class="op" id="7906069">.</span><span class="ident" id="7906070">Intn</span><span class="op" id="7906074">(</span><span class="num" id="7906075">256</span><span class="op" id="7906078">)</span><span class="op" id="7906079">)</span><span class="op" id="7906080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7906086">255</span><span class="op" id="7906089">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7906094">}</span><span class="op" id="7906095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7906099">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7906102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7906105">b</span><span class="op" id="7906106">.</span><span class="ident" id="7906107">SetBytes</span><span class="op" id="7906115">(</span><span class="num" id="7906116">640</span>&nbsp;<span class="op" id="7906120">*</span>&nbsp;<span class="num" id="7906122">480</span>&nbsp;<span class="op" id="7906126">*</span>&nbsp;<span class="num" id="7906128">4</span><span class="op" id="7906129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7906132">b</span><span class="op" id="7906133">.</span><span class="ident" id="7906134">StartTimer</span><span class="op" id="7906144">(</span><span class="op" id="7906145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7906148">options</span>&nbsp;<span class="op" id="7906156">:=</span>&nbsp;<span class="op" id="7906159">&amp;</span><span class="ident" id="7906160">Options</span><span class="op" id="7906167">{</span><span class="ident" id="7906168">Quality</span><span class="op" id="7906175">:</span>&nbsp;<span class="num" id="7906177">90</span><span class="op" id="7906179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7906182">for</span>&nbsp;<span class="ident" id="7906186">i</span>&nbsp;<span class="op" id="7906188">:=</span>&nbsp;<span class="num" id="7906191">0</span><span class="op" id="7906192">;</span>&nbsp;<span class="ident" id="7906194">i</span>&nbsp;<span class="op" id="7906196">&lt;</span>&nbsp;<span class="ident" id="7906198">b</span><span class="op" id="7906199">.</span><span class="ident" id="7906200">N</span><span class="op" id="7906201">;</span>&nbsp;<span class="ident" id="7906203">i</span><span class="op" id="7906204">++</span>&nbsp;<span class="op" id="7906207">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7906211">Encode</span><span class="op" id="7906217">(</span><span class="ident" id="7906218">ioutil</span><span class="op" id="7906224">.</span><span class="ident" id="7906225">Discard</span><span class="op" id="7906232">,</span>&nbsp;<span class="ident" id="7906234">img</span><span class="op" id="7906237">,</span>&nbsp;<span class="ident" id="7906239">options</span><span class="op" id="7906246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7906249">}</span><br>
<span class="lineno"></span><span class="op" id="7906251">}</span>
</div>
</body>
</html>
