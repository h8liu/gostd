<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1536766">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1536821">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1536875">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1536926">package</span>&nbsp;<span class="ident" id="1536934">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1536940">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;error&nbsp;function&nbsp;and&nbsp;complementary&nbsp;error&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1537012">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="1537066">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/s_erf.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1537118">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="1537173">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="1537203">//</span><br>
<span class="lineno"></span><span class="comment" id="1537206">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1537262">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1537331">//</span><br>
<span class="lineno"></span><span class="comment" id="1537334">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="1537393">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="1537449">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="1537506">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="1537523">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1537579">//</span><br>
<span class="lineno">25</span><span class="comment" id="1537582">//</span><br>
<span class="lineno"></span><span class="comment" id="1537585">//&nbsp;double&nbsp;erf(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="1537609">//&nbsp;double&nbsp;erfc(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="1537634">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="1537665">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|\</span><br>
<span class="lineno">30</span><span class="comment" id="1537697">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;&nbsp;---------&nbsp;&nbsp;|&nbsp;exp(-t*t)dt</span><br>
<span class="lineno"></span><span class="comment" id="1537740">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqrt(pi)&nbsp;\|</span><br>
<span class="lineno"></span><span class="comment" id="1537771">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1537802">//</span><br>
<span class="lineno"></span><span class="comment" id="1537805">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;&nbsp;1-erf(x)</span><br>
<span class="lineno">35</span><span class="comment" id="1537832">//&nbsp;&nbsp;Note&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1537846">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(-x)&nbsp;=&nbsp;-erf(x)</span><br>
<span class="lineno"></span><span class="comment" id="1537880">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(-x)&nbsp;=&nbsp;2&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="1537919">//</span><br>
<span class="lineno"></span><span class="comment" id="1537922">//&nbsp;Method:</span><br>
<span class="lineno">40</span><span class="comment" id="1537933">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="1537968">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;x&nbsp;+&nbsp;x*R(x**2)</span><br>
<span class="lineno"></span><span class="comment" id="1538004">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;1&nbsp;-&nbsp;erf(x)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[-.84375,0.25]</span><br>
<span class="lineno"></span><span class="comment" id="1538070">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.5&nbsp;+&nbsp;((0.5-x)-x*R)&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[0.25,0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="1538136">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;R&nbsp;=&nbsp;P/Q&nbsp;where&nbsp;P&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;8&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="1538200">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;10.</span><br>
<span class="lineno"></span><span class="comment" id="1538242">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-57.90</span><br>
<span class="lineno"></span><span class="comment" id="1538298">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;R&nbsp;-&nbsp;(erf(x)-x)/x&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="1538348">//</span><br>
<span class="lineno"></span><span class="comment" id="1538351">//</span><br>
<span class="lineno">50</span><span class="comment" id="1538354">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark.&nbsp;The&nbsp;formula&nbsp;is&nbsp;derived&nbsp;by&nbsp;noting</span><br>
<span class="lineno"></span><span class="comment" id="1538406">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;=&nbsp;(2/sqrt(pi))*(x&nbsp;-&nbsp;x**3/3&nbsp;+&nbsp;x**5/10&nbsp;-&nbsp;x**7/42&nbsp;+&nbsp;....)</span><br>
<span class="lineno"></span><span class="comment" id="1538480">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1538500">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2/sqrt(pi)&nbsp;=&nbsp;1.128379167095512573896158903121545171688</span><br>
<span class="lineno"></span><span class="comment" id="1538567">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;close&nbsp;to&nbsp;one.&nbsp;The&nbsp;interval&nbsp;is&nbsp;chosen&nbsp;because&nbsp;the&nbsp;fix</span><br>
<span class="lineno">55</span><span class="comment" id="1538634">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;point&nbsp;of&nbsp;erf(x)&nbsp;is&nbsp;near&nbsp;0.6174&nbsp;(i.e.,&nbsp;erf(x)=x&nbsp;when&nbsp;x&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1538702">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;near&nbsp;0.6174),&nbsp;and&nbsp;by&nbsp;some&nbsp;experiment,&nbsp;0.84375&nbsp;is&nbsp;chosen&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="1538772">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;guarantee&nbsp;the&nbsp;error&nbsp;is&nbsp;less&nbsp;than&nbsp;one&nbsp;ulp&nbsp;for&nbsp;erf.</span><br>
<span class="lineno"></span><span class="comment" id="1538833">//</span><br>
<span class="lineno"></span><span class="comment" id="1538836">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0.84375,1.25],&nbsp;let&nbsp;s&nbsp;=&nbsp;|x|&nbsp;-&nbsp;1,&nbsp;and</span><br>
<span class="lineno">60</span><span class="comment" id="1538895">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;0.84506291151&nbsp;rounded&nbsp;to&nbsp;single&nbsp;(24&nbsp;bits)</span><br>
<span class="lineno"></span><span class="comment" id="1538952">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*&nbsp;(c&nbsp;&nbsp;+&nbsp;P1(s)/Q1(s))</span><br>
<span class="lineno"></span><span class="comment" id="1539007">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1-c)&nbsp;&nbsp;-&nbsp;P1(s)/Q1(s)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1539063">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1+(c+P1(s)/Q1(s))&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1539119">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P1/Q1&nbsp;-&nbsp;(erf(|x|)-c)|&nbsp;&lt;=&nbsp;2**-59.06</span><br>
<span class="lineno">65</span><span class="comment" id="1539171">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark:&nbsp;here&nbsp;we&nbsp;use&nbsp;the&nbsp;taylor&nbsp;series&nbsp;expansion&nbsp;at&nbsp;x=1.</span><br>
<span class="lineno"></span><span class="comment" id="1539238">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;=&nbsp;erf(1)&nbsp;+&nbsp;s*Poly(s)</span><br>
<span class="lineno"></span><span class="comment" id="1539284">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.845..&nbsp;+&nbsp;P1(s)/Q1(s)</span><br>
<span class="lineno"></span><span class="comment" id="1539333">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;That&nbsp;is,&nbsp;we&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="1539398">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;-&nbsp;(c&nbsp;=&nbsp;(single)0.84506291151)</span><br>
<span class="lineno">70</span><span class="comment" id="1539461">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note&nbsp;that&nbsp;|P1/Q1|&lt;&nbsp;0.078&nbsp;for&nbsp;x&nbsp;in&nbsp;[0.84375,1.25]</span><br>
<span class="lineno"></span><span class="comment" id="1539521">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="1539538">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="1539581">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="1539624">//</span><br>
<span class="lineno">75</span><span class="comment" id="1539627">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1.25,1/0.35(~2.857143)],</span><br>
<span class="lineno"></span><span class="comment" id="1539673">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R1/S1)</span><br>
<span class="lineno"></span><span class="comment" id="1539728">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;1&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="1539766">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="1539783">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">80</span><span class="comment" id="1539838">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S1(z)&nbsp;=&nbsp;degree&nbsp;8&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="1539881">//</span><br>
<span class="lineno"></span><span class="comment" id="1539884">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1/0.35,28]</span><br>
<span class="lineno"></span><span class="comment" id="1539916">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1539980">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;-6&lt;x&lt;0</span><br>
<span class="lineno">85</span><span class="comment" id="1540051">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;tiny&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(if&nbsp;x&nbsp;&lt;=&nbsp;-6)</span><br>
<span class="lineno"></span><span class="comment" id="1540112">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;erfc(x))&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;6,&nbsp;else</span><br>
<span class="lineno"></span><span class="comment" id="1540177">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;tiny)</span><br>
<span class="lineno"></span><span class="comment" id="1540224">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="1540241">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2(z)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">90</span><span class="comment" id="1540296">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S2(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="1540339">//</span><br>
<span class="lineno"></span><span class="comment" id="1540342">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note1:</span><br>
<span class="lineno"></span><span class="comment" id="1540357">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To&nbsp;compute&nbsp;exp(-x*x-0.5625+R/S),&nbsp;let&nbsp;s&nbsp;be&nbsp;a&nbsp;single</span><br>
<span class="lineno"></span><span class="comment" id="1540419">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;precision&nbsp;number&nbsp;and&nbsp;s&nbsp;:=&nbsp;x;&nbsp;then</span><br>
<span class="lineno">95</span><span class="comment" id="1540464">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*x&nbsp;=&nbsp;-s*s&nbsp;+&nbsp;(s-x)*(s+x)</span><br>
<span class="lineno"></span><span class="comment" id="1540506">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x-0.5626+R/S)&nbsp;=</span><br>
<span class="lineno"></span><span class="comment" id="1540545">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-s*s-0.5625)*exp((s-x)*(s+x)+R/S);</span><br>
<span class="lineno"></span><span class="comment" id="1540608">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note2:</span><br>
<span class="lineno"></span><span class="comment" id="1540623">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;4&nbsp;and&nbsp;5&nbsp;make&nbsp;use&nbsp;of&nbsp;the&nbsp;asymptotic&nbsp;series</span><br>
<span class="lineno">100</span><span class="comment" id="1540681">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x)</span><br>
<span class="lineno"></span><span class="comment" id="1540717">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;~&nbsp;----------&nbsp;*&nbsp;(&nbsp;1&nbsp;+&nbsp;Poly(1/x**2)&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="1540777">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x*sqrt(pi)</span><br>
<span class="lineno"></span><span class="comment" id="1540814">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="1540870">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g(s)=f(1/x**2)&nbsp;=&nbsp;log(erfc(x)*x)&nbsp;-&nbsp;x*x&nbsp;+&nbsp;0.5625</span><br>
<span class="lineno">105</span><span class="comment" id="1540933">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;is&nbsp;the&nbsp;error&nbsp;bound&nbsp;for&nbsp;R1/S1&nbsp;and&nbsp;R2/S2</span><br>
<span class="lineno"></span><span class="comment" id="1540988">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R1/S1&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-62.57)</span><br>
<span class="lineno"></span><span class="comment" id="1541034">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R2/S2&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-61.52)</span><br>
<span class="lineno"></span><span class="comment" id="1541080">//</span><br>
<span class="lineno"></span><span class="comment" id="1541083">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.&nbsp;For&nbsp;inf&nbsp;&gt;&nbsp;x&nbsp;&gt;=&nbsp;28</span><br>
<span class="lineno">110</span><span class="comment" id="1541112">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*(1&nbsp;-&nbsp;tiny)&nbsp;&nbsp;(raise&nbsp;inexact)</span><br>
<span class="lineno"></span><span class="comment" id="1541175">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;tiny*tiny&nbsp;(raise&nbsp;underflow)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1541238">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2&nbsp;-&nbsp;tiny&nbsp;if&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="1541280">//</span><br>
<span class="lineno"></span><span class="comment" id="1541283">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.&nbsp;Special&nbsp;case:</span><br>
<span class="lineno">115</span><span class="comment" id="1541308">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(0)&nbsp;&nbsp;=&nbsp;0,&nbsp;erf(inf)&nbsp;&nbsp;=&nbsp;1,&nbsp;erf(-inf)&nbsp;=&nbsp;-1,</span><br>
<span class="lineno"></span><span class="comment" id="1541368">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(0)&nbsp;=&nbsp;1,&nbsp;erfc(inf)&nbsp;=&nbsp;0,&nbsp;erfc(-inf)&nbsp;=&nbsp;2,</span><br>
<span class="lineno"></span><span class="comment" id="1541428">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc/erf(NaN)&nbsp;is&nbsp;NaN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1541466">const</span>&nbsp;<span class="op" id="1541472">(</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1541475">erx</span>&nbsp;<span class="op" id="1541479">=</span>&nbsp;<span class="num" id="1541481">8.45062911510467529297e-01</span>&nbsp;<span class="comment" id="1541508">//&nbsp;0x3FEB0AC160000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1541531">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1541590">efx</span>&nbsp;&nbsp;<span class="op" id="1541595">=</span>&nbsp;<span class="num" id="1541597">1.28379167095512586316e-01</span>&nbsp;&nbsp;<span class="comment" id="1541625">//&nbsp;0x3FC06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1541648">efx8</span>&nbsp;<span class="op" id="1541653">=</span>&nbsp;<span class="num" id="1541655">1.02703333676410069053e+00</span>&nbsp;&nbsp;<span class="comment" id="1541683">//&nbsp;0x3FF06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1541706">pp0</span>&nbsp;&nbsp;<span class="op" id="1541711">=</span>&nbsp;<span class="num" id="1541713">1.28379167095512558561e-01</span>&nbsp;&nbsp;<span class="comment" id="1541741">//&nbsp;0x3FC06EBA8214DB68</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1541764">pp1</span>&nbsp;&nbsp;<span class="op" id="1541769">=</span>&nbsp;<span class="op" id="1541771">-</span><span class="num" id="1541772">3.25042107247001499370e-01</span>&nbsp;<span class="comment" id="1541799">//&nbsp;0xBFD4CD7D691CB913</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1541822">pp2</span>&nbsp;&nbsp;<span class="op" id="1541827">=</span>&nbsp;<span class="op" id="1541829">-</span><span class="num" id="1541830">2.84817495755985104766e-02</span>&nbsp;<span class="comment" id="1541857">//&nbsp;0xBF9D2A51DBD7194F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1541880">pp3</span>&nbsp;&nbsp;<span class="op" id="1541885">=</span>&nbsp;<span class="op" id="1541887">-</span><span class="num" id="1541888">5.77027029648944159157e-03</span>&nbsp;<span class="comment" id="1541915">//&nbsp;0xBF77A291236668E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1541938">pp4</span>&nbsp;&nbsp;<span class="op" id="1541943">=</span>&nbsp;<span class="op" id="1541945">-</span><span class="num" id="1541946">2.37630166566501626084e-05</span>&nbsp;<span class="comment" id="1541973">//&nbsp;0xBEF8EAD6120016AC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1541996">qq1</span>&nbsp;&nbsp;<span class="op" id="1542001">=</span>&nbsp;<span class="num" id="1542003">3.97917223959155352819e-01</span>&nbsp;&nbsp;<span class="comment" id="1542031">//&nbsp;0x3FD97779CDDADC09</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1542054">qq2</span>&nbsp;&nbsp;<span class="op" id="1542059">=</span>&nbsp;<span class="num" id="1542061">6.50222499887672944485e-02</span>&nbsp;&nbsp;<span class="comment" id="1542089">//&nbsp;0x3FB0A54C5536CEBA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1542112">qq3</span>&nbsp;&nbsp;<span class="op" id="1542117">=</span>&nbsp;<span class="num" id="1542119">5.08130628187576562776e-03</span>&nbsp;&nbsp;<span class="comment" id="1542147">//&nbsp;0x3F74D022C4D36B0F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1542170">qq4</span>&nbsp;&nbsp;<span class="op" id="1542175">=</span>&nbsp;<span class="num" id="1542177">1.32494738004321644526e-04</span>&nbsp;&nbsp;<span class="comment" id="1542205">//&nbsp;0x3F215DC9221C1A10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1542228">qq5</span>&nbsp;&nbsp;<span class="op" id="1542233">=</span>&nbsp;<span class="op" id="1542235">-</span><span class="num" id="1542236">3.96022827877536812320e-06</span>&nbsp;<span class="comment" id="1542263">//&nbsp;0xBED09C4342A26120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1542286">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;&nbsp;in&nbsp;[0.84375,&nbsp;1.25]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1542349">pa0</span>&nbsp;<span class="op" id="1542353">=</span>&nbsp;<span class="op" id="1542355">-</span><span class="num" id="1542356">2.36211856075265944077e-03</span>&nbsp;<span class="comment" id="1542383">//&nbsp;0xBF6359B8BEF77538</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1542406">pa1</span>&nbsp;<span class="op" id="1542410">=</span>&nbsp;<span class="num" id="1542412">4.14856118683748331666e-01</span>&nbsp;&nbsp;<span class="comment" id="1542440">//&nbsp;0x3FDA8D00AD92B34D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1542463">pa2</span>&nbsp;<span class="op" id="1542467">=</span>&nbsp;<span class="op" id="1542469">-</span><span class="num" id="1542470">3.72207876035701323847e-01</span>&nbsp;<span class="comment" id="1542497">//&nbsp;0xBFD7D240FBB8C3F1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1542520">pa3</span>&nbsp;<span class="op" id="1542524">=</span>&nbsp;<span class="num" id="1542526">3.18346619901161753674e-01</span>&nbsp;&nbsp;<span class="comment" id="1542554">//&nbsp;0x3FD45FCA805120E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1542577">pa4</span>&nbsp;<span class="op" id="1542581">=</span>&nbsp;<span class="op" id="1542583">-</span><span class="num" id="1542584">1.10894694282396677476e-01</span>&nbsp;<span class="comment" id="1542611">//&nbsp;0xBFBC63983D3E28EC</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1542634">pa5</span>&nbsp;<span class="op" id="1542638">=</span>&nbsp;<span class="num" id="1542640">3.54783043256182359371e-02</span>&nbsp;&nbsp;<span class="comment" id="1542668">//&nbsp;0x3FA22A36599795EB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1542691">pa6</span>&nbsp;<span class="op" id="1542695">=</span>&nbsp;<span class="op" id="1542697">-</span><span class="num" id="1542698">2.16637559486879084300e-03</span>&nbsp;<span class="comment" id="1542725">//&nbsp;0xBF61BF380A96073F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1542748">qa1</span>&nbsp;<span class="op" id="1542752">=</span>&nbsp;<span class="num" id="1542754">1.06420880400844228286e-01</span>&nbsp;&nbsp;<span class="comment" id="1542782">//&nbsp;0x3FBB3E6618EEE323</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1542805">qa2</span>&nbsp;<span class="op" id="1542809">=</span>&nbsp;<span class="num" id="1542811">5.40397917702171048937e-01</span>&nbsp;&nbsp;<span class="comment" id="1542839">//&nbsp;0x3FE14AF092EB6F33</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1542862">qa3</span>&nbsp;<span class="op" id="1542866">=</span>&nbsp;<span class="num" id="1542868">7.18286544141962662868e-02</span>&nbsp;&nbsp;<span class="comment" id="1542896">//&nbsp;0x3FB2635CD99FE9A7</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1542919">qa4</span>&nbsp;<span class="op" id="1542923">=</span>&nbsp;<span class="num" id="1542925">1.26171219808761642112e-01</span>&nbsp;&nbsp;<span class="comment" id="1542953">//&nbsp;0x3FC02660E763351F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1542976">qa5</span>&nbsp;<span class="op" id="1542980">=</span>&nbsp;<span class="num" id="1542982">1.36370839120290507362e-02</span>&nbsp;&nbsp;<span class="comment" id="1543010">//&nbsp;0x3F8BEDC26B51DD1C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1543033">qa6</span>&nbsp;<span class="op" id="1543037">=</span>&nbsp;<span class="num" id="1543039">1.19844998467991074170e-02</span>&nbsp;&nbsp;<span class="comment" id="1543067">//&nbsp;0x3F888B545735151D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1543090">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1.25,&nbsp;1/0.35]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1543152">ra0</span>&nbsp;<span class="op" id="1543156">=</span>&nbsp;<span class="op" id="1543158">-</span><span class="num" id="1543159">9.86494403484714822705e-03</span>&nbsp;<span class="comment" id="1543186">//&nbsp;0xBF843412600D6435</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1543209">ra1</span>&nbsp;<span class="op" id="1543213">=</span>&nbsp;<span class="op" id="1543215">-</span><span class="num" id="1543216">6.93858572707181764372e-01</span>&nbsp;<span class="comment" id="1543243">//&nbsp;0xBFE63416E4BA7360</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1543266">ra2</span>&nbsp;<span class="op" id="1543270">=</span>&nbsp;<span class="op" id="1543272">-</span><span class="num" id="1543273">1.05586262253232909814e+01</span>&nbsp;<span class="comment" id="1543300">//&nbsp;0xC0251E0441B0E726</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1543323">ra3</span>&nbsp;<span class="op" id="1543327">=</span>&nbsp;<span class="op" id="1543329">-</span><span class="num" id="1543330">6.23753324503260060396e+01</span>&nbsp;<span class="comment" id="1543357">//&nbsp;0xC04F300AE4CBA38D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1543380">ra4</span>&nbsp;<span class="op" id="1543384">=</span>&nbsp;<span class="op" id="1543386">-</span><span class="num" id="1543387">1.62396669462573470355e+02</span>&nbsp;<span class="comment" id="1543414">//&nbsp;0xC0644CB184282266</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1543437">ra5</span>&nbsp;<span class="op" id="1543441">=</span>&nbsp;<span class="op" id="1543443">-</span><span class="num" id="1543444">1.84605092906711035994e+02</span>&nbsp;<span class="comment" id="1543471">//&nbsp;0xC067135CEBCCABB2</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1543494">ra6</span>&nbsp;<span class="op" id="1543498">=</span>&nbsp;<span class="op" id="1543500">-</span><span class="num" id="1543501">8.12874355063065934246e+01</span>&nbsp;<span class="comment" id="1543528">//&nbsp;0xC054526557E4D2F2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1543551">ra7</span>&nbsp;<span class="op" id="1543555">=</span>&nbsp;<span class="op" id="1543557">-</span><span class="num" id="1543558">9.81432934416914548592e+00</span>&nbsp;<span class="comment" id="1543585">//&nbsp;0xC023A0EFC69AC25C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1543608">sa1</span>&nbsp;<span class="op" id="1543612">=</span>&nbsp;<span class="num" id="1543614">1.96512716674392571292e+01</span>&nbsp;&nbsp;<span class="comment" id="1543642">//&nbsp;0x4033A6B9BD707687</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1543665">sa2</span>&nbsp;<span class="op" id="1543669">=</span>&nbsp;<span class="num" id="1543671">1.37657754143519042600e+02</span>&nbsp;&nbsp;<span class="comment" id="1543699">//&nbsp;0x4061350C526AE721</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1543722">sa3</span>&nbsp;<span class="op" id="1543726">=</span>&nbsp;<span class="num" id="1543728">4.34565877475229228821e+02</span>&nbsp;&nbsp;<span class="comment" id="1543756">//&nbsp;0x407B290DD58A1A71</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1543779">sa4</span>&nbsp;<span class="op" id="1543783">=</span>&nbsp;<span class="num" id="1543785">6.45387271733267880336e+02</span>&nbsp;&nbsp;<span class="comment" id="1543813">//&nbsp;0x40842B1921EC2868</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1543836">sa5</span>&nbsp;<span class="op" id="1543840">=</span>&nbsp;<span class="num" id="1543842">4.29008140027567833386e+02</span>&nbsp;&nbsp;<span class="comment" id="1543870">//&nbsp;0x407AD02157700314</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1543893">sa6</span>&nbsp;<span class="op" id="1543897">=</span>&nbsp;<span class="num" id="1543899">1.08635005541779435134e+02</span>&nbsp;&nbsp;<span class="comment" id="1543927">//&nbsp;0x405B28A3EE48AE2C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1543950">sa7</span>&nbsp;<span class="op" id="1543954">=</span>&nbsp;<span class="num" id="1543956">6.57024977031928170135e+00</span>&nbsp;&nbsp;<span class="comment" id="1543984">//&nbsp;0x401A47EF8E484A93</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1544007">sa8</span>&nbsp;<span class="op" id="1544011">=</span>&nbsp;<span class="op" id="1544013">-</span><span class="num" id="1544014">6.04244152148580987438e-02</span>&nbsp;<span class="comment" id="1544041">//&nbsp;0xBFAEEFF2EE749A62</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1544064">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1/.35,&nbsp;28]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1544123">rb0</span>&nbsp;<span class="op" id="1544127">=</span>&nbsp;<span class="op" id="1544129">-</span><span class="num" id="1544130">9.86494292470009928597e-03</span>&nbsp;<span class="comment" id="1544157">//&nbsp;0xBF84341239E86F4A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1544180">rb1</span>&nbsp;<span class="op" id="1544184">=</span>&nbsp;<span class="op" id="1544186">-</span><span class="num" id="1544187">7.99283237680523006574e-01</span>&nbsp;<span class="comment" id="1544214">//&nbsp;0xBFE993BA70C285DE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1544237">rb2</span>&nbsp;<span class="op" id="1544241">=</span>&nbsp;<span class="op" id="1544243">-</span><span class="num" id="1544244">1.77579549177547519889e+01</span>&nbsp;<span class="comment" id="1544271">//&nbsp;0xC031C209555F995A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1544294">rb3</span>&nbsp;<span class="op" id="1544298">=</span>&nbsp;<span class="op" id="1544300">-</span><span class="num" id="1544301">1.60636384855821916062e+02</span>&nbsp;<span class="comment" id="1544328">//&nbsp;0xC064145D43C5ED98</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1544351">rb4</span>&nbsp;<span class="op" id="1544355">=</span>&nbsp;<span class="op" id="1544357">-</span><span class="num" id="1544358">6.37566443368389627722e+02</span>&nbsp;<span class="comment" id="1544385">//&nbsp;0xC083EC881375F228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1544408">rb5</span>&nbsp;<span class="op" id="1544412">=</span>&nbsp;<span class="op" id="1544414">-</span><span class="num" id="1544415">1.02509513161107724954e+03</span>&nbsp;<span class="comment" id="1544442">//&nbsp;0xC09004616A2E5992</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1544465">rb6</span>&nbsp;<span class="op" id="1544469">=</span>&nbsp;<span class="op" id="1544471">-</span><span class="num" id="1544472">4.83519191608651397019e+02</span>&nbsp;<span class="comment" id="1544499">//&nbsp;0xC07E384E9BDC383F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1544522">sb1</span>&nbsp;<span class="op" id="1544526">=</span>&nbsp;<span class="num" id="1544528">3.03380607434824582924e+01</span>&nbsp;&nbsp;<span class="comment" id="1544556">//&nbsp;0x403E568B261D5190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1544579">sb2</span>&nbsp;<span class="op" id="1544583">=</span>&nbsp;<span class="num" id="1544585">3.25792512996573918826e+02</span>&nbsp;&nbsp;<span class="comment" id="1544613">//&nbsp;0x40745CAE221B9F0A</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1544636">sb3</span>&nbsp;<span class="op" id="1544640">=</span>&nbsp;<span class="num" id="1544642">1.53672958608443695994e+03</span>&nbsp;&nbsp;<span class="comment" id="1544670">//&nbsp;0x409802EB189D5118</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1544693">sb4</span>&nbsp;<span class="op" id="1544697">=</span>&nbsp;<span class="num" id="1544699">3.19985821950859553908e+03</span>&nbsp;&nbsp;<span class="comment" id="1544727">//&nbsp;0x40A8FFB7688C246A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1544750">sb5</span>&nbsp;<span class="op" id="1544754">=</span>&nbsp;<span class="num" id="1544756">2.55305040643316442583e+03</span>&nbsp;&nbsp;<span class="comment" id="1544784">//&nbsp;0x40A3F219CEDF3BE6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1544807">sb6</span>&nbsp;<span class="op" id="1544811">=</span>&nbsp;<span class="num" id="1544813">4.74528541206955367215e+02</span>&nbsp;&nbsp;<span class="comment" id="1544841">//&nbsp;0x407DA874E79FE763</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1544864">sb7</span>&nbsp;<span class="op" id="1544868">=</span>&nbsp;<span class="op" id="1544870">-</span><span class="num" id="1544871">2.24409524465858183362e+01</span>&nbsp;<span class="comment" id="1544898">//&nbsp;0xC03670E242712D62</span><br>
<span class="lineno">180</span><span class="op" id="1544920">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1544923">//&nbsp;Erf&nbsp;returns&nbsp;the&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1544963">//</span><br>
<span class="lineno"></span><span class="comment" id="1544966">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">185</span><span class="comment" id="1544988">//&nbsp;&nbsp;&nbsp;&nbspErf(+Inf)&nbsp;=&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="1545005">//&nbsp;&nbsp;&nbsp;&nbspErf(-Inf)&nbsp;=&nbsp;-1</span><br>
<span class="lineno"></span><span class="comment" id="1545023">//&nbsp;&nbsp;&nbsp;&nbspErf(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="1545041">func</span>&nbsp;<span class="ident" id="1545046">Erf</span><span class="op" id="1545049">(</span><span class="ident" id="1545050">x</span>&nbsp;<span class="builtintype" id="1545052">float64</span><span class="op" id="1545059">)</span>&nbsp;<span class="builtintype" id="1545061">float64</span>&nbsp;<span class="op" id="1545069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1545072">const</span>&nbsp;<span class="op" id="1545078">(</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1545082">VeryTiny</span>&nbsp;<span class="op" id="1545091">=</span>&nbsp;<span class="num" id="1545093">2.848094538889218e-306</span>&nbsp;<span class="comment" id="1545116">//&nbsp;0x0080000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1545140">Small</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1545149">=</span>&nbsp;<span class="num" id="1545151">1.0</span>&nbsp;<span class="op" id="1545155">/</span>&nbsp;<span class="op" id="1545157">(</span><span class="num" id="1545158">1</span>&nbsp;<span class="op" id="1545160">&lt;&lt;</span>&nbsp;<span class="num" id="1545163">28</span><span class="op" id="1545165">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1545174">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1545185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1545188">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1545206">switch</span>&nbsp;<span class="op" id="1545213">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1545216">case</span>&nbsp;<span class="ident" id="1545221">IsNaN</span><span class="op" id="1545226">(</span><span class="ident" id="1545227">x</span><span class="op" id="1545228">)</span><span class="op" id="1545229">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1545233">return</span>&nbsp;<span class="ident" id="1545240">NaN</span><span class="op" id="1545243">(</span><span class="op" id="1545244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1545247">case</span>&nbsp;<span class="ident" id="1545252">IsInf</span><span class="op" id="1545257">(</span><span class="ident" id="1545258">x</span><span class="op" id="1545259">,</span>&nbsp;<span class="num" id="1545261">1</span><span class="op" id="1545262">)</span><span class="op" id="1545263">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1545267">return</span>&nbsp;<span class="num" id="1545274">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1545277">case</span>&nbsp;<span class="ident" id="1545282">IsInf</span><span class="op" id="1545287">(</span><span class="ident" id="1545288">x</span><span class="op" id="1545289">,</span>&nbsp;<span class="op" id="1545291">-</span><span class="num" id="1545292">1</span><span class="op" id="1545293">)</span><span class="op" id="1545294">:</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1545298">return</span>&nbsp;<span class="op" id="1545305">-</span><span class="num" id="1545306">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1545309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1545312">sign</span>&nbsp;<span class="op" id="1545317">:=</span>&nbsp;<span class="builtintype" id="1545320">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1545327">if</span>&nbsp;<span class="ident" id="1545330">x</span>&nbsp;<span class="op" id="1545332">&lt;</span>&nbsp;<span class="num" id="1545334">0</span>&nbsp;<span class="op" id="1545336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1545340">x</span>&nbsp;<span class="op" id="1545342">=</span>&nbsp;<span class="op" id="1545344">-</span><span class="ident" id="1545345">x</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1545349">sign</span>&nbsp;<span class="op" id="1545354">=</span>&nbsp;<span class="builtintype" id="1545356">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1545362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1545365">if</span>&nbsp;<span class="ident" id="1545368">x</span>&nbsp;<span class="op" id="1545370">&lt;</span>&nbsp;<span class="num" id="1545372">0.84375</span>&nbsp;<span class="op" id="1545380">{</span>&nbsp;<span class="comment" id="1545382">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1545401">var</span>&nbsp;<span class="ident" id="1545405">temp</span>&nbsp;<span class="builtintype" id="1545410">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1545420">if</span>&nbsp;<span class="ident" id="1545423">x</span>&nbsp;<span class="op" id="1545425">&lt;</span>&nbsp;<span class="ident" id="1545427">Small</span>&nbsp;<span class="op" id="1545433">{</span>&nbsp;<span class="comment" id="1545435">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-28</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1545454">if</span>&nbsp;<span class="ident" id="1545457">x</span>&nbsp;<span class="op" id="1545459">&lt;</span>&nbsp;<span class="ident" id="1545461">VeryTiny</span>&nbsp;<span class="op" id="1545470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1545476">temp</span>&nbsp;<span class="op" id="1545481">=</span>&nbsp;<span class="num" id="1545483">0.125</span>&nbsp;<span class="op" id="1545489">*</span>&nbsp;<span class="op" id="1545491">(</span><span class="num" id="1545492">8.0</span><span class="op" id="1545495">*</span><span class="ident" id="1545496">x</span>&nbsp;<span class="op" id="1545498">+</span>&nbsp;<span class="ident" id="1545500">efx8</span><span class="op" id="1545504">*</span><span class="ident" id="1545505">x</span><span class="op" id="1545506">)</span>&nbsp;<span class="comment" id="1545508">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1545530">}</span>&nbsp;<span class="keyword" id="1545532">else</span>&nbsp;<span class="op" id="1545537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1545543">temp</span>&nbsp;<span class="op" id="1545548">=</span>&nbsp;<span class="ident" id="1545550">x</span>&nbsp;<span class="op" id="1545552">+</span>&nbsp;<span class="ident" id="1545554">efx</span><span class="op" id="1545557">*</span><span class="ident" id="1545558">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1545563">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1545567">}</span>&nbsp;<span class="keyword" id="1545569">else</span>&nbsp;<span class="op" id="1545574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1545579">z</span>&nbsp;<span class="op" id="1545581">:=</span>&nbsp;<span class="ident" id="1545584">x</span>&nbsp;<span class="op" id="1545586">*</span>&nbsp;<span class="ident" id="1545588">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1545593">r</span>&nbsp;<span class="op" id="1545595">:=</span>&nbsp;<span class="ident" id="1545598">pp0</span>&nbsp;<span class="op" id="1545602">+</span>&nbsp;<span class="ident" id="1545604">z</span><span class="op" id="1545605">*</span><span class="op" id="1545606">(</span><span class="ident" id="1545607">pp1</span><span class="op" id="1545610">+</span><span class="ident" id="1545611">z</span><span class="op" id="1545612">*</span><span class="op" id="1545613">(</span><span class="ident" id="1545614">pp2</span><span class="op" id="1545617">+</span><span class="ident" id="1545618">z</span><span class="op" id="1545619">*</span><span class="op" id="1545620">(</span><span class="ident" id="1545621">pp3</span><span class="op" id="1545624">+</span><span class="ident" id="1545625">z</span><span class="op" id="1545626">*</span><span class="ident" id="1545627">pp4</span><span class="op" id="1545630">)</span><span class="op" id="1545631">)</span><span class="op" id="1545632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1545637">s</span>&nbsp;<span class="op" id="1545639">:=</span>&nbsp;<span class="num" id="1545642">1</span>&nbsp;<span class="op" id="1545644">+</span>&nbsp;<span class="ident" id="1545646">z</span><span class="op" id="1545647">*</span><span class="op" id="1545648">(</span><span class="ident" id="1545649">qq1</span><span class="op" id="1545652">+</span><span class="ident" id="1545653">z</span><span class="op" id="1545654">*</span><span class="op" id="1545655">(</span><span class="ident" id="1545656">qq2</span><span class="op" id="1545659">+</span><span class="ident" id="1545660">z</span><span class="op" id="1545661">*</span><span class="op" id="1545662">(</span><span class="ident" id="1545663">qq3</span><span class="op" id="1545666">+</span><span class="ident" id="1545667">z</span><span class="op" id="1545668">*</span><span class="op" id="1545669">(</span><span class="ident" id="1545670">qq4</span><span class="op" id="1545673">+</span><span class="ident" id="1545674">z</span><span class="op" id="1545675">*</span><span class="ident" id="1545676">qq5</span><span class="op" id="1545679">)</span><span class="op" id="1545680">)</span><span class="op" id="1545681">)</span><span class="op" id="1545682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1545687">y</span>&nbsp;<span class="op" id="1545689">:=</span>&nbsp;<span class="ident" id="1545692">r</span>&nbsp;<span class="op" id="1545694">/</span>&nbsp;<span class="ident" id="1545696">s</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1545701">temp</span>&nbsp;<span class="op" id="1545706">=</span>&nbsp;<span class="ident" id="1545708">x</span>&nbsp;<span class="op" id="1545710">+</span>&nbsp;<span class="ident" id="1545712">x</span><span class="op" id="1545713">*</span><span class="ident" id="1545714">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1545718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1545722">if</span>&nbsp;<span class="ident" id="1545725">sign</span>&nbsp;<span class="op" id="1545730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1545735">return</span>&nbsp;<span class="op" id="1545742">-</span><span class="ident" id="1545743">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1545750">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1545754">return</span>&nbsp;<span class="ident" id="1545761">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1545767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1545770">if</span>&nbsp;<span class="ident" id="1545773">x</span>&nbsp;<span class="op" id="1545775">&lt;</span>&nbsp;<span class="num" id="1545777">1.25</span>&nbsp;<span class="op" id="1545782">{</span>&nbsp;<span class="comment" id="1545784">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1545811">s</span>&nbsp;<span class="op" id="1545813">:=</span>&nbsp;<span class="ident" id="1545816">x</span>&nbsp;<span class="op" id="1545818">-</span>&nbsp;<span class="num" id="1545820">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1545824">P</span>&nbsp;<span class="op" id="1545826">:=</span>&nbsp;<span class="ident" id="1545829">pa0</span>&nbsp;<span class="op" id="1545833">+</span>&nbsp;<span class="ident" id="1545835">s</span><span class="op" id="1545836">*</span><span class="op" id="1545837">(</span><span class="ident" id="1545838">pa1</span><span class="op" id="1545841">+</span><span class="ident" id="1545842">s</span><span class="op" id="1545843">*</span><span class="op" id="1545844">(</span><span class="ident" id="1545845">pa2</span><span class="op" id="1545848">+</span><span class="ident" id="1545849">s</span><span class="op" id="1545850">*</span><span class="op" id="1545851">(</span><span class="ident" id="1545852">pa3</span><span class="op" id="1545855">+</span><span class="ident" id="1545856">s</span><span class="op" id="1545857">*</span><span class="op" id="1545858">(</span><span class="ident" id="1545859">pa4</span><span class="op" id="1545862">+</span><span class="ident" id="1545863">s</span><span class="op" id="1545864">*</span><span class="op" id="1545865">(</span><span class="ident" id="1545866">pa5</span><span class="op" id="1545869">+</span><span class="ident" id="1545870">s</span><span class="op" id="1545871">*</span><span class="ident" id="1545872">pa6</span><span class="op" id="1545875">)</span><span class="op" id="1545876">)</span><span class="op" id="1545877">)</span><span class="op" id="1545878">)</span><span class="op" id="1545879">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1545883">Q</span>&nbsp;<span class="op" id="1545885">:=</span>&nbsp;<span class="num" id="1545888">1</span>&nbsp;<span class="op" id="1545890">+</span>&nbsp;<span class="ident" id="1545892">s</span><span class="op" id="1545893">*</span><span class="op" id="1545894">(</span><span class="ident" id="1545895">qa1</span><span class="op" id="1545898">+</span><span class="ident" id="1545899">s</span><span class="op" id="1545900">*</span><span class="op" id="1545901">(</span><span class="ident" id="1545902">qa2</span><span class="op" id="1545905">+</span><span class="ident" id="1545906">s</span><span class="op" id="1545907">*</span><span class="op" id="1545908">(</span><span class="ident" id="1545909">qa3</span><span class="op" id="1545912">+</span><span class="ident" id="1545913">s</span><span class="op" id="1545914">*</span><span class="op" id="1545915">(</span><span class="ident" id="1545916">qa4</span><span class="op" id="1545919">+</span><span class="ident" id="1545920">s</span><span class="op" id="1545921">*</span><span class="op" id="1545922">(</span><span class="ident" id="1545923">qa5</span><span class="op" id="1545926">+</span><span class="ident" id="1545927">s</span><span class="op" id="1545928">*</span><span class="ident" id="1545929">qa6</span><span class="op" id="1545932">)</span><span class="op" id="1545933">)</span><span class="op" id="1545934">)</span><span class="op" id="1545935">)</span><span class="op" id="1545936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1545940">if</span>&nbsp;<span class="ident" id="1545943">sign</span>&nbsp;<span class="op" id="1545948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1545953">return</span>&nbsp;<span class="op" id="1545960">-</span><span class="ident" id="1545961">erx</span>&nbsp;<span class="op" id="1545965">-</span>&nbsp;<span class="ident" id="1545967">P</span><span class="op" id="1545968">/</span><span class="ident" id="1545969">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1545973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1545977">return</span>&nbsp;<span class="ident" id="1545984">erx</span>&nbsp;<span class="op" id="1545988">+</span>&nbsp;<span class="ident" id="1545990">P</span><span class="op" id="1545991">/</span><span class="ident" id="1545992">Q</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1545995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1545998">if</span>&nbsp;<span class="ident" id="1546001">x</span>&nbsp;<span class="op" id="1546003">&gt;=</span>&nbsp;<span class="num" id="1546006">6</span>&nbsp;<span class="op" id="1546008">{</span>&nbsp;<span class="comment" id="1546010">//&nbsp;inf&nbsp;&gt;&nbsp;|x|&nbsp;&gt;=&nbsp;6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1546030">if</span>&nbsp;<span class="ident" id="1546033">sign</span>&nbsp;<span class="op" id="1546038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1546043">return</span>&nbsp;<span class="op" id="1546050">-</span><span class="num" id="1546051">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1546055">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1546059">return</span>&nbsp;<span class="num" id="1546066">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1546069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1546072">s</span>&nbsp;<span class="op" id="1546074">:=</span>&nbsp;<span class="num" id="1546077">1</span>&nbsp;<span class="op" id="1546079">/</span>&nbsp;<span class="op" id="1546081">(</span><span class="ident" id="1546082">x</span>&nbsp;<span class="op" id="1546084">*</span>&nbsp;<span class="ident" id="1546086">x</span><span class="op" id="1546087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1546090">var</span>&nbsp;<span class="ident" id="1546094">R</span><span class="op" id="1546095">,</span>&nbsp;<span class="ident" id="1546097">S</span>&nbsp;<span class="builtintype" id="1546099">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1546108">if</span>&nbsp;<span class="ident" id="1546111">x</span>&nbsp;<span class="op" id="1546113">&lt;</span>&nbsp;<span class="num" id="1546115">1</span><span class="op" id="1546116">/</span><span class="num" id="1546117">0.35</span>&nbsp;<span class="op" id="1546122">{</span>&nbsp;<span class="comment" id="1546124">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1546156">R</span>&nbsp;<span class="op" id="1546158">=</span>&nbsp;<span class="ident" id="1546160">ra0</span>&nbsp;<span class="op" id="1546164">+</span>&nbsp;<span class="ident" id="1546166">s</span><span class="op" id="1546167">*</span><span class="op" id="1546168">(</span><span class="ident" id="1546169">ra1</span><span class="op" id="1546172">+</span><span class="ident" id="1546173">s</span><span class="op" id="1546174">*</span><span class="op" id="1546175">(</span><span class="ident" id="1546176">ra2</span><span class="op" id="1546179">+</span><span class="ident" id="1546180">s</span><span class="op" id="1546181">*</span><span class="op" id="1546182">(</span><span class="ident" id="1546183">ra3</span><span class="op" id="1546186">+</span><span class="ident" id="1546187">s</span><span class="op" id="1546188">*</span><span class="op" id="1546189">(</span><span class="ident" id="1546190">ra4</span><span class="op" id="1546193">+</span><span class="ident" id="1546194">s</span><span class="op" id="1546195">*</span><span class="op" id="1546196">(</span><span class="ident" id="1546197">ra5</span><span class="op" id="1546200">+</span><span class="ident" id="1546201">s</span><span class="op" id="1546202">*</span><span class="op" id="1546203">(</span><span class="ident" id="1546204">ra6</span><span class="op" id="1546207">+</span><span class="ident" id="1546208">s</span><span class="op" id="1546209">*</span><span class="ident" id="1546210">ra7</span><span class="op" id="1546213">)</span><span class="op" id="1546214">)</span><span class="op" id="1546215">)</span><span class="op" id="1546216">)</span><span class="op" id="1546217">)</span><span class="op" id="1546218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1546222">S</span>&nbsp;<span class="op" id="1546224">=</span>&nbsp;<span class="num" id="1546226">1</span>&nbsp;<span class="op" id="1546228">+</span>&nbsp;<span class="ident" id="1546230">s</span><span class="op" id="1546231">*</span><span class="op" id="1546232">(</span><span class="ident" id="1546233">sa1</span><span class="op" id="1546236">+</span><span class="ident" id="1546237">s</span><span class="op" id="1546238">*</span><span class="op" id="1546239">(</span><span class="ident" id="1546240">sa2</span><span class="op" id="1546243">+</span><span class="ident" id="1546244">s</span><span class="op" id="1546245">*</span><span class="op" id="1546246">(</span><span class="ident" id="1546247">sa3</span><span class="op" id="1546250">+</span><span class="ident" id="1546251">s</span><span class="op" id="1546252">*</span><span class="op" id="1546253">(</span><span class="ident" id="1546254">sa4</span><span class="op" id="1546257">+</span><span class="ident" id="1546258">s</span><span class="op" id="1546259">*</span><span class="op" id="1546260">(</span><span class="ident" id="1546261">sa5</span><span class="op" id="1546264">+</span><span class="ident" id="1546265">s</span><span class="op" id="1546266">*</span><span class="op" id="1546267">(</span><span class="ident" id="1546268">sa6</span><span class="op" id="1546271">+</span><span class="ident" id="1546272">s</span><span class="op" id="1546273">*</span><span class="op" id="1546274">(</span><span class="ident" id="1546275">sa7</span><span class="op" id="1546278">+</span><span class="ident" id="1546279">s</span><span class="op" id="1546280">*</span><span class="ident" id="1546281">sa8</span><span class="op" id="1546284">)</span><span class="op" id="1546285">)</span><span class="op" id="1546286">)</span><span class="op" id="1546287">)</span><span class="op" id="1546288">)</span><span class="op" id="1546289">)</span><span class="op" id="1546290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1546293">}</span>&nbsp;<span class="keyword" id="1546295">else</span>&nbsp;<span class="op" id="1546300">{</span>&nbsp;<span class="comment" id="1546302">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1546335">R</span>&nbsp;<span class="op" id="1546337">=</span>&nbsp;<span class="ident" id="1546339">rb0</span>&nbsp;<span class="op" id="1546343">+</span>&nbsp;<span class="ident" id="1546345">s</span><span class="op" id="1546346">*</span><span class="op" id="1546347">(</span><span class="ident" id="1546348">rb1</span><span class="op" id="1546351">+</span><span class="ident" id="1546352">s</span><span class="op" id="1546353">*</span><span class="op" id="1546354">(</span><span class="ident" id="1546355">rb2</span><span class="op" id="1546358">+</span><span class="ident" id="1546359">s</span><span class="op" id="1546360">*</span><span class="op" id="1546361">(</span><span class="ident" id="1546362">rb3</span><span class="op" id="1546365">+</span><span class="ident" id="1546366">s</span><span class="op" id="1546367">*</span><span class="op" id="1546368">(</span><span class="ident" id="1546369">rb4</span><span class="op" id="1546372">+</span><span class="ident" id="1546373">s</span><span class="op" id="1546374">*</span><span class="op" id="1546375">(</span><span class="ident" id="1546376">rb5</span><span class="op" id="1546379">+</span><span class="ident" id="1546380">s</span><span class="op" id="1546381">*</span><span class="ident" id="1546382">rb6</span><span class="op" id="1546385">)</span><span class="op" id="1546386">)</span><span class="op" id="1546387">)</span><span class="op" id="1546388">)</span><span class="op" id="1546389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1546393">S</span>&nbsp;<span class="op" id="1546395">=</span>&nbsp;<span class="num" id="1546397">1</span>&nbsp;<span class="op" id="1546399">+</span>&nbsp;<span class="ident" id="1546401">s</span><span class="op" id="1546402">*</span><span class="op" id="1546403">(</span><span class="ident" id="1546404">sb1</span><span class="op" id="1546407">+</span><span class="ident" id="1546408">s</span><span class="op" id="1546409">*</span><span class="op" id="1546410">(</span><span class="ident" id="1546411">sb2</span><span class="op" id="1546414">+</span><span class="ident" id="1546415">s</span><span class="op" id="1546416">*</span><span class="op" id="1546417">(</span><span class="ident" id="1546418">sb3</span><span class="op" id="1546421">+</span><span class="ident" id="1546422">s</span><span class="op" id="1546423">*</span><span class="op" id="1546424">(</span><span class="ident" id="1546425">sb4</span><span class="op" id="1546428">+</span><span class="ident" id="1546429">s</span><span class="op" id="1546430">*</span><span class="op" id="1546431">(</span><span class="ident" id="1546432">sb5</span><span class="op" id="1546435">+</span><span class="ident" id="1546436">s</span><span class="op" id="1546437">*</span><span class="op" id="1546438">(</span><span class="ident" id="1546439">sb6</span><span class="op" id="1546442">+</span><span class="ident" id="1546443">s</span><span class="op" id="1546444">*</span><span class="ident" id="1546445">sb7</span><span class="op" id="1546448">)</span><span class="op" id="1546449">)</span><span class="op" id="1546450">)</span><span class="op" id="1546451">)</span><span class="op" id="1546452">)</span><span class="op" id="1546453">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1546456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1546459">z</span>&nbsp;<span class="op" id="1546461">:=</span>&nbsp;<span class="ident" id="1546464">Float64frombits</span><span class="op" id="1546479">(</span><span class="ident" id="1546480">Float64bits</span><span class="op" id="1546491">(</span><span class="ident" id="1546492">x</span><span class="op" id="1546493">)</span>&nbsp;<span class="op" id="1546495">&amp;</span>&nbsp;<span class="num" id="1546497">0xffffffff00000000</span><span class="op" id="1546515">)</span>&nbsp;<span class="comment" id="1546517">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1546556">r</span>&nbsp;<span class="op" id="1546558">:=</span>&nbsp;<span class="ident" id="1546561">Exp</span><span class="op" id="1546564">(</span><span class="op" id="1546565">-</span><span class="ident" id="1546566">z</span><span class="op" id="1546567">*</span><span class="ident" id="1546568">z</span><span class="op" id="1546569">-</span><span class="num" id="1546570">0.5625</span><span class="op" id="1546576">)</span>&nbsp;<span class="op" id="1546578">*</span>&nbsp;<span class="ident" id="1546580">Exp</span><span class="op" id="1546583">(</span><span class="op" id="1546584">(</span><span class="ident" id="1546585">z</span><span class="op" id="1546586">-</span><span class="ident" id="1546587">x</span><span class="op" id="1546588">)</span><span class="op" id="1546589">*</span><span class="op" id="1546590">(</span><span class="ident" id="1546591">z</span><span class="op" id="1546592">+</span><span class="ident" id="1546593">x</span><span class="op" id="1546594">)</span><span class="op" id="1546595">+</span><span class="ident" id="1546596">R</span><span class="op" id="1546597">/</span><span class="ident" id="1546598">S</span><span class="op" id="1546599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1546602">if</span>&nbsp;<span class="ident" id="1546605">sign</span>&nbsp;<span class="op" id="1546610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1546614">return</span>&nbsp;<span class="ident" id="1546621">r</span><span class="op" id="1546622">/</span><span class="ident" id="1546623">x</span>&nbsp;<span class="op" id="1546625">-</span>&nbsp;<span class="num" id="1546627">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1546630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1546633">return</span>&nbsp;<span class="num" id="1546640">1</span>&nbsp;<span class="op" id="1546642">-</span>&nbsp;<span class="ident" id="1546644">r</span><span class="op" id="1546645">/</span><span class="ident" id="1546646">x</span><br>
<span class="lineno"></span><span class="op" id="1546648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1546651">//&nbsp;Erfc&nbsp;returns&nbsp;the&nbsp;complementary&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno">260</span><span class="comment" id="1546706">//</span><br>
<span class="lineno"></span><span class="comment" id="1546709">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="1546731">//&nbsp;&nbsp;&nbsp;&nbspErfc(+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1546749">//&nbsp;&nbsp;&nbsp;&nbspErfc(-Inf)&nbsp;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="1546767">//&nbsp;&nbsp;&nbsp;&nbspErfc(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">265</span><span class="keyword" id="1546786">func</span>&nbsp;<span class="ident" id="1546791">Erfc</span><span class="op" id="1546795">(</span><span class="ident" id="1546796">x</span>&nbsp;<span class="builtintype" id="1546798">float64</span><span class="op" id="1546805">)</span>&nbsp;<span class="builtintype" id="1546807">float64</span>&nbsp;<span class="op" id="1546815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1546818">const</span>&nbsp;<span class="ident" id="1546824">Tiny</span>&nbsp;<span class="op" id="1546829">=</span>&nbsp;<span class="num" id="1546831">1.0</span>&nbsp;<span class="op" id="1546835">/</span>&nbsp;<span class="op" id="1546837">(</span><span class="num" id="1546838">1</span>&nbsp;<span class="op" id="1546840">&lt;&lt;</span>&nbsp;<span class="num" id="1546843">56</span><span class="op" id="1546845">)</span>&nbsp;<span class="comment" id="1546847">//&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1546858">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1546876">switch</span>&nbsp;<span class="op" id="1546883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1546886">case</span>&nbsp;<span class="ident" id="1546891">IsNaN</span><span class="op" id="1546896">(</span><span class="ident" id="1546897">x</span><span class="op" id="1546898">)</span><span class="op" id="1546899">:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1546903">return</span>&nbsp;<span class="ident" id="1546910">NaN</span><span class="op" id="1546913">(</span><span class="op" id="1546914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1546917">case</span>&nbsp;<span class="ident" id="1546922">IsInf</span><span class="op" id="1546927">(</span><span class="ident" id="1546928">x</span><span class="op" id="1546929">,</span>&nbsp;<span class="num" id="1546931">1</span><span class="op" id="1546932">)</span><span class="op" id="1546933">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1546937">return</span>&nbsp;<span class="num" id="1546944">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1546947">case</span>&nbsp;<span class="ident" id="1546952">IsInf</span><span class="op" id="1546957">(</span><span class="ident" id="1546958">x</span><span class="op" id="1546959">,</span>&nbsp;<span class="op" id="1546961">-</span><span class="num" id="1546962">1</span><span class="op" id="1546963">)</span><span class="op" id="1546964">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1546968">return</span>&nbsp;<span class="num" id="1546975">2</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1546978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1546981">sign</span>&nbsp;<span class="op" id="1546986">:=</span>&nbsp;<span class="builtintype" id="1546989">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1546996">if</span>&nbsp;<span class="ident" id="1546999">x</span>&nbsp;<span class="op" id="1547001">&lt;</span>&nbsp;<span class="num" id="1547003">0</span>&nbsp;<span class="op" id="1547005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1547009">x</span>&nbsp;<span class="op" id="1547011">=</span>&nbsp;<span class="op" id="1547013">-</span><span class="ident" id="1547014">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1547018">sign</span>&nbsp;<span class="op" id="1547023">=</span>&nbsp;<span class="builtintype" id="1547025">true</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1547031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1547034">if</span>&nbsp;<span class="ident" id="1547037">x</span>&nbsp;<span class="op" id="1547039">&lt;</span>&nbsp;<span class="num" id="1547041">0.84375</span>&nbsp;<span class="op" id="1547049">{</span>&nbsp;<span class="comment" id="1547051">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1547070">var</span>&nbsp;<span class="ident" id="1547074">temp</span>&nbsp;<span class="builtintype" id="1547079">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1547089">if</span>&nbsp;<span class="ident" id="1547092">x</span>&nbsp;<span class="op" id="1547094">&lt;</span>&nbsp;<span class="ident" id="1547096">Tiny</span>&nbsp;<span class="op" id="1547101">{</span>&nbsp;<span class="comment" id="1547103">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1547122">temp</span>&nbsp;<span class="op" id="1547127">=</span>&nbsp;<span class="ident" id="1547129">x</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1547133">}</span>&nbsp;<span class="keyword" id="1547135">else</span>&nbsp;<span class="op" id="1547140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1547145">z</span>&nbsp;<span class="op" id="1547147">:=</span>&nbsp;<span class="ident" id="1547150">x</span>&nbsp;<span class="op" id="1547152">*</span>&nbsp;<span class="ident" id="1547154">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1547159">r</span>&nbsp;<span class="op" id="1547161">:=</span>&nbsp;<span class="ident" id="1547164">pp0</span>&nbsp;<span class="op" id="1547168">+</span>&nbsp;<span class="ident" id="1547170">z</span><span class="op" id="1547171">*</span><span class="op" id="1547172">(</span><span class="ident" id="1547173">pp1</span><span class="op" id="1547176">+</span><span class="ident" id="1547177">z</span><span class="op" id="1547178">*</span><span class="op" id="1547179">(</span><span class="ident" id="1547180">pp2</span><span class="op" id="1547183">+</span><span class="ident" id="1547184">z</span><span class="op" id="1547185">*</span><span class="op" id="1547186">(</span><span class="ident" id="1547187">pp3</span><span class="op" id="1547190">+</span><span class="ident" id="1547191">z</span><span class="op" id="1547192">*</span><span class="ident" id="1547193">pp4</span><span class="op" id="1547196">)</span><span class="op" id="1547197">)</span><span class="op" id="1547198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1547203">s</span>&nbsp;<span class="op" id="1547205">:=</span>&nbsp;<span class="num" id="1547208">1</span>&nbsp;<span class="op" id="1547210">+</span>&nbsp;<span class="ident" id="1547212">z</span><span class="op" id="1547213">*</span><span class="op" id="1547214">(</span><span class="ident" id="1547215">qq1</span><span class="op" id="1547218">+</span><span class="ident" id="1547219">z</span><span class="op" id="1547220">*</span><span class="op" id="1547221">(</span><span class="ident" id="1547222">qq2</span><span class="op" id="1547225">+</span><span class="ident" id="1547226">z</span><span class="op" id="1547227">*</span><span class="op" id="1547228">(</span><span class="ident" id="1547229">qq3</span><span class="op" id="1547232">+</span><span class="ident" id="1547233">z</span><span class="op" id="1547234">*</span><span class="op" id="1547235">(</span><span class="ident" id="1547236">qq4</span><span class="op" id="1547239">+</span><span class="ident" id="1547240">z</span><span class="op" id="1547241">*</span><span class="ident" id="1547242">qq5</span><span class="op" id="1547245">)</span><span class="op" id="1547246">)</span><span class="op" id="1547247">)</span><span class="op" id="1547248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1547253">y</span>&nbsp;<span class="op" id="1547255">:=</span>&nbsp;<span class="ident" id="1547258">r</span>&nbsp;<span class="op" id="1547260">/</span>&nbsp;<span class="ident" id="1547262">s</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1547267">if</span>&nbsp;<span class="ident" id="1547270">x</span>&nbsp;<span class="op" id="1547272">&lt;</span>&nbsp;<span class="num" id="1547274">0.25</span>&nbsp;<span class="op" id="1547279">{</span>&nbsp;<span class="comment" id="1547281">//&nbsp;|x|&nbsp;&lt;&nbsp;1/4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1547298">temp</span>&nbsp;<span class="op" id="1547303">=</span>&nbsp;<span class="ident" id="1547305">x</span>&nbsp;<span class="op" id="1547307">+</span>&nbsp;<span class="ident" id="1547309">x</span><span class="op" id="1547310">*</span><span class="ident" id="1547311">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1547316">}</span>&nbsp;<span class="keyword" id="1547318">else</span>&nbsp;<span class="op" id="1547323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1547329">temp</span>&nbsp;<span class="op" id="1547334">=</span>&nbsp;<span class="num" id="1547336">0.5</span>&nbsp;<span class="op" id="1547340">+</span>&nbsp;<span class="op" id="1547342">(</span><span class="ident" id="1547343">x</span><span class="op" id="1547344">*</span><span class="ident" id="1547345">y</span>&nbsp;<span class="op" id="1547347">+</span>&nbsp;<span class="op" id="1547349">(</span><span class="ident" id="1547350">x</span>&nbsp;<span class="op" id="1547352">-</span>&nbsp;<span class="num" id="1547354">0.5</span><span class="op" id="1547357">)</span><span class="op" id="1547358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1547363">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1547367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1547371">if</span>&nbsp;<span class="ident" id="1547374">sign</span>&nbsp;<span class="op" id="1547379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1547384">return</span>&nbsp;<span class="num" id="1547391">1</span>&nbsp;<span class="op" id="1547393">+</span>&nbsp;<span class="ident" id="1547395">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1547402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1547406">return</span>&nbsp;<span class="num" id="1547413">1</span>&nbsp;<span class="op" id="1547415">-</span>&nbsp;<span class="ident" id="1547417">temp</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1547423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1547426">if</span>&nbsp;<span class="ident" id="1547429">x</span>&nbsp;<span class="op" id="1547431">&lt;</span>&nbsp;<span class="num" id="1547433">1.25</span>&nbsp;<span class="op" id="1547438">{</span>&nbsp;<span class="comment" id="1547440">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1547467">s</span>&nbsp;<span class="op" id="1547469">:=</span>&nbsp;<span class="ident" id="1547472">x</span>&nbsp;<span class="op" id="1547474">-</span>&nbsp;<span class="num" id="1547476">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1547480">P</span>&nbsp;<span class="op" id="1547482">:=</span>&nbsp;<span class="ident" id="1547485">pa0</span>&nbsp;<span class="op" id="1547489">+</span>&nbsp;<span class="ident" id="1547491">s</span><span class="op" id="1547492">*</span><span class="op" id="1547493">(</span><span class="ident" id="1547494">pa1</span><span class="op" id="1547497">+</span><span class="ident" id="1547498">s</span><span class="op" id="1547499">*</span><span class="op" id="1547500">(</span><span class="ident" id="1547501">pa2</span><span class="op" id="1547504">+</span><span class="ident" id="1547505">s</span><span class="op" id="1547506">*</span><span class="op" id="1547507">(</span><span class="ident" id="1547508">pa3</span><span class="op" id="1547511">+</span><span class="ident" id="1547512">s</span><span class="op" id="1547513">*</span><span class="op" id="1547514">(</span><span class="ident" id="1547515">pa4</span><span class="op" id="1547518">+</span><span class="ident" id="1547519">s</span><span class="op" id="1547520">*</span><span class="op" id="1547521">(</span><span class="ident" id="1547522">pa5</span><span class="op" id="1547525">+</span><span class="ident" id="1547526">s</span><span class="op" id="1547527">*</span><span class="ident" id="1547528">pa6</span><span class="op" id="1547531">)</span><span class="op" id="1547532">)</span><span class="op" id="1547533">)</span><span class="op" id="1547534">)</span><span class="op" id="1547535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1547539">Q</span>&nbsp;<span class="op" id="1547541">:=</span>&nbsp;<span class="num" id="1547544">1</span>&nbsp;<span class="op" id="1547546">+</span>&nbsp;<span class="ident" id="1547548">s</span><span class="op" id="1547549">*</span><span class="op" id="1547550">(</span><span class="ident" id="1547551">qa1</span><span class="op" id="1547554">+</span><span class="ident" id="1547555">s</span><span class="op" id="1547556">*</span><span class="op" id="1547557">(</span><span class="ident" id="1547558">qa2</span><span class="op" id="1547561">+</span><span class="ident" id="1547562">s</span><span class="op" id="1547563">*</span><span class="op" id="1547564">(</span><span class="ident" id="1547565">qa3</span><span class="op" id="1547568">+</span><span class="ident" id="1547569">s</span><span class="op" id="1547570">*</span><span class="op" id="1547571">(</span><span class="ident" id="1547572">qa4</span><span class="op" id="1547575">+</span><span class="ident" id="1547576">s</span><span class="op" id="1547577">*</span><span class="op" id="1547578">(</span><span class="ident" id="1547579">qa5</span><span class="op" id="1547582">+</span><span class="ident" id="1547583">s</span><span class="op" id="1547584">*</span><span class="ident" id="1547585">qa6</span><span class="op" id="1547588">)</span><span class="op" id="1547589">)</span><span class="op" id="1547590">)</span><span class="op" id="1547591">)</span><span class="op" id="1547592">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1547596">if</span>&nbsp;<span class="ident" id="1547599">sign</span>&nbsp;<span class="op" id="1547604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1547609">return</span>&nbsp;<span class="num" id="1547616">1</span>&nbsp;<span class="op" id="1547618">+</span>&nbsp;<span class="ident" id="1547620">erx</span>&nbsp;<span class="op" id="1547624">+</span>&nbsp;<span class="ident" id="1547626">P</span><span class="op" id="1547627">/</span><span class="ident" id="1547628">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1547632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1547636">return</span>&nbsp;<span class="num" id="1547643">1</span>&nbsp;<span class="op" id="1547645">-</span>&nbsp;<span class="ident" id="1547647">erx</span>&nbsp;<span class="op" id="1547651">-</span>&nbsp;<span class="ident" id="1547653">P</span><span class="op" id="1547654">/</span><span class="ident" id="1547655">Q</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1547659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1547662">if</span>&nbsp;<span class="ident" id="1547665">x</span>&nbsp;<span class="op" id="1547667">&lt;</span>&nbsp;<span class="num" id="1547669">28</span>&nbsp;<span class="op" id="1547672">{</span>&nbsp;<span class="comment" id="1547674">//&nbsp;|x|&nbsp;&lt;&nbsp;28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1547688">s</span>&nbsp;<span class="op" id="1547690">:=</span>&nbsp;<span class="num" id="1547693">1</span>&nbsp;<span class="op" id="1547695">/</span>&nbsp;<span class="op" id="1547697">(</span><span class="ident" id="1547698">x</span>&nbsp;<span class="op" id="1547700">*</span>&nbsp;<span class="ident" id="1547702">x</span><span class="op" id="1547703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1547707">var</span>&nbsp;<span class="ident" id="1547711">R</span><span class="op" id="1547712">,</span>&nbsp;<span class="ident" id="1547714">S</span>&nbsp;<span class="builtintype" id="1547716">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1547726">if</span>&nbsp;<span class="ident" id="1547729">x</span>&nbsp;<span class="op" id="1547731">&lt;</span>&nbsp;<span class="num" id="1547733">1</span><span class="op" id="1547734">/</span><span class="num" id="1547735">0.35</span>&nbsp;<span class="op" id="1547740">{</span>&nbsp;<span class="comment" id="1547742">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1547774">R</span>&nbsp;<span class="op" id="1547776">=</span>&nbsp;<span class="ident" id="1547778">ra0</span>&nbsp;<span class="op" id="1547782">+</span>&nbsp;<span class="ident" id="1547784">s</span><span class="op" id="1547785">*</span><span class="op" id="1547786">(</span><span class="ident" id="1547787">ra1</span><span class="op" id="1547790">+</span><span class="ident" id="1547791">s</span><span class="op" id="1547792">*</span><span class="op" id="1547793">(</span><span class="ident" id="1547794">ra2</span><span class="op" id="1547797">+</span><span class="ident" id="1547798">s</span><span class="op" id="1547799">*</span><span class="op" id="1547800">(</span><span class="ident" id="1547801">ra3</span><span class="op" id="1547804">+</span><span class="ident" id="1547805">s</span><span class="op" id="1547806">*</span><span class="op" id="1547807">(</span><span class="ident" id="1547808">ra4</span><span class="op" id="1547811">+</span><span class="ident" id="1547812">s</span><span class="op" id="1547813">*</span><span class="op" id="1547814">(</span><span class="ident" id="1547815">ra5</span><span class="op" id="1547818">+</span><span class="ident" id="1547819">s</span><span class="op" id="1547820">*</span><span class="op" id="1547821">(</span><span class="ident" id="1547822">ra6</span><span class="op" id="1547825">+</span><span class="ident" id="1547826">s</span><span class="op" id="1547827">*</span><span class="ident" id="1547828">ra7</span><span class="op" id="1547831">)</span><span class="op" id="1547832">)</span><span class="op" id="1547833">)</span><span class="op" id="1547834">)</span><span class="op" id="1547835">)</span><span class="op" id="1547836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1547841">S</span>&nbsp;<span class="op" id="1547843">=</span>&nbsp;<span class="num" id="1547845">1</span>&nbsp;<span class="op" id="1547847">+</span>&nbsp;<span class="ident" id="1547849">s</span><span class="op" id="1547850">*</span><span class="op" id="1547851">(</span><span class="ident" id="1547852">sa1</span><span class="op" id="1547855">+</span><span class="ident" id="1547856">s</span><span class="op" id="1547857">*</span><span class="op" id="1547858">(</span><span class="ident" id="1547859">sa2</span><span class="op" id="1547862">+</span><span class="ident" id="1547863">s</span><span class="op" id="1547864">*</span><span class="op" id="1547865">(</span><span class="ident" id="1547866">sa3</span><span class="op" id="1547869">+</span><span class="ident" id="1547870">s</span><span class="op" id="1547871">*</span><span class="op" id="1547872">(</span><span class="ident" id="1547873">sa4</span><span class="op" id="1547876">+</span><span class="ident" id="1547877">s</span><span class="op" id="1547878">*</span><span class="op" id="1547879">(</span><span class="ident" id="1547880">sa5</span><span class="op" id="1547883">+</span><span class="ident" id="1547884">s</span><span class="op" id="1547885">*</span><span class="op" id="1547886">(</span><span class="ident" id="1547887">sa6</span><span class="op" id="1547890">+</span><span class="ident" id="1547891">s</span><span class="op" id="1547892">*</span><span class="op" id="1547893">(</span><span class="ident" id="1547894">sa7</span><span class="op" id="1547897">+</span><span class="ident" id="1547898">s</span><span class="op" id="1547899">*</span><span class="ident" id="1547900">sa8</span><span class="op" id="1547903">)</span><span class="op" id="1547904">)</span><span class="op" id="1547905">)</span><span class="op" id="1547906">)</span><span class="op" id="1547907">)</span><span class="op" id="1547908">)</span><span class="op" id="1547909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1547913">}</span>&nbsp;<span class="keyword" id="1547915">else</span>&nbsp;<span class="op" id="1547920">{</span>&nbsp;<span class="comment" id="1547922">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1547955">if</span>&nbsp;<span class="ident" id="1547958">sign</span>&nbsp;<span class="op" id="1547963">&amp;&amp;</span>&nbsp;<span class="ident" id="1547966">x</span>&nbsp;<span class="op" id="1547968">&gt;</span>&nbsp;<span class="num" id="1547970">6</span>&nbsp;<span class="op" id="1547972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1547978">return</span>&nbsp;<span class="num" id="1547985">2</span>&nbsp;<span class="comment" id="1547987">//&nbsp;x&nbsp;&lt;&nbsp;-6</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1548000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1548005">R</span>&nbsp;<span class="op" id="1548007">=</span>&nbsp;<span class="ident" id="1548009">rb0</span>&nbsp;<span class="op" id="1548013">+</span>&nbsp;<span class="ident" id="1548015">s</span><span class="op" id="1548016">*</span><span class="op" id="1548017">(</span><span class="ident" id="1548018">rb1</span><span class="op" id="1548021">+</span><span class="ident" id="1548022">s</span><span class="op" id="1548023">*</span><span class="op" id="1548024">(</span><span class="ident" id="1548025">rb2</span><span class="op" id="1548028">+</span><span class="ident" id="1548029">s</span><span class="op" id="1548030">*</span><span class="op" id="1548031">(</span><span class="ident" id="1548032">rb3</span><span class="op" id="1548035">+</span><span class="ident" id="1548036">s</span><span class="op" id="1548037">*</span><span class="op" id="1548038">(</span><span class="ident" id="1548039">rb4</span><span class="op" id="1548042">+</span><span class="ident" id="1548043">s</span><span class="op" id="1548044">*</span><span class="op" id="1548045">(</span><span class="ident" id="1548046">rb5</span><span class="op" id="1548049">+</span><span class="ident" id="1548050">s</span><span class="op" id="1548051">*</span><span class="ident" id="1548052">rb6</span><span class="op" id="1548055">)</span><span class="op" id="1548056">)</span><span class="op" id="1548057">)</span><span class="op" id="1548058">)</span><span class="op" id="1548059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1548064">S</span>&nbsp;<span class="op" id="1548066">=</span>&nbsp;<span class="num" id="1548068">1</span>&nbsp;<span class="op" id="1548070">+</span>&nbsp;<span class="ident" id="1548072">s</span><span class="op" id="1548073">*</span><span class="op" id="1548074">(</span><span class="ident" id="1548075">sb1</span><span class="op" id="1548078">+</span><span class="ident" id="1548079">s</span><span class="op" id="1548080">*</span><span class="op" id="1548081">(</span><span class="ident" id="1548082">sb2</span><span class="op" id="1548085">+</span><span class="ident" id="1548086">s</span><span class="op" id="1548087">*</span><span class="op" id="1548088">(</span><span class="ident" id="1548089">sb3</span><span class="op" id="1548092">+</span><span class="ident" id="1548093">s</span><span class="op" id="1548094">*</span><span class="op" id="1548095">(</span><span class="ident" id="1548096">sb4</span><span class="op" id="1548099">+</span><span class="ident" id="1548100">s</span><span class="op" id="1548101">*</span><span class="op" id="1548102">(</span><span class="ident" id="1548103">sb5</span><span class="op" id="1548106">+</span><span class="ident" id="1548107">s</span><span class="op" id="1548108">*</span><span class="op" id="1548109">(</span><span class="ident" id="1548110">sb6</span><span class="op" id="1548113">+</span><span class="ident" id="1548114">s</span><span class="op" id="1548115">*</span><span class="ident" id="1548116">sb7</span><span class="op" id="1548119">)</span><span class="op" id="1548120">)</span><span class="op" id="1548121">)</span><span class="op" id="1548122">)</span><span class="op" id="1548123">)</span><span class="op" id="1548124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1548128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1548132">z</span>&nbsp;<span class="op" id="1548134">:=</span>&nbsp;<span class="ident" id="1548137">Float64frombits</span><span class="op" id="1548152">(</span><span class="ident" id="1548153">Float64bits</span><span class="op" id="1548164">(</span><span class="ident" id="1548165">x</span><span class="op" id="1548166">)</span>&nbsp;<span class="op" id="1548168">&amp;</span>&nbsp;<span class="num" id="1548170">0xffffffff00000000</span><span class="op" id="1548188">)</span>&nbsp;<span class="comment" id="1548190">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1548230">r</span>&nbsp;<span class="op" id="1548232">:=</span>&nbsp;<span class="ident" id="1548235">Exp</span><span class="op" id="1548238">(</span><span class="op" id="1548239">-</span><span class="ident" id="1548240">z</span><span class="op" id="1548241">*</span><span class="ident" id="1548242">z</span><span class="op" id="1548243">-</span><span class="num" id="1548244">0.5625</span><span class="op" id="1548250">)</span>&nbsp;<span class="op" id="1548252">*</span>&nbsp;<span class="ident" id="1548254">Exp</span><span class="op" id="1548257">(</span><span class="op" id="1548258">(</span><span class="ident" id="1548259">z</span><span class="op" id="1548260">-</span><span class="ident" id="1548261">x</span><span class="op" id="1548262">)</span><span class="op" id="1548263">*</span><span class="op" id="1548264">(</span><span class="ident" id="1548265">z</span><span class="op" id="1548266">+</span><span class="ident" id="1548267">x</span><span class="op" id="1548268">)</span><span class="op" id="1548269">+</span><span class="ident" id="1548270">R</span><span class="op" id="1548271">/</span><span class="ident" id="1548272">S</span><span class="op" id="1548273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1548277">if</span>&nbsp;<span class="ident" id="1548280">sign</span>&nbsp;<span class="op" id="1548285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1548290">return</span>&nbsp;<span class="num" id="1548297">2</span>&nbsp;<span class="op" id="1548299">-</span>&nbsp;<span class="ident" id="1548301">r</span><span class="op" id="1548302">/</span><span class="ident" id="1548303">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1548307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1548311">return</span>&nbsp;<span class="ident" id="1548318">r</span>&nbsp;<span class="op" id="1548320">/</span>&nbsp;<span class="ident" id="1548322">x</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1548325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1548328">if</span>&nbsp;<span class="ident" id="1548331">sign</span>&nbsp;<span class="op" id="1548336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1548340">return</span>&nbsp;<span class="num" id="1548347">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1548350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1548353">return</span>&nbsp;<span class="num" id="1548360">0</span><br>
<span class="lineno">335</span><span class="op" id="1548362">}</span>
</div>
</body>
</html>
