<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2127928">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2127983">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2128037">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2128088">package</span>&nbsp;<span class="ident" id="2128096">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2128102">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2128162">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cprob/gamma.c.</span><br>
<span class="lineno"></span><span class="comment" id="2128227">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">10</span><span class="comment" id="2128285">//</span><br>
<span class="lineno"></span><span class="comment" id="2128288">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tgamma.c</span><br>
<span class="lineno"></span><span class="comment" id="2128305">//</span><br>
<span class="lineno"></span><span class="comment" id="2128308">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2128331">//</span><br>
<span class="lineno">15</span><span class="comment" id="2128334">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2128347">//</span><br>
<span class="lineno"></span><span class="comment" id="2128350">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;tgamma();</span><br>
<span class="lineno"></span><span class="comment" id="2128376">//&nbsp;extern&nbsp;int&nbsp;signgam;</span><br>
<span class="lineno"></span><span class="comment" id="2128399">//</span><br>
<span class="lineno">20</span><span class="comment" id="2128402">//&nbsp;y&nbsp;=&nbsp;tgamma(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="2128422">//</span><br>
<span class="lineno"></span><span class="comment" id="2128425">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2128441">//</span><br>
<span class="lineno"></span><span class="comment" id="2128444">//&nbsp;Returns&nbsp;gamma&nbsp;function&nbsp;of&nbsp;the&nbsp;argument.&nbsp;&nbsp;The&nbsp;result&nbsp;is</span><br>
<span class="lineno">25</span><span class="comment" id="2128502">//&nbsp;correctly&nbsp;signed,&nbsp;and&nbsp;the&nbsp;sign&nbsp;(+1&nbsp;or&nbsp;-1)&nbsp;is&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="2128555">//&nbsp;returned&nbsp;in&nbsp;a&nbsp;global&nbsp;(extern)&nbsp;variable&nbsp;named&nbsp;signgam.</span><br>
<span class="lineno"></span><span class="comment" id="2128612">//&nbsp;This&nbsp;variable&nbsp;is&nbsp;also&nbsp;filled&nbsp;in&nbsp;by&nbsp;the&nbsp;logarithmic&nbsp;gamma</span><br>
<span class="lineno"></span><span class="comment" id="2128672">//&nbsp;function&nbsp;lgamma().</span><br>
<span class="lineno"></span><span class="comment" id="2128694">//</span><br>
<span class="lineno">30</span><span class="comment" id="2128697">//&nbsp;Arguments&nbsp;|x|&nbsp;&lt;=&nbsp;34&nbsp;are&nbsp;reduced&nbsp;by&nbsp;recurrence&nbsp;and&nbsp;the&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2128763">//&nbsp;approximated&nbsp;by&nbsp;a&nbsp;rational&nbsp;function&nbsp;of&nbsp;degree&nbsp;6/7&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2128823">//&nbsp;interval&nbsp;(2,3).&nbsp;&nbsp;Large&nbsp;arguments&nbsp;are&nbsp;handled&nbsp;by&nbsp;Stirling&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="2128885">//&nbsp;formula.&nbsp;Large&nbsp;negative&nbsp;arguments&nbsp;are&nbsp;made&nbsp;positive&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="2128946">//&nbsp;a&nbsp;reflection&nbsp;formula.</span><br>
<span class="lineno">35</span><span class="comment" id="2128971">//</span><br>
<span class="lineno"></span><span class="comment" id="2128974">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2128987">//</span><br>
<span class="lineno"></span><span class="comment" id="2128990">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="2129030">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="2129088">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-34,&nbsp;34&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.3e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.5e-17</span><br>
<span class="lineno"></span><span class="comment" id="2129148">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;-170,-33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.3e-16</span><br>
<span class="lineno"></span><span class="comment" id="2129208">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-33,&nbsp;&nbsp;33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.4e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="2129268">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;33,&nbsp;171.6&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="2129328">//</span><br>
<span class="lineno">45</span><span class="comment" id="2129331">//&nbsp;Error&nbsp;for&nbsp;arguments&nbsp;outside&nbsp;the&nbsp;test&nbsp;range&nbsp;will&nbsp;be&nbsp;larger</span><br>
<span class="lineno"></span><span class="comment" id="2129392">//&nbsp;owing&nbsp;to&nbsp;error&nbsp;amplification&nbsp;by&nbsp;the&nbsp;exponential&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="2129453">//</span><br>
<span class="lineno"></span><span class="comment" id="2129456">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="2129504">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">50</span><span class="comment" id="2129568">//</span><br>
<span class="lineno"></span><span class="comment" id="2129571">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="2129632">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2129702">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="2129777">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">55</span><span class="comment" id="2129844">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="2129917">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2129989">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="2130003">//</span><br>
<span class="lineno"></span><span class="comment" id="2130006">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">60</span><span class="comment" id="2130072">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="2130138">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="2130151">//</span><br>
<span class="lineno"></span><span class="comment" id="2130154">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="2130178">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="2130208">var</span>&nbsp;<span class="ident" id="2130212">_gamP</span>&nbsp;<span class="op" id="2130218">=</span>&nbsp;<span class="op" id="2130220">[</span><span class="op" id="2130221">...</span><span class="op" id="2130224">]</span><span class="builtintype" id="2130225">float64</span><span class="op" id="2130232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2130235">1.60119522476751861407e-04</span><span class="op" id="2130261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2130264">1.19135147006586384913e-03</span><span class="op" id="2130290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2130293">1.04213797561761569935e-02</span><span class="op" id="2130319">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2130322">4.76367800457137231464e-02</span><span class="op" id="2130348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2130351">2.07448227648435975150e-01</span><span class="op" id="2130377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2130380">4.94214826801497100753e-01</span><span class="op" id="2130406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2130409">9.99999999999999996796e-01</span><span class="op" id="2130435">,</span><br>
<span class="lineno"></span><span class="op" id="2130437">}</span><br>
<span class="lineno">75</span><span class="keyword" id="2130439">var</span>&nbsp;<span class="ident" id="2130443">_gamQ</span>&nbsp;<span class="op" id="2130449">=</span>&nbsp;<span class="op" id="2130451">[</span><span class="op" id="2130452">...</span><span class="op" id="2130455">]</span><span class="builtintype" id="2130456">float64</span><span class="op" id="2130463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130466">-</span><span class="num" id="2130467">2.31581873324120129819e-05</span><span class="op" id="2130493">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2130496">5.39605580493303397842e-04</span><span class="op" id="2130522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130525">-</span><span class="num" id="2130526">4.45641913851797240494e-03</span><span class="op" id="2130552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2130555">1.18139785222060435552e-02</span><span class="op" id="2130581">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2130584">3.58236398605498653373e-02</span><span class="op" id="2130610">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130613">-</span><span class="num" id="2130614">2.34591795718243348568e-01</span><span class="op" id="2130640">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2130643">7.14304917030273074085e-02</span><span class="op" id="2130669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2130672">1.00000000000000000320e+00</span><span class="op" id="2130698">,</span><br>
<span class="lineno"></span><span class="op" id="2130700">}</span><br>
<span class="lineno">85</span><span class="keyword" id="2130702">var</span>&nbsp;<span class="ident" id="2130706">_gamS</span>&nbsp;<span class="op" id="2130712">=</span>&nbsp;<span class="op" id="2130714">[</span><span class="op" id="2130715">...</span><span class="op" id="2130718">]</span><span class="builtintype" id="2130719">float64</span><span class="op" id="2130726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2130729">7.87311395793093628397e-04</span><span class="op" id="2130755">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130758">-</span><span class="num" id="2130759">2.29549961613378126380e-04</span><span class="op" id="2130785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2130788">-</span><span class="num" id="2130789">2.68132617805781232825e-03</span><span class="op" id="2130815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2130818">3.47222221605458667310e-03</span><span class="op" id="2130844">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2130847">8.33333333333482257126e-02</span><span class="op" id="2130873">,</span><br>
<span class="lineno"></span><span class="op" id="2130875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2130878">//&nbsp;Gamma&nbsp;function&nbsp;computed&nbsp;by&nbsp;Stirling&#39;s&nbsp;formula.</span><br>
<span class="lineno"></span><span class="comment" id="2130928">//&nbsp;The&nbsp;polynomial&nbsp;is&nbsp;valid&nbsp;for&nbsp;33&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;172.</span><br>
<span class="lineno">95</span><span class="keyword" id="2130975">func</span>&nbsp;<span class="ident" id="2130980">stirling</span><span class="op" id="2130988">(</span><span class="ident" id="2130989">x</span>&nbsp;<span class="builtintype" id="2130991">float64</span><span class="op" id="2130998">)</span>&nbsp;<span class="builtintype" id="2131000">float64</span>&nbsp;<span class="op" id="2131008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2131011">const</span>&nbsp;<span class="op" id="2131017">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2131021">SqrtTwoPi</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2131033">=</span>&nbsp;<span class="num" id="2131035">2.506628274631000502417</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2131061">MaxStirling</span>&nbsp;<span class="op" id="2131073">=</span>&nbsp;<span class="num" id="2131075">143.01608</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2131086">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2131089">w</span>&nbsp;<span class="op" id="2131091">:=</span>&nbsp;<span class="num" id="2131094">1</span>&nbsp;<span class="op" id="2131096">/</span>&nbsp;<span class="ident" id="2131098">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2131101">w</span>&nbsp;<span class="op" id="2131103">=</span>&nbsp;<span class="num" id="2131105">1</span>&nbsp;<span class="op" id="2131107">+</span>&nbsp;<span class="ident" id="2131109">w</span><span class="op" id="2131110">*</span><span class="op" id="2131111">(</span><span class="op" id="2131112">(</span><span class="op" id="2131113">(</span><span class="op" id="2131114">(</span><span class="ident" id="2131115">_gamS</span><span class="op" id="2131120">[</span><span class="num" id="2131121">0</span><span class="op" id="2131122">]</span><span class="op" id="2131123">*</span><span class="ident" id="2131124">w</span><span class="op" id="2131125">+</span><span class="ident" id="2131126">_gamS</span><span class="op" id="2131131">[</span><span class="num" id="2131132">1</span><span class="op" id="2131133">]</span><span class="op" id="2131134">)</span><span class="op" id="2131135">*</span><span class="ident" id="2131136">w</span><span class="op" id="2131137">+</span><span class="ident" id="2131138">_gamS</span><span class="op" id="2131143">[</span><span class="num" id="2131144">2</span><span class="op" id="2131145">]</span><span class="op" id="2131146">)</span><span class="op" id="2131147">*</span><span class="ident" id="2131148">w</span><span class="op" id="2131149">+</span><span class="ident" id="2131150">_gamS</span><span class="op" id="2131155">[</span><span class="num" id="2131156">3</span><span class="op" id="2131157">]</span><span class="op" id="2131158">)</span><span class="op" id="2131159">*</span><span class="ident" id="2131160">w</span><span class="op" id="2131161">+</span><span class="ident" id="2131162">_gamS</span><span class="op" id="2131167">[</span><span class="num" id="2131168">4</span><span class="op" id="2131169">]</span><span class="op" id="2131170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2131173">y</span>&nbsp;<span class="op" id="2131175">:=</span>&nbsp;<span class="ident" id="2131178">Exp</span><span class="op" id="2131181">(</span><span class="ident" id="2131182">x</span><span class="op" id="2131183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2131186">if</span>&nbsp;<span class="ident" id="2131189">x</span>&nbsp;<span class="op" id="2131191">&gt;</span>&nbsp;<span class="ident" id="2131193">MaxStirling</span>&nbsp;<span class="op" id="2131205">{</span>&nbsp;<span class="comment" id="2131207">//&nbsp;avoid&nbsp;Pow()&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2131233">v</span>&nbsp;<span class="op" id="2131235">:=</span>&nbsp;<span class="ident" id="2131238">Pow</span><span class="op" id="2131241">(</span><span class="ident" id="2131242">x</span><span class="op" id="2131243">,</span>&nbsp;<span class="num" id="2131245">0.5</span><span class="op" id="2131248">*</span><span class="ident" id="2131249">x</span><span class="op" id="2131250">-</span><span class="num" id="2131251">0.25</span><span class="op" id="2131255">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2131259">y</span>&nbsp;<span class="op" id="2131261">=</span>&nbsp;<span class="ident" id="2131263">v</span>&nbsp;<span class="op" id="2131265">*</span>&nbsp;<span class="op" id="2131267">(</span><span class="ident" id="2131268">v</span>&nbsp;<span class="op" id="2131270">/</span>&nbsp;<span class="ident" id="2131272">y</span><span class="op" id="2131273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2131276">}</span>&nbsp;<span class="keyword" id="2131278">else</span>&nbsp;<span class="op" id="2131283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2131287">y</span>&nbsp;<span class="op" id="2131289">=</span>&nbsp;<span class="ident" id="2131291">Pow</span><span class="op" id="2131294">(</span><span class="ident" id="2131295">x</span><span class="op" id="2131296">,</span>&nbsp;<span class="ident" id="2131298">x</span><span class="op" id="2131299">-</span><span class="num" id="2131300">0.5</span><span class="op" id="2131303">)</span>&nbsp;<span class="op" id="2131305">/</span>&nbsp;<span class="ident" id="2131307">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2131310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2131313">y</span>&nbsp;<span class="op" id="2131315">=</span>&nbsp;<span class="ident" id="2131317">SqrtTwoPi</span>&nbsp;<span class="op" id="2131327">*</span>&nbsp;<span class="ident" id="2131329">y</span>&nbsp;<span class="op" id="2131331">*</span>&nbsp;<span class="ident" id="2131333">w</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2131336">return</span>&nbsp;<span class="ident" id="2131343">y</span><br>
<span class="lineno"></span><span class="op" id="2131345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2131348">//&nbsp;Gamma&nbsp;returns&nbsp;the&nbsp;Gamma&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2131390">//</span><br>
<span class="lineno">115</span><span class="comment" id="2131393">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2131415">//&nbsp;&nbsp;&nbsp;&nbspGamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2131437">//&nbsp;&nbsp;&nbsp;&nbspGamma(+0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2131457">//&nbsp;&nbsp;&nbsp;&nbspGamma(-0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2131477">//&nbsp;&nbsp;&nbsp;&nbspGamma(x)&nbsp;=&nbsp;NaN&nbsp;for&nbsp;integer&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno">120</span><span class="comment" id="2131513">//&nbsp;&nbsp;&nbsp;&nbspGamma(-Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2131534">//&nbsp;&nbsp;&nbsp;&nbspGamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2131554">func</span>&nbsp;<span class="ident" id="2131559">Gamma</span><span class="op" id="2131564">(</span><span class="ident" id="2131565">x</span>&nbsp;<span class="builtintype" id="2131567">float64</span><span class="op" id="2131574">)</span>&nbsp;<span class="builtintype" id="2131576">float64</span>&nbsp;<span class="op" id="2131584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2131587">const</span>&nbsp;<span class="ident" id="2131593">Euler</span>&nbsp;<span class="op" id="2131599">=</span>&nbsp;<span class="num" id="2131601">0.57721566490153286060651209008240243104215933593992</span>&nbsp;<span class="comment" id="2131654">//&nbsp;A001620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2131666">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2131684">switch</span>&nbsp;<span class="op" id="2131691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2131694">case</span>&nbsp;<span class="ident" id="2131699">isNegInt</span><span class="op" id="2131707">(</span><span class="ident" id="2131708">x</span><span class="op" id="2131709">)</span>&nbsp;<span class="op" id="2131711">||</span>&nbsp;<span class="ident" id="2131714">IsInf</span><span class="op" id="2131719">(</span><span class="ident" id="2131720">x</span><span class="op" id="2131721">,</span>&nbsp;<span class="op" id="2131723">-</span><span class="num" id="2131724">1</span><span class="op" id="2131725">)</span>&nbsp;<span class="op" id="2131727">||</span>&nbsp;<span class="ident" id="2131730">IsNaN</span><span class="op" id="2131735">(</span><span class="ident" id="2131736">x</span><span class="op" id="2131737">)</span><span class="op" id="2131738">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2131742">return</span>&nbsp;<span class="ident" id="2131749">NaN</span><span class="op" id="2131752">(</span><span class="op" id="2131753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2131756">case</span>&nbsp;<span class="ident" id="2131761">x</span>&nbsp;<span class="op" id="2131763">==</span>&nbsp;<span class="num" id="2131766">0</span><span class="op" id="2131767">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2131771">if</span>&nbsp;<span class="ident" id="2131774">Signbit</span><span class="op" id="2131781">(</span><span class="ident" id="2131782">x</span><span class="op" id="2131783">)</span>&nbsp;<span class="op" id="2131785">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2131790">return</span>&nbsp;<span class="ident" id="2131797">Inf</span><span class="op" id="2131800">(</span><span class="op" id="2131801">-</span><span class="num" id="2131802">1</span><span class="op" id="2131803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2131807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2131811">return</span>&nbsp;<span class="ident" id="2131818">Inf</span><span class="op" id="2131821">(</span><span class="num" id="2131822">1</span><span class="op" id="2131823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2131826">case</span>&nbsp;<span class="ident" id="2131831">x</span>&nbsp;<span class="op" id="2131833">&lt;</span>&nbsp;<span class="op" id="2131835">-</span><span class="num" id="2131836">170.5674972726612</span>&nbsp;<span class="op" id="2131854">||</span>&nbsp;<span class="ident" id="2131857">x</span>&nbsp;<span class="op" id="2131859">&gt;</span>&nbsp;<span class="num" id="2131861">171.61447887182298</span><span class="op" id="2131879">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2131883">return</span>&nbsp;<span class="ident" id="2131890">Inf</span><span class="op" id="2131893">(</span><span class="num" id="2131894">1</span><span class="op" id="2131895">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2131898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2131901">q</span>&nbsp;<span class="op" id="2131903">:=</span>&nbsp;<span class="ident" id="2131906">Abs</span><span class="op" id="2131909">(</span><span class="ident" id="2131910">x</span><span class="op" id="2131911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2131914">p</span>&nbsp;<span class="op" id="2131916">:=</span>&nbsp;<span class="ident" id="2131919">Floor</span><span class="op" id="2131924">(</span><span class="ident" id="2131925">q</span><span class="op" id="2131926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2131929">if</span>&nbsp;<span class="ident" id="2131932">q</span>&nbsp;<span class="op" id="2131934">&gt;</span>&nbsp;<span class="num" id="2131936">33</span>&nbsp;<span class="op" id="2131939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2131943">if</span>&nbsp;<span class="ident" id="2131946">x</span>&nbsp;<span class="op" id="2131948">&gt;=</span>&nbsp;<span class="num" id="2131951">0</span>&nbsp;<span class="op" id="2131953">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2131958">return</span>&nbsp;<span class="ident" id="2131965">stirling</span><span class="op" id="2131973">(</span><span class="ident" id="2131974">x</span><span class="op" id="2131975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2131979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2131983">signgam</span>&nbsp;<span class="op" id="2131991">:=</span>&nbsp;<span class="num" id="2131994">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2131998">if</span>&nbsp;<span class="ident" id="2132001">ip</span>&nbsp;<span class="op" id="2132004">:=</span>&nbsp;<span class="builtintype" id="2132007">int</span><span class="op" id="2132010">(</span><span class="ident" id="2132011">p</span><span class="op" id="2132012">)</span><span class="op" id="2132013">;</span>&nbsp;<span class="ident" id="2132015">ip</span><span class="op" id="2132017">&amp;</span><span class="num" id="2132018">1</span>&nbsp;<span class="op" id="2132020">==</span>&nbsp;<span class="num" id="2132023">0</span>&nbsp;<span class="op" id="2132025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132030">signgam</span>&nbsp;<span class="op" id="2132038">=</span>&nbsp;<span class="op" id="2132040">-</span><span class="num" id="2132041">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2132045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132049">z</span>&nbsp;<span class="op" id="2132051">:=</span>&nbsp;<span class="ident" id="2132054">q</span>&nbsp;<span class="op" id="2132056">-</span>&nbsp;<span class="ident" id="2132058">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132062">if</span>&nbsp;<span class="ident" id="2132065">z</span>&nbsp;<span class="op" id="2132067">&gt;</span>&nbsp;<span class="num" id="2132069">0.5</span>&nbsp;<span class="op" id="2132073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132078">p</span>&nbsp;<span class="op" id="2132080">=</span>&nbsp;<span class="ident" id="2132082">p</span>&nbsp;<span class="op" id="2132084">+</span>&nbsp;<span class="num" id="2132086">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132091">z</span>&nbsp;<span class="op" id="2132093">=</span>&nbsp;<span class="ident" id="2132095">q</span>&nbsp;<span class="op" id="2132097">-</span>&nbsp;<span class="ident" id="2132099">p</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2132103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132107">z</span>&nbsp;<span class="op" id="2132109">=</span>&nbsp;<span class="ident" id="2132111">q</span>&nbsp;<span class="op" id="2132113">*</span>&nbsp;<span class="ident" id="2132115">Sin</span><span class="op" id="2132118">(</span><span class="ident" id="2132119">Pi</span><span class="op" id="2132121">*</span><span class="ident" id="2132122">z</span><span class="op" id="2132123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132127">if</span>&nbsp;<span class="ident" id="2132130">z</span>&nbsp;<span class="op" id="2132132">==</span>&nbsp;<span class="num" id="2132135">0</span>&nbsp;<span class="op" id="2132137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132142">return</span>&nbsp;<span class="ident" id="2132149">Inf</span><span class="op" id="2132152">(</span><span class="ident" id="2132153">signgam</span><span class="op" id="2132160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2132164">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132168">z</span>&nbsp;<span class="op" id="2132170">=</span>&nbsp;<span class="ident" id="2132172">Pi</span>&nbsp;<span class="op" id="2132175">/</span>&nbsp;<span class="op" id="2132177">(</span><span class="ident" id="2132178">Abs</span><span class="op" id="2132181">(</span><span class="ident" id="2132182">z</span><span class="op" id="2132183">)</span>&nbsp;<span class="op" id="2132185">*</span>&nbsp;<span class="ident" id="2132187">stirling</span><span class="op" id="2132195">(</span><span class="ident" id="2132196">q</span><span class="op" id="2132197">)</span><span class="op" id="2132198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132202">return</span>&nbsp;<span class="builtintype" id="2132209">float64</span><span class="op" id="2132216">(</span><span class="ident" id="2132217">signgam</span><span class="op" id="2132224">)</span>&nbsp;<span class="op" id="2132226">*</span>&nbsp;<span class="ident" id="2132228">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2132231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2132235">//&nbsp;Reduce&nbsp;argument</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132255">z</span>&nbsp;<span class="op" id="2132257">:=</span>&nbsp;<span class="num" id="2132260">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132265">for</span>&nbsp;<span class="ident" id="2132269">x</span>&nbsp;<span class="op" id="2132271">&gt;=</span>&nbsp;<span class="num" id="2132274">3</span>&nbsp;<span class="op" id="2132276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132280">x</span>&nbsp;<span class="op" id="2132282">=</span>&nbsp;<span class="ident" id="2132284">x</span>&nbsp;<span class="op" id="2132286">-</span>&nbsp;<span class="num" id="2132288">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132292">z</span>&nbsp;<span class="op" id="2132294">=</span>&nbsp;<span class="ident" id="2132296">z</span>&nbsp;<span class="op" id="2132298">*</span>&nbsp;<span class="ident" id="2132300">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2132303">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132306">for</span>&nbsp;<span class="ident" id="2132310">x</span>&nbsp;<span class="op" id="2132312">&lt;</span>&nbsp;<span class="num" id="2132314">0</span>&nbsp;<span class="op" id="2132316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132320">if</span>&nbsp;<span class="ident" id="2132323">x</span>&nbsp;<span class="op" id="2132325">&gt;</span>&nbsp;<span class="op" id="2132327">-</span><span class="num" id="2132328">1e-09</span>&nbsp;<span class="op" id="2132334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132339">goto</span>&nbsp;<span class="ident" id="2132344">small</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2132352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132356">z</span>&nbsp;<span class="op" id="2132358">=</span>&nbsp;<span class="ident" id="2132360">z</span>&nbsp;<span class="op" id="2132362">/</span>&nbsp;<span class="ident" id="2132364">x</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132368">x</span>&nbsp;<span class="op" id="2132370">=</span>&nbsp;<span class="ident" id="2132372">x</span>&nbsp;<span class="op" id="2132374">+</span>&nbsp;<span class="num" id="2132376">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2132379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132382">for</span>&nbsp;<span class="ident" id="2132386">x</span>&nbsp;<span class="op" id="2132388">&lt;</span>&nbsp;<span class="num" id="2132390">2</span>&nbsp;<span class="op" id="2132392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132396">if</span>&nbsp;<span class="ident" id="2132399">x</span>&nbsp;<span class="op" id="2132401">&lt;</span>&nbsp;<span class="num" id="2132403">1e-09</span>&nbsp;<span class="op" id="2132409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132414">goto</span>&nbsp;<span class="ident" id="2132419">small</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2132427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132431">z</span>&nbsp;<span class="op" id="2132433">=</span>&nbsp;<span class="ident" id="2132435">z</span>&nbsp;<span class="op" id="2132437">/</span>&nbsp;<span class="ident" id="2132439">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132443">x</span>&nbsp;<span class="op" id="2132445">=</span>&nbsp;<span class="ident" id="2132447">x</span>&nbsp;<span class="op" id="2132449">+</span>&nbsp;<span class="num" id="2132451">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2132454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132458">if</span>&nbsp;<span class="ident" id="2132461">x</span>&nbsp;<span class="op" id="2132463">==</span>&nbsp;<span class="num" id="2132466">2</span>&nbsp;<span class="op" id="2132468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132472">return</span>&nbsp;<span class="ident" id="2132479">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2132482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132486">x</span>&nbsp;<span class="op" id="2132488">=</span>&nbsp;<span class="ident" id="2132490">x</span>&nbsp;<span class="op" id="2132492">-</span>&nbsp;<span class="num" id="2132494">2</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132497">p</span>&nbsp;<span class="op" id="2132499">=</span>&nbsp;<span class="op" id="2132501">(</span><span class="op" id="2132502">(</span><span class="op" id="2132503">(</span><span class="op" id="2132504">(</span><span class="op" id="2132505">(</span><span class="ident" id="2132506">x</span><span class="op" id="2132507">*</span><span class="ident" id="2132508">_gamP</span><span class="op" id="2132513">[</span><span class="num" id="2132514">0</span><span class="op" id="2132515">]</span><span class="op" id="2132516">+</span><span class="ident" id="2132517">_gamP</span><span class="op" id="2132522">[</span><span class="num" id="2132523">1</span><span class="op" id="2132524">]</span><span class="op" id="2132525">)</span><span class="op" id="2132526">*</span><span class="ident" id="2132527">x</span><span class="op" id="2132528">+</span><span class="ident" id="2132529">_gamP</span><span class="op" id="2132534">[</span><span class="num" id="2132535">2</span><span class="op" id="2132536">]</span><span class="op" id="2132537">)</span><span class="op" id="2132538">*</span><span class="ident" id="2132539">x</span><span class="op" id="2132540">+</span><span class="ident" id="2132541">_gamP</span><span class="op" id="2132546">[</span><span class="num" id="2132547">3</span><span class="op" id="2132548">]</span><span class="op" id="2132549">)</span><span class="op" id="2132550">*</span><span class="ident" id="2132551">x</span><span class="op" id="2132552">+</span><span class="ident" id="2132553">_gamP</span><span class="op" id="2132558">[</span><span class="num" id="2132559">4</span><span class="op" id="2132560">]</span><span class="op" id="2132561">)</span><span class="op" id="2132562">*</span><span class="ident" id="2132563">x</span><span class="op" id="2132564">+</span><span class="ident" id="2132565">_gamP</span><span class="op" id="2132570">[</span><span class="num" id="2132571">5</span><span class="op" id="2132572">]</span><span class="op" id="2132573">)</span><span class="op" id="2132574">*</span><span class="ident" id="2132575">x</span>&nbsp;<span class="op" id="2132577">+</span>&nbsp;<span class="ident" id="2132579">_gamP</span><span class="op" id="2132584">[</span><span class="num" id="2132585">6</span><span class="op" id="2132586">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132589">q</span>&nbsp;<span class="op" id="2132591">=</span>&nbsp;<span class="op" id="2132593">(</span><span class="op" id="2132594">(</span><span class="op" id="2132595">(</span><span class="op" id="2132596">(</span><span class="op" id="2132597">(</span><span class="op" id="2132598">(</span><span class="ident" id="2132599">x</span><span class="op" id="2132600">*</span><span class="ident" id="2132601">_gamQ</span><span class="op" id="2132606">[</span><span class="num" id="2132607">0</span><span class="op" id="2132608">]</span><span class="op" id="2132609">+</span><span class="ident" id="2132610">_gamQ</span><span class="op" id="2132615">[</span><span class="num" id="2132616">1</span><span class="op" id="2132617">]</span><span class="op" id="2132618">)</span><span class="op" id="2132619">*</span><span class="ident" id="2132620">x</span><span class="op" id="2132621">+</span><span class="ident" id="2132622">_gamQ</span><span class="op" id="2132627">[</span><span class="num" id="2132628">2</span><span class="op" id="2132629">]</span><span class="op" id="2132630">)</span><span class="op" id="2132631">*</span><span class="ident" id="2132632">x</span><span class="op" id="2132633">+</span><span class="ident" id="2132634">_gamQ</span><span class="op" id="2132639">[</span><span class="num" id="2132640">3</span><span class="op" id="2132641">]</span><span class="op" id="2132642">)</span><span class="op" id="2132643">*</span><span class="ident" id="2132644">x</span><span class="op" id="2132645">+</span><span class="ident" id="2132646">_gamQ</span><span class="op" id="2132651">[</span><span class="num" id="2132652">4</span><span class="op" id="2132653">]</span><span class="op" id="2132654">)</span><span class="op" id="2132655">*</span><span class="ident" id="2132656">x</span><span class="op" id="2132657">+</span><span class="ident" id="2132658">_gamQ</span><span class="op" id="2132663">[</span><span class="num" id="2132664">5</span><span class="op" id="2132665">]</span><span class="op" id="2132666">)</span><span class="op" id="2132667">*</span><span class="ident" id="2132668">x</span><span class="op" id="2132669">+</span><span class="ident" id="2132670">_gamQ</span><span class="op" id="2132675">[</span><span class="num" id="2132676">6</span><span class="op" id="2132677">]</span><span class="op" id="2132678">)</span><span class="op" id="2132679">*</span><span class="ident" id="2132680">x</span>&nbsp;<span class="op" id="2132682">+</span>&nbsp;<span class="ident" id="2132684">_gamQ</span><span class="op" id="2132689">[</span><span class="num" id="2132690">7</span><span class="op" id="2132691">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132694">return</span>&nbsp;<span class="ident" id="2132701">z</span>&nbsp;<span class="op" id="2132703">*</span>&nbsp;<span class="ident" id="2132705">p</span>&nbsp;<span class="op" id="2132707">/</span>&nbsp;<span class="ident" id="2132709">q</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="2132712">small</span><span class="op" id="2132717">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132720">if</span>&nbsp;<span class="ident" id="2132723">x</span>&nbsp;<span class="op" id="2132725">==</span>&nbsp;<span class="num" id="2132728">0</span>&nbsp;<span class="op" id="2132730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132734">return</span>&nbsp;<span class="ident" id="2132741">Inf</span><span class="op" id="2132744">(</span><span class="num" id="2132745">1</span><span class="op" id="2132746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2132749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132752">return</span>&nbsp;<span class="ident" id="2132759">z</span>&nbsp;<span class="op" id="2132761">/</span>&nbsp;<span class="op" id="2132763">(</span><span class="op" id="2132764">(</span><span class="num" id="2132765">1</span>&nbsp;<span class="op" id="2132767">+</span>&nbsp;<span class="ident" id="2132769">Euler</span><span class="op" id="2132774">*</span><span class="ident" id="2132775">x</span><span class="op" id="2132776">)</span>&nbsp;<span class="op" id="2132778">*</span>&nbsp;<span class="ident" id="2132780">x</span><span class="op" id="2132781">)</span><br>
<span class="lineno"></span><span class="op" id="2132783">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="keyword" id="2132786">func</span>&nbsp;<span class="ident" id="2132791">isNegInt</span><span class="op" id="2132799">(</span><span class="ident" id="2132800">x</span>&nbsp;<span class="builtintype" id="2132802">float64</span><span class="op" id="2132809">)</span>&nbsp;<span class="builtintype" id="2132811">bool</span>&nbsp;<span class="op" id="2132816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132819">if</span>&nbsp;<span class="ident" id="2132822">x</span>&nbsp;<span class="op" id="2132824">&lt;</span>&nbsp;<span class="num" id="2132826">0</span>&nbsp;<span class="op" id="2132828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2132832">_</span><span class="op" id="2132833">,</span>&nbsp;<span class="ident" id="2132835">xf</span>&nbsp;<span class="op" id="2132838">:=</span>&nbsp;<span class="ident" id="2132841">Modf</span><span class="op" id="2132845">(</span><span class="ident" id="2132846">x</span><span class="op" id="2132847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132851">return</span>&nbsp;<span class="ident" id="2132858">xf</span>&nbsp;<span class="op" id="2132861">==</span>&nbsp;<span class="num" id="2132864">0</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2132867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2132870">return</span>&nbsp;<span class="builtintype" id="2132877">false</span><br>
<span class="lineno"></span><span class="op" id="2132883">}</span>
</div>
</body>
</html>
