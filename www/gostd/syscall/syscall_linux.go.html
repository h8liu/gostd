<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>syscall</h2>
<ul>
<li><a href="/gostd/syscall/creds_test.go.html">creds_test.go</a></li>
<li><a href="/gostd/syscall/env_unix.go.html">env_unix.go</a></li>
<li><a href="/gostd/syscall/exec_linux.go.html">exec_linux.go</a></li>
<li><a href="/gostd/syscall/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/syscall/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/syscall/flock.go.html">flock.go</a></li>
<li><a href="/gostd/syscall/lsf_linux.go.html">lsf_linux.go</a></li>
<li><a href="/gostd/syscall/mmap_unix_test.go.html">mmap_unix_test.go</a></li>
<li><a href="/gostd/syscall/netlink_linux.go.html">netlink_linux.go</a></li>
<li><a href="/gostd/syscall/race0.go.html">race0.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_linux.go.html">sockcmsg_linux.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_unix.go.html">sockcmsg_unix.go</a></li>
<li><a href="/gostd/syscall/str.go.html">str.go</a></li>
<li><a href="/gostd/syscall/syscall.go.html">syscall.go</a></li>
<li><a href="/gostd/syscall/syscall_linux.go.html" class="current">syscall_linux.go</a></li>
<li><a href="/gostd/syscall/syscall_linux_amd64.go.html">syscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/syscall_test.go.html">syscall_test.go</a></li>
<li><a href="/gostd/syscall/syscall_unix.go.html">syscall_unix.go</a></li>
<li><a href="/gostd/syscall/syscall_unix_test.go.html">syscall_unix_test.go</a></li>
<li><a href="/gostd/syscall/zerrors_linux_amd64.go.html">zerrors_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsyscall_linux_amd64.go.html">zsyscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsysnum_linux_amd64.go.html">zsysnum_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/ztypes_linux_amd64.go.html">ztypes_linux_amd64.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2615447">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2615502">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2615556">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2615607">//&nbsp;Linux&nbsp;system&nbsp;calls.</span><br>
<span class="lineno"></span><span class="comment" id="2615630">//&nbsp;This&nbsp;file&nbsp;is&nbsp;compiled&nbsp;as&nbsp;ordinary&nbsp;Go&nbsp;code,</span><br>
<span class="lineno"></span><span class="comment" id="2615676">//&nbsp;but&nbsp;it&nbsp;is&nbsp;also&nbsp;input&nbsp;to&nbsp;mksyscall,</span><br>
<span class="lineno"></span><span class="comment" id="2615714">//&nbsp;which&nbsp;parses&nbsp;the&nbsp;//sys&nbsp;lines&nbsp;and&nbsp;generates&nbsp;system&nbsp;call&nbsp;stubs.</span><br>
<span class="lineno"></span><span class="comment" id="2615779">//&nbsp;Note&nbsp;that&nbsp;sometimes&nbsp;we&nbsp;use&nbsp;a&nbsp;lowercase&nbsp;//sys&nbsp;name&nbsp;and</span><br>
<span class="lineno">10</span><span class="comment" id="2615836">//&nbsp;wrap&nbsp;it&nbsp;in&nbsp;our&nbsp;own&nbsp;nicer&nbsp;implementation.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2615881">package</span>&nbsp;<span class="ident" id="2615889">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2615898">import</span>&nbsp;<span class="string" id="2615905">&#34;unsafe&#34;</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2615915">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Wrapped<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="2615934">//sys&nbsp;&nbsp;&nbsp;&nbspopen(path&nbsp;string,&nbsp;mode&nbsp;int,&nbsp;perm&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2616002">func</span>&nbsp;<span class="ident" id="2616007">Open</span><span class="op" id="2616011">(</span><span class="ident" id="2616012">path</span>&nbsp;<span class="builtintype" id="2616017">string</span><span class="op" id="2616023">,</span>&nbsp;<span class="ident" id="2616025">mode</span>&nbsp;<span class="builtintype" id="2616030">int</span><span class="op" id="2616033">,</span>&nbsp;<span class="ident" id="2616035">perm</span>&nbsp;<span class="builtintype" id="2616040">uint32</span><span class="op" id="2616046">)</span>&nbsp;<span class="op" id="2616048">(</span><span class="ident" id="2616049">fd</span>&nbsp;<span class="builtintype" id="2616052">int</span><span class="op" id="2616055">,</span>&nbsp;<span class="ident" id="2616057">err</span>&nbsp;<span class="builtintype" id="2616061">error</span><span class="op" id="2616066">)</span>&nbsp;<span class="op" id="2616068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616071">return</span>&nbsp;<span class="ident" id="2616078">open</span><span class="op" id="2616082">(</span><span class="ident" id="2616083">path</span><span class="op" id="2616087">,</span>&nbsp;<span class="ident" id="2616089">mode</span><span class="op" id="2616093">|</span><span class="ident" id="2616094">O_LARGEFILE</span><span class="op" id="2616105">,</span>&nbsp;<span class="ident" id="2616107">perm</span><span class="op" id="2616111">)</span><br>
<span class="lineno"></span><span class="op" id="2616113">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="2616116">//sys&nbsp;&nbsp;&nbsp;&nbspopenat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;flags&nbsp;int,&nbsp;mode&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2616198">func</span>&nbsp;<span class="ident" id="2616203">Openat</span><span class="op" id="2616209">(</span><span class="ident" id="2616210">dirfd</span>&nbsp;<span class="builtintype" id="2616216">int</span><span class="op" id="2616219">,</span>&nbsp;<span class="ident" id="2616221">path</span>&nbsp;<span class="builtintype" id="2616226">string</span><span class="op" id="2616232">,</span>&nbsp;<span class="ident" id="2616234">flags</span>&nbsp;<span class="builtintype" id="2616240">int</span><span class="op" id="2616243">,</span>&nbsp;<span class="ident" id="2616245">mode</span>&nbsp;<span class="builtintype" id="2616250">uint32</span><span class="op" id="2616256">)</span>&nbsp;<span class="op" id="2616258">(</span><span class="ident" id="2616259">fd</span>&nbsp;<span class="builtintype" id="2616262">int</span><span class="op" id="2616265">,</span>&nbsp;<span class="ident" id="2616267">err</span>&nbsp;<span class="builtintype" id="2616271">error</span><span class="op" id="2616276">)</span>&nbsp;<span class="op" id="2616278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616281">return</span>&nbsp;<span class="ident" id="2616288">openat</span><span class="op" id="2616294">(</span><span class="ident" id="2616295">dirfd</span><span class="op" id="2616300">,</span>&nbsp;<span class="ident" id="2616302">path</span><span class="op" id="2616306">,</span>&nbsp;<span class="ident" id="2616308">flags</span><span class="op" id="2616313">|</span><span class="ident" id="2616314">O_LARGEFILE</span><span class="op" id="2616325">,</span>&nbsp;<span class="ident" id="2616327">mode</span><span class="op" id="2616331">)</span><br>
<span class="lineno">30</span><span class="op" id="2616333">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2616336">//sysnb&nbsp;&nbsp;&nbsp;&nbsppipe(p&nbsp;*[2]_C_int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2616376">func</span>&nbsp;<span class="ident" id="2616381">Pipe</span><span class="op" id="2616385">(</span><span class="ident" id="2616386">p</span>&nbsp;<span class="op" id="2616388">[</span><span class="op" id="2616389">]</span><span class="builtintype" id="2616390">int</span><span class="op" id="2616393">)</span>&nbsp;<span class="op" id="2616395">(</span><span class="ident" id="2616396">err</span>&nbsp;<span class="builtintype" id="2616400">error</span><span class="op" id="2616405">)</span>&nbsp;<span class="op" id="2616407">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616410">if</span>&nbsp;<span class="builtinfunc" id="2616413">len</span><span class="op" id="2616416">(</span><span class="ident" id="2616417">p</span><span class="op" id="2616418">)</span>&nbsp;<span class="op" id="2616420">!=</span>&nbsp;<span class="num" id="2616423">2</span>&nbsp;<span class="op" id="2616425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616429">return</span>&nbsp;<span class="ident" id="2616436">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2616444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616447">var</span>&nbsp;<span class="ident" id="2616451">pp</span>&nbsp;<span class="op" id="2616454">[</span><span class="num" id="2616455">2</span><span class="op" id="2616456">]</span><span class="ident" id="2616457">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616465">err</span>&nbsp;<span class="op" id="2616469">=</span>&nbsp;<span class="ident" id="2616471">pipe</span><span class="op" id="2616475">(</span><span class="op" id="2616476">&amp;</span><span class="ident" id="2616477">pp</span><span class="op" id="2616479">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616482">p</span><span class="op" id="2616483">[</span><span class="num" id="2616484">0</span><span class="op" id="2616485">]</span>&nbsp;<span class="op" id="2616487">=</span>&nbsp;<span class="builtintype" id="2616489">int</span><span class="op" id="2616492">(</span><span class="ident" id="2616493">pp</span><span class="op" id="2616495">[</span><span class="num" id="2616496">0</span><span class="op" id="2616497">]</span><span class="op" id="2616498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616501">p</span><span class="op" id="2616502">[</span><span class="num" id="2616503">1</span><span class="op" id="2616504">]</span>&nbsp;<span class="op" id="2616506">=</span>&nbsp;<span class="builtintype" id="2616508">int</span><span class="op" id="2616511">(</span><span class="ident" id="2616512">pp</span><span class="op" id="2616514">[</span><span class="num" id="2616515">1</span><span class="op" id="2616516">]</span><span class="op" id="2616517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616520">return</span><br>
<span class="lineno"></span><span class="op" id="2616527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="2616530">//sysnb&nbsp;pipe2(p&nbsp;*[2]_C_int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2616582">func</span>&nbsp;<span class="ident" id="2616587">Pipe2</span><span class="op" id="2616592">(</span><span class="ident" id="2616593">p</span>&nbsp;<span class="op" id="2616595">[</span><span class="op" id="2616596">]</span><span class="builtintype" id="2616597">int</span><span class="op" id="2616600">,</span>&nbsp;<span class="ident" id="2616602">flags</span>&nbsp;<span class="builtintype" id="2616608">int</span><span class="op" id="2616611">)</span>&nbsp;<span class="op" id="2616613">(</span><span class="ident" id="2616614">err</span>&nbsp;<span class="builtintype" id="2616618">error</span><span class="op" id="2616623">)</span>&nbsp;<span class="op" id="2616625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616628">if</span>&nbsp;<span class="builtinfunc" id="2616631">len</span><span class="op" id="2616634">(</span><span class="ident" id="2616635">p</span><span class="op" id="2616636">)</span>&nbsp;<span class="op" id="2616638">!=</span>&nbsp;<span class="num" id="2616641">2</span>&nbsp;<span class="op" id="2616643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616647">return</span>&nbsp;<span class="ident" id="2616654">EINVAL</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2616662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616665">var</span>&nbsp;<span class="ident" id="2616669">pp</span>&nbsp;<span class="op" id="2616672">[</span><span class="num" id="2616673">2</span><span class="op" id="2616674">]</span><span class="ident" id="2616675">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616683">err</span>&nbsp;<span class="op" id="2616687">=</span>&nbsp;<span class="ident" id="2616689">pipe2</span><span class="op" id="2616694">(</span><span class="op" id="2616695">&amp;</span><span class="ident" id="2616696">pp</span><span class="op" id="2616698">,</span>&nbsp;<span class="ident" id="2616700">flags</span><span class="op" id="2616705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616708">p</span><span class="op" id="2616709">[</span><span class="num" id="2616710">0</span><span class="op" id="2616711">]</span>&nbsp;<span class="op" id="2616713">=</span>&nbsp;<span class="builtintype" id="2616715">int</span><span class="op" id="2616718">(</span><span class="ident" id="2616719">pp</span><span class="op" id="2616721">[</span><span class="num" id="2616722">0</span><span class="op" id="2616723">]</span><span class="op" id="2616724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616727">p</span><span class="op" id="2616728">[</span><span class="num" id="2616729">1</span><span class="op" id="2616730">]</span>&nbsp;<span class="op" id="2616732">=</span>&nbsp;<span class="builtintype" id="2616734">int</span><span class="op" id="2616737">(</span><span class="ident" id="2616738">pp</span><span class="op" id="2616740">[</span><span class="num" id="2616741">1</span><span class="op" id="2616742">]</span><span class="op" id="2616743">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616746">return</span><br>
<span class="lineno"></span><span class="op" id="2616753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2616756">//sys&nbsp;&nbsp;&nbsp;&nbsputimes(path&nbsp;string,&nbsp;times&nbsp;*[2]Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="2616814">func</span>&nbsp;<span class="ident" id="2616819">Utimes</span><span class="op" id="2616825">(</span><span class="ident" id="2616826">path</span>&nbsp;<span class="builtintype" id="2616831">string</span><span class="op" id="2616837">,</span>&nbsp;<span class="ident" id="2616839">tv</span>&nbsp;<span class="op" id="2616842">[</span><span class="op" id="2616843">]</span><span class="ident" id="2616844">Timeval</span><span class="op" id="2616851">)</span>&nbsp;<span class="op" id="2616853">(</span><span class="ident" id="2616854">err</span>&nbsp;<span class="builtintype" id="2616858">error</span><span class="op" id="2616863">)</span>&nbsp;<span class="op" id="2616865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616868">if</span>&nbsp;<span class="builtinfunc" id="2616871">len</span><span class="op" id="2616874">(</span><span class="ident" id="2616875">tv</span><span class="op" id="2616877">)</span>&nbsp;<span class="op" id="2616879">!=</span>&nbsp;<span class="num" id="2616882">2</span>&nbsp;<span class="op" id="2616884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616888">return</span>&nbsp;<span class="ident" id="2616895">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2616903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616906">return</span>&nbsp;<span class="ident" id="2616913">utimes</span><span class="op" id="2616919">(</span><span class="ident" id="2616920">path</span><span class="op" id="2616924">,</span>&nbsp;<span class="op" id="2616926">(</span><span class="op" id="2616927">*</span><span class="op" id="2616928">[</span><span class="num" id="2616929">2</span><span class="op" id="2616930">]</span><span class="ident" id="2616931">Timeval</span><span class="op" id="2616938">)</span><span class="op" id="2616939">(</span><span class="ident" id="2616940">unsafe</span><span class="op" id="2616946">.</span><span class="ident" id="2616947">Pointer</span><span class="op" id="2616954">(</span><span class="op" id="2616955">&amp;</span><span class="ident" id="2616956">tv</span><span class="op" id="2616958">[</span><span class="num" id="2616959">0</span><span class="op" id="2616960">]</span><span class="op" id="2616961">)</span><span class="op" id="2616962">)</span><span class="op" id="2616963">)</span><br>
<span class="lineno">65</span><span class="op" id="2616965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2616968">//sys&nbsp;&nbsp;&nbsp;&nbsputimensat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;times&nbsp;*[2]Timespec)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2617041">func</span>&nbsp;<span class="ident" id="2617046">UtimesNano</span><span class="op" id="2617056">(</span><span class="ident" id="2617057">path</span>&nbsp;<span class="builtintype" id="2617062">string</span><span class="op" id="2617068">,</span>&nbsp;<span class="ident" id="2617070">ts</span>&nbsp;<span class="op" id="2617073">[</span><span class="op" id="2617074">]</span><span class="ident" id="2617075">Timespec</span><span class="op" id="2617083">)</span>&nbsp;<span class="op" id="2617085">(</span><span class="ident" id="2617086">err</span>&nbsp;<span class="builtintype" id="2617090">error</span><span class="op" id="2617095">)</span>&nbsp;<span class="op" id="2617097">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617100">if</span>&nbsp;<span class="builtinfunc" id="2617103">len</span><span class="op" id="2617106">(</span><span class="ident" id="2617107">ts</span><span class="op" id="2617109">)</span>&nbsp;<span class="op" id="2617111">!=</span>&nbsp;<span class="num" id="2617114">2</span>&nbsp;<span class="op" id="2617116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617120">return</span>&nbsp;<span class="ident" id="2617127">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2617135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2617138">err</span>&nbsp;<span class="op" id="2617142">=</span>&nbsp;<span class="ident" id="2617144">utimensat</span><span class="op" id="2617153">(</span><span class="ident" id="2617154">_AT_FDCWD</span><span class="op" id="2617163">,</span>&nbsp;<span class="ident" id="2617165">path</span><span class="op" id="2617169">,</span>&nbsp;<span class="op" id="2617171">(</span><span class="op" id="2617172">*</span><span class="op" id="2617173">[</span><span class="num" id="2617174">2</span><span class="op" id="2617175">]</span><span class="ident" id="2617176">Timespec</span><span class="op" id="2617184">)</span><span class="op" id="2617185">(</span><span class="ident" id="2617186">unsafe</span><span class="op" id="2617192">.</span><span class="ident" id="2617193">Pointer</span><span class="op" id="2617200">(</span><span class="op" id="2617201">&amp;</span><span class="ident" id="2617202">ts</span><span class="op" id="2617204">[</span><span class="num" id="2617205">0</span><span class="op" id="2617206">]</span><span class="op" id="2617207">)</span><span class="op" id="2617208">)</span><span class="op" id="2617209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617212">if</span>&nbsp;<span class="ident" id="2617215">err</span>&nbsp;<span class="op" id="2617219">!=</span>&nbsp;<span class="ident" id="2617222">ENOSYS</span>&nbsp;<span class="op" id="2617229">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617233">return</span>&nbsp;<span class="ident" id="2617240">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2617245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2617248">//&nbsp;If&nbsp;the&nbsp;utimensat&nbsp;syscall&nbsp;isn&#39;t&nbsp;available&nbsp;(utimensat&nbsp;was&nbsp;added&nbsp;to&nbsp;Linux</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2617323">//&nbsp;in&nbsp;2.6.22,&nbsp;Released,&nbsp;8&nbsp;July&nbsp;2007)&nbsp;then&nbsp;fall&nbsp;back&nbsp;to&nbsp;utimes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617386">var</span>&nbsp;<span class="ident" id="2617390">tv</span>&nbsp;<span class="op" id="2617393">[</span><span class="num" id="2617394">2</span><span class="op" id="2617395">]</span><span class="ident" id="2617396">Timeval</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617405">for</span>&nbsp;<span class="ident" id="2617409">i</span>&nbsp;<span class="op" id="2617411">:=</span>&nbsp;<span class="num" id="2617414">0</span><span class="op" id="2617415">;</span>&nbsp;<span class="ident" id="2617417">i</span>&nbsp;<span class="op" id="2617419">&lt;</span>&nbsp;<span class="num" id="2617421">2</span><span class="op" id="2617422">;</span>&nbsp;<span class="ident" id="2617424">i</span><span class="op" id="2617425">++</span>&nbsp;<span class="op" id="2617428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2617432">tv</span><span class="op" id="2617434">[</span><span class="ident" id="2617435">i</span><span class="op" id="2617436">]</span><span class="op" id="2617437">.</span><span class="ident" id="2617438">Sec</span>&nbsp;<span class="op" id="2617442">=</span>&nbsp;<span class="ident" id="2617444">ts</span><span class="op" id="2617446">[</span><span class="ident" id="2617447">i</span><span class="op" id="2617448">]</span><span class="op" id="2617449">.</span><span class="ident" id="2617450">Sec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2617456">tv</span><span class="op" id="2617458">[</span><span class="ident" id="2617459">i</span><span class="op" id="2617460">]</span><span class="op" id="2617461">.</span><span class="ident" id="2617462">Usec</span>&nbsp;<span class="op" id="2617467">=</span>&nbsp;<span class="ident" id="2617469">ts</span><span class="op" id="2617471">[</span><span class="ident" id="2617472">i</span><span class="op" id="2617473">]</span><span class="op" id="2617474">.</span><span class="ident" id="2617475">Nsec</span>&nbsp;<span class="op" id="2617480">/</span>&nbsp;<span class="num" id="2617482">1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2617488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617491">return</span>&nbsp;<span class="ident" id="2617498">utimes</span><span class="op" id="2617504">(</span><span class="ident" id="2617505">path</span><span class="op" id="2617509">,</span>&nbsp;<span class="op" id="2617511">(</span><span class="op" id="2617512">*</span><span class="op" id="2617513">[</span><span class="num" id="2617514">2</span><span class="op" id="2617515">]</span><span class="ident" id="2617516">Timeval</span><span class="op" id="2617523">)</span><span class="op" id="2617524">(</span><span class="ident" id="2617525">unsafe</span><span class="op" id="2617531">.</span><span class="ident" id="2617532">Pointer</span><span class="op" id="2617539">(</span><span class="op" id="2617540">&amp;</span><span class="ident" id="2617541">tv</span><span class="op" id="2617543">[</span><span class="num" id="2617544">0</span><span class="op" id="2617545">]</span><span class="op" id="2617546">)</span><span class="op" id="2617547">)</span><span class="op" id="2617548">)</span><br>
<span class="lineno">85</span><span class="op" id="2617550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2617553">//sys&nbsp;&nbsp;&nbsp;&nbspfutimesat(dirfd&nbsp;int,&nbsp;path&nbsp;*byte,&nbsp;times&nbsp;*[2]Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2617624">func</span>&nbsp;<span class="ident" id="2617629">Futimesat</span><span class="op" id="2617638">(</span><span class="ident" id="2617639">dirfd</span>&nbsp;<span class="builtintype" id="2617645">int</span><span class="op" id="2617648">,</span>&nbsp;<span class="ident" id="2617650">path</span>&nbsp;<span class="builtintype" id="2617655">string</span><span class="op" id="2617661">,</span>&nbsp;<span class="ident" id="2617663">tv</span>&nbsp;<span class="op" id="2617666">[</span><span class="op" id="2617667">]</span><span class="ident" id="2617668">Timeval</span><span class="op" id="2617675">)</span>&nbsp;<span class="op" id="2617677">(</span><span class="ident" id="2617678">err</span>&nbsp;<span class="builtintype" id="2617682">error</span><span class="op" id="2617687">)</span>&nbsp;<span class="op" id="2617689">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617692">if</span>&nbsp;<span class="builtinfunc" id="2617695">len</span><span class="op" id="2617698">(</span><span class="ident" id="2617699">tv</span><span class="op" id="2617701">)</span>&nbsp;<span class="op" id="2617703">!=</span>&nbsp;<span class="num" id="2617706">2</span>&nbsp;<span class="op" id="2617708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617712">return</span>&nbsp;<span class="ident" id="2617719">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2617727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2617730">pathp</span><span class="op" id="2617735">,</span>&nbsp;<span class="ident" id="2617737">err</span>&nbsp;<span class="op" id="2617741">:=</span>&nbsp;<span class="ident" id="2617744">BytePtrFromString</span><span class="op" id="2617761">(</span><span class="ident" id="2617762">path</span><span class="op" id="2617766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617769">if</span>&nbsp;<span class="ident" id="2617772">err</span>&nbsp;<span class="op" id="2617776">!=</span>&nbsp;<span class="ident" id="2617779">nil</span>&nbsp;<span class="op" id="2617783">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617787">return</span>&nbsp;<span class="ident" id="2617794">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2617799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2617802">err</span>&nbsp;<span class="op" id="2617806">=</span>&nbsp;<span class="ident" id="2617808">futimesat</span><span class="op" id="2617817">(</span><span class="ident" id="2617818">dirfd</span><span class="op" id="2617823">,</span>&nbsp;<span class="ident" id="2617825">pathp</span><span class="op" id="2617830">,</span>&nbsp;<span class="op" id="2617832">(</span><span class="op" id="2617833">*</span><span class="op" id="2617834">[</span><span class="num" id="2617835">2</span><span class="op" id="2617836">]</span><span class="ident" id="2617837">Timeval</span><span class="op" id="2617844">)</span><span class="op" id="2617845">(</span><span class="ident" id="2617846">unsafe</span><span class="op" id="2617852">.</span><span class="ident" id="2617853">Pointer</span><span class="op" id="2617860">(</span><span class="op" id="2617861">&amp;</span><span class="ident" id="2617862">tv</span><span class="op" id="2617864">[</span><span class="num" id="2617865">0</span><span class="op" id="2617866">]</span><span class="op" id="2617867">)</span><span class="op" id="2617868">)</span><span class="op" id="2617869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2617872">use</span><span class="op" id="2617875">(</span><span class="ident" id="2617876">unsafe</span><span class="op" id="2617882">.</span><span class="ident" id="2617883">Pointer</span><span class="op" id="2617890">(</span><span class="ident" id="2617891">pathp</span><span class="op" id="2617896">)</span><span class="op" id="2617897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617900">return</span>&nbsp;<span class="ident" id="2617907">err</span><br>
<span class="lineno">100</span><span class="op" id="2617911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2617914">func</span>&nbsp;<span class="ident" id="2617919">Futimes</span><span class="op" id="2617926">(</span><span class="ident" id="2617927">fd</span>&nbsp;<span class="builtintype" id="2617930">int</span><span class="op" id="2617933">,</span>&nbsp;<span class="ident" id="2617935">tv</span>&nbsp;<span class="op" id="2617938">[</span><span class="op" id="2617939">]</span><span class="ident" id="2617940">Timeval</span><span class="op" id="2617947">)</span>&nbsp;<span class="op" id="2617949">(</span><span class="ident" id="2617950">err</span>&nbsp;<span class="builtintype" id="2617954">error</span><span class="op" id="2617959">)</span>&nbsp;<span class="op" id="2617961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2617964">//&nbsp;Believe&nbsp;it&nbsp;or&nbsp;not,&nbsp;this&nbsp;is&nbsp;the&nbsp;best&nbsp;we&nbsp;can&nbsp;do&nbsp;on&nbsp;Linux</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2618023">//&nbsp;(and&nbsp;is&nbsp;what&nbsp;glibc&nbsp;does).</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618053">return</span>&nbsp;<span class="ident" id="2618060">Utimes</span><span class="op" id="2618066">(</span><span class="string" id="2618067">&#34;/proc/self/fd/&#34;</span><span class="op" id="2618083">+</span><span class="ident" id="2618084">itoa</span><span class="op" id="2618088">(</span><span class="ident" id="2618089">fd</span><span class="op" id="2618091">)</span><span class="op" id="2618092">,</span>&nbsp;<span class="ident" id="2618094">tv</span><span class="op" id="2618096">)</span><br>
<span class="lineno"></span><span class="op" id="2618098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2618101">const</span>&nbsp;<span class="ident" id="2618107">ImplementsGetwd</span>&nbsp;<span class="op" id="2618123">=</span>&nbsp;<span class="builtintype" id="2618125">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="2618131">//sys&nbsp;&nbsp;&nbsp;&nbspGetcwd(buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2618176">func</span>&nbsp;<span class="ident" id="2618181">Getwd</span><span class="op" id="2618186">(</span><span class="op" id="2618187">)</span>&nbsp;<span class="op" id="2618189">(</span><span class="ident" id="2618190">wd</span>&nbsp;<span class="builtintype" id="2618193">string</span><span class="op" id="2618199">,</span>&nbsp;<span class="ident" id="2618201">err</span>&nbsp;<span class="builtintype" id="2618205">error</span><span class="op" id="2618210">)</span>&nbsp;<span class="op" id="2618212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618215">var</span>&nbsp;<span class="ident" id="2618219">buf</span>&nbsp;<span class="op" id="2618223">[</span><span class="ident" id="2618224">PathMax</span><span class="op" id="2618231">]</span><span class="builtintype" id="2618232">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2618238">n</span><span class="op" id="2618239">,</span>&nbsp;<span class="ident" id="2618241">err</span>&nbsp;<span class="op" id="2618245">:=</span>&nbsp;<span class="ident" id="2618248">Getcwd</span><span class="op" id="2618254">(</span><span class="ident" id="2618255">buf</span><span class="op" id="2618258">[</span><span class="num" id="2618259">0</span><span class="op" id="2618260">:</span><span class="op" id="2618261">]</span><span class="op" id="2618262">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618265">if</span>&nbsp;<span class="ident" id="2618268">err</span>&nbsp;<span class="op" id="2618272">!=</span>&nbsp;<span class="ident" id="2618275">nil</span>&nbsp;<span class="op" id="2618279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618283">return</span>&nbsp;<span class="string" id="2618290">&#34;&#34;</span><span class="op" id="2618292">,</span>&nbsp;<span class="ident" id="2618294">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2618299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2618302">//&nbsp;Getcwd&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;to&nbsp;buf,&nbsp;including&nbsp;the&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618376">if</span>&nbsp;<span class="ident" id="2618379">n</span>&nbsp;<span class="op" id="2618381">&lt;</span>&nbsp;<span class="num" id="2618383">1</span>&nbsp;<span class="op" id="2618385">||</span>&nbsp;<span class="ident" id="2618388">n</span>&nbsp;<span class="op" id="2618390">&gt;</span>&nbsp;<span class="builtinfunc" id="2618392">len</span><span class="op" id="2618395">(</span><span class="ident" id="2618396">buf</span><span class="op" id="2618399">)</span>&nbsp;<span class="op" id="2618401">||</span>&nbsp;<span class="ident" id="2618404">buf</span><span class="op" id="2618407">[</span><span class="ident" id="2618408">n</span><span class="op" id="2618409">-</span><span class="num" id="2618410">1</span><span class="op" id="2618411">]</span>&nbsp;<span class="op" id="2618413">!=</span>&nbsp;<span class="num" id="2618416">0</span>&nbsp;<span class="op" id="2618418">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618422">return</span>&nbsp;<span class="string" id="2618429">&#34;&#34;</span><span class="op" id="2618431">,</span>&nbsp;<span class="ident" id="2618433">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2618441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618444">return</span>&nbsp;<span class="builtintype" id="2618451">string</span><span class="op" id="2618457">(</span><span class="ident" id="2618458">buf</span><span class="op" id="2618461">[</span><span class="num" id="2618462">0</span>&nbsp;<span class="op" id="2618464">:</span>&nbsp;<span class="ident" id="2618466">n</span><span class="op" id="2618467">-</span><span class="num" id="2618468">1</span><span class="op" id="2618469">]</span><span class="op" id="2618470">)</span><span class="op" id="2618471">,</span>&nbsp;<span class="ident" id="2618473">nil</span><br>
<span class="lineno"></span><span class="op" id="2618477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="2618480">func</span>&nbsp;<span class="ident" id="2618485">Getgroups</span><span class="op" id="2618494">(</span><span class="op" id="2618495">)</span>&nbsp;<span class="op" id="2618497">(</span><span class="ident" id="2618498">gids</span>&nbsp;<span class="op" id="2618503">[</span><span class="op" id="2618504">]</span><span class="builtintype" id="2618505">int</span><span class="op" id="2618508">,</span>&nbsp;<span class="ident" id="2618510">err</span>&nbsp;<span class="builtintype" id="2618514">error</span><span class="op" id="2618519">)</span>&nbsp;<span class="op" id="2618521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2618524">n</span><span class="op" id="2618525">,</span>&nbsp;<span class="ident" id="2618527">err</span>&nbsp;<span class="op" id="2618531">:=</span>&nbsp;<span class="ident" id="2618534">getgroups</span><span class="op" id="2618543">(</span><span class="num" id="2618544">0</span><span class="op" id="2618545">,</span>&nbsp;<span class="ident" id="2618547">nil</span><span class="op" id="2618550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618553">if</span>&nbsp;<span class="ident" id="2618556">err</span>&nbsp;<span class="op" id="2618560">!=</span>&nbsp;<span class="ident" id="2618563">nil</span>&nbsp;<span class="op" id="2618567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618571">return</span>&nbsp;<span class="ident" id="2618578">nil</span><span class="op" id="2618581">,</span>&nbsp;<span class="ident" id="2618583">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2618588">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618591">if</span>&nbsp;<span class="ident" id="2618594">n</span>&nbsp;<span class="op" id="2618596">==</span>&nbsp;<span class="num" id="2618599">0</span>&nbsp;<span class="op" id="2618601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618605">return</span>&nbsp;<span class="ident" id="2618612">nil</span><span class="op" id="2618615">,</span>&nbsp;<span class="ident" id="2618617">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2618622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2618626">//&nbsp;Sanity&nbsp;check&nbsp;group&nbsp;count.&nbsp;&nbsp;Max&nbsp;is&nbsp;1&lt;&lt;16&nbsp;on&nbsp;Linux.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618680">if</span>&nbsp;<span class="ident" id="2618683">n</span>&nbsp;<span class="op" id="2618685">&lt;</span>&nbsp;<span class="num" id="2618687">0</span>&nbsp;<span class="op" id="2618689">||</span>&nbsp;<span class="ident" id="2618692">n</span>&nbsp;<span class="op" id="2618694">&gt;</span>&nbsp;<span class="num" id="2618696">1</span><span class="op" id="2618697">&lt;&lt;</span><span class="num" id="2618699">20</span>&nbsp;<span class="op" id="2618702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618706">return</span>&nbsp;<span class="ident" id="2618713">nil</span><span class="op" id="2618716">,</span>&nbsp;<span class="ident" id="2618718">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2618726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2618730">a</span>&nbsp;<span class="op" id="2618732">:=</span>&nbsp;<span class="builtinfunc" id="2618735">make</span><span class="op" id="2618739">(</span><span class="op" id="2618740">[</span><span class="op" id="2618741">]</span><span class="ident" id="2618742">_Gid_t</span><span class="op" id="2618748">,</span>&nbsp;<span class="ident" id="2618750">n</span><span class="op" id="2618751">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2618754">n</span><span class="op" id="2618755">,</span>&nbsp;<span class="ident" id="2618757">err</span>&nbsp;<span class="op" id="2618761">=</span>&nbsp;<span class="ident" id="2618763">getgroups</span><span class="op" id="2618772">(</span><span class="ident" id="2618773">n</span><span class="op" id="2618774">,</span>&nbsp;<span class="op" id="2618776">&amp;</span><span class="ident" id="2618777">a</span><span class="op" id="2618778">[</span><span class="num" id="2618779">0</span><span class="op" id="2618780">]</span><span class="op" id="2618781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618784">if</span>&nbsp;<span class="ident" id="2618787">err</span>&nbsp;<span class="op" id="2618791">!=</span>&nbsp;<span class="ident" id="2618794">nil</span>&nbsp;<span class="op" id="2618798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618802">return</span>&nbsp;<span class="ident" id="2618809">nil</span><span class="op" id="2618812">,</span>&nbsp;<span class="ident" id="2618814">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2618819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2618822">gids</span>&nbsp;<span class="op" id="2618827">=</span>&nbsp;<span class="builtinfunc" id="2618829">make</span><span class="op" id="2618833">(</span><span class="op" id="2618834">[</span><span class="op" id="2618835">]</span><span class="builtintype" id="2618836">int</span><span class="op" id="2618839">,</span>&nbsp;<span class="ident" id="2618841">n</span><span class="op" id="2618842">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618845">for</span>&nbsp;<span class="ident" id="2618849">i</span><span class="op" id="2618850">,</span>&nbsp;<span class="ident" id="2618852">v</span>&nbsp;<span class="op" id="2618854">:=</span>&nbsp;<span class="keyword" id="2618857">range</span>&nbsp;<span class="ident" id="2618863">a</span><span class="op" id="2618864">[</span><span class="num" id="2618865">0</span><span class="op" id="2618866">:</span><span class="ident" id="2618867">n</span><span class="op" id="2618868">]</span>&nbsp;<span class="op" id="2618870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2618874">gids</span><span class="op" id="2618878">[</span><span class="ident" id="2618879">i</span><span class="op" id="2618880">]</span>&nbsp;<span class="op" id="2618882">=</span>&nbsp;<span class="builtintype" id="2618884">int</span><span class="op" id="2618887">(</span><span class="ident" id="2618888">v</span><span class="op" id="2618889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2618892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618895">return</span><br>
<span class="lineno"></span><span class="op" id="2618902">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="2618905">func</span>&nbsp;<span class="ident" id="2618910">Setgroups</span><span class="op" id="2618919">(</span><span class="ident" id="2618920">gids</span>&nbsp;<span class="op" id="2618925">[</span><span class="op" id="2618926">]</span><span class="builtintype" id="2618927">int</span><span class="op" id="2618930">)</span>&nbsp;<span class="op" id="2618932">(</span><span class="ident" id="2618933">err</span>&nbsp;<span class="builtintype" id="2618937">error</span><span class="op" id="2618942">)</span>&nbsp;<span class="op" id="2618944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618947">if</span>&nbsp;<span class="builtinfunc" id="2618950">len</span><span class="op" id="2618953">(</span><span class="ident" id="2618954">gids</span><span class="op" id="2618958">)</span>&nbsp;<span class="op" id="2618960">==</span>&nbsp;<span class="num" id="2618963">0</span>&nbsp;<span class="op" id="2618965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618969">return</span>&nbsp;<span class="ident" id="2618976">setgroups</span><span class="op" id="2618985">(</span><span class="num" id="2618986">0</span><span class="op" id="2618987">,</span>&nbsp;<span class="ident" id="2618989">nil</span><span class="op" id="2618992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2618995">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2618999">a</span>&nbsp;<span class="op" id="2619001">:=</span>&nbsp;<span class="builtinfunc" id="2619004">make</span><span class="op" id="2619008">(</span><span class="op" id="2619009">[</span><span class="op" id="2619010">]</span><span class="ident" id="2619011">_Gid_t</span><span class="op" id="2619017">,</span>&nbsp;<span class="builtinfunc" id="2619019">len</span><span class="op" id="2619022">(</span><span class="ident" id="2619023">gids</span><span class="op" id="2619027">)</span><span class="op" id="2619028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2619031">for</span>&nbsp;<span class="ident" id="2619035">i</span><span class="op" id="2619036">,</span>&nbsp;<span class="ident" id="2619038">v</span>&nbsp;<span class="op" id="2619040">:=</span>&nbsp;<span class="keyword" id="2619043">range</span>&nbsp;<span class="ident" id="2619049">gids</span>&nbsp;<span class="op" id="2619054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2619058">a</span><span class="op" id="2619059">[</span><span class="ident" id="2619060">i</span><span class="op" id="2619061">]</span>&nbsp;<span class="op" id="2619063">=</span>&nbsp;<span class="ident" id="2619065">_Gid_t</span><span class="op" id="2619071">(</span><span class="ident" id="2619072">v</span><span class="op" id="2619073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2619076">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2619079">return</span>&nbsp;<span class="ident" id="2619086">setgroups</span><span class="op" id="2619095">(</span><span class="builtinfunc" id="2619096">len</span><span class="op" id="2619099">(</span><span class="ident" id="2619100">a</span><span class="op" id="2619101">)</span><span class="op" id="2619102">,</span>&nbsp;<span class="op" id="2619104">&amp;</span><span class="ident" id="2619105">a</span><span class="op" id="2619106">[</span><span class="num" id="2619107">0</span><span class="op" id="2619108">]</span><span class="op" id="2619109">)</span><br>
<span class="lineno"></span><span class="op" id="2619111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2619114">type</span>&nbsp;<span class="ident" id="2619119">WaitStatus</span>&nbsp;<span class="builtintype" id="2619130">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="2619138">//&nbsp;Wait&nbsp;status&nbsp;is&nbsp;7&nbsp;bits&nbsp;at&nbsp;bottom,&nbsp;either&nbsp;0&nbsp;(exited),</span><br>
<span class="lineno"></span><span class="comment" id="2619193">//&nbsp;0x7F&nbsp;(stopped),&nbsp;or&nbsp;a&nbsp;signal&nbsp;number&nbsp;that&nbsp;caused&nbsp;an&nbsp;exit.</span><br>
<span class="lineno"></span><span class="comment" id="2619252">//&nbsp;The&nbsp;0x80&nbsp;bit&nbsp;is&nbsp;whether&nbsp;there&nbsp;was&nbsp;a&nbsp;core&nbsp;dump.</span><br>
<span class="lineno"></span><span class="comment" id="2619302">//&nbsp;An&nbsp;extra&nbsp;number&nbsp;(exit&nbsp;code,&nbsp;signal&nbsp;causing&nbsp;a&nbsp;stop)</span><br>
<span class="lineno"></span><span class="comment" id="2619356">//&nbsp;is&nbsp;in&nbsp;the&nbsp;high&nbsp;bits.&nbsp;&nbsp;At&nbsp;least&nbsp;that&#39;s&nbsp;the&nbsp;idea.</span><br>
<span class="lineno">170</span><span class="comment" id="2619407">//&nbsp;There&nbsp;are&nbsp;various&nbsp;irregularities.&nbsp;&nbsp;For&nbsp;example,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2619462">//&nbsp;&#34;continued&#34;&nbsp;status&nbsp;is&nbsp;0xFFFF,&nbsp;distinguishing&nbsp;itself</span><br>
<span class="lineno"></span><span class="comment" id="2619517">//&nbsp;from&nbsp;stopped&nbsp;via&nbsp;the&nbsp;core&nbsp;dump&nbsp;bit.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2619557">const</span>&nbsp;<span class="op" id="2619563">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2619566">mask</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2619574">=</span>&nbsp;<span class="num" id="2619576">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2619582">core</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2619590">=</span>&nbsp;<span class="num" id="2619592">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2619598">exited</span>&nbsp;&nbsp;<span class="op" id="2619606">=</span>&nbsp;<span class="num" id="2619608">0x00</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2619614">stopped</span>&nbsp;<span class="op" id="2619622">=</span>&nbsp;<span class="num" id="2619624">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2619630">shift</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2619638">=</span>&nbsp;<span class="num" id="2619640">8</span><br>
<span class="lineno">180</span><span class="op" id="2619642">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2619645">func</span>&nbsp;<span class="op" id="2619650">(</span><span class="ident" id="2619651">w</span>&nbsp;<span class="ident" id="2619653">WaitStatus</span><span class="op" id="2619663">)</span>&nbsp;<span class="ident" id="2619665">Exited</span><span class="op" id="2619671">(</span><span class="op" id="2619672">)</span>&nbsp;<span class="builtintype" id="2619674">bool</span>&nbsp;<span class="op" id="2619679">{</span>&nbsp;<span class="keyword" id="2619681">return</span>&nbsp;<span class="ident" id="2619688">w</span><span class="op" id="2619689">&amp;</span><span class="ident" id="2619690">mask</span>&nbsp;<span class="op" id="2619695">==</span>&nbsp;<span class="ident" id="2619698">exited</span>&nbsp;<span class="op" id="2619705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2619708">func</span>&nbsp;<span class="op" id="2619713">(</span><span class="ident" id="2619714">w</span>&nbsp;<span class="ident" id="2619716">WaitStatus</span><span class="op" id="2619726">)</span>&nbsp;<span class="ident" id="2619728">Signaled</span><span class="op" id="2619736">(</span><span class="op" id="2619737">)</span>&nbsp;<span class="builtintype" id="2619739">bool</span>&nbsp;<span class="op" id="2619744">{</span>&nbsp;<span class="keyword" id="2619746">return</span>&nbsp;<span class="ident" id="2619753">w</span><span class="op" id="2619754">&amp;</span><span class="ident" id="2619755">mask</span>&nbsp;<span class="op" id="2619760">!=</span>&nbsp;<span class="ident" id="2619763">stopped</span>&nbsp;<span class="op" id="2619771">&amp;&amp;</span>&nbsp;<span class="ident" id="2619774">w</span><span class="op" id="2619775">&amp;</span><span class="ident" id="2619776">mask</span>&nbsp;<span class="op" id="2619781">!=</span>&nbsp;<span class="ident" id="2619784">exited</span>&nbsp;<span class="op" id="2619791">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="2619794">func</span>&nbsp;<span class="op" id="2619799">(</span><span class="ident" id="2619800">w</span>&nbsp;<span class="ident" id="2619802">WaitStatus</span><span class="op" id="2619812">)</span>&nbsp;<span class="ident" id="2619814">Stopped</span><span class="op" id="2619821">(</span><span class="op" id="2619822">)</span>&nbsp;<span class="builtintype" id="2619824">bool</span>&nbsp;<span class="op" id="2619829">{</span>&nbsp;<span class="keyword" id="2619831">return</span>&nbsp;<span class="ident" id="2619838">w</span><span class="op" id="2619839">&amp;</span><span class="num" id="2619840">0xFF</span>&nbsp;<span class="op" id="2619845">==</span>&nbsp;<span class="ident" id="2619848">stopped</span>&nbsp;<span class="op" id="2619856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2619859">func</span>&nbsp;<span class="op" id="2619864">(</span><span class="ident" id="2619865">w</span>&nbsp;<span class="ident" id="2619867">WaitStatus</span><span class="op" id="2619877">)</span>&nbsp;<span class="ident" id="2619879">Continued</span><span class="op" id="2619888">(</span><span class="op" id="2619889">)</span>&nbsp;<span class="builtintype" id="2619891">bool</span>&nbsp;<span class="op" id="2619896">{</span>&nbsp;<span class="keyword" id="2619898">return</span>&nbsp;<span class="ident" id="2619905">w</span>&nbsp;<span class="op" id="2619907">==</span>&nbsp;<span class="num" id="2619910">0xFFFF</span>&nbsp;<span class="op" id="2619917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="2619920">func</span>&nbsp;<span class="op" id="2619925">(</span><span class="ident" id="2619926">w</span>&nbsp;<span class="ident" id="2619928">WaitStatus</span><span class="op" id="2619938">)</span>&nbsp;<span class="ident" id="2619940">CoreDump</span><span class="op" id="2619948">(</span><span class="op" id="2619949">)</span>&nbsp;<span class="builtintype" id="2619951">bool</span>&nbsp;<span class="op" id="2619956">{</span>&nbsp;<span class="keyword" id="2619958">return</span>&nbsp;<span class="ident" id="2619965">w</span><span class="op" id="2619966">.</span><span class="ident" id="2619967">Signaled</span><span class="op" id="2619975">(</span><span class="op" id="2619976">)</span>&nbsp;<span class="op" id="2619978">&amp;&amp;</span>&nbsp;<span class="ident" id="2619981">w</span><span class="op" id="2619982">&amp;</span><span class="ident" id="2619983">core</span>&nbsp;<span class="op" id="2619988">!=</span>&nbsp;<span class="num" id="2619991">0</span>&nbsp;<span class="op" id="2619993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2619996">func</span>&nbsp;<span class="op" id="2620001">(</span><span class="ident" id="2620002">w</span>&nbsp;<span class="ident" id="2620004">WaitStatus</span><span class="op" id="2620014">)</span>&nbsp;<span class="ident" id="2620016">ExitStatus</span><span class="op" id="2620026">(</span><span class="op" id="2620027">)</span>&nbsp;<span class="builtintype" id="2620029">int</span>&nbsp;<span class="op" id="2620033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620036">if</span>&nbsp;<span class="op" id="2620039">!</span><span class="ident" id="2620040">w</span><span class="op" id="2620041">.</span><span class="ident" id="2620042">Exited</span><span class="op" id="2620048">(</span><span class="op" id="2620049">)</span>&nbsp;<span class="op" id="2620051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620055">return</span>&nbsp;<span class="op" id="2620062">-</span><span class="num" id="2620063">1</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2620066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620069">return</span>&nbsp;<span class="builtintype" id="2620076">int</span><span class="op" id="2620079">(</span><span class="ident" id="2620080">w</span><span class="op" id="2620081">&gt;&gt;</span><span class="ident" id="2620083">shift</span><span class="op" id="2620088">)</span>&nbsp;<span class="op" id="2620090">&amp;</span>&nbsp;<span class="num" id="2620092">0xFF</span><br>
<span class="lineno"></span><span class="op" id="2620097">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2620100">func</span>&nbsp;<span class="op" id="2620105">(</span><span class="ident" id="2620106">w</span>&nbsp;<span class="ident" id="2620108">WaitStatus</span><span class="op" id="2620118">)</span>&nbsp;<span class="ident" id="2620120">Signal</span><span class="op" id="2620126">(</span><span class="op" id="2620127">)</span>&nbsp;<span class="ident" id="2620129">Signal</span>&nbsp;<span class="op" id="2620136">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620139">if</span>&nbsp;<span class="op" id="2620142">!</span><span class="ident" id="2620143">w</span><span class="op" id="2620144">.</span><span class="ident" id="2620145">Signaled</span><span class="op" id="2620153">(</span><span class="op" id="2620154">)</span>&nbsp;<span class="op" id="2620156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620160">return</span>&nbsp;<span class="op" id="2620167">-</span><span class="num" id="2620168">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2620171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620174">return</span>&nbsp;<span class="ident" id="2620181">Signal</span><span class="op" id="2620187">(</span><span class="ident" id="2620188">w</span>&nbsp;<span class="op" id="2620190">&amp;</span>&nbsp;<span class="ident" id="2620192">mask</span><span class="op" id="2620196">)</span><br>
<span class="lineno"></span><span class="op" id="2620198">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="2620201">func</span>&nbsp;<span class="op" id="2620206">(</span><span class="ident" id="2620207">w</span>&nbsp;<span class="ident" id="2620209">WaitStatus</span><span class="op" id="2620219">)</span>&nbsp;<span class="ident" id="2620221">StopSignal</span><span class="op" id="2620231">(</span><span class="op" id="2620232">)</span>&nbsp;<span class="ident" id="2620234">Signal</span>&nbsp;<span class="op" id="2620241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620244">if</span>&nbsp;<span class="op" id="2620247">!</span><span class="ident" id="2620248">w</span><span class="op" id="2620249">.</span><span class="ident" id="2620250">Stopped</span><span class="op" id="2620257">(</span><span class="op" id="2620258">)</span>&nbsp;<span class="op" id="2620260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620264">return</span>&nbsp;<span class="op" id="2620271">-</span><span class="num" id="2620272">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2620275">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620278">return</span>&nbsp;<span class="ident" id="2620285">Signal</span><span class="op" id="2620291">(</span><span class="ident" id="2620292">w</span><span class="op" id="2620293">&gt;&gt;</span><span class="ident" id="2620295">shift</span><span class="op" id="2620300">)</span>&nbsp;<span class="op" id="2620302">&amp;</span>&nbsp;<span class="num" id="2620304">0xFF</span><br>
<span class="lineno"></span><span class="op" id="2620309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2620312">func</span>&nbsp;<span class="op" id="2620317">(</span><span class="ident" id="2620318">w</span>&nbsp;<span class="ident" id="2620320">WaitStatus</span><span class="op" id="2620330">)</span>&nbsp;<span class="ident" id="2620332">TrapCause</span><span class="op" id="2620341">(</span><span class="op" id="2620342">)</span>&nbsp;<span class="builtintype" id="2620344">int</span>&nbsp;<span class="op" id="2620348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620351">if</span>&nbsp;<span class="ident" id="2620354">w</span><span class="op" id="2620355">.</span><span class="ident" id="2620356">StopSignal</span><span class="op" id="2620366">(</span><span class="op" id="2620367">)</span>&nbsp;<span class="op" id="2620369">!=</span>&nbsp;<span class="ident" id="2620372">SIGTRAP</span>&nbsp;<span class="op" id="2620380">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620384">return</span>&nbsp;<span class="op" id="2620391">-</span><span class="num" id="2620392">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2620395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620398">return</span>&nbsp;<span class="builtintype" id="2620405">int</span><span class="op" id="2620408">(</span><span class="ident" id="2620409">w</span><span class="op" id="2620410">&gt;&gt;</span><span class="ident" id="2620412">shift</span><span class="op" id="2620417">)</span>&nbsp;<span class="op" id="2620419">&gt;&gt;</span>&nbsp;<span class="num" id="2620422">8</span><br>
<span class="lineno"></span><span class="op" id="2620424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2620427">//sys&nbsp;&nbsp;&nbsp;&nbspwait4(pid&nbsp;int,&nbsp;wstatus&nbsp;*_C_int,&nbsp;options&nbsp;int,&nbsp;rusage&nbsp;*Rusage)&nbsp;(wpid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2620517">func</span>&nbsp;<span class="ident" id="2620522">Wait4</span><span class="op" id="2620527">(</span><span class="ident" id="2620528">pid</span>&nbsp;<span class="builtintype" id="2620532">int</span><span class="op" id="2620535">,</span>&nbsp;<span class="ident" id="2620537">wstatus</span>&nbsp;<span class="op" id="2620545">*</span><span class="ident" id="2620546">WaitStatus</span><span class="op" id="2620556">,</span>&nbsp;<span class="ident" id="2620558">options</span>&nbsp;<span class="builtintype" id="2620566">int</span><span class="op" id="2620569">,</span>&nbsp;<span class="ident" id="2620571">rusage</span>&nbsp;<span class="op" id="2620578">*</span><span class="ident" id="2620579">Rusage</span><span class="op" id="2620585">)</span>&nbsp;<span class="op" id="2620587">(</span><span class="ident" id="2620588">wpid</span>&nbsp;<span class="builtintype" id="2620593">int</span><span class="op" id="2620596">,</span>&nbsp;<span class="ident" id="2620598">err</span>&nbsp;<span class="builtintype" id="2620602">error</span><span class="op" id="2620607">)</span>&nbsp;<span class="op" id="2620609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620612">var</span>&nbsp;<span class="ident" id="2620616">status</span>&nbsp;<span class="ident" id="2620623">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620631">wpid</span><span class="op" id="2620635">,</span>&nbsp;<span class="ident" id="2620637">err</span>&nbsp;<span class="op" id="2620641">=</span>&nbsp;<span class="ident" id="2620643">wait4</span><span class="op" id="2620648">(</span><span class="ident" id="2620649">pid</span><span class="op" id="2620652">,</span>&nbsp;<span class="op" id="2620654">&amp;</span><span class="ident" id="2620655">status</span><span class="op" id="2620661">,</span>&nbsp;<span class="ident" id="2620663">options</span><span class="op" id="2620670">,</span>&nbsp;<span class="ident" id="2620672">rusage</span><span class="op" id="2620678">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620681">if</span>&nbsp;<span class="ident" id="2620684">wstatus</span>&nbsp;<span class="op" id="2620692">!=</span>&nbsp;<span class="ident" id="2620695">nil</span>&nbsp;<span class="op" id="2620699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2620703">*</span><span class="ident" id="2620704">wstatus</span>&nbsp;<span class="op" id="2620712">=</span>&nbsp;<span class="ident" id="2620714">WaitStatus</span><span class="op" id="2620724">(</span><span class="ident" id="2620725">status</span><span class="op" id="2620731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2620734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620737">return</span><br>
<span class="lineno"></span><span class="op" id="2620744">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="2620747">func</span>&nbsp;<span class="ident" id="2620752">Mkfifo</span><span class="op" id="2620758">(</span><span class="ident" id="2620759">path</span>&nbsp;<span class="builtintype" id="2620764">string</span><span class="op" id="2620770">,</span>&nbsp;<span class="ident" id="2620772">mode</span>&nbsp;<span class="builtintype" id="2620777">uint32</span><span class="op" id="2620783">)</span>&nbsp;<span class="op" id="2620785">(</span><span class="ident" id="2620786">err</span>&nbsp;<span class="builtintype" id="2620790">error</span><span class="op" id="2620795">)</span>&nbsp;<span class="op" id="2620797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620800">return</span>&nbsp;<span class="ident" id="2620807">Mknod</span><span class="op" id="2620812">(</span><span class="ident" id="2620813">path</span><span class="op" id="2620817">,</span>&nbsp;<span class="ident" id="2620819">mode</span><span class="op" id="2620823">|</span><span class="ident" id="2620824">S_IFIFO</span><span class="op" id="2620831">,</span>&nbsp;<span class="num" id="2620833">0</span><span class="op" id="2620834">)</span><br>
<span class="lineno"></span><span class="op" id="2620836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="2620839">func</span>&nbsp;<span class="op" id="2620844">(</span><span class="ident" id="2620845">sa</span>&nbsp;<span class="op" id="2620848">*</span><span class="ident" id="2620849">SockaddrInet4</span><span class="op" id="2620862">)</span>&nbsp;<span class="ident" id="2620864">sockaddr</span><span class="op" id="2620872">(</span><span class="op" id="2620873">)</span>&nbsp;<span class="op" id="2620875">(</span><span class="ident" id="2620876">unsafe</span><span class="op" id="2620882">.</span><span class="ident" id="2620883">Pointer</span><span class="op" id="2620890">,</span>&nbsp;<span class="ident" id="2620892">_Socklen</span><span class="op" id="2620900">,</span>&nbsp;<span class="builtintype" id="2620902">error</span><span class="op" id="2620907">)</span>&nbsp;<span class="op" id="2620909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620912">if</span>&nbsp;<span class="ident" id="2620915">sa</span><span class="op" id="2620917">.</span><span class="ident" id="2620918">Port</span>&nbsp;<span class="op" id="2620923">&lt;</span>&nbsp;<span class="num" id="2620925">0</span>&nbsp;<span class="op" id="2620927">||</span>&nbsp;<span class="ident" id="2620930">sa</span><span class="op" id="2620932">.</span><span class="ident" id="2620933">Port</span>&nbsp;<span class="op" id="2620938">&gt;</span>&nbsp;<span class="num" id="2620940">0xFFFF</span>&nbsp;<span class="op" id="2620947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2620951">return</span>&nbsp;<span class="ident" id="2620958">nil</span><span class="op" id="2620961">,</span>&nbsp;<span class="num" id="2620963">0</span><span class="op" id="2620964">,</span>&nbsp;<span class="ident" id="2620966">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2620974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2620977">sa</span><span class="op" id="2620979">.</span><span class="ident" id="2620980">raw</span><span class="op" id="2620983">.</span><span class="ident" id="2620984">Family</span>&nbsp;<span class="op" id="2620991">=</span>&nbsp;<span class="ident" id="2620993">AF_INET</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621002">p</span>&nbsp;<span class="op" id="2621004">:=</span>&nbsp;<span class="op" id="2621007">(</span><span class="op" id="2621008">*</span><span class="op" id="2621009">[</span><span class="num" id="2621010">2</span><span class="op" id="2621011">]</span><span class="builtintype" id="2621012">byte</span><span class="op" id="2621016">)</span><span class="op" id="2621017">(</span><span class="ident" id="2621018">unsafe</span><span class="op" id="2621024">.</span><span class="ident" id="2621025">Pointer</span><span class="op" id="2621032">(</span><span class="op" id="2621033">&amp;</span><span class="ident" id="2621034">sa</span><span class="op" id="2621036">.</span><span class="ident" id="2621037">raw</span><span class="op" id="2621040">.</span><span class="ident" id="2621041">Port</span><span class="op" id="2621045">)</span><span class="op" id="2621046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621049">p</span><span class="op" id="2621050">[</span><span class="num" id="2621051">0</span><span class="op" id="2621052">]</span>&nbsp;<span class="op" id="2621054">=</span>&nbsp;<span class="builtintype" id="2621056">byte</span><span class="op" id="2621060">(</span><span class="ident" id="2621061">sa</span><span class="op" id="2621063">.</span><span class="ident" id="2621064">Port</span>&nbsp;<span class="op" id="2621069">&gt;&gt;</span>&nbsp;<span class="num" id="2621072">8</span><span class="op" id="2621073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621076">p</span><span class="op" id="2621077">[</span><span class="num" id="2621078">1</span><span class="op" id="2621079">]</span>&nbsp;<span class="op" id="2621081">=</span>&nbsp;<span class="builtintype" id="2621083">byte</span><span class="op" id="2621087">(</span><span class="ident" id="2621088">sa</span><span class="op" id="2621090">.</span><span class="ident" id="2621091">Port</span><span class="op" id="2621095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621098">for</span>&nbsp;<span class="ident" id="2621102">i</span>&nbsp;<span class="op" id="2621104">:=</span>&nbsp;<span class="num" id="2621107">0</span><span class="op" id="2621108">;</span>&nbsp;<span class="ident" id="2621110">i</span>&nbsp;<span class="op" id="2621112">&lt;</span>&nbsp;<span class="builtinfunc" id="2621114">len</span><span class="op" id="2621117">(</span><span class="ident" id="2621118">sa</span><span class="op" id="2621120">.</span><span class="ident" id="2621121">Addr</span><span class="op" id="2621125">)</span><span class="op" id="2621126">;</span>&nbsp;<span class="ident" id="2621128">i</span><span class="op" id="2621129">++</span>&nbsp;<span class="op" id="2621132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621136">sa</span><span class="op" id="2621138">.</span><span class="ident" id="2621139">raw</span><span class="op" id="2621142">.</span><span class="ident" id="2621143">Addr</span><span class="op" id="2621147">[</span><span class="ident" id="2621148">i</span><span class="op" id="2621149">]</span>&nbsp;<span class="op" id="2621151">=</span>&nbsp;<span class="ident" id="2621153">sa</span><span class="op" id="2621155">.</span><span class="ident" id="2621156">Addr</span><span class="op" id="2621160">[</span><span class="ident" id="2621161">i</span><span class="op" id="2621162">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2621165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621168">return</span>&nbsp;<span class="ident" id="2621175">unsafe</span><span class="op" id="2621181">.</span><span class="ident" id="2621182">Pointer</span><span class="op" id="2621189">(</span><span class="op" id="2621190">&amp;</span><span class="ident" id="2621191">sa</span><span class="op" id="2621193">.</span><span class="ident" id="2621194">raw</span><span class="op" id="2621197">)</span><span class="op" id="2621198">,</span>&nbsp;<span class="ident" id="2621200">SizeofSockaddrInet4</span><span class="op" id="2621219">,</span>&nbsp;<span class="ident" id="2621221">nil</span><br>
<span class="lineno"></span><span class="op" id="2621225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2621228">func</span>&nbsp;<span class="op" id="2621233">(</span><span class="ident" id="2621234">sa</span>&nbsp;<span class="op" id="2621237">*</span><span class="ident" id="2621238">SockaddrInet6</span><span class="op" id="2621251">)</span>&nbsp;<span class="ident" id="2621253">sockaddr</span><span class="op" id="2621261">(</span><span class="op" id="2621262">)</span>&nbsp;<span class="op" id="2621264">(</span><span class="ident" id="2621265">unsafe</span><span class="op" id="2621271">.</span><span class="ident" id="2621272">Pointer</span><span class="op" id="2621279">,</span>&nbsp;<span class="ident" id="2621281">_Socklen</span><span class="op" id="2621289">,</span>&nbsp;<span class="builtintype" id="2621291">error</span><span class="op" id="2621296">)</span>&nbsp;<span class="op" id="2621298">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621301">if</span>&nbsp;<span class="ident" id="2621304">sa</span><span class="op" id="2621306">.</span><span class="ident" id="2621307">Port</span>&nbsp;<span class="op" id="2621312">&lt;</span>&nbsp;<span class="num" id="2621314">0</span>&nbsp;<span class="op" id="2621316">||</span>&nbsp;<span class="ident" id="2621319">sa</span><span class="op" id="2621321">.</span><span class="ident" id="2621322">Port</span>&nbsp;<span class="op" id="2621327">&gt;</span>&nbsp;<span class="num" id="2621329">0xFFFF</span>&nbsp;<span class="op" id="2621336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621340">return</span>&nbsp;<span class="ident" id="2621347">nil</span><span class="op" id="2621350">,</span>&nbsp;<span class="num" id="2621352">0</span><span class="op" id="2621353">,</span>&nbsp;<span class="ident" id="2621355">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2621363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621366">sa</span><span class="op" id="2621368">.</span><span class="ident" id="2621369">raw</span><span class="op" id="2621372">.</span><span class="ident" id="2621373">Family</span>&nbsp;<span class="op" id="2621380">=</span>&nbsp;<span class="ident" id="2621382">AF_INET6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621392">p</span>&nbsp;<span class="op" id="2621394">:=</span>&nbsp;<span class="op" id="2621397">(</span><span class="op" id="2621398">*</span><span class="op" id="2621399">[</span><span class="num" id="2621400">2</span><span class="op" id="2621401">]</span><span class="builtintype" id="2621402">byte</span><span class="op" id="2621406">)</span><span class="op" id="2621407">(</span><span class="ident" id="2621408">unsafe</span><span class="op" id="2621414">.</span><span class="ident" id="2621415">Pointer</span><span class="op" id="2621422">(</span><span class="op" id="2621423">&amp;</span><span class="ident" id="2621424">sa</span><span class="op" id="2621426">.</span><span class="ident" id="2621427">raw</span><span class="op" id="2621430">.</span><span class="ident" id="2621431">Port</span><span class="op" id="2621435">)</span><span class="op" id="2621436">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621439">p</span><span class="op" id="2621440">[</span><span class="num" id="2621441">0</span><span class="op" id="2621442">]</span>&nbsp;<span class="op" id="2621444">=</span>&nbsp;<span class="builtintype" id="2621446">byte</span><span class="op" id="2621450">(</span><span class="ident" id="2621451">sa</span><span class="op" id="2621453">.</span><span class="ident" id="2621454">Port</span>&nbsp;<span class="op" id="2621459">&gt;&gt;</span>&nbsp;<span class="num" id="2621462">8</span><span class="op" id="2621463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621466">p</span><span class="op" id="2621467">[</span><span class="num" id="2621468">1</span><span class="op" id="2621469">]</span>&nbsp;<span class="op" id="2621471">=</span>&nbsp;<span class="builtintype" id="2621473">byte</span><span class="op" id="2621477">(</span><span class="ident" id="2621478">sa</span><span class="op" id="2621480">.</span><span class="ident" id="2621481">Port</span><span class="op" id="2621485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621488">sa</span><span class="op" id="2621490">.</span><span class="ident" id="2621491">raw</span><span class="op" id="2621494">.</span><span class="ident" id="2621495">Scope_id</span>&nbsp;<span class="op" id="2621504">=</span>&nbsp;<span class="ident" id="2621506">sa</span><span class="op" id="2621508">.</span><span class="ident" id="2621509">ZoneId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621517">for</span>&nbsp;<span class="ident" id="2621521">i</span>&nbsp;<span class="op" id="2621523">:=</span>&nbsp;<span class="num" id="2621526">0</span><span class="op" id="2621527">;</span>&nbsp;<span class="ident" id="2621529">i</span>&nbsp;<span class="op" id="2621531">&lt;</span>&nbsp;<span class="builtinfunc" id="2621533">len</span><span class="op" id="2621536">(</span><span class="ident" id="2621537">sa</span><span class="op" id="2621539">.</span><span class="ident" id="2621540">Addr</span><span class="op" id="2621544">)</span><span class="op" id="2621545">;</span>&nbsp;<span class="ident" id="2621547">i</span><span class="op" id="2621548">++</span>&nbsp;<span class="op" id="2621551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621555">sa</span><span class="op" id="2621557">.</span><span class="ident" id="2621558">raw</span><span class="op" id="2621561">.</span><span class="ident" id="2621562">Addr</span><span class="op" id="2621566">[</span><span class="ident" id="2621567">i</span><span class="op" id="2621568">]</span>&nbsp;<span class="op" id="2621570">=</span>&nbsp;<span class="ident" id="2621572">sa</span><span class="op" id="2621574">.</span><span class="ident" id="2621575">Addr</span><span class="op" id="2621579">[</span><span class="ident" id="2621580">i</span><span class="op" id="2621581">]</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2621584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621587">return</span>&nbsp;<span class="ident" id="2621594">unsafe</span><span class="op" id="2621600">.</span><span class="ident" id="2621601">Pointer</span><span class="op" id="2621608">(</span><span class="op" id="2621609">&amp;</span><span class="ident" id="2621610">sa</span><span class="op" id="2621612">.</span><span class="ident" id="2621613">raw</span><span class="op" id="2621616">)</span><span class="op" id="2621617">,</span>&nbsp;<span class="ident" id="2621619">SizeofSockaddrInet6</span><span class="op" id="2621638">,</span>&nbsp;<span class="ident" id="2621640">nil</span><br>
<span class="lineno"></span><span class="op" id="2621644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2621647">func</span>&nbsp;<span class="op" id="2621652">(</span><span class="ident" id="2621653">sa</span>&nbsp;<span class="op" id="2621656">*</span><span class="ident" id="2621657">SockaddrUnix</span><span class="op" id="2621669">)</span>&nbsp;<span class="ident" id="2621671">sockaddr</span><span class="op" id="2621679">(</span><span class="op" id="2621680">)</span>&nbsp;<span class="op" id="2621682">(</span><span class="ident" id="2621683">unsafe</span><span class="op" id="2621689">.</span><span class="ident" id="2621690">Pointer</span><span class="op" id="2621697">,</span>&nbsp;<span class="ident" id="2621699">_Socklen</span><span class="op" id="2621707">,</span>&nbsp;<span class="builtintype" id="2621709">error</span><span class="op" id="2621714">)</span>&nbsp;<span class="op" id="2621716">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621719">name</span>&nbsp;<span class="op" id="2621724">:=</span>&nbsp;<span class="ident" id="2621727">sa</span><span class="op" id="2621729">.</span><span class="ident" id="2621730">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621736">n</span>&nbsp;<span class="op" id="2621738">:=</span>&nbsp;<span class="builtinfunc" id="2621741">len</span><span class="op" id="2621744">(</span><span class="ident" id="2621745">name</span><span class="op" id="2621749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621752">if</span>&nbsp;<span class="ident" id="2621755">n</span>&nbsp;<span class="op" id="2621757">&gt;=</span>&nbsp;<span class="builtinfunc" id="2621760">len</span><span class="op" id="2621763">(</span><span class="ident" id="2621764">sa</span><span class="op" id="2621766">.</span><span class="ident" id="2621767">raw</span><span class="op" id="2621770">.</span><span class="ident" id="2621771">Path</span><span class="op" id="2621775">)</span>&nbsp;<span class="op" id="2621777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621781">return</span>&nbsp;<span class="ident" id="2621788">nil</span><span class="op" id="2621791">,</span>&nbsp;<span class="num" id="2621793">0</span><span class="op" id="2621794">,</span>&nbsp;<span class="ident" id="2621796">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2621804">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621807">sa</span><span class="op" id="2621809">.</span><span class="ident" id="2621810">raw</span><span class="op" id="2621813">.</span><span class="ident" id="2621814">Family</span>&nbsp;<span class="op" id="2621821">=</span>&nbsp;<span class="ident" id="2621823">AF_UNIX</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621832">for</span>&nbsp;<span class="ident" id="2621836">i</span>&nbsp;<span class="op" id="2621838">:=</span>&nbsp;<span class="num" id="2621841">0</span><span class="op" id="2621842">;</span>&nbsp;<span class="ident" id="2621844">i</span>&nbsp;<span class="op" id="2621846">&lt;</span>&nbsp;<span class="ident" id="2621848">n</span><span class="op" id="2621849">;</span>&nbsp;<span class="ident" id="2621851">i</span><span class="op" id="2621852">++</span>&nbsp;<span class="op" id="2621855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621859">sa</span><span class="op" id="2621861">.</span><span class="ident" id="2621862">raw</span><span class="op" id="2621865">.</span><span class="ident" id="2621866">Path</span><span class="op" id="2621870">[</span><span class="ident" id="2621871">i</span><span class="op" id="2621872">]</span>&nbsp;<span class="op" id="2621874">=</span>&nbsp;<span class="builtintype" id="2621876">int8</span><span class="op" id="2621880">(</span><span class="ident" id="2621881">name</span><span class="op" id="2621885">[</span><span class="ident" id="2621886">i</span><span class="op" id="2621887">]</span><span class="op" id="2621888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2621891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2621894">//&nbsp;length&nbsp;is&nbsp;family&nbsp;(uint16),&nbsp;name,&nbsp;NUL.</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621936">sl</span>&nbsp;<span class="op" id="2621939">:=</span>&nbsp;<span class="ident" id="2621942">_Socklen</span><span class="op" id="2621950">(</span><span class="num" id="2621951">2</span><span class="op" id="2621952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621955">if</span>&nbsp;<span class="ident" id="2621958">n</span>&nbsp;<span class="op" id="2621960">&gt;</span>&nbsp;<span class="num" id="2621962">0</span>&nbsp;<span class="op" id="2621964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2621968">sl</span>&nbsp;<span class="op" id="2621971">+=</span>&nbsp;<span class="ident" id="2621974">_Socklen</span><span class="op" id="2621982">(</span><span class="ident" id="2621983">n</span><span class="op" id="2621984">)</span>&nbsp;<span class="op" id="2621986">+</span>&nbsp;<span class="num" id="2621988">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2621991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2621994">if</span>&nbsp;<span class="ident" id="2621997">sa</span><span class="op" id="2621999">.</span><span class="ident" id="2622000">raw</span><span class="op" id="2622003">.</span><span class="ident" id="2622004">Path</span><span class="op" id="2622008">[</span><span class="num" id="2622009">0</span><span class="op" id="2622010">]</span>&nbsp;<span class="op" id="2622012">==</span>&nbsp;<span class="string" id="2622015">&#39;@&#39;</span>&nbsp;<span class="op" id="2622019">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622023">sa</span><span class="op" id="2622025">.</span><span class="ident" id="2622026">raw</span><span class="op" id="2622029">.</span><span class="ident" id="2622030">Path</span><span class="op" id="2622034">[</span><span class="num" id="2622035">0</span><span class="op" id="2622036">]</span>&nbsp;<span class="op" id="2622038">=</span>&nbsp;<span class="num" id="2622040">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2622044">//&nbsp;Don&#39;t&nbsp;count&nbsp;trailing&nbsp;NUL&nbsp;for&nbsp;abstract&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622096">sl</span><span class="op" id="2622098">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2622102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2622106">return</span>&nbsp;<span class="ident" id="2622113">unsafe</span><span class="op" id="2622119">.</span><span class="ident" id="2622120">Pointer</span><span class="op" id="2622127">(</span><span class="op" id="2622128">&amp;</span><span class="ident" id="2622129">sa</span><span class="op" id="2622131">.</span><span class="ident" id="2622132">raw</span><span class="op" id="2622135">)</span><span class="op" id="2622136">,</span>&nbsp;<span class="ident" id="2622138">sl</span><span class="op" id="2622140">,</span>&nbsp;<span class="ident" id="2622142">nil</span><br>
<span class="lineno"></span><span class="op" id="2622146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2622149">type</span>&nbsp;<span class="ident" id="2622154">SockaddrLinklayer</span>&nbsp;<span class="keyword" id="2622172">struct</span>&nbsp;<span class="op" id="2622179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622182">Protocol</span>&nbsp;<span class="builtintype" id="2622191">uint16</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622199">Ifindex</span>&nbsp;&nbsp;<span class="builtintype" id="2622208">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622213">Hatype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2622222">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622230">Pkttype</span>&nbsp;&nbsp;<span class="builtintype" id="2622239">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622246">Halen</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2622255">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622262">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2622271">[</span><span class="num" id="2622272">8</span><span class="op" id="2622273">]</span><span class="builtintype" id="2622274">byte</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622280">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2622289">RawSockaddrLinklayer</span><br>
<span class="lineno"></span><span class="op" id="2622310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2622313">func</span>&nbsp;<span class="op" id="2622318">(</span><span class="ident" id="2622319">sa</span>&nbsp;<span class="op" id="2622322">*</span><span class="ident" id="2622323">SockaddrLinklayer</span><span class="op" id="2622340">)</span>&nbsp;<span class="ident" id="2622342">sockaddr</span><span class="op" id="2622350">(</span><span class="op" id="2622351">)</span>&nbsp;<span class="op" id="2622353">(</span><span class="ident" id="2622354">unsafe</span><span class="op" id="2622360">.</span><span class="ident" id="2622361">Pointer</span><span class="op" id="2622368">,</span>&nbsp;<span class="ident" id="2622370">_Socklen</span><span class="op" id="2622378">,</span>&nbsp;<span class="builtintype" id="2622380">error</span><span class="op" id="2622385">)</span>&nbsp;<span class="op" id="2622387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2622390">if</span>&nbsp;<span class="ident" id="2622393">sa</span><span class="op" id="2622395">.</span><span class="ident" id="2622396">Ifindex</span>&nbsp;<span class="op" id="2622404">&lt;</span>&nbsp;<span class="num" id="2622406">0</span>&nbsp;<span class="op" id="2622408">||</span>&nbsp;<span class="ident" id="2622411">sa</span><span class="op" id="2622413">.</span><span class="ident" id="2622414">Ifindex</span>&nbsp;<span class="op" id="2622422">&gt;</span>&nbsp;<span class="num" id="2622424">0x7fffffff</span>&nbsp;<span class="op" id="2622435">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2622439">return</span>&nbsp;<span class="ident" id="2622446">nil</span><span class="op" id="2622449">,</span>&nbsp;<span class="num" id="2622451">0</span><span class="op" id="2622452">,</span>&nbsp;<span class="ident" id="2622454">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2622462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622465">sa</span><span class="op" id="2622467">.</span><span class="ident" id="2622468">raw</span><span class="op" id="2622471">.</span><span class="ident" id="2622472">Family</span>&nbsp;<span class="op" id="2622479">=</span>&nbsp;<span class="ident" id="2622481">AF_PACKET</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622492">sa</span><span class="op" id="2622494">.</span><span class="ident" id="2622495">raw</span><span class="op" id="2622498">.</span><span class="ident" id="2622499">Protocol</span>&nbsp;<span class="op" id="2622508">=</span>&nbsp;<span class="ident" id="2622510">sa</span><span class="op" id="2622512">.</span><span class="ident" id="2622513">Protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622523">sa</span><span class="op" id="2622525">.</span><span class="ident" id="2622526">raw</span><span class="op" id="2622529">.</span><span class="ident" id="2622530">Ifindex</span>&nbsp;<span class="op" id="2622538">=</span>&nbsp;<span class="builtintype" id="2622540">int32</span><span class="op" id="2622545">(</span><span class="ident" id="2622546">sa</span><span class="op" id="2622548">.</span><span class="ident" id="2622549">Ifindex</span><span class="op" id="2622556">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622559">sa</span><span class="op" id="2622561">.</span><span class="ident" id="2622562">raw</span><span class="op" id="2622565">.</span><span class="ident" id="2622566">Hatype</span>&nbsp;<span class="op" id="2622573">=</span>&nbsp;<span class="ident" id="2622575">sa</span><span class="op" id="2622577">.</span><span class="ident" id="2622578">Hatype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622586">sa</span><span class="op" id="2622588">.</span><span class="ident" id="2622589">raw</span><span class="op" id="2622592">.</span><span class="ident" id="2622593">Pkttype</span>&nbsp;<span class="op" id="2622601">=</span>&nbsp;<span class="ident" id="2622603">sa</span><span class="op" id="2622605">.</span><span class="ident" id="2622606">Pkttype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622615">sa</span><span class="op" id="2622617">.</span><span class="ident" id="2622618">raw</span><span class="op" id="2622621">.</span><span class="ident" id="2622622">Halen</span>&nbsp;<span class="op" id="2622628">=</span>&nbsp;<span class="ident" id="2622630">sa</span><span class="op" id="2622632">.</span><span class="ident" id="2622633">Halen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2622640">for</span>&nbsp;<span class="ident" id="2622644">i</span>&nbsp;<span class="op" id="2622646">:=</span>&nbsp;<span class="num" id="2622649">0</span><span class="op" id="2622650">;</span>&nbsp;<span class="ident" id="2622652">i</span>&nbsp;<span class="op" id="2622654">&lt;</span>&nbsp;<span class="builtinfunc" id="2622656">len</span><span class="op" id="2622659">(</span><span class="ident" id="2622660">sa</span><span class="op" id="2622662">.</span><span class="ident" id="2622663">Addr</span><span class="op" id="2622667">)</span><span class="op" id="2622668">;</span>&nbsp;<span class="ident" id="2622670">i</span><span class="op" id="2622671">++</span>&nbsp;<span class="op" id="2622674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622678">sa</span><span class="op" id="2622680">.</span><span class="ident" id="2622681">raw</span><span class="op" id="2622684">.</span><span class="ident" id="2622685">Addr</span><span class="op" id="2622689">[</span><span class="ident" id="2622690">i</span><span class="op" id="2622691">]</span>&nbsp;<span class="op" id="2622693">=</span>&nbsp;<span class="ident" id="2622695">sa</span><span class="op" id="2622697">.</span><span class="ident" id="2622698">Addr</span><span class="op" id="2622702">[</span><span class="ident" id="2622703">i</span><span class="op" id="2622704">]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2622707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2622710">return</span>&nbsp;<span class="ident" id="2622717">unsafe</span><span class="op" id="2622723">.</span><span class="ident" id="2622724">Pointer</span><span class="op" id="2622731">(</span><span class="op" id="2622732">&amp;</span><span class="ident" id="2622733">sa</span><span class="op" id="2622735">.</span><span class="ident" id="2622736">raw</span><span class="op" id="2622739">)</span><span class="op" id="2622740">,</span>&nbsp;<span class="ident" id="2622742">SizeofSockaddrLinklayer</span><span class="op" id="2622765">,</span>&nbsp;<span class="ident" id="2622767">nil</span><br>
<span class="lineno"></span><span class="op" id="2622771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2622774">type</span>&nbsp;<span class="ident" id="2622779">SockaddrNetlink</span>&nbsp;<span class="keyword" id="2622795">struct</span>&nbsp;<span class="op" id="2622802">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622805">Family</span>&nbsp;<span class="builtintype" id="2622812">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622820">Pad</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2622827">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622835">Pid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2622842">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622850">Groups</span>&nbsp;<span class="builtintype" id="2622857">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622865">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2622872">RawSockaddrNetlink</span><br>
<span class="lineno">320</span><span class="op" id="2622891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2622894">func</span>&nbsp;<span class="op" id="2622899">(</span><span class="ident" id="2622900">sa</span>&nbsp;<span class="op" id="2622903">*</span><span class="ident" id="2622904">SockaddrNetlink</span><span class="op" id="2622919">)</span>&nbsp;<span class="ident" id="2622921">sockaddr</span><span class="op" id="2622929">(</span><span class="op" id="2622930">)</span>&nbsp;<span class="op" id="2622932">(</span><span class="ident" id="2622933">unsafe</span><span class="op" id="2622939">.</span><span class="ident" id="2622940">Pointer</span><span class="op" id="2622947">,</span>&nbsp;<span class="ident" id="2622949">_Socklen</span><span class="op" id="2622957">,</span>&nbsp;<span class="builtintype" id="2622959">error</span><span class="op" id="2622964">)</span>&nbsp;<span class="op" id="2622966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622969">sa</span><span class="op" id="2622971">.</span><span class="ident" id="2622972">raw</span><span class="op" id="2622975">.</span><span class="ident" id="2622976">Family</span>&nbsp;<span class="op" id="2622983">=</span>&nbsp;<span class="ident" id="2622985">AF_NETLINK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2622997">sa</span><span class="op" id="2622999">.</span><span class="ident" id="2623000">raw</span><span class="op" id="2623003">.</span><span class="ident" id="2623004">Pad</span>&nbsp;<span class="op" id="2623008">=</span>&nbsp;<span class="ident" id="2623010">sa</span><span class="op" id="2623012">.</span><span class="ident" id="2623013">Pad</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623018">sa</span><span class="op" id="2623020">.</span><span class="ident" id="2623021">raw</span><span class="op" id="2623024">.</span><span class="ident" id="2623025">Pid</span>&nbsp;<span class="op" id="2623029">=</span>&nbsp;<span class="ident" id="2623031">sa</span><span class="op" id="2623033">.</span><span class="ident" id="2623034">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623039">sa</span><span class="op" id="2623041">.</span><span class="ident" id="2623042">raw</span><span class="op" id="2623045">.</span><span class="ident" id="2623046">Groups</span>&nbsp;<span class="op" id="2623053">=</span>&nbsp;<span class="ident" id="2623055">sa</span><span class="op" id="2623057">.</span><span class="ident" id="2623058">Groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623066">return</span>&nbsp;<span class="ident" id="2623073">unsafe</span><span class="op" id="2623079">.</span><span class="ident" id="2623080">Pointer</span><span class="op" id="2623087">(</span><span class="op" id="2623088">&amp;</span><span class="ident" id="2623089">sa</span><span class="op" id="2623091">.</span><span class="ident" id="2623092">raw</span><span class="op" id="2623095">)</span><span class="op" id="2623096">,</span>&nbsp;<span class="ident" id="2623098">SizeofSockaddrNetlink</span><span class="op" id="2623119">,</span>&nbsp;<span class="ident" id="2623121">nil</span><br>
<span class="lineno"></span><span class="op" id="2623125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="2623128">func</span>&nbsp;<span class="ident" id="2623133">anyToSockaddr</span><span class="op" id="2623146">(</span><span class="ident" id="2623147">rsa</span>&nbsp;<span class="op" id="2623151">*</span><span class="ident" id="2623152">RawSockaddrAny</span><span class="op" id="2623166">)</span>&nbsp;<span class="op" id="2623168">(</span><span class="ident" id="2623169">Sockaddr</span><span class="op" id="2623177">,</span>&nbsp;<span class="builtintype" id="2623179">error</span><span class="op" id="2623184">)</span>&nbsp;<span class="op" id="2623186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623189">switch</span>&nbsp;<span class="ident" id="2623196">rsa</span><span class="op" id="2623199">.</span><span class="ident" id="2623200">Addr</span><span class="op" id="2623204">.</span><span class="ident" id="2623205">Family</span>&nbsp;<span class="op" id="2623212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623215">case</span>&nbsp;<span class="ident" id="2623220">AF_NETLINK</span><span class="op" id="2623230">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623234">pp</span>&nbsp;<span class="op" id="2623237">:=</span>&nbsp;<span class="op" id="2623240">(</span><span class="op" id="2623241">*</span><span class="ident" id="2623242">RawSockaddrNetlink</span><span class="op" id="2623260">)</span><span class="op" id="2623261">(</span><span class="ident" id="2623262">unsafe</span><span class="op" id="2623268">.</span><span class="ident" id="2623269">Pointer</span><span class="op" id="2623276">(</span><span class="ident" id="2623277">rsa</span><span class="op" id="2623280">)</span><span class="op" id="2623281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623285">sa</span>&nbsp;<span class="op" id="2623288">:=</span>&nbsp;<span class="builtinfunc" id="2623291">new</span><span class="op" id="2623294">(</span><span class="ident" id="2623295">SockaddrNetlink</span><span class="op" id="2623310">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623314">sa</span><span class="op" id="2623316">.</span><span class="ident" id="2623317">Family</span>&nbsp;<span class="op" id="2623324">=</span>&nbsp;<span class="ident" id="2623326">pp</span><span class="op" id="2623328">.</span><span class="ident" id="2623329">Family</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623338">sa</span><span class="op" id="2623340">.</span><span class="ident" id="2623341">Pad</span>&nbsp;<span class="op" id="2623345">=</span>&nbsp;<span class="ident" id="2623347">pp</span><span class="op" id="2623349">.</span><span class="ident" id="2623350">Pad</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623356">sa</span><span class="op" id="2623358">.</span><span class="ident" id="2623359">Pid</span>&nbsp;<span class="op" id="2623363">=</span>&nbsp;<span class="ident" id="2623365">pp</span><span class="op" id="2623367">.</span><span class="ident" id="2623368">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623374">sa</span><span class="op" id="2623376">.</span><span class="ident" id="2623377">Groups</span>&nbsp;<span class="op" id="2623384">=</span>&nbsp;<span class="ident" id="2623386">pp</span><span class="op" id="2623388">.</span><span class="ident" id="2623389">Groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623398">return</span>&nbsp;<span class="ident" id="2623405">sa</span><span class="op" id="2623407">,</span>&nbsp;<span class="ident" id="2623409">nil</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623415">case</span>&nbsp;<span class="ident" id="2623420">AF_PACKET</span><span class="op" id="2623429">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623433">pp</span>&nbsp;<span class="op" id="2623436">:=</span>&nbsp;<span class="op" id="2623439">(</span><span class="op" id="2623440">*</span><span class="ident" id="2623441">RawSockaddrLinklayer</span><span class="op" id="2623461">)</span><span class="op" id="2623462">(</span><span class="ident" id="2623463">unsafe</span><span class="op" id="2623469">.</span><span class="ident" id="2623470">Pointer</span><span class="op" id="2623477">(</span><span class="ident" id="2623478">rsa</span><span class="op" id="2623481">)</span><span class="op" id="2623482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623486">sa</span>&nbsp;<span class="op" id="2623489">:=</span>&nbsp;<span class="builtinfunc" id="2623492">new</span><span class="op" id="2623495">(</span><span class="ident" id="2623496">SockaddrLinklayer</span><span class="op" id="2623513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623517">sa</span><span class="op" id="2623519">.</span><span class="ident" id="2623520">Protocol</span>&nbsp;<span class="op" id="2623529">=</span>&nbsp;<span class="ident" id="2623531">pp</span><span class="op" id="2623533">.</span><span class="ident" id="2623534">Protocol</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623545">sa</span><span class="op" id="2623547">.</span><span class="ident" id="2623548">Ifindex</span>&nbsp;<span class="op" id="2623556">=</span>&nbsp;<span class="builtintype" id="2623558">int</span><span class="op" id="2623561">(</span><span class="ident" id="2623562">pp</span><span class="op" id="2623564">.</span><span class="ident" id="2623565">Ifindex</span><span class="op" id="2623572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623576">sa</span><span class="op" id="2623578">.</span><span class="ident" id="2623579">Hatype</span>&nbsp;<span class="op" id="2623586">=</span>&nbsp;<span class="ident" id="2623588">pp</span><span class="op" id="2623590">.</span><span class="ident" id="2623591">Hatype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623600">sa</span><span class="op" id="2623602">.</span><span class="ident" id="2623603">Pkttype</span>&nbsp;<span class="op" id="2623611">=</span>&nbsp;<span class="ident" id="2623613">pp</span><span class="op" id="2623615">.</span><span class="ident" id="2623616">Pkttype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623626">sa</span><span class="op" id="2623628">.</span><span class="ident" id="2623629">Halen</span>&nbsp;<span class="op" id="2623635">=</span>&nbsp;<span class="ident" id="2623637">pp</span><span class="op" id="2623639">.</span><span class="ident" id="2623640">Halen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623648">for</span>&nbsp;<span class="ident" id="2623652">i</span>&nbsp;<span class="op" id="2623654">:=</span>&nbsp;<span class="num" id="2623657">0</span><span class="op" id="2623658">;</span>&nbsp;<span class="ident" id="2623660">i</span>&nbsp;<span class="op" id="2623662">&lt;</span>&nbsp;<span class="builtinfunc" id="2623664">len</span><span class="op" id="2623667">(</span><span class="ident" id="2623668">sa</span><span class="op" id="2623670">.</span><span class="ident" id="2623671">Addr</span><span class="op" id="2623675">)</span><span class="op" id="2623676">;</span>&nbsp;<span class="ident" id="2623678">i</span><span class="op" id="2623679">++</span>&nbsp;<span class="op" id="2623682">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623687">sa</span><span class="op" id="2623689">.</span><span class="ident" id="2623690">Addr</span><span class="op" id="2623694">[</span><span class="ident" id="2623695">i</span><span class="op" id="2623696">]</span>&nbsp;<span class="op" id="2623698">=</span>&nbsp;<span class="ident" id="2623700">pp</span><span class="op" id="2623702">.</span><span class="ident" id="2623703">Addr</span><span class="op" id="2623707">[</span><span class="ident" id="2623708">i</span><span class="op" id="2623709">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2623713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623717">return</span>&nbsp;<span class="ident" id="2623724">sa</span><span class="op" id="2623726">,</span>&nbsp;<span class="ident" id="2623728">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623734">case</span>&nbsp;<span class="ident" id="2623739">AF_UNIX</span><span class="op" id="2623746">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623750">pp</span>&nbsp;<span class="op" id="2623753">:=</span>&nbsp;<span class="op" id="2623756">(</span><span class="op" id="2623757">*</span><span class="ident" id="2623758">RawSockaddrUnix</span><span class="op" id="2623773">)</span><span class="op" id="2623774">(</span><span class="ident" id="2623775">unsafe</span><span class="op" id="2623781">.</span><span class="ident" id="2623782">Pointer</span><span class="op" id="2623789">(</span><span class="ident" id="2623790">rsa</span><span class="op" id="2623793">)</span><span class="op" id="2623794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2623798">sa</span>&nbsp;<span class="op" id="2623801">:=</span>&nbsp;<span class="builtinfunc" id="2623804">new</span><span class="op" id="2623807">(</span><span class="ident" id="2623808">SockaddrUnix</span><span class="op" id="2623820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2623824">if</span>&nbsp;<span class="ident" id="2623827">pp</span><span class="op" id="2623829">.</span><span class="ident" id="2623830">Path</span><span class="op" id="2623834">[</span><span class="num" id="2623835">0</span><span class="op" id="2623836">]</span>&nbsp;<span class="op" id="2623838">==</span>&nbsp;<span class="num" id="2623841">0</span>&nbsp;<span class="op" id="2623843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2623848">//&nbsp;&#34;Abstract&#34;&nbsp;Unix&nbsp;domain&nbsp;socket.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2623885">//&nbsp;Rewrite&nbsp;leading&nbsp;NUL&nbsp;as&nbsp;@&nbsp;for&nbsp;textual&nbsp;display.</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2623937">//&nbsp;(This&nbsp;is&nbsp;the&nbsp;standard&nbsp;convention.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2623978">//&nbsp;Not&nbsp;friendly&nbsp;to&nbsp;overwrite&nbsp;in&nbsp;place,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2624020">//&nbsp;but&nbsp;the&nbsp;callers&nbsp;below&nbsp;don&#39;t&nbsp;care.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624060">pp</span><span class="op" id="2624062">.</span><span class="ident" id="2624063">Path</span><span class="op" id="2624067">[</span><span class="num" id="2624068">0</span><span class="op" id="2624069">]</span>&nbsp;<span class="op" id="2624071">=</span>&nbsp;<span class="string" id="2624073">&#39;@&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2624079">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2624084">//&nbsp;Assume&nbsp;path&nbsp;ends&nbsp;at&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2624114">//&nbsp;This&nbsp;is&nbsp;not&nbsp;technically&nbsp;the&nbsp;Linux&nbsp;semantics&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2624167">//&nbsp;abstract&nbsp;Unix&nbsp;domain&nbsp;sockets--they&nbsp;are&nbsp;supposed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2624220">//&nbsp;to&nbsp;be&nbsp;uninterpreted&nbsp;fixed-size&nbsp;binary&nbsp;blobs--but</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2624274">//&nbsp;everyone&nbsp;uses&nbsp;this&nbsp;convention.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624310">n</span>&nbsp;<span class="op" id="2624312">:=</span>&nbsp;<span class="num" id="2624315">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624319">for</span>&nbsp;<span class="ident" id="2624323">n</span>&nbsp;<span class="op" id="2624325">&lt;</span>&nbsp;<span class="builtinfunc" id="2624327">len</span><span class="op" id="2624330">(</span><span class="ident" id="2624331">pp</span><span class="op" id="2624333">.</span><span class="ident" id="2624334">Path</span><span class="op" id="2624338">)</span>&nbsp;<span class="op" id="2624340">&amp;&amp;</span>&nbsp;<span class="ident" id="2624343">pp</span><span class="op" id="2624345">.</span><span class="ident" id="2624346">Path</span><span class="op" id="2624350">[</span><span class="ident" id="2624351">n</span><span class="op" id="2624352">]</span>&nbsp;<span class="op" id="2624354">!=</span>&nbsp;<span class="num" id="2624357">0</span>&nbsp;<span class="op" id="2624359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624364">n</span><span class="op" id="2624365">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2624370">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624374">bytes</span>&nbsp;<span class="op" id="2624380">:=</span>&nbsp;<span class="op" id="2624383">(</span><span class="op" id="2624384">*</span><span class="op" id="2624385">[</span><span class="num" id="2624386">10000</span><span class="op" id="2624391">]</span><span class="builtintype" id="2624392">byte</span><span class="op" id="2624396">)</span><span class="op" id="2624397">(</span><span class="ident" id="2624398">unsafe</span><span class="op" id="2624404">.</span><span class="ident" id="2624405">Pointer</span><span class="op" id="2624412">(</span><span class="op" id="2624413">&amp;</span><span class="ident" id="2624414">pp</span><span class="op" id="2624416">.</span><span class="ident" id="2624417">Path</span><span class="op" id="2624421">[</span><span class="num" id="2624422">0</span><span class="op" id="2624423">]</span><span class="op" id="2624424">)</span><span class="op" id="2624425">)</span><span class="op" id="2624426">[</span><span class="num" id="2624427">0</span><span class="op" id="2624428">:</span><span class="ident" id="2624429">n</span><span class="op" id="2624430">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624434">sa</span><span class="op" id="2624436">.</span><span class="ident" id="2624437">Name</span>&nbsp;<span class="op" id="2624442">=</span>&nbsp;<span class="builtintype" id="2624444">string</span><span class="op" id="2624450">(</span><span class="ident" id="2624451">bytes</span><span class="op" id="2624456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624460">return</span>&nbsp;<span class="ident" id="2624467">sa</span><span class="op" id="2624469">,</span>&nbsp;<span class="ident" id="2624471">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624477">case</span>&nbsp;<span class="ident" id="2624482">AF_INET</span><span class="op" id="2624489">:</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624493">pp</span>&nbsp;<span class="op" id="2624496">:=</span>&nbsp;<span class="op" id="2624499">(</span><span class="op" id="2624500">*</span><span class="ident" id="2624501">RawSockaddrInet4</span><span class="op" id="2624517">)</span><span class="op" id="2624518">(</span><span class="ident" id="2624519">unsafe</span><span class="op" id="2624525">.</span><span class="ident" id="2624526">Pointer</span><span class="op" id="2624533">(</span><span class="ident" id="2624534">rsa</span><span class="op" id="2624537">)</span><span class="op" id="2624538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624542">sa</span>&nbsp;<span class="op" id="2624545">:=</span>&nbsp;<span class="builtinfunc" id="2624548">new</span><span class="op" id="2624551">(</span><span class="ident" id="2624552">SockaddrInet4</span><span class="op" id="2624565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624569">p</span>&nbsp;<span class="op" id="2624571">:=</span>&nbsp;<span class="op" id="2624574">(</span><span class="op" id="2624575">*</span><span class="op" id="2624576">[</span><span class="num" id="2624577">2</span><span class="op" id="2624578">]</span><span class="builtintype" id="2624579">byte</span><span class="op" id="2624583">)</span><span class="op" id="2624584">(</span><span class="ident" id="2624585">unsafe</span><span class="op" id="2624591">.</span><span class="ident" id="2624592">Pointer</span><span class="op" id="2624599">(</span><span class="op" id="2624600">&amp;</span><span class="ident" id="2624601">pp</span><span class="op" id="2624603">.</span><span class="ident" id="2624604">Port</span><span class="op" id="2624608">)</span><span class="op" id="2624609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624613">sa</span><span class="op" id="2624615">.</span><span class="ident" id="2624616">Port</span>&nbsp;<span class="op" id="2624621">=</span>&nbsp;<span class="builtintype" id="2624623">int</span><span class="op" id="2624626">(</span><span class="ident" id="2624627">p</span><span class="op" id="2624628">[</span><span class="num" id="2624629">0</span><span class="op" id="2624630">]</span><span class="op" id="2624631">)</span><span class="op" id="2624632">&lt;&lt;</span><span class="num" id="2624634">8</span>&nbsp;<span class="op" id="2624636">+</span>&nbsp;<span class="builtintype" id="2624638">int</span><span class="op" id="2624641">(</span><span class="ident" id="2624642">p</span><span class="op" id="2624643">[</span><span class="num" id="2624644">1</span><span class="op" id="2624645">]</span><span class="op" id="2624646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624650">for</span>&nbsp;<span class="ident" id="2624654">i</span>&nbsp;<span class="op" id="2624656">:=</span>&nbsp;<span class="num" id="2624659">0</span><span class="op" id="2624660">;</span>&nbsp;<span class="ident" id="2624662">i</span>&nbsp;<span class="op" id="2624664">&lt;</span>&nbsp;<span class="builtinfunc" id="2624666">len</span><span class="op" id="2624669">(</span><span class="ident" id="2624670">sa</span><span class="op" id="2624672">.</span><span class="ident" id="2624673">Addr</span><span class="op" id="2624677">)</span><span class="op" id="2624678">;</span>&nbsp;<span class="ident" id="2624680">i</span><span class="op" id="2624681">++</span>&nbsp;<span class="op" id="2624684">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624689">sa</span><span class="op" id="2624691">.</span><span class="ident" id="2624692">Addr</span><span class="op" id="2624696">[</span><span class="ident" id="2624697">i</span><span class="op" id="2624698">]</span>&nbsp;<span class="op" id="2624700">=</span>&nbsp;<span class="ident" id="2624702">pp</span><span class="op" id="2624704">.</span><span class="ident" id="2624705">Addr</span><span class="op" id="2624709">[</span><span class="ident" id="2624710">i</span><span class="op" id="2624711">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2624715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624719">return</span>&nbsp;<span class="ident" id="2624726">sa</span><span class="op" id="2624728">,</span>&nbsp;<span class="ident" id="2624730">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624736">case</span>&nbsp;<span class="ident" id="2624741">AF_INET6</span><span class="op" id="2624749">:</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624753">pp</span>&nbsp;<span class="op" id="2624756">:=</span>&nbsp;<span class="op" id="2624759">(</span><span class="op" id="2624760">*</span><span class="ident" id="2624761">RawSockaddrInet6</span><span class="op" id="2624777">)</span><span class="op" id="2624778">(</span><span class="ident" id="2624779">unsafe</span><span class="op" id="2624785">.</span><span class="ident" id="2624786">Pointer</span><span class="op" id="2624793">(</span><span class="ident" id="2624794">rsa</span><span class="op" id="2624797">)</span><span class="op" id="2624798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624802">sa</span>&nbsp;<span class="op" id="2624805">:=</span>&nbsp;<span class="builtinfunc" id="2624808">new</span><span class="op" id="2624811">(</span><span class="ident" id="2624812">SockaddrInet6</span><span class="op" id="2624825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624829">p</span>&nbsp;<span class="op" id="2624831">:=</span>&nbsp;<span class="op" id="2624834">(</span><span class="op" id="2624835">*</span><span class="op" id="2624836">[</span><span class="num" id="2624837">2</span><span class="op" id="2624838">]</span><span class="builtintype" id="2624839">byte</span><span class="op" id="2624843">)</span><span class="op" id="2624844">(</span><span class="ident" id="2624845">unsafe</span><span class="op" id="2624851">.</span><span class="ident" id="2624852">Pointer</span><span class="op" id="2624859">(</span><span class="op" id="2624860">&amp;</span><span class="ident" id="2624861">pp</span><span class="op" id="2624863">.</span><span class="ident" id="2624864">Port</span><span class="op" id="2624868">)</span><span class="op" id="2624869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624873">sa</span><span class="op" id="2624875">.</span><span class="ident" id="2624876">Port</span>&nbsp;<span class="op" id="2624881">=</span>&nbsp;<span class="builtintype" id="2624883">int</span><span class="op" id="2624886">(</span><span class="ident" id="2624887">p</span><span class="op" id="2624888">[</span><span class="num" id="2624889">0</span><span class="op" id="2624890">]</span><span class="op" id="2624891">)</span><span class="op" id="2624892">&lt;&lt;</span><span class="num" id="2624894">8</span>&nbsp;<span class="op" id="2624896">+</span>&nbsp;<span class="builtintype" id="2624898">int</span><span class="op" id="2624901">(</span><span class="ident" id="2624902">p</span><span class="op" id="2624903">[</span><span class="num" id="2624904">1</span><span class="op" id="2624905">]</span><span class="op" id="2624906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624910">sa</span><span class="op" id="2624912">.</span><span class="ident" id="2624913">ZoneId</span>&nbsp;<span class="op" id="2624920">=</span>&nbsp;<span class="ident" id="2624922">pp</span><span class="op" id="2624924">.</span><span class="ident" id="2624925">Scope_id</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2624936">for</span>&nbsp;<span class="ident" id="2624940">i</span>&nbsp;<span class="op" id="2624942">:=</span>&nbsp;<span class="num" id="2624945">0</span><span class="op" id="2624946">;</span>&nbsp;<span class="ident" id="2624948">i</span>&nbsp;<span class="op" id="2624950">&lt;</span>&nbsp;<span class="builtinfunc" id="2624952">len</span><span class="op" id="2624955">(</span><span class="ident" id="2624956">sa</span><span class="op" id="2624958">.</span><span class="ident" id="2624959">Addr</span><span class="op" id="2624963">)</span><span class="op" id="2624964">;</span>&nbsp;<span class="ident" id="2624966">i</span><span class="op" id="2624967">++</span>&nbsp;<span class="op" id="2624970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2624975">sa</span><span class="op" id="2624977">.</span><span class="ident" id="2624978">Addr</span><span class="op" id="2624982">[</span><span class="ident" id="2624983">i</span><span class="op" id="2624984">]</span>&nbsp;<span class="op" id="2624986">=</span>&nbsp;<span class="ident" id="2624988">pp</span><span class="op" id="2624990">.</span><span class="ident" id="2624991">Addr</span><span class="op" id="2624995">[</span><span class="ident" id="2624996">i</span><span class="op" id="2624997">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2625001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625005">return</span>&nbsp;<span class="ident" id="2625012">sa</span><span class="op" id="2625014">,</span>&nbsp;<span class="ident" id="2625016">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2625021">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625024">return</span>&nbsp;<span class="ident" id="2625031">nil</span><span class="op" id="2625034">,</span>&nbsp;<span class="ident" id="2625036">EAFNOSUPPORT</span><br>
<span class="lineno"></span><span class="op" id="2625049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2625052">func</span>&nbsp;<span class="ident" id="2625057">Accept</span><span class="op" id="2625063">(</span><span class="ident" id="2625064">fd</span>&nbsp;<span class="builtintype" id="2625067">int</span><span class="op" id="2625070">)</span>&nbsp;<span class="op" id="2625072">(</span><span class="ident" id="2625073">nfd</span>&nbsp;<span class="builtintype" id="2625077">int</span><span class="op" id="2625080">,</span>&nbsp;<span class="ident" id="2625082">sa</span>&nbsp;<span class="ident" id="2625085">Sockaddr</span><span class="op" id="2625093">,</span>&nbsp;<span class="ident" id="2625095">err</span>&nbsp;<span class="builtintype" id="2625099">error</span><span class="op" id="2625104">)</span>&nbsp;<span class="op" id="2625106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625109">var</span>&nbsp;<span class="ident" id="2625113">rsa</span>&nbsp;<span class="ident" id="2625117">RawSockaddrAny</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625133">var</span>&nbsp;<span class="builtinfunc" id="2625137">len</span>&nbsp;<span class="ident" id="2625141">_Socklen</span>&nbsp;<span class="op" id="2625150">=</span>&nbsp;<span class="ident" id="2625152">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2625171">nfd</span><span class="op" id="2625174">,</span>&nbsp;<span class="ident" id="2625176">err</span>&nbsp;<span class="op" id="2625180">=</span>&nbsp;<span class="ident" id="2625182">accept</span><span class="op" id="2625188">(</span><span class="ident" id="2625189">fd</span><span class="op" id="2625191">,</span>&nbsp;<span class="op" id="2625193">&amp;</span><span class="ident" id="2625194">rsa</span><span class="op" id="2625197">,</span>&nbsp;<span class="op" id="2625199">&amp;</span><span class="builtinfunc" id="2625200">len</span><span class="op" id="2625203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625206">if</span>&nbsp;<span class="ident" id="2625209">err</span>&nbsp;<span class="op" id="2625213">!=</span>&nbsp;<span class="ident" id="2625216">nil</span>&nbsp;<span class="op" id="2625220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625224">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2625232">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2625235">sa</span><span class="op" id="2625237">,</span>&nbsp;<span class="ident" id="2625239">err</span>&nbsp;<span class="op" id="2625243">=</span>&nbsp;<span class="ident" id="2625245">anyToSockaddr</span><span class="op" id="2625258">(</span><span class="op" id="2625259">&amp;</span><span class="ident" id="2625260">rsa</span><span class="op" id="2625263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625266">if</span>&nbsp;<span class="ident" id="2625269">err</span>&nbsp;<span class="op" id="2625273">!=</span>&nbsp;<span class="ident" id="2625276">nil</span>&nbsp;<span class="op" id="2625280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2625284">Close</span><span class="op" id="2625289">(</span><span class="ident" id="2625290">nfd</span><span class="op" id="2625293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2625297">nfd</span>&nbsp;<span class="op" id="2625301">=</span>&nbsp;<span class="num" id="2625303">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2625306">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625309">return</span><br>
<span class="lineno"></span><span class="op" id="2625316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2625319">func</span>&nbsp;<span class="ident" id="2625324">Accept4</span><span class="op" id="2625331">(</span><span class="ident" id="2625332">fd</span>&nbsp;<span class="builtintype" id="2625335">int</span><span class="op" id="2625338">,</span>&nbsp;<span class="ident" id="2625340">flags</span>&nbsp;<span class="builtintype" id="2625346">int</span><span class="op" id="2625349">)</span>&nbsp;<span class="op" id="2625351">(</span><span class="ident" id="2625352">nfd</span>&nbsp;<span class="builtintype" id="2625356">int</span><span class="op" id="2625359">,</span>&nbsp;<span class="ident" id="2625361">sa</span>&nbsp;<span class="ident" id="2625364">Sockaddr</span><span class="op" id="2625372">,</span>&nbsp;<span class="ident" id="2625374">err</span>&nbsp;<span class="builtintype" id="2625378">error</span><span class="op" id="2625383">)</span>&nbsp;<span class="op" id="2625385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625388">var</span>&nbsp;<span class="ident" id="2625392">rsa</span>&nbsp;<span class="ident" id="2625396">RawSockaddrAny</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625412">var</span>&nbsp;<span class="builtinfunc" id="2625416">len</span>&nbsp;<span class="ident" id="2625420">_Socklen</span>&nbsp;<span class="op" id="2625429">=</span>&nbsp;<span class="ident" id="2625431">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2625450">nfd</span><span class="op" id="2625453">,</span>&nbsp;<span class="ident" id="2625455">err</span>&nbsp;<span class="op" id="2625459">=</span>&nbsp;<span class="ident" id="2625461">accept4</span><span class="op" id="2625468">(</span><span class="ident" id="2625469">fd</span><span class="op" id="2625471">,</span>&nbsp;<span class="op" id="2625473">&amp;</span><span class="ident" id="2625474">rsa</span><span class="op" id="2625477">,</span>&nbsp;<span class="op" id="2625479">&amp;</span><span class="builtinfunc" id="2625480">len</span><span class="op" id="2625483">,</span>&nbsp;<span class="ident" id="2625485">flags</span><span class="op" id="2625490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625493">if</span>&nbsp;<span class="ident" id="2625496">err</span>&nbsp;<span class="op" id="2625500">!=</span>&nbsp;<span class="ident" id="2625503">nil</span>&nbsp;<span class="op" id="2625507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625511">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2625519">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625522">if</span>&nbsp;<span class="builtinfunc" id="2625525">len</span>&nbsp;<span class="op" id="2625529">&gt;</span>&nbsp;<span class="ident" id="2625531">SizeofSockaddrAny</span>&nbsp;<span class="op" id="2625549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2625553">panic</span><span class="op" id="2625558">(</span><span class="string" id="2625559">&#34;RawSockaddrAny&nbsp;too&nbsp;small&#34;</span><span class="op" id="2625585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2625588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2625591">sa</span><span class="op" id="2625593">,</span>&nbsp;<span class="ident" id="2625595">err</span>&nbsp;<span class="op" id="2625599">=</span>&nbsp;<span class="ident" id="2625601">anyToSockaddr</span><span class="op" id="2625614">(</span><span class="op" id="2625615">&amp;</span><span class="ident" id="2625616">rsa</span><span class="op" id="2625619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625622">if</span>&nbsp;<span class="ident" id="2625625">err</span>&nbsp;<span class="op" id="2625629">!=</span>&nbsp;<span class="ident" id="2625632">nil</span>&nbsp;<span class="op" id="2625636">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2625640">Close</span><span class="op" id="2625645">(</span><span class="ident" id="2625646">nfd</span><span class="op" id="2625649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2625653">nfd</span>&nbsp;<span class="op" id="2625657">=</span>&nbsp;<span class="num" id="2625659">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2625662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625665">return</span><br>
<span class="lineno"></span><span class="op" id="2625672">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="2625675">func</span>&nbsp;<span class="ident" id="2625680">Getsockname</span><span class="op" id="2625691">(</span><span class="ident" id="2625692">fd</span>&nbsp;<span class="builtintype" id="2625695">int</span><span class="op" id="2625698">)</span>&nbsp;<span class="op" id="2625700">(</span><span class="ident" id="2625701">sa</span>&nbsp;<span class="ident" id="2625704">Sockaddr</span><span class="op" id="2625712">,</span>&nbsp;<span class="ident" id="2625714">err</span>&nbsp;<span class="builtintype" id="2625718">error</span><span class="op" id="2625723">)</span>&nbsp;<span class="op" id="2625725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625728">var</span>&nbsp;<span class="ident" id="2625732">rsa</span>&nbsp;<span class="ident" id="2625736">RawSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625752">var</span>&nbsp;<span class="builtinfunc" id="2625756">len</span>&nbsp;<span class="ident" id="2625760">_Socklen</span>&nbsp;<span class="op" id="2625769">=</span>&nbsp;<span class="ident" id="2625771">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625790">if</span>&nbsp;<span class="ident" id="2625793">err</span>&nbsp;<span class="op" id="2625797">=</span>&nbsp;<span class="ident" id="2625799">getsockname</span><span class="op" id="2625810">(</span><span class="ident" id="2625811">fd</span><span class="op" id="2625813">,</span>&nbsp;<span class="op" id="2625815">&amp;</span><span class="ident" id="2625816">rsa</span><span class="op" id="2625819">,</span>&nbsp;<span class="op" id="2625821">&amp;</span><span class="builtinfunc" id="2625822">len</span><span class="op" id="2625825">)</span><span class="op" id="2625826">;</span>&nbsp;<span class="ident" id="2625828">err</span>&nbsp;<span class="op" id="2625832">!=</span>&nbsp;<span class="ident" id="2625835">nil</span>&nbsp;<span class="op" id="2625839">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625843">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2625851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2625854">return</span>&nbsp;<span class="ident" id="2625861">anyToSockaddr</span><span class="op" id="2625874">(</span><span class="op" id="2625875">&amp;</span><span class="ident" id="2625876">rsa</span><span class="op" id="2625879">)</span><br>
<span class="lineno"></span><span class="op" id="2625881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span><span class="keyword" id="2625884">func</span>&nbsp;<span class="ident" id="2625889">GetsockoptInet4Addr</span><span class="op" id="2625908">(</span><span class="ident" id="2625909">fd</span><span class="op" id="2625911">,</span>&nbsp;<span class="ident" id="2625913">level</span><span class="op" id="2625918">,</span>&nbsp;<span class="ident" id="2625920">opt</span>&nbsp;<span class="builtintype" id="2625924">int</span><span class="op" id="2625927">)</span>&nbsp;<span class="op" id="2625929">(</span><span class="ident" id="2625930">value</span>&nbsp;<span class="op" id="2625936">[</span><span class="num" id="2625937">4</span><span class="op" id="2625938">]</span><span class="builtintype" id="2625939">byte</span><span class="op" id="2625943">,</span>&nbsp;<span class="ident" id="2625945">err</span>&nbsp;<span class="builtintype" id="2625949">error</span><span class="op" id="2625954">)</span>&nbsp;<span class="op" id="2625956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2625959">vallen</span>&nbsp;<span class="op" id="2625966">:=</span>&nbsp;<span class="ident" id="2625969">_Socklen</span><span class="op" id="2625977">(</span><span class="num" id="2625978">4</span><span class="op" id="2625979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2625982">err</span>&nbsp;<span class="op" id="2625986">=</span>&nbsp;<span class="ident" id="2625988">getsockopt</span><span class="op" id="2625998">(</span><span class="ident" id="2625999">fd</span><span class="op" id="2626001">,</span>&nbsp;<span class="ident" id="2626003">level</span><span class="op" id="2626008">,</span>&nbsp;<span class="ident" id="2626010">opt</span><span class="op" id="2626013">,</span>&nbsp;<span class="ident" id="2626015">unsafe</span><span class="op" id="2626021">.</span><span class="ident" id="2626022">Pointer</span><span class="op" id="2626029">(</span><span class="op" id="2626030">&amp;</span><span class="ident" id="2626031">value</span><span class="op" id="2626036">[</span><span class="num" id="2626037">0</span><span class="op" id="2626038">]</span><span class="op" id="2626039">)</span><span class="op" id="2626040">,</span>&nbsp;<span class="op" id="2626042">&amp;</span><span class="ident" id="2626043">vallen</span><span class="op" id="2626049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626052">return</span>&nbsp;<span class="ident" id="2626059">value</span><span class="op" id="2626064">,</span>&nbsp;<span class="ident" id="2626066">err</span><br>
<span class="lineno"></span><span class="op" id="2626070">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="keyword" id="2626073">func</span>&nbsp;<span class="ident" id="2626078">GetsockoptIPMreq</span><span class="op" id="2626094">(</span><span class="ident" id="2626095">fd</span><span class="op" id="2626097">,</span>&nbsp;<span class="ident" id="2626099">level</span><span class="op" id="2626104">,</span>&nbsp;<span class="ident" id="2626106">opt</span>&nbsp;<span class="builtintype" id="2626110">int</span><span class="op" id="2626113">)</span>&nbsp;<span class="op" id="2626115">(</span><span class="op" id="2626116">*</span><span class="ident" id="2626117">IPMreq</span><span class="op" id="2626123">,</span>&nbsp;<span class="builtintype" id="2626125">error</span><span class="op" id="2626130">)</span>&nbsp;<span class="op" id="2626132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626135">var</span>&nbsp;<span class="ident" id="2626139">value</span>&nbsp;<span class="ident" id="2626145">IPMreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626153">vallen</span>&nbsp;<span class="op" id="2626160">:=</span>&nbsp;<span class="ident" id="2626163">_Socklen</span><span class="op" id="2626171">(</span><span class="ident" id="2626172">SizeofIPMreq</span><span class="op" id="2626184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626187">err</span>&nbsp;<span class="op" id="2626191">:=</span>&nbsp;<span class="ident" id="2626194">getsockopt</span><span class="op" id="2626204">(</span><span class="ident" id="2626205">fd</span><span class="op" id="2626207">,</span>&nbsp;<span class="ident" id="2626209">level</span><span class="op" id="2626214">,</span>&nbsp;<span class="ident" id="2626216">opt</span><span class="op" id="2626219">,</span>&nbsp;<span class="ident" id="2626221">unsafe</span><span class="op" id="2626227">.</span><span class="ident" id="2626228">Pointer</span><span class="op" id="2626235">(</span><span class="op" id="2626236">&amp;</span><span class="ident" id="2626237">value</span><span class="op" id="2626242">)</span><span class="op" id="2626243">,</span>&nbsp;<span class="op" id="2626245">&amp;</span><span class="ident" id="2626246">vallen</span><span class="op" id="2626252">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626255">return</span>&nbsp;<span class="op" id="2626262">&amp;</span><span class="ident" id="2626263">value</span><span class="op" id="2626268">,</span>&nbsp;<span class="ident" id="2626270">err</span><br>
<span class="lineno"></span><span class="op" id="2626274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2626277">func</span>&nbsp;<span class="ident" id="2626282">GetsockoptIPMreqn</span><span class="op" id="2626299">(</span><span class="ident" id="2626300">fd</span><span class="op" id="2626302">,</span>&nbsp;<span class="ident" id="2626304">level</span><span class="op" id="2626309">,</span>&nbsp;<span class="ident" id="2626311">opt</span>&nbsp;<span class="builtintype" id="2626315">int</span><span class="op" id="2626318">)</span>&nbsp;<span class="op" id="2626320">(</span><span class="op" id="2626321">*</span><span class="ident" id="2626322">IPMreqn</span><span class="op" id="2626329">,</span>&nbsp;<span class="builtintype" id="2626331">error</span><span class="op" id="2626336">)</span>&nbsp;<span class="op" id="2626338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626341">var</span>&nbsp;<span class="ident" id="2626345">value</span>&nbsp;<span class="ident" id="2626351">IPMreqn</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626360">vallen</span>&nbsp;<span class="op" id="2626367">:=</span>&nbsp;<span class="ident" id="2626370">_Socklen</span><span class="op" id="2626378">(</span><span class="ident" id="2626379">SizeofIPMreqn</span><span class="op" id="2626392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626395">err</span>&nbsp;<span class="op" id="2626399">:=</span>&nbsp;<span class="ident" id="2626402">getsockopt</span><span class="op" id="2626412">(</span><span class="ident" id="2626413">fd</span><span class="op" id="2626415">,</span>&nbsp;<span class="ident" id="2626417">level</span><span class="op" id="2626422">,</span>&nbsp;<span class="ident" id="2626424">opt</span><span class="op" id="2626427">,</span>&nbsp;<span class="ident" id="2626429">unsafe</span><span class="op" id="2626435">.</span><span class="ident" id="2626436">Pointer</span><span class="op" id="2626443">(</span><span class="op" id="2626444">&amp;</span><span class="ident" id="2626445">value</span><span class="op" id="2626450">)</span><span class="op" id="2626451">,</span>&nbsp;<span class="op" id="2626453">&amp;</span><span class="ident" id="2626454">vallen</span><span class="op" id="2626460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626463">return</span>&nbsp;<span class="op" id="2626470">&amp;</span><span class="ident" id="2626471">value</span><span class="op" id="2626476">,</span>&nbsp;<span class="ident" id="2626478">err</span><br>
<span class="lineno"></span><span class="op" id="2626482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="keyword" id="2626485">func</span>&nbsp;<span class="ident" id="2626490">GetsockoptIPv6Mreq</span><span class="op" id="2626508">(</span><span class="ident" id="2626509">fd</span><span class="op" id="2626511">,</span>&nbsp;<span class="ident" id="2626513">level</span><span class="op" id="2626518">,</span>&nbsp;<span class="ident" id="2626520">opt</span>&nbsp;<span class="builtintype" id="2626524">int</span><span class="op" id="2626527">)</span>&nbsp;<span class="op" id="2626529">(</span><span class="op" id="2626530">*</span><span class="ident" id="2626531">IPv6Mreq</span><span class="op" id="2626539">,</span>&nbsp;<span class="builtintype" id="2626541">error</span><span class="op" id="2626546">)</span>&nbsp;<span class="op" id="2626548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626551">var</span>&nbsp;<span class="ident" id="2626555">value</span>&nbsp;<span class="ident" id="2626561">IPv6Mreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626571">vallen</span>&nbsp;<span class="op" id="2626578">:=</span>&nbsp;<span class="ident" id="2626581">_Socklen</span><span class="op" id="2626589">(</span><span class="ident" id="2626590">SizeofIPv6Mreq</span><span class="op" id="2626604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626607">err</span>&nbsp;<span class="op" id="2626611">:=</span>&nbsp;<span class="ident" id="2626614">getsockopt</span><span class="op" id="2626624">(</span><span class="ident" id="2626625">fd</span><span class="op" id="2626627">,</span>&nbsp;<span class="ident" id="2626629">level</span><span class="op" id="2626634">,</span>&nbsp;<span class="ident" id="2626636">opt</span><span class="op" id="2626639">,</span>&nbsp;<span class="ident" id="2626641">unsafe</span><span class="op" id="2626647">.</span><span class="ident" id="2626648">Pointer</span><span class="op" id="2626655">(</span><span class="op" id="2626656">&amp;</span><span class="ident" id="2626657">value</span><span class="op" id="2626662">)</span><span class="op" id="2626663">,</span>&nbsp;<span class="op" id="2626665">&amp;</span><span class="ident" id="2626666">vallen</span><span class="op" id="2626672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626675">return</span>&nbsp;<span class="op" id="2626682">&amp;</span><span class="ident" id="2626683">value</span><span class="op" id="2626688">,</span>&nbsp;<span class="ident" id="2626690">err</span><br>
<span class="lineno">470</span><span class="op" id="2626694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2626697">func</span>&nbsp;<span class="ident" id="2626702">GetsockoptIPv6MTUInfo</span><span class="op" id="2626723">(</span><span class="ident" id="2626724">fd</span><span class="op" id="2626726">,</span>&nbsp;<span class="ident" id="2626728">level</span><span class="op" id="2626733">,</span>&nbsp;<span class="ident" id="2626735">opt</span>&nbsp;<span class="builtintype" id="2626739">int</span><span class="op" id="2626742">)</span>&nbsp;<span class="op" id="2626744">(</span><span class="op" id="2626745">*</span><span class="ident" id="2626746">IPv6MTUInfo</span><span class="op" id="2626757">,</span>&nbsp;<span class="builtintype" id="2626759">error</span><span class="op" id="2626764">)</span>&nbsp;<span class="op" id="2626766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626769">var</span>&nbsp;<span class="ident" id="2626773">value</span>&nbsp;<span class="ident" id="2626779">IPv6MTUInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626792">vallen</span>&nbsp;<span class="op" id="2626799">:=</span>&nbsp;<span class="ident" id="2626802">_Socklen</span><span class="op" id="2626810">(</span><span class="ident" id="2626811">SizeofIPv6MTUInfo</span><span class="op" id="2626828">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2626831">err</span>&nbsp;<span class="op" id="2626835">:=</span>&nbsp;<span class="ident" id="2626838">getsockopt</span><span class="op" id="2626848">(</span><span class="ident" id="2626849">fd</span><span class="op" id="2626851">,</span>&nbsp;<span class="ident" id="2626853">level</span><span class="op" id="2626858">,</span>&nbsp;<span class="ident" id="2626860">opt</span><span class="op" id="2626863">,</span>&nbsp;<span class="ident" id="2626865">unsafe</span><span class="op" id="2626871">.</span><span class="ident" id="2626872">Pointer</span><span class="op" id="2626879">(</span><span class="op" id="2626880">&amp;</span><span class="ident" id="2626881">value</span><span class="op" id="2626886">)</span><span class="op" id="2626887">,</span>&nbsp;<span class="op" id="2626889">&amp;</span><span class="ident" id="2626890">vallen</span><span class="op" id="2626896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626899">return</span>&nbsp;<span class="op" id="2626906">&amp;</span><span class="ident" id="2626907">value</span><span class="op" id="2626912">,</span>&nbsp;<span class="ident" id="2626914">err</span><br>
<span class="lineno"></span><span class="op" id="2626918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2626921">func</span>&nbsp;<span class="ident" id="2626926">GetsockoptICMPv6Filter</span><span class="op" id="2626948">(</span><span class="ident" id="2626949">fd</span><span class="op" id="2626951">,</span>&nbsp;<span class="ident" id="2626953">level</span><span class="op" id="2626958">,</span>&nbsp;<span class="ident" id="2626960">opt</span>&nbsp;<span class="builtintype" id="2626964">int</span><span class="op" id="2626967">)</span>&nbsp;<span class="op" id="2626969">(</span><span class="op" id="2626970">*</span><span class="ident" id="2626971">ICMPv6Filter</span><span class="op" id="2626983">,</span>&nbsp;<span class="builtintype" id="2626985">error</span><span class="op" id="2626990">)</span>&nbsp;<span class="op" id="2626992">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2626995">var</span>&nbsp;<span class="ident" id="2626999">value</span>&nbsp;<span class="ident" id="2627005">ICMPv6Filter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2627019">vallen</span>&nbsp;<span class="op" id="2627026">:=</span>&nbsp;<span class="ident" id="2627029">_Socklen</span><span class="op" id="2627037">(</span><span class="ident" id="2627038">SizeofICMPv6Filter</span><span class="op" id="2627056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2627059">err</span>&nbsp;<span class="op" id="2627063">:=</span>&nbsp;<span class="ident" id="2627066">getsockopt</span><span class="op" id="2627076">(</span><span class="ident" id="2627077">fd</span><span class="op" id="2627079">,</span>&nbsp;<span class="ident" id="2627081">level</span><span class="op" id="2627086">,</span>&nbsp;<span class="ident" id="2627088">opt</span><span class="op" id="2627091">,</span>&nbsp;<span class="ident" id="2627093">unsafe</span><span class="op" id="2627099">.</span><span class="ident" id="2627100">Pointer</span><span class="op" id="2627107">(</span><span class="op" id="2627108">&amp;</span><span class="ident" id="2627109">value</span><span class="op" id="2627114">)</span><span class="op" id="2627115">,</span>&nbsp;<span class="op" id="2627117">&amp;</span><span class="ident" id="2627118">vallen</span><span class="op" id="2627124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2627127">return</span>&nbsp;<span class="op" id="2627134">&amp;</span><span class="ident" id="2627135">value</span><span class="op" id="2627140">,</span>&nbsp;<span class="ident" id="2627142">err</span><br>
<span class="lineno"></span><span class="op" id="2627146">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="keyword" id="2627149">func</span>&nbsp;<span class="ident" id="2627154">GetsockoptUcred</span><span class="op" id="2627169">(</span><span class="ident" id="2627170">fd</span><span class="op" id="2627172">,</span>&nbsp;<span class="ident" id="2627174">level</span><span class="op" id="2627179">,</span>&nbsp;<span class="ident" id="2627181">opt</span>&nbsp;<span class="builtintype" id="2627185">int</span><span class="op" id="2627188">)</span>&nbsp;<span class="op" id="2627190">(</span><span class="op" id="2627191">*</span><span class="ident" id="2627192">Ucred</span><span class="op" id="2627197">,</span>&nbsp;<span class="builtintype" id="2627199">error</span><span class="op" id="2627204">)</span>&nbsp;<span class="op" id="2627206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2627209">var</span>&nbsp;<span class="ident" id="2627213">value</span>&nbsp;<span class="ident" id="2627219">Ucred</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2627226">vallen</span>&nbsp;<span class="op" id="2627233">:=</span>&nbsp;<span class="ident" id="2627236">_Socklen</span><span class="op" id="2627244">(</span><span class="ident" id="2627245">SizeofUcred</span><span class="op" id="2627256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2627259">err</span>&nbsp;<span class="op" id="2627263">:=</span>&nbsp;<span class="ident" id="2627266">getsockopt</span><span class="op" id="2627276">(</span><span class="ident" id="2627277">fd</span><span class="op" id="2627279">,</span>&nbsp;<span class="ident" id="2627281">level</span><span class="op" id="2627286">,</span>&nbsp;<span class="ident" id="2627288">opt</span><span class="op" id="2627291">,</span>&nbsp;<span class="ident" id="2627293">unsafe</span><span class="op" id="2627299">.</span><span class="ident" id="2627300">Pointer</span><span class="op" id="2627307">(</span><span class="op" id="2627308">&amp;</span><span class="ident" id="2627309">value</span><span class="op" id="2627314">)</span><span class="op" id="2627315">,</span>&nbsp;<span class="op" id="2627317">&amp;</span><span class="ident" id="2627318">vallen</span><span class="op" id="2627324">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2627327">return</span>&nbsp;<span class="op" id="2627334">&amp;</span><span class="ident" id="2627335">value</span><span class="op" id="2627340">,</span>&nbsp;<span class="ident" id="2627342">err</span><br>
<span class="lineno"></span><span class="op" id="2627346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2627349">func</span>&nbsp;<span class="ident" id="2627354">SetsockoptIPMreqn</span><span class="op" id="2627371">(</span><span class="ident" id="2627372">fd</span><span class="op" id="2627374">,</span>&nbsp;<span class="ident" id="2627376">level</span><span class="op" id="2627381">,</span>&nbsp;<span class="ident" id="2627383">opt</span>&nbsp;<span class="builtintype" id="2627387">int</span><span class="op" id="2627390">,</span>&nbsp;<span class="ident" id="2627392">mreq</span>&nbsp;<span class="op" id="2627397">*</span><span class="ident" id="2627398">IPMreqn</span><span class="op" id="2627405">)</span>&nbsp;<span class="op" id="2627407">(</span><span class="ident" id="2627408">err</span>&nbsp;<span class="builtintype" id="2627412">error</span><span class="op" id="2627417">)</span>&nbsp;<span class="op" id="2627419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2627422">return</span>&nbsp;<span class="ident" id="2627429">setsockopt</span><span class="op" id="2627439">(</span><span class="ident" id="2627440">fd</span><span class="op" id="2627442">,</span>&nbsp;<span class="ident" id="2627444">level</span><span class="op" id="2627449">,</span>&nbsp;<span class="ident" id="2627451">opt</span><span class="op" id="2627454">,</span>&nbsp;<span class="ident" id="2627456">unsafe</span><span class="op" id="2627462">.</span><span class="ident" id="2627463">Pointer</span><span class="op" id="2627470">(</span><span class="ident" id="2627471">mreq</span><span class="op" id="2627475">)</span><span class="op" id="2627476">,</span>&nbsp;<span class="ident" id="2627478">unsafe</span><span class="op" id="2627484">.</span><span class="ident" id="2627485">Sizeof</span><span class="op" id="2627491">(</span><span class="op" id="2627492">*</span><span class="ident" id="2627493">mreq</span><span class="op" id="2627497">)</span><span class="op" id="2627498">)</span><br>
<span class="lineno">495</span><span class="op" id="2627500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2627503">func</span>&nbsp;<span class="ident" id="2627508">Recvmsg</span><span class="op" id="2627515">(</span><span class="ident" id="2627516">fd</span>&nbsp;<span class="builtintype" id="2627519">int</span><span class="op" id="2627522">,</span>&nbsp;<span class="ident" id="2627524">p</span><span class="op" id="2627525">,</span>&nbsp;<span class="ident" id="2627527">oob</span>&nbsp;<span class="op" id="2627531">[</span><span class="op" id="2627532">]</span><span class="builtintype" id="2627533">byte</span><span class="op" id="2627537">,</span>&nbsp;<span class="ident" id="2627539">flags</span>&nbsp;<span class="builtintype" id="2627545">int</span><span class="op" id="2627548">)</span>&nbsp;<span class="op" id="2627550">(</span><span class="ident" id="2627551">n</span><span class="op" id="2627552">,</span>&nbsp;<span class="ident" id="2627554">oobn</span>&nbsp;<span class="builtintype" id="2627559">int</span><span class="op" id="2627562">,</span>&nbsp;<span class="ident" id="2627564">recvflags</span>&nbsp;<span class="builtintype" id="2627574">int</span><span class="op" id="2627577">,</span>&nbsp;<span class="ident" id="2627579">from</span>&nbsp;<span class="ident" id="2627584">Sockaddr</span><span class="op" id="2627592">,</span>&nbsp;<span class="ident" id="2627594">err</span>&nbsp;<span class="builtintype" id="2627598">error</span><span class="op" id="2627603">)</span>&nbsp;<span class="op" id="2627605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2627608">var</span>&nbsp;<span class="ident" id="2627612">msg</span>&nbsp;<span class="ident" id="2627616">Msghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2627624">var</span>&nbsp;<span class="ident" id="2627628">rsa</span>&nbsp;<span class="ident" id="2627632">RawSockaddrAny</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2627648">msg</span><span class="op" id="2627651">.</span><span class="ident" id="2627652">Name</span>&nbsp;<span class="op" id="2627657">=</span>&nbsp;<span class="op" id="2627659">(</span><span class="op" id="2627660">*</span><span class="builtintype" id="2627661">byte</span><span class="op" id="2627665">)</span><span class="op" id="2627666">(</span><span class="ident" id="2627667">unsafe</span><span class="op" id="2627673">.</span><span class="ident" id="2627674">Pointer</span><span class="op" id="2627681">(</span><span class="op" id="2627682">&amp;</span><span class="ident" id="2627683">rsa</span><span class="op" id="2627686">)</span><span class="op" id="2627687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2627690">msg</span><span class="op" id="2627693">.</span><span class="ident" id="2627694">Namelen</span>&nbsp;<span class="op" id="2627702">=</span>&nbsp;<span class="builtintype" id="2627704">uint32</span><span class="op" id="2627710">(</span><span class="ident" id="2627711">SizeofSockaddrAny</span><span class="op" id="2627728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2627731">var</span>&nbsp;<span class="ident" id="2627735">iov</span>&nbsp;<span class="ident" id="2627739">Iovec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2627746">if</span>&nbsp;<span class="builtinfunc" id="2627749">len</span><span class="op" id="2627752">(</span><span class="ident" id="2627753">p</span><span class="op" id="2627754">)</span>&nbsp;<span class="op" id="2627756">&gt;</span>&nbsp;<span class="num" id="2627758">0</span>&nbsp;<span class="op" id="2627760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2627764">iov</span><span class="op" id="2627767">.</span><span class="ident" id="2627768">Base</span>&nbsp;<span class="op" id="2627773">=</span>&nbsp;<span class="op" id="2627775">(</span><span class="op" id="2627776">*</span><span class="builtintype" id="2627777">byte</span><span class="op" id="2627781">)</span><span class="op" id="2627782">(</span><span class="ident" id="2627783">unsafe</span><span class="op" id="2627789">.</span><span class="ident" id="2627790">Pointer</span><span class="op" id="2627797">(</span><span class="op" id="2627798">&amp;</span><span class="ident" id="2627799">p</span><span class="op" id="2627800">[</span><span class="num" id="2627801">0</span><span class="op" id="2627802">]</span><span class="op" id="2627803">)</span><span class="op" id="2627804">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2627808">iov</span><span class="op" id="2627811">.</span><span class="ident" id="2627812">SetLen</span><span class="op" id="2627818">(</span><span class="builtinfunc" id="2627819">len</span><span class="op" id="2627822">(</span><span class="ident" id="2627823">p</span><span class="op" id="2627824">)</span><span class="op" id="2627825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2627828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2627831">var</span>&nbsp;<span class="ident" id="2627835">dummy</span>&nbsp;<span class="builtintype" id="2627841">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2627847">if</span>&nbsp;<span class="builtinfunc" id="2627850">len</span><span class="op" id="2627853">(</span><span class="ident" id="2627854">oob</span><span class="op" id="2627857">)</span>&nbsp;<span class="op" id="2627859">&gt;</span>&nbsp;<span class="num" id="2627861">0</span>&nbsp;<span class="op" id="2627863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2627867">//&nbsp;receive&nbsp;at&nbsp;least&nbsp;one&nbsp;normal&nbsp;byte</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2627905">if</span>&nbsp;<span class="builtinfunc" id="2627908">len</span><span class="op" id="2627911">(</span><span class="ident" id="2627912">p</span><span class="op" id="2627913">)</span>&nbsp;<span class="op" id="2627915">==</span>&nbsp;<span class="num" id="2627918">0</span>&nbsp;<span class="op" id="2627920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2627925">iov</span><span class="op" id="2627928">.</span><span class="ident" id="2627929">Base</span>&nbsp;<span class="op" id="2627934">=</span>&nbsp;<span class="op" id="2627936">&amp;</span><span class="ident" id="2627937">dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2627946">iov</span><span class="op" id="2627949">.</span><span class="ident" id="2627950">SetLen</span><span class="op" id="2627956">(</span><span class="num" id="2627957">1</span><span class="op" id="2627958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2627962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2627966">msg</span><span class="op" id="2627969">.</span><span class="ident" id="2627970">Control</span>&nbsp;<span class="op" id="2627978">=</span>&nbsp;<span class="op" id="2627980">(</span><span class="op" id="2627981">*</span><span class="builtintype" id="2627982">byte</span><span class="op" id="2627986">)</span><span class="op" id="2627987">(</span><span class="ident" id="2627988">unsafe</span><span class="op" id="2627994">.</span><span class="ident" id="2627995">Pointer</span><span class="op" id="2628002">(</span><span class="op" id="2628003">&amp;</span><span class="ident" id="2628004">oob</span><span class="op" id="2628007">[</span><span class="num" id="2628008">0</span><span class="op" id="2628009">]</span><span class="op" id="2628010">)</span><span class="op" id="2628011">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2628015">msg</span><span class="op" id="2628018">.</span><span class="ident" id="2628019">SetControllen</span><span class="op" id="2628032">(</span><span class="builtinfunc" id="2628033">len</span><span class="op" id="2628036">(</span><span class="ident" id="2628037">oob</span><span class="op" id="2628040">)</span><span class="op" id="2628041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2628044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2628047">msg</span><span class="op" id="2628050">.</span><span class="ident" id="2628051">Iov</span>&nbsp;<span class="op" id="2628055">=</span>&nbsp;<span class="op" id="2628057">&amp;</span><span class="ident" id="2628058">iov</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2628063">msg</span><span class="op" id="2628066">.</span><span class="ident" id="2628067">Iovlen</span>&nbsp;<span class="op" id="2628074">=</span>&nbsp;<span class="num" id="2628076">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2628079">if</span>&nbsp;<span class="ident" id="2628082">n</span><span class="op" id="2628083">,</span>&nbsp;<span class="ident" id="2628085">err</span>&nbsp;<span class="op" id="2628089">=</span>&nbsp;<span class="ident" id="2628091">recvmsg</span><span class="op" id="2628098">(</span><span class="ident" id="2628099">fd</span><span class="op" id="2628101">,</span>&nbsp;<span class="op" id="2628103">&amp;</span><span class="ident" id="2628104">msg</span><span class="op" id="2628107">,</span>&nbsp;<span class="ident" id="2628109">flags</span><span class="op" id="2628114">)</span><span class="op" id="2628115">;</span>&nbsp;<span class="ident" id="2628117">err</span>&nbsp;<span class="op" id="2628121">!=</span>&nbsp;<span class="ident" id="2628124">nil</span>&nbsp;<span class="op" id="2628128">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2628132">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2628140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2628143">oobn</span>&nbsp;<span class="op" id="2628148">=</span>&nbsp;<span class="builtintype" id="2628150">int</span><span class="op" id="2628153">(</span><span class="ident" id="2628154">msg</span><span class="op" id="2628157">.</span><span class="ident" id="2628158">Controllen</span><span class="op" id="2628168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2628171">recvflags</span>&nbsp;<span class="op" id="2628181">=</span>&nbsp;<span class="builtintype" id="2628183">int</span><span class="op" id="2628186">(</span><span class="ident" id="2628187">msg</span><span class="op" id="2628190">.</span><span class="ident" id="2628191">Flags</span><span class="op" id="2628196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2628199">//&nbsp;source&nbsp;address&nbsp;is&nbsp;only&nbsp;specified&nbsp;if&nbsp;the&nbsp;socket&nbsp;is&nbsp;unconnected</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2628265">if</span>&nbsp;<span class="ident" id="2628268">rsa</span><span class="op" id="2628271">.</span><span class="ident" id="2628272">Addr</span><span class="op" id="2628276">.</span><span class="ident" id="2628277">Family</span>&nbsp;<span class="op" id="2628284">!=</span>&nbsp;<span class="ident" id="2628287">AF_UNSPEC</span>&nbsp;<span class="op" id="2628297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2628301">from</span><span class="op" id="2628305">,</span>&nbsp;<span class="ident" id="2628307">err</span>&nbsp;<span class="op" id="2628311">=</span>&nbsp;<span class="ident" id="2628313">anyToSockaddr</span><span class="op" id="2628326">(</span><span class="op" id="2628327">&amp;</span><span class="ident" id="2628328">rsa</span><span class="op" id="2628331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2628334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2628337">return</span><br>
<span class="lineno"></span><span class="op" id="2628344">}</span><br>
<span class="lineno">530</span><br>
<span class="lineno"></span><span class="keyword" id="2628347">func</span>&nbsp;<span class="ident" id="2628352">Sendmsg</span><span class="op" id="2628359">(</span><span class="ident" id="2628360">fd</span>&nbsp;<span class="builtintype" id="2628363">int</span><span class="op" id="2628366">,</span>&nbsp;<span class="ident" id="2628368">p</span><span class="op" id="2628369">,</span>&nbsp;<span class="ident" id="2628371">oob</span>&nbsp;<span class="op" id="2628375">[</span><span class="op" id="2628376">]</span><span class="builtintype" id="2628377">byte</span><span class="op" id="2628381">,</span>&nbsp;<span class="ident" id="2628383">to</span>&nbsp;<span class="ident" id="2628386">Sockaddr</span><span class="op" id="2628394">,</span>&nbsp;<span class="ident" id="2628396">flags</span>&nbsp;<span class="builtintype" id="2628402">int</span><span class="op" id="2628405">)</span>&nbsp;<span class="op" id="2628407">(</span><span class="ident" id="2628408">err</span>&nbsp;<span class="builtintype" id="2628412">error</span><span class="op" id="2628417">)</span>&nbsp;<span class="op" id="2628419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2628422">_</span><span class="op" id="2628423">,</span>&nbsp;<span class="ident" id="2628425">err</span>&nbsp;<span class="op" id="2628429">=</span>&nbsp;<span class="ident" id="2628431">SendmsgN</span><span class="op" id="2628439">(</span><span class="ident" id="2628440">fd</span><span class="op" id="2628442">,</span>&nbsp;<span class="ident" id="2628444">p</span><span class="op" id="2628445">,</span>&nbsp;<span class="ident" id="2628447">oob</span><span class="op" id="2628450">,</span>&nbsp;<span class="ident" id="2628452">to</span><span class="op" id="2628454">,</span>&nbsp;<span class="ident" id="2628456">flags</span><span class="op" id="2628461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2628464">return</span><br>
<span class="lineno"></span><span class="op" id="2628471">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="2628474">func</span>&nbsp;<span class="ident" id="2628479">SendmsgN</span><span class="op" id="2628487">(</span><span class="ident" id="2628488">fd</span>&nbsp;<span class="builtintype" id="2628491">int</span><span class="op" id="2628494">,</span>&nbsp;<span class="ident" id="2628496">p</span><span class="op" id="2628497">,</span>&nbsp;<span class="ident" id="2628499">oob</span>&nbsp;<span class="op" id="2628503">[</span><span class="op" id="2628504">]</span><span class="builtintype" id="2628505">byte</span><span class="op" id="2628509">,</span>&nbsp;<span class="ident" id="2628511">to</span>&nbsp;<span class="ident" id="2628514">Sockaddr</span><span class="op" id="2628522">,</span>&nbsp;<span class="ident" id="2628524">flags</span>&nbsp;<span class="builtintype" id="2628530">int</span><span class="op" id="2628533">)</span>&nbsp;<span class="op" id="2628535">(</span><span class="ident" id="2628536">n</span>&nbsp;<span class="builtintype" id="2628538">int</span><span class="op" id="2628541">,</span>&nbsp;<span class="ident" id="2628543">err</span>&nbsp;<span class="builtintype" id="2628547">error</span><span class="op" id="2628552">)</span>&nbsp;<span class="op" id="2628554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2628557">var</span>&nbsp;<span class="ident" id="2628561">ptr</span>&nbsp;<span class="ident" id="2628565">unsafe</span><span class="op" id="2628571">.</span><span class="ident" id="2628572">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2628581">var</span>&nbsp;<span class="ident" id="2628585">salen</span>&nbsp;<span class="ident" id="2628591">_Socklen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2628601">if</span>&nbsp;<span class="ident" id="2628604">to</span>&nbsp;<span class="op" id="2628607">!=</span>&nbsp;<span class="ident" id="2628610">nil</span>&nbsp;<span class="op" id="2628614">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2628618">var</span>&nbsp;<span class="ident" id="2628622">err</span>&nbsp;<span class="builtintype" id="2628626">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2628634">ptr</span><span class="op" id="2628637">,</span>&nbsp;<span class="ident" id="2628639">salen</span><span class="op" id="2628644">,</span>&nbsp;<span class="ident" id="2628646">err</span>&nbsp;<span class="op" id="2628650">=</span>&nbsp;<span class="ident" id="2628652">to</span><span class="op" id="2628654">.</span><span class="ident" id="2628655">sockaddr</span><span class="op" id="2628663">(</span><span class="op" id="2628664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2628668">if</span>&nbsp;<span class="ident" id="2628671">err</span>&nbsp;<span class="op" id="2628675">!=</span>&nbsp;<span class="ident" id="2628678">nil</span>&nbsp;<span class="op" id="2628682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2628687">return</span>&nbsp;<span class="num" id="2628694">0</span><span class="op" id="2628695">,</span>&nbsp;<span class="ident" id="2628697">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2628703">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2628706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2628709">var</span>&nbsp;<span class="ident" id="2628713">msg</span>&nbsp;<span class="ident" id="2628717">Msghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2628725">msg</span><span class="op" id="2628728">.</span><span class="ident" id="2628729">Name</span>&nbsp;<span class="op" id="2628734">=</span>&nbsp;<span class="op" id="2628736">(</span><span class="op" id="2628737">*</span><span class="builtintype" id="2628738">byte</span><span class="op" id="2628742">)</span><span class="op" id="2628743">(</span><span class="ident" id="2628744">unsafe</span><span class="op" id="2628750">.</span><span class="ident" id="2628751">Pointer</span><span class="op" id="2628758">(</span><span class="ident" id="2628759">ptr</span><span class="op" id="2628762">)</span><span class="op" id="2628763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2628766">msg</span><span class="op" id="2628769">.</span><span class="ident" id="2628770">Namelen</span>&nbsp;<span class="op" id="2628778">=</span>&nbsp;<span class="builtintype" id="2628780">uint32</span><span class="op" id="2628786">(</span><span class="ident" id="2628787">salen</span><span class="op" id="2628792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2628795">var</span>&nbsp;<span class="ident" id="2628799">iov</span>&nbsp;<span class="ident" id="2628803">Iovec</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2628810">if</span>&nbsp;<span class="builtinfunc" id="2628813">len</span><span class="op" id="2628816">(</span><span class="ident" id="2628817">p</span><span class="op" id="2628818">)</span>&nbsp;<span class="op" id="2628820">&gt;</span>&nbsp;<span class="num" id="2628822">0</span>&nbsp;<span class="op" id="2628824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2628828">iov</span><span class="op" id="2628831">.</span><span class="ident" id="2628832">Base</span>&nbsp;<span class="op" id="2628837">=</span>&nbsp;<span class="op" id="2628839">(</span><span class="op" id="2628840">*</span><span class="builtintype" id="2628841">byte</span><span class="op" id="2628845">)</span><span class="op" id="2628846">(</span><span class="ident" id="2628847">unsafe</span><span class="op" id="2628853">.</span><span class="ident" id="2628854">Pointer</span><span class="op" id="2628861">(</span><span class="op" id="2628862">&amp;</span><span class="ident" id="2628863">p</span><span class="op" id="2628864">[</span><span class="num" id="2628865">0</span><span class="op" id="2628866">]</span><span class="op" id="2628867">)</span><span class="op" id="2628868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2628872">iov</span><span class="op" id="2628875">.</span><span class="ident" id="2628876">SetLen</span><span class="op" id="2628882">(</span><span class="builtinfunc" id="2628883">len</span><span class="op" id="2628886">(</span><span class="ident" id="2628887">p</span><span class="op" id="2628888">)</span><span class="op" id="2628889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2628892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2628895">var</span>&nbsp;<span class="ident" id="2628899">dummy</span>&nbsp;<span class="builtintype" id="2628905">byte</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2628911">if</span>&nbsp;<span class="builtinfunc" id="2628914">len</span><span class="op" id="2628917">(</span><span class="ident" id="2628918">oob</span><span class="op" id="2628921">)</span>&nbsp;<span class="op" id="2628923">&gt;</span>&nbsp;<span class="num" id="2628925">0</span>&nbsp;<span class="op" id="2628927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2628931">//&nbsp;send&nbsp;at&nbsp;least&nbsp;one&nbsp;normal&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2628966">if</span>&nbsp;<span class="builtinfunc" id="2628969">len</span><span class="op" id="2628972">(</span><span class="ident" id="2628973">p</span><span class="op" id="2628974">)</span>&nbsp;<span class="op" id="2628976">==</span>&nbsp;<span class="num" id="2628979">0</span>&nbsp;<span class="op" id="2628981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2628986">iov</span><span class="op" id="2628989">.</span><span class="ident" id="2628990">Base</span>&nbsp;<span class="op" id="2628995">=</span>&nbsp;<span class="op" id="2628997">&amp;</span><span class="ident" id="2628998">dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2629007">iov</span><span class="op" id="2629010">.</span><span class="ident" id="2629011">SetLen</span><span class="op" id="2629017">(</span><span class="num" id="2629018">1</span><span class="op" id="2629019">)</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2629023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2629027">msg</span><span class="op" id="2629030">.</span><span class="ident" id="2629031">Control</span>&nbsp;<span class="op" id="2629039">=</span>&nbsp;<span class="op" id="2629041">(</span><span class="op" id="2629042">*</span><span class="builtintype" id="2629043">byte</span><span class="op" id="2629047">)</span><span class="op" id="2629048">(</span><span class="ident" id="2629049">unsafe</span><span class="op" id="2629055">.</span><span class="ident" id="2629056">Pointer</span><span class="op" id="2629063">(</span><span class="op" id="2629064">&amp;</span><span class="ident" id="2629065">oob</span><span class="op" id="2629068">[</span><span class="num" id="2629069">0</span><span class="op" id="2629070">]</span><span class="op" id="2629071">)</span><span class="op" id="2629072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2629076">msg</span><span class="op" id="2629079">.</span><span class="ident" id="2629080">SetControllen</span><span class="op" id="2629093">(</span><span class="builtinfunc" id="2629094">len</span><span class="op" id="2629097">(</span><span class="ident" id="2629098">oob</span><span class="op" id="2629101">)</span><span class="op" id="2629102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2629105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2629108">msg</span><span class="op" id="2629111">.</span><span class="ident" id="2629112">Iov</span>&nbsp;<span class="op" id="2629116">=</span>&nbsp;<span class="op" id="2629118">&amp;</span><span class="ident" id="2629119">iov</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2629124">msg</span><span class="op" id="2629127">.</span><span class="ident" id="2629128">Iovlen</span>&nbsp;<span class="op" id="2629135">=</span>&nbsp;<span class="num" id="2629137">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2629140">if</span>&nbsp;<span class="ident" id="2629143">n</span><span class="op" id="2629144">,</span>&nbsp;<span class="ident" id="2629146">err</span>&nbsp;<span class="op" id="2629150">=</span>&nbsp;<span class="ident" id="2629152">sendmsg</span><span class="op" id="2629159">(</span><span class="ident" id="2629160">fd</span><span class="op" id="2629162">,</span>&nbsp;<span class="op" id="2629164">&amp;</span><span class="ident" id="2629165">msg</span><span class="op" id="2629168">,</span>&nbsp;<span class="ident" id="2629170">flags</span><span class="op" id="2629175">)</span><span class="op" id="2629176">;</span>&nbsp;<span class="ident" id="2629178">err</span>&nbsp;<span class="op" id="2629182">!=</span>&nbsp;<span class="ident" id="2629185">nil</span>&nbsp;<span class="op" id="2629189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2629193">return</span>&nbsp;<span class="num" id="2629200">0</span><span class="op" id="2629201">,</span>&nbsp;<span class="ident" id="2629203">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2629208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2629211">if</span>&nbsp;<span class="builtinfunc" id="2629214">len</span><span class="op" id="2629217">(</span><span class="ident" id="2629218">oob</span><span class="op" id="2629221">)</span>&nbsp;<span class="op" id="2629223">&gt;</span>&nbsp;<span class="num" id="2629225">0</span>&nbsp;<span class="op" id="2629227">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2629230">len</span><span class="op" id="2629233">(</span><span class="ident" id="2629234">p</span><span class="op" id="2629235">)</span>&nbsp;<span class="op" id="2629237">==</span>&nbsp;<span class="num" id="2629240">0</span>&nbsp;<span class="op" id="2629242">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2629246">n</span>&nbsp;<span class="op" id="2629248">=</span>&nbsp;<span class="num" id="2629250">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2629253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2629256">return</span>&nbsp;<span class="ident" id="2629263">n</span><span class="op" id="2629264">,</span>&nbsp;<span class="ident" id="2629266">nil</span><br>
<span class="lineno"></span><span class="op" id="2629270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span><span class="comment" id="2629273">//&nbsp;BindToDevice&nbsp;binds&nbsp;the&nbsp;socket&nbsp;associated&nbsp;with&nbsp;fd&nbsp;to&nbsp;device.</span><br>
<span class="lineno"></span><span class="keyword" id="2629336">func</span>&nbsp;<span class="ident" id="2629341">BindToDevice</span><span class="op" id="2629353">(</span><span class="ident" id="2629354">fd</span>&nbsp;<span class="builtintype" id="2629357">int</span><span class="op" id="2629360">,</span>&nbsp;<span class="ident" id="2629362">device</span>&nbsp;<span class="builtintype" id="2629369">string</span><span class="op" id="2629375">)</span>&nbsp;<span class="op" id="2629377">(</span><span class="ident" id="2629378">err</span>&nbsp;<span class="builtintype" id="2629382">error</span><span class="op" id="2629387">)</span>&nbsp;<span class="op" id="2629389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2629392">return</span>&nbsp;<span class="ident" id="2629399">SetsockoptString</span><span class="op" id="2629415">(</span><span class="ident" id="2629416">fd</span><span class="op" id="2629418">,</span>&nbsp;<span class="ident" id="2629420">SOL_SOCKET</span><span class="op" id="2629430">,</span>&nbsp;<span class="ident" id="2629432">SO_BINDTODEVICE</span><span class="op" id="2629447">,</span>&nbsp;<span class="ident" id="2629449">device</span><span class="op" id="2629455">)</span><br>
<span class="lineno"></span><span class="op" id="2629457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span><span class="comment" id="2629460">//sys&nbsp;&nbsp;&nbsp;&nbspptrace(request&nbsp;int,&nbsp;pid&nbsp;int,&nbsp;addr&nbsp;uintptr,&nbsp;data&nbsp;uintptr)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2629536">func</span>&nbsp;<span class="ident" id="2629541">ptracePeek</span><span class="op" id="2629551">(</span><span class="ident" id="2629552">req</span>&nbsp;<span class="builtintype" id="2629556">int</span><span class="op" id="2629559">,</span>&nbsp;<span class="ident" id="2629561">pid</span>&nbsp;<span class="builtintype" id="2629565">int</span><span class="op" id="2629568">,</span>&nbsp;<span class="ident" id="2629570">addr</span>&nbsp;<span class="builtintype" id="2629575">uintptr</span><span class="op" id="2629582">,</span>&nbsp;<span class="ident" id="2629584">out</span>&nbsp;<span class="op" id="2629588">[</span><span class="op" id="2629589">]</span><span class="builtintype" id="2629590">byte</span><span class="op" id="2629594">)</span>&nbsp;<span class="op" id="2629596">(</span><span class="ident" id="2629597">count</span>&nbsp;<span class="builtintype" id="2629603">int</span><span class="op" id="2629606">,</span>&nbsp;<span class="ident" id="2629608">err</span>&nbsp;<span class="builtintype" id="2629612">error</span><span class="op" id="2629617">)</span>&nbsp;<span class="op" id="2629619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2629622">//&nbsp;The&nbsp;peek&nbsp;requests&nbsp;are&nbsp;machine-size&nbsp;oriented,&nbsp;so&nbsp;we&nbsp;wrap&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2629685">//&nbsp;to&nbsp;retrieve&nbsp;arbitrary-length&nbsp;data.</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2629725">//&nbsp;The&nbsp;ptrace&nbsp;syscall&nbsp;differs&nbsp;from&nbsp;glibc&#39;s&nbsp;ptrace.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2629777">//&nbsp;Peeks&nbsp;returns&nbsp;the&nbsp;word&nbsp;in&nbsp;*data,&nbsp;not&nbsp;as&nbsp;the&nbsp;return&nbsp;value.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2629840">var</span>&nbsp;<span class="ident" id="2629844">buf</span>&nbsp;<span class="op" id="2629848">[</span><span class="ident" id="2629849">sizeofPtr</span><span class="op" id="2629858">]</span><span class="builtintype" id="2629859">byte</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2629866">//&nbsp;Leading&nbsp;edge.&nbsp;&nbsp;PEEKTEXT/PEEKDATA&nbsp;don&#39;t&nbsp;require&nbsp;aligned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2629925">//&nbsp;access&nbsp;(PEEKUSER&nbsp;warns&nbsp;that&nbsp;it&nbsp;might),&nbsp;but&nbsp;if&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2629984">//&nbsp;align&nbsp;our&nbsp;reads,&nbsp;we&nbsp;might&nbsp;straddle&nbsp;an&nbsp;unmapped&nbsp;page</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2630040">//&nbsp;boundary&nbsp;and&nbsp;not&nbsp;get&nbsp;the&nbsp;bytes&nbsp;leading&nbsp;up&nbsp;to&nbsp;the&nbsp;page</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2630098">//&nbsp;boundary.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2630112">n</span>&nbsp;<span class="op" id="2630114">:=</span>&nbsp;<span class="num" id="2630117">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2630120">if</span>&nbsp;<span class="ident" id="2630123">addr</span><span class="op" id="2630127">%</span><span class="ident" id="2630128">sizeofPtr</span>&nbsp;<span class="op" id="2630138">!=</span>&nbsp;<span class="num" id="2630141">0</span>&nbsp;<span class="op" id="2630143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2630147">err</span>&nbsp;<span class="op" id="2630151">=</span>&nbsp;<span class="ident" id="2630153">ptrace</span><span class="op" id="2630159">(</span><span class="ident" id="2630160">req</span><span class="op" id="2630163">,</span>&nbsp;<span class="ident" id="2630165">pid</span><span class="op" id="2630168">,</span>&nbsp;<span class="ident" id="2630170">addr</span><span class="op" id="2630174">-</span><span class="ident" id="2630175">addr</span><span class="op" id="2630179">%</span><span class="ident" id="2630180">sizeofPtr</span><span class="op" id="2630189">,</span>&nbsp;<span class="builtintype" id="2630191">uintptr</span><span class="op" id="2630198">(</span><span class="ident" id="2630199">unsafe</span><span class="op" id="2630205">.</span><span class="ident" id="2630206">Pointer</span><span class="op" id="2630213">(</span><span class="op" id="2630214">&amp;</span><span class="ident" id="2630215">buf</span><span class="op" id="2630218">[</span><span class="num" id="2630219">0</span><span class="op" id="2630220">]</span><span class="op" id="2630221">)</span><span class="op" id="2630222">)</span><span class="op" id="2630223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2630227">if</span>&nbsp;<span class="ident" id="2630230">err</span>&nbsp;<span class="op" id="2630234">!=</span>&nbsp;<span class="ident" id="2630237">nil</span>&nbsp;<span class="op" id="2630241">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2630246">return</span>&nbsp;<span class="num" id="2630253">0</span><span class="op" id="2630254">,</span>&nbsp;<span class="ident" id="2630256">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2630262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2630266">n</span>&nbsp;<span class="op" id="2630268">+=</span>&nbsp;<span class="builtinfunc" id="2630271">copy</span><span class="op" id="2630275">(</span><span class="ident" id="2630276">out</span><span class="op" id="2630279">,</span>&nbsp;<span class="ident" id="2630281">buf</span><span class="op" id="2630284">[</span><span class="ident" id="2630285">addr</span><span class="op" id="2630289">%</span><span class="ident" id="2630290">sizeofPtr</span><span class="op" id="2630299">:</span><span class="op" id="2630300">]</span><span class="op" id="2630301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2630305">out</span>&nbsp;<span class="op" id="2630309">=</span>&nbsp;<span class="ident" id="2630311">out</span><span class="op" id="2630314">[</span><span class="ident" id="2630315">n</span><span class="op" id="2630316">:</span><span class="op" id="2630317">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2630320">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2630324">//&nbsp;Remainder.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2630339">for</span>&nbsp;<span class="builtinfunc" id="2630343">len</span><span class="op" id="2630346">(</span><span class="ident" id="2630347">out</span><span class="op" id="2630350">)</span>&nbsp;<span class="op" id="2630352">&gt;</span>&nbsp;<span class="num" id="2630354">0</span>&nbsp;<span class="op" id="2630356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2630360">//&nbsp;We&nbsp;use&nbsp;an&nbsp;internal&nbsp;buffer&nbsp;to&nbsp;guarantee&nbsp;alignment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2630415">//&nbsp;It&#39;s&nbsp;not&nbsp;documented&nbsp;if&nbsp;this&nbsp;is&nbsp;necessary,&nbsp;but&nbsp;we&#39;re&nbsp;paranoid.</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2630482">err</span>&nbsp;<span class="op" id="2630486">=</span>&nbsp;<span class="ident" id="2630488">ptrace</span><span class="op" id="2630494">(</span><span class="ident" id="2630495">req</span><span class="op" id="2630498">,</span>&nbsp;<span class="ident" id="2630500">pid</span><span class="op" id="2630503">,</span>&nbsp;<span class="ident" id="2630505">addr</span><span class="op" id="2630509">+</span><span class="builtintype" id="2630510">uintptr</span><span class="op" id="2630517">(</span><span class="ident" id="2630518">n</span><span class="op" id="2630519">)</span><span class="op" id="2630520">,</span>&nbsp;<span class="builtintype" id="2630522">uintptr</span><span class="op" id="2630529">(</span><span class="ident" id="2630530">unsafe</span><span class="op" id="2630536">.</span><span class="ident" id="2630537">Pointer</span><span class="op" id="2630544">(</span><span class="op" id="2630545">&amp;</span><span class="ident" id="2630546">buf</span><span class="op" id="2630549">[</span><span class="num" id="2630550">0</span><span class="op" id="2630551">]</span><span class="op" id="2630552">)</span><span class="op" id="2630553">)</span><span class="op" id="2630554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2630558">if</span>&nbsp;<span class="ident" id="2630561">err</span>&nbsp;<span class="op" id="2630565">!=</span>&nbsp;<span class="ident" id="2630568">nil</span>&nbsp;<span class="op" id="2630572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2630577">return</span>&nbsp;<span class="ident" id="2630584">n</span><span class="op" id="2630585">,</span>&nbsp;<span class="ident" id="2630587">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2630593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2630597">copied</span>&nbsp;<span class="op" id="2630604">:=</span>&nbsp;<span class="builtinfunc" id="2630607">copy</span><span class="op" id="2630611">(</span><span class="ident" id="2630612">out</span><span class="op" id="2630615">,</span>&nbsp;<span class="ident" id="2630617">buf</span><span class="op" id="2630620">[</span><span class="num" id="2630621">0</span><span class="op" id="2630622">:</span><span class="op" id="2630623">]</span><span class="op" id="2630624">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2630628">n</span>&nbsp;<span class="op" id="2630630">+=</span>&nbsp;<span class="ident" id="2630633">copied</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2630642">out</span>&nbsp;<span class="op" id="2630646">=</span>&nbsp;<span class="ident" id="2630648">out</span><span class="op" id="2630651">[</span><span class="ident" id="2630652">copied</span><span class="op" id="2630658">:</span><span class="op" id="2630659">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2630662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2630666">return</span>&nbsp;<span class="ident" id="2630673">n</span><span class="op" id="2630674">,</span>&nbsp;<span class="ident" id="2630676">nil</span><br>
<span class="lineno">620</span><span class="op" id="2630680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2630683">func</span>&nbsp;<span class="ident" id="2630688">PtracePeekText</span><span class="op" id="2630702">(</span><span class="ident" id="2630703">pid</span>&nbsp;<span class="builtintype" id="2630707">int</span><span class="op" id="2630710">,</span>&nbsp;<span class="ident" id="2630712">addr</span>&nbsp;<span class="builtintype" id="2630717">uintptr</span><span class="op" id="2630724">,</span>&nbsp;<span class="ident" id="2630726">out</span>&nbsp;<span class="op" id="2630730">[</span><span class="op" id="2630731">]</span><span class="builtintype" id="2630732">byte</span><span class="op" id="2630736">)</span>&nbsp;<span class="op" id="2630738">(</span><span class="ident" id="2630739">count</span>&nbsp;<span class="builtintype" id="2630745">int</span><span class="op" id="2630748">,</span>&nbsp;<span class="ident" id="2630750">err</span>&nbsp;<span class="builtintype" id="2630754">error</span><span class="op" id="2630759">)</span>&nbsp;<span class="op" id="2630761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2630764">return</span>&nbsp;<span class="ident" id="2630771">ptracePeek</span><span class="op" id="2630781">(</span><span class="ident" id="2630782">PTRACE_PEEKTEXT</span><span class="op" id="2630797">,</span>&nbsp;<span class="ident" id="2630799">pid</span><span class="op" id="2630802">,</span>&nbsp;<span class="ident" id="2630804">addr</span><span class="op" id="2630808">,</span>&nbsp;<span class="ident" id="2630810">out</span><span class="op" id="2630813">)</span><br>
<span class="lineno"></span><span class="op" id="2630815">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="2630818">func</span>&nbsp;<span class="ident" id="2630823">PtracePeekData</span><span class="op" id="2630837">(</span><span class="ident" id="2630838">pid</span>&nbsp;<span class="builtintype" id="2630842">int</span><span class="op" id="2630845">,</span>&nbsp;<span class="ident" id="2630847">addr</span>&nbsp;<span class="builtintype" id="2630852">uintptr</span><span class="op" id="2630859">,</span>&nbsp;<span class="ident" id="2630861">out</span>&nbsp;<span class="op" id="2630865">[</span><span class="op" id="2630866">]</span><span class="builtintype" id="2630867">byte</span><span class="op" id="2630871">)</span>&nbsp;<span class="op" id="2630873">(</span><span class="ident" id="2630874">count</span>&nbsp;<span class="builtintype" id="2630880">int</span><span class="op" id="2630883">,</span>&nbsp;<span class="ident" id="2630885">err</span>&nbsp;<span class="builtintype" id="2630889">error</span><span class="op" id="2630894">)</span>&nbsp;<span class="op" id="2630896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2630899">return</span>&nbsp;<span class="ident" id="2630906">ptracePeek</span><span class="op" id="2630916">(</span><span class="ident" id="2630917">PTRACE_PEEKDATA</span><span class="op" id="2630932">,</span>&nbsp;<span class="ident" id="2630934">pid</span><span class="op" id="2630937">,</span>&nbsp;<span class="ident" id="2630939">addr</span><span class="op" id="2630943">,</span>&nbsp;<span class="ident" id="2630945">out</span><span class="op" id="2630948">)</span><br>
<span class="lineno"></span><span class="op" id="2630950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">630</span><span class="keyword" id="2630953">func</span>&nbsp;<span class="ident" id="2630958">ptracePoke</span><span class="op" id="2630968">(</span><span class="ident" id="2630969">pokeReq</span>&nbsp;<span class="builtintype" id="2630977">int</span><span class="op" id="2630980">,</span>&nbsp;<span class="ident" id="2630982">peekReq</span>&nbsp;<span class="builtintype" id="2630990">int</span><span class="op" id="2630993">,</span>&nbsp;<span class="ident" id="2630995">pid</span>&nbsp;<span class="builtintype" id="2630999">int</span><span class="op" id="2631002">,</span>&nbsp;<span class="ident" id="2631004">addr</span>&nbsp;<span class="builtintype" id="2631009">uintptr</span><span class="op" id="2631016">,</span>&nbsp;<span class="ident" id="2631018">data</span>&nbsp;<span class="op" id="2631023">[</span><span class="op" id="2631024">]</span><span class="builtintype" id="2631025">byte</span><span class="op" id="2631029">)</span>&nbsp;<span class="op" id="2631031">(</span><span class="ident" id="2631032">count</span>&nbsp;<span class="builtintype" id="2631038">int</span><span class="op" id="2631041">,</span>&nbsp;<span class="ident" id="2631043">err</span>&nbsp;<span class="builtintype" id="2631047">error</span><span class="op" id="2631052">)</span>&nbsp;<span class="op" id="2631054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2631057">//&nbsp;As&nbsp;for&nbsp;ptracePeek,&nbsp;we&nbsp;need&nbsp;to&nbsp;align&nbsp;our&nbsp;accesses&nbsp;to&nbsp;deal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2631118">//&nbsp;with&nbsp;the&nbsp;possibility&nbsp;of&nbsp;straddling&nbsp;an&nbsp;invalid&nbsp;page.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2631175">//&nbsp;Leading&nbsp;edge.</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2631193">n</span>&nbsp;<span class="op" id="2631195">:=</span>&nbsp;<span class="num" id="2631198">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2631201">if</span>&nbsp;<span class="ident" id="2631204">addr</span><span class="op" id="2631208">%</span><span class="ident" id="2631209">sizeofPtr</span>&nbsp;<span class="op" id="2631219">!=</span>&nbsp;<span class="num" id="2631222">0</span>&nbsp;<span class="op" id="2631224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2631228">var</span>&nbsp;<span class="ident" id="2631232">buf</span>&nbsp;<span class="op" id="2631236">[</span><span class="ident" id="2631237">sizeofPtr</span><span class="op" id="2631246">]</span><span class="builtintype" id="2631247">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2631254">err</span>&nbsp;<span class="op" id="2631258">=</span>&nbsp;<span class="ident" id="2631260">ptrace</span><span class="op" id="2631266">(</span><span class="ident" id="2631267">peekReq</span><span class="op" id="2631274">,</span>&nbsp;<span class="ident" id="2631276">pid</span><span class="op" id="2631279">,</span>&nbsp;<span class="ident" id="2631281">addr</span><span class="op" id="2631285">-</span><span class="ident" id="2631286">addr</span><span class="op" id="2631290">%</span><span class="ident" id="2631291">sizeofPtr</span><span class="op" id="2631300">,</span>&nbsp;<span class="builtintype" id="2631302">uintptr</span><span class="op" id="2631309">(</span><span class="ident" id="2631310">unsafe</span><span class="op" id="2631316">.</span><span class="ident" id="2631317">Pointer</span><span class="op" id="2631324">(</span><span class="op" id="2631325">&amp;</span><span class="ident" id="2631326">buf</span><span class="op" id="2631329">[</span><span class="num" id="2631330">0</span><span class="op" id="2631331">]</span><span class="op" id="2631332">)</span><span class="op" id="2631333">)</span><span class="op" id="2631334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2631338">if</span>&nbsp;<span class="ident" id="2631341">err</span>&nbsp;<span class="op" id="2631345">!=</span>&nbsp;<span class="ident" id="2631348">nil</span>&nbsp;<span class="op" id="2631352">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2631357">return</span>&nbsp;<span class="num" id="2631364">0</span><span class="op" id="2631365">,</span>&nbsp;<span class="ident" id="2631367">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2631373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2631377">n</span>&nbsp;<span class="op" id="2631379">+=</span>&nbsp;<span class="builtinfunc" id="2631382">copy</span><span class="op" id="2631386">(</span><span class="ident" id="2631387">buf</span><span class="op" id="2631390">[</span><span class="ident" id="2631391">addr</span><span class="op" id="2631395">%</span><span class="ident" id="2631396">sizeofPtr</span><span class="op" id="2631405">:</span><span class="op" id="2631406">]</span><span class="op" id="2631407">,</span>&nbsp;<span class="ident" id="2631409">data</span><span class="op" id="2631413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2631417">word</span>&nbsp;<span class="op" id="2631422">:=</span>&nbsp;<span class="op" id="2631425">*</span><span class="op" id="2631426">(</span><span class="op" id="2631427">(</span><span class="op" id="2631428">*</span><span class="builtintype" id="2631429">uintptr</span><span class="op" id="2631436">)</span><span class="op" id="2631437">(</span><span class="ident" id="2631438">unsafe</span><span class="op" id="2631444">.</span><span class="ident" id="2631445">Pointer</span><span class="op" id="2631452">(</span><span class="op" id="2631453">&amp;</span><span class="ident" id="2631454">buf</span><span class="op" id="2631457">[</span><span class="num" id="2631458">0</span><span class="op" id="2631459">]</span><span class="op" id="2631460">)</span><span class="op" id="2631461">)</span><span class="op" id="2631462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2631466">err</span>&nbsp;<span class="op" id="2631470">=</span>&nbsp;<span class="ident" id="2631472">ptrace</span><span class="op" id="2631478">(</span><span class="ident" id="2631479">pokeReq</span><span class="op" id="2631486">,</span>&nbsp;<span class="ident" id="2631488">pid</span><span class="op" id="2631491">,</span>&nbsp;<span class="ident" id="2631493">addr</span><span class="op" id="2631497">-</span><span class="ident" id="2631498">addr</span><span class="op" id="2631502">%</span><span class="ident" id="2631503">sizeofPtr</span><span class="op" id="2631512">,</span>&nbsp;<span class="ident" id="2631514">word</span><span class="op" id="2631518">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2631522">if</span>&nbsp;<span class="ident" id="2631525">err</span>&nbsp;<span class="op" id="2631529">!=</span>&nbsp;<span class="ident" id="2631532">nil</span>&nbsp;<span class="op" id="2631536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2631541">return</span>&nbsp;<span class="num" id="2631548">0</span><span class="op" id="2631549">,</span>&nbsp;<span class="ident" id="2631551">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2631557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2631561">data</span>&nbsp;<span class="op" id="2631566">=</span>&nbsp;<span class="ident" id="2631568">data</span><span class="op" id="2631572">[</span><span class="ident" id="2631573">n</span><span class="op" id="2631574">:</span><span class="op" id="2631575">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2631578">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2631582">//&nbsp;Interior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2631596">for</span>&nbsp;<span class="builtinfunc" id="2631600">len</span><span class="op" id="2631603">(</span><span class="ident" id="2631604">data</span><span class="op" id="2631608">)</span>&nbsp;<span class="op" id="2631610">&gt;</span>&nbsp;<span class="ident" id="2631612">sizeofPtr</span>&nbsp;<span class="op" id="2631622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2631626">word</span>&nbsp;<span class="op" id="2631631">:=</span>&nbsp;<span class="op" id="2631634">*</span><span class="op" id="2631635">(</span><span class="op" id="2631636">(</span><span class="op" id="2631637">*</span><span class="builtintype" id="2631638">uintptr</span><span class="op" id="2631645">)</span><span class="op" id="2631646">(</span><span class="ident" id="2631647">unsafe</span><span class="op" id="2631653">.</span><span class="ident" id="2631654">Pointer</span><span class="op" id="2631661">(</span><span class="op" id="2631662">&amp;</span><span class="ident" id="2631663">data</span><span class="op" id="2631667">[</span><span class="num" id="2631668">0</span><span class="op" id="2631669">]</span><span class="op" id="2631670">)</span><span class="op" id="2631671">)</span><span class="op" id="2631672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2631676">err</span>&nbsp;<span class="op" id="2631680">=</span>&nbsp;<span class="ident" id="2631682">ptrace</span><span class="op" id="2631688">(</span><span class="ident" id="2631689">pokeReq</span><span class="op" id="2631696">,</span>&nbsp;<span class="ident" id="2631698">pid</span><span class="op" id="2631701">,</span>&nbsp;<span class="ident" id="2631703">addr</span><span class="op" id="2631707">+</span><span class="builtintype" id="2631708">uintptr</span><span class="op" id="2631715">(</span><span class="ident" id="2631716">n</span><span class="op" id="2631717">)</span><span class="op" id="2631718">,</span>&nbsp;<span class="ident" id="2631720">word</span><span class="op" id="2631724">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2631728">if</span>&nbsp;<span class="ident" id="2631731">err</span>&nbsp;<span class="op" id="2631735">!=</span>&nbsp;<span class="ident" id="2631738">nil</span>&nbsp;<span class="op" id="2631742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2631747">return</span>&nbsp;<span class="ident" id="2631754">n</span><span class="op" id="2631755">,</span>&nbsp;<span class="ident" id="2631757">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2631763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2631767">n</span>&nbsp;<span class="op" id="2631769">+=</span>&nbsp;<span class="ident" id="2631772">sizeofPtr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2631784">data</span>&nbsp;<span class="op" id="2631789">=</span>&nbsp;<span class="ident" id="2631791">data</span><span class="op" id="2631795">[</span><span class="ident" id="2631796">sizeofPtr</span><span class="op" id="2631805">:</span><span class="op" id="2631806">]</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2631809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2631813">//&nbsp;Trailing&nbsp;edge.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2631832">if</span>&nbsp;<span class="builtinfunc" id="2631835">len</span><span class="op" id="2631838">(</span><span class="ident" id="2631839">data</span><span class="op" id="2631843">)</span>&nbsp;<span class="op" id="2631845">&gt;</span>&nbsp;<span class="num" id="2631847">0</span>&nbsp;<span class="op" id="2631849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2631853">var</span>&nbsp;<span class="ident" id="2631857">buf</span>&nbsp;<span class="op" id="2631861">[</span><span class="ident" id="2631862">sizeofPtr</span><span class="op" id="2631871">]</span><span class="builtintype" id="2631872">byte</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2631879">err</span>&nbsp;<span class="op" id="2631883">=</span>&nbsp;<span class="ident" id="2631885">ptrace</span><span class="op" id="2631891">(</span><span class="ident" id="2631892">peekReq</span><span class="op" id="2631899">,</span>&nbsp;<span class="ident" id="2631901">pid</span><span class="op" id="2631904">,</span>&nbsp;<span class="ident" id="2631906">addr</span><span class="op" id="2631910">+</span><span class="builtintype" id="2631911">uintptr</span><span class="op" id="2631918">(</span><span class="ident" id="2631919">n</span><span class="op" id="2631920">)</span><span class="op" id="2631921">,</span>&nbsp;<span class="builtintype" id="2631923">uintptr</span><span class="op" id="2631930">(</span><span class="ident" id="2631931">unsafe</span><span class="op" id="2631937">.</span><span class="ident" id="2631938">Pointer</span><span class="op" id="2631945">(</span><span class="op" id="2631946">&amp;</span><span class="ident" id="2631947">buf</span><span class="op" id="2631950">[</span><span class="num" id="2631951">0</span><span class="op" id="2631952">]</span><span class="op" id="2631953">)</span><span class="op" id="2631954">)</span><span class="op" id="2631955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2631959">if</span>&nbsp;<span class="ident" id="2631962">err</span>&nbsp;<span class="op" id="2631966">!=</span>&nbsp;<span class="ident" id="2631969">nil</span>&nbsp;<span class="op" id="2631973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2631978">return</span>&nbsp;<span class="ident" id="2631985">n</span><span class="op" id="2631986">,</span>&nbsp;<span class="ident" id="2631988">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2631994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2631998">copy</span><span class="op" id="2632002">(</span><span class="ident" id="2632003">buf</span><span class="op" id="2632006">[</span><span class="num" id="2632007">0</span><span class="op" id="2632008">:</span><span class="op" id="2632009">]</span><span class="op" id="2632010">,</span>&nbsp;<span class="ident" id="2632012">data</span><span class="op" id="2632016">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2632020">word</span>&nbsp;<span class="op" id="2632025">:=</span>&nbsp;<span class="op" id="2632028">*</span><span class="op" id="2632029">(</span><span class="op" id="2632030">(</span><span class="op" id="2632031">*</span><span class="builtintype" id="2632032">uintptr</span><span class="op" id="2632039">)</span><span class="op" id="2632040">(</span><span class="ident" id="2632041">unsafe</span><span class="op" id="2632047">.</span><span class="ident" id="2632048">Pointer</span><span class="op" id="2632055">(</span><span class="op" id="2632056">&amp;</span><span class="ident" id="2632057">buf</span><span class="op" id="2632060">[</span><span class="num" id="2632061">0</span><span class="op" id="2632062">]</span><span class="op" id="2632063">)</span><span class="op" id="2632064">)</span><span class="op" id="2632065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2632069">err</span>&nbsp;<span class="op" id="2632073">=</span>&nbsp;<span class="ident" id="2632075">ptrace</span><span class="op" id="2632081">(</span><span class="ident" id="2632082">pokeReq</span><span class="op" id="2632089">,</span>&nbsp;<span class="ident" id="2632091">pid</span><span class="op" id="2632094">,</span>&nbsp;<span class="ident" id="2632096">addr</span><span class="op" id="2632100">+</span><span class="builtintype" id="2632101">uintptr</span><span class="op" id="2632108">(</span><span class="ident" id="2632109">n</span><span class="op" id="2632110">)</span><span class="op" id="2632111">,</span>&nbsp;<span class="ident" id="2632113">word</span><span class="op" id="2632117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2632121">if</span>&nbsp;<span class="ident" id="2632124">err</span>&nbsp;<span class="op" id="2632128">!=</span>&nbsp;<span class="ident" id="2632131">nil</span>&nbsp;<span class="op" id="2632135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2632140">return</span>&nbsp;<span class="ident" id="2632147">n</span><span class="op" id="2632148">,</span>&nbsp;<span class="ident" id="2632150">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2632156">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2632160">n</span>&nbsp;<span class="op" id="2632162">+=</span>&nbsp;<span class="builtinfunc" id="2632165">len</span><span class="op" id="2632168">(</span><span class="ident" id="2632169">data</span><span class="op" id="2632173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2632176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2632180">return</span>&nbsp;<span class="ident" id="2632187">n</span><span class="op" id="2632188">,</span>&nbsp;<span class="ident" id="2632190">nil</span><br>
<span class="lineno"></span><span class="op" id="2632194">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="2632197">func</span>&nbsp;<span class="ident" id="2632202">PtracePokeText</span><span class="op" id="2632216">(</span><span class="ident" id="2632217">pid</span>&nbsp;<span class="builtintype" id="2632221">int</span><span class="op" id="2632224">,</span>&nbsp;<span class="ident" id="2632226">addr</span>&nbsp;<span class="builtintype" id="2632231">uintptr</span><span class="op" id="2632238">,</span>&nbsp;<span class="ident" id="2632240">data</span>&nbsp;<span class="op" id="2632245">[</span><span class="op" id="2632246">]</span><span class="builtintype" id="2632247">byte</span><span class="op" id="2632251">)</span>&nbsp;<span class="op" id="2632253">(</span><span class="ident" id="2632254">count</span>&nbsp;<span class="builtintype" id="2632260">int</span><span class="op" id="2632263">,</span>&nbsp;<span class="ident" id="2632265">err</span>&nbsp;<span class="builtintype" id="2632269">error</span><span class="op" id="2632274">)</span>&nbsp;<span class="op" id="2632276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2632279">return</span>&nbsp;<span class="ident" id="2632286">ptracePoke</span><span class="op" id="2632296">(</span><span class="ident" id="2632297">PTRACE_POKETEXT</span><span class="op" id="2632312">,</span>&nbsp;<span class="ident" id="2632314">PTRACE_PEEKTEXT</span><span class="op" id="2632329">,</span>&nbsp;<span class="ident" id="2632331">pid</span><span class="op" id="2632334">,</span>&nbsp;<span class="ident" id="2632336">addr</span><span class="op" id="2632340">,</span>&nbsp;<span class="ident" id="2632342">data</span><span class="op" id="2632346">)</span><br>
<span class="lineno"></span><span class="op" id="2632348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span><span class="keyword" id="2632351">func</span>&nbsp;<span class="ident" id="2632356">PtracePokeData</span><span class="op" id="2632370">(</span><span class="ident" id="2632371">pid</span>&nbsp;<span class="builtintype" id="2632375">int</span><span class="op" id="2632378">,</span>&nbsp;<span class="ident" id="2632380">addr</span>&nbsp;<span class="builtintype" id="2632385">uintptr</span><span class="op" id="2632392">,</span>&nbsp;<span class="ident" id="2632394">data</span>&nbsp;<span class="op" id="2632399">[</span><span class="op" id="2632400">]</span><span class="builtintype" id="2632401">byte</span><span class="op" id="2632405">)</span>&nbsp;<span class="op" id="2632407">(</span><span class="ident" id="2632408">count</span>&nbsp;<span class="builtintype" id="2632414">int</span><span class="op" id="2632417">,</span>&nbsp;<span class="ident" id="2632419">err</span>&nbsp;<span class="builtintype" id="2632423">error</span><span class="op" id="2632428">)</span>&nbsp;<span class="op" id="2632430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2632433">return</span>&nbsp;<span class="ident" id="2632440">ptracePoke</span><span class="op" id="2632450">(</span><span class="ident" id="2632451">PTRACE_POKEDATA</span><span class="op" id="2632466">,</span>&nbsp;<span class="ident" id="2632468">PTRACE_PEEKDATA</span><span class="op" id="2632483">,</span>&nbsp;<span class="ident" id="2632485">pid</span><span class="op" id="2632488">,</span>&nbsp;<span class="ident" id="2632490">addr</span><span class="op" id="2632494">,</span>&nbsp;<span class="ident" id="2632496">data</span><span class="op" id="2632500">)</span><br>
<span class="lineno"></span><span class="op" id="2632502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2632505">func</span>&nbsp;<span class="ident" id="2632510">PtraceGetRegs</span><span class="op" id="2632523">(</span><span class="ident" id="2632524">pid</span>&nbsp;<span class="builtintype" id="2632528">int</span><span class="op" id="2632531">,</span>&nbsp;<span class="ident" id="2632533">regsout</span>&nbsp;<span class="op" id="2632541">*</span><span class="ident" id="2632542">PtraceRegs</span><span class="op" id="2632552">)</span>&nbsp;<span class="op" id="2632554">(</span><span class="ident" id="2632555">err</span>&nbsp;<span class="builtintype" id="2632559">error</span><span class="op" id="2632564">)</span>&nbsp;<span class="op" id="2632566">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2632569">return</span>&nbsp;<span class="ident" id="2632576">ptrace</span><span class="op" id="2632582">(</span><span class="ident" id="2632583">PTRACE_GETREGS</span><span class="op" id="2632597">,</span>&nbsp;<span class="ident" id="2632599">pid</span><span class="op" id="2632602">,</span>&nbsp;<span class="num" id="2632604">0</span><span class="op" id="2632605">,</span>&nbsp;<span class="builtintype" id="2632607">uintptr</span><span class="op" id="2632614">(</span><span class="ident" id="2632615">unsafe</span><span class="op" id="2632621">.</span><span class="ident" id="2632622">Pointer</span><span class="op" id="2632629">(</span><span class="ident" id="2632630">regsout</span><span class="op" id="2632637">)</span><span class="op" id="2632638">)</span><span class="op" id="2632639">)</span><br>
<span class="lineno"></span><span class="op" id="2632641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2632644">func</span>&nbsp;<span class="ident" id="2632649">PtraceSetRegs</span><span class="op" id="2632662">(</span><span class="ident" id="2632663">pid</span>&nbsp;<span class="builtintype" id="2632667">int</span><span class="op" id="2632670">,</span>&nbsp;<span class="ident" id="2632672">regs</span>&nbsp;<span class="op" id="2632677">*</span><span class="ident" id="2632678">PtraceRegs</span><span class="op" id="2632688">)</span>&nbsp;<span class="op" id="2632690">(</span><span class="ident" id="2632691">err</span>&nbsp;<span class="builtintype" id="2632695">error</span><span class="op" id="2632700">)</span>&nbsp;<span class="op" id="2632702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2632705">return</span>&nbsp;<span class="ident" id="2632712">ptrace</span><span class="op" id="2632718">(</span><span class="ident" id="2632719">PTRACE_SETREGS</span><span class="op" id="2632733">,</span>&nbsp;<span class="ident" id="2632735">pid</span><span class="op" id="2632738">,</span>&nbsp;<span class="num" id="2632740">0</span><span class="op" id="2632741">,</span>&nbsp;<span class="builtintype" id="2632743">uintptr</span><span class="op" id="2632750">(</span><span class="ident" id="2632751">unsafe</span><span class="op" id="2632757">.</span><span class="ident" id="2632758">Pointer</span><span class="op" id="2632765">(</span><span class="ident" id="2632766">regs</span><span class="op" id="2632770">)</span><span class="op" id="2632771">)</span><span class="op" id="2632772">)</span><br>
<span class="lineno">695</span><span class="op" id="2632774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2632777">func</span>&nbsp;<span class="ident" id="2632782">PtraceSetOptions</span><span class="op" id="2632798">(</span><span class="ident" id="2632799">pid</span>&nbsp;<span class="builtintype" id="2632803">int</span><span class="op" id="2632806">,</span>&nbsp;<span class="ident" id="2632808">options</span>&nbsp;<span class="builtintype" id="2632816">int</span><span class="op" id="2632819">)</span>&nbsp;<span class="op" id="2632821">(</span><span class="ident" id="2632822">err</span>&nbsp;<span class="builtintype" id="2632826">error</span><span class="op" id="2632831">)</span>&nbsp;<span class="op" id="2632833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2632836">return</span>&nbsp;<span class="ident" id="2632843">ptrace</span><span class="op" id="2632849">(</span><span class="ident" id="2632850">PTRACE_SETOPTIONS</span><span class="op" id="2632867">,</span>&nbsp;<span class="ident" id="2632869">pid</span><span class="op" id="2632872">,</span>&nbsp;<span class="num" id="2632874">0</span><span class="op" id="2632875">,</span>&nbsp;<span class="builtintype" id="2632877">uintptr</span><span class="op" id="2632884">(</span><span class="ident" id="2632885">options</span><span class="op" id="2632892">)</span><span class="op" id="2632893">)</span><br>
<span class="lineno"></span><span class="op" id="2632895">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span><span class="keyword" id="2632898">func</span>&nbsp;<span class="ident" id="2632903">PtraceGetEventMsg</span><span class="op" id="2632920">(</span><span class="ident" id="2632921">pid</span>&nbsp;<span class="builtintype" id="2632925">int</span><span class="op" id="2632928">)</span>&nbsp;<span class="op" id="2632930">(</span><span class="ident" id="2632931">msg</span>&nbsp;<span class="builtintype" id="2632935">uint</span><span class="op" id="2632939">,</span>&nbsp;<span class="ident" id="2632941">err</span>&nbsp;<span class="builtintype" id="2632945">error</span><span class="op" id="2632950">)</span>&nbsp;<span class="op" id="2632952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2632955">var</span>&nbsp;<span class="ident" id="2632959">data</span>&nbsp;<span class="ident" id="2632964">_C_long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2632973">err</span>&nbsp;<span class="op" id="2632977">=</span>&nbsp;<span class="ident" id="2632979">ptrace</span><span class="op" id="2632985">(</span><span class="ident" id="2632986">PTRACE_GETEVENTMSG</span><span class="op" id="2633004">,</span>&nbsp;<span class="ident" id="2633006">pid</span><span class="op" id="2633009">,</span>&nbsp;<span class="num" id="2633011">0</span><span class="op" id="2633012">,</span>&nbsp;<span class="builtintype" id="2633014">uintptr</span><span class="op" id="2633021">(</span><span class="ident" id="2633022">unsafe</span><span class="op" id="2633028">.</span><span class="ident" id="2633029">Pointer</span><span class="op" id="2633036">(</span><span class="op" id="2633037">&amp;</span><span class="ident" id="2633038">data</span><span class="op" id="2633042">)</span><span class="op" id="2633043">)</span><span class="op" id="2633044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2633047">msg</span>&nbsp;<span class="op" id="2633051">=</span>&nbsp;<span class="builtintype" id="2633053">uint</span><span class="op" id="2633057">(</span><span class="ident" id="2633058">data</span><span class="op" id="2633062">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2633065">return</span><br>
<span class="lineno"></span><span class="op" id="2633072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2633075">func</span>&nbsp;<span class="ident" id="2633080">PtraceCont</span><span class="op" id="2633090">(</span><span class="ident" id="2633091">pid</span>&nbsp;<span class="builtintype" id="2633095">int</span><span class="op" id="2633098">,</span>&nbsp;<span class="ident" id="2633100">signal</span>&nbsp;<span class="builtintype" id="2633107">int</span><span class="op" id="2633110">)</span>&nbsp;<span class="op" id="2633112">(</span><span class="ident" id="2633113">err</span>&nbsp;<span class="builtintype" id="2633117">error</span><span class="op" id="2633122">)</span>&nbsp;<span class="op" id="2633124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2633127">return</span>&nbsp;<span class="ident" id="2633134">ptrace</span><span class="op" id="2633140">(</span><span class="ident" id="2633141">PTRACE_CONT</span><span class="op" id="2633152">,</span>&nbsp;<span class="ident" id="2633154">pid</span><span class="op" id="2633157">,</span>&nbsp;<span class="num" id="2633159">0</span><span class="op" id="2633160">,</span>&nbsp;<span class="builtintype" id="2633162">uintptr</span><span class="op" id="2633169">(</span><span class="ident" id="2633170">signal</span><span class="op" id="2633176">)</span><span class="op" id="2633177">)</span><br>
<span class="lineno">710</span><span class="op" id="2633179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2633182">func</span>&nbsp;<span class="ident" id="2633187">PtraceSyscall</span><span class="op" id="2633200">(</span><span class="ident" id="2633201">pid</span>&nbsp;<span class="builtintype" id="2633205">int</span><span class="op" id="2633208">,</span>&nbsp;<span class="ident" id="2633210">signal</span>&nbsp;<span class="builtintype" id="2633217">int</span><span class="op" id="2633220">)</span>&nbsp;<span class="op" id="2633222">(</span><span class="ident" id="2633223">err</span>&nbsp;<span class="builtintype" id="2633227">error</span><span class="op" id="2633232">)</span>&nbsp;<span class="op" id="2633234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2633237">return</span>&nbsp;<span class="ident" id="2633244">ptrace</span><span class="op" id="2633250">(</span><span class="ident" id="2633251">PTRACE_SYSCALL</span><span class="op" id="2633265">,</span>&nbsp;<span class="ident" id="2633267">pid</span><span class="op" id="2633270">,</span>&nbsp;<span class="num" id="2633272">0</span><span class="op" id="2633273">,</span>&nbsp;<span class="builtintype" id="2633275">uintptr</span><span class="op" id="2633282">(</span><span class="ident" id="2633283">signal</span><span class="op" id="2633289">)</span><span class="op" id="2633290">)</span><br>
<span class="lineno"></span><span class="op" id="2633292">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="2633295">func</span>&nbsp;<span class="ident" id="2633300">PtraceSingleStep</span><span class="op" id="2633316">(</span><span class="ident" id="2633317">pid</span>&nbsp;<span class="builtintype" id="2633321">int</span><span class="op" id="2633324">)</span>&nbsp;<span class="op" id="2633326">(</span><span class="ident" id="2633327">err</span>&nbsp;<span class="builtintype" id="2633331">error</span><span class="op" id="2633336">)</span>&nbsp;<span class="op" id="2633338">{</span>&nbsp;<span class="keyword" id="2633340">return</span>&nbsp;<span class="ident" id="2633347">ptrace</span><span class="op" id="2633353">(</span><span class="ident" id="2633354">PTRACE_SINGLESTEP</span><span class="op" id="2633371">,</span>&nbsp;<span class="ident" id="2633373">pid</span><span class="op" id="2633376">,</span>&nbsp;<span class="num" id="2633378">0</span><span class="op" id="2633379">,</span>&nbsp;<span class="num" id="2633381">0</span><span class="op" id="2633382">)</span>&nbsp;<span class="op" id="2633384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2633387">func</span>&nbsp;<span class="ident" id="2633392">PtraceAttach</span><span class="op" id="2633404">(</span><span class="ident" id="2633405">pid</span>&nbsp;<span class="builtintype" id="2633409">int</span><span class="op" id="2633412">)</span>&nbsp;<span class="op" id="2633414">(</span><span class="ident" id="2633415">err</span>&nbsp;<span class="builtintype" id="2633419">error</span><span class="op" id="2633424">)</span>&nbsp;<span class="op" id="2633426">{</span>&nbsp;<span class="keyword" id="2633428">return</span>&nbsp;<span class="ident" id="2633435">ptrace</span><span class="op" id="2633441">(</span><span class="ident" id="2633442">PTRACE_ATTACH</span><span class="op" id="2633455">,</span>&nbsp;<span class="ident" id="2633457">pid</span><span class="op" id="2633460">,</span>&nbsp;<span class="num" id="2633462">0</span><span class="op" id="2633463">,</span>&nbsp;<span class="num" id="2633465">0</span><span class="op" id="2633466">)</span>&nbsp;<span class="op" id="2633468">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span><span class="keyword" id="2633471">func</span>&nbsp;<span class="ident" id="2633476">PtraceDetach</span><span class="op" id="2633488">(</span><span class="ident" id="2633489">pid</span>&nbsp;<span class="builtintype" id="2633493">int</span><span class="op" id="2633496">)</span>&nbsp;<span class="op" id="2633498">(</span><span class="ident" id="2633499">err</span>&nbsp;<span class="builtintype" id="2633503">error</span><span class="op" id="2633508">)</span>&nbsp;<span class="op" id="2633510">{</span>&nbsp;<span class="keyword" id="2633512">return</span>&nbsp;<span class="ident" id="2633519">ptrace</span><span class="op" id="2633525">(</span><span class="ident" id="2633526">PTRACE_DETACH</span><span class="op" id="2633539">,</span>&nbsp;<span class="ident" id="2633541">pid</span><span class="op" id="2633544">,</span>&nbsp;<span class="num" id="2633546">0</span><span class="op" id="2633547">,</span>&nbsp;<span class="num" id="2633549">0</span><span class="op" id="2633550">)</span>&nbsp;<span class="op" id="2633552">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2633555">//sys&nbsp;&nbsp;&nbsp;&nbspreboot(magic1&nbsp;uint,&nbsp;magic2&nbsp;uint,&nbsp;cmd&nbsp;int,&nbsp;arg&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2633628">func</span>&nbsp;<span class="ident" id="2633633">Reboot</span><span class="op" id="2633639">(</span><span class="ident" id="2633640">cmd</span>&nbsp;<span class="builtintype" id="2633644">int</span><span class="op" id="2633647">)</span>&nbsp;<span class="op" id="2633649">(</span><span class="ident" id="2633650">err</span>&nbsp;<span class="builtintype" id="2633654">error</span><span class="op" id="2633659">)</span>&nbsp;<span class="op" id="2633661">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2633664">return</span>&nbsp;<span class="ident" id="2633671">reboot</span><span class="op" id="2633677">(</span><span class="ident" id="2633678">LINUX_REBOOT_MAGIC1</span><span class="op" id="2633697">,</span>&nbsp;<span class="ident" id="2633699">LINUX_REBOOT_MAGIC2</span><span class="op" id="2633718">,</span>&nbsp;<span class="ident" id="2633720">cmd</span><span class="op" id="2633723">,</span>&nbsp;<span class="string" id="2633725">&#34;&#34;</span><span class="op" id="2633727">)</span><br>
<span class="lineno"></span><span class="op" id="2633729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2633732">func</span>&nbsp;<span class="ident" id="2633737">clen</span><span class="op" id="2633741">(</span><span class="ident" id="2633742">n</span>&nbsp;<span class="op" id="2633744">[</span><span class="op" id="2633745">]</span><span class="builtintype" id="2633746">byte</span><span class="op" id="2633750">)</span>&nbsp;<span class="builtintype" id="2633752">int</span>&nbsp;<span class="op" id="2633756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2633759">for</span>&nbsp;<span class="ident" id="2633763">i</span>&nbsp;<span class="op" id="2633765">:=</span>&nbsp;<span class="num" id="2633768">0</span><span class="op" id="2633769">;</span>&nbsp;<span class="ident" id="2633771">i</span>&nbsp;<span class="op" id="2633773">&lt;</span>&nbsp;<span class="builtinfunc" id="2633775">len</span><span class="op" id="2633778">(</span><span class="ident" id="2633779">n</span><span class="op" id="2633780">)</span><span class="op" id="2633781">;</span>&nbsp;<span class="ident" id="2633783">i</span><span class="op" id="2633784">++</span>&nbsp;<span class="op" id="2633787">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2633791">if</span>&nbsp;<span class="ident" id="2633794">n</span><span class="op" id="2633795">[</span><span class="ident" id="2633796">i</span><span class="op" id="2633797">]</span>&nbsp;<span class="op" id="2633799">==</span>&nbsp;<span class="num" id="2633802">0</span>&nbsp;<span class="op" id="2633804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2633809">return</span>&nbsp;<span class="ident" id="2633816">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2633820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2633823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2633826">return</span>&nbsp;<span class="builtinfunc" id="2633833">len</span><span class="op" id="2633836">(</span><span class="ident" id="2633837">n</span><span class="op" id="2633838">)</span><br>
<span class="lineno">735</span><span class="op" id="2633840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2633843">func</span>&nbsp;<span class="ident" id="2633848">ReadDirent</span><span class="op" id="2633858">(</span><span class="ident" id="2633859">fd</span>&nbsp;<span class="builtintype" id="2633862">int</span><span class="op" id="2633865">,</span>&nbsp;<span class="ident" id="2633867">buf</span>&nbsp;<span class="op" id="2633871">[</span><span class="op" id="2633872">]</span><span class="builtintype" id="2633873">byte</span><span class="op" id="2633877">)</span>&nbsp;<span class="op" id="2633879">(</span><span class="ident" id="2633880">n</span>&nbsp;<span class="builtintype" id="2633882">int</span><span class="op" id="2633885">,</span>&nbsp;<span class="ident" id="2633887">err</span>&nbsp;<span class="builtintype" id="2633891">error</span><span class="op" id="2633896">)</span>&nbsp;<span class="op" id="2633898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2633901">return</span>&nbsp;<span class="ident" id="2633908">Getdents</span><span class="op" id="2633916">(</span><span class="ident" id="2633917">fd</span><span class="op" id="2633919">,</span>&nbsp;<span class="ident" id="2633921">buf</span><span class="op" id="2633924">)</span><br>
<span class="lineno"></span><span class="op" id="2633926">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="2633929">func</span>&nbsp;<span class="ident" id="2633934">ParseDirent</span><span class="op" id="2633945">(</span><span class="ident" id="2633946">buf</span>&nbsp;<span class="op" id="2633950">[</span><span class="op" id="2633951">]</span><span class="builtintype" id="2633952">byte</span><span class="op" id="2633956">,</span>&nbsp;<span class="ident" id="2633958">max</span>&nbsp;<span class="builtintype" id="2633962">int</span><span class="op" id="2633965">,</span>&nbsp;<span class="ident" id="2633967">names</span>&nbsp;<span class="op" id="2633973">[</span><span class="op" id="2633974">]</span><span class="builtintype" id="2633975">string</span><span class="op" id="2633981">)</span>&nbsp;<span class="op" id="2633983">(</span><span class="ident" id="2633984">consumed</span>&nbsp;<span class="builtintype" id="2633993">int</span><span class="op" id="2633996">,</span>&nbsp;<span class="ident" id="2633998">count</span>&nbsp;<span class="builtintype" id="2634004">int</span><span class="op" id="2634007">,</span>&nbsp;<span class="ident" id="2634009">newnames</span>&nbsp;<span class="op" id="2634018">[</span><span class="op" id="2634019">]</span><span class="builtintype" id="2634020">string</span><span class="op" id="2634026">)</span>&nbsp;<span class="op" id="2634028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2634031">origlen</span>&nbsp;<span class="op" id="2634039">:=</span>&nbsp;<span class="builtinfunc" id="2634042">len</span><span class="op" id="2634045">(</span><span class="ident" id="2634046">buf</span><span class="op" id="2634049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2634052">count</span>&nbsp;<span class="op" id="2634058">=</span>&nbsp;<span class="num" id="2634060">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2634063">for</span>&nbsp;<span class="ident" id="2634067">max</span>&nbsp;<span class="op" id="2634071">!=</span>&nbsp;<span class="num" id="2634074">0</span>&nbsp;<span class="op" id="2634076">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2634079">len</span><span class="op" id="2634082">(</span><span class="ident" id="2634083">buf</span><span class="op" id="2634086">)</span>&nbsp;<span class="op" id="2634088">&gt;</span>&nbsp;<span class="num" id="2634090">0</span>&nbsp;<span class="op" id="2634092">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2634096">dirent</span>&nbsp;<span class="op" id="2634103">:=</span>&nbsp;<span class="op" id="2634106">(</span><span class="op" id="2634107">*</span><span class="ident" id="2634108">Dirent</span><span class="op" id="2634114">)</span><span class="op" id="2634115">(</span><span class="ident" id="2634116">unsafe</span><span class="op" id="2634122">.</span><span class="ident" id="2634123">Pointer</span><span class="op" id="2634130">(</span><span class="op" id="2634131">&amp;</span><span class="ident" id="2634132">buf</span><span class="op" id="2634135">[</span><span class="num" id="2634136">0</span><span class="op" id="2634137">]</span><span class="op" id="2634138">)</span><span class="op" id="2634139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2634143">buf</span>&nbsp;<span class="op" id="2634147">=</span>&nbsp;<span class="ident" id="2634149">buf</span><span class="op" id="2634152">[</span><span class="ident" id="2634153">dirent</span><span class="op" id="2634159">.</span><span class="ident" id="2634160">Reclen</span><span class="op" id="2634166">:</span><span class="op" id="2634167">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2634171">if</span>&nbsp;<span class="ident" id="2634174">dirent</span><span class="op" id="2634180">.</span><span class="ident" id="2634181">Ino</span>&nbsp;<span class="op" id="2634185">==</span>&nbsp;<span class="num" id="2634188">0</span>&nbsp;<span class="op" id="2634190">{</span>&nbsp;<span class="comment" id="2634192">//&nbsp;File&nbsp;absent&nbsp;in&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2634224">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2634235">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2634239">bytes</span>&nbsp;<span class="op" id="2634245">:=</span>&nbsp;<span class="op" id="2634248">(</span><span class="op" id="2634249">*</span><span class="op" id="2634250">[</span><span class="num" id="2634251">10000</span><span class="op" id="2634256">]</span><span class="builtintype" id="2634257">byte</span><span class="op" id="2634261">)</span><span class="op" id="2634262">(</span><span class="ident" id="2634263">unsafe</span><span class="op" id="2634269">.</span><span class="ident" id="2634270">Pointer</span><span class="op" id="2634277">(</span><span class="op" id="2634278">&amp;</span><span class="ident" id="2634279">dirent</span><span class="op" id="2634285">.</span><span class="ident" id="2634286">Name</span><span class="op" id="2634290">[</span><span class="num" id="2634291">0</span><span class="op" id="2634292">]</span><span class="op" id="2634293">)</span><span class="op" id="2634294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2634298">var</span>&nbsp;<span class="ident" id="2634302">name</span>&nbsp;<span class="op" id="2634307">=</span>&nbsp;<span class="builtintype" id="2634309">string</span><span class="op" id="2634315">(</span><span class="ident" id="2634316">bytes</span><span class="op" id="2634321">[</span><span class="num" id="2634322">0</span><span class="op" id="2634323">:</span><span class="ident" id="2634324">clen</span><span class="op" id="2634328">(</span><span class="ident" id="2634329">bytes</span><span class="op" id="2634334">[</span><span class="op" id="2634335">:</span><span class="op" id="2634336">]</span><span class="op" id="2634337">)</span><span class="op" id="2634338">]</span><span class="op" id="2634339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2634343">if</span>&nbsp;<span class="ident" id="2634346">name</span>&nbsp;<span class="op" id="2634351">==</span>&nbsp;<span class="string" id="2634354">&#34;.&#34;</span>&nbsp;<span class="op" id="2634358">||</span>&nbsp;<span class="ident" id="2634361">name</span>&nbsp;<span class="op" id="2634366">==</span>&nbsp;<span class="string" id="2634369">&#34;..&#34;</span>&nbsp;<span class="op" id="2634374">{</span>&nbsp;<span class="comment" id="2634376">//&nbsp;Useless&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2634396">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2634407">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2634411">max</span><span class="op" id="2634414">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2634419">count</span><span class="op" id="2634424">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2634429">names</span>&nbsp;<span class="op" id="2634435">=</span>&nbsp;<span class="builtinfunc" id="2634437">append</span><span class="op" id="2634443">(</span><span class="ident" id="2634444">names</span><span class="op" id="2634449">,</span>&nbsp;<span class="ident" id="2634451">name</span><span class="op" id="2634455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2634458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2634461">return</span>&nbsp;<span class="ident" id="2634468">origlen</span>&nbsp;<span class="op" id="2634476">-</span>&nbsp;<span class="builtinfunc" id="2634478">len</span><span class="op" id="2634481">(</span><span class="ident" id="2634482">buf</span><span class="op" id="2634485">)</span><span class="op" id="2634486">,</span>&nbsp;<span class="ident" id="2634488">count</span><span class="op" id="2634493">,</span>&nbsp;<span class="ident" id="2634495">names</span><br>
<span class="lineno">760</span><span class="op" id="2634501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2634504">//sys&nbsp;&nbsp;&nbsp;&nbspmount(source&nbsp;string,&nbsp;target&nbsp;string,&nbsp;fstype&nbsp;string,&nbsp;flags&nbsp;uintptr,&nbsp;data&nbsp;*byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2634601">func</span>&nbsp;<span class="ident" id="2634606">Mount</span><span class="op" id="2634611">(</span><span class="ident" id="2634612">source</span>&nbsp;<span class="builtintype" id="2634619">string</span><span class="op" id="2634625">,</span>&nbsp;<span class="ident" id="2634627">target</span>&nbsp;<span class="builtintype" id="2634634">string</span><span class="op" id="2634640">,</span>&nbsp;<span class="ident" id="2634642">fstype</span>&nbsp;<span class="builtintype" id="2634649">string</span><span class="op" id="2634655">,</span>&nbsp;<span class="ident" id="2634657">flags</span>&nbsp;<span class="builtintype" id="2634663">uintptr</span><span class="op" id="2634670">,</span>&nbsp;<span class="ident" id="2634672">data</span>&nbsp;<span class="builtintype" id="2634677">string</span><span class="op" id="2634683">)</span>&nbsp;<span class="op" id="2634685">(</span><span class="ident" id="2634686">err</span>&nbsp;<span class="builtintype" id="2634690">error</span><span class="op" id="2634695">)</span>&nbsp;<span class="op" id="2634697">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2634700">//&nbsp;Certain&nbsp;file&nbsp;systems&nbsp;get&nbsp;rather&nbsp;angry&nbsp;and&nbsp;EINVAL&nbsp;if&nbsp;you&nbsp;give</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2634765">//&nbsp;them&nbsp;an&nbsp;empty&nbsp;string&nbsp;of&nbsp;data,&nbsp;rather&nbsp;than&nbsp;NULL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2634817">if</span>&nbsp;<span class="ident" id="2634820">data</span>&nbsp;<span class="op" id="2634825">==</span>&nbsp;<span class="string" id="2634828">&#34;&#34;</span>&nbsp;<span class="op" id="2634831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2634835">return</span>&nbsp;<span class="ident" id="2634842">mount</span><span class="op" id="2634847">(</span><span class="ident" id="2634848">source</span><span class="op" id="2634854">,</span>&nbsp;<span class="ident" id="2634856">target</span><span class="op" id="2634862">,</span>&nbsp;<span class="ident" id="2634864">fstype</span><span class="op" id="2634870">,</span>&nbsp;<span class="ident" id="2634872">flags</span><span class="op" id="2634877">,</span>&nbsp;<span class="ident" id="2634879">nil</span><span class="op" id="2634882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2634885">}</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2634888">datap</span><span class="op" id="2634893">,</span>&nbsp;<span class="ident" id="2634895">err</span>&nbsp;<span class="op" id="2634899">:=</span>&nbsp;<span class="ident" id="2634902">BytePtrFromString</span><span class="op" id="2634919">(</span><span class="ident" id="2634920">data</span><span class="op" id="2634924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2634927">if</span>&nbsp;<span class="ident" id="2634930">err</span>&nbsp;<span class="op" id="2634934">!=</span>&nbsp;<span class="ident" id="2634937">nil</span>&nbsp;<span class="op" id="2634941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2634945">return</span>&nbsp;<span class="ident" id="2634952">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2634957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2634960">err</span>&nbsp;<span class="op" id="2634964">=</span>&nbsp;<span class="ident" id="2634966">mount</span><span class="op" id="2634971">(</span><span class="ident" id="2634972">source</span><span class="op" id="2634978">,</span>&nbsp;<span class="ident" id="2634980">target</span><span class="op" id="2634986">,</span>&nbsp;<span class="ident" id="2634988">fstype</span><span class="op" id="2634994">,</span>&nbsp;<span class="ident" id="2634996">flags</span><span class="op" id="2635001">,</span>&nbsp;<span class="ident" id="2635003">datap</span><span class="op" id="2635008">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2635011">use</span><span class="op" id="2635014">(</span><span class="ident" id="2635015">unsafe</span><span class="op" id="2635021">.</span><span class="ident" id="2635022">Pointer</span><span class="op" id="2635029">(</span><span class="ident" id="2635030">datap</span><span class="op" id="2635035">)</span><span class="op" id="2635036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2635039">return</span>&nbsp;<span class="ident" id="2635046">err</span><br>
<span class="lineno"></span><span class="op" id="2635050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2635053">//&nbsp;Sendto</span><br>
<span class="lineno">780</span><span class="comment" id="2635063">//&nbsp;Recvfrom</span><br>
<span class="lineno"></span><span class="comment" id="2635075">//&nbsp;Socketpair</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2635090">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Direct&nbsp;access<br>
<span class="lineno">785</span>&nbsp;*/</span><br>
<span class="lineno"></span><span class="comment" id="2635114">//sys&nbsp;&nbsp;&nbsp;&nbspAccess(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2635165">//sys&nbsp;&nbsp;&nbsp;&nbspAcct(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2635201">//sys&nbsp;&nbsp;&nbsp;&nbspAdjtimex(buf&nbsp;*Timex)&nbsp;(state&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2635251">//sys&nbsp;&nbsp;&nbsp;&nbspChdir(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">790</span><span class="comment" id="2635288">//sys&nbsp;&nbsp;&nbsp;&nbspChmod(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2635338">//sys&nbsp;&nbsp;&nbsp;&nbspChroot(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2635376">//sys&nbsp;&nbsp;&nbsp;&nbspClose(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2635408">//sys&nbsp;&nbsp;&nbsp;&nbspCreat(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2635466">//sysnb&nbsp;&nbsp;&nbsp;&nbspDup(oldfd&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">795</span><span class="comment" id="2635509">//sysnb&nbsp;&nbsp;&nbsp;&nbspDup2(oldfd&nbsp;int,&nbsp;newfd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2635556">//sysnb&nbsp;&nbsp;&nbsp;&nbspDup3(oldfd&nbsp;int,&nbsp;newfd&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2635614">//sysnb&nbsp;&nbsp;&nbsp;&nbspEpollCreate(size&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2635664">//sysnb&nbsp;&nbsp;&nbsp;&nbspEpollCreate1(flag&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2635715">//sysnb&nbsp;&nbsp;&nbsp;&nbspEpollCtl(epfd&nbsp;int,&nbsp;op&nbsp;int,&nbsp;fd&nbsp;int,&nbsp;event&nbsp;*EpollEvent)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">800</span><span class="comment" id="2635789">//sys&nbsp;&nbsp;&nbsp;&nbspEpollWait(epfd&nbsp;int,&nbsp;events&nbsp;[]EpollEvent,&nbsp;msec&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2635865">//sys&nbsp;&nbsp;&nbsp;&nbspExit(code&nbsp;int)&nbsp;=&nbsp;SYS_EXIT_GROUP</span><br>
<span class="lineno"></span><span class="comment" id="2635903">//sys&nbsp;&nbsp;&nbsp;&nbspFaccessat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2635979">//sys&nbsp;&nbsp;&nbsp;&nbspFallocate(fd&nbsp;int,&nbsp;mode&nbsp;uint32,&nbsp;off&nbsp;int64,&nbsp;len&nbsp;int64)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2636050">//sys&nbsp;&nbsp;&nbsp;&nbspFchdir(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">805</span><span class="comment" id="2636083">//sys&nbsp;&nbsp;&nbsp;&nbspFchmod(fd&nbsp;int,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2636129">//sys&nbsp;&nbsp;&nbsp;&nbspFchmodat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2636204">//sys&nbsp;&nbsp;&nbsp;&nbspFchownat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;uid&nbsp;int,&nbsp;gid&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2636284">//sys&nbsp;&nbsp;&nbsp;&nbspfcntl(fd&nbsp;int,&nbsp;cmd&nbsp;int,&nbsp;arg&nbsp;int)&nbsp;(val&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2636343">//sys&nbsp;&nbsp;&nbsp;&nbspFdatasync(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">810</span><span class="comment" id="2636379">//sys&nbsp;&nbsp;&nbsp;&nbspFlock(fd&nbsp;int,&nbsp;how&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2636420">//sys&nbsp;&nbsp;&nbsp;&nbspFsync(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2636452">//sys&nbsp;&nbsp;&nbsp;&nbspGetdents(fd&nbsp;int,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_GETDENTS64</span><br>
<span class="lineno"></span><span class="comment" id="2636523">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetpgid(pid&nbsp;int)&nbsp;(pgid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2636570">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetpgrp()&nbsp;(pid&nbsp;int)</span><br>
<span class="lineno">815</span><span class="comment" id="2636598">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetpid()&nbsp;(pid&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2636625">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetppid()&nbsp;(ppid&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2636654">//sys&nbsp;&nbsp;&nbsp;&nbspGetpriority(which&nbsp;int,&nbsp;who&nbsp;int)&nbsp;(prio&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2636714">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetrusage(who&nbsp;int,&nbsp;rusage&nbsp;*Rusage)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2636769">//sysnb&nbsp;&nbsp;&nbsp;&nbspGettid()&nbsp;(tid&nbsp;int)</span><br>
<span class="lineno">820</span><span class="comment" id="2636796">//sys&nbsp;&nbsp;&nbsp;&nbspGetxattr(path&nbsp;string,&nbsp;attr&nbsp;string,&nbsp;dest&nbsp;[]byte)&nbsp;(sz&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2636870">//sys&nbsp;&nbsp;&nbsp;&nbspInotifyAddWatch(fd&nbsp;int,&nbsp;pathname&nbsp;string,&nbsp;mask&nbsp;uint32)&nbsp;(watchdesc&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2636957">//sysnb&nbsp;&nbsp;&nbsp;&nbspInotifyInit()&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2636999">//sysnb&nbsp;&nbsp;&nbsp;&nbspInotifyInit1(flags&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2637051">//sysnb&nbsp;&nbsp;&nbsp;&nbspInotifyRmWatch(fd&nbsp;int,&nbsp;watchdesc&nbsp;uint32)&nbsp;(success&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">825</span><span class="comment" id="2637125">//sysnb&nbsp;&nbsp;&nbsp;&nbspKill(pid&nbsp;int,&nbsp;sig&nbsp;Signal)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2637171">//sys&nbsp;&nbsp;&nbsp;&nbspKlogctl(typ&nbsp;int,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_SYSLOG</span><br>
<span class="lineno"></span><span class="comment" id="2637238">//sys&nbsp;&nbsp;&nbsp;&nbspLink(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2637293">//sys&nbsp;&nbsp;&nbsp;&nbspListxattr(path&nbsp;string,&nbsp;dest&nbsp;[]byte)&nbsp;(sz&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2637355">//sys&nbsp;&nbsp;&nbsp;&nbspMkdir(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">830</span><span class="comment" id="2637405">//sys&nbsp;&nbsp;&nbsp;&nbspMkdirat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2637468">//sys&nbsp;&nbsp;&nbsp;&nbspMknod(path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;dev&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2637527">//sys&nbsp;&nbsp;&nbsp;&nbspMknodat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;dev&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2637599">//sys&nbsp;&nbsp;&nbsp;&nbspNanosleep(time&nbsp;*Timespec,&nbsp;leftover&nbsp;*Timespec)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2637663">//sys&nbsp;&nbsp;&nbsp;&nbspPause()&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">835</span><span class="comment" id="2637689">//sys&nbsp;&nbsp;&nbsp;&nbspPivotRoot(newroot&nbsp;string,&nbsp;putold&nbsp;string)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_PIVOT_ROOT</span><br>
<span class="lineno"></span><span class="comment" id="2637765">//sysnb&nbsp;prlimit(pid&nbsp;int,&nbsp;resource&nbsp;int,&nbsp;old&nbsp;*Rlimit,&nbsp;newlimit&nbsp;*Rlimit)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_PRLIMIT64</span><br>
<span class="lineno"></span><span class="comment" id="2637863">//sys&nbsp;&nbsp;&nbsp;&nbspread(fd&nbsp;int,&nbsp;p&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2637911">//sys&nbsp;&nbsp;&nbsp;&nbspReadlink(path&nbsp;string,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2637970">//sys&nbsp;&nbsp;&nbsp;&nbspRemovexattr(path&nbsp;string,&nbsp;attr&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">840</span><span class="comment" id="2638026">//sys&nbsp;&nbsp;&nbsp;&nbspRename(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2638083">//sys&nbsp;&nbsp;&nbsp;&nbspRenameat(olddirfd&nbsp;int,&nbsp;oldpath&nbsp;string,&nbsp;newdirfd&nbsp;int,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2638170">//sys&nbsp;&nbsp;&nbsp;&nbspRmdir(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2638207">//sys&nbsp;&nbsp;&nbsp;&nbspSetdomainname(p&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2638249">//sys&nbsp;&nbsp;&nbsp;&nbspSethostname(p&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">845</span><span class="comment" id="2638289">//sysnb&nbsp;&nbsp;&nbsp;&nbspSetpgid(pid&nbsp;int,&nbsp;pgid&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2638336">//sysnb&nbsp;&nbsp;&nbsp;&nbspSetsid()&nbsp;(pid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2638374">//sysnb&nbsp;&nbsp;&nbsp;&nbspSettimeofday(tv&nbsp;*Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2638421">//&nbsp;issue&nbsp;1435.</span><br>
<span class="lineno">850</span><span class="comment" id="2638436">//&nbsp;On&nbsp;linux&nbsp;Setuid&nbsp;and&nbsp;Setgid&nbsp;only&nbsp;affects&nbsp;the&nbsp;current&nbsp;thread,&nbsp;not&nbsp;the&nbsp;process.</span><br>
<span class="lineno"></span><span class="comment" id="2638516">//&nbsp;This&nbsp;does&nbsp;not&nbsp;match&nbsp;what&nbsp;most&nbsp;callers&nbsp;expect&nbsp;so&nbsp;we&nbsp;must&nbsp;return&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2638591">//&nbsp;here&nbsp;rather&nbsp;than&nbsp;letting&nbsp;the&nbsp;caller&nbsp;think&nbsp;that&nbsp;the&nbsp;call&nbsp;succeeded.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2638662">func</span>&nbsp;<span class="ident" id="2638667">Setuid</span><span class="op" id="2638673">(</span><span class="ident" id="2638674">uid</span>&nbsp;<span class="builtintype" id="2638678">int</span><span class="op" id="2638681">)</span>&nbsp;<span class="op" id="2638683">(</span><span class="ident" id="2638684">err</span>&nbsp;<span class="builtintype" id="2638688">error</span><span class="op" id="2638693">)</span>&nbsp;<span class="op" id="2638695">{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638698">return</span>&nbsp;<span class="ident" id="2638705">EOPNOTSUPP</span><br>
<span class="lineno"></span><span class="op" id="2638716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2638719">func</span>&nbsp;<span class="ident" id="2638724">Setgid</span><span class="op" id="2638730">(</span><span class="ident" id="2638731">uid</span>&nbsp;<span class="builtintype" id="2638735">int</span><span class="op" id="2638738">)</span>&nbsp;<span class="op" id="2638740">(</span><span class="ident" id="2638741">err</span>&nbsp;<span class="builtintype" id="2638745">error</span><span class="op" id="2638750">)</span>&nbsp;<span class="op" id="2638752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638755">return</span>&nbsp;<span class="ident" id="2638762">EOPNOTSUPP</span><br>
<span class="lineno">860</span><span class="op" id="2638773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2638776">//sys&nbsp;&nbsp;&nbsp;&nbspSetpriority(which&nbsp;int,&nbsp;who&nbsp;int,&nbsp;prio&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2638836">//sys&nbsp;&nbsp;&nbsp;&nbspSetxattr(path&nbsp;string,&nbsp;attr&nbsp;string,&nbsp;data&nbsp;[]byte,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2638913">//sys&nbsp;&nbsp;&nbsp;&nbspSymlink(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">865</span><span class="comment" id="2638971">//sys&nbsp;&nbsp;&nbsp;&nbspSync()</span><br>
<span class="lineno"></span><span class="comment" id="2638984">//sysnb&nbsp;&nbsp;&nbsp;&nbspSysinfo(info&nbsp;*Sysinfo_t)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2639029">//sys&nbsp;&nbsp;&nbsp;&nbspTee(rfd&nbsp;int,&nbsp;wfd&nbsp;int,&nbsp;len&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(n&nbsp;int64,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2639098">//sysnb&nbsp;&nbsp;&nbsp;&nbspTgkill(tgid&nbsp;int,&nbsp;tid&nbsp;int,&nbsp;sig&nbsp;Signal)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2639156">//sysnb&nbsp;&nbsp;&nbsp;&nbspTimes(tms&nbsp;*Tms)&nbsp;(ticks&nbsp;uintptr,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">870</span><span class="comment" id="2639207">//sysnb&nbsp;&nbsp;&nbsp;&nbspUmask(mask&nbsp;int)&nbsp;(oldmask&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2639245">//sysnb&nbsp;&nbsp;&nbsp;&nbspUname(buf&nbsp;*Utsname)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2639285">//sys&nbsp;&nbsp;&nbsp;&nbspUnlink(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2639323">//sys&nbsp;&nbsp;&nbsp;&nbspUnlinkat(dirfd&nbsp;int,&nbsp;path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2639374">//sys&nbsp;&nbsp;&nbsp;&nbspUnmount(target&nbsp;string,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_UMOUNT2</span><br>
<span class="lineno">875</span><span class="comment" id="2639440">//sys&nbsp;&nbsp;&nbsp;&nbspUnshare(flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2639477">//sys&nbsp;&nbsp;&nbsp;&nbspUstat(dev&nbsp;int,&nbsp;ubuf&nbsp;*Ustat_t)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2639525">//sys&nbsp;&nbsp;&nbsp;&nbspUtime(path&nbsp;string,&nbsp;buf&nbsp;*Utimbuf)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2639576">//sys&nbsp;&nbsp;&nbsp;&nbspwrite(fd&nbsp;int,&nbsp;p&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2639625">//sys&nbsp;&nbsp;&nbsp;&nbspexitThread(code&nbsp;int)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_EXIT</span><br>
<span class="lineno">880</span><span class="comment" id="2639675">//sys&nbsp;&nbsp;&nbsp;&nbspreadlen(fd&nbsp;int,&nbsp;p&nbsp;*byte,&nbsp;np&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_READ</span><br>
<span class="lineno"></span><span class="comment" id="2639744">//sys&nbsp;&nbsp;&nbsp;&nbspwritelen(fd&nbsp;int,&nbsp;p&nbsp;*byte,&nbsp;np&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_WRITE</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2639816">//&nbsp;mmap&nbsp;varies&nbsp;by&nbsp;architecture;&nbsp;see&nbsp;syscall_linux_*.go.</span><br>
<span class="lineno"></span><span class="comment" id="2639872">//sys&nbsp;&nbsp;&nbsp;&nbspmunmap(addr&nbsp;uintptr,&nbsp;length&nbsp;uintptr)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span><span class="keyword" id="2639928">var</span>&nbsp;<span class="ident" id="2639932">mapper</span>&nbsp;<span class="op" id="2639939">=</span>&nbsp;<span class="op" id="2639941">&amp;</span><span class="ident" id="2639942">mmapper</span><span class="op" id="2639949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2639952">active</span><span class="op" id="2639958">:</span>&nbsp;<span class="builtinfunc" id="2639960">make</span><span class="op" id="2639964">(</span><span class="keyword" id="2639965">map</span><span class="op" id="2639968">[</span><span class="op" id="2639969">*</span><span class="builtintype" id="2639970">byte</span><span class="op" id="2639974">]</span><span class="op" id="2639975">[</span><span class="op" id="2639976">]</span><span class="builtintype" id="2639977">byte</span><span class="op" id="2639981">)</span><span class="op" id="2639982">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2639985">mmap</span><span class="op" id="2639989">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2639993">mmap</span><span class="op" id="2639997">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640000">munmap</span><span class="op" id="2640006">:</span>&nbsp;<span class="ident" id="2640008">munmap</span><span class="op" id="2640014">,</span><br>
<span class="lineno">890</span><span class="op" id="2640016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2640019">func</span>&nbsp;<span class="ident" id="2640024">Mmap</span><span class="op" id="2640028">(</span><span class="ident" id="2640029">fd</span>&nbsp;<span class="builtintype" id="2640032">int</span><span class="op" id="2640035">,</span>&nbsp;<span class="ident" id="2640037">offset</span>&nbsp;<span class="ident" id="2640044">int64</span><span class="op" id="2640049">,</span>&nbsp;<span class="ident" id="2640051">length</span>&nbsp;<span class="builtintype" id="2640058">int</span><span class="op" id="2640061">,</span>&nbsp;<span class="ident" id="2640063">prot</span>&nbsp;<span class="builtintype" id="2640068">int</span><span class="op" id="2640071">,</span>&nbsp;<span class="ident" id="2640073">flags</span>&nbsp;<span class="builtintype" id="2640079">int</span><span class="op" id="2640082">)</span>&nbsp;<span class="op" id="2640084">(</span><span class="ident" id="2640085">data</span>&nbsp;<span class="op" id="2640090">[</span><span class="op" id="2640091">]</span><span class="builtintype" id="2640092">byte</span><span class="op" id="2640096">,</span>&nbsp;<span class="ident" id="2640098">err</span>&nbsp;<span class="builtintype" id="2640102">error</span><span class="op" id="2640107">)</span>&nbsp;<span class="op" id="2640109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2640112">return</span>&nbsp;<span class="ident" id="2640119">mapper</span><span class="op" id="2640125">.</span><span class="ident" id="2640126">Mmap</span><span class="op" id="2640130">(</span><span class="ident" id="2640131">fd</span><span class="op" id="2640133">,</span>&nbsp;<span class="ident" id="2640135">offset</span><span class="op" id="2640141">,</span>&nbsp;<span class="ident" id="2640143">length</span><span class="op" id="2640149">,</span>&nbsp;<span class="ident" id="2640151">prot</span><span class="op" id="2640155">,</span>&nbsp;<span class="ident" id="2640157">flags</span><span class="op" id="2640162">)</span><br>
<span class="lineno"></span><span class="op" id="2640164">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span><span class="keyword" id="2640167">func</span>&nbsp;<span class="ident" id="2640172">Munmap</span><span class="op" id="2640178">(</span><span class="ident" id="2640179">b</span>&nbsp;<span class="op" id="2640181">[</span><span class="op" id="2640182">]</span><span class="builtintype" id="2640183">byte</span><span class="op" id="2640187">)</span>&nbsp;<span class="op" id="2640189">(</span><span class="ident" id="2640190">err</span>&nbsp;<span class="builtintype" id="2640194">error</span><span class="op" id="2640199">)</span>&nbsp;<span class="op" id="2640201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2640204">return</span>&nbsp;<span class="ident" id="2640211">mapper</span><span class="op" id="2640217">.</span><span class="ident" id="2640218">Munmap</span><span class="op" id="2640224">(</span><span class="ident" id="2640225">b</span><span class="op" id="2640226">)</span><br>
<span class="lineno"></span><span class="op" id="2640228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="2640231">//sys&nbsp;&nbsp;&nbsp;&nbspMadvise(b&nbsp;[]byte,&nbsp;advice&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2640279">//sys&nbsp;&nbsp;&nbsp;&nbspMprotect(b&nbsp;[]byte,&nbsp;prot&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2640326">//sys&nbsp;&nbsp;&nbsp;&nbspMlock(b&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2640360">//sys&nbsp;&nbsp;&nbsp;&nbspMunlock(b&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2640396">//sys&nbsp;&nbsp;&nbsp;&nbspMlockall(flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">905</span><span class="comment" id="2640434">//sys&nbsp;&nbsp;&nbsp;&nbspMunlockall()&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2640466">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Unimplemented<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno">910</span><span class="comment" id="2640490">//&nbsp;AddKey</span><br>
<span class="lineno"></span><span class="comment" id="2640500">//&nbsp;AfsSyscall</span><br>
<span class="lineno"></span><span class="comment" id="2640514">//&nbsp;Alarm</span><br>
<span class="lineno"></span><span class="comment" id="2640523">//&nbsp;ArchPrctl</span><br>
<span class="lineno"></span><span class="comment" id="2640536">//&nbsp;Brk</span><br>
<span class="lineno">915</span><span class="comment" id="2640543">//&nbsp;Capget</span><br>
<span class="lineno"></span><span class="comment" id="2640553">//&nbsp;Capset</span><br>
<span class="lineno"></span><span class="comment" id="2640563">//&nbsp;ClockGetres</span><br>
<span class="lineno"></span><span class="comment" id="2640578">//&nbsp;ClockGettime</span><br>
<span class="lineno"></span><span class="comment" id="2640594">//&nbsp;ClockNanosleep</span><br>
<span class="lineno">920</span><span class="comment" id="2640612">//&nbsp;ClockSettime</span><br>
<span class="lineno"></span><span class="comment" id="2640628">//&nbsp;Clone</span><br>
<span class="lineno"></span><span class="comment" id="2640637">//&nbsp;CreateModule</span><br>
<span class="lineno"></span><span class="comment" id="2640653">//&nbsp;DeleteModule</span><br>
<span class="lineno"></span><span class="comment" id="2640669">//&nbsp;EpollCtlOld</span><br>
<span class="lineno">925</span><span class="comment" id="2640684">//&nbsp;EpollPwait</span><br>
<span class="lineno"></span><span class="comment" id="2640698">//&nbsp;EpollWaitOld</span><br>
<span class="lineno"></span><span class="comment" id="2640714">//&nbsp;Eventfd</span><br>
<span class="lineno"></span><span class="comment" id="2640725">//&nbsp;Execve</span><br>
<span class="lineno"></span><span class="comment" id="2640735">//&nbsp;Fadvise64</span><br>
<span class="lineno">930</span><span class="comment" id="2640748">//&nbsp;Fgetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2640761">//&nbsp;Flistxattr</span><br>
<span class="lineno"></span><span class="comment" id="2640775">//&nbsp;Fork</span><br>
<span class="lineno"></span><span class="comment" id="2640783">//&nbsp;Fremovexattr</span><br>
<span class="lineno"></span><span class="comment" id="2640799">//&nbsp;Fsetxattr</span><br>
<span class="lineno">935</span><span class="comment" id="2640812">//&nbsp;Futex</span><br>
<span class="lineno"></span><span class="comment" id="2640821">//&nbsp;GetKernelSyms</span><br>
<span class="lineno"></span><span class="comment" id="2640838">//&nbsp;GetMempolicy</span><br>
<span class="lineno"></span><span class="comment" id="2640854">//&nbsp;GetRobustList</span><br>
<span class="lineno"></span><span class="comment" id="2640871">//&nbsp;GetThreadArea</span><br>
<span class="lineno">940</span><span class="comment" id="2640888">//&nbsp;Getitimer</span><br>
<span class="lineno"></span><span class="comment" id="2640901">//&nbsp;Getpmsg</span><br>
<span class="lineno"></span><span class="comment" id="2640912">//&nbsp;IoCancel</span><br>
<span class="lineno"></span><span class="comment" id="2640924">//&nbsp;IoDestroy</span><br>
<span class="lineno"></span><span class="comment" id="2640937">//&nbsp;IoGetevents</span><br>
<span class="lineno">945</span><span class="comment" id="2640952">//&nbsp;IoSetup</span><br>
<span class="lineno"></span><span class="comment" id="2640963">//&nbsp;IoSubmit</span><br>
<span class="lineno"></span><span class="comment" id="2640975">//&nbsp;Ioctl</span><br>
<span class="lineno"></span><span class="comment" id="2640984">//&nbsp;IoprioGet</span><br>
<span class="lineno"></span><span class="comment" id="2640997">//&nbsp;IoprioSet</span><br>
<span class="lineno">950</span><span class="comment" id="2641010">//&nbsp;KexecLoad</span><br>
<span class="lineno"></span><span class="comment" id="2641023">//&nbsp;Keyctl</span><br>
<span class="lineno"></span><span class="comment" id="2641033">//&nbsp;Lgetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2641046">//&nbsp;Llistxattr</span><br>
<span class="lineno"></span><span class="comment" id="2641060">//&nbsp;LookupDcookie</span><br>
<span class="lineno">955</span><span class="comment" id="2641077">//&nbsp;Lremovexattr</span><br>
<span class="lineno"></span><span class="comment" id="2641093">//&nbsp;Lsetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2641106">//&nbsp;Mbind</span><br>
<span class="lineno"></span><span class="comment" id="2641115">//&nbsp;MigratePages</span><br>
<span class="lineno"></span><span class="comment" id="2641131">//&nbsp;Mincore</span><br>
<span class="lineno">960</span><span class="comment" id="2641142">//&nbsp;ModifyLdt</span><br>
<span class="lineno"></span><span class="comment" id="2641155">//&nbsp;Mount</span><br>
<span class="lineno"></span><span class="comment" id="2641164">//&nbsp;MovePages</span><br>
<span class="lineno"></span><span class="comment" id="2641177">//&nbsp;Mprotect</span><br>
<span class="lineno"></span><span class="comment" id="2641189">//&nbsp;MqGetsetattr</span><br>
<span class="lineno">965</span><span class="comment" id="2641205">//&nbsp;MqNotify</span><br>
<span class="lineno"></span><span class="comment" id="2641217">//&nbsp;MqOpen</span><br>
<span class="lineno"></span><span class="comment" id="2641227">//&nbsp;MqTimedreceive</span><br>
<span class="lineno"></span><span class="comment" id="2641245">//&nbsp;MqTimedsend</span><br>
<span class="lineno"></span><span class="comment" id="2641260">//&nbsp;MqUnlink</span><br>
<span class="lineno">970</span><span class="comment" id="2641272">//&nbsp;Mremap</span><br>
<span class="lineno"></span><span class="comment" id="2641282">//&nbsp;Msgctl</span><br>
<span class="lineno"></span><span class="comment" id="2641292">//&nbsp;Msgget</span><br>
<span class="lineno"></span><span class="comment" id="2641302">//&nbsp;Msgrcv</span><br>
<span class="lineno"></span><span class="comment" id="2641312">//&nbsp;Msgsnd</span><br>
<span class="lineno">975</span><span class="comment" id="2641322">//&nbsp;Msync</span><br>
<span class="lineno"></span><span class="comment" id="2641331">//&nbsp;Newfstatat</span><br>
<span class="lineno"></span><span class="comment" id="2641345">//&nbsp;Nfsservctl</span><br>
<span class="lineno"></span><span class="comment" id="2641359">//&nbsp;Personality</span><br>
<span class="lineno"></span><span class="comment" id="2641374">//&nbsp;Poll</span><br>
<span class="lineno">980</span><span class="comment" id="2641382">//&nbsp;Ppoll</span><br>
<span class="lineno"></span><span class="comment" id="2641391">//&nbsp;Prctl</span><br>
<span class="lineno"></span><span class="comment" id="2641400">//&nbsp;Pselect6</span><br>
<span class="lineno"></span><span class="comment" id="2641412">//&nbsp;Ptrace</span><br>
<span class="lineno"></span><span class="comment" id="2641422">//&nbsp;Putpmsg</span><br>
<span class="lineno">985</span><span class="comment" id="2641433">//&nbsp;QueryModule</span><br>
<span class="lineno"></span><span class="comment" id="2641448">//&nbsp;Quotactl</span><br>
<span class="lineno"></span><span class="comment" id="2641460">//&nbsp;Readahead</span><br>
<span class="lineno"></span><span class="comment" id="2641473">//&nbsp;Readv</span><br>
<span class="lineno"></span><span class="comment" id="2641482">//&nbsp;RemapFilePages</span><br>
<span class="lineno">990</span><span class="comment" id="2641500">//&nbsp;RequestKey</span><br>
<span class="lineno"></span><span class="comment" id="2641514">//&nbsp;RestartSyscall</span><br>
<span class="lineno"></span><span class="comment" id="2641532">//&nbsp;RtSigaction</span><br>
<span class="lineno"></span><span class="comment" id="2641547">//&nbsp;RtSigpending</span><br>
<span class="lineno"></span><span class="comment" id="2641563">//&nbsp;RtSigprocmask</span><br>
<span class="lineno">995</span><span class="comment" id="2641580">//&nbsp;RtSigqueueinfo</span><br>
<span class="lineno"></span><span class="comment" id="2641598">//&nbsp;RtSigreturn</span><br>
<span class="lineno"></span><span class="comment" id="2641613">//&nbsp;RtSigsuspend</span><br>
<span class="lineno"></span><span class="comment" id="2641629">//&nbsp;RtSigtimedwait</span><br>
<span class="lineno"></span><span class="comment" id="2641647">//&nbsp;SchedGetPriorityMax</span><br>
<span class="lineno">1000</span><span class="comment" id="2641670">//&nbsp;SchedGetPriorityMin</span><br>
<span class="lineno"></span><span class="comment" id="2641693">//&nbsp;SchedGetaffinity</span><br>
<span class="lineno"></span><span class="comment" id="2641713">//&nbsp;SchedGetparam</span><br>
<span class="lineno"></span><span class="comment" id="2641730">//&nbsp;SchedGetscheduler</span><br>
<span class="lineno"></span><span class="comment" id="2641751">//&nbsp;SchedRrGetInterval</span><br>
<span class="lineno">1005</span><span class="comment" id="2641773">//&nbsp;SchedSetaffinity</span><br>
<span class="lineno"></span><span class="comment" id="2641793">//&nbsp;SchedSetparam</span><br>
<span class="lineno"></span><span class="comment" id="2641810">//&nbsp;SchedYield</span><br>
<span class="lineno"></span><span class="comment" id="2641824">//&nbsp;Security</span><br>
<span class="lineno"></span><span class="comment" id="2641836">//&nbsp;Semctl</span><br>
<span class="lineno">1010</span><span class="comment" id="2641846">//&nbsp;Semget</span><br>
<span class="lineno"></span><span class="comment" id="2641856">//&nbsp;Semop</span><br>
<span class="lineno"></span><span class="comment" id="2641865">//&nbsp;Semtimedop</span><br>
<span class="lineno"></span><span class="comment" id="2641879">//&nbsp;SetMempolicy</span><br>
<span class="lineno"></span><span class="comment" id="2641895">//&nbsp;SetRobustList</span><br>
<span class="lineno">1015</span><span class="comment" id="2641912">//&nbsp;SetThreadArea</span><br>
<span class="lineno"></span><span class="comment" id="2641929">//&nbsp;SetTidAddress</span><br>
<span class="lineno"></span><span class="comment" id="2641946">//&nbsp;Shmat</span><br>
<span class="lineno"></span><span class="comment" id="2641955">//&nbsp;Shmctl</span><br>
<span class="lineno"></span><span class="comment" id="2641965">//&nbsp;Shmdt</span><br>
<span class="lineno">1020</span><span class="comment" id="2641974">//&nbsp;Shmget</span><br>
<span class="lineno"></span><span class="comment" id="2641984">//&nbsp;Sigaltstack</span><br>
<span class="lineno"></span><span class="comment" id="2641999">//&nbsp;Signalfd</span><br>
<span class="lineno"></span><span class="comment" id="2642011">//&nbsp;Swapoff</span><br>
<span class="lineno"></span><span class="comment" id="2642022">//&nbsp;Swapon</span><br>
<span class="lineno">1025</span><span class="comment" id="2642032">//&nbsp;Sysfs</span><br>
<span class="lineno"></span><span class="comment" id="2642041">//&nbsp;TimerCreate</span><br>
<span class="lineno"></span><span class="comment" id="2642056">//&nbsp;TimerDelete</span><br>
<span class="lineno"></span><span class="comment" id="2642071">//&nbsp;TimerGetoverrun</span><br>
<span class="lineno"></span><span class="comment" id="2642090">//&nbsp;TimerGettime</span><br>
<span class="lineno">1030</span><span class="comment" id="2642106">//&nbsp;TimerSettime</span><br>
<span class="lineno"></span><span class="comment" id="2642122">//&nbsp;Timerfd</span><br>
<span class="lineno"></span><span class="comment" id="2642133">//&nbsp;Tkill&nbsp;(obsolete)</span><br>
<span class="lineno"></span><span class="comment" id="2642153">//&nbsp;Tuxcall</span><br>
<span class="lineno"></span><span class="comment" id="2642164">//&nbsp;Umount2</span><br>
<span class="lineno">1035</span><span class="comment" id="2642175">//&nbsp;Uselib</span><br>
<span class="lineno"></span><span class="comment" id="2642185">//&nbsp;Utimensat</span><br>
<span class="lineno"></span><span class="comment" id="2642198">//&nbsp;Vfork</span><br>
<span class="lineno"></span><span class="comment" id="2642207">//&nbsp;Vhangup</span><br>
<span class="lineno"></span><span class="comment" id="2642218">//&nbsp;Vmsplice</span><br>
<span class="lineno">1040</span><span class="comment" id="2642230">//&nbsp;Vserver</span><br>
<span class="lineno"></span><span class="comment" id="2642241">//&nbsp;Waitid</span><br>
<span class="lineno"></span><span class="comment" id="2642251">//&nbsp;_Sysctl</span>
</div>
</body>
</html>
