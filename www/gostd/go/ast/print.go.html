<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/ast</h2>
<ul>
<li><a href="/gostd/go/ast/ast.go.html">ast.go</a></li>
<li><a href="/gostd/go/ast/ast_test.go.html">ast_test.go</a></li>
<li><a href="/gostd/go/ast/commentmap.go.html">commentmap.go</a></li>
<li><a href="/gostd/go/ast/commentmap_test.go.html">commentmap_test.go</a></li>
<li><a href="/gostd/go/ast/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/ast/filter.go.html">filter.go</a></li>
<li><a href="/gostd/go/ast/filter_test.go.html">filter_test.go</a></li>
<li><a href="/gostd/go/ast/import.go.html">import.go</a></li>
<li><a href="/gostd/go/ast/print.go.html" class="current">print.go</a></li>
<li><a href="/gostd/go/ast/print_test.go.html">print_test.go</a></li>
<li><a href="/gostd/go/ast/resolve.go.html">resolve.go</a></li>
<li><a href="/gostd/go/ast/scope.go.html">scope.go</a></li>
<li><a href="/gostd/go/ast/walk.go.html">walk.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5020002">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5020057">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5020111">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5020162">//&nbsp;This&nbsp;file&nbsp;contains&nbsp;printing&nbsp;support&nbsp;for&nbsp;ASTs.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5020212">package</span>&nbsp;<span class="ident" id="5020220">ast</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5020225">import</span>&nbsp;<span class="op" id="5020232">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5020235">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5020242">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5020254">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5020260">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5020266">&#34;reflect&#34;</span><br>
<span class="lineno">15</span><span class="op" id="5020276">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5020279">//&nbsp;A&nbsp;FieldFilter&nbsp;may&nbsp;be&nbsp;provided&nbsp;to&nbsp;Fprint&nbsp;to&nbsp;control&nbsp;the&nbsp;output.</span><br>
<span class="lineno"></span><span class="keyword" id="5020345">type</span>&nbsp;<span class="ident" id="5020350">FieldFilter</span>&nbsp;<span class="keyword" id="5020362">func</span><span class="op" id="5020366">(</span><span class="ident" id="5020367">name</span>&nbsp;<span class="builtintype" id="5020372">string</span><span class="op" id="5020378">,</span>&nbsp;<span class="ident" id="5020380">value</span>&nbsp;<span class="ident" id="5020386">reflect</span><span class="op" id="5020393">.</span><span class="ident" id="5020394">Value</span><span class="op" id="5020399">)</span>&nbsp;<span class="builtintype" id="5020401">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="5020407">//&nbsp;NotNilFilter&nbsp;returns&nbsp;true&nbsp;for&nbsp;field&nbsp;values&nbsp;that&nbsp;are&nbsp;not&nbsp;nil;</span><br>
<span class="lineno"></span><span class="comment" id="5020471">//&nbsp;it&nbsp;returns&nbsp;false&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="keyword" id="5020502">func</span>&nbsp;<span class="ident" id="5020507">NotNilFilter</span><span class="op" id="5020519">(</span><span class="ident" id="5020520">_</span>&nbsp;<span class="builtintype" id="5020522">string</span><span class="op" id="5020528">,</span>&nbsp;<span class="ident" id="5020530">v</span>&nbsp;<span class="ident" id="5020532">reflect</span><span class="op" id="5020539">.</span><span class="ident" id="5020540">Value</span><span class="op" id="5020545">)</span>&nbsp;<span class="builtintype" id="5020547">bool</span>&nbsp;<span class="op" id="5020552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5020555">switch</span>&nbsp;<span class="ident" id="5020562">v</span><span class="op" id="5020563">.</span><span class="ident" id="5020564">Kind</span><span class="op" id="5020568">(</span><span class="op" id="5020569">)</span>&nbsp;<span class="op" id="5020571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5020574">case</span>&nbsp;<span class="ident" id="5020579">reflect</span><span class="op" id="5020586">.</span><span class="ident" id="5020587">Chan</span><span class="op" id="5020591">,</span>&nbsp;<span class="ident" id="5020593">reflect</span><span class="op" id="5020600">.</span><span class="ident" id="5020601">Func</span><span class="op" id="5020605">,</span>&nbsp;<span class="ident" id="5020607">reflect</span><span class="op" id="5020614">.</span><span class="ident" id="5020615">Interface</span><span class="op" id="5020624">,</span>&nbsp;<span class="ident" id="5020626">reflect</span><span class="op" id="5020633">.</span><span class="ident" id="5020634">Map</span><span class="op" id="5020637">,</span>&nbsp;<span class="ident" id="5020639">reflect</span><span class="op" id="5020646">.</span><span class="ident" id="5020647">Ptr</span><span class="op" id="5020650">,</span>&nbsp;<span class="ident" id="5020652">reflect</span><span class="op" id="5020659">.</span><span class="ident" id="5020660">Slice</span><span class="op" id="5020665">:</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5020669">return</span>&nbsp;<span class="op" id="5020676">!</span><span class="ident" id="5020677">v</span><span class="op" id="5020678">.</span><span class="ident" id="5020679">IsNil</span><span class="op" id="5020684">(</span><span class="op" id="5020685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5020688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5020691">return</span>&nbsp;<span class="builtintype" id="5020698">true</span><br>
<span class="lineno"></span><span class="op" id="5020703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="5020706">//&nbsp;Fprint&nbsp;prints&nbsp;the&nbsp;(sub-)tree&nbsp;starting&nbsp;at&nbsp;AST&nbsp;node&nbsp;x&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="5020767">//&nbsp;If&nbsp;fset&nbsp;!=&nbsp;nil,&nbsp;position&nbsp;information&nbsp;is&nbsp;interpreted&nbsp;relative</span><br>
<span class="lineno"></span><span class="comment" id="5020831">//&nbsp;to&nbsp;that&nbsp;file&nbsp;set.&nbsp;Otherwise&nbsp;positions&nbsp;are&nbsp;printed&nbsp;as&nbsp;integer</span><br>
<span class="lineno"></span><span class="comment" id="5020895">//&nbsp;values&nbsp;(file&nbsp;set&nbsp;specific&nbsp;offsets).</span><br>
<span class="lineno"></span><span class="comment" id="5020934">//</span><br>
<span class="lineno">35</span><span class="comment" id="5020937">//&nbsp;A&nbsp;non-nil&nbsp;FieldFilter&nbsp;f&nbsp;may&nbsp;be&nbsp;provided&nbsp;to&nbsp;control&nbsp;the&nbsp;output:</span><br>
<span class="lineno"></span><span class="comment" id="5021003">//&nbsp;struct&nbsp;fields&nbsp;for&nbsp;which&nbsp;f(fieldname,&nbsp;fieldvalue)&nbsp;is&nbsp;true&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="5021067">//&nbsp;printed;&nbsp;all&nbsp;others&nbsp;are&nbsp;filtered&nbsp;from&nbsp;the&nbsp;output.&nbsp;Unexported</span><br>
<span class="lineno"></span><span class="comment" id="5021131">//&nbsp;struct&nbsp;fields&nbsp;are&nbsp;never&nbsp;printed.</span><br>
<span class="lineno"></span><span class="comment" id="5021167">//</span><br>
<span class="lineno">40</span><span class="keyword" id="5021170">func</span>&nbsp;<span class="ident" id="5021175">Fprint</span><span class="op" id="5021181">(</span><span class="ident" id="5021182">w</span>&nbsp;<span class="ident" id="5021184">io</span><span class="op" id="5021186">.</span><span class="ident" id="5021187">Writer</span><span class="op" id="5021193">,</span>&nbsp;<span class="ident" id="5021195">fset</span>&nbsp;<span class="op" id="5021200">*</span><span class="ident" id="5021201">token</span><span class="op" id="5021206">.</span><span class="ident" id="5021207">FileSet</span><span class="op" id="5021214">,</span>&nbsp;<span class="ident" id="5021216">x</span>&nbsp;<span class="keyword" id="5021218">interface</span><span class="op" id="5021227">{</span><span class="op" id="5021228">}</span><span class="op" id="5021229">,</span>&nbsp;<span class="ident" id="5021231">f</span>&nbsp;<span class="ident" id="5021233">FieldFilter</span><span class="op" id="5021244">)</span>&nbsp;<span class="op" id="5021246">(</span><span class="ident" id="5021247">err</span>&nbsp;<span class="builtintype" id="5021251">error</span><span class="op" id="5021256">)</span>&nbsp;<span class="op" id="5021258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5021261">//&nbsp;setup&nbsp;printer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5021279">p</span>&nbsp;<span class="op" id="5021281">:=</span>&nbsp;<span class="ident" id="5021284">printer</span><span class="op" id="5021291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5021295">output</span><span class="op" id="5021301">:</span>&nbsp;<span class="ident" id="5021303">w</span><span class="op" id="5021304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5021308">fset</span><span class="op" id="5021312">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5021316">fset</span><span class="op" id="5021320">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5021324">filter</span><span class="op" id="5021330">:</span>&nbsp;<span class="ident" id="5021332">f</span><span class="op" id="5021333">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5021337">ptrmap</span><span class="op" id="5021343">:</span>&nbsp;<span class="builtinfunc" id="5021345">make</span><span class="op" id="5021349">(</span><span class="keyword" id="5021350">map</span><span class="op" id="5021353">[</span><span class="keyword" id="5021354">interface</span><span class="op" id="5021363">{</span><span class="op" id="5021364">}</span><span class="op" id="5021365">]</span><span class="builtintype" id="5021366">int</span><span class="op" id="5021369">)</span><span class="op" id="5021370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5021374">last</span><span class="op" id="5021378">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5021382">&#39;\n&#39;</span><span class="op" id="5021386">,</span>&nbsp;<span class="comment" id="5021388">//&nbsp;force&nbsp;printing&nbsp;of&nbsp;line&nbsp;number&nbsp;on&nbsp;first&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5021436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5021440">//&nbsp;install&nbsp;error&nbsp;handler</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5021466">defer</span>&nbsp;<span class="keyword" id="5021472">func</span><span class="op" id="5021476">(</span><span class="op" id="5021477">)</span>&nbsp;<span class="op" id="5021479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5021483">if</span>&nbsp;<span class="ident" id="5021486">e</span>&nbsp;<span class="op" id="5021488">:=</span>&nbsp;<span class="builtinfunc" id="5021491">recover</span><span class="op" id="5021498">(</span><span class="op" id="5021499">)</span><span class="op" id="5021500">;</span>&nbsp;<span class="ident" id="5021502">e</span>&nbsp;<span class="op" id="5021504">!=</span>&nbsp;<span class="builtintype" id="5021507">nil</span>&nbsp;<span class="op" id="5021511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5021516">err</span>&nbsp;<span class="op" id="5021520">=</span>&nbsp;<span class="ident" id="5021522">e</span><span class="op" id="5021523">.</span><span class="op" id="5021524">(</span><span class="ident" id="5021525">localError</span><span class="op" id="5021535">)</span><span class="op" id="5021536">.</span><span class="ident" id="5021537">err</span>&nbsp;<span class="comment" id="5021541">//&nbsp;re-panics&nbsp;if&nbsp;it&#39;s&nbsp;not&nbsp;a&nbsp;localError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5021581">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5021584">}</span><span class="op" id="5021585">(</span><span class="op" id="5021586">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5021590">//&nbsp;print&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5021602">if</span>&nbsp;<span class="ident" id="5021605">x</span>&nbsp;<span class="op" id="5021607">==</span>&nbsp;<span class="builtintype" id="5021610">nil</span>&nbsp;<span class="op" id="5021614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5021618">p</span><span class="op" id="5021619">.</span><span class="ident" id="5021620">printf</span><span class="op" id="5021626">(</span><span class="string" id="5021627">&#34;nil\n&#34;</span><span class="op" id="5021634">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5021638">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5021646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5021649">p</span><span class="op" id="5021650">.</span><span class="builtinfunc" id="5021651">print</span><span class="op" id="5021656">(</span><span class="ident" id="5021657">reflect</span><span class="op" id="5021664">.</span><span class="ident" id="5021665">ValueOf</span><span class="op" id="5021672">(</span><span class="ident" id="5021673">x</span><span class="op" id="5021674">)</span><span class="op" id="5021675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5021678">p</span><span class="op" id="5021679">.</span><span class="ident" id="5021680">printf</span><span class="op" id="5021686">(</span><span class="string" id="5021687">&#34;\n&#34;</span><span class="op" id="5021691">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5021695">return</span><br>
<span class="lineno"></span><span class="op" id="5021702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5021705">//&nbsp;Print&nbsp;prints&nbsp;x&nbsp;to&nbsp;standard&nbsp;output,&nbsp;skipping&nbsp;nil&nbsp;fields.</span><br>
<span class="lineno"></span><span class="comment" id="5021764">//&nbsp;Print(fset,&nbsp;x)&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;Fprint(os.Stdout,&nbsp;fset,&nbsp;x,&nbsp;NotNilFilter).</span><br>
<span class="lineno">70</span><span class="keyword" id="5021839">func</span>&nbsp;<span class="ident" id="5021844">Print</span><span class="op" id="5021849">(</span><span class="ident" id="5021850">fset</span>&nbsp;<span class="op" id="5021855">*</span><span class="ident" id="5021856">token</span><span class="op" id="5021861">.</span><span class="ident" id="5021862">FileSet</span><span class="op" id="5021869">,</span>&nbsp;<span class="ident" id="5021871">x</span>&nbsp;<span class="keyword" id="5021873">interface</span><span class="op" id="5021882">{</span><span class="op" id="5021883">}</span><span class="op" id="5021884">)</span>&nbsp;<span class="builtintype" id="5021886">error</span>&nbsp;<span class="op" id="5021892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5021895">return</span>&nbsp;<span class="ident" id="5021902">Fprint</span><span class="op" id="5021908">(</span><span class="ident" id="5021909">os</span><span class="op" id="5021911">.</span><span class="ident" id="5021912">Stdout</span><span class="op" id="5021918">,</span>&nbsp;<span class="ident" id="5021920">fset</span><span class="op" id="5021924">,</span>&nbsp;<span class="ident" id="5021926">x</span><span class="op" id="5021927">,</span>&nbsp;<span class="ident" id="5021929">NotNilFilter</span><span class="op" id="5021941">)</span><br>
<span class="lineno"></span><span class="op" id="5021943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5021946">type</span>&nbsp;<span class="ident" id="5021951">printer</span>&nbsp;<span class="keyword" id="5021959">struct</span>&nbsp;<span class="op" id="5021966">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5021969">output</span>&nbsp;<span class="ident" id="5021976">io</span><span class="op" id="5021978">.</span><span class="ident" id="5021979">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5021987">fset</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5021994">*</span><span class="ident" id="5021995">token</span><span class="op" id="5022000">.</span><span class="ident" id="5022001">FileSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5022010">filter</span>&nbsp;<span class="ident" id="5022017">FieldFilter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5022030">ptrmap</span>&nbsp;<span class="keyword" id="5022037">map</span><span class="op" id="5022040">[</span><span class="keyword" id="5022041">interface</span><span class="op" id="5022050">{</span><span class="op" id="5022051">}</span><span class="op" id="5022052">]</span><span class="builtintype" id="5022053">int</span>&nbsp;<span class="comment" id="5022057">//&nbsp;*T&nbsp;-&gt;&nbsp;line&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5022079">indent</span>&nbsp;<span class="builtintype" id="5022086">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5022106">//&nbsp;current&nbsp;indentation&nbsp;level</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5022136">last</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5022143">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5022163">//&nbsp;the&nbsp;last&nbsp;byte&nbsp;processed&nbsp;by&nbsp;Write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5022200">line</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5022207">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5022227">//&nbsp;current&nbsp;line&nbsp;number</span><br>
<span class="lineno"></span><span class="op" id="5022250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5022253">var</span>&nbsp;<span class="ident" id="5022257">indent</span>&nbsp;<span class="op" id="5022264">=</span>&nbsp;<span class="op" id="5022266">[</span><span class="op" id="5022267">]</span><span class="builtintype" id="5022268">byte</span><span class="op" id="5022272">(</span><span class="string" id="5022273">&#34;.&nbsp;&nbsp;&#34;</span><span class="op" id="5022278">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="5022281">func</span>&nbsp;<span class="op" id="5022286">(</span><span class="ident" id="5022287">p</span>&nbsp;<span class="op" id="5022289">*</span><span class="ident" id="5022290">printer</span><span class="op" id="5022297">)</span>&nbsp;<span class="ident" id="5022299">Write</span><span class="op" id="5022304">(</span><span class="ident" id="5022305">data</span>&nbsp;<span class="op" id="5022310">[</span><span class="op" id="5022311">]</span><span class="builtintype" id="5022312">byte</span><span class="op" id="5022316">)</span>&nbsp;<span class="op" id="5022318">(</span><span class="ident" id="5022319">n</span>&nbsp;<span class="builtintype" id="5022321">int</span><span class="op" id="5022324">,</span>&nbsp;<span class="ident" id="5022326">err</span>&nbsp;<span class="builtintype" id="5022330">error</span><span class="op" id="5022335">)</span>&nbsp;<span class="op" id="5022337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5022340">var</span>&nbsp;<span class="ident" id="5022344">m</span>&nbsp;<span class="builtintype" id="5022346">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5022351">for</span>&nbsp;<span class="ident" id="5022355">i</span><span class="op" id="5022356">,</span>&nbsp;<span class="ident" id="5022358">b</span>&nbsp;<span class="op" id="5022360">:=</span>&nbsp;<span class="keyword" id="5022363">range</span>&nbsp;<span class="ident" id="5022369">data</span>&nbsp;<span class="op" id="5022374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5022378">//&nbsp;invariant:&nbsp;data[0:n]&nbsp;has&nbsp;been&nbsp;written</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5022421">if</span>&nbsp;<span class="ident" id="5022424">b</span>&nbsp;<span class="op" id="5022426">==</span>&nbsp;<span class="string" id="5022429">&#39;\n&#39;</span>&nbsp;<span class="op" id="5022434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5022439">m</span><span class="op" id="5022440">,</span>&nbsp;<span class="ident" id="5022442">err</span>&nbsp;<span class="op" id="5022446">=</span>&nbsp;<span class="ident" id="5022448">p</span><span class="op" id="5022449">.</span><span class="ident" id="5022450">output</span><span class="op" id="5022456">.</span><span class="ident" id="5022457">Write</span><span class="op" id="5022462">(</span><span class="ident" id="5022463">data</span><span class="op" id="5022467">[</span><span class="ident" id="5022468">n</span>&nbsp;<span class="op" id="5022470">:</span>&nbsp;<span class="ident" id="5022472">i</span><span class="op" id="5022473">+</span><span class="num" id="5022474">1</span><span class="op" id="5022475">]</span><span class="op" id="5022476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5022481">n</span>&nbsp;<span class="op" id="5022483">+=</span>&nbsp;<span class="ident" id="5022486">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5022491">if</span>&nbsp;<span class="ident" id="5022494">err</span>&nbsp;<span class="op" id="5022498">!=</span>&nbsp;<span class="builtintype" id="5022501">nil</span>&nbsp;<span class="op" id="5022505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5022511">return</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5022521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5022526">p</span><span class="op" id="5022527">.</span><span class="ident" id="5022528">line</span><span class="op" id="5022532">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5022537">}</span>&nbsp;<span class="keyword" id="5022539">else</span>&nbsp;<span class="keyword" id="5022544">if</span>&nbsp;<span class="ident" id="5022547">p</span><span class="op" id="5022548">.</span><span class="ident" id="5022549">last</span>&nbsp;<span class="op" id="5022554">==</span>&nbsp;<span class="string" id="5022557">&#39;\n&#39;</span>&nbsp;<span class="op" id="5022562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5022567">_</span><span class="op" id="5022568">,</span>&nbsp;<span class="ident" id="5022570">err</span>&nbsp;<span class="op" id="5022574">=</span>&nbsp;<span class="ident" id="5022576">fmt</span><span class="op" id="5022579">.</span><span class="ident" id="5022580">Fprintf</span><span class="op" id="5022587">(</span><span class="ident" id="5022588">p</span><span class="op" id="5022589">.</span><span class="ident" id="5022590">output</span><span class="op" id="5022596">,</span>&nbsp;<span class="string" id="5022598">&#34;%6d&nbsp;&nbsp;&#34;</span><span class="op" id="5022605">,</span>&nbsp;<span class="ident" id="5022607">p</span><span class="op" id="5022608">.</span><span class="ident" id="5022609">line</span><span class="op" id="5022613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5022618">if</span>&nbsp;<span class="ident" id="5022621">err</span>&nbsp;<span class="op" id="5022625">!=</span>&nbsp;<span class="builtintype" id="5022628">nil</span>&nbsp;<span class="op" id="5022632">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5022638">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5022648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5022653">for</span>&nbsp;<span class="ident" id="5022657">j</span>&nbsp;<span class="op" id="5022659">:=</span>&nbsp;<span class="ident" id="5022662">p</span><span class="op" id="5022663">.</span><span class="ident" id="5022664">indent</span><span class="op" id="5022670">;</span>&nbsp;<span class="ident" id="5022672">j</span>&nbsp;<span class="op" id="5022674">&gt;</span>&nbsp;<span class="num" id="5022676">0</span><span class="op" id="5022677">;</span>&nbsp;<span class="ident" id="5022679">j</span><span class="op" id="5022680">--</span>&nbsp;<span class="op" id="5022683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5022689">_</span><span class="op" id="5022690">,</span>&nbsp;<span class="ident" id="5022692">err</span>&nbsp;<span class="op" id="5022696">=</span>&nbsp;<span class="ident" id="5022698">p</span><span class="op" id="5022699">.</span><span class="ident" id="5022700">output</span><span class="op" id="5022706">.</span><span class="ident" id="5022707">Write</span><span class="op" id="5022712">(</span><span class="ident" id="5022713">indent</span><span class="op" id="5022719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5022725">if</span>&nbsp;<span class="ident" id="5022728">err</span>&nbsp;<span class="op" id="5022732">!=</span>&nbsp;<span class="builtintype" id="5022735">nil</span>&nbsp;<span class="op" id="5022739">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5022746">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5022757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5022762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5022766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5022770">p</span><span class="op" id="5022771">.</span><span class="ident" id="5022772">last</span>&nbsp;<span class="op" id="5022777">=</span>&nbsp;<span class="ident" id="5022779">b</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5022782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5022785">if</span>&nbsp;<span class="builtinfunc" id="5022788">len</span><span class="op" id="5022791">(</span><span class="ident" id="5022792">data</span><span class="op" id="5022796">)</span>&nbsp;<span class="op" id="5022798">&gt;</span>&nbsp;<span class="ident" id="5022800">n</span>&nbsp;<span class="op" id="5022802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5022806">m</span><span class="op" id="5022807">,</span>&nbsp;<span class="ident" id="5022809">err</span>&nbsp;<span class="op" id="5022813">=</span>&nbsp;<span class="ident" id="5022815">p</span><span class="op" id="5022816">.</span><span class="ident" id="5022817">output</span><span class="op" id="5022823">.</span><span class="ident" id="5022824">Write</span><span class="op" id="5022829">(</span><span class="ident" id="5022830">data</span><span class="op" id="5022834">[</span><span class="ident" id="5022835">n</span><span class="op" id="5022836">:</span><span class="op" id="5022837">]</span><span class="op" id="5022838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5022842">n</span>&nbsp;<span class="op" id="5022844">+=</span>&nbsp;<span class="ident" id="5022847">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5022850">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5022853">return</span><br>
<span class="lineno"></span><span class="op" id="5022860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5022863">//&nbsp;localError&nbsp;wraps&nbsp;locally&nbsp;caught&nbsp;errors&nbsp;so&nbsp;we&nbsp;can&nbsp;distinguish</span><br>
<span class="lineno"></span><span class="comment" id="5022927">//&nbsp;them&nbsp;from&nbsp;genuine&nbsp;panics&nbsp;which&nbsp;we&nbsp;don&#39;t&nbsp;want&nbsp;to&nbsp;return&nbsp;as&nbsp;errors.</span><br>
<span class="lineno">120</span><span class="keyword" id="5022996">type</span>&nbsp;<span class="ident" id="5023001">localError</span>&nbsp;<span class="keyword" id="5023012">struct</span>&nbsp;<span class="op" id="5023019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5023022">err</span>&nbsp;<span class="builtintype" id="5023026">error</span><br>
<span class="lineno"></span><span class="op" id="5023032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5023035">//&nbsp;printf&nbsp;is&nbsp;a&nbsp;convenience&nbsp;wrapper&nbsp;that&nbsp;takes&nbsp;care&nbsp;of&nbsp;print&nbsp;errors.</span><br>
<span class="lineno">125</span><span class="keyword" id="5023103">func</span>&nbsp;<span class="op" id="5023108">(</span><span class="ident" id="5023109">p</span>&nbsp;<span class="op" id="5023111">*</span><span class="ident" id="5023112">printer</span><span class="op" id="5023119">)</span>&nbsp;<span class="ident" id="5023121">printf</span><span class="op" id="5023127">(</span><span class="ident" id="5023128">format</span>&nbsp;<span class="builtintype" id="5023135">string</span><span class="op" id="5023141">,</span>&nbsp;<span class="ident" id="5023143">args</span>&nbsp;<span class="op" id="5023148">...</span><span class="keyword" id="5023151">interface</span><span class="op" id="5023160">{</span><span class="op" id="5023161">}</span><span class="op" id="5023162">)</span>&nbsp;<span class="op" id="5023164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5023167">if</span>&nbsp;<span class="ident" id="5023170">_</span><span class="op" id="5023171">,</span>&nbsp;<span class="ident" id="5023173">err</span>&nbsp;<span class="op" id="5023177">:=</span>&nbsp;<span class="ident" id="5023180">fmt</span><span class="op" id="5023183">.</span><span class="ident" id="5023184">Fprintf</span><span class="op" id="5023191">(</span><span class="ident" id="5023192">p</span><span class="op" id="5023193">,</span>&nbsp;<span class="ident" id="5023195">format</span><span class="op" id="5023201">,</span>&nbsp;<span class="ident" id="5023203">args</span><span class="op" id="5023207">...</span><span class="op" id="5023210">)</span><span class="op" id="5023211">;</span>&nbsp;<span class="ident" id="5023213">err</span>&nbsp;<span class="op" id="5023217">!=</span>&nbsp;<span class="builtintype" id="5023220">nil</span>&nbsp;<span class="op" id="5023224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5023228">panic</span><span class="op" id="5023233">(</span><span class="ident" id="5023234">localError</span><span class="op" id="5023244">{</span><span class="ident" id="5023245">err</span><span class="op" id="5023248">}</span><span class="op" id="5023249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5023252">}</span><br>
<span class="lineno"></span><span class="op" id="5023254">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="5023257">//&nbsp;Implementation&nbsp;note:&nbsp;Print&nbsp;is&nbsp;written&nbsp;for&nbsp;AST&nbsp;nodes&nbsp;but&nbsp;could&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5023325">//&nbsp;used&nbsp;to&nbsp;print&nbsp;arbitrary&nbsp;data&nbsp;structures;&nbsp;such&nbsp;a&nbsp;version&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="5023391">//&nbsp;probably&nbsp;be&nbsp;in&nbsp;a&nbsp;different&nbsp;package.</span><br>
<span class="lineno"></span><span class="comment" id="5023430">//</span><br>
<span class="lineno">135</span><span class="comment" id="5023433">//&nbsp;Note:&nbsp;This&nbsp;code&nbsp;detects&nbsp;(some)&nbsp;cycles&nbsp;created&nbsp;via&nbsp;pointers&nbsp;but</span><br>
<span class="lineno"></span><span class="comment" id="5023499">//&nbsp;not&nbsp;cycles&nbsp;that&nbsp;are&nbsp;created&nbsp;via&nbsp;slices&nbsp;or&nbsp;maps&nbsp;containing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5023564">//&nbsp;same&nbsp;slice&nbsp;or&nbsp;map.&nbsp;Code&nbsp;for&nbsp;general&nbsp;data&nbsp;structures&nbsp;probably</span><br>
<span class="lineno"></span><span class="comment" id="5023628">//&nbsp;should&nbsp;catch&nbsp;those&nbsp;as&nbsp;well.</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="5023660">func</span>&nbsp;<span class="op" id="5023665">(</span><span class="ident" id="5023666">p</span>&nbsp;<span class="op" id="5023668">*</span><span class="ident" id="5023669">printer</span><span class="op" id="5023676">)</span>&nbsp;<span class="builtinfunc" id="5023678">print</span><span class="op" id="5023683">(</span><span class="ident" id="5023684">x</span>&nbsp;<span class="ident" id="5023686">reflect</span><span class="op" id="5023693">.</span><span class="ident" id="5023694">Value</span><span class="op" id="5023699">)</span>&nbsp;<span class="op" id="5023701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5023704">if</span>&nbsp;<span class="op" id="5023707">!</span><span class="ident" id="5023708">NotNilFilter</span><span class="op" id="5023720">(</span><span class="string" id="5023721">&#34;&#34;</span><span class="op" id="5023723">,</span>&nbsp;<span class="ident" id="5023725">x</span><span class="op" id="5023726">)</span>&nbsp;<span class="op" id="5023728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5023732">p</span><span class="op" id="5023733">.</span><span class="ident" id="5023734">printf</span><span class="op" id="5023740">(</span><span class="string" id="5023741">&#34;nil&#34;</span><span class="op" id="5023746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5023750">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5023758">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5023762">switch</span>&nbsp;<span class="ident" id="5023769">x</span><span class="op" id="5023770">.</span><span class="ident" id="5023771">Kind</span><span class="op" id="5023775">(</span><span class="op" id="5023776">)</span>&nbsp;<span class="op" id="5023778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5023781">case</span>&nbsp;<span class="ident" id="5023786">reflect</span><span class="op" id="5023793">.</span><span class="ident" id="5023794">Interface</span><span class="op" id="5023803">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5023807">p</span><span class="op" id="5023808">.</span><span class="builtinfunc" id="5023809">print</span><span class="op" id="5023814">(</span><span class="ident" id="5023815">x</span><span class="op" id="5023816">.</span><span class="ident" id="5023817">Elem</span><span class="op" id="5023821">(</span><span class="op" id="5023822">)</span><span class="op" id="5023823">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5023827">case</span>&nbsp;<span class="ident" id="5023832">reflect</span><span class="op" id="5023839">.</span><span class="ident" id="5023840">Map</span><span class="op" id="5023843">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5023847">p</span><span class="op" id="5023848">.</span><span class="ident" id="5023849">printf</span><span class="op" id="5023855">(</span><span class="string" id="5023856">&#34;%s&nbsp;(len&nbsp;=&nbsp;%d)&nbsp;{&#34;</span><span class="op" id="5023873">,</span>&nbsp;<span class="ident" id="5023875">x</span><span class="op" id="5023876">.</span><span class="ident" id="5023877">Type</span><span class="op" id="5023881">(</span><span class="op" id="5023882">)</span><span class="op" id="5023883">,</span>&nbsp;<span class="ident" id="5023885">x</span><span class="op" id="5023886">.</span><span class="ident" id="5023887">Len</span><span class="op" id="5023890">(</span><span class="op" id="5023891">)</span><span class="op" id="5023892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5023896">if</span>&nbsp;<span class="ident" id="5023899">x</span><span class="op" id="5023900">.</span><span class="ident" id="5023901">Len</span><span class="op" id="5023904">(</span><span class="op" id="5023905">)</span>&nbsp;<span class="op" id="5023907">&gt;</span>&nbsp;<span class="num" id="5023909">0</span>&nbsp;<span class="op" id="5023911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5023916">p</span><span class="op" id="5023917">.</span><span class="ident" id="5023918">indent</span><span class="op" id="5023924">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5023930">p</span><span class="op" id="5023931">.</span><span class="ident" id="5023932">printf</span><span class="op" id="5023938">(</span><span class="string" id="5023939">&#34;\n&#34;</span><span class="op" id="5023943">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5023948">for</span>&nbsp;<span class="ident" id="5023952">_</span><span class="op" id="5023953">,</span>&nbsp;<span class="ident" id="5023955">key</span>&nbsp;<span class="op" id="5023959">:=</span>&nbsp;<span class="keyword" id="5023962">range</span>&nbsp;<span class="ident" id="5023968">x</span><span class="op" id="5023969">.</span><span class="ident" id="5023970">MapKeys</span><span class="op" id="5023977">(</span><span class="op" id="5023978">)</span>&nbsp;<span class="op" id="5023980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5023986">p</span><span class="op" id="5023987">.</span><span class="builtinfunc" id="5023988">print</span><span class="op" id="5023993">(</span><span class="ident" id="5023994">key</span><span class="op" id="5023997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5024003">p</span><span class="op" id="5024004">.</span><span class="ident" id="5024005">printf</span><span class="op" id="5024011">(</span><span class="string" id="5024012">&#34;:&nbsp;&#34;</span><span class="op" id="5024016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5024022">p</span><span class="op" id="5024023">.</span><span class="builtinfunc" id="5024024">print</span><span class="op" id="5024029">(</span><span class="ident" id="5024030">x</span><span class="op" id="5024031">.</span><span class="ident" id="5024032">MapIndex</span><span class="op" id="5024040">(</span><span class="ident" id="5024041">key</span><span class="op" id="5024044">)</span><span class="op" id="5024045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5024051">p</span><span class="op" id="5024052">.</span><span class="ident" id="5024053">printf</span><span class="op" id="5024059">(</span><span class="string" id="5024060">&#34;\n&#34;</span><span class="op" id="5024064">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5024069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5024074">p</span><span class="op" id="5024075">.</span><span class="ident" id="5024076">indent</span><span class="op" id="5024082">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5024087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5024091">p</span><span class="op" id="5024092">.</span><span class="ident" id="5024093">printf</span><span class="op" id="5024099">(</span><span class="string" id="5024100">&#34;}&#34;</span><span class="op" id="5024103">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5024107">case</span>&nbsp;<span class="ident" id="5024112">reflect</span><span class="op" id="5024119">.</span><span class="ident" id="5024120">Ptr</span><span class="op" id="5024123">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5024127">p</span><span class="op" id="5024128">.</span><span class="ident" id="5024129">printf</span><span class="op" id="5024135">(</span><span class="string" id="5024136">&#34;*&#34;</span><span class="op" id="5024139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5024143">//&nbsp;type-checked&nbsp;ASTs&nbsp;may&nbsp;contain&nbsp;cycles&nbsp;-&nbsp;use&nbsp;ptrmap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5024198">//&nbsp;to&nbsp;keep&nbsp;track&nbsp;of&nbsp;objects&nbsp;that&nbsp;have&nbsp;been&nbsp;printed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5024251">//&nbsp;already&nbsp;and&nbsp;print&nbsp;the&nbsp;respective&nbsp;line&nbsp;number&nbsp;instead</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5024309">ptr</span>&nbsp;<span class="op" id="5024313">:=</span>&nbsp;<span class="ident" id="5024316">x</span><span class="op" id="5024317">.</span><span class="ident" id="5024318">Interface</span><span class="op" id="5024327">(</span><span class="op" id="5024328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5024332">if</span>&nbsp;<span class="ident" id="5024335">line</span><span class="op" id="5024339">,</span>&nbsp;<span class="ident" id="5024341">exists</span>&nbsp;<span class="op" id="5024348">:=</span>&nbsp;<span class="ident" id="5024351">p</span><span class="op" id="5024352">.</span><span class="ident" id="5024353">ptrmap</span><span class="op" id="5024359">[</span><span class="ident" id="5024360">ptr</span><span class="op" id="5024363">]</span><span class="op" id="5024364">;</span>&nbsp;<span class="ident" id="5024366">exists</span>&nbsp;<span class="op" id="5024373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5024378">p</span><span class="op" id="5024379">.</span><span class="ident" id="5024380">printf</span><span class="op" id="5024386">(</span><span class="string" id="5024387">&#34;(obj&nbsp;@&nbsp;%d)&#34;</span><span class="op" id="5024399">,</span>&nbsp;<span class="ident" id="5024401">line</span><span class="op" id="5024405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5024409">}</span>&nbsp;<span class="keyword" id="5024411">else</span>&nbsp;<span class="op" id="5024416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5024421">p</span><span class="op" id="5024422">.</span><span class="ident" id="5024423">ptrmap</span><span class="op" id="5024429">[</span><span class="ident" id="5024430">ptr</span><span class="op" id="5024433">]</span>&nbsp;<span class="op" id="5024435">=</span>&nbsp;<span class="ident" id="5024437">p</span><span class="op" id="5024438">.</span><span class="ident" id="5024439">line</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5024447">p</span><span class="op" id="5024448">.</span><span class="builtinfunc" id="5024449">print</span><span class="op" id="5024454">(</span><span class="ident" id="5024455">x</span><span class="op" id="5024456">.</span><span class="ident" id="5024457">Elem</span><span class="op" id="5024461">(</span><span class="op" id="5024462">)</span><span class="op" id="5024463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5024467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5024471">case</span>&nbsp;<span class="ident" id="5024476">reflect</span><span class="op" id="5024483">.</span><span class="ident" id="5024484">Array</span><span class="op" id="5024489">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5024493">p</span><span class="op" id="5024494">.</span><span class="ident" id="5024495">printf</span><span class="op" id="5024501">(</span><span class="string" id="5024502">&#34;%s&nbsp;{&#34;</span><span class="op" id="5024508">,</span>&nbsp;<span class="ident" id="5024510">x</span><span class="op" id="5024511">.</span><span class="ident" id="5024512">Type</span><span class="op" id="5024516">(</span><span class="op" id="5024517">)</span><span class="op" id="5024518">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5024522">if</span>&nbsp;<span class="ident" id="5024525">x</span><span class="op" id="5024526">.</span><span class="ident" id="5024527">Len</span><span class="op" id="5024530">(</span><span class="op" id="5024531">)</span>&nbsp;<span class="op" id="5024533">&gt;</span>&nbsp;<span class="num" id="5024535">0</span>&nbsp;<span class="op" id="5024537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5024542">p</span><span class="op" id="5024543">.</span><span class="ident" id="5024544">indent</span><span class="op" id="5024550">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5024556">p</span><span class="op" id="5024557">.</span><span class="ident" id="5024558">printf</span><span class="op" id="5024564">(</span><span class="string" id="5024565">&#34;\n&#34;</span><span class="op" id="5024569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5024574">for</span>&nbsp;<span class="ident" id="5024578">i</span><span class="op" id="5024579">,</span>&nbsp;<span class="ident" id="5024581">n</span>&nbsp;<span class="op" id="5024583">:=</span>&nbsp;<span class="num" id="5024586">0</span><span class="op" id="5024587">,</span>&nbsp;<span class="ident" id="5024589">x</span><span class="op" id="5024590">.</span><span class="ident" id="5024591">Len</span><span class="op" id="5024594">(</span><span class="op" id="5024595">)</span><span class="op" id="5024596">;</span>&nbsp;<span class="ident" id="5024598">i</span>&nbsp;<span class="op" id="5024600">&lt;</span>&nbsp;<span class="ident" id="5024602">n</span><span class="op" id="5024603">;</span>&nbsp;<span class="ident" id="5024605">i</span><span class="op" id="5024606">++</span>&nbsp;<span class="op" id="5024609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5024615">p</span><span class="op" id="5024616">.</span><span class="ident" id="5024617">printf</span><span class="op" id="5024623">(</span><span class="string" id="5024624">&#34;%d:&nbsp;&#34;</span><span class="op" id="5024630">,</span>&nbsp;<span class="ident" id="5024632">i</span><span class="op" id="5024633">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5024639">p</span><span class="op" id="5024640">.</span><span class="builtinfunc" id="5024641">print</span><span class="op" id="5024646">(</span><span class="ident" id="5024647">x</span><span class="op" id="5024648">.</span><span class="ident" id="5024649">Index</span><span class="op" id="5024654">(</span><span class="ident" id="5024655">i</span><span class="op" id="5024656">)</span><span class="op" id="5024657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5024663">p</span><span class="op" id="5024664">.</span><span class="ident" id="5024665">printf</span><span class="op" id="5024671">(</span><span class="string" id="5024672">&#34;\n&#34;</span><span class="op" id="5024676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5024681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5024686">p</span><span class="op" id="5024687">.</span><span class="ident" id="5024688">indent</span><span class="op" id="5024694">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5024699">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5024703">p</span><span class="op" id="5024704">.</span><span class="ident" id="5024705">printf</span><span class="op" id="5024711">(</span><span class="string" id="5024712">&#34;}&#34;</span><span class="op" id="5024715">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5024719">case</span>&nbsp;<span class="ident" id="5024724">reflect</span><span class="op" id="5024731">.</span><span class="ident" id="5024732">Slice</span><span class="op" id="5024737">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5024741">if</span>&nbsp;<span class="ident" id="5024744">s</span><span class="op" id="5024745">,</span>&nbsp;<span class="ident" id="5024747">ok</span>&nbsp;<span class="op" id="5024750">:=</span>&nbsp;<span class="ident" id="5024753">x</span><span class="op" id="5024754">.</span><span class="ident" id="5024755">Interface</span><span class="op" id="5024764">(</span><span class="op" id="5024765">)</span><span class="op" id="5024766">.</span><span class="op" id="5024767">(</span><span class="op" id="5024768">[</span><span class="op" id="5024769">]</span><span class="builtintype" id="5024770">byte</span><span class="op" id="5024774">)</span><span class="op" id="5024775">;</span>&nbsp;<span class="ident" id="5024777">ok</span>&nbsp;<span class="op" id="5024780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5024785">p</span><span class="op" id="5024786">.</span><span class="ident" id="5024787">printf</span><span class="op" id="5024793">(</span><span class="string" id="5024794">&#34;%#q&#34;</span><span class="op" id="5024799">,</span>&nbsp;<span class="ident" id="5024801">s</span><span class="op" id="5024802">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5024807">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5024816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5024820">p</span><span class="op" id="5024821">.</span><span class="ident" id="5024822">printf</span><span class="op" id="5024828">(</span><span class="string" id="5024829">&#34;%s&nbsp;(len&nbsp;=&nbsp;%d)&nbsp;{&#34;</span><span class="op" id="5024846">,</span>&nbsp;<span class="ident" id="5024848">x</span><span class="op" id="5024849">.</span><span class="ident" id="5024850">Type</span><span class="op" id="5024854">(</span><span class="op" id="5024855">)</span><span class="op" id="5024856">,</span>&nbsp;<span class="ident" id="5024858">x</span><span class="op" id="5024859">.</span><span class="ident" id="5024860">Len</span><span class="op" id="5024863">(</span><span class="op" id="5024864">)</span><span class="op" id="5024865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5024869">if</span>&nbsp;<span class="ident" id="5024872">x</span><span class="op" id="5024873">.</span><span class="ident" id="5024874">Len</span><span class="op" id="5024877">(</span><span class="op" id="5024878">)</span>&nbsp;<span class="op" id="5024880">&gt;</span>&nbsp;<span class="num" id="5024882">0</span>&nbsp;<span class="op" id="5024884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5024889">p</span><span class="op" id="5024890">.</span><span class="ident" id="5024891">indent</span><span class="op" id="5024897">++</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5024903">p</span><span class="op" id="5024904">.</span><span class="ident" id="5024905">printf</span><span class="op" id="5024911">(</span><span class="string" id="5024912">&#34;\n&#34;</span><span class="op" id="5024916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5024921">for</span>&nbsp;<span class="ident" id="5024925">i</span><span class="op" id="5024926">,</span>&nbsp;<span class="ident" id="5024928">n</span>&nbsp;<span class="op" id="5024930">:=</span>&nbsp;<span class="num" id="5024933">0</span><span class="op" id="5024934">,</span>&nbsp;<span class="ident" id="5024936">x</span><span class="op" id="5024937">.</span><span class="ident" id="5024938">Len</span><span class="op" id="5024941">(</span><span class="op" id="5024942">)</span><span class="op" id="5024943">;</span>&nbsp;<span class="ident" id="5024945">i</span>&nbsp;<span class="op" id="5024947">&lt;</span>&nbsp;<span class="ident" id="5024949">n</span><span class="op" id="5024950">;</span>&nbsp;<span class="ident" id="5024952">i</span><span class="op" id="5024953">++</span>&nbsp;<span class="op" id="5024956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5024962">p</span><span class="op" id="5024963">.</span><span class="ident" id="5024964">printf</span><span class="op" id="5024970">(</span><span class="string" id="5024971">&#34;%d:&nbsp;&#34;</span><span class="op" id="5024977">,</span>&nbsp;<span class="ident" id="5024979">i</span><span class="op" id="5024980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5024986">p</span><span class="op" id="5024987">.</span><span class="builtinfunc" id="5024988">print</span><span class="op" id="5024993">(</span><span class="ident" id="5024994">x</span><span class="op" id="5024995">.</span><span class="ident" id="5024996">Index</span><span class="op" id="5025001">(</span><span class="ident" id="5025002">i</span><span class="op" id="5025003">)</span><span class="op" id="5025004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025010">p</span><span class="op" id="5025011">.</span><span class="ident" id="5025012">printf</span><span class="op" id="5025018">(</span><span class="string" id="5025019">&#34;\n&#34;</span><span class="op" id="5025023">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5025028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025033">p</span><span class="op" id="5025034">.</span><span class="ident" id="5025035">indent</span><span class="op" id="5025041">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5025046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025050">p</span><span class="op" id="5025051">.</span><span class="ident" id="5025052">printf</span><span class="op" id="5025058">(</span><span class="string" id="5025059">&#34;}&#34;</span><span class="op" id="5025062">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5025066">case</span>&nbsp;<span class="ident" id="5025071">reflect</span><span class="op" id="5025078">.</span><span class="ident" id="5025079">Struct</span><span class="op" id="5025085">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025089">t</span>&nbsp;<span class="op" id="5025091">:=</span>&nbsp;<span class="ident" id="5025094">x</span><span class="op" id="5025095">.</span><span class="ident" id="5025096">Type</span><span class="op" id="5025100">(</span><span class="op" id="5025101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025105">p</span><span class="op" id="5025106">.</span><span class="ident" id="5025107">printf</span><span class="op" id="5025113">(</span><span class="string" id="5025114">&#34;%s&nbsp;{&#34;</span><span class="op" id="5025120">,</span>&nbsp;<span class="ident" id="5025122">t</span><span class="op" id="5025123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025127">p</span><span class="op" id="5025128">.</span><span class="ident" id="5025129">indent</span><span class="op" id="5025135">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025140">first</span>&nbsp;<span class="op" id="5025146">:=</span>&nbsp;<span class="builtintype" id="5025149">true</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5025156">for</span>&nbsp;<span class="ident" id="5025160">i</span><span class="op" id="5025161">,</span>&nbsp;<span class="ident" id="5025163">n</span>&nbsp;<span class="op" id="5025165">:=</span>&nbsp;<span class="num" id="5025168">0</span><span class="op" id="5025169">,</span>&nbsp;<span class="ident" id="5025171">t</span><span class="op" id="5025172">.</span><span class="ident" id="5025173">NumField</span><span class="op" id="5025181">(</span><span class="op" id="5025182">)</span><span class="op" id="5025183">;</span>&nbsp;<span class="ident" id="5025185">i</span>&nbsp;<span class="op" id="5025187">&lt;</span>&nbsp;<span class="ident" id="5025189">n</span><span class="op" id="5025190">;</span>&nbsp;<span class="ident" id="5025192">i</span><span class="op" id="5025193">++</span>&nbsp;<span class="op" id="5025196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5025201">//&nbsp;exclude&nbsp;non-exported&nbsp;fields&nbsp;because&nbsp;their</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5025249">//&nbsp;values&nbsp;cannot&nbsp;be&nbsp;accessed&nbsp;via&nbsp;reflection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5025296">if</span>&nbsp;<span class="ident" id="5025299">name</span>&nbsp;<span class="op" id="5025304">:=</span>&nbsp;<span class="ident" id="5025307">t</span><span class="op" id="5025308">.</span><span class="ident" id="5025309">Field</span><span class="op" id="5025314">(</span><span class="ident" id="5025315">i</span><span class="op" id="5025316">)</span><span class="op" id="5025317">.</span><span class="ident" id="5025318">Name</span><span class="op" id="5025322">;</span>&nbsp;<span class="ident" id="5025324">IsExported</span><span class="op" id="5025334">(</span><span class="ident" id="5025335">name</span><span class="op" id="5025339">)</span>&nbsp;<span class="op" id="5025341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025347">value</span>&nbsp;<span class="op" id="5025353">:=</span>&nbsp;<span class="ident" id="5025356">x</span><span class="op" id="5025357">.</span><span class="ident" id="5025358">Field</span><span class="op" id="5025363">(</span><span class="ident" id="5025364">i</span><span class="op" id="5025365">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5025371">if</span>&nbsp;<span class="ident" id="5025374">p</span><span class="op" id="5025375">.</span><span class="ident" id="5025376">filter</span>&nbsp;<span class="op" id="5025383">==</span>&nbsp;<span class="builtintype" id="5025386">nil</span>&nbsp;<span class="op" id="5025390">||</span>&nbsp;<span class="ident" id="5025393">p</span><span class="op" id="5025394">.</span><span class="ident" id="5025395">filter</span><span class="op" id="5025401">(</span><span class="ident" id="5025402">name</span><span class="op" id="5025406">,</span>&nbsp;<span class="ident" id="5025408">value</span><span class="op" id="5025413">)</span>&nbsp;<span class="op" id="5025415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5025422">if</span>&nbsp;<span class="ident" id="5025425">first</span>&nbsp;<span class="op" id="5025431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025439">p</span><span class="op" id="5025440">.</span><span class="ident" id="5025441">printf</span><span class="op" id="5025447">(</span><span class="string" id="5025448">&#34;\n&#34;</span><span class="op" id="5025452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025460">first</span>&nbsp;<span class="op" id="5025466">=</span>&nbsp;<span class="builtintype" id="5025468">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5025479">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025486">p</span><span class="op" id="5025487">.</span><span class="ident" id="5025488">printf</span><span class="op" id="5025494">(</span><span class="string" id="5025495">&#34;%s:&nbsp;&#34;</span><span class="op" id="5025501">,</span>&nbsp;<span class="ident" id="5025503">name</span><span class="op" id="5025507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025514">p</span><span class="op" id="5025515">.</span><span class="builtinfunc" id="5025516">print</span><span class="op" id="5025521">(</span><span class="ident" id="5025522">value</span><span class="op" id="5025527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025534">p</span><span class="op" id="5025535">.</span><span class="ident" id="5025536">printf</span><span class="op" id="5025542">(</span><span class="string" id="5025543">&#34;\n&#34;</span><span class="op" id="5025547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5025553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5025558">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5025562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025566">p</span><span class="op" id="5025567">.</span><span class="ident" id="5025568">indent</span><span class="op" id="5025574">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025579">p</span><span class="op" id="5025580">.</span><span class="ident" id="5025581">printf</span><span class="op" id="5025587">(</span><span class="string" id="5025588">&#34;}&#34;</span><span class="op" id="5025591">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5025595">default</span><span class="op" id="5025602">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025606">v</span>&nbsp;<span class="op" id="5025608">:=</span>&nbsp;<span class="ident" id="5025611">x</span><span class="op" id="5025612">.</span><span class="ident" id="5025613">Interface</span><span class="op" id="5025622">(</span><span class="op" id="5025623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5025627">switch</span>&nbsp;<span class="ident" id="5025634">v</span>&nbsp;<span class="op" id="5025636">:=</span>&nbsp;<span class="ident" id="5025639">v</span><span class="op" id="5025640">.</span><span class="op" id="5025641">(</span><span class="keyword" id="5025642">type</span><span class="op" id="5025646">)</span>&nbsp;<span class="op" id="5025648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5025652">case</span>&nbsp;<span class="builtintype" id="5025657">string</span><span class="op" id="5025663">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5025668">//&nbsp;print&nbsp;strings&nbsp;in&nbsp;quotes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025698">p</span><span class="op" id="5025699">.</span><span class="ident" id="5025700">printf</span><span class="op" id="5025706">(</span><span class="string" id="5025707">&#34;%q&#34;</span><span class="op" id="5025711">,</span>&nbsp;<span class="ident" id="5025713">v</span><span class="op" id="5025714">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5025719">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5025728">case</span>&nbsp;<span class="ident" id="5025733">token</span><span class="op" id="5025738">.</span><span class="ident" id="5025739">Pos</span><span class="op" id="5025742">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5025747">//&nbsp;position&nbsp;values&nbsp;can&nbsp;be&nbsp;printed&nbsp;nicely&nbsp;if&nbsp;we&nbsp;have&nbsp;a&nbsp;file&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5025813">if</span>&nbsp;<span class="ident" id="5025816">p</span><span class="op" id="5025817">.</span><span class="ident" id="5025818">fset</span>&nbsp;<span class="op" id="5025823">!=</span>&nbsp;<span class="builtintype" id="5025826">nil</span>&nbsp;<span class="op" id="5025830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025836">p</span><span class="op" id="5025837">.</span><span class="ident" id="5025838">printf</span><span class="op" id="5025844">(</span><span class="string" id="5025845">&#34;%s&#34;</span><span class="op" id="5025849">,</span>&nbsp;<span class="ident" id="5025851">p</span><span class="op" id="5025852">.</span><span class="ident" id="5025853">fset</span><span class="op" id="5025857">.</span><span class="ident" id="5025858">Position</span><span class="op" id="5025866">(</span><span class="ident" id="5025867">v</span><span class="op" id="5025868">)</span><span class="op" id="5025869">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5025875">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5025885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5025889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5025893">//&nbsp;default</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5025906">p</span><span class="op" id="5025907">.</span><span class="ident" id="5025908">printf</span><span class="op" id="5025914">(</span><span class="string" id="5025915">&#34;%v&#34;</span><span class="op" id="5025919">,</span>&nbsp;<span class="ident" id="5025921">v</span><span class="op" id="5025922">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5025925">}</span><br>
<span class="lineno"></span><span class="op" id="5025927">}</span>
</div>
</body>
</html>
