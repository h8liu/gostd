<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8268257">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8268312">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8268366">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8268417">package</span>&nbsp;<span class="ident" id="8268425">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8268430">import</span>&nbsp;<span class="op" id="8268437">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8268440">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8268450">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="8268453">//&nbsp;See&nbsp;const.go&nbsp;for&nbsp;overview&nbsp;of&nbsp;math&nbsp;here.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8268497">//&nbsp;Test&nbsp;that&nbsp;powx&nbsp;is&nbsp;initialized&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="comment" id="8268541">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;it&nbsp;too.)</span><br>
<span class="lineno">15</span><span class="keyword" id="8268586">func</span>&nbsp;<span class="ident" id="8268591">TestPowx</span><span class="op" id="8268599">(</span><span class="ident" id="8268600">t</span>&nbsp;<span class="op" id="8268602">*</span><span class="ident" id="8268603">testing</span><span class="op" id="8268610">.</span><span class="ident" id="8268611">T</span><span class="op" id="8268612">)</span>&nbsp;<span class="op" id="8268614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8268617">p</span>&nbsp;<span class="op" id="8268619">:=</span>&nbsp;<span class="num" id="8268622">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8268625">for</span>&nbsp;<span class="ident" id="8268629">i</span>&nbsp;<span class="op" id="8268631">:=</span>&nbsp;<span class="num" id="8268634">0</span><span class="op" id="8268635">;</span>&nbsp;<span class="ident" id="8268637">i</span>&nbsp;<span class="op" id="8268639">&lt;</span>&nbsp;<span class="builtinfunc" id="8268641">len</span><span class="op" id="8268644">(</span><span class="ident" id="8268645">powx</span><span class="op" id="8268649">)</span><span class="op" id="8268650">;</span>&nbsp;<span class="ident" id="8268652">i</span><span class="op" id="8268653">++</span>&nbsp;<span class="op" id="8268656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8268660">if</span>&nbsp;<span class="ident" id="8268663">powx</span><span class="op" id="8268667">[</span><span class="ident" id="8268668">i</span><span class="op" id="8268669">]</span>&nbsp;<span class="op" id="8268671">!=</span>&nbsp;<span class="builtintype" id="8268674">byte</span><span class="op" id="8268678">(</span><span class="ident" id="8268679">p</span><span class="op" id="8268680">)</span>&nbsp;<span class="op" id="8268682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8268687">t</span><span class="op" id="8268688">.</span><span class="ident" id="8268689">Errorf</span><span class="op" id="8268695">(</span><span class="string" id="8268696">&#34;powx[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8268722">,</span>&nbsp;<span class="ident" id="8268724">i</span><span class="op" id="8268725">,</span>&nbsp;<span class="ident" id="8268727">powx</span><span class="op" id="8268731">[</span><span class="ident" id="8268732">i</span><span class="op" id="8268733">]</span><span class="op" id="8268734">,</span>&nbsp;<span class="ident" id="8268736">p</span><span class="op" id="8268737">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8268741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8268745">p</span>&nbsp;<span class="op" id="8268747">&lt;&lt;=</span>&nbsp;<span class="num" id="8268751">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8268755">if</span>&nbsp;<span class="ident" id="8268758">p</span><span class="op" id="8268759">&amp;</span><span class="num" id="8268760">0x100</span>&nbsp;<span class="op" id="8268766">!=</span>&nbsp;<span class="num" id="8268769">0</span>&nbsp;<span class="op" id="8268771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8268776">p</span>&nbsp;<span class="op" id="8268778">^=</span>&nbsp;<span class="ident" id="8268781">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8268788">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8268791">}</span><br>
<span class="lineno"></span><span class="op" id="8268793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8268796">//&nbsp;Multiply&nbsp;b&nbsp;and&nbsp;c&nbsp;as&nbsp;GF(2)&nbsp;polynomials&nbsp;modulo&nbsp;poly</span><br>
<span class="lineno"></span><span class="keyword" id="8268849">func</span>&nbsp;<span class="ident" id="8268854">mul</span><span class="op" id="8268857">(</span><span class="ident" id="8268858">b</span><span class="op" id="8268859">,</span>&nbsp;<span class="ident" id="8268861">c</span>&nbsp;<span class="builtintype" id="8268863">uint32</span><span class="op" id="8268869">)</span>&nbsp;<span class="builtintype" id="8268871">uint32</span>&nbsp;<span class="op" id="8268878">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8268881">i</span>&nbsp;<span class="op" id="8268883">:=</span>&nbsp;<span class="ident" id="8268886">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8268889">j</span>&nbsp;<span class="op" id="8268891">:=</span>&nbsp;<span class="ident" id="8268894">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8268897">s</span>&nbsp;<span class="op" id="8268899">:=</span>&nbsp;<span class="builtintype" id="8268902">uint32</span><span class="op" id="8268908">(</span><span class="num" id="8268909">0</span><span class="op" id="8268910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8268913">for</span>&nbsp;<span class="ident" id="8268917">k</span>&nbsp;<span class="op" id="8268919">:=</span>&nbsp;<span class="builtintype" id="8268922">uint32</span><span class="op" id="8268928">(</span><span class="num" id="8268929">1</span><span class="op" id="8268930">)</span><span class="op" id="8268931">;</span>&nbsp;<span class="ident" id="8268933">k</span>&nbsp;<span class="op" id="8268935">&lt;</span>&nbsp;<span class="num" id="8268937">0x100</span>&nbsp;<span class="op" id="8268943">&amp;&amp;</span>&nbsp;<span class="ident" id="8268946">j</span>&nbsp;<span class="op" id="8268948">!=</span>&nbsp;<span class="num" id="8268951">0</span><span class="op" id="8268952">;</span>&nbsp;<span class="ident" id="8268954">k</span>&nbsp;<span class="op" id="8268956">&lt;&lt;=</span>&nbsp;<span class="num" id="8268960">1</span>&nbsp;<span class="op" id="8268962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8268966">//&nbsp;Invariant:&nbsp;k&nbsp;==&nbsp;1&lt;&lt;n,&nbsp;i&nbsp;==&nbsp;b&nbsp;*&nbsp;x‚Åø</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8269008">if</span>&nbsp;<span class="ident" id="8269011">j</span><span class="op" id="8269012">&amp;</span><span class="ident" id="8269013">k</span>&nbsp;<span class="op" id="8269015">!=</span>&nbsp;<span class="num" id="8269018">0</span>&nbsp;<span class="op" id="8269020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8269025">//&nbsp;s&nbsp;+=&nbsp;i&nbsp;in&nbsp;GF(2);&nbsp;xor&nbsp;in&nbsp;binary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8269062">s</span>&nbsp;<span class="op" id="8269064">^=</span>&nbsp;<span class="ident" id="8269067">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8269072">j</span>&nbsp;<span class="op" id="8269074">^=</span>&nbsp;<span class="ident" id="8269077">k</span>&nbsp;<span class="comment" id="8269079">//&nbsp;turn&nbsp;off&nbsp;bit&nbsp;to&nbsp;end&nbsp;loop&nbsp;early</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8269115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8269120">//&nbsp;i&nbsp;*=&nbsp;x&nbsp;in&nbsp;GF(2)&nbsp;modulo&nbsp;the&nbsp;polynomial</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8269163">i</span>&nbsp;<span class="op" id="8269165">&lt;&lt;=</span>&nbsp;<span class="num" id="8269169">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8269173">if</span>&nbsp;<span class="ident" id="8269176">i</span><span class="op" id="8269177">&amp;</span><span class="num" id="8269178">0x100</span>&nbsp;<span class="op" id="8269184">!=</span>&nbsp;<span class="num" id="8269187">0</span>&nbsp;<span class="op" id="8269189">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8269194">i</span>&nbsp;<span class="op" id="8269196">^=</span>&nbsp;<span class="ident" id="8269199">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8269206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8269209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8269212">return</span>&nbsp;<span class="ident" id="8269219">s</span><br>
<span class="lineno"></span><span class="op" id="8269221">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="8269224">//&nbsp;Test&nbsp;all&nbsp;mul&nbsp;inputs&nbsp;against&nbsp;bit-by-bit&nbsp;n¬≤&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="8269281">func</span>&nbsp;<span class="ident" id="8269286">TestMul</span><span class="op" id="8269293">(</span><span class="ident" id="8269294">t</span>&nbsp;<span class="op" id="8269296">*</span><span class="ident" id="8269297">testing</span><span class="op" id="8269304">.</span><span class="ident" id="8269305">T</span><span class="op" id="8269306">)</span>&nbsp;<span class="op" id="8269308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8269311">for</span>&nbsp;<span class="ident" id="8269315">i</span>&nbsp;<span class="op" id="8269317">:=</span>&nbsp;<span class="builtintype" id="8269320">uint32</span><span class="op" id="8269326">(</span><span class="num" id="8269327">0</span><span class="op" id="8269328">)</span><span class="op" id="8269329">;</span>&nbsp;<span class="ident" id="8269331">i</span>&nbsp;<span class="op" id="8269333">&lt;</span>&nbsp;<span class="num" id="8269335">256</span><span class="op" id="8269338">;</span>&nbsp;<span class="ident" id="8269340">i</span><span class="op" id="8269341">++</span>&nbsp;<span class="op" id="8269344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8269348">for</span>&nbsp;<span class="ident" id="8269352">j</span>&nbsp;<span class="op" id="8269354">:=</span>&nbsp;<span class="builtintype" id="8269357">uint32</span><span class="op" id="8269363">(</span><span class="num" id="8269364">0</span><span class="op" id="8269365">)</span><span class="op" id="8269366">;</span>&nbsp;<span class="ident" id="8269368">j</span>&nbsp;<span class="op" id="8269370">&lt;</span>&nbsp;<span class="num" id="8269372">256</span><span class="op" id="8269375">;</span>&nbsp;<span class="ident" id="8269377">j</span><span class="op" id="8269378">++</span>&nbsp;<span class="op" id="8269381">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8269386">//&nbsp;Multiply&nbsp;i,&nbsp;j&nbsp;bit&nbsp;by&nbsp;bit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8269418">s</span>&nbsp;<span class="op" id="8269420">:=</span>&nbsp;<span class="builtintype" id="8269423">uint8</span><span class="op" id="8269428">(</span><span class="num" id="8269429">0</span><span class="op" id="8269430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8269435">for</span>&nbsp;<span class="ident" id="8269439">k</span>&nbsp;<span class="op" id="8269441">:=</span>&nbsp;<span class="builtintype" id="8269444">uint</span><span class="op" id="8269448">(</span><span class="num" id="8269449">0</span><span class="op" id="8269450">)</span><span class="op" id="8269451">;</span>&nbsp;<span class="ident" id="8269453">k</span>&nbsp;<span class="op" id="8269455">&lt;</span>&nbsp;<span class="num" id="8269457">8</span><span class="op" id="8269458">;</span>&nbsp;<span class="ident" id="8269460">k</span><span class="op" id="8269461">++</span>&nbsp;<span class="op" id="8269464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8269470">for</span>&nbsp;<span class="ident" id="8269474">l</span>&nbsp;<span class="op" id="8269476">:=</span>&nbsp;<span class="builtintype" id="8269479">uint</span><span class="op" id="8269483">(</span><span class="num" id="8269484">0</span><span class="op" id="8269485">)</span><span class="op" id="8269486">;</span>&nbsp;<span class="ident" id="8269488">l</span>&nbsp;<span class="op" id="8269490">&lt;</span>&nbsp;<span class="num" id="8269492">8</span><span class="op" id="8269493">;</span>&nbsp;<span class="ident" id="8269495">l</span><span class="op" id="8269496">++</span>&nbsp;<span class="op" id="8269499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8269506">if</span>&nbsp;<span class="ident" id="8269509">i</span><span class="op" id="8269510">&amp;</span><span class="op" id="8269511">(</span><span class="num" id="8269512">1</span><span class="op" id="8269513">&lt;&lt;</span><span class="ident" id="8269515">k</span><span class="op" id="8269516">)</span>&nbsp;<span class="op" id="8269518">!=</span>&nbsp;<span class="num" id="8269521">0</span>&nbsp;<span class="op" id="8269523">&amp;&amp;</span>&nbsp;<span class="ident" id="8269526">j</span><span class="op" id="8269527">&amp;</span><span class="op" id="8269528">(</span><span class="num" id="8269529">1</span><span class="op" id="8269530">&lt;&lt;</span><span class="ident" id="8269532">l</span><span class="op" id="8269533">)</span>&nbsp;<span class="op" id="8269535">!=</span>&nbsp;<span class="num" id="8269538">0</span>&nbsp;<span class="op" id="8269540">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8269548">s</span>&nbsp;<span class="op" id="8269550">^=</span>&nbsp;<span class="ident" id="8269553">powx</span><span class="op" id="8269557">[</span><span class="ident" id="8269558">k</span><span class="op" id="8269559">+</span><span class="ident" id="8269560">l</span><span class="op" id="8269561">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8269568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8269574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8269579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8269584">if</span>&nbsp;<span class="ident" id="8269587">x</span>&nbsp;<span class="op" id="8269589">:=</span>&nbsp;<span class="ident" id="8269592">mul</span><span class="op" id="8269595">(</span><span class="ident" id="8269596">i</span><span class="op" id="8269597">,</span>&nbsp;<span class="ident" id="8269599">j</span><span class="op" id="8269600">)</span><span class="op" id="8269601">;</span>&nbsp;<span class="ident" id="8269603">x</span>&nbsp;<span class="op" id="8269605">!=</span>&nbsp;<span class="builtintype" id="8269608">uint32</span><span class="op" id="8269614">(</span><span class="ident" id="8269615">s</span><span class="op" id="8269616">)</span>&nbsp;<span class="op" id="8269618">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8269624">t</span><span class="op" id="8269625">.</span><span class="ident" id="8269626">Fatalf</span><span class="op" id="8269632">(</span><span class="string" id="8269633">&#34;mul(%#x,&nbsp;%#x)&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8269664">,</span>&nbsp;<span class="ident" id="8269666">i</span><span class="op" id="8269667">,</span>&nbsp;<span class="ident" id="8269669">j</span><span class="op" id="8269670">,</span>&nbsp;<span class="ident" id="8269672">x</span><span class="op" id="8269673">,</span>&nbsp;<span class="ident" id="8269675">s</span><span class="op" id="8269676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8269681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8269685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8269688">}</span><br>
<span class="lineno"></span><span class="op" id="8269690">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="8269693">//&nbsp;Check&nbsp;that&nbsp;S-boxes&nbsp;are&nbsp;inverses&nbsp;of&nbsp;each&nbsp;other.</span><br>
<span class="lineno"></span><span class="comment" id="8269743">//&nbsp;They&nbsp;have&nbsp;more&nbsp;structure&nbsp;that&nbsp;we&nbsp;could&nbsp;test,</span><br>
<span class="lineno"></span><span class="comment" id="8269791">//&nbsp;but&nbsp;if&nbsp;this&nbsp;sanity&nbsp;check&nbsp;passes,&nbsp;we&#39;ll&nbsp;assume</span><br>
<span class="lineno"></span><span class="comment" id="8269840">//&nbsp;the&nbsp;cut&nbsp;and&nbsp;paste&nbsp;from&nbsp;the&nbsp;FIPS&nbsp;PDF&nbsp;worked.</span><br>
<span class="lineno">75</span><span class="keyword" id="8269887">func</span>&nbsp;<span class="ident" id="8269892">TestSboxes</span><span class="op" id="8269902">(</span><span class="ident" id="8269903">t</span>&nbsp;<span class="op" id="8269905">*</span><span class="ident" id="8269906">testing</span><span class="op" id="8269913">.</span><span class="ident" id="8269914">T</span><span class="op" id="8269915">)</span>&nbsp;<span class="op" id="8269917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8269920">for</span>&nbsp;<span class="ident" id="8269924">i</span>&nbsp;<span class="op" id="8269926">:=</span>&nbsp;<span class="num" id="8269929">0</span><span class="op" id="8269930">;</span>&nbsp;<span class="ident" id="8269932">i</span>&nbsp;<span class="op" id="8269934">&lt;</span>&nbsp;<span class="num" id="8269936">256</span><span class="op" id="8269939">;</span>&nbsp;<span class="ident" id="8269941">i</span><span class="op" id="8269942">++</span>&nbsp;<span class="op" id="8269945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8269949">if</span>&nbsp;<span class="ident" id="8269952">j</span>&nbsp;<span class="op" id="8269954">:=</span>&nbsp;<span class="ident" id="8269957">sbox0</span><span class="op" id="8269962">[</span><span class="ident" id="8269963">sbox1</span><span class="op" id="8269968">[</span><span class="ident" id="8269969">i</span><span class="op" id="8269970">]</span><span class="op" id="8269971">]</span><span class="op" id="8269972">;</span>&nbsp;<span class="ident" id="8269974">j</span>&nbsp;<span class="op" id="8269976">!=</span>&nbsp;<span class="builtintype" id="8269979">byte</span><span class="op" id="8269983">(</span><span class="ident" id="8269984">i</span><span class="op" id="8269985">)</span>&nbsp;<span class="op" id="8269987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8269992">t</span><span class="op" id="8269993">.</span><span class="ident" id="8269994">Errorf</span><span class="op" id="8270000">(</span><span class="string" id="8270001">&#34;sbox0[sbox1[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="8270026">,</span>&nbsp;<span class="ident" id="8270028">i</span><span class="op" id="8270029">,</span>&nbsp;<span class="ident" id="8270031">j</span><span class="op" id="8270032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270036">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8270040">if</span>&nbsp;<span class="ident" id="8270043">j</span>&nbsp;<span class="op" id="8270045">:=</span>&nbsp;<span class="ident" id="8270048">sbox1</span><span class="op" id="8270053">[</span><span class="ident" id="8270054">sbox0</span><span class="op" id="8270059">[</span><span class="ident" id="8270060">i</span><span class="op" id="8270061">]</span><span class="op" id="8270062">]</span><span class="op" id="8270063">;</span>&nbsp;<span class="ident" id="8270065">j</span>&nbsp;<span class="op" id="8270067">!=</span>&nbsp;<span class="builtintype" id="8270070">byte</span><span class="op" id="8270074">(</span><span class="ident" id="8270075">i</span><span class="op" id="8270076">)</span>&nbsp;<span class="op" id="8270078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270083">t</span><span class="op" id="8270084">.</span><span class="ident" id="8270085">Errorf</span><span class="op" id="8270091">(</span><span class="string" id="8270092">&#34;sbox1[sbox0[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="8270117">,</span>&nbsp;<span class="ident" id="8270119">i</span><span class="op" id="8270120">,</span>&nbsp;<span class="ident" id="8270122">j</span><span class="op" id="8270123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270130">}</span><br>
<span class="lineno"></span><span class="op" id="8270132">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="8270135">//&nbsp;Test&nbsp;that&nbsp;encryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno"></span><span class="comment" id="8270179">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="8270226">func</span>&nbsp;<span class="ident" id="8270231">TestTe</span><span class="op" id="8270237">(</span><span class="ident" id="8270238">t</span>&nbsp;<span class="op" id="8270240">*</span><span class="ident" id="8270241">testing</span><span class="op" id="8270248">.</span><span class="ident" id="8270249">T</span><span class="op" id="8270250">)</span>&nbsp;<span class="op" id="8270252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8270255">for</span>&nbsp;<span class="ident" id="8270259">i</span>&nbsp;<span class="op" id="8270261">:=</span>&nbsp;<span class="num" id="8270264">0</span><span class="op" id="8270265">;</span>&nbsp;<span class="ident" id="8270267">i</span>&nbsp;<span class="op" id="8270269">&lt;</span>&nbsp;<span class="num" id="8270271">256</span><span class="op" id="8270274">;</span>&nbsp;<span class="ident" id="8270276">i</span><span class="op" id="8270277">++</span>&nbsp;<span class="op" id="8270280">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270284">s</span>&nbsp;<span class="op" id="8270286">:=</span>&nbsp;<span class="builtintype" id="8270289">uint32</span><span class="op" id="8270295">(</span><span class="ident" id="8270296">sbox0</span><span class="op" id="8270301">[</span><span class="ident" id="8270302">i</span><span class="op" id="8270303">]</span><span class="op" id="8270304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270308">s2</span>&nbsp;<span class="op" id="8270311">:=</span>&nbsp;<span class="ident" id="8270314">mul</span><span class="op" id="8270317">(</span><span class="ident" id="8270318">s</span><span class="op" id="8270319">,</span>&nbsp;<span class="num" id="8270321">2</span><span class="op" id="8270322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270326">s3</span>&nbsp;<span class="op" id="8270329">:=</span>&nbsp;<span class="ident" id="8270332">mul</span><span class="op" id="8270335">(</span><span class="ident" id="8270336">s</span><span class="op" id="8270337">,</span>&nbsp;<span class="num" id="8270339">3</span><span class="op" id="8270340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270344">w</span>&nbsp;<span class="op" id="8270346">:=</span>&nbsp;<span class="ident" id="8270349">s2</span><span class="op" id="8270351">&lt;&lt;</span><span class="num" id="8270353">24</span>&nbsp;<span class="op" id="8270356">|</span>&nbsp;<span class="ident" id="8270358">s</span><span class="op" id="8270359">&lt;&lt;</span><span class="num" id="8270361">16</span>&nbsp;<span class="op" id="8270364">|</span>&nbsp;<span class="ident" id="8270366">s</span><span class="op" id="8270367">&lt;&lt;</span><span class="num" id="8270369">8</span>&nbsp;<span class="op" id="8270371">|</span>&nbsp;<span class="ident" id="8270373">s3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270378">te</span>&nbsp;<span class="op" id="8270381">:=</span>&nbsp;<span class="op" id="8270384">[</span><span class="op" id="8270385">]</span><span class="op" id="8270386">[</span><span class="num" id="8270387">256</span><span class="op" id="8270390">]</span><span class="builtintype" id="8270391">uint32</span><span class="op" id="8270397">{</span><span class="ident" id="8270398">te0</span><span class="op" id="8270401">,</span>&nbsp;<span class="ident" id="8270403">te1</span><span class="op" id="8270406">,</span>&nbsp;<span class="ident" id="8270408">te2</span><span class="op" id="8270411">,</span>&nbsp;<span class="ident" id="8270413">te3</span><span class="op" id="8270416">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8270420">for</span>&nbsp;<span class="ident" id="8270424">j</span>&nbsp;<span class="op" id="8270426">:=</span>&nbsp;<span class="num" id="8270429">0</span><span class="op" id="8270430">;</span>&nbsp;<span class="ident" id="8270432">j</span>&nbsp;<span class="op" id="8270434">&lt;</span>&nbsp;<span class="num" id="8270436">4</span><span class="op" id="8270437">;</span>&nbsp;<span class="ident" id="8270439">j</span><span class="op" id="8270440">++</span>&nbsp;<span class="op" id="8270443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8270448">if</span>&nbsp;<span class="ident" id="8270451">x</span>&nbsp;<span class="op" id="8270453">:=</span>&nbsp;<span class="ident" id="8270456">te</span><span class="op" id="8270458">[</span><span class="ident" id="8270459">j</span><span class="op" id="8270460">]</span><span class="op" id="8270461">[</span><span class="ident" id="8270462">i</span><span class="op" id="8270463">]</span><span class="op" id="8270464">;</span>&nbsp;<span class="ident" id="8270466">x</span>&nbsp;<span class="op" id="8270468">!=</span>&nbsp;<span class="ident" id="8270471">w</span>&nbsp;<span class="op" id="8270473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270479">t</span><span class="op" id="8270480">.</span><span class="ident" id="8270481">Fatalf</span><span class="op" id="8270487">(</span><span class="string" id="8270488">&#34;te[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8270516">,</span>&nbsp;<span class="ident" id="8270518">j</span><span class="op" id="8270519">,</span>&nbsp;<span class="ident" id="8270521">i</span><span class="op" id="8270522">,</span>&nbsp;<span class="ident" id="8270524">x</span><span class="op" id="8270525">,</span>&nbsp;<span class="ident" id="8270527">w</span><span class="op" id="8270528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270538">w</span>&nbsp;<span class="op" id="8270540">=</span>&nbsp;<span class="ident" id="8270542">w</span><span class="op" id="8270543">&lt;&lt;</span><span class="num" id="8270545">24</span>&nbsp;<span class="op" id="8270548">|</span>&nbsp;<span class="ident" id="8270550">w</span><span class="op" id="8270551">&gt;&gt;</span><span class="num" id="8270553">8</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270560">}</span><br>
<span class="lineno"></span><span class="op" id="8270562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8270565">//&nbsp;Test&nbsp;that&nbsp;decryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno">105</span><span class="comment" id="8270609">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="8270656">func</span>&nbsp;<span class="ident" id="8270661">TestTd</span><span class="op" id="8270667">(</span><span class="ident" id="8270668">t</span>&nbsp;<span class="op" id="8270670">*</span><span class="ident" id="8270671">testing</span><span class="op" id="8270678">.</span><span class="ident" id="8270679">T</span><span class="op" id="8270680">)</span>&nbsp;<span class="op" id="8270682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8270685">for</span>&nbsp;<span class="ident" id="8270689">i</span>&nbsp;<span class="op" id="8270691">:=</span>&nbsp;<span class="num" id="8270694">0</span><span class="op" id="8270695">;</span>&nbsp;<span class="ident" id="8270697">i</span>&nbsp;<span class="op" id="8270699">&lt;</span>&nbsp;<span class="num" id="8270701">256</span><span class="op" id="8270704">;</span>&nbsp;<span class="ident" id="8270706">i</span><span class="op" id="8270707">++</span>&nbsp;<span class="op" id="8270710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270714">s</span>&nbsp;<span class="op" id="8270716">:=</span>&nbsp;<span class="builtintype" id="8270719">uint32</span><span class="op" id="8270725">(</span><span class="ident" id="8270726">sbox1</span><span class="op" id="8270731">[</span><span class="ident" id="8270732">i</span><span class="op" id="8270733">]</span><span class="op" id="8270734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270738">s9</span>&nbsp;<span class="op" id="8270741">:=</span>&nbsp;<span class="ident" id="8270744">mul</span><span class="op" id="8270747">(</span><span class="ident" id="8270748">s</span><span class="op" id="8270749">,</span>&nbsp;<span class="num" id="8270751">0x9</span><span class="op" id="8270754">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270758">sb</span>&nbsp;<span class="op" id="8270761">:=</span>&nbsp;<span class="ident" id="8270764">mul</span><span class="op" id="8270767">(</span><span class="ident" id="8270768">s</span><span class="op" id="8270769">,</span>&nbsp;<span class="num" id="8270771">0xb</span><span class="op" id="8270774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270778">sd</span>&nbsp;<span class="op" id="8270781">:=</span>&nbsp;<span class="ident" id="8270784">mul</span><span class="op" id="8270787">(</span><span class="ident" id="8270788">s</span><span class="op" id="8270789">,</span>&nbsp;<span class="num" id="8270791">0xd</span><span class="op" id="8270794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270798">se</span>&nbsp;<span class="op" id="8270801">:=</span>&nbsp;<span class="ident" id="8270804">mul</span><span class="op" id="8270807">(</span><span class="ident" id="8270808">s</span><span class="op" id="8270809">,</span>&nbsp;<span class="num" id="8270811">0xe</span><span class="op" id="8270814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270818">w</span>&nbsp;<span class="op" id="8270820">:=</span>&nbsp;<span class="ident" id="8270823">se</span><span class="op" id="8270825">&lt;&lt;</span><span class="num" id="8270827">24</span>&nbsp;<span class="op" id="8270830">|</span>&nbsp;<span class="ident" id="8270832">s9</span><span class="op" id="8270834">&lt;&lt;</span><span class="num" id="8270836">16</span>&nbsp;<span class="op" id="8270839">|</span>&nbsp;<span class="ident" id="8270841">sd</span><span class="op" id="8270843">&lt;&lt;</span><span class="num" id="8270845">8</span>&nbsp;<span class="op" id="8270847">|</span>&nbsp;<span class="ident" id="8270849">sb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270854">td</span>&nbsp;<span class="op" id="8270857">:=</span>&nbsp;<span class="op" id="8270860">[</span><span class="op" id="8270861">]</span><span class="op" id="8270862">[</span><span class="num" id="8270863">256</span><span class="op" id="8270866">]</span><span class="builtintype" id="8270867">uint32</span><span class="op" id="8270873">{</span><span class="ident" id="8270874">td0</span><span class="op" id="8270877">,</span>&nbsp;<span class="ident" id="8270879">td1</span><span class="op" id="8270882">,</span>&nbsp;<span class="ident" id="8270884">td2</span><span class="op" id="8270887">,</span>&nbsp;<span class="ident" id="8270889">td3</span><span class="op" id="8270892">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8270896">for</span>&nbsp;<span class="ident" id="8270900">j</span>&nbsp;<span class="op" id="8270902">:=</span>&nbsp;<span class="num" id="8270905">0</span><span class="op" id="8270906">;</span>&nbsp;<span class="ident" id="8270908">j</span>&nbsp;<span class="op" id="8270910">&lt;</span>&nbsp;<span class="num" id="8270912">4</span><span class="op" id="8270913">;</span>&nbsp;<span class="ident" id="8270915">j</span><span class="op" id="8270916">++</span>&nbsp;<span class="op" id="8270919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8270924">if</span>&nbsp;<span class="ident" id="8270927">x</span>&nbsp;<span class="op" id="8270929">:=</span>&nbsp;<span class="ident" id="8270932">td</span><span class="op" id="8270934">[</span><span class="ident" id="8270935">j</span><span class="op" id="8270936">]</span><span class="op" id="8270937">[</span><span class="ident" id="8270938">i</span><span class="op" id="8270939">]</span><span class="op" id="8270940">;</span>&nbsp;<span class="ident" id="8270942">x</span>&nbsp;<span class="op" id="8270944">!=</span>&nbsp;<span class="ident" id="8270947">w</span>&nbsp;<span class="op" id="8270949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270955">t</span><span class="op" id="8270956">.</span><span class="ident" id="8270957">Fatalf</span><span class="op" id="8270963">(</span><span class="string" id="8270964">&#34;td[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8270992">,</span>&nbsp;<span class="ident" id="8270994">j</span><span class="op" id="8270995">,</span>&nbsp;<span class="ident" id="8270997">i</span><span class="op" id="8270998">,</span>&nbsp;<span class="ident" id="8271000">x</span><span class="op" id="8271001">,</span>&nbsp;<span class="ident" id="8271003">w</span><span class="op" id="8271004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8271009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8271014">w</span>&nbsp;<span class="op" id="8271016">=</span>&nbsp;<span class="ident" id="8271018">w</span><span class="op" id="8271019">&lt;&lt;</span><span class="num" id="8271021">24</span>&nbsp;<span class="op" id="8271024">|</span>&nbsp;<span class="ident" id="8271026">w</span><span class="op" id="8271027">&gt;&gt;</span><span class="num" id="8271029">8</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8271033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8271036">}</span><br>
<span class="lineno"></span><span class="op" id="8271038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8271041">//&nbsp;Test&nbsp;vectors&nbsp;are&nbsp;from&nbsp;FIPS&nbsp;197:</span><br>
<span class="lineno">125</span><span class="comment" id="8271076">//&nbsp;&nbsp;&nbsp;&nbsphttp://www.csrc.nist.gov/publications/fips/fips197/fips-197.pdf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8271144">//&nbsp;Appendix&nbsp;A&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Key&nbsp;expansion&nbsp;examples</span><br>
<span class="lineno"></span><span class="keyword" id="8271194">type</span>&nbsp;<span class="ident" id="8271199">KeyTest</span>&nbsp;<span class="keyword" id="8271207">struct</span>&nbsp;<span class="op" id="8271214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8271217">key</span>&nbsp;<span class="op" id="8271221">[</span><span class="op" id="8271222">]</span><span class="builtintype" id="8271223">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8271229">enc</span>&nbsp;<span class="op" id="8271233">[</span><span class="op" id="8271234">]</span><span class="builtintype" id="8271235">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8271243">dec</span>&nbsp;<span class="op" id="8271247">[</span><span class="op" id="8271248">]</span><span class="builtintype" id="8271249">uint32</span>&nbsp;<span class="comment" id="8271256">//&nbsp;decryption&nbsp;expansion;&nbsp;not&nbsp;in&nbsp;FIPS&nbsp;197,&nbsp;computed&nbsp;from&nbsp;C&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="op" id="8271330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8271333">var</span>&nbsp;<span class="ident" id="8271337">keyTests</span>&nbsp;<span class="op" id="8271346">=</span>&nbsp;<span class="op" id="8271348">[</span><span class="op" id="8271349">]</span><span class="ident" id="8271350">KeyTest</span><span class="op" id="8271357">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8271360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8271364">//&nbsp;A.1.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;128-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8271409">[</span><span class="op" id="8271410">]</span><span class="builtintype" id="8271411">byte</span><span class="op" id="8271415">{</span><span class="num" id="8271416">0x2b</span><span class="op" id="8271420">,</span>&nbsp;<span class="num" id="8271422">0x7e</span><span class="op" id="8271426">,</span>&nbsp;<span class="num" id="8271428">0x15</span><span class="op" id="8271432">,</span>&nbsp;<span class="num" id="8271434">0x16</span><span class="op" id="8271438">,</span>&nbsp;<span class="num" id="8271440">0x28</span><span class="op" id="8271444">,</span>&nbsp;<span class="num" id="8271446">0xae</span><span class="op" id="8271450">,</span>&nbsp;<span class="num" id="8271452">0xd2</span><span class="op" id="8271456">,</span>&nbsp;<span class="num" id="8271458">0xa6</span><span class="op" id="8271462">,</span>&nbsp;<span class="num" id="8271464">0xab</span><span class="op" id="8271468">,</span>&nbsp;<span class="num" id="8271470">0xf7</span><span class="op" id="8271474">,</span>&nbsp;<span class="num" id="8271476">0x15</span><span class="op" id="8271480">,</span>&nbsp;<span class="num" id="8271482">0x88</span><span class="op" id="8271486">,</span>&nbsp;<span class="num" id="8271488">0x09</span><span class="op" id="8271492">,</span>&nbsp;<span class="num" id="8271494">0xcf</span><span class="op" id="8271498">,</span>&nbsp;<span class="num" id="8271500">0x4f</span><span class="op" id="8271504">,</span>&nbsp;<span class="num" id="8271506">0x3c</span><span class="op" id="8271510">}</span><span class="op" id="8271511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8271515">[</span><span class="op" id="8271516">]</span><span class="builtintype" id="8271517">uint32</span><span class="op" id="8271523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8271528">0x2b7e1516</span><span class="op" id="8271538">,</span>&nbsp;<span class="num" id="8271540">0x28aed2a6</span><span class="op" id="8271550">,</span>&nbsp;<span class="num" id="8271552">0xabf71588</span><span class="op" id="8271562">,</span>&nbsp;<span class="num" id="8271564">0x09cf4f3c</span><span class="op" id="8271574">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8271579">0xa0fafe17</span><span class="op" id="8271589">,</span>&nbsp;<span class="num" id="8271591">0x88542cb1</span><span class="op" id="8271601">,</span>&nbsp;<span class="num" id="8271603">0x23a33939</span><span class="op" id="8271613">,</span>&nbsp;<span class="num" id="8271615">0x2a6c7605</span><span class="op" id="8271625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8271630">0xf2c295f2</span><span class="op" id="8271640">,</span>&nbsp;<span class="num" id="8271642">0x7a96b943</span><span class="op" id="8271652">,</span>&nbsp;<span class="num" id="8271654">0x5935807a</span><span class="op" id="8271664">,</span>&nbsp;<span class="num" id="8271666">0x7359f67f</span><span class="op" id="8271676">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8271681">0x3d80477d</span><span class="op" id="8271691">,</span>&nbsp;<span class="num" id="8271693">0x4716fe3e</span><span class="op" id="8271703">,</span>&nbsp;<span class="num" id="8271705">0x1e237e44</span><span class="op" id="8271715">,</span>&nbsp;<span class="num" id="8271717">0x6d7a883b</span><span class="op" id="8271727">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8271732">0xef44a541</span><span class="op" id="8271742">,</span>&nbsp;<span class="num" id="8271744">0xa8525b7f</span><span class="op" id="8271754">,</span>&nbsp;<span class="num" id="8271756">0xb671253b</span><span class="op" id="8271766">,</span>&nbsp;<span class="num" id="8271768">0xdb0bad00</span><span class="op" id="8271778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8271783">0xd4d1c6f8</span><span class="op" id="8271793">,</span>&nbsp;<span class="num" id="8271795">0x7c839d87</span><span class="op" id="8271805">,</span>&nbsp;<span class="num" id="8271807">0xcaf2b8bc</span><span class="op" id="8271817">,</span>&nbsp;<span class="num" id="8271819">0x11f915bc</span><span class="op" id="8271829">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8271834">0x6d88a37a</span><span class="op" id="8271844">,</span>&nbsp;<span class="num" id="8271846">0x110b3efd</span><span class="op" id="8271856">,</span>&nbsp;<span class="num" id="8271858">0xdbf98641</span><span class="op" id="8271868">,</span>&nbsp;<span class="num" id="8271870">0xca0093fd</span><span class="op" id="8271880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8271885">0x4e54f70e</span><span class="op" id="8271895">,</span>&nbsp;<span class="num" id="8271897">0x5f5fc9f3</span><span class="op" id="8271907">,</span>&nbsp;<span class="num" id="8271909">0x84a64fb2</span><span class="op" id="8271919">,</span>&nbsp;<span class="num" id="8271921">0x4ea6dc4f</span><span class="op" id="8271931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8271936">0xead27321</span><span class="op" id="8271946">,</span>&nbsp;<span class="num" id="8271948">0xb58dbad2</span><span class="op" id="8271958">,</span>&nbsp;<span class="num" id="8271960">0x312bf560</span><span class="op" id="8271970">,</span>&nbsp;<span class="num" id="8271972">0x7f8d292f</span><span class="op" id="8271982">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8271987">0xac7766f3</span><span class="op" id="8271997">,</span>&nbsp;<span class="num" id="8271999">0x19fadc21</span><span class="op" id="8272009">,</span>&nbsp;<span class="num" id="8272011">0x28d12941</span><span class="op" id="8272021">,</span>&nbsp;<span class="num" id="8272023">0x575c006e</span><span class="op" id="8272033">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272038">0xd014f9a8</span><span class="op" id="8272048">,</span>&nbsp;<span class="num" id="8272050">0xc9ee2589</span><span class="op" id="8272060">,</span>&nbsp;<span class="num" id="8272062">0xe13f0cc8</span><span class="op" id="8272072">,</span>&nbsp;<span class="num" id="8272074">0xb6630ca6</span><span class="op" id="8272084">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8272088">}</span><span class="op" id="8272089">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8272093">[</span><span class="op" id="8272094">]</span><span class="builtintype" id="8272095">uint32</span><span class="op" id="8272101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272106">0xd014f9a8</span><span class="op" id="8272116">,</span>&nbsp;<span class="num" id="8272118">0xc9ee2589</span><span class="op" id="8272128">,</span>&nbsp;<span class="num" id="8272130">0xe13f0cc8</span><span class="op" id="8272140">,</span>&nbsp;<span class="num" id="8272142">0xb6630ca6</span><span class="op" id="8272152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272157">0xc7b5a63</span><span class="op" id="8272166">,</span>&nbsp;<span class="num" id="8272168">0x1319eafe</span><span class="op" id="8272178">,</span>&nbsp;<span class="num" id="8272180">0xb0398890</span><span class="op" id="8272190">,</span>&nbsp;<span class="num" id="8272192">0x664cfbb4</span><span class="op" id="8272202">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272207">0xdf7d925a</span><span class="op" id="8272217">,</span>&nbsp;<span class="num" id="8272219">0x1f62b09d</span><span class="op" id="8272229">,</span>&nbsp;<span class="num" id="8272231">0xa320626e</span><span class="op" id="8272241">,</span>&nbsp;<span class="num" id="8272243">0xd6757324</span><span class="op" id="8272253">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272258">0x12c07647</span><span class="op" id="8272268">,</span>&nbsp;<span class="num" id="8272270">0xc01f22c7</span><span class="op" id="8272280">,</span>&nbsp;<span class="num" id="8272282">0xbc42d2f3</span><span class="op" id="8272292">,</span>&nbsp;<span class="num" id="8272294">0x7555114a</span><span class="op" id="8272304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272309">0x6efcd876</span><span class="op" id="8272319">,</span>&nbsp;<span class="num" id="8272321">0xd2df5480</span><span class="op" id="8272331">,</span>&nbsp;<span class="num" id="8272333">0x7c5df034</span><span class="op" id="8272343">,</span>&nbsp;<span class="num" id="8272345">0xc917c3b9</span><span class="op" id="8272355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272360">0x6ea30afc</span><span class="op" id="8272370">,</span>&nbsp;<span class="num" id="8272372">0xbc238cf6</span><span class="op" id="8272382">,</span>&nbsp;<span class="num" id="8272384">0xae82a4b4</span><span class="op" id="8272394">,</span>&nbsp;<span class="num" id="8272396">0xb54a338d</span><span class="op" id="8272406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272411">0x90884413</span><span class="op" id="8272421">,</span>&nbsp;<span class="num" id="8272423">0xd280860a</span><span class="op" id="8272433">,</span>&nbsp;<span class="num" id="8272435">0x12a12842</span><span class="op" id="8272445">,</span>&nbsp;<span class="num" id="8272447">0x1bc89739</span><span class="op" id="8272457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272462">0x7c1f13f7</span><span class="op" id="8272472">,</span>&nbsp;<span class="num" id="8272474">0x4208c219</span><span class="op" id="8272484">,</span>&nbsp;<span class="num" id="8272486">0xc021ae48</span><span class="op" id="8272496">,</span>&nbsp;<span class="num" id="8272498">0x969bf7b</span><span class="op" id="8272507">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272512">0xcc7505eb</span><span class="op" id="8272522">,</span>&nbsp;<span class="num" id="8272524">0x3e17d1ee</span><span class="op" id="8272534">,</span>&nbsp;<span class="num" id="8272536">0x82296c51</span><span class="op" id="8272546">,</span>&nbsp;<span class="num" id="8272548">0xc9481133</span><span class="op" id="8272558">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272563">0x2b3708a7</span><span class="op" id="8272573">,</span>&nbsp;<span class="num" id="8272575">0xf262d405</span><span class="op" id="8272585">,</span>&nbsp;<span class="num" id="8272587">0xbc3ebdbf</span><span class="op" id="8272597">,</span>&nbsp;<span class="num" id="8272599">0x4b617d62</span><span class="op" id="8272609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272614">0x2b7e1516</span><span class="op" id="8272624">,</span>&nbsp;<span class="num" id="8272626">0x28aed2a6</span><span class="op" id="8272636">,</span>&nbsp;<span class="num" id="8272638">0xabf71588</span><span class="op" id="8272648">,</span>&nbsp;<span class="num" id="8272650">0x9cf4f3c</span><span class="op" id="8272659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8272663">}</span><span class="op" id="8272664">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8272667">}</span><span class="op" id="8272668">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8272671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8272675">//&nbsp;A.2.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;192-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8272720">[</span><span class="op" id="8272721">]</span><span class="builtintype" id="8272722">byte</span><span class="op" id="8272726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272731">0x8e</span><span class="op" id="8272735">,</span>&nbsp;<span class="num" id="8272737">0x73</span><span class="op" id="8272741">,</span>&nbsp;<span class="num" id="8272743">0xb0</span><span class="op" id="8272747">,</span>&nbsp;<span class="num" id="8272749">0xf7</span><span class="op" id="8272753">,</span>&nbsp;<span class="num" id="8272755">0xda</span><span class="op" id="8272759">,</span>&nbsp;<span class="num" id="8272761">0x0e</span><span class="op" id="8272765">,</span>&nbsp;<span class="num" id="8272767">0x64</span><span class="op" id="8272771">,</span>&nbsp;<span class="num" id="8272773">0x52</span><span class="op" id="8272777">,</span>&nbsp;<span class="num" id="8272779">0xc8</span><span class="op" id="8272783">,</span>&nbsp;<span class="num" id="8272785">0x10</span><span class="op" id="8272789">,</span>&nbsp;<span class="num" id="8272791">0xf3</span><span class="op" id="8272795">,</span>&nbsp;<span class="num" id="8272797">0x2b</span><span class="op" id="8272801">,</span>&nbsp;<span class="num" id="8272803">0x80</span><span class="op" id="8272807">,</span>&nbsp;<span class="num" id="8272809">0x90</span><span class="op" id="8272813">,</span>&nbsp;<span class="num" id="8272815">0x79</span><span class="op" id="8272819">,</span>&nbsp;<span class="num" id="8272821">0xe5</span><span class="op" id="8272825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272830">0x62</span><span class="op" id="8272834">,</span>&nbsp;<span class="num" id="8272836">0xf8</span><span class="op" id="8272840">,</span>&nbsp;<span class="num" id="8272842">0xea</span><span class="op" id="8272846">,</span>&nbsp;<span class="num" id="8272848">0xd2</span><span class="op" id="8272852">,</span>&nbsp;<span class="num" id="8272854">0x52</span><span class="op" id="8272858">,</span>&nbsp;<span class="num" id="8272860">0x2c</span><span class="op" id="8272864">,</span>&nbsp;<span class="num" id="8272866">0x6b</span><span class="op" id="8272870">,</span>&nbsp;<span class="num" id="8272872">0x7b</span><span class="op" id="8272876">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8272880">}</span><span class="op" id="8272881">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8272885">[</span><span class="op" id="8272886">]</span><span class="builtintype" id="8272887">uint32</span><span class="op" id="8272893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272898">0x8e73b0f7</span><span class="op" id="8272908">,</span>&nbsp;<span class="num" id="8272910">0xda0e6452</span><span class="op" id="8272920">,</span>&nbsp;<span class="num" id="8272922">0xc810f32b</span><span class="op" id="8272932">,</span>&nbsp;<span class="num" id="8272934">0x809079e5</span><span class="op" id="8272944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272949">0x62f8ead2</span><span class="op" id="8272959">,</span>&nbsp;<span class="num" id="8272961">0x522c6b7b</span><span class="op" id="8272971">,</span>&nbsp;<span class="num" id="8272973">0xfe0c91f7</span><span class="op" id="8272983">,</span>&nbsp;<span class="num" id="8272985">0x2402f5a5</span><span class="op" id="8272995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273000">0xec12068e</span><span class="op" id="8273010">,</span>&nbsp;<span class="num" id="8273012">0x6c827f6b</span><span class="op" id="8273022">,</span>&nbsp;<span class="num" id="8273024">0x0e7a95b9</span><span class="op" id="8273034">,</span>&nbsp;<span class="num" id="8273036">0x5c56fec2</span><span class="op" id="8273046">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273051">0x4db7b4bd</span><span class="op" id="8273061">,</span>&nbsp;<span class="num" id="8273063">0x69b54118</span><span class="op" id="8273073">,</span>&nbsp;<span class="num" id="8273075">0x85a74796</span><span class="op" id="8273085">,</span>&nbsp;<span class="num" id="8273087">0xe92538fd</span><span class="op" id="8273097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273102">0xe75fad44</span><span class="op" id="8273112">,</span>&nbsp;<span class="num" id="8273114">0xbb095386</span><span class="op" id="8273124">,</span>&nbsp;<span class="num" id="8273126">0x485af057</span><span class="op" id="8273136">,</span>&nbsp;<span class="num" id="8273138">0x21efb14f</span><span class="op" id="8273148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273153">0xa448f6d9</span><span class="op" id="8273163">,</span>&nbsp;<span class="num" id="8273165">0x4d6dce24</span><span class="op" id="8273175">,</span>&nbsp;<span class="num" id="8273177">0xaa326360</span><span class="op" id="8273187">,</span>&nbsp;<span class="num" id="8273189">0x113b30e6</span><span class="op" id="8273199">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273204">0xa25e7ed5</span><span class="op" id="8273214">,</span>&nbsp;<span class="num" id="8273216">0x83b1cf9a</span><span class="op" id="8273226">,</span>&nbsp;<span class="num" id="8273228">0x27f93943</span><span class="op" id="8273238">,</span>&nbsp;<span class="num" id="8273240">0x6a94f767</span><span class="op" id="8273250">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273255">0xc0a69407</span><span class="op" id="8273265">,</span>&nbsp;<span class="num" id="8273267">0xd19da4e1</span><span class="op" id="8273277">,</span>&nbsp;<span class="num" id="8273279">0xec1786eb</span><span class="op" id="8273289">,</span>&nbsp;<span class="num" id="8273291">0x6fa64971</span><span class="op" id="8273301">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273306">0x485f7032</span><span class="op" id="8273316">,</span>&nbsp;<span class="num" id="8273318">0x22cb8755</span><span class="op" id="8273328">,</span>&nbsp;<span class="num" id="8273330">0xe26d1352</span><span class="op" id="8273340">,</span>&nbsp;<span class="num" id="8273342">0x33f0b7b3</span><span class="op" id="8273352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273357">0x40beeb28</span><span class="op" id="8273367">,</span>&nbsp;<span class="num" id="8273369">0x2f18a259</span><span class="op" id="8273379">,</span>&nbsp;<span class="num" id="8273381">0x6747d26b</span><span class="op" id="8273391">,</span>&nbsp;<span class="num" id="8273393">0x458c553e</span><span class="op" id="8273403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273408">0xa7e1466c</span><span class="op" id="8273418">,</span>&nbsp;<span class="num" id="8273420">0x9411f1df</span><span class="op" id="8273430">,</span>&nbsp;<span class="num" id="8273432">0x821f750a</span><span class="op" id="8273442">,</span>&nbsp;<span class="num" id="8273444">0xad07d753</span><span class="op" id="8273454">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273459">0xca400538</span><span class="op" id="8273469">,</span>&nbsp;<span class="num" id="8273471">0x8fcc5006</span><span class="op" id="8273481">,</span>&nbsp;<span class="num" id="8273483">0x282d166a</span><span class="op" id="8273493">,</span>&nbsp;<span class="num" id="8273495">0xbc3ce7b5</span><span class="op" id="8273505">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273510">0xe98ba06f</span><span class="op" id="8273520">,</span>&nbsp;<span class="num" id="8273522">0x448c773c</span><span class="op" id="8273532">,</span>&nbsp;<span class="num" id="8273534">0x8ecc7204</span><span class="op" id="8273544">,</span>&nbsp;<span class="num" id="8273546">0x01002202</span><span class="op" id="8273556">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8273560">}</span><span class="op" id="8273561">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8273565">nil</span><span class="op" id="8273568">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8273571">}</span><span class="op" id="8273572">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8273575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8273579">//&nbsp;A.3.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;256-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8273624">[</span><span class="op" id="8273625">]</span><span class="builtintype" id="8273626">byte</span><span class="op" id="8273630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273635">0x60</span><span class="op" id="8273639">,</span>&nbsp;<span class="num" id="8273641">0x3d</span><span class="op" id="8273645">,</span>&nbsp;<span class="num" id="8273647">0xeb</span><span class="op" id="8273651">,</span>&nbsp;<span class="num" id="8273653">0x10</span><span class="op" id="8273657">,</span>&nbsp;<span class="num" id="8273659">0x15</span><span class="op" id="8273663">,</span>&nbsp;<span class="num" id="8273665">0xca</span><span class="op" id="8273669">,</span>&nbsp;<span class="num" id="8273671">0x71</span><span class="op" id="8273675">,</span>&nbsp;<span class="num" id="8273677">0xbe</span><span class="op" id="8273681">,</span>&nbsp;<span class="num" id="8273683">0x2b</span><span class="op" id="8273687">,</span>&nbsp;<span class="num" id="8273689">0x73</span><span class="op" id="8273693">,</span>&nbsp;<span class="num" id="8273695">0xae</span><span class="op" id="8273699">,</span>&nbsp;<span class="num" id="8273701">0xf0</span><span class="op" id="8273705">,</span>&nbsp;<span class="num" id="8273707">0x85</span><span class="op" id="8273711">,</span>&nbsp;<span class="num" id="8273713">0x7d</span><span class="op" id="8273717">,</span>&nbsp;<span class="num" id="8273719">0x77</span><span class="op" id="8273723">,</span>&nbsp;<span class="num" id="8273725">0x81</span><span class="op" id="8273729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273734">0x1f</span><span class="op" id="8273738">,</span>&nbsp;<span class="num" id="8273740">0x35</span><span class="op" id="8273744">,</span>&nbsp;<span class="num" id="8273746">0x2c</span><span class="op" id="8273750">,</span>&nbsp;<span class="num" id="8273752">0x07</span><span class="op" id="8273756">,</span>&nbsp;<span class="num" id="8273758">0x3b</span><span class="op" id="8273762">,</span>&nbsp;<span class="num" id="8273764">0x61</span><span class="op" id="8273768">,</span>&nbsp;<span class="num" id="8273770">0x08</span><span class="op" id="8273774">,</span>&nbsp;<span class="num" id="8273776">0xd7</span><span class="op" id="8273780">,</span>&nbsp;<span class="num" id="8273782">0x2d</span><span class="op" id="8273786">,</span>&nbsp;<span class="num" id="8273788">0x98</span><span class="op" id="8273792">,</span>&nbsp;<span class="num" id="8273794">0x10</span><span class="op" id="8273798">,</span>&nbsp;<span class="num" id="8273800">0xa3</span><span class="op" id="8273804">,</span>&nbsp;<span class="num" id="8273806">0x09</span><span class="op" id="8273810">,</span>&nbsp;<span class="num" id="8273812">0x14</span><span class="op" id="8273816">,</span>&nbsp;<span class="num" id="8273818">0xdf</span><span class="op" id="8273822">,</span>&nbsp;<span class="num" id="8273824">0xf4</span><span class="op" id="8273828">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8273832">}</span><span class="op" id="8273833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8273837">[</span><span class="op" id="8273838">]</span><span class="builtintype" id="8273839">uint32</span><span class="op" id="8273845">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273850">0x603deb10</span><span class="op" id="8273860">,</span>&nbsp;<span class="num" id="8273862">0x15ca71be</span><span class="op" id="8273872">,</span>&nbsp;<span class="num" id="8273874">0x2b73aef0</span><span class="op" id="8273884">,</span>&nbsp;<span class="num" id="8273886">0x857d7781</span><span class="op" id="8273896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273901">0x1f352c07</span><span class="op" id="8273911">,</span>&nbsp;<span class="num" id="8273913">0x3b6108d7</span><span class="op" id="8273923">,</span>&nbsp;<span class="num" id="8273925">0x2d9810a3</span><span class="op" id="8273935">,</span>&nbsp;<span class="num" id="8273937">0x0914dff4</span><span class="op" id="8273947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273952">0x9ba35411</span><span class="op" id="8273962">,</span>&nbsp;<span class="num" id="8273964">0x8e6925af</span><span class="op" id="8273974">,</span>&nbsp;<span class="num" id="8273976">0xa51a8b5f</span><span class="op" id="8273986">,</span>&nbsp;<span class="num" id="8273988">0x2067fcde</span><span class="op" id="8273998">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274003">0xa8b09c1a</span><span class="op" id="8274013">,</span>&nbsp;<span class="num" id="8274015">0x93d194cd</span><span class="op" id="8274025">,</span>&nbsp;<span class="num" id="8274027">0xbe49846e</span><span class="op" id="8274037">,</span>&nbsp;<span class="num" id="8274039">0xb75d5b9a</span><span class="op" id="8274049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274054">0xd59aecb8</span><span class="op" id="8274064">,</span>&nbsp;<span class="num" id="8274066">0x5bf3c917</span><span class="op" id="8274076">,</span>&nbsp;<span class="num" id="8274078">0xfee94248</span><span class="op" id="8274088">,</span>&nbsp;<span class="num" id="8274090">0xde8ebe96</span><span class="op" id="8274100">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274105">0xb5a9328a</span><span class="op" id="8274115">,</span>&nbsp;<span class="num" id="8274117">0x2678a647</span><span class="op" id="8274127">,</span>&nbsp;<span class="num" id="8274129">0x98312229</span><span class="op" id="8274139">,</span>&nbsp;<span class="num" id="8274141">0x2f6c79b3</span><span class="op" id="8274151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274156">0x812c81ad</span><span class="op" id="8274166">,</span>&nbsp;<span class="num" id="8274168">0xdadf48ba</span><span class="op" id="8274178">,</span>&nbsp;<span class="num" id="8274180">0x24360af2</span><span class="op" id="8274190">,</span>&nbsp;<span class="num" id="8274192">0xfab8b464</span><span class="op" id="8274202">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274207">0x98c5bfc9</span><span class="op" id="8274217">,</span>&nbsp;<span class="num" id="8274219">0xbebd198e</span><span class="op" id="8274229">,</span>&nbsp;<span class="num" id="8274231">0x268c3ba7</span><span class="op" id="8274241">,</span>&nbsp;<span class="num" id="8274243">0x09e04214</span><span class="op" id="8274253">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274258">0x68007bac</span><span class="op" id="8274268">,</span>&nbsp;<span class="num" id="8274270">0xb2df3316</span><span class="op" id="8274280">,</span>&nbsp;<span class="num" id="8274282">0x96e939e4</span><span class="op" id="8274292">,</span>&nbsp;<span class="num" id="8274294">0x6c518d80</span><span class="op" id="8274304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274309">0xc814e204</span><span class="op" id="8274319">,</span>&nbsp;<span class="num" id="8274321">0x76a9fb8a</span><span class="op" id="8274331">,</span>&nbsp;<span class="num" id="8274333">0x5025c02d</span><span class="op" id="8274343">,</span>&nbsp;<span class="num" id="8274345">0x59c58239</span><span class="op" id="8274355">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274360">0xde136967</span><span class="op" id="8274370">,</span>&nbsp;<span class="num" id="8274372">0x6ccc5a71</span><span class="op" id="8274382">,</span>&nbsp;<span class="num" id="8274384">0xfa256395</span><span class="op" id="8274394">,</span>&nbsp;<span class="num" id="8274396">0x9674ee15</span><span class="op" id="8274406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274411">0x5886ca5d</span><span class="op" id="8274421">,</span>&nbsp;<span class="num" id="8274423">0x2e2f31d7</span><span class="op" id="8274433">,</span>&nbsp;<span class="num" id="8274435">0x7e0af1fa</span><span class="op" id="8274445">,</span>&nbsp;<span class="num" id="8274447">0x27cf73c3</span><span class="op" id="8274457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274462">0x749c47ab</span><span class="op" id="8274472">,</span>&nbsp;<span class="num" id="8274474">0x18501dda</span><span class="op" id="8274484">,</span>&nbsp;<span class="num" id="8274486">0xe2757e4f</span><span class="op" id="8274496">,</span>&nbsp;<span class="num" id="8274498">0x7401905a</span><span class="op" id="8274508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274513">0xcafaaae3</span><span class="op" id="8274523">,</span>&nbsp;<span class="num" id="8274525">0xe4d59b34</span><span class="op" id="8274535">,</span>&nbsp;<span class="num" id="8274537">0x9adf6ace</span><span class="op" id="8274547">,</span>&nbsp;<span class="num" id="8274549">0xbd10190d</span><span class="op" id="8274559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274564">0xfe4890d1</span><span class="op" id="8274574">,</span>&nbsp;<span class="num" id="8274576">0xe6188d0b</span><span class="op" id="8274586">,</span>&nbsp;<span class="num" id="8274588">0x046df344</span><span class="op" id="8274598">,</span>&nbsp;<span class="num" id="8274600">0x706c631e</span><span class="op" id="8274610">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8274614">}</span><span class="op" id="8274615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8274619">nil</span><span class="op" id="8274622">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8274625">}</span><span class="op" id="8274626">,</span><br>
<span class="lineno"></span><span class="op" id="8274628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="comment" id="8274631">//&nbsp;Test&nbsp;key&nbsp;expansion&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="8274680">func</span>&nbsp;<span class="ident" id="8274685">TestExpandKey</span><span class="op" id="8274698">(</span><span class="ident" id="8274699">t</span>&nbsp;<span class="op" id="8274701">*</span><span class="ident" id="8274702">testing</span><span class="op" id="8274709">.</span><span class="ident" id="8274710">T</span><span class="op" id="8274711">)</span>&nbsp;<span class="op" id="8274713">{</span><br>
<span class="lineno"></span><span class="ident" id="8274715">L</span><span class="op" id="8274716">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8274719">for</span>&nbsp;<span class="ident" id="8274723">i</span><span class="op" id="8274724">,</span>&nbsp;<span class="ident" id="8274726">tt</span>&nbsp;<span class="op" id="8274729">:=</span>&nbsp;<span class="keyword" id="8274732">range</span>&nbsp;<span class="ident" id="8274738">keyTests</span>&nbsp;<span class="op" id="8274747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8274751">enc</span>&nbsp;<span class="op" id="8274755">:=</span>&nbsp;<span class="builtinfunc" id="8274758">make</span><span class="op" id="8274762">(</span><span class="op" id="8274763">[</span><span class="op" id="8274764">]</span><span class="builtintype" id="8274765">uint32</span><span class="op" id="8274771">,</span>&nbsp;<span class="builtinfunc" id="8274773">len</span><span class="op" id="8274776">(</span><span class="ident" id="8274777">tt</span><span class="op" id="8274779">.</span><span class="ident" id="8274780">enc</span><span class="op" id="8274783">)</span><span class="op" id="8274784">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8274788">var</span>&nbsp;<span class="ident" id="8274792">dec</span>&nbsp;<span class="op" id="8274796">[</span><span class="op" id="8274797">]</span><span class="builtintype" id="8274798">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8274807">if</span>&nbsp;<span class="ident" id="8274810">tt</span><span class="op" id="8274812">.</span><span class="ident" id="8274813">dec</span>&nbsp;<span class="op" id="8274817">!=</span>&nbsp;<span class="ident" id="8274820">nil</span>&nbsp;<span class="op" id="8274824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8274829">dec</span>&nbsp;<span class="op" id="8274833">=</span>&nbsp;<span class="builtinfunc" id="8274835">make</span><span class="op" id="8274839">(</span><span class="op" id="8274840">[</span><span class="op" id="8274841">]</span><span class="builtintype" id="8274842">uint32</span><span class="op" id="8274848">,</span>&nbsp;<span class="builtinfunc" id="8274850">len</span><span class="op" id="8274853">(</span><span class="ident" id="8274854">tt</span><span class="op" id="8274856">.</span><span class="ident" id="8274857">dec</span><span class="op" id="8274860">)</span><span class="op" id="8274861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8274865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8274869">//&nbsp;This&nbsp;test&nbsp;could&nbsp;only&nbsp;test&nbsp;Go&nbsp;version&nbsp;of&nbsp;expandKey&nbsp;because&nbsp;asm</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8274936">//&nbsp;version&nbsp;might&nbsp;use&nbsp;different&nbsp;memory&nbsp;layout&nbsp;for&nbsp;expanded&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8275001">//&nbsp;This&nbsp;is&nbsp;OK&nbsp;because&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;expanded&nbsp;keys&nbsp;to&nbsp;the&nbsp;outside</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275070">expandKeyGo</span><span class="op" id="8275081">(</span><span class="ident" id="8275082">tt</span><span class="op" id="8275084">.</span><span class="ident" id="8275085">key</span><span class="op" id="8275088">,</span>&nbsp;<span class="ident" id="8275090">enc</span><span class="op" id="8275093">,</span>&nbsp;<span class="ident" id="8275095">dec</span><span class="op" id="8275098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8275102">for</span>&nbsp;<span class="ident" id="8275106">j</span><span class="op" id="8275107">,</span>&nbsp;<span class="ident" id="8275109">v</span>&nbsp;<span class="op" id="8275111">:=</span>&nbsp;<span class="keyword" id="8275114">range</span>&nbsp;<span class="ident" id="8275120">enc</span>&nbsp;<span class="op" id="8275124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8275129">if</span>&nbsp;<span class="ident" id="8275132">v</span>&nbsp;<span class="op" id="8275134">!=</span>&nbsp;<span class="ident" id="8275137">tt</span><span class="op" id="8275139">.</span><span class="ident" id="8275140">enc</span><span class="op" id="8275143">[</span><span class="ident" id="8275144">j</span><span class="op" id="8275145">]</span>&nbsp;<span class="op" id="8275147">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275153">t</span><span class="op" id="8275154">.</span><span class="ident" id="8275155">Errorf</span><span class="op" id="8275161">(</span><span class="string" id="8275162">&#34;key&nbsp;%d:&nbsp;enc[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8275195">,</span>&nbsp;<span class="ident" id="8275197">i</span><span class="op" id="8275198">,</span>&nbsp;<span class="ident" id="8275200">j</span><span class="op" id="8275201">,</span>&nbsp;<span class="ident" id="8275203">v</span><span class="op" id="8275204">,</span>&nbsp;<span class="ident" id="8275206">tt</span><span class="op" id="8275208">.</span><span class="ident" id="8275209">enc</span><span class="op" id="8275212">[</span><span class="ident" id="8275213">j</span><span class="op" id="8275214">]</span><span class="op" id="8275215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8275221">continue</span>&nbsp;<span class="ident" id="8275230">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8275243">if</span>&nbsp;<span class="ident" id="8275246">dec</span>&nbsp;<span class="op" id="8275250">!=</span>&nbsp;<span class="ident" id="8275253">nil</span>&nbsp;<span class="op" id="8275257">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8275262">for</span>&nbsp;<span class="ident" id="8275266">j</span><span class="op" id="8275267">,</span>&nbsp;<span class="ident" id="8275269">v</span>&nbsp;<span class="op" id="8275271">:=</span>&nbsp;<span class="keyword" id="8275274">range</span>&nbsp;<span class="ident" id="8275280">dec</span>&nbsp;<span class="op" id="8275284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8275290">if</span>&nbsp;<span class="ident" id="8275293">v</span>&nbsp;<span class="op" id="8275295">!=</span>&nbsp;<span class="ident" id="8275298">tt</span><span class="op" id="8275300">.</span><span class="ident" id="8275301">dec</span><span class="op" id="8275304">[</span><span class="ident" id="8275305">j</span><span class="op" id="8275306">]</span>&nbsp;<span class="op" id="8275308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275315">t</span><span class="op" id="8275316">.</span><span class="ident" id="8275317">Errorf</span><span class="op" id="8275323">(</span><span class="string" id="8275324">&#34;key&nbsp;%d:&nbsp;dec[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8275357">,</span>&nbsp;<span class="ident" id="8275359">i</span><span class="op" id="8275360">,</span>&nbsp;<span class="ident" id="8275362">j</span><span class="op" id="8275363">,</span>&nbsp;<span class="ident" id="8275365">v</span><span class="op" id="8275366">,</span>&nbsp;<span class="ident" id="8275368">tt</span><span class="op" id="8275370">.</span><span class="ident" id="8275371">dec</span><span class="op" id="8275374">[</span><span class="ident" id="8275375">j</span><span class="op" id="8275376">]</span><span class="op" id="8275377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8275384">continue</span>&nbsp;<span class="ident" id="8275393">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275399">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275411">}</span><br>
<span class="lineno"></span><span class="op" id="8275413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="8275416">//&nbsp;Appendix&nbsp;B,&nbsp;C&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Cipher&nbsp;examples,&nbsp;Example&nbsp;vectors.</span><br>
<span class="lineno"></span><span class="keyword" id="8275480">type</span>&nbsp;<span class="ident" id="8275485">CryptTest</span>&nbsp;<span class="keyword" id="8275495">struct</span>&nbsp;<span class="op" id="8275502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275505">key</span>&nbsp;<span class="op" id="8275509">[</span><span class="op" id="8275510">]</span><span class="builtintype" id="8275511">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275517">in</span>&nbsp;&nbsp;<span class="op" id="8275521">[</span><span class="op" id="8275522">]</span><span class="builtintype" id="8275523">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275529">out</span>&nbsp;<span class="op" id="8275533">[</span><span class="op" id="8275534">]</span><span class="builtintype" id="8275535">byte</span><br>
<span class="lineno">250</span><span class="op" id="8275540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8275543">var</span>&nbsp;<span class="ident" id="8275547">encryptTests</span>&nbsp;<span class="op" id="8275560">=</span>&nbsp;<span class="op" id="8275562">[</span><span class="op" id="8275563">]</span><span class="ident" id="8275564">CryptTest</span><span class="op" id="8275573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8275580">//&nbsp;Appendix&nbsp;B.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275597">[</span><span class="op" id="8275598">]</span><span class="builtintype" id="8275599">byte</span><span class="op" id="8275603">{</span><span class="num" id="8275604">0x2b</span><span class="op" id="8275608">,</span>&nbsp;<span class="num" id="8275610">0x7e</span><span class="op" id="8275614">,</span>&nbsp;<span class="num" id="8275616">0x15</span><span class="op" id="8275620">,</span>&nbsp;<span class="num" id="8275622">0x16</span><span class="op" id="8275626">,</span>&nbsp;<span class="num" id="8275628">0x28</span><span class="op" id="8275632">,</span>&nbsp;<span class="num" id="8275634">0xae</span><span class="op" id="8275638">,</span>&nbsp;<span class="num" id="8275640">0xd2</span><span class="op" id="8275644">,</span>&nbsp;<span class="num" id="8275646">0xa6</span><span class="op" id="8275650">,</span>&nbsp;<span class="num" id="8275652">0xab</span><span class="op" id="8275656">,</span>&nbsp;<span class="num" id="8275658">0xf7</span><span class="op" id="8275662">,</span>&nbsp;<span class="num" id="8275664">0x15</span><span class="op" id="8275668">,</span>&nbsp;<span class="num" id="8275670">0x88</span><span class="op" id="8275674">,</span>&nbsp;<span class="num" id="8275676">0x09</span><span class="op" id="8275680">,</span>&nbsp;<span class="num" id="8275682">0xcf</span><span class="op" id="8275686">,</span>&nbsp;<span class="num" id="8275688">0x4f</span><span class="op" id="8275692">,</span>&nbsp;<span class="num" id="8275694">0x3c</span><span class="op" id="8275698">}</span><span class="op" id="8275699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275703">[</span><span class="op" id="8275704">]</span><span class="builtintype" id="8275705">byte</span><span class="op" id="8275709">{</span><span class="num" id="8275710">0x32</span><span class="op" id="8275714">,</span>&nbsp;<span class="num" id="8275716">0x43</span><span class="op" id="8275720">,</span>&nbsp;<span class="num" id="8275722">0xf6</span><span class="op" id="8275726">,</span>&nbsp;<span class="num" id="8275728">0xa8</span><span class="op" id="8275732">,</span>&nbsp;<span class="num" id="8275734">0x88</span><span class="op" id="8275738">,</span>&nbsp;<span class="num" id="8275740">0x5a</span><span class="op" id="8275744">,</span>&nbsp;<span class="num" id="8275746">0x30</span><span class="op" id="8275750">,</span>&nbsp;<span class="num" id="8275752">0x8d</span><span class="op" id="8275756">,</span>&nbsp;<span class="num" id="8275758">0x31</span><span class="op" id="8275762">,</span>&nbsp;<span class="num" id="8275764">0x31</span><span class="op" id="8275768">,</span>&nbsp;<span class="num" id="8275770">0x98</span><span class="op" id="8275774">,</span>&nbsp;<span class="num" id="8275776">0xa2</span><span class="op" id="8275780">,</span>&nbsp;<span class="num" id="8275782">0xe0</span><span class="op" id="8275786">,</span>&nbsp;<span class="num" id="8275788">0x37</span><span class="op" id="8275792">,</span>&nbsp;<span class="num" id="8275794">0x07</span><span class="op" id="8275798">,</span>&nbsp;<span class="num" id="8275800">0x34</span><span class="op" id="8275804">}</span><span class="op" id="8275805">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275809">[</span><span class="op" id="8275810">]</span><span class="builtintype" id="8275811">byte</span><span class="op" id="8275815">{</span><span class="num" id="8275816">0x39</span><span class="op" id="8275820">,</span>&nbsp;<span class="num" id="8275822">0x25</span><span class="op" id="8275826">,</span>&nbsp;<span class="num" id="8275828">0x84</span><span class="op" id="8275832">,</span>&nbsp;<span class="num" id="8275834">0x1d</span><span class="op" id="8275838">,</span>&nbsp;<span class="num" id="8275840">0x02</span><span class="op" id="8275844">,</span>&nbsp;<span class="num" id="8275846">0xdc</span><span class="op" id="8275850">,</span>&nbsp;<span class="num" id="8275852">0x09</span><span class="op" id="8275856">,</span>&nbsp;<span class="num" id="8275858">0xfb</span><span class="op" id="8275862">,</span>&nbsp;<span class="num" id="8275864">0xdc</span><span class="op" id="8275868">,</span>&nbsp;<span class="num" id="8275870">0x11</span><span class="op" id="8275874">,</span>&nbsp;<span class="num" id="8275876">0x85</span><span class="op" id="8275880">,</span>&nbsp;<span class="num" id="8275882">0x97</span><span class="op" id="8275886">,</span>&nbsp;<span class="num" id="8275888">0x19</span><span class="op" id="8275892">,</span>&nbsp;<span class="num" id="8275894">0x6a</span><span class="op" id="8275898">,</span>&nbsp;<span class="num" id="8275900">0x0b</span><span class="op" id="8275904">,</span>&nbsp;<span class="num" id="8275906">0x32</span><span class="op" id="8275910">}</span><span class="op" id="8275911">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275914">}</span><span class="op" id="8275915">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275918">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8275922">//&nbsp;Appendix&nbsp;C.1.&nbsp;&nbsp;AES-128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275950">[</span><span class="op" id="8275951">]</span><span class="builtintype" id="8275952">byte</span><span class="op" id="8275956">{</span><span class="num" id="8275957">0x00</span><span class="op" id="8275961">,</span>&nbsp;<span class="num" id="8275963">0x01</span><span class="op" id="8275967">,</span>&nbsp;<span class="num" id="8275969">0x02</span><span class="op" id="8275973">,</span>&nbsp;<span class="num" id="8275975">0x03</span><span class="op" id="8275979">,</span>&nbsp;<span class="num" id="8275981">0x04</span><span class="op" id="8275985">,</span>&nbsp;<span class="num" id="8275987">0x05</span><span class="op" id="8275991">,</span>&nbsp;<span class="num" id="8275993">0x06</span><span class="op" id="8275997">,</span>&nbsp;<span class="num" id="8275999">0x07</span><span class="op" id="8276003">,</span>&nbsp;<span class="num" id="8276005">0x08</span><span class="op" id="8276009">,</span>&nbsp;<span class="num" id="8276011">0x09</span><span class="op" id="8276015">,</span>&nbsp;<span class="num" id="8276017">0x0a</span><span class="op" id="8276021">,</span>&nbsp;<span class="num" id="8276023">0x0b</span><span class="op" id="8276027">,</span>&nbsp;<span class="num" id="8276029">0x0c</span><span class="op" id="8276033">,</span>&nbsp;<span class="num" id="8276035">0x0d</span><span class="op" id="8276039">,</span>&nbsp;<span class="num" id="8276041">0x0e</span><span class="op" id="8276045">,</span>&nbsp;<span class="num" id="8276047">0x0f</span><span class="op" id="8276051">}</span><span class="op" id="8276052">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276056">[</span><span class="op" id="8276057">]</span><span class="builtintype" id="8276058">byte</span><span class="op" id="8276062">{</span><span class="num" id="8276063">0x00</span><span class="op" id="8276067">,</span>&nbsp;<span class="num" id="8276069">0x11</span><span class="op" id="8276073">,</span>&nbsp;<span class="num" id="8276075">0x22</span><span class="op" id="8276079">,</span>&nbsp;<span class="num" id="8276081">0x33</span><span class="op" id="8276085">,</span>&nbsp;<span class="num" id="8276087">0x44</span><span class="op" id="8276091">,</span>&nbsp;<span class="num" id="8276093">0x55</span><span class="op" id="8276097">,</span>&nbsp;<span class="num" id="8276099">0x66</span><span class="op" id="8276103">,</span>&nbsp;<span class="num" id="8276105">0x77</span><span class="op" id="8276109">,</span>&nbsp;<span class="num" id="8276111">0x88</span><span class="op" id="8276115">,</span>&nbsp;<span class="num" id="8276117">0x99</span><span class="op" id="8276121">,</span>&nbsp;<span class="num" id="8276123">0xaa</span><span class="op" id="8276127">,</span>&nbsp;<span class="num" id="8276129">0xbb</span><span class="op" id="8276133">,</span>&nbsp;<span class="num" id="8276135">0xcc</span><span class="op" id="8276139">,</span>&nbsp;<span class="num" id="8276141">0xdd</span><span class="op" id="8276145">,</span>&nbsp;<span class="num" id="8276147">0xee</span><span class="op" id="8276151">,</span>&nbsp;<span class="num" id="8276153">0xff</span><span class="op" id="8276157">}</span><span class="op" id="8276158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276162">[</span><span class="op" id="8276163">]</span><span class="builtintype" id="8276164">byte</span><span class="op" id="8276168">{</span><span class="num" id="8276169">0x69</span><span class="op" id="8276173">,</span>&nbsp;<span class="num" id="8276175">0xc4</span><span class="op" id="8276179">,</span>&nbsp;<span class="num" id="8276181">0xe0</span><span class="op" id="8276185">,</span>&nbsp;<span class="num" id="8276187">0xd8</span><span class="op" id="8276191">,</span>&nbsp;<span class="num" id="8276193">0x6a</span><span class="op" id="8276197">,</span>&nbsp;<span class="num" id="8276199">0x7b</span><span class="op" id="8276203">,</span>&nbsp;<span class="num" id="8276205">0x04</span><span class="op" id="8276209">,</span>&nbsp;<span class="num" id="8276211">0x30</span><span class="op" id="8276215">,</span>&nbsp;<span class="num" id="8276217">0xd8</span><span class="op" id="8276221">,</span>&nbsp;<span class="num" id="8276223">0xcd</span><span class="op" id="8276227">,</span>&nbsp;<span class="num" id="8276229">0xb7</span><span class="op" id="8276233">,</span>&nbsp;<span class="num" id="8276235">0x80</span><span class="op" id="8276239">,</span>&nbsp;<span class="num" id="8276241">0x70</span><span class="op" id="8276245">,</span>&nbsp;<span class="num" id="8276247">0xb4</span><span class="op" id="8276251">,</span>&nbsp;<span class="num" id="8276253">0xc5</span><span class="op" id="8276257">,</span>&nbsp;<span class="num" id="8276259">0x5a</span><span class="op" id="8276263">}</span><span class="op" id="8276264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276267">}</span><span class="op" id="8276268">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8276275">//&nbsp;Appendix&nbsp;C.2.&nbsp;&nbsp;AES-192</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276303">[</span><span class="op" id="8276304">]</span><span class="builtintype" id="8276305">byte</span><span class="op" id="8276309">{</span><span class="num" id="8276310">0x00</span><span class="op" id="8276314">,</span>&nbsp;<span class="num" id="8276316">0x01</span><span class="op" id="8276320">,</span>&nbsp;<span class="num" id="8276322">0x02</span><span class="op" id="8276326">,</span>&nbsp;<span class="num" id="8276328">0x03</span><span class="op" id="8276332">,</span>&nbsp;<span class="num" id="8276334">0x04</span><span class="op" id="8276338">,</span>&nbsp;<span class="num" id="8276340">0x05</span><span class="op" id="8276344">,</span>&nbsp;<span class="num" id="8276346">0x06</span><span class="op" id="8276350">,</span>&nbsp;<span class="num" id="8276352">0x07</span><span class="op" id="8276356">,</span>&nbsp;<span class="num" id="8276358">0x08</span><span class="op" id="8276362">,</span>&nbsp;<span class="num" id="8276364">0x09</span><span class="op" id="8276368">,</span>&nbsp;<span class="num" id="8276370">0x0a</span><span class="op" id="8276374">,</span>&nbsp;<span class="num" id="8276376">0x0b</span><span class="op" id="8276380">,</span>&nbsp;<span class="num" id="8276382">0x0c</span><span class="op" id="8276386">,</span>&nbsp;<span class="num" id="8276388">0x0d</span><span class="op" id="8276392">,</span>&nbsp;<span class="num" id="8276394">0x0e</span><span class="op" id="8276398">,</span>&nbsp;<span class="num" id="8276400">0x0f</span><span class="op" id="8276404">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8276409">0x10</span><span class="op" id="8276413">,</span>&nbsp;<span class="num" id="8276415">0x11</span><span class="op" id="8276419">,</span>&nbsp;<span class="num" id="8276421">0x12</span><span class="op" id="8276425">,</span>&nbsp;<span class="num" id="8276427">0x13</span><span class="op" id="8276431">,</span>&nbsp;<span class="num" id="8276433">0x14</span><span class="op" id="8276437">,</span>&nbsp;<span class="num" id="8276439">0x15</span><span class="op" id="8276443">,</span>&nbsp;<span class="num" id="8276445">0x16</span><span class="op" id="8276449">,</span>&nbsp;<span class="num" id="8276451">0x17</span><span class="op" id="8276455">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276459">}</span><span class="op" id="8276460">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276464">[</span><span class="op" id="8276465">]</span><span class="builtintype" id="8276466">byte</span><span class="op" id="8276470">{</span><span class="num" id="8276471">0x00</span><span class="op" id="8276475">,</span>&nbsp;<span class="num" id="8276477">0x11</span><span class="op" id="8276481">,</span>&nbsp;<span class="num" id="8276483">0x22</span><span class="op" id="8276487">,</span>&nbsp;<span class="num" id="8276489">0x33</span><span class="op" id="8276493">,</span>&nbsp;<span class="num" id="8276495">0x44</span><span class="op" id="8276499">,</span>&nbsp;<span class="num" id="8276501">0x55</span><span class="op" id="8276505">,</span>&nbsp;<span class="num" id="8276507">0x66</span><span class="op" id="8276511">,</span>&nbsp;<span class="num" id="8276513">0x77</span><span class="op" id="8276517">,</span>&nbsp;<span class="num" id="8276519">0x88</span><span class="op" id="8276523">,</span>&nbsp;<span class="num" id="8276525">0x99</span><span class="op" id="8276529">,</span>&nbsp;<span class="num" id="8276531">0xaa</span><span class="op" id="8276535">,</span>&nbsp;<span class="num" id="8276537">0xbb</span><span class="op" id="8276541">,</span>&nbsp;<span class="num" id="8276543">0xcc</span><span class="op" id="8276547">,</span>&nbsp;<span class="num" id="8276549">0xdd</span><span class="op" id="8276553">,</span>&nbsp;<span class="num" id="8276555">0xee</span><span class="op" id="8276559">,</span>&nbsp;<span class="num" id="8276561">0xff</span><span class="op" id="8276565">}</span><span class="op" id="8276566">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276570">[</span><span class="op" id="8276571">]</span><span class="builtintype" id="8276572">byte</span><span class="op" id="8276576">{</span><span class="num" id="8276577">0xdd</span><span class="op" id="8276581">,</span>&nbsp;<span class="num" id="8276583">0xa9</span><span class="op" id="8276587">,</span>&nbsp;<span class="num" id="8276589">0x7c</span><span class="op" id="8276593">,</span>&nbsp;<span class="num" id="8276595">0xa4</span><span class="op" id="8276599">,</span>&nbsp;<span class="num" id="8276601">0x86</span><span class="op" id="8276605">,</span>&nbsp;<span class="num" id="8276607">0x4c</span><span class="op" id="8276611">,</span>&nbsp;<span class="num" id="8276613">0xdf</span><span class="op" id="8276617">,</span>&nbsp;<span class="num" id="8276619">0xe0</span><span class="op" id="8276623">,</span>&nbsp;<span class="num" id="8276625">0x6e</span><span class="op" id="8276629">,</span>&nbsp;<span class="num" id="8276631">0xaf</span><span class="op" id="8276635">,</span>&nbsp;<span class="num" id="8276637">0x70</span><span class="op" id="8276641">,</span>&nbsp;<span class="num" id="8276643">0xa0</span><span class="op" id="8276647">,</span>&nbsp;<span class="num" id="8276649">0xec</span><span class="op" id="8276653">,</span>&nbsp;<span class="num" id="8276655">0x0d</span><span class="op" id="8276659">,</span>&nbsp;<span class="num" id="8276661">0x71</span><span class="op" id="8276665">,</span>&nbsp;<span class="num" id="8276667">0x91</span><span class="op" id="8276671">}</span><span class="op" id="8276672">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276675">}</span><span class="op" id="8276676">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8276683">//&nbsp;Appendix&nbsp;C.3.&nbsp;&nbsp;AES-256</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276711">[</span><span class="op" id="8276712">]</span><span class="builtintype" id="8276713">byte</span><span class="op" id="8276717">{</span><span class="num" id="8276718">0x00</span><span class="op" id="8276722">,</span>&nbsp;<span class="num" id="8276724">0x01</span><span class="op" id="8276728">,</span>&nbsp;<span class="num" id="8276730">0x02</span><span class="op" id="8276734">,</span>&nbsp;<span class="num" id="8276736">0x03</span><span class="op" id="8276740">,</span>&nbsp;<span class="num" id="8276742">0x04</span><span class="op" id="8276746">,</span>&nbsp;<span class="num" id="8276748">0x05</span><span class="op" id="8276752">,</span>&nbsp;<span class="num" id="8276754">0x06</span><span class="op" id="8276758">,</span>&nbsp;<span class="num" id="8276760">0x07</span><span class="op" id="8276764">,</span>&nbsp;<span class="num" id="8276766">0x08</span><span class="op" id="8276770">,</span>&nbsp;<span class="num" id="8276772">0x09</span><span class="op" id="8276776">,</span>&nbsp;<span class="num" id="8276778">0x0a</span><span class="op" id="8276782">,</span>&nbsp;<span class="num" id="8276784">0x0b</span><span class="op" id="8276788">,</span>&nbsp;<span class="num" id="8276790">0x0c</span><span class="op" id="8276794">,</span>&nbsp;<span class="num" id="8276796">0x0d</span><span class="op" id="8276800">,</span>&nbsp;<span class="num" id="8276802">0x0e</span><span class="op" id="8276806">,</span>&nbsp;<span class="num" id="8276808">0x0f</span><span class="op" id="8276812">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8276817">0x10</span><span class="op" id="8276821">,</span>&nbsp;<span class="num" id="8276823">0x11</span><span class="op" id="8276827">,</span>&nbsp;<span class="num" id="8276829">0x12</span><span class="op" id="8276833">,</span>&nbsp;<span class="num" id="8276835">0x13</span><span class="op" id="8276839">,</span>&nbsp;<span class="num" id="8276841">0x14</span><span class="op" id="8276845">,</span>&nbsp;<span class="num" id="8276847">0x15</span><span class="op" id="8276851">,</span>&nbsp;<span class="num" id="8276853">0x16</span><span class="op" id="8276857">,</span>&nbsp;<span class="num" id="8276859">0x17</span><span class="op" id="8276863">,</span>&nbsp;<span class="num" id="8276865">0x18</span><span class="op" id="8276869">,</span>&nbsp;<span class="num" id="8276871">0x19</span><span class="op" id="8276875">,</span>&nbsp;<span class="num" id="8276877">0x1a</span><span class="op" id="8276881">,</span>&nbsp;<span class="num" id="8276883">0x1b</span><span class="op" id="8276887">,</span>&nbsp;<span class="num" id="8276889">0x1c</span><span class="op" id="8276893">,</span>&nbsp;<span class="num" id="8276895">0x1d</span><span class="op" id="8276899">,</span>&nbsp;<span class="num" id="8276901">0x1e</span><span class="op" id="8276905">,</span>&nbsp;<span class="num" id="8276907">0x1f</span><span class="op" id="8276911">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276915">}</span><span class="op" id="8276916">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276920">[</span><span class="op" id="8276921">]</span><span class="builtintype" id="8276922">byte</span><span class="op" id="8276926">{</span><span class="num" id="8276927">0x00</span><span class="op" id="8276931">,</span>&nbsp;<span class="num" id="8276933">0x11</span><span class="op" id="8276937">,</span>&nbsp;<span class="num" id="8276939">0x22</span><span class="op" id="8276943">,</span>&nbsp;<span class="num" id="8276945">0x33</span><span class="op" id="8276949">,</span>&nbsp;<span class="num" id="8276951">0x44</span><span class="op" id="8276955">,</span>&nbsp;<span class="num" id="8276957">0x55</span><span class="op" id="8276961">,</span>&nbsp;<span class="num" id="8276963">0x66</span><span class="op" id="8276967">,</span>&nbsp;<span class="num" id="8276969">0x77</span><span class="op" id="8276973">,</span>&nbsp;<span class="num" id="8276975">0x88</span><span class="op" id="8276979">,</span>&nbsp;<span class="num" id="8276981">0x99</span><span class="op" id="8276985">,</span>&nbsp;<span class="num" id="8276987">0xaa</span><span class="op" id="8276991">,</span>&nbsp;<span class="num" id="8276993">0xbb</span><span class="op" id="8276997">,</span>&nbsp;<span class="num" id="8276999">0xcc</span><span class="op" id="8277003">,</span>&nbsp;<span class="num" id="8277005">0xdd</span><span class="op" id="8277009">,</span>&nbsp;<span class="num" id="8277011">0xee</span><span class="op" id="8277015">,</span>&nbsp;<span class="num" id="8277017">0xff</span><span class="op" id="8277021">}</span><span class="op" id="8277022">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8277026">[</span><span class="op" id="8277027">]</span><span class="builtintype" id="8277028">byte</span><span class="op" id="8277032">{</span><span class="num" id="8277033">0x8e</span><span class="op" id="8277037">,</span>&nbsp;<span class="num" id="8277039">0xa2</span><span class="op" id="8277043">,</span>&nbsp;<span class="num" id="8277045">0xb7</span><span class="op" id="8277049">,</span>&nbsp;<span class="num" id="8277051">0xca</span><span class="op" id="8277055">,</span>&nbsp;<span class="num" id="8277057">0x51</span><span class="op" id="8277061">,</span>&nbsp;<span class="num" id="8277063">0x67</span><span class="op" id="8277067">,</span>&nbsp;<span class="num" id="8277069">0x45</span><span class="op" id="8277073">,</span>&nbsp;<span class="num" id="8277075">0xbf</span><span class="op" id="8277079">,</span>&nbsp;<span class="num" id="8277081">0xea</span><span class="op" id="8277085">,</span>&nbsp;<span class="num" id="8277087">0xfc</span><span class="op" id="8277091">,</span>&nbsp;<span class="num" id="8277093">0x49</span><span class="op" id="8277097">,</span>&nbsp;<span class="num" id="8277099">0x90</span><span class="op" id="8277103">,</span>&nbsp;<span class="num" id="8277105">0x4b</span><span class="op" id="8277109">,</span>&nbsp;<span class="num" id="8277111">0x49</span><span class="op" id="8277115">,</span>&nbsp;<span class="num" id="8277117">0x60</span><span class="op" id="8277121">,</span>&nbsp;<span class="num" id="8277123">0x89</span><span class="op" id="8277127">}</span><span class="op" id="8277128">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8277131">}</span><span class="op" id="8277132">,</span><br>
<span class="lineno"></span><span class="op" id="8277134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8277137">//&nbsp;Test&nbsp;encryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="8277185">func</span>&nbsp;<span class="ident" id="8277190">TestEncryptBlock</span><span class="op" id="8277206">(</span><span class="ident" id="8277207">t</span>&nbsp;<span class="op" id="8277209">*</span><span class="ident" id="8277210">testing</span><span class="op" id="8277217">.</span><span class="ident" id="8277218">T</span><span class="op" id="8277219">)</span>&nbsp;<span class="op" id="8277221">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8277224">for</span>&nbsp;<span class="ident" id="8277228">i</span><span class="op" id="8277229">,</span>&nbsp;<span class="ident" id="8277231">tt</span>&nbsp;<span class="op" id="8277234">:=</span>&nbsp;<span class="keyword" id="8277237">range</span>&nbsp;<span class="ident" id="8277243">encryptTests</span>&nbsp;<span class="op" id="8277256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8277260">n</span>&nbsp;<span class="op" id="8277262">:=</span>&nbsp;<span class="builtinfunc" id="8277265">len</span><span class="op" id="8277268">(</span><span class="ident" id="8277269">tt</span><span class="op" id="8277271">.</span><span class="ident" id="8277272">key</span><span class="op" id="8277275">)</span>&nbsp;<span class="op" id="8277277">+</span>&nbsp;<span class="num" id="8277279">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8277284">enc</span>&nbsp;<span class="op" id="8277288">:=</span>&nbsp;<span class="builtinfunc" id="8277291">make</span><span class="op" id="8277295">(</span><span class="op" id="8277296">[</span><span class="op" id="8277297">]</span><span class="builtintype" id="8277298">uint32</span><span class="op" id="8277304">,</span>&nbsp;<span class="ident" id="8277306">n</span><span class="op" id="8277307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8277311">dec</span>&nbsp;<span class="op" id="8277315">:=</span>&nbsp;<span class="builtinfunc" id="8277318">make</span><span class="op" id="8277322">(</span><span class="op" id="8277323">[</span><span class="op" id="8277324">]</span><span class="builtintype" id="8277325">uint32</span><span class="op" id="8277331">,</span>&nbsp;<span class="ident" id="8277333">n</span><span class="op" id="8277334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8277338">expandKey</span><span class="op" id="8277347">(</span><span class="ident" id="8277348">tt</span><span class="op" id="8277350">.</span><span class="ident" id="8277351">key</span><span class="op" id="8277354">,</span>&nbsp;<span class="ident" id="8277356">enc</span><span class="op" id="8277359">,</span>&nbsp;<span class="ident" id="8277361">dec</span><span class="op" id="8277364">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8277368">out</span>&nbsp;<span class="op" id="8277372">:=</span>&nbsp;<span class="builtinfunc" id="8277375">make</span><span class="op" id="8277379">(</span><span class="op" id="8277380">[</span><span class="op" id="8277381">]</span><span class="builtintype" id="8277382">byte</span><span class="op" id="8277386">,</span>&nbsp;<span class="builtinfunc" id="8277388">len</span><span class="op" id="8277391">(</span><span class="ident" id="8277392">tt</span><span class="op" id="8277394">.</span><span class="ident" id="8277395">in</span><span class="op" id="8277397">)</span><span class="op" id="8277398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8277402">encryptBlock</span><span class="op" id="8277414">(</span><span class="ident" id="8277415">enc</span><span class="op" id="8277418">,</span>&nbsp;<span class="ident" id="8277420">out</span><span class="op" id="8277423">,</span>&nbsp;<span class="ident" id="8277425">tt</span><span class="op" id="8277427">.</span><span class="ident" id="8277428">in</span><span class="op" id="8277430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8277434">for</span>&nbsp;<span class="ident" id="8277438">j</span><span class="op" id="8277439">,</span>&nbsp;<span class="ident" id="8277441">v</span>&nbsp;<span class="op" id="8277443">:=</span>&nbsp;<span class="keyword" id="8277446">range</span>&nbsp;<span class="ident" id="8277452">out</span>&nbsp;<span class="op" id="8277456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8277461">if</span>&nbsp;<span class="ident" id="8277464">v</span>&nbsp;<span class="op" id="8277466">!=</span>&nbsp;<span class="ident" id="8277469">tt</span><span class="op" id="8277471">.</span><span class="ident" id="8277472">out</span><span class="op" id="8277475">[</span><span class="ident" id="8277476">j</span><span class="op" id="8277477">]</span>&nbsp;<span class="op" id="8277479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8277485">t</span><span class="op" id="8277486">.</span><span class="ident" id="8277487">Errorf</span><span class="op" id="8277493">(</span><span class="string" id="8277494">&#34;encryptBlock&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8277536">,</span>&nbsp;<span class="ident" id="8277538">i</span><span class="op" id="8277539">,</span>&nbsp;<span class="ident" id="8277541">j</span><span class="op" id="8277542">,</span>&nbsp;<span class="ident" id="8277544">v</span><span class="op" id="8277545">,</span>&nbsp;<span class="ident" id="8277547">tt</span><span class="op" id="8277549">.</span><span class="ident" id="8277550">out</span><span class="op" id="8277553">[</span><span class="ident" id="8277554">j</span><span class="op" id="8277555">]</span><span class="op" id="8277556">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8277562">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8277571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8277575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8277578">}</span><br>
<span class="lineno"></span><span class="op" id="8277580">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="8277583">//&nbsp;Test&nbsp;decryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="8277631">func</span>&nbsp;<span class="ident" id="8277636">TestDecryptBlock</span><span class="op" id="8277652">(</span><span class="ident" id="8277653">t</span>&nbsp;<span class="op" id="8277655">*</span><span class="ident" id="8277656">testing</span><span class="op" id="8277663">.</span><span class="ident" id="8277664">T</span><span class="op" id="8277665">)</span>&nbsp;<span class="op" id="8277667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8277670">for</span>&nbsp;<span class="ident" id="8277674">i</span><span class="op" id="8277675">,</span>&nbsp;<span class="ident" id="8277677">tt</span>&nbsp;<span class="op" id="8277680">:=</span>&nbsp;<span class="keyword" id="8277683">range</span>&nbsp;<span class="ident" id="8277689">encryptTests</span>&nbsp;<span class="op" id="8277702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8277706">n</span>&nbsp;<span class="op" id="8277708">:=</span>&nbsp;<span class="builtinfunc" id="8277711">len</span><span class="op" id="8277714">(</span><span class="ident" id="8277715">tt</span><span class="op" id="8277717">.</span><span class="ident" id="8277718">key</span><span class="op" id="8277721">)</span>&nbsp;<span class="op" id="8277723">+</span>&nbsp;<span class="num" id="8277725">28</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8277730">enc</span>&nbsp;<span class="op" id="8277734">:=</span>&nbsp;<span class="builtinfunc" id="8277737">make</span><span class="op" id="8277741">(</span><span class="op" id="8277742">[</span><span class="op" id="8277743">]</span><span class="builtintype" id="8277744">uint32</span><span class="op" id="8277750">,</span>&nbsp;<span class="ident" id="8277752">n</span><span class="op" id="8277753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8277757">dec</span>&nbsp;<span class="op" id="8277761">:=</span>&nbsp;<span class="builtinfunc" id="8277764">make</span><span class="op" id="8277768">(</span><span class="op" id="8277769">[</span><span class="op" id="8277770">]</span><span class="builtintype" id="8277771">uint32</span><span class="op" id="8277777">,</span>&nbsp;<span class="ident" id="8277779">n</span><span class="op" id="8277780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8277784">expandKey</span><span class="op" id="8277793">(</span><span class="ident" id="8277794">tt</span><span class="op" id="8277796">.</span><span class="ident" id="8277797">key</span><span class="op" id="8277800">,</span>&nbsp;<span class="ident" id="8277802">enc</span><span class="op" id="8277805">,</span>&nbsp;<span class="ident" id="8277807">dec</span><span class="op" id="8277810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8277814">plain</span>&nbsp;<span class="op" id="8277820">:=</span>&nbsp;<span class="builtinfunc" id="8277823">make</span><span class="op" id="8277827">(</span><span class="op" id="8277828">[</span><span class="op" id="8277829">]</span><span class="builtintype" id="8277830">byte</span><span class="op" id="8277834">,</span>&nbsp;<span class="builtinfunc" id="8277836">len</span><span class="op" id="8277839">(</span><span class="ident" id="8277840">tt</span><span class="op" id="8277842">.</span><span class="ident" id="8277843">in</span><span class="op" id="8277845">)</span><span class="op" id="8277846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8277850">decryptBlock</span><span class="op" id="8277862">(</span><span class="ident" id="8277863">dec</span><span class="op" id="8277866">,</span>&nbsp;<span class="ident" id="8277868">plain</span><span class="op" id="8277873">,</span>&nbsp;<span class="ident" id="8277875">tt</span><span class="op" id="8277877">.</span><span class="ident" id="8277878">out</span><span class="op" id="8277881">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8277885">for</span>&nbsp;<span class="ident" id="8277889">j</span><span class="op" id="8277890">,</span>&nbsp;<span class="ident" id="8277892">v</span>&nbsp;<span class="op" id="8277894">:=</span>&nbsp;<span class="keyword" id="8277897">range</span>&nbsp;<span class="ident" id="8277903">plain</span>&nbsp;<span class="op" id="8277909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8277914">if</span>&nbsp;<span class="ident" id="8277917">v</span>&nbsp;<span class="op" id="8277919">!=</span>&nbsp;<span class="ident" id="8277922">tt</span><span class="op" id="8277924">.</span><span class="ident" id="8277925">in</span><span class="op" id="8277927">[</span><span class="ident" id="8277928">j</span><span class="op" id="8277929">]</span>&nbsp;<span class="op" id="8277931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8277937">t</span><span class="op" id="8277938">.</span><span class="ident" id="8277939">Errorf</span><span class="op" id="8277945">(</span><span class="string" id="8277946">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8277990">,</span>&nbsp;<span class="ident" id="8277992">i</span><span class="op" id="8277993">,</span>&nbsp;<span class="ident" id="8277995">j</span><span class="op" id="8277996">,</span>&nbsp;<span class="ident" id="8277998">v</span><span class="op" id="8277999">,</span>&nbsp;<span class="ident" id="8278001">tt</span><span class="op" id="8278003">.</span><span class="ident" id="8278004">in</span><span class="op" id="8278006">[</span><span class="ident" id="8278007">j</span><span class="op" id="8278008">]</span><span class="op" id="8278009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278015">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8278024">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8278028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8278031">}</span><br>
<span class="lineno"></span><span class="op" id="8278033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8278036">//&nbsp;Test&nbsp;Cipher&nbsp;Encrypt&nbsp;method&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno">320</span><span class="keyword" id="8278093">func</span>&nbsp;<span class="ident" id="8278098">TestCipherEncrypt</span><span class="op" id="8278115">(</span><span class="ident" id="8278116">t</span>&nbsp;<span class="op" id="8278118">*</span><span class="ident" id="8278119">testing</span><span class="op" id="8278126">.</span><span class="ident" id="8278127">T</span><span class="op" id="8278128">)</span>&nbsp;<span class="op" id="8278130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278133">for</span>&nbsp;<span class="ident" id="8278137">i</span><span class="op" id="8278138">,</span>&nbsp;<span class="ident" id="8278140">tt</span>&nbsp;<span class="op" id="8278143">:=</span>&nbsp;<span class="keyword" id="8278146">range</span>&nbsp;<span class="ident" id="8278152">encryptTests</span>&nbsp;<span class="op" id="8278165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8278169">c</span><span class="op" id="8278170">,</span>&nbsp;<span class="ident" id="8278172">err</span>&nbsp;<span class="op" id="8278176">:=</span>&nbsp;<span class="ident" id="8278179">NewCipher</span><span class="op" id="8278188">(</span><span class="ident" id="8278189">tt</span><span class="op" id="8278191">.</span><span class="ident" id="8278192">key</span><span class="op" id="8278195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278199">if</span>&nbsp;<span class="ident" id="8278202">err</span>&nbsp;<span class="op" id="8278206">!=</span>&nbsp;<span class="ident" id="8278209">nil</span>&nbsp;<span class="op" id="8278213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8278218">t</span><span class="op" id="8278219">.</span><span class="ident" id="8278220">Errorf</span><span class="op" id="8278226">(</span><span class="string" id="8278227">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="8278253">,</span>&nbsp;<span class="builtinfunc" id="8278255">len</span><span class="op" id="8278258">(</span><span class="ident" id="8278259">tt</span><span class="op" id="8278261">.</span><span class="ident" id="8278262">key</span><span class="op" id="8278265">)</span><span class="op" id="8278266">,</span>&nbsp;<span class="ident" id="8278268">err</span><span class="op" id="8278271">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278276">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8278287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8278291">out</span>&nbsp;<span class="op" id="8278295">:=</span>&nbsp;<span class="builtinfunc" id="8278298">make</span><span class="op" id="8278302">(</span><span class="op" id="8278303">[</span><span class="op" id="8278304">]</span><span class="builtintype" id="8278305">byte</span><span class="op" id="8278309">,</span>&nbsp;<span class="builtinfunc" id="8278311">len</span><span class="op" id="8278314">(</span><span class="ident" id="8278315">tt</span><span class="op" id="8278317">.</span><span class="ident" id="8278318">in</span><span class="op" id="8278320">)</span><span class="op" id="8278321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8278325">c</span><span class="op" id="8278326">.</span><span class="ident" id="8278327">Encrypt</span><span class="op" id="8278334">(</span><span class="ident" id="8278335">out</span><span class="op" id="8278338">,</span>&nbsp;<span class="ident" id="8278340">tt</span><span class="op" id="8278342">.</span><span class="ident" id="8278343">in</span><span class="op" id="8278345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278349">for</span>&nbsp;<span class="ident" id="8278353">j</span><span class="op" id="8278354">,</span>&nbsp;<span class="ident" id="8278356">v</span>&nbsp;<span class="op" id="8278358">:=</span>&nbsp;<span class="keyword" id="8278361">range</span>&nbsp;<span class="ident" id="8278367">out</span>&nbsp;<span class="op" id="8278371">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278376">if</span>&nbsp;<span class="ident" id="8278379">v</span>&nbsp;<span class="op" id="8278381">!=</span>&nbsp;<span class="ident" id="8278384">tt</span><span class="op" id="8278386">.</span><span class="ident" id="8278387">out</span><span class="op" id="8278390">[</span><span class="ident" id="8278391">j</span><span class="op" id="8278392">]</span>&nbsp;<span class="op" id="8278394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8278400">t</span><span class="op" id="8278401">.</span><span class="ident" id="8278402">Errorf</span><span class="op" id="8278408">(</span><span class="string" id="8278409">&#34;Cipher.Encrypt&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8278453">,</span>&nbsp;<span class="ident" id="8278455">i</span><span class="op" id="8278456">,</span>&nbsp;<span class="ident" id="8278458">j</span><span class="op" id="8278459">,</span>&nbsp;<span class="ident" id="8278461">v</span><span class="op" id="8278462">,</span>&nbsp;<span class="ident" id="8278464">tt</span><span class="op" id="8278466">.</span><span class="ident" id="8278467">out</span><span class="op" id="8278470">[</span><span class="ident" id="8278471">j</span><span class="op" id="8278472">]</span><span class="op" id="8278473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278479">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8278488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8278492">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8278495">}</span><br>
<span class="lineno"></span><span class="op" id="8278497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8278500">//&nbsp;Test&nbsp;Cipher&nbsp;Decrypt&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="8278550">func</span>&nbsp;<span class="ident" id="8278555">TestCipherDecrypt</span><span class="op" id="8278572">(</span><span class="ident" id="8278573">t</span>&nbsp;<span class="op" id="8278575">*</span><span class="ident" id="8278576">testing</span><span class="op" id="8278583">.</span><span class="ident" id="8278584">T</span><span class="op" id="8278585">)</span>&nbsp;<span class="op" id="8278587">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278590">for</span>&nbsp;<span class="ident" id="8278594">i</span><span class="op" id="8278595">,</span>&nbsp;<span class="ident" id="8278597">tt</span>&nbsp;<span class="op" id="8278600">:=</span>&nbsp;<span class="keyword" id="8278603">range</span>&nbsp;<span class="ident" id="8278609">encryptTests</span>&nbsp;<span class="op" id="8278622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8278626">c</span><span class="op" id="8278627">,</span>&nbsp;<span class="ident" id="8278629">err</span>&nbsp;<span class="op" id="8278633">:=</span>&nbsp;<span class="ident" id="8278636">NewCipher</span><span class="op" id="8278645">(</span><span class="ident" id="8278646">tt</span><span class="op" id="8278648">.</span><span class="ident" id="8278649">key</span><span class="op" id="8278652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278656">if</span>&nbsp;<span class="ident" id="8278659">err</span>&nbsp;<span class="op" id="8278663">!=</span>&nbsp;<span class="ident" id="8278666">nil</span>&nbsp;<span class="op" id="8278670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8278675">t</span><span class="op" id="8278676">.</span><span class="ident" id="8278677">Errorf</span><span class="op" id="8278683">(</span><span class="string" id="8278684">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="8278710">,</span>&nbsp;<span class="builtinfunc" id="8278712">len</span><span class="op" id="8278715">(</span><span class="ident" id="8278716">tt</span><span class="op" id="8278718">.</span><span class="ident" id="8278719">key</span><span class="op" id="8278722">)</span><span class="op" id="8278723">,</span>&nbsp;<span class="ident" id="8278725">err</span><span class="op" id="8278728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278733">continue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8278744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8278748">plain</span>&nbsp;<span class="op" id="8278754">:=</span>&nbsp;<span class="builtinfunc" id="8278757">make</span><span class="op" id="8278761">(</span><span class="op" id="8278762">[</span><span class="op" id="8278763">]</span><span class="builtintype" id="8278764">byte</span><span class="op" id="8278768">,</span>&nbsp;<span class="builtinfunc" id="8278770">len</span><span class="op" id="8278773">(</span><span class="ident" id="8278774">tt</span><span class="op" id="8278776">.</span><span class="ident" id="8278777">in</span><span class="op" id="8278779">)</span><span class="op" id="8278780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8278784">c</span><span class="op" id="8278785">.</span><span class="ident" id="8278786">Decrypt</span><span class="op" id="8278793">(</span><span class="ident" id="8278794">plain</span><span class="op" id="8278799">,</span>&nbsp;<span class="ident" id="8278801">tt</span><span class="op" id="8278803">.</span><span class="ident" id="8278804">out</span><span class="op" id="8278807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278811">for</span>&nbsp;<span class="ident" id="8278815">j</span><span class="op" id="8278816">,</span>&nbsp;<span class="ident" id="8278818">v</span>&nbsp;<span class="op" id="8278820">:=</span>&nbsp;<span class="keyword" id="8278823">range</span>&nbsp;<span class="ident" id="8278829">plain</span>&nbsp;<span class="op" id="8278835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278840">if</span>&nbsp;<span class="ident" id="8278843">v</span>&nbsp;<span class="op" id="8278845">!=</span>&nbsp;<span class="ident" id="8278848">tt</span><span class="op" id="8278850">.</span><span class="ident" id="8278851">in</span><span class="op" id="8278853">[</span><span class="ident" id="8278854">j</span><span class="op" id="8278855">]</span>&nbsp;<span class="op" id="8278857">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8278863">t</span><span class="op" id="8278864">.</span><span class="ident" id="8278865">Errorf</span><span class="op" id="8278871">(</span><span class="string" id="8278872">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8278916">,</span>&nbsp;<span class="ident" id="8278918">i</span><span class="op" id="8278919">,</span>&nbsp;<span class="ident" id="8278921">j</span><span class="op" id="8278922">,</span>&nbsp;<span class="ident" id="8278924">v</span><span class="op" id="8278925">,</span>&nbsp;<span class="ident" id="8278927">tt</span><span class="op" id="8278929">.</span><span class="ident" id="8278930">in</span><span class="op" id="8278932">[</span><span class="ident" id="8278933">j</span><span class="op" id="8278934">]</span><span class="op" id="8278935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278941">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8278950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8278954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8278957">}</span><br>
<span class="lineno">355</span><span class="op" id="8278959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8278962">//&nbsp;Test&nbsp;short&nbsp;input/output.</span><br>
<span class="lineno"></span><span class="comment" id="8278990">//&nbsp;Assembly&nbsp;used&nbsp;to&nbsp;not&nbsp;notice.</span><br>
<span class="lineno"></span><span class="comment" id="8279022">//&nbsp;See&nbsp;issue&nbsp;7928.</span><br>
<span class="lineno">360</span><span class="keyword" id="8279041">func</span>&nbsp;<span class="ident" id="8279046">TestShortBlocks</span><span class="op" id="8279061">(</span><span class="ident" id="8279062">t</span>&nbsp;<span class="op" id="8279064">*</span><span class="ident" id="8279065">testing</span><span class="op" id="8279072">.</span><span class="ident" id="8279073">T</span><span class="op" id="8279074">)</span>&nbsp;<span class="op" id="8279076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8279079">bytes</span>&nbsp;<span class="op" id="8279085">:=</span>&nbsp;<span class="keyword" id="8279088">func</span><span class="op" id="8279092">(</span><span class="ident" id="8279093">n</span>&nbsp;<span class="builtintype" id="8279095">int</span><span class="op" id="8279098">)</span>&nbsp;<span class="op" id="8279100">[</span><span class="op" id="8279101">]</span><span class="builtintype" id="8279102">byte</span>&nbsp;<span class="op" id="8279107">{</span>&nbsp;<span class="keyword" id="8279109">return</span>&nbsp;<span class="builtinfunc" id="8279116">make</span><span class="op" id="8279120">(</span><span class="op" id="8279121">[</span><span class="op" id="8279122">]</span><span class="builtintype" id="8279123">byte</span><span class="op" id="8279127">,</span>&nbsp;<span class="ident" id="8279129">n</span><span class="op" id="8279130">)</span>&nbsp;<span class="op" id="8279132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8279136">c</span><span class="op" id="8279137">,</span>&nbsp;<span class="ident" id="8279139">_</span>&nbsp;<span class="op" id="8279141">:=</span>&nbsp;<span class="ident" id="8279144">NewCipher</span><span class="op" id="8279153">(</span><span class="ident" id="8279154">bytes</span><span class="op" id="8279159">(</span><span class="num" id="8279160">16</span><span class="op" id="8279162">)</span><span class="op" id="8279163">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8279167">mustPanic</span><span class="op" id="8279176">(</span><span class="ident" id="8279177">t</span><span class="op" id="8279178">,</span>&nbsp;<span class="string" id="8279180">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="8279214">,</span>&nbsp;<span class="keyword" id="8279216">func</span><span class="op" id="8279220">(</span><span class="op" id="8279221">)</span>&nbsp;<span class="op" id="8279223">{</span>&nbsp;<span class="ident" id="8279225">c</span><span class="op" id="8279226">.</span><span class="ident" id="8279227">Encrypt</span><span class="op" id="8279234">(</span><span class="ident" id="8279235">bytes</span><span class="op" id="8279240">(</span><span class="num" id="8279241">1</span><span class="op" id="8279242">)</span><span class="op" id="8279243">,</span>&nbsp;<span class="ident" id="8279245">bytes</span><span class="op" id="8279250">(</span><span class="num" id="8279251">1</span><span class="op" id="8279252">)</span><span class="op" id="8279253">)</span>&nbsp;<span class="op" id="8279255">}</span><span class="op" id="8279256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8279259">mustPanic</span><span class="op" id="8279268">(</span><span class="ident" id="8279269">t</span><span class="op" id="8279270">,</span>&nbsp;<span class="string" id="8279272">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="8279306">,</span>&nbsp;<span class="keyword" id="8279308">func</span><span class="op" id="8279312">(</span><span class="op" id="8279313">)</span>&nbsp;<span class="op" id="8279315">{</span>&nbsp;<span class="ident" id="8279317">c</span><span class="op" id="8279318">.</span><span class="ident" id="8279319">Decrypt</span><span class="op" id="8279326">(</span><span class="ident" id="8279327">bytes</span><span class="op" id="8279332">(</span><span class="num" id="8279333">1</span><span class="op" id="8279334">)</span><span class="op" id="8279335">,</span>&nbsp;<span class="ident" id="8279337">bytes</span><span class="op" id="8279342">(</span><span class="num" id="8279343">1</span><span class="op" id="8279344">)</span><span class="op" id="8279345">)</span>&nbsp;<span class="op" id="8279347">}</span><span class="op" id="8279348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8279351">mustPanic</span><span class="op" id="8279360">(</span><span class="ident" id="8279361">t</span><span class="op" id="8279362">,</span>&nbsp;<span class="string" id="8279364">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="8279398">,</span>&nbsp;<span class="keyword" id="8279400">func</span><span class="op" id="8279404">(</span><span class="op" id="8279405">)</span>&nbsp;<span class="op" id="8279407">{</span>&nbsp;<span class="ident" id="8279409">c</span><span class="op" id="8279410">.</span><span class="ident" id="8279411">Encrypt</span><span class="op" id="8279418">(</span><span class="ident" id="8279419">bytes</span><span class="op" id="8279424">(</span><span class="num" id="8279425">100</span><span class="op" id="8279428">)</span><span class="op" id="8279429">,</span>&nbsp;<span class="ident" id="8279431">bytes</span><span class="op" id="8279436">(</span><span class="num" id="8279437">1</span><span class="op" id="8279438">)</span><span class="op" id="8279439">)</span>&nbsp;<span class="op" id="8279441">}</span><span class="op" id="8279442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8279445">mustPanic</span><span class="op" id="8279454">(</span><span class="ident" id="8279455">t</span><span class="op" id="8279456">,</span>&nbsp;<span class="string" id="8279458">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="8279492">,</span>&nbsp;<span class="keyword" id="8279494">func</span><span class="op" id="8279498">(</span><span class="op" id="8279499">)</span>&nbsp;<span class="op" id="8279501">{</span>&nbsp;<span class="ident" id="8279503">c</span><span class="op" id="8279504">.</span><span class="ident" id="8279505">Decrypt</span><span class="op" id="8279512">(</span><span class="ident" id="8279513">bytes</span><span class="op" id="8279518">(</span><span class="num" id="8279519">100</span><span class="op" id="8279522">)</span><span class="op" id="8279523">,</span>&nbsp;<span class="ident" id="8279525">bytes</span><span class="op" id="8279530">(</span><span class="num" id="8279531">1</span><span class="op" id="8279532">)</span><span class="op" id="8279533">)</span>&nbsp;<span class="op" id="8279535">}</span><span class="op" id="8279536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8279539">mustPanic</span><span class="op" id="8279548">(</span><span class="ident" id="8279549">t</span><span class="op" id="8279550">,</span>&nbsp;<span class="string" id="8279552">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="8279587">,</span>&nbsp;<span class="keyword" id="8279589">func</span><span class="op" id="8279593">(</span><span class="op" id="8279594">)</span>&nbsp;<span class="op" id="8279596">{</span>&nbsp;<span class="ident" id="8279598">c</span><span class="op" id="8279599">.</span><span class="ident" id="8279600">Encrypt</span><span class="op" id="8279607">(</span><span class="ident" id="8279608">bytes</span><span class="op" id="8279613">(</span><span class="num" id="8279614">1</span><span class="op" id="8279615">)</span><span class="op" id="8279616">,</span>&nbsp;<span class="ident" id="8279618">bytes</span><span class="op" id="8279623">(</span><span class="num" id="8279624">100</span><span class="op" id="8279627">)</span><span class="op" id="8279628">)</span>&nbsp;<span class="op" id="8279630">}</span><span class="op" id="8279631">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8279634">mustPanic</span><span class="op" id="8279643">(</span><span class="ident" id="8279644">t</span><span class="op" id="8279645">,</span>&nbsp;<span class="string" id="8279647">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="8279682">,</span>&nbsp;<span class="keyword" id="8279684">func</span><span class="op" id="8279688">(</span><span class="op" id="8279689">)</span>&nbsp;<span class="op" id="8279691">{</span>&nbsp;<span class="ident" id="8279693">c</span><span class="op" id="8279694">.</span><span class="ident" id="8279695">Decrypt</span><span class="op" id="8279702">(</span><span class="ident" id="8279703">bytes</span><span class="op" id="8279708">(</span><span class="num" id="8279709">1</span><span class="op" id="8279710">)</span><span class="op" id="8279711">,</span>&nbsp;<span class="ident" id="8279713">bytes</span><span class="op" id="8279718">(</span><span class="num" id="8279719">100</span><span class="op" id="8279722">)</span><span class="op" id="8279723">)</span>&nbsp;<span class="op" id="8279725">}</span><span class="op" id="8279726">)</span><br>
<span class="lineno"></span><span class="op" id="8279728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8279731">func</span>&nbsp;<span class="ident" id="8279736">mustPanic</span><span class="op" id="8279745">(</span><span class="ident" id="8279746">t</span>&nbsp;<span class="op" id="8279748">*</span><span class="ident" id="8279749">testing</span><span class="op" id="8279756">.</span><span class="ident" id="8279757">T</span><span class="op" id="8279758">,</span>&nbsp;<span class="ident" id="8279760">msg</span>&nbsp;<span class="builtintype" id="8279764">string</span><span class="op" id="8279770">,</span>&nbsp;<span class="ident" id="8279772">f</span>&nbsp;<span class="keyword" id="8279774">func</span><span class="op" id="8279778">(</span><span class="op" id="8279779">)</span><span class="op" id="8279780">)</span>&nbsp;<span class="op" id="8279782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8279785">defer</span>&nbsp;<span class="keyword" id="8279791">func</span><span class="op" id="8279795">(</span><span class="op" id="8279796">)</span>&nbsp;<span class="op" id="8279798">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8279802">err</span>&nbsp;<span class="op" id="8279806">:=</span>&nbsp;<span class="builtinfunc" id="8279809">recover</span><span class="op" id="8279816">(</span><span class="op" id="8279817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8279821">if</span>&nbsp;<span class="ident" id="8279824">err</span>&nbsp;<span class="op" id="8279828">==</span>&nbsp;<span class="ident" id="8279831">nil</span>&nbsp;<span class="op" id="8279835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8279840">t</span><span class="op" id="8279841">.</span><span class="ident" id="8279842">Errorf</span><span class="op" id="8279848">(</span><span class="string" id="8279849">&#34;function&nbsp;did&nbsp;not&nbsp;panic,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="8279884">,</span>&nbsp;<span class="ident" id="8279886">msg</span><span class="op" id="8279889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8279893">}</span>&nbsp;<span class="keyword" id="8279895">else</span>&nbsp;<span class="keyword" id="8279900">if</span>&nbsp;<span class="ident" id="8279903">err</span>&nbsp;<span class="op" id="8279907">!=</span>&nbsp;<span class="ident" id="8279910">msg</span>&nbsp;<span class="op" id="8279914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8279919">t</span><span class="op" id="8279920">.</span><span class="ident" id="8279921">Errorf</span><span class="op" id="8279927">(</span><span class="string" id="8279928">&#34;got&nbsp;panic&nbsp;%v,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="8279953">,</span>&nbsp;<span class="ident" id="8279955">err</span><span class="op" id="8279958">,</span>&nbsp;<span class="ident" id="8279960">msg</span><span class="op" id="8279963">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8279967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8279970">}</span><span class="op" id="8279971">(</span><span class="op" id="8279972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8279975">f</span><span class="op" id="8279976">(</span><span class="op" id="8279977">)</span><br>
<span class="lineno"></span><span class="op" id="8279979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="8279982">func</span>&nbsp;<span class="ident" id="8279987">BenchmarkEncrypt</span><span class="op" id="8280003">(</span><span class="ident" id="8280004">b</span>&nbsp;<span class="op" id="8280006">*</span><span class="ident" id="8280007">testing</span><span class="op" id="8280014">.</span><span class="ident" id="8280015">B</span><span class="op" id="8280016">)</span>&nbsp;<span class="op" id="8280018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280021">tt</span>&nbsp;<span class="op" id="8280024">:=</span>&nbsp;<span class="ident" id="8280027">encryptTests</span><span class="op" id="8280039">[</span><span class="num" id="8280040">0</span><span class="op" id="8280041">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280044">c</span><span class="op" id="8280045">,</span>&nbsp;<span class="ident" id="8280047">err</span>&nbsp;<span class="op" id="8280051">:=</span>&nbsp;<span class="ident" id="8280054">NewCipher</span><span class="op" id="8280063">(</span><span class="ident" id="8280064">tt</span><span class="op" id="8280066">.</span><span class="ident" id="8280067">key</span><span class="op" id="8280070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8280073">if</span>&nbsp;<span class="ident" id="8280076">err</span>&nbsp;<span class="op" id="8280080">!=</span>&nbsp;<span class="ident" id="8280083">nil</span>&nbsp;<span class="op" id="8280087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280091">b</span><span class="op" id="8280092">.</span><span class="ident" id="8280093">Fatal</span><span class="op" id="8280098">(</span><span class="string" id="8280099">&#34;NewCipher:&#34;</span><span class="op" id="8280111">,</span>&nbsp;<span class="ident" id="8280113">err</span><span class="op" id="8280116">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8280119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280122">out</span>&nbsp;<span class="op" id="8280126">:=</span>&nbsp;<span class="builtinfunc" id="8280129">make</span><span class="op" id="8280133">(</span><span class="op" id="8280134">[</span><span class="op" id="8280135">]</span><span class="builtintype" id="8280136">byte</span><span class="op" id="8280140">,</span>&nbsp;<span class="builtinfunc" id="8280142">len</span><span class="op" id="8280145">(</span><span class="ident" id="8280146">tt</span><span class="op" id="8280148">.</span><span class="ident" id="8280149">in</span><span class="op" id="8280151">)</span><span class="op" id="8280152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280155">b</span><span class="op" id="8280156">.</span><span class="ident" id="8280157">SetBytes</span><span class="op" id="8280165">(</span><span class="ident" id="8280166">int64</span><span class="op" id="8280171">(</span><span class="builtinfunc" id="8280172">len</span><span class="op" id="8280175">(</span><span class="ident" id="8280176">out</span><span class="op" id="8280179">)</span><span class="op" id="8280180">)</span><span class="op" id="8280181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280184">b</span><span class="op" id="8280185">.</span><span class="ident" id="8280186">ResetTimer</span><span class="op" id="8280196">(</span><span class="op" id="8280197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8280200">for</span>&nbsp;<span class="ident" id="8280204">i</span>&nbsp;<span class="op" id="8280206">:=</span>&nbsp;<span class="num" id="8280209">0</span><span class="op" id="8280210">;</span>&nbsp;<span class="ident" id="8280212">i</span>&nbsp;<span class="op" id="8280214">&lt;</span>&nbsp;<span class="ident" id="8280216">b</span><span class="op" id="8280217">.</span><span class="ident" id="8280218">N</span><span class="op" id="8280219">;</span>&nbsp;<span class="ident" id="8280221">i</span><span class="op" id="8280222">++</span>&nbsp;<span class="op" id="8280225">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280229">c</span><span class="op" id="8280230">.</span><span class="ident" id="8280231">Encrypt</span><span class="op" id="8280238">(</span><span class="ident" id="8280239">out</span><span class="op" id="8280242">,</span>&nbsp;<span class="ident" id="8280244">tt</span><span class="op" id="8280246">.</span><span class="ident" id="8280247">in</span><span class="op" id="8280249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8280252">}</span><br>
<span class="lineno"></span><span class="op" id="8280254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8280257">func</span>&nbsp;<span class="ident" id="8280262">BenchmarkDecrypt</span><span class="op" id="8280278">(</span><span class="ident" id="8280279">b</span>&nbsp;<span class="op" id="8280281">*</span><span class="ident" id="8280282">testing</span><span class="op" id="8280289">.</span><span class="ident" id="8280290">B</span><span class="op" id="8280291">)</span>&nbsp;<span class="op" id="8280293">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280296">tt</span>&nbsp;<span class="op" id="8280299">:=</span>&nbsp;<span class="ident" id="8280302">encryptTests</span><span class="op" id="8280314">[</span><span class="num" id="8280315">0</span><span class="op" id="8280316">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280319">c</span><span class="op" id="8280320">,</span>&nbsp;<span class="ident" id="8280322">err</span>&nbsp;<span class="op" id="8280326">:=</span>&nbsp;<span class="ident" id="8280329">NewCipher</span><span class="op" id="8280338">(</span><span class="ident" id="8280339">tt</span><span class="op" id="8280341">.</span><span class="ident" id="8280342">key</span><span class="op" id="8280345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8280348">if</span>&nbsp;<span class="ident" id="8280351">err</span>&nbsp;<span class="op" id="8280355">!=</span>&nbsp;<span class="ident" id="8280358">nil</span>&nbsp;<span class="op" id="8280362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280366">b</span><span class="op" id="8280367">.</span><span class="ident" id="8280368">Fatal</span><span class="op" id="8280373">(</span><span class="string" id="8280374">&#34;NewCipher:&#34;</span><span class="op" id="8280386">,</span>&nbsp;<span class="ident" id="8280388">err</span><span class="op" id="8280391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8280394">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280397">out</span>&nbsp;<span class="op" id="8280401">:=</span>&nbsp;<span class="builtinfunc" id="8280404">make</span><span class="op" id="8280408">(</span><span class="op" id="8280409">[</span><span class="op" id="8280410">]</span><span class="builtintype" id="8280411">byte</span><span class="op" id="8280415">,</span>&nbsp;<span class="builtinfunc" id="8280417">len</span><span class="op" id="8280420">(</span><span class="ident" id="8280421">tt</span><span class="op" id="8280423">.</span><span class="ident" id="8280424">out</span><span class="op" id="8280427">)</span><span class="op" id="8280428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280431">b</span><span class="op" id="8280432">.</span><span class="ident" id="8280433">SetBytes</span><span class="op" id="8280441">(</span><span class="ident" id="8280442">int64</span><span class="op" id="8280447">(</span><span class="builtinfunc" id="8280448">len</span><span class="op" id="8280451">(</span><span class="ident" id="8280452">out</span><span class="op" id="8280455">)</span><span class="op" id="8280456">)</span><span class="op" id="8280457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280460">b</span><span class="op" id="8280461">.</span><span class="ident" id="8280462">ResetTimer</span><span class="op" id="8280472">(</span><span class="op" id="8280473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8280476">for</span>&nbsp;<span class="ident" id="8280480">i</span>&nbsp;<span class="op" id="8280482">:=</span>&nbsp;<span class="num" id="8280485">0</span><span class="op" id="8280486">;</span>&nbsp;<span class="ident" id="8280488">i</span>&nbsp;<span class="op" id="8280490">&lt;</span>&nbsp;<span class="ident" id="8280492">b</span><span class="op" id="8280493">.</span><span class="ident" id="8280494">N</span><span class="op" id="8280495">;</span>&nbsp;<span class="ident" id="8280497">i</span><span class="op" id="8280498">++</span>&nbsp;<span class="op" id="8280501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280505">c</span><span class="op" id="8280506">.</span><span class="ident" id="8280507">Decrypt</span><span class="op" id="8280514">(</span><span class="ident" id="8280515">out</span><span class="op" id="8280518">,</span>&nbsp;<span class="ident" id="8280520">tt</span><span class="op" id="8280522">.</span><span class="ident" id="8280523">out</span><span class="op" id="8280526">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8280529">}</span><br>
<span class="lineno"></span><span class="op" id="8280531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8280534">func</span>&nbsp;<span class="ident" id="8280539">BenchmarkExpand</span><span class="op" id="8280554">(</span><span class="ident" id="8280555">b</span>&nbsp;<span class="op" id="8280557">*</span><span class="ident" id="8280558">testing</span><span class="op" id="8280565">.</span><span class="ident" id="8280566">B</span><span class="op" id="8280567">)</span>&nbsp;<span class="op" id="8280569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280572">tt</span>&nbsp;<span class="op" id="8280575">:=</span>&nbsp;<span class="ident" id="8280578">encryptTests</span><span class="op" id="8280590">[</span><span class="num" id="8280591">0</span><span class="op" id="8280592">]</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280595">n</span>&nbsp;<span class="op" id="8280597">:=</span>&nbsp;<span class="builtinfunc" id="8280600">len</span><span class="op" id="8280603">(</span><span class="ident" id="8280604">tt</span><span class="op" id="8280606">.</span><span class="ident" id="8280607">key</span><span class="op" id="8280610">)</span>&nbsp;<span class="op" id="8280612">+</span>&nbsp;<span class="num" id="8280614">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280618">c</span>&nbsp;<span class="op" id="8280620">:=</span>&nbsp;<span class="op" id="8280623">&amp;</span><span class="ident" id="8280624">aesCipher</span><span class="op" id="8280633">{</span><span class="builtinfunc" id="8280634">make</span><span class="op" id="8280638">(</span><span class="op" id="8280639">[</span><span class="op" id="8280640">]</span><span class="builtintype" id="8280641">uint32</span><span class="op" id="8280647">,</span>&nbsp;<span class="ident" id="8280649">n</span><span class="op" id="8280650">)</span><span class="op" id="8280651">,</span>&nbsp;<span class="builtinfunc" id="8280653">make</span><span class="op" id="8280657">(</span><span class="op" id="8280658">[</span><span class="op" id="8280659">]</span><span class="builtintype" id="8280660">uint32</span><span class="op" id="8280666">,</span>&nbsp;<span class="ident" id="8280668">n</span><span class="op" id="8280669">)</span><span class="op" id="8280670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280673">b</span><span class="op" id="8280674">.</span><span class="ident" id="8280675">ResetTimer</span><span class="op" id="8280685">(</span><span class="op" id="8280686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8280689">for</span>&nbsp;<span class="ident" id="8280693">i</span>&nbsp;<span class="op" id="8280695">:=</span>&nbsp;<span class="num" id="8280698">0</span><span class="op" id="8280699">;</span>&nbsp;<span class="ident" id="8280701">i</span>&nbsp;<span class="op" id="8280703">&lt;</span>&nbsp;<span class="ident" id="8280705">b</span><span class="op" id="8280706">.</span><span class="ident" id="8280707">N</span><span class="op" id="8280708">;</span>&nbsp;<span class="ident" id="8280710">i</span><span class="op" id="8280711">++</span>&nbsp;<span class="op" id="8280714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280718">expandKey</span><span class="op" id="8280727">(</span><span class="ident" id="8280728">tt</span><span class="op" id="8280730">.</span><span class="ident" id="8280731">key</span><span class="op" id="8280734">,</span>&nbsp;<span class="ident" id="8280736">c</span><span class="op" id="8280737">.</span><span class="ident" id="8280738">enc</span><span class="op" id="8280741">,</span>&nbsp;<span class="ident" id="8280743">c</span><span class="op" id="8280744">.</span><span class="ident" id="8280745">dec</span><span class="op" id="8280748">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8280751">}</span><br>
<span class="lineno"></span><span class="op" id="8280753">}</span>
</div>
</body>
</html>
