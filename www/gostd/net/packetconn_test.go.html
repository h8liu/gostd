<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6665125">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6665181">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6665235">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6665286">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;API&nbsp;tests&nbsp;across&nbsp;platforms&nbsp;and&nbsp;will&nbsp;never&nbsp;have&nbsp;a&nbsp;build</span><br>
<span class="lineno"></span><span class="comment" id="6665365">//&nbsp;tag.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6665374">package</span>&nbsp;<span class="ident" id="6665382">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="6665387">import</span>&nbsp;<span class="op" id="6665394">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6665397">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6665403">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6665414">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6665425">&#34;testing&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6665436">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6665443">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6665446">func</span>&nbsp;<span class="ident" id="6665451">packetConnTestData</span><span class="op" id="6665469">(</span><span class="ident" id="6665470">t</span>&nbsp;<span class="op" id="6665472">*</span><span class="ident" id="6665473">testing</span><span class="op" id="6665480">.</span><span class="ident" id="6665481">T</span><span class="op" id="6665482">,</span>&nbsp;<span class="ident" id="6665484">net</span>&nbsp;<span class="builtintype" id="6665488">string</span><span class="op" id="6665494">,</span>&nbsp;<span class="ident" id="6665496">i</span>&nbsp;<span class="builtintype" id="6665498">int</span><span class="op" id="6665501">)</span>&nbsp;<span class="op" id="6665503">(</span><span class="op" id="6665504">[</span><span class="op" id="6665505">]</span><span class="builtintype" id="6665506">byte</span><span class="op" id="6665510">,</span>&nbsp;<span class="keyword" id="6665512">func</span><span class="op" id="6665516">(</span><span class="op" id="6665517">)</span><span class="op" id="6665518">)</span>&nbsp;<span class="op" id="6665520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6665523">switch</span>&nbsp;<span class="ident" id="6665530">net</span>&nbsp;<span class="op" id="6665534">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6665537">case</span>&nbsp;<span class="string" id="6665542">&#34;udp&#34;</span><span class="op" id="6665547">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6665551">return</span>&nbsp;<span class="op" id="6665558">[</span><span class="op" id="6665559">]</span><span class="builtintype" id="6665560">byte</span><span class="op" id="6665564">(</span><span class="string" id="6665565">&#34;UDP&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="6665586">)</span><span class="op" id="6665587">,</span>&nbsp;<span class="ident" id="6665589">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6665594">case</span>&nbsp;<span class="string" id="6665599">&#34;ip&#34;</span><span class="op" id="6665603">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6665607">if</span>&nbsp;<span class="ident" id="6665610">skip</span><span class="op" id="6665614">,</span>&nbsp;<span class="ident" id="6665616">skipmsg</span>&nbsp;<span class="op" id="6665624">:=</span>&nbsp;<span class="ident" id="6665627">skipRawSocketTest</span><span class="op" id="6665644">(</span><span class="ident" id="6665645">t</span><span class="op" id="6665646">)</span><span class="op" id="6665647">;</span>&nbsp;<span class="ident" id="6665649">skip</span>&nbsp;<span class="op" id="6665654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6665659">return</span>&nbsp;<span class="ident" id="6665666">nil</span><span class="op" id="6665669">,</span>&nbsp;<span class="keyword" id="6665671">func</span><span class="op" id="6665675">(</span><span class="op" id="6665676">)</span>&nbsp;<span class="op" id="6665678">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665684">t</span><span class="op" id="6665685">.</span><span class="ident" id="6665686">Logf</span><span class="op" id="6665690">(</span><span class="ident" id="6665691">skipmsg</span><span class="op" id="6665698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6665703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6665707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665711">b</span><span class="op" id="6665712">,</span>&nbsp;<span class="ident" id="6665714">err</span>&nbsp;<span class="op" id="6665718">:=</span>&nbsp;<span class="op" id="6665721">(</span><span class="op" id="6665722">&amp;</span><span class="ident" id="6665723">icmpMessage</span><span class="op" id="6665734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665739">Type</span><span class="op" id="6665743">:</span>&nbsp;<span class="ident" id="6665745">icmpv4EchoRequest</span><span class="op" id="6665762">,</span>&nbsp;<span class="ident" id="6665764">Code</span><span class="op" id="6665768">:</span>&nbsp;<span class="num" id="6665770">0</span><span class="op" id="6665771">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665776">Body</span><span class="op" id="6665780">:</span>&nbsp;<span class="op" id="6665782">&amp;</span><span class="ident" id="6665783">icmpEcho</span><span class="op" id="6665791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665797">ID</span><span class="op" id="6665799">:</span>&nbsp;<span class="ident" id="6665801">os</span><span class="op" id="6665803">.</span><span class="ident" id="6665804">Getpid</span><span class="op" id="6665810">(</span><span class="op" id="6665811">)</span>&nbsp;<span class="op" id="6665813">&amp;</span>&nbsp;<span class="num" id="6665815">0xffff</span><span class="op" id="6665821">,</span>&nbsp;<span class="ident" id="6665823">Seq</span><span class="op" id="6665826">:</span>&nbsp;<span class="ident" id="6665828">i</span>&nbsp;<span class="op" id="6665830">+</span>&nbsp;<span class="num" id="6665832">1</span><span class="op" id="6665833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665839">Data</span><span class="op" id="6665843">:</span>&nbsp;<span class="op" id="6665845">[</span><span class="op" id="6665846">]</span><span class="builtintype" id="6665847">byte</span><span class="op" id="6665851">(</span><span class="string" id="6665852">&#34;IP&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="6665872">)</span><span class="op" id="6665873">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6665878">}</span><span class="op" id="6665879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6665883">}</span><span class="op" id="6665884">)</span><span class="op" id="6665885">.</span><span class="ident" id="6665886">Marshal</span><span class="op" id="6665893">(</span><span class="op" id="6665894">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6665898">if</span>&nbsp;<span class="ident" id="6665901">err</span>&nbsp;<span class="op" id="6665905">!=</span>&nbsp;<span class="ident" id="6665908">nil</span>&nbsp;<span class="op" id="6665912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6665917">return</span>&nbsp;<span class="ident" id="6665924">nil</span><span class="op" id="6665927">,</span>&nbsp;<span class="keyword" id="6665929">func</span><span class="op" id="6665933">(</span><span class="op" id="6665934">)</span>&nbsp;<span class="op" id="6665936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665942">t</span><span class="op" id="6665943">.</span><span class="ident" id="6665944">Fatalf</span><span class="op" id="6665950">(</span><span class="string" id="6665951">&#34;icmpMessage.Marshal&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6665983">,</span>&nbsp;<span class="ident" id="6665985">err</span><span class="op" id="6665988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6665993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6665997">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6666001">return</span>&nbsp;<span class="ident" id="6666008">b</span><span class="op" id="6666009">,</span>&nbsp;<span class="ident" id="6666011">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6666016">case</span>&nbsp;<span class="string" id="6666021">&#34;unixgram&#34;</span><span class="op" id="6666031">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6666035">switch</span>&nbsp;<span class="ident" id="6666042">runtime</span><span class="op" id="6666049">.</span><span class="ident" id="6666050">GOOS</span>&nbsp;<span class="op" id="6666055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6666059">case</span>&nbsp;<span class="string" id="6666064">&#34;nacl&#34;</span><span class="op" id="6666070">,</span>&nbsp;<span class="string" id="6666072">&#34;plan9&#34;</span><span class="op" id="6666079">,</span>&nbsp;<span class="string" id="6666081">&#34;windows&#34;</span><span class="op" id="6666090">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6666095">return</span>&nbsp;<span class="ident" id="6666102">nil</span><span class="op" id="6666105">,</span>&nbsp;<span class="keyword" id="6666107">func</span><span class="op" id="6666111">(</span><span class="op" id="6666112">)</span>&nbsp;<span class="op" id="6666114">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666120">t</span><span class="op" id="6666121">.</span><span class="ident" id="6666122">Logf</span><span class="op" id="6666126">(</span><span class="string" id="6666127">&#34;skipping&nbsp;%q&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6666151">,</span>&nbsp;<span class="ident" id="6666153">net</span><span class="op" id="6666156">,</span>&nbsp;<span class="ident" id="6666158">runtime</span><span class="op" id="6666165">.</span><span class="ident" id="6666166">GOOS</span><span class="op" id="6666170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6666175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6666179">default</span><span class="op" id="6666186">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6666191">return</span>&nbsp;<span class="op" id="6666198">[</span><span class="op" id="6666199">]</span><span class="builtintype" id="6666200">byte</span><span class="op" id="6666204">(</span><span class="string" id="6666205">&#34;UNIXGRAM&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="6666231">)</span><span class="op" id="6666232">,</span>&nbsp;<span class="ident" id="6666234">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6666240">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6666243">default</span><span class="op" id="6666250">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6666254">return</span>&nbsp;<span class="ident" id="6666261">nil</span><span class="op" id="6666264">,</span>&nbsp;<span class="keyword" id="6666266">func</span><span class="op" id="6666270">(</span><span class="op" id="6666271">)</span>&nbsp;<span class="op" id="6666273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666278">t</span><span class="op" id="6666279">.</span><span class="ident" id="6666280">Logf</span><span class="op" id="6666284">(</span><span class="string" id="6666285">&#34;skipping&nbsp;%q&nbsp;test&#34;</span><span class="op" id="6666303">,</span>&nbsp;<span class="ident" id="6666305">net</span><span class="op" id="6666308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6666312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6666315">}</span><br>
<span class="lineno">55</span><span class="op" id="6666317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6666320">var</span>&nbsp;<span class="ident" id="6666324">packetConnTests</span>&nbsp;<span class="op" id="6666340">=</span>&nbsp;<span class="op" id="6666342">[</span><span class="op" id="6666343">]</span><span class="keyword" id="6666344">struct</span>&nbsp;<span class="op" id="6666351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666354">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6666360">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666368">addr1</span>&nbsp;<span class="builtintype" id="6666374">string</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666382">addr2</span>&nbsp;<span class="builtintype" id="6666388">string</span><br>
<span class="lineno"></span><span class="op" id="6666395">}</span><span class="op" id="6666396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6666399">{</span><span class="string" id="6666400">&#34;udp&#34;</span><span class="op" id="6666405">,</span>&nbsp;<span class="string" id="6666407">&#34;127.0.0.1:0&#34;</span><span class="op" id="6666420">,</span>&nbsp;<span class="string" id="6666422">&#34;127.0.0.1:0&#34;</span><span class="op" id="6666435">}</span><span class="op" id="6666436">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6666439">{</span><span class="string" id="6666440">&#34;ip:icmp&#34;</span><span class="op" id="6666449">,</span>&nbsp;<span class="string" id="6666451">&#34;127.0.0.1&#34;</span><span class="op" id="6666462">,</span>&nbsp;<span class="string" id="6666464">&#34;127.0.0.1&#34;</span><span class="op" id="6666475">}</span><span class="op" id="6666476">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6666479">{</span><span class="string" id="6666480">&#34;unixgram&#34;</span><span class="op" id="6666490">,</span>&nbsp;<span class="ident" id="6666492">testUnixAddr</span><span class="op" id="6666504">(</span><span class="op" id="6666505">)</span><span class="op" id="6666506">,</span>&nbsp;<span class="ident" id="6666508">testUnixAddr</span><span class="op" id="6666520">(</span><span class="op" id="6666521">)</span><span class="op" id="6666522">}</span><span class="op" id="6666523">,</span><br>
<span class="lineno">65</span><span class="op" id="6666525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6666528">func</span>&nbsp;<span class="ident" id="6666533">TestPacketConn</span><span class="op" id="6666547">(</span><span class="ident" id="6666548">t</span>&nbsp;<span class="op" id="6666550">*</span><span class="ident" id="6666551">testing</span><span class="op" id="6666558">.</span><span class="ident" id="6666559">T</span><span class="op" id="6666560">)</span>&nbsp;<span class="op" id="6666562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666565">closer</span>&nbsp;<span class="op" id="6666572">:=</span>&nbsp;<span class="keyword" id="6666575">func</span><span class="op" id="6666579">(</span><span class="ident" id="6666580">c</span>&nbsp;<span class="ident" id="6666582">PacketConn</span><span class="op" id="6666592">,</span>&nbsp;<span class="ident" id="6666594">net</span><span class="op" id="6666597">,</span>&nbsp;<span class="ident" id="6666599">addr1</span><span class="op" id="6666604">,</span>&nbsp;<span class="ident" id="6666606">addr2</span>&nbsp;<span class="builtintype" id="6666612">string</span><span class="op" id="6666618">)</span>&nbsp;<span class="op" id="6666620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666624">c</span><span class="op" id="6666625">.</span><span class="ident" id="6666626">Close</span><span class="op" id="6666631">(</span><span class="op" id="6666632">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6666636">switch</span>&nbsp;<span class="ident" id="6666643">net</span>&nbsp;<span class="op" id="6666647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6666651">case</span>&nbsp;<span class="string" id="6666656">&#34;unixgram&#34;</span><span class="op" id="6666666">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666671">os</span><span class="op" id="6666673">.</span><span class="ident" id="6666674">Remove</span><span class="op" id="6666680">(</span><span class="ident" id="6666681">addr1</span><span class="op" id="6666686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666691">os</span><span class="op" id="6666693">.</span><span class="ident" id="6666694">Remove</span><span class="op" id="6666700">(</span><span class="ident" id="6666701">addr2</span><span class="op" id="6666706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6666710">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6666713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6666717">for</span>&nbsp;<span class="ident" id="6666721">i</span><span class="op" id="6666722">,</span>&nbsp;<span class="ident" id="6666724">tt</span>&nbsp;<span class="op" id="6666727">:=</span>&nbsp;<span class="keyword" id="6666730">range</span>&nbsp;<span class="ident" id="6666736">packetConnTests</span>&nbsp;<span class="op" id="6666752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666756">netstr</span>&nbsp;<span class="op" id="6666763">:=</span>&nbsp;<span class="ident" id="6666766">strings</span><span class="op" id="6666773">.</span><span class="ident" id="6666774">Split</span><span class="op" id="6666779">(</span><span class="ident" id="6666780">tt</span><span class="op" id="6666782">.</span><span class="ident" id="6666783">net</span><span class="op" id="6666786">,</span>&nbsp;<span class="string" id="6666788">&#34;:&#34;</span><span class="op" id="6666791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666795">wb</span><span class="op" id="6666797">,</span>&nbsp;<span class="ident" id="6666799">skipOrFatalFn</span>&nbsp;<span class="op" id="6666813">:=</span>&nbsp;<span class="ident" id="6666816">packetConnTestData</span><span class="op" id="6666834">(</span><span class="ident" id="6666835">t</span><span class="op" id="6666836">,</span>&nbsp;<span class="ident" id="6666838">netstr</span><span class="op" id="6666844">[</span><span class="num" id="6666845">0</span><span class="op" id="6666846">]</span><span class="op" id="6666847">,</span>&nbsp;<span class="ident" id="6666849">i</span><span class="op" id="6666850">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6666854">if</span>&nbsp;<span class="ident" id="6666857">skipOrFatalFn</span>&nbsp;<span class="op" id="6666871">!=</span>&nbsp;<span class="ident" id="6666874">nil</span>&nbsp;<span class="op" id="6666878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666883">skipOrFatalFn</span><span class="op" id="6666896">(</span><span class="op" id="6666897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6666902">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6666913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666918">c1</span><span class="op" id="6666920">,</span>&nbsp;<span class="ident" id="6666922">err</span>&nbsp;<span class="op" id="6666926">:=</span>&nbsp;<span class="ident" id="6666929">ListenPacket</span><span class="op" id="6666941">(</span><span class="ident" id="6666942">tt</span><span class="op" id="6666944">.</span><span class="ident" id="6666945">net</span><span class="op" id="6666948">,</span>&nbsp;<span class="ident" id="6666950">tt</span><span class="op" id="6666952">.</span><span class="ident" id="6666953">addr1</span><span class="op" id="6666958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6666962">if</span>&nbsp;<span class="ident" id="6666965">err</span>&nbsp;<span class="op" id="6666969">!=</span>&nbsp;<span class="ident" id="6666972">nil</span>&nbsp;<span class="op" id="6666976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666981">t</span><span class="op" id="6666982">.</span><span class="ident" id="6666983">Fatalf</span><span class="op" id="6666989">(</span><span class="string" id="6666990">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6667015">,</span>&nbsp;<span class="ident" id="6667017">err</span><span class="op" id="6667020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6667024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6667028">defer</span>&nbsp;<span class="ident" id="6667034">closer</span><span class="op" id="6667040">(</span><span class="ident" id="6667041">c1</span><span class="op" id="6667043">,</span>&nbsp;<span class="ident" id="6667045">netstr</span><span class="op" id="6667051">[</span><span class="num" id="6667052">0</span><span class="op" id="6667053">]</span><span class="op" id="6667054">,</span>&nbsp;<span class="ident" id="6667056">tt</span><span class="op" id="6667058">.</span><span class="ident" id="6667059">addr1</span><span class="op" id="6667064">,</span>&nbsp;<span class="ident" id="6667066">tt</span><span class="op" id="6667068">.</span><span class="ident" id="6667069">addr2</span><span class="op" id="6667074">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667078">c1</span><span class="op" id="6667080">.</span><span class="ident" id="6667081">LocalAddr</span><span class="op" id="6667090">(</span><span class="op" id="6667091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667095">c1</span><span class="op" id="6667097">.</span><span class="ident" id="6667098">SetDeadline</span><span class="op" id="6667109">(</span><span class="ident" id="6667110">time</span><span class="op" id="6667114">.</span><span class="ident" id="6667115">Now</span><span class="op" id="6667118">(</span><span class="op" id="6667119">)</span><span class="op" id="6667120">.</span><span class="ident" id="6667121">Add</span><span class="op" id="6667124">(</span><span class="num" id="6667125">100</span>&nbsp;<span class="op" id="6667129">*</span>&nbsp;<span class="ident" id="6667131">time</span><span class="op" id="6667135">.</span><span class="ident" id="6667136">Millisecond</span><span class="op" id="6667147">)</span><span class="op" id="6667148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667152">c1</span><span class="op" id="6667154">.</span><span class="ident" id="6667155">SetReadDeadline</span><span class="op" id="6667170">(</span><span class="ident" id="6667171">time</span><span class="op" id="6667175">.</span><span class="ident" id="6667176">Now</span><span class="op" id="6667179">(</span><span class="op" id="6667180">)</span><span class="op" id="6667181">.</span><span class="ident" id="6667182">Add</span><span class="op" id="6667185">(</span><span class="num" id="6667186">100</span>&nbsp;<span class="op" id="6667190">*</span>&nbsp;<span class="ident" id="6667192">time</span><span class="op" id="6667196">.</span><span class="ident" id="6667197">Millisecond</span><span class="op" id="6667208">)</span><span class="op" id="6667209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667213">c1</span><span class="op" id="6667215">.</span><span class="ident" id="6667216">SetWriteDeadline</span><span class="op" id="6667232">(</span><span class="ident" id="6667233">time</span><span class="op" id="6667237">.</span><span class="ident" id="6667238">Now</span><span class="op" id="6667241">(</span><span class="op" id="6667242">)</span><span class="op" id="6667243">.</span><span class="ident" id="6667244">Add</span><span class="op" id="6667247">(</span><span class="num" id="6667248">100</span>&nbsp;<span class="op" id="6667252">*</span>&nbsp;<span class="ident" id="6667254">time</span><span class="op" id="6667258">.</span><span class="ident" id="6667259">Millisecond</span><span class="op" id="6667270">)</span><span class="op" id="6667271">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667276">c2</span><span class="op" id="6667278">,</span>&nbsp;<span class="ident" id="6667280">err</span>&nbsp;<span class="op" id="6667284">:=</span>&nbsp;<span class="ident" id="6667287">ListenPacket</span><span class="op" id="6667299">(</span><span class="ident" id="6667300">tt</span><span class="op" id="6667302">.</span><span class="ident" id="6667303">net</span><span class="op" id="6667306">,</span>&nbsp;<span class="ident" id="6667308">tt</span><span class="op" id="6667310">.</span><span class="ident" id="6667311">addr2</span><span class="op" id="6667316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6667320">if</span>&nbsp;<span class="ident" id="6667323">err</span>&nbsp;<span class="op" id="6667327">!=</span>&nbsp;<span class="ident" id="6667330">nil</span>&nbsp;<span class="op" id="6667334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667339">t</span><span class="op" id="6667340">.</span><span class="ident" id="6667341">Fatalf</span><span class="op" id="6667347">(</span><span class="string" id="6667348">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6667373">,</span>&nbsp;<span class="ident" id="6667375">err</span><span class="op" id="6667378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6667382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6667386">defer</span>&nbsp;<span class="ident" id="6667392">closer</span><span class="op" id="6667398">(</span><span class="ident" id="6667399">c2</span><span class="op" id="6667401">,</span>&nbsp;<span class="ident" id="6667403">netstr</span><span class="op" id="6667409">[</span><span class="num" id="6667410">0</span><span class="op" id="6667411">]</span><span class="op" id="6667412">,</span>&nbsp;<span class="ident" id="6667414">tt</span><span class="op" id="6667416">.</span><span class="ident" id="6667417">addr1</span><span class="op" id="6667422">,</span>&nbsp;<span class="ident" id="6667424">tt</span><span class="op" id="6667426">.</span><span class="ident" id="6667427">addr2</span><span class="op" id="6667432">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667436">c2</span><span class="op" id="6667438">.</span><span class="ident" id="6667439">LocalAddr</span><span class="op" id="6667448">(</span><span class="op" id="6667449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667453">c2</span><span class="op" id="6667455">.</span><span class="ident" id="6667456">SetDeadline</span><span class="op" id="6667467">(</span><span class="ident" id="6667468">time</span><span class="op" id="6667472">.</span><span class="ident" id="6667473">Now</span><span class="op" id="6667476">(</span><span class="op" id="6667477">)</span><span class="op" id="6667478">.</span><span class="ident" id="6667479">Add</span><span class="op" id="6667482">(</span><span class="num" id="6667483">100</span>&nbsp;<span class="op" id="6667487">*</span>&nbsp;<span class="ident" id="6667489">time</span><span class="op" id="6667493">.</span><span class="ident" id="6667494">Millisecond</span><span class="op" id="6667505">)</span><span class="op" id="6667506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667510">c2</span><span class="op" id="6667512">.</span><span class="ident" id="6667513">SetReadDeadline</span><span class="op" id="6667528">(</span><span class="ident" id="6667529">time</span><span class="op" id="6667533">.</span><span class="ident" id="6667534">Now</span><span class="op" id="6667537">(</span><span class="op" id="6667538">)</span><span class="op" id="6667539">.</span><span class="ident" id="6667540">Add</span><span class="op" id="6667543">(</span><span class="num" id="6667544">100</span>&nbsp;<span class="op" id="6667548">*</span>&nbsp;<span class="ident" id="6667550">time</span><span class="op" id="6667554">.</span><span class="ident" id="6667555">Millisecond</span><span class="op" id="6667566">)</span><span class="op" id="6667567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667571">c2</span><span class="op" id="6667573">.</span><span class="ident" id="6667574">SetWriteDeadline</span><span class="op" id="6667590">(</span><span class="ident" id="6667591">time</span><span class="op" id="6667595">.</span><span class="ident" id="6667596">Now</span><span class="op" id="6667599">(</span><span class="op" id="6667600">)</span><span class="op" id="6667601">.</span><span class="ident" id="6667602">Add</span><span class="op" id="6667605">(</span><span class="num" id="6667606">100</span>&nbsp;<span class="op" id="6667610">*</span>&nbsp;<span class="ident" id="6667612">time</span><span class="op" id="6667616">.</span><span class="ident" id="6667617">Millisecond</span><span class="op" id="6667628">)</span><span class="op" id="6667629">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6667634">if</span>&nbsp;<span class="ident" id="6667637">_</span><span class="op" id="6667638">,</span>&nbsp;<span class="ident" id="6667640">err</span>&nbsp;<span class="op" id="6667644">:=</span>&nbsp;<span class="ident" id="6667647">c1</span><span class="op" id="6667649">.</span><span class="ident" id="6667650">WriteTo</span><span class="op" id="6667657">(</span><span class="ident" id="6667658">wb</span><span class="op" id="6667660">,</span>&nbsp;<span class="ident" id="6667662">c2</span><span class="op" id="6667664">.</span><span class="ident" id="6667665">LocalAddr</span><span class="op" id="6667674">(</span><span class="op" id="6667675">)</span><span class="op" id="6667676">)</span><span class="op" id="6667677">;</span>&nbsp;<span class="ident" id="6667679">err</span>&nbsp;<span class="op" id="6667683">!=</span>&nbsp;<span class="ident" id="6667686">nil</span>&nbsp;<span class="op" id="6667690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667695">t</span><span class="op" id="6667696">.</span><span class="ident" id="6667697">Fatalf</span><span class="op" id="6667703">(</span><span class="string" id="6667704">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6667735">,</span>&nbsp;<span class="ident" id="6667737">err</span><span class="op" id="6667740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6667744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667748">rb2</span>&nbsp;<span class="op" id="6667752">:=</span>&nbsp;<span class="builtinfunc" id="6667755">make</span><span class="op" id="6667759">(</span><span class="op" id="6667760">[</span><span class="op" id="6667761">]</span><span class="builtintype" id="6667762">byte</span><span class="op" id="6667766">,</span>&nbsp;<span class="num" id="6667768">128</span><span class="op" id="6667771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6667775">if</span>&nbsp;<span class="ident" id="6667778">_</span><span class="op" id="6667779">,</span>&nbsp;<span class="ident" id="6667781">_</span><span class="op" id="6667782">,</span>&nbsp;<span class="ident" id="6667784">err</span>&nbsp;<span class="op" id="6667788">:=</span>&nbsp;<span class="ident" id="6667791">c2</span><span class="op" id="6667793">.</span><span class="ident" id="6667794">ReadFrom</span><span class="op" id="6667802">(</span><span class="ident" id="6667803">rb2</span><span class="op" id="6667806">)</span><span class="op" id="6667807">;</span>&nbsp;<span class="ident" id="6667809">err</span>&nbsp;<span class="op" id="6667813">!=</span>&nbsp;<span class="ident" id="6667816">nil</span>&nbsp;<span class="op" id="6667820">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667825">t</span><span class="op" id="6667826">.</span><span class="ident" id="6667827">Fatalf</span><span class="op" id="6667833">(</span><span class="string" id="6667834">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6667866">,</span>&nbsp;<span class="ident" id="6667868">err</span><span class="op" id="6667871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6667875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6667879">if</span>&nbsp;<span class="ident" id="6667882">_</span><span class="op" id="6667883">,</span>&nbsp;<span class="ident" id="6667885">err</span>&nbsp;<span class="op" id="6667889">:=</span>&nbsp;<span class="ident" id="6667892">c2</span><span class="op" id="6667894">.</span><span class="ident" id="6667895">WriteTo</span><span class="op" id="6667902">(</span><span class="ident" id="6667903">wb</span><span class="op" id="6667905">,</span>&nbsp;<span class="ident" id="6667907">c1</span><span class="op" id="6667909">.</span><span class="ident" id="6667910">LocalAddr</span><span class="op" id="6667919">(</span><span class="op" id="6667920">)</span><span class="op" id="6667921">)</span><span class="op" id="6667922">;</span>&nbsp;<span class="ident" id="6667924">err</span>&nbsp;<span class="op" id="6667928">!=</span>&nbsp;<span class="ident" id="6667931">nil</span>&nbsp;<span class="op" id="6667935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667940">t</span><span class="op" id="6667941">.</span><span class="ident" id="6667942">Fatalf</span><span class="op" id="6667948">(</span><span class="string" id="6667949">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6667980">,</span>&nbsp;<span class="ident" id="6667982">err</span><span class="op" id="6667985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6667989">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667993">rb1</span>&nbsp;<span class="op" id="6667997">:=</span>&nbsp;<span class="builtinfunc" id="6668000">make</span><span class="op" id="6668004">(</span><span class="op" id="6668005">[</span><span class="op" id="6668006">]</span><span class="builtintype" id="6668007">byte</span><span class="op" id="6668011">,</span>&nbsp;<span class="num" id="6668013">128</span><span class="op" id="6668016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668020">if</span>&nbsp;<span class="ident" id="6668023">_</span><span class="op" id="6668024">,</span>&nbsp;<span class="ident" id="6668026">_</span><span class="op" id="6668027">,</span>&nbsp;<span class="ident" id="6668029">err</span>&nbsp;<span class="op" id="6668033">:=</span>&nbsp;<span class="ident" id="6668036">c1</span><span class="op" id="6668038">.</span><span class="ident" id="6668039">ReadFrom</span><span class="op" id="6668047">(</span><span class="ident" id="6668048">rb1</span><span class="op" id="6668051">)</span><span class="op" id="6668052">;</span>&nbsp;<span class="ident" id="6668054">err</span>&nbsp;<span class="op" id="6668058">!=</span>&nbsp;<span class="ident" id="6668061">nil</span>&nbsp;<span class="op" id="6668065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668070">t</span><span class="op" id="6668071">.</span><span class="ident" id="6668072">Fatalf</span><span class="op" id="6668078">(</span><span class="string" id="6668079">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6668111">,</span>&nbsp;<span class="ident" id="6668113">err</span><span class="op" id="6668116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6668120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6668123">}</span><br>
<span class="lineno">120</span><span class="op" id="6668125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6668128">func</span>&nbsp;<span class="ident" id="6668133">TestConnAndPacketConn</span><span class="op" id="6668154">(</span><span class="ident" id="6668155">t</span>&nbsp;<span class="op" id="6668157">*</span><span class="ident" id="6668158">testing</span><span class="op" id="6668165">.</span><span class="ident" id="6668166">T</span><span class="op" id="6668167">)</span>&nbsp;<span class="op" id="6668169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668172">closer</span>&nbsp;<span class="op" id="6668179">:=</span>&nbsp;<span class="keyword" id="6668182">func</span><span class="op" id="6668186">(</span><span class="ident" id="6668187">c</span>&nbsp;<span class="ident" id="6668189">PacketConn</span><span class="op" id="6668199">,</span>&nbsp;<span class="ident" id="6668201">net</span><span class="op" id="6668204">,</span>&nbsp;<span class="ident" id="6668206">addr1</span><span class="op" id="6668211">,</span>&nbsp;<span class="ident" id="6668213">addr2</span>&nbsp;<span class="builtintype" id="6668219">string</span><span class="op" id="6668225">)</span>&nbsp;<span class="op" id="6668227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668231">c</span><span class="op" id="6668232">.</span><span class="ident" id="6668233">Close</span><span class="op" id="6668238">(</span><span class="op" id="6668239">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668243">switch</span>&nbsp;<span class="ident" id="6668250">net</span>&nbsp;<span class="op" id="6668254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668258">case</span>&nbsp;<span class="string" id="6668263">&#34;unixgram&#34;</span><span class="op" id="6668273">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668278">os</span><span class="op" id="6668280">.</span><span class="ident" id="6668281">Remove</span><span class="op" id="6668287">(</span><span class="ident" id="6668288">addr1</span><span class="op" id="6668293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668298">os</span><span class="op" id="6668300">.</span><span class="ident" id="6668301">Remove</span><span class="op" id="6668307">(</span><span class="ident" id="6668308">addr2</span><span class="op" id="6668313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6668317">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6668320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668324">for</span>&nbsp;<span class="ident" id="6668328">i</span><span class="op" id="6668329">,</span>&nbsp;<span class="ident" id="6668331">tt</span>&nbsp;<span class="op" id="6668334">:=</span>&nbsp;<span class="keyword" id="6668337">range</span>&nbsp;<span class="ident" id="6668343">packetConnTests</span>&nbsp;<span class="op" id="6668359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668363">var</span>&nbsp;<span class="ident" id="6668367">wb</span>&nbsp;<span class="op" id="6668370">[</span><span class="op" id="6668371">]</span><span class="builtintype" id="6668372">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668379">netstr</span>&nbsp;<span class="op" id="6668386">:=</span>&nbsp;<span class="ident" id="6668389">strings</span><span class="op" id="6668396">.</span><span class="ident" id="6668397">Split</span><span class="op" id="6668402">(</span><span class="ident" id="6668403">tt</span><span class="op" id="6668405">.</span><span class="ident" id="6668406">net</span><span class="op" id="6668409">,</span>&nbsp;<span class="string" id="6668411">&#34;:&#34;</span><span class="op" id="6668414">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668418">wb</span><span class="op" id="6668420">,</span>&nbsp;<span class="ident" id="6668422">skipOrFatalFn</span>&nbsp;<span class="op" id="6668436">:=</span>&nbsp;<span class="ident" id="6668439">packetConnTestData</span><span class="op" id="6668457">(</span><span class="ident" id="6668458">t</span><span class="op" id="6668459">,</span>&nbsp;<span class="ident" id="6668461">netstr</span><span class="op" id="6668467">[</span><span class="num" id="6668468">0</span><span class="op" id="6668469">]</span><span class="op" id="6668470">,</span>&nbsp;<span class="ident" id="6668472">i</span><span class="op" id="6668473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668477">if</span>&nbsp;<span class="ident" id="6668480">skipOrFatalFn</span>&nbsp;<span class="op" id="6668494">!=</span>&nbsp;<span class="ident" id="6668497">nil</span>&nbsp;<span class="op" id="6668501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668506">skipOrFatalFn</span><span class="op" id="6668519">(</span><span class="op" id="6668520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668525">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6668536">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668541">c1</span><span class="op" id="6668543">,</span>&nbsp;<span class="ident" id="6668545">err</span>&nbsp;<span class="op" id="6668549">:=</span>&nbsp;<span class="ident" id="6668552">ListenPacket</span><span class="op" id="6668564">(</span><span class="ident" id="6668565">tt</span><span class="op" id="6668567">.</span><span class="ident" id="6668568">net</span><span class="op" id="6668571">,</span>&nbsp;<span class="ident" id="6668573">tt</span><span class="op" id="6668575">.</span><span class="ident" id="6668576">addr1</span><span class="op" id="6668581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668585">if</span>&nbsp;<span class="ident" id="6668588">err</span>&nbsp;<span class="op" id="6668592">!=</span>&nbsp;<span class="ident" id="6668595">nil</span>&nbsp;<span class="op" id="6668599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668604">t</span><span class="op" id="6668605">.</span><span class="ident" id="6668606">Fatalf</span><span class="op" id="6668612">(</span><span class="string" id="6668613">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6668638">,</span>&nbsp;<span class="ident" id="6668640">err</span><span class="op" id="6668643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6668647">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668651">defer</span>&nbsp;<span class="ident" id="6668657">closer</span><span class="op" id="6668663">(</span><span class="ident" id="6668664">c1</span><span class="op" id="6668666">,</span>&nbsp;<span class="ident" id="6668668">netstr</span><span class="op" id="6668674">[</span><span class="num" id="6668675">0</span><span class="op" id="6668676">]</span><span class="op" id="6668677">,</span>&nbsp;<span class="ident" id="6668679">tt</span><span class="op" id="6668681">.</span><span class="ident" id="6668682">addr1</span><span class="op" id="6668687">,</span>&nbsp;<span class="ident" id="6668689">tt</span><span class="op" id="6668691">.</span><span class="ident" id="6668692">addr2</span><span class="op" id="6668697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668701">c1</span><span class="op" id="6668703">.</span><span class="ident" id="6668704">LocalAddr</span><span class="op" id="6668713">(</span><span class="op" id="6668714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668718">c1</span><span class="op" id="6668720">.</span><span class="ident" id="6668721">SetDeadline</span><span class="op" id="6668732">(</span><span class="ident" id="6668733">time</span><span class="op" id="6668737">.</span><span class="ident" id="6668738">Now</span><span class="op" id="6668741">(</span><span class="op" id="6668742">)</span><span class="op" id="6668743">.</span><span class="ident" id="6668744">Add</span><span class="op" id="6668747">(</span><span class="num" id="6668748">100</span>&nbsp;<span class="op" id="6668752">*</span>&nbsp;<span class="ident" id="6668754">time</span><span class="op" id="6668758">.</span><span class="ident" id="6668759">Millisecond</span><span class="op" id="6668770">)</span><span class="op" id="6668771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668775">c1</span><span class="op" id="6668777">.</span><span class="ident" id="6668778">SetReadDeadline</span><span class="op" id="6668793">(</span><span class="ident" id="6668794">time</span><span class="op" id="6668798">.</span><span class="ident" id="6668799">Now</span><span class="op" id="6668802">(</span><span class="op" id="6668803">)</span><span class="op" id="6668804">.</span><span class="ident" id="6668805">Add</span><span class="op" id="6668808">(</span><span class="num" id="6668809">100</span>&nbsp;<span class="op" id="6668813">*</span>&nbsp;<span class="ident" id="6668815">time</span><span class="op" id="6668819">.</span><span class="ident" id="6668820">Millisecond</span><span class="op" id="6668831">)</span><span class="op" id="6668832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668836">c1</span><span class="op" id="6668838">.</span><span class="ident" id="6668839">SetWriteDeadline</span><span class="op" id="6668855">(</span><span class="ident" id="6668856">time</span><span class="op" id="6668860">.</span><span class="ident" id="6668861">Now</span><span class="op" id="6668864">(</span><span class="op" id="6668865">)</span><span class="op" id="6668866">.</span><span class="ident" id="6668867">Add</span><span class="op" id="6668870">(</span><span class="num" id="6668871">100</span>&nbsp;<span class="op" id="6668875">*</span>&nbsp;<span class="ident" id="6668877">time</span><span class="op" id="6668881">.</span><span class="ident" id="6668882">Millisecond</span><span class="op" id="6668893">)</span><span class="op" id="6668894">)</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668899">c2</span><span class="op" id="6668901">,</span>&nbsp;<span class="ident" id="6668903">err</span>&nbsp;<span class="op" id="6668907">:=</span>&nbsp;<span class="ident" id="6668910">Dial</span><span class="op" id="6668914">(</span><span class="ident" id="6668915">tt</span><span class="op" id="6668917">.</span><span class="ident" id="6668918">net</span><span class="op" id="6668921">,</span>&nbsp;<span class="ident" id="6668923">c1</span><span class="op" id="6668925">.</span><span class="ident" id="6668926">LocalAddr</span><span class="op" id="6668935">(</span><span class="op" id="6668936">)</span><span class="op" id="6668937">.</span><span class="ident" id="6668938">String</span><span class="op" id="6668944">(</span><span class="op" id="6668945">)</span><span class="op" id="6668946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668950">if</span>&nbsp;<span class="ident" id="6668953">err</span>&nbsp;<span class="op" id="6668957">!=</span>&nbsp;<span class="ident" id="6668960">nil</span>&nbsp;<span class="op" id="6668964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668969">t</span><span class="op" id="6668970">.</span><span class="ident" id="6668971">Fatalf</span><span class="op" id="6668977">(</span><span class="string" id="6668978">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6668995">,</span>&nbsp;<span class="ident" id="6668997">err</span><span class="op" id="6669000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6669004">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6669008">defer</span>&nbsp;<span class="ident" id="6669014">c2</span><span class="op" id="6669016">.</span><span class="ident" id="6669017">Close</span><span class="op" id="6669022">(</span><span class="op" id="6669023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669027">c2</span><span class="op" id="6669029">.</span><span class="ident" id="6669030">LocalAddr</span><span class="op" id="6669039">(</span><span class="op" id="6669040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669044">c2</span><span class="op" id="6669046">.</span><span class="ident" id="6669047">RemoteAddr</span><span class="op" id="6669057">(</span><span class="op" id="6669058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669062">c2</span><span class="op" id="6669064">.</span><span class="ident" id="6669065">SetDeadline</span><span class="op" id="6669076">(</span><span class="ident" id="6669077">time</span><span class="op" id="6669081">.</span><span class="ident" id="6669082">Now</span><span class="op" id="6669085">(</span><span class="op" id="6669086">)</span><span class="op" id="6669087">.</span><span class="ident" id="6669088">Add</span><span class="op" id="6669091">(</span><span class="num" id="6669092">100</span>&nbsp;<span class="op" id="6669096">*</span>&nbsp;<span class="ident" id="6669098">time</span><span class="op" id="6669102">.</span><span class="ident" id="6669103">Millisecond</span><span class="op" id="6669114">)</span><span class="op" id="6669115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669119">c2</span><span class="op" id="6669121">.</span><span class="ident" id="6669122">SetReadDeadline</span><span class="op" id="6669137">(</span><span class="ident" id="6669138">time</span><span class="op" id="6669142">.</span><span class="ident" id="6669143">Now</span><span class="op" id="6669146">(</span><span class="op" id="6669147">)</span><span class="op" id="6669148">.</span><span class="ident" id="6669149">Add</span><span class="op" id="6669152">(</span><span class="num" id="6669153">100</span>&nbsp;<span class="op" id="6669157">*</span>&nbsp;<span class="ident" id="6669159">time</span><span class="op" id="6669163">.</span><span class="ident" id="6669164">Millisecond</span><span class="op" id="6669175">)</span><span class="op" id="6669176">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669180">c2</span><span class="op" id="6669182">.</span><span class="ident" id="6669183">SetWriteDeadline</span><span class="op" id="6669199">(</span><span class="ident" id="6669200">time</span><span class="op" id="6669204">.</span><span class="ident" id="6669205">Now</span><span class="op" id="6669208">(</span><span class="op" id="6669209">)</span><span class="op" id="6669210">.</span><span class="ident" id="6669211">Add</span><span class="op" id="6669214">(</span><span class="num" id="6669215">100</span>&nbsp;<span class="op" id="6669219">*</span>&nbsp;<span class="ident" id="6669221">time</span><span class="op" id="6669225">.</span><span class="ident" id="6669226">Millisecond</span><span class="op" id="6669237">)</span><span class="op" id="6669238">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6669243">if</span>&nbsp;<span class="ident" id="6669246">_</span><span class="op" id="6669247">,</span>&nbsp;<span class="ident" id="6669249">err</span>&nbsp;<span class="op" id="6669253">:=</span>&nbsp;<span class="ident" id="6669256">c2</span><span class="op" id="6669258">.</span><span class="ident" id="6669259">Write</span><span class="op" id="6669264">(</span><span class="ident" id="6669265">wb</span><span class="op" id="6669267">)</span><span class="op" id="6669268">;</span>&nbsp;<span class="ident" id="6669270">err</span>&nbsp;<span class="op" id="6669274">!=</span>&nbsp;<span class="ident" id="6669277">nil</span>&nbsp;<span class="op" id="6669281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669286">t</span><span class="op" id="6669287">.</span><span class="ident" id="6669288">Fatalf</span><span class="op" id="6669294">(</span><span class="string" id="6669295">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6669318">,</span>&nbsp;<span class="ident" id="6669320">err</span><span class="op" id="6669323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6669327">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669331">rb1</span>&nbsp;<span class="op" id="6669335">:=</span>&nbsp;<span class="builtinfunc" id="6669338">make</span><span class="op" id="6669342">(</span><span class="op" id="6669343">[</span><span class="op" id="6669344">]</span><span class="builtintype" id="6669345">byte</span><span class="op" id="6669349">,</span>&nbsp;<span class="num" id="6669351">128</span><span class="op" id="6669354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6669358">if</span>&nbsp;<span class="ident" id="6669361">_</span><span class="op" id="6669362">,</span>&nbsp;<span class="ident" id="6669364">_</span><span class="op" id="6669365">,</span>&nbsp;<span class="ident" id="6669367">err</span>&nbsp;<span class="op" id="6669371">:=</span>&nbsp;<span class="ident" id="6669374">c1</span><span class="op" id="6669376">.</span><span class="ident" id="6669377">ReadFrom</span><span class="op" id="6669385">(</span><span class="ident" id="6669386">rb1</span><span class="op" id="6669389">)</span><span class="op" id="6669390">;</span>&nbsp;<span class="ident" id="6669392">err</span>&nbsp;<span class="op" id="6669396">!=</span>&nbsp;<span class="ident" id="6669399">nil</span>&nbsp;<span class="op" id="6669403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669408">t</span><span class="op" id="6669409">.</span><span class="ident" id="6669410">Fatalf</span><span class="op" id="6669416">(</span><span class="string" id="6669417">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6669449">,</span>&nbsp;<span class="ident" id="6669451">err</span><span class="op" id="6669454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6669458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6669462">var</span>&nbsp;<span class="ident" id="6669466">dst</span>&nbsp;<span class="ident" id="6669470">Addr</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6669477">switch</span>&nbsp;<span class="ident" id="6669484">netstr</span><span class="op" id="6669490">[</span><span class="num" id="6669491">0</span><span class="op" id="6669492">]</span>&nbsp;<span class="op" id="6669494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6669498">case</span>&nbsp;<span class="string" id="6669503">&#34;ip&#34;</span><span class="op" id="6669507">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669512">dst</span>&nbsp;<span class="op" id="6669516">=</span>&nbsp;<span class="op" id="6669518">&amp;</span><span class="ident" id="6669519">IPAddr</span><span class="op" id="6669525">{</span><span class="ident" id="6669526">IP</span><span class="op" id="6669528">:</span>&nbsp;<span class="ident" id="6669530">IPv4</span><span class="op" id="6669534">(</span><span class="num" id="6669535">127</span><span class="op" id="6669538">,</span>&nbsp;<span class="num" id="6669540">0</span><span class="op" id="6669541">,</span>&nbsp;<span class="num" id="6669543">0</span><span class="op" id="6669544">,</span>&nbsp;<span class="num" id="6669546">1</span><span class="op" id="6669547">)</span><span class="op" id="6669548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6669552">case</span>&nbsp;<span class="string" id="6669557">&#34;unixgram&#34;</span><span class="op" id="6669567">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6669572">continue</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6669583">default</span><span class="op" id="6669590">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669595">dst</span>&nbsp;<span class="op" id="6669599">=</span>&nbsp;<span class="ident" id="6669601">c2</span><span class="op" id="6669603">.</span><span class="ident" id="6669604">LocalAddr</span><span class="op" id="6669613">(</span><span class="op" id="6669614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6669618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6669622">if</span>&nbsp;<span class="ident" id="6669625">_</span><span class="op" id="6669626">,</span>&nbsp;<span class="ident" id="6669628">err</span>&nbsp;<span class="op" id="6669632">:=</span>&nbsp;<span class="ident" id="6669635">c1</span><span class="op" id="6669637">.</span><span class="ident" id="6669638">WriteTo</span><span class="op" id="6669645">(</span><span class="ident" id="6669646">wb</span><span class="op" id="6669648">,</span>&nbsp;<span class="ident" id="6669650">dst</span><span class="op" id="6669653">)</span><span class="op" id="6669654">;</span>&nbsp;<span class="ident" id="6669656">err</span>&nbsp;<span class="op" id="6669660">!=</span>&nbsp;<span class="ident" id="6669663">nil</span>&nbsp;<span class="op" id="6669667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669672">t</span><span class="op" id="6669673">.</span><span class="ident" id="6669674">Fatalf</span><span class="op" id="6669680">(</span><span class="string" id="6669681">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6669712">,</span>&nbsp;<span class="ident" id="6669714">err</span><span class="op" id="6669717">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6669721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669725">rb2</span>&nbsp;<span class="op" id="6669729">:=</span>&nbsp;<span class="builtinfunc" id="6669732">make</span><span class="op" id="6669736">(</span><span class="op" id="6669737">[</span><span class="op" id="6669738">]</span><span class="builtintype" id="6669739">byte</span><span class="op" id="6669743">,</span>&nbsp;<span class="num" id="6669745">128</span><span class="op" id="6669748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6669752">if</span>&nbsp;<span class="ident" id="6669755">_</span><span class="op" id="6669756">,</span>&nbsp;<span class="ident" id="6669758">err</span>&nbsp;<span class="op" id="6669762">:=</span>&nbsp;<span class="ident" id="6669765">c2</span><span class="op" id="6669767">.</span><span class="ident" id="6669768">Read</span><span class="op" id="6669772">(</span><span class="ident" id="6669773">rb2</span><span class="op" id="6669776">)</span><span class="op" id="6669777">;</span>&nbsp;<span class="ident" id="6669779">err</span>&nbsp;<span class="op" id="6669783">!=</span>&nbsp;<span class="ident" id="6669786">nil</span>&nbsp;<span class="op" id="6669790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669795">t</span><span class="op" id="6669796">.</span><span class="ident" id="6669797">Fatalf</span><span class="op" id="6669803">(</span><span class="string" id="6669804">&#34;Conn.Read&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6669826">,</span>&nbsp;<span class="ident" id="6669828">err</span><span class="op" id="6669831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6669835">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6669838">}</span><br>
<span class="lineno"></span><span class="op" id="6669840">}</span>
</div>
</body>
</html>
