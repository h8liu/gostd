<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html" class="current">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2246116">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2246171">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2246225">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2246276">//go:generate&nbsp;go&nbsp;run&nbsp;makeisprint.go&nbsp;-output&nbsp;isprint.go</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2246332">package</span>&nbsp;<span class="ident" id="2246340">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2246349">import</span>&nbsp;<span class="op" id="2246356">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2246359">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2246374">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2246377">const</span>&nbsp;<span class="ident" id="2246383">lowerhex</span>&nbsp;<span class="op" id="2246392">=</span>&nbsp;<span class="string" id="2246394">&#34;0123456789abcdef&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="2246414">func</span>&nbsp;<span class="ident" id="2246419">quoteWith</span><span class="op" id="2246428">(</span><span class="ident" id="2246429">s</span>&nbsp;<span class="builtintype" id="2246431">string</span><span class="op" id="2246437">,</span>&nbsp;<span class="ident" id="2246439">quote</span>&nbsp;<span class="builtintype" id="2246445">byte</span><span class="op" id="2246449">,</span>&nbsp;<span class="ident" id="2246451">ASCIIonly</span>&nbsp;<span class="builtintype" id="2246461">bool</span><span class="op" id="2246465">)</span>&nbsp;<span class="builtintype" id="2246467">string</span>&nbsp;<span class="op" id="2246474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246477">var</span>&nbsp;<span class="ident" id="2246481">runeTmp</span>&nbsp;<span class="op" id="2246489">[</span><span class="ident" id="2246490">utf8</span><span class="op" id="2246494">.</span><span class="ident" id="2246495">UTFMax</span><span class="op" id="2246501">]</span><span class="builtintype" id="2246502">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246508">buf</span>&nbsp;<span class="op" id="2246512">:=</span>&nbsp;<span class="builtinfunc" id="2246515">make</span><span class="op" id="2246519">(</span><span class="op" id="2246520">[</span><span class="op" id="2246521">]</span><span class="builtintype" id="2246522">byte</span><span class="op" id="2246526">,</span>&nbsp;<span class="num" id="2246528">0</span><span class="op" id="2246529">,</span>&nbsp;<span class="num" id="2246531">3</span><span class="op" id="2246532">*</span><span class="builtinfunc" id="2246533">len</span><span class="op" id="2246536">(</span><span class="ident" id="2246537">s</span><span class="op" id="2246538">)</span><span class="op" id="2246539">/</span><span class="num" id="2246540">2</span><span class="op" id="2246541">)</span>&nbsp;<span class="comment" id="2246543">//&nbsp;Try&nbsp;to&nbsp;avoid&nbsp;more&nbsp;allocations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246578">buf</span>&nbsp;<span class="op" id="2246582">=</span>&nbsp;<span class="builtinfunc" id="2246584">append</span><span class="op" id="2246590">(</span><span class="ident" id="2246591">buf</span><span class="op" id="2246594">,</span>&nbsp;<span class="ident" id="2246596">quote</span><span class="op" id="2246601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246604">for</span>&nbsp;<span class="ident" id="2246608">width</span>&nbsp;<span class="op" id="2246614">:=</span>&nbsp;<span class="num" id="2246617">0</span><span class="op" id="2246618">;</span>&nbsp;<span class="builtinfunc" id="2246620">len</span><span class="op" id="2246623">(</span><span class="ident" id="2246624">s</span><span class="op" id="2246625">)</span>&nbsp;<span class="op" id="2246627">&gt;</span>&nbsp;<span class="num" id="2246629">0</span><span class="op" id="2246630">;</span>&nbsp;<span class="ident" id="2246632">s</span>&nbsp;<span class="op" id="2246634">=</span>&nbsp;<span class="ident" id="2246636">s</span><span class="op" id="2246637">[</span><span class="ident" id="2246638">width</span><span class="op" id="2246643">:</span><span class="op" id="2246644">]</span>&nbsp;<span class="op" id="2246646">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246650">r</span>&nbsp;<span class="op" id="2246652">:=</span>&nbsp;<span class="builtintype" id="2246655">rune</span><span class="op" id="2246659">(</span><span class="ident" id="2246660">s</span><span class="op" id="2246661">[</span><span class="num" id="2246662">0</span><span class="op" id="2246663">]</span><span class="op" id="2246664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246668">width</span>&nbsp;<span class="op" id="2246674">=</span>&nbsp;<span class="num" id="2246676">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246680">if</span>&nbsp;<span class="ident" id="2246683">r</span>&nbsp;<span class="op" id="2246685">&gt;=</span>&nbsp;<span class="ident" id="2246688">utf8</span><span class="op" id="2246692">.</span><span class="ident" id="2246693">RuneSelf</span>&nbsp;<span class="op" id="2246702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246707">r</span><span class="op" id="2246708">,</span>&nbsp;<span class="ident" id="2246710">width</span>&nbsp;<span class="op" id="2246716">=</span>&nbsp;<span class="ident" id="2246718">utf8</span><span class="op" id="2246722">.</span><span class="ident" id="2246723">DecodeRuneInString</span><span class="op" id="2246741">(</span><span class="ident" id="2246742">s</span><span class="op" id="2246743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2246747">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246751">if</span>&nbsp;<span class="ident" id="2246754">width</span>&nbsp;<span class="op" id="2246760">==</span>&nbsp;<span class="num" id="2246763">1</span>&nbsp;<span class="op" id="2246765">&amp;&amp;</span>&nbsp;<span class="ident" id="2246768">r</span>&nbsp;<span class="op" id="2246770">==</span>&nbsp;<span class="ident" id="2246773">utf8</span><span class="op" id="2246777">.</span><span class="ident" id="2246778">RuneError</span>&nbsp;<span class="op" id="2246788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246793">buf</span>&nbsp;<span class="op" id="2246797">=</span>&nbsp;<span class="builtinfunc" id="2246799">append</span><span class="op" id="2246805">(</span><span class="ident" id="2246806">buf</span><span class="op" id="2246809">,</span>&nbsp;<span class="string" id="2246811">`\x`</span><span class="op" id="2246815">...</span><span class="op" id="2246818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246823">buf</span>&nbsp;<span class="op" id="2246827">=</span>&nbsp;<span class="builtinfunc" id="2246829">append</span><span class="op" id="2246835">(</span><span class="ident" id="2246836">buf</span><span class="op" id="2246839">,</span>&nbsp;<span class="ident" id="2246841">lowerhex</span><span class="op" id="2246849">[</span><span class="ident" id="2246850">s</span><span class="op" id="2246851">[</span><span class="num" id="2246852">0</span><span class="op" id="2246853">]</span><span class="op" id="2246854">&gt;&gt;</span><span class="num" id="2246856">4</span><span class="op" id="2246857">]</span><span class="op" id="2246858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246863">buf</span>&nbsp;<span class="op" id="2246867">=</span>&nbsp;<span class="builtinfunc" id="2246869">append</span><span class="op" id="2246875">(</span><span class="ident" id="2246876">buf</span><span class="op" id="2246879">,</span>&nbsp;<span class="ident" id="2246881">lowerhex</span><span class="op" id="2246889">[</span><span class="ident" id="2246890">s</span><span class="op" id="2246891">[</span><span class="num" id="2246892">0</span><span class="op" id="2246893">]</span><span class="op" id="2246894">&amp;</span><span class="num" id="2246895">0xF</span><span class="op" id="2246898">]</span><span class="op" id="2246899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246904">continue</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2246915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246919">if</span>&nbsp;<span class="ident" id="2246922">r</span>&nbsp;<span class="op" id="2246924">==</span>&nbsp;<span class="builtintype" id="2246927">rune</span><span class="op" id="2246931">(</span><span class="ident" id="2246932">quote</span><span class="op" id="2246937">)</span>&nbsp;<span class="op" id="2246939">||</span>&nbsp;<span class="ident" id="2246942">r</span>&nbsp;<span class="op" id="2246944">==</span>&nbsp;<span class="string" id="2246947">&#39;\\&#39;</span>&nbsp;<span class="op" id="2246952">{</span>&nbsp;<span class="comment" id="2246954">//&nbsp;always&nbsp;backslashed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246979">buf</span>&nbsp;<span class="op" id="2246983">=</span>&nbsp;<span class="builtinfunc" id="2246985">append</span><span class="op" id="2246991">(</span><span class="ident" id="2246992">buf</span><span class="op" id="2246995">,</span>&nbsp;<span class="string" id="2246997">&#39;\\&#39;</span><span class="op" id="2247001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247006">buf</span>&nbsp;<span class="op" id="2247010">=</span>&nbsp;<span class="builtinfunc" id="2247012">append</span><span class="op" id="2247018">(</span><span class="ident" id="2247019">buf</span><span class="op" id="2247022">,</span>&nbsp;<span class="builtintype" id="2247024">byte</span><span class="op" id="2247028">(</span><span class="ident" id="2247029">r</span><span class="op" id="2247030">)</span><span class="op" id="2247031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247036">continue</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2247047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247051">if</span>&nbsp;<span class="ident" id="2247054">ASCIIonly</span>&nbsp;<span class="op" id="2247064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247069">if</span>&nbsp;<span class="ident" id="2247072">r</span>&nbsp;<span class="op" id="2247074">&lt;</span>&nbsp;<span class="ident" id="2247076">utf8</span><span class="op" id="2247080">.</span><span class="ident" id="2247081">RuneSelf</span>&nbsp;<span class="op" id="2247090">&amp;&amp;</span>&nbsp;<span class="ident" id="2247093">IsPrint</span><span class="op" id="2247100">(</span><span class="ident" id="2247101">r</span><span class="op" id="2247102">)</span>&nbsp;<span class="op" id="2247104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247110">buf</span>&nbsp;<span class="op" id="2247114">=</span>&nbsp;<span class="builtinfunc" id="2247116">append</span><span class="op" id="2247122">(</span><span class="ident" id="2247123">buf</span><span class="op" id="2247126">,</span>&nbsp;<span class="builtintype" id="2247128">byte</span><span class="op" id="2247132">(</span><span class="ident" id="2247133">r</span><span class="op" id="2247134">)</span><span class="op" id="2247135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247141">continue</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2247153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2247157">}</span>&nbsp;<span class="keyword" id="2247159">else</span>&nbsp;<span class="keyword" id="2247164">if</span>&nbsp;<span class="ident" id="2247167">IsPrint</span><span class="op" id="2247174">(</span><span class="ident" id="2247175">r</span><span class="op" id="2247176">)</span>&nbsp;<span class="op" id="2247178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247183">n</span>&nbsp;<span class="op" id="2247185">:=</span>&nbsp;<span class="ident" id="2247188">utf8</span><span class="op" id="2247192">.</span><span class="ident" id="2247193">EncodeRune</span><span class="op" id="2247203">(</span><span class="ident" id="2247204">runeTmp</span><span class="op" id="2247211">[</span><span class="op" id="2247212">:</span><span class="op" id="2247213">]</span><span class="op" id="2247214">,</span>&nbsp;<span class="ident" id="2247216">r</span><span class="op" id="2247217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247222">buf</span>&nbsp;<span class="op" id="2247226">=</span>&nbsp;<span class="builtinfunc" id="2247228">append</span><span class="op" id="2247234">(</span><span class="ident" id="2247235">buf</span><span class="op" id="2247238">,</span>&nbsp;<span class="ident" id="2247240">runeTmp</span><span class="op" id="2247247">[</span><span class="op" id="2247248">:</span><span class="ident" id="2247249">n</span><span class="op" id="2247250">]</span><span class="op" id="2247251">...</span><span class="op" id="2247254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247259">continue</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2247270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247274">switch</span>&nbsp;<span class="ident" id="2247281">r</span>&nbsp;<span class="op" id="2247283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247287">case</span>&nbsp;<span class="string" id="2247292">&#39;\a&#39;</span><span class="op" id="2247296">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247301">buf</span>&nbsp;<span class="op" id="2247305">=</span>&nbsp;<span class="builtinfunc" id="2247307">append</span><span class="op" id="2247313">(</span><span class="ident" id="2247314">buf</span><span class="op" id="2247317">,</span>&nbsp;<span class="string" id="2247319">`\a`</span><span class="op" id="2247323">...</span><span class="op" id="2247326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247330">case</span>&nbsp;<span class="string" id="2247335">&#39;\b&#39;</span><span class="op" id="2247339">:</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247344">buf</span>&nbsp;<span class="op" id="2247348">=</span>&nbsp;<span class="builtinfunc" id="2247350">append</span><span class="op" id="2247356">(</span><span class="ident" id="2247357">buf</span><span class="op" id="2247360">,</span>&nbsp;<span class="string" id="2247362">`\b`</span><span class="op" id="2247366">...</span><span class="op" id="2247369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247373">case</span>&nbsp;<span class="string" id="2247378">&#39;\f&#39;</span><span class="op" id="2247382">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247387">buf</span>&nbsp;<span class="op" id="2247391">=</span>&nbsp;<span class="builtinfunc" id="2247393">append</span><span class="op" id="2247399">(</span><span class="ident" id="2247400">buf</span><span class="op" id="2247403">,</span>&nbsp;<span class="string" id="2247405">`\f`</span><span class="op" id="2247409">...</span><span class="op" id="2247412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247416">case</span>&nbsp;<span class="string" id="2247421">&#39;\n&#39;</span><span class="op" id="2247425">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247430">buf</span>&nbsp;<span class="op" id="2247434">=</span>&nbsp;<span class="builtinfunc" id="2247436">append</span><span class="op" id="2247442">(</span><span class="ident" id="2247443">buf</span><span class="op" id="2247446">,</span>&nbsp;<span class="string" id="2247448">`\n`</span><span class="op" id="2247452">...</span><span class="op" id="2247455">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247459">case</span>&nbsp;<span class="string" id="2247464">&#39;\r&#39;</span><span class="op" id="2247468">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247473">buf</span>&nbsp;<span class="op" id="2247477">=</span>&nbsp;<span class="builtinfunc" id="2247479">append</span><span class="op" id="2247485">(</span><span class="ident" id="2247486">buf</span><span class="op" id="2247489">,</span>&nbsp;<span class="string" id="2247491">`\r`</span><span class="op" id="2247495">...</span><span class="op" id="2247498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247502">case</span>&nbsp;<span class="string" id="2247507">&#39;\t&#39;</span><span class="op" id="2247511">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247516">buf</span>&nbsp;<span class="op" id="2247520">=</span>&nbsp;<span class="builtinfunc" id="2247522">append</span><span class="op" id="2247528">(</span><span class="ident" id="2247529">buf</span><span class="op" id="2247532">,</span>&nbsp;<span class="string" id="2247534">`\t`</span><span class="op" id="2247538">...</span><span class="op" id="2247541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247545">case</span>&nbsp;<span class="string" id="2247550">&#39;\v&#39;</span><span class="op" id="2247554">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247559">buf</span>&nbsp;<span class="op" id="2247563">=</span>&nbsp;<span class="builtinfunc" id="2247565">append</span><span class="op" id="2247571">(</span><span class="ident" id="2247572">buf</span><span class="op" id="2247575">,</span>&nbsp;<span class="string" id="2247577">`\v`</span><span class="op" id="2247581">...</span><span class="op" id="2247584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247588">default</span><span class="op" id="2247595">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247600">switch</span>&nbsp;<span class="op" id="2247607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247612">case</span>&nbsp;<span class="ident" id="2247617">r</span>&nbsp;<span class="op" id="2247619">&lt;</span>&nbsp;<span class="string" id="2247621">&#39;&nbsp;&#39;</span><span class="op" id="2247624">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247630">buf</span>&nbsp;<span class="op" id="2247634">=</span>&nbsp;<span class="builtinfunc" id="2247636">append</span><span class="op" id="2247642">(</span><span class="ident" id="2247643">buf</span><span class="op" id="2247646">,</span>&nbsp;<span class="string" id="2247648">`\x`</span><span class="op" id="2247652">...</span><span class="op" id="2247655">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247661">buf</span>&nbsp;<span class="op" id="2247665">=</span>&nbsp;<span class="builtinfunc" id="2247667">append</span><span class="op" id="2247673">(</span><span class="ident" id="2247674">buf</span><span class="op" id="2247677">,</span>&nbsp;<span class="ident" id="2247679">lowerhex</span><span class="op" id="2247687">[</span><span class="ident" id="2247688">s</span><span class="op" id="2247689">[</span><span class="num" id="2247690">0</span><span class="op" id="2247691">]</span><span class="op" id="2247692">&gt;&gt;</span><span class="num" id="2247694">4</span><span class="op" id="2247695">]</span><span class="op" id="2247696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247702">buf</span>&nbsp;<span class="op" id="2247706">=</span>&nbsp;<span class="builtinfunc" id="2247708">append</span><span class="op" id="2247714">(</span><span class="ident" id="2247715">buf</span><span class="op" id="2247718">,</span>&nbsp;<span class="ident" id="2247720">lowerhex</span><span class="op" id="2247728">[</span><span class="ident" id="2247729">s</span><span class="op" id="2247730">[</span><span class="num" id="2247731">0</span><span class="op" id="2247732">]</span><span class="op" id="2247733">&amp;</span><span class="num" id="2247734">0xF</span><span class="op" id="2247737">]</span><span class="op" id="2247738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247743">case</span>&nbsp;<span class="ident" id="2247748">r</span>&nbsp;<span class="op" id="2247750">&gt;</span>&nbsp;<span class="ident" id="2247752">utf8</span><span class="op" id="2247756">.</span><span class="ident" id="2247757">MaxRune</span><span class="op" id="2247764">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247770">r</span>&nbsp;<span class="op" id="2247772">=</span>&nbsp;<span class="num" id="2247774">0xFFFD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247785">fallthrough</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247800">case</span>&nbsp;<span class="ident" id="2247805">r</span>&nbsp;<span class="op" id="2247807">&lt;</span>&nbsp;<span class="num" id="2247809">0x10000</span><span class="op" id="2247816">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247822">buf</span>&nbsp;<span class="op" id="2247826">=</span>&nbsp;<span class="builtinfunc" id="2247828">append</span><span class="op" id="2247834">(</span><span class="ident" id="2247835">buf</span><span class="op" id="2247838">,</span>&nbsp;<span class="string" id="2247840">`\u`</span><span class="op" id="2247844">...</span><span class="op" id="2247847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247853">for</span>&nbsp;<span class="ident" id="2247857">s</span>&nbsp;<span class="op" id="2247859">:=</span>&nbsp;<span class="num" id="2247862">12</span><span class="op" id="2247864">;</span>&nbsp;<span class="ident" id="2247866">s</span>&nbsp;<span class="op" id="2247868">&gt;=</span>&nbsp;<span class="num" id="2247871">0</span><span class="op" id="2247872">;</span>&nbsp;<span class="ident" id="2247874">s</span>&nbsp;<span class="op" id="2247876">-=</span>&nbsp;<span class="num" id="2247879">4</span>&nbsp;<span class="op" id="2247881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247888">buf</span>&nbsp;<span class="op" id="2247892">=</span>&nbsp;<span class="builtinfunc" id="2247894">append</span><span class="op" id="2247900">(</span><span class="ident" id="2247901">buf</span><span class="op" id="2247904">,</span>&nbsp;<span class="ident" id="2247906">lowerhex</span><span class="op" id="2247914">[</span><span class="ident" id="2247915">r</span><span class="op" id="2247916">&gt;&gt;</span><span class="builtintype" id="2247918">uint</span><span class="op" id="2247922">(</span><span class="ident" id="2247923">s</span><span class="op" id="2247924">)</span><span class="op" id="2247925">&amp;</span><span class="num" id="2247926">0xF</span><span class="op" id="2247929">]</span><span class="op" id="2247930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2247936">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247941">default</span><span class="op" id="2247948">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247954">buf</span>&nbsp;<span class="op" id="2247958">=</span>&nbsp;<span class="builtinfunc" id="2247960">append</span><span class="op" id="2247966">(</span><span class="ident" id="2247967">buf</span><span class="op" id="2247970">,</span>&nbsp;<span class="string" id="2247972">`\U`</span><span class="op" id="2247976">...</span><span class="op" id="2247979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247985">for</span>&nbsp;<span class="ident" id="2247989">s</span>&nbsp;<span class="op" id="2247991">:=</span>&nbsp;<span class="num" id="2247994">28</span><span class="op" id="2247996">;</span>&nbsp;<span class="ident" id="2247998">s</span>&nbsp;<span class="op" id="2248000">&gt;=</span>&nbsp;<span class="num" id="2248003">0</span><span class="op" id="2248004">;</span>&nbsp;<span class="ident" id="2248006">s</span>&nbsp;<span class="op" id="2248008">-=</span>&nbsp;<span class="num" id="2248011">4</span>&nbsp;<span class="op" id="2248013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248020">buf</span>&nbsp;<span class="op" id="2248024">=</span>&nbsp;<span class="builtinfunc" id="2248026">append</span><span class="op" id="2248032">(</span><span class="ident" id="2248033">buf</span><span class="op" id="2248036">,</span>&nbsp;<span class="ident" id="2248038">lowerhex</span><span class="op" id="2248046">[</span><span class="ident" id="2248047">r</span><span class="op" id="2248048">&gt;&gt;</span><span class="builtintype" id="2248050">uint</span><span class="op" id="2248054">(</span><span class="ident" id="2248055">s</span><span class="op" id="2248056">)</span><span class="op" id="2248057">&amp;</span><span class="num" id="2248058">0xF</span><span class="op" id="2248061">]</span><span class="op" id="2248062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2248068">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2248073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2248077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2248080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248083">buf</span>&nbsp;<span class="op" id="2248087">=</span>&nbsp;<span class="builtinfunc" id="2248089">append</span><span class="op" id="2248095">(</span><span class="ident" id="2248096">buf</span><span class="op" id="2248099">,</span>&nbsp;<span class="ident" id="2248101">quote</span><span class="op" id="2248106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2248109">return</span>&nbsp;<span class="builtintype" id="2248116">string</span><span class="op" id="2248122">(</span><span class="ident" id="2248123">buf</span><span class="op" id="2248126">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="op" id="2248129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2248132">//&nbsp;Quote&nbsp;returns&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s.&nbsp;&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="2248204">//&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)&nbsp;for</span><br>
<span class="lineno">90</span><span class="comment" id="2248275">//&nbsp;control&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2248340">//&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="2248352">func</span>&nbsp;<span class="ident" id="2248357">Quote</span><span class="op" id="2248362">(</span><span class="ident" id="2248363">s</span>&nbsp;<span class="builtintype" id="2248365">string</span><span class="op" id="2248371">)</span>&nbsp;<span class="builtintype" id="2248373">string</span>&nbsp;<span class="op" id="2248380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2248383">return</span>&nbsp;<span class="ident" id="2248390">quoteWith</span><span class="op" id="2248399">(</span><span class="ident" id="2248400">s</span><span class="op" id="2248401">,</span>&nbsp;<span class="string" id="2248403">&#39;&#34;&#39;</span><span class="op" id="2248406">,</span>&nbsp;<span class="builtintype" id="2248408">false</span><span class="op" id="2248413">)</span><br>
<span class="lineno"></span><span class="op" id="2248415">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="2248418">//&nbsp;AppendQuote&nbsp;appends&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s,</span><br>
<span class="lineno"></span><span class="comment" id="2248491">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;Quote,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="keyword" id="2248557">func</span>&nbsp;<span class="ident" id="2248562">AppendQuote</span><span class="op" id="2248573">(</span><span class="ident" id="2248574">dst</span>&nbsp;<span class="op" id="2248578">[</span><span class="op" id="2248579">]</span><span class="builtintype" id="2248580">byte</span><span class="op" id="2248584">,</span>&nbsp;<span class="ident" id="2248586">s</span>&nbsp;<span class="builtintype" id="2248588">string</span><span class="op" id="2248594">)</span>&nbsp;<span class="op" id="2248596">[</span><span class="op" id="2248597">]</span><span class="builtintype" id="2248598">byte</span>&nbsp;<span class="op" id="2248603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2248606">return</span>&nbsp;<span class="builtinfunc" id="2248613">append</span><span class="op" id="2248619">(</span><span class="ident" id="2248620">dst</span><span class="op" id="2248623">,</span>&nbsp;<span class="ident" id="2248625">Quote</span><span class="op" id="2248630">(</span><span class="ident" id="2248631">s</span><span class="op" id="2248632">)</span><span class="op" id="2248633">...</span><span class="op" id="2248636">)</span><br>
<span class="lineno">100</span><span class="op" id="2248638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2248641">//&nbsp;QuoteToASCII&nbsp;returns&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="2248715">//&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="2248790">//&nbsp;non-ASCII&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno">105</span><span class="keyword" id="2248866">func</span>&nbsp;<span class="ident" id="2248871">QuoteToASCII</span><span class="op" id="2248883">(</span><span class="ident" id="2248884">s</span>&nbsp;<span class="builtintype" id="2248886">string</span><span class="op" id="2248892">)</span>&nbsp;<span class="builtintype" id="2248894">string</span>&nbsp;<span class="op" id="2248901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2248904">return</span>&nbsp;<span class="ident" id="2248911">quoteWith</span><span class="op" id="2248920">(</span><span class="ident" id="2248921">s</span><span class="op" id="2248922">,</span>&nbsp;<span class="string" id="2248924">&#39;&#34;&#39;</span><span class="op" id="2248927">,</span>&nbsp;<span class="builtintype" id="2248929">true</span><span class="op" id="2248933">)</span><br>
<span class="lineno"></span><span class="op" id="2248935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2248938">//&nbsp;AppendQuoteToASCII&nbsp;appends&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s,</span><br>
<span class="lineno">110</span><span class="comment" id="2249018">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteToASCII,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="keyword" id="2249091">func</span>&nbsp;<span class="ident" id="2249096">AppendQuoteToASCII</span><span class="op" id="2249114">(</span><span class="ident" id="2249115">dst</span>&nbsp;<span class="op" id="2249119">[</span><span class="op" id="2249120">]</span><span class="builtintype" id="2249121">byte</span><span class="op" id="2249125">,</span>&nbsp;<span class="ident" id="2249127">s</span>&nbsp;<span class="builtintype" id="2249129">string</span><span class="op" id="2249135">)</span>&nbsp;<span class="op" id="2249137">[</span><span class="op" id="2249138">]</span><span class="builtintype" id="2249139">byte</span>&nbsp;<span class="op" id="2249144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2249147">return</span>&nbsp;<span class="builtinfunc" id="2249154">append</span><span class="op" id="2249160">(</span><span class="ident" id="2249161">dst</span><span class="op" id="2249164">,</span>&nbsp;<span class="ident" id="2249166">QuoteToASCII</span><span class="op" id="2249178">(</span><span class="ident" id="2249179">s</span><span class="op" id="2249180">)</span><span class="op" id="2249181">...</span><span class="op" id="2249184">)</span><br>
<span class="lineno"></span><span class="op" id="2249186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="2249189">//&nbsp;QuoteRune&nbsp;returns&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2249264">//&nbsp;rune.&nbsp;&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)</span><br>
<span class="lineno"></span><span class="comment" id="2249342">//&nbsp;for&nbsp;control&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="2249420">func</span>&nbsp;<span class="ident" id="2249425">QuoteRune</span><span class="op" id="2249434">(</span><span class="ident" id="2249435">r</span>&nbsp;<span class="builtintype" id="2249437">rune</span><span class="op" id="2249441">)</span>&nbsp;<span class="builtintype" id="2249443">string</span>&nbsp;<span class="op" id="2249450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2249453">//&nbsp;TODO:&nbsp;avoid&nbsp;the&nbsp;allocation&nbsp;here.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2249490">return</span>&nbsp;<span class="ident" id="2249497">quoteWith</span><span class="op" id="2249506">(</span><span class="builtintype" id="2249507">string</span><span class="op" id="2249513">(</span><span class="ident" id="2249514">r</span><span class="op" id="2249515">)</span><span class="op" id="2249516">,</span>&nbsp;<span class="string" id="2249518">&#39;\&#39;&#39;</span><span class="op" id="2249522">,</span>&nbsp;<span class="builtintype" id="2249524">false</span><span class="op" id="2249529">)</span><br>
<span class="lineno"></span><span class="op" id="2249531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2249534">//&nbsp;AppendQuoteRune&nbsp;appends&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the&nbsp;rune,</span><br>
<span class="lineno"></span><span class="comment" id="2249621">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteRune,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno">125</span><span class="keyword" id="2249691">func</span>&nbsp;<span class="ident" id="2249696">AppendQuoteRune</span><span class="op" id="2249711">(</span><span class="ident" id="2249712">dst</span>&nbsp;<span class="op" id="2249716">[</span><span class="op" id="2249717">]</span><span class="builtintype" id="2249718">byte</span><span class="op" id="2249722">,</span>&nbsp;<span class="ident" id="2249724">r</span>&nbsp;<span class="builtintype" id="2249726">rune</span><span class="op" id="2249730">)</span>&nbsp;<span class="op" id="2249732">[</span><span class="op" id="2249733">]</span><span class="builtintype" id="2249734">byte</span>&nbsp;<span class="op" id="2249739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2249742">return</span>&nbsp;<span class="builtinfunc" id="2249749">append</span><span class="op" id="2249755">(</span><span class="ident" id="2249756">dst</span><span class="op" id="2249759">,</span>&nbsp;<span class="ident" id="2249761">QuoteRune</span><span class="op" id="2249770">(</span><span class="ident" id="2249771">r</span><span class="op" id="2249772">)</span><span class="op" id="2249773">...</span><span class="op" id="2249776">)</span><br>
<span class="lineno"></span><span class="op" id="2249778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2249781">//&nbsp;QuoteRuneToASCII&nbsp;returns&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing</span><br>
<span class="lineno">130</span><span class="comment" id="2249859">//&nbsp;the&nbsp;rune.&nbsp;&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,</span><br>
<span class="lineno"></span><span class="comment" id="2249933">//&nbsp;\u0100)&nbsp;for&nbsp;non-ASCII&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="2250009">//&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="2250024">func</span>&nbsp;<span class="ident" id="2250029">QuoteRuneToASCII</span><span class="op" id="2250045">(</span><span class="ident" id="2250046">r</span>&nbsp;<span class="builtintype" id="2250048">rune</span><span class="op" id="2250052">)</span>&nbsp;<span class="builtintype" id="2250054">string</span>&nbsp;<span class="op" id="2250061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2250064">//&nbsp;TODO:&nbsp;avoid&nbsp;the&nbsp;allocation&nbsp;here.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2250101">return</span>&nbsp;<span class="ident" id="2250108">quoteWith</span><span class="op" id="2250117">(</span><span class="builtintype" id="2250118">string</span><span class="op" id="2250124">(</span><span class="ident" id="2250125">r</span><span class="op" id="2250126">)</span><span class="op" id="2250127">,</span>&nbsp;<span class="string" id="2250129">&#39;\&#39;&#39;</span><span class="op" id="2250133">,</span>&nbsp;<span class="builtintype" id="2250135">true</span><span class="op" id="2250139">)</span><br>
<span class="lineno"></span><span class="op" id="2250141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2250144">//&nbsp;AppendQuoteRuneToASCII&nbsp;appends&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the&nbsp;rune,</span><br>
<span class="lineno"></span><span class="comment" id="2250238">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteRuneToASCII,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno">140</span><span class="keyword" id="2250315">func</span>&nbsp;<span class="ident" id="2250320">AppendQuoteRuneToASCII</span><span class="op" id="2250342">(</span><span class="ident" id="2250343">dst</span>&nbsp;<span class="op" id="2250347">[</span><span class="op" id="2250348">]</span><span class="builtintype" id="2250349">byte</span><span class="op" id="2250353">,</span>&nbsp;<span class="ident" id="2250355">r</span>&nbsp;<span class="builtintype" id="2250357">rune</span><span class="op" id="2250361">)</span>&nbsp;<span class="op" id="2250363">[</span><span class="op" id="2250364">]</span><span class="builtintype" id="2250365">byte</span>&nbsp;<span class="op" id="2250370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2250373">return</span>&nbsp;<span class="builtinfunc" id="2250380">append</span><span class="op" id="2250386">(</span><span class="ident" id="2250387">dst</span><span class="op" id="2250390">,</span>&nbsp;<span class="ident" id="2250392">QuoteRuneToASCII</span><span class="op" id="2250408">(</span><span class="ident" id="2250409">r</span><span class="op" id="2250410">)</span><span class="op" id="2250411">...</span><span class="op" id="2250414">)</span><br>
<span class="lineno"></span><span class="op" id="2250416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2250419">//&nbsp;CanBackquote&nbsp;reports&nbsp;whether&nbsp;the&nbsp;string&nbsp;s&nbsp;can&nbsp;be&nbsp;represented</span><br>
<span class="lineno">145</span><span class="comment" id="2250483">//&nbsp;unchanged&nbsp;as&nbsp;a&nbsp;single-line&nbsp;backquoted&nbsp;string&nbsp;without&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="2250547">//&nbsp;characters&nbsp;other&nbsp;than&nbsp;tab.</span><br>
<span class="lineno"></span><span class="keyword" id="2250577">func</span>&nbsp;<span class="ident" id="2250582">CanBackquote</span><span class="op" id="2250594">(</span><span class="ident" id="2250595">s</span>&nbsp;<span class="builtintype" id="2250597">string</span><span class="op" id="2250603">)</span>&nbsp;<span class="builtintype" id="2250605">bool</span>&nbsp;<span class="op" id="2250610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2250613">for</span>&nbsp;<span class="builtinfunc" id="2250617">len</span><span class="op" id="2250620">(</span><span class="ident" id="2250621">s</span><span class="op" id="2250622">)</span>&nbsp;<span class="op" id="2250624">&gt;</span>&nbsp;<span class="num" id="2250626">0</span>&nbsp;<span class="op" id="2250628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2250632">r</span><span class="op" id="2250633">,</span>&nbsp;<span class="ident" id="2250635">wid</span>&nbsp;<span class="op" id="2250639">:=</span>&nbsp;<span class="ident" id="2250642">utf8</span><span class="op" id="2250646">.</span><span class="ident" id="2250647">DecodeRuneInString</span><span class="op" id="2250665">(</span><span class="ident" id="2250666">s</span><span class="op" id="2250667">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2250671">s</span>&nbsp;<span class="op" id="2250673">=</span>&nbsp;<span class="ident" id="2250675">s</span><span class="op" id="2250676">[</span><span class="ident" id="2250677">wid</span><span class="op" id="2250680">:</span><span class="op" id="2250681">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2250685">if</span>&nbsp;<span class="ident" id="2250688">wid</span>&nbsp;<span class="op" id="2250692">&gt;</span>&nbsp;<span class="num" id="2250694">1</span>&nbsp;<span class="op" id="2250696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2250701">if</span>&nbsp;<span class="ident" id="2250704">r</span>&nbsp;<span class="op" id="2250706">==</span>&nbsp;<span class="string" id="2250709">&#39;\ufeff&#39;</span>&nbsp;<span class="op" id="2250718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2250724">return</span>&nbsp;<span class="builtintype" id="2250731">false</span>&nbsp;<span class="comment" id="2250737">//&nbsp;BOMs&nbsp;are&nbsp;invisible&nbsp;and&nbsp;should&nbsp;not&nbsp;be&nbsp;quoted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250788">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2250793">continue</span>&nbsp;<span class="comment" id="2250802">//&nbsp;All&nbsp;other&nbsp;multibyte&nbsp;runes&nbsp;are&nbsp;correctly&nbsp;encoded&nbsp;and&nbsp;assumed&nbsp;printable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2250882">if</span>&nbsp;<span class="ident" id="2250885">r</span>&nbsp;<span class="op" id="2250887">==</span>&nbsp;<span class="ident" id="2250890">utf8</span><span class="op" id="2250894">.</span><span class="ident" id="2250895">RuneError</span>&nbsp;<span class="op" id="2250905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2250910">return</span>&nbsp;<span class="builtintype" id="2250917">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250925">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2250929">if</span>&nbsp;<span class="op" id="2250932">(</span><span class="ident" id="2250933">r</span>&nbsp;<span class="op" id="2250935">&lt;</span>&nbsp;<span class="string" id="2250937">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2250941">&amp;&amp;</span>&nbsp;<span class="ident" id="2250944">r</span>&nbsp;<span class="op" id="2250946">!=</span>&nbsp;<span class="string" id="2250949">&#39;\t&#39;</span><span class="op" id="2250953">)</span>&nbsp;<span class="op" id="2250955">||</span>&nbsp;<span class="ident" id="2250958">r</span>&nbsp;<span class="op" id="2250960">==</span>&nbsp;<span class="string" id="2250963">&#39;`&#39;</span>&nbsp;<span class="op" id="2250967">||</span>&nbsp;<span class="ident" id="2250970">r</span>&nbsp;<span class="op" id="2250972">==</span>&nbsp;<span class="string" id="2250975">&#39;\u007F&#39;</span>&nbsp;<span class="op" id="2250984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2250989">return</span>&nbsp;<span class="builtintype" id="2250996">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2251010">return</span>&nbsp;<span class="builtintype" id="2251017">true</span><br>
<span class="lineno">165</span><span class="op" id="2251022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2251025">func</span>&nbsp;<span class="ident" id="2251030">unhex</span><span class="op" id="2251035">(</span><span class="ident" id="2251036">b</span>&nbsp;<span class="builtintype" id="2251038">byte</span><span class="op" id="2251042">)</span>&nbsp;<span class="op" id="2251044">(</span><span class="ident" id="2251045">v</span>&nbsp;<span class="builtintype" id="2251047">rune</span><span class="op" id="2251051">,</span>&nbsp;<span class="ident" id="2251053">ok</span>&nbsp;<span class="builtintype" id="2251056">bool</span><span class="op" id="2251060">)</span>&nbsp;<span class="op" id="2251062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2251065">c</span>&nbsp;<span class="op" id="2251067">:=</span>&nbsp;<span class="builtintype" id="2251070">rune</span><span class="op" id="2251074">(</span><span class="ident" id="2251075">b</span><span class="op" id="2251076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2251079">switch</span>&nbsp;<span class="op" id="2251086">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2251089">case</span>&nbsp;<span class="string" id="2251094">&#39;0&#39;</span>&nbsp;<span class="op" id="2251098">&lt;=</span>&nbsp;<span class="ident" id="2251101">c</span>&nbsp;<span class="op" id="2251103">&amp;&amp;</span>&nbsp;<span class="ident" id="2251106">c</span>&nbsp;<span class="op" id="2251108">&lt;=</span>&nbsp;<span class="string" id="2251111">&#39;9&#39;</span><span class="op" id="2251114">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2251118">return</span>&nbsp;<span class="ident" id="2251125">c</span>&nbsp;<span class="op" id="2251127">-</span>&nbsp;<span class="string" id="2251129">&#39;0&#39;</span><span class="op" id="2251132">,</span>&nbsp;<span class="builtintype" id="2251134">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2251140">case</span>&nbsp;<span class="string" id="2251145">&#39;a&#39;</span>&nbsp;<span class="op" id="2251149">&lt;=</span>&nbsp;<span class="ident" id="2251152">c</span>&nbsp;<span class="op" id="2251154">&amp;&amp;</span>&nbsp;<span class="ident" id="2251157">c</span>&nbsp;<span class="op" id="2251159">&lt;=</span>&nbsp;<span class="string" id="2251162">&#39;f&#39;</span><span class="op" id="2251165">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2251169">return</span>&nbsp;<span class="ident" id="2251176">c</span>&nbsp;<span class="op" id="2251178">-</span>&nbsp;<span class="string" id="2251180">&#39;a&#39;</span>&nbsp;<span class="op" id="2251184">+</span>&nbsp;<span class="num" id="2251186">10</span><span class="op" id="2251188">,</span>&nbsp;<span class="builtintype" id="2251190">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2251196">case</span>&nbsp;<span class="string" id="2251201">&#39;A&#39;</span>&nbsp;<span class="op" id="2251205">&lt;=</span>&nbsp;<span class="ident" id="2251208">c</span>&nbsp;<span class="op" id="2251210">&amp;&amp;</span>&nbsp;<span class="ident" id="2251213">c</span>&nbsp;<span class="op" id="2251215">&lt;=</span>&nbsp;<span class="string" id="2251218">&#39;F&#39;</span><span class="op" id="2251221">:</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2251225">return</span>&nbsp;<span class="ident" id="2251232">c</span>&nbsp;<span class="op" id="2251234">-</span>&nbsp;<span class="string" id="2251236">&#39;A&#39;</span>&nbsp;<span class="op" id="2251240">+</span>&nbsp;<span class="num" id="2251242">10</span><span class="op" id="2251244">,</span>&nbsp;<span class="builtintype" id="2251246">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2251255">return</span><br>
<span class="lineno"></span><span class="op" id="2251262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="2251265">//&nbsp;UnquoteChar&nbsp;decodes&nbsp;the&nbsp;first&nbsp;character&nbsp;or&nbsp;byte&nbsp;in&nbsp;the&nbsp;escaped&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="2251338">//&nbsp;or&nbsp;character&nbsp;literal&nbsp;represented&nbsp;by&nbsp;the&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="2251391">//&nbsp;It&nbsp;returns&nbsp;four&nbsp;values:</span><br>
<span class="lineno"></span><span class="comment" id="2251418">//</span><br>
<span class="lineno"></span><span class="comment" id="2251421">//&nbsp;&nbsp;&nbsp;&nbsp1)&nbsp;value,&nbsp;the&nbsp;decoded&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;or&nbsp;byte&nbsp;value;</span><br>
<span class="lineno">185</span><span class="comment" id="2251480">//&nbsp;&nbsp;&nbsp;&nbsp2)&nbsp;multibyte,&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;whether&nbsp;the&nbsp;decoded&nbsp;character&nbsp;requires&nbsp;a&nbsp;multibyte&nbsp;UTF-8&nbsp;representation;</span><br>
<span class="lineno"></span><span class="comment" id="2251591">//&nbsp;&nbsp;&nbsp;&nbsp3)&nbsp;tail,&nbsp;the&nbsp;remainder&nbsp;of&nbsp;the&nbsp;string&nbsp;after&nbsp;the&nbsp;character;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2251656">//&nbsp;&nbsp;&nbsp;&nbsp4)&nbsp;an&nbsp;error&nbsp;that&nbsp;will&nbsp;be&nbsp;nil&nbsp;if&nbsp;the&nbsp;character&nbsp;is&nbsp;syntactically&nbsp;valid.</span><br>
<span class="lineno"></span><span class="comment" id="2251729">//</span><br>
<span class="lineno"></span><span class="comment" id="2251732">//&nbsp;The&nbsp;second&nbsp;argument,&nbsp;quote,&nbsp;specifies&nbsp;the&nbsp;type&nbsp;of&nbsp;literal&nbsp;being&nbsp;parsed</span><br>
<span class="lineno">190</span><span class="comment" id="2251806">//&nbsp;and&nbsp;therefore&nbsp;which&nbsp;escaped&nbsp;quote&nbsp;character&nbsp;is&nbsp;permitted.</span><br>
<span class="lineno"></span><span class="comment" id="2251867">//&nbsp;If&nbsp;set&nbsp;to&nbsp;a&nbsp;single&nbsp;quote,&nbsp;it&nbsp;permits&nbsp;the&nbsp;sequence&nbsp;\&#39;&nbsp;and&nbsp;disallows&nbsp;unescaped&nbsp;&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="2251950">//&nbsp;If&nbsp;set&nbsp;to&nbsp;a&nbsp;double&nbsp;quote,&nbsp;it&nbsp;permits&nbsp;\&#34;&nbsp;and&nbsp;disallows&nbsp;unescaped&nbsp;&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2252020">//&nbsp;If&nbsp;set&nbsp;to&nbsp;zero,&nbsp;it&nbsp;does&nbsp;not&nbsp;permit&nbsp;either&nbsp;escape&nbsp;and&nbsp;allows&nbsp;both&nbsp;quote&nbsp;characters&nbsp;to&nbsp;appear&nbsp;unescaped.</span><br>
<span class="lineno"></span><span class="keyword" id="2252126">func</span>&nbsp;<span class="ident" id="2252131">UnquoteChar</span><span class="op" id="2252142">(</span><span class="ident" id="2252143">s</span>&nbsp;<span class="builtintype" id="2252145">string</span><span class="op" id="2252151">,</span>&nbsp;<span class="ident" id="2252153">quote</span>&nbsp;<span class="builtintype" id="2252159">byte</span><span class="op" id="2252163">)</span>&nbsp;<span class="op" id="2252165">(</span><span class="ident" id="2252166">value</span>&nbsp;<span class="builtintype" id="2252172">rune</span><span class="op" id="2252176">,</span>&nbsp;<span class="ident" id="2252178">multibyte</span>&nbsp;<span class="builtintype" id="2252188">bool</span><span class="op" id="2252192">,</span>&nbsp;<span class="ident" id="2252194">tail</span>&nbsp;<span class="builtintype" id="2252199">string</span><span class="op" id="2252205">,</span>&nbsp;<span class="ident" id="2252207">err</span>&nbsp;<span class="builtintype" id="2252211">error</span><span class="op" id="2252216">)</span>&nbsp;<span class="op" id="2252218">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2252221">//&nbsp;easy&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252236">switch</span>&nbsp;<span class="ident" id="2252243">c</span>&nbsp;<span class="op" id="2252245">:=</span>&nbsp;<span class="ident" id="2252248">s</span><span class="op" id="2252249">[</span><span class="num" id="2252250">0</span><span class="op" id="2252251">]</span><span class="op" id="2252252">;</span>&nbsp;<span class="op" id="2252254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252257">case</span>&nbsp;<span class="ident" id="2252262">c</span>&nbsp;<span class="op" id="2252264">==</span>&nbsp;<span class="ident" id="2252267">quote</span>&nbsp;<span class="op" id="2252273">&amp;&amp;</span>&nbsp;<span class="op" id="2252276">(</span><span class="ident" id="2252277">quote</span>&nbsp;<span class="op" id="2252283">==</span>&nbsp;<span class="string" id="2252286">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="2252291">||</span>&nbsp;<span class="ident" id="2252294">quote</span>&nbsp;<span class="op" id="2252300">==</span>&nbsp;<span class="string" id="2252303">&#39;&#34;&#39;</span><span class="op" id="2252306">)</span><span class="op" id="2252307">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252311">err</span>&nbsp;<span class="op" id="2252315">=</span>&nbsp;<span class="ident" id="2252317">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252329">return</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252337">case</span>&nbsp;<span class="ident" id="2252342">c</span>&nbsp;<span class="op" id="2252344">&gt;=</span>&nbsp;<span class="ident" id="2252347">utf8</span><span class="op" id="2252351">.</span><span class="ident" id="2252352">RuneSelf</span><span class="op" id="2252360">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252364">r</span><span class="op" id="2252365">,</span>&nbsp;<span class="ident" id="2252367">size</span>&nbsp;<span class="op" id="2252372">:=</span>&nbsp;<span class="ident" id="2252375">utf8</span><span class="op" id="2252379">.</span><span class="ident" id="2252380">DecodeRuneInString</span><span class="op" id="2252398">(</span><span class="ident" id="2252399">s</span><span class="op" id="2252400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252404">return</span>&nbsp;<span class="ident" id="2252411">r</span><span class="op" id="2252412">,</span>&nbsp;<span class="builtintype" id="2252414">true</span><span class="op" id="2252418">,</span>&nbsp;<span class="ident" id="2252420">s</span><span class="op" id="2252421">[</span><span class="ident" id="2252422">size</span><span class="op" id="2252426">:</span><span class="op" id="2252427">]</span><span class="op" id="2252428">,</span>&nbsp;<span class="ident" id="2252430">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252435">case</span>&nbsp;<span class="ident" id="2252440">c</span>&nbsp;<span class="op" id="2252442">!=</span>&nbsp;<span class="string" id="2252445">&#39;\\&#39;</span><span class="op" id="2252449">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252453">return</span>&nbsp;<span class="builtintype" id="2252460">rune</span><span class="op" id="2252464">(</span><span class="ident" id="2252465">s</span><span class="op" id="2252466">[</span><span class="num" id="2252467">0</span><span class="op" id="2252468">]</span><span class="op" id="2252469">)</span><span class="op" id="2252470">,</span>&nbsp;<span class="builtintype" id="2252472">false</span><span class="op" id="2252477">,</span>&nbsp;<span class="ident" id="2252479">s</span><span class="op" id="2252480">[</span><span class="num" id="2252481">1</span><span class="op" id="2252482">:</span><span class="op" id="2252483">]</span><span class="op" id="2252484">,</span>&nbsp;<span class="ident" id="2252486">nil</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2252495">//&nbsp;hard&nbsp;case:&nbsp;c&nbsp;is&nbsp;backslash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252525">if</span>&nbsp;<span class="builtinfunc" id="2252528">len</span><span class="op" id="2252531">(</span><span class="ident" id="2252532">s</span><span class="op" id="2252533">)</span>&nbsp;<span class="op" id="2252535">&lt;=</span>&nbsp;<span class="num" id="2252538">1</span>&nbsp;<span class="op" id="2252540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252544">err</span>&nbsp;<span class="op" id="2252548">=</span>&nbsp;<span class="ident" id="2252550">ErrSyntax</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252562">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252573">c</span>&nbsp;<span class="op" id="2252575">:=</span>&nbsp;<span class="ident" id="2252578">s</span><span class="op" id="2252579">[</span><span class="num" id="2252580">1</span><span class="op" id="2252581">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252584">s</span>&nbsp;<span class="op" id="2252586">=</span>&nbsp;<span class="ident" id="2252588">s</span><span class="op" id="2252589">[</span><span class="num" id="2252590">2</span><span class="op" id="2252591">:</span><span class="op" id="2252592">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252596">switch</span>&nbsp;<span class="ident" id="2252603">c</span>&nbsp;<span class="op" id="2252605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252608">case</span>&nbsp;<span class="string" id="2252613">&#39;a&#39;</span><span class="op" id="2252616">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252620">value</span>&nbsp;<span class="op" id="2252626">=</span>&nbsp;<span class="string" id="2252628">&#39;\a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252634">case</span>&nbsp;<span class="string" id="2252639">&#39;b&#39;</span><span class="op" id="2252642">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252646">value</span>&nbsp;<span class="op" id="2252652">=</span>&nbsp;<span class="string" id="2252654">&#39;\b&#39;</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252660">case</span>&nbsp;<span class="string" id="2252665">&#39;f&#39;</span><span class="op" id="2252668">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252672">value</span>&nbsp;<span class="op" id="2252678">=</span>&nbsp;<span class="string" id="2252680">&#39;\f&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252686">case</span>&nbsp;<span class="string" id="2252691">&#39;n&#39;</span><span class="op" id="2252694">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252698">value</span>&nbsp;<span class="op" id="2252704">=</span>&nbsp;<span class="string" id="2252706">&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252712">case</span>&nbsp;<span class="string" id="2252717">&#39;r&#39;</span><span class="op" id="2252720">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252724">value</span>&nbsp;<span class="op" id="2252730">=</span>&nbsp;<span class="string" id="2252732">&#39;\r&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252738">case</span>&nbsp;<span class="string" id="2252743">&#39;t&#39;</span><span class="op" id="2252746">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252750">value</span>&nbsp;<span class="op" id="2252756">=</span>&nbsp;<span class="string" id="2252758">&#39;\t&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252764">case</span>&nbsp;<span class="string" id="2252769">&#39;v&#39;</span><span class="op" id="2252772">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252776">value</span>&nbsp;<span class="op" id="2252782">=</span>&nbsp;<span class="string" id="2252784">&#39;\v&#39;</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252790">case</span>&nbsp;<span class="string" id="2252795">&#39;x&#39;</span><span class="op" id="2252798">,</span>&nbsp;<span class="string" id="2252800">&#39;u&#39;</span><span class="op" id="2252803">,</span>&nbsp;<span class="string" id="2252805">&#39;U&#39;</span><span class="op" id="2252808">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252812">n</span>&nbsp;<span class="op" id="2252814">:=</span>&nbsp;<span class="num" id="2252817">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252821">switch</span>&nbsp;<span class="ident" id="2252828">c</span>&nbsp;<span class="op" id="2252830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252834">case</span>&nbsp;<span class="string" id="2252839">&#39;x&#39;</span><span class="op" id="2252842">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252847">n</span>&nbsp;<span class="op" id="2252849">=</span>&nbsp;<span class="num" id="2252851">2</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252855">case</span>&nbsp;<span class="string" id="2252860">&#39;u&#39;</span><span class="op" id="2252863">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252868">n</span>&nbsp;<span class="op" id="2252870">=</span>&nbsp;<span class="num" id="2252872">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252876">case</span>&nbsp;<span class="string" id="2252881">&#39;U&#39;</span><span class="op" id="2252884">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252889">n</span>&nbsp;<span class="op" id="2252891">=</span>&nbsp;<span class="num" id="2252893">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252897">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252901">var</span>&nbsp;<span class="ident" id="2252905">v</span>&nbsp;<span class="builtintype" id="2252907">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252914">if</span>&nbsp;<span class="builtinfunc" id="2252917">len</span><span class="op" id="2252920">(</span><span class="ident" id="2252921">s</span><span class="op" id="2252922">)</span>&nbsp;<span class="op" id="2252924">&lt;</span>&nbsp;<span class="ident" id="2252926">n</span>&nbsp;<span class="op" id="2252928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252933">err</span>&nbsp;<span class="op" id="2252937">=</span>&nbsp;<span class="ident" id="2252939">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252952">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252961">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252965">for</span>&nbsp;<span class="ident" id="2252969">j</span>&nbsp;<span class="op" id="2252971">:=</span>&nbsp;<span class="num" id="2252974">0</span><span class="op" id="2252975">;</span>&nbsp;<span class="ident" id="2252977">j</span>&nbsp;<span class="op" id="2252979">&lt;</span>&nbsp;<span class="ident" id="2252981">n</span><span class="op" id="2252982">;</span>&nbsp;<span class="ident" id="2252984">j</span><span class="op" id="2252985">++</span>&nbsp;<span class="op" id="2252988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252993">x</span><span class="op" id="2252994">,</span>&nbsp;<span class="ident" id="2252996">ok</span>&nbsp;<span class="op" id="2252999">:=</span>&nbsp;<span class="ident" id="2253002">unhex</span><span class="op" id="2253007">(</span><span class="ident" id="2253008">s</span><span class="op" id="2253009">[</span><span class="ident" id="2253010">j</span><span class="op" id="2253011">]</span><span class="op" id="2253012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253017">if</span>&nbsp;<span class="op" id="2253020">!</span><span class="ident" id="2253021">ok</span>&nbsp;<span class="op" id="2253024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253030">err</span>&nbsp;<span class="op" id="2253034">=</span>&nbsp;<span class="ident" id="2253036">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253050">return</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253065">v</span>&nbsp;<span class="op" id="2253067">=</span>&nbsp;<span class="ident" id="2253069">v</span><span class="op" id="2253070">&lt;&lt;</span><span class="num" id="2253072">4</span>&nbsp;<span class="op" id="2253074">|</span>&nbsp;<span class="ident" id="2253076">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253084">s</span>&nbsp;<span class="op" id="2253086">=</span>&nbsp;<span class="ident" id="2253088">s</span><span class="op" id="2253089">[</span><span class="ident" id="2253090">n</span><span class="op" id="2253091">:</span><span class="op" id="2253092">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253096">if</span>&nbsp;<span class="ident" id="2253099">c</span>&nbsp;<span class="op" id="2253101">==</span>&nbsp;<span class="string" id="2253104">&#39;x&#39;</span>&nbsp;<span class="op" id="2253108">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2253113">//&nbsp;single-byte&nbsp;string,&nbsp;possibly&nbsp;not&nbsp;UTF-8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253158">value</span>&nbsp;<span class="op" id="2253164">=</span>&nbsp;<span class="ident" id="2253166">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253171">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253183">if</span>&nbsp;<span class="ident" id="2253186">v</span>&nbsp;<span class="op" id="2253188">&gt;</span>&nbsp;<span class="ident" id="2253190">utf8</span><span class="op" id="2253194">.</span><span class="ident" id="2253195">MaxRune</span>&nbsp;<span class="op" id="2253203">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253208">err</span>&nbsp;<span class="op" id="2253212">=</span>&nbsp;<span class="ident" id="2253214">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253227">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253240">value</span>&nbsp;<span class="op" id="2253246">=</span>&nbsp;<span class="ident" id="2253248">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253252">multibyte</span>&nbsp;<span class="op" id="2253262">=</span>&nbsp;<span class="builtintype" id="2253264">true</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253270">case</span>&nbsp;<span class="string" id="2253275">&#39;0&#39;</span><span class="op" id="2253278">,</span>&nbsp;<span class="string" id="2253280">&#39;1&#39;</span><span class="op" id="2253283">,</span>&nbsp;<span class="string" id="2253285">&#39;2&#39;</span><span class="op" id="2253288">,</span>&nbsp;<span class="string" id="2253290">&#39;3&#39;</span><span class="op" id="2253293">,</span>&nbsp;<span class="string" id="2253295">&#39;4&#39;</span><span class="op" id="2253298">,</span>&nbsp;<span class="string" id="2253300">&#39;5&#39;</span><span class="op" id="2253303">,</span>&nbsp;<span class="string" id="2253305">&#39;6&#39;</span><span class="op" id="2253308">,</span>&nbsp;<span class="string" id="2253310">&#39;7&#39;</span><span class="op" id="2253313">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253317">v</span>&nbsp;<span class="op" id="2253319">:=</span>&nbsp;<span class="builtintype" id="2253322">rune</span><span class="op" id="2253326">(</span><span class="ident" id="2253327">c</span><span class="op" id="2253328">)</span>&nbsp;<span class="op" id="2253330">-</span>&nbsp;<span class="string" id="2253332">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253338">if</span>&nbsp;<span class="builtinfunc" id="2253341">len</span><span class="op" id="2253344">(</span><span class="ident" id="2253345">s</span><span class="op" id="2253346">)</span>&nbsp;<span class="op" id="2253348">&lt;</span>&nbsp;<span class="num" id="2253350">2</span>&nbsp;<span class="op" id="2253352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253357">err</span>&nbsp;<span class="op" id="2253361">=</span>&nbsp;<span class="ident" id="2253363">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253376">return</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253389">for</span>&nbsp;<span class="ident" id="2253393">j</span>&nbsp;<span class="op" id="2253395">:=</span>&nbsp;<span class="num" id="2253398">0</span><span class="op" id="2253399">;</span>&nbsp;<span class="ident" id="2253401">j</span>&nbsp;<span class="op" id="2253403">&lt;</span>&nbsp;<span class="num" id="2253405">2</span><span class="op" id="2253406">;</span>&nbsp;<span class="ident" id="2253408">j</span><span class="op" id="2253409">++</span>&nbsp;<span class="op" id="2253412">{</span>&nbsp;<span class="comment" id="2253414">//&nbsp;one&nbsp;digit&nbsp;already;&nbsp;two&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253448">x</span>&nbsp;<span class="op" id="2253450">:=</span>&nbsp;<span class="builtintype" id="2253453">rune</span><span class="op" id="2253457">(</span><span class="ident" id="2253458">s</span><span class="op" id="2253459">[</span><span class="ident" id="2253460">j</span><span class="op" id="2253461">]</span><span class="op" id="2253462">)</span>&nbsp;<span class="op" id="2253464">-</span>&nbsp;<span class="string" id="2253466">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253473">if</span>&nbsp;<span class="ident" id="2253476">x</span>&nbsp;<span class="op" id="2253478">&lt;</span>&nbsp;<span class="num" id="2253480">0</span>&nbsp;<span class="op" id="2253482">||</span>&nbsp;<span class="ident" id="2253485">x</span>&nbsp;<span class="op" id="2253487">&gt;</span>&nbsp;<span class="num" id="2253489">7</span>&nbsp;<span class="op" id="2253491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253497">err</span>&nbsp;<span class="op" id="2253501">=</span>&nbsp;<span class="ident" id="2253503">ErrSyntax</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253517">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253532">v</span>&nbsp;<span class="op" id="2253534">=</span>&nbsp;<span class="op" id="2253536">(</span><span class="ident" id="2253537">v</span>&nbsp;<span class="op" id="2253539">&lt;&lt;</span>&nbsp;<span class="num" id="2253542">3</span><span class="op" id="2253543">)</span>&nbsp;<span class="op" id="2253545">|</span>&nbsp;<span class="ident" id="2253547">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253555">s</span>&nbsp;<span class="op" id="2253557">=</span>&nbsp;<span class="ident" id="2253559">s</span><span class="op" id="2253560">[</span><span class="num" id="2253561">2</span><span class="op" id="2253562">:</span><span class="op" id="2253563">]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253567">if</span>&nbsp;<span class="ident" id="2253570">v</span>&nbsp;<span class="op" id="2253572">&gt;</span>&nbsp;<span class="num" id="2253574">255</span>&nbsp;<span class="op" id="2253578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253583">err</span>&nbsp;<span class="op" id="2253587">=</span>&nbsp;<span class="ident" id="2253589">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253602">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253615">value</span>&nbsp;<span class="op" id="2253621">=</span>&nbsp;<span class="ident" id="2253623">v</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253626">case</span>&nbsp;<span class="string" id="2253631">&#39;\\&#39;</span><span class="op" id="2253635">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253639">value</span>&nbsp;<span class="op" id="2253645">=</span>&nbsp;<span class="string" id="2253647">&#39;\\&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253653">case</span>&nbsp;<span class="string" id="2253658">&#39;\&#39;&#39;</span><span class="op" id="2253662">,</span>&nbsp;<span class="string" id="2253664">&#39;&#34;&#39;</span><span class="op" id="2253667">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253671">if</span>&nbsp;<span class="ident" id="2253674">c</span>&nbsp;<span class="op" id="2253676">!=</span>&nbsp;<span class="ident" id="2253679">quote</span>&nbsp;<span class="op" id="2253685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253690">err</span>&nbsp;<span class="op" id="2253694">=</span>&nbsp;<span class="ident" id="2253696">ErrSyntax</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253709">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253722">value</span>&nbsp;<span class="op" id="2253728">=</span>&nbsp;<span class="builtintype" id="2253730">rune</span><span class="op" id="2253734">(</span><span class="ident" id="2253735">c</span><span class="op" id="2253736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253739">default</span><span class="op" id="2253746">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253750">err</span>&nbsp;<span class="op" id="2253754">=</span>&nbsp;<span class="ident" id="2253756">ErrSyntax</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253768">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253779">tail</span>&nbsp;<span class="op" id="2253784">=</span>&nbsp;<span class="ident" id="2253786">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253789">return</span><br>
<span class="lineno"></span><span class="op" id="2253796">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="2253799">//&nbsp;Unquote&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;single-quoted,&nbsp;double-quoted,</span><br>
<span class="lineno"></span><span class="comment" id="2253858">//&nbsp;or&nbsp;backquoted&nbsp;Go&nbsp;string&nbsp;literal,&nbsp;returning&nbsp;the&nbsp;string&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2253921">//&nbsp;that&nbsp;s&nbsp;quotes.&nbsp;&nbsp;(If&nbsp;s&nbsp;is&nbsp;single-quoted,&nbsp;it&nbsp;would&nbsp;be&nbsp;a&nbsp;Go</span><br>
<span class="lineno"></span><span class="comment" id="2253981">//&nbsp;character&nbsp;literal;&nbsp;Unquote&nbsp;returns&nbsp;the&nbsp;corresponding</span><br>
<span class="lineno">305</span><span class="comment" id="2254037">//&nbsp;one-character&nbsp;string.)</span><br>
<span class="lineno"></span><span class="keyword" id="2254063">func</span>&nbsp;<span class="ident" id="2254068">Unquote</span><span class="op" id="2254075">(</span><span class="ident" id="2254076">s</span>&nbsp;<span class="builtintype" id="2254078">string</span><span class="op" id="2254084">)</span>&nbsp;<span class="op" id="2254086">(</span><span class="ident" id="2254087">t</span>&nbsp;<span class="builtintype" id="2254089">string</span><span class="op" id="2254095">,</span>&nbsp;<span class="ident" id="2254097">err</span>&nbsp;<span class="builtintype" id="2254101">error</span><span class="op" id="2254106">)</span>&nbsp;<span class="op" id="2254108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254111">n</span>&nbsp;<span class="op" id="2254113">:=</span>&nbsp;<span class="builtinfunc" id="2254116">len</span><span class="op" id="2254119">(</span><span class="ident" id="2254120">s</span><span class="op" id="2254121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254124">if</span>&nbsp;<span class="ident" id="2254127">n</span>&nbsp;<span class="op" id="2254129">&lt;</span>&nbsp;<span class="num" id="2254131">2</span>&nbsp;<span class="op" id="2254133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254137">return</span>&nbsp;<span class="string" id="2254144">&#34;&#34;</span><span class="op" id="2254146">,</span>&nbsp;<span class="ident" id="2254148">ErrSyntax</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2254159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254162">quote</span>&nbsp;<span class="op" id="2254168">:=</span>&nbsp;<span class="ident" id="2254171">s</span><span class="op" id="2254172">[</span><span class="num" id="2254173">0</span><span class="op" id="2254174">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254177">if</span>&nbsp;<span class="ident" id="2254180">quote</span>&nbsp;<span class="op" id="2254186">!=</span>&nbsp;<span class="ident" id="2254189">s</span><span class="op" id="2254190">[</span><span class="ident" id="2254191">n</span><span class="op" id="2254192">-</span><span class="num" id="2254193">1</span><span class="op" id="2254194">]</span>&nbsp;<span class="op" id="2254196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254200">return</span>&nbsp;<span class="string" id="2254207">&#34;&#34;</span><span class="op" id="2254209">,</span>&nbsp;<span class="ident" id="2254211">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2254222">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254225">s</span>&nbsp;<span class="op" id="2254227">=</span>&nbsp;<span class="ident" id="2254229">s</span><span class="op" id="2254230">[</span><span class="num" id="2254231">1</span>&nbsp;<span class="op" id="2254233">:</span>&nbsp;<span class="ident" id="2254235">n</span><span class="op" id="2254236">-</span><span class="num" id="2254237">1</span><span class="op" id="2254238">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254242">if</span>&nbsp;<span class="ident" id="2254245">quote</span>&nbsp;<span class="op" id="2254251">==</span>&nbsp;<span class="string" id="2254254">&#39;`&#39;</span>&nbsp;<span class="op" id="2254258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254262">if</span>&nbsp;<span class="ident" id="2254265">contains</span><span class="op" id="2254273">(</span><span class="ident" id="2254274">s</span><span class="op" id="2254275">,</span>&nbsp;<span class="string" id="2254277">&#39;`&#39;</span><span class="op" id="2254280">)</span>&nbsp;<span class="op" id="2254282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254287">return</span>&nbsp;<span class="string" id="2254294">&#34;&#34;</span><span class="op" id="2254296">,</span>&nbsp;<span class="ident" id="2254298">ErrSyntax</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2254310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254314">return</span>&nbsp;<span class="ident" id="2254321">s</span><span class="op" id="2254322">,</span>&nbsp;<span class="ident" id="2254324">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2254329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254332">if</span>&nbsp;<span class="ident" id="2254335">quote</span>&nbsp;<span class="op" id="2254341">!=</span>&nbsp;<span class="string" id="2254344">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2254348">&amp;&amp;</span>&nbsp;<span class="ident" id="2254351">quote</span>&nbsp;<span class="op" id="2254357">!=</span>&nbsp;<span class="string" id="2254360">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="2254365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254369">return</span>&nbsp;<span class="string" id="2254376">&#34;&#34;</span><span class="op" id="2254378">,</span>&nbsp;<span class="ident" id="2254380">ErrSyntax</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2254391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254394">if</span>&nbsp;<span class="ident" id="2254397">contains</span><span class="op" id="2254405">(</span><span class="ident" id="2254406">s</span><span class="op" id="2254407">,</span>&nbsp;<span class="string" id="2254409">&#39;\n&#39;</span><span class="op" id="2254413">)</span>&nbsp;<span class="op" id="2254415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254419">return</span>&nbsp;<span class="string" id="2254426">&#34;&#34;</span><span class="op" id="2254428">,</span>&nbsp;<span class="ident" id="2254430">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2254441">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2254445">//&nbsp;Is&nbsp;it&nbsp;trivial?&nbsp;&nbsp;Avoid&nbsp;allocation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254483">if</span>&nbsp;<span class="op" id="2254486">!</span><span class="ident" id="2254487">contains</span><span class="op" id="2254495">(</span><span class="ident" id="2254496">s</span><span class="op" id="2254497">,</span>&nbsp;<span class="string" id="2254499">&#39;\\&#39;</span><span class="op" id="2254503">)</span>&nbsp;<span class="op" id="2254505">&amp;&amp;</span>&nbsp;<span class="op" id="2254508">!</span><span class="ident" id="2254509">contains</span><span class="op" id="2254517">(</span><span class="ident" id="2254518">s</span><span class="op" id="2254519">,</span>&nbsp;<span class="ident" id="2254521">quote</span><span class="op" id="2254526">)</span>&nbsp;<span class="op" id="2254528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254532">switch</span>&nbsp;<span class="ident" id="2254539">quote</span>&nbsp;<span class="op" id="2254545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254549">case</span>&nbsp;<span class="string" id="2254554">&#39;&#34;&#39;</span><span class="op" id="2254557">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254562">return</span>&nbsp;<span class="ident" id="2254569">s</span><span class="op" id="2254570">,</span>&nbsp;<span class="ident" id="2254572">nil</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254578">case</span>&nbsp;<span class="string" id="2254583">&#39;\&#39;&#39;</span><span class="op" id="2254587">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254592">r</span><span class="op" id="2254593">,</span>&nbsp;<span class="ident" id="2254595">size</span>&nbsp;<span class="op" id="2254600">:=</span>&nbsp;<span class="ident" id="2254603">utf8</span><span class="op" id="2254607">.</span><span class="ident" id="2254608">DecodeRuneInString</span><span class="op" id="2254626">(</span><span class="ident" id="2254627">s</span><span class="op" id="2254628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254633">if</span>&nbsp;<span class="ident" id="2254636">size</span>&nbsp;<span class="op" id="2254641">==</span>&nbsp;<span class="builtinfunc" id="2254644">len</span><span class="op" id="2254647">(</span><span class="ident" id="2254648">s</span><span class="op" id="2254649">)</span>&nbsp;<span class="op" id="2254651">&amp;&amp;</span>&nbsp;<span class="op" id="2254654">(</span><span class="ident" id="2254655">r</span>&nbsp;<span class="op" id="2254657">!=</span>&nbsp;<span class="ident" id="2254660">utf8</span><span class="op" id="2254664">.</span><span class="ident" id="2254665">RuneError</span>&nbsp;<span class="op" id="2254675">||</span>&nbsp;<span class="ident" id="2254678">size</span>&nbsp;<span class="op" id="2254683">!=</span>&nbsp;<span class="num" id="2254686">1</span><span class="op" id="2254687">)</span>&nbsp;<span class="op" id="2254689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254695">return</span>&nbsp;<span class="ident" id="2254702">s</span><span class="op" id="2254703">,</span>&nbsp;<span class="ident" id="2254705">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2254712">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2254716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2254719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254723">var</span>&nbsp;<span class="ident" id="2254727">runeTmp</span>&nbsp;<span class="op" id="2254735">[</span><span class="ident" id="2254736">utf8</span><span class="op" id="2254740">.</span><span class="ident" id="2254741">UTFMax</span><span class="op" id="2254747">]</span><span class="builtintype" id="2254748">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254754">buf</span>&nbsp;<span class="op" id="2254758">:=</span>&nbsp;<span class="builtinfunc" id="2254761">make</span><span class="op" id="2254765">(</span><span class="op" id="2254766">[</span><span class="op" id="2254767">]</span><span class="builtintype" id="2254768">byte</span><span class="op" id="2254772">,</span>&nbsp;<span class="num" id="2254774">0</span><span class="op" id="2254775">,</span>&nbsp;<span class="num" id="2254777">3</span><span class="op" id="2254778">*</span><span class="builtinfunc" id="2254779">len</span><span class="op" id="2254782">(</span><span class="ident" id="2254783">s</span><span class="op" id="2254784">)</span><span class="op" id="2254785">/</span><span class="num" id="2254786">2</span><span class="op" id="2254787">)</span>&nbsp;<span class="comment" id="2254789">//&nbsp;Try&nbsp;to&nbsp;avoid&nbsp;more&nbsp;allocations.</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254824">for</span>&nbsp;<span class="builtinfunc" id="2254828">len</span><span class="op" id="2254831">(</span><span class="ident" id="2254832">s</span><span class="op" id="2254833">)</span>&nbsp;<span class="op" id="2254835">&gt;</span>&nbsp;<span class="num" id="2254837">0</span>&nbsp;<span class="op" id="2254839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254843">c</span><span class="op" id="2254844">,</span>&nbsp;<span class="ident" id="2254846">multibyte</span><span class="op" id="2254855">,</span>&nbsp;<span class="ident" id="2254857">ss</span><span class="op" id="2254859">,</span>&nbsp;<span class="ident" id="2254861">err</span>&nbsp;<span class="op" id="2254865">:=</span>&nbsp;<span class="ident" id="2254868">UnquoteChar</span><span class="op" id="2254879">(</span><span class="ident" id="2254880">s</span><span class="op" id="2254881">,</span>&nbsp;<span class="ident" id="2254883">quote</span><span class="op" id="2254888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254892">if</span>&nbsp;<span class="ident" id="2254895">err</span>&nbsp;<span class="op" id="2254899">!=</span>&nbsp;<span class="ident" id="2254902">nil</span>&nbsp;<span class="op" id="2254906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254911">return</span>&nbsp;<span class="string" id="2254918">&#34;&#34;</span><span class="op" id="2254920">,</span>&nbsp;<span class="ident" id="2254922">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2254928">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254932">s</span>&nbsp;<span class="op" id="2254934">=</span>&nbsp;<span class="ident" id="2254936">ss</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254941">if</span>&nbsp;<span class="ident" id="2254944">c</span>&nbsp;<span class="op" id="2254946">&lt;</span>&nbsp;<span class="ident" id="2254948">utf8</span><span class="op" id="2254952">.</span><span class="ident" id="2254953">RuneSelf</span>&nbsp;<span class="op" id="2254962">||</span>&nbsp;<span class="op" id="2254965">!</span><span class="ident" id="2254966">multibyte</span>&nbsp;<span class="op" id="2254976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254981">buf</span>&nbsp;<span class="op" id="2254985">=</span>&nbsp;<span class="builtinfunc" id="2254987">append</span><span class="op" id="2254993">(</span><span class="ident" id="2254994">buf</span><span class="op" id="2254997">,</span>&nbsp;<span class="builtintype" id="2254999">byte</span><span class="op" id="2255003">(</span><span class="ident" id="2255004">c</span><span class="op" id="2255005">)</span><span class="op" id="2255006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255010">}</span>&nbsp;<span class="keyword" id="2255012">else</span>&nbsp;<span class="op" id="2255017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255022">n</span>&nbsp;<span class="op" id="2255024">:=</span>&nbsp;<span class="ident" id="2255027">utf8</span><span class="op" id="2255031">.</span><span class="ident" id="2255032">EncodeRune</span><span class="op" id="2255042">(</span><span class="ident" id="2255043">runeTmp</span><span class="op" id="2255050">[</span><span class="op" id="2255051">:</span><span class="op" id="2255052">]</span><span class="op" id="2255053">,</span>&nbsp;<span class="ident" id="2255055">c</span><span class="op" id="2255056">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255061">buf</span>&nbsp;<span class="op" id="2255065">=</span>&nbsp;<span class="builtinfunc" id="2255067">append</span><span class="op" id="2255073">(</span><span class="ident" id="2255074">buf</span><span class="op" id="2255077">,</span>&nbsp;<span class="ident" id="2255079">runeTmp</span><span class="op" id="2255086">[</span><span class="op" id="2255087">:</span><span class="ident" id="2255088">n</span><span class="op" id="2255089">]</span><span class="op" id="2255090">...</span><span class="op" id="2255093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255101">if</span>&nbsp;<span class="ident" id="2255104">quote</span>&nbsp;<span class="op" id="2255110">==</span>&nbsp;<span class="string" id="2255113">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="2255118">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2255121">len</span><span class="op" id="2255124">(</span><span class="ident" id="2255125">s</span><span class="op" id="2255126">)</span>&nbsp;<span class="op" id="2255128">!=</span>&nbsp;<span class="num" id="2255131">0</span>&nbsp;<span class="op" id="2255133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2255138">//&nbsp;single-quoted&nbsp;must&nbsp;be&nbsp;single&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255183">return</span>&nbsp;<span class="string" id="2255190">&#34;&#34;</span><span class="op" id="2255192">,</span>&nbsp;<span class="ident" id="2255194">ErrSyntax</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255212">return</span>&nbsp;<span class="builtintype" id="2255219">string</span><span class="op" id="2255225">(</span><span class="ident" id="2255226">buf</span><span class="op" id="2255229">)</span><span class="op" id="2255230">,</span>&nbsp;<span class="ident" id="2255232">nil</span><br>
<span class="lineno"></span><span class="op" id="2255236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="2255239">//&nbsp;contains&nbsp;reports&nbsp;whether&nbsp;the&nbsp;string&nbsp;contains&nbsp;the&nbsp;byte&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="2255299">func</span>&nbsp;<span class="ident" id="2255304">contains</span><span class="op" id="2255312">(</span><span class="ident" id="2255313">s</span>&nbsp;<span class="builtintype" id="2255315">string</span><span class="op" id="2255321">,</span>&nbsp;<span class="ident" id="2255323">c</span>&nbsp;<span class="builtintype" id="2255325">byte</span><span class="op" id="2255329">)</span>&nbsp;<span class="builtintype" id="2255331">bool</span>&nbsp;<span class="op" id="2255336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255339">for</span>&nbsp;<span class="ident" id="2255343">i</span>&nbsp;<span class="op" id="2255345">:=</span>&nbsp;<span class="num" id="2255348">0</span><span class="op" id="2255349">;</span>&nbsp;<span class="ident" id="2255351">i</span>&nbsp;<span class="op" id="2255353">&lt;</span>&nbsp;<span class="builtinfunc" id="2255355">len</span><span class="op" id="2255358">(</span><span class="ident" id="2255359">s</span><span class="op" id="2255360">)</span><span class="op" id="2255361">;</span>&nbsp;<span class="ident" id="2255363">i</span><span class="op" id="2255364">++</span>&nbsp;<span class="op" id="2255367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255371">if</span>&nbsp;<span class="ident" id="2255374">s</span><span class="op" id="2255375">[</span><span class="ident" id="2255376">i</span><span class="op" id="2255377">]</span>&nbsp;<span class="op" id="2255379">==</span>&nbsp;<span class="ident" id="2255382">c</span>&nbsp;<span class="op" id="2255384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255389">return</span>&nbsp;<span class="builtintype" id="2255396">true</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255409">return</span>&nbsp;<span class="builtintype" id="2255416">false</span><br>
<span class="lineno"></span><span class="op" id="2255422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="2255425">//&nbsp;bsearch16&nbsp;returns&nbsp;the&nbsp;smallest&nbsp;i&nbsp;such&nbsp;that&nbsp;a[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2255482">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;i,&nbsp;bsearch16&nbsp;returns&nbsp;len(a).</span><br>
<span class="lineno"></span><span class="keyword" id="2255534">func</span>&nbsp;<span class="ident" id="2255539">bsearch16</span><span class="op" id="2255548">(</span><span class="ident" id="2255549">a</span>&nbsp;<span class="op" id="2255551">[</span><span class="op" id="2255552">]</span><span class="builtintype" id="2255553">uint16</span><span class="op" id="2255559">,</span>&nbsp;<span class="ident" id="2255561">x</span>&nbsp;<span class="builtintype" id="2255563">uint16</span><span class="op" id="2255569">)</span>&nbsp;<span class="builtintype" id="2255571">int</span>&nbsp;<span class="op" id="2255575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255578">i</span><span class="op" id="2255579">,</span>&nbsp;<span class="ident" id="2255581">j</span>&nbsp;<span class="op" id="2255583">:=</span>&nbsp;<span class="num" id="2255586">0</span><span class="op" id="2255587">,</span>&nbsp;<span class="builtinfunc" id="2255589">len</span><span class="op" id="2255592">(</span><span class="ident" id="2255593">a</span><span class="op" id="2255594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255597">for</span>&nbsp;<span class="ident" id="2255601">i</span>&nbsp;<span class="op" id="2255603">&lt;</span>&nbsp;<span class="ident" id="2255605">j</span>&nbsp;<span class="op" id="2255607">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255611">h</span>&nbsp;<span class="op" id="2255613">:=</span>&nbsp;<span class="ident" id="2255616">i</span>&nbsp;<span class="op" id="2255618">+</span>&nbsp;<span class="op" id="2255620">(</span><span class="ident" id="2255621">j</span><span class="op" id="2255622">-</span><span class="ident" id="2255623">i</span><span class="op" id="2255624">)</span><span class="op" id="2255625">/</span><span class="num" id="2255626">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255630">if</span>&nbsp;<span class="ident" id="2255633">a</span><span class="op" id="2255634">[</span><span class="ident" id="2255635">h</span><span class="op" id="2255636">]</span>&nbsp;<span class="op" id="2255638">&lt;</span>&nbsp;<span class="ident" id="2255640">x</span>&nbsp;<span class="op" id="2255642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255647">i</span>&nbsp;<span class="op" id="2255649">=</span>&nbsp;<span class="ident" id="2255651">h</span>&nbsp;<span class="op" id="2255653">+</span>&nbsp;<span class="num" id="2255655">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255659">}</span>&nbsp;<span class="keyword" id="2255661">else</span>&nbsp;<span class="op" id="2255666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255671">j</span>&nbsp;<span class="op" id="2255673">=</span>&nbsp;<span class="ident" id="2255675">h</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255685">return</span>&nbsp;<span class="ident" id="2255692">i</span><br>
<span class="lineno"></span><span class="op" id="2255694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="comment" id="2255697">//&nbsp;bsearch32&nbsp;returns&nbsp;the&nbsp;smallest&nbsp;i&nbsp;such&nbsp;that&nbsp;a[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2255754">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;i,&nbsp;bsearch32&nbsp;returns&nbsp;len(a).</span><br>
<span class="lineno"></span><span class="keyword" id="2255806">func</span>&nbsp;<span class="ident" id="2255811">bsearch32</span><span class="op" id="2255820">(</span><span class="ident" id="2255821">a</span>&nbsp;<span class="op" id="2255823">[</span><span class="op" id="2255824">]</span><span class="builtintype" id="2255825">uint32</span><span class="op" id="2255831">,</span>&nbsp;<span class="ident" id="2255833">x</span>&nbsp;<span class="builtintype" id="2255835">uint32</span><span class="op" id="2255841">)</span>&nbsp;<span class="builtintype" id="2255843">int</span>&nbsp;<span class="op" id="2255847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255850">i</span><span class="op" id="2255851">,</span>&nbsp;<span class="ident" id="2255853">j</span>&nbsp;<span class="op" id="2255855">:=</span>&nbsp;<span class="num" id="2255858">0</span><span class="op" id="2255859">,</span>&nbsp;<span class="builtinfunc" id="2255861">len</span><span class="op" id="2255864">(</span><span class="ident" id="2255865">a</span><span class="op" id="2255866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255869">for</span>&nbsp;<span class="ident" id="2255873">i</span>&nbsp;<span class="op" id="2255875">&lt;</span>&nbsp;<span class="ident" id="2255877">j</span>&nbsp;<span class="op" id="2255879">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255883">h</span>&nbsp;<span class="op" id="2255885">:=</span>&nbsp;<span class="ident" id="2255888">i</span>&nbsp;<span class="op" id="2255890">+</span>&nbsp;<span class="op" id="2255892">(</span><span class="ident" id="2255893">j</span><span class="op" id="2255894">-</span><span class="ident" id="2255895">i</span><span class="op" id="2255896">)</span><span class="op" id="2255897">/</span><span class="num" id="2255898">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255902">if</span>&nbsp;<span class="ident" id="2255905">a</span><span class="op" id="2255906">[</span><span class="ident" id="2255907">h</span><span class="op" id="2255908">]</span>&nbsp;<span class="op" id="2255910">&lt;</span>&nbsp;<span class="ident" id="2255912">x</span>&nbsp;<span class="op" id="2255914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255919">i</span>&nbsp;<span class="op" id="2255921">=</span>&nbsp;<span class="ident" id="2255923">h</span>&nbsp;<span class="op" id="2255925">+</span>&nbsp;<span class="num" id="2255927">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255931">}</span>&nbsp;<span class="keyword" id="2255933">else</span>&nbsp;<span class="op" id="2255938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255943">j</span>&nbsp;<span class="op" id="2255945">=</span>&nbsp;<span class="ident" id="2255947">h</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255957">return</span>&nbsp;<span class="ident" id="2255964">i</span><br>
<span class="lineno"></span><span class="op" id="2255966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="comment" id="2255969">//&nbsp;TODO:&nbsp;IsPrint&nbsp;is&nbsp;a&nbsp;local&nbsp;implementation&nbsp;of&nbsp;unicode.IsPrint,&nbsp;verified&nbsp;by&nbsp;the&nbsp;tests</span><br>
<span class="lineno"></span><span class="comment" id="2256054">//&nbsp;to&nbsp;give&nbsp;the&nbsp;same&nbsp;answer.&nbsp;It&nbsp;allows&nbsp;this&nbsp;package&nbsp;not&nbsp;to&nbsp;depend&nbsp;on&nbsp;unicode,</span><br>
<span class="lineno"></span><span class="comment" id="2256131">//&nbsp;and&nbsp;therefore&nbsp;not&nbsp;pull&nbsp;in&nbsp;all&nbsp;the&nbsp;Unicode&nbsp;tables.&nbsp;If&nbsp;the&nbsp;linker&nbsp;were&nbsp;better</span><br>
<span class="lineno"></span><span class="comment" id="2256210">//&nbsp;at&nbsp;tossing&nbsp;unused&nbsp;tables,&nbsp;we&nbsp;could&nbsp;get&nbsp;rid&nbsp;of&nbsp;this&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="comment" id="2256280">//&nbsp;That&nbsp;would&nbsp;be&nbsp;nice.</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span><span class="comment" id="2256304">//&nbsp;IsPrint&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;defined&nbsp;as&nbsp;printable&nbsp;by&nbsp;Go,&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="2256376">//&nbsp;the&nbsp;same&nbsp;definition&nbsp;as&nbsp;unicode.IsPrint:&nbsp;letters,&nbsp;numbers,&nbsp;punctuation,</span><br>
<span class="lineno"></span><span class="comment" id="2256450">//&nbsp;symbols&nbsp;and&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="2256478">func</span>&nbsp;<span class="ident" id="2256483">IsPrint</span><span class="op" id="2256490">(</span><span class="ident" id="2256491">r</span>&nbsp;<span class="builtintype" id="2256493">rune</span><span class="op" id="2256497">)</span>&nbsp;<span class="builtintype" id="2256499">bool</span>&nbsp;<span class="op" id="2256504">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2256507">//&nbsp;Fast&nbsp;check&nbsp;for&nbsp;Latin-1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2256534">if</span>&nbsp;<span class="ident" id="2256537">r</span>&nbsp;<span class="op" id="2256539">&lt;=</span>&nbsp;<span class="num" id="2256542">0xFF</span>&nbsp;<span class="op" id="2256547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2256551">if</span>&nbsp;<span class="num" id="2256554">0x20</span>&nbsp;<span class="op" id="2256559">&lt;=</span>&nbsp;<span class="ident" id="2256562">r</span>&nbsp;<span class="op" id="2256564">&amp;&amp;</span>&nbsp;<span class="ident" id="2256567">r</span>&nbsp;<span class="op" id="2256569">&lt;=</span>&nbsp;<span class="num" id="2256572">0x7E</span>&nbsp;<span class="op" id="2256577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2256582">//&nbsp;All&nbsp;the&nbsp;ASCII&nbsp;is&nbsp;printable&nbsp;from&nbsp;space&nbsp;through&nbsp;DEL-1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2256641">return</span>&nbsp;<span class="builtintype" id="2256648">true</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2256655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2256659">if</span>&nbsp;<span class="num" id="2256662">0xA1</span>&nbsp;<span class="op" id="2256667">&lt;=</span>&nbsp;<span class="ident" id="2256670">r</span>&nbsp;<span class="op" id="2256672">&amp;&amp;</span>&nbsp;<span class="ident" id="2256675">r</span>&nbsp;<span class="op" id="2256677">&lt;=</span>&nbsp;<span class="num" id="2256680">0xFF</span>&nbsp;<span class="op" id="2256685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2256690">//&nbsp;Similarly&nbsp;for&nbsp;&nbsp;through&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2256727">return</span>&nbsp;<span class="ident" id="2256734">r</span>&nbsp;<span class="op" id="2256736">!=</span>&nbsp;<span class="num" id="2256739">0xAD</span>&nbsp;<span class="comment" id="2256744">//&nbsp;...except&nbsp;for&nbsp;the&nbsp;bizarre&nbsp;soft&nbsp;hyphen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2256788">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2256792">return</span>&nbsp;<span class="builtintype" id="2256799">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2256806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2256810">//&nbsp;Same&nbsp;algorithm,&nbsp;either&nbsp;on&nbsp;uint16&nbsp;or&nbsp;uint32&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2256864">//&nbsp;First,&nbsp;find&nbsp;first&nbsp;i&nbsp;such&nbsp;that&nbsp;isPrint[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2256915">//&nbsp;This&nbsp;is&nbsp;the&nbsp;index&nbsp;of&nbsp;either&nbsp;the&nbsp;start&nbsp;or&nbsp;end&nbsp;of&nbsp;a&nbsp;pair&nbsp;that&nbsp;might&nbsp;span&nbsp;x.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2256993">//&nbsp;The&nbsp;start&nbsp;is&nbsp;even&nbsp;(isPrint[i&amp;^1])&nbsp;and&nbsp;the&nbsp;end&nbsp;is&nbsp;odd&nbsp;(isPrint[i|1]).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2257066">//&nbsp;If&nbsp;we&nbsp;find&nbsp;x&nbsp;in&nbsp;a&nbsp;range,&nbsp;make&nbsp;sure&nbsp;x&nbsp;is&nbsp;not&nbsp;in&nbsp;isNotPrint&nbsp;list.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2257135">if</span>&nbsp;<span class="num" id="2257138">0</span>&nbsp;<span class="op" id="2257140">&lt;=</span>&nbsp;<span class="ident" id="2257143">r</span>&nbsp;<span class="op" id="2257145">&amp;&amp;</span>&nbsp;<span class="ident" id="2257148">r</span>&nbsp;<span class="op" id="2257150">&lt;</span>&nbsp;<span class="num" id="2257152">1</span><span class="op" id="2257153">&lt;&lt;</span><span class="num" id="2257155">16</span>&nbsp;<span class="op" id="2257158">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2257162">rr</span><span class="op" id="2257164">,</span>&nbsp;<span class="ident" id="2257166">isPrint</span><span class="op" id="2257173">,</span>&nbsp;<span class="ident" id="2257175">isNotPrint</span>&nbsp;<span class="op" id="2257186">:=</span>&nbsp;<span class="builtintype" id="2257189">uint16</span><span class="op" id="2257195">(</span><span class="ident" id="2257196">r</span><span class="op" id="2257197">)</span><span class="op" id="2257198">,</span>&nbsp;<span class="ident" id="2257200">isPrint16</span><span class="op" id="2257209">,</span>&nbsp;<span class="ident" id="2257211">isNotPrint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2257226">i</span>&nbsp;<span class="op" id="2257228">:=</span>&nbsp;<span class="ident" id="2257231">bsearch16</span><span class="op" id="2257240">(</span><span class="ident" id="2257241">isPrint</span><span class="op" id="2257248">,</span>&nbsp;<span class="ident" id="2257250">rr</span><span class="op" id="2257252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2257256">if</span>&nbsp;<span class="ident" id="2257259">i</span>&nbsp;<span class="op" id="2257261">&gt;=</span>&nbsp;<span class="builtinfunc" id="2257264">len</span><span class="op" id="2257267">(</span><span class="ident" id="2257268">isPrint</span><span class="op" id="2257275">)</span>&nbsp;<span class="op" id="2257277">||</span>&nbsp;<span class="ident" id="2257280">rr</span>&nbsp;<span class="op" id="2257283">&lt;</span>&nbsp;<span class="ident" id="2257285">isPrint</span><span class="op" id="2257292">[</span><span class="ident" id="2257293">i</span><span class="op" id="2257294">&amp;^</span><span class="num" id="2257296">1</span><span class="op" id="2257297">]</span>&nbsp;<span class="op" id="2257299">||</span>&nbsp;<span class="ident" id="2257302">isPrint</span><span class="op" id="2257309">[</span><span class="ident" id="2257310">i</span><span class="op" id="2257311">|</span><span class="num" id="2257312">1</span><span class="op" id="2257313">]</span>&nbsp;<span class="op" id="2257315">&lt;</span>&nbsp;<span class="ident" id="2257317">rr</span>&nbsp;<span class="op" id="2257320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2257325">return</span>&nbsp;<span class="builtintype" id="2257332">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257340">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2257344">j</span>&nbsp;<span class="op" id="2257346">:=</span>&nbsp;<span class="ident" id="2257349">bsearch16</span><span class="op" id="2257358">(</span><span class="ident" id="2257359">isNotPrint</span><span class="op" id="2257369">,</span>&nbsp;<span class="ident" id="2257371">rr</span><span class="op" id="2257373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2257377">return</span>&nbsp;<span class="ident" id="2257384">j</span>&nbsp;<span class="op" id="2257386">&gt;=</span>&nbsp;<span class="builtinfunc" id="2257389">len</span><span class="op" id="2257392">(</span><span class="ident" id="2257393">isNotPrint</span><span class="op" id="2257403">)</span>&nbsp;<span class="op" id="2257405">||</span>&nbsp;<span class="ident" id="2257408">isNotPrint</span><span class="op" id="2257418">[</span><span class="ident" id="2257419">j</span><span class="op" id="2257420">]</span>&nbsp;<span class="op" id="2257422">!=</span>&nbsp;<span class="ident" id="2257425">rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2257433">rr</span><span class="op" id="2257435">,</span>&nbsp;<span class="ident" id="2257437">isPrint</span><span class="op" id="2257444">,</span>&nbsp;<span class="ident" id="2257446">isNotPrint</span>&nbsp;<span class="op" id="2257457">:=</span>&nbsp;<span class="builtintype" id="2257460">uint32</span><span class="op" id="2257466">(</span><span class="ident" id="2257467">r</span><span class="op" id="2257468">)</span><span class="op" id="2257469">,</span>&nbsp;<span class="ident" id="2257471">isPrint32</span><span class="op" id="2257480">,</span>&nbsp;<span class="ident" id="2257482">isNotPrint32</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2257496">i</span>&nbsp;<span class="op" id="2257498">:=</span>&nbsp;<span class="ident" id="2257501">bsearch32</span><span class="op" id="2257510">(</span><span class="ident" id="2257511">isPrint</span><span class="op" id="2257518">,</span>&nbsp;<span class="ident" id="2257520">rr</span><span class="op" id="2257522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2257525">if</span>&nbsp;<span class="ident" id="2257528">i</span>&nbsp;<span class="op" id="2257530">&gt;=</span>&nbsp;<span class="builtinfunc" id="2257533">len</span><span class="op" id="2257536">(</span><span class="ident" id="2257537">isPrint</span><span class="op" id="2257544">)</span>&nbsp;<span class="op" id="2257546">||</span>&nbsp;<span class="ident" id="2257549">rr</span>&nbsp;<span class="op" id="2257552">&lt;</span>&nbsp;<span class="ident" id="2257554">isPrint</span><span class="op" id="2257561">[</span><span class="ident" id="2257562">i</span><span class="op" id="2257563">&amp;^</span><span class="num" id="2257565">1</span><span class="op" id="2257566">]</span>&nbsp;<span class="op" id="2257568">||</span>&nbsp;<span class="ident" id="2257571">isPrint</span><span class="op" id="2257578">[</span><span class="ident" id="2257579">i</span><span class="op" id="2257580">|</span><span class="num" id="2257581">1</span><span class="op" id="2257582">]</span>&nbsp;<span class="op" id="2257584">&lt;</span>&nbsp;<span class="ident" id="2257586">rr</span>&nbsp;<span class="op" id="2257589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2257593">return</span>&nbsp;<span class="builtintype" id="2257600">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2257610">if</span>&nbsp;<span class="ident" id="2257613">r</span>&nbsp;<span class="op" id="2257615">&gt;=</span>&nbsp;<span class="num" id="2257618">0x20000</span>&nbsp;<span class="op" id="2257626">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2257630">return</span>&nbsp;<span class="builtintype" id="2257637">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2257646">r</span>&nbsp;<span class="op" id="2257648">-=</span>&nbsp;<span class="num" id="2257651">0x10000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2257660">j</span>&nbsp;<span class="op" id="2257662">:=</span>&nbsp;<span class="ident" id="2257665">bsearch16</span><span class="op" id="2257674">(</span><span class="ident" id="2257675">isNotPrint</span><span class="op" id="2257685">,</span>&nbsp;<span class="builtintype" id="2257687">uint16</span><span class="op" id="2257693">(</span><span class="ident" id="2257694">r</span><span class="op" id="2257695">)</span><span class="op" id="2257696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2257699">return</span>&nbsp;<span class="ident" id="2257706">j</span>&nbsp;<span class="op" id="2257708">&gt;=</span>&nbsp;<span class="builtinfunc" id="2257711">len</span><span class="op" id="2257714">(</span><span class="ident" id="2257715">isNotPrint</span><span class="op" id="2257725">)</span>&nbsp;<span class="op" id="2257727">||</span>&nbsp;<span class="ident" id="2257730">isNotPrint</span><span class="op" id="2257740">[</span><span class="ident" id="2257741">j</span><span class="op" id="2257742">]</span>&nbsp;<span class="op" id="2257744">!=</span>&nbsp;<span class="builtintype" id="2257747">uint16</span><span class="op" id="2257753">(</span><span class="ident" id="2257754">r</span><span class="op" id="2257755">)</span><br>
<span class="lineno">455</span><span class="op" id="2257757">}</span>
</div>
</body>
</html>
