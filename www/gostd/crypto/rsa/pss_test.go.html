<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8553067">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8553122">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8553176">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8553227">package</span>&nbsp;<span class="ident" id="8553235">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8553240">import</span>&nbsp;<span class="op" id="8553247">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8553250">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8553259">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8553268">&#34;compress/bzip2&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8553286">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8553296">_</span>&nbsp;<span class="string" id="8553298">&#34;crypto/md5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8553312">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8553327">&#34;crypto/sha1&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8553342">_</span>&nbsp;<span class="string" id="8553344">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8553361">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8553377">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8553389">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8553395">&#34;strconv&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8553406">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8553417">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8553427">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8553430">func</span>&nbsp;<span class="ident" id="8553435">TestEMSAPSS</span><span class="op" id="8553446">(</span><span class="ident" id="8553447">t</span>&nbsp;<span class="op" id="8553449">*</span><span class="ident" id="8553450">testing</span><span class="op" id="8553457">.</span><span class="ident" id="8553458">T</span><span class="op" id="8553459">)</span>&nbsp;<span class="op" id="8553461">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8553464">//&nbsp;Test&nbsp;vector&nbsp;in&nbsp;file&nbsp;pss-int.txt&nbsp;from:&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8553567">msg</span>&nbsp;<span class="op" id="8553571">:=</span>&nbsp;<span class="op" id="8553574">[</span><span class="op" id="8553575">]</span><span class="builtintype" id="8553576">byte</span><span class="op" id="8553580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8553584">0x85</span><span class="op" id="8553588">,</span>&nbsp;<span class="num" id="8553590">0x9e</span><span class="op" id="8553594">,</span>&nbsp;<span class="num" id="8553596">0xef</span><span class="op" id="8553600">,</span>&nbsp;<span class="num" id="8553602">0x2f</span><span class="op" id="8553606">,</span>&nbsp;<span class="num" id="8553608">0xd7</span><span class="op" id="8553612">,</span>&nbsp;<span class="num" id="8553614">0x8a</span><span class="op" id="8553618">,</span>&nbsp;<span class="num" id="8553620">0xca</span><span class="op" id="8553624">,</span>&nbsp;<span class="num" id="8553626">0x00</span><span class="op" id="8553630">,</span>&nbsp;<span class="num" id="8553632">0x30</span><span class="op" id="8553636">,</span>&nbsp;<span class="num" id="8553638">0x8b</span><span class="op" id="8553642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8553646">0xdc</span><span class="op" id="8553650">,</span>&nbsp;<span class="num" id="8553652">0x47</span><span class="op" id="8553656">,</span>&nbsp;<span class="num" id="8553658">0x11</span><span class="op" id="8553662">,</span>&nbsp;<span class="num" id="8553664">0x93</span><span class="op" id="8553668">,</span>&nbsp;<span class="num" id="8553670">0xbf</span><span class="op" id="8553674">,</span>&nbsp;<span class="num" id="8553676">0x55</span><span class="op" id="8553680">,</span>&nbsp;<span class="num" id="8553682">0xbf</span><span class="op" id="8553686">,</span>&nbsp;<span class="num" id="8553688">0x9d</span><span class="op" id="8553692">,</span>&nbsp;<span class="num" id="8553694">0x78</span><span class="op" id="8553698">,</span>&nbsp;<span class="num" id="8553700">0xdb</span><span class="op" id="8553704">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8553708">0x8f</span><span class="op" id="8553712">,</span>&nbsp;<span class="num" id="8553714">0x8a</span><span class="op" id="8553718">,</span>&nbsp;<span class="num" id="8553720">0x67</span><span class="op" id="8553724">,</span>&nbsp;<span class="num" id="8553726">0x2b</span><span class="op" id="8553730">,</span>&nbsp;<span class="num" id="8553732">0x48</span><span class="op" id="8553736">,</span>&nbsp;<span class="num" id="8553738">0x46</span><span class="op" id="8553742">,</span>&nbsp;<span class="num" id="8553744">0x34</span><span class="op" id="8553748">,</span>&nbsp;<span class="num" id="8553750">0xf3</span><span class="op" id="8553754">,</span>&nbsp;<span class="num" id="8553756">0xc9</span><span class="op" id="8553760">,</span>&nbsp;<span class="num" id="8553762">0xc2</span><span class="op" id="8553766">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8553770">0x6e</span><span class="op" id="8553774">,</span>&nbsp;<span class="num" id="8553776">0x64</span><span class="op" id="8553780">,</span>&nbsp;<span class="num" id="8553782">0x78</span><span class="op" id="8553786">,</span>&nbsp;<span class="num" id="8553788">0xae</span><span class="op" id="8553792">,</span>&nbsp;<span class="num" id="8553794">0x10</span><span class="op" id="8553798">,</span>&nbsp;<span class="num" id="8553800">0x26</span><span class="op" id="8553804">,</span>&nbsp;<span class="num" id="8553806">0x0f</span><span class="op" id="8553810">,</span>&nbsp;<span class="num" id="8553812">0xe0</span><span class="op" id="8553816">,</span>&nbsp;<span class="num" id="8553818">0xdd</span><span class="op" id="8553822">,</span>&nbsp;<span class="num" id="8553824">0x8c</span><span class="op" id="8553828">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8553832">0x08</span><span class="op" id="8553836">,</span>&nbsp;<span class="num" id="8553838">0x2e</span><span class="op" id="8553842">,</span>&nbsp;<span class="num" id="8553844">0x53</span><span class="op" id="8553848">,</span>&nbsp;<span class="num" id="8553850">0xa5</span><span class="op" id="8553854">,</span>&nbsp;<span class="num" id="8553856">0x29</span><span class="op" id="8553860">,</span>&nbsp;<span class="num" id="8553862">0x3a</span><span class="op" id="8553866">,</span>&nbsp;<span class="num" id="8553868">0xf2</span><span class="op" id="8553872">,</span>&nbsp;<span class="num" id="8553874">0x17</span><span class="op" id="8553878">,</span>&nbsp;<span class="num" id="8553880">0x3c</span><span class="op" id="8553884">,</span>&nbsp;<span class="num" id="8553886">0xd5</span><span class="op" id="8553890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8553894">0x0c</span><span class="op" id="8553898">,</span>&nbsp;<span class="num" id="8553900">0x6d</span><span class="op" id="8553904">,</span>&nbsp;<span class="num" id="8553906">0x5d</span><span class="op" id="8553910">,</span>&nbsp;<span class="num" id="8553912">0x35</span><span class="op" id="8553916">,</span>&nbsp;<span class="num" id="8553918">0x4f</span><span class="op" id="8553922">,</span>&nbsp;<span class="num" id="8553924">0xeb</span><span class="op" id="8553928">,</span>&nbsp;<span class="num" id="8553930">0xf7</span><span class="op" id="8553934">,</span>&nbsp;<span class="num" id="8553936">0x8b</span><span class="op" id="8553940">,</span>&nbsp;<span class="num" id="8553942">0x26</span><span class="op" id="8553946">,</span>&nbsp;<span class="num" id="8553948">0x02</span><span class="op" id="8553952">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8553956">0x1c</span><span class="op" id="8553960">,</span>&nbsp;<span class="num" id="8553962">0x25</span><span class="op" id="8553966">,</span>&nbsp;<span class="num" id="8553968">0xc0</span><span class="op" id="8553972">,</span>&nbsp;<span class="num" id="8553974">0x27</span><span class="op" id="8553978">,</span>&nbsp;<span class="num" id="8553980">0x12</span><span class="op" id="8553984">,</span>&nbsp;<span class="num" id="8553986">0xe7</span><span class="op" id="8553990">,</span>&nbsp;<span class="num" id="8553992">0x8c</span><span class="op" id="8553996">,</span>&nbsp;<span class="num" id="8553998">0xd4</span><span class="op" id="8554002">,</span>&nbsp;<span class="num" id="8554004">0x69</span><span class="op" id="8554008">,</span>&nbsp;<span class="num" id="8554010">0x4c</span><span class="op" id="8554014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8554018">0x9f</span><span class="op" id="8554022">,</span>&nbsp;<span class="num" id="8554024">0x46</span><span class="op" id="8554028">,</span>&nbsp;<span class="num" id="8554030">0x97</span><span class="op" id="8554034">,</span>&nbsp;<span class="num" id="8554036">0x77</span><span class="op" id="8554040">,</span>&nbsp;<span class="num" id="8554042">0xe4</span><span class="op" id="8554046">,</span>&nbsp;<span class="num" id="8554048">0x51</span><span class="op" id="8554052">,</span>&nbsp;<span class="num" id="8554054">0xe7</span><span class="op" id="8554058">,</span>&nbsp;<span class="num" id="8554060">0xf8</span><span class="op" id="8554064">,</span>&nbsp;<span class="num" id="8554066">0xe9</span><span class="op" id="8554070">,</span>&nbsp;<span class="num" id="8554072">0xe0</span><span class="op" id="8554076">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8554080">0x4c</span><span class="op" id="8554084">,</span>&nbsp;<span class="num" id="8554086">0xd3</span><span class="op" id="8554090">,</span>&nbsp;<span class="num" id="8554092">0x73</span><span class="op" id="8554096">,</span>&nbsp;<span class="num" id="8554098">0x9c</span><span class="op" id="8554102">,</span>&nbsp;<span class="num" id="8554104">0x6b</span><span class="op" id="8554108">,</span>&nbsp;<span class="num" id="8554110">0xbf</span><span class="op" id="8554114">,</span>&nbsp;<span class="num" id="8554116">0xed</span><span class="op" id="8554120">,</span>&nbsp;<span class="num" id="8554122">0xae</span><span class="op" id="8554126">,</span>&nbsp;<span class="num" id="8554128">0x48</span><span class="op" id="8554132">,</span>&nbsp;<span class="num" id="8554134">0x7f</span><span class="op" id="8554138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8554142">0xb5</span><span class="op" id="8554146">,</span>&nbsp;<span class="num" id="8554148">0x56</span><span class="op" id="8554152">,</span>&nbsp;<span class="num" id="8554154">0x44</span><span class="op" id="8554158">,</span>&nbsp;<span class="num" id="8554160">0xe9</span><span class="op" id="8554164">,</span>&nbsp;<span class="num" id="8554166">0xca</span><span class="op" id="8554170">,</span>&nbsp;<span class="num" id="8554172">0x74</span><span class="op" id="8554176">,</span>&nbsp;<span class="num" id="8554178">0xff</span><span class="op" id="8554182">,</span>&nbsp;<span class="num" id="8554184">0x77</span><span class="op" id="8554188">,</span>&nbsp;<span class="num" id="8554190">0xa5</span><span class="op" id="8554194">,</span>&nbsp;<span class="num" id="8554196">0x3c</span><span class="op" id="8554200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8554204">0xb7</span><span class="op" id="8554208">,</span>&nbsp;<span class="num" id="8554210">0x29</span><span class="op" id="8554214">,</span>&nbsp;<span class="num" id="8554216">0x80</span><span class="op" id="8554220">,</span>&nbsp;<span class="num" id="8554222">0x2f</span><span class="op" id="8554226">,</span>&nbsp;<span class="num" id="8554228">0x6e</span><span class="op" id="8554232">,</span>&nbsp;<span class="num" id="8554234">0xd4</span><span class="op" id="8554238">,</span>&nbsp;<span class="num" id="8554240">0xa5</span><span class="op" id="8554244">,</span>&nbsp;<span class="num" id="8554246">0xff</span><span class="op" id="8554250">,</span>&nbsp;<span class="num" id="8554252">0xa8</span><span class="op" id="8554256">,</span>&nbsp;<span class="num" id="8554258">0xba</span><span class="op" id="8554262">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8554266">0x15</span><span class="op" id="8554270">,</span>&nbsp;<span class="num" id="8554272">0x98</span><span class="op" id="8554276">,</span>&nbsp;<span class="num" id="8554278">0x90</span><span class="op" id="8554282">,</span>&nbsp;<span class="num" id="8554284">0xfc</span><span class="op" id="8554288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8554291">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8554294">salt</span>&nbsp;<span class="op" id="8554299">:=</span>&nbsp;<span class="op" id="8554302">[</span><span class="op" id="8554303">]</span><span class="builtintype" id="8554304">byte</span><span class="op" id="8554308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8554312">0xe3</span><span class="op" id="8554316">,</span>&nbsp;<span class="num" id="8554318">0xb5</span><span class="op" id="8554322">,</span>&nbsp;<span class="num" id="8554324">0xd5</span><span class="op" id="8554328">,</span>&nbsp;<span class="num" id="8554330">0xd0</span><span class="op" id="8554334">,</span>&nbsp;<span class="num" id="8554336">0x02</span><span class="op" id="8554340">,</span>&nbsp;<span class="num" id="8554342">0xc1</span><span class="op" id="8554346">,</span>&nbsp;<span class="num" id="8554348">0xbc</span><span class="op" id="8554352">,</span>&nbsp;<span class="num" id="8554354">0xe5</span><span class="op" id="8554358">,</span>&nbsp;<span class="num" id="8554360">0x0c</span><span class="op" id="8554364">,</span>&nbsp;<span class="num" id="8554366">0x2b</span><span class="op" id="8554370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8554374">0x65</span><span class="op" id="8554378">,</span>&nbsp;<span class="num" id="8554380">0xef</span><span class="op" id="8554384">,</span>&nbsp;<span class="num" id="8554386">0x88</span><span class="op" id="8554390">,</span>&nbsp;<span class="num" id="8554392">0xa1</span><span class="op" id="8554396">,</span>&nbsp;<span class="num" id="8554398">0x88</span><span class="op" id="8554402">,</span>&nbsp;<span class="num" id="8554404">0xd8</span><span class="op" id="8554408">,</span>&nbsp;<span class="num" id="8554410">0x3b</span><span class="op" id="8554414">,</span>&nbsp;<span class="num" id="8554416">0xce</span><span class="op" id="8554420">,</span>&nbsp;<span class="num" id="8554422">0x7e</span><span class="op" id="8554426">,</span>&nbsp;<span class="num" id="8554428">0x61</span><span class="op" id="8554432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8554435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8554438">expected</span>&nbsp;<span class="op" id="8554447">:=</span>&nbsp;<span class="op" id="8554450">[</span><span class="op" id="8554451">]</span><span class="builtintype" id="8554452">byte</span><span class="op" id="8554456">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8554460">0x66</span><span class="op" id="8554464">,</span>&nbsp;<span class="num" id="8554466">0xe4</span><span class="op" id="8554470">,</span>&nbsp;<span class="num" id="8554472">0x67</span><span class="op" id="8554476">,</span>&nbsp;<span class="num" id="8554478">0x2e</span><span class="op" id="8554482">,</span>&nbsp;<span class="num" id="8554484">0x83</span><span class="op" id="8554488">,</span>&nbsp;<span class="num" id="8554490">0x6a</span><span class="op" id="8554494">,</span>&nbsp;<span class="num" id="8554496">0xd1</span><span class="op" id="8554500">,</span>&nbsp;<span class="num" id="8554502">0x21</span><span class="op" id="8554506">,</span>&nbsp;<span class="num" id="8554508">0xba</span><span class="op" id="8554512">,</span>&nbsp;<span class="num" id="8554514">0x24</span><span class="op" id="8554518">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8554522">0x4b</span><span class="op" id="8554526">,</span>&nbsp;<span class="num" id="8554528">0xed</span><span class="op" id="8554532">,</span>&nbsp;<span class="num" id="8554534">0x65</span><span class="op" id="8554538">,</span>&nbsp;<span class="num" id="8554540">0x76</span><span class="op" id="8554544">,</span>&nbsp;<span class="num" id="8554546">0xb8</span><span class="op" id="8554550">,</span>&nbsp;<span class="num" id="8554552">0x67</span><span class="op" id="8554556">,</span>&nbsp;<span class="num" id="8554558">0xd9</span><span class="op" id="8554562">,</span>&nbsp;<span class="num" id="8554564">0xa4</span><span class="op" id="8554568">,</span>&nbsp;<span class="num" id="8554570">0x47</span><span class="op" id="8554574">,</span>&nbsp;<span class="num" id="8554576">0xc2</span><span class="op" id="8554580">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8554584">0x8a</span><span class="op" id="8554588">,</span>&nbsp;<span class="num" id="8554590">0x6e</span><span class="op" id="8554594">,</span>&nbsp;<span class="num" id="8554596">0x66</span><span class="op" id="8554600">,</span>&nbsp;<span class="num" id="8554602">0xa5</span><span class="op" id="8554606">,</span>&nbsp;<span class="num" id="8554608">0xb8</span><span class="op" id="8554612">,</span>&nbsp;<span class="num" id="8554614">0x7d</span><span class="op" id="8554618">,</span>&nbsp;<span class="num" id="8554620">0xee</span><span class="op" id="8554624">,</span>&nbsp;<span class="num" id="8554626">0x7f</span><span class="op" id="8554630">,</span>&nbsp;<span class="num" id="8554632">0xbc</span><span class="op" id="8554636">,</span>&nbsp;<span class="num" id="8554638">0x7e</span><span class="op" id="8554642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8554646">0x65</span><span class="op" id="8554650">,</span>&nbsp;<span class="num" id="8554652">0xaf</span><span class="op" id="8554656">,</span>&nbsp;<span class="num" id="8554658">0x50</span><span class="op" id="8554662">,</span>&nbsp;<span class="num" id="8554664">0x57</span><span class="op" id="8554668">,</span>&nbsp;<span class="num" id="8554670">0xf8</span><span class="op" id="8554674">,</span>&nbsp;<span class="num" id="8554676">0x6f</span><span class="op" id="8554680">,</span>&nbsp;<span class="num" id="8554682">0xae</span><span class="op" id="8554686">,</span>&nbsp;<span class="num" id="8554688">0x89</span><span class="op" id="8554692">,</span>&nbsp;<span class="num" id="8554694">0x84</span><span class="op" id="8554698">,</span>&nbsp;<span class="num" id="8554700">0xd9</span><span class="op" id="8554704">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8554708">0xba</span><span class="op" id="8554712">,</span>&nbsp;<span class="num" id="8554714">0x7f</span><span class="op" id="8554718">,</span>&nbsp;<span class="num" id="8554720">0x96</span><span class="op" id="8554724">,</span>&nbsp;<span class="num" id="8554726">0x9a</span><span class="op" id="8554730">,</span>&nbsp;<span class="num" id="8554732">0xd6</span><span class="op" id="8554736">,</span>&nbsp;<span class="num" id="8554738">0xfe</span><span class="op" id="8554742">,</span>&nbsp;<span class="num" id="8554744">0x02</span><span class="op" id="8554748">,</span>&nbsp;<span class="num" id="8554750">0xa4</span><span class="op" id="8554754">,</span>&nbsp;<span class="num" id="8554756">0xd7</span><span class="op" id="8554760">,</span>&nbsp;<span class="num" id="8554762">0x5f</span><span class="op" id="8554766">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8554770">0x74</span><span class="op" id="8554774">,</span>&nbsp;<span class="num" id="8554776">0x45</span><span class="op" id="8554780">,</span>&nbsp;<span class="num" id="8554782">0xfe</span><span class="op" id="8554786">,</span>&nbsp;<span class="num" id="8554788">0xfd</span><span class="op" id="8554792">,</span>&nbsp;<span class="num" id="8554794">0xd8</span><span class="op" id="8554798">,</span>&nbsp;<span class="num" id="8554800">0x5b</span><span class="op" id="8554804">,</span>&nbsp;<span class="num" id="8554806">0x6d</span><span class="op" id="8554810">,</span>&nbsp;<span class="num" id="8554812">0x3a</span><span class="op" id="8554816">,</span>&nbsp;<span class="num" id="8554818">0x47</span><span class="op" id="8554822">,</span>&nbsp;<span class="num" id="8554824">0x7c</span><span class="op" id="8554828">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8554832">0x28</span><span class="op" id="8554836">,</span>&nbsp;<span class="num" id="8554838">0xd2</span><span class="op" id="8554842">,</span>&nbsp;<span class="num" id="8554844">0x4b</span><span class="op" id="8554848">,</span>&nbsp;<span class="num" id="8554850">0xa1</span><span class="op" id="8554854">,</span>&nbsp;<span class="num" id="8554856">0xe3</span><span class="op" id="8554860">,</span>&nbsp;<span class="num" id="8554862">0x75</span><span class="op" id="8554866">,</span>&nbsp;<span class="num" id="8554868">0x6f</span><span class="op" id="8554872">,</span>&nbsp;<span class="num" id="8554874">0x79</span><span class="op" id="8554878">,</span>&nbsp;<span class="num" id="8554880">0x2d</span><span class="op" id="8554884">,</span>&nbsp;<span class="num" id="8554886">0xd1</span><span class="op" id="8554890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8554894">0xdc</span><span class="op" id="8554898">,</span>&nbsp;<span class="num" id="8554900">0xe8</span><span class="op" id="8554904">,</span>&nbsp;<span class="num" id="8554906">0xca</span><span class="op" id="8554910">,</span>&nbsp;<span class="num" id="8554912">0x94</span><span class="op" id="8554916">,</span>&nbsp;<span class="num" id="8554918">0x44</span><span class="op" id="8554922">,</span>&nbsp;<span class="num" id="8554924">0x0e</span><span class="op" id="8554928">,</span>&nbsp;<span class="num" id="8554930">0xcb</span><span class="op" id="8554934">,</span>&nbsp;<span class="num" id="8554936">0x52</span><span class="op" id="8554940">,</span>&nbsp;<span class="num" id="8554942">0x79</span><span class="op" id="8554946">,</span>&nbsp;<span class="num" id="8554948">0xec</span><span class="op" id="8554952">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8554956">0xd3</span><span class="op" id="8554960">,</span>&nbsp;<span class="num" id="8554962">0x18</span><span class="op" id="8554966">,</span>&nbsp;<span class="num" id="8554968">0x3a</span><span class="op" id="8554972">,</span>&nbsp;<span class="num" id="8554974">0x31</span><span class="op" id="8554978">,</span>&nbsp;<span class="num" id="8554980">0x1f</span><span class="op" id="8554984">,</span>&nbsp;<span class="num" id="8554986">0xc8</span><span class="op" id="8554990">,</span>&nbsp;<span class="num" id="8554992">0x96</span><span class="op" id="8554996">,</span>&nbsp;<span class="num" id="8554998">0xda</span><span class="op" id="8555002">,</span>&nbsp;<span class="num" id="8555004">0x1c</span><span class="op" id="8555008">,</span>&nbsp;<span class="num" id="8555010">0xb3</span><span class="op" id="8555014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8555018">0x93</span><span class="op" id="8555022">,</span>&nbsp;<span class="num" id="8555024">0x11</span><span class="op" id="8555028">,</span>&nbsp;<span class="num" id="8555030">0xaf</span><span class="op" id="8555034">,</span>&nbsp;<span class="num" id="8555036">0x37</span><span class="op" id="8555040">,</span>&nbsp;<span class="num" id="8555042">0xea</span><span class="op" id="8555046">,</span>&nbsp;<span class="num" id="8555048">0x4a</span><span class="op" id="8555052">,</span>&nbsp;<span class="num" id="8555054">0x75</span><span class="op" id="8555058">,</span>&nbsp;<span class="num" id="8555060">0xe2</span><span class="op" id="8555064">,</span>&nbsp;<span class="num" id="8555066">0x4b</span><span class="op" id="8555070">,</span>&nbsp;<span class="num" id="8555072">0xdb</span><span class="op" id="8555076">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8555080">0xfd</span><span class="op" id="8555084">,</span>&nbsp;<span class="num" id="8555086">0x5c</span><span class="op" id="8555090">,</span>&nbsp;<span class="num" id="8555092">0x1d</span><span class="op" id="8555096">,</span>&nbsp;<span class="num" id="8555098">0xa0</span><span class="op" id="8555102">,</span>&nbsp;<span class="num" id="8555104">0xde</span><span class="op" id="8555108">,</span>&nbsp;<span class="num" id="8555110">0x7c</span><span class="op" id="8555114">,</span>&nbsp;<span class="num" id="8555116">0xec</span><span class="op" id="8555120">,</span>&nbsp;<span class="num" id="8555122">0xdf</span><span class="op" id="8555126">,</span>&nbsp;<span class="num" id="8555128">0x1a</span><span class="op" id="8555132">,</span>&nbsp;<span class="num" id="8555134">0x89</span><span class="op" id="8555138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8555142">0x6f</span><span class="op" id="8555146">,</span>&nbsp;<span class="num" id="8555148">0x9d</span><span class="op" id="8555152">,</span>&nbsp;<span class="num" id="8555154">0x8b</span><span class="op" id="8555158">,</span>&nbsp;<span class="num" id="8555160">0xc8</span><span class="op" id="8555164">,</span>&nbsp;<span class="num" id="8555166">0x16</span><span class="op" id="8555170">,</span>&nbsp;<span class="num" id="8555172">0xd9</span><span class="op" id="8555176">,</span>&nbsp;<span class="num" id="8555178">0x7c</span><span class="op" id="8555182">,</span>&nbsp;<span class="num" id="8555184">0xd7</span><span class="op" id="8555188">,</span>&nbsp;<span class="num" id="8555190">0xa2</span><span class="op" id="8555194">,</span>&nbsp;<span class="num" id="8555196">0xc4</span><span class="op" id="8555200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8555204">0x3b</span><span class="op" id="8555208">,</span>&nbsp;<span class="num" id="8555210">0xad</span><span class="op" id="8555214">,</span>&nbsp;<span class="num" id="8555216">0x54</span><span class="op" id="8555220">,</span>&nbsp;<span class="num" id="8555222">0x6f</span><span class="op" id="8555226">,</span>&nbsp;<span class="num" id="8555228">0xbe</span><span class="op" id="8555232">,</span>&nbsp;<span class="num" id="8555234">0x8c</span><span class="op" id="8555238">,</span>&nbsp;<span class="num" id="8555240">0xfe</span><span class="op" id="8555244">,</span>&nbsp;<span class="num" id="8555246">0xbc</span><span class="op" id="8555250">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8555253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8555257">hash</span>&nbsp;<span class="op" id="8555262">:=</span>&nbsp;<span class="ident" id="8555265">sha1</span><span class="op" id="8555269">.</span><span class="ident" id="8555270">New</span><span class="op" id="8555273">(</span><span class="op" id="8555274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8555277">hash</span><span class="op" id="8555281">.</span><span class="ident" id="8555282">Write</span><span class="op" id="8555287">(</span><span class="ident" id="8555288">msg</span><span class="op" id="8555291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8555294">hashed</span>&nbsp;<span class="op" id="8555301">:=</span>&nbsp;<span class="ident" id="8555304">hash</span><span class="op" id="8555308">.</span><span class="ident" id="8555309">Sum</span><span class="op" id="8555312">(</span><span class="ident" id="8555313">nil</span><span class="op" id="8555316">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8555320">encoded</span><span class="op" id="8555327">,</span>&nbsp;<span class="ident" id="8555329">err</span>&nbsp;<span class="op" id="8555333">:=</span>&nbsp;<span class="ident" id="8555336">emsaPSSEncode</span><span class="op" id="8555349">(</span><span class="ident" id="8555350">hashed</span><span class="op" id="8555356">,</span>&nbsp;<span class="num" id="8555358">1023</span><span class="op" id="8555362">,</span>&nbsp;<span class="ident" id="8555364">salt</span><span class="op" id="8555368">,</span>&nbsp;<span class="ident" id="8555370">sha1</span><span class="op" id="8555374">.</span><span class="ident" id="8555375">New</span><span class="op" id="8555378">(</span><span class="op" id="8555379">)</span><span class="op" id="8555380">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8555383">if</span>&nbsp;<span class="ident" id="8555386">err</span>&nbsp;<span class="op" id="8555390">!=</span>&nbsp;<span class="ident" id="8555393">nil</span>&nbsp;<span class="op" id="8555397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8555401">t</span><span class="op" id="8555402">.</span><span class="ident" id="8555403">Errorf</span><span class="op" id="8555409">(</span><span class="string" id="8555410">&#34;Error&nbsp;from&nbsp;emsaPSSEncode:&nbsp;%s\n&#34;</span><span class="op" id="8555442">,</span>&nbsp;<span class="ident" id="8555444">err</span><span class="op" id="8555447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8555450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8555453">if</span>&nbsp;<span class="op" id="8555456">!</span><span class="ident" id="8555457">bytes</span><span class="op" id="8555462">.</span><span class="ident" id="8555463">Equal</span><span class="op" id="8555468">(</span><span class="ident" id="8555469">encoded</span><span class="op" id="8555476">,</span>&nbsp;<span class="ident" id="8555478">expected</span><span class="op" id="8555486">)</span>&nbsp;<span class="op" id="8555488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8555492">t</span><span class="op" id="8555493">.</span><span class="ident" id="8555494">Errorf</span><span class="op" id="8555500">(</span><span class="string" id="8555501">&#34;Bad&nbsp;encoding.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="8555532">,</span>&nbsp;<span class="ident" id="8555534">encoded</span><span class="op" id="8555541">,</span>&nbsp;<span class="ident" id="8555543">expected</span><span class="op" id="8555551">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8555554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8555558">if</span>&nbsp;<span class="ident" id="8555561">err</span>&nbsp;<span class="op" id="8555565">=</span>&nbsp;<span class="ident" id="8555567">emsaPSSVerify</span><span class="op" id="8555580">(</span><span class="ident" id="8555581">hashed</span><span class="op" id="8555587">,</span>&nbsp;<span class="ident" id="8555589">encoded</span><span class="op" id="8555596">,</span>&nbsp;<span class="num" id="8555598">1023</span><span class="op" id="8555602">,</span>&nbsp;<span class="builtinfunc" id="8555604">len</span><span class="op" id="8555607">(</span><span class="ident" id="8555608">salt</span><span class="op" id="8555612">)</span><span class="op" id="8555613">,</span>&nbsp;<span class="ident" id="8555615">sha1</span><span class="op" id="8555619">.</span><span class="ident" id="8555620">New</span><span class="op" id="8555623">(</span><span class="op" id="8555624">)</span><span class="op" id="8555625">)</span><span class="op" id="8555626">;</span>&nbsp;<span class="ident" id="8555628">err</span>&nbsp;<span class="op" id="8555632">!=</span>&nbsp;<span class="ident" id="8555635">nil</span>&nbsp;<span class="op" id="8555639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8555643">t</span><span class="op" id="8555644">.</span><span class="ident" id="8555645">Errorf</span><span class="op" id="8555651">(</span><span class="string" id="8555652">&#34;Bad&nbsp;verification:&nbsp;%s&#34;</span><span class="op" id="8555674">,</span>&nbsp;<span class="ident" id="8555676">err</span><span class="op" id="8555679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8555682">}</span><br>
<span class="lineno">75</span><span class="op" id="8555684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8555687">//&nbsp;TestPSSGolden&nbsp;tests&nbsp;all&nbsp;the&nbsp;test&nbsp;vectors&nbsp;in&nbsp;pss-vect.txt&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="8555752">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span><span class="keyword" id="8555816">func</span>&nbsp;<span class="ident" id="8555821">TestPSSGolden</span><span class="op" id="8555834">(</span><span class="ident" id="8555835">t</span>&nbsp;<span class="op" id="8555837">*</span><span class="ident" id="8555838">testing</span><span class="op" id="8555845">.</span><span class="ident" id="8555846">T</span><span class="op" id="8555847">)</span>&nbsp;<span class="op" id="8555849">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8555852">inFile</span><span class="op" id="8555858">,</span>&nbsp;<span class="ident" id="8555860">err</span>&nbsp;<span class="op" id="8555864">:=</span>&nbsp;<span class="ident" id="8555867">os</span><span class="op" id="8555869">.</span><span class="ident" id="8555870">Open</span><span class="op" id="8555874">(</span><span class="string" id="8555875">&#34;testdata/pss-vect.txt.bz2&#34;</span><span class="op" id="8555902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8555905">if</span>&nbsp;<span class="ident" id="8555908">err</span>&nbsp;<span class="op" id="8555912">!=</span>&nbsp;<span class="ident" id="8555915">nil</span>&nbsp;<span class="op" id="8555919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8555923">t</span><span class="op" id="8555924">.</span><span class="ident" id="8555925">Fatalf</span><span class="op" id="8555931">(</span><span class="string" id="8555932">&#34;Failed&nbsp;to&nbsp;open&nbsp;input&nbsp;file:&nbsp;%s&#34;</span><span class="op" id="8555963">,</span>&nbsp;<span class="ident" id="8555965">err</span><span class="op" id="8555968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8555971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8555974">defer</span>&nbsp;<span class="ident" id="8555980">inFile</span><span class="op" id="8555986">.</span><span class="ident" id="8555987">Close</span><span class="op" id="8555992">(</span><span class="op" id="8555993">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8555997">//&nbsp;The&nbsp;pss-vect.txt&nbsp;file&nbsp;contains&nbsp;RSA&nbsp;keys&nbsp;and&nbsp;then&nbsp;a&nbsp;series&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8556062">//&nbsp;signatures.&nbsp;A&nbsp;goroutine&nbsp;is&nbsp;used&nbsp;to&nbsp;preprocess&nbsp;the&nbsp;input&nbsp;by&nbsp;merging</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8556133">//&nbsp;lines,&nbsp;removing&nbsp;spaces&nbsp;in&nbsp;hex&nbsp;values&nbsp;and&nbsp;identifying&nbsp;the&nbsp;start&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8556203">//&nbsp;new&nbsp;keys&nbsp;and&nbsp;signature&nbsp;blocks.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8556238">const</span>&nbsp;<span class="ident" id="8556244">newKeyMarker</span>&nbsp;<span class="op" id="8556257">=</span>&nbsp;<span class="string" id="8556259">&#34;START&nbsp;NEW&nbsp;KEY&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8556276">const</span>&nbsp;<span class="ident" id="8556282">newSignatureMarker</span>&nbsp;<span class="op" id="8556301">=</span>&nbsp;<span class="string" id="8556303">&#34;START&nbsp;NEW&nbsp;SIGNATURE&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556327">values</span>&nbsp;<span class="op" id="8556334">:=</span>&nbsp;<span class="builtinfunc" id="8556337">make</span><span class="op" id="8556341">(</span><span class="keyword" id="8556342">chan</span>&nbsp;<span class="builtintype" id="8556347">string</span><span class="op" id="8556353">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8556357">go</span>&nbsp;<span class="keyword" id="8556360">func</span><span class="op" id="8556364">(</span><span class="op" id="8556365">)</span>&nbsp;<span class="op" id="8556367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8556371">defer</span>&nbsp;<span class="builtinfunc" id="8556377">close</span><span class="op" id="8556382">(</span><span class="ident" id="8556383">values</span><span class="op" id="8556389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556393">scanner</span>&nbsp;<span class="op" id="8556401">:=</span>&nbsp;<span class="ident" id="8556404">bufio</span><span class="op" id="8556409">.</span><span class="ident" id="8556410">NewScanner</span><span class="op" id="8556420">(</span><span class="ident" id="8556421">bzip2</span><span class="op" id="8556426">.</span><span class="ident" id="8556427">NewReader</span><span class="op" id="8556436">(</span><span class="ident" id="8556437">inFile</span><span class="op" id="8556443">)</span><span class="op" id="8556444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8556448">var</span>&nbsp;<span class="ident" id="8556452">partialValue</span>&nbsp;<span class="builtintype" id="8556465">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556474">lastWasValue</span>&nbsp;<span class="op" id="8556487">:=</span>&nbsp;<span class="builtintype" id="8556490">true</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8556498">for</span>&nbsp;<span class="ident" id="8556502">scanner</span><span class="op" id="8556509">.</span><span class="ident" id="8556510">Scan</span><span class="op" id="8556514">(</span><span class="op" id="8556515">)</span>&nbsp;<span class="op" id="8556517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556522">line</span>&nbsp;<span class="op" id="8556527">:=</span>&nbsp;<span class="ident" id="8556530">scanner</span><span class="op" id="8556537">.</span><span class="ident" id="8556538">Text</span><span class="op" id="8556542">(</span><span class="op" id="8556543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8556548">switch</span>&nbsp;<span class="op" id="8556555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8556560">case</span>&nbsp;<span class="builtinfunc" id="8556565">len</span><span class="op" id="8556568">(</span><span class="ident" id="8556569">line</span><span class="op" id="8556573">)</span>&nbsp;<span class="op" id="8556575">==</span>&nbsp;<span class="num" id="8556578">0</span><span class="op" id="8556579">:</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8556585">if</span>&nbsp;<span class="builtinfunc" id="8556588">len</span><span class="op" id="8556591">(</span><span class="ident" id="8556592">partialValue</span><span class="op" id="8556604">)</span>&nbsp;<span class="op" id="8556606">&gt;</span>&nbsp;<span class="num" id="8556608">0</span>&nbsp;<span class="op" id="8556610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556617">values</span>&nbsp;<span class="op" id="8556624">&lt;-</span>&nbsp;<span class="ident" id="8556627">strings</span><span class="op" id="8556634">.</span><span class="ident" id="8556635">Replace</span><span class="op" id="8556642">(</span><span class="ident" id="8556643">partialValue</span><span class="op" id="8556655">,</span>&nbsp;<span class="string" id="8556657">&#34;&nbsp;&#34;</span><span class="op" id="8556660">,</span>&nbsp;<span class="string" id="8556662">&#34;&#34;</span><span class="op" id="8556664">,</span>&nbsp;<span class="op" id="8556666">-</span><span class="num" id="8556667">1</span><span class="op" id="8556668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556675">partialValue</span>&nbsp;<span class="op" id="8556688">=</span>&nbsp;<span class="string" id="8556690">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556698">lastWasValue</span>&nbsp;<span class="op" id="8556711">=</span>&nbsp;<span class="builtintype" id="8556713">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8556722">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8556728">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8556740">case</span>&nbsp;<span class="ident" id="8556745">strings</span><span class="op" id="8556752">.</span><span class="ident" id="8556753">HasPrefix</span><span class="op" id="8556762">(</span><span class="ident" id="8556763">line</span><span class="op" id="8556767">,</span>&nbsp;<span class="string" id="8556769">&#34;#&nbsp;======&#34;</span><span class="op" id="8556779">)</span>&nbsp;<span class="op" id="8556781">&amp;&amp;</span>&nbsp;<span class="ident" id="8556784">lastWasValue</span><span class="op" id="8556796">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556802">values</span>&nbsp;<span class="op" id="8556809">&lt;-</span>&nbsp;<span class="ident" id="8556812">newKeyMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556829">lastWasValue</span>&nbsp;<span class="op" id="8556842">=</span>&nbsp;<span class="builtintype" id="8556844">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8556853">case</span>&nbsp;<span class="ident" id="8556858">strings</span><span class="op" id="8556865">.</span><span class="ident" id="8556866">HasPrefix</span><span class="op" id="8556875">(</span><span class="ident" id="8556876">line</span><span class="op" id="8556880">,</span>&nbsp;<span class="string" id="8556882">&#34;#&nbsp;------&#34;</span><span class="op" id="8556892">)</span>&nbsp;<span class="op" id="8556894">&amp;&amp;</span>&nbsp;<span class="ident" id="8556897">lastWasValue</span><span class="op" id="8556909">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556915">values</span>&nbsp;<span class="op" id="8556922">&lt;-</span>&nbsp;<span class="ident" id="8556925">newSignatureMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556948">lastWasValue</span>&nbsp;<span class="op" id="8556961">=</span>&nbsp;<span class="builtintype" id="8556963">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8556972">case</span>&nbsp;<span class="ident" id="8556977">strings</span><span class="op" id="8556984">.</span><span class="ident" id="8556985">HasPrefix</span><span class="op" id="8556994">(</span><span class="ident" id="8556995">line</span><span class="op" id="8556999">,</span>&nbsp;<span class="string" id="8557001">&#34;#&#34;</span><span class="op" id="8557004">)</span><span class="op" id="8557005">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8557011">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8557023">default</span><span class="op" id="8557030">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557036">partialValue</span>&nbsp;<span class="op" id="8557049">+=</span>&nbsp;<span class="ident" id="8557052">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8557060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8557064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8557068">if</span>&nbsp;<span class="ident" id="8557071">err</span>&nbsp;<span class="op" id="8557075">:=</span>&nbsp;<span class="ident" id="8557078">scanner</span><span class="op" id="8557085">.</span><span class="ident" id="8557086">Err</span><span class="op" id="8557089">(</span><span class="op" id="8557090">)</span><span class="op" id="8557091">;</span>&nbsp;<span class="ident" id="8557093">err</span>&nbsp;<span class="op" id="8557097">!=</span>&nbsp;<span class="ident" id="8557100">nil</span>&nbsp;<span class="op" id="8557104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8557109">panic</span><span class="op" id="8557114">(</span><span class="ident" id="8557115">err</span><span class="op" id="8557118">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8557122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8557125">}</span><span class="op" id="8557126">(</span><span class="op" id="8557127">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8557131">var</span>&nbsp;<span class="ident" id="8557135">key</span>&nbsp;<span class="op" id="8557139">*</span><span class="ident" id="8557140">PublicKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8557151">var</span>&nbsp;<span class="ident" id="8557155">hashed</span>&nbsp;<span class="op" id="8557162">[</span><span class="op" id="8557163">]</span><span class="builtintype" id="8557164">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557170">hash</span>&nbsp;<span class="op" id="8557175">:=</span>&nbsp;<span class="ident" id="8557178">crypto</span><span class="op" id="8557184">.</span><span class="ident" id="8557185">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557191">h</span>&nbsp;<span class="op" id="8557193">:=</span>&nbsp;<span class="ident" id="8557196">hash</span><span class="op" id="8557200">.</span><span class="ident" id="8557201">New</span><span class="op" id="8557204">(</span><span class="op" id="8557205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557208">opts</span>&nbsp;<span class="op" id="8557213">:=</span>&nbsp;<span class="op" id="8557216">&amp;</span><span class="ident" id="8557217">PSSOptions</span><span class="op" id="8557227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557231">SaltLength</span><span class="op" id="8557241">:</span>&nbsp;<span class="ident" id="8557243">PSSSaltLengthEqualsHash</span><span class="op" id="8557266">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8557269">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8557273">for</span>&nbsp;<span class="ident" id="8557277">marker</span>&nbsp;<span class="op" id="8557284">:=</span>&nbsp;<span class="keyword" id="8557287">range</span>&nbsp;<span class="ident" id="8557293">values</span>&nbsp;<span class="op" id="8557300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8557304">switch</span>&nbsp;<span class="ident" id="8557311">marker</span>&nbsp;<span class="op" id="8557318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8557322">case</span>&nbsp;<span class="ident" id="8557327">newKeyMarker</span><span class="op" id="8557339">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557344">key</span>&nbsp;<span class="op" id="8557348">=</span>&nbsp;<span class="builtinfunc" id="8557350">new</span><span class="op" id="8557353">(</span><span class="ident" id="8557354">PublicKey</span><span class="op" id="8557363">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557368">nHex</span><span class="op" id="8557372">,</span>&nbsp;<span class="ident" id="8557374">ok</span>&nbsp;<span class="op" id="8557377">:=</span>&nbsp;<span class="op" id="8557380">&lt;-</span><span class="ident" id="8557382">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8557392">if</span>&nbsp;<span class="op" id="8557395">!</span><span class="ident" id="8557396">ok</span>&nbsp;<span class="op" id="8557399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8557405">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8557417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557422">key</span><span class="op" id="8557425">.</span><span class="ident" id="8557426">N</span>&nbsp;<span class="op" id="8557428">=</span>&nbsp;<span class="ident" id="8557430">bigFromHex</span><span class="op" id="8557440">(</span><span class="ident" id="8557441">nHex</span><span class="op" id="8557445">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557450">key</span><span class="op" id="8557453">.</span><span class="ident" id="8557454">E</span>&nbsp;<span class="op" id="8557456">=</span>&nbsp;<span class="ident" id="8557458">intFromHex</span><span class="op" id="8557468">(</span><span class="op" id="8557469">&lt;-</span><span class="ident" id="8557471">values</span><span class="op" id="8557477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8557482">//&nbsp;We&nbsp;don&#39;t&nbsp;care&nbsp;for&nbsp;d,&nbsp;p,&nbsp;q,&nbsp;dP,&nbsp;dQ&nbsp;or&nbsp;qInv.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8557531">for</span>&nbsp;<span class="ident" id="8557535">i</span>&nbsp;<span class="op" id="8557537">:=</span>&nbsp;<span class="num" id="8557540">0</span><span class="op" id="8557541">;</span>&nbsp;<span class="ident" id="8557543">i</span>&nbsp;<span class="op" id="8557545">&lt;</span>&nbsp;<span class="num" id="8557547">6</span><span class="op" id="8557548">;</span>&nbsp;<span class="ident" id="8557550">i</span><span class="op" id="8557551">++</span>&nbsp;<span class="op" id="8557554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8557560">&lt;-</span><span class="ident" id="8557562">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8557572">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8557576">case</span>&nbsp;<span class="ident" id="8557581">newSignatureMarker</span><span class="op" id="8557599">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557604">msg</span>&nbsp;<span class="op" id="8557608">:=</span>&nbsp;<span class="ident" id="8557611">fromHex</span><span class="op" id="8557618">(</span><span class="op" id="8557619">&lt;-</span><span class="ident" id="8557621">values</span><span class="op" id="8557627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8557632">&lt;-</span><span class="ident" id="8557634">values</span>&nbsp;<span class="comment" id="8557641">//&nbsp;skip&nbsp;salt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557657">sig</span>&nbsp;<span class="op" id="8557661">:=</span>&nbsp;<span class="ident" id="8557664">fromHex</span><span class="op" id="8557671">(</span><span class="op" id="8557672">&lt;-</span><span class="ident" id="8557674">values</span><span class="op" id="8557680">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557686">h</span><span class="op" id="8557687">.</span><span class="ident" id="8557688">Reset</span><span class="op" id="8557693">(</span><span class="op" id="8557694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557699">h</span><span class="op" id="8557700">.</span><span class="ident" id="8557701">Write</span><span class="op" id="8557706">(</span><span class="ident" id="8557707">msg</span><span class="op" id="8557710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557715">hashed</span>&nbsp;<span class="op" id="8557722">=</span>&nbsp;<span class="ident" id="8557724">h</span><span class="op" id="8557725">.</span><span class="ident" id="8557726">Sum</span><span class="op" id="8557729">(</span><span class="ident" id="8557730">hashed</span><span class="op" id="8557736">[</span><span class="op" id="8557737">:</span><span class="num" id="8557738">0</span><span class="op" id="8557739">]</span><span class="op" id="8557740">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8557746">if</span>&nbsp;<span class="ident" id="8557749">err</span>&nbsp;<span class="op" id="8557753">:=</span>&nbsp;<span class="ident" id="8557756">VerifyPSS</span><span class="op" id="8557765">(</span><span class="ident" id="8557766">key</span><span class="op" id="8557769">,</span>&nbsp;<span class="ident" id="8557771">hash</span><span class="op" id="8557775">,</span>&nbsp;<span class="ident" id="8557777">hashed</span><span class="op" id="8557783">,</span>&nbsp;<span class="ident" id="8557785">sig</span><span class="op" id="8557788">,</span>&nbsp;<span class="ident" id="8557790">opts</span><span class="op" id="8557794">)</span><span class="op" id="8557795">;</span>&nbsp;<span class="ident" id="8557797">err</span>&nbsp;<span class="op" id="8557801">!=</span>&nbsp;<span class="ident" id="8557804">nil</span>&nbsp;<span class="op" id="8557808">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557814">t</span><span class="op" id="8557815">.</span><span class="ident" id="8557816">Error</span><span class="op" id="8557821">(</span><span class="ident" id="8557822">err</span><span class="op" id="8557825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8557830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8557834">default</span><span class="op" id="8557841">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557846">t</span><span class="op" id="8557847">.</span><span class="ident" id="8557848">Fatalf</span><span class="op" id="8557854">(</span><span class="string" id="8557855">&#34;unknown&nbsp;marker:&nbsp;&#34;</span>&nbsp;<span class="op" id="8557874">+</span>&nbsp;<span class="ident" id="8557876">marker</span><span class="op" id="8557882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8557886">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8557889">}</span><br>
<span class="lineno"></span><span class="op" id="8557891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8557894">//&nbsp;TestPSSOpenSSL&nbsp;ensures&nbsp;that&nbsp;we&nbsp;can&nbsp;verify&nbsp;a&nbsp;PSS&nbsp;signature&nbsp;from&nbsp;OpenSSL&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="8557973">//&nbsp;the&nbsp;default&nbsp;options.&nbsp;OpenSSL&nbsp;sets&nbsp;the&nbsp;salt&nbsp;length&nbsp;to&nbsp;be&nbsp;maximal.</span><br>
<span class="lineno">170</span><span class="keyword" id="8558041">func</span>&nbsp;<span class="ident" id="8558046">TestPSSOpenSSL</span><span class="op" id="8558060">(</span><span class="ident" id="8558061">t</span>&nbsp;<span class="op" id="8558063">*</span><span class="ident" id="8558064">testing</span><span class="op" id="8558071">.</span><span class="ident" id="8558072">T</span><span class="op" id="8558073">)</span>&nbsp;<span class="op" id="8558075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8558078">hash</span>&nbsp;<span class="op" id="8558083">:=</span>&nbsp;<span class="ident" id="8558086">crypto</span><span class="op" id="8558092">.</span><span class="ident" id="8558093">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8558101">h</span>&nbsp;<span class="op" id="8558103">:=</span>&nbsp;<span class="ident" id="8558106">hash</span><span class="op" id="8558110">.</span><span class="ident" id="8558111">New</span><span class="op" id="8558114">(</span><span class="op" id="8558115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8558118">h</span><span class="op" id="8558119">.</span><span class="ident" id="8558120">Write</span><span class="op" id="8558125">(</span><span class="op" id="8558126">[</span><span class="op" id="8558127">]</span><span class="builtintype" id="8558128">byte</span><span class="op" id="8558132">(</span><span class="string" id="8558133">&#34;testing&#34;</span><span class="op" id="8558142">)</span><span class="op" id="8558143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8558146">hashed</span>&nbsp;<span class="op" id="8558153">:=</span>&nbsp;<span class="ident" id="8558156">h</span><span class="op" id="8558157">.</span><span class="ident" id="8558158">Sum</span><span class="op" id="8558161">(</span><span class="ident" id="8558162">nil</span><span class="op" id="8558165">)</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8558169">//&nbsp;Generated&nbsp;with&nbsp;`echo&nbsp;-n&nbsp;testing&nbsp;|&nbsp;openssl&nbsp;dgst&nbsp;-sign&nbsp;key.pem&nbsp;-sigopt&nbsp;rsa_padding_mode:pss&nbsp;-sha256&nbsp;&gt;&nbsp;sig`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8558278">sig</span>&nbsp;<span class="op" id="8558282">:=</span>&nbsp;<span class="op" id="8558285">[</span><span class="op" id="8558286">]</span><span class="builtintype" id="8558287">byte</span><span class="op" id="8558291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8558295">0x95</span><span class="op" id="8558299">,</span>&nbsp;<span class="num" id="8558301">0x59</span><span class="op" id="8558305">,</span>&nbsp;<span class="num" id="8558307">0x6f</span><span class="op" id="8558311">,</span>&nbsp;<span class="num" id="8558313">0xd3</span><span class="op" id="8558317">,</span>&nbsp;<span class="num" id="8558319">0x10</span><span class="op" id="8558323">,</span>&nbsp;<span class="num" id="8558325">0xa2</span><span class="op" id="8558329">,</span>&nbsp;<span class="num" id="8558331">0xe7</span><span class="op" id="8558335">,</span>&nbsp;<span class="num" id="8558337">0xa2</span><span class="op" id="8558341">,</span>&nbsp;<span class="num" id="8558343">0x92</span><span class="op" id="8558347">,</span>&nbsp;<span class="num" id="8558349">0x9d</span><span class="op" id="8558353">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8558357">0x4a</span><span class="op" id="8558361">,</span>&nbsp;<span class="num" id="8558363">0x07</span><span class="op" id="8558367">,</span>&nbsp;<span class="num" id="8558369">0x2e</span><span class="op" id="8558373">,</span>&nbsp;<span class="num" id="8558375">0x2b</span><span class="op" id="8558379">,</span>&nbsp;<span class="num" id="8558381">0x27</span><span class="op" id="8558385">,</span>&nbsp;<span class="num" id="8558387">0xcc</span><span class="op" id="8558391">,</span>&nbsp;<span class="num" id="8558393">0x06</span><span class="op" id="8558397">,</span>&nbsp;<span class="num" id="8558399">0xc2</span><span class="op" id="8558403">,</span>&nbsp;<span class="num" id="8558405">0x87</span><span class="op" id="8558409">,</span>&nbsp;<span class="num" id="8558411">0x2c</span><span class="op" id="8558415">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8558419">0x52</span><span class="op" id="8558423">,</span>&nbsp;<span class="num" id="8558425">0xf0</span><span class="op" id="8558429">,</span>&nbsp;<span class="num" id="8558431">0x4a</span><span class="op" id="8558435">,</span>&nbsp;<span class="num" id="8558437">0xcc</span><span class="op" id="8558441">,</span>&nbsp;<span class="num" id="8558443">0x05</span><span class="op" id="8558447">,</span>&nbsp;<span class="num" id="8558449">0x94</span><span class="op" id="8558453">,</span>&nbsp;<span class="num" id="8558455">0xf2</span><span class="op" id="8558459">,</span>&nbsp;<span class="num" id="8558461">0xc3</span><span class="op" id="8558465">,</span>&nbsp;<span class="num" id="8558467">0x2e</span><span class="op" id="8558471">,</span>&nbsp;<span class="num" id="8558473">0x20</span><span class="op" id="8558477">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8558481">0xd7</span><span class="op" id="8558485">,</span>&nbsp;<span class="num" id="8558487">0x3e</span><span class="op" id="8558491">,</span>&nbsp;<span class="num" id="8558493">0x66</span><span class="op" id="8558497">,</span>&nbsp;<span class="num" id="8558499">0x62</span><span class="op" id="8558503">,</span>&nbsp;<span class="num" id="8558505">0xb5</span><span class="op" id="8558509">,</span>&nbsp;<span class="num" id="8558511">0x95</span><span class="op" id="8558515">,</span>&nbsp;<span class="num" id="8558517">0x2b</span><span class="op" id="8558521">,</span>&nbsp;<span class="num" id="8558523">0xa3</span><span class="op" id="8558527">,</span>&nbsp;<span class="num" id="8558529">0x93</span><span class="op" id="8558533">,</span>&nbsp;<span class="num" id="8558535">0x9a</span><span class="op" id="8558539">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8558543">0x66</span><span class="op" id="8558547">,</span>&nbsp;<span class="num" id="8558549">0x64</span><span class="op" id="8558553">,</span>&nbsp;<span class="num" id="8558555">0x25</span><span class="op" id="8558559">,</span>&nbsp;<span class="num" id="8558561">0xe0</span><span class="op" id="8558565">,</span>&nbsp;<span class="num" id="8558567">0x74</span><span class="op" id="8558571">,</span>&nbsp;<span class="num" id="8558573">0x66</span><span class="op" id="8558577">,</span>&nbsp;<span class="num" id="8558579">0x8c</span><span class="op" id="8558583">,</span>&nbsp;<span class="num" id="8558585">0x3e</span><span class="op" id="8558589">,</span>&nbsp;<span class="num" id="8558591">0x92</span><span class="op" id="8558595">,</span>&nbsp;<span class="num" id="8558597">0xeb</span><span class="op" id="8558601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8558605">0xc6</span><span class="op" id="8558609">,</span>&nbsp;<span class="num" id="8558611">0xe6</span><span class="op" id="8558615">,</span>&nbsp;<span class="num" id="8558617">0xc0</span><span class="op" id="8558621">,</span>&nbsp;<span class="num" id="8558623">0x44</span><span class="op" id="8558627">,</span>&nbsp;<span class="num" id="8558629">0xf3</span><span class="op" id="8558633">,</span>&nbsp;<span class="num" id="8558635">0xb4</span><span class="op" id="8558639">,</span>&nbsp;<span class="num" id="8558641">0xb4</span><span class="op" id="8558645">,</span>&nbsp;<span class="num" id="8558647">0x2e</span><span class="op" id="8558651">,</span>&nbsp;<span class="num" id="8558653">0x8c</span><span class="op" id="8558657">,</span>&nbsp;<span class="num" id="8558659">0x66</span><span class="op" id="8558663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8558667">0x0a</span><span class="op" id="8558671">,</span>&nbsp;<span class="num" id="8558673">0x37</span><span class="op" id="8558677">,</span>&nbsp;<span class="num" id="8558679">0x9c</span><span class="op" id="8558683">,</span>&nbsp;<span class="num" id="8558685">0x69</span><span class="op" id="8558689">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8558692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8558696">if</span>&nbsp;<span class="ident" id="8558699">err</span>&nbsp;<span class="op" id="8558703">:=</span>&nbsp;<span class="ident" id="8558706">VerifyPSS</span><span class="op" id="8558715">(</span><span class="op" id="8558716">&amp;</span><span class="ident" id="8558717">rsaPrivateKey</span><span class="op" id="8558730">.</span><span class="ident" id="8558731">PublicKey</span><span class="op" id="8558740">,</span>&nbsp;<span class="ident" id="8558742">hash</span><span class="op" id="8558746">,</span>&nbsp;<span class="ident" id="8558748">hashed</span><span class="op" id="8558754">,</span>&nbsp;<span class="ident" id="8558756">sig</span><span class="op" id="8558759">,</span>&nbsp;<span class="ident" id="8558761">nil</span><span class="op" id="8558764">)</span><span class="op" id="8558765">;</span>&nbsp;<span class="ident" id="8558767">err</span>&nbsp;<span class="op" id="8558771">!=</span>&nbsp;<span class="ident" id="8558774">nil</span>&nbsp;<span class="op" id="8558778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8558782">t</span><span class="op" id="8558783">.</span><span class="ident" id="8558784">Error</span><span class="op" id="8558789">(</span><span class="ident" id="8558790">err</span><span class="op" id="8558793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8558796">}</span><br>
<span class="lineno">190</span><span class="op" id="8558798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8558801">func</span>&nbsp;<span class="ident" id="8558806">TestPSSSigning</span><span class="op" id="8558820">(</span><span class="ident" id="8558821">t</span>&nbsp;<span class="op" id="8558823">*</span><span class="ident" id="8558824">testing</span><span class="op" id="8558831">.</span><span class="ident" id="8558832">T</span><span class="op" id="8558833">)</span>&nbsp;<span class="op" id="8558835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8558838">var</span>&nbsp;<span class="ident" id="8558842">saltLengthCombinations</span>&nbsp;<span class="op" id="8558865">=</span>&nbsp;<span class="op" id="8558867">[</span><span class="op" id="8558868">]</span><span class="keyword" id="8558869">struct</span>&nbsp;<span class="op" id="8558876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8558880">signSaltLength</span><span class="op" id="8558894">,</span>&nbsp;<span class="ident" id="8558896">verifySaltLength</span>&nbsp;<span class="builtintype" id="8558913">int</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8558919">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8558952">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8558958">}</span><span class="op" id="8558959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8558963">{</span><span class="ident" id="8558964">PSSSaltLengthAuto</span><span class="op" id="8558981">,</span>&nbsp;<span class="ident" id="8558983">PSSSaltLengthAuto</span><span class="op" id="8559000">,</span>&nbsp;<span class="builtintype" id="8559002">true</span><span class="op" id="8559006">}</span><span class="op" id="8559007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8559011">{</span><span class="ident" id="8559012">PSSSaltLengthEqualsHash</span><span class="op" id="8559035">,</span>&nbsp;<span class="ident" id="8559037">PSSSaltLengthAuto</span><span class="op" id="8559054">,</span>&nbsp;<span class="builtintype" id="8559056">true</span><span class="op" id="8559060">}</span><span class="op" id="8559061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8559065">{</span><span class="ident" id="8559066">PSSSaltLengthEqualsHash</span><span class="op" id="8559089">,</span>&nbsp;<span class="ident" id="8559091">PSSSaltLengthEqualsHash</span><span class="op" id="8559114">,</span>&nbsp;<span class="builtintype" id="8559116">true</span><span class="op" id="8559120">}</span><span class="op" id="8559121">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8559125">{</span><span class="ident" id="8559126">PSSSaltLengthEqualsHash</span><span class="op" id="8559149">,</span>&nbsp;<span class="num" id="8559151">8</span><span class="op" id="8559152">,</span>&nbsp;<span class="builtintype" id="8559154">false</span><span class="op" id="8559159">}</span><span class="op" id="8559160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8559164">{</span><span class="ident" id="8559165">PSSSaltLengthAuto</span><span class="op" id="8559182">,</span>&nbsp;<span class="ident" id="8559184">PSSSaltLengthEqualsHash</span><span class="op" id="8559207">,</span>&nbsp;<span class="builtintype" id="8559209">false</span><span class="op" id="8559214">}</span><span class="op" id="8559215">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8559219">{</span><span class="num" id="8559220">8</span><span class="op" id="8559221">,</span>&nbsp;<span class="num" id="8559223">8</span><span class="op" id="8559224">,</span>&nbsp;<span class="builtintype" id="8559226">true</span><span class="op" id="8559230">}</span><span class="op" id="8559231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8559234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559238">hash</span>&nbsp;<span class="op" id="8559243">:=</span>&nbsp;<span class="ident" id="8559246">crypto</span><span class="op" id="8559252">.</span><span class="ident" id="8559253">MD5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559258">h</span>&nbsp;<span class="op" id="8559260">:=</span>&nbsp;<span class="ident" id="8559263">hash</span><span class="op" id="8559267">.</span><span class="ident" id="8559268">New</span><span class="op" id="8559271">(</span><span class="op" id="8559272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559275">h</span><span class="op" id="8559276">.</span><span class="ident" id="8559277">Write</span><span class="op" id="8559282">(</span><span class="op" id="8559283">[</span><span class="op" id="8559284">]</span><span class="builtintype" id="8559285">byte</span><span class="op" id="8559289">(</span><span class="string" id="8559290">&#34;testing&#34;</span><span class="op" id="8559299">)</span><span class="op" id="8559300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559303">hashed</span>&nbsp;<span class="op" id="8559310">:=</span>&nbsp;<span class="ident" id="8559313">h</span><span class="op" id="8559314">.</span><span class="ident" id="8559315">Sum</span><span class="op" id="8559318">(</span><span class="ident" id="8559319">nil</span><span class="op" id="8559322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8559325">var</span>&nbsp;<span class="ident" id="8559329">opts</span>&nbsp;<span class="ident" id="8559334">PSSOptions</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8559347">for</span>&nbsp;<span class="ident" id="8559351">i</span><span class="op" id="8559352">,</span>&nbsp;<span class="ident" id="8559354">test</span>&nbsp;<span class="op" id="8559359">:=</span>&nbsp;<span class="keyword" id="8559362">range</span>&nbsp;<span class="ident" id="8559368">saltLengthCombinations</span>&nbsp;<span class="op" id="8559391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559395">opts</span><span class="op" id="8559399">.</span><span class="ident" id="8559400">SaltLength</span>&nbsp;<span class="op" id="8559411">=</span>&nbsp;<span class="ident" id="8559413">test</span><span class="op" id="8559417">.</span><span class="ident" id="8559418">signSaltLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559435">sig</span><span class="op" id="8559438">,</span>&nbsp;<span class="ident" id="8559440">err</span>&nbsp;<span class="op" id="8559444">:=</span>&nbsp;<span class="ident" id="8559447">SignPSS</span><span class="op" id="8559454">(</span><span class="ident" id="8559455">rand</span><span class="op" id="8559459">.</span><span class="ident" id="8559460">Reader</span><span class="op" id="8559466">,</span>&nbsp;<span class="ident" id="8559468">rsaPrivateKey</span><span class="op" id="8559481">,</span>&nbsp;<span class="ident" id="8559483">hash</span><span class="op" id="8559487">,</span>&nbsp;<span class="ident" id="8559489">hashed</span><span class="op" id="8559495">,</span>&nbsp;<span class="op" id="8559497">&amp;</span><span class="ident" id="8559498">opts</span><span class="op" id="8559502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8559506">if</span>&nbsp;<span class="ident" id="8559509">err</span>&nbsp;<span class="op" id="8559513">!=</span>&nbsp;<span class="ident" id="8559516">nil</span>&nbsp;<span class="op" id="8559520">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559525">t</span><span class="op" id="8559526">.</span><span class="ident" id="8559527">Errorf</span><span class="op" id="8559533">(</span><span class="string" id="8559534">&#34;#%d:&nbsp;error&nbsp;while&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="8559564">,</span>&nbsp;<span class="ident" id="8559566">i</span><span class="op" id="8559567">,</span>&nbsp;<span class="ident" id="8559569">err</span><span class="op" id="8559572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8559577">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8559588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559593">opts</span><span class="op" id="8559597">.</span><span class="ident" id="8559598">SaltLength</span>&nbsp;<span class="op" id="8559609">=</span>&nbsp;<span class="ident" id="8559611">test</span><span class="op" id="8559615">.</span><span class="ident" id="8559616">verifySaltLength</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559635">err</span>&nbsp;<span class="op" id="8559639">=</span>&nbsp;<span class="ident" id="8559641">VerifyPSS</span><span class="op" id="8559650">(</span><span class="op" id="8559651">&amp;</span><span class="ident" id="8559652">rsaPrivateKey</span><span class="op" id="8559665">.</span><span class="ident" id="8559666">PublicKey</span><span class="op" id="8559675">,</span>&nbsp;<span class="ident" id="8559677">hash</span><span class="op" id="8559681">,</span>&nbsp;<span class="ident" id="8559683">hashed</span><span class="op" id="8559689">,</span>&nbsp;<span class="ident" id="8559691">sig</span><span class="op" id="8559694">,</span>&nbsp;<span class="op" id="8559696">&amp;</span><span class="ident" id="8559697">opts</span><span class="op" id="8559701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8559705">if</span>&nbsp;<span class="op" id="8559708">(</span><span class="ident" id="8559709">err</span>&nbsp;<span class="op" id="8559713">==</span>&nbsp;<span class="ident" id="8559716">nil</span><span class="op" id="8559719">)</span>&nbsp;<span class="op" id="8559721">!=</span>&nbsp;<span class="ident" id="8559724">test</span><span class="op" id="8559728">.</span><span class="ident" id="8559729">good</span>&nbsp;<span class="op" id="8559734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559739">t</span><span class="op" id="8559740">.</span><span class="ident" id="8559741">Errorf</span><span class="op" id="8559747">(</span><span class="string" id="8559748">&#34;#%d:&nbsp;bad&nbsp;result,&nbsp;wanted:&nbsp;%t,&nbsp;got:&nbsp;%s&#34;</span><span class="op" id="8559786">,</span>&nbsp;<span class="ident" id="8559788">i</span><span class="op" id="8559789">,</span>&nbsp;<span class="ident" id="8559791">test</span><span class="op" id="8559795">.</span><span class="ident" id="8559796">good</span><span class="op" id="8559800">,</span>&nbsp;<span class="ident" id="8559802">err</span><span class="op" id="8559805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8559809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8559812">}</span><br>
<span class="lineno">225</span><span class="op" id="8559814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8559817">func</span>&nbsp;<span class="ident" id="8559822">bigFromHex</span><span class="op" id="8559832">(</span><span class="ident" id="8559833">hex</span>&nbsp;<span class="builtintype" id="8559837">string</span><span class="op" id="8559843">)</span>&nbsp;<span class="op" id="8559845">*</span><span class="ident" id="8559846">big</span><span class="op" id="8559849">.</span><span class="ident" id="8559850">Int</span>&nbsp;<span class="op" id="8559854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559857">n</span><span class="op" id="8559858">,</span>&nbsp;<span class="ident" id="8559860">ok</span>&nbsp;<span class="op" id="8559863">:=</span>&nbsp;<span class="builtinfunc" id="8559866">new</span><span class="op" id="8559869">(</span><span class="ident" id="8559870">big</span><span class="op" id="8559873">.</span><span class="ident" id="8559874">Int</span><span class="op" id="8559877">)</span><span class="op" id="8559878">.</span><span class="ident" id="8559879">SetString</span><span class="op" id="8559888">(</span><span class="ident" id="8559889">hex</span><span class="op" id="8559892">,</span>&nbsp;<span class="num" id="8559894">16</span><span class="op" id="8559896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8559899">if</span>&nbsp;<span class="op" id="8559902">!</span><span class="ident" id="8559903">ok</span>&nbsp;<span class="op" id="8559906">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8559910">panic</span><span class="op" id="8559915">(</span><span class="string" id="8559916">&#34;bad&nbsp;hex:&nbsp;&#34;</span>&nbsp;<span class="op" id="8559928">+</span>&nbsp;<span class="ident" id="8559930">hex</span><span class="op" id="8559933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8559936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8559939">return</span>&nbsp;<span class="ident" id="8559946">n</span><br>
<span class="lineno"></span><span class="op" id="8559948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="8559951">func</span>&nbsp;<span class="ident" id="8559956">intFromHex</span><span class="op" id="8559966">(</span><span class="ident" id="8559967">hex</span>&nbsp;<span class="builtintype" id="8559971">string</span><span class="op" id="8559977">)</span>&nbsp;<span class="builtintype" id="8559979">int</span>&nbsp;<span class="op" id="8559983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559986">i</span><span class="op" id="8559987">,</span>&nbsp;<span class="ident" id="8559989">err</span>&nbsp;<span class="op" id="8559993">:=</span>&nbsp;<span class="ident" id="8559996">strconv</span><span class="op" id="8560003">.</span><span class="ident" id="8560004">ParseInt</span><span class="op" id="8560012">(</span><span class="ident" id="8560013">hex</span><span class="op" id="8560016">,</span>&nbsp;<span class="num" id="8560018">16</span><span class="op" id="8560020">,</span>&nbsp;<span class="num" id="8560022">32</span><span class="op" id="8560024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8560027">if</span>&nbsp;<span class="ident" id="8560030">err</span>&nbsp;<span class="op" id="8560034">!=</span>&nbsp;<span class="ident" id="8560037">nil</span>&nbsp;<span class="op" id="8560041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8560045">panic</span><span class="op" id="8560050">(</span><span class="ident" id="8560051">err</span><span class="op" id="8560054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8560057">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8560060">return</span>&nbsp;<span class="builtintype" id="8560067">int</span><span class="op" id="8560070">(</span><span class="ident" id="8560071">i</span><span class="op" id="8560072">)</span><br>
<span class="lineno"></span><span class="op" id="8560074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8560077">func</span>&nbsp;<span class="ident" id="8560082">fromHex</span><span class="op" id="8560089">(</span><span class="ident" id="8560090">hexStr</span>&nbsp;<span class="builtintype" id="8560097">string</span><span class="op" id="8560103">)</span>&nbsp;<span class="op" id="8560105">[</span><span class="op" id="8560106">]</span><span class="builtintype" id="8560107">byte</span>&nbsp;<span class="op" id="8560112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8560115">s</span><span class="op" id="8560116">,</span>&nbsp;<span class="ident" id="8560118">err</span>&nbsp;<span class="op" id="8560122">:=</span>&nbsp;<span class="ident" id="8560125">hex</span><span class="op" id="8560128">.</span><span class="ident" id="8560129">DecodeString</span><span class="op" id="8560141">(</span><span class="ident" id="8560142">hexStr</span><span class="op" id="8560148">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8560151">if</span>&nbsp;<span class="ident" id="8560154">err</span>&nbsp;<span class="op" id="8560158">!=</span>&nbsp;<span class="ident" id="8560161">nil</span>&nbsp;<span class="op" id="8560165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8560169">panic</span><span class="op" id="8560174">(</span><span class="ident" id="8560175">err</span><span class="op" id="8560178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8560181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8560184">return</span>&nbsp;<span class="ident" id="8560191">s</span><br>
<span class="lineno"></span><span class="op" id="8560193">}</span>
</div>
</body>
</html>
