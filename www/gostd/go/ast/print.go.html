<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/ast</h2>
<ul>
<li><a href="/gostd/go/ast/ast.go.html">ast.go</a></li>
<li><a href="/gostd/go/ast/ast_test.go.html">ast_test.go</a></li>
<li><a href="/gostd/go/ast/commentmap.go.html">commentmap.go</a></li>
<li><a href="/gostd/go/ast/commentmap_test.go.html">commentmap_test.go</a></li>
<li><a href="/gostd/go/ast/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/ast/filter.go.html">filter.go</a></li>
<li><a href="/gostd/go/ast/filter_test.go.html">filter_test.go</a></li>
<li><a href="/gostd/go/ast/import.go.html">import.go</a></li>
<li><a href="/gostd/go/ast/print.go.html" class="current">print.go</a></li>
<li><a href="/gostd/go/ast/print_test.go.html">print_test.go</a></li>
<li><a href="/gostd/go/ast/resolve.go.html">resolve.go</a></li>
<li><a href="/gostd/go/ast/scope.go.html">scope.go</a></li>
<li><a href="/gostd/go/ast/walk.go.html">walk.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3247362">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3247417">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3247471">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3247522">//&nbsp;This&nbsp;file&nbsp;contains&nbsp;printing&nbsp;support&nbsp;for&nbsp;ASTs.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3247572">package</span>&nbsp;<span class="ident" id="3247580">ast</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3247585">import</span>&nbsp;<span class="op" id="3247592">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3247595">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3247602">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3247614">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3247620">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3247626">&#34;reflect&#34;</span><br>
<span class="lineno">15</span><span class="op" id="3247636">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3247639">//&nbsp;A&nbsp;FieldFilter&nbsp;may&nbsp;be&nbsp;provided&nbsp;to&nbsp;Fprint&nbsp;to&nbsp;control&nbsp;the&nbsp;output.</span><br>
<span class="lineno"></span><span class="keyword" id="3247705">type</span>&nbsp;<span class="ident" id="3247710">FieldFilter</span>&nbsp;<span class="keyword" id="3247722">func</span><span class="op" id="3247726">(</span><span class="ident" id="3247727">name</span>&nbsp;<span class="builtintype" id="3247732">string</span><span class="op" id="3247738">,</span>&nbsp;<span class="ident" id="3247740">value</span>&nbsp;<span class="ident" id="3247746">reflect</span><span class="op" id="3247753">.</span><span class="ident" id="3247754">Value</span><span class="op" id="3247759">)</span>&nbsp;<span class="builtintype" id="3247761">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="3247767">//&nbsp;NotNilFilter&nbsp;returns&nbsp;true&nbsp;for&nbsp;field&nbsp;values&nbsp;that&nbsp;are&nbsp;not&nbsp;nil;</span><br>
<span class="lineno"></span><span class="comment" id="3247831">//&nbsp;it&nbsp;returns&nbsp;false&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="keyword" id="3247862">func</span>&nbsp;<span class="ident" id="3247867">NotNilFilter</span><span class="op" id="3247879">(</span><span class="ident" id="3247880">_</span>&nbsp;<span class="builtintype" id="3247882">string</span><span class="op" id="3247888">,</span>&nbsp;<span class="ident" id="3247890">v</span>&nbsp;<span class="ident" id="3247892">reflect</span><span class="op" id="3247899">.</span><span class="ident" id="3247900">Value</span><span class="op" id="3247905">)</span>&nbsp;<span class="builtintype" id="3247907">bool</span>&nbsp;<span class="op" id="3247912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3247915">switch</span>&nbsp;<span class="ident" id="3247922">v</span><span class="op" id="3247923">.</span><span class="ident" id="3247924">Kind</span><span class="op" id="3247928">(</span><span class="op" id="3247929">)</span>&nbsp;<span class="op" id="3247931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3247934">case</span>&nbsp;<span class="ident" id="3247939">reflect</span><span class="op" id="3247946">.</span><span class="ident" id="3247947">Chan</span><span class="op" id="3247951">,</span>&nbsp;<span class="ident" id="3247953">reflect</span><span class="op" id="3247960">.</span><span class="ident" id="3247961">Func</span><span class="op" id="3247965">,</span>&nbsp;<span class="ident" id="3247967">reflect</span><span class="op" id="3247974">.</span><span class="ident" id="3247975">Interface</span><span class="op" id="3247984">,</span>&nbsp;<span class="ident" id="3247986">reflect</span><span class="op" id="3247993">.</span><span class="ident" id="3247994">Map</span><span class="op" id="3247997">,</span>&nbsp;<span class="ident" id="3247999">reflect</span><span class="op" id="3248006">.</span><span class="ident" id="3248007">Ptr</span><span class="op" id="3248010">,</span>&nbsp;<span class="ident" id="3248012">reflect</span><span class="op" id="3248019">.</span><span class="ident" id="3248020">Slice</span><span class="op" id="3248025">:</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3248029">return</span>&nbsp;<span class="op" id="3248036">!</span><span class="ident" id="3248037">v</span><span class="op" id="3248038">.</span><span class="ident" id="3248039">IsNil</span><span class="op" id="3248044">(</span><span class="op" id="3248045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3248048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3248051">return</span>&nbsp;<span class="builtintype" id="3248058">true</span><br>
<span class="lineno"></span><span class="op" id="3248063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="3248066">//&nbsp;Fprint&nbsp;prints&nbsp;the&nbsp;(sub-)tree&nbsp;starting&nbsp;at&nbsp;AST&nbsp;node&nbsp;x&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="3248127">//&nbsp;If&nbsp;fset&nbsp;!=&nbsp;nil,&nbsp;position&nbsp;information&nbsp;is&nbsp;interpreted&nbsp;relative</span><br>
<span class="lineno"></span><span class="comment" id="3248191">//&nbsp;to&nbsp;that&nbsp;file&nbsp;set.&nbsp;Otherwise&nbsp;positions&nbsp;are&nbsp;printed&nbsp;as&nbsp;integer</span><br>
<span class="lineno"></span><span class="comment" id="3248255">//&nbsp;values&nbsp;(file&nbsp;set&nbsp;specific&nbsp;offsets).</span><br>
<span class="lineno"></span><span class="comment" id="3248294">//</span><br>
<span class="lineno">35</span><span class="comment" id="3248297">//&nbsp;A&nbsp;non-nil&nbsp;FieldFilter&nbsp;f&nbsp;may&nbsp;be&nbsp;provided&nbsp;to&nbsp;control&nbsp;the&nbsp;output:</span><br>
<span class="lineno"></span><span class="comment" id="3248363">//&nbsp;struct&nbsp;fields&nbsp;for&nbsp;which&nbsp;f(fieldname,&nbsp;fieldvalue)&nbsp;is&nbsp;true&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="3248427">//&nbsp;printed;&nbsp;all&nbsp;others&nbsp;are&nbsp;filtered&nbsp;from&nbsp;the&nbsp;output.&nbsp;Unexported</span><br>
<span class="lineno"></span><span class="comment" id="3248491">//&nbsp;struct&nbsp;fields&nbsp;are&nbsp;never&nbsp;printed.</span><br>
<span class="lineno"></span><span class="comment" id="3248527">//</span><br>
<span class="lineno">40</span><span class="keyword" id="3248530">func</span>&nbsp;<span class="ident" id="3248535">Fprint</span><span class="op" id="3248541">(</span><span class="ident" id="3248542">w</span>&nbsp;<span class="ident" id="3248544">io</span><span class="op" id="3248546">.</span><span class="ident" id="3248547">Writer</span><span class="op" id="3248553">,</span>&nbsp;<span class="ident" id="3248555">fset</span>&nbsp;<span class="op" id="3248560">*</span><span class="ident" id="3248561">token</span><span class="op" id="3248566">.</span><span class="ident" id="3248567">FileSet</span><span class="op" id="3248574">,</span>&nbsp;<span class="ident" id="3248576">x</span>&nbsp;<span class="keyword" id="3248578">interface</span><span class="op" id="3248587">{</span><span class="op" id="3248588">}</span><span class="op" id="3248589">,</span>&nbsp;<span class="ident" id="3248591">f</span>&nbsp;<span class="ident" id="3248593">FieldFilter</span><span class="op" id="3248604">)</span>&nbsp;<span class="op" id="3248606">(</span><span class="ident" id="3248607">err</span>&nbsp;<span class="builtintype" id="3248611">error</span><span class="op" id="3248616">)</span>&nbsp;<span class="op" id="3248618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3248621">//&nbsp;setup&nbsp;printer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3248639">p</span>&nbsp;<span class="op" id="3248641">:=</span>&nbsp;<span class="ident" id="3248644">printer</span><span class="op" id="3248651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3248655">output</span><span class="op" id="3248661">:</span>&nbsp;<span class="ident" id="3248663">w</span><span class="op" id="3248664">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3248668">fset</span><span class="op" id="3248672">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3248676">fset</span><span class="op" id="3248680">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3248684">filter</span><span class="op" id="3248690">:</span>&nbsp;<span class="ident" id="3248692">f</span><span class="op" id="3248693">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3248697">ptrmap</span><span class="op" id="3248703">:</span>&nbsp;<span class="builtinfunc" id="3248705">make</span><span class="op" id="3248709">(</span><span class="keyword" id="3248710">map</span><span class="op" id="3248713">[</span><span class="keyword" id="3248714">interface</span><span class="op" id="3248723">{</span><span class="op" id="3248724">}</span><span class="op" id="3248725">]</span><span class="builtintype" id="3248726">int</span><span class="op" id="3248729">)</span><span class="op" id="3248730">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3248734">last</span><span class="op" id="3248738">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="3248742">&#39;\n&#39;</span><span class="op" id="3248746">,</span>&nbsp;<span class="comment" id="3248748">//&nbsp;force&nbsp;printing&nbsp;of&nbsp;line&nbsp;number&nbsp;on&nbsp;first&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3248796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3248800">//&nbsp;install&nbsp;error&nbsp;handler</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3248826">defer</span>&nbsp;<span class="keyword" id="3248832">func</span><span class="op" id="3248836">(</span><span class="op" id="3248837">)</span>&nbsp;<span class="op" id="3248839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3248843">if</span>&nbsp;<span class="ident" id="3248846">e</span>&nbsp;<span class="op" id="3248848">:=</span>&nbsp;<span class="builtinfunc" id="3248851">recover</span><span class="op" id="3248858">(</span><span class="op" id="3248859">)</span><span class="op" id="3248860">;</span>&nbsp;<span class="ident" id="3248862">e</span>&nbsp;<span class="op" id="3248864">!=</span>&nbsp;<span class="builtintype" id="3248867">nil</span>&nbsp;<span class="op" id="3248871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3248876">err</span>&nbsp;<span class="op" id="3248880">=</span>&nbsp;<span class="ident" id="3248882">e</span><span class="op" id="3248883">.</span><span class="op" id="3248884">(</span><span class="ident" id="3248885">localError</span><span class="op" id="3248895">)</span><span class="op" id="3248896">.</span><span class="ident" id="3248897">err</span>&nbsp;<span class="comment" id="3248901">//&nbsp;re-panics&nbsp;if&nbsp;it&#39;s&nbsp;not&nbsp;a&nbsp;localError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3248941">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3248944">}</span><span class="op" id="3248945">(</span><span class="op" id="3248946">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3248950">//&nbsp;print&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3248962">if</span>&nbsp;<span class="ident" id="3248965">x</span>&nbsp;<span class="op" id="3248967">==</span>&nbsp;<span class="builtintype" id="3248970">nil</span>&nbsp;<span class="op" id="3248974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3248978">p</span><span class="op" id="3248979">.</span><span class="ident" id="3248980">printf</span><span class="op" id="3248986">(</span><span class="string" id="3248987">&#34;nil\n&#34;</span><span class="op" id="3248994">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3248998">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3249006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3249009">p</span><span class="op" id="3249010">.</span><span class="builtinfunc" id="3249011">print</span><span class="op" id="3249016">(</span><span class="ident" id="3249017">reflect</span><span class="op" id="3249024">.</span><span class="ident" id="3249025">ValueOf</span><span class="op" id="3249032">(</span><span class="ident" id="3249033">x</span><span class="op" id="3249034">)</span><span class="op" id="3249035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3249038">p</span><span class="op" id="3249039">.</span><span class="ident" id="3249040">printf</span><span class="op" id="3249046">(</span><span class="string" id="3249047">&#34;\n&#34;</span><span class="op" id="3249051">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3249055">return</span><br>
<span class="lineno"></span><span class="op" id="3249062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3249065">//&nbsp;Print&nbsp;prints&nbsp;x&nbsp;to&nbsp;standard&nbsp;output,&nbsp;skipping&nbsp;nil&nbsp;fields.</span><br>
<span class="lineno"></span><span class="comment" id="3249124">//&nbsp;Print(fset,&nbsp;x)&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;Fprint(os.Stdout,&nbsp;fset,&nbsp;x,&nbsp;NotNilFilter).</span><br>
<span class="lineno">70</span><span class="keyword" id="3249199">func</span>&nbsp;<span class="ident" id="3249204">Print</span><span class="op" id="3249209">(</span><span class="ident" id="3249210">fset</span>&nbsp;<span class="op" id="3249215">*</span><span class="ident" id="3249216">token</span><span class="op" id="3249221">.</span><span class="ident" id="3249222">FileSet</span><span class="op" id="3249229">,</span>&nbsp;<span class="ident" id="3249231">x</span>&nbsp;<span class="keyword" id="3249233">interface</span><span class="op" id="3249242">{</span><span class="op" id="3249243">}</span><span class="op" id="3249244">)</span>&nbsp;<span class="builtintype" id="3249246">error</span>&nbsp;<span class="op" id="3249252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3249255">return</span>&nbsp;<span class="ident" id="3249262">Fprint</span><span class="op" id="3249268">(</span><span class="ident" id="3249269">os</span><span class="op" id="3249271">.</span><span class="ident" id="3249272">Stdout</span><span class="op" id="3249278">,</span>&nbsp;<span class="ident" id="3249280">fset</span><span class="op" id="3249284">,</span>&nbsp;<span class="ident" id="3249286">x</span><span class="op" id="3249287">,</span>&nbsp;<span class="ident" id="3249289">NotNilFilter</span><span class="op" id="3249301">)</span><br>
<span class="lineno"></span><span class="op" id="3249303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3249306">type</span>&nbsp;<span class="ident" id="3249311">printer</span>&nbsp;<span class="keyword" id="3249319">struct</span>&nbsp;<span class="op" id="3249326">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3249329">output</span>&nbsp;<span class="ident" id="3249336">io</span><span class="op" id="3249338">.</span><span class="ident" id="3249339">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3249347">fset</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3249354">*</span><span class="ident" id="3249355">token</span><span class="op" id="3249360">.</span><span class="ident" id="3249361">FileSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3249370">filter</span>&nbsp;<span class="ident" id="3249377">FieldFilter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3249390">ptrmap</span>&nbsp;<span class="keyword" id="3249397">map</span><span class="op" id="3249400">[</span><span class="keyword" id="3249401">interface</span><span class="op" id="3249410">{</span><span class="op" id="3249411">}</span><span class="op" id="3249412">]</span><span class="builtintype" id="3249413">int</span>&nbsp;<span class="comment" id="3249417">//&nbsp;*T&nbsp;-&gt;&nbsp;line&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3249439">indent</span>&nbsp;<span class="builtintype" id="3249446">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3249466">//&nbsp;current&nbsp;indentation&nbsp;level</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3249496">last</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3249503">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3249523">//&nbsp;the&nbsp;last&nbsp;byte&nbsp;processed&nbsp;by&nbsp;Write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3249560">line</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3249567">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3249587">//&nbsp;current&nbsp;line&nbsp;number</span><br>
<span class="lineno"></span><span class="op" id="3249610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3249613">var</span>&nbsp;<span class="ident" id="3249617">indent</span>&nbsp;<span class="op" id="3249624">=</span>&nbsp;<span class="op" id="3249626">[</span><span class="op" id="3249627">]</span><span class="builtintype" id="3249628">byte</span><span class="op" id="3249632">(</span><span class="string" id="3249633">&#34;.&nbsp;&nbsp;&#34;</span><span class="op" id="3249638">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="3249641">func</span>&nbsp;<span class="op" id="3249646">(</span><span class="ident" id="3249647">p</span>&nbsp;<span class="op" id="3249649">*</span><span class="ident" id="3249650">printer</span><span class="op" id="3249657">)</span>&nbsp;<span class="ident" id="3249659">Write</span><span class="op" id="3249664">(</span><span class="ident" id="3249665">data</span>&nbsp;<span class="op" id="3249670">[</span><span class="op" id="3249671">]</span><span class="builtintype" id="3249672">byte</span><span class="op" id="3249676">)</span>&nbsp;<span class="op" id="3249678">(</span><span class="ident" id="3249679">n</span>&nbsp;<span class="builtintype" id="3249681">int</span><span class="op" id="3249684">,</span>&nbsp;<span class="ident" id="3249686">err</span>&nbsp;<span class="builtintype" id="3249690">error</span><span class="op" id="3249695">)</span>&nbsp;<span class="op" id="3249697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3249700">var</span>&nbsp;<span class="ident" id="3249704">m</span>&nbsp;<span class="builtintype" id="3249706">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3249711">for</span>&nbsp;<span class="ident" id="3249715">i</span><span class="op" id="3249716">,</span>&nbsp;<span class="ident" id="3249718">b</span>&nbsp;<span class="op" id="3249720">:=</span>&nbsp;<span class="keyword" id="3249723">range</span>&nbsp;<span class="ident" id="3249729">data</span>&nbsp;<span class="op" id="3249734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3249738">//&nbsp;invariant:&nbsp;data[0:n]&nbsp;has&nbsp;been&nbsp;written</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3249781">if</span>&nbsp;<span class="ident" id="3249784">b</span>&nbsp;<span class="op" id="3249786">==</span>&nbsp;<span class="string" id="3249789">&#39;\n&#39;</span>&nbsp;<span class="op" id="3249794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3249799">m</span><span class="op" id="3249800">,</span>&nbsp;<span class="ident" id="3249802">err</span>&nbsp;<span class="op" id="3249806">=</span>&nbsp;<span class="ident" id="3249808">p</span><span class="op" id="3249809">.</span><span class="ident" id="3249810">output</span><span class="op" id="3249816">.</span><span class="ident" id="3249817">Write</span><span class="op" id="3249822">(</span><span class="ident" id="3249823">data</span><span class="op" id="3249827">[</span><span class="ident" id="3249828">n</span>&nbsp;<span class="op" id="3249830">:</span>&nbsp;<span class="ident" id="3249832">i</span><span class="op" id="3249833">+</span><span class="num" id="3249834">1</span><span class="op" id="3249835">]</span><span class="op" id="3249836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3249841">n</span>&nbsp;<span class="op" id="3249843">+=</span>&nbsp;<span class="ident" id="3249846">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3249851">if</span>&nbsp;<span class="ident" id="3249854">err</span>&nbsp;<span class="op" id="3249858">!=</span>&nbsp;<span class="builtintype" id="3249861">nil</span>&nbsp;<span class="op" id="3249865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3249871">return</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3249881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3249886">p</span><span class="op" id="3249887">.</span><span class="ident" id="3249888">line</span><span class="op" id="3249892">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3249897">}</span>&nbsp;<span class="keyword" id="3249899">else</span>&nbsp;<span class="keyword" id="3249904">if</span>&nbsp;<span class="ident" id="3249907">p</span><span class="op" id="3249908">.</span><span class="ident" id="3249909">last</span>&nbsp;<span class="op" id="3249914">==</span>&nbsp;<span class="string" id="3249917">&#39;\n&#39;</span>&nbsp;<span class="op" id="3249922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3249927">_</span><span class="op" id="3249928">,</span>&nbsp;<span class="ident" id="3249930">err</span>&nbsp;<span class="op" id="3249934">=</span>&nbsp;<span class="ident" id="3249936">fmt</span><span class="op" id="3249939">.</span><span class="ident" id="3249940">Fprintf</span><span class="op" id="3249947">(</span><span class="ident" id="3249948">p</span><span class="op" id="3249949">.</span><span class="ident" id="3249950">output</span><span class="op" id="3249956">,</span>&nbsp;<span class="string" id="3249958">&#34;%6d&nbsp;&nbsp;&#34;</span><span class="op" id="3249965">,</span>&nbsp;<span class="ident" id="3249967">p</span><span class="op" id="3249968">.</span><span class="ident" id="3249969">line</span><span class="op" id="3249973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3249978">if</span>&nbsp;<span class="ident" id="3249981">err</span>&nbsp;<span class="op" id="3249985">!=</span>&nbsp;<span class="builtintype" id="3249988">nil</span>&nbsp;<span class="op" id="3249992">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3249998">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3250008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3250013">for</span>&nbsp;<span class="ident" id="3250017">j</span>&nbsp;<span class="op" id="3250019">:=</span>&nbsp;<span class="ident" id="3250022">p</span><span class="op" id="3250023">.</span><span class="ident" id="3250024">indent</span><span class="op" id="3250030">;</span>&nbsp;<span class="ident" id="3250032">j</span>&nbsp;<span class="op" id="3250034">&gt;</span>&nbsp;<span class="num" id="3250036">0</span><span class="op" id="3250037">;</span>&nbsp;<span class="ident" id="3250039">j</span><span class="op" id="3250040">--</span>&nbsp;<span class="op" id="3250043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3250049">_</span><span class="op" id="3250050">,</span>&nbsp;<span class="ident" id="3250052">err</span>&nbsp;<span class="op" id="3250056">=</span>&nbsp;<span class="ident" id="3250058">p</span><span class="op" id="3250059">.</span><span class="ident" id="3250060">output</span><span class="op" id="3250066">.</span><span class="ident" id="3250067">Write</span><span class="op" id="3250072">(</span><span class="ident" id="3250073">indent</span><span class="op" id="3250079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3250085">if</span>&nbsp;<span class="ident" id="3250088">err</span>&nbsp;<span class="op" id="3250092">!=</span>&nbsp;<span class="builtintype" id="3250095">nil</span>&nbsp;<span class="op" id="3250099">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3250106">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3250117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3250122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3250126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3250130">p</span><span class="op" id="3250131">.</span><span class="ident" id="3250132">last</span>&nbsp;<span class="op" id="3250137">=</span>&nbsp;<span class="ident" id="3250139">b</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3250142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3250145">if</span>&nbsp;<span class="builtinfunc" id="3250148">len</span><span class="op" id="3250151">(</span><span class="ident" id="3250152">data</span><span class="op" id="3250156">)</span>&nbsp;<span class="op" id="3250158">&gt;</span>&nbsp;<span class="ident" id="3250160">n</span>&nbsp;<span class="op" id="3250162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3250166">m</span><span class="op" id="3250167">,</span>&nbsp;<span class="ident" id="3250169">err</span>&nbsp;<span class="op" id="3250173">=</span>&nbsp;<span class="ident" id="3250175">p</span><span class="op" id="3250176">.</span><span class="ident" id="3250177">output</span><span class="op" id="3250183">.</span><span class="ident" id="3250184">Write</span><span class="op" id="3250189">(</span><span class="ident" id="3250190">data</span><span class="op" id="3250194">[</span><span class="ident" id="3250195">n</span><span class="op" id="3250196">:</span><span class="op" id="3250197">]</span><span class="op" id="3250198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3250202">n</span>&nbsp;<span class="op" id="3250204">+=</span>&nbsp;<span class="ident" id="3250207">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3250210">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3250213">return</span><br>
<span class="lineno"></span><span class="op" id="3250220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3250223">//&nbsp;localError&nbsp;wraps&nbsp;locally&nbsp;caught&nbsp;errors&nbsp;so&nbsp;we&nbsp;can&nbsp;distinguish</span><br>
<span class="lineno"></span><span class="comment" id="3250287">//&nbsp;them&nbsp;from&nbsp;genuine&nbsp;panics&nbsp;which&nbsp;we&nbsp;don&#39;t&nbsp;want&nbsp;to&nbsp;return&nbsp;as&nbsp;errors.</span><br>
<span class="lineno">120</span><span class="keyword" id="3250356">type</span>&nbsp;<span class="ident" id="3250361">localError</span>&nbsp;<span class="keyword" id="3250372">struct</span>&nbsp;<span class="op" id="3250379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3250382">err</span>&nbsp;<span class="builtintype" id="3250386">error</span><br>
<span class="lineno"></span><span class="op" id="3250392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3250395">//&nbsp;printf&nbsp;is&nbsp;a&nbsp;convenience&nbsp;wrapper&nbsp;that&nbsp;takes&nbsp;care&nbsp;of&nbsp;print&nbsp;errors.</span><br>
<span class="lineno">125</span><span class="keyword" id="3250463">func</span>&nbsp;<span class="op" id="3250468">(</span><span class="ident" id="3250469">p</span>&nbsp;<span class="op" id="3250471">*</span><span class="ident" id="3250472">printer</span><span class="op" id="3250479">)</span>&nbsp;<span class="ident" id="3250481">printf</span><span class="op" id="3250487">(</span><span class="ident" id="3250488">format</span>&nbsp;<span class="builtintype" id="3250495">string</span><span class="op" id="3250501">,</span>&nbsp;<span class="ident" id="3250503">args</span>&nbsp;<span class="op" id="3250508">...</span><span class="keyword" id="3250511">interface</span><span class="op" id="3250520">{</span><span class="op" id="3250521">}</span><span class="op" id="3250522">)</span>&nbsp;<span class="op" id="3250524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3250527">if</span>&nbsp;<span class="ident" id="3250530">_</span><span class="op" id="3250531">,</span>&nbsp;<span class="ident" id="3250533">err</span>&nbsp;<span class="op" id="3250537">:=</span>&nbsp;<span class="ident" id="3250540">fmt</span><span class="op" id="3250543">.</span><span class="ident" id="3250544">Fprintf</span><span class="op" id="3250551">(</span><span class="ident" id="3250552">p</span><span class="op" id="3250553">,</span>&nbsp;<span class="ident" id="3250555">format</span><span class="op" id="3250561">,</span>&nbsp;<span class="ident" id="3250563">args</span><span class="op" id="3250567">...</span><span class="op" id="3250570">)</span><span class="op" id="3250571">;</span>&nbsp;<span class="ident" id="3250573">err</span>&nbsp;<span class="op" id="3250577">!=</span>&nbsp;<span class="builtintype" id="3250580">nil</span>&nbsp;<span class="op" id="3250584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3250588">panic</span><span class="op" id="3250593">(</span><span class="ident" id="3250594">localError</span><span class="op" id="3250604">{</span><span class="ident" id="3250605">err</span><span class="op" id="3250608">}</span><span class="op" id="3250609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3250612">}</span><br>
<span class="lineno"></span><span class="op" id="3250614">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="3250617">//&nbsp;Implementation&nbsp;note:&nbsp;Print&nbsp;is&nbsp;written&nbsp;for&nbsp;AST&nbsp;nodes&nbsp;but&nbsp;could&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="3250685">//&nbsp;used&nbsp;to&nbsp;print&nbsp;arbitrary&nbsp;data&nbsp;structures;&nbsp;such&nbsp;a&nbsp;version&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="3250751">//&nbsp;probably&nbsp;be&nbsp;in&nbsp;a&nbsp;different&nbsp;package.</span><br>
<span class="lineno"></span><span class="comment" id="3250790">//</span><br>
<span class="lineno">135</span><span class="comment" id="3250793">//&nbsp;Note:&nbsp;This&nbsp;code&nbsp;detects&nbsp;(some)&nbsp;cycles&nbsp;created&nbsp;via&nbsp;pointers&nbsp;but</span><br>
<span class="lineno"></span><span class="comment" id="3250859">//&nbsp;not&nbsp;cycles&nbsp;that&nbsp;are&nbsp;created&nbsp;via&nbsp;slices&nbsp;or&nbsp;maps&nbsp;containing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3250924">//&nbsp;same&nbsp;slice&nbsp;or&nbsp;map.&nbsp;Code&nbsp;for&nbsp;general&nbsp;data&nbsp;structures&nbsp;probably</span><br>
<span class="lineno"></span><span class="comment" id="3250988">//&nbsp;should&nbsp;catch&nbsp;those&nbsp;as&nbsp;well.</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="3251020">func</span>&nbsp;<span class="op" id="3251025">(</span><span class="ident" id="3251026">p</span>&nbsp;<span class="op" id="3251028">*</span><span class="ident" id="3251029">printer</span><span class="op" id="3251036">)</span>&nbsp;<span class="builtinfunc" id="3251038">print</span><span class="op" id="3251043">(</span><span class="ident" id="3251044">x</span>&nbsp;<span class="ident" id="3251046">reflect</span><span class="op" id="3251053">.</span><span class="ident" id="3251054">Value</span><span class="op" id="3251059">)</span>&nbsp;<span class="op" id="3251061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3251064">if</span>&nbsp;<span class="op" id="3251067">!</span><span class="ident" id="3251068">NotNilFilter</span><span class="op" id="3251080">(</span><span class="string" id="3251081">&#34;&#34;</span><span class="op" id="3251083">,</span>&nbsp;<span class="ident" id="3251085">x</span><span class="op" id="3251086">)</span>&nbsp;<span class="op" id="3251088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3251092">p</span><span class="op" id="3251093">.</span><span class="ident" id="3251094">printf</span><span class="op" id="3251100">(</span><span class="string" id="3251101">&#34;nil&#34;</span><span class="op" id="3251106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3251110">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3251118">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3251122">switch</span>&nbsp;<span class="ident" id="3251129">x</span><span class="op" id="3251130">.</span><span class="ident" id="3251131">Kind</span><span class="op" id="3251135">(</span><span class="op" id="3251136">)</span>&nbsp;<span class="op" id="3251138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3251141">case</span>&nbsp;<span class="ident" id="3251146">reflect</span><span class="op" id="3251153">.</span><span class="ident" id="3251154">Interface</span><span class="op" id="3251163">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3251167">p</span><span class="op" id="3251168">.</span><span class="builtinfunc" id="3251169">print</span><span class="op" id="3251174">(</span><span class="ident" id="3251175">x</span><span class="op" id="3251176">.</span><span class="ident" id="3251177">Elem</span><span class="op" id="3251181">(</span><span class="op" id="3251182">)</span><span class="op" id="3251183">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3251187">case</span>&nbsp;<span class="ident" id="3251192">reflect</span><span class="op" id="3251199">.</span><span class="ident" id="3251200">Map</span><span class="op" id="3251203">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3251207">p</span><span class="op" id="3251208">.</span><span class="ident" id="3251209">printf</span><span class="op" id="3251215">(</span><span class="string" id="3251216">&#34;%s&nbsp;(len&nbsp;=&nbsp;%d)&nbsp;{&#34;</span><span class="op" id="3251233">,</span>&nbsp;<span class="ident" id="3251235">x</span><span class="op" id="3251236">.</span><span class="ident" id="3251237">Type</span><span class="op" id="3251241">(</span><span class="op" id="3251242">)</span><span class="op" id="3251243">,</span>&nbsp;<span class="ident" id="3251245">x</span><span class="op" id="3251246">.</span><span class="ident" id="3251247">Len</span><span class="op" id="3251250">(</span><span class="op" id="3251251">)</span><span class="op" id="3251252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3251256">if</span>&nbsp;<span class="ident" id="3251259">x</span><span class="op" id="3251260">.</span><span class="ident" id="3251261">Len</span><span class="op" id="3251264">(</span><span class="op" id="3251265">)</span>&nbsp;<span class="op" id="3251267">&gt;</span>&nbsp;<span class="num" id="3251269">0</span>&nbsp;<span class="op" id="3251271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3251276">p</span><span class="op" id="3251277">.</span><span class="ident" id="3251278">indent</span><span class="op" id="3251284">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3251290">p</span><span class="op" id="3251291">.</span><span class="ident" id="3251292">printf</span><span class="op" id="3251298">(</span><span class="string" id="3251299">&#34;\n&#34;</span><span class="op" id="3251303">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3251308">for</span>&nbsp;<span class="ident" id="3251312">_</span><span class="op" id="3251313">,</span>&nbsp;<span class="ident" id="3251315">key</span>&nbsp;<span class="op" id="3251319">:=</span>&nbsp;<span class="keyword" id="3251322">range</span>&nbsp;<span class="ident" id="3251328">x</span><span class="op" id="3251329">.</span><span class="ident" id="3251330">MapKeys</span><span class="op" id="3251337">(</span><span class="op" id="3251338">)</span>&nbsp;<span class="op" id="3251340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3251346">p</span><span class="op" id="3251347">.</span><span class="builtinfunc" id="3251348">print</span><span class="op" id="3251353">(</span><span class="ident" id="3251354">key</span><span class="op" id="3251357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3251363">p</span><span class="op" id="3251364">.</span><span class="ident" id="3251365">printf</span><span class="op" id="3251371">(</span><span class="string" id="3251372">&#34;:&nbsp;&#34;</span><span class="op" id="3251376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3251382">p</span><span class="op" id="3251383">.</span><span class="builtinfunc" id="3251384">print</span><span class="op" id="3251389">(</span><span class="ident" id="3251390">x</span><span class="op" id="3251391">.</span><span class="ident" id="3251392">MapIndex</span><span class="op" id="3251400">(</span><span class="ident" id="3251401">key</span><span class="op" id="3251404">)</span><span class="op" id="3251405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3251411">p</span><span class="op" id="3251412">.</span><span class="ident" id="3251413">printf</span><span class="op" id="3251419">(</span><span class="string" id="3251420">&#34;\n&#34;</span><span class="op" id="3251424">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3251429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3251434">p</span><span class="op" id="3251435">.</span><span class="ident" id="3251436">indent</span><span class="op" id="3251442">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3251447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3251451">p</span><span class="op" id="3251452">.</span><span class="ident" id="3251453">printf</span><span class="op" id="3251459">(</span><span class="string" id="3251460">&#34;}&#34;</span><span class="op" id="3251463">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3251467">case</span>&nbsp;<span class="ident" id="3251472">reflect</span><span class="op" id="3251479">.</span><span class="ident" id="3251480">Ptr</span><span class="op" id="3251483">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3251487">p</span><span class="op" id="3251488">.</span><span class="ident" id="3251489">printf</span><span class="op" id="3251495">(</span><span class="string" id="3251496">&#34;*&#34;</span><span class="op" id="3251499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3251503">//&nbsp;type-checked&nbsp;ASTs&nbsp;may&nbsp;contain&nbsp;cycles&nbsp;-&nbsp;use&nbsp;ptrmap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3251558">//&nbsp;to&nbsp;keep&nbsp;track&nbsp;of&nbsp;objects&nbsp;that&nbsp;have&nbsp;been&nbsp;printed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3251611">//&nbsp;already&nbsp;and&nbsp;print&nbsp;the&nbsp;respective&nbsp;line&nbsp;number&nbsp;instead</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3251669">ptr</span>&nbsp;<span class="op" id="3251673">:=</span>&nbsp;<span class="ident" id="3251676">x</span><span class="op" id="3251677">.</span><span class="ident" id="3251678">Interface</span><span class="op" id="3251687">(</span><span class="op" id="3251688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3251692">if</span>&nbsp;<span class="ident" id="3251695">line</span><span class="op" id="3251699">,</span>&nbsp;<span class="ident" id="3251701">exists</span>&nbsp;<span class="op" id="3251708">:=</span>&nbsp;<span class="ident" id="3251711">p</span><span class="op" id="3251712">.</span><span class="ident" id="3251713">ptrmap</span><span class="op" id="3251719">[</span><span class="ident" id="3251720">ptr</span><span class="op" id="3251723">]</span><span class="op" id="3251724">;</span>&nbsp;<span class="ident" id="3251726">exists</span>&nbsp;<span class="op" id="3251733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3251738">p</span><span class="op" id="3251739">.</span><span class="ident" id="3251740">printf</span><span class="op" id="3251746">(</span><span class="string" id="3251747">&#34;(obj&nbsp;@&nbsp;%d)&#34;</span><span class="op" id="3251759">,</span>&nbsp;<span class="ident" id="3251761">line</span><span class="op" id="3251765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3251769">}</span>&nbsp;<span class="keyword" id="3251771">else</span>&nbsp;<span class="op" id="3251776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3251781">p</span><span class="op" id="3251782">.</span><span class="ident" id="3251783">ptrmap</span><span class="op" id="3251789">[</span><span class="ident" id="3251790">ptr</span><span class="op" id="3251793">]</span>&nbsp;<span class="op" id="3251795">=</span>&nbsp;<span class="ident" id="3251797">p</span><span class="op" id="3251798">.</span><span class="ident" id="3251799">line</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3251807">p</span><span class="op" id="3251808">.</span><span class="builtinfunc" id="3251809">print</span><span class="op" id="3251814">(</span><span class="ident" id="3251815">x</span><span class="op" id="3251816">.</span><span class="ident" id="3251817">Elem</span><span class="op" id="3251821">(</span><span class="op" id="3251822">)</span><span class="op" id="3251823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3251827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3251831">case</span>&nbsp;<span class="ident" id="3251836">reflect</span><span class="op" id="3251843">.</span><span class="ident" id="3251844">Array</span><span class="op" id="3251849">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3251853">p</span><span class="op" id="3251854">.</span><span class="ident" id="3251855">printf</span><span class="op" id="3251861">(</span><span class="string" id="3251862">&#34;%s&nbsp;{&#34;</span><span class="op" id="3251868">,</span>&nbsp;<span class="ident" id="3251870">x</span><span class="op" id="3251871">.</span><span class="ident" id="3251872">Type</span><span class="op" id="3251876">(</span><span class="op" id="3251877">)</span><span class="op" id="3251878">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3251882">if</span>&nbsp;<span class="ident" id="3251885">x</span><span class="op" id="3251886">.</span><span class="ident" id="3251887">Len</span><span class="op" id="3251890">(</span><span class="op" id="3251891">)</span>&nbsp;<span class="op" id="3251893">&gt;</span>&nbsp;<span class="num" id="3251895">0</span>&nbsp;<span class="op" id="3251897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3251902">p</span><span class="op" id="3251903">.</span><span class="ident" id="3251904">indent</span><span class="op" id="3251910">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3251916">p</span><span class="op" id="3251917">.</span><span class="ident" id="3251918">printf</span><span class="op" id="3251924">(</span><span class="string" id="3251925">&#34;\n&#34;</span><span class="op" id="3251929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3251934">for</span>&nbsp;<span class="ident" id="3251938">i</span><span class="op" id="3251939">,</span>&nbsp;<span class="ident" id="3251941">n</span>&nbsp;<span class="op" id="3251943">:=</span>&nbsp;<span class="num" id="3251946">0</span><span class="op" id="3251947">,</span>&nbsp;<span class="ident" id="3251949">x</span><span class="op" id="3251950">.</span><span class="ident" id="3251951">Len</span><span class="op" id="3251954">(</span><span class="op" id="3251955">)</span><span class="op" id="3251956">;</span>&nbsp;<span class="ident" id="3251958">i</span>&nbsp;<span class="op" id="3251960">&lt;</span>&nbsp;<span class="ident" id="3251962">n</span><span class="op" id="3251963">;</span>&nbsp;<span class="ident" id="3251965">i</span><span class="op" id="3251966">++</span>&nbsp;<span class="op" id="3251969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3251975">p</span><span class="op" id="3251976">.</span><span class="ident" id="3251977">printf</span><span class="op" id="3251983">(</span><span class="string" id="3251984">&#34;%d:&nbsp;&#34;</span><span class="op" id="3251990">,</span>&nbsp;<span class="ident" id="3251992">i</span><span class="op" id="3251993">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3251999">p</span><span class="op" id="3252000">.</span><span class="builtinfunc" id="3252001">print</span><span class="op" id="3252006">(</span><span class="ident" id="3252007">x</span><span class="op" id="3252008">.</span><span class="ident" id="3252009">Index</span><span class="op" id="3252014">(</span><span class="ident" id="3252015">i</span><span class="op" id="3252016">)</span><span class="op" id="3252017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252023">p</span><span class="op" id="3252024">.</span><span class="ident" id="3252025">printf</span><span class="op" id="3252031">(</span><span class="string" id="3252032">&#34;\n&#34;</span><span class="op" id="3252036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3252041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252046">p</span><span class="op" id="3252047">.</span><span class="ident" id="3252048">indent</span><span class="op" id="3252054">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3252059">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252063">p</span><span class="op" id="3252064">.</span><span class="ident" id="3252065">printf</span><span class="op" id="3252071">(</span><span class="string" id="3252072">&#34;}&#34;</span><span class="op" id="3252075">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3252079">case</span>&nbsp;<span class="ident" id="3252084">reflect</span><span class="op" id="3252091">.</span><span class="ident" id="3252092">Slice</span><span class="op" id="3252097">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3252101">if</span>&nbsp;<span class="ident" id="3252104">s</span><span class="op" id="3252105">,</span>&nbsp;<span class="ident" id="3252107">ok</span>&nbsp;<span class="op" id="3252110">:=</span>&nbsp;<span class="ident" id="3252113">x</span><span class="op" id="3252114">.</span><span class="ident" id="3252115">Interface</span><span class="op" id="3252124">(</span><span class="op" id="3252125">)</span><span class="op" id="3252126">.</span><span class="op" id="3252127">(</span><span class="op" id="3252128">[</span><span class="op" id="3252129">]</span><span class="builtintype" id="3252130">byte</span><span class="op" id="3252134">)</span><span class="op" id="3252135">;</span>&nbsp;<span class="ident" id="3252137">ok</span>&nbsp;<span class="op" id="3252140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252145">p</span><span class="op" id="3252146">.</span><span class="ident" id="3252147">printf</span><span class="op" id="3252153">(</span><span class="string" id="3252154">&#34;%#q&#34;</span><span class="op" id="3252159">,</span>&nbsp;<span class="ident" id="3252161">s</span><span class="op" id="3252162">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3252167">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3252176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252180">p</span><span class="op" id="3252181">.</span><span class="ident" id="3252182">printf</span><span class="op" id="3252188">(</span><span class="string" id="3252189">&#34;%s&nbsp;(len&nbsp;=&nbsp;%d)&nbsp;{&#34;</span><span class="op" id="3252206">,</span>&nbsp;<span class="ident" id="3252208">x</span><span class="op" id="3252209">.</span><span class="ident" id="3252210">Type</span><span class="op" id="3252214">(</span><span class="op" id="3252215">)</span><span class="op" id="3252216">,</span>&nbsp;<span class="ident" id="3252218">x</span><span class="op" id="3252219">.</span><span class="ident" id="3252220">Len</span><span class="op" id="3252223">(</span><span class="op" id="3252224">)</span><span class="op" id="3252225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3252229">if</span>&nbsp;<span class="ident" id="3252232">x</span><span class="op" id="3252233">.</span><span class="ident" id="3252234">Len</span><span class="op" id="3252237">(</span><span class="op" id="3252238">)</span>&nbsp;<span class="op" id="3252240">&gt;</span>&nbsp;<span class="num" id="3252242">0</span>&nbsp;<span class="op" id="3252244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252249">p</span><span class="op" id="3252250">.</span><span class="ident" id="3252251">indent</span><span class="op" id="3252257">++</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252263">p</span><span class="op" id="3252264">.</span><span class="ident" id="3252265">printf</span><span class="op" id="3252271">(</span><span class="string" id="3252272">&#34;\n&#34;</span><span class="op" id="3252276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3252281">for</span>&nbsp;<span class="ident" id="3252285">i</span><span class="op" id="3252286">,</span>&nbsp;<span class="ident" id="3252288">n</span>&nbsp;<span class="op" id="3252290">:=</span>&nbsp;<span class="num" id="3252293">0</span><span class="op" id="3252294">,</span>&nbsp;<span class="ident" id="3252296">x</span><span class="op" id="3252297">.</span><span class="ident" id="3252298">Len</span><span class="op" id="3252301">(</span><span class="op" id="3252302">)</span><span class="op" id="3252303">;</span>&nbsp;<span class="ident" id="3252305">i</span>&nbsp;<span class="op" id="3252307">&lt;</span>&nbsp;<span class="ident" id="3252309">n</span><span class="op" id="3252310">;</span>&nbsp;<span class="ident" id="3252312">i</span><span class="op" id="3252313">++</span>&nbsp;<span class="op" id="3252316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252322">p</span><span class="op" id="3252323">.</span><span class="ident" id="3252324">printf</span><span class="op" id="3252330">(</span><span class="string" id="3252331">&#34;%d:&nbsp;&#34;</span><span class="op" id="3252337">,</span>&nbsp;<span class="ident" id="3252339">i</span><span class="op" id="3252340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252346">p</span><span class="op" id="3252347">.</span><span class="builtinfunc" id="3252348">print</span><span class="op" id="3252353">(</span><span class="ident" id="3252354">x</span><span class="op" id="3252355">.</span><span class="ident" id="3252356">Index</span><span class="op" id="3252361">(</span><span class="ident" id="3252362">i</span><span class="op" id="3252363">)</span><span class="op" id="3252364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252370">p</span><span class="op" id="3252371">.</span><span class="ident" id="3252372">printf</span><span class="op" id="3252378">(</span><span class="string" id="3252379">&#34;\n&#34;</span><span class="op" id="3252383">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3252388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252393">p</span><span class="op" id="3252394">.</span><span class="ident" id="3252395">indent</span><span class="op" id="3252401">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3252406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252410">p</span><span class="op" id="3252411">.</span><span class="ident" id="3252412">printf</span><span class="op" id="3252418">(</span><span class="string" id="3252419">&#34;}&#34;</span><span class="op" id="3252422">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3252426">case</span>&nbsp;<span class="ident" id="3252431">reflect</span><span class="op" id="3252438">.</span><span class="ident" id="3252439">Struct</span><span class="op" id="3252445">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252449">t</span>&nbsp;<span class="op" id="3252451">:=</span>&nbsp;<span class="ident" id="3252454">x</span><span class="op" id="3252455">.</span><span class="ident" id="3252456">Type</span><span class="op" id="3252460">(</span><span class="op" id="3252461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252465">p</span><span class="op" id="3252466">.</span><span class="ident" id="3252467">printf</span><span class="op" id="3252473">(</span><span class="string" id="3252474">&#34;%s&nbsp;{&#34;</span><span class="op" id="3252480">,</span>&nbsp;<span class="ident" id="3252482">t</span><span class="op" id="3252483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252487">p</span><span class="op" id="3252488">.</span><span class="ident" id="3252489">indent</span><span class="op" id="3252495">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252500">first</span>&nbsp;<span class="op" id="3252506">:=</span>&nbsp;<span class="builtintype" id="3252509">true</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3252516">for</span>&nbsp;<span class="ident" id="3252520">i</span><span class="op" id="3252521">,</span>&nbsp;<span class="ident" id="3252523">n</span>&nbsp;<span class="op" id="3252525">:=</span>&nbsp;<span class="num" id="3252528">0</span><span class="op" id="3252529">,</span>&nbsp;<span class="ident" id="3252531">t</span><span class="op" id="3252532">.</span><span class="ident" id="3252533">NumField</span><span class="op" id="3252541">(</span><span class="op" id="3252542">)</span><span class="op" id="3252543">;</span>&nbsp;<span class="ident" id="3252545">i</span>&nbsp;<span class="op" id="3252547">&lt;</span>&nbsp;<span class="ident" id="3252549">n</span><span class="op" id="3252550">;</span>&nbsp;<span class="ident" id="3252552">i</span><span class="op" id="3252553">++</span>&nbsp;<span class="op" id="3252556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3252561">//&nbsp;exclude&nbsp;non-exported&nbsp;fields&nbsp;because&nbsp;their</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3252609">//&nbsp;values&nbsp;cannot&nbsp;be&nbsp;accessed&nbsp;via&nbsp;reflection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3252656">if</span>&nbsp;<span class="ident" id="3252659">name</span>&nbsp;<span class="op" id="3252664">:=</span>&nbsp;<span class="ident" id="3252667">t</span><span class="op" id="3252668">.</span><span class="ident" id="3252669">Field</span><span class="op" id="3252674">(</span><span class="ident" id="3252675">i</span><span class="op" id="3252676">)</span><span class="op" id="3252677">.</span><span class="ident" id="3252678">Name</span><span class="op" id="3252682">;</span>&nbsp;<span class="ident" id="3252684">IsExported</span><span class="op" id="3252694">(</span><span class="ident" id="3252695">name</span><span class="op" id="3252699">)</span>&nbsp;<span class="op" id="3252701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252707">value</span>&nbsp;<span class="op" id="3252713">:=</span>&nbsp;<span class="ident" id="3252716">x</span><span class="op" id="3252717">.</span><span class="ident" id="3252718">Field</span><span class="op" id="3252723">(</span><span class="ident" id="3252724">i</span><span class="op" id="3252725">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3252731">if</span>&nbsp;<span class="ident" id="3252734">p</span><span class="op" id="3252735">.</span><span class="ident" id="3252736">filter</span>&nbsp;<span class="op" id="3252743">==</span>&nbsp;<span class="builtintype" id="3252746">nil</span>&nbsp;<span class="op" id="3252750">||</span>&nbsp;<span class="ident" id="3252753">p</span><span class="op" id="3252754">.</span><span class="ident" id="3252755">filter</span><span class="op" id="3252761">(</span><span class="ident" id="3252762">name</span><span class="op" id="3252766">,</span>&nbsp;<span class="ident" id="3252768">value</span><span class="op" id="3252773">)</span>&nbsp;<span class="op" id="3252775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3252782">if</span>&nbsp;<span class="ident" id="3252785">first</span>&nbsp;<span class="op" id="3252791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252799">p</span><span class="op" id="3252800">.</span><span class="ident" id="3252801">printf</span><span class="op" id="3252807">(</span><span class="string" id="3252808">&#34;\n&#34;</span><span class="op" id="3252812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252820">first</span>&nbsp;<span class="op" id="3252826">=</span>&nbsp;<span class="builtintype" id="3252828">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3252839">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252846">p</span><span class="op" id="3252847">.</span><span class="ident" id="3252848">printf</span><span class="op" id="3252854">(</span><span class="string" id="3252855">&#34;%s:&nbsp;&#34;</span><span class="op" id="3252861">,</span>&nbsp;<span class="ident" id="3252863">name</span><span class="op" id="3252867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252874">p</span><span class="op" id="3252875">.</span><span class="builtinfunc" id="3252876">print</span><span class="op" id="3252881">(</span><span class="ident" id="3252882">value</span><span class="op" id="3252887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252894">p</span><span class="op" id="3252895">.</span><span class="ident" id="3252896">printf</span><span class="op" id="3252902">(</span><span class="string" id="3252903">&#34;\n&#34;</span><span class="op" id="3252907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3252913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3252918">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3252922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252926">p</span><span class="op" id="3252927">.</span><span class="ident" id="3252928">indent</span><span class="op" id="3252934">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252939">p</span><span class="op" id="3252940">.</span><span class="ident" id="3252941">printf</span><span class="op" id="3252947">(</span><span class="string" id="3252948">&#34;}&#34;</span><span class="op" id="3252951">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3252955">default</span><span class="op" id="3252962">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3252966">v</span>&nbsp;<span class="op" id="3252968">:=</span>&nbsp;<span class="ident" id="3252971">x</span><span class="op" id="3252972">.</span><span class="ident" id="3252973">Interface</span><span class="op" id="3252982">(</span><span class="op" id="3252983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3252987">switch</span>&nbsp;<span class="ident" id="3252994">v</span>&nbsp;<span class="op" id="3252996">:=</span>&nbsp;<span class="ident" id="3252999">v</span><span class="op" id="3253000">.</span><span class="op" id="3253001">(</span><span class="keyword" id="3253002">type</span><span class="op" id="3253006">)</span>&nbsp;<span class="op" id="3253008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3253012">case</span>&nbsp;<span class="builtintype" id="3253017">string</span><span class="op" id="3253023">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3253028">//&nbsp;print&nbsp;strings&nbsp;in&nbsp;quotes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3253058">p</span><span class="op" id="3253059">.</span><span class="ident" id="3253060">printf</span><span class="op" id="3253066">(</span><span class="string" id="3253067">&#34;%q&#34;</span><span class="op" id="3253071">,</span>&nbsp;<span class="ident" id="3253073">v</span><span class="op" id="3253074">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3253079">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3253088">case</span>&nbsp;<span class="ident" id="3253093">token</span><span class="op" id="3253098">.</span><span class="ident" id="3253099">Pos</span><span class="op" id="3253102">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3253107">//&nbsp;position&nbsp;values&nbsp;can&nbsp;be&nbsp;printed&nbsp;nicely&nbsp;if&nbsp;we&nbsp;have&nbsp;a&nbsp;file&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3253173">if</span>&nbsp;<span class="ident" id="3253176">p</span><span class="op" id="3253177">.</span><span class="ident" id="3253178">fset</span>&nbsp;<span class="op" id="3253183">!=</span>&nbsp;<span class="builtintype" id="3253186">nil</span>&nbsp;<span class="op" id="3253190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3253196">p</span><span class="op" id="3253197">.</span><span class="ident" id="3253198">printf</span><span class="op" id="3253204">(</span><span class="string" id="3253205">&#34;%s&#34;</span><span class="op" id="3253209">,</span>&nbsp;<span class="ident" id="3253211">p</span><span class="op" id="3253212">.</span><span class="ident" id="3253213">fset</span><span class="op" id="3253217">.</span><span class="ident" id="3253218">Position</span><span class="op" id="3253226">(</span><span class="ident" id="3253227">v</span><span class="op" id="3253228">)</span><span class="op" id="3253229">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3253235">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3253245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3253249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3253253">//&nbsp;default</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3253266">p</span><span class="op" id="3253267">.</span><span class="ident" id="3253268">printf</span><span class="op" id="3253274">(</span><span class="string" id="3253275">&#34;%v&#34;</span><span class="op" id="3253279">,</span>&nbsp;<span class="ident" id="3253281">v</span><span class="op" id="3253282">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3253285">}</span><br>
<span class="lineno"></span><span class="op" id="3253287">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
