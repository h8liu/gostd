<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1972138">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1972193">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1972247">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1972298">package</span>&nbsp;<span class="ident" id="1972306">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1972312">const</span>&nbsp;<span class="op" id="1972318">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972321">uvnan</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1972330">=</span>&nbsp;<span class="num" id="1972332">0x7FF8000000000001</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972352">uvinf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1972361">=</span>&nbsp;<span class="num" id="1972363">0x7FF0000000000000</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972383">uvneginf</span>&nbsp;<span class="op" id="1972392">=</span>&nbsp;<span class="num" id="1972394">0xFFF0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972414">mask</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1972423">=</span>&nbsp;<span class="num" id="1972425">0x7FF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972432">shift</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1972441">=</span>&nbsp;<span class="num" id="1972443">64</span>&nbsp;<span class="op" id="1972446">-</span>&nbsp;<span class="num" id="1972448">11</span>&nbsp;<span class="op" id="1972451">-</span>&nbsp;<span class="num" id="1972453">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972456">bias</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1972465">=</span>&nbsp;<span class="num" id="1972467">1023</span><br>
<span class="lineno"></span><span class="op" id="1972472">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="1972475">//&nbsp;Inf&nbsp;returns&nbsp;positive&nbsp;infinity&nbsp;if&nbsp;sign&nbsp;&gt;=&nbsp;0,&nbsp;negative&nbsp;infinity&nbsp;if&nbsp;sign&nbsp;&lt;&nbsp;0.</span><br>
<span class="lineno"></span><span class="keyword" id="1972553">func</span>&nbsp;<span class="ident" id="1972558">Inf</span><span class="op" id="1972561">(</span><span class="ident" id="1972562">sign</span>&nbsp;<span class="builtintype" id="1972567">int</span><span class="op" id="1972570">)</span>&nbsp;<span class="builtintype" id="1972572">float64</span>&nbsp;<span class="op" id="1972580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972583">var</span>&nbsp;<span class="ident" id="1972587">v</span>&nbsp;<span class="ident" id="1972589">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972597">if</span>&nbsp;<span class="ident" id="1972600">sign</span>&nbsp;<span class="op" id="1972605">&gt;=</span>&nbsp;<span class="num" id="1972608">0</span>&nbsp;<span class="op" id="1972610">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972614">v</span>&nbsp;<span class="op" id="1972616">=</span>&nbsp;<span class="ident" id="1972618">uvinf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1972625">}</span>&nbsp;<span class="keyword" id="1972627">else</span>&nbsp;<span class="op" id="1972632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1972636">v</span>&nbsp;<span class="op" id="1972638">=</span>&nbsp;<span class="ident" id="1972640">uvneginf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1972650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1972653">return</span>&nbsp;<span class="ident" id="1972660">Float64frombits</span><span class="op" id="1972675">(</span><span class="ident" id="1972676">v</span><span class="op" id="1972677">)</span><br>
<span class="lineno">25</span><span class="op" id="1972679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1972682">//&nbsp;NaN&nbsp;returns&nbsp;an&nbsp;IEEE&nbsp;754&nbsp;``not-a-number&#39;&#39;&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="1972733">func</span>&nbsp;<span class="ident" id="1972738">NaN</span><span class="op" id="1972741">(</span><span class="op" id="1972742">)</span>&nbsp;<span class="builtintype" id="1972744">float64</span>&nbsp;<span class="op" id="1972752">{</span>&nbsp;<span class="keyword" id="1972754">return</span>&nbsp;<span class="ident" id="1972761">Float64frombits</span><span class="op" id="1972776">(</span><span class="ident" id="1972777">uvnan</span><span class="op" id="1972782">)</span>&nbsp;<span class="op" id="1972784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="1972787">//&nbsp;IsNaN&nbsp;reports&nbsp;whether&nbsp;f&nbsp;is&nbsp;an&nbsp;IEEE&nbsp;754&nbsp;``not-a-number&#39;&#39;&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="1972853">func</span>&nbsp;<span class="ident" id="1972858">IsNaN</span><span class="op" id="1972863">(</span><span class="ident" id="1972864">f</span>&nbsp;<span class="builtintype" id="1972866">float64</span><span class="op" id="1972873">)</span>&nbsp;<span class="op" id="1972875">(</span><span class="ident" id="1972876">is</span>&nbsp;<span class="builtintype" id="1972879">bool</span><span class="op" id="1972883">)</span>&nbsp;<span class="op" id="1972885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1972888">//&nbsp;IEEE&nbsp;754&nbsp;says&nbsp;that&nbsp;only&nbsp;NaNs&nbsp;satisfy&nbsp;f&nbsp;!=&nbsp;f.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1972937">//&nbsp;To&nbsp;avoid&nbsp;the&nbsp;floating-point&nbsp;hardware,&nbsp;could&nbsp;use:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1972990">//&nbsp;&nbsp;&nbsp;&nbspx&nbsp;:=&nbsp;Float64bits(f);</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1973015">//&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;uint32(x&gt;&gt;shift)&amp;mask&nbsp;==&nbsp;mask&nbsp;&amp;&amp;&nbsp;x&nbsp;!=&nbsp;uvinf&nbsp;&amp;&amp;&nbsp;x&nbsp;!=&nbsp;uvneginf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973087">return</span>&nbsp;<span class="ident" id="1973094">f</span>&nbsp;<span class="op" id="1973096">!=</span>&nbsp;<span class="ident" id="1973099">f</span><br>
<span class="lineno"></span><span class="op" id="1973101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1973104">//&nbsp;IsInf&nbsp;reports&nbsp;whether&nbsp;f&nbsp;is&nbsp;an&nbsp;infinity,&nbsp;according&nbsp;to&nbsp;sign.</span><br>
<span class="lineno">40</span><span class="comment" id="1973166">//&nbsp;If&nbsp;sign&nbsp;&gt;&nbsp;0,&nbsp;IsInf&nbsp;reports&nbsp;whether&nbsp;f&nbsp;is&nbsp;positive&nbsp;infinity.</span><br>
<span class="lineno"></span><span class="comment" id="1973228">//&nbsp;If&nbsp;sign&nbsp;&lt;&nbsp;0,&nbsp;IsInf&nbsp;reports&nbsp;whether&nbsp;f&nbsp;is&nbsp;negative&nbsp;infinity.</span><br>
<span class="lineno"></span><span class="comment" id="1973290">//&nbsp;If&nbsp;sign&nbsp;==&nbsp;0,&nbsp;IsInf&nbsp;reports&nbsp;whether&nbsp;f&nbsp;is&nbsp;either&nbsp;infinity.</span><br>
<span class="lineno"></span><span class="keyword" id="1973351">func</span>&nbsp;<span class="ident" id="1973356">IsInf</span><span class="op" id="1973361">(</span><span class="ident" id="1973362">f</span>&nbsp;<span class="builtintype" id="1973364">float64</span><span class="op" id="1973371">,</span>&nbsp;<span class="ident" id="1973373">sign</span>&nbsp;<span class="builtintype" id="1973378">int</span><span class="op" id="1973381">)</span>&nbsp;<span class="builtintype" id="1973383">bool</span>&nbsp;<span class="op" id="1973388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1973391">//&nbsp;Test&nbsp;for&nbsp;infinity&nbsp;by&nbsp;comparing&nbsp;against&nbsp;maximum&nbsp;float.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1973449">//&nbsp;To&nbsp;avoid&nbsp;the&nbsp;floating-point&nbsp;hardware,&nbsp;could&nbsp;use:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1973502">//&nbsp;&nbsp;&nbsp;&nbspx&nbsp;:=&nbsp;Float64bits(f);</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1973527">//&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;sign&nbsp;&gt;=&nbsp;0&nbsp;&amp;&amp;&nbsp;x&nbsp;==&nbsp;uvinf&nbsp;||&nbsp;sign&nbsp;&lt;=&nbsp;0&nbsp;&amp;&amp;&nbsp;x&nbsp;==&nbsp;uvneginf;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973593">return</span>&nbsp;<span class="ident" id="1973600">sign</span>&nbsp;<span class="op" id="1973605">&gt;=</span>&nbsp;<span class="num" id="1973608">0</span>&nbsp;<span class="op" id="1973610">&amp;&amp;</span>&nbsp;<span class="ident" id="1973613">f</span>&nbsp;<span class="op" id="1973615">&gt;</span>&nbsp;<span class="ident" id="1973617">MaxFloat64</span>&nbsp;<span class="op" id="1973628">||</span>&nbsp;<span class="ident" id="1973631">sign</span>&nbsp;<span class="op" id="1973636">&lt;=</span>&nbsp;<span class="num" id="1973639">0</span>&nbsp;<span class="op" id="1973641">&amp;&amp;</span>&nbsp;<span class="ident" id="1973644">f</span>&nbsp;<span class="op" id="1973646">&lt;</span>&nbsp;<span class="op" id="1973648">-</span><span class="ident" id="1973649">MaxFloat64</span><br>
<span class="lineno"></span><span class="op" id="1973660">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="1973663">//&nbsp;normalize&nbsp;returns&nbsp;a&nbsp;normal&nbsp;number&nbsp;y&nbsp;and&nbsp;exponent&nbsp;exp</span><br>
<span class="lineno"></span><span class="comment" id="1973719">//&nbsp;satisfying&nbsp;x&nbsp;==&nbsp;y&nbsp;Ã—&nbsp;2**exp.&nbsp;It&nbsp;assumes&nbsp;x&nbsp;is&nbsp;finite&nbsp;and&nbsp;non-zero.</span><br>
<span class="lineno"></span><span class="keyword" id="1973788">func</span>&nbsp;<span class="ident" id="1973793">normalize</span><span class="op" id="1973802">(</span><span class="ident" id="1973803">x</span>&nbsp;<span class="builtintype" id="1973805">float64</span><span class="op" id="1973812">)</span>&nbsp;<span class="op" id="1973814">(</span><span class="ident" id="1973815">y</span>&nbsp;<span class="builtintype" id="1973817">float64</span><span class="op" id="1973824">,</span>&nbsp;<span class="ident" id="1973826">exp</span>&nbsp;<span class="builtintype" id="1973830">int</span><span class="op" id="1973833">)</span>&nbsp;<span class="op" id="1973835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973838">const</span>&nbsp;<span class="ident" id="1973844">SmallestNormal</span>&nbsp;<span class="op" id="1973859">=</span>&nbsp;<span class="num" id="1973861">2.2250738585072014e-308</span>&nbsp;<span class="comment" id="1973885">//&nbsp;2**-1022</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973898">if</span>&nbsp;<span class="ident" id="1973901">Abs</span><span class="op" id="1973904">(</span><span class="ident" id="1973905">x</span><span class="op" id="1973906">)</span>&nbsp;<span class="op" id="1973908">&lt;</span>&nbsp;<span class="ident" id="1973910">SmallestNormal</span>&nbsp;<span class="op" id="1973925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973929">return</span>&nbsp;<span class="ident" id="1973936">x</span>&nbsp;<span class="op" id="1973938">*</span>&nbsp;<span class="op" id="1973940">(</span><span class="num" id="1973941">1</span>&nbsp;<span class="op" id="1973943">&lt;&lt;</span>&nbsp;<span class="num" id="1973946">52</span><span class="op" id="1973948">)</span><span class="op" id="1973949">,</span>&nbsp;<span class="op" id="1973951">-</span><span class="num" id="1973952">52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1973956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1973959">return</span>&nbsp;<span class="ident" id="1973966">x</span><span class="op" id="1973967">,</span>&nbsp;<span class="num" id="1973969">0</span><br>
<span class="lineno"></span><span class="op" id="1973971">}</span>
</div>
</body>
</html>
