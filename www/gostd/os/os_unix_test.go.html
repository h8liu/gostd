<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="667436">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="667491">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="667545">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="667596">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="667661">package</span>&nbsp;<span class="ident" id="667669">os_test</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="667678">import</span>&nbsp;<span class="op" id="667685">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="667688">.</span>&nbsp;<span class="string" id="667690">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="667696">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="667707">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="667718">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="667728">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="667731">func</span>&nbsp;<span class="ident" id="667736">checkUidGid</span><span class="op" id="667747">(</span><span class="ident" id="667748">t</span>&nbsp;<span class="op" id="667750">*</span><span class="ident" id="667751">testing</span><span class="op" id="667758">.</span><span class="ident" id="667759">T</span><span class="op" id="667760">,</span>&nbsp;<span class="ident" id="667762">path</span>&nbsp;<span class="builtintype" id="667767">string</span><span class="op" id="667773">,</span>&nbsp;<span class="ident" id="667775">uid</span><span class="op" id="667778">,</span>&nbsp;<span class="ident" id="667780">gid</span>&nbsp;<span class="builtintype" id="667784">int</span><span class="op" id="667787">)</span>&nbsp;<span class="op" id="667789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="667792">dir</span><span class="op" id="667795">,</span>&nbsp;<span class="ident" id="667797">err</span>&nbsp;<span class="op" id="667801">:=</span>&nbsp;<span class="ident" id="667804">Stat</span><span class="op" id="667808">(</span><span class="ident" id="667809">path</span><span class="op" id="667813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="667816">if</span>&nbsp;<span class="ident" id="667819">err</span>&nbsp;<span class="op" id="667823">!=</span>&nbsp;<span class="ident" id="667826">nil</span>&nbsp;<span class="op" id="667830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="667834">t</span><span class="op" id="667835">.</span><span class="ident" id="667836">Fatalf</span><span class="op" id="667842">(</span><span class="string" id="667843">&#34;Stat&nbsp;%q&nbsp;(looking&nbsp;for&nbsp;uid/gid&nbsp;%d/%d):&nbsp;%s&#34;</span><span class="op" id="667884">,</span>&nbsp;<span class="ident" id="667886">path</span><span class="op" id="667890">,</span>&nbsp;<span class="ident" id="667892">uid</span><span class="op" id="667895">,</span>&nbsp;<span class="ident" id="667897">gid</span><span class="op" id="667900">,</span>&nbsp;<span class="ident" id="667902">err</span><span class="op" id="667905">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="667908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="667911">sys</span>&nbsp;<span class="op" id="667915">:=</span>&nbsp;<span class="ident" id="667918">dir</span><span class="op" id="667921">.</span><span class="ident" id="667922">Sys</span><span class="op" id="667925">(</span><span class="op" id="667926">)</span><span class="op" id="667927">.</span><span class="op" id="667928">(</span><span class="op" id="667929">*</span><span class="ident" id="667930">syscall</span><span class="op" id="667937">.</span><span class="ident" id="667938">Stat_t</span><span class="op" id="667944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="667947">if</span>&nbsp;<span class="builtintype" id="667950">int</span><span class="op" id="667953">(</span><span class="ident" id="667954">sys</span><span class="op" id="667957">.</span><span class="ident" id="667958">Uid</span><span class="op" id="667961">)</span>&nbsp;<span class="op" id="667963">!=</span>&nbsp;<span class="ident" id="667966">uid</span>&nbsp;<span class="op" id="667970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="667974">t</span><span class="op" id="667975">.</span><span class="ident" id="667976">Errorf</span><span class="op" id="667982">(</span><span class="string" id="667983">&#34;Stat&nbsp;%q:&nbsp;uid&nbsp;%d&nbsp;want&nbsp;%d&#34;</span><span class="op" id="668008">,</span>&nbsp;<span class="ident" id="668010">path</span><span class="op" id="668014">,</span>&nbsp;<span class="ident" id="668016">sys</span><span class="op" id="668019">.</span><span class="ident" id="668020">Uid</span><span class="op" id="668023">,</span>&nbsp;<span class="ident" id="668025">uid</span><span class="op" id="668028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="668031">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="668034">if</span>&nbsp;<span class="builtintype" id="668037">int</span><span class="op" id="668040">(</span><span class="ident" id="668041">sys</span><span class="op" id="668044">.</span><span class="ident" id="668045">Gid</span><span class="op" id="668048">)</span>&nbsp;<span class="op" id="668050">!=</span>&nbsp;<span class="ident" id="668053">gid</span>&nbsp;<span class="op" id="668057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="668061">t</span><span class="op" id="668062">.</span><span class="ident" id="668063">Errorf</span><span class="op" id="668069">(</span><span class="string" id="668070">&#34;Stat&nbsp;%q:&nbsp;gid&nbsp;%d&nbsp;want&nbsp;%d&#34;</span><span class="op" id="668095">,</span>&nbsp;<span class="ident" id="668097">path</span><span class="op" id="668101">,</span>&nbsp;<span class="ident" id="668103">sys</span><span class="op" id="668106">.</span><span class="ident" id="668107">Gid</span><span class="op" id="668110">,</span>&nbsp;<span class="ident" id="668112">gid</span><span class="op" id="668115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="668118">}</span><br>
<span class="lineno"></span><span class="op" id="668120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="668123">func</span>&nbsp;<span class="ident" id="668128">TestChown</span><span class="op" id="668137">(</span><span class="ident" id="668138">t</span>&nbsp;<span class="op" id="668140">*</span><span class="ident" id="668141">testing</span><span class="op" id="668148">.</span><span class="ident" id="668149">T</span><span class="op" id="668150">)</span>&nbsp;<span class="op" id="668152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="668155">//&nbsp;Chown&nbsp;is&nbsp;not&nbsp;supported&nbsp;under&nbsp;windows&nbsp;os&nbsp;Plan&nbsp;9.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="668207">//&nbsp;Plan9&nbsp;provides&nbsp;a&nbsp;native&nbsp;ChownPlan9&nbsp;version&nbsp;instead.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="668263">if</span>&nbsp;<span class="ident" id="668266">runtime</span><span class="op" id="668273">.</span><span class="ident" id="668274">GOOS</span>&nbsp;<span class="op" id="668279">==</span>&nbsp;<span class="string" id="668282">&#34;windows&#34;</span>&nbsp;<span class="op" id="668292">||</span>&nbsp;<span class="ident" id="668295">runtime</span><span class="op" id="668302">.</span><span class="ident" id="668303">GOOS</span>&nbsp;<span class="op" id="668308">==</span>&nbsp;<span class="string" id="668311">&#34;plan9&#34;</span>&nbsp;<span class="op" id="668319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="668323">return</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="668331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="668334">//&nbsp;Use&nbsp;TempDir()&nbsp;to&nbsp;make&nbsp;sure&nbsp;we&#39;re&nbsp;on&nbsp;a&nbsp;local&nbsp;file&nbsp;system,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="668395">//&nbsp;so&nbsp;that&nbsp;the&nbsp;group&nbsp;ids&nbsp;returned&nbsp;by&nbsp;Getgroups&nbsp;will&nbsp;be&nbsp;allowed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="668459">//&nbsp;on&nbsp;the&nbsp;file.&nbsp;&nbsp;On&nbsp;NFS,&nbsp;the&nbsp;Getgroups&nbsp;groups&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="668510">//&nbsp;basically&nbsp;useless.</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="668533">f</span>&nbsp;<span class="op" id="668535">:=</span>&nbsp;<span class="ident" id="668538">newFile</span><span class="op" id="668545">(</span><span class="string" id="668546">&#34;TestChown&#34;</span><span class="op" id="668557">,</span>&nbsp;<span class="ident" id="668559">t</span><span class="op" id="668560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="668563">defer</span>&nbsp;<span class="ident" id="668569">Remove</span><span class="op" id="668575">(</span><span class="ident" id="668576">f</span><span class="op" id="668577">.</span><span class="ident" id="668578">Name</span><span class="op" id="668582">(</span><span class="op" id="668583">)</span><span class="op" id="668584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="668587">defer</span>&nbsp;<span class="ident" id="668593">f</span><span class="op" id="668594">.</span><span class="ident" id="668595">Close</span><span class="op" id="668600">(</span><span class="op" id="668601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="668604">dir</span><span class="op" id="668607">,</span>&nbsp;<span class="ident" id="668609">err</span>&nbsp;<span class="op" id="668613">:=</span>&nbsp;<span class="ident" id="668616">f</span><span class="op" id="668617">.</span><span class="ident" id="668618">Stat</span><span class="op" id="668622">(</span><span class="op" id="668623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="668626">if</span>&nbsp;<span class="ident" id="668629">err</span>&nbsp;<span class="op" id="668633">!=</span>&nbsp;<span class="ident" id="668636">nil</span>&nbsp;<span class="op" id="668640">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="668644">t</span><span class="op" id="668645">.</span><span class="ident" id="668646">Fatalf</span><span class="op" id="668652">(</span><span class="string" id="668653">&#34;stat&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="668666">,</span>&nbsp;<span class="ident" id="668668">f</span><span class="op" id="668669">.</span><span class="ident" id="668670">Name</span><span class="op" id="668674">(</span><span class="op" id="668675">)</span><span class="op" id="668676">,</span>&nbsp;<span class="ident" id="668678">err</span><span class="op" id="668681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="668684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="668688">//&nbsp;Can&#39;t&nbsp;change&nbsp;uid&nbsp;unless&nbsp;root,&nbsp;but&nbsp;can&nbsp;try</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="668734">//&nbsp;changing&nbsp;the&nbsp;group&nbsp;id.&nbsp;&nbsp;First&nbsp;try&nbsp;our&nbsp;current&nbsp;group.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="668791">gid</span>&nbsp;<span class="op" id="668795">:=</span>&nbsp;<span class="ident" id="668798">Getgid</span><span class="op" id="668804">(</span><span class="op" id="668805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="668808">t</span><span class="op" id="668809">.</span><span class="ident" id="668810">Log</span><span class="op" id="668813">(</span><span class="string" id="668814">&#34;gid:&#34;</span><span class="op" id="668820">,</span>&nbsp;<span class="ident" id="668822">gid</span><span class="op" id="668825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="668828">if</span>&nbsp;<span class="ident" id="668831">err</span>&nbsp;<span class="op" id="668835">=</span>&nbsp;<span class="ident" id="668837">Chown</span><span class="op" id="668842">(</span><span class="ident" id="668843">f</span><span class="op" id="668844">.</span><span class="ident" id="668845">Name</span><span class="op" id="668849">(</span><span class="op" id="668850">)</span><span class="op" id="668851">,</span>&nbsp;<span class="op" id="668853">-</span><span class="num" id="668854">1</span><span class="op" id="668855">,</span>&nbsp;<span class="ident" id="668857">gid</span><span class="op" id="668860">)</span><span class="op" id="668861">;</span>&nbsp;<span class="ident" id="668863">err</span>&nbsp;<span class="op" id="668867">!=</span>&nbsp;<span class="ident" id="668870">nil</span>&nbsp;<span class="op" id="668874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="668878">t</span><span class="op" id="668879">.</span><span class="ident" id="668880">Fatalf</span><span class="op" id="668886">(</span><span class="string" id="668887">&#34;chown&nbsp;%s&nbsp;-1&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="668907">,</span>&nbsp;<span class="ident" id="668909">f</span><span class="op" id="668910">.</span><span class="ident" id="668911">Name</span><span class="op" id="668915">(</span><span class="op" id="668916">)</span><span class="op" id="668917">,</span>&nbsp;<span class="ident" id="668919">gid</span><span class="op" id="668922">,</span>&nbsp;<span class="ident" id="668924">err</span><span class="op" id="668927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="668930">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="668933">sys</span>&nbsp;<span class="op" id="668937">:=</span>&nbsp;<span class="ident" id="668940">dir</span><span class="op" id="668943">.</span><span class="ident" id="668944">Sys</span><span class="op" id="668947">(</span><span class="op" id="668948">)</span><span class="op" id="668949">.</span><span class="op" id="668950">(</span><span class="op" id="668951">*</span><span class="ident" id="668952">syscall</span><span class="op" id="668959">.</span><span class="ident" id="668960">Stat_t</span><span class="op" id="668966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="668969">checkUidGid</span><span class="op" id="668980">(</span><span class="ident" id="668981">t</span><span class="op" id="668982">,</span>&nbsp;<span class="ident" id="668984">f</span><span class="op" id="668985">.</span><span class="ident" id="668986">Name</span><span class="op" id="668990">(</span><span class="op" id="668991">)</span><span class="op" id="668992">,</span>&nbsp;<span class="builtintype" id="668994">int</span><span class="op" id="668997">(</span><span class="ident" id="668998">sys</span><span class="op" id="669001">.</span><span class="ident" id="669002">Uid</span><span class="op" id="669005">)</span><span class="op" id="669006">,</span>&nbsp;<span class="ident" id="669008">gid</span><span class="op" id="669011">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="669015">//&nbsp;Then&nbsp;try&nbsp;all&nbsp;the&nbsp;auxiliary&nbsp;groups.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="669054">groups</span><span class="op" id="669060">,</span>&nbsp;<span class="ident" id="669062">err</span>&nbsp;<span class="op" id="669066">:=</span>&nbsp;<span class="ident" id="669069">Getgroups</span><span class="op" id="669078">(</span><span class="op" id="669079">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="669082">if</span>&nbsp;<span class="ident" id="669085">err</span>&nbsp;<span class="op" id="669089">!=</span>&nbsp;<span class="ident" id="669092">nil</span>&nbsp;<span class="op" id="669096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="669100">t</span><span class="op" id="669101">.</span><span class="ident" id="669102">Fatalf</span><span class="op" id="669108">(</span><span class="string" id="669109">&#34;getgroups:&nbsp;%s&#34;</span><span class="op" id="669124">,</span>&nbsp;<span class="ident" id="669126">err</span><span class="op" id="669129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="669132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="669135">t</span><span class="op" id="669136">.</span><span class="ident" id="669137">Log</span><span class="op" id="669140">(</span><span class="string" id="669141">&#34;groups:&nbsp;&#34;</span><span class="op" id="669151">,</span>&nbsp;<span class="ident" id="669153">groups</span><span class="op" id="669159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="669162">for</span>&nbsp;<span class="ident" id="669166">_</span><span class="op" id="669167">,</span>&nbsp;<span class="ident" id="669169">g</span>&nbsp;<span class="op" id="669171">:=</span>&nbsp;<span class="keyword" id="669174">range</span>&nbsp;<span class="ident" id="669180">groups</span>&nbsp;<span class="op" id="669187">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="669191">if</span>&nbsp;<span class="ident" id="669194">err</span>&nbsp;<span class="op" id="669198">=</span>&nbsp;<span class="ident" id="669200">Chown</span><span class="op" id="669205">(</span><span class="ident" id="669206">f</span><span class="op" id="669207">.</span><span class="ident" id="669208">Name</span><span class="op" id="669212">(</span><span class="op" id="669213">)</span><span class="op" id="669214">,</span>&nbsp;<span class="op" id="669216">-</span><span class="num" id="669217">1</span><span class="op" id="669218">,</span>&nbsp;<span class="ident" id="669220">g</span><span class="op" id="669221">)</span><span class="op" id="669222">;</span>&nbsp;<span class="ident" id="669224">err</span>&nbsp;<span class="op" id="669228">!=</span>&nbsp;<span class="ident" id="669231">nil</span>&nbsp;<span class="op" id="669235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="669240">t</span><span class="op" id="669241">.</span><span class="ident" id="669242">Fatalf</span><span class="op" id="669248">(</span><span class="string" id="669249">&#34;chown&nbsp;%s&nbsp;-1&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="669269">,</span>&nbsp;<span class="ident" id="669271">f</span><span class="op" id="669272">.</span><span class="ident" id="669273">Name</span><span class="op" id="669277">(</span><span class="op" id="669278">)</span><span class="op" id="669279">,</span>&nbsp;<span class="ident" id="669281">g</span><span class="op" id="669282">,</span>&nbsp;<span class="ident" id="669284">err</span><span class="op" id="669287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="669291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="669295">checkUidGid</span><span class="op" id="669306">(</span><span class="ident" id="669307">t</span><span class="op" id="669308">,</span>&nbsp;<span class="ident" id="669310">f</span><span class="op" id="669311">.</span><span class="ident" id="669312">Name</span><span class="op" id="669316">(</span><span class="op" id="669317">)</span><span class="op" id="669318">,</span>&nbsp;<span class="builtintype" id="669320">int</span><span class="op" id="669323">(</span><span class="ident" id="669324">sys</span><span class="op" id="669327">.</span><span class="ident" id="669328">Uid</span><span class="op" id="669331">)</span><span class="op" id="669332">,</span>&nbsp;<span class="ident" id="669334">g</span><span class="op" id="669335">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="669340">//&nbsp;change&nbsp;back&nbsp;to&nbsp;gid&nbsp;to&nbsp;test&nbsp;fd.Chown</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="669381">if</span>&nbsp;<span class="ident" id="669384">err</span>&nbsp;<span class="op" id="669388">=</span>&nbsp;<span class="ident" id="669390">f</span><span class="op" id="669391">.</span><span class="ident" id="669392">Chown</span><span class="op" id="669397">(</span><span class="op" id="669398">-</span><span class="num" id="669399">1</span><span class="op" id="669400">,</span>&nbsp;<span class="ident" id="669402">gid</span><span class="op" id="669405">)</span><span class="op" id="669406">;</span>&nbsp;<span class="ident" id="669408">err</span>&nbsp;<span class="op" id="669412">!=</span>&nbsp;<span class="ident" id="669415">nil</span>&nbsp;<span class="op" id="669419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="669424">t</span><span class="op" id="669425">.</span><span class="ident" id="669426">Fatalf</span><span class="op" id="669432">(</span><span class="string" id="669433">&#34;fchown&nbsp;%s&nbsp;-1&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="669454">,</span>&nbsp;<span class="ident" id="669456">f</span><span class="op" id="669457">.</span><span class="ident" id="669458">Name</span><span class="op" id="669462">(</span><span class="op" id="669463">)</span><span class="op" id="669464">,</span>&nbsp;<span class="ident" id="669466">gid</span><span class="op" id="669469">,</span>&nbsp;<span class="ident" id="669471">err</span><span class="op" id="669474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="669478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="669482">checkUidGid</span><span class="op" id="669493">(</span><span class="ident" id="669494">t</span><span class="op" id="669495">,</span>&nbsp;<span class="ident" id="669497">f</span><span class="op" id="669498">.</span><span class="ident" id="669499">Name</span><span class="op" id="669503">(</span><span class="op" id="669504">)</span><span class="op" id="669505">,</span>&nbsp;<span class="builtintype" id="669507">int</span><span class="op" id="669510">(</span><span class="ident" id="669511">sys</span><span class="op" id="669514">.</span><span class="ident" id="669515">Uid</span><span class="op" id="669518">)</span><span class="op" id="669519">,</span>&nbsp;<span class="ident" id="669521">gid</span><span class="op" id="669524">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="669527">}</span><br>
<span class="lineno"></span><span class="op" id="669529">}</span>
</div>
</body>
</html>
