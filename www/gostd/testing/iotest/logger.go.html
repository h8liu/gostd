<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing/iotest</h2>
<ul>
<li><a href="/gostd/testing/iotest/logger.go.html" class="current">logger.go</a></li>
<li><a href="/gostd/testing/iotest/reader.go.html">reader.go</a></li>
<li><a href="/gostd/testing/iotest/writer.go.html">writer.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5693291">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5693346">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5693400">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5693451">package</span>&nbsp;<span class="ident" id="5693459">iotest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5693467">import</span>&nbsp;<span class="op" id="5693474">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5693477">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5693483">&#34;log&#34;</span><br>
<span class="lineno">10</span><span class="op" id="5693489">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5693492">type</span>&nbsp;<span class="ident" id="5693497">writeLogger</span>&nbsp;<span class="keyword" id="5693509">struct</span>&nbsp;<span class="op" id="5693516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5693519">prefix</span>&nbsp;<span class="builtintype" id="5693526">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5693534">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5693541">io</span><span class="op" id="5693543">.</span><span class="ident" id="5693544">Writer</span><br>
<span class="lineno">15</span><span class="op" id="5693551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5693554">func</span>&nbsp;<span class="op" id="5693559">(</span><span class="ident" id="5693560">l</span>&nbsp;<span class="op" id="5693562">*</span><span class="ident" id="5693563">writeLogger</span><span class="op" id="5693574">)</span>&nbsp;<span class="ident" id="5693576">Write</span><span class="op" id="5693581">(</span><span class="ident" id="5693582">p</span>&nbsp;<span class="op" id="5693584">[</span><span class="op" id="5693585">]</span><span class="builtintype" id="5693586">byte</span><span class="op" id="5693590">)</span>&nbsp;<span class="op" id="5693592">(</span><span class="ident" id="5693593">n</span>&nbsp;<span class="builtintype" id="5693595">int</span><span class="op" id="5693598">,</span>&nbsp;<span class="ident" id="5693600">err</span>&nbsp;<span class="builtintype" id="5693604">error</span><span class="op" id="5693609">)</span>&nbsp;<span class="op" id="5693611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5693614">n</span><span class="op" id="5693615">,</span>&nbsp;<span class="ident" id="5693617">err</span>&nbsp;<span class="op" id="5693621">=</span>&nbsp;<span class="ident" id="5693623">l</span><span class="op" id="5693624">.</span><span class="ident" id="5693625">w</span><span class="op" id="5693626">.</span><span class="ident" id="5693627">Write</span><span class="op" id="5693632">(</span><span class="ident" id="5693633">p</span><span class="op" id="5693634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5693637">if</span>&nbsp;<span class="ident" id="5693640">err</span>&nbsp;<span class="op" id="5693644">!=</span>&nbsp;<span class="builtintype" id="5693647">nil</span>&nbsp;<span class="op" id="5693651">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5693655">log</span><span class="op" id="5693658">.</span><span class="ident" id="5693659">Printf</span><span class="op" id="5693665">(</span><span class="string" id="5693666">&#34;%s&nbsp;%x:&nbsp;%v&#34;</span><span class="op" id="5693677">,</span>&nbsp;<span class="ident" id="5693679">l</span><span class="op" id="5693680">.</span><span class="ident" id="5693681">prefix</span><span class="op" id="5693687">,</span>&nbsp;<span class="ident" id="5693689">p</span><span class="op" id="5693690">[</span><span class="num" id="5693691">0</span><span class="op" id="5693692">:</span><span class="ident" id="5693693">n</span><span class="op" id="5693694">]</span><span class="op" id="5693695">,</span>&nbsp;<span class="ident" id="5693697">err</span><span class="op" id="5693700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5693703">}</span>&nbsp;<span class="keyword" id="5693705">else</span>&nbsp;<span class="op" id="5693710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5693714">log</span><span class="op" id="5693717">.</span><span class="ident" id="5693718">Printf</span><span class="op" id="5693724">(</span><span class="string" id="5693725">&#34;%s&nbsp;%x&#34;</span><span class="op" id="5693732">,</span>&nbsp;<span class="ident" id="5693734">l</span><span class="op" id="5693735">.</span><span class="ident" id="5693736">prefix</span><span class="op" id="5693742">,</span>&nbsp;<span class="ident" id="5693744">p</span><span class="op" id="5693745">[</span><span class="num" id="5693746">0</span><span class="op" id="5693747">:</span><span class="ident" id="5693748">n</span><span class="op" id="5693749">]</span><span class="op" id="5693750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5693753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5693756">return</span><br>
<span class="lineno">25</span><span class="op" id="5693763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5693766">//&nbsp;NewWriteLogger&nbsp;returns&nbsp;a&nbsp;writer&nbsp;that&nbsp;behaves&nbsp;like&nbsp;w&nbsp;except</span><br>
<span class="lineno"></span><span class="comment" id="5693828">//&nbsp;that&nbsp;it&nbsp;logs&nbsp;(using&nbsp;log.Printf)&nbsp;each&nbsp;write&nbsp;to&nbsp;standard&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="5693893">//&nbsp;printing&nbsp;the&nbsp;prefix&nbsp;and&nbsp;the&nbsp;hexadecimal&nbsp;data&nbsp;written.</span><br>
<span class="lineno">30</span><span class="keyword" id="5693950">func</span>&nbsp;<span class="ident" id="5693955">NewWriteLogger</span><span class="op" id="5693969">(</span><span class="ident" id="5693970">prefix</span>&nbsp;<span class="builtintype" id="5693977">string</span><span class="op" id="5693983">,</span>&nbsp;<span class="ident" id="5693985">w</span>&nbsp;<span class="ident" id="5693987">io</span><span class="op" id="5693989">.</span><span class="ident" id="5693990">Writer</span><span class="op" id="5693996">)</span>&nbsp;<span class="ident" id="5693998">io</span><span class="op" id="5694000">.</span><span class="ident" id="5694001">Writer</span>&nbsp;<span class="op" id="5694008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5694011">return</span>&nbsp;<span class="op" id="5694018">&amp;</span><span class="ident" id="5694019">writeLogger</span><span class="op" id="5694030">{</span><span class="ident" id="5694031">prefix</span><span class="op" id="5694037">,</span>&nbsp;<span class="ident" id="5694039">w</span><span class="op" id="5694040">}</span><br>
<span class="lineno"></span><span class="op" id="5694042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5694045">type</span>&nbsp;<span class="ident" id="5694050">readLogger</span>&nbsp;<span class="keyword" id="5694061">struct</span>&nbsp;<span class="op" id="5694068">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694071">prefix</span>&nbsp;<span class="builtintype" id="5694078">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694086">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694093">io</span><span class="op" id="5694095">.</span><span class="ident" id="5694096">Reader</span><br>
<span class="lineno"></span><span class="op" id="5694103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5694106">func</span>&nbsp;<span class="op" id="5694111">(</span><span class="ident" id="5694112">l</span>&nbsp;<span class="op" id="5694114">*</span><span class="ident" id="5694115">readLogger</span><span class="op" id="5694125">)</span>&nbsp;<span class="ident" id="5694127">Read</span><span class="op" id="5694131">(</span><span class="ident" id="5694132">p</span>&nbsp;<span class="op" id="5694134">[</span><span class="op" id="5694135">]</span><span class="builtintype" id="5694136">byte</span><span class="op" id="5694140">)</span>&nbsp;<span class="op" id="5694142">(</span><span class="ident" id="5694143">n</span>&nbsp;<span class="builtintype" id="5694145">int</span><span class="op" id="5694148">,</span>&nbsp;<span class="ident" id="5694150">err</span>&nbsp;<span class="builtintype" id="5694154">error</span><span class="op" id="5694159">)</span>&nbsp;<span class="op" id="5694161">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694164">n</span><span class="op" id="5694165">,</span>&nbsp;<span class="ident" id="5694167">err</span>&nbsp;<span class="op" id="5694171">=</span>&nbsp;<span class="ident" id="5694173">l</span><span class="op" id="5694174">.</span><span class="ident" id="5694175">r</span><span class="op" id="5694176">.</span><span class="ident" id="5694177">Read</span><span class="op" id="5694181">(</span><span class="ident" id="5694182">p</span><span class="op" id="5694183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5694186">if</span>&nbsp;<span class="ident" id="5694189">err</span>&nbsp;<span class="op" id="5694193">!=</span>&nbsp;<span class="builtintype" id="5694196">nil</span>&nbsp;<span class="op" id="5694200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694204">log</span><span class="op" id="5694207">.</span><span class="ident" id="5694208">Printf</span><span class="op" id="5694214">(</span><span class="string" id="5694215">&#34;%s&nbsp;%x:&nbsp;%v&#34;</span><span class="op" id="5694226">,</span>&nbsp;<span class="ident" id="5694228">l</span><span class="op" id="5694229">.</span><span class="ident" id="5694230">prefix</span><span class="op" id="5694236">,</span>&nbsp;<span class="ident" id="5694238">p</span><span class="op" id="5694239">[</span><span class="num" id="5694240">0</span><span class="op" id="5694241">:</span><span class="ident" id="5694242">n</span><span class="op" id="5694243">]</span><span class="op" id="5694244">,</span>&nbsp;<span class="ident" id="5694246">err</span><span class="op" id="5694249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5694252">}</span>&nbsp;<span class="keyword" id="5694254">else</span>&nbsp;<span class="op" id="5694259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694263">log</span><span class="op" id="5694266">.</span><span class="ident" id="5694267">Printf</span><span class="op" id="5694273">(</span><span class="string" id="5694274">&#34;%s&nbsp;%x&#34;</span><span class="op" id="5694281">,</span>&nbsp;<span class="ident" id="5694283">l</span><span class="op" id="5694284">.</span><span class="ident" id="5694285">prefix</span><span class="op" id="5694291">,</span>&nbsp;<span class="ident" id="5694293">p</span><span class="op" id="5694294">[</span><span class="num" id="5694295">0</span><span class="op" id="5694296">:</span><span class="ident" id="5694297">n</span><span class="op" id="5694298">]</span><span class="op" id="5694299">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5694302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5694305">return</span><br>
<span class="lineno"></span><span class="op" id="5694312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5694315">//&nbsp;NewReadLogger&nbsp;returns&nbsp;a&nbsp;reader&nbsp;that&nbsp;behaves&nbsp;like&nbsp;r&nbsp;except</span><br>
<span class="lineno">50</span><span class="comment" id="5694376">//&nbsp;that&nbsp;it&nbsp;logs&nbsp;(using&nbsp;log.Print)&nbsp;each&nbsp;read&nbsp;to&nbsp;standard&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="5694439">//&nbsp;printing&nbsp;the&nbsp;prefix&nbsp;and&nbsp;the&nbsp;hexadecimal&nbsp;data&nbsp;written.</span><br>
<span class="lineno"></span><span class="keyword" id="5694496">func</span>&nbsp;<span class="ident" id="5694501">NewReadLogger</span><span class="op" id="5694514">(</span><span class="ident" id="5694515">prefix</span>&nbsp;<span class="builtintype" id="5694522">string</span><span class="op" id="5694528">,</span>&nbsp;<span class="ident" id="5694530">r</span>&nbsp;<span class="ident" id="5694532">io</span><span class="op" id="5694534">.</span><span class="ident" id="5694535">Reader</span><span class="op" id="5694541">)</span>&nbsp;<span class="ident" id="5694543">io</span><span class="op" id="5694545">.</span><span class="ident" id="5694546">Reader</span>&nbsp;<span class="op" id="5694553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5694556">return</span>&nbsp;<span class="op" id="5694563">&amp;</span><span class="ident" id="5694564">readLogger</span><span class="op" id="5694574">{</span><span class="ident" id="5694575">prefix</span><span class="op" id="5694581">,</span>&nbsp;<span class="ident" id="5694583">r</span><span class="op" id="5694584">}</span><br>
<span class="lineno"></span><span class="op" id="5694586">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
