<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/json</h2>
<ul>
<li><a href="/gostd/encoding/json/bench_test.go.html">bench_test.go</a></li>
<li><a href="/gostd/encoding/json/decode.go.html">decode.go</a></li>
<li><a href="/gostd/encoding/json/decode_test.go.html">decode_test.go</a></li>
<li><a href="/gostd/encoding/json/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/json/encode_test.go.html">encode_test.go</a></li>
<li><a href="/gostd/encoding/json/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/json/fold.go.html">fold.go</a></li>
<li><a href="/gostd/encoding/json/fold_test.go.html">fold_test.go</a></li>
<li><a href="/gostd/encoding/json/indent.go.html">indent.go</a></li>
<li><a href="/gostd/encoding/json/scanner.go.html" class="current">scanner.go</a></li>
<li><a href="/gostd/encoding/json/scanner_test.go.html">scanner_test.go</a></li>
<li><a href="/gostd/encoding/json/stream.go.html">stream.go</a></li>
<li><a href="/gostd/encoding/json/stream_test.go.html">stream_test.go</a></li>
<li><a href="/gostd/encoding/json/tagkey_test.go.html">tagkey_test.go</a></li>
<li><a href="/gostd/encoding/json/tags.go.html">tags.go</a></li>
<li><a href="/gostd/encoding/json/tags_test.go.html">tags_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4814760">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4814816">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4814870">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4814921">package</span>&nbsp;<span class="ident" id="4814929">json</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4814935">//&nbsp;JSON&nbsp;value&nbsp;parser&nbsp;state&nbsp;machine.</span><br>
<span class="lineno"></span><span class="comment" id="4814971">//&nbsp;Just&nbsp;about&nbsp;at&nbsp;the&nbsp;limit&nbsp;of&nbsp;what&nbsp;is&nbsp;reasonable&nbsp;to&nbsp;write&nbsp;by&nbsp;hand.</span><br>
<span class="lineno"></span><span class="comment" id="4815038">//&nbsp;Some&nbsp;parts&nbsp;are&nbsp;a&nbsp;bit&nbsp;tedious,&nbsp;but&nbsp;overall&nbsp;it&nbsp;nicely&nbsp;factors&nbsp;out&nbsp;the</span><br>
<span class="lineno">10</span><span class="comment" id="4815109">//&nbsp;otherwise&nbsp;common&nbsp;code&nbsp;from&nbsp;the&nbsp;multiple&nbsp;scanning&nbsp;functions</span><br>
<span class="lineno"></span><span class="comment" id="4815171">//&nbsp;in&nbsp;this&nbsp;package&nbsp;(Compact,&nbsp;Indent,&nbsp;checkValid,&nbsp;nextValue,&nbsp;etc).</span><br>
<span class="lineno"></span><span class="comment" id="4815237">//</span><br>
<span class="lineno"></span><span class="comment" id="4815240">//&nbsp;This&nbsp;file&nbsp;starts&nbsp;with&nbsp;two&nbsp;simple&nbsp;examples&nbsp;using&nbsp;the&nbsp;scanner</span><br>
<span class="lineno"></span><span class="comment" id="4815303">//&nbsp;before&nbsp;diving&nbsp;into&nbsp;the&nbsp;scanner&nbsp;itself.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4815346">import</span>&nbsp;<span class="string" id="4815353">&#34;strconv&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4815364">//&nbsp;checkValid&nbsp;verifies&nbsp;that&nbsp;data&nbsp;is&nbsp;valid&nbsp;JSON-encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="4815425">//&nbsp;scan&nbsp;is&nbsp;passed&nbsp;in&nbsp;for&nbsp;use&nbsp;by&nbsp;checkValid&nbsp;to&nbsp;avoid&nbsp;an&nbsp;allocation.</span><br>
<span class="lineno">20</span><span class="keyword" id="4815492">func</span>&nbsp;<span class="ident" id="4815497">checkValid</span><span class="op" id="4815507">(</span><span class="ident" id="4815508">data</span>&nbsp;<span class="op" id="4815513">[</span><span class="op" id="4815514">]</span><span class="builtintype" id="4815515">byte</span><span class="op" id="4815519">,</span>&nbsp;<span class="ident" id="4815521">scan</span>&nbsp;<span class="op" id="4815526">*</span><span class="ident" id="4815527">scanner</span><span class="op" id="4815534">)</span>&nbsp;<span class="builtintype" id="4815536">error</span>&nbsp;<span class="op" id="4815542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4815545">scan</span><span class="op" id="4815549">.</span><span class="ident" id="4815550">reset</span><span class="op" id="4815555">(</span><span class="op" id="4815556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4815559">for</span>&nbsp;<span class="ident" id="4815563">_</span><span class="op" id="4815564">,</span>&nbsp;<span class="ident" id="4815566">c</span>&nbsp;<span class="op" id="4815568">:=</span>&nbsp;<span class="keyword" id="4815571">range</span>&nbsp;<span class="ident" id="4815577">data</span>&nbsp;<span class="op" id="4815582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4815586">scan</span><span class="op" id="4815590">.</span><span class="ident" id="4815591">bytes</span><span class="op" id="4815596">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4815601">if</span>&nbsp;<span class="ident" id="4815604">scan</span><span class="op" id="4815608">.</span><span class="ident" id="4815609">step</span><span class="op" id="4815613">(</span><span class="ident" id="4815614">scan</span><span class="op" id="4815618">,</span>&nbsp;<span class="builtintype" id="4815620">int</span><span class="op" id="4815623">(</span><span class="ident" id="4815624">c</span><span class="op" id="4815625">)</span><span class="op" id="4815626">)</span>&nbsp;<span class="op" id="4815628">==</span>&nbsp;<span class="ident" id="4815631">scanError</span>&nbsp;<span class="op" id="4815641">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4815646">return</span>&nbsp;<span class="ident" id="4815653">scan</span><span class="op" id="4815657">.</span><span class="ident" id="4815658">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4815664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4815667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4815670">if</span>&nbsp;<span class="ident" id="4815673">scan</span><span class="op" id="4815677">.</span><span class="ident" id="4815678">eof</span><span class="op" id="4815681">(</span><span class="op" id="4815682">)</span>&nbsp;<span class="op" id="4815684">==</span>&nbsp;<span class="ident" id="4815687">scanError</span>&nbsp;<span class="op" id="4815697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4815701">return</span>&nbsp;<span class="ident" id="4815708">scan</span><span class="op" id="4815712">.</span><span class="ident" id="4815713">err</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4815718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4815721">return</span>&nbsp;<span class="ident" id="4815728">nil</span><br>
<span class="lineno"></span><span class="op" id="4815732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4815735">//&nbsp;nextValue&nbsp;splits&nbsp;data&nbsp;after&nbsp;the&nbsp;next&nbsp;whole&nbsp;JSON&nbsp;value,</span><br>
<span class="lineno">35</span><span class="comment" id="4815793">//&nbsp;returning&nbsp;that&nbsp;value&nbsp;and&nbsp;the&nbsp;bytes&nbsp;that&nbsp;follow&nbsp;it&nbsp;as&nbsp;separate&nbsp;slices.</span><br>
<span class="lineno"></span><span class="comment" id="4815866">//&nbsp;scan&nbsp;is&nbsp;passed&nbsp;in&nbsp;for&nbsp;use&nbsp;by&nbsp;nextValue&nbsp;to&nbsp;avoid&nbsp;an&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="4815932">func</span>&nbsp;<span class="ident" id="4815937">nextValue</span><span class="op" id="4815946">(</span><span class="ident" id="4815947">data</span>&nbsp;<span class="op" id="4815952">[</span><span class="op" id="4815953">]</span><span class="builtintype" id="4815954">byte</span><span class="op" id="4815958">,</span>&nbsp;<span class="ident" id="4815960">scan</span>&nbsp;<span class="op" id="4815965">*</span><span class="ident" id="4815966">scanner</span><span class="op" id="4815973">)</span>&nbsp;<span class="op" id="4815975">(</span><span class="ident" id="4815976">value</span><span class="op" id="4815981">,</span>&nbsp;<span class="ident" id="4815983">rest</span>&nbsp;<span class="op" id="4815988">[</span><span class="op" id="4815989">]</span><span class="builtintype" id="4815990">byte</span><span class="op" id="4815994">,</span>&nbsp;<span class="ident" id="4815996">err</span>&nbsp;<span class="builtintype" id="4816000">error</span><span class="op" id="4816005">)</span>&nbsp;<span class="op" id="4816007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4816010">scan</span><span class="op" id="4816014">.</span><span class="ident" id="4816015">reset</span><span class="op" id="4816020">(</span><span class="op" id="4816021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4816024">for</span>&nbsp;<span class="ident" id="4816028">i</span><span class="op" id="4816029">,</span>&nbsp;<span class="ident" id="4816031">c</span>&nbsp;<span class="op" id="4816033">:=</span>&nbsp;<span class="keyword" id="4816036">range</span>&nbsp;<span class="ident" id="4816042">data</span>&nbsp;<span class="op" id="4816047">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4816051">v</span>&nbsp;<span class="op" id="4816053">:=</span>&nbsp;<span class="ident" id="4816056">scan</span><span class="op" id="4816060">.</span><span class="ident" id="4816061">step</span><span class="op" id="4816065">(</span><span class="ident" id="4816066">scan</span><span class="op" id="4816070">,</span>&nbsp;<span class="builtintype" id="4816072">int</span><span class="op" id="4816075">(</span><span class="ident" id="4816076">c</span><span class="op" id="4816077">)</span><span class="op" id="4816078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4816082">if</span>&nbsp;<span class="ident" id="4816085">v</span>&nbsp;<span class="op" id="4816087">&gt;=</span>&nbsp;<span class="ident" id="4816090">scanEnd</span>&nbsp;<span class="op" id="4816098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4816103">switch</span>&nbsp;<span class="ident" id="4816110">v</span>&nbsp;<span class="op" id="4816112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4816117">case</span>&nbsp;<span class="ident" id="4816122">scanError</span><span class="op" id="4816131">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4816137">return</span>&nbsp;<span class="ident" id="4816144">nil</span><span class="op" id="4816147">,</span>&nbsp;<span class="ident" id="4816149">nil</span><span class="op" id="4816152">,</span>&nbsp;<span class="ident" id="4816154">scan</span><span class="op" id="4816158">.</span><span class="ident" id="4816159">err</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4816166">case</span>&nbsp;<span class="ident" id="4816171">scanEnd</span><span class="op" id="4816178">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4816184">return</span>&nbsp;<span class="ident" id="4816191">data</span><span class="op" id="4816195">[</span><span class="num" id="4816196">0</span><span class="op" id="4816197">:</span><span class="ident" id="4816198">i</span><span class="op" id="4816199">]</span><span class="op" id="4816200">,</span>&nbsp;<span class="ident" id="4816202">data</span><span class="op" id="4816206">[</span><span class="ident" id="4816207">i</span><span class="op" id="4816208">:</span><span class="op" id="4816209">]</span><span class="op" id="4816210">,</span>&nbsp;<span class="ident" id="4816212">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4816219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4816223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4816226">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4816229">if</span>&nbsp;<span class="ident" id="4816232">scan</span><span class="op" id="4816236">.</span><span class="ident" id="4816237">eof</span><span class="op" id="4816240">(</span><span class="op" id="4816241">)</span>&nbsp;<span class="op" id="4816243">==</span>&nbsp;<span class="ident" id="4816246">scanError</span>&nbsp;<span class="op" id="4816256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4816260">return</span>&nbsp;<span class="ident" id="4816267">nil</span><span class="op" id="4816270">,</span>&nbsp;<span class="ident" id="4816272">nil</span><span class="op" id="4816275">,</span>&nbsp;<span class="ident" id="4816277">scan</span><span class="op" id="4816281">.</span><span class="ident" id="4816282">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4816287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4816290">return</span>&nbsp;<span class="ident" id="4816297">data</span><span class="op" id="4816301">,</span>&nbsp;<span class="ident" id="4816303">nil</span><span class="op" id="4816306">,</span>&nbsp;<span class="ident" id="4816308">nil</span><br>
<span class="lineno"></span><span class="op" id="4816312">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="4816315">//&nbsp;A&nbsp;SyntaxError&nbsp;is&nbsp;a&nbsp;description&nbsp;of&nbsp;a&nbsp;JSON&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="4816373">type</span>&nbsp;<span class="ident" id="4816378">SyntaxError</span>&nbsp;<span class="keyword" id="4816390">struct</span>&nbsp;<span class="op" id="4816397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4816400">msg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4816407">string</span>&nbsp;<span class="comment" id="4816414">//&nbsp;description&nbsp;of&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4816439">Offset</span>&nbsp;<span class="ident" id="4816446">int64</span>&nbsp;&nbsp;<span class="comment" id="4816453">//&nbsp;error&nbsp;occurred&nbsp;after&nbsp;reading&nbsp;Offset&nbsp;bytes</span><br>
<span class="lineno">60</span><span class="op" id="4816498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4816501">func</span>&nbsp;<span class="op" id="4816506">(</span><span class="ident" id="4816507">e</span>&nbsp;<span class="op" id="4816509">*</span><span class="ident" id="4816510">SyntaxError</span><span class="op" id="4816521">)</span>&nbsp;<span class="ident" id="4816523">Error</span><span class="op" id="4816528">(</span><span class="op" id="4816529">)</span>&nbsp;<span class="builtintype" id="4816531">string</span>&nbsp;<span class="op" id="4816538">{</span>&nbsp;<span class="keyword" id="4816540">return</span>&nbsp;<span class="ident" id="4816547">e</span><span class="op" id="4816548">.</span><span class="ident" id="4816549">msg</span>&nbsp;<span class="op" id="4816553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4816556">//&nbsp;A&nbsp;scanner&nbsp;is&nbsp;a&nbsp;JSON&nbsp;scanning&nbsp;state&nbsp;machine.</span><br>
<span class="lineno">65</span><span class="comment" id="4816603">//&nbsp;Callers&nbsp;call&nbsp;scan.reset()&nbsp;and&nbsp;then&nbsp;pass&nbsp;bytes&nbsp;in&nbsp;one&nbsp;at&nbsp;a&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="4816669">//&nbsp;by&nbsp;calling&nbsp;scan.step(&amp;scan,&nbsp;c)&nbsp;for&nbsp;each&nbsp;byte.</span><br>
<span class="lineno"></span><span class="comment" id="4816718">//&nbsp;The&nbsp;return&nbsp;value,&nbsp;referred&nbsp;to&nbsp;as&nbsp;an&nbsp;opcode,&nbsp;tells&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4816775">//&nbsp;caller&nbsp;about&nbsp;significant&nbsp;parsing&nbsp;events&nbsp;like&nbsp;beginning</span><br>
<span class="lineno"></span><span class="comment" id="4816833">//&nbsp;and&nbsp;ending&nbsp;literals,&nbsp;objects,&nbsp;and&nbsp;arrays,&nbsp;so&nbsp;that&nbsp;the</span><br>
<span class="lineno">70</span><span class="comment" id="4816890">//&nbsp;caller&nbsp;can&nbsp;follow&nbsp;along&nbsp;if&nbsp;it&nbsp;wishes.</span><br>
<span class="lineno"></span><span class="comment" id="4816931">//&nbsp;The&nbsp;return&nbsp;value&nbsp;scanEnd&nbsp;indicates&nbsp;that&nbsp;a&nbsp;single&nbsp;top-level</span><br>
<span class="lineno"></span><span class="comment" id="4816993">//&nbsp;JSON&nbsp;value&nbsp;has&nbsp;been&nbsp;completed,&nbsp;*before*&nbsp;the&nbsp;byte&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4817050">//&nbsp;just&nbsp;got&nbsp;passed&nbsp;in.&nbsp;&nbsp;(The&nbsp;indication&nbsp;must&nbsp;be&nbsp;delayed&nbsp;in&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="4817115">//&nbsp;to&nbsp;recognize&nbsp;the&nbsp;end&nbsp;of&nbsp;numbers:&nbsp;is&nbsp;123&nbsp;a&nbsp;whole&nbsp;value&nbsp;or</span><br>
<span class="lineno">75</span><span class="comment" id="4817175">//&nbsp;the&nbsp;beginning&nbsp;of&nbsp;12345e+6?).</span><br>
<span class="lineno"></span><span class="keyword" id="4817207">type</span>&nbsp;<span class="ident" id="4817212">scanner</span>&nbsp;<span class="keyword" id="4817220">struct</span>&nbsp;<span class="op" id="4817227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4817230">//&nbsp;The&nbsp;step&nbsp;is&nbsp;a&nbsp;func&nbsp;to&nbsp;be&nbsp;called&nbsp;to&nbsp;execute&nbsp;the&nbsp;next&nbsp;transition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4817298">//&nbsp;Also&nbsp;tried&nbsp;using&nbsp;an&nbsp;integer&nbsp;constant&nbsp;and&nbsp;a&nbsp;single&nbsp;func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4817357">//&nbsp;with&nbsp;a&nbsp;switch,&nbsp;but&nbsp;using&nbsp;the&nbsp;func&nbsp;directly&nbsp;was&nbsp;10%&nbsp;faster</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4817419">//&nbsp;on&nbsp;a&nbsp;64-bit&nbsp;Mac&nbsp;Mini,&nbsp;and&nbsp;it&#39;s&nbsp;nicer&nbsp;to&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4817469">step</span>&nbsp;<span class="keyword" id="4817474">func</span><span class="op" id="4817478">(</span><span class="op" id="4817479">*</span><span class="ident" id="4817480">scanner</span><span class="op" id="4817487">,</span>&nbsp;<span class="builtintype" id="4817489">int</span><span class="op" id="4817492">)</span>&nbsp;<span class="builtintype" id="4817494">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4817500">//&nbsp;Reached&nbsp;end&nbsp;of&nbsp;top-level&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4817536">endTop</span>&nbsp;<span class="builtintype" id="4817543">bool</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4817550">//&nbsp;Stack&nbsp;of&nbsp;what&nbsp;we&#39;re&nbsp;in&nbsp;the&nbsp;middle&nbsp;of&nbsp;-&nbsp;array&nbsp;values,&nbsp;object&nbsp;keys,&nbsp;object&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4817635">parseState</span>&nbsp;<span class="op" id="4817646">[</span><span class="op" id="4817647">]</span><span class="builtintype" id="4817648">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4817654">//&nbsp;Error&nbsp;that&nbsp;happened,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4817687">err</span>&nbsp;<span class="builtintype" id="4817691">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4817699">//&nbsp;1-byte&nbsp;redo&nbsp;(see&nbsp;undo&nbsp;method)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4817733">redo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4817743">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4817749">redoCode</span>&nbsp;&nbsp;<span class="builtintype" id="4817759">int</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4817764">redoState</span>&nbsp;<span class="keyword" id="4817774">func</span><span class="op" id="4817778">(</span><span class="op" id="4817779">*</span><span class="ident" id="4817780">scanner</span><span class="op" id="4817787">,</span>&nbsp;<span class="builtintype" id="4817789">int</span><span class="op" id="4817792">)</span>&nbsp;<span class="builtintype" id="4817794">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4817800">//&nbsp;total&nbsp;bytes&nbsp;consumed,&nbsp;updated&nbsp;by&nbsp;decoder.Decode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4817852">bytes</span>&nbsp;<span class="ident" id="4817858">int64</span><br>
<span class="lineno"></span><span class="op" id="4817864">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="4817867">//&nbsp;These&nbsp;values&nbsp;are&nbsp;returned&nbsp;by&nbsp;the&nbsp;state&nbsp;transition&nbsp;functions</span><br>
<span class="lineno"></span><span class="comment" id="4817930">//&nbsp;assigned&nbsp;to&nbsp;scanner.state&nbsp;and&nbsp;the&nbsp;method&nbsp;scanner.eof.</span><br>
<span class="lineno"></span><span class="comment" id="4817987">//&nbsp;They&nbsp;give&nbsp;details&nbsp;about&nbsp;the&nbsp;current&nbsp;state&nbsp;of&nbsp;the&nbsp;scan&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4818049">//&nbsp;callers&nbsp;might&nbsp;be&nbsp;interested&nbsp;to&nbsp;know&nbsp;about.</span><br>
<span class="lineno">105</span><span class="comment" id="4818095">//&nbsp;It&nbsp;is&nbsp;okay&nbsp;to&nbsp;ignore&nbsp;the&nbsp;return&nbsp;value&nbsp;of&nbsp;any&nbsp;particular</span><br>
<span class="lineno"></span><span class="comment" id="4818154">//&nbsp;call&nbsp;to&nbsp;scanner.state:&nbsp;if&nbsp;one&nbsp;call&nbsp;returns&nbsp;scanError,</span><br>
<span class="lineno"></span><span class="comment" id="4818211">//&nbsp;every&nbsp;subsequent&nbsp;call&nbsp;will&nbsp;return&nbsp;scanError&nbsp;too.</span><br>
<span class="lineno"></span><span class="keyword" id="4818263">const</span>&nbsp;<span class="op" id="4818269">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4818272">//&nbsp;Continue.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4818286">scanContinue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4818303">=</span>&nbsp;<span class="ident" id="4818305">iota</span>&nbsp;<span class="comment" id="4818310">//&nbsp;uninteresting&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4818333">scanBeginLiteral</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4818357">//&nbsp;end&nbsp;implied&nbsp;by&nbsp;next&nbsp;result&nbsp;!=&nbsp;scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4818404">scanBeginObject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4818428">//&nbsp;begin&nbsp;object</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4818445">scanObjectKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4818469">//&nbsp;just&nbsp;finished&nbsp;object&nbsp;key&nbsp;(string)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4818507">scanObjectValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4818531">//&nbsp;just&nbsp;finished&nbsp;non-last&nbsp;object&nbsp;value</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4818571">scanEndObject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4818595">//&nbsp;end&nbsp;object&nbsp;(implies&nbsp;scanObjectValue&nbsp;if&nbsp;possible)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4818648">scanBeginArray</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4818672">//&nbsp;begin&nbsp;array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4818688">scanArrayValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4818712">//&nbsp;just&nbsp;finished&nbsp;array&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4818742">scanEndArray</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4818766">//&nbsp;end&nbsp;array&nbsp;(implies&nbsp;scanArrayValue&nbsp;if&nbsp;possible)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4818817">scanSkipSpace</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4818841">//&nbsp;space&nbsp;byte;&nbsp;can&nbsp;skip;&nbsp;known&nbsp;to&nbsp;be&nbsp;last&nbsp;&#34;continue&#34;&nbsp;result</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4818903">//&nbsp;Stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4818913">scanEnd</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4818923">//&nbsp;top-level&nbsp;value&nbsp;ended&nbsp;*before*&nbsp;this&nbsp;byte;&nbsp;known&nbsp;to&nbsp;be&nbsp;first&nbsp;&#34;stop&#34;&nbsp;result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4819001">scanError</span>&nbsp;<span class="comment" id="4819011">//&nbsp;hit&nbsp;an&nbsp;error,&nbsp;scanner.err.</span><br>
<span class="lineno"></span><span class="op" id="4819041">)</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4819044">//&nbsp;These&nbsp;values&nbsp;are&nbsp;stored&nbsp;in&nbsp;the&nbsp;parseState&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="4819096">//&nbsp;They&nbsp;give&nbsp;the&nbsp;current&nbsp;state&nbsp;of&nbsp;a&nbsp;composite&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="4819148">//&nbsp;being&nbsp;scanned.&nbsp;&nbsp;If&nbsp;the&nbsp;parser&nbsp;is&nbsp;inside&nbsp;a&nbsp;nested&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="4819206">//&nbsp;the&nbsp;parseState&nbsp;describes&nbsp;the&nbsp;nested&nbsp;state,&nbsp;outermost&nbsp;at&nbsp;entry&nbsp;0.</span><br>
<span class="lineno">130</span><span class="keyword" id="4819274">const</span>&nbsp;<span class="op" id="4819280">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4819283">parseObjectKey</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4819300">=</span>&nbsp;<span class="ident" id="4819302">iota</span>&nbsp;<span class="comment" id="4819307">//&nbsp;parsing&nbsp;object&nbsp;key&nbsp;(before&nbsp;colon)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4819345">parseObjectValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4819369">//&nbsp;parsing&nbsp;object&nbsp;value&nbsp;(after&nbsp;colon)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4819408">parseArrayValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4819432">//&nbsp;parsing&nbsp;array&nbsp;value</span><br>
<span class="lineno"></span><span class="op" id="4819455">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="4819458">//&nbsp;reset&nbsp;prepares&nbsp;the&nbsp;scanner&nbsp;for&nbsp;use.</span><br>
<span class="lineno"></span><span class="comment" id="4819497">//&nbsp;It&nbsp;must&nbsp;be&nbsp;called&nbsp;before&nbsp;calling&nbsp;s.step.</span><br>
<span class="lineno"></span><span class="keyword" id="4819541">func</span>&nbsp;<span class="op" id="4819546">(</span><span class="ident" id="4819547">s</span>&nbsp;<span class="op" id="4819549">*</span><span class="ident" id="4819550">scanner</span><span class="op" id="4819557">)</span>&nbsp;<span class="ident" id="4819559">reset</span><span class="op" id="4819564">(</span><span class="op" id="4819565">)</span>&nbsp;<span class="op" id="4819567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4819570">s</span><span class="op" id="4819571">.</span><span class="ident" id="4819572">step</span>&nbsp;<span class="op" id="4819577">=</span>&nbsp;<span class="ident" id="4819579">stateBeginValue</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4819596">s</span><span class="op" id="4819597">.</span><span class="ident" id="4819598">parseState</span>&nbsp;<span class="op" id="4819609">=</span>&nbsp;<span class="ident" id="4819611">s</span><span class="op" id="4819612">.</span><span class="ident" id="4819613">parseState</span><span class="op" id="4819623">[</span><span class="num" id="4819624">0</span><span class="op" id="4819625">:</span><span class="num" id="4819626">0</span><span class="op" id="4819627">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4819630">s</span><span class="op" id="4819631">.</span><span class="ident" id="4819632">err</span>&nbsp;<span class="op" id="4819636">=</span>&nbsp;<span class="ident" id="4819638">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4819643">s</span><span class="op" id="4819644">.</span><span class="ident" id="4819645">redo</span>&nbsp;<span class="op" id="4819650">=</span>&nbsp;<span class="builtintype" id="4819652">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4819659">s</span><span class="op" id="4819660">.</span><span class="ident" id="4819661">endTop</span>&nbsp;<span class="op" id="4819668">=</span>&nbsp;<span class="builtintype" id="4819670">false</span><br>
<span class="lineno"></span><span class="op" id="4819676">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="4819679">//&nbsp;eof&nbsp;tells&nbsp;the&nbsp;scanner&nbsp;that&nbsp;the&nbsp;end&nbsp;of&nbsp;input&nbsp;has&nbsp;been&nbsp;reached.</span><br>
<span class="lineno"></span><span class="comment" id="4819744">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;scan&nbsp;status&nbsp;just&nbsp;as&nbsp;s.step&nbsp;does.</span><br>
<span class="lineno"></span><span class="keyword" id="4819793">func</span>&nbsp;<span class="op" id="4819798">(</span><span class="ident" id="4819799">s</span>&nbsp;<span class="op" id="4819801">*</span><span class="ident" id="4819802">scanner</span><span class="op" id="4819809">)</span>&nbsp;<span class="ident" id="4819811">eof</span><span class="op" id="4819814">(</span><span class="op" id="4819815">)</span>&nbsp;<span class="builtintype" id="4819817">int</span>&nbsp;<span class="op" id="4819821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4819824">if</span>&nbsp;<span class="ident" id="4819827">s</span><span class="op" id="4819828">.</span><span class="ident" id="4819829">err</span>&nbsp;<span class="op" id="4819833">!=</span>&nbsp;<span class="ident" id="4819836">nil</span>&nbsp;<span class="op" id="4819840">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4819844">return</span>&nbsp;<span class="ident" id="4819851">scanError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4819862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4819865">if</span>&nbsp;<span class="ident" id="4819868">s</span><span class="op" id="4819869">.</span><span class="ident" id="4819870">endTop</span>&nbsp;<span class="op" id="4819877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4819881">return</span>&nbsp;<span class="ident" id="4819888">scanEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4819897">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4819900">s</span><span class="op" id="4819901">.</span><span class="ident" id="4819902">step</span><span class="op" id="4819906">(</span><span class="ident" id="4819907">s</span><span class="op" id="4819908">,</span>&nbsp;<span class="string" id="4819910">&#39;&nbsp;&#39;</span><span class="op" id="4819913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4819916">if</span>&nbsp;<span class="ident" id="4819919">s</span><span class="op" id="4819920">.</span><span class="ident" id="4819921">endTop</span>&nbsp;<span class="op" id="4819928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4819932">return</span>&nbsp;<span class="ident" id="4819939">scanEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4819948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4819951">if</span>&nbsp;<span class="ident" id="4819954">s</span><span class="op" id="4819955">.</span><span class="ident" id="4819956">err</span>&nbsp;<span class="op" id="4819960">==</span>&nbsp;<span class="ident" id="4819963">nil</span>&nbsp;<span class="op" id="4819967">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4819971">s</span><span class="op" id="4819972">.</span><span class="ident" id="4819973">err</span>&nbsp;<span class="op" id="4819977">=</span>&nbsp;<span class="op" id="4819979">&amp;</span><span class="ident" id="4819980">SyntaxError</span><span class="op" id="4819991">{</span><span class="string" id="4819992">&#34;unexpected&nbsp;end&nbsp;of&nbsp;JSON&nbsp;input&#34;</span><span class="op" id="4820022">,</span>&nbsp;<span class="ident" id="4820024">s</span><span class="op" id="4820025">.</span><span class="ident" id="4820026">bytes</span><span class="op" id="4820031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4820034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4820037">return</span>&nbsp;<span class="ident" id="4820044">scanError</span><br>
<span class="lineno"></span><span class="op" id="4820054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="4820057">//&nbsp;pushParseState&nbsp;pushes&nbsp;a&nbsp;new&nbsp;parse&nbsp;state&nbsp;p&nbsp;onto&nbsp;the&nbsp;parse&nbsp;stack.</span><br>
<span class="lineno"></span><span class="keyword" id="4820124">func</span>&nbsp;<span class="op" id="4820129">(</span><span class="ident" id="4820130">s</span>&nbsp;<span class="op" id="4820132">*</span><span class="ident" id="4820133">scanner</span><span class="op" id="4820140">)</span>&nbsp;<span class="ident" id="4820142">pushParseState</span><span class="op" id="4820156">(</span><span class="ident" id="4820157">p</span>&nbsp;<span class="builtintype" id="4820159">int</span><span class="op" id="4820162">)</span>&nbsp;<span class="op" id="4820164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4820167">s</span><span class="op" id="4820168">.</span><span class="ident" id="4820169">parseState</span>&nbsp;<span class="op" id="4820180">=</span>&nbsp;<span class="builtinfunc" id="4820182">append</span><span class="op" id="4820188">(</span><span class="ident" id="4820189">s</span><span class="op" id="4820190">.</span><span class="ident" id="4820191">parseState</span><span class="op" id="4820201">,</span>&nbsp;<span class="ident" id="4820203">p</span><span class="op" id="4820204">)</span><br>
<span class="lineno"></span><span class="op" id="4820206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="comment" id="4820209">//&nbsp;popParseState&nbsp;pops&nbsp;a&nbsp;parse&nbsp;state&nbsp;(already&nbsp;obtained)&nbsp;off&nbsp;the&nbsp;stack</span><br>
<span class="lineno"></span><span class="comment" id="4820278">//&nbsp;and&nbsp;updates&nbsp;s.step&nbsp;accordingly.</span><br>
<span class="lineno"></span><span class="keyword" id="4820313">func</span>&nbsp;<span class="op" id="4820318">(</span><span class="ident" id="4820319">s</span>&nbsp;<span class="op" id="4820321">*</span><span class="ident" id="4820322">scanner</span><span class="op" id="4820329">)</span>&nbsp;<span class="ident" id="4820331">popParseState</span><span class="op" id="4820344">(</span><span class="op" id="4820345">)</span>&nbsp;<span class="op" id="4820347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4820350">n</span>&nbsp;<span class="op" id="4820352">:=</span>&nbsp;<span class="builtinfunc" id="4820355">len</span><span class="op" id="4820358">(</span><span class="ident" id="4820359">s</span><span class="op" id="4820360">.</span><span class="ident" id="4820361">parseState</span><span class="op" id="4820371">)</span>&nbsp;<span class="op" id="4820373">-</span>&nbsp;<span class="num" id="4820375">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4820378">s</span><span class="op" id="4820379">.</span><span class="ident" id="4820380">parseState</span>&nbsp;<span class="op" id="4820391">=</span>&nbsp;<span class="ident" id="4820393">s</span><span class="op" id="4820394">.</span><span class="ident" id="4820395">parseState</span><span class="op" id="4820405">[</span><span class="num" id="4820406">0</span><span class="op" id="4820407">:</span><span class="ident" id="4820408">n</span><span class="op" id="4820409">]</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4820412">s</span><span class="op" id="4820413">.</span><span class="ident" id="4820414">redo</span>&nbsp;<span class="op" id="4820419">=</span>&nbsp;<span class="builtintype" id="4820421">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4820428">if</span>&nbsp;<span class="ident" id="4820431">n</span>&nbsp;<span class="op" id="4820433">==</span>&nbsp;<span class="num" id="4820436">0</span>&nbsp;<span class="op" id="4820438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4820442">s</span><span class="op" id="4820443">.</span><span class="ident" id="4820444">step</span>&nbsp;<span class="op" id="4820449">=</span>&nbsp;<span class="ident" id="4820451">stateEndTop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4820465">s</span><span class="op" id="4820466">.</span><span class="ident" id="4820467">endTop</span>&nbsp;<span class="op" id="4820474">=</span>&nbsp;<span class="builtintype" id="4820476">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4820482">}</span>&nbsp;<span class="keyword" id="4820484">else</span>&nbsp;<span class="op" id="4820489">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4820493">s</span><span class="op" id="4820494">.</span><span class="ident" id="4820495">step</span>&nbsp;<span class="op" id="4820500">=</span>&nbsp;<span class="ident" id="4820502">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4820517">}</span><br>
<span class="lineno"></span><span class="op" id="4820519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4820522">func</span>&nbsp;<span class="ident" id="4820527">isSpace</span><span class="op" id="4820534">(</span><span class="ident" id="4820535">c</span>&nbsp;<span class="builtintype" id="4820537">rune</span><span class="op" id="4820541">)</span>&nbsp;<span class="builtintype" id="4820543">bool</span>&nbsp;<span class="op" id="4820548">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4820551">return</span>&nbsp;<span class="ident" id="4820558">c</span>&nbsp;<span class="op" id="4820560">==</span>&nbsp;<span class="string" id="4820563">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4820567">||</span>&nbsp;<span class="ident" id="4820570">c</span>&nbsp;<span class="op" id="4820572">==</span>&nbsp;<span class="string" id="4820575">&#39;\t&#39;</span>&nbsp;<span class="op" id="4820580">||</span>&nbsp;<span class="ident" id="4820583">c</span>&nbsp;<span class="op" id="4820585">==</span>&nbsp;<span class="string" id="4820588">&#39;\r&#39;</span>&nbsp;<span class="op" id="4820593">||</span>&nbsp;<span class="ident" id="4820596">c</span>&nbsp;<span class="op" id="4820598">==</span>&nbsp;<span class="string" id="4820601">&#39;\n&#39;</span><br>
<span class="lineno"></span><span class="op" id="4820606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4820609">//&nbsp;stateBeginValueOrEmpty&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`[`.</span><br>
<span class="lineno"></span><span class="keyword" id="4820667">func</span>&nbsp;<span class="ident" id="4820672">stateBeginValueOrEmpty</span><span class="op" id="4820694">(</span><span class="ident" id="4820695">s</span>&nbsp;<span class="op" id="4820697">*</span><span class="ident" id="4820698">scanner</span><span class="op" id="4820705">,</span>&nbsp;<span class="ident" id="4820707">c</span>&nbsp;<span class="builtintype" id="4820709">int</span><span class="op" id="4820712">)</span>&nbsp;<span class="builtintype" id="4820714">int</span>&nbsp;<span class="op" id="4820718">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4820721">if</span>&nbsp;<span class="ident" id="4820724">c</span>&nbsp;<span class="op" id="4820726">&lt;=</span>&nbsp;<span class="string" id="4820729">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4820733">&amp;&amp;</span>&nbsp;<span class="ident" id="4820736">isSpace</span><span class="op" id="4820743">(</span><span class="builtintype" id="4820744">rune</span><span class="op" id="4820748">(</span><span class="ident" id="4820749">c</span><span class="op" id="4820750">)</span><span class="op" id="4820751">)</span>&nbsp;<span class="op" id="4820753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4820757">return</span>&nbsp;<span class="ident" id="4820764">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4820779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4820782">if</span>&nbsp;<span class="ident" id="4820785">c</span>&nbsp;<span class="op" id="4820787">==</span>&nbsp;<span class="string" id="4820790">&#39;]&#39;</span>&nbsp;<span class="op" id="4820794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4820798">return</span>&nbsp;<span class="ident" id="4820805">stateEndValue</span><span class="op" id="4820818">(</span><span class="ident" id="4820819">s</span><span class="op" id="4820820">,</span>&nbsp;<span class="ident" id="4820822">c</span><span class="op" id="4820823">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4820826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4820829">return</span>&nbsp;<span class="ident" id="4820836">stateBeginValue</span><span class="op" id="4820851">(</span><span class="ident" id="4820852">s</span><span class="op" id="4820853">,</span>&nbsp;<span class="ident" id="4820855">c</span><span class="op" id="4820856">)</span><br>
<span class="lineno"></span><span class="op" id="4820858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4820861">//&nbsp;stateBeginValue&nbsp;is&nbsp;the&nbsp;state&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;input.</span><br>
<span class="lineno">200</span><span class="keyword" id="4820924">func</span>&nbsp;<span class="ident" id="4820929">stateBeginValue</span><span class="op" id="4820944">(</span><span class="ident" id="4820945">s</span>&nbsp;<span class="op" id="4820947">*</span><span class="ident" id="4820948">scanner</span><span class="op" id="4820955">,</span>&nbsp;<span class="ident" id="4820957">c</span>&nbsp;<span class="builtintype" id="4820959">int</span><span class="op" id="4820962">)</span>&nbsp;<span class="builtintype" id="4820964">int</span>&nbsp;<span class="op" id="4820968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4820971">if</span>&nbsp;<span class="ident" id="4820974">c</span>&nbsp;<span class="op" id="4820976">&lt;=</span>&nbsp;<span class="string" id="4820979">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4820983">&amp;&amp;</span>&nbsp;<span class="ident" id="4820986">isSpace</span><span class="op" id="4820993">(</span><span class="builtintype" id="4820994">rune</span><span class="op" id="4820998">(</span><span class="ident" id="4820999">c</span><span class="op" id="4821000">)</span><span class="op" id="4821001">)</span>&nbsp;<span class="op" id="4821003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4821007">return</span>&nbsp;<span class="ident" id="4821014">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4821029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4821032">switch</span>&nbsp;<span class="ident" id="4821039">c</span>&nbsp;<span class="op" id="4821041">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4821044">case</span>&nbsp;<span class="string" id="4821049">&#39;{&#39;</span><span class="op" id="4821052">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4821056">s</span><span class="op" id="4821057">.</span><span class="ident" id="4821058">step</span>&nbsp;<span class="op" id="4821063">=</span>&nbsp;<span class="ident" id="4821065">stateBeginStringOrEmpty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4821091">s</span><span class="op" id="4821092">.</span><span class="ident" id="4821093">pushParseState</span><span class="op" id="4821107">(</span><span class="ident" id="4821108">parseObjectKey</span><span class="op" id="4821122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4821126">return</span>&nbsp;<span class="ident" id="4821133">scanBeginObject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4821150">case</span>&nbsp;<span class="string" id="4821155">&#39;[&#39;</span><span class="op" id="4821158">:</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4821162">s</span><span class="op" id="4821163">.</span><span class="ident" id="4821164">step</span>&nbsp;<span class="op" id="4821169">=</span>&nbsp;<span class="ident" id="4821171">stateBeginValueOrEmpty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4821196">s</span><span class="op" id="4821197">.</span><span class="ident" id="4821198">pushParseState</span><span class="op" id="4821212">(</span><span class="ident" id="4821213">parseArrayValue</span><span class="op" id="4821228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4821232">return</span>&nbsp;<span class="ident" id="4821239">scanBeginArray</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4821255">case</span>&nbsp;<span class="string" id="4821260">&#39;&#34;&#39;</span><span class="op" id="4821263">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4821267">s</span><span class="op" id="4821268">.</span><span class="ident" id="4821269">step</span>&nbsp;<span class="op" id="4821274">=</span>&nbsp;<span class="ident" id="4821276">stateInString</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4821292">return</span>&nbsp;<span class="ident" id="4821299">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4821317">case</span>&nbsp;<span class="string" id="4821322">&#39;-&#39;</span><span class="op" id="4821325">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4821329">s</span><span class="op" id="4821330">.</span><span class="ident" id="4821331">step</span>&nbsp;<span class="op" id="4821336">=</span>&nbsp;<span class="ident" id="4821338">stateNeg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4821349">return</span>&nbsp;<span class="ident" id="4821356">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4821374">case</span>&nbsp;<span class="string" id="4821379">&#39;0&#39;</span><span class="op" id="4821382">:</span>&nbsp;<span class="comment" id="4821384">//&nbsp;beginning&nbsp;of&nbsp;0.123</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4821408">s</span><span class="op" id="4821409">.</span><span class="ident" id="4821410">step</span>&nbsp;<span class="op" id="4821415">=</span>&nbsp;<span class="ident" id="4821417">state0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4821426">return</span>&nbsp;<span class="ident" id="4821433">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4821451">case</span>&nbsp;<span class="string" id="4821456">&#39;t&#39;</span><span class="op" id="4821459">:</span>&nbsp;<span class="comment" id="4821461">//&nbsp;beginning&nbsp;of&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4821484">s</span><span class="op" id="4821485">.</span><span class="ident" id="4821486">step</span>&nbsp;<span class="op" id="4821491">=</span>&nbsp;<span class="ident" id="4821493">stateT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4821502">return</span>&nbsp;<span class="ident" id="4821509">scanBeginLiteral</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4821527">case</span>&nbsp;<span class="string" id="4821532">&#39;f&#39;</span><span class="op" id="4821535">:</span>&nbsp;<span class="comment" id="4821537">//&nbsp;beginning&nbsp;of&nbsp;false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4821561">s</span><span class="op" id="4821562">.</span><span class="ident" id="4821563">step</span>&nbsp;<span class="op" id="4821568">=</span>&nbsp;<span class="ident" id="4821570">stateF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4821579">return</span>&nbsp;<span class="ident" id="4821586">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4821604">case</span>&nbsp;<span class="string" id="4821609">&#39;n&#39;</span><span class="op" id="4821612">:</span>&nbsp;<span class="comment" id="4821614">//&nbsp;beginning&nbsp;of&nbsp;null</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4821637">s</span><span class="op" id="4821638">.</span><span class="ident" id="4821639">step</span>&nbsp;<span class="op" id="4821644">=</span>&nbsp;<span class="ident" id="4821646">stateN</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4821655">return</span>&nbsp;<span class="ident" id="4821662">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4821680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4821683">if</span>&nbsp;<span class="string" id="4821686">&#39;1&#39;</span>&nbsp;<span class="op" id="4821690">&lt;=</span>&nbsp;<span class="ident" id="4821693">c</span>&nbsp;<span class="op" id="4821695">&amp;&amp;</span>&nbsp;<span class="ident" id="4821698">c</span>&nbsp;<span class="op" id="4821700">&lt;=</span>&nbsp;<span class="string" id="4821703">&#39;9&#39;</span>&nbsp;<span class="op" id="4821707">{</span>&nbsp;<span class="comment" id="4821709">//&nbsp;beginning&nbsp;of&nbsp;1234.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4821734">s</span><span class="op" id="4821735">.</span><span class="ident" id="4821736">step</span>&nbsp;<span class="op" id="4821741">=</span>&nbsp;<span class="ident" id="4821743">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4821752">return</span>&nbsp;<span class="ident" id="4821759">scanBeginLiteral</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4821777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4821780">return</span>&nbsp;<span class="ident" id="4821787">s</span><span class="op" id="4821788">.</span><span class="builtintype" id="4821789">error</span><span class="op" id="4821794">(</span><span class="ident" id="4821795">c</span><span class="op" id="4821796">,</span>&nbsp;<span class="string" id="4821798">&#34;looking&nbsp;for&nbsp;beginning&nbsp;of&nbsp;value&#34;</span><span class="op" id="4821830">)</span><br>
<span class="lineno"></span><span class="op" id="4821832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4821835">//&nbsp;stateBeginStringOrEmpty&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`{`.</span><br>
<span class="lineno">240</span><span class="keyword" id="4821894">func</span>&nbsp;<span class="ident" id="4821899">stateBeginStringOrEmpty</span><span class="op" id="4821922">(</span><span class="ident" id="4821923">s</span>&nbsp;<span class="op" id="4821925">*</span><span class="ident" id="4821926">scanner</span><span class="op" id="4821933">,</span>&nbsp;<span class="ident" id="4821935">c</span>&nbsp;<span class="builtintype" id="4821937">int</span><span class="op" id="4821940">)</span>&nbsp;<span class="builtintype" id="4821942">int</span>&nbsp;<span class="op" id="4821946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4821949">if</span>&nbsp;<span class="ident" id="4821952">c</span>&nbsp;<span class="op" id="4821954">&lt;=</span>&nbsp;<span class="string" id="4821957">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4821961">&amp;&amp;</span>&nbsp;<span class="ident" id="4821964">isSpace</span><span class="op" id="4821971">(</span><span class="builtintype" id="4821972">rune</span><span class="op" id="4821976">(</span><span class="ident" id="4821977">c</span><span class="op" id="4821978">)</span><span class="op" id="4821979">)</span>&nbsp;<span class="op" id="4821981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4821985">return</span>&nbsp;<span class="ident" id="4821992">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4822007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4822010">if</span>&nbsp;<span class="ident" id="4822013">c</span>&nbsp;<span class="op" id="4822015">==</span>&nbsp;<span class="string" id="4822018">&#39;}&#39;</span>&nbsp;<span class="op" id="4822022">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4822026">n</span>&nbsp;<span class="op" id="4822028">:=</span>&nbsp;<span class="builtinfunc" id="4822031">len</span><span class="op" id="4822034">(</span><span class="ident" id="4822035">s</span><span class="op" id="4822036">.</span><span class="ident" id="4822037">parseState</span><span class="op" id="4822047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4822051">s</span><span class="op" id="4822052">.</span><span class="ident" id="4822053">parseState</span><span class="op" id="4822063">[</span><span class="ident" id="4822064">n</span><span class="op" id="4822065">-</span><span class="num" id="4822066">1</span><span class="op" id="4822067">]</span>&nbsp;<span class="op" id="4822069">=</span>&nbsp;<span class="ident" id="4822071">parseObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4822090">return</span>&nbsp;<span class="ident" id="4822097">stateEndValue</span><span class="op" id="4822110">(</span><span class="ident" id="4822111">s</span><span class="op" id="4822112">,</span>&nbsp;<span class="ident" id="4822114">c</span><span class="op" id="4822115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4822118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4822121">return</span>&nbsp;<span class="ident" id="4822128">stateBeginString</span><span class="op" id="4822144">(</span><span class="ident" id="4822145">s</span><span class="op" id="4822146">,</span>&nbsp;<span class="ident" id="4822148">c</span><span class="op" id="4822149">)</span><br>
<span class="lineno">250</span><span class="op" id="4822151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4822154">//&nbsp;stateBeginString&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`{&#34;key&#34;:&nbsp;value,`.</span><br>
<span class="lineno"></span><span class="keyword" id="4822219">func</span>&nbsp;<span class="ident" id="4822224">stateBeginString</span><span class="op" id="4822240">(</span><span class="ident" id="4822241">s</span>&nbsp;<span class="op" id="4822243">*</span><span class="ident" id="4822244">scanner</span><span class="op" id="4822251">,</span>&nbsp;<span class="ident" id="4822253">c</span>&nbsp;<span class="builtintype" id="4822255">int</span><span class="op" id="4822258">)</span>&nbsp;<span class="builtintype" id="4822260">int</span>&nbsp;<span class="op" id="4822264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4822267">if</span>&nbsp;<span class="ident" id="4822270">c</span>&nbsp;<span class="op" id="4822272">&lt;=</span>&nbsp;<span class="string" id="4822275">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4822279">&amp;&amp;</span>&nbsp;<span class="ident" id="4822282">isSpace</span><span class="op" id="4822289">(</span><span class="builtintype" id="4822290">rune</span><span class="op" id="4822294">(</span><span class="ident" id="4822295">c</span><span class="op" id="4822296">)</span><span class="op" id="4822297">)</span>&nbsp;<span class="op" id="4822299">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4822303">return</span>&nbsp;<span class="ident" id="4822310">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4822325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4822328">if</span>&nbsp;<span class="ident" id="4822331">c</span>&nbsp;<span class="op" id="4822333">==</span>&nbsp;<span class="string" id="4822336">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4822340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4822344">s</span><span class="op" id="4822345">.</span><span class="ident" id="4822346">step</span>&nbsp;<span class="op" id="4822351">=</span>&nbsp;<span class="ident" id="4822353">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4822369">return</span>&nbsp;<span class="ident" id="4822376">scanBeginLiteral</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4822394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4822397">return</span>&nbsp;<span class="ident" id="4822404">s</span><span class="op" id="4822405">.</span><span class="builtintype" id="4822406">error</span><span class="op" id="4822411">(</span><span class="ident" id="4822412">c</span><span class="op" id="4822413">,</span>&nbsp;<span class="string" id="4822415">&#34;looking&nbsp;for&nbsp;beginning&nbsp;of&nbsp;object&nbsp;key&nbsp;string&#34;</span><span class="op" id="4822459">)</span><br>
<span class="lineno"></span><span class="op" id="4822461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4822464">//&nbsp;stateEndValue&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;completing&nbsp;a&nbsp;value,</span><br>
<span class="lineno">265</span><span class="comment" id="4822520">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`{}`&nbsp;or&nbsp;`true`&nbsp;or&nbsp;`[&#34;x&#34;`.</span><br>
<span class="lineno"></span><span class="keyword" id="4822571">func</span>&nbsp;<span class="ident" id="4822576">stateEndValue</span><span class="op" id="4822589">(</span><span class="ident" id="4822590">s</span>&nbsp;<span class="op" id="4822592">*</span><span class="ident" id="4822593">scanner</span><span class="op" id="4822600">,</span>&nbsp;<span class="ident" id="4822602">c</span>&nbsp;<span class="builtintype" id="4822604">int</span><span class="op" id="4822607">)</span>&nbsp;<span class="builtintype" id="4822609">int</span>&nbsp;<span class="op" id="4822613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4822616">n</span>&nbsp;<span class="op" id="4822618">:=</span>&nbsp;<span class="builtinfunc" id="4822621">len</span><span class="op" id="4822624">(</span><span class="ident" id="4822625">s</span><span class="op" id="4822626">.</span><span class="ident" id="4822627">parseState</span><span class="op" id="4822637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4822640">if</span>&nbsp;<span class="ident" id="4822643">n</span>&nbsp;<span class="op" id="4822645">==</span>&nbsp;<span class="num" id="4822648">0</span>&nbsp;<span class="op" id="4822650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4822654">//&nbsp;Completed&nbsp;top-level&nbsp;before&nbsp;the&nbsp;current&nbsp;byte.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4822704">s</span><span class="op" id="4822705">.</span><span class="ident" id="4822706">step</span>&nbsp;<span class="op" id="4822711">=</span>&nbsp;<span class="ident" id="4822713">stateEndTop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4822727">s</span><span class="op" id="4822728">.</span><span class="ident" id="4822729">endTop</span>&nbsp;<span class="op" id="4822736">=</span>&nbsp;<span class="builtintype" id="4822738">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4822745">return</span>&nbsp;<span class="ident" id="4822752">stateEndTop</span><span class="op" id="4822763">(</span><span class="ident" id="4822764">s</span><span class="op" id="4822765">,</span>&nbsp;<span class="ident" id="4822767">c</span><span class="op" id="4822768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4822771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4822774">if</span>&nbsp;<span class="ident" id="4822777">c</span>&nbsp;<span class="op" id="4822779">&lt;=</span>&nbsp;<span class="string" id="4822782">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4822786">&amp;&amp;</span>&nbsp;<span class="ident" id="4822789">isSpace</span><span class="op" id="4822796">(</span><span class="builtintype" id="4822797">rune</span><span class="op" id="4822801">(</span><span class="ident" id="4822802">c</span><span class="op" id="4822803">)</span><span class="op" id="4822804">)</span>&nbsp;<span class="op" id="4822806">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4822810">s</span><span class="op" id="4822811">.</span><span class="ident" id="4822812">step</span>&nbsp;<span class="op" id="4822817">=</span>&nbsp;<span class="ident" id="4822819">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4822835">return</span>&nbsp;<span class="ident" id="4822842">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4822857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4822860">ps</span>&nbsp;<span class="op" id="4822863">:=</span>&nbsp;<span class="ident" id="4822866">s</span><span class="op" id="4822867">.</span><span class="ident" id="4822868">parseState</span><span class="op" id="4822878">[</span><span class="ident" id="4822879">n</span><span class="op" id="4822880">-</span><span class="num" id="4822881">1</span><span class="op" id="4822882">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4822885">switch</span>&nbsp;<span class="ident" id="4822892">ps</span>&nbsp;<span class="op" id="4822895">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4822898">case</span>&nbsp;<span class="ident" id="4822903">parseObjectKey</span><span class="op" id="4822917">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4822921">if</span>&nbsp;<span class="ident" id="4822924">c</span>&nbsp;<span class="op" id="4822926">==</span>&nbsp;<span class="string" id="4822929">&#39;:&#39;</span>&nbsp;<span class="op" id="4822933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4822938">s</span><span class="op" id="4822939">.</span><span class="ident" id="4822940">parseState</span><span class="op" id="4822950">[</span><span class="ident" id="4822951">n</span><span class="op" id="4822952">-</span><span class="num" id="4822953">1</span><span class="op" id="4822954">]</span>&nbsp;<span class="op" id="4822956">=</span>&nbsp;<span class="ident" id="4822958">parseObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4822978">s</span><span class="op" id="4822979">.</span><span class="ident" id="4822980">step</span>&nbsp;<span class="op" id="4822985">=</span>&nbsp;<span class="ident" id="4822987">stateBeginValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4823006">return</span>&nbsp;<span class="ident" id="4823013">scanObjectKey</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4823029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4823033">return</span>&nbsp;<span class="ident" id="4823040">s</span><span class="op" id="4823041">.</span><span class="builtintype" id="4823042">error</span><span class="op" id="4823047">(</span><span class="ident" id="4823048">c</span><span class="op" id="4823049">,</span>&nbsp;<span class="string" id="4823051">&#34;after&nbsp;object&nbsp;key&#34;</span><span class="op" id="4823069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4823072">case</span>&nbsp;<span class="ident" id="4823077">parseObjectValue</span><span class="op" id="4823093">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4823097">if</span>&nbsp;<span class="ident" id="4823100">c</span>&nbsp;<span class="op" id="4823102">==</span>&nbsp;<span class="string" id="4823105">&#39;,&#39;</span>&nbsp;<span class="op" id="4823109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4823114">s</span><span class="op" id="4823115">.</span><span class="ident" id="4823116">parseState</span><span class="op" id="4823126">[</span><span class="ident" id="4823127">n</span><span class="op" id="4823128">-</span><span class="num" id="4823129">1</span><span class="op" id="4823130">]</span>&nbsp;<span class="op" id="4823132">=</span>&nbsp;<span class="ident" id="4823134">parseObjectKey</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4823152">s</span><span class="op" id="4823153">.</span><span class="ident" id="4823154">step</span>&nbsp;<span class="op" id="4823159">=</span>&nbsp;<span class="ident" id="4823161">stateBeginString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4823181">return</span>&nbsp;<span class="ident" id="4823188">scanObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4823206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4823210">if</span>&nbsp;<span class="ident" id="4823213">c</span>&nbsp;<span class="op" id="4823215">==</span>&nbsp;<span class="string" id="4823218">&#39;}&#39;</span>&nbsp;<span class="op" id="4823222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4823227">s</span><span class="op" id="4823228">.</span><span class="ident" id="4823229">popParseState</span><span class="op" id="4823242">(</span><span class="op" id="4823243">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4823248">return</span>&nbsp;<span class="ident" id="4823255">scanEndObject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4823271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4823275">return</span>&nbsp;<span class="ident" id="4823282">s</span><span class="op" id="4823283">.</span><span class="builtintype" id="4823284">error</span><span class="op" id="4823289">(</span><span class="ident" id="4823290">c</span><span class="op" id="4823291">,</span>&nbsp;<span class="string" id="4823293">&#34;after&nbsp;object&nbsp;key:value&nbsp;pair&#34;</span><span class="op" id="4823322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4823325">case</span>&nbsp;<span class="ident" id="4823330">parseArrayValue</span><span class="op" id="4823345">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4823349">if</span>&nbsp;<span class="ident" id="4823352">c</span>&nbsp;<span class="op" id="4823354">==</span>&nbsp;<span class="string" id="4823357">&#39;,&#39;</span>&nbsp;<span class="op" id="4823361">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4823366">s</span><span class="op" id="4823367">.</span><span class="ident" id="4823368">step</span>&nbsp;<span class="op" id="4823373">=</span>&nbsp;<span class="ident" id="4823375">stateBeginValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4823394">return</span>&nbsp;<span class="ident" id="4823401">scanArrayValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4823418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4823422">if</span>&nbsp;<span class="ident" id="4823425">c</span>&nbsp;<span class="op" id="4823427">==</span>&nbsp;<span class="string" id="4823430">&#39;]&#39;</span>&nbsp;<span class="op" id="4823434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4823439">s</span><span class="op" id="4823440">.</span><span class="ident" id="4823441">popParseState</span><span class="op" id="4823454">(</span><span class="op" id="4823455">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4823460">return</span>&nbsp;<span class="ident" id="4823467">scanEndArray</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4823482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4823486">return</span>&nbsp;<span class="ident" id="4823493">s</span><span class="op" id="4823494">.</span><span class="builtintype" id="4823495">error</span><span class="op" id="4823500">(</span><span class="ident" id="4823501">c</span><span class="op" id="4823502">,</span>&nbsp;<span class="string" id="4823504">&#34;after&nbsp;array&nbsp;element&#34;</span><span class="op" id="4823525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4823528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4823531">return</span>&nbsp;<span class="ident" id="4823538">s</span><span class="op" id="4823539">.</span><span class="builtintype" id="4823540">error</span><span class="op" id="4823545">(</span><span class="ident" id="4823546">c</span><span class="op" id="4823547">,</span>&nbsp;<span class="string" id="4823549">&#34;&#34;</span><span class="op" id="4823551">)</span><br>
<span class="lineno">310</span><span class="op" id="4823553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4823556">//&nbsp;stateEndTop&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;finishing&nbsp;the&nbsp;top-level&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="4823621">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`{}`&nbsp;or&nbsp;`[1,2,3]`.</span><br>
<span class="lineno"></span><span class="comment" id="4823665">//&nbsp;Only&nbsp;space&nbsp;characters&nbsp;should&nbsp;be&nbsp;seen&nbsp;now.</span><br>
<span class="lineno">315</span><span class="keyword" id="4823710">func</span>&nbsp;<span class="ident" id="4823715">stateEndTop</span><span class="op" id="4823726">(</span><span class="ident" id="4823727">s</span>&nbsp;<span class="op" id="4823729">*</span><span class="ident" id="4823730">scanner</span><span class="op" id="4823737">,</span>&nbsp;<span class="ident" id="4823739">c</span>&nbsp;<span class="builtintype" id="4823741">int</span><span class="op" id="4823744">)</span>&nbsp;<span class="builtintype" id="4823746">int</span>&nbsp;<span class="op" id="4823750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4823753">if</span>&nbsp;<span class="ident" id="4823756">c</span>&nbsp;<span class="op" id="4823758">!=</span>&nbsp;<span class="string" id="4823761">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4823765">&amp;&amp;</span>&nbsp;<span class="ident" id="4823768">c</span>&nbsp;<span class="op" id="4823770">!=</span>&nbsp;<span class="string" id="4823773">&#39;\t&#39;</span>&nbsp;<span class="op" id="4823778">&amp;&amp;</span>&nbsp;<span class="ident" id="4823781">c</span>&nbsp;<span class="op" id="4823783">!=</span>&nbsp;<span class="string" id="4823786">&#39;\r&#39;</span>&nbsp;<span class="op" id="4823791">&amp;&amp;</span>&nbsp;<span class="ident" id="4823794">c</span>&nbsp;<span class="op" id="4823796">!=</span>&nbsp;<span class="string" id="4823799">&#39;\n&#39;</span>&nbsp;<span class="op" id="4823804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4823808">//&nbsp;Complain&nbsp;about&nbsp;non-space&nbsp;byte&nbsp;on&nbsp;next&nbsp;call.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4823857">s</span><span class="op" id="4823858">.</span><span class="builtintype" id="4823859">error</span><span class="op" id="4823864">(</span><span class="ident" id="4823865">c</span><span class="op" id="4823866">,</span>&nbsp;<span class="string" id="4823868">&#34;after&nbsp;top-level&nbsp;value&#34;</span><span class="op" id="4823891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4823894">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4823897">return</span>&nbsp;<span class="ident" id="4823904">scanEnd</span><br>
<span class="lineno"></span><span class="op" id="4823912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4823915">//&nbsp;stateInString&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;`.</span><br>
<span class="lineno"></span><span class="keyword" id="4823964">func</span>&nbsp;<span class="ident" id="4823969">stateInString</span><span class="op" id="4823982">(</span><span class="ident" id="4823983">s</span>&nbsp;<span class="op" id="4823985">*</span><span class="ident" id="4823986">scanner</span><span class="op" id="4823993">,</span>&nbsp;<span class="ident" id="4823995">c</span>&nbsp;<span class="builtintype" id="4823997">int</span><span class="op" id="4824000">)</span>&nbsp;<span class="builtintype" id="4824002">int</span>&nbsp;<span class="op" id="4824006">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4824009">if</span>&nbsp;<span class="ident" id="4824012">c</span>&nbsp;<span class="op" id="4824014">==</span>&nbsp;<span class="string" id="4824017">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4824021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4824025">s</span><span class="op" id="4824026">.</span><span class="ident" id="4824027">step</span>&nbsp;<span class="op" id="4824032">=</span>&nbsp;<span class="ident" id="4824034">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4824050">return</span>&nbsp;<span class="ident" id="4824057">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4824071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4824074">if</span>&nbsp;<span class="ident" id="4824077">c</span>&nbsp;<span class="op" id="4824079">==</span>&nbsp;<span class="string" id="4824082">&#39;\\&#39;</span>&nbsp;<span class="op" id="4824087">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4824091">s</span><span class="op" id="4824092">.</span><span class="ident" id="4824093">step</span>&nbsp;<span class="op" id="4824098">=</span>&nbsp;<span class="ident" id="4824100">stateInStringEsc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4824119">return</span>&nbsp;<span class="ident" id="4824126">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4824140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4824143">if</span>&nbsp;<span class="ident" id="4824146">c</span>&nbsp;<span class="op" id="4824148">&lt;</span>&nbsp;<span class="num" id="4824150">0x20</span>&nbsp;<span class="op" id="4824155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4824159">return</span>&nbsp;<span class="ident" id="4824166">s</span><span class="op" id="4824167">.</span><span class="builtintype" id="4824168">error</span><span class="op" id="4824173">(</span><span class="ident" id="4824174">c</span><span class="op" id="4824175">,</span>&nbsp;<span class="string" id="4824177">&#34;in&nbsp;string&nbsp;literal&#34;</span><span class="op" id="4824196">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4824199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4824202">return</span>&nbsp;<span class="ident" id="4824209">scanContinue</span><br>
<span class="lineno"></span><span class="op" id="4824222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4824225">//&nbsp;stateInStringEsc&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">340</span><span class="keyword" id="4824301">func</span>&nbsp;<span class="ident" id="4824306">stateInStringEsc</span><span class="op" id="4824322">(</span><span class="ident" id="4824323">s</span>&nbsp;<span class="op" id="4824325">*</span><span class="ident" id="4824326">scanner</span><span class="op" id="4824333">,</span>&nbsp;<span class="ident" id="4824335">c</span>&nbsp;<span class="builtintype" id="4824337">int</span><span class="op" id="4824340">)</span>&nbsp;<span class="builtintype" id="4824342">int</span>&nbsp;<span class="op" id="4824346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4824349">switch</span>&nbsp;<span class="ident" id="4824356">c</span>&nbsp;<span class="op" id="4824358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4824361">case</span>&nbsp;<span class="string" id="4824366">&#39;b&#39;</span><span class="op" id="4824369">,</span>&nbsp;<span class="string" id="4824371">&#39;f&#39;</span><span class="op" id="4824374">,</span>&nbsp;<span class="string" id="4824376">&#39;n&#39;</span><span class="op" id="4824379">,</span>&nbsp;<span class="string" id="4824381">&#39;r&#39;</span><span class="op" id="4824384">,</span>&nbsp;<span class="string" id="4824386">&#39;t&#39;</span><span class="op" id="4824389">,</span>&nbsp;<span class="string" id="4824391">&#39;\\&#39;</span><span class="op" id="4824395">,</span>&nbsp;<span class="string" id="4824397">&#39;/&#39;</span><span class="op" id="4824400">,</span>&nbsp;<span class="string" id="4824402">&#39;&#34;&#39;</span><span class="op" id="4824405">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4824409">s</span><span class="op" id="4824410">.</span><span class="ident" id="4824411">step</span>&nbsp;<span class="op" id="4824416">=</span>&nbsp;<span class="ident" id="4824418">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4824434">return</span>&nbsp;<span class="ident" id="4824441">scanContinue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4824455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4824458">if</span>&nbsp;<span class="ident" id="4824461">c</span>&nbsp;<span class="op" id="4824463">==</span>&nbsp;<span class="string" id="4824466">&#39;u&#39;</span>&nbsp;<span class="op" id="4824470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4824474">s</span><span class="op" id="4824475">.</span><span class="ident" id="4824476">step</span>&nbsp;<span class="op" id="4824481">=</span>&nbsp;<span class="ident" id="4824483">stateInStringEscU</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4824503">return</span>&nbsp;<span class="ident" id="4824510">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4824524">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4824527">return</span>&nbsp;<span class="ident" id="4824534">s</span><span class="op" id="4824535">.</span><span class="builtintype" id="4824536">error</span><span class="op" id="4824541">(</span><span class="ident" id="4824542">c</span><span class="op" id="4824543">,</span>&nbsp;<span class="string" id="4824545">&#34;in&nbsp;string&nbsp;escape&nbsp;code&#34;</span><span class="op" id="4824568">)</span><br>
<span class="lineno"></span><span class="op" id="4824570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4824573">//&nbsp;stateInStringEscU&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4824651">func</span>&nbsp;<span class="ident" id="4824656">stateInStringEscU</span><span class="op" id="4824673">(</span><span class="ident" id="4824674">s</span>&nbsp;<span class="op" id="4824676">*</span><span class="ident" id="4824677">scanner</span><span class="op" id="4824684">,</span>&nbsp;<span class="ident" id="4824686">c</span>&nbsp;<span class="builtintype" id="4824688">int</span><span class="op" id="4824691">)</span>&nbsp;<span class="builtintype" id="4824693">int</span>&nbsp;<span class="op" id="4824697">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4824700">if</span>&nbsp;<span class="string" id="4824703">&#39;0&#39;</span>&nbsp;<span class="op" id="4824707">&lt;=</span>&nbsp;<span class="ident" id="4824710">c</span>&nbsp;<span class="op" id="4824712">&amp;&amp;</span>&nbsp;<span class="ident" id="4824715">c</span>&nbsp;<span class="op" id="4824717">&lt;=</span>&nbsp;<span class="string" id="4824720">&#39;9&#39;</span>&nbsp;<span class="op" id="4824724">||</span>&nbsp;<span class="string" id="4824727">&#39;a&#39;</span>&nbsp;<span class="op" id="4824731">&lt;=</span>&nbsp;<span class="ident" id="4824734">c</span>&nbsp;<span class="op" id="4824736">&amp;&amp;</span>&nbsp;<span class="ident" id="4824739">c</span>&nbsp;<span class="op" id="4824741">&lt;=</span>&nbsp;<span class="string" id="4824744">&#39;f&#39;</span>&nbsp;<span class="op" id="4824748">||</span>&nbsp;<span class="string" id="4824751">&#39;A&#39;</span>&nbsp;<span class="op" id="4824755">&lt;=</span>&nbsp;<span class="ident" id="4824758">c</span>&nbsp;<span class="op" id="4824760">&amp;&amp;</span>&nbsp;<span class="ident" id="4824763">c</span>&nbsp;<span class="op" id="4824765">&lt;=</span>&nbsp;<span class="string" id="4824768">&#39;F&#39;</span>&nbsp;<span class="op" id="4824772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4824776">s</span><span class="op" id="4824777">.</span><span class="ident" id="4824778">step</span>&nbsp;<span class="op" id="4824783">=</span>&nbsp;<span class="ident" id="4824785">stateInStringEscU1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4824806">return</span>&nbsp;<span class="ident" id="4824813">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4824827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4824830">//&nbsp;numbers</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4824842">return</span>&nbsp;<span class="ident" id="4824849">s</span><span class="op" id="4824850">.</span><span class="builtintype" id="4824851">error</span><span class="op" id="4824856">(</span><span class="ident" id="4824857">c</span><span class="op" id="4824858">,</span>&nbsp;<span class="string" id="4824860">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="4824897">)</span><br>
<span class="lineno"></span><span class="op" id="4824899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4824902">//&nbsp;stateInStringEscU1&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u1`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4824982">func</span>&nbsp;<span class="ident" id="4824987">stateInStringEscU1</span><span class="op" id="4825005">(</span><span class="ident" id="4825006">s</span>&nbsp;<span class="op" id="4825008">*</span><span class="ident" id="4825009">scanner</span><span class="op" id="4825016">,</span>&nbsp;<span class="ident" id="4825018">c</span>&nbsp;<span class="builtintype" id="4825020">int</span><span class="op" id="4825023">)</span>&nbsp;<span class="builtintype" id="4825025">int</span>&nbsp;<span class="op" id="4825029">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4825032">if</span>&nbsp;<span class="string" id="4825035">&#39;0&#39;</span>&nbsp;<span class="op" id="4825039">&lt;=</span>&nbsp;<span class="ident" id="4825042">c</span>&nbsp;<span class="op" id="4825044">&amp;&amp;</span>&nbsp;<span class="ident" id="4825047">c</span>&nbsp;<span class="op" id="4825049">&lt;=</span>&nbsp;<span class="string" id="4825052">&#39;9&#39;</span>&nbsp;<span class="op" id="4825056">||</span>&nbsp;<span class="string" id="4825059">&#39;a&#39;</span>&nbsp;<span class="op" id="4825063">&lt;=</span>&nbsp;<span class="ident" id="4825066">c</span>&nbsp;<span class="op" id="4825068">&amp;&amp;</span>&nbsp;<span class="ident" id="4825071">c</span>&nbsp;<span class="op" id="4825073">&lt;=</span>&nbsp;<span class="string" id="4825076">&#39;f&#39;</span>&nbsp;<span class="op" id="4825080">||</span>&nbsp;<span class="string" id="4825083">&#39;A&#39;</span>&nbsp;<span class="op" id="4825087">&lt;=</span>&nbsp;<span class="ident" id="4825090">c</span>&nbsp;<span class="op" id="4825092">&amp;&amp;</span>&nbsp;<span class="ident" id="4825095">c</span>&nbsp;<span class="op" id="4825097">&lt;=</span>&nbsp;<span class="string" id="4825100">&#39;F&#39;</span>&nbsp;<span class="op" id="4825104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4825108">s</span><span class="op" id="4825109">.</span><span class="ident" id="4825110">step</span>&nbsp;<span class="op" id="4825115">=</span>&nbsp;<span class="ident" id="4825117">stateInStringEscU12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4825139">return</span>&nbsp;<span class="ident" id="4825146">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4825160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4825163">//&nbsp;numbers</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4825175">return</span>&nbsp;<span class="ident" id="4825182">s</span><span class="op" id="4825183">.</span><span class="builtintype" id="4825184">error</span><span class="op" id="4825189">(</span><span class="ident" id="4825190">c</span><span class="op" id="4825191">,</span>&nbsp;<span class="string" id="4825193">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="4825230">)</span><br>
<span class="lineno"></span><span class="op" id="4825232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4825235">//&nbsp;stateInStringEscU12&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u12`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4825317">func</span>&nbsp;<span class="ident" id="4825322">stateInStringEscU12</span><span class="op" id="4825341">(</span><span class="ident" id="4825342">s</span>&nbsp;<span class="op" id="4825344">*</span><span class="ident" id="4825345">scanner</span><span class="op" id="4825352">,</span>&nbsp;<span class="ident" id="4825354">c</span>&nbsp;<span class="builtintype" id="4825356">int</span><span class="op" id="4825359">)</span>&nbsp;<span class="builtintype" id="4825361">int</span>&nbsp;<span class="op" id="4825365">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4825368">if</span>&nbsp;<span class="string" id="4825371">&#39;0&#39;</span>&nbsp;<span class="op" id="4825375">&lt;=</span>&nbsp;<span class="ident" id="4825378">c</span>&nbsp;<span class="op" id="4825380">&amp;&amp;</span>&nbsp;<span class="ident" id="4825383">c</span>&nbsp;<span class="op" id="4825385">&lt;=</span>&nbsp;<span class="string" id="4825388">&#39;9&#39;</span>&nbsp;<span class="op" id="4825392">||</span>&nbsp;<span class="string" id="4825395">&#39;a&#39;</span>&nbsp;<span class="op" id="4825399">&lt;=</span>&nbsp;<span class="ident" id="4825402">c</span>&nbsp;<span class="op" id="4825404">&amp;&amp;</span>&nbsp;<span class="ident" id="4825407">c</span>&nbsp;<span class="op" id="4825409">&lt;=</span>&nbsp;<span class="string" id="4825412">&#39;f&#39;</span>&nbsp;<span class="op" id="4825416">||</span>&nbsp;<span class="string" id="4825419">&#39;A&#39;</span>&nbsp;<span class="op" id="4825423">&lt;=</span>&nbsp;<span class="ident" id="4825426">c</span>&nbsp;<span class="op" id="4825428">&amp;&amp;</span>&nbsp;<span class="ident" id="4825431">c</span>&nbsp;<span class="op" id="4825433">&lt;=</span>&nbsp;<span class="string" id="4825436">&#39;F&#39;</span>&nbsp;<span class="op" id="4825440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4825444">s</span><span class="op" id="4825445">.</span><span class="ident" id="4825446">step</span>&nbsp;<span class="op" id="4825451">=</span>&nbsp;<span class="ident" id="4825453">stateInStringEscU123</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4825476">return</span>&nbsp;<span class="ident" id="4825483">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4825497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4825500">//&nbsp;numbers</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4825512">return</span>&nbsp;<span class="ident" id="4825519">s</span><span class="op" id="4825520">.</span><span class="builtintype" id="4825521">error</span><span class="op" id="4825526">(</span><span class="ident" id="4825527">c</span><span class="op" id="4825528">,</span>&nbsp;<span class="string" id="4825530">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="4825567">)</span><br>
<span class="lineno"></span><span class="op" id="4825569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4825572">//&nbsp;stateInStringEscU123&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u123`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4825656">func</span>&nbsp;<span class="ident" id="4825661">stateInStringEscU123</span><span class="op" id="4825681">(</span><span class="ident" id="4825682">s</span>&nbsp;<span class="op" id="4825684">*</span><span class="ident" id="4825685">scanner</span><span class="op" id="4825692">,</span>&nbsp;<span class="ident" id="4825694">c</span>&nbsp;<span class="builtintype" id="4825696">int</span><span class="op" id="4825699">)</span>&nbsp;<span class="builtintype" id="4825701">int</span>&nbsp;<span class="op" id="4825705">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4825708">if</span>&nbsp;<span class="string" id="4825711">&#39;0&#39;</span>&nbsp;<span class="op" id="4825715">&lt;=</span>&nbsp;<span class="ident" id="4825718">c</span>&nbsp;<span class="op" id="4825720">&amp;&amp;</span>&nbsp;<span class="ident" id="4825723">c</span>&nbsp;<span class="op" id="4825725">&lt;=</span>&nbsp;<span class="string" id="4825728">&#39;9&#39;</span>&nbsp;<span class="op" id="4825732">||</span>&nbsp;<span class="string" id="4825735">&#39;a&#39;</span>&nbsp;<span class="op" id="4825739">&lt;=</span>&nbsp;<span class="ident" id="4825742">c</span>&nbsp;<span class="op" id="4825744">&amp;&amp;</span>&nbsp;<span class="ident" id="4825747">c</span>&nbsp;<span class="op" id="4825749">&lt;=</span>&nbsp;<span class="string" id="4825752">&#39;f&#39;</span>&nbsp;<span class="op" id="4825756">||</span>&nbsp;<span class="string" id="4825759">&#39;A&#39;</span>&nbsp;<span class="op" id="4825763">&lt;=</span>&nbsp;<span class="ident" id="4825766">c</span>&nbsp;<span class="op" id="4825768">&amp;&amp;</span>&nbsp;<span class="ident" id="4825771">c</span>&nbsp;<span class="op" id="4825773">&lt;=</span>&nbsp;<span class="string" id="4825776">&#39;F&#39;</span>&nbsp;<span class="op" id="4825780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4825784">s</span><span class="op" id="4825785">.</span><span class="ident" id="4825786">step</span>&nbsp;<span class="op" id="4825791">=</span>&nbsp;<span class="ident" id="4825793">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4825809">return</span>&nbsp;<span class="ident" id="4825816">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4825830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4825833">//&nbsp;numbers</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4825845">return</span>&nbsp;<span class="ident" id="4825852">s</span><span class="op" id="4825853">.</span><span class="builtintype" id="4825854">error</span><span class="op" id="4825859">(</span><span class="ident" id="4825860">c</span><span class="op" id="4825861">,</span>&nbsp;<span class="string" id="4825863">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="4825900">)</span><br>
<span class="lineno"></span><span class="op" id="4825902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4825905">//&nbsp;stateNeg&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`-`&nbsp;during&nbsp;a&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="4825965">func</span>&nbsp;<span class="ident" id="4825970">stateNeg</span><span class="op" id="4825978">(</span><span class="ident" id="4825979">s</span>&nbsp;<span class="op" id="4825981">*</span><span class="ident" id="4825982">scanner</span><span class="op" id="4825989">,</span>&nbsp;<span class="ident" id="4825991">c</span>&nbsp;<span class="builtintype" id="4825993">int</span><span class="op" id="4825996">)</span>&nbsp;<span class="builtintype" id="4825998">int</span>&nbsp;<span class="op" id="4826002">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4826005">if</span>&nbsp;<span class="ident" id="4826008">c</span>&nbsp;<span class="op" id="4826010">==</span>&nbsp;<span class="string" id="4826013">&#39;0&#39;</span>&nbsp;<span class="op" id="4826017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4826021">s</span><span class="op" id="4826022">.</span><span class="ident" id="4826023">step</span>&nbsp;<span class="op" id="4826028">=</span>&nbsp;<span class="ident" id="4826030">state0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4826039">return</span>&nbsp;<span class="ident" id="4826046">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4826060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4826063">if</span>&nbsp;<span class="string" id="4826066">&#39;1&#39;</span>&nbsp;<span class="op" id="4826070">&lt;=</span>&nbsp;<span class="ident" id="4826073">c</span>&nbsp;<span class="op" id="4826075">&amp;&amp;</span>&nbsp;<span class="ident" id="4826078">c</span>&nbsp;<span class="op" id="4826080">&lt;=</span>&nbsp;<span class="string" id="4826083">&#39;9&#39;</span>&nbsp;<span class="op" id="4826087">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4826091">s</span><span class="op" id="4826092">.</span><span class="ident" id="4826093">step</span>&nbsp;<span class="op" id="4826098">=</span>&nbsp;<span class="ident" id="4826100">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4826109">return</span>&nbsp;<span class="ident" id="4826116">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4826130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4826133">return</span>&nbsp;<span class="ident" id="4826140">s</span><span class="op" id="4826141">.</span><span class="builtintype" id="4826142">error</span><span class="op" id="4826147">(</span><span class="ident" id="4826148">c</span><span class="op" id="4826149">,</span>&nbsp;<span class="string" id="4826151">&#34;in&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="4826171">)</span><br>
<span class="lineno"></span><span class="op" id="4826173">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="comment" id="4826176">//&nbsp;state1&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;a&nbsp;non-zero&nbsp;integer&nbsp;during&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="4826249">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`1`&nbsp;or&nbsp;`100`&nbsp;but&nbsp;not&nbsp;`0`.</span><br>
<span class="lineno"></span><span class="keyword" id="4826300">func</span>&nbsp;<span class="ident" id="4826305">state1</span><span class="op" id="4826311">(</span><span class="ident" id="4826312">s</span>&nbsp;<span class="op" id="4826314">*</span><span class="ident" id="4826315">scanner</span><span class="op" id="4826322">,</span>&nbsp;<span class="ident" id="4826324">c</span>&nbsp;<span class="builtintype" id="4826326">int</span><span class="op" id="4826329">)</span>&nbsp;<span class="builtintype" id="4826331">int</span>&nbsp;<span class="op" id="4826335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4826338">if</span>&nbsp;<span class="string" id="4826341">&#39;0&#39;</span>&nbsp;<span class="op" id="4826345">&lt;=</span>&nbsp;<span class="ident" id="4826348">c</span>&nbsp;<span class="op" id="4826350">&amp;&amp;</span>&nbsp;<span class="ident" id="4826353">c</span>&nbsp;<span class="op" id="4826355">&lt;=</span>&nbsp;<span class="string" id="4826358">&#39;9&#39;</span>&nbsp;<span class="op" id="4826362">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4826366">s</span><span class="op" id="4826367">.</span><span class="ident" id="4826368">step</span>&nbsp;<span class="op" id="4826373">=</span>&nbsp;<span class="ident" id="4826375">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4826384">return</span>&nbsp;<span class="ident" id="4826391">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4826405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4826408">return</span>&nbsp;<span class="ident" id="4826415">state0</span><span class="op" id="4826421">(</span><span class="ident" id="4826422">s</span><span class="op" id="4826423">,</span>&nbsp;<span class="ident" id="4826425">c</span><span class="op" id="4826426">)</span><br>
<span class="lineno"></span><span class="op" id="4826428">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="comment" id="4826431">//&nbsp;state0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`0`&nbsp;during&nbsp;a&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="4826489">func</span>&nbsp;<span class="ident" id="4826494">state0</span><span class="op" id="4826500">(</span><span class="ident" id="4826501">s</span>&nbsp;<span class="op" id="4826503">*</span><span class="ident" id="4826504">scanner</span><span class="op" id="4826511">,</span>&nbsp;<span class="ident" id="4826513">c</span>&nbsp;<span class="builtintype" id="4826515">int</span><span class="op" id="4826518">)</span>&nbsp;<span class="builtintype" id="4826520">int</span>&nbsp;<span class="op" id="4826524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4826527">if</span>&nbsp;<span class="ident" id="4826530">c</span>&nbsp;<span class="op" id="4826532">==</span>&nbsp;<span class="string" id="4826535">&#39;.&#39;</span>&nbsp;<span class="op" id="4826539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4826543">s</span><span class="op" id="4826544">.</span><span class="ident" id="4826545">step</span>&nbsp;<span class="op" id="4826550">=</span>&nbsp;<span class="ident" id="4826552">stateDot</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4826563">return</span>&nbsp;<span class="ident" id="4826570">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4826584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4826587">if</span>&nbsp;<span class="ident" id="4826590">c</span>&nbsp;<span class="op" id="4826592">==</span>&nbsp;<span class="string" id="4826595">&#39;e&#39;</span>&nbsp;<span class="op" id="4826599">||</span>&nbsp;<span class="ident" id="4826602">c</span>&nbsp;<span class="op" id="4826604">==</span>&nbsp;<span class="string" id="4826607">&#39;E&#39;</span>&nbsp;<span class="op" id="4826611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4826615">s</span><span class="op" id="4826616">.</span><span class="ident" id="4826617">step</span>&nbsp;<span class="op" id="4826622">=</span>&nbsp;<span class="ident" id="4826624">stateE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4826633">return</span>&nbsp;<span class="ident" id="4826640">scanContinue</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4826654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4826657">return</span>&nbsp;<span class="ident" id="4826664">stateEndValue</span><span class="op" id="4826677">(</span><span class="ident" id="4826678">s</span><span class="op" id="4826679">,</span>&nbsp;<span class="ident" id="4826681">c</span><span class="op" id="4826682">)</span><br>
<span class="lineno"></span><span class="op" id="4826684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4826687">//&nbsp;stateDot&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;integer&nbsp;and&nbsp;decimal&nbsp;point&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno">430</span><span class="comment" id="4826769">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`1.`.</span><br>
<span class="lineno"></span><span class="keyword" id="4826800">func</span>&nbsp;<span class="ident" id="4826805">stateDot</span><span class="op" id="4826813">(</span><span class="ident" id="4826814">s</span>&nbsp;<span class="op" id="4826816">*</span><span class="ident" id="4826817">scanner</span><span class="op" id="4826824">,</span>&nbsp;<span class="ident" id="4826826">c</span>&nbsp;<span class="builtintype" id="4826828">int</span><span class="op" id="4826831">)</span>&nbsp;<span class="builtintype" id="4826833">int</span>&nbsp;<span class="op" id="4826837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4826840">if</span>&nbsp;<span class="string" id="4826843">&#39;0&#39;</span>&nbsp;<span class="op" id="4826847">&lt;=</span>&nbsp;<span class="ident" id="4826850">c</span>&nbsp;<span class="op" id="4826852">&amp;&amp;</span>&nbsp;<span class="ident" id="4826855">c</span>&nbsp;<span class="op" id="4826857">&lt;=</span>&nbsp;<span class="string" id="4826860">&#39;9&#39;</span>&nbsp;<span class="op" id="4826864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4826868">s</span><span class="op" id="4826869">.</span><span class="ident" id="4826870">step</span>&nbsp;<span class="op" id="4826875">=</span>&nbsp;<span class="ident" id="4826877">stateDot0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4826889">return</span>&nbsp;<span class="ident" id="4826896">scanContinue</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4826910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4826913">return</span>&nbsp;<span class="ident" id="4826920">s</span><span class="op" id="4826921">.</span><span class="builtintype" id="4826922">error</span><span class="op" id="4826927">(</span><span class="ident" id="4826928">c</span><span class="op" id="4826929">,</span>&nbsp;<span class="string" id="4826931">&#34;after&nbsp;decimal&nbsp;point&nbsp;in&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="4826971">)</span><br>
<span class="lineno"></span><span class="op" id="4826973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4826976">//&nbsp;stateDot0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;integer,&nbsp;decimal&nbsp;point,&nbsp;and&nbsp;subsequent</span><br>
<span class="lineno">440</span><span class="comment" id="4827059">//&nbsp;digits&nbsp;of&nbsp;a&nbsp;number,&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`3.14`.</span><br>
<span class="lineno"></span><span class="keyword" id="4827112">func</span>&nbsp;<span class="ident" id="4827117">stateDot0</span><span class="op" id="4827126">(</span><span class="ident" id="4827127">s</span>&nbsp;<span class="op" id="4827129">*</span><span class="ident" id="4827130">scanner</span><span class="op" id="4827137">,</span>&nbsp;<span class="ident" id="4827139">c</span>&nbsp;<span class="builtintype" id="4827141">int</span><span class="op" id="4827144">)</span>&nbsp;<span class="builtintype" id="4827146">int</span>&nbsp;<span class="op" id="4827150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4827153">if</span>&nbsp;<span class="string" id="4827156">&#39;0&#39;</span>&nbsp;<span class="op" id="4827160">&lt;=</span>&nbsp;<span class="ident" id="4827163">c</span>&nbsp;<span class="op" id="4827165">&amp;&amp;</span>&nbsp;<span class="ident" id="4827168">c</span>&nbsp;<span class="op" id="4827170">&lt;=</span>&nbsp;<span class="string" id="4827173">&#39;9&#39;</span>&nbsp;<span class="op" id="4827177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4827181">s</span><span class="op" id="4827182">.</span><span class="ident" id="4827183">step</span>&nbsp;<span class="op" id="4827188">=</span>&nbsp;<span class="ident" id="4827190">stateDot0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4827202">return</span>&nbsp;<span class="ident" id="4827209">scanContinue</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4827223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4827226">if</span>&nbsp;<span class="ident" id="4827229">c</span>&nbsp;<span class="op" id="4827231">==</span>&nbsp;<span class="string" id="4827234">&#39;e&#39;</span>&nbsp;<span class="op" id="4827238">||</span>&nbsp;<span class="ident" id="4827241">c</span>&nbsp;<span class="op" id="4827243">==</span>&nbsp;<span class="string" id="4827246">&#39;E&#39;</span>&nbsp;<span class="op" id="4827250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4827254">s</span><span class="op" id="4827255">.</span><span class="ident" id="4827256">step</span>&nbsp;<span class="op" id="4827261">=</span>&nbsp;<span class="ident" id="4827263">stateE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4827272">return</span>&nbsp;<span class="ident" id="4827279">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4827293">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4827296">return</span>&nbsp;<span class="ident" id="4827303">stateEndValue</span><span class="op" id="4827316">(</span><span class="ident" id="4827317">s</span><span class="op" id="4827318">,</span>&nbsp;<span class="ident" id="4827320">c</span><span class="op" id="4827321">)</span><br>
<span class="lineno"></span><span class="op" id="4827323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4827326">//&nbsp;stateE&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa&nbsp;and&nbsp;e&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="4827395">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e`&nbsp;or&nbsp;`0.314e`.</span><br>
<span class="lineno">455</span><span class="keyword" id="4827440">func</span>&nbsp;<span class="ident" id="4827445">stateE</span><span class="op" id="4827451">(</span><span class="ident" id="4827452">s</span>&nbsp;<span class="op" id="4827454">*</span><span class="ident" id="4827455">scanner</span><span class="op" id="4827462">,</span>&nbsp;<span class="ident" id="4827464">c</span>&nbsp;<span class="builtintype" id="4827466">int</span><span class="op" id="4827469">)</span>&nbsp;<span class="builtintype" id="4827471">int</span>&nbsp;<span class="op" id="4827475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4827478">if</span>&nbsp;<span class="ident" id="4827481">c</span>&nbsp;<span class="op" id="4827483">==</span>&nbsp;<span class="string" id="4827486">&#39;+&#39;</span>&nbsp;<span class="op" id="4827490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4827494">s</span><span class="op" id="4827495">.</span><span class="ident" id="4827496">step</span>&nbsp;<span class="op" id="4827501">=</span>&nbsp;<span class="ident" id="4827503">stateESign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4827516">return</span>&nbsp;<span class="ident" id="4827523">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4827537">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4827540">if</span>&nbsp;<span class="ident" id="4827543">c</span>&nbsp;<span class="op" id="4827545">==</span>&nbsp;<span class="string" id="4827548">&#39;-&#39;</span>&nbsp;<span class="op" id="4827552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4827556">s</span><span class="op" id="4827557">.</span><span class="ident" id="4827558">step</span>&nbsp;<span class="op" id="4827563">=</span>&nbsp;<span class="ident" id="4827565">stateESign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4827578">return</span>&nbsp;<span class="ident" id="4827585">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4827599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4827602">return</span>&nbsp;<span class="ident" id="4827609">stateESign</span><span class="op" id="4827619">(</span><span class="ident" id="4827620">s</span><span class="op" id="4827621">,</span>&nbsp;<span class="ident" id="4827623">c</span><span class="op" id="4827624">)</span><br>
<span class="lineno">465</span><span class="op" id="4827626">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4827629">//&nbsp;stateESign&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa,&nbsp;e,&nbsp;and&nbsp;sign&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="4827709">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e-`&nbsp;or&nbsp;`0.314e+`.</span><br>
<span class="lineno"></span><span class="keyword" id="4827756">func</span>&nbsp;<span class="ident" id="4827761">stateESign</span><span class="op" id="4827771">(</span><span class="ident" id="4827772">s</span>&nbsp;<span class="op" id="4827774">*</span><span class="ident" id="4827775">scanner</span><span class="op" id="4827782">,</span>&nbsp;<span class="ident" id="4827784">c</span>&nbsp;<span class="builtintype" id="4827786">int</span><span class="op" id="4827789">)</span>&nbsp;<span class="builtintype" id="4827791">int</span>&nbsp;<span class="op" id="4827795">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4827798">if</span>&nbsp;<span class="string" id="4827801">&#39;0&#39;</span>&nbsp;<span class="op" id="4827805">&lt;=</span>&nbsp;<span class="ident" id="4827808">c</span>&nbsp;<span class="op" id="4827810">&amp;&amp;</span>&nbsp;<span class="ident" id="4827813">c</span>&nbsp;<span class="op" id="4827815">&lt;=</span>&nbsp;<span class="string" id="4827818">&#39;9&#39;</span>&nbsp;<span class="op" id="4827822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4827826">s</span><span class="op" id="4827827">.</span><span class="ident" id="4827828">step</span>&nbsp;<span class="op" id="4827833">=</span>&nbsp;<span class="ident" id="4827835">stateE0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4827845">return</span>&nbsp;<span class="ident" id="4827852">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4827866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4827869">return</span>&nbsp;<span class="ident" id="4827876">s</span><span class="op" id="4827877">.</span><span class="builtintype" id="4827878">error</span><span class="op" id="4827883">(</span><span class="ident" id="4827884">c</span><span class="op" id="4827885">,</span>&nbsp;<span class="string" id="4827887">&#34;in&nbsp;exponent&nbsp;of&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="4827919">)</span><br>
<span class="lineno">475</span><span class="op" id="4827921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4827924">//&nbsp;stateE0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa,&nbsp;e,&nbsp;optional&nbsp;sign,</span><br>
<span class="lineno"></span><span class="comment" id="4827994">//&nbsp;and&nbsp;at&nbsp;least&nbsp;one&nbsp;digit&nbsp;of&nbsp;the&nbsp;exponent&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="4828049">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e-2`&nbsp;or&nbsp;`0.314e+1`&nbsp;or&nbsp;`3.14e0`.</span><br>
<span class="lineno">480</span><span class="keyword" id="4828110">func</span>&nbsp;<span class="ident" id="4828115">stateE0</span><span class="op" id="4828122">(</span><span class="ident" id="4828123">s</span>&nbsp;<span class="op" id="4828125">*</span><span class="ident" id="4828126">scanner</span><span class="op" id="4828133">,</span>&nbsp;<span class="ident" id="4828135">c</span>&nbsp;<span class="builtintype" id="4828137">int</span><span class="op" id="4828140">)</span>&nbsp;<span class="builtintype" id="4828142">int</span>&nbsp;<span class="op" id="4828146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4828149">if</span>&nbsp;<span class="string" id="4828152">&#39;0&#39;</span>&nbsp;<span class="op" id="4828156">&lt;=</span>&nbsp;<span class="ident" id="4828159">c</span>&nbsp;<span class="op" id="4828161">&amp;&amp;</span>&nbsp;<span class="ident" id="4828164">c</span>&nbsp;<span class="op" id="4828166">&lt;=</span>&nbsp;<span class="string" id="4828169">&#39;9&#39;</span>&nbsp;<span class="op" id="4828173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4828177">s</span><span class="op" id="4828178">.</span><span class="ident" id="4828179">step</span>&nbsp;<span class="op" id="4828184">=</span>&nbsp;<span class="ident" id="4828186">stateE0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4828196">return</span>&nbsp;<span class="ident" id="4828203">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4828217">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4828220">return</span>&nbsp;<span class="ident" id="4828227">stateEndValue</span><span class="op" id="4828240">(</span><span class="ident" id="4828241">s</span><span class="op" id="4828242">,</span>&nbsp;<span class="ident" id="4828244">c</span><span class="op" id="4828245">)</span><br>
<span class="lineno"></span><span class="op" id="4828247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4828250">//&nbsp;stateT&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`t`.</span><br>
<span class="lineno"></span><span class="keyword" id="4828292">func</span>&nbsp;<span class="ident" id="4828297">stateT</span><span class="op" id="4828303">(</span><span class="ident" id="4828304">s</span>&nbsp;<span class="op" id="4828306">*</span><span class="ident" id="4828307">scanner</span><span class="op" id="4828314">,</span>&nbsp;<span class="ident" id="4828316">c</span>&nbsp;<span class="builtintype" id="4828318">int</span><span class="op" id="4828321">)</span>&nbsp;<span class="builtintype" id="4828323">int</span>&nbsp;<span class="op" id="4828327">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4828330">if</span>&nbsp;<span class="ident" id="4828333">c</span>&nbsp;<span class="op" id="4828335">==</span>&nbsp;<span class="string" id="4828338">&#39;r&#39;</span>&nbsp;<span class="op" id="4828342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4828346">s</span><span class="op" id="4828347">.</span><span class="ident" id="4828348">step</span>&nbsp;<span class="op" id="4828353">=</span>&nbsp;<span class="ident" id="4828355">stateTr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4828365">return</span>&nbsp;<span class="ident" id="4828372">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4828386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4828389">return</span>&nbsp;<span class="ident" id="4828396">s</span><span class="op" id="4828397">.</span><span class="builtintype" id="4828398">error</span><span class="op" id="4828403">(</span><span class="ident" id="4828404">c</span><span class="op" id="4828405">,</span>&nbsp;<span class="string" id="4828407">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;r&#39;)&#34;</span><span class="op" id="4828440">)</span><br>
<span class="lineno">495</span><span class="op" id="4828442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4828445">//&nbsp;stateTr&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`tr`.</span><br>
<span class="lineno"></span><span class="keyword" id="4828489">func</span>&nbsp;<span class="ident" id="4828494">stateTr</span><span class="op" id="4828501">(</span><span class="ident" id="4828502">s</span>&nbsp;<span class="op" id="4828504">*</span><span class="ident" id="4828505">scanner</span><span class="op" id="4828512">,</span>&nbsp;<span class="ident" id="4828514">c</span>&nbsp;<span class="builtintype" id="4828516">int</span><span class="op" id="4828519">)</span>&nbsp;<span class="builtintype" id="4828521">int</span>&nbsp;<span class="op" id="4828525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4828528">if</span>&nbsp;<span class="ident" id="4828531">c</span>&nbsp;<span class="op" id="4828533">==</span>&nbsp;<span class="string" id="4828536">&#39;u&#39;</span>&nbsp;<span class="op" id="4828540">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4828544">s</span><span class="op" id="4828545">.</span><span class="ident" id="4828546">step</span>&nbsp;<span class="op" id="4828551">=</span>&nbsp;<span class="ident" id="4828553">stateTru</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4828564">return</span>&nbsp;<span class="ident" id="4828571">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4828585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4828588">return</span>&nbsp;<span class="ident" id="4828595">s</span><span class="op" id="4828596">.</span><span class="builtintype" id="4828597">error</span><span class="op" id="4828602">(</span><span class="ident" id="4828603">c</span><span class="op" id="4828604">,</span>&nbsp;<span class="string" id="4828606">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;u&#39;)&#34;</span><span class="op" id="4828639">)</span><br>
<span class="lineno"></span><span class="op" id="4828641">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="4828644">//&nbsp;stateTru&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`tru`.</span><br>
<span class="lineno"></span><span class="keyword" id="4828690">func</span>&nbsp;<span class="ident" id="4828695">stateTru</span><span class="op" id="4828703">(</span><span class="ident" id="4828704">s</span>&nbsp;<span class="op" id="4828706">*</span><span class="ident" id="4828707">scanner</span><span class="op" id="4828714">,</span>&nbsp;<span class="ident" id="4828716">c</span>&nbsp;<span class="builtintype" id="4828718">int</span><span class="op" id="4828721">)</span>&nbsp;<span class="builtintype" id="4828723">int</span>&nbsp;<span class="op" id="4828727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4828730">if</span>&nbsp;<span class="ident" id="4828733">c</span>&nbsp;<span class="op" id="4828735">==</span>&nbsp;<span class="string" id="4828738">&#39;e&#39;</span>&nbsp;<span class="op" id="4828742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4828746">s</span><span class="op" id="4828747">.</span><span class="ident" id="4828748">step</span>&nbsp;<span class="op" id="4828753">=</span>&nbsp;<span class="ident" id="4828755">stateEndValue</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4828771">return</span>&nbsp;<span class="ident" id="4828778">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4828792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4828795">return</span>&nbsp;<span class="ident" id="4828802">s</span><span class="op" id="4828803">.</span><span class="builtintype" id="4828804">error</span><span class="op" id="4828809">(</span><span class="ident" id="4828810">c</span><span class="op" id="4828811">,</span>&nbsp;<span class="string" id="4828813">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;e&#39;)&#34;</span><span class="op" id="4828846">)</span><br>
<span class="lineno"></span><span class="op" id="4828848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="comment" id="4828851">//&nbsp;stateF&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`f`.</span><br>
<span class="lineno"></span><span class="keyword" id="4828893">func</span>&nbsp;<span class="ident" id="4828898">stateF</span><span class="op" id="4828904">(</span><span class="ident" id="4828905">s</span>&nbsp;<span class="op" id="4828907">*</span><span class="ident" id="4828908">scanner</span><span class="op" id="4828915">,</span>&nbsp;<span class="ident" id="4828917">c</span>&nbsp;<span class="builtintype" id="4828919">int</span><span class="op" id="4828922">)</span>&nbsp;<span class="builtintype" id="4828924">int</span>&nbsp;<span class="op" id="4828928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4828931">if</span>&nbsp;<span class="ident" id="4828934">c</span>&nbsp;<span class="op" id="4828936">==</span>&nbsp;<span class="string" id="4828939">&#39;a&#39;</span>&nbsp;<span class="op" id="4828943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4828947">s</span><span class="op" id="4828948">.</span><span class="ident" id="4828949">step</span>&nbsp;<span class="op" id="4828954">=</span>&nbsp;<span class="ident" id="4828956">stateFa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4828966">return</span>&nbsp;<span class="ident" id="4828973">scanContinue</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4828987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4828990">return</span>&nbsp;<span class="ident" id="4828997">s</span><span class="op" id="4828998">.</span><span class="builtintype" id="4828999">error</span><span class="op" id="4829004">(</span><span class="ident" id="4829005">c</span><span class="op" id="4829006">,</span>&nbsp;<span class="string" id="4829008">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;a&#39;)&#34;</span><span class="op" id="4829042">)</span><br>
<span class="lineno"></span><span class="op" id="4829044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4829047">//&nbsp;stateFa&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fa`.</span><br>
<span class="lineno">525</span><span class="keyword" id="4829091">func</span>&nbsp;<span class="ident" id="4829096">stateFa</span><span class="op" id="4829103">(</span><span class="ident" id="4829104">s</span>&nbsp;<span class="op" id="4829106">*</span><span class="ident" id="4829107">scanner</span><span class="op" id="4829114">,</span>&nbsp;<span class="ident" id="4829116">c</span>&nbsp;<span class="builtintype" id="4829118">int</span><span class="op" id="4829121">)</span>&nbsp;<span class="builtintype" id="4829123">int</span>&nbsp;<span class="op" id="4829127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4829130">if</span>&nbsp;<span class="ident" id="4829133">c</span>&nbsp;<span class="op" id="4829135">==</span>&nbsp;<span class="string" id="4829138">&#39;l&#39;</span>&nbsp;<span class="op" id="4829142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4829146">s</span><span class="op" id="4829147">.</span><span class="ident" id="4829148">step</span>&nbsp;<span class="op" id="4829153">=</span>&nbsp;<span class="ident" id="4829155">stateFal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4829166">return</span>&nbsp;<span class="ident" id="4829173">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4829187">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4829190">return</span>&nbsp;<span class="ident" id="4829197">s</span><span class="op" id="4829198">.</span><span class="builtintype" id="4829199">error</span><span class="op" id="4829204">(</span><span class="ident" id="4829205">c</span><span class="op" id="4829206">,</span>&nbsp;<span class="string" id="4829208">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="4829242">)</span><br>
<span class="lineno"></span><span class="op" id="4829244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4829247">//&nbsp;stateFal&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fal`.</span><br>
<span class="lineno"></span><span class="keyword" id="4829293">func</span>&nbsp;<span class="ident" id="4829298">stateFal</span><span class="op" id="4829306">(</span><span class="ident" id="4829307">s</span>&nbsp;<span class="op" id="4829309">*</span><span class="ident" id="4829310">scanner</span><span class="op" id="4829317">,</span>&nbsp;<span class="ident" id="4829319">c</span>&nbsp;<span class="builtintype" id="4829321">int</span><span class="op" id="4829324">)</span>&nbsp;<span class="builtintype" id="4829326">int</span>&nbsp;<span class="op" id="4829330">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4829333">if</span>&nbsp;<span class="ident" id="4829336">c</span>&nbsp;<span class="op" id="4829338">==</span>&nbsp;<span class="string" id="4829341">&#39;s&#39;</span>&nbsp;<span class="op" id="4829345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4829349">s</span><span class="op" id="4829350">.</span><span class="ident" id="4829351">step</span>&nbsp;<span class="op" id="4829356">=</span>&nbsp;<span class="ident" id="4829358">stateFals</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4829370">return</span>&nbsp;<span class="ident" id="4829377">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4829391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4829394">return</span>&nbsp;<span class="ident" id="4829401">s</span><span class="op" id="4829402">.</span><span class="builtintype" id="4829403">error</span><span class="op" id="4829408">(</span><span class="ident" id="4829409">c</span><span class="op" id="4829410">,</span>&nbsp;<span class="string" id="4829412">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;s&#39;)&#34;</span><span class="op" id="4829446">)</span><br>
<span class="lineno">540</span><span class="op" id="4829448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4829451">//&nbsp;stateFals&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fals`.</span><br>
<span class="lineno"></span><span class="keyword" id="4829499">func</span>&nbsp;<span class="ident" id="4829504">stateFals</span><span class="op" id="4829513">(</span><span class="ident" id="4829514">s</span>&nbsp;<span class="op" id="4829516">*</span><span class="ident" id="4829517">scanner</span><span class="op" id="4829524">,</span>&nbsp;<span class="ident" id="4829526">c</span>&nbsp;<span class="builtintype" id="4829528">int</span><span class="op" id="4829531">)</span>&nbsp;<span class="builtintype" id="4829533">int</span>&nbsp;<span class="op" id="4829537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4829540">if</span>&nbsp;<span class="ident" id="4829543">c</span>&nbsp;<span class="op" id="4829545">==</span>&nbsp;<span class="string" id="4829548">&#39;e&#39;</span>&nbsp;<span class="op" id="4829552">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4829556">s</span><span class="op" id="4829557">.</span><span class="ident" id="4829558">step</span>&nbsp;<span class="op" id="4829563">=</span>&nbsp;<span class="ident" id="4829565">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4829581">return</span>&nbsp;<span class="ident" id="4829588">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4829602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4829605">return</span>&nbsp;<span class="ident" id="4829612">s</span><span class="op" id="4829613">.</span><span class="builtintype" id="4829614">error</span><span class="op" id="4829619">(</span><span class="ident" id="4829620">c</span><span class="op" id="4829621">,</span>&nbsp;<span class="string" id="4829623">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;e&#39;)&#34;</span><span class="op" id="4829657">)</span><br>
<span class="lineno"></span><span class="op" id="4829659">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span><span class="comment" id="4829662">//&nbsp;stateN&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`n`.</span><br>
<span class="lineno"></span><span class="keyword" id="4829704">func</span>&nbsp;<span class="ident" id="4829709">stateN</span><span class="op" id="4829715">(</span><span class="ident" id="4829716">s</span>&nbsp;<span class="op" id="4829718">*</span><span class="ident" id="4829719">scanner</span><span class="op" id="4829726">,</span>&nbsp;<span class="ident" id="4829728">c</span>&nbsp;<span class="builtintype" id="4829730">int</span><span class="op" id="4829733">)</span>&nbsp;<span class="builtintype" id="4829735">int</span>&nbsp;<span class="op" id="4829739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4829742">if</span>&nbsp;<span class="ident" id="4829745">c</span>&nbsp;<span class="op" id="4829747">==</span>&nbsp;<span class="string" id="4829750">&#39;u&#39;</span>&nbsp;<span class="op" id="4829754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4829758">s</span><span class="op" id="4829759">.</span><span class="ident" id="4829760">step</span>&nbsp;<span class="op" id="4829765">=</span>&nbsp;<span class="ident" id="4829767">stateNu</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4829777">return</span>&nbsp;<span class="ident" id="4829784">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4829798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4829801">return</span>&nbsp;<span class="ident" id="4829808">s</span><span class="op" id="4829809">.</span><span class="builtintype" id="4829810">error</span><span class="op" id="4829815">(</span><span class="ident" id="4829816">c</span><span class="op" id="4829817">,</span>&nbsp;<span class="string" id="4829819">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;u&#39;)&#34;</span><span class="op" id="4829852">)</span><br>
<span class="lineno"></span><span class="op" id="4829854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="comment" id="4829857">//&nbsp;stateNu&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`nu`.</span><br>
<span class="lineno"></span><span class="keyword" id="4829901">func</span>&nbsp;<span class="ident" id="4829906">stateNu</span><span class="op" id="4829913">(</span><span class="ident" id="4829914">s</span>&nbsp;<span class="op" id="4829916">*</span><span class="ident" id="4829917">scanner</span><span class="op" id="4829924">,</span>&nbsp;<span class="ident" id="4829926">c</span>&nbsp;<span class="builtintype" id="4829928">int</span><span class="op" id="4829931">)</span>&nbsp;<span class="builtintype" id="4829933">int</span>&nbsp;<span class="op" id="4829937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4829940">if</span>&nbsp;<span class="ident" id="4829943">c</span>&nbsp;<span class="op" id="4829945">==</span>&nbsp;<span class="string" id="4829948">&#39;l&#39;</span>&nbsp;<span class="op" id="4829952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4829956">s</span><span class="op" id="4829957">.</span><span class="ident" id="4829958">step</span>&nbsp;<span class="op" id="4829963">=</span>&nbsp;<span class="ident" id="4829965">stateNul</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4829976">return</span>&nbsp;<span class="ident" id="4829983">scanContinue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4829997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4830000">return</span>&nbsp;<span class="ident" id="4830007">s</span><span class="op" id="4830008">.</span><span class="builtintype" id="4830009">error</span><span class="op" id="4830014">(</span><span class="ident" id="4830015">c</span><span class="op" id="4830016">,</span>&nbsp;<span class="string" id="4830018">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="4830051">)</span><br>
<span class="lineno"></span><span class="op" id="4830053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4830056">//&nbsp;stateNul&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`nul`.</span><br>
<span class="lineno">570</span><span class="keyword" id="4830102">func</span>&nbsp;<span class="ident" id="4830107">stateNul</span><span class="op" id="4830115">(</span><span class="ident" id="4830116">s</span>&nbsp;<span class="op" id="4830118">*</span><span class="ident" id="4830119">scanner</span><span class="op" id="4830126">,</span>&nbsp;<span class="ident" id="4830128">c</span>&nbsp;<span class="builtintype" id="4830130">int</span><span class="op" id="4830133">)</span>&nbsp;<span class="builtintype" id="4830135">int</span>&nbsp;<span class="op" id="4830139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4830142">if</span>&nbsp;<span class="ident" id="4830145">c</span>&nbsp;<span class="op" id="4830147">==</span>&nbsp;<span class="string" id="4830150">&#39;l&#39;</span>&nbsp;<span class="op" id="4830154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4830158">s</span><span class="op" id="4830159">.</span><span class="ident" id="4830160">step</span>&nbsp;<span class="op" id="4830165">=</span>&nbsp;<span class="ident" id="4830167">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4830183">return</span>&nbsp;<span class="ident" id="4830190">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4830204">}</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4830207">return</span>&nbsp;<span class="ident" id="4830214">s</span><span class="op" id="4830215">.</span><span class="builtintype" id="4830216">error</span><span class="op" id="4830221">(</span><span class="ident" id="4830222">c</span><span class="op" id="4830223">,</span>&nbsp;<span class="string" id="4830225">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="4830258">)</span><br>
<span class="lineno"></span><span class="op" id="4830260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4830263">//&nbsp;stateError&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reaching&nbsp;a&nbsp;syntax&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="4830321">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`[1}`&nbsp;or&nbsp;`5.1.2`.</span><br>
<span class="lineno">580</span><span class="keyword" id="4830364">func</span>&nbsp;<span class="ident" id="4830369">stateError</span><span class="op" id="4830379">(</span><span class="ident" id="4830380">s</span>&nbsp;<span class="op" id="4830382">*</span><span class="ident" id="4830383">scanner</span><span class="op" id="4830390">,</span>&nbsp;<span class="ident" id="4830392">c</span>&nbsp;<span class="builtintype" id="4830394">int</span><span class="op" id="4830397">)</span>&nbsp;<span class="builtintype" id="4830399">int</span>&nbsp;<span class="op" id="4830403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4830406">return</span>&nbsp;<span class="ident" id="4830413">scanError</span><br>
<span class="lineno"></span><span class="op" id="4830423">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4830426">//&nbsp;error&nbsp;records&nbsp;an&nbsp;error&nbsp;and&nbsp;switches&nbsp;to&nbsp;the&nbsp;error&nbsp;state.</span><br>
<span class="lineno">585</span><span class="keyword" id="4830485">func</span>&nbsp;<span class="op" id="4830490">(</span><span class="ident" id="4830491">s</span>&nbsp;<span class="op" id="4830493">*</span><span class="ident" id="4830494">scanner</span><span class="op" id="4830501">)</span>&nbsp;<span class="builtintype" id="4830503">error</span><span class="op" id="4830508">(</span><span class="ident" id="4830509">c</span>&nbsp;<span class="builtintype" id="4830511">int</span><span class="op" id="4830514">,</span>&nbsp;<span class="ident" id="4830516">context</span>&nbsp;<span class="builtintype" id="4830524">string</span><span class="op" id="4830530">)</span>&nbsp;<span class="builtintype" id="4830532">int</span>&nbsp;<span class="op" id="4830536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4830539">s</span><span class="op" id="4830540">.</span><span class="ident" id="4830541">step</span>&nbsp;<span class="op" id="4830546">=</span>&nbsp;<span class="ident" id="4830548">stateError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4830560">s</span><span class="op" id="4830561">.</span><span class="ident" id="4830562">err</span>&nbsp;<span class="op" id="4830566">=</span>&nbsp;<span class="op" id="4830568">&amp;</span><span class="ident" id="4830569">SyntaxError</span><span class="op" id="4830580">{</span><span class="string" id="4830581">&#34;invalid&nbsp;character&nbsp;&#34;</span>&nbsp;<span class="op" id="4830602">+</span>&nbsp;<span class="ident" id="4830604">quoteChar</span><span class="op" id="4830613">(</span><span class="ident" id="4830614">c</span><span class="op" id="4830615">)</span>&nbsp;<span class="op" id="4830617">+</span>&nbsp;<span class="string" id="4830619">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="4830623">+</span>&nbsp;<span class="ident" id="4830625">context</span><span class="op" id="4830632">,</span>&nbsp;<span class="ident" id="4830634">s</span><span class="op" id="4830635">.</span><span class="ident" id="4830636">bytes</span><span class="op" id="4830641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4830644">return</span>&nbsp;<span class="ident" id="4830651">scanError</span><br>
<span class="lineno"></span><span class="op" id="4830661">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="4830664">//&nbsp;quoteChar&nbsp;formats&nbsp;c&nbsp;as&nbsp;a&nbsp;quoted&nbsp;character&nbsp;literal</span><br>
<span class="lineno"></span><span class="keyword" id="4830717">func</span>&nbsp;<span class="ident" id="4830722">quoteChar</span><span class="op" id="4830731">(</span><span class="ident" id="4830732">c</span>&nbsp;<span class="builtintype" id="4830734">int</span><span class="op" id="4830737">)</span>&nbsp;<span class="builtintype" id="4830739">string</span>&nbsp;<span class="op" id="4830746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4830749">//&nbsp;special&nbsp;cases&nbsp;-&nbsp;different&nbsp;from&nbsp;quoted&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4830799">if</span>&nbsp;<span class="ident" id="4830802">c</span>&nbsp;<span class="op" id="4830804">==</span>&nbsp;<span class="string" id="4830807">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="4830812">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4830816">return</span>&nbsp;<span class="string" id="4830823">`&#39;\&#39;&#39;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4830831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4830834">if</span>&nbsp;<span class="ident" id="4830837">c</span>&nbsp;<span class="op" id="4830839">==</span>&nbsp;<span class="string" id="4830842">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4830846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4830850">return</span>&nbsp;<span class="string" id="4830857">`&#39;&#34;&#39;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4830864">}</span><br>
<span class="lineno">600</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4830868">//&nbsp;use&nbsp;quoted&nbsp;string&nbsp;with&nbsp;different&nbsp;quotation&nbsp;marks</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4830921">s</span>&nbsp;<span class="op" id="4830923">:=</span>&nbsp;<span class="ident" id="4830926">strconv</span><span class="op" id="4830933">.</span><span class="ident" id="4830934">Quote</span><span class="op" id="4830939">(</span><span class="builtintype" id="4830940">string</span><span class="op" id="4830946">(</span><span class="ident" id="4830947">c</span><span class="op" id="4830948">)</span><span class="op" id="4830949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4830952">return</span>&nbsp;<span class="string" id="4830959">&#34;&#39;&#34;</span>&nbsp;<span class="op" id="4830963">+</span>&nbsp;<span class="ident" id="4830965">s</span><span class="op" id="4830966">[</span><span class="num" id="4830967">1</span><span class="op" id="4830968">:</span><span class="builtinfunc" id="4830969">len</span><span class="op" id="4830972">(</span><span class="ident" id="4830973">s</span><span class="op" id="4830974">)</span><span class="op" id="4830975">-</span><span class="num" id="4830976">1</span><span class="op" id="4830977">]</span>&nbsp;<span class="op" id="4830979">+</span>&nbsp;<span class="string" id="4830981">&#34;&#39;&#34;</span><br>
<span class="lineno"></span><span class="op" id="4830985">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span><span class="comment" id="4830988">//&nbsp;undo&nbsp;causes&nbsp;the&nbsp;scanner&nbsp;to&nbsp;return&nbsp;scanCode&nbsp;from&nbsp;the&nbsp;next&nbsp;state&nbsp;transition.</span><br>
<span class="lineno"></span><span class="comment" id="4831066">//&nbsp;This&nbsp;gives&nbsp;callers&nbsp;a&nbsp;simple&nbsp;1-byte&nbsp;undo&nbsp;mechanism.</span><br>
<span class="lineno"></span><span class="keyword" id="4831120">func</span>&nbsp;<span class="op" id="4831125">(</span><span class="ident" id="4831126">s</span>&nbsp;<span class="op" id="4831128">*</span><span class="ident" id="4831129">scanner</span><span class="op" id="4831136">)</span>&nbsp;<span class="ident" id="4831138">undo</span><span class="op" id="4831142">(</span><span class="ident" id="4831143">scanCode</span>&nbsp;<span class="builtintype" id="4831152">int</span><span class="op" id="4831155">)</span>&nbsp;<span class="op" id="4831157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4831160">if</span>&nbsp;<span class="ident" id="4831163">s</span><span class="op" id="4831164">.</span><span class="ident" id="4831165">redo</span>&nbsp;<span class="op" id="4831170">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4831174">panic</span><span class="op" id="4831179">(</span><span class="string" id="4831180">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;scanner&#34;</span><span class="op" id="4831210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4831213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4831216">s</span><span class="op" id="4831217">.</span><span class="ident" id="4831218">redoCode</span>&nbsp;<span class="op" id="4831227">=</span>&nbsp;<span class="ident" id="4831229">scanCode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4831239">s</span><span class="op" id="4831240">.</span><span class="ident" id="4831241">redoState</span>&nbsp;<span class="op" id="4831251">=</span>&nbsp;<span class="ident" id="4831253">s</span><span class="op" id="4831254">.</span><span class="ident" id="4831255">step</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4831261">s</span><span class="op" id="4831262">.</span><span class="ident" id="4831263">step</span>&nbsp;<span class="op" id="4831268">=</span>&nbsp;<span class="ident" id="4831270">stateRedo</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4831281">s</span><span class="op" id="4831282">.</span><span class="ident" id="4831283">redo</span>&nbsp;<span class="op" id="4831288">=</span>&nbsp;<span class="builtintype" id="4831290">true</span><br>
<span class="lineno"></span><span class="op" id="4831295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4831298">//&nbsp;stateRedo&nbsp;helps&nbsp;implement&nbsp;the&nbsp;scanner&#39;s&nbsp;1-byte&nbsp;undo.</span><br>
<span class="lineno"></span><span class="keyword" id="4831354">func</span>&nbsp;<span class="ident" id="4831359">stateRedo</span><span class="op" id="4831368">(</span><span class="ident" id="4831369">s</span>&nbsp;<span class="op" id="4831371">*</span><span class="ident" id="4831372">scanner</span><span class="op" id="4831379">,</span>&nbsp;<span class="ident" id="4831381">c</span>&nbsp;<span class="builtintype" id="4831383">int</span><span class="op" id="4831386">)</span>&nbsp;<span class="builtintype" id="4831388">int</span>&nbsp;<span class="op" id="4831392">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4831395">s</span><span class="op" id="4831396">.</span><span class="ident" id="4831397">redo</span>&nbsp;<span class="op" id="4831402">=</span>&nbsp;<span class="builtintype" id="4831404">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4831411">s</span><span class="op" id="4831412">.</span><span class="ident" id="4831413">step</span>&nbsp;<span class="op" id="4831418">=</span>&nbsp;<span class="ident" id="4831420">s</span><span class="op" id="4831421">.</span><span class="ident" id="4831422">redoState</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4831433">return</span>&nbsp;<span class="ident" id="4831440">s</span><span class="op" id="4831441">.</span><span class="ident" id="4831442">redoCode</span><br>
<span class="lineno"></span><span class="op" id="4831451">}</span>
</div>
</body>
</html>
