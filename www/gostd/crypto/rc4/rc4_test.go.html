<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rc4</h2>
<ul>
<li><a href="/gostd/crypto/rc4/rc4.go.html">rc4.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_asm.go.html">rc4_asm.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_test.go.html">rc4_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8455771">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8455826">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8455880">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8455931">package</span>&nbsp;<span class="ident" id="8455939">rc4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8455944">import</span>&nbsp;<span class="op" id="8455951">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8455954">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8455963">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8455970">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8455980">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8455983">type</span>&nbsp;<span class="ident" id="8455988">rc4Test</span>&nbsp;<span class="keyword" id="8455996">struct</span>&nbsp;<span class="op" id="8456003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8456006">key</span><span class="op" id="8456009">,</span>&nbsp;<span class="ident" id="8456011">keystream</span>&nbsp;<span class="op" id="8456021">[</span><span class="op" id="8456022">]</span><span class="builtintype" id="8456023">byte</span><br>
<span class="lineno">15</span><span class="op" id="8456028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8456031">var</span>&nbsp;<span class="ident" id="8456035">golden</span>&nbsp;<span class="op" id="8456042">=</span>&nbsp;<span class="op" id="8456044">[</span><span class="op" id="8456045">]</span><span class="ident" id="8456046">rc4Test</span><span class="op" id="8456053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8456056">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;original&nbsp;cypherpunk&nbsp;posting&nbsp;of&nbsp;ARC4:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8456119">//&nbsp;&nbsp;&nbsp;http://groups.google.com/group/sci.crypt/msg/10a300c9d21afca0?pli=1</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8456193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8456197">[</span><span class="op" id="8456198">]</span><span class="builtintype" id="8456199">byte</span><span class="op" id="8456203">{</span><span class="num" id="8456204">0x01</span><span class="op" id="8456208">,</span>&nbsp;<span class="num" id="8456210">0x23</span><span class="op" id="8456214">,</span>&nbsp;<span class="num" id="8456216">0x45</span><span class="op" id="8456220">,</span>&nbsp;<span class="num" id="8456222">0x67</span><span class="op" id="8456226">,</span>&nbsp;<span class="num" id="8456228">0x89</span><span class="op" id="8456232">,</span>&nbsp;<span class="num" id="8456234">0xab</span><span class="op" id="8456238">,</span>&nbsp;<span class="num" id="8456240">0xcd</span><span class="op" id="8456244">,</span>&nbsp;<span class="num" id="8456246">0xef</span><span class="op" id="8456250">}</span><span class="op" id="8456251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8456255">[</span><span class="op" id="8456256">]</span><span class="builtintype" id="8456257">byte</span><span class="op" id="8456261">{</span><span class="num" id="8456262">0x74</span><span class="op" id="8456266">,</span>&nbsp;<span class="num" id="8456268">0x94</span><span class="op" id="8456272">,</span>&nbsp;<span class="num" id="8456274">0xc2</span><span class="op" id="8456278">,</span>&nbsp;<span class="num" id="8456280">0xe7</span><span class="op" id="8456284">,</span>&nbsp;<span class="num" id="8456286">0x10</span><span class="op" id="8456290">,</span>&nbsp;<span class="num" id="8456292">0x4b</span><span class="op" id="8456296">,</span>&nbsp;<span class="num" id="8456298">0x08</span><span class="op" id="8456302">,</span>&nbsp;<span class="num" id="8456304">0x79</span><span class="op" id="8456308">}</span><span class="op" id="8456309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8456312">}</span><span class="op" id="8456313">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8456316">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8456320">[</span><span class="op" id="8456321">]</span><span class="builtintype" id="8456322">byte</span><span class="op" id="8456326">{</span><span class="num" id="8456327">0x00</span><span class="op" id="8456331">,</span>&nbsp;<span class="num" id="8456333">0x00</span><span class="op" id="8456337">,</span>&nbsp;<span class="num" id="8456339">0x00</span><span class="op" id="8456343">,</span>&nbsp;<span class="num" id="8456345">0x00</span><span class="op" id="8456349">,</span>&nbsp;<span class="num" id="8456351">0x00</span><span class="op" id="8456355">,</span>&nbsp;<span class="num" id="8456357">0x00</span><span class="op" id="8456361">,</span>&nbsp;<span class="num" id="8456363">0x00</span><span class="op" id="8456367">,</span>&nbsp;<span class="num" id="8456369">0x00</span><span class="op" id="8456373">}</span><span class="op" id="8456374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8456378">[</span><span class="op" id="8456379">]</span><span class="builtintype" id="8456380">byte</span><span class="op" id="8456384">{</span><span class="num" id="8456385">0xde</span><span class="op" id="8456389">,</span>&nbsp;<span class="num" id="8456391">0x18</span><span class="op" id="8456395">,</span>&nbsp;<span class="num" id="8456397">0x89</span><span class="op" id="8456401">,</span>&nbsp;<span class="num" id="8456403">0x41</span><span class="op" id="8456407">,</span>&nbsp;<span class="num" id="8456409">0xa3</span><span class="op" id="8456413">,</span>&nbsp;<span class="num" id="8456415">0x37</span><span class="op" id="8456419">,</span>&nbsp;<span class="num" id="8456421">0x5d</span><span class="op" id="8456425">,</span>&nbsp;<span class="num" id="8456427">0x3a</span><span class="op" id="8456431">}</span><span class="op" id="8456432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8456435">}</span><span class="op" id="8456436">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8456439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8456443">[</span><span class="op" id="8456444">]</span><span class="builtintype" id="8456445">byte</span><span class="op" id="8456449">{</span><span class="num" id="8456450">0xef</span><span class="op" id="8456454">,</span>&nbsp;<span class="num" id="8456456">0x01</span><span class="op" id="8456460">,</span>&nbsp;<span class="num" id="8456462">0x23</span><span class="op" id="8456466">,</span>&nbsp;<span class="num" id="8456468">0x45</span><span class="op" id="8456472">}</span><span class="op" id="8456473">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8456477">[</span><span class="op" id="8456478">]</span><span class="builtintype" id="8456479">byte</span><span class="op" id="8456483">{</span><span class="num" id="8456484">0xd6</span><span class="op" id="8456488">,</span>&nbsp;<span class="num" id="8456490">0xa1</span><span class="op" id="8456494">,</span>&nbsp;<span class="num" id="8456496">0x41</span><span class="op" id="8456500">,</span>&nbsp;<span class="num" id="8456502">0xa7</span><span class="op" id="8456506">,</span>&nbsp;<span class="num" id="8456508">0xec</span><span class="op" id="8456512">,</span>&nbsp;<span class="num" id="8456514">0x3c</span><span class="op" id="8456518">,</span>&nbsp;<span class="num" id="8456520">0x38</span><span class="op" id="8456524">,</span>&nbsp;<span class="num" id="8456526">0xdf</span><span class="op" id="8456530">,</span>&nbsp;<span class="num" id="8456532">0xbd</span><span class="op" id="8456536">,</span>&nbsp;<span class="num" id="8456538">0x61</span><span class="op" id="8456542">}</span><span class="op" id="8456543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8456546">}</span><span class="op" id="8456547">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8456551">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;Wikipedia&nbsp;page:&nbsp;http://en.wikipedia.org/wiki/RC4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8456626">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8456630">[</span><span class="op" id="8456631">]</span><span class="builtintype" id="8456632">byte</span><span class="op" id="8456636">{</span><span class="num" id="8456637">0x4b</span><span class="op" id="8456641">,</span>&nbsp;<span class="num" id="8456643">0x65</span><span class="op" id="8456647">,</span>&nbsp;<span class="num" id="8456649">0x79</span><span class="op" id="8456653">}</span><span class="op" id="8456654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8456658">[</span><span class="op" id="8456659">]</span><span class="builtintype" id="8456660">byte</span><span class="op" id="8456664">{</span><span class="num" id="8456665">0xeb</span><span class="op" id="8456669">,</span>&nbsp;<span class="num" id="8456671">0x9f</span><span class="op" id="8456675">,</span>&nbsp;<span class="num" id="8456677">0x77</span><span class="op" id="8456681">,</span>&nbsp;<span class="num" id="8456683">0x81</span><span class="op" id="8456687">,</span>&nbsp;<span class="num" id="8456689">0xb7</span><span class="op" id="8456693">,</span>&nbsp;<span class="num" id="8456695">0x34</span><span class="op" id="8456699">,</span>&nbsp;<span class="num" id="8456701">0xca</span><span class="op" id="8456705">,</span>&nbsp;<span class="num" id="8456707">0x72</span><span class="op" id="8456711">,</span>&nbsp;<span class="num" id="8456713">0xa7</span><span class="op" id="8456717">,</span>&nbsp;<span class="num" id="8456719">0x19</span><span class="op" id="8456723">}</span><span class="op" id="8456724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8456727">}</span><span class="op" id="8456728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8456731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8456735">[</span><span class="op" id="8456736">]</span><span class="builtintype" id="8456737">byte</span><span class="op" id="8456741">{</span><span class="num" id="8456742">0x57</span><span class="op" id="8456746">,</span>&nbsp;<span class="num" id="8456748">0x69</span><span class="op" id="8456752">,</span>&nbsp;<span class="num" id="8456754">0x6b</span><span class="op" id="8456758">,</span>&nbsp;<span class="num" id="8456760">0x69</span><span class="op" id="8456764">}</span><span class="op" id="8456765">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8456769">[</span><span class="op" id="8456770">]</span><span class="builtintype" id="8456771">byte</span><span class="op" id="8456775">{</span><span class="num" id="8456776">0x60</span><span class="op" id="8456780">,</span>&nbsp;<span class="num" id="8456782">0x44</span><span class="op" id="8456786">,</span>&nbsp;<span class="num" id="8456788">0xdb</span><span class="op" id="8456792">,</span>&nbsp;<span class="num" id="8456794">0x6d</span><span class="op" id="8456798">,</span>&nbsp;<span class="num" id="8456800">0x41</span><span class="op" id="8456804">,</span>&nbsp;<span class="num" id="8456806">0xb7</span><span class="op" id="8456810">}</span><span class="op" id="8456811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8456814">}</span><span class="op" id="8456815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8456818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8456822">[</span><span class="op" id="8456823">]</span><span class="builtintype" id="8456824">byte</span><span class="op" id="8456828">{</span><span class="num" id="8456829">0x00</span><span class="op" id="8456833">,</span>&nbsp;<span class="num" id="8456835">0x00</span><span class="op" id="8456839">,</span>&nbsp;<span class="num" id="8456841">0x00</span><span class="op" id="8456845">,</span>&nbsp;<span class="num" id="8456847">0x00</span><span class="op" id="8456851">,</span>&nbsp;<span class="num" id="8456853">0x00</span><span class="op" id="8456857">,</span>&nbsp;<span class="num" id="8456859">0x00</span><span class="op" id="8456863">,</span>&nbsp;<span class="num" id="8456865">0x00</span><span class="op" id="8456869">,</span>&nbsp;<span class="num" id="8456871">0x00</span><span class="op" id="8456875">}</span><span class="op" id="8456876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8456880">[</span><span class="op" id="8456881">]</span><span class="builtintype" id="8456882">byte</span><span class="op" id="8456886">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8456891">0xde</span><span class="op" id="8456895">,</span>&nbsp;<span class="num" id="8456897">0x18</span><span class="op" id="8456901">,</span>&nbsp;<span class="num" id="8456903">0x89</span><span class="op" id="8456907">,</span>&nbsp;<span class="num" id="8456909">0x41</span><span class="op" id="8456913">,</span>&nbsp;<span class="num" id="8456915">0xa3</span><span class="op" id="8456919">,</span>&nbsp;<span class="num" id="8456921">0x37</span><span class="op" id="8456925">,</span>&nbsp;<span class="num" id="8456927">0x5d</span><span class="op" id="8456931">,</span>&nbsp;<span class="num" id="8456933">0x3a</span><span class="op" id="8456937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8456942">0x8a</span><span class="op" id="8456946">,</span>&nbsp;<span class="num" id="8456948">0x06</span><span class="op" id="8456952">,</span>&nbsp;<span class="num" id="8456954">0x1e</span><span class="op" id="8456958">,</span>&nbsp;<span class="num" id="8456960">0x67</span><span class="op" id="8456964">,</span>&nbsp;<span class="num" id="8456966">0x57</span><span class="op" id="8456970">,</span>&nbsp;<span class="num" id="8456972">0x6e</span><span class="op" id="8456976">,</span>&nbsp;<span class="num" id="8456978">0x92</span><span class="op" id="8456982">,</span>&nbsp;<span class="num" id="8456984">0x6d</span><span class="op" id="8456988">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8456993">0xc7</span><span class="op" id="8456997">,</span>&nbsp;<span class="num" id="8456999">0x1a</span><span class="op" id="8457003">,</span>&nbsp;<span class="num" id="8457005">0x7f</span><span class="op" id="8457009">,</span>&nbsp;<span class="num" id="8457011">0xa3</span><span class="op" id="8457015">,</span>&nbsp;<span class="num" id="8457017">0xf0</span><span class="op" id="8457021">,</span>&nbsp;<span class="num" id="8457023">0xcc</span><span class="op" id="8457027">,</span>&nbsp;<span class="num" id="8457029">0xeb</span><span class="op" id="8457033">,</span>&nbsp;<span class="num" id="8457035">0x97</span><span class="op" id="8457039">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8457044">0x45</span><span class="op" id="8457048">,</span>&nbsp;<span class="num" id="8457050">0x2b</span><span class="op" id="8457054">,</span>&nbsp;<span class="num" id="8457056">0x4d</span><span class="op" id="8457060">,</span>&nbsp;<span class="num" id="8457062">0x32</span><span class="op" id="8457066">,</span>&nbsp;<span class="num" id="8457068">0x27</span><span class="op" id="8457072">,</span>&nbsp;<span class="num" id="8457074">0x96</span><span class="op" id="8457078">,</span>&nbsp;<span class="num" id="8457080">0x5f</span><span class="op" id="8457084">,</span>&nbsp;<span class="num" id="8457086">0x9e</span><span class="op" id="8457090">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8457095">0xa8</span><span class="op" id="8457099">,</span>&nbsp;<span class="num" id="8457101">0xcc</span><span class="op" id="8457105">,</span>&nbsp;<span class="num" id="8457107">0x75</span><span class="op" id="8457111">,</span>&nbsp;<span class="num" id="8457113">0x07</span><span class="op" id="8457117">,</span>&nbsp;<span class="num" id="8457119">0x6d</span><span class="op" id="8457123">,</span>&nbsp;<span class="num" id="8457125">0x9f</span><span class="op" id="8457129">,</span>&nbsp;<span class="num" id="8457131">0xb9</span><span class="op" id="8457135">,</span>&nbsp;<span class="num" id="8457137">0xc5</span><span class="op" id="8457141">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8457146">0x41</span><span class="op" id="8457150">,</span>&nbsp;<span class="num" id="8457152">0x7a</span><span class="op" id="8457156">,</span>&nbsp;<span class="num" id="8457158">0xa5</span><span class="op" id="8457162">,</span>&nbsp;<span class="num" id="8457164">0xcb</span><span class="op" id="8457168">,</span>&nbsp;<span class="num" id="8457170">0x30</span><span class="op" id="8457174">,</span>&nbsp;<span class="num" id="8457176">0xfc</span><span class="op" id="8457180">,</span>&nbsp;<span class="num" id="8457182">0x22</span><span class="op" id="8457186">,</span>&nbsp;<span class="num" id="8457188">0x19</span><span class="op" id="8457192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8457197">0x8b</span><span class="op" id="8457201">,</span>&nbsp;<span class="num" id="8457203">0x34</span><span class="op" id="8457207">,</span>&nbsp;<span class="num" id="8457209">0x98</span><span class="op" id="8457213">,</span>&nbsp;<span class="num" id="8457215">0x2d</span><span class="op" id="8457219">,</span>&nbsp;<span class="num" id="8457221">0xbb</span><span class="op" id="8457225">,</span>&nbsp;<span class="num" id="8457227">0x62</span><span class="op" id="8457231">,</span>&nbsp;<span class="num" id="8457233">0x9e</span><span class="op" id="8457237">,</span>&nbsp;<span class="num" id="8457239">0xc0</span><span class="op" id="8457243">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8457248">0x4b</span><span class="op" id="8457252">,</span>&nbsp;<span class="num" id="8457254">0x4f</span><span class="op" id="8457258">,</span>&nbsp;<span class="num" id="8457260">0x8b</span><span class="op" id="8457264">,</span>&nbsp;<span class="num" id="8457266">0x05</span><span class="op" id="8457270">,</span>&nbsp;<span class="num" id="8457272">0xa0</span><span class="op" id="8457276">,</span>&nbsp;<span class="num" id="8457278">0x71</span><span class="op" id="8457282">,</span>&nbsp;<span class="num" id="8457284">0x08</span><span class="op" id="8457288">,</span>&nbsp;<span class="num" id="8457290">0x50</span><span class="op" id="8457294">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8457299">0x92</span><span class="op" id="8457303">,</span>&nbsp;<span class="num" id="8457305">0xa0</span><span class="op" id="8457309">,</span>&nbsp;<span class="num" id="8457311">0xc3</span><span class="op" id="8457315">,</span>&nbsp;<span class="num" id="8457317">0x58</span><span class="op" id="8457321">,</span>&nbsp;<span class="num" id="8457323">0x4a</span><span class="op" id="8457327">,</span>&nbsp;<span class="num" id="8457329">0x48</span><span class="op" id="8457333">,</span>&nbsp;<span class="num" id="8457335">0xe4</span><span class="op" id="8457339">,</span>&nbsp;<span class="num" id="8457341">0xa3</span><span class="op" id="8457345">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8457350">0x0a</span><span class="op" id="8457354">,</span>&nbsp;<span class="num" id="8457356">0x39</span><span class="op" id="8457360">,</span>&nbsp;<span class="num" id="8457362">0x7b</span><span class="op" id="8457366">,</span>&nbsp;<span class="num" id="8457368">0x8a</span><span class="op" id="8457372">,</span>&nbsp;<span class="num" id="8457374">0xcd</span><span class="op" id="8457378">,</span>&nbsp;<span class="num" id="8457380">0x1d</span><span class="op" id="8457384">,</span>&nbsp;<span class="num" id="8457386">0x00</span><span class="op" id="8457390">,</span>&nbsp;<span class="num" id="8457392">0x9e</span><span class="op" id="8457396">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8457401">0xc8</span><span class="op" id="8457405">,</span>&nbsp;<span class="num" id="8457407">0x7d</span><span class="op" id="8457411">,</span>&nbsp;<span class="num" id="8457413">0x68</span><span class="op" id="8457417">,</span>&nbsp;<span class="num" id="8457419">0x11</span><span class="op" id="8457423">,</span>&nbsp;<span class="num" id="8457425">0xf2</span><span class="op" id="8457429">,</span>&nbsp;<span class="num" id="8457431">0x2c</span><span class="op" id="8457435">,</span>&nbsp;<span class="num" id="8457437">0xf4</span><span class="op" id="8457441">,</span>&nbsp;<span class="num" id="8457443">0x9c</span><span class="op" id="8457447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8457452">0xa3</span><span class="op" id="8457456">,</span>&nbsp;<span class="num" id="8457458">0xe5</span><span class="op" id="8457462">,</span>&nbsp;<span class="num" id="8457464">0x93</span><span class="op" id="8457468">,</span>&nbsp;<span class="num" id="8457470">0x54</span><span class="op" id="8457474">,</span>&nbsp;<span class="num" id="8457476">0xb9</span><span class="op" id="8457480">,</span>&nbsp;<span class="num" id="8457482">0x45</span><span class="op" id="8457486">,</span>&nbsp;<span class="num" id="8457488">0x15</span><span class="op" id="8457492">,</span>&nbsp;<span class="num" id="8457494">0x35</span><span class="op" id="8457498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8457503">0xa2</span><span class="op" id="8457507">,</span>&nbsp;<span class="num" id="8457509">0x18</span><span class="op" id="8457513">,</span>&nbsp;<span class="num" id="8457515">0x7a</span><span class="op" id="8457519">,</span>&nbsp;<span class="num" id="8457521">0x86</span><span class="op" id="8457525">,</span>&nbsp;<span class="num" id="8457527">0x42</span><span class="op" id="8457531">,</span>&nbsp;<span class="num" id="8457533">0x6c</span><span class="op" id="8457537">,</span>&nbsp;<span class="num" id="8457539">0xca</span><span class="op" id="8457543">,</span>&nbsp;<span class="num" id="8457545">0x7d</span><span class="op" id="8457549">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8457554">0x5e</span><span class="op" id="8457558">,</span>&nbsp;<span class="num" id="8457560">0x82</span><span class="op" id="8457564">,</span>&nbsp;<span class="num" id="8457566">0x3e</span><span class="op" id="8457570">,</span>&nbsp;<span class="num" id="8457572">0xba</span><span class="op" id="8457576">,</span>&nbsp;<span class="num" id="8457578">0x00</span><span class="op" id="8457582">,</span>&nbsp;<span class="num" id="8457584">0x44</span><span class="op" id="8457588">,</span>&nbsp;<span class="num" id="8457590">0x12</span><span class="op" id="8457594">,</span>&nbsp;<span class="num" id="8457596">0x67</span><span class="op" id="8457600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8457605">0x12</span><span class="op" id="8457609">,</span>&nbsp;<span class="num" id="8457611">0x57</span><span class="op" id="8457615">,</span>&nbsp;<span class="num" id="8457617">0xb8</span><span class="op" id="8457621">,</span>&nbsp;<span class="num" id="8457623">0xd8</span><span class="op" id="8457627">,</span>&nbsp;<span class="num" id="8457629">0x60</span><span class="op" id="8457633">,</span>&nbsp;<span class="num" id="8457635">0xae</span><span class="op" id="8457639">,</span>&nbsp;<span class="num" id="8457641">0x4c</span><span class="op" id="8457645">,</span>&nbsp;<span class="num" id="8457647">0xbd</span><span class="op" id="8457651">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8457656">0x4c</span><span class="op" id="8457660">,</span>&nbsp;<span class="num" id="8457662">0x49</span><span class="op" id="8457666">,</span>&nbsp;<span class="num" id="8457668">0x06</span><span class="op" id="8457672">,</span>&nbsp;<span class="num" id="8457674">0xbb</span><span class="op" id="8457678">,</span>&nbsp;<span class="num" id="8457680">0xc5</span><span class="op" id="8457684">,</span>&nbsp;<span class="num" id="8457686">0x35</span><span class="op" id="8457690">,</span>&nbsp;<span class="num" id="8457692">0xef</span><span class="op" id="8457696">,</span>&nbsp;<span class="num" id="8457698">0xe1</span><span class="op" id="8457702">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8457707">0x58</span><span class="op" id="8457711">,</span>&nbsp;<span class="num" id="8457713">0x7f</span><span class="op" id="8457717">,</span>&nbsp;<span class="num" id="8457719">0x08</span><span class="op" id="8457723">,</span>&nbsp;<span class="num" id="8457725">0xdb</span><span class="op" id="8457729">,</span>&nbsp;<span class="num" id="8457731">0x33</span><span class="op" id="8457735">,</span>&nbsp;<span class="num" id="8457737">0x95</span><span class="op" id="8457741">,</span>&nbsp;<span class="num" id="8457743">0x5c</span><span class="op" id="8457747">,</span>&nbsp;<span class="num" id="8457749">0xdb</span><span class="op" id="8457753">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8457758">0xcb</span><span class="op" id="8457762">,</span>&nbsp;<span class="num" id="8457764">0xad</span><span class="op" id="8457768">,</span>&nbsp;<span class="num" id="8457770">0x9b</span><span class="op" id="8457774">,</span>&nbsp;<span class="num" id="8457776">0x10</span><span class="op" id="8457780">,</span>&nbsp;<span class="num" id="8457782">0xf5</span><span class="op" id="8457786">,</span>&nbsp;<span class="num" id="8457788">0x3f</span><span class="op" id="8457792">,</span>&nbsp;<span class="num" id="8457794">0xc4</span><span class="op" id="8457798">,</span>&nbsp;<span class="num" id="8457800">0xe5</span><span class="op" id="8457804">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8457809">0x2c</span><span class="op" id="8457813">,</span>&nbsp;<span class="num" id="8457815">0x59</span><span class="op" id="8457819">,</span>&nbsp;<span class="num" id="8457821">0x15</span><span class="op" id="8457825">,</span>&nbsp;<span class="num" id="8457827">0x65</span><span class="op" id="8457831">,</span>&nbsp;<span class="num" id="8457833">0x51</span><span class="op" id="8457837">,</span>&nbsp;<span class="num" id="8457839">0x84</span><span class="op" id="8457843">,</span>&nbsp;<span class="num" id="8457845">0x87</span><span class="op" id="8457849">,</span>&nbsp;<span class="num" id="8457851">0xfe</span><span class="op" id="8457855">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8457860">0x08</span><span class="op" id="8457864">,</span>&nbsp;<span class="num" id="8457866">0x4d</span><span class="op" id="8457870">,</span>&nbsp;<span class="num" id="8457872">0x0e</span><span class="op" id="8457876">,</span>&nbsp;<span class="num" id="8457878">0x3f</span><span class="op" id="8457882">,</span>&nbsp;<span class="num" id="8457884">0x03</span><span class="op" id="8457888">,</span>&nbsp;<span class="num" id="8457890">0xde</span><span class="op" id="8457894">,</span>&nbsp;<span class="num" id="8457896">0xbc</span><span class="op" id="8457900">,</span>&nbsp;<span class="num" id="8457902">0xc9</span><span class="op" id="8457906">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8457911">0xda</span><span class="op" id="8457915">,</span>&nbsp;<span class="num" id="8457917">0x1c</span><span class="op" id="8457921">,</span>&nbsp;<span class="num" id="8457923">0xe9</span><span class="op" id="8457927">,</span>&nbsp;<span class="num" id="8457929">0x0d</span><span class="op" id="8457933">,</span>&nbsp;<span class="num" id="8457935">0x08</span><span class="op" id="8457939">,</span>&nbsp;<span class="num" id="8457941">0x5c</span><span class="op" id="8457945">,</span>&nbsp;<span class="num" id="8457947">0x2d</span><span class="op" id="8457951">,</span>&nbsp;<span class="num" id="8457953">0x8a</span><span class="op" id="8457957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8457962">0x19</span><span class="op" id="8457966">,</span>&nbsp;<span class="num" id="8457968">0xd8</span><span class="op" id="8457972">,</span>&nbsp;<span class="num" id="8457974">0x37</span><span class="op" id="8457978">,</span>&nbsp;<span class="num" id="8457980">0x30</span><span class="op" id="8457984">,</span>&nbsp;<span class="num" id="8457986">0x86</span><span class="op" id="8457990">,</span>&nbsp;<span class="num" id="8457992">0x16</span><span class="op" id="8457996">,</span>&nbsp;<span class="num" id="8457998">0x36</span><span class="op" id="8458002">,</span>&nbsp;<span class="num" id="8458004">0x92</span><span class="op" id="8458008">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8458013">0x14</span><span class="op" id="8458017">,</span>&nbsp;<span class="num" id="8458019">0x2b</span><span class="op" id="8458023">,</span>&nbsp;<span class="num" id="8458025">0xd8</span><span class="op" id="8458029">,</span>&nbsp;<span class="num" id="8458031">0xfc</span><span class="op" id="8458035">,</span>&nbsp;<span class="num" id="8458037">0x5d</span><span class="op" id="8458041">,</span>&nbsp;<span class="num" id="8458043">0x7a</span><span class="op" id="8458047">,</span>&nbsp;<span class="num" id="8458049">0x73</span><span class="op" id="8458053">,</span>&nbsp;<span class="num" id="8458055">0x49</span><span class="op" id="8458059">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8458064">0x6a</span><span class="op" id="8458068">,</span>&nbsp;<span class="num" id="8458070">0x8e</span><span class="op" id="8458074">,</span>&nbsp;<span class="num" id="8458076">0x59</span><span class="op" id="8458080">,</span>&nbsp;<span class="num" id="8458082">0xee</span><span class="op" id="8458086">,</span>&nbsp;<span class="num" id="8458088">0x7e</span><span class="op" id="8458092">,</span>&nbsp;<span class="num" id="8458094">0xcf</span><span class="op" id="8458098">,</span>&nbsp;<span class="num" id="8458100">0x6b</span><span class="op" id="8458104">,</span>&nbsp;<span class="num" id="8458106">0x94</span><span class="op" id="8458110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8458115">0x06</span><span class="op" id="8458119">,</span>&nbsp;<span class="num" id="8458121">0x63</span><span class="op" id="8458125">,</span>&nbsp;<span class="num" id="8458127">0xf4</span><span class="op" id="8458131">,</span>&nbsp;<span class="num" id="8458133">0xa6</span><span class="op" id="8458137">,</span>&nbsp;<span class="num" id="8458139">0xbe</span><span class="op" id="8458143">,</span>&nbsp;<span class="num" id="8458145">0xe6</span><span class="op" id="8458149">,</span>&nbsp;<span class="num" id="8458151">0x5b</span><span class="op" id="8458155">,</span>&nbsp;<span class="num" id="8458157">0xd2</span><span class="op" id="8458161">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8458166">0xc8</span><span class="op" id="8458170">,</span>&nbsp;<span class="num" id="8458172">0x5c</span><span class="op" id="8458176">,</span>&nbsp;<span class="num" id="8458178">0x46</span><span class="op" id="8458182">,</span>&nbsp;<span class="num" id="8458184">0x98</span><span class="op" id="8458188">,</span>&nbsp;<span class="num" id="8458190">0x6c</span><span class="op" id="8458194">,</span>&nbsp;<span class="num" id="8458196">0x1b</span><span class="op" id="8458200">,</span>&nbsp;<span class="num" id="8458202">0xef</span><span class="op" id="8458206">,</span>&nbsp;<span class="num" id="8458208">0x34</span><span class="op" id="8458212">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8458217">0x90</span><span class="op" id="8458221">,</span>&nbsp;<span class="num" id="8458223">0xd3</span><span class="op" id="8458227">,</span>&nbsp;<span class="num" id="8458229">0x7b</span><span class="op" id="8458233">,</span>&nbsp;<span class="num" id="8458235">0x38</span><span class="op" id="8458239">,</span>&nbsp;<span class="num" id="8458241">0xda</span><span class="op" id="8458245">,</span>&nbsp;<span class="num" id="8458247">0x85</span><span class="op" id="8458251">,</span>&nbsp;<span class="num" id="8458253">0xd3</span><span class="op" id="8458257">,</span>&nbsp;<span class="num" id="8458259">0x2e</span><span class="op" id="8458263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8458268">0x97</span><span class="op" id="8458272">,</span>&nbsp;<span class="num" id="8458274">0x39</span><span class="op" id="8458278">,</span>&nbsp;<span class="num" id="8458280">0xcb</span><span class="op" id="8458284">,</span>&nbsp;<span class="num" id="8458286">0x23</span><span class="op" id="8458290">,</span>&nbsp;<span class="num" id="8458292">0x4a</span><span class="op" id="8458296">,</span>&nbsp;<span class="num" id="8458298">0x2b</span><span class="op" id="8458302">,</span>&nbsp;<span class="num" id="8458304">0xe7</span><span class="op" id="8458308">,</span>&nbsp;<span class="num" id="8458310">0x40</span><span class="op" id="8458314">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8458318">}</span><span class="op" id="8458319">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8458322">}</span><span class="op" id="8458323">,</span><br>
<span class="lineno">75</span><span class="op" id="8458325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8458328">func</span>&nbsp;<span class="ident" id="8458333">testEncrypt</span><span class="op" id="8458344">(</span><span class="ident" id="8458345">t</span>&nbsp;<span class="op" id="8458347">*</span><span class="ident" id="8458348">testing</span><span class="op" id="8458355">.</span><span class="ident" id="8458356">T</span><span class="op" id="8458357">,</span>&nbsp;<span class="ident" id="8458359">desc</span>&nbsp;<span class="builtintype" id="8458364">string</span><span class="op" id="8458370">,</span>&nbsp;<span class="ident" id="8458372">c</span>&nbsp;<span class="op" id="8458374">*</span><span class="ident" id="8458375">Cipher</span><span class="op" id="8458381">,</span>&nbsp;<span class="ident" id="8458383">src</span><span class="op" id="8458386">,</span>&nbsp;<span class="ident" id="8458388">expect</span>&nbsp;<span class="op" id="8458395">[</span><span class="op" id="8458396">]</span><span class="builtintype" id="8458397">byte</span><span class="op" id="8458401">)</span>&nbsp;<span class="op" id="8458403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8458406">dst</span>&nbsp;<span class="op" id="8458410">:=</span>&nbsp;<span class="builtinfunc" id="8458413">make</span><span class="op" id="8458417">(</span><span class="op" id="8458418">[</span><span class="op" id="8458419">]</span><span class="builtintype" id="8458420">byte</span><span class="op" id="8458424">,</span>&nbsp;<span class="builtinfunc" id="8458426">len</span><span class="op" id="8458429">(</span><span class="ident" id="8458430">src</span><span class="op" id="8458433">)</span><span class="op" id="8458434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8458437">c</span><span class="op" id="8458438">.</span><span class="ident" id="8458439">XORKeyStream</span><span class="op" id="8458451">(</span><span class="ident" id="8458452">dst</span><span class="op" id="8458455">,</span>&nbsp;<span class="ident" id="8458457">src</span><span class="op" id="8458460">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8458463">for</span>&nbsp;<span class="ident" id="8458467">i</span><span class="op" id="8458468">,</span>&nbsp;<span class="ident" id="8458470">v</span>&nbsp;<span class="op" id="8458472">:=</span>&nbsp;<span class="keyword" id="8458475">range</span>&nbsp;<span class="ident" id="8458481">dst</span>&nbsp;<span class="op" id="8458485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8458489">if</span>&nbsp;<span class="ident" id="8458492">v</span>&nbsp;<span class="op" id="8458494">!=</span>&nbsp;<span class="ident" id="8458497">expect</span><span class="op" id="8458503">[</span><span class="ident" id="8458504">i</span><span class="op" id="8458505">]</span>&nbsp;<span class="op" id="8458507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8458512">t</span><span class="op" id="8458513">.</span><span class="ident" id="8458514">Fatalf</span><span class="op" id="8458520">(</span><span class="string" id="8458521">&#34;%s:&nbsp;mismatch&nbsp;at&nbsp;byte&nbsp;%d:\nhave&nbsp;%x\nwant&nbsp;%x&#34;</span><span class="op" id="8458565">,</span>&nbsp;<span class="ident" id="8458567">desc</span><span class="op" id="8458571">,</span>&nbsp;<span class="ident" id="8458573">i</span><span class="op" id="8458574">,</span>&nbsp;<span class="ident" id="8458576">dst</span><span class="op" id="8458579">,</span>&nbsp;<span class="ident" id="8458581">expect</span><span class="op" id="8458587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8458591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8458594">}</span><br>
<span class="lineno">85</span><span class="op" id="8458596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8458599">func</span>&nbsp;<span class="ident" id="8458604">TestGolden</span><span class="op" id="8458614">(</span><span class="ident" id="8458615">t</span>&nbsp;<span class="op" id="8458617">*</span><span class="ident" id="8458618">testing</span><span class="op" id="8458625">.</span><span class="ident" id="8458626">T</span><span class="op" id="8458627">)</span>&nbsp;<span class="op" id="8458629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8458632">for</span>&nbsp;<span class="ident" id="8458636">gi</span><span class="op" id="8458638">,</span>&nbsp;<span class="ident" id="8458640">g</span>&nbsp;<span class="op" id="8458642">:=</span>&nbsp;<span class="keyword" id="8458645">range</span>&nbsp;<span class="ident" id="8458651">golden</span>&nbsp;<span class="op" id="8458658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8458662">data</span>&nbsp;<span class="op" id="8458667">:=</span>&nbsp;<span class="builtinfunc" id="8458670">make</span><span class="op" id="8458674">(</span><span class="op" id="8458675">[</span><span class="op" id="8458676">]</span><span class="builtintype" id="8458677">byte</span><span class="op" id="8458681">,</span>&nbsp;<span class="builtinfunc" id="8458683">len</span><span class="op" id="8458686">(</span><span class="ident" id="8458687">g</span><span class="op" id="8458688">.</span><span class="ident" id="8458689">keystream</span><span class="op" id="8458698">)</span><span class="op" id="8458699">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8458703">for</span>&nbsp;<span class="ident" id="8458707">i</span>&nbsp;<span class="op" id="8458709">:=</span>&nbsp;<span class="keyword" id="8458712">range</span>&nbsp;<span class="ident" id="8458718">data</span>&nbsp;<span class="op" id="8458723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8458728">data</span><span class="op" id="8458732">[</span><span class="ident" id="8458733">i</span><span class="op" id="8458734">]</span>&nbsp;<span class="op" id="8458736">=</span>&nbsp;<span class="builtintype" id="8458738">byte</span><span class="op" id="8458742">(</span><span class="ident" id="8458743">i</span><span class="op" id="8458744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8458748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8458753">expect</span>&nbsp;<span class="op" id="8458760">:=</span>&nbsp;<span class="builtinfunc" id="8458763">make</span><span class="op" id="8458767">(</span><span class="op" id="8458768">[</span><span class="op" id="8458769">]</span><span class="builtintype" id="8458770">byte</span><span class="op" id="8458774">,</span>&nbsp;<span class="builtinfunc" id="8458776">len</span><span class="op" id="8458779">(</span><span class="ident" id="8458780">g</span><span class="op" id="8458781">.</span><span class="ident" id="8458782">keystream</span><span class="op" id="8458791">)</span><span class="op" id="8458792">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8458796">for</span>&nbsp;<span class="ident" id="8458800">i</span>&nbsp;<span class="op" id="8458802">:=</span>&nbsp;<span class="keyword" id="8458805">range</span>&nbsp;<span class="ident" id="8458811">expect</span>&nbsp;<span class="op" id="8458818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8458823">expect</span><span class="op" id="8458829">[</span><span class="ident" id="8458830">i</span><span class="op" id="8458831">]</span>&nbsp;<span class="op" id="8458833">=</span>&nbsp;<span class="builtintype" id="8458835">byte</span><span class="op" id="8458839">(</span><span class="ident" id="8458840">i</span><span class="op" id="8458841">)</span>&nbsp;<span class="op" id="8458843">^</span>&nbsp;<span class="ident" id="8458845">g</span><span class="op" id="8458846">.</span><span class="ident" id="8458847">keystream</span><span class="op" id="8458856">[</span><span class="ident" id="8458857">i</span><span class="op" id="8458858">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8458862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8458867">for</span>&nbsp;<span class="ident" id="8458871">size</span>&nbsp;<span class="op" id="8458876">:=</span>&nbsp;<span class="num" id="8458879">1</span><span class="op" id="8458880">;</span>&nbsp;<span class="ident" id="8458882">size</span>&nbsp;<span class="op" id="8458887">&lt;=</span>&nbsp;<span class="builtinfunc" id="8458890">len</span><span class="op" id="8458893">(</span><span class="ident" id="8458894">g</span><span class="op" id="8458895">.</span><span class="ident" id="8458896">keystream</span><span class="op" id="8458905">)</span><span class="op" id="8458906">;</span>&nbsp;<span class="ident" id="8458908">size</span><span class="op" id="8458912">++</span>&nbsp;<span class="op" id="8458915">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8458920">c</span><span class="op" id="8458921">,</span>&nbsp;<span class="ident" id="8458923">err</span>&nbsp;<span class="op" id="8458927">:=</span>&nbsp;<span class="ident" id="8458930">NewCipher</span><span class="op" id="8458939">(</span><span class="ident" id="8458940">g</span><span class="op" id="8458941">.</span><span class="ident" id="8458942">key</span><span class="op" id="8458945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8458950">if</span>&nbsp;<span class="ident" id="8458953">err</span>&nbsp;<span class="op" id="8458957">!=</span>&nbsp;<span class="ident" id="8458960">nil</span>&nbsp;<span class="op" id="8458964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8458970">t</span><span class="op" id="8458971">.</span><span class="ident" id="8458972">Fatalf</span><span class="op" id="8458978">(</span><span class="string" id="8458979">&#34;#%d:&nbsp;NewCipher:&nbsp;%v&#34;</span><span class="op" id="8458999">,</span>&nbsp;<span class="ident" id="8459001">gi</span><span class="op" id="8459003">,</span>&nbsp;<span class="ident" id="8459005">err</span><span class="op" id="8459008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8459013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8459019">off</span>&nbsp;<span class="op" id="8459023">:=</span>&nbsp;<span class="num" id="8459026">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8459031">for</span>&nbsp;<span class="ident" id="8459035">off</span>&nbsp;<span class="op" id="8459039">&lt;</span>&nbsp;<span class="builtinfunc" id="8459041">len</span><span class="op" id="8459044">(</span><span class="ident" id="8459045">g</span><span class="op" id="8459046">.</span><span class="ident" id="8459047">keystream</span><span class="op" id="8459056">)</span>&nbsp;<span class="op" id="8459058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8459064">n</span>&nbsp;<span class="op" id="8459066">:=</span>&nbsp;<span class="builtinfunc" id="8459069">len</span><span class="op" id="8459072">(</span><span class="ident" id="8459073">g</span><span class="op" id="8459074">.</span><span class="ident" id="8459075">keystream</span><span class="op" id="8459084">)</span>&nbsp;<span class="op" id="8459086">-</span>&nbsp;<span class="ident" id="8459088">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8459096">if</span>&nbsp;<span class="ident" id="8459099">n</span>&nbsp;<span class="op" id="8459101">&gt;</span>&nbsp;<span class="ident" id="8459103">size</span>&nbsp;<span class="op" id="8459108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8459115">n</span>&nbsp;<span class="op" id="8459117">=</span>&nbsp;<span class="ident" id="8459119">size</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8459128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8459134">desc</span>&nbsp;<span class="op" id="8459139">:=</span>&nbsp;<span class="ident" id="8459142">fmt</span><span class="op" id="8459145">.</span><span class="ident" id="8459146">Sprintf</span><span class="op" id="8459153">(</span><span class="string" id="8459154">&#34;#%d@[%d:%d]&#34;</span><span class="op" id="8459167">,</span>&nbsp;<span class="ident" id="8459169">gi</span><span class="op" id="8459171">,</span>&nbsp;<span class="ident" id="8459173">off</span><span class="op" id="8459176">,</span>&nbsp;<span class="ident" id="8459178">off</span><span class="op" id="8459181">+</span><span class="ident" id="8459182">n</span><span class="op" id="8459183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8459189">testEncrypt</span><span class="op" id="8459200">(</span><span class="ident" id="8459201">t</span><span class="op" id="8459202">,</span>&nbsp;<span class="ident" id="8459204">desc</span><span class="op" id="8459208">,</span>&nbsp;<span class="ident" id="8459210">c</span><span class="op" id="8459211">,</span>&nbsp;<span class="ident" id="8459213">data</span><span class="op" id="8459217">[</span><span class="ident" id="8459218">off</span><span class="op" id="8459221">:</span><span class="ident" id="8459222">off</span><span class="op" id="8459225">+</span><span class="ident" id="8459226">n</span><span class="op" id="8459227">]</span><span class="op" id="8459228">,</span>&nbsp;<span class="ident" id="8459230">expect</span><span class="op" id="8459236">[</span><span class="ident" id="8459237">off</span><span class="op" id="8459240">:</span><span class="ident" id="8459241">off</span><span class="op" id="8459244">+</span><span class="ident" id="8459245">n</span><span class="op" id="8459246">]</span><span class="op" id="8459247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8459253">off</span>&nbsp;<span class="op" id="8459257">+=</span>&nbsp;<span class="ident" id="8459260">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8459265">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8459269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8459272">}</span><br>
<span class="lineno"></span><span class="op" id="8459274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8459277">func</span>&nbsp;<span class="ident" id="8459282">TestBlock</span><span class="op" id="8459291">(</span><span class="ident" id="8459292">t</span>&nbsp;<span class="op" id="8459294">*</span><span class="ident" id="8459295">testing</span><span class="op" id="8459302">.</span><span class="ident" id="8459303">T</span><span class="op" id="8459304">)</span>&nbsp;<span class="op" id="8459306">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8459309">testBlock</span><span class="op" id="8459318">(</span><span class="ident" id="8459319">t</span><span class="op" id="8459320">,</span>&nbsp;<span class="op" id="8459322">(</span><span class="op" id="8459323">*</span><span class="ident" id="8459324">Cipher</span><span class="op" id="8459330">)</span><span class="op" id="8459331">.</span><span class="ident" id="8459332">XORKeyStream</span><span class="op" id="8459344">)</span><br>
<span class="lineno"></span><span class="op" id="8459346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8459349">//&nbsp;Test&nbsp;the&nbsp;pure&nbsp;Go&nbsp;version.</span><br>
<span class="lineno"></span><span class="comment" id="8459378">//&nbsp;Because&nbsp;we&nbsp;have&nbsp;assembly&nbsp;for&nbsp;amd64,&nbsp;386,&nbsp;and&nbsp;arm,&nbsp;this&nbsp;prevents</span><br>
<span class="lineno">125</span><span class="comment" id="8459445">//&nbsp;bitrot&nbsp;of&nbsp;the&nbsp;reference&nbsp;implementations.</span><br>
<span class="lineno"></span><span class="keyword" id="8459489">func</span>&nbsp;<span class="ident" id="8459494">TestBlockGeneric</span><span class="op" id="8459510">(</span><span class="ident" id="8459511">t</span>&nbsp;<span class="op" id="8459513">*</span><span class="ident" id="8459514">testing</span><span class="op" id="8459521">.</span><span class="ident" id="8459522">T</span><span class="op" id="8459523">)</span>&nbsp;<span class="op" id="8459525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8459528">testBlock</span><span class="op" id="8459537">(</span><span class="ident" id="8459538">t</span><span class="op" id="8459539">,</span>&nbsp;<span class="op" id="8459541">(</span><span class="op" id="8459542">*</span><span class="ident" id="8459543">Cipher</span><span class="op" id="8459549">)</span><span class="op" id="8459550">.</span><span class="ident" id="8459551">xorKeyStreamGeneric</span><span class="op" id="8459570">)</span><br>
<span class="lineno"></span><span class="op" id="8459572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="8459575">func</span>&nbsp;<span class="ident" id="8459580">testBlock</span><span class="op" id="8459589">(</span><span class="ident" id="8459590">t</span>&nbsp;<span class="op" id="8459592">*</span><span class="ident" id="8459593">testing</span><span class="op" id="8459600">.</span><span class="ident" id="8459601">T</span><span class="op" id="8459602">,</span>&nbsp;<span class="ident" id="8459604">xor</span>&nbsp;<span class="keyword" id="8459608">func</span><span class="op" id="8459612">(</span><span class="ident" id="8459613">c</span>&nbsp;<span class="op" id="8459615">*</span><span class="ident" id="8459616">Cipher</span><span class="op" id="8459622">,</span>&nbsp;<span class="ident" id="8459624">dst</span><span class="op" id="8459627">,</span>&nbsp;<span class="ident" id="8459629">src</span>&nbsp;<span class="op" id="8459633">[</span><span class="op" id="8459634">]</span><span class="builtintype" id="8459635">byte</span><span class="op" id="8459639">)</span><span class="op" id="8459640">)</span>&nbsp;<span class="op" id="8459642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8459645">c1a</span><span class="op" id="8459648">,</span>&nbsp;<span class="ident" id="8459650">_</span>&nbsp;<span class="op" id="8459652">:=</span>&nbsp;<span class="ident" id="8459655">NewCipher</span><span class="op" id="8459664">(</span><span class="ident" id="8459665">golden</span><span class="op" id="8459671">[</span><span class="num" id="8459672">0</span><span class="op" id="8459673">]</span><span class="op" id="8459674">.</span><span class="ident" id="8459675">key</span><span class="op" id="8459678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8459681">c1b</span><span class="op" id="8459684">,</span>&nbsp;<span class="ident" id="8459686">_</span>&nbsp;<span class="op" id="8459688">:=</span>&nbsp;<span class="ident" id="8459691">NewCipher</span><span class="op" id="8459700">(</span><span class="ident" id="8459701">golden</span><span class="op" id="8459707">[</span><span class="num" id="8459708">1</span><span class="op" id="8459709">]</span><span class="op" id="8459710">.</span><span class="ident" id="8459711">key</span><span class="op" id="8459714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8459717">data1</span>&nbsp;<span class="op" id="8459723">:=</span>&nbsp;<span class="builtinfunc" id="8459726">make</span><span class="op" id="8459730">(</span><span class="op" id="8459731">[</span><span class="op" id="8459732">]</span><span class="builtintype" id="8459733">byte</span><span class="op" id="8459737">,</span>&nbsp;<span class="num" id="8459739">1</span><span class="op" id="8459740">&lt;&lt;</span><span class="num" id="8459742">20</span><span class="op" id="8459744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8459747">for</span>&nbsp;<span class="ident" id="8459751">i</span>&nbsp;<span class="op" id="8459753">:=</span>&nbsp;<span class="keyword" id="8459756">range</span>&nbsp;<span class="ident" id="8459762">data1</span>&nbsp;<span class="op" id="8459768">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8459772">xor</span><span class="op" id="8459775">(</span><span class="ident" id="8459776">c1a</span><span class="op" id="8459779">,</span>&nbsp;<span class="ident" id="8459781">data1</span><span class="op" id="8459786">[</span><span class="ident" id="8459787">i</span><span class="op" id="8459788">:</span><span class="ident" id="8459789">i</span><span class="op" id="8459790">+</span><span class="num" id="8459791">1</span><span class="op" id="8459792">]</span><span class="op" id="8459793">,</span>&nbsp;<span class="ident" id="8459795">data1</span><span class="op" id="8459800">[</span><span class="ident" id="8459801">i</span><span class="op" id="8459802">:</span><span class="ident" id="8459803">i</span><span class="op" id="8459804">+</span><span class="num" id="8459805">1</span><span class="op" id="8459806">]</span><span class="op" id="8459807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8459811">xor</span><span class="op" id="8459814">(</span><span class="ident" id="8459815">c1b</span><span class="op" id="8459818">,</span>&nbsp;<span class="ident" id="8459820">data1</span><span class="op" id="8459825">[</span><span class="ident" id="8459826">i</span><span class="op" id="8459827">:</span><span class="ident" id="8459828">i</span><span class="op" id="8459829">+</span><span class="num" id="8459830">1</span><span class="op" id="8459831">]</span><span class="op" id="8459832">,</span>&nbsp;<span class="ident" id="8459834">data1</span><span class="op" id="8459839">[</span><span class="ident" id="8459840">i</span><span class="op" id="8459841">:</span><span class="ident" id="8459842">i</span><span class="op" id="8459843">+</span><span class="num" id="8459844">1</span><span class="op" id="8459845">]</span><span class="op" id="8459846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8459849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8459853">c2a</span><span class="op" id="8459856">,</span>&nbsp;<span class="ident" id="8459858">_</span>&nbsp;<span class="op" id="8459860">:=</span>&nbsp;<span class="ident" id="8459863">NewCipher</span><span class="op" id="8459872">(</span><span class="ident" id="8459873">golden</span><span class="op" id="8459879">[</span><span class="num" id="8459880">0</span><span class="op" id="8459881">]</span><span class="op" id="8459882">.</span><span class="ident" id="8459883">key</span><span class="op" id="8459886">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8459889">c2b</span><span class="op" id="8459892">,</span>&nbsp;<span class="ident" id="8459894">_</span>&nbsp;<span class="op" id="8459896">:=</span>&nbsp;<span class="ident" id="8459899">NewCipher</span><span class="op" id="8459908">(</span><span class="ident" id="8459909">golden</span><span class="op" id="8459915">[</span><span class="num" id="8459916">1</span><span class="op" id="8459917">]</span><span class="op" id="8459918">.</span><span class="ident" id="8459919">key</span><span class="op" id="8459922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8459925">data2</span>&nbsp;<span class="op" id="8459931">:=</span>&nbsp;<span class="builtinfunc" id="8459934">make</span><span class="op" id="8459938">(</span><span class="op" id="8459939">[</span><span class="op" id="8459940">]</span><span class="builtintype" id="8459941">byte</span><span class="op" id="8459945">,</span>&nbsp;<span class="num" id="8459947">1</span><span class="op" id="8459948">&lt;&lt;</span><span class="num" id="8459950">20</span><span class="op" id="8459952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8459955">xor</span><span class="op" id="8459958">(</span><span class="ident" id="8459959">c2a</span><span class="op" id="8459962">,</span>&nbsp;<span class="ident" id="8459964">data2</span><span class="op" id="8459969">,</span>&nbsp;<span class="ident" id="8459971">data2</span><span class="op" id="8459976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8459979">xor</span><span class="op" id="8459982">(</span><span class="ident" id="8459983">c2b</span><span class="op" id="8459986">,</span>&nbsp;<span class="ident" id="8459988">data2</span><span class="op" id="8459993">,</span>&nbsp;<span class="ident" id="8459995">data2</span><span class="op" id="8460000">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8460004">if</span>&nbsp;<span class="op" id="8460007">!</span><span class="ident" id="8460008">bytes</span><span class="op" id="8460013">.</span><span class="ident" id="8460014">Equal</span><span class="op" id="8460019">(</span><span class="ident" id="8460020">data1</span><span class="op" id="8460025">,</span>&nbsp;<span class="ident" id="8460027">data2</span><span class="op" id="8460032">)</span>&nbsp;<span class="op" id="8460034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8460038">t</span><span class="op" id="8460039">.</span><span class="ident" id="8460040">Fatalf</span><span class="op" id="8460046">(</span><span class="string" id="8460047">&#34;bad&nbsp;block&#34;</span><span class="op" id="8460058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8460061">}</span><br>
<span class="lineno"></span><span class="op" id="8460063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="8460066">func</span>&nbsp;<span class="ident" id="8460071">benchmark</span><span class="op" id="8460080">(</span><span class="ident" id="8460081">b</span>&nbsp;<span class="op" id="8460083">*</span><span class="ident" id="8460084">testing</span><span class="op" id="8460091">.</span><span class="ident" id="8460092">B</span><span class="op" id="8460093">,</span>&nbsp;<span class="ident" id="8460095">size</span>&nbsp;<span class="ident" id="8460100">int64</span><span class="op" id="8460105">)</span>&nbsp;<span class="op" id="8460107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8460110">buf</span>&nbsp;<span class="op" id="8460114">:=</span>&nbsp;<span class="builtinfunc" id="8460117">make</span><span class="op" id="8460121">(</span><span class="op" id="8460122">[</span><span class="op" id="8460123">]</span><span class="builtintype" id="8460124">byte</span><span class="op" id="8460128">,</span>&nbsp;<span class="ident" id="8460130">size</span><span class="op" id="8460134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8460137">c</span><span class="op" id="8460138">,</span>&nbsp;<span class="ident" id="8460140">err</span>&nbsp;<span class="op" id="8460144">:=</span>&nbsp;<span class="ident" id="8460147">NewCipher</span><span class="op" id="8460156">(</span><span class="ident" id="8460157">golden</span><span class="op" id="8460163">[</span><span class="num" id="8460164">0</span><span class="op" id="8460165">]</span><span class="op" id="8460166">.</span><span class="ident" id="8460167">key</span><span class="op" id="8460170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8460173">if</span>&nbsp;<span class="ident" id="8460176">err</span>&nbsp;<span class="op" id="8460180">!=</span>&nbsp;<span class="ident" id="8460183">nil</span>&nbsp;<span class="op" id="8460187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8460191">panic</span><span class="op" id="8460196">(</span><span class="ident" id="8460197">err</span><span class="op" id="8460200">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8460203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8460206">b</span><span class="op" id="8460207">.</span><span class="ident" id="8460208">SetBytes</span><span class="op" id="8460216">(</span><span class="ident" id="8460217">size</span><span class="op" id="8460221">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8460225">for</span>&nbsp;<span class="ident" id="8460229">i</span>&nbsp;<span class="op" id="8460231">:=</span>&nbsp;<span class="num" id="8460234">0</span><span class="op" id="8460235">;</span>&nbsp;<span class="ident" id="8460237">i</span>&nbsp;<span class="op" id="8460239">&lt;</span>&nbsp;<span class="ident" id="8460241">b</span><span class="op" id="8460242">.</span><span class="ident" id="8460243">N</span><span class="op" id="8460244">;</span>&nbsp;<span class="ident" id="8460246">i</span><span class="op" id="8460247">++</span>&nbsp;<span class="op" id="8460250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8460254">c</span><span class="op" id="8460255">.</span><span class="ident" id="8460256">XORKeyStream</span><span class="op" id="8460268">(</span><span class="ident" id="8460269">buf</span><span class="op" id="8460272">,</span>&nbsp;<span class="ident" id="8460274">buf</span><span class="op" id="8460277">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8460280">}</span><br>
<span class="lineno"></span><span class="op" id="8460282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8460285">func</span>&nbsp;<span class="ident" id="8460290">BenchmarkRC4_128</span><span class="op" id="8460306">(</span><span class="ident" id="8460307">b</span>&nbsp;<span class="op" id="8460309">*</span><span class="ident" id="8460310">testing</span><span class="op" id="8460317">.</span><span class="ident" id="8460318">B</span><span class="op" id="8460319">)</span>&nbsp;<span class="op" id="8460321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8460324">benchmark</span><span class="op" id="8460333">(</span><span class="ident" id="8460334">b</span><span class="op" id="8460335">,</span>&nbsp;<span class="num" id="8460337">128</span><span class="op" id="8460340">)</span><br>
<span class="lineno">165</span><span class="op" id="8460342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8460345">func</span>&nbsp;<span class="ident" id="8460350">BenchmarkRC4_1K</span><span class="op" id="8460365">(</span><span class="ident" id="8460366">b</span>&nbsp;<span class="op" id="8460368">*</span><span class="ident" id="8460369">testing</span><span class="op" id="8460376">.</span><span class="ident" id="8460377">B</span><span class="op" id="8460378">)</span>&nbsp;<span class="op" id="8460380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8460383">benchmark</span><span class="op" id="8460392">(</span><span class="ident" id="8460393">b</span><span class="op" id="8460394">,</span>&nbsp;<span class="num" id="8460396">1024</span><span class="op" id="8460400">)</span><br>
<span class="lineno"></span><span class="op" id="8460402">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="8460405">func</span>&nbsp;<span class="ident" id="8460410">BenchmarkRC4_8K</span><span class="op" id="8460425">(</span><span class="ident" id="8460426">b</span>&nbsp;<span class="op" id="8460428">*</span><span class="ident" id="8460429">testing</span><span class="op" id="8460436">.</span><span class="ident" id="8460437">B</span><span class="op" id="8460438">)</span>&nbsp;<span class="op" id="8460440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8460443">benchmark</span><span class="op" id="8460452">(</span><span class="ident" id="8460453">b</span><span class="op" id="8460454">,</span>&nbsp;<span class="num" id="8460456">8096</span><span class="op" id="8460460">)</span><br>
<span class="lineno"></span><span class="op" id="8460462">}</span>
</div>
</body>
</html>
