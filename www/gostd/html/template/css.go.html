<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5122272">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5122327">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5122381">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5122432">package</span>&nbsp;<span class="ident" id="5122440">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5122450">import</span>&nbsp;<span class="op" id="5122457">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5122460">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5122469">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5122476">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5122487">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5122502">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5122505">//&nbsp;endsWithCSSKeyword&nbsp;reports&nbsp;whether&nbsp;b&nbsp;ends&nbsp;with&nbsp;an&nbsp;ident&nbsp;that</span><br>
<span class="lineno">15</span><span class="comment" id="5122569">//&nbsp;case-insensitively&nbsp;matches&nbsp;the&nbsp;lower-case&nbsp;kw.</span><br>
<span class="lineno"></span><span class="keyword" id="5122618">func</span>&nbsp;<span class="ident" id="5122623">endsWithCSSKeyword</span><span class="op" id="5122641">(</span><span class="ident" id="5122642">b</span>&nbsp;<span class="op" id="5122644">[</span><span class="op" id="5122645">]</span><span class="builtintype" id="5122646">byte</span><span class="op" id="5122650">,</span>&nbsp;<span class="ident" id="5122652">kw</span>&nbsp;<span class="builtintype" id="5122655">string</span><span class="op" id="5122661">)</span>&nbsp;<span class="builtintype" id="5122663">bool</span>&nbsp;<span class="op" id="5122668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5122671">i</span>&nbsp;<span class="op" id="5122673">:=</span>&nbsp;<span class="builtinfunc" id="5122676">len</span><span class="op" id="5122679">(</span><span class="ident" id="5122680">b</span><span class="op" id="5122681">)</span>&nbsp;<span class="op" id="5122683">-</span>&nbsp;<span class="builtinfunc" id="5122685">len</span><span class="op" id="5122688">(</span><span class="ident" id="5122689">kw</span><span class="op" id="5122691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5122694">if</span>&nbsp;<span class="ident" id="5122697">i</span>&nbsp;<span class="op" id="5122699">&lt;</span>&nbsp;<span class="num" id="5122701">0</span>&nbsp;<span class="op" id="5122703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5122707">//&nbsp;Too&nbsp;short.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5122723">return</span>&nbsp;<span class="builtintype" id="5122730">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5122737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5122740">if</span>&nbsp;<span class="ident" id="5122743">i</span>&nbsp;<span class="op" id="5122745">!=</span>&nbsp;<span class="num" id="5122748">0</span>&nbsp;<span class="op" id="5122750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5122754">r</span><span class="op" id="5122755">,</span>&nbsp;<span class="ident" id="5122757">_</span>&nbsp;<span class="op" id="5122759">:=</span>&nbsp;<span class="ident" id="5122762">utf8</span><span class="op" id="5122766">.</span><span class="ident" id="5122767">DecodeLastRune</span><span class="op" id="5122781">(</span><span class="ident" id="5122782">b</span><span class="op" id="5122783">[</span><span class="op" id="5122784">:</span><span class="ident" id="5122785">i</span><span class="op" id="5122786">]</span><span class="op" id="5122787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5122791">if</span>&nbsp;<span class="ident" id="5122794">isCSSNmchar</span><span class="op" id="5122805">(</span><span class="ident" id="5122806">r</span><span class="op" id="5122807">)</span>&nbsp;<span class="op" id="5122809">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5122814">//&nbsp;Too&nbsp;long.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5122830">return</span>&nbsp;<span class="builtintype" id="5122837">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5122845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5122848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5122851">//&nbsp;Many&nbsp;CSS&nbsp;keywords,&nbsp;such&nbsp;as&nbsp;&#34;!important&#34;&nbsp;can&nbsp;have&nbsp;characters&nbsp;encoded,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5122924">//&nbsp;but&nbsp;the&nbsp;URI&nbsp;production&nbsp;does&nbsp;not&nbsp;allow&nbsp;that&nbsp;according&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5122984">//&nbsp;http://www.w3.org/TR/css3-syntax/#TOK-URI</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5123030">//&nbsp;This&nbsp;does&nbsp;not&nbsp;attempt&nbsp;to&nbsp;recognize&nbsp;encoded&nbsp;keywords.&nbsp;For&nbsp;example,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5123100">//&nbsp;given&nbsp;&#34;\75\72\6c&#34;&nbsp;and&nbsp;&#34;url&#34;&nbsp;this&nbsp;return&nbsp;false.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5123151">return</span>&nbsp;<span class="builtintype" id="5123158">string</span><span class="op" id="5123164">(</span><span class="ident" id="5123165">bytes</span><span class="op" id="5123170">.</span><span class="ident" id="5123171">ToLower</span><span class="op" id="5123178">(</span><span class="ident" id="5123179">b</span><span class="op" id="5123180">[</span><span class="ident" id="5123181">i</span><span class="op" id="5123182">:</span><span class="op" id="5123183">]</span><span class="op" id="5123184">)</span><span class="op" id="5123185">)</span>&nbsp;<span class="op" id="5123187">==</span>&nbsp;<span class="ident" id="5123190">kw</span><br>
<span class="lineno">35</span><span class="op" id="5123193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5123196">//&nbsp;isCSSNmchar&nbsp;reports&nbsp;whether&nbsp;rune&nbsp;is&nbsp;allowed&nbsp;anywhere&nbsp;in&nbsp;a&nbsp;CSS&nbsp;identifier.</span><br>
<span class="lineno"></span><span class="keyword" id="5123273">func</span>&nbsp;<span class="ident" id="5123278">isCSSNmchar</span><span class="op" id="5123289">(</span><span class="ident" id="5123290">r</span>&nbsp;<span class="builtintype" id="5123292">rune</span><span class="op" id="5123296">)</span>&nbsp;<span class="builtintype" id="5123298">bool</span>&nbsp;<span class="op" id="5123303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5123306">//&nbsp;Based&nbsp;on&nbsp;the&nbsp;CSS3&nbsp;nmchar&nbsp;production&nbsp;but&nbsp;ignores&nbsp;multi-rune&nbsp;escape</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5123376">//&nbsp;sequences.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5123391">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-nmchar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5123443">return</span>&nbsp;<span class="string" id="5123450">&#39;a&#39;</span>&nbsp;<span class="op" id="5123454">&lt;=</span>&nbsp;<span class="ident" id="5123457">r</span>&nbsp;<span class="op" id="5123459">&amp;&amp;</span>&nbsp;<span class="ident" id="5123462">r</span>&nbsp;<span class="op" id="5123464">&lt;=</span>&nbsp;<span class="string" id="5123467">&#39;z&#39;</span>&nbsp;<span class="op" id="5123471">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5123476">&#39;A&#39;</span>&nbsp;<span class="op" id="5123480">&lt;=</span>&nbsp;<span class="ident" id="5123483">r</span>&nbsp;<span class="op" id="5123485">&amp;&amp;</span>&nbsp;<span class="ident" id="5123488">r</span>&nbsp;<span class="op" id="5123490">&lt;=</span>&nbsp;<span class="string" id="5123493">&#39;Z&#39;</span>&nbsp;<span class="op" id="5123497">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5123502">&#39;0&#39;</span>&nbsp;<span class="op" id="5123506">&lt;=</span>&nbsp;<span class="ident" id="5123509">r</span>&nbsp;<span class="op" id="5123511">&amp;&amp;</span>&nbsp;<span class="ident" id="5123514">r</span>&nbsp;<span class="op" id="5123516">&lt;=</span>&nbsp;<span class="string" id="5123519">&#39;9&#39;</span>&nbsp;<span class="op" id="5123523">||</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5123528">r</span>&nbsp;<span class="op" id="5123530">==</span>&nbsp;<span class="string" id="5123533">&#39;-&#39;</span>&nbsp;<span class="op" id="5123537">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5123542">r</span>&nbsp;<span class="op" id="5123544">==</span>&nbsp;<span class="string" id="5123547">&#39;_&#39;</span>&nbsp;<span class="op" id="5123551">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5123556">//&nbsp;Non-ASCII&nbsp;cases&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="5123584">0x80</span>&nbsp;<span class="op" id="5123589">&lt;=</span>&nbsp;<span class="ident" id="5123592">r</span>&nbsp;<span class="op" id="5123594">&amp;&amp;</span>&nbsp;<span class="ident" id="5123597">r</span>&nbsp;<span class="op" id="5123599">&lt;=</span>&nbsp;<span class="num" id="5123602">0xd7ff</span>&nbsp;<span class="op" id="5123609">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="5123614">0xe000</span>&nbsp;<span class="op" id="5123621">&lt;=</span>&nbsp;<span class="ident" id="5123624">r</span>&nbsp;<span class="op" id="5123626">&amp;&amp;</span>&nbsp;<span class="ident" id="5123629">r</span>&nbsp;<span class="op" id="5123631">&lt;=</span>&nbsp;<span class="num" id="5123634">0xfffd</span>&nbsp;<span class="op" id="5123641">||</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="5123646">0x10000</span>&nbsp;<span class="op" id="5123654">&lt;=</span>&nbsp;<span class="ident" id="5123657">r</span>&nbsp;<span class="op" id="5123659">&amp;&amp;</span>&nbsp;<span class="ident" id="5123662">r</span>&nbsp;<span class="op" id="5123664">&lt;=</span>&nbsp;<span class="num" id="5123667">0x10ffff</span><br>
<span class="lineno"></span><span class="op" id="5123676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5123679">//&nbsp;decodeCSS&nbsp;decodes&nbsp;CSS3&nbsp;escapes&nbsp;given&nbsp;a&nbsp;sequence&nbsp;of&nbsp;stringchars.</span><br>
<span class="lineno"></span><span class="comment" id="5123746">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;change,&nbsp;it&nbsp;returns&nbsp;the&nbsp;input,&nbsp;otherwise&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice</span><br>
<span class="lineno">55</span><span class="comment" id="5123823">//&nbsp;backed&nbsp;by&nbsp;a&nbsp;new&nbsp;array.</span><br>
<span class="lineno"></span><span class="comment" id="5123849">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-stringchar&nbsp;defines&nbsp;stringchar.</span><br>
<span class="lineno"></span><span class="keyword" id="5123924">func</span>&nbsp;<span class="ident" id="5123929">decodeCSS</span><span class="op" id="5123938">(</span><span class="ident" id="5123939">s</span>&nbsp;<span class="op" id="5123941">[</span><span class="op" id="5123942">]</span><span class="builtintype" id="5123943">byte</span><span class="op" id="5123947">)</span>&nbsp;<span class="op" id="5123949">[</span><span class="op" id="5123950">]</span><span class="builtintype" id="5123951">byte</span>&nbsp;<span class="op" id="5123956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5123959">i</span>&nbsp;<span class="op" id="5123961">:=</span>&nbsp;<span class="ident" id="5123964">bytes</span><span class="op" id="5123969">.</span><span class="ident" id="5123970">IndexByte</span><span class="op" id="5123979">(</span><span class="ident" id="5123980">s</span><span class="op" id="5123981">,</span>&nbsp;<span class="string" id="5123983">&#39;\\&#39;</span><span class="op" id="5123987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5123990">if</span>&nbsp;<span class="ident" id="5123993">i</span>&nbsp;<span class="op" id="5123995">==</span>&nbsp;<span class="op" id="5123998">-</span><span class="num" id="5123999">1</span>&nbsp;<span class="op" id="5124001">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5124005">return</span>&nbsp;<span class="ident" id="5124012">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5124015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5124018">//&nbsp;The&nbsp;UTF-8&nbsp;sequence&nbsp;for&nbsp;a&nbsp;codepoint&nbsp;is&nbsp;never&nbsp;longer&nbsp;than&nbsp;1&nbsp;+&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5124086">//&nbsp;number&nbsp;hex&nbsp;digits&nbsp;need&nbsp;to&nbsp;represent&nbsp;that&nbsp;codepoint,&nbsp;so&nbsp;len(s)&nbsp;is&nbsp;an</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5124158">//&nbsp;upper&nbsp;bound&nbsp;on&nbsp;the&nbsp;output&nbsp;length.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5124196">b</span>&nbsp;<span class="op" id="5124198">:=</span>&nbsp;<span class="builtinfunc" id="5124201">make</span><span class="op" id="5124205">(</span><span class="op" id="5124206">[</span><span class="op" id="5124207">]</span><span class="builtintype" id="5124208">byte</span><span class="op" id="5124212">,</span>&nbsp;<span class="num" id="5124214">0</span><span class="op" id="5124215">,</span>&nbsp;<span class="builtinfunc" id="5124217">len</span><span class="op" id="5124220">(</span><span class="ident" id="5124221">s</span><span class="op" id="5124222">)</span><span class="op" id="5124223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5124226">for</span>&nbsp;<span class="builtinfunc" id="5124230">len</span><span class="op" id="5124233">(</span><span class="ident" id="5124234">s</span><span class="op" id="5124235">)</span>&nbsp;<span class="op" id="5124237">!=</span>&nbsp;<span class="num" id="5124240">0</span>&nbsp;<span class="op" id="5124242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5124246">i</span>&nbsp;<span class="op" id="5124248">:=</span>&nbsp;<span class="ident" id="5124251">bytes</span><span class="op" id="5124256">.</span><span class="ident" id="5124257">IndexByte</span><span class="op" id="5124266">(</span><span class="ident" id="5124267">s</span><span class="op" id="5124268">,</span>&nbsp;<span class="string" id="5124270">&#39;\\&#39;</span><span class="op" id="5124274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5124278">if</span>&nbsp;<span class="ident" id="5124281">i</span>&nbsp;<span class="op" id="5124283">==</span>&nbsp;<span class="op" id="5124286">-</span><span class="num" id="5124287">1</span>&nbsp;<span class="op" id="5124289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5124294">i</span>&nbsp;<span class="op" id="5124296">=</span>&nbsp;<span class="builtinfunc" id="5124298">len</span><span class="op" id="5124301">(</span><span class="ident" id="5124302">s</span><span class="op" id="5124303">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5124307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5124311">b</span><span class="op" id="5124312">,</span>&nbsp;<span class="ident" id="5124314">s</span>&nbsp;<span class="op" id="5124316">=</span>&nbsp;<span class="builtinfunc" id="5124318">append</span><span class="op" id="5124324">(</span><span class="ident" id="5124325">b</span><span class="op" id="5124326">,</span>&nbsp;<span class="ident" id="5124328">s</span><span class="op" id="5124329">[</span><span class="op" id="5124330">:</span><span class="ident" id="5124331">i</span><span class="op" id="5124332">]</span><span class="op" id="5124333">...</span><span class="op" id="5124336">)</span><span class="op" id="5124337">,</span>&nbsp;<span class="ident" id="5124339">s</span><span class="op" id="5124340">[</span><span class="ident" id="5124341">i</span><span class="op" id="5124342">:</span><span class="op" id="5124343">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5124347">if</span>&nbsp;<span class="builtinfunc" id="5124350">len</span><span class="op" id="5124353">(</span><span class="ident" id="5124354">s</span><span class="op" id="5124355">)</span>&nbsp;<span class="op" id="5124357">&lt;</span>&nbsp;<span class="num" id="5124359">2</span>&nbsp;<span class="op" id="5124361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5124366">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5124374">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5124378">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-escape</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5124431">//&nbsp;escape&nbsp;::=&nbsp;unicode&nbsp;|&nbsp;&#39;\&#39;&nbsp;[#x20-#x7E#x80-#xD7FF#xE000-#xFFFD#x10000-#x10FFFF]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5124513">if</span>&nbsp;<span class="ident" id="5124516">isHex</span><span class="op" id="5124521">(</span><span class="ident" id="5124522">s</span><span class="op" id="5124523">[</span><span class="num" id="5124524">1</span><span class="op" id="5124525">]</span><span class="op" id="5124526">)</span>&nbsp;<span class="op" id="5124528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5124533">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-unicode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5124588">//&nbsp;&nbsp;&nbsp;unicode&nbsp;::=&nbsp;&#39;\&#39;&nbsp;[0-9a-fA-F]{1,6}&nbsp;wc?</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5124633">j</span>&nbsp;<span class="op" id="5124635">:=</span>&nbsp;<span class="num" id="5124638">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5124643">for</span>&nbsp;<span class="ident" id="5124647">j</span>&nbsp;<span class="op" id="5124649">&lt;</span>&nbsp;<span class="builtinfunc" id="5124651">len</span><span class="op" id="5124654">(</span><span class="ident" id="5124655">s</span><span class="op" id="5124656">)</span>&nbsp;<span class="op" id="5124658">&amp;&amp;</span>&nbsp;<span class="ident" id="5124661">j</span>&nbsp;<span class="op" id="5124663">&lt;</span>&nbsp;<span class="num" id="5124665">7</span>&nbsp;<span class="op" id="5124667">&amp;&amp;</span>&nbsp;<span class="ident" id="5124670">isHex</span><span class="op" id="5124675">(</span><span class="ident" id="5124676">s</span><span class="op" id="5124677">[</span><span class="ident" id="5124678">j</span><span class="op" id="5124679">]</span><span class="op" id="5124680">)</span>&nbsp;<span class="op" id="5124682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5124688">j</span><span class="op" id="5124689">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5124695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5124700">r</span>&nbsp;<span class="op" id="5124702">:=</span>&nbsp;<span class="ident" id="5124705">hexDecode</span><span class="op" id="5124714">(</span><span class="ident" id="5124715">s</span><span class="op" id="5124716">[</span><span class="num" id="5124717">1</span><span class="op" id="5124718">:</span><span class="ident" id="5124719">j</span><span class="op" id="5124720">]</span><span class="op" id="5124721">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5124726">if</span>&nbsp;<span class="ident" id="5124729">r</span>&nbsp;<span class="op" id="5124731">&gt;</span>&nbsp;<span class="ident" id="5124733">unicode</span><span class="op" id="5124740">.</span><span class="ident" id="5124741">MaxRune</span>&nbsp;<span class="op" id="5124749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5124755">r</span><span class="op" id="5124756">,</span>&nbsp;<span class="ident" id="5124758">j</span>&nbsp;<span class="op" id="5124760">=</span>&nbsp;<span class="ident" id="5124762">r</span><span class="op" id="5124763">/</span><span class="num" id="5124764">16</span><span class="op" id="5124766">,</span>&nbsp;<span class="ident" id="5124768">j</span><span class="op" id="5124769">-</span><span class="num" id="5124770">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5124775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5124780">n</span>&nbsp;<span class="op" id="5124782">:=</span>&nbsp;<span class="ident" id="5124785">utf8</span><span class="op" id="5124789">.</span><span class="ident" id="5124790">EncodeRune</span><span class="op" id="5124800">(</span><span class="ident" id="5124801">b</span><span class="op" id="5124802">[</span><span class="builtinfunc" id="5124803">len</span><span class="op" id="5124806">(</span><span class="ident" id="5124807">b</span><span class="op" id="5124808">)</span><span class="op" id="5124809">:</span><span class="builtinfunc" id="5124810">cap</span><span class="op" id="5124813">(</span><span class="ident" id="5124814">b</span><span class="op" id="5124815">)</span><span class="op" id="5124816">]</span><span class="op" id="5124817">,</span>&nbsp;<span class="ident" id="5124819">r</span><span class="op" id="5124820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5124825">//&nbsp;The&nbsp;optional&nbsp;space&nbsp;at&nbsp;the&nbsp;end&nbsp;allows&nbsp;a&nbsp;hex</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5124874">//&nbsp;sequence&nbsp;to&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;literal&nbsp;hex.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5124922">//&nbsp;string(decodeCSS([]byte(`\A&nbsp;B`)))&nbsp;==&nbsp;&#34;\nB&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5124971">b</span><span class="op" id="5124972">,</span>&nbsp;<span class="ident" id="5124974">s</span>&nbsp;<span class="op" id="5124976">=</span>&nbsp;<span class="ident" id="5124978">b</span><span class="op" id="5124979">[</span><span class="op" id="5124980">:</span><span class="builtinfunc" id="5124981">len</span><span class="op" id="5124984">(</span><span class="ident" id="5124985">b</span><span class="op" id="5124986">)</span><span class="op" id="5124987">+</span><span class="ident" id="5124988">n</span><span class="op" id="5124989">]</span><span class="op" id="5124990">,</span>&nbsp;<span class="ident" id="5124992">skipCSSSpace</span><span class="op" id="5125004">(</span><span class="ident" id="5125005">s</span><span class="op" id="5125006">[</span><span class="ident" id="5125007">j</span><span class="op" id="5125008">:</span><span class="op" id="5125009">]</span><span class="op" id="5125010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5125014">}</span>&nbsp;<span class="keyword" id="5125016">else</span>&nbsp;<span class="op" id="5125021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5125026">//&nbsp;`\\`&nbsp;decodes&nbsp;to&nbsp;`\`&nbsp;and&nbsp;`\&#34;`&nbsp;to&nbsp;`&#34;`.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5125069">_</span><span class="op" id="5125070">,</span>&nbsp;<span class="ident" id="5125072">n</span>&nbsp;<span class="op" id="5125074">:=</span>&nbsp;<span class="ident" id="5125077">utf8</span><span class="op" id="5125081">.</span><span class="ident" id="5125082">DecodeRune</span><span class="op" id="5125092">(</span><span class="ident" id="5125093">s</span><span class="op" id="5125094">[</span><span class="num" id="5125095">1</span><span class="op" id="5125096">:</span><span class="op" id="5125097">]</span><span class="op" id="5125098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5125103">b</span><span class="op" id="5125104">,</span>&nbsp;<span class="ident" id="5125106">s</span>&nbsp;<span class="op" id="5125108">=</span>&nbsp;<span class="builtinfunc" id="5125110">append</span><span class="op" id="5125116">(</span><span class="ident" id="5125117">b</span><span class="op" id="5125118">,</span>&nbsp;<span class="ident" id="5125120">s</span><span class="op" id="5125121">[</span><span class="num" id="5125122">1</span><span class="op" id="5125123">:</span><span class="num" id="5125124">1</span><span class="op" id="5125125">+</span><span class="ident" id="5125126">n</span><span class="op" id="5125127">]</span><span class="op" id="5125128">...</span><span class="op" id="5125131">)</span><span class="op" id="5125132">,</span>&nbsp;<span class="ident" id="5125134">s</span><span class="op" id="5125135">[</span><span class="num" id="5125136">1</span><span class="op" id="5125137">+</span><span class="ident" id="5125138">n</span><span class="op" id="5125139">:</span><span class="op" id="5125140">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5125144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5125147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5125150">return</span>&nbsp;<span class="ident" id="5125157">b</span><br>
<span class="lineno">100</span><span class="op" id="5125159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5125162">//&nbsp;isHex&nbsp;reports&nbsp;whether&nbsp;the&nbsp;given&nbsp;character&nbsp;is&nbsp;a&nbsp;hex&nbsp;digit.</span><br>
<span class="lineno"></span><span class="keyword" id="5125223">func</span>&nbsp;<span class="ident" id="5125228">isHex</span><span class="op" id="5125233">(</span><span class="ident" id="5125234">c</span>&nbsp;<span class="builtintype" id="5125236">byte</span><span class="op" id="5125240">)</span>&nbsp;<span class="builtintype" id="5125242">bool</span>&nbsp;<span class="op" id="5125247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5125250">return</span>&nbsp;<span class="string" id="5125257">&#39;0&#39;</span>&nbsp;<span class="op" id="5125261">&lt;=</span>&nbsp;<span class="ident" id="5125264">c</span>&nbsp;<span class="op" id="5125266">&amp;&amp;</span>&nbsp;<span class="ident" id="5125269">c</span>&nbsp;<span class="op" id="5125271">&lt;=</span>&nbsp;<span class="string" id="5125274">&#39;9&#39;</span>&nbsp;<span class="op" id="5125278">||</span>&nbsp;<span class="string" id="5125281">&#39;a&#39;</span>&nbsp;<span class="op" id="5125285">&lt;=</span>&nbsp;<span class="ident" id="5125288">c</span>&nbsp;<span class="op" id="5125290">&amp;&amp;</span>&nbsp;<span class="ident" id="5125293">c</span>&nbsp;<span class="op" id="5125295">&lt;=</span>&nbsp;<span class="string" id="5125298">&#39;f&#39;</span>&nbsp;<span class="op" id="5125302">||</span>&nbsp;<span class="string" id="5125305">&#39;A&#39;</span>&nbsp;<span class="op" id="5125309">&lt;=</span>&nbsp;<span class="ident" id="5125312">c</span>&nbsp;<span class="op" id="5125314">&amp;&amp;</span>&nbsp;<span class="ident" id="5125317">c</span>&nbsp;<span class="op" id="5125319">&lt;=</span>&nbsp;<span class="string" id="5125322">&#39;F&#39;</span><br>
<span class="lineno">105</span><span class="op" id="5125326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5125329">//&nbsp;hexDecode&nbsp;decodes&nbsp;a&nbsp;short&nbsp;hex&nbsp;digit&nbsp;sequence:&nbsp;&#34;10&#34;&nbsp;-&gt;&nbsp;16.</span><br>
<span class="lineno"></span><span class="keyword" id="5125390">func</span>&nbsp;<span class="ident" id="5125395">hexDecode</span><span class="op" id="5125404">(</span><span class="ident" id="5125405">s</span>&nbsp;<span class="op" id="5125407">[</span><span class="op" id="5125408">]</span><span class="builtintype" id="5125409">byte</span><span class="op" id="5125413">)</span>&nbsp;<span class="builtintype" id="5125415">rune</span>&nbsp;<span class="op" id="5125420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5125423">n</span>&nbsp;<span class="op" id="5125425">:=</span>&nbsp;<span class="string" id="5125428">&#39;\x00&#39;</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5125436">for</span>&nbsp;<span class="ident" id="5125440">_</span><span class="op" id="5125441">,</span>&nbsp;<span class="ident" id="5125443">c</span>&nbsp;<span class="op" id="5125445">:=</span>&nbsp;<span class="keyword" id="5125448">range</span>&nbsp;<span class="ident" id="5125454">s</span>&nbsp;<span class="op" id="5125456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5125460">n</span>&nbsp;<span class="op" id="5125462">&lt;&lt;=</span>&nbsp;<span class="num" id="5125466">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5125470">switch</span>&nbsp;<span class="op" id="5125477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5125481">case</span>&nbsp;<span class="string" id="5125486">&#39;0&#39;</span>&nbsp;<span class="op" id="5125490">&lt;=</span>&nbsp;<span class="ident" id="5125493">c</span>&nbsp;<span class="op" id="5125495">&amp;&amp;</span>&nbsp;<span class="ident" id="5125498">c</span>&nbsp;<span class="op" id="5125500">&lt;=</span>&nbsp;<span class="string" id="5125503">&#39;9&#39;</span><span class="op" id="5125506">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5125511">n</span>&nbsp;<span class="op" id="5125513">|=</span>&nbsp;<span class="builtintype" id="5125516">rune</span><span class="op" id="5125520">(</span><span class="ident" id="5125521">c</span>&nbsp;<span class="op" id="5125523">-</span>&nbsp;<span class="string" id="5125525">&#39;0&#39;</span><span class="op" id="5125528">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5125532">case</span>&nbsp;<span class="string" id="5125537">&#39;a&#39;</span>&nbsp;<span class="op" id="5125541">&lt;=</span>&nbsp;<span class="ident" id="5125544">c</span>&nbsp;<span class="op" id="5125546">&amp;&amp;</span>&nbsp;<span class="ident" id="5125549">c</span>&nbsp;<span class="op" id="5125551">&lt;=</span>&nbsp;<span class="string" id="5125554">&#39;f&#39;</span><span class="op" id="5125557">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5125562">n</span>&nbsp;<span class="op" id="5125564">|=</span>&nbsp;<span class="builtintype" id="5125567">rune</span><span class="op" id="5125571">(</span><span class="ident" id="5125572">c</span><span class="op" id="5125573">-</span><span class="string" id="5125574">&#39;a&#39;</span><span class="op" id="5125577">)</span>&nbsp;<span class="op" id="5125579">+</span>&nbsp;<span class="num" id="5125581">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5125586">case</span>&nbsp;<span class="string" id="5125591">&#39;A&#39;</span>&nbsp;<span class="op" id="5125595">&lt;=</span>&nbsp;<span class="ident" id="5125598">c</span>&nbsp;<span class="op" id="5125600">&amp;&amp;</span>&nbsp;<span class="ident" id="5125603">c</span>&nbsp;<span class="op" id="5125605">&lt;=</span>&nbsp;<span class="string" id="5125608">&#39;F&#39;</span><span class="op" id="5125611">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5125616">n</span>&nbsp;<span class="op" id="5125618">|=</span>&nbsp;<span class="builtintype" id="5125621">rune</span><span class="op" id="5125625">(</span><span class="ident" id="5125626">c</span><span class="op" id="5125627">-</span><span class="string" id="5125628">&#39;A&#39;</span><span class="op" id="5125631">)</span>&nbsp;<span class="op" id="5125633">+</span>&nbsp;<span class="num" id="5125635">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5125640">default</span><span class="op" id="5125647">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5125652">panic</span><span class="op" id="5125657">(</span><span class="ident" id="5125658">fmt</span><span class="op" id="5125661">.</span><span class="ident" id="5125662">Sprintf</span><span class="op" id="5125669">(</span><span class="string" id="5125670">&#34;Bad&nbsp;hex&nbsp;digit&nbsp;in&nbsp;%q&#34;</span><span class="op" id="5125691">,</span>&nbsp;<span class="ident" id="5125693">s</span><span class="op" id="5125694">)</span><span class="op" id="5125695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5125699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5125702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5125705">return</span>&nbsp;<span class="ident" id="5125712">n</span><br>
<span class="lineno"></span><span class="op" id="5125714">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="5125717">//&nbsp;skipCSSSpace&nbsp;returns&nbsp;a&nbsp;suffix&nbsp;of&nbsp;c,&nbsp;skipping&nbsp;over&nbsp;a&nbsp;single&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="5125786">func</span>&nbsp;<span class="ident" id="5125791">skipCSSSpace</span><span class="op" id="5125803">(</span><span class="ident" id="5125804">c</span>&nbsp;<span class="op" id="5125806">[</span><span class="op" id="5125807">]</span><span class="builtintype" id="5125808">byte</span><span class="op" id="5125812">)</span>&nbsp;<span class="op" id="5125814">[</span><span class="op" id="5125815">]</span><span class="builtintype" id="5125816">byte</span>&nbsp;<span class="op" id="5125821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5125824">if</span>&nbsp;<span class="builtinfunc" id="5125827">len</span><span class="op" id="5125830">(</span><span class="ident" id="5125831">c</span><span class="op" id="5125832">)</span>&nbsp;<span class="op" id="5125834">==</span>&nbsp;<span class="num" id="5125837">0</span>&nbsp;<span class="op" id="5125839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5125843">return</span>&nbsp;<span class="ident" id="5125850">c</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5125853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5125856">//&nbsp;wc&nbsp;::=&nbsp;#x9&nbsp;|&nbsp;#xA&nbsp;|&nbsp;#xC&nbsp;|&nbsp;#xD&nbsp;|&nbsp;#x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5125896">switch</span>&nbsp;<span class="ident" id="5125903">c</span><span class="op" id="5125904">[</span><span class="num" id="5125905">0</span><span class="op" id="5125906">]</span>&nbsp;<span class="op" id="5125908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5125911">case</span>&nbsp;<span class="string" id="5125916">&#39;\t&#39;</span><span class="op" id="5125920">,</span>&nbsp;<span class="string" id="5125922">&#39;\n&#39;</span><span class="op" id="5125926">,</span>&nbsp;<span class="string" id="5125928">&#39;\f&#39;</span><span class="op" id="5125932">,</span>&nbsp;<span class="string" id="5125934">&#39;&nbsp;&#39;</span><span class="op" id="5125937">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5125941">return</span>&nbsp;<span class="ident" id="5125948">c</span><span class="op" id="5125949">[</span><span class="num" id="5125950">1</span><span class="op" id="5125951">:</span><span class="op" id="5125952">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5125955">case</span>&nbsp;<span class="string" id="5125960">&#39;\r&#39;</span><span class="op" id="5125964">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5125968">//&nbsp;This&nbsp;differs&nbsp;from&nbsp;CSS3&#39;s&nbsp;wc&nbsp;production&nbsp;because&nbsp;it&nbsp;contains&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5126034">//&nbsp;probable&nbsp;spec&nbsp;error&nbsp;whereby&nbsp;wc&nbsp;contains&nbsp;all&nbsp;the&nbsp;single&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5126099">//&nbsp;sequences&nbsp;in&nbsp;nl&nbsp;(newline)&nbsp;but&nbsp;not&nbsp;CRLF.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126144">if</span>&nbsp;<span class="builtinfunc" id="5126147">len</span><span class="op" id="5126150">(</span><span class="ident" id="5126151">c</span><span class="op" id="5126152">)</span>&nbsp;<span class="op" id="5126154">&gt;=</span>&nbsp;<span class="num" id="5126157">2</span>&nbsp;<span class="op" id="5126159">&amp;&amp;</span>&nbsp;<span class="ident" id="5126162">c</span><span class="op" id="5126163">[</span><span class="num" id="5126164">1</span><span class="op" id="5126165">]</span>&nbsp;<span class="op" id="5126167">==</span>&nbsp;<span class="string" id="5126170">&#39;\n&#39;</span>&nbsp;<span class="op" id="5126175">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126180">return</span>&nbsp;<span class="ident" id="5126187">c</span><span class="op" id="5126188">[</span><span class="num" id="5126189">2</span><span class="op" id="5126190">:</span><span class="op" id="5126191">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5126195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126199">return</span>&nbsp;<span class="ident" id="5126206">c</span><span class="op" id="5126207">[</span><span class="num" id="5126208">1</span><span class="op" id="5126209">:</span><span class="op" id="5126210">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5126213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126216">return</span>&nbsp;<span class="ident" id="5126223">c</span><br>
<span class="lineno">145</span><span class="op" id="5126225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5126228">//&nbsp;isCSSSpace&nbsp;reports&nbsp;whether&nbsp;b&nbsp;is&nbsp;a&nbsp;CSS&nbsp;space&nbsp;char&nbsp;as&nbsp;defined&nbsp;in&nbsp;wc.</span><br>
<span class="lineno"></span><span class="keyword" id="5126298">func</span>&nbsp;<span class="ident" id="5126303">isCSSSpace</span><span class="op" id="5126313">(</span><span class="ident" id="5126314">b</span>&nbsp;<span class="builtintype" id="5126316">byte</span><span class="op" id="5126320">)</span>&nbsp;<span class="builtintype" id="5126322">bool</span>&nbsp;<span class="op" id="5126327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126330">switch</span>&nbsp;<span class="ident" id="5126337">b</span>&nbsp;<span class="op" id="5126339">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126342">case</span>&nbsp;<span class="string" id="5126347">&#39;\t&#39;</span><span class="op" id="5126351">,</span>&nbsp;<span class="string" id="5126353">&#39;\n&#39;</span><span class="op" id="5126357">,</span>&nbsp;<span class="string" id="5126359">&#39;\f&#39;</span><span class="op" id="5126363">,</span>&nbsp;<span class="string" id="5126365">&#39;\r&#39;</span><span class="op" id="5126369">,</span>&nbsp;<span class="string" id="5126371">&#39;&nbsp;&#39;</span><span class="op" id="5126374">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126378">return</span>&nbsp;<span class="builtintype" id="5126385">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5126391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126394">return</span>&nbsp;<span class="builtintype" id="5126401">false</span><br>
<span class="lineno"></span><span class="op" id="5126407">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="5126410">//&nbsp;cssEscaper&nbsp;escapes&nbsp;HTML&nbsp;and&nbsp;CSS&nbsp;special&nbsp;characters&nbsp;using&nbsp;\&lt;hex&gt;+&nbsp;escapes.</span><br>
<span class="lineno"></span><span class="keyword" id="5126487">func</span>&nbsp;<span class="ident" id="5126492">cssEscaper</span><span class="op" id="5126502">(</span><span class="ident" id="5126503">args</span>&nbsp;<span class="op" id="5126508">...</span><span class="keyword" id="5126511">interface</span><span class="op" id="5126520">{</span><span class="op" id="5126521">}</span><span class="op" id="5126522">)</span>&nbsp;<span class="builtintype" id="5126524">string</span>&nbsp;<span class="op" id="5126531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126534">s</span><span class="op" id="5126535">,</span>&nbsp;<span class="ident" id="5126537">_</span>&nbsp;<span class="op" id="5126539">:=</span>&nbsp;<span class="ident" id="5126542">stringify</span><span class="op" id="5126551">(</span><span class="ident" id="5126552">args</span><span class="op" id="5126556">...</span><span class="op" id="5126559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126562">var</span>&nbsp;<span class="ident" id="5126566">b</span>&nbsp;<span class="ident" id="5126568">bytes</span><span class="op" id="5126573">.</span><span class="ident" id="5126574">Buffer</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126582">written</span>&nbsp;<span class="op" id="5126590">:=</span>&nbsp;<span class="num" id="5126593">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126596">for</span>&nbsp;<span class="ident" id="5126600">i</span><span class="op" id="5126601">,</span>&nbsp;<span class="ident" id="5126603">r</span>&nbsp;<span class="op" id="5126605">:=</span>&nbsp;<span class="keyword" id="5126608">range</span>&nbsp;<span class="ident" id="5126614">s</span>&nbsp;<span class="op" id="5126616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126620">var</span>&nbsp;<span class="ident" id="5126624">repl</span>&nbsp;<span class="builtintype" id="5126629">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126638">switch</span>&nbsp;<span class="ident" id="5126645">r</span>&nbsp;<span class="op" id="5126647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126651">case</span>&nbsp;<span class="num" id="5126656">0</span><span class="op" id="5126657">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126662">repl</span>&nbsp;<span class="op" id="5126667">=</span>&nbsp;<span class="string" id="5126669">`\0`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126676">case</span>&nbsp;<span class="string" id="5126681">&#39;\t&#39;</span><span class="op" id="5126685">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126690">repl</span>&nbsp;<span class="op" id="5126695">=</span>&nbsp;<span class="string" id="5126697">`\9`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126704">case</span>&nbsp;<span class="string" id="5126709">&#39;\n&#39;</span><span class="op" id="5126713">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126718">repl</span>&nbsp;<span class="op" id="5126723">=</span>&nbsp;<span class="string" id="5126725">`\a`</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126732">case</span>&nbsp;<span class="string" id="5126737">&#39;\f&#39;</span><span class="op" id="5126741">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126746">repl</span>&nbsp;<span class="op" id="5126751">=</span>&nbsp;<span class="string" id="5126753">`\c`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126760">case</span>&nbsp;<span class="string" id="5126765">&#39;\r&#39;</span><span class="op" id="5126769">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126774">repl</span>&nbsp;<span class="op" id="5126779">=</span>&nbsp;<span class="string" id="5126781">`\d`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5126788">//&nbsp;Encode&nbsp;HTML&nbsp;specials&nbsp;as&nbsp;hex&nbsp;so&nbsp;the&nbsp;output&nbsp;can&nbsp;be&nbsp;embedded</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5126851">//&nbsp;in&nbsp;HTML&nbsp;attributes&nbsp;without&nbsp;further&nbsp;encoding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126901">case</span>&nbsp;<span class="string" id="5126906">&#39;&#34;&#39;</span><span class="op" id="5126909">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126914">repl</span>&nbsp;<span class="op" id="5126919">=</span>&nbsp;<span class="string" id="5126921">`\22`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126929">case</span>&nbsp;<span class="string" id="5126934">&#39;&amp;&#39;</span><span class="op" id="5126937">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126942">repl</span>&nbsp;<span class="op" id="5126947">=</span>&nbsp;<span class="string" id="5126949">`\26`</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126957">case</span>&nbsp;<span class="string" id="5126962">&#39;\&#39;&#39;</span><span class="op" id="5126966">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126971">repl</span>&nbsp;<span class="op" id="5126976">=</span>&nbsp;<span class="string" id="5126978">`\27`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126986">case</span>&nbsp;<span class="string" id="5126991">&#39;(&#39;</span><span class="op" id="5126994">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126999">repl</span>&nbsp;<span class="op" id="5127004">=</span>&nbsp;<span class="string" id="5127006">`\28`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5127014">case</span>&nbsp;<span class="string" id="5127019">&#39;)&#39;</span><span class="op" id="5127022">:</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127027">repl</span>&nbsp;<span class="op" id="5127032">=</span>&nbsp;<span class="string" id="5127034">`\29`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5127042">case</span>&nbsp;<span class="string" id="5127047">&#39;+&#39;</span><span class="op" id="5127050">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127055">repl</span>&nbsp;<span class="op" id="5127060">=</span>&nbsp;<span class="string" id="5127062">`\2b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5127070">case</span>&nbsp;<span class="string" id="5127075">&#39;/&#39;</span><span class="op" id="5127078">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127083">repl</span>&nbsp;<span class="op" id="5127088">=</span>&nbsp;<span class="string" id="5127090">`\2f`</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5127098">case</span>&nbsp;<span class="string" id="5127103">&#39;:&#39;</span><span class="op" id="5127106">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127111">repl</span>&nbsp;<span class="op" id="5127116">=</span>&nbsp;<span class="string" id="5127118">`\3a`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5127126">case</span>&nbsp;<span class="string" id="5127131">&#39;;&#39;</span><span class="op" id="5127134">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127139">repl</span>&nbsp;<span class="op" id="5127144">=</span>&nbsp;<span class="string" id="5127146">`\3b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5127154">case</span>&nbsp;<span class="string" id="5127159">&#39;&lt;&#39;</span><span class="op" id="5127162">:</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127167">repl</span>&nbsp;<span class="op" id="5127172">=</span>&nbsp;<span class="string" id="5127174">`\3c`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5127182">case</span>&nbsp;<span class="string" id="5127187">&#39;&gt;&#39;</span><span class="op" id="5127190">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127195">repl</span>&nbsp;<span class="op" id="5127200">=</span>&nbsp;<span class="string" id="5127202">`\3e`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5127210">case</span>&nbsp;<span class="string" id="5127215">&#39;\\&#39;</span><span class="op" id="5127219">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127224">repl</span>&nbsp;<span class="op" id="5127229">=</span>&nbsp;<span class="string" id="5127231">`\\`</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5127238">case</span>&nbsp;<span class="string" id="5127243">&#39;{&#39;</span><span class="op" id="5127246">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127251">repl</span>&nbsp;<span class="op" id="5127256">=</span>&nbsp;<span class="string" id="5127258">`\7b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5127266">case</span>&nbsp;<span class="string" id="5127271">&#39;}&#39;</span><span class="op" id="5127274">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127279">repl</span>&nbsp;<span class="op" id="5127284">=</span>&nbsp;<span class="string" id="5127286">`\7d`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5127294">default</span><span class="op" id="5127301">:</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5127306">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5127317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127321">b</span><span class="op" id="5127322">.</span><span class="ident" id="5127323">WriteString</span><span class="op" id="5127334">(</span><span class="ident" id="5127335">s</span><span class="op" id="5127336">[</span><span class="ident" id="5127337">written</span><span class="op" id="5127344">:</span><span class="ident" id="5127345">i</span><span class="op" id="5127346">]</span><span class="op" id="5127347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127351">b</span><span class="op" id="5127352">.</span><span class="ident" id="5127353">WriteString</span><span class="op" id="5127364">(</span><span class="ident" id="5127365">repl</span><span class="op" id="5127369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127373">written</span>&nbsp;<span class="op" id="5127381">=</span>&nbsp;<span class="ident" id="5127383">i</span>&nbsp;<span class="op" id="5127385">+</span>&nbsp;<span class="ident" id="5127387">utf8</span><span class="op" id="5127391">.</span><span class="ident" id="5127392">RuneLen</span><span class="op" id="5127399">(</span><span class="ident" id="5127400">r</span><span class="op" id="5127401">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5127405">if</span>&nbsp;<span class="ident" id="5127408">repl</span>&nbsp;<span class="op" id="5127413">!=</span>&nbsp;<span class="string" id="5127416">`\\`</span>&nbsp;<span class="op" id="5127421">&amp;&amp;</span>&nbsp;<span class="op" id="5127424">(</span><span class="ident" id="5127425">written</span>&nbsp;<span class="op" id="5127433">==</span>&nbsp;<span class="builtinfunc" id="5127436">len</span><span class="op" id="5127439">(</span><span class="ident" id="5127440">s</span><span class="op" id="5127441">)</span>&nbsp;<span class="op" id="5127443">||</span>&nbsp;<span class="ident" id="5127446">isHex</span><span class="op" id="5127451">(</span><span class="ident" id="5127452">s</span><span class="op" id="5127453">[</span><span class="ident" id="5127454">written</span><span class="op" id="5127461">]</span><span class="op" id="5127462">)</span>&nbsp;<span class="op" id="5127464">||</span>&nbsp;<span class="ident" id="5127467">isCSSSpace</span><span class="op" id="5127477">(</span><span class="ident" id="5127478">s</span><span class="op" id="5127479">[</span><span class="ident" id="5127480">written</span><span class="op" id="5127487">]</span><span class="op" id="5127488">)</span><span class="op" id="5127489">)</span>&nbsp;<span class="op" id="5127491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127496">b</span><span class="op" id="5127497">.</span><span class="ident" id="5127498">WriteByte</span><span class="op" id="5127507">(</span><span class="string" id="5127508">&#39;&nbsp;&#39;</span><span class="op" id="5127511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5127515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5127518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5127521">if</span>&nbsp;<span class="ident" id="5127524">written</span>&nbsp;<span class="op" id="5127532">==</span>&nbsp;<span class="num" id="5127535">0</span>&nbsp;<span class="op" id="5127537">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5127541">return</span>&nbsp;<span class="ident" id="5127548">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5127551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127554">b</span><span class="op" id="5127555">.</span><span class="ident" id="5127556">WriteString</span><span class="op" id="5127567">(</span><span class="ident" id="5127568">s</span><span class="op" id="5127569">[</span><span class="ident" id="5127570">written</span><span class="op" id="5127577">:</span><span class="op" id="5127578">]</span><span class="op" id="5127579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5127582">return</span>&nbsp;<span class="ident" id="5127589">b</span><span class="op" id="5127590">.</span><span class="ident" id="5127591">String</span><span class="op" id="5127597">(</span><span class="op" id="5127598">)</span><br>
<span class="lineno"></span><span class="op" id="5127600">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="5127603">var</span>&nbsp;<span class="ident" id="5127607">expressionBytes</span>&nbsp;<span class="op" id="5127623">=</span>&nbsp;<span class="op" id="5127625">[</span><span class="op" id="5127626">]</span><span class="builtintype" id="5127627">byte</span><span class="op" id="5127631">(</span><span class="string" id="5127632">&#34;expression&#34;</span><span class="op" id="5127644">)</span><br>
<span class="lineno"></span><span class="keyword" id="5127646">var</span>&nbsp;<span class="ident" id="5127650">mozBindingBytes</span>&nbsp;<span class="op" id="5127666">=</span>&nbsp;<span class="op" id="5127668">[</span><span class="op" id="5127669">]</span><span class="builtintype" id="5127670">byte</span><span class="op" id="5127674">(</span><span class="string" id="5127675">&#34;mozbinding&#34;</span><span class="op" id="5127687">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5127690">//&nbsp;cssValueFilter&nbsp;allows&nbsp;innocuous&nbsp;CSS&nbsp;values&nbsp;in&nbsp;the&nbsp;output&nbsp;including&nbsp;CSS</span><br>
<span class="lineno">225</span><span class="comment" id="5127764">//&nbsp;quantities&nbsp;(10px&nbsp;or&nbsp;25%),&nbsp;ID&nbsp;or&nbsp;class&nbsp;literals&nbsp;(#foo,&nbsp;.bar),&nbsp;keyword&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="5127843">//&nbsp;(inherit,&nbsp;blue),&nbsp;and&nbsp;colors&nbsp;(#888).</span><br>
<span class="lineno"></span><span class="comment" id="5127882">//&nbsp;It&nbsp;filters&nbsp;out&nbsp;unsafe&nbsp;values,&nbsp;such&nbsp;as&nbsp;those&nbsp;that&nbsp;affect&nbsp;token&nbsp;boundaries,</span><br>
<span class="lineno"></span><span class="comment" id="5127959">//&nbsp;and&nbsp;anything&nbsp;that&nbsp;might&nbsp;execute&nbsp;scripts.</span><br>
<span class="lineno"></span><span class="keyword" id="5128003">func</span>&nbsp;<span class="ident" id="5128008">cssValueFilter</span><span class="op" id="5128022">(</span><span class="ident" id="5128023">args</span>&nbsp;<span class="op" id="5128028">...</span><span class="keyword" id="5128031">interface</span><span class="op" id="5128040">{</span><span class="op" id="5128041">}</span><span class="op" id="5128042">)</span>&nbsp;<span class="builtintype" id="5128044">string</span>&nbsp;<span class="op" id="5128051">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128054">s</span><span class="op" id="5128055">,</span>&nbsp;<span class="ident" id="5128057">t</span>&nbsp;<span class="op" id="5128059">:=</span>&nbsp;<span class="ident" id="5128062">stringify</span><span class="op" id="5128071">(</span><span class="ident" id="5128072">args</span><span class="op" id="5128076">...</span><span class="op" id="5128079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5128082">if</span>&nbsp;<span class="ident" id="5128085">t</span>&nbsp;<span class="op" id="5128087">==</span>&nbsp;<span class="ident" id="5128090">contentTypeCSS</span>&nbsp;<span class="op" id="5128105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5128109">return</span>&nbsp;<span class="ident" id="5128116">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5128119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128122">b</span><span class="op" id="5128123">,</span>&nbsp;<span class="ident" id="5128125">id</span>&nbsp;<span class="op" id="5128128">:=</span>&nbsp;<span class="ident" id="5128131">decodeCSS</span><span class="op" id="5128140">(</span><span class="op" id="5128141">[</span><span class="op" id="5128142">]</span><span class="builtintype" id="5128143">byte</span><span class="op" id="5128147">(</span><span class="ident" id="5128148">s</span><span class="op" id="5128149">)</span><span class="op" id="5128150">)</span><span class="op" id="5128151">,</span>&nbsp;<span class="builtinfunc" id="5128153">make</span><span class="op" id="5128157">(</span><span class="op" id="5128158">[</span><span class="op" id="5128159">]</span><span class="builtintype" id="5128160">byte</span><span class="op" id="5128164">,</span>&nbsp;<span class="num" id="5128166">0</span><span class="op" id="5128167">,</span>&nbsp;<span class="num" id="5128169">64</span><span class="op" id="5128171">)</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5128175">//&nbsp;CSS3&nbsp;error&nbsp;handling&nbsp;is&nbsp;specified&nbsp;as&nbsp;honoring&nbsp;string&nbsp;boundaries&nbsp;per</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5128246">//&nbsp;http://www.w3.org/TR/css3-syntax/#error-handling&nbsp;:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5128301">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Malformed&nbsp;declarations.&nbsp;User&nbsp;agents&nbsp;must&nbsp;handle&nbsp;unexpected</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5128368">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tokens&nbsp;encountered&nbsp;while&nbsp;parsing&nbsp;a&nbsp;declaration&nbsp;by&nbsp;reading&nbsp;until</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5128440">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;declaration,&nbsp;while&nbsp;observing&nbsp;the&nbsp;rules&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5128506">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matching&nbsp;pairs&nbsp;of&nbsp;(),&nbsp;[],&nbsp;{},&nbsp;&#34;&#34;,&nbsp;and&nbsp;&#39;&#39;,&nbsp;and&nbsp;correctly&nbsp;handling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5128579">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;escapes.&nbsp;For&nbsp;example,&nbsp;a&nbsp;malformed&nbsp;declaration&nbsp;may&nbsp;be&nbsp;missing&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5128650">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;property,&nbsp;colon&nbsp;(:)&nbsp;or&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5128688">//&nbsp;So&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;that&nbsp;values&nbsp;do&nbsp;not&nbsp;have&nbsp;mismatched&nbsp;bracket</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5128759">//&nbsp;or&nbsp;quote&nbsp;characters&nbsp;to&nbsp;prevent&nbsp;the&nbsp;browser&nbsp;from&nbsp;restarting&nbsp;parsing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5128830">//&nbsp;inside&nbsp;a&nbsp;string&nbsp;that&nbsp;might&nbsp;embed&nbsp;JavaScript&nbsp;source.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5128886">for</span>&nbsp;<span class="ident" id="5128890">i</span><span class="op" id="5128891">,</span>&nbsp;<span class="ident" id="5128893">c</span>&nbsp;<span class="op" id="5128895">:=</span>&nbsp;<span class="keyword" id="5128898">range</span>&nbsp;<span class="ident" id="5128904">b</span>&nbsp;<span class="op" id="5128906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5128910">switch</span>&nbsp;<span class="ident" id="5128917">c</span>&nbsp;<span class="op" id="5128919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5128923">case</span>&nbsp;<span class="num" id="5128928">0</span><span class="op" id="5128929">,</span>&nbsp;<span class="string" id="5128931">&#39;&#34;&#39;</span><span class="op" id="5128934">,</span>&nbsp;<span class="string" id="5128936">&#39;\&#39;&#39;</span><span class="op" id="5128940">,</span>&nbsp;<span class="string" id="5128942">&#39;(&#39;</span><span class="op" id="5128945">,</span>&nbsp;<span class="string" id="5128947">&#39;)&#39;</span><span class="op" id="5128950">,</span>&nbsp;<span class="string" id="5128952">&#39;/&#39;</span><span class="op" id="5128955">,</span>&nbsp;<span class="string" id="5128957">&#39;;&#39;</span><span class="op" id="5128960">,</span>&nbsp;<span class="string" id="5128962">&#39;@&#39;</span><span class="op" id="5128965">,</span>&nbsp;<span class="string" id="5128967">&#39;[&#39;</span><span class="op" id="5128970">,</span>&nbsp;<span class="string" id="5128972">&#39;\\&#39;</span><span class="op" id="5128976">,</span>&nbsp;<span class="string" id="5128978">&#39;]&#39;</span><span class="op" id="5128981">,</span>&nbsp;<span class="string" id="5128983">&#39;`&#39;</span><span class="op" id="5128986">,</span>&nbsp;<span class="string" id="5128988">&#39;{&#39;</span><span class="op" id="5128991">,</span>&nbsp;<span class="string" id="5128993">&#39;}&#39;</span><span class="op" id="5128996">:</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129001">return</span>&nbsp;<span class="ident" id="5129008">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129025">case</span>&nbsp;<span class="string" id="5129030">&#39;-&#39;</span><span class="op" id="5129033">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5129038">//&nbsp;Disallow&nbsp;&lt;!--&nbsp;or&nbsp;--&gt;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5129066">//&nbsp;--&nbsp;should&nbsp;not&nbsp;appear&nbsp;in&nbsp;valid&nbsp;identifiers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129115">if</span>&nbsp;<span class="ident" id="5129118">i</span>&nbsp;<span class="op" id="5129120">!=</span>&nbsp;<span class="num" id="5129123">0</span>&nbsp;<span class="op" id="5129125">&amp;&amp;</span>&nbsp;<span class="ident" id="5129128">b</span><span class="op" id="5129129">[</span><span class="ident" id="5129130">i</span><span class="op" id="5129131">-</span><span class="num" id="5129132">1</span><span class="op" id="5129133">]</span>&nbsp;<span class="op" id="5129135">==</span>&nbsp;<span class="string" id="5129138">&#39;-&#39;</span>&nbsp;<span class="op" id="5129142">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129148">return</span>&nbsp;<span class="ident" id="5129155">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5129173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129177">default</span><span class="op" id="5129184">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129189">if</span>&nbsp;<span class="ident" id="5129192">c</span>&nbsp;<span class="op" id="5129194">&lt;</span>&nbsp;<span class="num" id="5129196">0x80</span>&nbsp;<span class="op" id="5129201">&amp;&amp;</span>&nbsp;<span class="ident" id="5129204">isCSSNmchar</span><span class="op" id="5129215">(</span><span class="builtintype" id="5129216">rune</span><span class="op" id="5129220">(</span><span class="ident" id="5129221">c</span><span class="op" id="5129222">)</span><span class="op" id="5129223">)</span>&nbsp;<span class="op" id="5129225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129231">id</span>&nbsp;<span class="op" id="5129234">=</span>&nbsp;<span class="builtinfunc" id="5129236">append</span><span class="op" id="5129242">(</span><span class="ident" id="5129243">id</span><span class="op" id="5129245">,</span>&nbsp;<span class="ident" id="5129247">c</span><span class="op" id="5129248">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5129253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5129257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5129260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129263">id</span>&nbsp;<span class="op" id="5129266">=</span>&nbsp;<span class="ident" id="5129268">bytes</span><span class="op" id="5129273">.</span><span class="ident" id="5129274">ToLower</span><span class="op" id="5129281">(</span><span class="ident" id="5129282">id</span><span class="op" id="5129284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129287">if</span>&nbsp;<span class="ident" id="5129290">bytes</span><span class="op" id="5129295">.</span><span class="ident" id="5129296">Index</span><span class="op" id="5129301">(</span><span class="ident" id="5129302">id</span><span class="op" id="5129304">,</span>&nbsp;<span class="ident" id="5129306">expressionBytes</span><span class="op" id="5129321">)</span>&nbsp;<span class="op" id="5129323">!=</span>&nbsp;<span class="op" id="5129326">-</span><span class="num" id="5129327">1</span>&nbsp;<span class="op" id="5129329">||</span>&nbsp;<span class="ident" id="5129332">bytes</span><span class="op" id="5129337">.</span><span class="ident" id="5129338">Index</span><span class="op" id="5129343">(</span><span class="ident" id="5129344">id</span><span class="op" id="5129346">,</span>&nbsp;<span class="ident" id="5129348">mozBindingBytes</span><span class="op" id="5129363">)</span>&nbsp;<span class="op" id="5129365">!=</span>&nbsp;<span class="op" id="5129368">-</span><span class="num" id="5129369">1</span>&nbsp;<span class="op" id="5129371">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129375">return</span>&nbsp;<span class="ident" id="5129382">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5129398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129401">return</span>&nbsp;<span class="builtintype" id="5129408">string</span><span class="op" id="5129414">(</span><span class="ident" id="5129415">b</span><span class="op" id="5129416">)</span><br>
<span class="lineno"></span><span class="op" id="5129418">}</span>
</div>
</body>
</html>
