<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html" class="current">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2797561">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2797616">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2797670">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2797721">//&nbsp;Parse&nbsp;&#34;zoneinfo&#34;&nbsp;time&nbsp;zone&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="2797757">//&nbsp;This&nbsp;is&nbsp;a&nbsp;fairly&nbsp;standard&nbsp;file&nbsp;format&nbsp;used&nbsp;on&nbsp;OS&nbsp;X,&nbsp;Linux,&nbsp;BSD,&nbsp;Sun,&nbsp;and&nbsp;others.</span><br>
<span class="lineno"></span><span class="comment" id="2797841">//&nbsp;See&nbsp;tzfile(5),&nbsp;http://en.wikipedia.org/wiki/Zoneinfo,</span><br>
<span class="lineno"></span><span class="comment" id="2797898">//&nbsp;and&nbsp;ftp://munnari.oz.au/pub/oldtz/</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="2797937">package</span>&nbsp;<span class="ident" id="2797945">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2797951">import</span>&nbsp;<span class="string" id="2797958">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2797968">//&nbsp;Simple&nbsp;I/O&nbsp;interface&nbsp;to&nbsp;binary&nbsp;blob&nbsp;of&nbsp;data.</span><br>
<span class="lineno">15</span><span class="keyword" id="2798016">type</span>&nbsp;<span class="ident" id="2798021">data</span>&nbsp;<span class="keyword" id="2798026">struct</span>&nbsp;<span class="op" id="2798033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798036">p</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2798042">[</span><span class="op" id="2798043">]</span><span class="builtintype" id="2798044">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2798050">error</span>&nbsp;<span class="builtintype" id="2798056">bool</span><br>
<span class="lineno"></span><span class="op" id="2798061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="2798064">func</span>&nbsp;<span class="op" id="2798069">(</span><span class="ident" id="2798070">d</span>&nbsp;<span class="op" id="2798072">*</span><span class="ident" id="2798073">data</span><span class="op" id="2798077">)</span>&nbsp;<span class="ident" id="2798079">read</span><span class="op" id="2798083">(</span><span class="ident" id="2798084">n</span>&nbsp;<span class="builtintype" id="2798086">int</span><span class="op" id="2798089">)</span>&nbsp;<span class="op" id="2798091">[</span><span class="op" id="2798092">]</span><span class="builtintype" id="2798093">byte</span>&nbsp;<span class="op" id="2798098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798101">if</span>&nbsp;<span class="builtinfunc" id="2798104">len</span><span class="op" id="2798107">(</span><span class="ident" id="2798108">d</span><span class="op" id="2798109">.</span><span class="ident" id="2798110">p</span><span class="op" id="2798111">)</span>&nbsp;<span class="op" id="2798113">&lt;</span>&nbsp;<span class="ident" id="2798115">n</span>&nbsp;<span class="op" id="2798117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798121">d</span><span class="op" id="2798122">.</span><span class="ident" id="2798123">p</span>&nbsp;<span class="op" id="2798125">=</span>&nbsp;<span class="builtintype" id="2798127">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798133">d</span><span class="op" id="2798134">.</span><span class="builtintype" id="2798135">error</span>&nbsp;<span class="op" id="2798141">=</span>&nbsp;<span class="builtintype" id="2798143">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798150">return</span>&nbsp;<span class="builtintype" id="2798157">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2798162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798165">p</span>&nbsp;<span class="op" id="2798167">:=</span>&nbsp;<span class="ident" id="2798170">d</span><span class="op" id="2798171">.</span><span class="ident" id="2798172">p</span><span class="op" id="2798173">[</span><span class="num" id="2798174">0</span><span class="op" id="2798175">:</span><span class="ident" id="2798176">n</span><span class="op" id="2798177">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798180">d</span><span class="op" id="2798181">.</span><span class="ident" id="2798182">p</span>&nbsp;<span class="op" id="2798184">=</span>&nbsp;<span class="ident" id="2798186">d</span><span class="op" id="2798187">.</span><span class="ident" id="2798188">p</span><span class="op" id="2798189">[</span><span class="ident" id="2798190">n</span><span class="op" id="2798191">:</span><span class="op" id="2798192">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798195">return</span>&nbsp;<span class="ident" id="2798202">p</span><br>
<span class="lineno"></span><span class="op" id="2798204">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="2798207">func</span>&nbsp;<span class="op" id="2798212">(</span><span class="ident" id="2798213">d</span>&nbsp;<span class="op" id="2798215">*</span><span class="ident" id="2798216">data</span><span class="op" id="2798220">)</span>&nbsp;<span class="ident" id="2798222">big4</span><span class="op" id="2798226">(</span><span class="op" id="2798227">)</span>&nbsp;<span class="op" id="2798229">(</span><span class="ident" id="2798230">n</span>&nbsp;<span class="builtintype" id="2798232">uint32</span><span class="op" id="2798238">,</span>&nbsp;<span class="ident" id="2798240">ok</span>&nbsp;<span class="builtintype" id="2798243">bool</span><span class="op" id="2798247">)</span>&nbsp;<span class="op" id="2798249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798252">p</span>&nbsp;<span class="op" id="2798254">:=</span>&nbsp;<span class="ident" id="2798257">d</span><span class="op" id="2798258">.</span><span class="ident" id="2798259">read</span><span class="op" id="2798263">(</span><span class="num" id="2798264">4</span><span class="op" id="2798265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798268">if</span>&nbsp;<span class="builtinfunc" id="2798271">len</span><span class="op" id="2798274">(</span><span class="ident" id="2798275">p</span><span class="op" id="2798276">)</span>&nbsp;<span class="op" id="2798278">&lt;</span>&nbsp;<span class="num" id="2798280">4</span>&nbsp;<span class="op" id="2798282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798286">d</span><span class="op" id="2798287">.</span><span class="builtintype" id="2798288">error</span>&nbsp;<span class="op" id="2798294">=</span>&nbsp;<span class="builtintype" id="2798296">true</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798303">return</span>&nbsp;<span class="num" id="2798310">0</span><span class="op" id="2798311">,</span>&nbsp;<span class="builtintype" id="2798313">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2798320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798323">return</span>&nbsp;<span class="builtintype" id="2798330">uint32</span><span class="op" id="2798336">(</span><span class="ident" id="2798337">p</span><span class="op" id="2798338">[</span><span class="num" id="2798339">0</span><span class="op" id="2798340">]</span><span class="op" id="2798341">)</span><span class="op" id="2798342">&lt;&lt;</span><span class="num" id="2798344">24</span>&nbsp;<span class="op" id="2798347">|</span>&nbsp;<span class="builtintype" id="2798349">uint32</span><span class="op" id="2798355">(</span><span class="ident" id="2798356">p</span><span class="op" id="2798357">[</span><span class="num" id="2798358">1</span><span class="op" id="2798359">]</span><span class="op" id="2798360">)</span><span class="op" id="2798361">&lt;&lt;</span><span class="num" id="2798363">16</span>&nbsp;<span class="op" id="2798366">|</span>&nbsp;<span class="builtintype" id="2798368">uint32</span><span class="op" id="2798374">(</span><span class="ident" id="2798375">p</span><span class="op" id="2798376">[</span><span class="num" id="2798377">2</span><span class="op" id="2798378">]</span><span class="op" id="2798379">)</span><span class="op" id="2798380">&lt;&lt;</span><span class="num" id="2798382">8</span>&nbsp;<span class="op" id="2798384">|</span>&nbsp;<span class="builtintype" id="2798386">uint32</span><span class="op" id="2798392">(</span><span class="ident" id="2798393">p</span><span class="op" id="2798394">[</span><span class="num" id="2798395">3</span><span class="op" id="2798396">]</span><span class="op" id="2798397">)</span><span class="op" id="2798398">,</span>&nbsp;<span class="builtintype" id="2798400">true</span><br>
<span class="lineno"></span><span class="op" id="2798405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="2798408">func</span>&nbsp;<span class="op" id="2798413">(</span><span class="ident" id="2798414">d</span>&nbsp;<span class="op" id="2798416">*</span><span class="ident" id="2798417">data</span><span class="op" id="2798421">)</span>&nbsp;<span class="builtintype" id="2798423">byte</span><span class="op" id="2798427">(</span><span class="op" id="2798428">)</span>&nbsp;<span class="op" id="2798430">(</span><span class="ident" id="2798431">n</span>&nbsp;<span class="builtintype" id="2798433">byte</span><span class="op" id="2798437">,</span>&nbsp;<span class="ident" id="2798439">ok</span>&nbsp;<span class="builtintype" id="2798442">bool</span><span class="op" id="2798446">)</span>&nbsp;<span class="op" id="2798448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798451">p</span>&nbsp;<span class="op" id="2798453">:=</span>&nbsp;<span class="ident" id="2798456">d</span><span class="op" id="2798457">.</span><span class="ident" id="2798458">read</span><span class="op" id="2798462">(</span><span class="num" id="2798463">1</span><span class="op" id="2798464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798467">if</span>&nbsp;<span class="builtinfunc" id="2798470">len</span><span class="op" id="2798473">(</span><span class="ident" id="2798474">p</span><span class="op" id="2798475">)</span>&nbsp;<span class="op" id="2798477">&lt;</span>&nbsp;<span class="num" id="2798479">1</span>&nbsp;<span class="op" id="2798481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798485">d</span><span class="op" id="2798486">.</span><span class="builtintype" id="2798487">error</span>&nbsp;<span class="op" id="2798493">=</span>&nbsp;<span class="builtintype" id="2798495">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798502">return</span>&nbsp;<span class="num" id="2798509">0</span><span class="op" id="2798510">,</span>&nbsp;<span class="builtintype" id="2798512">false</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2798519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798522">return</span>&nbsp;<span class="ident" id="2798529">p</span><span class="op" id="2798530">[</span><span class="num" id="2798531">0</span><span class="op" id="2798532">]</span><span class="op" id="2798533">,</span>&nbsp;<span class="builtintype" id="2798535">true</span><br>
<span class="lineno"></span><span class="op" id="2798540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2798543">//&nbsp;Make&nbsp;a&nbsp;string&nbsp;by&nbsp;stopping&nbsp;at&nbsp;the&nbsp;first&nbsp;NUL</span><br>
<span class="lineno">50</span><span class="keyword" id="2798589">func</span>&nbsp;<span class="ident" id="2798594">byteString</span><span class="op" id="2798604">(</span><span class="ident" id="2798605">p</span>&nbsp;<span class="op" id="2798607">[</span><span class="op" id="2798608">]</span><span class="builtintype" id="2798609">byte</span><span class="op" id="2798613">)</span>&nbsp;<span class="builtintype" id="2798615">string</span>&nbsp;<span class="op" id="2798622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798625">for</span>&nbsp;<span class="ident" id="2798629">i</span>&nbsp;<span class="op" id="2798631">:=</span>&nbsp;<span class="num" id="2798634">0</span><span class="op" id="2798635">;</span>&nbsp;<span class="ident" id="2798637">i</span>&nbsp;<span class="op" id="2798639">&lt;</span>&nbsp;<span class="builtinfunc" id="2798641">len</span><span class="op" id="2798644">(</span><span class="ident" id="2798645">p</span><span class="op" id="2798646">)</span><span class="op" id="2798647">;</span>&nbsp;<span class="ident" id="2798649">i</span><span class="op" id="2798650">++</span>&nbsp;<span class="op" id="2798653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798657">if</span>&nbsp;<span class="ident" id="2798660">p</span><span class="op" id="2798661">[</span><span class="ident" id="2798662">i</span><span class="op" id="2798663">]</span>&nbsp;<span class="op" id="2798665">==</span>&nbsp;<span class="num" id="2798668">0</span>&nbsp;<span class="op" id="2798670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798675">return</span>&nbsp;<span class="builtintype" id="2798682">string</span><span class="op" id="2798688">(</span><span class="ident" id="2798689">p</span><span class="op" id="2798690">[</span><span class="num" id="2798691">0</span><span class="op" id="2798692">:</span><span class="ident" id="2798693">i</span><span class="op" id="2798694">]</span><span class="op" id="2798695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2798699">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2798702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798705">return</span>&nbsp;<span class="builtintype" id="2798712">string</span><span class="op" id="2798718">(</span><span class="ident" id="2798719">p</span><span class="op" id="2798720">)</span><br>
<span class="lineno"></span><span class="op" id="2798722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2798725">var</span>&nbsp;<span class="ident" id="2798729">badData</span>&nbsp;<span class="op" id="2798737">=</span>&nbsp;<span class="ident" id="2798739">errors</span><span class="op" id="2798745">.</span><span class="ident" id="2798746">New</span><span class="op" id="2798749">(</span><span class="string" id="2798750">&#34;malformed&nbsp;time&nbsp;zone&nbsp;information&#34;</span><span class="op" id="2798783">)</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="2798786">func</span>&nbsp;<span class="ident" id="2798791">loadZoneData</span><span class="op" id="2798803">(</span><span class="ident" id="2798804">bytes</span>&nbsp;<span class="op" id="2798810">[</span><span class="op" id="2798811">]</span><span class="builtintype" id="2798812">byte</span><span class="op" id="2798816">)</span>&nbsp;<span class="op" id="2798818">(</span><span class="ident" id="2798819">l</span>&nbsp;<span class="op" id="2798821">*</span><span class="ident" id="2798822">Location</span><span class="op" id="2798830">,</span>&nbsp;<span class="ident" id="2798832">err</span>&nbsp;<span class="builtintype" id="2798836">error</span><span class="op" id="2798841">)</span>&nbsp;<span class="op" id="2798843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798846">d</span>&nbsp;<span class="op" id="2798848">:=</span>&nbsp;<span class="ident" id="2798851">data</span><span class="op" id="2798855">{</span><span class="ident" id="2798856">bytes</span><span class="op" id="2798861">,</span>&nbsp;<span class="builtintype" id="2798863">false</span><span class="op" id="2798868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2798872">//&nbsp;4-byte&nbsp;magic&nbsp;&#34;TZif&#34;</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798896">if</span>&nbsp;<span class="ident" id="2798899">magic</span>&nbsp;<span class="op" id="2798905">:=</span>&nbsp;<span class="ident" id="2798908">d</span><span class="op" id="2798909">.</span><span class="ident" id="2798910">read</span><span class="op" id="2798914">(</span><span class="num" id="2798915">4</span><span class="op" id="2798916">)</span><span class="op" id="2798917">;</span>&nbsp;<span class="builtintype" id="2798919">string</span><span class="op" id="2798925">(</span><span class="ident" id="2798926">magic</span><span class="op" id="2798931">)</span>&nbsp;<span class="op" id="2798933">!=</span>&nbsp;<span class="string" id="2798936">&#34;TZif&#34;</span>&nbsp;<span class="op" id="2798943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798947">return</span>&nbsp;<span class="builtintype" id="2798954">nil</span><span class="op" id="2798957">,</span>&nbsp;<span class="ident" id="2798959">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2798968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2798972">//&nbsp;1-byte&nbsp;version,&nbsp;then&nbsp;15&nbsp;bytes&nbsp;of&nbsp;padding</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799017">var</span>&nbsp;<span class="ident" id="2799021">p</span>&nbsp;<span class="op" id="2799023">[</span><span class="op" id="2799024">]</span><span class="builtintype" id="2799025">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799031">if</span>&nbsp;<span class="ident" id="2799034">p</span>&nbsp;<span class="op" id="2799036">=</span>&nbsp;<span class="ident" id="2799038">d</span><span class="op" id="2799039">.</span><span class="ident" id="2799040">read</span><span class="op" id="2799044">(</span><span class="num" id="2799045">16</span><span class="op" id="2799047">)</span><span class="op" id="2799048">;</span>&nbsp;<span class="builtinfunc" id="2799050">len</span><span class="op" id="2799053">(</span><span class="ident" id="2799054">p</span><span class="op" id="2799055">)</span>&nbsp;<span class="op" id="2799057">!=</span>&nbsp;<span class="num" id="2799060">16</span>&nbsp;<span class="op" id="2799063">||</span>&nbsp;<span class="ident" id="2799066">p</span><span class="op" id="2799067">[</span><span class="num" id="2799068">0</span><span class="op" id="2799069">]</span>&nbsp;<span class="op" id="2799071">!=</span>&nbsp;<span class="num" id="2799074">0</span>&nbsp;<span class="op" id="2799076">&amp;&amp;</span>&nbsp;<span class="ident" id="2799079">p</span><span class="op" id="2799080">[</span><span class="num" id="2799081">0</span><span class="op" id="2799082">]</span>&nbsp;<span class="op" id="2799084">!=</span>&nbsp;<span class="string" id="2799087">&#39;2&#39;</span>&nbsp;<span class="op" id="2799091">&amp;&amp;</span>&nbsp;<span class="ident" id="2799094">p</span><span class="op" id="2799095">[</span><span class="num" id="2799096">0</span><span class="op" id="2799097">]</span>&nbsp;<span class="op" id="2799099">!=</span>&nbsp;<span class="string" id="2799102">&#39;3&#39;</span>&nbsp;<span class="op" id="2799106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799110">return</span>&nbsp;<span class="builtintype" id="2799117">nil</span><span class="op" id="2799120">,</span>&nbsp;<span class="ident" id="2799122">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2799131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2799135">//&nbsp;six&nbsp;big-endian&nbsp;32-bit&nbsp;integers:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2799171">//&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;UTC/local&nbsp;indicators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2799206">//&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;standard/wall&nbsp;indicators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2799245">//&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;leap&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2799272">//&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;transition&nbsp;times</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2799303">//&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;local&nbsp;time&nbsp;zones</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2799334">//&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;characters&nbsp;of&nbsp;time&nbsp;zone&nbsp;abbrev&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799387">const</span>&nbsp;<span class="op" id="2799393">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799397">NUTCLocal</span>&nbsp;<span class="op" id="2799407">=</span>&nbsp;<span class="ident" id="2799409">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799416">NStdWall</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799427">NLeap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799435">NTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799443">NZone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799451">NChar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2799458">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799461">var</span>&nbsp;<span class="ident" id="2799465">n</span>&nbsp;<span class="op" id="2799467">[</span><span class="num" id="2799468">6</span><span class="op" id="2799469">]</span><span class="builtintype" id="2799470">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799475">for</span>&nbsp;<span class="ident" id="2799479">i</span>&nbsp;<span class="op" id="2799481">:=</span>&nbsp;<span class="num" id="2799484">0</span><span class="op" id="2799485">;</span>&nbsp;<span class="ident" id="2799487">i</span>&nbsp;<span class="op" id="2799489">&lt;</span>&nbsp;<span class="num" id="2799491">6</span><span class="op" id="2799492">;</span>&nbsp;<span class="ident" id="2799494">i</span><span class="op" id="2799495">++</span>&nbsp;<span class="op" id="2799498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799502">nn</span><span class="op" id="2799504">,</span>&nbsp;<span class="ident" id="2799506">ok</span>&nbsp;<span class="op" id="2799509">:=</span>&nbsp;<span class="ident" id="2799512">d</span><span class="op" id="2799513">.</span><span class="ident" id="2799514">big4</span><span class="op" id="2799518">(</span><span class="op" id="2799519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799523">if</span>&nbsp;<span class="op" id="2799526">!</span><span class="ident" id="2799527">ok</span>&nbsp;<span class="op" id="2799530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799535">return</span>&nbsp;<span class="builtintype" id="2799542">nil</span><span class="op" id="2799545">,</span>&nbsp;<span class="ident" id="2799547">badData</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2799557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799561">n</span><span class="op" id="2799562">[</span><span class="ident" id="2799563">i</span><span class="op" id="2799564">]</span>&nbsp;<span class="op" id="2799566">=</span>&nbsp;<span class="builtintype" id="2799568">int</span><span class="op" id="2799571">(</span><span class="ident" id="2799572">nn</span><span class="op" id="2799574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2799577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2799581">//&nbsp;Transition&nbsp;times.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799603">txtimes</span>&nbsp;<span class="op" id="2799611">:=</span>&nbsp;<span class="ident" id="2799614">data</span><span class="op" id="2799618">{</span><span class="ident" id="2799619">d</span><span class="op" id="2799620">.</span><span class="ident" id="2799621">read</span><span class="op" id="2799625">(</span><span class="ident" id="2799626">n</span><span class="op" id="2799627">[</span><span class="ident" id="2799628">NTime</span><span class="op" id="2799633">]</span>&nbsp;<span class="op" id="2799635">*</span>&nbsp;<span class="num" id="2799637">4</span><span class="op" id="2799638">)</span><span class="op" id="2799639">,</span>&nbsp;<span class="builtintype" id="2799641">false</span><span class="op" id="2799646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2799650">//&nbsp;Time&nbsp;zone&nbsp;indices&nbsp;for&nbsp;transition&nbsp;times.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799694">txzones</span>&nbsp;<span class="op" id="2799702">:=</span>&nbsp;<span class="ident" id="2799705">d</span><span class="op" id="2799706">.</span><span class="ident" id="2799707">read</span><span class="op" id="2799711">(</span><span class="ident" id="2799712">n</span><span class="op" id="2799713">[</span><span class="ident" id="2799714">NTime</span><span class="op" id="2799719">]</span><span class="op" id="2799720">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2799724">//&nbsp;Zone&nbsp;info&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799749">zonedata</span>&nbsp;<span class="op" id="2799758">:=</span>&nbsp;<span class="ident" id="2799761">data</span><span class="op" id="2799765">{</span><span class="ident" id="2799766">d</span><span class="op" id="2799767">.</span><span class="ident" id="2799768">read</span><span class="op" id="2799772">(</span><span class="ident" id="2799773">n</span><span class="op" id="2799774">[</span><span class="ident" id="2799775">NZone</span><span class="op" id="2799780">]</span>&nbsp;<span class="op" id="2799782">*</span>&nbsp;<span class="num" id="2799784">6</span><span class="op" id="2799785">)</span><span class="op" id="2799786">,</span>&nbsp;<span class="builtintype" id="2799788">false</span><span class="op" id="2799793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2799797">//&nbsp;Time&nbsp;zone&nbsp;abbreviations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799826">abbrev</span>&nbsp;<span class="op" id="2799833">:=</span>&nbsp;<span class="ident" id="2799836">d</span><span class="op" id="2799837">.</span><span class="ident" id="2799838">read</span><span class="op" id="2799842">(</span><span class="ident" id="2799843">n</span><span class="op" id="2799844">[</span><span class="ident" id="2799845">NChar</span><span class="op" id="2799850">]</span><span class="op" id="2799851">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2799855">//&nbsp;Leap-second&nbsp;time&nbsp;pairs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799882">d</span><span class="op" id="2799883">.</span><span class="ident" id="2799884">read</span><span class="op" id="2799888">(</span><span class="ident" id="2799889">n</span><span class="op" id="2799890">[</span><span class="ident" id="2799891">NLeap</span><span class="op" id="2799896">]</span>&nbsp;<span class="op" id="2799898">*</span>&nbsp;<span class="num" id="2799900">8</span><span class="op" id="2799901">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2799905">//&nbsp;Whether&nbsp;tx&nbsp;times&nbsp;associated&nbsp;with&nbsp;local&nbsp;time&nbsp;types</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2799959">//&nbsp;are&nbsp;specified&nbsp;as&nbsp;standard&nbsp;time&nbsp;or&nbsp;wall&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2800008">isstd</span>&nbsp;<span class="op" id="2800014">:=</span>&nbsp;<span class="ident" id="2800017">d</span><span class="op" id="2800018">.</span><span class="ident" id="2800019">read</span><span class="op" id="2800023">(</span><span class="ident" id="2800024">n</span><span class="op" id="2800025">[</span><span class="ident" id="2800026">NStdWall</span><span class="op" id="2800034">]</span><span class="op" id="2800035">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2800039">//&nbsp;Whether&nbsp;tx&nbsp;times&nbsp;associated&nbsp;with&nbsp;local&nbsp;time&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2800093">//&nbsp;are&nbsp;specified&nbsp;as&nbsp;UTC&nbsp;or&nbsp;local&nbsp;time.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2800133">isutc</span>&nbsp;<span class="op" id="2800139">:=</span>&nbsp;<span class="ident" id="2800142">d</span><span class="op" id="2800143">.</span><span class="ident" id="2800144">read</span><span class="op" id="2800148">(</span><span class="ident" id="2800149">n</span><span class="op" id="2800150">[</span><span class="ident" id="2800151">NUTCLocal</span><span class="op" id="2800160">]</span><span class="op" id="2800161">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800165">if</span>&nbsp;<span class="ident" id="2800168">d</span><span class="op" id="2800169">.</span><span class="builtintype" id="2800170">error</span>&nbsp;<span class="op" id="2800176">{</span>&nbsp;<span class="comment" id="2800178">//&nbsp;ran&nbsp;out&nbsp;of&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800199">return</span>&nbsp;<span class="builtintype" id="2800206">nil</span><span class="op" id="2800209">,</span>&nbsp;<span class="ident" id="2800211">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2800220">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2800224">//&nbsp;If&nbsp;version&nbsp;==&nbsp;2&nbsp;or&nbsp;3,&nbsp;the&nbsp;entire&nbsp;file&nbsp;repeats,&nbsp;this&nbsp;time&nbsp;using</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2800291">//&nbsp;8-byte&nbsp;ints&nbsp;for&nbsp;txtimes&nbsp;and&nbsp;leap&nbsp;seconds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2800337">//&nbsp;We&nbsp;won&#39;t&nbsp;need&nbsp;those&nbsp;until&nbsp;2106.</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2800374">//&nbsp;Now&nbsp;we&nbsp;can&nbsp;build&nbsp;up&nbsp;a&nbsp;useful&nbsp;data&nbsp;structure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2800423">//&nbsp;First&nbsp;the&nbsp;zone&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2800455">//&nbsp;&nbsp;&nbsp;&nbsp;utcoff[4]&nbsp;isdst[1]&nbsp;nameindex[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2800491">zone</span>&nbsp;<span class="op" id="2800496">:=</span>&nbsp;<span class="builtinfunc" id="2800499">make</span><span class="op" id="2800503">(</span><span class="op" id="2800504">[</span><span class="op" id="2800505">]</span><span class="ident" id="2800506">zone</span><span class="op" id="2800510">,</span>&nbsp;<span class="ident" id="2800512">n</span><span class="op" id="2800513">[</span><span class="ident" id="2800514">NZone</span><span class="op" id="2800519">]</span><span class="op" id="2800520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800523">for</span>&nbsp;<span class="ident" id="2800527">i</span>&nbsp;<span class="op" id="2800529">:=</span>&nbsp;<span class="keyword" id="2800532">range</span>&nbsp;<span class="ident" id="2800538">zone</span>&nbsp;<span class="op" id="2800543">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800547">var</span>&nbsp;<span class="ident" id="2800551">ok</span>&nbsp;<span class="builtintype" id="2800554">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800561">var</span>&nbsp;<span class="ident" id="2800565">n</span>&nbsp;<span class="builtintype" id="2800567">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800576">if</span>&nbsp;<span class="ident" id="2800579">n</span><span class="op" id="2800580">,</span>&nbsp;<span class="ident" id="2800582">ok</span>&nbsp;<span class="op" id="2800585">=</span>&nbsp;<span class="ident" id="2800587">zonedata</span><span class="op" id="2800595">.</span><span class="ident" id="2800596">big4</span><span class="op" id="2800600">(</span><span class="op" id="2800601">)</span><span class="op" id="2800602">;</span>&nbsp;<span class="op" id="2800604">!</span><span class="ident" id="2800605">ok</span>&nbsp;<span class="op" id="2800608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800613">return</span>&nbsp;<span class="builtintype" id="2800620">nil</span><span class="op" id="2800623">,</span>&nbsp;<span class="ident" id="2800625">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2800635">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2800639">zone</span><span class="op" id="2800643">[</span><span class="ident" id="2800644">i</span><span class="op" id="2800645">]</span><span class="op" id="2800646">.</span><span class="ident" id="2800647">offset</span>&nbsp;<span class="op" id="2800654">=</span>&nbsp;<span class="builtintype" id="2800656">int</span><span class="op" id="2800659">(</span><span class="builtintype" id="2800660">int32</span><span class="op" id="2800665">(</span><span class="ident" id="2800666">n</span><span class="op" id="2800667">)</span><span class="op" id="2800668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800672">var</span>&nbsp;<span class="ident" id="2800676">b</span>&nbsp;<span class="builtintype" id="2800678">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800685">if</span>&nbsp;<span class="ident" id="2800688">b</span><span class="op" id="2800689">,</span>&nbsp;<span class="ident" id="2800691">ok</span>&nbsp;<span class="op" id="2800694">=</span>&nbsp;<span class="ident" id="2800696">zonedata</span><span class="op" id="2800704">.</span><span class="builtintype" id="2800705">byte</span><span class="op" id="2800709">(</span><span class="op" id="2800710">)</span><span class="op" id="2800711">;</span>&nbsp;<span class="op" id="2800713">!</span><span class="ident" id="2800714">ok</span>&nbsp;<span class="op" id="2800717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800722">return</span>&nbsp;<span class="builtintype" id="2800729">nil</span><span class="op" id="2800732">,</span>&nbsp;<span class="ident" id="2800734">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2800744">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2800748">zone</span><span class="op" id="2800752">[</span><span class="ident" id="2800753">i</span><span class="op" id="2800754">]</span><span class="op" id="2800755">.</span><span class="ident" id="2800756">isDST</span>&nbsp;<span class="op" id="2800762">=</span>&nbsp;<span class="ident" id="2800764">b</span>&nbsp;<span class="op" id="2800766">!=</span>&nbsp;<span class="num" id="2800769">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800773">if</span>&nbsp;<span class="ident" id="2800776">b</span><span class="op" id="2800777">,</span>&nbsp;<span class="ident" id="2800779">ok</span>&nbsp;<span class="op" id="2800782">=</span>&nbsp;<span class="ident" id="2800784">zonedata</span><span class="op" id="2800792">.</span><span class="builtintype" id="2800793">byte</span><span class="op" id="2800797">(</span><span class="op" id="2800798">)</span><span class="op" id="2800799">;</span>&nbsp;<span class="op" id="2800801">!</span><span class="ident" id="2800802">ok</span>&nbsp;<span class="op" id="2800805">||</span>&nbsp;<span class="builtintype" id="2800808">int</span><span class="op" id="2800811">(</span><span class="ident" id="2800812">b</span><span class="op" id="2800813">)</span>&nbsp;<span class="op" id="2800815">&gt;=</span>&nbsp;<span class="builtinfunc" id="2800818">len</span><span class="op" id="2800821">(</span><span class="ident" id="2800822">abbrev</span><span class="op" id="2800828">)</span>&nbsp;<span class="op" id="2800830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800835">return</span>&nbsp;<span class="builtintype" id="2800842">nil</span><span class="op" id="2800845">,</span>&nbsp;<span class="ident" id="2800847">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2800857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2800861">zone</span><span class="op" id="2800865">[</span><span class="ident" id="2800866">i</span><span class="op" id="2800867">]</span><span class="op" id="2800868">.</span><span class="ident" id="2800869">name</span>&nbsp;<span class="op" id="2800874">=</span>&nbsp;<span class="ident" id="2800876">byteString</span><span class="op" id="2800886">(</span><span class="ident" id="2800887">abbrev</span><span class="op" id="2800893">[</span><span class="ident" id="2800894">b</span><span class="op" id="2800895">:</span><span class="op" id="2800896">]</span><span class="op" id="2800897">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2800900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2800904">//&nbsp;Now&nbsp;the&nbsp;transition&nbsp;time&nbsp;info.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2800938">tx</span>&nbsp;<span class="op" id="2800941">:=</span>&nbsp;<span class="builtinfunc" id="2800944">make</span><span class="op" id="2800948">(</span><span class="op" id="2800949">[</span><span class="op" id="2800950">]</span><span class="ident" id="2800951">zoneTrans</span><span class="op" id="2800960">,</span>&nbsp;<span class="ident" id="2800962">n</span><span class="op" id="2800963">[</span><span class="ident" id="2800964">NTime</span><span class="op" id="2800969">]</span><span class="op" id="2800970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800973">for</span>&nbsp;<span class="ident" id="2800977">i</span>&nbsp;<span class="op" id="2800979">:=</span>&nbsp;<span class="keyword" id="2800982">range</span>&nbsp;<span class="ident" id="2800988">tx</span>&nbsp;<span class="op" id="2800991">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800995">var</span>&nbsp;<span class="ident" id="2800999">ok</span>&nbsp;<span class="builtintype" id="2801002">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801009">var</span>&nbsp;<span class="ident" id="2801013">n</span>&nbsp;<span class="builtintype" id="2801015">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801024">if</span>&nbsp;<span class="ident" id="2801027">n</span><span class="op" id="2801028">,</span>&nbsp;<span class="ident" id="2801030">ok</span>&nbsp;<span class="op" id="2801033">=</span>&nbsp;<span class="ident" id="2801035">txtimes</span><span class="op" id="2801042">.</span><span class="ident" id="2801043">big4</span><span class="op" id="2801047">(</span><span class="op" id="2801048">)</span><span class="op" id="2801049">;</span>&nbsp;<span class="op" id="2801051">!</span><span class="ident" id="2801052">ok</span>&nbsp;<span class="op" id="2801055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801060">return</span>&nbsp;<span class="builtintype" id="2801067">nil</span><span class="op" id="2801070">,</span>&nbsp;<span class="ident" id="2801072">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2801082">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2801086">tx</span><span class="op" id="2801088">[</span><span class="ident" id="2801089">i</span><span class="op" id="2801090">]</span><span class="op" id="2801091">.</span><span class="ident" id="2801092">when</span>&nbsp;<span class="op" id="2801097">=</span>&nbsp;<span class="builtintype" id="2801099">int64</span><span class="op" id="2801104">(</span><span class="builtintype" id="2801105">int32</span><span class="op" id="2801110">(</span><span class="ident" id="2801111">n</span><span class="op" id="2801112">)</span><span class="op" id="2801113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801117">if</span>&nbsp;<span class="builtintype" id="2801120">int</span><span class="op" id="2801123">(</span><span class="ident" id="2801124">txzones</span><span class="op" id="2801131">[</span><span class="ident" id="2801132">i</span><span class="op" id="2801133">]</span><span class="op" id="2801134">)</span>&nbsp;<span class="op" id="2801136">&gt;=</span>&nbsp;<span class="builtinfunc" id="2801139">len</span><span class="op" id="2801142">(</span><span class="ident" id="2801143">zone</span><span class="op" id="2801147">)</span>&nbsp;<span class="op" id="2801149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801154">return</span>&nbsp;<span class="builtintype" id="2801161">nil</span><span class="op" id="2801164">,</span>&nbsp;<span class="ident" id="2801166">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2801176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2801180">tx</span><span class="op" id="2801182">[</span><span class="ident" id="2801183">i</span><span class="op" id="2801184">]</span><span class="op" id="2801185">.</span><span class="ident" id="2801186">index</span>&nbsp;<span class="op" id="2801192">=</span>&nbsp;<span class="ident" id="2801194">txzones</span><span class="op" id="2801201">[</span><span class="ident" id="2801202">i</span><span class="op" id="2801203">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801207">if</span>&nbsp;<span class="ident" id="2801210">i</span>&nbsp;<span class="op" id="2801212">&lt;</span>&nbsp;<span class="builtinfunc" id="2801214">len</span><span class="op" id="2801217">(</span><span class="ident" id="2801218">isstd</span><span class="op" id="2801223">)</span>&nbsp;<span class="op" id="2801225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2801230">tx</span><span class="op" id="2801232">[</span><span class="ident" id="2801233">i</span><span class="op" id="2801234">]</span><span class="op" id="2801235">.</span><span class="ident" id="2801236">isstd</span>&nbsp;<span class="op" id="2801242">=</span>&nbsp;<span class="ident" id="2801244">isstd</span><span class="op" id="2801249">[</span><span class="ident" id="2801250">i</span><span class="op" id="2801251">]</span>&nbsp;<span class="op" id="2801253">!=</span>&nbsp;<span class="num" id="2801256">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2801260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801264">if</span>&nbsp;<span class="ident" id="2801267">i</span>&nbsp;<span class="op" id="2801269">&lt;</span>&nbsp;<span class="builtinfunc" id="2801271">len</span><span class="op" id="2801274">(</span><span class="ident" id="2801275">isutc</span><span class="op" id="2801280">)</span>&nbsp;<span class="op" id="2801282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2801287">tx</span><span class="op" id="2801289">[</span><span class="ident" id="2801290">i</span><span class="op" id="2801291">]</span><span class="op" id="2801292">.</span><span class="ident" id="2801293">isutc</span>&nbsp;<span class="op" id="2801299">=</span>&nbsp;<span class="ident" id="2801301">isutc</span><span class="op" id="2801306">[</span><span class="ident" id="2801307">i</span><span class="op" id="2801308">]</span>&nbsp;<span class="op" id="2801310">!=</span>&nbsp;<span class="num" id="2801313">0</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2801317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2801320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801324">if</span>&nbsp;<span class="builtinfunc" id="2801327">len</span><span class="op" id="2801330">(</span><span class="ident" id="2801331">tx</span><span class="op" id="2801333">)</span>&nbsp;<span class="op" id="2801335">==</span>&nbsp;<span class="num" id="2801338">0</span>&nbsp;<span class="op" id="2801340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2801344">//&nbsp;Build&nbsp;fake&nbsp;transition&nbsp;to&nbsp;cover&nbsp;all&nbsp;time.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2801390">//&nbsp;This&nbsp;happens&nbsp;in&nbsp;fixed&nbsp;locations&nbsp;like&nbsp;&#34;Etc/GMT0&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2801444">tx</span>&nbsp;<span class="op" id="2801447">=</span>&nbsp;<span class="builtinfunc" id="2801449">append</span><span class="op" id="2801455">(</span><span class="ident" id="2801456">tx</span><span class="op" id="2801458">,</span>&nbsp;<span class="ident" id="2801460">zoneTrans</span><span class="op" id="2801469">{</span><span class="ident" id="2801470">when</span><span class="op" id="2801474">:</span>&nbsp;<span class="ident" id="2801476">alpha</span><span class="op" id="2801481">,</span>&nbsp;<span class="ident" id="2801483">index</span><span class="op" id="2801488">:</span>&nbsp;<span class="num" id="2801490">0</span><span class="op" id="2801491">}</span><span class="op" id="2801492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2801495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2801499">//&nbsp;Committed&nbsp;to&nbsp;succeed.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2801525">l</span>&nbsp;<span class="op" id="2801527">=</span>&nbsp;<span class="op" id="2801529">&amp;</span><span class="ident" id="2801530">Location</span><span class="op" id="2801538">{</span><span class="ident" id="2801539">zone</span><span class="op" id="2801543">:</span>&nbsp;<span class="ident" id="2801545">zone</span><span class="op" id="2801549">,</span>&nbsp;<span class="ident" id="2801551">tx</span><span class="op" id="2801553">:</span>&nbsp;<span class="ident" id="2801555">tx</span><span class="op" id="2801557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2801561">//&nbsp;Fill&nbsp;in&nbsp;the&nbsp;cache&nbsp;with&nbsp;information&nbsp;about&nbsp;right&nbsp;now,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2801617">//&nbsp;since&nbsp;that&nbsp;will&nbsp;be&nbsp;the&nbsp;most&nbsp;common&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2801664">sec</span><span class="op" id="2801667">,</span>&nbsp;<span class="ident" id="2801669">_</span>&nbsp;<span class="op" id="2801671">:=</span>&nbsp;<span class="ident" id="2801674">now</span><span class="op" id="2801677">(</span><span class="op" id="2801678">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801681">for</span>&nbsp;<span class="ident" id="2801685">i</span>&nbsp;<span class="op" id="2801687">:=</span>&nbsp;<span class="keyword" id="2801690">range</span>&nbsp;<span class="ident" id="2801696">tx</span>&nbsp;<span class="op" id="2801699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801703">if</span>&nbsp;<span class="ident" id="2801706">tx</span><span class="op" id="2801708">[</span><span class="ident" id="2801709">i</span><span class="op" id="2801710">]</span><span class="op" id="2801711">.</span><span class="ident" id="2801712">when</span>&nbsp;<span class="op" id="2801717">&lt;=</span>&nbsp;<span class="ident" id="2801720">sec</span>&nbsp;<span class="op" id="2801724">&amp;&amp;</span>&nbsp;<span class="op" id="2801727">(</span><span class="ident" id="2801728">i</span><span class="op" id="2801729">+</span><span class="num" id="2801730">1</span>&nbsp;<span class="op" id="2801732">==</span>&nbsp;<span class="builtinfunc" id="2801735">len</span><span class="op" id="2801738">(</span><span class="ident" id="2801739">tx</span><span class="op" id="2801741">)</span>&nbsp;<span class="op" id="2801743">||</span>&nbsp;<span class="ident" id="2801746">sec</span>&nbsp;<span class="op" id="2801750">&lt;</span>&nbsp;<span class="ident" id="2801752">tx</span><span class="op" id="2801754">[</span><span class="ident" id="2801755">i</span><span class="op" id="2801756">+</span><span class="num" id="2801757">1</span><span class="op" id="2801758">]</span><span class="op" id="2801759">.</span><span class="ident" id="2801760">when</span><span class="op" id="2801764">)</span>&nbsp;<span class="op" id="2801766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2801771">l</span><span class="op" id="2801772">.</span><span class="ident" id="2801773">cacheStart</span>&nbsp;<span class="op" id="2801784">=</span>&nbsp;<span class="ident" id="2801786">tx</span><span class="op" id="2801788">[</span><span class="ident" id="2801789">i</span><span class="op" id="2801790">]</span><span class="op" id="2801791">.</span><span class="ident" id="2801792">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2801800">l</span><span class="op" id="2801801">.</span><span class="ident" id="2801802">cacheEnd</span>&nbsp;<span class="op" id="2801811">=</span>&nbsp;<span class="ident" id="2801813">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801822">if</span>&nbsp;<span class="ident" id="2801825">i</span><span class="op" id="2801826">+</span><span class="num" id="2801827">1</span>&nbsp;<span class="op" id="2801829">&lt;</span>&nbsp;<span class="builtinfunc" id="2801831">len</span><span class="op" id="2801834">(</span><span class="ident" id="2801835">tx</span><span class="op" id="2801837">)</span>&nbsp;<span class="op" id="2801839">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2801845">l</span><span class="op" id="2801846">.</span><span class="ident" id="2801847">cacheEnd</span>&nbsp;<span class="op" id="2801856">=</span>&nbsp;<span class="ident" id="2801858">tx</span><span class="op" id="2801860">[</span><span class="ident" id="2801861">i</span><span class="op" id="2801862">+</span><span class="num" id="2801863">1</span><span class="op" id="2801864">]</span><span class="op" id="2801865">.</span><span class="ident" id="2801866">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2801874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2801879">l</span><span class="op" id="2801880">.</span><span class="ident" id="2801881">cacheZone</span>&nbsp;<span class="op" id="2801891">=</span>&nbsp;<span class="op" id="2801893">&amp;</span><span class="ident" id="2801894">l</span><span class="op" id="2801895">.</span><span class="ident" id="2801896">zone</span><span class="op" id="2801900">[</span><span class="ident" id="2801901">tx</span><span class="op" id="2801903">[</span><span class="ident" id="2801904">i</span><span class="op" id="2801905">]</span><span class="op" id="2801906">.</span><span class="ident" id="2801907">index</span><span class="op" id="2801912">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2801916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2801919">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801923">return</span>&nbsp;<span class="ident" id="2801930">l</span><span class="op" id="2801931">,</span>&nbsp;<span class="builtintype" id="2801933">nil</span><br>
<span class="lineno"></span><span class="op" id="2801937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2801940">func</span>&nbsp;<span class="ident" id="2801945">loadZoneFile</span><span class="op" id="2801957">(</span><span class="ident" id="2801958">dir</span><span class="op" id="2801961">,</span>&nbsp;<span class="ident" id="2801963">name</span>&nbsp;<span class="builtintype" id="2801968">string</span><span class="op" id="2801974">)</span>&nbsp;<span class="op" id="2801976">(</span><span class="ident" id="2801977">l</span>&nbsp;<span class="op" id="2801979">*</span><span class="ident" id="2801980">Location</span><span class="op" id="2801988">,</span>&nbsp;<span class="ident" id="2801990">err</span>&nbsp;<span class="builtintype" id="2801994">error</span><span class="op" id="2801999">)</span>&nbsp;<span class="op" id="2802001">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802004">if</span>&nbsp;<span class="builtinfunc" id="2802007">len</span><span class="op" id="2802010">(</span><span class="ident" id="2802011">dir</span><span class="op" id="2802014">)</span>&nbsp;<span class="op" id="2802016">&gt;</span>&nbsp;<span class="num" id="2802018">4</span>&nbsp;<span class="op" id="2802020">&amp;&amp;</span>&nbsp;<span class="ident" id="2802023">dir</span><span class="op" id="2802026">[</span><span class="builtinfunc" id="2802027">len</span><span class="op" id="2802030">(</span><span class="ident" id="2802031">dir</span><span class="op" id="2802034">)</span><span class="op" id="2802035">-</span><span class="num" id="2802036">4</span><span class="op" id="2802037">:</span><span class="op" id="2802038">]</span>&nbsp;<span class="op" id="2802040">==</span>&nbsp;<span class="string" id="2802043">&#34;.zip&#34;</span>&nbsp;<span class="op" id="2802050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802054">return</span>&nbsp;<span class="ident" id="2802061">loadZoneZip</span><span class="op" id="2802072">(</span><span class="ident" id="2802073">dir</span><span class="op" id="2802076">,</span>&nbsp;<span class="ident" id="2802078">name</span><span class="op" id="2802082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2802085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802088">if</span>&nbsp;<span class="ident" id="2802091">dir</span>&nbsp;<span class="op" id="2802095">!=</span>&nbsp;<span class="string" id="2802098">&#34;&#34;</span>&nbsp;<span class="op" id="2802101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2802105">name</span>&nbsp;<span class="op" id="2802110">=</span>&nbsp;<span class="ident" id="2802112">dir</span>&nbsp;<span class="op" id="2802116">+</span>&nbsp;<span class="string" id="2802118">&#34;/&#34;</span>&nbsp;<span class="op" id="2802122">+</span>&nbsp;<span class="ident" id="2802124">name</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2802130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2802133">buf</span><span class="op" id="2802136">,</span>&nbsp;<span class="ident" id="2802138">err</span>&nbsp;<span class="op" id="2802142">:=</span>&nbsp;<span class="ident" id="2802145">readFile</span><span class="op" id="2802153">(</span><span class="ident" id="2802154">name</span><span class="op" id="2802158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802161">if</span>&nbsp;<span class="ident" id="2802164">err</span>&nbsp;<span class="op" id="2802168">!=</span>&nbsp;<span class="builtintype" id="2802171">nil</span>&nbsp;<span class="op" id="2802175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802179">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2802187">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802190">return</span>&nbsp;<span class="ident" id="2802197">loadZoneData</span><span class="op" id="2802209">(</span><span class="ident" id="2802210">buf</span><span class="op" id="2802213">)</span><br>
<span class="lineno"></span><span class="op" id="2802215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2802218">//&nbsp;There&nbsp;are&nbsp;500+&nbsp;zoneinfo&nbsp;files.&nbsp;&nbsp;Rather&nbsp;than&nbsp;distribute&nbsp;them&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2802285">//&nbsp;individually,&nbsp;we&nbsp;ship&nbsp;them&nbsp;in&nbsp;an&nbsp;uncompressed&nbsp;zip&nbsp;file.</span><br>
<span class="lineno">215</span><span class="comment" id="2802344">//&nbsp;Used&nbsp;this&nbsp;way,&nbsp;the&nbsp;zip&nbsp;file&nbsp;format&nbsp;serves&nbsp;as&nbsp;a&nbsp;commonly&nbsp;readable</span><br>
<span class="lineno"></span><span class="comment" id="2802412">//&nbsp;container&nbsp;for&nbsp;the&nbsp;individual&nbsp;small&nbsp;files.&nbsp;&nbsp;We&nbsp;choose&nbsp;zip&nbsp;over&nbsp;tar</span><br>
<span class="lineno"></span><span class="comment" id="2802481">//&nbsp;because&nbsp;zip&nbsp;files&nbsp;have&nbsp;a&nbsp;contiguous&nbsp;table&nbsp;of&nbsp;contents,&nbsp;making</span><br>
<span class="lineno"></span><span class="comment" id="2802546">//&nbsp;individual&nbsp;file&nbsp;lookups&nbsp;faster,&nbsp;and&nbsp;because&nbsp;the&nbsp;per-file&nbsp;overhead</span><br>
<span class="lineno"></span><span class="comment" id="2802615">//&nbsp;in&nbsp;a&nbsp;zip&nbsp;file&nbsp;is&nbsp;considerably&nbsp;less&nbsp;than&nbsp;tar&#39;s&nbsp;512&nbsp;bytes.</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="2802676">//&nbsp;get4&nbsp;returns&nbsp;the&nbsp;little-endian&nbsp;32-bit&nbsp;value&nbsp;in&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="2802729">func</span>&nbsp;<span class="ident" id="2802734">get4</span><span class="op" id="2802738">(</span><span class="ident" id="2802739">b</span>&nbsp;<span class="op" id="2802741">[</span><span class="op" id="2802742">]</span><span class="builtintype" id="2802743">byte</span><span class="op" id="2802747">)</span>&nbsp;<span class="builtintype" id="2802749">int</span>&nbsp;<span class="op" id="2802753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802756">if</span>&nbsp;<span class="builtinfunc" id="2802759">len</span><span class="op" id="2802762">(</span><span class="ident" id="2802763">b</span><span class="op" id="2802764">)</span>&nbsp;<span class="op" id="2802766">&lt;</span>&nbsp;<span class="num" id="2802768">4</span>&nbsp;<span class="op" id="2802770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802774">return</span>&nbsp;<span class="num" id="2802781">0</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2802784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802787">return</span>&nbsp;<span class="builtintype" id="2802794">int</span><span class="op" id="2802797">(</span><span class="ident" id="2802798">b</span><span class="op" id="2802799">[</span><span class="num" id="2802800">0</span><span class="op" id="2802801">]</span><span class="op" id="2802802">)</span>&nbsp;<span class="op" id="2802804">|</span>&nbsp;<span class="builtintype" id="2802806">int</span><span class="op" id="2802809">(</span><span class="ident" id="2802810">b</span><span class="op" id="2802811">[</span><span class="num" id="2802812">1</span><span class="op" id="2802813">]</span><span class="op" id="2802814">)</span><span class="op" id="2802815">&lt;&lt;</span><span class="num" id="2802817">8</span>&nbsp;<span class="op" id="2802819">|</span>&nbsp;<span class="builtintype" id="2802821">int</span><span class="op" id="2802824">(</span><span class="ident" id="2802825">b</span><span class="op" id="2802826">[</span><span class="num" id="2802827">2</span><span class="op" id="2802828">]</span><span class="op" id="2802829">)</span><span class="op" id="2802830">&lt;&lt;</span><span class="num" id="2802832">16</span>&nbsp;<span class="op" id="2802835">|</span>&nbsp;<span class="builtintype" id="2802837">int</span><span class="op" id="2802840">(</span><span class="ident" id="2802841">b</span><span class="op" id="2802842">[</span><span class="num" id="2802843">3</span><span class="op" id="2802844">]</span><span class="op" id="2802845">)</span><span class="op" id="2802846">&lt;&lt;</span><span class="num" id="2802848">24</span><br>
<span class="lineno"></span><span class="op" id="2802851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2802854">//&nbsp;get2&nbsp;returns&nbsp;the&nbsp;little-endian&nbsp;16-bit&nbsp;value&nbsp;in&nbsp;b.</span><br>
<span class="lineno">230</span><span class="keyword" id="2802907">func</span>&nbsp;<span class="ident" id="2802912">get2</span><span class="op" id="2802916">(</span><span class="ident" id="2802917">b</span>&nbsp;<span class="op" id="2802919">[</span><span class="op" id="2802920">]</span><span class="builtintype" id="2802921">byte</span><span class="op" id="2802925">)</span>&nbsp;<span class="builtintype" id="2802927">int</span>&nbsp;<span class="op" id="2802931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802934">if</span>&nbsp;<span class="builtinfunc" id="2802937">len</span><span class="op" id="2802940">(</span><span class="ident" id="2802941">b</span><span class="op" id="2802942">)</span>&nbsp;<span class="op" id="2802944">&lt;</span>&nbsp;<span class="num" id="2802946">2</span>&nbsp;<span class="op" id="2802948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802952">return</span>&nbsp;<span class="num" id="2802959">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2802962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802965">return</span>&nbsp;<span class="builtintype" id="2802972">int</span><span class="op" id="2802975">(</span><span class="ident" id="2802976">b</span><span class="op" id="2802977">[</span><span class="num" id="2802978">0</span><span class="op" id="2802979">]</span><span class="op" id="2802980">)</span>&nbsp;<span class="op" id="2802982">|</span>&nbsp;<span class="builtintype" id="2802984">int</span><span class="op" id="2802987">(</span><span class="ident" id="2802988">b</span><span class="op" id="2802989">[</span><span class="num" id="2802990">1</span><span class="op" id="2802991">]</span><span class="op" id="2802992">)</span><span class="op" id="2802993">&lt;&lt;</span><span class="num" id="2802995">8</span><br>
<span class="lineno">235</span><span class="op" id="2802997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2803000">func</span>&nbsp;<span class="ident" id="2803005">loadZoneZip</span><span class="op" id="2803016">(</span><span class="ident" id="2803017">zipfile</span><span class="op" id="2803024">,</span>&nbsp;<span class="ident" id="2803026">name</span>&nbsp;<span class="builtintype" id="2803031">string</span><span class="op" id="2803037">)</span>&nbsp;<span class="op" id="2803039">(</span><span class="ident" id="2803040">l</span>&nbsp;<span class="op" id="2803042">*</span><span class="ident" id="2803043">Location</span><span class="op" id="2803051">,</span>&nbsp;<span class="ident" id="2803053">err</span>&nbsp;<span class="builtintype" id="2803057">error</span><span class="op" id="2803062">)</span>&nbsp;<span class="op" id="2803064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803067">fd</span><span class="op" id="2803069">,</span>&nbsp;<span class="ident" id="2803071">err</span>&nbsp;<span class="op" id="2803075">:=</span>&nbsp;<span class="ident" id="2803078">open</span><span class="op" id="2803082">(</span><span class="ident" id="2803083">zipfile</span><span class="op" id="2803090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803093">if</span>&nbsp;<span class="ident" id="2803096">err</span>&nbsp;<span class="op" id="2803100">!=</span>&nbsp;<span class="builtintype" id="2803103">nil</span>&nbsp;<span class="op" id="2803107">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803111">return</span>&nbsp;<span class="builtintype" id="2803118">nil</span><span class="op" id="2803121">,</span>&nbsp;<span class="ident" id="2803123">errors</span><span class="op" id="2803129">.</span><span class="ident" id="2803130">New</span><span class="op" id="2803133">(</span><span class="string" id="2803134">&#34;open&nbsp;&#34;</span>&nbsp;<span class="op" id="2803142">+</span>&nbsp;<span class="ident" id="2803144">zipfile</span>&nbsp;<span class="op" id="2803152">+</span>&nbsp;<span class="string" id="2803154">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="2803159">+</span>&nbsp;<span class="ident" id="2803161">err</span><span class="op" id="2803164">.</span><span class="ident" id="2803165">Error</span><span class="op" id="2803170">(</span><span class="op" id="2803171">)</span><span class="op" id="2803172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2803175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803178">defer</span>&nbsp;<span class="ident" id="2803184">closefd</span><span class="op" id="2803191">(</span><span class="ident" id="2803192">fd</span><span class="op" id="2803194">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803198">const</span>&nbsp;<span class="op" id="2803204">(</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803208">zecheader</span>&nbsp;<span class="op" id="2803218">=</span>&nbsp;<span class="num" id="2803220">0x06054b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803233">zcheader</span>&nbsp;&nbsp;<span class="op" id="2803243">=</span>&nbsp;<span class="num" id="2803245">0x02014b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803258">ztailsize</span>&nbsp;<span class="op" id="2803268">=</span>&nbsp;<span class="num" id="2803270">22</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803276">zheadersize</span>&nbsp;<span class="op" id="2803288">=</span>&nbsp;<span class="num" id="2803290">30</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803295">zheader</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2803307">=</span>&nbsp;<span class="num" id="2803309">0x04034b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2803321">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803325">buf</span>&nbsp;<span class="op" id="2803329">:=</span>&nbsp;<span class="builtinfunc" id="2803332">make</span><span class="op" id="2803336">(</span><span class="op" id="2803337">[</span><span class="op" id="2803338">]</span><span class="builtintype" id="2803339">byte</span><span class="op" id="2803343">,</span>&nbsp;<span class="ident" id="2803345">ztailsize</span><span class="op" id="2803354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803357">if</span>&nbsp;<span class="ident" id="2803360">err</span>&nbsp;<span class="op" id="2803364">:=</span>&nbsp;<span class="ident" id="2803367">preadn</span><span class="op" id="2803373">(</span><span class="ident" id="2803374">fd</span><span class="op" id="2803376">,</span>&nbsp;<span class="ident" id="2803378">buf</span><span class="op" id="2803381">,</span>&nbsp;<span class="op" id="2803383">-</span><span class="ident" id="2803384">ztailsize</span><span class="op" id="2803393">)</span><span class="op" id="2803394">;</span>&nbsp;<span class="ident" id="2803396">err</span>&nbsp;<span class="op" id="2803400">!=</span>&nbsp;<span class="builtintype" id="2803403">nil</span>&nbsp;<span class="op" id="2803407">||</span>&nbsp;<span class="ident" id="2803410">get4</span><span class="op" id="2803414">(</span><span class="ident" id="2803415">buf</span><span class="op" id="2803418">)</span>&nbsp;<span class="op" id="2803420">!=</span>&nbsp;<span class="ident" id="2803423">zecheader</span>&nbsp;<span class="op" id="2803433">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803437">return</span>&nbsp;<span class="builtintype" id="2803444">nil</span><span class="op" id="2803447">,</span>&nbsp;<span class="ident" id="2803449">errors</span><span class="op" id="2803455">.</span><span class="ident" id="2803456">New</span><span class="op" id="2803459">(</span><span class="string" id="2803460">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2803480">+</span>&nbsp;<span class="ident" id="2803482">zipfile</span><span class="op" id="2803489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2803492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803495">n</span>&nbsp;<span class="op" id="2803497">:=</span>&nbsp;<span class="ident" id="2803500">get2</span><span class="op" id="2803504">(</span><span class="ident" id="2803505">buf</span><span class="op" id="2803508">[</span><span class="num" id="2803509">10</span><span class="op" id="2803511">:</span><span class="op" id="2803512">]</span><span class="op" id="2803513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803516">size</span>&nbsp;<span class="op" id="2803521">:=</span>&nbsp;<span class="ident" id="2803524">get4</span><span class="op" id="2803528">(</span><span class="ident" id="2803529">buf</span><span class="op" id="2803532">[</span><span class="num" id="2803533">12</span><span class="op" id="2803535">:</span><span class="op" id="2803536">]</span><span class="op" id="2803537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803540">off</span>&nbsp;<span class="op" id="2803544">:=</span>&nbsp;<span class="ident" id="2803547">get4</span><span class="op" id="2803551">(</span><span class="ident" id="2803552">buf</span><span class="op" id="2803555">[</span><span class="num" id="2803556">16</span><span class="op" id="2803558">:</span><span class="op" id="2803559">]</span><span class="op" id="2803560">)</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803564">buf</span>&nbsp;<span class="op" id="2803568">=</span>&nbsp;<span class="builtinfunc" id="2803570">make</span><span class="op" id="2803574">(</span><span class="op" id="2803575">[</span><span class="op" id="2803576">]</span><span class="builtintype" id="2803577">byte</span><span class="op" id="2803581">,</span>&nbsp;<span class="ident" id="2803583">size</span><span class="op" id="2803587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803590">if</span>&nbsp;<span class="ident" id="2803593">err</span>&nbsp;<span class="op" id="2803597">:=</span>&nbsp;<span class="ident" id="2803600">preadn</span><span class="op" id="2803606">(</span><span class="ident" id="2803607">fd</span><span class="op" id="2803609">,</span>&nbsp;<span class="ident" id="2803611">buf</span><span class="op" id="2803614">,</span>&nbsp;<span class="ident" id="2803616">off</span><span class="op" id="2803619">)</span><span class="op" id="2803620">;</span>&nbsp;<span class="ident" id="2803622">err</span>&nbsp;<span class="op" id="2803626">!=</span>&nbsp;<span class="builtintype" id="2803629">nil</span>&nbsp;<span class="op" id="2803633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803637">return</span>&nbsp;<span class="builtintype" id="2803644">nil</span><span class="op" id="2803647">,</span>&nbsp;<span class="ident" id="2803649">errors</span><span class="op" id="2803655">.</span><span class="ident" id="2803656">New</span><span class="op" id="2803659">(</span><span class="string" id="2803660">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2803680">+</span>&nbsp;<span class="ident" id="2803682">zipfile</span><span class="op" id="2803689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2803692">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803696">for</span>&nbsp;<span class="ident" id="2803700">i</span>&nbsp;<span class="op" id="2803702">:=</span>&nbsp;<span class="num" id="2803705">0</span><span class="op" id="2803706">;</span>&nbsp;<span class="ident" id="2803708">i</span>&nbsp;<span class="op" id="2803710">&lt;</span>&nbsp;<span class="ident" id="2803712">n</span><span class="op" id="2803713">;</span>&nbsp;<span class="ident" id="2803715">i</span><span class="op" id="2803716">++</span>&nbsp;<span class="op" id="2803719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2803723">//&nbsp;zip&nbsp;entry&nbsp;layout:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2803746">//&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;magic[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2803762">//&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;madevers[1]</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2803781">//&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;madeos[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2803798">//&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;extvers[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2803816">//&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;extos[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2803832">//&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp;flags[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2803848">//&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;meth[2]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2803864">//&nbsp;&nbsp;&nbsp;&nbsp;12&nbsp;&nbsp;&nbsp;&nbsp;modtime[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2803883">//&nbsp;&nbsp;&nbsp;&nbsp;14&nbsp;&nbsp;&nbsp;&nbsp;moddate[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2803902">//&nbsp;&nbsp;&nbsp;&nbsp;16&nbsp;&nbsp;&nbsp;&nbsp;crc[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2803917">//&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;csize[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2803934">//&nbsp;&nbsp;&nbsp;&nbsp;24&nbsp;&nbsp;&nbsp;&nbsp;uncsize[4]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2803953">//&nbsp;&nbsp;&nbsp;&nbsp;28&nbsp;&nbsp;&nbsp;&nbsp;namelen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2803972">//&nbsp;&nbsp;&nbsp;&nbsp;30&nbsp;&nbsp;&nbsp;&nbsp;xlen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2803988">//&nbsp;&nbsp;&nbsp;&nbsp;32&nbsp;&nbsp;&nbsp;&nbsp;fclen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804005">//&nbsp;&nbsp;&nbsp;&nbsp;34&nbsp;&nbsp;&nbsp;&nbsp;disknum[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804024">//&nbsp;&nbsp;&nbsp;&nbsp;36&nbsp;&nbsp;&nbsp;&nbsp;iattr[2]</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804041">//&nbsp;&nbsp;&nbsp;&nbsp;38&nbsp;&nbsp;&nbsp;&nbsp;eattr[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804058">//&nbsp;&nbsp;&nbsp;&nbsp;42&nbsp;&nbsp;&nbsp;&nbsp;off[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804073">//&nbsp;&nbsp;&nbsp;&nbsp;46&nbsp;&nbsp;&nbsp;&nbsp;name[namelen]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804095">//&nbsp;&nbsp;&nbsp;&nbsp;46+namelen+xlen+fclen&nbsp;-&nbsp;next&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804136">//</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804141">if</span>&nbsp;<span class="ident" id="2804144">get4</span><span class="op" id="2804148">(</span><span class="ident" id="2804149">buf</span><span class="op" id="2804152">)</span>&nbsp;<span class="op" id="2804154">!=</span>&nbsp;<span class="ident" id="2804157">zcheader</span>&nbsp;<span class="op" id="2804166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804171">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2804179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2804183">meth</span>&nbsp;<span class="op" id="2804188">:=</span>&nbsp;<span class="ident" id="2804191">get2</span><span class="op" id="2804195">(</span><span class="ident" id="2804196">buf</span><span class="op" id="2804199">[</span><span class="num" id="2804200">10</span><span class="op" id="2804202">:</span><span class="op" id="2804203">]</span><span class="op" id="2804204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2804208">size</span>&nbsp;<span class="op" id="2804213">:=</span>&nbsp;<span class="ident" id="2804216">get4</span><span class="op" id="2804220">(</span><span class="ident" id="2804221">buf</span><span class="op" id="2804224">[</span><span class="num" id="2804225">24</span><span class="op" id="2804227">:</span><span class="op" id="2804228">]</span><span class="op" id="2804229">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2804233">namelen</span>&nbsp;<span class="op" id="2804241">:=</span>&nbsp;<span class="ident" id="2804244">get2</span><span class="op" id="2804248">(</span><span class="ident" id="2804249">buf</span><span class="op" id="2804252">[</span><span class="num" id="2804253">28</span><span class="op" id="2804255">:</span><span class="op" id="2804256">]</span><span class="op" id="2804257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2804261">xlen</span>&nbsp;<span class="op" id="2804266">:=</span>&nbsp;<span class="ident" id="2804269">get2</span><span class="op" id="2804273">(</span><span class="ident" id="2804274">buf</span><span class="op" id="2804277">[</span><span class="num" id="2804278">30</span><span class="op" id="2804280">:</span><span class="op" id="2804281">]</span><span class="op" id="2804282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2804286">fclen</span>&nbsp;<span class="op" id="2804292">:=</span>&nbsp;<span class="ident" id="2804295">get2</span><span class="op" id="2804299">(</span><span class="ident" id="2804300">buf</span><span class="op" id="2804303">[</span><span class="num" id="2804304">32</span><span class="op" id="2804306">:</span><span class="op" id="2804307">]</span><span class="op" id="2804308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2804312">off</span>&nbsp;<span class="op" id="2804316">:=</span>&nbsp;<span class="ident" id="2804319">get4</span><span class="op" id="2804323">(</span><span class="ident" id="2804324">buf</span><span class="op" id="2804327">[</span><span class="num" id="2804328">42</span><span class="op" id="2804330">:</span><span class="op" id="2804331">]</span><span class="op" id="2804332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2804336">zname</span>&nbsp;<span class="op" id="2804342">:=</span>&nbsp;<span class="ident" id="2804345">buf</span><span class="op" id="2804348">[</span><span class="num" id="2804349">46</span>&nbsp;<span class="op" id="2804352">:</span>&nbsp;<span class="num" id="2804354">46</span><span class="op" id="2804356">+</span><span class="ident" id="2804357">namelen</span><span class="op" id="2804364">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2804368">buf</span>&nbsp;<span class="op" id="2804372">=</span>&nbsp;<span class="ident" id="2804374">buf</span><span class="op" id="2804377">[</span><span class="num" id="2804378">46</span><span class="op" id="2804380">+</span><span class="ident" id="2804381">namelen</span><span class="op" id="2804388">+</span><span class="ident" id="2804389">xlen</span><span class="op" id="2804393">+</span><span class="ident" id="2804394">fclen</span><span class="op" id="2804399">:</span><span class="op" id="2804400">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804404">if</span>&nbsp;<span class="builtintype" id="2804407">string</span><span class="op" id="2804413">(</span><span class="ident" id="2804414">zname</span><span class="op" id="2804419">)</span>&nbsp;<span class="op" id="2804421">!=</span>&nbsp;<span class="ident" id="2804424">name</span>&nbsp;<span class="op" id="2804429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804434">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2804445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804449">if</span>&nbsp;<span class="ident" id="2804452">meth</span>&nbsp;<span class="op" id="2804457">!=</span>&nbsp;<span class="num" id="2804460">0</span>&nbsp;<span class="op" id="2804462">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804467">return</span>&nbsp;<span class="builtintype" id="2804474">nil</span><span class="op" id="2804477">,</span>&nbsp;<span class="ident" id="2804479">errors</span><span class="op" id="2804485">.</span><span class="ident" id="2804486">New</span><span class="op" id="2804489">(</span><span class="string" id="2804490">&#34;unsupported&nbsp;compression&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="2804521">+</span>&nbsp;<span class="ident" id="2804523">name</span>&nbsp;<span class="op" id="2804528">+</span>&nbsp;<span class="string" id="2804530">&#34;&nbsp;in&nbsp;&#34;</span>&nbsp;<span class="op" id="2804537">+</span>&nbsp;<span class="ident" id="2804539">zipfile</span><span class="op" id="2804546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2804550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804555">//&nbsp;zip&nbsp;per-file&nbsp;header&nbsp;layout:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804588">//&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;magic[4]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804604">//&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;extvers[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804622">//&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;extos[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804638">//&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;flags[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804654">//&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp;meth[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804669">//&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;modtime[2]</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804688">//&nbsp;&nbsp;&nbsp;&nbsp;12&nbsp;&nbsp;&nbsp;&nbsp;moddate[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804707">//&nbsp;&nbsp;&nbsp;&nbsp;14&nbsp;&nbsp;&nbsp;&nbsp;crc[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804722">//&nbsp;&nbsp;&nbsp;&nbsp;18&nbsp;&nbsp;&nbsp;&nbsp;csize[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804739">//&nbsp;&nbsp;&nbsp;&nbsp;22&nbsp;&nbsp;&nbsp;&nbsp;uncsize[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804758">//&nbsp;&nbsp;&nbsp;&nbsp;26&nbsp;&nbsp;&nbsp;&nbsp;namelen[2]</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804777">//&nbsp;&nbsp;&nbsp;&nbsp;28&nbsp;&nbsp;&nbsp;&nbsp;xlen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804793">//&nbsp;&nbsp;&nbsp;&nbsp;30&nbsp;&nbsp;&nbsp;&nbsp;name[namelen]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804815">//&nbsp;&nbsp;&nbsp;&nbsp;30+namelen+xlen&nbsp;-&nbsp;file&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804848">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2804853">buf</span>&nbsp;<span class="op" id="2804857">=</span>&nbsp;<span class="builtinfunc" id="2804859">make</span><span class="op" id="2804863">(</span><span class="op" id="2804864">[</span><span class="op" id="2804865">]</span><span class="builtintype" id="2804866">byte</span><span class="op" id="2804870">,</span>&nbsp;<span class="ident" id="2804872">zheadersize</span><span class="op" id="2804883">+</span><span class="ident" id="2804884">namelen</span><span class="op" id="2804891">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804895">if</span>&nbsp;<span class="ident" id="2804898">err</span>&nbsp;<span class="op" id="2804902">:=</span>&nbsp;<span class="ident" id="2804905">preadn</span><span class="op" id="2804911">(</span><span class="ident" id="2804912">fd</span><span class="op" id="2804914">,</span>&nbsp;<span class="ident" id="2804916">buf</span><span class="op" id="2804919">,</span>&nbsp;<span class="ident" id="2804921">off</span><span class="op" id="2804924">)</span><span class="op" id="2804925">;</span>&nbsp;<span class="ident" id="2804927">err</span>&nbsp;<span class="op" id="2804931">!=</span>&nbsp;<span class="builtintype" id="2804934">nil</span>&nbsp;<span class="op" id="2804938">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2804944">get4</span><span class="op" id="2804948">(</span><span class="ident" id="2804949">buf</span><span class="op" id="2804952">)</span>&nbsp;<span class="op" id="2804954">!=</span>&nbsp;<span class="ident" id="2804957">zheader</span>&nbsp;<span class="op" id="2804965">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2804971">get2</span><span class="op" id="2804975">(</span><span class="ident" id="2804976">buf</span><span class="op" id="2804979">[</span><span class="num" id="2804980">8</span><span class="op" id="2804981">:</span><span class="op" id="2804982">]</span><span class="op" id="2804983">)</span>&nbsp;<span class="op" id="2804985">!=</span>&nbsp;<span class="ident" id="2804988">meth</span>&nbsp;<span class="op" id="2804993">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2804999">get2</span><span class="op" id="2805003">(</span><span class="ident" id="2805004">buf</span><span class="op" id="2805007">[</span><span class="num" id="2805008">26</span><span class="op" id="2805010">:</span><span class="op" id="2805011">]</span><span class="op" id="2805012">)</span>&nbsp;<span class="op" id="2805014">!=</span>&nbsp;<span class="ident" id="2805017">namelen</span>&nbsp;<span class="op" id="2805025">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2805031">string</span><span class="op" id="2805037">(</span><span class="ident" id="2805038">buf</span><span class="op" id="2805041">[</span><span class="num" id="2805042">30</span><span class="op" id="2805044">:</span><span class="num" id="2805045">30</span><span class="op" id="2805047">+</span><span class="ident" id="2805048">namelen</span><span class="op" id="2805055">]</span><span class="op" id="2805056">)</span>&nbsp;<span class="op" id="2805058">!=</span>&nbsp;<span class="ident" id="2805061">name</span>&nbsp;<span class="op" id="2805066">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805071">return</span>&nbsp;<span class="builtintype" id="2805078">nil</span><span class="op" id="2805081">,</span>&nbsp;<span class="ident" id="2805083">errors</span><span class="op" id="2805089">.</span><span class="ident" id="2805090">New</span><span class="op" id="2805093">(</span><span class="string" id="2805094">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2805114">+</span>&nbsp;<span class="ident" id="2805116">zipfile</span><span class="op" id="2805123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2805127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2805131">xlen</span>&nbsp;<span class="op" id="2805136">=</span>&nbsp;<span class="ident" id="2805138">get2</span><span class="op" id="2805142">(</span><span class="ident" id="2805143">buf</span><span class="op" id="2805146">[</span><span class="num" id="2805147">28</span><span class="op" id="2805149">:</span><span class="op" id="2805150">]</span><span class="op" id="2805151">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2805156">buf</span>&nbsp;<span class="op" id="2805160">=</span>&nbsp;<span class="builtinfunc" id="2805162">make</span><span class="op" id="2805166">(</span><span class="op" id="2805167">[</span><span class="op" id="2805168">]</span><span class="builtintype" id="2805169">byte</span><span class="op" id="2805173">,</span>&nbsp;<span class="ident" id="2805175">size</span><span class="op" id="2805179">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805183">if</span>&nbsp;<span class="ident" id="2805186">err</span>&nbsp;<span class="op" id="2805190">:=</span>&nbsp;<span class="ident" id="2805193">preadn</span><span class="op" id="2805199">(</span><span class="ident" id="2805200">fd</span><span class="op" id="2805202">,</span>&nbsp;<span class="ident" id="2805204">buf</span><span class="op" id="2805207">,</span>&nbsp;<span class="ident" id="2805209">off</span><span class="op" id="2805212">+</span><span class="num" id="2805213">30</span><span class="op" id="2805215">+</span><span class="ident" id="2805216">namelen</span><span class="op" id="2805223">+</span><span class="ident" id="2805224">xlen</span><span class="op" id="2805228">)</span><span class="op" id="2805229">;</span>&nbsp;<span class="ident" id="2805231">err</span>&nbsp;<span class="op" id="2805235">!=</span>&nbsp;<span class="builtintype" id="2805238">nil</span>&nbsp;<span class="op" id="2805242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805247">return</span>&nbsp;<span class="builtintype" id="2805254">nil</span><span class="op" id="2805257">,</span>&nbsp;<span class="ident" id="2805259">errors</span><span class="op" id="2805265">.</span><span class="ident" id="2805266">New</span><span class="op" id="2805269">(</span><span class="string" id="2805270">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2805290">+</span>&nbsp;<span class="ident" id="2805292">zipfile</span><span class="op" id="2805299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2805303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805308">return</span>&nbsp;<span class="ident" id="2805315">loadZoneData</span><span class="op" id="2805327">(</span><span class="ident" id="2805328">buf</span><span class="op" id="2805331">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2805334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805338">return</span>&nbsp;<span class="builtintype" id="2805345">nil</span><span class="op" id="2805348">,</span>&nbsp;<span class="ident" id="2805350">errors</span><span class="op" id="2805356">.</span><span class="ident" id="2805357">New</span><span class="op" id="2805360">(</span><span class="string" id="2805361">&#34;cannot&nbsp;find&nbsp;&#34;</span>&nbsp;<span class="op" id="2805376">+</span>&nbsp;<span class="ident" id="2805378">name</span>&nbsp;<span class="op" id="2805383">+</span>&nbsp;<span class="string" id="2805385">&#34;&nbsp;in&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2805401">+</span>&nbsp;<span class="ident" id="2805403">zipfile</span><span class="op" id="2805410">)</span><br>
<span class="lineno"></span><span class="op" id="2805412">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
