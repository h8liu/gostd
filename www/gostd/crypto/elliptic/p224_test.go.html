<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6430379">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6430435">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6430489">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6430540">package</span>&nbsp;<span class="ident" id="6430548">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6430558">import</span>&nbsp;<span class="op" id="6430565">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6430568">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6430580">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="6430590">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6430593">var</span>&nbsp;<span class="ident" id="6430597">toFromBigTests</span>&nbsp;<span class="op" id="6430612">=</span>&nbsp;<span class="op" id="6430614">[</span><span class="op" id="6430615">]</span><span class="builtintype" id="6430616">string</span><span class="op" id="6430622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6430625">&#34;0&#34;</span><span class="op" id="6430628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6430631">&#34;1&#34;</span><span class="op" id="6430634">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6430637">&#34;23&#34;</span><span class="op" id="6430641">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6430644">&#34;b70e0cb46bb4bf7f321390b94a03c1d356c01122343280d6105c1d21&#34;</span><span class="op" id="6430702">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6430705">&#34;706a46d476dcb76798e6046d89474788d164c18032d268fd10704fa6&#34;</span><span class="op" id="6430763">,</span><br>
<span class="lineno"></span><span class="op" id="6430765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="6430768">func</span>&nbsp;<span class="ident" id="6430773">p224AlternativeToBig</span><span class="op" id="6430793">(</span><span class="ident" id="6430794">in</span>&nbsp;<span class="op" id="6430797">*</span><span class="ident" id="6430798">p224FieldElement</span><span class="op" id="6430814">)</span>&nbsp;<span class="op" id="6430816">*</span><span class="ident" id="6430817">big</span><span class="op" id="6430820">.</span><span class="ident" id="6430821">Int</span>&nbsp;<span class="op" id="6430825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6430828">ret</span>&nbsp;<span class="op" id="6430832">:=</span>&nbsp;<span class="builtinfunc" id="6430835">new</span><span class="op" id="6430838">(</span><span class="ident" id="6430839">big</span><span class="op" id="6430842">.</span><span class="ident" id="6430843">Int</span><span class="op" id="6430846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6430849">tmp</span>&nbsp;<span class="op" id="6430853">:=</span>&nbsp;<span class="builtinfunc" id="6430856">new</span><span class="op" id="6430859">(</span><span class="ident" id="6430860">big</span><span class="op" id="6430863">.</span><span class="ident" id="6430864">Int</span><span class="op" id="6430867">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6430871">for</span>&nbsp;<span class="ident" id="6430875">i</span>&nbsp;<span class="op" id="6430877">:=</span>&nbsp;<span class="builtintype" id="6430880">uint</span><span class="op" id="6430884">(</span><span class="num" id="6430885">0</span><span class="op" id="6430886">)</span><span class="op" id="6430887">;</span>&nbsp;<span class="ident" id="6430889">i</span>&nbsp;<span class="op" id="6430891">&lt;</span>&nbsp;<span class="num" id="6430893">8</span><span class="op" id="6430894">;</span>&nbsp;<span class="ident" id="6430896">i</span><span class="op" id="6430897">++</span>&nbsp;<span class="op" id="6430900">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6430904">tmp</span><span class="op" id="6430907">.</span><span class="ident" id="6430908">SetInt64</span><span class="op" id="6430916">(</span><span class="ident" id="6430917">int64</span><span class="op" id="6430922">(</span><span class="ident" id="6430923">in</span><span class="op" id="6430925">[</span><span class="ident" id="6430926">i</span><span class="op" id="6430927">]</span><span class="op" id="6430928">)</span><span class="op" id="6430929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6430933">tmp</span><span class="op" id="6430936">.</span><span class="ident" id="6430937">Lsh</span><span class="op" id="6430940">(</span><span class="ident" id="6430941">tmp</span><span class="op" id="6430944">,</span>&nbsp;<span class="num" id="6430946">28</span><span class="op" id="6430948">*</span><span class="ident" id="6430949">i</span><span class="op" id="6430950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6430954">ret</span><span class="op" id="6430957">.</span><span class="ident" id="6430958">Add</span><span class="op" id="6430961">(</span><span class="ident" id="6430962">ret</span><span class="op" id="6430965">,</span>&nbsp;<span class="ident" id="6430967">tmp</span><span class="op" id="6430970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6430973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6430976">ret</span><span class="op" id="6430979">.</span><span class="ident" id="6430980">Mod</span><span class="op" id="6430983">(</span><span class="ident" id="6430984">ret</span><span class="op" id="6430987">,</span>&nbsp;<span class="ident" id="6430989">p224</span><span class="op" id="6430993">.</span><span class="ident" id="6430994">P</span><span class="op" id="6430995">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6430998">return</span>&nbsp;<span class="ident" id="6431005">ret</span><br>
<span class="lineno"></span><span class="op" id="6431009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6431012">func</span>&nbsp;<span class="ident" id="6431017">TestToFromBig</span><span class="op" id="6431030">(</span><span class="ident" id="6431031">t</span>&nbsp;<span class="op" id="6431033">*</span><span class="ident" id="6431034">testing</span><span class="op" id="6431041">.</span><span class="ident" id="6431042">T</span><span class="op" id="6431043">)</span>&nbsp;<span class="op" id="6431045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6431048">for</span>&nbsp;<span class="ident" id="6431052">i</span><span class="op" id="6431053">,</span>&nbsp;<span class="ident" id="6431055">test</span>&nbsp;<span class="op" id="6431060">:=</span>&nbsp;<span class="keyword" id="6431063">range</span>&nbsp;<span class="ident" id="6431069">toFromBigTests</span>&nbsp;<span class="op" id="6431084">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6431088">n</span><span class="op" id="6431089">,</span>&nbsp;<span class="ident" id="6431091">_</span>&nbsp;<span class="op" id="6431093">:=</span>&nbsp;<span class="builtinfunc" id="6431096">new</span><span class="op" id="6431099">(</span><span class="ident" id="6431100">big</span><span class="op" id="6431103">.</span><span class="ident" id="6431104">Int</span><span class="op" id="6431107">)</span><span class="op" id="6431108">.</span><span class="ident" id="6431109">SetString</span><span class="op" id="6431118">(</span><span class="ident" id="6431119">test</span><span class="op" id="6431123">,</span>&nbsp;<span class="num" id="6431125">16</span><span class="op" id="6431127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6431131">var</span>&nbsp;<span class="ident" id="6431135">x</span>&nbsp;<span class="ident" id="6431137">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6431156">p224FromBig</span><span class="op" id="6431167">(</span><span class="op" id="6431168">&amp;</span><span class="ident" id="6431169">x</span><span class="op" id="6431170">,</span>&nbsp;<span class="ident" id="6431172">n</span><span class="op" id="6431173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6431177">m</span>&nbsp;<span class="op" id="6431179">:=</span>&nbsp;<span class="ident" id="6431182">p224ToBig</span><span class="op" id="6431191">(</span><span class="op" id="6431192">&amp;</span><span class="ident" id="6431193">x</span><span class="op" id="6431194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6431198">if</span>&nbsp;<span class="ident" id="6431201">n</span><span class="op" id="6431202">.</span><span class="ident" id="6431203">Cmp</span><span class="op" id="6431206">(</span><span class="ident" id="6431207">m</span><span class="op" id="6431208">)</span>&nbsp;<span class="op" id="6431210">!=</span>&nbsp;<span class="num" id="6431213">0</span>&nbsp;<span class="op" id="6431215">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6431220">t</span><span class="op" id="6431221">.</span><span class="ident" id="6431222">Errorf</span><span class="op" id="6431228">(</span><span class="string" id="6431229">&#34;#%d:&nbsp;%x&nbsp;!=&nbsp;%x&#34;</span><span class="op" id="6431244">,</span>&nbsp;<span class="ident" id="6431246">i</span><span class="op" id="6431247">,</span>&nbsp;<span class="ident" id="6431249">n</span><span class="op" id="6431250">,</span>&nbsp;<span class="ident" id="6431252">m</span><span class="op" id="6431253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6431257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6431261">q</span>&nbsp;<span class="op" id="6431263">:=</span>&nbsp;<span class="ident" id="6431266">p224AlternativeToBig</span><span class="op" id="6431286">(</span><span class="op" id="6431287">&amp;</span><span class="ident" id="6431288">x</span><span class="op" id="6431289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6431293">if</span>&nbsp;<span class="ident" id="6431296">n</span><span class="op" id="6431297">.</span><span class="ident" id="6431298">Cmp</span><span class="op" id="6431301">(</span><span class="ident" id="6431302">q</span><span class="op" id="6431303">)</span>&nbsp;<span class="op" id="6431305">!=</span>&nbsp;<span class="num" id="6431308">0</span>&nbsp;<span class="op" id="6431310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6431315">t</span><span class="op" id="6431316">.</span><span class="ident" id="6431317">Errorf</span><span class="op" id="6431323">(</span><span class="string" id="6431324">&#34;#%d:&nbsp;%x&nbsp;!=&nbsp;%x&nbsp;(alternative)&#34;</span><span class="op" id="6431353">,</span>&nbsp;<span class="ident" id="6431355">i</span><span class="op" id="6431356">,</span>&nbsp;<span class="ident" id="6431358">n</span><span class="op" id="6431359">,</span>&nbsp;<span class="ident" id="6431361">m</span><span class="op" id="6431362">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6431366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6431369">}</span><br>
<span class="lineno"></span><span class="op" id="6431371">}</span>
</div>
</body>
</html>
