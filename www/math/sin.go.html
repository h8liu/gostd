<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2079943">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2079998">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2080052">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2080103">package</span>&nbsp;<span class="ident" id="2080111">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2080117">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;sine&nbsp;and&nbsp;cosine.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2080157">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2080217">//&nbsp;below&nbsp;were&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cmath/sin.c,</span><br>
<span class="lineno"></span><span class="comment" id="2080281">//&nbsp;available&nbsp;from&nbsp;http://www.netlib.org/cephes/cmath.tgz.</span><br>
<span class="lineno"></span><span class="comment" id="2080339">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2080397">//</span><br>
<span class="lineno"></span><span class="comment" id="2080400">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin.c</span><br>
<span class="lineno"></span><span class="comment" id="2080414">//</span><br>
<span class="lineno"></span><span class="comment" id="2080417">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;sine</span><br>
<span class="lineno"></span><span class="comment" id="2080439">//</span><br>
<span class="lineno">20</span><span class="comment" id="2080442">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2080455">//</span><br>
<span class="lineno"></span><span class="comment" id="2080458">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;sin();</span><br>
<span class="lineno"></span><span class="comment" id="2080481">//&nbsp;y&nbsp;=&nbsp;sin(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="2080498">//</span><br>
<span class="lineno">25</span><span class="comment" id="2080501">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2080517">//</span><br>
<span class="lineno"></span><span class="comment" id="2080520">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="2080597">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno"></span><span class="comment" id="2080667">//</span><br>
<span class="lineno">30</span><span class="comment" id="2080670">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="2080726">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;sine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2080776">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2080804">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;cosine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2080858">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno">35</span><span class="comment" id="2080886">//</span><br>
<span class="lineno"></span><span class="comment" id="2080889">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2080902">//</span><br>
<span class="lineno"></span><span class="comment" id="2080905">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="2080945">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="2081004">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;150000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.8e-18</span><br>
<span class="lineno"></span><span class="comment" id="2081065">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="2081126">//</span><br>
<span class="lineno"></span><span class="comment" id="2081129">//&nbsp;Partial&nbsp;loss&nbsp;of&nbsp;accuracy&nbsp;begins&nbsp;to&nbsp;occur&nbsp;at&nbsp;x&nbsp;=&nbsp;2**30&nbsp;=&nbsp;1.074e9.&nbsp;&nbsp;The&nbsp;loss</span><br>
<span class="lineno"></span><span class="comment" id="2081207">//&nbsp;is&nbsp;not&nbsp;gradual,&nbsp;but&nbsp;jumps&nbsp;suddenly&nbsp;to&nbsp;about&nbsp;1&nbsp;part&nbsp;in&nbsp;10e7.&nbsp;&nbsp;Results&nbsp;may</span><br>
<span class="lineno">45</span><span class="comment" id="2081283">//&nbsp;be&nbsp;meaningless&nbsp;for&nbsp;x&nbsp;&gt;&nbsp;2**49&nbsp;=&nbsp;5.6e14.</span><br>
<span class="lineno"></span><span class="comment" id="2081325">//</span><br>
<span class="lineno"></span><span class="comment" id="2081328">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos.c</span><br>
<span class="lineno"></span><span class="comment" id="2081342">//</span><br>
<span class="lineno"></span><span class="comment" id="2081345">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;cosine</span><br>
<span class="lineno">50</span><span class="comment" id="2081369">//</span><br>
<span class="lineno"></span><span class="comment" id="2081372">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2081385">//</span><br>
<span class="lineno"></span><span class="comment" id="2081388">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;cos();</span><br>
<span class="lineno"></span><span class="comment" id="2081411">//&nbsp;y&nbsp;=&nbsp;cos(&nbsp;x&nbsp;);</span><br>
<span class="lineno">55</span><span class="comment" id="2081428">//</span><br>
<span class="lineno"></span><span class="comment" id="2081431">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2081447">//</span><br>
<span class="lineno"></span><span class="comment" id="2081450">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="2081527">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno">60</span><span class="comment" id="2081597">//</span><br>
<span class="lineno"></span><span class="comment" id="2081600">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="2081656">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;cosine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2081708">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2081736">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;sine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno">65</span><span class="comment" id="2081788">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2081816">//</span><br>
<span class="lineno"></span><span class="comment" id="2081819">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2081832">//</span><br>
<span class="lineno"></span><span class="comment" id="2081835">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno">70</span><span class="comment" id="2081875">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="2081934">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="2081995">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,+1.07e9&nbsp;&nbsp;&nbsp;17000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-18</span><br>
<span class="lineno"></span><span class="comment" id="2082056">//</span><br>
<span class="lineno"></span><span class="comment" id="2082059">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno">75</span><span class="comment" id="2082107">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="2082171">//</span><br>
<span class="lineno"></span><span class="comment" id="2082174">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="2082235">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2082305">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno">80</span><span class="comment" id="2082380">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2082447">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="2082520">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2082592">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="2082606">//</span><br>
<span class="lineno">85</span><span class="comment" id="2082609">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2082675">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="2082741">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="2082754">//</span><br>
<span class="lineno"></span><span class="comment" id="2082757">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">90</span><span class="comment" id="2082781">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2082811">//&nbsp;sin&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="2082831">var</span>&nbsp;<span class="ident" id="2082835">_sin</span>&nbsp;<span class="op" id="2082840">=</span>&nbsp;<span class="op" id="2082842">[</span><span class="op" id="2082843">...</span><span class="op" id="2082846">]</span><span class="builtintype" id="2082847">float64</span><span class="op" id="2082854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2082857">1.58962301576546568060E-10</span><span class="op" id="2082883">,</span>&nbsp;<span class="comment" id="2082885">//&nbsp;0x3de5d8fd1fd19ccd</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2082908">-</span><span class="num" id="2082909">2.50507477628578072866E-8</span><span class="op" id="2082934">,</span>&nbsp;<span class="comment" id="2082936">//&nbsp;0xbe5ae5e5a9291f5d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2082959">2.75573136213857245213E-6</span><span class="op" id="2082984">,</span>&nbsp;&nbsp;<span class="comment" id="2082987">//&nbsp;0x3ec71de3567d48a1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2083010">-</span><span class="num" id="2083011">1.98412698295895385996E-4</span><span class="op" id="2083036">,</span>&nbsp;<span class="comment" id="2083038">//&nbsp;0xbf2a01a019bfdf03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2083061">8.33333333332211858878E-3</span><span class="op" id="2083086">,</span>&nbsp;&nbsp;<span class="comment" id="2083089">//&nbsp;0x3f8111111110f7d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2083112">-</span><span class="num" id="2083113">1.66666666666666307295E-1</span><span class="op" id="2083138">,</span>&nbsp;<span class="comment" id="2083140">//&nbsp;0xbfc5555555555548</span><br>
<span class="lineno">100</span><span class="op" id="2083162">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2083165">//&nbsp;cos&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="2083185">var</span>&nbsp;<span class="ident" id="2083189">_cos</span>&nbsp;<span class="op" id="2083194">=</span>&nbsp;<span class="op" id="2083196">[</span><span class="op" id="2083197">...</span><span class="op" id="2083200">]</span><span class="builtintype" id="2083201">float64</span><span class="op" id="2083208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2083211">-</span><span class="num" id="2083212">1.13585365213876817300E-11</span><span class="op" id="2083238">,</span>&nbsp;<span class="comment" id="2083240">//&nbsp;0xbda8fa49a0861a9b</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2083263">2.08757008419747316778E-9</span><span class="op" id="2083288">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2083292">//&nbsp;0x3e21ee9d7b4e3f05</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2083315">-</span><span class="num" id="2083316">2.75573141792967388112E-7</span><span class="op" id="2083341">,</span>&nbsp;&nbsp;<span class="comment" id="2083344">//&nbsp;0xbe927e4f7eac4bc6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2083367">2.48015872888517045348E-5</span><span class="op" id="2083392">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2083396">//&nbsp;0x3efa01a019c844f5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2083419">-</span><span class="num" id="2083420">1.38888888888730564116E-3</span><span class="op" id="2083445">,</span>&nbsp;&nbsp;<span class="comment" id="2083448">//&nbsp;0xbf56c16c16c14f91</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2083471">4.16666666666665929218E-2</span><span class="op" id="2083496">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2083500">//&nbsp;0x3fa555555555554b</span><br>
<span class="lineno">110</span><span class="op" id="2083522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2083525">//&nbsp;Cos&nbsp;returns&nbsp;the&nbsp;cosine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2083577">//</span><br>
<span class="lineno"></span><span class="comment" id="2083580">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">115</span><span class="comment" id="2083602">//&nbsp;&nbsp;&nbsp;&nbspCos(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2083622">//&nbsp;&nbsp;&nbsp;&nbspCos(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2083640">func</span>&nbsp;<span class="ident" id="2083645">Cos</span><span class="op" id="2083648">(</span><span class="ident" id="2083649">x</span>&nbsp;<span class="builtintype" id="2083651">float64</span><span class="op" id="2083658">)</span>&nbsp;<span class="builtintype" id="2083660">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2083669">func</span>&nbsp;<span class="ident" id="2083674">cos</span><span class="op" id="2083677">(</span><span class="ident" id="2083678">x</span>&nbsp;<span class="builtintype" id="2083680">float64</span><span class="op" id="2083687">)</span>&nbsp;<span class="builtintype" id="2083689">float64</span>&nbsp;<span class="op" id="2083697">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2083700">const</span>&nbsp;<span class="op" id="2083706">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2083710">PI4A</span>&nbsp;<span class="op" id="2083715">=</span>&nbsp;<span class="num" id="2083717">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2083771">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2083824">PI4B</span>&nbsp;<span class="op" id="2083829">=</span>&nbsp;<span class="num" id="2083831">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2083885">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2083910">PI4C</span>&nbsp;<span class="op" id="2083915">=</span>&nbsp;<span class="num" id="2083917">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2083971">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2083996">M4PI</span>&nbsp;<span class="op" id="2084001">=</span>&nbsp;<span class="num" id="2084003">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="2084057">//&nbsp;4/pi</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2084066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2084069">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2084087">switch</span>&nbsp;<span class="op" id="2084094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2084097">case</span>&nbsp;<span class="ident" id="2084102">IsNaN</span><span class="op" id="2084107">(</span><span class="ident" id="2084108">x</span><span class="op" id="2084109">)</span>&nbsp;<span class="op" id="2084111">||</span>&nbsp;<span class="ident" id="2084114">IsInf</span><span class="op" id="2084119">(</span><span class="ident" id="2084120">x</span><span class="op" id="2084121">,</span>&nbsp;<span class="num" id="2084123">0</span><span class="op" id="2084124">)</span><span class="op" id="2084125">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2084129">return</span>&nbsp;<span class="ident" id="2084136">NaN</span><span class="op" id="2084139">(</span><span class="op" id="2084140">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2084143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2084147">//&nbsp;make&nbsp;argument&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2084174">sign</span>&nbsp;<span class="op" id="2084179">:=</span>&nbsp;<span class="ident" id="2084182">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2084189">if</span>&nbsp;<span class="ident" id="2084192">x</span>&nbsp;<span class="op" id="2084194">&lt;</span>&nbsp;<span class="num" id="2084196">0</span>&nbsp;<span class="op" id="2084198">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2084202">x</span>&nbsp;<span class="op" id="2084204">=</span>&nbsp;<span class="op" id="2084206">-</span><span class="ident" id="2084207">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2084210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2084214">j</span>&nbsp;<span class="op" id="2084216">:=</span>&nbsp;<span class="ident" id="2084219">int64</span><span class="op" id="2084224">(</span><span class="ident" id="2084225">x</span>&nbsp;<span class="op" id="2084227">*</span>&nbsp;<span class="ident" id="2084229">M4PI</span><span class="op" id="2084233">)</span>&nbsp;<span class="comment" id="2084235">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2084305">y</span>&nbsp;<span class="op" id="2084307">:=</span>&nbsp;<span class="builtintype" id="2084310">float64</span><span class="op" id="2084317">(</span><span class="ident" id="2084318">j</span><span class="op" id="2084319">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2084326">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2084366">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2084390">if</span>&nbsp;<span class="ident" id="2084393">j</span><span class="op" id="2084394">&amp;</span><span class="num" id="2084395">1</span>&nbsp;<span class="op" id="2084397">==</span>&nbsp;<span class="num" id="2084400">1</span>&nbsp;<span class="op" id="2084402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2084406">j</span>&nbsp;<span class="op" id="2084408">+=</span>&nbsp;<span class="num" id="2084411">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2084415">y</span>&nbsp;<span class="op" id="2084417">+=</span>&nbsp;<span class="num" id="2084420">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2084423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2084426">j</span>&nbsp;<span class="op" id="2084428">&amp;=</span>&nbsp;<span class="num" id="2084431">7</span>&nbsp;<span class="comment" id="2084433">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2084477">if</span>&nbsp;<span class="ident" id="2084480">j</span>&nbsp;<span class="op" id="2084482">&gt;</span>&nbsp;<span class="num" id="2084484">3</span>&nbsp;<span class="op" id="2084486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2084490">j</span>&nbsp;<span class="op" id="2084492">-=</span>&nbsp;<span class="num" id="2084495">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2084499">sign</span>&nbsp;<span class="op" id="2084504">=</span>&nbsp;<span class="op" id="2084506">!</span><span class="ident" id="2084507">sign</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2084513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2084516">if</span>&nbsp;<span class="ident" id="2084519">j</span>&nbsp;<span class="op" id="2084521">&gt;</span>&nbsp;<span class="num" id="2084523">1</span>&nbsp;<span class="op" id="2084525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2084529">sign</span>&nbsp;<span class="op" id="2084534">=</span>&nbsp;<span class="op" id="2084536">!</span><span class="ident" id="2084537">sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2084543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2084547">z</span>&nbsp;<span class="op" id="2084549">:=</span>&nbsp;<span class="op" id="2084552">(</span><span class="op" id="2084553">(</span><span class="ident" id="2084554">x</span>&nbsp;<span class="op" id="2084556">-</span>&nbsp;<span class="ident" id="2084558">y</span><span class="op" id="2084559">*</span><span class="ident" id="2084560">PI4A</span><span class="op" id="2084564">)</span>&nbsp;<span class="op" id="2084566">-</span>&nbsp;<span class="ident" id="2084568">y</span><span class="op" id="2084569">*</span><span class="ident" id="2084570">PI4B</span><span class="op" id="2084574">)</span>&nbsp;<span class="op" id="2084576">-</span>&nbsp;<span class="ident" id="2084578">y</span><span class="op" id="2084579">*</span><span class="ident" id="2084580">PI4C</span>&nbsp;<span class="comment" id="2084585">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2084627">zz</span>&nbsp;<span class="op" id="2084630">:=</span>&nbsp;<span class="ident" id="2084633">z</span>&nbsp;<span class="op" id="2084635">*</span>&nbsp;<span class="ident" id="2084637">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2084640">if</span>&nbsp;<span class="ident" id="2084643">j</span>&nbsp;<span class="op" id="2084645">==</span>&nbsp;<span class="num" id="2084648">1</span>&nbsp;<span class="op" id="2084650">||</span>&nbsp;<span class="ident" id="2084653">j</span>&nbsp;<span class="op" id="2084655">==</span>&nbsp;<span class="num" id="2084658">2</span>&nbsp;<span class="op" id="2084660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2084664">y</span>&nbsp;<span class="op" id="2084666">=</span>&nbsp;<span class="ident" id="2084668">z</span>&nbsp;<span class="op" id="2084670">+</span>&nbsp;<span class="ident" id="2084672">z</span><span class="op" id="2084673">*</span><span class="ident" id="2084674">zz</span><span class="op" id="2084676">*</span><span class="op" id="2084677">(</span><span class="op" id="2084678">(</span><span class="op" id="2084679">(</span><span class="op" id="2084680">(</span><span class="op" id="2084681">(</span><span class="op" id="2084682">(</span><span class="ident" id="2084683">_sin</span><span class="op" id="2084687">[</span><span class="num" id="2084688">0</span><span class="op" id="2084689">]</span><span class="op" id="2084690">*</span><span class="ident" id="2084691">zz</span><span class="op" id="2084693">)</span><span class="op" id="2084694">+</span><span class="ident" id="2084695">_sin</span><span class="op" id="2084699">[</span><span class="num" id="2084700">1</span><span class="op" id="2084701">]</span><span class="op" id="2084702">)</span><span class="op" id="2084703">*</span><span class="ident" id="2084704">zz</span><span class="op" id="2084706">+</span><span class="ident" id="2084707">_sin</span><span class="op" id="2084711">[</span><span class="num" id="2084712">2</span><span class="op" id="2084713">]</span><span class="op" id="2084714">)</span><span class="op" id="2084715">*</span><span class="ident" id="2084716">zz</span><span class="op" id="2084718">+</span><span class="ident" id="2084719">_sin</span><span class="op" id="2084723">[</span><span class="num" id="2084724">3</span><span class="op" id="2084725">]</span><span class="op" id="2084726">)</span><span class="op" id="2084727">*</span><span class="ident" id="2084728">zz</span><span class="op" id="2084730">+</span><span class="ident" id="2084731">_sin</span><span class="op" id="2084735">[</span><span class="num" id="2084736">4</span><span class="op" id="2084737">]</span><span class="op" id="2084738">)</span><span class="op" id="2084739">*</span><span class="ident" id="2084740">zz</span><span class="op" id="2084742">+</span><span class="ident" id="2084743">_sin</span><span class="op" id="2084747">[</span><span class="num" id="2084748">5</span><span class="op" id="2084749">]</span><span class="op" id="2084750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2084753">}</span>&nbsp;<span class="keyword" id="2084755">else</span>&nbsp;<span class="op" id="2084760">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2084764">y</span>&nbsp;<span class="op" id="2084766">=</span>&nbsp;<span class="num" id="2084768">1.0</span>&nbsp;<span class="op" id="2084772">-</span>&nbsp;<span class="num" id="2084774">0.5</span><span class="op" id="2084777">*</span><span class="ident" id="2084778">zz</span>&nbsp;<span class="op" id="2084781">+</span>&nbsp;<span class="ident" id="2084783">zz</span><span class="op" id="2084785">*</span><span class="ident" id="2084786">zz</span><span class="op" id="2084788">*</span><span class="op" id="2084789">(</span><span class="op" id="2084790">(</span><span class="op" id="2084791">(</span><span class="op" id="2084792">(</span><span class="op" id="2084793">(</span><span class="op" id="2084794">(</span><span class="ident" id="2084795">_cos</span><span class="op" id="2084799">[</span><span class="num" id="2084800">0</span><span class="op" id="2084801">]</span><span class="op" id="2084802">*</span><span class="ident" id="2084803">zz</span><span class="op" id="2084805">)</span><span class="op" id="2084806">+</span><span class="ident" id="2084807">_cos</span><span class="op" id="2084811">[</span><span class="num" id="2084812">1</span><span class="op" id="2084813">]</span><span class="op" id="2084814">)</span><span class="op" id="2084815">*</span><span class="ident" id="2084816">zz</span><span class="op" id="2084818">+</span><span class="ident" id="2084819">_cos</span><span class="op" id="2084823">[</span><span class="num" id="2084824">2</span><span class="op" id="2084825">]</span><span class="op" id="2084826">)</span><span class="op" id="2084827">*</span><span class="ident" id="2084828">zz</span><span class="op" id="2084830">+</span><span class="ident" id="2084831">_cos</span><span class="op" id="2084835">[</span><span class="num" id="2084836">3</span><span class="op" id="2084837">]</span><span class="op" id="2084838">)</span><span class="op" id="2084839">*</span><span class="ident" id="2084840">zz</span><span class="op" id="2084842">+</span><span class="ident" id="2084843">_cos</span><span class="op" id="2084847">[</span><span class="num" id="2084848">4</span><span class="op" id="2084849">]</span><span class="op" id="2084850">)</span><span class="op" id="2084851">*</span><span class="ident" id="2084852">zz</span><span class="op" id="2084854">+</span><span class="ident" id="2084855">_cos</span><span class="op" id="2084859">[</span><span class="num" id="2084860">5</span><span class="op" id="2084861">]</span><span class="op" id="2084862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2084865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2084868">if</span>&nbsp;<span class="ident" id="2084871">sign</span>&nbsp;<span class="op" id="2084876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2084880">y</span>&nbsp;<span class="op" id="2084882">=</span>&nbsp;<span class="op" id="2084884">-</span><span class="ident" id="2084885">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2084888">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2084891">return</span>&nbsp;<span class="ident" id="2084898">y</span><br>
<span class="lineno"></span><span class="op" id="2084900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2084903">//&nbsp;Sin&nbsp;returns&nbsp;the&nbsp;sine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2084953">//</span><br>
<span class="lineno">170</span><span class="comment" id="2084956">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2084978">//&nbsp;&nbsp;&nbsp;&nbspSin(±0)&nbsp;=&nbsp;±0</span><br>
<span class="lineno"></span><span class="comment" id="2084996">//&nbsp;&nbsp;&nbsp;&nbspSin(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2085016">//&nbsp;&nbsp;&nbsp;&nbspSin(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2085034">func</span>&nbsp;<span class="ident" id="2085039">Sin</span><span class="op" id="2085042">(</span><span class="ident" id="2085043">x</span>&nbsp;<span class="builtintype" id="2085045">float64</span><span class="op" id="2085052">)</span>&nbsp;<span class="builtintype" id="2085054">float64</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="2085063">func</span>&nbsp;<span class="ident" id="2085068">sin</span><span class="op" id="2085071">(</span><span class="ident" id="2085072">x</span>&nbsp;<span class="builtintype" id="2085074">float64</span><span class="op" id="2085081">)</span>&nbsp;<span class="builtintype" id="2085083">float64</span>&nbsp;<span class="op" id="2085091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2085094">const</span>&nbsp;<span class="op" id="2085100">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2085104">PI4A</span>&nbsp;<span class="op" id="2085109">=</span>&nbsp;<span class="num" id="2085111">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2085165">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2085218">PI4B</span>&nbsp;<span class="op" id="2085223">=</span>&nbsp;<span class="num" id="2085225">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2085279">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2085304">PI4C</span>&nbsp;<span class="op" id="2085309">=</span>&nbsp;<span class="num" id="2085311">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2085365">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2085390">M4PI</span>&nbsp;<span class="op" id="2085395">=</span>&nbsp;<span class="num" id="2085397">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="2085451">//&nbsp;4/pi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2085460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2085463">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2085481">switch</span>&nbsp;<span class="op" id="2085488">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2085491">case</span>&nbsp;<span class="ident" id="2085496">x</span>&nbsp;<span class="op" id="2085498">==</span>&nbsp;<span class="num" id="2085501">0</span>&nbsp;<span class="op" id="2085503">||</span>&nbsp;<span class="ident" id="2085506">IsNaN</span><span class="op" id="2085511">(</span><span class="ident" id="2085512">x</span><span class="op" id="2085513">)</span><span class="op" id="2085514">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2085518">return</span>&nbsp;<span class="ident" id="2085525">x</span>&nbsp;<span class="comment" id="2085527">//&nbsp;return&nbsp;±0&nbsp;||&nbsp;NaN()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2085551">case</span>&nbsp;<span class="ident" id="2085556">IsInf</span><span class="op" id="2085561">(</span><span class="ident" id="2085562">x</span><span class="op" id="2085563">,</span>&nbsp;<span class="num" id="2085565">0</span><span class="op" id="2085566">)</span><span class="op" id="2085567">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2085571">return</span>&nbsp;<span class="ident" id="2085578">NaN</span><span class="op" id="2085581">(</span><span class="op" id="2085582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2085585">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2085589">//&nbsp;make&nbsp;argument&nbsp;positive&nbsp;but&nbsp;save&nbsp;the&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2085634">sign</span>&nbsp;<span class="op" id="2085639">:=</span>&nbsp;<span class="ident" id="2085642">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2085649">if</span>&nbsp;<span class="ident" id="2085652">x</span>&nbsp;<span class="op" id="2085654">&lt;</span>&nbsp;<span class="num" id="2085656">0</span>&nbsp;<span class="op" id="2085658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2085662">x</span>&nbsp;<span class="op" id="2085664">=</span>&nbsp;<span class="op" id="2085666">-</span><span class="ident" id="2085667">x</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2085671">sign</span>&nbsp;<span class="op" id="2085676">=</span>&nbsp;<span class="ident" id="2085678">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2085684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2085688">j</span>&nbsp;<span class="op" id="2085690">:=</span>&nbsp;<span class="ident" id="2085693">int64</span><span class="op" id="2085698">(</span><span class="ident" id="2085699">x</span>&nbsp;<span class="op" id="2085701">*</span>&nbsp;<span class="ident" id="2085703">M4PI</span><span class="op" id="2085707">)</span>&nbsp;<span class="comment" id="2085709">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2085779">y</span>&nbsp;<span class="op" id="2085781">:=</span>&nbsp;<span class="builtintype" id="2085784">float64</span><span class="op" id="2085791">(</span><span class="ident" id="2085792">j</span><span class="op" id="2085793">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2085800">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2085840">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2085864">if</span>&nbsp;<span class="ident" id="2085867">j</span><span class="op" id="2085868">&amp;</span><span class="num" id="2085869">1</span>&nbsp;<span class="op" id="2085871">==</span>&nbsp;<span class="num" id="2085874">1</span>&nbsp;<span class="op" id="2085876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2085880">j</span>&nbsp;<span class="op" id="2085882">+=</span>&nbsp;<span class="num" id="2085885">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2085889">y</span>&nbsp;<span class="op" id="2085891">+=</span>&nbsp;<span class="num" id="2085894">1</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2085897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2085900">j</span>&nbsp;<span class="op" id="2085902">&amp;=</span>&nbsp;<span class="num" id="2085905">7</span>&nbsp;<span class="comment" id="2085907">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2085951">//&nbsp;reflect&nbsp;in&nbsp;x&nbsp;axis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2085973">if</span>&nbsp;<span class="ident" id="2085976">j</span>&nbsp;<span class="op" id="2085978">&gt;</span>&nbsp;<span class="num" id="2085980">3</span>&nbsp;<span class="op" id="2085982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2085986">sign</span>&nbsp;<span class="op" id="2085991">=</span>&nbsp;<span class="op" id="2085993">!</span><span class="ident" id="2085994">sign</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2086001">j</span>&nbsp;<span class="op" id="2086003">-=</span>&nbsp;<span class="num" id="2086006">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2086009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2086013">z</span>&nbsp;<span class="op" id="2086015">:=</span>&nbsp;<span class="op" id="2086018">(</span><span class="op" id="2086019">(</span><span class="ident" id="2086020">x</span>&nbsp;<span class="op" id="2086022">-</span>&nbsp;<span class="ident" id="2086024">y</span><span class="op" id="2086025">*</span><span class="ident" id="2086026">PI4A</span><span class="op" id="2086030">)</span>&nbsp;<span class="op" id="2086032">-</span>&nbsp;<span class="ident" id="2086034">y</span><span class="op" id="2086035">*</span><span class="ident" id="2086036">PI4B</span><span class="op" id="2086040">)</span>&nbsp;<span class="op" id="2086042">-</span>&nbsp;<span class="ident" id="2086044">y</span><span class="op" id="2086045">*</span><span class="ident" id="2086046">PI4C</span>&nbsp;<span class="comment" id="2086051">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2086093">zz</span>&nbsp;<span class="op" id="2086096">:=</span>&nbsp;<span class="ident" id="2086099">z</span>&nbsp;<span class="op" id="2086101">*</span>&nbsp;<span class="ident" id="2086103">z</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2086106">if</span>&nbsp;<span class="ident" id="2086109">j</span>&nbsp;<span class="op" id="2086111">==</span>&nbsp;<span class="num" id="2086114">1</span>&nbsp;<span class="op" id="2086116">||</span>&nbsp;<span class="ident" id="2086119">j</span>&nbsp;<span class="op" id="2086121">==</span>&nbsp;<span class="num" id="2086124">2</span>&nbsp;<span class="op" id="2086126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2086130">y</span>&nbsp;<span class="op" id="2086132">=</span>&nbsp;<span class="num" id="2086134">1.0</span>&nbsp;<span class="op" id="2086138">-</span>&nbsp;<span class="num" id="2086140">0.5</span><span class="op" id="2086143">*</span><span class="ident" id="2086144">zz</span>&nbsp;<span class="op" id="2086147">+</span>&nbsp;<span class="ident" id="2086149">zz</span><span class="op" id="2086151">*</span><span class="ident" id="2086152">zz</span><span class="op" id="2086154">*</span><span class="op" id="2086155">(</span><span class="op" id="2086156">(</span><span class="op" id="2086157">(</span><span class="op" id="2086158">(</span><span class="op" id="2086159">(</span><span class="op" id="2086160">(</span><span class="ident" id="2086161">_cos</span><span class="op" id="2086165">[</span><span class="num" id="2086166">0</span><span class="op" id="2086167">]</span><span class="op" id="2086168">*</span><span class="ident" id="2086169">zz</span><span class="op" id="2086171">)</span><span class="op" id="2086172">+</span><span class="ident" id="2086173">_cos</span><span class="op" id="2086177">[</span><span class="num" id="2086178">1</span><span class="op" id="2086179">]</span><span class="op" id="2086180">)</span><span class="op" id="2086181">*</span><span class="ident" id="2086182">zz</span><span class="op" id="2086184">+</span><span class="ident" id="2086185">_cos</span><span class="op" id="2086189">[</span><span class="num" id="2086190">2</span><span class="op" id="2086191">]</span><span class="op" id="2086192">)</span><span class="op" id="2086193">*</span><span class="ident" id="2086194">zz</span><span class="op" id="2086196">+</span><span class="ident" id="2086197">_cos</span><span class="op" id="2086201">[</span><span class="num" id="2086202">3</span><span class="op" id="2086203">]</span><span class="op" id="2086204">)</span><span class="op" id="2086205">*</span><span class="ident" id="2086206">zz</span><span class="op" id="2086208">+</span><span class="ident" id="2086209">_cos</span><span class="op" id="2086213">[</span><span class="num" id="2086214">4</span><span class="op" id="2086215">]</span><span class="op" id="2086216">)</span><span class="op" id="2086217">*</span><span class="ident" id="2086218">zz</span><span class="op" id="2086220">+</span><span class="ident" id="2086221">_cos</span><span class="op" id="2086225">[</span><span class="num" id="2086226">5</span><span class="op" id="2086227">]</span><span class="op" id="2086228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2086231">}</span>&nbsp;<span class="keyword" id="2086233">else</span>&nbsp;<span class="op" id="2086238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2086242">y</span>&nbsp;<span class="op" id="2086244">=</span>&nbsp;<span class="ident" id="2086246">z</span>&nbsp;<span class="op" id="2086248">+</span>&nbsp;<span class="ident" id="2086250">z</span><span class="op" id="2086251">*</span><span class="ident" id="2086252">zz</span><span class="op" id="2086254">*</span><span class="op" id="2086255">(</span><span class="op" id="2086256">(</span><span class="op" id="2086257">(</span><span class="op" id="2086258">(</span><span class="op" id="2086259">(</span><span class="op" id="2086260">(</span><span class="ident" id="2086261">_sin</span><span class="op" id="2086265">[</span><span class="num" id="2086266">0</span><span class="op" id="2086267">]</span><span class="op" id="2086268">*</span><span class="ident" id="2086269">zz</span><span class="op" id="2086271">)</span><span class="op" id="2086272">+</span><span class="ident" id="2086273">_sin</span><span class="op" id="2086277">[</span><span class="num" id="2086278">1</span><span class="op" id="2086279">]</span><span class="op" id="2086280">)</span><span class="op" id="2086281">*</span><span class="ident" id="2086282">zz</span><span class="op" id="2086284">+</span><span class="ident" id="2086285">_sin</span><span class="op" id="2086289">[</span><span class="num" id="2086290">2</span><span class="op" id="2086291">]</span><span class="op" id="2086292">)</span><span class="op" id="2086293">*</span><span class="ident" id="2086294">zz</span><span class="op" id="2086296">+</span><span class="ident" id="2086297">_sin</span><span class="op" id="2086301">[</span><span class="num" id="2086302">3</span><span class="op" id="2086303">]</span><span class="op" id="2086304">)</span><span class="op" id="2086305">*</span><span class="ident" id="2086306">zz</span><span class="op" id="2086308">+</span><span class="ident" id="2086309">_sin</span><span class="op" id="2086313">[</span><span class="num" id="2086314">4</span><span class="op" id="2086315">]</span><span class="op" id="2086316">)</span><span class="op" id="2086317">*</span><span class="ident" id="2086318">zz</span><span class="op" id="2086320">+</span><span class="ident" id="2086321">_sin</span><span class="op" id="2086325">[</span><span class="num" id="2086326">5</span><span class="op" id="2086327">]</span><span class="op" id="2086328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2086331">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2086334">if</span>&nbsp;<span class="ident" id="2086337">sign</span>&nbsp;<span class="op" id="2086342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2086346">y</span>&nbsp;<span class="op" id="2086348">=</span>&nbsp;<span class="op" id="2086350">-</span><span class="ident" id="2086351">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2086354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2086357">return</span>&nbsp;<span class="ident" id="2086364">y</span><br>
<span class="lineno"></span><span class="op" id="2086366">}</span>
</div>
</body>
</html>
