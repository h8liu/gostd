<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/macho</h2>
<ul>
<li><a href="/gostd/debug/macho/fat.go.html" class="current">fat.go</a></li>
<li><a href="/gostd/debug/macho/file.go.html">file.go</a></li>
<li><a href="/gostd/debug/macho/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/macho/macho.go.html">macho.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6204904">//&nbsp;Copyright&nbsp;2014&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6204960">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6205014">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6205065">package</span>&nbsp;<span class="ident" id="6205073">macho</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6205080">import</span>&nbsp;<span class="op" id="6205087">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6205090">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6205109">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6205116">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6205122">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="6205127">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6205130">//&nbsp;A&nbsp;FatFile&nbsp;is&nbsp;a&nbsp;Mach-O&nbsp;universal&nbsp;binary&nbsp;that&nbsp;contains&nbsp;at&nbsp;least&nbsp;one&nbsp;architecture.</span><br>
<span class="lineno">15</span><span class="keyword" id="6205213">type</span>&nbsp;<span class="ident" id="6205218">FatFile</span>&nbsp;<span class="keyword" id="6205226">struct</span>&nbsp;<span class="op" id="6205233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6205236">Magic</span>&nbsp;&nbsp;<span class="builtintype" id="6205243">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6205251">Arches</span>&nbsp;<span class="op" id="6205258">[</span><span class="op" id="6205259">]</span><span class="ident" id="6205260">FatArch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6205269">closer</span>&nbsp;<span class="ident" id="6205276">io</span><span class="op" id="6205278">.</span><span class="ident" id="6205279">Closer</span><br>
<span class="lineno"></span><span class="op" id="6205286">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="6205289">//&nbsp;A&nbsp;FatArchHeader&nbsp;represents&nbsp;a&nbsp;fat&nbsp;header&nbsp;for&nbsp;a&nbsp;specific&nbsp;image&nbsp;architecture.</span><br>
<span class="lineno"></span><span class="keyword" id="6205367">type</span>&nbsp;<span class="ident" id="6205372">FatArchHeader</span>&nbsp;<span class="keyword" id="6205386">struct</span>&nbsp;<span class="op" id="6205393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6205396">Cpu</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6205403">Cpu</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6205408">SubCpu</span>&nbsp;<span class="builtintype" id="6205415">uint32</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6205423">Offset</span>&nbsp;<span class="builtintype" id="6205430">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6205438">Size</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6205445">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6205453">Align</span>&nbsp;&nbsp;<span class="builtintype" id="6205460">uint32</span><br>
<span class="lineno"></span><span class="op" id="6205467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="6205470">const</span>&nbsp;<span class="ident" id="6205476">fatArchHeaderSize</span>&nbsp;<span class="op" id="6205494">=</span>&nbsp;<span class="num" id="6205496">5</span>&nbsp;<span class="op" id="6205498">*</span>&nbsp;<span class="num" id="6205500">4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6205503">//&nbsp;A&nbsp;FatArch&nbsp;is&nbsp;a&nbsp;Mach-O&nbsp;File&nbsp;inside&nbsp;a&nbsp;FatFile.</span><br>
<span class="lineno"></span><span class="keyword" id="6205551">type</span>&nbsp;<span class="ident" id="6205556">FatArch</span>&nbsp;<span class="keyword" id="6205564">struct</span>&nbsp;<span class="op" id="6205571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6205574">FatArchHeader</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6205589">*</span><span class="ident" id="6205590">File</span><br>
<span class="lineno"></span><span class="op" id="6205595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6205598">//&nbsp;ErrNotFat&nbsp;is&nbsp;returned&nbsp;from&nbsp;NewFatFile&nbsp;or&nbsp;OpenFat&nbsp;when&nbsp;the&nbsp;file&nbsp;is&nbsp;not&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="6205673">//&nbsp;universal&nbsp;binary&nbsp;but&nbsp;may&nbsp;be&nbsp;a&nbsp;thin&nbsp;binary,&nbsp;based&nbsp;on&nbsp;its&nbsp;magic&nbsp;number.</span><br>
<span class="lineno">40</span><span class="keyword" id="6205746">var</span>&nbsp;<span class="ident" id="6205750">ErrNotFat</span>&nbsp;<span class="op" id="6205760">=</span>&nbsp;<span class="op" id="6205762">&amp;</span><span class="ident" id="6205763">FormatError</span><span class="op" id="6205774">{</span><span class="num" id="6205775">0</span><span class="op" id="6205776">,</span>&nbsp;<span class="string" id="6205778">&#34;not&nbsp;a&nbsp;fat&nbsp;Mach-O&nbsp;file&#34;</span><span class="op" id="6205801">,</span>&nbsp;<span class="builtintype" id="6205803">nil</span><span class="op" id="6205806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6205809">//&nbsp;NewFatFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;FatFile&nbsp;for&nbsp;accessing&nbsp;all&nbsp;the&nbsp;Mach-O&nbsp;images&nbsp;in&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="6205886">//&nbsp;universal&nbsp;binary.&nbsp;The&nbsp;Mach-O&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="6205963">//&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno">45</span><span class="keyword" id="6205980">func</span>&nbsp;<span class="ident" id="6205985">NewFatFile</span><span class="op" id="6205995">(</span><span class="ident" id="6205996">r</span>&nbsp;<span class="ident" id="6205998">io</span><span class="op" id="6206000">.</span><span class="ident" id="6206001">ReaderAt</span><span class="op" id="6206009">)</span>&nbsp;<span class="op" id="6206011">(</span><span class="op" id="6206012">*</span><span class="ident" id="6206013">FatFile</span><span class="op" id="6206020">,</span>&nbsp;<span class="builtintype" id="6206022">error</span><span class="op" id="6206027">)</span>&nbsp;<span class="op" id="6206029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6206032">var</span>&nbsp;<span class="ident" id="6206036">ff</span>&nbsp;<span class="ident" id="6206039">FatFile</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6206048">sr</span>&nbsp;<span class="op" id="6206051">:=</span>&nbsp;<span class="ident" id="6206054">io</span><span class="op" id="6206056">.</span><span class="ident" id="6206057">NewSectionReader</span><span class="op" id="6206073">(</span><span class="ident" id="6206074">r</span><span class="op" id="6206075">,</span>&nbsp;<span class="num" id="6206077">0</span><span class="op" id="6206078">,</span>&nbsp;<span class="num" id="6206080">1</span><span class="op" id="6206081">&lt;&lt;</span><span class="num" id="6206083">63</span><span class="op" id="6206085">-</span><span class="num" id="6206086">1</span><span class="op" id="6206087">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6206091">//&nbsp;Read&nbsp;the&nbsp;fat_header&nbsp;struct,&nbsp;which&nbsp;is&nbsp;always&nbsp;in&nbsp;big&nbsp;endian.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6206154">//&nbsp;Start&nbsp;with&nbsp;the&nbsp;magic&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6206187">err</span>&nbsp;<span class="op" id="6206191">:=</span>&nbsp;<span class="ident" id="6206194">binary</span><span class="op" id="6206200">.</span><span class="ident" id="6206201">Read</span><span class="op" id="6206205">(</span><span class="ident" id="6206206">sr</span><span class="op" id="6206208">,</span>&nbsp;<span class="ident" id="6206210">binary</span><span class="op" id="6206216">.</span><span class="ident" id="6206217">BigEndian</span><span class="op" id="6206226">,</span>&nbsp;<span class="op" id="6206228">&amp;</span><span class="ident" id="6206229">ff</span><span class="op" id="6206231">.</span><span class="ident" id="6206232">Magic</span><span class="op" id="6206237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6206240">if</span>&nbsp;<span class="ident" id="6206243">err</span>&nbsp;<span class="op" id="6206247">!=</span>&nbsp;<span class="builtintype" id="6206250">nil</span>&nbsp;<span class="op" id="6206254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6206258">return</span>&nbsp;<span class="builtintype" id="6206265">nil</span><span class="op" id="6206268">,</span>&nbsp;<span class="op" id="6206270">&amp;</span><span class="ident" id="6206271">FormatError</span><span class="op" id="6206282">{</span><span class="num" id="6206283">0</span><span class="op" id="6206284">,</span>&nbsp;<span class="string" id="6206286">&#34;error&nbsp;reading&nbsp;magic&nbsp;number&#34;</span><span class="op" id="6206314">,</span>&nbsp;<span class="builtintype" id="6206316">nil</span><span class="op" id="6206319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6206322">}</span>&nbsp;<span class="keyword" id="6206324">else</span>&nbsp;<span class="keyword" id="6206329">if</span>&nbsp;<span class="ident" id="6206332">ff</span><span class="op" id="6206334">.</span><span class="ident" id="6206335">Magic</span>&nbsp;<span class="op" id="6206341">!=</span>&nbsp;<span class="ident" id="6206344">MagicFat</span>&nbsp;<span class="op" id="6206353">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6206357">//&nbsp;See&nbsp;if&nbsp;this&nbsp;is&nbsp;a&nbsp;Mach-O&nbsp;file&nbsp;via&nbsp;its&nbsp;magic&nbsp;number.&nbsp;The&nbsp;magic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6206423">//&nbsp;must&nbsp;be&nbsp;converted&nbsp;to&nbsp;little&nbsp;endian&nbsp;first&nbsp;though.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6206477">var</span>&nbsp;<span class="ident" id="6206481">buf</span>&nbsp;<span class="op" id="6206485">[</span><span class="num" id="6206486">4</span><span class="op" id="6206487">]</span><span class="builtintype" id="6206488">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6206495">binary</span><span class="op" id="6206501">.</span><span class="ident" id="6206502">BigEndian</span><span class="op" id="6206511">.</span><span class="ident" id="6206512">PutUint32</span><span class="op" id="6206521">(</span><span class="ident" id="6206522">buf</span><span class="op" id="6206525">[</span><span class="op" id="6206526">:</span><span class="op" id="6206527">]</span><span class="op" id="6206528">,</span>&nbsp;<span class="ident" id="6206530">ff</span><span class="op" id="6206532">.</span><span class="ident" id="6206533">Magic</span><span class="op" id="6206538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6206542">leMagic</span>&nbsp;<span class="op" id="6206550">:=</span>&nbsp;<span class="ident" id="6206553">binary</span><span class="op" id="6206559">.</span><span class="ident" id="6206560">LittleEndian</span><span class="op" id="6206572">.</span><span class="ident" id="6206573">Uint32</span><span class="op" id="6206579">(</span><span class="ident" id="6206580">buf</span><span class="op" id="6206583">[</span><span class="op" id="6206584">:</span><span class="op" id="6206585">]</span><span class="op" id="6206586">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6206590">if</span>&nbsp;<span class="ident" id="6206593">leMagic</span>&nbsp;<span class="op" id="6206601">==</span>&nbsp;<span class="ident" id="6206604">Magic32</span>&nbsp;<span class="op" id="6206612">||</span>&nbsp;<span class="ident" id="6206615">leMagic</span>&nbsp;<span class="op" id="6206623">==</span>&nbsp;<span class="ident" id="6206626">Magic64</span>&nbsp;<span class="op" id="6206634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6206639">return</span>&nbsp;<span class="builtintype" id="6206646">nil</span><span class="op" id="6206649">,</span>&nbsp;<span class="ident" id="6206651">ErrNotFat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6206663">}</span>&nbsp;<span class="keyword" id="6206665">else</span>&nbsp;<span class="op" id="6206670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6206675">return</span>&nbsp;<span class="builtintype" id="6206682">nil</span><span class="op" id="6206685">,</span>&nbsp;<span class="op" id="6206687">&amp;</span><span class="ident" id="6206688">FormatError</span><span class="op" id="6206699">{</span><span class="num" id="6206700">0</span><span class="op" id="6206701">,</span>&nbsp;<span class="string" id="6206703">&#34;invalid&nbsp;magic&nbsp;number&#34;</span><span class="op" id="6206725">,</span>&nbsp;<span class="builtintype" id="6206727">nil</span><span class="op" id="6206730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6206734">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6206737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6206740">offset</span>&nbsp;<span class="op" id="6206747">:=</span>&nbsp;<span class="ident" id="6206750">int64</span><span class="op" id="6206755">(</span><span class="num" id="6206756">4</span><span class="op" id="6206757">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6206761">//&nbsp;Read&nbsp;the&nbsp;number&nbsp;of&nbsp;FatArchHeaders&nbsp;that&nbsp;come&nbsp;after&nbsp;the&nbsp;fat_header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6206831">var</span>&nbsp;<span class="ident" id="6206835">narch</span>&nbsp;<span class="builtintype" id="6206841">uint32</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6206849">err</span>&nbsp;<span class="op" id="6206853">=</span>&nbsp;<span class="ident" id="6206855">binary</span><span class="op" id="6206861">.</span><span class="ident" id="6206862">Read</span><span class="op" id="6206866">(</span><span class="ident" id="6206867">sr</span><span class="op" id="6206869">,</span>&nbsp;<span class="ident" id="6206871">binary</span><span class="op" id="6206877">.</span><span class="ident" id="6206878">BigEndian</span><span class="op" id="6206887">,</span>&nbsp;<span class="op" id="6206889">&amp;</span><span class="ident" id="6206890">narch</span><span class="op" id="6206895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6206898">if</span>&nbsp;<span class="ident" id="6206901">err</span>&nbsp;<span class="op" id="6206905">!=</span>&nbsp;<span class="builtintype" id="6206908">nil</span>&nbsp;<span class="op" id="6206912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6206916">return</span>&nbsp;<span class="builtintype" id="6206923">nil</span><span class="op" id="6206926">,</span>&nbsp;<span class="op" id="6206928">&amp;</span><span class="ident" id="6206929">FormatError</span><span class="op" id="6206940">{</span><span class="ident" id="6206941">offset</span><span class="op" id="6206947">,</span>&nbsp;<span class="string" id="6206949">&#34;invalid&nbsp;fat_header&#34;</span><span class="op" id="6206969">,</span>&nbsp;<span class="builtintype" id="6206971">nil</span><span class="op" id="6206974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6206977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6206980">offset</span>&nbsp;<span class="op" id="6206987">+=</span>&nbsp;<span class="num" id="6206990">4</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6206994">if</span>&nbsp;<span class="ident" id="6206997">narch</span>&nbsp;<span class="op" id="6207003">&lt;</span>&nbsp;<span class="num" id="6207005">1</span>&nbsp;<span class="op" id="6207007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6207011">return</span>&nbsp;<span class="builtintype" id="6207018">nil</span><span class="op" id="6207021">,</span>&nbsp;<span class="op" id="6207023">&amp;</span><span class="ident" id="6207024">FormatError</span><span class="op" id="6207035">{</span><span class="ident" id="6207036">offset</span><span class="op" id="6207042">,</span>&nbsp;<span class="string" id="6207044">&#34;file&nbsp;contains&nbsp;no&nbsp;images&#34;</span><span class="op" id="6207069">,</span>&nbsp;<span class="builtintype" id="6207071">nil</span><span class="op" id="6207074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6207077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6207081">//&nbsp;Combine&nbsp;the&nbsp;Cpu&nbsp;and&nbsp;SubCpu&nbsp;(both&nbsp;uint32)&nbsp;into&nbsp;a&nbsp;uint64&nbsp;to&nbsp;make&nbsp;sure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6207153">//&nbsp;there&nbsp;are&nbsp;not&nbsp;duplicate&nbsp;architectures.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6207196">seenArches</span>&nbsp;<span class="op" id="6207207">:=</span>&nbsp;<span class="builtinfunc" id="6207210">make</span><span class="op" id="6207214">(</span><span class="keyword" id="6207215">map</span><span class="op" id="6207218">[</span><span class="ident" id="6207219">uint64</span><span class="op" id="6207225">]</span><span class="builtintype" id="6207226">bool</span><span class="op" id="6207230">,</span>&nbsp;<span class="ident" id="6207232">narch</span><span class="op" id="6207237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6207240">//&nbsp;Make&nbsp;sure&nbsp;that&nbsp;all&nbsp;images&nbsp;are&nbsp;for&nbsp;the&nbsp;same&nbsp;MH_&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6207297">var</span>&nbsp;<span class="ident" id="6207301">machoType</span>&nbsp;<span class="ident" id="6207311">Type</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6207318">//&nbsp;Following&nbsp;the&nbsp;fat_header&nbsp;comes&nbsp;narch&nbsp;fat_arch&nbsp;structs&nbsp;that&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6207387">//&nbsp;Mach-O&nbsp;images&nbsp;further&nbsp;in&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6207426">ff</span><span class="op" id="6207428">.</span><span class="ident" id="6207429">Arches</span>&nbsp;<span class="op" id="6207436">=</span>&nbsp;<span class="builtinfunc" id="6207438">make</span><span class="op" id="6207442">(</span><span class="op" id="6207443">[</span><span class="op" id="6207444">]</span><span class="ident" id="6207445">FatArch</span><span class="op" id="6207452">,</span>&nbsp;<span class="ident" id="6207454">narch</span><span class="op" id="6207459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6207462">for</span>&nbsp;<span class="ident" id="6207466">i</span>&nbsp;<span class="op" id="6207468">:=</span>&nbsp;<span class="builtintype" id="6207471">uint32</span><span class="op" id="6207477">(</span><span class="num" id="6207478">0</span><span class="op" id="6207479">)</span><span class="op" id="6207480">;</span>&nbsp;<span class="ident" id="6207482">i</span>&nbsp;<span class="op" id="6207484">&lt;</span>&nbsp;<span class="ident" id="6207486">narch</span><span class="op" id="6207491">;</span>&nbsp;<span class="ident" id="6207493">i</span><span class="op" id="6207494">++</span>&nbsp;<span class="op" id="6207497">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6207501">fa</span>&nbsp;<span class="op" id="6207504">:=</span>&nbsp;<span class="op" id="6207507">&amp;</span><span class="ident" id="6207508">ff</span><span class="op" id="6207510">.</span><span class="ident" id="6207511">Arches</span><span class="op" id="6207517">[</span><span class="ident" id="6207518">i</span><span class="op" id="6207519">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6207523">err</span>&nbsp;<span class="op" id="6207527">=</span>&nbsp;<span class="ident" id="6207529">binary</span><span class="op" id="6207535">.</span><span class="ident" id="6207536">Read</span><span class="op" id="6207540">(</span><span class="ident" id="6207541">sr</span><span class="op" id="6207543">,</span>&nbsp;<span class="ident" id="6207545">binary</span><span class="op" id="6207551">.</span><span class="ident" id="6207552">BigEndian</span><span class="op" id="6207561">,</span>&nbsp;<span class="op" id="6207563">&amp;</span><span class="ident" id="6207564">fa</span><span class="op" id="6207566">.</span><span class="ident" id="6207567">FatArchHeader</span><span class="op" id="6207580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6207584">if</span>&nbsp;<span class="ident" id="6207587">err</span>&nbsp;<span class="op" id="6207591">!=</span>&nbsp;<span class="builtintype" id="6207594">nil</span>&nbsp;<span class="op" id="6207598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6207603">return</span>&nbsp;<span class="builtintype" id="6207610">nil</span><span class="op" id="6207613">,</span>&nbsp;<span class="op" id="6207615">&amp;</span><span class="ident" id="6207616">FormatError</span><span class="op" id="6207627">{</span><span class="ident" id="6207628">offset</span><span class="op" id="6207634">,</span>&nbsp;<span class="string" id="6207636">&#34;invalid&nbsp;fat_arch&nbsp;header&#34;</span><span class="op" id="6207661">,</span>&nbsp;<span class="builtintype" id="6207663">nil</span><span class="op" id="6207666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6207670">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6207674">offset</span>&nbsp;<span class="op" id="6207681">+=</span>&nbsp;<span class="ident" id="6207684">fatArchHeaderSize</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6207705">fr</span>&nbsp;<span class="op" id="6207708">:=</span>&nbsp;<span class="ident" id="6207711">io</span><span class="op" id="6207713">.</span><span class="ident" id="6207714">NewSectionReader</span><span class="op" id="6207730">(</span><span class="ident" id="6207731">r</span><span class="op" id="6207732">,</span>&nbsp;<span class="ident" id="6207734">int64</span><span class="op" id="6207739">(</span><span class="ident" id="6207740">fa</span><span class="op" id="6207742">.</span><span class="ident" id="6207743">Offset</span><span class="op" id="6207749">)</span><span class="op" id="6207750">,</span>&nbsp;<span class="ident" id="6207752">int64</span><span class="op" id="6207757">(</span><span class="ident" id="6207758">fa</span><span class="op" id="6207760">.</span><span class="ident" id="6207761">Size</span><span class="op" id="6207765">)</span><span class="op" id="6207766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6207770">fa</span><span class="op" id="6207772">.</span><span class="ident" id="6207773">File</span><span class="op" id="6207777">,</span>&nbsp;<span class="ident" id="6207779">err</span>&nbsp;<span class="op" id="6207783">=</span>&nbsp;<span class="ident" id="6207785">NewFile</span><span class="op" id="6207792">(</span><span class="ident" id="6207793">fr</span><span class="op" id="6207795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6207799">if</span>&nbsp;<span class="ident" id="6207802">err</span>&nbsp;<span class="op" id="6207806">!=</span>&nbsp;<span class="builtintype" id="6207809">nil</span>&nbsp;<span class="op" id="6207813">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6207818">return</span>&nbsp;<span class="builtintype" id="6207825">nil</span><span class="op" id="6207828">,</span>&nbsp;<span class="ident" id="6207830">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6207836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6207841">//&nbsp;Make&nbsp;sure&nbsp;the&nbsp;architecture&nbsp;for&nbsp;this&nbsp;image&nbsp;is&nbsp;not&nbsp;duplicate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6207906">seenArch</span>&nbsp;<span class="op" id="6207915">:=</span>&nbsp;<span class="op" id="6207918">(</span><span class="ident" id="6207919">uint64</span><span class="op" id="6207925">(</span><span class="ident" id="6207926">fa</span><span class="op" id="6207928">.</span><span class="ident" id="6207929">Cpu</span><span class="op" id="6207932">)</span>&nbsp;<span class="op" id="6207934">&lt;&lt;</span>&nbsp;<span class="num" id="6207937">32</span><span class="op" id="6207939">)</span>&nbsp;<span class="op" id="6207941">|</span>&nbsp;<span class="ident" id="6207943">uint64</span><span class="op" id="6207949">(</span><span class="ident" id="6207950">fa</span><span class="op" id="6207952">.</span><span class="ident" id="6207953">SubCpu</span><span class="op" id="6207959">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6207963">if</span>&nbsp;<span class="ident" id="6207966">o</span><span class="op" id="6207967">,</span>&nbsp;<span class="ident" id="6207969">k</span>&nbsp;<span class="op" id="6207971">:=</span>&nbsp;<span class="ident" id="6207974">seenArches</span><span class="op" id="6207984">[</span><span class="ident" id="6207985">seenArch</span><span class="op" id="6207993">]</span><span class="op" id="6207994">;</span>&nbsp;<span class="ident" id="6207996">o</span>&nbsp;<span class="op" id="6207998">||</span>&nbsp;<span class="ident" id="6208001">k</span>&nbsp;<span class="op" id="6208003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6208008">return</span>&nbsp;<span class="builtintype" id="6208015">nil</span><span class="op" id="6208018">,</span>&nbsp;<span class="op" id="6208020">&amp;</span><span class="ident" id="6208021">FormatError</span><span class="op" id="6208032">{</span><span class="ident" id="6208033">offset</span><span class="op" id="6208039">,</span>&nbsp;<span class="ident" id="6208041">fmt</span><span class="op" id="6208044">.</span><span class="ident" id="6208045">Sprintf</span><span class="op" id="6208052">(</span><span class="string" id="6208053">&#34;duplicate&nbsp;architecture&nbsp;cpu=%v,&nbsp;subcpu=%#x&#34;</span><span class="op" id="6208096">,</span>&nbsp;<span class="ident" id="6208098">fa</span><span class="op" id="6208100">.</span><span class="ident" id="6208101">Cpu</span><span class="op" id="6208104">,</span>&nbsp;<span class="ident" id="6208106">fa</span><span class="op" id="6208108">.</span><span class="ident" id="6208109">SubCpu</span><span class="op" id="6208115">)</span><span class="op" id="6208116">,</span>&nbsp;<span class="builtintype" id="6208118">nil</span><span class="op" id="6208121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6208125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6208129">seenArches</span><span class="op" id="6208139">[</span><span class="ident" id="6208140">seenArch</span><span class="op" id="6208148">]</span>&nbsp;<span class="op" id="6208150">=</span>&nbsp;<span class="builtintype" id="6208152">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6208160">//&nbsp;Make&nbsp;sure&nbsp;the&nbsp;Mach-O&nbsp;type&nbsp;matches&nbsp;that&nbsp;of&nbsp;the&nbsp;first&nbsp;image.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6208224">if</span>&nbsp;<span class="ident" id="6208227">i</span>&nbsp;<span class="op" id="6208229">==</span>&nbsp;<span class="num" id="6208232">0</span>&nbsp;<span class="op" id="6208234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6208239">machoType</span>&nbsp;<span class="op" id="6208249">=</span>&nbsp;<span class="ident" id="6208251">fa</span><span class="op" id="6208253">.</span><span class="ident" id="6208254">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6208261">}</span>&nbsp;<span class="keyword" id="6208263">else</span>&nbsp;<span class="op" id="6208268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6208273">if</span>&nbsp;<span class="ident" id="6208276">fa</span><span class="op" id="6208278">.</span><span class="ident" id="6208279">Type</span>&nbsp;<span class="op" id="6208284">!=</span>&nbsp;<span class="ident" id="6208287">machoType</span>&nbsp;<span class="op" id="6208297">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6208303">return</span>&nbsp;<span class="builtintype" id="6208310">nil</span><span class="op" id="6208313">,</span>&nbsp;<span class="op" id="6208315">&amp;</span><span class="ident" id="6208316">FormatError</span><span class="op" id="6208327">{</span><span class="ident" id="6208328">offset</span><span class="op" id="6208334">,</span>&nbsp;<span class="ident" id="6208336">fmt</span><span class="op" id="6208339">.</span><span class="ident" id="6208340">Sprintf</span><span class="op" id="6208347">(</span><span class="string" id="6208348">&#34;Mach-O&nbsp;type&nbsp;for&nbsp;architecture&nbsp;#%d&nbsp;(type=%#x)&nbsp;does&nbsp;not&nbsp;match&nbsp;first&nbsp;(type=%#x)&#34;</span><span class="op" id="6208425">,</span>&nbsp;<span class="ident" id="6208427">i</span><span class="op" id="6208428">,</span>&nbsp;<span class="ident" id="6208430">fa</span><span class="op" id="6208432">.</span><span class="ident" id="6208433">Type</span><span class="op" id="6208437">,</span>&nbsp;<span class="ident" id="6208439">machoType</span><span class="op" id="6208448">)</span><span class="op" id="6208449">,</span>&nbsp;<span class="builtintype" id="6208451">nil</span><span class="op" id="6208454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6208459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6208463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6208466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6208470">return</span>&nbsp;<span class="op" id="6208477">&amp;</span><span class="ident" id="6208478">ff</span><span class="op" id="6208480">,</span>&nbsp;<span class="builtintype" id="6208482">nil</span><br>
<span class="lineno"></span><span class="op" id="6208486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6208489">//&nbsp;OpenFat&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;a&nbsp;Mach-O</span><br>
<span class="lineno"></span><span class="comment" id="6208571">//&nbsp;universal&nbsp;binary.</span><br>
<span class="lineno">125</span><span class="keyword" id="6208592">func</span>&nbsp;<span class="ident" id="6208597">OpenFat</span><span class="op" id="6208604">(</span><span class="ident" id="6208605">name</span>&nbsp;<span class="builtintype" id="6208610">string</span><span class="op" id="6208616">)</span>&nbsp;<span class="op" id="6208618">(</span><span class="ident" id="6208619">ff</span>&nbsp;<span class="op" id="6208622">*</span><span class="ident" id="6208623">FatFile</span><span class="op" id="6208630">,</span>&nbsp;<span class="ident" id="6208632">err</span>&nbsp;<span class="builtintype" id="6208636">error</span><span class="op" id="6208641">)</span>&nbsp;<span class="op" id="6208643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6208646">f</span><span class="op" id="6208647">,</span>&nbsp;<span class="ident" id="6208649">err</span>&nbsp;<span class="op" id="6208653">:=</span>&nbsp;<span class="ident" id="6208656">os</span><span class="op" id="6208658">.</span><span class="ident" id="6208659">Open</span><span class="op" id="6208663">(</span><span class="ident" id="6208664">name</span><span class="op" id="6208668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6208671">if</span>&nbsp;<span class="ident" id="6208674">err</span>&nbsp;<span class="op" id="6208678">!=</span>&nbsp;<span class="builtintype" id="6208681">nil</span>&nbsp;<span class="op" id="6208685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6208689">return</span>&nbsp;<span class="builtintype" id="6208696">nil</span><span class="op" id="6208699">,</span>&nbsp;<span class="ident" id="6208701">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6208706">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6208709">ff</span><span class="op" id="6208711">,</span>&nbsp;<span class="ident" id="6208713">err</span>&nbsp;<span class="op" id="6208717">=</span>&nbsp;<span class="ident" id="6208719">NewFatFile</span><span class="op" id="6208729">(</span><span class="ident" id="6208730">f</span><span class="op" id="6208731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6208734">if</span>&nbsp;<span class="ident" id="6208737">err</span>&nbsp;<span class="op" id="6208741">!=</span>&nbsp;<span class="builtintype" id="6208744">nil</span>&nbsp;<span class="op" id="6208748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6208752">f</span><span class="op" id="6208753">.</span><span class="ident" id="6208754">Close</span><span class="op" id="6208759">(</span><span class="op" id="6208760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6208764">return</span>&nbsp;<span class="builtintype" id="6208771">nil</span><span class="op" id="6208774">,</span>&nbsp;<span class="ident" id="6208776">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6208781">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6208784">ff</span><span class="op" id="6208786">.</span><span class="ident" id="6208787">closer</span>&nbsp;<span class="op" id="6208794">=</span>&nbsp;<span class="ident" id="6208796">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6208799">return</span><br>
<span class="lineno"></span><span class="op" id="6208806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6208809">func</span>&nbsp;<span class="op" id="6208814">(</span><span class="ident" id="6208815">ff</span>&nbsp;<span class="op" id="6208818">*</span><span class="ident" id="6208819">FatFile</span><span class="op" id="6208826">)</span>&nbsp;<span class="ident" id="6208828">Close</span><span class="op" id="6208833">(</span><span class="op" id="6208834">)</span>&nbsp;<span class="builtintype" id="6208836">error</span>&nbsp;<span class="op" id="6208842">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6208845">var</span>&nbsp;<span class="ident" id="6208849">err</span>&nbsp;<span class="builtintype" id="6208853">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6208860">if</span>&nbsp;<span class="ident" id="6208863">ff</span><span class="op" id="6208865">.</span><span class="ident" id="6208866">closer</span>&nbsp;<span class="op" id="6208873">!=</span>&nbsp;<span class="builtintype" id="6208876">nil</span>&nbsp;<span class="op" id="6208880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6208884">err</span>&nbsp;<span class="op" id="6208888">=</span>&nbsp;<span class="ident" id="6208890">ff</span><span class="op" id="6208892">.</span><span class="ident" id="6208893">closer</span><span class="op" id="6208899">.</span><span class="ident" id="6208900">Close</span><span class="op" id="6208905">(</span><span class="op" id="6208906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6208910">ff</span><span class="op" id="6208912">.</span><span class="ident" id="6208913">closer</span>&nbsp;<span class="op" id="6208920">=</span>&nbsp;<span class="builtintype" id="6208922">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6208927">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6208930">return</span>&nbsp;<span class="ident" id="6208937">err</span><br>
<span class="lineno"></span><span class="op" id="6208941">}</span>
</div>
</body>
</html>
