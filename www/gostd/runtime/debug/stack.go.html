<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime/debug</h2>
<ul>
<li><a href="/gostd/runtime/debug/garbage.go.html">garbage.go</a></li>
<li><a href="/gostd/runtime/debug/garbage_test.go.html">garbage_test.go</a></li>
<li><a href="/gostd/runtime/debug/heapdump_test.go.html">heapdump_test.go</a></li>
<li><a href="/gostd/runtime/debug/stack.go.html" class="current">stack.go</a></li>
<li><a href="/gostd/runtime/debug/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/debug/stubs.go.html">stubs.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5541571">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5541626">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5541680">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5541731">//&nbsp;Package&nbsp;debug&nbsp;contains&nbsp;facilities&nbsp;for&nbsp;programs&nbsp;to&nbsp;debug&nbsp;themselves&nbsp;while</span><br>
<span class="lineno"></span><span class="comment" id="5541807">//&nbsp;they&nbsp;are&nbsp;running.</span><br>
<span class="lineno"></span><span class="keyword" id="5541828">package</span>&nbsp;<span class="ident" id="5541836">debug</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5541843">import</span>&nbsp;<span class="op" id="5541850">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5541853">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5541862">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5541869">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5541882">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5541888">&#34;runtime&#34;</span><br>
<span class="lineno">15</span><span class="op" id="5541898">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5541901">var</span>&nbsp;<span class="op" id="5541905">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5541908">dunno</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5541918">=</span>&nbsp;<span class="op" id="5541920">[</span><span class="op" id="5541921">]</span><span class="builtintype" id="5541922">byte</span><span class="op" id="5541926">(</span><span class="string" id="5541927">&#34;???&#34;</span><span class="op" id="5541932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5541935">centerDot</span>&nbsp;<span class="op" id="5541945">=</span>&nbsp;<span class="op" id="5541947">[</span><span class="op" id="5541948">]</span><span class="builtintype" id="5541949">byte</span><span class="op" id="5541953">(</span><span class="string" id="5541954">&#34;Â·&#34;</span><span class="op" id="5541958">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5541961">dot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5541971">=</span>&nbsp;<span class="op" id="5541973">[</span><span class="op" id="5541974">]</span><span class="builtintype" id="5541975">byte</span><span class="op" id="5541979">(</span><span class="string" id="5541980">&#34;.&#34;</span><span class="op" id="5541983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5541986">slash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5541996">=</span>&nbsp;<span class="op" id="5541998">[</span><span class="op" id="5541999">]</span><span class="builtintype" id="5542000">byte</span><span class="op" id="5542004">(</span><span class="string" id="5542005">&#34;/&#34;</span><span class="op" id="5542008">)</span><br>
<span class="lineno"></span><span class="op" id="5542010">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5542013">//&nbsp;PrintStack&nbsp;prints&nbsp;to&nbsp;standard&nbsp;error&nbsp;the&nbsp;stack&nbsp;trace&nbsp;returned&nbsp;by&nbsp;Stack.</span><br>
<span class="lineno">25</span><span class="keyword" id="5542087">func</span>&nbsp;<span class="ident" id="5542092">PrintStack</span><span class="op" id="5542102">(</span><span class="op" id="5542103">)</span>&nbsp;<span class="op" id="5542105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5542108">os</span><span class="op" id="5542110">.</span><span class="ident" id="5542111">Stderr</span><span class="op" id="5542117">.</span><span class="ident" id="5542118">Write</span><span class="op" id="5542123">(</span><span class="ident" id="5542124">stack</span><span class="op" id="5542129">(</span><span class="op" id="5542130">)</span><span class="op" id="5542131">)</span><br>
<span class="lineno"></span><span class="op" id="5542133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5542136">//&nbsp;Stack&nbsp;returns&nbsp;a&nbsp;formatted&nbsp;stack&nbsp;trace&nbsp;of&nbsp;the&nbsp;goroutine&nbsp;that&nbsp;calls&nbsp;it.</span><br>
<span class="lineno">30</span><span class="comment" id="5542209">//&nbsp;For&nbsp;each&nbsp;routine,&nbsp;it&nbsp;includes&nbsp;the&nbsp;source&nbsp;line&nbsp;information&nbsp;and&nbsp;PC&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="5542284">//&nbsp;then&nbsp;attempts&nbsp;to&nbsp;discover,&nbsp;for&nbsp;Go&nbsp;functions,&nbsp;the&nbsp;calling&nbsp;function&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5542356">//&nbsp;method&nbsp;and&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;line&nbsp;containing&nbsp;the&nbsp;invocation.</span><br>
<span class="lineno"></span><span class="comment" id="5542418">//</span><br>
<span class="lineno"></span><span class="comment" id="5542421">//&nbsp;This&nbsp;function&nbsp;is&nbsp;deprecated.&nbsp;Use&nbsp;package&nbsp;runtime&#39;s&nbsp;Stack&nbsp;instead.</span><br>
<span class="lineno">35</span><span class="keyword" id="5542490">func</span>&nbsp;<span class="ident" id="5542495">Stack</span><span class="op" id="5542500">(</span><span class="op" id="5542501">)</span>&nbsp;<span class="op" id="5542503">[</span><span class="op" id="5542504">]</span><span class="builtintype" id="5542505">byte</span>&nbsp;<span class="op" id="5542510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5542513">return</span>&nbsp;<span class="ident" id="5542520">stack</span><span class="op" id="5542525">(</span><span class="op" id="5542526">)</span><br>
<span class="lineno"></span><span class="op" id="5542528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5542531">//&nbsp;stack&nbsp;implements&nbsp;Stack,&nbsp;skipping&nbsp;2&nbsp;frames</span><br>
<span class="lineno">40</span><span class="keyword" id="5542576">func</span>&nbsp;<span class="ident" id="5542581">stack</span><span class="op" id="5542586">(</span><span class="op" id="5542587">)</span>&nbsp;<span class="op" id="5542589">[</span><span class="op" id="5542590">]</span><span class="builtintype" id="5542591">byte</span>&nbsp;<span class="op" id="5542596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5542599">buf</span>&nbsp;<span class="op" id="5542603">:=</span>&nbsp;<span class="builtinfunc" id="5542606">new</span><span class="op" id="5542609">(</span><span class="ident" id="5542610">bytes</span><span class="op" id="5542615">.</span><span class="ident" id="5542616">Buffer</span><span class="op" id="5542622">)</span>&nbsp;<span class="comment" id="5542624">//&nbsp;the&nbsp;returned&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5542646">//&nbsp;As&nbsp;we&nbsp;loop,&nbsp;we&nbsp;open&nbsp;files&nbsp;and&nbsp;read&nbsp;them.&nbsp;These&nbsp;variables&nbsp;record&nbsp;the&nbsp;currently</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5542728">//&nbsp;loaded&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5542745">var</span>&nbsp;<span class="ident" id="5542749">lines</span>&nbsp;<span class="op" id="5542755">[</span><span class="op" id="5542756">]</span><span class="op" id="5542757">[</span><span class="op" id="5542758">]</span><span class="builtintype" id="5542759">byte</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5542765">var</span>&nbsp;<span class="ident" id="5542769">lastFile</span>&nbsp;<span class="builtintype" id="5542778">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5542786">for</span>&nbsp;<span class="ident" id="5542790">i</span>&nbsp;<span class="op" id="5542792">:=</span>&nbsp;<span class="num" id="5542795">2</span><span class="op" id="5542796">;</span>&nbsp;<span class="op" id="5542798">;</span>&nbsp;<span class="ident" id="5542800">i</span><span class="op" id="5542801">++</span>&nbsp;<span class="op" id="5542804">{</span>&nbsp;<span class="comment" id="5542806">//&nbsp;Caller&nbsp;we&nbsp;care&nbsp;about&nbsp;is&nbsp;the&nbsp;user,&nbsp;2&nbsp;frames&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5542857">pc</span><span class="op" id="5542859">,</span>&nbsp;<span class="ident" id="5542861">file</span><span class="op" id="5542865">,</span>&nbsp;<span class="ident" id="5542867">line</span><span class="op" id="5542871">,</span>&nbsp;<span class="ident" id="5542873">ok</span>&nbsp;<span class="op" id="5542876">:=</span>&nbsp;<span class="ident" id="5542879">runtime</span><span class="op" id="5542886">.</span><span class="ident" id="5542887">Caller</span><span class="op" id="5542893">(</span><span class="ident" id="5542894">i</span><span class="op" id="5542895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5542899">if</span>&nbsp;<span class="op" id="5542902">!</span><span class="ident" id="5542903">ok</span>&nbsp;<span class="op" id="5542906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5542911">break</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5542919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5542923">//&nbsp;Print&nbsp;this&nbsp;much&nbsp;at&nbsp;least.&nbsp;&nbsp;If&nbsp;we&nbsp;can&#39;t&nbsp;find&nbsp;the&nbsp;source,&nbsp;it&nbsp;won&#39;t&nbsp;show.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5542999">fmt</span><span class="op" id="5543002">.</span><span class="ident" id="5543003">Fprintf</span><span class="op" id="5543010">(</span><span class="ident" id="5543011">buf</span><span class="op" id="5543014">,</span>&nbsp;<span class="string" id="5543016">&#34;%s:%d&nbsp;(0x%x)\n&#34;</span><span class="op" id="5543032">,</span>&nbsp;<span class="ident" id="5543034">file</span><span class="op" id="5543038">,</span>&nbsp;<span class="ident" id="5543040">line</span><span class="op" id="5543044">,</span>&nbsp;<span class="ident" id="5543046">pc</span><span class="op" id="5543048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5543052">if</span>&nbsp;<span class="ident" id="5543055">file</span>&nbsp;<span class="op" id="5543060">!=</span>&nbsp;<span class="ident" id="5543063">lastFile</span>&nbsp;<span class="op" id="5543072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5543077">data</span><span class="op" id="5543081">,</span>&nbsp;<span class="ident" id="5543083">err</span>&nbsp;<span class="op" id="5543087">:=</span>&nbsp;<span class="ident" id="5543090">ioutil</span><span class="op" id="5543096">.</span><span class="ident" id="5543097">ReadFile</span><span class="op" id="5543105">(</span><span class="ident" id="5543106">file</span><span class="op" id="5543110">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5543115">if</span>&nbsp;<span class="ident" id="5543118">err</span>&nbsp;<span class="op" id="5543122">!=</span>&nbsp;<span class="builtintype" id="5543125">nil</span>&nbsp;<span class="op" id="5543129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5543135">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5543147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5543152">lines</span>&nbsp;<span class="op" id="5543158">=</span>&nbsp;<span class="ident" id="5543160">bytes</span><span class="op" id="5543165">.</span><span class="ident" id="5543166">Split</span><span class="op" id="5543171">(</span><span class="ident" id="5543172">data</span><span class="op" id="5543176">,</span>&nbsp;<span class="op" id="5543178">[</span><span class="op" id="5543179">]</span><span class="builtintype" id="5543180">byte</span><span class="op" id="5543184">{</span><span class="string" id="5543185">&#39;\n&#39;</span><span class="op" id="5543189">}</span><span class="op" id="5543190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5543195">lastFile</span>&nbsp;<span class="op" id="5543204">=</span>&nbsp;<span class="ident" id="5543206">file</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5543213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5543217">line</span><span class="op" id="5543221">--</span>&nbsp;<span class="comment" id="5543224">//&nbsp;in&nbsp;stack&nbsp;trace,&nbsp;lines&nbsp;are&nbsp;1-indexed&nbsp;but&nbsp;our&nbsp;array&nbsp;is&nbsp;0-indexed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5543292">fmt</span><span class="op" id="5543295">.</span><span class="ident" id="5543296">Fprintf</span><span class="op" id="5543303">(</span><span class="ident" id="5543304">buf</span><span class="op" id="5543307">,</span>&nbsp;<span class="string" id="5543309">&#34;\t%s:&nbsp;%s\n&#34;</span><span class="op" id="5543321">,</span>&nbsp;<span class="ident" id="5543323">function</span><span class="op" id="5543331">(</span><span class="ident" id="5543332">pc</span><span class="op" id="5543334">)</span><span class="op" id="5543335">,</span>&nbsp;<span class="ident" id="5543337">source</span><span class="op" id="5543343">(</span><span class="ident" id="5543344">lines</span><span class="op" id="5543349">,</span>&nbsp;<span class="ident" id="5543351">line</span><span class="op" id="5543355">)</span><span class="op" id="5543356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5543359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5543362">return</span>&nbsp;<span class="ident" id="5543369">buf</span><span class="op" id="5543372">.</span><span class="ident" id="5543373">Bytes</span><span class="op" id="5543378">(</span><span class="op" id="5543379">)</span><br>
<span class="lineno">65</span><span class="op" id="5543381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5543384">//&nbsp;source&nbsp;returns&nbsp;a&nbsp;space-trimmed&nbsp;slice&nbsp;of&nbsp;the&nbsp;n&#39;th&nbsp;line.</span><br>
<span class="lineno"></span><span class="keyword" id="5543442">func</span>&nbsp;<span class="ident" id="5543447">source</span><span class="op" id="5543453">(</span><span class="ident" id="5543454">lines</span>&nbsp;<span class="op" id="5543460">[</span><span class="op" id="5543461">]</span><span class="op" id="5543462">[</span><span class="op" id="5543463">]</span><span class="builtintype" id="5543464">byte</span><span class="op" id="5543468">,</span>&nbsp;<span class="ident" id="5543470">n</span>&nbsp;<span class="builtintype" id="5543472">int</span><span class="op" id="5543475">)</span>&nbsp;<span class="op" id="5543477">[</span><span class="op" id="5543478">]</span><span class="builtintype" id="5543479">byte</span>&nbsp;<span class="op" id="5543484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5543487">if</span>&nbsp;<span class="ident" id="5543490">n</span>&nbsp;<span class="op" id="5543492">&lt;</span>&nbsp;<span class="num" id="5543494">0</span>&nbsp;<span class="op" id="5543496">||</span>&nbsp;<span class="ident" id="5543499">n</span>&nbsp;<span class="op" id="5543501">&gt;=</span>&nbsp;<span class="builtinfunc" id="5543504">len</span><span class="op" id="5543507">(</span><span class="ident" id="5543508">lines</span><span class="op" id="5543513">)</span>&nbsp;<span class="op" id="5543515">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5543519">return</span>&nbsp;<span class="ident" id="5543526">dunno</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5543533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5543536">return</span>&nbsp;<span class="ident" id="5543543">bytes</span><span class="op" id="5543548">.</span><span class="ident" id="5543549">Trim</span><span class="op" id="5543553">(</span><span class="ident" id="5543554">lines</span><span class="op" id="5543559">[</span><span class="ident" id="5543560">n</span><span class="op" id="5543561">]</span><span class="op" id="5543562">,</span>&nbsp;<span class="string" id="5543564">&#34;&nbsp;\t&#34;</span><span class="op" id="5543569">)</span><br>
<span class="lineno"></span><span class="op" id="5543571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="5543574">//&nbsp;function&nbsp;returns,&nbsp;if&nbsp;possible,&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;function&nbsp;containing&nbsp;the&nbsp;PC.</span><br>
<span class="lineno"></span><span class="keyword" id="5543652">func</span>&nbsp;<span class="ident" id="5543657">function</span><span class="op" id="5543665">(</span><span class="ident" id="5543666">pc</span>&nbsp;<span class="builtintype" id="5543669">uintptr</span><span class="op" id="5543676">)</span>&nbsp;<span class="op" id="5543678">[</span><span class="op" id="5543679">]</span><span class="builtintype" id="5543680">byte</span>&nbsp;<span class="op" id="5543685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5543688">fn</span>&nbsp;<span class="op" id="5543691">:=</span>&nbsp;<span class="ident" id="5543694">runtime</span><span class="op" id="5543701">.</span><span class="ident" id="5543702">FuncForPC</span><span class="op" id="5543711">(</span><span class="ident" id="5543712">pc</span><span class="op" id="5543714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5543717">if</span>&nbsp;<span class="ident" id="5543720">fn</span>&nbsp;<span class="op" id="5543723">==</span>&nbsp;<span class="builtintype" id="5543726">nil</span>&nbsp;<span class="op" id="5543730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5543734">return</span>&nbsp;<span class="ident" id="5543741">dunno</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5543748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5543751">name</span>&nbsp;<span class="op" id="5543756">:=</span>&nbsp;<span class="op" id="5543759">[</span><span class="op" id="5543760">]</span><span class="builtintype" id="5543761">byte</span><span class="op" id="5543765">(</span><span class="ident" id="5543766">fn</span><span class="op" id="5543768">.</span><span class="ident" id="5543769">Name</span><span class="op" id="5543773">(</span><span class="op" id="5543774">)</span><span class="op" id="5543775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5543778">//&nbsp;The&nbsp;name&nbsp;includes&nbsp;the&nbsp;path&nbsp;name&nbsp;to&nbsp;the&nbsp;package,&nbsp;which&nbsp;is&nbsp;unnecessary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5543851">//&nbsp;since&nbsp;the&nbsp;file&nbsp;name&nbsp;is&nbsp;already&nbsp;included.&nbsp;&nbsp;Plus,&nbsp;it&nbsp;has&nbsp;center&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5543923">//&nbsp;That&nbsp;is,&nbsp;we&nbsp;see</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5543943">//&nbsp;&nbsp;&nbsp;&nbsp;runtime/debug.*TÂ·ptrmethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5543975">//&nbsp;and&nbsp;want</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5543988">//&nbsp;&nbsp;&nbsp;&nbsp;*T.ptrmethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5544005">//&nbsp;Since&nbsp;the&nbsp;package&nbsp;path&nbsp;might&nbsp;contains&nbsp;dots&nbsp;(e.g.&nbsp;code.google.com/...),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5544080">//&nbsp;we&nbsp;first&nbsp;remove&nbsp;the&nbsp;path&nbsp;prefix&nbsp;if&nbsp;there&nbsp;is&nbsp;one.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5544133">if</span>&nbsp;<span class="ident" id="5544136">lastslash</span>&nbsp;<span class="op" id="5544146">:=</span>&nbsp;<span class="ident" id="5544149">bytes</span><span class="op" id="5544154">.</span><span class="ident" id="5544155">LastIndex</span><span class="op" id="5544164">(</span><span class="ident" id="5544165">name</span><span class="op" id="5544169">,</span>&nbsp;<span class="ident" id="5544171">slash</span><span class="op" id="5544176">)</span><span class="op" id="5544177">;</span>&nbsp;<span class="ident" id="5544179">lastslash</span>&nbsp;<span class="op" id="5544189">&gt;=</span>&nbsp;<span class="num" id="5544192">0</span>&nbsp;<span class="op" id="5544194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5544198">name</span>&nbsp;<span class="op" id="5544203">=</span>&nbsp;<span class="ident" id="5544205">name</span><span class="op" id="5544209">[</span><span class="ident" id="5544210">lastslash</span><span class="op" id="5544219">+</span><span class="num" id="5544220">1</span><span class="op" id="5544221">:</span><span class="op" id="5544222">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5544225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5544228">if</span>&nbsp;<span class="ident" id="5544231">period</span>&nbsp;<span class="op" id="5544238">:=</span>&nbsp;<span class="ident" id="5544241">bytes</span><span class="op" id="5544246">.</span><span class="ident" id="5544247">Index</span><span class="op" id="5544252">(</span><span class="ident" id="5544253">name</span><span class="op" id="5544257">,</span>&nbsp;<span class="ident" id="5544259">dot</span><span class="op" id="5544262">)</span><span class="op" id="5544263">;</span>&nbsp;<span class="ident" id="5544265">period</span>&nbsp;<span class="op" id="5544272">&gt;=</span>&nbsp;<span class="num" id="5544275">0</span>&nbsp;<span class="op" id="5544277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5544281">name</span>&nbsp;<span class="op" id="5544286">=</span>&nbsp;<span class="ident" id="5544288">name</span><span class="op" id="5544292">[</span><span class="ident" id="5544293">period</span><span class="op" id="5544299">+</span><span class="num" id="5544300">1</span><span class="op" id="5544301">:</span><span class="op" id="5544302">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5544305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5544308">name</span>&nbsp;<span class="op" id="5544313">=</span>&nbsp;<span class="ident" id="5544315">bytes</span><span class="op" id="5544320">.</span><span class="ident" id="5544321">Replace</span><span class="op" id="5544328">(</span><span class="ident" id="5544329">name</span><span class="op" id="5544333">,</span>&nbsp;<span class="ident" id="5544335">centerDot</span><span class="op" id="5544344">,</span>&nbsp;<span class="ident" id="5544346">dot</span><span class="op" id="5544349">,</span>&nbsp;<span class="op" id="5544351">-</span><span class="num" id="5544352">1</span><span class="op" id="5544353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5544356">return</span>&nbsp;<span class="ident" id="5544363">name</span><br>
<span class="lineno"></span><span class="op" id="5544368">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
