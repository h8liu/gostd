<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4074963">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4075018">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4075072">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4075123">package</span>&nbsp;<span class="ident" id="4075131">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4075137">import</span>&nbsp;<span class="op" id="4075144">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4075147">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4075163">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4075182">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4075199">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4075209">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4075216">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4075227">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4075230">const</span>&nbsp;<span class="ident" id="4075236">ecPrivKeyVersion</span>&nbsp;<span class="op" id="4075253">=</span>&nbsp;<span class="num" id="4075255">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4075258">//&nbsp;ecPrivateKey&nbsp;reflects&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="4075330">//&nbsp;References:</span><br>
<span class="lineno">20</span><span class="comment" id="4075345">//&nbsp;&nbsp;&nbsp;RFC5915</span><br>
<span class="lineno"></span><span class="comment" id="4075358">//&nbsp;&nbsp;&nbsp;SEC1&nbsp;-&nbsp;http://www.secg.org/download/aid-780/sec1-v2.pdf</span><br>
<span class="lineno"></span><span class="comment" id="4075419">//&nbsp;Per&nbsp;RFC5915&nbsp;the&nbsp;NamedCurveOID&nbsp;is&nbsp;marked&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL,&nbsp;however&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4075492">//&nbsp;most&nbsp;cases&nbsp;it&nbsp;is&nbsp;not.</span><br>
<span class="lineno"></span><span class="keyword" id="4075517">type</span>&nbsp;<span class="ident" id="4075522">ecPrivateKey</span>&nbsp;<span class="keyword" id="4075535">struct</span>&nbsp;<span class="op" id="4075542">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075545">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4075559">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075564">PrivateKey</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4075578">[</span><span class="op" id="4075579">]</span><span class="builtintype" id="4075580">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075586">NamedCurveOID</span>&nbsp;<span class="ident" id="4075600">asn1</span><span class="op" id="4075604">.</span><span class="ident" id="4075605">ObjectIdentifier</span>&nbsp;<span class="string" id="4075622">`asn1:&#34;optional,explicit,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4075656">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4075670">asn1</span><span class="op" id="4075674">.</span><span class="ident" id="4075675">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4075692">`asn1:&#34;optional,explicit,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4075725">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="4075728">//&nbsp;ParseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="keyword" id="4075803">func</span>&nbsp;<span class="ident" id="4075808">ParseECPrivateKey</span><span class="op" id="4075825">(</span><span class="ident" id="4075826">der</span>&nbsp;<span class="op" id="4075830">[</span><span class="op" id="4075831">]</span><span class="builtintype" id="4075832">byte</span><span class="op" id="4075836">)</span>&nbsp;<span class="op" id="4075838">(</span><span class="ident" id="4075839">key</span>&nbsp;<span class="op" id="4075843">*</span><span class="ident" id="4075844">ecdsa</span><span class="op" id="4075849">.</span><span class="ident" id="4075850">PrivateKey</span><span class="op" id="4075860">,</span>&nbsp;<span class="ident" id="4075862">err</span>&nbsp;<span class="builtintype" id="4075866">error</span><span class="op" id="4075871">)</span>&nbsp;<span class="op" id="4075873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4075876">return</span>&nbsp;<span class="ident" id="4075883">parseECPrivateKey</span><span class="op" id="4075900">(</span><span class="ident" id="4075901">nil</span><span class="op" id="4075904">,</span>&nbsp;<span class="ident" id="4075906">der</span><span class="op" id="4075909">)</span><br>
<span class="lineno"></span><span class="op" id="4075911">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4075914">//&nbsp;MarshalECPrivateKey&nbsp;marshals&nbsp;an&nbsp;EC&nbsp;private&nbsp;key&nbsp;into&nbsp;ASN.1,&nbsp;DER&nbsp;format.</span><br>
<span class="lineno"></span><span class="keyword" id="4075988">func</span>&nbsp;<span class="ident" id="4075993">MarshalECPrivateKey</span><span class="op" id="4076012">(</span><span class="ident" id="4076013">key</span>&nbsp;<span class="op" id="4076017">*</span><span class="ident" id="4076018">ecdsa</span><span class="op" id="4076023">.</span><span class="ident" id="4076024">PrivateKey</span><span class="op" id="4076034">)</span>&nbsp;<span class="op" id="4076036">(</span><span class="op" id="4076037">[</span><span class="op" id="4076038">]</span><span class="builtintype" id="4076039">byte</span><span class="op" id="4076043">,</span>&nbsp;<span class="builtintype" id="4076045">error</span><span class="op" id="4076050">)</span>&nbsp;<span class="op" id="4076052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076055">oid</span><span class="op" id="4076058">,</span>&nbsp;<span class="ident" id="4076060">ok</span>&nbsp;<span class="op" id="4076063">:=</span>&nbsp;<span class="ident" id="4076066">oidFromNamedCurve</span><span class="op" id="4076083">(</span><span class="ident" id="4076084">key</span><span class="op" id="4076087">.</span><span class="ident" id="4076088">Curve</span><span class="op" id="4076093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076096">if</span>&nbsp;<span class="op" id="4076099">!</span><span class="ident" id="4076100">ok</span>&nbsp;<span class="op" id="4076103">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076107">return</span>&nbsp;<span class="ident" id="4076114">nil</span><span class="op" id="4076117">,</span>&nbsp;<span class="ident" id="4076119">errors</span><span class="op" id="4076125">.</span><span class="ident" id="4076126">New</span><span class="op" id="4076129">(</span><span class="string" id="4076130">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4076160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4076163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076166">return</span>&nbsp;<span class="ident" id="4076173">asn1</span><span class="op" id="4076177">.</span><span class="ident" id="4076178">Marshal</span><span class="op" id="4076185">(</span><span class="ident" id="4076186">ecPrivateKey</span><span class="op" id="4076198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076202">Version</span><span class="op" id="4076209">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4076217">1</span><span class="op" id="4076218">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076222">PrivateKey</span><span class="op" id="4076232">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4076237">key</span><span class="op" id="4076240">.</span><span class="ident" id="4076241">D</span><span class="op" id="4076242">.</span><span class="ident" id="4076243">Bytes</span><span class="op" id="4076248">(</span><span class="op" id="4076249">)</span><span class="op" id="4076250">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076254">NamedCurveOID</span><span class="op" id="4076267">:</span>&nbsp;<span class="ident" id="4076269">oid</span><span class="op" id="4076272">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4076276">PublicKey</span><span class="op" id="4076285">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4076291">asn1</span><span class="op" id="4076295">.</span><span class="ident" id="4076296">BitString</span><span class="op" id="4076305">{</span><span class="ident" id="4076306">Bytes</span><span class="op" id="4076311">:</span>&nbsp;<span class="ident" id="4076313">elliptic</span><span class="op" id="4076321">.</span><span class="ident" id="4076322">Marshal</span><span class="op" id="4076329">(</span><span class="ident" id="4076330">key</span><span class="op" id="4076333">.</span><span class="ident" id="4076334">Curve</span><span class="op" id="4076339">,</span>&nbsp;<span class="ident" id="4076341">key</span><span class="op" id="4076344">.</span><span class="ident" id="4076345">X</span><span class="op" id="4076346">,</span>&nbsp;<span class="ident" id="4076348">key</span><span class="op" id="4076351">.</span><span class="ident" id="4076352">Y</span><span class="op" id="4076353">)</span><span class="op" id="4076354">}</span><span class="op" id="4076355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4076358">}</span><span class="op" id="4076359">)</span><br>
<span class="lineno"></span><span class="op" id="4076361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="4076364">//&nbsp;parseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="4076439">//&nbsp;The&nbsp;OID&nbsp;for&nbsp;the&nbsp;named&nbsp;curve&nbsp;may&nbsp;be&nbsp;provided&nbsp;from&nbsp;another&nbsp;source&nbsp;(such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="4076515">//&nbsp;the&nbsp;PKCS8&nbsp;container)&nbsp;-&nbsp;if&nbsp;it&nbsp;is&nbsp;provided&nbsp;then&nbsp;use&nbsp;this&nbsp;instead&nbsp;of&nbsp;the&nbsp;OID</span><br>
<span class="lineno"></span><span class="comment" id="4076592">//&nbsp;that&nbsp;may&nbsp;exist&nbsp;in&nbsp;the&nbsp;EC&nbsp;private&nbsp;key&nbsp;structure.</span><br>
<span class="lineno"></span><span class="keyword" id="4076643">func</span>&nbsp;<span class="ident" id="4076648">parseECPrivateKey</span><span class="op" id="4076665">(</span><span class="ident" id="4076666">namedCurveOID</span>&nbsp;<span class="op" id="4076680">*</span><span class="ident" id="4076681">asn1</span><span class="op" id="4076685">.</span><span class="ident" id="4076686">ObjectIdentifier</span><span class="op" id="4076702">,</span>&nbsp;<span class="ident" id="4076704">der</span>&nbsp;<span class="op" id="4076708">[</span><span class="op" id="4076709">]</span><span class="builtintype" id="4076710">byte</span><span class="op" id="4076714">)</span>&nbsp;<span class="op" id="4076716">(</span><span class="ident" id="4076717">key</span>&nbsp;<span class="op" id="4076721">*</span><span class="ident" id="4076722">ecdsa</span><span class="op" id="4076727">.</span><span class="ident" id="4076728">PrivateKey</span><span class="op" id="4076738">,</span>&nbsp;<span class="ident" id="4076740">err</span>&nbsp;<span class="builtintype" id="4076744">error</span><span class="op" id="4076749">)</span>&nbsp;<span class="op" id="4076751">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076754">var</span>&nbsp;<span class="ident" id="4076758">privKey</span>&nbsp;<span class="ident" id="4076766">ecPrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076780">if</span>&nbsp;<span class="ident" id="4076783">_</span><span class="op" id="4076784">,</span>&nbsp;<span class="ident" id="4076786">err</span>&nbsp;<span class="op" id="4076790">:=</span>&nbsp;<span class="ident" id="4076793">asn1</span><span class="op" id="4076797">.</span><span class="ident" id="4076798">Unmarshal</span><span class="op" id="4076807">(</span><span class="ident" id="4076808">der</span><span class="op" id="4076811">,</span>&nbsp;<span class="op" id="4076813">&amp;</span><span class="ident" id="4076814">privKey</span><span class="op" id="4076821">)</span><span class="op" id="4076822">;</span>&nbsp;<span class="ident" id="4076824">err</span>&nbsp;<span class="op" id="4076828">!=</span>&nbsp;<span class="ident" id="4076831">nil</span>&nbsp;<span class="op" id="4076835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076839">return</span>&nbsp;<span class="ident" id="4076846">nil</span><span class="op" id="4076849">,</span>&nbsp;<span class="ident" id="4076851">errors</span><span class="op" id="4076857">.</span><span class="ident" id="4076858">New</span><span class="op" id="4076861">(</span><span class="string" id="4076862">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;EC&nbsp;private&nbsp;key:&nbsp;&#34;</span>&nbsp;<span class="op" id="4076903">+</span>&nbsp;<span class="ident" id="4076905">err</span><span class="op" id="4076908">.</span><span class="ident" id="4076909">Error</span><span class="op" id="4076914">(</span><span class="op" id="4076915">)</span><span class="op" id="4076916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4076919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076922">if</span>&nbsp;<span class="ident" id="4076925">privKey</span><span class="op" id="4076932">.</span><span class="ident" id="4076933">Version</span>&nbsp;<span class="op" id="4076941">!=</span>&nbsp;<span class="ident" id="4076944">ecPrivKeyVersion</span>&nbsp;<span class="op" id="4076961">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4076965">return</span>&nbsp;<span class="ident" id="4076972">nil</span><span class="op" id="4076975">,</span>&nbsp;<span class="ident" id="4076977">fmt</span><span class="op" id="4076980">.</span><span class="ident" id="4076981">Errorf</span><span class="op" id="4076987">(</span><span class="string" id="4076988">&#34;x509:&nbsp;unknown&nbsp;EC&nbsp;private&nbsp;key&nbsp;version&nbsp;%d&#34;</span><span class="op" id="4077029">,</span>&nbsp;<span class="ident" id="4077031">privKey</span><span class="op" id="4077038">.</span><span class="ident" id="4077039">Version</span><span class="op" id="4077046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4077049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4077053">var</span>&nbsp;<span class="ident" id="4077057">curve</span>&nbsp;<span class="ident" id="4077063">elliptic</span><span class="op" id="4077071">.</span><span class="ident" id="4077072">Curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4077079">if</span>&nbsp;<span class="ident" id="4077082">namedCurveOID</span>&nbsp;<span class="op" id="4077096">!=</span>&nbsp;<span class="ident" id="4077099">nil</span>&nbsp;<span class="op" id="4077103">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077107">curve</span>&nbsp;<span class="op" id="4077113">=</span>&nbsp;<span class="ident" id="4077115">namedCurveFromOID</span><span class="op" id="4077132">(</span><span class="op" id="4077133">*</span><span class="ident" id="4077134">namedCurveOID</span><span class="op" id="4077147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4077150">}</span>&nbsp;<span class="keyword" id="4077152">else</span>&nbsp;<span class="op" id="4077157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077161">curve</span>&nbsp;<span class="op" id="4077167">=</span>&nbsp;<span class="ident" id="4077169">namedCurveFromOID</span><span class="op" id="4077186">(</span><span class="ident" id="4077187">privKey</span><span class="op" id="4077194">.</span><span class="ident" id="4077195">NamedCurveOID</span><span class="op" id="4077208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4077211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4077214">if</span>&nbsp;<span class="ident" id="4077217">curve</span>&nbsp;<span class="op" id="4077223">==</span>&nbsp;<span class="ident" id="4077226">nil</span>&nbsp;<span class="op" id="4077230">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4077234">return</span>&nbsp;<span class="ident" id="4077241">nil</span><span class="op" id="4077244">,</span>&nbsp;<span class="ident" id="4077246">errors</span><span class="op" id="4077252">.</span><span class="ident" id="4077253">New</span><span class="op" id="4077256">(</span><span class="string" id="4077257">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4077287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4077290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077294">k</span>&nbsp;<span class="op" id="4077296">:=</span>&nbsp;<span class="builtinfunc" id="4077299">new</span><span class="op" id="4077302">(</span><span class="ident" id="4077303">big</span><span class="op" id="4077306">.</span><span class="ident" id="4077307">Int</span><span class="op" id="4077310">)</span><span class="op" id="4077311">.</span><span class="ident" id="4077312">SetBytes</span><span class="op" id="4077320">(</span><span class="ident" id="4077321">privKey</span><span class="op" id="4077328">.</span><span class="ident" id="4077329">PrivateKey</span><span class="op" id="4077339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4077342">if</span>&nbsp;<span class="ident" id="4077345">k</span><span class="op" id="4077346">.</span><span class="ident" id="4077347">Cmp</span><span class="op" id="4077350">(</span><span class="ident" id="4077351">curve</span><span class="op" id="4077356">.</span><span class="ident" id="4077357">Params</span><span class="op" id="4077363">(</span><span class="op" id="4077364">)</span><span class="op" id="4077365">.</span><span class="ident" id="4077366">N</span><span class="op" id="4077367">)</span>&nbsp;<span class="op" id="4077369">&gt;=</span>&nbsp;<span class="num" id="4077372">0</span>&nbsp;<span class="op" id="4077374">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4077378">return</span>&nbsp;<span class="ident" id="4077385">nil</span><span class="op" id="4077388">,</span>&nbsp;<span class="ident" id="4077390">errors</span><span class="op" id="4077396">.</span><span class="ident" id="4077397">New</span><span class="op" id="4077400">(</span><span class="string" id="4077401">&#34;x509:&nbsp;invalid&nbsp;elliptic&nbsp;curve&nbsp;private&nbsp;key&nbsp;value&#34;</span><span class="op" id="4077449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4077452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077455">priv</span>&nbsp;<span class="op" id="4077460">:=</span>&nbsp;<span class="builtinfunc" id="4077463">new</span><span class="op" id="4077466">(</span><span class="ident" id="4077467">ecdsa</span><span class="op" id="4077472">.</span><span class="ident" id="4077473">PrivateKey</span><span class="op" id="4077483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077486">priv</span><span class="op" id="4077490">.</span><span class="ident" id="4077491">Curve</span>&nbsp;<span class="op" id="4077497">=</span>&nbsp;<span class="ident" id="4077499">curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077506">priv</span><span class="op" id="4077510">.</span><span class="ident" id="4077511">D</span>&nbsp;<span class="op" id="4077513">=</span>&nbsp;<span class="ident" id="4077515">k</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077518">priv</span><span class="op" id="4077522">.</span><span class="ident" id="4077523">X</span><span class="op" id="4077524">,</span>&nbsp;<span class="ident" id="4077526">priv</span><span class="op" id="4077530">.</span><span class="ident" id="4077531">Y</span>&nbsp;<span class="op" id="4077533">=</span>&nbsp;<span class="ident" id="4077535">curve</span><span class="op" id="4077540">.</span><span class="ident" id="4077541">ScalarBaseMult</span><span class="op" id="4077555">(</span><span class="ident" id="4077556">privKey</span><span class="op" id="4077563">.</span><span class="ident" id="4077564">PrivateKey</span><span class="op" id="4077574">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4077578">return</span>&nbsp;<span class="ident" id="4077585">priv</span><span class="op" id="4077589">,</span>&nbsp;<span class="ident" id="4077591">nil</span><br>
<span class="lineno"></span><span class="op" id="4077595">}</span>
</div>
</body>
</html>
