<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http/httptest</h2>
<ul>
<li><a href="/gostd/net/http/httptest/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/httptest/recorder.go.html">recorder.go</a></li>
<li><a href="/gostd/net/http/httptest/recorder_test.go.html">recorder_test.go</a></li>
<li><a href="/gostd/net/http/httptest/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/httptest/server_test.go.html" class="current">server_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7894867">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7894922">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7894976">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7895027">package</span>&nbsp;<span class="ident" id="7895035">httptest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7895045">import</span>&nbsp;<span class="op" id="7895052">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7895055">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7895068">&#34;net/http&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7895080">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7895090">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7895093">func</span>&nbsp;<span class="ident" id="7895098">TestServer</span><span class="op" id="7895108">(</span><span class="ident" id="7895109">t</span>&nbsp;<span class="op" id="7895111">*</span><span class="ident" id="7895112">testing</span><span class="op" id="7895119">.</span><span class="ident" id="7895120">T</span><span class="op" id="7895121">)</span>&nbsp;<span class="op" id="7895123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7895126">ts</span>&nbsp;<span class="op" id="7895129">:=</span>&nbsp;<span class="ident" id="7895132">NewServer</span><span class="op" id="7895141">(</span><span class="ident" id="7895142">http</span><span class="op" id="7895146">.</span><span class="ident" id="7895147">HandlerFunc</span><span class="op" id="7895158">(</span><span class="keyword" id="7895159">func</span><span class="op" id="7895163">(</span><span class="ident" id="7895164">w</span>&nbsp;<span class="ident" id="7895166">http</span><span class="op" id="7895170">.</span><span class="ident" id="7895171">ResponseWriter</span><span class="op" id="7895185">,</span>&nbsp;<span class="ident" id="7895187">r</span>&nbsp;<span class="op" id="7895189">*</span><span class="ident" id="7895190">http</span><span class="op" id="7895194">.</span><span class="ident" id="7895195">Request</span><span class="op" id="7895202">)</span>&nbsp;<span class="op" id="7895204">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7895208">w</span><span class="op" id="7895209">.</span><span class="ident" id="7895210">Write</span><span class="op" id="7895215">(</span><span class="op" id="7895216">[</span><span class="op" id="7895217">]</span><span class="builtintype" id="7895218">byte</span><span class="op" id="7895222">(</span><span class="string" id="7895223">&#34;hello&#34;</span><span class="op" id="7895230">)</span><span class="op" id="7895231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7895234">}</span><span class="op" id="7895235">)</span><span class="op" id="7895236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7895239">defer</span>&nbsp;<span class="ident" id="7895245">ts</span><span class="op" id="7895247">.</span><span class="ident" id="7895248">Close</span><span class="op" id="7895253">(</span><span class="op" id="7895254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7895257">res</span><span class="op" id="7895260">,</span>&nbsp;<span class="ident" id="7895262">err</span>&nbsp;<span class="op" id="7895266">:=</span>&nbsp;<span class="ident" id="7895269">http</span><span class="op" id="7895273">.</span><span class="ident" id="7895274">Get</span><span class="op" id="7895277">(</span><span class="ident" id="7895278">ts</span><span class="op" id="7895280">.</span><span class="ident" id="7895281">URL</span><span class="op" id="7895284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7895287">if</span>&nbsp;<span class="ident" id="7895290">err</span>&nbsp;<span class="op" id="7895294">!=</span>&nbsp;<span class="ident" id="7895297">nil</span>&nbsp;<span class="op" id="7895301">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7895305">t</span><span class="op" id="7895306">.</span><span class="ident" id="7895307">Fatal</span><span class="op" id="7895312">(</span><span class="ident" id="7895313">err</span><span class="op" id="7895316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7895319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7895322">got</span><span class="op" id="7895325">,</span>&nbsp;<span class="ident" id="7895327">err</span>&nbsp;<span class="op" id="7895331">:=</span>&nbsp;<span class="ident" id="7895334">ioutil</span><span class="op" id="7895340">.</span><span class="ident" id="7895341">ReadAll</span><span class="op" id="7895348">(</span><span class="ident" id="7895349">res</span><span class="op" id="7895352">.</span><span class="ident" id="7895353">Body</span><span class="op" id="7895357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7895360">if</span>&nbsp;<span class="ident" id="7895363">err</span>&nbsp;<span class="op" id="7895367">!=</span>&nbsp;<span class="ident" id="7895370">nil</span>&nbsp;<span class="op" id="7895374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7895378">t</span><span class="op" id="7895379">.</span><span class="ident" id="7895380">Fatal</span><span class="op" id="7895385">(</span><span class="ident" id="7895386">err</span><span class="op" id="7895389">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7895392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7895395">if</span>&nbsp;<span class="builtintype" id="7895398">string</span><span class="op" id="7895404">(</span><span class="ident" id="7895405">got</span><span class="op" id="7895408">)</span>&nbsp;<span class="op" id="7895410">!=</span>&nbsp;<span class="string" id="7895413">&#34;hello&#34;</span>&nbsp;<span class="op" id="7895421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7895425">t</span><span class="op" id="7895426">.</span><span class="ident" id="7895427">Errorf</span><span class="op" id="7895433">(</span><span class="string" id="7895434">&#34;got&nbsp;%q,&nbsp;want&nbsp;hello&#34;</span><span class="op" id="7895454">,</span>&nbsp;<span class="builtintype" id="7895456">string</span><span class="op" id="7895462">(</span><span class="ident" id="7895463">got</span><span class="op" id="7895466">)</span><span class="op" id="7895467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7895470">}</span><br>
<span class="lineno"></span><span class="op" id="7895472">}</span>
</div>
</body>
</html>
