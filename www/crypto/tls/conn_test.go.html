<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7418035">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7418090">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7418144">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7418195">package</span>&nbsp;<span class="ident" id="7418203">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7418208">import</span>&nbsp;<span class="op" id="7418215">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7418218">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7418228">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="7418231">func</span>&nbsp;<span class="ident" id="7418236">TestRoundUp</span><span class="op" id="7418247">(</span><span class="ident" id="7418248">t</span>&nbsp;<span class="op" id="7418250">*</span><span class="ident" id="7418251"><a href="/crypto/tls/conn_test.go.html#7418218">testing</a></span><span class="op" id="7418258">.</span><span class="ident" id="7418259">T</span><span class="op" id="7418260">)</span>&nbsp;<span class="op" id="7418262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7418265">if</span>&nbsp;<span class="ident" id="7418268"><a href="/crypto/tls/conn.go.html#3848269">roundUp</a></span><span class="op" id="7418275">(</span><span class="num" id="7418276">0</span><span class="op" id="7418277">,</span>&nbsp;<span class="num" id="7418279">16</span><span class="op" id="7418281">)</span>&nbsp;<span class="op" id="7418283">!=</span>&nbsp;<span class="num" id="7418286">0</span>&nbsp;<span class="op" id="7418288">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7418293"><a href="/crypto/tls/conn.go.html#3848269">roundUp</a></span><span class="op" id="7418300">(</span><span class="num" id="7418301">1</span><span class="op" id="7418302">,</span>&nbsp;<span class="num" id="7418304">16</span><span class="op" id="7418306">)</span>&nbsp;<span class="op" id="7418308">!=</span>&nbsp;<span class="num" id="7418311">16</span>&nbsp;<span class="op" id="7418314">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7418319"><a href="/crypto/tls/conn.go.html#3848269">roundUp</a></span><span class="op" id="7418326">(</span><span class="num" id="7418327">15</span><span class="op" id="7418329">,</span>&nbsp;<span class="num" id="7418331">16</span><span class="op" id="7418333">)</span>&nbsp;<span class="op" id="7418335">!=</span>&nbsp;<span class="num" id="7418338">16</span>&nbsp;<span class="op" id="7418341">||</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7418346"><a href="/crypto/tls/conn.go.html#3848269">roundUp</a></span><span class="op" id="7418353">(</span><span class="num" id="7418354">16</span><span class="op" id="7418356">,</span>&nbsp;<span class="num" id="7418358">16</span><span class="op" id="7418360">)</span>&nbsp;<span class="op" id="7418362">!=</span>&nbsp;<span class="num" id="7418365">16</span>&nbsp;<span class="op" id="7418368">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7418373"><a href="/crypto/tls/conn.go.html#3848269">roundUp</a></span><span class="op" id="7418380">(</span><span class="num" id="7418381">17</span><span class="op" id="7418383">,</span>&nbsp;<span class="num" id="7418385">16</span><span class="op" id="7418387">)</span>&nbsp;<span class="op" id="7418389">!=</span>&nbsp;<span class="num" id="7418392">32</span>&nbsp;<span class="op" id="7418395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7418399"><a href="/crypto/tls/conn_test.go.html#7418248">t</a></span><span class="op" id="7418400">.</span><span class="ident" id="7418401">Error</span><span class="op" id="7418406">(</span><span class="string" id="7418407">&#34;roundUp&nbsp;broken&#34;</span><span class="op" id="7418423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7418426">}</span><br>
<span class="lineno"></span><span class="op" id="7418428">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="7418431">var</span>&nbsp;<span class="ident" id="7418435">paddingTests</span>&nbsp;<span class="op" id="7418448">=</span>&nbsp;<span class="op" id="7418450">[</span><span class="op" id="7418451">]</span><span class="keyword" id="7418452">struct</span>&nbsp;<span class="op" id="7418459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7418462">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7418474">[</span><span class="op" id="7418475">]</span><span class="builtintype" id="7418476">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7418482">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7418494">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7418500">expectedLen</span>&nbsp;<span class="builtintype" id="7418512">int</span><br>
<span class="lineno">25</span><span class="op" id="7418516">}</span><span class="op" id="7418517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7418520">{</span><span class="op" id="7418521">[</span><span class="op" id="7418522">]</span><span class="builtintype" id="7418523">byte</span><span class="op" id="7418527">{</span><span class="num" id="7418528">1</span><span class="op" id="7418529">,</span>&nbsp;<span class="num" id="7418531">2</span><span class="op" id="7418532">,</span>&nbsp;<span class="num" id="7418534">3</span><span class="op" id="7418535">,</span>&nbsp;<span class="num" id="7418537">4</span><span class="op" id="7418538">,</span>&nbsp;<span class="num" id="7418540">0</span><span class="op" id="7418541">}</span><span class="op" id="7418542">,</span>&nbsp;<span class="builtintype" id="7418544">true</span><span class="op" id="7418548">,</span>&nbsp;<span class="num" id="7418550">4</span><span class="op" id="7418551">}</span><span class="op" id="7418552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7418555">{</span><span class="op" id="7418556">[</span><span class="op" id="7418557">]</span><span class="builtintype" id="7418558">byte</span><span class="op" id="7418562">{</span><span class="num" id="7418563">1</span><span class="op" id="7418564">,</span>&nbsp;<span class="num" id="7418566">2</span><span class="op" id="7418567">,</span>&nbsp;<span class="num" id="7418569">3</span><span class="op" id="7418570">,</span>&nbsp;<span class="num" id="7418572">4</span><span class="op" id="7418573">,</span>&nbsp;<span class="num" id="7418575">0</span><span class="op" id="7418576">,</span>&nbsp;<span class="num" id="7418578">1</span><span class="op" id="7418579">}</span><span class="op" id="7418580">,</span>&nbsp;<span class="builtintype" id="7418582">false</span><span class="op" id="7418587">,</span>&nbsp;<span class="num" id="7418589">0</span><span class="op" id="7418590">}</span><span class="op" id="7418591">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7418594">{</span><span class="op" id="7418595">[</span><span class="op" id="7418596">]</span><span class="builtintype" id="7418597">byte</span><span class="op" id="7418601">{</span><span class="num" id="7418602">1</span><span class="op" id="7418603">,</span>&nbsp;<span class="num" id="7418605">2</span><span class="op" id="7418606">,</span>&nbsp;<span class="num" id="7418608">3</span><span class="op" id="7418609">,</span>&nbsp;<span class="num" id="7418611">4</span><span class="op" id="7418612">,</span>&nbsp;<span class="num" id="7418614">99</span><span class="op" id="7418616">,</span>&nbsp;<span class="num" id="7418618">99</span><span class="op" id="7418620">}</span><span class="op" id="7418621">,</span>&nbsp;<span class="builtintype" id="7418623">false</span><span class="op" id="7418628">,</span>&nbsp;<span class="num" id="7418630">0</span><span class="op" id="7418631">}</span><span class="op" id="7418632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7418635">{</span><span class="op" id="7418636">[</span><span class="op" id="7418637">]</span><span class="builtintype" id="7418638">byte</span><span class="op" id="7418642">{</span><span class="num" id="7418643">1</span><span class="op" id="7418644">,</span>&nbsp;<span class="num" id="7418646">2</span><span class="op" id="7418647">,</span>&nbsp;<span class="num" id="7418649">3</span><span class="op" id="7418650">,</span>&nbsp;<span class="num" id="7418652">4</span><span class="op" id="7418653">,</span>&nbsp;<span class="num" id="7418655">1</span><span class="op" id="7418656">,</span>&nbsp;<span class="num" id="7418658">1</span><span class="op" id="7418659">}</span><span class="op" id="7418660">,</span>&nbsp;<span class="builtintype" id="7418662">true</span><span class="op" id="7418666">,</span>&nbsp;<span class="num" id="7418668">4</span><span class="op" id="7418669">}</span><span class="op" id="7418670">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7418673">{</span><span class="op" id="7418674">[</span><span class="op" id="7418675">]</span><span class="builtintype" id="7418676">byte</span><span class="op" id="7418680">{</span><span class="num" id="7418681">1</span><span class="op" id="7418682">,</span>&nbsp;<span class="num" id="7418684">2</span><span class="op" id="7418685">,</span>&nbsp;<span class="num" id="7418687">3</span><span class="op" id="7418688">,</span>&nbsp;<span class="num" id="7418690">2</span><span class="op" id="7418691">,</span>&nbsp;<span class="num" id="7418693">2</span><span class="op" id="7418694">,</span>&nbsp;<span class="num" id="7418696">2</span><span class="op" id="7418697">}</span><span class="op" id="7418698">,</span>&nbsp;<span class="builtintype" id="7418700">true</span><span class="op" id="7418704">,</span>&nbsp;<span class="num" id="7418706">3</span><span class="op" id="7418707">}</span><span class="op" id="7418708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7418711">{</span><span class="op" id="7418712">[</span><span class="op" id="7418713">]</span><span class="builtintype" id="7418714">byte</span><span class="op" id="7418718">{</span><span class="num" id="7418719">1</span><span class="op" id="7418720">,</span>&nbsp;<span class="num" id="7418722">2</span><span class="op" id="7418723">,</span>&nbsp;<span class="num" id="7418725">3</span><span class="op" id="7418726">,</span>&nbsp;<span class="num" id="7418728">3</span><span class="op" id="7418729">,</span>&nbsp;<span class="num" id="7418731">3</span><span class="op" id="7418732">,</span>&nbsp;<span class="num" id="7418734">3</span><span class="op" id="7418735">}</span><span class="op" id="7418736">,</span>&nbsp;<span class="builtintype" id="7418738">true</span><span class="op" id="7418742">,</span>&nbsp;<span class="num" id="7418744">2</span><span class="op" id="7418745">}</span><span class="op" id="7418746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7418749">{</span><span class="op" id="7418750">[</span><span class="op" id="7418751">]</span><span class="builtintype" id="7418752">byte</span><span class="op" id="7418756">{</span><span class="num" id="7418757">1</span><span class="op" id="7418758">,</span>&nbsp;<span class="num" id="7418760">2</span><span class="op" id="7418761">,</span>&nbsp;<span class="num" id="7418763">3</span><span class="op" id="7418764">,</span>&nbsp;<span class="num" id="7418766">4</span><span class="op" id="7418767">,</span>&nbsp;<span class="num" id="7418769">3</span><span class="op" id="7418770">,</span>&nbsp;<span class="num" id="7418772">3</span><span class="op" id="7418773">}</span><span class="op" id="7418774">,</span>&nbsp;<span class="builtintype" id="7418776">false</span><span class="op" id="7418781">,</span>&nbsp;<span class="num" id="7418783">0</span><span class="op" id="7418784">}</span><span class="op" id="7418785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7418788">{</span><span class="op" id="7418789">[</span><span class="op" id="7418790">]</span><span class="builtintype" id="7418791">byte</span><span class="op" id="7418795">{</span><span class="num" id="7418796">1</span><span class="op" id="7418797">,</span>&nbsp;<span class="num" id="7418799">4</span><span class="op" id="7418800">,</span>&nbsp;<span class="num" id="7418802">4</span><span class="op" id="7418803">,</span>&nbsp;<span class="num" id="7418805">4</span><span class="op" id="7418806">,</span>&nbsp;<span class="num" id="7418808">4</span><span class="op" id="7418809">,</span>&nbsp;<span class="num" id="7418811">4</span><span class="op" id="7418812">}</span><span class="op" id="7418813">,</span>&nbsp;<span class="builtintype" id="7418815">true</span><span class="op" id="7418819">,</span>&nbsp;<span class="num" id="7418821">1</span><span class="op" id="7418822">}</span><span class="op" id="7418823">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7418826">{</span><span class="op" id="7418827">[</span><span class="op" id="7418828">]</span><span class="builtintype" id="7418829">byte</span><span class="op" id="7418833">{</span><span class="num" id="7418834">5</span><span class="op" id="7418835">,</span>&nbsp;<span class="num" id="7418837">5</span><span class="op" id="7418838">,</span>&nbsp;<span class="num" id="7418840">5</span><span class="op" id="7418841">,</span>&nbsp;<span class="num" id="7418843">5</span><span class="op" id="7418844">,</span>&nbsp;<span class="num" id="7418846">5</span><span class="op" id="7418847">,</span>&nbsp;<span class="num" id="7418849">5</span><span class="op" id="7418850">}</span><span class="op" id="7418851">,</span>&nbsp;<span class="builtintype" id="7418853">true</span><span class="op" id="7418857">,</span>&nbsp;<span class="num" id="7418859">0</span><span class="op" id="7418860">}</span><span class="op" id="7418861">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7418864">{</span><span class="op" id="7418865">[</span><span class="op" id="7418866">]</span><span class="builtintype" id="7418867">byte</span><span class="op" id="7418871">{</span><span class="num" id="7418872">6</span><span class="op" id="7418873">,</span>&nbsp;<span class="num" id="7418875">6</span><span class="op" id="7418876">,</span>&nbsp;<span class="num" id="7418878">6</span><span class="op" id="7418879">,</span>&nbsp;<span class="num" id="7418881">6</span><span class="op" id="7418882">,</span>&nbsp;<span class="num" id="7418884">6</span><span class="op" id="7418885">,</span>&nbsp;<span class="num" id="7418887">6</span><span class="op" id="7418888">}</span><span class="op" id="7418889">,</span>&nbsp;<span class="builtintype" id="7418891">false</span><span class="op" id="7418896">,</span>&nbsp;<span class="num" id="7418898">0</span><span class="op" id="7418899">}</span><span class="op" id="7418900">,</span><br>
<span class="lineno"></span><span class="op" id="7418902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7418905">func</span>&nbsp;<span class="ident" id="7418910">TestRemovePadding</span><span class="op" id="7418927">(</span><span class="ident" id="7418928">t</span>&nbsp;<span class="op" id="7418930">*</span><span class="ident" id="7418931"><a href="/crypto/tls/conn_test.go.html#7418218">testing</a></span><span class="op" id="7418938">.</span><span class="ident" id="7418939">T</span><span class="op" id="7418940">)</span>&nbsp;<span class="op" id="7418942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7418945">for</span>&nbsp;<span class="ident" id="7418949">i</span><span class="op" id="7418950">,</span>&nbsp;<span class="ident" id="7418952">test</span>&nbsp;<span class="op" id="7418957">:=</span>&nbsp;<span class="keyword" id="7418960">range</span>&nbsp;<span class="ident" id="7418966"><a href="/crypto/tls/conn_test.go.html#7418435">paddingTests</a></span>&nbsp;<span class="op" id="7418979">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7418983">payload</span><span class="op" id="7418990">,</span>&nbsp;<span class="ident" id="7418992">good</span>&nbsp;<span class="op" id="7418997">:=</span>&nbsp;<span class="ident" id="7419000"><a href="/crypto/tls/conn.go.html#3846866">removePadding</a></span><span class="op" id="7419013">(</span><span class="ident" id="7419014"><a href="/crypto/tls/conn_test.go.html#7418952">test</a></span><span class="op" id="7419018">.</span><span class="ident" id="7419019">in</span><span class="op" id="7419021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7419025">expectedGood</span>&nbsp;<span class="op" id="7419038">:=</span>&nbsp;<span class="builtintype" id="7419041">byte</span><span class="op" id="7419045">(</span><span class="num" id="7419046">255</span><span class="op" id="7419049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7419053">if</span>&nbsp;<span class="op" id="7419056">!</span><span class="ident" id="7419057"><a href="/crypto/tls/conn_test.go.html#7418952">test</a></span><span class="op" id="7419061">.</span><span class="ident" id="7419062">good</span>&nbsp;<span class="op" id="7419067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7419072"><a href="/crypto/tls/conn_test.go.html#7419025">expectedGood</a></span>&nbsp;<span class="op" id="7419085">=</span>&nbsp;<span class="num" id="7419087">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7419091">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7419095">if</span>&nbsp;<span class="ident" id="7419098"><a href="/crypto/tls/conn_test.go.html#7418992">good</a></span>&nbsp;<span class="op" id="7419103">!=</span>&nbsp;<span class="ident" id="7419106"><a href="/crypto/tls/conn_test.go.html#7419025">expectedGood</a></span>&nbsp;<span class="op" id="7419119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7419124"><a href="/crypto/tls/conn_test.go.html#7418928">t</a></span><span class="op" id="7419125">.</span><span class="ident" id="7419126">Errorf</span><span class="op" id="7419132">(</span><span class="string" id="7419133">&#34;#%d:&nbsp;wrong&nbsp;validity,&nbsp;want:%d&nbsp;got:%d&#34;</span><span class="op" id="7419170">,</span>&nbsp;<span class="ident" id="7419172"><a href="/crypto/tls/conn_test.go.html#7418949">i</a></span><span class="op" id="7419173">,</span>&nbsp;<span class="ident" id="7419175"><a href="/crypto/tls/conn_test.go.html#7419025">expectedGood</a></span><span class="op" id="7419187">,</span>&nbsp;<span class="ident" id="7419189"><a href="/crypto/tls/conn_test.go.html#7418992">good</a></span><span class="op" id="7419193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7419197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7419201">if</span>&nbsp;<span class="ident" id="7419204"><a href="/crypto/tls/conn_test.go.html#7418992">good</a></span>&nbsp;<span class="op" id="7419209">==</span>&nbsp;<span class="num" id="7419212">255</span>&nbsp;<span class="op" id="7419216">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="7419219">len</span><span class="op" id="7419222">(</span><span class="ident" id="7419223"><a href="/crypto/tls/conn_test.go.html#7418983">payload</a></span><span class="op" id="7419230">)</span>&nbsp;<span class="op" id="7419232">!=</span>&nbsp;<span class="ident" id="7419235"><a href="/crypto/tls/conn_test.go.html#7418952">test</a></span><span class="op" id="7419239">.</span><span class="ident" id="7419240">expectedLen</span>&nbsp;<span class="op" id="7419252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7419257"><a href="/crypto/tls/conn_test.go.html#7418928">t</a></span><span class="op" id="7419258">.</span><span class="ident" id="7419259">Errorf</span><span class="op" id="7419265">(</span><span class="string" id="7419266">&#34;#%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7419288">,</span>&nbsp;<span class="ident" id="7419290"><a href="/crypto/tls/conn_test.go.html#7418949">i</a></span><span class="op" id="7419291">,</span>&nbsp;<span class="builtinfunc" id="7419293">len</span><span class="op" id="7419296">(</span><span class="ident" id="7419297"><a href="/crypto/tls/conn_test.go.html#7418983">payload</a></span><span class="op" id="7419304">)</span><span class="op" id="7419305">,</span>&nbsp;<span class="ident" id="7419307"><a href="/crypto/tls/conn_test.go.html#7418952">test</a></span><span class="op" id="7419311">.</span><span class="ident" id="7419312">expectedLen</span><span class="op" id="7419323">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7419327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7419330">}</span><br>
<span class="lineno"></span><span class="op" id="7419332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7419335">var</span>&nbsp;<span class="ident" id="7419339">certExampleCom</span>&nbsp;<span class="op" id="7419354">=</span>&nbsp;<span class="string" id="7419356">`308201403081eda003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313138353835325a170d3132303933303138353835325a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31a301830160603551d11040f300d820b6578616d706c652e636f6d300b06092a864886f70d0101050341001a0b419d2c74474c6450654e5f10b32bf426ffdf55cad1c52602e7a9151513a3424c70f5960dcd682db0c33769cc1daa3fcdd3db10809d2392ed4a1bf50ced18`</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="7420008">var</span>&nbsp;<span class="ident" id="7420012">certWildcardExampleCom</span>&nbsp;<span class="op" id="7420035">=</span>&nbsp;<span class="string" id="7420037">`308201423081efa003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303034365a170d3132303933303139303034365a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31c301a30180603551d110411300f820d2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001676f0c9e7c33c1b656ed5a6476c4e2ee9ec8e62df7407accb1875272b2edd0a22096cb2c22598d11604104d604f810eb4b5987ca6bb319c7e6ce48725c54059`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7420693">var</span>&nbsp;<span class="ident" id="7420697">certFooExampleCom</span>&nbsp;<span class="op" id="7420715">=</span>&nbsp;<span class="string" id="7420717">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303131345a170d3132303933303139303131345a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f666f6f2e6578616d706c652e636f6d300b06092a864886f70d010105034100646a2a51f2aa2477add854b462cf5207ba16d3213ffb5d3d0eed473fbf09935019192d1d5b8ca6a2407b424cf04d97c4cd9197c83ecf81f0eab9464a1109d09f`</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="7421377">var</span>&nbsp;<span class="ident" id="7421381">certDoubleWildcardExampleCom</span>&nbsp;<span class="op" id="7421410">=</span>&nbsp;<span class="string" id="7421412">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303134315a170d3132303933303139303134315a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f2a2e2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001c3de267975f56ef57771c6218ef95ecc65102e57bd1defe6f7efea90d9b26cf40de5bd7ad75e46201c7f2a92aaa3e907451e9409f65e28ddb6db80d726290f6`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7422072">func</span>&nbsp;<span class="ident" id="7422077">TestCertificateSelection</span><span class="op" id="7422101">(</span><span class="ident" id="7422102">t</span>&nbsp;<span class="op" id="7422104">*</span><span class="ident" id="7422105"><a href="/crypto/tls/conn_test.go.html#7418218">testing</a></span><span class="op" id="7422112">.</span><span class="ident" id="7422113">T</span><span class="op" id="7422114">)</span>&nbsp;<span class="op" id="7422116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7422119">config</span>&nbsp;<span class="op" id="7422126">:=</span>&nbsp;<span class="ident" id="7422129"><a href="/crypto/tls/common.go.html#3830813">Config</a></span><span class="op" id="7422135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7422139">Certificates</span><span class="op" id="7422151">:</span>&nbsp;<span class="op" id="7422153">[</span><span class="op" id="7422154">]</span><span class="ident" id="7422155"><a href="/crypto/tls/common.go.html#3838319">Certificate</a></span><span class="op" id="7422166">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7422171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7422177">Certificate</span><span class="op" id="7422188">:</span>&nbsp;<span class="op" id="7422190">[</span><span class="op" id="7422191">]</span><span class="op" id="7422192">[</span><span class="op" id="7422193">]</span><span class="builtintype" id="7422194">byte</span><span class="op" id="7422198">{</span><span class="ident" id="7422199"><a href="/crypto/tls/handshake_server_test.go.html#7469417">fromHex</a></span><span class="op" id="7422206">(</span><span class="ident" id="7422207"><a href="/crypto/tls/conn_test.go.html#7419339">certExampleCom</a></span><span class="op" id="7422221">)</span><span class="op" id="7422222">}</span><span class="op" id="7422223">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7422228">}</span><span class="op" id="7422229">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7422234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7422240">Certificate</span><span class="op" id="7422251">:</span>&nbsp;<span class="op" id="7422253">[</span><span class="op" id="7422254">]</span><span class="op" id="7422255">[</span><span class="op" id="7422256">]</span><span class="builtintype" id="7422257">byte</span><span class="op" id="7422261">{</span><span class="ident" id="7422262"><a href="/crypto/tls/handshake_server_test.go.html#7469417">fromHex</a></span><span class="op" id="7422269">(</span><span class="ident" id="7422270"><a href="/crypto/tls/conn_test.go.html#7420012">certWildcardExampleCom</a></span><span class="op" id="7422292">)</span><span class="op" id="7422293">}</span><span class="op" id="7422294">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7422299">}</span><span class="op" id="7422300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7422305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7422311">Certificate</span><span class="op" id="7422322">:</span>&nbsp;<span class="op" id="7422324">[</span><span class="op" id="7422325">]</span><span class="op" id="7422326">[</span><span class="op" id="7422327">]</span><span class="builtintype" id="7422328">byte</span><span class="op" id="7422332">{</span><span class="ident" id="7422333"><a href="/crypto/tls/handshake_server_test.go.html#7469417">fromHex</a></span><span class="op" id="7422340">(</span><span class="ident" id="7422341"><a href="/crypto/tls/conn_test.go.html#7420697">certFooExampleCom</a></span><span class="op" id="7422358">)</span><span class="op" id="7422359">}</span><span class="op" id="7422360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7422365">}</span><span class="op" id="7422366">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7422371">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7422377">Certificate</span><span class="op" id="7422388">:</span>&nbsp;<span class="op" id="7422390">[</span><span class="op" id="7422391">]</span><span class="op" id="7422392">[</span><span class="op" id="7422393">]</span><span class="builtintype" id="7422394">byte</span><span class="op" id="7422398">{</span><span class="ident" id="7422399"><a href="/crypto/tls/handshake_server_test.go.html#7469417">fromHex</a></span><span class="op" id="7422406">(</span><span class="ident" id="7422407"><a href="/crypto/tls/conn_test.go.html#7421381">certDoubleWildcardExampleCom</a></span><span class="op" id="7422435">)</span><span class="op" id="7422436">}</span><span class="op" id="7422437">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7422442">}</span><span class="op" id="7422443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7422447">}</span><span class="op" id="7422448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7422451">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7422455"><a href="/crypto/tls/conn_test.go.html#7422119">config</a></span><span class="op" id="7422461">.</span><span class="ident" id="7422462">BuildNameToCertificate</span><span class="op" id="7422484">(</span><span class="op" id="7422485">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7422489">pointerToIndex</span>&nbsp;<span class="op" id="7422504">:=</span>&nbsp;<span class="keyword" id="7422507">func</span><span class="op" id="7422511">(</span><span class="ident" id="7422512">c</span>&nbsp;<span class="op" id="7422514">*</span><span class="ident" id="7422515"><a href="/crypto/tls/common.go.html#3838319">Certificate</a></span><span class="op" id="7422526">)</span>&nbsp;<span class="builtintype" id="7422528">int</span>&nbsp;<span class="op" id="7422532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7422536">for</span>&nbsp;<span class="ident" id="7422540">i</span>&nbsp;<span class="op" id="7422542">:=</span>&nbsp;<span class="keyword" id="7422545">range</span>&nbsp;<span class="ident" id="7422551"><a href="/crypto/tls/conn_test.go.html#7422119">config</a></span><span class="op" id="7422557">.</span><span class="ident" id="7422558">Certificates</span>&nbsp;<span class="op" id="7422571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7422576">if</span>&nbsp;<span class="ident" id="7422579"><a href="/crypto/tls/conn_test.go.html#7422512">c</a></span>&nbsp;<span class="op" id="7422581">==</span>&nbsp;<span class="op" id="7422584">&amp;</span><span class="ident" id="7422585"><a href="/crypto/tls/conn_test.go.html#7422119">config</a></span><span class="op" id="7422591">.</span><span class="ident" id="7422592">Certificates</span><span class="op" id="7422604">[</span><span class="ident" id="7422605"><a href="/crypto/tls/conn_test.go.html#7422540">i</a></span><span class="op" id="7422606">]</span>&nbsp;<span class="op" id="7422608">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7422614">return</span>&nbsp;<span class="ident" id="7422621"><a href="/crypto/tls/conn_test.go.html#7422540">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7422626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7422630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7422634">return</span>&nbsp;<span class="op" id="7422641">-</span><span class="num" id="7422642">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7422645">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7422649">certificateForName</span>&nbsp;<span class="op" id="7422668">:=</span>&nbsp;<span class="keyword" id="7422671">func</span><span class="op" id="7422675">(</span><span class="ident" id="7422676">name</span>&nbsp;<span class="builtintype" id="7422681">string</span><span class="op" id="7422687">)</span>&nbsp;<span class="op" id="7422689">*</span><span class="ident" id="7422690"><a href="/crypto/tls/common.go.html#3838319">Certificate</a></span>&nbsp;<span class="op" id="7422702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7422706">clientHello</span>&nbsp;<span class="op" id="7422718">:=</span>&nbsp;<span class="op" id="7422721">&amp;</span><span class="ident" id="7422722"><a href="/crypto/tls/common.go.html#3829703">ClientHelloInfo</a></span><span class="op" id="7422737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7422742">ServerName</span><span class="op" id="7422752">:</span>&nbsp;<span class="ident" id="7422754"><a href="/crypto/tls/conn_test.go.html#7422676">name</a></span><span class="op" id="7422758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7422762">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7422766">if</span>&nbsp;<span class="ident" id="7422769">cert</span><span class="op" id="7422773">,</span>&nbsp;<span class="ident" id="7422775">err</span>&nbsp;<span class="op" id="7422779">:=</span>&nbsp;<span class="ident" id="7422782"><a href="/crypto/tls/conn_test.go.html#7422119">config</a></span><span class="op" id="7422788">.</span><span class="ident" id="7422789">getCertificate</span><span class="op" id="7422803">(</span><span class="ident" id="7422804"><a href="/crypto/tls/conn_test.go.html#7422706">clientHello</a></span><span class="op" id="7422815">)</span><span class="op" id="7422816">;</span>&nbsp;<span class="ident" id="7422818"><a href="/crypto/tls/conn_test.go.html#7422775">err</a></span>&nbsp;<span class="op" id="7422822">!=</span>&nbsp;<span class="ident" id="7422825">nil</span>&nbsp;<span class="op" id="7422829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7422834"><a href="/crypto/tls/conn_test.go.html#7422102">t</a></span><span class="op" id="7422835">.</span><span class="ident" id="7422836">Errorf</span><span class="op" id="7422842">(</span><span class="string" id="7422843">&#34;unable&nbsp;to&nbsp;get&nbsp;certificate&nbsp;for&nbsp;name&nbsp;&#39;%s&#39;:&nbsp;%s&#34;</span><span class="op" id="7422888">,</span>&nbsp;<span class="ident" id="7422890"><a href="/crypto/tls/conn_test.go.html#7422676">name</a></span><span class="op" id="7422894">,</span>&nbsp;<span class="ident" id="7422896"><a href="/crypto/tls/conn_test.go.html#7422775">err</a></span><span class="op" id="7422899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7422904">return</span>&nbsp;<span class="ident" id="7422911">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7422917">}</span>&nbsp;<span class="keyword" id="7422919">else</span>&nbsp;<span class="op" id="7422924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7422929">return</span>&nbsp;<span class="ident" id="7422936"><a href="/crypto/tls/conn_test.go.html#7422769">cert</a></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7422943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7422946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7422950">if</span>&nbsp;<span class="ident" id="7422953">n</span>&nbsp;<span class="op" id="7422955">:=</span>&nbsp;<span class="ident" id="7422958"><a href="/crypto/tls/conn_test.go.html#7422489">pointerToIndex</a></span><span class="op" id="7422972">(</span><span class="ident" id="7422973"><a href="/crypto/tls/conn_test.go.html#7422649">certificateForName</a></span><span class="op" id="7422991">(</span><span class="string" id="7422992">&#34;example.com&#34;</span><span class="op" id="7423005">)</span><span class="op" id="7423006">)</span><span class="op" id="7423007">;</span>&nbsp;<span class="ident" id="7423009"><a href="/crypto/tls/conn_test.go.html#7422953">n</a></span>&nbsp;<span class="op" id="7423011">!=</span>&nbsp;<span class="num" id="7423014">0</span>&nbsp;<span class="op" id="7423016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7423020"><a href="/crypto/tls/conn_test.go.html#7422102">t</a></span><span class="op" id="7423021">.</span><span class="ident" id="7423022">Errorf</span><span class="op" id="7423028">(</span><span class="string" id="7423029">&#34;example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="7423073">,</span>&nbsp;<span class="ident" id="7423075"><a href="/crypto/tls/conn_test.go.html#7422953">n</a></span><span class="op" id="7423076">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7423079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7423082">if</span>&nbsp;<span class="ident" id="7423085">n</span>&nbsp;<span class="op" id="7423087">:=</span>&nbsp;<span class="ident" id="7423090"><a href="/crypto/tls/conn_test.go.html#7422489">pointerToIndex</a></span><span class="op" id="7423104">(</span><span class="ident" id="7423105"><a href="/crypto/tls/conn_test.go.html#7422649">certificateForName</a></span><span class="op" id="7423123">(</span><span class="string" id="7423124">&#34;bar.example.com&#34;</span><span class="op" id="7423141">)</span><span class="op" id="7423142">)</span><span class="op" id="7423143">;</span>&nbsp;<span class="ident" id="7423145"><a href="/crypto/tls/conn_test.go.html#7423085">n</a></span>&nbsp;<span class="op" id="7423147">!=</span>&nbsp;<span class="num" id="7423150">1</span>&nbsp;<span class="op" id="7423152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7423156"><a href="/crypto/tls/conn_test.go.html#7422102">t</a></span><span class="op" id="7423157">.</span><span class="ident" id="7423158">Errorf</span><span class="op" id="7423164">(</span><span class="string" id="7423165">&#34;bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;1&#34;</span><span class="op" id="7423213">,</span>&nbsp;<span class="ident" id="7423215"><a href="/crypto/tls/conn_test.go.html#7423085">n</a></span><span class="op" id="7423216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7423219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7423222">if</span>&nbsp;<span class="ident" id="7423225">n</span>&nbsp;<span class="op" id="7423227">:=</span>&nbsp;<span class="ident" id="7423230"><a href="/crypto/tls/conn_test.go.html#7422489">pointerToIndex</a></span><span class="op" id="7423244">(</span><span class="ident" id="7423245"><a href="/crypto/tls/conn_test.go.html#7422649">certificateForName</a></span><span class="op" id="7423263">(</span><span class="string" id="7423264">&#34;foo.example.com&#34;</span><span class="op" id="7423281">)</span><span class="op" id="7423282">)</span><span class="op" id="7423283">;</span>&nbsp;<span class="ident" id="7423285"><a href="/crypto/tls/conn_test.go.html#7423225">n</a></span>&nbsp;<span class="op" id="7423287">!=</span>&nbsp;<span class="num" id="7423290">2</span>&nbsp;<span class="op" id="7423292">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7423296"><a href="/crypto/tls/conn_test.go.html#7422102">t</a></span><span class="op" id="7423297">.</span><span class="ident" id="7423298">Errorf</span><span class="op" id="7423304">(</span><span class="string" id="7423305">&#34;foo.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;2&#34;</span><span class="op" id="7423353">,</span>&nbsp;<span class="ident" id="7423355"><a href="/crypto/tls/conn_test.go.html#7423225">n</a></span><span class="op" id="7423356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7423359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7423362">if</span>&nbsp;<span class="ident" id="7423365">n</span>&nbsp;<span class="op" id="7423367">:=</span>&nbsp;<span class="ident" id="7423370"><a href="/crypto/tls/conn_test.go.html#7422489">pointerToIndex</a></span><span class="op" id="7423384">(</span><span class="ident" id="7423385"><a href="/crypto/tls/conn_test.go.html#7422649">certificateForName</a></span><span class="op" id="7423403">(</span><span class="string" id="7423404">&#34;foo.bar.example.com&#34;</span><span class="op" id="7423425">)</span><span class="op" id="7423426">)</span><span class="op" id="7423427">;</span>&nbsp;<span class="ident" id="7423429"><a href="/crypto/tls/conn_test.go.html#7423365">n</a></span>&nbsp;<span class="op" id="7423431">!=</span>&nbsp;<span class="num" id="7423434">3</span>&nbsp;<span class="op" id="7423436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7423440"><a href="/crypto/tls/conn_test.go.html#7422102">t</a></span><span class="op" id="7423441">.</span><span class="ident" id="7423442">Errorf</span><span class="op" id="7423448">(</span><span class="string" id="7423449">&#34;foo.bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;3&#34;</span><span class="op" id="7423501">,</span>&nbsp;<span class="ident" id="7423503"><a href="/crypto/tls/conn_test.go.html#7423365">n</a></span><span class="op" id="7423504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7423507">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7423510">if</span>&nbsp;<span class="ident" id="7423513">n</span>&nbsp;<span class="op" id="7423515">:=</span>&nbsp;<span class="ident" id="7423518"><a href="/crypto/tls/conn_test.go.html#7422489">pointerToIndex</a></span><span class="op" id="7423532">(</span><span class="ident" id="7423533"><a href="/crypto/tls/conn_test.go.html#7422649">certificateForName</a></span><span class="op" id="7423551">(</span><span class="string" id="7423552">&#34;foo.bar.baz.example.com&#34;</span><span class="op" id="7423577">)</span><span class="op" id="7423578">)</span><span class="op" id="7423579">;</span>&nbsp;<span class="ident" id="7423581"><a href="/crypto/tls/conn_test.go.html#7423513">n</a></span>&nbsp;<span class="op" id="7423583">!=</span>&nbsp;<span class="num" id="7423586">0</span>&nbsp;<span class="op" id="7423588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7423592"><a href="/crypto/tls/conn_test.go.html#7422102">t</a></span><span class="op" id="7423593">.</span><span class="ident" id="7423594">Errorf</span><span class="op" id="7423600">(</span><span class="string" id="7423601">&#34;foo.bar.baz.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="7423657">,</span>&nbsp;<span class="ident" id="7423659"><a href="/crypto/tls/conn_test.go.html#7423513">n</a></span><span class="op" id="7423660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7423663">}</span><br>
<span class="lineno"></span><span class="op" id="7423665">}</span>
</div>
</body>
</html>
