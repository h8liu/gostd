<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/textproto</h2>
<ul>
<li><a href="/gostd/net/textproto/header.go.html">header.go</a></li>
<li><a href="/gostd/net/textproto/pipeline.go.html">pipeline.go</a></li>
<li><a href="/gostd/net/textproto/reader.go.html">reader.go</a></li>
<li><a href="/gostd/net/textproto/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/net/textproto/textproto.go.html">textproto.go</a></li>
<li><a href="/gostd/net/textproto/writer.go.html" class="current">writer.go</a></li>
<li><a href="/gostd/net/textproto/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4310378">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4310434">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4310488">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4310539">package</span>&nbsp;<span class="ident" id="4310547">textproto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4310558">import</span>&nbsp;<span class="op" id="4310565">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4310568">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4310577">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4310584">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="4310589">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4310592">//&nbsp;A&nbsp;Writer&nbsp;implements&nbsp;convenience&nbsp;methods&nbsp;for&nbsp;writing</span><br>
<span class="lineno"></span><span class="comment" id="4310647">//&nbsp;requests&nbsp;or&nbsp;responses&nbsp;to&nbsp;a&nbsp;text&nbsp;protocol&nbsp;network&nbsp;connection.</span><br>
<span class="lineno">15</span><span class="keyword" id="4310711">type</span>&nbsp;<span class="ident" id="4310716">Writer</span>&nbsp;<span class="keyword" id="4310723">struct</span>&nbsp;<span class="op" id="4310730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4310733">W</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4310737">*</span><span class="ident" id="4310738">bufio</span><span class="op" id="4310743">.</span><span class="ident" id="4310744">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4310752">dot</span>&nbsp;<span class="op" id="4310756">*</span><span class="ident" id="4310757">dotWriter</span><br>
<span class="lineno"></span><span class="op" id="4310767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="4310770">//&nbsp;NewWriter&nbsp;returns&nbsp;a&nbsp;new&nbsp;Writer&nbsp;writing&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="4310818">func</span>&nbsp;<span class="ident" id="4310823">NewWriter</span><span class="op" id="4310832">(</span><span class="ident" id="4310833">w</span>&nbsp;<span class="op" id="4310835">*</span><span class="ident" id="4310836">bufio</span><span class="op" id="4310841">.</span><span class="ident" id="4310842">Writer</span><span class="op" id="4310848">)</span>&nbsp;<span class="op" id="4310850">*</span><span class="ident" id="4310851">Writer</span>&nbsp;<span class="op" id="4310858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4310861">return</span>&nbsp;<span class="op" id="4310868">&amp;</span><span class="ident" id="4310869">Writer</span><span class="op" id="4310875">{</span><span class="ident" id="4310876">W</span><span class="op" id="4310877">:</span>&nbsp;<span class="ident" id="4310879">w</span><span class="op" id="4310880">}</span><br>
<span class="lineno"></span><span class="op" id="4310882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="4310885">var</span>&nbsp;<span class="ident" id="4310889">crnl</span>&nbsp;<span class="op" id="4310894">=</span>&nbsp;<span class="op" id="4310896">[</span><span class="op" id="4310897">]</span><span class="builtintype" id="4310898">byte</span><span class="op" id="4310902">{</span><span class="string" id="4310903">&#39;\r&#39;</span><span class="op" id="4310907">,</span>&nbsp;<span class="string" id="4310909">&#39;\n&#39;</span><span class="op" id="4310913">}</span><br>
<span class="lineno"></span><span class="keyword" id="4310915">var</span>&nbsp;<span class="ident" id="4310919">dotcrnl</span>&nbsp;<span class="op" id="4310927">=</span>&nbsp;<span class="op" id="4310929">[</span><span class="op" id="4310930">]</span><span class="builtintype" id="4310931">byte</span><span class="op" id="4310935">{</span><span class="string" id="4310936">&#39;.&#39;</span><span class="op" id="4310939">,</span>&nbsp;<span class="string" id="4310941">&#39;\r&#39;</span><span class="op" id="4310945">,</span>&nbsp;<span class="string" id="4310947">&#39;\n&#39;</span><span class="op" id="4310951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4310954">//&nbsp;PrintfLine&nbsp;writes&nbsp;the&nbsp;formatted&nbsp;output&nbsp;followed&nbsp;by&nbsp;\r\n.</span><br>
<span class="lineno"></span><span class="keyword" id="4311014">func</span>&nbsp;<span class="op" id="4311019">(</span><span class="ident" id="4311020">w</span>&nbsp;<span class="op" id="4311022">*</span><span class="ident" id="4311023">Writer</span><span class="op" id="4311029">)</span>&nbsp;<span class="ident" id="4311031">PrintfLine</span><span class="op" id="4311041">(</span><span class="ident" id="4311042">format</span>&nbsp;<span class="builtintype" id="4311049">string</span><span class="op" id="4311055">,</span>&nbsp;<span class="ident" id="4311057">args</span>&nbsp;<span class="op" id="4311062">...</span><span class="keyword" id="4311065">interface</span><span class="op" id="4311074">{</span><span class="op" id="4311075">}</span><span class="op" id="4311076">)</span>&nbsp;<span class="builtintype" id="4311078">error</span>&nbsp;<span class="op" id="4311084">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4311087">w</span><span class="op" id="4311088">.</span><span class="ident" id="4311089">closeDot</span><span class="op" id="4311097">(</span><span class="op" id="4311098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4311101">fmt</span><span class="op" id="4311104">.</span><span class="ident" id="4311105">Fprintf</span><span class="op" id="4311112">(</span><span class="ident" id="4311113">w</span><span class="op" id="4311114">.</span><span class="ident" id="4311115">W</span><span class="op" id="4311116">,</span>&nbsp;<span class="ident" id="4311118">format</span><span class="op" id="4311124">,</span>&nbsp;<span class="ident" id="4311126">args</span><span class="op" id="4311130">...</span><span class="op" id="4311133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4311136">w</span><span class="op" id="4311137">.</span><span class="ident" id="4311138">W</span><span class="op" id="4311139">.</span><span class="ident" id="4311140">Write</span><span class="op" id="4311145">(</span><span class="ident" id="4311146">crnl</span><span class="op" id="4311150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4311153">return</span>&nbsp;<span class="ident" id="4311160">w</span><span class="op" id="4311161">.</span><span class="ident" id="4311162">W</span><span class="op" id="4311163">.</span><span class="ident" id="4311164">Flush</span><span class="op" id="4311169">(</span><span class="op" id="4311170">)</span><br>
<span class="lineno"></span><span class="op" id="4311172">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4311175">//&nbsp;DotWriter&nbsp;returns&nbsp;a&nbsp;writer&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;write&nbsp;a&nbsp;dot-encoding&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="4311252">//&nbsp;It&nbsp;takes&nbsp;care&nbsp;of&nbsp;inserting&nbsp;leading&nbsp;dots&nbsp;when&nbsp;necessary,</span><br>
<span class="lineno"></span><span class="comment" id="4311311">//&nbsp;translating&nbsp;line-ending&nbsp;\n&nbsp;into&nbsp;\r\n,&nbsp;and&nbsp;adding&nbsp;the&nbsp;final&nbsp;.\r\n&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="4311384">//&nbsp;when&nbsp;the&nbsp;DotWriter&nbsp;is&nbsp;closed.&nbsp;&nbsp;The&nbsp;caller&nbsp;should&nbsp;close&nbsp;the</span><br>
<span class="lineno">40</span><span class="comment" id="4311446">//&nbsp;DotWriter&nbsp;before&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;a&nbsp;method&nbsp;on&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="4311498">//</span><br>
<span class="lineno"></span><span class="comment" id="4311501">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;Reader&#39;s&nbsp;DotReader&nbsp;method&nbsp;for&nbsp;details&nbsp;about&nbsp;dot-encoding.</span><br>
<span class="lineno"></span><span class="keyword" id="4311588">func</span>&nbsp;<span class="op" id="4311593">(</span><span class="ident" id="4311594">w</span>&nbsp;<span class="op" id="4311596">*</span><span class="ident" id="4311597">Writer</span><span class="op" id="4311603">)</span>&nbsp;<span class="ident" id="4311605">DotWriter</span><span class="op" id="4311614">(</span><span class="op" id="4311615">)</span>&nbsp;<span class="ident" id="4311617">io</span><span class="op" id="4311619">.</span><span class="ident" id="4311620">WriteCloser</span>&nbsp;<span class="op" id="4311632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4311635">w</span><span class="op" id="4311636">.</span><span class="ident" id="4311637">closeDot</span><span class="op" id="4311645">(</span><span class="op" id="4311646">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4311649">w</span><span class="op" id="4311650">.</span><span class="ident" id="4311651">dot</span>&nbsp;<span class="op" id="4311655">=</span>&nbsp;<span class="op" id="4311657">&amp;</span><span class="ident" id="4311658">dotWriter</span><span class="op" id="4311667">{</span><span class="ident" id="4311668">w</span><span class="op" id="4311669">:</span>&nbsp;<span class="ident" id="4311671">w</span><span class="op" id="4311672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4311675">return</span>&nbsp;<span class="ident" id="4311682">w</span><span class="op" id="4311683">.</span><span class="ident" id="4311684">dot</span><br>
<span class="lineno"></span><span class="op" id="4311688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4311691">func</span>&nbsp;<span class="op" id="4311696">(</span><span class="ident" id="4311697">w</span>&nbsp;<span class="op" id="4311699">*</span><span class="ident" id="4311700">Writer</span><span class="op" id="4311706">)</span>&nbsp;<span class="ident" id="4311708">closeDot</span><span class="op" id="4311716">(</span><span class="op" id="4311717">)</span>&nbsp;<span class="op" id="4311719">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4311722">if</span>&nbsp;<span class="ident" id="4311725">w</span><span class="op" id="4311726">.</span><span class="ident" id="4311727">dot</span>&nbsp;<span class="op" id="4311731">!=</span>&nbsp;<span class="builtintype" id="4311734">nil</span>&nbsp;<span class="op" id="4311738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4311742">w</span><span class="op" id="4311743">.</span><span class="ident" id="4311744">dot</span><span class="op" id="4311747">.</span><span class="ident" id="4311748">Close</span><span class="op" id="4311753">(</span><span class="op" id="4311754">)</span>&nbsp;<span class="comment" id="4311756">//&nbsp;sets&nbsp;w.dot&nbsp;=&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4311777">}</span><br>
<span class="lineno"></span><span class="op" id="4311779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="4311782">type</span>&nbsp;<span class="ident" id="4311787">dotWriter</span>&nbsp;<span class="keyword" id="4311797">struct</span>&nbsp;<span class="op" id="4311804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4311807">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4311813">*</span><span class="ident" id="4311814">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4311822">state</span>&nbsp;<span class="builtintype" id="4311828">int</span><br>
<span class="lineno"></span><span class="op" id="4311832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="4311835">const</span>&nbsp;<span class="op" id="4311841">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4311844">wstateBeginLine</span>&nbsp;<span class="op" id="4311860">=</span>&nbsp;<span class="ident" id="4311862">iota</span>&nbsp;<span class="comment" id="4311867">//&nbsp;beginning&nbsp;of&nbsp;line;&nbsp;initial&nbsp;state;&nbsp;must&nbsp;be&nbsp;zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4311918">wstateCR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4311941">//&nbsp;wrote&nbsp;\r&nbsp;(possibly&nbsp;at&nbsp;end&nbsp;of&nbsp;line)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4311980">wstateData</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4312003">//&nbsp;writing&nbsp;data&nbsp;in&nbsp;middle&nbsp;of&nbsp;line</span><br>
<span class="lineno"></span><span class="op" id="4312037">)</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="4312040">func</span>&nbsp;<span class="op" id="4312045">(</span><span class="ident" id="4312046">d</span>&nbsp;<span class="op" id="4312048">*</span><span class="ident" id="4312049">dotWriter</span><span class="op" id="4312058">)</span>&nbsp;<span class="ident" id="4312060">Write</span><span class="op" id="4312065">(</span><span class="ident" id="4312066">b</span>&nbsp;<span class="op" id="4312068">[</span><span class="op" id="4312069">]</span><span class="builtintype" id="4312070">byte</span><span class="op" id="4312074">)</span>&nbsp;<span class="op" id="4312076">(</span><span class="ident" id="4312077">n</span>&nbsp;<span class="builtintype" id="4312079">int</span><span class="op" id="4312082">,</span>&nbsp;<span class="ident" id="4312084">err</span>&nbsp;<span class="builtintype" id="4312088">error</span><span class="op" id="4312093">)</span>&nbsp;<span class="op" id="4312095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4312098">bw</span>&nbsp;<span class="op" id="4312101">:=</span>&nbsp;<span class="ident" id="4312104">d</span><span class="op" id="4312105">.</span><span class="ident" id="4312106">w</span><span class="op" id="4312107">.</span><span class="ident" id="4312108">W</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312111">for</span>&nbsp;<span class="ident" id="4312115">n</span>&nbsp;<span class="op" id="4312117">&lt;</span>&nbsp;<span class="builtinfunc" id="4312119">len</span><span class="op" id="4312122">(</span><span class="ident" id="4312123">b</span><span class="op" id="4312124">)</span>&nbsp;<span class="op" id="4312126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4312130">c</span>&nbsp;<span class="op" id="4312132">:=</span>&nbsp;<span class="ident" id="4312135">b</span><span class="op" id="4312136">[</span><span class="ident" id="4312137">n</span><span class="op" id="4312138">]</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312142">switch</span>&nbsp;<span class="ident" id="4312149">d</span><span class="op" id="4312150">.</span><span class="ident" id="4312151">state</span>&nbsp;<span class="op" id="4312157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312161">case</span>&nbsp;<span class="ident" id="4312166">wstateBeginLine</span><span class="op" id="4312181">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4312186">d</span><span class="op" id="4312187">.</span><span class="ident" id="4312188">state</span>&nbsp;<span class="op" id="4312194">=</span>&nbsp;<span class="ident" id="4312196">wstateData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312210">if</span>&nbsp;<span class="ident" id="4312213">c</span>&nbsp;<span class="op" id="4312215">==</span>&nbsp;<span class="string" id="4312218">&#39;.&#39;</span>&nbsp;<span class="op" id="4312222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4312228">//&nbsp;escape&nbsp;leading&nbsp;dot</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4312254">bw</span><span class="op" id="4312256">.</span><span class="ident" id="4312257">WriteByte</span><span class="op" id="4312266">(</span><span class="string" id="4312267">&#39;.&#39;</span><span class="op" id="4312270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4312275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312280">fallthrough</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312295">case</span>&nbsp;<span class="ident" id="4312300">wstateData</span><span class="op" id="4312310">:</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312315">if</span>&nbsp;<span class="ident" id="4312318">c</span>&nbsp;<span class="op" id="4312320">==</span>&nbsp;<span class="string" id="4312323">&#39;\r&#39;</span>&nbsp;<span class="op" id="4312328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4312334">d</span><span class="op" id="4312335">.</span><span class="ident" id="4312336">state</span>&nbsp;<span class="op" id="4312342">=</span>&nbsp;<span class="ident" id="4312344">wstateCR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4312356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312361">if</span>&nbsp;<span class="ident" id="4312364">c</span>&nbsp;<span class="op" id="4312366">==</span>&nbsp;<span class="string" id="4312369">&#39;\n&#39;</span>&nbsp;<span class="op" id="4312374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4312380">bw</span><span class="op" id="4312382">.</span><span class="ident" id="4312383">WriteByte</span><span class="op" id="4312392">(</span><span class="string" id="4312393">&#39;\r&#39;</span><span class="op" id="4312397">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4312403">d</span><span class="op" id="4312404">.</span><span class="ident" id="4312405">state</span>&nbsp;<span class="op" id="4312411">=</span>&nbsp;<span class="ident" id="4312413">wstateBeginLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4312432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312437">case</span>&nbsp;<span class="ident" id="4312442">wstateCR</span><span class="op" id="4312450">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4312455">d</span><span class="op" id="4312456">.</span><span class="ident" id="4312457">state</span>&nbsp;<span class="op" id="4312463">=</span>&nbsp;<span class="ident" id="4312465">wstateData</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312479">if</span>&nbsp;<span class="ident" id="4312482">c</span>&nbsp;<span class="op" id="4312484">==</span>&nbsp;<span class="string" id="4312487">&#39;\n&#39;</span>&nbsp;<span class="op" id="4312492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4312498">d</span><span class="op" id="4312499">.</span><span class="ident" id="4312500">state</span>&nbsp;<span class="op" id="4312506">=</span>&nbsp;<span class="ident" id="4312508">wstateBeginLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4312527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4312531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312535">if</span>&nbsp;<span class="ident" id="4312538">err</span>&nbsp;<span class="op" id="4312542">=</span>&nbsp;<span class="ident" id="4312544">bw</span><span class="op" id="4312546">.</span><span class="ident" id="4312547">WriteByte</span><span class="op" id="4312556">(</span><span class="ident" id="4312557">c</span><span class="op" id="4312558">)</span><span class="op" id="4312559">;</span>&nbsp;<span class="ident" id="4312561">err</span>&nbsp;<span class="op" id="4312565">!=</span>&nbsp;<span class="builtintype" id="4312568">nil</span>&nbsp;<span class="op" id="4312572">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312577">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4312585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4312589">n</span><span class="op" id="4312590">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4312594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312597">return</span><br>
<span class="lineno">100</span><span class="op" id="4312604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4312607">func</span>&nbsp;<span class="op" id="4312612">(</span><span class="ident" id="4312613">d</span>&nbsp;<span class="op" id="4312615">*</span><span class="ident" id="4312616">dotWriter</span><span class="op" id="4312625">)</span>&nbsp;<span class="ident" id="4312627">Close</span><span class="op" id="4312632">(</span><span class="op" id="4312633">)</span>&nbsp;<span class="builtintype" id="4312635">error</span>&nbsp;<span class="op" id="4312641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312644">if</span>&nbsp;<span class="ident" id="4312647">d</span><span class="op" id="4312648">.</span><span class="ident" id="4312649">w</span><span class="op" id="4312650">.</span><span class="ident" id="4312651">dot</span>&nbsp;<span class="op" id="4312655">==</span>&nbsp;<span class="ident" id="4312658">d</span>&nbsp;<span class="op" id="4312660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4312664">d</span><span class="op" id="4312665">.</span><span class="ident" id="4312666">w</span><span class="op" id="4312667">.</span><span class="ident" id="4312668">dot</span>&nbsp;<span class="op" id="4312672">=</span>&nbsp;<span class="builtintype" id="4312674">nil</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4312679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4312682">bw</span>&nbsp;<span class="op" id="4312685">:=</span>&nbsp;<span class="ident" id="4312688">d</span><span class="op" id="4312689">.</span><span class="ident" id="4312690">w</span><span class="op" id="4312691">.</span><span class="ident" id="4312692">W</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312695">switch</span>&nbsp;<span class="ident" id="4312702">d</span><span class="op" id="4312703">.</span><span class="ident" id="4312704">state</span>&nbsp;<span class="op" id="4312710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312713">default</span><span class="op" id="4312720">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4312724">bw</span><span class="op" id="4312726">.</span><span class="ident" id="4312727">WriteByte</span><span class="op" id="4312736">(</span><span class="string" id="4312737">&#39;\r&#39;</span><span class="op" id="4312741">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312745">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312758">case</span>&nbsp;<span class="ident" id="4312763">wstateCR</span><span class="op" id="4312771">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4312775">bw</span><span class="op" id="4312777">.</span><span class="ident" id="4312778">WriteByte</span><span class="op" id="4312787">(</span><span class="string" id="4312788">&#39;\n&#39;</span><span class="op" id="4312792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312796">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312809">case</span>&nbsp;<span class="ident" id="4312814">wstateBeginLine</span><span class="op" id="4312829">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4312833">bw</span><span class="op" id="4312835">.</span><span class="ident" id="4312836">Write</span><span class="op" id="4312841">(</span><span class="ident" id="4312842">dotcrnl</span><span class="op" id="4312849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4312852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312855">return</span>&nbsp;<span class="ident" id="4312862">bw</span><span class="op" id="4312864">.</span><span class="ident" id="4312865">Flush</span><span class="op" id="4312870">(</span><span class="op" id="4312871">)</span><br>
<span class="lineno"></span><span class="op" id="4312873">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
