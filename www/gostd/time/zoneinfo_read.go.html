<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html" class="current">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2652155">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2652210">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2652264">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2652315">//&nbsp;Parse&nbsp;&#34;zoneinfo&#34;&nbsp;time&nbsp;zone&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="2652351">//&nbsp;This&nbsp;is&nbsp;a&nbsp;fairly&nbsp;standard&nbsp;file&nbsp;format&nbsp;used&nbsp;on&nbsp;OS&nbsp;X,&nbsp;Linux,&nbsp;BSD,&nbsp;Sun,&nbsp;and&nbsp;others.</span><br>
<span class="lineno"></span><span class="comment" id="2652435">//&nbsp;See&nbsp;tzfile(5),&nbsp;http://en.wikipedia.org/wiki/Zoneinfo,</span><br>
<span class="lineno"></span><span class="comment" id="2652492">//&nbsp;and&nbsp;ftp://munnari.oz.au/pub/oldtz/</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="2652531">package</span>&nbsp;<span class="ident" id="2652539">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2652545">import</span>&nbsp;<span class="string" id="2652552">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2652562">//&nbsp;Simple&nbsp;I/O&nbsp;interface&nbsp;to&nbsp;binary&nbsp;blob&nbsp;of&nbsp;data.</span><br>
<span class="lineno">15</span><span class="keyword" id="2652610">type</span>&nbsp;<span class="ident" id="2652615">data</span>&nbsp;<span class="keyword" id="2652620">struct</span>&nbsp;<span class="op" id="2652627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652630">p</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2652636">[</span><span class="op" id="2652637">]</span><span class="builtintype" id="2652638">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2652644">error</span>&nbsp;<span class="builtintype" id="2652650">bool</span><br>
<span class="lineno"></span><span class="op" id="2652655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="2652658">func</span>&nbsp;<span class="op" id="2652663">(</span><span class="ident" id="2652664">d</span>&nbsp;<span class="op" id="2652666">*</span><span class="ident" id="2652667">data</span><span class="op" id="2652671">)</span>&nbsp;<span class="ident" id="2652673">read</span><span class="op" id="2652677">(</span><span class="ident" id="2652678">n</span>&nbsp;<span class="builtintype" id="2652680">int</span><span class="op" id="2652683">)</span>&nbsp;<span class="op" id="2652685">[</span><span class="op" id="2652686">]</span><span class="builtintype" id="2652687">byte</span>&nbsp;<span class="op" id="2652692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652695">if</span>&nbsp;<span class="builtinfunc" id="2652698">len</span><span class="op" id="2652701">(</span><span class="ident" id="2652702">d</span><span class="op" id="2652703">.</span><span class="ident" id="2652704">p</span><span class="op" id="2652705">)</span>&nbsp;<span class="op" id="2652707">&lt;</span>&nbsp;<span class="ident" id="2652709">n</span>&nbsp;<span class="op" id="2652711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652715">d</span><span class="op" id="2652716">.</span><span class="ident" id="2652717">p</span>&nbsp;<span class="op" id="2652719">=</span>&nbsp;<span class="ident" id="2652721">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652727">d</span><span class="op" id="2652728">.</span><span class="builtintype" id="2652729">error</span>&nbsp;<span class="op" id="2652735">=</span>&nbsp;<span class="builtintype" id="2652737">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652744">return</span>&nbsp;<span class="ident" id="2652751">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2652756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652759">p</span>&nbsp;<span class="op" id="2652761">:=</span>&nbsp;<span class="ident" id="2652764">d</span><span class="op" id="2652765">.</span><span class="ident" id="2652766">p</span><span class="op" id="2652767">[</span><span class="num" id="2652768">0</span><span class="op" id="2652769">:</span><span class="ident" id="2652770">n</span><span class="op" id="2652771">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652774">d</span><span class="op" id="2652775">.</span><span class="ident" id="2652776">p</span>&nbsp;<span class="op" id="2652778">=</span>&nbsp;<span class="ident" id="2652780">d</span><span class="op" id="2652781">.</span><span class="ident" id="2652782">p</span><span class="op" id="2652783">[</span><span class="ident" id="2652784">n</span><span class="op" id="2652785">:</span><span class="op" id="2652786">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652789">return</span>&nbsp;<span class="ident" id="2652796">p</span><br>
<span class="lineno"></span><span class="op" id="2652798">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="2652801">func</span>&nbsp;<span class="op" id="2652806">(</span><span class="ident" id="2652807">d</span>&nbsp;<span class="op" id="2652809">*</span><span class="ident" id="2652810">data</span><span class="op" id="2652814">)</span>&nbsp;<span class="ident" id="2652816">big4</span><span class="op" id="2652820">(</span><span class="op" id="2652821">)</span>&nbsp;<span class="op" id="2652823">(</span><span class="ident" id="2652824">n</span>&nbsp;<span class="builtintype" id="2652826">uint32</span><span class="op" id="2652832">,</span>&nbsp;<span class="ident" id="2652834">ok</span>&nbsp;<span class="builtintype" id="2652837">bool</span><span class="op" id="2652841">)</span>&nbsp;<span class="op" id="2652843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652846">p</span>&nbsp;<span class="op" id="2652848">:=</span>&nbsp;<span class="ident" id="2652851">d</span><span class="op" id="2652852">.</span><span class="ident" id="2652853">read</span><span class="op" id="2652857">(</span><span class="num" id="2652858">4</span><span class="op" id="2652859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652862">if</span>&nbsp;<span class="builtinfunc" id="2652865">len</span><span class="op" id="2652868">(</span><span class="ident" id="2652869">p</span><span class="op" id="2652870">)</span>&nbsp;<span class="op" id="2652872">&lt;</span>&nbsp;<span class="num" id="2652874">4</span>&nbsp;<span class="op" id="2652876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652880">d</span><span class="op" id="2652881">.</span><span class="builtintype" id="2652882">error</span>&nbsp;<span class="op" id="2652888">=</span>&nbsp;<span class="builtintype" id="2652890">true</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652897">return</span>&nbsp;<span class="num" id="2652904">0</span><span class="op" id="2652905">,</span>&nbsp;<span class="builtintype" id="2652907">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2652914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652917">return</span>&nbsp;<span class="builtintype" id="2652924">uint32</span><span class="op" id="2652930">(</span><span class="ident" id="2652931">p</span><span class="op" id="2652932">[</span><span class="num" id="2652933">0</span><span class="op" id="2652934">]</span><span class="op" id="2652935">)</span><span class="op" id="2652936">&lt;&lt;</span><span class="num" id="2652938">24</span>&nbsp;<span class="op" id="2652941">|</span>&nbsp;<span class="builtintype" id="2652943">uint32</span><span class="op" id="2652949">(</span><span class="ident" id="2652950">p</span><span class="op" id="2652951">[</span><span class="num" id="2652952">1</span><span class="op" id="2652953">]</span><span class="op" id="2652954">)</span><span class="op" id="2652955">&lt;&lt;</span><span class="num" id="2652957">16</span>&nbsp;<span class="op" id="2652960">|</span>&nbsp;<span class="builtintype" id="2652962">uint32</span><span class="op" id="2652968">(</span><span class="ident" id="2652969">p</span><span class="op" id="2652970">[</span><span class="num" id="2652971">2</span><span class="op" id="2652972">]</span><span class="op" id="2652973">)</span><span class="op" id="2652974">&lt;&lt;</span><span class="num" id="2652976">8</span>&nbsp;<span class="op" id="2652978">|</span>&nbsp;<span class="builtintype" id="2652980">uint32</span><span class="op" id="2652986">(</span><span class="ident" id="2652987">p</span><span class="op" id="2652988">[</span><span class="num" id="2652989">3</span><span class="op" id="2652990">]</span><span class="op" id="2652991">)</span><span class="op" id="2652992">,</span>&nbsp;<span class="builtintype" id="2652994">true</span><br>
<span class="lineno"></span><span class="op" id="2652999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="2653002">func</span>&nbsp;<span class="op" id="2653007">(</span><span class="ident" id="2653008">d</span>&nbsp;<span class="op" id="2653010">*</span><span class="ident" id="2653011">data</span><span class="op" id="2653015">)</span>&nbsp;<span class="builtintype" id="2653017">byte</span><span class="op" id="2653021">(</span><span class="op" id="2653022">)</span>&nbsp;<span class="op" id="2653024">(</span><span class="ident" id="2653025">n</span>&nbsp;<span class="builtintype" id="2653027">byte</span><span class="op" id="2653031">,</span>&nbsp;<span class="ident" id="2653033">ok</span>&nbsp;<span class="builtintype" id="2653036">bool</span><span class="op" id="2653040">)</span>&nbsp;<span class="op" id="2653042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2653045">p</span>&nbsp;<span class="op" id="2653047">:=</span>&nbsp;<span class="ident" id="2653050">d</span><span class="op" id="2653051">.</span><span class="ident" id="2653052">read</span><span class="op" id="2653056">(</span><span class="num" id="2653057">1</span><span class="op" id="2653058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2653061">if</span>&nbsp;<span class="builtinfunc" id="2653064">len</span><span class="op" id="2653067">(</span><span class="ident" id="2653068">p</span><span class="op" id="2653069">)</span>&nbsp;<span class="op" id="2653071">&lt;</span>&nbsp;<span class="num" id="2653073">1</span>&nbsp;<span class="op" id="2653075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2653079">d</span><span class="op" id="2653080">.</span><span class="builtintype" id="2653081">error</span>&nbsp;<span class="op" id="2653087">=</span>&nbsp;<span class="builtintype" id="2653089">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2653096">return</span>&nbsp;<span class="num" id="2653103">0</span><span class="op" id="2653104">,</span>&nbsp;<span class="builtintype" id="2653106">false</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2653113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2653116">return</span>&nbsp;<span class="ident" id="2653123">p</span><span class="op" id="2653124">[</span><span class="num" id="2653125">0</span><span class="op" id="2653126">]</span><span class="op" id="2653127">,</span>&nbsp;<span class="builtintype" id="2653129">true</span><br>
<span class="lineno"></span><span class="op" id="2653134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2653137">//&nbsp;Make&nbsp;a&nbsp;string&nbsp;by&nbsp;stopping&nbsp;at&nbsp;the&nbsp;first&nbsp;NUL</span><br>
<span class="lineno">50</span><span class="keyword" id="2653183">func</span>&nbsp;<span class="ident" id="2653188">byteString</span><span class="op" id="2653198">(</span><span class="ident" id="2653199">p</span>&nbsp;<span class="op" id="2653201">[</span><span class="op" id="2653202">]</span><span class="builtintype" id="2653203">byte</span><span class="op" id="2653207">)</span>&nbsp;<span class="builtintype" id="2653209">string</span>&nbsp;<span class="op" id="2653216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2653219">for</span>&nbsp;<span class="ident" id="2653223">i</span>&nbsp;<span class="op" id="2653225">:=</span>&nbsp;<span class="num" id="2653228">0</span><span class="op" id="2653229">;</span>&nbsp;<span class="ident" id="2653231">i</span>&nbsp;<span class="op" id="2653233">&lt;</span>&nbsp;<span class="builtinfunc" id="2653235">len</span><span class="op" id="2653238">(</span><span class="ident" id="2653239">p</span><span class="op" id="2653240">)</span><span class="op" id="2653241">;</span>&nbsp;<span class="ident" id="2653243">i</span><span class="op" id="2653244">++</span>&nbsp;<span class="op" id="2653247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2653251">if</span>&nbsp;<span class="ident" id="2653254">p</span><span class="op" id="2653255">[</span><span class="ident" id="2653256">i</span><span class="op" id="2653257">]</span>&nbsp;<span class="op" id="2653259">==</span>&nbsp;<span class="num" id="2653262">0</span>&nbsp;<span class="op" id="2653264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2653269">return</span>&nbsp;<span class="builtintype" id="2653276">string</span><span class="op" id="2653282">(</span><span class="ident" id="2653283">p</span><span class="op" id="2653284">[</span><span class="num" id="2653285">0</span><span class="op" id="2653286">:</span><span class="ident" id="2653287">i</span><span class="op" id="2653288">]</span><span class="op" id="2653289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2653293">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2653296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2653299">return</span>&nbsp;<span class="builtintype" id="2653306">string</span><span class="op" id="2653312">(</span><span class="ident" id="2653313">p</span><span class="op" id="2653314">)</span><br>
<span class="lineno"></span><span class="op" id="2653316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2653319">var</span>&nbsp;<span class="ident" id="2653323">badData</span>&nbsp;<span class="op" id="2653331">=</span>&nbsp;<span class="ident" id="2653333">errors</span><span class="op" id="2653339">.</span><span class="ident" id="2653340">New</span><span class="op" id="2653343">(</span><span class="string" id="2653344">&#34;malformed&nbsp;time&nbsp;zone&nbsp;information&#34;</span><span class="op" id="2653377">)</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="2653380">func</span>&nbsp;<span class="ident" id="2653385">loadZoneData</span><span class="op" id="2653397">(</span><span class="ident" id="2653398">bytes</span>&nbsp;<span class="op" id="2653404">[</span><span class="op" id="2653405">]</span><span class="builtintype" id="2653406">byte</span><span class="op" id="2653410">)</span>&nbsp;<span class="op" id="2653412">(</span><span class="ident" id="2653413">l</span>&nbsp;<span class="op" id="2653415">*</span><span class="ident" id="2653416">Location</span><span class="op" id="2653424">,</span>&nbsp;<span class="ident" id="2653426">err</span>&nbsp;<span class="builtintype" id="2653430">error</span><span class="op" id="2653435">)</span>&nbsp;<span class="op" id="2653437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2653440">d</span>&nbsp;<span class="op" id="2653442">:=</span>&nbsp;<span class="ident" id="2653445">data</span><span class="op" id="2653449">{</span><span class="ident" id="2653450">bytes</span><span class="op" id="2653455">,</span>&nbsp;<span class="builtintype" id="2653457">false</span><span class="op" id="2653462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653466">//&nbsp;4-byte&nbsp;magic&nbsp;&#34;TZif&#34;</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2653490">if</span>&nbsp;<span class="ident" id="2653493">magic</span>&nbsp;<span class="op" id="2653499">:=</span>&nbsp;<span class="ident" id="2653502">d</span><span class="op" id="2653503">.</span><span class="ident" id="2653504">read</span><span class="op" id="2653508">(</span><span class="num" id="2653509">4</span><span class="op" id="2653510">)</span><span class="op" id="2653511">;</span>&nbsp;<span class="builtintype" id="2653513">string</span><span class="op" id="2653519">(</span><span class="ident" id="2653520">magic</span><span class="op" id="2653525">)</span>&nbsp;<span class="op" id="2653527">!=</span>&nbsp;<span class="string" id="2653530">&#34;TZif&#34;</span>&nbsp;<span class="op" id="2653537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2653541">return</span>&nbsp;<span class="ident" id="2653548">nil</span><span class="op" id="2653551">,</span>&nbsp;<span class="ident" id="2653553">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2653562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653566">//&nbsp;1-byte&nbsp;version,&nbsp;then&nbsp;15&nbsp;bytes&nbsp;of&nbsp;padding</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2653611">var</span>&nbsp;<span class="ident" id="2653615">p</span>&nbsp;<span class="op" id="2653617">[</span><span class="op" id="2653618">]</span><span class="builtintype" id="2653619">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2653625">if</span>&nbsp;<span class="ident" id="2653628">p</span>&nbsp;<span class="op" id="2653630">=</span>&nbsp;<span class="ident" id="2653632">d</span><span class="op" id="2653633">.</span><span class="ident" id="2653634">read</span><span class="op" id="2653638">(</span><span class="num" id="2653639">16</span><span class="op" id="2653641">)</span><span class="op" id="2653642">;</span>&nbsp;<span class="builtinfunc" id="2653644">len</span><span class="op" id="2653647">(</span><span class="ident" id="2653648">p</span><span class="op" id="2653649">)</span>&nbsp;<span class="op" id="2653651">!=</span>&nbsp;<span class="num" id="2653654">16</span>&nbsp;<span class="op" id="2653657">||</span>&nbsp;<span class="ident" id="2653660">p</span><span class="op" id="2653661">[</span><span class="num" id="2653662">0</span><span class="op" id="2653663">]</span>&nbsp;<span class="op" id="2653665">!=</span>&nbsp;<span class="num" id="2653668">0</span>&nbsp;<span class="op" id="2653670">&amp;&amp;</span>&nbsp;<span class="ident" id="2653673">p</span><span class="op" id="2653674">[</span><span class="num" id="2653675">0</span><span class="op" id="2653676">]</span>&nbsp;<span class="op" id="2653678">!=</span>&nbsp;<span class="string" id="2653681">&#39;2&#39;</span>&nbsp;<span class="op" id="2653685">&amp;&amp;</span>&nbsp;<span class="ident" id="2653688">p</span><span class="op" id="2653689">[</span><span class="num" id="2653690">0</span><span class="op" id="2653691">]</span>&nbsp;<span class="op" id="2653693">!=</span>&nbsp;<span class="string" id="2653696">&#39;3&#39;</span>&nbsp;<span class="op" id="2653700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2653704">return</span>&nbsp;<span class="ident" id="2653711">nil</span><span class="op" id="2653714">,</span>&nbsp;<span class="ident" id="2653716">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2653725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653729">//&nbsp;six&nbsp;big-endian&nbsp;32-bit&nbsp;integers:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653765">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;UTC/local&nbsp;indicators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653800">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;standard/wall&nbsp;indicators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653839">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;leap&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653866">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;transition&nbsp;times</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653897">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;local&nbsp;time&nbsp;zones</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653928">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;characters&nbsp;of&nbsp;time&nbsp;zone&nbsp;abbrev&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2653981">const</span>&nbsp;<span class="op" id="2653987">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2653991">NUTCLocal</span>&nbsp;<span class="op" id="2654001">=</span>&nbsp;<span class="ident" id="2654003">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2654010">NStdWall</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2654021">NLeap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2654029">NTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2654037">NZone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2654045">NChar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2654052">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2654055">var</span>&nbsp;<span class="ident" id="2654059">n</span>&nbsp;<span class="op" id="2654061">[</span><span class="num" id="2654062">6</span><span class="op" id="2654063">]</span><span class="builtintype" id="2654064">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2654069">for</span>&nbsp;<span class="ident" id="2654073">i</span>&nbsp;<span class="op" id="2654075">:=</span>&nbsp;<span class="num" id="2654078">0</span><span class="op" id="2654079">;</span>&nbsp;<span class="ident" id="2654081">i</span>&nbsp;<span class="op" id="2654083">&lt;</span>&nbsp;<span class="num" id="2654085">6</span><span class="op" id="2654086">;</span>&nbsp;<span class="ident" id="2654088">i</span><span class="op" id="2654089">++</span>&nbsp;<span class="op" id="2654092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2654096">nn</span><span class="op" id="2654098">,</span>&nbsp;<span class="ident" id="2654100">ok</span>&nbsp;<span class="op" id="2654103">:=</span>&nbsp;<span class="ident" id="2654106">d</span><span class="op" id="2654107">.</span><span class="ident" id="2654108">big4</span><span class="op" id="2654112">(</span><span class="op" id="2654113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2654117">if</span>&nbsp;<span class="op" id="2654120">!</span><span class="ident" id="2654121">ok</span>&nbsp;<span class="op" id="2654124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2654129">return</span>&nbsp;<span class="ident" id="2654136">nil</span><span class="op" id="2654139">,</span>&nbsp;<span class="ident" id="2654141">badData</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2654151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2654155">n</span><span class="op" id="2654156">[</span><span class="ident" id="2654157">i</span><span class="op" id="2654158">]</span>&nbsp;<span class="op" id="2654160">=</span>&nbsp;<span class="builtintype" id="2654162">int</span><span class="op" id="2654165">(</span><span class="ident" id="2654166">nn</span><span class="op" id="2654168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2654171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654175">//&nbsp;Transition&nbsp;times.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2654197">txtimes</span>&nbsp;<span class="op" id="2654205">:=</span>&nbsp;<span class="ident" id="2654208">data</span><span class="op" id="2654212">{</span><span class="ident" id="2654213">d</span><span class="op" id="2654214">.</span><span class="ident" id="2654215">read</span><span class="op" id="2654219">(</span><span class="ident" id="2654220">n</span><span class="op" id="2654221">[</span><span class="ident" id="2654222">NTime</span><span class="op" id="2654227">]</span>&nbsp;<span class="op" id="2654229">*</span>&nbsp;<span class="num" id="2654231">4</span><span class="op" id="2654232">)</span><span class="op" id="2654233">,</span>&nbsp;<span class="builtintype" id="2654235">false</span><span class="op" id="2654240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654244">//&nbsp;Time&nbsp;zone&nbsp;indices&nbsp;for&nbsp;transition&nbsp;times.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2654288">txzones</span>&nbsp;<span class="op" id="2654296">:=</span>&nbsp;<span class="ident" id="2654299">d</span><span class="op" id="2654300">.</span><span class="ident" id="2654301">read</span><span class="op" id="2654305">(</span><span class="ident" id="2654306">n</span><span class="op" id="2654307">[</span><span class="ident" id="2654308">NTime</span><span class="op" id="2654313">]</span><span class="op" id="2654314">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654318">//&nbsp;Zone&nbsp;info&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2654343">zonedata</span>&nbsp;<span class="op" id="2654352">:=</span>&nbsp;<span class="ident" id="2654355">data</span><span class="op" id="2654359">{</span><span class="ident" id="2654360">d</span><span class="op" id="2654361">.</span><span class="ident" id="2654362">read</span><span class="op" id="2654366">(</span><span class="ident" id="2654367">n</span><span class="op" id="2654368">[</span><span class="ident" id="2654369">NZone</span><span class="op" id="2654374">]</span>&nbsp;<span class="op" id="2654376">*</span>&nbsp;<span class="num" id="2654378">6</span><span class="op" id="2654379">)</span><span class="op" id="2654380">,</span>&nbsp;<span class="builtintype" id="2654382">false</span><span class="op" id="2654387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654391">//&nbsp;Time&nbsp;zone&nbsp;abbreviations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2654420">abbrev</span>&nbsp;<span class="op" id="2654427">:=</span>&nbsp;<span class="ident" id="2654430">d</span><span class="op" id="2654431">.</span><span class="ident" id="2654432">read</span><span class="op" id="2654436">(</span><span class="ident" id="2654437">n</span><span class="op" id="2654438">[</span><span class="ident" id="2654439">NChar</span><span class="op" id="2654444">]</span><span class="op" id="2654445">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654449">//&nbsp;Leap-second&nbsp;time&nbsp;pairs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2654476">d</span><span class="op" id="2654477">.</span><span class="ident" id="2654478">read</span><span class="op" id="2654482">(</span><span class="ident" id="2654483">n</span><span class="op" id="2654484">[</span><span class="ident" id="2654485">NLeap</span><span class="op" id="2654490">]</span>&nbsp;<span class="op" id="2654492">*</span>&nbsp;<span class="num" id="2654494">8</span><span class="op" id="2654495">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654499">//&nbsp;Whether&nbsp;tx&nbsp;times&nbsp;associated&nbsp;with&nbsp;local&nbsp;time&nbsp;types</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654553">//&nbsp;are&nbsp;specified&nbsp;as&nbsp;standard&nbsp;time&nbsp;or&nbsp;wall&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2654602">isstd</span>&nbsp;<span class="op" id="2654608">:=</span>&nbsp;<span class="ident" id="2654611">d</span><span class="op" id="2654612">.</span><span class="ident" id="2654613">read</span><span class="op" id="2654617">(</span><span class="ident" id="2654618">n</span><span class="op" id="2654619">[</span><span class="ident" id="2654620">NStdWall</span><span class="op" id="2654628">]</span><span class="op" id="2654629">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654633">//&nbsp;Whether&nbsp;tx&nbsp;times&nbsp;associated&nbsp;with&nbsp;local&nbsp;time&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654687">//&nbsp;are&nbsp;specified&nbsp;as&nbsp;UTC&nbsp;or&nbsp;local&nbsp;time.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2654727">isutc</span>&nbsp;<span class="op" id="2654733">:=</span>&nbsp;<span class="ident" id="2654736">d</span><span class="op" id="2654737">.</span><span class="ident" id="2654738">read</span><span class="op" id="2654742">(</span><span class="ident" id="2654743">n</span><span class="op" id="2654744">[</span><span class="ident" id="2654745">NUTCLocal</span><span class="op" id="2654754">]</span><span class="op" id="2654755">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2654759">if</span>&nbsp;<span class="ident" id="2654762">d</span><span class="op" id="2654763">.</span><span class="builtintype" id="2654764">error</span>&nbsp;<span class="op" id="2654770">{</span>&nbsp;<span class="comment" id="2654772">//&nbsp;ran&nbsp;out&nbsp;of&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2654793">return</span>&nbsp;<span class="ident" id="2654800">nil</span><span class="op" id="2654803">,</span>&nbsp;<span class="ident" id="2654805">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2654814">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654818">//&nbsp;If&nbsp;version&nbsp;==&nbsp;2&nbsp;or&nbsp;3,&nbsp;the&nbsp;entire&nbsp;file&nbsp;repeats,&nbsp;this&nbsp;time&nbsp;using</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654885">//&nbsp;8-byte&nbsp;ints&nbsp;for&nbsp;txtimes&nbsp;and&nbsp;leap&nbsp;seconds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654931">//&nbsp;We&nbsp;won&#39;t&nbsp;need&nbsp;those&nbsp;until&nbsp;2106.</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654968">//&nbsp;Now&nbsp;we&nbsp;can&nbsp;build&nbsp;up&nbsp;a&nbsp;useful&nbsp;data&nbsp;structure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2655017">//&nbsp;First&nbsp;the&nbsp;zone&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2655049">//&nbsp;&nbsp;&nbsp;&nbsputcoff[4]&nbsp;isdst[1]&nbsp;nameindex[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2655085">zone</span>&nbsp;<span class="op" id="2655090">:=</span>&nbsp;<span class="builtinfunc" id="2655093">make</span><span class="op" id="2655097">(</span><span class="op" id="2655098">[</span><span class="op" id="2655099">]</span><span class="ident" id="2655100">zone</span><span class="op" id="2655104">,</span>&nbsp;<span class="ident" id="2655106">n</span><span class="op" id="2655107">[</span><span class="ident" id="2655108">NZone</span><span class="op" id="2655113">]</span><span class="op" id="2655114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2655117">for</span>&nbsp;<span class="ident" id="2655121">i</span>&nbsp;<span class="op" id="2655123">:=</span>&nbsp;<span class="keyword" id="2655126">range</span>&nbsp;<span class="ident" id="2655132">zone</span>&nbsp;<span class="op" id="2655137">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2655141">var</span>&nbsp;<span class="ident" id="2655145">ok</span>&nbsp;<span class="builtintype" id="2655148">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2655155">var</span>&nbsp;<span class="ident" id="2655159">n</span>&nbsp;<span class="builtintype" id="2655161">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2655170">if</span>&nbsp;<span class="ident" id="2655173">n</span><span class="op" id="2655174">,</span>&nbsp;<span class="ident" id="2655176">ok</span>&nbsp;<span class="op" id="2655179">=</span>&nbsp;<span class="ident" id="2655181">zonedata</span><span class="op" id="2655189">.</span><span class="ident" id="2655190">big4</span><span class="op" id="2655194">(</span><span class="op" id="2655195">)</span><span class="op" id="2655196">;</span>&nbsp;<span class="op" id="2655198">!</span><span class="ident" id="2655199">ok</span>&nbsp;<span class="op" id="2655202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2655207">return</span>&nbsp;<span class="ident" id="2655214">nil</span><span class="op" id="2655217">,</span>&nbsp;<span class="ident" id="2655219">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2655229">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2655233">zone</span><span class="op" id="2655237">[</span><span class="ident" id="2655238">i</span><span class="op" id="2655239">]</span><span class="op" id="2655240">.</span><span class="ident" id="2655241">offset</span>&nbsp;<span class="op" id="2655248">=</span>&nbsp;<span class="builtintype" id="2655250">int</span><span class="op" id="2655253">(</span><span class="builtintype" id="2655254">int32</span><span class="op" id="2655259">(</span><span class="ident" id="2655260">n</span><span class="op" id="2655261">)</span><span class="op" id="2655262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2655266">var</span>&nbsp;<span class="ident" id="2655270">b</span>&nbsp;<span class="builtintype" id="2655272">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2655279">if</span>&nbsp;<span class="ident" id="2655282">b</span><span class="op" id="2655283">,</span>&nbsp;<span class="ident" id="2655285">ok</span>&nbsp;<span class="op" id="2655288">=</span>&nbsp;<span class="ident" id="2655290">zonedata</span><span class="op" id="2655298">.</span><span class="builtintype" id="2655299">byte</span><span class="op" id="2655303">(</span><span class="op" id="2655304">)</span><span class="op" id="2655305">;</span>&nbsp;<span class="op" id="2655307">!</span><span class="ident" id="2655308">ok</span>&nbsp;<span class="op" id="2655311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2655316">return</span>&nbsp;<span class="ident" id="2655323">nil</span><span class="op" id="2655326">,</span>&nbsp;<span class="ident" id="2655328">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2655338">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2655342">zone</span><span class="op" id="2655346">[</span><span class="ident" id="2655347">i</span><span class="op" id="2655348">]</span><span class="op" id="2655349">.</span><span class="ident" id="2655350">isDST</span>&nbsp;<span class="op" id="2655356">=</span>&nbsp;<span class="ident" id="2655358">b</span>&nbsp;<span class="op" id="2655360">!=</span>&nbsp;<span class="num" id="2655363">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2655367">if</span>&nbsp;<span class="ident" id="2655370">b</span><span class="op" id="2655371">,</span>&nbsp;<span class="ident" id="2655373">ok</span>&nbsp;<span class="op" id="2655376">=</span>&nbsp;<span class="ident" id="2655378">zonedata</span><span class="op" id="2655386">.</span><span class="builtintype" id="2655387">byte</span><span class="op" id="2655391">(</span><span class="op" id="2655392">)</span><span class="op" id="2655393">;</span>&nbsp;<span class="op" id="2655395">!</span><span class="ident" id="2655396">ok</span>&nbsp;<span class="op" id="2655399">||</span>&nbsp;<span class="builtintype" id="2655402">int</span><span class="op" id="2655405">(</span><span class="ident" id="2655406">b</span><span class="op" id="2655407">)</span>&nbsp;<span class="op" id="2655409">&gt;=</span>&nbsp;<span class="builtinfunc" id="2655412">len</span><span class="op" id="2655415">(</span><span class="ident" id="2655416">abbrev</span><span class="op" id="2655422">)</span>&nbsp;<span class="op" id="2655424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2655429">return</span>&nbsp;<span class="ident" id="2655436">nil</span><span class="op" id="2655439">,</span>&nbsp;<span class="ident" id="2655441">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2655451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2655455">zone</span><span class="op" id="2655459">[</span><span class="ident" id="2655460">i</span><span class="op" id="2655461">]</span><span class="op" id="2655462">.</span><span class="ident" id="2655463">name</span>&nbsp;<span class="op" id="2655468">=</span>&nbsp;<span class="ident" id="2655470">byteString</span><span class="op" id="2655480">(</span><span class="ident" id="2655481">abbrev</span><span class="op" id="2655487">[</span><span class="ident" id="2655488">b</span><span class="op" id="2655489">:</span><span class="op" id="2655490">]</span><span class="op" id="2655491">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2655494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2655498">//&nbsp;Now&nbsp;the&nbsp;transition&nbsp;time&nbsp;info.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2655532">tx</span>&nbsp;<span class="op" id="2655535">:=</span>&nbsp;<span class="builtinfunc" id="2655538">make</span><span class="op" id="2655542">(</span><span class="op" id="2655543">[</span><span class="op" id="2655544">]</span><span class="ident" id="2655545">zoneTrans</span><span class="op" id="2655554">,</span>&nbsp;<span class="ident" id="2655556">n</span><span class="op" id="2655557">[</span><span class="ident" id="2655558">NTime</span><span class="op" id="2655563">]</span><span class="op" id="2655564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2655567">for</span>&nbsp;<span class="ident" id="2655571">i</span>&nbsp;<span class="op" id="2655573">:=</span>&nbsp;<span class="keyword" id="2655576">range</span>&nbsp;<span class="ident" id="2655582">tx</span>&nbsp;<span class="op" id="2655585">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2655589">var</span>&nbsp;<span class="ident" id="2655593">ok</span>&nbsp;<span class="builtintype" id="2655596">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2655603">var</span>&nbsp;<span class="ident" id="2655607">n</span>&nbsp;<span class="builtintype" id="2655609">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2655618">if</span>&nbsp;<span class="ident" id="2655621">n</span><span class="op" id="2655622">,</span>&nbsp;<span class="ident" id="2655624">ok</span>&nbsp;<span class="op" id="2655627">=</span>&nbsp;<span class="ident" id="2655629">txtimes</span><span class="op" id="2655636">.</span><span class="ident" id="2655637">big4</span><span class="op" id="2655641">(</span><span class="op" id="2655642">)</span><span class="op" id="2655643">;</span>&nbsp;<span class="op" id="2655645">!</span><span class="ident" id="2655646">ok</span>&nbsp;<span class="op" id="2655649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2655654">return</span>&nbsp;<span class="ident" id="2655661">nil</span><span class="op" id="2655664">,</span>&nbsp;<span class="ident" id="2655666">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2655676">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2655680">tx</span><span class="op" id="2655682">[</span><span class="ident" id="2655683">i</span><span class="op" id="2655684">]</span><span class="op" id="2655685">.</span><span class="ident" id="2655686">when</span>&nbsp;<span class="op" id="2655691">=</span>&nbsp;<span class="ident" id="2655693">int64</span><span class="op" id="2655698">(</span><span class="builtintype" id="2655699">int32</span><span class="op" id="2655704">(</span><span class="ident" id="2655705">n</span><span class="op" id="2655706">)</span><span class="op" id="2655707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2655711">if</span>&nbsp;<span class="builtintype" id="2655714">int</span><span class="op" id="2655717">(</span><span class="ident" id="2655718">txzones</span><span class="op" id="2655725">[</span><span class="ident" id="2655726">i</span><span class="op" id="2655727">]</span><span class="op" id="2655728">)</span>&nbsp;<span class="op" id="2655730">&gt;=</span>&nbsp;<span class="builtinfunc" id="2655733">len</span><span class="op" id="2655736">(</span><span class="ident" id="2655737">zone</span><span class="op" id="2655741">)</span>&nbsp;<span class="op" id="2655743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2655748">return</span>&nbsp;<span class="ident" id="2655755">nil</span><span class="op" id="2655758">,</span>&nbsp;<span class="ident" id="2655760">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2655770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2655774">tx</span><span class="op" id="2655776">[</span><span class="ident" id="2655777">i</span><span class="op" id="2655778">]</span><span class="op" id="2655779">.</span><span class="ident" id="2655780">index</span>&nbsp;<span class="op" id="2655786">=</span>&nbsp;<span class="ident" id="2655788">txzones</span><span class="op" id="2655795">[</span><span class="ident" id="2655796">i</span><span class="op" id="2655797">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2655801">if</span>&nbsp;<span class="ident" id="2655804">i</span>&nbsp;<span class="op" id="2655806">&lt;</span>&nbsp;<span class="builtinfunc" id="2655808">len</span><span class="op" id="2655811">(</span><span class="ident" id="2655812">isstd</span><span class="op" id="2655817">)</span>&nbsp;<span class="op" id="2655819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2655824">tx</span><span class="op" id="2655826">[</span><span class="ident" id="2655827">i</span><span class="op" id="2655828">]</span><span class="op" id="2655829">.</span><span class="ident" id="2655830">isstd</span>&nbsp;<span class="op" id="2655836">=</span>&nbsp;<span class="ident" id="2655838">isstd</span><span class="op" id="2655843">[</span><span class="ident" id="2655844">i</span><span class="op" id="2655845">]</span>&nbsp;<span class="op" id="2655847">!=</span>&nbsp;<span class="num" id="2655850">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2655854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2655858">if</span>&nbsp;<span class="ident" id="2655861">i</span>&nbsp;<span class="op" id="2655863">&lt;</span>&nbsp;<span class="builtinfunc" id="2655865">len</span><span class="op" id="2655868">(</span><span class="ident" id="2655869">isutc</span><span class="op" id="2655874">)</span>&nbsp;<span class="op" id="2655876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2655881">tx</span><span class="op" id="2655883">[</span><span class="ident" id="2655884">i</span><span class="op" id="2655885">]</span><span class="op" id="2655886">.</span><span class="ident" id="2655887">isutc</span>&nbsp;<span class="op" id="2655893">=</span>&nbsp;<span class="ident" id="2655895">isutc</span><span class="op" id="2655900">[</span><span class="ident" id="2655901">i</span><span class="op" id="2655902">]</span>&nbsp;<span class="op" id="2655904">!=</span>&nbsp;<span class="num" id="2655907">0</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2655911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2655914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2655918">if</span>&nbsp;<span class="builtinfunc" id="2655921">len</span><span class="op" id="2655924">(</span><span class="ident" id="2655925">tx</span><span class="op" id="2655927">)</span>&nbsp;<span class="op" id="2655929">==</span>&nbsp;<span class="num" id="2655932">0</span>&nbsp;<span class="op" id="2655934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2655938">//&nbsp;Build&nbsp;fake&nbsp;transition&nbsp;to&nbsp;cover&nbsp;all&nbsp;time.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2655984">//&nbsp;This&nbsp;happens&nbsp;in&nbsp;fixed&nbsp;locations&nbsp;like&nbsp;&#34;Etc/GMT0&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2656038">tx</span>&nbsp;<span class="op" id="2656041">=</span>&nbsp;<span class="builtinfunc" id="2656043">append</span><span class="op" id="2656049">(</span><span class="ident" id="2656050">tx</span><span class="op" id="2656052">,</span>&nbsp;<span class="ident" id="2656054">zoneTrans</span><span class="op" id="2656063">{</span><span class="ident" id="2656064">when</span><span class="op" id="2656068">:</span>&nbsp;<span class="ident" id="2656070">alpha</span><span class="op" id="2656075">,</span>&nbsp;<span class="ident" id="2656077">index</span><span class="op" id="2656082">:</span>&nbsp;<span class="num" id="2656084">0</span><span class="op" id="2656085">}</span><span class="op" id="2656086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2656089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2656093">//&nbsp;Committed&nbsp;to&nbsp;succeed.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2656119">l</span>&nbsp;<span class="op" id="2656121">=</span>&nbsp;<span class="op" id="2656123">&amp;</span><span class="ident" id="2656124">Location</span><span class="op" id="2656132">{</span><span class="ident" id="2656133">zone</span><span class="op" id="2656137">:</span>&nbsp;<span class="ident" id="2656139">zone</span><span class="op" id="2656143">,</span>&nbsp;<span class="ident" id="2656145">tx</span><span class="op" id="2656147">:</span>&nbsp;<span class="ident" id="2656149">tx</span><span class="op" id="2656151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2656155">//&nbsp;Fill&nbsp;in&nbsp;the&nbsp;cache&nbsp;with&nbsp;information&nbsp;about&nbsp;right&nbsp;now,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2656211">//&nbsp;since&nbsp;that&nbsp;will&nbsp;be&nbsp;the&nbsp;most&nbsp;common&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2656258">sec</span><span class="op" id="2656261">,</span>&nbsp;<span class="ident" id="2656263">_</span>&nbsp;<span class="op" id="2656265">:=</span>&nbsp;<span class="ident" id="2656268">now</span><span class="op" id="2656271">(</span><span class="op" id="2656272">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2656275">for</span>&nbsp;<span class="ident" id="2656279">i</span>&nbsp;<span class="op" id="2656281">:=</span>&nbsp;<span class="keyword" id="2656284">range</span>&nbsp;<span class="ident" id="2656290">tx</span>&nbsp;<span class="op" id="2656293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2656297">if</span>&nbsp;<span class="ident" id="2656300">tx</span><span class="op" id="2656302">[</span><span class="ident" id="2656303">i</span><span class="op" id="2656304">]</span><span class="op" id="2656305">.</span><span class="ident" id="2656306">when</span>&nbsp;<span class="op" id="2656311">&lt;=</span>&nbsp;<span class="ident" id="2656314">sec</span>&nbsp;<span class="op" id="2656318">&amp;&amp;</span>&nbsp;<span class="op" id="2656321">(</span><span class="ident" id="2656322">i</span><span class="op" id="2656323">+</span><span class="num" id="2656324">1</span>&nbsp;<span class="op" id="2656326">==</span>&nbsp;<span class="builtinfunc" id="2656329">len</span><span class="op" id="2656332">(</span><span class="ident" id="2656333">tx</span><span class="op" id="2656335">)</span>&nbsp;<span class="op" id="2656337">||</span>&nbsp;<span class="ident" id="2656340">sec</span>&nbsp;<span class="op" id="2656344">&lt;</span>&nbsp;<span class="ident" id="2656346">tx</span><span class="op" id="2656348">[</span><span class="ident" id="2656349">i</span><span class="op" id="2656350">+</span><span class="num" id="2656351">1</span><span class="op" id="2656352">]</span><span class="op" id="2656353">.</span><span class="ident" id="2656354">when</span><span class="op" id="2656358">)</span>&nbsp;<span class="op" id="2656360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2656365">l</span><span class="op" id="2656366">.</span><span class="ident" id="2656367">cacheStart</span>&nbsp;<span class="op" id="2656378">=</span>&nbsp;<span class="ident" id="2656380">tx</span><span class="op" id="2656382">[</span><span class="ident" id="2656383">i</span><span class="op" id="2656384">]</span><span class="op" id="2656385">.</span><span class="ident" id="2656386">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2656394">l</span><span class="op" id="2656395">.</span><span class="ident" id="2656396">cacheEnd</span>&nbsp;<span class="op" id="2656405">=</span>&nbsp;<span class="ident" id="2656407">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2656416">if</span>&nbsp;<span class="ident" id="2656419">i</span><span class="op" id="2656420">+</span><span class="num" id="2656421">1</span>&nbsp;<span class="op" id="2656423">&lt;</span>&nbsp;<span class="builtinfunc" id="2656425">len</span><span class="op" id="2656428">(</span><span class="ident" id="2656429">tx</span><span class="op" id="2656431">)</span>&nbsp;<span class="op" id="2656433">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2656439">l</span><span class="op" id="2656440">.</span><span class="ident" id="2656441">cacheEnd</span>&nbsp;<span class="op" id="2656450">=</span>&nbsp;<span class="ident" id="2656452">tx</span><span class="op" id="2656454">[</span><span class="ident" id="2656455">i</span><span class="op" id="2656456">+</span><span class="num" id="2656457">1</span><span class="op" id="2656458">]</span><span class="op" id="2656459">.</span><span class="ident" id="2656460">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2656468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2656473">l</span><span class="op" id="2656474">.</span><span class="ident" id="2656475">cacheZone</span>&nbsp;<span class="op" id="2656485">=</span>&nbsp;<span class="op" id="2656487">&amp;</span><span class="ident" id="2656488">l</span><span class="op" id="2656489">.</span><span class="ident" id="2656490">zone</span><span class="op" id="2656494">[</span><span class="ident" id="2656495">tx</span><span class="op" id="2656497">[</span><span class="ident" id="2656498">i</span><span class="op" id="2656499">]</span><span class="op" id="2656500">.</span><span class="ident" id="2656501">index</span><span class="op" id="2656506">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2656510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2656513">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2656517">return</span>&nbsp;<span class="ident" id="2656524">l</span><span class="op" id="2656525">,</span>&nbsp;<span class="ident" id="2656527">nil</span><br>
<span class="lineno"></span><span class="op" id="2656531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2656534">func</span>&nbsp;<span class="ident" id="2656539">loadZoneFile</span><span class="op" id="2656551">(</span><span class="ident" id="2656552">dir</span><span class="op" id="2656555">,</span>&nbsp;<span class="ident" id="2656557">name</span>&nbsp;<span class="builtintype" id="2656562">string</span><span class="op" id="2656568">)</span>&nbsp;<span class="op" id="2656570">(</span><span class="ident" id="2656571">l</span>&nbsp;<span class="op" id="2656573">*</span><span class="ident" id="2656574">Location</span><span class="op" id="2656582">,</span>&nbsp;<span class="ident" id="2656584">err</span>&nbsp;<span class="builtintype" id="2656588">error</span><span class="op" id="2656593">)</span>&nbsp;<span class="op" id="2656595">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2656598">if</span>&nbsp;<span class="builtinfunc" id="2656601">len</span><span class="op" id="2656604">(</span><span class="ident" id="2656605">dir</span><span class="op" id="2656608">)</span>&nbsp;<span class="op" id="2656610">&gt;</span>&nbsp;<span class="num" id="2656612">4</span>&nbsp;<span class="op" id="2656614">&amp;&amp;</span>&nbsp;<span class="ident" id="2656617">dir</span><span class="op" id="2656620">[</span><span class="builtinfunc" id="2656621">len</span><span class="op" id="2656624">(</span><span class="ident" id="2656625">dir</span><span class="op" id="2656628">)</span><span class="op" id="2656629">-</span><span class="num" id="2656630">4</span><span class="op" id="2656631">:</span><span class="op" id="2656632">]</span>&nbsp;<span class="op" id="2656634">==</span>&nbsp;<span class="string" id="2656637">&#34;.zip&#34;</span>&nbsp;<span class="op" id="2656644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2656648">return</span>&nbsp;<span class="ident" id="2656655">loadZoneZip</span><span class="op" id="2656666">(</span><span class="ident" id="2656667">dir</span><span class="op" id="2656670">,</span>&nbsp;<span class="ident" id="2656672">name</span><span class="op" id="2656676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2656679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2656682">if</span>&nbsp;<span class="ident" id="2656685">dir</span>&nbsp;<span class="op" id="2656689">!=</span>&nbsp;<span class="string" id="2656692">&#34;&#34;</span>&nbsp;<span class="op" id="2656695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2656699">name</span>&nbsp;<span class="op" id="2656704">=</span>&nbsp;<span class="ident" id="2656706">dir</span>&nbsp;<span class="op" id="2656710">+</span>&nbsp;<span class="string" id="2656712">&#34;/&#34;</span>&nbsp;<span class="op" id="2656716">+</span>&nbsp;<span class="ident" id="2656718">name</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2656724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2656727">buf</span><span class="op" id="2656730">,</span>&nbsp;<span class="ident" id="2656732">err</span>&nbsp;<span class="op" id="2656736">:=</span>&nbsp;<span class="ident" id="2656739">readFile</span><span class="op" id="2656747">(</span><span class="ident" id="2656748">name</span><span class="op" id="2656752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2656755">if</span>&nbsp;<span class="ident" id="2656758">err</span>&nbsp;<span class="op" id="2656762">!=</span>&nbsp;<span class="ident" id="2656765">nil</span>&nbsp;<span class="op" id="2656769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2656773">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2656781">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2656784">return</span>&nbsp;<span class="ident" id="2656791">loadZoneData</span><span class="op" id="2656803">(</span><span class="ident" id="2656804">buf</span><span class="op" id="2656807">)</span><br>
<span class="lineno"></span><span class="op" id="2656809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2656812">//&nbsp;There&nbsp;are&nbsp;500+&nbsp;zoneinfo&nbsp;files.&nbsp;&nbsp;Rather&nbsp;than&nbsp;distribute&nbsp;them&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2656879">//&nbsp;individually,&nbsp;we&nbsp;ship&nbsp;them&nbsp;in&nbsp;an&nbsp;uncompressed&nbsp;zip&nbsp;file.</span><br>
<span class="lineno">215</span><span class="comment" id="2656938">//&nbsp;Used&nbsp;this&nbsp;way,&nbsp;the&nbsp;zip&nbsp;file&nbsp;format&nbsp;serves&nbsp;as&nbsp;a&nbsp;commonly&nbsp;readable</span><br>
<span class="lineno"></span><span class="comment" id="2657006">//&nbsp;container&nbsp;for&nbsp;the&nbsp;individual&nbsp;small&nbsp;files.&nbsp;&nbsp;We&nbsp;choose&nbsp;zip&nbsp;over&nbsp;tar</span><br>
<span class="lineno"></span><span class="comment" id="2657075">//&nbsp;because&nbsp;zip&nbsp;files&nbsp;have&nbsp;a&nbsp;contiguous&nbsp;table&nbsp;of&nbsp;contents,&nbsp;making</span><br>
<span class="lineno"></span><span class="comment" id="2657140">//&nbsp;individual&nbsp;file&nbsp;lookups&nbsp;faster,&nbsp;and&nbsp;because&nbsp;the&nbsp;per-file&nbsp;overhead</span><br>
<span class="lineno"></span><span class="comment" id="2657209">//&nbsp;in&nbsp;a&nbsp;zip&nbsp;file&nbsp;is&nbsp;considerably&nbsp;less&nbsp;than&nbsp;tar&#39;s&nbsp;512&nbsp;bytes.</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="2657270">//&nbsp;get4&nbsp;returns&nbsp;the&nbsp;little-endian&nbsp;32-bit&nbsp;value&nbsp;in&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="2657323">func</span>&nbsp;<span class="ident" id="2657328">get4</span><span class="op" id="2657332">(</span><span class="ident" id="2657333">b</span>&nbsp;<span class="op" id="2657335">[</span><span class="op" id="2657336">]</span><span class="builtintype" id="2657337">byte</span><span class="op" id="2657341">)</span>&nbsp;<span class="builtintype" id="2657343">int</span>&nbsp;<span class="op" id="2657347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2657350">if</span>&nbsp;<span class="builtinfunc" id="2657353">len</span><span class="op" id="2657356">(</span><span class="ident" id="2657357">b</span><span class="op" id="2657358">)</span>&nbsp;<span class="op" id="2657360">&lt;</span>&nbsp;<span class="num" id="2657362">4</span>&nbsp;<span class="op" id="2657364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2657368">return</span>&nbsp;<span class="num" id="2657375">0</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2657378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2657381">return</span>&nbsp;<span class="builtintype" id="2657388">int</span><span class="op" id="2657391">(</span><span class="ident" id="2657392">b</span><span class="op" id="2657393">[</span><span class="num" id="2657394">0</span><span class="op" id="2657395">]</span><span class="op" id="2657396">)</span>&nbsp;<span class="op" id="2657398">|</span>&nbsp;<span class="builtintype" id="2657400">int</span><span class="op" id="2657403">(</span><span class="ident" id="2657404">b</span><span class="op" id="2657405">[</span><span class="num" id="2657406">1</span><span class="op" id="2657407">]</span><span class="op" id="2657408">)</span><span class="op" id="2657409">&lt;&lt;</span><span class="num" id="2657411">8</span>&nbsp;<span class="op" id="2657413">|</span>&nbsp;<span class="builtintype" id="2657415">int</span><span class="op" id="2657418">(</span><span class="ident" id="2657419">b</span><span class="op" id="2657420">[</span><span class="num" id="2657421">2</span><span class="op" id="2657422">]</span><span class="op" id="2657423">)</span><span class="op" id="2657424">&lt;&lt;</span><span class="num" id="2657426">16</span>&nbsp;<span class="op" id="2657429">|</span>&nbsp;<span class="builtintype" id="2657431">int</span><span class="op" id="2657434">(</span><span class="ident" id="2657435">b</span><span class="op" id="2657436">[</span><span class="num" id="2657437">3</span><span class="op" id="2657438">]</span><span class="op" id="2657439">)</span><span class="op" id="2657440">&lt;&lt;</span><span class="num" id="2657442">24</span><br>
<span class="lineno"></span><span class="op" id="2657445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2657448">//&nbsp;get2&nbsp;returns&nbsp;the&nbsp;little-endian&nbsp;16-bit&nbsp;value&nbsp;in&nbsp;b.</span><br>
<span class="lineno">230</span><span class="keyword" id="2657501">func</span>&nbsp;<span class="ident" id="2657506">get2</span><span class="op" id="2657510">(</span><span class="ident" id="2657511">b</span>&nbsp;<span class="op" id="2657513">[</span><span class="op" id="2657514">]</span><span class="builtintype" id="2657515">byte</span><span class="op" id="2657519">)</span>&nbsp;<span class="builtintype" id="2657521">int</span>&nbsp;<span class="op" id="2657525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2657528">if</span>&nbsp;<span class="builtinfunc" id="2657531">len</span><span class="op" id="2657534">(</span><span class="ident" id="2657535">b</span><span class="op" id="2657536">)</span>&nbsp;<span class="op" id="2657538">&lt;</span>&nbsp;<span class="num" id="2657540">2</span>&nbsp;<span class="op" id="2657542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2657546">return</span>&nbsp;<span class="num" id="2657553">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2657556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2657559">return</span>&nbsp;<span class="builtintype" id="2657566">int</span><span class="op" id="2657569">(</span><span class="ident" id="2657570">b</span><span class="op" id="2657571">[</span><span class="num" id="2657572">0</span><span class="op" id="2657573">]</span><span class="op" id="2657574">)</span>&nbsp;<span class="op" id="2657576">|</span>&nbsp;<span class="builtintype" id="2657578">int</span><span class="op" id="2657581">(</span><span class="ident" id="2657582">b</span><span class="op" id="2657583">[</span><span class="num" id="2657584">1</span><span class="op" id="2657585">]</span><span class="op" id="2657586">)</span><span class="op" id="2657587">&lt;&lt;</span><span class="num" id="2657589">8</span><br>
<span class="lineno">235</span><span class="op" id="2657591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2657594">func</span>&nbsp;<span class="ident" id="2657599">loadZoneZip</span><span class="op" id="2657610">(</span><span class="ident" id="2657611">zipfile</span><span class="op" id="2657618">,</span>&nbsp;<span class="ident" id="2657620">name</span>&nbsp;<span class="builtintype" id="2657625">string</span><span class="op" id="2657631">)</span>&nbsp;<span class="op" id="2657633">(</span><span class="ident" id="2657634">l</span>&nbsp;<span class="op" id="2657636">*</span><span class="ident" id="2657637">Location</span><span class="op" id="2657645">,</span>&nbsp;<span class="ident" id="2657647">err</span>&nbsp;<span class="builtintype" id="2657651">error</span><span class="op" id="2657656">)</span>&nbsp;<span class="op" id="2657658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2657661">fd</span><span class="op" id="2657663">,</span>&nbsp;<span class="ident" id="2657665">err</span>&nbsp;<span class="op" id="2657669">:=</span>&nbsp;<span class="ident" id="2657672">open</span><span class="op" id="2657676">(</span><span class="ident" id="2657677">zipfile</span><span class="op" id="2657684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2657687">if</span>&nbsp;<span class="ident" id="2657690">err</span>&nbsp;<span class="op" id="2657694">!=</span>&nbsp;<span class="ident" id="2657697">nil</span>&nbsp;<span class="op" id="2657701">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2657705">return</span>&nbsp;<span class="ident" id="2657712">nil</span><span class="op" id="2657715">,</span>&nbsp;<span class="ident" id="2657717">errors</span><span class="op" id="2657723">.</span><span class="ident" id="2657724">New</span><span class="op" id="2657727">(</span><span class="string" id="2657728">&#34;open&nbsp;&#34;</span>&nbsp;<span class="op" id="2657736">+</span>&nbsp;<span class="ident" id="2657738">zipfile</span>&nbsp;<span class="op" id="2657746">+</span>&nbsp;<span class="string" id="2657748">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="2657753">+</span>&nbsp;<span class="ident" id="2657755">err</span><span class="op" id="2657758">.</span><span class="ident" id="2657759">Error</span><span class="op" id="2657764">(</span><span class="op" id="2657765">)</span><span class="op" id="2657766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2657769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2657772">defer</span>&nbsp;<span class="ident" id="2657778">closefd</span><span class="op" id="2657785">(</span><span class="ident" id="2657786">fd</span><span class="op" id="2657788">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2657792">const</span>&nbsp;<span class="op" id="2657798">(</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2657802">zecheader</span>&nbsp;<span class="op" id="2657812">=</span>&nbsp;<span class="num" id="2657814">0x06054b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2657827">zcheader</span>&nbsp;&nbsp;<span class="op" id="2657837">=</span>&nbsp;<span class="num" id="2657839">0x02014b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2657852">ztailsize</span>&nbsp;<span class="op" id="2657862">=</span>&nbsp;<span class="num" id="2657864">22</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2657870">zheadersize</span>&nbsp;<span class="op" id="2657882">=</span>&nbsp;<span class="num" id="2657884">30</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2657889">zheader</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2657901">=</span>&nbsp;<span class="num" id="2657903">0x04034b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2657915">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2657919">buf</span>&nbsp;<span class="op" id="2657923">:=</span>&nbsp;<span class="builtinfunc" id="2657926">make</span><span class="op" id="2657930">(</span><span class="op" id="2657931">[</span><span class="op" id="2657932">]</span><span class="builtintype" id="2657933">byte</span><span class="op" id="2657937">,</span>&nbsp;<span class="ident" id="2657939">ztailsize</span><span class="op" id="2657948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2657951">if</span>&nbsp;<span class="ident" id="2657954">err</span>&nbsp;<span class="op" id="2657958">:=</span>&nbsp;<span class="ident" id="2657961">preadn</span><span class="op" id="2657967">(</span><span class="ident" id="2657968">fd</span><span class="op" id="2657970">,</span>&nbsp;<span class="ident" id="2657972">buf</span><span class="op" id="2657975">,</span>&nbsp;<span class="op" id="2657977">-</span><span class="ident" id="2657978">ztailsize</span><span class="op" id="2657987">)</span><span class="op" id="2657988">;</span>&nbsp;<span class="ident" id="2657990">err</span>&nbsp;<span class="op" id="2657994">!=</span>&nbsp;<span class="ident" id="2657997">nil</span>&nbsp;<span class="op" id="2658001">||</span>&nbsp;<span class="ident" id="2658004">get4</span><span class="op" id="2658008">(</span><span class="ident" id="2658009">buf</span><span class="op" id="2658012">)</span>&nbsp;<span class="op" id="2658014">!=</span>&nbsp;<span class="ident" id="2658017">zecheader</span>&nbsp;<span class="op" id="2658027">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2658031">return</span>&nbsp;<span class="ident" id="2658038">nil</span><span class="op" id="2658041">,</span>&nbsp;<span class="ident" id="2658043">errors</span><span class="op" id="2658049">.</span><span class="ident" id="2658050">New</span><span class="op" id="2658053">(</span><span class="string" id="2658054">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2658074">+</span>&nbsp;<span class="ident" id="2658076">zipfile</span><span class="op" id="2658083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2658086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2658089">n</span>&nbsp;<span class="op" id="2658091">:=</span>&nbsp;<span class="ident" id="2658094">get2</span><span class="op" id="2658098">(</span><span class="ident" id="2658099">buf</span><span class="op" id="2658102">[</span><span class="num" id="2658103">10</span><span class="op" id="2658105">:</span><span class="op" id="2658106">]</span><span class="op" id="2658107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2658110">size</span>&nbsp;<span class="op" id="2658115">:=</span>&nbsp;<span class="ident" id="2658118">get4</span><span class="op" id="2658122">(</span><span class="ident" id="2658123">buf</span><span class="op" id="2658126">[</span><span class="num" id="2658127">12</span><span class="op" id="2658129">:</span><span class="op" id="2658130">]</span><span class="op" id="2658131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2658134">off</span>&nbsp;<span class="op" id="2658138">:=</span>&nbsp;<span class="ident" id="2658141">get4</span><span class="op" id="2658145">(</span><span class="ident" id="2658146">buf</span><span class="op" id="2658149">[</span><span class="num" id="2658150">16</span><span class="op" id="2658152">:</span><span class="op" id="2658153">]</span><span class="op" id="2658154">)</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2658158">buf</span>&nbsp;<span class="op" id="2658162">=</span>&nbsp;<span class="builtinfunc" id="2658164">make</span><span class="op" id="2658168">(</span><span class="op" id="2658169">[</span><span class="op" id="2658170">]</span><span class="builtintype" id="2658171">byte</span><span class="op" id="2658175">,</span>&nbsp;<span class="ident" id="2658177">size</span><span class="op" id="2658181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2658184">if</span>&nbsp;<span class="ident" id="2658187">err</span>&nbsp;<span class="op" id="2658191">:=</span>&nbsp;<span class="ident" id="2658194">preadn</span><span class="op" id="2658200">(</span><span class="ident" id="2658201">fd</span><span class="op" id="2658203">,</span>&nbsp;<span class="ident" id="2658205">buf</span><span class="op" id="2658208">,</span>&nbsp;<span class="ident" id="2658210">off</span><span class="op" id="2658213">)</span><span class="op" id="2658214">;</span>&nbsp;<span class="ident" id="2658216">err</span>&nbsp;<span class="op" id="2658220">!=</span>&nbsp;<span class="ident" id="2658223">nil</span>&nbsp;<span class="op" id="2658227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2658231">return</span>&nbsp;<span class="ident" id="2658238">nil</span><span class="op" id="2658241">,</span>&nbsp;<span class="ident" id="2658243">errors</span><span class="op" id="2658249">.</span><span class="ident" id="2658250">New</span><span class="op" id="2658253">(</span><span class="string" id="2658254">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2658274">+</span>&nbsp;<span class="ident" id="2658276">zipfile</span><span class="op" id="2658283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2658286">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2658290">for</span>&nbsp;<span class="ident" id="2658294">i</span>&nbsp;<span class="op" id="2658296">:=</span>&nbsp;<span class="num" id="2658299">0</span><span class="op" id="2658300">;</span>&nbsp;<span class="ident" id="2658302">i</span>&nbsp;<span class="op" id="2658304">&lt;</span>&nbsp;<span class="ident" id="2658306">n</span><span class="op" id="2658307">;</span>&nbsp;<span class="ident" id="2658309">i</span><span class="op" id="2658310">++</span>&nbsp;<span class="op" id="2658313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2658317">//&nbsp;zip&nbsp;entry&nbsp;layout:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2658340">//&nbsp;&nbsp;&nbsp;&nbsp0&nbsp;&nbsp;&nbsp;&nbspmagic[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2658356">//&nbsp;&nbsp;&nbsp;&nbsp4&nbsp;&nbsp;&nbsp;&nbspmadevers[1]</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2658375">//&nbsp;&nbsp;&nbsp;&nbsp5&nbsp;&nbsp;&nbsp;&nbspmadeos[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2658392">//&nbsp;&nbsp;&nbsp;&nbsp6&nbsp;&nbsp;&nbsp;&nbspextvers[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2658410">//&nbsp;&nbsp;&nbsp;&nbsp7&nbsp;&nbsp;&nbsp;&nbspextos[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2658426">//&nbsp;&nbsp;&nbsp;&nbsp8&nbsp;&nbsp;&nbsp;&nbspflags[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2658442">//&nbsp;&nbsp;&nbsp;&nbsp10&nbsp;&nbsp;&nbsp;&nbspmeth[2]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2658458">//&nbsp;&nbsp;&nbsp;&nbsp12&nbsp;&nbsp;&nbsp;&nbspmodtime[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2658477">//&nbsp;&nbsp;&nbsp;&nbsp14&nbsp;&nbsp;&nbsp;&nbspmoddate[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2658496">//&nbsp;&nbsp;&nbsp;&nbsp16&nbsp;&nbsp;&nbsp;&nbspcrc[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2658511">//&nbsp;&nbsp;&nbsp;&nbsp20&nbsp;&nbsp;&nbsp;&nbspcsize[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2658528">//&nbsp;&nbsp;&nbsp;&nbsp24&nbsp;&nbsp;&nbsp;&nbspuncsize[4]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2658547">//&nbsp;&nbsp;&nbsp;&nbsp28&nbsp;&nbsp;&nbsp;&nbspnamelen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2658566">//&nbsp;&nbsp;&nbsp;&nbsp30&nbsp;&nbsp;&nbsp;&nbspxlen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2658582">//&nbsp;&nbsp;&nbsp;&nbsp32&nbsp;&nbsp;&nbsp;&nbspfclen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2658599">//&nbsp;&nbsp;&nbsp;&nbsp34&nbsp;&nbsp;&nbsp;&nbspdisknum[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2658618">//&nbsp;&nbsp;&nbsp;&nbsp36&nbsp;&nbsp;&nbsp;&nbspiattr[2]</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2658635">//&nbsp;&nbsp;&nbsp;&nbsp38&nbsp;&nbsp;&nbsp;&nbspeattr[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2658652">//&nbsp;&nbsp;&nbsp;&nbsp42&nbsp;&nbsp;&nbsp;&nbspoff[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2658667">//&nbsp;&nbsp;&nbsp;&nbsp46&nbsp;&nbsp;&nbsp;&nbspname[namelen]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2658689">//&nbsp;&nbsp;&nbsp;&nbsp46+namelen+xlen+fclen&nbsp;-&nbsp;next&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2658730">//</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2658735">if</span>&nbsp;<span class="ident" id="2658738">get4</span><span class="op" id="2658742">(</span><span class="ident" id="2658743">buf</span><span class="op" id="2658746">)</span>&nbsp;<span class="op" id="2658748">!=</span>&nbsp;<span class="ident" id="2658751">zcheader</span>&nbsp;<span class="op" id="2658760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2658765">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2658773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2658777">meth</span>&nbsp;<span class="op" id="2658782">:=</span>&nbsp;<span class="ident" id="2658785">get2</span><span class="op" id="2658789">(</span><span class="ident" id="2658790">buf</span><span class="op" id="2658793">[</span><span class="num" id="2658794">10</span><span class="op" id="2658796">:</span><span class="op" id="2658797">]</span><span class="op" id="2658798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2658802">size</span>&nbsp;<span class="op" id="2658807">:=</span>&nbsp;<span class="ident" id="2658810">get4</span><span class="op" id="2658814">(</span><span class="ident" id="2658815">buf</span><span class="op" id="2658818">[</span><span class="num" id="2658819">24</span><span class="op" id="2658821">:</span><span class="op" id="2658822">]</span><span class="op" id="2658823">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2658827">namelen</span>&nbsp;<span class="op" id="2658835">:=</span>&nbsp;<span class="ident" id="2658838">get2</span><span class="op" id="2658842">(</span><span class="ident" id="2658843">buf</span><span class="op" id="2658846">[</span><span class="num" id="2658847">28</span><span class="op" id="2658849">:</span><span class="op" id="2658850">]</span><span class="op" id="2658851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2658855">xlen</span>&nbsp;<span class="op" id="2658860">:=</span>&nbsp;<span class="ident" id="2658863">get2</span><span class="op" id="2658867">(</span><span class="ident" id="2658868">buf</span><span class="op" id="2658871">[</span><span class="num" id="2658872">30</span><span class="op" id="2658874">:</span><span class="op" id="2658875">]</span><span class="op" id="2658876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2658880">fclen</span>&nbsp;<span class="op" id="2658886">:=</span>&nbsp;<span class="ident" id="2658889">get2</span><span class="op" id="2658893">(</span><span class="ident" id="2658894">buf</span><span class="op" id="2658897">[</span><span class="num" id="2658898">32</span><span class="op" id="2658900">:</span><span class="op" id="2658901">]</span><span class="op" id="2658902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2658906">off</span>&nbsp;<span class="op" id="2658910">:=</span>&nbsp;<span class="ident" id="2658913">get4</span><span class="op" id="2658917">(</span><span class="ident" id="2658918">buf</span><span class="op" id="2658921">[</span><span class="num" id="2658922">42</span><span class="op" id="2658924">:</span><span class="op" id="2658925">]</span><span class="op" id="2658926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2658930">zname</span>&nbsp;<span class="op" id="2658936">:=</span>&nbsp;<span class="ident" id="2658939">buf</span><span class="op" id="2658942">[</span><span class="num" id="2658943">46</span>&nbsp;<span class="op" id="2658946">:</span>&nbsp;<span class="num" id="2658948">46</span><span class="op" id="2658950">+</span><span class="ident" id="2658951">namelen</span><span class="op" id="2658958">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2658962">buf</span>&nbsp;<span class="op" id="2658966">=</span>&nbsp;<span class="ident" id="2658968">buf</span><span class="op" id="2658971">[</span><span class="num" id="2658972">46</span><span class="op" id="2658974">+</span><span class="ident" id="2658975">namelen</span><span class="op" id="2658982">+</span><span class="ident" id="2658983">xlen</span><span class="op" id="2658987">+</span><span class="ident" id="2658988">fclen</span><span class="op" id="2658993">:</span><span class="op" id="2658994">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2658998">if</span>&nbsp;<span class="builtintype" id="2659001">string</span><span class="op" id="2659007">(</span><span class="ident" id="2659008">zname</span><span class="op" id="2659013">)</span>&nbsp;<span class="op" id="2659015">!=</span>&nbsp;<span class="ident" id="2659018">name</span>&nbsp;<span class="op" id="2659023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2659028">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2659039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2659043">if</span>&nbsp;<span class="ident" id="2659046">meth</span>&nbsp;<span class="op" id="2659051">!=</span>&nbsp;<span class="num" id="2659054">0</span>&nbsp;<span class="op" id="2659056">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2659061">return</span>&nbsp;<span class="ident" id="2659068">nil</span><span class="op" id="2659071">,</span>&nbsp;<span class="ident" id="2659073">errors</span><span class="op" id="2659079">.</span><span class="ident" id="2659080">New</span><span class="op" id="2659083">(</span><span class="string" id="2659084">&#34;unsupported&nbsp;compression&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="2659115">+</span>&nbsp;<span class="ident" id="2659117">name</span>&nbsp;<span class="op" id="2659122">+</span>&nbsp;<span class="string" id="2659124">&#34;&nbsp;in&nbsp;&#34;</span>&nbsp;<span class="op" id="2659131">+</span>&nbsp;<span class="ident" id="2659133">zipfile</span><span class="op" id="2659140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2659144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2659149">//&nbsp;zip&nbsp;per-file&nbsp;header&nbsp;layout:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2659182">//&nbsp;&nbsp;&nbsp;&nbsp0&nbsp;&nbsp;&nbsp;&nbspmagic[4]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2659198">//&nbsp;&nbsp;&nbsp;&nbsp4&nbsp;&nbsp;&nbsp;&nbspextvers[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2659216">//&nbsp;&nbsp;&nbsp;&nbsp5&nbsp;&nbsp;&nbsp;&nbspextos[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2659232">//&nbsp;&nbsp;&nbsp;&nbsp6&nbsp;&nbsp;&nbsp;&nbspflags[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2659248">//&nbsp;&nbsp;&nbsp;&nbsp8&nbsp;&nbsp;&nbsp;&nbspmeth[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2659263">//&nbsp;&nbsp;&nbsp;&nbsp10&nbsp;&nbsp;&nbsp;&nbspmodtime[2]</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2659282">//&nbsp;&nbsp;&nbsp;&nbsp12&nbsp;&nbsp;&nbsp;&nbspmoddate[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2659301">//&nbsp;&nbsp;&nbsp;&nbsp14&nbsp;&nbsp;&nbsp;&nbspcrc[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2659316">//&nbsp;&nbsp;&nbsp;&nbsp18&nbsp;&nbsp;&nbsp;&nbspcsize[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2659333">//&nbsp;&nbsp;&nbsp;&nbsp22&nbsp;&nbsp;&nbsp;&nbspuncsize[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2659352">//&nbsp;&nbsp;&nbsp;&nbsp26&nbsp;&nbsp;&nbsp;&nbspnamelen[2]</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2659371">//&nbsp;&nbsp;&nbsp;&nbsp28&nbsp;&nbsp;&nbsp;&nbspxlen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2659387">//&nbsp;&nbsp;&nbsp;&nbsp30&nbsp;&nbsp;&nbsp;&nbspname[namelen]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2659409">//&nbsp;&nbsp;&nbsp;&nbsp30+namelen+xlen&nbsp;-&nbsp;file&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2659442">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2659447">buf</span>&nbsp;<span class="op" id="2659451">=</span>&nbsp;<span class="builtinfunc" id="2659453">make</span><span class="op" id="2659457">(</span><span class="op" id="2659458">[</span><span class="op" id="2659459">]</span><span class="builtintype" id="2659460">byte</span><span class="op" id="2659464">,</span>&nbsp;<span class="ident" id="2659466">zheadersize</span><span class="op" id="2659477">+</span><span class="ident" id="2659478">namelen</span><span class="op" id="2659485">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2659489">if</span>&nbsp;<span class="ident" id="2659492">err</span>&nbsp;<span class="op" id="2659496">:=</span>&nbsp;<span class="ident" id="2659499">preadn</span><span class="op" id="2659505">(</span><span class="ident" id="2659506">fd</span><span class="op" id="2659508">,</span>&nbsp;<span class="ident" id="2659510">buf</span><span class="op" id="2659513">,</span>&nbsp;<span class="ident" id="2659515">off</span><span class="op" id="2659518">)</span><span class="op" id="2659519">;</span>&nbsp;<span class="ident" id="2659521">err</span>&nbsp;<span class="op" id="2659525">!=</span>&nbsp;<span class="ident" id="2659528">nil</span>&nbsp;<span class="op" id="2659532">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2659538">get4</span><span class="op" id="2659542">(</span><span class="ident" id="2659543">buf</span><span class="op" id="2659546">)</span>&nbsp;<span class="op" id="2659548">!=</span>&nbsp;<span class="ident" id="2659551">zheader</span>&nbsp;<span class="op" id="2659559">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2659565">get2</span><span class="op" id="2659569">(</span><span class="ident" id="2659570">buf</span><span class="op" id="2659573">[</span><span class="num" id="2659574">8</span><span class="op" id="2659575">:</span><span class="op" id="2659576">]</span><span class="op" id="2659577">)</span>&nbsp;<span class="op" id="2659579">!=</span>&nbsp;<span class="ident" id="2659582">meth</span>&nbsp;<span class="op" id="2659587">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2659593">get2</span><span class="op" id="2659597">(</span><span class="ident" id="2659598">buf</span><span class="op" id="2659601">[</span><span class="num" id="2659602">26</span><span class="op" id="2659604">:</span><span class="op" id="2659605">]</span><span class="op" id="2659606">)</span>&nbsp;<span class="op" id="2659608">!=</span>&nbsp;<span class="ident" id="2659611">namelen</span>&nbsp;<span class="op" id="2659619">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2659625">string</span><span class="op" id="2659631">(</span><span class="ident" id="2659632">buf</span><span class="op" id="2659635">[</span><span class="num" id="2659636">30</span><span class="op" id="2659638">:</span><span class="num" id="2659639">30</span><span class="op" id="2659641">+</span><span class="ident" id="2659642">namelen</span><span class="op" id="2659649">]</span><span class="op" id="2659650">)</span>&nbsp;<span class="op" id="2659652">!=</span>&nbsp;<span class="ident" id="2659655">name</span>&nbsp;<span class="op" id="2659660">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2659665">return</span>&nbsp;<span class="ident" id="2659672">nil</span><span class="op" id="2659675">,</span>&nbsp;<span class="ident" id="2659677">errors</span><span class="op" id="2659683">.</span><span class="ident" id="2659684">New</span><span class="op" id="2659687">(</span><span class="string" id="2659688">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2659708">+</span>&nbsp;<span class="ident" id="2659710">zipfile</span><span class="op" id="2659717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2659721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2659725">xlen</span>&nbsp;<span class="op" id="2659730">=</span>&nbsp;<span class="ident" id="2659732">get2</span><span class="op" id="2659736">(</span><span class="ident" id="2659737">buf</span><span class="op" id="2659740">[</span><span class="num" id="2659741">28</span><span class="op" id="2659743">:</span><span class="op" id="2659744">]</span><span class="op" id="2659745">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2659750">buf</span>&nbsp;<span class="op" id="2659754">=</span>&nbsp;<span class="builtinfunc" id="2659756">make</span><span class="op" id="2659760">(</span><span class="op" id="2659761">[</span><span class="op" id="2659762">]</span><span class="builtintype" id="2659763">byte</span><span class="op" id="2659767">,</span>&nbsp;<span class="ident" id="2659769">size</span><span class="op" id="2659773">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2659777">if</span>&nbsp;<span class="ident" id="2659780">err</span>&nbsp;<span class="op" id="2659784">:=</span>&nbsp;<span class="ident" id="2659787">preadn</span><span class="op" id="2659793">(</span><span class="ident" id="2659794">fd</span><span class="op" id="2659796">,</span>&nbsp;<span class="ident" id="2659798">buf</span><span class="op" id="2659801">,</span>&nbsp;<span class="ident" id="2659803">off</span><span class="op" id="2659806">+</span><span class="num" id="2659807">30</span><span class="op" id="2659809">+</span><span class="ident" id="2659810">namelen</span><span class="op" id="2659817">+</span><span class="ident" id="2659818">xlen</span><span class="op" id="2659822">)</span><span class="op" id="2659823">;</span>&nbsp;<span class="ident" id="2659825">err</span>&nbsp;<span class="op" id="2659829">!=</span>&nbsp;<span class="ident" id="2659832">nil</span>&nbsp;<span class="op" id="2659836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2659841">return</span>&nbsp;<span class="ident" id="2659848">nil</span><span class="op" id="2659851">,</span>&nbsp;<span class="ident" id="2659853">errors</span><span class="op" id="2659859">.</span><span class="ident" id="2659860">New</span><span class="op" id="2659863">(</span><span class="string" id="2659864">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2659884">+</span>&nbsp;<span class="ident" id="2659886">zipfile</span><span class="op" id="2659893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2659897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2659902">return</span>&nbsp;<span class="ident" id="2659909">loadZoneData</span><span class="op" id="2659921">(</span><span class="ident" id="2659922">buf</span><span class="op" id="2659925">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2659928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2659932">return</span>&nbsp;<span class="ident" id="2659939">nil</span><span class="op" id="2659942">,</span>&nbsp;<span class="ident" id="2659944">errors</span><span class="op" id="2659950">.</span><span class="ident" id="2659951">New</span><span class="op" id="2659954">(</span><span class="string" id="2659955">&#34;cannot&nbsp;find&nbsp;&#34;</span>&nbsp;<span class="op" id="2659970">+</span>&nbsp;<span class="ident" id="2659972">name</span>&nbsp;<span class="op" id="2659977">+</span>&nbsp;<span class="string" id="2659979">&#34;&nbsp;in&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2659995">+</span>&nbsp;<span class="ident" id="2659997">zipfile</span><span class="op" id="2660004">)</span><br>
<span class="lineno"></span><span class="op" id="2660006">}</span>
</div>
</body>
</html>
