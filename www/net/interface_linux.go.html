<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2596155">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2596211">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2596265">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2596316">package</span>&nbsp;<span class="ident" id="2596324">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2596329">import</span>&nbsp;<span class="op" id="2596336">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2596339">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2596345">&#34;syscall&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2596356">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="2596365">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2596368">//&nbsp;If&nbsp;the&nbsp;ifindex&nbsp;is&nbsp;zero,&nbsp;interfaceTable&nbsp;returns&nbsp;mappings&nbsp;of&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2596434">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;a&nbsp;mapping&nbsp;of&nbsp;a&nbsp;specific</span><br>
<span class="lineno">15</span><span class="comment" id="2596503">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2596517">func</span>&nbsp;<span class="ident" id="2596522">interfaceTable</span><span class="op" id="2596536">(</span><span class="ident" id="2596537">ifindex</span>&nbsp;<span class="builtintype" id="2596545">int</span><span class="op" id="2596548">)</span>&nbsp;<span class="op" id="2596550">(</span><span class="op" id="2596551">[</span><span class="op" id="2596552">]</span><span class="ident" id="2596553"><a href="/net/interface.go.html#2593524">Interface</a></span><span class="op" id="2596562">,</span>&nbsp;<span class="builtintype" id="2596564">error</span><span class="op" id="2596569">)</span>&nbsp;<span class="op" id="2596571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2596574">tab</span><span class="op" id="2596577">,</span>&nbsp;<span class="ident" id="2596579">err</span>&nbsp;<span class="op" id="2596583">:=</span>&nbsp;<span class="ident" id="2596586"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2596593">.</span><span class="ident" id="2596594">NetlinkRIB</span><span class="op" id="2596604">(</span><span class="ident" id="2596605"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2596612">.</span><span class="ident" id="2596613">RTM_GETLINK</span><span class="op" id="2596624">,</span>&nbsp;<span class="ident" id="2596626"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2596633">.</span><span class="ident" id="2596634">AF_UNSPEC</span><span class="op" id="2596643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2596646">if</span>&nbsp;<span class="ident" id="2596649"><a href="/net/interface_linux.go.html#2596579">err</a></span>&nbsp;<span class="op" id="2596653">!=</span>&nbsp;<span class="ident" id="2596656">nil</span>&nbsp;<span class="op" id="2596660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2596664">return</span>&nbsp;<span class="ident" id="2596671">nil</span><span class="op" id="2596674">,</span>&nbsp;<span class="ident" id="2596676"><a href="/net/interface_linux.go.html#2596339">os</a></span><span class="op" id="2596678">.</span><span class="ident" id="2596679">NewSyscallError</span><span class="op" id="2596694">(</span><span class="string" id="2596695">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="2596708">,</span>&nbsp;<span class="ident" id="2596710"><a href="/net/interface_linux.go.html#2596579">err</a></span><span class="op" id="2596713">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2596716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2596719">msgs</span><span class="op" id="2596723">,</span>&nbsp;<span class="ident" id="2596725"><a href="/net/interface_linux.go.html#2596579">err</a></span>&nbsp;<span class="op" id="2596729">:=</span>&nbsp;<span class="ident" id="2596732"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2596739">.</span><span class="ident" id="2596740">ParseNetlinkMessage</span><span class="op" id="2596759">(</span><span class="ident" id="2596760"><a href="/net/interface_linux.go.html#2596574">tab</a></span><span class="op" id="2596763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2596766">if</span>&nbsp;<span class="ident" id="2596769"><a href="/net/interface_linux.go.html#2596579">err</a></span>&nbsp;<span class="op" id="2596773">!=</span>&nbsp;<span class="ident" id="2596776">nil</span>&nbsp;<span class="op" id="2596780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2596784">return</span>&nbsp;<span class="ident" id="2596791">nil</span><span class="op" id="2596794">,</span>&nbsp;<span class="ident" id="2596796"><a href="/net/interface_linux.go.html#2596339">os</a></span><span class="op" id="2596798">.</span><span class="ident" id="2596799">NewSyscallError</span><span class="op" id="2596814">(</span><span class="string" id="2596815">&#34;netlink&nbsp;message&#34;</span><span class="op" id="2596832">,</span>&nbsp;<span class="ident" id="2596834"><a href="/net/interface_linux.go.html#2596579">err</a></span><span class="op" id="2596837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2596840">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2596843">var</span>&nbsp;<span class="ident" id="2596847">ift</span>&nbsp;<span class="op" id="2596851">[</span><span class="op" id="2596852">]</span><span class="ident" id="2596853"><a href="/net/interface.go.html#2593524">Interface</a></span><br>
<span class="lineno"></span><span class="ident" id="2596863">loop</span><span class="op" id="2596867">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2596870">for</span>&nbsp;<span class="ident" id="2596874">_</span><span class="op" id="2596875">,</span>&nbsp;<span class="ident" id="2596877">m</span>&nbsp;<span class="op" id="2596879">:=</span>&nbsp;<span class="keyword" id="2596882">range</span>&nbsp;<span class="ident" id="2596888"><a href="/net/interface_linux.go.html#2596719">msgs</a></span>&nbsp;<span class="op" id="2596893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2596897">switch</span>&nbsp;<span class="ident" id="2596904"><a href="/net/interface_linux.go.html#2596877">m</a></span><span class="op" id="2596905">.</span><span class="ident" id="2596906">Header</span><span class="op" id="2596912">.</span><span class="ident" id="2596913">Type</span>&nbsp;<span class="op" id="2596918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2596922">case</span>&nbsp;<span class="ident" id="2596927"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2596934">.</span><span class="ident" id="2596935">NLMSG_DONE</span><span class="op" id="2596945">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2596950">break</span>&nbsp;<span class="ident" id="2596956">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2596963">case</span>&nbsp;<span class="ident" id="2596968"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2596975">.</span><span class="ident" id="2596976">RTM_NEWLINK</span><span class="op" id="2596987">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2596992">ifim</span>&nbsp;<span class="op" id="2596997">:=</span>&nbsp;<span class="op" id="2597000">(</span><span class="op" id="2597001">*</span><span class="ident" id="2597002"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2597009">.</span><span class="ident" id="2597010">IfInfomsg</span><span class="op" id="2597019">)</span><span class="op" id="2597020">(</span><span class="ident" id="2597021"><a href="/net/interface_linux.go.html#2596356">unsafe</a></span><span class="op" id="2597027">.</span><span class="ident" id="2597028">Pointer</span><span class="op" id="2597035">(</span><span class="op" id="2597036">&amp;</span><span class="ident" id="2597037"><a href="/net/interface_linux.go.html#2596877">m</a></span><span class="op" id="2597038">.</span><span class="ident" id="2597039">Data</span><span class="op" id="2597043">[</span><span class="num" id="2597044">0</span><span class="op" id="2597045">]</span><span class="op" id="2597046">)</span><span class="op" id="2597047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2597052">if</span>&nbsp;<span class="ident" id="2597055"><a href="/net/interface_linux.go.html#2596537">ifindex</a></span>&nbsp;<span class="op" id="2597063">==</span>&nbsp;<span class="num" id="2597066">0</span>&nbsp;<span class="op" id="2597068">||</span>&nbsp;<span class="ident" id="2597071"><a href="/net/interface_linux.go.html#2596537">ifindex</a></span>&nbsp;<span class="op" id="2597079">==</span>&nbsp;<span class="builtintype" id="2597082">int</span><span class="op" id="2597085">(</span><span class="ident" id="2597086"><a href="/net/interface_linux.go.html#2596992">ifim</a></span><span class="op" id="2597090">.</span><span class="ident" id="2597091">Index</span><span class="op" id="2597096">)</span>&nbsp;<span class="op" id="2597098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597104">attrs</span><span class="op" id="2597109">,</span>&nbsp;<span class="ident" id="2597111">err</span>&nbsp;<span class="op" id="2597115">:=</span>&nbsp;<span class="ident" id="2597118"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2597125">.</span><span class="ident" id="2597126">ParseNetlinkRouteAttr</span><span class="op" id="2597147">(</span><span class="op" id="2597148">&amp;</span><span class="ident" id="2597149"><a href="/net/interface_linux.go.html#2596877">m</a></span><span class="op" id="2597150">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2597156">if</span>&nbsp;<span class="ident" id="2597159"><a href="/net/interface_linux.go.html#2597111">err</a></span>&nbsp;<span class="op" id="2597163">!=</span>&nbsp;<span class="ident" id="2597166">nil</span>&nbsp;<span class="op" id="2597170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2597177">return</span>&nbsp;<span class="ident" id="2597184">nil</span><span class="op" id="2597187">,</span>&nbsp;<span class="ident" id="2597189"><a href="/net/interface_linux.go.html#2596339">os</a></span><span class="op" id="2597191">.</span><span class="ident" id="2597192">NewSyscallError</span><span class="op" id="2597207">(</span><span class="string" id="2597208">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="2597227">,</span>&nbsp;<span class="ident" id="2597229"><a href="/net/interface_linux.go.html#2597111">err</a></span><span class="op" id="2597232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2597238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597244"><a href="/net/interface_linux.go.html#2596847">ift</a></span>&nbsp;<span class="op" id="2597248">=</span>&nbsp;<span class="builtinfunc" id="2597250">append</span><span class="op" id="2597256">(</span><span class="ident" id="2597257"><a href="/net/interface_linux.go.html#2596847">ift</a></span><span class="op" id="2597260">,</span>&nbsp;<span class="op" id="2597262">*</span><span class="ident" id="2597263"><a href="/net/interface_linux.go.html#2597783">newLink</a></span><span class="op" id="2597270">(</span><span class="ident" id="2597271"><a href="/net/interface_linux.go.html#2596992">ifim</a></span><span class="op" id="2597275">,</span>&nbsp;<span class="ident" id="2597277"><a href="/net/interface_linux.go.html#2597104">attrs</a></span><span class="op" id="2597282">)</span><span class="op" id="2597283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2597289">if</span>&nbsp;<span class="ident" id="2597292"><a href="/net/interface_linux.go.html#2596537">ifindex</a></span>&nbsp;<span class="op" id="2597300">==</span>&nbsp;<span class="builtintype" id="2597303">int</span><span class="op" id="2597306">(</span><span class="ident" id="2597307"><a href="/net/interface_linux.go.html#2596992">ifim</a></span><span class="op" id="2597311">.</span><span class="ident" id="2597312">Index</span><span class="op" id="2597317">)</span>&nbsp;<span class="op" id="2597319">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2597326">break</span>&nbsp;<span class="ident" id="2597332">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2597341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2597346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2597350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2597353">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2597356">return</span>&nbsp;<span class="ident" id="2597363"><a href="/net/interface_linux.go.html#2596847">ift</a></span><span class="op" id="2597366">,</span>&nbsp;<span class="ident" id="2597368">nil</span><br>
<span class="lineno"></span><span class="op" id="2597372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2597375">const</span>&nbsp;<span class="op" id="2597381">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2597384">//&nbsp;See&nbsp;linux/if_arp.h.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2597408">//&nbsp;Note&nbsp;that&nbsp;Linux&nbsp;doesn&#39;t&nbsp;support&nbsp;IPv4&nbsp;over&nbsp;IPv6&nbsp;tunneling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597470">sysARPHardwareIPv4IPv4</span>&nbsp;<span class="op" id="2597493">=</span>&nbsp;<span class="num" id="2597495">768</span>&nbsp;<span class="comment" id="2597499">//&nbsp;IPv4&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597528">sysARPHardwareIPv6IPv6</span>&nbsp;<span class="op" id="2597551">=</span>&nbsp;<span class="num" id="2597553">769</span>&nbsp;<span class="comment" id="2597557">//&nbsp;IPv6&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597586">sysARPHardwareIPv6IPv4</span>&nbsp;<span class="op" id="2597609">=</span>&nbsp;<span class="num" id="2597611">776</span>&nbsp;<span class="comment" id="2597615">//&nbsp;IPv6&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597644">sysARPHardwareGREIPv4</span>&nbsp;&nbsp;<span class="op" id="2597667">=</span>&nbsp;<span class="num" id="2597669">778</span>&nbsp;<span class="comment" id="2597673">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597710">sysARPHardwareGREIPv6</span>&nbsp;&nbsp;<span class="op" id="2597733">=</span>&nbsp;<span class="num" id="2597735">823</span>&nbsp;<span class="comment" id="2597739">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span><span class="op" id="2597775">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2597778">func</span>&nbsp;<span class="ident" id="2597783">newLink</span><span class="op" id="2597790">(</span><span class="ident" id="2597791">ifim</span>&nbsp;<span class="op" id="2597796">*</span><span class="ident" id="2597797"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2597804">.</span><span class="ident" id="2597805">IfInfomsg</span><span class="op" id="2597814">,</span>&nbsp;<span class="ident" id="2597816">attrs</span>&nbsp;<span class="op" id="2597822">[</span><span class="op" id="2597823">]</span><span class="ident" id="2597824"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2597831">.</span><span class="ident" id="2597832">NetlinkRouteAttr</span><span class="op" id="2597848">)</span>&nbsp;<span class="op" id="2597850">*</span><span class="ident" id="2597851"><a href="/net/interface.go.html#2593524">Interface</a></span>&nbsp;<span class="op" id="2597861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2597864">ifi</span>&nbsp;<span class="op" id="2597868">:=</span>&nbsp;<span class="op" id="2597871">&amp;</span><span class="ident" id="2597872"><a href="/net/interface.go.html#2593524">Interface</a></span><span class="op" id="2597881">{</span><span class="ident" id="2597882">Index</span><span class="op" id="2597887">:</span>&nbsp;<span class="builtintype" id="2597889">int</span><span class="op" id="2597892">(</span><span class="ident" id="2597893"><a href="/net/interface_linux.go.html#2597791">ifim</a></span><span class="op" id="2597897">.</span><span class="ident" id="2597898">Index</span><span class="op" id="2597903">)</span><span class="op" id="2597904">,</span>&nbsp;<span class="ident" id="2597906">Flags</span><span class="op" id="2597911">:</span>&nbsp;<span class="ident" id="2597913"><a href="/net/interface_linux.go.html#2598774">linkFlags</a></span><span class="op" id="2597922">(</span><span class="ident" id="2597923"><a href="/net/interface_linux.go.html#2597791">ifim</a></span><span class="op" id="2597927">.</span><span class="ident" id="2597928">Flags</span><span class="op" id="2597933">)</span><span class="op" id="2597934">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2597937">for</span>&nbsp;<span class="ident" id="2597941">_</span><span class="op" id="2597942">,</span>&nbsp;<span class="ident" id="2597944">a</span>&nbsp;<span class="op" id="2597946">:=</span>&nbsp;<span class="keyword" id="2597949">range</span>&nbsp;<span class="ident" id="2597955"><a href="/net/interface_linux.go.html#2597816">attrs</a></span>&nbsp;<span class="op" id="2597961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2597965">switch</span>&nbsp;<span class="ident" id="2597972"><a href="/net/interface_linux.go.html#2597944">a</a></span><span class="op" id="2597973">.</span><span class="ident" id="2597974">Attr</span><span class="op" id="2597978">.</span><span class="ident" id="2597979">Type</span>&nbsp;<span class="op" id="2597984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2597988">case</span>&nbsp;<span class="ident" id="2597993"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2598000">.</span><span class="ident" id="2598001">IFLA_ADDRESS</span><span class="op" id="2598013">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2598018">//&nbsp;We&nbsp;never&nbsp;return&nbsp;any&nbsp;/32&nbsp;or&nbsp;/128&nbsp;IP&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2598067">//&nbsp;prefix&nbsp;on&nbsp;any&nbsp;IP&nbsp;tunnel&nbsp;interface&nbsp;as&nbsp;the</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2598114">//&nbsp;hardware&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598138">switch</span>&nbsp;<span class="builtinfunc" id="2598145">len</span><span class="op" id="2598148">(</span><span class="ident" id="2598149"><a href="/net/interface_linux.go.html#2597944">a</a></span><span class="op" id="2598150">.</span><span class="ident" id="2598151">Value</span><span class="op" id="2598156">)</span>&nbsp;<span class="op" id="2598158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598163">case</span>&nbsp;<span class="ident" id="2598168"><a href="/net/ip.go.html#2603910">IPv4len</a></span><span class="op" id="2598175">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598181">switch</span>&nbsp;<span class="ident" id="2598188"><a href="/net/interface_linux.go.html#2597791">ifim</a></span><span class="op" id="2598192">.</span><span class="ident" id="2598193">Type</span>&nbsp;<span class="op" id="2598198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598204">case</span>&nbsp;<span class="ident" id="2598209"><a href="/net/interface_linux.go.html#2597470">sysARPHardwareIPv4IPv4</a></span><span class="op" id="2598231">,</span>&nbsp;<span class="ident" id="2598233"><a href="/net/interface_linux.go.html#2597644">sysARPHardwareGREIPv4</a></span><span class="op" id="2598254">,</span>&nbsp;<span class="ident" id="2598256"><a href="/net/interface_linux.go.html#2597586">sysARPHardwareIPv6IPv4</a></span><span class="op" id="2598278">:</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598285">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2598298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598303">case</span>&nbsp;<span class="ident" id="2598308"><a href="/net/ip.go.html#2603923">IPv6len</a></span><span class="op" id="2598315">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598321">switch</span>&nbsp;<span class="ident" id="2598328"><a href="/net/interface_linux.go.html#2597791">ifim</a></span><span class="op" id="2598332">.</span><span class="ident" id="2598333">Type</span>&nbsp;<span class="op" id="2598338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598344">case</span>&nbsp;<span class="ident" id="2598349"><a href="/net/interface_linux.go.html#2597528">sysARPHardwareIPv6IPv6</a></span><span class="op" id="2598371">,</span>&nbsp;<span class="ident" id="2598373"><a href="/net/interface_linux.go.html#2597710">sysARPHardwareGREIPv6</a></span><span class="op" id="2598394">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598401">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2598414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2598419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598424">var</span>&nbsp;<span class="ident" id="2598428">nonzero</span>&nbsp;<span class="builtintype" id="2598436">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598444">for</span>&nbsp;<span class="ident" id="2598448">_</span><span class="op" id="2598449">,</span>&nbsp;<span class="ident" id="2598451">b</span>&nbsp;<span class="op" id="2598453">:=</span>&nbsp;<span class="keyword" id="2598456">range</span>&nbsp;<span class="ident" id="2598462"><a href="/net/interface_linux.go.html#2597944">a</a></span><span class="op" id="2598463">.</span><span class="ident" id="2598464">Value</span>&nbsp;<span class="op" id="2598470">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598476">if</span>&nbsp;<span class="ident" id="2598479"><a href="/net/interface_linux.go.html#2598451">b</a></span>&nbsp;<span class="op" id="2598481">!=</span>&nbsp;<span class="num" id="2598484">0</span>&nbsp;<span class="op" id="2598486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598493"><a href="/net/interface_linux.go.html#2598428">nonzero</a></span>&nbsp;<span class="op" id="2598501">=</span>&nbsp;<span class="ident" id="2598503">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598513">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2598523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2598528">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598533">if</span>&nbsp;<span class="ident" id="2598536"><a href="/net/interface_linux.go.html#2598428">nonzero</a></span>&nbsp;<span class="op" id="2598544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598550"><a href="/net/interface_linux.go.html#2597864">ifi</a></span><span class="op" id="2598553">.</span><span class="ident" id="2598554">HardwareAddr</span>&nbsp;<span class="op" id="2598567">=</span>&nbsp;<span class="ident" id="2598569"><a href="/net/interface_linux.go.html#2597944">a</a></span><span class="op" id="2598570">.</span><span class="ident" id="2598571">Value</span><span class="op" id="2598576">[</span><span class="op" id="2598577">:</span><span class="op" id="2598578">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2598583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598587">case</span>&nbsp;<span class="ident" id="2598592"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2598599">.</span><span class="ident" id="2598600">IFLA_IFNAME</span><span class="op" id="2598611">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598616"><a href="/net/interface_linux.go.html#2597864">ifi</a></span><span class="op" id="2598619">.</span><span class="ident" id="2598620">Name</span>&nbsp;<span class="op" id="2598625">=</span>&nbsp;<span class="builtintype" id="2598627">string</span><span class="op" id="2598633">(</span><span class="ident" id="2598634"><a href="/net/interface_linux.go.html#2597944">a</a></span><span class="op" id="2598635">.</span><span class="ident" id="2598636">Value</span><span class="op" id="2598641">[</span><span class="op" id="2598642">:</span><span class="builtinfunc" id="2598643">len</span><span class="op" id="2598646">(</span><span class="ident" id="2598647"><a href="/net/interface_linux.go.html#2597944">a</a></span><span class="op" id="2598648">.</span><span class="ident" id="2598649">Value</span><span class="op" id="2598654">)</span><span class="op" id="2598655">-</span><span class="num" id="2598656">1</span><span class="op" id="2598657">]</span><span class="op" id="2598658">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598662">case</span>&nbsp;<span class="ident" id="2598667"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2598674">.</span><span class="ident" id="2598675">IFLA_MTU</span><span class="op" id="2598683">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598688"><a href="/net/interface_linux.go.html#2597864">ifi</a></span><span class="op" id="2598691">.</span><span class="ident" id="2598692">MTU</span>&nbsp;<span class="op" id="2598696">=</span>&nbsp;<span class="builtintype" id="2598698">int</span><span class="op" id="2598701">(</span><span class="op" id="2598702">*</span><span class="op" id="2598703">(</span><span class="op" id="2598704">*</span><span class="builtintype" id="2598705">uint32</span><span class="op" id="2598711">)</span><span class="op" id="2598712">(</span><span class="ident" id="2598713"><a href="/net/interface_linux.go.html#2596356">unsafe</a></span><span class="op" id="2598719">.</span><span class="ident" id="2598720">Pointer</span><span class="op" id="2598727">(</span><span class="op" id="2598728">&amp;</span><span class="ident" id="2598729"><a href="/net/interface_linux.go.html#2597944">a</a></span><span class="op" id="2598730">.</span><span class="ident" id="2598731">Value</span><span class="op" id="2598736">[</span><span class="op" id="2598737">:</span><span class="num" id="2598738">4</span><span class="op" id="2598739">]</span><span class="op" id="2598740">[</span><span class="num" id="2598741">0</span><span class="op" id="2598742">]</span><span class="op" id="2598743">)</span><span class="op" id="2598744">)</span><span class="op" id="2598745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2598749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2598752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598755">return</span>&nbsp;<span class="ident" id="2598762"><a href="/net/interface_linux.go.html#2597864">ifi</a></span><br>
<span class="lineno">95</span><span class="op" id="2598766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2598769">func</span>&nbsp;<span class="ident" id="2598774">linkFlags</span><span class="op" id="2598783">(</span><span class="ident" id="2598784">rawFlags</span>&nbsp;<span class="builtintype" id="2598793">uint32</span><span class="op" id="2598799">)</span>&nbsp;<span class="ident" id="2598801"><a href="/net/interface.go.html#2593892">Flags</a></span>&nbsp;<span class="op" id="2598807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598810">var</span>&nbsp;<span class="ident" id="2598814">f</span>&nbsp;<span class="ident" id="2598816"><a href="/net/interface.go.html#2593892">Flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598823">if</span>&nbsp;<span class="ident" id="2598826"><a href="/net/interface_linux.go.html#2598784">rawFlags</a></span><span class="op" id="2598834">&amp;</span><span class="ident" id="2598835"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2598842">.</span><span class="ident" id="2598843">IFF_UP</span>&nbsp;<span class="op" id="2598850">!=</span>&nbsp;<span class="num" id="2598853">0</span>&nbsp;<span class="op" id="2598855">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598859"><a href="/net/interface_linux.go.html#2598814">f</a></span>&nbsp;<span class="op" id="2598861">|=</span>&nbsp;<span class="ident" id="2598864"><a href="/net/interface.go.html#2593913">FlagUp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2598872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598875">if</span>&nbsp;<span class="ident" id="2598878"><a href="/net/interface_linux.go.html#2598784">rawFlags</a></span><span class="op" id="2598886">&amp;</span><span class="ident" id="2598887"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2598894">.</span><span class="ident" id="2598895">IFF_BROADCAST</span>&nbsp;<span class="op" id="2598909">!=</span>&nbsp;<span class="num" id="2598912">0</span>&nbsp;<span class="op" id="2598914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598918"><a href="/net/interface_linux.go.html#2598814">f</a></span>&nbsp;<span class="op" id="2598920">|=</span>&nbsp;<span class="ident" id="2598923"><a href="/net/interface.go.html#2593968">FlagBroadcast</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2598938">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2598941">if</span>&nbsp;<span class="ident" id="2598944"><a href="/net/interface_linux.go.html#2598784">rawFlags</a></span><span class="op" id="2598952">&amp;</span><span class="ident" id="2598953"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2598960">.</span><span class="ident" id="2598961">IFF_LOOPBACK</span>&nbsp;<span class="op" id="2598974">!=</span>&nbsp;<span class="num" id="2598977">0</span>&nbsp;<span class="op" id="2598979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2598983"><a href="/net/interface_linux.go.html#2598814">f</a></span>&nbsp;<span class="op" id="2598985">|=</span>&nbsp;<span class="ident" id="2598988"><a href="/net/interface.go.html#2594054">FlagLoopback</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2599002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599005">if</span>&nbsp;<span class="ident" id="2599008"><a href="/net/interface_linux.go.html#2598784">rawFlags</a></span><span class="op" id="2599016">&amp;</span><span class="ident" id="2599017"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2599024">.</span><span class="ident" id="2599025">IFF_POINTOPOINT</span>&nbsp;<span class="op" id="2599041">!=</span>&nbsp;<span class="num" id="2599044">0</span>&nbsp;<span class="op" id="2599046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599050"><a href="/net/interface_linux.go.html#2598814">f</a></span>&nbsp;<span class="op" id="2599052">|=</span>&nbsp;<span class="ident" id="2599055"><a href="/net/interface.go.html#2594127">FlagPointToPoint</a></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2599073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599076">if</span>&nbsp;<span class="ident" id="2599079"><a href="/net/interface_linux.go.html#2598784">rawFlags</a></span><span class="op" id="2599087">&amp;</span><span class="ident" id="2599088"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2599095">.</span><span class="ident" id="2599096">IFF_MULTICAST</span>&nbsp;<span class="op" id="2599110">!=</span>&nbsp;<span class="num" id="2599113">0</span>&nbsp;<span class="op" id="2599115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599119"><a href="/net/interface_linux.go.html#2598814">f</a></span>&nbsp;<span class="op" id="2599121">|=</span>&nbsp;<span class="ident" id="2599124"><a href="/net/interface.go.html#2594209">FlagMulticast</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2599139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599142">return</span>&nbsp;<span class="ident" id="2599149"><a href="/net/interface_linux.go.html#2598814">f</a></span><br>
<span class="lineno">115</span><span class="op" id="2599151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2599154">//&nbsp;If&nbsp;the&nbsp;ifi&nbsp;is&nbsp;nil,&nbsp;interfaceAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2599221">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno"></span><span class="comment" id="2599291">//&nbsp;interface.</span><br>
<span class="lineno">120</span><span class="keyword" id="2599305">func</span>&nbsp;<span class="ident" id="2599310">interfaceAddrTable</span><span class="op" id="2599328">(</span><span class="ident" id="2599329">ifi</span>&nbsp;<span class="op" id="2599333">*</span><span class="ident" id="2599334"><a href="/net/interface.go.html#2593524">Interface</a></span><span class="op" id="2599343">)</span>&nbsp;<span class="op" id="2599345">(</span><span class="op" id="2599346">[</span><span class="op" id="2599347">]</span><span class="ident" id="2599348"><a href="/net/net.go.html#2652238">Addr</a></span><span class="op" id="2599352">,</span>&nbsp;<span class="builtintype" id="2599354">error</span><span class="op" id="2599359">)</span>&nbsp;<span class="op" id="2599361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599364">tab</span><span class="op" id="2599367">,</span>&nbsp;<span class="ident" id="2599369">err</span>&nbsp;<span class="op" id="2599373">:=</span>&nbsp;<span class="ident" id="2599376"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2599383">.</span><span class="ident" id="2599384">NetlinkRIB</span><span class="op" id="2599394">(</span><span class="ident" id="2599395"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2599402">.</span><span class="ident" id="2599403">RTM_GETADDR</span><span class="op" id="2599414">,</span>&nbsp;<span class="ident" id="2599416"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2599423">.</span><span class="ident" id="2599424">AF_UNSPEC</span><span class="op" id="2599433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599436">if</span>&nbsp;<span class="ident" id="2599439"><a href="/net/interface_linux.go.html#2599369">err</a></span>&nbsp;<span class="op" id="2599443">!=</span>&nbsp;<span class="ident" id="2599446">nil</span>&nbsp;<span class="op" id="2599450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599454">return</span>&nbsp;<span class="ident" id="2599461">nil</span><span class="op" id="2599464">,</span>&nbsp;<span class="ident" id="2599466"><a href="/net/interface_linux.go.html#2596339">os</a></span><span class="op" id="2599468">.</span><span class="ident" id="2599469">NewSyscallError</span><span class="op" id="2599484">(</span><span class="string" id="2599485">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="2599498">,</span>&nbsp;<span class="ident" id="2599500"><a href="/net/interface_linux.go.html#2599369">err</a></span><span class="op" id="2599503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2599506">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599509">msgs</span><span class="op" id="2599513">,</span>&nbsp;<span class="ident" id="2599515"><a href="/net/interface_linux.go.html#2599369">err</a></span>&nbsp;<span class="op" id="2599519">:=</span>&nbsp;<span class="ident" id="2599522"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2599529">.</span><span class="ident" id="2599530">ParseNetlinkMessage</span><span class="op" id="2599549">(</span><span class="ident" id="2599550"><a href="/net/interface_linux.go.html#2599364">tab</a></span><span class="op" id="2599553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599556">if</span>&nbsp;<span class="ident" id="2599559"><a href="/net/interface_linux.go.html#2599369">err</a></span>&nbsp;<span class="op" id="2599563">!=</span>&nbsp;<span class="ident" id="2599566">nil</span>&nbsp;<span class="op" id="2599570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599574">return</span>&nbsp;<span class="ident" id="2599581">nil</span><span class="op" id="2599584">,</span>&nbsp;<span class="ident" id="2599586"><a href="/net/interface_linux.go.html#2596339">os</a></span><span class="op" id="2599588">.</span><span class="ident" id="2599589">NewSyscallError</span><span class="op" id="2599604">(</span><span class="string" id="2599605">&#34;netlink&nbsp;message&#34;</span><span class="op" id="2599622">,</span>&nbsp;<span class="ident" id="2599624"><a href="/net/interface_linux.go.html#2599369">err</a></span><span class="op" id="2599627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2599630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599633">var</span>&nbsp;<span class="ident" id="2599637">ift</span>&nbsp;<span class="op" id="2599641">[</span><span class="op" id="2599642">]</span><span class="ident" id="2599643"><a href="/net/interface.go.html#2593524">Interface</a></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599654">if</span>&nbsp;<span class="ident" id="2599657"><a href="/net/interface_linux.go.html#2599329">ifi</a></span>&nbsp;<span class="op" id="2599661">==</span>&nbsp;<span class="ident" id="2599664">nil</span>&nbsp;<span class="op" id="2599668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599672">var</span>&nbsp;<span class="ident" id="2599676">err</span>&nbsp;<span class="builtintype" id="2599680">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599688"><a href="/net/interface_linux.go.html#2599637">ift</a></span><span class="op" id="2599691">,</span>&nbsp;<span class="ident" id="2599693"><a href="/net/interface_linux.go.html#2599676">err</a></span>&nbsp;<span class="op" id="2599697">=</span>&nbsp;<span class="ident" id="2599699"><a href="/net/interface_linux.go.html#2596522">interfaceTable</a></span><span class="op" id="2599713">(</span><span class="num" id="2599714">0</span><span class="op" id="2599715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599719">if</span>&nbsp;<span class="ident" id="2599722"><a href="/net/interface_linux.go.html#2599676">err</a></span>&nbsp;<span class="op" id="2599726">!=</span>&nbsp;<span class="ident" id="2599729">nil</span>&nbsp;<span class="op" id="2599733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599738">return</span>&nbsp;<span class="ident" id="2599745">nil</span><span class="op" id="2599748">,</span>&nbsp;<span class="ident" id="2599750"><a href="/net/interface_linux.go.html#2599676">err</a></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2599756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2599759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2599762">ifat</span><span class="op" id="2599766">,</span>&nbsp;<span class="ident" id="2599768"><a href="/net/interface_linux.go.html#2599369">err</a></span>&nbsp;<span class="op" id="2599772">:=</span>&nbsp;<span class="ident" id="2599775"><a href="/net/interface_linux.go.html#2599865">addrTable</a></span><span class="op" id="2599784">(</span><span class="ident" id="2599785"><a href="/net/interface_linux.go.html#2599637">ift</a></span><span class="op" id="2599788">,</span>&nbsp;<span class="ident" id="2599790"><a href="/net/interface_linux.go.html#2599329">ifi</a></span><span class="op" id="2599793">,</span>&nbsp;<span class="ident" id="2599795"><a href="/net/interface_linux.go.html#2599509">msgs</a></span><span class="op" id="2599799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599802">if</span>&nbsp;<span class="ident" id="2599805"><a href="/net/interface_linux.go.html#2599369">err</a></span>&nbsp;<span class="op" id="2599809">!=</span>&nbsp;<span class="ident" id="2599812">nil</span>&nbsp;<span class="op" id="2599816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599820">return</span>&nbsp;<span class="ident" id="2599827">nil</span><span class="op" id="2599830">,</span>&nbsp;<span class="ident" id="2599832"><a href="/net/interface_linux.go.html#2599369">err</a></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2599837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599840">return</span>&nbsp;<span class="ident" id="2599847"><a href="/net/interface_linux.go.html#2599762">ifat</a></span><span class="op" id="2599851">,</span>&nbsp;<span class="ident" id="2599853">nil</span><br>
<span class="lineno"></span><span class="op" id="2599857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2599860">func</span>&nbsp;<span class="ident" id="2599865">addrTable</span><span class="op" id="2599874">(</span><span class="ident" id="2599875">ift</span>&nbsp;<span class="op" id="2599879">[</span><span class="op" id="2599880">]</span><span class="ident" id="2599881"><a href="/net/interface.go.html#2593524">Interface</a></span><span class="op" id="2599890">,</span>&nbsp;<span class="ident" id="2599892">ifi</span>&nbsp;<span class="op" id="2599896">*</span><span class="ident" id="2599897"><a href="/net/interface.go.html#2593524">Interface</a></span><span class="op" id="2599906">,</span>&nbsp;<span class="ident" id="2599908">msgs</span>&nbsp;<span class="op" id="2599913">[</span><span class="op" id="2599914">]</span><span class="ident" id="2599915"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2599922">.</span><span class="ident" id="2599923">NetlinkMessage</span><span class="op" id="2599937">)</span>&nbsp;<span class="op" id="2599939">(</span><span class="op" id="2599940">[</span><span class="op" id="2599941">]</span><span class="ident" id="2599942"><a href="/net/net.go.html#2652238">Addr</a></span><span class="op" id="2599946">,</span>&nbsp;<span class="builtintype" id="2599948">error</span><span class="op" id="2599953">)</span>&nbsp;<span class="op" id="2599955">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599958">var</span>&nbsp;<span class="ident" id="2599962">ifat</span>&nbsp;<span class="op" id="2599967">[</span><span class="op" id="2599968">]</span><span class="ident" id="2599969"><a href="/net/net.go.html#2652238">Addr</a></span><br>
<span class="lineno"></span><span class="ident" id="2599974">loop</span><span class="op" id="2599978">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2599981">for</span>&nbsp;<span class="ident" id="2599985">_</span><span class="op" id="2599986">,</span>&nbsp;<span class="ident" id="2599988">m</span>&nbsp;<span class="op" id="2599990">:=</span>&nbsp;<span class="keyword" id="2599993">range</span>&nbsp;<span class="ident" id="2599999"><a href="/net/interface_linux.go.html#2599908">msgs</a></span>&nbsp;<span class="op" id="2600004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600008">switch</span>&nbsp;<span class="ident" id="2600015"><a href="/net/interface_linux.go.html#2599988">m</a></span><span class="op" id="2600016">.</span><span class="ident" id="2600017">Header</span><span class="op" id="2600023">.</span><span class="ident" id="2600024">Type</span>&nbsp;<span class="op" id="2600029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600033">case</span>&nbsp;<span class="ident" id="2600038"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2600045">.</span><span class="ident" id="2600046">NLMSG_DONE</span><span class="op" id="2600056">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600061">break</span>&nbsp;<span class="ident" id="2600067">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600074">case</span>&nbsp;<span class="ident" id="2600079"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2600086">.</span><span class="ident" id="2600087">RTM_NEWADDR</span><span class="op" id="2600098">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600103">ifam</span>&nbsp;<span class="op" id="2600108">:=</span>&nbsp;<span class="op" id="2600111">(</span><span class="op" id="2600112">*</span><span class="ident" id="2600113"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2600120">.</span><span class="ident" id="2600121">IfAddrmsg</span><span class="op" id="2600130">)</span><span class="op" id="2600131">(</span><span class="ident" id="2600132"><a href="/net/interface_linux.go.html#2596356">unsafe</a></span><span class="op" id="2600138">.</span><span class="ident" id="2600139">Pointer</span><span class="op" id="2600146">(</span><span class="op" id="2600147">&amp;</span><span class="ident" id="2600148"><a href="/net/interface_linux.go.html#2599988">m</a></span><span class="op" id="2600149">.</span><span class="ident" id="2600150">Data</span><span class="op" id="2600154">[</span><span class="num" id="2600155">0</span><span class="op" id="2600156">]</span><span class="op" id="2600157">)</span><span class="op" id="2600158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600163">if</span>&nbsp;<span class="builtinfunc" id="2600166">len</span><span class="op" id="2600169">(</span><span class="ident" id="2600170"><a href="/net/interface_linux.go.html#2599875">ift</a></span><span class="op" id="2600173">)</span>&nbsp;<span class="op" id="2600175">!=</span>&nbsp;<span class="num" id="2600178">0</span>&nbsp;<span class="op" id="2600180">||</span>&nbsp;<span class="ident" id="2600183"><a href="/net/interface_linux.go.html#2599892">ifi</a></span><span class="op" id="2600186">.</span><span class="ident" id="2600187">Index</span>&nbsp;<span class="op" id="2600193">==</span>&nbsp;<span class="builtintype" id="2600196">int</span><span class="op" id="2600199">(</span><span class="ident" id="2600200"><a href="/net/interface_linux.go.html#2600103">ifam</a></span><span class="op" id="2600204">.</span><span class="ident" id="2600205">Index</span><span class="op" id="2600210">)</span>&nbsp;<span class="op" id="2600212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600218">if</span>&nbsp;<span class="builtinfunc" id="2600221">len</span><span class="op" id="2600224">(</span><span class="ident" id="2600225"><a href="/net/interface_linux.go.html#2599875">ift</a></span><span class="op" id="2600228">)</span>&nbsp;<span class="op" id="2600230">!=</span>&nbsp;<span class="num" id="2600233">0</span>&nbsp;<span class="op" id="2600235">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600242">var</span>&nbsp;<span class="ident" id="2600246">err</span>&nbsp;<span class="builtintype" id="2600250">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600261"><a href="/net/interface_linux.go.html#2599892">ifi</a></span><span class="op" id="2600264">,</span>&nbsp;<span class="ident" id="2600266"><a href="/net/interface_linux.go.html#2600246">err</a></span>&nbsp;<span class="op" id="2600270">=</span>&nbsp;<span class="ident" id="2600272"><a href="/net/interface.go.html#2595617">interfaceByIndex</a></span><span class="op" id="2600288">(</span><span class="ident" id="2600289"><a href="/net/interface_linux.go.html#2599875">ift</a></span><span class="op" id="2600292">,</span>&nbsp;<span class="builtintype" id="2600294">int</span><span class="op" id="2600297">(</span><span class="ident" id="2600298"><a href="/net/interface_linux.go.html#2600103">ifam</a></span><span class="op" id="2600302">.</span><span class="ident" id="2600303">Index</span><span class="op" id="2600308">)</span><span class="op" id="2600309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600316">if</span>&nbsp;<span class="ident" id="2600319"><a href="/net/interface_linux.go.html#2600246">err</a></span>&nbsp;<span class="op" id="2600323">!=</span>&nbsp;<span class="ident" id="2600326">nil</span>&nbsp;<span class="op" id="2600330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600338">return</span>&nbsp;<span class="ident" id="2600345">nil</span><span class="op" id="2600348">,</span>&nbsp;<span class="ident" id="2600350"><a href="/net/interface_linux.go.html#2600246">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2600359">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2600365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600371">attrs</span><span class="op" id="2600376">,</span>&nbsp;<span class="ident" id="2600378">err</span>&nbsp;<span class="op" id="2600382">:=</span>&nbsp;<span class="ident" id="2600385"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2600392">.</span><span class="ident" id="2600393">ParseNetlinkRouteAttr</span><span class="op" id="2600414">(</span><span class="op" id="2600415">&amp;</span><span class="ident" id="2600416"><a href="/net/interface_linux.go.html#2599988">m</a></span><span class="op" id="2600417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600423">if</span>&nbsp;<span class="ident" id="2600426"><a href="/net/interface_linux.go.html#2600378">err</a></span>&nbsp;<span class="op" id="2600430">!=</span>&nbsp;<span class="ident" id="2600433">nil</span>&nbsp;<span class="op" id="2600437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600444">return</span>&nbsp;<span class="ident" id="2600451">nil</span><span class="op" id="2600454">,</span>&nbsp;<span class="ident" id="2600456"><a href="/net/interface_linux.go.html#2596339">os</a></span><span class="op" id="2600458">.</span><span class="ident" id="2600459">NewSyscallError</span><span class="op" id="2600474">(</span><span class="string" id="2600475">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="2600494">,</span>&nbsp;<span class="ident" id="2600496"><a href="/net/interface_linux.go.html#2600378">err</a></span><span class="op" id="2600499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2600505">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600511">ifa</span>&nbsp;<span class="op" id="2600515">:=</span>&nbsp;<span class="ident" id="2600518"><a href="/net/interface_linux.go.html#2600638">newAddr</a></span><span class="op" id="2600525">(</span><span class="ident" id="2600526"><a href="/net/interface_linux.go.html#2599892">ifi</a></span><span class="op" id="2600529">,</span>&nbsp;<span class="ident" id="2600531"><a href="/net/interface_linux.go.html#2600103">ifam</a></span><span class="op" id="2600535">,</span>&nbsp;<span class="ident" id="2600537"><a href="/net/interface_linux.go.html#2600371">attrs</a></span><span class="op" id="2600542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600548">if</span>&nbsp;<span class="ident" id="2600551"><a href="/net/interface_linux.go.html#2600511">ifa</a></span>&nbsp;<span class="op" id="2600555">!=</span>&nbsp;<span class="ident" id="2600558">nil</span>&nbsp;<span class="op" id="2600562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2600569"><a href="/net/interface_linux.go.html#2599962">ifat</a></span>&nbsp;<span class="op" id="2600574">=</span>&nbsp;<span class="builtinfunc" id="2600576">append</span><span class="op" id="2600582">(</span><span class="ident" id="2600583"><a href="/net/interface_linux.go.html#2599962">ifat</a></span><span class="op" id="2600587">,</span>&nbsp;<span class="ident" id="2600589"><a href="/net/interface_linux.go.html#2600511">ifa</a></span><span class="op" id="2600592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2600598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2600603">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2600607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2600610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600613">return</span>&nbsp;<span class="ident" id="2600620"><a href="/net/interface_linux.go.html#2599962">ifat</a></span><span class="op" id="2600624">,</span>&nbsp;<span class="ident" id="2600626">nil</span><br>
<span class="lineno"></span><span class="op" id="2600630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="2600633">func</span>&nbsp;<span class="ident" id="2600638">newAddr</span><span class="op" id="2600645">(</span><span class="ident" id="2600646">ifi</span>&nbsp;<span class="op" id="2600650">*</span><span class="ident" id="2600651"><a href="/net/interface.go.html#2593524">Interface</a></span><span class="op" id="2600660">,</span>&nbsp;<span class="ident" id="2600662">ifam</span>&nbsp;<span class="op" id="2600667">*</span><span class="ident" id="2600668"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2600675">.</span><span class="ident" id="2600676">IfAddrmsg</span><span class="op" id="2600685">,</span>&nbsp;<span class="ident" id="2600687">attrs</span>&nbsp;<span class="op" id="2600693">[</span><span class="op" id="2600694">]</span><span class="ident" id="2600695"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2600702">.</span><span class="ident" id="2600703">NetlinkRouteAttr</span><span class="op" id="2600719">)</span>&nbsp;<span class="ident" id="2600721"><a href="/net/net.go.html#2652238">Addr</a></span>&nbsp;<span class="op" id="2600726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600729">var</span>&nbsp;<span class="ident" id="2600733">ipPointToPoint</span>&nbsp;<span class="builtintype" id="2600748">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2600754">//&nbsp;Seems&nbsp;like&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;whether&nbsp;the&nbsp;IP&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2600815">//&nbsp;stack&nbsp;consists&nbsp;of&nbsp;IP&nbsp;point-to-point&nbsp;numbered&nbsp;or&nbsp;unnumbered</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2600878">//&nbsp;addressing&nbsp;over&nbsp;point-to-point&nbsp;link&nbsp;encapsulation.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600933">if</span>&nbsp;<span class="ident" id="2600936"><a href="/net/interface_linux.go.html#2600646">ifi</a></span><span class="op" id="2600939">.</span><span class="ident" id="2600940">Flags</span><span class="op" id="2600945">&amp;</span><span class="ident" id="2600946"><a href="/net/interface.go.html#2594127">FlagPointToPoint</a></span>&nbsp;<span class="op" id="2600963">!=</span>&nbsp;<span class="num" id="2600966">0</span>&nbsp;<span class="op" id="2600968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2600972">for</span>&nbsp;<span class="ident" id="2600976">_</span><span class="op" id="2600977">,</span>&nbsp;<span class="ident" id="2600979">a</span>&nbsp;<span class="op" id="2600981">:=</span>&nbsp;<span class="keyword" id="2600984">range</span>&nbsp;<span class="ident" id="2600990"><a href="/net/interface_linux.go.html#2600687">attrs</a></span>&nbsp;<span class="op" id="2600996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601001">if</span>&nbsp;<span class="ident" id="2601004"><a href="/net/interface_linux.go.html#2600979">a</a></span><span class="op" id="2601005">.</span><span class="ident" id="2601006">Attr</span><span class="op" id="2601010">.</span><span class="ident" id="2601011">Type</span>&nbsp;<span class="op" id="2601016">==</span>&nbsp;<span class="ident" id="2601019"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2601026">.</span><span class="ident" id="2601027">IFA_LOCAL</span>&nbsp;<span class="op" id="2601037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2601043"><a href="/net/interface_linux.go.html#2600733">ipPointToPoint</a></span>&nbsp;<span class="op" id="2601058">=</span>&nbsp;<span class="ident" id="2601060">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601069">break</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2601078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2601082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2601085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601088">for</span>&nbsp;<span class="ident" id="2601092">_</span><span class="op" id="2601093">,</span>&nbsp;<span class="ident" id="2601095">a</span>&nbsp;<span class="op" id="2601097">:=</span>&nbsp;<span class="keyword" id="2601100">range</span>&nbsp;<span class="ident" id="2601106"><a href="/net/interface_linux.go.html#2600687">attrs</a></span>&nbsp;<span class="op" id="2601112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601116">if</span>&nbsp;<span class="ident" id="2601119"><a href="/net/interface_linux.go.html#2600733">ipPointToPoint</a></span>&nbsp;<span class="op" id="2601134">&amp;&amp;</span>&nbsp;<span class="ident" id="2601137"><a href="/net/interface_linux.go.html#2601095">a</a></span><span class="op" id="2601138">.</span><span class="ident" id="2601139">Attr</span><span class="op" id="2601143">.</span><span class="ident" id="2601144">Type</span>&nbsp;<span class="op" id="2601149">==</span>&nbsp;<span class="ident" id="2601152"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2601159">.</span><span class="ident" id="2601160">IFA_ADDRESS</span>&nbsp;<span class="op" id="2601172">||</span>&nbsp;<span class="op" id="2601175">!</span><span class="ident" id="2601176"><a href="/net/interface_linux.go.html#2600733">ipPointToPoint</a></span>&nbsp;<span class="op" id="2601191">&amp;&amp;</span>&nbsp;<span class="ident" id="2601194"><a href="/net/interface_linux.go.html#2601095">a</a></span><span class="op" id="2601195">.</span><span class="ident" id="2601196">Attr</span><span class="op" id="2601200">.</span><span class="ident" id="2601201">Type</span>&nbsp;<span class="op" id="2601206">==</span>&nbsp;<span class="ident" id="2601209"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2601216">.</span><span class="ident" id="2601217">IFA_LOCAL</span>&nbsp;<span class="op" id="2601227">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601232">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2601243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601247">switch</span>&nbsp;<span class="ident" id="2601254"><a href="/net/interface_linux.go.html#2600662">ifam</a></span><span class="op" id="2601258">.</span><span class="ident" id="2601259">Family</span>&nbsp;<span class="op" id="2601266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601270">case</span>&nbsp;<span class="ident" id="2601275"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2601282">.</span><span class="ident" id="2601283">AF_INET</span><span class="op" id="2601290">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601295">return</span>&nbsp;<span class="op" id="2601302">&amp;</span><span class="ident" id="2601303"><a href="/net/ip.go.html#2604436">IPNet</a></span><span class="op" id="2601308">{</span><span class="ident" id="2601309">IP</span><span class="op" id="2601311">:</span>&nbsp;<span class="ident" id="2601313"><a href="/net/ip.go.html#2604600">IPv4</a></span><span class="op" id="2601317">(</span><span class="ident" id="2601318"><a href="/net/interface_linux.go.html#2601095">a</a></span><span class="op" id="2601319">.</span><span class="ident" id="2601320">Value</span><span class="op" id="2601325">[</span><span class="num" id="2601326">0</span><span class="op" id="2601327">]</span><span class="op" id="2601328">,</span>&nbsp;<span class="ident" id="2601330"><a href="/net/interface_linux.go.html#2601095">a</a></span><span class="op" id="2601331">.</span><span class="ident" id="2601332">Value</span><span class="op" id="2601337">[</span><span class="num" id="2601338">1</span><span class="op" id="2601339">]</span><span class="op" id="2601340">,</span>&nbsp;<span class="ident" id="2601342"><a href="/net/interface_linux.go.html#2601095">a</a></span><span class="op" id="2601343">.</span><span class="ident" id="2601344">Value</span><span class="op" id="2601349">[</span><span class="num" id="2601350">2</span><span class="op" id="2601351">]</span><span class="op" id="2601352">,</span>&nbsp;<span class="ident" id="2601354"><a href="/net/interface_linux.go.html#2601095">a</a></span><span class="op" id="2601355">.</span><span class="ident" id="2601356">Value</span><span class="op" id="2601361">[</span><span class="num" id="2601362">3</span><span class="op" id="2601363">]</span><span class="op" id="2601364">)</span><span class="op" id="2601365">,</span>&nbsp;<span class="ident" id="2601367">Mask</span><span class="op" id="2601371">:</span>&nbsp;<span class="ident" id="2601373"><a href="/net/ip.go.html#2605185">CIDRMask</a></span><span class="op" id="2601381">(</span><span class="builtintype" id="2601382">int</span><span class="op" id="2601385">(</span><span class="ident" id="2601386"><a href="/net/interface_linux.go.html#2600662">ifam</a></span><span class="op" id="2601390">.</span><span class="ident" id="2601391">Prefixlen</span><span class="op" id="2601400">)</span><span class="op" id="2601401">,</span>&nbsp;<span class="num" id="2601403">8</span><span class="op" id="2601404">*</span><span class="ident" id="2601405"><a href="/net/ip.go.html#2603910">IPv4len</a></span><span class="op" id="2601412">)</span><span class="op" id="2601413">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601417">case</span>&nbsp;<span class="ident" id="2601422"><a href="/net/interface_linux.go.html#2596345">syscall</a></span><span class="op" id="2601429">.</span><span class="ident" id="2601430">AF_INET6</span><span class="op" id="2601438">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2601443">ifa</span>&nbsp;<span class="op" id="2601447">:=</span>&nbsp;<span class="op" id="2601450">&amp;</span><span class="ident" id="2601451"><a href="/net/ip.go.html#2604436">IPNet</a></span><span class="op" id="2601456">{</span><span class="ident" id="2601457">IP</span><span class="op" id="2601459">:</span>&nbsp;<span class="builtinfunc" id="2601461">make</span><span class="op" id="2601465">(</span><span class="ident" id="2601466"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2601468">,</span>&nbsp;<span class="ident" id="2601470"><a href="/net/ip.go.html#2603923">IPv6len</a></span><span class="op" id="2601477">)</span><span class="op" id="2601478">,</span>&nbsp;<span class="ident" id="2601480">Mask</span><span class="op" id="2601484">:</span>&nbsp;<span class="ident" id="2601486"><a href="/net/ip.go.html#2605185">CIDRMask</a></span><span class="op" id="2601494">(</span><span class="builtintype" id="2601495">int</span><span class="op" id="2601498">(</span><span class="ident" id="2601499"><a href="/net/interface_linux.go.html#2600662">ifam</a></span><span class="op" id="2601503">.</span><span class="ident" id="2601504">Prefixlen</span><span class="op" id="2601513">)</span><span class="op" id="2601514">,</span>&nbsp;<span class="num" id="2601516">8</span><span class="op" id="2601517">*</span><span class="ident" id="2601518"><a href="/net/ip.go.html#2603923">IPv6len</a></span><span class="op" id="2601525">)</span><span class="op" id="2601526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2601531">copy</span><span class="op" id="2601535">(</span><span class="ident" id="2601536"><a href="/net/interface_linux.go.html#2601443">ifa</a></span><span class="op" id="2601539">.</span><span class="ident" id="2601540">IP</span><span class="op" id="2601542">,</span>&nbsp;<span class="ident" id="2601544"><a href="/net/interface_linux.go.html#2601095">a</a></span><span class="op" id="2601545">.</span><span class="ident" id="2601546">Value</span><span class="op" id="2601551">[</span><span class="op" id="2601552">:</span><span class="op" id="2601553">]</span><span class="op" id="2601554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601559">return</span>&nbsp;<span class="ident" id="2601566"><a href="/net/interface_linux.go.html#2601443">ifa</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2601572">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2601575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601578">return</span>&nbsp;<span class="ident" id="2601585">nil</span><br>
<span class="lineno"></span><span class="op" id="2601589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2601592">//&nbsp;interfaceMulticastAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno">205</span><span class="comment" id="2601656">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2601670">func</span>&nbsp;<span class="ident" id="2601675">interfaceMulticastAddrTable</span><span class="op" id="2601702">(</span><span class="ident" id="2601703">ifi</span>&nbsp;<span class="op" id="2601707">*</span><span class="ident" id="2601708"><a href="/net/interface.go.html#2593524">Interface</a></span><span class="op" id="2601717">)</span>&nbsp;<span class="op" id="2601719">(</span><span class="op" id="2601720">[</span><span class="op" id="2601721">]</span><span class="ident" id="2601722"><a href="/net/net.go.html#2652238">Addr</a></span><span class="op" id="2601726">,</span>&nbsp;<span class="builtintype" id="2601728">error</span><span class="op" id="2601733">)</span>&nbsp;<span class="op" id="2601735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2601738">ifmat4</span>&nbsp;<span class="op" id="2601745">:=</span>&nbsp;<span class="ident" id="2601748"><a href="/net/interface_linux.go.html#2601888">parseProcNetIGMP</a></span><span class="op" id="2601764">(</span><span class="string" id="2601765">&#34;/proc/net/igmp&#34;</span><span class="op" id="2601781">,</span>&nbsp;<span class="ident" id="2601783"><a href="/net/interface_linux.go.html#2601703">ifi</a></span><span class="op" id="2601786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2601789">ifmat6</span>&nbsp;<span class="op" id="2601796">:=</span>&nbsp;<span class="ident" id="2601799"><a href="/net/interface_linux.go.html#2602774">parseProcNetIGMP6</a></span><span class="op" id="2601816">(</span><span class="string" id="2601817">&#34;/proc/net/igmp6&#34;</span><span class="op" id="2601834">,</span>&nbsp;<span class="ident" id="2601836"><a href="/net/interface_linux.go.html#2601703">ifi</a></span><span class="op" id="2601839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601842">return</span>&nbsp;<span class="builtinfunc" id="2601849">append</span><span class="op" id="2601855">(</span><span class="ident" id="2601856"><a href="/net/interface_linux.go.html#2601738">ifmat4</a></span><span class="op" id="2601862">,</span>&nbsp;<span class="ident" id="2601864"><a href="/net/interface_linux.go.html#2601789">ifmat6</a></span><span class="op" id="2601870">...</span><span class="op" id="2601873">)</span><span class="op" id="2601874">,</span>&nbsp;<span class="ident" id="2601876">nil</span><br>
<span class="lineno">210</span><span class="op" id="2601880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2601883">func</span>&nbsp;<span class="ident" id="2601888">parseProcNetIGMP</span><span class="op" id="2601904">(</span><span class="ident" id="2601905">path</span>&nbsp;<span class="builtintype" id="2601910">string</span><span class="op" id="2601916">,</span>&nbsp;<span class="ident" id="2601918">ifi</span>&nbsp;<span class="op" id="2601922">*</span><span class="ident" id="2601923"><a href="/net/interface.go.html#2593524">Interface</a></span><span class="op" id="2601932">)</span>&nbsp;<span class="op" id="2601934">[</span><span class="op" id="2601935">]</span><span class="ident" id="2601936"><a href="/net/net.go.html#2652238">Addr</a></span>&nbsp;<span class="op" id="2601941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2601944">fd</span><span class="op" id="2601946">,</span>&nbsp;<span class="ident" id="2601948">err</span>&nbsp;<span class="op" id="2601952">:=</span>&nbsp;<span class="ident" id="2601955"><a href="/net/parse.go.html#2663938">open</a></span><span class="op" id="2601959">(</span><span class="ident" id="2601960"><a href="/net/interface_linux.go.html#2601905">path</a></span><span class="op" id="2601964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601967">if</span>&nbsp;<span class="ident" id="2601970"><a href="/net/interface_linux.go.html#2601948">err</a></span>&nbsp;<span class="op" id="2601974">!=</span>&nbsp;<span class="ident" id="2601977">nil</span>&nbsp;<span class="op" id="2601981">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2601985">return</span>&nbsp;<span class="ident" id="2601992">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2601997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2602000">defer</span>&nbsp;<span class="ident" id="2602006"><a href="/net/interface_linux.go.html#2601944">fd</a></span><span class="op" id="2602008">.</span><span class="builtinfunc" id="2602009">close</span><span class="op" id="2602014">(</span><span class="op" id="2602015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2602018">var</span>&nbsp;<span class="op" id="2602022">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602026">ifmat</span>&nbsp;<span class="op" id="2602032">[</span><span class="op" id="2602033">]</span><span class="ident" id="2602034"><a href="/net/net.go.html#2652238">Addr</a></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602041">name</span>&nbsp;&nbsp;<span class="builtintype" id="2602047">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2602055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602058"><a href="/net/interface_linux.go.html#2601944">fd</a></span><span class="op" id="2602060">.</span><span class="ident" id="2602061">readLine</span><span class="op" id="2602069">(</span><span class="op" id="2602070">)</span>&nbsp;<span class="comment" id="2602072">//&nbsp;skip&nbsp;first&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602092">b</span>&nbsp;<span class="op" id="2602094">:=</span>&nbsp;<span class="builtinfunc" id="2602097">make</span><span class="op" id="2602101">(</span><span class="op" id="2602102">[</span><span class="op" id="2602103">]</span><span class="builtintype" id="2602104">byte</span><span class="op" id="2602108">,</span>&nbsp;<span class="ident" id="2602110"><a href="/net/ip.go.html#2603910">IPv4len</a></span><span class="op" id="2602117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2602120">for</span>&nbsp;<span class="ident" id="2602124">l</span><span class="op" id="2602125">,</span>&nbsp;<span class="ident" id="2602127">ok</span>&nbsp;<span class="op" id="2602130">:=</span>&nbsp;<span class="ident" id="2602133"><a href="/net/interface_linux.go.html#2601944">fd</a></span><span class="op" id="2602135">.</span><span class="ident" id="2602136">readLine</span><span class="op" id="2602144">(</span><span class="op" id="2602145">)</span><span class="op" id="2602146">;</span>&nbsp;<span class="ident" id="2602148"><a href="/net/interface_linux.go.html#2602127">ok</a></span><span class="op" id="2602150">;</span>&nbsp;<span class="ident" id="2602152"><a href="/net/interface_linux.go.html#2602124">l</a></span><span class="op" id="2602153">,</span>&nbsp;<span class="ident" id="2602155"><a href="/net/interface_linux.go.html#2602127">ok</a></span>&nbsp;<span class="op" id="2602158">=</span>&nbsp;<span class="ident" id="2602160"><a href="/net/interface_linux.go.html#2601944">fd</a></span><span class="op" id="2602162">.</span><span class="ident" id="2602163">readLine</span><span class="op" id="2602171">(</span><span class="op" id="2602172">)</span>&nbsp;<span class="op" id="2602174">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602178">f</span>&nbsp;<span class="op" id="2602180">:=</span>&nbsp;<span class="ident" id="2602183"><a href="/net/parse.go.html#2664446">splitAtBytes</a></span><span class="op" id="2602195">(</span><span class="ident" id="2602196"><a href="/net/interface_linux.go.html#2602124">l</a></span><span class="op" id="2602197">,</span>&nbsp;<span class="string" id="2602199">&#34;&nbsp;:\r\t\n&#34;</span><span class="op" id="2602209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2602213">if</span>&nbsp;<span class="builtinfunc" id="2602216">len</span><span class="op" id="2602219">(</span><span class="ident" id="2602220"><a href="/net/interface_linux.go.html#2602178">f</a></span><span class="op" id="2602221">)</span>&nbsp;<span class="op" id="2602223">&lt;</span>&nbsp;<span class="num" id="2602225">4</span>&nbsp;<span class="op" id="2602227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2602232">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2602243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2602247">switch</span>&nbsp;<span class="op" id="2602254">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2602258">case</span>&nbsp;<span class="ident" id="2602263"><a href="/net/interface_linux.go.html#2602124">l</a></span><span class="op" id="2602264">[</span><span class="num" id="2602265">0</span><span class="op" id="2602266">]</span>&nbsp;<span class="op" id="2602268">!=</span>&nbsp;<span class="string" id="2602271">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2602275">&amp;&amp;</span>&nbsp;<span class="ident" id="2602278"><a href="/net/interface_linux.go.html#2602124">l</a></span><span class="op" id="2602279">[</span><span class="num" id="2602280">0</span><span class="op" id="2602281">]</span>&nbsp;<span class="op" id="2602283">!=</span>&nbsp;<span class="string" id="2602286">&#39;\t&#39;</span><span class="op" id="2602290">:</span>&nbsp;<span class="comment" id="2602292">//&nbsp;new&nbsp;interface&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602317"><a href="/net/interface_linux.go.html#2602041">name</a></span>&nbsp;<span class="op" id="2602322">=</span>&nbsp;<span class="ident" id="2602324"><a href="/net/interface_linux.go.html#2602178">f</a></span><span class="op" id="2602325">[</span><span class="num" id="2602326">1</span><span class="op" id="2602327">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2602331">case</span>&nbsp;<span class="builtinfunc" id="2602336">len</span><span class="op" id="2602339">(</span><span class="ident" id="2602340"><a href="/net/interface_linux.go.html#2602178">f</a></span><span class="op" id="2602341">[</span><span class="num" id="2602342">0</span><span class="op" id="2602343">]</span><span class="op" id="2602344">)</span>&nbsp;<span class="op" id="2602346">==</span>&nbsp;<span class="num" id="2602349">8</span><span class="op" id="2602350">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2602355">if</span>&nbsp;<span class="ident" id="2602358"><a href="/net/interface_linux.go.html#2601918">ifi</a></span>&nbsp;<span class="op" id="2602362">==</span>&nbsp;<span class="ident" id="2602365">nil</span>&nbsp;<span class="op" id="2602369">||</span>&nbsp;<span class="ident" id="2602372"><a href="/net/interface_linux.go.html#2602041">name</a></span>&nbsp;<span class="op" id="2602377">==</span>&nbsp;<span class="ident" id="2602380"><a href="/net/interface_linux.go.html#2601918">ifi</a></span><span class="op" id="2602383">.</span><span class="ident" id="2602384">Name</span>&nbsp;<span class="op" id="2602389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2602395">//&nbsp;The&nbsp;Linux&nbsp;kernel&nbsp;puts&nbsp;the&nbsp;IP</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2602431">//&nbsp;address&nbsp;in&nbsp;/proc/net/igmp&nbsp;in&nbsp;native</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2602474">//&nbsp;endianness.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2602493">for</span>&nbsp;<span class="ident" id="2602497">i</span>&nbsp;<span class="op" id="2602499">:=</span>&nbsp;<span class="num" id="2602502">0</span><span class="op" id="2602503">;</span>&nbsp;<span class="ident" id="2602505"><a href="/net/interface_linux.go.html#2602497">i</a></span><span class="op" id="2602506">+</span><span class="num" id="2602507">1</span>&nbsp;<span class="op" id="2602509">&lt;</span>&nbsp;<span class="builtinfunc" id="2602511">len</span><span class="op" id="2602514">(</span><span class="ident" id="2602515"><a href="/net/interface_linux.go.html#2602178">f</a></span><span class="op" id="2602516">[</span><span class="num" id="2602517">0</span><span class="op" id="2602518">]</span><span class="op" id="2602519">)</span><span class="op" id="2602520">;</span>&nbsp;<span class="ident" id="2602522"><a href="/net/interface_linux.go.html#2602497">i</a></span>&nbsp;<span class="op" id="2602524">+=</span>&nbsp;<span class="num" id="2602527">2</span>&nbsp;<span class="op" id="2602529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602536"><a href="/net/interface_linux.go.html#2602092">b</a></span><span class="op" id="2602537">[</span><span class="ident" id="2602538"><a href="/net/interface_linux.go.html#2602497">i</a></span><span class="op" id="2602539">/</span><span class="num" id="2602540">2</span><span class="op" id="2602541">]</span><span class="op" id="2602542">,</span>&nbsp;<span class="ident" id="2602544">_</span>&nbsp;<span class="op" id="2602546">=</span>&nbsp;<span class="ident" id="2602548"><a href="/net/parse.go.html#2666029">xtoi2</a></span><span class="op" id="2602553">(</span><span class="ident" id="2602554"><a href="/net/interface_linux.go.html#2602178">f</a></span><span class="op" id="2602555">[</span><span class="num" id="2602556">0</span><span class="op" id="2602557">]</span><span class="op" id="2602558">[</span><span class="ident" id="2602559"><a href="/net/interface_linux.go.html#2602497">i</a></span><span class="op" id="2602560">:</span><span class="ident" id="2602561"><a href="/net/interface_linux.go.html#2602497">i</a></span><span class="op" id="2602562">+</span><span class="num" id="2602563">2</span><span class="op" id="2602564">]</span><span class="op" id="2602565">,</span>&nbsp;<span class="num" id="2602567">0</span><span class="op" id="2602568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2602574">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602580">i</span>&nbsp;<span class="op" id="2602582">:=</span>&nbsp;<span class="op" id="2602585">*</span><span class="op" id="2602586">(</span><span class="op" id="2602587">*</span><span class="builtintype" id="2602588">uint32</span><span class="op" id="2602594">)</span><span class="op" id="2602595">(</span><span class="ident" id="2602596"><a href="/net/interface_linux.go.html#2596356">unsafe</a></span><span class="op" id="2602602">.</span><span class="ident" id="2602603">Pointer</span><span class="op" id="2602610">(</span><span class="op" id="2602611">&amp;</span><span class="ident" id="2602612"><a href="/net/interface_linux.go.html#2602092">b</a></span><span class="op" id="2602613">[</span><span class="op" id="2602614">:</span><span class="num" id="2602615">4</span><span class="op" id="2602616">]</span><span class="op" id="2602617">[</span><span class="num" id="2602618">0</span><span class="op" id="2602619">]</span><span class="op" id="2602620">)</span><span class="op" id="2602621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602627">ifma</span>&nbsp;<span class="op" id="2602632">:=</span>&nbsp;<span class="ident" id="2602635"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="2602641">{</span><span class="ident" id="2602642">IP</span><span class="op" id="2602644">:</span>&nbsp;<span class="ident" id="2602646"><a href="/net/ip.go.html#2604600">IPv4</a></span><span class="op" id="2602650">(</span><span class="builtintype" id="2602651">byte</span><span class="op" id="2602655">(</span><span class="ident" id="2602656"><a href="/net/interface_linux.go.html#2602580">i</a></span><span class="op" id="2602657">&gt;&gt;</span><span class="num" id="2602659">24</span><span class="op" id="2602661">)</span><span class="op" id="2602662">,</span>&nbsp;<span class="builtintype" id="2602664">byte</span><span class="op" id="2602668">(</span><span class="ident" id="2602669"><a href="/net/interface_linux.go.html#2602580">i</a></span><span class="op" id="2602670">&gt;&gt;</span><span class="num" id="2602672">16</span><span class="op" id="2602674">)</span><span class="op" id="2602675">,</span>&nbsp;<span class="builtintype" id="2602677">byte</span><span class="op" id="2602681">(</span><span class="ident" id="2602682"><a href="/net/interface_linux.go.html#2602580">i</a></span><span class="op" id="2602683">&gt;&gt;</span><span class="num" id="2602685">8</span><span class="op" id="2602686">)</span><span class="op" id="2602687">,</span>&nbsp;<span class="builtintype" id="2602689">byte</span><span class="op" id="2602693">(</span><span class="ident" id="2602694"><a href="/net/interface_linux.go.html#2602580">i</a></span><span class="op" id="2602695">)</span><span class="op" id="2602696">)</span><span class="op" id="2602697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602703"><a href="/net/interface_linux.go.html#2602026">ifmat</a></span>&nbsp;<span class="op" id="2602709">=</span>&nbsp;<span class="builtinfunc" id="2602711">append</span><span class="op" id="2602717">(</span><span class="ident" id="2602718"><a href="/net/interface_linux.go.html#2602026">ifmat</a></span><span class="op" id="2602723">,</span>&nbsp;<span class="ident" id="2602725"><a href="/net/interface_linux.go.html#2602627">ifma</a></span><span class="op" id="2602729">.</span><span class="ident" id="2602730">toAddr</span><span class="op" id="2602736">(</span><span class="op" id="2602737">)</span><span class="op" id="2602738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2602743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2602747">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2602750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2602753">return</span>&nbsp;<span class="ident" id="2602760"><a href="/net/interface_linux.go.html#2602026">ifmat</a></span><br>
<span class="lineno"></span><span class="op" id="2602766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2602769">func</span>&nbsp;<span class="ident" id="2602774">parseProcNetIGMP6</span><span class="op" id="2602791">(</span><span class="ident" id="2602792">path</span>&nbsp;<span class="builtintype" id="2602797">string</span><span class="op" id="2602803">,</span>&nbsp;<span class="ident" id="2602805">ifi</span>&nbsp;<span class="op" id="2602809">*</span><span class="ident" id="2602810"><a href="/net/interface.go.html#2593524">Interface</a></span><span class="op" id="2602819">)</span>&nbsp;<span class="op" id="2602821">[</span><span class="op" id="2602822">]</span><span class="ident" id="2602823"><a href="/net/net.go.html#2652238">Addr</a></span>&nbsp;<span class="op" id="2602828">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602831">fd</span><span class="op" id="2602833">,</span>&nbsp;<span class="ident" id="2602835">err</span>&nbsp;<span class="op" id="2602839">:=</span>&nbsp;<span class="ident" id="2602842"><a href="/net/parse.go.html#2663938">open</a></span><span class="op" id="2602846">(</span><span class="ident" id="2602847"><a href="/net/interface_linux.go.html#2602792">path</a></span><span class="op" id="2602851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2602854">if</span>&nbsp;<span class="ident" id="2602857"><a href="/net/interface_linux.go.html#2602835">err</a></span>&nbsp;<span class="op" id="2602861">!=</span>&nbsp;<span class="ident" id="2602864">nil</span>&nbsp;<span class="op" id="2602868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2602872">return</span>&nbsp;<span class="ident" id="2602879">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2602884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2602887">defer</span>&nbsp;<span class="ident" id="2602893"><a href="/net/interface_linux.go.html#2602831">fd</a></span><span class="op" id="2602895">.</span><span class="builtinfunc" id="2602896">close</span><span class="op" id="2602901">(</span><span class="op" id="2602902">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2602905">var</span>&nbsp;<span class="ident" id="2602909">ifmat</span>&nbsp;<span class="op" id="2602915">[</span><span class="op" id="2602916">]</span><span class="ident" id="2602917"><a href="/net/net.go.html#2652238">Addr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2602923">b</span>&nbsp;<span class="op" id="2602925">:=</span>&nbsp;<span class="builtinfunc" id="2602928">make</span><span class="op" id="2602932">(</span><span class="op" id="2602933">[</span><span class="op" id="2602934">]</span><span class="builtintype" id="2602935">byte</span><span class="op" id="2602939">,</span>&nbsp;<span class="ident" id="2602941"><a href="/net/ip.go.html#2603923">IPv6len</a></span><span class="op" id="2602948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2602951">for</span>&nbsp;<span class="ident" id="2602955">l</span><span class="op" id="2602956">,</span>&nbsp;<span class="ident" id="2602958">ok</span>&nbsp;<span class="op" id="2602961">:=</span>&nbsp;<span class="ident" id="2602964"><a href="/net/interface_linux.go.html#2602831">fd</a></span><span class="op" id="2602966">.</span><span class="ident" id="2602967">readLine</span><span class="op" id="2602975">(</span><span class="op" id="2602976">)</span><span class="op" id="2602977">;</span>&nbsp;<span class="ident" id="2602979"><a href="/net/interface_linux.go.html#2602958">ok</a></span><span class="op" id="2602981">;</span>&nbsp;<span class="ident" id="2602983"><a href="/net/interface_linux.go.html#2602955">l</a></span><span class="op" id="2602984">,</span>&nbsp;<span class="ident" id="2602986"><a href="/net/interface_linux.go.html#2602958">ok</a></span>&nbsp;<span class="op" id="2602989">=</span>&nbsp;<span class="ident" id="2602991"><a href="/net/interface_linux.go.html#2602831">fd</a></span><span class="op" id="2602993">.</span><span class="ident" id="2602994">readLine</span><span class="op" id="2603002">(</span><span class="op" id="2603003">)</span>&nbsp;<span class="op" id="2603005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2603009">f</span>&nbsp;<span class="op" id="2603011">:=</span>&nbsp;<span class="ident" id="2603014"><a href="/net/parse.go.html#2664446">splitAtBytes</a></span><span class="op" id="2603026">(</span><span class="ident" id="2603027"><a href="/net/interface_linux.go.html#2602955">l</a></span><span class="op" id="2603028">,</span>&nbsp;<span class="string" id="2603030">&#34;&nbsp;\r\t\n&#34;</span><span class="op" id="2603039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2603043">if</span>&nbsp;<span class="builtinfunc" id="2603046">len</span><span class="op" id="2603049">(</span><span class="ident" id="2603050"><a href="/net/interface_linux.go.html#2603009">f</a></span><span class="op" id="2603051">)</span>&nbsp;<span class="op" id="2603053">&lt;</span>&nbsp;<span class="num" id="2603055">6</span>&nbsp;<span class="op" id="2603057">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2603062">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2603073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2603077">if</span>&nbsp;<span class="ident" id="2603080"><a href="/net/interface_linux.go.html#2602805">ifi</a></span>&nbsp;<span class="op" id="2603084">==</span>&nbsp;<span class="ident" id="2603087">nil</span>&nbsp;<span class="op" id="2603091">||</span>&nbsp;<span class="ident" id="2603094"><a href="/net/interface_linux.go.html#2603009">f</a></span><span class="op" id="2603095">[</span><span class="num" id="2603096">1</span><span class="op" id="2603097">]</span>&nbsp;<span class="op" id="2603099">==</span>&nbsp;<span class="ident" id="2603102"><a href="/net/interface_linux.go.html#2602805">ifi</a></span><span class="op" id="2603105">.</span><span class="ident" id="2603106">Name</span>&nbsp;<span class="op" id="2603111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2603116">for</span>&nbsp;<span class="ident" id="2603120">i</span>&nbsp;<span class="op" id="2603122">:=</span>&nbsp;<span class="num" id="2603125">0</span><span class="op" id="2603126">;</span>&nbsp;<span class="ident" id="2603128"><a href="/net/interface_linux.go.html#2603120">i</a></span><span class="op" id="2603129">+</span><span class="num" id="2603130">1</span>&nbsp;<span class="op" id="2603132">&lt;</span>&nbsp;<span class="builtinfunc" id="2603134">len</span><span class="op" id="2603137">(</span><span class="ident" id="2603138"><a href="/net/interface_linux.go.html#2603009">f</a></span><span class="op" id="2603139">[</span><span class="num" id="2603140">2</span><span class="op" id="2603141">]</span><span class="op" id="2603142">)</span><span class="op" id="2603143">;</span>&nbsp;<span class="ident" id="2603145"><a href="/net/interface_linux.go.html#2603120">i</a></span>&nbsp;<span class="op" id="2603147">+=</span>&nbsp;<span class="num" id="2603150">2</span>&nbsp;<span class="op" id="2603152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2603158"><a href="/net/interface_linux.go.html#2602923">b</a></span><span class="op" id="2603159">[</span><span class="ident" id="2603160"><a href="/net/interface_linux.go.html#2603120">i</a></span><span class="op" id="2603161">/</span><span class="num" id="2603162">2</span><span class="op" id="2603163">]</span><span class="op" id="2603164">,</span>&nbsp;<span class="ident" id="2603166">_</span>&nbsp;<span class="op" id="2603168">=</span>&nbsp;<span class="ident" id="2603170"><a href="/net/parse.go.html#2666029">xtoi2</a></span><span class="op" id="2603175">(</span><span class="ident" id="2603176"><a href="/net/interface_linux.go.html#2603009">f</a></span><span class="op" id="2603177">[</span><span class="num" id="2603178">2</span><span class="op" id="2603179">]</span><span class="op" id="2603180">[</span><span class="ident" id="2603181"><a href="/net/interface_linux.go.html#2603120">i</a></span><span class="op" id="2603182">:</span><span class="ident" id="2603183"><a href="/net/interface_linux.go.html#2603120">i</a></span><span class="op" id="2603184">+</span><span class="num" id="2603185">2</span><span class="op" id="2603186">]</span><span class="op" id="2603187">,</span>&nbsp;<span class="num" id="2603189">0</span><span class="op" id="2603190">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2603195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2603200">ifma</span>&nbsp;<span class="op" id="2603205">:=</span>&nbsp;<span class="ident" id="2603208"><a href="/net/iprawsock.go.html#2619177">IPAddr</a></span><span class="op" id="2603214">{</span><span class="ident" id="2603215">IP</span><span class="op" id="2603217">:</span>&nbsp;<span class="ident" id="2603219"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2603221">{</span><span class="ident" id="2603222"><a href="/net/interface_linux.go.html#2602923">b</a></span><span class="op" id="2603223">[</span><span class="num" id="2603224">0</span><span class="op" id="2603225">]</span><span class="op" id="2603226">,</span>&nbsp;<span class="ident" id="2603228"><a href="/net/interface_linux.go.html#2602923">b</a></span><span class="op" id="2603229">[</span><span class="num" id="2603230">1</span><span class="op" id="2603231">]</span><span class="op" id="2603232">,</span>&nbsp;<span class="ident" id="2603234"><a href="/net/interface_linux.go.html#2602923">b</a></span><span class="op" id="2603235">[</span><span class="num" id="2603236">2</span><span class="op" id="2603237">]</span><span class="op" id="2603238">,</span>&nbsp;<span class="ident" id="2603240"><a href="/net/interface_linux.go.html#2602923">b</a></span><span class="op" id="2603241">[</span><span class="num" id="2603242">3</span><span class="op" id="2603243">]</span><span class="op" id="2603244">,</span>&nbsp;<span class="ident" id="2603246"><a href="/net/interface_linux.go.html#2602923">b</a></span><span class="op" id="2603247">[</span><span class="num" id="2603248">4</span><span class="op" id="2603249">]</span><span class="op" id="2603250">,</span>&nbsp;<span class="ident" id="2603252"><a href="/net/interface_linux.go.html#2602923">b</a></span><span class="op" id="2603253">[</span><span class="num" id="2603254">5</span><span class="op" id="2603255">]</span><span class="op" id="2603256">,</span>&nbsp;<span class="ident" id="2603258"><a href="/net/interface_linux.go.html#2602923">b</a></span><span class="op" id="2603259">[</span><span class="num" id="2603260">6</span><span class="op" id="2603261">]</span><span class="op" id="2603262">,</span>&nbsp;<span class="ident" id="2603264"><a href="/net/interface_linux.go.html#2602923">b</a></span><span class="op" id="2603265">[</span><span class="num" id="2603266">7</span><span class="op" id="2603267">]</span><span class="op" id="2603268">,</span>&nbsp;<span class="ident" id="2603270"><a href="/net/interface_linux.go.html#2602923">b</a></span><span class="op" id="2603271">[</span><span class="num" id="2603272">8</span><span class="op" id="2603273">]</span><span class="op" id="2603274">,</span>&nbsp;<span class="ident" id="2603276"><a href="/net/interface_linux.go.html#2602923">b</a></span><span class="op" id="2603277">[</span><span class="num" id="2603278">9</span><span class="op" id="2603279">]</span><span class="op" id="2603280">,</span>&nbsp;<span class="ident" id="2603282"><a href="/net/interface_linux.go.html#2602923">b</a></span><span class="op" id="2603283">[</span><span class="num" id="2603284">10</span><span class="op" id="2603286">]</span><span class="op" id="2603287">,</span>&nbsp;<span class="ident" id="2603289"><a href="/net/interface_linux.go.html#2602923">b</a></span><span class="op" id="2603290">[</span><span class="num" id="2603291">11</span><span class="op" id="2603293">]</span><span class="op" id="2603294">,</span>&nbsp;<span class="ident" id="2603296"><a href="/net/interface_linux.go.html#2602923">b</a></span><span class="op" id="2603297">[</span><span class="num" id="2603298">12</span><span class="op" id="2603300">]</span><span class="op" id="2603301">,</span>&nbsp;<span class="ident" id="2603303"><a href="/net/interface_linux.go.html#2602923">b</a></span><span class="op" id="2603304">[</span><span class="num" id="2603305">13</span><span class="op" id="2603307">]</span><span class="op" id="2603308">,</span>&nbsp;<span class="ident" id="2603310"><a href="/net/interface_linux.go.html#2602923">b</a></span><span class="op" id="2603311">[</span><span class="num" id="2603312">14</span><span class="op" id="2603314">]</span><span class="op" id="2603315">,</span>&nbsp;<span class="ident" id="2603317"><a href="/net/interface_linux.go.html#2602923">b</a></span><span class="op" id="2603318">[</span><span class="num" id="2603319">15</span><span class="op" id="2603321">]</span><span class="op" id="2603322">}</span><span class="op" id="2603323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2603328"><a href="/net/interface_linux.go.html#2602909">ifmat</a></span>&nbsp;<span class="op" id="2603334">=</span>&nbsp;<span class="builtinfunc" id="2603336">append</span><span class="op" id="2603342">(</span><span class="ident" id="2603343"><a href="/net/interface_linux.go.html#2602909">ifmat</a></span><span class="op" id="2603348">,</span>&nbsp;<span class="ident" id="2603350"><a href="/net/interface_linux.go.html#2603200">ifma</a></span><span class="op" id="2603354">.</span><span class="ident" id="2603355">toAddr</span><span class="op" id="2603361">(</span><span class="op" id="2603362">)</span><span class="op" id="2603363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2603367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2603370">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2603373">return</span>&nbsp;<span class="ident" id="2603380"><a href="/net/interface_linux.go.html#2602909">ifmat</a></span><br>
<span class="lineno"></span><span class="op" id="2603386">}</span>
</div>
</body>
</html>
