<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6980295">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6980350">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6980404">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6980455">package</span>&nbsp;<span class="ident" id="6980463">subtle</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6980471">import</span>&nbsp;<span class="op" id="6980478">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6980481">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6980492">&#34;testing/quick&#34;</span><br>
<span class="lineno">10</span><span class="op" id="6980508">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6980511">type</span>&nbsp;<span class="ident" id="6980516">TestConstantTimeCompareStruct</span>&nbsp;<span class="keyword" id="6980546">struct</span>&nbsp;<span class="op" id="6980553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6980556">a</span><span class="op" id="6980557">,</span>&nbsp;<span class="ident" id="6980559">b</span>&nbsp;<span class="op" id="6980561">[</span><span class="op" id="6980562">]</span><span class="builtintype" id="6980563">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6980569">out</span>&nbsp;&nbsp;<span class="builtintype" id="6980574">int</span><br>
<span class="lineno">15</span><span class="op" id="6980578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6980581">var</span>&nbsp;<span class="ident" id="6980585">testConstantTimeCompareData</span>&nbsp;<span class="op" id="6980613">=</span>&nbsp;<span class="op" id="6980615">[</span><span class="op" id="6980616">]</span><span class="ident" id="6980617"><a href="/crypto/subtle/constant_time_test.go.html#6980516">TestConstantTimeCompareStruct</a></span><span class="op" id="6980646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6980649">{</span><span class="op" id="6980650">[</span><span class="op" id="6980651">]</span><span class="builtintype" id="6980652">byte</span><span class="op" id="6980656">{</span><span class="op" id="6980657">}</span><span class="op" id="6980658">,</span>&nbsp;<span class="op" id="6980660">[</span><span class="op" id="6980661">]</span><span class="builtintype" id="6980662">byte</span><span class="op" id="6980666">{</span><span class="op" id="6980667">}</span><span class="op" id="6980668">,</span>&nbsp;<span class="num" id="6980670">1</span><span class="op" id="6980671">}</span><span class="op" id="6980672">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6980675">{</span><span class="op" id="6980676">[</span><span class="op" id="6980677">]</span><span class="builtintype" id="6980678">byte</span><span class="op" id="6980682">{</span><span class="num" id="6980683">0x11</span><span class="op" id="6980687">}</span><span class="op" id="6980688">,</span>&nbsp;<span class="op" id="6980690">[</span><span class="op" id="6980691">]</span><span class="builtintype" id="6980692">byte</span><span class="op" id="6980696">{</span><span class="num" id="6980697">0x11</span><span class="op" id="6980701">}</span><span class="op" id="6980702">,</span>&nbsp;<span class="num" id="6980704">1</span><span class="op" id="6980705">}</span><span class="op" id="6980706">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6980709">{</span><span class="op" id="6980710">[</span><span class="op" id="6980711">]</span><span class="builtintype" id="6980712">byte</span><span class="op" id="6980716">{</span><span class="num" id="6980717">0x12</span><span class="op" id="6980721">}</span><span class="op" id="6980722">,</span>&nbsp;<span class="op" id="6980724">[</span><span class="op" id="6980725">]</span><span class="builtintype" id="6980726">byte</span><span class="op" id="6980730">{</span><span class="num" id="6980731">0x11</span><span class="op" id="6980735">}</span><span class="op" id="6980736">,</span>&nbsp;<span class="num" id="6980738">0</span><span class="op" id="6980739">}</span><span class="op" id="6980740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6980743">{</span><span class="op" id="6980744">[</span><span class="op" id="6980745">]</span><span class="builtintype" id="6980746">byte</span><span class="op" id="6980750">{</span><span class="num" id="6980751">0x11</span><span class="op" id="6980755">}</span><span class="op" id="6980756">,</span>&nbsp;<span class="op" id="6980758">[</span><span class="op" id="6980759">]</span><span class="builtintype" id="6980760">byte</span><span class="op" id="6980764">{</span><span class="num" id="6980765">0x11</span><span class="op" id="6980769">,</span>&nbsp;<span class="num" id="6980771">0x12</span><span class="op" id="6980775">}</span><span class="op" id="6980776">,</span>&nbsp;<span class="num" id="6980778">0</span><span class="op" id="6980779">}</span><span class="op" id="6980780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6980783">{</span><span class="op" id="6980784">[</span><span class="op" id="6980785">]</span><span class="builtintype" id="6980786">byte</span><span class="op" id="6980790">{</span><span class="num" id="6980791">0x11</span><span class="op" id="6980795">,</span>&nbsp;<span class="num" id="6980797">0x12</span><span class="op" id="6980801">}</span><span class="op" id="6980802">,</span>&nbsp;<span class="op" id="6980804">[</span><span class="op" id="6980805">]</span><span class="builtintype" id="6980806">byte</span><span class="op" id="6980810">{</span><span class="num" id="6980811">0x11</span><span class="op" id="6980815">}</span><span class="op" id="6980816">,</span>&nbsp;<span class="num" id="6980818">0</span><span class="op" id="6980819">}</span><span class="op" id="6980820">,</span><br>
<span class="lineno"></span><span class="op" id="6980822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="6980825">func</span>&nbsp;<span class="ident" id="6980830">TestConstantTimeCompare</span><span class="op" id="6980853">(</span><span class="ident" id="6980854">t</span>&nbsp;<span class="op" id="6980856">*</span><span class="ident" id="6980857"><a href="/crypto/subtle/constant_time_test.go.html#6980481">testing</a></span><span class="op" id="6980864">.</span><span class="ident" id="6980865">T</span><span class="op" id="6980866">)</span>&nbsp;<span class="op" id="6980868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6980871">for</span>&nbsp;<span class="ident" id="6980875">i</span><span class="op" id="6980876">,</span>&nbsp;<span class="ident" id="6980878">test</span>&nbsp;<span class="op" id="6980883">:=</span>&nbsp;<span class="keyword" id="6980886">range</span>&nbsp;<span class="ident" id="6980892"><a href="/crypto/subtle/constant_time_test.go.html#6980585">testConstantTimeCompareData</a></span>&nbsp;<span class="op" id="6980920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6980924">if</span>&nbsp;<span class="ident" id="6980927">r</span>&nbsp;<span class="op" id="6980929">:=</span>&nbsp;<span class="ident" id="6980932"><a href="/crypto/subtle/constant_time.go.html#3725899">ConstantTimeCompare</a></span><span class="op" id="6980951">(</span><span class="ident" id="6980952"><a href="/crypto/subtle/constant_time_test.go.html#6980878">test</a></span><span class="op" id="6980956">.</span><span class="ident" id="6980957">a</span><span class="op" id="6980958">,</span>&nbsp;<span class="ident" id="6980960"><a href="/crypto/subtle/constant_time_test.go.html#6980878">test</a></span><span class="op" id="6980964">.</span><span class="ident" id="6980965">b</span><span class="op" id="6980966">)</span><span class="op" id="6980967">;</span>&nbsp;<span class="ident" id="6980969"><a href="/crypto/subtle/constant_time_test.go.html#6980927">r</a></span>&nbsp;<span class="op" id="6980971">!=</span>&nbsp;<span class="ident" id="6980974"><a href="/crypto/subtle/constant_time_test.go.html#6980878">test</a></span><span class="op" id="6980978">.</span><span class="ident" id="6980979">out</span>&nbsp;<span class="op" id="6980983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6980988"><a href="/crypto/subtle/constant_time_test.go.html#6980854">t</a></span><span class="op" id="6980989">.</span><span class="ident" id="6980990">Errorf</span><span class="op" id="6980996">(</span><span class="string" id="6980997">&#34;#%d&nbsp;bad&nbsp;result&nbsp;(got&nbsp;%x,&nbsp;want&nbsp;%x)&#34;</span><span class="op" id="6981031">,</span>&nbsp;<span class="ident" id="6981033"><a href="/crypto/subtle/constant_time_test.go.html#6980875">i</a></span><span class="op" id="6981034">,</span>&nbsp;<span class="ident" id="6981036"><a href="/crypto/subtle/constant_time_test.go.html#6980927">r</a></span><span class="op" id="6981037">,</span>&nbsp;<span class="ident" id="6981039"><a href="/crypto/subtle/constant_time_test.go.html#6980878">test</a></span><span class="op" id="6981043">.</span><span class="ident" id="6981044">out</span><span class="op" id="6981047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6981051">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6981054">}</span><br>
<span class="lineno"></span><span class="op" id="6981056">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6981059">type</span>&nbsp;<span class="ident" id="6981064">TestConstantTimeByteEqStruct</span>&nbsp;<span class="keyword" id="6981093">struct</span>&nbsp;<span class="op" id="6981100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6981103">a</span><span class="op" id="6981104">,</span>&nbsp;<span class="ident" id="6981106">b</span>&nbsp;<span class="builtintype" id="6981108">uint8</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6981115">out</span>&nbsp;&nbsp;<span class="builtintype" id="6981120">int</span><br>
<span class="lineno"></span><span class="op" id="6981124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6981127">var</span>&nbsp;<span class="ident" id="6981131">testConstandTimeByteEqData</span>&nbsp;<span class="op" id="6981158">=</span>&nbsp;<span class="op" id="6981160">[</span><span class="op" id="6981161">]</span><span class="ident" id="6981162"><a href="/crypto/subtle/constant_time_test.go.html#6981064">TestConstantTimeByteEqStruct</a></span><span class="op" id="6981190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6981193">{</span><span class="num" id="6981194">0</span><span class="op" id="6981195">,</span>&nbsp;<span class="num" id="6981197">0</span><span class="op" id="6981198">,</span>&nbsp;<span class="num" id="6981200">1</span><span class="op" id="6981201">}</span><span class="op" id="6981202">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6981205">{</span><span class="num" id="6981206">0</span><span class="op" id="6981207">,</span>&nbsp;<span class="num" id="6981209">1</span><span class="op" id="6981210">,</span>&nbsp;<span class="num" id="6981212">0</span><span class="op" id="6981213">}</span><span class="op" id="6981214">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6981217">{</span><span class="num" id="6981218">1</span><span class="op" id="6981219">,</span>&nbsp;<span class="num" id="6981221">0</span><span class="op" id="6981222">,</span>&nbsp;<span class="num" id="6981224">0</span><span class="op" id="6981225">}</span><span class="op" id="6981226">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6981229">{</span><span class="num" id="6981230">0xff</span><span class="op" id="6981234">,</span>&nbsp;<span class="num" id="6981236">0xff</span><span class="op" id="6981240">,</span>&nbsp;<span class="num" id="6981242">1</span><span class="op" id="6981243">}</span><span class="op" id="6981244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6981247">{</span><span class="num" id="6981248">0xff</span><span class="op" id="6981252">,</span>&nbsp;<span class="num" id="6981254">0xfe</span><span class="op" id="6981258">,</span>&nbsp;<span class="num" id="6981260">0</span><span class="op" id="6981261">}</span><span class="op" id="6981262">,</span><br>
<span class="lineno"></span><span class="op" id="6981264">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="6981267">func</span>&nbsp;<span class="ident" id="6981272">byteEq</span><span class="op" id="6981278">(</span><span class="ident" id="6981279">a</span><span class="op" id="6981280">,</span>&nbsp;<span class="ident" id="6981282">b</span>&nbsp;<span class="builtintype" id="6981284">uint8</span><span class="op" id="6981289">)</span>&nbsp;<span class="builtintype" id="6981291">int</span>&nbsp;<span class="op" id="6981295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6981298">if</span>&nbsp;<span class="ident" id="6981301"><a href="/crypto/subtle/constant_time_test.go.html#6981279">a</a></span>&nbsp;<span class="op" id="6981303">==</span>&nbsp;<span class="ident" id="6981306"><a href="/crypto/subtle/constant_time_test.go.html#6981282">b</a></span>&nbsp;<span class="op" id="6981308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6981312">return</span>&nbsp;<span class="num" id="6981319">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6981322">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6981325">return</span>&nbsp;<span class="num" id="6981332">0</span><br>
<span class="lineno"></span><span class="op" id="6981334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6981337">func</span>&nbsp;<span class="ident" id="6981342">TestConstantTimeByteEq</span><span class="op" id="6981364">(</span><span class="ident" id="6981365">t</span>&nbsp;<span class="op" id="6981367">*</span><span class="ident" id="6981368"><a href="/crypto/subtle/constant_time_test.go.html#6980481">testing</a></span><span class="op" id="6981375">.</span><span class="ident" id="6981376">T</span><span class="op" id="6981377">)</span>&nbsp;<span class="op" id="6981379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6981382">for</span>&nbsp;<span class="ident" id="6981386">i</span><span class="op" id="6981387">,</span>&nbsp;<span class="ident" id="6981389">test</span>&nbsp;<span class="op" id="6981394">:=</span>&nbsp;<span class="keyword" id="6981397">range</span>&nbsp;<span class="ident" id="6981403"><a href="/crypto/subtle/constant_time_test.go.html#6981131">testConstandTimeByteEqData</a></span>&nbsp;<span class="op" id="6981430">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6981434">if</span>&nbsp;<span class="ident" id="6981437">r</span>&nbsp;<span class="op" id="6981439">:=</span>&nbsp;<span class="ident" id="6981442"><a href="/crypto/subtle/constant_time.go.html#3726331">ConstantTimeByteEq</a></span><span class="op" id="6981460">(</span><span class="ident" id="6981461"><a href="/crypto/subtle/constant_time_test.go.html#6981389">test</a></span><span class="op" id="6981465">.</span><span class="ident" id="6981466">a</span><span class="op" id="6981467">,</span>&nbsp;<span class="ident" id="6981469"><a href="/crypto/subtle/constant_time_test.go.html#6981389">test</a></span><span class="op" id="6981473">.</span><span class="ident" id="6981474">b</span><span class="op" id="6981475">)</span><span class="op" id="6981476">;</span>&nbsp;<span class="ident" id="6981478"><a href="/crypto/subtle/constant_time_test.go.html#6981437">r</a></span>&nbsp;<span class="op" id="6981480">!=</span>&nbsp;<span class="ident" id="6981483"><a href="/crypto/subtle/constant_time_test.go.html#6981389">test</a></span><span class="op" id="6981487">.</span><span class="ident" id="6981488">out</span>&nbsp;<span class="op" id="6981492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6981497"><a href="/crypto/subtle/constant_time_test.go.html#6981365">t</a></span><span class="op" id="6981498">.</span><span class="ident" id="6981499">Errorf</span><span class="op" id="6981505">(</span><span class="string" id="6981506">&#34;#%d&nbsp;bad&nbsp;result&nbsp;(got&nbsp;%x,&nbsp;want&nbsp;%x)&#34;</span><span class="op" id="6981540">,</span>&nbsp;<span class="ident" id="6981542"><a href="/crypto/subtle/constant_time_test.go.html#6981386">i</a></span><span class="op" id="6981543">,</span>&nbsp;<span class="ident" id="6981545"><a href="/crypto/subtle/constant_time_test.go.html#6981437">r</a></span><span class="op" id="6981546">,</span>&nbsp;<span class="ident" id="6981548"><a href="/crypto/subtle/constant_time_test.go.html#6981389">test</a></span><span class="op" id="6981552">.</span><span class="ident" id="6981553">out</span><span class="op" id="6981556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6981560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6981563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6981566">err</span>&nbsp;<span class="op" id="6981570">:=</span>&nbsp;<span class="ident" id="6981573"><a href="/crypto/subtle/constant_time_test.go.html#6980492">quick</a></span><span class="op" id="6981578">.</span><span class="ident" id="6981579">CheckEqual</span><span class="op" id="6981589">(</span><span class="ident" id="6981590"><a href="/crypto/subtle/constant_time.go.html#3726331">ConstantTimeByteEq</a></span><span class="op" id="6981608">,</span>&nbsp;<span class="ident" id="6981610"><a href="/crypto/subtle/constant_time_test.go.html#6981272">byteEq</a></span><span class="op" id="6981616">,</span>&nbsp;<span class="ident" id="6981618">nil</span><span class="op" id="6981621">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6981624">if</span>&nbsp;<span class="ident" id="6981627"><a href="/crypto/subtle/constant_time_test.go.html#6981566">err</a></span>&nbsp;<span class="op" id="6981631">!=</span>&nbsp;<span class="ident" id="6981634">nil</span>&nbsp;<span class="op" id="6981638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6981642"><a href="/crypto/subtle/constant_time_test.go.html#6981365">t</a></span><span class="op" id="6981643">.</span><span class="ident" id="6981644">Error</span><span class="op" id="6981649">(</span><span class="ident" id="6981650"><a href="/crypto/subtle/constant_time_test.go.html#6981566">err</a></span><span class="op" id="6981653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6981656">}</span><br>
<span class="lineno"></span><span class="op" id="6981658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="6981661">func</span>&nbsp;<span class="ident" id="6981666">eq</span><span class="op" id="6981668">(</span><span class="ident" id="6981669">a</span><span class="op" id="6981670">,</span>&nbsp;<span class="ident" id="6981672">b</span>&nbsp;<span class="builtintype" id="6981674">int32</span><span class="op" id="6981679">)</span>&nbsp;<span class="builtintype" id="6981681">int</span>&nbsp;<span class="op" id="6981685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6981688">if</span>&nbsp;<span class="ident" id="6981691"><a href="/crypto/subtle/constant_time_test.go.html#6981669">a</a></span>&nbsp;<span class="op" id="6981693">==</span>&nbsp;<span class="ident" id="6981696"><a href="/crypto/subtle/constant_time_test.go.html#6981672">b</a></span>&nbsp;<span class="op" id="6981698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6981702">return</span>&nbsp;<span class="num" id="6981709">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6981712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6981715">return</span>&nbsp;<span class="num" id="6981722">0</span><br>
<span class="lineno">70</span><span class="op" id="6981724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6981727">func</span>&nbsp;<span class="ident" id="6981732">TestConstantTimeEq</span><span class="op" id="6981750">(</span><span class="ident" id="6981751">t</span>&nbsp;<span class="op" id="6981753">*</span><span class="ident" id="6981754"><a href="/crypto/subtle/constant_time_test.go.html#6980481">testing</a></span><span class="op" id="6981761">.</span><span class="ident" id="6981762">T</span><span class="op" id="6981763">)</span>&nbsp;<span class="op" id="6981765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6981768">err</span>&nbsp;<span class="op" id="6981772">:=</span>&nbsp;<span class="ident" id="6981775"><a href="/crypto/subtle/constant_time_test.go.html#6980492">quick</a></span><span class="op" id="6981780">.</span><span class="ident" id="6981781">CheckEqual</span><span class="op" id="6981791">(</span><span class="ident" id="6981792"><a href="/crypto/subtle/constant_time.go.html#3726501">ConstantTimeEq</a></span><span class="op" id="6981806">,</span>&nbsp;<span class="ident" id="6981808"><a href="/crypto/subtle/constant_time_test.go.html#6981666">eq</a></span><span class="op" id="6981810">,</span>&nbsp;<span class="ident" id="6981812">nil</span><span class="op" id="6981815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6981818">if</span>&nbsp;<span class="ident" id="6981821"><a href="/crypto/subtle/constant_time_test.go.html#6981768">err</a></span>&nbsp;<span class="op" id="6981825">!=</span>&nbsp;<span class="ident" id="6981828">nil</span>&nbsp;<span class="op" id="6981832">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6981836"><a href="/crypto/subtle/constant_time_test.go.html#6981751">t</a></span><span class="op" id="6981837">.</span><span class="ident" id="6981838">Error</span><span class="op" id="6981843">(</span><span class="ident" id="6981844"><a href="/crypto/subtle/constant_time_test.go.html#6981768">err</a></span><span class="op" id="6981847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6981850">}</span><br>
<span class="lineno"></span><span class="op" id="6981852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6981855">func</span>&nbsp;<span class="ident" id="6981860">makeCopy</span><span class="op" id="6981868">(</span><span class="ident" id="6981869">v</span>&nbsp;<span class="builtintype" id="6981871">int</span><span class="op" id="6981874">,</span>&nbsp;<span class="ident" id="6981876">x</span><span class="op" id="6981877">,</span>&nbsp;<span class="ident" id="6981879">y</span>&nbsp;<span class="op" id="6981881">[</span><span class="op" id="6981882">]</span><span class="builtintype" id="6981883">byte</span><span class="op" id="6981887">)</span>&nbsp;<span class="op" id="6981889">[</span><span class="op" id="6981890">]</span><span class="builtintype" id="6981891">byte</span>&nbsp;<span class="op" id="6981896">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6981899">if</span>&nbsp;<span class="builtinfunc" id="6981902">len</span><span class="op" id="6981905">(</span><span class="ident" id="6981906"><a href="/crypto/subtle/constant_time_test.go.html#6981876">x</a></span><span class="op" id="6981907">)</span>&nbsp;<span class="op" id="6981909">&gt;</span>&nbsp;<span class="builtinfunc" id="6981911">len</span><span class="op" id="6981914">(</span><span class="ident" id="6981915"><a href="/crypto/subtle/constant_time_test.go.html#6981879">y</a></span><span class="op" id="6981916">)</span>&nbsp;<span class="op" id="6981918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6981922"><a href="/crypto/subtle/constant_time_test.go.html#6981876">x</a></span>&nbsp;<span class="op" id="6981924">=</span>&nbsp;<span class="ident" id="6981926"><a href="/crypto/subtle/constant_time_test.go.html#6981876">x</a></span><span class="op" id="6981927">[</span><span class="num" id="6981928">0</span><span class="op" id="6981929">:</span><span class="builtinfunc" id="6981930">len</span><span class="op" id="6981933">(</span><span class="ident" id="6981934"><a href="/crypto/subtle/constant_time_test.go.html#6981879">y</a></span><span class="op" id="6981935">)</span><span class="op" id="6981936">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6981939">}</span>&nbsp;<span class="keyword" id="6981941">else</span>&nbsp;<span class="op" id="6981946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6981950"><a href="/crypto/subtle/constant_time_test.go.html#6981879">y</a></span>&nbsp;<span class="op" id="6981952">=</span>&nbsp;<span class="ident" id="6981954"><a href="/crypto/subtle/constant_time_test.go.html#6981879">y</a></span><span class="op" id="6981955">[</span><span class="num" id="6981956">0</span><span class="op" id="6981957">:</span><span class="builtinfunc" id="6981958">len</span><span class="op" id="6981961">(</span><span class="ident" id="6981962"><a href="/crypto/subtle/constant_time_test.go.html#6981876">x</a></span><span class="op" id="6981963">)</span><span class="op" id="6981964">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6981967">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6981970">if</span>&nbsp;<span class="ident" id="6981973"><a href="/crypto/subtle/constant_time_test.go.html#6981869">v</a></span>&nbsp;<span class="op" id="6981975">==</span>&nbsp;<span class="num" id="6981978">1</span>&nbsp;<span class="op" id="6981980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6981984">copy</span><span class="op" id="6981988">(</span><span class="ident" id="6981989"><a href="/crypto/subtle/constant_time_test.go.html#6981876">x</a></span><span class="op" id="6981990">,</span>&nbsp;<span class="ident" id="6981992"><a href="/crypto/subtle/constant_time_test.go.html#6981879">y</a></span><span class="op" id="6981993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6981996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6981999">return</span>&nbsp;<span class="ident" id="6982006"><a href="/crypto/subtle/constant_time_test.go.html#6981876">x</a></span><br>
<span class="lineno"></span><span class="op" id="6982008">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="6982011">func</span>&nbsp;<span class="ident" id="6982016">constantTimeCopyWrapper</span><span class="op" id="6982039">(</span><span class="ident" id="6982040">v</span>&nbsp;<span class="builtintype" id="6982042">int</span><span class="op" id="6982045">,</span>&nbsp;<span class="ident" id="6982047">x</span><span class="op" id="6982048">,</span>&nbsp;<span class="ident" id="6982050">y</span>&nbsp;<span class="op" id="6982052">[</span><span class="op" id="6982053">]</span><span class="builtintype" id="6982054">byte</span><span class="op" id="6982058">)</span>&nbsp;<span class="op" id="6982060">[</span><span class="op" id="6982061">]</span><span class="builtintype" id="6982062">byte</span>&nbsp;<span class="op" id="6982067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6982070">if</span>&nbsp;<span class="builtinfunc" id="6982073">len</span><span class="op" id="6982076">(</span><span class="ident" id="6982077"><a href="/crypto/subtle/constant_time_test.go.html#6982047">x</a></span><span class="op" id="6982078">)</span>&nbsp;<span class="op" id="6982080">&gt;</span>&nbsp;<span class="builtinfunc" id="6982082">len</span><span class="op" id="6982085">(</span><span class="ident" id="6982086"><a href="/crypto/subtle/constant_time_test.go.html#6982050">y</a></span><span class="op" id="6982087">)</span>&nbsp;<span class="op" id="6982089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6982093"><a href="/crypto/subtle/constant_time_test.go.html#6982047">x</a></span>&nbsp;<span class="op" id="6982095">=</span>&nbsp;<span class="ident" id="6982097"><a href="/crypto/subtle/constant_time_test.go.html#6982047">x</a></span><span class="op" id="6982098">[</span><span class="num" id="6982099">0</span><span class="op" id="6982100">:</span><span class="builtinfunc" id="6982101">len</span><span class="op" id="6982104">(</span><span class="ident" id="6982105"><a href="/crypto/subtle/constant_time_test.go.html#6982050">y</a></span><span class="op" id="6982106">)</span><span class="op" id="6982107">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6982110">}</span>&nbsp;<span class="keyword" id="6982112">else</span>&nbsp;<span class="op" id="6982117">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6982121"><a href="/crypto/subtle/constant_time_test.go.html#6982050">y</a></span>&nbsp;<span class="op" id="6982123">=</span>&nbsp;<span class="ident" id="6982125"><a href="/crypto/subtle/constant_time_test.go.html#6982050">y</a></span><span class="op" id="6982126">[</span><span class="num" id="6982127">0</span><span class="op" id="6982128">:</span><span class="builtinfunc" id="6982129">len</span><span class="op" id="6982132">(</span><span class="ident" id="6982133"><a href="/crypto/subtle/constant_time_test.go.html#6982047">x</a></span><span class="op" id="6982134">)</span><span class="op" id="6982135">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6982138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6982141"><a href="/crypto/subtle/constant_time_test.go.html#6982040">v</a></span>&nbsp;<span class="op" id="6982143">&amp;=</span>&nbsp;<span class="num" id="6982146">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6982149"><a href="/crypto/subtle/constant_time.go.html#3726824">ConstantTimeCopy</a></span><span class="op" id="6982165">(</span><span class="ident" id="6982166"><a href="/crypto/subtle/constant_time_test.go.html#6982040">v</a></span><span class="op" id="6982167">,</span>&nbsp;<span class="ident" id="6982169"><a href="/crypto/subtle/constant_time_test.go.html#6982047">x</a></span><span class="op" id="6982170">,</span>&nbsp;<span class="ident" id="6982172"><a href="/crypto/subtle/constant_time_test.go.html#6982050">y</a></span><span class="op" id="6982173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6982176">return</span>&nbsp;<span class="ident" id="6982183"><a href="/crypto/subtle/constant_time_test.go.html#6982047">x</a></span><br>
<span class="lineno">100</span><span class="op" id="6982185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6982188">func</span>&nbsp;<span class="ident" id="6982193">TestConstantTimeCopy</span><span class="op" id="6982213">(</span><span class="ident" id="6982214">t</span>&nbsp;<span class="op" id="6982216">*</span><span class="ident" id="6982217"><a href="/crypto/subtle/constant_time_test.go.html#6980481">testing</a></span><span class="op" id="6982224">.</span><span class="ident" id="6982225">T</span><span class="op" id="6982226">)</span>&nbsp;<span class="op" id="6982228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6982231">err</span>&nbsp;<span class="op" id="6982235">:=</span>&nbsp;<span class="ident" id="6982238"><a href="/crypto/subtle/constant_time_test.go.html#6980492">quick</a></span><span class="op" id="6982243">.</span><span class="ident" id="6982244">CheckEqual</span><span class="op" id="6982254">(</span><span class="ident" id="6982255"><a href="/crypto/subtle/constant_time_test.go.html#6982016">constantTimeCopyWrapper</a></span><span class="op" id="6982278">,</span>&nbsp;<span class="ident" id="6982280"><a href="/crypto/subtle/constant_time_test.go.html#6981860">makeCopy</a></span><span class="op" id="6982288">,</span>&nbsp;<span class="ident" id="6982290">nil</span><span class="op" id="6982293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6982296">if</span>&nbsp;<span class="ident" id="6982299"><a href="/crypto/subtle/constant_time_test.go.html#6982231">err</a></span>&nbsp;<span class="op" id="6982303">!=</span>&nbsp;<span class="ident" id="6982306">nil</span>&nbsp;<span class="op" id="6982310">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6982314"><a href="/crypto/subtle/constant_time_test.go.html#6982214">t</a></span><span class="op" id="6982315">.</span><span class="ident" id="6982316">Error</span><span class="op" id="6982321">(</span><span class="ident" id="6982322"><a href="/crypto/subtle/constant_time_test.go.html#6982231">err</a></span><span class="op" id="6982325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6982328">}</span><br>
<span class="lineno"></span><span class="op" id="6982330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6982333">var</span>&nbsp;<span class="ident" id="6982337">lessOrEqTests</span>&nbsp;<span class="op" id="6982351">=</span>&nbsp;<span class="op" id="6982353">[</span><span class="op" id="6982354">]</span><span class="keyword" id="6982355">struct</span>&nbsp;<span class="op" id="6982362">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6982365">x</span><span class="op" id="6982366">,</span>&nbsp;<span class="ident" id="6982368">y</span><span class="op" id="6982369">,</span>&nbsp;<span class="ident" id="6982371">result</span>&nbsp;<span class="builtintype" id="6982378">int</span><br>
<span class="lineno"></span><span class="op" id="6982382">}</span><span class="op" id="6982383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6982386">{</span><span class="num" id="6982387">0</span><span class="op" id="6982388">,</span>&nbsp;<span class="num" id="6982390">0</span><span class="op" id="6982391">,</span>&nbsp;<span class="num" id="6982393">1</span><span class="op" id="6982394">}</span><span class="op" id="6982395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6982398">{</span><span class="num" id="6982399">1</span><span class="op" id="6982400">,</span>&nbsp;<span class="num" id="6982402">0</span><span class="op" id="6982403">,</span>&nbsp;<span class="num" id="6982405">0</span><span class="op" id="6982406">}</span><span class="op" id="6982407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6982410">{</span><span class="num" id="6982411">0</span><span class="op" id="6982412">,</span>&nbsp;<span class="num" id="6982414">1</span><span class="op" id="6982415">,</span>&nbsp;<span class="num" id="6982417">1</span><span class="op" id="6982418">}</span><span class="op" id="6982419">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6982422">{</span><span class="num" id="6982423">10</span><span class="op" id="6982425">,</span>&nbsp;<span class="num" id="6982427">20</span><span class="op" id="6982429">,</span>&nbsp;<span class="num" id="6982431">1</span><span class="op" id="6982432">}</span><span class="op" id="6982433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6982436">{</span><span class="num" id="6982437">20</span><span class="op" id="6982439">,</span>&nbsp;<span class="num" id="6982441">10</span><span class="op" id="6982443">,</span>&nbsp;<span class="num" id="6982445">0</span><span class="op" id="6982446">}</span><span class="op" id="6982447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6982450">{</span><span class="num" id="6982451">10</span><span class="op" id="6982453">,</span>&nbsp;<span class="num" id="6982455">10</span><span class="op" id="6982457">,</span>&nbsp;<span class="num" id="6982459">1</span><span class="op" id="6982460">}</span><span class="op" id="6982461">,</span><br>
<span class="lineno"></span><span class="op" id="6982463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="keyword" id="6982466">func</span>&nbsp;<span class="ident" id="6982471">TestConstantTimeLessOrEq</span><span class="op" id="6982495">(</span><span class="ident" id="6982496">t</span>&nbsp;<span class="op" id="6982498">*</span><span class="ident" id="6982499"><a href="/crypto/subtle/constant_time_test.go.html#6980481">testing</a></span><span class="op" id="6982506">.</span><span class="ident" id="6982507">T</span><span class="op" id="6982508">)</span>&nbsp;<span class="op" id="6982510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6982513">for</span>&nbsp;<span class="ident" id="6982517">i</span><span class="op" id="6982518">,</span>&nbsp;<span class="ident" id="6982520">test</span>&nbsp;<span class="op" id="6982525">:=</span>&nbsp;<span class="keyword" id="6982528">range</span>&nbsp;<span class="ident" id="6982534"><a href="/crypto/subtle/constant_time_test.go.html#6982337">lessOrEqTests</a></span>&nbsp;<span class="op" id="6982548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6982552">result</span>&nbsp;<span class="op" id="6982559">:=</span>&nbsp;<span class="ident" id="6982562"><a href="/crypto/subtle/constant_time.go.html#3727190">ConstantTimeLessOrEq</a></span><span class="op" id="6982582">(</span><span class="ident" id="6982583"><a href="/crypto/subtle/constant_time_test.go.html#6982520">test</a></span><span class="op" id="6982587">.</span><span class="ident" id="6982588">x</span><span class="op" id="6982589">,</span>&nbsp;<span class="ident" id="6982591"><a href="/crypto/subtle/constant_time_test.go.html#6982520">test</a></span><span class="op" id="6982595">.</span><span class="ident" id="6982596">y</span><span class="op" id="6982597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6982601">if</span>&nbsp;<span class="ident" id="6982604"><a href="/crypto/subtle/constant_time_test.go.html#6982552">result</a></span>&nbsp;<span class="op" id="6982611">!=</span>&nbsp;<span class="ident" id="6982614"><a href="/crypto/subtle/constant_time_test.go.html#6982520">test</a></span><span class="op" id="6982618">.</span><span class="ident" id="6982619">result</span>&nbsp;<span class="op" id="6982626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6982631"><a href="/crypto/subtle/constant_time_test.go.html#6982496">t</a></span><span class="op" id="6982632">.</span><span class="ident" id="6982633">Errorf</span><span class="op" id="6982639">(</span><span class="string" id="6982640">&#34;#%d:&nbsp;%d&nbsp;&lt;=&nbsp;%d&nbsp;gave&nbsp;%d,&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="6982676">,</span>&nbsp;<span class="ident" id="6982678"><a href="/crypto/subtle/constant_time_test.go.html#6982517">i</a></span><span class="op" id="6982679">,</span>&nbsp;<span class="ident" id="6982681"><a href="/crypto/subtle/constant_time_test.go.html#6982520">test</a></span><span class="op" id="6982685">.</span><span class="ident" id="6982686">x</span><span class="op" id="6982687">,</span>&nbsp;<span class="ident" id="6982689"><a href="/crypto/subtle/constant_time_test.go.html#6982520">test</a></span><span class="op" id="6982693">.</span><span class="ident" id="6982694">y</span><span class="op" id="6982695">,</span>&nbsp;<span class="ident" id="6982697"><a href="/crypto/subtle/constant_time_test.go.html#6982552">result</a></span><span class="op" id="6982703">,</span>&nbsp;<span class="ident" id="6982705"><a href="/crypto/subtle/constant_time_test.go.html#6982520">test</a></span><span class="op" id="6982709">.</span><span class="ident" id="6982710">result</span><span class="op" id="6982716">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6982720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6982723">}</span><br>
<span class="lineno"></span><span class="op" id="6982725">}</span>
</div>
</body>
</html>
