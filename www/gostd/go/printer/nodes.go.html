<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/printer</h2>
<ul>
<li><a href="/gostd/go/printer/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/printer/nodes.go.html" class="current">nodes.go</a></li>
<li><a href="/gostd/go/printer/performance_test.go.html">performance_test.go</a></li>
<li><a href="/gostd/go/printer/printer.go.html">printer.go</a></li>
<li><a href="/gostd/go/printer/printer_test.go.html">printer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5860392">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5860447">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5860501">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5860552">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;printing&nbsp;of&nbsp;AST&nbsp;nodes;&nbsp;specifically</span><br>
<span class="lineno"></span><span class="comment" id="5860612">//&nbsp;expressions,&nbsp;statements,&nbsp;declarations,&nbsp;and&nbsp;files.&nbsp;It&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="5860673">//&nbsp;the&nbsp;print&nbsp;functionality&nbsp;implemented&nbsp;in&nbsp;printer.go.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5860728">package</span>&nbsp;<span class="ident" id="5860736">printer</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="5860745">import</span>&nbsp;<span class="op" id="5860752">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5860755">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5860764">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5860774">&#34;go/token&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5860786">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5860801">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5860804">//&nbsp;Formatting&nbsp;issues:</span><br>
<span class="lineno"></span><span class="comment" id="5860826">//&nbsp;-&nbsp;better&nbsp;comment&nbsp;formatting&nbsp;for&nbsp;/*-style&nbsp;comments&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;line&nbsp;(e.g.&nbsp;a&nbsp;declaration)</span><br>
<span class="lineno">20</span><span class="comment" id="5860921">//&nbsp;&nbsp;&nbsp;when&nbsp;the&nbsp;comment&nbsp;spans&nbsp;multiple&nbsp;lines;&nbsp;if&nbsp;such&nbsp;a&nbsp;comment&nbsp;is&nbsp;just&nbsp;two&nbsp;lines,&nbsp;formatting&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5861016">//&nbsp;&nbsp;&nbsp;not&nbsp;idempotent</span><br>
<span class="lineno"></span><span class="comment" id="5861036">//&nbsp;-&nbsp;formatting&nbsp;of&nbsp;expression&nbsp;lists</span><br>
<span class="lineno"></span><span class="comment" id="5861072">//&nbsp;-&nbsp;should&nbsp;use&nbsp;blank&nbsp;instead&nbsp;of&nbsp;tab&nbsp;to&nbsp;separate&nbsp;one-line&nbsp;function&nbsp;bodies&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="5861151">//&nbsp;&nbsp;&nbsp;the&nbsp;function&nbsp;header&nbsp;unless&nbsp;there&nbsp;is&nbsp;a&nbsp;group&nbsp;of&nbsp;consecutive&nbsp;one-liners</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="5861227">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5861307">//&nbsp;Common&nbsp;AST&nbsp;nodes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5861329">//&nbsp;Print&nbsp;as&nbsp;many&nbsp;newlines&nbsp;as&nbsp;necessary&nbsp;(but&nbsp;at&nbsp;least&nbsp;min&nbsp;newlines)&nbsp;to&nbsp;get&nbsp;to</span><br>
<span class="lineno">30</span><span class="comment" id="5861406">//&nbsp;the&nbsp;current&nbsp;line.&nbsp;ws&nbsp;is&nbsp;printed&nbsp;before&nbsp;the&nbsp;first&nbsp;line&nbsp;break.&nbsp;If&nbsp;newSection</span><br>
<span class="lineno"></span><span class="comment" id="5861484">//&nbsp;is&nbsp;set,&nbsp;the&nbsp;first&nbsp;line&nbsp;break&nbsp;is&nbsp;printed&nbsp;as&nbsp;formfeed.&nbsp;Returns&nbsp;true&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="5861560">//&nbsp;line&nbsp;break&nbsp;was&nbsp;printed;&nbsp;returns&nbsp;false&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="5861612">//</span><br>
<span class="lineno"></span><span class="comment" id="5861615">//&nbsp;TODO(gri):&nbsp;linebreak&nbsp;may&nbsp;add&nbsp;too&nbsp;many&nbsp;lines&nbsp;if&nbsp;the&nbsp;next&nbsp;statement&nbsp;at&nbsp;&#34;line&#34;</span><br>
<span class="lineno">35</span><span class="comment" id="5861694">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;preceded&nbsp;by&nbsp;comments&nbsp;because&nbsp;the&nbsp;computation&nbsp;of&nbsp;n&nbsp;assumes</span><br>
<span class="lineno"></span><span class="comment" id="5861769">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;current&nbsp;position&nbsp;before&nbsp;the&nbsp;comment&nbsp;and&nbsp;the&nbsp;target&nbsp;position</span><br>
<span class="lineno"></span><span class="comment" id="5861847">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;after&nbsp;the&nbsp;comment.&nbsp;Thus,&nbsp;after&nbsp;interspersing&nbsp;such&nbsp;comments,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5861925">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;space&nbsp;taken&nbsp;up&nbsp;by&nbsp;them&nbsp;is&nbsp;not&nbsp;considered&nbsp;to&nbsp;reduce&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5862004">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linebreaks.&nbsp;At&nbsp;the&nbsp;moment&nbsp;there&nbsp;is&nbsp;no&nbsp;easy&nbsp;way&nbsp;to&nbsp;know&nbsp;about</span><br>
<span class="lineno">40</span><span class="comment" id="5862079">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;future&nbsp;(not&nbsp;yet&nbsp;interspersed)&nbsp;comments&nbsp;in&nbsp;this&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="5862150">//</span><br>
<span class="lineno"></span><span class="keyword" id="5862153">func</span>&nbsp;<span class="op" id="5862158">(</span><span class="ident" id="5862159">p</span>&nbsp;<span class="op" id="5862161">*</span><span class="ident" id="5862162">printer</span><span class="op" id="5862169">)</span>&nbsp;<span class="ident" id="5862171">linebreak</span><span class="op" id="5862180">(</span><span class="ident" id="5862181">line</span><span class="op" id="5862185">,</span>&nbsp;<span class="ident" id="5862187">min</span>&nbsp;<span class="builtintype" id="5862191">int</span><span class="op" id="5862194">,</span>&nbsp;<span class="ident" id="5862196">ws</span>&nbsp;<span class="ident" id="5862199">whiteSpace</span><span class="op" id="5862209">,</span>&nbsp;<span class="ident" id="5862211">newSection</span>&nbsp;<span class="builtintype" id="5862222">bool</span><span class="op" id="5862226">)</span>&nbsp;<span class="op" id="5862228">(</span><span class="ident" id="5862229">printedBreak</span>&nbsp;<span class="builtintype" id="5862242">bool</span><span class="op" id="5862246">)</span>&nbsp;<span class="op" id="5862248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862251">n</span>&nbsp;<span class="op" id="5862253">:=</span>&nbsp;<span class="ident" id="5862256">nlimit</span><span class="op" id="5862262">(</span><span class="ident" id="5862263">line</span>&nbsp;<span class="op" id="5862268">-</span>&nbsp;<span class="ident" id="5862270">p</span><span class="op" id="5862271">.</span><span class="ident" id="5862272">pos</span><span class="op" id="5862275">.</span><span class="ident" id="5862276">Line</span><span class="op" id="5862280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5862283">if</span>&nbsp;<span class="ident" id="5862286">n</span>&nbsp;<span class="op" id="5862288">&lt;</span>&nbsp;<span class="ident" id="5862290">min</span>&nbsp;<span class="op" id="5862294">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862298">n</span>&nbsp;<span class="op" id="5862300">=</span>&nbsp;<span class="ident" id="5862302">min</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5862307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5862310">if</span>&nbsp;<span class="ident" id="5862313">n</span>&nbsp;<span class="op" id="5862315">&gt;</span>&nbsp;<span class="num" id="5862317">0</span>&nbsp;<span class="op" id="5862319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862323">p</span><span class="op" id="5862324">.</span><span class="builtinfunc" id="5862325">print</span><span class="op" id="5862330">(</span><span class="ident" id="5862331">ws</span><span class="op" id="5862333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5862337">if</span>&nbsp;<span class="ident" id="5862340">newSection</span>&nbsp;<span class="op" id="5862351">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862356">p</span><span class="op" id="5862357">.</span><span class="builtinfunc" id="5862358">print</span><span class="op" id="5862363">(</span><span class="ident" id="5862364">formfeed</span><span class="op" id="5862372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862377">n</span><span class="op" id="5862378">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5862383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5862387">for</span>&nbsp;<span class="op" id="5862391">;</span>&nbsp;<span class="ident" id="5862393">n</span>&nbsp;<span class="op" id="5862395">&gt;</span>&nbsp;<span class="num" id="5862397">0</span><span class="op" id="5862398">;</span>&nbsp;<span class="ident" id="5862400">n</span><span class="op" id="5862401">--</span>&nbsp;<span class="op" id="5862404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862409">p</span><span class="op" id="5862410">.</span><span class="builtinfunc" id="5862411">print</span><span class="op" id="5862416">(</span><span class="ident" id="5862417">newline</span><span class="op" id="5862424">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5862428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862432">printedBreak</span>&nbsp;<span class="op" id="5862445">=</span>&nbsp;<span class="builtintype" id="5862447">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5862453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5862456">return</span><br>
<span class="lineno"></span><span class="op" id="5862463">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="5862466">//&nbsp;setComment&nbsp;sets&nbsp;g&nbsp;as&nbsp;the&nbsp;next&nbsp;comment&nbsp;if&nbsp;g&nbsp;!=&nbsp;nil&nbsp;and&nbsp;if&nbsp;node&nbsp;comments</span><br>
<span class="lineno"></span><span class="comment" id="5862540">//&nbsp;are&nbsp;enabled&nbsp;-&nbsp;this&nbsp;mode&nbsp;is&nbsp;used&nbsp;when&nbsp;printing&nbsp;source&nbsp;code&nbsp;fragments&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5862616">//&nbsp;as&nbsp;exports&nbsp;only.&nbsp;It&nbsp;assumes&nbsp;that&nbsp;there&nbsp;is&nbsp;no&nbsp;pending&nbsp;comment&nbsp;in&nbsp;p.comments</span><br>
<span class="lineno"></span><span class="comment" id="5862694">//&nbsp;and&nbsp;at&nbsp;most&nbsp;one&nbsp;pending&nbsp;comment&nbsp;in&nbsp;the&nbsp;p.comment&nbsp;cache.</span><br>
<span class="lineno">65</span><span class="keyword" id="5862753">func</span>&nbsp;<span class="op" id="5862758">(</span><span class="ident" id="5862759">p</span>&nbsp;<span class="op" id="5862761">*</span><span class="ident" id="5862762">printer</span><span class="op" id="5862769">)</span>&nbsp;<span class="ident" id="5862771">setComment</span><span class="op" id="5862781">(</span><span class="ident" id="5862782">g</span>&nbsp;<span class="op" id="5862784">*</span><span class="ident" id="5862785">ast</span><span class="op" id="5862788">.</span><span class="ident" id="5862789">CommentGroup</span><span class="op" id="5862801">)</span>&nbsp;<span class="op" id="5862803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5862806">if</span>&nbsp;<span class="ident" id="5862809">g</span>&nbsp;<span class="op" id="5862811">==</span>&nbsp;<span class="ident" id="5862814">nil</span>&nbsp;<span class="op" id="5862818">||</span>&nbsp;<span class="op" id="5862821">!</span><span class="ident" id="5862822">p</span><span class="op" id="5862823">.</span><span class="ident" id="5862824">useNodeComments</span>&nbsp;<span class="op" id="5862840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5862844">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5862852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5862855">if</span>&nbsp;<span class="ident" id="5862858">p</span><span class="op" id="5862859">.</span><span class="ident" id="5862860">comments</span>&nbsp;<span class="op" id="5862869">==</span>&nbsp;<span class="ident" id="5862872">nil</span>&nbsp;<span class="op" id="5862876">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5862880">//&nbsp;initialize&nbsp;p.comments&nbsp;lazily</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862914">p</span><span class="op" id="5862915">.</span><span class="ident" id="5862916">comments</span>&nbsp;<span class="op" id="5862925">=</span>&nbsp;<span class="builtinfunc" id="5862927">make</span><span class="op" id="5862931">(</span><span class="op" id="5862932">[</span><span class="op" id="5862933">]</span><span class="op" id="5862934">*</span><span class="ident" id="5862935">ast</span><span class="op" id="5862938">.</span><span class="ident" id="5862939">CommentGroup</span><span class="op" id="5862951">,</span>&nbsp;<span class="num" id="5862953">1</span><span class="op" id="5862954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5862957">}</span>&nbsp;<span class="keyword" id="5862959">else</span>&nbsp;<span class="keyword" id="5862964">if</span>&nbsp;<span class="ident" id="5862967">p</span><span class="op" id="5862968">.</span><span class="ident" id="5862969">cindex</span>&nbsp;<span class="op" id="5862976">&lt;</span>&nbsp;<span class="builtinfunc" id="5862978">len</span><span class="op" id="5862981">(</span><span class="ident" id="5862982">p</span><span class="op" id="5862983">.</span><span class="ident" id="5862984">comments</span><span class="op" id="5862992">)</span>&nbsp;<span class="op" id="5862994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5862998">//&nbsp;for&nbsp;some&nbsp;reason&nbsp;there&nbsp;are&nbsp;pending&nbsp;comments;&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5863052">//&nbsp;should&nbsp;never&nbsp;happen&nbsp;-&nbsp;handle&nbsp;gracefully&nbsp;and&nbsp;flush</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5863107">//&nbsp;all&nbsp;comments&nbsp;up&nbsp;to&nbsp;g,&nbsp;ignore&nbsp;anything&nbsp;after&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5863161">p</span><span class="op" id="5863162">.</span><span class="ident" id="5863163">flush</span><span class="op" id="5863168">(</span><span class="ident" id="5863169">p</span><span class="op" id="5863170">.</span><span class="ident" id="5863171">posFor</span><span class="op" id="5863177">(</span><span class="ident" id="5863178">g</span><span class="op" id="5863179">.</span><span class="ident" id="5863180">List</span><span class="op" id="5863184">[</span><span class="num" id="5863185">0</span><span class="op" id="5863186">]</span><span class="op" id="5863187">.</span><span class="ident" id="5863188">Pos</span><span class="op" id="5863191">(</span><span class="op" id="5863192">)</span><span class="op" id="5863193">)</span><span class="op" id="5863194">,</span>&nbsp;<span class="ident" id="5863196">token</span><span class="op" id="5863201">.</span><span class="ident" id="5863202">ILLEGAL</span><span class="op" id="5863209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5863213">p</span><span class="op" id="5863214">.</span><span class="ident" id="5863215">comments</span>&nbsp;<span class="op" id="5863224">=</span>&nbsp;<span class="ident" id="5863226">p</span><span class="op" id="5863227">.</span><span class="ident" id="5863228">comments</span><span class="op" id="5863236">[</span><span class="num" id="5863237">0</span><span class="op" id="5863238">:</span><span class="num" id="5863239">1</span><span class="op" id="5863240">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5863244">//&nbsp;in&nbsp;debug&nbsp;mode,&nbsp;report&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5863277">p</span><span class="op" id="5863278">.</span><span class="ident" id="5863279">internalError</span><span class="op" id="5863292">(</span><span class="string" id="5863293">&#34;setComment&nbsp;found&nbsp;pending&nbsp;comments&#34;</span><span class="op" id="5863328">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5863331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5863334">p</span><span class="op" id="5863335">.</span><span class="ident" id="5863336">comments</span><span class="op" id="5863344">[</span><span class="num" id="5863345">0</span><span class="op" id="5863346">]</span>&nbsp;<span class="op" id="5863348">=</span>&nbsp;<span class="ident" id="5863350">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5863353">p</span><span class="op" id="5863354">.</span><span class="ident" id="5863355">cindex</span>&nbsp;<span class="op" id="5863362">=</span>&nbsp;<span class="num" id="5863364">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5863367">//&nbsp;don&#39;t&nbsp;overwrite&nbsp;any&nbsp;pending&nbsp;comment&nbsp;in&nbsp;the&nbsp;p.comment&nbsp;cache</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5863430">//&nbsp;(there&nbsp;may&nbsp;be&nbsp;a&nbsp;pending&nbsp;comment&nbsp;when&nbsp;a&nbsp;line&nbsp;comment&nbsp;is</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5863489">//&nbsp;immediately&nbsp;followed&nbsp;by&nbsp;a&nbsp;lead&nbsp;comment&nbsp;with&nbsp;no&nbsp;other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5863546">//&nbsp;tokens&nbsp;between)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5863566">if</span>&nbsp;<span class="ident" id="5863569">p</span><span class="op" id="5863570">.</span><span class="ident" id="5863571">commentOffset</span>&nbsp;<span class="op" id="5863585">==</span>&nbsp;<span class="ident" id="5863588">infinity</span>&nbsp;<span class="op" id="5863597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5863601">p</span><span class="op" id="5863602">.</span><span class="ident" id="5863603">nextComment</span><span class="op" id="5863614">(</span><span class="op" id="5863615">)</span>&nbsp;<span class="comment" id="5863617">//&nbsp;get&nbsp;comment&nbsp;ready&nbsp;for&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5863647">}</span><br>
<span class="lineno">90</span><span class="op" id="5863649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5863652">type</span>&nbsp;<span class="ident" id="5863657">exprListMode</span>&nbsp;<span class="builtintype" id="5863670">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5863676">const</span>&nbsp;<span class="op" id="5863682">(</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5863685">commaTerm</span>&nbsp;<span class="ident" id="5863695">exprListMode</span>&nbsp;<span class="op" id="5863708">=</span>&nbsp;<span class="num" id="5863710">1</span>&nbsp;<span class="op" id="5863712">&lt;&lt;</span>&nbsp;<span class="ident" id="5863715">iota</span>&nbsp;<span class="comment" id="5863720">//&nbsp;list&nbsp;is&nbsp;optionally&nbsp;terminated&nbsp;by&nbsp;a&nbsp;comma</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5863765">noIndent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5863800">//&nbsp;no&nbsp;extra&nbsp;indentation&nbsp;in&nbsp;multi-line&nbsp;lists</span><br>
<span class="lineno"></span><span class="op" id="5863844">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5863847">//&nbsp;If&nbsp;indent&nbsp;is&nbsp;set,&nbsp;a&nbsp;multi-line&nbsp;identifier&nbsp;list&nbsp;is&nbsp;indented&nbsp;after&nbsp;the</span><br>
<span class="lineno">100</span><span class="comment" id="5863919">//&nbsp;first&nbsp;linebreak&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="keyword" id="5863951">func</span>&nbsp;<span class="op" id="5863956">(</span><span class="ident" id="5863957">p</span>&nbsp;<span class="op" id="5863959">*</span><span class="ident" id="5863960">printer</span><span class="op" id="5863967">)</span>&nbsp;<span class="ident" id="5863969">identList</span><span class="op" id="5863978">(</span><span class="ident" id="5863979">list</span>&nbsp;<span class="op" id="5863984">[</span><span class="op" id="5863985">]</span><span class="op" id="5863986">*</span><span class="ident" id="5863987">ast</span><span class="op" id="5863990">.</span><span class="ident" id="5863991">Ident</span><span class="op" id="5863996">,</span>&nbsp;<span class="ident" id="5863998">indent</span>&nbsp;<span class="builtintype" id="5864005">bool</span><span class="op" id="5864009">)</span>&nbsp;<span class="op" id="5864011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5864014">//&nbsp;convert&nbsp;into&nbsp;an&nbsp;expression&nbsp;list&nbsp;so&nbsp;we&nbsp;can&nbsp;re-use&nbsp;exprList&nbsp;formatting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864087">xlist</span>&nbsp;<span class="op" id="5864093">:=</span>&nbsp;<span class="builtinfunc" id="5864096">make</span><span class="op" id="5864100">(</span><span class="op" id="5864101">[</span><span class="op" id="5864102">]</span><span class="ident" id="5864103">ast</span><span class="op" id="5864106">.</span><span class="ident" id="5864107">Expr</span><span class="op" id="5864111">,</span>&nbsp;<span class="builtinfunc" id="5864113">len</span><span class="op" id="5864116">(</span><span class="ident" id="5864117">list</span><span class="op" id="5864121">)</span><span class="op" id="5864122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5864125">for</span>&nbsp;<span class="ident" id="5864129">i</span><span class="op" id="5864130">,</span>&nbsp;<span class="ident" id="5864132">x</span>&nbsp;<span class="op" id="5864134">:=</span>&nbsp;<span class="keyword" id="5864137">range</span>&nbsp;<span class="ident" id="5864143">list</span>&nbsp;<span class="op" id="5864148">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864152">xlist</span><span class="op" id="5864157">[</span><span class="ident" id="5864158">i</span><span class="op" id="5864159">]</span>&nbsp;<span class="op" id="5864161">=</span>&nbsp;<span class="ident" id="5864163">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5864166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5864169">var</span>&nbsp;<span class="ident" id="5864173">mode</span>&nbsp;<span class="ident" id="5864178">exprListMode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5864192">if</span>&nbsp;<span class="op" id="5864195">!</span><span class="ident" id="5864196">indent</span>&nbsp;<span class="op" id="5864203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864207">mode</span>&nbsp;<span class="op" id="5864212">=</span>&nbsp;<span class="ident" id="5864214">noIndent</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5864224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864227">p</span><span class="op" id="5864228">.</span><span class="ident" id="5864229">exprList</span><span class="op" id="5864237">(</span><span class="ident" id="5864238">token</span><span class="op" id="5864243">.</span><span class="ident" id="5864244">NoPos</span><span class="op" id="5864249">,</span>&nbsp;<span class="ident" id="5864251">xlist</span><span class="op" id="5864256">,</span>&nbsp;<span class="num" id="5864258">1</span><span class="op" id="5864259">,</span>&nbsp;<span class="ident" id="5864261">mode</span><span class="op" id="5864265">,</span>&nbsp;<span class="ident" id="5864267">token</span><span class="op" id="5864272">.</span><span class="ident" id="5864273">NoPos</span><span class="op" id="5864278">)</span><br>
<span class="lineno"></span><span class="op" id="5864280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5864283">//&nbsp;Print&nbsp;a&nbsp;list&nbsp;of&nbsp;expressions.&nbsp;If&nbsp;the&nbsp;list&nbsp;spans&nbsp;multiple</span><br>
<span class="lineno">115</span><span class="comment" id="5864342">//&nbsp;source&nbsp;lines,&nbsp;the&nbsp;original&nbsp;line&nbsp;breaks&nbsp;are&nbsp;respected&nbsp;between</span><br>
<span class="lineno"></span><span class="comment" id="5864406">//&nbsp;expressions.</span><br>
<span class="lineno"></span><span class="comment" id="5864422">//</span><br>
<span class="lineno"></span><span class="comment" id="5864425">//&nbsp;TODO(gri)&nbsp;Consider&nbsp;rewriting&nbsp;this&nbsp;to&nbsp;be&nbsp;independent&nbsp;of&nbsp;[]ast.Expr</span><br>
<span class="lineno"></span><span class="comment" id="5864494">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;so&nbsp;that&nbsp;we&nbsp;can&nbsp;use&nbsp;the&nbsp;algorithm&nbsp;for&nbsp;any&nbsp;kind&nbsp;of&nbsp;list</span><br>
<span class="lineno">120</span><span class="comment" id="5864561">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(e.g.,&nbsp;pass&nbsp;list&nbsp;via&nbsp;a&nbsp;channel&nbsp;over&nbsp;which&nbsp;to&nbsp;range).</span><br>
<span class="lineno"></span><span class="keyword" id="5864627">func</span>&nbsp;<span class="op" id="5864632">(</span><span class="ident" id="5864633">p</span>&nbsp;<span class="op" id="5864635">*</span><span class="ident" id="5864636">printer</span><span class="op" id="5864643">)</span>&nbsp;<span class="ident" id="5864645">exprList</span><span class="op" id="5864653">(</span><span class="ident" id="5864654">prev0</span>&nbsp;<span class="ident" id="5864660">token</span><span class="op" id="5864665">.</span><span class="ident" id="5864666">Pos</span><span class="op" id="5864669">,</span>&nbsp;<span class="ident" id="5864671">list</span>&nbsp;<span class="op" id="5864676">[</span><span class="op" id="5864677">]</span><span class="ident" id="5864678">ast</span><span class="op" id="5864681">.</span><span class="ident" id="5864682">Expr</span><span class="op" id="5864686">,</span>&nbsp;<span class="ident" id="5864688">depth</span>&nbsp;<span class="builtintype" id="5864694">int</span><span class="op" id="5864697">,</span>&nbsp;<span class="ident" id="5864699">mode</span>&nbsp;<span class="ident" id="5864704">exprListMode</span><span class="op" id="5864716">,</span>&nbsp;<span class="ident" id="5864718">next0</span>&nbsp;<span class="ident" id="5864724">token</span><span class="op" id="5864729">.</span><span class="ident" id="5864730">Pos</span><span class="op" id="5864733">)</span>&nbsp;<span class="op" id="5864735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5864738">if</span>&nbsp;<span class="builtinfunc" id="5864741">len</span><span class="op" id="5864744">(</span><span class="ident" id="5864745">list</span><span class="op" id="5864749">)</span>&nbsp;<span class="op" id="5864751">==</span>&nbsp;<span class="num" id="5864754">0</span>&nbsp;<span class="op" id="5864756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5864760">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5864768">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864772">prev</span>&nbsp;<span class="op" id="5864777">:=</span>&nbsp;<span class="ident" id="5864780">p</span><span class="op" id="5864781">.</span><span class="ident" id="5864782">posFor</span><span class="op" id="5864788">(</span><span class="ident" id="5864789">prev0</span><span class="op" id="5864794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864797">next</span>&nbsp;<span class="op" id="5864802">:=</span>&nbsp;<span class="ident" id="5864805">p</span><span class="op" id="5864806">.</span><span class="ident" id="5864807">posFor</span><span class="op" id="5864813">(</span><span class="ident" id="5864814">next0</span><span class="op" id="5864819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864822">line</span>&nbsp;<span class="op" id="5864827">:=</span>&nbsp;<span class="ident" id="5864830">p</span><span class="op" id="5864831">.</span><span class="ident" id="5864832">lineFor</span><span class="op" id="5864839">(</span><span class="ident" id="5864840">list</span><span class="op" id="5864844">[</span><span class="num" id="5864845">0</span><span class="op" id="5864846">]</span><span class="op" id="5864847">.</span><span class="ident" id="5864848">Pos</span><span class="op" id="5864851">(</span><span class="op" id="5864852">)</span><span class="op" id="5864853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864856">endLine</span>&nbsp;<span class="op" id="5864864">:=</span>&nbsp;<span class="ident" id="5864867">p</span><span class="op" id="5864868">.</span><span class="ident" id="5864869">lineFor</span><span class="op" id="5864876">(</span><span class="ident" id="5864877">list</span><span class="op" id="5864881">[</span><span class="builtinfunc" id="5864882">len</span><span class="op" id="5864885">(</span><span class="ident" id="5864886">list</span><span class="op" id="5864890">)</span><span class="op" id="5864891">-</span><span class="num" id="5864892">1</span><span class="op" id="5864893">]</span><span class="op" id="5864894">.</span><span class="ident" id="5864895">End</span><span class="op" id="5864898">(</span><span class="op" id="5864899">)</span><span class="op" id="5864900">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5864904">if</span>&nbsp;<span class="ident" id="5864907">prev</span><span class="op" id="5864911">.</span><span class="ident" id="5864912">IsValid</span><span class="op" id="5864919">(</span><span class="op" id="5864920">)</span>&nbsp;<span class="op" id="5864922">&amp;&amp;</span>&nbsp;<span class="ident" id="5864925">prev</span><span class="op" id="5864929">.</span><span class="ident" id="5864930">Line</span>&nbsp;<span class="op" id="5864935">==</span>&nbsp;<span class="ident" id="5864938">line</span>&nbsp;<span class="op" id="5864943">&amp;&amp;</span>&nbsp;<span class="ident" id="5864946">line</span>&nbsp;<span class="op" id="5864951">==</span>&nbsp;<span class="ident" id="5864954">endLine</span>&nbsp;<span class="op" id="5864962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5864966">//&nbsp;all&nbsp;list&nbsp;entries&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865005">for</span>&nbsp;<span class="ident" id="5865009">i</span><span class="op" id="5865010">,</span>&nbsp;<span class="ident" id="5865012">x</span>&nbsp;<span class="op" id="5865014">:=</span>&nbsp;<span class="keyword" id="5865017">range</span>&nbsp;<span class="ident" id="5865023">list</span>&nbsp;<span class="op" id="5865028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865033">if</span>&nbsp;<span class="ident" id="5865036">i</span>&nbsp;<span class="op" id="5865038">&gt;</span>&nbsp;<span class="num" id="5865040">0</span>&nbsp;<span class="op" id="5865042">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5865048">//&nbsp;use&nbsp;position&nbsp;of&nbsp;expression&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5865105">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5865157">p</span><span class="op" id="5865158">.</span><span class="builtinfunc" id="5865159">print</span><span class="op" id="5865164">(</span><span class="ident" id="5865165">x</span><span class="op" id="5865166">.</span><span class="ident" id="5865167">Pos</span><span class="op" id="5865170">(</span><span class="op" id="5865171">)</span><span class="op" id="5865172">,</span>&nbsp;<span class="ident" id="5865174">token</span><span class="op" id="5865179">.</span><span class="ident" id="5865180">COMMA</span><span class="op" id="5865185">,</span>&nbsp;<span class="ident" id="5865187">blank</span><span class="op" id="5865192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5865197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5865202">p</span><span class="op" id="5865203">.</span><span class="ident" id="5865204">expr0</span><span class="op" id="5865209">(</span><span class="ident" id="5865210">x</span><span class="op" id="5865211">,</span>&nbsp;<span class="ident" id="5865213">depth</span><span class="op" id="5865218">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5865222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865226">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5865234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5865238">//&nbsp;list&nbsp;entries&nbsp;span&nbsp;multiple&nbsp;lines;</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5865276">//&nbsp;use&nbsp;source&nbsp;code&nbsp;positions&nbsp;to&nbsp;guide&nbsp;line&nbsp;breaks</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5865328">//&nbsp;don&#39;t&nbsp;add&nbsp;extra&nbsp;indentation&nbsp;if&nbsp;noIndent&nbsp;is&nbsp;set;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5865380">//&nbsp;i.e.,&nbsp;pretend&nbsp;that&nbsp;the&nbsp;first&nbsp;line&nbsp;is&nbsp;already&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5865438">ws</span>&nbsp;<span class="op" id="5865441">:=</span>&nbsp;<span class="ident" id="5865444">ignore</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865452">if</span>&nbsp;<span class="ident" id="5865455">mode</span><span class="op" id="5865459">&amp;</span><span class="ident" id="5865460">noIndent</span>&nbsp;<span class="op" id="5865469">==</span>&nbsp;<span class="num" id="5865472">0</span>&nbsp;<span class="op" id="5865474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5865478">ws</span>&nbsp;<span class="op" id="5865481">=</span>&nbsp;<span class="ident" id="5865483">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5865491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5865495">//&nbsp;the&nbsp;first&nbsp;linebreak&nbsp;is&nbsp;always&nbsp;a&nbsp;formfeed&nbsp;since&nbsp;this&nbsp;section&nbsp;must&nbsp;not</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5865568">//&nbsp;depend&nbsp;on&nbsp;any&nbsp;previous&nbsp;formatting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5865606">prevBreak</span>&nbsp;<span class="op" id="5865616">:=</span>&nbsp;<span class="op" id="5865619">-</span><span class="num" id="5865620">1</span>&nbsp;<span class="comment" id="5865622">//&nbsp;index&nbsp;of&nbsp;last&nbsp;expression&nbsp;that&nbsp;was&nbsp;followed&nbsp;by&nbsp;a&nbsp;linebreak</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865684">if</span>&nbsp;<span class="ident" id="5865687">prev</span><span class="op" id="5865691">.</span><span class="ident" id="5865692">IsValid</span><span class="op" id="5865699">(</span><span class="op" id="5865700">)</span>&nbsp;<span class="op" id="5865702">&amp;&amp;</span>&nbsp;<span class="ident" id="5865705">prev</span><span class="op" id="5865709">.</span><span class="ident" id="5865710">Line</span>&nbsp;<span class="op" id="5865715">&lt;</span>&nbsp;<span class="ident" id="5865717">line</span>&nbsp;<span class="op" id="5865722">&amp;&amp;</span>&nbsp;<span class="ident" id="5865725">p</span><span class="op" id="5865726">.</span><span class="ident" id="5865727">linebreak</span><span class="op" id="5865736">(</span><span class="ident" id="5865737">line</span><span class="op" id="5865741">,</span>&nbsp;<span class="num" id="5865743">0</span><span class="op" id="5865744">,</span>&nbsp;<span class="ident" id="5865746">ws</span><span class="op" id="5865748">,</span>&nbsp;<span class="builtintype" id="5865750">true</span><span class="op" id="5865754">)</span>&nbsp;<span class="op" id="5865756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5865760">ws</span>&nbsp;<span class="op" id="5865763">=</span>&nbsp;<span class="ident" id="5865765">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5865774">prevBreak</span>&nbsp;<span class="op" id="5865784">=</span>&nbsp;<span class="num" id="5865786">0</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5865789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5865793">//&nbsp;initialize&nbsp;expression/key&nbsp;size:&nbsp;a&nbsp;zero&nbsp;value&nbsp;indicates&nbsp;expr/key&nbsp;doesn&#39;t&nbsp;fit&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5865890">size</span>&nbsp;<span class="op" id="5865895">:=</span>&nbsp;<span class="num" id="5865898">0</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5865902">//&nbsp;print&nbsp;all&nbsp;list&nbsp;elements</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5865930">prevLine</span>&nbsp;<span class="op" id="5865939">:=</span>&nbsp;<span class="ident" id="5865942">prev</span><span class="op" id="5865946">.</span><span class="ident" id="5865947">Line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865953">for</span>&nbsp;<span class="ident" id="5865957">i</span><span class="op" id="5865958">,</span>&nbsp;<span class="ident" id="5865960">x</span>&nbsp;<span class="op" id="5865962">:=</span>&nbsp;<span class="keyword" id="5865965">range</span>&nbsp;<span class="ident" id="5865971">list</span>&nbsp;<span class="op" id="5865976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5865980">line</span>&nbsp;<span class="op" id="5865985">=</span>&nbsp;<span class="ident" id="5865987">p</span><span class="op" id="5865988">.</span><span class="ident" id="5865989">lineFor</span><span class="op" id="5865996">(</span><span class="ident" id="5865997">x</span><span class="op" id="5865998">.</span><span class="ident" id="5865999">Pos</span><span class="op" id="5866002">(</span><span class="op" id="5866003">)</span><span class="op" id="5866004">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5866009">//&nbsp;determine&nbsp;if&nbsp;the&nbsp;next&nbsp;linebreak,&nbsp;if&nbsp;any,&nbsp;needs&nbsp;to&nbsp;use&nbsp;formfeed:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5866078">//&nbsp;in&nbsp;general,&nbsp;use&nbsp;the&nbsp;entire&nbsp;node&nbsp;size&nbsp;to&nbsp;make&nbsp;the&nbsp;decision;&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5866146">//&nbsp;key:value&nbsp;expressions,&nbsp;use&nbsp;the&nbsp;key&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5866191">//&nbsp;TODO(gri)&nbsp;for&nbsp;a&nbsp;better&nbsp;result,&nbsp;should&nbsp;probably&nbsp;incorporate&nbsp;both</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5866260">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;key&nbsp;and&nbsp;the&nbsp;node&nbsp;size&nbsp;into&nbsp;the&nbsp;decision&nbsp;process</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5866327">useFF</span>&nbsp;<span class="op" id="5866333">:=</span>&nbsp;<span class="builtintype" id="5866336">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5866344">//&nbsp;determine&nbsp;element&nbsp;size:&nbsp;all&nbsp;bets&nbsp;are&nbsp;off&nbsp;if&nbsp;we&nbsp;don&#39;t&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5866407">//&nbsp;position&nbsp;information&nbsp;for&nbsp;the&nbsp;previous&nbsp;and&nbsp;next&nbsp;token&nbsp;(likely</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5866473">//&nbsp;generated&nbsp;code&nbsp;-&nbsp;simply&nbsp;ignore&nbsp;the&nbsp;size&nbsp;in&nbsp;this&nbsp;case&nbsp;by&nbsp;setting</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5866542">//&nbsp;it&nbsp;to&nbsp;0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5866556">prevSize</span>&nbsp;<span class="op" id="5866565">:=</span>&nbsp;<span class="ident" id="5866568">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5866575">const</span>&nbsp;<span class="ident" id="5866581">infinity</span>&nbsp;<span class="op" id="5866590">=</span>&nbsp;<span class="num" id="5866592">1e6</span>&nbsp;<span class="comment" id="5866596">//&nbsp;larger&nbsp;than&nbsp;any&nbsp;source&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5866629">size</span>&nbsp;<span class="op" id="5866634">=</span>&nbsp;<span class="ident" id="5866636">p</span><span class="op" id="5866637">.</span><span class="ident" id="5866638">nodeSize</span><span class="op" id="5866646">(</span><span class="ident" id="5866647">x</span><span class="op" id="5866648">,</span>&nbsp;<span class="ident" id="5866650">infinity</span><span class="op" id="5866658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5866662">pair</span><span class="op" id="5866666">,</span>&nbsp;<span class="ident" id="5866668">isPair</span>&nbsp;<span class="op" id="5866675">:=</span>&nbsp;<span class="ident" id="5866678">x</span><span class="op" id="5866679">.</span><span class="op" id="5866680">(</span><span class="op" id="5866681">*</span><span class="ident" id="5866682">ast</span><span class="op" id="5866685">.</span><span class="ident" id="5866686">KeyValueExpr</span><span class="op" id="5866698">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5866702">if</span>&nbsp;<span class="ident" id="5866705">size</span>&nbsp;<span class="op" id="5866710">&lt;=</span>&nbsp;<span class="ident" id="5866713">infinity</span>&nbsp;<span class="op" id="5866722">&amp;&amp;</span>&nbsp;<span class="ident" id="5866725">prev</span><span class="op" id="5866729">.</span><span class="ident" id="5866730">IsValid</span><span class="op" id="5866737">(</span><span class="op" id="5866738">)</span>&nbsp;<span class="op" id="5866740">&amp;&amp;</span>&nbsp;<span class="ident" id="5866743">next</span><span class="op" id="5866747">.</span><span class="ident" id="5866748">IsValid</span><span class="op" id="5866755">(</span><span class="op" id="5866756">)</span>&nbsp;<span class="op" id="5866758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5866763">//&nbsp;x&nbsp;fits&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5866793">if</span>&nbsp;<span class="ident" id="5866796">isPair</span>&nbsp;<span class="op" id="5866803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5866809">size</span>&nbsp;<span class="op" id="5866814">=</span>&nbsp;<span class="ident" id="5866816">p</span><span class="op" id="5866817">.</span><span class="ident" id="5866818">nodeSize</span><span class="op" id="5866826">(</span><span class="ident" id="5866827">pair</span><span class="op" id="5866831">.</span><span class="ident" id="5866832">Key</span><span class="op" id="5866835">,</span>&nbsp;<span class="ident" id="5866837">infinity</span><span class="op" id="5866845">)</span>&nbsp;<span class="comment" id="5866847">//&nbsp;size&nbsp;&lt;=&nbsp;infinity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5866870">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5866874">}</span>&nbsp;<span class="keyword" id="5866876">else</span>&nbsp;<span class="op" id="5866881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5866886">//&nbsp;size&nbsp;too&nbsp;large&nbsp;or&nbsp;we&nbsp;don&#39;t&nbsp;have&nbsp;good&nbsp;layout&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5866948">size</span>&nbsp;<span class="op" id="5866953">=</span>&nbsp;<span class="num" id="5866955">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5866959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5866964">//&nbsp;if&nbsp;the&nbsp;previous&nbsp;line&nbsp;and&nbsp;the&nbsp;current&nbsp;line&nbsp;had&nbsp;single-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867023">//&nbsp;line-expressions&nbsp;and&nbsp;the&nbsp;key&nbsp;sizes&nbsp;are&nbsp;small&nbsp;or&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867080">//&nbsp;the&nbsp;ratio&nbsp;between&nbsp;the&nbsp;key&nbsp;sizes&nbsp;does&nbsp;not&nbsp;exceed&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867135">//&nbsp;threshold,&nbsp;align&nbsp;columns&nbsp;and&nbsp;do&nbsp;not&nbsp;use&nbsp;formfeed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5867189">if</span>&nbsp;<span class="ident" id="5867192">prevSize</span>&nbsp;<span class="op" id="5867201">&gt;</span>&nbsp;<span class="num" id="5867203">0</span>&nbsp;<span class="op" id="5867205">&amp;&amp;</span>&nbsp;<span class="ident" id="5867208">size</span>&nbsp;<span class="op" id="5867213">&gt;</span>&nbsp;<span class="num" id="5867215">0</span>&nbsp;<span class="op" id="5867217">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5867222">const</span>&nbsp;<span class="ident" id="5867228">smallSize</span>&nbsp;<span class="op" id="5867238">=</span>&nbsp;<span class="num" id="5867240">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5867246">if</span>&nbsp;<span class="ident" id="5867249">prevSize</span>&nbsp;<span class="op" id="5867258">&lt;=</span>&nbsp;<span class="ident" id="5867261">smallSize</span>&nbsp;<span class="op" id="5867271">&amp;&amp;</span>&nbsp;<span class="ident" id="5867274">size</span>&nbsp;<span class="op" id="5867279">&lt;=</span>&nbsp;<span class="ident" id="5867282">smallSize</span>&nbsp;<span class="op" id="5867292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867298">useFF</span>&nbsp;<span class="op" id="5867304">=</span>&nbsp;<span class="builtintype" id="5867306">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5867315">}</span>&nbsp;<span class="keyword" id="5867317">else</span>&nbsp;<span class="op" id="5867322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5867328">const</span>&nbsp;<span class="ident" id="5867334">r</span>&nbsp;<span class="op" id="5867336">=</span>&nbsp;<span class="num" id="5867338">4</span>&nbsp;<span class="comment" id="5867340">//&nbsp;threshold</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867357">ratio</span>&nbsp;<span class="op" id="5867363">:=</span>&nbsp;<span class="builtintype" id="5867366">float64</span><span class="op" id="5867373">(</span><span class="ident" id="5867374">size</span><span class="op" id="5867378">)</span>&nbsp;<span class="op" id="5867380">/</span>&nbsp;<span class="builtintype" id="5867382">float64</span><span class="op" id="5867389">(</span><span class="ident" id="5867390">prevSize</span><span class="op" id="5867398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867404">useFF</span>&nbsp;<span class="op" id="5867410">=</span>&nbsp;<span class="ident" id="5867412">ratio</span>&nbsp;<span class="op" id="5867418">&lt;=</span>&nbsp;<span class="num" id="5867421">1.0</span><span class="op" id="5867424">/</span><span class="ident" id="5867425">r</span>&nbsp;<span class="op" id="5867427">||</span>&nbsp;<span class="ident" id="5867430">r</span>&nbsp;<span class="op" id="5867432">&lt;=</span>&nbsp;<span class="ident" id="5867435">ratio</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5867444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5867448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867453">needsLinebreak</span>&nbsp;<span class="op" id="5867468">:=</span>&nbsp;<span class="num" id="5867471">0</span>&nbsp;<span class="op" id="5867473">&lt;</span>&nbsp;<span class="ident" id="5867475">prevLine</span>&nbsp;<span class="op" id="5867484">&amp;&amp;</span>&nbsp;<span class="ident" id="5867487">prevLine</span>&nbsp;<span class="op" id="5867496">&lt;</span>&nbsp;<span class="ident" id="5867498">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5867505">if</span>&nbsp;<span class="ident" id="5867508">i</span>&nbsp;<span class="op" id="5867510">&gt;</span>&nbsp;<span class="num" id="5867512">0</span>&nbsp;<span class="op" id="5867514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867519">//&nbsp;use&nbsp;position&nbsp;of&nbsp;expression&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867575">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867631">//&nbsp;only&nbsp;if&nbsp;the&nbsp;expression&nbsp;is&nbsp;on&nbsp;the&nbsp;same&nbsp;line</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5867680">if</span>&nbsp;<span class="op" id="5867683">!</span><span class="ident" id="5867684">needsLinebreak</span>&nbsp;<span class="op" id="5867699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867705">p</span><span class="op" id="5867706">.</span><span class="builtinfunc" id="5867707">print</span><span class="op" id="5867712">(</span><span class="ident" id="5867713">x</span><span class="op" id="5867714">.</span><span class="ident" id="5867715">Pos</span><span class="op" id="5867718">(</span><span class="op" id="5867719">)</span><span class="op" id="5867720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5867725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867730">p</span><span class="op" id="5867731">.</span><span class="builtinfunc" id="5867732">print</span><span class="op" id="5867737">(</span><span class="ident" id="5867738">token</span><span class="op" id="5867743">.</span><span class="ident" id="5867744">COMMA</span><span class="op" id="5867749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867754">needsBlank</span>&nbsp;<span class="op" id="5867765">:=</span>&nbsp;<span class="builtintype" id="5867768">true</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5867776">if</span>&nbsp;<span class="ident" id="5867779">needsLinebreak</span>&nbsp;<span class="op" id="5867794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867800">//&nbsp;lines&nbsp;are&nbsp;broken&nbsp;using&nbsp;newlines&nbsp;so&nbsp;comments&nbsp;remain&nbsp;aligned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867866">//&nbsp;unless&nbsp;forceFF&nbsp;is&nbsp;set&nbsp;or&nbsp;there&nbsp;are&nbsp;multiple&nbsp;expressions&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867932">//&nbsp;the&nbsp;same&nbsp;line&nbsp;in&nbsp;which&nbsp;case&nbsp;formfeed&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5867984">if</span>&nbsp;<span class="ident" id="5867987">p</span><span class="op" id="5867988">.</span><span class="ident" id="5867989">linebreak</span><span class="op" id="5867998">(</span><span class="ident" id="5867999">line</span><span class="op" id="5868003">,</span>&nbsp;<span class="num" id="5868005">0</span><span class="op" id="5868006">,</span>&nbsp;<span class="ident" id="5868008">ws</span><span class="op" id="5868010">,</span>&nbsp;<span class="ident" id="5868012">useFF</span>&nbsp;<span class="op" id="5868018">||</span>&nbsp;<span class="ident" id="5868021">prevBreak</span><span class="op" id="5868030">+</span><span class="num" id="5868031">1</span>&nbsp;<span class="op" id="5868033">&lt;</span>&nbsp;<span class="ident" id="5868035">i</span><span class="op" id="5868036">)</span>&nbsp;<span class="op" id="5868038">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868045">ws</span>&nbsp;<span class="op" id="5868048">=</span>&nbsp;<span class="ident" id="5868050">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868062">prevBreak</span>&nbsp;<span class="op" id="5868072">=</span>&nbsp;<span class="ident" id="5868074">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868081">needsBlank</span>&nbsp;<span class="op" id="5868092">=</span>&nbsp;<span class="builtintype" id="5868094">false</span>&nbsp;<span class="comment" id="5868100">//&nbsp;we&nbsp;got&nbsp;a&nbsp;line&nbsp;break&nbsp;instead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5868135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5868140">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5868145">if</span>&nbsp;<span class="ident" id="5868148">needsBlank</span>&nbsp;<span class="op" id="5868159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868165">p</span><span class="op" id="5868166">.</span><span class="builtinfunc" id="5868167">print</span><span class="op" id="5868172">(</span><span class="ident" id="5868173">blank</span><span class="op" id="5868178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5868183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5868187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5868192">if</span>&nbsp;<span class="builtinfunc" id="5868195">len</span><span class="op" id="5868198">(</span><span class="ident" id="5868199">list</span><span class="op" id="5868203">)</span>&nbsp;<span class="op" id="5868205">&gt;</span>&nbsp;<span class="num" id="5868207">1</span>&nbsp;<span class="op" id="5868209">&amp;&amp;</span>&nbsp;<span class="ident" id="5868212">isPair</span>&nbsp;<span class="op" id="5868219">&amp;&amp;</span>&nbsp;<span class="ident" id="5868222">size</span>&nbsp;<span class="op" id="5868227">&gt;</span>&nbsp;<span class="num" id="5868229">0</span>&nbsp;<span class="op" id="5868231">&amp;&amp;</span>&nbsp;<span class="ident" id="5868234">needsLinebreak</span>&nbsp;<span class="op" id="5868249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5868254">//&nbsp;we&nbsp;have&nbsp;a&nbsp;key:value&nbsp;expression&nbsp;that&nbsp;fits&nbsp;onto&nbsp;one&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5868315">//&nbsp;and&nbsp;it&#39;s&nbsp;not&nbsp;on&nbsp;the&nbsp;same&nbsp;line&nbsp;as&nbsp;the&nbsp;prior&nbsp;expression:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5868376">//&nbsp;use&nbsp;a&nbsp;column&nbsp;for&nbsp;the&nbsp;key&nbsp;such&nbsp;that&nbsp;consecutive&nbsp;entries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5868437">//&nbsp;can&nbsp;align&nbsp;if&nbsp;possible</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5868465">//&nbsp;(needsLinebreak&nbsp;is&nbsp;set&nbsp;if&nbsp;we&nbsp;started&nbsp;a&nbsp;new&nbsp;line&nbsp;before)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868527">p</span><span class="op" id="5868528">.</span><span class="ident" id="5868529">expr</span><span class="op" id="5868533">(</span><span class="ident" id="5868534">pair</span><span class="op" id="5868538">.</span><span class="ident" id="5868539">Key</span><span class="op" id="5868542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868547">p</span><span class="op" id="5868548">.</span><span class="builtinfunc" id="5868549">print</span><span class="op" id="5868554">(</span><span class="ident" id="5868555">pair</span><span class="op" id="5868559">.</span><span class="ident" id="5868560">Colon</span><span class="op" id="5868565">,</span>&nbsp;<span class="ident" id="5868567">token</span><span class="op" id="5868572">.</span><span class="ident" id="5868573">COLON</span><span class="op" id="5868578">,</span>&nbsp;<span class="ident" id="5868580">vtab</span><span class="op" id="5868584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868589">p</span><span class="op" id="5868590">.</span><span class="ident" id="5868591">expr</span><span class="op" id="5868595">(</span><span class="ident" id="5868596">pair</span><span class="op" id="5868600">.</span><span class="ident" id="5868601">Value</span><span class="op" id="5868606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5868610">}</span>&nbsp;<span class="keyword" id="5868612">else</span>&nbsp;<span class="op" id="5868617">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868622">p</span><span class="op" id="5868623">.</span><span class="ident" id="5868624">expr0</span><span class="op" id="5868629">(</span><span class="ident" id="5868630">x</span><span class="op" id="5868631">,</span>&nbsp;<span class="ident" id="5868633">depth</span><span class="op" id="5868638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5868642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868647">prevLine</span>&nbsp;<span class="op" id="5868656">=</span>&nbsp;<span class="ident" id="5868658">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5868664">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5868668">if</span>&nbsp;<span class="ident" id="5868671">mode</span><span class="op" id="5868675">&amp;</span><span class="ident" id="5868676">commaTerm</span>&nbsp;<span class="op" id="5868686">!=</span>&nbsp;<span class="num" id="5868689">0</span>&nbsp;<span class="op" id="5868691">&amp;&amp;</span>&nbsp;<span class="ident" id="5868694">next</span><span class="op" id="5868698">.</span><span class="ident" id="5868699">IsValid</span><span class="op" id="5868706">(</span><span class="op" id="5868707">)</span>&nbsp;<span class="op" id="5868709">&amp;&amp;</span>&nbsp;<span class="ident" id="5868712">p</span><span class="op" id="5868713">.</span><span class="ident" id="5868714">pos</span><span class="op" id="5868717">.</span><span class="ident" id="5868718">Line</span>&nbsp;<span class="op" id="5868723">&lt;</span>&nbsp;<span class="ident" id="5868725">next</span><span class="op" id="5868729">.</span><span class="ident" id="5868730">Line</span>&nbsp;<span class="op" id="5868735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5868739">//&nbsp;print&nbsp;a&nbsp;terminating&nbsp;comma&nbsp;if&nbsp;the&nbsp;next&nbsp;token&nbsp;is&nbsp;on&nbsp;a&nbsp;new&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868805">p</span><span class="op" id="5868806">.</span><span class="builtinfunc" id="5868807">print</span><span class="op" id="5868812">(</span><span class="ident" id="5868813">token</span><span class="op" id="5868818">.</span><span class="ident" id="5868819">COMMA</span><span class="op" id="5868824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5868828">if</span>&nbsp;<span class="ident" id="5868831">ws</span>&nbsp;<span class="op" id="5868834">==</span>&nbsp;<span class="ident" id="5868837">ignore</span>&nbsp;<span class="op" id="5868844">&amp;&amp;</span>&nbsp;<span class="ident" id="5868847">mode</span><span class="op" id="5868851">&amp;</span><span class="ident" id="5868852">noIndent</span>&nbsp;<span class="op" id="5868861">==</span>&nbsp;<span class="num" id="5868864">0</span>&nbsp;<span class="op" id="5868866">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5868871">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868901">p</span><span class="op" id="5868902">.</span><span class="builtinfunc" id="5868903">print</span><span class="op" id="5868908">(</span><span class="ident" id="5868909">unindent</span><span class="op" id="5868917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5868921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868925">p</span><span class="op" id="5868926">.</span><span class="builtinfunc" id="5868927">print</span><span class="op" id="5868932">(</span><span class="ident" id="5868933">formfeed</span><span class="op" id="5868941">)</span>&nbsp;<span class="comment" id="5868943">//&nbsp;terminating&nbsp;comma&nbsp;needs&nbsp;a&nbsp;line&nbsp;break&nbsp;to&nbsp;look&nbsp;good</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5868998">return</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5869006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5869010">if</span>&nbsp;<span class="ident" id="5869013">ws</span>&nbsp;<span class="op" id="5869016">==</span>&nbsp;<span class="ident" id="5869019">ignore</span>&nbsp;<span class="op" id="5869026">&amp;&amp;</span>&nbsp;<span class="ident" id="5869029">mode</span><span class="op" id="5869033">&amp;</span><span class="ident" id="5869034">noIndent</span>&nbsp;<span class="op" id="5869043">==</span>&nbsp;<span class="num" id="5869046">0</span>&nbsp;<span class="op" id="5869048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5869052">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869081">p</span><span class="op" id="5869082">.</span><span class="builtinfunc" id="5869083">print</span><span class="op" id="5869088">(</span><span class="ident" id="5869089">unindent</span><span class="op" id="5869097">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5869100">}</span><br>
<span class="lineno"></span><span class="op" id="5869102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5869105">func</span>&nbsp;<span class="op" id="5869110">(</span><span class="ident" id="5869111">p</span>&nbsp;<span class="op" id="5869113">*</span><span class="ident" id="5869114">printer</span><span class="op" id="5869121">)</span>&nbsp;<span class="ident" id="5869123">parameters</span><span class="op" id="5869133">(</span><span class="ident" id="5869134">fields</span>&nbsp;<span class="op" id="5869141">*</span><span class="ident" id="5869142">ast</span><span class="op" id="5869145">.</span><span class="ident" id="5869146">FieldList</span><span class="op" id="5869155">)</span>&nbsp;<span class="op" id="5869157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869160">p</span><span class="op" id="5869161">.</span><span class="builtinfunc" id="5869162">print</span><span class="op" id="5869167">(</span><span class="ident" id="5869168">fields</span><span class="op" id="5869174">.</span><span class="ident" id="5869175">Opening</span><span class="op" id="5869182">,</span>&nbsp;<span class="ident" id="5869184">token</span><span class="op" id="5869189">.</span><span class="ident" id="5869190">LPAREN</span><span class="op" id="5869196">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5869199">if</span>&nbsp;<span class="builtinfunc" id="5869202">len</span><span class="op" id="5869205">(</span><span class="ident" id="5869206">fields</span><span class="op" id="5869212">.</span><span class="ident" id="5869213">List</span><span class="op" id="5869217">)</span>&nbsp;<span class="op" id="5869219">&gt;</span>&nbsp;<span class="num" id="5869221">0</span>&nbsp;<span class="op" id="5869223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869227">prevLine</span>&nbsp;<span class="op" id="5869236">:=</span>&nbsp;<span class="ident" id="5869239">p</span><span class="op" id="5869240">.</span><span class="ident" id="5869241">lineFor</span><span class="op" id="5869248">(</span><span class="ident" id="5869249">fields</span><span class="op" id="5869255">.</span><span class="ident" id="5869256">Opening</span><span class="op" id="5869263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869267">ws</span>&nbsp;<span class="op" id="5869270">:=</span>&nbsp;<span class="ident" id="5869273">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5869282">for</span>&nbsp;<span class="ident" id="5869286">i</span><span class="op" id="5869287">,</span>&nbsp;<span class="ident" id="5869289">par</span>&nbsp;<span class="op" id="5869293">:=</span>&nbsp;<span class="keyword" id="5869296">range</span>&nbsp;<span class="ident" id="5869302">fields</span><span class="op" id="5869308">.</span><span class="ident" id="5869309">List</span>&nbsp;<span class="op" id="5869314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5869319">//&nbsp;determine&nbsp;par&nbsp;begin&nbsp;and&nbsp;end&nbsp;line&nbsp;(may&nbsp;be&nbsp;different</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5869376">//&nbsp;if&nbsp;there&nbsp;are&nbsp;multiple&nbsp;parameter&nbsp;names&nbsp;for&nbsp;this&nbsp;par</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5869433">//&nbsp;or&nbsp;the&nbsp;type&nbsp;is&nbsp;on&nbsp;a&nbsp;separate&nbsp;line)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5869474">var</span>&nbsp;<span class="ident" id="5869478">parLineBeg</span>&nbsp;<span class="builtintype" id="5869489">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5869496">if</span>&nbsp;<span class="builtinfunc" id="5869499">len</span><span class="op" id="5869502">(</span><span class="ident" id="5869503">par</span><span class="op" id="5869506">.</span><span class="ident" id="5869507">Names</span><span class="op" id="5869512">)</span>&nbsp;<span class="op" id="5869514">&gt;</span>&nbsp;<span class="num" id="5869516">0</span>&nbsp;<span class="op" id="5869518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869524">parLineBeg</span>&nbsp;<span class="op" id="5869535">=</span>&nbsp;<span class="ident" id="5869537">p</span><span class="op" id="5869538">.</span><span class="ident" id="5869539">lineFor</span><span class="op" id="5869546">(</span><span class="ident" id="5869547">par</span><span class="op" id="5869550">.</span><span class="ident" id="5869551">Names</span><span class="op" id="5869556">[</span><span class="num" id="5869557">0</span><span class="op" id="5869558">]</span><span class="op" id="5869559">.</span><span class="ident" id="5869560">Pos</span><span class="op" id="5869563">(</span><span class="op" id="5869564">)</span><span class="op" id="5869565">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5869570">}</span>&nbsp;<span class="keyword" id="5869572">else</span>&nbsp;<span class="op" id="5869577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869583">parLineBeg</span>&nbsp;<span class="op" id="5869594">=</span>&nbsp;<span class="ident" id="5869596">p</span><span class="op" id="5869597">.</span><span class="ident" id="5869598">lineFor</span><span class="op" id="5869605">(</span><span class="ident" id="5869606">par</span><span class="op" id="5869609">.</span><span class="ident" id="5869610">Type</span><span class="op" id="5869614">.</span><span class="ident" id="5869615">Pos</span><span class="op" id="5869618">(</span><span class="op" id="5869619">)</span><span class="op" id="5869620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5869625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5869630">var</span>&nbsp;<span class="ident" id="5869634">parLineEnd</span>&nbsp;<span class="op" id="5869645">=</span>&nbsp;<span class="ident" id="5869647">p</span><span class="op" id="5869648">.</span><span class="ident" id="5869649">lineFor</span><span class="op" id="5869656">(</span><span class="ident" id="5869657">par</span><span class="op" id="5869660">.</span><span class="ident" id="5869661">Type</span><span class="op" id="5869665">.</span><span class="ident" id="5869666">End</span><span class="op" id="5869669">(</span><span class="op" id="5869670">)</span><span class="op" id="5869671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5869676">//&nbsp;separating&nbsp;&#34;,&#34;&nbsp;if&nbsp;needed</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869707">needsLinebreak</span>&nbsp;<span class="op" id="5869722">:=</span>&nbsp;<span class="num" id="5869725">0</span>&nbsp;<span class="op" id="5869727">&lt;</span>&nbsp;<span class="ident" id="5869729">prevLine</span>&nbsp;<span class="op" id="5869738">&amp;&amp;</span>&nbsp;<span class="ident" id="5869741">prevLine</span>&nbsp;<span class="op" id="5869750">&lt;</span>&nbsp;<span class="ident" id="5869752">parLineBeg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5869766">if</span>&nbsp;<span class="ident" id="5869769">i</span>&nbsp;<span class="op" id="5869771">&gt;</span>&nbsp;<span class="num" id="5869773">0</span>&nbsp;<span class="op" id="5869775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5869781">//&nbsp;use&nbsp;position&nbsp;of&nbsp;parameter&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5869837">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comma&nbsp;placement,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5869892">//&nbsp;only&nbsp;if&nbsp;the&nbsp;next&nbsp;parameter&nbsp;is&nbsp;on&nbsp;the&nbsp;same&nbsp;line</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5869946">if</span>&nbsp;<span class="op" id="5869949">!</span><span class="ident" id="5869950">needsLinebreak</span>&nbsp;<span class="op" id="5869965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869972">p</span><span class="op" id="5869973">.</span><span class="builtinfunc" id="5869974">print</span><span class="op" id="5869979">(</span><span class="ident" id="5869980">par</span><span class="op" id="5869983">.</span><span class="ident" id="5869984">Pos</span><span class="op" id="5869987">(</span><span class="op" id="5869988">)</span><span class="op" id="5869989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5869995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870001">p</span><span class="op" id="5870002">.</span><span class="builtinfunc" id="5870003">print</span><span class="op" id="5870008">(</span><span class="ident" id="5870009">token</span><span class="op" id="5870014">.</span><span class="ident" id="5870015">COMMA</span><span class="op" id="5870020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5870025">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5870030">//&nbsp;separator&nbsp;if&nbsp;needed&nbsp;(linebreak&nbsp;or&nbsp;blank)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870077">if</span>&nbsp;<span class="ident" id="5870080">needsLinebreak</span>&nbsp;<span class="op" id="5870095">&amp;&amp;</span>&nbsp;<span class="ident" id="5870098">p</span><span class="op" id="5870099">.</span><span class="ident" id="5870100">linebreak</span><span class="op" id="5870109">(</span><span class="ident" id="5870110">parLineBeg</span><span class="op" id="5870120">,</span>&nbsp;<span class="num" id="5870122">0</span><span class="op" id="5870123">,</span>&nbsp;<span class="ident" id="5870125">ws</span><span class="op" id="5870127">,</span>&nbsp;<span class="builtintype" id="5870129">true</span><span class="op" id="5870133">)</span>&nbsp;<span class="op" id="5870135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5870141">//&nbsp;break&nbsp;line&nbsp;if&nbsp;the&nbsp;opening&nbsp;&#34;(&#34;&nbsp;or&nbsp;previous&nbsp;parameter&nbsp;ended&nbsp;on&nbsp;a&nbsp;different&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870226">ws</span>&nbsp;<span class="op" id="5870229">=</span>&nbsp;<span class="ident" id="5870231">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5870241">}</span>&nbsp;<span class="keyword" id="5870243">else</span>&nbsp;<span class="keyword" id="5870248">if</span>&nbsp;<span class="ident" id="5870251">i</span>&nbsp;<span class="op" id="5870253">&gt;</span>&nbsp;<span class="num" id="5870255">0</span>&nbsp;<span class="op" id="5870257">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870263">p</span><span class="op" id="5870264">.</span><span class="builtinfunc" id="5870265">print</span><span class="op" id="5870270">(</span><span class="ident" id="5870271">blank</span><span class="op" id="5870276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5870281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5870286">//&nbsp;parameter&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870308">if</span>&nbsp;<span class="builtinfunc" id="5870311">len</span><span class="op" id="5870314">(</span><span class="ident" id="5870315">par</span><span class="op" id="5870318">.</span><span class="ident" id="5870319">Names</span><span class="op" id="5870324">)</span>&nbsp;<span class="op" id="5870326">&gt;</span>&nbsp;<span class="num" id="5870328">0</span>&nbsp;<span class="op" id="5870330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5870336">//&nbsp;Very&nbsp;subtle:&nbsp;If&nbsp;we&nbsp;indented&nbsp;before&nbsp;(ws&nbsp;==&nbsp;ignore),&nbsp;identList</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5870404">//&nbsp;won&#39;t&nbsp;indent&nbsp;again.&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;(ws&nbsp;==&nbsp;indent),&nbsp;identList&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5870475">//&nbsp;indent&nbsp;if&nbsp;the&nbsp;identList&nbsp;spans&nbsp;multiple&nbsp;lines,&nbsp;and&nbsp;it&nbsp;will&nbsp;outdent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5870548">//&nbsp;again&nbsp;at&nbsp;the&nbsp;end&nbsp;(and&nbsp;still&nbsp;ws&nbsp;==&nbsp;indent).&nbsp;Thus,&nbsp;a&nbsp;subsequent&nbsp;indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5870624">//&nbsp;by&nbsp;a&nbsp;linebreak&nbsp;call&nbsp;after&nbsp;a&nbsp;type,&nbsp;or&nbsp;in&nbsp;the&nbsp;next&nbsp;multi-line&nbsp;identList</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5870701">//&nbsp;will&nbsp;do&nbsp;the&nbsp;right&nbsp;thing.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870733">p</span><span class="op" id="5870734">.</span><span class="ident" id="5870735">identList</span><span class="op" id="5870744">(</span><span class="ident" id="5870745">par</span><span class="op" id="5870748">.</span><span class="ident" id="5870749">Names</span><span class="op" id="5870754">,</span>&nbsp;<span class="ident" id="5870756">ws</span>&nbsp;<span class="op" id="5870759">==</span>&nbsp;<span class="ident" id="5870762">indent</span><span class="op" id="5870768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870774">p</span><span class="op" id="5870775">.</span><span class="builtinfunc" id="5870776">print</span><span class="op" id="5870781">(</span><span class="ident" id="5870782">blank</span><span class="op" id="5870787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5870792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5870797">//&nbsp;parameter&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870818">p</span><span class="op" id="5870819">.</span><span class="ident" id="5870820">expr</span><span class="op" id="5870824">(</span><span class="ident" id="5870825">stripParensAlways</span><span class="op" id="5870842">(</span><span class="ident" id="5870843">par</span><span class="op" id="5870846">.</span><span class="ident" id="5870847">Type</span><span class="op" id="5870851">)</span><span class="op" id="5870852">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870857">prevLine</span>&nbsp;<span class="op" id="5870866">=</span>&nbsp;<span class="ident" id="5870868">parLineEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5870881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5870885">//&nbsp;if&nbsp;the&nbsp;closing&nbsp;&#34;)&#34;&nbsp;is&nbsp;on&nbsp;a&nbsp;separate&nbsp;line&nbsp;from&nbsp;the&nbsp;last&nbsp;parameter,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5870956">//&nbsp;print&nbsp;an&nbsp;additional&nbsp;&#34;,&#34;&nbsp;and&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871000">if</span>&nbsp;<span class="ident" id="5871003">closing</span>&nbsp;<span class="op" id="5871011">:=</span>&nbsp;<span class="ident" id="5871014">p</span><span class="op" id="5871015">.</span><span class="ident" id="5871016">lineFor</span><span class="op" id="5871023">(</span><span class="ident" id="5871024">fields</span><span class="op" id="5871030">.</span><span class="ident" id="5871031">Closing</span><span class="op" id="5871038">)</span><span class="op" id="5871039">;</span>&nbsp;<span class="num" id="5871041">0</span>&nbsp;<span class="op" id="5871043">&lt;</span>&nbsp;<span class="ident" id="5871045">prevLine</span>&nbsp;<span class="op" id="5871054">&amp;&amp;</span>&nbsp;<span class="ident" id="5871057">prevLine</span>&nbsp;<span class="op" id="5871066">&lt;</span>&nbsp;<span class="ident" id="5871068">closing</span>&nbsp;<span class="op" id="5871076">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871081">p</span><span class="op" id="5871082">.</span><span class="builtinfunc" id="5871083">print</span><span class="op" id="5871088">(</span><span class="ident" id="5871089">token</span><span class="op" id="5871094">.</span><span class="ident" id="5871095">COMMA</span><span class="op" id="5871100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871105">p</span><span class="op" id="5871106">.</span><span class="ident" id="5871107">linebreak</span><span class="op" id="5871116">(</span><span class="ident" id="5871117">closing</span><span class="op" id="5871124">,</span>&nbsp;<span class="num" id="5871126">0</span><span class="op" id="5871127">,</span>&nbsp;<span class="ident" id="5871129">ignore</span><span class="op" id="5871135">,</span>&nbsp;<span class="builtintype" id="5871137">true</span><span class="op" id="5871141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5871149">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871178">if</span>&nbsp;<span class="ident" id="5871181">ws</span>&nbsp;<span class="op" id="5871184">==</span>&nbsp;<span class="ident" id="5871187">ignore</span>&nbsp;<span class="op" id="5871194">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871199">p</span><span class="op" id="5871200">.</span><span class="builtinfunc" id="5871201">print</span><span class="op" id="5871206">(</span><span class="ident" id="5871207">unindent</span><span class="op" id="5871215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871225">p</span><span class="op" id="5871226">.</span><span class="builtinfunc" id="5871227">print</span><span class="op" id="5871232">(</span><span class="ident" id="5871233">fields</span><span class="op" id="5871239">.</span><span class="ident" id="5871240">Closing</span><span class="op" id="5871247">,</span>&nbsp;<span class="ident" id="5871249">token</span><span class="op" id="5871254">.</span><span class="ident" id="5871255">RPAREN</span><span class="op" id="5871261">)</span><br>
<span class="lineno"></span><span class="op" id="5871263">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="5871266">func</span>&nbsp;<span class="op" id="5871271">(</span><span class="ident" id="5871272">p</span>&nbsp;<span class="op" id="5871274">*</span><span class="ident" id="5871275">printer</span><span class="op" id="5871282">)</span>&nbsp;<span class="ident" id="5871284">signature</span><span class="op" id="5871293">(</span><span class="ident" id="5871294">params</span><span class="op" id="5871300">,</span>&nbsp;<span class="ident" id="5871302">result</span>&nbsp;<span class="op" id="5871309">*</span><span class="ident" id="5871310">ast</span><span class="op" id="5871313">.</span><span class="ident" id="5871314">FieldList</span><span class="op" id="5871323">)</span>&nbsp;<span class="op" id="5871325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871328">if</span>&nbsp;<span class="ident" id="5871331">params</span>&nbsp;<span class="op" id="5871338">!=</span>&nbsp;<span class="ident" id="5871341">nil</span>&nbsp;<span class="op" id="5871345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871349">p</span><span class="op" id="5871350">.</span><span class="ident" id="5871351">parameters</span><span class="op" id="5871361">(</span><span class="ident" id="5871362">params</span><span class="op" id="5871368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871371">}</span>&nbsp;<span class="keyword" id="5871373">else</span>&nbsp;<span class="op" id="5871378">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871382">p</span><span class="op" id="5871383">.</span><span class="builtinfunc" id="5871384">print</span><span class="op" id="5871389">(</span><span class="ident" id="5871390">token</span><span class="op" id="5871395">.</span><span class="ident" id="5871396">LPAREN</span><span class="op" id="5871402">,</span>&nbsp;<span class="ident" id="5871404">token</span><span class="op" id="5871409">.</span><span class="ident" id="5871410">RPAREN</span><span class="op" id="5871416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871422">n</span>&nbsp;<span class="op" id="5871424">:=</span>&nbsp;<span class="ident" id="5871427">result</span><span class="op" id="5871433">.</span><span class="ident" id="5871434">NumFields</span><span class="op" id="5871443">(</span><span class="op" id="5871444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871447">if</span>&nbsp;<span class="ident" id="5871450">n</span>&nbsp;<span class="op" id="5871452">&gt;</span>&nbsp;<span class="num" id="5871454">0</span>&nbsp;<span class="op" id="5871456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5871460">//&nbsp;result&nbsp;!=&nbsp;nil</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871479">p</span><span class="op" id="5871480">.</span><span class="builtinfunc" id="5871481">print</span><span class="op" id="5871486">(</span><span class="ident" id="5871487">blank</span><span class="op" id="5871492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871496">if</span>&nbsp;<span class="ident" id="5871499">n</span>&nbsp;<span class="op" id="5871501">==</span>&nbsp;<span class="num" id="5871504">1</span>&nbsp;<span class="op" id="5871506">&amp;&amp;</span>&nbsp;<span class="ident" id="5871509">result</span><span class="op" id="5871515">.</span><span class="ident" id="5871516">List</span><span class="op" id="5871520">[</span><span class="num" id="5871521">0</span><span class="op" id="5871522">]</span><span class="op" id="5871523">.</span><span class="ident" id="5871524">Names</span>&nbsp;<span class="op" id="5871530">==</span>&nbsp;<span class="ident" id="5871533">nil</span>&nbsp;<span class="op" id="5871537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5871542">//&nbsp;single&nbsp;anonymous&nbsp;result;&nbsp;no&nbsp;()&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871581">p</span><span class="op" id="5871582">.</span><span class="ident" id="5871583">expr</span><span class="op" id="5871587">(</span><span class="ident" id="5871588">stripParensAlways</span><span class="op" id="5871605">(</span><span class="ident" id="5871606">result</span><span class="op" id="5871612">.</span><span class="ident" id="5871613">List</span><span class="op" id="5871617">[</span><span class="num" id="5871618">0</span><span class="op" id="5871619">]</span><span class="op" id="5871620">.</span><span class="ident" id="5871621">Type</span><span class="op" id="5871625">)</span><span class="op" id="5871626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871631">return</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871644">p</span><span class="op" id="5871645">.</span><span class="ident" id="5871646">parameters</span><span class="op" id="5871656">(</span><span class="ident" id="5871657">result</span><span class="op" id="5871663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871666">}</span><br>
<span class="lineno"></span><span class="op" id="5871668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="5871671">func</span>&nbsp;<span class="ident" id="5871676">identListSize</span><span class="op" id="5871689">(</span><span class="ident" id="5871690">list</span>&nbsp;<span class="op" id="5871695">[</span><span class="op" id="5871696">]</span><span class="op" id="5871697">*</span><span class="ident" id="5871698">ast</span><span class="op" id="5871701">.</span><span class="ident" id="5871702">Ident</span><span class="op" id="5871707">,</span>&nbsp;<span class="ident" id="5871709">maxSize</span>&nbsp;<span class="builtintype" id="5871717">int</span><span class="op" id="5871720">)</span>&nbsp;<span class="op" id="5871722">(</span><span class="ident" id="5871723">size</span>&nbsp;<span class="builtintype" id="5871728">int</span><span class="op" id="5871731">)</span>&nbsp;<span class="op" id="5871733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871736">for</span>&nbsp;<span class="ident" id="5871740">i</span><span class="op" id="5871741">,</span>&nbsp;<span class="ident" id="5871743">x</span>&nbsp;<span class="op" id="5871745">:=</span>&nbsp;<span class="keyword" id="5871748">range</span>&nbsp;<span class="ident" id="5871754">list</span>&nbsp;<span class="op" id="5871759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871763">if</span>&nbsp;<span class="ident" id="5871766">i</span>&nbsp;<span class="op" id="5871768">&gt;</span>&nbsp;<span class="num" id="5871770">0</span>&nbsp;<span class="op" id="5871772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871777">size</span>&nbsp;<span class="op" id="5871782">+=</span>&nbsp;<span class="builtinfunc" id="5871785">len</span><span class="op" id="5871788">(</span><span class="string" id="5871789">&#34;,&nbsp;&#34;</span><span class="op" id="5871793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871797">}</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871801">size</span>&nbsp;<span class="op" id="5871806">+=</span>&nbsp;<span class="ident" id="5871809">utf8</span><span class="op" id="5871813">.</span><span class="ident" id="5871814">RuneCountInString</span><span class="op" id="5871831">(</span><span class="ident" id="5871832">x</span><span class="op" id="5871833">.</span><span class="ident" id="5871834">Name</span><span class="op" id="5871838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871842">if</span>&nbsp;<span class="ident" id="5871845">size</span>&nbsp;<span class="op" id="5871850">&gt;=</span>&nbsp;<span class="ident" id="5871853">maxSize</span>&nbsp;<span class="op" id="5871861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871866">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871877">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871880">return</span><br>
<span class="lineno"></span><span class="op" id="5871887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5871890">func</span>&nbsp;<span class="op" id="5871895">(</span><span class="ident" id="5871896">p</span>&nbsp;<span class="op" id="5871898">*</span><span class="ident" id="5871899">printer</span><span class="op" id="5871906">)</span>&nbsp;<span class="ident" id="5871908">isOneLineFieldList</span><span class="op" id="5871926">(</span><span class="ident" id="5871927">list</span>&nbsp;<span class="op" id="5871932">[</span><span class="op" id="5871933">]</span><span class="op" id="5871934">*</span><span class="ident" id="5871935">ast</span><span class="op" id="5871938">.</span><span class="ident" id="5871939">Field</span><span class="op" id="5871944">)</span>&nbsp;<span class="builtintype" id="5871946">bool</span>&nbsp;<span class="op" id="5871951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871954">if</span>&nbsp;<span class="builtinfunc" id="5871957">len</span><span class="op" id="5871960">(</span><span class="ident" id="5871961">list</span><span class="op" id="5871965">)</span>&nbsp;<span class="op" id="5871967">!=</span>&nbsp;<span class="num" id="5871970">1</span>&nbsp;<span class="op" id="5871972">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871976">return</span>&nbsp;<span class="builtintype" id="5871983">false</span>&nbsp;<span class="comment" id="5871989">//&nbsp;allow&nbsp;only&nbsp;one&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5872014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872017">f</span>&nbsp;<span class="op" id="5872019">:=</span>&nbsp;<span class="ident" id="5872022">list</span><span class="op" id="5872026">[</span><span class="num" id="5872027">0</span><span class="op" id="5872028">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872031">if</span>&nbsp;<span class="ident" id="5872034">f</span><span class="op" id="5872035">.</span><span class="ident" id="5872036">Tag</span>&nbsp;<span class="op" id="5872040">!=</span>&nbsp;<span class="ident" id="5872043">nil</span>&nbsp;<span class="op" id="5872047">||</span>&nbsp;<span class="ident" id="5872050">f</span><span class="op" id="5872051">.</span><span class="ident" id="5872052">Comment</span>&nbsp;<span class="op" id="5872060">!=</span>&nbsp;<span class="ident" id="5872063">nil</span>&nbsp;<span class="op" id="5872067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872071">return</span>&nbsp;<span class="builtintype" id="5872078">false</span>&nbsp;<span class="comment" id="5872084">//&nbsp;don&#39;t&nbsp;allow&nbsp;tags&nbsp;or&nbsp;comments</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5872117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5872120">//&nbsp;only&nbsp;name(s)&nbsp;and&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872146">const</span>&nbsp;<span class="ident" id="5872152">maxSize</span>&nbsp;<span class="op" id="5872160">=</span>&nbsp;<span class="num" id="5872162">30</span>&nbsp;<span class="comment" id="5872165">//&nbsp;adjust&nbsp;as&nbsp;appropriate,&nbsp;this&nbsp;is&nbsp;an&nbsp;approximate&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872221">namesSize</span>&nbsp;<span class="op" id="5872231">:=</span>&nbsp;<span class="ident" id="5872234">identListSize</span><span class="op" id="5872247">(</span><span class="ident" id="5872248">f</span><span class="op" id="5872249">.</span><span class="ident" id="5872250">Names</span><span class="op" id="5872255">,</span>&nbsp;<span class="ident" id="5872257">maxSize</span><span class="op" id="5872264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872267">if</span>&nbsp;<span class="ident" id="5872270">namesSize</span>&nbsp;<span class="op" id="5872280">&gt;</span>&nbsp;<span class="num" id="5872282">0</span>&nbsp;<span class="op" id="5872284">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872288">namesSize</span>&nbsp;<span class="op" id="5872298">=</span>&nbsp;<span class="num" id="5872300">1</span>&nbsp;<span class="comment" id="5872302">//&nbsp;blank&nbsp;between&nbsp;names&nbsp;and&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5872336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872339">typeSize</span>&nbsp;<span class="op" id="5872348">:=</span>&nbsp;<span class="ident" id="5872351">p</span><span class="op" id="5872352">.</span><span class="ident" id="5872353">nodeSize</span><span class="op" id="5872361">(</span><span class="ident" id="5872362">f</span><span class="op" id="5872363">.</span><span class="ident" id="5872364">Type</span><span class="op" id="5872368">,</span>&nbsp;<span class="ident" id="5872370">maxSize</span><span class="op" id="5872377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872380">return</span>&nbsp;<span class="ident" id="5872387">namesSize</span><span class="op" id="5872396">+</span><span class="ident" id="5872397">typeSize</span>&nbsp;<span class="op" id="5872406">&lt;=</span>&nbsp;<span class="ident" id="5872409">maxSize</span><br>
<span class="lineno"></span><span class="op" id="5872417">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span><span class="keyword" id="5872420">func</span>&nbsp;<span class="op" id="5872425">(</span><span class="ident" id="5872426">p</span>&nbsp;<span class="op" id="5872428">*</span><span class="ident" id="5872429">printer</span><span class="op" id="5872436">)</span>&nbsp;<span class="ident" id="5872438">setLineComment</span><span class="op" id="5872452">(</span><span class="ident" id="5872453">text</span>&nbsp;<span class="builtintype" id="5872458">string</span><span class="op" id="5872464">)</span>&nbsp;<span class="op" id="5872466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872469">p</span><span class="op" id="5872470">.</span><span class="ident" id="5872471">setComment</span><span class="op" id="5872481">(</span><span class="op" id="5872482">&amp;</span><span class="ident" id="5872483">ast</span><span class="op" id="5872486">.</span><span class="ident" id="5872487">CommentGroup</span><span class="op" id="5872499">{</span><span class="ident" id="5872500">List</span><span class="op" id="5872504">:</span>&nbsp;<span class="op" id="5872506">[</span><span class="op" id="5872507">]</span><span class="op" id="5872508">*</span><span class="ident" id="5872509">ast</span><span class="op" id="5872512">.</span><span class="ident" id="5872513">Comment</span><span class="op" id="5872520">{</span><span class="op" id="5872521">{</span><span class="ident" id="5872522">Slash</span><span class="op" id="5872527">:</span>&nbsp;<span class="ident" id="5872529">token</span><span class="op" id="5872534">.</span><span class="ident" id="5872535">NoPos</span><span class="op" id="5872540">,</span>&nbsp;<span class="ident" id="5872542">Text</span><span class="op" id="5872546">:</span>&nbsp;<span class="ident" id="5872548">text</span><span class="op" id="5872552">}</span><span class="op" id="5872553">}</span><span class="op" id="5872554">}</span><span class="op" id="5872555">)</span><br>
<span class="lineno"></span><span class="op" id="5872557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="5872560">func</span>&nbsp;<span class="op" id="5872565">(</span><span class="ident" id="5872566">p</span>&nbsp;<span class="op" id="5872568">*</span><span class="ident" id="5872569">printer</span><span class="op" id="5872576">)</span>&nbsp;<span class="ident" id="5872578">fieldList</span><span class="op" id="5872587">(</span><span class="ident" id="5872588">fields</span>&nbsp;<span class="op" id="5872595">*</span><span class="ident" id="5872596">ast</span><span class="op" id="5872599">.</span><span class="ident" id="5872600">FieldList</span><span class="op" id="5872609">,</span>&nbsp;<span class="ident" id="5872611">isStruct</span><span class="op" id="5872619">,</span>&nbsp;<span class="ident" id="5872621">isIncomplete</span>&nbsp;<span class="builtintype" id="5872634">bool</span><span class="op" id="5872638">)</span>&nbsp;<span class="op" id="5872640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872643">lbrace</span>&nbsp;<span class="op" id="5872650">:=</span>&nbsp;<span class="ident" id="5872653">fields</span><span class="op" id="5872659">.</span><span class="ident" id="5872660">Opening</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872669">list</span>&nbsp;<span class="op" id="5872674">:=</span>&nbsp;<span class="ident" id="5872677">fields</span><span class="op" id="5872683">.</span><span class="ident" id="5872684">List</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872690">rbrace</span>&nbsp;<span class="op" id="5872697">:=</span>&nbsp;<span class="ident" id="5872700">fields</span><span class="op" id="5872706">.</span><span class="ident" id="5872707">Closing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872716">hasComments</span>&nbsp;<span class="op" id="5872728">:=</span>&nbsp;<span class="ident" id="5872731">isIncomplete</span>&nbsp;<span class="op" id="5872744">||</span>&nbsp;<span class="ident" id="5872747">p</span><span class="op" id="5872748">.</span><span class="ident" id="5872749">commentBefore</span><span class="op" id="5872762">(</span><span class="ident" id="5872763">p</span><span class="op" id="5872764">.</span><span class="ident" id="5872765">posFor</span><span class="op" id="5872771">(</span><span class="ident" id="5872772">rbrace</span><span class="op" id="5872778">)</span><span class="op" id="5872779">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872782">srcIsOneLine</span>&nbsp;<span class="op" id="5872795">:=</span>&nbsp;<span class="ident" id="5872798">lbrace</span><span class="op" id="5872804">.</span><span class="ident" id="5872805">IsValid</span><span class="op" id="5872812">(</span><span class="op" id="5872813">)</span>&nbsp;<span class="op" id="5872815">&amp;&amp;</span>&nbsp;<span class="ident" id="5872818">rbrace</span><span class="op" id="5872824">.</span><span class="ident" id="5872825">IsValid</span><span class="op" id="5872832">(</span><span class="op" id="5872833">)</span>&nbsp;<span class="op" id="5872835">&amp;&amp;</span>&nbsp;<span class="ident" id="5872838">p</span><span class="op" id="5872839">.</span><span class="ident" id="5872840">lineFor</span><span class="op" id="5872847">(</span><span class="ident" id="5872848">lbrace</span><span class="op" id="5872854">)</span>&nbsp;<span class="op" id="5872856">==</span>&nbsp;<span class="ident" id="5872859">p</span><span class="op" id="5872860">.</span><span class="ident" id="5872861">lineFor</span><span class="op" id="5872868">(</span><span class="ident" id="5872869">rbrace</span><span class="op" id="5872875">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872879">if</span>&nbsp;<span class="op" id="5872882">!</span><span class="ident" id="5872883">hasComments</span>&nbsp;<span class="op" id="5872895">&amp;&amp;</span>&nbsp;<span class="ident" id="5872898">srcIsOneLine</span>&nbsp;<span class="op" id="5872911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5872915">//&nbsp;possibly&nbsp;a&nbsp;one-line&nbsp;struct/interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872957">if</span>&nbsp;<span class="builtinfunc" id="5872960">len</span><span class="op" id="5872963">(</span><span class="ident" id="5872964">list</span><span class="op" id="5872968">)</span>&nbsp;<span class="op" id="5872970">==</span>&nbsp;<span class="num" id="5872973">0</span>&nbsp;<span class="op" id="5872975">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5872980">//&nbsp;no&nbsp;blank&nbsp;between&nbsp;keyword&nbsp;and&nbsp;{}&nbsp;in&nbsp;this&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873031">p</span><span class="op" id="5873032">.</span><span class="builtinfunc" id="5873033">print</span><span class="op" id="5873038">(</span><span class="ident" id="5873039">lbrace</span><span class="op" id="5873045">,</span>&nbsp;<span class="ident" id="5873047">token</span><span class="op" id="5873052">.</span><span class="ident" id="5873053">LBRACE</span><span class="op" id="5873059">,</span>&nbsp;<span class="ident" id="5873061">rbrace</span><span class="op" id="5873067">,</span>&nbsp;<span class="ident" id="5873069">token</span><span class="op" id="5873074">.</span><span class="ident" id="5873075">RBRACE</span><span class="op" id="5873081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873086">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5873095">}</span>&nbsp;<span class="keyword" id="5873097">else</span>&nbsp;<span class="keyword" id="5873102">if</span>&nbsp;<span class="ident" id="5873105">isStruct</span>&nbsp;<span class="op" id="5873114">&amp;&amp;</span>&nbsp;<span class="ident" id="5873117">p</span><span class="op" id="5873118">.</span><span class="ident" id="5873119">isOneLineFieldList</span><span class="op" id="5873137">(</span><span class="ident" id="5873138">list</span><span class="op" id="5873142">)</span>&nbsp;<span class="op" id="5873144">{</span>&nbsp;<span class="comment" id="5873146">//&nbsp;for&nbsp;now&nbsp;ignore&nbsp;interfaces</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5873178">//&nbsp;small&nbsp;enough&nbsp;-&nbsp;print&nbsp;on&nbsp;one&nbsp;line</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5873217">//&nbsp;(don&#39;t&nbsp;use&nbsp;identList&nbsp;and&nbsp;ignore&nbsp;source&nbsp;line&nbsp;breaks)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873275">p</span><span class="op" id="5873276">.</span><span class="builtinfunc" id="5873277">print</span><span class="op" id="5873282">(</span><span class="ident" id="5873283">lbrace</span><span class="op" id="5873289">,</span>&nbsp;<span class="ident" id="5873291">token</span><span class="op" id="5873296">.</span><span class="ident" id="5873297">LBRACE</span><span class="op" id="5873303">,</span>&nbsp;<span class="ident" id="5873305">blank</span><span class="op" id="5873310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873315">f</span>&nbsp;<span class="op" id="5873317">:=</span>&nbsp;<span class="ident" id="5873320">list</span><span class="op" id="5873324">[</span><span class="num" id="5873325">0</span><span class="op" id="5873326">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873331">for</span>&nbsp;<span class="ident" id="5873335">i</span><span class="op" id="5873336">,</span>&nbsp;<span class="ident" id="5873338">x</span>&nbsp;<span class="op" id="5873340">:=</span>&nbsp;<span class="keyword" id="5873343">range</span>&nbsp;<span class="ident" id="5873349">f</span><span class="op" id="5873350">.</span><span class="ident" id="5873351">Names</span>&nbsp;<span class="op" id="5873357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873363">if</span>&nbsp;<span class="ident" id="5873366">i</span>&nbsp;<span class="op" id="5873368">&gt;</span>&nbsp;<span class="num" id="5873370">0</span>&nbsp;<span class="op" id="5873372">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5873379">//&nbsp;no&nbsp;comments&nbsp;so&nbsp;no&nbsp;need&nbsp;for&nbsp;comma&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873429">p</span><span class="op" id="5873430">.</span><span class="builtinfunc" id="5873431">print</span><span class="op" id="5873436">(</span><span class="ident" id="5873437">token</span><span class="op" id="5873442">.</span><span class="ident" id="5873443">COMMA</span><span class="op" id="5873448">,</span>&nbsp;<span class="ident" id="5873450">blank</span><span class="op" id="5873455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5873461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873467">p</span><span class="op" id="5873468">.</span><span class="ident" id="5873469">expr</span><span class="op" id="5873473">(</span><span class="ident" id="5873474">x</span><span class="op" id="5873475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5873480">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873485">if</span>&nbsp;<span class="builtinfunc" id="5873488">len</span><span class="op" id="5873491">(</span><span class="ident" id="5873492">f</span><span class="op" id="5873493">.</span><span class="ident" id="5873494">Names</span><span class="op" id="5873499">)</span>&nbsp;<span class="op" id="5873501">&gt;</span>&nbsp;<span class="num" id="5873503">0</span>&nbsp;<span class="op" id="5873505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873511">p</span><span class="op" id="5873512">.</span><span class="builtinfunc" id="5873513">print</span><span class="op" id="5873518">(</span><span class="ident" id="5873519">blank</span><span class="op" id="5873524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5873529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873534">p</span><span class="op" id="5873535">.</span><span class="ident" id="5873536">expr</span><span class="op" id="5873540">(</span><span class="ident" id="5873541">f</span><span class="op" id="5873542">.</span><span class="ident" id="5873543">Type</span><span class="op" id="5873547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873552">p</span><span class="op" id="5873553">.</span><span class="builtinfunc" id="5873554">print</span><span class="op" id="5873559">(</span><span class="ident" id="5873560">blank</span><span class="op" id="5873565">,</span>&nbsp;<span class="ident" id="5873567">rbrace</span><span class="op" id="5873573">,</span>&nbsp;<span class="ident" id="5873575">token</span><span class="op" id="5873580">.</span><span class="ident" id="5873581">RBRACE</span><span class="op" id="5873587">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873592">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5873601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5873604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5873607">//&nbsp;hasComments&nbsp;||&nbsp;!srcIsOneLine</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873641">p</span><span class="op" id="5873642">.</span><span class="builtinfunc" id="5873643">print</span><span class="op" id="5873648">(</span><span class="ident" id="5873649">blank</span><span class="op" id="5873654">,</span>&nbsp;<span class="ident" id="5873656">lbrace</span><span class="op" id="5873662">,</span>&nbsp;<span class="ident" id="5873664">token</span><span class="op" id="5873669">.</span><span class="ident" id="5873670">LBRACE</span><span class="op" id="5873676">,</span>&nbsp;<span class="ident" id="5873678">indent</span><span class="op" id="5873684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873687">if</span>&nbsp;<span class="ident" id="5873690">hasComments</span>&nbsp;<span class="op" id="5873702">||</span>&nbsp;<span class="builtinfunc" id="5873705">len</span><span class="op" id="5873708">(</span><span class="ident" id="5873709">list</span><span class="op" id="5873713">)</span>&nbsp;<span class="op" id="5873715">&gt;</span>&nbsp;<span class="num" id="5873717">0</span>&nbsp;<span class="op" id="5873719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873723">p</span><span class="op" id="5873724">.</span><span class="builtinfunc" id="5873725">print</span><span class="op" id="5873730">(</span><span class="ident" id="5873731">formfeed</span><span class="op" id="5873739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5873742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873746">if</span>&nbsp;<span class="ident" id="5873749">isStruct</span>&nbsp;<span class="op" id="5873758">{</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873763">sep</span>&nbsp;<span class="op" id="5873767">:=</span>&nbsp;<span class="ident" id="5873770">vtab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873777">if</span>&nbsp;<span class="builtinfunc" id="5873780">len</span><span class="op" id="5873783">(</span><span class="ident" id="5873784">list</span><span class="op" id="5873788">)</span>&nbsp;<span class="op" id="5873790">==</span>&nbsp;<span class="num" id="5873793">1</span>&nbsp;<span class="op" id="5873795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873800">sep</span>&nbsp;<span class="op" id="5873804">=</span>&nbsp;<span class="ident" id="5873806">blank</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5873814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873818">var</span>&nbsp;<span class="ident" id="5873822">line</span>&nbsp;<span class="builtintype" id="5873827">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873833">for</span>&nbsp;<span class="ident" id="5873837">i</span><span class="op" id="5873838">,</span>&nbsp;<span class="ident" id="5873840">f</span>&nbsp;<span class="op" id="5873842">:=</span>&nbsp;<span class="keyword" id="5873845">range</span>&nbsp;<span class="ident" id="5873851">list</span>&nbsp;<span class="op" id="5873856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873861">if</span>&nbsp;<span class="ident" id="5873864">i</span>&nbsp;<span class="op" id="5873866">&gt;</span>&nbsp;<span class="num" id="5873868">0</span>&nbsp;<span class="op" id="5873870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873876">p</span><span class="op" id="5873877">.</span><span class="ident" id="5873878">linebreak</span><span class="op" id="5873887">(</span><span class="ident" id="5873888">p</span><span class="op" id="5873889">.</span><span class="ident" id="5873890">lineFor</span><span class="op" id="5873897">(</span><span class="ident" id="5873898">f</span><span class="op" id="5873899">.</span><span class="ident" id="5873900">Pos</span><span class="op" id="5873903">(</span><span class="op" id="5873904">)</span><span class="op" id="5873905">)</span><span class="op" id="5873906">,</span>&nbsp;<span class="num" id="5873908">1</span><span class="op" id="5873909">,</span>&nbsp;<span class="ident" id="5873911">ignore</span><span class="op" id="5873917">,</span>&nbsp;<span class="ident" id="5873919">p</span><span class="op" id="5873920">.</span><span class="ident" id="5873921">linesFrom</span><span class="op" id="5873930">(</span><span class="ident" id="5873931">line</span><span class="op" id="5873935">)</span>&nbsp;<span class="op" id="5873937">&gt;</span>&nbsp;<span class="num" id="5873939">0</span><span class="op" id="5873940">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5873945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873950">extraTabs</span>&nbsp;<span class="op" id="5873960">:=</span>&nbsp;<span class="num" id="5873963">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873968">p</span><span class="op" id="5873969">.</span><span class="ident" id="5873970">setComment</span><span class="op" id="5873980">(</span><span class="ident" id="5873981">f</span><span class="op" id="5873982">.</span><span class="ident" id="5873983">Doc</span><span class="op" id="5873986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873991">p</span><span class="op" id="5873992">.</span><span class="ident" id="5873993">recordLine</span><span class="op" id="5874003">(</span><span class="op" id="5874004">&amp;</span><span class="ident" id="5874005">line</span><span class="op" id="5874009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874014">if</span>&nbsp;<span class="builtinfunc" id="5874017">len</span><span class="op" id="5874020">(</span><span class="ident" id="5874021">f</span><span class="op" id="5874022">.</span><span class="ident" id="5874023">Names</span><span class="op" id="5874028">)</span>&nbsp;<span class="op" id="5874030">&gt;</span>&nbsp;<span class="num" id="5874032">0</span>&nbsp;<span class="op" id="5874034">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5874040">//&nbsp;named&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874060">p</span><span class="op" id="5874061">.</span><span class="ident" id="5874062">identList</span><span class="op" id="5874071">(</span><span class="ident" id="5874072">f</span><span class="op" id="5874073">.</span><span class="ident" id="5874074">Names</span><span class="op" id="5874079">,</span>&nbsp;<span class="builtintype" id="5874081">false</span><span class="op" id="5874086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874092">p</span><span class="op" id="5874093">.</span><span class="builtinfunc" id="5874094">print</span><span class="op" id="5874099">(</span><span class="ident" id="5874100">sep</span><span class="op" id="5874103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874109">p</span><span class="op" id="5874110">.</span><span class="ident" id="5874111">expr</span><span class="op" id="5874115">(</span><span class="ident" id="5874116">f</span><span class="op" id="5874117">.</span><span class="ident" id="5874118">Type</span><span class="op" id="5874122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874128">extraTabs</span>&nbsp;<span class="op" id="5874138">=</span>&nbsp;<span class="num" id="5874140">1</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874145">}</span>&nbsp;<span class="keyword" id="5874147">else</span>&nbsp;<span class="op" id="5874152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5874158">//&nbsp;anonymous&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874181">p</span><span class="op" id="5874182">.</span><span class="ident" id="5874183">expr</span><span class="op" id="5874187">(</span><span class="ident" id="5874188">f</span><span class="op" id="5874189">.</span><span class="ident" id="5874190">Type</span><span class="op" id="5874194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874200">extraTabs</span>&nbsp;<span class="op" id="5874210">=</span>&nbsp;<span class="num" id="5874212">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874217">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874222">if</span>&nbsp;<span class="ident" id="5874225">f</span><span class="op" id="5874226">.</span><span class="ident" id="5874227">Tag</span>&nbsp;<span class="op" id="5874231">!=</span>&nbsp;<span class="ident" id="5874234">nil</span>&nbsp;<span class="op" id="5874238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874244">if</span>&nbsp;<span class="builtinfunc" id="5874247">len</span><span class="op" id="5874250">(</span><span class="ident" id="5874251">f</span><span class="op" id="5874252">.</span><span class="ident" id="5874253">Names</span><span class="op" id="5874258">)</span>&nbsp;<span class="op" id="5874260">&gt;</span>&nbsp;<span class="num" id="5874262">0</span>&nbsp;<span class="op" id="5874264">&amp;&amp;</span>&nbsp;<span class="ident" id="5874267">sep</span>&nbsp;<span class="op" id="5874271">==</span>&nbsp;<span class="ident" id="5874274">vtab</span>&nbsp;<span class="op" id="5874279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874286">p</span><span class="op" id="5874287">.</span><span class="builtinfunc" id="5874288">print</span><span class="op" id="5874293">(</span><span class="ident" id="5874294">sep</span><span class="op" id="5874297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874309">p</span><span class="op" id="5874310">.</span><span class="builtinfunc" id="5874311">print</span><span class="op" id="5874316">(</span><span class="ident" id="5874317">sep</span><span class="op" id="5874320">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874326">p</span><span class="op" id="5874327">.</span><span class="ident" id="5874328">expr</span><span class="op" id="5874332">(</span><span class="ident" id="5874333">f</span><span class="op" id="5874334">.</span><span class="ident" id="5874335">Tag</span><span class="op" id="5874338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874344">extraTabs</span>&nbsp;<span class="op" id="5874354">=</span>&nbsp;<span class="num" id="5874356">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874366">if</span>&nbsp;<span class="ident" id="5874369">f</span><span class="op" id="5874370">.</span><span class="ident" id="5874371">Comment</span>&nbsp;<span class="op" id="5874379">!=</span>&nbsp;<span class="ident" id="5874382">nil</span>&nbsp;<span class="op" id="5874386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874392">for</span>&nbsp;<span class="op" id="5874396">;</span>&nbsp;<span class="ident" id="5874398">extraTabs</span>&nbsp;<span class="op" id="5874408">&gt;</span>&nbsp;<span class="num" id="5874410">0</span><span class="op" id="5874411">;</span>&nbsp;<span class="ident" id="5874413">extraTabs</span><span class="op" id="5874422">--</span>&nbsp;<span class="op" id="5874425">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874432">p</span><span class="op" id="5874433">.</span><span class="builtinfunc" id="5874434">print</span><span class="op" id="5874439">(</span><span class="ident" id="5874440">sep</span><span class="op" id="5874443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874455">p</span><span class="op" id="5874456">.</span><span class="ident" id="5874457">setComment</span><span class="op" id="5874467">(</span><span class="ident" id="5874468">f</span><span class="op" id="5874469">.</span><span class="ident" id="5874470">Comment</span><span class="op" id="5874477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874486">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874490">if</span>&nbsp;<span class="ident" id="5874493">isIncomplete</span>&nbsp;<span class="op" id="5874506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874511">if</span>&nbsp;<span class="builtinfunc" id="5874514">len</span><span class="op" id="5874517">(</span><span class="ident" id="5874518">list</span><span class="op" id="5874522">)</span>&nbsp;<span class="op" id="5874524">&gt;</span>&nbsp;<span class="num" id="5874526">0</span>&nbsp;<span class="op" id="5874528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874534">p</span><span class="op" id="5874535">.</span><span class="builtinfunc" id="5874536">print</span><span class="op" id="5874541">(</span><span class="ident" id="5874542">formfeed</span><span class="op" id="5874550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874560">p</span><span class="op" id="5874561">.</span><span class="ident" id="5874562">flush</span><span class="op" id="5874567">(</span><span class="ident" id="5874568">p</span><span class="op" id="5874569">.</span><span class="ident" id="5874570">posFor</span><span class="op" id="5874576">(</span><span class="ident" id="5874577">rbrace</span><span class="op" id="5874583">)</span><span class="op" id="5874584">,</span>&nbsp;<span class="ident" id="5874586">token</span><span class="op" id="5874591">.</span><span class="ident" id="5874592">RBRACE</span><span class="op" id="5874598">)</span>&nbsp;<span class="comment" id="5874600">//&nbsp;make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;lose&nbsp;the&nbsp;last&nbsp;line&nbsp;comment</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874652">p</span><span class="op" id="5874653">.</span><span class="ident" id="5874654">setLineComment</span><span class="op" id="5874668">(</span><span class="string" id="5874669">&#34;//&nbsp;contains&nbsp;filtered&nbsp;or&nbsp;unexported&nbsp;fields&#34;</span><span class="op" id="5874712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874720">}</span>&nbsp;<span class="keyword" id="5874722">else</span>&nbsp;<span class="op" id="5874727">{</span>&nbsp;<span class="comment" id="5874729">//&nbsp;interface</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874745">var</span>&nbsp;<span class="ident" id="5874749">line</span>&nbsp;<span class="builtintype" id="5874754">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874760">for</span>&nbsp;<span class="ident" id="5874764">i</span><span class="op" id="5874765">,</span>&nbsp;<span class="ident" id="5874767">f</span>&nbsp;<span class="op" id="5874769">:=</span>&nbsp;<span class="keyword" id="5874772">range</span>&nbsp;<span class="ident" id="5874778">list</span>&nbsp;<span class="op" id="5874783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874788">if</span>&nbsp;<span class="ident" id="5874791">i</span>&nbsp;<span class="op" id="5874793">&gt;</span>&nbsp;<span class="num" id="5874795">0</span>&nbsp;<span class="op" id="5874797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874803">p</span><span class="op" id="5874804">.</span><span class="ident" id="5874805">linebreak</span><span class="op" id="5874814">(</span><span class="ident" id="5874815">p</span><span class="op" id="5874816">.</span><span class="ident" id="5874817">lineFor</span><span class="op" id="5874824">(</span><span class="ident" id="5874825">f</span><span class="op" id="5874826">.</span><span class="ident" id="5874827">Pos</span><span class="op" id="5874830">(</span><span class="op" id="5874831">)</span><span class="op" id="5874832">)</span><span class="op" id="5874833">,</span>&nbsp;<span class="num" id="5874835">1</span><span class="op" id="5874836">,</span>&nbsp;<span class="ident" id="5874838">ignore</span><span class="op" id="5874844">,</span>&nbsp;<span class="ident" id="5874846">p</span><span class="op" id="5874847">.</span><span class="ident" id="5874848">linesFrom</span><span class="op" id="5874857">(</span><span class="ident" id="5874858">line</span><span class="op" id="5874862">)</span>&nbsp;<span class="op" id="5874864">&gt;</span>&nbsp;<span class="num" id="5874866">0</span><span class="op" id="5874867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874872">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874877">p</span><span class="op" id="5874878">.</span><span class="ident" id="5874879">setComment</span><span class="op" id="5874889">(</span><span class="ident" id="5874890">f</span><span class="op" id="5874891">.</span><span class="ident" id="5874892">Doc</span><span class="op" id="5874895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874900">p</span><span class="op" id="5874901">.</span><span class="ident" id="5874902">recordLine</span><span class="op" id="5874912">(</span><span class="op" id="5874913">&amp;</span><span class="ident" id="5874914">line</span><span class="op" id="5874918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874923">if</span>&nbsp;<span class="ident" id="5874926">ftyp</span><span class="op" id="5874930">,</span>&nbsp;<span class="ident" id="5874932">isFtyp</span>&nbsp;<span class="op" id="5874939">:=</span>&nbsp;<span class="ident" id="5874942">f</span><span class="op" id="5874943">.</span><span class="ident" id="5874944">Type</span><span class="op" id="5874948">.</span><span class="op" id="5874949">(</span><span class="op" id="5874950">*</span><span class="ident" id="5874951">ast</span><span class="op" id="5874954">.</span><span class="ident" id="5874955">FuncType</span><span class="op" id="5874963">)</span><span class="op" id="5874964">;</span>&nbsp;<span class="ident" id="5874966">isFtyp</span>&nbsp;<span class="op" id="5874973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5874979">//&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874993">p</span><span class="op" id="5874994">.</span><span class="ident" id="5874995">expr</span><span class="op" id="5874999">(</span><span class="ident" id="5875000">f</span><span class="op" id="5875001">.</span><span class="ident" id="5875002">Names</span><span class="op" id="5875007">[</span><span class="num" id="5875008">0</span><span class="op" id="5875009">]</span><span class="op" id="5875010">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5875016">p</span><span class="op" id="5875017">.</span><span class="ident" id="5875018">signature</span><span class="op" id="5875027">(</span><span class="ident" id="5875028">ftyp</span><span class="op" id="5875032">.</span><span class="ident" id="5875033">Params</span><span class="op" id="5875039">,</span>&nbsp;<span class="ident" id="5875041">ftyp</span><span class="op" id="5875045">.</span><span class="ident" id="5875046">Results</span><span class="op" id="5875053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5875058">}</span>&nbsp;<span class="keyword" id="5875060">else</span>&nbsp;<span class="op" id="5875065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5875071">//&nbsp;embedded&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5875097">p</span><span class="op" id="5875098">.</span><span class="ident" id="5875099">expr</span><span class="op" id="5875103">(</span><span class="ident" id="5875104">f</span><span class="op" id="5875105">.</span><span class="ident" id="5875106">Type</span><span class="op" id="5875110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5875115">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5875120">p</span><span class="op" id="5875121">.</span><span class="ident" id="5875122">setComment</span><span class="op" id="5875132">(</span><span class="ident" id="5875133">f</span><span class="op" id="5875134">.</span><span class="ident" id="5875135">Comment</span><span class="op" id="5875142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5875146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875150">if</span>&nbsp;<span class="ident" id="5875153">isIncomplete</span>&nbsp;<span class="op" id="5875166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875171">if</span>&nbsp;<span class="builtinfunc" id="5875174">len</span><span class="op" id="5875177">(</span><span class="ident" id="5875178">list</span><span class="op" id="5875182">)</span>&nbsp;<span class="op" id="5875184">&gt;</span>&nbsp;<span class="num" id="5875186">0</span>&nbsp;<span class="op" id="5875188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5875194">p</span><span class="op" id="5875195">.</span><span class="builtinfunc" id="5875196">print</span><span class="op" id="5875201">(</span><span class="ident" id="5875202">formfeed</span><span class="op" id="5875210">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5875215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5875220">p</span><span class="op" id="5875221">.</span><span class="ident" id="5875222">flush</span><span class="op" id="5875227">(</span><span class="ident" id="5875228">p</span><span class="op" id="5875229">.</span><span class="ident" id="5875230">posFor</span><span class="op" id="5875236">(</span><span class="ident" id="5875237">rbrace</span><span class="op" id="5875243">)</span><span class="op" id="5875244">,</span>&nbsp;<span class="ident" id="5875246">token</span><span class="op" id="5875251">.</span><span class="ident" id="5875252">RBRACE</span><span class="op" id="5875258">)</span>&nbsp;<span class="comment" id="5875260">//&nbsp;make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;lose&nbsp;the&nbsp;last&nbsp;line&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5875312">p</span><span class="op" id="5875313">.</span><span class="ident" id="5875314">setLineComment</span><span class="op" id="5875328">(</span><span class="string" id="5875329">&#34;//&nbsp;contains&nbsp;filtered&nbsp;or&nbsp;unexported&nbsp;methods&#34;</span><span class="op" id="5875373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5875377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5875381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5875384">p</span><span class="op" id="5875385">.</span><span class="builtinfunc" id="5875386">print</span><span class="op" id="5875391">(</span><span class="ident" id="5875392">unindent</span><span class="op" id="5875400">,</span>&nbsp;<span class="ident" id="5875402">formfeed</span><span class="op" id="5875410">,</span>&nbsp;<span class="ident" id="5875412">rbrace</span><span class="op" id="5875418">,</span>&nbsp;<span class="ident" id="5875420">token</span><span class="op" id="5875425">.</span><span class="ident" id="5875426">RBRACE</span><span class="op" id="5875432">)</span><br>
<span class="lineno"></span><span class="op" id="5875434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5875437">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno">505</span><span class="comment" id="5875517">//&nbsp;Expressions</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5875533">func</span>&nbsp;<span class="ident" id="5875538">walkBinary</span><span class="op" id="5875548">(</span><span class="ident" id="5875549">e</span>&nbsp;<span class="op" id="5875551">*</span><span class="ident" id="5875552">ast</span><span class="op" id="5875555">.</span><span class="ident" id="5875556">BinaryExpr</span><span class="op" id="5875566">)</span>&nbsp;<span class="op" id="5875568">(</span><span class="ident" id="5875569">has4</span><span class="op" id="5875573">,</span>&nbsp;<span class="ident" id="5875575">has5</span>&nbsp;<span class="builtintype" id="5875580">bool</span><span class="op" id="5875584">,</span>&nbsp;<span class="ident" id="5875586">maxProblem</span>&nbsp;<span class="builtintype" id="5875597">int</span><span class="op" id="5875600">)</span>&nbsp;<span class="op" id="5875602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875605">switch</span>&nbsp;<span class="ident" id="5875612">e</span><span class="op" id="5875613">.</span><span class="ident" id="5875614">Op</span><span class="op" id="5875616">.</span><span class="ident" id="5875617">Precedence</span><span class="op" id="5875627">(</span><span class="op" id="5875628">)</span>&nbsp;<span class="op" id="5875630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875633">case</span>&nbsp;<span class="num" id="5875638">4</span><span class="op" id="5875639">:</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5875643">has4</span>&nbsp;<span class="op" id="5875648">=</span>&nbsp;<span class="builtintype" id="5875650">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875656">case</span>&nbsp;<span class="num" id="5875661">5</span><span class="op" id="5875662">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5875666">has5</span>&nbsp;<span class="op" id="5875671">=</span>&nbsp;<span class="builtintype" id="5875673">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5875679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875683">switch</span>&nbsp;<span class="ident" id="5875690">l</span>&nbsp;<span class="op" id="5875692">:=</span>&nbsp;<span class="ident" id="5875695">e</span><span class="op" id="5875696">.</span><span class="ident" id="5875697">X</span><span class="op" id="5875698">.</span><span class="op" id="5875699">(</span><span class="keyword" id="5875700">type</span><span class="op" id="5875704">)</span>&nbsp;<span class="op" id="5875706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875709">case</span>&nbsp;<span class="op" id="5875714">*</span><span class="ident" id="5875715">ast</span><span class="op" id="5875718">.</span><span class="ident" id="5875719">BinaryExpr</span><span class="op" id="5875729">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875733">if</span>&nbsp;<span class="ident" id="5875736">l</span><span class="op" id="5875737">.</span><span class="ident" id="5875738">Op</span><span class="op" id="5875740">.</span><span class="ident" id="5875741">Precedence</span><span class="op" id="5875751">(</span><span class="op" id="5875752">)</span>&nbsp;<span class="op" id="5875754">&lt;</span>&nbsp;<span class="ident" id="5875756">e</span><span class="op" id="5875757">.</span><span class="ident" id="5875758">Op</span><span class="op" id="5875760">.</span><span class="ident" id="5875761">Precedence</span><span class="op" id="5875771">(</span><span class="op" id="5875772">)</span>&nbsp;<span class="op" id="5875774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5875779">//&nbsp;parens&nbsp;will&nbsp;be&nbsp;inserted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5875810">//&nbsp;pretend&nbsp;this&nbsp;is&nbsp;an&nbsp;*ast.ParenExpr&nbsp;and&nbsp;do&nbsp;nothing.</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875866">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5875874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5875878">h4</span><span class="op" id="5875880">,</span>&nbsp;<span class="ident" id="5875882">h5</span><span class="op" id="5875884">,</span>&nbsp;<span class="ident" id="5875886">mp</span>&nbsp;<span class="op" id="5875889">:=</span>&nbsp;<span class="ident" id="5875892">walkBinary</span><span class="op" id="5875902">(</span><span class="ident" id="5875903">l</span><span class="op" id="5875904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5875908">has4</span>&nbsp;<span class="op" id="5875913">=</span>&nbsp;<span class="ident" id="5875915">has4</span>&nbsp;<span class="op" id="5875920">||</span>&nbsp;<span class="ident" id="5875923">h4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5875928">has5</span>&nbsp;<span class="op" id="5875933">=</span>&nbsp;<span class="ident" id="5875935">has5</span>&nbsp;<span class="op" id="5875940">||</span>&nbsp;<span class="ident" id="5875943">h5</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875948">if</span>&nbsp;<span class="ident" id="5875951">maxProblem</span>&nbsp;<span class="op" id="5875962">&lt;</span>&nbsp;<span class="ident" id="5875964">mp</span>&nbsp;<span class="op" id="5875967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5875972">maxProblem</span>&nbsp;<span class="op" id="5875983">=</span>&nbsp;<span class="ident" id="5875985">mp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5875990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5875993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875997">switch</span>&nbsp;<span class="ident" id="5876004">r</span>&nbsp;<span class="op" id="5876006">:=</span>&nbsp;<span class="ident" id="5876009">e</span><span class="op" id="5876010">.</span><span class="ident" id="5876011">Y</span><span class="op" id="5876012">.</span><span class="op" id="5876013">(</span><span class="keyword" id="5876014">type</span><span class="op" id="5876018">)</span>&nbsp;<span class="op" id="5876020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876023">case</span>&nbsp;<span class="op" id="5876028">*</span><span class="ident" id="5876029">ast</span><span class="op" id="5876032">.</span><span class="ident" id="5876033">BinaryExpr</span><span class="op" id="5876043">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876047">if</span>&nbsp;<span class="ident" id="5876050">r</span><span class="op" id="5876051">.</span><span class="ident" id="5876052">Op</span><span class="op" id="5876054">.</span><span class="ident" id="5876055">Precedence</span><span class="op" id="5876065">(</span><span class="op" id="5876066">)</span>&nbsp;<span class="op" id="5876068">&lt;=</span>&nbsp;<span class="ident" id="5876071">e</span><span class="op" id="5876072">.</span><span class="ident" id="5876073">Op</span><span class="op" id="5876075">.</span><span class="ident" id="5876076">Precedence</span><span class="op" id="5876086">(</span><span class="op" id="5876087">)</span>&nbsp;<span class="op" id="5876089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5876094">//&nbsp;parens&nbsp;will&nbsp;be&nbsp;inserted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5876125">//&nbsp;pretend&nbsp;this&nbsp;is&nbsp;an&nbsp;*ast.ParenExpr&nbsp;and&nbsp;do&nbsp;nothing.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876181">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5876189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876193">h4</span><span class="op" id="5876195">,</span>&nbsp;<span class="ident" id="5876197">h5</span><span class="op" id="5876199">,</span>&nbsp;<span class="ident" id="5876201">mp</span>&nbsp;<span class="op" id="5876204">:=</span>&nbsp;<span class="ident" id="5876207">walkBinary</span><span class="op" id="5876217">(</span><span class="ident" id="5876218">r</span><span class="op" id="5876219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876223">has4</span>&nbsp;<span class="op" id="5876228">=</span>&nbsp;<span class="ident" id="5876230">has4</span>&nbsp;<span class="op" id="5876235">||</span>&nbsp;<span class="ident" id="5876238">h4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876243">has5</span>&nbsp;<span class="op" id="5876248">=</span>&nbsp;<span class="ident" id="5876250">has5</span>&nbsp;<span class="op" id="5876255">||</span>&nbsp;<span class="ident" id="5876258">h5</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876263">if</span>&nbsp;<span class="ident" id="5876266">maxProblem</span>&nbsp;<span class="op" id="5876277">&lt;</span>&nbsp;<span class="ident" id="5876279">mp</span>&nbsp;<span class="op" id="5876282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876287">maxProblem</span>&nbsp;<span class="op" id="5876298">=</span>&nbsp;<span class="ident" id="5876300">mp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5876305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876309">case</span>&nbsp;<span class="op" id="5876314">*</span><span class="ident" id="5876315">ast</span><span class="op" id="5876318">.</span><span class="ident" id="5876319">StarExpr</span><span class="op" id="5876327">:</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876331">if</span>&nbsp;<span class="ident" id="5876334">e</span><span class="op" id="5876335">.</span><span class="ident" id="5876336">Op</span>&nbsp;<span class="op" id="5876339">==</span>&nbsp;<span class="ident" id="5876342">token</span><span class="op" id="5876347">.</span><span class="ident" id="5876348">QUO</span>&nbsp;<span class="op" id="5876352">{</span>&nbsp;<span class="comment" id="5876354">//&nbsp;`*/`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876365">maxProblem</span>&nbsp;<span class="op" id="5876376">=</span>&nbsp;<span class="num" id="5876378">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5876382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876386">case</span>&nbsp;<span class="op" id="5876391">*</span><span class="ident" id="5876392">ast</span><span class="op" id="5876395">.</span><span class="ident" id="5876396">UnaryExpr</span><span class="op" id="5876405">:</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876409">switch</span>&nbsp;<span class="ident" id="5876416">e</span><span class="op" id="5876417">.</span><span class="ident" id="5876418">Op</span><span class="op" id="5876420">.</span><span class="ident" id="5876421">String</span><span class="op" id="5876427">(</span><span class="op" id="5876428">)</span>&nbsp;<span class="op" id="5876430">+</span>&nbsp;<span class="ident" id="5876432">r</span><span class="op" id="5876433">.</span><span class="ident" id="5876434">Op</span><span class="op" id="5876436">.</span><span class="ident" id="5876437">String</span><span class="op" id="5876443">(</span><span class="op" id="5876444">)</span>&nbsp;<span class="op" id="5876446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876450">case</span>&nbsp;<span class="string" id="5876455">&#34;/*&#34;</span><span class="op" id="5876459">,</span>&nbsp;<span class="string" id="5876461">&#34;&amp;&amp;&#34;</span><span class="op" id="5876465">,</span>&nbsp;<span class="string" id="5876467">&#34;&amp;^&#34;</span><span class="op" id="5876471">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876476">maxProblem</span>&nbsp;<span class="op" id="5876487">=</span>&nbsp;<span class="num" id="5876489">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876493">case</span>&nbsp;<span class="string" id="5876498">&#34;++&#34;</span><span class="op" id="5876502">,</span>&nbsp;<span class="string" id="5876504">&#34;--&#34;</span><span class="op" id="5876508">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876513">if</span>&nbsp;<span class="ident" id="5876516">maxProblem</span>&nbsp;<span class="op" id="5876527">&lt;</span>&nbsp;<span class="num" id="5876529">4</span>&nbsp;<span class="op" id="5876531">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876537">maxProblem</span>&nbsp;<span class="op" id="5876548">=</span>&nbsp;<span class="num" id="5876550">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5876555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5876559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5876562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876565">return</span><br>
<span class="lineno">560</span><span class="op" id="5876572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5876575">func</span>&nbsp;<span class="ident" id="5876580">cutoff</span><span class="op" id="5876586">(</span><span class="ident" id="5876587">e</span>&nbsp;<span class="op" id="5876589">*</span><span class="ident" id="5876590">ast</span><span class="op" id="5876593">.</span><span class="ident" id="5876594">BinaryExpr</span><span class="op" id="5876604">,</span>&nbsp;<span class="ident" id="5876606">depth</span>&nbsp;<span class="builtintype" id="5876612">int</span><span class="op" id="5876615">)</span>&nbsp;<span class="builtintype" id="5876617">int</span>&nbsp;<span class="op" id="5876621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876624">has4</span><span class="op" id="5876628">,</span>&nbsp;<span class="ident" id="5876630">has5</span><span class="op" id="5876634">,</span>&nbsp;<span class="ident" id="5876636">maxProblem</span>&nbsp;<span class="op" id="5876647">:=</span>&nbsp;<span class="ident" id="5876650">walkBinary</span><span class="op" id="5876660">(</span><span class="ident" id="5876661">e</span><span class="op" id="5876662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876665">if</span>&nbsp;<span class="ident" id="5876668">maxProblem</span>&nbsp;<span class="op" id="5876679">&gt;</span>&nbsp;<span class="num" id="5876681">0</span>&nbsp;<span class="op" id="5876683">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876687">return</span>&nbsp;<span class="ident" id="5876694">maxProblem</span>&nbsp;<span class="op" id="5876705">+</span>&nbsp;<span class="num" id="5876707">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5876710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876713">if</span>&nbsp;<span class="ident" id="5876716">has4</span>&nbsp;<span class="op" id="5876721">&amp;&amp;</span>&nbsp;<span class="ident" id="5876724">has5</span>&nbsp;<span class="op" id="5876729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876733">if</span>&nbsp;<span class="ident" id="5876736">depth</span>&nbsp;<span class="op" id="5876742">==</span>&nbsp;<span class="num" id="5876745">1</span>&nbsp;<span class="op" id="5876747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876752">return</span>&nbsp;<span class="num" id="5876759">5</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5876763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876767">return</span>&nbsp;<span class="num" id="5876774">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5876777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876780">if</span>&nbsp;<span class="ident" id="5876783">depth</span>&nbsp;<span class="op" id="5876789">==</span>&nbsp;<span class="num" id="5876792">1</span>&nbsp;<span class="op" id="5876794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876798">return</span>&nbsp;<span class="num" id="5876805">6</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5876808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876811">return</span>&nbsp;<span class="num" id="5876818">4</span><br>
<span class="lineno"></span><span class="op" id="5876820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5876823">func</span>&nbsp;<span class="ident" id="5876828">diffPrec</span><span class="op" id="5876836">(</span><span class="ident" id="5876837">expr</span>&nbsp;<span class="ident" id="5876842">ast</span><span class="op" id="5876845">.</span><span class="ident" id="5876846">Expr</span><span class="op" id="5876850">,</span>&nbsp;<span class="ident" id="5876852">prec</span>&nbsp;<span class="builtintype" id="5876857">int</span><span class="op" id="5876860">)</span>&nbsp;<span class="builtintype" id="5876862">int</span>&nbsp;<span class="op" id="5876866">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876869">x</span><span class="op" id="5876870">,</span>&nbsp;<span class="ident" id="5876872">ok</span>&nbsp;<span class="op" id="5876875">:=</span>&nbsp;<span class="ident" id="5876878">expr</span><span class="op" id="5876882">.</span><span class="op" id="5876883">(</span><span class="op" id="5876884">*</span><span class="ident" id="5876885">ast</span><span class="op" id="5876888">.</span><span class="ident" id="5876889">BinaryExpr</span><span class="op" id="5876899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876902">if</span>&nbsp;<span class="op" id="5876905">!</span><span class="ident" id="5876906">ok</span>&nbsp;<span class="op" id="5876909">||</span>&nbsp;<span class="ident" id="5876912">prec</span>&nbsp;<span class="op" id="5876917">!=</span>&nbsp;<span class="ident" id="5876920">x</span><span class="op" id="5876921">.</span><span class="ident" id="5876922">Op</span><span class="op" id="5876924">.</span><span class="ident" id="5876925">Precedence</span><span class="op" id="5876935">(</span><span class="op" id="5876936">)</span>&nbsp;<span class="op" id="5876938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876942">return</span>&nbsp;<span class="num" id="5876949">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5876952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876955">return</span>&nbsp;<span class="num" id="5876962">0</span><br>
<span class="lineno">585</span><span class="op" id="5876964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5876967">func</span>&nbsp;<span class="ident" id="5876972">reduceDepth</span><span class="op" id="5876983">(</span><span class="ident" id="5876984">depth</span>&nbsp;<span class="builtintype" id="5876990">int</span><span class="op" id="5876993">)</span>&nbsp;<span class="builtintype" id="5876995">int</span>&nbsp;<span class="op" id="5876999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5877002">depth</span><span class="op" id="5877007">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5877011">if</span>&nbsp;<span class="ident" id="5877014">depth</span>&nbsp;<span class="op" id="5877020">&lt;</span>&nbsp;<span class="num" id="5877022">1</span>&nbsp;<span class="op" id="5877024">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5877028">depth</span>&nbsp;<span class="op" id="5877034">=</span>&nbsp;<span class="num" id="5877036">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5877039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5877042">return</span>&nbsp;<span class="ident" id="5877049">depth</span><br>
<span class="lineno"></span><span class="op" id="5877055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="5877058">//&nbsp;Format&nbsp;the&nbsp;binary&nbsp;expression:&nbsp;decide&nbsp;the&nbsp;cutoff&nbsp;and&nbsp;then&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="5877126">//&nbsp;Let&#39;s&nbsp;call&nbsp;depth&nbsp;==&nbsp;1&nbsp;Normal&nbsp;mode,&nbsp;and&nbsp;depth&nbsp;&gt;&nbsp;1&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno"></span><span class="comment" id="5877192">//&nbsp;(Algorithm&nbsp;suggestion&nbsp;by&nbsp;Russ&nbsp;Cox.)</span><br>
<span class="lineno"></span><span class="comment" id="5877231">//</span><br>
<span class="lineno"></span><span class="comment" id="5877234">//&nbsp;The&nbsp;precedences&nbsp;are:</span><br>
<span class="lineno">600</span><span class="comment" id="5877258">//&nbsp;&nbsp;&nbsp;&nbsp5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;/&nbsp;&nbsp;%&nbsp;&nbsp;&lt;&lt;&nbsp;&nbsp;&gt;&gt;&nbsp;&nbsp;&amp;&nbsp;&nbsp;&amp;^</span><br>
<span class="lineno"></span><span class="comment" id="5877298">//&nbsp;&nbsp;&nbsp;&nbsp4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;-&nbsp;&nbsp;|&nbsp;&nbsp;^</span><br>
<span class="lineno"></span><span class="comment" id="5877326">//&nbsp;&nbsp;&nbsp;&nbsp3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;==&nbsp;&nbsp;!=&nbsp;&nbsp;&lt;&nbsp;&nbsp;&lt;=&nbsp;&nbsp;&gt;&nbsp;&nbsp;&gt;=</span><br>
<span class="lineno"></span><span class="comment" id="5877364">//&nbsp;&nbsp;&nbsp;&nbsp2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;</span><br>
<span class="lineno"></span><span class="comment" id="5877384">//&nbsp;&nbsp;&nbsp;&nbsp1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||</span><br>
<span class="lineno">605</span><span class="comment" id="5877404">//</span><br>
<span class="lineno"></span><span class="comment" id="5877407">//&nbsp;The&nbsp;only&nbsp;decision&nbsp;is&nbsp;whether&nbsp;there&nbsp;will&nbsp;be&nbsp;spaces&nbsp;around&nbsp;levels&nbsp;4&nbsp;and&nbsp;5.</span><br>
<span class="lineno"></span><span class="comment" id="5877483">//&nbsp;There&nbsp;are&nbsp;never&nbsp;spaces&nbsp;at&nbsp;level&nbsp;6&nbsp;(unary),&nbsp;and&nbsp;always&nbsp;spaces&nbsp;at&nbsp;levels&nbsp;3&nbsp;and&nbsp;below.</span><br>
<span class="lineno"></span><span class="comment" id="5877570">//</span><br>
<span class="lineno"></span><span class="comment" id="5877573">//&nbsp;To&nbsp;choose&nbsp;the&nbsp;cutoff,&nbsp;look&nbsp;at&nbsp;the&nbsp;whole&nbsp;expression&nbsp;but&nbsp;excluding&nbsp;primary</span><br>
<span class="lineno">610</span><span class="comment" id="5877649">//&nbsp;expressions&nbsp;(function&nbsp;calls,&nbsp;parenthesized&nbsp;exprs),&nbsp;and&nbsp;apply&nbsp;these&nbsp;rules:</span><br>
<span class="lineno"></span><span class="comment" id="5877726">//</span><br>
<span class="lineno"></span><span class="comment" id="5877729">//&nbsp;&nbsp;&nbsp;&nbsp1)&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;binary&nbsp;operator&nbsp;with&nbsp;a&nbsp;right&nbsp;side&nbsp;unary&nbsp;operand</span><br>
<span class="lineno"></span><span class="comment" id="5877797">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;that&nbsp;would&nbsp;clash&nbsp;without&nbsp;a&nbsp;space,&nbsp;the&nbsp;cutoff&nbsp;must&nbsp;be&nbsp;(in&nbsp;order):</span><br>
<span class="lineno"></span><span class="comment" id="5877868">//</span><br>
<span class="lineno">615</span><span class="comment" id="5877871">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp/*&nbsp;&nbsp;&nbsp;&nbsp6</span><br>
<span class="lineno"></span><span class="comment" id="5877880">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&amp;&amp;&nbsp;&nbsp;&nbsp;&nbsp6</span><br>
<span class="lineno"></span><span class="comment" id="5877889">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&amp;^&nbsp;&nbsp;&nbsp;&nbsp6</span><br>
<span class="lineno"></span><span class="comment" id="5877898">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp++&nbsp;&nbsp;&nbsp;&nbsp5</span><br>
<span class="lineno"></span><span class="comment" id="5877907">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp--&nbsp;&nbsp;&nbsp;&nbsp5</span><br>
<span class="lineno">620</span><span class="comment" id="5877916">//</span><br>
<span class="lineno"></span><span class="comment" id="5877919">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Comparison&nbsp;operators&nbsp;always&nbsp;have&nbsp;spaces&nbsp;around&nbsp;them.)</span><br>
<span class="lineno"></span><span class="comment" id="5877985">//</span><br>
<span class="lineno"></span><span class="comment" id="5877988">//&nbsp;&nbsp;&nbsp;&nbsp2)&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;mix&nbsp;of&nbsp;level&nbsp;5&nbsp;and&nbsp;level&nbsp;4&nbsp;operators,&nbsp;then&nbsp;the&nbsp;cutoff</span><br>
<span class="lineno"></span><span class="comment" id="5878062">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;is&nbsp;5&nbsp;(use&nbsp;spaces&nbsp;to&nbsp;distinguish&nbsp;precedence)&nbsp;in&nbsp;Normal&nbsp;mode</span><br>
<span class="lineno">625</span><span class="comment" id="5878127">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;and&nbsp;4&nbsp;(never&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno"></span><span class="comment" id="5878175">//</span><br>
<span class="lineno"></span><span class="comment" id="5878178">//&nbsp;&nbsp;&nbsp;&nbsp3)&nbsp;If&nbsp;there&nbsp;are&nbsp;no&nbsp;level&nbsp;4&nbsp;operators&nbsp;or&nbsp;no&nbsp;level&nbsp;5&nbsp;operators,&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5878252">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;cutoff&nbsp;is&nbsp;6&nbsp;(always&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Normal&nbsp;mode</span><br>
<span class="lineno"></span><span class="comment" id="5878305">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;and&nbsp;4&nbsp;(never&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno">630</span><span class="comment" id="5878353">//</span><br>
<span class="lineno"></span><span class="keyword" id="5878356">func</span>&nbsp;<span class="op" id="5878361">(</span><span class="ident" id="5878362">p</span>&nbsp;<span class="op" id="5878364">*</span><span class="ident" id="5878365">printer</span><span class="op" id="5878372">)</span>&nbsp;<span class="ident" id="5878374">binaryExpr</span><span class="op" id="5878384">(</span><span class="ident" id="5878385">x</span>&nbsp;<span class="op" id="5878387">*</span><span class="ident" id="5878388">ast</span><span class="op" id="5878391">.</span><span class="ident" id="5878392">BinaryExpr</span><span class="op" id="5878402">,</span>&nbsp;<span class="ident" id="5878404">prec1</span><span class="op" id="5878409">,</span>&nbsp;<span class="ident" id="5878411">cutoff</span><span class="op" id="5878417">,</span>&nbsp;<span class="ident" id="5878419">depth</span>&nbsp;<span class="builtintype" id="5878425">int</span><span class="op" id="5878428">)</span>&nbsp;<span class="op" id="5878430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878433">prec</span>&nbsp;<span class="op" id="5878438">:=</span>&nbsp;<span class="ident" id="5878441">x</span><span class="op" id="5878442">.</span><span class="ident" id="5878443">Op</span><span class="op" id="5878445">.</span><span class="ident" id="5878446">Precedence</span><span class="op" id="5878456">(</span><span class="op" id="5878457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878460">if</span>&nbsp;<span class="ident" id="5878463">prec</span>&nbsp;<span class="op" id="5878468">&lt;</span>&nbsp;<span class="ident" id="5878470">prec1</span>&nbsp;<span class="op" id="5878476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5878480">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5878504">//&nbsp;Note:&nbsp;The&nbsp;parser&nbsp;inserts&nbsp;an&nbsp;ast.ParenExpr&nbsp;node;&nbsp;thus&nbsp;this&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5878572">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can&nbsp;only&nbsp;occur&nbsp;if&nbsp;the&nbsp;AST&nbsp;is&nbsp;created&nbsp;in&nbsp;a&nbsp;different&nbsp;way.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878640">p</span><span class="op" id="5878641">.</span><span class="builtinfunc" id="5878642">print</span><span class="op" id="5878647">(</span><span class="ident" id="5878648">token</span><span class="op" id="5878653">.</span><span class="ident" id="5878654">LPAREN</span><span class="op" id="5878660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878664">p</span><span class="op" id="5878665">.</span><span class="ident" id="5878666">expr0</span><span class="op" id="5878671">(</span><span class="ident" id="5878672">x</span><span class="op" id="5878673">,</span>&nbsp;<span class="ident" id="5878675">reduceDepth</span><span class="op" id="5878686">(</span><span class="ident" id="5878687">depth</span><span class="op" id="5878692">)</span><span class="op" id="5878693">)</span>&nbsp;<span class="comment" id="5878695">//&nbsp;parentheses&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878736">p</span><span class="op" id="5878737">.</span><span class="builtinfunc" id="5878738">print</span><span class="op" id="5878743">(</span><span class="ident" id="5878744">token</span><span class="op" id="5878749">.</span><span class="ident" id="5878750">RPAREN</span><span class="op" id="5878756">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878760">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5878768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878772">printBlank</span>&nbsp;<span class="op" id="5878783">:=</span>&nbsp;<span class="ident" id="5878786">prec</span>&nbsp;<span class="op" id="5878791">&lt;</span>&nbsp;<span class="ident" id="5878793">cutoff</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878802">ws</span>&nbsp;<span class="op" id="5878805">:=</span>&nbsp;<span class="ident" id="5878808">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878816">p</span><span class="op" id="5878817">.</span><span class="ident" id="5878818">expr1</span><span class="op" id="5878823">(</span><span class="ident" id="5878824">x</span><span class="op" id="5878825">.</span><span class="ident" id="5878826">X</span><span class="op" id="5878827">,</span>&nbsp;<span class="ident" id="5878829">prec</span><span class="op" id="5878833">,</span>&nbsp;<span class="ident" id="5878835">depth</span><span class="op" id="5878840">+</span><span class="ident" id="5878841">diffPrec</span><span class="op" id="5878849">(</span><span class="ident" id="5878850">x</span><span class="op" id="5878851">.</span><span class="ident" id="5878852">X</span><span class="op" id="5878853">,</span>&nbsp;<span class="ident" id="5878855">prec</span><span class="op" id="5878859">)</span><span class="op" id="5878860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878863">if</span>&nbsp;<span class="ident" id="5878866">printBlank</span>&nbsp;<span class="op" id="5878877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878881">p</span><span class="op" id="5878882">.</span><span class="builtinfunc" id="5878883">print</span><span class="op" id="5878888">(</span><span class="ident" id="5878889">blank</span><span class="op" id="5878894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5878897">}</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878900">xline</span>&nbsp;<span class="op" id="5878906">:=</span>&nbsp;<span class="ident" id="5878909">p</span><span class="op" id="5878910">.</span><span class="ident" id="5878911">pos</span><span class="op" id="5878914">.</span><span class="ident" id="5878915">Line</span>&nbsp;<span class="comment" id="5878920">//&nbsp;before&nbsp;the&nbsp;operator&nbsp;(it&nbsp;may&nbsp;be&nbsp;on&nbsp;the&nbsp;next&nbsp;line!)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878974">yline</span>&nbsp;<span class="op" id="5878980">:=</span>&nbsp;<span class="ident" id="5878983">p</span><span class="op" id="5878984">.</span><span class="ident" id="5878985">lineFor</span><span class="op" id="5878992">(</span><span class="ident" id="5878993">x</span><span class="op" id="5878994">.</span><span class="ident" id="5878995">Y</span><span class="op" id="5878996">.</span><span class="ident" id="5878997">Pos</span><span class="op" id="5879000">(</span><span class="op" id="5879001">)</span><span class="op" id="5879002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879005">p</span><span class="op" id="5879006">.</span><span class="builtinfunc" id="5879007">print</span><span class="op" id="5879012">(</span><span class="ident" id="5879013">x</span><span class="op" id="5879014">.</span><span class="ident" id="5879015">OpPos</span><span class="op" id="5879020">,</span>&nbsp;<span class="ident" id="5879022">x</span><span class="op" id="5879023">.</span><span class="ident" id="5879024">Op</span><span class="op" id="5879026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879029">if</span>&nbsp;<span class="ident" id="5879032">xline</span>&nbsp;<span class="op" id="5879038">!=</span>&nbsp;<span class="ident" id="5879041">yline</span>&nbsp;<span class="op" id="5879047">&amp;&amp;</span>&nbsp;<span class="ident" id="5879050">xline</span>&nbsp;<span class="op" id="5879056">&gt;</span>&nbsp;<span class="num" id="5879058">0</span>&nbsp;<span class="op" id="5879060">&amp;&amp;</span>&nbsp;<span class="ident" id="5879063">yline</span>&nbsp;<span class="op" id="5879069">&gt;</span>&nbsp;<span class="num" id="5879071">0</span>&nbsp;<span class="op" id="5879073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5879077">//&nbsp;at&nbsp;least&nbsp;one&nbsp;line&nbsp;break,&nbsp;but&nbsp;respect&nbsp;an&nbsp;extra&nbsp;empty&nbsp;line</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5879139">//&nbsp;in&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879158">if</span>&nbsp;<span class="ident" id="5879161">p</span><span class="op" id="5879162">.</span><span class="ident" id="5879163">linebreak</span><span class="op" id="5879172">(</span><span class="ident" id="5879173">yline</span><span class="op" id="5879178">,</span>&nbsp;<span class="num" id="5879180">1</span><span class="op" id="5879181">,</span>&nbsp;<span class="ident" id="5879183">ws</span><span class="op" id="5879185">,</span>&nbsp;<span class="builtintype" id="5879187">true</span><span class="op" id="5879191">)</span>&nbsp;<span class="op" id="5879193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879198">ws</span>&nbsp;<span class="op" id="5879201">=</span>&nbsp;<span class="ident" id="5879203">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879213">printBlank</span>&nbsp;<span class="op" id="5879224">=</span>&nbsp;<span class="builtintype" id="5879226">false</span>&nbsp;<span class="comment" id="5879232">//&nbsp;no&nbsp;blank&nbsp;after&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5879263">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5879266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879269">if</span>&nbsp;<span class="ident" id="5879272">printBlank</span>&nbsp;<span class="op" id="5879283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879287">p</span><span class="op" id="5879288">.</span><span class="builtinfunc" id="5879289">print</span><span class="op" id="5879294">(</span><span class="ident" id="5879295">blank</span><span class="op" id="5879300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5879303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879306">p</span><span class="op" id="5879307">.</span><span class="ident" id="5879308">expr1</span><span class="op" id="5879313">(</span><span class="ident" id="5879314">x</span><span class="op" id="5879315">.</span><span class="ident" id="5879316">Y</span><span class="op" id="5879317">,</span>&nbsp;<span class="ident" id="5879319">prec</span><span class="op" id="5879323">+</span><span class="num" id="5879324">1</span><span class="op" id="5879325">,</span>&nbsp;<span class="ident" id="5879327">depth</span><span class="op" id="5879332">+</span><span class="num" id="5879333">1</span><span class="op" id="5879334">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879337">if</span>&nbsp;<span class="ident" id="5879340">ws</span>&nbsp;<span class="op" id="5879343">==</span>&nbsp;<span class="ident" id="5879346">ignore</span>&nbsp;<span class="op" id="5879353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879357">p</span><span class="op" id="5879358">.</span><span class="builtinfunc" id="5879359">print</span><span class="op" id="5879364">(</span><span class="ident" id="5879365">unindent</span><span class="op" id="5879373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5879376">}</span><br>
<span class="lineno"></span><span class="op" id="5879378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="keyword" id="5879381">func</span>&nbsp;<span class="ident" id="5879386">isBinary</span><span class="op" id="5879394">(</span><span class="ident" id="5879395">expr</span>&nbsp;<span class="ident" id="5879400">ast</span><span class="op" id="5879403">.</span><span class="ident" id="5879404">Expr</span><span class="op" id="5879408">)</span>&nbsp;<span class="builtintype" id="5879410">bool</span>&nbsp;<span class="op" id="5879415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879418">_</span><span class="op" id="5879419">,</span>&nbsp;<span class="ident" id="5879421">ok</span>&nbsp;<span class="op" id="5879424">:=</span>&nbsp;<span class="ident" id="5879427">expr</span><span class="op" id="5879431">.</span><span class="op" id="5879432">(</span><span class="op" id="5879433">*</span><span class="ident" id="5879434">ast</span><span class="op" id="5879437">.</span><span class="ident" id="5879438">BinaryExpr</span><span class="op" id="5879448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879451">return</span>&nbsp;<span class="ident" id="5879458">ok</span><br>
<span class="lineno"></span><span class="op" id="5879461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="5879464">func</span>&nbsp;<span class="op" id="5879469">(</span><span class="ident" id="5879470">p</span>&nbsp;<span class="op" id="5879472">*</span><span class="ident" id="5879473">printer</span><span class="op" id="5879480">)</span>&nbsp;<span class="ident" id="5879482">expr1</span><span class="op" id="5879487">(</span><span class="ident" id="5879488">expr</span>&nbsp;<span class="ident" id="5879493">ast</span><span class="op" id="5879496">.</span><span class="ident" id="5879497">Expr</span><span class="op" id="5879501">,</span>&nbsp;<span class="ident" id="5879503">prec1</span><span class="op" id="5879508">,</span>&nbsp;<span class="ident" id="5879510">depth</span>&nbsp;<span class="builtintype" id="5879516">int</span><span class="op" id="5879519">)</span>&nbsp;<span class="op" id="5879521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879524">p</span><span class="op" id="5879525">.</span><span class="builtinfunc" id="5879526">print</span><span class="op" id="5879531">(</span><span class="ident" id="5879532">expr</span><span class="op" id="5879536">.</span><span class="ident" id="5879537">Pos</span><span class="op" id="5879540">(</span><span class="op" id="5879541">)</span><span class="op" id="5879542">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879546">switch</span>&nbsp;<span class="ident" id="5879553">x</span>&nbsp;<span class="op" id="5879555">:=</span>&nbsp;<span class="ident" id="5879558">expr</span><span class="op" id="5879562">.</span><span class="op" id="5879563">(</span><span class="keyword" id="5879564">type</span><span class="op" id="5879568">)</span>&nbsp;<span class="op" id="5879570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879573">case</span>&nbsp;<span class="op" id="5879578">*</span><span class="ident" id="5879579">ast</span><span class="op" id="5879582">.</span><span class="ident" id="5879583">BadExpr</span><span class="op" id="5879590">:</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879594">p</span><span class="op" id="5879595">.</span><span class="builtinfunc" id="5879596">print</span><span class="op" id="5879601">(</span><span class="string" id="5879602">&#34;BadExpr&#34;</span><span class="op" id="5879611">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879615">case</span>&nbsp;<span class="op" id="5879620">*</span><span class="ident" id="5879621">ast</span><span class="op" id="5879624">.</span><span class="ident" id="5879625">Ident</span><span class="op" id="5879630">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879634">p</span><span class="op" id="5879635">.</span><span class="builtinfunc" id="5879636">print</span><span class="op" id="5879641">(</span><span class="ident" id="5879642">x</span><span class="op" id="5879643">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879647">case</span>&nbsp;<span class="op" id="5879652">*</span><span class="ident" id="5879653">ast</span><span class="op" id="5879656">.</span><span class="ident" id="5879657">BinaryExpr</span><span class="op" id="5879667">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879671">if</span>&nbsp;<span class="ident" id="5879674">depth</span>&nbsp;<span class="op" id="5879680">&lt;</span>&nbsp;<span class="num" id="5879682">1</span>&nbsp;<span class="op" id="5879684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879689">p</span><span class="op" id="5879690">.</span><span class="ident" id="5879691">internalError</span><span class="op" id="5879704">(</span><span class="string" id="5879705">&#34;depth&nbsp;&lt;&nbsp;1:&#34;</span><span class="op" id="5879717">,</span>&nbsp;<span class="ident" id="5879719">depth</span><span class="op" id="5879724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879729">depth</span>&nbsp;<span class="op" id="5879735">=</span>&nbsp;<span class="num" id="5879737">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5879741">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879745">p</span><span class="op" id="5879746">.</span><span class="ident" id="5879747">binaryExpr</span><span class="op" id="5879757">(</span><span class="ident" id="5879758">x</span><span class="op" id="5879759">,</span>&nbsp;<span class="ident" id="5879761">prec1</span><span class="op" id="5879766">,</span>&nbsp;<span class="ident" id="5879768">cutoff</span><span class="op" id="5879774">(</span><span class="ident" id="5879775">x</span><span class="op" id="5879776">,</span>&nbsp;<span class="ident" id="5879778">depth</span><span class="op" id="5879783">)</span><span class="op" id="5879784">,</span>&nbsp;<span class="ident" id="5879786">depth</span><span class="op" id="5879791">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879795">case</span>&nbsp;<span class="op" id="5879800">*</span><span class="ident" id="5879801">ast</span><span class="op" id="5879804">.</span><span class="ident" id="5879805">KeyValueExpr</span><span class="op" id="5879817">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879821">p</span><span class="op" id="5879822">.</span><span class="ident" id="5879823">expr</span><span class="op" id="5879827">(</span><span class="ident" id="5879828">x</span><span class="op" id="5879829">.</span><span class="ident" id="5879830">Key</span><span class="op" id="5879833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879837">p</span><span class="op" id="5879838">.</span><span class="builtinfunc" id="5879839">print</span><span class="op" id="5879844">(</span><span class="ident" id="5879845">x</span><span class="op" id="5879846">.</span><span class="ident" id="5879847">Colon</span><span class="op" id="5879852">,</span>&nbsp;<span class="ident" id="5879854">token</span><span class="op" id="5879859">.</span><span class="ident" id="5879860">COLON</span><span class="op" id="5879865">,</span>&nbsp;<span class="ident" id="5879867">blank</span><span class="op" id="5879872">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879876">p</span><span class="op" id="5879877">.</span><span class="ident" id="5879878">expr</span><span class="op" id="5879882">(</span><span class="ident" id="5879883">x</span><span class="op" id="5879884">.</span><span class="ident" id="5879885">Value</span><span class="op" id="5879890">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879894">case</span>&nbsp;<span class="op" id="5879899">*</span><span class="ident" id="5879900">ast</span><span class="op" id="5879903">.</span><span class="ident" id="5879904">StarExpr</span><span class="op" id="5879912">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879916">const</span>&nbsp;<span class="ident" id="5879922">prec</span>&nbsp;<span class="op" id="5879927">=</span>&nbsp;<span class="ident" id="5879929">token</span><span class="op" id="5879934">.</span><span class="ident" id="5879935">UnaryPrec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879947">if</span>&nbsp;<span class="ident" id="5879950">prec</span>&nbsp;<span class="op" id="5879955">&lt;</span>&nbsp;<span class="ident" id="5879957">prec1</span>&nbsp;<span class="op" id="5879963">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5879968">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879993">p</span><span class="op" id="5879994">.</span><span class="builtinfunc" id="5879995">print</span><span class="op" id="5880000">(</span><span class="ident" id="5880001">token</span><span class="op" id="5880006">.</span><span class="ident" id="5880007">LPAREN</span><span class="op" id="5880013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5880018">p</span><span class="op" id="5880019">.</span><span class="builtinfunc" id="5880020">print</span><span class="op" id="5880025">(</span><span class="ident" id="5880026">token</span><span class="op" id="5880031">.</span><span class="ident" id="5880032">MUL</span><span class="op" id="5880035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5880040">p</span><span class="op" id="5880041">.</span><span class="ident" id="5880042">expr</span><span class="op" id="5880046">(</span><span class="ident" id="5880047">x</span><span class="op" id="5880048">.</span><span class="ident" id="5880049">X</span><span class="op" id="5880050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5880055">p</span><span class="op" id="5880056">.</span><span class="builtinfunc" id="5880057">print</span><span class="op" id="5880062">(</span><span class="ident" id="5880063">token</span><span class="op" id="5880068">.</span><span class="ident" id="5880069">RPAREN</span><span class="op" id="5880075">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5880079">}</span>&nbsp;<span class="keyword" id="5880081">else</span>&nbsp;<span class="op" id="5880086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5880091">//&nbsp;no&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5880119">p</span><span class="op" id="5880120">.</span><span class="builtinfunc" id="5880121">print</span><span class="op" id="5880126">(</span><span class="ident" id="5880127">token</span><span class="op" id="5880132">.</span><span class="ident" id="5880133">MUL</span><span class="op" id="5880136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5880141">p</span><span class="op" id="5880142">.</span><span class="ident" id="5880143">expr</span><span class="op" id="5880147">(</span><span class="ident" id="5880148">x</span><span class="op" id="5880149">.</span><span class="ident" id="5880150">X</span><span class="op" id="5880151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5880155">}</span><br>
<span class="lineno">710</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5880159">case</span>&nbsp;<span class="op" id="5880164">*</span><span class="ident" id="5880165">ast</span><span class="op" id="5880168">.</span><span class="ident" id="5880169">UnaryExpr</span><span class="op" id="5880178">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5880182">const</span>&nbsp;<span class="ident" id="5880188">prec</span>&nbsp;<span class="op" id="5880193">=</span>&nbsp;<span class="ident" id="5880195">token</span><span class="op" id="5880200">.</span><span class="ident" id="5880201">UnaryPrec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5880213">if</span>&nbsp;<span class="ident" id="5880216">prec</span>&nbsp;<span class="op" id="5880221">&lt;</span>&nbsp;<span class="ident" id="5880223">prec1</span>&nbsp;<span class="op" id="5880229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5880234">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5880259">p</span><span class="op" id="5880260">.</span><span class="builtinfunc" id="5880261">print</span><span class="op" id="5880266">(</span><span class="ident" id="5880267">token</span><span class="op" id="5880272">.</span><span class="ident" id="5880273">LPAREN</span><span class="op" id="5880279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5880284">p</span><span class="op" id="5880285">.</span><span class="ident" id="5880286">expr</span><span class="op" id="5880290">(</span><span class="ident" id="5880291">x</span><span class="op" id="5880292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5880297">p</span><span class="op" id="5880298">.</span><span class="builtinfunc" id="5880299">print</span><span class="op" id="5880304">(</span><span class="ident" id="5880305">token</span><span class="op" id="5880310">.</span><span class="ident" id="5880311">RPAREN</span><span class="op" id="5880317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5880321">}</span>&nbsp;<span class="keyword" id="5880323">else</span>&nbsp;<span class="op" id="5880328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5880333">//&nbsp;no&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5880361">p</span><span class="op" id="5880362">.</span><span class="builtinfunc" id="5880363">print</span><span class="op" id="5880368">(</span><span class="ident" id="5880369">x</span><span class="op" id="5880370">.</span><span class="ident" id="5880371">Op</span><span class="op" id="5880373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5880378">if</span>&nbsp;<span class="ident" id="5880381">x</span><span class="op" id="5880382">.</span><span class="ident" id="5880383">Op</span>&nbsp;<span class="op" id="5880386">==</span>&nbsp;<span class="ident" id="5880389">token</span><span class="op" id="5880394">.</span><span class="ident" id="5880395">RANGE</span>&nbsp;<span class="op" id="5880401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5880407">//&nbsp;TODO(gri)&nbsp;Remove&nbsp;this&nbsp;code&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be&nbsp;reached.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5880466">p</span><span class="op" id="5880467">.</span><span class="builtinfunc" id="5880468">print</span><span class="op" id="5880473">(</span><span class="ident" id="5880474">blank</span><span class="op" id="5880479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5880484">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5880489">p</span><span class="op" id="5880490">.</span><span class="ident" id="5880491">expr1</span><span class="op" id="5880496">(</span><span class="ident" id="5880497">x</span><span class="op" id="5880498">.</span><span class="ident" id="5880499">X</span><span class="op" id="5880500">,</span>&nbsp;<span class="ident" id="5880502">prec</span><span class="op" id="5880506">,</span>&nbsp;<span class="ident" id="5880508">depth</span><span class="op" id="5880513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5880517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5880521">case</span>&nbsp;<span class="op" id="5880526">*</span><span class="ident" id="5880527">ast</span><span class="op" id="5880530">.</span><span class="ident" id="5880531">BasicLit</span><span class="op" id="5880539">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5880543">p</span><span class="op" id="5880544">.</span><span class="builtinfunc" id="5880545">print</span><span class="op" id="5880550">(</span><span class="ident" id="5880551">x</span><span class="op" id="5880552">)</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5880556">case</span>&nbsp;<span class="op" id="5880561">*</span><span class="ident" id="5880562">ast</span><span class="op" id="5880565">.</span><span class="ident" id="5880566">FuncLit</span><span class="op" id="5880573">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5880577">p</span><span class="op" id="5880578">.</span><span class="ident" id="5880579">expr</span><span class="op" id="5880583">(</span><span class="ident" id="5880584">x</span><span class="op" id="5880585">.</span><span class="ident" id="5880586">Type</span><span class="op" id="5880590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5880594">p</span><span class="op" id="5880595">.</span><span class="ident" id="5880596">adjBlock</span><span class="op" id="5880604">(</span><span class="ident" id="5880605">p</span><span class="op" id="5880606">.</span><span class="ident" id="5880607">distanceFrom</span><span class="op" id="5880619">(</span><span class="ident" id="5880620">x</span><span class="op" id="5880621">.</span><span class="ident" id="5880622">Type</span><span class="op" id="5880626">.</span><span class="ident" id="5880627">Pos</span><span class="op" id="5880630">(</span><span class="op" id="5880631">)</span><span class="op" id="5880632">)</span><span class="op" id="5880633">,</span>&nbsp;<span class="ident" id="5880635">blank</span><span class="op" id="5880640">,</span>&nbsp;<span class="ident" id="5880642">x</span><span class="op" id="5880643">.</span><span class="ident" id="5880644">Body</span><span class="op" id="5880648">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5880652">case</span>&nbsp;<span class="op" id="5880657">*</span><span class="ident" id="5880658">ast</span><span class="op" id="5880661">.</span><span class="ident" id="5880662">ParenExpr</span><span class="op" id="5880671">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5880675">if</span>&nbsp;<span class="ident" id="5880678">_</span><span class="op" id="5880679">,</span>&nbsp;<span class="ident" id="5880681">hasParens</span>&nbsp;<span class="op" id="5880691">:=</span>&nbsp;<span class="ident" id="5880694">x</span><span class="op" id="5880695">.</span><span class="ident" id="5880696">X</span><span class="op" id="5880697">.</span><span class="op" id="5880698">(</span><span class="op" id="5880699">*</span><span class="ident" id="5880700">ast</span><span class="op" id="5880703">.</span><span class="ident" id="5880704">ParenExpr</span><span class="op" id="5880713">)</span><span class="op" id="5880714">;</span>&nbsp;<span class="ident" id="5880716">hasParens</span>&nbsp;<span class="op" id="5880726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5880731">//&nbsp;don&#39;t&nbsp;print&nbsp;parentheses&nbsp;around&nbsp;an&nbsp;already&nbsp;parenthesized&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5880804">//&nbsp;TODO(gri)&nbsp;consider&nbsp;making&nbsp;this&nbsp;more&nbsp;general&nbsp;and&nbsp;incorporate&nbsp;precedence&nbsp;levels</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5880888">p</span><span class="op" id="5880889">.</span><span class="ident" id="5880890">expr0</span><span class="op" id="5880895">(</span><span class="ident" id="5880896">x</span><span class="op" id="5880897">.</span><span class="ident" id="5880898">X</span><span class="op" id="5880899">,</span>&nbsp;<span class="ident" id="5880901">depth</span><span class="op" id="5880906">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5880910">}</span>&nbsp;<span class="keyword" id="5880912">else</span>&nbsp;<span class="op" id="5880917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5880922">p</span><span class="op" id="5880923">.</span><span class="builtinfunc" id="5880924">print</span><span class="op" id="5880929">(</span><span class="ident" id="5880930">token</span><span class="op" id="5880935">.</span><span class="ident" id="5880936">LPAREN</span><span class="op" id="5880942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5880947">p</span><span class="op" id="5880948">.</span><span class="ident" id="5880949">expr0</span><span class="op" id="5880954">(</span><span class="ident" id="5880955">x</span><span class="op" id="5880956">.</span><span class="ident" id="5880957">X</span><span class="op" id="5880958">,</span>&nbsp;<span class="ident" id="5880960">reduceDepth</span><span class="op" id="5880971">(</span><span class="ident" id="5880972">depth</span><span class="op" id="5880977">)</span><span class="op" id="5880978">)</span>&nbsp;<span class="comment" id="5880980">//&nbsp;parentheses&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881022">p</span><span class="op" id="5881023">.</span><span class="builtinfunc" id="5881024">print</span><span class="op" id="5881029">(</span><span class="ident" id="5881030">x</span><span class="op" id="5881031">.</span><span class="ident" id="5881032">Rparen</span><span class="op" id="5881038">,</span>&nbsp;<span class="ident" id="5881040">token</span><span class="op" id="5881045">.</span><span class="ident" id="5881046">RPAREN</span><span class="op" id="5881052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5881056">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5881060">case</span>&nbsp;<span class="op" id="5881065">*</span><span class="ident" id="5881066">ast</span><span class="op" id="5881069">.</span><span class="ident" id="5881070">SelectorExpr</span><span class="op" id="5881082">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881086">p</span><span class="op" id="5881087">.</span><span class="ident" id="5881088">expr1</span><span class="op" id="5881093">(</span><span class="ident" id="5881094">x</span><span class="op" id="5881095">.</span><span class="ident" id="5881096">X</span><span class="op" id="5881097">,</span>&nbsp;<span class="ident" id="5881099">token</span><span class="op" id="5881104">.</span><span class="ident" id="5881105">HighestPrec</span><span class="op" id="5881116">,</span>&nbsp;<span class="ident" id="5881118">depth</span><span class="op" id="5881123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881127">p</span><span class="op" id="5881128">.</span><span class="builtinfunc" id="5881129">print</span><span class="op" id="5881134">(</span><span class="ident" id="5881135">token</span><span class="op" id="5881140">.</span><span class="ident" id="5881141">PERIOD</span><span class="op" id="5881147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5881151">if</span>&nbsp;<span class="ident" id="5881154">line</span>&nbsp;<span class="op" id="5881159">:=</span>&nbsp;<span class="ident" id="5881162">p</span><span class="op" id="5881163">.</span><span class="ident" id="5881164">lineFor</span><span class="op" id="5881171">(</span><span class="ident" id="5881172">x</span><span class="op" id="5881173">.</span><span class="ident" id="5881174">Sel</span><span class="op" id="5881177">.</span><span class="ident" id="5881178">Pos</span><span class="op" id="5881181">(</span><span class="op" id="5881182">)</span><span class="op" id="5881183">)</span><span class="op" id="5881184">;</span>&nbsp;<span class="ident" id="5881186">p</span><span class="op" id="5881187">.</span><span class="ident" id="5881188">pos</span><span class="op" id="5881191">.</span><span class="ident" id="5881192">IsValid</span><span class="op" id="5881199">(</span><span class="op" id="5881200">)</span>&nbsp;<span class="op" id="5881202">&amp;&amp;</span>&nbsp;<span class="ident" id="5881205">p</span><span class="op" id="5881206">.</span><span class="ident" id="5881207">pos</span><span class="op" id="5881210">.</span><span class="ident" id="5881211">Line</span>&nbsp;<span class="op" id="5881216">&lt;</span>&nbsp;<span class="ident" id="5881218">line</span>&nbsp;<span class="op" id="5881223">{</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881228">p</span><span class="op" id="5881229">.</span><span class="builtinfunc" id="5881230">print</span><span class="op" id="5881235">(</span><span class="ident" id="5881236">indent</span><span class="op" id="5881242">,</span>&nbsp;<span class="ident" id="5881244">newline</span><span class="op" id="5881251">,</span>&nbsp;<span class="ident" id="5881253">x</span><span class="op" id="5881254">.</span><span class="ident" id="5881255">Sel</span><span class="op" id="5881258">.</span><span class="ident" id="5881259">Pos</span><span class="op" id="5881262">(</span><span class="op" id="5881263">)</span><span class="op" id="5881264">,</span>&nbsp;<span class="ident" id="5881266">x</span><span class="op" id="5881267">.</span><span class="ident" id="5881268">Sel</span><span class="op" id="5881271">,</span>&nbsp;<span class="ident" id="5881273">unindent</span><span class="op" id="5881281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5881285">}</span>&nbsp;<span class="keyword" id="5881287">else</span>&nbsp;<span class="op" id="5881292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881297">p</span><span class="op" id="5881298">.</span><span class="builtinfunc" id="5881299">print</span><span class="op" id="5881304">(</span><span class="ident" id="5881305">x</span><span class="op" id="5881306">.</span><span class="ident" id="5881307">Sel</span><span class="op" id="5881310">.</span><span class="ident" id="5881311">Pos</span><span class="op" id="5881314">(</span><span class="op" id="5881315">)</span><span class="op" id="5881316">,</span>&nbsp;<span class="ident" id="5881318">x</span><span class="op" id="5881319">.</span><span class="ident" id="5881320">Sel</span><span class="op" id="5881323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5881327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5881331">case</span>&nbsp;<span class="op" id="5881336">*</span><span class="ident" id="5881337">ast</span><span class="op" id="5881340">.</span><span class="ident" id="5881341">TypeAssertExpr</span><span class="op" id="5881355">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881359">p</span><span class="op" id="5881360">.</span><span class="ident" id="5881361">expr1</span><span class="op" id="5881366">(</span><span class="ident" id="5881367">x</span><span class="op" id="5881368">.</span><span class="ident" id="5881369">X</span><span class="op" id="5881370">,</span>&nbsp;<span class="ident" id="5881372">token</span><span class="op" id="5881377">.</span><span class="ident" id="5881378">HighestPrec</span><span class="op" id="5881389">,</span>&nbsp;<span class="ident" id="5881391">depth</span><span class="op" id="5881396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881400">p</span><span class="op" id="5881401">.</span><span class="builtinfunc" id="5881402">print</span><span class="op" id="5881407">(</span><span class="ident" id="5881408">token</span><span class="op" id="5881413">.</span><span class="ident" id="5881414">PERIOD</span><span class="op" id="5881420">,</span>&nbsp;<span class="ident" id="5881422">x</span><span class="op" id="5881423">.</span><span class="ident" id="5881424">Lparen</span><span class="op" id="5881430">,</span>&nbsp;<span class="ident" id="5881432">token</span><span class="op" id="5881437">.</span><span class="ident" id="5881438">LPAREN</span><span class="op" id="5881444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5881448">if</span>&nbsp;<span class="ident" id="5881451">x</span><span class="op" id="5881452">.</span><span class="ident" id="5881453">Type</span>&nbsp;<span class="op" id="5881458">!=</span>&nbsp;<span class="ident" id="5881461">nil</span>&nbsp;<span class="op" id="5881465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881470">p</span><span class="op" id="5881471">.</span><span class="ident" id="5881472">expr</span><span class="op" id="5881476">(</span><span class="ident" id="5881477">x</span><span class="op" id="5881478">.</span><span class="ident" id="5881479">Type</span><span class="op" id="5881483">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5881487">}</span>&nbsp;<span class="keyword" id="5881489">else</span>&nbsp;<span class="op" id="5881494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881499">p</span><span class="op" id="5881500">.</span><span class="builtinfunc" id="5881501">print</span><span class="op" id="5881506">(</span><span class="ident" id="5881507">token</span><span class="op" id="5881512">.</span><span class="ident" id="5881513">TYPE</span><span class="op" id="5881517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5881521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881525">p</span><span class="op" id="5881526">.</span><span class="builtinfunc" id="5881527">print</span><span class="op" id="5881532">(</span><span class="ident" id="5881533">x</span><span class="op" id="5881534">.</span><span class="ident" id="5881535">Rparen</span><span class="op" id="5881541">,</span>&nbsp;<span class="ident" id="5881543">token</span><span class="op" id="5881548">.</span><span class="ident" id="5881549">RPAREN</span><span class="op" id="5881555">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5881559">case</span>&nbsp;<span class="op" id="5881564">*</span><span class="ident" id="5881565">ast</span><span class="op" id="5881568">.</span><span class="ident" id="5881569">IndexExpr</span><span class="op" id="5881578">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5881582">//&nbsp;TODO(gri):&nbsp;should&nbsp;treat[]&nbsp;like&nbsp;parentheses&nbsp;and&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881658">p</span><span class="op" id="5881659">.</span><span class="ident" id="5881660">expr1</span><span class="op" id="5881665">(</span><span class="ident" id="5881666">x</span><span class="op" id="5881667">.</span><span class="ident" id="5881668">X</span><span class="op" id="5881669">,</span>&nbsp;<span class="ident" id="5881671">token</span><span class="op" id="5881676">.</span><span class="ident" id="5881677">HighestPrec</span><span class="op" id="5881688">,</span>&nbsp;<span class="num" id="5881690">1</span><span class="op" id="5881691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881695">p</span><span class="op" id="5881696">.</span><span class="builtinfunc" id="5881697">print</span><span class="op" id="5881702">(</span><span class="ident" id="5881703">x</span><span class="op" id="5881704">.</span><span class="ident" id="5881705">Lbrack</span><span class="op" id="5881711">,</span>&nbsp;<span class="ident" id="5881713">token</span><span class="op" id="5881718">.</span><span class="ident" id="5881719">LBRACK</span><span class="op" id="5881725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881729">p</span><span class="op" id="5881730">.</span><span class="ident" id="5881731">expr0</span><span class="op" id="5881736">(</span><span class="ident" id="5881737">x</span><span class="op" id="5881738">.</span><span class="ident" id="5881739">Index</span><span class="op" id="5881744">,</span>&nbsp;<span class="ident" id="5881746">depth</span><span class="op" id="5881751">+</span><span class="num" id="5881752">1</span><span class="op" id="5881753">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881757">p</span><span class="op" id="5881758">.</span><span class="builtinfunc" id="5881759">print</span><span class="op" id="5881764">(</span><span class="ident" id="5881765">x</span><span class="op" id="5881766">.</span><span class="ident" id="5881767">Rbrack</span><span class="op" id="5881773">,</span>&nbsp;<span class="ident" id="5881775">token</span><span class="op" id="5881780">.</span><span class="ident" id="5881781">RBRACK</span><span class="op" id="5881787">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5881791">case</span>&nbsp;<span class="op" id="5881796">*</span><span class="ident" id="5881797">ast</span><span class="op" id="5881800">.</span><span class="ident" id="5881801">SliceExpr</span><span class="op" id="5881810">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5881814">//&nbsp;TODO(gri):&nbsp;should&nbsp;treat[]&nbsp;like&nbsp;parentheses&nbsp;and&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881890">p</span><span class="op" id="5881891">.</span><span class="ident" id="5881892">expr1</span><span class="op" id="5881897">(</span><span class="ident" id="5881898">x</span><span class="op" id="5881899">.</span><span class="ident" id="5881900">X</span><span class="op" id="5881901">,</span>&nbsp;<span class="ident" id="5881903">token</span><span class="op" id="5881908">.</span><span class="ident" id="5881909">HighestPrec</span><span class="op" id="5881920">,</span>&nbsp;<span class="num" id="5881922">1</span><span class="op" id="5881923">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881927">p</span><span class="op" id="5881928">.</span><span class="builtinfunc" id="5881929">print</span><span class="op" id="5881934">(</span><span class="ident" id="5881935">x</span><span class="op" id="5881936">.</span><span class="ident" id="5881937">Lbrack</span><span class="op" id="5881943">,</span>&nbsp;<span class="ident" id="5881945">token</span><span class="op" id="5881950">.</span><span class="ident" id="5881951">LBRACK</span><span class="op" id="5881957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881961">indices</span>&nbsp;<span class="op" id="5881969">:=</span>&nbsp;<span class="op" id="5881972">[</span><span class="op" id="5881973">]</span><span class="ident" id="5881974">ast</span><span class="op" id="5881977">.</span><span class="ident" id="5881978">Expr</span><span class="op" id="5881982">{</span><span class="ident" id="5881983">x</span><span class="op" id="5881984">.</span><span class="ident" id="5881985">Low</span><span class="op" id="5881988">,</span>&nbsp;<span class="ident" id="5881990">x</span><span class="op" id="5881991">.</span><span class="ident" id="5881992">High</span><span class="op" id="5881996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5882000">if</span>&nbsp;<span class="ident" id="5882003">x</span><span class="op" id="5882004">.</span><span class="ident" id="5882005">Max</span>&nbsp;<span class="op" id="5882009">!=</span>&nbsp;<span class="ident" id="5882012">nil</span>&nbsp;<span class="op" id="5882016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882021">indices</span>&nbsp;<span class="op" id="5882029">=</span>&nbsp;<span class="builtinfunc" id="5882031">append</span><span class="op" id="5882037">(</span><span class="ident" id="5882038">indices</span><span class="op" id="5882045">,</span>&nbsp;<span class="ident" id="5882047">x</span><span class="op" id="5882048">.</span><span class="ident" id="5882049">Max</span><span class="op" id="5882052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5882056">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5882060">for</span>&nbsp;<span class="ident" id="5882064">i</span><span class="op" id="5882065">,</span>&nbsp;<span class="ident" id="5882067">y</span>&nbsp;<span class="op" id="5882069">:=</span>&nbsp;<span class="keyword" id="5882072">range</span>&nbsp;<span class="ident" id="5882078">indices</span>&nbsp;<span class="op" id="5882086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5882091">if</span>&nbsp;<span class="ident" id="5882094">i</span>&nbsp;<span class="op" id="5882096">&gt;</span>&nbsp;<span class="num" id="5882098">0</span>&nbsp;<span class="op" id="5882100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5882106">//&nbsp;blanks&nbsp;around&nbsp;&#34;:&#34;&nbsp;if&nbsp;both&nbsp;sides&nbsp;exist&nbsp;and&nbsp;either&nbsp;side&nbsp;is&nbsp;a&nbsp;binary&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5882190">//&nbsp;TODO(gri)&nbsp;once&nbsp;we&nbsp;have&nbsp;committed&nbsp;a&nbsp;variant&nbsp;of&nbsp;a[i:j:k]&nbsp;we&nbsp;may&nbsp;want&nbsp;to&nbsp;fine-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5882273">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tune&nbsp;the&nbsp;formatting&nbsp;here</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882315">x</span>&nbsp;<span class="op" id="5882317">:=</span>&nbsp;<span class="ident" id="5882320">indices</span><span class="op" id="5882327">[</span><span class="ident" id="5882328">i</span><span class="op" id="5882329">-</span><span class="num" id="5882330">1</span><span class="op" id="5882331">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5882337">if</span>&nbsp;<span class="ident" id="5882340">depth</span>&nbsp;<span class="op" id="5882346">&lt;=</span>&nbsp;<span class="num" id="5882349">1</span>&nbsp;<span class="op" id="5882351">&amp;&amp;</span>&nbsp;<span class="ident" id="5882354">x</span>&nbsp;<span class="op" id="5882356">!=</span>&nbsp;<span class="ident" id="5882359">nil</span>&nbsp;<span class="op" id="5882363">&amp;&amp;</span>&nbsp;<span class="ident" id="5882366">y</span>&nbsp;<span class="op" id="5882368">!=</span>&nbsp;<span class="ident" id="5882371">nil</span>&nbsp;<span class="op" id="5882375">&amp;&amp;</span>&nbsp;<span class="op" id="5882378">(</span><span class="ident" id="5882379">isBinary</span><span class="op" id="5882387">(</span><span class="ident" id="5882388">x</span><span class="op" id="5882389">)</span>&nbsp;<span class="op" id="5882391">||</span>&nbsp;<span class="ident" id="5882394">isBinary</span><span class="op" id="5882402">(</span><span class="ident" id="5882403">y</span><span class="op" id="5882404">)</span><span class="op" id="5882405">)</span>&nbsp;<span class="op" id="5882407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882414">p</span><span class="op" id="5882415">.</span><span class="builtinfunc" id="5882416">print</span><span class="op" id="5882421">(</span><span class="ident" id="5882422">blank</span><span class="op" id="5882427">,</span>&nbsp;<span class="ident" id="5882429">token</span><span class="op" id="5882434">.</span><span class="ident" id="5882435">COLON</span><span class="op" id="5882440">,</span>&nbsp;<span class="ident" id="5882442">blank</span><span class="op" id="5882447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5882453">}</span>&nbsp;<span class="keyword" id="5882455">else</span>&nbsp;<span class="op" id="5882460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882467">p</span><span class="op" id="5882468">.</span><span class="builtinfunc" id="5882469">print</span><span class="op" id="5882474">(</span><span class="ident" id="5882475">token</span><span class="op" id="5882480">.</span><span class="ident" id="5882481">COLON</span><span class="op" id="5882486">)</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5882492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5882497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5882502">if</span>&nbsp;<span class="ident" id="5882505">y</span>&nbsp;<span class="op" id="5882507">!=</span>&nbsp;<span class="ident" id="5882510">nil</span>&nbsp;<span class="op" id="5882514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882520">p</span><span class="op" id="5882521">.</span><span class="ident" id="5882522">expr0</span><span class="op" id="5882527">(</span><span class="ident" id="5882528">y</span><span class="op" id="5882529">,</span>&nbsp;<span class="ident" id="5882531">depth</span><span class="op" id="5882536">+</span><span class="num" id="5882537">1</span><span class="op" id="5882538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5882543">}</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5882547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882551">p</span><span class="op" id="5882552">.</span><span class="builtinfunc" id="5882553">print</span><span class="op" id="5882558">(</span><span class="ident" id="5882559">x</span><span class="op" id="5882560">.</span><span class="ident" id="5882561">Rbrack</span><span class="op" id="5882567">,</span>&nbsp;<span class="ident" id="5882569">token</span><span class="op" id="5882574">.</span><span class="ident" id="5882575">RBRACK</span><span class="op" id="5882581">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5882585">case</span>&nbsp;<span class="op" id="5882590">*</span><span class="ident" id="5882591">ast</span><span class="op" id="5882594">.</span><span class="ident" id="5882595">CallExpr</span><span class="op" id="5882603">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5882607">if</span>&nbsp;<span class="builtinfunc" id="5882610">len</span><span class="op" id="5882613">(</span><span class="ident" id="5882614">x</span><span class="op" id="5882615">.</span><span class="ident" id="5882616">Args</span><span class="op" id="5882620">)</span>&nbsp;<span class="op" id="5882622">&gt;</span>&nbsp;<span class="num" id="5882624">1</span>&nbsp;<span class="op" id="5882626">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882631">depth</span><span class="op" id="5882636">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5882641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5882645">if</span>&nbsp;<span class="ident" id="5882648">_</span><span class="op" id="5882649">,</span>&nbsp;<span class="ident" id="5882651">ok</span>&nbsp;<span class="op" id="5882654">:=</span>&nbsp;<span class="ident" id="5882657">x</span><span class="op" id="5882658">.</span><span class="ident" id="5882659">Fun</span><span class="op" id="5882662">.</span><span class="op" id="5882663">(</span><span class="op" id="5882664">*</span><span class="ident" id="5882665">ast</span><span class="op" id="5882668">.</span><span class="ident" id="5882669">FuncType</span><span class="op" id="5882677">)</span><span class="op" id="5882678">;</span>&nbsp;<span class="ident" id="5882680">ok</span>&nbsp;<span class="op" id="5882683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5882688">//&nbsp;conversions&nbsp;to&nbsp;literal&nbsp;function&nbsp;types&nbsp;require&nbsp;parentheses&nbsp;around&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882768">p</span><span class="op" id="5882769">.</span><span class="builtinfunc" id="5882770">print</span><span class="op" id="5882775">(</span><span class="ident" id="5882776">token</span><span class="op" id="5882781">.</span><span class="ident" id="5882782">LPAREN</span><span class="op" id="5882788">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882793">p</span><span class="op" id="5882794">.</span><span class="ident" id="5882795">expr1</span><span class="op" id="5882800">(</span><span class="ident" id="5882801">x</span><span class="op" id="5882802">.</span><span class="ident" id="5882803">Fun</span><span class="op" id="5882806">,</span>&nbsp;<span class="ident" id="5882808">token</span><span class="op" id="5882813">.</span><span class="ident" id="5882814">HighestPrec</span><span class="op" id="5882825">,</span>&nbsp;<span class="ident" id="5882827">depth</span><span class="op" id="5882832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882837">p</span><span class="op" id="5882838">.</span><span class="builtinfunc" id="5882839">print</span><span class="op" id="5882844">(</span><span class="ident" id="5882845">token</span><span class="op" id="5882850">.</span><span class="ident" id="5882851">RPAREN</span><span class="op" id="5882857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5882861">}</span>&nbsp;<span class="keyword" id="5882863">else</span>&nbsp;<span class="op" id="5882868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882873">p</span><span class="op" id="5882874">.</span><span class="ident" id="5882875">expr1</span><span class="op" id="5882880">(</span><span class="ident" id="5882881">x</span><span class="op" id="5882882">.</span><span class="ident" id="5882883">Fun</span><span class="op" id="5882886">,</span>&nbsp;<span class="ident" id="5882888">token</span><span class="op" id="5882893">.</span><span class="ident" id="5882894">HighestPrec</span><span class="op" id="5882905">,</span>&nbsp;<span class="ident" id="5882907">depth</span><span class="op" id="5882912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5882916">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882920">p</span><span class="op" id="5882921">.</span><span class="builtinfunc" id="5882922">print</span><span class="op" id="5882927">(</span><span class="ident" id="5882928">x</span><span class="op" id="5882929">.</span><span class="ident" id="5882930">Lparen</span><span class="op" id="5882936">,</span>&nbsp;<span class="ident" id="5882938">token</span><span class="op" id="5882943">.</span><span class="ident" id="5882944">LPAREN</span><span class="op" id="5882950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5882954">if</span>&nbsp;<span class="ident" id="5882957">x</span><span class="op" id="5882958">.</span><span class="ident" id="5882959">Ellipsis</span><span class="op" id="5882967">.</span><span class="ident" id="5882968">IsValid</span><span class="op" id="5882975">(</span><span class="op" id="5882976">)</span>&nbsp;<span class="op" id="5882978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882983">p</span><span class="op" id="5882984">.</span><span class="ident" id="5882985">exprList</span><span class="op" id="5882993">(</span><span class="ident" id="5882994">x</span><span class="op" id="5882995">.</span><span class="ident" id="5882996">Lparen</span><span class="op" id="5883002">,</span>&nbsp;<span class="ident" id="5883004">x</span><span class="op" id="5883005">.</span><span class="ident" id="5883006">Args</span><span class="op" id="5883010">,</span>&nbsp;<span class="ident" id="5883012">depth</span><span class="op" id="5883017">,</span>&nbsp;<span class="num" id="5883019">0</span><span class="op" id="5883020">,</span>&nbsp;<span class="ident" id="5883022">x</span><span class="op" id="5883023">.</span><span class="ident" id="5883024">Ellipsis</span><span class="op" id="5883032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883037">p</span><span class="op" id="5883038">.</span><span class="builtinfunc" id="5883039">print</span><span class="op" id="5883044">(</span><span class="ident" id="5883045">x</span><span class="op" id="5883046">.</span><span class="ident" id="5883047">Ellipsis</span><span class="op" id="5883055">,</span>&nbsp;<span class="ident" id="5883057">token</span><span class="op" id="5883062">.</span><span class="ident" id="5883063">ELLIPSIS</span><span class="op" id="5883071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5883076">if</span>&nbsp;<span class="ident" id="5883079">x</span><span class="op" id="5883080">.</span><span class="ident" id="5883081">Rparen</span><span class="op" id="5883087">.</span><span class="ident" id="5883088">IsValid</span><span class="op" id="5883095">(</span><span class="op" id="5883096">)</span>&nbsp;<span class="op" id="5883098">&amp;&amp;</span>&nbsp;<span class="ident" id="5883101">p</span><span class="op" id="5883102">.</span><span class="ident" id="5883103">lineFor</span><span class="op" id="5883110">(</span><span class="ident" id="5883111">x</span><span class="op" id="5883112">.</span><span class="ident" id="5883113">Ellipsis</span><span class="op" id="5883121">)</span>&nbsp;<span class="op" id="5883123">&lt;</span>&nbsp;<span class="ident" id="5883125">p</span><span class="op" id="5883126">.</span><span class="ident" id="5883127">lineFor</span><span class="op" id="5883134">(</span><span class="ident" id="5883135">x</span><span class="op" id="5883136">.</span><span class="ident" id="5883137">Rparen</span><span class="op" id="5883143">)</span>&nbsp;<span class="op" id="5883145">{</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883151">p</span><span class="op" id="5883152">.</span><span class="builtinfunc" id="5883153">print</span><span class="op" id="5883158">(</span><span class="ident" id="5883159">token</span><span class="op" id="5883164">.</span><span class="ident" id="5883165">COMMA</span><span class="op" id="5883170">,</span>&nbsp;<span class="ident" id="5883172">formfeed</span><span class="op" id="5883180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5883185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5883189">}</span>&nbsp;<span class="keyword" id="5883191">else</span>&nbsp;<span class="op" id="5883196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883201">p</span><span class="op" id="5883202">.</span><span class="ident" id="5883203">exprList</span><span class="op" id="5883211">(</span><span class="ident" id="5883212">x</span><span class="op" id="5883213">.</span><span class="ident" id="5883214">Lparen</span><span class="op" id="5883220">,</span>&nbsp;<span class="ident" id="5883222">x</span><span class="op" id="5883223">.</span><span class="ident" id="5883224">Args</span><span class="op" id="5883228">,</span>&nbsp;<span class="ident" id="5883230">depth</span><span class="op" id="5883235">,</span>&nbsp;<span class="ident" id="5883237">commaTerm</span><span class="op" id="5883246">,</span>&nbsp;<span class="ident" id="5883248">x</span><span class="op" id="5883249">.</span><span class="ident" id="5883250">Rparen</span><span class="op" id="5883256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5883260">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883264">p</span><span class="op" id="5883265">.</span><span class="builtinfunc" id="5883266">print</span><span class="op" id="5883271">(</span><span class="ident" id="5883272">x</span><span class="op" id="5883273">.</span><span class="ident" id="5883274">Rparen</span><span class="op" id="5883280">,</span>&nbsp;<span class="ident" id="5883282">token</span><span class="op" id="5883287">.</span><span class="ident" id="5883288">RPAREN</span><span class="op" id="5883294">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5883298">case</span>&nbsp;<span class="op" id="5883303">*</span><span class="ident" id="5883304">ast</span><span class="op" id="5883307">.</span><span class="ident" id="5883308">CompositeLit</span><span class="op" id="5883320">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5883324">//&nbsp;composite&nbsp;literal&nbsp;elements&nbsp;that&nbsp;are&nbsp;composite&nbsp;literals&nbsp;themselves&nbsp;may&nbsp;have&nbsp;the&nbsp;type&nbsp;omitted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5883421">if</span>&nbsp;<span class="ident" id="5883424">x</span><span class="op" id="5883425">.</span><span class="ident" id="5883426">Type</span>&nbsp;<span class="op" id="5883431">!=</span>&nbsp;<span class="ident" id="5883434">nil</span>&nbsp;<span class="op" id="5883438">{</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883443">p</span><span class="op" id="5883444">.</span><span class="ident" id="5883445">expr1</span><span class="op" id="5883450">(</span><span class="ident" id="5883451">x</span><span class="op" id="5883452">.</span><span class="ident" id="5883453">Type</span><span class="op" id="5883457">,</span>&nbsp;<span class="ident" id="5883459">token</span><span class="op" id="5883464">.</span><span class="ident" id="5883465">HighestPrec</span><span class="op" id="5883476">,</span>&nbsp;<span class="ident" id="5883478">depth</span><span class="op" id="5883483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5883487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883491">p</span><span class="op" id="5883492">.</span><span class="builtinfunc" id="5883493">print</span><span class="op" id="5883498">(</span><span class="ident" id="5883499">x</span><span class="op" id="5883500">.</span><span class="ident" id="5883501">Lbrace</span><span class="op" id="5883507">,</span>&nbsp;<span class="ident" id="5883509">token</span><span class="op" id="5883514">.</span><span class="ident" id="5883515">LBRACE</span><span class="op" id="5883521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883525">p</span><span class="op" id="5883526">.</span><span class="ident" id="5883527">exprList</span><span class="op" id="5883535">(</span><span class="ident" id="5883536">x</span><span class="op" id="5883537">.</span><span class="ident" id="5883538">Lbrace</span><span class="op" id="5883544">,</span>&nbsp;<span class="ident" id="5883546">x</span><span class="op" id="5883547">.</span><span class="ident" id="5883548">Elts</span><span class="op" id="5883552">,</span>&nbsp;<span class="num" id="5883554">1</span><span class="op" id="5883555">,</span>&nbsp;<span class="ident" id="5883557">commaTerm</span><span class="op" id="5883566">,</span>&nbsp;<span class="ident" id="5883568">x</span><span class="op" id="5883569">.</span><span class="ident" id="5883570">Rbrace</span><span class="op" id="5883576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5883580">//&nbsp;do&nbsp;not&nbsp;insert&nbsp;extra&nbsp;line&nbsp;break&nbsp;following&nbsp;a&nbsp;/*-style&nbsp;comment</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5883645">//&nbsp;before&nbsp;the&nbsp;closing&nbsp;&#39;}&#39;&nbsp;as&nbsp;it&nbsp;might&nbsp;break&nbsp;the&nbsp;code&nbsp;if&nbsp;there</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5883709">//&nbsp;is&nbsp;no&nbsp;trailing&nbsp;&#39;,&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883733">mode</span>&nbsp;<span class="op" id="5883738">:=</span>&nbsp;<span class="ident" id="5883741">noExtraLinebreak</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5883760">//&nbsp;do&nbsp;not&nbsp;insert&nbsp;extra&nbsp;blank&nbsp;following&nbsp;a&nbsp;/*-style&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5883820">//&nbsp;before&nbsp;the&nbsp;closing&nbsp;&#39;}&#39;&nbsp;unless&nbsp;the&nbsp;literal&nbsp;is&nbsp;empty</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5883876">if</span>&nbsp;<span class="builtinfunc" id="5883879">len</span><span class="op" id="5883882">(</span><span class="ident" id="5883883">x</span><span class="op" id="5883884">.</span><span class="ident" id="5883885">Elts</span><span class="op" id="5883889">)</span>&nbsp;<span class="op" id="5883891">&gt;</span>&nbsp;<span class="num" id="5883893">0</span>&nbsp;<span class="op" id="5883895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883900">mode</span>&nbsp;<span class="op" id="5883905">|=</span>&nbsp;<span class="ident" id="5883908">noExtraBlank</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5883923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883927">p</span><span class="op" id="5883928">.</span><span class="builtinfunc" id="5883929">print</span><span class="op" id="5883934">(</span><span class="ident" id="5883935">mode</span><span class="op" id="5883939">,</span>&nbsp;<span class="ident" id="5883941">x</span><span class="op" id="5883942">.</span><span class="ident" id="5883943">Rbrace</span><span class="op" id="5883949">,</span>&nbsp;<span class="ident" id="5883951">token</span><span class="op" id="5883956">.</span><span class="ident" id="5883957">RBRACE</span><span class="op" id="5883963">,</span>&nbsp;<span class="ident" id="5883965">mode</span><span class="op" id="5883969">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5883973">case</span>&nbsp;<span class="op" id="5883978">*</span><span class="ident" id="5883979">ast</span><span class="op" id="5883982">.</span><span class="ident" id="5883983">Ellipsis</span><span class="op" id="5883991">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883995">p</span><span class="op" id="5883996">.</span><span class="builtinfunc" id="5883997">print</span><span class="op" id="5884002">(</span><span class="ident" id="5884003">token</span><span class="op" id="5884008">.</span><span class="ident" id="5884009">ELLIPSIS</span><span class="op" id="5884017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884021">if</span>&nbsp;<span class="ident" id="5884024">x</span><span class="op" id="5884025">.</span><span class="ident" id="5884026">Elt</span>&nbsp;<span class="op" id="5884030">!=</span>&nbsp;<span class="ident" id="5884033">nil</span>&nbsp;<span class="op" id="5884037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884042">p</span><span class="op" id="5884043">.</span><span class="ident" id="5884044">expr</span><span class="op" id="5884048">(</span><span class="ident" id="5884049">x</span><span class="op" id="5884050">.</span><span class="ident" id="5884051">Elt</span><span class="op" id="5884054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5884058">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884062">case</span>&nbsp;<span class="op" id="5884067">*</span><span class="ident" id="5884068">ast</span><span class="op" id="5884071">.</span><span class="ident" id="5884072">ArrayType</span><span class="op" id="5884081">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884085">p</span><span class="op" id="5884086">.</span><span class="builtinfunc" id="5884087">print</span><span class="op" id="5884092">(</span><span class="ident" id="5884093">token</span><span class="op" id="5884098">.</span><span class="ident" id="5884099">LBRACK</span><span class="op" id="5884105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884109">if</span>&nbsp;<span class="ident" id="5884112">x</span><span class="op" id="5884113">.</span><span class="ident" id="5884114">Len</span>&nbsp;<span class="op" id="5884118">!=</span>&nbsp;<span class="ident" id="5884121">nil</span>&nbsp;<span class="op" id="5884125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884130">p</span><span class="op" id="5884131">.</span><span class="ident" id="5884132">expr</span><span class="op" id="5884136">(</span><span class="ident" id="5884137">x</span><span class="op" id="5884138">.</span><span class="ident" id="5884139">Len</span><span class="op" id="5884142">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5884146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884150">p</span><span class="op" id="5884151">.</span><span class="builtinfunc" id="5884152">print</span><span class="op" id="5884157">(</span><span class="ident" id="5884158">token</span><span class="op" id="5884163">.</span><span class="ident" id="5884164">RBRACK</span><span class="op" id="5884170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884174">p</span><span class="op" id="5884175">.</span><span class="ident" id="5884176">expr</span><span class="op" id="5884180">(</span><span class="ident" id="5884181">x</span><span class="op" id="5884182">.</span><span class="ident" id="5884183">Elt</span><span class="op" id="5884186">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884190">case</span>&nbsp;<span class="op" id="5884195">*</span><span class="ident" id="5884196">ast</span><span class="op" id="5884199">.</span><span class="ident" id="5884200">StructType</span><span class="op" id="5884210">:</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884214">p</span><span class="op" id="5884215">.</span><span class="builtinfunc" id="5884216">print</span><span class="op" id="5884221">(</span><span class="ident" id="5884222">token</span><span class="op" id="5884227">.</span><span class="ident" id="5884228">STRUCT</span><span class="op" id="5884234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884238">p</span><span class="op" id="5884239">.</span><span class="ident" id="5884240">fieldList</span><span class="op" id="5884249">(</span><span class="ident" id="5884250">x</span><span class="op" id="5884251">.</span><span class="ident" id="5884252">Fields</span><span class="op" id="5884258">,</span>&nbsp;<span class="builtintype" id="5884260">true</span><span class="op" id="5884264">,</span>&nbsp;<span class="ident" id="5884266">x</span><span class="op" id="5884267">.</span><span class="ident" id="5884268">Incomplete</span><span class="op" id="5884278">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884282">case</span>&nbsp;<span class="op" id="5884287">*</span><span class="ident" id="5884288">ast</span><span class="op" id="5884291">.</span><span class="ident" id="5884292">FuncType</span><span class="op" id="5884300">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884304">p</span><span class="op" id="5884305">.</span><span class="builtinfunc" id="5884306">print</span><span class="op" id="5884311">(</span><span class="ident" id="5884312">token</span><span class="op" id="5884317">.</span><span class="ident" id="5884318">FUNC</span><span class="op" id="5884322">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884326">p</span><span class="op" id="5884327">.</span><span class="ident" id="5884328">signature</span><span class="op" id="5884337">(</span><span class="ident" id="5884338">x</span><span class="op" id="5884339">.</span><span class="ident" id="5884340">Params</span><span class="op" id="5884346">,</span>&nbsp;<span class="ident" id="5884348">x</span><span class="op" id="5884349">.</span><span class="ident" id="5884350">Results</span><span class="op" id="5884357">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884361">case</span>&nbsp;<span class="op" id="5884366">*</span><span class="ident" id="5884367">ast</span><span class="op" id="5884370">.</span><span class="ident" id="5884371">InterfaceType</span><span class="op" id="5884384">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884388">p</span><span class="op" id="5884389">.</span><span class="builtinfunc" id="5884390">print</span><span class="op" id="5884395">(</span><span class="ident" id="5884396">token</span><span class="op" id="5884401">.</span><span class="ident" id="5884402">INTERFACE</span><span class="op" id="5884411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884415">p</span><span class="op" id="5884416">.</span><span class="ident" id="5884417">fieldList</span><span class="op" id="5884426">(</span><span class="ident" id="5884427">x</span><span class="op" id="5884428">.</span><span class="ident" id="5884429">Methods</span><span class="op" id="5884436">,</span>&nbsp;<span class="builtintype" id="5884438">false</span><span class="op" id="5884443">,</span>&nbsp;<span class="ident" id="5884445">x</span><span class="op" id="5884446">.</span><span class="ident" id="5884447">Incomplete</span><span class="op" id="5884457">)</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884461">case</span>&nbsp;<span class="op" id="5884466">*</span><span class="ident" id="5884467">ast</span><span class="op" id="5884470">.</span><span class="ident" id="5884471">MapType</span><span class="op" id="5884478">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884482">p</span><span class="op" id="5884483">.</span><span class="builtinfunc" id="5884484">print</span><span class="op" id="5884489">(</span><span class="ident" id="5884490">token</span><span class="op" id="5884495">.</span><span class="ident" id="5884496">MAP</span><span class="op" id="5884499">,</span>&nbsp;<span class="ident" id="5884501">token</span><span class="op" id="5884506">.</span><span class="ident" id="5884507">LBRACK</span><span class="op" id="5884513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884517">p</span><span class="op" id="5884518">.</span><span class="ident" id="5884519">expr</span><span class="op" id="5884523">(</span><span class="ident" id="5884524">x</span><span class="op" id="5884525">.</span><span class="ident" id="5884526">Key</span><span class="op" id="5884529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884533">p</span><span class="op" id="5884534">.</span><span class="builtinfunc" id="5884535">print</span><span class="op" id="5884540">(</span><span class="ident" id="5884541">token</span><span class="op" id="5884546">.</span><span class="ident" id="5884547">RBRACK</span><span class="op" id="5884553">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884557">p</span><span class="op" id="5884558">.</span><span class="ident" id="5884559">expr</span><span class="op" id="5884563">(</span><span class="ident" id="5884564">x</span><span class="op" id="5884565">.</span><span class="ident" id="5884566">Value</span><span class="op" id="5884571">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884575">case</span>&nbsp;<span class="op" id="5884580">*</span><span class="ident" id="5884581">ast</span><span class="op" id="5884584">.</span><span class="ident" id="5884585">ChanType</span><span class="op" id="5884593">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884597">switch</span>&nbsp;<span class="ident" id="5884604">x</span><span class="op" id="5884605">.</span><span class="ident" id="5884606">Dir</span>&nbsp;<span class="op" id="5884610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884614">case</span>&nbsp;<span class="ident" id="5884619">ast</span><span class="op" id="5884622">.</span><span class="ident" id="5884623">SEND</span>&nbsp;<span class="op" id="5884628">|</span>&nbsp;<span class="ident" id="5884630">ast</span><span class="op" id="5884633">.</span><span class="ident" id="5884634">RECV</span><span class="op" id="5884638">:</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884643">p</span><span class="op" id="5884644">.</span><span class="builtinfunc" id="5884645">print</span><span class="op" id="5884650">(</span><span class="ident" id="5884651">token</span><span class="op" id="5884656">.</span><span class="ident" id="5884657">CHAN</span><span class="op" id="5884661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884665">case</span>&nbsp;<span class="ident" id="5884670">ast</span><span class="op" id="5884673">.</span><span class="ident" id="5884674">RECV</span><span class="op" id="5884678">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884683">p</span><span class="op" id="5884684">.</span><span class="builtinfunc" id="5884685">print</span><span class="op" id="5884690">(</span><span class="ident" id="5884691">token</span><span class="op" id="5884696">.</span><span class="ident" id="5884697">ARROW</span><span class="op" id="5884702">,</span>&nbsp;<span class="ident" id="5884704">token</span><span class="op" id="5884709">.</span><span class="ident" id="5884710">CHAN</span><span class="op" id="5884714">)</span>&nbsp;<span class="comment" id="5884716">//&nbsp;x.Arrow&nbsp;and&nbsp;x.Pos()&nbsp;are&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884754">case</span>&nbsp;<span class="ident" id="5884759">ast</span><span class="op" id="5884762">.</span><span class="ident" id="5884763">SEND</span><span class="op" id="5884767">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884772">p</span><span class="op" id="5884773">.</span><span class="builtinfunc" id="5884774">print</span><span class="op" id="5884779">(</span><span class="ident" id="5884780">token</span><span class="op" id="5884785">.</span><span class="ident" id="5884786">CHAN</span><span class="op" id="5884790">,</span>&nbsp;<span class="ident" id="5884792">x</span><span class="op" id="5884793">.</span><span class="ident" id="5884794">Arrow</span><span class="op" id="5884799">,</span>&nbsp;<span class="ident" id="5884801">token</span><span class="op" id="5884806">.</span><span class="ident" id="5884807">ARROW</span><span class="op" id="5884812">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5884816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884820">p</span><span class="op" id="5884821">.</span><span class="builtinfunc" id="5884822">print</span><span class="op" id="5884827">(</span><span class="ident" id="5884828">blank</span><span class="op" id="5884833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884837">p</span><span class="op" id="5884838">.</span><span class="ident" id="5884839">expr</span><span class="op" id="5884843">(</span><span class="ident" id="5884844">x</span><span class="op" id="5884845">.</span><span class="ident" id="5884846">Value</span><span class="op" id="5884851">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884855">default</span><span class="op" id="5884862">:</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5884866">panic</span><span class="op" id="5884871">(</span><span class="string" id="5884872">&#34;unreachable&#34;</span><span class="op" id="5884885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5884888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884892">return</span><br>
<span class="lineno"></span><span class="op" id="5884899">}</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span><span class="keyword" id="5884902">func</span>&nbsp;<span class="op" id="5884907">(</span><span class="ident" id="5884908">p</span>&nbsp;<span class="op" id="5884910">*</span><span class="ident" id="5884911">printer</span><span class="op" id="5884918">)</span>&nbsp;<span class="ident" id="5884920">expr0</span><span class="op" id="5884925">(</span><span class="ident" id="5884926">x</span>&nbsp;<span class="ident" id="5884928">ast</span><span class="op" id="5884931">.</span><span class="ident" id="5884932">Expr</span><span class="op" id="5884936">,</span>&nbsp;<span class="ident" id="5884938">depth</span>&nbsp;<span class="builtintype" id="5884944">int</span><span class="op" id="5884947">)</span>&nbsp;<span class="op" id="5884949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884952">p</span><span class="op" id="5884953">.</span><span class="ident" id="5884954">expr1</span><span class="op" id="5884959">(</span><span class="ident" id="5884960">x</span><span class="op" id="5884961">,</span>&nbsp;<span class="ident" id="5884963">token</span><span class="op" id="5884968">.</span><span class="ident" id="5884969">LowestPrec</span><span class="op" id="5884979">,</span>&nbsp;<span class="ident" id="5884981">depth</span><span class="op" id="5884986">)</span><br>
<span class="lineno"></span><span class="op" id="5884988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span><span class="keyword" id="5884991">func</span>&nbsp;<span class="op" id="5884996">(</span><span class="ident" id="5884997">p</span>&nbsp;<span class="op" id="5884999">*</span><span class="ident" id="5885000">printer</span><span class="op" id="5885007">)</span>&nbsp;<span class="ident" id="5885009">expr</span><span class="op" id="5885013">(</span><span class="ident" id="5885014">x</span>&nbsp;<span class="ident" id="5885016">ast</span><span class="op" id="5885019">.</span><span class="ident" id="5885020">Expr</span><span class="op" id="5885024">)</span>&nbsp;<span class="op" id="5885026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5885029">const</span>&nbsp;<span class="ident" id="5885035">depth</span>&nbsp;<span class="op" id="5885041">=</span>&nbsp;<span class="num" id="5885043">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5885046">p</span><span class="op" id="5885047">.</span><span class="ident" id="5885048">expr1</span><span class="op" id="5885053">(</span><span class="ident" id="5885054">x</span><span class="op" id="5885055">,</span>&nbsp;<span class="ident" id="5885057">token</span><span class="op" id="5885062">.</span><span class="ident" id="5885063">LowestPrec</span><span class="op" id="5885073">,</span>&nbsp;<span class="ident" id="5885075">depth</span><span class="op" id="5885080">)</span><br>
<span class="lineno"></span><span class="op" id="5885082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="5885085">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5885165">//&nbsp;Statements</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5885180">//&nbsp;Print&nbsp;the&nbsp;statement&nbsp;list&nbsp;indented,&nbsp;but&nbsp;without&nbsp;a&nbsp;newline&nbsp;after&nbsp;the&nbsp;last&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="5885266">//&nbsp;Extra&nbsp;line&nbsp;breaks&nbsp;between&nbsp;statements&nbsp;in&nbsp;the&nbsp;source&nbsp;are&nbsp;respected&nbsp;but&nbsp;at&nbsp;most&nbsp;one</span><br>
<span class="lineno">905</span><span class="comment" id="5885350">//&nbsp;empty&nbsp;line&nbsp;is&nbsp;printed&nbsp;between&nbsp;statements.</span><br>
<span class="lineno"></span><span class="keyword" id="5885395">func</span>&nbsp;<span class="op" id="5885400">(</span><span class="ident" id="5885401">p</span>&nbsp;<span class="op" id="5885403">*</span><span class="ident" id="5885404">printer</span><span class="op" id="5885411">)</span>&nbsp;<span class="ident" id="5885413">stmtList</span><span class="op" id="5885421">(</span><span class="ident" id="5885422">list</span>&nbsp;<span class="op" id="5885427">[</span><span class="op" id="5885428">]</span><span class="ident" id="5885429">ast</span><span class="op" id="5885432">.</span><span class="ident" id="5885433">Stmt</span><span class="op" id="5885437">,</span>&nbsp;<span class="ident" id="5885439">nindent</span>&nbsp;<span class="builtintype" id="5885447">int</span><span class="op" id="5885450">,</span>&nbsp;<span class="ident" id="5885452">nextIsRBrace</span>&nbsp;<span class="builtintype" id="5885465">bool</span><span class="op" id="5885469">)</span>&nbsp;<span class="op" id="5885471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5885474">if</span>&nbsp;<span class="ident" id="5885477">nindent</span>&nbsp;<span class="op" id="5885485">&gt;</span>&nbsp;<span class="num" id="5885487">0</span>&nbsp;<span class="op" id="5885489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5885493">p</span><span class="op" id="5885494">.</span><span class="builtinfunc" id="5885495">print</span><span class="op" id="5885500">(</span><span class="ident" id="5885501">indent</span><span class="op" id="5885507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5885510">}</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5885513">var</span>&nbsp;<span class="ident" id="5885517">line</span>&nbsp;<span class="builtintype" id="5885522">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5885527">i</span>&nbsp;<span class="op" id="5885529">:=</span>&nbsp;<span class="num" id="5885532">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5885535">for</span>&nbsp;<span class="ident" id="5885539">_</span><span class="op" id="5885540">,</span>&nbsp;<span class="ident" id="5885542">s</span>&nbsp;<span class="op" id="5885544">:=</span>&nbsp;<span class="keyword" id="5885547">range</span>&nbsp;<span class="ident" id="5885553">list</span>&nbsp;<span class="op" id="5885558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5885562">//&nbsp;ignore&nbsp;empty&nbsp;statements&nbsp;(was&nbsp;issue&nbsp;3466)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5885608">if</span>&nbsp;<span class="ident" id="5885611">_</span><span class="op" id="5885612">,</span>&nbsp;<span class="ident" id="5885614">isEmpty</span>&nbsp;<span class="op" id="5885622">:=</span>&nbsp;<span class="ident" id="5885625">s</span><span class="op" id="5885626">.</span><span class="op" id="5885627">(</span><span class="op" id="5885628">*</span><span class="ident" id="5885629">ast</span><span class="op" id="5885632">.</span><span class="ident" id="5885633">EmptyStmt</span><span class="op" id="5885642">)</span><span class="op" id="5885643">;</span>&nbsp;<span class="op" id="5885645">!</span><span class="ident" id="5885646">isEmpty</span>&nbsp;<span class="op" id="5885654">{</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5885659">//&nbsp;nindent&nbsp;==&nbsp;0&nbsp;only&nbsp;for&nbsp;lists&nbsp;of&nbsp;switch/select&nbsp;case&nbsp;clauses;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5885724">//&nbsp;in&nbsp;those&nbsp;cases&nbsp;each&nbsp;clause&nbsp;is&nbsp;a&nbsp;new&nbsp;section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5885774">if</span>&nbsp;<span class="builtinfunc" id="5885777">len</span><span class="op" id="5885780">(</span><span class="ident" id="5885781">p</span><span class="op" id="5885782">.</span><span class="ident" id="5885783">output</span><span class="op" id="5885789">)</span>&nbsp;<span class="op" id="5885791">&gt;</span>&nbsp;<span class="num" id="5885793">0</span>&nbsp;<span class="op" id="5885795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5885801">//&nbsp;only&nbsp;print&nbsp;line&nbsp;break&nbsp;if&nbsp;we&nbsp;are&nbsp;not&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5885875">//&nbsp;(i.e.,&nbsp;we&nbsp;are&nbsp;not&nbsp;printing&nbsp;only&nbsp;a&nbsp;partial&nbsp;program)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5885933">p</span><span class="op" id="5885934">.</span><span class="ident" id="5885935">linebreak</span><span class="op" id="5885944">(</span><span class="ident" id="5885945">p</span><span class="op" id="5885946">.</span><span class="ident" id="5885947">lineFor</span><span class="op" id="5885954">(</span><span class="ident" id="5885955">s</span><span class="op" id="5885956">.</span><span class="ident" id="5885957">Pos</span><span class="op" id="5885960">(</span><span class="op" id="5885961">)</span><span class="op" id="5885962">)</span><span class="op" id="5885963">,</span>&nbsp;<span class="num" id="5885965">1</span><span class="op" id="5885966">,</span>&nbsp;<span class="ident" id="5885968">ignore</span><span class="op" id="5885974">,</span>&nbsp;<span class="ident" id="5885976">i</span>&nbsp;<span class="op" id="5885978">==</span>&nbsp;<span class="num" id="5885981">0</span>&nbsp;<span class="op" id="5885983">||</span>&nbsp;<span class="ident" id="5885986">nindent</span>&nbsp;<span class="op" id="5885994">==</span>&nbsp;<span class="num" id="5885997">0</span>&nbsp;<span class="op" id="5885999">||</span>&nbsp;<span class="ident" id="5886002">p</span><span class="op" id="5886003">.</span><span class="ident" id="5886004">linesFrom</span><span class="op" id="5886013">(</span><span class="ident" id="5886014">line</span><span class="op" id="5886018">)</span>&nbsp;<span class="op" id="5886020">&gt;</span>&nbsp;<span class="num" id="5886022">0</span><span class="op" id="5886023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5886028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5886033">p</span><span class="op" id="5886034">.</span><span class="ident" id="5886035">recordLine</span><span class="op" id="5886045">(</span><span class="op" id="5886046">&amp;</span><span class="ident" id="5886047">line</span><span class="op" id="5886051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5886056">p</span><span class="op" id="5886057">.</span><span class="ident" id="5886058">stmt</span><span class="op" id="5886062">(</span><span class="ident" id="5886063">s</span><span class="op" id="5886064">,</span>&nbsp;<span class="ident" id="5886066">nextIsRBrace</span>&nbsp;<span class="op" id="5886079">&amp;&amp;</span>&nbsp;<span class="ident" id="5886082">i</span>&nbsp;<span class="op" id="5886084">==</span>&nbsp;<span class="builtinfunc" id="5886087">len</span><span class="op" id="5886090">(</span><span class="ident" id="5886091">list</span><span class="op" id="5886095">)</span><span class="op" id="5886096">-</span><span class="num" id="5886097">1</span><span class="op" id="5886098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5886103">//&nbsp;labeled&nbsp;statements&nbsp;put&nbsp;labels&nbsp;on&nbsp;a&nbsp;separate&nbsp;line,&nbsp;but&nbsp;here</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5886168">//&nbsp;we&nbsp;only&nbsp;care&nbsp;about&nbsp;the&nbsp;start&nbsp;line&nbsp;of&nbsp;the&nbsp;actual&nbsp;statement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5886232">//&nbsp;without&nbsp;label&nbsp;-&nbsp;correct&nbsp;line&nbsp;for&nbsp;each&nbsp;label</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5886282">for</span>&nbsp;<span class="ident" id="5886286">t</span>&nbsp;<span class="op" id="5886288">:=</span>&nbsp;<span class="ident" id="5886291">s</span><span class="op" id="5886292">;</span>&nbsp;<span class="op" id="5886294">;</span>&nbsp;<span class="op" id="5886296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5886302">lt</span><span class="op" id="5886304">,</span>&nbsp;<span class="ident" id="5886306">_</span>&nbsp;<span class="op" id="5886308">:=</span>&nbsp;<span class="ident" id="5886311">t</span><span class="op" id="5886312">.</span><span class="op" id="5886313">(</span><span class="op" id="5886314">*</span><span class="ident" id="5886315">ast</span><span class="op" id="5886318">.</span><span class="ident" id="5886319">LabeledStmt</span><span class="op" id="5886330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5886336">if</span>&nbsp;<span class="ident" id="5886339">lt</span>&nbsp;<span class="op" id="5886342">==</span>&nbsp;<span class="ident" id="5886345">nil</span>&nbsp;<span class="op" id="5886349">{</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5886356">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5886366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5886372">line</span><span class="op" id="5886376">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5886383">t</span>&nbsp;<span class="op" id="5886385">=</span>&nbsp;<span class="ident" id="5886387">lt</span><span class="op" id="5886389">.</span><span class="ident" id="5886390">Stmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5886398">}</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5886403">i</span><span class="op" id="5886404">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5886409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5886412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5886415">if</span>&nbsp;<span class="ident" id="5886418">nindent</span>&nbsp;<span class="op" id="5886426">&gt;</span>&nbsp;<span class="num" id="5886428">0</span>&nbsp;<span class="op" id="5886430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5886434">p</span><span class="op" id="5886435">.</span><span class="builtinfunc" id="5886436">print</span><span class="op" id="5886441">(</span><span class="ident" id="5886442">unindent</span><span class="op" id="5886450">)</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5886453">}</span><br>
<span class="lineno"></span><span class="op" id="5886455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5886458">//&nbsp;block&nbsp;prints&nbsp;an&nbsp;*ast.BlockStmt;&nbsp;it&nbsp;always&nbsp;spans&nbsp;at&nbsp;least&nbsp;two&nbsp;lines.</span><br>
<span class="lineno"></span><span class="keyword" id="5886529">func</span>&nbsp;<span class="op" id="5886534">(</span><span class="ident" id="5886535">p</span>&nbsp;<span class="op" id="5886537">*</span><span class="ident" id="5886538">printer</span><span class="op" id="5886545">)</span>&nbsp;<span class="ident" id="5886547">block</span><span class="op" id="5886552">(</span><span class="ident" id="5886553">b</span>&nbsp;<span class="op" id="5886555">*</span><span class="ident" id="5886556">ast</span><span class="op" id="5886559">.</span><span class="ident" id="5886560">BlockStmt</span><span class="op" id="5886569">,</span>&nbsp;<span class="ident" id="5886571">nindent</span>&nbsp;<span class="builtintype" id="5886579">int</span><span class="op" id="5886582">)</span>&nbsp;<span class="op" id="5886584">{</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5886587">p</span><span class="op" id="5886588">.</span><span class="builtinfunc" id="5886589">print</span><span class="op" id="5886594">(</span><span class="ident" id="5886595">b</span><span class="op" id="5886596">.</span><span class="ident" id="5886597">Lbrace</span><span class="op" id="5886603">,</span>&nbsp;<span class="ident" id="5886605">token</span><span class="op" id="5886610">.</span><span class="ident" id="5886611">LBRACE</span><span class="op" id="5886617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5886620">p</span><span class="op" id="5886621">.</span><span class="ident" id="5886622">stmtList</span><span class="op" id="5886630">(</span><span class="ident" id="5886631">b</span><span class="op" id="5886632">.</span><span class="ident" id="5886633">List</span><span class="op" id="5886637">,</span>&nbsp;<span class="ident" id="5886639">nindent</span><span class="op" id="5886646">,</span>&nbsp;<span class="builtintype" id="5886648">true</span><span class="op" id="5886652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5886655">p</span><span class="op" id="5886656">.</span><span class="ident" id="5886657">linebreak</span><span class="op" id="5886666">(</span><span class="ident" id="5886667">p</span><span class="op" id="5886668">.</span><span class="ident" id="5886669">lineFor</span><span class="op" id="5886676">(</span><span class="ident" id="5886677">b</span><span class="op" id="5886678">.</span><span class="ident" id="5886679">Rbrace</span><span class="op" id="5886685">)</span><span class="op" id="5886686">,</span>&nbsp;<span class="num" id="5886688">1</span><span class="op" id="5886689">,</span>&nbsp;<span class="ident" id="5886691">ignore</span><span class="op" id="5886697">,</span>&nbsp;<span class="builtintype" id="5886699">true</span><span class="op" id="5886703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5886706">p</span><span class="op" id="5886707">.</span><span class="builtinfunc" id="5886708">print</span><span class="op" id="5886713">(</span><span class="ident" id="5886714">b</span><span class="op" id="5886715">.</span><span class="ident" id="5886716">Rbrace</span><span class="op" id="5886722">,</span>&nbsp;<span class="ident" id="5886724">token</span><span class="op" id="5886729">.</span><span class="ident" id="5886730">RBRACE</span><span class="op" id="5886736">)</span><br>
<span class="lineno"></span><span class="op" id="5886738">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span><span class="keyword" id="5886741">func</span>&nbsp;<span class="ident" id="5886746">isTypeName</span><span class="op" id="5886756">(</span><span class="ident" id="5886757">x</span>&nbsp;<span class="ident" id="5886759">ast</span><span class="op" id="5886762">.</span><span class="ident" id="5886763">Expr</span><span class="op" id="5886767">)</span>&nbsp;<span class="builtintype" id="5886769">bool</span>&nbsp;<span class="op" id="5886774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5886777">switch</span>&nbsp;<span class="ident" id="5886784">t</span>&nbsp;<span class="op" id="5886786">:=</span>&nbsp;<span class="ident" id="5886789">x</span><span class="op" id="5886790">.</span><span class="op" id="5886791">(</span><span class="keyword" id="5886792">type</span><span class="op" id="5886796">)</span>&nbsp;<span class="op" id="5886798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5886801">case</span>&nbsp;<span class="op" id="5886806">*</span><span class="ident" id="5886807">ast</span><span class="op" id="5886810">.</span><span class="ident" id="5886811">Ident</span><span class="op" id="5886816">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5886820">return</span>&nbsp;<span class="builtintype" id="5886827">true</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5886833">case</span>&nbsp;<span class="op" id="5886838">*</span><span class="ident" id="5886839">ast</span><span class="op" id="5886842">.</span><span class="ident" id="5886843">SelectorExpr</span><span class="op" id="5886855">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5886859">return</span>&nbsp;<span class="ident" id="5886866">isTypeName</span><span class="op" id="5886876">(</span><span class="ident" id="5886877">t</span><span class="op" id="5886878">.</span><span class="ident" id="5886879">X</span><span class="op" id="5886880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5886883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5886886">return</span>&nbsp;<span class="builtintype" id="5886893">false</span><br>
<span class="lineno"></span><span class="op" id="5886899">}</span><br>
<span class="lineno">960</span><br>
<span class="lineno"></span><span class="keyword" id="5886902">func</span>&nbsp;<span class="ident" id="5886907">stripParens</span><span class="op" id="5886918">(</span><span class="ident" id="5886919">x</span>&nbsp;<span class="ident" id="5886921">ast</span><span class="op" id="5886924">.</span><span class="ident" id="5886925">Expr</span><span class="op" id="5886929">)</span>&nbsp;<span class="ident" id="5886931">ast</span><span class="op" id="5886934">.</span><span class="ident" id="5886935">Expr</span>&nbsp;<span class="op" id="5886940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5886943">if</span>&nbsp;<span class="ident" id="5886946">px</span><span class="op" id="5886948">,</span>&nbsp;<span class="ident" id="5886950">strip</span>&nbsp;<span class="op" id="5886956">:=</span>&nbsp;<span class="ident" id="5886959">x</span><span class="op" id="5886960">.</span><span class="op" id="5886961">(</span><span class="op" id="5886962">*</span><span class="ident" id="5886963">ast</span><span class="op" id="5886966">.</span><span class="ident" id="5886967">ParenExpr</span><span class="op" id="5886976">)</span><span class="op" id="5886977">;</span>&nbsp;<span class="ident" id="5886979">strip</span>&nbsp;<span class="op" id="5886985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5886989">//&nbsp;parentheses&nbsp;must&nbsp;not&nbsp;be&nbsp;stripped&nbsp;if&nbsp;there&nbsp;are&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5887044">//&nbsp;unparenthesized&nbsp;composite&nbsp;literals&nbsp;starting&nbsp;with</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5887098">//&nbsp;a&nbsp;type&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5887115">ast</span><span class="op" id="5887118">.</span><span class="ident" id="5887119">Inspect</span><span class="op" id="5887126">(</span><span class="ident" id="5887127">px</span><span class="op" id="5887129">.</span><span class="ident" id="5887130">X</span><span class="op" id="5887131">,</span>&nbsp;<span class="keyword" id="5887133">func</span><span class="op" id="5887137">(</span><span class="ident" id="5887138">node</span>&nbsp;<span class="ident" id="5887143">ast</span><span class="op" id="5887146">.</span><span class="ident" id="5887147">Node</span><span class="op" id="5887151">)</span>&nbsp;<span class="builtintype" id="5887153">bool</span>&nbsp;<span class="op" id="5887158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5887163">switch</span>&nbsp;<span class="ident" id="5887170">x</span>&nbsp;<span class="op" id="5887172">:=</span>&nbsp;<span class="ident" id="5887175">node</span><span class="op" id="5887179">.</span><span class="op" id="5887180">(</span><span class="keyword" id="5887181">type</span><span class="op" id="5887185">)</span>&nbsp;<span class="op" id="5887187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5887192">case</span>&nbsp;<span class="op" id="5887197">*</span><span class="ident" id="5887198">ast</span><span class="op" id="5887201">.</span><span class="ident" id="5887202">ParenExpr</span><span class="op" id="5887211">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5887217">//&nbsp;parentheses&nbsp;protect&nbsp;enclosed&nbsp;composite&nbsp;literals</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5887272">return</span>&nbsp;<span class="builtintype" id="5887279">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5887288">case</span>&nbsp;<span class="op" id="5887293">*</span><span class="ident" id="5887294">ast</span><span class="op" id="5887297">.</span><span class="ident" id="5887298">CompositeLit</span><span class="op" id="5887310">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5887316">if</span>&nbsp;<span class="ident" id="5887319">isTypeName</span><span class="op" id="5887329">(</span><span class="ident" id="5887330">x</span><span class="op" id="5887331">.</span><span class="ident" id="5887332">Type</span><span class="op" id="5887336">)</span>&nbsp;<span class="op" id="5887338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5887345">strip</span>&nbsp;<span class="op" id="5887351">=</span>&nbsp;<span class="builtintype" id="5887353">false</span>&nbsp;<span class="comment" id="5887359">//&nbsp;do&nbsp;not&nbsp;strip&nbsp;parentheses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5887391">}</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5887397">return</span>&nbsp;<span class="builtintype" id="5887404">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5887413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5887418">//&nbsp;in&nbsp;all&nbsp;other&nbsp;cases,&nbsp;keep&nbsp;inspecting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5887460">return</span>&nbsp;<span class="builtintype" id="5887467">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5887474">}</span><span class="op" id="5887475">)</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5887479">if</span>&nbsp;<span class="ident" id="5887482">strip</span>&nbsp;<span class="op" id="5887488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5887493">return</span>&nbsp;<span class="ident" id="5887500">stripParens</span><span class="op" id="5887511">(</span><span class="ident" id="5887512">px</span><span class="op" id="5887514">.</span><span class="ident" id="5887515">X</span><span class="op" id="5887516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5887520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5887523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5887526">return</span>&nbsp;<span class="ident" id="5887533">x</span><br>
<span class="lineno">985</span><span class="op" id="5887535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5887538">func</span>&nbsp;<span class="ident" id="5887543">stripParensAlways</span><span class="op" id="5887560">(</span><span class="ident" id="5887561">x</span>&nbsp;<span class="ident" id="5887563">ast</span><span class="op" id="5887566">.</span><span class="ident" id="5887567">Expr</span><span class="op" id="5887571">)</span>&nbsp;<span class="ident" id="5887573">ast</span><span class="op" id="5887576">.</span><span class="ident" id="5887577">Expr</span>&nbsp;<span class="op" id="5887582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5887585">if</span>&nbsp;<span class="ident" id="5887588">x</span><span class="op" id="5887589">,</span>&nbsp;<span class="ident" id="5887591">ok</span>&nbsp;<span class="op" id="5887594">:=</span>&nbsp;<span class="ident" id="5887597">x</span><span class="op" id="5887598">.</span><span class="op" id="5887599">(</span><span class="op" id="5887600">*</span><span class="ident" id="5887601">ast</span><span class="op" id="5887604">.</span><span class="ident" id="5887605">ParenExpr</span><span class="op" id="5887614">)</span><span class="op" id="5887615">;</span>&nbsp;<span class="ident" id="5887617">ok</span>&nbsp;<span class="op" id="5887620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5887624">return</span>&nbsp;<span class="ident" id="5887631">stripParensAlways</span><span class="op" id="5887648">(</span><span class="ident" id="5887649">x</span><span class="op" id="5887650">.</span><span class="ident" id="5887651">X</span><span class="op" id="5887652">)</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5887655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5887658">return</span>&nbsp;<span class="ident" id="5887665">x</span><br>
<span class="lineno"></span><span class="op" id="5887667">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5887670">func</span>&nbsp;<span class="op" id="5887675">(</span><span class="ident" id="5887676">p</span>&nbsp;<span class="op" id="5887678">*</span><span class="ident" id="5887679">printer</span><span class="op" id="5887686">)</span>&nbsp;<span class="ident" id="5887688">controlClause</span><span class="op" id="5887701">(</span><span class="ident" id="5887702">isForStmt</span>&nbsp;<span class="builtintype" id="5887712">bool</span><span class="op" id="5887716">,</span>&nbsp;<span class="ident" id="5887718">init</span>&nbsp;<span class="ident" id="5887723">ast</span><span class="op" id="5887726">.</span><span class="ident" id="5887727">Stmt</span><span class="op" id="5887731">,</span>&nbsp;<span class="ident" id="5887733">expr</span>&nbsp;<span class="ident" id="5887738">ast</span><span class="op" id="5887741">.</span><span class="ident" id="5887742">Expr</span><span class="op" id="5887746">,</span>&nbsp;<span class="ident" id="5887748">post</span>&nbsp;<span class="ident" id="5887753">ast</span><span class="op" id="5887756">.</span><span class="ident" id="5887757">Stmt</span><span class="op" id="5887761">)</span>&nbsp;<span class="op" id="5887763">{</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5887766">p</span><span class="op" id="5887767">.</span><span class="builtinfunc" id="5887768">print</span><span class="op" id="5887773">(</span><span class="ident" id="5887774">blank</span><span class="op" id="5887779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5887782">needsBlank</span>&nbsp;<span class="op" id="5887793">:=</span>&nbsp;<span class="builtintype" id="5887796">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5887803">if</span>&nbsp;<span class="ident" id="5887806">init</span>&nbsp;<span class="op" id="5887811">==</span>&nbsp;<span class="ident" id="5887814">nil</span>&nbsp;<span class="op" id="5887818">&amp;&amp;</span>&nbsp;<span class="ident" id="5887821">post</span>&nbsp;<span class="op" id="5887826">==</span>&nbsp;<span class="ident" id="5887829">nil</span>&nbsp;<span class="op" id="5887833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5887837">//&nbsp;no&nbsp;semicolons&nbsp;required</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5887865">if</span>&nbsp;<span class="ident" id="5887868">expr</span>&nbsp;<span class="op" id="5887873">!=</span>&nbsp;<span class="ident" id="5887876">nil</span>&nbsp;<span class="op" id="5887880">{</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5887885">p</span><span class="op" id="5887886">.</span><span class="ident" id="5887887">expr</span><span class="op" id="5887891">(</span><span class="ident" id="5887892">stripParens</span><span class="op" id="5887903">(</span><span class="ident" id="5887904">expr</span><span class="op" id="5887908">)</span><span class="op" id="5887909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5887914">needsBlank</span>&nbsp;<span class="op" id="5887925">=</span>&nbsp;<span class="builtintype" id="5887927">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5887934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5887937">}</span>&nbsp;<span class="keyword" id="5887939">else</span>&nbsp;<span class="op" id="5887944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5887948">//&nbsp;all&nbsp;semicolons&nbsp;required</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5887977">//&nbsp;(they&nbsp;are&nbsp;not&nbsp;separators,&nbsp;print&nbsp;them&nbsp;explicitly)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5888031">if</span>&nbsp;<span class="ident" id="5888034">init</span>&nbsp;<span class="op" id="5888039">!=</span>&nbsp;<span class="ident" id="5888042">nil</span>&nbsp;<span class="op" id="5888046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5888051">p</span><span class="op" id="5888052">.</span><span class="ident" id="5888053">stmt</span><span class="op" id="5888057">(</span><span class="ident" id="5888058">init</span><span class="op" id="5888062">,</span>&nbsp;<span class="builtintype" id="5888064">false</span><span class="op" id="5888069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5888073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5888077">p</span><span class="op" id="5888078">.</span><span class="builtinfunc" id="5888079">print</span><span class="op" id="5888084">(</span><span class="ident" id="5888085">token</span><span class="op" id="5888090">.</span><span class="ident" id="5888091">SEMICOLON</span><span class="op" id="5888100">,</span>&nbsp;<span class="ident" id="5888102">blank</span><span class="op" id="5888107">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5888111">if</span>&nbsp;<span class="ident" id="5888114">expr</span>&nbsp;<span class="op" id="5888119">!=</span>&nbsp;<span class="ident" id="5888122">nil</span>&nbsp;<span class="op" id="5888126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5888131">p</span><span class="op" id="5888132">.</span><span class="ident" id="5888133">expr</span><span class="op" id="5888137">(</span><span class="ident" id="5888138">stripParens</span><span class="op" id="5888149">(</span><span class="ident" id="5888150">expr</span><span class="op" id="5888154">)</span><span class="op" id="5888155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5888160">needsBlank</span>&nbsp;<span class="op" id="5888171">=</span>&nbsp;<span class="builtintype" id="5888173">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5888180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5888184">if</span>&nbsp;<span class="ident" id="5888187">isForStmt</span>&nbsp;<span class="op" id="5888197">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5888202">p</span><span class="op" id="5888203">.</span><span class="builtinfunc" id="5888204">print</span><span class="op" id="5888209">(</span><span class="ident" id="5888210">token</span><span class="op" id="5888215">.</span><span class="ident" id="5888216">SEMICOLON</span><span class="op" id="5888225">,</span>&nbsp;<span class="ident" id="5888227">blank</span><span class="op" id="5888232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5888237">needsBlank</span>&nbsp;<span class="op" id="5888248">=</span>&nbsp;<span class="builtintype" id="5888250">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5888259">if</span>&nbsp;<span class="ident" id="5888262">post</span>&nbsp;<span class="op" id="5888267">!=</span>&nbsp;<span class="ident" id="5888270">nil</span>&nbsp;<span class="op" id="5888274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5888280">p</span><span class="op" id="5888281">.</span><span class="ident" id="5888282">stmt</span><span class="op" id="5888286">(</span><span class="ident" id="5888287">post</span><span class="op" id="5888291">,</span>&nbsp;<span class="builtintype" id="5888293">false</span><span class="op" id="5888298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5888304">needsBlank</span>&nbsp;<span class="op" id="5888315">=</span>&nbsp;<span class="builtintype" id="5888317">true</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5888325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5888329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5888332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5888335">if</span>&nbsp;<span class="ident" id="5888338">needsBlank</span>&nbsp;<span class="op" id="5888349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5888353">p</span><span class="op" id="5888354">.</span><span class="builtinfunc" id="5888355">print</span><span class="op" id="5888360">(</span><span class="ident" id="5888361">blank</span><span class="op" id="5888366">)</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5888369">}</span><br>
<span class="lineno"></span><span class="op" id="5888371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5888374">//&nbsp;indentList&nbsp;reports&nbsp;whether&nbsp;an&nbsp;expression&nbsp;list&nbsp;would&nbsp;look&nbsp;better&nbsp;if&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5888447">//&nbsp;were&nbsp;indented&nbsp;wholesale&nbsp;(starting&nbsp;with&nbsp;the&nbsp;very&nbsp;first&nbsp;element,&nbsp;rather</span><br>
<span class="lineno">1030</span><span class="comment" id="5888520">//&nbsp;than&nbsp;starting&nbsp;at&nbsp;the&nbsp;first&nbsp;line&nbsp;break).</span><br>
<span class="lineno"></span><span class="comment" id="5888563">//</span><br>
<span class="lineno"></span><span class="keyword" id="5888566">func</span>&nbsp;<span class="op" id="5888571">(</span><span class="ident" id="5888572">p</span>&nbsp;<span class="op" id="5888574">*</span><span class="ident" id="5888575">printer</span><span class="op" id="5888582">)</span>&nbsp;<span class="ident" id="5888584">indentList</span><span class="op" id="5888594">(</span><span class="ident" id="5888595">list</span>&nbsp;<span class="op" id="5888600">[</span><span class="op" id="5888601">]</span><span class="ident" id="5888602">ast</span><span class="op" id="5888605">.</span><span class="ident" id="5888606">Expr</span><span class="op" id="5888610">)</span>&nbsp;<span class="builtintype" id="5888612">bool</span>&nbsp;<span class="op" id="5888617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5888620">//&nbsp;Heuristic:&nbsp;indentList&nbsp;returns&nbsp;true&nbsp;if&nbsp;there&nbsp;are&nbsp;more&nbsp;than&nbsp;one&nbsp;multi-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5888693">//&nbsp;line&nbsp;element&nbsp;in&nbsp;the&nbsp;list,&nbsp;or&nbsp;if&nbsp;there&nbsp;is&nbsp;any&nbsp;element&nbsp;that&nbsp;is&nbsp;not</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5888762">//&nbsp;starting&nbsp;on&nbsp;the&nbsp;same&nbsp;line&nbsp;as&nbsp;the&nbsp;previous&nbsp;one&nbsp;ends.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5888818">if</span>&nbsp;<span class="builtinfunc" id="5888821">len</span><span class="op" id="5888824">(</span><span class="ident" id="5888825">list</span><span class="op" id="5888829">)</span>&nbsp;<span class="op" id="5888831">&gt;=</span>&nbsp;<span class="num" id="5888834">2</span>&nbsp;<span class="op" id="5888836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5888840">var</span>&nbsp;<span class="ident" id="5888844">b</span>&nbsp;<span class="op" id="5888846">=</span>&nbsp;<span class="ident" id="5888848">p</span><span class="op" id="5888849">.</span><span class="ident" id="5888850">lineFor</span><span class="op" id="5888857">(</span><span class="ident" id="5888858">list</span><span class="op" id="5888862">[</span><span class="num" id="5888863">0</span><span class="op" id="5888864">]</span><span class="op" id="5888865">.</span><span class="ident" id="5888866">Pos</span><span class="op" id="5888869">(</span><span class="op" id="5888870">)</span><span class="op" id="5888871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5888875">var</span>&nbsp;<span class="ident" id="5888879">e</span>&nbsp;<span class="op" id="5888881">=</span>&nbsp;<span class="ident" id="5888883">p</span><span class="op" id="5888884">.</span><span class="ident" id="5888885">lineFor</span><span class="op" id="5888892">(</span><span class="ident" id="5888893">list</span><span class="op" id="5888897">[</span><span class="builtinfunc" id="5888898">len</span><span class="op" id="5888901">(</span><span class="ident" id="5888902">list</span><span class="op" id="5888906">)</span><span class="op" id="5888907">-</span><span class="num" id="5888908">1</span><span class="op" id="5888909">]</span><span class="op" id="5888910">.</span><span class="ident" id="5888911">End</span><span class="op" id="5888914">(</span><span class="op" id="5888915">)</span><span class="op" id="5888916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5888920">if</span>&nbsp;<span class="num" id="5888923">0</span>&nbsp;<span class="op" id="5888925">&lt;</span>&nbsp;<span class="ident" id="5888927">b</span>&nbsp;<span class="op" id="5888929">&amp;&amp;</span>&nbsp;<span class="ident" id="5888932">b</span>&nbsp;<span class="op" id="5888934">&lt;</span>&nbsp;<span class="ident" id="5888936">e</span>&nbsp;<span class="op" id="5888938">{</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5888943">//&nbsp;list&nbsp;spans&nbsp;multiple&nbsp;lines</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5888975">n</span>&nbsp;<span class="op" id="5888977">:=</span>&nbsp;<span class="num" id="5888980">0</span>&nbsp;<span class="comment" id="5888982">//&nbsp;multi-line&nbsp;element&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889013">line</span>&nbsp;<span class="op" id="5889018">:=</span>&nbsp;<span class="ident" id="5889021">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5889026">for</span>&nbsp;<span class="ident" id="5889030">_</span><span class="op" id="5889031">,</span>&nbsp;<span class="ident" id="5889033">x</span>&nbsp;<span class="op" id="5889035">:=</span>&nbsp;<span class="keyword" id="5889038">range</span>&nbsp;<span class="ident" id="5889044">list</span>&nbsp;<span class="op" id="5889049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889055">xb</span>&nbsp;<span class="op" id="5889058">:=</span>&nbsp;<span class="ident" id="5889061">p</span><span class="op" id="5889062">.</span><span class="ident" id="5889063">lineFor</span><span class="op" id="5889070">(</span><span class="ident" id="5889071">x</span><span class="op" id="5889072">.</span><span class="ident" id="5889073">Pos</span><span class="op" id="5889076">(</span><span class="op" id="5889077">)</span><span class="op" id="5889078">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889084">xe</span>&nbsp;<span class="op" id="5889087">:=</span>&nbsp;<span class="ident" id="5889090">p</span><span class="op" id="5889091">.</span><span class="ident" id="5889092">lineFor</span><span class="op" id="5889099">(</span><span class="ident" id="5889100">x</span><span class="op" id="5889101">.</span><span class="ident" id="5889102">End</span><span class="op" id="5889105">(</span><span class="op" id="5889106">)</span><span class="op" id="5889107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5889113">if</span>&nbsp;<span class="ident" id="5889116">line</span>&nbsp;<span class="op" id="5889121">&lt;</span>&nbsp;<span class="ident" id="5889123">xb</span>&nbsp;<span class="op" id="5889126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5889133">//&nbsp;x&nbsp;is&nbsp;not&nbsp;starting&nbsp;on&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5889171">//&nbsp;line&nbsp;as&nbsp;the&nbsp;previous&nbsp;one&nbsp;ended</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5889210">return</span>&nbsp;<span class="builtintype" id="5889217">true</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5889226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5889232">if</span>&nbsp;<span class="ident" id="5889235">xb</span>&nbsp;<span class="op" id="5889238">&lt;</span>&nbsp;<span class="ident" id="5889240">xe</span>&nbsp;<span class="op" id="5889243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5889250">//&nbsp;x&nbsp;is&nbsp;a&nbsp;multi-line&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889284">n</span><span class="op" id="5889285">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5889292">}</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889298">line</span>&nbsp;<span class="op" id="5889303">=</span>&nbsp;<span class="ident" id="5889305">xe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5889311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5889316">return</span>&nbsp;<span class="ident" id="5889323">n</span>&nbsp;<span class="op" id="5889325">&gt;</span>&nbsp;<span class="num" id="5889327">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5889331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5889334">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5889337">return</span>&nbsp;<span class="builtintype" id="5889344">false</span><br>
<span class="lineno"></span><span class="op" id="5889350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5889353">func</span>&nbsp;<span class="op" id="5889358">(</span><span class="ident" id="5889359">p</span>&nbsp;<span class="op" id="5889361">*</span><span class="ident" id="5889362">printer</span><span class="op" id="5889369">)</span>&nbsp;<span class="ident" id="5889371">stmt</span><span class="op" id="5889375">(</span><span class="ident" id="5889376">stmt</span>&nbsp;<span class="ident" id="5889381">ast</span><span class="op" id="5889384">.</span><span class="ident" id="5889385">Stmt</span><span class="op" id="5889389">,</span>&nbsp;<span class="ident" id="5889391">nextIsRBrace</span>&nbsp;<span class="builtintype" id="5889404">bool</span><span class="op" id="5889408">)</span>&nbsp;<span class="op" id="5889410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889413">p</span><span class="op" id="5889414">.</span><span class="builtinfunc" id="5889415">print</span><span class="op" id="5889420">(</span><span class="ident" id="5889421">stmt</span><span class="op" id="5889425">.</span><span class="ident" id="5889426">Pos</span><span class="op" id="5889429">(</span><span class="op" id="5889430">)</span><span class="op" id="5889431">)</span><br>
<span class="lineno">1065</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5889435">switch</span>&nbsp;<span class="ident" id="5889442">s</span>&nbsp;<span class="op" id="5889444">:=</span>&nbsp;<span class="ident" id="5889447">stmt</span><span class="op" id="5889451">.</span><span class="op" id="5889452">(</span><span class="keyword" id="5889453">type</span><span class="op" id="5889457">)</span>&nbsp;<span class="op" id="5889459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5889462">case</span>&nbsp;<span class="op" id="5889467">*</span><span class="ident" id="5889468">ast</span><span class="op" id="5889471">.</span><span class="ident" id="5889472">BadStmt</span><span class="op" id="5889479">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889483">p</span><span class="op" id="5889484">.</span><span class="builtinfunc" id="5889485">print</span><span class="op" id="5889490">(</span><span class="string" id="5889491">&#34;BadStmt&#34;</span><span class="op" id="5889500">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5889504">case</span>&nbsp;<span class="op" id="5889509">*</span><span class="ident" id="5889510">ast</span><span class="op" id="5889513">.</span><span class="ident" id="5889514">DeclStmt</span><span class="op" id="5889522">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889526">p</span><span class="op" id="5889527">.</span><span class="ident" id="5889528">decl</span><span class="op" id="5889532">(</span><span class="ident" id="5889533">s</span><span class="op" id="5889534">.</span><span class="ident" id="5889535">Decl</span><span class="op" id="5889539">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5889543">case</span>&nbsp;<span class="op" id="5889548">*</span><span class="ident" id="5889549">ast</span><span class="op" id="5889552">.</span><span class="ident" id="5889553">EmptyStmt</span><span class="op" id="5889562">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5889566">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno">1075</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5889585">case</span>&nbsp;<span class="op" id="5889590">*</span><span class="ident" id="5889591">ast</span><span class="op" id="5889594">.</span><span class="ident" id="5889595">LabeledStmt</span><span class="op" id="5889606">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5889610">//&nbsp;a&nbsp;&#34;correcting&#34;&nbsp;unindent&nbsp;immediately&nbsp;following&nbsp;a&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5889674">//&nbsp;is&nbsp;applied&nbsp;before&nbsp;the&nbsp;line&nbsp;break&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5889735">//&nbsp;between&nbsp;(see&nbsp;writeWhitespace)</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889770">p</span><span class="op" id="5889771">.</span><span class="builtinfunc" id="5889772">print</span><span class="op" id="5889777">(</span><span class="ident" id="5889778">unindent</span><span class="op" id="5889786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889790">p</span><span class="op" id="5889791">.</span><span class="ident" id="5889792">expr</span><span class="op" id="5889796">(</span><span class="ident" id="5889797">s</span><span class="op" id="5889798">.</span><span class="ident" id="5889799">Label</span><span class="op" id="5889804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889808">p</span><span class="op" id="5889809">.</span><span class="builtinfunc" id="5889810">print</span><span class="op" id="5889815">(</span><span class="ident" id="5889816">s</span><span class="op" id="5889817">.</span><span class="ident" id="5889818">Colon</span><span class="op" id="5889823">,</span>&nbsp;<span class="ident" id="5889825">token</span><span class="op" id="5889830">.</span><span class="ident" id="5889831">COLON</span><span class="op" id="5889836">,</span>&nbsp;<span class="ident" id="5889838">indent</span><span class="op" id="5889844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5889848">if</span>&nbsp;<span class="ident" id="5889851">e</span><span class="op" id="5889852">,</span>&nbsp;<span class="ident" id="5889854">isEmpty</span>&nbsp;<span class="op" id="5889862">:=</span>&nbsp;<span class="ident" id="5889865">s</span><span class="op" id="5889866">.</span><span class="ident" id="5889867">Stmt</span><span class="op" id="5889871">.</span><span class="op" id="5889872">(</span><span class="op" id="5889873">*</span><span class="ident" id="5889874">ast</span><span class="op" id="5889877">.</span><span class="ident" id="5889878">EmptyStmt</span><span class="op" id="5889887">)</span><span class="op" id="5889888">;</span>&nbsp;<span class="ident" id="5889890">isEmpty</span>&nbsp;<span class="op" id="5889898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5889903">if</span>&nbsp;<span class="op" id="5889906">!</span><span class="ident" id="5889907">nextIsRBrace</span>&nbsp;<span class="op" id="5889920">{</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889926">p</span><span class="op" id="5889927">.</span><span class="builtinfunc" id="5889928">print</span><span class="op" id="5889933">(</span><span class="ident" id="5889934">newline</span><span class="op" id="5889941">,</span>&nbsp;<span class="ident" id="5889943">e</span><span class="op" id="5889944">.</span><span class="ident" id="5889945">Pos</span><span class="op" id="5889948">(</span><span class="op" id="5889949">)</span><span class="op" id="5889950">,</span>&nbsp;<span class="ident" id="5889952">token</span><span class="op" id="5889957">.</span><span class="ident" id="5889958">SEMICOLON</span><span class="op" id="5889967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5889973">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5889982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5889986">}</span>&nbsp;<span class="keyword" id="5889988">else</span>&nbsp;<span class="op" id="5889993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5889998">p</span><span class="op" id="5889999">.</span><span class="ident" id="5890000">linebreak</span><span class="op" id="5890009">(</span><span class="ident" id="5890010">p</span><span class="op" id="5890011">.</span><span class="ident" id="5890012">lineFor</span><span class="op" id="5890019">(</span><span class="ident" id="5890020">s</span><span class="op" id="5890021">.</span><span class="ident" id="5890022">Stmt</span><span class="op" id="5890026">.</span><span class="ident" id="5890027">Pos</span><span class="op" id="5890030">(</span><span class="op" id="5890031">)</span><span class="op" id="5890032">)</span><span class="op" id="5890033">,</span>&nbsp;<span class="num" id="5890035">1</span><span class="op" id="5890036">,</span>&nbsp;<span class="ident" id="5890038">ignore</span><span class="op" id="5890044">,</span>&nbsp;<span class="builtintype" id="5890046">true</span><span class="op" id="5890050">)</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5890054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890058">p</span><span class="op" id="5890059">.</span><span class="ident" id="5890060">stmt</span><span class="op" id="5890064">(</span><span class="ident" id="5890065">s</span><span class="op" id="5890066">.</span><span class="ident" id="5890067">Stmt</span><span class="op" id="5890071">,</span>&nbsp;<span class="ident" id="5890073">nextIsRBrace</span><span class="op" id="5890085">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5890089">case</span>&nbsp;<span class="op" id="5890094">*</span><span class="ident" id="5890095">ast</span><span class="op" id="5890098">.</span><span class="ident" id="5890099">ExprStmt</span><span class="op" id="5890107">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5890111">const</span>&nbsp;<span class="ident" id="5890117">depth</span>&nbsp;<span class="op" id="5890123">=</span>&nbsp;<span class="num" id="5890125">1</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890129">p</span><span class="op" id="5890130">.</span><span class="ident" id="5890131">expr0</span><span class="op" id="5890136">(</span><span class="ident" id="5890137">s</span><span class="op" id="5890138">.</span><span class="ident" id="5890139">X</span><span class="op" id="5890140">,</span>&nbsp;<span class="ident" id="5890142">depth</span><span class="op" id="5890147">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5890151">case</span>&nbsp;<span class="op" id="5890156">*</span><span class="ident" id="5890157">ast</span><span class="op" id="5890160">.</span><span class="ident" id="5890161">SendStmt</span><span class="op" id="5890169">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5890173">const</span>&nbsp;<span class="ident" id="5890179">depth</span>&nbsp;<span class="op" id="5890185">=</span>&nbsp;<span class="num" id="5890187">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890191">p</span><span class="op" id="5890192">.</span><span class="ident" id="5890193">expr0</span><span class="op" id="5890198">(</span><span class="ident" id="5890199">s</span><span class="op" id="5890200">.</span><span class="ident" id="5890201">Chan</span><span class="op" id="5890205">,</span>&nbsp;<span class="ident" id="5890207">depth</span><span class="op" id="5890212">)</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890216">p</span><span class="op" id="5890217">.</span><span class="builtinfunc" id="5890218">print</span><span class="op" id="5890223">(</span><span class="ident" id="5890224">blank</span><span class="op" id="5890229">,</span>&nbsp;<span class="ident" id="5890231">s</span><span class="op" id="5890232">.</span><span class="ident" id="5890233">Arrow</span><span class="op" id="5890238">,</span>&nbsp;<span class="ident" id="5890240">token</span><span class="op" id="5890245">.</span><span class="ident" id="5890246">ARROW</span><span class="op" id="5890251">,</span>&nbsp;<span class="ident" id="5890253">blank</span><span class="op" id="5890258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890262">p</span><span class="op" id="5890263">.</span><span class="ident" id="5890264">expr0</span><span class="op" id="5890269">(</span><span class="ident" id="5890270">s</span><span class="op" id="5890271">.</span><span class="ident" id="5890272">Value</span><span class="op" id="5890277">,</span>&nbsp;<span class="ident" id="5890279">depth</span><span class="op" id="5890284">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5890288">case</span>&nbsp;<span class="op" id="5890293">*</span><span class="ident" id="5890294">ast</span><span class="op" id="5890297">.</span><span class="ident" id="5890298">IncDecStmt</span><span class="op" id="5890308">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5890312">const</span>&nbsp;<span class="ident" id="5890318">depth</span>&nbsp;<span class="op" id="5890324">=</span>&nbsp;<span class="num" id="5890326">1</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890330">p</span><span class="op" id="5890331">.</span><span class="ident" id="5890332">expr0</span><span class="op" id="5890337">(</span><span class="ident" id="5890338">s</span><span class="op" id="5890339">.</span><span class="ident" id="5890340">X</span><span class="op" id="5890341">,</span>&nbsp;<span class="ident" id="5890343">depth</span><span class="op" id="5890348">+</span><span class="num" id="5890349">1</span><span class="op" id="5890350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890354">p</span><span class="op" id="5890355">.</span><span class="builtinfunc" id="5890356">print</span><span class="op" id="5890361">(</span><span class="ident" id="5890362">s</span><span class="op" id="5890363">.</span><span class="ident" id="5890364">TokPos</span><span class="op" id="5890370">,</span>&nbsp;<span class="ident" id="5890372">s</span><span class="op" id="5890373">.</span><span class="ident" id="5890374">Tok</span><span class="op" id="5890377">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5890381">case</span>&nbsp;<span class="op" id="5890386">*</span><span class="ident" id="5890387">ast</span><span class="op" id="5890390">.</span><span class="ident" id="5890391">AssignStmt</span><span class="op" id="5890401">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5890405">var</span>&nbsp;<span class="ident" id="5890409">depth</span>&nbsp;<span class="op" id="5890415">=</span>&nbsp;<span class="num" id="5890417">1</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5890421">if</span>&nbsp;<span class="builtinfunc" id="5890424">len</span><span class="op" id="5890427">(</span><span class="ident" id="5890428">s</span><span class="op" id="5890429">.</span><span class="ident" id="5890430">Lhs</span><span class="op" id="5890433">)</span>&nbsp;<span class="op" id="5890435">&gt;</span>&nbsp;<span class="num" id="5890437">1</span>&nbsp;<span class="op" id="5890439">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5890442">len</span><span class="op" id="5890445">(</span><span class="ident" id="5890446">s</span><span class="op" id="5890447">.</span><span class="ident" id="5890448">Rhs</span><span class="op" id="5890451">)</span>&nbsp;<span class="op" id="5890453">&gt;</span>&nbsp;<span class="num" id="5890455">1</span>&nbsp;<span class="op" id="5890457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890462">depth</span><span class="op" id="5890467">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5890472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890476">p</span><span class="op" id="5890477">.</span><span class="ident" id="5890478">exprList</span><span class="op" id="5890486">(</span><span class="ident" id="5890487">s</span><span class="op" id="5890488">.</span><span class="ident" id="5890489">Pos</span><span class="op" id="5890492">(</span><span class="op" id="5890493">)</span><span class="op" id="5890494">,</span>&nbsp;<span class="ident" id="5890496">s</span><span class="op" id="5890497">.</span><span class="ident" id="5890498">Lhs</span><span class="op" id="5890501">,</span>&nbsp;<span class="ident" id="5890503">depth</span><span class="op" id="5890508">,</span>&nbsp;<span class="num" id="5890510">0</span><span class="op" id="5890511">,</span>&nbsp;<span class="ident" id="5890513">s</span><span class="op" id="5890514">.</span><span class="ident" id="5890515">TokPos</span><span class="op" id="5890521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890525">p</span><span class="op" id="5890526">.</span><span class="builtinfunc" id="5890527">print</span><span class="op" id="5890532">(</span><span class="ident" id="5890533">blank</span><span class="op" id="5890538">,</span>&nbsp;<span class="ident" id="5890540">s</span><span class="op" id="5890541">.</span><span class="ident" id="5890542">TokPos</span><span class="op" id="5890548">,</span>&nbsp;<span class="ident" id="5890550">s</span><span class="op" id="5890551">.</span><span class="ident" id="5890552">Tok</span><span class="op" id="5890555">,</span>&nbsp;<span class="ident" id="5890557">blank</span><span class="op" id="5890562">)</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890566">p</span><span class="op" id="5890567">.</span><span class="ident" id="5890568">exprList</span><span class="op" id="5890576">(</span><span class="ident" id="5890577">s</span><span class="op" id="5890578">.</span><span class="ident" id="5890579">TokPos</span><span class="op" id="5890585">,</span>&nbsp;<span class="ident" id="5890587">s</span><span class="op" id="5890588">.</span><span class="ident" id="5890589">Rhs</span><span class="op" id="5890592">,</span>&nbsp;<span class="ident" id="5890594">depth</span><span class="op" id="5890599">,</span>&nbsp;<span class="num" id="5890601">0</span><span class="op" id="5890602">,</span>&nbsp;<span class="ident" id="5890604">token</span><span class="op" id="5890609">.</span><span class="ident" id="5890610">NoPos</span><span class="op" id="5890615">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5890619">case</span>&nbsp;<span class="op" id="5890624">*</span><span class="ident" id="5890625">ast</span><span class="op" id="5890628">.</span><span class="ident" id="5890629">GoStmt</span><span class="op" id="5890635">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890639">p</span><span class="op" id="5890640">.</span><span class="builtinfunc" id="5890641">print</span><span class="op" id="5890646">(</span><span class="ident" id="5890647">token</span><span class="op" id="5890652">.</span><span class="ident" id="5890653">GO</span><span class="op" id="5890655">,</span>&nbsp;<span class="ident" id="5890657">blank</span><span class="op" id="5890662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890666">p</span><span class="op" id="5890667">.</span><span class="ident" id="5890668">expr</span><span class="op" id="5890672">(</span><span class="ident" id="5890673">s</span><span class="op" id="5890674">.</span><span class="ident" id="5890675">Call</span><span class="op" id="5890679">)</span><br>
<span class="lineno">1120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5890683">case</span>&nbsp;<span class="op" id="5890688">*</span><span class="ident" id="5890689">ast</span><span class="op" id="5890692">.</span><span class="ident" id="5890693">DeferStmt</span><span class="op" id="5890702">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890706">p</span><span class="op" id="5890707">.</span><span class="builtinfunc" id="5890708">print</span><span class="op" id="5890713">(</span><span class="ident" id="5890714">token</span><span class="op" id="5890719">.</span><span class="ident" id="5890720">DEFER</span><span class="op" id="5890725">,</span>&nbsp;<span class="ident" id="5890727">blank</span><span class="op" id="5890732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890736">p</span><span class="op" id="5890737">.</span><span class="ident" id="5890738">expr</span><span class="op" id="5890742">(</span><span class="ident" id="5890743">s</span><span class="op" id="5890744">.</span><span class="ident" id="5890745">Call</span><span class="op" id="5890749">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5890753">case</span>&nbsp;<span class="op" id="5890758">*</span><span class="ident" id="5890759">ast</span><span class="op" id="5890762">.</span><span class="ident" id="5890763">ReturnStmt</span><span class="op" id="5890773">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890777">p</span><span class="op" id="5890778">.</span><span class="builtinfunc" id="5890779">print</span><span class="op" id="5890784">(</span><span class="ident" id="5890785">token</span><span class="op" id="5890790">.</span><span class="ident" id="5890791">RETURN</span><span class="op" id="5890797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5890801">if</span>&nbsp;<span class="ident" id="5890804">s</span><span class="op" id="5890805">.</span><span class="ident" id="5890806">Results</span>&nbsp;<span class="op" id="5890814">!=</span>&nbsp;<span class="ident" id="5890817">nil</span>&nbsp;<span class="op" id="5890821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5890826">p</span><span class="op" id="5890827">.</span><span class="builtinfunc" id="5890828">print</span><span class="op" id="5890833">(</span><span class="ident" id="5890834">blank</span><span class="op" id="5890839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5890844">//&nbsp;Use&nbsp;indentList&nbsp;heuristic&nbsp;to&nbsp;make&nbsp;corner&nbsp;cases&nbsp;look</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5890901">//&nbsp;better&nbsp;(issue&nbsp;1207).&nbsp;A&nbsp;more&nbsp;systematic&nbsp;approach&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5890961">//&nbsp;always&nbsp;indent,&nbsp;but&nbsp;this&nbsp;would&nbsp;cause&nbsp;significant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5891015">//&nbsp;reformatting&nbsp;of&nbsp;the&nbsp;code&nbsp;base&nbsp;and&nbsp;not&nbsp;necessarily</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5891071">//&nbsp;lead&nbsp;to&nbsp;more&nbsp;nicely&nbsp;formatted&nbsp;code&nbsp;in&nbsp;general.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891124">if</span>&nbsp;<span class="ident" id="5891127">p</span><span class="op" id="5891128">.</span><span class="ident" id="5891129">indentList</span><span class="op" id="5891139">(</span><span class="ident" id="5891140">s</span><span class="op" id="5891141">.</span><span class="ident" id="5891142">Results</span><span class="op" id="5891149">)</span>&nbsp;<span class="op" id="5891151">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891157">p</span><span class="op" id="5891158">.</span><span class="builtinfunc" id="5891159">print</span><span class="op" id="5891164">(</span><span class="ident" id="5891165">indent</span><span class="op" id="5891171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891177">p</span><span class="op" id="5891178">.</span><span class="ident" id="5891179">exprList</span><span class="op" id="5891187">(</span><span class="ident" id="5891188">s</span><span class="op" id="5891189">.</span><span class="ident" id="5891190">Pos</span><span class="op" id="5891193">(</span><span class="op" id="5891194">)</span><span class="op" id="5891195">,</span>&nbsp;<span class="ident" id="5891197">s</span><span class="op" id="5891198">.</span><span class="ident" id="5891199">Results</span><span class="op" id="5891206">,</span>&nbsp;<span class="num" id="5891208">1</span><span class="op" id="5891209">,</span>&nbsp;<span class="ident" id="5891211">noIndent</span><span class="op" id="5891219">,</span>&nbsp;<span class="ident" id="5891221">token</span><span class="op" id="5891226">.</span><span class="ident" id="5891227">NoPos</span><span class="op" id="5891232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891238">p</span><span class="op" id="5891239">.</span><span class="builtinfunc" id="5891240">print</span><span class="op" id="5891245">(</span><span class="ident" id="5891246">unindent</span><span class="op" id="5891254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5891259">}</span>&nbsp;<span class="keyword" id="5891261">else</span>&nbsp;<span class="op" id="5891266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891272">p</span><span class="op" id="5891273">.</span><span class="ident" id="5891274">exprList</span><span class="op" id="5891282">(</span><span class="ident" id="5891283">s</span><span class="op" id="5891284">.</span><span class="ident" id="5891285">Pos</span><span class="op" id="5891288">(</span><span class="op" id="5891289">)</span><span class="op" id="5891290">,</span>&nbsp;<span class="ident" id="5891292">s</span><span class="op" id="5891293">.</span><span class="ident" id="5891294">Results</span><span class="op" id="5891301">,</span>&nbsp;<span class="num" id="5891303">1</span><span class="op" id="5891304">,</span>&nbsp;<span class="num" id="5891306">0</span><span class="op" id="5891307">,</span>&nbsp;<span class="ident" id="5891309">token</span><span class="op" id="5891314">.</span><span class="ident" id="5891315">NoPos</span><span class="op" id="5891320">)</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5891325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5891329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891333">case</span>&nbsp;<span class="op" id="5891338">*</span><span class="ident" id="5891339">ast</span><span class="op" id="5891342">.</span><span class="ident" id="5891343">BranchStmt</span><span class="op" id="5891353">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891357">p</span><span class="op" id="5891358">.</span><span class="builtinfunc" id="5891359">print</span><span class="op" id="5891364">(</span><span class="ident" id="5891365">s</span><span class="op" id="5891366">.</span><span class="ident" id="5891367">Tok</span><span class="op" id="5891370">)</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891374">if</span>&nbsp;<span class="ident" id="5891377">s</span><span class="op" id="5891378">.</span><span class="ident" id="5891379">Label</span>&nbsp;<span class="op" id="5891385">!=</span>&nbsp;<span class="ident" id="5891388">nil</span>&nbsp;<span class="op" id="5891392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891397">p</span><span class="op" id="5891398">.</span><span class="builtinfunc" id="5891399">print</span><span class="op" id="5891404">(</span><span class="ident" id="5891405">blank</span><span class="op" id="5891410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891415">p</span><span class="op" id="5891416">.</span><span class="ident" id="5891417">expr</span><span class="op" id="5891421">(</span><span class="ident" id="5891422">s</span><span class="op" id="5891423">.</span><span class="ident" id="5891424">Label</span><span class="op" id="5891429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5891433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891437">case</span>&nbsp;<span class="op" id="5891442">*</span><span class="ident" id="5891443">ast</span><span class="op" id="5891446">.</span><span class="ident" id="5891447">BlockStmt</span><span class="op" id="5891456">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891460">p</span><span class="op" id="5891461">.</span><span class="ident" id="5891462">block</span><span class="op" id="5891467">(</span><span class="ident" id="5891468">s</span><span class="op" id="5891469">,</span>&nbsp;<span class="num" id="5891471">1</span><span class="op" id="5891472">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891476">case</span>&nbsp;<span class="op" id="5891481">*</span><span class="ident" id="5891482">ast</span><span class="op" id="5891485">.</span><span class="ident" id="5891486">IfStmt</span><span class="op" id="5891492">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891496">p</span><span class="op" id="5891497">.</span><span class="builtinfunc" id="5891498">print</span><span class="op" id="5891503">(</span><span class="ident" id="5891504">token</span><span class="op" id="5891509">.</span><span class="ident" id="5891510">IF</span><span class="op" id="5891512">)</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891516">p</span><span class="op" id="5891517">.</span><span class="ident" id="5891518">controlClause</span><span class="op" id="5891531">(</span><span class="builtintype" id="5891532">false</span><span class="op" id="5891537">,</span>&nbsp;<span class="ident" id="5891539">s</span><span class="op" id="5891540">.</span><span class="ident" id="5891541">Init</span><span class="op" id="5891545">,</span>&nbsp;<span class="ident" id="5891547">s</span><span class="op" id="5891548">.</span><span class="ident" id="5891549">Cond</span><span class="op" id="5891553">,</span>&nbsp;<span class="ident" id="5891555">nil</span><span class="op" id="5891558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891562">p</span><span class="op" id="5891563">.</span><span class="ident" id="5891564">block</span><span class="op" id="5891569">(</span><span class="ident" id="5891570">s</span><span class="op" id="5891571">.</span><span class="ident" id="5891572">Body</span><span class="op" id="5891576">,</span>&nbsp;<span class="num" id="5891578">1</span><span class="op" id="5891579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891583">if</span>&nbsp;<span class="ident" id="5891586">s</span><span class="op" id="5891587">.</span><span class="ident" id="5891588">Else</span>&nbsp;<span class="op" id="5891593">!=</span>&nbsp;<span class="ident" id="5891596">nil</span>&nbsp;<span class="op" id="5891600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891605">p</span><span class="op" id="5891606">.</span><span class="builtinfunc" id="5891607">print</span><span class="op" id="5891612">(</span><span class="ident" id="5891613">blank</span><span class="op" id="5891618">,</span>&nbsp;<span class="ident" id="5891620">token</span><span class="op" id="5891625">.</span><span class="ident" id="5891626">ELSE</span><span class="op" id="5891630">,</span>&nbsp;<span class="ident" id="5891632">blank</span><span class="op" id="5891637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891642">switch</span>&nbsp;<span class="ident" id="5891649">s</span><span class="op" id="5891650">.</span><span class="ident" id="5891651">Else</span><span class="op" id="5891655">.</span><span class="op" id="5891656">(</span><span class="keyword" id="5891657">type</span><span class="op" id="5891661">)</span>&nbsp;<span class="op" id="5891663">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891668">case</span>&nbsp;<span class="op" id="5891673">*</span><span class="ident" id="5891674">ast</span><span class="op" id="5891677">.</span><span class="ident" id="5891678">BlockStmt</span><span class="op" id="5891687">,</span>&nbsp;<span class="op" id="5891689">*</span><span class="ident" id="5891690">ast</span><span class="op" id="5891693">.</span><span class="ident" id="5891694">IfStmt</span><span class="op" id="5891700">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891706">p</span><span class="op" id="5891707">.</span><span class="ident" id="5891708">stmt</span><span class="op" id="5891712">(</span><span class="ident" id="5891713">s</span><span class="op" id="5891714">.</span><span class="ident" id="5891715">Else</span><span class="op" id="5891719">,</span>&nbsp;<span class="ident" id="5891721">nextIsRBrace</span><span class="op" id="5891733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891738">default</span><span class="op" id="5891745">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891751">p</span><span class="op" id="5891752">.</span><span class="builtinfunc" id="5891753">print</span><span class="op" id="5891758">(</span><span class="ident" id="5891759">token</span><span class="op" id="5891764">.</span><span class="ident" id="5891765">LBRACE</span><span class="op" id="5891771">,</span>&nbsp;<span class="ident" id="5891773">indent</span><span class="op" id="5891779">,</span>&nbsp;<span class="ident" id="5891781">formfeed</span><span class="op" id="5891789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891795">p</span><span class="op" id="5891796">.</span><span class="ident" id="5891797">stmt</span><span class="op" id="5891801">(</span><span class="ident" id="5891802">s</span><span class="op" id="5891803">.</span><span class="ident" id="5891804">Else</span><span class="op" id="5891808">,</span>&nbsp;<span class="builtintype" id="5891810">true</span><span class="op" id="5891814">)</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891820">p</span><span class="op" id="5891821">.</span><span class="builtinfunc" id="5891822">print</span><span class="op" id="5891827">(</span><span class="ident" id="5891828">unindent</span><span class="op" id="5891836">,</span>&nbsp;<span class="ident" id="5891838">formfeed</span><span class="op" id="5891846">,</span>&nbsp;<span class="ident" id="5891848">token</span><span class="op" id="5891853">.</span><span class="ident" id="5891854">RBRACE</span><span class="op" id="5891860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5891865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5891869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891873">case</span>&nbsp;<span class="op" id="5891878">*</span><span class="ident" id="5891879">ast</span><span class="op" id="5891882">.</span><span class="ident" id="5891883">CaseClause</span><span class="op" id="5891893">:</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5891897">if</span>&nbsp;<span class="ident" id="5891900">s</span><span class="op" id="5891901">.</span><span class="ident" id="5891902">List</span>&nbsp;<span class="op" id="5891907">!=</span>&nbsp;<span class="ident" id="5891910">nil</span>&nbsp;<span class="op" id="5891914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891919">p</span><span class="op" id="5891920">.</span><span class="builtinfunc" id="5891921">print</span><span class="op" id="5891926">(</span><span class="ident" id="5891927">token</span><span class="op" id="5891932">.</span><span class="ident" id="5891933">CASE</span><span class="op" id="5891937">,</span>&nbsp;<span class="ident" id="5891939">blank</span><span class="op" id="5891944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5891949">p</span><span class="op" id="5891950">.</span><span class="ident" id="5891951">exprList</span><span class="op" id="5891959">(</span><span class="ident" id="5891960">s</span><span class="op" id="5891961">.</span><span class="ident" id="5891962">Pos</span><span class="op" id="5891965">(</span><span class="op" id="5891966">)</span><span class="op" id="5891967">,</span>&nbsp;<span class="ident" id="5891969">s</span><span class="op" id="5891970">.</span><span class="ident" id="5891971">List</span><span class="op" id="5891975">,</span>&nbsp;<span class="num" id="5891977">1</span><span class="op" id="5891978">,</span>&nbsp;<span class="num" id="5891980">0</span><span class="op" id="5891981">,</span>&nbsp;<span class="ident" id="5891983">s</span><span class="op" id="5891984">.</span><span class="ident" id="5891985">Colon</span><span class="op" id="5891990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5891994">}</span>&nbsp;<span class="keyword" id="5891996">else</span>&nbsp;<span class="op" id="5892001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892006">p</span><span class="op" id="5892007">.</span><span class="builtinfunc" id="5892008">print</span><span class="op" id="5892013">(</span><span class="ident" id="5892014">token</span><span class="op" id="5892019">.</span><span class="ident" id="5892020">DEFAULT</span><span class="op" id="5892027">)</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5892031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892035">p</span><span class="op" id="5892036">.</span><span class="builtinfunc" id="5892037">print</span><span class="op" id="5892042">(</span><span class="ident" id="5892043">s</span><span class="op" id="5892044">.</span><span class="ident" id="5892045">Colon</span><span class="op" id="5892050">,</span>&nbsp;<span class="ident" id="5892052">token</span><span class="op" id="5892057">.</span><span class="ident" id="5892058">COLON</span><span class="op" id="5892063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892067">p</span><span class="op" id="5892068">.</span><span class="ident" id="5892069">stmtList</span><span class="op" id="5892077">(</span><span class="ident" id="5892078">s</span><span class="op" id="5892079">.</span><span class="ident" id="5892080">Body</span><span class="op" id="5892084">,</span>&nbsp;<span class="num" id="5892086">1</span><span class="op" id="5892087">,</span>&nbsp;<span class="ident" id="5892089">nextIsRBrace</span><span class="op" id="5892101">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5892105">case</span>&nbsp;<span class="op" id="5892110">*</span><span class="ident" id="5892111">ast</span><span class="op" id="5892114">.</span><span class="ident" id="5892115">SwitchStmt</span><span class="op" id="5892125">:</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892129">p</span><span class="op" id="5892130">.</span><span class="builtinfunc" id="5892131">print</span><span class="op" id="5892136">(</span><span class="ident" id="5892137">token</span><span class="op" id="5892142">.</span><span class="ident" id="5892143">SWITCH</span><span class="op" id="5892149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892153">p</span><span class="op" id="5892154">.</span><span class="ident" id="5892155">controlClause</span><span class="op" id="5892168">(</span><span class="builtintype" id="5892169">false</span><span class="op" id="5892174">,</span>&nbsp;<span class="ident" id="5892176">s</span><span class="op" id="5892177">.</span><span class="ident" id="5892178">Init</span><span class="op" id="5892182">,</span>&nbsp;<span class="ident" id="5892184">s</span><span class="op" id="5892185">.</span><span class="ident" id="5892186">Tag</span><span class="op" id="5892189">,</span>&nbsp;<span class="ident" id="5892191">nil</span><span class="op" id="5892194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892198">p</span><span class="op" id="5892199">.</span><span class="ident" id="5892200">block</span><span class="op" id="5892205">(</span><span class="ident" id="5892206">s</span><span class="op" id="5892207">.</span><span class="ident" id="5892208">Body</span><span class="op" id="5892212">,</span>&nbsp;<span class="num" id="5892214">0</span><span class="op" id="5892215">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5892219">case</span>&nbsp;<span class="op" id="5892224">*</span><span class="ident" id="5892225">ast</span><span class="op" id="5892228">.</span><span class="ident" id="5892229">TypeSwitchStmt</span><span class="op" id="5892243">:</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892247">p</span><span class="op" id="5892248">.</span><span class="builtinfunc" id="5892249">print</span><span class="op" id="5892254">(</span><span class="ident" id="5892255">token</span><span class="op" id="5892260">.</span><span class="ident" id="5892261">SWITCH</span><span class="op" id="5892267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5892271">if</span>&nbsp;<span class="ident" id="5892274">s</span><span class="op" id="5892275">.</span><span class="ident" id="5892276">Init</span>&nbsp;<span class="op" id="5892281">!=</span>&nbsp;<span class="ident" id="5892284">nil</span>&nbsp;<span class="op" id="5892288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892293">p</span><span class="op" id="5892294">.</span><span class="builtinfunc" id="5892295">print</span><span class="op" id="5892300">(</span><span class="ident" id="5892301">blank</span><span class="op" id="5892306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892311">p</span><span class="op" id="5892312">.</span><span class="ident" id="5892313">stmt</span><span class="op" id="5892317">(</span><span class="ident" id="5892318">s</span><span class="op" id="5892319">.</span><span class="ident" id="5892320">Init</span><span class="op" id="5892324">,</span>&nbsp;<span class="builtintype" id="5892326">false</span><span class="op" id="5892331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892336">p</span><span class="op" id="5892337">.</span><span class="builtinfunc" id="5892338">print</span><span class="op" id="5892343">(</span><span class="ident" id="5892344">token</span><span class="op" id="5892349">.</span><span class="ident" id="5892350">SEMICOLON</span><span class="op" id="5892359">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5892363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892367">p</span><span class="op" id="5892368">.</span><span class="builtinfunc" id="5892369">print</span><span class="op" id="5892374">(</span><span class="ident" id="5892375">blank</span><span class="op" id="5892380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892384">p</span><span class="op" id="5892385">.</span><span class="ident" id="5892386">stmt</span><span class="op" id="5892390">(</span><span class="ident" id="5892391">s</span><span class="op" id="5892392">.</span><span class="ident" id="5892393">Assign</span><span class="op" id="5892399">,</span>&nbsp;<span class="builtintype" id="5892401">false</span><span class="op" id="5892406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892410">p</span><span class="op" id="5892411">.</span><span class="builtinfunc" id="5892412">print</span><span class="op" id="5892417">(</span><span class="ident" id="5892418">blank</span><span class="op" id="5892423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892427">p</span><span class="op" id="5892428">.</span><span class="ident" id="5892429">block</span><span class="op" id="5892434">(</span><span class="ident" id="5892435">s</span><span class="op" id="5892436">.</span><span class="ident" id="5892437">Body</span><span class="op" id="5892441">,</span>&nbsp;<span class="num" id="5892443">0</span><span class="op" id="5892444">)</span><br>
<span class="lineno">1195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5892448">case</span>&nbsp;<span class="op" id="5892453">*</span><span class="ident" id="5892454">ast</span><span class="op" id="5892457">.</span><span class="ident" id="5892458">CommClause</span><span class="op" id="5892468">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5892472">if</span>&nbsp;<span class="ident" id="5892475">s</span><span class="op" id="5892476">.</span><span class="ident" id="5892477">Comm</span>&nbsp;<span class="op" id="5892482">!=</span>&nbsp;<span class="ident" id="5892485">nil</span>&nbsp;<span class="op" id="5892489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892494">p</span><span class="op" id="5892495">.</span><span class="builtinfunc" id="5892496">print</span><span class="op" id="5892501">(</span><span class="ident" id="5892502">token</span><span class="op" id="5892507">.</span><span class="ident" id="5892508">CASE</span><span class="op" id="5892512">,</span>&nbsp;<span class="ident" id="5892514">blank</span><span class="op" id="5892519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892524">p</span><span class="op" id="5892525">.</span><span class="ident" id="5892526">stmt</span><span class="op" id="5892530">(</span><span class="ident" id="5892531">s</span><span class="op" id="5892532">.</span><span class="ident" id="5892533">Comm</span><span class="op" id="5892537">,</span>&nbsp;<span class="builtintype" id="5892539">false</span><span class="op" id="5892544">)</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5892548">}</span>&nbsp;<span class="keyword" id="5892550">else</span>&nbsp;<span class="op" id="5892555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892560">p</span><span class="op" id="5892561">.</span><span class="builtinfunc" id="5892562">print</span><span class="op" id="5892567">(</span><span class="ident" id="5892568">token</span><span class="op" id="5892573">.</span><span class="ident" id="5892574">DEFAULT</span><span class="op" id="5892581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5892585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892589">p</span><span class="op" id="5892590">.</span><span class="builtinfunc" id="5892591">print</span><span class="op" id="5892596">(</span><span class="ident" id="5892597">s</span><span class="op" id="5892598">.</span><span class="ident" id="5892599">Colon</span><span class="op" id="5892604">,</span>&nbsp;<span class="ident" id="5892606">token</span><span class="op" id="5892611">.</span><span class="ident" id="5892612">COLON</span><span class="op" id="5892617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892621">p</span><span class="op" id="5892622">.</span><span class="ident" id="5892623">stmtList</span><span class="op" id="5892631">(</span><span class="ident" id="5892632">s</span><span class="op" id="5892633">.</span><span class="ident" id="5892634">Body</span><span class="op" id="5892638">,</span>&nbsp;<span class="num" id="5892640">1</span><span class="op" id="5892641">,</span>&nbsp;<span class="ident" id="5892643">nextIsRBrace</span><span class="op" id="5892655">)</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5892659">case</span>&nbsp;<span class="op" id="5892664">*</span><span class="ident" id="5892665">ast</span><span class="op" id="5892668">.</span><span class="ident" id="5892669">SelectStmt</span><span class="op" id="5892679">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892683">p</span><span class="op" id="5892684">.</span><span class="builtinfunc" id="5892685">print</span><span class="op" id="5892690">(</span><span class="ident" id="5892691">token</span><span class="op" id="5892696">.</span><span class="ident" id="5892697">SELECT</span><span class="op" id="5892703">,</span>&nbsp;<span class="ident" id="5892705">blank</span><span class="op" id="5892710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892714">body</span>&nbsp;<span class="op" id="5892719">:=</span>&nbsp;<span class="ident" id="5892722">s</span><span class="op" id="5892723">.</span><span class="ident" id="5892724">Body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5892731">if</span>&nbsp;<span class="builtinfunc" id="5892734">len</span><span class="op" id="5892737">(</span><span class="ident" id="5892738">body</span><span class="op" id="5892742">.</span><span class="ident" id="5892743">List</span><span class="op" id="5892747">)</span>&nbsp;<span class="op" id="5892749">==</span>&nbsp;<span class="num" id="5892752">0</span>&nbsp;<span class="op" id="5892754">&amp;&amp;</span>&nbsp;<span class="op" id="5892757">!</span><span class="ident" id="5892758">p</span><span class="op" id="5892759">.</span><span class="ident" id="5892760">commentBefore</span><span class="op" id="5892773">(</span><span class="ident" id="5892774">p</span><span class="op" id="5892775">.</span><span class="ident" id="5892776">posFor</span><span class="op" id="5892782">(</span><span class="ident" id="5892783">body</span><span class="op" id="5892787">.</span><span class="ident" id="5892788">Rbrace</span><span class="op" id="5892794">)</span><span class="op" id="5892795">)</span>&nbsp;<span class="op" id="5892797">{</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5892802">//&nbsp;print&nbsp;empty&nbsp;select&nbsp;statement&nbsp;w/o&nbsp;comments&nbsp;on&nbsp;one&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892862">p</span><span class="op" id="5892863">.</span><span class="builtinfunc" id="5892864">print</span><span class="op" id="5892869">(</span><span class="ident" id="5892870">body</span><span class="op" id="5892874">.</span><span class="ident" id="5892875">Lbrace</span><span class="op" id="5892881">,</span>&nbsp;<span class="ident" id="5892883">token</span><span class="op" id="5892888">.</span><span class="ident" id="5892889">LBRACE</span><span class="op" id="5892895">,</span>&nbsp;<span class="ident" id="5892897">body</span><span class="op" id="5892901">.</span><span class="ident" id="5892902">Rbrace</span><span class="op" id="5892908">,</span>&nbsp;<span class="ident" id="5892910">token</span><span class="op" id="5892915">.</span><span class="ident" id="5892916">RBRACE</span><span class="op" id="5892922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5892926">}</span>&nbsp;<span class="keyword" id="5892928">else</span>&nbsp;<span class="op" id="5892933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892938">p</span><span class="op" id="5892939">.</span><span class="ident" id="5892940">block</span><span class="op" id="5892945">(</span><span class="ident" id="5892946">body</span><span class="op" id="5892950">,</span>&nbsp;<span class="num" id="5892952">0</span><span class="op" id="5892953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5892957">}</span><br>
<span class="lineno">1215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5892961">case</span>&nbsp;<span class="op" id="5892966">*</span><span class="ident" id="5892967">ast</span><span class="op" id="5892970">.</span><span class="ident" id="5892971">ForStmt</span><span class="op" id="5892978">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5892982">p</span><span class="op" id="5892983">.</span><span class="builtinfunc" id="5892984">print</span><span class="op" id="5892989">(</span><span class="ident" id="5892990">token</span><span class="op" id="5892995">.</span><span class="ident" id="5892996">FOR</span><span class="op" id="5892999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893003">p</span><span class="op" id="5893004">.</span><span class="ident" id="5893005">controlClause</span><span class="op" id="5893018">(</span><span class="builtintype" id="5893019">true</span><span class="op" id="5893023">,</span>&nbsp;<span class="ident" id="5893025">s</span><span class="op" id="5893026">.</span><span class="ident" id="5893027">Init</span><span class="op" id="5893031">,</span>&nbsp;<span class="ident" id="5893033">s</span><span class="op" id="5893034">.</span><span class="ident" id="5893035">Cond</span><span class="op" id="5893039">,</span>&nbsp;<span class="ident" id="5893041">s</span><span class="op" id="5893042">.</span><span class="ident" id="5893043">Post</span><span class="op" id="5893047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893051">p</span><span class="op" id="5893052">.</span><span class="ident" id="5893053">block</span><span class="op" id="5893058">(</span><span class="ident" id="5893059">s</span><span class="op" id="5893060">.</span><span class="ident" id="5893061">Body</span><span class="op" id="5893065">,</span>&nbsp;<span class="num" id="5893067">1</span><span class="op" id="5893068">)</span><br>
<span class="lineno">1220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5893072">case</span>&nbsp;<span class="op" id="5893077">*</span><span class="ident" id="5893078">ast</span><span class="op" id="5893081">.</span><span class="ident" id="5893082">RangeStmt</span><span class="op" id="5893091">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893095">p</span><span class="op" id="5893096">.</span><span class="builtinfunc" id="5893097">print</span><span class="op" id="5893102">(</span><span class="ident" id="5893103">token</span><span class="op" id="5893108">.</span><span class="ident" id="5893109">FOR</span><span class="op" id="5893112">,</span>&nbsp;<span class="ident" id="5893114">blank</span><span class="op" id="5893119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5893123">if</span>&nbsp;<span class="ident" id="5893126">s</span><span class="op" id="5893127">.</span><span class="ident" id="5893128">Key</span>&nbsp;<span class="op" id="5893132">!=</span>&nbsp;<span class="ident" id="5893135">nil</span>&nbsp;<span class="op" id="5893139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893144">p</span><span class="op" id="5893145">.</span><span class="ident" id="5893146">expr</span><span class="op" id="5893150">(</span><span class="ident" id="5893151">s</span><span class="op" id="5893152">.</span><span class="ident" id="5893153">Key</span><span class="op" id="5893156">)</span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5893161">if</span>&nbsp;<span class="ident" id="5893164">s</span><span class="op" id="5893165">.</span><span class="ident" id="5893166">Value</span>&nbsp;<span class="op" id="5893172">!=</span>&nbsp;<span class="ident" id="5893175">nil</span>&nbsp;<span class="op" id="5893179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5893185">//&nbsp;use&nbsp;position&nbsp;of&nbsp;value&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5893237">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893289">p</span><span class="op" id="5893290">.</span><span class="builtinfunc" id="5893291">print</span><span class="op" id="5893296">(</span><span class="ident" id="5893297">s</span><span class="op" id="5893298">.</span><span class="ident" id="5893299">Value</span><span class="op" id="5893304">.</span><span class="ident" id="5893305">Pos</span><span class="op" id="5893308">(</span><span class="op" id="5893309">)</span><span class="op" id="5893310">,</span>&nbsp;<span class="ident" id="5893312">token</span><span class="op" id="5893317">.</span><span class="ident" id="5893318">COMMA</span><span class="op" id="5893323">,</span>&nbsp;<span class="ident" id="5893325">blank</span><span class="op" id="5893330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893336">p</span><span class="op" id="5893337">.</span><span class="ident" id="5893338">expr</span><span class="op" id="5893342">(</span><span class="ident" id="5893343">s</span><span class="op" id="5893344">.</span><span class="ident" id="5893345">Value</span><span class="op" id="5893350">)</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5893355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893360">p</span><span class="op" id="5893361">.</span><span class="builtinfunc" id="5893362">print</span><span class="op" id="5893367">(</span><span class="ident" id="5893368">blank</span><span class="op" id="5893373">,</span>&nbsp;<span class="ident" id="5893375">s</span><span class="op" id="5893376">.</span><span class="ident" id="5893377">TokPos</span><span class="op" id="5893383">,</span>&nbsp;<span class="ident" id="5893385">s</span><span class="op" id="5893386">.</span><span class="ident" id="5893387">Tok</span><span class="op" id="5893390">,</span>&nbsp;<span class="ident" id="5893392">blank</span><span class="op" id="5893397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5893401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893405">p</span><span class="op" id="5893406">.</span><span class="builtinfunc" id="5893407">print</span><span class="op" id="5893412">(</span><span class="ident" id="5893413">token</span><span class="op" id="5893418">.</span><span class="ident" id="5893419">RANGE</span><span class="op" id="5893424">,</span>&nbsp;<span class="ident" id="5893426">blank</span><span class="op" id="5893431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893435">p</span><span class="op" id="5893436">.</span><span class="ident" id="5893437">expr</span><span class="op" id="5893441">(</span><span class="ident" id="5893442">stripParens</span><span class="op" id="5893453">(</span><span class="ident" id="5893454">s</span><span class="op" id="5893455">.</span><span class="ident" id="5893456">X</span><span class="op" id="5893457">)</span><span class="op" id="5893458">)</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893462">p</span><span class="op" id="5893463">.</span><span class="builtinfunc" id="5893464">print</span><span class="op" id="5893469">(</span><span class="ident" id="5893470">blank</span><span class="op" id="5893475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5893479">p</span><span class="op" id="5893480">.</span><span class="ident" id="5893481">block</span><span class="op" id="5893486">(</span><span class="ident" id="5893487">s</span><span class="op" id="5893488">.</span><span class="ident" id="5893489">Body</span><span class="op" id="5893493">,</span>&nbsp;<span class="num" id="5893495">1</span><span class="op" id="5893496">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5893500">default</span><span class="op" id="5893507">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5893511">panic</span><span class="op" id="5893516">(</span><span class="string" id="5893517">&#34;unreachable&#34;</span><span class="op" id="5893530">)</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5893533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5893537">return</span><br>
<span class="lineno"></span><span class="op" id="5893544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1245</span><span class="comment" id="5893547">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5893627">//&nbsp;Declarations</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5893644">//&nbsp;The&nbsp;keepTypeColumn&nbsp;function&nbsp;determines&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;of&nbsp;a&nbsp;series&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5893720">//&nbsp;consecutive&nbsp;const&nbsp;or&nbsp;var&nbsp;declarations&nbsp;must&nbsp;be&nbsp;kept,&nbsp;or&nbsp;if&nbsp;initialization</span><br>
<span class="lineno">1250</span><span class="comment" id="5893796">//&nbsp;values&nbsp;(V)&nbsp;can&nbsp;be&nbsp;placed&nbsp;in&nbsp;the&nbsp;type&nbsp;column&nbsp;(T)&nbsp;instead.&nbsp;The&nbsp;i&#39;th&nbsp;entry</span><br>
<span class="lineno"></span><span class="comment" id="5893871">//&nbsp;in&nbsp;the&nbsp;result&nbsp;slice&nbsp;is&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;in&nbsp;spec[i]&nbsp;must&nbsp;be&nbsp;kept.</span><br>
<span class="lineno"></span><span class="comment" id="5893946">//</span><br>
<span class="lineno"></span><span class="comment" id="5893949">//&nbsp;For&nbsp;example,&nbsp;the&nbsp;declaration:</span><br>
<span class="lineno"></span><span class="comment" id="5893982">//</span><br>
<span class="lineno">1255</span><span class="comment" id="5893985">//&nbsp;&nbsp;&nbsp;&nbspconst&nbsp;(</span><br>
<span class="lineno"></span><span class="comment" id="5893996">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspfoobar&nbsp;int&nbsp;=&nbsp;42&nbsp;//&nbsp;comment</span><br>
<span class="lineno"></span><span class="comment" id="5894027">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7&nbsp;&nbsp;//&nbsp;comment</span><br>
<span class="lineno"></span><span class="comment" id="5894058">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspfoo</span><br>
<span class="lineno"></span><span class="comment" id="5894066">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bar&nbsp;=&nbsp;991</span><br>
<span class="lineno">1260</span><span class="comment" id="5894092">//&nbsp;&nbsp;&nbsp;&nbsp)</span><br>
<span class="lineno"></span><span class="comment" id="5894097">//</span><br>
<span class="lineno"></span><span class="comment" id="5894100">//&nbsp;leads&nbsp;to&nbsp;the&nbsp;type/values&nbsp;matrix&nbsp;below.&nbsp;A&nbsp;run&nbsp;of&nbsp;value&nbsp;columns&nbsp;(V)&nbsp;can</span><br>
<span class="lineno"></span><span class="comment" id="5894173">//&nbsp;be&nbsp;moved&nbsp;into&nbsp;the&nbsp;type&nbsp;column&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;type&nbsp;for&nbsp;any&nbsp;of&nbsp;the&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="5894248">//&nbsp;in&nbsp;that&nbsp;column&nbsp;(we&nbsp;only&nbsp;move&nbsp;entire&nbsp;columns&nbsp;so&nbsp;that&nbsp;they&nbsp;align&nbsp;properly).</span><br>
<span class="lineno">1265</span><span class="comment" id="5894325">//</span><br>
<span class="lineno"></span><span class="comment" id="5894328">//&nbsp;&nbsp;&nbsp;&nbspmatrix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatted&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result</span><br>
<span class="lineno"></span><span class="comment" id="5894366">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matrix</span><br>
<span class="lineno"></span><span class="comment" id="5894395">//&nbsp;&nbsp;&nbsp;&nbspT&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;&nbsp;&nbsp;true&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;there&nbsp;is&nbsp;a&nbsp;T&nbsp;and&nbsp;so&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="5894465">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;true&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column&nbsp;must&nbsp;be&nbsp;kept</span><br>
<span class="lineno">1270</span><span class="comment" id="5894526">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false</span><br>
<span class="lineno"></span><span class="comment" id="5894563">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;is&nbsp;moved&nbsp;into&nbsp;T&nbsp;column</span><br>
<span class="lineno"></span><span class="comment" id="5894629">//</span><br>
<span class="lineno"></span><span class="keyword" id="5894632">func</span>&nbsp;<span class="ident" id="5894637">keepTypeColumn</span><span class="op" id="5894651">(</span><span class="ident" id="5894652">specs</span>&nbsp;<span class="op" id="5894658">[</span><span class="op" id="5894659">]</span><span class="ident" id="5894660">ast</span><span class="op" id="5894663">.</span><span class="ident" id="5894664">Spec</span><span class="op" id="5894668">)</span>&nbsp;<span class="op" id="5894670">[</span><span class="op" id="5894671">]</span><span class="builtintype" id="5894672">bool</span>&nbsp;<span class="op" id="5894677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5894680">m</span>&nbsp;<span class="op" id="5894682">:=</span>&nbsp;<span class="builtinfunc" id="5894685">make</span><span class="op" id="5894689">(</span><span class="op" id="5894690">[</span><span class="op" id="5894691">]</span><span class="builtintype" id="5894692">bool</span><span class="op" id="5894696">,</span>&nbsp;<span class="builtinfunc" id="5894698">len</span><span class="op" id="5894701">(</span><span class="ident" id="5894702">specs</span><span class="op" id="5894707">)</span><span class="op" id="5894708">)</span><br>
<span class="lineno">1275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5894712">populate</span>&nbsp;<span class="op" id="5894721">:=</span>&nbsp;<span class="keyword" id="5894724">func</span><span class="op" id="5894728">(</span><span class="ident" id="5894729">i</span><span class="op" id="5894730">,</span>&nbsp;<span class="ident" id="5894732">j</span>&nbsp;<span class="builtintype" id="5894734">int</span><span class="op" id="5894737">,</span>&nbsp;<span class="ident" id="5894739">keepType</span>&nbsp;<span class="builtintype" id="5894748">bool</span><span class="op" id="5894752">)</span>&nbsp;<span class="op" id="5894754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5894758">if</span>&nbsp;<span class="ident" id="5894761">keepType</span>&nbsp;<span class="op" id="5894770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5894775">for</span>&nbsp;<span class="op" id="5894779">;</span>&nbsp;<span class="ident" id="5894781">i</span>&nbsp;<span class="op" id="5894783">&lt;</span>&nbsp;<span class="ident" id="5894785">j</span><span class="op" id="5894786">;</span>&nbsp;<span class="ident" id="5894788">i</span><span class="op" id="5894789">++</span>&nbsp;<span class="op" id="5894792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5894798">m</span><span class="op" id="5894799">[</span><span class="ident" id="5894800">i</span><span class="op" id="5894801">]</span>&nbsp;<span class="op" id="5894803">=</span>&nbsp;<span class="builtintype" id="5894805">true</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5894813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5894817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5894820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5894824">i0</span>&nbsp;<span class="op" id="5894827">:=</span>&nbsp;<span class="op" id="5894830">-</span><span class="num" id="5894831">1</span>&nbsp;<span class="comment" id="5894833">//&nbsp;if&nbsp;i0&nbsp;&gt;=&nbsp;0&nbsp;we&nbsp;are&nbsp;in&nbsp;a&nbsp;run&nbsp;and&nbsp;i0&nbsp;is&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;run</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5894895">var</span>&nbsp;<span class="ident" id="5894899">keepType</span>&nbsp;<span class="builtintype" id="5894908">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5894914">for</span>&nbsp;<span class="ident" id="5894918">i</span><span class="op" id="5894919">,</span>&nbsp;<span class="ident" id="5894921">s</span>&nbsp;<span class="op" id="5894923">:=</span>&nbsp;<span class="keyword" id="5894926">range</span>&nbsp;<span class="ident" id="5894932">specs</span>&nbsp;<span class="op" id="5894938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5894942">t</span>&nbsp;<span class="op" id="5894944">:=</span>&nbsp;<span class="ident" id="5894947">s</span><span class="op" id="5894948">.</span><span class="op" id="5894949">(</span><span class="op" id="5894950">*</span><span class="ident" id="5894951">ast</span><span class="op" id="5894954">.</span><span class="ident" id="5894955">ValueSpec</span><span class="op" id="5894964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5894968">if</span>&nbsp;<span class="ident" id="5894971">t</span><span class="op" id="5894972">.</span><span class="ident" id="5894973">Values</span>&nbsp;<span class="op" id="5894980">!=</span>&nbsp;<span class="ident" id="5894983">nil</span>&nbsp;<span class="op" id="5894987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5894992">if</span>&nbsp;<span class="ident" id="5894995">i0</span>&nbsp;<span class="op" id="5894998">&lt;</span>&nbsp;<span class="num" id="5895000">0</span>&nbsp;<span class="op" id="5895002">{</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5895008">//&nbsp;start&nbsp;of&nbsp;a&nbsp;run&nbsp;of&nbsp;ValueSpecs&nbsp;with&nbsp;non-nil&nbsp;Values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895064">i0</span>&nbsp;<span class="op" id="5895067">=</span>&nbsp;<span class="ident" id="5895069">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895075">keepType</span>&nbsp;<span class="op" id="5895084">=</span>&nbsp;<span class="builtintype" id="5895086">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5895095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5895099">}</span>&nbsp;<span class="keyword" id="5895101">else</span>&nbsp;<span class="op" id="5895106">{</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5895111">if</span>&nbsp;<span class="ident" id="5895114">i0</span>&nbsp;<span class="op" id="5895117">&gt;=</span>&nbsp;<span class="num" id="5895120">0</span>&nbsp;<span class="op" id="5895122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5895128">//&nbsp;end&nbsp;of&nbsp;a&nbsp;run</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895148">populate</span><span class="op" id="5895156">(</span><span class="ident" id="5895157">i0</span><span class="op" id="5895159">,</span>&nbsp;<span class="ident" id="5895161">i</span><span class="op" id="5895162">,</span>&nbsp;<span class="ident" id="5895164">keepType</span><span class="op" id="5895172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895178">i0</span>&nbsp;<span class="op" id="5895181">=</span>&nbsp;<span class="op" id="5895183">-</span><span class="num" id="5895184">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5895189">}</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5895193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5895197">if</span>&nbsp;<span class="ident" id="5895200">t</span><span class="op" id="5895201">.</span><span class="ident" id="5895202">Type</span>&nbsp;<span class="op" id="5895207">!=</span>&nbsp;<span class="ident" id="5895210">nil</span>&nbsp;<span class="op" id="5895214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895219">keepType</span>&nbsp;<span class="op" id="5895228">=</span>&nbsp;<span class="builtintype" id="5895230">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5895237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5895240">}</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5895243">if</span>&nbsp;<span class="ident" id="5895246">i0</span>&nbsp;<span class="op" id="5895249">&gt;=</span>&nbsp;<span class="num" id="5895252">0</span>&nbsp;<span class="op" id="5895254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5895258">//&nbsp;end&nbsp;of&nbsp;a&nbsp;run</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895276">populate</span><span class="op" id="5895284">(</span><span class="ident" id="5895285">i0</span><span class="op" id="5895287">,</span>&nbsp;<span class="builtinfunc" id="5895289">len</span><span class="op" id="5895292">(</span><span class="ident" id="5895293">specs</span><span class="op" id="5895298">)</span><span class="op" id="5895299">,</span>&nbsp;<span class="ident" id="5895301">keepType</span><span class="op" id="5895309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5895312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5895316">return</span>&nbsp;<span class="ident" id="5895323">m</span><br>
<span class="lineno"></span><span class="op" id="5895325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5895328">func</span>&nbsp;<span class="op" id="5895333">(</span><span class="ident" id="5895334">p</span>&nbsp;<span class="op" id="5895336">*</span><span class="ident" id="5895337">printer</span><span class="op" id="5895344">)</span>&nbsp;<span class="ident" id="5895346">valueSpec</span><span class="op" id="5895355">(</span><span class="ident" id="5895356">s</span>&nbsp;<span class="op" id="5895358">*</span><span class="ident" id="5895359">ast</span><span class="op" id="5895362">.</span><span class="ident" id="5895363">ValueSpec</span><span class="op" id="5895372">,</span>&nbsp;<span class="ident" id="5895374">keepType</span>&nbsp;<span class="builtintype" id="5895383">bool</span><span class="op" id="5895387">)</span>&nbsp;<span class="op" id="5895389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895392">p</span><span class="op" id="5895393">.</span><span class="ident" id="5895394">setComment</span><span class="op" id="5895404">(</span><span class="ident" id="5895405">s</span><span class="op" id="5895406">.</span><span class="ident" id="5895407">Doc</span><span class="op" id="5895410">)</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895413">p</span><span class="op" id="5895414">.</span><span class="ident" id="5895415">identList</span><span class="op" id="5895424">(</span><span class="ident" id="5895425">s</span><span class="op" id="5895426">.</span><span class="ident" id="5895427">Names</span><span class="op" id="5895432">,</span>&nbsp;<span class="builtintype" id="5895434">false</span><span class="op" id="5895439">)</span>&nbsp;<span class="comment" id="5895441">//&nbsp;always&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895460">extraTabs</span>&nbsp;<span class="op" id="5895470">:=</span>&nbsp;<span class="num" id="5895473">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5895476">if</span>&nbsp;<span class="ident" id="5895479">s</span><span class="op" id="5895480">.</span><span class="ident" id="5895481">Type</span>&nbsp;<span class="op" id="5895486">!=</span>&nbsp;<span class="ident" id="5895489">nil</span>&nbsp;<span class="op" id="5895493">||</span>&nbsp;<span class="ident" id="5895496">keepType</span>&nbsp;<span class="op" id="5895505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895509">p</span><span class="op" id="5895510">.</span><span class="builtinfunc" id="5895511">print</span><span class="op" id="5895516">(</span><span class="ident" id="5895517">vtab</span><span class="op" id="5895521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895525">extraTabs</span><span class="op" id="5895534">--</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5895538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5895541">if</span>&nbsp;<span class="ident" id="5895544">s</span><span class="op" id="5895545">.</span><span class="ident" id="5895546">Type</span>&nbsp;<span class="op" id="5895551">!=</span>&nbsp;<span class="ident" id="5895554">nil</span>&nbsp;<span class="op" id="5895558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895562">p</span><span class="op" id="5895563">.</span><span class="ident" id="5895564">expr</span><span class="op" id="5895568">(</span><span class="ident" id="5895569">s</span><span class="op" id="5895570">.</span><span class="ident" id="5895571">Type</span><span class="op" id="5895575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5895578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5895581">if</span>&nbsp;<span class="ident" id="5895584">s</span><span class="op" id="5895585">.</span><span class="ident" id="5895586">Values</span>&nbsp;<span class="op" id="5895593">!=</span>&nbsp;<span class="ident" id="5895596">nil</span>&nbsp;<span class="op" id="5895600">{</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895604">p</span><span class="op" id="5895605">.</span><span class="builtinfunc" id="5895606">print</span><span class="op" id="5895611">(</span><span class="ident" id="5895612">vtab</span><span class="op" id="5895616">,</span>&nbsp;<span class="ident" id="5895618">token</span><span class="op" id="5895623">.</span><span class="ident" id="5895624">ASSIGN</span><span class="op" id="5895630">,</span>&nbsp;<span class="ident" id="5895632">blank</span><span class="op" id="5895637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895641">p</span><span class="op" id="5895642">.</span><span class="ident" id="5895643">exprList</span><span class="op" id="5895651">(</span><span class="ident" id="5895652">token</span><span class="op" id="5895657">.</span><span class="ident" id="5895658">NoPos</span><span class="op" id="5895663">,</span>&nbsp;<span class="ident" id="5895665">s</span><span class="op" id="5895666">.</span><span class="ident" id="5895667">Values</span><span class="op" id="5895673">,</span>&nbsp;<span class="num" id="5895675">1</span><span class="op" id="5895676">,</span>&nbsp;<span class="num" id="5895678">0</span><span class="op" id="5895679">,</span>&nbsp;<span class="ident" id="5895681">token</span><span class="op" id="5895686">.</span><span class="ident" id="5895687">NoPos</span><span class="op" id="5895692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895696">extraTabs</span><span class="op" id="5895705">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5895709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5895712">if</span>&nbsp;<span class="ident" id="5895715">s</span><span class="op" id="5895716">.</span><span class="ident" id="5895717">Comment</span>&nbsp;<span class="op" id="5895725">!=</span>&nbsp;<span class="ident" id="5895728">nil</span>&nbsp;<span class="op" id="5895732">{</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5895736">for</span>&nbsp;<span class="op" id="5895740">;</span>&nbsp;<span class="ident" id="5895742">extraTabs</span>&nbsp;<span class="op" id="5895752">&gt;</span>&nbsp;<span class="num" id="5895754">0</span><span class="op" id="5895755">;</span>&nbsp;<span class="ident" id="5895757">extraTabs</span><span class="op" id="5895766">--</span>&nbsp;<span class="op" id="5895769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895774">p</span><span class="op" id="5895775">.</span><span class="builtinfunc" id="5895776">print</span><span class="op" id="5895781">(</span><span class="ident" id="5895782">vtab</span><span class="op" id="5895786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5895790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5895794">p</span><span class="op" id="5895795">.</span><span class="ident" id="5895796">setComment</span><span class="op" id="5895806">(</span><span class="ident" id="5895807">s</span><span class="op" id="5895808">.</span><span class="ident" id="5895809">Comment</span><span class="op" id="5895816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5895819">}</span><br>
<span class="lineno">1335</span><span class="op" id="5895821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5895824">//&nbsp;The&nbsp;parameter&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;specs&nbsp;in&nbsp;the&nbsp;group.&nbsp;If&nbsp;doIndent&nbsp;is&nbsp;set,</span><br>
<span class="lineno"></span><span class="comment" id="5895900">//&nbsp;multi-line&nbsp;identifier&nbsp;lists&nbsp;in&nbsp;the&nbsp;spec&nbsp;are&nbsp;indented&nbsp;when&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="5895971">//&nbsp;linebreak&nbsp;is&nbsp;encountered.</span><br>
<span class="lineno">1340</span><span class="comment" id="5896000">//</span><br>
<span class="lineno"></span><span class="keyword" id="5896003">func</span>&nbsp;<span class="op" id="5896008">(</span><span class="ident" id="5896009">p</span>&nbsp;<span class="op" id="5896011">*</span><span class="ident" id="5896012">printer</span><span class="op" id="5896019">)</span>&nbsp;<span class="ident" id="5896021">spec</span><span class="op" id="5896025">(</span><span class="ident" id="5896026">spec</span>&nbsp;<span class="ident" id="5896031">ast</span><span class="op" id="5896034">.</span><span class="ident" id="5896035">Spec</span><span class="op" id="5896039">,</span>&nbsp;<span class="ident" id="5896041">n</span>&nbsp;<span class="builtintype" id="5896043">int</span><span class="op" id="5896046">,</span>&nbsp;<span class="ident" id="5896048">doIndent</span>&nbsp;<span class="builtintype" id="5896057">bool</span><span class="op" id="5896061">)</span>&nbsp;<span class="op" id="5896063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896066">switch</span>&nbsp;<span class="ident" id="5896073">s</span>&nbsp;<span class="op" id="5896075">:=</span>&nbsp;<span class="ident" id="5896078">spec</span><span class="op" id="5896082">.</span><span class="op" id="5896083">(</span><span class="keyword" id="5896084">type</span><span class="op" id="5896088">)</span>&nbsp;<span class="op" id="5896090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896093">case</span>&nbsp;<span class="op" id="5896098">*</span><span class="ident" id="5896099">ast</span><span class="op" id="5896102">.</span><span class="ident" id="5896103">ImportSpec</span><span class="op" id="5896113">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896117">p</span><span class="op" id="5896118">.</span><span class="ident" id="5896119">setComment</span><span class="op" id="5896129">(</span><span class="ident" id="5896130">s</span><span class="op" id="5896131">.</span><span class="ident" id="5896132">Doc</span><span class="op" id="5896135">)</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896139">if</span>&nbsp;<span class="ident" id="5896142">s</span><span class="op" id="5896143">.</span><span class="ident" id="5896144">Name</span>&nbsp;<span class="op" id="5896149">!=</span>&nbsp;<span class="ident" id="5896152">nil</span>&nbsp;<span class="op" id="5896156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896161">p</span><span class="op" id="5896162">.</span><span class="ident" id="5896163">expr</span><span class="op" id="5896167">(</span><span class="ident" id="5896168">s</span><span class="op" id="5896169">.</span><span class="ident" id="5896170">Name</span><span class="op" id="5896174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896179">p</span><span class="op" id="5896180">.</span><span class="builtinfunc" id="5896181">print</span><span class="op" id="5896186">(</span><span class="ident" id="5896187">blank</span><span class="op" id="5896192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5896196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896200">p</span><span class="op" id="5896201">.</span><span class="ident" id="5896202">expr</span><span class="op" id="5896206">(</span><span class="ident" id="5896207">s</span><span class="op" id="5896208">.</span><span class="ident" id="5896209">Path</span><span class="op" id="5896213">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896217">p</span><span class="op" id="5896218">.</span><span class="ident" id="5896219">setComment</span><span class="op" id="5896229">(</span><span class="ident" id="5896230">s</span><span class="op" id="5896231">.</span><span class="ident" id="5896232">Comment</span><span class="op" id="5896239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896243">p</span><span class="op" id="5896244">.</span><span class="builtinfunc" id="5896245">print</span><span class="op" id="5896250">(</span><span class="ident" id="5896251">s</span><span class="op" id="5896252">.</span><span class="ident" id="5896253">EndPos</span><span class="op" id="5896259">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896263">case</span>&nbsp;<span class="op" id="5896268">*</span><span class="ident" id="5896269">ast</span><span class="op" id="5896272">.</span><span class="ident" id="5896273">ValueSpec</span><span class="op" id="5896282">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896286">if</span>&nbsp;<span class="ident" id="5896289">n</span>&nbsp;<span class="op" id="5896291">!=</span>&nbsp;<span class="num" id="5896294">1</span>&nbsp;<span class="op" id="5896296">{</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896301">p</span><span class="op" id="5896302">.</span><span class="ident" id="5896303">internalError</span><span class="op" id="5896316">(</span><span class="string" id="5896317">&#34;expected&nbsp;n&nbsp;=&nbsp;1;&nbsp;got&#34;</span><span class="op" id="5896338">,</span>&nbsp;<span class="ident" id="5896340">n</span><span class="op" id="5896341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5896345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896349">p</span><span class="op" id="5896350">.</span><span class="ident" id="5896351">setComment</span><span class="op" id="5896361">(</span><span class="ident" id="5896362">s</span><span class="op" id="5896363">.</span><span class="ident" id="5896364">Doc</span><span class="op" id="5896367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896371">p</span><span class="op" id="5896372">.</span><span class="ident" id="5896373">identList</span><span class="op" id="5896382">(</span><span class="ident" id="5896383">s</span><span class="op" id="5896384">.</span><span class="ident" id="5896385">Names</span><span class="op" id="5896390">,</span>&nbsp;<span class="ident" id="5896392">doIndent</span><span class="op" id="5896400">)</span>&nbsp;<span class="comment" id="5896402">//&nbsp;always&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896422">if</span>&nbsp;<span class="ident" id="5896425">s</span><span class="op" id="5896426">.</span><span class="ident" id="5896427">Type</span>&nbsp;<span class="op" id="5896432">!=</span>&nbsp;<span class="ident" id="5896435">nil</span>&nbsp;<span class="op" id="5896439">{</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896444">p</span><span class="op" id="5896445">.</span><span class="builtinfunc" id="5896446">print</span><span class="op" id="5896451">(</span><span class="ident" id="5896452">blank</span><span class="op" id="5896457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896462">p</span><span class="op" id="5896463">.</span><span class="ident" id="5896464">expr</span><span class="op" id="5896468">(</span><span class="ident" id="5896469">s</span><span class="op" id="5896470">.</span><span class="ident" id="5896471">Type</span><span class="op" id="5896475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5896479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896483">if</span>&nbsp;<span class="ident" id="5896486">s</span><span class="op" id="5896487">.</span><span class="ident" id="5896488">Values</span>&nbsp;<span class="op" id="5896495">!=</span>&nbsp;<span class="ident" id="5896498">nil</span>&nbsp;<span class="op" id="5896502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896507">p</span><span class="op" id="5896508">.</span><span class="builtinfunc" id="5896509">print</span><span class="op" id="5896514">(</span><span class="ident" id="5896515">blank</span><span class="op" id="5896520">,</span>&nbsp;<span class="ident" id="5896522">token</span><span class="op" id="5896527">.</span><span class="ident" id="5896528">ASSIGN</span><span class="op" id="5896534">,</span>&nbsp;<span class="ident" id="5896536">blank</span><span class="op" id="5896541">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896546">p</span><span class="op" id="5896547">.</span><span class="ident" id="5896548">exprList</span><span class="op" id="5896556">(</span><span class="ident" id="5896557">token</span><span class="op" id="5896562">.</span><span class="ident" id="5896563">NoPos</span><span class="op" id="5896568">,</span>&nbsp;<span class="ident" id="5896570">s</span><span class="op" id="5896571">.</span><span class="ident" id="5896572">Values</span><span class="op" id="5896578">,</span>&nbsp;<span class="num" id="5896580">1</span><span class="op" id="5896581">,</span>&nbsp;<span class="num" id="5896583">0</span><span class="op" id="5896584">,</span>&nbsp;<span class="ident" id="5896586">token</span><span class="op" id="5896591">.</span><span class="ident" id="5896592">NoPos</span><span class="op" id="5896597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5896601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896605">p</span><span class="op" id="5896606">.</span><span class="ident" id="5896607">setComment</span><span class="op" id="5896617">(</span><span class="ident" id="5896618">s</span><span class="op" id="5896619">.</span><span class="ident" id="5896620">Comment</span><span class="op" id="5896627">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896631">case</span>&nbsp;<span class="op" id="5896636">*</span><span class="ident" id="5896637">ast</span><span class="op" id="5896640">.</span><span class="ident" id="5896641">TypeSpec</span><span class="op" id="5896649">:</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896653">p</span><span class="op" id="5896654">.</span><span class="ident" id="5896655">setComment</span><span class="op" id="5896665">(</span><span class="ident" id="5896666">s</span><span class="op" id="5896667">.</span><span class="ident" id="5896668">Doc</span><span class="op" id="5896671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896675">p</span><span class="op" id="5896676">.</span><span class="ident" id="5896677">expr</span><span class="op" id="5896681">(</span><span class="ident" id="5896682">s</span><span class="op" id="5896683">.</span><span class="ident" id="5896684">Name</span><span class="op" id="5896688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896692">if</span>&nbsp;<span class="ident" id="5896695">n</span>&nbsp;<span class="op" id="5896697">==</span>&nbsp;<span class="num" id="5896700">1</span>&nbsp;<span class="op" id="5896702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896707">p</span><span class="op" id="5896708">.</span><span class="builtinfunc" id="5896709">print</span><span class="op" id="5896714">(</span><span class="ident" id="5896715">blank</span><span class="op" id="5896720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5896724">}</span>&nbsp;<span class="keyword" id="5896726">else</span>&nbsp;<span class="op" id="5896731">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896736">p</span><span class="op" id="5896737">.</span><span class="builtinfunc" id="5896738">print</span><span class="op" id="5896743">(</span><span class="ident" id="5896744">vtab</span><span class="op" id="5896748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5896752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896756">p</span><span class="op" id="5896757">.</span><span class="ident" id="5896758">expr</span><span class="op" id="5896762">(</span><span class="ident" id="5896763">s</span><span class="op" id="5896764">.</span><span class="ident" id="5896765">Type</span><span class="op" id="5896769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896773">p</span><span class="op" id="5896774">.</span><span class="ident" id="5896775">setComment</span><span class="op" id="5896785">(</span><span class="ident" id="5896786">s</span><span class="op" id="5896787">.</span><span class="ident" id="5896788">Comment</span><span class="op" id="5896795">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896799">default</span><span class="op" id="5896806">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5896810">panic</span><span class="op" id="5896815">(</span><span class="string" id="5896816">&#34;unreachable&#34;</span><span class="op" id="5896829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5896832">}</span><br>
<span class="lineno"></span><span class="op" id="5896834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1385</span><span class="keyword" id="5896837">func</span>&nbsp;<span class="op" id="5896842">(</span><span class="ident" id="5896843">p</span>&nbsp;<span class="op" id="5896845">*</span><span class="ident" id="5896846">printer</span><span class="op" id="5896853">)</span>&nbsp;<span class="ident" id="5896855">genDecl</span><span class="op" id="5896862">(</span><span class="ident" id="5896863">d</span>&nbsp;<span class="op" id="5896865">*</span><span class="ident" id="5896866">ast</span><span class="op" id="5896869">.</span><span class="ident" id="5896870">GenDecl</span><span class="op" id="5896877">)</span>&nbsp;<span class="op" id="5896879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896882">p</span><span class="op" id="5896883">.</span><span class="ident" id="5896884">setComment</span><span class="op" id="5896894">(</span><span class="ident" id="5896895">d</span><span class="op" id="5896896">.</span><span class="ident" id="5896897">Doc</span><span class="op" id="5896900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5896903">p</span><span class="op" id="5896904">.</span><span class="builtinfunc" id="5896905">print</span><span class="op" id="5896910">(</span><span class="ident" id="5896911">d</span><span class="op" id="5896912">.</span><span class="ident" id="5896913">Pos</span><span class="op" id="5896916">(</span><span class="op" id="5896917">)</span><span class="op" id="5896918">,</span>&nbsp;<span class="ident" id="5896920">d</span><span class="op" id="5896921">.</span><span class="ident" id="5896922">Tok</span><span class="op" id="5896925">,</span>&nbsp;<span class="ident" id="5896927">blank</span><span class="op" id="5896932">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5896936">if</span>&nbsp;<span class="ident" id="5896939">d</span><span class="op" id="5896940">.</span><span class="ident" id="5896941">Lparen</span><span class="op" id="5896947">.</span><span class="ident" id="5896948">IsValid</span><span class="op" id="5896955">(</span><span class="op" id="5896956">)</span>&nbsp;<span class="op" id="5896958">{</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5896962">//&nbsp;group&nbsp;of&nbsp;parenthesized&nbsp;declarations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897003">p</span><span class="op" id="5897004">.</span><span class="builtinfunc" id="5897005">print</span><span class="op" id="5897010">(</span><span class="ident" id="5897011">d</span><span class="op" id="5897012">.</span><span class="ident" id="5897013">Lparen</span><span class="op" id="5897019">,</span>&nbsp;<span class="ident" id="5897021">token</span><span class="op" id="5897026">.</span><span class="ident" id="5897027">LPAREN</span><span class="op" id="5897033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5897037">if</span>&nbsp;<span class="ident" id="5897040">n</span>&nbsp;<span class="op" id="5897042">:=</span>&nbsp;<span class="builtinfunc" id="5897045">len</span><span class="op" id="5897048">(</span><span class="ident" id="5897049">d</span><span class="op" id="5897050">.</span><span class="ident" id="5897051">Specs</span><span class="op" id="5897056">)</span><span class="op" id="5897057">;</span>&nbsp;<span class="ident" id="5897059">n</span>&nbsp;<span class="op" id="5897061">&gt;</span>&nbsp;<span class="num" id="5897063">0</span>&nbsp;<span class="op" id="5897065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897070">p</span><span class="op" id="5897071">.</span><span class="builtinfunc" id="5897072">print</span><span class="op" id="5897077">(</span><span class="ident" id="5897078">indent</span><span class="op" id="5897084">,</span>&nbsp;<span class="ident" id="5897086">formfeed</span><span class="op" id="5897094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5897099">if</span>&nbsp;<span class="ident" id="5897102">n</span>&nbsp;<span class="op" id="5897104">&gt;</span>&nbsp;<span class="num" id="5897106">1</span>&nbsp;<span class="op" id="5897108">&amp;&amp;</span>&nbsp;<span class="op" id="5897111">(</span><span class="ident" id="5897112">d</span><span class="op" id="5897113">.</span><span class="ident" id="5897114">Tok</span>&nbsp;<span class="op" id="5897118">==</span>&nbsp;<span class="ident" id="5897121">token</span><span class="op" id="5897126">.</span><span class="ident" id="5897127">CONST</span>&nbsp;<span class="op" id="5897133">||</span>&nbsp;<span class="ident" id="5897136">d</span><span class="op" id="5897137">.</span><span class="ident" id="5897138">Tok</span>&nbsp;<span class="op" id="5897142">==</span>&nbsp;<span class="ident" id="5897145">token</span><span class="op" id="5897150">.</span><span class="ident" id="5897151">VAR</span><span class="op" id="5897154">)</span>&nbsp;<span class="op" id="5897156">{</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5897162">//&nbsp;two&nbsp;or&nbsp;more&nbsp;grouped&nbsp;const/var&nbsp;declarations:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5897213">//&nbsp;determine&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;must&nbsp;be&nbsp;kept</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897262">keepType</span>&nbsp;<span class="op" id="5897271">:=</span>&nbsp;<span class="ident" id="5897274">keepTypeColumn</span><span class="op" id="5897288">(</span><span class="ident" id="5897289">d</span><span class="op" id="5897290">.</span><span class="ident" id="5897291">Specs</span><span class="op" id="5897296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5897302">var</span>&nbsp;<span class="ident" id="5897306">line</span>&nbsp;<span class="builtintype" id="5897311">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5897319">for</span>&nbsp;<span class="ident" id="5897323">i</span><span class="op" id="5897324">,</span>&nbsp;<span class="ident" id="5897326">s</span>&nbsp;<span class="op" id="5897328">:=</span>&nbsp;<span class="keyword" id="5897331">range</span>&nbsp;<span class="ident" id="5897337">d</span><span class="op" id="5897338">.</span><span class="ident" id="5897339">Specs</span>&nbsp;<span class="op" id="5897345">{</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5897352">if</span>&nbsp;<span class="ident" id="5897355">i</span>&nbsp;<span class="op" id="5897357">&gt;</span>&nbsp;<span class="num" id="5897359">0</span>&nbsp;<span class="op" id="5897361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897369">p</span><span class="op" id="5897370">.</span><span class="ident" id="5897371">linebreak</span><span class="op" id="5897380">(</span><span class="ident" id="5897381">p</span><span class="op" id="5897382">.</span><span class="ident" id="5897383">lineFor</span><span class="op" id="5897390">(</span><span class="ident" id="5897391">s</span><span class="op" id="5897392">.</span><span class="ident" id="5897393">Pos</span><span class="op" id="5897396">(</span><span class="op" id="5897397">)</span><span class="op" id="5897398">)</span><span class="op" id="5897399">,</span>&nbsp;<span class="num" id="5897401">1</span><span class="op" id="5897402">,</span>&nbsp;<span class="ident" id="5897404">ignore</span><span class="op" id="5897410">,</span>&nbsp;<span class="ident" id="5897412">p</span><span class="op" id="5897413">.</span><span class="ident" id="5897414">linesFrom</span><span class="op" id="5897423">(</span><span class="ident" id="5897424">line</span><span class="op" id="5897428">)</span>&nbsp;<span class="op" id="5897430">&gt;</span>&nbsp;<span class="num" id="5897432">0</span><span class="op" id="5897433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5897440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897447">p</span><span class="op" id="5897448">.</span><span class="ident" id="5897449">recordLine</span><span class="op" id="5897459">(</span><span class="op" id="5897460">&amp;</span><span class="ident" id="5897461">line</span><span class="op" id="5897465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897472">p</span><span class="op" id="5897473">.</span><span class="ident" id="5897474">valueSpec</span><span class="op" id="5897483">(</span><span class="ident" id="5897484">s</span><span class="op" id="5897485">.</span><span class="op" id="5897486">(</span><span class="op" id="5897487">*</span><span class="ident" id="5897488">ast</span><span class="op" id="5897491">.</span><span class="ident" id="5897492">ValueSpec</span><span class="op" id="5897501">)</span><span class="op" id="5897502">,</span>&nbsp;<span class="ident" id="5897504">keepType</span><span class="op" id="5897512">[</span><span class="ident" id="5897513">i</span><span class="op" id="5897514">]</span><span class="op" id="5897515">)</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5897521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5897526">}</span>&nbsp;<span class="keyword" id="5897528">else</span>&nbsp;<span class="op" id="5897533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5897539">var</span>&nbsp;<span class="ident" id="5897543">line</span>&nbsp;<span class="builtintype" id="5897548">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5897556">for</span>&nbsp;<span class="ident" id="5897560">i</span><span class="op" id="5897561">,</span>&nbsp;<span class="ident" id="5897563">s</span>&nbsp;<span class="op" id="5897565">:=</span>&nbsp;<span class="keyword" id="5897568">range</span>&nbsp;<span class="ident" id="5897574">d</span><span class="op" id="5897575">.</span><span class="ident" id="5897576">Specs</span>&nbsp;<span class="op" id="5897582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5897589">if</span>&nbsp;<span class="ident" id="5897592">i</span>&nbsp;<span class="op" id="5897594">&gt;</span>&nbsp;<span class="num" id="5897596">0</span>&nbsp;<span class="op" id="5897598">{</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897606">p</span><span class="op" id="5897607">.</span><span class="ident" id="5897608">linebreak</span><span class="op" id="5897617">(</span><span class="ident" id="5897618">p</span><span class="op" id="5897619">.</span><span class="ident" id="5897620">lineFor</span><span class="op" id="5897627">(</span><span class="ident" id="5897628">s</span><span class="op" id="5897629">.</span><span class="ident" id="5897630">Pos</span><span class="op" id="5897633">(</span><span class="op" id="5897634">)</span><span class="op" id="5897635">)</span><span class="op" id="5897636">,</span>&nbsp;<span class="num" id="5897638">1</span><span class="op" id="5897639">,</span>&nbsp;<span class="ident" id="5897641">ignore</span><span class="op" id="5897647">,</span>&nbsp;<span class="ident" id="5897649">p</span><span class="op" id="5897650">.</span><span class="ident" id="5897651">linesFrom</span><span class="op" id="5897660">(</span><span class="ident" id="5897661">line</span><span class="op" id="5897665">)</span>&nbsp;<span class="op" id="5897667">&gt;</span>&nbsp;<span class="num" id="5897669">0</span><span class="op" id="5897670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5897677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897684">p</span><span class="op" id="5897685">.</span><span class="ident" id="5897686">recordLine</span><span class="op" id="5897696">(</span><span class="op" id="5897697">&amp;</span><span class="ident" id="5897698">line</span><span class="op" id="5897702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897709">p</span><span class="op" id="5897710">.</span><span class="ident" id="5897711">spec</span><span class="op" id="5897715">(</span><span class="ident" id="5897716">s</span><span class="op" id="5897717">,</span>&nbsp;<span class="ident" id="5897719">n</span><span class="op" id="5897720">,</span>&nbsp;<span class="builtintype" id="5897722">false</span><span class="op" id="5897727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5897733">}</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5897738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897743">p</span><span class="op" id="5897744">.</span><span class="builtinfunc" id="5897745">print</span><span class="op" id="5897750">(</span><span class="ident" id="5897751">unindent</span><span class="op" id="5897759">,</span>&nbsp;<span class="ident" id="5897761">formfeed</span><span class="op" id="5897769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5897773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897777">p</span><span class="op" id="5897778">.</span><span class="builtinfunc" id="5897779">print</span><span class="op" id="5897784">(</span><span class="ident" id="5897785">d</span><span class="op" id="5897786">.</span><span class="ident" id="5897787">Rparen</span><span class="op" id="5897793">,</span>&nbsp;<span class="ident" id="5897795">token</span><span class="op" id="5897800">.</span><span class="ident" id="5897801">RPAREN</span><span class="op" id="5897807">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5897811">}</span>&nbsp;<span class="keyword" id="5897813">else</span>&nbsp;<span class="op" id="5897818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5897822">//&nbsp;single&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5897846">p</span><span class="op" id="5897847">.</span><span class="ident" id="5897848">spec</span><span class="op" id="5897852">(</span><span class="ident" id="5897853">d</span><span class="op" id="5897854">.</span><span class="ident" id="5897855">Specs</span><span class="op" id="5897860">[</span><span class="num" id="5897861">0</span><span class="op" id="5897862">]</span><span class="op" id="5897863">,</span>&nbsp;<span class="num" id="5897865">1</span><span class="op" id="5897866">,</span>&nbsp;<span class="builtintype" id="5897868">true</span><span class="op" id="5897872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5897875">}</span><br>
<span class="lineno"></span><span class="op" id="5897877">}</span><br>
<span class="lineno">1425</span><br>
<span class="lineno"></span><span class="comment" id="5897880">//&nbsp;nodeSize&nbsp;determines&nbsp;the&nbsp;size&nbsp;of&nbsp;n&nbsp;in&nbsp;chars&nbsp;after&nbsp;formatting.</span><br>
<span class="lineno"></span><span class="comment" id="5897944">//&nbsp;The&nbsp;result&nbsp;is&nbsp;&lt;=&nbsp;maxSize&nbsp;if&nbsp;the&nbsp;node&nbsp;fits&nbsp;on&nbsp;one&nbsp;line&nbsp;with&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="5898009">//&nbsp;most&nbsp;maxSize&nbsp;chars&nbsp;and&nbsp;the&nbsp;formatted&nbsp;output&nbsp;doesn&#39;t&nbsp;contain</span><br>
<span class="lineno"></span><span class="comment" id="5898072">//&nbsp;any&nbsp;control&nbsp;chars.&nbsp;Otherwise,&nbsp;the&nbsp;result&nbsp;is&nbsp;&gt;&nbsp;maxSize.</span><br>
<span class="lineno">1430</span><span class="comment" id="5898130">//</span><br>
<span class="lineno"></span><span class="keyword" id="5898133">func</span>&nbsp;<span class="op" id="5898138">(</span><span class="ident" id="5898139">p</span>&nbsp;<span class="op" id="5898141">*</span><span class="ident" id="5898142">printer</span><span class="op" id="5898149">)</span>&nbsp;<span class="ident" id="5898151">nodeSize</span><span class="op" id="5898159">(</span><span class="ident" id="5898160">n</span>&nbsp;<span class="ident" id="5898162">ast</span><span class="op" id="5898165">.</span><span class="ident" id="5898166">Node</span><span class="op" id="5898170">,</span>&nbsp;<span class="ident" id="5898172">maxSize</span>&nbsp;<span class="builtintype" id="5898180">int</span><span class="op" id="5898183">)</span>&nbsp;<span class="op" id="5898185">(</span><span class="ident" id="5898186">size</span>&nbsp;<span class="builtintype" id="5898191">int</span><span class="op" id="5898194">)</span>&nbsp;<span class="op" id="5898196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5898199">//&nbsp;nodeSize&nbsp;invokes&nbsp;the&nbsp;printer,&nbsp;which&nbsp;may&nbsp;invoke&nbsp;nodeSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5898259">//&nbsp;recursively.&nbsp;For&nbsp;deep&nbsp;composite&nbsp;literal&nbsp;nests,&nbsp;this&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5898319">//&nbsp;lead&nbsp;to&nbsp;an&nbsp;exponential&nbsp;algorithm.&nbsp;Remember&nbsp;previous</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5898375">//&nbsp;results&nbsp;to&nbsp;prune&nbsp;the&nbsp;recursion&nbsp;(was&nbsp;issue&nbsp;1628).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5898428">if</span>&nbsp;<span class="ident" id="5898431">size</span><span class="op" id="5898435">,</span>&nbsp;<span class="ident" id="5898437">found</span>&nbsp;<span class="op" id="5898443">:=</span>&nbsp;<span class="ident" id="5898446">p</span><span class="op" id="5898447">.</span><span class="ident" id="5898448">nodeSizes</span><span class="op" id="5898457">[</span><span class="ident" id="5898458">n</span><span class="op" id="5898459">]</span><span class="op" id="5898460">;</span>&nbsp;<span class="ident" id="5898462">found</span>&nbsp;<span class="op" id="5898468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5898472">return</span>&nbsp;<span class="ident" id="5898479">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5898485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5898489">size</span>&nbsp;<span class="op" id="5898494">=</span>&nbsp;<span class="ident" id="5898496">maxSize</span>&nbsp;<span class="op" id="5898504">+</span>&nbsp;<span class="num" id="5898506">1</span>&nbsp;<span class="comment" id="5898508">//&nbsp;assume&nbsp;n&nbsp;doesn&#39;t&nbsp;fit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5898533">p</span><span class="op" id="5898534">.</span><span class="ident" id="5898535">nodeSizes</span><span class="op" id="5898544">[</span><span class="ident" id="5898545">n</span><span class="op" id="5898546">]</span>&nbsp;<span class="op" id="5898548">=</span>&nbsp;<span class="ident" id="5898550">size</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5898557">//&nbsp;nodeSize&nbsp;computation&nbsp;must&nbsp;be&nbsp;independent&nbsp;of&nbsp;particular</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5898616">//&nbsp;style&nbsp;so&nbsp;that&nbsp;we&nbsp;always&nbsp;get&nbsp;the&nbsp;same&nbsp;decision;&nbsp;print</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5898673">//&nbsp;in&nbsp;RawFormat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5898690">cfg</span>&nbsp;<span class="op" id="5898694">:=</span>&nbsp;<span class="ident" id="5898697">Config</span><span class="op" id="5898703">{</span><span class="ident" id="5898704">Mode</span><span class="op" id="5898708">:</span>&nbsp;<span class="ident" id="5898710">RawFormat</span><span class="op" id="5898719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5898722">var</span>&nbsp;<span class="ident" id="5898726">buf</span>&nbsp;<span class="ident" id="5898730">bytes</span><span class="op" id="5898735">.</span><span class="ident" id="5898736">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5898744">if</span>&nbsp;<span class="ident" id="5898747">err</span>&nbsp;<span class="op" id="5898751">:=</span>&nbsp;<span class="ident" id="5898754">cfg</span><span class="op" id="5898757">.</span><span class="ident" id="5898758">fprint</span><span class="op" id="5898764">(</span><span class="op" id="5898765">&amp;</span><span class="ident" id="5898766">buf</span><span class="op" id="5898769">,</span>&nbsp;<span class="ident" id="5898771">p</span><span class="op" id="5898772">.</span><span class="ident" id="5898773">fset</span><span class="op" id="5898777">,</span>&nbsp;<span class="ident" id="5898779">n</span><span class="op" id="5898780">,</span>&nbsp;<span class="ident" id="5898782">p</span><span class="op" id="5898783">.</span><span class="ident" id="5898784">nodeSizes</span><span class="op" id="5898793">)</span><span class="op" id="5898794">;</span>&nbsp;<span class="ident" id="5898796">err</span>&nbsp;<span class="op" id="5898800">!=</span>&nbsp;<span class="ident" id="5898803">nil</span>&nbsp;<span class="op" id="5898807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5898811">return</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5898819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5898822">if</span>&nbsp;<span class="ident" id="5898825">buf</span><span class="op" id="5898828">.</span><span class="ident" id="5898829">Len</span><span class="op" id="5898832">(</span><span class="op" id="5898833">)</span>&nbsp;<span class="op" id="5898835">&lt;=</span>&nbsp;<span class="ident" id="5898838">maxSize</span>&nbsp;<span class="op" id="5898846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5898850">for</span>&nbsp;<span class="ident" id="5898854">_</span><span class="op" id="5898855">,</span>&nbsp;<span class="ident" id="5898857">ch</span>&nbsp;<span class="op" id="5898860">:=</span>&nbsp;<span class="keyword" id="5898863">range</span>&nbsp;<span class="ident" id="5898869">buf</span><span class="op" id="5898872">.</span><span class="ident" id="5898873">Bytes</span><span class="op" id="5898878">(</span><span class="op" id="5898879">)</span>&nbsp;<span class="op" id="5898881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5898886">if</span>&nbsp;<span class="ident" id="5898889">ch</span>&nbsp;<span class="op" id="5898892">&lt;</span>&nbsp;<span class="string" id="5898894">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5898898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5898904">return</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5898914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5898918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5898922">size</span>&nbsp;<span class="op" id="5898927">=</span>&nbsp;<span class="ident" id="5898929">buf</span><span class="op" id="5898932">.</span><span class="ident" id="5898933">Len</span><span class="op" id="5898936">(</span><span class="op" id="5898937">)</span>&nbsp;<span class="comment" id="5898939">//&nbsp;n&nbsp;fits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5898951">p</span><span class="op" id="5898952">.</span><span class="ident" id="5898953">nodeSizes</span><span class="op" id="5898962">[</span><span class="ident" id="5898963">n</span><span class="op" id="5898964">]</span>&nbsp;<span class="op" id="5898966">=</span>&nbsp;<span class="ident" id="5898968">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5898974">}</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5898977">return</span><br>
<span class="lineno"></span><span class="op" id="5898984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5898987">//&nbsp;bodySize&nbsp;is&nbsp;like&nbsp;nodeSize&nbsp;but&nbsp;it&nbsp;is&nbsp;specialized&nbsp;for&nbsp;*ast.BlockStmt&#39;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5899060">func</span>&nbsp;<span class="op" id="5899065">(</span><span class="ident" id="5899066">p</span>&nbsp;<span class="op" id="5899068">*</span><span class="ident" id="5899069">printer</span><span class="op" id="5899076">)</span>&nbsp;<span class="ident" id="5899078">bodySize</span><span class="op" id="5899086">(</span><span class="ident" id="5899087">b</span>&nbsp;<span class="op" id="5899089">*</span><span class="ident" id="5899090">ast</span><span class="op" id="5899093">.</span><span class="ident" id="5899094">BlockStmt</span><span class="op" id="5899103">,</span>&nbsp;<span class="ident" id="5899105">maxSize</span>&nbsp;<span class="builtintype" id="5899113">int</span><span class="op" id="5899116">)</span>&nbsp;<span class="builtintype" id="5899118">int</span>&nbsp;<span class="op" id="5899122">{</span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5899125">pos1</span>&nbsp;<span class="op" id="5899130">:=</span>&nbsp;<span class="ident" id="5899133">b</span><span class="op" id="5899134">.</span><span class="ident" id="5899135">Pos</span><span class="op" id="5899138">(</span><span class="op" id="5899139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5899142">pos2</span>&nbsp;<span class="op" id="5899147">:=</span>&nbsp;<span class="ident" id="5899150">b</span><span class="op" id="5899151">.</span><span class="ident" id="5899152">Rbrace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5899160">if</span>&nbsp;<span class="ident" id="5899163">pos1</span><span class="op" id="5899167">.</span><span class="ident" id="5899168">IsValid</span><span class="op" id="5899175">(</span><span class="op" id="5899176">)</span>&nbsp;<span class="op" id="5899178">&amp;&amp;</span>&nbsp;<span class="ident" id="5899181">pos2</span><span class="op" id="5899185">.</span><span class="ident" id="5899186">IsValid</span><span class="op" id="5899193">(</span><span class="op" id="5899194">)</span>&nbsp;<span class="op" id="5899196">&amp;&amp;</span>&nbsp;<span class="ident" id="5899199">p</span><span class="op" id="5899200">.</span><span class="ident" id="5899201">lineFor</span><span class="op" id="5899208">(</span><span class="ident" id="5899209">pos1</span><span class="op" id="5899213">)</span>&nbsp;<span class="op" id="5899215">!=</span>&nbsp;<span class="ident" id="5899218">p</span><span class="op" id="5899219">.</span><span class="ident" id="5899220">lineFor</span><span class="op" id="5899227">(</span><span class="ident" id="5899228">pos2</span><span class="op" id="5899232">)</span>&nbsp;<span class="op" id="5899234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5899238">//&nbsp;opening&nbsp;and&nbsp;closing&nbsp;brace&nbsp;are&nbsp;on&nbsp;different&nbsp;lines&nbsp;-&nbsp;don&#39;t&nbsp;make&nbsp;it&nbsp;a&nbsp;one-liner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5899320">return</span>&nbsp;<span class="ident" id="5899327">maxSize</span>&nbsp;<span class="op" id="5899335">+</span>&nbsp;<span class="num" id="5899337">1</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5899340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5899343">if</span>&nbsp;<span class="builtinfunc" id="5899346">len</span><span class="op" id="5899349">(</span><span class="ident" id="5899350">b</span><span class="op" id="5899351">.</span><span class="ident" id="5899352">List</span><span class="op" id="5899356">)</span>&nbsp;<span class="op" id="5899358">&gt;</span>&nbsp;<span class="num" id="5899360">5</span>&nbsp;<span class="op" id="5899362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5899366">//&nbsp;too&nbsp;many&nbsp;statements&nbsp;-&nbsp;don&#39;t&nbsp;make&nbsp;it&nbsp;a&nbsp;one-liner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5899419">return</span>&nbsp;<span class="ident" id="5899426">maxSize</span>&nbsp;<span class="op" id="5899434">+</span>&nbsp;<span class="num" id="5899436">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5899439">}</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5899442">//&nbsp;otherwise,&nbsp;estimate&nbsp;body&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5899476">bodySize</span>&nbsp;<span class="op" id="5899485">:=</span>&nbsp;<span class="ident" id="5899488">p</span><span class="op" id="5899489">.</span><span class="ident" id="5899490">commentSizeBefore</span><span class="op" id="5899507">(</span><span class="ident" id="5899508">p</span><span class="op" id="5899509">.</span><span class="ident" id="5899510">posFor</span><span class="op" id="5899516">(</span><span class="ident" id="5899517">pos2</span><span class="op" id="5899521">)</span><span class="op" id="5899522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5899525">for</span>&nbsp;<span class="ident" id="5899529">i</span><span class="op" id="5899530">,</span>&nbsp;<span class="ident" id="5899532">s</span>&nbsp;<span class="op" id="5899534">:=</span>&nbsp;<span class="keyword" id="5899537">range</span>&nbsp;<span class="ident" id="5899543">b</span><span class="op" id="5899544">.</span><span class="ident" id="5899545">List</span>&nbsp;<span class="op" id="5899550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5899554">if</span>&nbsp;<span class="ident" id="5899557">bodySize</span>&nbsp;<span class="op" id="5899566">&gt;</span>&nbsp;<span class="ident" id="5899568">maxSize</span>&nbsp;<span class="op" id="5899576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5899581">break</span>&nbsp;<span class="comment" id="5899587">//&nbsp;no&nbsp;need&nbsp;to&nbsp;continue</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5899612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5899616">if</span>&nbsp;<span class="ident" id="5899619">i</span>&nbsp;<span class="op" id="5899621">&gt;</span>&nbsp;<span class="num" id="5899623">0</span>&nbsp;<span class="op" id="5899625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5899630">bodySize</span>&nbsp;<span class="op" id="5899639">+=</span>&nbsp;<span class="num" id="5899642">2</span>&nbsp;<span class="comment" id="5899644">//&nbsp;space&nbsp;for&nbsp;a&nbsp;semicolon&nbsp;and&nbsp;blank</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5899681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5899685">bodySize</span>&nbsp;<span class="op" id="5899694">+=</span>&nbsp;<span class="ident" id="5899697">p</span><span class="op" id="5899698">.</span><span class="ident" id="5899699">nodeSize</span><span class="op" id="5899707">(</span><span class="ident" id="5899708">s</span><span class="op" id="5899709">,</span>&nbsp;<span class="ident" id="5899711">maxSize</span><span class="op" id="5899718">)</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5899721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5899724">return</span>&nbsp;<span class="ident" id="5899731">bodySize</span><br>
<span class="lineno"></span><span class="op" id="5899740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5899743">//&nbsp;adjBlock&nbsp;prints&nbsp;an&nbsp;&#34;adjacent&#34;&nbsp;block&nbsp;(e.g.,&nbsp;a&nbsp;for-loop&nbsp;or&nbsp;function&nbsp;body)&nbsp;following</span><br>
<span class="lineno">1490</span><span class="comment" id="5899828">//&nbsp;a&nbsp;header&nbsp;(e.g.,&nbsp;a&nbsp;for-loop&nbsp;control&nbsp;clause&nbsp;or&nbsp;function&nbsp;signature)&nbsp;of&nbsp;given&nbsp;headerSize.</span><br>
<span class="lineno"></span><span class="comment" id="5899917">//&nbsp;If&nbsp;the&nbsp;header&#39;s&nbsp;and&nbsp;block&#39;s&nbsp;size&nbsp;are&nbsp;&#34;small&nbsp;enough&#34;&nbsp;and&nbsp;the&nbsp;block&nbsp;is&nbsp;&#34;simple&nbsp;enough&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="5900006">//&nbsp;the&nbsp;block&nbsp;is&nbsp;printed&nbsp;on&nbsp;the&nbsp;current&nbsp;line,&nbsp;without&nbsp;line&nbsp;breaks,&nbsp;spaced&nbsp;from&nbsp;the&nbsp;header</span><br>
<span class="lineno"></span><span class="comment" id="5900095">//&nbsp;by&nbsp;sep.&nbsp;Otherwise&nbsp;the&nbsp;block&#39;s&nbsp;opening&nbsp;&#34;{&#34;&nbsp;is&nbsp;printed&nbsp;on&nbsp;the&nbsp;current&nbsp;line,&nbsp;followed&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5900184">//&nbsp;lines&nbsp;for&nbsp;the&nbsp;block&#39;s&nbsp;statements&nbsp;and&nbsp;its&nbsp;closing&nbsp;&#34;}&#34;.</span><br>
<span class="lineno">1495</span><span class="comment" id="5900241">//</span><br>
<span class="lineno"></span><span class="keyword" id="5900244">func</span>&nbsp;<span class="op" id="5900249">(</span><span class="ident" id="5900250">p</span>&nbsp;<span class="op" id="5900252">*</span><span class="ident" id="5900253">printer</span><span class="op" id="5900260">)</span>&nbsp;<span class="ident" id="5900262">adjBlock</span><span class="op" id="5900270">(</span><span class="ident" id="5900271">headerSize</span>&nbsp;<span class="builtintype" id="5900282">int</span><span class="op" id="5900285">,</span>&nbsp;<span class="ident" id="5900287">sep</span>&nbsp;<span class="ident" id="5900291">whiteSpace</span><span class="op" id="5900301">,</span>&nbsp;<span class="ident" id="5900303">b</span>&nbsp;<span class="op" id="5900305">*</span><span class="ident" id="5900306">ast</span><span class="op" id="5900309">.</span><span class="ident" id="5900310">BlockStmt</span><span class="op" id="5900319">)</span>&nbsp;<span class="op" id="5900321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5900324">if</span>&nbsp;<span class="ident" id="5900327">b</span>&nbsp;<span class="op" id="5900329">==</span>&nbsp;<span class="ident" id="5900332">nil</span>&nbsp;<span class="op" id="5900336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5900340">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5900348">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5900352">const</span>&nbsp;<span class="ident" id="5900358">maxSize</span>&nbsp;<span class="op" id="5900366">=</span>&nbsp;<span class="num" id="5900368">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5900373">if</span>&nbsp;<span class="ident" id="5900376">headerSize</span><span class="op" id="5900386">+</span><span class="ident" id="5900387">p</span><span class="op" id="5900388">.</span><span class="ident" id="5900389">bodySize</span><span class="op" id="5900397">(</span><span class="ident" id="5900398">b</span><span class="op" id="5900399">,</span>&nbsp;<span class="ident" id="5900401">maxSize</span><span class="op" id="5900408">)</span>&nbsp;<span class="op" id="5900410">&lt;=</span>&nbsp;<span class="ident" id="5900413">maxSize</span>&nbsp;<span class="op" id="5900421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5900425">p</span><span class="op" id="5900426">.</span><span class="builtinfunc" id="5900427">print</span><span class="op" id="5900432">(</span><span class="ident" id="5900433">sep</span><span class="op" id="5900436">,</span>&nbsp;<span class="ident" id="5900438">b</span><span class="op" id="5900439">.</span><span class="ident" id="5900440">Lbrace</span><span class="op" id="5900446">,</span>&nbsp;<span class="ident" id="5900448">token</span><span class="op" id="5900453">.</span><span class="ident" id="5900454">LBRACE</span><span class="op" id="5900460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5900464">if</span>&nbsp;<span class="builtinfunc" id="5900467">len</span><span class="op" id="5900470">(</span><span class="ident" id="5900471">b</span><span class="op" id="5900472">.</span><span class="ident" id="5900473">List</span><span class="op" id="5900477">)</span>&nbsp;<span class="op" id="5900479">&gt;</span>&nbsp;<span class="num" id="5900481">0</span>&nbsp;<span class="op" id="5900483">{</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5900488">p</span><span class="op" id="5900489">.</span><span class="builtinfunc" id="5900490">print</span><span class="op" id="5900495">(</span><span class="ident" id="5900496">blank</span><span class="op" id="5900501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5900506">for</span>&nbsp;<span class="ident" id="5900510">i</span><span class="op" id="5900511">,</span>&nbsp;<span class="ident" id="5900513">s</span>&nbsp;<span class="op" id="5900515">:=</span>&nbsp;<span class="keyword" id="5900518">range</span>&nbsp;<span class="ident" id="5900524">b</span><span class="op" id="5900525">.</span><span class="ident" id="5900526">List</span>&nbsp;<span class="op" id="5900531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5900537">if</span>&nbsp;<span class="ident" id="5900540">i</span>&nbsp;<span class="op" id="5900542">&gt;</span>&nbsp;<span class="num" id="5900544">0</span>&nbsp;<span class="op" id="5900546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5900553">p</span><span class="op" id="5900554">.</span><span class="builtinfunc" id="5900555">print</span><span class="op" id="5900560">(</span><span class="ident" id="5900561">token</span><span class="op" id="5900566">.</span><span class="ident" id="5900567">SEMICOLON</span><span class="op" id="5900576">,</span>&nbsp;<span class="ident" id="5900578">blank</span><span class="op" id="5900583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5900589">}</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5900595">p</span><span class="op" id="5900596">.</span><span class="ident" id="5900597">stmt</span><span class="op" id="5900601">(</span><span class="ident" id="5900602">s</span><span class="op" id="5900603">,</span>&nbsp;<span class="ident" id="5900605">i</span>&nbsp;<span class="op" id="5900607">==</span>&nbsp;<span class="builtinfunc" id="5900610">len</span><span class="op" id="5900613">(</span><span class="ident" id="5900614">b</span><span class="op" id="5900615">.</span><span class="ident" id="5900616">List</span><span class="op" id="5900620">)</span><span class="op" id="5900621">-</span><span class="num" id="5900622">1</span><span class="op" id="5900623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5900628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5900633">p</span><span class="op" id="5900634">.</span><span class="builtinfunc" id="5900635">print</span><span class="op" id="5900640">(</span><span class="ident" id="5900641">blank</span><span class="op" id="5900646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5900650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5900654">p</span><span class="op" id="5900655">.</span><span class="builtinfunc" id="5900656">print</span><span class="op" id="5900661">(</span><span class="ident" id="5900662">noExtraLinebreak</span><span class="op" id="5900678">,</span>&nbsp;<span class="ident" id="5900680">b</span><span class="op" id="5900681">.</span><span class="ident" id="5900682">Rbrace</span><span class="op" id="5900688">,</span>&nbsp;<span class="ident" id="5900690">token</span><span class="op" id="5900695">.</span><span class="ident" id="5900696">RBRACE</span><span class="op" id="5900702">,</span>&nbsp;<span class="ident" id="5900704">noExtraLinebreak</span><span class="op" id="5900720">)</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5900724">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5900732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5900736">if</span>&nbsp;<span class="ident" id="5900739">sep</span>&nbsp;<span class="op" id="5900743">!=</span>&nbsp;<span class="ident" id="5900746">ignore</span>&nbsp;<span class="op" id="5900753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5900757">p</span><span class="op" id="5900758">.</span><span class="builtinfunc" id="5900759">print</span><span class="op" id="5900764">(</span><span class="ident" id="5900765">blank</span><span class="op" id="5900770">)</span>&nbsp;<span class="comment" id="5900772">//&nbsp;always&nbsp;use&nbsp;blank</span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5900793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5900796">p</span><span class="op" id="5900797">.</span><span class="ident" id="5900798">block</span><span class="op" id="5900803">(</span><span class="ident" id="5900804">b</span><span class="op" id="5900805">,</span>&nbsp;<span class="num" id="5900807">1</span><span class="op" id="5900808">)</span><br>
<span class="lineno"></span><span class="op" id="5900810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5900813">//&nbsp;distanceFrom&nbsp;returns&nbsp;the&nbsp;column&nbsp;difference&nbsp;between&nbsp;from&nbsp;and&nbsp;p.pos&nbsp;(the&nbsp;current</span><br>
<span class="lineno">1525</span><span class="comment" id="5900895">//&nbsp;estimated&nbsp;position)&nbsp;if&nbsp;both&nbsp;are&nbsp;on&nbsp;the&nbsp;same&nbsp;line;&nbsp;if&nbsp;they&nbsp;are&nbsp;on&nbsp;different&nbsp;lines</span><br>
<span class="lineno"></span><span class="comment" id="5900979">//&nbsp;(or&nbsp;unknown)&nbsp;the&nbsp;result&nbsp;is&nbsp;infinity.</span><br>
<span class="lineno"></span><span class="keyword" id="5901019">func</span>&nbsp;<span class="op" id="5901024">(</span><span class="ident" id="5901025">p</span>&nbsp;<span class="op" id="5901027">*</span><span class="ident" id="5901028">printer</span><span class="op" id="5901035">)</span>&nbsp;<span class="ident" id="5901037">distanceFrom</span><span class="op" id="5901049">(</span><span class="ident" id="5901050">from</span>&nbsp;<span class="ident" id="5901055">token</span><span class="op" id="5901060">.</span><span class="ident" id="5901061">Pos</span><span class="op" id="5901064">)</span>&nbsp;<span class="builtintype" id="5901066">int</span>&nbsp;<span class="op" id="5901070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5901073">if</span>&nbsp;<span class="ident" id="5901076">from</span><span class="op" id="5901080">.</span><span class="ident" id="5901081">IsValid</span><span class="op" id="5901088">(</span><span class="op" id="5901089">)</span>&nbsp;<span class="op" id="5901091">&amp;&amp;</span>&nbsp;<span class="ident" id="5901094">p</span><span class="op" id="5901095">.</span><span class="ident" id="5901096">pos</span><span class="op" id="5901099">.</span><span class="ident" id="5901100">IsValid</span><span class="op" id="5901107">(</span><span class="op" id="5901108">)</span>&nbsp;<span class="op" id="5901110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5901114">if</span>&nbsp;<span class="ident" id="5901117">f</span>&nbsp;<span class="op" id="5901119">:=</span>&nbsp;<span class="ident" id="5901122">p</span><span class="op" id="5901123">.</span><span class="ident" id="5901124">posFor</span><span class="op" id="5901130">(</span><span class="ident" id="5901131">from</span><span class="op" id="5901135">)</span><span class="op" id="5901136">;</span>&nbsp;<span class="ident" id="5901138">f</span><span class="op" id="5901139">.</span><span class="ident" id="5901140">Line</span>&nbsp;<span class="op" id="5901145">==</span>&nbsp;<span class="ident" id="5901148">p</span><span class="op" id="5901149">.</span><span class="ident" id="5901150">pos</span><span class="op" id="5901153">.</span><span class="ident" id="5901154">Line</span>&nbsp;<span class="op" id="5901159">{</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5901164">return</span>&nbsp;<span class="ident" id="5901171">p</span><span class="op" id="5901172">.</span><span class="ident" id="5901173">pos</span><span class="op" id="5901176">.</span><span class="ident" id="5901177">Column</span>&nbsp;<span class="op" id="5901184">-</span>&nbsp;<span class="ident" id="5901186">f</span><span class="op" id="5901187">.</span><span class="ident" id="5901188">Column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5901197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5901200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5901203">return</span>&nbsp;<span class="ident" id="5901210">infinity</span><br>
<span class="lineno"></span><span class="op" id="5901219">}</span><br>
<span class="lineno">1535</span><br>
<span class="lineno"></span><span class="keyword" id="5901222">func</span>&nbsp;<span class="op" id="5901227">(</span><span class="ident" id="5901228">p</span>&nbsp;<span class="op" id="5901230">*</span><span class="ident" id="5901231">printer</span><span class="op" id="5901238">)</span>&nbsp;<span class="ident" id="5901240">funcDecl</span><span class="op" id="5901248">(</span><span class="ident" id="5901249">d</span>&nbsp;<span class="op" id="5901251">*</span><span class="ident" id="5901252">ast</span><span class="op" id="5901255">.</span><span class="ident" id="5901256">FuncDecl</span><span class="op" id="5901264">)</span>&nbsp;<span class="op" id="5901266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901269">p</span><span class="op" id="5901270">.</span><span class="ident" id="5901271">setComment</span><span class="op" id="5901281">(</span><span class="ident" id="5901282">d</span><span class="op" id="5901283">.</span><span class="ident" id="5901284">Doc</span><span class="op" id="5901287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901290">p</span><span class="op" id="5901291">.</span><span class="builtinfunc" id="5901292">print</span><span class="op" id="5901297">(</span><span class="ident" id="5901298">d</span><span class="op" id="5901299">.</span><span class="ident" id="5901300">Pos</span><span class="op" id="5901303">(</span><span class="op" id="5901304">)</span><span class="op" id="5901305">,</span>&nbsp;<span class="ident" id="5901307">token</span><span class="op" id="5901312">.</span><span class="ident" id="5901313">FUNC</span><span class="op" id="5901317">,</span>&nbsp;<span class="ident" id="5901319">blank</span><span class="op" id="5901324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5901327">if</span>&nbsp;<span class="ident" id="5901330">d</span><span class="op" id="5901331">.</span><span class="ident" id="5901332">Recv</span>&nbsp;<span class="op" id="5901337">!=</span>&nbsp;<span class="ident" id="5901340">nil</span>&nbsp;<span class="op" id="5901344">{</span><br>
<span class="lineno">1540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901348">p</span><span class="op" id="5901349">.</span><span class="ident" id="5901350">parameters</span><span class="op" id="5901360">(</span><span class="ident" id="5901361">d</span><span class="op" id="5901362">.</span><span class="ident" id="5901363">Recv</span><span class="op" id="5901367">)</span>&nbsp;<span class="comment" id="5901369">//&nbsp;method:&nbsp;print&nbsp;receiver</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901397">p</span><span class="op" id="5901398">.</span><span class="builtinfunc" id="5901399">print</span><span class="op" id="5901404">(</span><span class="ident" id="5901405">blank</span><span class="op" id="5901410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5901413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901416">p</span><span class="op" id="5901417">.</span><span class="ident" id="5901418">expr</span><span class="op" id="5901422">(</span><span class="ident" id="5901423">d</span><span class="op" id="5901424">.</span><span class="ident" id="5901425">Name</span><span class="op" id="5901429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901432">p</span><span class="op" id="5901433">.</span><span class="ident" id="5901434">signature</span><span class="op" id="5901443">(</span><span class="ident" id="5901444">d</span><span class="op" id="5901445">.</span><span class="ident" id="5901446">Type</span><span class="op" id="5901450">.</span><span class="ident" id="5901451">Params</span><span class="op" id="5901457">,</span>&nbsp;<span class="ident" id="5901459">d</span><span class="op" id="5901460">.</span><span class="ident" id="5901461">Type</span><span class="op" id="5901465">.</span><span class="ident" id="5901466">Results</span><span class="op" id="5901473">)</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901476">p</span><span class="op" id="5901477">.</span><span class="ident" id="5901478">adjBlock</span><span class="op" id="5901486">(</span><span class="ident" id="5901487">p</span><span class="op" id="5901488">.</span><span class="ident" id="5901489">distanceFrom</span><span class="op" id="5901501">(</span><span class="ident" id="5901502">d</span><span class="op" id="5901503">.</span><span class="ident" id="5901504">Pos</span><span class="op" id="5901507">(</span><span class="op" id="5901508">)</span><span class="op" id="5901509">)</span><span class="op" id="5901510">,</span>&nbsp;<span class="ident" id="5901512">vtab</span><span class="op" id="5901516">,</span>&nbsp;<span class="ident" id="5901518">d</span><span class="op" id="5901519">.</span><span class="ident" id="5901520">Body</span><span class="op" id="5901524">)</span><br>
<span class="lineno"></span><span class="op" id="5901526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5901529">func</span>&nbsp;<span class="op" id="5901534">(</span><span class="ident" id="5901535">p</span>&nbsp;<span class="op" id="5901537">*</span><span class="ident" id="5901538">printer</span><span class="op" id="5901545">)</span>&nbsp;<span class="ident" id="5901547">decl</span><span class="op" id="5901551">(</span><span class="ident" id="5901552">decl</span>&nbsp;<span class="ident" id="5901557">ast</span><span class="op" id="5901560">.</span><span class="ident" id="5901561">Decl</span><span class="op" id="5901565">)</span>&nbsp;<span class="op" id="5901567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5901570">switch</span>&nbsp;<span class="ident" id="5901577">d</span>&nbsp;<span class="op" id="5901579">:=</span>&nbsp;<span class="ident" id="5901582">decl</span><span class="op" id="5901586">.</span><span class="op" id="5901587">(</span><span class="keyword" id="5901588">type</span><span class="op" id="5901592">)</span>&nbsp;<span class="op" id="5901594">{</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5901597">case</span>&nbsp;<span class="op" id="5901602">*</span><span class="ident" id="5901603">ast</span><span class="op" id="5901606">.</span><span class="ident" id="5901607">BadDecl</span><span class="op" id="5901614">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901618">p</span><span class="op" id="5901619">.</span><span class="builtinfunc" id="5901620">print</span><span class="op" id="5901625">(</span><span class="ident" id="5901626">d</span><span class="op" id="5901627">.</span><span class="ident" id="5901628">Pos</span><span class="op" id="5901631">(</span><span class="op" id="5901632">)</span><span class="op" id="5901633">,</span>&nbsp;<span class="string" id="5901635">&#34;BadDecl&#34;</span><span class="op" id="5901644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5901647">case</span>&nbsp;<span class="op" id="5901652">*</span><span class="ident" id="5901653">ast</span><span class="op" id="5901656">.</span><span class="ident" id="5901657">GenDecl</span><span class="op" id="5901664">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901668">p</span><span class="op" id="5901669">.</span><span class="ident" id="5901670">genDecl</span><span class="op" id="5901677">(</span><span class="ident" id="5901678">d</span><span class="op" id="5901679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5901682">case</span>&nbsp;<span class="op" id="5901687">*</span><span class="ident" id="5901688">ast</span><span class="op" id="5901691">.</span><span class="ident" id="5901692">FuncDecl</span><span class="op" id="5901700">:</span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901704">p</span><span class="op" id="5901705">.</span><span class="ident" id="5901706">funcDecl</span><span class="op" id="5901714">(</span><span class="ident" id="5901715">d</span><span class="op" id="5901716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5901719">default</span><span class="op" id="5901726">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5901730">panic</span><span class="op" id="5901735">(</span><span class="string" id="5901736">&#34;unreachable&#34;</span><span class="op" id="5901749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5901752">}</span><br>
<span class="lineno"></span><span class="op" id="5901754">}</span><br>
<span class="lineno">1560</span><br>
<span class="lineno"></span><span class="comment" id="5901757">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5901837">//&nbsp;Files</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5901847">func</span>&nbsp;<span class="ident" id="5901852">declToken</span><span class="op" id="5901861">(</span><span class="ident" id="5901862">decl</span>&nbsp;<span class="ident" id="5901867">ast</span><span class="op" id="5901870">.</span><span class="ident" id="5901871">Decl</span><span class="op" id="5901875">)</span>&nbsp;<span class="op" id="5901877">(</span><span class="ident" id="5901878">tok</span>&nbsp;<span class="ident" id="5901882">token</span><span class="op" id="5901887">.</span><span class="ident" id="5901888">Token</span><span class="op" id="5901893">)</span>&nbsp;<span class="op" id="5901895">{</span><br>
<span class="lineno">1565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901898">tok</span>&nbsp;<span class="op" id="5901902">=</span>&nbsp;<span class="ident" id="5901904">token</span><span class="op" id="5901909">.</span><span class="ident" id="5901910">ILLEGAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5901919">switch</span>&nbsp;<span class="ident" id="5901926">d</span>&nbsp;<span class="op" id="5901928">:=</span>&nbsp;<span class="ident" id="5901931">decl</span><span class="op" id="5901935">.</span><span class="op" id="5901936">(</span><span class="keyword" id="5901937">type</span><span class="op" id="5901941">)</span>&nbsp;<span class="op" id="5901943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5901946">case</span>&nbsp;<span class="op" id="5901951">*</span><span class="ident" id="5901952">ast</span><span class="op" id="5901955">.</span><span class="ident" id="5901956">GenDecl</span><span class="op" id="5901963">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901967">tok</span>&nbsp;<span class="op" id="5901971">=</span>&nbsp;<span class="ident" id="5901973">d</span><span class="op" id="5901974">.</span><span class="ident" id="5901975">Tok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5901980">case</span>&nbsp;<span class="op" id="5901985">*</span><span class="ident" id="5901986">ast</span><span class="op" id="5901989">.</span><span class="ident" id="5901990">FuncDecl</span><span class="op" id="5901998">:</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5902002">tok</span>&nbsp;<span class="op" id="5902006">=</span>&nbsp;<span class="ident" id="5902008">token</span><span class="op" id="5902013">.</span><span class="ident" id="5902014">FUNC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5902020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5902023">return</span><br>
<span class="lineno"></span><span class="op" id="5902030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1575</span><span class="keyword" id="5902033">func</span>&nbsp;<span class="op" id="5902038">(</span><span class="ident" id="5902039">p</span>&nbsp;<span class="op" id="5902041">*</span><span class="ident" id="5902042">printer</span><span class="op" id="5902049">)</span>&nbsp;<span class="ident" id="5902051">declList</span><span class="op" id="5902059">(</span><span class="ident" id="5902060">list</span>&nbsp;<span class="op" id="5902065">[</span><span class="op" id="5902066">]</span><span class="ident" id="5902067">ast</span><span class="op" id="5902070">.</span><span class="ident" id="5902071">Decl</span><span class="op" id="5902075">)</span>&nbsp;<span class="op" id="5902077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5902080">tok</span>&nbsp;<span class="op" id="5902084">:=</span>&nbsp;<span class="ident" id="5902087">token</span><span class="op" id="5902092">.</span><span class="ident" id="5902093">ILLEGAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5902102">for</span>&nbsp;<span class="ident" id="5902106">_</span><span class="op" id="5902107">,</span>&nbsp;<span class="ident" id="5902109">d</span>&nbsp;<span class="op" id="5902111">:=</span>&nbsp;<span class="keyword" id="5902114">range</span>&nbsp;<span class="ident" id="5902120">list</span>&nbsp;<span class="op" id="5902125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5902129">prev</span>&nbsp;<span class="op" id="5902134">:=</span>&nbsp;<span class="ident" id="5902137">tok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5902143">tok</span>&nbsp;<span class="op" id="5902147">=</span>&nbsp;<span class="ident" id="5902149">declToken</span><span class="op" id="5902158">(</span><span class="ident" id="5902159">d</span><span class="op" id="5902160">)</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5902164">//&nbsp;If&nbsp;the&nbsp;declaration&nbsp;token&nbsp;changed&nbsp;(e.g.,&nbsp;from&nbsp;CONST&nbsp;to&nbsp;TYPE)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5902229">//&nbsp;or&nbsp;the&nbsp;next&nbsp;declaration&nbsp;has&nbsp;documentation&nbsp;associated&nbsp;with&nbsp;it,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5902296">//&nbsp;print&nbsp;an&nbsp;empty&nbsp;line&nbsp;between&nbsp;top-level&nbsp;declarations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5902353">//&nbsp;(because&nbsp;p.linebreak&nbsp;is&nbsp;called&nbsp;with&nbsp;the&nbsp;position&nbsp;of&nbsp;d,&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5902419">//&nbsp;is&nbsp;past&nbsp;any&nbsp;documentation,&nbsp;the&nbsp;minimum&nbsp;requirement&nbsp;is&nbsp;satisfied</span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5902488">//&nbsp;even&nbsp;w/o&nbsp;the&nbsp;extra&nbsp;getDoc(d)&nbsp;nil-check&nbsp;-&nbsp;leave&nbsp;it&nbsp;in&nbsp;case&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5902555">//&nbsp;linebreak&nbsp;logic&nbsp;improves&nbsp;-&nbsp;there&#39;s&nbsp;already&nbsp;a&nbsp;TODO).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5902612">if</span>&nbsp;<span class="builtinfunc" id="5902615">len</span><span class="op" id="5902618">(</span><span class="ident" id="5902619">p</span><span class="op" id="5902620">.</span><span class="ident" id="5902621">output</span><span class="op" id="5902627">)</span>&nbsp;<span class="op" id="5902629">&gt;</span>&nbsp;<span class="num" id="5902631">0</span>&nbsp;<span class="op" id="5902633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5902638">//&nbsp;only&nbsp;print&nbsp;line&nbsp;break&nbsp;if&nbsp;we&nbsp;are&nbsp;not&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5902711">//&nbsp;(i.e.,&nbsp;we&nbsp;are&nbsp;not&nbsp;printing&nbsp;only&nbsp;a&nbsp;partial&nbsp;program)</span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5902768">min</span>&nbsp;<span class="op" id="5902772">:=</span>&nbsp;<span class="num" id="5902775">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5902780">if</span>&nbsp;<span class="ident" id="5902783">prev</span>&nbsp;<span class="op" id="5902788">!=</span>&nbsp;<span class="ident" id="5902791">tok</span>&nbsp;<span class="op" id="5902795">||</span>&nbsp;<span class="ident" id="5902798">getDoc</span><span class="op" id="5902804">(</span><span class="ident" id="5902805">d</span><span class="op" id="5902806">)</span>&nbsp;<span class="op" id="5902808">!=</span>&nbsp;<span class="ident" id="5902811">nil</span>&nbsp;<span class="op" id="5902815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5902821">min</span>&nbsp;<span class="op" id="5902825">=</span>&nbsp;<span class="num" id="5902827">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5902832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5902837">p</span><span class="op" id="5902838">.</span><span class="ident" id="5902839">linebreak</span><span class="op" id="5902848">(</span><span class="ident" id="5902849">p</span><span class="op" id="5902850">.</span><span class="ident" id="5902851">lineFor</span><span class="op" id="5902858">(</span><span class="ident" id="5902859">d</span><span class="op" id="5902860">.</span><span class="ident" id="5902861">Pos</span><span class="op" id="5902864">(</span><span class="op" id="5902865">)</span><span class="op" id="5902866">)</span><span class="op" id="5902867">,</span>&nbsp;<span class="ident" id="5902869">min</span><span class="op" id="5902872">,</span>&nbsp;<span class="ident" id="5902874">ignore</span><span class="op" id="5902880">,</span>&nbsp;<span class="builtintype" id="5902882">false</span><span class="op" id="5902887">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5902891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5902895">p</span><span class="op" id="5902896">.</span><span class="ident" id="5902897">decl</span><span class="op" id="5902901">(</span><span class="ident" id="5902902">d</span><span class="op" id="5902903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5902906">}</span><br>
<span class="lineno"></span><span class="op" id="5902908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1600</span><span class="keyword" id="5902911">func</span>&nbsp;<span class="op" id="5902916">(</span><span class="ident" id="5902917">p</span>&nbsp;<span class="op" id="5902919">*</span><span class="ident" id="5902920">printer</span><span class="op" id="5902927">)</span>&nbsp;<span class="ident" id="5902929">file</span><span class="op" id="5902933">(</span><span class="ident" id="5902934">src</span>&nbsp;<span class="op" id="5902938">*</span><span class="ident" id="5902939">ast</span><span class="op" id="5902942">.</span><span class="ident" id="5902943">File</span><span class="op" id="5902947">)</span>&nbsp;<span class="op" id="5902949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5902952">p</span><span class="op" id="5902953">.</span><span class="ident" id="5902954">setComment</span><span class="op" id="5902964">(</span><span class="ident" id="5902965">src</span><span class="op" id="5902968">.</span><span class="ident" id="5902969">Doc</span><span class="op" id="5902972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5902975">p</span><span class="op" id="5902976">.</span><span class="builtinfunc" id="5902977">print</span><span class="op" id="5902982">(</span><span class="ident" id="5902983">src</span><span class="op" id="5902986">.</span><span class="ident" id="5902987">Pos</span><span class="op" id="5902990">(</span><span class="op" id="5902991">)</span><span class="op" id="5902992">,</span>&nbsp;<span class="ident" id="5902994">token</span><span class="op" id="5902999">.</span><span class="ident" id="5903000">PACKAGE</span><span class="op" id="5903007">,</span>&nbsp;<span class="ident" id="5903009">blank</span><span class="op" id="5903014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5903017">p</span><span class="op" id="5903018">.</span><span class="ident" id="5903019">expr</span><span class="op" id="5903023">(</span><span class="ident" id="5903024">src</span><span class="op" id="5903027">.</span><span class="ident" id="5903028">Name</span><span class="op" id="5903032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5903035">p</span><span class="op" id="5903036">.</span><span class="ident" id="5903037">declList</span><span class="op" id="5903045">(</span><span class="ident" id="5903046">src</span><span class="op" id="5903049">.</span><span class="ident" id="5903050">Decls</span><span class="op" id="5903055">)</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5903058">p</span><span class="op" id="5903059">.</span><span class="builtinfunc" id="5903060">print</span><span class="op" id="5903065">(</span><span class="ident" id="5903066">newline</span><span class="op" id="5903073">)</span><br>
<span class="lineno"></span><span class="op" id="5903075">}</span>
</div>
</body>
</html>
