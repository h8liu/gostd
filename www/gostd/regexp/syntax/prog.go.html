<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>regexp/syntax</h2>
<ul>
<li><a href="/gostd/regexp/syntax/compile.go.html">compile.go</a></li>
<li><a href="/gostd/regexp/syntax/doc.go.html">doc.go</a></li>
<li><a href="/gostd/regexp/syntax/parse.go.html">parse.go</a></li>
<li><a href="/gostd/regexp/syntax/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/regexp/syntax/perl_groups.go.html">perl_groups.go</a></li>
<li><a href="/gostd/regexp/syntax/prog.go.html" class="current">prog.go</a></li>
<li><a href="/gostd/regexp/syntax/prog_test.go.html">prog_test.go</a></li>
<li><a href="/gostd/regexp/syntax/regexp.go.html">regexp.go</a></li>
<li><a href="/gostd/regexp/syntax/simplify.go.html">simplify.go</a></li>
<li><a href="/gostd/regexp/syntax/simplify_test.go.html">simplify_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5388074">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5388129">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5388183">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5388234">package</span>&nbsp;<span class="ident" id="5388242">syntax</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5388250">import</span>&nbsp;<span class="op" id="5388257">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5388260">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5388269">&#34;strconv&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5388280">&#34;unicode&#34;</span><br>
<span class="lineno"></span><span class="op" id="5388290">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5388293">//&nbsp;Compiled&nbsp;program.</span><br>
<span class="lineno"></span><span class="comment" id="5388314">//&nbsp;May&nbsp;not&nbsp;belong&nbsp;in&nbsp;this&nbsp;package,&nbsp;but&nbsp;convenient&nbsp;for&nbsp;now.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="5388374">//&nbsp;A&nbsp;Prog&nbsp;is&nbsp;a&nbsp;compiled&nbsp;regular&nbsp;expression&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="5388426">type</span>&nbsp;<span class="ident" id="5388431">Prog</span>&nbsp;<span class="keyword" id="5388436">struct</span>&nbsp;<span class="op" id="5388443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388446">Inst</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5388453">[</span><span class="op" id="5388454">]</span><span class="ident" id="5388455">Inst</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388461">Start</span>&nbsp;&nbsp;<span class="builtintype" id="5388468">int</span>&nbsp;<span class="comment" id="5388472">//&nbsp;index&nbsp;of&nbsp;start&nbsp;instruction</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388503">NumCap</span>&nbsp;<span class="builtintype" id="5388510">int</span>&nbsp;<span class="comment" id="5388514">//&nbsp;number&nbsp;of&nbsp;InstCapture&nbsp;insts&nbsp;in&nbsp;re</span><br>
<span class="lineno"></span><span class="op" id="5388551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5388554">//&nbsp;An&nbsp;InstOp&nbsp;is&nbsp;an&nbsp;instruction&nbsp;opcode.</span><br>
<span class="lineno"></span><span class="keyword" id="5388593">type</span>&nbsp;<span class="ident" id="5388598">InstOp</span>&nbsp;<span class="builtintype" id="5388605">uint8</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="5388612">const</span>&nbsp;<span class="op" id="5388618">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388621">InstAlt</span>&nbsp;<span class="ident" id="5388629">InstOp</span>&nbsp;<span class="op" id="5388636">=</span>&nbsp;<span class="ident" id="5388638">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388644">InstAltMatch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388658">InstCapture</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388671">InstEmptyWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388687">InstMatch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388698">InstFail</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388708">InstNop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388717">InstRune</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388727">InstRune1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388738">InstRuneAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5388751">InstRuneAnyNotNL</span><br>
<span class="lineno"></span><span class="op" id="5388768">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="5388771">var</span>&nbsp;<span class="ident" id="5388775">instOpNames</span>&nbsp;<span class="op" id="5388787">=</span>&nbsp;<span class="op" id="5388789">[</span><span class="op" id="5388790">]</span><span class="builtintype" id="5388791">string</span><span class="op" id="5388797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5388800">&#34;InstAlt&#34;</span><span class="op" id="5388809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5388812">&#34;InstAltMatch&#34;</span><span class="op" id="5388826">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5388829">&#34;InstCapture&#34;</span><span class="op" id="5388842">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5388845">&#34;InstEmptyWidth&#34;</span><span class="op" id="5388861">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5388864">&#34;InstMatch&#34;</span><span class="op" id="5388875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5388878">&#34;InstFail&#34;</span><span class="op" id="5388888">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5388891">&#34;InstNop&#34;</span><span class="op" id="5388900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5388903">&#34;InstRune&#34;</span><span class="op" id="5388913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5388916">&#34;InstRune1&#34;</span><span class="op" id="5388927">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5388930">&#34;InstRuneAny&#34;</span><span class="op" id="5388943">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5388946">&#34;InstRuneAnyNotNL&#34;</span><span class="op" id="5388964">,</span><br>
<span class="lineno"></span><span class="op" id="5388966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5388969">func</span>&nbsp;<span class="op" id="5388974">(</span><span class="ident" id="5388975">i</span>&nbsp;<span class="ident" id="5388977">InstOp</span><span class="op" id="5388983">)</span>&nbsp;<span class="ident" id="5388985">String</span><span class="op" id="5388991">(</span><span class="op" id="5388992">)</span>&nbsp;<span class="builtintype" id="5388994">string</span>&nbsp;<span class="op" id="5389001">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5389004">if</span>&nbsp;<span class="builtintype" id="5389007">uint</span><span class="op" id="5389011">(</span><span class="ident" id="5389012">i</span><span class="op" id="5389013">)</span>&nbsp;<span class="op" id="5389015">&gt;=</span>&nbsp;<span class="builtintype" id="5389018">uint</span><span class="op" id="5389022">(</span><span class="builtinfunc" id="5389023">len</span><span class="op" id="5389026">(</span><span class="ident" id="5389027">instOpNames</span><span class="op" id="5389038">)</span><span class="op" id="5389039">)</span>&nbsp;<span class="op" id="5389041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5389045">return</span>&nbsp;<span class="string" id="5389052">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5389056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5389059">return</span>&nbsp;<span class="ident" id="5389066">instOpNames</span><span class="op" id="5389077">[</span><span class="ident" id="5389078">i</span><span class="op" id="5389079">]</span><br>
<span class="lineno"></span><span class="op" id="5389081">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="5389084">//&nbsp;An&nbsp;EmptyOp&nbsp;specifies&nbsp;a&nbsp;kind&nbsp;or&nbsp;mixture&nbsp;of&nbsp;zero-width&nbsp;assertions.</span><br>
<span class="lineno"></span><span class="keyword" id="5389152">type</span>&nbsp;<span class="ident" id="5389157">EmptyOp</span>&nbsp;<span class="builtintype" id="5389165">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5389172">const</span>&nbsp;<span class="op" id="5389178">(</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5389181">EmptyBeginLine</span>&nbsp;<span class="ident" id="5389196">EmptyOp</span>&nbsp;<span class="op" id="5389204">=</span>&nbsp;<span class="num" id="5389206">1</span>&nbsp;<span class="op" id="5389208">&lt;&lt;</span>&nbsp;<span class="ident" id="5389211">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5389217">EmptyEndLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5389231">EmptyBeginText</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5389247">EmptyEndText</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5389261">EmptyWordBoundary</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5389280">EmptyNoWordBoundary</span><br>
<span class="lineno"></span><span class="op" id="5389300">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5389303">//&nbsp;EmptyOpContext&nbsp;returns&nbsp;the&nbsp;zero-width&nbsp;assertions</span><br>
<span class="lineno"></span><span class="comment" id="5389355">//&nbsp;satisfied&nbsp;at&nbsp;the&nbsp;position&nbsp;between&nbsp;the&nbsp;runes&nbsp;r1&nbsp;and&nbsp;r2.</span><br>
<span class="lineno">75</span><span class="comment" id="5389413">//&nbsp;Passing&nbsp;r1&nbsp;==&nbsp;-1&nbsp;indicates&nbsp;that&nbsp;the&nbsp;position&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5389464">//&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="5389497">//&nbsp;Passing&nbsp;r2&nbsp;==&nbsp;-1&nbsp;indicates&nbsp;that&nbsp;the&nbsp;position&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5389548">//&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;text.</span><br>
<span class="lineno"></span><span class="keyword" id="5389575">func</span>&nbsp;<span class="ident" id="5389580">EmptyOpContext</span><span class="op" id="5389594">(</span><span class="ident" id="5389595">r1</span><span class="op" id="5389597">,</span>&nbsp;<span class="ident" id="5389599">r2</span>&nbsp;<span class="builtintype" id="5389602">rune</span><span class="op" id="5389606">)</span>&nbsp;<span class="ident" id="5389608">EmptyOp</span>&nbsp;<span class="op" id="5389616">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5389619">var</span>&nbsp;<span class="ident" id="5389623">op</span>&nbsp;<span class="ident" id="5389626">EmptyOp</span>&nbsp;<span class="op" id="5389634">=</span>&nbsp;<span class="ident" id="5389636">EmptyNoWordBoundary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5389657">var</span>&nbsp;<span class="ident" id="5389661">boundary</span>&nbsp;<span class="builtintype" id="5389670">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5389676">switch</span>&nbsp;<span class="op" id="5389683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5389686">case</span>&nbsp;<span class="ident" id="5389691">IsWordChar</span><span class="op" id="5389701">(</span><span class="ident" id="5389702">r1</span><span class="op" id="5389704">)</span><span class="op" id="5389705">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5389709">boundary</span>&nbsp;<span class="op" id="5389718">=</span>&nbsp;<span class="num" id="5389720">1</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5389723">case</span>&nbsp;<span class="ident" id="5389728">r1</span>&nbsp;<span class="op" id="5389731">==</span>&nbsp;<span class="string" id="5389734">&#39;\n&#39;</span><span class="op" id="5389738">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5389742">op</span>&nbsp;<span class="op" id="5389745">|=</span>&nbsp;<span class="ident" id="5389748">EmptyBeginLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5389764">case</span>&nbsp;<span class="ident" id="5389769">r1</span>&nbsp;<span class="op" id="5389772">&lt;</span>&nbsp;<span class="num" id="5389774">0</span><span class="op" id="5389775">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5389779">op</span>&nbsp;<span class="op" id="5389782">|=</span>&nbsp;<span class="ident" id="5389785">EmptyBeginText</span>&nbsp;<span class="op" id="5389800">|</span>&nbsp;<span class="ident" id="5389802">EmptyBeginLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5389818">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5389821">switch</span>&nbsp;<span class="op" id="5389828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5389831">case</span>&nbsp;<span class="ident" id="5389836">IsWordChar</span><span class="op" id="5389846">(</span><span class="ident" id="5389847">r2</span><span class="op" id="5389849">)</span><span class="op" id="5389850">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5389854">boundary</span>&nbsp;<span class="op" id="5389863">^=</span>&nbsp;<span class="num" id="5389866">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5389869">case</span>&nbsp;<span class="ident" id="5389874">r2</span>&nbsp;<span class="op" id="5389877">==</span>&nbsp;<span class="string" id="5389880">&#39;\n&#39;</span><span class="op" id="5389884">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5389888">op</span>&nbsp;<span class="op" id="5389891">|=</span>&nbsp;<span class="ident" id="5389894">EmptyEndLine</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5389908">case</span>&nbsp;<span class="ident" id="5389913">r2</span>&nbsp;<span class="op" id="5389916">&lt;</span>&nbsp;<span class="num" id="5389918">0</span><span class="op" id="5389919">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5389923">op</span>&nbsp;<span class="op" id="5389926">|=</span>&nbsp;<span class="ident" id="5389929">EmptyEndText</span>&nbsp;<span class="op" id="5389942">|</span>&nbsp;<span class="ident" id="5389944">EmptyEndLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5389958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5389961">if</span>&nbsp;<span class="ident" id="5389964">boundary</span>&nbsp;<span class="op" id="5389973">!=</span>&nbsp;<span class="num" id="5389976">0</span>&nbsp;<span class="op" id="5389978">{</span>&nbsp;<span class="comment" id="5389980">//&nbsp;IsWordChar(r1)&nbsp;!=&nbsp;IsWordChar(r2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5390018">op</span>&nbsp;<span class="op" id="5390021">^=</span>&nbsp;<span class="op" id="5390024">(</span><span class="ident" id="5390025">EmptyWordBoundary</span>&nbsp;<span class="op" id="5390043">|</span>&nbsp;<span class="ident" id="5390045">EmptyNoWordBoundary</span><span class="op" id="5390064">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5390067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390070">return</span>&nbsp;<span class="ident" id="5390077">op</span><br>
<span class="lineno"></span><span class="op" id="5390080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5390083">//&nbsp;IsWordChar&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;consider&nbsp;a&nbsp;``word&nbsp;character&#39;&#39;</span><br>
<span class="lineno">105</span><span class="comment" id="5390148">//&nbsp;during&nbsp;the&nbsp;evaluation&nbsp;of&nbsp;the&nbsp;\b&nbsp;and&nbsp;\B&nbsp;zero-width&nbsp;assertions.</span><br>
<span class="lineno"></span><span class="comment" id="5390213">//&nbsp;These&nbsp;assertions&nbsp;are&nbsp;ASCII-only:&nbsp;the&nbsp;word&nbsp;characters&nbsp;are&nbsp;[A-Za-z0-9_].</span><br>
<span class="lineno"></span><span class="keyword" id="5390287">func</span>&nbsp;<span class="ident" id="5390292">IsWordChar</span><span class="op" id="5390302">(</span><span class="ident" id="5390303">r</span>&nbsp;<span class="builtintype" id="5390305">rune</span><span class="op" id="5390309">)</span>&nbsp;<span class="builtintype" id="5390311">bool</span>&nbsp;<span class="op" id="5390316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390319">return</span>&nbsp;<span class="string" id="5390326">&#39;A&#39;</span>&nbsp;<span class="op" id="5390330">&lt;=</span>&nbsp;<span class="ident" id="5390333">r</span>&nbsp;<span class="op" id="5390335">&amp;&amp;</span>&nbsp;<span class="ident" id="5390338">r</span>&nbsp;<span class="op" id="5390340">&lt;=</span>&nbsp;<span class="string" id="5390343">&#39;Z&#39;</span>&nbsp;<span class="op" id="5390347">||</span>&nbsp;<span class="string" id="5390350">&#39;a&#39;</span>&nbsp;<span class="op" id="5390354">&lt;=</span>&nbsp;<span class="ident" id="5390357">r</span>&nbsp;<span class="op" id="5390359">&amp;&amp;</span>&nbsp;<span class="ident" id="5390362">r</span>&nbsp;<span class="op" id="5390364">&lt;=</span>&nbsp;<span class="string" id="5390367">&#39;z&#39;</span>&nbsp;<span class="op" id="5390371">||</span>&nbsp;<span class="string" id="5390374">&#39;0&#39;</span>&nbsp;<span class="op" id="5390378">&lt;=</span>&nbsp;<span class="ident" id="5390381">r</span>&nbsp;<span class="op" id="5390383">&amp;&amp;</span>&nbsp;<span class="ident" id="5390386">r</span>&nbsp;<span class="op" id="5390388">&lt;=</span>&nbsp;<span class="string" id="5390391">&#39;9&#39;</span>&nbsp;<span class="op" id="5390395">||</span>&nbsp;<span class="ident" id="5390398">r</span>&nbsp;<span class="op" id="5390400">==</span>&nbsp;<span class="string" id="5390403">&#39;_&#39;</span><br>
<span class="lineno"></span><span class="op" id="5390407">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="5390410">//&nbsp;An&nbsp;Inst&nbsp;is&nbsp;a&nbsp;single&nbsp;instruction&nbsp;in&nbsp;a&nbsp;regular&nbsp;expression&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="5390478">type</span>&nbsp;<span class="ident" id="5390483">Inst</span>&nbsp;<span class="keyword" id="5390488">struct</span>&nbsp;<span class="op" id="5390495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5390498">Op</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5390503">InstOp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5390511">Out</span>&nbsp;&nbsp;<span class="builtintype" id="5390516">uint32</span>&nbsp;<span class="comment" id="5390523">//&nbsp;all&nbsp;but&nbsp;InstMatch,&nbsp;InstFail</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5390555">Arg</span>&nbsp;&nbsp;<span class="builtintype" id="5390560">uint32</span>&nbsp;<span class="comment" id="5390567">//&nbsp;InstAlt,&nbsp;InstAltMatch,&nbsp;InstCapture,&nbsp;InstEmptyWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5390622">Rune</span>&nbsp;<span class="op" id="5390627">[</span><span class="op" id="5390628">]</span><span class="builtintype" id="5390629">rune</span><br>
<span class="lineno"></span><span class="op" id="5390634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5390637">func</span>&nbsp;<span class="op" id="5390642">(</span><span class="ident" id="5390643">p</span>&nbsp;<span class="op" id="5390645">*</span><span class="ident" id="5390646">Prog</span><span class="op" id="5390650">)</span>&nbsp;<span class="ident" id="5390652">String</span><span class="op" id="5390658">(</span><span class="op" id="5390659">)</span>&nbsp;<span class="builtintype" id="5390661">string</span>&nbsp;<span class="op" id="5390668">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390671">var</span>&nbsp;<span class="ident" id="5390675">b</span>&nbsp;<span class="ident" id="5390677">bytes</span><span class="op" id="5390682">.</span><span class="ident" id="5390683">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5390691">dumpProg</span><span class="op" id="5390699">(</span><span class="op" id="5390700">&amp;</span><span class="ident" id="5390701">b</span><span class="op" id="5390702">,</span>&nbsp;<span class="ident" id="5390704">p</span><span class="op" id="5390705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390708">return</span>&nbsp;<span class="ident" id="5390715">b</span><span class="op" id="5390716">.</span><span class="ident" id="5390717">String</span><span class="op" id="5390723">(</span><span class="op" id="5390724">)</span><br>
<span class="lineno"></span><span class="op" id="5390726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="5390729">//&nbsp;skipNop&nbsp;follows&nbsp;any&nbsp;no-op&nbsp;or&nbsp;capturing&nbsp;instructions</span><br>
<span class="lineno"></span><span class="comment" id="5390784">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;pc.</span><br>
<span class="lineno"></span><span class="keyword" id="5390817">func</span>&nbsp;<span class="op" id="5390822">(</span><span class="ident" id="5390823">p</span>&nbsp;<span class="op" id="5390825">*</span><span class="ident" id="5390826">Prog</span><span class="op" id="5390830">)</span>&nbsp;<span class="ident" id="5390832">skipNop</span><span class="op" id="5390839">(</span><span class="ident" id="5390840">pc</span>&nbsp;<span class="builtintype" id="5390843">uint32</span><span class="op" id="5390849">)</span>&nbsp;<span class="op" id="5390851">(</span><span class="op" id="5390852">*</span><span class="ident" id="5390853">Inst</span><span class="op" id="5390857">,</span>&nbsp;<span class="builtintype" id="5390859">uint32</span><span class="op" id="5390865">)</span>&nbsp;<span class="op" id="5390867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5390870">i</span>&nbsp;<span class="op" id="5390872">:=</span>&nbsp;<span class="op" id="5390875">&amp;</span><span class="ident" id="5390876">p</span><span class="op" id="5390877">.</span><span class="ident" id="5390878">Inst</span><span class="op" id="5390882">[</span><span class="ident" id="5390883">pc</span><span class="op" id="5390885">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390888">for</span>&nbsp;<span class="ident" id="5390892">i</span><span class="op" id="5390893">.</span><span class="ident" id="5390894">Op</span>&nbsp;<span class="op" id="5390897">==</span>&nbsp;<span class="ident" id="5390900">InstNop</span>&nbsp;<span class="op" id="5390908">||</span>&nbsp;<span class="ident" id="5390911">i</span><span class="op" id="5390912">.</span><span class="ident" id="5390913">Op</span>&nbsp;<span class="op" id="5390916">==</span>&nbsp;<span class="ident" id="5390919">InstCapture</span>&nbsp;<span class="op" id="5390931">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5390935">pc</span>&nbsp;<span class="op" id="5390938">=</span>&nbsp;<span class="ident" id="5390940">i</span><span class="op" id="5390941">.</span><span class="ident" id="5390942">Out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5390948">i</span>&nbsp;<span class="op" id="5390950">=</span>&nbsp;<span class="op" id="5390952">&amp;</span><span class="ident" id="5390953">p</span><span class="op" id="5390954">.</span><span class="ident" id="5390955">Inst</span><span class="op" id="5390959">[</span><span class="ident" id="5390960">pc</span><span class="op" id="5390962">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5390965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390968">return</span>&nbsp;<span class="ident" id="5390975">i</span><span class="op" id="5390976">,</span>&nbsp;<span class="ident" id="5390978">pc</span><br>
<span class="lineno"></span><span class="op" id="5390981">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="5390984">//&nbsp;op&nbsp;returns&nbsp;i.Op&nbsp;but&nbsp;merges&nbsp;all&nbsp;the&nbsp;Rune&nbsp;special&nbsp;cases&nbsp;into&nbsp;InstRune</span><br>
<span class="lineno"></span><span class="keyword" id="5391055">func</span>&nbsp;<span class="op" id="5391060">(</span><span class="ident" id="5391061">i</span>&nbsp;<span class="op" id="5391063">*</span><span class="ident" id="5391064">Inst</span><span class="op" id="5391068">)</span>&nbsp;<span class="ident" id="5391070">op</span><span class="op" id="5391072">(</span><span class="op" id="5391073">)</span>&nbsp;<span class="ident" id="5391075">InstOp</span>&nbsp;<span class="op" id="5391082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5391085">op</span>&nbsp;<span class="op" id="5391088">:=</span>&nbsp;<span class="ident" id="5391091">i</span><span class="op" id="5391092">.</span><span class="ident" id="5391093">Op</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5391097">switch</span>&nbsp;<span class="ident" id="5391104">op</span>&nbsp;<span class="op" id="5391107">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5391110">case</span>&nbsp;<span class="ident" id="5391115">InstRune1</span><span class="op" id="5391124">,</span>&nbsp;<span class="ident" id="5391126">InstRuneAny</span><span class="op" id="5391137">,</span>&nbsp;<span class="ident" id="5391139">InstRuneAnyNotNL</span><span class="op" id="5391155">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5391159">op</span>&nbsp;<span class="op" id="5391162">=</span>&nbsp;<span class="ident" id="5391164">InstRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5391174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5391177">return</span>&nbsp;<span class="ident" id="5391184">op</span><br>
<span class="lineno"></span><span class="op" id="5391187">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="5391190">//&nbsp;Prefix&nbsp;returns&nbsp;a&nbsp;literal&nbsp;string&nbsp;that&nbsp;all&nbsp;matches&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5391250">//&nbsp;regexp&nbsp;must&nbsp;start&nbsp;with.&nbsp;&nbsp;Complete&nbsp;is&nbsp;true&nbsp;if&nbsp;the&nbsp;prefix</span><br>
<span class="lineno"></span><span class="comment" id="5391309">//&nbsp;is&nbsp;the&nbsp;entire&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5391333">func</span>&nbsp;<span class="op" id="5391338">(</span><span class="ident" id="5391339">p</span>&nbsp;<span class="op" id="5391341">*</span><span class="ident" id="5391342">Prog</span><span class="op" id="5391346">)</span>&nbsp;<span class="ident" id="5391348">Prefix</span><span class="op" id="5391354">(</span><span class="op" id="5391355">)</span>&nbsp;<span class="op" id="5391357">(</span><span class="ident" id="5391358">prefix</span>&nbsp;<span class="builtintype" id="5391365">string</span><span class="op" id="5391371">,</span>&nbsp;<span class="ident" id="5391373">complete</span>&nbsp;<span class="builtintype" id="5391382">bool</span><span class="op" id="5391386">)</span>&nbsp;<span class="op" id="5391388">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5391391">i</span><span class="op" id="5391392">,</span>&nbsp;<span class="ident" id="5391394">_</span>&nbsp;<span class="op" id="5391396">:=</span>&nbsp;<span class="ident" id="5391399">p</span><span class="op" id="5391400">.</span><span class="ident" id="5391401">skipNop</span><span class="op" id="5391408">(</span><span class="builtintype" id="5391409">uint32</span><span class="op" id="5391415">(</span><span class="ident" id="5391416">p</span><span class="op" id="5391417">.</span><span class="ident" id="5391418">Start</span><span class="op" id="5391423">)</span><span class="op" id="5391424">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5391428">//&nbsp;Avoid&nbsp;allocation&nbsp;of&nbsp;buffer&nbsp;if&nbsp;prefix&nbsp;is&nbsp;empty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5391479">if</span>&nbsp;<span class="ident" id="5391482">i</span><span class="op" id="5391483">.</span><span class="ident" id="5391484">op</span><span class="op" id="5391486">(</span><span class="op" id="5391487">)</span>&nbsp;<span class="op" id="5391489">!=</span>&nbsp;<span class="ident" id="5391492">InstRune</span>&nbsp;<span class="op" id="5391501">||</span>&nbsp;<span class="builtinfunc" id="5391504">len</span><span class="op" id="5391507">(</span><span class="ident" id="5391508">i</span><span class="op" id="5391509">.</span><span class="ident" id="5391510">Rune</span><span class="op" id="5391514">)</span>&nbsp;<span class="op" id="5391516">!=</span>&nbsp;<span class="num" id="5391519">1</span>&nbsp;<span class="op" id="5391521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5391525">return</span>&nbsp;<span class="string" id="5391532">&#34;&#34;</span><span class="op" id="5391534">,</span>&nbsp;<span class="ident" id="5391536">i</span><span class="op" id="5391537">.</span><span class="ident" id="5391538">Op</span>&nbsp;<span class="op" id="5391541">==</span>&nbsp;<span class="ident" id="5391544">InstMatch</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5391555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5391559">//&nbsp;Have&nbsp;prefix;&nbsp;gather&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5391595">var</span>&nbsp;<span class="ident" id="5391599">buf</span>&nbsp;<span class="ident" id="5391603">bytes</span><span class="op" id="5391608">.</span><span class="ident" id="5391609">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5391617">for</span>&nbsp;<span class="ident" id="5391621">i</span><span class="op" id="5391622">.</span><span class="ident" id="5391623">op</span><span class="op" id="5391625">(</span><span class="op" id="5391626">)</span>&nbsp;<span class="op" id="5391628">==</span>&nbsp;<span class="ident" id="5391631">InstRune</span>&nbsp;<span class="op" id="5391640">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5391643">len</span><span class="op" id="5391646">(</span><span class="ident" id="5391647">i</span><span class="op" id="5391648">.</span><span class="ident" id="5391649">Rune</span><span class="op" id="5391653">)</span>&nbsp;<span class="op" id="5391655">==</span>&nbsp;<span class="num" id="5391658">1</span>&nbsp;<span class="op" id="5391660">&amp;&amp;</span>&nbsp;<span class="ident" id="5391663">Flags</span><span class="op" id="5391668">(</span><span class="ident" id="5391669">i</span><span class="op" id="5391670">.</span><span class="ident" id="5391671">Arg</span><span class="op" id="5391674">)</span><span class="op" id="5391675">&amp;</span><span class="ident" id="5391676">FoldCase</span>&nbsp;<span class="op" id="5391685">==</span>&nbsp;<span class="num" id="5391688">0</span>&nbsp;<span class="op" id="5391690">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5391694">buf</span><span class="op" id="5391697">.</span><span class="ident" id="5391698">WriteRune</span><span class="op" id="5391707">(</span><span class="ident" id="5391708">i</span><span class="op" id="5391709">.</span><span class="ident" id="5391710">Rune</span><span class="op" id="5391714">[</span><span class="num" id="5391715">0</span><span class="op" id="5391716">]</span><span class="op" id="5391717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5391721">i</span><span class="op" id="5391722">,</span>&nbsp;<span class="ident" id="5391724">_</span>&nbsp;<span class="op" id="5391726">=</span>&nbsp;<span class="ident" id="5391728">p</span><span class="op" id="5391729">.</span><span class="ident" id="5391730">skipNop</span><span class="op" id="5391737">(</span><span class="ident" id="5391738">i</span><span class="op" id="5391739">.</span><span class="ident" id="5391740">Out</span><span class="op" id="5391743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5391746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5391749">return</span>&nbsp;<span class="ident" id="5391756">buf</span><span class="op" id="5391759">.</span><span class="ident" id="5391760">String</span><span class="op" id="5391766">(</span><span class="op" id="5391767">)</span><span class="op" id="5391768">,</span>&nbsp;<span class="ident" id="5391770">i</span><span class="op" id="5391771">.</span><span class="ident" id="5391772">Op</span>&nbsp;<span class="op" id="5391775">==</span>&nbsp;<span class="ident" id="5391778">InstMatch</span><br>
<span class="lineno"></span><span class="op" id="5391788">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="5391791">//&nbsp;StartCond&nbsp;returns&nbsp;the&nbsp;leading&nbsp;empty-width&nbsp;conditions&nbsp;that&nbsp;must</span><br>
<span class="lineno"></span><span class="comment" id="5391857">//&nbsp;be&nbsp;true&nbsp;in&nbsp;any&nbsp;match.&nbsp;&nbsp;It&nbsp;returns&nbsp;^EmptyOp(0)&nbsp;if&nbsp;no&nbsp;matches&nbsp;are&nbsp;possible.</span><br>
<span class="lineno"></span><span class="keyword" id="5391934">func</span>&nbsp;<span class="op" id="5391939">(</span><span class="ident" id="5391940">p</span>&nbsp;<span class="op" id="5391942">*</span><span class="ident" id="5391943">Prog</span><span class="op" id="5391947">)</span>&nbsp;<span class="ident" id="5391949">StartCond</span><span class="op" id="5391958">(</span><span class="op" id="5391959">)</span>&nbsp;<span class="ident" id="5391961">EmptyOp</span>&nbsp;<span class="op" id="5391969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5391972">var</span>&nbsp;<span class="ident" id="5391976">flag</span>&nbsp;<span class="ident" id="5391981">EmptyOp</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5391990">pc</span>&nbsp;<span class="op" id="5391993">:=</span>&nbsp;<span class="builtintype" id="5391996">uint32</span><span class="op" id="5392002">(</span><span class="ident" id="5392003">p</span><span class="op" id="5392004">.</span><span class="ident" id="5392005">Start</span><span class="op" id="5392010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5392013">i</span>&nbsp;<span class="op" id="5392015">:=</span>&nbsp;<span class="op" id="5392018">&amp;</span><span class="ident" id="5392019">p</span><span class="op" id="5392020">.</span><span class="ident" id="5392021">Inst</span><span class="op" id="5392025">[</span><span class="ident" id="5392026">pc</span><span class="op" id="5392028">]</span><br>
<span class="lineno"></span><span class="ident" id="5392030">Loop</span><span class="op" id="5392034">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392037">for</span>&nbsp;<span class="op" id="5392041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392045">switch</span>&nbsp;<span class="ident" id="5392052">i</span><span class="op" id="5392053">.</span><span class="ident" id="5392054">Op</span>&nbsp;<span class="op" id="5392057">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392061">case</span>&nbsp;<span class="ident" id="5392066">InstEmptyWidth</span><span class="op" id="5392080">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5392085">flag</span>&nbsp;<span class="op" id="5392090">|=</span>&nbsp;<span class="ident" id="5392093">EmptyOp</span><span class="op" id="5392100">(</span><span class="ident" id="5392101">i</span><span class="op" id="5392102">.</span><span class="ident" id="5392103">Arg</span><span class="op" id="5392106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392110">case</span>&nbsp;<span class="ident" id="5392115">InstFail</span><span class="op" id="5392123">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392128">return</span>&nbsp;<span class="op" id="5392135">^</span><span class="ident" id="5392136">EmptyOp</span><span class="op" id="5392143">(</span><span class="num" id="5392144">0</span><span class="op" id="5392145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392149">case</span>&nbsp;<span class="ident" id="5392154">InstCapture</span><span class="op" id="5392165">,</span>&nbsp;<span class="ident" id="5392167">InstNop</span><span class="op" id="5392174">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5392179">//&nbsp;skip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392189">default</span><span class="op" id="5392196">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392201">break</span>&nbsp;<span class="ident" id="5392207">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5392214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5392218">pc</span>&nbsp;<span class="op" id="5392221">=</span>&nbsp;<span class="ident" id="5392223">i</span><span class="op" id="5392224">.</span><span class="ident" id="5392225">Out</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5392231">i</span>&nbsp;<span class="op" id="5392233">=</span>&nbsp;<span class="op" id="5392235">&amp;</span><span class="ident" id="5392236">p</span><span class="op" id="5392237">.</span><span class="ident" id="5392238">Inst</span><span class="op" id="5392242">[</span><span class="ident" id="5392243">pc</span><span class="op" id="5392245">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5392248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392251">return</span>&nbsp;<span class="ident" id="5392258">flag</span><br>
<span class="lineno"></span><span class="op" id="5392263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="5392266">const</span>&nbsp;<span class="ident" id="5392272">noMatch</span>&nbsp;<span class="op" id="5392280">=</span>&nbsp;<span class="op" id="5392282">-</span><span class="num" id="5392283">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5392286">//&nbsp;MatchRune&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;instruction&nbsp;matches&nbsp;(and&nbsp;consumes)&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="5392357">//&nbsp;It&nbsp;should&nbsp;only&nbsp;be&nbsp;called&nbsp;when&nbsp;i.Op&nbsp;==&nbsp;InstRune.</span><br>
<span class="lineno"></span><span class="keyword" id="5392408">func</span>&nbsp;<span class="op" id="5392413">(</span><span class="ident" id="5392414">i</span>&nbsp;<span class="op" id="5392416">*</span><span class="ident" id="5392417">Inst</span><span class="op" id="5392421">)</span>&nbsp;<span class="ident" id="5392423">MatchRune</span><span class="op" id="5392432">(</span><span class="ident" id="5392433">r</span>&nbsp;<span class="builtintype" id="5392435">rune</span><span class="op" id="5392439">)</span>&nbsp;<span class="builtintype" id="5392441">bool</span>&nbsp;<span class="op" id="5392446">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392449">return</span>&nbsp;<span class="ident" id="5392456">i</span><span class="op" id="5392457">.</span><span class="ident" id="5392458">MatchRunePos</span><span class="op" id="5392470">(</span><span class="ident" id="5392471">r</span><span class="op" id="5392472">)</span>&nbsp;<span class="op" id="5392474">!=</span>&nbsp;<span class="ident" id="5392477">noMatch</span><br>
<span class="lineno"></span><span class="op" id="5392485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5392488">//&nbsp;MatchRunePos&nbsp;checks&nbsp;whether&nbsp;the&nbsp;instruction&nbsp;matches&nbsp;(and&nbsp;consumes)&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="5392561">//&nbsp;If&nbsp;so,&nbsp;MatchRunePos&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;matching&nbsp;rune&nbsp;pair</span><br>
<span class="lineno">200</span><span class="comment" id="5392628">//&nbsp;(or,&nbsp;when&nbsp;len(i.Rune)&nbsp;==&nbsp;1,&nbsp;rune&nbsp;singleton).</span><br>
<span class="lineno"></span><span class="comment" id="5392676">//&nbsp;If&nbsp;not,&nbsp;MatchRunePos&nbsp;returns&nbsp;-1.</span><br>
<span class="lineno"></span><span class="comment" id="5392712">//&nbsp;MatchRunePos&nbsp;should&nbsp;only&nbsp;be&nbsp;called&nbsp;when&nbsp;i.Op&nbsp;==&nbsp;InstRune.</span><br>
<span class="lineno"></span><span class="keyword" id="5392773">func</span>&nbsp;<span class="op" id="5392778">(</span><span class="ident" id="5392779">i</span>&nbsp;<span class="op" id="5392781">*</span><span class="ident" id="5392782">Inst</span><span class="op" id="5392786">)</span>&nbsp;<span class="ident" id="5392788">MatchRunePos</span><span class="op" id="5392800">(</span><span class="ident" id="5392801">r</span>&nbsp;<span class="builtintype" id="5392803">rune</span><span class="op" id="5392807">)</span>&nbsp;<span class="builtintype" id="5392809">int</span>&nbsp;<span class="op" id="5392813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5392816">rune</span>&nbsp;<span class="op" id="5392821">:=</span>&nbsp;<span class="ident" id="5392824">i</span><span class="op" id="5392825">.</span><span class="ident" id="5392826">Rune</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5392833">//&nbsp;Special&nbsp;case:&nbsp;single-rune&nbsp;slice&nbsp;is&nbsp;from&nbsp;literal&nbsp;string,&nbsp;not&nbsp;char&nbsp;class.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392909">if</span>&nbsp;<span class="builtinfunc" id="5392912">len</span><span class="op" id="5392915">(</span><span class="builtintype" id="5392916">rune</span><span class="op" id="5392920">)</span>&nbsp;<span class="op" id="5392922">==</span>&nbsp;<span class="num" id="5392925">1</span>&nbsp;<span class="op" id="5392927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5392931">r0</span>&nbsp;<span class="op" id="5392934">:=</span>&nbsp;<span class="builtintype" id="5392937">rune</span><span class="op" id="5392941">[</span><span class="num" id="5392942">0</span><span class="op" id="5392943">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392947">if</span>&nbsp;<span class="ident" id="5392950">r</span>&nbsp;<span class="op" id="5392952">==</span>&nbsp;<span class="ident" id="5392955">r0</span>&nbsp;<span class="op" id="5392958">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392963">return</span>&nbsp;<span class="num" id="5392970">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5392974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5392978">if</span>&nbsp;<span class="ident" id="5392981">Flags</span><span class="op" id="5392986">(</span><span class="ident" id="5392987">i</span><span class="op" id="5392988">.</span><span class="ident" id="5392989">Arg</span><span class="op" id="5392992">)</span><span class="op" id="5392993">&amp;</span><span class="ident" id="5392994">FoldCase</span>&nbsp;<span class="op" id="5393003">!=</span>&nbsp;<span class="num" id="5393006">0</span>&nbsp;<span class="op" id="5393008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393013">for</span>&nbsp;<span class="ident" id="5393017">r1</span>&nbsp;<span class="op" id="5393020">:=</span>&nbsp;<span class="ident" id="5393023">unicode</span><span class="op" id="5393030">.</span><span class="ident" id="5393031">SimpleFold</span><span class="op" id="5393041">(</span><span class="ident" id="5393042">r0</span><span class="op" id="5393044">)</span><span class="op" id="5393045">;</span>&nbsp;<span class="ident" id="5393047">r1</span>&nbsp;<span class="op" id="5393050">!=</span>&nbsp;<span class="ident" id="5393053">r0</span><span class="op" id="5393055">;</span>&nbsp;<span class="ident" id="5393057">r1</span>&nbsp;<span class="op" id="5393060">=</span>&nbsp;<span class="ident" id="5393062">unicode</span><span class="op" id="5393069">.</span><span class="ident" id="5393070">SimpleFold</span><span class="op" id="5393080">(</span><span class="ident" id="5393081">r1</span><span class="op" id="5393083">)</span>&nbsp;<span class="op" id="5393085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393091">if</span>&nbsp;<span class="ident" id="5393094">r</span>&nbsp;<span class="op" id="5393096">==</span>&nbsp;<span class="ident" id="5393099">r1</span>&nbsp;<span class="op" id="5393102">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393109">return</span>&nbsp;<span class="num" id="5393116">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5393122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5393127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5393131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393135">return</span>&nbsp;<span class="ident" id="5393142">noMatch</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5393151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5393155">//&nbsp;Peek&nbsp;at&nbsp;the&nbsp;first&nbsp;few&nbsp;pairs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5393188">//&nbsp;Should&nbsp;handle&nbsp;ASCII&nbsp;well.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393218">for</span>&nbsp;<span class="ident" id="5393222">j</span>&nbsp;<span class="op" id="5393224">:=</span>&nbsp;<span class="num" id="5393227">0</span><span class="op" id="5393228">;</span>&nbsp;<span class="ident" id="5393230">j</span>&nbsp;<span class="op" id="5393232">&lt;</span>&nbsp;<span class="builtinfunc" id="5393234">len</span><span class="op" id="5393237">(</span><span class="builtintype" id="5393238">rune</span><span class="op" id="5393242">)</span>&nbsp;<span class="op" id="5393244">&amp;&amp;</span>&nbsp;<span class="ident" id="5393247">j</span>&nbsp;<span class="op" id="5393249">&lt;=</span>&nbsp;<span class="num" id="5393252">8</span><span class="op" id="5393253">;</span>&nbsp;<span class="ident" id="5393255">j</span>&nbsp;<span class="op" id="5393257">+=</span>&nbsp;<span class="num" id="5393260">2</span>&nbsp;<span class="op" id="5393262">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393266">if</span>&nbsp;<span class="ident" id="5393269">r</span>&nbsp;<span class="op" id="5393271">&lt;</span>&nbsp;<span class="builtintype" id="5393273">rune</span><span class="op" id="5393277">[</span><span class="ident" id="5393278">j</span><span class="op" id="5393279">]</span>&nbsp;<span class="op" id="5393281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393286">return</span>&nbsp;<span class="ident" id="5393293">noMatch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5393303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393307">if</span>&nbsp;<span class="ident" id="5393310">r</span>&nbsp;<span class="op" id="5393312">&lt;=</span>&nbsp;<span class="builtintype" id="5393315">rune</span><span class="op" id="5393319">[</span><span class="ident" id="5393320">j</span><span class="op" id="5393321">+</span><span class="num" id="5393322">1</span><span class="op" id="5393323">]</span>&nbsp;<span class="op" id="5393325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393330">return</span>&nbsp;<span class="ident" id="5393337">j</span>&nbsp;<span class="op" id="5393339">/</span>&nbsp;<span class="num" id="5393341">2</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5393345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5393348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5393352">//&nbsp;Otherwise&nbsp;binary&nbsp;search.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393381">lo</span>&nbsp;<span class="op" id="5393384">:=</span>&nbsp;<span class="num" id="5393387">0</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393390">hi</span>&nbsp;<span class="op" id="5393393">:=</span>&nbsp;<span class="builtinfunc" id="5393396">len</span><span class="op" id="5393399">(</span><span class="builtintype" id="5393400">rune</span><span class="op" id="5393404">)</span>&nbsp;<span class="op" id="5393406">/</span>&nbsp;<span class="num" id="5393408">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393411">for</span>&nbsp;<span class="ident" id="5393415">lo</span>&nbsp;<span class="op" id="5393418">&lt;</span>&nbsp;<span class="ident" id="5393420">hi</span>&nbsp;<span class="op" id="5393423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393427">m</span>&nbsp;<span class="op" id="5393429">:=</span>&nbsp;<span class="ident" id="5393432">lo</span>&nbsp;<span class="op" id="5393435">+</span>&nbsp;<span class="op" id="5393437">(</span><span class="ident" id="5393438">hi</span><span class="op" id="5393440">-</span><span class="ident" id="5393441">lo</span><span class="op" id="5393443">)</span><span class="op" id="5393444">/</span><span class="num" id="5393445">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393449">if</span>&nbsp;<span class="ident" id="5393452">c</span>&nbsp;<span class="op" id="5393454">:=</span>&nbsp;<span class="builtintype" id="5393457">rune</span><span class="op" id="5393461">[</span><span class="num" id="5393462">2</span><span class="op" id="5393463">*</span><span class="ident" id="5393464">m</span><span class="op" id="5393465">]</span><span class="op" id="5393466">;</span>&nbsp;<span class="ident" id="5393468">c</span>&nbsp;<span class="op" id="5393470">&lt;=</span>&nbsp;<span class="ident" id="5393473">r</span>&nbsp;<span class="op" id="5393475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393480">if</span>&nbsp;<span class="ident" id="5393483">r</span>&nbsp;<span class="op" id="5393485">&lt;=</span>&nbsp;<span class="builtintype" id="5393488">rune</span><span class="op" id="5393492">[</span><span class="num" id="5393493">2</span><span class="op" id="5393494">*</span><span class="ident" id="5393495">m</span><span class="op" id="5393496">+</span><span class="num" id="5393497">1</span><span class="op" id="5393498">]</span>&nbsp;<span class="op" id="5393500">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393506">return</span>&nbsp;<span class="ident" id="5393513">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5393518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393523">lo</span>&nbsp;<span class="op" id="5393526">=</span>&nbsp;<span class="ident" id="5393528">m</span>&nbsp;<span class="op" id="5393530">+</span>&nbsp;<span class="num" id="5393532">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5393536">}</span>&nbsp;<span class="keyword" id="5393538">else</span>&nbsp;<span class="op" id="5393543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393548">hi</span>&nbsp;<span class="op" id="5393551">=</span>&nbsp;<span class="ident" id="5393553">m</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5393557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5393560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393563">return</span>&nbsp;<span class="ident" id="5393570">noMatch</span><br>
<span class="lineno"></span><span class="op" id="5393578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="5393581">//&nbsp;As&nbsp;per&nbsp;re2&#39;s&nbsp;Prog::IsWordChar.&nbsp;Determines&nbsp;whether&nbsp;rune&nbsp;is&nbsp;an&nbsp;ASCII&nbsp;word&nbsp;char.</span><br>
<span class="lineno"></span><span class="comment" id="5393662">//&nbsp;Since&nbsp;we&nbsp;act&nbsp;on&nbsp;runes,&nbsp;it&nbsp;would&nbsp;be&nbsp;easy&nbsp;to&nbsp;support&nbsp;Unicode&nbsp;here.</span><br>
<span class="lineno"></span><span class="keyword" id="5393730">func</span>&nbsp;<span class="ident" id="5393735">wordRune</span><span class="op" id="5393743">(</span><span class="ident" id="5393744">r</span>&nbsp;<span class="builtintype" id="5393746">rune</span><span class="op" id="5393750">)</span>&nbsp;<span class="builtintype" id="5393752">bool</span>&nbsp;<span class="op" id="5393757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5393760">return</span>&nbsp;<span class="ident" id="5393767">r</span>&nbsp;<span class="op" id="5393769">==</span>&nbsp;<span class="string" id="5393772">&#39;_&#39;</span>&nbsp;<span class="op" id="5393776">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5393781">(</span><span class="string" id="5393782">&#39;A&#39;</span>&nbsp;<span class="op" id="5393786">&lt;=</span>&nbsp;<span class="ident" id="5393789">r</span>&nbsp;<span class="op" id="5393791">&amp;&amp;</span>&nbsp;<span class="ident" id="5393794">r</span>&nbsp;<span class="op" id="5393796">&lt;=</span>&nbsp;<span class="string" id="5393799">&#39;Z&#39;</span><span class="op" id="5393802">)</span>&nbsp;<span class="op" id="5393804">||</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5393809">(</span><span class="string" id="5393810">&#39;a&#39;</span>&nbsp;<span class="op" id="5393814">&lt;=</span>&nbsp;<span class="ident" id="5393817">r</span>&nbsp;<span class="op" id="5393819">&amp;&amp;</span>&nbsp;<span class="ident" id="5393822">r</span>&nbsp;<span class="op" id="5393824">&lt;=</span>&nbsp;<span class="string" id="5393827">&#39;z&#39;</span><span class="op" id="5393830">)</span>&nbsp;<span class="op" id="5393832">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5393837">(</span><span class="string" id="5393838">&#39;0&#39;</span>&nbsp;<span class="op" id="5393842">&lt;=</span>&nbsp;<span class="ident" id="5393845">r</span>&nbsp;<span class="op" id="5393847">&amp;&amp;</span>&nbsp;<span class="ident" id="5393850">r</span>&nbsp;<span class="op" id="5393852">&lt;=</span>&nbsp;<span class="string" id="5393855">&#39;9&#39;</span><span class="op" id="5393858">)</span><br>
<span class="lineno"></span><span class="op" id="5393860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5393863">//&nbsp;MatchEmptyWidth&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;instruction&nbsp;matches</span><br>
<span class="lineno">260</span><span class="comment" id="5393922">//&nbsp;an&nbsp;empty&nbsp;string&nbsp;between&nbsp;the&nbsp;runes&nbsp;before&nbsp;and&nbsp;after.</span><br>
<span class="lineno"></span><span class="comment" id="5393977">//&nbsp;It&nbsp;should&nbsp;only&nbsp;be&nbsp;called&nbsp;when&nbsp;i.Op&nbsp;==&nbsp;InstEmptyWidth.</span><br>
<span class="lineno"></span><span class="keyword" id="5394034">func</span>&nbsp;<span class="op" id="5394039">(</span><span class="ident" id="5394040">i</span>&nbsp;<span class="op" id="5394042">*</span><span class="ident" id="5394043">Inst</span><span class="op" id="5394047">)</span>&nbsp;<span class="ident" id="5394049">MatchEmptyWidth</span><span class="op" id="5394064">(</span><span class="ident" id="5394065">before</span>&nbsp;<span class="builtintype" id="5394072">rune</span><span class="op" id="5394076">,</span>&nbsp;<span class="ident" id="5394078">after</span>&nbsp;<span class="builtintype" id="5394084">rune</span><span class="op" id="5394088">)</span>&nbsp;<span class="builtintype" id="5394090">bool</span>&nbsp;<span class="op" id="5394095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394098">switch</span>&nbsp;<span class="ident" id="5394105">EmptyOp</span><span class="op" id="5394112">(</span><span class="ident" id="5394113">i</span><span class="op" id="5394114">.</span><span class="ident" id="5394115">Arg</span><span class="op" id="5394118">)</span>&nbsp;<span class="op" id="5394120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394123">case</span>&nbsp;<span class="ident" id="5394128">EmptyBeginLine</span><span class="op" id="5394142">:</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394146">return</span>&nbsp;<span class="ident" id="5394153">before</span>&nbsp;<span class="op" id="5394160">==</span>&nbsp;<span class="string" id="5394163">&#39;\n&#39;</span>&nbsp;<span class="op" id="5394168">||</span>&nbsp;<span class="ident" id="5394171">before</span>&nbsp;<span class="op" id="5394178">==</span>&nbsp;<span class="op" id="5394181">-</span><span class="num" id="5394182">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394185">case</span>&nbsp;<span class="ident" id="5394190">EmptyEndLine</span><span class="op" id="5394202">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394206">return</span>&nbsp;<span class="ident" id="5394213">after</span>&nbsp;<span class="op" id="5394219">==</span>&nbsp;<span class="string" id="5394222">&#39;\n&#39;</span>&nbsp;<span class="op" id="5394227">||</span>&nbsp;<span class="ident" id="5394230">after</span>&nbsp;<span class="op" id="5394236">==</span>&nbsp;<span class="op" id="5394239">-</span><span class="num" id="5394240">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394243">case</span>&nbsp;<span class="ident" id="5394248">EmptyBeginText</span><span class="op" id="5394262">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394266">return</span>&nbsp;<span class="ident" id="5394273">before</span>&nbsp;<span class="op" id="5394280">==</span>&nbsp;<span class="op" id="5394283">-</span><span class="num" id="5394284">1</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394287">case</span>&nbsp;<span class="ident" id="5394292">EmptyEndText</span><span class="op" id="5394304">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394308">return</span>&nbsp;<span class="ident" id="5394315">after</span>&nbsp;<span class="op" id="5394321">==</span>&nbsp;<span class="op" id="5394324">-</span><span class="num" id="5394325">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394328">case</span>&nbsp;<span class="ident" id="5394333">EmptyWordBoundary</span><span class="op" id="5394350">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394354">return</span>&nbsp;<span class="ident" id="5394361">wordRune</span><span class="op" id="5394369">(</span><span class="ident" id="5394370">before</span><span class="op" id="5394376">)</span>&nbsp;<span class="op" id="5394378">!=</span>&nbsp;<span class="ident" id="5394381">wordRune</span><span class="op" id="5394389">(</span><span class="ident" id="5394390">after</span><span class="op" id="5394395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394398">case</span>&nbsp;<span class="ident" id="5394403">EmptyNoWordBoundary</span><span class="op" id="5394422">:</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394426">return</span>&nbsp;<span class="ident" id="5394433">wordRune</span><span class="op" id="5394441">(</span><span class="ident" id="5394442">before</span><span class="op" id="5394448">)</span>&nbsp;<span class="op" id="5394450">==</span>&nbsp;<span class="ident" id="5394453">wordRune</span><span class="op" id="5394461">(</span><span class="ident" id="5394462">after</span><span class="op" id="5394467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5394470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5394473">panic</span><span class="op" id="5394478">(</span><span class="string" id="5394479">&#34;unknown&nbsp;empty&nbsp;width&nbsp;arg&#34;</span><span class="op" id="5394504">)</span><br>
<span class="lineno"></span><span class="op" id="5394506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="5394509">func</span>&nbsp;<span class="op" id="5394514">(</span><span class="ident" id="5394515">i</span>&nbsp;<span class="op" id="5394517">*</span><span class="ident" id="5394518">Inst</span><span class="op" id="5394522">)</span>&nbsp;<span class="ident" id="5394524">String</span><span class="op" id="5394530">(</span><span class="op" id="5394531">)</span>&nbsp;<span class="builtintype" id="5394533">string</span>&nbsp;<span class="op" id="5394540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394543">var</span>&nbsp;<span class="ident" id="5394547">b</span>&nbsp;<span class="ident" id="5394549">bytes</span><span class="op" id="5394554">.</span><span class="ident" id="5394555">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5394563">dumpInst</span><span class="op" id="5394571">(</span><span class="op" id="5394572">&amp;</span><span class="ident" id="5394573">b</span><span class="op" id="5394574">,</span>&nbsp;<span class="ident" id="5394576">i</span><span class="op" id="5394577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394580">return</span>&nbsp;<span class="ident" id="5394587">b</span><span class="op" id="5394588">.</span><span class="ident" id="5394589">String</span><span class="op" id="5394595">(</span><span class="op" id="5394596">)</span><br>
<span class="lineno"></span><span class="op" id="5394598">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="keyword" id="5394601">func</span>&nbsp;<span class="ident" id="5394606">bw</span><span class="op" id="5394608">(</span><span class="ident" id="5394609">b</span>&nbsp;<span class="op" id="5394611">*</span><span class="ident" id="5394612">bytes</span><span class="op" id="5394617">.</span><span class="ident" id="5394618">Buffer</span><span class="op" id="5394624">,</span>&nbsp;<span class="ident" id="5394626">args</span>&nbsp;<span class="op" id="5394631">...</span><span class="builtintype" id="5394634">string</span><span class="op" id="5394640">)</span>&nbsp;<span class="op" id="5394642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394645">for</span>&nbsp;<span class="ident" id="5394649">_</span><span class="op" id="5394650">,</span>&nbsp;<span class="ident" id="5394652">s</span>&nbsp;<span class="op" id="5394654">:=</span>&nbsp;<span class="keyword" id="5394657">range</span>&nbsp;<span class="ident" id="5394663">args</span>&nbsp;<span class="op" id="5394668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5394672">b</span><span class="op" id="5394673">.</span><span class="ident" id="5394674">WriteString</span><span class="op" id="5394685">(</span><span class="ident" id="5394686">s</span><span class="op" id="5394687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5394690">}</span><br>
<span class="lineno">290</span><span class="op" id="5394692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5394695">func</span>&nbsp;<span class="ident" id="5394700">dumpProg</span><span class="op" id="5394708">(</span><span class="ident" id="5394709">b</span>&nbsp;<span class="op" id="5394711">*</span><span class="ident" id="5394712">bytes</span><span class="op" id="5394717">.</span><span class="ident" id="5394718">Buffer</span><span class="op" id="5394724">,</span>&nbsp;<span class="ident" id="5394726">p</span>&nbsp;<span class="op" id="5394728">*</span><span class="ident" id="5394729">Prog</span><span class="op" id="5394733">)</span>&nbsp;<span class="op" id="5394735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394738">for</span>&nbsp;<span class="ident" id="5394742">j</span>&nbsp;<span class="op" id="5394744">:=</span>&nbsp;<span class="keyword" id="5394747">range</span>&nbsp;<span class="ident" id="5394753">p</span><span class="op" id="5394754">.</span><span class="ident" id="5394755">Inst</span>&nbsp;<span class="op" id="5394760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5394764">i</span>&nbsp;<span class="op" id="5394766">:=</span>&nbsp;<span class="op" id="5394769">&amp;</span><span class="ident" id="5394770">p</span><span class="op" id="5394771">.</span><span class="ident" id="5394772">Inst</span><span class="op" id="5394776">[</span><span class="ident" id="5394777">j</span><span class="op" id="5394778">]</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5394782">pc</span>&nbsp;<span class="op" id="5394785">:=</span>&nbsp;<span class="ident" id="5394788">strconv</span><span class="op" id="5394795">.</span><span class="ident" id="5394796">Itoa</span><span class="op" id="5394800">(</span><span class="ident" id="5394801">j</span><span class="op" id="5394802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394806">if</span>&nbsp;<span class="builtinfunc" id="5394809">len</span><span class="op" id="5394812">(</span><span class="ident" id="5394813">pc</span><span class="op" id="5394815">)</span>&nbsp;<span class="op" id="5394817">&lt;</span>&nbsp;<span class="num" id="5394819">3</span>&nbsp;<span class="op" id="5394821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5394826">b</span><span class="op" id="5394827">.</span><span class="ident" id="5394828">WriteString</span><span class="op" id="5394839">(</span><span class="string" id="5394840">&#34;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="5394845">[</span><span class="builtinfunc" id="5394846">len</span><span class="op" id="5394849">(</span><span class="ident" id="5394850">pc</span><span class="op" id="5394852">)</span><span class="op" id="5394853">:</span><span class="op" id="5394854">]</span><span class="op" id="5394855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5394859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394863">if</span>&nbsp;<span class="ident" id="5394866">j</span>&nbsp;<span class="op" id="5394868">==</span>&nbsp;<span class="ident" id="5394871">p</span><span class="op" id="5394872">.</span><span class="ident" id="5394873">Start</span>&nbsp;<span class="op" id="5394879">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5394884">pc</span>&nbsp;<span class="op" id="5394887">+=</span>&nbsp;<span class="string" id="5394890">&#34;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5394896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5394900">bw</span><span class="op" id="5394902">(</span><span class="ident" id="5394903">b</span><span class="op" id="5394904">,</span>&nbsp;<span class="ident" id="5394906">pc</span><span class="op" id="5394908">,</span>&nbsp;<span class="string" id="5394910">&#34;\t&#34;</span><span class="op" id="5394914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5394918">dumpInst</span><span class="op" id="5394926">(</span><span class="ident" id="5394927">b</span><span class="op" id="5394928">,</span>&nbsp;<span class="ident" id="5394930">i</span><span class="op" id="5394931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5394935">bw</span><span class="op" id="5394937">(</span><span class="ident" id="5394938">b</span><span class="op" id="5394939">,</span>&nbsp;<span class="string" id="5394941">&#34;\n&#34;</span><span class="op" id="5394945">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5394948">}</span><br>
<span class="lineno"></span><span class="op" id="5394950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5394953">func</span>&nbsp;<span class="ident" id="5394958">u32</span><span class="op" id="5394961">(</span><span class="ident" id="5394962">i</span>&nbsp;<span class="builtintype" id="5394964">uint32</span><span class="op" id="5394970">)</span>&nbsp;<span class="builtintype" id="5394972">string</span>&nbsp;<span class="op" id="5394979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394982">return</span>&nbsp;<span class="ident" id="5394989">strconv</span><span class="op" id="5394996">.</span><span class="ident" id="5394997">FormatUint</span><span class="op" id="5395007">(</span><span class="builtintype" id="5395008">uint64</span><span class="op" id="5395014">(</span><span class="ident" id="5395015">i</span><span class="op" id="5395016">)</span><span class="op" id="5395017">,</span>&nbsp;<span class="num" id="5395019">10</span><span class="op" id="5395021">)</span><br>
<span class="lineno">310</span><span class="op" id="5395023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5395026">func</span>&nbsp;<span class="ident" id="5395031">dumpInst</span><span class="op" id="5395039">(</span><span class="ident" id="5395040">b</span>&nbsp;<span class="op" id="5395042">*</span><span class="ident" id="5395043">bytes</span><span class="op" id="5395048">.</span><span class="ident" id="5395049">Buffer</span><span class="op" id="5395055">,</span>&nbsp;<span class="ident" id="5395057">i</span>&nbsp;<span class="op" id="5395059">*</span><span class="ident" id="5395060">Inst</span><span class="op" id="5395064">)</span>&nbsp;<span class="op" id="5395066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395069">switch</span>&nbsp;<span class="ident" id="5395076">i</span><span class="op" id="5395077">.</span><span class="ident" id="5395078">Op</span>&nbsp;<span class="op" id="5395081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395084">case</span>&nbsp;<span class="ident" id="5395089">InstAlt</span><span class="op" id="5395096">:</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395100">bw</span><span class="op" id="5395102">(</span><span class="ident" id="5395103">b</span><span class="op" id="5395104">,</span>&nbsp;<span class="string" id="5395106">&#34;alt&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5395115">,</span>&nbsp;<span class="ident" id="5395117">u32</span><span class="op" id="5395120">(</span><span class="ident" id="5395121">i</span><span class="op" id="5395122">.</span><span class="ident" id="5395123">Out</span><span class="op" id="5395126">)</span><span class="op" id="5395127">,</span>&nbsp;<span class="string" id="5395129">&#34;,&nbsp;&#34;</span><span class="op" id="5395133">,</span>&nbsp;<span class="ident" id="5395135">u32</span><span class="op" id="5395138">(</span><span class="ident" id="5395139">i</span><span class="op" id="5395140">.</span><span class="ident" id="5395141">Arg</span><span class="op" id="5395144">)</span><span class="op" id="5395145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395148">case</span>&nbsp;<span class="ident" id="5395153">InstAltMatch</span><span class="op" id="5395165">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395169">bw</span><span class="op" id="5395171">(</span><span class="ident" id="5395172">b</span><span class="op" id="5395173">,</span>&nbsp;<span class="string" id="5395175">&#34;altmatch&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5395189">,</span>&nbsp;<span class="ident" id="5395191">u32</span><span class="op" id="5395194">(</span><span class="ident" id="5395195">i</span><span class="op" id="5395196">.</span><span class="ident" id="5395197">Out</span><span class="op" id="5395200">)</span><span class="op" id="5395201">,</span>&nbsp;<span class="string" id="5395203">&#34;,&nbsp;&#34;</span><span class="op" id="5395207">,</span>&nbsp;<span class="ident" id="5395209">u32</span><span class="op" id="5395212">(</span><span class="ident" id="5395213">i</span><span class="op" id="5395214">.</span><span class="ident" id="5395215">Arg</span><span class="op" id="5395218">)</span><span class="op" id="5395219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395222">case</span>&nbsp;<span class="ident" id="5395227">InstCapture</span><span class="op" id="5395238">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395242">bw</span><span class="op" id="5395244">(</span><span class="ident" id="5395245">b</span><span class="op" id="5395246">,</span>&nbsp;<span class="string" id="5395248">&#34;cap&nbsp;&#34;</span><span class="op" id="5395254">,</span>&nbsp;<span class="ident" id="5395256">u32</span><span class="op" id="5395259">(</span><span class="ident" id="5395260">i</span><span class="op" id="5395261">.</span><span class="ident" id="5395262">Arg</span><span class="op" id="5395265">)</span><span class="op" id="5395266">,</span>&nbsp;<span class="string" id="5395268">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5395274">,</span>&nbsp;<span class="ident" id="5395276">u32</span><span class="op" id="5395279">(</span><span class="ident" id="5395280">i</span><span class="op" id="5395281">.</span><span class="ident" id="5395282">Out</span><span class="op" id="5395285">)</span><span class="op" id="5395286">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395289">case</span>&nbsp;<span class="ident" id="5395294">InstEmptyWidth</span><span class="op" id="5395308">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395312">bw</span><span class="op" id="5395314">(</span><span class="ident" id="5395315">b</span><span class="op" id="5395316">,</span>&nbsp;<span class="string" id="5395318">&#34;empty&nbsp;&#34;</span><span class="op" id="5395326">,</span>&nbsp;<span class="ident" id="5395328">u32</span><span class="op" id="5395331">(</span><span class="ident" id="5395332">i</span><span class="op" id="5395333">.</span><span class="ident" id="5395334">Arg</span><span class="op" id="5395337">)</span><span class="op" id="5395338">,</span>&nbsp;<span class="string" id="5395340">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5395346">,</span>&nbsp;<span class="ident" id="5395348">u32</span><span class="op" id="5395351">(</span><span class="ident" id="5395352">i</span><span class="op" id="5395353">.</span><span class="ident" id="5395354">Out</span><span class="op" id="5395357">)</span><span class="op" id="5395358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395361">case</span>&nbsp;<span class="ident" id="5395366">InstMatch</span><span class="op" id="5395375">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395379">bw</span><span class="op" id="5395381">(</span><span class="ident" id="5395382">b</span><span class="op" id="5395383">,</span>&nbsp;<span class="string" id="5395385">&#34;match&#34;</span><span class="op" id="5395392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395395">case</span>&nbsp;<span class="ident" id="5395400">InstFail</span><span class="op" id="5395408">:</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395412">bw</span><span class="op" id="5395414">(</span><span class="ident" id="5395415">b</span><span class="op" id="5395416">,</span>&nbsp;<span class="string" id="5395418">&#34;fail&#34;</span><span class="op" id="5395424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395427">case</span>&nbsp;<span class="ident" id="5395432">InstNop</span><span class="op" id="5395439">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395443">bw</span><span class="op" id="5395445">(</span><span class="ident" id="5395446">b</span><span class="op" id="5395447">,</span>&nbsp;<span class="string" id="5395449">&#34;nop&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5395458">,</span>&nbsp;<span class="ident" id="5395460">u32</span><span class="op" id="5395463">(</span><span class="ident" id="5395464">i</span><span class="op" id="5395465">.</span><span class="ident" id="5395466">Out</span><span class="op" id="5395469">)</span><span class="op" id="5395470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395473">case</span>&nbsp;<span class="ident" id="5395478">InstRune</span><span class="op" id="5395486">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395490">if</span>&nbsp;<span class="ident" id="5395493">i</span><span class="op" id="5395494">.</span><span class="ident" id="5395495">Rune</span>&nbsp;<span class="op" id="5395500">==</span>&nbsp;<span class="builtintype" id="5395503">nil</span>&nbsp;<span class="op" id="5395507">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5395512">//&nbsp;shouldn&#39;t&nbsp;happen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395535">bw</span><span class="op" id="5395537">(</span><span class="ident" id="5395538">b</span><span class="op" id="5395539">,</span>&nbsp;<span class="string" id="5395541">&#34;rune&nbsp;&lt;nil&gt;&#34;</span><span class="op" id="5395553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5395557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395561">bw</span><span class="op" id="5395563">(</span><span class="ident" id="5395564">b</span><span class="op" id="5395565">,</span>&nbsp;<span class="string" id="5395567">&#34;rune&nbsp;&#34;</span><span class="op" id="5395574">,</span>&nbsp;<span class="ident" id="5395576">strconv</span><span class="op" id="5395583">.</span><span class="ident" id="5395584">QuoteToASCII</span><span class="op" id="5395596">(</span><span class="builtintype" id="5395597">string</span><span class="op" id="5395603">(</span><span class="ident" id="5395604">i</span><span class="op" id="5395605">.</span><span class="ident" id="5395606">Rune</span><span class="op" id="5395610">)</span><span class="op" id="5395611">)</span><span class="op" id="5395612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395616">if</span>&nbsp;<span class="ident" id="5395619">Flags</span><span class="op" id="5395624">(</span><span class="ident" id="5395625">i</span><span class="op" id="5395626">.</span><span class="ident" id="5395627">Arg</span><span class="op" id="5395630">)</span><span class="op" id="5395631">&amp;</span><span class="ident" id="5395632">FoldCase</span>&nbsp;<span class="op" id="5395641">!=</span>&nbsp;<span class="num" id="5395644">0</span>&nbsp;<span class="op" id="5395646">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395651">bw</span><span class="op" id="5395653">(</span><span class="ident" id="5395654">b</span><span class="op" id="5395655">,</span>&nbsp;<span class="string" id="5395657">&#34;/i&#34;</span><span class="op" id="5395661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5395665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395669">bw</span><span class="op" id="5395671">(</span><span class="ident" id="5395672">b</span><span class="op" id="5395673">,</span>&nbsp;<span class="string" id="5395675">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5395681">,</span>&nbsp;<span class="ident" id="5395683">u32</span><span class="op" id="5395686">(</span><span class="ident" id="5395687">i</span><span class="op" id="5395688">.</span><span class="ident" id="5395689">Out</span><span class="op" id="5395692">)</span><span class="op" id="5395693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395696">case</span>&nbsp;<span class="ident" id="5395701">InstRune1</span><span class="op" id="5395710">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395714">bw</span><span class="op" id="5395716">(</span><span class="ident" id="5395717">b</span><span class="op" id="5395718">,</span>&nbsp;<span class="string" id="5395720">&#34;rune1&nbsp;&#34;</span><span class="op" id="5395728">,</span>&nbsp;<span class="ident" id="5395730">strconv</span><span class="op" id="5395737">.</span><span class="ident" id="5395738">QuoteToASCII</span><span class="op" id="5395750">(</span><span class="builtintype" id="5395751">string</span><span class="op" id="5395757">(</span><span class="ident" id="5395758">i</span><span class="op" id="5395759">.</span><span class="ident" id="5395760">Rune</span><span class="op" id="5395764">)</span><span class="op" id="5395765">)</span><span class="op" id="5395766">,</span>&nbsp;<span class="string" id="5395768">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5395774">,</span>&nbsp;<span class="ident" id="5395776">u32</span><span class="op" id="5395779">(</span><span class="ident" id="5395780">i</span><span class="op" id="5395781">.</span><span class="ident" id="5395782">Out</span><span class="op" id="5395785">)</span><span class="op" id="5395786">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395789">case</span>&nbsp;<span class="ident" id="5395794">InstRuneAny</span><span class="op" id="5395805">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395809">bw</span><span class="op" id="5395811">(</span><span class="ident" id="5395812">b</span><span class="op" id="5395813">,</span>&nbsp;<span class="string" id="5395815">&#34;any&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5395824">,</span>&nbsp;<span class="ident" id="5395826">u32</span><span class="op" id="5395829">(</span><span class="ident" id="5395830">i</span><span class="op" id="5395831">.</span><span class="ident" id="5395832">Out</span><span class="op" id="5395835">)</span><span class="op" id="5395836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395839">case</span>&nbsp;<span class="ident" id="5395844">InstRuneAnyNotNL</span><span class="op" id="5395860">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395864">bw</span><span class="op" id="5395866">(</span><span class="ident" id="5395867">b</span><span class="op" id="5395868">,</span>&nbsp;<span class="string" id="5395870">&#34;anynotnl&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="5395884">,</span>&nbsp;<span class="ident" id="5395886">u32</span><span class="op" id="5395889">(</span><span class="ident" id="5395890">i</span><span class="op" id="5395891">.</span><span class="ident" id="5395892">Out</span><span class="op" id="5395895">)</span><span class="op" id="5395896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5395899">}</span><br>
<span class="lineno">345</span><span class="op" id="5395901">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
