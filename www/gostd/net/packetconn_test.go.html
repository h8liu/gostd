<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html" class="current">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8073498">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8073554">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8073608">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="8073659">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;API&nbsp;tests&nbsp;across&nbsp;platforms&nbsp;and&nbsp;will&nbsp;never&nbsp;have&nbsp;a&nbsp;build</span><br>
<span class="lineno"></span><span class="comment" id="8073738">//&nbsp;tag.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8073747">package</span>&nbsp;<span class="ident" id="8073755">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="8073760">import</span>&nbsp;<span class="op" id="8073767">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8073770">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8073776">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8073787">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8073798">&#34;testing&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8073809">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8073816">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8073819">func</span>&nbsp;<span class="ident" id="8073824">packetConnTestData</span><span class="op" id="8073842">(</span><span class="ident" id="8073843">t</span>&nbsp;<span class="op" id="8073845">*</span><span class="ident" id="8073846">testing</span><span class="op" id="8073853">.</span><span class="ident" id="8073854">T</span><span class="op" id="8073855">,</span>&nbsp;<span class="ident" id="8073857">net</span>&nbsp;<span class="builtintype" id="8073861">string</span><span class="op" id="8073867">,</span>&nbsp;<span class="ident" id="8073869">i</span>&nbsp;<span class="builtintype" id="8073871">int</span><span class="op" id="8073874">)</span>&nbsp;<span class="op" id="8073876">(</span><span class="op" id="8073877">[</span><span class="op" id="8073878">]</span><span class="builtintype" id="8073879">byte</span><span class="op" id="8073883">,</span>&nbsp;<span class="keyword" id="8073885">func</span><span class="op" id="8073889">(</span><span class="op" id="8073890">)</span><span class="op" id="8073891">)</span>&nbsp;<span class="op" id="8073893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8073896">switch</span>&nbsp;<span class="ident" id="8073903">net</span>&nbsp;<span class="op" id="8073907">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8073910">case</span>&nbsp;<span class="string" id="8073915">&#34;udp&#34;</span><span class="op" id="8073920">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8073924">return</span>&nbsp;<span class="op" id="8073931">[</span><span class="op" id="8073932">]</span><span class="builtintype" id="8073933">byte</span><span class="op" id="8073937">(</span><span class="string" id="8073938">&#34;UDP&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="8073959">)</span><span class="op" id="8073960">,</span>&nbsp;<span class="ident" id="8073962">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8073967">case</span>&nbsp;<span class="string" id="8073972">&#34;ip&#34;</span><span class="op" id="8073976">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8073980">if</span>&nbsp;<span class="ident" id="8073983">skip</span><span class="op" id="8073987">,</span>&nbsp;<span class="ident" id="8073989">skipmsg</span>&nbsp;<span class="op" id="8073997">:=</span>&nbsp;<span class="ident" id="8074000">skipRawSocketTest</span><span class="op" id="8074017">(</span><span class="ident" id="8074018">t</span><span class="op" id="8074019">)</span><span class="op" id="8074020">;</span>&nbsp;<span class="ident" id="8074022">skip</span>&nbsp;<span class="op" id="8074027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8074032">return</span>&nbsp;<span class="ident" id="8074039">nil</span><span class="op" id="8074042">,</span>&nbsp;<span class="keyword" id="8074044">func</span><span class="op" id="8074048">(</span><span class="op" id="8074049">)</span>&nbsp;<span class="op" id="8074051">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074057">t</span><span class="op" id="8074058">.</span><span class="ident" id="8074059">Logf</span><span class="op" id="8074063">(</span><span class="ident" id="8074064">skipmsg</span><span class="op" id="8074071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8074076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8074080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074084">b</span><span class="op" id="8074085">,</span>&nbsp;<span class="ident" id="8074087">err</span>&nbsp;<span class="op" id="8074091">:=</span>&nbsp;<span class="op" id="8074094">(</span><span class="op" id="8074095">&amp;</span><span class="ident" id="8074096">icmpMessage</span><span class="op" id="8074107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074112">Type</span><span class="op" id="8074116">:</span>&nbsp;<span class="ident" id="8074118">icmpv4EchoRequest</span><span class="op" id="8074135">,</span>&nbsp;<span class="ident" id="8074137">Code</span><span class="op" id="8074141">:</span>&nbsp;<span class="num" id="8074143">0</span><span class="op" id="8074144">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074149">Body</span><span class="op" id="8074153">:</span>&nbsp;<span class="op" id="8074155">&amp;</span><span class="ident" id="8074156">icmpEcho</span><span class="op" id="8074164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074170">ID</span><span class="op" id="8074172">:</span>&nbsp;<span class="ident" id="8074174">os</span><span class="op" id="8074176">.</span><span class="ident" id="8074177">Getpid</span><span class="op" id="8074183">(</span><span class="op" id="8074184">)</span>&nbsp;<span class="op" id="8074186">&amp;</span>&nbsp;<span class="num" id="8074188">0xffff</span><span class="op" id="8074194">,</span>&nbsp;<span class="ident" id="8074196">Seq</span><span class="op" id="8074199">:</span>&nbsp;<span class="ident" id="8074201">i</span>&nbsp;<span class="op" id="8074203">+</span>&nbsp;<span class="num" id="8074205">1</span><span class="op" id="8074206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074212">Data</span><span class="op" id="8074216">:</span>&nbsp;<span class="op" id="8074218">[</span><span class="op" id="8074219">]</span><span class="builtintype" id="8074220">byte</span><span class="op" id="8074224">(</span><span class="string" id="8074225">&#34;IP&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="8074245">)</span><span class="op" id="8074246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8074251">}</span><span class="op" id="8074252">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8074256">}</span><span class="op" id="8074257">)</span><span class="op" id="8074258">.</span><span class="ident" id="8074259">Marshal</span><span class="op" id="8074266">(</span><span class="op" id="8074267">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8074271">if</span>&nbsp;<span class="ident" id="8074274">err</span>&nbsp;<span class="op" id="8074278">!=</span>&nbsp;<span class="ident" id="8074281">nil</span>&nbsp;<span class="op" id="8074285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8074290">return</span>&nbsp;<span class="ident" id="8074297">nil</span><span class="op" id="8074300">,</span>&nbsp;<span class="keyword" id="8074302">func</span><span class="op" id="8074306">(</span><span class="op" id="8074307">)</span>&nbsp;<span class="op" id="8074309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074315">t</span><span class="op" id="8074316">.</span><span class="ident" id="8074317">Fatalf</span><span class="op" id="8074323">(</span><span class="string" id="8074324">&#34;icmpMessage.Marshal&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8074356">,</span>&nbsp;<span class="ident" id="8074358">err</span><span class="op" id="8074361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8074366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8074370">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8074374">return</span>&nbsp;<span class="ident" id="8074381">b</span><span class="op" id="8074382">,</span>&nbsp;<span class="ident" id="8074384">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8074389">case</span>&nbsp;<span class="string" id="8074394">&#34;unixgram&#34;</span><span class="op" id="8074404">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8074408">switch</span>&nbsp;<span class="ident" id="8074415">runtime</span><span class="op" id="8074422">.</span><span class="ident" id="8074423">GOOS</span>&nbsp;<span class="op" id="8074428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8074432">case</span>&nbsp;<span class="string" id="8074437">&#34;nacl&#34;</span><span class="op" id="8074443">,</span>&nbsp;<span class="string" id="8074445">&#34;plan9&#34;</span><span class="op" id="8074452">,</span>&nbsp;<span class="string" id="8074454">&#34;windows&#34;</span><span class="op" id="8074463">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8074468">return</span>&nbsp;<span class="ident" id="8074475">nil</span><span class="op" id="8074478">,</span>&nbsp;<span class="keyword" id="8074480">func</span><span class="op" id="8074484">(</span><span class="op" id="8074485">)</span>&nbsp;<span class="op" id="8074487">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074493">t</span><span class="op" id="8074494">.</span><span class="ident" id="8074495">Logf</span><span class="op" id="8074499">(</span><span class="string" id="8074500">&#34;skipping&nbsp;%q&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8074524">,</span>&nbsp;<span class="ident" id="8074526">net</span><span class="op" id="8074529">,</span>&nbsp;<span class="ident" id="8074531">runtime</span><span class="op" id="8074538">.</span><span class="ident" id="8074539">GOOS</span><span class="op" id="8074543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8074548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8074552">default</span><span class="op" id="8074559">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8074564">return</span>&nbsp;<span class="op" id="8074571">[</span><span class="op" id="8074572">]</span><span class="builtintype" id="8074573">byte</span><span class="op" id="8074577">(</span><span class="string" id="8074578">&#34;UNIXGRAM&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="8074604">)</span><span class="op" id="8074605">,</span>&nbsp;<span class="ident" id="8074607">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8074613">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8074616">default</span><span class="op" id="8074623">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8074627">return</span>&nbsp;<span class="ident" id="8074634">nil</span><span class="op" id="8074637">,</span>&nbsp;<span class="keyword" id="8074639">func</span><span class="op" id="8074643">(</span><span class="op" id="8074644">)</span>&nbsp;<span class="op" id="8074646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074651">t</span><span class="op" id="8074652">.</span><span class="ident" id="8074653">Logf</span><span class="op" id="8074657">(</span><span class="string" id="8074658">&#34;skipping&nbsp;%q&nbsp;test&#34;</span><span class="op" id="8074676">,</span>&nbsp;<span class="ident" id="8074678">net</span><span class="op" id="8074681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8074685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8074688">}</span><br>
<span class="lineno">55</span><span class="op" id="8074690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8074693">var</span>&nbsp;<span class="ident" id="8074697">packetConnTests</span>&nbsp;<span class="op" id="8074713">=</span>&nbsp;<span class="op" id="8074715">[</span><span class="op" id="8074716">]</span><span class="keyword" id="8074717">struct</span>&nbsp;<span class="op" id="8074724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074727">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8074733">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074741">addr1</span>&nbsp;<span class="builtintype" id="8074747">string</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074755">addr2</span>&nbsp;<span class="builtintype" id="8074761">string</span><br>
<span class="lineno"></span><span class="op" id="8074768">}</span><span class="op" id="8074769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8074772">{</span><span class="string" id="8074773">&#34;udp&#34;</span><span class="op" id="8074778">,</span>&nbsp;<span class="string" id="8074780">&#34;127.0.0.1:0&#34;</span><span class="op" id="8074793">,</span>&nbsp;<span class="string" id="8074795">&#34;127.0.0.1:0&#34;</span><span class="op" id="8074808">}</span><span class="op" id="8074809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8074812">{</span><span class="string" id="8074813">&#34;ip:icmp&#34;</span><span class="op" id="8074822">,</span>&nbsp;<span class="string" id="8074824">&#34;127.0.0.1&#34;</span><span class="op" id="8074835">,</span>&nbsp;<span class="string" id="8074837">&#34;127.0.0.1&#34;</span><span class="op" id="8074848">}</span><span class="op" id="8074849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8074852">{</span><span class="string" id="8074853">&#34;unixgram&#34;</span><span class="op" id="8074863">,</span>&nbsp;<span class="ident" id="8074865">testUnixAddr</span><span class="op" id="8074877">(</span><span class="op" id="8074878">)</span><span class="op" id="8074879">,</span>&nbsp;<span class="ident" id="8074881">testUnixAddr</span><span class="op" id="8074893">(</span><span class="op" id="8074894">)</span><span class="op" id="8074895">}</span><span class="op" id="8074896">,</span><br>
<span class="lineno">65</span><span class="op" id="8074898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8074901">func</span>&nbsp;<span class="ident" id="8074906">TestPacketConn</span><span class="op" id="8074920">(</span><span class="ident" id="8074921">t</span>&nbsp;<span class="op" id="8074923">*</span><span class="ident" id="8074924">testing</span><span class="op" id="8074931">.</span><span class="ident" id="8074932">T</span><span class="op" id="8074933">)</span>&nbsp;<span class="op" id="8074935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074938">closer</span>&nbsp;<span class="op" id="8074945">:=</span>&nbsp;<span class="keyword" id="8074948">func</span><span class="op" id="8074952">(</span><span class="ident" id="8074953">c</span>&nbsp;<span class="ident" id="8074955">PacketConn</span><span class="op" id="8074965">,</span>&nbsp;<span class="ident" id="8074967">net</span><span class="op" id="8074970">,</span>&nbsp;<span class="ident" id="8074972">addr1</span><span class="op" id="8074977">,</span>&nbsp;<span class="ident" id="8074979">addr2</span>&nbsp;<span class="builtintype" id="8074985">string</span><span class="op" id="8074991">)</span>&nbsp;<span class="op" id="8074993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8074997">c</span><span class="op" id="8074998">.</span><span class="ident" id="8074999">Close</span><span class="op" id="8075004">(</span><span class="op" id="8075005">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8075009">switch</span>&nbsp;<span class="ident" id="8075016">net</span>&nbsp;<span class="op" id="8075020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8075024">case</span>&nbsp;<span class="string" id="8075029">&#34;unixgram&#34;</span><span class="op" id="8075039">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075044">os</span><span class="op" id="8075046">.</span><span class="ident" id="8075047">Remove</span><span class="op" id="8075053">(</span><span class="ident" id="8075054">addr1</span><span class="op" id="8075059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075064">os</span><span class="op" id="8075066">.</span><span class="ident" id="8075067">Remove</span><span class="op" id="8075073">(</span><span class="ident" id="8075074">addr2</span><span class="op" id="8075079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8075083">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8075086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8075090">for</span>&nbsp;<span class="ident" id="8075094">i</span><span class="op" id="8075095">,</span>&nbsp;<span class="ident" id="8075097">tt</span>&nbsp;<span class="op" id="8075100">:=</span>&nbsp;<span class="keyword" id="8075103">range</span>&nbsp;<span class="ident" id="8075109">packetConnTests</span>&nbsp;<span class="op" id="8075125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075129">netstr</span>&nbsp;<span class="op" id="8075136">:=</span>&nbsp;<span class="ident" id="8075139">strings</span><span class="op" id="8075146">.</span><span class="ident" id="8075147">Split</span><span class="op" id="8075152">(</span><span class="ident" id="8075153">tt</span><span class="op" id="8075155">.</span><span class="ident" id="8075156">net</span><span class="op" id="8075159">,</span>&nbsp;<span class="string" id="8075161">&#34;:&#34;</span><span class="op" id="8075164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075168">wb</span><span class="op" id="8075170">,</span>&nbsp;<span class="ident" id="8075172">skipOrFatalFn</span>&nbsp;<span class="op" id="8075186">:=</span>&nbsp;<span class="ident" id="8075189">packetConnTestData</span><span class="op" id="8075207">(</span><span class="ident" id="8075208">t</span><span class="op" id="8075209">,</span>&nbsp;<span class="ident" id="8075211">netstr</span><span class="op" id="8075217">[</span><span class="num" id="8075218">0</span><span class="op" id="8075219">]</span><span class="op" id="8075220">,</span>&nbsp;<span class="ident" id="8075222">i</span><span class="op" id="8075223">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8075227">if</span>&nbsp;<span class="ident" id="8075230">skipOrFatalFn</span>&nbsp;<span class="op" id="8075244">!=</span>&nbsp;<span class="ident" id="8075247">nil</span>&nbsp;<span class="op" id="8075251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075256">skipOrFatalFn</span><span class="op" id="8075269">(</span><span class="op" id="8075270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8075275">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8075286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075291">c1</span><span class="op" id="8075293">,</span>&nbsp;<span class="ident" id="8075295">err</span>&nbsp;<span class="op" id="8075299">:=</span>&nbsp;<span class="ident" id="8075302">ListenPacket</span><span class="op" id="8075314">(</span><span class="ident" id="8075315">tt</span><span class="op" id="8075317">.</span><span class="ident" id="8075318">net</span><span class="op" id="8075321">,</span>&nbsp;<span class="ident" id="8075323">tt</span><span class="op" id="8075325">.</span><span class="ident" id="8075326">addr1</span><span class="op" id="8075331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8075335">if</span>&nbsp;<span class="ident" id="8075338">err</span>&nbsp;<span class="op" id="8075342">!=</span>&nbsp;<span class="ident" id="8075345">nil</span>&nbsp;<span class="op" id="8075349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075354">t</span><span class="op" id="8075355">.</span><span class="ident" id="8075356">Fatalf</span><span class="op" id="8075362">(</span><span class="string" id="8075363">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8075388">,</span>&nbsp;<span class="ident" id="8075390">err</span><span class="op" id="8075393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8075397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8075401">defer</span>&nbsp;<span class="ident" id="8075407">closer</span><span class="op" id="8075413">(</span><span class="ident" id="8075414">c1</span><span class="op" id="8075416">,</span>&nbsp;<span class="ident" id="8075418">netstr</span><span class="op" id="8075424">[</span><span class="num" id="8075425">0</span><span class="op" id="8075426">]</span><span class="op" id="8075427">,</span>&nbsp;<span class="ident" id="8075429">tt</span><span class="op" id="8075431">.</span><span class="ident" id="8075432">addr1</span><span class="op" id="8075437">,</span>&nbsp;<span class="ident" id="8075439">tt</span><span class="op" id="8075441">.</span><span class="ident" id="8075442">addr2</span><span class="op" id="8075447">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075451">c1</span><span class="op" id="8075453">.</span><span class="ident" id="8075454">LocalAddr</span><span class="op" id="8075463">(</span><span class="op" id="8075464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075468">c1</span><span class="op" id="8075470">.</span><span class="ident" id="8075471">SetDeadline</span><span class="op" id="8075482">(</span><span class="ident" id="8075483">time</span><span class="op" id="8075487">.</span><span class="ident" id="8075488">Now</span><span class="op" id="8075491">(</span><span class="op" id="8075492">)</span><span class="op" id="8075493">.</span><span class="ident" id="8075494">Add</span><span class="op" id="8075497">(</span><span class="num" id="8075498">100</span>&nbsp;<span class="op" id="8075502">*</span>&nbsp;<span class="ident" id="8075504">time</span><span class="op" id="8075508">.</span><span class="ident" id="8075509">Millisecond</span><span class="op" id="8075520">)</span><span class="op" id="8075521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075525">c1</span><span class="op" id="8075527">.</span><span class="ident" id="8075528">SetReadDeadline</span><span class="op" id="8075543">(</span><span class="ident" id="8075544">time</span><span class="op" id="8075548">.</span><span class="ident" id="8075549">Now</span><span class="op" id="8075552">(</span><span class="op" id="8075553">)</span><span class="op" id="8075554">.</span><span class="ident" id="8075555">Add</span><span class="op" id="8075558">(</span><span class="num" id="8075559">100</span>&nbsp;<span class="op" id="8075563">*</span>&nbsp;<span class="ident" id="8075565">time</span><span class="op" id="8075569">.</span><span class="ident" id="8075570">Millisecond</span><span class="op" id="8075581">)</span><span class="op" id="8075582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075586">c1</span><span class="op" id="8075588">.</span><span class="ident" id="8075589">SetWriteDeadline</span><span class="op" id="8075605">(</span><span class="ident" id="8075606">time</span><span class="op" id="8075610">.</span><span class="ident" id="8075611">Now</span><span class="op" id="8075614">(</span><span class="op" id="8075615">)</span><span class="op" id="8075616">.</span><span class="ident" id="8075617">Add</span><span class="op" id="8075620">(</span><span class="num" id="8075621">100</span>&nbsp;<span class="op" id="8075625">*</span>&nbsp;<span class="ident" id="8075627">time</span><span class="op" id="8075631">.</span><span class="ident" id="8075632">Millisecond</span><span class="op" id="8075643">)</span><span class="op" id="8075644">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075649">c2</span><span class="op" id="8075651">,</span>&nbsp;<span class="ident" id="8075653">err</span>&nbsp;<span class="op" id="8075657">:=</span>&nbsp;<span class="ident" id="8075660">ListenPacket</span><span class="op" id="8075672">(</span><span class="ident" id="8075673">tt</span><span class="op" id="8075675">.</span><span class="ident" id="8075676">net</span><span class="op" id="8075679">,</span>&nbsp;<span class="ident" id="8075681">tt</span><span class="op" id="8075683">.</span><span class="ident" id="8075684">addr2</span><span class="op" id="8075689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8075693">if</span>&nbsp;<span class="ident" id="8075696">err</span>&nbsp;<span class="op" id="8075700">!=</span>&nbsp;<span class="ident" id="8075703">nil</span>&nbsp;<span class="op" id="8075707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075712">t</span><span class="op" id="8075713">.</span><span class="ident" id="8075714">Fatalf</span><span class="op" id="8075720">(</span><span class="string" id="8075721">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8075746">,</span>&nbsp;<span class="ident" id="8075748">err</span><span class="op" id="8075751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8075755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8075759">defer</span>&nbsp;<span class="ident" id="8075765">closer</span><span class="op" id="8075771">(</span><span class="ident" id="8075772">c2</span><span class="op" id="8075774">,</span>&nbsp;<span class="ident" id="8075776">netstr</span><span class="op" id="8075782">[</span><span class="num" id="8075783">0</span><span class="op" id="8075784">]</span><span class="op" id="8075785">,</span>&nbsp;<span class="ident" id="8075787">tt</span><span class="op" id="8075789">.</span><span class="ident" id="8075790">addr1</span><span class="op" id="8075795">,</span>&nbsp;<span class="ident" id="8075797">tt</span><span class="op" id="8075799">.</span><span class="ident" id="8075800">addr2</span><span class="op" id="8075805">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075809">c2</span><span class="op" id="8075811">.</span><span class="ident" id="8075812">LocalAddr</span><span class="op" id="8075821">(</span><span class="op" id="8075822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075826">c2</span><span class="op" id="8075828">.</span><span class="ident" id="8075829">SetDeadline</span><span class="op" id="8075840">(</span><span class="ident" id="8075841">time</span><span class="op" id="8075845">.</span><span class="ident" id="8075846">Now</span><span class="op" id="8075849">(</span><span class="op" id="8075850">)</span><span class="op" id="8075851">.</span><span class="ident" id="8075852">Add</span><span class="op" id="8075855">(</span><span class="num" id="8075856">100</span>&nbsp;<span class="op" id="8075860">*</span>&nbsp;<span class="ident" id="8075862">time</span><span class="op" id="8075866">.</span><span class="ident" id="8075867">Millisecond</span><span class="op" id="8075878">)</span><span class="op" id="8075879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075883">c2</span><span class="op" id="8075885">.</span><span class="ident" id="8075886">SetReadDeadline</span><span class="op" id="8075901">(</span><span class="ident" id="8075902">time</span><span class="op" id="8075906">.</span><span class="ident" id="8075907">Now</span><span class="op" id="8075910">(</span><span class="op" id="8075911">)</span><span class="op" id="8075912">.</span><span class="ident" id="8075913">Add</span><span class="op" id="8075916">(</span><span class="num" id="8075917">100</span>&nbsp;<span class="op" id="8075921">*</span>&nbsp;<span class="ident" id="8075923">time</span><span class="op" id="8075927">.</span><span class="ident" id="8075928">Millisecond</span><span class="op" id="8075939">)</span><span class="op" id="8075940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8075944">c2</span><span class="op" id="8075946">.</span><span class="ident" id="8075947">SetWriteDeadline</span><span class="op" id="8075963">(</span><span class="ident" id="8075964">time</span><span class="op" id="8075968">.</span><span class="ident" id="8075969">Now</span><span class="op" id="8075972">(</span><span class="op" id="8075973">)</span><span class="op" id="8075974">.</span><span class="ident" id="8075975">Add</span><span class="op" id="8075978">(</span><span class="num" id="8075979">100</span>&nbsp;<span class="op" id="8075983">*</span>&nbsp;<span class="ident" id="8075985">time</span><span class="op" id="8075989">.</span><span class="ident" id="8075990">Millisecond</span><span class="op" id="8076001">)</span><span class="op" id="8076002">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8076007">if</span>&nbsp;<span class="ident" id="8076010">_</span><span class="op" id="8076011">,</span>&nbsp;<span class="ident" id="8076013">err</span>&nbsp;<span class="op" id="8076017">:=</span>&nbsp;<span class="ident" id="8076020">c1</span><span class="op" id="8076022">.</span><span class="ident" id="8076023">WriteTo</span><span class="op" id="8076030">(</span><span class="ident" id="8076031">wb</span><span class="op" id="8076033">,</span>&nbsp;<span class="ident" id="8076035">c2</span><span class="op" id="8076037">.</span><span class="ident" id="8076038">LocalAddr</span><span class="op" id="8076047">(</span><span class="op" id="8076048">)</span><span class="op" id="8076049">)</span><span class="op" id="8076050">;</span>&nbsp;<span class="ident" id="8076052">err</span>&nbsp;<span class="op" id="8076056">!=</span>&nbsp;<span class="ident" id="8076059">nil</span>&nbsp;<span class="op" id="8076063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8076068">t</span><span class="op" id="8076069">.</span><span class="ident" id="8076070">Fatalf</span><span class="op" id="8076076">(</span><span class="string" id="8076077">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8076108">,</span>&nbsp;<span class="ident" id="8076110">err</span><span class="op" id="8076113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8076117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8076121">rb2</span>&nbsp;<span class="op" id="8076125">:=</span>&nbsp;<span class="builtinfunc" id="8076128">make</span><span class="op" id="8076132">(</span><span class="op" id="8076133">[</span><span class="op" id="8076134">]</span><span class="builtintype" id="8076135">byte</span><span class="op" id="8076139">,</span>&nbsp;<span class="num" id="8076141">128</span><span class="op" id="8076144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8076148">if</span>&nbsp;<span class="ident" id="8076151">_</span><span class="op" id="8076152">,</span>&nbsp;<span class="ident" id="8076154">_</span><span class="op" id="8076155">,</span>&nbsp;<span class="ident" id="8076157">err</span>&nbsp;<span class="op" id="8076161">:=</span>&nbsp;<span class="ident" id="8076164">c2</span><span class="op" id="8076166">.</span><span class="ident" id="8076167">ReadFrom</span><span class="op" id="8076175">(</span><span class="ident" id="8076176">rb2</span><span class="op" id="8076179">)</span><span class="op" id="8076180">;</span>&nbsp;<span class="ident" id="8076182">err</span>&nbsp;<span class="op" id="8076186">!=</span>&nbsp;<span class="ident" id="8076189">nil</span>&nbsp;<span class="op" id="8076193">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8076198">t</span><span class="op" id="8076199">.</span><span class="ident" id="8076200">Fatalf</span><span class="op" id="8076206">(</span><span class="string" id="8076207">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8076239">,</span>&nbsp;<span class="ident" id="8076241">err</span><span class="op" id="8076244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8076248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8076252">if</span>&nbsp;<span class="ident" id="8076255">_</span><span class="op" id="8076256">,</span>&nbsp;<span class="ident" id="8076258">err</span>&nbsp;<span class="op" id="8076262">:=</span>&nbsp;<span class="ident" id="8076265">c2</span><span class="op" id="8076267">.</span><span class="ident" id="8076268">WriteTo</span><span class="op" id="8076275">(</span><span class="ident" id="8076276">wb</span><span class="op" id="8076278">,</span>&nbsp;<span class="ident" id="8076280">c1</span><span class="op" id="8076282">.</span><span class="ident" id="8076283">LocalAddr</span><span class="op" id="8076292">(</span><span class="op" id="8076293">)</span><span class="op" id="8076294">)</span><span class="op" id="8076295">;</span>&nbsp;<span class="ident" id="8076297">err</span>&nbsp;<span class="op" id="8076301">!=</span>&nbsp;<span class="ident" id="8076304">nil</span>&nbsp;<span class="op" id="8076308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8076313">t</span><span class="op" id="8076314">.</span><span class="ident" id="8076315">Fatalf</span><span class="op" id="8076321">(</span><span class="string" id="8076322">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8076353">,</span>&nbsp;<span class="ident" id="8076355">err</span><span class="op" id="8076358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8076362">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8076366">rb1</span>&nbsp;<span class="op" id="8076370">:=</span>&nbsp;<span class="builtinfunc" id="8076373">make</span><span class="op" id="8076377">(</span><span class="op" id="8076378">[</span><span class="op" id="8076379">]</span><span class="builtintype" id="8076380">byte</span><span class="op" id="8076384">,</span>&nbsp;<span class="num" id="8076386">128</span><span class="op" id="8076389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8076393">if</span>&nbsp;<span class="ident" id="8076396">_</span><span class="op" id="8076397">,</span>&nbsp;<span class="ident" id="8076399">_</span><span class="op" id="8076400">,</span>&nbsp;<span class="ident" id="8076402">err</span>&nbsp;<span class="op" id="8076406">:=</span>&nbsp;<span class="ident" id="8076409">c1</span><span class="op" id="8076411">.</span><span class="ident" id="8076412">ReadFrom</span><span class="op" id="8076420">(</span><span class="ident" id="8076421">rb1</span><span class="op" id="8076424">)</span><span class="op" id="8076425">;</span>&nbsp;<span class="ident" id="8076427">err</span>&nbsp;<span class="op" id="8076431">!=</span>&nbsp;<span class="ident" id="8076434">nil</span>&nbsp;<span class="op" id="8076438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8076443">t</span><span class="op" id="8076444">.</span><span class="ident" id="8076445">Fatalf</span><span class="op" id="8076451">(</span><span class="string" id="8076452">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8076484">,</span>&nbsp;<span class="ident" id="8076486">err</span><span class="op" id="8076489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8076493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8076496">}</span><br>
<span class="lineno">120</span><span class="op" id="8076498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8076501">func</span>&nbsp;<span class="ident" id="8076506">TestConnAndPacketConn</span><span class="op" id="8076527">(</span><span class="ident" id="8076528">t</span>&nbsp;<span class="op" id="8076530">*</span><span class="ident" id="8076531">testing</span><span class="op" id="8076538">.</span><span class="ident" id="8076539">T</span><span class="op" id="8076540">)</span>&nbsp;<span class="op" id="8076542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8076545">closer</span>&nbsp;<span class="op" id="8076552">:=</span>&nbsp;<span class="keyword" id="8076555">func</span><span class="op" id="8076559">(</span><span class="ident" id="8076560">c</span>&nbsp;<span class="ident" id="8076562">PacketConn</span><span class="op" id="8076572">,</span>&nbsp;<span class="ident" id="8076574">net</span><span class="op" id="8076577">,</span>&nbsp;<span class="ident" id="8076579">addr1</span><span class="op" id="8076584">,</span>&nbsp;<span class="ident" id="8076586">addr2</span>&nbsp;<span class="builtintype" id="8076592">string</span><span class="op" id="8076598">)</span>&nbsp;<span class="op" id="8076600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8076604">c</span><span class="op" id="8076605">.</span><span class="ident" id="8076606">Close</span><span class="op" id="8076611">(</span><span class="op" id="8076612">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8076616">switch</span>&nbsp;<span class="ident" id="8076623">net</span>&nbsp;<span class="op" id="8076627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8076631">case</span>&nbsp;<span class="string" id="8076636">&#34;unixgram&#34;</span><span class="op" id="8076646">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8076651">os</span><span class="op" id="8076653">.</span><span class="ident" id="8076654">Remove</span><span class="op" id="8076660">(</span><span class="ident" id="8076661">addr1</span><span class="op" id="8076666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8076671">os</span><span class="op" id="8076673">.</span><span class="ident" id="8076674">Remove</span><span class="op" id="8076680">(</span><span class="ident" id="8076681">addr2</span><span class="op" id="8076686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8076690">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8076693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8076697">for</span>&nbsp;<span class="ident" id="8076701">i</span><span class="op" id="8076702">,</span>&nbsp;<span class="ident" id="8076704">tt</span>&nbsp;<span class="op" id="8076707">:=</span>&nbsp;<span class="keyword" id="8076710">range</span>&nbsp;<span class="ident" id="8076716">packetConnTests</span>&nbsp;<span class="op" id="8076732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8076736">var</span>&nbsp;<span class="ident" id="8076740">wb</span>&nbsp;<span class="op" id="8076743">[</span><span class="op" id="8076744">]</span><span class="builtintype" id="8076745">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8076752">netstr</span>&nbsp;<span class="op" id="8076759">:=</span>&nbsp;<span class="ident" id="8076762">strings</span><span class="op" id="8076769">.</span><span class="ident" id="8076770">Split</span><span class="op" id="8076775">(</span><span class="ident" id="8076776">tt</span><span class="op" id="8076778">.</span><span class="ident" id="8076779">net</span><span class="op" id="8076782">,</span>&nbsp;<span class="string" id="8076784">&#34;:&#34;</span><span class="op" id="8076787">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8076791">wb</span><span class="op" id="8076793">,</span>&nbsp;<span class="ident" id="8076795">skipOrFatalFn</span>&nbsp;<span class="op" id="8076809">:=</span>&nbsp;<span class="ident" id="8076812">packetConnTestData</span><span class="op" id="8076830">(</span><span class="ident" id="8076831">t</span><span class="op" id="8076832">,</span>&nbsp;<span class="ident" id="8076834">netstr</span><span class="op" id="8076840">[</span><span class="num" id="8076841">0</span><span class="op" id="8076842">]</span><span class="op" id="8076843">,</span>&nbsp;<span class="ident" id="8076845">i</span><span class="op" id="8076846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8076850">if</span>&nbsp;<span class="ident" id="8076853">skipOrFatalFn</span>&nbsp;<span class="op" id="8076867">!=</span>&nbsp;<span class="ident" id="8076870">nil</span>&nbsp;<span class="op" id="8076874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8076879">skipOrFatalFn</span><span class="op" id="8076892">(</span><span class="op" id="8076893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8076898">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8076909">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8076914">c1</span><span class="op" id="8076916">,</span>&nbsp;<span class="ident" id="8076918">err</span>&nbsp;<span class="op" id="8076922">:=</span>&nbsp;<span class="ident" id="8076925">ListenPacket</span><span class="op" id="8076937">(</span><span class="ident" id="8076938">tt</span><span class="op" id="8076940">.</span><span class="ident" id="8076941">net</span><span class="op" id="8076944">,</span>&nbsp;<span class="ident" id="8076946">tt</span><span class="op" id="8076948">.</span><span class="ident" id="8076949">addr1</span><span class="op" id="8076954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8076958">if</span>&nbsp;<span class="ident" id="8076961">err</span>&nbsp;<span class="op" id="8076965">!=</span>&nbsp;<span class="ident" id="8076968">nil</span>&nbsp;<span class="op" id="8076972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8076977">t</span><span class="op" id="8076978">.</span><span class="ident" id="8076979">Fatalf</span><span class="op" id="8076985">(</span><span class="string" id="8076986">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8077011">,</span>&nbsp;<span class="ident" id="8077013">err</span><span class="op" id="8077016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8077020">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8077024">defer</span>&nbsp;<span class="ident" id="8077030">closer</span><span class="op" id="8077036">(</span><span class="ident" id="8077037">c1</span><span class="op" id="8077039">,</span>&nbsp;<span class="ident" id="8077041">netstr</span><span class="op" id="8077047">[</span><span class="num" id="8077048">0</span><span class="op" id="8077049">]</span><span class="op" id="8077050">,</span>&nbsp;<span class="ident" id="8077052">tt</span><span class="op" id="8077054">.</span><span class="ident" id="8077055">addr1</span><span class="op" id="8077060">,</span>&nbsp;<span class="ident" id="8077062">tt</span><span class="op" id="8077064">.</span><span class="ident" id="8077065">addr2</span><span class="op" id="8077070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8077074">c1</span><span class="op" id="8077076">.</span><span class="ident" id="8077077">LocalAddr</span><span class="op" id="8077086">(</span><span class="op" id="8077087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8077091">c1</span><span class="op" id="8077093">.</span><span class="ident" id="8077094">SetDeadline</span><span class="op" id="8077105">(</span><span class="ident" id="8077106">time</span><span class="op" id="8077110">.</span><span class="ident" id="8077111">Now</span><span class="op" id="8077114">(</span><span class="op" id="8077115">)</span><span class="op" id="8077116">.</span><span class="ident" id="8077117">Add</span><span class="op" id="8077120">(</span><span class="num" id="8077121">100</span>&nbsp;<span class="op" id="8077125">*</span>&nbsp;<span class="ident" id="8077127">time</span><span class="op" id="8077131">.</span><span class="ident" id="8077132">Millisecond</span><span class="op" id="8077143">)</span><span class="op" id="8077144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8077148">c1</span><span class="op" id="8077150">.</span><span class="ident" id="8077151">SetReadDeadline</span><span class="op" id="8077166">(</span><span class="ident" id="8077167">time</span><span class="op" id="8077171">.</span><span class="ident" id="8077172">Now</span><span class="op" id="8077175">(</span><span class="op" id="8077176">)</span><span class="op" id="8077177">.</span><span class="ident" id="8077178">Add</span><span class="op" id="8077181">(</span><span class="num" id="8077182">100</span>&nbsp;<span class="op" id="8077186">*</span>&nbsp;<span class="ident" id="8077188">time</span><span class="op" id="8077192">.</span><span class="ident" id="8077193">Millisecond</span><span class="op" id="8077204">)</span><span class="op" id="8077205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8077209">c1</span><span class="op" id="8077211">.</span><span class="ident" id="8077212">SetWriteDeadline</span><span class="op" id="8077228">(</span><span class="ident" id="8077229">time</span><span class="op" id="8077233">.</span><span class="ident" id="8077234">Now</span><span class="op" id="8077237">(</span><span class="op" id="8077238">)</span><span class="op" id="8077239">.</span><span class="ident" id="8077240">Add</span><span class="op" id="8077243">(</span><span class="num" id="8077244">100</span>&nbsp;<span class="op" id="8077248">*</span>&nbsp;<span class="ident" id="8077250">time</span><span class="op" id="8077254">.</span><span class="ident" id="8077255">Millisecond</span><span class="op" id="8077266">)</span><span class="op" id="8077267">)</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8077272">c2</span><span class="op" id="8077274">,</span>&nbsp;<span class="ident" id="8077276">err</span>&nbsp;<span class="op" id="8077280">:=</span>&nbsp;<span class="ident" id="8077283">Dial</span><span class="op" id="8077287">(</span><span class="ident" id="8077288">tt</span><span class="op" id="8077290">.</span><span class="ident" id="8077291">net</span><span class="op" id="8077294">,</span>&nbsp;<span class="ident" id="8077296">c1</span><span class="op" id="8077298">.</span><span class="ident" id="8077299">LocalAddr</span><span class="op" id="8077308">(</span><span class="op" id="8077309">)</span><span class="op" id="8077310">.</span><span class="ident" id="8077311">String</span><span class="op" id="8077317">(</span><span class="op" id="8077318">)</span><span class="op" id="8077319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8077323">if</span>&nbsp;<span class="ident" id="8077326">err</span>&nbsp;<span class="op" id="8077330">!=</span>&nbsp;<span class="ident" id="8077333">nil</span>&nbsp;<span class="op" id="8077337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8077342">t</span><span class="op" id="8077343">.</span><span class="ident" id="8077344">Fatalf</span><span class="op" id="8077350">(</span><span class="string" id="8077351">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8077368">,</span>&nbsp;<span class="ident" id="8077370">err</span><span class="op" id="8077373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8077377">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8077381">defer</span>&nbsp;<span class="ident" id="8077387">c2</span><span class="op" id="8077389">.</span><span class="ident" id="8077390">Close</span><span class="op" id="8077395">(</span><span class="op" id="8077396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8077400">c2</span><span class="op" id="8077402">.</span><span class="ident" id="8077403">LocalAddr</span><span class="op" id="8077412">(</span><span class="op" id="8077413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8077417">c2</span><span class="op" id="8077419">.</span><span class="ident" id="8077420">RemoteAddr</span><span class="op" id="8077430">(</span><span class="op" id="8077431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8077435">c2</span><span class="op" id="8077437">.</span><span class="ident" id="8077438">SetDeadline</span><span class="op" id="8077449">(</span><span class="ident" id="8077450">time</span><span class="op" id="8077454">.</span><span class="ident" id="8077455">Now</span><span class="op" id="8077458">(</span><span class="op" id="8077459">)</span><span class="op" id="8077460">.</span><span class="ident" id="8077461">Add</span><span class="op" id="8077464">(</span><span class="num" id="8077465">100</span>&nbsp;<span class="op" id="8077469">*</span>&nbsp;<span class="ident" id="8077471">time</span><span class="op" id="8077475">.</span><span class="ident" id="8077476">Millisecond</span><span class="op" id="8077487">)</span><span class="op" id="8077488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8077492">c2</span><span class="op" id="8077494">.</span><span class="ident" id="8077495">SetReadDeadline</span><span class="op" id="8077510">(</span><span class="ident" id="8077511">time</span><span class="op" id="8077515">.</span><span class="ident" id="8077516">Now</span><span class="op" id="8077519">(</span><span class="op" id="8077520">)</span><span class="op" id="8077521">.</span><span class="ident" id="8077522">Add</span><span class="op" id="8077525">(</span><span class="num" id="8077526">100</span>&nbsp;<span class="op" id="8077530">*</span>&nbsp;<span class="ident" id="8077532">time</span><span class="op" id="8077536">.</span><span class="ident" id="8077537">Millisecond</span><span class="op" id="8077548">)</span><span class="op" id="8077549">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8077553">c2</span><span class="op" id="8077555">.</span><span class="ident" id="8077556">SetWriteDeadline</span><span class="op" id="8077572">(</span><span class="ident" id="8077573">time</span><span class="op" id="8077577">.</span><span class="ident" id="8077578">Now</span><span class="op" id="8077581">(</span><span class="op" id="8077582">)</span><span class="op" id="8077583">.</span><span class="ident" id="8077584">Add</span><span class="op" id="8077587">(</span><span class="num" id="8077588">100</span>&nbsp;<span class="op" id="8077592">*</span>&nbsp;<span class="ident" id="8077594">time</span><span class="op" id="8077598">.</span><span class="ident" id="8077599">Millisecond</span><span class="op" id="8077610">)</span><span class="op" id="8077611">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8077616">if</span>&nbsp;<span class="ident" id="8077619">_</span><span class="op" id="8077620">,</span>&nbsp;<span class="ident" id="8077622">err</span>&nbsp;<span class="op" id="8077626">:=</span>&nbsp;<span class="ident" id="8077629">c2</span><span class="op" id="8077631">.</span><span class="ident" id="8077632">Write</span><span class="op" id="8077637">(</span><span class="ident" id="8077638">wb</span><span class="op" id="8077640">)</span><span class="op" id="8077641">;</span>&nbsp;<span class="ident" id="8077643">err</span>&nbsp;<span class="op" id="8077647">!=</span>&nbsp;<span class="ident" id="8077650">nil</span>&nbsp;<span class="op" id="8077654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8077659">t</span><span class="op" id="8077660">.</span><span class="ident" id="8077661">Fatalf</span><span class="op" id="8077667">(</span><span class="string" id="8077668">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8077691">,</span>&nbsp;<span class="ident" id="8077693">err</span><span class="op" id="8077696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8077700">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8077704">rb1</span>&nbsp;<span class="op" id="8077708">:=</span>&nbsp;<span class="builtinfunc" id="8077711">make</span><span class="op" id="8077715">(</span><span class="op" id="8077716">[</span><span class="op" id="8077717">]</span><span class="builtintype" id="8077718">byte</span><span class="op" id="8077722">,</span>&nbsp;<span class="num" id="8077724">128</span><span class="op" id="8077727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8077731">if</span>&nbsp;<span class="ident" id="8077734">_</span><span class="op" id="8077735">,</span>&nbsp;<span class="ident" id="8077737">_</span><span class="op" id="8077738">,</span>&nbsp;<span class="ident" id="8077740">err</span>&nbsp;<span class="op" id="8077744">:=</span>&nbsp;<span class="ident" id="8077747">c1</span><span class="op" id="8077749">.</span><span class="ident" id="8077750">ReadFrom</span><span class="op" id="8077758">(</span><span class="ident" id="8077759">rb1</span><span class="op" id="8077762">)</span><span class="op" id="8077763">;</span>&nbsp;<span class="ident" id="8077765">err</span>&nbsp;<span class="op" id="8077769">!=</span>&nbsp;<span class="ident" id="8077772">nil</span>&nbsp;<span class="op" id="8077776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8077781">t</span><span class="op" id="8077782">.</span><span class="ident" id="8077783">Fatalf</span><span class="op" id="8077789">(</span><span class="string" id="8077790">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8077822">,</span>&nbsp;<span class="ident" id="8077824">err</span><span class="op" id="8077827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8077831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8077835">var</span>&nbsp;<span class="ident" id="8077839">dst</span>&nbsp;<span class="ident" id="8077843">Addr</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8077850">switch</span>&nbsp;<span class="ident" id="8077857">netstr</span><span class="op" id="8077863">[</span><span class="num" id="8077864">0</span><span class="op" id="8077865">]</span>&nbsp;<span class="op" id="8077867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8077871">case</span>&nbsp;<span class="string" id="8077876">&#34;ip&#34;</span><span class="op" id="8077880">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8077885">dst</span>&nbsp;<span class="op" id="8077889">=</span>&nbsp;<span class="op" id="8077891">&amp;</span><span class="ident" id="8077892">IPAddr</span><span class="op" id="8077898">{</span><span class="ident" id="8077899">IP</span><span class="op" id="8077901">:</span>&nbsp;<span class="ident" id="8077903">IPv4</span><span class="op" id="8077907">(</span><span class="num" id="8077908">127</span><span class="op" id="8077911">,</span>&nbsp;<span class="num" id="8077913">0</span><span class="op" id="8077914">,</span>&nbsp;<span class="num" id="8077916">0</span><span class="op" id="8077917">,</span>&nbsp;<span class="num" id="8077919">1</span><span class="op" id="8077920">)</span><span class="op" id="8077921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8077925">case</span>&nbsp;<span class="string" id="8077930">&#34;unixgram&#34;</span><span class="op" id="8077940">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8077945">continue</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8077956">default</span><span class="op" id="8077963">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8077968">dst</span>&nbsp;<span class="op" id="8077972">=</span>&nbsp;<span class="ident" id="8077974">c2</span><span class="op" id="8077976">.</span><span class="ident" id="8077977">LocalAddr</span><span class="op" id="8077986">(</span><span class="op" id="8077987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8077991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8077995">if</span>&nbsp;<span class="ident" id="8077998">_</span><span class="op" id="8077999">,</span>&nbsp;<span class="ident" id="8078001">err</span>&nbsp;<span class="op" id="8078005">:=</span>&nbsp;<span class="ident" id="8078008">c1</span><span class="op" id="8078010">.</span><span class="ident" id="8078011">WriteTo</span><span class="op" id="8078018">(</span><span class="ident" id="8078019">wb</span><span class="op" id="8078021">,</span>&nbsp;<span class="ident" id="8078023">dst</span><span class="op" id="8078026">)</span><span class="op" id="8078027">;</span>&nbsp;<span class="ident" id="8078029">err</span>&nbsp;<span class="op" id="8078033">!=</span>&nbsp;<span class="ident" id="8078036">nil</span>&nbsp;<span class="op" id="8078040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8078045">t</span><span class="op" id="8078046">.</span><span class="ident" id="8078047">Fatalf</span><span class="op" id="8078053">(</span><span class="string" id="8078054">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8078085">,</span>&nbsp;<span class="ident" id="8078087">err</span><span class="op" id="8078090">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8078094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8078098">rb2</span>&nbsp;<span class="op" id="8078102">:=</span>&nbsp;<span class="builtinfunc" id="8078105">make</span><span class="op" id="8078109">(</span><span class="op" id="8078110">[</span><span class="op" id="8078111">]</span><span class="builtintype" id="8078112">byte</span><span class="op" id="8078116">,</span>&nbsp;<span class="num" id="8078118">128</span><span class="op" id="8078121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8078125">if</span>&nbsp;<span class="ident" id="8078128">_</span><span class="op" id="8078129">,</span>&nbsp;<span class="ident" id="8078131">err</span>&nbsp;<span class="op" id="8078135">:=</span>&nbsp;<span class="ident" id="8078138">c2</span><span class="op" id="8078140">.</span><span class="ident" id="8078141">Read</span><span class="op" id="8078145">(</span><span class="ident" id="8078146">rb2</span><span class="op" id="8078149">)</span><span class="op" id="8078150">;</span>&nbsp;<span class="ident" id="8078152">err</span>&nbsp;<span class="op" id="8078156">!=</span>&nbsp;<span class="ident" id="8078159">nil</span>&nbsp;<span class="op" id="8078163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8078168">t</span><span class="op" id="8078169">.</span><span class="ident" id="8078170">Fatalf</span><span class="op" id="8078176">(</span><span class="string" id="8078177">&#34;Conn.Read&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8078199">,</span>&nbsp;<span class="ident" id="8078201">err</span><span class="op" id="8078204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8078208">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8078211">}</span><br>
<span class="lineno"></span><span class="op" id="8078213">}</span>
</div>
</body>
</html>
