<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4512178">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4512233">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4512287">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4512338">//&nbsp;Package&nbsp;dsa&nbsp;implements&nbsp;the&nbsp;Digital&nbsp;Signature&nbsp;Algorithm,&nbsp;as&nbsp;defined&nbsp;in&nbsp;FIPS&nbsp;186-3.</span><br>
<span class="lineno"></span><span class="keyword" id="4512423">package</span>&nbsp;<span class="ident" id="4512431">dsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4512436">import</span>&nbsp;<span class="op" id="4512443">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4512446">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4512456">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4512462">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4512473">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4512476">//&nbsp;Parameters&nbsp;represents&nbsp;the&nbsp;domain&nbsp;parameters&nbsp;for&nbsp;a&nbsp;key.&nbsp;These&nbsp;parameters&nbsp;can</span><br>
<span class="lineno">15</span><span class="comment" id="4512555">//&nbsp;be&nbsp;shared&nbsp;across&nbsp;many&nbsp;keys.&nbsp;The&nbsp;bit&nbsp;length&nbsp;of&nbsp;Q&nbsp;must&nbsp;be&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8.</span><br>
<span class="lineno"></span><span class="keyword" id="4512631">type</span>&nbsp;<span class="ident" id="4512636">Parameters</span>&nbsp;<span class="keyword" id="4512647">struct</span>&nbsp;<span class="op" id="4512654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4512657">P</span><span class="op" id="4512658">,</span>&nbsp;<span class="ident" id="4512660">Q</span><span class="op" id="4512661">,</span>&nbsp;<span class="ident" id="4512663">G</span>&nbsp;<span class="op" id="4512665">*</span><span class="ident" id="4512666"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4512669">.</span><span class="ident" id="4512670">Int</span><br>
<span class="lineno"></span><span class="op" id="4512674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="4512677">//&nbsp;PublicKey&nbsp;represents&nbsp;a&nbsp;DSA&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4512719">type</span>&nbsp;<span class="ident" id="4512724">PublicKey</span>&nbsp;<span class="keyword" id="4512734">struct</span>&nbsp;<span class="op" id="4512741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4512744"><a href="/crypto/dsa/dsa.go.html#4512636">Parameters</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4512756">Y</span>&nbsp;<span class="op" id="4512758">*</span><span class="ident" id="4512759"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4512762">.</span><span class="ident" id="4512763">Int</span><br>
<span class="lineno"></span><span class="op" id="4512767">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4512770">//&nbsp;PrivateKey&nbsp;represents&nbsp;a&nbsp;DSA&nbsp;private&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4512814">type</span>&nbsp;<span class="ident" id="4512819">PrivateKey</span>&nbsp;<span class="keyword" id="4512830">struct</span>&nbsp;<span class="op" id="4512837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4512840"><a href="/crypto/dsa/dsa.go.html#4512724">PublicKey</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4512851">X</span>&nbsp;<span class="op" id="4512853">*</span><span class="ident" id="4512854"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4512857">.</span><span class="ident" id="4512858">Int</span><br>
<span class="lineno">30</span><span class="op" id="4512862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4512865">//&nbsp;ErrInvalidPublicKey&nbsp;results&nbsp;when&nbsp;a&nbsp;public&nbsp;key&nbsp;is&nbsp;not&nbsp;usable&nbsp;by&nbsp;this&nbsp;code.</span><br>
<span class="lineno"></span><span class="comment" id="4512942">//&nbsp;FIPS&nbsp;is&nbsp;quite&nbsp;strict&nbsp;about&nbsp;the&nbsp;format&nbsp;of&nbsp;DSA&nbsp;keys,&nbsp;but&nbsp;other&nbsp;code&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4513018">//&nbsp;less&nbsp;so.&nbsp;Thus,&nbsp;when&nbsp;using&nbsp;keys&nbsp;which&nbsp;may&nbsp;have&nbsp;been&nbsp;generated&nbsp;by&nbsp;other&nbsp;code,</span><br>
<span class="lineno">35</span><span class="comment" id="4513097">//&nbsp;this&nbsp;error&nbsp;must&nbsp;be&nbsp;handled.</span><br>
<span class="lineno"></span><span class="keyword" id="4513128">var</span>&nbsp;<span class="ident" id="4513132">ErrInvalidPublicKey</span>&nbsp;<span class="op" id="4513152">=</span>&nbsp;<span class="ident" id="4513154"><a href="/crypto/dsa/dsa.go.html#4512446">errors</a></span><span class="op" id="4513160">.</span><span class="ident" id="4513161">New</span><span class="op" id="4513164">(</span><span class="string" id="4513165">&#34;crypto/dsa:&nbsp;invalid&nbsp;public&nbsp;key&#34;</span><span class="op" id="4513197">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4513200">//&nbsp;ParameterSizes&nbsp;is&nbsp;a&nbsp;enumeration&nbsp;of&nbsp;the&nbsp;acceptable&nbsp;bit&nbsp;lengths&nbsp;of&nbsp;the&nbsp;primes</span><br>
<span class="lineno"></span><span class="comment" id="4513279">//&nbsp;in&nbsp;a&nbsp;set&nbsp;of&nbsp;DSA&nbsp;parameters.&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;4.2.</span><br>
<span class="lineno">40</span><span class="keyword" id="4513339">type</span>&nbsp;<span class="ident" id="4513344">ParameterSizes</span>&nbsp;<span class="builtintype" id="4513359">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4513364">const</span>&nbsp;<span class="op" id="4513370">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4513373">L1024N160</span>&nbsp;<span class="ident" id="4513383"><a href="/crypto/dsa/dsa.go.html#4513344">ParameterSizes</a></span>&nbsp;<span class="op" id="4513398">=</span>&nbsp;<span class="ident" id="4513400">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4513406">L2048N224</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4513417">L2048N256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4513428">L3072N256</span><br>
<span class="lineno"></span><span class="op" id="4513438">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4513441">//&nbsp;numMRTests&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;Miller-Rabin&nbsp;primality&nbsp;tests&nbsp;that&nbsp;we&nbsp;perform.&nbsp;We</span><br>
<span class="lineno">50</span><span class="comment" id="4513521">//&nbsp;pick&nbsp;the&nbsp;largest&nbsp;recommended&nbsp;number&nbsp;from&nbsp;table&nbsp;C.1&nbsp;of&nbsp;FIPS&nbsp;186-3.</span><br>
<span class="lineno"></span><span class="keyword" id="4513590">const</span>&nbsp;<span class="ident" id="4513596">numMRTests</span>&nbsp;<span class="op" id="4513607">=</span>&nbsp;<span class="num" id="4513609">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4513613">//&nbsp;GenerateParameters&nbsp;puts&nbsp;a&nbsp;random,&nbsp;valid&nbsp;set&nbsp;of&nbsp;DSA&nbsp;parameters&nbsp;into&nbsp;params.</span><br>
<span class="lineno"></span><span class="comment" id="4513691">//&nbsp;This&nbsp;function&nbsp;takes&nbsp;many&nbsp;seconds,&nbsp;even&nbsp;on&nbsp;fast&nbsp;machines.</span><br>
<span class="lineno">55</span><span class="keyword" id="4513751">func</span>&nbsp;<span class="ident" id="4513756">GenerateParameters</span><span class="op" id="4513774">(</span><span class="ident" id="4513775">params</span>&nbsp;<span class="op" id="4513782">*</span><span class="ident" id="4513783"><a href="/crypto/dsa/dsa.go.html#4512636">Parameters</a></span><span class="op" id="4513793">,</span>&nbsp;<span class="ident" id="4513795">rand</span>&nbsp;<span class="ident" id="4513800"><a href="/crypto/dsa/dsa.go.html#4512456">io</a></span><span class="op" id="4513802">.</span><span class="ident" id="4513803">Reader</span><span class="op" id="4513809">,</span>&nbsp;<span class="ident" id="4513811">sizes</span>&nbsp;<span class="ident" id="4513817"><a href="/crypto/dsa/dsa.go.html#4513344">ParameterSizes</a></span><span class="op" id="4513831">)</span>&nbsp;<span class="op" id="4513833">(</span><span class="ident" id="4513834">err</span>&nbsp;<span class="builtintype" id="4513838">error</span><span class="op" id="4513843">)</span>&nbsp;<span class="op" id="4513845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4513848">//&nbsp;This&nbsp;function&nbsp;doesn&#39;t&nbsp;follow&nbsp;FIPS&nbsp;186-3&nbsp;exactly&nbsp;in&nbsp;that&nbsp;it&nbsp;doesn&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4513919">//&nbsp;use&nbsp;a&nbsp;verification&nbsp;seed&nbsp;to&nbsp;generate&nbsp;the&nbsp;primes.&nbsp;The&nbsp;verification</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4513988">//&nbsp;seed&nbsp;doesn&#39;t&nbsp;appear&nbsp;to&nbsp;be&nbsp;exported&nbsp;or&nbsp;used&nbsp;by&nbsp;other&nbsp;code&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4514053">//&nbsp;omitting&nbsp;it&nbsp;makes&nbsp;the&nbsp;code&nbsp;cleaner.</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514094">var</span>&nbsp;<span class="ident" id="4514098">L</span><span class="op" id="4514099">,</span>&nbsp;<span class="ident" id="4514101">N</span>&nbsp;<span class="builtintype" id="4514103">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514108">switch</span>&nbsp;<span class="ident" id="4514115"><a href="/crypto/dsa/dsa.go.html#4513811">sizes</a></span>&nbsp;<span class="op" id="4514121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514124">case</span>&nbsp;<span class="ident" id="4514129"><a href="/crypto/dsa/dsa.go.html#4513373">L1024N160</a></span><span class="op" id="4514138">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514142"><a href="/crypto/dsa/dsa.go.html#4514098">L</a></span>&nbsp;<span class="op" id="4514144">=</span>&nbsp;<span class="num" id="4514146">1024</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514153"><a href="/crypto/dsa/dsa.go.html#4514101">N</a></span>&nbsp;<span class="op" id="4514155">=</span>&nbsp;<span class="num" id="4514157">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514162">case</span>&nbsp;<span class="ident" id="4514167"><a href="/crypto/dsa/dsa.go.html#4513406">L2048N224</a></span><span class="op" id="4514176">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514180"><a href="/crypto/dsa/dsa.go.html#4514098">L</a></span>&nbsp;<span class="op" id="4514182">=</span>&nbsp;<span class="num" id="4514184">2048</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514191"><a href="/crypto/dsa/dsa.go.html#4514101">N</a></span>&nbsp;<span class="op" id="4514193">=</span>&nbsp;<span class="num" id="4514195">224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514200">case</span>&nbsp;<span class="ident" id="4514205"><a href="/crypto/dsa/dsa.go.html#4513417">L2048N256</a></span><span class="op" id="4514214">:</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514218"><a href="/crypto/dsa/dsa.go.html#4514098">L</a></span>&nbsp;<span class="op" id="4514220">=</span>&nbsp;<span class="num" id="4514222">2048</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514229"><a href="/crypto/dsa/dsa.go.html#4514101">N</a></span>&nbsp;<span class="op" id="4514231">=</span>&nbsp;<span class="num" id="4514233">256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514238">case</span>&nbsp;<span class="ident" id="4514243"><a href="/crypto/dsa/dsa.go.html#4513428">L3072N256</a></span><span class="op" id="4514252">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514256"><a href="/crypto/dsa/dsa.go.html#4514098">L</a></span>&nbsp;<span class="op" id="4514258">=</span>&nbsp;<span class="num" id="4514260">3072</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514267"><a href="/crypto/dsa/dsa.go.html#4514101">N</a></span>&nbsp;<span class="op" id="4514269">=</span>&nbsp;<span class="num" id="4514271">256</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514276">default</span><span class="op" id="4514283">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514287">return</span>&nbsp;<span class="ident" id="4514294"><a href="/crypto/dsa/dsa.go.html#4512446">errors</a></span><span class="op" id="4514300">.</span><span class="ident" id="4514301">New</span><span class="op" id="4514304">(</span><span class="string" id="4514305">&#34;crypto/dsa:&nbsp;invalid&nbsp;ParameterSizes&#34;</span><span class="op" id="4514341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4514344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514348">qBytes</span>&nbsp;<span class="op" id="4514355">:=</span>&nbsp;<span class="builtinfunc" id="4514358">make</span><span class="op" id="4514362">(</span><span class="op" id="4514363">[</span><span class="op" id="4514364">]</span><span class="builtintype" id="4514365">byte</span><span class="op" id="4514369">,</span>&nbsp;<span class="ident" id="4514371"><a href="/crypto/dsa/dsa.go.html#4514101">N</a></span><span class="op" id="4514372">/</span><span class="num" id="4514373">8</span><span class="op" id="4514374">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514377">pBytes</span>&nbsp;<span class="op" id="4514384">:=</span>&nbsp;<span class="builtinfunc" id="4514387">make</span><span class="op" id="4514391">(</span><span class="op" id="4514392">[</span><span class="op" id="4514393">]</span><span class="builtintype" id="4514394">byte</span><span class="op" id="4514398">,</span>&nbsp;<span class="ident" id="4514400"><a href="/crypto/dsa/dsa.go.html#4514098">L</a></span><span class="op" id="4514401">/</span><span class="num" id="4514402">8</span><span class="op" id="4514403">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514407">q</span>&nbsp;<span class="op" id="4514409">:=</span>&nbsp;<span class="builtinfunc" id="4514412">new</span><span class="op" id="4514415">(</span><span class="ident" id="4514416"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4514419">.</span><span class="ident" id="4514420">Int</span><span class="op" id="4514423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514426">p</span>&nbsp;<span class="op" id="4514428">:=</span>&nbsp;<span class="builtinfunc" id="4514431">new</span><span class="op" id="4514434">(</span><span class="ident" id="4514435"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4514438">.</span><span class="ident" id="4514439">Int</span><span class="op" id="4514442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514445">rem</span>&nbsp;<span class="op" id="4514449">:=</span>&nbsp;<span class="builtinfunc" id="4514452">new</span><span class="op" id="4514455">(</span><span class="ident" id="4514456"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4514459">.</span><span class="ident" id="4514460">Int</span><span class="op" id="4514463">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514466">one</span>&nbsp;<span class="op" id="4514470">:=</span>&nbsp;<span class="builtinfunc" id="4514473">new</span><span class="op" id="4514476">(</span><span class="ident" id="4514477"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4514480">.</span><span class="ident" id="4514481">Int</span><span class="op" id="4514484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514487"><a href="/crypto/dsa/dsa.go.html#4514466">one</a></span><span class="op" id="4514490">.</span><span class="ident" id="4514491">SetInt64</span><span class="op" id="4514499">(</span><span class="num" id="4514500">1</span><span class="op" id="4514501">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="4514504">GeneratePrimes</span><span class="op" id="4514518">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514521">for</span>&nbsp;<span class="op" id="4514525">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514529">_</span><span class="op" id="4514530">,</span>&nbsp;<span class="ident" id="4514532"><a href="/crypto/dsa/dsa.go.html#4513834">err</a></span>&nbsp;<span class="op" id="4514536">=</span>&nbsp;<span class="ident" id="4514538"><a href="/crypto/dsa/dsa.go.html#4512456">io</a></span><span class="op" id="4514540">.</span><span class="ident" id="4514541">ReadFull</span><span class="op" id="4514549">(</span><span class="ident" id="4514550"><a href="/crypto/dsa/dsa.go.html#4513795">rand</a></span><span class="op" id="4514554">,</span>&nbsp;<span class="ident" id="4514556"><a href="/crypto/dsa/dsa.go.html#4514348">qBytes</a></span><span class="op" id="4514562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514566">if</span>&nbsp;<span class="ident" id="4514569"><a href="/crypto/dsa/dsa.go.html#4513834">err</a></span>&nbsp;<span class="op" id="4514573">!=</span>&nbsp;<span class="ident" id="4514576">nil</span>&nbsp;<span class="op" id="4514580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514585">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4514594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514599"><a href="/crypto/dsa/dsa.go.html#4514348">qBytes</a></span><span class="op" id="4514605">[</span><span class="builtinfunc" id="4514606">len</span><span class="op" id="4514609">(</span><span class="ident" id="4514610"><a href="/crypto/dsa/dsa.go.html#4514348">qBytes</a></span><span class="op" id="4514616">)</span><span class="op" id="4514617">-</span><span class="num" id="4514618">1</span><span class="op" id="4514619">]</span>&nbsp;<span class="op" id="4514621">|=</span>&nbsp;<span class="num" id="4514624">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514628"><a href="/crypto/dsa/dsa.go.html#4514348">qBytes</a></span><span class="op" id="4514634">[</span><span class="num" id="4514635">0</span><span class="op" id="4514636">]</span>&nbsp;<span class="op" id="4514638">|=</span>&nbsp;<span class="num" id="4514641">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514648"><a href="/crypto/dsa/dsa.go.html#4514407">q</a></span><span class="op" id="4514649">.</span><span class="ident" id="4514650">SetBytes</span><span class="op" id="4514658">(</span><span class="ident" id="4514659"><a href="/crypto/dsa/dsa.go.html#4514348">qBytes</a></span><span class="op" id="4514665">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514670">if</span>&nbsp;<span class="op" id="4514673">!</span><span class="ident" id="4514674"><a href="/crypto/dsa/dsa.go.html#4514407">q</a></span><span class="op" id="4514675">.</span><span class="ident" id="4514676">ProbablyPrime</span><span class="op" id="4514689">(</span><span class="ident" id="4514690"><a href="/crypto/dsa/dsa.go.html#4513596">numMRTests</a></span><span class="op" id="4514700">)</span>&nbsp;<span class="op" id="4514702">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514707">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4514718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514723">for</span>&nbsp;<span class="ident" id="4514727">i</span>&nbsp;<span class="op" id="4514729">:=</span>&nbsp;<span class="num" id="4514732">0</span><span class="op" id="4514733">;</span>&nbsp;<span class="ident" id="4514735"><a href="/crypto/dsa/dsa.go.html#4514727">i</a></span>&nbsp;<span class="op" id="4514737">&lt;</span>&nbsp;<span class="num" id="4514739">4</span><span class="op" id="4514740">*</span><span class="ident" id="4514741"><a href="/crypto/dsa/dsa.go.html#4514098">L</a></span><span class="op" id="4514742">;</span>&nbsp;<span class="ident" id="4514744"><a href="/crypto/dsa/dsa.go.html#4514727">i</a></span><span class="op" id="4514745">++</span>&nbsp;<span class="op" id="4514748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514753">_</span><span class="op" id="4514754">,</span>&nbsp;<span class="ident" id="4514756"><a href="/crypto/dsa/dsa.go.html#4513834">err</a></span>&nbsp;<span class="op" id="4514760">=</span>&nbsp;<span class="ident" id="4514762"><a href="/crypto/dsa/dsa.go.html#4512456">io</a></span><span class="op" id="4514764">.</span><span class="ident" id="4514765">ReadFull</span><span class="op" id="4514773">(</span><span class="ident" id="4514774"><a href="/crypto/dsa/dsa.go.html#4513795">rand</a></span><span class="op" id="4514778">,</span>&nbsp;<span class="ident" id="4514780"><a href="/crypto/dsa/dsa.go.html#4514377">pBytes</a></span><span class="op" id="4514786">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514791">if</span>&nbsp;<span class="ident" id="4514794"><a href="/crypto/dsa/dsa.go.html#4513834">err</a></span>&nbsp;<span class="op" id="4514798">!=</span>&nbsp;<span class="ident" id="4514801">nil</span>&nbsp;<span class="op" id="4514805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514811">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4514821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514827"><a href="/crypto/dsa/dsa.go.html#4514377">pBytes</a></span><span class="op" id="4514833">[</span><span class="builtinfunc" id="4514834">len</span><span class="op" id="4514837">(</span><span class="ident" id="4514838"><a href="/crypto/dsa/dsa.go.html#4514377">pBytes</a></span><span class="op" id="4514844">)</span><span class="op" id="4514845">-</span><span class="num" id="4514846">1</span><span class="op" id="4514847">]</span>&nbsp;<span class="op" id="4514849">|=</span>&nbsp;<span class="num" id="4514852">1</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514857"><a href="/crypto/dsa/dsa.go.html#4514377">pBytes</a></span><span class="op" id="4514863">[</span><span class="num" id="4514864">0</span><span class="op" id="4514865">]</span>&nbsp;<span class="op" id="4514867">|=</span>&nbsp;<span class="num" id="4514870">0x80</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514879"><a href="/crypto/dsa/dsa.go.html#4514426">p</a></span><span class="op" id="4514880">.</span><span class="ident" id="4514881">SetBytes</span><span class="op" id="4514889">(</span><span class="ident" id="4514890"><a href="/crypto/dsa/dsa.go.html#4514377">pBytes</a></span><span class="op" id="4514896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514901"><a href="/crypto/dsa/dsa.go.html#4514445">rem</a></span><span class="op" id="4514904">.</span><span class="ident" id="4514905">Mod</span><span class="op" id="4514908">(</span><span class="ident" id="4514909"><a href="/crypto/dsa/dsa.go.html#4514426">p</a></span><span class="op" id="4514910">,</span>&nbsp;<span class="ident" id="4514912"><a href="/crypto/dsa/dsa.go.html#4514407">q</a></span><span class="op" id="4514913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514918"><a href="/crypto/dsa/dsa.go.html#4514445">rem</a></span><span class="op" id="4514921">.</span><span class="ident" id="4514922">Sub</span><span class="op" id="4514925">(</span><span class="ident" id="4514926"><a href="/crypto/dsa/dsa.go.html#4514445">rem</a></span><span class="op" id="4514929">,</span>&nbsp;<span class="ident" id="4514931"><a href="/crypto/dsa/dsa.go.html#4514466">one</a></span><span class="op" id="4514934">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4514939"><a href="/crypto/dsa/dsa.go.html#4514426">p</a></span><span class="op" id="4514940">.</span><span class="ident" id="4514941">Sub</span><span class="op" id="4514944">(</span><span class="ident" id="4514945"><a href="/crypto/dsa/dsa.go.html#4514426">p</a></span><span class="op" id="4514946">,</span>&nbsp;<span class="ident" id="4514948"><a href="/crypto/dsa/dsa.go.html#4514445">rem</a></span><span class="op" id="4514951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514956">if</span>&nbsp;<span class="ident" id="4514959"><a href="/crypto/dsa/dsa.go.html#4514426">p</a></span><span class="op" id="4514960">.</span><span class="ident" id="4514961">BitLen</span><span class="op" id="4514967">(</span><span class="op" id="4514968">)</span>&nbsp;<span class="op" id="4514970">&lt;</span>&nbsp;<span class="ident" id="4514972"><a href="/crypto/dsa/dsa.go.html#4514098">L</a></span>&nbsp;<span class="op" id="4514974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514980">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4514992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4514998">if</span>&nbsp;<span class="op" id="4515001">!</span><span class="ident" id="4515002"><a href="/crypto/dsa/dsa.go.html#4514426">p</a></span><span class="op" id="4515003">.</span><span class="ident" id="4515004">ProbablyPrime</span><span class="op" id="4515017">(</span><span class="ident" id="4515018"><a href="/crypto/dsa/dsa.go.html#4513596">numMRTests</a></span><span class="op" id="4515028">)</span>&nbsp;<span class="op" id="4515030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515036">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4515048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515054"><a href="/crypto/dsa/dsa.go.html#4513775">params</a></span><span class="op" id="4515060">.</span><span class="ident" id="4515061">P</span>&nbsp;<span class="op" id="4515063">=</span>&nbsp;<span class="ident" id="4515065"><a href="/crypto/dsa/dsa.go.html#4514426">p</a></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515070"><a href="/crypto/dsa/dsa.go.html#4513775">params</a></span><span class="op" id="4515076">.</span><span class="ident" id="4515077">Q</span>&nbsp;<span class="op" id="4515079">=</span>&nbsp;<span class="ident" id="4515081"><a href="/crypto/dsa/dsa.go.html#4514407">q</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515086">break</span>&nbsp;<span class="ident" id="4515092">GeneratePrimes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4515109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4515112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515116">h</span>&nbsp;<span class="op" id="4515118">:=</span>&nbsp;<span class="builtinfunc" id="4515121">new</span><span class="op" id="4515124">(</span><span class="ident" id="4515125"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4515128">.</span><span class="ident" id="4515129">Int</span><span class="op" id="4515132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515135"><a href="/crypto/dsa/dsa.go.html#4515116">h</a></span><span class="op" id="4515136">.</span><span class="ident" id="4515137">SetInt64</span><span class="op" id="4515145">(</span><span class="num" id="4515146">2</span><span class="op" id="4515147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515150">g</span>&nbsp;<span class="op" id="4515152">:=</span>&nbsp;<span class="builtinfunc" id="4515155">new</span><span class="op" id="4515158">(</span><span class="ident" id="4515159"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4515162">.</span><span class="ident" id="4515163">Int</span><span class="op" id="4515166">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515170">pm1</span>&nbsp;<span class="op" id="4515174">:=</span>&nbsp;<span class="builtinfunc" id="4515177">new</span><span class="op" id="4515180">(</span><span class="ident" id="4515181"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4515184">.</span><span class="ident" id="4515185">Int</span><span class="op" id="4515188">)</span><span class="op" id="4515189">.</span><span class="ident" id="4515190">Sub</span><span class="op" id="4515193">(</span><span class="ident" id="4515194"><a href="/crypto/dsa/dsa.go.html#4514426">p</a></span><span class="op" id="4515195">,</span>&nbsp;<span class="ident" id="4515197"><a href="/crypto/dsa/dsa.go.html#4514466">one</a></span><span class="op" id="4515200">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515203">e</span>&nbsp;<span class="op" id="4515205">:=</span>&nbsp;<span class="builtinfunc" id="4515208">new</span><span class="op" id="4515211">(</span><span class="ident" id="4515212"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4515215">.</span><span class="ident" id="4515216">Int</span><span class="op" id="4515219">)</span><span class="op" id="4515220">.</span><span class="ident" id="4515221">Div</span><span class="op" id="4515224">(</span><span class="ident" id="4515225"><a href="/crypto/dsa/dsa.go.html#4515170">pm1</a></span><span class="op" id="4515228">,</span>&nbsp;<span class="ident" id="4515230"><a href="/crypto/dsa/dsa.go.html#4514407">q</a></span><span class="op" id="4515231">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515235">for</span>&nbsp;<span class="op" id="4515239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515243"><a href="/crypto/dsa/dsa.go.html#4515150">g</a></span><span class="op" id="4515244">.</span><span class="ident" id="4515245">Exp</span><span class="op" id="4515248">(</span><span class="ident" id="4515249"><a href="/crypto/dsa/dsa.go.html#4515116">h</a></span><span class="op" id="4515250">,</span>&nbsp;<span class="ident" id="4515252"><a href="/crypto/dsa/dsa.go.html#4515203">e</a></span><span class="op" id="4515253">,</span>&nbsp;<span class="ident" id="4515255"><a href="/crypto/dsa/dsa.go.html#4514426">p</a></span><span class="op" id="4515256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515260">if</span>&nbsp;<span class="ident" id="4515263"><a href="/crypto/dsa/dsa.go.html#4515150">g</a></span><span class="op" id="4515264">.</span><span class="ident" id="4515265">Cmp</span><span class="op" id="4515268">(</span><span class="ident" id="4515269"><a href="/crypto/dsa/dsa.go.html#4514466">one</a></span><span class="op" id="4515272">)</span>&nbsp;<span class="op" id="4515274">==</span>&nbsp;<span class="num" id="4515277">0</span>&nbsp;<span class="op" id="4515279">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515284"><a href="/crypto/dsa/dsa.go.html#4515116">h</a></span><span class="op" id="4515285">.</span><span class="ident" id="4515286">Add</span><span class="op" id="4515289">(</span><span class="ident" id="4515290"><a href="/crypto/dsa/dsa.go.html#4515116">h</a></span><span class="op" id="4515291">,</span>&nbsp;<span class="ident" id="4515293"><a href="/crypto/dsa/dsa.go.html#4514466">one</a></span><span class="op" id="4515296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515301">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4515312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515317"><a href="/crypto/dsa/dsa.go.html#4513775">params</a></span><span class="op" id="4515323">.</span><span class="ident" id="4515324">G</span>&nbsp;<span class="op" id="4515326">=</span>&nbsp;<span class="ident" id="4515328"><a href="/crypto/dsa/dsa.go.html#4515150">g</a></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515332">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4515340">}</span><br>
<span class="lineno"></span><span class="op" id="4515342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4515345">//&nbsp;GenerateKey&nbsp;generates&nbsp;a&nbsp;public&amp;private&nbsp;key&nbsp;pair.&nbsp;The&nbsp;Parameters&nbsp;of&nbsp;the</span><br>
<span class="lineno">150</span><span class="comment" id="4515419">//&nbsp;PrivateKey&nbsp;must&nbsp;already&nbsp;be&nbsp;valid&nbsp;(see&nbsp;GenerateParameters).</span><br>
<span class="lineno"></span><span class="keyword" id="4515481">func</span>&nbsp;<span class="ident" id="4515486">GenerateKey</span><span class="op" id="4515497">(</span><span class="ident" id="4515498">priv</span>&nbsp;<span class="op" id="4515503">*</span><span class="ident" id="4515504"><a href="/crypto/dsa/dsa.go.html#4512819">PrivateKey</a></span><span class="op" id="4515514">,</span>&nbsp;<span class="ident" id="4515516">rand</span>&nbsp;<span class="ident" id="4515521"><a href="/crypto/dsa/dsa.go.html#4512456">io</a></span><span class="op" id="4515523">.</span><span class="ident" id="4515524">Reader</span><span class="op" id="4515530">)</span>&nbsp;<span class="builtintype" id="4515532">error</span>&nbsp;<span class="op" id="4515538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515541">if</span>&nbsp;<span class="ident" id="4515544"><a href="/crypto/dsa/dsa.go.html#4515498">priv</a></span><span class="op" id="4515548">.</span><span class="ident" id="4515549">P</span>&nbsp;<span class="op" id="4515551">==</span>&nbsp;<span class="ident" id="4515554">nil</span>&nbsp;<span class="op" id="4515558">||</span>&nbsp;<span class="ident" id="4515561"><a href="/crypto/dsa/dsa.go.html#4515498">priv</a></span><span class="op" id="4515565">.</span><span class="ident" id="4515566">Q</span>&nbsp;<span class="op" id="4515568">==</span>&nbsp;<span class="ident" id="4515571">nil</span>&nbsp;<span class="op" id="4515575">||</span>&nbsp;<span class="ident" id="4515578"><a href="/crypto/dsa/dsa.go.html#4515498">priv</a></span><span class="op" id="4515582">.</span><span class="ident" id="4515583">G</span>&nbsp;<span class="op" id="4515585">==</span>&nbsp;<span class="ident" id="4515588">nil</span>&nbsp;<span class="op" id="4515592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515596">return</span>&nbsp;<span class="ident" id="4515603"><a href="/crypto/dsa/dsa.go.html#4512446">errors</a></span><span class="op" id="4515609">.</span><span class="ident" id="4515610">New</span><span class="op" id="4515613">(</span><span class="string" id="4515614">&#34;crypto/dsa:&nbsp;parameters&nbsp;not&nbsp;set&nbsp;up&nbsp;before&nbsp;generating&nbsp;key&#34;</span><span class="op" id="4515671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4515674">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515678">x</span>&nbsp;<span class="op" id="4515680">:=</span>&nbsp;<span class="builtinfunc" id="4515683">new</span><span class="op" id="4515686">(</span><span class="ident" id="4515687"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4515690">.</span><span class="ident" id="4515691">Int</span><span class="op" id="4515694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515697">xBytes</span>&nbsp;<span class="op" id="4515704">:=</span>&nbsp;<span class="builtinfunc" id="4515707">make</span><span class="op" id="4515711">(</span><span class="op" id="4515712">[</span><span class="op" id="4515713">]</span><span class="builtintype" id="4515714">byte</span><span class="op" id="4515718">,</span>&nbsp;<span class="ident" id="4515720"><a href="/crypto/dsa/dsa.go.html#4515498">priv</a></span><span class="op" id="4515724">.</span><span class="ident" id="4515725">Q</span><span class="op" id="4515726">.</span><span class="ident" id="4515727">BitLen</span><span class="op" id="4515733">(</span><span class="op" id="4515734">)</span><span class="op" id="4515735">/</span><span class="num" id="4515736">8</span><span class="op" id="4515737">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515741">for</span>&nbsp;<span class="op" id="4515745">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515749">_</span><span class="op" id="4515750">,</span>&nbsp;<span class="ident" id="4515752">err</span>&nbsp;<span class="op" id="4515756">:=</span>&nbsp;<span class="ident" id="4515759"><a href="/crypto/dsa/dsa.go.html#4512456">io</a></span><span class="op" id="4515761">.</span><span class="ident" id="4515762">ReadFull</span><span class="op" id="4515770">(</span><span class="ident" id="4515771"><a href="/crypto/dsa/dsa.go.html#4515516">rand</a></span><span class="op" id="4515775">,</span>&nbsp;<span class="ident" id="4515777"><a href="/crypto/dsa/dsa.go.html#4515697">xBytes</a></span><span class="op" id="4515783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515787">if</span>&nbsp;<span class="ident" id="4515790"><a href="/crypto/dsa/dsa.go.html#4515752">err</a></span>&nbsp;<span class="op" id="4515794">!=</span>&nbsp;<span class="ident" id="4515797">nil</span>&nbsp;<span class="op" id="4515801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515806">return</span>&nbsp;<span class="ident" id="4515813"><a href="/crypto/dsa/dsa.go.html#4515752">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4515819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515823"><a href="/crypto/dsa/dsa.go.html#4515678">x</a></span><span class="op" id="4515824">.</span><span class="ident" id="4515825">SetBytes</span><span class="op" id="4515833">(</span><span class="ident" id="4515834"><a href="/crypto/dsa/dsa.go.html#4515697">xBytes</a></span><span class="op" id="4515840">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515844">if</span>&nbsp;<span class="ident" id="4515847"><a href="/crypto/dsa/dsa.go.html#4515678">x</a></span><span class="op" id="4515848">.</span><span class="ident" id="4515849">Sign</span><span class="op" id="4515853">(</span><span class="op" id="4515854">)</span>&nbsp;<span class="op" id="4515856">!=</span>&nbsp;<span class="num" id="4515859">0</span>&nbsp;<span class="op" id="4515861">&amp;&amp;</span>&nbsp;<span class="ident" id="4515864"><a href="/crypto/dsa/dsa.go.html#4515678">x</a></span><span class="op" id="4515865">.</span><span class="ident" id="4515866">Cmp</span><span class="op" id="4515869">(</span><span class="ident" id="4515870"><a href="/crypto/dsa/dsa.go.html#4515498">priv</a></span><span class="op" id="4515874">.</span><span class="ident" id="4515875">Q</span><span class="op" id="4515876">)</span>&nbsp;<span class="op" id="4515878">&lt;</span>&nbsp;<span class="num" id="4515880">0</span>&nbsp;<span class="op" id="4515882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515887">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4515895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4515898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515902"><a href="/crypto/dsa/dsa.go.html#4515498">priv</a></span><span class="op" id="4515906">.</span><span class="ident" id="4515907">X</span>&nbsp;<span class="op" id="4515909">=</span>&nbsp;<span class="ident" id="4515911"><a href="/crypto/dsa/dsa.go.html#4515678">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515914"><a href="/crypto/dsa/dsa.go.html#4515498">priv</a></span><span class="op" id="4515918">.</span><span class="ident" id="4515919">Y</span>&nbsp;<span class="op" id="4515921">=</span>&nbsp;<span class="builtinfunc" id="4515923">new</span><span class="op" id="4515926">(</span><span class="ident" id="4515927"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4515930">.</span><span class="ident" id="4515931">Int</span><span class="op" id="4515934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4515937"><a href="/crypto/dsa/dsa.go.html#4515498">priv</a></span><span class="op" id="4515941">.</span><span class="ident" id="4515942">Y</span><span class="op" id="4515943">.</span><span class="ident" id="4515944">Exp</span><span class="op" id="4515947">(</span><span class="ident" id="4515948"><a href="/crypto/dsa/dsa.go.html#4515498">priv</a></span><span class="op" id="4515952">.</span><span class="ident" id="4515953">G</span><span class="op" id="4515954">,</span>&nbsp;<span class="ident" id="4515956"><a href="/crypto/dsa/dsa.go.html#4515678">x</a></span><span class="op" id="4515957">,</span>&nbsp;<span class="ident" id="4515959"><a href="/crypto/dsa/dsa.go.html#4515498">priv</a></span><span class="op" id="4515963">.</span><span class="ident" id="4515964">P</span><span class="op" id="4515965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4515968">return</span>&nbsp;<span class="ident" id="4515975">nil</span><br>
<span class="lineno"></span><span class="op" id="4515979">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="4515982">//&nbsp;fermatInverse&nbsp;calculates&nbsp;the&nbsp;inverse&nbsp;of&nbsp;k&nbsp;in&nbsp;GF(P)&nbsp;using&nbsp;Fermat&#39;s&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="4516059">//&nbsp;This&nbsp;has&nbsp;better&nbsp;constant-time&nbsp;properties&nbsp;than&nbsp;Euclid&#39;s&nbsp;method&nbsp;(implemented</span><br>
<span class="lineno"></span><span class="comment" id="4516137">//&nbsp;in&nbsp;math/big.Int.ModInverse)&nbsp;although&nbsp;math/big&nbsp;itself&nbsp;isn&#39;t&nbsp;strictly</span><br>
<span class="lineno"></span><span class="comment" id="4516208">//&nbsp;constant-time&nbsp;so&nbsp;it&#39;s&nbsp;not&nbsp;perfect.</span><br>
<span class="lineno">180</span><span class="keyword" id="4516246">func</span>&nbsp;<span class="ident" id="4516251">fermatInverse</span><span class="op" id="4516264">(</span><span class="ident" id="4516265">k</span><span class="op" id="4516266">,</span>&nbsp;<span class="ident" id="4516268">P</span>&nbsp;<span class="op" id="4516270">*</span><span class="ident" id="4516271"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4516274">.</span><span class="ident" id="4516275">Int</span><span class="op" id="4516278">)</span>&nbsp;<span class="op" id="4516280">*</span><span class="ident" id="4516281"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4516284">.</span><span class="ident" id="4516285">Int</span>&nbsp;<span class="op" id="4516289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4516292">two</span>&nbsp;<span class="op" id="4516296">:=</span>&nbsp;<span class="ident" id="4516299"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4516302">.</span><span class="ident" id="4516303">NewInt</span><span class="op" id="4516309">(</span><span class="num" id="4516310">2</span><span class="op" id="4516311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4516314">pMinus2</span>&nbsp;<span class="op" id="4516322">:=</span>&nbsp;<span class="builtinfunc" id="4516325">new</span><span class="op" id="4516328">(</span><span class="ident" id="4516329"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4516332">.</span><span class="ident" id="4516333">Int</span><span class="op" id="4516336">)</span><span class="op" id="4516337">.</span><span class="ident" id="4516338">Sub</span><span class="op" id="4516341">(</span><span class="ident" id="4516342"><a href="/crypto/dsa/dsa.go.html#4516268">P</a></span><span class="op" id="4516343">,</span>&nbsp;<span class="ident" id="4516345"><a href="/crypto/dsa/dsa.go.html#4516292">two</a></span><span class="op" id="4516348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4516351">return</span>&nbsp;<span class="builtinfunc" id="4516358">new</span><span class="op" id="4516361">(</span><span class="ident" id="4516362"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4516365">.</span><span class="ident" id="4516366">Int</span><span class="op" id="4516369">)</span><span class="op" id="4516370">.</span><span class="ident" id="4516371">Exp</span><span class="op" id="4516374">(</span><span class="ident" id="4516375"><a href="/crypto/dsa/dsa.go.html#4516265">k</a></span><span class="op" id="4516376">,</span>&nbsp;<span class="ident" id="4516378"><a href="/crypto/dsa/dsa.go.html#4516314">pMinus2</a></span><span class="op" id="4516385">,</span>&nbsp;<span class="ident" id="4516387"><a href="/crypto/dsa/dsa.go.html#4516268">P</a></span><span class="op" id="4516388">)</span><br>
<span class="lineno"></span><span class="op" id="4516390">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="comment" id="4516393">//&nbsp;Sign&nbsp;signs&nbsp;an&nbsp;arbitrary&nbsp;length&nbsp;hash&nbsp;(which&nbsp;should&nbsp;be&nbsp;the&nbsp;result&nbsp;of&nbsp;hashing&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4516473">//&nbsp;larger&nbsp;message)&nbsp;using&nbsp;the&nbsp;private&nbsp;key,&nbsp;priv.&nbsp;It&nbsp;returns&nbsp;the&nbsp;signature&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4516551">//&nbsp;pair&nbsp;of&nbsp;integers.&nbsp;The&nbsp;security&nbsp;of&nbsp;the&nbsp;private&nbsp;key&nbsp;depends&nbsp;on&nbsp;the&nbsp;entropy&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4516630">//&nbsp;rand.</span><br>
<span class="lineno">190</span><span class="comment" id="4516639">//</span><br>
<span class="lineno"></span><span class="comment" id="4516642">//&nbsp;Note&nbsp;that&nbsp;FIPS&nbsp;186-3&nbsp;section&nbsp;4.6&nbsp;specifies&nbsp;that&nbsp;the&nbsp;hash&nbsp;should&nbsp;be&nbsp;truncated</span><br>
<span class="lineno"></span><span class="comment" id="4516722">//&nbsp;to&nbsp;the&nbsp;byte-length&nbsp;of&nbsp;the&nbsp;subgroup.&nbsp;This&nbsp;function&nbsp;does&nbsp;not&nbsp;perform&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4516797">//&nbsp;truncation&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="4516819">func</span>&nbsp;<span class="ident" id="4516824">Sign</span><span class="op" id="4516828">(</span><span class="ident" id="4516829">rand</span>&nbsp;<span class="ident" id="4516834"><a href="/crypto/dsa/dsa.go.html#4512456">io</a></span><span class="op" id="4516836">.</span><span class="ident" id="4516837">Reader</span><span class="op" id="4516843">,</span>&nbsp;<span class="ident" id="4516845">priv</span>&nbsp;<span class="op" id="4516850">*</span><span class="ident" id="4516851"><a href="/crypto/dsa/dsa.go.html#4512819">PrivateKey</a></span><span class="op" id="4516861">,</span>&nbsp;<span class="ident" id="4516863">hash</span>&nbsp;<span class="op" id="4516868">[</span><span class="op" id="4516869">]</span><span class="builtintype" id="4516870">byte</span><span class="op" id="4516874">)</span>&nbsp;<span class="op" id="4516876">(</span><span class="ident" id="4516877">r</span><span class="op" id="4516878">,</span>&nbsp;<span class="ident" id="4516880">s</span>&nbsp;<span class="op" id="4516882">*</span><span class="ident" id="4516883"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4516886">.</span><span class="ident" id="4516887">Int</span><span class="op" id="4516890">,</span>&nbsp;<span class="ident" id="4516892">err</span>&nbsp;<span class="builtintype" id="4516896">error</span><span class="op" id="4516901">)</span>&nbsp;<span class="op" id="4516903">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4516906">//&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;4.6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4516935">n</span>&nbsp;<span class="op" id="4516937">:=</span>&nbsp;<span class="ident" id="4516940"><a href="/crypto/dsa/dsa.go.html#4516845">priv</a></span><span class="op" id="4516944">.</span><span class="ident" id="4516945">Q</span><span class="op" id="4516946">.</span><span class="ident" id="4516947">BitLen</span><span class="op" id="4516953">(</span><span class="op" id="4516954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4516957">if</span>&nbsp;<span class="ident" id="4516960"><a href="/crypto/dsa/dsa.go.html#4516935">n</a></span><span class="op" id="4516961">&amp;</span><span class="num" id="4516962">7</span>&nbsp;<span class="op" id="4516964">!=</span>&nbsp;<span class="num" id="4516967">0</span>&nbsp;<span class="op" id="4516969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4516973"><a href="/crypto/dsa/dsa.go.html#4516892">err</a></span>&nbsp;<span class="op" id="4516977">=</span>&nbsp;<span class="ident" id="4516979"><a href="/crypto/dsa/dsa.go.html#4513132">ErrInvalidPublicKey</a></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517001">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4517009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517012"><a href="/crypto/dsa/dsa.go.html#4516935">n</a></span>&nbsp;<span class="op" id="4517014">&gt;&gt;=</span>&nbsp;<span class="num" id="4517018">3</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517022">for</span>&nbsp;<span class="op" id="4517026">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517030">k</span>&nbsp;<span class="op" id="4517032">:=</span>&nbsp;<span class="builtinfunc" id="4517035">new</span><span class="op" id="4517038">(</span><span class="ident" id="4517039"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4517042">.</span><span class="ident" id="4517043">Int</span><span class="op" id="4517046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517050">buf</span>&nbsp;<span class="op" id="4517054">:=</span>&nbsp;<span class="builtinfunc" id="4517057">make</span><span class="op" id="4517061">(</span><span class="op" id="4517062">[</span><span class="op" id="4517063">]</span><span class="builtintype" id="4517064">byte</span><span class="op" id="4517068">,</span>&nbsp;<span class="ident" id="4517070"><a href="/crypto/dsa/dsa.go.html#4516935">n</a></span><span class="op" id="4517071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517075">for</span>&nbsp;<span class="op" id="4517079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517084">_</span><span class="op" id="4517085">,</span>&nbsp;<span class="ident" id="4517087"><a href="/crypto/dsa/dsa.go.html#4516892">err</a></span>&nbsp;<span class="op" id="4517091">=</span>&nbsp;<span class="ident" id="4517093"><a href="/crypto/dsa/dsa.go.html#4512456">io</a></span><span class="op" id="4517095">.</span><span class="ident" id="4517096">ReadFull</span><span class="op" id="4517104">(</span><span class="ident" id="4517105"><a href="/crypto/dsa/dsa.go.html#4516829">rand</a></span><span class="op" id="4517109">,</span>&nbsp;<span class="ident" id="4517111"><a href="/crypto/dsa/dsa.go.html#4517050">buf</a></span><span class="op" id="4517114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517119">if</span>&nbsp;<span class="ident" id="4517122"><a href="/crypto/dsa/dsa.go.html#4516892">err</a></span>&nbsp;<span class="op" id="4517126">!=</span>&nbsp;<span class="ident" id="4517129">nil</span>&nbsp;<span class="op" id="4517133">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517139">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4517149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517154"><a href="/crypto/dsa/dsa.go.html#4517030">k</a></span><span class="op" id="4517155">.</span><span class="ident" id="4517156">SetBytes</span><span class="op" id="4517164">(</span><span class="ident" id="4517165"><a href="/crypto/dsa/dsa.go.html#4517050">buf</a></span><span class="op" id="4517168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517173">if</span>&nbsp;<span class="ident" id="4517176"><a href="/crypto/dsa/dsa.go.html#4517030">k</a></span><span class="op" id="4517177">.</span><span class="ident" id="4517178">Sign</span><span class="op" id="4517182">(</span><span class="op" id="4517183">)</span>&nbsp;<span class="op" id="4517185">&gt;</span>&nbsp;<span class="num" id="4517187">0</span>&nbsp;<span class="op" id="4517189">&amp;&amp;</span>&nbsp;<span class="ident" id="4517192"><a href="/crypto/dsa/dsa.go.html#4517030">k</a></span><span class="op" id="4517193">.</span><span class="ident" id="4517194">Cmp</span><span class="op" id="4517197">(</span><span class="ident" id="4517198"><a href="/crypto/dsa/dsa.go.html#4516845">priv</a></span><span class="op" id="4517202">.</span><span class="ident" id="4517203">Q</span><span class="op" id="4517204">)</span>&nbsp;<span class="op" id="4517206">&lt;</span>&nbsp;<span class="num" id="4517208">0</span>&nbsp;<span class="op" id="4517210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517216">break</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4517225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4517229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517234">kInv</span>&nbsp;<span class="op" id="4517239">:=</span>&nbsp;<span class="ident" id="4517242"><a href="/crypto/dsa/dsa.go.html#4516251">fermatInverse</a></span><span class="op" id="4517255">(</span><span class="ident" id="4517256"><a href="/crypto/dsa/dsa.go.html#4517030">k</a></span><span class="op" id="4517257">,</span>&nbsp;<span class="ident" id="4517259"><a href="/crypto/dsa/dsa.go.html#4516845">priv</a></span><span class="op" id="4517263">.</span><span class="ident" id="4517264">Q</span><span class="op" id="4517265">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517270"><a href="/crypto/dsa/dsa.go.html#4516877">r</a></span>&nbsp;<span class="op" id="4517272">=</span>&nbsp;<span class="builtinfunc" id="4517274">new</span><span class="op" id="4517277">(</span><span class="ident" id="4517278"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4517281">.</span><span class="ident" id="4517282">Int</span><span class="op" id="4517285">)</span><span class="op" id="4517286">.</span><span class="ident" id="4517287">Exp</span><span class="op" id="4517290">(</span><span class="ident" id="4517291"><a href="/crypto/dsa/dsa.go.html#4516845">priv</a></span><span class="op" id="4517295">.</span><span class="ident" id="4517296">G</span><span class="op" id="4517297">,</span>&nbsp;<span class="ident" id="4517299"><a href="/crypto/dsa/dsa.go.html#4517030">k</a></span><span class="op" id="4517300">,</span>&nbsp;<span class="ident" id="4517302"><a href="/crypto/dsa/dsa.go.html#4516845">priv</a></span><span class="op" id="4517306">.</span><span class="ident" id="4517307">P</span><span class="op" id="4517308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517312"><a href="/crypto/dsa/dsa.go.html#4516877">r</a></span><span class="op" id="4517313">.</span><span class="ident" id="4517314">Mod</span><span class="op" id="4517317">(</span><span class="ident" id="4517318"><a href="/crypto/dsa/dsa.go.html#4516877">r</a></span><span class="op" id="4517319">,</span>&nbsp;<span class="ident" id="4517321"><a href="/crypto/dsa/dsa.go.html#4516845">priv</a></span><span class="op" id="4517325">.</span><span class="ident" id="4517326">Q</span><span class="op" id="4517327">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517332">if</span>&nbsp;<span class="ident" id="4517335"><a href="/crypto/dsa/dsa.go.html#4516877">r</a></span><span class="op" id="4517336">.</span><span class="ident" id="4517337">Sign</span><span class="op" id="4517341">(</span><span class="op" id="4517342">)</span>&nbsp;<span class="op" id="4517344">==</span>&nbsp;<span class="num" id="4517347">0</span>&nbsp;<span class="op" id="4517349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517354">continue</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4517365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517370">z</span>&nbsp;<span class="op" id="4517372">:=</span>&nbsp;<span class="ident" id="4517375"><a href="/crypto/dsa/dsa.go.html#4517030">k</a></span><span class="op" id="4517376">.</span><span class="ident" id="4517377">SetBytes</span><span class="op" id="4517385">(</span><span class="ident" id="4517386"><a href="/crypto/dsa/dsa.go.html#4516863">hash</a></span><span class="op" id="4517390">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517395"><a href="/crypto/dsa/dsa.go.html#4516880">s</a></span>&nbsp;<span class="op" id="4517397">=</span>&nbsp;<span class="builtinfunc" id="4517399">new</span><span class="op" id="4517402">(</span><span class="ident" id="4517403"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4517406">.</span><span class="ident" id="4517407">Int</span><span class="op" id="4517410">)</span><span class="op" id="4517411">.</span><span class="ident" id="4517412">Mul</span><span class="op" id="4517415">(</span><span class="ident" id="4517416"><a href="/crypto/dsa/dsa.go.html#4516845">priv</a></span><span class="op" id="4517420">.</span><span class="ident" id="4517421">X</span><span class="op" id="4517422">,</span>&nbsp;<span class="ident" id="4517424"><a href="/crypto/dsa/dsa.go.html#4516877">r</a></span><span class="op" id="4517425">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517429"><a href="/crypto/dsa/dsa.go.html#4516880">s</a></span><span class="op" id="4517430">.</span><span class="ident" id="4517431">Add</span><span class="op" id="4517434">(</span><span class="ident" id="4517435"><a href="/crypto/dsa/dsa.go.html#4516880">s</a></span><span class="op" id="4517436">,</span>&nbsp;<span class="ident" id="4517438"><a href="/crypto/dsa/dsa.go.html#4517370">z</a></span><span class="op" id="4517439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517443"><a href="/crypto/dsa/dsa.go.html#4516880">s</a></span><span class="op" id="4517444">.</span><span class="ident" id="4517445">Mod</span><span class="op" id="4517448">(</span><span class="ident" id="4517449"><a href="/crypto/dsa/dsa.go.html#4516880">s</a></span><span class="op" id="4517450">,</span>&nbsp;<span class="ident" id="4517452"><a href="/crypto/dsa/dsa.go.html#4516845">priv</a></span><span class="op" id="4517456">.</span><span class="ident" id="4517457">Q</span><span class="op" id="4517458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517462"><a href="/crypto/dsa/dsa.go.html#4516880">s</a></span><span class="op" id="4517463">.</span><span class="ident" id="4517464">Mul</span><span class="op" id="4517467">(</span><span class="ident" id="4517468"><a href="/crypto/dsa/dsa.go.html#4516880">s</a></span><span class="op" id="4517469">,</span>&nbsp;<span class="ident" id="4517471"><a href="/crypto/dsa/dsa.go.html#4517234">kInv</a></span><span class="op" id="4517475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4517479"><a href="/crypto/dsa/dsa.go.html#4516880">s</a></span><span class="op" id="4517480">.</span><span class="ident" id="4517481">Mod</span><span class="op" id="4517484">(</span><span class="ident" id="4517485"><a href="/crypto/dsa/dsa.go.html#4516880">s</a></span><span class="op" id="4517486">,</span>&nbsp;<span class="ident" id="4517488"><a href="/crypto/dsa/dsa.go.html#4516845">priv</a></span><span class="op" id="4517492">.</span><span class="ident" id="4517493">Q</span><span class="op" id="4517494">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517499">if</span>&nbsp;<span class="ident" id="4517502"><a href="/crypto/dsa/dsa.go.html#4516880">s</a></span><span class="op" id="4517503">.</span><span class="ident" id="4517504">Sign</span><span class="op" id="4517508">(</span><span class="op" id="4517509">)</span>&nbsp;<span class="op" id="4517511">!=</span>&nbsp;<span class="num" id="4517514">0</span>&nbsp;<span class="op" id="4517516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517521">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4517529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4517532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517536">return</span><br>
<span class="lineno"></span><span class="op" id="4517543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4517546">//&nbsp;Verify&nbsp;verifies&nbsp;the&nbsp;signature&nbsp;in&nbsp;r,&nbsp;s&nbsp;of&nbsp;hash&nbsp;using&nbsp;the&nbsp;public&nbsp;key,&nbsp;pub.&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="4517625">//&nbsp;reports&nbsp;whether&nbsp;the&nbsp;signature&nbsp;is&nbsp;valid.</span><br>
<span class="lineno">245</span><span class="comment" id="4517668">//</span><br>
<span class="lineno"></span><span class="comment" id="4517671">//&nbsp;Note&nbsp;that&nbsp;FIPS&nbsp;186-3&nbsp;section&nbsp;4.6&nbsp;specifies&nbsp;that&nbsp;the&nbsp;hash&nbsp;should&nbsp;be&nbsp;truncated</span><br>
<span class="lineno"></span><span class="comment" id="4517751">//&nbsp;to&nbsp;the&nbsp;byte-length&nbsp;of&nbsp;the&nbsp;subgroup.&nbsp;This&nbsp;function&nbsp;does&nbsp;not&nbsp;perform&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4517826">//&nbsp;truncation&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="4517848">func</span>&nbsp;<span class="ident" id="4517853">Verify</span><span class="op" id="4517859">(</span><span class="ident" id="4517860">pub</span>&nbsp;<span class="op" id="4517864">*</span><span class="ident" id="4517865"><a href="/crypto/dsa/dsa.go.html#4512724">PublicKey</a></span><span class="op" id="4517874">,</span>&nbsp;<span class="ident" id="4517876">hash</span>&nbsp;<span class="op" id="4517881">[</span><span class="op" id="4517882">]</span><span class="builtintype" id="4517883">byte</span><span class="op" id="4517887">,</span>&nbsp;<span class="ident" id="4517889">r</span><span class="op" id="4517890">,</span>&nbsp;<span class="ident" id="4517892">s</span>&nbsp;<span class="op" id="4517894">*</span><span class="ident" id="4517895"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4517898">.</span><span class="ident" id="4517899">Int</span><span class="op" id="4517902">)</span>&nbsp;<span class="builtintype" id="4517904">bool</span>&nbsp;<span class="op" id="4517909">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4517912">//&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;4.7</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517941">if</span>&nbsp;<span class="ident" id="4517944"><a href="/crypto/dsa/dsa.go.html#4517889">r</a></span><span class="op" id="4517945">.</span><span class="ident" id="4517946">Sign</span><span class="op" id="4517950">(</span><span class="op" id="4517951">)</span>&nbsp;<span class="op" id="4517953">&lt;</span>&nbsp;<span class="num" id="4517955">1</span>&nbsp;<span class="op" id="4517957">||</span>&nbsp;<span class="ident" id="4517960"><a href="/crypto/dsa/dsa.go.html#4517889">r</a></span><span class="op" id="4517961">.</span><span class="ident" id="4517962">Cmp</span><span class="op" id="4517965">(</span><span class="ident" id="4517966"><a href="/crypto/dsa/dsa.go.html#4517860">pub</a></span><span class="op" id="4517969">.</span><span class="ident" id="4517970">Q</span><span class="op" id="4517971">)</span>&nbsp;<span class="op" id="4517973">&gt;=</span>&nbsp;<span class="num" id="4517976">0</span>&nbsp;<span class="op" id="4517978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517982">return</span>&nbsp;<span class="ident" id="4517989">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4517996">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4517999">if</span>&nbsp;<span class="ident" id="4518002"><a href="/crypto/dsa/dsa.go.html#4517892">s</a></span><span class="op" id="4518003">.</span><span class="ident" id="4518004">Sign</span><span class="op" id="4518008">(</span><span class="op" id="4518009">)</span>&nbsp;<span class="op" id="4518011">&lt;</span>&nbsp;<span class="num" id="4518013">1</span>&nbsp;<span class="op" id="4518015">||</span>&nbsp;<span class="ident" id="4518018"><a href="/crypto/dsa/dsa.go.html#4517892">s</a></span><span class="op" id="4518019">.</span><span class="ident" id="4518020">Cmp</span><span class="op" id="4518023">(</span><span class="ident" id="4518024"><a href="/crypto/dsa/dsa.go.html#4517860">pub</a></span><span class="op" id="4518027">.</span><span class="ident" id="4518028">Q</span><span class="op" id="4518029">)</span>&nbsp;<span class="op" id="4518031">&gt;=</span>&nbsp;<span class="num" id="4518034">0</span>&nbsp;<span class="op" id="4518036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4518040">return</span>&nbsp;<span class="ident" id="4518047">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4518054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518058">w</span>&nbsp;<span class="op" id="4518060">:=</span>&nbsp;<span class="builtinfunc" id="4518063">new</span><span class="op" id="4518066">(</span><span class="ident" id="4518067"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4518070">.</span><span class="ident" id="4518071">Int</span><span class="op" id="4518074">)</span><span class="op" id="4518075">.</span><span class="ident" id="4518076">ModInverse</span><span class="op" id="4518086">(</span><span class="ident" id="4518087"><a href="/crypto/dsa/dsa.go.html#4517892">s</a></span><span class="op" id="4518088">,</span>&nbsp;<span class="ident" id="4518090"><a href="/crypto/dsa/dsa.go.html#4517860">pub</a></span><span class="op" id="4518093">.</span><span class="ident" id="4518094">Q</span><span class="op" id="4518095">)</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518099">n</span>&nbsp;<span class="op" id="4518101">:=</span>&nbsp;<span class="ident" id="4518104"><a href="/crypto/dsa/dsa.go.html#4517860">pub</a></span><span class="op" id="4518107">.</span><span class="ident" id="4518108">Q</span><span class="op" id="4518109">.</span><span class="ident" id="4518110">BitLen</span><span class="op" id="4518116">(</span><span class="op" id="4518117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4518120">if</span>&nbsp;<span class="ident" id="4518123"><a href="/crypto/dsa/dsa.go.html#4518099">n</a></span><span class="op" id="4518124">&amp;</span><span class="num" id="4518125">7</span>&nbsp;<span class="op" id="4518127">!=</span>&nbsp;<span class="num" id="4518130">0</span>&nbsp;<span class="op" id="4518132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4518136">return</span>&nbsp;<span class="ident" id="4518143">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4518150">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518153">z</span>&nbsp;<span class="op" id="4518155">:=</span>&nbsp;<span class="builtinfunc" id="4518158">new</span><span class="op" id="4518161">(</span><span class="ident" id="4518162"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4518165">.</span><span class="ident" id="4518166">Int</span><span class="op" id="4518169">)</span><span class="op" id="4518170">.</span><span class="ident" id="4518171">SetBytes</span><span class="op" id="4518179">(</span><span class="ident" id="4518180"><a href="/crypto/dsa/dsa.go.html#4517876">hash</a></span><span class="op" id="4518184">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518188">u1</span>&nbsp;<span class="op" id="4518191">:=</span>&nbsp;<span class="builtinfunc" id="4518194">new</span><span class="op" id="4518197">(</span><span class="ident" id="4518198"><a href="/crypto/dsa/dsa.go.html#4512462">big</a></span><span class="op" id="4518201">.</span><span class="ident" id="4518202">Int</span><span class="op" id="4518205">)</span><span class="op" id="4518206">.</span><span class="ident" id="4518207">Mul</span><span class="op" id="4518210">(</span><span class="ident" id="4518211"><a href="/crypto/dsa/dsa.go.html#4518153">z</a></span><span class="op" id="4518212">,</span>&nbsp;<span class="ident" id="4518214"><a href="/crypto/dsa/dsa.go.html#4518058">w</a></span><span class="op" id="4518215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518218"><a href="/crypto/dsa/dsa.go.html#4518188">u1</a></span><span class="op" id="4518220">.</span><span class="ident" id="4518221">Mod</span><span class="op" id="4518224">(</span><span class="ident" id="4518225"><a href="/crypto/dsa/dsa.go.html#4518188">u1</a></span><span class="op" id="4518227">,</span>&nbsp;<span class="ident" id="4518229"><a href="/crypto/dsa/dsa.go.html#4517860">pub</a></span><span class="op" id="4518232">.</span><span class="ident" id="4518233">Q</span><span class="op" id="4518234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518237">u2</span>&nbsp;<span class="op" id="4518240">:=</span>&nbsp;<span class="ident" id="4518243"><a href="/crypto/dsa/dsa.go.html#4518058">w</a></span><span class="op" id="4518244">.</span><span class="ident" id="4518245">Mul</span><span class="op" id="4518248">(</span><span class="ident" id="4518249"><a href="/crypto/dsa/dsa.go.html#4517889">r</a></span><span class="op" id="4518250">,</span>&nbsp;<span class="ident" id="4518252"><a href="/crypto/dsa/dsa.go.html#4518058">w</a></span><span class="op" id="4518253">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518256"><a href="/crypto/dsa/dsa.go.html#4518237">u2</a></span><span class="op" id="4518258">.</span><span class="ident" id="4518259">Mod</span><span class="op" id="4518262">(</span><span class="ident" id="4518263"><a href="/crypto/dsa/dsa.go.html#4518237">u2</a></span><span class="op" id="4518265">,</span>&nbsp;<span class="ident" id="4518267"><a href="/crypto/dsa/dsa.go.html#4517860">pub</a></span><span class="op" id="4518270">.</span><span class="ident" id="4518271">Q</span><span class="op" id="4518272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518275">v</span>&nbsp;<span class="op" id="4518277">:=</span>&nbsp;<span class="ident" id="4518280"><a href="/crypto/dsa/dsa.go.html#4518188">u1</a></span><span class="op" id="4518282">.</span><span class="ident" id="4518283">Exp</span><span class="op" id="4518286">(</span><span class="ident" id="4518287"><a href="/crypto/dsa/dsa.go.html#4517860">pub</a></span><span class="op" id="4518290">.</span><span class="ident" id="4518291">G</span><span class="op" id="4518292">,</span>&nbsp;<span class="ident" id="4518294"><a href="/crypto/dsa/dsa.go.html#4518188">u1</a></span><span class="op" id="4518296">,</span>&nbsp;<span class="ident" id="4518298"><a href="/crypto/dsa/dsa.go.html#4517860">pub</a></span><span class="op" id="4518301">.</span><span class="ident" id="4518302">P</span><span class="op" id="4518303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518306"><a href="/crypto/dsa/dsa.go.html#4518237">u2</a></span><span class="op" id="4518308">.</span><span class="ident" id="4518309">Exp</span><span class="op" id="4518312">(</span><span class="ident" id="4518313"><a href="/crypto/dsa/dsa.go.html#4517860">pub</a></span><span class="op" id="4518316">.</span><span class="ident" id="4518317">Y</span><span class="op" id="4518318">,</span>&nbsp;<span class="ident" id="4518320"><a href="/crypto/dsa/dsa.go.html#4518237">u2</a></span><span class="op" id="4518322">,</span>&nbsp;<span class="ident" id="4518324"><a href="/crypto/dsa/dsa.go.html#4517860">pub</a></span><span class="op" id="4518327">.</span><span class="ident" id="4518328">P</span><span class="op" id="4518329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518332"><a href="/crypto/dsa/dsa.go.html#4518275">v</a></span><span class="op" id="4518333">.</span><span class="ident" id="4518334">Mul</span><span class="op" id="4518337">(</span><span class="ident" id="4518338"><a href="/crypto/dsa/dsa.go.html#4518275">v</a></span><span class="op" id="4518339">,</span>&nbsp;<span class="ident" id="4518341"><a href="/crypto/dsa/dsa.go.html#4518237">u2</a></span><span class="op" id="4518343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518346"><a href="/crypto/dsa/dsa.go.html#4518275">v</a></span><span class="op" id="4518347">.</span><span class="ident" id="4518348">Mod</span><span class="op" id="4518351">(</span><span class="ident" id="4518352"><a href="/crypto/dsa/dsa.go.html#4518275">v</a></span><span class="op" id="4518353">,</span>&nbsp;<span class="ident" id="4518355"><a href="/crypto/dsa/dsa.go.html#4517860">pub</a></span><span class="op" id="4518358">.</span><span class="ident" id="4518359">P</span><span class="op" id="4518360">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518363"><a href="/crypto/dsa/dsa.go.html#4518275">v</a></span><span class="op" id="4518364">.</span><span class="ident" id="4518365">Mod</span><span class="op" id="4518368">(</span><span class="ident" id="4518369"><a href="/crypto/dsa/dsa.go.html#4518275">v</a></span><span class="op" id="4518370">,</span>&nbsp;<span class="ident" id="4518372"><a href="/crypto/dsa/dsa.go.html#4517860">pub</a></span><span class="op" id="4518375">.</span><span class="ident" id="4518376">Q</span><span class="op" id="4518377">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4518381">return</span>&nbsp;<span class="ident" id="4518388"><a href="/crypto/dsa/dsa.go.html#4518275">v</a></span><span class="op" id="4518389">.</span><span class="ident" id="4518390">Cmp</span><span class="op" id="4518393">(</span><span class="ident" id="4518394"><a href="/crypto/dsa/dsa.go.html#4517889">r</a></span><span class="op" id="4518395">)</span>&nbsp;<span class="op" id="4518397">==</span>&nbsp;<span class="num" id="4518400">0</span><br>
<span class="lineno"></span><span class="op" id="4518402">}</span>
</div>
</body>
</html>
