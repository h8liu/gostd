<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3971240">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3971295">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3971349">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3971400">package</span>&nbsp;<span class="ident" id="3971408">des</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3971413">import</span>&nbsp;<span class="op" id="3971420">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3971423">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span><span class="op" id="3971441">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="3971444">func</span>&nbsp;<span class="ident" id="3971449">cryptBlock</span><span class="op" id="3971459">(</span><span class="ident" id="3971460">subkeys</span>&nbsp;<span class="op" id="3971468">[</span><span class="op" id="3971469">]</span><span class="ident" id="3971470">uint64</span><span class="op" id="3971476">,</span>&nbsp;<span class="ident" id="3971478">dst</span><span class="op" id="3971481">,</span>&nbsp;<span class="ident" id="3971483">src</span>&nbsp;<span class="op" id="3971487">[</span><span class="op" id="3971488">]</span><span class="builtintype" id="3971489">byte</span><span class="op" id="3971493">,</span>&nbsp;<span class="ident" id="3971495">decrypt</span>&nbsp;<span class="builtintype" id="3971503">bool</span><span class="op" id="3971507">)</span>&nbsp;<span class="op" id="3971509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971512">b</span>&nbsp;<span class="op" id="3971514">:=</span>&nbsp;<span class="ident" id="3971517"><a href="/crypto/des/block.go.html#3971423">binary</a></span><span class="op" id="3971523">.</span><span class="ident" id="3971524">BigEndian</span><span class="op" id="3971533">.</span><span class="ident" id="3971534">Uint64</span><span class="op" id="3971540">(</span><span class="ident" id="3971541"><a href="/crypto/des/block.go.html#3971483">src</a></span><span class="op" id="3971544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971547"><a href="/crypto/des/block.go.html#3971512">b</a></span>&nbsp;<span class="op" id="3971549">=</span>&nbsp;<span class="ident" id="3971551"><a href="/crypto/des/block.go.html#3973911">permuteInitialBlock</a></span><span class="op" id="3971570">(</span><span class="ident" id="3971571"><a href="/crypto/des/block.go.html#3971512">b</a></span><span class="op" id="3971572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971575">left</span><span class="op" id="3971579">,</span>&nbsp;<span class="ident" id="3971581">right</span>&nbsp;<span class="op" id="3971587">:=</span>&nbsp;<span class="builtintype" id="3971590">uint32</span><span class="op" id="3971596">(</span><span class="ident" id="3971597"><a href="/crypto/des/block.go.html#3971512">b</a></span><span class="op" id="3971598">&gt;&gt;</span><span class="num" id="3971600">32</span><span class="op" id="3971602">)</span><span class="op" id="3971603">,</span>&nbsp;<span class="builtintype" id="3971605">uint32</span><span class="op" id="3971611">(</span><span class="ident" id="3971612"><a href="/crypto/des/block.go.html#3971512">b</a></span><span class="op" id="3971613">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3971617">var</span>&nbsp;<span class="ident" id="3971621">subkey</span>&nbsp;<span class="ident" id="3971628">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3971636">for</span>&nbsp;<span class="ident" id="3971640">i</span>&nbsp;<span class="op" id="3971642">:=</span>&nbsp;<span class="num" id="3971645">0</span><span class="op" id="3971646">;</span>&nbsp;<span class="ident" id="3971648"><a href="/crypto/des/block.go.html#3971640">i</a></span>&nbsp;<span class="op" id="3971650">&lt;</span>&nbsp;<span class="num" id="3971652">16</span><span class="op" id="3971654">;</span>&nbsp;<span class="ident" id="3971656"><a href="/crypto/des/block.go.html#3971640">i</a></span><span class="op" id="3971657">++</span>&nbsp;<span class="op" id="3971660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3971664">if</span>&nbsp;<span class="ident" id="3971667"><a href="/crypto/des/block.go.html#3971495">decrypt</a></span>&nbsp;<span class="op" id="3971675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971680"><a href="/crypto/des/block.go.html#3971621">subkey</a></span>&nbsp;<span class="op" id="3971687">=</span>&nbsp;<span class="ident" id="3971689"><a href="/crypto/des/block.go.html#3971460">subkeys</a></span><span class="op" id="3971696">[</span><span class="num" id="3971697">15</span><span class="op" id="3971699">-</span><span class="ident" id="3971700"><a href="/crypto/des/block.go.html#3971640">i</a></span><span class="op" id="3971701">]</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3971705">}</span>&nbsp;<span class="keyword" id="3971707">else</span>&nbsp;<span class="op" id="3971712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971717"><a href="/crypto/des/block.go.html#3971621">subkey</a></span>&nbsp;<span class="op" id="3971724">=</span>&nbsp;<span class="ident" id="3971726"><a href="/crypto/des/block.go.html#3971460">subkeys</a></span><span class="op" id="3971733">[</span><span class="ident" id="3971734"><a href="/crypto/des/block.go.html#3971640">i</a></span><span class="op" id="3971735">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3971739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971744"><a href="/crypto/des/block.go.html#3971575">left</a></span><span class="op" id="3971748">,</span>&nbsp;<span class="ident" id="3971750"><a href="/crypto/des/block.go.html#3971581">right</a></span>&nbsp;<span class="op" id="3971756">=</span>&nbsp;<span class="ident" id="3971758"><a href="/crypto/des/block.go.html#3971581">right</a></span><span class="op" id="3971763">,</span>&nbsp;<span class="ident" id="3971765"><a href="/crypto/des/block.go.html#3971575">left</a></span><span class="op" id="3971769">^</span><span class="ident" id="3971770"><a href="/crypto/des/block.go.html#3972305">feistel</a></span><span class="op" id="3971777">(</span><span class="ident" id="3971778"><a href="/crypto/des/block.go.html#3971581">right</a></span><span class="op" id="3971783">,</span>&nbsp;<span class="ident" id="3971785"><a href="/crypto/des/block.go.html#3971621">subkey</a></span><span class="op" id="3971791">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3971794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3971797">//&nbsp;switch&nbsp;left&nbsp;&amp;&nbsp;right&nbsp;and&nbsp;perform&nbsp;final&nbsp;permutation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971851">preOutput</span>&nbsp;<span class="op" id="3971861">:=</span>&nbsp;<span class="op" id="3971864">(</span><span class="ident" id="3971865">uint64</span><span class="op" id="3971871">(</span><span class="ident" id="3971872"><a href="/crypto/des/block.go.html#3971581">right</a></span><span class="op" id="3971877">)</span>&nbsp;<span class="op" id="3971879">&lt;&lt;</span>&nbsp;<span class="num" id="3971882">32</span><span class="op" id="3971884">)</span>&nbsp;<span class="op" id="3971886">|</span>&nbsp;<span class="ident" id="3971888">uint64</span><span class="op" id="3971894">(</span><span class="ident" id="3971895"><a href="/crypto/des/block.go.html#3971575">left</a></span><span class="op" id="3971899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3971902"><a href="/crypto/des/block.go.html#3971423">binary</a></span><span class="op" id="3971908">.</span><span class="ident" id="3971909">BigEndian</span><span class="op" id="3971918">.</span><span class="ident" id="3971919">PutUint64</span><span class="op" id="3971928">(</span><span class="ident" id="3971929"><a href="/crypto/des/block.go.html#3971478">dst</a></span><span class="op" id="3971932">,</span>&nbsp;<span class="ident" id="3971934"><a href="/crypto/des/block.go.html#3975530">permuteFinalBlock</a></span><span class="op" id="3971951">(</span><span class="ident" id="3971952"><a href="/crypto/des/block.go.html#3971851">preOutput</a></span><span class="op" id="3971961">)</span><span class="op" id="3971962">)</span><br>
<span class="lineno"></span><span class="op" id="3971964">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="3971967">//&nbsp;Encrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;subkeys.</span><br>
<span class="lineno"></span><span class="keyword" id="3972026">func</span>&nbsp;<span class="ident" id="3972031">encryptBlock</span><span class="op" id="3972043">(</span><span class="ident" id="3972044">subkeys</span>&nbsp;<span class="op" id="3972052">[</span><span class="op" id="3972053">]</span><span class="ident" id="3972054">uint64</span><span class="op" id="3972060">,</span>&nbsp;<span class="ident" id="3972062">dst</span><span class="op" id="3972065">,</span>&nbsp;<span class="ident" id="3972067">src</span>&nbsp;<span class="op" id="3972071">[</span><span class="op" id="3972072">]</span><span class="builtintype" id="3972073">byte</span><span class="op" id="3972077">)</span>&nbsp;<span class="op" id="3972079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972082"><a href="/crypto/des/block.go.html#3971449">cryptBlock</a></span><span class="op" id="3972092">(</span><span class="ident" id="3972093"><a href="/crypto/des/block.go.html#3972044">subkeys</a></span><span class="op" id="3972100">,</span>&nbsp;<span class="ident" id="3972102"><a href="/crypto/des/block.go.html#3972062">dst</a></span><span class="op" id="3972105">,</span>&nbsp;<span class="ident" id="3972107"><a href="/crypto/des/block.go.html#3972067">src</a></span><span class="op" id="3972110">,</span>&nbsp;<span class="builtintype" id="3972112">false</span><span class="op" id="3972117">)</span><br>
<span class="lineno"></span><span class="op" id="3972119">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3972122">//&nbsp;Decrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;subkeys.</span><br>
<span class="lineno"></span><span class="keyword" id="3972181">func</span>&nbsp;<span class="ident" id="3972186">decryptBlock</span><span class="op" id="3972198">(</span><span class="ident" id="3972199">subkeys</span>&nbsp;<span class="op" id="3972207">[</span><span class="op" id="3972208">]</span><span class="ident" id="3972209">uint64</span><span class="op" id="3972215">,</span>&nbsp;<span class="ident" id="3972217">dst</span><span class="op" id="3972220">,</span>&nbsp;<span class="ident" id="3972222">src</span>&nbsp;<span class="op" id="3972226">[</span><span class="op" id="3972227">]</span><span class="builtintype" id="3972228">byte</span><span class="op" id="3972232">)</span>&nbsp;<span class="op" id="3972234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972237"><a href="/crypto/des/block.go.html#3971449">cryptBlock</a></span><span class="op" id="3972247">(</span><span class="ident" id="3972248"><a href="/crypto/des/block.go.html#3972199">subkeys</a></span><span class="op" id="3972255">,</span>&nbsp;<span class="ident" id="3972257"><a href="/crypto/des/block.go.html#3972217">dst</a></span><span class="op" id="3972260">,</span>&nbsp;<span class="ident" id="3972262"><a href="/crypto/des/block.go.html#3972222">src</a></span><span class="op" id="3972265">,</span>&nbsp;<span class="builtintype" id="3972267">true</span><span class="op" id="3972271">)</span><br>
<span class="lineno"></span><span class="op" id="3972273">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="3972276">//&nbsp;DES&nbsp;Feistel&nbsp;function</span><br>
<span class="lineno"></span><span class="keyword" id="3972300">func</span>&nbsp;<span class="ident" id="3972305">feistel</span><span class="op" id="3972312">(</span><span class="ident" id="3972313">right</span>&nbsp;<span class="builtintype" id="3972319">uint32</span><span class="op" id="3972325">,</span>&nbsp;<span class="ident" id="3972327">key</span>&nbsp;<span class="ident" id="3972331">uint64</span><span class="op" id="3972337">)</span>&nbsp;<span class="op" id="3972339">(</span><span class="ident" id="3972340">result</span>&nbsp;<span class="builtintype" id="3972347">uint32</span><span class="op" id="3972353">)</span>&nbsp;<span class="op" id="3972355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972358">sBoxLocations</span>&nbsp;<span class="op" id="3972372">:=</span>&nbsp;<span class="ident" id="3972375"><a href="/crypto/des/block.go.html#3972327">key</a></span>&nbsp;<span class="op" id="3972379">^</span>&nbsp;<span class="ident" id="3972381"><a href="/crypto/des/block.go.html#3973518">expandBlock</a></span><span class="op" id="3972392">(</span><span class="ident" id="3972393"><a href="/crypto/des/block.go.html#3972313">right</a></span><span class="op" id="3972398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3972401">var</span>&nbsp;<span class="ident" id="3972405">sBoxResult</span>&nbsp;<span class="builtintype" id="3972416">uint32</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3972424">for</span>&nbsp;<span class="ident" id="3972428">i</span>&nbsp;<span class="op" id="3972430">:=</span>&nbsp;<span class="builtintype" id="3972433">uint8</span><span class="op" id="3972438">(</span><span class="num" id="3972439">0</span><span class="op" id="3972440">)</span><span class="op" id="3972441">;</span>&nbsp;<span class="ident" id="3972443"><a href="/crypto/des/block.go.html#3972428">i</a></span>&nbsp;<span class="op" id="3972445">&lt;</span>&nbsp;<span class="num" id="3972447">8</span><span class="op" id="3972448">;</span>&nbsp;<span class="ident" id="3972450"><a href="/crypto/des/block.go.html#3972428">i</a></span><span class="op" id="3972451">++</span>&nbsp;<span class="op" id="3972454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972458">sBoxLocation</span>&nbsp;<span class="op" id="3972471">:=</span>&nbsp;<span class="builtintype" id="3972474">uint8</span><span class="op" id="3972479">(</span><span class="ident" id="3972480"><a href="/crypto/des/block.go.html#3972358">sBoxLocations</a></span><span class="op" id="3972493">&gt;&gt;</span><span class="num" id="3972495">42</span><span class="op" id="3972497">)</span>&nbsp;<span class="op" id="3972499">&amp;</span>&nbsp;<span class="num" id="3972501">0x3f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972508"><a href="/crypto/des/block.go.html#3972358">sBoxLocations</a></span>&nbsp;<span class="op" id="3972522">&lt;&lt;=</span>&nbsp;<span class="num" id="3972526">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3972530">//&nbsp;row&nbsp;determined&nbsp;by&nbsp;1st&nbsp;and&nbsp;6th&nbsp;bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3972569">//&nbsp;column&nbsp;is&nbsp;middle&nbsp;four&nbsp;bits</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972601">row</span>&nbsp;<span class="op" id="3972605">:=</span>&nbsp;<span class="op" id="3972608">(</span><span class="ident" id="3972609"><a href="/crypto/des/block.go.html#3972458">sBoxLocation</a></span>&nbsp;<span class="op" id="3972622">&amp;</span>&nbsp;<span class="num" id="3972624">0x1</span><span class="op" id="3972627">)</span>&nbsp;<span class="op" id="3972629">|</span>&nbsp;<span class="op" id="3972631">(</span><span class="op" id="3972632">(</span><span class="ident" id="3972633"><a href="/crypto/des/block.go.html#3972458">sBoxLocation</a></span>&nbsp;<span class="op" id="3972646">&amp;</span>&nbsp;<span class="num" id="3972648">0x20</span><span class="op" id="3972652">)</span>&nbsp;<span class="op" id="3972654">&gt;&gt;</span>&nbsp;<span class="num" id="3972657">4</span><span class="op" id="3972658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972662">column</span>&nbsp;<span class="op" id="3972669">:=</span>&nbsp;<span class="op" id="3972672">(</span><span class="ident" id="3972673"><a href="/crypto/des/block.go.html#3972458">sBoxLocation</a></span>&nbsp;<span class="op" id="3972686">&gt;&gt;</span>&nbsp;<span class="num" id="3972689">1</span><span class="op" id="3972690">)</span>&nbsp;<span class="op" id="3972692">&amp;</span>&nbsp;<span class="num" id="3972694">0xf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3972700"><a href="/crypto/des/block.go.html#3972405">sBoxResult</a></span>&nbsp;<span class="op" id="3972711">^=</span>&nbsp;<span class="ident" id="3972714"><a href="/crypto/des/block.go.html#3972874">feistelBox</a></span><span class="op" id="3972724">[</span><span class="ident" id="3972725"><a href="/crypto/des/block.go.html#3972428">i</a></span><span class="op" id="3972726">]</span><span class="op" id="3972727">[</span><span class="num" id="3972728">16</span><span class="op" id="3972730">*</span><span class="ident" id="3972731"><a href="/crypto/des/block.go.html#3972601">row</a></span><span class="op" id="3972734">+</span><span class="ident" id="3972735"><a href="/crypto/des/block.go.html#3972662">column</a></span><span class="op" id="3972741">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3972744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3972747">return</span>&nbsp;<span class="ident" id="3972754"><a href="/crypto/des/block.go.html#3972405">sBoxResult</a></span><br>
<span class="lineno">55</span><span class="op" id="3972765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3972768">//&nbsp;feistelBox[s][16*i+j]&nbsp;contains&nbsp;the&nbsp;output&nbsp;of&nbsp;permutationFunction</span><br>
<span class="lineno"></span><span class="comment" id="3972836">//&nbsp;for&nbsp;sBoxes[s][i][j]&nbsp;&lt;&lt;&nbsp;4*(7-s)</span><br>
<span class="lineno"></span><span class="keyword" id="3972870">var</span>&nbsp;<span class="ident" id="3972874">feistelBox</span>&nbsp;<span class="op" id="3972885">[</span><span class="num" id="3972886">8</span><span class="op" id="3972887">]</span><span class="op" id="3972888">[</span><span class="num" id="3972889">64</span><span class="op" id="3972891">]</span><span class="builtintype" id="3972892">uint32</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="3972900">//&nbsp;general&nbsp;purpose&nbsp;function&nbsp;to&nbsp;perform&nbsp;DES&nbsp;block&nbsp;permutations</span><br>
<span class="lineno"></span><span class="keyword" id="3972962">func</span>&nbsp;<span class="ident" id="3972967">permuteBlock</span><span class="op" id="3972979">(</span><span class="ident" id="3972980">src</span>&nbsp;<span class="ident" id="3972984">uint64</span><span class="op" id="3972990">,</span>&nbsp;<span class="ident" id="3972992">permutation</span>&nbsp;<span class="op" id="3973004">[</span><span class="op" id="3973005">]</span><span class="builtintype" id="3973006">uint8</span><span class="op" id="3973011">)</span>&nbsp;<span class="op" id="3973013">(</span><span class="ident" id="3973014">block</span>&nbsp;<span class="ident" id="3973020">uint64</span><span class="op" id="3973026">)</span>&nbsp;<span class="op" id="3973028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973031">for</span>&nbsp;<span class="ident" id="3973035">position</span><span class="op" id="3973043">,</span>&nbsp;<span class="ident" id="3973045">n</span>&nbsp;<span class="op" id="3973047">:=</span>&nbsp;<span class="keyword" id="3973050">range</span>&nbsp;<span class="ident" id="3973056"><a href="/crypto/des/block.go.html#3972992">permutation</a></span>&nbsp;<span class="op" id="3973068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973072">bit</span>&nbsp;<span class="op" id="3973076">:=</span>&nbsp;<span class="op" id="3973079">(</span><span class="ident" id="3973080"><a href="/crypto/des/block.go.html#3972980">src</a></span>&nbsp;<span class="op" id="3973084">&gt;&gt;</span>&nbsp;<span class="ident" id="3973087"><a href="/crypto/des/block.go.html#3973045">n</a></span><span class="op" id="3973088">)</span>&nbsp;<span class="op" id="3973090">&amp;</span>&nbsp;<span class="num" id="3973092">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973096"><a href="/crypto/des/block.go.html#3973014">block</a></span>&nbsp;<span class="op" id="3973102">|=</span>&nbsp;<span class="ident" id="3973105"><a href="/crypto/des/block.go.html#3973072">bit</a></span>&nbsp;<span class="op" id="3973109">&lt;&lt;</span>&nbsp;<span class="builtintype" id="3973112">uint</span><span class="op" id="3973116">(</span><span class="op" id="3973117">(</span><span class="builtinfunc" id="3973118">len</span><span class="op" id="3973121">(</span><span class="ident" id="3973122"><a href="/crypto/des/block.go.html#3972992">permutation</a></span><span class="op" id="3973133">)</span><span class="op" id="3973134">-</span><span class="num" id="3973135">1</span><span class="op" id="3973136">)</span><span class="op" id="3973137">-</span><span class="ident" id="3973138"><a href="/crypto/des/block.go.html#3973035">position</a></span><span class="op" id="3973146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3973149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973152">return</span><br>
<span class="lineno"></span><span class="op" id="3973159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="3973162">func</span>&nbsp;<span class="ident" id="3973167">init</span><span class="op" id="3973171">(</span><span class="op" id="3973172">)</span>&nbsp;<span class="op" id="3973174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973177">for</span>&nbsp;<span class="ident" id="3973181">s</span>&nbsp;<span class="op" id="3973183">:=</span>&nbsp;<span class="keyword" id="3973186">range</span>&nbsp;<span class="ident" id="3973192"><a href="/crypto/des/const.go.html#3981309">sBoxes</a></span>&nbsp;<span class="op" id="3973199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973203">for</span>&nbsp;<span class="ident" id="3973207">i</span>&nbsp;<span class="op" id="3973209">:=</span>&nbsp;<span class="num" id="3973212">0</span><span class="op" id="3973213">;</span>&nbsp;<span class="ident" id="3973215"><a href="/crypto/des/block.go.html#3973207">i</a></span>&nbsp;<span class="op" id="3973217">&lt;</span>&nbsp;<span class="num" id="3973219">4</span><span class="op" id="3973220">;</span>&nbsp;<span class="ident" id="3973222"><a href="/crypto/des/block.go.html#3973207">i</a></span><span class="op" id="3973223">++</span>&nbsp;<span class="op" id="3973226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973231">for</span>&nbsp;<span class="ident" id="3973235">j</span>&nbsp;<span class="op" id="3973237">:=</span>&nbsp;<span class="num" id="3973240">0</span><span class="op" id="3973241">;</span>&nbsp;<span class="ident" id="3973243"><a href="/crypto/des/block.go.html#3973235">j</a></span>&nbsp;<span class="op" id="3973245">&lt;</span>&nbsp;<span class="num" id="3973247">16</span><span class="op" id="3973249">;</span>&nbsp;<span class="ident" id="3973251"><a href="/crypto/des/block.go.html#3973235">j</a></span><span class="op" id="3973252">++</span>&nbsp;<span class="op" id="3973255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973261">f</span>&nbsp;<span class="op" id="3973263">:=</span>&nbsp;<span class="ident" id="3973266">uint64</span><span class="op" id="3973272">(</span><span class="ident" id="3973273"><a href="/crypto/des/const.go.html#3981309">sBoxes</a></span><span class="op" id="3973279">[</span><span class="ident" id="3973280"><a href="/crypto/des/block.go.html#3973181">s</a></span><span class="op" id="3973281">]</span><span class="op" id="3973282">[</span><span class="ident" id="3973283"><a href="/crypto/des/block.go.html#3973207">i</a></span><span class="op" id="3973284">]</span><span class="op" id="3973285">[</span><span class="ident" id="3973286"><a href="/crypto/des/block.go.html#3973235">j</a></span><span class="op" id="3973287">]</span><span class="op" id="3973288">)</span>&nbsp;<span class="op" id="3973290">&lt;&lt;</span>&nbsp;<span class="op" id="3973293">(</span><span class="num" id="3973294">4</span>&nbsp;<span class="op" id="3973296">*</span>&nbsp;<span class="op" id="3973298">(</span><span class="num" id="3973299">7</span>&nbsp;<span class="op" id="3973301">-</span>&nbsp;<span class="builtintype" id="3973303">uint</span><span class="op" id="3973307">(</span><span class="ident" id="3973308"><a href="/crypto/des/block.go.html#3973181">s</a></span><span class="op" id="3973309">)</span><span class="op" id="3973310">)</span><span class="op" id="3973311">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973317"><a href="/crypto/des/block.go.html#3973261">f</a></span>&nbsp;<span class="op" id="3973319">=</span>&nbsp;<span class="ident" id="3973321"><a href="/crypto/des/block.go.html#3972967">permuteBlock</a></span><span class="op" id="3973333">(</span><span class="ident" id="3973334">uint64</span><span class="op" id="3973340">(</span><span class="ident" id="3973341"><a href="/crypto/des/block.go.html#3973261">f</a></span><span class="op" id="3973342">)</span><span class="op" id="3973343">,</span>&nbsp;<span class="ident" id="3973345"><a href="/crypto/des/const.go.html#3980417">permutationFunction</a></span><span class="op" id="3973364">[</span><span class="op" id="3973365">:</span><span class="op" id="3973366">]</span><span class="op" id="3973367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973373"><a href="/crypto/des/block.go.html#3972874">feistelBox</a></span><span class="op" id="3973383">[</span><span class="ident" id="3973384"><a href="/crypto/des/block.go.html#3973181">s</a></span><span class="op" id="3973385">]</span><span class="op" id="3973386">[</span><span class="num" id="3973387">16</span><span class="op" id="3973389">*</span><span class="ident" id="3973390"><a href="/crypto/des/block.go.html#3973207">i</a></span><span class="op" id="3973391">+</span><span class="ident" id="3973392"><a href="/crypto/des/block.go.html#3973235">j</a></span><span class="op" id="3973393">]</span>&nbsp;<span class="op" id="3973395">=</span>&nbsp;<span class="builtintype" id="3973397">uint32</span><span class="op" id="3973403">(</span><span class="ident" id="3973404"><a href="/crypto/des/block.go.html#3973261">f</a></span><span class="op" id="3973405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3973410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3973414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3973417">}</span><br>
<span class="lineno">80</span><span class="op" id="3973419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3973422">//&nbsp;expandBlock&nbsp;expands&nbsp;an&nbsp;input&nbsp;block&nbsp;of&nbsp;32&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="3973472">//&nbsp;producing&nbsp;an&nbsp;output&nbsp;block&nbsp;of&nbsp;48&nbsp;bits.</span><br>
<span class="lineno"></span><span class="keyword" id="3973513">func</span>&nbsp;<span class="ident" id="3973518">expandBlock</span><span class="op" id="3973529">(</span><span class="ident" id="3973530">src</span>&nbsp;<span class="builtintype" id="3973534">uint32</span><span class="op" id="3973540">)</span>&nbsp;<span class="op" id="3973542">(</span><span class="ident" id="3973543">block</span>&nbsp;<span class="ident" id="3973549">uint64</span><span class="op" id="3973555">)</span>&nbsp;<span class="op" id="3973557">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3973560">//&nbsp;rotate&nbsp;the&nbsp;5&nbsp;highest&nbsp;bits&nbsp;to&nbsp;the&nbsp;right.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973604"><a href="/crypto/des/block.go.html#3973530">src</a></span>&nbsp;<span class="op" id="3973608">=</span>&nbsp;<span class="op" id="3973610">(</span><span class="ident" id="3973611"><a href="/crypto/des/block.go.html#3973530">src</a></span>&nbsp;<span class="op" id="3973615">&lt;&lt;</span>&nbsp;<span class="num" id="3973618">5</span><span class="op" id="3973619">)</span>&nbsp;<span class="op" id="3973621">|</span>&nbsp;<span class="op" id="3973623">(</span><span class="ident" id="3973624"><a href="/crypto/des/block.go.html#3973530">src</a></span>&nbsp;<span class="op" id="3973628">&gt;&gt;</span>&nbsp;<span class="num" id="3973631">27</span><span class="op" id="3973633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973636">for</span>&nbsp;<span class="ident" id="3973640">i</span>&nbsp;<span class="op" id="3973642">:=</span>&nbsp;<span class="num" id="3973645">0</span><span class="op" id="3973646">;</span>&nbsp;<span class="ident" id="3973648"><a href="/crypto/des/block.go.html#3973640">i</a></span>&nbsp;<span class="op" id="3973650">&lt;</span>&nbsp;<span class="num" id="3973652">8</span><span class="op" id="3973653">;</span>&nbsp;<span class="ident" id="3973655"><a href="/crypto/des/block.go.html#3973640">i</a></span><span class="op" id="3973656">++</span>&nbsp;<span class="op" id="3973659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973663"><a href="/crypto/des/block.go.html#3973543">block</a></span>&nbsp;<span class="op" id="3973669">&lt;&lt;=</span>&nbsp;<span class="num" id="3973673">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3973677">//&nbsp;take&nbsp;the&nbsp;6&nbsp;bits&nbsp;on&nbsp;the&nbsp;right</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973711"><a href="/crypto/des/block.go.html#3973543">block</a></span>&nbsp;<span class="op" id="3973717">|=</span>&nbsp;<span class="ident" id="3973720">uint64</span><span class="op" id="3973726">(</span><span class="ident" id="3973727"><a href="/crypto/des/block.go.html#3973530">src</a></span><span class="op" id="3973730">)</span>&nbsp;<span class="op" id="3973732">&amp;</span>&nbsp;<span class="op" id="3973734">(</span><span class="num" id="3973735">1</span><span class="op" id="3973736">&lt;&lt;</span><span class="num" id="3973738">6</span>&nbsp;<span class="op" id="3973740">-</span>&nbsp;<span class="num" id="3973742">1</span><span class="op" id="3973743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3973747">//&nbsp;advance&nbsp;by&nbsp;4&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3973771"><a href="/crypto/des/block.go.html#3973530">src</a></span>&nbsp;<span class="op" id="3973775">=</span>&nbsp;<span class="op" id="3973777">(</span><span class="ident" id="3973778"><a href="/crypto/des/block.go.html#3973530">src</a></span>&nbsp;<span class="op" id="3973782">&lt;&lt;</span>&nbsp;<span class="num" id="3973785">4</span><span class="op" id="3973786">)</span>&nbsp;<span class="op" id="3973788">|</span>&nbsp;<span class="op" id="3973790">(</span><span class="ident" id="3973791"><a href="/crypto/des/block.go.html#3973530">src</a></span>&nbsp;<span class="op" id="3973795">&gt;&gt;</span>&nbsp;<span class="num" id="3973798">28</span><span class="op" id="3973800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3973803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3973806">return</span><br>
<span class="lineno">95</span><span class="op" id="3973813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3973816">//&nbsp;permuteInitialBlock&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;permutation&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="3973880">//&nbsp;by&nbsp;initialPermutation.</span><br>
<span class="lineno"></span><span class="keyword" id="3973906">func</span>&nbsp;<span class="ident" id="3973911">permuteInitialBlock</span><span class="op" id="3973930">(</span><span class="ident" id="3973931">block</span>&nbsp;<span class="ident" id="3973937">uint64</span><span class="op" id="3973943">)</span>&nbsp;<span class="ident" id="3973945">uint64</span>&nbsp;<span class="op" id="3973952">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3973955">//&nbsp;block&nbsp;=&nbsp;b7&nbsp;b6&nbsp;b5&nbsp;b4&nbsp;b3&nbsp;b2&nbsp;b1&nbsp;b0&nbsp;(8&nbsp;bytes)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974001">b1</span>&nbsp;<span class="op" id="3974004">:=</span>&nbsp;<span class="ident" id="3974007"><a href="/crypto/des/block.go.html#3973931">block</a></span>&nbsp;<span class="op" id="3974013">&gt;&gt;</span>&nbsp;<span class="num" id="3974016">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974020">b2</span>&nbsp;<span class="op" id="3974023">:=</span>&nbsp;<span class="ident" id="3974026"><a href="/crypto/des/block.go.html#3973931">block</a></span>&nbsp;<span class="op" id="3974032">&lt;&lt;</span>&nbsp;<span class="num" id="3974035">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974039"><a href="/crypto/des/block.go.html#3973931">block</a></span>&nbsp;<span class="op" id="3974045">^=</span>&nbsp;<span class="ident" id="3974048"><a href="/crypto/des/block.go.html#3974001">b1</a></span>&nbsp;<span class="op" id="3974051">^</span>&nbsp;<span class="ident" id="3974053"><a href="/crypto/des/block.go.html#3974020">b2</a></span>&nbsp;<span class="op" id="3974056">^</span>&nbsp;<span class="ident" id="3974058"><a href="/crypto/des/block.go.html#3974001">b1</a></span><span class="op" id="3974060">&lt;&lt;</span><span class="num" id="3974062">48</span>&nbsp;<span class="op" id="3974065">^</span>&nbsp;<span class="ident" id="3974067"><a href="/crypto/des/block.go.html#3974020">b2</a></span><span class="op" id="3974069">&gt;&gt;</span><span class="num" id="3974071">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3974076">//&nbsp;block&nbsp;=&nbsp;b1&nbsp;b0&nbsp;b5&nbsp;b4&nbsp;b3&nbsp;b2&nbsp;b7&nbsp;b6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974112"><a href="/crypto/des/block.go.html#3974001">b1</a></span>&nbsp;<span class="op" id="3974115">=</span>&nbsp;<span class="ident" id="3974117"><a href="/crypto/des/block.go.html#3973931">block</a></span>&nbsp;<span class="op" id="3974123">&gt;&gt;</span>&nbsp;<span class="num" id="3974126">32</span>&nbsp;<span class="op" id="3974129">&amp;</span>&nbsp;<span class="num" id="3974131">0xff00ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974141"><a href="/crypto/des/block.go.html#3974020">b2</a></span>&nbsp;<span class="op" id="3974144">=</span>&nbsp;<span class="op" id="3974146">(</span><span class="ident" id="3974147"><a href="/crypto/des/block.go.html#3973931">block</a></span>&nbsp;<span class="op" id="3974153">&amp;</span>&nbsp;<span class="num" id="3974155">0xff00ff00</span><span class="op" id="3974165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974168"><a href="/crypto/des/block.go.html#3973931">block</a></span>&nbsp;<span class="op" id="3974174">^=</span>&nbsp;<span class="ident" id="3974177"><a href="/crypto/des/block.go.html#3974001">b1</a></span><span class="op" id="3974179">&lt;&lt;</span><span class="num" id="3974181">32</span>&nbsp;<span class="op" id="3974184">^</span>&nbsp;<span class="ident" id="3974186"><a href="/crypto/des/block.go.html#3974020">b2</a></span>&nbsp;<span class="op" id="3974189">^</span>&nbsp;<span class="ident" id="3974191"><a href="/crypto/des/block.go.html#3974001">b1</a></span><span class="op" id="3974193">&lt;&lt;</span><span class="num" id="3974195">8</span>&nbsp;<span class="op" id="3974197">^</span>&nbsp;<span class="ident" id="3974199"><a href="/crypto/des/block.go.html#3974020">b2</a></span><span class="op" id="3974201">&lt;&lt;</span><span class="num" id="3974203">24</span>&nbsp;<span class="comment" id="3974206">//&nbsp;exchange&nbsp;b0&nbsp;b4&nbsp;with&nbsp;b3&nbsp;b7</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3974237">//&nbsp;block&nbsp;is&nbsp;now&nbsp;b1&nbsp;b3&nbsp;b5&nbsp;b7&nbsp;b0&nbsp;b2&nbsp;b4&nbsp;b7,&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3974296">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3974324">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3974352">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3974380">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;56</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3974408">//&nbsp;&nbsp;7&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;&nbsp;4&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3974436">//&nbsp;23&nbsp;22&nbsp;21&nbsp;20&nbsp;19&nbsp;18&nbsp;17&nbsp;16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3974464">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3974492">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;48</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3974521">//&nbsp;exchange&nbsp;4,5,6,7&nbsp;with&nbsp;32,33,34,35&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974564"><a href="/crypto/des/block.go.html#3974001">b1</a></span>&nbsp;<span class="op" id="3974567">=</span>&nbsp;<span class="ident" id="3974569"><a href="/crypto/des/block.go.html#3973931">block</a></span>&nbsp;<span class="op" id="3974575">&amp;</span>&nbsp;<span class="num" id="3974577">0x0f0f00000f0f0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974597"><a href="/crypto/des/block.go.html#3974020">b2</a></span>&nbsp;<span class="op" id="3974600">=</span>&nbsp;<span class="ident" id="3974602"><a href="/crypto/des/block.go.html#3973931">block</a></span>&nbsp;<span class="op" id="3974608">&amp;</span>&nbsp;<span class="num" id="3974610">0x0000f0f00000f0f0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974630"><a href="/crypto/des/block.go.html#3973931">block</a></span>&nbsp;<span class="op" id="3974636">^=</span>&nbsp;<span class="ident" id="3974639"><a href="/crypto/des/block.go.html#3974001">b1</a></span>&nbsp;<span class="op" id="3974642">^</span>&nbsp;<span class="ident" id="3974644"><a href="/crypto/des/block.go.html#3974020">b2</a></span>&nbsp;<span class="op" id="3974647">^</span>&nbsp;<span class="ident" id="3974649"><a href="/crypto/des/block.go.html#3974001">b1</a></span><span class="op" id="3974651">&gt;&gt;</span><span class="num" id="3974653">12</span>&nbsp;<span class="op" id="3974656">^</span>&nbsp;<span class="ident" id="3974658"><a href="/crypto/des/block.go.html#3974020">b2</a></span><span class="op" id="3974660">&lt;&lt;</span><span class="num" id="3974662">12</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3974667">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3974697">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3974701">//&nbsp;&nbsp;&nbsp;[+8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[+40]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3974726">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3974730">//&nbsp;&nbsp;7&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;&nbsp;4</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3974746">//&nbsp;23&nbsp;22&nbsp;21&nbsp;20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3974762">//&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3974778">//&nbsp;19&nbsp;18&nbsp;17&nbsp;16&nbsp;&nbsp;&nbsp;&nbsp;[+32]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3974804">//&nbsp;exchange&nbsp;0,1,4,5&nbsp;with&nbsp;18,19,22,23</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974842"><a href="/crypto/des/block.go.html#3974001">b1</a></span>&nbsp;<span class="op" id="3974845">=</span>&nbsp;<span class="ident" id="3974847"><a href="/crypto/des/block.go.html#3973931">block</a></span>&nbsp;<span class="op" id="3974853">&amp;</span>&nbsp;<span class="num" id="3974855">0x3300330033003300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974875"><a href="/crypto/des/block.go.html#3974020">b2</a></span>&nbsp;<span class="op" id="3974878">=</span>&nbsp;<span class="ident" id="3974880"><a href="/crypto/des/block.go.html#3973931">block</a></span>&nbsp;<span class="op" id="3974886">&amp;</span>&nbsp;<span class="num" id="3974888">0x00cc00cc00cc00cc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3974908"><a href="/crypto/des/block.go.html#3973931">block</a></span>&nbsp;<span class="op" id="3974914">^=</span>&nbsp;<span class="ident" id="3974917"><a href="/crypto/des/block.go.html#3974001">b1</a></span>&nbsp;<span class="op" id="3974920">^</span>&nbsp;<span class="ident" id="3974922"><a href="/crypto/des/block.go.html#3974020">b2</a></span>&nbsp;<span class="op" id="3974925">^</span>&nbsp;<span class="ident" id="3974927"><a href="/crypto/des/block.go.html#3974001">b1</a></span><span class="op" id="3974929">&gt;&gt;</span><span class="num" id="3974931">6</span>&nbsp;<span class="op" id="3974933">^</span>&nbsp;<span class="ident" id="3974935"><a href="/crypto/des/block.go.html#3974020">b2</a></span><span class="op" id="3974937">&lt;&lt;</span><span class="num" id="3974939">6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3974943">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3974973">//&nbsp;15&nbsp;14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3974983">//&nbsp;13&nbsp;12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3974993">//&nbsp;11&nbsp;10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3975003">//&nbsp;&nbsp;9&nbsp;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3975013">//&nbsp;&nbsp;7&nbsp;&nbsp;6</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3975023">//&nbsp;&nbsp;5&nbsp;&nbsp;4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3975033">//&nbsp;&nbsp;3&nbsp;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3975043">//&nbsp;&nbsp;1&nbsp;&nbsp;0&nbsp;[+16]&nbsp;[+32]&nbsp;[+64]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3975072">//&nbsp;exchange&nbsp;0,2,4,6&nbsp;with&nbsp;9,11,13,15:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975110"><a href="/crypto/des/block.go.html#3974001">b1</a></span>&nbsp;<span class="op" id="3975113">=</span>&nbsp;<span class="ident" id="3975115"><a href="/crypto/des/block.go.html#3973931">block</a></span>&nbsp;<span class="op" id="3975121">&amp;</span>&nbsp;<span class="num" id="3975123">0xaaaaaaaa55555555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975143"><a href="/crypto/des/block.go.html#3973931">block</a></span>&nbsp;<span class="op" id="3975149">^=</span>&nbsp;<span class="ident" id="3975152"><a href="/crypto/des/block.go.html#3974001">b1</a></span>&nbsp;<span class="op" id="3975155">^</span>&nbsp;<span class="ident" id="3975157"><a href="/crypto/des/block.go.html#3974001">b1</a></span><span class="op" id="3975159">&gt;&gt;</span><span class="num" id="3975161">33</span>&nbsp;<span class="op" id="3975164">^</span>&nbsp;<span class="ident" id="3975166"><a href="/crypto/des/block.go.html#3974001">b1</a></span><span class="op" id="3975168">&lt;&lt;</span><span class="num" id="3975170">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3975175">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3975205">//&nbsp;6&nbsp;14&nbsp;22&nbsp;30&nbsp;38&nbsp;46&nbsp;54&nbsp;62</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3975232">//&nbsp;4&nbsp;12&nbsp;20&nbsp;28&nbsp;36&nbsp;44&nbsp;52&nbsp;60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3975259">//&nbsp;2&nbsp;10&nbsp;18&nbsp;26&nbsp;34&nbsp;42&nbsp;50&nbsp;58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3975286">//&nbsp;0&nbsp;&nbsp;8&nbsp;16&nbsp;24&nbsp;32&nbsp;40&nbsp;48&nbsp;56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3975313">//&nbsp;7&nbsp;15&nbsp;23&nbsp;31&nbsp;39&nbsp;47&nbsp;55&nbsp;63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3975340">//&nbsp;5&nbsp;13&nbsp;21&nbsp;29&nbsp;37&nbsp;45&nbsp;53&nbsp;61</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3975367">//&nbsp;3&nbsp;11&nbsp;19&nbsp;27&nbsp;35&nbsp;43&nbsp;51&nbsp;59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3975394">//&nbsp;1&nbsp;&nbsp;9&nbsp;17&nbsp;25&nbsp;33&nbsp;41&nbsp;49&nbsp;57</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3975421">return</span>&nbsp;<span class="ident" id="3975428"><a href="/crypto/des/block.go.html#3973931">block</a></span><br>
<span class="lineno"></span><span class="op" id="3975434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="3975437">//&nbsp;permuteInitialBlock&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;permutation&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="3975501">//&nbsp;by&nbsp;finalPermutation.</span><br>
<span class="lineno"></span><span class="keyword" id="3975525">func</span>&nbsp;<span class="ident" id="3975530">permuteFinalBlock</span><span class="op" id="3975547">(</span><span class="ident" id="3975548">block</span>&nbsp;<span class="ident" id="3975554">uint64</span><span class="op" id="3975560">)</span>&nbsp;<span class="ident" id="3975562">uint64</span>&nbsp;<span class="op" id="3975569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3975572">//&nbsp;Perform&nbsp;the&nbsp;same&nbsp;bit&nbsp;exchanges&nbsp;as&nbsp;permuteInitialBlock</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3975630">//&nbsp;but&nbsp;in&nbsp;reverse&nbsp;order.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975656">b1</span>&nbsp;<span class="op" id="3975659">:=</span>&nbsp;<span class="ident" id="3975662"><a href="/crypto/des/block.go.html#3975548">block</a></span>&nbsp;<span class="op" id="3975668">&amp;</span>&nbsp;<span class="num" id="3975670">0xaaaaaaaa55555555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975690"><a href="/crypto/des/block.go.html#3975548">block</a></span>&nbsp;<span class="op" id="3975696">^=</span>&nbsp;<span class="ident" id="3975699"><a href="/crypto/des/block.go.html#3975656">b1</a></span>&nbsp;<span class="op" id="3975702">^</span>&nbsp;<span class="ident" id="3975704"><a href="/crypto/des/block.go.html#3975656">b1</a></span><span class="op" id="3975706">&gt;&gt;</span><span class="num" id="3975708">33</span>&nbsp;<span class="op" id="3975711">^</span>&nbsp;<span class="ident" id="3975713"><a href="/crypto/des/block.go.html#3975656">b1</a></span><span class="op" id="3975715">&lt;&lt;</span><span class="num" id="3975717">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975722"><a href="/crypto/des/block.go.html#3975656">b1</a></span>&nbsp;<span class="op" id="3975725">=</span>&nbsp;<span class="ident" id="3975727"><a href="/crypto/des/block.go.html#3975548">block</a></span>&nbsp;<span class="op" id="3975733">&amp;</span>&nbsp;<span class="num" id="3975735">0x3300330033003300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975755">b2</span>&nbsp;<span class="op" id="3975758">:=</span>&nbsp;<span class="ident" id="3975761"><a href="/crypto/des/block.go.html#3975548">block</a></span>&nbsp;<span class="op" id="3975767">&amp;</span>&nbsp;<span class="num" id="3975769">0x00cc00cc00cc00cc</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975789"><a href="/crypto/des/block.go.html#3975548">block</a></span>&nbsp;<span class="op" id="3975795">^=</span>&nbsp;<span class="ident" id="3975798"><a href="/crypto/des/block.go.html#3975656">b1</a></span>&nbsp;<span class="op" id="3975801">^</span>&nbsp;<span class="ident" id="3975803"><a href="/crypto/des/block.go.html#3975755">b2</a></span>&nbsp;<span class="op" id="3975806">^</span>&nbsp;<span class="ident" id="3975808"><a href="/crypto/des/block.go.html#3975656">b1</a></span><span class="op" id="3975810">&gt;&gt;</span><span class="num" id="3975812">6</span>&nbsp;<span class="op" id="3975814">^</span>&nbsp;<span class="ident" id="3975816"><a href="/crypto/des/block.go.html#3975755">b2</a></span><span class="op" id="3975818">&lt;&lt;</span><span class="num" id="3975820">6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975824"><a href="/crypto/des/block.go.html#3975656">b1</a></span>&nbsp;<span class="op" id="3975827">=</span>&nbsp;<span class="ident" id="3975829"><a href="/crypto/des/block.go.html#3975548">block</a></span>&nbsp;<span class="op" id="3975835">&amp;</span>&nbsp;<span class="num" id="3975837">0x0f0f00000f0f0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975857"><a href="/crypto/des/block.go.html#3975755">b2</a></span>&nbsp;<span class="op" id="3975860">=</span>&nbsp;<span class="ident" id="3975862"><a href="/crypto/des/block.go.html#3975548">block</a></span>&nbsp;<span class="op" id="3975868">&amp;</span>&nbsp;<span class="num" id="3975870">0x0000f0f00000f0f0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975890"><a href="/crypto/des/block.go.html#3975548">block</a></span>&nbsp;<span class="op" id="3975896">^=</span>&nbsp;<span class="ident" id="3975899"><a href="/crypto/des/block.go.html#3975656">b1</a></span>&nbsp;<span class="op" id="3975902">^</span>&nbsp;<span class="ident" id="3975904"><a href="/crypto/des/block.go.html#3975755">b2</a></span>&nbsp;<span class="op" id="3975907">^</span>&nbsp;<span class="ident" id="3975909"><a href="/crypto/des/block.go.html#3975656">b1</a></span><span class="op" id="3975911">&gt;&gt;</span><span class="num" id="3975913">12</span>&nbsp;<span class="op" id="3975916">^</span>&nbsp;<span class="ident" id="3975918"><a href="/crypto/des/block.go.html#3975755">b2</a></span><span class="op" id="3975920">&lt;&lt;</span><span class="num" id="3975922">12</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975927"><a href="/crypto/des/block.go.html#3975656">b1</a></span>&nbsp;<span class="op" id="3975930">=</span>&nbsp;<span class="ident" id="3975932"><a href="/crypto/des/block.go.html#3975548">block</a></span>&nbsp;<span class="op" id="3975938">&gt;&gt;</span>&nbsp;<span class="num" id="3975941">32</span>&nbsp;<span class="op" id="3975944">&amp;</span>&nbsp;<span class="num" id="3975946">0xff00ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975956"><a href="/crypto/des/block.go.html#3975755">b2</a></span>&nbsp;<span class="op" id="3975959">=</span>&nbsp;<span class="op" id="3975961">(</span><span class="ident" id="3975962"><a href="/crypto/des/block.go.html#3975548">block</a></span>&nbsp;<span class="op" id="3975968">&amp;</span>&nbsp;<span class="num" id="3975970">0xff00ff00</span><span class="op" id="3975980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3975983"><a href="/crypto/des/block.go.html#3975548">block</a></span>&nbsp;<span class="op" id="3975989">^=</span>&nbsp;<span class="ident" id="3975992"><a href="/crypto/des/block.go.html#3975656">b1</a></span><span class="op" id="3975994">&lt;&lt;</span><span class="num" id="3975996">32</span>&nbsp;<span class="op" id="3975999">^</span>&nbsp;<span class="ident" id="3976001"><a href="/crypto/des/block.go.html#3975755">b2</a></span>&nbsp;<span class="op" id="3976004">^</span>&nbsp;<span class="ident" id="3976006"><a href="/crypto/des/block.go.html#3975656">b1</a></span><span class="op" id="3976008">&lt;&lt;</span><span class="num" id="3976010">8</span>&nbsp;<span class="op" id="3976012">^</span>&nbsp;<span class="ident" id="3976014"><a href="/crypto/des/block.go.html#3975755">b2</a></span><span class="op" id="3976016">&lt;&lt;</span><span class="num" id="3976018">24</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976023"><a href="/crypto/des/block.go.html#3975656">b1</a></span>&nbsp;<span class="op" id="3976026">=</span>&nbsp;<span class="ident" id="3976028"><a href="/crypto/des/block.go.html#3975548">block</a></span>&nbsp;<span class="op" id="3976034">&gt;&gt;</span>&nbsp;<span class="num" id="3976037">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976041"><a href="/crypto/des/block.go.html#3975755">b2</a></span>&nbsp;<span class="op" id="3976044">=</span>&nbsp;<span class="ident" id="3976046"><a href="/crypto/des/block.go.html#3975548">block</a></span>&nbsp;<span class="op" id="3976052">&lt;&lt;</span>&nbsp;<span class="num" id="3976055">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976059"><a href="/crypto/des/block.go.html#3975548">block</a></span>&nbsp;<span class="op" id="3976065">^=</span>&nbsp;<span class="ident" id="3976068"><a href="/crypto/des/block.go.html#3975656">b1</a></span>&nbsp;<span class="op" id="3976071">^</span>&nbsp;<span class="ident" id="3976073"><a href="/crypto/des/block.go.html#3975755">b2</a></span>&nbsp;<span class="op" id="3976076">^</span>&nbsp;<span class="ident" id="3976078"><a href="/crypto/des/block.go.html#3975656">b1</a></span><span class="op" id="3976080">&lt;&lt;</span><span class="num" id="3976082">48</span>&nbsp;<span class="op" id="3976085">^</span>&nbsp;<span class="ident" id="3976087"><a href="/crypto/des/block.go.html#3975755">b2</a></span><span class="op" id="3976089">&gt;&gt;</span><span class="num" id="3976091">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3976095">return</span>&nbsp;<span class="ident" id="3976102"><a href="/crypto/des/block.go.html#3975548">block</a></span><br>
<span class="lineno"></span><span class="op" id="3976108">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="3976111">//&nbsp;creates&nbsp;16&nbsp;28-bit&nbsp;blocks&nbsp;rotated&nbsp;according</span><br>
<span class="lineno"></span><span class="comment" id="3976157">//&nbsp;to&nbsp;the&nbsp;rotation&nbsp;schedule</span><br>
<span class="lineno"></span><span class="keyword" id="3976185">func</span>&nbsp;<span class="ident" id="3976190">ksRotate</span><span class="op" id="3976198">(</span><span class="ident" id="3976199">in</span>&nbsp;<span class="builtintype" id="3976202">uint32</span><span class="op" id="3976208">)</span>&nbsp;<span class="op" id="3976210">(</span><span class="ident" id="3976211">out</span>&nbsp;<span class="op" id="3976215">[</span><span class="op" id="3976216">]</span><span class="builtintype" id="3976217">uint32</span><span class="op" id="3976223">)</span>&nbsp;<span class="op" id="3976225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976228"><a href="/crypto/des/block.go.html#3976211">out</a></span>&nbsp;<span class="op" id="3976232">=</span>&nbsp;<span class="builtinfunc" id="3976234">make</span><span class="op" id="3976238">(</span><span class="op" id="3976239">[</span><span class="op" id="3976240">]</span><span class="builtintype" id="3976241">uint32</span><span class="op" id="3976247">,</span>&nbsp;<span class="num" id="3976249">16</span><span class="op" id="3976251">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976254">last</span>&nbsp;<span class="op" id="3976259">:=</span>&nbsp;<span class="ident" id="3976262"><a href="/crypto/des/block.go.html#3976199">in</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3976266">for</span>&nbsp;<span class="ident" id="3976270">i</span>&nbsp;<span class="op" id="3976272">:=</span>&nbsp;<span class="num" id="3976275">0</span><span class="op" id="3976276">;</span>&nbsp;<span class="ident" id="3976278"><a href="/crypto/des/block.go.html#3976270">i</a></span>&nbsp;<span class="op" id="3976280">&lt;</span>&nbsp;<span class="num" id="3976282">16</span><span class="op" id="3976284">;</span>&nbsp;<span class="ident" id="3976286"><a href="/crypto/des/block.go.html#3976270">i</a></span><span class="op" id="3976287">++</span>&nbsp;<span class="op" id="3976290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3976294">//&nbsp;28-bit&nbsp;circular&nbsp;left&nbsp;shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976326">left</span>&nbsp;<span class="op" id="3976331">:=</span>&nbsp;<span class="op" id="3976334">(</span><span class="ident" id="3976335"><a href="/crypto/des/block.go.html#3976254">last</a></span>&nbsp;<span class="op" id="3976340">&lt;&lt;</span>&nbsp;<span class="op" id="3976343">(</span><span class="num" id="3976344">4</span>&nbsp;<span class="op" id="3976346">+</span>&nbsp;<span class="ident" id="3976348"><a href="/crypto/des/const.go.html#3983418">ksRotations</a></span><span class="op" id="3976359">[</span><span class="ident" id="3976360"><a href="/crypto/des/block.go.html#3976270">i</a></span><span class="op" id="3976361">]</span><span class="op" id="3976362">)</span><span class="op" id="3976363">)</span>&nbsp;<span class="op" id="3976365">&gt;&gt;</span>&nbsp;<span class="num" id="3976368">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976372">right</span>&nbsp;<span class="op" id="3976378">:=</span>&nbsp;<span class="op" id="3976381">(</span><span class="ident" id="3976382"><a href="/crypto/des/block.go.html#3976254">last</a></span>&nbsp;<span class="op" id="3976387">&lt;&lt;</span>&nbsp;<span class="num" id="3976390">4</span><span class="op" id="3976391">)</span>&nbsp;<span class="op" id="3976393">&gt;&gt;</span>&nbsp;<span class="op" id="3976396">(</span><span class="num" id="3976397">32</span>&nbsp;<span class="op" id="3976400">-</span>&nbsp;<span class="ident" id="3976402"><a href="/crypto/des/const.go.html#3983418">ksRotations</a></span><span class="op" id="3976413">[</span><span class="ident" id="3976414"><a href="/crypto/des/block.go.html#3976270">i</a></span><span class="op" id="3976415">]</span><span class="op" id="3976416">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976420"><a href="/crypto/des/block.go.html#3976211">out</a></span><span class="op" id="3976423">[</span><span class="ident" id="3976424"><a href="/crypto/des/block.go.html#3976270">i</a></span><span class="op" id="3976425">]</span>&nbsp;<span class="op" id="3976427">=</span>&nbsp;<span class="ident" id="3976429"><a href="/crypto/des/block.go.html#3976326">left</a></span>&nbsp;<span class="op" id="3976434">|</span>&nbsp;<span class="ident" id="3976436"><a href="/crypto/des/block.go.html#3976372">right</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976444"><a href="/crypto/des/block.go.html#3976254">last</a></span>&nbsp;<span class="op" id="3976449">=</span>&nbsp;<span class="ident" id="3976451"><a href="/crypto/des/block.go.html#3976211">out</a></span><span class="op" id="3976454">[</span><span class="ident" id="3976455"><a href="/crypto/des/block.go.html#3976270">i</a></span><span class="op" id="3976456">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3976459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3976462">return</span><br>
<span class="lineno"></span><span class="op" id="3976469">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="3976472">//&nbsp;creates&nbsp;16&nbsp;56-bit&nbsp;subkeys&nbsp;from&nbsp;the&nbsp;original&nbsp;key</span><br>
<span class="lineno"></span><span class="keyword" id="3976523">func</span>&nbsp;<span class="op" id="3976528">(</span><span class="ident" id="3976529">c</span>&nbsp;<span class="op" id="3976531">*</span><span class="ident" id="3976532"><a href="/crypto/des/cipher.go.html#3977611">desCipher</a></span><span class="op" id="3976541">)</span>&nbsp;<span class="ident" id="3976543">generateSubkeys</span><span class="op" id="3976558">(</span><span class="ident" id="3976559">keyBytes</span>&nbsp;<span class="op" id="3976568">[</span><span class="op" id="3976569">]</span><span class="builtintype" id="3976570">byte</span><span class="op" id="3976574">)</span>&nbsp;<span class="op" id="3976576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3976579">//&nbsp;apply&nbsp;PC1&nbsp;permutation&nbsp;to&nbsp;key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976612">key</span>&nbsp;<span class="op" id="3976616">:=</span>&nbsp;<span class="ident" id="3976619"><a href="/crypto/des/block.go.html#3971423">binary</a></span><span class="op" id="3976625">.</span><span class="ident" id="3976626">BigEndian</span><span class="op" id="3976635">.</span><span class="ident" id="3976636">Uint64</span><span class="op" id="3976642">(</span><span class="ident" id="3976643"><a href="/crypto/des/block.go.html#3976559">keyBytes</a></span><span class="op" id="3976651">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976654">permutedKey</span>&nbsp;<span class="op" id="3976666">:=</span>&nbsp;<span class="ident" id="3976669"><a href="/crypto/des/block.go.html#3972967">permuteBlock</a></span><span class="op" id="3976681">(</span><span class="ident" id="3976682"><a href="/crypto/des/block.go.html#3976612">key</a></span><span class="op" id="3976685">,</span>&nbsp;<span class="ident" id="3976687"><a href="/crypto/des/const.go.html#3980648">permutedChoice1</a></span><span class="op" id="3976702">[</span><span class="op" id="3976703">:</span><span class="op" id="3976704">]</span><span class="op" id="3976705">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3976709">//&nbsp;rotate&nbsp;halves&nbsp;of&nbsp;permuted&nbsp;key&nbsp;according&nbsp;to&nbsp;the&nbsp;rotation&nbsp;schedule</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976778">leftRotations</span>&nbsp;<span class="op" id="3976792">:=</span>&nbsp;<span class="ident" id="3976795"><a href="/crypto/des/block.go.html#3976190">ksRotate</a></span><span class="op" id="3976803">(</span><span class="builtintype" id="3976804">uint32</span><span class="op" id="3976810">(</span><span class="ident" id="3976811"><a href="/crypto/des/block.go.html#3976654">permutedKey</a></span>&nbsp;<span class="op" id="3976823">&gt;&gt;</span>&nbsp;<span class="num" id="3976826">28</span><span class="op" id="3976828">)</span><span class="op" id="3976829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976832">rightRotations</span>&nbsp;<span class="op" id="3976847">:=</span>&nbsp;<span class="ident" id="3976850"><a href="/crypto/des/block.go.html#3976190">ksRotate</a></span><span class="op" id="3976858">(</span><span class="builtintype" id="3976859">uint32</span><span class="op" id="3976865">(</span><span class="ident" id="3976866"><a href="/crypto/des/block.go.html#3976654">permutedKey</a></span><span class="op" id="3976877">&lt;&lt;</span><span class="num" id="3976879">4</span><span class="op" id="3976880">)</span>&nbsp;<span class="op" id="3976882">&gt;&gt;</span>&nbsp;<span class="num" id="3976885">4</span><span class="op" id="3976886">)</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3976890">//&nbsp;generate&nbsp;subkeys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3976911">for</span>&nbsp;<span class="ident" id="3976915">i</span>&nbsp;<span class="op" id="3976917">:=</span>&nbsp;<span class="num" id="3976920">0</span><span class="op" id="3976921">;</span>&nbsp;<span class="ident" id="3976923"><a href="/crypto/des/block.go.html#3976915">i</a></span>&nbsp;<span class="op" id="3976925">&lt;</span>&nbsp;<span class="num" id="3976927">16</span><span class="op" id="3976929">;</span>&nbsp;<span class="ident" id="3976931"><a href="/crypto/des/block.go.html#3976915">i</a></span><span class="op" id="3976932">++</span>&nbsp;<span class="op" id="3976935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3976939">//&nbsp;combine&nbsp;halves&nbsp;to&nbsp;form&nbsp;56-bit&nbsp;input&nbsp;to&nbsp;PC2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3976987">pc2Input</span>&nbsp;<span class="op" id="3976996">:=</span>&nbsp;<span class="ident" id="3976999">uint64</span><span class="op" id="3977005">(</span><span class="ident" id="3977006"><a href="/crypto/des/block.go.html#3976778">leftRotations</a></span><span class="op" id="3977019">[</span><span class="ident" id="3977020"><a href="/crypto/des/block.go.html#3976915">i</a></span><span class="op" id="3977021">]</span><span class="op" id="3977022">)</span><span class="op" id="3977023">&lt;&lt;</span><span class="num" id="3977025">28</span>&nbsp;<span class="op" id="3977028">|</span>&nbsp;<span class="ident" id="3977030">uint64</span><span class="op" id="3977036">(</span><span class="ident" id="3977037"><a href="/crypto/des/block.go.html#3976832">rightRotations</a></span><span class="op" id="3977051">[</span><span class="ident" id="3977052"><a href="/crypto/des/block.go.html#3976915">i</a></span><span class="op" id="3977053">]</span><span class="op" id="3977054">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3977058">//&nbsp;apply&nbsp;PC2&nbsp;permutation&nbsp;to&nbsp;7&nbsp;byte&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3977101"><a href="/crypto/des/block.go.html#3976529">c</a></span><span class="op" id="3977102">.</span><span class="ident" id="3977103">subkeys</span><span class="op" id="3977110">[</span><span class="ident" id="3977111"><a href="/crypto/des/block.go.html#3976915">i</a></span><span class="op" id="3977112">]</span>&nbsp;<span class="op" id="3977114">=</span>&nbsp;<span class="ident" id="3977116"><a href="/crypto/des/block.go.html#3972967">permuteBlock</a></span><span class="op" id="3977128">(</span><span class="ident" id="3977129"><a href="/crypto/des/block.go.html#3976987">pc2Input</a></span><span class="op" id="3977137">,</span>&nbsp;<span class="ident" id="3977139"><a href="/crypto/des/const.go.html#3981003">permutedChoice2</a></span><span class="op" id="3977154">[</span><span class="op" id="3977155">:</span><span class="op" id="3977156">]</span><span class="op" id="3977157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3977160">}</span><br>
<span class="lineno"></span><span class="op" id="3977162">}</span>
</div>
</body>
</html>
