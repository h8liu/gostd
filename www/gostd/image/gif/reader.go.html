<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/gif</h2>
<ul>
<li><a href="/gostd/image/gif/reader.go.html" class="current">reader.go</a></li>
<li><a href="/gostd/image/gif/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/image/gif/writer.go.html">writer.go</a></li>
<li><a href="/gostd/image/gif/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5714188">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5714243">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5714297">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5714348">//&nbsp;Package&nbsp;gif&nbsp;implements&nbsp;a&nbsp;GIF&nbsp;image&nbsp;decoder&nbsp;and&nbsp;encoder.</span><br>
<span class="lineno"></span><span class="comment" id="5714407">//</span><br>
<span class="lineno"></span><span class="comment" id="5714410">//&nbsp;The&nbsp;GIF&nbsp;specification&nbsp;is&nbsp;at&nbsp;http://www.w3.org/Graphics/GIF/spec-gif89a.txt.</span><br>
<span class="lineno"></span><span class="keyword" id="5714489">package</span>&nbsp;<span class="ident" id="5714497">gif</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="5714502">import</span>&nbsp;<span class="op" id="5714509">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5714512">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5714521">&#34;compress/lzw&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5714537">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5714547">&#34;fmt&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5714554">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5714563">&#34;image/color&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5714578">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="5714583">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="5714586">var</span>&nbsp;<span class="op" id="5714590">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5714593">errNotEnough</span>&nbsp;<span class="op" id="5714606">=</span>&nbsp;<span class="ident" id="5714608"><a href="/gostd/image/gif/reader.go.html#5714537">errors</a></span><span class="op" id="5714614">.</span><span class="ident" id="5714615"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="5714618">(</span><span class="string" id="5714619">&#34;gif:&nbsp;not&nbsp;enough&nbsp;image&nbsp;data&#34;</span><span class="op" id="5714647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5714650">errTooMuch</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5714663">=</span>&nbsp;<span class="ident" id="5714665"><a href="/gostd/image/gif/reader.go.html#5714537">errors</a></span><span class="op" id="5714671">.</span><span class="ident" id="5714672"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="5714675">(</span><span class="string" id="5714676">&#34;gif:&nbsp;too&nbsp;much&nbsp;image&nbsp;data&#34;</span><span class="op" id="5714702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5714705">errBadPixel</span>&nbsp;&nbsp;<span class="op" id="5714718">=</span>&nbsp;<span class="ident" id="5714720"><a href="/gostd/image/gif/reader.go.html#5714537">errors</a></span><span class="op" id="5714726">.</span><span class="ident" id="5714727"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="5714730">(</span><span class="string" id="5714731">&#34;gif:&nbsp;invalid&nbsp;pixel&nbsp;value&#34;</span><span class="op" id="5714757">)</span><br>
<span class="lineno"></span><span class="op" id="5714759">)</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="5714762">//&nbsp;If&nbsp;the&nbsp;io.Reader&nbsp;does&nbsp;not&nbsp;also&nbsp;have&nbsp;ReadByte,&nbsp;then&nbsp;decode&nbsp;will&nbsp;introduce&nbsp;its&nbsp;own&nbsp;buffering.</span><br>
<span class="lineno"></span><span class="keyword" id="5714857">type</span>&nbsp;<span class="ident" id="5714862">reader</span>&nbsp;<span class="keyword" id="5714869">interface</span>&nbsp;<span class="op" id="5714879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5714882"><a href="/gostd/image/gif/reader.go.html#5714578">io</a></span><span class="op" id="5714884">.</span><span class="ident" id="5714885"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5714893"><a href="/gostd/image/gif/reader.go.html#5714578">io</a></span><span class="op" id="5714895">.</span><span class="ident" id="5714896"><a href="/gostd/io/io.go.html#1426965">ByteReader</a></span><br>
<span class="lineno">30</span><span class="op" id="5714907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5714910">//&nbsp;Masks&nbsp;etc.</span><br>
<span class="lineno"></span><span class="keyword" id="5714924">const</span>&nbsp;<span class="op" id="5714930">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5714933">//&nbsp;Fields.</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5714945">fColorMapFollows</span>&nbsp;<span class="op" id="5714962">=</span>&nbsp;<span class="num" id="5714964">1</span>&nbsp;<span class="op" id="5714966">&lt;&lt;</span>&nbsp;<span class="num" id="5714969">7</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5714973">//&nbsp;Image&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5714991">ifLocalColorTable</span>&nbsp;<span class="op" id="5715009">=</span>&nbsp;<span class="num" id="5715011">1</span>&nbsp;<span class="op" id="5715013">&lt;&lt;</span>&nbsp;<span class="num" id="5715016">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715019">ifInterlace</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5715037">=</span>&nbsp;<span class="num" id="5715039">1</span>&nbsp;<span class="op" id="5715041">&lt;&lt;</span>&nbsp;<span class="num" id="5715044">6</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715047">ifPixelSizeMask</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5715065">=</span>&nbsp;<span class="num" id="5715067">7</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5715071">//&nbsp;Graphic&nbsp;control&nbsp;flags.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715098">gcTransparentColorSet</span>&nbsp;<span class="op" id="5715120">=</span>&nbsp;<span class="num" id="5715122">1</span>&nbsp;<span class="op" id="5715124">&lt;&lt;</span>&nbsp;<span class="num" id="5715127">0</span><br>
<span class="lineno"></span><span class="op" id="5715129">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="5715132">//&nbsp;Section&nbsp;indicators.</span><br>
<span class="lineno"></span><span class="keyword" id="5715155">const</span>&nbsp;<span class="op" id="5715161">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715164">sExtension</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5715181">=</span>&nbsp;<span class="num" id="5715183">0x21</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715189">sImageDescriptor</span>&nbsp;<span class="op" id="5715206">=</span>&nbsp;<span class="num" id="5715208">0x2C</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715214">sTrailer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5715231">=</span>&nbsp;<span class="num" id="5715233">0x3B</span><br>
<span class="lineno"></span><span class="op" id="5715238">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5715241">//&nbsp;Extensions.</span><br>
<span class="lineno"></span><span class="keyword" id="5715256">const</span>&nbsp;<span class="op" id="5715262">(</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715265">eText</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5715281">=</span>&nbsp;<span class="num" id="5715283">0x01</span>&nbsp;<span class="comment" id="5715288">//&nbsp;Plain&nbsp;Text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715303">eGraphicControl</span>&nbsp;<span class="op" id="5715319">=</span>&nbsp;<span class="num" id="5715321">0xF9</span>&nbsp;<span class="comment" id="5715326">//&nbsp;Graphic&nbsp;Control</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715346">eComment</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5715362">=</span>&nbsp;<span class="num" id="5715364">0xFE</span>&nbsp;<span class="comment" id="5715369">//&nbsp;Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715381">eApplication</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5715397">=</span>&nbsp;<span class="num" id="5715399">0xFF</span>&nbsp;<span class="comment" id="5715404">//&nbsp;Application</span><br>
<span class="lineno"></span><span class="op" id="5715419">)</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="5715422">//&nbsp;decoder&nbsp;is&nbsp;the&nbsp;type&nbsp;used&nbsp;to&nbsp;decode&nbsp;a&nbsp;GIF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5715472">type</span>&nbsp;<span class="ident" id="5715477">decoder</span>&nbsp;<span class="keyword" id="5715485">struct</span>&nbsp;<span class="op" id="5715492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715495">r</span>&nbsp;<span class="ident" id="5715497"><a href="/gostd/image/gif/reader.go.html#5714862">reader</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5715506">//&nbsp;From&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715523">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5715539">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715547">width</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5715563">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715568">height</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5715584">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715589">flags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5715605">byte</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715611">headerFields</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5715627">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715633">backgroundIndex</span>&nbsp;<span class="builtintype" id="5715649">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715655">loopCount</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5715671">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715676">delayTime</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5715692">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5715698">//&nbsp;Unused&nbsp;from&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715722">aspect</span>&nbsp;<span class="builtintype" id="5715729">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5715736">//&nbsp;From&nbsp;image&nbsp;descriptor.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715763">imageFields</span>&nbsp;<span class="builtintype" id="5715775">byte</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5715782">//&nbsp;From&nbsp;graphics&nbsp;control.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715809">transparentIndex</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5715829">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715835">hasTransparentIndex</span>&nbsp;<span class="builtintype" id="5715855">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5715862">//&nbsp;Computed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715876">pixelSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5715891">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715897">globalColorMap</span>&nbsp;<span class="ident" id="5715912"><a href="/gostd/image/gif/reader.go.html#5714563">color</a></span><span class="op" id="5715917">.</span><span class="ident" id="5715918"><a href="/gostd/image/color/color.go.html#5190467">Palette</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5715928">//&nbsp;Used&nbsp;when&nbsp;decoding.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715952">delay</span>&nbsp;<span class="op" id="5715958">[</span><span class="op" id="5715959">]</span><span class="builtintype" id="5715960">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715965">image</span>&nbsp;<span class="op" id="5715971">[</span><span class="op" id="5715972">]</span><span class="op" id="5715973">*</span><span class="ident" id="5715974"><a href="/gostd/image/gif/reader.go.html#5714554">image</a></span><span class="op" id="5715979">.</span><span class="ident" id="5715980"><a href="/gostd/image/image.go.html#5176435">Paletted</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715990">tmp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5715996">[</span><span class="num" id="5715997">1024</span><span class="op" id="5716001">]</span><span class="builtintype" id="5716002">byte</span>&nbsp;<span class="comment" id="5716007">//&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;768&nbsp;so&nbsp;we&nbsp;can&nbsp;read&nbsp;color&nbsp;map</span><br>
<span class="lineno"></span><span class="op" id="5716056">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="5716059">//&nbsp;blockReader&nbsp;parses&nbsp;the&nbsp;block&nbsp;structure&nbsp;of&nbsp;GIF&nbsp;image&nbsp;data,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="5716126">//&nbsp;comprises&nbsp;(n,&nbsp;(n&nbsp;bytes))&nbsp;blocks,&nbsp;with&nbsp;1&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;255.&nbsp;&nbsp;It&nbsp;is&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5716193">//&nbsp;reader&nbsp;given&nbsp;to&nbsp;the&nbsp;LZW&nbsp;decoder,&nbsp;which&nbsp;is&nbsp;thus&nbsp;immune&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5716257">//&nbsp;blocking.&nbsp;&nbsp;After&nbsp;the&nbsp;LZW&nbsp;decoder&nbsp;completes,&nbsp;there&nbsp;will&nbsp;be&nbsp;a&nbsp;0-byte</span><br>
<span class="lineno"></span><span class="comment" id="5716327">//&nbsp;block&nbsp;remaining&nbsp;(0,&nbsp;()),&nbsp;which&nbsp;is&nbsp;consumed&nbsp;when&nbsp;checking&nbsp;that&nbsp;the</span><br>
<span class="lineno">100</span><span class="comment" id="5716396">//&nbsp;blockReader&nbsp;is&nbsp;exhausted.</span><br>
<span class="lineno"></span><span class="keyword" id="5716425">type</span>&nbsp;<span class="ident" id="5716430">blockReader</span>&nbsp;<span class="keyword" id="5716442">struct</span>&nbsp;<span class="op" id="5716449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5716452">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5716458"><a href="/gostd/image/gif/reader.go.html#5714862">reader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5716466">slice</span>&nbsp;<span class="op" id="5716472">[</span><span class="op" id="5716473">]</span><span class="builtintype" id="5716474">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5716480">err</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5716486">error</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5716493">tmp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5716499">[</span><span class="num" id="5716500">256</span><span class="op" id="5716503">]</span><span class="builtintype" id="5716504">byte</span><br>
<span class="lineno"></span><span class="op" id="5716509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5716512">func</span>&nbsp;<span class="op" id="5716517">(</span><span class="ident" id="5716518">b</span>&nbsp;<span class="op" id="5716520">*</span><span class="ident" id="5716521"><a href="/gostd/image/gif/reader.go.html#5716430">blockReader</a></span><span class="op" id="5716532">)</span>&nbsp;<span class="ident" id="5716534">Read</span><span class="op" id="5716538">(</span><span class="ident" id="5716539">p</span>&nbsp;<span class="op" id="5716541">[</span><span class="op" id="5716542">]</span><span class="builtintype" id="5716543">byte</span><span class="op" id="5716547">)</span>&nbsp;<span class="op" id="5716549">(</span><span class="builtintype" id="5716550">int</span><span class="op" id="5716553">,</span>&nbsp;<span class="builtintype" id="5716555">error</span><span class="op" id="5716560">)</span>&nbsp;<span class="op" id="5716562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716565">if</span>&nbsp;<span class="ident" id="5716568"><a href="/gostd/image/gif/reader.go.html#5716518">b</a></span><span class="op" id="5716569">.</span><span class="ident" id="5716570"><a href="/gostd/image/gif/reader.go.html#5716480">err</a></span>&nbsp;<span class="op" id="5716574">!=</span>&nbsp;<span class="builtintype" id="5716577">nil</span>&nbsp;<span class="op" id="5716581">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716585">return</span>&nbsp;<span class="num" id="5716592">0</span><span class="op" id="5716593">,</span>&nbsp;<span class="ident" id="5716595"><a href="/gostd/image/gif/reader.go.html#5716518">b</a></span><span class="op" id="5716596">.</span><span class="ident" id="5716597"><a href="/gostd/image/gif/reader.go.html#5716480">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5716602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716605">if</span>&nbsp;<span class="builtinfunc" id="5716608">len</span><span class="op" id="5716611">(</span><span class="ident" id="5716612"><a href="/gostd/image/gif/reader.go.html#5716539">p</a></span><span class="op" id="5716613">)</span>&nbsp;<span class="op" id="5716615">==</span>&nbsp;<span class="num" id="5716618">0</span>&nbsp;<span class="op" id="5716620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716624">return</span>&nbsp;<span class="num" id="5716631">0</span><span class="op" id="5716632">,</span>&nbsp;<span class="builtintype" id="5716634">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5716639">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716642">if</span>&nbsp;<span class="builtinfunc" id="5716645">len</span><span class="op" id="5716648">(</span><span class="ident" id="5716649"><a href="/gostd/image/gif/reader.go.html#5716518">b</a></span><span class="op" id="5716650">.</span><span class="ident" id="5716651"><a href="/gostd/image/gif/reader.go.html#5716466">slice</a></span><span class="op" id="5716656">)</span>&nbsp;<span class="op" id="5716658">==</span>&nbsp;<span class="num" id="5716661">0</span>&nbsp;<span class="op" id="5716663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716667">var</span>&nbsp;<span class="ident" id="5716671">blockLen</span>&nbsp;<span class="builtintype" id="5716680">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5716688"><a href="/gostd/image/gif/reader.go.html#5716671">blockLen</a></span><span class="op" id="5716696">,</span>&nbsp;<span class="ident" id="5716698"><a href="/gostd/image/gif/reader.go.html#5716518">b</a></span><span class="op" id="5716699">.</span><span class="ident" id="5716700"><a href="/gostd/image/gif/reader.go.html#5716480">err</a></span>&nbsp;<span class="op" id="5716704">=</span>&nbsp;<span class="ident" id="5716706"><a href="/gostd/image/gif/reader.go.html#5716518">b</a></span><span class="op" id="5716707">.</span><span class="ident" id="5716708"><a href="/gostd/image/gif/reader.go.html#5716452">r</a></span><span class="op" id="5716709">.</span><span class="ident" id="5716710"><a href="/gostd/io/io.go.html#1426989">ReadByte</a></span><span class="op" id="5716718">(</span><span class="op" id="5716719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716723">if</span>&nbsp;<span class="ident" id="5716726"><a href="/gostd/image/gif/reader.go.html#5716518">b</a></span><span class="op" id="5716727">.</span><span class="ident" id="5716728"><a href="/gostd/image/gif/reader.go.html#5716480">err</a></span>&nbsp;<span class="op" id="5716732">!=</span>&nbsp;<span class="builtintype" id="5716735">nil</span>&nbsp;<span class="op" id="5716739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716744">return</span>&nbsp;<span class="num" id="5716751">0</span><span class="op" id="5716752">,</span>&nbsp;<span class="ident" id="5716754"><a href="/gostd/image/gif/reader.go.html#5716518">b</a></span><span class="op" id="5716755">.</span><span class="ident" id="5716756"><a href="/gostd/image/gif/reader.go.html#5716480">err</a></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5716762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716766">if</span>&nbsp;<span class="ident" id="5716769"><a href="/gostd/image/gif/reader.go.html#5716671">blockLen</a></span>&nbsp;<span class="op" id="5716778">==</span>&nbsp;<span class="num" id="5716781">0</span>&nbsp;<span class="op" id="5716783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5716788"><a href="/gostd/image/gif/reader.go.html#5716518">b</a></span><span class="op" id="5716789">.</span><span class="ident" id="5716790"><a href="/gostd/image/gif/reader.go.html#5716480">err</a></span>&nbsp;<span class="op" id="5716794">=</span>&nbsp;<span class="ident" id="5716796"><a href="/gostd/image/gif/reader.go.html#5714578">io</a></span><span class="op" id="5716798">.</span><span class="ident" id="5716799"><a href="/gostd/io/io.go.html#1419950">EOF</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716806">return</span>&nbsp;<span class="num" id="5716813">0</span><span class="op" id="5716814">,</span>&nbsp;<span class="ident" id="5716816"><a href="/gostd/image/gif/reader.go.html#5716518">b</a></span><span class="op" id="5716817">.</span><span class="ident" id="5716818"><a href="/gostd/image/gif/reader.go.html#5716480">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5716824">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5716828"><a href="/gostd/image/gif/reader.go.html#5716518">b</a></span><span class="op" id="5716829">.</span><span class="ident" id="5716830"><a href="/gostd/image/gif/reader.go.html#5716466">slice</a></span>&nbsp;<span class="op" id="5716836">=</span>&nbsp;<span class="ident" id="5716838"><a href="/gostd/image/gif/reader.go.html#5716518">b</a></span><span class="op" id="5716839">.</span><span class="ident" id="5716840"><a href="/gostd/image/gif/reader.go.html#5716493">tmp</a></span><span class="op" id="5716843">[</span><span class="num" id="5716844">0</span><span class="op" id="5716845">:</span><span class="ident" id="5716846"><a href="/gostd/image/gif/reader.go.html#5716671">blockLen</a></span><span class="op" id="5716854">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716858">if</span>&nbsp;<span class="ident" id="5716861">_</span><span class="op" id="5716862">,</span>&nbsp;<span class="ident" id="5716864"><a href="/gostd/image/gif/reader.go.html#5716518">b</a></span><span class="op" id="5716865">.</span><span class="ident" id="5716866"><a href="/gostd/image/gif/reader.go.html#5716480">err</a></span>&nbsp;<span class="op" id="5716870">=</span>&nbsp;<span class="ident" id="5716872"><a href="/gostd/image/gif/reader.go.html#5714578">io</a></span><span class="op" id="5716874">.</span><span class="ident" id="5716875"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="5716883">(</span><span class="ident" id="5716884"><a href="/gostd/image/gif/reader.go.html#5716518">b</a></span><span class="op" id="5716885">.</span><span class="ident" id="5716886"><a href="/gostd/image/gif/reader.go.html#5716452">r</a></span><span class="op" id="5716887">,</span>&nbsp;<span class="ident" id="5716889"><a href="/gostd/image/gif/reader.go.html#5716518">b</a></span><span class="op" id="5716890">.</span><span class="ident" id="5716891"><a href="/gostd/image/gif/reader.go.html#5716466">slice</a></span><span class="op" id="5716896">)</span><span class="op" id="5716897">;</span>&nbsp;<span class="ident" id="5716899"><a href="/gostd/image/gif/reader.go.html#5716518">b</a></span><span class="op" id="5716900">.</span><span class="ident" id="5716901"><a href="/gostd/image/gif/reader.go.html#5716480">err</a></span>&nbsp;<span class="op" id="5716905">!=</span>&nbsp;<span class="builtintype" id="5716908">nil</span>&nbsp;<span class="op" id="5716912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716917">return</span>&nbsp;<span class="num" id="5716924">0</span><span class="op" id="5716925">,</span>&nbsp;<span class="ident" id="5716927"><a href="/gostd/image/gif/reader.go.html#5716518">b</a></span><span class="op" id="5716928">.</span><span class="ident" id="5716929"><a href="/gostd/image/gif/reader.go.html#5716480">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5716935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5716938">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5716941">n</span>&nbsp;<span class="op" id="5716943">:=</span>&nbsp;<span class="builtinfunc" id="5716946">copy</span><span class="op" id="5716950">(</span><span class="ident" id="5716951"><a href="/gostd/image/gif/reader.go.html#5716539">p</a></span><span class="op" id="5716952">,</span>&nbsp;<span class="ident" id="5716954"><a href="/gostd/image/gif/reader.go.html#5716518">b</a></span><span class="op" id="5716955">.</span><span class="ident" id="5716956"><a href="/gostd/image/gif/reader.go.html#5716466">slice</a></span><span class="op" id="5716961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5716964"><a href="/gostd/image/gif/reader.go.html#5716518">b</a></span><span class="op" id="5716965">.</span><span class="ident" id="5716966"><a href="/gostd/image/gif/reader.go.html#5716466">slice</a></span>&nbsp;<span class="op" id="5716972">=</span>&nbsp;<span class="ident" id="5716974"><a href="/gostd/image/gif/reader.go.html#5716518">b</a></span><span class="op" id="5716975">.</span><span class="ident" id="5716976"><a href="/gostd/image/gif/reader.go.html#5716466">slice</a></span><span class="op" id="5716981">[</span><span class="ident" id="5716982"><a href="/gostd/image/gif/reader.go.html#5716941">n</a></span><span class="op" id="5716983">:</span><span class="op" id="5716984">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716987">return</span>&nbsp;<span class="ident" id="5716994"><a href="/gostd/image/gif/reader.go.html#5716941">n</a></span><span class="op" id="5716995">,</span>&nbsp;<span class="builtintype" id="5716997">nil</span><br>
<span class="lineno"></span><span class="op" id="5717001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="5717004">//&nbsp;decode&nbsp;reads&nbsp;a&nbsp;GIF&nbsp;image&nbsp;from&nbsp;r&nbsp;and&nbsp;stores&nbsp;the&nbsp;result&nbsp;in&nbsp;d.</span><br>
<span class="lineno"></span><span class="keyword" id="5717067">func</span>&nbsp;<span class="op" id="5717072">(</span><span class="ident" id="5717073">d</span>&nbsp;<span class="op" id="5717075">*</span><span class="ident" id="5717076"><a href="/gostd/image/gif/reader.go.html#5715477">decoder</a></span><span class="op" id="5717083">)</span>&nbsp;<span class="ident" id="5717085">decode</span><span class="op" id="5717091">(</span><span class="ident" id="5717092">r</span>&nbsp;<span class="ident" id="5717094"><a href="/gostd/image/gif/reader.go.html#5714578">io</a></span><span class="op" id="5717096">.</span><span class="ident" id="5717097"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="5717103">,</span>&nbsp;<span class="ident" id="5717105">configOnly</span>&nbsp;<span class="builtintype" id="5717116">bool</span><span class="op" id="5717120">)</span>&nbsp;<span class="builtintype" id="5717122">error</span>&nbsp;<span class="op" id="5717128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5717131">//&nbsp;Add&nbsp;buffering&nbsp;if&nbsp;r&nbsp;does&nbsp;not&nbsp;provide&nbsp;ReadByte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717181">if</span>&nbsp;<span class="ident" id="5717184">rr</span><span class="op" id="5717186">,</span>&nbsp;<span class="ident" id="5717188">ok</span>&nbsp;<span class="op" id="5717191">:=</span>&nbsp;<span class="ident" id="5717194"><a href="/gostd/image/gif/reader.go.html#5717092">r</a></span><span class="op" id="5717195">.</span><span class="op" id="5717196">(</span><span class="ident" id="5717197"><a href="/gostd/image/gif/reader.go.html#5714862">reader</a></span><span class="op" id="5717203">)</span><span class="op" id="5717204">;</span>&nbsp;<span class="ident" id="5717206"><a href="/gostd/image/gif/reader.go.html#5717188">ok</a></span>&nbsp;<span class="op" id="5717209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5717213"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5717214">.</span><span class="ident" id="5717215"><a href="/gostd/image/gif/reader.go.html#5715495">r</a></span>&nbsp;<span class="op" id="5717217">=</span>&nbsp;<span class="ident" id="5717219"><a href="/gostd/image/gif/reader.go.html#5717184">rr</a></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5717223">}</span>&nbsp;<span class="keyword" id="5717225">else</span>&nbsp;<span class="op" id="5717230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5717234"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5717235">.</span><span class="ident" id="5717236"><a href="/gostd/image/gif/reader.go.html#5715495">r</a></span>&nbsp;<span class="op" id="5717238">=</span>&nbsp;<span class="ident" id="5717240"><a href="/gostd/image/gif/reader.go.html#5714512">bufio</a></span><span class="op" id="5717245">.</span><span class="ident" id="5717246"><a href="/gostd/bufio/bufio.go.html#1355792">NewReader</a></span><span class="op" id="5717255">(</span><span class="ident" id="5717256"><a href="/gostd/image/gif/reader.go.html#5717092">r</a></span><span class="op" id="5717257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5717260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5717264">err</span>&nbsp;<span class="op" id="5717268">:=</span>&nbsp;<span class="ident" id="5717271"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5717272">.</span><span class="ident" id="5717273"><a href="/gostd/image/gif/reader.go.html#5719917">readHeaderAndScreenDescriptor</a></span><span class="op" id="5717302">(</span><span class="op" id="5717303">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717306">if</span>&nbsp;<span class="ident" id="5717309"><a href="/gostd/image/gif/reader.go.html#5717264">err</a></span>&nbsp;<span class="op" id="5717313">!=</span>&nbsp;<span class="builtintype" id="5717316">nil</span>&nbsp;<span class="op" id="5717320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717324">return</span>&nbsp;<span class="ident" id="5717331"><a href="/gostd/image/gif/reader.go.html#5717264">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5717336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717339">if</span>&nbsp;<span class="ident" id="5717342"><a href="/gostd/image/gif/reader.go.html#5717105">configOnly</a></span>&nbsp;<span class="op" id="5717353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717357">return</span>&nbsp;<span class="builtintype" id="5717364">nil</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5717369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717373">if</span>&nbsp;<span class="ident" id="5717376"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5717377">.</span><span class="ident" id="5717378"><a href="/gostd/image/gif/reader.go.html#5715611">headerFields</a></span><span class="op" id="5717390">&amp;</span><span class="ident" id="5717391"><a href="/gostd/image/gif/reader.go.html#5714945">fColorMapFollows</a></span>&nbsp;<span class="op" id="5717408">!=</span>&nbsp;<span class="num" id="5717411">0</span>&nbsp;<span class="op" id="5717413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717417">if</span>&nbsp;<span class="ident" id="5717420"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5717421">.</span><span class="ident" id="5717422"><a href="/gostd/image/gif/reader.go.html#5715897">globalColorMap</a></span><span class="op" id="5717436">,</span>&nbsp;<span class="ident" id="5717438"><a href="/gostd/image/gif/reader.go.html#5717264">err</a></span>&nbsp;<span class="op" id="5717442">=</span>&nbsp;<span class="ident" id="5717444"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5717445">.</span><span class="ident" id="5717446"><a href="/gostd/image/gif/reader.go.html#5720435">readColorMap</a></span><span class="op" id="5717458">(</span><span class="op" id="5717459">)</span><span class="op" id="5717460">;</span>&nbsp;<span class="ident" id="5717462"><a href="/gostd/image/gif/reader.go.html#5717264">err</a></span>&nbsp;<span class="op" id="5717466">!=</span>&nbsp;<span class="builtintype" id="5717469">nil</span>&nbsp;<span class="op" id="5717473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717478">return</span>&nbsp;<span class="ident" id="5717485"><a href="/gostd/image/gif/reader.go.html#5717264">err</a></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5717491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5717494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717498">for</span>&nbsp;<span class="op" id="5717502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5717506">c</span><span class="op" id="5717507">,</span>&nbsp;<span class="ident" id="5717509">err</span>&nbsp;<span class="op" id="5717513">:=</span>&nbsp;<span class="ident" id="5717516"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5717517">.</span><span class="ident" id="5717518"><a href="/gostd/image/gif/reader.go.html#5715495">r</a></span><span class="op" id="5717519">.</span><span class="ident" id="5717520"><a href="/gostd/io/io.go.html#1426989">ReadByte</a></span><span class="op" id="5717528">(</span><span class="op" id="5717529">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717533">if</span>&nbsp;<span class="ident" id="5717536"><a href="/gostd/image/gif/reader.go.html#5717509">err</a></span>&nbsp;<span class="op" id="5717540">!=</span>&nbsp;<span class="builtintype" id="5717543">nil</span>&nbsp;<span class="op" id="5717547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717552">return</span>&nbsp;<span class="ident" id="5717559"><a href="/gostd/image/gif/reader.go.html#5717509">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5717565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717569">switch</span>&nbsp;<span class="ident" id="5717576"><a href="/gostd/image/gif/reader.go.html#5717506">c</a></span>&nbsp;<span class="op" id="5717578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717582">case</span>&nbsp;<span class="ident" id="5717587"><a href="/gostd/image/gif/reader.go.html#5715164">sExtension</a></span><span class="op" id="5717597">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717602">if</span>&nbsp;<span class="ident" id="5717605"><a href="/gostd/image/gif/reader.go.html#5717509">err</a></span>&nbsp;<span class="op" id="5717609">=</span>&nbsp;<span class="ident" id="5717611"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5717612">.</span><span class="ident" id="5717613"><a href="/gostd/image/gif/reader.go.html#5721078">readExtension</a></span><span class="op" id="5717626">(</span><span class="op" id="5717627">)</span><span class="op" id="5717628">;</span>&nbsp;<span class="ident" id="5717630"><a href="/gostd/image/gif/reader.go.html#5717509">err</a></span>&nbsp;<span class="op" id="5717634">!=</span>&nbsp;<span class="builtintype" id="5717637">nil</span>&nbsp;<span class="op" id="5717641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717647">return</span>&nbsp;<span class="ident" id="5717654"><a href="/gostd/image/gif/reader.go.html#5717509">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5717661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717666">case</span>&nbsp;<span class="ident" id="5717671"><a href="/gostd/image/gif/reader.go.html#5715189">sImageDescriptor</a></span><span class="op" id="5717687">:</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5717692">m</span><span class="op" id="5717693">,</span>&nbsp;<span class="ident" id="5717695">err</span>&nbsp;<span class="op" id="5717699">:=</span>&nbsp;<span class="ident" id="5717702"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5717703">.</span><span class="ident" id="5717704"><a href="/gostd/image/gif/reader.go.html#5722485">newImageFromDescriptor</a></span><span class="op" id="5717726">(</span><span class="op" id="5717727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717732">if</span>&nbsp;<span class="ident" id="5717735"><a href="/gostd/image/gif/reader.go.html#5717695">err</a></span>&nbsp;<span class="op" id="5717739">!=</span>&nbsp;<span class="builtintype" id="5717742">nil</span>&nbsp;<span class="op" id="5717746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717752">return</span>&nbsp;<span class="ident" id="5717759"><a href="/gostd/image/gif/reader.go.html#5717695">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5717766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5717771">useLocalColorMap</span>&nbsp;<span class="op" id="5717788">:=</span>&nbsp;<span class="ident" id="5717791"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5717792">.</span><span class="ident" id="5717793"><a href="/gostd/image/gif/reader.go.html#5715763">imageFields</a></span><span class="op" id="5717804">&amp;</span><span class="ident" id="5717805"><a href="/gostd/image/gif/reader.go.html#5714945">fColorMapFollows</a></span>&nbsp;<span class="op" id="5717822">!=</span>&nbsp;<span class="num" id="5717825">0</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717830">if</span>&nbsp;<span class="ident" id="5717833"><a href="/gostd/image/gif/reader.go.html#5717771">useLocalColorMap</a></span>&nbsp;<span class="op" id="5717850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5717856"><a href="/gostd/image/gif/reader.go.html#5717692">m</a></span><span class="op" id="5717857">.</span><span class="ident" id="5717858"><a href="/gostd/image/image.go.html#5176774">Palette</a></span><span class="op" id="5717865">,</span>&nbsp;<span class="ident" id="5717867"><a href="/gostd/image/gif/reader.go.html#5717695">err</a></span>&nbsp;<span class="op" id="5717871">=</span>&nbsp;<span class="ident" id="5717873"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5717874">.</span><span class="ident" id="5717875"><a href="/gostd/image/gif/reader.go.html#5720435">readColorMap</a></span><span class="op" id="5717887">(</span><span class="op" id="5717888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717894">if</span>&nbsp;<span class="ident" id="5717897"><a href="/gostd/image/gif/reader.go.html#5717695">err</a></span>&nbsp;<span class="op" id="5717901">!=</span>&nbsp;<span class="builtintype" id="5717904">nil</span>&nbsp;<span class="op" id="5717908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717915">return</span>&nbsp;<span class="ident" id="5717922"><a href="/gostd/image/gif/reader.go.html#5717695">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5717930">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5717935">}</span>&nbsp;<span class="keyword" id="5717937">else</span>&nbsp;<span class="op" id="5717942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5717948"><a href="/gostd/image/gif/reader.go.html#5717692">m</a></span><span class="op" id="5717949">.</span><span class="ident" id="5717950"><a href="/gostd/image/image.go.html#5176774">Palette</a></span>&nbsp;<span class="op" id="5717958">=</span>&nbsp;<span class="ident" id="5717960"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5717961">.</span><span class="ident" id="5717962"><a href="/gostd/image/gif/reader.go.html#5715897">globalColorMap</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5717980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717985">if</span>&nbsp;<span class="ident" id="5717988"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5717989">.</span><span class="ident" id="5717990"><a href="/gostd/image/gif/reader.go.html#5715835">hasTransparentIndex</a></span>&nbsp;<span class="op" id="5718010">&amp;&amp;</span>&nbsp;<span class="builtintype" id="5718013">int</span><span class="op" id="5718016">(</span><span class="ident" id="5718017"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5718018">.</span><span class="ident" id="5718019"><a href="/gostd/image/gif/reader.go.html#5715809">transparentIndex</a></span><span class="op" id="5718035">)</span>&nbsp;<span class="op" id="5718037">&lt;</span>&nbsp;<span class="builtinfunc" id="5718039">len</span><span class="op" id="5718042">(</span><span class="ident" id="5718043"><a href="/gostd/image/gif/reader.go.html#5717692">m</a></span><span class="op" id="5718044">.</span><span class="ident" id="5718045"><a href="/gostd/image/image.go.html#5176774">Palette</a></span><span class="op" id="5718052">)</span>&nbsp;<span class="op" id="5718054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718060">if</span>&nbsp;<span class="op" id="5718063">!</span><span class="ident" id="5718064"><a href="/gostd/image/gif/reader.go.html#5717771">useLocalColorMap</a></span>&nbsp;<span class="op" id="5718081">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5718088">//&nbsp;Clone&nbsp;the&nbsp;global&nbsp;color&nbsp;map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5718124"><a href="/gostd/image/gif/reader.go.html#5717692">m</a></span><span class="op" id="5718125">.</span><span class="ident" id="5718126"><a href="/gostd/image/image.go.html#5176774">Palette</a></span>&nbsp;<span class="op" id="5718134">=</span>&nbsp;<span class="builtinfunc" id="5718136">append</span><span class="op" id="5718142">(</span><span class="ident" id="5718143"><a href="/gostd/image/gif/reader.go.html#5714563">color</a></span><span class="op" id="5718148">.</span><span class="ident" id="5718149"><a href="/gostd/image/color/color.go.html#5190467">Palette</a></span><span class="op" id="5718156">(</span><span class="builtintype" id="5718157">nil</span><span class="op" id="5718160">)</span><span class="op" id="5718161">,</span>&nbsp;<span class="ident" id="5718163"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5718164">.</span><span class="ident" id="5718165"><a href="/gostd/image/gif/reader.go.html#5715897">globalColorMap</a></span><span class="op" id="5718179">...</span><span class="op" id="5718182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5718188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5718194"><a href="/gostd/image/gif/reader.go.html#5717692">m</a></span><span class="op" id="5718195">.</span><span class="ident" id="5718196"><a href="/gostd/image/image.go.html#5176774">Palette</a></span><span class="op" id="5718203">[</span><span class="ident" id="5718204"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5718205">.</span><span class="ident" id="5718206"><a href="/gostd/image/gif/reader.go.html#5715809">transparentIndex</a></span><span class="op" id="5718222">]</span>&nbsp;<span class="op" id="5718224">=</span>&nbsp;<span class="ident" id="5718226"><a href="/gostd/image/gif/reader.go.html#5714563">color</a></span><span class="op" id="5718231">.</span><span class="ident" id="5718232"><a href="/gostd/image/color/color.go.html#5185612">RGBA</a></span><span class="op" id="5718236">{</span><span class="op" id="5718237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5718242">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5718247">litWidth</span><span class="op" id="5718255">,</span>&nbsp;<span class="ident" id="5718257"><a href="/gostd/image/gif/reader.go.html#5717695">err</a></span>&nbsp;<span class="op" id="5718261">:=</span>&nbsp;<span class="ident" id="5718264"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5718265">.</span><span class="ident" id="5718266"><a href="/gostd/image/gif/reader.go.html#5715495">r</a></span><span class="op" id="5718267">.</span><span class="ident" id="5718268"><a href="/gostd/io/io.go.html#1426989">ReadByte</a></span><span class="op" id="5718276">(</span><span class="op" id="5718277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718282">if</span>&nbsp;<span class="ident" id="5718285"><a href="/gostd/image/gif/reader.go.html#5717695">err</a></span>&nbsp;<span class="op" id="5718289">!=</span>&nbsp;<span class="builtintype" id="5718292">nil</span>&nbsp;<span class="op" id="5718296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718302">return</span>&nbsp;<span class="ident" id="5718309"><a href="/gostd/image/gif/reader.go.html#5717695">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5718316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718321">if</span>&nbsp;<span class="ident" id="5718324"><a href="/gostd/image/gif/reader.go.html#5718247">litWidth</a></span>&nbsp;<span class="op" id="5718333">&lt;</span>&nbsp;<span class="num" id="5718335">2</span>&nbsp;<span class="op" id="5718337">||</span>&nbsp;<span class="ident" id="5718340"><a href="/gostd/image/gif/reader.go.html#5718247">litWidth</a></span>&nbsp;<span class="op" id="5718349">&gt;</span>&nbsp;<span class="num" id="5718351">8</span>&nbsp;<span class="op" id="5718353">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718359">return</span>&nbsp;<span class="ident" id="5718366"><a href="/gostd/image/gif/reader.go.html#5714547">fmt</a></span><span class="op" id="5718369">.</span><span class="ident" id="5718370"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="5718376">(</span><span class="string" id="5718377">&#34;gif:&nbsp;pixel&nbsp;size&nbsp;in&nbsp;decode&nbsp;out&nbsp;of&nbsp;range:&nbsp;%d&#34;</span><span class="op" id="5718421">,</span>&nbsp;<span class="ident" id="5718423"><a href="/gostd/image/gif/reader.go.html#5718247">litWidth</a></span><span class="op" id="5718431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5718436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5718441">//&nbsp;A&nbsp;wonderfully&nbsp;Go-like&nbsp;piece&nbsp;of&nbsp;magic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5718485">br</span>&nbsp;<span class="op" id="5718488">:=</span>&nbsp;<span class="op" id="5718491">&amp;</span><span class="ident" id="5718492"><a href="/gostd/image/gif/reader.go.html#5716430">blockReader</a></span><span class="op" id="5718503">{</span><span class="ident" id="5718504"><a href="/gostd/image/gif/reader.go.html#5716452">r</a></span><span class="op" id="5718505">:</span>&nbsp;<span class="ident" id="5718507"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5718508">.</span><span class="ident" id="5718509"><a href="/gostd/image/gif/reader.go.html#5715495">r</a></span><span class="op" id="5718510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5718515">lzwr</span>&nbsp;<span class="op" id="5718520">:=</span>&nbsp;<span class="ident" id="5718523"><a href="/gostd/image/gif/reader.go.html#5714521">lzw</a></span><span class="op" id="5718526">.</span><span class="ident" id="5718527"><a href="/gostd/compress/lzw/reader.go.html#5739741">NewReader</a></span><span class="op" id="5718536">(</span><span class="ident" id="5718537"><a href="/gostd/image/gif/reader.go.html#5718485">br</a></span><span class="op" id="5718539">,</span>&nbsp;<span class="ident" id="5718541"><a href="/gostd/image/gif/reader.go.html#5714521">lzw</a></span><span class="op" id="5718544">.</span><span class="ident" id="5718545"><a href="/gostd/compress/lzw/reader.go.html#5734384">LSB</a></span><span class="op" id="5718548">,</span>&nbsp;<span class="builtintype" id="5718550">int</span><span class="op" id="5718553">(</span><span class="ident" id="5718554"><a href="/gostd/image/gif/reader.go.html#5718247">litWidth</a></span><span class="op" id="5718562">)</span><span class="op" id="5718563">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718568">defer</span>&nbsp;<span class="ident" id="5718574"><a href="/gostd/image/gif/reader.go.html#5718515">lzwr</a></span><span class="op" id="5718578">.</span><span class="ident" id="5718579"><a href="/gostd/io/io.go.html#1422583">Close</a></span><span class="op" id="5718584">(</span><span class="op" id="5718585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718590">if</span>&nbsp;<span class="ident" id="5718593">_</span><span class="op" id="5718594">,</span>&nbsp;<span class="ident" id="5718596"><a href="/gostd/image/gif/reader.go.html#5717695">err</a></span>&nbsp;<span class="op" id="5718600">=</span>&nbsp;<span class="ident" id="5718602"><a href="/gostd/image/gif/reader.go.html#5714578">io</a></span><span class="op" id="5718604">.</span><span class="ident" id="5718605"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="5718613">(</span><span class="ident" id="5718614"><a href="/gostd/image/gif/reader.go.html#5718515">lzwr</a></span><span class="op" id="5718618">,</span>&nbsp;<span class="ident" id="5718620"><a href="/gostd/image/gif/reader.go.html#5717692">m</a></span><span class="op" id="5718621">.</span><span class="ident" id="5718622"><a href="/gostd/image/image.go.html#5176589">Pix</a></span><span class="op" id="5718625">)</span><span class="op" id="5718626">;</span>&nbsp;<span class="ident" id="5718628"><a href="/gostd/image/gif/reader.go.html#5717695">err</a></span>&nbsp;<span class="op" id="5718632">!=</span>&nbsp;<span class="builtintype" id="5718635">nil</span>&nbsp;<span class="op" id="5718639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718645">if</span>&nbsp;<span class="ident" id="5718648"><a href="/gostd/image/gif/reader.go.html#5717695">err</a></span>&nbsp;<span class="op" id="5718652">!=</span>&nbsp;<span class="ident" id="5718655"><a href="/gostd/image/gif/reader.go.html#5714578">io</a></span><span class="op" id="5718657">.</span><span class="ident" id="5718658"><a href="/gostd/io/io.go.html#1420096">ErrUnexpectedEOF</a></span>&nbsp;<span class="op" id="5718675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718682">return</span>&nbsp;<span class="ident" id="5718689"><a href="/gostd/image/gif/reader.go.html#5717695">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5718697">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718703">return</span>&nbsp;<span class="ident" id="5718710"><a href="/gostd/image/gif/reader.go.html#5714593">errNotEnough</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5718726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5718731">//&nbsp;Both&nbsp;lzwr&nbsp;and&nbsp;br&nbsp;should&nbsp;be&nbsp;exhausted.&nbsp;Reading&nbsp;from&nbsp;them</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5718793">//&nbsp;should&nbsp;yield&nbsp;(0,&nbsp;io.EOF).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718825">if</span>&nbsp;<span class="ident" id="5718828">n</span><span class="op" id="5718829">,</span>&nbsp;<span class="ident" id="5718831">err</span>&nbsp;<span class="op" id="5718835">:=</span>&nbsp;<span class="ident" id="5718838"><a href="/gostd/image/gif/reader.go.html#5718515">lzwr</a></span><span class="op" id="5718842">.</span><span class="ident" id="5718843"><a href="/gostd/io/io.go.html#1421843">Read</a></span><span class="op" id="5718847">(</span><span class="ident" id="5718848"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5718849">.</span><span class="ident" id="5718850"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5718853">[</span><span class="op" id="5718854">:</span><span class="num" id="5718855">1</span><span class="op" id="5718856">]</span><span class="op" id="5718857">)</span><span class="op" id="5718858">;</span>&nbsp;<span class="ident" id="5718860"><a href="/gostd/image/gif/reader.go.html#5718828">n</a></span>&nbsp;<span class="op" id="5718862">!=</span>&nbsp;<span class="num" id="5718865">0</span>&nbsp;<span class="op" id="5718867">||</span>&nbsp;<span class="ident" id="5718870"><a href="/gostd/image/gif/reader.go.html#5718831">err</a></span>&nbsp;<span class="op" id="5718874">!=</span>&nbsp;<span class="ident" id="5718877"><a href="/gostd/image/gif/reader.go.html#5714578">io</a></span><span class="op" id="5718879">.</span><span class="ident" id="5718880"><a href="/gostd/io/io.go.html#1419950">EOF</a></span>&nbsp;<span class="op" id="5718884">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718890">if</span>&nbsp;<span class="ident" id="5718893"><a href="/gostd/image/gif/reader.go.html#5718831">err</a></span>&nbsp;<span class="op" id="5718897">!=</span>&nbsp;<span class="builtintype" id="5718900">nil</span>&nbsp;<span class="op" id="5718904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718911">return</span>&nbsp;<span class="ident" id="5718918"><a href="/gostd/image/gif/reader.go.html#5718831">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5718926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718932">return</span>&nbsp;<span class="ident" id="5718939"><a href="/gostd/image/gif/reader.go.html#5714650">errTooMuch</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5718953">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718958">if</span>&nbsp;<span class="ident" id="5718961">n</span><span class="op" id="5718962">,</span>&nbsp;<span class="ident" id="5718964">err</span>&nbsp;<span class="op" id="5718968">:=</span>&nbsp;<span class="ident" id="5718971"><a href="/gostd/image/gif/reader.go.html#5718485">br</a></span><span class="op" id="5718973">.</span><span class="ident" id="5718974"><a href="/gostd/image/gif/reader.go.html#5716534">Read</a></span><span class="op" id="5718978">(</span><span class="ident" id="5718979"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5718980">.</span><span class="ident" id="5718981"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5718984">[</span><span class="op" id="5718985">:</span><span class="num" id="5718986">1</span><span class="op" id="5718987">]</span><span class="op" id="5718988">)</span><span class="op" id="5718989">;</span>&nbsp;<span class="ident" id="5718991"><a href="/gostd/image/gif/reader.go.html#5718961">n</a></span>&nbsp;<span class="op" id="5718993">!=</span>&nbsp;<span class="num" id="5718996">0</span>&nbsp;<span class="op" id="5718998">||</span>&nbsp;<span class="ident" id="5719001"><a href="/gostd/image/gif/reader.go.html#5718964">err</a></span>&nbsp;<span class="op" id="5719005">!=</span>&nbsp;<span class="ident" id="5719008"><a href="/gostd/image/gif/reader.go.html#5714578">io</a></span><span class="op" id="5719010">.</span><span class="ident" id="5719011"><a href="/gostd/io/io.go.html#1419950">EOF</a></span>&nbsp;<span class="op" id="5719015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719021">if</span>&nbsp;<span class="ident" id="5719024"><a href="/gostd/image/gif/reader.go.html#5718964">err</a></span>&nbsp;<span class="op" id="5719028">!=</span>&nbsp;<span class="builtintype" id="5719031">nil</span>&nbsp;<span class="op" id="5719035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719042">return</span>&nbsp;<span class="ident" id="5719049"><a href="/gostd/image/gif/reader.go.html#5718964">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5719057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719063">return</span>&nbsp;<span class="ident" id="5719070"><a href="/gostd/image/gif/reader.go.html#5714650">errTooMuch</a></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5719084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5719090">//&nbsp;Check&nbsp;that&nbsp;the&nbsp;color&nbsp;indexes&nbsp;are&nbsp;inside&nbsp;the&nbsp;palette.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719149">if</span>&nbsp;<span class="builtinfunc" id="5719152">len</span><span class="op" id="5719155">(</span><span class="ident" id="5719156"><a href="/gostd/image/gif/reader.go.html#5717692">m</a></span><span class="op" id="5719157">.</span><span class="ident" id="5719158"><a href="/gostd/image/image.go.html#5176774">Palette</a></span><span class="op" id="5719165">)</span>&nbsp;<span class="op" id="5719167">&lt;</span>&nbsp;<span class="num" id="5719169">256</span>&nbsp;<span class="op" id="5719173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719179">for</span>&nbsp;<span class="ident" id="5719183">_</span><span class="op" id="5719184">,</span>&nbsp;<span class="ident" id="5719186">pixel</span>&nbsp;<span class="op" id="5719192">:=</span>&nbsp;<span class="keyword" id="5719195">range</span>&nbsp;<span class="ident" id="5719201"><a href="/gostd/image/gif/reader.go.html#5717692">m</a></span><span class="op" id="5719202">.</span><span class="ident" id="5719203"><a href="/gostd/image/image.go.html#5176589">Pix</a></span>&nbsp;<span class="op" id="5719207">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719214">if</span>&nbsp;<span class="builtintype" id="5719217">int</span><span class="op" id="5719220">(</span><span class="ident" id="5719221"><a href="/gostd/image/gif/reader.go.html#5719186">pixel</a></span><span class="op" id="5719226">)</span>&nbsp;<span class="op" id="5719228">&gt;=</span>&nbsp;<span class="builtinfunc" id="5719231">len</span><span class="op" id="5719234">(</span><span class="ident" id="5719235"><a href="/gostd/image/gif/reader.go.html#5717692">m</a></span><span class="op" id="5719236">.</span><span class="ident" id="5719237"><a href="/gostd/image/image.go.html#5176774">Palette</a></span><span class="op" id="5719244">)</span>&nbsp;<span class="op" id="5719246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719254">return</span>&nbsp;<span class="ident" id="5719261"><a href="/gostd/image/gif/reader.go.html#5714705">errBadPixel</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5719278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5719284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5719289">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5719295">//&nbsp;Undo&nbsp;the&nbsp;interlacing&nbsp;if&nbsp;necessary.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719336">if</span>&nbsp;<span class="ident" id="5719339"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5719340">.</span><span class="ident" id="5719341"><a href="/gostd/image/gif/reader.go.html#5715763">imageFields</a></span><span class="op" id="5719352">&amp;</span><span class="ident" id="5719353"><a href="/gostd/image/gif/reader.go.html#5715019">ifInterlace</a></span>&nbsp;<span class="op" id="5719365">!=</span>&nbsp;<span class="num" id="5719368">0</span>&nbsp;<span class="op" id="5719370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5719376"><a href="/gostd/image/gif/reader.go.html#5723996">uninterlace</a></span><span class="op" id="5719387">(</span><span class="ident" id="5719388"><a href="/gostd/image/gif/reader.go.html#5717692">m</a></span><span class="op" id="5719389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5719394">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5719400"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5719401">.</span><span class="ident" id="5719402"><a href="/gostd/image/gif/reader.go.html#5715965">image</a></span>&nbsp;<span class="op" id="5719408">=</span>&nbsp;<span class="builtinfunc" id="5719410">append</span><span class="op" id="5719416">(</span><span class="ident" id="5719417"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5719418">.</span><span class="ident" id="5719419"><a href="/gostd/image/gif/reader.go.html#5715965">image</a></span><span class="op" id="5719424">,</span>&nbsp;<span class="ident" id="5719426"><a href="/gostd/image/gif/reader.go.html#5717692">m</a></span><span class="op" id="5719427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5719432"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5719433">.</span><span class="ident" id="5719434"><a href="/gostd/image/gif/reader.go.html#5715952">delay</a></span>&nbsp;<span class="op" id="5719440">=</span>&nbsp;<span class="builtinfunc" id="5719442">append</span><span class="op" id="5719448">(</span><span class="ident" id="5719449"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5719450">.</span><span class="ident" id="5719451"><a href="/gostd/image/gif/reader.go.html#5715952">delay</a></span><span class="op" id="5719456">,</span>&nbsp;<span class="ident" id="5719458"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5719459">.</span><span class="ident" id="5719460"><a href="/gostd/image/gif/reader.go.html#5715676">delayTime</a></span><span class="op" id="5719469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5719474">//&nbsp;The&nbsp;GIF89a&nbsp;spec,&nbsp;Section&nbsp;23&nbsp;(Graphic&nbsp;Control&nbsp;Extension)&nbsp;says:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5719542">//&nbsp;&#34;The&nbsp;scope&nbsp;of&nbsp;this&nbsp;extension&nbsp;is&nbsp;the&nbsp;first&nbsp;graphic&nbsp;rendering&nbsp;block</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5719614">//&nbsp;to&nbsp;follow.&#34;&nbsp;We&nbsp;therefore&nbsp;reset&nbsp;the&nbsp;GCE&nbsp;fields&nbsp;to&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5719675"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5719676">.</span><span class="ident" id="5719677"><a href="/gostd/image/gif/reader.go.html#5715676">delayTime</a></span>&nbsp;<span class="op" id="5719687">=</span>&nbsp;<span class="num" id="5719689">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5719694"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5719695">.</span><span class="ident" id="5719696"><a href="/gostd/image/gif/reader.go.html#5715835">hasTransparentIndex</a></span>&nbsp;<span class="op" id="5719716">=</span>&nbsp;<span class="builtintype" id="5719718">false</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719727">case</span>&nbsp;<span class="ident" id="5719732"><a href="/gostd/image/gif/reader.go.html#5715214">sTrailer</a></span><span class="op" id="5719740">:</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719745">if</span>&nbsp;<span class="builtinfunc" id="5719748">len</span><span class="op" id="5719751">(</span><span class="ident" id="5719752"><a href="/gostd/image/gif/reader.go.html#5717073">d</a></span><span class="op" id="5719753">.</span><span class="ident" id="5719754"><a href="/gostd/image/gif/reader.go.html#5715965">image</a></span><span class="op" id="5719759">)</span>&nbsp;<span class="op" id="5719761">==</span>&nbsp;<span class="num" id="5719764">0</span>&nbsp;<span class="op" id="5719766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719772">return</span>&nbsp;<span class="ident" id="5719779"><a href="/gostd/image/gif/reader.go.html#5714578">io</a></span><span class="op" id="5719781">.</span><span class="ident" id="5719782"><a href="/gostd/io/io.go.html#1420096">ErrUnexpectedEOF</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5719802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719807">return</span>&nbsp;<span class="builtintype" id="5719814">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719821">default</span><span class="op" id="5719828">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719833">return</span>&nbsp;<span class="ident" id="5719840"><a href="/gostd/image/gif/reader.go.html#5714547">fmt</a></span><span class="op" id="5719843">.</span><span class="ident" id="5719844"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="5719850">(</span><span class="string" id="5719851">&#34;gif:&nbsp;unknown&nbsp;block&nbsp;type:&nbsp;0x%.2x&#34;</span><span class="op" id="5719884">,</span>&nbsp;<span class="ident" id="5719886"><a href="/gostd/image/gif/reader.go.html#5717506">c</a></span><span class="op" id="5719887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5719891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5719894">}</span><br>
<span class="lineno"></span><span class="op" id="5719896">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span><span class="keyword" id="5719899">func</span>&nbsp;<span class="op" id="5719904">(</span><span class="ident" id="5719905">d</span>&nbsp;<span class="op" id="5719907">*</span><span class="ident" id="5719908"><a href="/gostd/image/gif/reader.go.html#5715477">decoder</a></span><span class="op" id="5719915">)</span>&nbsp;<span class="ident" id="5719917">readHeaderAndScreenDescriptor</span><span class="op" id="5719946">(</span><span class="op" id="5719947">)</span>&nbsp;<span class="builtintype" id="5719949">error</span>&nbsp;<span class="op" id="5719955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5719958">_</span><span class="op" id="5719959">,</span>&nbsp;<span class="ident" id="5719961">err</span>&nbsp;<span class="op" id="5719965">:=</span>&nbsp;<span class="ident" id="5719968"><a href="/gostd/image/gif/reader.go.html#5714578">io</a></span><span class="op" id="5719970">.</span><span class="ident" id="5719971"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="5719979">(</span><span class="ident" id="5719980"><a href="/gostd/image/gif/reader.go.html#5719905">d</a></span><span class="op" id="5719981">.</span><span class="ident" id="5719982"><a href="/gostd/image/gif/reader.go.html#5715495">r</a></span><span class="op" id="5719983">,</span>&nbsp;<span class="ident" id="5719985"><a href="/gostd/image/gif/reader.go.html#5719905">d</a></span><span class="op" id="5719986">.</span><span class="ident" id="5719987"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5719990">[</span><span class="num" id="5719991">0</span><span class="op" id="5719992">:</span><span class="num" id="5719993">13</span><span class="op" id="5719995">]</span><span class="op" id="5719996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719999">if</span>&nbsp;<span class="ident" id="5720002"><a href="/gostd/image/gif/reader.go.html#5719961">err</a></span>&nbsp;<span class="op" id="5720006">!=</span>&nbsp;<span class="builtintype" id="5720009">nil</span>&nbsp;<span class="op" id="5720013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5720017">return</span>&nbsp;<span class="ident" id="5720024"><a href="/gostd/image/gif/reader.go.html#5719961">err</a></span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5720029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720032"><a href="/gostd/image/gif/reader.go.html#5719905">d</a></span><span class="op" id="5720033">.</span><span class="ident" id="5720034"><a href="/gostd/image/gif/reader.go.html#5715523">vers</a></span>&nbsp;<span class="op" id="5720039">=</span>&nbsp;<span class="builtintype" id="5720041">string</span><span class="op" id="5720047">(</span><span class="ident" id="5720048"><a href="/gostd/image/gif/reader.go.html#5719905">d</a></span><span class="op" id="5720049">.</span><span class="ident" id="5720050"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5720053">[</span><span class="num" id="5720054">0</span><span class="op" id="5720055">:</span><span class="num" id="5720056">6</span><span class="op" id="5720057">]</span><span class="op" id="5720058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5720061">if</span>&nbsp;<span class="ident" id="5720064"><a href="/gostd/image/gif/reader.go.html#5719905">d</a></span><span class="op" id="5720065">.</span><span class="ident" id="5720066"><a href="/gostd/image/gif/reader.go.html#5715523">vers</a></span>&nbsp;<span class="op" id="5720071">!=</span>&nbsp;<span class="string" id="5720074">&#34;GIF87a&#34;</span>&nbsp;<span class="op" id="5720083">&amp;&amp;</span>&nbsp;<span class="ident" id="5720086"><a href="/gostd/image/gif/reader.go.html#5719905">d</a></span><span class="op" id="5720087">.</span><span class="ident" id="5720088"><a href="/gostd/image/gif/reader.go.html#5715523">vers</a></span>&nbsp;<span class="op" id="5720093">!=</span>&nbsp;<span class="string" id="5720096">&#34;GIF89a&#34;</span>&nbsp;<span class="op" id="5720105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5720109">return</span>&nbsp;<span class="ident" id="5720116"><a href="/gostd/image/gif/reader.go.html#5714547">fmt</a></span><span class="op" id="5720119">.</span><span class="ident" id="5720120"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="5720126">(</span><span class="string" id="5720127">&#34;gif:&nbsp;can&#39;t&nbsp;recognize&nbsp;format&nbsp;%s&#34;</span><span class="op" id="5720159">,</span>&nbsp;<span class="ident" id="5720161"><a href="/gostd/image/gif/reader.go.html#5719905">d</a></span><span class="op" id="5720162">.</span><span class="ident" id="5720163"><a href="/gostd/image/gif/reader.go.html#5715523">vers</a></span><span class="op" id="5720167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5720170">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720173"><a href="/gostd/image/gif/reader.go.html#5719905">d</a></span><span class="op" id="5720174">.</span><span class="ident" id="5720175"><a href="/gostd/image/gif/reader.go.html#5715547">width</a></span>&nbsp;<span class="op" id="5720181">=</span>&nbsp;<span class="builtintype" id="5720183">int</span><span class="op" id="5720186">(</span><span class="ident" id="5720187"><a href="/gostd/image/gif/reader.go.html#5719905">d</a></span><span class="op" id="5720188">.</span><span class="ident" id="5720189"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5720192">[</span><span class="num" id="5720193">6</span><span class="op" id="5720194">]</span><span class="op" id="5720195">)</span>&nbsp;<span class="op" id="5720197">+</span>&nbsp;<span class="builtintype" id="5720199">int</span><span class="op" id="5720202">(</span><span class="ident" id="5720203"><a href="/gostd/image/gif/reader.go.html#5719905">d</a></span><span class="op" id="5720204">.</span><span class="ident" id="5720205"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5720208">[</span><span class="num" id="5720209">7</span><span class="op" id="5720210">]</span><span class="op" id="5720211">)</span><span class="op" id="5720212">&lt;&lt;</span><span class="num" id="5720214">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720217"><a href="/gostd/image/gif/reader.go.html#5719905">d</a></span><span class="op" id="5720218">.</span><span class="ident" id="5720219"><a href="/gostd/image/gif/reader.go.html#5715568">height</a></span>&nbsp;<span class="op" id="5720226">=</span>&nbsp;<span class="builtintype" id="5720228">int</span><span class="op" id="5720231">(</span><span class="ident" id="5720232"><a href="/gostd/image/gif/reader.go.html#5719905">d</a></span><span class="op" id="5720233">.</span><span class="ident" id="5720234"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5720237">[</span><span class="num" id="5720238">8</span><span class="op" id="5720239">]</span><span class="op" id="5720240">)</span>&nbsp;<span class="op" id="5720242">+</span>&nbsp;<span class="builtintype" id="5720244">int</span><span class="op" id="5720247">(</span><span class="ident" id="5720248"><a href="/gostd/image/gif/reader.go.html#5719905">d</a></span><span class="op" id="5720249">.</span><span class="ident" id="5720250"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5720253">[</span><span class="num" id="5720254">9</span><span class="op" id="5720255">]</span><span class="op" id="5720256">)</span><span class="op" id="5720257">&lt;&lt;</span><span class="num" id="5720259">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720262"><a href="/gostd/image/gif/reader.go.html#5719905">d</a></span><span class="op" id="5720263">.</span><span class="ident" id="5720264"><a href="/gostd/image/gif/reader.go.html#5715611">headerFields</a></span>&nbsp;<span class="op" id="5720277">=</span>&nbsp;<span class="ident" id="5720279"><a href="/gostd/image/gif/reader.go.html#5719905">d</a></span><span class="op" id="5720280">.</span><span class="ident" id="5720281"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5720284">[</span><span class="num" id="5720285">10</span><span class="op" id="5720287">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720290"><a href="/gostd/image/gif/reader.go.html#5719905">d</a></span><span class="op" id="5720291">.</span><span class="ident" id="5720292"><a href="/gostd/image/gif/reader.go.html#5715633">backgroundIndex</a></span>&nbsp;<span class="op" id="5720308">=</span>&nbsp;<span class="ident" id="5720310"><a href="/gostd/image/gif/reader.go.html#5719905">d</a></span><span class="op" id="5720311">.</span><span class="ident" id="5720312"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5720315">[</span><span class="num" id="5720316">11</span><span class="op" id="5720318">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720321"><a href="/gostd/image/gif/reader.go.html#5719905">d</a></span><span class="op" id="5720322">.</span><span class="ident" id="5720323"><a href="/gostd/image/gif/reader.go.html#5715722">aspect</a></span>&nbsp;<span class="op" id="5720330">=</span>&nbsp;<span class="ident" id="5720332"><a href="/gostd/image/gif/reader.go.html#5719905">d</a></span><span class="op" id="5720333">.</span><span class="ident" id="5720334"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5720337">[</span><span class="num" id="5720338">12</span><span class="op" id="5720340">]</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720343"><a href="/gostd/image/gif/reader.go.html#5719905">d</a></span><span class="op" id="5720344">.</span><span class="ident" id="5720345"><a href="/gostd/image/gif/reader.go.html#5715655">loopCount</a></span>&nbsp;<span class="op" id="5720355">=</span>&nbsp;<span class="op" id="5720357">-</span><span class="num" id="5720358">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720361"><a href="/gostd/image/gif/reader.go.html#5719905">d</a></span><span class="op" id="5720362">.</span><span class="ident" id="5720363"><a href="/gostd/image/gif/reader.go.html#5715876">pixelSize</a></span>&nbsp;<span class="op" id="5720373">=</span>&nbsp;<span class="builtintype" id="5720375">uint</span><span class="op" id="5720379">(</span><span class="ident" id="5720380"><a href="/gostd/image/gif/reader.go.html#5719905">d</a></span><span class="op" id="5720381">.</span><span class="ident" id="5720382"><a href="/gostd/image/gif/reader.go.html#5715611">headerFields</a></span><span class="op" id="5720394">&amp;</span><span class="num" id="5720395">7</span><span class="op" id="5720396">)</span>&nbsp;<span class="op" id="5720398">+</span>&nbsp;<span class="num" id="5720400">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5720403">return</span>&nbsp;<span class="builtintype" id="5720410">nil</span><br>
<span class="lineno"></span><span class="op" id="5720414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="keyword" id="5720417">func</span>&nbsp;<span class="op" id="5720422">(</span><span class="ident" id="5720423">d</span>&nbsp;<span class="op" id="5720425">*</span><span class="ident" id="5720426"><a href="/gostd/image/gif/reader.go.html#5715477">decoder</a></span><span class="op" id="5720433">)</span>&nbsp;<span class="ident" id="5720435">readColorMap</span><span class="op" id="5720447">(</span><span class="op" id="5720448">)</span>&nbsp;<span class="op" id="5720450">(</span><span class="ident" id="5720451"><a href="/gostd/image/gif/reader.go.html#5714563">color</a></span><span class="op" id="5720456">.</span><span class="ident" id="5720457"><a href="/gostd/image/color/color.go.html#5190467">Palette</a></span><span class="op" id="5720464">,</span>&nbsp;<span class="builtintype" id="5720466">error</span><span class="op" id="5720471">)</span>&nbsp;<span class="op" id="5720473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5720476">if</span>&nbsp;<span class="ident" id="5720479"><a href="/gostd/image/gif/reader.go.html#5720423">d</a></span><span class="op" id="5720480">.</span><span class="ident" id="5720481"><a href="/gostd/image/gif/reader.go.html#5715876">pixelSize</a></span>&nbsp;<span class="op" id="5720491">&gt;</span>&nbsp;<span class="num" id="5720493">8</span>&nbsp;<span class="op" id="5720495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5720499">return</span>&nbsp;<span class="builtintype" id="5720506">nil</span><span class="op" id="5720509">,</span>&nbsp;<span class="ident" id="5720511"><a href="/gostd/image/gif/reader.go.html#5714547">fmt</a></span><span class="op" id="5720514">.</span><span class="ident" id="5720515"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="5720521">(</span><span class="string" id="5720522">&#34;gif:&nbsp;can&#39;t&nbsp;handle&nbsp;%d&nbsp;bits&nbsp;per&nbsp;pixel&#34;</span><span class="op" id="5720559">,</span>&nbsp;<span class="ident" id="5720561"><a href="/gostd/image/gif/reader.go.html#5720423">d</a></span><span class="op" id="5720562">.</span><span class="ident" id="5720563"><a href="/gostd/image/gif/reader.go.html#5715876">pixelSize</a></span><span class="op" id="5720572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5720575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720578">numColors</span>&nbsp;<span class="op" id="5720588">:=</span>&nbsp;<span class="num" id="5720591">1</span>&nbsp;<span class="op" id="5720593">&lt;&lt;</span>&nbsp;<span class="ident" id="5720596"><a href="/gostd/image/gif/reader.go.html#5720423">d</a></span><span class="op" id="5720597">.</span><span class="ident" id="5720598"><a href="/gostd/image/gif/reader.go.html#5715876">pixelSize</a></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5720609">if</span>&nbsp;<span class="ident" id="5720612"><a href="/gostd/image/gif/reader.go.html#5720423">d</a></span><span class="op" id="5720613">.</span><span class="ident" id="5720614"><a href="/gostd/image/gif/reader.go.html#5715763">imageFields</a></span><span class="op" id="5720625">&amp;</span><span class="ident" id="5720626"><a href="/gostd/image/gif/reader.go.html#5714991">ifLocalColorTable</a></span>&nbsp;<span class="op" id="5720644">!=</span>&nbsp;<span class="num" id="5720647">0</span>&nbsp;<span class="op" id="5720649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720653"><a href="/gostd/image/gif/reader.go.html#5720578">numColors</a></span>&nbsp;<span class="op" id="5720663">=</span>&nbsp;<span class="num" id="5720665">1</span>&nbsp;<span class="op" id="5720667">&lt;&lt;</span>&nbsp;<span class="op" id="5720670">(</span><span class="op" id="5720671">(</span><span class="ident" id="5720672"><a href="/gostd/image/gif/reader.go.html#5720423">d</a></span><span class="op" id="5720673">.</span><span class="ident" id="5720674"><a href="/gostd/image/gif/reader.go.html#5715763">imageFields</a></span>&nbsp;<span class="op" id="5720686">&amp;</span>&nbsp;<span class="ident" id="5720688"><a href="/gostd/image/gif/reader.go.html#5715047">ifPixelSizeMask</a></span><span class="op" id="5720703">)</span>&nbsp;<span class="op" id="5720705">+</span>&nbsp;<span class="num" id="5720707">1</span><span class="op" id="5720708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5720711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720714">numValues</span>&nbsp;<span class="op" id="5720724">:=</span>&nbsp;<span class="num" id="5720727">3</span>&nbsp;<span class="op" id="5720729">*</span>&nbsp;<span class="ident" id="5720731"><a href="/gostd/image/gif/reader.go.html#5720578">numColors</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720742">_</span><span class="op" id="5720743">,</span>&nbsp;<span class="ident" id="5720745">err</span>&nbsp;<span class="op" id="5720749">:=</span>&nbsp;<span class="ident" id="5720752"><a href="/gostd/image/gif/reader.go.html#5714578">io</a></span><span class="op" id="5720754">.</span><span class="ident" id="5720755"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="5720763">(</span><span class="ident" id="5720764"><a href="/gostd/image/gif/reader.go.html#5720423">d</a></span><span class="op" id="5720765">.</span><span class="ident" id="5720766"><a href="/gostd/image/gif/reader.go.html#5715495">r</a></span><span class="op" id="5720767">,</span>&nbsp;<span class="ident" id="5720769"><a href="/gostd/image/gif/reader.go.html#5720423">d</a></span><span class="op" id="5720770">.</span><span class="ident" id="5720771"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5720774">[</span><span class="num" id="5720775">0</span><span class="op" id="5720776">:</span><span class="ident" id="5720777"><a href="/gostd/image/gif/reader.go.html#5720714">numValues</a></span><span class="op" id="5720786">]</span><span class="op" id="5720787">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5720790">if</span>&nbsp;<span class="ident" id="5720793"><a href="/gostd/image/gif/reader.go.html#5720745">err</a></span>&nbsp;<span class="op" id="5720797">!=</span>&nbsp;<span class="builtintype" id="5720800">nil</span>&nbsp;<span class="op" id="5720804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5720808">return</span>&nbsp;<span class="builtintype" id="5720815">nil</span><span class="op" id="5720818">,</span>&nbsp;<span class="ident" id="5720820"><a href="/gostd/image/gif/reader.go.html#5714547">fmt</a></span><span class="op" id="5720823">.</span><span class="ident" id="5720824"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="5720830">(</span><span class="string" id="5720831">&#34;gif:&nbsp;short&nbsp;read&nbsp;on&nbsp;color&nbsp;map:&nbsp;%s&#34;</span><span class="op" id="5720865">,</span>&nbsp;<span class="ident" id="5720867"><a href="/gostd/image/gif/reader.go.html#5720745">err</a></span><span class="op" id="5720870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5720873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720876">colorMap</span>&nbsp;<span class="op" id="5720885">:=</span>&nbsp;<span class="builtinfunc" id="5720888">make</span><span class="op" id="5720892">(</span><span class="ident" id="5720893"><a href="/gostd/image/gif/reader.go.html#5714563">color</a></span><span class="op" id="5720898">.</span><span class="ident" id="5720899"><a href="/gostd/image/color/color.go.html#5190467">Palette</a></span><span class="op" id="5720906">,</span>&nbsp;<span class="ident" id="5720908"><a href="/gostd/image/gif/reader.go.html#5720578">numColors</a></span><span class="op" id="5720917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720920">j</span>&nbsp;<span class="op" id="5720922">:=</span>&nbsp;<span class="num" id="5720925">0</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5720928">for</span>&nbsp;<span class="ident" id="5720932">i</span>&nbsp;<span class="op" id="5720934">:=</span>&nbsp;<span class="keyword" id="5720937">range</span>&nbsp;<span class="ident" id="5720943"><a href="/gostd/image/gif/reader.go.html#5720876">colorMap</a></span>&nbsp;<span class="op" id="5720952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720956"><a href="/gostd/image/gif/reader.go.html#5720876">colorMap</a></span><span class="op" id="5720964">[</span><span class="ident" id="5720965"><a href="/gostd/image/gif/reader.go.html#5720932">i</a></span><span class="op" id="5720966">]</span>&nbsp;<span class="op" id="5720968">=</span>&nbsp;<span class="ident" id="5720970"><a href="/gostd/image/gif/reader.go.html#5714563">color</a></span><span class="op" id="5720975">.</span><span class="ident" id="5720976"><a href="/gostd/image/color/color.go.html#5185612">RGBA</a></span><span class="op" id="5720980">{</span><span class="ident" id="5720981"><a href="/gostd/image/gif/reader.go.html#5720423">d</a></span><span class="op" id="5720982">.</span><span class="ident" id="5720983"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5720986">[</span><span class="ident" id="5720987"><a href="/gostd/image/gif/reader.go.html#5720920">j</a></span><span class="op" id="5720988">+</span><span class="num" id="5720989">0</span><span class="op" id="5720990">]</span><span class="op" id="5720991">,</span>&nbsp;<span class="ident" id="5720993"><a href="/gostd/image/gif/reader.go.html#5720423">d</a></span><span class="op" id="5720994">.</span><span class="ident" id="5720995"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5720998">[</span><span class="ident" id="5720999"><a href="/gostd/image/gif/reader.go.html#5720920">j</a></span><span class="op" id="5721000">+</span><span class="num" id="5721001">1</span><span class="op" id="5721002">]</span><span class="op" id="5721003">,</span>&nbsp;<span class="ident" id="5721005"><a href="/gostd/image/gif/reader.go.html#5720423">d</a></span><span class="op" id="5721006">.</span><span class="ident" id="5721007"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5721010">[</span><span class="ident" id="5721011"><a href="/gostd/image/gif/reader.go.html#5720920">j</a></span><span class="op" id="5721012">+</span><span class="num" id="5721013">2</span><span class="op" id="5721014">]</span><span class="op" id="5721015">,</span>&nbsp;<span class="num" id="5721017">0xFF</span><span class="op" id="5721021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5721025"><a href="/gostd/image/gif/reader.go.html#5720920">j</a></span>&nbsp;<span class="op" id="5721027">+=</span>&nbsp;<span class="num" id="5721030">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5721033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721036">return</span>&nbsp;<span class="ident" id="5721043"><a href="/gostd/image/gif/reader.go.html#5720876">colorMap</a></span><span class="op" id="5721051">,</span>&nbsp;<span class="builtintype" id="5721053">nil</span><br>
<span class="lineno">295</span><span class="op" id="5721057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5721060">func</span>&nbsp;<span class="op" id="5721065">(</span><span class="ident" id="5721066">d</span>&nbsp;<span class="op" id="5721068">*</span><span class="ident" id="5721069"><a href="/gostd/image/gif/reader.go.html#5715477">decoder</a></span><span class="op" id="5721076">)</span>&nbsp;<span class="ident" id="5721078">readExtension</span><span class="op" id="5721091">(</span><span class="op" id="5721092">)</span>&nbsp;<span class="builtintype" id="5721094">error</span>&nbsp;<span class="op" id="5721100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5721103">extension</span><span class="op" id="5721112">,</span>&nbsp;<span class="ident" id="5721114">err</span>&nbsp;<span class="op" id="5721118">:=</span>&nbsp;<span class="ident" id="5721121"><a href="/gostd/image/gif/reader.go.html#5721066">d</a></span><span class="op" id="5721122">.</span><span class="ident" id="5721123"><a href="/gostd/image/gif/reader.go.html#5715495">r</a></span><span class="op" id="5721124">.</span><span class="ident" id="5721125"><a href="/gostd/io/io.go.html#1426989">ReadByte</a></span><span class="op" id="5721133">(</span><span class="op" id="5721134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721137">if</span>&nbsp;<span class="ident" id="5721140"><a href="/gostd/image/gif/reader.go.html#5721114">err</a></span>&nbsp;<span class="op" id="5721144">!=</span>&nbsp;<span class="builtintype" id="5721147">nil</span>&nbsp;<span class="op" id="5721151">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721155">return</span>&nbsp;<span class="ident" id="5721162"><a href="/gostd/image/gif/reader.go.html#5721114">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5721167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5721170">size</span>&nbsp;<span class="op" id="5721175">:=</span>&nbsp;<span class="num" id="5721178">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721181">switch</span>&nbsp;<span class="ident" id="5721188"><a href="/gostd/image/gif/reader.go.html#5721103">extension</a></span>&nbsp;<span class="op" id="5721198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721201">case</span>&nbsp;<span class="ident" id="5721206"><a href="/gostd/image/gif/reader.go.html#5715265">eText</a></span><span class="op" id="5721211">:</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5721215"><a href="/gostd/image/gif/reader.go.html#5721170">size</a></span>&nbsp;<span class="op" id="5721220">=</span>&nbsp;<span class="num" id="5721222">13</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721226">case</span>&nbsp;<span class="ident" id="5721231"><a href="/gostd/image/gif/reader.go.html#5715303">eGraphicControl</a></span><span class="op" id="5721246">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721250">return</span>&nbsp;<span class="ident" id="5721257"><a href="/gostd/image/gif/reader.go.html#5721066">d</a></span><span class="op" id="5721258">.</span><span class="ident" id="5721259"><a href="/gostd/image/gif/reader.go.html#5722124">readGraphicControl</a></span><span class="op" id="5721277">(</span><span class="op" id="5721278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721281">case</span>&nbsp;<span class="ident" id="5721286"><a href="/gostd/image/gif/reader.go.html#5715346">eComment</a></span><span class="op" id="5721294">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5721298">//&nbsp;nothing&nbsp;to&nbsp;do&nbsp;but&nbsp;read&nbsp;the&nbsp;data.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721335">case</span>&nbsp;<span class="ident" id="5721340"><a href="/gostd/image/gif/reader.go.html#5715381">eApplication</a></span><span class="op" id="5721352">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5721356">b</span><span class="op" id="5721357">,</span>&nbsp;<span class="ident" id="5721359">err</span>&nbsp;<span class="op" id="5721363">:=</span>&nbsp;<span class="ident" id="5721366"><a href="/gostd/image/gif/reader.go.html#5721066">d</a></span><span class="op" id="5721367">.</span><span class="ident" id="5721368"><a href="/gostd/image/gif/reader.go.html#5715495">r</a></span><span class="op" id="5721369">.</span><span class="ident" id="5721370"><a href="/gostd/io/io.go.html#1426989">ReadByte</a></span><span class="op" id="5721378">(</span><span class="op" id="5721379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721383">if</span>&nbsp;<span class="ident" id="5721386"><a href="/gostd/image/gif/reader.go.html#5721359">err</a></span>&nbsp;<span class="op" id="5721390">!=</span>&nbsp;<span class="builtintype" id="5721393">nil</span>&nbsp;<span class="op" id="5721397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721402">return</span>&nbsp;<span class="ident" id="5721409"><a href="/gostd/image/gif/reader.go.html#5721359">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5721415">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5721419">//&nbsp;The&nbsp;spec&nbsp;requires&nbsp;size&nbsp;be&nbsp;11,&nbsp;but&nbsp;Adobe&nbsp;sometimes&nbsp;uses&nbsp;10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5721483"><a href="/gostd/image/gif/reader.go.html#5721170">size</a></span>&nbsp;<span class="op" id="5721488">=</span>&nbsp;<span class="builtintype" id="5721490">int</span><span class="op" id="5721493">(</span><span class="ident" id="5721494"><a href="/gostd/image/gif/reader.go.html#5721356">b</a></span><span class="op" id="5721495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721498">default</span><span class="op" id="5721505">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721509">return</span>&nbsp;<span class="ident" id="5721516"><a href="/gostd/image/gif/reader.go.html#5714547">fmt</a></span><span class="op" id="5721519">.</span><span class="ident" id="5721520"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="5721526">(</span><span class="string" id="5721527">&#34;gif:&nbsp;unknown&nbsp;extension&nbsp;0x%.2x&#34;</span><span class="op" id="5721558">,</span>&nbsp;<span class="ident" id="5721560"><a href="/gostd/image/gif/reader.go.html#5721103">extension</a></span><span class="op" id="5721569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5721572">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721575">if</span>&nbsp;<span class="ident" id="5721578"><a href="/gostd/image/gif/reader.go.html#5721170">size</a></span>&nbsp;<span class="op" id="5721583">&gt;</span>&nbsp;<span class="num" id="5721585">0</span>&nbsp;<span class="op" id="5721587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721591">if</span>&nbsp;<span class="ident" id="5721594">_</span><span class="op" id="5721595">,</span>&nbsp;<span class="ident" id="5721597">err</span>&nbsp;<span class="op" id="5721601">:=</span>&nbsp;<span class="ident" id="5721604"><a href="/gostd/image/gif/reader.go.html#5714578">io</a></span><span class="op" id="5721606">.</span><span class="ident" id="5721607"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="5721615">(</span><span class="ident" id="5721616"><a href="/gostd/image/gif/reader.go.html#5721066">d</a></span><span class="op" id="5721617">.</span><span class="ident" id="5721618"><a href="/gostd/image/gif/reader.go.html#5715495">r</a></span><span class="op" id="5721619">,</span>&nbsp;<span class="ident" id="5721621"><a href="/gostd/image/gif/reader.go.html#5721066">d</a></span><span class="op" id="5721622">.</span><span class="ident" id="5721623"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5721626">[</span><span class="num" id="5721627">0</span><span class="op" id="5721628">:</span><span class="ident" id="5721629"><a href="/gostd/image/gif/reader.go.html#5721170">size</a></span><span class="op" id="5721633">]</span><span class="op" id="5721634">)</span><span class="op" id="5721635">;</span>&nbsp;<span class="ident" id="5721637"><a href="/gostd/image/gif/reader.go.html#5721597">err</a></span>&nbsp;<span class="op" id="5721641">!=</span>&nbsp;<span class="builtintype" id="5721644">nil</span>&nbsp;<span class="op" id="5721648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721653">return</span>&nbsp;<span class="ident" id="5721660"><a href="/gostd/image/gif/reader.go.html#5721597">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5721666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5721669">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5721673">//&nbsp;Application&nbsp;Extension&nbsp;with&nbsp;&#34;NETSCAPE2.0&#34;&nbsp;as&nbsp;string&nbsp;and&nbsp;1&nbsp;in&nbsp;data&nbsp;means</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5721748">//&nbsp;this&nbsp;extension&nbsp;defines&nbsp;a&nbsp;loop&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721789">if</span>&nbsp;<span class="ident" id="5721792"><a href="/gostd/image/gif/reader.go.html#5721103">extension</a></span>&nbsp;<span class="op" id="5721802">==</span>&nbsp;<span class="ident" id="5721805"><a href="/gostd/image/gif/reader.go.html#5715381">eApplication</a></span>&nbsp;<span class="op" id="5721818">&amp;&amp;</span>&nbsp;<span class="builtintype" id="5721821">string</span><span class="op" id="5721827">(</span><span class="ident" id="5721828"><a href="/gostd/image/gif/reader.go.html#5721066">d</a></span><span class="op" id="5721829">.</span><span class="ident" id="5721830"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5721833">[</span><span class="op" id="5721834">:</span><span class="ident" id="5721835"><a href="/gostd/image/gif/reader.go.html#5721170">size</a></span><span class="op" id="5721839">]</span><span class="op" id="5721840">)</span>&nbsp;<span class="op" id="5721842">==</span>&nbsp;<span class="string" id="5721845">&#34;NETSCAPE2.0&#34;</span>&nbsp;<span class="op" id="5721859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5721863">n</span><span class="op" id="5721864">,</span>&nbsp;<span class="ident" id="5721866">err</span>&nbsp;<span class="op" id="5721870">:=</span>&nbsp;<span class="ident" id="5721873"><a href="/gostd/image/gif/reader.go.html#5721066">d</a></span><span class="op" id="5721874">.</span><span class="ident" id="5721875"><a href="/gostd/image/gif/reader.go.html#5723307">readBlock</a></span><span class="op" id="5721884">(</span><span class="op" id="5721885">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721889">if</span>&nbsp;<span class="ident" id="5721892"><a href="/gostd/image/gif/reader.go.html#5721863">n</a></span>&nbsp;<span class="op" id="5721894">==</span>&nbsp;<span class="num" id="5721897">0</span>&nbsp;<span class="op" id="5721899">||</span>&nbsp;<span class="ident" id="5721902"><a href="/gostd/image/gif/reader.go.html#5721866">err</a></span>&nbsp;<span class="op" id="5721906">!=</span>&nbsp;<span class="builtintype" id="5721909">nil</span>&nbsp;<span class="op" id="5721913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721918">return</span>&nbsp;<span class="ident" id="5721925"><a href="/gostd/image/gif/reader.go.html#5721866">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5721931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721935">if</span>&nbsp;<span class="ident" id="5721938"><a href="/gostd/image/gif/reader.go.html#5721863">n</a></span>&nbsp;<span class="op" id="5721940">==</span>&nbsp;<span class="num" id="5721943">3</span>&nbsp;<span class="op" id="5721945">&amp;&amp;</span>&nbsp;<span class="ident" id="5721948"><a href="/gostd/image/gif/reader.go.html#5721066">d</a></span><span class="op" id="5721949">.</span><span class="ident" id="5721950"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5721953">[</span><span class="num" id="5721954">0</span><span class="op" id="5721955">]</span>&nbsp;<span class="op" id="5721957">==</span>&nbsp;<span class="num" id="5721960">1</span>&nbsp;<span class="op" id="5721962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5721967"><a href="/gostd/image/gif/reader.go.html#5721066">d</a></span><span class="op" id="5721968">.</span><span class="ident" id="5721969"><a href="/gostd/image/gif/reader.go.html#5715655">loopCount</a></span>&nbsp;<span class="op" id="5721979">=</span>&nbsp;<span class="builtintype" id="5721981">int</span><span class="op" id="5721984">(</span><span class="ident" id="5721985"><a href="/gostd/image/gif/reader.go.html#5721066">d</a></span><span class="op" id="5721986">.</span><span class="ident" id="5721987"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5721990">[</span><span class="num" id="5721991">1</span><span class="op" id="5721992">]</span><span class="op" id="5721993">)</span>&nbsp;<span class="op" id="5721995">|</span>&nbsp;<span class="builtintype" id="5721997">int</span><span class="op" id="5722000">(</span><span class="ident" id="5722001"><a href="/gostd/image/gif/reader.go.html#5721066">d</a></span><span class="op" id="5722002">.</span><span class="ident" id="5722003"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5722006">[</span><span class="num" id="5722007">2</span><span class="op" id="5722008">]</span><span class="op" id="5722009">)</span><span class="op" id="5722010">&lt;&lt;</span><span class="num" id="5722012">8</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5722016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5722019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5722022">for</span>&nbsp;<span class="op" id="5722026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5722030">n</span><span class="op" id="5722031">,</span>&nbsp;<span class="ident" id="5722033">err</span>&nbsp;<span class="op" id="5722037">:=</span>&nbsp;<span class="ident" id="5722040"><a href="/gostd/image/gif/reader.go.html#5721066">d</a></span><span class="op" id="5722041">.</span><span class="ident" id="5722042"><a href="/gostd/image/gif/reader.go.html#5723307">readBlock</a></span><span class="op" id="5722051">(</span><span class="op" id="5722052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5722056">if</span>&nbsp;<span class="ident" id="5722059"><a href="/gostd/image/gif/reader.go.html#5722030">n</a></span>&nbsp;<span class="op" id="5722061">==</span>&nbsp;<span class="num" id="5722064">0</span>&nbsp;<span class="op" id="5722066">||</span>&nbsp;<span class="ident" id="5722069"><a href="/gostd/image/gif/reader.go.html#5722033">err</a></span>&nbsp;<span class="op" id="5722073">!=</span>&nbsp;<span class="builtintype" id="5722076">nil</span>&nbsp;<span class="op" id="5722080">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5722085">return</span>&nbsp;<span class="ident" id="5722092"><a href="/gostd/image/gif/reader.go.html#5722033">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5722098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5722101">}</span><br>
<span class="lineno"></span><span class="op" id="5722103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="keyword" id="5722106">func</span>&nbsp;<span class="op" id="5722111">(</span><span class="ident" id="5722112">d</span>&nbsp;<span class="op" id="5722114">*</span><span class="ident" id="5722115"><a href="/gostd/image/gif/reader.go.html#5715477">decoder</a></span><span class="op" id="5722122">)</span>&nbsp;<span class="ident" id="5722124">readGraphicControl</span><span class="op" id="5722142">(</span><span class="op" id="5722143">)</span>&nbsp;<span class="builtintype" id="5722145">error</span>&nbsp;<span class="op" id="5722151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5722154">if</span>&nbsp;<span class="ident" id="5722157">_</span><span class="op" id="5722158">,</span>&nbsp;<span class="ident" id="5722160">err</span>&nbsp;<span class="op" id="5722164">:=</span>&nbsp;<span class="ident" id="5722167"><a href="/gostd/image/gif/reader.go.html#5714578">io</a></span><span class="op" id="5722169">.</span><span class="ident" id="5722170"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="5722178">(</span><span class="ident" id="5722179"><a href="/gostd/image/gif/reader.go.html#5722112">d</a></span><span class="op" id="5722180">.</span><span class="ident" id="5722181"><a href="/gostd/image/gif/reader.go.html#5715495">r</a></span><span class="op" id="5722182">,</span>&nbsp;<span class="ident" id="5722184"><a href="/gostd/image/gif/reader.go.html#5722112">d</a></span><span class="op" id="5722185">.</span><span class="ident" id="5722186"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5722189">[</span><span class="num" id="5722190">0</span><span class="op" id="5722191">:</span><span class="num" id="5722192">6</span><span class="op" id="5722193">]</span><span class="op" id="5722194">)</span><span class="op" id="5722195">;</span>&nbsp;<span class="ident" id="5722197"><a href="/gostd/image/gif/reader.go.html#5722160">err</a></span>&nbsp;<span class="op" id="5722201">!=</span>&nbsp;<span class="builtintype" id="5722204">nil</span>&nbsp;<span class="op" id="5722208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5722212">return</span>&nbsp;<span class="ident" id="5722219"><a href="/gostd/image/gif/reader.go.html#5714547">fmt</a></span><span class="op" id="5722222">.</span><span class="ident" id="5722223"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="5722229">(</span><span class="string" id="5722230">&#34;gif:&nbsp;can&#39;t&nbsp;read&nbsp;graphic&nbsp;control:&nbsp;%s&#34;</span><span class="op" id="5722267">,</span>&nbsp;<span class="ident" id="5722269"><a href="/gostd/image/gif/reader.go.html#5722160">err</a></span><span class="op" id="5722272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5722275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5722278"><a href="/gostd/image/gif/reader.go.html#5722112">d</a></span><span class="op" id="5722279">.</span><span class="ident" id="5722280"><a href="/gostd/image/gif/reader.go.html#5715589">flags</a></span>&nbsp;<span class="op" id="5722286">=</span>&nbsp;<span class="ident" id="5722288"><a href="/gostd/image/gif/reader.go.html#5722112">d</a></span><span class="op" id="5722289">.</span><span class="ident" id="5722290"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5722293">[</span><span class="num" id="5722294">1</span><span class="op" id="5722295">]</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5722298"><a href="/gostd/image/gif/reader.go.html#5722112">d</a></span><span class="op" id="5722299">.</span><span class="ident" id="5722300"><a href="/gostd/image/gif/reader.go.html#5715676">delayTime</a></span>&nbsp;<span class="op" id="5722310">=</span>&nbsp;<span class="builtintype" id="5722312">int</span><span class="op" id="5722315">(</span><span class="ident" id="5722316"><a href="/gostd/image/gif/reader.go.html#5722112">d</a></span><span class="op" id="5722317">.</span><span class="ident" id="5722318"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5722321">[</span><span class="num" id="5722322">2</span><span class="op" id="5722323">]</span><span class="op" id="5722324">)</span>&nbsp;<span class="op" id="5722326">|</span>&nbsp;<span class="builtintype" id="5722328">int</span><span class="op" id="5722331">(</span><span class="ident" id="5722332"><a href="/gostd/image/gif/reader.go.html#5722112">d</a></span><span class="op" id="5722333">.</span><span class="ident" id="5722334"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5722337">[</span><span class="num" id="5722338">3</span><span class="op" id="5722339">]</span><span class="op" id="5722340">)</span><span class="op" id="5722341">&lt;&lt;</span><span class="num" id="5722343">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5722346">if</span>&nbsp;<span class="ident" id="5722349"><a href="/gostd/image/gif/reader.go.html#5722112">d</a></span><span class="op" id="5722350">.</span><span class="ident" id="5722351"><a href="/gostd/image/gif/reader.go.html#5715589">flags</a></span><span class="op" id="5722356">&amp;</span><span class="ident" id="5722357"><a href="/gostd/image/gif/reader.go.html#5715098">gcTransparentColorSet</a></span>&nbsp;<span class="op" id="5722379">!=</span>&nbsp;<span class="num" id="5722382">0</span>&nbsp;<span class="op" id="5722384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5722388"><a href="/gostd/image/gif/reader.go.html#5722112">d</a></span><span class="op" id="5722389">.</span><span class="ident" id="5722390"><a href="/gostd/image/gif/reader.go.html#5715809">transparentIndex</a></span>&nbsp;<span class="op" id="5722407">=</span>&nbsp;<span class="ident" id="5722409"><a href="/gostd/image/gif/reader.go.html#5722112">d</a></span><span class="op" id="5722410">.</span><span class="ident" id="5722411"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5722414">[</span><span class="num" id="5722415">4</span><span class="op" id="5722416">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5722420"><a href="/gostd/image/gif/reader.go.html#5722112">d</a></span><span class="op" id="5722421">.</span><span class="ident" id="5722422"><a href="/gostd/image/gif/reader.go.html#5715835">hasTransparentIndex</a></span>&nbsp;<span class="op" id="5722442">=</span>&nbsp;<span class="builtintype" id="5722444">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5722450">}</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5722453">return</span>&nbsp;<span class="builtintype" id="5722460">nil</span><br>
<span class="lineno"></span><span class="op" id="5722464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5722467">func</span>&nbsp;<span class="op" id="5722472">(</span><span class="ident" id="5722473">d</span>&nbsp;<span class="op" id="5722475">*</span><span class="ident" id="5722476"><a href="/gostd/image/gif/reader.go.html#5715477">decoder</a></span><span class="op" id="5722483">)</span>&nbsp;<span class="ident" id="5722485">newImageFromDescriptor</span><span class="op" id="5722507">(</span><span class="op" id="5722508">)</span>&nbsp;<span class="op" id="5722510">(</span><span class="op" id="5722511">*</span><span class="ident" id="5722512"><a href="/gostd/image/gif/reader.go.html#5714554">image</a></span><span class="op" id="5722517">.</span><span class="ident" id="5722518"><a href="/gostd/image/image.go.html#5176435">Paletted</a></span><span class="op" id="5722526">,</span>&nbsp;<span class="builtintype" id="5722528">error</span><span class="op" id="5722533">)</span>&nbsp;<span class="op" id="5722535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5722538">if</span>&nbsp;<span class="ident" id="5722541">_</span><span class="op" id="5722542">,</span>&nbsp;<span class="ident" id="5722544">err</span>&nbsp;<span class="op" id="5722548">:=</span>&nbsp;<span class="ident" id="5722551"><a href="/gostd/image/gif/reader.go.html#5714578">io</a></span><span class="op" id="5722553">.</span><span class="ident" id="5722554"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="5722562">(</span><span class="ident" id="5722563"><a href="/gostd/image/gif/reader.go.html#5722473">d</a></span><span class="op" id="5722564">.</span><span class="ident" id="5722565"><a href="/gostd/image/gif/reader.go.html#5715495">r</a></span><span class="op" id="5722566">,</span>&nbsp;<span class="ident" id="5722568"><a href="/gostd/image/gif/reader.go.html#5722473">d</a></span><span class="op" id="5722569">.</span><span class="ident" id="5722570"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5722573">[</span><span class="num" id="5722574">0</span><span class="op" id="5722575">:</span><span class="num" id="5722576">9</span><span class="op" id="5722577">]</span><span class="op" id="5722578">)</span><span class="op" id="5722579">;</span>&nbsp;<span class="ident" id="5722581"><a href="/gostd/image/gif/reader.go.html#5722544">err</a></span>&nbsp;<span class="op" id="5722585">!=</span>&nbsp;<span class="builtintype" id="5722588">nil</span>&nbsp;<span class="op" id="5722592">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5722596">return</span>&nbsp;<span class="builtintype" id="5722603">nil</span><span class="op" id="5722606">,</span>&nbsp;<span class="ident" id="5722608"><a href="/gostd/image/gif/reader.go.html#5714547">fmt</a></span><span class="op" id="5722611">.</span><span class="ident" id="5722612"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="5722618">(</span><span class="string" id="5722619">&#34;gif:&nbsp;can&#39;t&nbsp;read&nbsp;image&nbsp;descriptor:&nbsp;%s&#34;</span><span class="op" id="5722657">,</span>&nbsp;<span class="ident" id="5722659"><a href="/gostd/image/gif/reader.go.html#5722544">err</a></span><span class="op" id="5722662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5722665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5722668">left</span>&nbsp;<span class="op" id="5722673">:=</span>&nbsp;<span class="builtintype" id="5722676">int</span><span class="op" id="5722679">(</span><span class="ident" id="5722680"><a href="/gostd/image/gif/reader.go.html#5722473">d</a></span><span class="op" id="5722681">.</span><span class="ident" id="5722682"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5722685">[</span><span class="num" id="5722686">0</span><span class="op" id="5722687">]</span><span class="op" id="5722688">)</span>&nbsp;<span class="op" id="5722690">+</span>&nbsp;<span class="builtintype" id="5722692">int</span><span class="op" id="5722695">(</span><span class="ident" id="5722696"><a href="/gostd/image/gif/reader.go.html#5722473">d</a></span><span class="op" id="5722697">.</span><span class="ident" id="5722698"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5722701">[</span><span class="num" id="5722702">1</span><span class="op" id="5722703">]</span><span class="op" id="5722704">)</span><span class="op" id="5722705">&lt;&lt;</span><span class="num" id="5722707">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5722710">top</span>&nbsp;<span class="op" id="5722714">:=</span>&nbsp;<span class="builtintype" id="5722717">int</span><span class="op" id="5722720">(</span><span class="ident" id="5722721"><a href="/gostd/image/gif/reader.go.html#5722473">d</a></span><span class="op" id="5722722">.</span><span class="ident" id="5722723"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5722726">[</span><span class="num" id="5722727">2</span><span class="op" id="5722728">]</span><span class="op" id="5722729">)</span>&nbsp;<span class="op" id="5722731">+</span>&nbsp;<span class="builtintype" id="5722733">int</span><span class="op" id="5722736">(</span><span class="ident" id="5722737"><a href="/gostd/image/gif/reader.go.html#5722473">d</a></span><span class="op" id="5722738">.</span><span class="ident" id="5722739"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5722742">[</span><span class="num" id="5722743">3</span><span class="op" id="5722744">]</span><span class="op" id="5722745">)</span><span class="op" id="5722746">&lt;&lt;</span><span class="num" id="5722748">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5722751">width</span>&nbsp;<span class="op" id="5722757">:=</span>&nbsp;<span class="builtintype" id="5722760">int</span><span class="op" id="5722763">(</span><span class="ident" id="5722764"><a href="/gostd/image/gif/reader.go.html#5722473">d</a></span><span class="op" id="5722765">.</span><span class="ident" id="5722766"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5722769">[</span><span class="num" id="5722770">4</span><span class="op" id="5722771">]</span><span class="op" id="5722772">)</span>&nbsp;<span class="op" id="5722774">+</span>&nbsp;<span class="builtintype" id="5722776">int</span><span class="op" id="5722779">(</span><span class="ident" id="5722780"><a href="/gostd/image/gif/reader.go.html#5722473">d</a></span><span class="op" id="5722781">.</span><span class="ident" id="5722782"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5722785">[</span><span class="num" id="5722786">5</span><span class="op" id="5722787">]</span><span class="op" id="5722788">)</span><span class="op" id="5722789">&lt;&lt;</span><span class="num" id="5722791">8</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5722794">height</span>&nbsp;<span class="op" id="5722801">:=</span>&nbsp;<span class="builtintype" id="5722804">int</span><span class="op" id="5722807">(</span><span class="ident" id="5722808"><a href="/gostd/image/gif/reader.go.html#5722473">d</a></span><span class="op" id="5722809">.</span><span class="ident" id="5722810"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5722813">[</span><span class="num" id="5722814">6</span><span class="op" id="5722815">]</span><span class="op" id="5722816">)</span>&nbsp;<span class="op" id="5722818">+</span>&nbsp;<span class="builtintype" id="5722820">int</span><span class="op" id="5722823">(</span><span class="ident" id="5722824"><a href="/gostd/image/gif/reader.go.html#5722473">d</a></span><span class="op" id="5722825">.</span><span class="ident" id="5722826"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5722829">[</span><span class="num" id="5722830">7</span><span class="op" id="5722831">]</span><span class="op" id="5722832">)</span><span class="op" id="5722833">&lt;&lt;</span><span class="num" id="5722835">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5722838"><a href="/gostd/image/gif/reader.go.html#5722473">d</a></span><span class="op" id="5722839">.</span><span class="ident" id="5722840"><a href="/gostd/image/gif/reader.go.html#5715763">imageFields</a></span>&nbsp;<span class="op" id="5722852">=</span>&nbsp;<span class="ident" id="5722854"><a href="/gostd/image/gif/reader.go.html#5722473">d</a></span><span class="op" id="5722855">.</span><span class="ident" id="5722856"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5722859">[</span><span class="num" id="5722860">8</span><span class="op" id="5722861">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5722865">//&nbsp;The&nbsp;GIF89a&nbsp;spec,&nbsp;Section&nbsp;20&nbsp;(Image&nbsp;Descriptor)&nbsp;says:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5722922">//&nbsp;&#34;Each&nbsp;image&nbsp;must&nbsp;fit&nbsp;within&nbsp;the&nbsp;boundaries&nbsp;of&nbsp;the&nbsp;Logical</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5722984">//&nbsp;Screen,&nbsp;as&nbsp;defined&nbsp;in&nbsp;the&nbsp;Logical&nbsp;Screen&nbsp;Descriptor.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5723042">bounds</span>&nbsp;<span class="op" id="5723049">:=</span>&nbsp;<span class="ident" id="5723052"><a href="/gostd/image/gif/reader.go.html#5714554">image</a></span><span class="op" id="5723057">.</span><span class="ident" id="5723058"><a href="/gostd/image/geom.go.html#5153452">Rect</a></span><span class="op" id="5723062">(</span><span class="ident" id="5723063"><a href="/gostd/image/gif/reader.go.html#5722668">left</a></span><span class="op" id="5723067">,</span>&nbsp;<span class="ident" id="5723069"><a href="/gostd/image/gif/reader.go.html#5722710">top</a></span><span class="op" id="5723072">,</span>&nbsp;<span class="ident" id="5723074"><a href="/gostd/image/gif/reader.go.html#5722668">left</a></span><span class="op" id="5723078">+</span><span class="ident" id="5723079"><a href="/gostd/image/gif/reader.go.html#5722751">width</a></span><span class="op" id="5723084">,</span>&nbsp;<span class="ident" id="5723086"><a href="/gostd/image/gif/reader.go.html#5722710">top</a></span><span class="op" id="5723089">+</span><span class="ident" id="5723090"><a href="/gostd/image/gif/reader.go.html#5722794">height</a></span><span class="op" id="5723096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5723099">if</span>&nbsp;<span class="ident" id="5723102"><a href="/gostd/image/gif/reader.go.html#5723042">bounds</a></span>&nbsp;<span class="op" id="5723109">!=</span>&nbsp;<span class="ident" id="5723112"><a href="/gostd/image/gif/reader.go.html#5723042">bounds</a></span><span class="op" id="5723118">.</span><span class="ident" id="5723119"><a href="/gostd/image/geom.go.html#5151528">Intersect</a></span><span class="op" id="5723128">(</span><span class="ident" id="5723129"><a href="/gostd/image/gif/reader.go.html#5714554">image</a></span><span class="op" id="5723134">.</span><span class="ident" id="5723135"><a href="/gostd/image/geom.go.html#5153452">Rect</a></span><span class="op" id="5723139">(</span><span class="num" id="5723140">0</span><span class="op" id="5723141">,</span>&nbsp;<span class="num" id="5723143">0</span><span class="op" id="5723144">,</span>&nbsp;<span class="ident" id="5723146"><a href="/gostd/image/gif/reader.go.html#5722473">d</a></span><span class="op" id="5723147">.</span><span class="ident" id="5723148"><a href="/gostd/image/gif/reader.go.html#5715547">width</a></span><span class="op" id="5723153">,</span>&nbsp;<span class="ident" id="5723155"><a href="/gostd/image/gif/reader.go.html#5722473">d</a></span><span class="op" id="5723156">.</span><span class="ident" id="5723157"><a href="/gostd/image/gif/reader.go.html#5715568">height</a></span><span class="op" id="5723163">)</span><span class="op" id="5723164">)</span>&nbsp;<span class="op" id="5723166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5723170">return</span>&nbsp;<span class="builtintype" id="5723177">nil</span><span class="op" id="5723180">,</span>&nbsp;<span class="ident" id="5723182"><a href="/gostd/image/gif/reader.go.html#5714537">errors</a></span><span class="op" id="5723188">.</span><span class="ident" id="5723189"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="5723192">(</span><span class="string" id="5723193">&#34;gif:&nbsp;frame&nbsp;bounds&nbsp;larger&nbsp;than&nbsp;image&nbsp;bounds&#34;</span><span class="op" id="5723237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5723240">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5723243">return</span>&nbsp;<span class="ident" id="5723250"><a href="/gostd/image/gif/reader.go.html#5714554">image</a></span><span class="op" id="5723255">.</span><span class="ident" id="5723256"><a href="/gostd/image/image.go.html#5178970">NewPaletted</a></span><span class="op" id="5723267">(</span><span class="ident" id="5723268"><a href="/gostd/image/gif/reader.go.html#5723042">bounds</a></span><span class="op" id="5723274">,</span>&nbsp;<span class="builtintype" id="5723276">nil</span><span class="op" id="5723279">)</span><span class="op" id="5723280">,</span>&nbsp;<span class="builtintype" id="5723282">nil</span><br>
<span class="lineno"></span><span class="op" id="5723286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5723289">func</span>&nbsp;<span class="op" id="5723294">(</span><span class="ident" id="5723295">d</span>&nbsp;<span class="op" id="5723297">*</span><span class="ident" id="5723298"><a href="/gostd/image/gif/reader.go.html#5715477">decoder</a></span><span class="op" id="5723305">)</span>&nbsp;<span class="ident" id="5723307">readBlock</span><span class="op" id="5723316">(</span><span class="op" id="5723317">)</span>&nbsp;<span class="op" id="5723319">(</span><span class="builtintype" id="5723320">int</span><span class="op" id="5723323">,</span>&nbsp;<span class="builtintype" id="5723325">error</span><span class="op" id="5723330">)</span>&nbsp;<span class="op" id="5723332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5723335">n</span><span class="op" id="5723336">,</span>&nbsp;<span class="ident" id="5723338">err</span>&nbsp;<span class="op" id="5723342">:=</span>&nbsp;<span class="ident" id="5723345"><a href="/gostd/image/gif/reader.go.html#5723295">d</a></span><span class="op" id="5723346">.</span><span class="ident" id="5723347"><a href="/gostd/image/gif/reader.go.html#5715495">r</a></span><span class="op" id="5723348">.</span><span class="ident" id="5723349"><a href="/gostd/io/io.go.html#1426989">ReadByte</a></span><span class="op" id="5723357">(</span><span class="op" id="5723358">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5723361">if</span>&nbsp;<span class="ident" id="5723364"><a href="/gostd/image/gif/reader.go.html#5723335">n</a></span>&nbsp;<span class="op" id="5723366">==</span>&nbsp;<span class="num" id="5723369">0</span>&nbsp;<span class="op" id="5723371">||</span>&nbsp;<span class="ident" id="5723374"><a href="/gostd/image/gif/reader.go.html#5723338">err</a></span>&nbsp;<span class="op" id="5723378">!=</span>&nbsp;<span class="builtintype" id="5723381">nil</span>&nbsp;<span class="op" id="5723385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5723389">return</span>&nbsp;<span class="num" id="5723396">0</span><span class="op" id="5723397">,</span>&nbsp;<span class="ident" id="5723399"><a href="/gostd/image/gif/reader.go.html#5723338">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5723404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5723407">return</span>&nbsp;<span class="ident" id="5723414"><a href="/gostd/image/gif/reader.go.html#5714578">io</a></span><span class="op" id="5723416">.</span><span class="ident" id="5723417"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="5723425">(</span><span class="ident" id="5723426"><a href="/gostd/image/gif/reader.go.html#5723295">d</a></span><span class="op" id="5723427">.</span><span class="ident" id="5723428"><a href="/gostd/image/gif/reader.go.html#5715495">r</a></span><span class="op" id="5723429">,</span>&nbsp;<span class="ident" id="5723431"><a href="/gostd/image/gif/reader.go.html#5723295">d</a></span><span class="op" id="5723432">.</span><span class="ident" id="5723433"><a href="/gostd/image/gif/reader.go.html#5715990">tmp</a></span><span class="op" id="5723436">[</span><span class="num" id="5723437">0</span><span class="op" id="5723438">:</span><span class="ident" id="5723439"><a href="/gostd/image/gif/reader.go.html#5723335">n</a></span><span class="op" id="5723440">]</span><span class="op" id="5723441">)</span><br>
<span class="lineno"></span><span class="op" id="5723443">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span><span class="comment" id="5723446">//&nbsp;interlaceScan&nbsp;defines&nbsp;the&nbsp;ordering&nbsp;for&nbsp;a&nbsp;pass&nbsp;of&nbsp;the&nbsp;interlace&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="5723523">type</span>&nbsp;<span class="ident" id="5723528">interlaceScan</span>&nbsp;<span class="keyword" id="5723542">struct</span>&nbsp;<span class="op" id="5723549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5723552">skip</span><span class="op" id="5723556">,</span>&nbsp;<span class="ident" id="5723558">start</span>&nbsp;<span class="builtintype" id="5723564">int</span><br>
<span class="lineno"></span><span class="op" id="5723568">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span><span class="comment" id="5723571">//&nbsp;interlacing&nbsp;represents&nbsp;the&nbsp;set&nbsp;of&nbsp;scans&nbsp;in&nbsp;an&nbsp;interlaced&nbsp;GIF&nbsp;image.</span><br>
<span class="lineno"></span><span class="keyword" id="5723642">var</span>&nbsp;<span class="ident" id="5723646">interlacing</span>&nbsp;<span class="op" id="5723658">=</span>&nbsp;<span class="op" id="5723660">[</span><span class="op" id="5723661">]</span><span class="ident" id="5723662"><a href="/gostd/image/gif/reader.go.html#5723528">interlaceScan</a></span><span class="op" id="5723675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5723678">{</span><span class="num" id="5723679">8</span><span class="op" id="5723680">,</span>&nbsp;<span class="num" id="5723682">0</span><span class="op" id="5723683">}</span><span class="op" id="5723684">,</span>&nbsp;<span class="comment" id="5723686">//&nbsp;Group&nbsp;1&nbsp;:&nbsp;Every&nbsp;8th.&nbsp;row,&nbsp;starting&nbsp;with&nbsp;row&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5723737">{</span><span class="num" id="5723738">8</span><span class="op" id="5723739">,</span>&nbsp;<span class="num" id="5723741">4</span><span class="op" id="5723742">}</span><span class="op" id="5723743">,</span>&nbsp;<span class="comment" id="5723745">//&nbsp;Group&nbsp;2&nbsp;:&nbsp;Every&nbsp;8th.&nbsp;row,&nbsp;starting&nbsp;with&nbsp;row&nbsp;4.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5723796">{</span><span class="num" id="5723797">4</span><span class="op" id="5723798">,</span>&nbsp;<span class="num" id="5723800">2</span><span class="op" id="5723801">}</span><span class="op" id="5723802">,</span>&nbsp;<span class="comment" id="5723804">//&nbsp;Group&nbsp;3&nbsp;:&nbsp;Every&nbsp;4th.&nbsp;row,&nbsp;starting&nbsp;with&nbsp;row&nbsp;2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5723855">{</span><span class="num" id="5723856">2</span><span class="op" id="5723857">,</span>&nbsp;<span class="num" id="5723859">1</span><span class="op" id="5723860">}</span><span class="op" id="5723861">,</span>&nbsp;<span class="comment" id="5723863">//&nbsp;Group&nbsp;4&nbsp;:&nbsp;Every&nbsp;2nd.&nbsp;row,&nbsp;starting&nbsp;with&nbsp;row&nbsp;1.</span><br>
<span class="lineno"></span><span class="op" id="5723913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5723916">//&nbsp;uninterlace&nbsp;rearranges&nbsp;the&nbsp;pixels&nbsp;in&nbsp;m&nbsp;to&nbsp;account&nbsp;for&nbsp;interlaced&nbsp;input.</span><br>
<span class="lineno">400</span><span class="keyword" id="5723991">func</span>&nbsp;<span class="ident" id="5723996">uninterlace</span><span class="op" id="5724007">(</span><span class="ident" id="5724008">m</span>&nbsp;<span class="op" id="5724010">*</span><span class="ident" id="5724011"><a href="/gostd/image/gif/reader.go.html#5714554">image</a></span><span class="op" id="5724016">.</span><span class="ident" id="5724017"><a href="/gostd/image/image.go.html#5176435">Paletted</a></span><span class="op" id="5724025">)</span>&nbsp;<span class="op" id="5724027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5724030">var</span>&nbsp;<span class="ident" id="5724034">nPix</span>&nbsp;<span class="op" id="5724039">[</span><span class="op" id="5724040">]</span><span class="builtintype" id="5724041">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5724048">dx</span>&nbsp;<span class="op" id="5724051">:=</span>&nbsp;<span class="ident" id="5724054"><a href="/gostd/image/gif/reader.go.html#5724008">m</a></span><span class="op" id="5724055">.</span><span class="ident" id="5724056"><a href="/gostd/image/image.go.html#5176884">Bounds</a></span><span class="op" id="5724062">(</span><span class="op" id="5724063">)</span><span class="op" id="5724064">.</span><span class="ident" id="5724065"><a href="/gostd/image/geom.go.html#5150231">Dx</a></span><span class="op" id="5724067">(</span><span class="op" id="5724068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5724071">dy</span>&nbsp;<span class="op" id="5724074">:=</span>&nbsp;<span class="ident" id="5724077"><a href="/gostd/image/gif/reader.go.html#5724008">m</a></span><span class="op" id="5724078">.</span><span class="ident" id="5724079"><a href="/gostd/image/image.go.html#5176884">Bounds</a></span><span class="op" id="5724085">(</span><span class="op" id="5724086">)</span><span class="op" id="5724087">.</span><span class="ident" id="5724088"><a href="/gostd/image/geom.go.html#5150316">Dy</a></span><span class="op" id="5724090">(</span><span class="op" id="5724091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5724094"><a href="/gostd/image/gif/reader.go.html#5724034">nPix</a></span>&nbsp;<span class="op" id="5724099">=</span>&nbsp;<span class="builtinfunc" id="5724101">make</span><span class="op" id="5724105">(</span><span class="op" id="5724106">[</span><span class="op" id="5724107">]</span><span class="builtintype" id="5724108">uint8</span><span class="op" id="5724113">,</span>&nbsp;<span class="ident" id="5724115"><a href="/gostd/image/gif/reader.go.html#5724048">dx</a></span><span class="op" id="5724117">*</span><span class="ident" id="5724118"><a href="/gostd/image/gif/reader.go.html#5724071">dy</a></span><span class="op" id="5724120">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5724123">offset</span>&nbsp;<span class="op" id="5724130">:=</span>&nbsp;<span class="num" id="5724133">0</span>&nbsp;<span class="comment" id="5724135">//&nbsp;steps&nbsp;through&nbsp;the&nbsp;input&nbsp;by&nbsp;sequential&nbsp;scan&nbsp;lines.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5724189">for</span>&nbsp;<span class="ident" id="5724193">_</span><span class="op" id="5724194">,</span>&nbsp;<span class="ident" id="5724196">pass</span>&nbsp;<span class="op" id="5724201">:=</span>&nbsp;<span class="keyword" id="5724204">range</span>&nbsp;<span class="ident" id="5724210"><a href="/gostd/image/gif/reader.go.html#5723646">interlacing</a></span>&nbsp;<span class="op" id="5724222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5724226">nOffset</span>&nbsp;<span class="op" id="5724234">:=</span>&nbsp;<span class="ident" id="5724237"><a href="/gostd/image/gif/reader.go.html#5724196">pass</a></span><span class="op" id="5724241">.</span><span class="ident" id="5724242"><a href="/gostd/image/gif/reader.go.html#5723558">start</a></span>&nbsp;<span class="op" id="5724248">*</span>&nbsp;<span class="ident" id="5724250"><a href="/gostd/image/gif/reader.go.html#5724048">dx</a></span>&nbsp;<span class="comment" id="5724253">//&nbsp;steps&nbsp;through&nbsp;the&nbsp;output&nbsp;as&nbsp;defined&nbsp;by&nbsp;pass.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5724303">for</span>&nbsp;<span class="ident" id="5724307">y</span>&nbsp;<span class="op" id="5724309">:=</span>&nbsp;<span class="ident" id="5724312"><a href="/gostd/image/gif/reader.go.html#5724196">pass</a></span><span class="op" id="5724316">.</span><span class="ident" id="5724317"><a href="/gostd/image/gif/reader.go.html#5723558">start</a></span><span class="op" id="5724322">;</span>&nbsp;<span class="ident" id="5724324"><a href="/gostd/image/gif/reader.go.html#5724307">y</a></span>&nbsp;<span class="op" id="5724326">&lt;</span>&nbsp;<span class="ident" id="5724328"><a href="/gostd/image/gif/reader.go.html#5724071">dy</a></span><span class="op" id="5724330">;</span>&nbsp;<span class="ident" id="5724332"><a href="/gostd/image/gif/reader.go.html#5724307">y</a></span>&nbsp;<span class="op" id="5724334">+=</span>&nbsp;<span class="ident" id="5724337"><a href="/gostd/image/gif/reader.go.html#5724196">pass</a></span><span class="op" id="5724341">.</span><span class="ident" id="5724342"><a href="/gostd/image/gif/reader.go.html#5723552">skip</a></span>&nbsp;<span class="op" id="5724347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5724352">copy</span><span class="op" id="5724356">(</span><span class="ident" id="5724357"><a href="/gostd/image/gif/reader.go.html#5724034">nPix</a></span><span class="op" id="5724361">[</span><span class="ident" id="5724362"><a href="/gostd/image/gif/reader.go.html#5724226">nOffset</a></span><span class="op" id="5724369">:</span><span class="ident" id="5724370"><a href="/gostd/image/gif/reader.go.html#5724226">nOffset</a></span><span class="op" id="5724377">+</span><span class="ident" id="5724378"><a href="/gostd/image/gif/reader.go.html#5724048">dx</a></span><span class="op" id="5724380">]</span><span class="op" id="5724381">,</span>&nbsp;<span class="ident" id="5724383"><a href="/gostd/image/gif/reader.go.html#5724008">m</a></span><span class="op" id="5724384">.</span><span class="ident" id="5724385"><a href="/gostd/image/image.go.html#5176589">Pix</a></span><span class="op" id="5724388">[</span><span class="ident" id="5724389"><a href="/gostd/image/gif/reader.go.html#5724123">offset</a></span><span class="op" id="5724395">:</span><span class="ident" id="5724396"><a href="/gostd/image/gif/reader.go.html#5724123">offset</a></span><span class="op" id="5724402">+</span><span class="ident" id="5724403"><a href="/gostd/image/gif/reader.go.html#5724048">dx</a></span><span class="op" id="5724405">]</span><span class="op" id="5724406">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5724411"><a href="/gostd/image/gif/reader.go.html#5724123">offset</a></span>&nbsp;<span class="op" id="5724418">+=</span>&nbsp;<span class="ident" id="5724421"><a href="/gostd/image/gif/reader.go.html#5724048">dx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5724427"><a href="/gostd/image/gif/reader.go.html#5724226">nOffset</a></span>&nbsp;<span class="op" id="5724435">+=</span>&nbsp;<span class="ident" id="5724438"><a href="/gostd/image/gif/reader.go.html#5724048">dx</a></span>&nbsp;<span class="op" id="5724441">*</span>&nbsp;<span class="ident" id="5724443"><a href="/gostd/image/gif/reader.go.html#5724196">pass</a></span><span class="op" id="5724447">.</span><span class="ident" id="5724448"><a href="/gostd/image/gif/reader.go.html#5723552">skip</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5724455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5724458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5724461"><a href="/gostd/image/gif/reader.go.html#5724008">m</a></span><span class="op" id="5724462">.</span><span class="ident" id="5724463"><a href="/gostd/image/image.go.html#5176589">Pix</a></span>&nbsp;<span class="op" id="5724467">=</span>&nbsp;<span class="ident" id="5724469"><a href="/gostd/image/gif/reader.go.html#5724034">nPix</a></span><br>
<span class="lineno">415</span><span class="op" id="5724474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5724477">//&nbsp;Decode&nbsp;reads&nbsp;a&nbsp;GIF&nbsp;image&nbsp;from&nbsp;r&nbsp;and&nbsp;returns&nbsp;the&nbsp;first&nbsp;embedded</span><br>
<span class="lineno"></span><span class="comment" id="5724543">//&nbsp;image&nbsp;as&nbsp;an&nbsp;image.Image.</span><br>
<span class="lineno"></span><span class="keyword" id="5724571">func</span>&nbsp;<span class="ident" id="5724576">Decode</span><span class="op" id="5724582">(</span><span class="ident" id="5724583">r</span>&nbsp;<span class="ident" id="5724585"><a href="/gostd/image/gif/reader.go.html#5714578">io</a></span><span class="op" id="5724587">.</span><span class="ident" id="5724588"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="5724594">)</span>&nbsp;<span class="op" id="5724596">(</span><span class="ident" id="5724597"><a href="/gostd/image/gif/reader.go.html#5714554">image</a></span><span class="op" id="5724602">.</span><span class="ident" id="5724603"><a href="/gostd/image/image.go.html#5154907">Image</a></span><span class="op" id="5724608">,</span>&nbsp;<span class="builtintype" id="5724610">error</span><span class="op" id="5724615">)</span>&nbsp;<span class="op" id="5724617">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5724620">var</span>&nbsp;<span class="ident" id="5724624">d</span>&nbsp;<span class="ident" id="5724626"><a href="/gostd/image/gif/reader.go.html#5715477">decoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5724635">if</span>&nbsp;<span class="ident" id="5724638">err</span>&nbsp;<span class="op" id="5724642">:=</span>&nbsp;<span class="ident" id="5724645"><a href="/gostd/image/gif/reader.go.html#5724624">d</a></span><span class="op" id="5724646">.</span><span class="ident" id="5724647"><a href="/gostd/image/gif/reader.go.html#5717085">decode</a></span><span class="op" id="5724653">(</span><span class="ident" id="5724654"><a href="/gostd/image/gif/reader.go.html#5724583">r</a></span><span class="op" id="5724655">,</span>&nbsp;<span class="builtintype" id="5724657">false</span><span class="op" id="5724662">)</span><span class="op" id="5724663">;</span>&nbsp;<span class="ident" id="5724665"><a href="/gostd/image/gif/reader.go.html#5724638">err</a></span>&nbsp;<span class="op" id="5724669">!=</span>&nbsp;<span class="builtintype" id="5724672">nil</span>&nbsp;<span class="op" id="5724676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5724680">return</span>&nbsp;<span class="builtintype" id="5724687">nil</span><span class="op" id="5724690">,</span>&nbsp;<span class="ident" id="5724692"><a href="/gostd/image/gif/reader.go.html#5724638">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5724697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5724700">return</span>&nbsp;<span class="ident" id="5724707"><a href="/gostd/image/gif/reader.go.html#5724624">d</a></span><span class="op" id="5724708">.</span><span class="ident" id="5724709"><a href="/gostd/image/gif/reader.go.html#5715965">image</a></span><span class="op" id="5724714">[</span><span class="num" id="5724715">0</span><span class="op" id="5724716">]</span><span class="op" id="5724717">,</span>&nbsp;<span class="builtintype" id="5724719">nil</span><br>
<span class="lineno">425</span><span class="op" id="5724723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5724726">//&nbsp;GIF&nbsp;represents&nbsp;the&nbsp;possibly&nbsp;multiple&nbsp;images&nbsp;stored&nbsp;in&nbsp;a&nbsp;GIF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5724795">type</span>&nbsp;<span class="ident" id="5724800">GIF</span>&nbsp;<span class="keyword" id="5724804">struct</span>&nbsp;<span class="op" id="5724811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5724814">Image</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5724824">[</span><span class="op" id="5724825">]</span><span class="op" id="5724826">*</span><span class="ident" id="5724827"><a href="/gostd/image/gif/reader.go.html#5714554">image</a></span><span class="op" id="5724832">.</span><span class="ident" id="5724833"><a href="/gostd/image/image.go.html#5176435">Paletted</a></span>&nbsp;<span class="comment" id="5724842">//&nbsp;The&nbsp;successive&nbsp;images.</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5724869">Delay</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5724879">[</span><span class="op" id="5724880">]</span><span class="builtintype" id="5724881">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5724897">//&nbsp;The&nbsp;successive&nbsp;delay&nbsp;times,&nbsp;one&nbsp;per&nbsp;frame,&nbsp;in&nbsp;100ths&nbsp;of&nbsp;a&nbsp;second.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5724967">LoopCount</span>&nbsp;<span class="builtintype" id="5724977">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5724995">//&nbsp;The&nbsp;loop&nbsp;count.</span><br>
<span class="lineno"></span><span class="op" id="5725014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5725017">//&nbsp;DecodeAll&nbsp;reads&nbsp;a&nbsp;GIF&nbsp;image&nbsp;from&nbsp;r&nbsp;and&nbsp;returns&nbsp;the&nbsp;sequential&nbsp;frames</span><br>
<span class="lineno">435</span><span class="comment" id="5725089">//&nbsp;and&nbsp;timing&nbsp;information.</span><br>
<span class="lineno"></span><span class="keyword" id="5725116">func</span>&nbsp;<span class="ident" id="5725121">DecodeAll</span><span class="op" id="5725130">(</span><span class="ident" id="5725131">r</span>&nbsp;<span class="ident" id="5725133"><a href="/gostd/image/gif/reader.go.html#5714578">io</a></span><span class="op" id="5725135">.</span><span class="ident" id="5725136"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="5725142">)</span>&nbsp;<span class="op" id="5725144">(</span><span class="op" id="5725145">*</span><span class="ident" id="5725146"><a href="/gostd/image/gif/reader.go.html#5724800">GIF</a></span><span class="op" id="5725149">,</span>&nbsp;<span class="builtintype" id="5725151">error</span><span class="op" id="5725156">)</span>&nbsp;<span class="op" id="5725158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725161">var</span>&nbsp;<span class="ident" id="5725165">d</span>&nbsp;<span class="ident" id="5725167"><a href="/gostd/image/gif/reader.go.html#5715477">decoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725176">if</span>&nbsp;<span class="ident" id="5725179">err</span>&nbsp;<span class="op" id="5725183">:=</span>&nbsp;<span class="ident" id="5725186"><a href="/gostd/image/gif/reader.go.html#5725165">d</a></span><span class="op" id="5725187">.</span><span class="ident" id="5725188"><a href="/gostd/image/gif/reader.go.html#5717085">decode</a></span><span class="op" id="5725194">(</span><span class="ident" id="5725195"><a href="/gostd/image/gif/reader.go.html#5725131">r</a></span><span class="op" id="5725196">,</span>&nbsp;<span class="builtintype" id="5725198">false</span><span class="op" id="5725203">)</span><span class="op" id="5725204">;</span>&nbsp;<span class="ident" id="5725206"><a href="/gostd/image/gif/reader.go.html#5725179">err</a></span>&nbsp;<span class="op" id="5725210">!=</span>&nbsp;<span class="builtintype" id="5725213">nil</span>&nbsp;<span class="op" id="5725217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725221">return</span>&nbsp;<span class="builtintype" id="5725228">nil</span><span class="op" id="5725231">,</span>&nbsp;<span class="ident" id="5725233"><a href="/gostd/image/gif/reader.go.html#5725179">err</a></span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5725238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5725241">gif</span>&nbsp;<span class="op" id="5725245">:=</span>&nbsp;<span class="op" id="5725248">&amp;</span><span class="ident" id="5725249"><a href="/gostd/image/gif/reader.go.html#5724800">GIF</a></span><span class="op" id="5725252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5725256"><a href="/gostd/image/gif/reader.go.html#5724814">Image</a></span><span class="op" id="5725261">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5725267"><a href="/gostd/image/gif/reader.go.html#5725165">d</a></span><span class="op" id="5725268">.</span><span class="ident" id="5725269"><a href="/gostd/image/gif/reader.go.html#5715965">image</a></span><span class="op" id="5725274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5725278"><a href="/gostd/image/gif/reader.go.html#5724967">LoopCount</a></span><span class="op" id="5725287">:</span>&nbsp;<span class="ident" id="5725289"><a href="/gostd/image/gif/reader.go.html#5725165">d</a></span><span class="op" id="5725290">.</span><span class="ident" id="5725291"><a href="/gostd/image/gif/reader.go.html#5715655">loopCount</a></span><span class="op" id="5725300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5725304"><a href="/gostd/image/gif/reader.go.html#5724869">Delay</a></span><span class="op" id="5725309">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5725315"><a href="/gostd/image/gif/reader.go.html#5725165">d</a></span><span class="op" id="5725316">.</span><span class="ident" id="5725317"><a href="/gostd/image/gif/reader.go.html#5715952">delay</a></span><span class="op" id="5725322">,</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5725325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725328">return</span>&nbsp;<span class="ident" id="5725335"><a href="/gostd/image/gif/reader.go.html#5725241">gif</a></span><span class="op" id="5725338">,</span>&nbsp;<span class="builtintype" id="5725340">nil</span><br>
<span class="lineno"></span><span class="op" id="5725344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5725347">//&nbsp;DecodeConfig&nbsp;returns&nbsp;the&nbsp;global&nbsp;color&nbsp;model&nbsp;and&nbsp;dimensions&nbsp;of&nbsp;a&nbsp;GIF&nbsp;image</span><br>
<span class="lineno">450</span><span class="comment" id="5725424">//&nbsp;without&nbsp;decoding&nbsp;the&nbsp;entire&nbsp;image.</span><br>
<span class="lineno"></span><span class="keyword" id="5725462">func</span>&nbsp;<span class="ident" id="5725467">DecodeConfig</span><span class="op" id="5725479">(</span><span class="ident" id="5725480">r</span>&nbsp;<span class="ident" id="5725482"><a href="/gostd/image/gif/reader.go.html#5714578">io</a></span><span class="op" id="5725484">.</span><span class="ident" id="5725485"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="5725491">)</span>&nbsp;<span class="op" id="5725493">(</span><span class="ident" id="5725494"><a href="/gostd/image/gif/reader.go.html#5714554">image</a></span><span class="op" id="5725499">.</span><span class="ident" id="5725500"><a href="/gostd/image/image.go.html#5154748">Config</a></span><span class="op" id="5725506">,</span>&nbsp;<span class="builtintype" id="5725508">error</span><span class="op" id="5725513">)</span>&nbsp;<span class="op" id="5725515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725518">var</span>&nbsp;<span class="ident" id="5725522">d</span>&nbsp;<span class="ident" id="5725524"><a href="/gostd/image/gif/reader.go.html#5715477">decoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725533">if</span>&nbsp;<span class="ident" id="5725536">err</span>&nbsp;<span class="op" id="5725540">:=</span>&nbsp;<span class="ident" id="5725543"><a href="/gostd/image/gif/reader.go.html#5725522">d</a></span><span class="op" id="5725544">.</span><span class="ident" id="5725545"><a href="/gostd/image/gif/reader.go.html#5717085">decode</a></span><span class="op" id="5725551">(</span><span class="ident" id="5725552"><a href="/gostd/image/gif/reader.go.html#5725480">r</a></span><span class="op" id="5725553">,</span>&nbsp;<span class="builtintype" id="5725555">true</span><span class="op" id="5725559">)</span><span class="op" id="5725560">;</span>&nbsp;<span class="ident" id="5725562"><a href="/gostd/image/gif/reader.go.html#5725536">err</a></span>&nbsp;<span class="op" id="5725566">!=</span>&nbsp;<span class="builtintype" id="5725569">nil</span>&nbsp;<span class="op" id="5725573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725577">return</span>&nbsp;<span class="ident" id="5725584"><a href="/gostd/image/gif/reader.go.html#5714554">image</a></span><span class="op" id="5725589">.</span><span class="ident" id="5725590"><a href="/gostd/image/image.go.html#5154748">Config</a></span><span class="op" id="5725596">{</span><span class="op" id="5725597">}</span><span class="op" id="5725598">,</span>&nbsp;<span class="ident" id="5725600"><a href="/gostd/image/gif/reader.go.html#5725536">err</a></span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5725605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725608">return</span>&nbsp;<span class="ident" id="5725615"><a href="/gostd/image/gif/reader.go.html#5714554">image</a></span><span class="op" id="5725620">.</span><span class="ident" id="5725621"><a href="/gostd/image/image.go.html#5154748">Config</a></span><span class="op" id="5725627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5725631"><a href="/gostd/image/image.go.html#5154765">ColorModel</a></span><span class="op" id="5725641">:</span>&nbsp;<span class="ident" id="5725643"><a href="/gostd/image/gif/reader.go.html#5725522">d</a></span><span class="op" id="5725644">.</span><span class="ident" id="5725645"><a href="/gostd/image/gif/reader.go.html#5715897">globalColorMap</a></span><span class="op" id="5725659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5725663"><a href="/gostd/image/image.go.html#5154792">Width</a></span><span class="op" id="5725668">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5725675"><a href="/gostd/image/gif/reader.go.html#5725522">d</a></span><span class="op" id="5725676">.</span><span class="ident" id="5725677"><a href="/gostd/image/gif/reader.go.html#5715547">width</a></span><span class="op" id="5725682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5725686"><a href="/gostd/image/image.go.html#5154799">Height</a></span><span class="op" id="5725692">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5725698"><a href="/gostd/image/gif/reader.go.html#5725522">d</a></span><span class="op" id="5725699">.</span><span class="ident" id="5725700"><a href="/gostd/image/gif/reader.go.html#5715568">height</a></span><span class="op" id="5725706">,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5725709">}</span><span class="op" id="5725710">,</span>&nbsp;<span class="builtintype" id="5725712">nil</span><br>
<span class="lineno"></span><span class="op" id="5725716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5725719">func</span>&nbsp;<span class="ident" id="5725724">init</span><span class="op" id="5725728">(</span><span class="op" id="5725729">)</span>&nbsp;<span class="op" id="5725731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5725734"><a href="/gostd/image/gif/reader.go.html#5714554">image</a></span><span class="op" id="5725739">.</span><span class="ident" id="5725740"><a href="/gostd/image/format.go.html#5146281">RegisterFormat</a></span><span class="op" id="5725754">(</span><span class="string" id="5725755">&#34;gif&#34;</span><span class="op" id="5725760">,</span>&nbsp;<span class="string" id="5725762">&#34;GIF8?a&#34;</span><span class="op" id="5725770">,</span>&nbsp;<span class="ident" id="5725772"><a href="/gostd/image/gif/reader.go.html#5724576">Decode</a></span><span class="op" id="5725778">,</span>&nbsp;<span class="ident" id="5725780"><a href="/gostd/image/gif/reader.go.html#5725467">DecodeConfig</a></span><span class="op" id="5725792">)</span><br>
<span class="lineno">465</span><span class="op" id="5725794">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
