<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os/exec</h2>
<ul>
<li><a href="/gostd/os/exec/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/os/exec/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/os/exec/lp_test.go.html">lp_test.go</a></li>
<li><a href="/gostd/os/exec/lp_unix.go.html">lp_unix.go</a></li>
<li><a href="/gostd/os/exec/lp_unix_test.go.html">lp_unix_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5865979">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5866034">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5866088">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5866139">//&nbsp;Package&nbsp;exec&nbsp;runs&nbsp;external&nbsp;commands.&nbsp;It&nbsp;wraps&nbsp;os.StartProcess&nbsp;to&nbsp;make&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5866215">//&nbsp;easier&nbsp;to&nbsp;remap&nbsp;stdin&nbsp;and&nbsp;stdout,&nbsp;connect&nbsp;I/O&nbsp;with&nbsp;pipes,&nbsp;and&nbsp;do&nbsp;other</span><br>
<span class="lineno"></span><span class="comment" id="5866289">//&nbsp;adjustments.</span><br>
<span class="lineno"></span><span class="keyword" id="5866305">package</span>&nbsp;<span class="ident" id="5866313">exec</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="5866319">import</span>&nbsp;<span class="op" id="5866326">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5866329">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5866338">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5866348">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5866354">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5866360">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5866377">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5866388">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5866399">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5866410">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5866418">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="5866428">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5866431">//&nbsp;Error&nbsp;records&nbsp;the&nbsp;name&nbsp;of&nbsp;a&nbsp;binary&nbsp;that&nbsp;failed&nbsp;to&nbsp;be&nbsp;executed</span><br>
<span class="lineno"></span><span class="comment" id="5866496">//&nbsp;and&nbsp;the&nbsp;reason&nbsp;it&nbsp;failed.</span><br>
<span class="lineno">25</span><span class="keyword" id="5866525">type</span>&nbsp;<span class="ident" id="5866530">Error</span>&nbsp;<span class="keyword" id="5866536">struct</span>&nbsp;<span class="op" id="5866543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5866546">Name</span>&nbsp;<span class="builtintype" id="5866551">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5866559">Err</span>&nbsp;&nbsp;<span class="builtintype" id="5866564">error</span><br>
<span class="lineno"></span><span class="op" id="5866570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="5866573">func</span>&nbsp;<span class="op" id="5866578">(</span><span class="ident" id="5866579">e</span>&nbsp;<span class="op" id="5866581">*</span><span class="ident" id="5866582">Error</span><span class="op" id="5866587">)</span>&nbsp;<span class="ident" id="5866589">Error</span><span class="op" id="5866594">(</span><span class="op" id="5866595">)</span>&nbsp;<span class="builtintype" id="5866597">string</span>&nbsp;<span class="op" id="5866604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5866607">return</span>&nbsp;<span class="string" id="5866614">&#34;exec:&nbsp;&#34;</span>&nbsp;<span class="op" id="5866623">+</span>&nbsp;<span class="ident" id="5866625">strconv</span><span class="op" id="5866632">.</span><span class="ident" id="5866633">Quote</span><span class="op" id="5866638">(</span><span class="ident" id="5866639">e</span><span class="op" id="5866640">.</span><span class="ident" id="5866641">Name</span><span class="op" id="5866645">)</span>&nbsp;<span class="op" id="5866647">+</span>&nbsp;<span class="string" id="5866649">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="5866654">+</span>&nbsp;<span class="ident" id="5866656">e</span><span class="op" id="5866657">.</span><span class="ident" id="5866658">Err</span><span class="op" id="5866661">.</span><span class="ident" id="5866662">Error</span><span class="op" id="5866667">(</span><span class="op" id="5866668">)</span><br>
<span class="lineno"></span><span class="op" id="5866670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5866673">//&nbsp;Cmd&nbsp;represents&nbsp;an&nbsp;external&nbsp;command&nbsp;being&nbsp;prepared&nbsp;or&nbsp;run.</span><br>
<span class="lineno">35</span><span class="keyword" id="5866734">type</span>&nbsp;<span class="ident" id="5866739">Cmd</span>&nbsp;<span class="keyword" id="5866743">struct</span>&nbsp;<span class="op" id="5866750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5866753">//&nbsp;Path&nbsp;is&nbsp;the&nbsp;path&nbsp;of&nbsp;the&nbsp;command&nbsp;to&nbsp;run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5866797">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5866801">//&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;field&nbsp;that&nbsp;must&nbsp;be&nbsp;set&nbsp;to&nbsp;a&nbsp;non-zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5866859">//&nbsp;value.&nbsp;If&nbsp;Path&nbsp;is&nbsp;relative,&nbsp;it&nbsp;is&nbsp;evaluated&nbsp;relative</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5866916">//&nbsp;to&nbsp;Dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5866928">Path</span>&nbsp;<span class="builtintype" id="5866933">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5866942">//&nbsp;Args&nbsp;holds&nbsp;command&nbsp;line&nbsp;arguments,&nbsp;including&nbsp;the&nbsp;command&nbsp;as&nbsp;Args[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867015">//&nbsp;If&nbsp;the&nbsp;Args&nbsp;field&nbsp;is&nbsp;empty&nbsp;or&nbsp;nil,&nbsp;Run&nbsp;uses&nbsp;{Path}.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867071">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867075">//&nbsp;In&nbsp;typical&nbsp;use,&nbsp;both&nbsp;Path&nbsp;and&nbsp;Args&nbsp;are&nbsp;set&nbsp;by&nbsp;calling&nbsp;Command.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867142">Args</span>&nbsp;<span class="op" id="5867147">[</span><span class="op" id="5867148">]</span><span class="builtintype" id="5867149">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867158">//&nbsp;Env&nbsp;specifies&nbsp;the&nbsp;environment&nbsp;of&nbsp;the&nbsp;process.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867208">//&nbsp;If&nbsp;Env&nbsp;is&nbsp;nil,&nbsp;Run&nbsp;uses&nbsp;the&nbsp;current&nbsp;process&#39;s&nbsp;environment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867271">Env</span>&nbsp;<span class="op" id="5867275">[</span><span class="op" id="5867276">]</span><span class="builtintype" id="5867277">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867286">//&nbsp;Dir&nbsp;specifies&nbsp;the&nbsp;working&nbsp;directory&nbsp;of&nbsp;the&nbsp;command.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867342">//&nbsp;If&nbsp;Dir&nbsp;is&nbsp;the&nbsp;empty&nbsp;string,&nbsp;Run&nbsp;runs&nbsp;the&nbsp;command&nbsp;in&nbsp;the</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867402">//&nbsp;calling&nbsp;process&#39;s&nbsp;current&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867443">Dir</span>&nbsp;<span class="builtintype" id="5867447">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867456">//&nbsp;Stdin&nbsp;specifies&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867506">//&nbsp;If&nbsp;Stdin&nbsp;is&nbsp;nil,&nbsp;the&nbsp;process&nbsp;reads&nbsp;from&nbsp;the&nbsp;null&nbsp;device&nbsp;(os.DevNull).</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867580">//&nbsp;If&nbsp;Stdin&nbsp;is&nbsp;an&nbsp;*os.File,&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;input&nbsp;is&nbsp;connected</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867651">//&nbsp;directly&nbsp;to&nbsp;that&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867678">//&nbsp;Otherwise,&nbsp;during&nbsp;the&nbsp;execution&nbsp;of&nbsp;the&nbsp;command&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867740">//&nbsp;goroutine&nbsp;reads&nbsp;from&nbsp;Stdin&nbsp;and&nbsp;delivers&nbsp;that&nbsp;data&nbsp;to&nbsp;the&nbsp;command</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867809">//&nbsp;over&nbsp;a&nbsp;pipe.&nbsp;In&nbsp;this&nbsp;case,&nbsp;Wait&nbsp;does&nbsp;not&nbsp;complete&nbsp;until&nbsp;the&nbsp;goroutine</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867883">//&nbsp;stops&nbsp;copying,&nbsp;either&nbsp;because&nbsp;it&nbsp;has&nbsp;reached&nbsp;the&nbsp;end&nbsp;of&nbsp;Stdin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867949">//&nbsp;(EOF&nbsp;or&nbsp;a&nbsp;read&nbsp;error)&nbsp;or&nbsp;because&nbsp;writing&nbsp;to&nbsp;the&nbsp;pipe&nbsp;returned&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868025">Stdin</span>&nbsp;<span class="ident" id="5868031">io</span><span class="op" id="5868033">.</span><span class="ident" id="5868034">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5868043">//&nbsp;Stdout&nbsp;and&nbsp;Stderr&nbsp;specify&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;output&nbsp;and&nbsp;error.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5868114">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5868118">//&nbsp;If&nbsp;either&nbsp;is&nbsp;nil,&nbsp;Run&nbsp;connects&nbsp;the&nbsp;corresponding&nbsp;file&nbsp;descriptor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5868187">//&nbsp;to&nbsp;the&nbsp;null&nbsp;device&nbsp;(os.DevNull).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5868224">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5868228">//&nbsp;If&nbsp;Stdout&nbsp;and&nbsp;Stderr&nbsp;are&nbsp;the&nbsp;same&nbsp;writer,&nbsp;at&nbsp;most&nbsp;one</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5868286">//&nbsp;goroutine&nbsp;at&nbsp;a&nbsp;time&nbsp;will&nbsp;call&nbsp;Write.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868327">Stdout</span>&nbsp;<span class="ident" id="5868334">io</span><span class="op" id="5868336">.</span><span class="ident" id="5868337">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868345">Stderr</span>&nbsp;<span class="ident" id="5868352">io</span><span class="op" id="5868354">.</span><span class="ident" id="5868355">Writer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5868364">//&nbsp;ExtraFiles&nbsp;specifies&nbsp;additional&nbsp;open&nbsp;files&nbsp;to&nbsp;be&nbsp;inherited&nbsp;by&nbsp;the</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5868434">//&nbsp;new&nbsp;process.&nbsp;It&nbsp;does&nbsp;not&nbsp;include&nbsp;standard&nbsp;input,&nbsp;standard&nbsp;output,&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5868507">//&nbsp;standard&nbsp;error.&nbsp;If&nbsp;non-nil,&nbsp;entry&nbsp;i&nbsp;becomes&nbsp;file&nbsp;descriptor&nbsp;3+i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5868576">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5868580">//&nbsp;BUG:&nbsp;on&nbsp;OS&nbsp;X&nbsp;10.6,&nbsp;child&nbsp;processes&nbsp;may&nbsp;sometimes&nbsp;inherit&nbsp;unwanted&nbsp;fds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5868655">//&nbsp;http://golang.org/issue/2603</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868688">ExtraFiles</span>&nbsp;<span class="op" id="5868699">[</span><span class="op" id="5868700">]</span><span class="op" id="5868701">*</span><span class="ident" id="5868702">os</span><span class="op" id="5868704">.</span><span class="ident" id="5868705">File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5868712">//&nbsp;SysProcAttr&nbsp;holds&nbsp;optional,&nbsp;operating&nbsp;system-specific&nbsp;attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5868782">//&nbsp;Run&nbsp;passes&nbsp;it&nbsp;to&nbsp;os.StartProcess&nbsp;as&nbsp;the&nbsp;os.ProcAttr&#39;s&nbsp;Sys&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868851">SysProcAttr</span>&nbsp;<span class="op" id="5868863">*</span><span class="ident" id="5868864">syscall</span><span class="op" id="5868871">.</span><span class="ident" id="5868872">SysProcAttr</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5868886">//&nbsp;Process&nbsp;is&nbsp;the&nbsp;underlying&nbsp;process,&nbsp;once&nbsp;started.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868939">Process</span>&nbsp;<span class="op" id="5868947">*</span><span class="ident" id="5868948">os</span><span class="op" id="5868950">.</span><span class="ident" id="5868951">Process</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5868961">//&nbsp;ProcessState&nbsp;contains&nbsp;information&nbsp;about&nbsp;an&nbsp;exited&nbsp;process,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5869024">//&nbsp;available&nbsp;after&nbsp;a&nbsp;call&nbsp;to&nbsp;Wait&nbsp;or&nbsp;Run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869067">ProcessState</span>&nbsp;<span class="op" id="5869080">*</span><span class="ident" id="5869081">os</span><span class="op" id="5869083">.</span><span class="ident" id="5869084">ProcessState</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869099">lookPathErr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5869115">error</span>&nbsp;<span class="comment" id="5869121">//&nbsp;LookPath&nbsp;error,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869149">finished</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5869165">bool</span>&nbsp;&nbsp;<span class="comment" id="5869171">//&nbsp;when&nbsp;Wait&nbsp;was&nbsp;called</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869196">childFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5869212">[</span><span class="op" id="5869213">]</span><span class="op" id="5869214">*</span><span class="ident" id="5869215">os</span><span class="op" id="5869217">.</span><span class="ident" id="5869218">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869224">closeAfterStart</span>&nbsp;<span class="op" id="5869240">[</span><span class="op" id="5869241">]</span><span class="ident" id="5869242">io</span><span class="op" id="5869244">.</span><span class="ident" id="5869245">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869253">closeAfterWait</span>&nbsp;&nbsp;<span class="op" id="5869269">[</span><span class="op" id="5869270">]</span><span class="ident" id="5869271">io</span><span class="op" id="5869273">.</span><span class="ident" id="5869274">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869282">goroutine</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5869298">[</span><span class="op" id="5869299">]</span><span class="keyword" id="5869300">func</span><span class="op" id="5869304">(</span><span class="op" id="5869305">)</span>&nbsp;<span class="builtintype" id="5869307">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869314">errch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5869330">chan</span>&nbsp;<span class="builtintype" id="5869335">error</span>&nbsp;<span class="comment" id="5869341">//&nbsp;one&nbsp;send&nbsp;per&nbsp;goroutine</span><br>
<span class="lineno">105</span><span class="op" id="5869367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5869370">//&nbsp;Command&nbsp;returns&nbsp;the&nbsp;Cmd&nbsp;struct&nbsp;to&nbsp;execute&nbsp;the&nbsp;named&nbsp;program&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5869438">//&nbsp;the&nbsp;given&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="5869462">//</span><br>
<span class="lineno">110</span><span class="comment" id="5869465">//&nbsp;It&nbsp;sets&nbsp;only&nbsp;the&nbsp;Path&nbsp;and&nbsp;Args&nbsp;in&nbsp;the&nbsp;returned&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="5869526">//</span><br>
<span class="lineno"></span><span class="comment" id="5869529">//&nbsp;If&nbsp;name&nbsp;contains&nbsp;no&nbsp;path&nbsp;separators,&nbsp;Command&nbsp;uses&nbsp;LookPath&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5869594">//&nbsp;resolve&nbsp;the&nbsp;path&nbsp;to&nbsp;a&nbsp;complete&nbsp;name&nbsp;if&nbsp;possible.&nbsp;Otherwise&nbsp;it&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="5869664">//&nbsp;name&nbsp;directly.</span><br>
<span class="lineno">115</span><span class="comment" id="5869682">//</span><br>
<span class="lineno"></span><span class="comment" id="5869685">//&nbsp;The&nbsp;returned&nbsp;Cmd&#39;s&nbsp;Args&nbsp;field&nbsp;is&nbsp;constructed&nbsp;from&nbsp;the&nbsp;command&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="5869755">//&nbsp;followed&nbsp;by&nbsp;the&nbsp;elements&nbsp;of&nbsp;arg,&nbsp;so&nbsp;arg&nbsp;should&nbsp;not&nbsp;include&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5869821">//&nbsp;command&nbsp;name&nbsp;itself.&nbsp;For&nbsp;example,&nbsp;Command(&#34;echo&#34;,&nbsp;&#34;hello&#34;)</span><br>
<span class="lineno"></span><span class="keyword" id="5869883">func</span>&nbsp;<span class="ident" id="5869888">Command</span><span class="op" id="5869895">(</span><span class="ident" id="5869896">name</span>&nbsp;<span class="builtintype" id="5869901">string</span><span class="op" id="5869907">,</span>&nbsp;<span class="ident" id="5869909">arg</span>&nbsp;<span class="op" id="5869913">...</span><span class="builtintype" id="5869916">string</span><span class="op" id="5869922">)</span>&nbsp;<span class="op" id="5869924">*</span><span class="ident" id="5869925">Cmd</span>&nbsp;<span class="op" id="5869929">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869932">cmd</span>&nbsp;<span class="op" id="5869936">:=</span>&nbsp;<span class="op" id="5869939">&amp;</span><span class="ident" id="5869940">Cmd</span><span class="op" id="5869943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869947">Path</span><span class="op" id="5869951">:</span>&nbsp;<span class="ident" id="5869953">name</span><span class="op" id="5869957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869961">Args</span><span class="op" id="5869965">:</span>&nbsp;<span class="builtinfunc" id="5869967">append</span><span class="op" id="5869973">(</span><span class="op" id="5869974">[</span><span class="op" id="5869975">]</span><span class="builtintype" id="5869976">string</span><span class="op" id="5869982">{</span><span class="ident" id="5869983">name</span><span class="op" id="5869987">}</span><span class="op" id="5869988">,</span>&nbsp;<span class="ident" id="5869990">arg</span><span class="op" id="5869993">...</span><span class="op" id="5869996">)</span><span class="op" id="5869997">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5870000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870003">if</span>&nbsp;<span class="ident" id="5870006">filepath</span><span class="op" id="5870014">.</span><span class="ident" id="5870015">Base</span><span class="op" id="5870019">(</span><span class="ident" id="5870020">name</span><span class="op" id="5870024">)</span>&nbsp;<span class="op" id="5870026">==</span>&nbsp;<span class="ident" id="5870029">name</span>&nbsp;<span class="op" id="5870034">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870038">if</span>&nbsp;<span class="ident" id="5870041">lp</span><span class="op" id="5870043">,</span>&nbsp;<span class="ident" id="5870045">err</span>&nbsp;<span class="op" id="5870049">:=</span>&nbsp;<span class="ident" id="5870052">LookPath</span><span class="op" id="5870060">(</span><span class="ident" id="5870061">name</span><span class="op" id="5870065">)</span><span class="op" id="5870066">;</span>&nbsp;<span class="ident" id="5870068">err</span>&nbsp;<span class="op" id="5870072">!=</span>&nbsp;<span class="ident" id="5870075">nil</span>&nbsp;<span class="op" id="5870079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870084">cmd</span><span class="op" id="5870087">.</span><span class="ident" id="5870088">lookPathErr</span>&nbsp;<span class="op" id="5870100">=</span>&nbsp;<span class="ident" id="5870102">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5870108">}</span>&nbsp;<span class="keyword" id="5870110">else</span>&nbsp;<span class="op" id="5870115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870120">cmd</span><span class="op" id="5870123">.</span><span class="ident" id="5870124">Path</span>&nbsp;<span class="op" id="5870129">=</span>&nbsp;<span class="ident" id="5870131">lp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5870136">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5870139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870142">return</span>&nbsp;<span class="ident" id="5870149">cmd</span><br>
<span class="lineno"></span><span class="op" id="5870153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5870156">//&nbsp;interfaceEqual&nbsp;protects&nbsp;against&nbsp;panics&nbsp;from&nbsp;doing&nbsp;equality&nbsp;tests&nbsp;on</span><br>
<span class="lineno">135</span><span class="comment" id="5870227">//&nbsp;two&nbsp;interfaces&nbsp;with&nbsp;non-comparable&nbsp;underlying&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="5870283">func</span>&nbsp;<span class="ident" id="5870288">interfaceEqual</span><span class="op" id="5870302">(</span><span class="ident" id="5870303">a</span><span class="op" id="5870304">,</span>&nbsp;<span class="ident" id="5870306">b</span>&nbsp;<span class="keyword" id="5870308">interface</span><span class="op" id="5870317">{</span><span class="op" id="5870318">}</span><span class="op" id="5870319">)</span>&nbsp;<span class="builtintype" id="5870321">bool</span>&nbsp;<span class="op" id="5870326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870329">defer</span>&nbsp;<span class="keyword" id="5870335">func</span><span class="op" id="5870339">(</span><span class="op" id="5870340">)</span>&nbsp;<span class="op" id="5870342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5870346">recover</span><span class="op" id="5870353">(</span><span class="op" id="5870354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5870357">}</span><span class="op" id="5870358">(</span><span class="op" id="5870359">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870362">return</span>&nbsp;<span class="ident" id="5870369">a</span>&nbsp;<span class="op" id="5870371">==</span>&nbsp;<span class="ident" id="5870374">b</span><br>
<span class="lineno"></span><span class="op" id="5870376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5870379">func</span>&nbsp;<span class="op" id="5870384">(</span><span class="ident" id="5870385">c</span>&nbsp;<span class="op" id="5870387">*</span><span class="ident" id="5870388">Cmd</span><span class="op" id="5870391">)</span>&nbsp;<span class="ident" id="5870393">envv</span><span class="op" id="5870397">(</span><span class="op" id="5870398">)</span>&nbsp;<span class="op" id="5870400">[</span><span class="op" id="5870401">]</span><span class="builtintype" id="5870402">string</span>&nbsp;<span class="op" id="5870409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870412">if</span>&nbsp;<span class="ident" id="5870415">c</span><span class="op" id="5870416">.</span><span class="ident" id="5870417">Env</span>&nbsp;<span class="op" id="5870421">!=</span>&nbsp;<span class="ident" id="5870424">nil</span>&nbsp;<span class="op" id="5870428">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870432">return</span>&nbsp;<span class="ident" id="5870439">c</span><span class="op" id="5870440">.</span><span class="ident" id="5870441">Env</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5870446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870449">return</span>&nbsp;<span class="ident" id="5870456">os</span><span class="op" id="5870458">.</span><span class="ident" id="5870459">Environ</span><span class="op" id="5870466">(</span><span class="op" id="5870467">)</span><br>
<span class="lineno"></span><span class="op" id="5870469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="5870472">func</span>&nbsp;<span class="op" id="5870477">(</span><span class="ident" id="5870478">c</span>&nbsp;<span class="op" id="5870480">*</span><span class="ident" id="5870481">Cmd</span><span class="op" id="5870484">)</span>&nbsp;<span class="ident" id="5870486">argv</span><span class="op" id="5870490">(</span><span class="op" id="5870491">)</span>&nbsp;<span class="op" id="5870493">[</span><span class="op" id="5870494">]</span><span class="builtintype" id="5870495">string</span>&nbsp;<span class="op" id="5870502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870505">if</span>&nbsp;<span class="builtinfunc" id="5870508">len</span><span class="op" id="5870511">(</span><span class="ident" id="5870512">c</span><span class="op" id="5870513">.</span><span class="ident" id="5870514">Args</span><span class="op" id="5870518">)</span>&nbsp;<span class="op" id="5870520">&gt;</span>&nbsp;<span class="num" id="5870522">0</span>&nbsp;<span class="op" id="5870524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870528">return</span>&nbsp;<span class="ident" id="5870535">c</span><span class="op" id="5870536">.</span><span class="ident" id="5870537">Args</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5870543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870546">return</span>&nbsp;<span class="op" id="5870553">[</span><span class="op" id="5870554">]</span><span class="builtintype" id="5870555">string</span><span class="op" id="5870561">{</span><span class="ident" id="5870562">c</span><span class="op" id="5870563">.</span><span class="ident" id="5870564">Path</span><span class="op" id="5870568">}</span><br>
<span class="lineno">155</span><span class="op" id="5870570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5870573">func</span>&nbsp;<span class="op" id="5870578">(</span><span class="ident" id="5870579">c</span>&nbsp;<span class="op" id="5870581">*</span><span class="ident" id="5870582">Cmd</span><span class="op" id="5870585">)</span>&nbsp;<span class="ident" id="5870587">stdin</span><span class="op" id="5870592">(</span><span class="op" id="5870593">)</span>&nbsp;<span class="op" id="5870595">(</span><span class="ident" id="5870596">f</span>&nbsp;<span class="op" id="5870598">*</span><span class="ident" id="5870599">os</span><span class="op" id="5870601">.</span><span class="ident" id="5870602">File</span><span class="op" id="5870606">,</span>&nbsp;<span class="ident" id="5870608">err</span>&nbsp;<span class="builtintype" id="5870612">error</span><span class="op" id="5870617">)</span>&nbsp;<span class="op" id="5870619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870622">if</span>&nbsp;<span class="ident" id="5870625">c</span><span class="op" id="5870626">.</span><span class="ident" id="5870627">Stdin</span>&nbsp;<span class="op" id="5870633">==</span>&nbsp;<span class="ident" id="5870636">nil</span>&nbsp;<span class="op" id="5870640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870644">f</span><span class="op" id="5870645">,</span>&nbsp;<span class="ident" id="5870647">err</span>&nbsp;<span class="op" id="5870651">=</span>&nbsp;<span class="ident" id="5870653">os</span><span class="op" id="5870655">.</span><span class="ident" id="5870656">Open</span><span class="op" id="5870660">(</span><span class="ident" id="5870661">os</span><span class="op" id="5870663">.</span><span class="ident" id="5870664">DevNull</span><span class="op" id="5870671">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870675">if</span>&nbsp;<span class="ident" id="5870678">err</span>&nbsp;<span class="op" id="5870682">!=</span>&nbsp;<span class="ident" id="5870685">nil</span>&nbsp;<span class="op" id="5870689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870694">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5870703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870707">c</span><span class="op" id="5870708">.</span><span class="ident" id="5870709">closeAfterStart</span>&nbsp;<span class="op" id="5870725">=</span>&nbsp;<span class="builtinfunc" id="5870727">append</span><span class="op" id="5870733">(</span><span class="ident" id="5870734">c</span><span class="op" id="5870735">.</span><span class="ident" id="5870736">closeAfterStart</span><span class="op" id="5870751">,</span>&nbsp;<span class="ident" id="5870753">f</span><span class="op" id="5870754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870758">return</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5870766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870770">if</span>&nbsp;<span class="ident" id="5870773">f</span><span class="op" id="5870774">,</span>&nbsp;<span class="ident" id="5870776">ok</span>&nbsp;<span class="op" id="5870779">:=</span>&nbsp;<span class="ident" id="5870782">c</span><span class="op" id="5870783">.</span><span class="ident" id="5870784">Stdin</span><span class="op" id="5870789">.</span><span class="op" id="5870790">(</span><span class="op" id="5870791">*</span><span class="ident" id="5870792">os</span><span class="op" id="5870794">.</span><span class="ident" id="5870795">File</span><span class="op" id="5870799">)</span><span class="op" id="5870800">;</span>&nbsp;<span class="ident" id="5870802">ok</span>&nbsp;<span class="op" id="5870805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870809">return</span>&nbsp;<span class="ident" id="5870816">f</span><span class="op" id="5870817">,</span>&nbsp;<span class="ident" id="5870819">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5870824">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870828">pr</span><span class="op" id="5870830">,</span>&nbsp;<span class="ident" id="5870832">pw</span><span class="op" id="5870834">,</span>&nbsp;<span class="ident" id="5870836">err</span>&nbsp;<span class="op" id="5870840">:=</span>&nbsp;<span class="ident" id="5870843">os</span><span class="op" id="5870845">.</span><span class="ident" id="5870846">Pipe</span><span class="op" id="5870850">(</span><span class="op" id="5870851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870854">if</span>&nbsp;<span class="ident" id="5870857">err</span>&nbsp;<span class="op" id="5870861">!=</span>&nbsp;<span class="ident" id="5870864">nil</span>&nbsp;<span class="op" id="5870868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870872">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5870880">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870884">c</span><span class="op" id="5870885">.</span><span class="ident" id="5870886">closeAfterStart</span>&nbsp;<span class="op" id="5870902">=</span>&nbsp;<span class="builtinfunc" id="5870904">append</span><span class="op" id="5870910">(</span><span class="ident" id="5870911">c</span><span class="op" id="5870912">.</span><span class="ident" id="5870913">closeAfterStart</span><span class="op" id="5870928">,</span>&nbsp;<span class="ident" id="5870930">pr</span><span class="op" id="5870932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870935">c</span><span class="op" id="5870936">.</span><span class="ident" id="5870937">closeAfterWait</span>&nbsp;<span class="op" id="5870952">=</span>&nbsp;<span class="builtinfunc" id="5870954">append</span><span class="op" id="5870960">(</span><span class="ident" id="5870961">c</span><span class="op" id="5870962">.</span><span class="ident" id="5870963">closeAfterWait</span><span class="op" id="5870977">,</span>&nbsp;<span class="ident" id="5870979">pw</span><span class="op" id="5870981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870984">c</span><span class="op" id="5870985">.</span><span class="ident" id="5870986">goroutine</span>&nbsp;<span class="op" id="5870996">=</span>&nbsp;<span class="builtinfunc" id="5870998">append</span><span class="op" id="5871004">(</span><span class="ident" id="5871005">c</span><span class="op" id="5871006">.</span><span class="ident" id="5871007">goroutine</span><span class="op" id="5871016">,</span>&nbsp;<span class="keyword" id="5871018">func</span><span class="op" id="5871022">(</span><span class="op" id="5871023">)</span>&nbsp;<span class="builtintype" id="5871025">error</span>&nbsp;<span class="op" id="5871031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871035">_</span><span class="op" id="5871036">,</span>&nbsp;<span class="ident" id="5871038">err</span>&nbsp;<span class="op" id="5871042">:=</span>&nbsp;<span class="ident" id="5871045">io</span><span class="op" id="5871047">.</span><span class="ident" id="5871048">Copy</span><span class="op" id="5871052">(</span><span class="ident" id="5871053">pw</span><span class="op" id="5871055">,</span>&nbsp;<span class="ident" id="5871057">c</span><span class="op" id="5871058">.</span><span class="ident" id="5871059">Stdin</span><span class="op" id="5871064">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871068">if</span>&nbsp;<span class="ident" id="5871071">err1</span>&nbsp;<span class="op" id="5871076">:=</span>&nbsp;<span class="ident" id="5871079">pw</span><span class="op" id="5871081">.</span><span class="ident" id="5871082">Close</span><span class="op" id="5871087">(</span><span class="op" id="5871088">)</span><span class="op" id="5871089">;</span>&nbsp;<span class="ident" id="5871091">err</span>&nbsp;<span class="op" id="5871095">==</span>&nbsp;<span class="ident" id="5871098">nil</span>&nbsp;<span class="op" id="5871102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871107">err</span>&nbsp;<span class="op" id="5871111">=</span>&nbsp;<span class="ident" id="5871113">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871124">return</span>&nbsp;<span class="ident" id="5871131">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871136">}</span><span class="op" id="5871137">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871140">return</span>&nbsp;<span class="ident" id="5871147">pr</span><span class="op" id="5871149">,</span>&nbsp;<span class="ident" id="5871151">nil</span><br>
<span class="lineno"></span><span class="op" id="5871155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5871158">func</span>&nbsp;<span class="op" id="5871163">(</span><span class="ident" id="5871164">c</span>&nbsp;<span class="op" id="5871166">*</span><span class="ident" id="5871167">Cmd</span><span class="op" id="5871170">)</span>&nbsp;<span class="ident" id="5871172">stdout</span><span class="op" id="5871178">(</span><span class="op" id="5871179">)</span>&nbsp;<span class="op" id="5871181">(</span><span class="ident" id="5871182">f</span>&nbsp;<span class="op" id="5871184">*</span><span class="ident" id="5871185">os</span><span class="op" id="5871187">.</span><span class="ident" id="5871188">File</span><span class="op" id="5871192">,</span>&nbsp;<span class="ident" id="5871194">err</span>&nbsp;<span class="builtintype" id="5871198">error</span><span class="op" id="5871203">)</span>&nbsp;<span class="op" id="5871205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871208">return</span>&nbsp;<span class="ident" id="5871215">c</span><span class="op" id="5871216">.</span><span class="ident" id="5871217">writerDescriptor</span><span class="op" id="5871233">(</span><span class="ident" id="5871234">c</span><span class="op" id="5871235">.</span><span class="ident" id="5871236">Stdout</span><span class="op" id="5871242">)</span><br>
<span class="lineno">190</span><span class="op" id="5871244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5871247">func</span>&nbsp;<span class="op" id="5871252">(</span><span class="ident" id="5871253">c</span>&nbsp;<span class="op" id="5871255">*</span><span class="ident" id="5871256">Cmd</span><span class="op" id="5871259">)</span>&nbsp;<span class="ident" id="5871261">stderr</span><span class="op" id="5871267">(</span><span class="op" id="5871268">)</span>&nbsp;<span class="op" id="5871270">(</span><span class="ident" id="5871271">f</span>&nbsp;<span class="op" id="5871273">*</span><span class="ident" id="5871274">os</span><span class="op" id="5871276">.</span><span class="ident" id="5871277">File</span><span class="op" id="5871281">,</span>&nbsp;<span class="ident" id="5871283">err</span>&nbsp;<span class="builtintype" id="5871287">error</span><span class="op" id="5871292">)</span>&nbsp;<span class="op" id="5871294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871297">if</span>&nbsp;<span class="ident" id="5871300">c</span><span class="op" id="5871301">.</span><span class="ident" id="5871302">Stderr</span>&nbsp;<span class="op" id="5871309">!=</span>&nbsp;<span class="ident" id="5871312">nil</span>&nbsp;<span class="op" id="5871316">&amp;&amp;</span>&nbsp;<span class="ident" id="5871319">interfaceEqual</span><span class="op" id="5871333">(</span><span class="ident" id="5871334">c</span><span class="op" id="5871335">.</span><span class="ident" id="5871336">Stderr</span><span class="op" id="5871342">,</span>&nbsp;<span class="ident" id="5871344">c</span><span class="op" id="5871345">.</span><span class="ident" id="5871346">Stdout</span><span class="op" id="5871352">)</span>&nbsp;<span class="op" id="5871354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871358">return</span>&nbsp;<span class="ident" id="5871365">c</span><span class="op" id="5871366">.</span><span class="ident" id="5871367">childFiles</span><span class="op" id="5871377">[</span><span class="num" id="5871378">1</span><span class="op" id="5871379">]</span><span class="op" id="5871380">,</span>&nbsp;<span class="ident" id="5871382">nil</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871390">return</span>&nbsp;<span class="ident" id="5871397">c</span><span class="op" id="5871398">.</span><span class="ident" id="5871399">writerDescriptor</span><span class="op" id="5871415">(</span><span class="ident" id="5871416">c</span><span class="op" id="5871417">.</span><span class="ident" id="5871418">Stderr</span><span class="op" id="5871424">)</span><br>
<span class="lineno"></span><span class="op" id="5871426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5871429">func</span>&nbsp;<span class="op" id="5871434">(</span><span class="ident" id="5871435">c</span>&nbsp;<span class="op" id="5871437">*</span><span class="ident" id="5871438">Cmd</span><span class="op" id="5871441">)</span>&nbsp;<span class="ident" id="5871443">writerDescriptor</span><span class="op" id="5871459">(</span><span class="ident" id="5871460">w</span>&nbsp;<span class="ident" id="5871462">io</span><span class="op" id="5871464">.</span><span class="ident" id="5871465">Writer</span><span class="op" id="5871471">)</span>&nbsp;<span class="op" id="5871473">(</span><span class="ident" id="5871474">f</span>&nbsp;<span class="op" id="5871476">*</span><span class="ident" id="5871477">os</span><span class="op" id="5871479">.</span><span class="ident" id="5871480">File</span><span class="op" id="5871484">,</span>&nbsp;<span class="ident" id="5871486">err</span>&nbsp;<span class="builtintype" id="5871490">error</span><span class="op" id="5871495">)</span>&nbsp;<span class="op" id="5871497">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871500">if</span>&nbsp;<span class="ident" id="5871503">w</span>&nbsp;<span class="op" id="5871505">==</span>&nbsp;<span class="ident" id="5871508">nil</span>&nbsp;<span class="op" id="5871512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871516">f</span><span class="op" id="5871517">,</span>&nbsp;<span class="ident" id="5871519">err</span>&nbsp;<span class="op" id="5871523">=</span>&nbsp;<span class="ident" id="5871525">os</span><span class="op" id="5871527">.</span><span class="ident" id="5871528">OpenFile</span><span class="op" id="5871536">(</span><span class="ident" id="5871537">os</span><span class="op" id="5871539">.</span><span class="ident" id="5871540">DevNull</span><span class="op" id="5871547">,</span>&nbsp;<span class="ident" id="5871549">os</span><span class="op" id="5871551">.</span><span class="ident" id="5871552">O_WRONLY</span><span class="op" id="5871560">,</span>&nbsp;<span class="num" id="5871562">0</span><span class="op" id="5871563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871567">if</span>&nbsp;<span class="ident" id="5871570">err</span>&nbsp;<span class="op" id="5871574">!=</span>&nbsp;<span class="ident" id="5871577">nil</span>&nbsp;<span class="op" id="5871581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871586">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871595">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871599">c</span><span class="op" id="5871600">.</span><span class="ident" id="5871601">closeAfterStart</span>&nbsp;<span class="op" id="5871617">=</span>&nbsp;<span class="builtinfunc" id="5871619">append</span><span class="op" id="5871625">(</span><span class="ident" id="5871626">c</span><span class="op" id="5871627">.</span><span class="ident" id="5871628">closeAfterStart</span><span class="op" id="5871643">,</span>&nbsp;<span class="ident" id="5871645">f</span><span class="op" id="5871646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871650">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871662">if</span>&nbsp;<span class="ident" id="5871665">f</span><span class="op" id="5871666">,</span>&nbsp;<span class="ident" id="5871668">ok</span>&nbsp;<span class="op" id="5871671">:=</span>&nbsp;<span class="ident" id="5871674">w</span><span class="op" id="5871675">.</span><span class="op" id="5871676">(</span><span class="op" id="5871677">*</span><span class="ident" id="5871678">os</span><span class="op" id="5871680">.</span><span class="ident" id="5871681">File</span><span class="op" id="5871685">)</span><span class="op" id="5871686">;</span>&nbsp;<span class="ident" id="5871688">ok</span>&nbsp;<span class="op" id="5871691">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871695">return</span>&nbsp;<span class="ident" id="5871702">f</span><span class="op" id="5871703">,</span>&nbsp;<span class="ident" id="5871705">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871714">pr</span><span class="op" id="5871716">,</span>&nbsp;<span class="ident" id="5871718">pw</span><span class="op" id="5871720">,</span>&nbsp;<span class="ident" id="5871722">err</span>&nbsp;<span class="op" id="5871726">:=</span>&nbsp;<span class="ident" id="5871729">os</span><span class="op" id="5871731">.</span><span class="ident" id="5871732">Pipe</span><span class="op" id="5871736">(</span><span class="op" id="5871737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871740">if</span>&nbsp;<span class="ident" id="5871743">err</span>&nbsp;<span class="op" id="5871747">!=</span>&nbsp;<span class="ident" id="5871750">nil</span>&nbsp;<span class="op" id="5871754">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871758">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871770">c</span><span class="op" id="5871771">.</span><span class="ident" id="5871772">closeAfterStart</span>&nbsp;<span class="op" id="5871788">=</span>&nbsp;<span class="builtinfunc" id="5871790">append</span><span class="op" id="5871796">(</span><span class="ident" id="5871797">c</span><span class="op" id="5871798">.</span><span class="ident" id="5871799">closeAfterStart</span><span class="op" id="5871814">,</span>&nbsp;<span class="ident" id="5871816">pw</span><span class="op" id="5871818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871821">c</span><span class="op" id="5871822">.</span><span class="ident" id="5871823">closeAfterWait</span>&nbsp;<span class="op" id="5871838">=</span>&nbsp;<span class="builtinfunc" id="5871840">append</span><span class="op" id="5871846">(</span><span class="ident" id="5871847">c</span><span class="op" id="5871848">.</span><span class="ident" id="5871849">closeAfterWait</span><span class="op" id="5871863">,</span>&nbsp;<span class="ident" id="5871865">pr</span><span class="op" id="5871867">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871870">c</span><span class="op" id="5871871">.</span><span class="ident" id="5871872">goroutine</span>&nbsp;<span class="op" id="5871882">=</span>&nbsp;<span class="builtinfunc" id="5871884">append</span><span class="op" id="5871890">(</span><span class="ident" id="5871891">c</span><span class="op" id="5871892">.</span><span class="ident" id="5871893">goroutine</span><span class="op" id="5871902">,</span>&nbsp;<span class="keyword" id="5871904">func</span><span class="op" id="5871908">(</span><span class="op" id="5871909">)</span>&nbsp;<span class="builtintype" id="5871911">error</span>&nbsp;<span class="op" id="5871917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871921">_</span><span class="op" id="5871922">,</span>&nbsp;<span class="ident" id="5871924">err</span>&nbsp;<span class="op" id="5871928">:=</span>&nbsp;<span class="ident" id="5871931">io</span><span class="op" id="5871933">.</span><span class="ident" id="5871934">Copy</span><span class="op" id="5871938">(</span><span class="ident" id="5871939">w</span><span class="op" id="5871940">,</span>&nbsp;<span class="ident" id="5871942">pr</span><span class="op" id="5871944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871948">return</span>&nbsp;<span class="ident" id="5871955">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871960">}</span><span class="op" id="5871961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871964">return</span>&nbsp;<span class="ident" id="5871971">pw</span><span class="op" id="5871973">,</span>&nbsp;<span class="ident" id="5871975">nil</span><br>
<span class="lineno">225</span><span class="op" id="5871979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5871982">func</span>&nbsp;<span class="op" id="5871987">(</span><span class="ident" id="5871988">c</span>&nbsp;<span class="op" id="5871990">*</span><span class="ident" id="5871991">Cmd</span><span class="op" id="5871994">)</span>&nbsp;<span class="ident" id="5871996">closeDescriptors</span><span class="op" id="5872012">(</span><span class="ident" id="5872013">closers</span>&nbsp;<span class="op" id="5872021">[</span><span class="op" id="5872022">]</span><span class="ident" id="5872023">io</span><span class="op" id="5872025">.</span><span class="ident" id="5872026">Closer</span><span class="op" id="5872032">)</span>&nbsp;<span class="op" id="5872034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872037">for</span>&nbsp;<span class="ident" id="5872041">_</span><span class="op" id="5872042">,</span>&nbsp;<span class="ident" id="5872044">fd</span>&nbsp;<span class="op" id="5872047">:=</span>&nbsp;<span class="keyword" id="5872050">range</span>&nbsp;<span class="ident" id="5872056">closers</span>&nbsp;<span class="op" id="5872064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872068">fd</span><span class="op" id="5872070">.</span><span class="ident" id="5872071">Close</span><span class="op" id="5872076">(</span><span class="op" id="5872077">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5872080">}</span><br>
<span class="lineno"></span><span class="op" id="5872082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5872085">//&nbsp;Run&nbsp;starts&nbsp;the&nbsp;specified&nbsp;command&nbsp;and&nbsp;waits&nbsp;for&nbsp;it&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span><span class="comment" id="5872151">//</span><br>
<span class="lineno">235</span><span class="comment" id="5872154">//&nbsp;The&nbsp;returned&nbsp;error&nbsp;is&nbsp;nil&nbsp;if&nbsp;the&nbsp;command&nbsp;runs,&nbsp;has&nbsp;no&nbsp;problems</span><br>
<span class="lineno"></span><span class="comment" id="5872220">//&nbsp;copying&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr,&nbsp;and&nbsp;exits&nbsp;with&nbsp;a&nbsp;zero&nbsp;exit</span><br>
<span class="lineno"></span><span class="comment" id="5872285">//&nbsp;status.</span><br>
<span class="lineno"></span><span class="comment" id="5872296">//</span><br>
<span class="lineno"></span><span class="comment" id="5872299">//&nbsp;If&nbsp;the&nbsp;command&nbsp;fails&nbsp;to&nbsp;run&nbsp;or&nbsp;doesn&#39;t&nbsp;complete&nbsp;successfully,&nbsp;the</span><br>
<span class="lineno">240</span><span class="comment" id="5872368">//&nbsp;error&nbsp;is&nbsp;of&nbsp;type&nbsp;*ExitError.&nbsp;Other&nbsp;error&nbsp;types&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5872425">//&nbsp;returned&nbsp;for&nbsp;I/O&nbsp;problems.</span><br>
<span class="lineno"></span><span class="keyword" id="5872455">func</span>&nbsp;<span class="op" id="5872460">(</span><span class="ident" id="5872461">c</span>&nbsp;<span class="op" id="5872463">*</span><span class="ident" id="5872464">Cmd</span><span class="op" id="5872467">)</span>&nbsp;<span class="ident" id="5872469">Run</span><span class="op" id="5872472">(</span><span class="op" id="5872473">)</span>&nbsp;<span class="builtintype" id="5872475">error</span>&nbsp;<span class="op" id="5872481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872484">if</span>&nbsp;<span class="ident" id="5872487">err</span>&nbsp;<span class="op" id="5872491">:=</span>&nbsp;<span class="ident" id="5872494">c</span><span class="op" id="5872495">.</span><span class="ident" id="5872496">Start</span><span class="op" id="5872501">(</span><span class="op" id="5872502">)</span><span class="op" id="5872503">;</span>&nbsp;<span class="ident" id="5872505">err</span>&nbsp;<span class="op" id="5872509">!=</span>&nbsp;<span class="ident" id="5872512">nil</span>&nbsp;<span class="op" id="5872516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872520">return</span>&nbsp;<span class="ident" id="5872527">err</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5872532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872535">return</span>&nbsp;<span class="ident" id="5872542">c</span><span class="op" id="5872543">.</span><span class="ident" id="5872544">Wait</span><span class="op" id="5872548">(</span><span class="op" id="5872549">)</span><br>
<span class="lineno"></span><span class="op" id="5872551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5872554">//&nbsp;lookExtensions&nbsp;finds&nbsp;windows&nbsp;executable&nbsp;by&nbsp;its&nbsp;dir&nbsp;and&nbsp;path.</span><br>
<span class="lineno">250</span><span class="comment" id="5872618">//&nbsp;It&nbsp;uses&nbsp;LookPath&nbsp;to&nbsp;try&nbsp;appropriate&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="comment" id="5872669">//&nbsp;lookExtensions&nbsp;does&nbsp;not&nbsp;search&nbsp;PATH,&nbsp;instead&nbsp;it&nbsp;converts&nbsp;`prog`&nbsp;into&nbsp;`.\prog`.</span><br>
<span class="lineno"></span><span class="keyword" id="5872751">func</span>&nbsp;<span class="ident" id="5872756">lookExtensions</span><span class="op" id="5872770">(</span><span class="ident" id="5872771">path</span><span class="op" id="5872775">,</span>&nbsp;<span class="ident" id="5872777">dir</span>&nbsp;<span class="builtintype" id="5872781">string</span><span class="op" id="5872787">)</span>&nbsp;<span class="op" id="5872789">(</span><span class="builtintype" id="5872790">string</span><span class="op" id="5872796">,</span>&nbsp;<span class="builtintype" id="5872798">error</span><span class="op" id="5872803">)</span>&nbsp;<span class="op" id="5872805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872808">if</span>&nbsp;<span class="ident" id="5872811">filepath</span><span class="op" id="5872819">.</span><span class="ident" id="5872820">Base</span><span class="op" id="5872824">(</span><span class="ident" id="5872825">path</span><span class="op" id="5872829">)</span>&nbsp;<span class="op" id="5872831">==</span>&nbsp;<span class="ident" id="5872834">path</span>&nbsp;<span class="op" id="5872839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872843">path</span>&nbsp;<span class="op" id="5872848">=</span>&nbsp;<span class="ident" id="5872850">filepath</span><span class="op" id="5872858">.</span><span class="ident" id="5872859">Join</span><span class="op" id="5872863">(</span><span class="string" id="5872864">&#34;.&#34;</span><span class="op" id="5872867">,</span>&nbsp;<span class="ident" id="5872869">path</span><span class="op" id="5872873">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5872876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872879">if</span>&nbsp;<span class="ident" id="5872882">dir</span>&nbsp;<span class="op" id="5872886">==</span>&nbsp;<span class="string" id="5872889">&#34;&#34;</span>&nbsp;<span class="op" id="5872892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872896">return</span>&nbsp;<span class="ident" id="5872903">LookPath</span><span class="op" id="5872911">(</span><span class="ident" id="5872912">path</span><span class="op" id="5872916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5872919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872922">if</span>&nbsp;<span class="ident" id="5872925">filepath</span><span class="op" id="5872933">.</span><span class="ident" id="5872934">VolumeName</span><span class="op" id="5872944">(</span><span class="ident" id="5872945">path</span><span class="op" id="5872949">)</span>&nbsp;<span class="op" id="5872951">!=</span>&nbsp;<span class="string" id="5872954">&#34;&#34;</span>&nbsp;<span class="op" id="5872957">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872961">return</span>&nbsp;<span class="ident" id="5872968">LookPath</span><span class="op" id="5872976">(</span><span class="ident" id="5872977">path</span><span class="op" id="5872981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5872984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872987">if</span>&nbsp;<span class="builtinfunc" id="5872990">len</span><span class="op" id="5872993">(</span><span class="ident" id="5872994">path</span><span class="op" id="5872998">)</span>&nbsp;<span class="op" id="5873000">&gt;</span>&nbsp;<span class="num" id="5873002">1</span>&nbsp;<span class="op" id="5873004">&amp;&amp;</span>&nbsp;<span class="ident" id="5873007">os</span><span class="op" id="5873009">.</span><span class="ident" id="5873010">IsPathSeparator</span><span class="op" id="5873025">(</span><span class="ident" id="5873026">path</span><span class="op" id="5873030">[</span><span class="num" id="5873031">0</span><span class="op" id="5873032">]</span><span class="op" id="5873033">)</span>&nbsp;<span class="op" id="5873035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873039">return</span>&nbsp;<span class="ident" id="5873046">LookPath</span><span class="op" id="5873054">(</span><span class="ident" id="5873055">path</span><span class="op" id="5873059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5873062">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873065">dirandpath</span>&nbsp;<span class="op" id="5873076">:=</span>&nbsp;<span class="ident" id="5873079">filepath</span><span class="op" id="5873087">.</span><span class="ident" id="5873088">Join</span><span class="op" id="5873092">(</span><span class="ident" id="5873093">dir</span><span class="op" id="5873096">,</span>&nbsp;<span class="ident" id="5873098">path</span><span class="op" id="5873102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5873105">//&nbsp;We&nbsp;assume&nbsp;that&nbsp;LookPath&nbsp;will&nbsp;only&nbsp;add&nbsp;file&nbsp;extension.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873163">lp</span><span class="op" id="5873165">,</span>&nbsp;<span class="ident" id="5873167">err</span>&nbsp;<span class="op" id="5873171">:=</span>&nbsp;<span class="ident" id="5873174">LookPath</span><span class="op" id="5873182">(</span><span class="ident" id="5873183">dirandpath</span><span class="op" id="5873193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873196">if</span>&nbsp;<span class="ident" id="5873199">err</span>&nbsp;<span class="op" id="5873203">!=</span>&nbsp;<span class="ident" id="5873206">nil</span>&nbsp;<span class="op" id="5873210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873214">return</span>&nbsp;<span class="string" id="5873221">&#34;&#34;</span><span class="op" id="5873223">,</span>&nbsp;<span class="ident" id="5873225">err</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5873230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873233">ext</span>&nbsp;<span class="op" id="5873237">:=</span>&nbsp;<span class="ident" id="5873240">strings</span><span class="op" id="5873247">.</span><span class="ident" id="5873248">TrimPrefix</span><span class="op" id="5873258">(</span><span class="ident" id="5873259">lp</span><span class="op" id="5873261">,</span>&nbsp;<span class="ident" id="5873263">dirandpath</span><span class="op" id="5873273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873276">return</span>&nbsp;<span class="ident" id="5873283">path</span>&nbsp;<span class="op" id="5873288">+</span>&nbsp;<span class="ident" id="5873290">ext</span><span class="op" id="5873293">,</span>&nbsp;<span class="ident" id="5873295">nil</span><br>
<span class="lineno"></span><span class="op" id="5873299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="5873302">//&nbsp;Start&nbsp;starts&nbsp;the&nbsp;specified&nbsp;command&nbsp;but&nbsp;does&nbsp;not&nbsp;wait&nbsp;for&nbsp;it&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span><span class="comment" id="5873378">//</span><br>
<span class="lineno"></span><span class="comment" id="5873381">//&nbsp;The&nbsp;Wait&nbsp;method&nbsp;will&nbsp;return&nbsp;the&nbsp;exit&nbsp;code&nbsp;and&nbsp;release&nbsp;associated&nbsp;resources</span><br>
<span class="lineno"></span><span class="comment" id="5873459">//&nbsp;once&nbsp;the&nbsp;command&nbsp;exits.</span><br>
<span class="lineno"></span><span class="keyword" id="5873486">func</span>&nbsp;<span class="op" id="5873491">(</span><span class="ident" id="5873492">c</span>&nbsp;<span class="op" id="5873494">*</span><span class="ident" id="5873495">Cmd</span><span class="op" id="5873498">)</span>&nbsp;<span class="ident" id="5873500">Start</span><span class="op" id="5873505">(</span><span class="op" id="5873506">)</span>&nbsp;<span class="builtintype" id="5873508">error</span>&nbsp;<span class="op" id="5873514">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873517">if</span>&nbsp;<span class="ident" id="5873520">c</span><span class="op" id="5873521">.</span><span class="ident" id="5873522">lookPathErr</span>&nbsp;<span class="op" id="5873534">!=</span>&nbsp;<span class="ident" id="5873537">nil</span>&nbsp;<span class="op" id="5873541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873545">c</span><span class="op" id="5873546">.</span><span class="ident" id="5873547">closeDescriptors</span><span class="op" id="5873563">(</span><span class="ident" id="5873564">c</span><span class="op" id="5873565">.</span><span class="ident" id="5873566">closeAfterStart</span><span class="op" id="5873581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873585">c</span><span class="op" id="5873586">.</span><span class="ident" id="5873587">closeDescriptors</span><span class="op" id="5873603">(</span><span class="ident" id="5873604">c</span><span class="op" id="5873605">.</span><span class="ident" id="5873606">closeAfterWait</span><span class="op" id="5873620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873624">return</span>&nbsp;<span class="ident" id="5873631">c</span><span class="op" id="5873632">.</span><span class="ident" id="5873633">lookPathErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5873646">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873649">if</span>&nbsp;<span class="ident" id="5873652">runtime</span><span class="op" id="5873659">.</span><span class="ident" id="5873660">GOOS</span>&nbsp;<span class="op" id="5873665">==</span>&nbsp;<span class="string" id="5873668">&#34;windows&#34;</span>&nbsp;<span class="op" id="5873678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873682">lp</span><span class="op" id="5873684">,</span>&nbsp;<span class="ident" id="5873686">err</span>&nbsp;<span class="op" id="5873690">:=</span>&nbsp;<span class="ident" id="5873693">lookExtensions</span><span class="op" id="5873707">(</span><span class="ident" id="5873708">c</span><span class="op" id="5873709">.</span><span class="ident" id="5873710">Path</span><span class="op" id="5873714">,</span>&nbsp;<span class="ident" id="5873716">c</span><span class="op" id="5873717">.</span><span class="ident" id="5873718">Dir</span><span class="op" id="5873721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873725">if</span>&nbsp;<span class="ident" id="5873728">err</span>&nbsp;<span class="op" id="5873732">!=</span>&nbsp;<span class="ident" id="5873735">nil</span>&nbsp;<span class="op" id="5873739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873744">c</span><span class="op" id="5873745">.</span><span class="ident" id="5873746">closeDescriptors</span><span class="op" id="5873762">(</span><span class="ident" id="5873763">c</span><span class="op" id="5873764">.</span><span class="ident" id="5873765">closeAfterStart</span><span class="op" id="5873780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873785">c</span><span class="op" id="5873786">.</span><span class="ident" id="5873787">closeDescriptors</span><span class="op" id="5873803">(</span><span class="ident" id="5873804">c</span><span class="op" id="5873805">.</span><span class="ident" id="5873806">closeAfterWait</span><span class="op" id="5873820">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873825">return</span>&nbsp;<span class="ident" id="5873832">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5873838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873842">c</span><span class="op" id="5873843">.</span><span class="ident" id="5873844">Path</span>&nbsp;<span class="op" id="5873849">=</span>&nbsp;<span class="ident" id="5873851">lp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5873855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873858">if</span>&nbsp;<span class="ident" id="5873861">c</span><span class="op" id="5873862">.</span><span class="ident" id="5873863">Process</span>&nbsp;<span class="op" id="5873871">!=</span>&nbsp;<span class="ident" id="5873874">nil</span>&nbsp;<span class="op" id="5873878">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873882">return</span>&nbsp;<span class="ident" id="5873889">errors</span><span class="op" id="5873895">.</span><span class="ident" id="5873896">New</span><span class="op" id="5873899">(</span><span class="string" id="5873900">&#34;exec:&nbsp;already&nbsp;started&#34;</span><span class="op" id="5873923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5873926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873930">type</span>&nbsp;<span class="ident" id="5873935">F</span>&nbsp;<span class="keyword" id="5873937">func</span><span class="op" id="5873941">(</span><span class="op" id="5873942">*</span><span class="ident" id="5873943">Cmd</span><span class="op" id="5873946">)</span>&nbsp;<span class="op" id="5873948">(</span><span class="op" id="5873949">*</span><span class="ident" id="5873950">os</span><span class="op" id="5873952">.</span><span class="ident" id="5873953">File</span><span class="op" id="5873957">,</span>&nbsp;<span class="builtintype" id="5873959">error</span><span class="op" id="5873964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873967">for</span>&nbsp;<span class="ident" id="5873971">_</span><span class="op" id="5873972">,</span>&nbsp;<span class="ident" id="5873974">setupFd</span>&nbsp;<span class="op" id="5873982">:=</span>&nbsp;<span class="keyword" id="5873985">range</span>&nbsp;<span class="op" id="5873991">[</span><span class="op" id="5873992">]</span><span class="ident" id="5873993">F</span><span class="op" id="5873994">{</span><span class="op" id="5873995">(</span><span class="op" id="5873996">*</span><span class="ident" id="5873997">Cmd</span><span class="op" id="5874000">)</span><span class="op" id="5874001">.</span><span class="ident" id="5874002">stdin</span><span class="op" id="5874007">,</span>&nbsp;<span class="op" id="5874009">(</span><span class="op" id="5874010">*</span><span class="ident" id="5874011">Cmd</span><span class="op" id="5874014">)</span><span class="op" id="5874015">.</span><span class="ident" id="5874016">stdout</span><span class="op" id="5874022">,</span>&nbsp;<span class="op" id="5874024">(</span><span class="op" id="5874025">*</span><span class="ident" id="5874026">Cmd</span><span class="op" id="5874029">)</span><span class="op" id="5874030">.</span><span class="ident" id="5874031">stderr</span><span class="op" id="5874037">}</span>&nbsp;<span class="op" id="5874039">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874043">fd</span><span class="op" id="5874045">,</span>&nbsp;<span class="ident" id="5874047">err</span>&nbsp;<span class="op" id="5874051">:=</span>&nbsp;<span class="ident" id="5874054">setupFd</span><span class="op" id="5874061">(</span><span class="ident" id="5874062">c</span><span class="op" id="5874063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874067">if</span>&nbsp;<span class="ident" id="5874070">err</span>&nbsp;<span class="op" id="5874074">!=</span>&nbsp;<span class="ident" id="5874077">nil</span>&nbsp;<span class="op" id="5874081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874086">c</span><span class="op" id="5874087">.</span><span class="ident" id="5874088">closeDescriptors</span><span class="op" id="5874104">(</span><span class="ident" id="5874105">c</span><span class="op" id="5874106">.</span><span class="ident" id="5874107">closeAfterStart</span><span class="op" id="5874122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874127">c</span><span class="op" id="5874128">.</span><span class="ident" id="5874129">closeDescriptors</span><span class="op" id="5874145">(</span><span class="ident" id="5874146">c</span><span class="op" id="5874147">.</span><span class="ident" id="5874148">closeAfterWait</span><span class="op" id="5874162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874167">return</span>&nbsp;<span class="ident" id="5874174">err</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874184">c</span><span class="op" id="5874185">.</span><span class="ident" id="5874186">childFiles</span>&nbsp;<span class="op" id="5874197">=</span>&nbsp;<span class="builtinfunc" id="5874199">append</span><span class="op" id="5874205">(</span><span class="ident" id="5874206">c</span><span class="op" id="5874207">.</span><span class="ident" id="5874208">childFiles</span><span class="op" id="5874218">,</span>&nbsp;<span class="ident" id="5874220">fd</span><span class="op" id="5874222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874228">c</span><span class="op" id="5874229">.</span><span class="ident" id="5874230">childFiles</span>&nbsp;<span class="op" id="5874241">=</span>&nbsp;<span class="builtinfunc" id="5874243">append</span><span class="op" id="5874249">(</span><span class="ident" id="5874250">c</span><span class="op" id="5874251">.</span><span class="ident" id="5874252">childFiles</span><span class="op" id="5874262">,</span>&nbsp;<span class="ident" id="5874264">c</span><span class="op" id="5874265">.</span><span class="ident" id="5874266">ExtraFiles</span><span class="op" id="5874276">...</span><span class="op" id="5874279">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874283">var</span>&nbsp;<span class="ident" id="5874287">err</span>&nbsp;<span class="builtintype" id="5874291">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874298">c</span><span class="op" id="5874299">.</span><span class="ident" id="5874300">Process</span><span class="op" id="5874307">,</span>&nbsp;<span class="ident" id="5874309">err</span>&nbsp;<span class="op" id="5874313">=</span>&nbsp;<span class="ident" id="5874315">os</span><span class="op" id="5874317">.</span><span class="ident" id="5874318">StartProcess</span><span class="op" id="5874330">(</span><span class="ident" id="5874331">c</span><span class="op" id="5874332">.</span><span class="ident" id="5874333">Path</span><span class="op" id="5874337">,</span>&nbsp;<span class="ident" id="5874339">c</span><span class="op" id="5874340">.</span><span class="ident" id="5874341">argv</span><span class="op" id="5874345">(</span><span class="op" id="5874346">)</span><span class="op" id="5874347">,</span>&nbsp;<span class="op" id="5874349">&amp;</span><span class="ident" id="5874350">os</span><span class="op" id="5874352">.</span><span class="ident" id="5874353">ProcAttr</span><span class="op" id="5874361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874365">Dir</span><span class="op" id="5874368">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5874372">c</span><span class="op" id="5874373">.</span><span class="ident" id="5874374">Dir</span><span class="op" id="5874377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874381">Files</span><span class="op" id="5874386">:</span>&nbsp;<span class="ident" id="5874388">c</span><span class="op" id="5874389">.</span><span class="ident" id="5874390">childFiles</span><span class="op" id="5874400">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874404">Env</span><span class="op" id="5874407">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5874411">c</span><span class="op" id="5874412">.</span><span class="ident" id="5874413">envv</span><span class="op" id="5874417">(</span><span class="op" id="5874418">)</span><span class="op" id="5874419">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874423">Sys</span><span class="op" id="5874426">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5874430">c</span><span class="op" id="5874431">.</span><span class="ident" id="5874432">SysProcAttr</span><span class="op" id="5874443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874446">}</span><span class="op" id="5874447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874450">if</span>&nbsp;<span class="ident" id="5874453">err</span>&nbsp;<span class="op" id="5874457">!=</span>&nbsp;<span class="ident" id="5874460">nil</span>&nbsp;<span class="op" id="5874464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874468">c</span><span class="op" id="5874469">.</span><span class="ident" id="5874470">closeDescriptors</span><span class="op" id="5874486">(</span><span class="ident" id="5874487">c</span><span class="op" id="5874488">.</span><span class="ident" id="5874489">closeAfterStart</span><span class="op" id="5874504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874508">c</span><span class="op" id="5874509">.</span><span class="ident" id="5874510">closeDescriptors</span><span class="op" id="5874526">(</span><span class="ident" id="5874527">c</span><span class="op" id="5874528">.</span><span class="ident" id="5874529">closeAfterWait</span><span class="op" id="5874543">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874547">return</span>&nbsp;<span class="ident" id="5874554">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874563">c</span><span class="op" id="5874564">.</span><span class="ident" id="5874565">closeDescriptors</span><span class="op" id="5874581">(</span><span class="ident" id="5874582">c</span><span class="op" id="5874583">.</span><span class="ident" id="5874584">closeAfterStart</span><span class="op" id="5874599">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874603">c</span><span class="op" id="5874604">.</span><span class="ident" id="5874605">errch</span>&nbsp;<span class="op" id="5874611">=</span>&nbsp;<span class="builtinfunc" id="5874613">make</span><span class="op" id="5874617">(</span><span class="keyword" id="5874618">chan</span>&nbsp;<span class="builtintype" id="5874623">error</span><span class="op" id="5874628">,</span>&nbsp;<span class="builtinfunc" id="5874630">len</span><span class="op" id="5874633">(</span><span class="ident" id="5874634">c</span><span class="op" id="5874635">.</span><span class="ident" id="5874636">goroutine</span><span class="op" id="5874645">)</span><span class="op" id="5874646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874649">for</span>&nbsp;<span class="ident" id="5874653">_</span><span class="op" id="5874654">,</span>&nbsp;<span class="ident" id="5874656">fn</span>&nbsp;<span class="op" id="5874659">:=</span>&nbsp;<span class="keyword" id="5874662">range</span>&nbsp;<span class="ident" id="5874668">c</span><span class="op" id="5874669">.</span><span class="ident" id="5874670">goroutine</span>&nbsp;<span class="op" id="5874680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874684">go</span>&nbsp;<span class="keyword" id="5874687">func</span><span class="op" id="5874691">(</span><span class="ident" id="5874692">fn</span>&nbsp;<span class="keyword" id="5874695">func</span><span class="op" id="5874699">(</span><span class="op" id="5874700">)</span>&nbsp;<span class="builtintype" id="5874702">error</span><span class="op" id="5874707">)</span>&nbsp;<span class="op" id="5874709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874714">c</span><span class="op" id="5874715">.</span><span class="ident" id="5874716">errch</span>&nbsp;<span class="op" id="5874722">&lt;-</span>&nbsp;<span class="ident" id="5874725">fn</span><span class="op" id="5874727">(</span><span class="op" id="5874728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874732">}</span><span class="op" id="5874733">(</span><span class="ident" id="5874734">fn</span><span class="op" id="5874736">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874743">return</span>&nbsp;<span class="ident" id="5874750">nil</span><br>
<span class="lineno"></span><span class="op" id="5874754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="comment" id="5874757">//&nbsp;An&nbsp;ExitError&nbsp;reports&nbsp;an&nbsp;unsuccessful&nbsp;exit&nbsp;by&nbsp;a&nbsp;command.</span><br>
<span class="lineno"></span><span class="keyword" id="5874816">type</span>&nbsp;<span class="ident" id="5874821">ExitError</span>&nbsp;<span class="keyword" id="5874831">struct</span>&nbsp;<span class="op" id="5874838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874841">*</span><span class="ident" id="5874842">os</span><span class="op" id="5874844">.</span><span class="ident" id="5874845">ProcessState</span><br>
<span class="lineno"></span><span class="op" id="5874858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="keyword" id="5874861">func</span>&nbsp;<span class="op" id="5874866">(</span><span class="ident" id="5874867">e</span>&nbsp;<span class="op" id="5874869">*</span><span class="ident" id="5874870">ExitError</span><span class="op" id="5874879">)</span>&nbsp;<span class="ident" id="5874881">Error</span><span class="op" id="5874886">(</span><span class="op" id="5874887">)</span>&nbsp;<span class="builtintype" id="5874889">string</span>&nbsp;<span class="op" id="5874896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874899">return</span>&nbsp;<span class="ident" id="5874906">e</span><span class="op" id="5874907">.</span><span class="ident" id="5874908">ProcessState</span><span class="op" id="5874920">.</span><span class="ident" id="5874921">String</span><span class="op" id="5874927">(</span><span class="op" id="5874928">)</span><br>
<span class="lineno"></span><span class="op" id="5874930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5874933">//&nbsp;Wait&nbsp;waits&nbsp;for&nbsp;the&nbsp;command&nbsp;to&nbsp;exit.</span><br>
<span class="lineno">345</span><span class="comment" id="5874972">//&nbsp;It&nbsp;must&nbsp;have&nbsp;been&nbsp;started&nbsp;by&nbsp;Start.</span><br>
<span class="lineno"></span><span class="comment" id="5875011">//</span><br>
<span class="lineno"></span><span class="comment" id="5875014">//&nbsp;The&nbsp;returned&nbsp;error&nbsp;is&nbsp;nil&nbsp;if&nbsp;the&nbsp;command&nbsp;runs,&nbsp;has&nbsp;no&nbsp;problems</span><br>
<span class="lineno"></span><span class="comment" id="5875080">//&nbsp;copying&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr,&nbsp;and&nbsp;exits&nbsp;with&nbsp;a&nbsp;zero&nbsp;exit</span><br>
<span class="lineno"></span><span class="comment" id="5875145">//&nbsp;status.</span><br>
<span class="lineno">350</span><span class="comment" id="5875156">//</span><br>
<span class="lineno"></span><span class="comment" id="5875159">//&nbsp;If&nbsp;the&nbsp;command&nbsp;fails&nbsp;to&nbsp;run&nbsp;or&nbsp;doesn&#39;t&nbsp;complete&nbsp;successfully,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5875228">//&nbsp;error&nbsp;is&nbsp;of&nbsp;type&nbsp;*ExitError.&nbsp;Other&nbsp;error&nbsp;types&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5875285">//&nbsp;returned&nbsp;for&nbsp;I/O&nbsp;problems.</span><br>
<span class="lineno"></span><span class="comment" id="5875315">//</span><br>
<span class="lineno">355</span><span class="comment" id="5875318">//&nbsp;Wait&nbsp;releases&nbsp;any&nbsp;resources&nbsp;associated&nbsp;with&nbsp;the&nbsp;Cmd.</span><br>
<span class="lineno"></span><span class="keyword" id="5875374">func</span>&nbsp;<span class="op" id="5875379">(</span><span class="ident" id="5875380">c</span>&nbsp;<span class="op" id="5875382">*</span><span class="ident" id="5875383">Cmd</span><span class="op" id="5875386">)</span>&nbsp;<span class="ident" id="5875388">Wait</span><span class="op" id="5875392">(</span><span class="op" id="5875393">)</span>&nbsp;<span class="builtintype" id="5875395">error</span>&nbsp;<span class="op" id="5875401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875404">if</span>&nbsp;<span class="ident" id="5875407">c</span><span class="op" id="5875408">.</span><span class="ident" id="5875409">Process</span>&nbsp;<span class="op" id="5875417">==</span>&nbsp;<span class="ident" id="5875420">nil</span>&nbsp;<span class="op" id="5875424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875428">return</span>&nbsp;<span class="ident" id="5875435">errors</span><span class="op" id="5875441">.</span><span class="ident" id="5875442">New</span><span class="op" id="5875445">(</span><span class="string" id="5875446">&#34;exec:&nbsp;not&nbsp;started&#34;</span><span class="op" id="5875465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5875468">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875471">if</span>&nbsp;<span class="ident" id="5875474">c</span><span class="op" id="5875475">.</span><span class="ident" id="5875476">finished</span>&nbsp;<span class="op" id="5875485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875489">return</span>&nbsp;<span class="ident" id="5875496">errors</span><span class="op" id="5875502">.</span><span class="ident" id="5875503">New</span><span class="op" id="5875506">(</span><span class="string" id="5875507">&#34;exec:&nbsp;Wait&nbsp;was&nbsp;already&nbsp;called&#34;</span><span class="op" id="5875538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5875541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5875544">c</span><span class="op" id="5875545">.</span><span class="ident" id="5875546">finished</span>&nbsp;<span class="op" id="5875555">=</span>&nbsp;<span class="builtintype" id="5875557">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5875563">state</span><span class="op" id="5875568">,</span>&nbsp;<span class="ident" id="5875570">err</span>&nbsp;<span class="op" id="5875574">:=</span>&nbsp;<span class="ident" id="5875577">c</span><span class="op" id="5875578">.</span><span class="ident" id="5875579">Process</span><span class="op" id="5875586">.</span><span class="ident" id="5875587">Wait</span><span class="op" id="5875591">(</span><span class="op" id="5875592">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5875595">c</span><span class="op" id="5875596">.</span><span class="ident" id="5875597">ProcessState</span>&nbsp;<span class="op" id="5875610">=</span>&nbsp;<span class="ident" id="5875612">state</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875620">var</span>&nbsp;<span class="ident" id="5875624">copyError</span>&nbsp;<span class="builtintype" id="5875634">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875641">for</span>&nbsp;<span class="keyword" id="5875645">range</span>&nbsp;<span class="ident" id="5875651">c</span><span class="op" id="5875652">.</span><span class="ident" id="5875653">goroutine</span>&nbsp;<span class="op" id="5875663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875667">if</span>&nbsp;<span class="ident" id="5875670">err</span>&nbsp;<span class="op" id="5875674">:=</span>&nbsp;<span class="op" id="5875677">&lt;-</span><span class="ident" id="5875679">c</span><span class="op" id="5875680">.</span><span class="ident" id="5875681">errch</span><span class="op" id="5875686">;</span>&nbsp;<span class="ident" id="5875688">err</span>&nbsp;<span class="op" id="5875692">!=</span>&nbsp;<span class="ident" id="5875695">nil</span>&nbsp;<span class="op" id="5875699">&amp;&amp;</span>&nbsp;<span class="ident" id="5875702">copyError</span>&nbsp;<span class="op" id="5875712">==</span>&nbsp;<span class="ident" id="5875715">nil</span>&nbsp;<span class="op" id="5875719">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5875724">copyError</span>&nbsp;<span class="op" id="5875734">=</span>&nbsp;<span class="ident" id="5875736">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5875742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5875745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5875749">c</span><span class="op" id="5875750">.</span><span class="ident" id="5875751">closeDescriptors</span><span class="op" id="5875767">(</span><span class="ident" id="5875768">c</span><span class="op" id="5875769">.</span><span class="ident" id="5875770">closeAfterWait</span><span class="op" id="5875784">)</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875788">if</span>&nbsp;<span class="ident" id="5875791">err</span>&nbsp;<span class="op" id="5875795">!=</span>&nbsp;<span class="ident" id="5875798">nil</span>&nbsp;<span class="op" id="5875802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875806">return</span>&nbsp;<span class="ident" id="5875813">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5875818">}</span>&nbsp;<span class="keyword" id="5875820">else</span>&nbsp;<span class="keyword" id="5875825">if</span>&nbsp;<span class="op" id="5875828">!</span><span class="ident" id="5875829">state</span><span class="op" id="5875834">.</span><span class="ident" id="5875835">Success</span><span class="op" id="5875842">(</span><span class="op" id="5875843">)</span>&nbsp;<span class="op" id="5875845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875849">return</span>&nbsp;<span class="op" id="5875856">&amp;</span><span class="ident" id="5875857">ExitError</span><span class="op" id="5875866">{</span><span class="ident" id="5875867">state</span><span class="op" id="5875872">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5875875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875879">return</span>&nbsp;<span class="ident" id="5875886">copyError</span><br>
<span class="lineno"></span><span class="op" id="5875896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="5875899">//&nbsp;Output&nbsp;runs&nbsp;the&nbsp;command&nbsp;and&nbsp;returns&nbsp;its&nbsp;standard&nbsp;output.</span><br>
<span class="lineno"></span><span class="keyword" id="5875959">func</span>&nbsp;<span class="op" id="5875964">(</span><span class="ident" id="5875965">c</span>&nbsp;<span class="op" id="5875967">*</span><span class="ident" id="5875968">Cmd</span><span class="op" id="5875971">)</span>&nbsp;<span class="ident" id="5875973">Output</span><span class="op" id="5875979">(</span><span class="op" id="5875980">)</span>&nbsp;<span class="op" id="5875982">(</span><span class="op" id="5875983">[</span><span class="op" id="5875984">]</span><span class="builtintype" id="5875985">byte</span><span class="op" id="5875989">,</span>&nbsp;<span class="builtintype" id="5875991">error</span><span class="op" id="5875996">)</span>&nbsp;<span class="op" id="5875998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876001">if</span>&nbsp;<span class="ident" id="5876004">c</span><span class="op" id="5876005">.</span><span class="ident" id="5876006">Stdout</span>&nbsp;<span class="op" id="5876013">!=</span>&nbsp;<span class="ident" id="5876016">nil</span>&nbsp;<span class="op" id="5876020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876024">return</span>&nbsp;<span class="ident" id="5876031">nil</span><span class="op" id="5876034">,</span>&nbsp;<span class="ident" id="5876036">errors</span><span class="op" id="5876042">.</span><span class="ident" id="5876043">New</span><span class="op" id="5876046">(</span><span class="string" id="5876047">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5876073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5876076">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876079">var</span>&nbsp;<span class="ident" id="5876083">b</span>&nbsp;<span class="ident" id="5876085">bytes</span><span class="op" id="5876090">.</span><span class="ident" id="5876091">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876099">c</span><span class="op" id="5876100">.</span><span class="ident" id="5876101">Stdout</span>&nbsp;<span class="op" id="5876108">=</span>&nbsp;<span class="op" id="5876110">&amp;</span><span class="ident" id="5876111">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876114">err</span>&nbsp;<span class="op" id="5876118">:=</span>&nbsp;<span class="ident" id="5876121">c</span><span class="op" id="5876122">.</span><span class="ident" id="5876123">Run</span><span class="op" id="5876126">(</span><span class="op" id="5876127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876130">return</span>&nbsp;<span class="ident" id="5876137">b</span><span class="op" id="5876138">.</span><span class="ident" id="5876139">Bytes</span><span class="op" id="5876144">(</span><span class="op" id="5876145">)</span><span class="op" id="5876146">,</span>&nbsp;<span class="ident" id="5876148">err</span><br>
<span class="lineno"></span><span class="op" id="5876152">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="5876155">//&nbsp;CombinedOutput&nbsp;runs&nbsp;the&nbsp;command&nbsp;and&nbsp;returns&nbsp;its&nbsp;combined&nbsp;standard</span><br>
<span class="lineno"></span><span class="comment" id="5876224">//&nbsp;output&nbsp;and&nbsp;standard&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5876254">func</span>&nbsp;<span class="op" id="5876259">(</span><span class="ident" id="5876260">c</span>&nbsp;<span class="op" id="5876262">*</span><span class="ident" id="5876263">Cmd</span><span class="op" id="5876266">)</span>&nbsp;<span class="ident" id="5876268">CombinedOutput</span><span class="op" id="5876282">(</span><span class="op" id="5876283">)</span>&nbsp;<span class="op" id="5876285">(</span><span class="op" id="5876286">[</span><span class="op" id="5876287">]</span><span class="builtintype" id="5876288">byte</span><span class="op" id="5876292">,</span>&nbsp;<span class="builtintype" id="5876294">error</span><span class="op" id="5876299">)</span>&nbsp;<span class="op" id="5876301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876304">if</span>&nbsp;<span class="ident" id="5876307">c</span><span class="op" id="5876308">.</span><span class="ident" id="5876309">Stdout</span>&nbsp;<span class="op" id="5876316">!=</span>&nbsp;<span class="ident" id="5876319">nil</span>&nbsp;<span class="op" id="5876323">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876327">return</span>&nbsp;<span class="ident" id="5876334">nil</span><span class="op" id="5876337">,</span>&nbsp;<span class="ident" id="5876339">errors</span><span class="op" id="5876345">.</span><span class="ident" id="5876346">New</span><span class="op" id="5876349">(</span><span class="string" id="5876350">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5876376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5876379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876382">if</span>&nbsp;<span class="ident" id="5876385">c</span><span class="op" id="5876386">.</span><span class="ident" id="5876387">Stderr</span>&nbsp;<span class="op" id="5876394">!=</span>&nbsp;<span class="ident" id="5876397">nil</span>&nbsp;<span class="op" id="5876401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876405">return</span>&nbsp;<span class="ident" id="5876412">nil</span><span class="op" id="5876415">,</span>&nbsp;<span class="ident" id="5876417">errors</span><span class="op" id="5876423">.</span><span class="ident" id="5876424">New</span><span class="op" id="5876427">(</span><span class="string" id="5876428">&#34;exec:&nbsp;Stderr&nbsp;already&nbsp;set&#34;</span><span class="op" id="5876454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5876457">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876460">var</span>&nbsp;<span class="ident" id="5876464">b</span>&nbsp;<span class="ident" id="5876466">bytes</span><span class="op" id="5876471">.</span><span class="ident" id="5876472">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876480">c</span><span class="op" id="5876481">.</span><span class="ident" id="5876482">Stdout</span>&nbsp;<span class="op" id="5876489">=</span>&nbsp;<span class="op" id="5876491">&amp;</span><span class="ident" id="5876492">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876495">c</span><span class="op" id="5876496">.</span><span class="ident" id="5876497">Stderr</span>&nbsp;<span class="op" id="5876504">=</span>&nbsp;<span class="op" id="5876506">&amp;</span><span class="ident" id="5876507">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876510">err</span>&nbsp;<span class="op" id="5876514">:=</span>&nbsp;<span class="ident" id="5876517">c</span><span class="op" id="5876518">.</span><span class="ident" id="5876519">Run</span><span class="op" id="5876522">(</span><span class="op" id="5876523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876526">return</span>&nbsp;<span class="ident" id="5876533">b</span><span class="op" id="5876534">.</span><span class="ident" id="5876535">Bytes</span><span class="op" id="5876540">(</span><span class="op" id="5876541">)</span><span class="op" id="5876542">,</span>&nbsp;<span class="ident" id="5876544">err</span><br>
<span class="lineno">410</span><span class="op" id="5876548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5876551">//&nbsp;StdinPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5876619">//&nbsp;standard&nbsp;input&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5876662">//&nbsp;The&nbsp;pipe&nbsp;will&nbsp;be&nbsp;closed&nbsp;automatically&nbsp;after&nbsp;Wait&nbsp;sees&nbsp;the&nbsp;command&nbsp;exit.</span><br>
<span class="lineno">415</span><span class="comment" id="5876737">//&nbsp;A&nbsp;caller&nbsp;need&nbsp;only&nbsp;call&nbsp;Close&nbsp;to&nbsp;force&nbsp;the&nbsp;pipe&nbsp;to&nbsp;close&nbsp;sooner.</span><br>
<span class="lineno"></span><span class="comment" id="5876805">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;the&nbsp;command&nbsp;being&nbsp;run&nbsp;will&nbsp;not&nbsp;exit&nbsp;until&nbsp;standard&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="5876881">//&nbsp;is&nbsp;closed,&nbsp;the&nbsp;caller&nbsp;must&nbsp;close&nbsp;the&nbsp;pipe.</span><br>
<span class="lineno"></span><span class="keyword" id="5876927">func</span>&nbsp;<span class="op" id="5876932">(</span><span class="ident" id="5876933">c</span>&nbsp;<span class="op" id="5876935">*</span><span class="ident" id="5876936">Cmd</span><span class="op" id="5876939">)</span>&nbsp;<span class="ident" id="5876941">StdinPipe</span><span class="op" id="5876950">(</span><span class="op" id="5876951">)</span>&nbsp;<span class="op" id="5876953">(</span><span class="ident" id="5876954">io</span><span class="op" id="5876956">.</span><span class="ident" id="5876957">WriteCloser</span><span class="op" id="5876968">,</span>&nbsp;<span class="builtintype" id="5876970">error</span><span class="op" id="5876975">)</span>&nbsp;<span class="op" id="5876977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876980">if</span>&nbsp;<span class="ident" id="5876983">c</span><span class="op" id="5876984">.</span><span class="ident" id="5876985">Stdin</span>&nbsp;<span class="op" id="5876991">!=</span>&nbsp;<span class="ident" id="5876994">nil</span>&nbsp;<span class="op" id="5876998">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5877002">return</span>&nbsp;<span class="ident" id="5877009">nil</span><span class="op" id="5877012">,</span>&nbsp;<span class="ident" id="5877014">errors</span><span class="op" id="5877020">.</span><span class="ident" id="5877021">New</span><span class="op" id="5877024">(</span><span class="string" id="5877025">&#34;exec:&nbsp;Stdin&nbsp;already&nbsp;set&#34;</span><span class="op" id="5877050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5877053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5877056">if</span>&nbsp;<span class="ident" id="5877059">c</span><span class="op" id="5877060">.</span><span class="ident" id="5877061">Process</span>&nbsp;<span class="op" id="5877069">!=</span>&nbsp;<span class="ident" id="5877072">nil</span>&nbsp;<span class="op" id="5877076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5877080">return</span>&nbsp;<span class="ident" id="5877087">nil</span><span class="op" id="5877090">,</span>&nbsp;<span class="ident" id="5877092">errors</span><span class="op" id="5877098">.</span><span class="ident" id="5877099">New</span><span class="op" id="5877102">(</span><span class="string" id="5877103">&#34;exec:&nbsp;StdinPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5877142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5877145">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5877148">pr</span><span class="op" id="5877150">,</span>&nbsp;<span class="ident" id="5877152">pw</span><span class="op" id="5877154">,</span>&nbsp;<span class="ident" id="5877156">err</span>&nbsp;<span class="op" id="5877160">:=</span>&nbsp;<span class="ident" id="5877163">os</span><span class="op" id="5877165">.</span><span class="ident" id="5877166">Pipe</span><span class="op" id="5877170">(</span><span class="op" id="5877171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5877174">if</span>&nbsp;<span class="ident" id="5877177">err</span>&nbsp;<span class="op" id="5877181">!=</span>&nbsp;<span class="ident" id="5877184">nil</span>&nbsp;<span class="op" id="5877188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5877192">return</span>&nbsp;<span class="ident" id="5877199">nil</span><span class="op" id="5877202">,</span>&nbsp;<span class="ident" id="5877204">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5877209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5877212">c</span><span class="op" id="5877213">.</span><span class="ident" id="5877214">Stdin</span>&nbsp;<span class="op" id="5877220">=</span>&nbsp;<span class="ident" id="5877222">pr</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5877226">c</span><span class="op" id="5877227">.</span><span class="ident" id="5877228">closeAfterStart</span>&nbsp;<span class="op" id="5877244">=</span>&nbsp;<span class="builtinfunc" id="5877246">append</span><span class="op" id="5877252">(</span><span class="ident" id="5877253">c</span><span class="op" id="5877254">.</span><span class="ident" id="5877255">closeAfterStart</span><span class="op" id="5877270">,</span>&nbsp;<span class="ident" id="5877272">pr</span><span class="op" id="5877274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5877277">wc</span>&nbsp;<span class="op" id="5877280">:=</span>&nbsp;<span class="op" id="5877283">&amp;</span><span class="ident" id="5877284">closeOnce</span><span class="op" id="5877293">{</span><span class="ident" id="5877294">File</span><span class="op" id="5877298">:</span>&nbsp;<span class="ident" id="5877300">pw</span><span class="op" id="5877302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5877305">c</span><span class="op" id="5877306">.</span><span class="ident" id="5877307">closeAfterWait</span>&nbsp;<span class="op" id="5877322">=</span>&nbsp;<span class="builtinfunc" id="5877324">append</span><span class="op" id="5877330">(</span><span class="ident" id="5877331">c</span><span class="op" id="5877332">.</span><span class="ident" id="5877333">closeAfterWait</span><span class="op" id="5877347">,</span>&nbsp;<span class="ident" id="5877349">wc</span><span class="op" id="5877351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5877354">return</span>&nbsp;<span class="ident" id="5877361">wc</span><span class="op" id="5877363">,</span>&nbsp;<span class="ident" id="5877365">nil</span><br>
<span class="lineno"></span><span class="op" id="5877369">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="5877372">type</span>&nbsp;<span class="ident" id="5877377">closeOnce</span>&nbsp;<span class="keyword" id="5877387">struct</span>&nbsp;<span class="op" id="5877394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5877397">*</span><span class="ident" id="5877398">os</span><span class="op" id="5877400">.</span><span class="ident" id="5877401">File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5877408">once</span>&nbsp;<span class="ident" id="5877413">sync</span><span class="op" id="5877417">.</span><span class="ident" id="5877418">Once</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5877424">err</span>&nbsp;&nbsp;<span class="builtintype" id="5877429">error</span><br>
<span class="lineno"></span><span class="op" id="5877435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5877438">func</span>&nbsp;<span class="op" id="5877443">(</span><span class="ident" id="5877444">c</span>&nbsp;<span class="op" id="5877446">*</span><span class="ident" id="5877447">closeOnce</span><span class="op" id="5877456">)</span>&nbsp;<span class="ident" id="5877458">Close</span><span class="op" id="5877463">(</span><span class="op" id="5877464">)</span>&nbsp;<span class="builtintype" id="5877466">error</span>&nbsp;<span class="op" id="5877472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5877475">c</span><span class="op" id="5877476">.</span><span class="ident" id="5877477">once</span><span class="op" id="5877481">.</span><span class="ident" id="5877482">Do</span><span class="op" id="5877484">(</span><span class="ident" id="5877485">c</span><span class="op" id="5877486">.</span><span class="builtinfunc" id="5877487">close</span><span class="op" id="5877492">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5877495">return</span>&nbsp;<span class="ident" id="5877502">c</span><span class="op" id="5877503">.</span><span class="ident" id="5877504">err</span><br>
<span class="lineno"></span><span class="op" id="5877508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5877511">func</span>&nbsp;<span class="op" id="5877516">(</span><span class="ident" id="5877517">c</span>&nbsp;<span class="op" id="5877519">*</span><span class="ident" id="5877520">closeOnce</span><span class="op" id="5877529">)</span>&nbsp;<span class="builtinfunc" id="5877531">close</span><span class="op" id="5877536">(</span><span class="op" id="5877537">)</span>&nbsp;<span class="op" id="5877539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5877542">c</span><span class="op" id="5877543">.</span><span class="ident" id="5877544">err</span>&nbsp;<span class="op" id="5877548">=</span>&nbsp;<span class="ident" id="5877550">c</span><span class="op" id="5877551">.</span><span class="ident" id="5877552">File</span><span class="op" id="5877556">.</span><span class="ident" id="5877557">Close</span><span class="op" id="5877562">(</span><span class="op" id="5877563">)</span><br>
<span class="lineno">450</span><span class="op" id="5877565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5877568">//&nbsp;StdoutPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5877637">//&nbsp;standard&nbsp;output&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5877681">//</span><br>
<span class="lineno">455</span><span class="comment" id="5877684">//&nbsp;Wait&nbsp;will&nbsp;close&nbsp;the&nbsp;pipe&nbsp;after&nbsp;seeing&nbsp;the&nbsp;command&nbsp;exit,&nbsp;so&nbsp;most&nbsp;callers</span><br>
<span class="lineno"></span><span class="comment" id="5877759">//&nbsp;need&nbsp;not&nbsp;close&nbsp;the&nbsp;pipe&nbsp;themselves;&nbsp;however,&nbsp;an&nbsp;implication&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5877830">//&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Wait&nbsp;before&nbsp;all&nbsp;reads&nbsp;from&nbsp;the&nbsp;pipe&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="comment" id="5877909">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason,&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Run&nbsp;when&nbsp;using&nbsp;StdoutPipe.</span><br>
<span class="lineno"></span><span class="comment" id="5877984">//&nbsp;See&nbsp;the&nbsp;example&nbsp;for&nbsp;idiomatic&nbsp;usage.</span><br>
<span class="lineno">460</span><span class="keyword" id="5878024">func</span>&nbsp;<span class="op" id="5878029">(</span><span class="ident" id="5878030">c</span>&nbsp;<span class="op" id="5878032">*</span><span class="ident" id="5878033">Cmd</span><span class="op" id="5878036">)</span>&nbsp;<span class="ident" id="5878038">StdoutPipe</span><span class="op" id="5878048">(</span><span class="op" id="5878049">)</span>&nbsp;<span class="op" id="5878051">(</span><span class="ident" id="5878052">io</span><span class="op" id="5878054">.</span><span class="ident" id="5878055">ReadCloser</span><span class="op" id="5878065">,</span>&nbsp;<span class="builtintype" id="5878067">error</span><span class="op" id="5878072">)</span>&nbsp;<span class="op" id="5878074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878077">if</span>&nbsp;<span class="ident" id="5878080">c</span><span class="op" id="5878081">.</span><span class="ident" id="5878082">Stdout</span>&nbsp;<span class="op" id="5878089">!=</span>&nbsp;<span class="ident" id="5878092">nil</span>&nbsp;<span class="op" id="5878096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878100">return</span>&nbsp;<span class="ident" id="5878107">nil</span><span class="op" id="5878110">,</span>&nbsp;<span class="ident" id="5878112">errors</span><span class="op" id="5878118">.</span><span class="ident" id="5878119">New</span><span class="op" id="5878122">(</span><span class="string" id="5878123">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5878149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5878152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878155">if</span>&nbsp;<span class="ident" id="5878158">c</span><span class="op" id="5878159">.</span><span class="ident" id="5878160">Process</span>&nbsp;<span class="op" id="5878168">!=</span>&nbsp;<span class="ident" id="5878171">nil</span>&nbsp;<span class="op" id="5878175">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878179">return</span>&nbsp;<span class="ident" id="5878186">nil</span><span class="op" id="5878189">,</span>&nbsp;<span class="ident" id="5878191">errors</span><span class="op" id="5878197">.</span><span class="ident" id="5878198">New</span><span class="op" id="5878201">(</span><span class="string" id="5878202">&#34;exec:&nbsp;StdoutPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5878242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5878245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878248">pr</span><span class="op" id="5878250">,</span>&nbsp;<span class="ident" id="5878252">pw</span><span class="op" id="5878254">,</span>&nbsp;<span class="ident" id="5878256">err</span>&nbsp;<span class="op" id="5878260">:=</span>&nbsp;<span class="ident" id="5878263">os</span><span class="op" id="5878265">.</span><span class="ident" id="5878266">Pipe</span><span class="op" id="5878270">(</span><span class="op" id="5878271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878274">if</span>&nbsp;<span class="ident" id="5878277">err</span>&nbsp;<span class="op" id="5878281">!=</span>&nbsp;<span class="ident" id="5878284">nil</span>&nbsp;<span class="op" id="5878288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878292">return</span>&nbsp;<span class="ident" id="5878299">nil</span><span class="op" id="5878302">,</span>&nbsp;<span class="ident" id="5878304">err</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5878309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878312">c</span><span class="op" id="5878313">.</span><span class="ident" id="5878314">Stdout</span>&nbsp;<span class="op" id="5878321">=</span>&nbsp;<span class="ident" id="5878323">pw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878327">c</span><span class="op" id="5878328">.</span><span class="ident" id="5878329">closeAfterStart</span>&nbsp;<span class="op" id="5878345">=</span>&nbsp;<span class="builtinfunc" id="5878347">append</span><span class="op" id="5878353">(</span><span class="ident" id="5878354">c</span><span class="op" id="5878355">.</span><span class="ident" id="5878356">closeAfterStart</span><span class="op" id="5878371">,</span>&nbsp;<span class="ident" id="5878373">pw</span><span class="op" id="5878375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878378">c</span><span class="op" id="5878379">.</span><span class="ident" id="5878380">closeAfterWait</span>&nbsp;<span class="op" id="5878395">=</span>&nbsp;<span class="builtinfunc" id="5878397">append</span><span class="op" id="5878403">(</span><span class="ident" id="5878404">c</span><span class="op" id="5878405">.</span><span class="ident" id="5878406">closeAfterWait</span><span class="op" id="5878420">,</span>&nbsp;<span class="ident" id="5878422">pr</span><span class="op" id="5878424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878427">return</span>&nbsp;<span class="ident" id="5878434">pr</span><span class="op" id="5878436">,</span>&nbsp;<span class="ident" id="5878438">nil</span><br>
<span class="lineno">475</span><span class="op" id="5878442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5878445">//&nbsp;StderrPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5878514">//&nbsp;standard&nbsp;error&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5878557">//</span><br>
<span class="lineno">480</span><span class="comment" id="5878560">//&nbsp;Wait&nbsp;will&nbsp;close&nbsp;the&nbsp;pipe&nbsp;after&nbsp;seeing&nbsp;the&nbsp;command&nbsp;exit,&nbsp;so&nbsp;most&nbsp;callers</span><br>
<span class="lineno"></span><span class="comment" id="5878635">//&nbsp;need&nbsp;not&nbsp;close&nbsp;the&nbsp;pipe&nbsp;themselves;&nbsp;however,&nbsp;an&nbsp;implication&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5878706">//&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Wait&nbsp;before&nbsp;all&nbsp;reads&nbsp;from&nbsp;the&nbsp;pipe&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="comment" id="5878785">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason,&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;use&nbsp;Run&nbsp;when&nbsp;using&nbsp;StderrPipe.</span><br>
<span class="lineno"></span><span class="comment" id="5878859">//&nbsp;See&nbsp;the&nbsp;StdoutPipe&nbsp;example&nbsp;for&nbsp;idiomatic&nbsp;usage.</span><br>
<span class="lineno">485</span><span class="keyword" id="5878910">func</span>&nbsp;<span class="op" id="5878915">(</span><span class="ident" id="5878916">c</span>&nbsp;<span class="op" id="5878918">*</span><span class="ident" id="5878919">Cmd</span><span class="op" id="5878922">)</span>&nbsp;<span class="ident" id="5878924">StderrPipe</span><span class="op" id="5878934">(</span><span class="op" id="5878935">)</span>&nbsp;<span class="op" id="5878937">(</span><span class="ident" id="5878938">io</span><span class="op" id="5878940">.</span><span class="ident" id="5878941">ReadCloser</span><span class="op" id="5878951">,</span>&nbsp;<span class="builtintype" id="5878953">error</span><span class="op" id="5878958">)</span>&nbsp;<span class="op" id="5878960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878963">if</span>&nbsp;<span class="ident" id="5878966">c</span><span class="op" id="5878967">.</span><span class="ident" id="5878968">Stderr</span>&nbsp;<span class="op" id="5878975">!=</span>&nbsp;<span class="ident" id="5878978">nil</span>&nbsp;<span class="op" id="5878982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878986">return</span>&nbsp;<span class="ident" id="5878993">nil</span><span class="op" id="5878996">,</span>&nbsp;<span class="ident" id="5878998">errors</span><span class="op" id="5879004">.</span><span class="ident" id="5879005">New</span><span class="op" id="5879008">(</span><span class="string" id="5879009">&#34;exec:&nbsp;Stderr&nbsp;already&nbsp;set&#34;</span><span class="op" id="5879035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5879038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879041">if</span>&nbsp;<span class="ident" id="5879044">c</span><span class="op" id="5879045">.</span><span class="ident" id="5879046">Process</span>&nbsp;<span class="op" id="5879054">!=</span>&nbsp;<span class="ident" id="5879057">nil</span>&nbsp;<span class="op" id="5879061">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879065">return</span>&nbsp;<span class="ident" id="5879072">nil</span><span class="op" id="5879075">,</span>&nbsp;<span class="ident" id="5879077">errors</span><span class="op" id="5879083">.</span><span class="ident" id="5879084">New</span><span class="op" id="5879087">(</span><span class="string" id="5879088">&#34;exec:&nbsp;StderrPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5879128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5879131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879134">pr</span><span class="op" id="5879136">,</span>&nbsp;<span class="ident" id="5879138">pw</span><span class="op" id="5879140">,</span>&nbsp;<span class="ident" id="5879142">err</span>&nbsp;<span class="op" id="5879146">:=</span>&nbsp;<span class="ident" id="5879149">os</span><span class="op" id="5879151">.</span><span class="ident" id="5879152">Pipe</span><span class="op" id="5879156">(</span><span class="op" id="5879157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879160">if</span>&nbsp;<span class="ident" id="5879163">err</span>&nbsp;<span class="op" id="5879167">!=</span>&nbsp;<span class="ident" id="5879170">nil</span>&nbsp;<span class="op" id="5879174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879178">return</span>&nbsp;<span class="ident" id="5879185">nil</span><span class="op" id="5879188">,</span>&nbsp;<span class="ident" id="5879190">err</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5879195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879198">c</span><span class="op" id="5879199">.</span><span class="ident" id="5879200">Stderr</span>&nbsp;<span class="op" id="5879207">=</span>&nbsp;<span class="ident" id="5879209">pw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879213">c</span><span class="op" id="5879214">.</span><span class="ident" id="5879215">closeAfterStart</span>&nbsp;<span class="op" id="5879231">=</span>&nbsp;<span class="builtinfunc" id="5879233">append</span><span class="op" id="5879239">(</span><span class="ident" id="5879240">c</span><span class="op" id="5879241">.</span><span class="ident" id="5879242">closeAfterStart</span><span class="op" id="5879257">,</span>&nbsp;<span class="ident" id="5879259">pw</span><span class="op" id="5879261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879264">c</span><span class="op" id="5879265">.</span><span class="ident" id="5879266">closeAfterWait</span>&nbsp;<span class="op" id="5879281">=</span>&nbsp;<span class="builtinfunc" id="5879283">append</span><span class="op" id="5879289">(</span><span class="ident" id="5879290">c</span><span class="op" id="5879291">.</span><span class="ident" id="5879292">closeAfterWait</span><span class="op" id="5879306">,</span>&nbsp;<span class="ident" id="5879308">pr</span><span class="op" id="5879310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879313">return</span>&nbsp;<span class="ident" id="5879320">pr</span><span class="op" id="5879322">,</span>&nbsp;<span class="ident" id="5879324">nil</span><br>
<span class="lineno">500</span><span class="op" id="5879328">}</span>
</div>
</body>
</html>
