<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2100933">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2100988">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2101042">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2101093">package</span>&nbsp;<span class="ident" id="2101101">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2101107">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;error&nbsp;function&nbsp;and&nbsp;complementary&nbsp;error&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2101179">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2101233">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/s_erf.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2101285">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2101340">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2101370">//</span><br>
<span class="lineno"></span><span class="comment" id="2101373">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2101429">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2101498">//</span><br>
<span class="lineno"></span><span class="comment" id="2101501">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2101560">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2101616">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2101673">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2101690">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2101746">//</span><br>
<span class="lineno">25</span><span class="comment" id="2101749">//</span><br>
<span class="lineno"></span><span class="comment" id="2101752">//&nbsp;double&nbsp;erf(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2101776">//&nbsp;double&nbsp;erfc(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2101801">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="2101832">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|\</span><br>
<span class="lineno">30</span><span class="comment" id="2101864">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;&nbsp;---------&nbsp;&nbsp;|&nbsp;exp(-t*t)dt</span><br>
<span class="lineno"></span><span class="comment" id="2101907">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqrt(pi)&nbsp;\|</span><br>
<span class="lineno"></span><span class="comment" id="2101938">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2101969">//</span><br>
<span class="lineno"></span><span class="comment" id="2101972">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;&nbsp;1-erf(x)</span><br>
<span class="lineno">35</span><span class="comment" id="2101999">//&nbsp;&nbsp;Note&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2102013">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(-x)&nbsp;=&nbsp;-erf(x)</span><br>
<span class="lineno"></span><span class="comment" id="2102047">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(-x)&nbsp;=&nbsp;2&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="2102086">//</span><br>
<span class="lineno"></span><span class="comment" id="2102089">//&nbsp;Method:</span><br>
<span class="lineno">40</span><span class="comment" id="2102100">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="2102135">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;x&nbsp;+&nbsp;x*R(x**2)</span><br>
<span class="lineno"></span><span class="comment" id="2102171">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;1&nbsp;-&nbsp;erf(x)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[-.84375,0.25]</span><br>
<span class="lineno"></span><span class="comment" id="2102237">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.5&nbsp;+&nbsp;((0.5-x)-x*R)&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[0.25,0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="2102303">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;R&nbsp;=&nbsp;P/Q&nbsp;where&nbsp;P&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;8&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="2102367">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;10.</span><br>
<span class="lineno"></span><span class="comment" id="2102409">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-57.90</span><br>
<span class="lineno"></span><span class="comment" id="2102465">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;R&nbsp;-&nbsp;(erf(x)-x)/x&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2102515">//</span><br>
<span class="lineno"></span><span class="comment" id="2102518">//</span><br>
<span class="lineno">50</span><span class="comment" id="2102521">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark.&nbsp;The&nbsp;formula&nbsp;is&nbsp;derived&nbsp;by&nbsp;noting</span><br>
<span class="lineno"></span><span class="comment" id="2102573">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;=&nbsp;(2/sqrt(pi))*(x&nbsp;-&nbsp;x**3/3&nbsp;+&nbsp;x**5/10&nbsp;-&nbsp;x**7/42&nbsp;+&nbsp;....)</span><br>
<span class="lineno"></span><span class="comment" id="2102647">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2102667">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2/sqrt(pi)&nbsp;=&nbsp;1.128379167095512573896158903121545171688</span><br>
<span class="lineno"></span><span class="comment" id="2102734">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;close&nbsp;to&nbsp;one.&nbsp;The&nbsp;interval&nbsp;is&nbsp;chosen&nbsp;because&nbsp;the&nbsp;fix</span><br>
<span class="lineno">55</span><span class="comment" id="2102801">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;point&nbsp;of&nbsp;erf(x)&nbsp;is&nbsp;near&nbsp;0.6174&nbsp;(i.e.,&nbsp;erf(x)=x&nbsp;when&nbsp;x&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2102869">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;near&nbsp;0.6174),&nbsp;and&nbsp;by&nbsp;some&nbsp;experiment,&nbsp;0.84375&nbsp;is&nbsp;chosen&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2102939">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;guarantee&nbsp;the&nbsp;error&nbsp;is&nbsp;less&nbsp;than&nbsp;one&nbsp;ulp&nbsp;for&nbsp;erf.</span><br>
<span class="lineno"></span><span class="comment" id="2103000">//</span><br>
<span class="lineno"></span><span class="comment" id="2103003">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0.84375,1.25],&nbsp;let&nbsp;s&nbsp;=&nbsp;|x|&nbsp;-&nbsp;1,&nbsp;and</span><br>
<span class="lineno">60</span><span class="comment" id="2103062">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;0.84506291151&nbsp;rounded&nbsp;to&nbsp;single&nbsp;(24&nbsp;bits)</span><br>
<span class="lineno"></span><span class="comment" id="2103119">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*&nbsp;(c&nbsp;&nbsp;+&nbsp;P1(s)/Q1(s))</span><br>
<span class="lineno"></span><span class="comment" id="2103174">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1-c)&nbsp;&nbsp;-&nbsp;P1(s)/Q1(s)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2103230">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1+(c+P1(s)/Q1(s))&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2103286">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P1/Q1&nbsp;-&nbsp;(erf(|x|)-c)|&nbsp;&lt;=&nbsp;2**-59.06</span><br>
<span class="lineno">65</span><span class="comment" id="2103338">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark:&nbsp;here&nbsp;we&nbsp;use&nbsp;the&nbsp;taylor&nbsp;series&nbsp;expansion&nbsp;at&nbsp;x=1.</span><br>
<span class="lineno"></span><span class="comment" id="2103405">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;=&nbsp;erf(1)&nbsp;+&nbsp;s*Poly(s)</span><br>
<span class="lineno"></span><span class="comment" id="2103451">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.845..&nbsp;+&nbsp;P1(s)/Q1(s)</span><br>
<span class="lineno"></span><span class="comment" id="2103500">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;That&nbsp;is,&nbsp;we&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="2103565">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;-&nbsp;(c&nbsp;=&nbsp;(single)0.84506291151)</span><br>
<span class="lineno">70</span><span class="comment" id="2103628">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note&nbsp;that&nbsp;|P1/Q1|&lt;&nbsp;0.078&nbsp;for&nbsp;x&nbsp;in&nbsp;[0.84375,1.25]</span><br>
<span class="lineno"></span><span class="comment" id="2103688">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2103705">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2103748">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2103791">//</span><br>
<span class="lineno">75</span><span class="comment" id="2103794">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1.25,1/0.35(~2.857143)],</span><br>
<span class="lineno"></span><span class="comment" id="2103840">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R1/S1)</span><br>
<span class="lineno"></span><span class="comment" id="2103895">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;1&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="2103933">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2103950">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">80</span><span class="comment" id="2104005">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S1(z)&nbsp;=&nbsp;degree&nbsp;8&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="2104048">//</span><br>
<span class="lineno"></span><span class="comment" id="2104051">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1/0.35,28]</span><br>
<span class="lineno"></span><span class="comment" id="2104083">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2104147">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;-6&lt;x&lt;0</span><br>
<span class="lineno">85</span><span class="comment" id="2104218">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;tiny&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(if&nbsp;x&nbsp;&lt;=&nbsp;-6)</span><br>
<span class="lineno"></span><span class="comment" id="2104279">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;erfc(x))&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;6,&nbsp;else</span><br>
<span class="lineno"></span><span class="comment" id="2104344">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;tiny)</span><br>
<span class="lineno"></span><span class="comment" id="2104391">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2104408">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2(z)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">90</span><span class="comment" id="2104463">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S2(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="2104506">//</span><br>
<span class="lineno"></span><span class="comment" id="2104509">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note1:</span><br>
<span class="lineno"></span><span class="comment" id="2104524">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To&nbsp;compute&nbsp;exp(-x*x-0.5625+R/S),&nbsp;let&nbsp;s&nbsp;be&nbsp;a&nbsp;single</span><br>
<span class="lineno"></span><span class="comment" id="2104586">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;precision&nbsp;number&nbsp;and&nbsp;s&nbsp;:=&nbsp;x;&nbsp;then</span><br>
<span class="lineno">95</span><span class="comment" id="2104631">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*x&nbsp;=&nbsp;-s*s&nbsp;+&nbsp;(s-x)*(s+x)</span><br>
<span class="lineno"></span><span class="comment" id="2104673">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x-0.5626+R/S)&nbsp;=</span><br>
<span class="lineno"></span><span class="comment" id="2104712">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-s*s-0.5625)*exp((s-x)*(s+x)+R/S);</span><br>
<span class="lineno"></span><span class="comment" id="2104775">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note2:</span><br>
<span class="lineno"></span><span class="comment" id="2104790">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;4&nbsp;and&nbsp;5&nbsp;make&nbsp;use&nbsp;of&nbsp;the&nbsp;asymptotic&nbsp;series</span><br>
<span class="lineno">100</span><span class="comment" id="2104848">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x)</span><br>
<span class="lineno"></span><span class="comment" id="2104884">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;~&nbsp;----------&nbsp;*&nbsp;(&nbsp;1&nbsp;+&nbsp;Poly(1/x**2)&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="2104944">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x*sqrt(pi)</span><br>
<span class="lineno"></span><span class="comment" id="2104981">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="2105037">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g(s)=f(1/x**2)&nbsp;=&nbsp;log(erfc(x)*x)&nbsp;-&nbsp;x*x&nbsp;+&nbsp;0.5625</span><br>
<span class="lineno">105</span><span class="comment" id="2105100">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;is&nbsp;the&nbsp;error&nbsp;bound&nbsp;for&nbsp;R1/S1&nbsp;and&nbsp;R2/S2</span><br>
<span class="lineno"></span><span class="comment" id="2105155">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R1/S1&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-62.57)</span><br>
<span class="lineno"></span><span class="comment" id="2105201">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R2/S2&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-61.52)</span><br>
<span class="lineno"></span><span class="comment" id="2105247">//</span><br>
<span class="lineno"></span><span class="comment" id="2105250">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.&nbsp;For&nbsp;inf&nbsp;&gt;&nbsp;x&nbsp;&gt;=&nbsp;28</span><br>
<span class="lineno">110</span><span class="comment" id="2105279">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*(1&nbsp;-&nbsp;tiny)&nbsp;&nbsp;(raise&nbsp;inexact)</span><br>
<span class="lineno"></span><span class="comment" id="2105342">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;tiny*tiny&nbsp;(raise&nbsp;underflow)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2105405">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2&nbsp;-&nbsp;tiny&nbsp;if&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="2105447">//</span><br>
<span class="lineno"></span><span class="comment" id="2105450">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.&nbsp;Special&nbsp;case:</span><br>
<span class="lineno">115</span><span class="comment" id="2105475">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(0)&nbsp;&nbsp;=&nbsp;0,&nbsp;erf(inf)&nbsp;&nbsp;=&nbsp;1,&nbsp;erf(-inf)&nbsp;=&nbsp;-1,</span><br>
<span class="lineno"></span><span class="comment" id="2105535">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(0)&nbsp;=&nbsp;1,&nbsp;erfc(inf)&nbsp;=&nbsp;0,&nbsp;erfc(-inf)&nbsp;=&nbsp;2,</span><br>
<span class="lineno"></span><span class="comment" id="2105595">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc/erf(NaN)&nbsp;is&nbsp;NaN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2105633">const</span>&nbsp;<span class="op" id="2105639">(</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2105642">erx</span>&nbsp;<span class="op" id="2105646">=</span>&nbsp;<span class="num" id="2105648">8.45062911510467529297e-01</span>&nbsp;<span class="comment" id="2105675">//&nbsp;0x3FEB0AC160000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2105698">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2105757">efx</span>&nbsp;&nbsp;<span class="op" id="2105762">=</span>&nbsp;<span class="num" id="2105764">1.28379167095512586316e-01</span>&nbsp;&nbsp;<span class="comment" id="2105792">//&nbsp;0x3FC06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2105815">efx8</span>&nbsp;<span class="op" id="2105820">=</span>&nbsp;<span class="num" id="2105822">1.02703333676410069053e+00</span>&nbsp;&nbsp;<span class="comment" id="2105850">//&nbsp;0x3FF06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2105873">pp0</span>&nbsp;&nbsp;<span class="op" id="2105878">=</span>&nbsp;<span class="num" id="2105880">1.28379167095512558561e-01</span>&nbsp;&nbsp;<span class="comment" id="2105908">//&nbsp;0x3FC06EBA8214DB68</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2105931">pp1</span>&nbsp;&nbsp;<span class="op" id="2105936">=</span>&nbsp;<span class="op" id="2105938">-</span><span class="num" id="2105939">3.25042107247001499370e-01</span>&nbsp;<span class="comment" id="2105966">//&nbsp;0xBFD4CD7D691CB913</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2105989">pp2</span>&nbsp;&nbsp;<span class="op" id="2105994">=</span>&nbsp;<span class="op" id="2105996">-</span><span class="num" id="2105997">2.84817495755985104766e-02</span>&nbsp;<span class="comment" id="2106024">//&nbsp;0xBF9D2A51DBD7194F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106047">pp3</span>&nbsp;&nbsp;<span class="op" id="2106052">=</span>&nbsp;<span class="op" id="2106054">-</span><span class="num" id="2106055">5.77027029648944159157e-03</span>&nbsp;<span class="comment" id="2106082">//&nbsp;0xBF77A291236668E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106105">pp4</span>&nbsp;&nbsp;<span class="op" id="2106110">=</span>&nbsp;<span class="op" id="2106112">-</span><span class="num" id="2106113">2.37630166566501626084e-05</span>&nbsp;<span class="comment" id="2106140">//&nbsp;0xBEF8EAD6120016AC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106163">qq1</span>&nbsp;&nbsp;<span class="op" id="2106168">=</span>&nbsp;<span class="num" id="2106170">3.97917223959155352819e-01</span>&nbsp;&nbsp;<span class="comment" id="2106198">//&nbsp;0x3FD97779CDDADC09</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106221">qq2</span>&nbsp;&nbsp;<span class="op" id="2106226">=</span>&nbsp;<span class="num" id="2106228">6.50222499887672944485e-02</span>&nbsp;&nbsp;<span class="comment" id="2106256">//&nbsp;0x3FB0A54C5536CEBA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106279">qq3</span>&nbsp;&nbsp;<span class="op" id="2106284">=</span>&nbsp;<span class="num" id="2106286">5.08130628187576562776e-03</span>&nbsp;&nbsp;<span class="comment" id="2106314">//&nbsp;0x3F74D022C4D36B0F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106337">qq4</span>&nbsp;&nbsp;<span class="op" id="2106342">=</span>&nbsp;<span class="num" id="2106344">1.32494738004321644526e-04</span>&nbsp;&nbsp;<span class="comment" id="2106372">//&nbsp;0x3F215DC9221C1A10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106395">qq5</span>&nbsp;&nbsp;<span class="op" id="2106400">=</span>&nbsp;<span class="op" id="2106402">-</span><span class="num" id="2106403">3.96022827877536812320e-06</span>&nbsp;<span class="comment" id="2106430">//&nbsp;0xBED09C4342A26120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2106453">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;&nbsp;in&nbsp;[0.84375,&nbsp;1.25]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106516">pa0</span>&nbsp;<span class="op" id="2106520">=</span>&nbsp;<span class="op" id="2106522">-</span><span class="num" id="2106523">2.36211856075265944077e-03</span>&nbsp;<span class="comment" id="2106550">//&nbsp;0xBF6359B8BEF77538</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106573">pa1</span>&nbsp;<span class="op" id="2106577">=</span>&nbsp;<span class="num" id="2106579">4.14856118683748331666e-01</span>&nbsp;&nbsp;<span class="comment" id="2106607">//&nbsp;0x3FDA8D00AD92B34D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106630">pa2</span>&nbsp;<span class="op" id="2106634">=</span>&nbsp;<span class="op" id="2106636">-</span><span class="num" id="2106637">3.72207876035701323847e-01</span>&nbsp;<span class="comment" id="2106664">//&nbsp;0xBFD7D240FBB8C3F1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106687">pa3</span>&nbsp;<span class="op" id="2106691">=</span>&nbsp;<span class="num" id="2106693">3.18346619901161753674e-01</span>&nbsp;&nbsp;<span class="comment" id="2106721">//&nbsp;0x3FD45FCA805120E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106744">pa4</span>&nbsp;<span class="op" id="2106748">=</span>&nbsp;<span class="op" id="2106750">-</span><span class="num" id="2106751">1.10894694282396677476e-01</span>&nbsp;<span class="comment" id="2106778">//&nbsp;0xBFBC63983D3E28EC</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106801">pa5</span>&nbsp;<span class="op" id="2106805">=</span>&nbsp;<span class="num" id="2106807">3.54783043256182359371e-02</span>&nbsp;&nbsp;<span class="comment" id="2106835">//&nbsp;0x3FA22A36599795EB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106858">pa6</span>&nbsp;<span class="op" id="2106862">=</span>&nbsp;<span class="op" id="2106864">-</span><span class="num" id="2106865">2.16637559486879084300e-03</span>&nbsp;<span class="comment" id="2106892">//&nbsp;0xBF61BF380A96073F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106915">qa1</span>&nbsp;<span class="op" id="2106919">=</span>&nbsp;<span class="num" id="2106921">1.06420880400844228286e-01</span>&nbsp;&nbsp;<span class="comment" id="2106949">//&nbsp;0x3FBB3E6618EEE323</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106972">qa2</span>&nbsp;<span class="op" id="2106976">=</span>&nbsp;<span class="num" id="2106978">5.40397917702171048937e-01</span>&nbsp;&nbsp;<span class="comment" id="2107006">//&nbsp;0x3FE14AF092EB6F33</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107029">qa3</span>&nbsp;<span class="op" id="2107033">=</span>&nbsp;<span class="num" id="2107035">7.18286544141962662868e-02</span>&nbsp;&nbsp;<span class="comment" id="2107063">//&nbsp;0x3FB2635CD99FE9A7</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107086">qa4</span>&nbsp;<span class="op" id="2107090">=</span>&nbsp;<span class="num" id="2107092">1.26171219808761642112e-01</span>&nbsp;&nbsp;<span class="comment" id="2107120">//&nbsp;0x3FC02660E763351F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107143">qa5</span>&nbsp;<span class="op" id="2107147">=</span>&nbsp;<span class="num" id="2107149">1.36370839120290507362e-02</span>&nbsp;&nbsp;<span class="comment" id="2107177">//&nbsp;0x3F8BEDC26B51DD1C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107200">qa6</span>&nbsp;<span class="op" id="2107204">=</span>&nbsp;<span class="num" id="2107206">1.19844998467991074170e-02</span>&nbsp;&nbsp;<span class="comment" id="2107234">//&nbsp;0x3F888B545735151D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2107257">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1.25,&nbsp;1/0.35]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107319">ra0</span>&nbsp;<span class="op" id="2107323">=</span>&nbsp;<span class="op" id="2107325">-</span><span class="num" id="2107326">9.86494403484714822705e-03</span>&nbsp;<span class="comment" id="2107353">//&nbsp;0xBF843412600D6435</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107376">ra1</span>&nbsp;<span class="op" id="2107380">=</span>&nbsp;<span class="op" id="2107382">-</span><span class="num" id="2107383">6.93858572707181764372e-01</span>&nbsp;<span class="comment" id="2107410">//&nbsp;0xBFE63416E4BA7360</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107433">ra2</span>&nbsp;<span class="op" id="2107437">=</span>&nbsp;<span class="op" id="2107439">-</span><span class="num" id="2107440">1.05586262253232909814e+01</span>&nbsp;<span class="comment" id="2107467">//&nbsp;0xC0251E0441B0E726</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107490">ra3</span>&nbsp;<span class="op" id="2107494">=</span>&nbsp;<span class="op" id="2107496">-</span><span class="num" id="2107497">6.23753324503260060396e+01</span>&nbsp;<span class="comment" id="2107524">//&nbsp;0xC04F300AE4CBA38D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107547">ra4</span>&nbsp;<span class="op" id="2107551">=</span>&nbsp;<span class="op" id="2107553">-</span><span class="num" id="2107554">1.62396669462573470355e+02</span>&nbsp;<span class="comment" id="2107581">//&nbsp;0xC0644CB184282266</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107604">ra5</span>&nbsp;<span class="op" id="2107608">=</span>&nbsp;<span class="op" id="2107610">-</span><span class="num" id="2107611">1.84605092906711035994e+02</span>&nbsp;<span class="comment" id="2107638">//&nbsp;0xC067135CEBCCABB2</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107661">ra6</span>&nbsp;<span class="op" id="2107665">=</span>&nbsp;<span class="op" id="2107667">-</span><span class="num" id="2107668">8.12874355063065934246e+01</span>&nbsp;<span class="comment" id="2107695">//&nbsp;0xC054526557E4D2F2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107718">ra7</span>&nbsp;<span class="op" id="2107722">=</span>&nbsp;<span class="op" id="2107724">-</span><span class="num" id="2107725">9.81432934416914548592e+00</span>&nbsp;<span class="comment" id="2107752">//&nbsp;0xC023A0EFC69AC25C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107775">sa1</span>&nbsp;<span class="op" id="2107779">=</span>&nbsp;<span class="num" id="2107781">1.96512716674392571292e+01</span>&nbsp;&nbsp;<span class="comment" id="2107809">//&nbsp;0x4033A6B9BD707687</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107832">sa2</span>&nbsp;<span class="op" id="2107836">=</span>&nbsp;<span class="num" id="2107838">1.37657754143519042600e+02</span>&nbsp;&nbsp;<span class="comment" id="2107866">//&nbsp;0x4061350C526AE721</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107889">sa3</span>&nbsp;<span class="op" id="2107893">=</span>&nbsp;<span class="num" id="2107895">4.34565877475229228821e+02</span>&nbsp;&nbsp;<span class="comment" id="2107923">//&nbsp;0x407B290DD58A1A71</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107946">sa4</span>&nbsp;<span class="op" id="2107950">=</span>&nbsp;<span class="num" id="2107952">6.45387271733267880336e+02</span>&nbsp;&nbsp;<span class="comment" id="2107980">//&nbsp;0x40842B1921EC2868</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108003">sa5</span>&nbsp;<span class="op" id="2108007">=</span>&nbsp;<span class="num" id="2108009">4.29008140027567833386e+02</span>&nbsp;&nbsp;<span class="comment" id="2108037">//&nbsp;0x407AD02157700314</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108060">sa6</span>&nbsp;<span class="op" id="2108064">=</span>&nbsp;<span class="num" id="2108066">1.08635005541779435134e+02</span>&nbsp;&nbsp;<span class="comment" id="2108094">//&nbsp;0x405B28A3EE48AE2C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108117">sa7</span>&nbsp;<span class="op" id="2108121">=</span>&nbsp;<span class="num" id="2108123">6.57024977031928170135e+00</span>&nbsp;&nbsp;<span class="comment" id="2108151">//&nbsp;0x401A47EF8E484A93</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108174">sa8</span>&nbsp;<span class="op" id="2108178">=</span>&nbsp;<span class="op" id="2108180">-</span><span class="num" id="2108181">6.04244152148580987438e-02</span>&nbsp;<span class="comment" id="2108208">//&nbsp;0xBFAEEFF2EE749A62</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2108231">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1/.35,&nbsp;28]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108290">rb0</span>&nbsp;<span class="op" id="2108294">=</span>&nbsp;<span class="op" id="2108296">-</span><span class="num" id="2108297">9.86494292470009928597e-03</span>&nbsp;<span class="comment" id="2108324">//&nbsp;0xBF84341239E86F4A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108347">rb1</span>&nbsp;<span class="op" id="2108351">=</span>&nbsp;<span class="op" id="2108353">-</span><span class="num" id="2108354">7.99283237680523006574e-01</span>&nbsp;<span class="comment" id="2108381">//&nbsp;0xBFE993BA70C285DE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108404">rb2</span>&nbsp;<span class="op" id="2108408">=</span>&nbsp;<span class="op" id="2108410">-</span><span class="num" id="2108411">1.77579549177547519889e+01</span>&nbsp;<span class="comment" id="2108438">//&nbsp;0xC031C209555F995A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108461">rb3</span>&nbsp;<span class="op" id="2108465">=</span>&nbsp;<span class="op" id="2108467">-</span><span class="num" id="2108468">1.60636384855821916062e+02</span>&nbsp;<span class="comment" id="2108495">//&nbsp;0xC064145D43C5ED98</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108518">rb4</span>&nbsp;<span class="op" id="2108522">=</span>&nbsp;<span class="op" id="2108524">-</span><span class="num" id="2108525">6.37566443368389627722e+02</span>&nbsp;<span class="comment" id="2108552">//&nbsp;0xC083EC881375F228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108575">rb5</span>&nbsp;<span class="op" id="2108579">=</span>&nbsp;<span class="op" id="2108581">-</span><span class="num" id="2108582">1.02509513161107724954e+03</span>&nbsp;<span class="comment" id="2108609">//&nbsp;0xC09004616A2E5992</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108632">rb6</span>&nbsp;<span class="op" id="2108636">=</span>&nbsp;<span class="op" id="2108638">-</span><span class="num" id="2108639">4.83519191608651397019e+02</span>&nbsp;<span class="comment" id="2108666">//&nbsp;0xC07E384E9BDC383F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108689">sb1</span>&nbsp;<span class="op" id="2108693">=</span>&nbsp;<span class="num" id="2108695">3.03380607434824582924e+01</span>&nbsp;&nbsp;<span class="comment" id="2108723">//&nbsp;0x403E568B261D5190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108746">sb2</span>&nbsp;<span class="op" id="2108750">=</span>&nbsp;<span class="num" id="2108752">3.25792512996573918826e+02</span>&nbsp;&nbsp;<span class="comment" id="2108780">//&nbsp;0x40745CAE221B9F0A</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108803">sb3</span>&nbsp;<span class="op" id="2108807">=</span>&nbsp;<span class="num" id="2108809">1.53672958608443695994e+03</span>&nbsp;&nbsp;<span class="comment" id="2108837">//&nbsp;0x409802EB189D5118</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108860">sb4</span>&nbsp;<span class="op" id="2108864">=</span>&nbsp;<span class="num" id="2108866">3.19985821950859553908e+03</span>&nbsp;&nbsp;<span class="comment" id="2108894">//&nbsp;0x40A8FFB7688C246A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108917">sb5</span>&nbsp;<span class="op" id="2108921">=</span>&nbsp;<span class="num" id="2108923">2.55305040643316442583e+03</span>&nbsp;&nbsp;<span class="comment" id="2108951">//&nbsp;0x40A3F219CEDF3BE6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108974">sb6</span>&nbsp;<span class="op" id="2108978">=</span>&nbsp;<span class="num" id="2108980">4.74528541206955367215e+02</span>&nbsp;&nbsp;<span class="comment" id="2109008">//&nbsp;0x407DA874E79FE763</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2109031">sb7</span>&nbsp;<span class="op" id="2109035">=</span>&nbsp;<span class="op" id="2109037">-</span><span class="num" id="2109038">2.24409524465858183362e+01</span>&nbsp;<span class="comment" id="2109065">//&nbsp;0xC03670E242712D62</span><br>
<span class="lineno">180</span><span class="op" id="2109087">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2109090">//&nbsp;Erf&nbsp;returns&nbsp;the&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2109130">//</span><br>
<span class="lineno"></span><span class="comment" id="2109133">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">185</span><span class="comment" id="2109155">//&nbsp;&nbsp;&nbsp;&nbspErf(+Inf)&nbsp;=&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="2109172">//&nbsp;&nbsp;&nbsp;&nbspErf(-Inf)&nbsp;=&nbsp;-1</span><br>
<span class="lineno"></span><span class="comment" id="2109190">//&nbsp;&nbsp;&nbsp;&nbspErf(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2109208">func</span>&nbsp;<span class="ident" id="2109213">Erf</span><span class="op" id="2109216">(</span><span class="ident" id="2109217">x</span>&nbsp;<span class="builtintype" id="2109219">float64</span><span class="op" id="2109226">)</span>&nbsp;<span class="builtintype" id="2109228">float64</span>&nbsp;<span class="op" id="2109236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109239">const</span>&nbsp;<span class="op" id="2109245">(</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2109249">VeryTiny</span>&nbsp;<span class="op" id="2109258">=</span>&nbsp;<span class="num" id="2109260">2.848094538889218e-306</span>&nbsp;<span class="comment" id="2109283">//&nbsp;0x0080000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2109307">Small</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2109316">=</span>&nbsp;<span class="num" id="2109318">1.0</span>&nbsp;<span class="op" id="2109322">/</span>&nbsp;<span class="op" id="2109324">(</span><span class="num" id="2109325">1</span>&nbsp;<span class="op" id="2109327">&lt;&lt;</span>&nbsp;<span class="num" id="2109330">28</span><span class="op" id="2109332">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2109341">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2109352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2109355">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109373">switch</span>&nbsp;<span class="op" id="2109380">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109383">case</span>&nbsp;<span class="ident" id="2109388">IsNaN</span><span class="op" id="2109393">(</span><span class="ident" id="2109394">x</span><span class="op" id="2109395">)</span><span class="op" id="2109396">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109400">return</span>&nbsp;<span class="ident" id="2109407">NaN</span><span class="op" id="2109410">(</span><span class="op" id="2109411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109414">case</span>&nbsp;<span class="ident" id="2109419">IsInf</span><span class="op" id="2109424">(</span><span class="ident" id="2109425">x</span><span class="op" id="2109426">,</span>&nbsp;<span class="num" id="2109428">1</span><span class="op" id="2109429">)</span><span class="op" id="2109430">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109434">return</span>&nbsp;<span class="num" id="2109441">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109444">case</span>&nbsp;<span class="ident" id="2109449">IsInf</span><span class="op" id="2109454">(</span><span class="ident" id="2109455">x</span><span class="op" id="2109456">,</span>&nbsp;<span class="op" id="2109458">-</span><span class="num" id="2109459">1</span><span class="op" id="2109460">)</span><span class="op" id="2109461">:</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109465">return</span>&nbsp;<span class="op" id="2109472">-</span><span class="num" id="2109473">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2109476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2109479">sign</span>&nbsp;<span class="op" id="2109484">:=</span>&nbsp;<span class="builtintype" id="2109487">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109494">if</span>&nbsp;<span class="ident" id="2109497">x</span>&nbsp;<span class="op" id="2109499">&lt;</span>&nbsp;<span class="num" id="2109501">0</span>&nbsp;<span class="op" id="2109503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2109507">x</span>&nbsp;<span class="op" id="2109509">=</span>&nbsp;<span class="op" id="2109511">-</span><span class="ident" id="2109512">x</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2109516">sign</span>&nbsp;<span class="op" id="2109521">=</span>&nbsp;<span class="builtintype" id="2109523">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2109529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109532">if</span>&nbsp;<span class="ident" id="2109535">x</span>&nbsp;<span class="op" id="2109537">&lt;</span>&nbsp;<span class="num" id="2109539">0.84375</span>&nbsp;<span class="op" id="2109547">{</span>&nbsp;<span class="comment" id="2109549">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109568">var</span>&nbsp;<span class="ident" id="2109572">temp</span>&nbsp;<span class="builtintype" id="2109577">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109587">if</span>&nbsp;<span class="ident" id="2109590">x</span>&nbsp;<span class="op" id="2109592">&lt;</span>&nbsp;<span class="ident" id="2109594">Small</span>&nbsp;<span class="op" id="2109600">{</span>&nbsp;<span class="comment" id="2109602">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-28</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109621">if</span>&nbsp;<span class="ident" id="2109624">x</span>&nbsp;<span class="op" id="2109626">&lt;</span>&nbsp;<span class="ident" id="2109628">VeryTiny</span>&nbsp;<span class="op" id="2109637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2109643">temp</span>&nbsp;<span class="op" id="2109648">=</span>&nbsp;<span class="num" id="2109650">0.125</span>&nbsp;<span class="op" id="2109656">*</span>&nbsp;<span class="op" id="2109658">(</span><span class="num" id="2109659">8.0</span><span class="op" id="2109662">*</span><span class="ident" id="2109663">x</span>&nbsp;<span class="op" id="2109665">+</span>&nbsp;<span class="ident" id="2109667">efx8</span><span class="op" id="2109671">*</span><span class="ident" id="2109672">x</span><span class="op" id="2109673">)</span>&nbsp;<span class="comment" id="2109675">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2109697">}</span>&nbsp;<span class="keyword" id="2109699">else</span>&nbsp;<span class="op" id="2109704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2109710">temp</span>&nbsp;<span class="op" id="2109715">=</span>&nbsp;<span class="ident" id="2109717">x</span>&nbsp;<span class="op" id="2109719">+</span>&nbsp;<span class="ident" id="2109721">efx</span><span class="op" id="2109724">*</span><span class="ident" id="2109725">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2109730">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2109734">}</span>&nbsp;<span class="keyword" id="2109736">else</span>&nbsp;<span class="op" id="2109741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2109746">z</span>&nbsp;<span class="op" id="2109748">:=</span>&nbsp;<span class="ident" id="2109751">x</span>&nbsp;<span class="op" id="2109753">*</span>&nbsp;<span class="ident" id="2109755">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2109760">r</span>&nbsp;<span class="op" id="2109762">:=</span>&nbsp;<span class="ident" id="2109765">pp0</span>&nbsp;<span class="op" id="2109769">+</span>&nbsp;<span class="ident" id="2109771">z</span><span class="op" id="2109772">*</span><span class="op" id="2109773">(</span><span class="ident" id="2109774">pp1</span><span class="op" id="2109777">+</span><span class="ident" id="2109778">z</span><span class="op" id="2109779">*</span><span class="op" id="2109780">(</span><span class="ident" id="2109781">pp2</span><span class="op" id="2109784">+</span><span class="ident" id="2109785">z</span><span class="op" id="2109786">*</span><span class="op" id="2109787">(</span><span class="ident" id="2109788">pp3</span><span class="op" id="2109791">+</span><span class="ident" id="2109792">z</span><span class="op" id="2109793">*</span><span class="ident" id="2109794">pp4</span><span class="op" id="2109797">)</span><span class="op" id="2109798">)</span><span class="op" id="2109799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2109804">s</span>&nbsp;<span class="op" id="2109806">:=</span>&nbsp;<span class="num" id="2109809">1</span>&nbsp;<span class="op" id="2109811">+</span>&nbsp;<span class="ident" id="2109813">z</span><span class="op" id="2109814">*</span><span class="op" id="2109815">(</span><span class="ident" id="2109816">qq1</span><span class="op" id="2109819">+</span><span class="ident" id="2109820">z</span><span class="op" id="2109821">*</span><span class="op" id="2109822">(</span><span class="ident" id="2109823">qq2</span><span class="op" id="2109826">+</span><span class="ident" id="2109827">z</span><span class="op" id="2109828">*</span><span class="op" id="2109829">(</span><span class="ident" id="2109830">qq3</span><span class="op" id="2109833">+</span><span class="ident" id="2109834">z</span><span class="op" id="2109835">*</span><span class="op" id="2109836">(</span><span class="ident" id="2109837">qq4</span><span class="op" id="2109840">+</span><span class="ident" id="2109841">z</span><span class="op" id="2109842">*</span><span class="ident" id="2109843">qq5</span><span class="op" id="2109846">)</span><span class="op" id="2109847">)</span><span class="op" id="2109848">)</span><span class="op" id="2109849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2109854">y</span>&nbsp;<span class="op" id="2109856">:=</span>&nbsp;<span class="ident" id="2109859">r</span>&nbsp;<span class="op" id="2109861">/</span>&nbsp;<span class="ident" id="2109863">s</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2109868">temp</span>&nbsp;<span class="op" id="2109873">=</span>&nbsp;<span class="ident" id="2109875">x</span>&nbsp;<span class="op" id="2109877">+</span>&nbsp;<span class="ident" id="2109879">x</span><span class="op" id="2109880">*</span><span class="ident" id="2109881">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2109885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109889">if</span>&nbsp;<span class="ident" id="2109892">sign</span>&nbsp;<span class="op" id="2109897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109902">return</span>&nbsp;<span class="op" id="2109909">-</span><span class="ident" id="2109910">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2109917">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109921">return</span>&nbsp;<span class="ident" id="2109928">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2109934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109937">if</span>&nbsp;<span class="ident" id="2109940">x</span>&nbsp;<span class="op" id="2109942">&lt;</span>&nbsp;<span class="num" id="2109944">1.25</span>&nbsp;<span class="op" id="2109949">{</span>&nbsp;<span class="comment" id="2109951">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2109978">s</span>&nbsp;<span class="op" id="2109980">:=</span>&nbsp;<span class="ident" id="2109983">x</span>&nbsp;<span class="op" id="2109985">-</span>&nbsp;<span class="num" id="2109987">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2109991">P</span>&nbsp;<span class="op" id="2109993">:=</span>&nbsp;<span class="ident" id="2109996">pa0</span>&nbsp;<span class="op" id="2110000">+</span>&nbsp;<span class="ident" id="2110002">s</span><span class="op" id="2110003">*</span><span class="op" id="2110004">(</span><span class="ident" id="2110005">pa1</span><span class="op" id="2110008">+</span><span class="ident" id="2110009">s</span><span class="op" id="2110010">*</span><span class="op" id="2110011">(</span><span class="ident" id="2110012">pa2</span><span class="op" id="2110015">+</span><span class="ident" id="2110016">s</span><span class="op" id="2110017">*</span><span class="op" id="2110018">(</span><span class="ident" id="2110019">pa3</span><span class="op" id="2110022">+</span><span class="ident" id="2110023">s</span><span class="op" id="2110024">*</span><span class="op" id="2110025">(</span><span class="ident" id="2110026">pa4</span><span class="op" id="2110029">+</span><span class="ident" id="2110030">s</span><span class="op" id="2110031">*</span><span class="op" id="2110032">(</span><span class="ident" id="2110033">pa5</span><span class="op" id="2110036">+</span><span class="ident" id="2110037">s</span><span class="op" id="2110038">*</span><span class="ident" id="2110039">pa6</span><span class="op" id="2110042">)</span><span class="op" id="2110043">)</span><span class="op" id="2110044">)</span><span class="op" id="2110045">)</span><span class="op" id="2110046">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2110050">Q</span>&nbsp;<span class="op" id="2110052">:=</span>&nbsp;<span class="num" id="2110055">1</span>&nbsp;<span class="op" id="2110057">+</span>&nbsp;<span class="ident" id="2110059">s</span><span class="op" id="2110060">*</span><span class="op" id="2110061">(</span><span class="ident" id="2110062">qa1</span><span class="op" id="2110065">+</span><span class="ident" id="2110066">s</span><span class="op" id="2110067">*</span><span class="op" id="2110068">(</span><span class="ident" id="2110069">qa2</span><span class="op" id="2110072">+</span><span class="ident" id="2110073">s</span><span class="op" id="2110074">*</span><span class="op" id="2110075">(</span><span class="ident" id="2110076">qa3</span><span class="op" id="2110079">+</span><span class="ident" id="2110080">s</span><span class="op" id="2110081">*</span><span class="op" id="2110082">(</span><span class="ident" id="2110083">qa4</span><span class="op" id="2110086">+</span><span class="ident" id="2110087">s</span><span class="op" id="2110088">*</span><span class="op" id="2110089">(</span><span class="ident" id="2110090">qa5</span><span class="op" id="2110093">+</span><span class="ident" id="2110094">s</span><span class="op" id="2110095">*</span><span class="ident" id="2110096">qa6</span><span class="op" id="2110099">)</span><span class="op" id="2110100">)</span><span class="op" id="2110101">)</span><span class="op" id="2110102">)</span><span class="op" id="2110103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110107">if</span>&nbsp;<span class="ident" id="2110110">sign</span>&nbsp;<span class="op" id="2110115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110120">return</span>&nbsp;<span class="op" id="2110127">-</span><span class="ident" id="2110128">erx</span>&nbsp;<span class="op" id="2110132">-</span>&nbsp;<span class="ident" id="2110134">P</span><span class="op" id="2110135">/</span><span class="ident" id="2110136">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2110140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110144">return</span>&nbsp;<span class="ident" id="2110151">erx</span>&nbsp;<span class="op" id="2110155">+</span>&nbsp;<span class="ident" id="2110157">P</span><span class="op" id="2110158">/</span><span class="ident" id="2110159">Q</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2110162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110165">if</span>&nbsp;<span class="ident" id="2110168">x</span>&nbsp;<span class="op" id="2110170">&gt;=</span>&nbsp;<span class="num" id="2110173">6</span>&nbsp;<span class="op" id="2110175">{</span>&nbsp;<span class="comment" id="2110177">//&nbsp;inf&nbsp;&gt;&nbsp;|x|&nbsp;&gt;=&nbsp;6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110197">if</span>&nbsp;<span class="ident" id="2110200">sign</span>&nbsp;<span class="op" id="2110205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110210">return</span>&nbsp;<span class="op" id="2110217">-</span><span class="num" id="2110218">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2110222">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110226">return</span>&nbsp;<span class="num" id="2110233">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2110236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2110239">s</span>&nbsp;<span class="op" id="2110241">:=</span>&nbsp;<span class="num" id="2110244">1</span>&nbsp;<span class="op" id="2110246">/</span>&nbsp;<span class="op" id="2110248">(</span><span class="ident" id="2110249">x</span>&nbsp;<span class="op" id="2110251">*</span>&nbsp;<span class="ident" id="2110253">x</span><span class="op" id="2110254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110257">var</span>&nbsp;<span class="ident" id="2110261">R</span><span class="op" id="2110262">,</span>&nbsp;<span class="ident" id="2110264">S</span>&nbsp;<span class="builtintype" id="2110266">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110275">if</span>&nbsp;<span class="ident" id="2110278">x</span>&nbsp;<span class="op" id="2110280">&lt;</span>&nbsp;<span class="num" id="2110282">1</span><span class="op" id="2110283">/</span><span class="num" id="2110284">0.35</span>&nbsp;<span class="op" id="2110289">{</span>&nbsp;<span class="comment" id="2110291">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2110323">R</span>&nbsp;<span class="op" id="2110325">=</span>&nbsp;<span class="ident" id="2110327">ra0</span>&nbsp;<span class="op" id="2110331">+</span>&nbsp;<span class="ident" id="2110333">s</span><span class="op" id="2110334">*</span><span class="op" id="2110335">(</span><span class="ident" id="2110336">ra1</span><span class="op" id="2110339">+</span><span class="ident" id="2110340">s</span><span class="op" id="2110341">*</span><span class="op" id="2110342">(</span><span class="ident" id="2110343">ra2</span><span class="op" id="2110346">+</span><span class="ident" id="2110347">s</span><span class="op" id="2110348">*</span><span class="op" id="2110349">(</span><span class="ident" id="2110350">ra3</span><span class="op" id="2110353">+</span><span class="ident" id="2110354">s</span><span class="op" id="2110355">*</span><span class="op" id="2110356">(</span><span class="ident" id="2110357">ra4</span><span class="op" id="2110360">+</span><span class="ident" id="2110361">s</span><span class="op" id="2110362">*</span><span class="op" id="2110363">(</span><span class="ident" id="2110364">ra5</span><span class="op" id="2110367">+</span><span class="ident" id="2110368">s</span><span class="op" id="2110369">*</span><span class="op" id="2110370">(</span><span class="ident" id="2110371">ra6</span><span class="op" id="2110374">+</span><span class="ident" id="2110375">s</span><span class="op" id="2110376">*</span><span class="ident" id="2110377">ra7</span><span class="op" id="2110380">)</span><span class="op" id="2110381">)</span><span class="op" id="2110382">)</span><span class="op" id="2110383">)</span><span class="op" id="2110384">)</span><span class="op" id="2110385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2110389">S</span>&nbsp;<span class="op" id="2110391">=</span>&nbsp;<span class="num" id="2110393">1</span>&nbsp;<span class="op" id="2110395">+</span>&nbsp;<span class="ident" id="2110397">s</span><span class="op" id="2110398">*</span><span class="op" id="2110399">(</span><span class="ident" id="2110400">sa1</span><span class="op" id="2110403">+</span><span class="ident" id="2110404">s</span><span class="op" id="2110405">*</span><span class="op" id="2110406">(</span><span class="ident" id="2110407">sa2</span><span class="op" id="2110410">+</span><span class="ident" id="2110411">s</span><span class="op" id="2110412">*</span><span class="op" id="2110413">(</span><span class="ident" id="2110414">sa3</span><span class="op" id="2110417">+</span><span class="ident" id="2110418">s</span><span class="op" id="2110419">*</span><span class="op" id="2110420">(</span><span class="ident" id="2110421">sa4</span><span class="op" id="2110424">+</span><span class="ident" id="2110425">s</span><span class="op" id="2110426">*</span><span class="op" id="2110427">(</span><span class="ident" id="2110428">sa5</span><span class="op" id="2110431">+</span><span class="ident" id="2110432">s</span><span class="op" id="2110433">*</span><span class="op" id="2110434">(</span><span class="ident" id="2110435">sa6</span><span class="op" id="2110438">+</span><span class="ident" id="2110439">s</span><span class="op" id="2110440">*</span><span class="op" id="2110441">(</span><span class="ident" id="2110442">sa7</span><span class="op" id="2110445">+</span><span class="ident" id="2110446">s</span><span class="op" id="2110447">*</span><span class="ident" id="2110448">sa8</span><span class="op" id="2110451">)</span><span class="op" id="2110452">)</span><span class="op" id="2110453">)</span><span class="op" id="2110454">)</span><span class="op" id="2110455">)</span><span class="op" id="2110456">)</span><span class="op" id="2110457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2110460">}</span>&nbsp;<span class="keyword" id="2110462">else</span>&nbsp;<span class="op" id="2110467">{</span>&nbsp;<span class="comment" id="2110469">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2110502">R</span>&nbsp;<span class="op" id="2110504">=</span>&nbsp;<span class="ident" id="2110506">rb0</span>&nbsp;<span class="op" id="2110510">+</span>&nbsp;<span class="ident" id="2110512">s</span><span class="op" id="2110513">*</span><span class="op" id="2110514">(</span><span class="ident" id="2110515">rb1</span><span class="op" id="2110518">+</span><span class="ident" id="2110519">s</span><span class="op" id="2110520">*</span><span class="op" id="2110521">(</span><span class="ident" id="2110522">rb2</span><span class="op" id="2110525">+</span><span class="ident" id="2110526">s</span><span class="op" id="2110527">*</span><span class="op" id="2110528">(</span><span class="ident" id="2110529">rb3</span><span class="op" id="2110532">+</span><span class="ident" id="2110533">s</span><span class="op" id="2110534">*</span><span class="op" id="2110535">(</span><span class="ident" id="2110536">rb4</span><span class="op" id="2110539">+</span><span class="ident" id="2110540">s</span><span class="op" id="2110541">*</span><span class="op" id="2110542">(</span><span class="ident" id="2110543">rb5</span><span class="op" id="2110546">+</span><span class="ident" id="2110547">s</span><span class="op" id="2110548">*</span><span class="ident" id="2110549">rb6</span><span class="op" id="2110552">)</span><span class="op" id="2110553">)</span><span class="op" id="2110554">)</span><span class="op" id="2110555">)</span><span class="op" id="2110556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2110560">S</span>&nbsp;<span class="op" id="2110562">=</span>&nbsp;<span class="num" id="2110564">1</span>&nbsp;<span class="op" id="2110566">+</span>&nbsp;<span class="ident" id="2110568">s</span><span class="op" id="2110569">*</span><span class="op" id="2110570">(</span><span class="ident" id="2110571">sb1</span><span class="op" id="2110574">+</span><span class="ident" id="2110575">s</span><span class="op" id="2110576">*</span><span class="op" id="2110577">(</span><span class="ident" id="2110578">sb2</span><span class="op" id="2110581">+</span><span class="ident" id="2110582">s</span><span class="op" id="2110583">*</span><span class="op" id="2110584">(</span><span class="ident" id="2110585">sb3</span><span class="op" id="2110588">+</span><span class="ident" id="2110589">s</span><span class="op" id="2110590">*</span><span class="op" id="2110591">(</span><span class="ident" id="2110592">sb4</span><span class="op" id="2110595">+</span><span class="ident" id="2110596">s</span><span class="op" id="2110597">*</span><span class="op" id="2110598">(</span><span class="ident" id="2110599">sb5</span><span class="op" id="2110602">+</span><span class="ident" id="2110603">s</span><span class="op" id="2110604">*</span><span class="op" id="2110605">(</span><span class="ident" id="2110606">sb6</span><span class="op" id="2110609">+</span><span class="ident" id="2110610">s</span><span class="op" id="2110611">*</span><span class="ident" id="2110612">sb7</span><span class="op" id="2110615">)</span><span class="op" id="2110616">)</span><span class="op" id="2110617">)</span><span class="op" id="2110618">)</span><span class="op" id="2110619">)</span><span class="op" id="2110620">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2110623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2110626">z</span>&nbsp;<span class="op" id="2110628">:=</span>&nbsp;<span class="ident" id="2110631">Float64frombits</span><span class="op" id="2110646">(</span><span class="ident" id="2110647">Float64bits</span><span class="op" id="2110658">(</span><span class="ident" id="2110659">x</span><span class="op" id="2110660">)</span>&nbsp;<span class="op" id="2110662">&amp;</span>&nbsp;<span class="num" id="2110664">0xffffffff00000000</span><span class="op" id="2110682">)</span>&nbsp;<span class="comment" id="2110684">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2110723">r</span>&nbsp;<span class="op" id="2110725">:=</span>&nbsp;<span class="ident" id="2110728">Exp</span><span class="op" id="2110731">(</span><span class="op" id="2110732">-</span><span class="ident" id="2110733">z</span><span class="op" id="2110734">*</span><span class="ident" id="2110735">z</span><span class="op" id="2110736">-</span><span class="num" id="2110737">0.5625</span><span class="op" id="2110743">)</span>&nbsp;<span class="op" id="2110745">*</span>&nbsp;<span class="ident" id="2110747">Exp</span><span class="op" id="2110750">(</span><span class="op" id="2110751">(</span><span class="ident" id="2110752">z</span><span class="op" id="2110753">-</span><span class="ident" id="2110754">x</span><span class="op" id="2110755">)</span><span class="op" id="2110756">*</span><span class="op" id="2110757">(</span><span class="ident" id="2110758">z</span><span class="op" id="2110759">+</span><span class="ident" id="2110760">x</span><span class="op" id="2110761">)</span><span class="op" id="2110762">+</span><span class="ident" id="2110763">R</span><span class="op" id="2110764">/</span><span class="ident" id="2110765">S</span><span class="op" id="2110766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110769">if</span>&nbsp;<span class="ident" id="2110772">sign</span>&nbsp;<span class="op" id="2110777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110781">return</span>&nbsp;<span class="ident" id="2110788">r</span><span class="op" id="2110789">/</span><span class="ident" id="2110790">x</span>&nbsp;<span class="op" id="2110792">-</span>&nbsp;<span class="num" id="2110794">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2110797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110800">return</span>&nbsp;<span class="num" id="2110807">1</span>&nbsp;<span class="op" id="2110809">-</span>&nbsp;<span class="ident" id="2110811">r</span><span class="op" id="2110812">/</span><span class="ident" id="2110813">x</span><br>
<span class="lineno"></span><span class="op" id="2110815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2110818">//&nbsp;Erfc&nbsp;returns&nbsp;the&nbsp;complementary&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno">260</span><span class="comment" id="2110873">//</span><br>
<span class="lineno"></span><span class="comment" id="2110876">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2110898">//&nbsp;&nbsp;&nbsp;&nbspErfc(+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2110916">//&nbsp;&nbsp;&nbsp;&nbspErfc(-Inf)&nbsp;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2110934">//&nbsp;&nbsp;&nbsp;&nbspErfc(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">265</span><span class="keyword" id="2110953">func</span>&nbsp;<span class="ident" id="2110958">Erfc</span><span class="op" id="2110962">(</span><span class="ident" id="2110963">x</span>&nbsp;<span class="builtintype" id="2110965">float64</span><span class="op" id="2110972">)</span>&nbsp;<span class="builtintype" id="2110974">float64</span>&nbsp;<span class="op" id="2110982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110985">const</span>&nbsp;<span class="ident" id="2110991">Tiny</span>&nbsp;<span class="op" id="2110996">=</span>&nbsp;<span class="num" id="2110998">1.0</span>&nbsp;<span class="op" id="2111002">/</span>&nbsp;<span class="op" id="2111004">(</span><span class="num" id="2111005">1</span>&nbsp;<span class="op" id="2111007">&lt;&lt;</span>&nbsp;<span class="num" id="2111010">56</span><span class="op" id="2111012">)</span>&nbsp;<span class="comment" id="2111014">//&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2111025">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111043">switch</span>&nbsp;<span class="op" id="2111050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111053">case</span>&nbsp;<span class="ident" id="2111058">IsNaN</span><span class="op" id="2111063">(</span><span class="ident" id="2111064">x</span><span class="op" id="2111065">)</span><span class="op" id="2111066">:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111070">return</span>&nbsp;<span class="ident" id="2111077">NaN</span><span class="op" id="2111080">(</span><span class="op" id="2111081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111084">case</span>&nbsp;<span class="ident" id="2111089">IsInf</span><span class="op" id="2111094">(</span><span class="ident" id="2111095">x</span><span class="op" id="2111096">,</span>&nbsp;<span class="num" id="2111098">1</span><span class="op" id="2111099">)</span><span class="op" id="2111100">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111104">return</span>&nbsp;<span class="num" id="2111111">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111114">case</span>&nbsp;<span class="ident" id="2111119">IsInf</span><span class="op" id="2111124">(</span><span class="ident" id="2111125">x</span><span class="op" id="2111126">,</span>&nbsp;<span class="op" id="2111128">-</span><span class="num" id="2111129">1</span><span class="op" id="2111130">)</span><span class="op" id="2111131">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111135">return</span>&nbsp;<span class="num" id="2111142">2</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2111145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111148">sign</span>&nbsp;<span class="op" id="2111153">:=</span>&nbsp;<span class="builtintype" id="2111156">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111163">if</span>&nbsp;<span class="ident" id="2111166">x</span>&nbsp;<span class="op" id="2111168">&lt;</span>&nbsp;<span class="num" id="2111170">0</span>&nbsp;<span class="op" id="2111172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111176">x</span>&nbsp;<span class="op" id="2111178">=</span>&nbsp;<span class="op" id="2111180">-</span><span class="ident" id="2111181">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111185">sign</span>&nbsp;<span class="op" id="2111190">=</span>&nbsp;<span class="builtintype" id="2111192">true</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2111198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111201">if</span>&nbsp;<span class="ident" id="2111204">x</span>&nbsp;<span class="op" id="2111206">&lt;</span>&nbsp;<span class="num" id="2111208">0.84375</span>&nbsp;<span class="op" id="2111216">{</span>&nbsp;<span class="comment" id="2111218">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111237">var</span>&nbsp;<span class="ident" id="2111241">temp</span>&nbsp;<span class="builtintype" id="2111246">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111256">if</span>&nbsp;<span class="ident" id="2111259">x</span>&nbsp;<span class="op" id="2111261">&lt;</span>&nbsp;<span class="ident" id="2111263">Tiny</span>&nbsp;<span class="op" id="2111268">{</span>&nbsp;<span class="comment" id="2111270">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111289">temp</span>&nbsp;<span class="op" id="2111294">=</span>&nbsp;<span class="ident" id="2111296">x</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2111300">}</span>&nbsp;<span class="keyword" id="2111302">else</span>&nbsp;<span class="op" id="2111307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111312">z</span>&nbsp;<span class="op" id="2111314">:=</span>&nbsp;<span class="ident" id="2111317">x</span>&nbsp;<span class="op" id="2111319">*</span>&nbsp;<span class="ident" id="2111321">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111326">r</span>&nbsp;<span class="op" id="2111328">:=</span>&nbsp;<span class="ident" id="2111331">pp0</span>&nbsp;<span class="op" id="2111335">+</span>&nbsp;<span class="ident" id="2111337">z</span><span class="op" id="2111338">*</span><span class="op" id="2111339">(</span><span class="ident" id="2111340">pp1</span><span class="op" id="2111343">+</span><span class="ident" id="2111344">z</span><span class="op" id="2111345">*</span><span class="op" id="2111346">(</span><span class="ident" id="2111347">pp2</span><span class="op" id="2111350">+</span><span class="ident" id="2111351">z</span><span class="op" id="2111352">*</span><span class="op" id="2111353">(</span><span class="ident" id="2111354">pp3</span><span class="op" id="2111357">+</span><span class="ident" id="2111358">z</span><span class="op" id="2111359">*</span><span class="ident" id="2111360">pp4</span><span class="op" id="2111363">)</span><span class="op" id="2111364">)</span><span class="op" id="2111365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111370">s</span>&nbsp;<span class="op" id="2111372">:=</span>&nbsp;<span class="num" id="2111375">1</span>&nbsp;<span class="op" id="2111377">+</span>&nbsp;<span class="ident" id="2111379">z</span><span class="op" id="2111380">*</span><span class="op" id="2111381">(</span><span class="ident" id="2111382">qq1</span><span class="op" id="2111385">+</span><span class="ident" id="2111386">z</span><span class="op" id="2111387">*</span><span class="op" id="2111388">(</span><span class="ident" id="2111389">qq2</span><span class="op" id="2111392">+</span><span class="ident" id="2111393">z</span><span class="op" id="2111394">*</span><span class="op" id="2111395">(</span><span class="ident" id="2111396">qq3</span><span class="op" id="2111399">+</span><span class="ident" id="2111400">z</span><span class="op" id="2111401">*</span><span class="op" id="2111402">(</span><span class="ident" id="2111403">qq4</span><span class="op" id="2111406">+</span><span class="ident" id="2111407">z</span><span class="op" id="2111408">*</span><span class="ident" id="2111409">qq5</span><span class="op" id="2111412">)</span><span class="op" id="2111413">)</span><span class="op" id="2111414">)</span><span class="op" id="2111415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111420">y</span>&nbsp;<span class="op" id="2111422">:=</span>&nbsp;<span class="ident" id="2111425">r</span>&nbsp;<span class="op" id="2111427">/</span>&nbsp;<span class="ident" id="2111429">s</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111434">if</span>&nbsp;<span class="ident" id="2111437">x</span>&nbsp;<span class="op" id="2111439">&lt;</span>&nbsp;<span class="num" id="2111441">0.25</span>&nbsp;<span class="op" id="2111446">{</span>&nbsp;<span class="comment" id="2111448">//&nbsp;|x|&nbsp;&lt;&nbsp;1/4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111465">temp</span>&nbsp;<span class="op" id="2111470">=</span>&nbsp;<span class="ident" id="2111472">x</span>&nbsp;<span class="op" id="2111474">+</span>&nbsp;<span class="ident" id="2111476">x</span><span class="op" id="2111477">*</span><span class="ident" id="2111478">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2111483">}</span>&nbsp;<span class="keyword" id="2111485">else</span>&nbsp;<span class="op" id="2111490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111496">temp</span>&nbsp;<span class="op" id="2111501">=</span>&nbsp;<span class="num" id="2111503">0.5</span>&nbsp;<span class="op" id="2111507">+</span>&nbsp;<span class="op" id="2111509">(</span><span class="ident" id="2111510">x</span><span class="op" id="2111511">*</span><span class="ident" id="2111512">y</span>&nbsp;<span class="op" id="2111514">+</span>&nbsp;<span class="op" id="2111516">(</span><span class="ident" id="2111517">x</span>&nbsp;<span class="op" id="2111519">-</span>&nbsp;<span class="num" id="2111521">0.5</span><span class="op" id="2111524">)</span><span class="op" id="2111525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2111530">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2111534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111538">if</span>&nbsp;<span class="ident" id="2111541">sign</span>&nbsp;<span class="op" id="2111546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111551">return</span>&nbsp;<span class="num" id="2111558">1</span>&nbsp;<span class="op" id="2111560">+</span>&nbsp;<span class="ident" id="2111562">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2111569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111573">return</span>&nbsp;<span class="num" id="2111580">1</span>&nbsp;<span class="op" id="2111582">-</span>&nbsp;<span class="ident" id="2111584">temp</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2111590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111593">if</span>&nbsp;<span class="ident" id="2111596">x</span>&nbsp;<span class="op" id="2111598">&lt;</span>&nbsp;<span class="num" id="2111600">1.25</span>&nbsp;<span class="op" id="2111605">{</span>&nbsp;<span class="comment" id="2111607">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111634">s</span>&nbsp;<span class="op" id="2111636">:=</span>&nbsp;<span class="ident" id="2111639">x</span>&nbsp;<span class="op" id="2111641">-</span>&nbsp;<span class="num" id="2111643">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111647">P</span>&nbsp;<span class="op" id="2111649">:=</span>&nbsp;<span class="ident" id="2111652">pa0</span>&nbsp;<span class="op" id="2111656">+</span>&nbsp;<span class="ident" id="2111658">s</span><span class="op" id="2111659">*</span><span class="op" id="2111660">(</span><span class="ident" id="2111661">pa1</span><span class="op" id="2111664">+</span><span class="ident" id="2111665">s</span><span class="op" id="2111666">*</span><span class="op" id="2111667">(</span><span class="ident" id="2111668">pa2</span><span class="op" id="2111671">+</span><span class="ident" id="2111672">s</span><span class="op" id="2111673">*</span><span class="op" id="2111674">(</span><span class="ident" id="2111675">pa3</span><span class="op" id="2111678">+</span><span class="ident" id="2111679">s</span><span class="op" id="2111680">*</span><span class="op" id="2111681">(</span><span class="ident" id="2111682">pa4</span><span class="op" id="2111685">+</span><span class="ident" id="2111686">s</span><span class="op" id="2111687">*</span><span class="op" id="2111688">(</span><span class="ident" id="2111689">pa5</span><span class="op" id="2111692">+</span><span class="ident" id="2111693">s</span><span class="op" id="2111694">*</span><span class="ident" id="2111695">pa6</span><span class="op" id="2111698">)</span><span class="op" id="2111699">)</span><span class="op" id="2111700">)</span><span class="op" id="2111701">)</span><span class="op" id="2111702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111706">Q</span>&nbsp;<span class="op" id="2111708">:=</span>&nbsp;<span class="num" id="2111711">1</span>&nbsp;<span class="op" id="2111713">+</span>&nbsp;<span class="ident" id="2111715">s</span><span class="op" id="2111716">*</span><span class="op" id="2111717">(</span><span class="ident" id="2111718">qa1</span><span class="op" id="2111721">+</span><span class="ident" id="2111722">s</span><span class="op" id="2111723">*</span><span class="op" id="2111724">(</span><span class="ident" id="2111725">qa2</span><span class="op" id="2111728">+</span><span class="ident" id="2111729">s</span><span class="op" id="2111730">*</span><span class="op" id="2111731">(</span><span class="ident" id="2111732">qa3</span><span class="op" id="2111735">+</span><span class="ident" id="2111736">s</span><span class="op" id="2111737">*</span><span class="op" id="2111738">(</span><span class="ident" id="2111739">qa4</span><span class="op" id="2111742">+</span><span class="ident" id="2111743">s</span><span class="op" id="2111744">*</span><span class="op" id="2111745">(</span><span class="ident" id="2111746">qa5</span><span class="op" id="2111749">+</span><span class="ident" id="2111750">s</span><span class="op" id="2111751">*</span><span class="ident" id="2111752">qa6</span><span class="op" id="2111755">)</span><span class="op" id="2111756">)</span><span class="op" id="2111757">)</span><span class="op" id="2111758">)</span><span class="op" id="2111759">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111763">if</span>&nbsp;<span class="ident" id="2111766">sign</span>&nbsp;<span class="op" id="2111771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111776">return</span>&nbsp;<span class="num" id="2111783">1</span>&nbsp;<span class="op" id="2111785">+</span>&nbsp;<span class="ident" id="2111787">erx</span>&nbsp;<span class="op" id="2111791">+</span>&nbsp;<span class="ident" id="2111793">P</span><span class="op" id="2111794">/</span><span class="ident" id="2111795">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2111799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111803">return</span>&nbsp;<span class="num" id="2111810">1</span>&nbsp;<span class="op" id="2111812">-</span>&nbsp;<span class="ident" id="2111814">erx</span>&nbsp;<span class="op" id="2111818">-</span>&nbsp;<span class="ident" id="2111820">P</span><span class="op" id="2111821">/</span><span class="ident" id="2111822">Q</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2111826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111829">if</span>&nbsp;<span class="ident" id="2111832">x</span>&nbsp;<span class="op" id="2111834">&lt;</span>&nbsp;<span class="num" id="2111836">28</span>&nbsp;<span class="op" id="2111839">{</span>&nbsp;<span class="comment" id="2111841">//&nbsp;|x|&nbsp;&lt;&nbsp;28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111855">s</span>&nbsp;<span class="op" id="2111857">:=</span>&nbsp;<span class="num" id="2111860">1</span>&nbsp;<span class="op" id="2111862">/</span>&nbsp;<span class="op" id="2111864">(</span><span class="ident" id="2111865">x</span>&nbsp;<span class="op" id="2111867">*</span>&nbsp;<span class="ident" id="2111869">x</span><span class="op" id="2111870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111874">var</span>&nbsp;<span class="ident" id="2111878">R</span><span class="op" id="2111879">,</span>&nbsp;<span class="ident" id="2111881">S</span>&nbsp;<span class="builtintype" id="2111883">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111893">if</span>&nbsp;<span class="ident" id="2111896">x</span>&nbsp;<span class="op" id="2111898">&lt;</span>&nbsp;<span class="num" id="2111900">1</span><span class="op" id="2111901">/</span><span class="num" id="2111902">0.35</span>&nbsp;<span class="op" id="2111907">{</span>&nbsp;<span class="comment" id="2111909">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111941">R</span>&nbsp;<span class="op" id="2111943">=</span>&nbsp;<span class="ident" id="2111945">ra0</span>&nbsp;<span class="op" id="2111949">+</span>&nbsp;<span class="ident" id="2111951">s</span><span class="op" id="2111952">*</span><span class="op" id="2111953">(</span><span class="ident" id="2111954">ra1</span><span class="op" id="2111957">+</span><span class="ident" id="2111958">s</span><span class="op" id="2111959">*</span><span class="op" id="2111960">(</span><span class="ident" id="2111961">ra2</span><span class="op" id="2111964">+</span><span class="ident" id="2111965">s</span><span class="op" id="2111966">*</span><span class="op" id="2111967">(</span><span class="ident" id="2111968">ra3</span><span class="op" id="2111971">+</span><span class="ident" id="2111972">s</span><span class="op" id="2111973">*</span><span class="op" id="2111974">(</span><span class="ident" id="2111975">ra4</span><span class="op" id="2111978">+</span><span class="ident" id="2111979">s</span><span class="op" id="2111980">*</span><span class="op" id="2111981">(</span><span class="ident" id="2111982">ra5</span><span class="op" id="2111985">+</span><span class="ident" id="2111986">s</span><span class="op" id="2111987">*</span><span class="op" id="2111988">(</span><span class="ident" id="2111989">ra6</span><span class="op" id="2111992">+</span><span class="ident" id="2111993">s</span><span class="op" id="2111994">*</span><span class="ident" id="2111995">ra7</span><span class="op" id="2111998">)</span><span class="op" id="2111999">)</span><span class="op" id="2112000">)</span><span class="op" id="2112001">)</span><span class="op" id="2112002">)</span><span class="op" id="2112003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2112008">S</span>&nbsp;<span class="op" id="2112010">=</span>&nbsp;<span class="num" id="2112012">1</span>&nbsp;<span class="op" id="2112014">+</span>&nbsp;<span class="ident" id="2112016">s</span><span class="op" id="2112017">*</span><span class="op" id="2112018">(</span><span class="ident" id="2112019">sa1</span><span class="op" id="2112022">+</span><span class="ident" id="2112023">s</span><span class="op" id="2112024">*</span><span class="op" id="2112025">(</span><span class="ident" id="2112026">sa2</span><span class="op" id="2112029">+</span><span class="ident" id="2112030">s</span><span class="op" id="2112031">*</span><span class="op" id="2112032">(</span><span class="ident" id="2112033">sa3</span><span class="op" id="2112036">+</span><span class="ident" id="2112037">s</span><span class="op" id="2112038">*</span><span class="op" id="2112039">(</span><span class="ident" id="2112040">sa4</span><span class="op" id="2112043">+</span><span class="ident" id="2112044">s</span><span class="op" id="2112045">*</span><span class="op" id="2112046">(</span><span class="ident" id="2112047">sa5</span><span class="op" id="2112050">+</span><span class="ident" id="2112051">s</span><span class="op" id="2112052">*</span><span class="op" id="2112053">(</span><span class="ident" id="2112054">sa6</span><span class="op" id="2112057">+</span><span class="ident" id="2112058">s</span><span class="op" id="2112059">*</span><span class="op" id="2112060">(</span><span class="ident" id="2112061">sa7</span><span class="op" id="2112064">+</span><span class="ident" id="2112065">s</span><span class="op" id="2112066">*</span><span class="ident" id="2112067">sa8</span><span class="op" id="2112070">)</span><span class="op" id="2112071">)</span><span class="op" id="2112072">)</span><span class="op" id="2112073">)</span><span class="op" id="2112074">)</span><span class="op" id="2112075">)</span><span class="op" id="2112076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2112080">}</span>&nbsp;<span class="keyword" id="2112082">else</span>&nbsp;<span class="op" id="2112087">{</span>&nbsp;<span class="comment" id="2112089">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112122">if</span>&nbsp;<span class="ident" id="2112125">sign</span>&nbsp;<span class="op" id="2112130">&amp;&amp;</span>&nbsp;<span class="ident" id="2112133">x</span>&nbsp;<span class="op" id="2112135">&gt;</span>&nbsp;<span class="num" id="2112137">6</span>&nbsp;<span class="op" id="2112139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112145">return</span>&nbsp;<span class="num" id="2112152">2</span>&nbsp;<span class="comment" id="2112154">//&nbsp;x&nbsp;&lt;&nbsp;-6</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2112167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2112172">R</span>&nbsp;<span class="op" id="2112174">=</span>&nbsp;<span class="ident" id="2112176">rb0</span>&nbsp;<span class="op" id="2112180">+</span>&nbsp;<span class="ident" id="2112182">s</span><span class="op" id="2112183">*</span><span class="op" id="2112184">(</span><span class="ident" id="2112185">rb1</span><span class="op" id="2112188">+</span><span class="ident" id="2112189">s</span><span class="op" id="2112190">*</span><span class="op" id="2112191">(</span><span class="ident" id="2112192">rb2</span><span class="op" id="2112195">+</span><span class="ident" id="2112196">s</span><span class="op" id="2112197">*</span><span class="op" id="2112198">(</span><span class="ident" id="2112199">rb3</span><span class="op" id="2112202">+</span><span class="ident" id="2112203">s</span><span class="op" id="2112204">*</span><span class="op" id="2112205">(</span><span class="ident" id="2112206">rb4</span><span class="op" id="2112209">+</span><span class="ident" id="2112210">s</span><span class="op" id="2112211">*</span><span class="op" id="2112212">(</span><span class="ident" id="2112213">rb5</span><span class="op" id="2112216">+</span><span class="ident" id="2112217">s</span><span class="op" id="2112218">*</span><span class="ident" id="2112219">rb6</span><span class="op" id="2112222">)</span><span class="op" id="2112223">)</span><span class="op" id="2112224">)</span><span class="op" id="2112225">)</span><span class="op" id="2112226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2112231">S</span>&nbsp;<span class="op" id="2112233">=</span>&nbsp;<span class="num" id="2112235">1</span>&nbsp;<span class="op" id="2112237">+</span>&nbsp;<span class="ident" id="2112239">s</span><span class="op" id="2112240">*</span><span class="op" id="2112241">(</span><span class="ident" id="2112242">sb1</span><span class="op" id="2112245">+</span><span class="ident" id="2112246">s</span><span class="op" id="2112247">*</span><span class="op" id="2112248">(</span><span class="ident" id="2112249">sb2</span><span class="op" id="2112252">+</span><span class="ident" id="2112253">s</span><span class="op" id="2112254">*</span><span class="op" id="2112255">(</span><span class="ident" id="2112256">sb3</span><span class="op" id="2112259">+</span><span class="ident" id="2112260">s</span><span class="op" id="2112261">*</span><span class="op" id="2112262">(</span><span class="ident" id="2112263">sb4</span><span class="op" id="2112266">+</span><span class="ident" id="2112267">s</span><span class="op" id="2112268">*</span><span class="op" id="2112269">(</span><span class="ident" id="2112270">sb5</span><span class="op" id="2112273">+</span><span class="ident" id="2112274">s</span><span class="op" id="2112275">*</span><span class="op" id="2112276">(</span><span class="ident" id="2112277">sb6</span><span class="op" id="2112280">+</span><span class="ident" id="2112281">s</span><span class="op" id="2112282">*</span><span class="ident" id="2112283">sb7</span><span class="op" id="2112286">)</span><span class="op" id="2112287">)</span><span class="op" id="2112288">)</span><span class="op" id="2112289">)</span><span class="op" id="2112290">)</span><span class="op" id="2112291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2112295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2112299">z</span>&nbsp;<span class="op" id="2112301">:=</span>&nbsp;<span class="ident" id="2112304">Float64frombits</span><span class="op" id="2112319">(</span><span class="ident" id="2112320">Float64bits</span><span class="op" id="2112331">(</span><span class="ident" id="2112332">x</span><span class="op" id="2112333">)</span>&nbsp;<span class="op" id="2112335">&amp;</span>&nbsp;<span class="num" id="2112337">0xffffffff00000000</span><span class="op" id="2112355">)</span>&nbsp;<span class="comment" id="2112357">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2112397">r</span>&nbsp;<span class="op" id="2112399">:=</span>&nbsp;<span class="ident" id="2112402">Exp</span><span class="op" id="2112405">(</span><span class="op" id="2112406">-</span><span class="ident" id="2112407">z</span><span class="op" id="2112408">*</span><span class="ident" id="2112409">z</span><span class="op" id="2112410">-</span><span class="num" id="2112411">0.5625</span><span class="op" id="2112417">)</span>&nbsp;<span class="op" id="2112419">*</span>&nbsp;<span class="ident" id="2112421">Exp</span><span class="op" id="2112424">(</span><span class="op" id="2112425">(</span><span class="ident" id="2112426">z</span><span class="op" id="2112427">-</span><span class="ident" id="2112428">x</span><span class="op" id="2112429">)</span><span class="op" id="2112430">*</span><span class="op" id="2112431">(</span><span class="ident" id="2112432">z</span><span class="op" id="2112433">+</span><span class="ident" id="2112434">x</span><span class="op" id="2112435">)</span><span class="op" id="2112436">+</span><span class="ident" id="2112437">R</span><span class="op" id="2112438">/</span><span class="ident" id="2112439">S</span><span class="op" id="2112440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112444">if</span>&nbsp;<span class="ident" id="2112447">sign</span>&nbsp;<span class="op" id="2112452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112457">return</span>&nbsp;<span class="num" id="2112464">2</span>&nbsp;<span class="op" id="2112466">-</span>&nbsp;<span class="ident" id="2112468">r</span><span class="op" id="2112469">/</span><span class="ident" id="2112470">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2112474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112478">return</span>&nbsp;<span class="ident" id="2112485">r</span>&nbsp;<span class="op" id="2112487">/</span>&nbsp;<span class="ident" id="2112489">x</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2112492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112495">if</span>&nbsp;<span class="ident" id="2112498">sign</span>&nbsp;<span class="op" id="2112503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112507">return</span>&nbsp;<span class="num" id="2112514">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2112517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112520">return</span>&nbsp;<span class="num" id="2112527">0</span><br>
<span class="lineno">335</span><span class="op" id="2112529">}</span>
</div>
</body>
</html>
