<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html" class="current">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2192281">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2192336">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2192390">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2192441">package</span>&nbsp;<span class="ident" id="2192449">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2192455">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2192515">//&nbsp;below&nbsp;are&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/s_log1p.c</span><br>
<span class="lineno"></span><span class="comment" id="2192575">//&nbsp;and&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno">10</span><span class="comment" id="2192634">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="2192664">//</span><br>
<span class="lineno"></span><span class="comment" id="2192667">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2192723">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2192792">//</span><br>
<span class="lineno">15</span><span class="comment" id="2192795">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno"></span><span class="comment" id="2192854">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2192910">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2192967">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2192984">//&nbsp;====================================================</span><br>
<span class="lineno">20</span><span class="comment" id="2193040">//</span><br>
<span class="lineno"></span><span class="comment" id="2193043">//</span><br>
<span class="lineno"></span><span class="comment" id="2193046">//&nbsp;double&nbsp;log1p(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2193072">//</span><br>
<span class="lineno"></span><span class="comment" id="2193075">//&nbsp;Method&nbsp;:</span><br>
<span class="lineno">25</span><span class="comment" id="2193087">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;Reduction:&nbsp;find&nbsp;k&nbsp;and&nbsp;f&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2193138">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1+x&nbsp;=&nbsp;2**k&nbsp;*&nbsp;(1+f),</span><br>
<span class="lineno"></span><span class="comment" id="2193182">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;sqrt(2)/2&nbsp;&lt;&nbsp;1+f&nbsp;&lt;&nbsp;sqrt(2)&nbsp;.</span><br>
<span class="lineno"></span><span class="comment" id="2193228">//</span><br>
<span class="lineno"></span><span class="comment" id="2193231">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note.&nbsp;If&nbsp;k=0,&nbsp;then&nbsp;f=x&nbsp;is&nbsp;exact.&nbsp;However,&nbsp;if&nbsp;k!=0,&nbsp;then&nbsp;f</span><br>
<span class="lineno">30</span><span class="comment" id="2193297">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;may&nbsp;not&nbsp;be&nbsp;representable&nbsp;exactly.&nbsp;In&nbsp;that&nbsp;case,&nbsp;a&nbsp;correction</span><br>
<span class="lineno"></span><span class="comment" id="2193366">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;term&nbsp;is&nbsp;need.&nbsp;Let&nbsp;u=1+x&nbsp;rounded.&nbsp;Let&nbsp;c&nbsp;=&nbsp;(1+x)-u,&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="2193429">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log(1+x)&nbsp;-&nbsp;log(u)&nbsp;~&nbsp;c/u.&nbsp;Thus,&nbsp;we&nbsp;proceed&nbsp;to&nbsp;compute&nbsp;log(u),</span><br>
<span class="lineno"></span><span class="comment" id="2193498">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;add&nbsp;back&nbsp;the&nbsp;correction&nbsp;term&nbsp;c/u.</span><br>
<span class="lineno"></span><span class="comment" id="2193544">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Note:&nbsp;when&nbsp;x&nbsp;&gt;&nbsp;2**53,&nbsp;one&nbsp;can&nbsp;simply&nbsp;return&nbsp;log(x))</span><br>
<span class="lineno">35</span><span class="comment" id="2193605">//</span><br>
<span class="lineno"></span><span class="comment" id="2193608">//&nbsp;&nbsp;&nbsp;2.&nbsp;Approximation&nbsp;of&nbsp;log1p(f).</span><br>
<span class="lineno"></span><span class="comment" id="2193643">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s&nbsp;=&nbsp;f/(2+f)&nbsp;;&nbsp;based&nbsp;on&nbsp;log(1+f)&nbsp;=&nbsp;log(1+s)&nbsp;-&nbsp;log(1-s)</span><br>
<span class="lineno"></span><span class="comment" id="2193709">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2s&nbsp;+&nbsp;2/3&nbsp;s**3&nbsp;+&nbsp;2/5&nbsp;s**5&nbsp;+&nbsp;.....,</span><br>
<span class="lineno"></span><span class="comment" id="2193762">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2s&nbsp;+&nbsp;s*R</span><br>
<span class="lineno">40</span><span class="comment" id="2193790">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;a&nbsp;special&nbsp;Reme&nbsp;algorithm&nbsp;on&nbsp;[0,0.1716]&nbsp;to&nbsp;generate</span><br>
<span class="lineno"></span><span class="comment" id="2193856">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;polynomial&nbsp;of&nbsp;degree&nbsp;14&nbsp;to&nbsp;approximate&nbsp;R&nbsp;The&nbsp;maximum&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2193925">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;this&nbsp;polynomial&nbsp;approximation&nbsp;is&nbsp;bounded&nbsp;by&nbsp;2**-58.45.&nbsp;In</span><br>
<span class="lineno"></span><span class="comment" id="2193994">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other&nbsp;words,</span><br>
<span class="lineno"></span><span class="comment" id="2194015">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14</span><br>
<span class="lineno">45</span><span class="comment" id="2194086">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(z)&nbsp;~&nbsp;Lp1*s&nbsp;+Lp2*s&nbsp;+Lp3*s&nbsp;+Lp4*s&nbsp;+Lp5*s&nbsp;&nbsp;+Lp6*s&nbsp;&nbsp;+Lp7*s</span><br>
<span class="lineno"></span><span class="comment" id="2194155">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(the&nbsp;values&nbsp;of&nbsp;Lp1&nbsp;to&nbsp;Lp7&nbsp;are&nbsp;listed&nbsp;in&nbsp;the&nbsp;program)</span><br>
<span class="lineno"></span><span class="comment" id="2194216">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2194228">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-58.45</span><br>
<span class="lineno"></span><span class="comment" id="2194283">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Lp1*s&nbsp;+...+Lp7*s&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;R(z)&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno">50</span><span class="comment" id="2194332">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br>
<span class="lineno"></span><span class="comment" id="2194376">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note&nbsp;that&nbsp;2s&nbsp;=&nbsp;f&nbsp;-&nbsp;s*f&nbsp;=&nbsp;f&nbsp;-&nbsp;hfsq&nbsp;+&nbsp;s*hfsq,&nbsp;where&nbsp;hfsq&nbsp;=&nbsp;f*f/2.</span><br>
<span class="lineno"></span><span class="comment" id="2194448">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;In&nbsp;order&nbsp;to&nbsp;guarantee&nbsp;error&nbsp;in&nbsp;log&nbsp;below&nbsp;1ulp,&nbsp;we&nbsp;compute&nbsp;log</span><br>
<span class="lineno"></span><span class="comment" id="2194518">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2194529">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log1p(f)&nbsp;=&nbsp;f&nbsp;-&nbsp;(hfsq&nbsp;-&nbsp;s*(hfsq+R)).</span><br>
<span class="lineno">55</span><span class="comment" id="2194581">//</span><br>
<span class="lineno"></span><span class="comment" id="2194584">//&nbsp;&nbsp;&nbsp;3.&nbsp;Finally,&nbsp;log1p(x)&nbsp;=&nbsp;k*ln2&nbsp;+&nbsp;log1p(f).</span><br>
<span class="lineno"></span><span class="comment" id="2194630">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;k*ln2_hi+(f-(hfsq-(s*(hfsq+R)+k*ln2_lo)))</span><br>
<span class="lineno"></span><span class="comment" id="2194700">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;ln2&nbsp;is&nbsp;split&nbsp;into&nbsp;two&nbsp;floating&nbsp;point&nbsp;number:</span><br>
<span class="lineno"></span><span class="comment" id="2194758">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ln2_hi&nbsp;+&nbsp;ln2_lo,</span><br>
<span class="lineno">60</span><span class="comment" id="2194796">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;n*ln2_hi&nbsp;is&nbsp;always&nbsp;exact&nbsp;for&nbsp;|n|&nbsp;&lt;&nbsp;2000.</span><br>
<span class="lineno"></span><span class="comment" id="2194851">//</span><br>
<span class="lineno"></span><span class="comment" id="2194854">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="2194872">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log1p(x)&nbsp;is&nbsp;NaN&nbsp;with&nbsp;signal&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;-1&nbsp;(including&nbsp;-INF)&nbsp;;</span><br>
<span class="lineno"></span><span class="comment" id="2194937">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log1p(+INF)&nbsp;is&nbsp;+INF;&nbsp;log1p(-1)&nbsp;is&nbsp;-INF&nbsp;with&nbsp;signal;</span><br>
<span class="lineno">65</span><span class="comment" id="2194997">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log1p(NaN)&nbsp;is&nbsp;that&nbsp;NaN&nbsp;with&nbsp;no&nbsp;signal.</span><br>
<span class="lineno"></span><span class="comment" id="2195044">//</span><br>
<span class="lineno"></span><span class="comment" id="2195047">//&nbsp;Accuracy:</span><br>
<span class="lineno"></span><span class="comment" id="2195060">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;according&nbsp;to&nbsp;an&nbsp;error&nbsp;analysis,&nbsp;the&nbsp;error&nbsp;is&nbsp;always&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2195130">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;ulp&nbsp;(unit&nbsp;in&nbsp;the&nbsp;last&nbsp;place).</span><br>
<span class="lineno">70</span><span class="comment" id="2195170">//</span><br>
<span class="lineno"></span><span class="comment" id="2195173">//&nbsp;Constants:</span><br>
<span class="lineno"></span><span class="comment" id="2195187">//&nbsp;The&nbsp;hexadecimal&nbsp;values&nbsp;are&nbsp;the&nbsp;intended&nbsp;ones&nbsp;for&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="2195253">//&nbsp;constants.&nbsp;The&nbsp;decimal&nbsp;values&nbsp;may&nbsp;be&nbsp;used,&nbsp;provided&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2195317">//&nbsp;compiler&nbsp;will&nbsp;convert&nbsp;from&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;accurately&nbsp;enough</span><br>
<span class="lineno">75</span><span class="comment" id="2195383">//&nbsp;to&nbsp;produce&nbsp;the&nbsp;hexadecimal&nbsp;values&nbsp;shown.</span><br>
<span class="lineno"></span><span class="comment" id="2195427">//</span><br>
<span class="lineno"></span><span class="comment" id="2195430">//&nbsp;Note:&nbsp;Assuming&nbsp;log()&nbsp;return&nbsp;accurate&nbsp;answer,&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="2195492">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;algorithm&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;compute&nbsp;log1p(x)&nbsp;to&nbsp;within&nbsp;a&nbsp;few&nbsp;ULP:</span><br>
<span class="lineno"></span><span class="comment" id="2195564">//</span><br>
<span class="lineno">80</span><span class="comment" id="2195567">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u&nbsp;=&nbsp;1+x;</span><br>
<span class="lineno"></span><span class="comment" id="2195592">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(u==1.0)&nbsp;return&nbsp;x&nbsp;;&nbsp;else</span><br>
<span class="lineno"></span><span class="comment" id="2195635">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;log(u)*(x/(u-1.0));</span><br>
<span class="lineno"></span><span class="comment" id="2195689">//</span><br>
<span class="lineno"></span><span class="comment" id="2195692">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;See&nbsp;HP-15C&nbsp;Advanced&nbsp;Functions&nbsp;Handbook,&nbsp;p.193.</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="2195749">//&nbsp;Log1p&nbsp;returns&nbsp;the&nbsp;natural&nbsp;logarithm&nbsp;of&nbsp;1&nbsp;plus&nbsp;its&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2195814">//&nbsp;It&nbsp;is&nbsp;more&nbsp;accurate&nbsp;than&nbsp;Log(1&nbsp;+&nbsp;x)&nbsp;when&nbsp;x&nbsp;is&nbsp;near&nbsp;zero.</span><br>
<span class="lineno"></span><span class="comment" id="2195874">//</span><br>
<span class="lineno"></span><span class="comment" id="2195877">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">90</span><span class="comment" id="2195899">//&nbsp;&nbsp;&nbsp;&nbspLog1p(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2195921">//&nbsp;&nbsp;&nbsp;&nbspLog1p(±0)&nbsp;=&nbsp;±0</span><br>
<span class="lineno"></span><span class="comment" id="2195941">//&nbsp;&nbsp;&nbsp;&nbspLog1p(-1)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2195961">//&nbsp;&nbsp;&nbsp;&nbspLog1p(x&nbsp;&lt;&nbsp;-1)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2195984">//&nbsp;&nbsp;&nbsp;&nbspLog1p(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">95</span><span class="keyword" id="2196004">func</span>&nbsp;<span class="ident" id="2196009">Log1p</span><span class="op" id="2196014">(</span><span class="ident" id="2196015">x</span>&nbsp;<span class="builtintype" id="2196017">float64</span><span class="op" id="2196024">)</span>&nbsp;<span class="builtintype" id="2196026">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2196035">func</span>&nbsp;<span class="ident" id="2196040">log1p</span><span class="op" id="2196045">(</span><span class="ident" id="2196046">x</span>&nbsp;<span class="builtintype" id="2196048">float64</span><span class="op" id="2196055">)</span>&nbsp;<span class="builtintype" id="2196057">float64</span>&nbsp;<span class="op" id="2196065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2196068">const</span>&nbsp;<span class="op" id="2196074">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196078">Sqrt2M1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2196090">=</span>&nbsp;<span class="num" id="2196092">4.142135623730950488017e-01</span>&nbsp;&nbsp;<span class="comment" id="2196121">//&nbsp;Sqrt(2)-1&nbsp;=&nbsp;0x3fda827999fcef34</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196157">Sqrt2HalfM1</span>&nbsp;<span class="op" id="2196169">=</span>&nbsp;<span class="op" id="2196171">-</span><span class="num" id="2196172">2.928932188134524755992e-01</span>&nbsp;<span class="comment" id="2196200">//&nbsp;Sqrt(2)/2-1&nbsp;=&nbsp;0xbfd2bec333018866</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196238">Small</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2196250">=</span>&nbsp;<span class="num" id="2196252">1.0</span>&nbsp;<span class="op" id="2196256">/</span>&nbsp;<span class="op" id="2196258">(</span><span class="num" id="2196259">1</span>&nbsp;<span class="op" id="2196261">&lt;&lt;</span>&nbsp;<span class="num" id="2196264">29</span><span class="op" id="2196266">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2196281">//&nbsp;2**-29&nbsp;=&nbsp;0x3e20000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196314">Tiny</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2196326">=</span>&nbsp;<span class="num" id="2196328">1.0</span>&nbsp;<span class="op" id="2196332">/</span>&nbsp;<span class="op" id="2196334">(</span><span class="num" id="2196335">1</span>&nbsp;<span class="op" id="2196337">&lt;&lt;</span>&nbsp;<span class="num" id="2196340">54</span><span class="op" id="2196342">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2196357">//&nbsp;2**-54</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196369">Two53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2196381">=</span>&nbsp;<span class="num" id="2196383">1</span>&nbsp;<span class="op" id="2196385">&lt;&lt;</span>&nbsp;<span class="num" id="2196388">53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2196412">//&nbsp;2**53</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196423">Ln2Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2196435">=</span>&nbsp;<span class="num" id="2196437">6.93147180369123816490e-01</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2196466">//&nbsp;3fe62e42fee00000</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196488">Ln2Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2196500">=</span>&nbsp;<span class="num" id="2196502">1.90821492927058770002e-10</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2196531">//&nbsp;3dea39ef35793c76</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196553">Lp1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2196565">=</span>&nbsp;<span class="num" id="2196567">6.666666666666735130e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2196596">//&nbsp;3FE5555555555593</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196618">Lp2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2196630">=</span>&nbsp;<span class="num" id="2196632">3.999999999940941908e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2196661">//&nbsp;3FD999999997FA04</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196683">Lp3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2196695">=</span>&nbsp;<span class="num" id="2196697">2.857142874366239149e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2196726">//&nbsp;3FD2492494229359</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196748">Lp4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2196760">=</span>&nbsp;<span class="num" id="2196762">2.222219843214978396e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2196791">//&nbsp;3FCC71C51D8E78AF</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196813">Lp5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2196825">=</span>&nbsp;<span class="num" id="2196827">1.818357216161805012e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2196856">//&nbsp;3FC7466496CB03DE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196878">Lp6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2196890">=</span>&nbsp;<span class="num" id="2196892">1.531383769920937332e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2196921">//&nbsp;3FC39A09D078C69F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2196943">Lp7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2196955">=</span>&nbsp;<span class="num" id="2196957">1.479819860511658591e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2196986">//&nbsp;3FC2F112DF3E5244</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197007">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2197011">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2197029">switch</span>&nbsp;<span class="op" id="2197036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2197039">case</span>&nbsp;<span class="ident" id="2197044">x</span>&nbsp;<span class="op" id="2197046">&lt;</span>&nbsp;<span class="op" id="2197048">-</span><span class="num" id="2197049">1</span>&nbsp;<span class="op" id="2197051">||</span>&nbsp;<span class="ident" id="2197054">IsNaN</span><span class="op" id="2197059">(</span><span class="ident" id="2197060">x</span><span class="op" id="2197061">)</span><span class="op" id="2197062">:</span>&nbsp;<span class="comment" id="2197064">//&nbsp;includes&nbsp;-Inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2197083">return</span>&nbsp;<span class="ident" id="2197090">NaN</span><span class="op" id="2197093">(</span><span class="op" id="2197094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2197097">case</span>&nbsp;<span class="ident" id="2197102">x</span>&nbsp;<span class="op" id="2197104">==</span>&nbsp;<span class="op" id="2197107">-</span><span class="num" id="2197108">1</span><span class="op" id="2197109">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2197113">return</span>&nbsp;<span class="ident" id="2197120">Inf</span><span class="op" id="2197123">(</span><span class="op" id="2197124">-</span><span class="num" id="2197125">1</span><span class="op" id="2197126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2197129">case</span>&nbsp;<span class="ident" id="2197134">IsInf</span><span class="op" id="2197139">(</span><span class="ident" id="2197140">x</span><span class="op" id="2197141">,</span>&nbsp;<span class="num" id="2197143">1</span><span class="op" id="2197144">)</span><span class="op" id="2197145">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2197149">return</span>&nbsp;<span class="ident" id="2197156">Inf</span><span class="op" id="2197159">(</span><span class="num" id="2197160">1</span><span class="op" id="2197161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2197168">absx</span>&nbsp;<span class="op" id="2197173">:=</span>&nbsp;<span class="ident" id="2197176">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2197179">if</span>&nbsp;<span class="ident" id="2197182">absx</span>&nbsp;<span class="op" id="2197187">&lt;</span>&nbsp;<span class="num" id="2197189">0</span>&nbsp;<span class="op" id="2197191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2197195">absx</span>&nbsp;<span class="op" id="2197200">=</span>&nbsp;<span class="op" id="2197202">-</span><span class="ident" id="2197203">absx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2197213">var</span>&nbsp;<span class="ident" id="2197217">f</span>&nbsp;<span class="builtintype" id="2197219">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2197228">var</span>&nbsp;<span class="ident" id="2197232">iu</span>&nbsp;<span class="ident" id="2197235">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2197243">k</span>&nbsp;<span class="op" id="2197245">:=</span>&nbsp;<span class="num" id="2197248">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2197251">if</span>&nbsp;<span class="ident" id="2197254">absx</span>&nbsp;<span class="op" id="2197259">&lt;</span>&nbsp;<span class="ident" id="2197261">Sqrt2M1</span>&nbsp;<span class="op" id="2197269">{</span>&nbsp;<span class="comment" id="2197271">//&nbsp;&nbsp;|x|&nbsp;&lt;&nbsp;Sqrt(2)-1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2197293">if</span>&nbsp;<span class="ident" id="2197296">absx</span>&nbsp;<span class="op" id="2197301">&lt;</span>&nbsp;<span class="ident" id="2197303">Small</span>&nbsp;<span class="op" id="2197309">{</span>&nbsp;<span class="comment" id="2197311">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-29</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2197330">if</span>&nbsp;<span class="ident" id="2197333">absx</span>&nbsp;<span class="op" id="2197338">&lt;</span>&nbsp;<span class="ident" id="2197340">Tiny</span>&nbsp;<span class="op" id="2197345">{</span>&nbsp;<span class="comment" id="2197347">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-54</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2197367">return</span>&nbsp;<span class="ident" id="2197374">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2197384">return</span>&nbsp;<span class="ident" id="2197391">x</span>&nbsp;<span class="op" id="2197393">-</span>&nbsp;<span class="ident" id="2197395">x</span><span class="op" id="2197396">*</span><span class="ident" id="2197397">x</span><span class="op" id="2197398">*</span><span class="num" id="2197399">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197405">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2197409">if</span>&nbsp;<span class="ident" id="2197412">x</span>&nbsp;<span class="op" id="2197414">&gt;</span>&nbsp;<span class="ident" id="2197416">Sqrt2HalfM1</span>&nbsp;<span class="op" id="2197428">{</span>&nbsp;<span class="comment" id="2197430">//&nbsp;Sqrt(2)/2-1&nbsp;&lt;&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2197452">//&nbsp;(Sqrt(2)/2-1)&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;(Sqrt(2)-1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2197490">k</span>&nbsp;<span class="op" id="2197492">=</span>&nbsp;<span class="num" id="2197494">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2197499">f</span>&nbsp;<span class="op" id="2197501">=</span>&nbsp;<span class="ident" id="2197503">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2197508">iu</span>&nbsp;<span class="op" id="2197511">=</span>&nbsp;<span class="num" id="2197513">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2197523">var</span>&nbsp;<span class="ident" id="2197527">c</span>&nbsp;<span class="builtintype" id="2197529">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2197538">if</span>&nbsp;<span class="ident" id="2197541">k</span>&nbsp;<span class="op" id="2197543">!=</span>&nbsp;<span class="num" id="2197546">0</span>&nbsp;<span class="op" id="2197548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2197552">var</span>&nbsp;<span class="ident" id="2197556">u</span>&nbsp;<span class="builtintype" id="2197558">float64</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2197568">if</span>&nbsp;<span class="ident" id="2197571">absx</span>&nbsp;<span class="op" id="2197576">&lt;</span>&nbsp;<span class="ident" id="2197578">Two53</span>&nbsp;<span class="op" id="2197584">{</span>&nbsp;<span class="comment" id="2197586">//&nbsp;1&lt;&lt;53</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2197598">u</span>&nbsp;<span class="op" id="2197600">=</span>&nbsp;<span class="num" id="2197602">1.0</span>&nbsp;<span class="op" id="2197606">+</span>&nbsp;<span class="ident" id="2197608">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2197613">iu</span>&nbsp;<span class="op" id="2197616">=</span>&nbsp;<span class="ident" id="2197618">Float64bits</span><span class="op" id="2197629">(</span><span class="ident" id="2197630">u</span><span class="op" id="2197631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2197636">k</span>&nbsp;<span class="op" id="2197638">=</span>&nbsp;<span class="builtintype" id="2197640">int</span><span class="op" id="2197643">(</span><span class="op" id="2197644">(</span><span class="ident" id="2197645">iu</span>&nbsp;<span class="op" id="2197648">&gt;&gt;</span>&nbsp;<span class="num" id="2197651">52</span><span class="op" id="2197653">)</span>&nbsp;<span class="op" id="2197655">-</span>&nbsp;<span class="num" id="2197657">1023</span><span class="op" id="2197661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2197666">if</span>&nbsp;<span class="ident" id="2197669">k</span>&nbsp;<span class="op" id="2197671">&gt;</span>&nbsp;<span class="num" id="2197673">0</span>&nbsp;<span class="op" id="2197675">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2197681">c</span>&nbsp;<span class="op" id="2197683">=</span>&nbsp;<span class="num" id="2197685">1.0</span>&nbsp;<span class="op" id="2197689">-</span>&nbsp;<span class="op" id="2197691">(</span><span class="ident" id="2197692">u</span>&nbsp;<span class="op" id="2197694">-</span>&nbsp;<span class="ident" id="2197696">x</span><span class="op" id="2197697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197702">}</span>&nbsp;<span class="keyword" id="2197704">else</span>&nbsp;<span class="op" id="2197709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2197715">c</span>&nbsp;<span class="op" id="2197717">=</span>&nbsp;<span class="ident" id="2197719">x</span>&nbsp;<span class="op" id="2197721">-</span>&nbsp;<span class="op" id="2197723">(</span><span class="ident" id="2197724">u</span>&nbsp;<span class="op" id="2197726">-</span>&nbsp;<span class="num" id="2197728">1.0</span><span class="op" id="2197731">)</span>&nbsp;<span class="comment" id="2197733">//&nbsp;correction&nbsp;term</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2197756">c</span>&nbsp;<span class="op" id="2197758">/=</span>&nbsp;<span class="ident" id="2197761">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197766">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197770">}</span>&nbsp;<span class="keyword" id="2197772">else</span>&nbsp;<span class="op" id="2197777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2197782">u</span>&nbsp;<span class="op" id="2197784">=</span>&nbsp;<span class="ident" id="2197786">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2197791">iu</span>&nbsp;<span class="op" id="2197794">=</span>&nbsp;<span class="ident" id="2197796">Float64bits</span><span class="op" id="2197807">(</span><span class="ident" id="2197808">u</span><span class="op" id="2197809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2197814">k</span>&nbsp;<span class="op" id="2197816">=</span>&nbsp;<span class="builtintype" id="2197818">int</span><span class="op" id="2197821">(</span><span class="op" id="2197822">(</span><span class="ident" id="2197823">iu</span>&nbsp;<span class="op" id="2197826">&gt;&gt;</span>&nbsp;<span class="num" id="2197829">52</span><span class="op" id="2197831">)</span>&nbsp;<span class="op" id="2197833">-</span>&nbsp;<span class="num" id="2197835">1023</span><span class="op" id="2197839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2197844">c</span>&nbsp;<span class="op" id="2197846">=</span>&nbsp;<span class="num" id="2197848">0</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2197852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2197856">iu</span>&nbsp;<span class="op" id="2197859">&amp;=</span>&nbsp;<span class="num" id="2197862">0x000fffffffffffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2197883">if</span>&nbsp;<span class="ident" id="2197886">iu</span>&nbsp;<span class="op" id="2197889">&lt;</span>&nbsp;<span class="num" id="2197891">0x0006a09e667f3bcd</span>&nbsp;<span class="op" id="2197910">{</span>&nbsp;<span class="comment" id="2197912">//&nbsp;mantissa&nbsp;of&nbsp;Sqrt(2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2197938">u</span>&nbsp;<span class="op" id="2197940">=</span>&nbsp;<span class="ident" id="2197942">Float64frombits</span><span class="op" id="2197957">(</span><span class="ident" id="2197958">iu</span>&nbsp;<span class="op" id="2197961">|</span>&nbsp;<span class="num" id="2197963">0x3ff0000000000000</span><span class="op" id="2197981">)</span>&nbsp;<span class="comment" id="2197983">//&nbsp;normalize&nbsp;u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198000">}</span>&nbsp;<span class="keyword" id="2198002">else</span>&nbsp;<span class="op" id="2198007">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2198012">k</span>&nbsp;<span class="op" id="2198014">+=</span>&nbsp;<span class="num" id="2198017">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2198022">u</span>&nbsp;<span class="op" id="2198024">=</span>&nbsp;<span class="ident" id="2198026">Float64frombits</span><span class="op" id="2198041">(</span><span class="ident" id="2198042">iu</span>&nbsp;<span class="op" id="2198045">|</span>&nbsp;<span class="num" id="2198047">0x3fe0000000000000</span><span class="op" id="2198065">)</span>&nbsp;<span class="comment" id="2198067">//&nbsp;normalize&nbsp;u/2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2198087">iu</span>&nbsp;<span class="op" id="2198090">=</span>&nbsp;<span class="op" id="2198092">(</span><span class="num" id="2198093">0x0010000000000000</span>&nbsp;<span class="op" id="2198112">-</span>&nbsp;<span class="ident" id="2198114">iu</span><span class="op" id="2198116">)</span>&nbsp;<span class="op" id="2198118">&gt;&gt;</span>&nbsp;<span class="num" id="2198121">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2198129">f</span>&nbsp;<span class="op" id="2198131">=</span>&nbsp;<span class="ident" id="2198133">u</span>&nbsp;<span class="op" id="2198135">-</span>&nbsp;<span class="num" id="2198137">1.0</span>&nbsp;<span class="comment" id="2198141">//&nbsp;Sqrt(2)/2&nbsp;&lt;&nbsp;u&nbsp;&lt;&nbsp;Sqrt(2)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2198172">hfsq</span>&nbsp;<span class="op" id="2198177">:=</span>&nbsp;<span class="num" id="2198180">0.5</span>&nbsp;<span class="op" id="2198184">*</span>&nbsp;<span class="ident" id="2198186">f</span>&nbsp;<span class="op" id="2198188">*</span>&nbsp;<span class="ident" id="2198190">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2198193">var</span>&nbsp;<span class="ident" id="2198197">s</span><span class="op" id="2198198">,</span>&nbsp;<span class="ident" id="2198200">R</span><span class="op" id="2198201">,</span>&nbsp;<span class="ident" id="2198203">z</span>&nbsp;<span class="builtintype" id="2198205">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2198214">if</span>&nbsp;<span class="ident" id="2198217">iu</span>&nbsp;<span class="op" id="2198220">==</span>&nbsp;<span class="num" id="2198223">0</span>&nbsp;<span class="op" id="2198225">{</span>&nbsp;<span class="comment" id="2198227">//&nbsp;|f|&nbsp;&lt;&nbsp;2**-20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2198245">if</span>&nbsp;<span class="ident" id="2198248">f</span>&nbsp;<span class="op" id="2198250">==</span>&nbsp;<span class="num" id="2198253">0</span>&nbsp;<span class="op" id="2198255">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2198260">if</span>&nbsp;<span class="ident" id="2198263">k</span>&nbsp;<span class="op" id="2198265">==</span>&nbsp;<span class="num" id="2198268">0</span>&nbsp;<span class="op" id="2198270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2198276">return</span>&nbsp;<span class="num" id="2198283">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198288">}</span>&nbsp;<span class="keyword" id="2198290">else</span>&nbsp;<span class="op" id="2198295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2198301">c</span>&nbsp;<span class="op" id="2198303">+=</span>&nbsp;<span class="builtintype" id="2198306">float64</span><span class="op" id="2198313">(</span><span class="ident" id="2198314">k</span><span class="op" id="2198315">)</span>&nbsp;<span class="op" id="2198317">*</span>&nbsp;<span class="ident" id="2198319">Ln2Lo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2198329">return</span>&nbsp;<span class="builtintype" id="2198336">float64</span><span class="op" id="2198343">(</span><span class="ident" id="2198344">k</span><span class="op" id="2198345">)</span><span class="op" id="2198346">*</span><span class="ident" id="2198347">Ln2Hi</span>&nbsp;<span class="op" id="2198353">+</span>&nbsp;<span class="ident" id="2198355">c</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2198368">R</span>&nbsp;<span class="op" id="2198370">=</span>&nbsp;<span class="ident" id="2198372">hfsq</span>&nbsp;<span class="op" id="2198377">*</span>&nbsp;<span class="op" id="2198379">(</span><span class="num" id="2198380">1.0</span>&nbsp;<span class="op" id="2198384">-</span>&nbsp;<span class="num" id="2198386">0.66666666666666666</span><span class="op" id="2198405">*</span><span class="ident" id="2198406">f</span><span class="op" id="2198407">)</span>&nbsp;<span class="comment" id="2198409">//&nbsp;avoid&nbsp;division</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2198429">if</span>&nbsp;<span class="ident" id="2198432">k</span>&nbsp;<span class="op" id="2198434">==</span>&nbsp;<span class="num" id="2198437">0</span>&nbsp;<span class="op" id="2198439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2198444">return</span>&nbsp;<span class="ident" id="2198451">f</span>&nbsp;<span class="op" id="2198453">-</span>&nbsp;<span class="ident" id="2198455">R</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2198463">return</span>&nbsp;<span class="builtintype" id="2198470">float64</span><span class="op" id="2198477">(</span><span class="ident" id="2198478">k</span><span class="op" id="2198479">)</span><span class="op" id="2198480">*</span><span class="ident" id="2198481">Ln2Hi</span>&nbsp;<span class="op" id="2198487">-</span>&nbsp;<span class="op" id="2198489">(</span><span class="op" id="2198490">(</span><span class="ident" id="2198491">R</span>&nbsp;<span class="op" id="2198493">-</span>&nbsp;<span class="op" id="2198495">(</span><span class="builtintype" id="2198496">float64</span><span class="op" id="2198503">(</span><span class="ident" id="2198504">k</span><span class="op" id="2198505">)</span><span class="op" id="2198506">*</span><span class="ident" id="2198507">Ln2Lo</span>&nbsp;<span class="op" id="2198513">+</span>&nbsp;<span class="ident" id="2198515">c</span><span class="op" id="2198516">)</span><span class="op" id="2198517">)</span>&nbsp;<span class="op" id="2198519">-</span>&nbsp;<span class="ident" id="2198521">f</span><span class="op" id="2198522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2198528">s</span>&nbsp;<span class="op" id="2198530">=</span>&nbsp;<span class="ident" id="2198532">f</span>&nbsp;<span class="op" id="2198534">/</span>&nbsp;<span class="op" id="2198536">(</span><span class="num" id="2198537">2.0</span>&nbsp;<span class="op" id="2198541">+</span>&nbsp;<span class="ident" id="2198543">f</span><span class="op" id="2198544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2198547">z</span>&nbsp;<span class="op" id="2198549">=</span>&nbsp;<span class="ident" id="2198551">s</span>&nbsp;<span class="op" id="2198553">*</span>&nbsp;<span class="ident" id="2198555">s</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2198558">R</span>&nbsp;<span class="op" id="2198560">=</span>&nbsp;<span class="ident" id="2198562">z</span>&nbsp;<span class="op" id="2198564">*</span>&nbsp;<span class="op" id="2198566">(</span><span class="ident" id="2198567">Lp1</span>&nbsp;<span class="op" id="2198571">+</span>&nbsp;<span class="ident" id="2198573">z</span><span class="op" id="2198574">*</span><span class="op" id="2198575">(</span><span class="ident" id="2198576">Lp2</span><span class="op" id="2198579">+</span><span class="ident" id="2198580">z</span><span class="op" id="2198581">*</span><span class="op" id="2198582">(</span><span class="ident" id="2198583">Lp3</span><span class="op" id="2198586">+</span><span class="ident" id="2198587">z</span><span class="op" id="2198588">*</span><span class="op" id="2198589">(</span><span class="ident" id="2198590">Lp4</span><span class="op" id="2198593">+</span><span class="ident" id="2198594">z</span><span class="op" id="2198595">*</span><span class="op" id="2198596">(</span><span class="ident" id="2198597">Lp5</span><span class="op" id="2198600">+</span><span class="ident" id="2198601">z</span><span class="op" id="2198602">*</span><span class="op" id="2198603">(</span><span class="ident" id="2198604">Lp6</span><span class="op" id="2198607">+</span><span class="ident" id="2198608">z</span><span class="op" id="2198609">*</span><span class="ident" id="2198610">Lp7</span><span class="op" id="2198613">)</span><span class="op" id="2198614">)</span><span class="op" id="2198615">)</span><span class="op" id="2198616">)</span><span class="op" id="2198617">)</span><span class="op" id="2198618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2198621">if</span>&nbsp;<span class="ident" id="2198624">k</span>&nbsp;<span class="op" id="2198626">==</span>&nbsp;<span class="num" id="2198629">0</span>&nbsp;<span class="op" id="2198631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2198635">return</span>&nbsp;<span class="ident" id="2198642">f</span>&nbsp;<span class="op" id="2198644">-</span>&nbsp;<span class="op" id="2198646">(</span><span class="ident" id="2198647">hfsq</span>&nbsp;<span class="op" id="2198652">-</span>&nbsp;<span class="ident" id="2198654">s</span><span class="op" id="2198655">*</span><span class="op" id="2198656">(</span><span class="ident" id="2198657">hfsq</span><span class="op" id="2198661">+</span><span class="ident" id="2198662">R</span><span class="op" id="2198663">)</span><span class="op" id="2198664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2198667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2198670">return</span>&nbsp;<span class="builtintype" id="2198677">float64</span><span class="op" id="2198684">(</span><span class="ident" id="2198685">k</span><span class="op" id="2198686">)</span><span class="op" id="2198687">*</span><span class="ident" id="2198688">Ln2Hi</span>&nbsp;<span class="op" id="2198694">-</span>&nbsp;<span class="op" id="2198696">(</span><span class="op" id="2198697">(</span><span class="ident" id="2198698">hfsq</span>&nbsp;<span class="op" id="2198703">-</span>&nbsp;<span class="op" id="2198705">(</span><span class="ident" id="2198706">s</span><span class="op" id="2198707">*</span><span class="op" id="2198708">(</span><span class="ident" id="2198709">hfsq</span><span class="op" id="2198713">+</span><span class="ident" id="2198714">R</span><span class="op" id="2198715">)</span>&nbsp;<span class="op" id="2198717">+</span>&nbsp;<span class="op" id="2198719">(</span><span class="builtintype" id="2198720">float64</span><span class="op" id="2198727">(</span><span class="ident" id="2198728">k</span><span class="op" id="2198729">)</span><span class="op" id="2198730">*</span><span class="ident" id="2198731">Ln2Lo</span>&nbsp;<span class="op" id="2198737">+</span>&nbsp;<span class="ident" id="2198739">c</span><span class="op" id="2198740">)</span><span class="op" id="2198741">)</span><span class="op" id="2198742">)</span>&nbsp;<span class="op" id="2198744">-</span>&nbsp;<span class="ident" id="2198746">f</span><span class="op" id="2198747">)</span><br>
<span class="lineno">200</span><span class="op" id="2198749">}</span>
</div>
</body>
</html>
