<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3928584">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3928640">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3928694">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3928745">package</span>&nbsp;<span class="ident" id="3928753">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3928763">//&nbsp;This&nbsp;is&nbsp;a&nbsp;constant-time,&nbsp;32-bit&nbsp;implementation&nbsp;of&nbsp;P224.&nbsp;See&nbsp;FIPS&nbsp;186-3,</span><br>
<span class="lineno"></span><span class="comment" id="3928838">//&nbsp;section&nbsp;D.2.2.</span><br>
<span class="lineno"></span><span class="comment" id="3928856">//</span><br>
<span class="lineno">10</span><span class="comment" id="3928859">//&nbsp;See&nbsp;http://www.imperialviolet.org/2010/12/04/ecc.html&nbsp;([1])&nbsp;for&nbsp;background.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3928939">import</span>&nbsp;<span class="op" id="3928946">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3928949">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="3928960">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="3928963">var</span>&nbsp;<span class="ident" id="3928967">p224</span>&nbsp;<span class="ident" id="3928972">p224Curve</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3928983">type</span>&nbsp;<span class="ident" id="3928988">p224Curve</span>&nbsp;<span class="keyword" id="3928998">struct</span>&nbsp;<span class="op" id="3929005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3929008">*</span><span class="ident" id="3929009">CurveParams</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3929022">gx</span><span class="op" id="3929024">,</span>&nbsp;<span class="ident" id="3929026">gy</span><span class="op" id="3929028">,</span>&nbsp;<span class="ident" id="3929030">b</span>&nbsp;<span class="ident" id="3929032">p224FieldElement</span><br>
<span class="lineno"></span><span class="op" id="3929049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3929052">func</span>&nbsp;<span class="ident" id="3929057">initP224</span><span class="op" id="3929065">(</span><span class="op" id="3929066">)</span>&nbsp;<span class="op" id="3929068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3929071">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3929105">p224</span><span class="op" id="3929109">.</span><span class="ident" id="3929110">CurveParams</span>&nbsp;<span class="op" id="3929122">=</span>&nbsp;<span class="builtinfunc" id="3929124">new</span><span class="op" id="3929127">(</span><span class="ident" id="3929128">CurveParams</span><span class="op" id="3929139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3929142">p224</span><span class="op" id="3929146">.</span><span class="ident" id="3929147">P</span><span class="op" id="3929148">,</span>&nbsp;<span class="ident" id="3929150">_</span>&nbsp;<span class="op" id="3929152">=</span>&nbsp;<span class="builtinfunc" id="3929154">new</span><span class="op" id="3929157">(</span><span class="ident" id="3929158">big</span><span class="op" id="3929161">.</span><span class="ident" id="3929162">Int</span><span class="op" id="3929165">)</span><span class="op" id="3929166">.</span><span class="ident" id="3929167">SetString</span><span class="op" id="3929176">(</span><span class="string" id="3929177">&#34;26959946667150639794667015087019630673557916260026308143510066298881&#34;</span><span class="op" id="3929247">,</span>&nbsp;<span class="num" id="3929249">10</span><span class="op" id="3929251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3929254">p224</span><span class="op" id="3929258">.</span><span class="ident" id="3929259">N</span><span class="op" id="3929260">,</span>&nbsp;<span class="ident" id="3929262">_</span>&nbsp;<span class="op" id="3929264">=</span>&nbsp;<span class="builtinfunc" id="3929266">new</span><span class="op" id="3929269">(</span><span class="ident" id="3929270">big</span><span class="op" id="3929273">.</span><span class="ident" id="3929274">Int</span><span class="op" id="3929277">)</span><span class="op" id="3929278">.</span><span class="ident" id="3929279">SetString</span><span class="op" id="3929288">(</span><span class="string" id="3929289">&#34;26959946667150639794667015087019625940457807714424391721682722368061&#34;</span><span class="op" id="3929359">,</span>&nbsp;<span class="num" id="3929361">10</span><span class="op" id="3929363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3929366">p224</span><span class="op" id="3929370">.</span><span class="ident" id="3929371">B</span><span class="op" id="3929372">,</span>&nbsp;<span class="ident" id="3929374">_</span>&nbsp;<span class="op" id="3929376">=</span>&nbsp;<span class="builtinfunc" id="3929378">new</span><span class="op" id="3929381">(</span><span class="ident" id="3929382">big</span><span class="op" id="3929385">.</span><span class="ident" id="3929386">Int</span><span class="op" id="3929389">)</span><span class="op" id="3929390">.</span><span class="ident" id="3929391">SetString</span><span class="op" id="3929400">(</span><span class="string" id="3929401">&#34;b4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4&#34;</span><span class="op" id="3929459">,</span>&nbsp;<span class="num" id="3929461">16</span><span class="op" id="3929463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3929466">p224</span><span class="op" id="3929470">.</span><span class="ident" id="3929471">Gx</span><span class="op" id="3929473">,</span>&nbsp;<span class="ident" id="3929475">_</span>&nbsp;<span class="op" id="3929477">=</span>&nbsp;<span class="builtinfunc" id="3929479">new</span><span class="op" id="3929482">(</span><span class="ident" id="3929483">big</span><span class="op" id="3929486">.</span><span class="ident" id="3929487">Int</span><span class="op" id="3929490">)</span><span class="op" id="3929491">.</span><span class="ident" id="3929492">SetString</span><span class="op" id="3929501">(</span><span class="string" id="3929502">&#34;b70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21&#34;</span><span class="op" id="3929560">,</span>&nbsp;<span class="num" id="3929562">16</span><span class="op" id="3929564">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3929567">p224</span><span class="op" id="3929571">.</span><span class="ident" id="3929572">Gy</span><span class="op" id="3929574">,</span>&nbsp;<span class="ident" id="3929576">_</span>&nbsp;<span class="op" id="3929578">=</span>&nbsp;<span class="builtinfunc" id="3929580">new</span><span class="op" id="3929583">(</span><span class="ident" id="3929584">big</span><span class="op" id="3929587">.</span><span class="ident" id="3929588">Int</span><span class="op" id="3929591">)</span><span class="op" id="3929592">.</span><span class="ident" id="3929593">SetString</span><span class="op" id="3929602">(</span><span class="string" id="3929603">&#34;bd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34&#34;</span><span class="op" id="3929661">,</span>&nbsp;<span class="num" id="3929663">16</span><span class="op" id="3929665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3929668">p224</span><span class="op" id="3929672">.</span><span class="ident" id="3929673">BitSize</span>&nbsp;<span class="op" id="3929681">=</span>&nbsp;<span class="num" id="3929683">224</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3929689">p224FromBig</span><span class="op" id="3929700">(</span><span class="op" id="3929701">&amp;</span><span class="ident" id="3929702">p224</span><span class="op" id="3929706">.</span><span class="ident" id="3929707">gx</span><span class="op" id="3929709">,</span>&nbsp;<span class="ident" id="3929711">p224</span><span class="op" id="3929715">.</span><span class="ident" id="3929716">Gx</span><span class="op" id="3929718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3929721">p224FromBig</span><span class="op" id="3929732">(</span><span class="op" id="3929733">&amp;</span><span class="ident" id="3929734">p224</span><span class="op" id="3929738">.</span><span class="ident" id="3929739">gy</span><span class="op" id="3929741">,</span>&nbsp;<span class="ident" id="3929743">p224</span><span class="op" id="3929747">.</span><span class="ident" id="3929748">Gy</span><span class="op" id="3929750">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3929753">p224FromBig</span><span class="op" id="3929764">(</span><span class="op" id="3929765">&amp;</span><span class="ident" id="3929766">p224</span><span class="op" id="3929770">.</span><span class="ident" id="3929771">b</span><span class="op" id="3929772">,</span>&nbsp;<span class="ident" id="3929774">p224</span><span class="op" id="3929778">.</span><span class="ident" id="3929779">B</span><span class="op" id="3929780">)</span><br>
<span class="lineno"></span><span class="op" id="3929782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3929785">//&nbsp;P224&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-224&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2)</span><br>
<span class="lineno"></span><span class="keyword" id="3929864">func</span>&nbsp;<span class="ident" id="3929869">P224</span><span class="op" id="3929873">(</span><span class="op" id="3929874">)</span>&nbsp;<span class="ident" id="3929876">Curve</span>&nbsp;<span class="op" id="3929882">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3929885">initonce</span><span class="op" id="3929893">.</span><span class="ident" id="3929894">Do</span><span class="op" id="3929896">(</span><span class="ident" id="3929897">initAll</span><span class="op" id="3929904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3929907">return</span>&nbsp;<span class="ident" id="3929914">p224</span><br>
<span class="lineno"></span><span class="op" id="3929919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3929922">func</span>&nbsp;<span class="op" id="3929927">(</span><span class="ident" id="3929928">curve</span>&nbsp;<span class="ident" id="3929934">p224Curve</span><span class="op" id="3929943">)</span>&nbsp;<span class="ident" id="3929945">Params</span><span class="op" id="3929951">(</span><span class="op" id="3929952">)</span>&nbsp;<span class="op" id="3929954">*</span><span class="ident" id="3929955">CurveParams</span>&nbsp;<span class="op" id="3929967">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3929970">return</span>&nbsp;<span class="ident" id="3929977">curve</span><span class="op" id="3929982">.</span><span class="ident" id="3929983">CurveParams</span><br>
<span class="lineno"></span><span class="op" id="3929995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3929998">func</span>&nbsp;<span class="op" id="3930003">(</span><span class="ident" id="3930004">curve</span>&nbsp;<span class="ident" id="3930010">p224Curve</span><span class="op" id="3930019">)</span>&nbsp;<span class="ident" id="3930021">IsOnCurve</span><span class="op" id="3930030">(</span><span class="ident" id="3930031">bigX</span><span class="op" id="3930035">,</span>&nbsp;<span class="ident" id="3930037">bigY</span>&nbsp;<span class="op" id="3930042">*</span><span class="ident" id="3930043">big</span><span class="op" id="3930046">.</span><span class="ident" id="3930047">Int</span><span class="op" id="3930050">)</span>&nbsp;<span class="builtintype" id="3930052">bool</span>&nbsp;<span class="op" id="3930057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3930060">var</span>&nbsp;<span class="ident" id="3930064">x</span><span class="op" id="3930065">,</span>&nbsp;<span class="ident" id="3930067">y</span>&nbsp;<span class="ident" id="3930069">p224FieldElement</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930087">p224FromBig</span><span class="op" id="3930098">(</span><span class="op" id="3930099">&amp;</span><span class="ident" id="3930100">x</span><span class="op" id="3930101">,</span>&nbsp;<span class="ident" id="3930103">bigX</span><span class="op" id="3930107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930110">p224FromBig</span><span class="op" id="3930121">(</span><span class="op" id="3930122">&amp;</span><span class="ident" id="3930123">y</span><span class="op" id="3930124">,</span>&nbsp;<span class="ident" id="3930126">bigY</span><span class="op" id="3930130">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3930134">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3930157">var</span>&nbsp;<span class="ident" id="3930161">tmp</span>&nbsp;<span class="ident" id="3930165">p224LargeFieldElement</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3930188">var</span>&nbsp;<span class="ident" id="3930192">x3</span>&nbsp;<span class="ident" id="3930195">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930213">p224Square</span><span class="op" id="3930223">(</span><span class="op" id="3930224">&amp;</span><span class="ident" id="3930225">x3</span><span class="op" id="3930227">,</span>&nbsp;<span class="op" id="3930229">&amp;</span><span class="ident" id="3930230">x</span><span class="op" id="3930231">,</span>&nbsp;<span class="op" id="3930233">&amp;</span><span class="ident" id="3930234">tmp</span><span class="op" id="3930237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930240">p224Mul</span><span class="op" id="3930247">(</span><span class="op" id="3930248">&amp;</span><span class="ident" id="3930249">x3</span><span class="op" id="3930251">,</span>&nbsp;<span class="op" id="3930253">&amp;</span><span class="ident" id="3930254">x3</span><span class="op" id="3930256">,</span>&nbsp;<span class="op" id="3930258">&amp;</span><span class="ident" id="3930259">x</span><span class="op" id="3930260">,</span>&nbsp;<span class="op" id="3930262">&amp;</span><span class="ident" id="3930263">tmp</span><span class="op" id="3930266">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3930270">for</span>&nbsp;<span class="ident" id="3930274">i</span>&nbsp;<span class="op" id="3930276">:=</span>&nbsp;<span class="num" id="3930279">0</span><span class="op" id="3930280">;</span>&nbsp;<span class="ident" id="3930282">i</span>&nbsp;<span class="op" id="3930284">&lt;</span>&nbsp;<span class="num" id="3930286">8</span><span class="op" id="3930287">;</span>&nbsp;<span class="ident" id="3930289">i</span><span class="op" id="3930290">++</span>&nbsp;<span class="op" id="3930293">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930297">x</span><span class="op" id="3930298">[</span><span class="ident" id="3930299">i</span><span class="op" id="3930300">]</span>&nbsp;<span class="op" id="3930302">*=</span>&nbsp;<span class="num" id="3930305">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3930308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930311">p224Sub</span><span class="op" id="3930318">(</span><span class="op" id="3930319">&amp;</span><span class="ident" id="3930320">x3</span><span class="op" id="3930322">,</span>&nbsp;<span class="op" id="3930324">&amp;</span><span class="ident" id="3930325">x3</span><span class="op" id="3930327">,</span>&nbsp;<span class="op" id="3930329">&amp;</span><span class="ident" id="3930330">x</span><span class="op" id="3930331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930334">p224Reduce</span><span class="op" id="3930344">(</span><span class="op" id="3930345">&amp;</span><span class="ident" id="3930346">x3</span><span class="op" id="3930348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930351">p224Add</span><span class="op" id="3930358">(</span><span class="op" id="3930359">&amp;</span><span class="ident" id="3930360">x3</span><span class="op" id="3930362">,</span>&nbsp;<span class="op" id="3930364">&amp;</span><span class="ident" id="3930365">x3</span><span class="op" id="3930367">,</span>&nbsp;<span class="op" id="3930369">&amp;</span><span class="ident" id="3930370">curve</span><span class="op" id="3930375">.</span><span class="ident" id="3930376">b</span><span class="op" id="3930377">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930380">p224Contract</span><span class="op" id="3930392">(</span><span class="op" id="3930393">&amp;</span><span class="ident" id="3930394">x3</span><span class="op" id="3930396">,</span>&nbsp;<span class="op" id="3930398">&amp;</span><span class="ident" id="3930399">x3</span><span class="op" id="3930401">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930405">p224Square</span><span class="op" id="3930415">(</span><span class="op" id="3930416">&amp;</span><span class="ident" id="3930417">y</span><span class="op" id="3930418">,</span>&nbsp;<span class="op" id="3930420">&amp;</span><span class="ident" id="3930421">y</span><span class="op" id="3930422">,</span>&nbsp;<span class="op" id="3930424">&amp;</span><span class="ident" id="3930425">tmp</span><span class="op" id="3930428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930431">p224Contract</span><span class="op" id="3930443">(</span><span class="op" id="3930444">&amp;</span><span class="ident" id="3930445">y</span><span class="op" id="3930446">,</span>&nbsp;<span class="op" id="3930448">&amp;</span><span class="ident" id="3930449">y</span><span class="op" id="3930450">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3930454">for</span>&nbsp;<span class="ident" id="3930458">i</span>&nbsp;<span class="op" id="3930460">:=</span>&nbsp;<span class="num" id="3930463">0</span><span class="op" id="3930464">;</span>&nbsp;<span class="ident" id="3930466">i</span>&nbsp;<span class="op" id="3930468">&lt;</span>&nbsp;<span class="num" id="3930470">8</span><span class="op" id="3930471">;</span>&nbsp;<span class="ident" id="3930473">i</span><span class="op" id="3930474">++</span>&nbsp;<span class="op" id="3930477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3930481">if</span>&nbsp;<span class="ident" id="3930484">y</span><span class="op" id="3930485">[</span><span class="ident" id="3930486">i</span><span class="op" id="3930487">]</span>&nbsp;<span class="op" id="3930489">!=</span>&nbsp;<span class="ident" id="3930492">x3</span><span class="op" id="3930494">[</span><span class="ident" id="3930495">i</span><span class="op" id="3930496">]</span>&nbsp;<span class="op" id="3930498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3930503">return</span>&nbsp;<span class="builtintype" id="3930510">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3930518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3930521">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3930524">return</span>&nbsp;<span class="builtintype" id="3930531">true</span><br>
<span class="lineno"></span><span class="op" id="3930536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3930539">func</span>&nbsp;<span class="op" id="3930544">(</span><span class="ident" id="3930545">p224Curve</span><span class="op" id="3930554">)</span>&nbsp;<span class="ident" id="3930556">Add</span><span class="op" id="3930559">(</span><span class="ident" id="3930560">bigX1</span><span class="op" id="3930565">,</span>&nbsp;<span class="ident" id="3930567">bigY1</span><span class="op" id="3930572">,</span>&nbsp;<span class="ident" id="3930574">bigX2</span><span class="op" id="3930579">,</span>&nbsp;<span class="ident" id="3930581">bigY2</span>&nbsp;<span class="op" id="3930587">*</span><span class="ident" id="3930588">big</span><span class="op" id="3930591">.</span><span class="ident" id="3930592">Int</span><span class="op" id="3930595">)</span>&nbsp;<span class="op" id="3930597">(</span><span class="ident" id="3930598">x</span><span class="op" id="3930599">,</span>&nbsp;<span class="ident" id="3930601">y</span>&nbsp;<span class="op" id="3930603">*</span><span class="ident" id="3930604">big</span><span class="op" id="3930607">.</span><span class="ident" id="3930608">Int</span><span class="op" id="3930611">)</span>&nbsp;<span class="op" id="3930613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3930616">var</span>&nbsp;<span class="ident" id="3930620">x1</span><span class="op" id="3930622">,</span>&nbsp;<span class="ident" id="3930624">y1</span><span class="op" id="3930626">,</span>&nbsp;<span class="ident" id="3930628">z1</span><span class="op" id="3930630">,</span>&nbsp;<span class="ident" id="3930632">x2</span><span class="op" id="3930634">,</span>&nbsp;<span class="ident" id="3930636">y2</span><span class="op" id="3930638">,</span>&nbsp;<span class="ident" id="3930640">z2</span><span class="op" id="3930642">,</span>&nbsp;<span class="ident" id="3930644">x3</span><span class="op" id="3930646">,</span>&nbsp;<span class="ident" id="3930648">y3</span><span class="op" id="3930650">,</span>&nbsp;<span class="ident" id="3930652">z3</span>&nbsp;<span class="ident" id="3930655">p224FieldElement</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930674">p224FromBig</span><span class="op" id="3930685">(</span><span class="op" id="3930686">&amp;</span><span class="ident" id="3930687">x1</span><span class="op" id="3930689">,</span>&nbsp;<span class="ident" id="3930691">bigX1</span><span class="op" id="3930696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930699">p224FromBig</span><span class="op" id="3930710">(</span><span class="op" id="3930711">&amp;</span><span class="ident" id="3930712">y1</span><span class="op" id="3930714">,</span>&nbsp;<span class="ident" id="3930716">bigY1</span><span class="op" id="3930721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3930724">if</span>&nbsp;<span class="ident" id="3930727">bigX1</span><span class="op" id="3930732">.</span><span class="ident" id="3930733">Sign</span><span class="op" id="3930737">(</span><span class="op" id="3930738">)</span>&nbsp;<span class="op" id="3930740">!=</span>&nbsp;<span class="num" id="3930743">0</span>&nbsp;<span class="op" id="3930745">||</span>&nbsp;<span class="ident" id="3930748">bigY1</span><span class="op" id="3930753">.</span><span class="ident" id="3930754">Sign</span><span class="op" id="3930758">(</span><span class="op" id="3930759">)</span>&nbsp;<span class="op" id="3930761">!=</span>&nbsp;<span class="num" id="3930764">0</span>&nbsp;<span class="op" id="3930766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930770">z1</span><span class="op" id="3930772">[</span><span class="num" id="3930773">0</span><span class="op" id="3930774">]</span>&nbsp;<span class="op" id="3930776">=</span>&nbsp;<span class="num" id="3930778">1</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3930781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930784">p224FromBig</span><span class="op" id="3930795">(</span><span class="op" id="3930796">&amp;</span><span class="ident" id="3930797">x2</span><span class="op" id="3930799">,</span>&nbsp;<span class="ident" id="3930801">bigX2</span><span class="op" id="3930806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930809">p224FromBig</span><span class="op" id="3930820">(</span><span class="op" id="3930821">&amp;</span><span class="ident" id="3930822">y2</span><span class="op" id="3930824">,</span>&nbsp;<span class="ident" id="3930826">bigY2</span><span class="op" id="3930831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3930834">if</span>&nbsp;<span class="ident" id="3930837">bigX2</span><span class="op" id="3930842">.</span><span class="ident" id="3930843">Sign</span><span class="op" id="3930847">(</span><span class="op" id="3930848">)</span>&nbsp;<span class="op" id="3930850">!=</span>&nbsp;<span class="num" id="3930853">0</span>&nbsp;<span class="op" id="3930855">||</span>&nbsp;<span class="ident" id="3930858">bigY2</span><span class="op" id="3930863">.</span><span class="ident" id="3930864">Sign</span><span class="op" id="3930868">(</span><span class="op" id="3930869">)</span>&nbsp;<span class="op" id="3930871">!=</span>&nbsp;<span class="num" id="3930874">0</span>&nbsp;<span class="op" id="3930876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930880">z2</span><span class="op" id="3930882">[</span><span class="num" id="3930883">0</span><span class="op" id="3930884">]</span>&nbsp;<span class="op" id="3930886">=</span>&nbsp;<span class="num" id="3930888">1</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3930891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930895">p224AddJacobian</span><span class="op" id="3930910">(</span><span class="op" id="3930911">&amp;</span><span class="ident" id="3930912">x3</span><span class="op" id="3930914">,</span>&nbsp;<span class="op" id="3930916">&amp;</span><span class="ident" id="3930917">y3</span><span class="op" id="3930919">,</span>&nbsp;<span class="op" id="3930921">&amp;</span><span class="ident" id="3930922">z3</span><span class="op" id="3930924">,</span>&nbsp;<span class="op" id="3930926">&amp;</span><span class="ident" id="3930927">x1</span><span class="op" id="3930929">,</span>&nbsp;<span class="op" id="3930931">&amp;</span><span class="ident" id="3930932">y1</span><span class="op" id="3930934">,</span>&nbsp;<span class="op" id="3930936">&amp;</span><span class="ident" id="3930937">z1</span><span class="op" id="3930939">,</span>&nbsp;<span class="op" id="3930941">&amp;</span><span class="ident" id="3930942">x2</span><span class="op" id="3930944">,</span>&nbsp;<span class="op" id="3930946">&amp;</span><span class="ident" id="3930947">y2</span><span class="op" id="3930949">,</span>&nbsp;<span class="op" id="3930951">&amp;</span><span class="ident" id="3930952">z2</span><span class="op" id="3930954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3930957">return</span>&nbsp;<span class="ident" id="3930964">p224ToAffine</span><span class="op" id="3930976">(</span><span class="op" id="3930977">&amp;</span><span class="ident" id="3930978">x3</span><span class="op" id="3930980">,</span>&nbsp;<span class="op" id="3930982">&amp;</span><span class="ident" id="3930983">y3</span><span class="op" id="3930985">,</span>&nbsp;<span class="op" id="3930987">&amp;</span><span class="ident" id="3930988">z3</span><span class="op" id="3930990">)</span><br>
<span class="lineno"></span><span class="op" id="3930992">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="3930995">func</span>&nbsp;<span class="op" id="3931000">(</span><span class="ident" id="3931001">p224Curve</span><span class="op" id="3931010">)</span>&nbsp;<span class="ident" id="3931012">Double</span><span class="op" id="3931018">(</span><span class="ident" id="3931019">bigX1</span><span class="op" id="3931024">,</span>&nbsp;<span class="ident" id="3931026">bigY1</span>&nbsp;<span class="op" id="3931032">*</span><span class="ident" id="3931033">big</span><span class="op" id="3931036">.</span><span class="ident" id="3931037">Int</span><span class="op" id="3931040">)</span>&nbsp;<span class="op" id="3931042">(</span><span class="ident" id="3931043">x</span><span class="op" id="3931044">,</span>&nbsp;<span class="ident" id="3931046">y</span>&nbsp;<span class="op" id="3931048">*</span><span class="ident" id="3931049">big</span><span class="op" id="3931052">.</span><span class="ident" id="3931053">Int</span><span class="op" id="3931056">)</span>&nbsp;<span class="op" id="3931058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3931061">var</span>&nbsp;<span class="ident" id="3931065">x1</span><span class="op" id="3931067">,</span>&nbsp;<span class="ident" id="3931069">y1</span><span class="op" id="3931071">,</span>&nbsp;<span class="ident" id="3931073">z1</span><span class="op" id="3931075">,</span>&nbsp;<span class="ident" id="3931077">x2</span><span class="op" id="3931079">,</span>&nbsp;<span class="ident" id="3931081">y2</span><span class="op" id="3931083">,</span>&nbsp;<span class="ident" id="3931085">z2</span>&nbsp;<span class="ident" id="3931088">p224FieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931107">p224FromBig</span><span class="op" id="3931118">(</span><span class="op" id="3931119">&amp;</span><span class="ident" id="3931120">x1</span><span class="op" id="3931122">,</span>&nbsp;<span class="ident" id="3931124">bigX1</span><span class="op" id="3931129">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931132">p224FromBig</span><span class="op" id="3931143">(</span><span class="op" id="3931144">&amp;</span><span class="ident" id="3931145">y1</span><span class="op" id="3931147">,</span>&nbsp;<span class="ident" id="3931149">bigY1</span><span class="op" id="3931154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931157">z1</span><span class="op" id="3931159">[</span><span class="num" id="3931160">0</span><span class="op" id="3931161">]</span>&nbsp;<span class="op" id="3931163">=</span>&nbsp;<span class="num" id="3931165">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931169">p224DoubleJacobian</span><span class="op" id="3931187">(</span><span class="op" id="3931188">&amp;</span><span class="ident" id="3931189">x2</span><span class="op" id="3931191">,</span>&nbsp;<span class="op" id="3931193">&amp;</span><span class="ident" id="3931194">y2</span><span class="op" id="3931196">,</span>&nbsp;<span class="op" id="3931198">&amp;</span><span class="ident" id="3931199">z2</span><span class="op" id="3931201">,</span>&nbsp;<span class="op" id="3931203">&amp;</span><span class="ident" id="3931204">x1</span><span class="op" id="3931206">,</span>&nbsp;<span class="op" id="3931208">&amp;</span><span class="ident" id="3931209">y1</span><span class="op" id="3931211">,</span>&nbsp;<span class="op" id="3931213">&amp;</span><span class="ident" id="3931214">z1</span><span class="op" id="3931216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3931219">return</span>&nbsp;<span class="ident" id="3931226">p224ToAffine</span><span class="op" id="3931238">(</span><span class="op" id="3931239">&amp;</span><span class="ident" id="3931240">x2</span><span class="op" id="3931242">,</span>&nbsp;<span class="op" id="3931244">&amp;</span><span class="ident" id="3931245">y2</span><span class="op" id="3931247">,</span>&nbsp;<span class="op" id="3931249">&amp;</span><span class="ident" id="3931250">z2</span><span class="op" id="3931252">)</span><br>
<span class="lineno">105</span><span class="op" id="3931254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3931257">func</span>&nbsp;<span class="op" id="3931262">(</span><span class="ident" id="3931263">p224Curve</span><span class="op" id="3931272">)</span>&nbsp;<span class="ident" id="3931274">ScalarMult</span><span class="op" id="3931284">(</span><span class="ident" id="3931285">bigX1</span><span class="op" id="3931290">,</span>&nbsp;<span class="ident" id="3931292">bigY1</span>&nbsp;<span class="op" id="3931298">*</span><span class="ident" id="3931299">big</span><span class="op" id="3931302">.</span><span class="ident" id="3931303">Int</span><span class="op" id="3931306">,</span>&nbsp;<span class="ident" id="3931308">scalar</span>&nbsp;<span class="op" id="3931315">[</span><span class="op" id="3931316">]</span><span class="builtintype" id="3931317">byte</span><span class="op" id="3931321">)</span>&nbsp;<span class="op" id="3931323">(</span><span class="ident" id="3931324">x</span><span class="op" id="3931325">,</span>&nbsp;<span class="ident" id="3931327">y</span>&nbsp;<span class="op" id="3931329">*</span><span class="ident" id="3931330">big</span><span class="op" id="3931333">.</span><span class="ident" id="3931334">Int</span><span class="op" id="3931337">)</span>&nbsp;<span class="op" id="3931339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3931342">var</span>&nbsp;<span class="ident" id="3931346">x1</span><span class="op" id="3931348">,</span>&nbsp;<span class="ident" id="3931350">y1</span><span class="op" id="3931352">,</span>&nbsp;<span class="ident" id="3931354">z1</span><span class="op" id="3931356">,</span>&nbsp;<span class="ident" id="3931358">x2</span><span class="op" id="3931360">,</span>&nbsp;<span class="ident" id="3931362">y2</span><span class="op" id="3931364">,</span>&nbsp;<span class="ident" id="3931366">z2</span>&nbsp;<span class="ident" id="3931369">p224FieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931388">p224FromBig</span><span class="op" id="3931399">(</span><span class="op" id="3931400">&amp;</span><span class="ident" id="3931401">x1</span><span class="op" id="3931403">,</span>&nbsp;<span class="ident" id="3931405">bigX1</span><span class="op" id="3931410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931413">p224FromBig</span><span class="op" id="3931424">(</span><span class="op" id="3931425">&amp;</span><span class="ident" id="3931426">y1</span><span class="op" id="3931428">,</span>&nbsp;<span class="ident" id="3931430">bigY1</span><span class="op" id="3931435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931438">z1</span><span class="op" id="3931440">[</span><span class="num" id="3931441">0</span><span class="op" id="3931442">]</span>&nbsp;<span class="op" id="3931444">=</span>&nbsp;<span class="num" id="3931446">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931450">p224ScalarMult</span><span class="op" id="3931464">(</span><span class="op" id="3931465">&amp;</span><span class="ident" id="3931466">x2</span><span class="op" id="3931468">,</span>&nbsp;<span class="op" id="3931470">&amp;</span><span class="ident" id="3931471">y2</span><span class="op" id="3931473">,</span>&nbsp;<span class="op" id="3931475">&amp;</span><span class="ident" id="3931476">z2</span><span class="op" id="3931478">,</span>&nbsp;<span class="op" id="3931480">&amp;</span><span class="ident" id="3931481">x1</span><span class="op" id="3931483">,</span>&nbsp;<span class="op" id="3931485">&amp;</span><span class="ident" id="3931486">y1</span><span class="op" id="3931488">,</span>&nbsp;<span class="op" id="3931490">&amp;</span><span class="ident" id="3931491">z1</span><span class="op" id="3931493">,</span>&nbsp;<span class="ident" id="3931495">scalar</span><span class="op" id="3931501">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3931504">return</span>&nbsp;<span class="ident" id="3931511">p224ToAffine</span><span class="op" id="3931523">(</span><span class="op" id="3931524">&amp;</span><span class="ident" id="3931525">x2</span><span class="op" id="3931527">,</span>&nbsp;<span class="op" id="3931529">&amp;</span><span class="ident" id="3931530">y2</span><span class="op" id="3931532">,</span>&nbsp;<span class="op" id="3931534">&amp;</span><span class="ident" id="3931535">z2</span><span class="op" id="3931537">)</span><br>
<span class="lineno"></span><span class="op" id="3931539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3931542">func</span>&nbsp;<span class="op" id="3931547">(</span><span class="ident" id="3931548">curve</span>&nbsp;<span class="ident" id="3931554">p224Curve</span><span class="op" id="3931563">)</span>&nbsp;<span class="ident" id="3931565">ScalarBaseMult</span><span class="op" id="3931579">(</span><span class="ident" id="3931580">scalar</span>&nbsp;<span class="op" id="3931587">[</span><span class="op" id="3931588">]</span><span class="builtintype" id="3931589">byte</span><span class="op" id="3931593">)</span>&nbsp;<span class="op" id="3931595">(</span><span class="ident" id="3931596">x</span><span class="op" id="3931597">,</span>&nbsp;<span class="ident" id="3931599">y</span>&nbsp;<span class="op" id="3931601">*</span><span class="ident" id="3931602">big</span><span class="op" id="3931605">.</span><span class="ident" id="3931606">Int</span><span class="op" id="3931609">)</span>&nbsp;<span class="op" id="3931611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3931614">var</span>&nbsp;<span class="ident" id="3931618">z1</span><span class="op" id="3931620">,</span>&nbsp;<span class="ident" id="3931622">x2</span><span class="op" id="3931624">,</span>&nbsp;<span class="ident" id="3931626">y2</span><span class="op" id="3931628">,</span>&nbsp;<span class="ident" id="3931630">z2</span>&nbsp;<span class="ident" id="3931633">p224FieldElement</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931652">z1</span><span class="op" id="3931654">[</span><span class="num" id="3931655">0</span><span class="op" id="3931656">]</span>&nbsp;<span class="op" id="3931658">=</span>&nbsp;<span class="num" id="3931660">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931663">p224ScalarMult</span><span class="op" id="3931677">(</span><span class="op" id="3931678">&amp;</span><span class="ident" id="3931679">x2</span><span class="op" id="3931681">,</span>&nbsp;<span class="op" id="3931683">&amp;</span><span class="ident" id="3931684">y2</span><span class="op" id="3931686">,</span>&nbsp;<span class="op" id="3931688">&amp;</span><span class="ident" id="3931689">z2</span><span class="op" id="3931691">,</span>&nbsp;<span class="op" id="3931693">&amp;</span><span class="ident" id="3931694">curve</span><span class="op" id="3931699">.</span><span class="ident" id="3931700">gx</span><span class="op" id="3931702">,</span>&nbsp;<span class="op" id="3931704">&amp;</span><span class="ident" id="3931705">curve</span><span class="op" id="3931710">.</span><span class="ident" id="3931711">gy</span><span class="op" id="3931713">,</span>&nbsp;<span class="op" id="3931715">&amp;</span><span class="ident" id="3931716">z1</span><span class="op" id="3931718">,</span>&nbsp;<span class="ident" id="3931720">scalar</span><span class="op" id="3931726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3931729">return</span>&nbsp;<span class="ident" id="3931736">p224ToAffine</span><span class="op" id="3931748">(</span><span class="op" id="3931749">&amp;</span><span class="ident" id="3931750">x2</span><span class="op" id="3931752">,</span>&nbsp;<span class="op" id="3931754">&amp;</span><span class="ident" id="3931755">y2</span><span class="op" id="3931757">,</span>&nbsp;<span class="op" id="3931759">&amp;</span><span class="ident" id="3931760">z2</span><span class="op" id="3931762">)</span><br>
<span class="lineno"></span><span class="op" id="3931764">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="3931767">//&nbsp;Field&nbsp;element&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="3931795">//</span><br>
<span class="lineno"></span><span class="comment" id="3931798">//&nbsp;The&nbsp;field&nbsp;that&nbsp;we&#39;re&nbsp;dealing&nbsp;with&nbsp;is&nbsp;ℤ/pℤ&nbsp;where&nbsp;p&nbsp;=&nbsp;2**224&nbsp;-&nbsp;2**96&nbsp;+&nbsp;1.</span><br>
<span class="lineno"></span><span class="comment" id="3931877">//</span><br>
<span class="lineno">130</span><span class="comment" id="3931880">//&nbsp;Field&nbsp;elements&nbsp;are&nbsp;represented&nbsp;by&nbsp;a&nbsp;FieldElement,&nbsp;which&nbsp;is&nbsp;a&nbsp;typedef&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="3931958">//&nbsp;array&nbsp;of&nbsp;8&nbsp;uint32&#39;s.&nbsp;The&nbsp;value&nbsp;of&nbsp;a&nbsp;FieldElement,&nbsp;a,&nbsp;is:</span><br>
<span class="lineno"></span><span class="comment" id="3932018">//&nbsp;&nbsp;&nbsp;a[0]&nbsp;+&nbsp;2**28·a[1]&nbsp;+&nbsp;2**56·a[1]&nbsp;+&nbsp;...&nbsp;+&nbsp;2**196·a[7]</span><br>
<span class="lineno"></span><span class="comment" id="3932077">//</span><br>
<span class="lineno"></span><span class="comment" id="3932080">//&nbsp;Using&nbsp;28-bit&nbsp;limbs&nbsp;means&nbsp;that&nbsp;there&#39;s&nbsp;only&nbsp;4&nbsp;bits&nbsp;of&nbsp;headroom,&nbsp;which&nbsp;is&nbsp;less</span><br>
<span class="lineno">135</span><span class="comment" id="3932160">//&nbsp;than&nbsp;we&nbsp;would&nbsp;really&nbsp;like.&nbsp;But&nbsp;it&nbsp;has&nbsp;the&nbsp;useful&nbsp;feature&nbsp;that&nbsp;we&nbsp;hit&nbsp;2**224</span><br>
<span class="lineno"></span><span class="comment" id="3932239">//&nbsp;exactly,&nbsp;making&nbsp;the&nbsp;reflections&nbsp;during&nbsp;a&nbsp;reduce&nbsp;much&nbsp;nicer.</span><br>
<span class="lineno"></span><span class="keyword" id="3932302">type</span>&nbsp;<span class="ident" id="3932307">p224FieldElement</span>&nbsp;<span class="op" id="3932324">[</span><span class="num" id="3932325">8</span><span class="op" id="3932326">]</span><span class="builtintype" id="3932327">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3932335">//&nbsp;p224P&nbsp;is&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;field,&nbsp;represented&nbsp;as&nbsp;a&nbsp;p224FieldElement.</span><br>
<span class="lineno">140</span><span class="keyword" id="3932406">var</span>&nbsp;<span class="ident" id="3932410">p224P</span>&nbsp;<span class="op" id="3932416">=</span>&nbsp;<span class="op" id="3932418">[</span><span class="num" id="3932419">8</span><span class="op" id="3932420">]</span><span class="builtintype" id="3932421">uint32</span><span class="op" id="3932427">{</span><span class="num" id="3932428">1</span><span class="op" id="3932429">,</span>&nbsp;<span class="num" id="3932431">0</span><span class="op" id="3932432">,</span>&nbsp;<span class="num" id="3932434">0</span><span class="op" id="3932435">,</span>&nbsp;<span class="num" id="3932437">0xffff000</span><span class="op" id="3932446">,</span>&nbsp;<span class="num" id="3932448">0xfffffff</span><span class="op" id="3932457">,</span>&nbsp;<span class="num" id="3932459">0xfffffff</span><span class="op" id="3932468">,</span>&nbsp;<span class="num" id="3932470">0xfffffff</span><span class="op" id="3932479">,</span>&nbsp;<span class="num" id="3932481">0xfffffff</span><span class="op" id="3932490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3932493">//&nbsp;p224IsZero&nbsp;returns&nbsp;1&nbsp;if&nbsp;a&nbsp;==&nbsp;0&nbsp;mod&nbsp;p&nbsp;and&nbsp;0&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="3932550">//</span><br>
<span class="lineno"></span><span class="comment" id="3932553">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">145</span><span class="keyword" id="3932569">func</span>&nbsp;<span class="ident" id="3932574">p224IsZero</span><span class="op" id="3932584">(</span><span class="ident" id="3932585">a</span>&nbsp;<span class="op" id="3932587">*</span><span class="ident" id="3932588">p224FieldElement</span><span class="op" id="3932604">)</span>&nbsp;<span class="builtintype" id="3932606">uint32</span>&nbsp;<span class="op" id="3932613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3932616">//&nbsp;Since&nbsp;a&nbsp;p224FieldElement&nbsp;contains&nbsp;224&nbsp;bits&nbsp;there&nbsp;are&nbsp;two&nbsp;possible</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3932686">//&nbsp;representations&nbsp;of&nbsp;0:&nbsp;0&nbsp;and&nbsp;p.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3932721">var</span>&nbsp;<span class="ident" id="3932725">minimal</span>&nbsp;<span class="ident" id="3932733">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3932751">p224Contract</span><span class="op" id="3932763">(</span><span class="op" id="3932764">&amp;</span><span class="ident" id="3932765">minimal</span><span class="op" id="3932772">,</span>&nbsp;<span class="ident" id="3932774">a</span><span class="op" id="3932775">)</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3932779">var</span>&nbsp;<span class="ident" id="3932783">isZero</span><span class="op" id="3932789">,</span>&nbsp;<span class="ident" id="3932791">isP</span>&nbsp;<span class="builtintype" id="3932795">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3932803">for</span>&nbsp;<span class="ident" id="3932807">i</span><span class="op" id="3932808">,</span>&nbsp;<span class="ident" id="3932810">v</span>&nbsp;<span class="op" id="3932812">:=</span>&nbsp;<span class="keyword" id="3932815">range</span>&nbsp;<span class="ident" id="3932821">minimal</span>&nbsp;<span class="op" id="3932829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3932833">isZero</span>&nbsp;<span class="op" id="3932840">|=</span>&nbsp;<span class="ident" id="3932843">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3932847">isP</span>&nbsp;<span class="op" id="3932851">|=</span>&nbsp;<span class="ident" id="3932854">v</span>&nbsp;<span class="op" id="3932856">-</span>&nbsp;<span class="ident" id="3932858">p224P</span><span class="op" id="3932863">[</span><span class="ident" id="3932864">i</span><span class="op" id="3932865">]</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3932868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3932872">//&nbsp;If&nbsp;either&nbsp;isZero&nbsp;or&nbsp;isP&nbsp;is&nbsp;0,&nbsp;then&nbsp;we&nbsp;should&nbsp;return&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3932931">isZero</span>&nbsp;<span class="op" id="3932938">|=</span>&nbsp;<span class="ident" id="3932941">isZero</span>&nbsp;<span class="op" id="3932948">&gt;&gt;</span>&nbsp;<span class="num" id="3932951">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3932955">isZero</span>&nbsp;<span class="op" id="3932962">|=</span>&nbsp;<span class="ident" id="3932965">isZero</span>&nbsp;<span class="op" id="3932972">&gt;&gt;</span>&nbsp;<span class="num" id="3932975">8</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3932978">isZero</span>&nbsp;<span class="op" id="3932985">|=</span>&nbsp;<span class="ident" id="3932988">isZero</span>&nbsp;<span class="op" id="3932995">&gt;&gt;</span>&nbsp;<span class="num" id="3932998">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3933001">isZero</span>&nbsp;<span class="op" id="3933008">|=</span>&nbsp;<span class="ident" id="3933011">isZero</span>&nbsp;<span class="op" id="3933018">&gt;&gt;</span>&nbsp;<span class="num" id="3933021">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3933024">isZero</span>&nbsp;<span class="op" id="3933031">|=</span>&nbsp;<span class="ident" id="3933034">isZero</span>&nbsp;<span class="op" id="3933041">&gt;&gt;</span>&nbsp;<span class="num" id="3933044">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3933048">isP</span>&nbsp;<span class="op" id="3933052">|=</span>&nbsp;<span class="ident" id="3933055">isP</span>&nbsp;<span class="op" id="3933059">&gt;&gt;</span>&nbsp;<span class="num" id="3933062">16</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3933066">isP</span>&nbsp;<span class="op" id="3933070">|=</span>&nbsp;<span class="ident" id="3933073">isP</span>&nbsp;<span class="op" id="3933077">&gt;&gt;</span>&nbsp;<span class="num" id="3933080">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3933083">isP</span>&nbsp;<span class="op" id="3933087">|=</span>&nbsp;<span class="ident" id="3933090">isP</span>&nbsp;<span class="op" id="3933094">&gt;&gt;</span>&nbsp;<span class="num" id="3933097">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3933100">isP</span>&nbsp;<span class="op" id="3933104">|=</span>&nbsp;<span class="ident" id="3933107">isP</span>&nbsp;<span class="op" id="3933111">&gt;&gt;</span>&nbsp;<span class="num" id="3933114">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3933117">isP</span>&nbsp;<span class="op" id="3933121">|=</span>&nbsp;<span class="ident" id="3933124">isP</span>&nbsp;<span class="op" id="3933128">&gt;&gt;</span>&nbsp;<span class="num" id="3933131">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3933135">//&nbsp;For&nbsp;isZero&nbsp;and&nbsp;isP,&nbsp;the&nbsp;LSB&nbsp;is&nbsp;0&nbsp;iff&nbsp;all&nbsp;the&nbsp;bits&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3933199">result</span>&nbsp;<span class="op" id="3933206">:=</span>&nbsp;<span class="ident" id="3933209">isZero</span>&nbsp;<span class="op" id="3933216">&amp;</span>&nbsp;<span class="ident" id="3933218">isP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3933223">result</span>&nbsp;<span class="op" id="3933230">=</span>&nbsp;<span class="op" id="3933232">(</span><span class="op" id="3933233">^</span><span class="ident" id="3933234">result</span><span class="op" id="3933240">)</span>&nbsp;<span class="op" id="3933242">&amp;</span>&nbsp;<span class="num" id="3933244">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3933248">return</span>&nbsp;<span class="ident" id="3933255">result</span><br>
<span class="lineno">175</span><span class="op" id="3933262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3933265">//&nbsp;p224Add&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+b</span><br>
<span class="lineno"></span><span class="comment" id="3933296">//</span><br>
<span class="lineno"></span><span class="comment" id="3933299">//&nbsp;a[i]&nbsp;+&nbsp;b[i]&nbsp;&lt;&nbsp;2**32</span><br>
<span class="lineno">180</span><span class="keyword" id="3933322">func</span>&nbsp;<span class="ident" id="3933327">p224Add</span><span class="op" id="3933334">(</span><span class="ident" id="3933335">out</span><span class="op" id="3933338">,</span>&nbsp;<span class="ident" id="3933340">a</span><span class="op" id="3933341">,</span>&nbsp;<span class="ident" id="3933343">b</span>&nbsp;<span class="op" id="3933345">*</span><span class="ident" id="3933346">p224FieldElement</span><span class="op" id="3933362">)</span>&nbsp;<span class="op" id="3933364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3933367">for</span>&nbsp;<span class="ident" id="3933371">i</span>&nbsp;<span class="op" id="3933373">:=</span>&nbsp;<span class="num" id="3933376">0</span><span class="op" id="3933377">;</span>&nbsp;<span class="ident" id="3933379">i</span>&nbsp;<span class="op" id="3933381">&lt;</span>&nbsp;<span class="num" id="3933383">8</span><span class="op" id="3933384">;</span>&nbsp;<span class="ident" id="3933386">i</span><span class="op" id="3933387">++</span>&nbsp;<span class="op" id="3933390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3933394">out</span><span class="op" id="3933397">[</span><span class="ident" id="3933398">i</span><span class="op" id="3933399">]</span>&nbsp;<span class="op" id="3933401">=</span>&nbsp;<span class="ident" id="3933403">a</span><span class="op" id="3933404">[</span><span class="ident" id="3933405">i</span><span class="op" id="3933406">]</span>&nbsp;<span class="op" id="3933408">+</span>&nbsp;<span class="ident" id="3933410">b</span><span class="op" id="3933411">[</span><span class="ident" id="3933412">i</span><span class="op" id="3933413">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3933416">}</span><br>
<span class="lineno"></span><span class="op" id="3933418">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="3933421">const</span>&nbsp;<span class="ident" id="3933427">two31p3</span>&nbsp;<span class="op" id="3933435">=</span>&nbsp;<span class="num" id="3933437">1</span><span class="op" id="3933438">&lt;&lt;</span><span class="num" id="3933440">31</span>&nbsp;<span class="op" id="3933443">+</span>&nbsp;<span class="num" id="3933445">1</span><span class="op" id="3933446">&lt;&lt;</span><span class="num" id="3933448">3</span><br>
<span class="lineno"></span><span class="keyword" id="3933450">const</span>&nbsp;<span class="ident" id="3933456">two31m3</span>&nbsp;<span class="op" id="3933464">=</span>&nbsp;<span class="num" id="3933466">1</span><span class="op" id="3933467">&lt;&lt;</span><span class="num" id="3933469">31</span>&nbsp;<span class="op" id="3933472">-</span>&nbsp;<span class="num" id="3933474">1</span><span class="op" id="3933475">&lt;&lt;</span><span class="num" id="3933477">3</span><br>
<span class="lineno"></span><span class="keyword" id="3933479">const</span>&nbsp;<span class="ident" id="3933485">two31m15m3</span>&nbsp;<span class="op" id="3933496">=</span>&nbsp;<span class="num" id="3933498">1</span><span class="op" id="3933499">&lt;&lt;</span><span class="num" id="3933501">31</span>&nbsp;<span class="op" id="3933504">-</span>&nbsp;<span class="num" id="3933506">1</span><span class="op" id="3933507">&lt;&lt;</span><span class="num" id="3933509">15</span>&nbsp;<span class="op" id="3933512">-</span>&nbsp;<span class="num" id="3933514">1</span><span class="op" id="3933515">&lt;&lt;</span><span class="num" id="3933517">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="3933520">//&nbsp;p224ZeroModP31&nbsp;is&nbsp;0&nbsp;mod&nbsp;p&nbsp;where&nbsp;bit&nbsp;31&nbsp;is&nbsp;set&nbsp;in&nbsp;all&nbsp;limbs&nbsp;so&nbsp;that&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span><span class="comment" id="3933597">//&nbsp;subtract&nbsp;smaller&nbsp;amounts&nbsp;without&nbsp;underflow.&nbsp;See&nbsp;the&nbsp;section&nbsp;&#34;Subtraction&#34;&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3933677">//&nbsp;[1]&nbsp;for&nbsp;reasoning.</span><br>
<span class="lineno"></span><span class="keyword" id="3933699">var</span>&nbsp;<span class="ident" id="3933703">p224ZeroModP31</span>&nbsp;<span class="op" id="3933718">=</span>&nbsp;<span class="op" id="3933720">[</span><span class="op" id="3933721">]</span><span class="builtintype" id="3933722">uint32</span><span class="op" id="3933728">{</span><span class="ident" id="3933729">two31p3</span><span class="op" id="3933736">,</span>&nbsp;<span class="ident" id="3933738">two31m3</span><span class="op" id="3933745">,</span>&nbsp;<span class="ident" id="3933747">two31m3</span><span class="op" id="3933754">,</span>&nbsp;<span class="ident" id="3933756">two31m15m3</span><span class="op" id="3933766">,</span>&nbsp;<span class="ident" id="3933768">two31m3</span><span class="op" id="3933775">,</span>&nbsp;<span class="ident" id="3933777">two31m3</span><span class="op" id="3933784">,</span>&nbsp;<span class="ident" id="3933786">two31m3</span><span class="op" id="3933793">,</span>&nbsp;<span class="ident" id="3933795">two31m3</span><span class="op" id="3933802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="3933805">//&nbsp;p224Sub&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a-b</span><br>
<span class="lineno"></span><span class="comment" id="3933836">//</span><br>
<span class="lineno"></span><span class="comment" id="3933839">//&nbsp;a[i],&nbsp;b[i]&nbsp;&lt;&nbsp;2**30</span><br>
<span class="lineno"></span><span class="comment" id="3933861">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**32</span><br>
<span class="lineno"></span><span class="keyword" id="3933879">func</span>&nbsp;<span class="ident" id="3933884">p224Sub</span><span class="op" id="3933891">(</span><span class="ident" id="3933892">out</span><span class="op" id="3933895">,</span>&nbsp;<span class="ident" id="3933897">a</span><span class="op" id="3933898">,</span>&nbsp;<span class="ident" id="3933900">b</span>&nbsp;<span class="op" id="3933902">*</span><span class="ident" id="3933903">p224FieldElement</span><span class="op" id="3933919">)</span>&nbsp;<span class="op" id="3933921">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3933924">for</span>&nbsp;<span class="ident" id="3933928">i</span>&nbsp;<span class="op" id="3933930">:=</span>&nbsp;<span class="num" id="3933933">0</span><span class="op" id="3933934">;</span>&nbsp;<span class="ident" id="3933936">i</span>&nbsp;<span class="op" id="3933938">&lt;</span>&nbsp;<span class="num" id="3933940">8</span><span class="op" id="3933941">;</span>&nbsp;<span class="ident" id="3933943">i</span><span class="op" id="3933944">++</span>&nbsp;<span class="op" id="3933947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3933951">out</span><span class="op" id="3933954">[</span><span class="ident" id="3933955">i</span><span class="op" id="3933956">]</span>&nbsp;<span class="op" id="3933958">=</span>&nbsp;<span class="ident" id="3933960">a</span><span class="op" id="3933961">[</span><span class="ident" id="3933962">i</span><span class="op" id="3933963">]</span>&nbsp;<span class="op" id="3933965">+</span>&nbsp;<span class="ident" id="3933967">p224ZeroModP31</span><span class="op" id="3933981">[</span><span class="ident" id="3933982">i</span><span class="op" id="3933983">]</span>&nbsp;<span class="op" id="3933985">-</span>&nbsp;<span class="ident" id="3933987">b</span><span class="op" id="3933988">[</span><span class="ident" id="3933989">i</span><span class="op" id="3933990">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3933993">}</span><br>
<span class="lineno"></span><span class="op" id="3933995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="3933998">//&nbsp;LargeFieldElement&nbsp;also&nbsp;represents&nbsp;an&nbsp;element&nbsp;of&nbsp;the&nbsp;field.&nbsp;The&nbsp;limbs&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="3934074">//&nbsp;still&nbsp;spaced&nbsp;28-bits&nbsp;apart&nbsp;and&nbsp;in&nbsp;little-endian&nbsp;order.&nbsp;So&nbsp;the&nbsp;limbs&nbsp;are&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="3934152">//&nbsp;0,&nbsp;28,&nbsp;56,&nbsp;...,&nbsp;392&nbsp;bits,&nbsp;each&nbsp;64-bits&nbsp;wide.</span><br>
<span class="lineno"></span><span class="keyword" id="3934200">type</span>&nbsp;<span class="ident" id="3934205">p224LargeFieldElement</span>&nbsp;<span class="op" id="3934227">[</span><span class="num" id="3934228">15</span><span class="op" id="3934230">]</span><span class="ident" id="3934231">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="keyword" id="3934239">const</span>&nbsp;<span class="ident" id="3934245">two63p35</span>&nbsp;<span class="op" id="3934254">=</span>&nbsp;<span class="num" id="3934256">1</span><span class="op" id="3934257">&lt;&lt;</span><span class="num" id="3934259">63</span>&nbsp;<span class="op" id="3934262">+</span>&nbsp;<span class="num" id="3934264">1</span><span class="op" id="3934265">&lt;&lt;</span><span class="num" id="3934267">35</span><br>
<span class="lineno"></span><span class="keyword" id="3934270">const</span>&nbsp;<span class="ident" id="3934276">two63m35</span>&nbsp;<span class="op" id="3934285">=</span>&nbsp;<span class="num" id="3934287">1</span><span class="op" id="3934288">&lt;&lt;</span><span class="num" id="3934290">63</span>&nbsp;<span class="op" id="3934293">-</span>&nbsp;<span class="num" id="3934295">1</span><span class="op" id="3934296">&lt;&lt;</span><span class="num" id="3934298">35</span><br>
<span class="lineno"></span><span class="keyword" id="3934301">const</span>&nbsp;<span class="ident" id="3934307">two63m35m19</span>&nbsp;<span class="op" id="3934319">=</span>&nbsp;<span class="num" id="3934321">1</span><span class="op" id="3934322">&lt;&lt;</span><span class="num" id="3934324">63</span>&nbsp;<span class="op" id="3934327">-</span>&nbsp;<span class="num" id="3934329">1</span><span class="op" id="3934330">&lt;&lt;</span><span class="num" id="3934332">35</span>&nbsp;<span class="op" id="3934335">-</span>&nbsp;<span class="num" id="3934337">1</span><span class="op" id="3934338">&lt;&lt;</span><span class="num" id="3934340">19</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3934344">//&nbsp;p224ZeroModP63&nbsp;is&nbsp;0&nbsp;mod&nbsp;p&nbsp;where&nbsp;bit&nbsp;63&nbsp;is&nbsp;set&nbsp;in&nbsp;all&nbsp;limbs.&nbsp;See&nbsp;the&nbsp;section</span><br>
<span class="lineno">215</span><span class="comment" id="3934423">//&nbsp;&#34;Subtraction&#34;&nbsp;in&nbsp;[1]&nbsp;for&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="3934456">var</span>&nbsp;<span class="ident" id="3934460">p224ZeroModP63</span>&nbsp;<span class="op" id="3934475">=</span>&nbsp;<span class="op" id="3934477">[</span><span class="num" id="3934478">8</span><span class="op" id="3934479">]</span><span class="ident" id="3934480">uint64</span><span class="op" id="3934486">{</span><span class="ident" id="3934487">two63p35</span><span class="op" id="3934495">,</span>&nbsp;<span class="ident" id="3934497">two63m35</span><span class="op" id="3934505">,</span>&nbsp;<span class="ident" id="3934507">two63m35</span><span class="op" id="3934515">,</span>&nbsp;<span class="ident" id="3934517">two63m35</span><span class="op" id="3934525">,</span>&nbsp;<span class="ident" id="3934527">two63m35m19</span><span class="op" id="3934538">,</span>&nbsp;<span class="ident" id="3934540">two63m35</span><span class="op" id="3934548">,</span>&nbsp;<span class="ident" id="3934550">two63m35</span><span class="op" id="3934558">,</span>&nbsp;<span class="ident" id="3934560">two63m35</span><span class="op" id="3934568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3934571">const</span>&nbsp;<span class="ident" id="3934577">bottom12Bits</span>&nbsp;<span class="op" id="3934590">=</span>&nbsp;<span class="num" id="3934592">0xfff</span><br>
<span class="lineno"></span><span class="keyword" id="3934598">const</span>&nbsp;<span class="ident" id="3934604">bottom28Bits</span>&nbsp;<span class="op" id="3934617">=</span>&nbsp;<span class="num" id="3934619">0xfffffff</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="3934630">//&nbsp;p224Mul&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a*b</span><br>
<span class="lineno"></span><span class="comment" id="3934661">//</span><br>
<span class="lineno"></span><span class="comment" id="3934664">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29,&nbsp;b[i]&nbsp;&lt;&nbsp;2**30&nbsp;(or&nbsp;vice&nbsp;versa)</span><br>
<span class="lineno"></span><span class="comment" id="3934710">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">225</span><span class="keyword" id="3934728">func</span>&nbsp;<span class="ident" id="3934733">p224Mul</span><span class="op" id="3934740">(</span><span class="ident" id="3934741">out</span><span class="op" id="3934744">,</span>&nbsp;<span class="ident" id="3934746">a</span><span class="op" id="3934747">,</span>&nbsp;<span class="ident" id="3934749">b</span>&nbsp;<span class="op" id="3934751">*</span><span class="ident" id="3934752">p224FieldElement</span><span class="op" id="3934768">,</span>&nbsp;<span class="ident" id="3934770">tmp</span>&nbsp;<span class="op" id="3934774">*</span><span class="ident" id="3934775">p224LargeFieldElement</span><span class="op" id="3934796">)</span>&nbsp;<span class="op" id="3934798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3934801">for</span>&nbsp;<span class="ident" id="3934805">i</span>&nbsp;<span class="op" id="3934807">:=</span>&nbsp;<span class="num" id="3934810">0</span><span class="op" id="3934811">;</span>&nbsp;<span class="ident" id="3934813">i</span>&nbsp;<span class="op" id="3934815">&lt;</span>&nbsp;<span class="num" id="3934817">15</span><span class="op" id="3934819">;</span>&nbsp;<span class="ident" id="3934821">i</span><span class="op" id="3934822">++</span>&nbsp;<span class="op" id="3934825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3934829">tmp</span><span class="op" id="3934832">[</span><span class="ident" id="3934833">i</span><span class="op" id="3934834">]</span>&nbsp;<span class="op" id="3934836">=</span>&nbsp;<span class="num" id="3934838">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3934841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3934845">for</span>&nbsp;<span class="ident" id="3934849">i</span>&nbsp;<span class="op" id="3934851">:=</span>&nbsp;<span class="num" id="3934854">0</span><span class="op" id="3934855">;</span>&nbsp;<span class="ident" id="3934857">i</span>&nbsp;<span class="op" id="3934859">&lt;</span>&nbsp;<span class="num" id="3934861">8</span><span class="op" id="3934862">;</span>&nbsp;<span class="ident" id="3934864">i</span><span class="op" id="3934865">++</span>&nbsp;<span class="op" id="3934868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3934872">for</span>&nbsp;<span class="ident" id="3934876">j</span>&nbsp;<span class="op" id="3934878">:=</span>&nbsp;<span class="num" id="3934881">0</span><span class="op" id="3934882">;</span>&nbsp;<span class="ident" id="3934884">j</span>&nbsp;<span class="op" id="3934886">&lt;</span>&nbsp;<span class="num" id="3934888">8</span><span class="op" id="3934889">;</span>&nbsp;<span class="ident" id="3934891">j</span><span class="op" id="3934892">++</span>&nbsp;<span class="op" id="3934895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3934900">tmp</span><span class="op" id="3934903">[</span><span class="ident" id="3934904">i</span><span class="op" id="3934905">+</span><span class="ident" id="3934906">j</span><span class="op" id="3934907">]</span>&nbsp;<span class="op" id="3934909">+=</span>&nbsp;<span class="ident" id="3934912">uint64</span><span class="op" id="3934918">(</span><span class="ident" id="3934919">a</span><span class="op" id="3934920">[</span><span class="ident" id="3934921">i</span><span class="op" id="3934922">]</span><span class="op" id="3934923">)</span>&nbsp;<span class="op" id="3934925">*</span>&nbsp;<span class="ident" id="3934927">uint64</span><span class="op" id="3934933">(</span><span class="ident" id="3934934">b</span><span class="op" id="3934935">[</span><span class="ident" id="3934936">j</span><span class="op" id="3934937">]</span><span class="op" id="3934938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3934942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3934945">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3934949">p224ReduceLarge</span><span class="op" id="3934964">(</span><span class="ident" id="3934965">out</span><span class="op" id="3934968">,</span>&nbsp;<span class="ident" id="3934970">tmp</span><span class="op" id="3934973">)</span><br>
<span class="lineno"></span><span class="op" id="3934975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3934978">//&nbsp;Square&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a*a</span><br>
<span class="lineno">240</span><span class="comment" id="3935008">//</span><br>
<span class="lineno"></span><span class="comment" id="3935011">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="comment" id="3935027">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="keyword" id="3935045">func</span>&nbsp;<span class="ident" id="3935050">p224Square</span><span class="op" id="3935060">(</span><span class="ident" id="3935061">out</span><span class="op" id="3935064">,</span>&nbsp;<span class="ident" id="3935066">a</span>&nbsp;<span class="op" id="3935068">*</span><span class="ident" id="3935069">p224FieldElement</span><span class="op" id="3935085">,</span>&nbsp;<span class="ident" id="3935087">tmp</span>&nbsp;<span class="op" id="3935091">*</span><span class="ident" id="3935092">p224LargeFieldElement</span><span class="op" id="3935113">)</span>&nbsp;<span class="op" id="3935115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3935118">for</span>&nbsp;<span class="ident" id="3935122">i</span>&nbsp;<span class="op" id="3935124">:=</span>&nbsp;<span class="num" id="3935127">0</span><span class="op" id="3935128">;</span>&nbsp;<span class="ident" id="3935130">i</span>&nbsp;<span class="op" id="3935132">&lt;</span>&nbsp;<span class="num" id="3935134">15</span><span class="op" id="3935136">;</span>&nbsp;<span class="ident" id="3935138">i</span><span class="op" id="3935139">++</span>&nbsp;<span class="op" id="3935142">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3935146">tmp</span><span class="op" id="3935149">[</span><span class="ident" id="3935150">i</span><span class="op" id="3935151">]</span>&nbsp;<span class="op" id="3935153">=</span>&nbsp;<span class="num" id="3935155">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3935158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3935162">for</span>&nbsp;<span class="ident" id="3935166">i</span>&nbsp;<span class="op" id="3935168">:=</span>&nbsp;<span class="num" id="3935171">0</span><span class="op" id="3935172">;</span>&nbsp;<span class="ident" id="3935174">i</span>&nbsp;<span class="op" id="3935176">&lt;</span>&nbsp;<span class="num" id="3935178">8</span><span class="op" id="3935179">;</span>&nbsp;<span class="ident" id="3935181">i</span><span class="op" id="3935182">++</span>&nbsp;<span class="op" id="3935185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3935189">for</span>&nbsp;<span class="ident" id="3935193">j</span>&nbsp;<span class="op" id="3935195">:=</span>&nbsp;<span class="num" id="3935198">0</span><span class="op" id="3935199">;</span>&nbsp;<span class="ident" id="3935201">j</span>&nbsp;<span class="op" id="3935203">&lt;=</span>&nbsp;<span class="ident" id="3935206">i</span><span class="op" id="3935207">;</span>&nbsp;<span class="ident" id="3935209">j</span><span class="op" id="3935210">++</span>&nbsp;<span class="op" id="3935213">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3935218">r</span>&nbsp;<span class="op" id="3935220">:=</span>&nbsp;<span class="ident" id="3935223">uint64</span><span class="op" id="3935229">(</span><span class="ident" id="3935230">a</span><span class="op" id="3935231">[</span><span class="ident" id="3935232">i</span><span class="op" id="3935233">]</span><span class="op" id="3935234">)</span>&nbsp;<span class="op" id="3935236">*</span>&nbsp;<span class="ident" id="3935238">uint64</span><span class="op" id="3935244">(</span><span class="ident" id="3935245">a</span><span class="op" id="3935246">[</span><span class="ident" id="3935247">j</span><span class="op" id="3935248">]</span><span class="op" id="3935249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3935254">if</span>&nbsp;<span class="ident" id="3935257">i</span>&nbsp;<span class="op" id="3935259">==</span>&nbsp;<span class="ident" id="3935262">j</span>&nbsp;<span class="op" id="3935264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3935270">tmp</span><span class="op" id="3935273">[</span><span class="ident" id="3935274">i</span><span class="op" id="3935275">+</span><span class="ident" id="3935276">j</span><span class="op" id="3935277">]</span>&nbsp;<span class="op" id="3935279">+=</span>&nbsp;<span class="ident" id="3935282">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3935287">}</span>&nbsp;<span class="keyword" id="3935289">else</span>&nbsp;<span class="op" id="3935294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3935300">tmp</span><span class="op" id="3935303">[</span><span class="ident" id="3935304">i</span><span class="op" id="3935305">+</span><span class="ident" id="3935306">j</span><span class="op" id="3935307">]</span>&nbsp;<span class="op" id="3935309">+=</span>&nbsp;<span class="ident" id="3935312">r</span>&nbsp;<span class="op" id="3935314">&lt;&lt;</span>&nbsp;<span class="num" id="3935317">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3935322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3935326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3935329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3935333">p224ReduceLarge</span><span class="op" id="3935348">(</span><span class="ident" id="3935349">out</span><span class="op" id="3935352">,</span>&nbsp;<span class="ident" id="3935354">tmp</span><span class="op" id="3935357">)</span><br>
<span class="lineno">260</span><span class="op" id="3935359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3935362">//&nbsp;ReduceLarge&nbsp;converts&nbsp;a&nbsp;p224LargeFieldElement&nbsp;to&nbsp;a&nbsp;p224FieldElement.</span><br>
<span class="lineno"></span><span class="comment" id="3935433">//</span><br>
<span class="lineno"></span><span class="comment" id="3935436">//&nbsp;in[i]&nbsp;&lt;&nbsp;2**62</span><br>
<span class="lineno">265</span><span class="keyword" id="3935453">func</span>&nbsp;<span class="ident" id="3935458">p224ReduceLarge</span><span class="op" id="3935473">(</span><span class="ident" id="3935474">out</span>&nbsp;<span class="op" id="3935478">*</span><span class="ident" id="3935479">p224FieldElement</span><span class="op" id="3935495">,</span>&nbsp;<span class="ident" id="3935497">in</span>&nbsp;<span class="op" id="3935500">*</span><span class="ident" id="3935501">p224LargeFieldElement</span><span class="op" id="3935522">)</span>&nbsp;<span class="op" id="3935524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3935527">for</span>&nbsp;<span class="ident" id="3935531">i</span>&nbsp;<span class="op" id="3935533">:=</span>&nbsp;<span class="num" id="3935536">0</span><span class="op" id="3935537">;</span>&nbsp;<span class="ident" id="3935539">i</span>&nbsp;<span class="op" id="3935541">&lt;</span>&nbsp;<span class="num" id="3935543">8</span><span class="op" id="3935544">;</span>&nbsp;<span class="ident" id="3935546">i</span><span class="op" id="3935547">++</span>&nbsp;<span class="op" id="3935550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3935554">in</span><span class="op" id="3935556">[</span><span class="ident" id="3935557">i</span><span class="op" id="3935558">]</span>&nbsp;<span class="op" id="3935560">+=</span>&nbsp;<span class="ident" id="3935563">p224ZeroModP63</span><span class="op" id="3935577">[</span><span class="ident" id="3935578">i</span><span class="op" id="3935579">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3935582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3935586">//&nbsp;Eliminate&nbsp;the&nbsp;coefficients&nbsp;at&nbsp;2**224&nbsp;and&nbsp;greater.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3935640">for</span>&nbsp;<span class="ident" id="3935644">i</span>&nbsp;<span class="op" id="3935646">:=</span>&nbsp;<span class="num" id="3935649">14</span><span class="op" id="3935651">;</span>&nbsp;<span class="ident" id="3935653">i</span>&nbsp;<span class="op" id="3935655">&gt;=</span>&nbsp;<span class="num" id="3935658">8</span><span class="op" id="3935659">;</span>&nbsp;<span class="ident" id="3935661">i</span><span class="op" id="3935662">--</span>&nbsp;<span class="op" id="3935665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3935669">in</span><span class="op" id="3935671">[</span><span class="ident" id="3935672">i</span><span class="op" id="3935673">-</span><span class="num" id="3935674">8</span><span class="op" id="3935675">]</span>&nbsp;<span class="op" id="3935677">-=</span>&nbsp;<span class="ident" id="3935680">in</span><span class="op" id="3935682">[</span><span class="ident" id="3935683">i</span><span class="op" id="3935684">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3935688">in</span><span class="op" id="3935690">[</span><span class="ident" id="3935691">i</span><span class="op" id="3935692">-</span><span class="num" id="3935693">5</span><span class="op" id="3935694">]</span>&nbsp;<span class="op" id="3935696">+=</span>&nbsp;<span class="op" id="3935699">(</span><span class="ident" id="3935700">in</span><span class="op" id="3935702">[</span><span class="ident" id="3935703">i</span><span class="op" id="3935704">]</span>&nbsp;<span class="op" id="3935706">&amp;</span>&nbsp;<span class="num" id="3935708">0xffff</span><span class="op" id="3935714">)</span>&nbsp;<span class="op" id="3935716">&lt;&lt;</span>&nbsp;<span class="num" id="3935719">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3935724">in</span><span class="op" id="3935726">[</span><span class="ident" id="3935727">i</span><span class="op" id="3935728">-</span><span class="num" id="3935729">4</span><span class="op" id="3935730">]</span>&nbsp;<span class="op" id="3935732">+=</span>&nbsp;<span class="ident" id="3935735">in</span><span class="op" id="3935737">[</span><span class="ident" id="3935738">i</span><span class="op" id="3935739">]</span>&nbsp;<span class="op" id="3935741">&gt;&gt;</span>&nbsp;<span class="num" id="3935744">16</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3935748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3935751">in</span><span class="op" id="3935753">[</span><span class="num" id="3935754">8</span><span class="op" id="3935755">]</span>&nbsp;<span class="op" id="3935757">=</span>&nbsp;<span class="num" id="3935759">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3935762">//&nbsp;in[0..8]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3935784">//&nbsp;As&nbsp;the&nbsp;values&nbsp;become&nbsp;small&nbsp;enough,&nbsp;we&nbsp;start&nbsp;to&nbsp;store&nbsp;them&nbsp;in&nbsp;|out|</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3935855">//&nbsp;and&nbsp;use&nbsp;32-bit&nbsp;operations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3935886">for</span>&nbsp;<span class="ident" id="3935890">i</span>&nbsp;<span class="op" id="3935892">:=</span>&nbsp;<span class="num" id="3935895">1</span><span class="op" id="3935896">;</span>&nbsp;<span class="ident" id="3935898">i</span>&nbsp;<span class="op" id="3935900">&lt;</span>&nbsp;<span class="num" id="3935902">8</span><span class="op" id="3935903">;</span>&nbsp;<span class="ident" id="3935905">i</span><span class="op" id="3935906">++</span>&nbsp;<span class="op" id="3935909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3935913">in</span><span class="op" id="3935915">[</span><span class="ident" id="3935916">i</span><span class="op" id="3935917">+</span><span class="num" id="3935918">1</span><span class="op" id="3935919">]</span>&nbsp;<span class="op" id="3935921">+=</span>&nbsp;<span class="ident" id="3935924">in</span><span class="op" id="3935926">[</span><span class="ident" id="3935927">i</span><span class="op" id="3935928">]</span>&nbsp;<span class="op" id="3935930">&gt;&gt;</span>&nbsp;<span class="num" id="3935933">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3935938">out</span><span class="op" id="3935941">[</span><span class="ident" id="3935942">i</span><span class="op" id="3935943">]</span>&nbsp;<span class="op" id="3935945">=</span>&nbsp;<span class="builtintype" id="3935947">uint32</span><span class="op" id="3935953">(</span><span class="ident" id="3935954">in</span><span class="op" id="3935956">[</span><span class="ident" id="3935957">i</span><span class="op" id="3935958">]</span>&nbsp;<span class="op" id="3935960">&amp;</span>&nbsp;<span class="ident" id="3935962">bottom28Bits</span><span class="op" id="3935974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3935977">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3935980">in</span><span class="op" id="3935982">[</span><span class="num" id="3935983">0</span><span class="op" id="3935984">]</span>&nbsp;<span class="op" id="3935986">-=</span>&nbsp;<span class="ident" id="3935989">in</span><span class="op" id="3935991">[</span><span class="num" id="3935992">8</span><span class="op" id="3935993">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3935996">out</span><span class="op" id="3935999">[</span><span class="num" id="3936000">3</span><span class="op" id="3936001">]</span>&nbsp;<span class="op" id="3936003">+=</span>&nbsp;<span class="builtintype" id="3936006">uint32</span><span class="op" id="3936012">(</span><span class="ident" id="3936013">in</span><span class="op" id="3936015">[</span><span class="num" id="3936016">8</span><span class="op" id="3936017">]</span><span class="op" id="3936018">&amp;</span><span class="num" id="3936019">0xffff</span><span class="op" id="3936025">)</span>&nbsp;<span class="op" id="3936027">&lt;&lt;</span>&nbsp;<span class="num" id="3936030">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936034">out</span><span class="op" id="3936037">[</span><span class="num" id="3936038">4</span><span class="op" id="3936039">]</span>&nbsp;<span class="op" id="3936041">+=</span>&nbsp;<span class="builtintype" id="3936044">uint32</span><span class="op" id="3936050">(</span><span class="ident" id="3936051">in</span><span class="op" id="3936053">[</span><span class="num" id="3936054">8</span><span class="op" id="3936055">]</span>&nbsp;<span class="op" id="3936057">&gt;&gt;</span>&nbsp;<span class="num" id="3936060">16</span><span class="op" id="3936062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3936065">//&nbsp;in[0]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3936083">//&nbsp;out[3]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3936102">//&nbsp;out[4]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3936121">//&nbsp;out[1,2,5..7]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936148">out</span><span class="op" id="3936151">[</span><span class="num" id="3936152">0</span><span class="op" id="3936153">]</span>&nbsp;<span class="op" id="3936155">=</span>&nbsp;<span class="builtintype" id="3936157">uint32</span><span class="op" id="3936163">(</span><span class="ident" id="3936164">in</span><span class="op" id="3936166">[</span><span class="num" id="3936167">0</span><span class="op" id="3936168">]</span>&nbsp;<span class="op" id="3936170">&amp;</span>&nbsp;<span class="ident" id="3936172">bottom28Bits</span><span class="op" id="3936184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936187">out</span><span class="op" id="3936190">[</span><span class="num" id="3936191">1</span><span class="op" id="3936192">]</span>&nbsp;<span class="op" id="3936194">+=</span>&nbsp;<span class="builtintype" id="3936197">uint32</span><span class="op" id="3936203">(</span><span class="op" id="3936204">(</span><span class="ident" id="3936205">in</span><span class="op" id="3936207">[</span><span class="num" id="3936208">0</span><span class="op" id="3936209">]</span>&nbsp;<span class="op" id="3936211">&gt;&gt;</span>&nbsp;<span class="num" id="3936214">28</span><span class="op" id="3936216">)</span>&nbsp;<span class="op" id="3936218">&amp;</span>&nbsp;<span class="ident" id="3936220">bottom28Bits</span><span class="op" id="3936232">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936235">out</span><span class="op" id="3936238">[</span><span class="num" id="3936239">2</span><span class="op" id="3936240">]</span>&nbsp;<span class="op" id="3936242">+=</span>&nbsp;<span class="builtintype" id="3936245">uint32</span><span class="op" id="3936251">(</span><span class="ident" id="3936252">in</span><span class="op" id="3936254">[</span><span class="num" id="3936255">0</span><span class="op" id="3936256">]</span>&nbsp;<span class="op" id="3936258">&gt;&gt;</span>&nbsp;<span class="num" id="3936261">56</span><span class="op" id="3936263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3936266">//&nbsp;out[0]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3936285">//&nbsp;out[1..4]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3936307">//&nbsp;out[5..7]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><span class="op" id="3936328">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="3936331">//&nbsp;Reduce&nbsp;reduces&nbsp;the&nbsp;coefficients&nbsp;of&nbsp;a&nbsp;to&nbsp;smaller&nbsp;bounds.</span><br>
<span class="lineno"></span><span class="comment" id="3936390">//</span><br>
<span class="lineno"></span><span class="comment" id="3936393">//&nbsp;On&nbsp;entry:&nbsp;a[i]&nbsp;&lt;&nbsp;2**31&nbsp;+&nbsp;2**30</span><br>
<span class="lineno"></span><span class="comment" id="3936427">//&nbsp;On&nbsp;exit:&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">305</span><span class="keyword" id="3936452">func</span>&nbsp;<span class="ident" id="3936457">p224Reduce</span><span class="op" id="3936467">(</span><span class="ident" id="3936468">a</span>&nbsp;<span class="op" id="3936470">*</span><span class="ident" id="3936471">p224FieldElement</span><span class="op" id="3936487">)</span>&nbsp;<span class="op" id="3936489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3936492">for</span>&nbsp;<span class="ident" id="3936496">i</span>&nbsp;<span class="op" id="3936498">:=</span>&nbsp;<span class="num" id="3936501">0</span><span class="op" id="3936502">;</span>&nbsp;<span class="ident" id="3936504">i</span>&nbsp;<span class="op" id="3936506">&lt;</span>&nbsp;<span class="num" id="3936508">7</span><span class="op" id="3936509">;</span>&nbsp;<span class="ident" id="3936511">i</span><span class="op" id="3936512">++</span>&nbsp;<span class="op" id="3936515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936519">a</span><span class="op" id="3936520">[</span><span class="ident" id="3936521">i</span><span class="op" id="3936522">+</span><span class="num" id="3936523">1</span><span class="op" id="3936524">]</span>&nbsp;<span class="op" id="3936526">+=</span>&nbsp;<span class="ident" id="3936529">a</span><span class="op" id="3936530">[</span><span class="ident" id="3936531">i</span><span class="op" id="3936532">]</span>&nbsp;<span class="op" id="3936534">&gt;&gt;</span>&nbsp;<span class="num" id="3936537">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936542">a</span><span class="op" id="3936543">[</span><span class="ident" id="3936544">i</span><span class="op" id="3936545">]</span>&nbsp;<span class="op" id="3936547">&amp;=</span>&nbsp;<span class="ident" id="3936550">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3936564">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936567">top</span>&nbsp;<span class="op" id="3936571">:=</span>&nbsp;<span class="ident" id="3936574">a</span><span class="op" id="3936575">[</span><span class="num" id="3936576">7</span><span class="op" id="3936577">]</span>&nbsp;<span class="op" id="3936579">&gt;&gt;</span>&nbsp;<span class="num" id="3936582">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936586">a</span><span class="op" id="3936587">[</span><span class="num" id="3936588">7</span><span class="op" id="3936589">]</span>&nbsp;<span class="op" id="3936591">&amp;=</span>&nbsp;<span class="ident" id="3936594">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3936609">//&nbsp;top&nbsp;&lt;&nbsp;2**4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936624">mask</span>&nbsp;<span class="op" id="3936629">:=</span>&nbsp;<span class="ident" id="3936632">top</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936637">mask</span>&nbsp;<span class="op" id="3936642">|=</span>&nbsp;<span class="ident" id="3936645">mask</span>&nbsp;<span class="op" id="3936650">&gt;&gt;</span>&nbsp;<span class="num" id="3936653">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936656">mask</span>&nbsp;<span class="op" id="3936661">|=</span>&nbsp;<span class="ident" id="3936664">mask</span>&nbsp;<span class="op" id="3936669">&gt;&gt;</span>&nbsp;<span class="num" id="3936672">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936675">mask</span>&nbsp;<span class="op" id="3936680">&lt;&lt;=</span>&nbsp;<span class="num" id="3936684">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936688">mask</span>&nbsp;<span class="op" id="3936693">=</span>&nbsp;<span class="builtintype" id="3936695">uint32</span><span class="op" id="3936701">(</span><span class="builtintype" id="3936702">int32</span><span class="op" id="3936707">(</span><span class="ident" id="3936708">mask</span><span class="op" id="3936712">)</span>&nbsp;<span class="op" id="3936714">&gt;&gt;</span>&nbsp;<span class="num" id="3936717">31</span><span class="op" id="3936719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3936722">//&nbsp;Mask&nbsp;is&nbsp;all&nbsp;ones&nbsp;if&nbsp;top&nbsp;!=&nbsp;0,&nbsp;all&nbsp;zero&nbsp;otherwise</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936776">a</span><span class="op" id="3936777">[</span><span class="num" id="3936778">0</span><span class="op" id="3936779">]</span>&nbsp;<span class="op" id="3936781">-=</span>&nbsp;<span class="ident" id="3936784">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936789">a</span><span class="op" id="3936790">[</span><span class="num" id="3936791">3</span><span class="op" id="3936792">]</span>&nbsp;<span class="op" id="3936794">+=</span>&nbsp;<span class="ident" id="3936797">top</span>&nbsp;<span class="op" id="3936801">&lt;&lt;</span>&nbsp;<span class="num" id="3936804">12</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3936809">//&nbsp;We&nbsp;may&nbsp;have&nbsp;just&nbsp;made&nbsp;a[0]&nbsp;negative&nbsp;but,&nbsp;if&nbsp;we&nbsp;did,&nbsp;then&nbsp;we&nbsp;must</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3936878">//&nbsp;have&nbsp;added&nbsp;something&nbsp;to&nbsp;a[3],&nbsp;this&nbsp;it&#39;s&nbsp;&gt;&nbsp;2**12.&nbsp;Therefore&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3936948">//&nbsp;carry&nbsp;down&nbsp;to&nbsp;a[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936972">a</span><span class="op" id="3936973">[</span><span class="num" id="3936974">3</span><span class="op" id="3936975">]</span>&nbsp;<span class="op" id="3936977">-=</span>&nbsp;<span class="num" id="3936980">1</span>&nbsp;<span class="op" id="3936982">&amp;</span>&nbsp;<span class="ident" id="3936984">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936990">a</span><span class="op" id="3936991">[</span><span class="num" id="3936992">2</span><span class="op" id="3936993">]</span>&nbsp;<span class="op" id="3936995">+=</span>&nbsp;<span class="ident" id="3936998">mask</span>&nbsp;<span class="op" id="3937003">&amp;</span>&nbsp;<span class="op" id="3937005">(</span><span class="num" id="3937006">1</span><span class="op" id="3937007">&lt;&lt;</span><span class="num" id="3937009">28</span>&nbsp;<span class="op" id="3937012">-</span>&nbsp;<span class="num" id="3937014">1</span><span class="op" id="3937015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3937018">a</span><span class="op" id="3937019">[</span><span class="num" id="3937020">1</span><span class="op" id="3937021">]</span>&nbsp;<span class="op" id="3937023">+=</span>&nbsp;<span class="ident" id="3937026">mask</span>&nbsp;<span class="op" id="3937031">&amp;</span>&nbsp;<span class="op" id="3937033">(</span><span class="num" id="3937034">1</span><span class="op" id="3937035">&lt;&lt;</span><span class="num" id="3937037">28</span>&nbsp;<span class="op" id="3937040">-</span>&nbsp;<span class="num" id="3937042">1</span><span class="op" id="3937043">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3937046">a</span><span class="op" id="3937047">[</span><span class="num" id="3937048">0</span><span class="op" id="3937049">]</span>&nbsp;<span class="op" id="3937051">+=</span>&nbsp;<span class="ident" id="3937054">mask</span>&nbsp;<span class="op" id="3937059">&amp;</span>&nbsp;<span class="op" id="3937061">(</span><span class="num" id="3937062">1</span>&nbsp;<span class="op" id="3937064">&lt;&lt;</span>&nbsp;<span class="num" id="3937067">28</span><span class="op" id="3937069">)</span><br>
<span class="lineno"></span><span class="op" id="3937071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3937074">//&nbsp;p224Invert&nbsp;calculates&nbsp;*out&nbsp;=&nbsp;in**-1&nbsp;by&nbsp;computing&nbsp;in**(2**224&nbsp;-&nbsp;2**96&nbsp;-&nbsp;1),</span><br>
<span class="lineno"></span><span class="comment" id="3937152">//&nbsp;i.e.&nbsp;Fermat&#39;s&nbsp;little&nbsp;theorem.</span><br>
<span class="lineno">335</span><span class="keyword" id="3937185">func</span>&nbsp;<span class="ident" id="3937190">p224Invert</span><span class="op" id="3937200">(</span><span class="ident" id="3937201">out</span><span class="op" id="3937204">,</span>&nbsp;<span class="ident" id="3937206">in</span>&nbsp;<span class="op" id="3937209">*</span><span class="ident" id="3937210">p224FieldElement</span><span class="op" id="3937226">)</span>&nbsp;<span class="op" id="3937228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3937231">var</span>&nbsp;<span class="ident" id="3937235">f1</span><span class="op" id="3937237">,</span>&nbsp;<span class="ident" id="3937239">f2</span><span class="op" id="3937241">,</span>&nbsp;<span class="ident" id="3937243">f3</span><span class="op" id="3937245">,</span>&nbsp;<span class="ident" id="3937247">f4</span>&nbsp;<span class="ident" id="3937250">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3937268">var</span>&nbsp;<span class="ident" id="3937272">c</span>&nbsp;<span class="ident" id="3937274">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3937298">p224Square</span><span class="op" id="3937308">(</span><span class="op" id="3937309">&amp;</span><span class="ident" id="3937310">f1</span><span class="op" id="3937312">,</span>&nbsp;<span class="ident" id="3937314">in</span><span class="op" id="3937316">,</span>&nbsp;<span class="op" id="3937318">&amp;</span><span class="ident" id="3937319">c</span><span class="op" id="3937320">)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3937325">//&nbsp;2</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3937331">p224Mul</span><span class="op" id="3937338">(</span><span class="op" id="3937339">&amp;</span><span class="ident" id="3937340">f1</span><span class="op" id="3937342">,</span>&nbsp;<span class="op" id="3937344">&amp;</span><span class="ident" id="3937345">f1</span><span class="op" id="3937347">,</span>&nbsp;<span class="ident" id="3937349">in</span><span class="op" id="3937351">,</span>&nbsp;<span class="op" id="3937353">&amp;</span><span class="ident" id="3937354">c</span><span class="op" id="3937355">)</span>&nbsp;&nbsp;<span class="comment" id="3937358">//&nbsp;2**2&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3937371">p224Square</span><span class="op" id="3937381">(</span><span class="op" id="3937382">&amp;</span><span class="ident" id="3937383">f1</span><span class="op" id="3937385">,</span>&nbsp;<span class="op" id="3937387">&amp;</span><span class="ident" id="3937388">f1</span><span class="op" id="3937390">,</span>&nbsp;<span class="op" id="3937392">&amp;</span><span class="ident" id="3937393">c</span><span class="op" id="3937394">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3937398">//&nbsp;2**3&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3937411">p224Mul</span><span class="op" id="3937418">(</span><span class="op" id="3937419">&amp;</span><span class="ident" id="3937420">f1</span><span class="op" id="3937422">,</span>&nbsp;<span class="op" id="3937424">&amp;</span><span class="ident" id="3937425">f1</span><span class="op" id="3937427">,</span>&nbsp;<span class="ident" id="3937429">in</span><span class="op" id="3937431">,</span>&nbsp;<span class="op" id="3937433">&amp;</span><span class="ident" id="3937434">c</span><span class="op" id="3937435">)</span>&nbsp;&nbsp;<span class="comment" id="3937438">//&nbsp;2**3&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3937451">p224Square</span><span class="op" id="3937461">(</span><span class="op" id="3937462">&amp;</span><span class="ident" id="3937463">f2</span><span class="op" id="3937465">,</span>&nbsp;<span class="op" id="3937467">&amp;</span><span class="ident" id="3937468">f1</span><span class="op" id="3937470">,</span>&nbsp;<span class="op" id="3937472">&amp;</span><span class="ident" id="3937473">c</span><span class="op" id="3937474">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3937478">//&nbsp;2**4&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3937491">p224Square</span><span class="op" id="3937501">(</span><span class="op" id="3937502">&amp;</span><span class="ident" id="3937503">f2</span><span class="op" id="3937505">,</span>&nbsp;<span class="op" id="3937507">&amp;</span><span class="ident" id="3937508">f2</span><span class="op" id="3937510">,</span>&nbsp;<span class="op" id="3937512">&amp;</span><span class="ident" id="3937513">c</span><span class="op" id="3937514">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3937518">//&nbsp;2**5&nbsp;-&nbsp;4</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3937531">p224Square</span><span class="op" id="3937541">(</span><span class="op" id="3937542">&amp;</span><span class="ident" id="3937543">f2</span><span class="op" id="3937545">,</span>&nbsp;<span class="op" id="3937547">&amp;</span><span class="ident" id="3937548">f2</span><span class="op" id="3937550">,</span>&nbsp;<span class="op" id="3937552">&amp;</span><span class="ident" id="3937553">c</span><span class="op" id="3937554">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3937558">//&nbsp;2**6&nbsp;-&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3937571">p224Mul</span><span class="op" id="3937578">(</span><span class="op" id="3937579">&amp;</span><span class="ident" id="3937580">f1</span><span class="op" id="3937582">,</span>&nbsp;<span class="op" id="3937584">&amp;</span><span class="ident" id="3937585">f1</span><span class="op" id="3937587">,</span>&nbsp;<span class="op" id="3937589">&amp;</span><span class="ident" id="3937590">f2</span><span class="op" id="3937592">,</span>&nbsp;<span class="op" id="3937594">&amp;</span><span class="ident" id="3937595">c</span><span class="op" id="3937596">)</span>&nbsp;<span class="comment" id="3937598">//&nbsp;2**6&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3937611">p224Square</span><span class="op" id="3937621">(</span><span class="op" id="3937622">&amp;</span><span class="ident" id="3937623">f2</span><span class="op" id="3937625">,</span>&nbsp;<span class="op" id="3937627">&amp;</span><span class="ident" id="3937628">f1</span><span class="op" id="3937630">,</span>&nbsp;<span class="op" id="3937632">&amp;</span><span class="ident" id="3937633">c</span><span class="op" id="3937634">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3937638">//&nbsp;2**7&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3937651">for</span>&nbsp;<span class="ident" id="3937655">i</span>&nbsp;<span class="op" id="3937657">:=</span>&nbsp;<span class="num" id="3937660">0</span><span class="op" id="3937661">;</span>&nbsp;<span class="ident" id="3937663">i</span>&nbsp;<span class="op" id="3937665">&lt;</span>&nbsp;<span class="num" id="3937667">5</span><span class="op" id="3937668">;</span>&nbsp;<span class="ident" id="3937670">i</span><span class="op" id="3937671">++</span>&nbsp;<span class="op" id="3937674">{</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3937678">//&nbsp;2**12&nbsp;-&nbsp;2**6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3937696">p224Square</span><span class="op" id="3937706">(</span><span class="op" id="3937707">&amp;</span><span class="ident" id="3937708">f2</span><span class="op" id="3937710">,</span>&nbsp;<span class="op" id="3937712">&amp;</span><span class="ident" id="3937713">f2</span><span class="op" id="3937715">,</span>&nbsp;<span class="op" id="3937717">&amp;</span><span class="ident" id="3937718">c</span><span class="op" id="3937719">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3937722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3937725">p224Mul</span><span class="op" id="3937732">(</span><span class="op" id="3937733">&amp;</span><span class="ident" id="3937734">f2</span><span class="op" id="3937736">,</span>&nbsp;<span class="op" id="3937738">&amp;</span><span class="ident" id="3937739">f2</span><span class="op" id="3937741">,</span>&nbsp;<span class="op" id="3937743">&amp;</span><span class="ident" id="3937744">f1</span><span class="op" id="3937746">,</span>&nbsp;<span class="op" id="3937748">&amp;</span><span class="ident" id="3937749">c</span><span class="op" id="3937750">)</span>&nbsp;<span class="comment" id="3937752">//&nbsp;2**12&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3937766">p224Square</span><span class="op" id="3937776">(</span><span class="op" id="3937777">&amp;</span><span class="ident" id="3937778">f3</span><span class="op" id="3937780">,</span>&nbsp;<span class="op" id="3937782">&amp;</span><span class="ident" id="3937783">f2</span><span class="op" id="3937785">,</span>&nbsp;<span class="op" id="3937787">&amp;</span><span class="ident" id="3937788">c</span><span class="op" id="3937789">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3937793">//&nbsp;2**13&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3937807">for</span>&nbsp;<span class="ident" id="3937811">i</span>&nbsp;<span class="op" id="3937813">:=</span>&nbsp;<span class="num" id="3937816">0</span><span class="op" id="3937817">;</span>&nbsp;<span class="ident" id="3937819">i</span>&nbsp;<span class="op" id="3937821">&lt;</span>&nbsp;<span class="num" id="3937823">11</span><span class="op" id="3937825">;</span>&nbsp;<span class="ident" id="3937827">i</span><span class="op" id="3937828">++</span>&nbsp;<span class="op" id="3937831">{</span>&nbsp;&nbsp;<span class="comment" id="3937834">//&nbsp;2**24&nbsp;-&nbsp;2**12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3937853">p224Square</span><span class="op" id="3937863">(</span><span class="op" id="3937864">&amp;</span><span class="ident" id="3937865">f3</span><span class="op" id="3937867">,</span>&nbsp;<span class="op" id="3937869">&amp;</span><span class="ident" id="3937870">f3</span><span class="op" id="3937872">,</span>&nbsp;<span class="op" id="3937874">&amp;</span><span class="ident" id="3937875">c</span><span class="op" id="3937876">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3937879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3937882">p224Mul</span><span class="op" id="3937889">(</span><span class="op" id="3937890">&amp;</span><span class="ident" id="3937891">f2</span><span class="op" id="3937893">,</span>&nbsp;<span class="op" id="3937895">&amp;</span><span class="ident" id="3937896">f3</span><span class="op" id="3937898">,</span>&nbsp;<span class="op" id="3937900">&amp;</span><span class="ident" id="3937901">f2</span><span class="op" id="3937903">,</span>&nbsp;<span class="op" id="3937905">&amp;</span><span class="ident" id="3937906">c</span><span class="op" id="3937907">)</span>&nbsp;<span class="comment" id="3937909">//&nbsp;2**24&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3937923">p224Square</span><span class="op" id="3937933">(</span><span class="op" id="3937934">&amp;</span><span class="ident" id="3937935">f3</span><span class="op" id="3937937">,</span>&nbsp;<span class="op" id="3937939">&amp;</span><span class="ident" id="3937940">f2</span><span class="op" id="3937942">,</span>&nbsp;<span class="op" id="3937944">&amp;</span><span class="ident" id="3937945">c</span><span class="op" id="3937946">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3937950">//&nbsp;2**25&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3937964">for</span>&nbsp;<span class="ident" id="3937968">i</span>&nbsp;<span class="op" id="3937970">:=</span>&nbsp;<span class="num" id="3937973">0</span><span class="op" id="3937974">;</span>&nbsp;<span class="ident" id="3937976">i</span>&nbsp;<span class="op" id="3937978">&lt;</span>&nbsp;<span class="num" id="3937980">23</span><span class="op" id="3937982">;</span>&nbsp;<span class="ident" id="3937984">i</span><span class="op" id="3937985">++</span>&nbsp;<span class="op" id="3937988">{</span>&nbsp;&nbsp;<span class="comment" id="3937991">//&nbsp;2**48&nbsp;-&nbsp;2**24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3938010">p224Square</span><span class="op" id="3938020">(</span><span class="op" id="3938021">&amp;</span><span class="ident" id="3938022">f3</span><span class="op" id="3938024">,</span>&nbsp;<span class="op" id="3938026">&amp;</span><span class="ident" id="3938027">f3</span><span class="op" id="3938029">,</span>&nbsp;<span class="op" id="3938031">&amp;</span><span class="ident" id="3938032">c</span><span class="op" id="3938033">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3938036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3938039">p224Mul</span><span class="op" id="3938046">(</span><span class="op" id="3938047">&amp;</span><span class="ident" id="3938048">f3</span><span class="op" id="3938050">,</span>&nbsp;<span class="op" id="3938052">&amp;</span><span class="ident" id="3938053">f3</span><span class="op" id="3938055">,</span>&nbsp;<span class="op" id="3938057">&amp;</span><span class="ident" id="3938058">f2</span><span class="op" id="3938060">,</span>&nbsp;<span class="op" id="3938062">&amp;</span><span class="ident" id="3938063">c</span><span class="op" id="3938064">)</span>&nbsp;<span class="comment" id="3938066">//&nbsp;2**48&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3938080">p224Square</span><span class="op" id="3938090">(</span><span class="op" id="3938091">&amp;</span><span class="ident" id="3938092">f4</span><span class="op" id="3938094">,</span>&nbsp;<span class="op" id="3938096">&amp;</span><span class="ident" id="3938097">f3</span><span class="op" id="3938099">,</span>&nbsp;<span class="op" id="3938101">&amp;</span><span class="ident" id="3938102">c</span><span class="op" id="3938103">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3938107">//&nbsp;2**49&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3938121">for</span>&nbsp;<span class="ident" id="3938125">i</span>&nbsp;<span class="op" id="3938127">:=</span>&nbsp;<span class="num" id="3938130">0</span><span class="op" id="3938131">;</span>&nbsp;<span class="ident" id="3938133">i</span>&nbsp;<span class="op" id="3938135">&lt;</span>&nbsp;<span class="num" id="3938137">47</span><span class="op" id="3938139">;</span>&nbsp;<span class="ident" id="3938141">i</span><span class="op" id="3938142">++</span>&nbsp;<span class="op" id="3938145">{</span>&nbsp;&nbsp;<span class="comment" id="3938148">//&nbsp;2**96&nbsp;-&nbsp;2**48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3938167">p224Square</span><span class="op" id="3938177">(</span><span class="op" id="3938178">&amp;</span><span class="ident" id="3938179">f4</span><span class="op" id="3938181">,</span>&nbsp;<span class="op" id="3938183">&amp;</span><span class="ident" id="3938184">f4</span><span class="op" id="3938186">,</span>&nbsp;<span class="op" id="3938188">&amp;</span><span class="ident" id="3938189">c</span><span class="op" id="3938190">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3938193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3938196">p224Mul</span><span class="op" id="3938203">(</span><span class="op" id="3938204">&amp;</span><span class="ident" id="3938205">f3</span><span class="op" id="3938207">,</span>&nbsp;<span class="op" id="3938209">&amp;</span><span class="ident" id="3938210">f3</span><span class="op" id="3938212">,</span>&nbsp;<span class="op" id="3938214">&amp;</span><span class="ident" id="3938215">f4</span><span class="op" id="3938217">,</span>&nbsp;<span class="op" id="3938219">&amp;</span><span class="ident" id="3938220">c</span><span class="op" id="3938221">)</span>&nbsp;<span class="comment" id="3938223">//&nbsp;2**96&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3938237">p224Square</span><span class="op" id="3938247">(</span><span class="op" id="3938248">&amp;</span><span class="ident" id="3938249">f4</span><span class="op" id="3938251">,</span>&nbsp;<span class="op" id="3938253">&amp;</span><span class="ident" id="3938254">f3</span><span class="op" id="3938256">,</span>&nbsp;<span class="op" id="3938258">&amp;</span><span class="ident" id="3938259">c</span><span class="op" id="3938260">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3938264">//&nbsp;2**97&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3938278">for</span>&nbsp;<span class="ident" id="3938282">i</span>&nbsp;<span class="op" id="3938284">:=</span>&nbsp;<span class="num" id="3938287">0</span><span class="op" id="3938288">;</span>&nbsp;<span class="ident" id="3938290">i</span>&nbsp;<span class="op" id="3938292">&lt;</span>&nbsp;<span class="num" id="3938294">23</span><span class="op" id="3938296">;</span>&nbsp;<span class="ident" id="3938298">i</span><span class="op" id="3938299">++</span>&nbsp;<span class="op" id="3938302">{</span>&nbsp;&nbsp;<span class="comment" id="3938305">//&nbsp;2**120&nbsp;-&nbsp;2**24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3938325">p224Square</span><span class="op" id="3938335">(</span><span class="op" id="3938336">&amp;</span><span class="ident" id="3938337">f4</span><span class="op" id="3938339">,</span>&nbsp;<span class="op" id="3938341">&amp;</span><span class="ident" id="3938342">f4</span><span class="op" id="3938344">,</span>&nbsp;<span class="op" id="3938346">&amp;</span><span class="ident" id="3938347">c</span><span class="op" id="3938348">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3938351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3938354">p224Mul</span><span class="op" id="3938361">(</span><span class="op" id="3938362">&amp;</span><span class="ident" id="3938363">f2</span><span class="op" id="3938365">,</span>&nbsp;<span class="op" id="3938367">&amp;</span><span class="ident" id="3938368">f4</span><span class="op" id="3938370">,</span>&nbsp;<span class="op" id="3938372">&amp;</span><span class="ident" id="3938373">f2</span><span class="op" id="3938375">,</span>&nbsp;<span class="op" id="3938377">&amp;</span><span class="ident" id="3938378">c</span><span class="op" id="3938379">)</span>&nbsp;<span class="comment" id="3938381">//&nbsp;2**120&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3938396">for</span>&nbsp;<span class="ident" id="3938400">i</span>&nbsp;<span class="op" id="3938402">:=</span>&nbsp;<span class="num" id="3938405">0</span><span class="op" id="3938406">;</span>&nbsp;<span class="ident" id="3938408">i</span>&nbsp;<span class="op" id="3938410">&lt;</span>&nbsp;<span class="num" id="3938412">6</span><span class="op" id="3938413">;</span>&nbsp;<span class="ident" id="3938415">i</span><span class="op" id="3938416">++</span>&nbsp;<span class="op" id="3938419">{</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3938423">//&nbsp;2**126&nbsp;-&nbsp;2**6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3938442">p224Square</span><span class="op" id="3938452">(</span><span class="op" id="3938453">&amp;</span><span class="ident" id="3938454">f2</span><span class="op" id="3938456">,</span>&nbsp;<span class="op" id="3938458">&amp;</span><span class="ident" id="3938459">f2</span><span class="op" id="3938461">,</span>&nbsp;<span class="op" id="3938463">&amp;</span><span class="ident" id="3938464">c</span><span class="op" id="3938465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3938468">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3938471">p224Mul</span><span class="op" id="3938478">(</span><span class="op" id="3938479">&amp;</span><span class="ident" id="3938480">f1</span><span class="op" id="3938482">,</span>&nbsp;<span class="op" id="3938484">&amp;</span><span class="ident" id="3938485">f1</span><span class="op" id="3938487">,</span>&nbsp;<span class="op" id="3938489">&amp;</span><span class="ident" id="3938490">f2</span><span class="op" id="3938492">,</span>&nbsp;<span class="op" id="3938494">&amp;</span><span class="ident" id="3938495">c</span><span class="op" id="3938496">)</span>&nbsp;<span class="comment" id="3938498">//&nbsp;2**126&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3938513">p224Square</span><span class="op" id="3938523">(</span><span class="op" id="3938524">&amp;</span><span class="ident" id="3938525">f1</span><span class="op" id="3938527">,</span>&nbsp;<span class="op" id="3938529">&amp;</span><span class="ident" id="3938530">f1</span><span class="op" id="3938532">,</span>&nbsp;<span class="op" id="3938534">&amp;</span><span class="ident" id="3938535">c</span><span class="op" id="3938536">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3938540">//&nbsp;2**127&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3938555">p224Mul</span><span class="op" id="3938562">(</span><span class="op" id="3938563">&amp;</span><span class="ident" id="3938564">f1</span><span class="op" id="3938566">,</span>&nbsp;<span class="op" id="3938568">&amp;</span><span class="ident" id="3938569">f1</span><span class="op" id="3938571">,</span>&nbsp;<span class="ident" id="3938573">in</span><span class="op" id="3938575">,</span>&nbsp;<span class="op" id="3938577">&amp;</span><span class="ident" id="3938578">c</span><span class="op" id="3938579">)</span>&nbsp;&nbsp;<span class="comment" id="3938582">//&nbsp;2**127&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3938597">for</span>&nbsp;<span class="ident" id="3938601">i</span>&nbsp;<span class="op" id="3938603">:=</span>&nbsp;<span class="num" id="3938606">0</span><span class="op" id="3938607">;</span>&nbsp;<span class="ident" id="3938609">i</span>&nbsp;<span class="op" id="3938611">&lt;</span>&nbsp;<span class="num" id="3938613">97</span><span class="op" id="3938615">;</span>&nbsp;<span class="ident" id="3938617">i</span><span class="op" id="3938618">++</span>&nbsp;<span class="op" id="3938621">{</span>&nbsp;&nbsp;<span class="comment" id="3938624">//&nbsp;2**224&nbsp;-&nbsp;2**97</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3938644">p224Square</span><span class="op" id="3938654">(</span><span class="op" id="3938655">&amp;</span><span class="ident" id="3938656">f1</span><span class="op" id="3938658">,</span>&nbsp;<span class="op" id="3938660">&amp;</span><span class="ident" id="3938661">f1</span><span class="op" id="3938663">,</span>&nbsp;<span class="op" id="3938665">&amp;</span><span class="ident" id="3938666">c</span><span class="op" id="3938667">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3938670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3938673">p224Mul</span><span class="op" id="3938680">(</span><span class="ident" id="3938681">out</span><span class="op" id="3938684">,</span>&nbsp;<span class="op" id="3938686">&amp;</span><span class="ident" id="3938687">f1</span><span class="op" id="3938689">,</span>&nbsp;<span class="op" id="3938691">&amp;</span><span class="ident" id="3938692">f3</span><span class="op" id="3938694">,</span>&nbsp;<span class="op" id="3938696">&amp;</span><span class="ident" id="3938697">c</span><span class="op" id="3938698">)</span>&nbsp;<span class="comment" id="3938700">//&nbsp;2**224&nbsp;-&nbsp;2**96&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span><span class="op" id="3938722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3938725">//&nbsp;p224Contract&nbsp;converts&nbsp;a&nbsp;FieldElement&nbsp;to&nbsp;its&nbsp;unique,&nbsp;minimal&nbsp;form.</span><br>
<span class="lineno">385</span><span class="comment" id="3938794">//</span><br>
<span class="lineno"></span><span class="comment" id="3938797">//&nbsp;On&nbsp;entry,&nbsp;in[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="comment" id="3938824">//&nbsp;On&nbsp;exit,&nbsp;in[i]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><span class="keyword" id="3938850">func</span>&nbsp;<span class="ident" id="3938855">p224Contract</span><span class="op" id="3938867">(</span><span class="ident" id="3938868">out</span><span class="op" id="3938871">,</span>&nbsp;<span class="ident" id="3938873">in</span>&nbsp;<span class="op" id="3938876">*</span><span class="ident" id="3938877">p224FieldElement</span><span class="op" id="3938893">)</span>&nbsp;<span class="op" id="3938895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3938898">copy</span><span class="op" id="3938902">(</span><span class="ident" id="3938903">out</span><span class="op" id="3938906">[</span><span class="op" id="3938907">:</span><span class="op" id="3938908">]</span><span class="op" id="3938909">,</span>&nbsp;<span class="ident" id="3938911">in</span><span class="op" id="3938913">[</span><span class="op" id="3938914">:</span><span class="op" id="3938915">]</span><span class="op" id="3938916">)</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3938920">for</span>&nbsp;<span class="ident" id="3938924">i</span>&nbsp;<span class="op" id="3938926">:=</span>&nbsp;<span class="num" id="3938929">0</span><span class="op" id="3938930">;</span>&nbsp;<span class="ident" id="3938932">i</span>&nbsp;<span class="op" id="3938934">&lt;</span>&nbsp;<span class="num" id="3938936">7</span><span class="op" id="3938937">;</span>&nbsp;<span class="ident" id="3938939">i</span><span class="op" id="3938940">++</span>&nbsp;<span class="op" id="3938943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3938947">out</span><span class="op" id="3938950">[</span><span class="ident" id="3938951">i</span><span class="op" id="3938952">+</span><span class="num" id="3938953">1</span><span class="op" id="3938954">]</span>&nbsp;<span class="op" id="3938956">+=</span>&nbsp;<span class="ident" id="3938959">out</span><span class="op" id="3938962">[</span><span class="ident" id="3938963">i</span><span class="op" id="3938964">]</span>&nbsp;<span class="op" id="3938966">&gt;&gt;</span>&nbsp;<span class="num" id="3938969">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3938974">out</span><span class="op" id="3938977">[</span><span class="ident" id="3938978">i</span><span class="op" id="3938979">]</span>&nbsp;<span class="op" id="3938981">&amp;=</span>&nbsp;<span class="ident" id="3938984">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3938998">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3939001">top</span>&nbsp;<span class="op" id="3939005">:=</span>&nbsp;<span class="ident" id="3939008">out</span><span class="op" id="3939011">[</span><span class="num" id="3939012">7</span><span class="op" id="3939013">]</span>&nbsp;<span class="op" id="3939015">&gt;&gt;</span>&nbsp;<span class="num" id="3939018">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3939022">out</span><span class="op" id="3939025">[</span><span class="num" id="3939026">7</span><span class="op" id="3939027">]</span>&nbsp;<span class="op" id="3939029">&amp;=</span>&nbsp;<span class="ident" id="3939032">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3939047">out</span><span class="op" id="3939050">[</span><span class="num" id="3939051">0</span><span class="op" id="3939052">]</span>&nbsp;<span class="op" id="3939054">-=</span>&nbsp;<span class="ident" id="3939057">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3939062">out</span><span class="op" id="3939065">[</span><span class="num" id="3939066">3</span><span class="op" id="3939067">]</span>&nbsp;<span class="op" id="3939069">+=</span>&nbsp;<span class="ident" id="3939072">top</span>&nbsp;<span class="op" id="3939076">&lt;&lt;</span>&nbsp;<span class="num" id="3939079">12</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3939084">//&nbsp;We&nbsp;may&nbsp;just&nbsp;have&nbsp;made&nbsp;out[i]&nbsp;negative.&nbsp;So&nbsp;we&nbsp;carry&nbsp;down.&nbsp;If&nbsp;we&nbsp;made</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3939156">//&nbsp;out[0]&nbsp;negative&nbsp;then&nbsp;we&nbsp;know&nbsp;that&nbsp;out[3]&nbsp;is&nbsp;sufficiently&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3939226">//&nbsp;because&nbsp;we&nbsp;just&nbsp;added&nbsp;to&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3939259">for</span>&nbsp;<span class="ident" id="3939263">i</span>&nbsp;<span class="op" id="3939265">:=</span>&nbsp;<span class="num" id="3939268">0</span><span class="op" id="3939269">;</span>&nbsp;<span class="ident" id="3939271">i</span>&nbsp;<span class="op" id="3939273">&lt;</span>&nbsp;<span class="num" id="3939275">3</span><span class="op" id="3939276">;</span>&nbsp;<span class="ident" id="3939278">i</span><span class="op" id="3939279">++</span>&nbsp;<span class="op" id="3939282">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3939286">mask</span>&nbsp;<span class="op" id="3939291">:=</span>&nbsp;<span class="builtintype" id="3939294">uint32</span><span class="op" id="3939300">(</span><span class="builtintype" id="3939301">int32</span><span class="op" id="3939306">(</span><span class="ident" id="3939307">out</span><span class="op" id="3939310">[</span><span class="ident" id="3939311">i</span><span class="op" id="3939312">]</span><span class="op" id="3939313">)</span>&nbsp;<span class="op" id="3939315">&gt;&gt;</span>&nbsp;<span class="num" id="3939318">31</span><span class="op" id="3939320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3939324">out</span><span class="op" id="3939327">[</span><span class="ident" id="3939328">i</span><span class="op" id="3939329">]</span>&nbsp;<span class="op" id="3939331">+=</span>&nbsp;<span class="op" id="3939334">(</span><span class="num" id="3939335">1</span>&nbsp;<span class="op" id="3939337">&lt;&lt;</span>&nbsp;<span class="num" id="3939340">28</span><span class="op" id="3939342">)</span>&nbsp;<span class="op" id="3939344">&amp;</span>&nbsp;<span class="ident" id="3939346">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3939353">out</span><span class="op" id="3939356">[</span><span class="ident" id="3939357">i</span><span class="op" id="3939358">+</span><span class="num" id="3939359">1</span><span class="op" id="3939360">]</span>&nbsp;<span class="op" id="3939362">-=</span>&nbsp;<span class="num" id="3939365">1</span>&nbsp;<span class="op" id="3939367">&amp;</span>&nbsp;<span class="ident" id="3939369">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3939375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3939379">//&nbsp;We&nbsp;might&nbsp;have&nbsp;pushed&nbsp;out[3]&nbsp;over&nbsp;2**28&nbsp;so&nbsp;we&nbsp;perform&nbsp;another,&nbsp;partial,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3939454">//&nbsp;carry&nbsp;chain.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3939471">for</span>&nbsp;<span class="ident" id="3939475">i</span>&nbsp;<span class="op" id="3939477">:=</span>&nbsp;<span class="num" id="3939480">3</span><span class="op" id="3939481">;</span>&nbsp;<span class="ident" id="3939483">i</span>&nbsp;<span class="op" id="3939485">&lt;</span>&nbsp;<span class="num" id="3939487">7</span><span class="op" id="3939488">;</span>&nbsp;<span class="ident" id="3939490">i</span><span class="op" id="3939491">++</span>&nbsp;<span class="op" id="3939494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3939498">out</span><span class="op" id="3939501">[</span><span class="ident" id="3939502">i</span><span class="op" id="3939503">+</span><span class="num" id="3939504">1</span><span class="op" id="3939505">]</span>&nbsp;<span class="op" id="3939507">+=</span>&nbsp;<span class="ident" id="3939510">out</span><span class="op" id="3939513">[</span><span class="ident" id="3939514">i</span><span class="op" id="3939515">]</span>&nbsp;<span class="op" id="3939517">&gt;&gt;</span>&nbsp;<span class="num" id="3939520">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3939525">out</span><span class="op" id="3939528">[</span><span class="ident" id="3939529">i</span><span class="op" id="3939530">]</span>&nbsp;<span class="op" id="3939532">&amp;=</span>&nbsp;<span class="ident" id="3939535">bottom28Bits</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3939549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3939552">top</span>&nbsp;<span class="op" id="3939556">=</span>&nbsp;<span class="ident" id="3939558">out</span><span class="op" id="3939561">[</span><span class="num" id="3939562">7</span><span class="op" id="3939563">]</span>&nbsp;<span class="op" id="3939565">&gt;&gt;</span>&nbsp;<span class="num" id="3939568">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3939572">out</span><span class="op" id="3939575">[</span><span class="num" id="3939576">7</span><span class="op" id="3939577">]</span>&nbsp;<span class="op" id="3939579">&amp;=</span>&nbsp;<span class="ident" id="3939582">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3939597">//&nbsp;Eliminate&nbsp;top&nbsp;while&nbsp;maintaining&nbsp;the&nbsp;same&nbsp;value&nbsp;mod&nbsp;p.</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3939655">out</span><span class="op" id="3939658">[</span><span class="num" id="3939659">0</span><span class="op" id="3939660">]</span>&nbsp;<span class="op" id="3939662">-=</span>&nbsp;<span class="ident" id="3939665">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3939670">out</span><span class="op" id="3939673">[</span><span class="num" id="3939674">3</span><span class="op" id="3939675">]</span>&nbsp;<span class="op" id="3939677">+=</span>&nbsp;<span class="ident" id="3939680">top</span>&nbsp;<span class="op" id="3939684">&lt;&lt;</span>&nbsp;<span class="num" id="3939687">12</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3939692">//&nbsp;There&nbsp;are&nbsp;two&nbsp;cases&nbsp;to&nbsp;consider&nbsp;for&nbsp;out[3]:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3939740">//&nbsp;&nbsp;&nbsp;1)&nbsp;The&nbsp;first&nbsp;time&nbsp;that&nbsp;we&nbsp;eliminated&nbsp;top,&nbsp;we&nbsp;didn&#39;t&nbsp;push&nbsp;out[3]&nbsp;over</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3939815">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2**28.&nbsp;In&nbsp;this&nbsp;case,&nbsp;the&nbsp;partial&nbsp;carry&nbsp;chain&nbsp;didn&#39;t&nbsp;change&nbsp;any&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3939894">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;top&nbsp;is&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3939920">//&nbsp;&nbsp;&nbsp;2)&nbsp;We&nbsp;did&nbsp;push&nbsp;out[3]&nbsp;over&nbsp;2**28&nbsp;the&nbsp;first&nbsp;time&nbsp;that&nbsp;we&nbsp;eliminated&nbsp;top.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3939998">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;first&nbsp;value&nbsp;of&nbsp;top&nbsp;was&nbsp;in&nbsp;[0..16),&nbsp;therefore,&nbsp;prior&nbsp;to&nbsp;eliminating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3940078">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;first&nbsp;top,&nbsp;0xfff1000&nbsp;&lt;=&nbsp;out[3]&nbsp;&lt;=&nbsp;0xfffffff.&nbsp;Therefore,&nbsp;after</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3940153">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overflowing&nbsp;and&nbsp;being&nbsp;reduced&nbsp;by&nbsp;the&nbsp;second&nbsp;carry&nbsp;chain,&nbsp;out[3]&nbsp;&lt;=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3940229">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xf000.&nbsp;Thus&nbsp;it&nbsp;cannot&nbsp;have&nbsp;overflowed&nbsp;when&nbsp;we&nbsp;eliminated&nbsp;top&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3940308">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3940331">//&nbsp;Again,&nbsp;we&nbsp;may&nbsp;just&nbsp;have&nbsp;made&nbsp;out[0]&nbsp;negative,&nbsp;so&nbsp;do&nbsp;the&nbsp;same&nbsp;carry&nbsp;down.</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3940408">//&nbsp;As&nbsp;before,&nbsp;if&nbsp;we&nbsp;made&nbsp;out[0]&nbsp;negative&nbsp;then&nbsp;we&nbsp;know&nbsp;that&nbsp;out[3]&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3940478">//&nbsp;sufficiently&nbsp;positive.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3940505">for</span>&nbsp;<span class="ident" id="3940509">i</span>&nbsp;<span class="op" id="3940511">:=</span>&nbsp;<span class="num" id="3940514">0</span><span class="op" id="3940515">;</span>&nbsp;<span class="ident" id="3940517">i</span>&nbsp;<span class="op" id="3940519">&lt;</span>&nbsp;<span class="num" id="3940521">3</span><span class="op" id="3940522">;</span>&nbsp;<span class="ident" id="3940524">i</span><span class="op" id="3940525">++</span>&nbsp;<span class="op" id="3940528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3940532">mask</span>&nbsp;<span class="op" id="3940537">:=</span>&nbsp;<span class="builtintype" id="3940540">uint32</span><span class="op" id="3940546">(</span><span class="builtintype" id="3940547">int32</span><span class="op" id="3940552">(</span><span class="ident" id="3940553">out</span><span class="op" id="3940556">[</span><span class="ident" id="3940557">i</span><span class="op" id="3940558">]</span><span class="op" id="3940559">)</span>&nbsp;<span class="op" id="3940561">&gt;&gt;</span>&nbsp;<span class="num" id="3940564">31</span><span class="op" id="3940566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3940570">out</span><span class="op" id="3940573">[</span><span class="ident" id="3940574">i</span><span class="op" id="3940575">]</span>&nbsp;<span class="op" id="3940577">+=</span>&nbsp;<span class="op" id="3940580">(</span><span class="num" id="3940581">1</span>&nbsp;<span class="op" id="3940583">&lt;&lt;</span>&nbsp;<span class="num" id="3940586">28</span><span class="op" id="3940588">)</span>&nbsp;<span class="op" id="3940590">&amp;</span>&nbsp;<span class="ident" id="3940592">mask</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3940599">out</span><span class="op" id="3940602">[</span><span class="ident" id="3940603">i</span><span class="op" id="3940604">+</span><span class="num" id="3940605">1</span><span class="op" id="3940606">]</span>&nbsp;<span class="op" id="3940608">-=</span>&nbsp;<span class="num" id="3940611">1</span>&nbsp;<span class="op" id="3940613">&amp;</span>&nbsp;<span class="ident" id="3940615">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3940621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3940625">//&nbsp;Now&nbsp;we&nbsp;see&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p&nbsp;and,&nbsp;if&nbsp;so,&nbsp;subtract&nbsp;p.</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3940686">//&nbsp;First&nbsp;we&nbsp;build&nbsp;a&nbsp;mask&nbsp;from&nbsp;the&nbsp;top&nbsp;four&nbsp;limbs,&nbsp;which&nbsp;must&nbsp;all&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3940755">//&nbsp;equal&nbsp;to&nbsp;bottom28Bits&nbsp;if&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p.&nbsp;If&nbsp;top4AllOnes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3940824">//&nbsp;ends&nbsp;up&nbsp;with&nbsp;any&nbsp;zero&nbsp;bits&nbsp;in&nbsp;the&nbsp;bottom&nbsp;28&nbsp;bits,&nbsp;then&nbsp;this&nbsp;wasn&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3940895">//&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3940905">top4AllOnes</span>&nbsp;<span class="op" id="3940917">:=</span>&nbsp;<span class="builtintype" id="3940920">uint32</span><span class="op" id="3940926">(</span><span class="num" id="3940927">0xffffffff</span><span class="op" id="3940937">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3940940">for</span>&nbsp;<span class="ident" id="3940944">i</span>&nbsp;<span class="op" id="3940946">:=</span>&nbsp;<span class="num" id="3940949">4</span><span class="op" id="3940950">;</span>&nbsp;<span class="ident" id="3940952">i</span>&nbsp;<span class="op" id="3940954">&lt;</span>&nbsp;<span class="num" id="3940956">8</span><span class="op" id="3940957">;</span>&nbsp;<span class="ident" id="3940959">i</span><span class="op" id="3940960">++</span>&nbsp;<span class="op" id="3940963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3940967">top4AllOnes</span>&nbsp;<span class="op" id="3940979">&amp;=</span>&nbsp;<span class="ident" id="3940982">out</span><span class="op" id="3940985">[</span><span class="ident" id="3940986">i</span><span class="op" id="3940987">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3940990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3940993">top4AllOnes</span>&nbsp;<span class="op" id="3941005">|=</span>&nbsp;<span class="num" id="3941008">0xf0000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3941020">//&nbsp;Now&nbsp;we&nbsp;replicate&nbsp;any&nbsp;zero&nbsp;bits&nbsp;to&nbsp;all&nbsp;the&nbsp;bits&nbsp;in&nbsp;top4AllOnes.</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3941087">top4AllOnes</span>&nbsp;<span class="op" id="3941099">&amp;=</span>&nbsp;<span class="ident" id="3941102">top4AllOnes</span>&nbsp;<span class="op" id="3941114">&gt;&gt;</span>&nbsp;<span class="num" id="3941117">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3941121">top4AllOnes</span>&nbsp;<span class="op" id="3941133">&amp;=</span>&nbsp;<span class="ident" id="3941136">top4AllOnes</span>&nbsp;<span class="op" id="3941148">&gt;&gt;</span>&nbsp;<span class="num" id="3941151">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3941154">top4AllOnes</span>&nbsp;<span class="op" id="3941166">&amp;=</span>&nbsp;<span class="ident" id="3941169">top4AllOnes</span>&nbsp;<span class="op" id="3941181">&gt;&gt;</span>&nbsp;<span class="num" id="3941184">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3941187">top4AllOnes</span>&nbsp;<span class="op" id="3941199">&amp;=</span>&nbsp;<span class="ident" id="3941202">top4AllOnes</span>&nbsp;<span class="op" id="3941214">&gt;&gt;</span>&nbsp;<span class="num" id="3941217">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3941220">top4AllOnes</span>&nbsp;<span class="op" id="3941232">&amp;=</span>&nbsp;<span class="ident" id="3941235">top4AllOnes</span>&nbsp;<span class="op" id="3941247">&gt;&gt;</span>&nbsp;<span class="num" id="3941250">1</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3941253">top4AllOnes</span>&nbsp;<span class="op" id="3941265">=</span>&nbsp;<span class="builtintype" id="3941267">uint32</span><span class="op" id="3941273">(</span><span class="builtintype" id="3941274">int32</span><span class="op" id="3941279">(</span><span class="ident" id="3941280">top4AllOnes</span><span class="op" id="3941291">&lt;&lt;</span><span class="num" id="3941293">31</span><span class="op" id="3941295">)</span>&nbsp;<span class="op" id="3941297">&gt;&gt;</span>&nbsp;<span class="num" id="3941300">31</span><span class="op" id="3941302">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3941306">//&nbsp;Now&nbsp;we&nbsp;test&nbsp;whether&nbsp;the&nbsp;bottom&nbsp;three&nbsp;limbs&nbsp;are&nbsp;non-zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3941367">bottom3NonZero</span>&nbsp;<span class="op" id="3941382">:=</span>&nbsp;<span class="ident" id="3941385">out</span><span class="op" id="3941388">[</span><span class="num" id="3941389">0</span><span class="op" id="3941390">]</span>&nbsp;<span class="op" id="3941392">|</span>&nbsp;<span class="ident" id="3941394">out</span><span class="op" id="3941397">[</span><span class="num" id="3941398">1</span><span class="op" id="3941399">]</span>&nbsp;<span class="op" id="3941401">|</span>&nbsp;<span class="ident" id="3941403">out</span><span class="op" id="3941406">[</span><span class="num" id="3941407">2</span><span class="op" id="3941408">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3941411">bottom3NonZero</span>&nbsp;<span class="op" id="3941426">|=</span>&nbsp;<span class="ident" id="3941429">bottom3NonZero</span>&nbsp;<span class="op" id="3941444">&gt;&gt;</span>&nbsp;<span class="num" id="3941447">16</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3941451">bottom3NonZero</span>&nbsp;<span class="op" id="3941466">|=</span>&nbsp;<span class="ident" id="3941469">bottom3NonZero</span>&nbsp;<span class="op" id="3941484">&gt;&gt;</span>&nbsp;<span class="num" id="3941487">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3941490">bottom3NonZero</span>&nbsp;<span class="op" id="3941505">|=</span>&nbsp;<span class="ident" id="3941508">bottom3NonZero</span>&nbsp;<span class="op" id="3941523">&gt;&gt;</span>&nbsp;<span class="num" id="3941526">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3941529">bottom3NonZero</span>&nbsp;<span class="op" id="3941544">|=</span>&nbsp;<span class="ident" id="3941547">bottom3NonZero</span>&nbsp;<span class="op" id="3941562">&gt;&gt;</span>&nbsp;<span class="num" id="3941565">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3941568">bottom3NonZero</span>&nbsp;<span class="op" id="3941583">|=</span>&nbsp;<span class="ident" id="3941586">bottom3NonZero</span>&nbsp;<span class="op" id="3941601">&gt;&gt;</span>&nbsp;<span class="num" id="3941604">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3941607">bottom3NonZero</span>&nbsp;<span class="op" id="3941622">=</span>&nbsp;<span class="builtintype" id="3941624">uint32</span><span class="op" id="3941630">(</span><span class="builtintype" id="3941631">int32</span><span class="op" id="3941636">(</span><span class="ident" id="3941637">bottom3NonZero</span><span class="op" id="3941651">&lt;&lt;</span><span class="num" id="3941653">31</span><span class="op" id="3941655">)</span>&nbsp;<span class="op" id="3941657">&gt;&gt;</span>&nbsp;<span class="num" id="3941660">31</span><span class="op" id="3941662">)</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3941666">//&nbsp;Everything&nbsp;depends&nbsp;on&nbsp;the&nbsp;value&nbsp;of&nbsp;out[3].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3941713">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;&gt;&nbsp;0xffff000&nbsp;and&nbsp;top4AllOnes&nbsp;!=&nbsp;0&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3941790">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;=&nbsp;0xffff000&nbsp;and&nbsp;top4AllOnes&nbsp;!=&nbsp;0&nbsp;and&nbsp;bottom3NonZero&nbsp;!=&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3941863">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3941901">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;&lt;&nbsp;0xffff000,&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&lt;&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3941957">n</span>&nbsp;<span class="op" id="3941959">:=</span>&nbsp;<span class="ident" id="3941962">out</span><span class="op" id="3941965">[</span><span class="num" id="3941966">3</span><span class="op" id="3941967">]</span>&nbsp;<span class="op" id="3941969">-</span>&nbsp;<span class="num" id="3941971">0xffff000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3941982">out3Equal</span>&nbsp;<span class="op" id="3941992">:=</span>&nbsp;<span class="ident" id="3941995">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3941998">out3Equal</span>&nbsp;<span class="op" id="3942008">|=</span>&nbsp;<span class="ident" id="3942011">out3Equal</span>&nbsp;<span class="op" id="3942021">&gt;&gt;</span>&nbsp;<span class="num" id="3942024">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3942028">out3Equal</span>&nbsp;<span class="op" id="3942038">|=</span>&nbsp;<span class="ident" id="3942041">out3Equal</span>&nbsp;<span class="op" id="3942051">&gt;&gt;</span>&nbsp;<span class="num" id="3942054">8</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3942057">out3Equal</span>&nbsp;<span class="op" id="3942067">|=</span>&nbsp;<span class="ident" id="3942070">out3Equal</span>&nbsp;<span class="op" id="3942080">&gt;&gt;</span>&nbsp;<span class="num" id="3942083">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3942086">out3Equal</span>&nbsp;<span class="op" id="3942096">|=</span>&nbsp;<span class="ident" id="3942099">out3Equal</span>&nbsp;<span class="op" id="3942109">&gt;&gt;</span>&nbsp;<span class="num" id="3942112">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3942115">out3Equal</span>&nbsp;<span class="op" id="3942125">|=</span>&nbsp;<span class="ident" id="3942128">out3Equal</span>&nbsp;<span class="op" id="3942138">&gt;&gt;</span>&nbsp;<span class="num" id="3942141">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3942144">out3Equal</span>&nbsp;<span class="op" id="3942154">=</span>&nbsp;<span class="op" id="3942156">^</span><span class="builtintype" id="3942157">uint32</span><span class="op" id="3942163">(</span><span class="builtintype" id="3942164">int32</span><span class="op" id="3942169">(</span><span class="ident" id="3942170">out3Equal</span><span class="op" id="3942179">&lt;&lt;</span><span class="num" id="3942181">31</span><span class="op" id="3942183">)</span>&nbsp;<span class="op" id="3942185">&gt;&gt;</span>&nbsp;<span class="num" id="3942188">31</span><span class="op" id="3942190">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3942194">//&nbsp;If&nbsp;out[3]&nbsp;&gt;&nbsp;0xffff000&nbsp;then&nbsp;n&#39;s&nbsp;MSB&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3942247">out3GT</span>&nbsp;<span class="op" id="3942254">:=</span>&nbsp;<span class="op" id="3942257">^</span><span class="builtintype" id="3942258">uint32</span><span class="op" id="3942264">(</span><span class="builtintype" id="3942265">int32</span><span class="op" id="3942270">(</span><span class="ident" id="3942271">n</span><span class="op" id="3942272">)</span>&nbsp;<span class="op" id="3942274">&gt;&gt;</span>&nbsp;<span class="num" id="3942277">31</span><span class="op" id="3942279">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3942283">mask</span>&nbsp;<span class="op" id="3942288">:=</span>&nbsp;<span class="ident" id="3942291">top4AllOnes</span>&nbsp;<span class="op" id="3942303">&amp;</span>&nbsp;<span class="op" id="3942305">(</span><span class="op" id="3942306">(</span><span class="ident" id="3942307">out3Equal</span>&nbsp;<span class="op" id="3942317">&amp;</span>&nbsp;<span class="ident" id="3942319">bottom3NonZero</span><span class="op" id="3942333">)</span>&nbsp;<span class="op" id="3942335">|</span>&nbsp;<span class="ident" id="3942337">out3GT</span><span class="op" id="3942343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3942346">out</span><span class="op" id="3942349">[</span><span class="num" id="3942350">0</span><span class="op" id="3942351">]</span>&nbsp;<span class="op" id="3942353">-=</span>&nbsp;<span class="num" id="3942356">1</span>&nbsp;<span class="op" id="3942358">&amp;</span>&nbsp;<span class="ident" id="3942360">mask</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3942366">out</span><span class="op" id="3942369">[</span><span class="num" id="3942370">3</span><span class="op" id="3942371">]</span>&nbsp;<span class="op" id="3942373">-=</span>&nbsp;<span class="num" id="3942376">0xffff000</span>&nbsp;<span class="op" id="3942386">&amp;</span>&nbsp;<span class="ident" id="3942388">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3942394">out</span><span class="op" id="3942397">[</span><span class="num" id="3942398">4</span><span class="op" id="3942399">]</span>&nbsp;<span class="op" id="3942401">-=</span>&nbsp;<span class="num" id="3942404">0xfffffff</span>&nbsp;<span class="op" id="3942414">&amp;</span>&nbsp;<span class="ident" id="3942416">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3942422">out</span><span class="op" id="3942425">[</span><span class="num" id="3942426">5</span><span class="op" id="3942427">]</span>&nbsp;<span class="op" id="3942429">-=</span>&nbsp;<span class="num" id="3942432">0xfffffff</span>&nbsp;<span class="op" id="3942442">&amp;</span>&nbsp;<span class="ident" id="3942444">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3942450">out</span><span class="op" id="3942453">[</span><span class="num" id="3942454">6</span><span class="op" id="3942455">]</span>&nbsp;<span class="op" id="3942457">-=</span>&nbsp;<span class="num" id="3942460">0xfffffff</span>&nbsp;<span class="op" id="3942470">&amp;</span>&nbsp;<span class="ident" id="3942472">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3942478">out</span><span class="op" id="3942481">[</span><span class="num" id="3942482">7</span><span class="op" id="3942483">]</span>&nbsp;<span class="op" id="3942485">-=</span>&nbsp;<span class="num" id="3942488">0xfffffff</span>&nbsp;<span class="op" id="3942498">&amp;</span>&nbsp;<span class="ident" id="3942500">mask</span><br>
<span class="lineno">495</span><span class="op" id="3942505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3942508">//&nbsp;Group&nbsp;element&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="3942536">//</span><br>
<span class="lineno"></span><span class="comment" id="3942539">//&nbsp;These&nbsp;functions&nbsp;deal&nbsp;with&nbsp;group&nbsp;elements.&nbsp;The&nbsp;group&nbsp;is&nbsp;an&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno">500</span><span class="comment" id="3942615">//&nbsp;group&nbsp;with&nbsp;a&nbsp;=&nbsp;-3&nbsp;defined&nbsp;in&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3942675">//&nbsp;p224AddJacobian&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+b&nbsp;where&nbsp;a&nbsp;!=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3942728">func</span>&nbsp;<span class="ident" id="3942733">p224AddJacobian</span><span class="op" id="3942748">(</span><span class="ident" id="3942749">x3</span><span class="op" id="3942751">,</span>&nbsp;<span class="ident" id="3942753">y3</span><span class="op" id="3942755">,</span>&nbsp;<span class="ident" id="3942757">z3</span><span class="op" id="3942759">,</span>&nbsp;<span class="ident" id="3942761">x1</span><span class="op" id="3942763">,</span>&nbsp;<span class="ident" id="3942765">y1</span><span class="op" id="3942767">,</span>&nbsp;<span class="ident" id="3942769">z1</span><span class="op" id="3942771">,</span>&nbsp;<span class="ident" id="3942773">x2</span><span class="op" id="3942775">,</span>&nbsp;<span class="ident" id="3942777">y2</span><span class="op" id="3942779">,</span>&nbsp;<span class="ident" id="3942781">z2</span>&nbsp;<span class="op" id="3942784">*</span><span class="ident" id="3942785">p224FieldElement</span><span class="op" id="3942801">)</span>&nbsp;<span class="op" id="3942803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3942806">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-p224Add-2007-bl</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3942900">var</span>&nbsp;<span class="ident" id="3942904">z1z1</span><span class="op" id="3942908">,</span>&nbsp;<span class="ident" id="3942910">z2z2</span><span class="op" id="3942914">,</span>&nbsp;<span class="ident" id="3942916">u1</span><span class="op" id="3942918">,</span>&nbsp;<span class="ident" id="3942920">u2</span><span class="op" id="3942922">,</span>&nbsp;<span class="ident" id="3942924">s1</span><span class="op" id="3942926">,</span>&nbsp;<span class="ident" id="3942928">s2</span><span class="op" id="3942930">,</span>&nbsp;<span class="ident" id="3942932">h</span><span class="op" id="3942933">,</span>&nbsp;<span class="ident" id="3942935">i</span><span class="op" id="3942936">,</span>&nbsp;<span class="ident" id="3942938">j</span><span class="op" id="3942939">,</span>&nbsp;<span class="ident" id="3942941">r</span><span class="op" id="3942942">,</span>&nbsp;<span class="ident" id="3942944">v</span>&nbsp;<span class="ident" id="3942946">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3942964">var</span>&nbsp;<span class="ident" id="3942968">c</span>&nbsp;<span class="ident" id="3942970">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3942994">z1IsZero</span>&nbsp;<span class="op" id="3943003">:=</span>&nbsp;<span class="ident" id="3943006">p224IsZero</span><span class="op" id="3943016">(</span><span class="ident" id="3943017">z1</span><span class="op" id="3943019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943022">z2IsZero</span>&nbsp;<span class="op" id="3943031">:=</span>&nbsp;<span class="ident" id="3943034">p224IsZero</span><span class="op" id="3943044">(</span><span class="ident" id="3943045">z2</span><span class="op" id="3943047">)</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3943051">//&nbsp;Z1Z1&nbsp;=&nbsp;Z1²</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943067">p224Square</span><span class="op" id="3943077">(</span><span class="op" id="3943078">&amp;</span><span class="ident" id="3943079">z1z1</span><span class="op" id="3943083">,</span>&nbsp;<span class="ident" id="3943085">z1</span><span class="op" id="3943087">,</span>&nbsp;<span class="op" id="3943089">&amp;</span><span class="ident" id="3943090">c</span><span class="op" id="3943091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3943094">//&nbsp;Z2Z2&nbsp;=&nbsp;Z2²</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943110">p224Square</span><span class="op" id="3943120">(</span><span class="op" id="3943121">&amp;</span><span class="ident" id="3943122">z2z2</span><span class="op" id="3943126">,</span>&nbsp;<span class="ident" id="3943128">z2</span><span class="op" id="3943130">,</span>&nbsp;<span class="op" id="3943132">&amp;</span><span class="ident" id="3943133">c</span><span class="op" id="3943134">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3943137">//&nbsp;U1&nbsp;=&nbsp;X1*Z2Z2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943154">p224Mul</span><span class="op" id="3943161">(</span><span class="op" id="3943162">&amp;</span><span class="ident" id="3943163">u1</span><span class="op" id="3943165">,</span>&nbsp;<span class="ident" id="3943167">x1</span><span class="op" id="3943169">,</span>&nbsp;<span class="op" id="3943171">&amp;</span><span class="ident" id="3943172">z2z2</span><span class="op" id="3943176">,</span>&nbsp;<span class="op" id="3943178">&amp;</span><span class="ident" id="3943179">c</span><span class="op" id="3943180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3943183">//&nbsp;U2&nbsp;=&nbsp;X2*Z1Z1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943200">p224Mul</span><span class="op" id="3943207">(</span><span class="op" id="3943208">&amp;</span><span class="ident" id="3943209">u2</span><span class="op" id="3943211">,</span>&nbsp;<span class="ident" id="3943213">x2</span><span class="op" id="3943215">,</span>&nbsp;<span class="op" id="3943217">&amp;</span><span class="ident" id="3943218">z1z1</span><span class="op" id="3943222">,</span>&nbsp;<span class="op" id="3943224">&amp;</span><span class="ident" id="3943225">c</span><span class="op" id="3943226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3943229">//&nbsp;S1&nbsp;=&nbsp;Y1*Z2*Z2Z2</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943249">p224Mul</span><span class="op" id="3943256">(</span><span class="op" id="3943257">&amp;</span><span class="ident" id="3943258">s1</span><span class="op" id="3943260">,</span>&nbsp;<span class="ident" id="3943262">z2</span><span class="op" id="3943264">,</span>&nbsp;<span class="op" id="3943266">&amp;</span><span class="ident" id="3943267">z2z2</span><span class="op" id="3943271">,</span>&nbsp;<span class="op" id="3943273">&amp;</span><span class="ident" id="3943274">c</span><span class="op" id="3943275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943278">p224Mul</span><span class="op" id="3943285">(</span><span class="op" id="3943286">&amp;</span><span class="ident" id="3943287">s1</span><span class="op" id="3943289">,</span>&nbsp;<span class="ident" id="3943291">y1</span><span class="op" id="3943293">,</span>&nbsp;<span class="op" id="3943295">&amp;</span><span class="ident" id="3943296">s1</span><span class="op" id="3943298">,</span>&nbsp;<span class="op" id="3943300">&amp;</span><span class="ident" id="3943301">c</span><span class="op" id="3943302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3943305">//&nbsp;S2&nbsp;=&nbsp;Y2*Z1*Z1Z1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943325">p224Mul</span><span class="op" id="3943332">(</span><span class="op" id="3943333">&amp;</span><span class="ident" id="3943334">s2</span><span class="op" id="3943336">,</span>&nbsp;<span class="ident" id="3943338">z1</span><span class="op" id="3943340">,</span>&nbsp;<span class="op" id="3943342">&amp;</span><span class="ident" id="3943343">z1z1</span><span class="op" id="3943347">,</span>&nbsp;<span class="op" id="3943349">&amp;</span><span class="ident" id="3943350">c</span><span class="op" id="3943351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943354">p224Mul</span><span class="op" id="3943361">(</span><span class="op" id="3943362">&amp;</span><span class="ident" id="3943363">s2</span><span class="op" id="3943365">,</span>&nbsp;<span class="ident" id="3943367">y2</span><span class="op" id="3943369">,</span>&nbsp;<span class="op" id="3943371">&amp;</span><span class="ident" id="3943372">s2</span><span class="op" id="3943374">,</span>&nbsp;<span class="op" id="3943376">&amp;</span><span class="ident" id="3943377">c</span><span class="op" id="3943378">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3943381">//&nbsp;H&nbsp;=&nbsp;U2-U1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943395">p224Sub</span><span class="op" id="3943402">(</span><span class="op" id="3943403">&amp;</span><span class="ident" id="3943404">h</span><span class="op" id="3943405">,</span>&nbsp;<span class="op" id="3943407">&amp;</span><span class="ident" id="3943408">u2</span><span class="op" id="3943410">,</span>&nbsp;<span class="op" id="3943412">&amp;</span><span class="ident" id="3943413">u1</span><span class="op" id="3943415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943418">p224Reduce</span><span class="op" id="3943428">(</span><span class="op" id="3943429">&amp;</span><span class="ident" id="3943430">h</span><span class="op" id="3943431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943434">xEqual</span>&nbsp;<span class="op" id="3943441">:=</span>&nbsp;<span class="ident" id="3943444">p224IsZero</span><span class="op" id="3943454">(</span><span class="op" id="3943455">&amp;</span><span class="ident" id="3943456">h</span><span class="op" id="3943457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3943460">//&nbsp;I&nbsp;=&nbsp;(2*H)²</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3943476">for</span>&nbsp;<span class="ident" id="3943480">j</span>&nbsp;<span class="op" id="3943482">:=</span>&nbsp;<span class="num" id="3943485">0</span><span class="op" id="3943486">;</span>&nbsp;<span class="ident" id="3943488">j</span>&nbsp;<span class="op" id="3943490">&lt;</span>&nbsp;<span class="num" id="3943492">8</span><span class="op" id="3943493">;</span>&nbsp;<span class="ident" id="3943495">j</span><span class="op" id="3943496">++</span>&nbsp;<span class="op" id="3943499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943503">i</span><span class="op" id="3943504">[</span><span class="ident" id="3943505">j</span><span class="op" id="3943506">]</span>&nbsp;<span class="op" id="3943508">=</span>&nbsp;<span class="ident" id="3943510">h</span><span class="op" id="3943511">[</span><span class="ident" id="3943512">j</span><span class="op" id="3943513">]</span>&nbsp;<span class="op" id="3943515">&lt;&lt;</span>&nbsp;<span class="num" id="3943518">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3943521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943524">p224Reduce</span><span class="op" id="3943534">(</span><span class="op" id="3943535">&amp;</span><span class="ident" id="3943536">i</span><span class="op" id="3943537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943540">p224Square</span><span class="op" id="3943550">(</span><span class="op" id="3943551">&amp;</span><span class="ident" id="3943552">i</span><span class="op" id="3943553">,</span>&nbsp;<span class="op" id="3943555">&amp;</span><span class="ident" id="3943556">i</span><span class="op" id="3943557">,</span>&nbsp;<span class="op" id="3943559">&amp;</span><span class="ident" id="3943560">c</span><span class="op" id="3943561">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3943564">//&nbsp;J&nbsp;=&nbsp;H*I</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943576">p224Mul</span><span class="op" id="3943583">(</span><span class="op" id="3943584">&amp;</span><span class="ident" id="3943585">j</span><span class="op" id="3943586">,</span>&nbsp;<span class="op" id="3943588">&amp;</span><span class="ident" id="3943589">h</span><span class="op" id="3943590">,</span>&nbsp;<span class="op" id="3943592">&amp;</span><span class="ident" id="3943593">i</span><span class="op" id="3943594">,</span>&nbsp;<span class="op" id="3943596">&amp;</span><span class="ident" id="3943597">c</span><span class="op" id="3943598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3943601">//&nbsp;r&nbsp;=&nbsp;2*(S2-S1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943619">p224Sub</span><span class="op" id="3943626">(</span><span class="op" id="3943627">&amp;</span><span class="ident" id="3943628">r</span><span class="op" id="3943629">,</span>&nbsp;<span class="op" id="3943631">&amp;</span><span class="ident" id="3943632">s2</span><span class="op" id="3943634">,</span>&nbsp;<span class="op" id="3943636">&amp;</span><span class="ident" id="3943637">s1</span><span class="op" id="3943639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943642">p224Reduce</span><span class="op" id="3943652">(</span><span class="op" id="3943653">&amp;</span><span class="ident" id="3943654">r</span><span class="op" id="3943655">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943658">yEqual</span>&nbsp;<span class="op" id="3943665">:=</span>&nbsp;<span class="ident" id="3943668">p224IsZero</span><span class="op" id="3943678">(</span><span class="op" id="3943679">&amp;</span><span class="ident" id="3943680">r</span><span class="op" id="3943681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3943684">if</span>&nbsp;<span class="ident" id="3943687">xEqual</span>&nbsp;<span class="op" id="3943694">==</span>&nbsp;<span class="num" id="3943697">1</span>&nbsp;<span class="op" id="3943699">&amp;&amp;</span>&nbsp;<span class="ident" id="3943702">yEqual</span>&nbsp;<span class="op" id="3943709">==</span>&nbsp;<span class="num" id="3943712">1</span>&nbsp;<span class="op" id="3943714">&amp;&amp;</span>&nbsp;<span class="ident" id="3943717">z1IsZero</span>&nbsp;<span class="op" id="3943726">==</span>&nbsp;<span class="num" id="3943729">0</span>&nbsp;<span class="op" id="3943731">&amp;&amp;</span>&nbsp;<span class="ident" id="3943734">z2IsZero</span>&nbsp;<span class="op" id="3943743">==</span>&nbsp;<span class="num" id="3943746">0</span>&nbsp;<span class="op" id="3943748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943752">p224DoubleJacobian</span><span class="op" id="3943770">(</span><span class="ident" id="3943771">x3</span><span class="op" id="3943773">,</span>&nbsp;<span class="ident" id="3943775">y3</span><span class="op" id="3943777">,</span>&nbsp;<span class="ident" id="3943779">z3</span><span class="op" id="3943781">,</span>&nbsp;<span class="ident" id="3943783">x1</span><span class="op" id="3943785">,</span>&nbsp;<span class="ident" id="3943787">y1</span><span class="op" id="3943789">,</span>&nbsp;<span class="ident" id="3943791">z1</span><span class="op" id="3943793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3943797">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3943805">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3943808">for</span>&nbsp;<span class="ident" id="3943812">i</span>&nbsp;<span class="op" id="3943814">:=</span>&nbsp;<span class="num" id="3943817">0</span><span class="op" id="3943818">;</span>&nbsp;<span class="ident" id="3943820">i</span>&nbsp;<span class="op" id="3943822">&lt;</span>&nbsp;<span class="num" id="3943824">8</span><span class="op" id="3943825">;</span>&nbsp;<span class="ident" id="3943827">i</span><span class="op" id="3943828">++</span>&nbsp;<span class="op" id="3943831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943835">r</span><span class="op" id="3943836">[</span><span class="ident" id="3943837">i</span><span class="op" id="3943838">]</span>&nbsp;<span class="op" id="3943840">&lt;&lt;=</span>&nbsp;<span class="num" id="3943844">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3943847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943850">p224Reduce</span><span class="op" id="3943860">(</span><span class="op" id="3943861">&amp;</span><span class="ident" id="3943862">r</span><span class="op" id="3943863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3943866">//&nbsp;V&nbsp;=&nbsp;U1*I</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943879">p224Mul</span><span class="op" id="3943886">(</span><span class="op" id="3943887">&amp;</span><span class="ident" id="3943888">v</span><span class="op" id="3943889">,</span>&nbsp;<span class="op" id="3943891">&amp;</span><span class="ident" id="3943892">u1</span><span class="op" id="3943894">,</span>&nbsp;<span class="op" id="3943896">&amp;</span><span class="ident" id="3943897">i</span><span class="op" id="3943898">,</span>&nbsp;<span class="op" id="3943900">&amp;</span><span class="ident" id="3943901">c</span><span class="op" id="3943902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3943905">//&nbsp;Z3&nbsp;=&nbsp;((Z1+Z2)²-Z1Z1-Z2Z2)*H</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943938">p224Add</span><span class="op" id="3943945">(</span><span class="op" id="3943946">&amp;</span><span class="ident" id="3943947">z1z1</span><span class="op" id="3943951">,</span>&nbsp;<span class="op" id="3943953">&amp;</span><span class="ident" id="3943954">z1z1</span><span class="op" id="3943958">,</span>&nbsp;<span class="op" id="3943960">&amp;</span><span class="ident" id="3943961">z2z2</span><span class="op" id="3943965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943968">p224Add</span><span class="op" id="3943975">(</span><span class="op" id="3943976">&amp;</span><span class="ident" id="3943977">z2z2</span><span class="op" id="3943981">,</span>&nbsp;<span class="ident" id="3943983">z1</span><span class="op" id="3943985">,</span>&nbsp;<span class="ident" id="3943987">z2</span><span class="op" id="3943989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3943992">p224Reduce</span><span class="op" id="3944002">(</span><span class="op" id="3944003">&amp;</span><span class="ident" id="3944004">z2z2</span><span class="op" id="3944008">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944011">p224Square</span><span class="op" id="3944021">(</span><span class="op" id="3944022">&amp;</span><span class="ident" id="3944023">z2z2</span><span class="op" id="3944027">,</span>&nbsp;<span class="op" id="3944029">&amp;</span><span class="ident" id="3944030">z2z2</span><span class="op" id="3944034">,</span>&nbsp;<span class="op" id="3944036">&amp;</span><span class="ident" id="3944037">c</span><span class="op" id="3944038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944041">p224Sub</span><span class="op" id="3944048">(</span><span class="ident" id="3944049">z3</span><span class="op" id="3944051">,</span>&nbsp;<span class="op" id="3944053">&amp;</span><span class="ident" id="3944054">z2z2</span><span class="op" id="3944058">,</span>&nbsp;<span class="op" id="3944060">&amp;</span><span class="ident" id="3944061">z1z1</span><span class="op" id="3944065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944068">p224Reduce</span><span class="op" id="3944078">(</span><span class="ident" id="3944079">z3</span><span class="op" id="3944081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944084">p224Mul</span><span class="op" id="3944091">(</span><span class="ident" id="3944092">z3</span><span class="op" id="3944094">,</span>&nbsp;<span class="ident" id="3944096">z3</span><span class="op" id="3944098">,</span>&nbsp;<span class="op" id="3944100">&amp;</span><span class="ident" id="3944101">h</span><span class="op" id="3944102">,</span>&nbsp;<span class="op" id="3944104">&amp;</span><span class="ident" id="3944105">c</span><span class="op" id="3944106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3944109">//&nbsp;X3&nbsp;=&nbsp;r²-J-2*V</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3944128">for</span>&nbsp;<span class="ident" id="3944132">i</span>&nbsp;<span class="op" id="3944134">:=</span>&nbsp;<span class="num" id="3944137">0</span><span class="op" id="3944138">;</span>&nbsp;<span class="ident" id="3944140">i</span>&nbsp;<span class="op" id="3944142">&lt;</span>&nbsp;<span class="num" id="3944144">8</span><span class="op" id="3944145">;</span>&nbsp;<span class="ident" id="3944147">i</span><span class="op" id="3944148">++</span>&nbsp;<span class="op" id="3944151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944155">z1z1</span><span class="op" id="3944159">[</span><span class="ident" id="3944160">i</span><span class="op" id="3944161">]</span>&nbsp;<span class="op" id="3944163">=</span>&nbsp;<span class="ident" id="3944165">v</span><span class="op" id="3944166">[</span><span class="ident" id="3944167">i</span><span class="op" id="3944168">]</span>&nbsp;<span class="op" id="3944170">&lt;&lt;</span>&nbsp;<span class="num" id="3944173">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3944176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944179">p224Add</span><span class="op" id="3944186">(</span><span class="op" id="3944187">&amp;</span><span class="ident" id="3944188">z1z1</span><span class="op" id="3944192">,</span>&nbsp;<span class="op" id="3944194">&amp;</span><span class="ident" id="3944195">j</span><span class="op" id="3944196">,</span>&nbsp;<span class="op" id="3944198">&amp;</span><span class="ident" id="3944199">z1z1</span><span class="op" id="3944203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944206">p224Reduce</span><span class="op" id="3944216">(</span><span class="op" id="3944217">&amp;</span><span class="ident" id="3944218">z1z1</span><span class="op" id="3944222">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944225">p224Square</span><span class="op" id="3944235">(</span><span class="ident" id="3944236">x3</span><span class="op" id="3944238">,</span>&nbsp;<span class="op" id="3944240">&amp;</span><span class="ident" id="3944241">r</span><span class="op" id="3944242">,</span>&nbsp;<span class="op" id="3944244">&amp;</span><span class="ident" id="3944245">c</span><span class="op" id="3944246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944249">p224Sub</span><span class="op" id="3944256">(</span><span class="ident" id="3944257">x3</span><span class="op" id="3944259">,</span>&nbsp;<span class="ident" id="3944261">x3</span><span class="op" id="3944263">,</span>&nbsp;<span class="op" id="3944265">&amp;</span><span class="ident" id="3944266">z1z1</span><span class="op" id="3944270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944273">p224Reduce</span><span class="op" id="3944283">(</span><span class="ident" id="3944284">x3</span><span class="op" id="3944286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3944289">//&nbsp;Y3&nbsp;=&nbsp;r*(V-X3)-2*S1*J</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3944314">for</span>&nbsp;<span class="ident" id="3944318">i</span>&nbsp;<span class="op" id="3944320">:=</span>&nbsp;<span class="num" id="3944323">0</span><span class="op" id="3944324">;</span>&nbsp;<span class="ident" id="3944326">i</span>&nbsp;<span class="op" id="3944328">&lt;</span>&nbsp;<span class="num" id="3944330">8</span><span class="op" id="3944331">;</span>&nbsp;<span class="ident" id="3944333">i</span><span class="op" id="3944334">++</span>&nbsp;<span class="op" id="3944337">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944341">s1</span><span class="op" id="3944343">[</span><span class="ident" id="3944344">i</span><span class="op" id="3944345">]</span>&nbsp;<span class="op" id="3944347">&lt;&lt;=</span>&nbsp;<span class="num" id="3944351">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3944354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944357">p224Mul</span><span class="op" id="3944364">(</span><span class="op" id="3944365">&amp;</span><span class="ident" id="3944366">s1</span><span class="op" id="3944368">,</span>&nbsp;<span class="op" id="3944370">&amp;</span><span class="ident" id="3944371">s1</span><span class="op" id="3944373">,</span>&nbsp;<span class="op" id="3944375">&amp;</span><span class="ident" id="3944376">j</span><span class="op" id="3944377">,</span>&nbsp;<span class="op" id="3944379">&amp;</span><span class="ident" id="3944380">c</span><span class="op" id="3944381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944384">p224Sub</span><span class="op" id="3944391">(</span><span class="op" id="3944392">&amp;</span><span class="ident" id="3944393">z1z1</span><span class="op" id="3944397">,</span>&nbsp;<span class="op" id="3944399">&amp;</span><span class="ident" id="3944400">v</span><span class="op" id="3944401">,</span>&nbsp;<span class="ident" id="3944403">x3</span><span class="op" id="3944405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944408">p224Reduce</span><span class="op" id="3944418">(</span><span class="op" id="3944419">&amp;</span><span class="ident" id="3944420">z1z1</span><span class="op" id="3944424">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944427">p224Mul</span><span class="op" id="3944434">(</span><span class="op" id="3944435">&amp;</span><span class="ident" id="3944436">z1z1</span><span class="op" id="3944440">,</span>&nbsp;<span class="op" id="3944442">&amp;</span><span class="ident" id="3944443">z1z1</span><span class="op" id="3944447">,</span>&nbsp;<span class="op" id="3944449">&amp;</span><span class="ident" id="3944450">r</span><span class="op" id="3944451">,</span>&nbsp;<span class="op" id="3944453">&amp;</span><span class="ident" id="3944454">c</span><span class="op" id="3944455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944458">p224Sub</span><span class="op" id="3944465">(</span><span class="ident" id="3944466">y3</span><span class="op" id="3944468">,</span>&nbsp;<span class="op" id="3944470">&amp;</span><span class="ident" id="3944471">z1z1</span><span class="op" id="3944475">,</span>&nbsp;<span class="op" id="3944477">&amp;</span><span class="ident" id="3944478">s1</span><span class="op" id="3944480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944483">p224Reduce</span><span class="op" id="3944493">(</span><span class="ident" id="3944494">y3</span><span class="op" id="3944496">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944500">p224CopyConditional</span><span class="op" id="3944519">(</span><span class="ident" id="3944520">x3</span><span class="op" id="3944522">,</span>&nbsp;<span class="ident" id="3944524">x2</span><span class="op" id="3944526">,</span>&nbsp;<span class="ident" id="3944528">z1IsZero</span><span class="op" id="3944536">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944539">p224CopyConditional</span><span class="op" id="3944558">(</span><span class="ident" id="3944559">x3</span><span class="op" id="3944561">,</span>&nbsp;<span class="ident" id="3944563">x1</span><span class="op" id="3944565">,</span>&nbsp;<span class="ident" id="3944567">z2IsZero</span><span class="op" id="3944575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944578">p224CopyConditional</span><span class="op" id="3944597">(</span><span class="ident" id="3944598">y3</span><span class="op" id="3944600">,</span>&nbsp;<span class="ident" id="3944602">y2</span><span class="op" id="3944604">,</span>&nbsp;<span class="ident" id="3944606">z1IsZero</span><span class="op" id="3944614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944617">p224CopyConditional</span><span class="op" id="3944636">(</span><span class="ident" id="3944637">y3</span><span class="op" id="3944639">,</span>&nbsp;<span class="ident" id="3944641">y1</span><span class="op" id="3944643">,</span>&nbsp;<span class="ident" id="3944645">z2IsZero</span><span class="op" id="3944653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944656">p224CopyConditional</span><span class="op" id="3944675">(</span><span class="ident" id="3944676">z3</span><span class="op" id="3944678">,</span>&nbsp;<span class="ident" id="3944680">z2</span><span class="op" id="3944682">,</span>&nbsp;<span class="ident" id="3944684">z1IsZero</span><span class="op" id="3944692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944695">p224CopyConditional</span><span class="op" id="3944714">(</span><span class="ident" id="3944715">z3</span><span class="op" id="3944717">,</span>&nbsp;<span class="ident" id="3944719">z1</span><span class="op" id="3944721">,</span>&nbsp;<span class="ident" id="3944723">z2IsZero</span><span class="op" id="3944731">)</span><br>
<span class="lineno">585</span><span class="op" id="3944733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3944736">//&nbsp;p224DoubleJacobian&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+a.</span><br>
<span class="lineno"></span><span class="keyword" id="3944779">func</span>&nbsp;<span class="ident" id="3944784">p224DoubleJacobian</span><span class="op" id="3944802">(</span><span class="ident" id="3944803">x3</span><span class="op" id="3944805">,</span>&nbsp;<span class="ident" id="3944807">y3</span><span class="op" id="3944809">,</span>&nbsp;<span class="ident" id="3944811">z3</span><span class="op" id="3944813">,</span>&nbsp;<span class="ident" id="3944815">x1</span><span class="op" id="3944817">,</span>&nbsp;<span class="ident" id="3944819">y1</span><span class="op" id="3944821">,</span>&nbsp;<span class="ident" id="3944823">z1</span>&nbsp;<span class="op" id="3944826">*</span><span class="ident" id="3944827">p224FieldElement</span><span class="op" id="3944843">)</span>&nbsp;<span class="op" id="3944845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3944848">var</span>&nbsp;<span class="ident" id="3944852">delta</span><span class="op" id="3944857">,</span>&nbsp;<span class="ident" id="3944859">gamma</span><span class="op" id="3944864">,</span>&nbsp;<span class="ident" id="3944866">beta</span><span class="op" id="3944870">,</span>&nbsp;<span class="ident" id="3944872">alpha</span><span class="op" id="3944877">,</span>&nbsp;<span class="ident" id="3944879">t</span>&nbsp;<span class="ident" id="3944881">p224FieldElement</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3944899">var</span>&nbsp;<span class="ident" id="3944903">c</span>&nbsp;<span class="ident" id="3944905">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944929">p224Square</span><span class="op" id="3944939">(</span><span class="op" id="3944940">&amp;</span><span class="ident" id="3944941">delta</span><span class="op" id="3944946">,</span>&nbsp;<span class="ident" id="3944948">z1</span><span class="op" id="3944950">,</span>&nbsp;<span class="op" id="3944952">&amp;</span><span class="ident" id="3944953">c</span><span class="op" id="3944954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944957">p224Square</span><span class="op" id="3944967">(</span><span class="op" id="3944968">&amp;</span><span class="ident" id="3944969">gamma</span><span class="op" id="3944974">,</span>&nbsp;<span class="ident" id="3944976">y1</span><span class="op" id="3944978">,</span>&nbsp;<span class="op" id="3944980">&amp;</span><span class="ident" id="3944981">c</span><span class="op" id="3944982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944985">p224Mul</span><span class="op" id="3944992">(</span><span class="op" id="3944993">&amp;</span><span class="ident" id="3944994">beta</span><span class="op" id="3944998">,</span>&nbsp;<span class="ident" id="3945000">x1</span><span class="op" id="3945002">,</span>&nbsp;<span class="op" id="3945004">&amp;</span><span class="ident" id="3945005">gamma</span><span class="op" id="3945010">,</span>&nbsp;<span class="op" id="3945012">&amp;</span><span class="ident" id="3945013">c</span><span class="op" id="3945014">)</span><br>
<span class="lineno">595</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3945018">//&nbsp;alpha&nbsp;=&nbsp;3*(X1-delta)*(X1+delta)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945054">p224Add</span><span class="op" id="3945061">(</span><span class="op" id="3945062">&amp;</span><span class="ident" id="3945063">t</span><span class="op" id="3945064">,</span>&nbsp;<span class="ident" id="3945066">x1</span><span class="op" id="3945068">,</span>&nbsp;<span class="op" id="3945070">&amp;</span><span class="ident" id="3945071">delta</span><span class="op" id="3945076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3945079">for</span>&nbsp;<span class="ident" id="3945083">i</span>&nbsp;<span class="op" id="3945085">:=</span>&nbsp;<span class="num" id="3945088">0</span><span class="op" id="3945089">;</span>&nbsp;<span class="ident" id="3945091">i</span>&nbsp;<span class="op" id="3945093">&lt;</span>&nbsp;<span class="num" id="3945095">8</span><span class="op" id="3945096">;</span>&nbsp;<span class="ident" id="3945098">i</span><span class="op" id="3945099">++</span>&nbsp;<span class="op" id="3945102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945106">t</span><span class="op" id="3945107">[</span><span class="ident" id="3945108">i</span><span class="op" id="3945109">]</span>&nbsp;<span class="op" id="3945111">+=</span>&nbsp;<span class="ident" id="3945114">t</span><span class="op" id="3945115">[</span><span class="ident" id="3945116">i</span><span class="op" id="3945117">]</span>&nbsp;<span class="op" id="3945119">&lt;&lt;</span>&nbsp;<span class="num" id="3945122">1</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3945125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945128">p224Reduce</span><span class="op" id="3945138">(</span><span class="op" id="3945139">&amp;</span><span class="ident" id="3945140">t</span><span class="op" id="3945141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945144">p224Sub</span><span class="op" id="3945151">(</span><span class="op" id="3945152">&amp;</span><span class="ident" id="3945153">alpha</span><span class="op" id="3945158">,</span>&nbsp;<span class="ident" id="3945160">x1</span><span class="op" id="3945162">,</span>&nbsp;<span class="op" id="3945164">&amp;</span><span class="ident" id="3945165">delta</span><span class="op" id="3945170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945173">p224Reduce</span><span class="op" id="3945183">(</span><span class="op" id="3945184">&amp;</span><span class="ident" id="3945185">alpha</span><span class="op" id="3945190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945193">p224Mul</span><span class="op" id="3945200">(</span><span class="op" id="3945201">&amp;</span><span class="ident" id="3945202">alpha</span><span class="op" id="3945207">,</span>&nbsp;<span class="op" id="3945209">&amp;</span><span class="ident" id="3945210">alpha</span><span class="op" id="3945215">,</span>&nbsp;<span class="op" id="3945217">&amp;</span><span class="ident" id="3945218">t</span><span class="op" id="3945219">,</span>&nbsp;<span class="op" id="3945221">&amp;</span><span class="ident" id="3945222">c</span><span class="op" id="3945223">)</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3945227">//&nbsp;Z3&nbsp;=&nbsp;(Y1+Z1)²-gamma-delta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945258">p224Add</span><span class="op" id="3945265">(</span><span class="ident" id="3945266">z3</span><span class="op" id="3945268">,</span>&nbsp;<span class="ident" id="3945270">y1</span><span class="op" id="3945272">,</span>&nbsp;<span class="ident" id="3945274">z1</span><span class="op" id="3945276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945279">p224Reduce</span><span class="op" id="3945289">(</span><span class="ident" id="3945290">z3</span><span class="op" id="3945292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945295">p224Square</span><span class="op" id="3945305">(</span><span class="ident" id="3945306">z3</span><span class="op" id="3945308">,</span>&nbsp;<span class="ident" id="3945310">z3</span><span class="op" id="3945312">,</span>&nbsp;<span class="op" id="3945314">&amp;</span><span class="ident" id="3945315">c</span><span class="op" id="3945316">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945319">p224Sub</span><span class="op" id="3945326">(</span><span class="ident" id="3945327">z3</span><span class="op" id="3945329">,</span>&nbsp;<span class="ident" id="3945331">z3</span><span class="op" id="3945333">,</span>&nbsp;<span class="op" id="3945335">&amp;</span><span class="ident" id="3945336">gamma</span><span class="op" id="3945341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945344">p224Reduce</span><span class="op" id="3945354">(</span><span class="ident" id="3945355">z3</span><span class="op" id="3945357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945360">p224Sub</span><span class="op" id="3945367">(</span><span class="ident" id="3945368">z3</span><span class="op" id="3945370">,</span>&nbsp;<span class="ident" id="3945372">z3</span><span class="op" id="3945374">,</span>&nbsp;<span class="op" id="3945376">&amp;</span><span class="ident" id="3945377">delta</span><span class="op" id="3945382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945385">p224Reduce</span><span class="op" id="3945395">(</span><span class="ident" id="3945396">z3</span><span class="op" id="3945398">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3945402">//&nbsp;X3&nbsp;=&nbsp;alpha²-8*beta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3945426">for</span>&nbsp;<span class="ident" id="3945430">i</span>&nbsp;<span class="op" id="3945432">:=</span>&nbsp;<span class="num" id="3945435">0</span><span class="op" id="3945436">;</span>&nbsp;<span class="ident" id="3945438">i</span>&nbsp;<span class="op" id="3945440">&lt;</span>&nbsp;<span class="num" id="3945442">8</span><span class="op" id="3945443">;</span>&nbsp;<span class="ident" id="3945445">i</span><span class="op" id="3945446">++</span>&nbsp;<span class="op" id="3945449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945453">delta</span><span class="op" id="3945458">[</span><span class="ident" id="3945459">i</span><span class="op" id="3945460">]</span>&nbsp;<span class="op" id="3945462">=</span>&nbsp;<span class="ident" id="3945464">beta</span><span class="op" id="3945468">[</span><span class="ident" id="3945469">i</span><span class="op" id="3945470">]</span>&nbsp;<span class="op" id="3945472">&lt;&lt;</span>&nbsp;<span class="num" id="3945475">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3945478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945481">p224Reduce</span><span class="op" id="3945491">(</span><span class="op" id="3945492">&amp;</span><span class="ident" id="3945493">delta</span><span class="op" id="3945498">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945501">p224Square</span><span class="op" id="3945511">(</span><span class="ident" id="3945512">x3</span><span class="op" id="3945514">,</span>&nbsp;<span class="op" id="3945516">&amp;</span><span class="ident" id="3945517">alpha</span><span class="op" id="3945522">,</span>&nbsp;<span class="op" id="3945524">&amp;</span><span class="ident" id="3945525">c</span><span class="op" id="3945526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945529">p224Sub</span><span class="op" id="3945536">(</span><span class="ident" id="3945537">x3</span><span class="op" id="3945539">,</span>&nbsp;<span class="ident" id="3945541">x3</span><span class="op" id="3945543">,</span>&nbsp;<span class="op" id="3945545">&amp;</span><span class="ident" id="3945546">delta</span><span class="op" id="3945551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945554">p224Reduce</span><span class="op" id="3945564">(</span><span class="ident" id="3945565">x3</span><span class="op" id="3945567">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3945571">//&nbsp;Y3&nbsp;=&nbsp;alpha*(4*beta-X3)-8*gamma²</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3945608">for</span>&nbsp;<span class="ident" id="3945612">i</span>&nbsp;<span class="op" id="3945614">:=</span>&nbsp;<span class="num" id="3945617">0</span><span class="op" id="3945618">;</span>&nbsp;<span class="ident" id="3945620">i</span>&nbsp;<span class="op" id="3945622">&lt;</span>&nbsp;<span class="num" id="3945624">8</span><span class="op" id="3945625">;</span>&nbsp;<span class="ident" id="3945627">i</span><span class="op" id="3945628">++</span>&nbsp;<span class="op" id="3945631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945635">beta</span><span class="op" id="3945639">[</span><span class="ident" id="3945640">i</span><span class="op" id="3945641">]</span>&nbsp;<span class="op" id="3945643">&lt;&lt;=</span>&nbsp;<span class="num" id="3945647">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3945650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945653">p224Sub</span><span class="op" id="3945660">(</span><span class="op" id="3945661">&amp;</span><span class="ident" id="3945662">beta</span><span class="op" id="3945666">,</span>&nbsp;<span class="op" id="3945668">&amp;</span><span class="ident" id="3945669">beta</span><span class="op" id="3945673">,</span>&nbsp;<span class="ident" id="3945675">x3</span><span class="op" id="3945677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945680">p224Reduce</span><span class="op" id="3945690">(</span><span class="op" id="3945691">&amp;</span><span class="ident" id="3945692">beta</span><span class="op" id="3945696">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945699">p224Square</span><span class="op" id="3945709">(</span><span class="op" id="3945710">&amp;</span><span class="ident" id="3945711">gamma</span><span class="op" id="3945716">,</span>&nbsp;<span class="op" id="3945718">&amp;</span><span class="ident" id="3945719">gamma</span><span class="op" id="3945724">,</span>&nbsp;<span class="op" id="3945726">&amp;</span><span class="ident" id="3945727">c</span><span class="op" id="3945728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3945731">for</span>&nbsp;<span class="ident" id="3945735">i</span>&nbsp;<span class="op" id="3945737">:=</span>&nbsp;<span class="num" id="3945740">0</span><span class="op" id="3945741">;</span>&nbsp;<span class="ident" id="3945743">i</span>&nbsp;<span class="op" id="3945745">&lt;</span>&nbsp;<span class="num" id="3945747">8</span><span class="op" id="3945748">;</span>&nbsp;<span class="ident" id="3945750">i</span><span class="op" id="3945751">++</span>&nbsp;<span class="op" id="3945754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945758">gamma</span><span class="op" id="3945763">[</span><span class="ident" id="3945764">i</span><span class="op" id="3945765">]</span>&nbsp;<span class="op" id="3945767">&lt;&lt;=</span>&nbsp;<span class="num" id="3945771">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3945774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945777">p224Reduce</span><span class="op" id="3945787">(</span><span class="op" id="3945788">&amp;</span><span class="ident" id="3945789">gamma</span><span class="op" id="3945794">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945797">p224Mul</span><span class="op" id="3945804">(</span><span class="ident" id="3945805">y3</span><span class="op" id="3945807">,</span>&nbsp;<span class="op" id="3945809">&amp;</span><span class="ident" id="3945810">alpha</span><span class="op" id="3945815">,</span>&nbsp;<span class="op" id="3945817">&amp;</span><span class="ident" id="3945818">beta</span><span class="op" id="3945822">,</span>&nbsp;<span class="op" id="3945824">&amp;</span><span class="ident" id="3945825">c</span><span class="op" id="3945826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945829">p224Sub</span><span class="op" id="3945836">(</span><span class="ident" id="3945837">y3</span><span class="op" id="3945839">,</span>&nbsp;<span class="ident" id="3945841">y3</span><span class="op" id="3945843">,</span>&nbsp;<span class="op" id="3945845">&amp;</span><span class="ident" id="3945846">gamma</span><span class="op" id="3945851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945854">p224Reduce</span><span class="op" id="3945864">(</span><span class="ident" id="3945865">y3</span><span class="op" id="3945867">)</span><br>
<span class="lineno"></span><span class="op" id="3945869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span><span class="comment" id="3945872">//&nbsp;p224CopyConditional&nbsp;sets&nbsp;*out&nbsp;=&nbsp;*in&nbsp;iff&nbsp;the&nbsp;least-significant-bit&nbsp;of&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="3945952">//&nbsp;is&nbsp;true,&nbsp;and&nbsp;it&nbsp;runs&nbsp;in&nbsp;constant&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="3945994">func</span>&nbsp;<span class="ident" id="3945999">p224CopyConditional</span><span class="op" id="3946018">(</span><span class="ident" id="3946019">out</span><span class="op" id="3946022">,</span>&nbsp;<span class="ident" id="3946024">in</span>&nbsp;<span class="op" id="3946027">*</span><span class="ident" id="3946028">p224FieldElement</span><span class="op" id="3946044">,</span>&nbsp;<span class="ident" id="3946046">control</span>&nbsp;<span class="builtintype" id="3946054">uint32</span><span class="op" id="3946060">)</span>&nbsp;<span class="op" id="3946062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3946065">control</span>&nbsp;<span class="op" id="3946073">&lt;&lt;=</span>&nbsp;<span class="num" id="3946077">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3946081">control</span>&nbsp;<span class="op" id="3946089">=</span>&nbsp;<span class="builtintype" id="3946091">uint32</span><span class="op" id="3946097">(</span><span class="builtintype" id="3946098">int32</span><span class="op" id="3946103">(</span><span class="ident" id="3946104">control</span><span class="op" id="3946111">)</span>&nbsp;<span class="op" id="3946113">&gt;&gt;</span>&nbsp;<span class="num" id="3946116">31</span><span class="op" id="3946118">)</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3946122">for</span>&nbsp;<span class="ident" id="3946126">i</span>&nbsp;<span class="op" id="3946128">:=</span>&nbsp;<span class="num" id="3946131">0</span><span class="op" id="3946132">;</span>&nbsp;<span class="ident" id="3946134">i</span>&nbsp;<span class="op" id="3946136">&lt;</span>&nbsp;<span class="num" id="3946138">8</span><span class="op" id="3946139">;</span>&nbsp;<span class="ident" id="3946141">i</span><span class="op" id="3946142">++</span>&nbsp;<span class="op" id="3946145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3946149">out</span><span class="op" id="3946152">[</span><span class="ident" id="3946153">i</span><span class="op" id="3946154">]</span>&nbsp;<span class="op" id="3946156">^=</span>&nbsp;<span class="op" id="3946159">(</span><span class="ident" id="3946160">out</span><span class="op" id="3946163">[</span><span class="ident" id="3946164">i</span><span class="op" id="3946165">]</span>&nbsp;<span class="op" id="3946167">^</span>&nbsp;<span class="ident" id="3946169">in</span><span class="op" id="3946171">[</span><span class="ident" id="3946172">i</span><span class="op" id="3946173">]</span><span class="op" id="3946174">)</span>&nbsp;<span class="op" id="3946176">&amp;</span>&nbsp;<span class="ident" id="3946178">control</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3946187">}</span><br>
<span class="lineno"></span><span class="op" id="3946189">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span><span class="keyword" id="3946192">func</span>&nbsp;<span class="ident" id="3946197">p224ScalarMult</span><span class="op" id="3946211">(</span><span class="ident" id="3946212">outX</span><span class="op" id="3946216">,</span>&nbsp;<span class="ident" id="3946218">outY</span><span class="op" id="3946222">,</span>&nbsp;<span class="ident" id="3946224">outZ</span><span class="op" id="3946228">,</span>&nbsp;<span class="ident" id="3946230">inX</span><span class="op" id="3946233">,</span>&nbsp;<span class="ident" id="3946235">inY</span><span class="op" id="3946238">,</span>&nbsp;<span class="ident" id="3946240">inZ</span>&nbsp;<span class="op" id="3946244">*</span><span class="ident" id="3946245">p224FieldElement</span><span class="op" id="3946261">,</span>&nbsp;<span class="ident" id="3946263">scalar</span>&nbsp;<span class="op" id="3946270">[</span><span class="op" id="3946271">]</span><span class="builtintype" id="3946272">byte</span><span class="op" id="3946276">)</span>&nbsp;<span class="op" id="3946278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3946281">var</span>&nbsp;<span class="ident" id="3946285">xx</span><span class="op" id="3946287">,</span>&nbsp;<span class="ident" id="3946289">yy</span><span class="op" id="3946291">,</span>&nbsp;<span class="ident" id="3946293">zz</span>&nbsp;<span class="ident" id="3946296">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3946314">for</span>&nbsp;<span class="ident" id="3946318">i</span>&nbsp;<span class="op" id="3946320">:=</span>&nbsp;<span class="num" id="3946323">0</span><span class="op" id="3946324">;</span>&nbsp;<span class="ident" id="3946326">i</span>&nbsp;<span class="op" id="3946328">&lt;</span>&nbsp;<span class="num" id="3946330">8</span><span class="op" id="3946331">;</span>&nbsp;<span class="ident" id="3946333">i</span><span class="op" id="3946334">++</span>&nbsp;<span class="op" id="3946337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3946341">outX</span><span class="op" id="3946345">[</span><span class="ident" id="3946346">i</span><span class="op" id="3946347">]</span>&nbsp;<span class="op" id="3946349">=</span>&nbsp;<span class="num" id="3946351">0</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3946355">outY</span><span class="op" id="3946359">[</span><span class="ident" id="3946360">i</span><span class="op" id="3946361">]</span>&nbsp;<span class="op" id="3946363">=</span>&nbsp;<span class="num" id="3946365">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3946369">outZ</span><span class="op" id="3946373">[</span><span class="ident" id="3946374">i</span><span class="op" id="3946375">]</span>&nbsp;<span class="op" id="3946377">=</span>&nbsp;<span class="num" id="3946379">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3946382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3946386">for</span>&nbsp;<span class="ident" id="3946390">_</span><span class="op" id="3946391">,</span>&nbsp;<span class="builtintype" id="3946393">byte</span>&nbsp;<span class="op" id="3946398">:=</span>&nbsp;<span class="keyword" id="3946401">range</span>&nbsp;<span class="ident" id="3946407">scalar</span>&nbsp;<span class="op" id="3946414">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3946418">for</span>&nbsp;<span class="ident" id="3946422">bitNum</span>&nbsp;<span class="op" id="3946429">:=</span>&nbsp;<span class="builtintype" id="3946432">uint</span><span class="op" id="3946436">(</span><span class="num" id="3946437">0</span><span class="op" id="3946438">)</span><span class="op" id="3946439">;</span>&nbsp;<span class="ident" id="3946441">bitNum</span>&nbsp;<span class="op" id="3946448">&lt;</span>&nbsp;<span class="num" id="3946450">8</span><span class="op" id="3946451">;</span>&nbsp;<span class="ident" id="3946453">bitNum</span><span class="op" id="3946459">++</span>&nbsp;<span class="op" id="3946462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3946467">p224DoubleJacobian</span><span class="op" id="3946485">(</span><span class="ident" id="3946486">outX</span><span class="op" id="3946490">,</span>&nbsp;<span class="ident" id="3946492">outY</span><span class="op" id="3946496">,</span>&nbsp;<span class="ident" id="3946498">outZ</span><span class="op" id="3946502">,</span>&nbsp;<span class="ident" id="3946504">outX</span><span class="op" id="3946508">,</span>&nbsp;<span class="ident" id="3946510">outY</span><span class="op" id="3946514">,</span>&nbsp;<span class="ident" id="3946516">outZ</span><span class="op" id="3946520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3946525">bit</span>&nbsp;<span class="op" id="3946529">:=</span>&nbsp;<span class="builtintype" id="3946532">uint32</span><span class="op" id="3946538">(</span><span class="op" id="3946539">(</span><span class="builtintype" id="3946540">byte</span>&nbsp;<span class="op" id="3946545">&gt;&gt;</span>&nbsp;<span class="op" id="3946548">(</span><span class="num" id="3946549">7</span>&nbsp;<span class="op" id="3946551">-</span>&nbsp;<span class="ident" id="3946553">bitNum</span><span class="op" id="3946559">)</span><span class="op" id="3946560">)</span>&nbsp;<span class="op" id="3946562">&amp;</span>&nbsp;<span class="num" id="3946564">1</span><span class="op" id="3946565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3946570">p224AddJacobian</span><span class="op" id="3946585">(</span><span class="op" id="3946586">&amp;</span><span class="ident" id="3946587">xx</span><span class="op" id="3946589">,</span>&nbsp;<span class="op" id="3946591">&amp;</span><span class="ident" id="3946592">yy</span><span class="op" id="3946594">,</span>&nbsp;<span class="op" id="3946596">&amp;</span><span class="ident" id="3946597">zz</span><span class="op" id="3946599">,</span>&nbsp;<span class="ident" id="3946601">inX</span><span class="op" id="3946604">,</span>&nbsp;<span class="ident" id="3946606">inY</span><span class="op" id="3946609">,</span>&nbsp;<span class="ident" id="3946611">inZ</span><span class="op" id="3946614">,</span>&nbsp;<span class="ident" id="3946616">outX</span><span class="op" id="3946620">,</span>&nbsp;<span class="ident" id="3946622">outY</span><span class="op" id="3946626">,</span>&nbsp;<span class="ident" id="3946628">outZ</span><span class="op" id="3946632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3946637">p224CopyConditional</span><span class="op" id="3946656">(</span><span class="ident" id="3946657">outX</span><span class="op" id="3946661">,</span>&nbsp;<span class="op" id="3946663">&amp;</span><span class="ident" id="3946664">xx</span><span class="op" id="3946666">,</span>&nbsp;<span class="ident" id="3946668">bit</span><span class="op" id="3946671">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3946676">p224CopyConditional</span><span class="op" id="3946695">(</span><span class="ident" id="3946696">outY</span><span class="op" id="3946700">,</span>&nbsp;<span class="op" id="3946702">&amp;</span><span class="ident" id="3946703">yy</span><span class="op" id="3946705">,</span>&nbsp;<span class="ident" id="3946707">bit</span><span class="op" id="3946710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3946715">p224CopyConditional</span><span class="op" id="3946734">(</span><span class="ident" id="3946735">outZ</span><span class="op" id="3946739">,</span>&nbsp;<span class="op" id="3946741">&amp;</span><span class="ident" id="3946742">zz</span><span class="op" id="3946744">,</span>&nbsp;<span class="ident" id="3946746">bit</span><span class="op" id="3946749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3946753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3946756">}</span><br>
<span class="lineno"></span><span class="op" id="3946758">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="comment" id="3946761">//&nbsp;p224ToAffine&nbsp;converts&nbsp;from&nbsp;Jacobian&nbsp;to&nbsp;affine&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="3946816">func</span>&nbsp;<span class="ident" id="3946821">p224ToAffine</span><span class="op" id="3946833">(</span><span class="ident" id="3946834">x</span><span class="op" id="3946835">,</span>&nbsp;<span class="ident" id="3946837">y</span><span class="op" id="3946838">,</span>&nbsp;<span class="ident" id="3946840">z</span>&nbsp;<span class="op" id="3946842">*</span><span class="ident" id="3946843">p224FieldElement</span><span class="op" id="3946859">)</span>&nbsp;<span class="op" id="3946861">(</span><span class="op" id="3946862">*</span><span class="ident" id="3946863">big</span><span class="op" id="3946866">.</span><span class="ident" id="3946867">Int</span><span class="op" id="3946870">,</span>&nbsp;<span class="op" id="3946872">*</span><span class="ident" id="3946873">big</span><span class="op" id="3946876">.</span><span class="ident" id="3946877">Int</span><span class="op" id="3946880">)</span>&nbsp;<span class="op" id="3946882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3946885">var</span>&nbsp;<span class="ident" id="3946889">zinv</span><span class="op" id="3946893">,</span>&nbsp;<span class="ident" id="3946895">zinvsq</span><span class="op" id="3946901">,</span>&nbsp;<span class="ident" id="3946903">outx</span><span class="op" id="3946907">,</span>&nbsp;<span class="ident" id="3946909">outy</span>&nbsp;<span class="ident" id="3946914">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3946932">var</span>&nbsp;<span class="ident" id="3946936">tmp</span>&nbsp;<span class="ident" id="3946940">p224LargeFieldElement</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3946964">if</span>&nbsp;<span class="ident" id="3946967">isPointAtInfinity</span>&nbsp;<span class="op" id="3946985">:=</span>&nbsp;<span class="ident" id="3946988">p224IsZero</span><span class="op" id="3946998">(</span><span class="ident" id="3946999">z</span><span class="op" id="3947000">)</span><span class="op" id="3947001">;</span>&nbsp;<span class="ident" id="3947003">isPointAtInfinity</span>&nbsp;<span class="op" id="3947021">==</span>&nbsp;<span class="num" id="3947024">1</span>&nbsp;<span class="op" id="3947026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3947030">return</span>&nbsp;<span class="builtinfunc" id="3947037">new</span><span class="op" id="3947040">(</span><span class="ident" id="3947041">big</span><span class="op" id="3947044">.</span><span class="ident" id="3947045">Int</span><span class="op" id="3947048">)</span><span class="op" id="3947049">,</span>&nbsp;<span class="builtinfunc" id="3947051">new</span><span class="op" id="3947054">(</span><span class="ident" id="3947055">big</span><span class="op" id="3947058">.</span><span class="ident" id="3947059">Int</span><span class="op" id="3947062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3947065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3947069">p224Invert</span><span class="op" id="3947079">(</span><span class="op" id="3947080">&amp;</span><span class="ident" id="3947081">zinv</span><span class="op" id="3947085">,</span>&nbsp;<span class="ident" id="3947087">z</span><span class="op" id="3947088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3947091">p224Square</span><span class="op" id="3947101">(</span><span class="op" id="3947102">&amp;</span><span class="ident" id="3947103">zinvsq</span><span class="op" id="3947109">,</span>&nbsp;<span class="op" id="3947111">&amp;</span><span class="ident" id="3947112">zinv</span><span class="op" id="3947116">,</span>&nbsp;<span class="op" id="3947118">&amp;</span><span class="ident" id="3947119">tmp</span><span class="op" id="3947122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3947125">p224Mul</span><span class="op" id="3947132">(</span><span class="ident" id="3947133">x</span><span class="op" id="3947134">,</span>&nbsp;<span class="ident" id="3947136">x</span><span class="op" id="3947137">,</span>&nbsp;<span class="op" id="3947139">&amp;</span><span class="ident" id="3947140">zinvsq</span><span class="op" id="3947146">,</span>&nbsp;<span class="op" id="3947148">&amp;</span><span class="ident" id="3947149">tmp</span><span class="op" id="3947152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3947155">p224Mul</span><span class="op" id="3947162">(</span><span class="op" id="3947163">&amp;</span><span class="ident" id="3947164">zinvsq</span><span class="op" id="3947170">,</span>&nbsp;<span class="op" id="3947172">&amp;</span><span class="ident" id="3947173">zinvsq</span><span class="op" id="3947179">,</span>&nbsp;<span class="op" id="3947181">&amp;</span><span class="ident" id="3947182">zinv</span><span class="op" id="3947186">,</span>&nbsp;<span class="op" id="3947188">&amp;</span><span class="ident" id="3947189">tmp</span><span class="op" id="3947192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3947195">p224Mul</span><span class="op" id="3947202">(</span><span class="ident" id="3947203">y</span><span class="op" id="3947204">,</span>&nbsp;<span class="ident" id="3947206">y</span><span class="op" id="3947207">,</span>&nbsp;<span class="op" id="3947209">&amp;</span><span class="ident" id="3947210">zinvsq</span><span class="op" id="3947216">,</span>&nbsp;<span class="op" id="3947218">&amp;</span><span class="ident" id="3947219">tmp</span><span class="op" id="3947222">)</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3947226">p224Contract</span><span class="op" id="3947238">(</span><span class="op" id="3947239">&amp;</span><span class="ident" id="3947240">outx</span><span class="op" id="3947244">,</span>&nbsp;<span class="ident" id="3947246">x</span><span class="op" id="3947247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3947250">p224Contract</span><span class="op" id="3947262">(</span><span class="op" id="3947263">&amp;</span><span class="ident" id="3947264">outy</span><span class="op" id="3947268">,</span>&nbsp;<span class="ident" id="3947270">y</span><span class="op" id="3947271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3947274">return</span>&nbsp;<span class="ident" id="3947281">p224ToBig</span><span class="op" id="3947290">(</span><span class="op" id="3947291">&amp;</span><span class="ident" id="3947292">outx</span><span class="op" id="3947296">)</span><span class="op" id="3947297">,</span>&nbsp;<span class="ident" id="3947299">p224ToBig</span><span class="op" id="3947308">(</span><span class="op" id="3947309">&amp;</span><span class="ident" id="3947310">outy</span><span class="op" id="3947314">)</span><br>
<span class="lineno"></span><span class="op" id="3947316">}</span><br>
<span class="lineno">690</span><br>
<span class="lineno"></span><span class="comment" id="3947319">//&nbsp;get28BitsFromEnd&nbsp;returns&nbsp;the&nbsp;least-significant&nbsp;28&nbsp;bits&nbsp;from&nbsp;buf&gt;&gt;shift,</span><br>
<span class="lineno"></span><span class="comment" id="3947394">//&nbsp;where&nbsp;buf&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;big-endian&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="3947446">func</span>&nbsp;<span class="ident" id="3947451">get28BitsFromEnd</span><span class="op" id="3947467">(</span><span class="ident" id="3947468">buf</span>&nbsp;<span class="op" id="3947472">[</span><span class="op" id="3947473">]</span><span class="builtintype" id="3947474">byte</span><span class="op" id="3947478">,</span>&nbsp;<span class="ident" id="3947480">shift</span>&nbsp;<span class="builtintype" id="3947486">uint</span><span class="op" id="3947490">)</span>&nbsp;<span class="op" id="3947492">(</span><span class="builtintype" id="3947493">uint32</span><span class="op" id="3947499">,</span>&nbsp;<span class="op" id="3947501">[</span><span class="op" id="3947502">]</span><span class="builtintype" id="3947503">byte</span><span class="op" id="3947507">)</span>&nbsp;<span class="op" id="3947509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3947512">var</span>&nbsp;<span class="ident" id="3947516">ret</span>&nbsp;<span class="builtintype" id="3947520">uint32</span><br>
<span class="lineno">695</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3947529">for</span>&nbsp;<span class="ident" id="3947533">i</span>&nbsp;<span class="op" id="3947535">:=</span>&nbsp;<span class="builtintype" id="3947538">uint</span><span class="op" id="3947542">(</span><span class="num" id="3947543">0</span><span class="op" id="3947544">)</span><span class="op" id="3947545">;</span>&nbsp;<span class="ident" id="3947547">i</span>&nbsp;<span class="op" id="3947549">&lt;</span>&nbsp;<span class="num" id="3947551">4</span><span class="op" id="3947552">;</span>&nbsp;<span class="ident" id="3947554">i</span><span class="op" id="3947555">++</span>&nbsp;<span class="op" id="3947558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3947562">var</span>&nbsp;<span class="ident" id="3947566">b</span>&nbsp;<span class="builtintype" id="3947568">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3947575">if</span>&nbsp;<span class="ident" id="3947578">l</span>&nbsp;<span class="op" id="3947580">:=</span>&nbsp;<span class="builtinfunc" id="3947583">len</span><span class="op" id="3947586">(</span><span class="ident" id="3947587">buf</span><span class="op" id="3947590">)</span><span class="op" id="3947591">;</span>&nbsp;<span class="ident" id="3947593">l</span>&nbsp;<span class="op" id="3947595">&gt;</span>&nbsp;<span class="num" id="3947597">0</span>&nbsp;<span class="op" id="3947599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3947604">b</span>&nbsp;<span class="op" id="3947606">=</span>&nbsp;<span class="ident" id="3947608">buf</span><span class="op" id="3947611">[</span><span class="ident" id="3947612">l</span><span class="op" id="3947613">-</span><span class="num" id="3947614">1</span><span class="op" id="3947615">]</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3947620">//&nbsp;We&nbsp;don&#39;t&nbsp;remove&nbsp;the&nbsp;byte&nbsp;if&nbsp;we&#39;re&nbsp;about&nbsp;to&nbsp;return&nbsp;and&nbsp;we&#39;re&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3947690">//&nbsp;reading&nbsp;all&nbsp;of&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3947715">if</span>&nbsp;<span class="ident" id="3947718">i</span>&nbsp;<span class="op" id="3947720">!=</span>&nbsp;<span class="num" id="3947723">3</span>&nbsp;<span class="op" id="3947725">||</span>&nbsp;<span class="ident" id="3947728">shift</span>&nbsp;<span class="op" id="3947734">==</span>&nbsp;<span class="num" id="3947737">4</span>&nbsp;<span class="op" id="3947739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3947745">buf</span>&nbsp;<span class="op" id="3947749">=</span>&nbsp;<span class="ident" id="3947751">buf</span><span class="op" id="3947754">[</span><span class="op" id="3947755">:</span><span class="ident" id="3947756">l</span><span class="op" id="3947757">-</span><span class="num" id="3947758">1</span><span class="op" id="3947759">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3947764">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3947768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3947772">ret</span>&nbsp;<span class="op" id="3947776">|=</span>&nbsp;<span class="builtintype" id="3947779">uint32</span><span class="op" id="3947785">(</span><span class="ident" id="3947786">b</span><span class="op" id="3947787">)</span>&nbsp;<span class="op" id="3947789">&lt;&lt;</span>&nbsp;<span class="op" id="3947792">(</span><span class="num" id="3947793">8</span>&nbsp;<span class="op" id="3947795">*</span>&nbsp;<span class="ident" id="3947797">i</span><span class="op" id="3947798">)</span>&nbsp;<span class="op" id="3947800">&gt;&gt;</span>&nbsp;<span class="ident" id="3947803">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3947810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3947813">ret</span>&nbsp;<span class="op" id="3947817">&amp;=</span>&nbsp;<span class="ident" id="3947820">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3947834">return</span>&nbsp;<span class="ident" id="3947841">ret</span><span class="op" id="3947844">,</span>&nbsp;<span class="ident" id="3947846">buf</span><br>
<span class="lineno">710</span><span class="op" id="3947850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3947853">//&nbsp;p224FromBig&nbsp;sets&nbsp;*out&nbsp;=&nbsp;*in.</span><br>
<span class="lineno"></span><span class="keyword" id="3947885">func</span>&nbsp;<span class="ident" id="3947890">p224FromBig</span><span class="op" id="3947901">(</span><span class="ident" id="3947902">out</span>&nbsp;<span class="op" id="3947906">*</span><span class="ident" id="3947907">p224FieldElement</span><span class="op" id="3947923">,</span>&nbsp;<span class="ident" id="3947925">in</span>&nbsp;<span class="op" id="3947928">*</span><span class="ident" id="3947929">big</span><span class="op" id="3947932">.</span><span class="ident" id="3947933">Int</span><span class="op" id="3947936">)</span>&nbsp;<span class="op" id="3947938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3947941">bytes</span>&nbsp;<span class="op" id="3947947">:=</span>&nbsp;<span class="ident" id="3947950">in</span><span class="op" id="3947952">.</span><span class="ident" id="3947953">Bytes</span><span class="op" id="3947958">(</span><span class="op" id="3947959">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3947962">out</span><span class="op" id="3947965">[</span><span class="num" id="3947966">0</span><span class="op" id="3947967">]</span><span class="op" id="3947968">,</span>&nbsp;<span class="ident" id="3947970">bytes</span>&nbsp;<span class="op" id="3947976">=</span>&nbsp;<span class="ident" id="3947978">get28BitsFromEnd</span><span class="op" id="3947994">(</span><span class="ident" id="3947995">bytes</span><span class="op" id="3948000">,</span>&nbsp;<span class="num" id="3948002">0</span><span class="op" id="3948003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948006">out</span><span class="op" id="3948009">[</span><span class="num" id="3948010">1</span><span class="op" id="3948011">]</span><span class="op" id="3948012">,</span>&nbsp;<span class="ident" id="3948014">bytes</span>&nbsp;<span class="op" id="3948020">=</span>&nbsp;<span class="ident" id="3948022">get28BitsFromEnd</span><span class="op" id="3948038">(</span><span class="ident" id="3948039">bytes</span><span class="op" id="3948044">,</span>&nbsp;<span class="num" id="3948046">4</span><span class="op" id="3948047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948050">out</span><span class="op" id="3948053">[</span><span class="num" id="3948054">2</span><span class="op" id="3948055">]</span><span class="op" id="3948056">,</span>&nbsp;<span class="ident" id="3948058">bytes</span>&nbsp;<span class="op" id="3948064">=</span>&nbsp;<span class="ident" id="3948066">get28BitsFromEnd</span><span class="op" id="3948082">(</span><span class="ident" id="3948083">bytes</span><span class="op" id="3948088">,</span>&nbsp;<span class="num" id="3948090">0</span><span class="op" id="3948091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948094">out</span><span class="op" id="3948097">[</span><span class="num" id="3948098">3</span><span class="op" id="3948099">]</span><span class="op" id="3948100">,</span>&nbsp;<span class="ident" id="3948102">bytes</span>&nbsp;<span class="op" id="3948108">=</span>&nbsp;<span class="ident" id="3948110">get28BitsFromEnd</span><span class="op" id="3948126">(</span><span class="ident" id="3948127">bytes</span><span class="op" id="3948132">,</span>&nbsp;<span class="num" id="3948134">4</span><span class="op" id="3948135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948138">out</span><span class="op" id="3948141">[</span><span class="num" id="3948142">4</span><span class="op" id="3948143">]</span><span class="op" id="3948144">,</span>&nbsp;<span class="ident" id="3948146">bytes</span>&nbsp;<span class="op" id="3948152">=</span>&nbsp;<span class="ident" id="3948154">get28BitsFromEnd</span><span class="op" id="3948170">(</span><span class="ident" id="3948171">bytes</span><span class="op" id="3948176">,</span>&nbsp;<span class="num" id="3948178">0</span><span class="op" id="3948179">)</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948182">out</span><span class="op" id="3948185">[</span><span class="num" id="3948186">5</span><span class="op" id="3948187">]</span><span class="op" id="3948188">,</span>&nbsp;<span class="ident" id="3948190">bytes</span>&nbsp;<span class="op" id="3948196">=</span>&nbsp;<span class="ident" id="3948198">get28BitsFromEnd</span><span class="op" id="3948214">(</span><span class="ident" id="3948215">bytes</span><span class="op" id="3948220">,</span>&nbsp;<span class="num" id="3948222">4</span><span class="op" id="3948223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948226">out</span><span class="op" id="3948229">[</span><span class="num" id="3948230">6</span><span class="op" id="3948231">]</span><span class="op" id="3948232">,</span>&nbsp;<span class="ident" id="3948234">bytes</span>&nbsp;<span class="op" id="3948240">=</span>&nbsp;<span class="ident" id="3948242">get28BitsFromEnd</span><span class="op" id="3948258">(</span><span class="ident" id="3948259">bytes</span><span class="op" id="3948264">,</span>&nbsp;<span class="num" id="3948266">0</span><span class="op" id="3948267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948270">out</span><span class="op" id="3948273">[</span><span class="num" id="3948274">7</span><span class="op" id="3948275">]</span><span class="op" id="3948276">,</span>&nbsp;<span class="ident" id="3948278">bytes</span>&nbsp;<span class="op" id="3948284">=</span>&nbsp;<span class="ident" id="3948286">get28BitsFromEnd</span><span class="op" id="3948302">(</span><span class="ident" id="3948303">bytes</span><span class="op" id="3948308">,</span>&nbsp;<span class="num" id="3948310">4</span><span class="op" id="3948311">)</span><br>
<span class="lineno"></span><span class="op" id="3948313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="comment" id="3948316">//&nbsp;p224ToBig&nbsp;returns&nbsp;in&nbsp;as&nbsp;a&nbsp;big.Int.</span><br>
<span class="lineno"></span><span class="keyword" id="3948354">func</span>&nbsp;<span class="ident" id="3948359">p224ToBig</span><span class="op" id="3948368">(</span><span class="ident" id="3948369">in</span>&nbsp;<span class="op" id="3948372">*</span><span class="ident" id="3948373">p224FieldElement</span><span class="op" id="3948389">)</span>&nbsp;<span class="op" id="3948391">*</span><span class="ident" id="3948392">big</span><span class="op" id="3948395">.</span><span class="ident" id="3948396">Int</span>&nbsp;<span class="op" id="3948400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3948403">var</span>&nbsp;<span class="ident" id="3948407">buf</span>&nbsp;<span class="op" id="3948411">[</span><span class="num" id="3948412">28</span><span class="op" id="3948414">]</span><span class="builtintype" id="3948415">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948421">buf</span><span class="op" id="3948424">[</span><span class="num" id="3948425">27</span><span class="op" id="3948427">]</span>&nbsp;<span class="op" id="3948429">=</span>&nbsp;<span class="builtintype" id="3948431">byte</span><span class="op" id="3948435">(</span><span class="ident" id="3948436">in</span><span class="op" id="3948438">[</span><span class="num" id="3948439">0</span><span class="op" id="3948440">]</span><span class="op" id="3948441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948444">buf</span><span class="op" id="3948447">[</span><span class="num" id="3948448">26</span><span class="op" id="3948450">]</span>&nbsp;<span class="op" id="3948452">=</span>&nbsp;<span class="builtintype" id="3948454">byte</span><span class="op" id="3948458">(</span><span class="ident" id="3948459">in</span><span class="op" id="3948461">[</span><span class="num" id="3948462">0</span><span class="op" id="3948463">]</span>&nbsp;<span class="op" id="3948465">&gt;&gt;</span>&nbsp;<span class="num" id="3948468">8</span><span class="op" id="3948469">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948472">buf</span><span class="op" id="3948475">[</span><span class="num" id="3948476">25</span><span class="op" id="3948478">]</span>&nbsp;<span class="op" id="3948480">=</span>&nbsp;<span class="builtintype" id="3948482">byte</span><span class="op" id="3948486">(</span><span class="ident" id="3948487">in</span><span class="op" id="3948489">[</span><span class="num" id="3948490">0</span><span class="op" id="3948491">]</span>&nbsp;<span class="op" id="3948493">&gt;&gt;</span>&nbsp;<span class="num" id="3948496">16</span><span class="op" id="3948498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948501">buf</span><span class="op" id="3948504">[</span><span class="num" id="3948505">24</span><span class="op" id="3948507">]</span>&nbsp;<span class="op" id="3948509">=</span>&nbsp;<span class="builtintype" id="3948511">byte</span><span class="op" id="3948515">(</span><span class="op" id="3948516">(</span><span class="op" id="3948517">(</span><span class="ident" id="3948518">in</span><span class="op" id="3948520">[</span><span class="num" id="3948521">0</span><span class="op" id="3948522">]</span>&nbsp;<span class="op" id="3948524">&gt;&gt;</span>&nbsp;<span class="num" id="3948527">24</span><span class="op" id="3948529">)</span>&nbsp;<span class="op" id="3948531">&amp;</span>&nbsp;<span class="num" id="3948533">0x0f</span><span class="op" id="3948537">)</span>&nbsp;<span class="op" id="3948539">|</span>&nbsp;<span class="op" id="3948541">(</span><span class="ident" id="3948542">in</span><span class="op" id="3948544">[</span><span class="num" id="3948545">1</span><span class="op" id="3948546">]</span><span class="op" id="3948547">&lt;&lt;</span><span class="num" id="3948549">4</span><span class="op" id="3948550">)</span><span class="op" id="3948551">&amp;</span><span class="num" id="3948552">0xf0</span><span class="op" id="3948556">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948560">buf</span><span class="op" id="3948563">[</span><span class="num" id="3948564">23</span><span class="op" id="3948566">]</span>&nbsp;<span class="op" id="3948568">=</span>&nbsp;<span class="builtintype" id="3948570">byte</span><span class="op" id="3948574">(</span><span class="ident" id="3948575">in</span><span class="op" id="3948577">[</span><span class="num" id="3948578">1</span><span class="op" id="3948579">]</span>&nbsp;<span class="op" id="3948581">&gt;&gt;</span>&nbsp;<span class="num" id="3948584">4</span><span class="op" id="3948585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948588">buf</span><span class="op" id="3948591">[</span><span class="num" id="3948592">22</span><span class="op" id="3948594">]</span>&nbsp;<span class="op" id="3948596">=</span>&nbsp;<span class="builtintype" id="3948598">byte</span><span class="op" id="3948602">(</span><span class="ident" id="3948603">in</span><span class="op" id="3948605">[</span><span class="num" id="3948606">1</span><span class="op" id="3948607">]</span>&nbsp;<span class="op" id="3948609">&gt;&gt;</span>&nbsp;<span class="num" id="3948612">12</span><span class="op" id="3948614">)</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948617">buf</span><span class="op" id="3948620">[</span><span class="num" id="3948621">21</span><span class="op" id="3948623">]</span>&nbsp;<span class="op" id="3948625">=</span>&nbsp;<span class="builtintype" id="3948627">byte</span><span class="op" id="3948631">(</span><span class="ident" id="3948632">in</span><span class="op" id="3948634">[</span><span class="num" id="3948635">1</span><span class="op" id="3948636">]</span>&nbsp;<span class="op" id="3948638">&gt;&gt;</span>&nbsp;<span class="num" id="3948641">20</span><span class="op" id="3948643">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948647">buf</span><span class="op" id="3948650">[</span><span class="num" id="3948651">20</span><span class="op" id="3948653">]</span>&nbsp;<span class="op" id="3948655">=</span>&nbsp;<span class="builtintype" id="3948657">byte</span><span class="op" id="3948661">(</span><span class="ident" id="3948662">in</span><span class="op" id="3948664">[</span><span class="num" id="3948665">2</span><span class="op" id="3948666">]</span><span class="op" id="3948667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948670">buf</span><span class="op" id="3948673">[</span><span class="num" id="3948674">19</span><span class="op" id="3948676">]</span>&nbsp;<span class="op" id="3948678">=</span>&nbsp;<span class="builtintype" id="3948680">byte</span><span class="op" id="3948684">(</span><span class="ident" id="3948685">in</span><span class="op" id="3948687">[</span><span class="num" id="3948688">2</span><span class="op" id="3948689">]</span>&nbsp;<span class="op" id="3948691">&gt;&gt;</span>&nbsp;<span class="num" id="3948694">8</span><span class="op" id="3948695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948698">buf</span><span class="op" id="3948701">[</span><span class="num" id="3948702">18</span><span class="op" id="3948704">]</span>&nbsp;<span class="op" id="3948706">=</span>&nbsp;<span class="builtintype" id="3948708">byte</span><span class="op" id="3948712">(</span><span class="ident" id="3948713">in</span><span class="op" id="3948715">[</span><span class="num" id="3948716">2</span><span class="op" id="3948717">]</span>&nbsp;<span class="op" id="3948719">&gt;&gt;</span>&nbsp;<span class="num" id="3948722">16</span><span class="op" id="3948724">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948727">buf</span><span class="op" id="3948730">[</span><span class="num" id="3948731">17</span><span class="op" id="3948733">]</span>&nbsp;<span class="op" id="3948735">=</span>&nbsp;<span class="builtintype" id="3948737">byte</span><span class="op" id="3948741">(</span><span class="op" id="3948742">(</span><span class="op" id="3948743">(</span><span class="ident" id="3948744">in</span><span class="op" id="3948746">[</span><span class="num" id="3948747">2</span><span class="op" id="3948748">]</span>&nbsp;<span class="op" id="3948750">&gt;&gt;</span>&nbsp;<span class="num" id="3948753">24</span><span class="op" id="3948755">)</span>&nbsp;<span class="op" id="3948757">&amp;</span>&nbsp;<span class="num" id="3948759">0x0f</span><span class="op" id="3948763">)</span>&nbsp;<span class="op" id="3948765">|</span>&nbsp;<span class="op" id="3948767">(</span><span class="ident" id="3948768">in</span><span class="op" id="3948770">[</span><span class="num" id="3948771">3</span><span class="op" id="3948772">]</span><span class="op" id="3948773">&lt;&lt;</span><span class="num" id="3948775">4</span><span class="op" id="3948776">)</span><span class="op" id="3948777">&amp;</span><span class="num" id="3948778">0xf0</span><span class="op" id="3948782">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948786">buf</span><span class="op" id="3948789">[</span><span class="num" id="3948790">16</span><span class="op" id="3948792">]</span>&nbsp;<span class="op" id="3948794">=</span>&nbsp;<span class="builtintype" id="3948796">byte</span><span class="op" id="3948800">(</span><span class="ident" id="3948801">in</span><span class="op" id="3948803">[</span><span class="num" id="3948804">3</span><span class="op" id="3948805">]</span>&nbsp;<span class="op" id="3948807">&gt;&gt;</span>&nbsp;<span class="num" id="3948810">4</span><span class="op" id="3948811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948814">buf</span><span class="op" id="3948817">[</span><span class="num" id="3948818">15</span><span class="op" id="3948820">]</span>&nbsp;<span class="op" id="3948822">=</span>&nbsp;<span class="builtintype" id="3948824">byte</span><span class="op" id="3948828">(</span><span class="ident" id="3948829">in</span><span class="op" id="3948831">[</span><span class="num" id="3948832">3</span><span class="op" id="3948833">]</span>&nbsp;<span class="op" id="3948835">&gt;&gt;</span>&nbsp;<span class="num" id="3948838">12</span><span class="op" id="3948840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948843">buf</span><span class="op" id="3948846">[</span><span class="num" id="3948847">14</span><span class="op" id="3948849">]</span>&nbsp;<span class="op" id="3948851">=</span>&nbsp;<span class="builtintype" id="3948853">byte</span><span class="op" id="3948857">(</span><span class="ident" id="3948858">in</span><span class="op" id="3948860">[</span><span class="num" id="3948861">3</span><span class="op" id="3948862">]</span>&nbsp;<span class="op" id="3948864">&gt;&gt;</span>&nbsp;<span class="num" id="3948867">20</span><span class="op" id="3948869">)</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948873">buf</span><span class="op" id="3948876">[</span><span class="num" id="3948877">13</span><span class="op" id="3948879">]</span>&nbsp;<span class="op" id="3948881">=</span>&nbsp;<span class="builtintype" id="3948883">byte</span><span class="op" id="3948887">(</span><span class="ident" id="3948888">in</span><span class="op" id="3948890">[</span><span class="num" id="3948891">4</span><span class="op" id="3948892">]</span><span class="op" id="3948893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948896">buf</span><span class="op" id="3948899">[</span><span class="num" id="3948900">12</span><span class="op" id="3948902">]</span>&nbsp;<span class="op" id="3948904">=</span>&nbsp;<span class="builtintype" id="3948906">byte</span><span class="op" id="3948910">(</span><span class="ident" id="3948911">in</span><span class="op" id="3948913">[</span><span class="num" id="3948914">4</span><span class="op" id="3948915">]</span>&nbsp;<span class="op" id="3948917">&gt;&gt;</span>&nbsp;<span class="num" id="3948920">8</span><span class="op" id="3948921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948924">buf</span><span class="op" id="3948927">[</span><span class="num" id="3948928">11</span><span class="op" id="3948930">]</span>&nbsp;<span class="op" id="3948932">=</span>&nbsp;<span class="builtintype" id="3948934">byte</span><span class="op" id="3948938">(</span><span class="ident" id="3948939">in</span><span class="op" id="3948941">[</span><span class="num" id="3948942">4</span><span class="op" id="3948943">]</span>&nbsp;<span class="op" id="3948945">&gt;&gt;</span>&nbsp;<span class="num" id="3948948">16</span><span class="op" id="3948950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948953">buf</span><span class="op" id="3948956">[</span><span class="num" id="3948957">10</span><span class="op" id="3948959">]</span>&nbsp;<span class="op" id="3948961">=</span>&nbsp;<span class="builtintype" id="3948963">byte</span><span class="op" id="3948967">(</span><span class="op" id="3948968">(</span><span class="op" id="3948969">(</span><span class="ident" id="3948970">in</span><span class="op" id="3948972">[</span><span class="num" id="3948973">4</span><span class="op" id="3948974">]</span>&nbsp;<span class="op" id="3948976">&gt;&gt;</span>&nbsp;<span class="num" id="3948979">24</span><span class="op" id="3948981">)</span>&nbsp;<span class="op" id="3948983">&amp;</span>&nbsp;<span class="num" id="3948985">0x0f</span><span class="op" id="3948989">)</span>&nbsp;<span class="op" id="3948991">|</span>&nbsp;<span class="op" id="3948993">(</span><span class="ident" id="3948994">in</span><span class="op" id="3948996">[</span><span class="num" id="3948997">5</span><span class="op" id="3948998">]</span><span class="op" id="3948999">&lt;&lt;</span><span class="num" id="3949001">4</span><span class="op" id="3949002">)</span><span class="op" id="3949003">&amp;</span><span class="num" id="3949004">0xf0</span><span class="op" id="3949008">)</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949012">buf</span><span class="op" id="3949015">[</span><span class="num" id="3949016">9</span><span class="op" id="3949017">]</span>&nbsp;<span class="op" id="3949019">=</span>&nbsp;<span class="builtintype" id="3949021">byte</span><span class="op" id="3949025">(</span><span class="ident" id="3949026">in</span><span class="op" id="3949028">[</span><span class="num" id="3949029">5</span><span class="op" id="3949030">]</span>&nbsp;<span class="op" id="3949032">&gt;&gt;</span>&nbsp;<span class="num" id="3949035">4</span><span class="op" id="3949036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949039">buf</span><span class="op" id="3949042">[</span><span class="num" id="3949043">8</span><span class="op" id="3949044">]</span>&nbsp;<span class="op" id="3949046">=</span>&nbsp;<span class="builtintype" id="3949048">byte</span><span class="op" id="3949052">(</span><span class="ident" id="3949053">in</span><span class="op" id="3949055">[</span><span class="num" id="3949056">5</span><span class="op" id="3949057">]</span>&nbsp;<span class="op" id="3949059">&gt;&gt;</span>&nbsp;<span class="num" id="3949062">12</span><span class="op" id="3949064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949067">buf</span><span class="op" id="3949070">[</span><span class="num" id="3949071">7</span><span class="op" id="3949072">]</span>&nbsp;<span class="op" id="3949074">=</span>&nbsp;<span class="builtintype" id="3949076">byte</span><span class="op" id="3949080">(</span><span class="ident" id="3949081">in</span><span class="op" id="3949083">[</span><span class="num" id="3949084">5</span><span class="op" id="3949085">]</span>&nbsp;<span class="op" id="3949087">&gt;&gt;</span>&nbsp;<span class="num" id="3949090">20</span><span class="op" id="3949092">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949096">buf</span><span class="op" id="3949099">[</span><span class="num" id="3949100">6</span><span class="op" id="3949101">]</span>&nbsp;<span class="op" id="3949103">=</span>&nbsp;<span class="builtintype" id="3949105">byte</span><span class="op" id="3949109">(</span><span class="ident" id="3949110">in</span><span class="op" id="3949112">[</span><span class="num" id="3949113">6</span><span class="op" id="3949114">]</span><span class="op" id="3949115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949118">buf</span><span class="op" id="3949121">[</span><span class="num" id="3949122">5</span><span class="op" id="3949123">]</span>&nbsp;<span class="op" id="3949125">=</span>&nbsp;<span class="builtintype" id="3949127">byte</span><span class="op" id="3949131">(</span><span class="ident" id="3949132">in</span><span class="op" id="3949134">[</span><span class="num" id="3949135">6</span><span class="op" id="3949136">]</span>&nbsp;<span class="op" id="3949138">&gt;&gt;</span>&nbsp;<span class="num" id="3949141">8</span><span class="op" id="3949142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949145">buf</span><span class="op" id="3949148">[</span><span class="num" id="3949149">4</span><span class="op" id="3949150">]</span>&nbsp;<span class="op" id="3949152">=</span>&nbsp;<span class="builtintype" id="3949154">byte</span><span class="op" id="3949158">(</span><span class="ident" id="3949159">in</span><span class="op" id="3949161">[</span><span class="num" id="3949162">6</span><span class="op" id="3949163">]</span>&nbsp;<span class="op" id="3949165">&gt;&gt;</span>&nbsp;<span class="num" id="3949168">16</span><span class="op" id="3949170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949173">buf</span><span class="op" id="3949176">[</span><span class="num" id="3949177">3</span><span class="op" id="3949178">]</span>&nbsp;<span class="op" id="3949180">=</span>&nbsp;<span class="builtintype" id="3949182">byte</span><span class="op" id="3949186">(</span><span class="op" id="3949187">(</span><span class="op" id="3949188">(</span><span class="ident" id="3949189">in</span><span class="op" id="3949191">[</span><span class="num" id="3949192">6</span><span class="op" id="3949193">]</span>&nbsp;<span class="op" id="3949195">&gt;&gt;</span>&nbsp;<span class="num" id="3949198">24</span><span class="op" id="3949200">)</span>&nbsp;<span class="op" id="3949202">&amp;</span>&nbsp;<span class="num" id="3949204">0x0f</span><span class="op" id="3949208">)</span>&nbsp;<span class="op" id="3949210">|</span>&nbsp;<span class="op" id="3949212">(</span><span class="ident" id="3949213">in</span><span class="op" id="3949215">[</span><span class="num" id="3949216">7</span><span class="op" id="3949217">]</span><span class="op" id="3949218">&lt;&lt;</span><span class="num" id="3949220">4</span><span class="op" id="3949221">)</span><span class="op" id="3949222">&amp;</span><span class="num" id="3949223">0xf0</span><span class="op" id="3949227">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949231">buf</span><span class="op" id="3949234">[</span><span class="num" id="3949235">2</span><span class="op" id="3949236">]</span>&nbsp;<span class="op" id="3949238">=</span>&nbsp;<span class="builtintype" id="3949240">byte</span><span class="op" id="3949244">(</span><span class="ident" id="3949245">in</span><span class="op" id="3949247">[</span><span class="num" id="3949248">7</span><span class="op" id="3949249">]</span>&nbsp;<span class="op" id="3949251">&gt;&gt;</span>&nbsp;<span class="num" id="3949254">4</span><span class="op" id="3949255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949258">buf</span><span class="op" id="3949261">[</span><span class="num" id="3949262">1</span><span class="op" id="3949263">]</span>&nbsp;<span class="op" id="3949265">=</span>&nbsp;<span class="builtintype" id="3949267">byte</span><span class="op" id="3949271">(</span><span class="ident" id="3949272">in</span><span class="op" id="3949274">[</span><span class="num" id="3949275">7</span><span class="op" id="3949276">]</span>&nbsp;<span class="op" id="3949278">&gt;&gt;</span>&nbsp;<span class="num" id="3949281">12</span><span class="op" id="3949283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949286">buf</span><span class="op" id="3949289">[</span><span class="num" id="3949290">0</span><span class="op" id="3949291">]</span>&nbsp;<span class="op" id="3949293">=</span>&nbsp;<span class="builtintype" id="3949295">byte</span><span class="op" id="3949299">(</span><span class="ident" id="3949300">in</span><span class="op" id="3949302">[</span><span class="num" id="3949303">7</span><span class="op" id="3949304">]</span>&nbsp;<span class="op" id="3949306">&gt;&gt;</span>&nbsp;<span class="num" id="3949309">20</span><span class="op" id="3949311">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949315">return</span>&nbsp;<span class="builtinfunc" id="3949322">new</span><span class="op" id="3949325">(</span><span class="ident" id="3949326">big</span><span class="op" id="3949329">.</span><span class="ident" id="3949330">Int</span><span class="op" id="3949333">)</span><span class="op" id="3949334">.</span><span class="ident" id="3949335">SetBytes</span><span class="op" id="3949343">(</span><span class="ident" id="3949344">buf</span><span class="op" id="3949347">[</span><span class="op" id="3949348">:</span><span class="op" id="3949349">]</span><span class="op" id="3949350">)</span><br>
<span class="lineno">765</span><span class="op" id="3949352">}</span>
</div>
</body>
</html>
