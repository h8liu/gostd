<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/build</h2>
<ul>
<li><a href="/gostd/go/build/build.go.html">build.go</a></li>
<li><a href="/gostd/go/build/build_test.go.html" class="current">build_test.go</a></li>
<li><a href="/gostd/go/build/deps_test.go.html">deps_test.go</a></li>
<li><a href="/gostd/go/build/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/build/read.go.html">read.go</a></li>
<li><a href="/gostd/go/build/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/go/build/syslist.go.html">syslist.go</a></li>
<li><a href="/gostd/go/build/syslist_test.go.html">syslist_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7372554">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7372610">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7372664">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7372715">package</span>&nbsp;<span class="ident" id="7372723">build</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7372730">import</span>&nbsp;<span class="op" id="7372737">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7372740">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7372746">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7372752">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7372769">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7372780">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7372791">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7372802">&#34;testing&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7372812">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7372815">func</span>&nbsp;<span class="ident" id="7372820">TestMatch</span><span class="op" id="7372829">(</span><span class="ident" id="7372830">t</span>&nbsp;<span class="op" id="7372832">*</span><span class="ident" id="7372833">testing</span><span class="op" id="7372840">.</span><span class="ident" id="7372841">T</span><span class="op" id="7372842">)</span>&nbsp;<span class="op" id="7372844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7372847">ctxt</span>&nbsp;<span class="op" id="7372852">:=</span>&nbsp;<span class="ident" id="7372855">Default</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7372864">what</span>&nbsp;<span class="op" id="7372869">:=</span>&nbsp;<span class="string" id="7372872">&#34;default&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7372883">match</span>&nbsp;<span class="op" id="7372889">:=</span>&nbsp;<span class="keyword" id="7372892">func</span><span class="op" id="7372896">(</span><span class="ident" id="7372897">tag</span>&nbsp;<span class="builtintype" id="7372901">string</span><span class="op" id="7372907">,</span>&nbsp;<span class="ident" id="7372909">want</span>&nbsp;<span class="keyword" id="7372914">map</span><span class="op" id="7372917">[</span><span class="builtintype" id="7372918">string</span><span class="op" id="7372924">]</span><span class="builtintype" id="7372925">bool</span><span class="op" id="7372929">)</span>&nbsp;<span class="op" id="7372931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7372935">m</span>&nbsp;<span class="op" id="7372937">:=</span>&nbsp;<span class="builtinfunc" id="7372940">make</span><span class="op" id="7372944">(</span><span class="keyword" id="7372945">map</span><span class="op" id="7372948">[</span><span class="builtintype" id="7372949">string</span><span class="op" id="7372955">]</span><span class="builtintype" id="7372956">bool</span><span class="op" id="7372960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7372964">if</span>&nbsp;<span class="op" id="7372967">!</span><span class="ident" id="7372968">ctxt</span><span class="op" id="7372972">.</span><span class="ident" id="7372973">match</span><span class="op" id="7372978">(</span><span class="ident" id="7372979">tag</span><span class="op" id="7372982">,</span>&nbsp;<span class="ident" id="7372984">m</span><span class="op" id="7372985">)</span>&nbsp;<span class="op" id="7372987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7372992">t</span><span class="op" id="7372993">.</span><span class="ident" id="7372994">Errorf</span><span class="op" id="7373000">(</span><span class="string" id="7373001">&#34;%s&nbsp;context&nbsp;should&nbsp;match&nbsp;%s,&nbsp;does&nbsp;not&#34;</span><span class="op" id="7373039">,</span>&nbsp;<span class="ident" id="7373041">what</span><span class="op" id="7373045">,</span>&nbsp;<span class="ident" id="7373047">tag</span><span class="op" id="7373050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7373054">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7373058">if</span>&nbsp;<span class="op" id="7373061">!</span><span class="ident" id="7373062">reflect</span><span class="op" id="7373069">.</span><span class="ident" id="7373070">DeepEqual</span><span class="op" id="7373079">(</span><span class="ident" id="7373080">m</span><span class="op" id="7373081">,</span>&nbsp;<span class="ident" id="7373083">want</span><span class="op" id="7373087">)</span>&nbsp;<span class="op" id="7373089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7373094">t</span><span class="op" id="7373095">.</span><span class="ident" id="7373096">Errorf</span><span class="op" id="7373102">(</span><span class="string" id="7373103">&#34;%s&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7373126">,</span>&nbsp;<span class="ident" id="7373128">tag</span><span class="op" id="7373131">,</span>&nbsp;<span class="ident" id="7373133">m</span><span class="op" id="7373134">,</span>&nbsp;<span class="ident" id="7373136">want</span><span class="op" id="7373140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7373144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7373147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7373150">nomatch</span>&nbsp;<span class="op" id="7373158">:=</span>&nbsp;<span class="keyword" id="7373161">func</span><span class="op" id="7373165">(</span><span class="ident" id="7373166">tag</span>&nbsp;<span class="builtintype" id="7373170">string</span><span class="op" id="7373176">,</span>&nbsp;<span class="ident" id="7373178">want</span>&nbsp;<span class="keyword" id="7373183">map</span><span class="op" id="7373186">[</span><span class="builtintype" id="7373187">string</span><span class="op" id="7373193">]</span><span class="builtintype" id="7373194">bool</span><span class="op" id="7373198">)</span>&nbsp;<span class="op" id="7373200">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7373204">m</span>&nbsp;<span class="op" id="7373206">:=</span>&nbsp;<span class="builtinfunc" id="7373209">make</span><span class="op" id="7373213">(</span><span class="keyword" id="7373214">map</span><span class="op" id="7373217">[</span><span class="builtintype" id="7373218">string</span><span class="op" id="7373224">]</span><span class="builtintype" id="7373225">bool</span><span class="op" id="7373229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7373233">if</span>&nbsp;<span class="ident" id="7373236">ctxt</span><span class="op" id="7373240">.</span><span class="ident" id="7373241">match</span><span class="op" id="7373246">(</span><span class="ident" id="7373247">tag</span><span class="op" id="7373250">,</span>&nbsp;<span class="ident" id="7373252">m</span><span class="op" id="7373253">)</span>&nbsp;<span class="op" id="7373255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7373260">t</span><span class="op" id="7373261">.</span><span class="ident" id="7373262">Errorf</span><span class="op" id="7373268">(</span><span class="string" id="7373269">&#34;%s&nbsp;context&nbsp;should&nbsp;NOT&nbsp;match&nbsp;%s,&nbsp;does&#34;</span><span class="op" id="7373307">,</span>&nbsp;<span class="ident" id="7373309">what</span><span class="op" id="7373313">,</span>&nbsp;<span class="ident" id="7373315">tag</span><span class="op" id="7373318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7373322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7373326">if</span>&nbsp;<span class="op" id="7373329">!</span><span class="ident" id="7373330">reflect</span><span class="op" id="7373337">.</span><span class="ident" id="7373338">DeepEqual</span><span class="op" id="7373347">(</span><span class="ident" id="7373348">m</span><span class="op" id="7373349">,</span>&nbsp;<span class="ident" id="7373351">want</span><span class="op" id="7373355">)</span>&nbsp;<span class="op" id="7373357">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7373362">t</span><span class="op" id="7373363">.</span><span class="ident" id="7373364">Errorf</span><span class="op" id="7373370">(</span><span class="string" id="7373371">&#34;%s&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7373394">,</span>&nbsp;<span class="ident" id="7373396">tag</span><span class="op" id="7373399">,</span>&nbsp;<span class="ident" id="7373401">m</span><span class="op" id="7373402">,</span>&nbsp;<span class="ident" id="7373404">want</span><span class="op" id="7373408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7373412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7373415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7373419">match</span><span class="op" id="7373424">(</span><span class="ident" id="7373425">runtime</span><span class="op" id="7373432">.</span><span class="ident" id="7373433">GOOS</span><span class="op" id="7373437">+</span><span class="string" id="7373438">&#34;,&#34;</span><span class="op" id="7373441">+</span><span class="ident" id="7373442">runtime</span><span class="op" id="7373449">.</span><span class="ident" id="7373450">GOARCH</span><span class="op" id="7373456">,</span>&nbsp;<span class="keyword" id="7373458">map</span><span class="op" id="7373461">[</span><span class="builtintype" id="7373462">string</span><span class="op" id="7373468">]</span><span class="builtintype" id="7373469">bool</span><span class="op" id="7373473">{</span><span class="ident" id="7373474">runtime</span><span class="op" id="7373481">.</span><span class="ident" id="7373482">GOOS</span><span class="op" id="7373486">:</span>&nbsp;<span class="builtintype" id="7373488">true</span><span class="op" id="7373492">,</span>&nbsp;<span class="ident" id="7373494">runtime</span><span class="op" id="7373501">.</span><span class="ident" id="7373502">GOARCH</span><span class="op" id="7373508">:</span>&nbsp;<span class="builtintype" id="7373510">true</span><span class="op" id="7373514">}</span><span class="op" id="7373515">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7373518">match</span><span class="op" id="7373523">(</span><span class="ident" id="7373524">runtime</span><span class="op" id="7373531">.</span><span class="ident" id="7373532">GOOS</span><span class="op" id="7373536">+</span><span class="string" id="7373537">&#34;,&#34;</span><span class="op" id="7373540">+</span><span class="ident" id="7373541">runtime</span><span class="op" id="7373548">.</span><span class="ident" id="7373549">GOARCH</span><span class="op" id="7373555">+</span><span class="string" id="7373556">&#34;,!foo&#34;</span><span class="op" id="7373563">,</span>&nbsp;<span class="keyword" id="7373565">map</span><span class="op" id="7373568">[</span><span class="builtintype" id="7373569">string</span><span class="op" id="7373575">]</span><span class="builtintype" id="7373576">bool</span><span class="op" id="7373580">{</span><span class="ident" id="7373581">runtime</span><span class="op" id="7373588">.</span><span class="ident" id="7373589">GOOS</span><span class="op" id="7373593">:</span>&nbsp;<span class="builtintype" id="7373595">true</span><span class="op" id="7373599">,</span>&nbsp;<span class="ident" id="7373601">runtime</span><span class="op" id="7373608">.</span><span class="ident" id="7373609">GOARCH</span><span class="op" id="7373615">:</span>&nbsp;<span class="builtintype" id="7373617">true</span><span class="op" id="7373621">,</span>&nbsp;<span class="string" id="7373623">&#34;foo&#34;</span><span class="op" id="7373628">:</span>&nbsp;<span class="builtintype" id="7373630">true</span><span class="op" id="7373634">}</span><span class="op" id="7373635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7373638">nomatch</span><span class="op" id="7373645">(</span><span class="ident" id="7373646">runtime</span><span class="op" id="7373653">.</span><span class="ident" id="7373654">GOOS</span><span class="op" id="7373658">+</span><span class="string" id="7373659">&#34;,&#34;</span><span class="op" id="7373662">+</span><span class="ident" id="7373663">runtime</span><span class="op" id="7373670">.</span><span class="ident" id="7373671">GOARCH</span><span class="op" id="7373677">+</span><span class="string" id="7373678">&#34;,foo&#34;</span><span class="op" id="7373684">,</span>&nbsp;<span class="keyword" id="7373686">map</span><span class="op" id="7373689">[</span><span class="builtintype" id="7373690">string</span><span class="op" id="7373696">]</span><span class="builtintype" id="7373697">bool</span><span class="op" id="7373701">{</span><span class="ident" id="7373702">runtime</span><span class="op" id="7373709">.</span><span class="ident" id="7373710">GOOS</span><span class="op" id="7373714">:</span>&nbsp;<span class="builtintype" id="7373716">true</span><span class="op" id="7373720">,</span>&nbsp;<span class="ident" id="7373722">runtime</span><span class="op" id="7373729">.</span><span class="ident" id="7373730">GOARCH</span><span class="op" id="7373736">:</span>&nbsp;<span class="builtintype" id="7373738">true</span><span class="op" id="7373742">,</span>&nbsp;<span class="string" id="7373744">&#34;foo&#34;</span><span class="op" id="7373749">:</span>&nbsp;<span class="builtintype" id="7373751">true</span><span class="op" id="7373755">}</span><span class="op" id="7373756">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7373760">what</span>&nbsp;<span class="op" id="7373765">=</span>&nbsp;<span class="string" id="7373767">&#34;modified&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7373779">ctxt</span><span class="op" id="7373783">.</span><span class="ident" id="7373784">BuildTags</span>&nbsp;<span class="op" id="7373794">=</span>&nbsp;<span class="op" id="7373796">[</span><span class="op" id="7373797">]</span><span class="builtintype" id="7373798">string</span><span class="op" id="7373804">{</span><span class="string" id="7373805">&#34;foo&#34;</span><span class="op" id="7373810">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7373813">match</span><span class="op" id="7373818">(</span><span class="ident" id="7373819">runtime</span><span class="op" id="7373826">.</span><span class="ident" id="7373827">GOOS</span><span class="op" id="7373831">+</span><span class="string" id="7373832">&#34;,&#34;</span><span class="op" id="7373835">+</span><span class="ident" id="7373836">runtime</span><span class="op" id="7373843">.</span><span class="ident" id="7373844">GOARCH</span><span class="op" id="7373850">,</span>&nbsp;<span class="keyword" id="7373852">map</span><span class="op" id="7373855">[</span><span class="builtintype" id="7373856">string</span><span class="op" id="7373862">]</span><span class="builtintype" id="7373863">bool</span><span class="op" id="7373867">{</span><span class="ident" id="7373868">runtime</span><span class="op" id="7373875">.</span><span class="ident" id="7373876">GOOS</span><span class="op" id="7373880">:</span>&nbsp;<span class="builtintype" id="7373882">true</span><span class="op" id="7373886">,</span>&nbsp;<span class="ident" id="7373888">runtime</span><span class="op" id="7373895">.</span><span class="ident" id="7373896">GOARCH</span><span class="op" id="7373902">:</span>&nbsp;<span class="builtintype" id="7373904">true</span><span class="op" id="7373908">}</span><span class="op" id="7373909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7373912">match</span><span class="op" id="7373917">(</span><span class="ident" id="7373918">runtime</span><span class="op" id="7373925">.</span><span class="ident" id="7373926">GOOS</span><span class="op" id="7373930">+</span><span class="string" id="7373931">&#34;,&#34;</span><span class="op" id="7373934">+</span><span class="ident" id="7373935">runtime</span><span class="op" id="7373942">.</span><span class="ident" id="7373943">GOARCH</span><span class="op" id="7373949">+</span><span class="string" id="7373950">&#34;,foo&#34;</span><span class="op" id="7373956">,</span>&nbsp;<span class="keyword" id="7373958">map</span><span class="op" id="7373961">[</span><span class="builtintype" id="7373962">string</span><span class="op" id="7373968">]</span><span class="builtintype" id="7373969">bool</span><span class="op" id="7373973">{</span><span class="ident" id="7373974">runtime</span><span class="op" id="7373981">.</span><span class="ident" id="7373982">GOOS</span><span class="op" id="7373986">:</span>&nbsp;<span class="builtintype" id="7373988">true</span><span class="op" id="7373992">,</span>&nbsp;<span class="ident" id="7373994">runtime</span><span class="op" id="7374001">.</span><span class="ident" id="7374002">GOARCH</span><span class="op" id="7374008">:</span>&nbsp;<span class="builtintype" id="7374010">true</span><span class="op" id="7374014">,</span>&nbsp;<span class="string" id="7374016">&#34;foo&#34;</span><span class="op" id="7374021">:</span>&nbsp;<span class="builtintype" id="7374023">true</span><span class="op" id="7374027">}</span><span class="op" id="7374028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7374031">nomatch</span><span class="op" id="7374038">(</span><span class="ident" id="7374039">runtime</span><span class="op" id="7374046">.</span><span class="ident" id="7374047">GOOS</span><span class="op" id="7374051">+</span><span class="string" id="7374052">&#34;,&#34;</span><span class="op" id="7374055">+</span><span class="ident" id="7374056">runtime</span><span class="op" id="7374063">.</span><span class="ident" id="7374064">GOARCH</span><span class="op" id="7374070">+</span><span class="string" id="7374071">&#34;,!foo&#34;</span><span class="op" id="7374078">,</span>&nbsp;<span class="keyword" id="7374080">map</span><span class="op" id="7374083">[</span><span class="builtintype" id="7374084">string</span><span class="op" id="7374090">]</span><span class="builtintype" id="7374091">bool</span><span class="op" id="7374095">{</span><span class="ident" id="7374096">runtime</span><span class="op" id="7374103">.</span><span class="ident" id="7374104">GOOS</span><span class="op" id="7374108">:</span>&nbsp;<span class="builtintype" id="7374110">true</span><span class="op" id="7374114">,</span>&nbsp;<span class="ident" id="7374116">runtime</span><span class="op" id="7374123">.</span><span class="ident" id="7374124">GOARCH</span><span class="op" id="7374130">:</span>&nbsp;<span class="builtintype" id="7374132">true</span><span class="op" id="7374136">,</span>&nbsp;<span class="string" id="7374138">&#34;foo&#34;</span><span class="op" id="7374143">:</span>&nbsp;<span class="builtintype" id="7374145">true</span><span class="op" id="7374149">}</span><span class="op" id="7374150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7374153">match</span><span class="op" id="7374158">(</span><span class="ident" id="7374159">runtime</span><span class="op" id="7374166">.</span><span class="ident" id="7374167">GOOS</span><span class="op" id="7374171">+</span><span class="string" id="7374172">&#34;,&#34;</span><span class="op" id="7374175">+</span><span class="ident" id="7374176">runtime</span><span class="op" id="7374183">.</span><span class="ident" id="7374184">GOARCH</span><span class="op" id="7374190">+</span><span class="string" id="7374191">&#34;,!bar&#34;</span><span class="op" id="7374198">,</span>&nbsp;<span class="keyword" id="7374200">map</span><span class="op" id="7374203">[</span><span class="builtintype" id="7374204">string</span><span class="op" id="7374210">]</span><span class="builtintype" id="7374211">bool</span><span class="op" id="7374215">{</span><span class="ident" id="7374216">runtime</span><span class="op" id="7374223">.</span><span class="ident" id="7374224">GOOS</span><span class="op" id="7374228">:</span>&nbsp;<span class="builtintype" id="7374230">true</span><span class="op" id="7374234">,</span>&nbsp;<span class="ident" id="7374236">runtime</span><span class="op" id="7374243">.</span><span class="ident" id="7374244">GOARCH</span><span class="op" id="7374250">:</span>&nbsp;<span class="builtintype" id="7374252">true</span><span class="op" id="7374256">,</span>&nbsp;<span class="string" id="7374258">&#34;bar&#34;</span><span class="op" id="7374263">:</span>&nbsp;<span class="builtintype" id="7374265">true</span><span class="op" id="7374269">}</span><span class="op" id="7374270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7374273">nomatch</span><span class="op" id="7374280">(</span><span class="ident" id="7374281">runtime</span><span class="op" id="7374288">.</span><span class="ident" id="7374289">GOOS</span><span class="op" id="7374293">+</span><span class="string" id="7374294">&#34;,&#34;</span><span class="op" id="7374297">+</span><span class="ident" id="7374298">runtime</span><span class="op" id="7374305">.</span><span class="ident" id="7374306">GOARCH</span><span class="op" id="7374312">+</span><span class="string" id="7374313">&#34;,bar&#34;</span><span class="op" id="7374319">,</span>&nbsp;<span class="keyword" id="7374321">map</span><span class="op" id="7374324">[</span><span class="builtintype" id="7374325">string</span><span class="op" id="7374331">]</span><span class="builtintype" id="7374332">bool</span><span class="op" id="7374336">{</span><span class="ident" id="7374337">runtime</span><span class="op" id="7374344">.</span><span class="ident" id="7374345">GOOS</span><span class="op" id="7374349">:</span>&nbsp;<span class="builtintype" id="7374351">true</span><span class="op" id="7374355">,</span>&nbsp;<span class="ident" id="7374357">runtime</span><span class="op" id="7374364">.</span><span class="ident" id="7374365">GOARCH</span><span class="op" id="7374371">:</span>&nbsp;<span class="builtintype" id="7374373">true</span><span class="op" id="7374377">,</span>&nbsp;<span class="string" id="7374379">&#34;bar&#34;</span><span class="op" id="7374384">:</span>&nbsp;<span class="builtintype" id="7374386">true</span><span class="op" id="7374390">}</span><span class="op" id="7374391">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7374394">nomatch</span><span class="op" id="7374401">(</span><span class="string" id="7374402">&#34;!&#34;</span><span class="op" id="7374405">,</span>&nbsp;<span class="keyword" id="7374407">map</span><span class="op" id="7374410">[</span><span class="builtintype" id="7374411">string</span><span class="op" id="7374417">]</span><span class="builtintype" id="7374418">bool</span><span class="op" id="7374422">{</span><span class="op" id="7374423">}</span><span class="op" id="7374424">)</span><br>
<span class="lineno"></span><span class="op" id="7374426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7374429">func</span>&nbsp;<span class="ident" id="7374434">TestDotSlashImport</span><span class="op" id="7374452">(</span><span class="ident" id="7374453">t</span>&nbsp;<span class="op" id="7374455">*</span><span class="ident" id="7374456">testing</span><span class="op" id="7374463">.</span><span class="ident" id="7374464">T</span><span class="op" id="7374465">)</span>&nbsp;<span class="op" id="7374467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7374470">p</span><span class="op" id="7374471">,</span>&nbsp;<span class="ident" id="7374473">err</span>&nbsp;<span class="op" id="7374477">:=</span>&nbsp;<span class="ident" id="7374480">ImportDir</span><span class="op" id="7374489">(</span><span class="string" id="7374490">&#34;testdata/other&#34;</span><span class="op" id="7374506">,</span>&nbsp;<span class="num" id="7374508">0</span><span class="op" id="7374509">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7374512">if</span>&nbsp;<span class="ident" id="7374515">err</span>&nbsp;<span class="op" id="7374519">!=</span>&nbsp;<span class="builtintype" id="7374522">nil</span>&nbsp;<span class="op" id="7374526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7374530">t</span><span class="op" id="7374531">.</span><span class="ident" id="7374532">Fatal</span><span class="op" id="7374537">(</span><span class="ident" id="7374538">err</span><span class="op" id="7374541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7374544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7374547">if</span>&nbsp;<span class="builtinfunc" id="7374550">len</span><span class="op" id="7374553">(</span><span class="ident" id="7374554">p</span><span class="op" id="7374555">.</span><span class="ident" id="7374556">Imports</span><span class="op" id="7374563">)</span>&nbsp;<span class="op" id="7374565">!=</span>&nbsp;<span class="num" id="7374568">1</span>&nbsp;<span class="op" id="7374570">||</span>&nbsp;<span class="ident" id="7374573">p</span><span class="op" id="7374574">.</span><span class="ident" id="7374575">Imports</span><span class="op" id="7374582">[</span><span class="num" id="7374583">0</span><span class="op" id="7374584">]</span>&nbsp;<span class="op" id="7374586">!=</span>&nbsp;<span class="string" id="7374589">&#34;./file&#34;</span>&nbsp;<span class="op" id="7374598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7374602">t</span><span class="op" id="7374603">.</span><span class="ident" id="7374604">Fatalf</span><span class="op" id="7374610">(</span><span class="string" id="7374611">&#34;testdata/other:&nbsp;Imports=%v,&nbsp;want&nbsp;[./file]&#34;</span><span class="op" id="7374654">,</span>&nbsp;<span class="ident" id="7374656">p</span><span class="op" id="7374657">.</span><span class="ident" id="7374658">Imports</span><span class="op" id="7374665">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7374668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7374672">p1</span><span class="op" id="7374674">,</span>&nbsp;<span class="ident" id="7374676">err</span>&nbsp;<span class="op" id="7374680">:=</span>&nbsp;<span class="ident" id="7374683">Import</span><span class="op" id="7374689">(</span><span class="string" id="7374690">&#34;./file&#34;</span><span class="op" id="7374698">,</span>&nbsp;<span class="string" id="7374700">&#34;testdata/other&#34;</span><span class="op" id="7374716">,</span>&nbsp;<span class="num" id="7374718">0</span><span class="op" id="7374719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7374722">if</span>&nbsp;<span class="ident" id="7374725">err</span>&nbsp;<span class="op" id="7374729">!=</span>&nbsp;<span class="builtintype" id="7374732">nil</span>&nbsp;<span class="op" id="7374736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7374740">t</span><span class="op" id="7374741">.</span><span class="ident" id="7374742">Fatal</span><span class="op" id="7374747">(</span><span class="ident" id="7374748">err</span><span class="op" id="7374751">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7374754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7374757">if</span>&nbsp;<span class="ident" id="7374760">p1</span><span class="op" id="7374762">.</span><span class="ident" id="7374763">Name</span>&nbsp;<span class="op" id="7374768">!=</span>&nbsp;<span class="string" id="7374771">&#34;file&#34;</span>&nbsp;<span class="op" id="7374778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7374782">t</span><span class="op" id="7374783">.</span><span class="ident" id="7374784">Fatalf</span><span class="op" id="7374790">(</span><span class="string" id="7374791">&#34;./file:&nbsp;Name=%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7374817">,</span>&nbsp;<span class="ident" id="7374819">p1</span><span class="op" id="7374821">.</span><span class="ident" id="7374822">Name</span><span class="op" id="7374826">,</span>&nbsp;<span class="string" id="7374828">&#34;file&#34;</span><span class="op" id="7374834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7374837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7374840">dir</span>&nbsp;<span class="op" id="7374844">:=</span>&nbsp;<span class="ident" id="7374847">filepath</span><span class="op" id="7374855">.</span><span class="ident" id="7374856">Clean</span><span class="op" id="7374861">(</span><span class="string" id="7374862">&#34;testdata/other/file&#34;</span><span class="op" id="7374883">)</span>&nbsp;<span class="comment" id="7374885">//&nbsp;Clean&nbsp;to&nbsp;use&nbsp;\&nbsp;on&nbsp;Windows</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7374915">if</span>&nbsp;<span class="ident" id="7374918">p1</span><span class="op" id="7374920">.</span><span class="ident" id="7374921">Dir</span>&nbsp;<span class="op" id="7374925">!=</span>&nbsp;<span class="ident" id="7374928">dir</span>&nbsp;<span class="op" id="7374932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7374936">t</span><span class="op" id="7374937">.</span><span class="ident" id="7374938">Fatalf</span><span class="op" id="7374944">(</span><span class="string" id="7374945">&#34;./file:&nbsp;Dir=%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7374970">,</span>&nbsp;<span class="ident" id="7374972">p1</span><span class="op" id="7374974">.</span><span class="ident" id="7374975">Name</span><span class="op" id="7374979">,</span>&nbsp;<span class="ident" id="7374981">dir</span><span class="op" id="7374984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7374987">}</span><br>
<span class="lineno"></span><span class="op" id="7374989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="7374992">func</span>&nbsp;<span class="ident" id="7374997">TestEmptyImport</span><span class="op" id="7375012">(</span><span class="ident" id="7375013">t</span>&nbsp;<span class="op" id="7375015">*</span><span class="ident" id="7375016">testing</span><span class="op" id="7375023">.</span><span class="ident" id="7375024">T</span><span class="op" id="7375025">)</span>&nbsp;<span class="op" id="7375027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7375030">p</span><span class="op" id="7375031">,</span>&nbsp;<span class="ident" id="7375033">err</span>&nbsp;<span class="op" id="7375037">:=</span>&nbsp;<span class="ident" id="7375040">Import</span><span class="op" id="7375046">(</span><span class="string" id="7375047">&#34;&#34;</span><span class="op" id="7375049">,</span>&nbsp;<span class="ident" id="7375051">Default</span><span class="op" id="7375058">.</span><span class="ident" id="7375059">GOROOT</span><span class="op" id="7375065">,</span>&nbsp;<span class="ident" id="7375067">FindOnly</span><span class="op" id="7375075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7375078">if</span>&nbsp;<span class="ident" id="7375081">err</span>&nbsp;<span class="op" id="7375085">==</span>&nbsp;<span class="builtintype" id="7375088">nil</span>&nbsp;<span class="op" id="7375092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7375096">t</span><span class="op" id="7375097">.</span><span class="ident" id="7375098">Fatal</span><span class="op" id="7375103">(</span><span class="string" id="7375104">`Import(&#34;&#34;)&nbsp;returned&nbsp;nil&nbsp;error.`</span><span class="op" id="7375136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7375139">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7375142">if</span>&nbsp;<span class="ident" id="7375145">p</span>&nbsp;<span class="op" id="7375147">==</span>&nbsp;<span class="builtintype" id="7375150">nil</span>&nbsp;<span class="op" id="7375154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7375158">t</span><span class="op" id="7375159">.</span><span class="ident" id="7375160">Fatal</span><span class="op" id="7375165">(</span><span class="string" id="7375166">`Import(&#34;&#34;)&nbsp;returned&nbsp;nil&nbsp;package.`</span><span class="op" id="7375200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7375203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7375206">if</span>&nbsp;<span class="ident" id="7375209">p</span><span class="op" id="7375210">.</span><span class="ident" id="7375211">ImportPath</span>&nbsp;<span class="op" id="7375222">!=</span>&nbsp;<span class="string" id="7375225">&#34;&#34;</span>&nbsp;<span class="op" id="7375228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7375232">t</span><span class="op" id="7375233">.</span><span class="ident" id="7375234">Fatalf</span><span class="op" id="7375240">(</span><span class="string" id="7375241">&#34;ImportPath=%q,&nbsp;want&nbsp;%q.&#34;</span><span class="op" id="7375266">,</span>&nbsp;<span class="ident" id="7375268">p</span><span class="op" id="7375269">.</span><span class="ident" id="7375270">ImportPath</span><span class="op" id="7375280">,</span>&nbsp;<span class="string" id="7375282">&#34;&#34;</span><span class="op" id="7375284">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7375287">}</span><br>
<span class="lineno"></span><span class="op" id="7375289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7375292">func</span>&nbsp;<span class="ident" id="7375297">TestEmptyFolderImport</span><span class="op" id="7375318">(</span><span class="ident" id="7375319">t</span>&nbsp;<span class="op" id="7375321">*</span><span class="ident" id="7375322">testing</span><span class="op" id="7375329">.</span><span class="ident" id="7375330">T</span><span class="op" id="7375331">)</span>&nbsp;<span class="op" id="7375333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7375336">_</span><span class="op" id="7375337">,</span>&nbsp;<span class="ident" id="7375339">err</span>&nbsp;<span class="op" id="7375343">:=</span>&nbsp;<span class="ident" id="7375346">Import</span><span class="op" id="7375352">(</span><span class="string" id="7375353">&#34;.&#34;</span><span class="op" id="7375356">,</span>&nbsp;<span class="string" id="7375358">&#34;testdata/empty&#34;</span><span class="op" id="7375374">,</span>&nbsp;<span class="num" id="7375376">0</span><span class="op" id="7375377">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7375380">if</span>&nbsp;<span class="ident" id="7375383">_</span><span class="op" id="7375384">,</span>&nbsp;<span class="ident" id="7375386">ok</span>&nbsp;<span class="op" id="7375389">:=</span>&nbsp;<span class="ident" id="7375392">err</span><span class="op" id="7375395">.</span><span class="op" id="7375396">(</span><span class="op" id="7375397">*</span><span class="ident" id="7375398">NoGoError</span><span class="op" id="7375407">)</span><span class="op" id="7375408">;</span>&nbsp;<span class="op" id="7375410">!</span><span class="ident" id="7375411">ok</span>&nbsp;<span class="op" id="7375414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7375418">t</span><span class="op" id="7375419">.</span><span class="ident" id="7375420">Fatal</span><span class="op" id="7375425">(</span><span class="string" id="7375426">`Import(&#34;testdata/empty&#34;)&nbsp;did&nbsp;not&nbsp;return&nbsp;NoGoError.`</span><span class="op" id="7375478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7375481">}</span><br>
<span class="lineno"></span><span class="op" id="7375483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="7375486">func</span>&nbsp;<span class="ident" id="7375491">TestMultiplePackageImport</span><span class="op" id="7375516">(</span><span class="ident" id="7375517">t</span>&nbsp;<span class="op" id="7375519">*</span><span class="ident" id="7375520">testing</span><span class="op" id="7375527">.</span><span class="ident" id="7375528">T</span><span class="op" id="7375529">)</span>&nbsp;<span class="op" id="7375531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7375534">_</span><span class="op" id="7375535">,</span>&nbsp;<span class="ident" id="7375537">err</span>&nbsp;<span class="op" id="7375541">:=</span>&nbsp;<span class="ident" id="7375544">Import</span><span class="op" id="7375550">(</span><span class="string" id="7375551">&#34;.&#34;</span><span class="op" id="7375554">,</span>&nbsp;<span class="string" id="7375556">&#34;testdata/multi&#34;</span><span class="op" id="7375572">,</span>&nbsp;<span class="num" id="7375574">0</span><span class="op" id="7375575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7375578">if</span>&nbsp;<span class="ident" id="7375581">_</span><span class="op" id="7375582">,</span>&nbsp;<span class="ident" id="7375584">ok</span>&nbsp;<span class="op" id="7375587">:=</span>&nbsp;<span class="ident" id="7375590">err</span><span class="op" id="7375593">.</span><span class="op" id="7375594">(</span><span class="op" id="7375595">*</span><span class="ident" id="7375596">MultiplePackageError</span><span class="op" id="7375616">)</span><span class="op" id="7375617">;</span>&nbsp;<span class="op" id="7375619">!</span><span class="ident" id="7375620">ok</span>&nbsp;<span class="op" id="7375623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7375627">t</span><span class="op" id="7375628">.</span><span class="ident" id="7375629">Fatal</span><span class="op" id="7375634">(</span><span class="string" id="7375635">`Import(&#34;testdata/multi&#34;)&nbsp;did&nbsp;not&nbsp;return&nbsp;MultiplePackageError.`</span><span class="op" id="7375698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7375701">}</span><br>
<span class="lineno">100</span><span class="op" id="7375703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7375706">func</span>&nbsp;<span class="ident" id="7375711">TestLocalDirectory</span><span class="op" id="7375729">(</span><span class="ident" id="7375730">t</span>&nbsp;<span class="op" id="7375732">*</span><span class="ident" id="7375733">testing</span><span class="op" id="7375740">.</span><span class="ident" id="7375741">T</span><span class="op" id="7375742">)</span>&nbsp;<span class="op" id="7375744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7375747">cwd</span><span class="op" id="7375750">,</span>&nbsp;<span class="ident" id="7375752">err</span>&nbsp;<span class="op" id="7375756">:=</span>&nbsp;<span class="ident" id="7375759">os</span><span class="op" id="7375761">.</span><span class="ident" id="7375762">Getwd</span><span class="op" id="7375767">(</span><span class="op" id="7375768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7375771">if</span>&nbsp;<span class="ident" id="7375774">err</span>&nbsp;<span class="op" id="7375778">!=</span>&nbsp;<span class="builtintype" id="7375781">nil</span>&nbsp;<span class="op" id="7375785">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7375789">t</span><span class="op" id="7375790">.</span><span class="ident" id="7375791">Fatal</span><span class="op" id="7375796">(</span><span class="ident" id="7375797">err</span><span class="op" id="7375800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7375803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7375807">p</span><span class="op" id="7375808">,</span>&nbsp;<span class="ident" id="7375810">err</span>&nbsp;<span class="op" id="7375814">:=</span>&nbsp;<span class="ident" id="7375817">ImportDir</span><span class="op" id="7375826">(</span><span class="ident" id="7375827">cwd</span><span class="op" id="7375830">,</span>&nbsp;<span class="num" id="7375832">0</span><span class="op" id="7375833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7375836">if</span>&nbsp;<span class="ident" id="7375839">err</span>&nbsp;<span class="op" id="7375843">!=</span>&nbsp;<span class="builtintype" id="7375846">nil</span>&nbsp;<span class="op" id="7375850">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7375854">t</span><span class="op" id="7375855">.</span><span class="ident" id="7375856">Fatal</span><span class="op" id="7375861">(</span><span class="ident" id="7375862">err</span><span class="op" id="7375865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7375868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7375871">if</span>&nbsp;<span class="ident" id="7375874">p</span><span class="op" id="7375875">.</span><span class="ident" id="7375876">ImportPath</span>&nbsp;<span class="op" id="7375887">!=</span>&nbsp;<span class="string" id="7375890">&#34;go/build&#34;</span>&nbsp;<span class="op" id="7375901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7375905">t</span><span class="op" id="7375906">.</span><span class="ident" id="7375907">Fatalf</span><span class="op" id="7375913">(</span><span class="string" id="7375914">&#34;ImportPath=%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7375938">,</span>&nbsp;<span class="ident" id="7375940">p</span><span class="op" id="7375941">.</span><span class="ident" id="7375942">ImportPath</span><span class="op" id="7375952">,</span>&nbsp;<span class="string" id="7375954">&#34;go/build&#34;</span><span class="op" id="7375964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7375967">}</span><br>
<span class="lineno">115</span><span class="op" id="7375969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7375972">func</span>&nbsp;<span class="ident" id="7375977">TestShouldBuild</span><span class="op" id="7375992">(</span><span class="ident" id="7375993">t</span>&nbsp;<span class="op" id="7375995">*</span><span class="ident" id="7375996">testing</span><span class="op" id="7376003">.</span><span class="ident" id="7376004">T</span><span class="op" id="7376005">)</span>&nbsp;<span class="op" id="7376007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7376010">const</span>&nbsp;<span class="ident" id="7376016">file1</span>&nbsp;<span class="op" id="7376022">=</span>&nbsp;<span class="string" id="7376024">&#34;//&nbsp;+build&nbsp;tag1\n\n&#34;</span>&nbsp;<span class="op" id="7376045">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7376049">&#34;package&nbsp;main\n&#34;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7376067">want1</span>&nbsp;<span class="op" id="7376073">:=</span>&nbsp;<span class="keyword" id="7376076">map</span><span class="op" id="7376079">[</span><span class="builtintype" id="7376080">string</span><span class="op" id="7376086">]</span><span class="builtintype" id="7376087">bool</span><span class="op" id="7376091">{</span><span class="string" id="7376092">&#34;tag1&#34;</span><span class="op" id="7376098">:</span>&nbsp;<span class="builtintype" id="7376100">true</span><span class="op" id="7376104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7376108">const</span>&nbsp;<span class="ident" id="7376114">file2</span>&nbsp;<span class="op" id="7376120">=</span>&nbsp;<span class="string" id="7376122">&#34;//&nbsp;+build&nbsp;cgo\n\n&#34;</span>&nbsp;<span class="op" id="7376142">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7376146">&#34;//&nbsp;This&nbsp;package&nbsp;implements&nbsp;parsing&nbsp;of&nbsp;tags&nbsp;like\n&#34;</span>&nbsp;<span class="op" id="7376198">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7376202">&#34;//&nbsp;+build&nbsp;tag1\n&#34;</span>&nbsp;<span class="op" id="7376221">+</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7376225">&#34;package&nbsp;build&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7376242">want2</span>&nbsp;<span class="op" id="7376248">:=</span>&nbsp;<span class="keyword" id="7376251">map</span><span class="op" id="7376254">[</span><span class="builtintype" id="7376255">string</span><span class="op" id="7376261">]</span><span class="builtintype" id="7376262">bool</span><span class="op" id="7376266">{</span><span class="string" id="7376267">&#34;cgo&#34;</span><span class="op" id="7376272">:</span>&nbsp;<span class="builtintype" id="7376274">true</span><span class="op" id="7376278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7376282">const</span>&nbsp;<span class="ident" id="7376288">file3</span>&nbsp;<span class="op" id="7376294">=</span>&nbsp;<span class="string" id="7376296">&#34;//&nbsp;Copyright&nbsp;The&nbsp;Go&nbsp;Authors.\n\n&#34;</span>&nbsp;<span class="op" id="7376331">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7376335">&#34;package&nbsp;build\n\n&#34;</span>&nbsp;<span class="op" id="7376355">+</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7376359">&#34;//&nbsp;shouldBuild&nbsp;checks&nbsp;tags&nbsp;given&nbsp;by&nbsp;lines&nbsp;of&nbsp;the&nbsp;form\n&#34;</span>&nbsp;<span class="op" id="7376417">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7376421">&#34;//&nbsp;+build&nbsp;tag\n&#34;</span>&nbsp;<span class="op" id="7376439">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7376443">&#34;func&nbsp;shouldBuild(content&nbsp;[]byte)\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7376481">want3</span>&nbsp;<span class="op" id="7376487">:=</span>&nbsp;<span class="keyword" id="7376490">map</span><span class="op" id="7376493">[</span><span class="builtintype" id="7376494">string</span><span class="op" id="7376500">]</span><span class="builtintype" id="7376501">bool</span><span class="op" id="7376505">{</span><span class="op" id="7376506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7376510">ctx</span>&nbsp;<span class="op" id="7376514">:=</span>&nbsp;<span class="op" id="7376517">&amp;</span><span class="ident" id="7376518">Context</span><span class="op" id="7376525">{</span><span class="ident" id="7376526">BuildTags</span><span class="op" id="7376535">:</span>&nbsp;<span class="op" id="7376537">[</span><span class="op" id="7376538">]</span><span class="builtintype" id="7376539">string</span><span class="op" id="7376545">{</span><span class="string" id="7376546">&#34;tag1&#34;</span><span class="op" id="7376552">}</span><span class="op" id="7376553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7376556">m</span>&nbsp;<span class="op" id="7376558">:=</span>&nbsp;<span class="keyword" id="7376561">map</span><span class="op" id="7376564">[</span><span class="builtintype" id="7376565">string</span><span class="op" id="7376571">]</span><span class="builtintype" id="7376572">bool</span><span class="op" id="7376576">{</span><span class="op" id="7376577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7376580">if</span>&nbsp;<span class="op" id="7376583">!</span><span class="ident" id="7376584">ctx</span><span class="op" id="7376587">.</span><span class="ident" id="7376588">shouldBuild</span><span class="op" id="7376599">(</span><span class="op" id="7376600">[</span><span class="op" id="7376601">]</span><span class="builtintype" id="7376602">byte</span><span class="op" id="7376606">(</span><span class="ident" id="7376607">file1</span><span class="op" id="7376612">)</span><span class="op" id="7376613">,</span>&nbsp;<span class="ident" id="7376615">m</span><span class="op" id="7376616">)</span>&nbsp;<span class="op" id="7376618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7376622">t</span><span class="op" id="7376623">.</span><span class="ident" id="7376624">Errorf</span><span class="op" id="7376630">(</span><span class="string" id="7376631">&#34;shouldBuild(file1)&nbsp;=&nbsp;false,&nbsp;want&nbsp;true&#34;</span><span class="op" id="7376670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7376673">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7376676">if</span>&nbsp;<span class="op" id="7376679">!</span><span class="ident" id="7376680">reflect</span><span class="op" id="7376687">.</span><span class="ident" id="7376688">DeepEqual</span><span class="op" id="7376697">(</span><span class="ident" id="7376698">m</span><span class="op" id="7376699">,</span>&nbsp;<span class="ident" id="7376701">want1</span><span class="op" id="7376706">)</span>&nbsp;<span class="op" id="7376708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7376712">t</span><span class="op" id="7376713">.</span><span class="ident" id="7376714">Errorf</span><span class="op" id="7376720">(</span><span class="string" id="7376721">&#34;shoudBuild(file1)&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7376759">,</span>&nbsp;<span class="ident" id="7376761">m</span><span class="op" id="7376762">,</span>&nbsp;<span class="ident" id="7376764">want1</span><span class="op" id="7376769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7376772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7376776">m</span>&nbsp;<span class="op" id="7376778">=</span>&nbsp;<span class="keyword" id="7376780">map</span><span class="op" id="7376783">[</span><span class="builtintype" id="7376784">string</span><span class="op" id="7376790">]</span><span class="builtintype" id="7376791">bool</span><span class="op" id="7376795">{</span><span class="op" id="7376796">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7376799">if</span>&nbsp;<span class="ident" id="7376802">ctx</span><span class="op" id="7376805">.</span><span class="ident" id="7376806">shouldBuild</span><span class="op" id="7376817">(</span><span class="op" id="7376818">[</span><span class="op" id="7376819">]</span><span class="builtintype" id="7376820">byte</span><span class="op" id="7376824">(</span><span class="ident" id="7376825">file2</span><span class="op" id="7376830">)</span><span class="op" id="7376831">,</span>&nbsp;<span class="ident" id="7376833">m</span><span class="op" id="7376834">)</span>&nbsp;<span class="op" id="7376836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7376840">t</span><span class="op" id="7376841">.</span><span class="ident" id="7376842">Errorf</span><span class="op" id="7376848">(</span><span class="string" id="7376849">&#34;shouldBuild(file2)&nbsp;=&nbsp;true,&nbsp;want&nbsp;fakse&#34;</span><span class="op" id="7376888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7376891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7376894">if</span>&nbsp;<span class="op" id="7376897">!</span><span class="ident" id="7376898">reflect</span><span class="op" id="7376905">.</span><span class="ident" id="7376906">DeepEqual</span><span class="op" id="7376915">(</span><span class="ident" id="7376916">m</span><span class="op" id="7376917">,</span>&nbsp;<span class="ident" id="7376919">want2</span><span class="op" id="7376924">)</span>&nbsp;<span class="op" id="7376926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7376930">t</span><span class="op" id="7376931">.</span><span class="ident" id="7376932">Errorf</span><span class="op" id="7376938">(</span><span class="string" id="7376939">&#34;shoudBuild(file2)&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7376977">,</span>&nbsp;<span class="ident" id="7376979">m</span><span class="op" id="7376980">,</span>&nbsp;<span class="ident" id="7376982">want2</span><span class="op" id="7376987">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7376990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7376994">m</span>&nbsp;<span class="op" id="7376996">=</span>&nbsp;<span class="keyword" id="7376998">map</span><span class="op" id="7377001">[</span><span class="builtintype" id="7377002">string</span><span class="op" id="7377008">]</span><span class="builtintype" id="7377009">bool</span><span class="op" id="7377013">{</span><span class="op" id="7377014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7377017">ctx</span>&nbsp;<span class="op" id="7377021">=</span>&nbsp;<span class="op" id="7377023">&amp;</span><span class="ident" id="7377024">Context</span><span class="op" id="7377031">{</span><span class="ident" id="7377032">BuildTags</span><span class="op" id="7377041">:</span>&nbsp;<span class="builtintype" id="7377043">nil</span><span class="op" id="7377046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7377049">if</span>&nbsp;<span class="op" id="7377052">!</span><span class="ident" id="7377053">ctx</span><span class="op" id="7377056">.</span><span class="ident" id="7377057">shouldBuild</span><span class="op" id="7377068">(</span><span class="op" id="7377069">[</span><span class="op" id="7377070">]</span><span class="builtintype" id="7377071">byte</span><span class="op" id="7377075">(</span><span class="ident" id="7377076">file3</span><span class="op" id="7377081">)</span><span class="op" id="7377082">,</span>&nbsp;<span class="ident" id="7377084">m</span><span class="op" id="7377085">)</span>&nbsp;<span class="op" id="7377087">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7377091">t</span><span class="op" id="7377092">.</span><span class="ident" id="7377093">Errorf</span><span class="op" id="7377099">(</span><span class="string" id="7377100">&#34;shouldBuild(file3)&nbsp;=&nbsp;false,&nbsp;want&nbsp;true&#34;</span><span class="op" id="7377139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7377142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7377145">if</span>&nbsp;<span class="op" id="7377148">!</span><span class="ident" id="7377149">reflect</span><span class="op" id="7377156">.</span><span class="ident" id="7377157">DeepEqual</span><span class="op" id="7377166">(</span><span class="ident" id="7377167">m</span><span class="op" id="7377168">,</span>&nbsp;<span class="ident" id="7377170">want3</span><span class="op" id="7377175">)</span>&nbsp;<span class="op" id="7377177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7377181">t</span><span class="op" id="7377182">.</span><span class="ident" id="7377183">Errorf</span><span class="op" id="7377189">(</span><span class="string" id="7377190">&#34;shoudBuild(file3)&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7377228">,</span>&nbsp;<span class="ident" id="7377230">m</span><span class="op" id="7377231">,</span>&nbsp;<span class="ident" id="7377233">want3</span><span class="op" id="7377238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7377241">}</span><br>
<span class="lineno">160</span><span class="op" id="7377243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7377246">type</span>&nbsp;<span class="ident" id="7377251">readNopCloser</span>&nbsp;<span class="keyword" id="7377265">struct</span>&nbsp;<span class="op" id="7377272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7377275">io</span><span class="op" id="7377277">.</span><span class="ident" id="7377278">Reader</span><br>
<span class="lineno"></span><span class="op" id="7377285">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="7377288">func</span>&nbsp;<span class="op" id="7377293">(</span><span class="ident" id="7377294">r</span>&nbsp;<span class="ident" id="7377296">readNopCloser</span><span class="op" id="7377309">)</span>&nbsp;<span class="ident" id="7377311">Close</span><span class="op" id="7377316">(</span><span class="op" id="7377317">)</span>&nbsp;<span class="builtintype" id="7377319">error</span>&nbsp;<span class="op" id="7377325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7377328">return</span>&nbsp;<span class="builtintype" id="7377335">nil</span><br>
<span class="lineno"></span><span class="op" id="7377339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="7377342">var</span>&nbsp;<span class="op" id="7377346">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7377349">ctxtP9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7377361">=</span>&nbsp;<span class="ident" id="7377363">Context</span><span class="op" id="7377370">{</span><span class="ident" id="7377371">GOARCH</span><span class="op" id="7377377">:</span>&nbsp;<span class="string" id="7377379">&#34;arm&#34;</span><span class="op" id="7377384">,</span>&nbsp;<span class="ident" id="7377386">GOOS</span><span class="op" id="7377390">:</span>&nbsp;<span class="string" id="7377392">&#34;plan9&#34;</span><span class="op" id="7377399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7377402">ctxtAndroid</span>&nbsp;<span class="op" id="7377414">=</span>&nbsp;<span class="ident" id="7377416">Context</span><span class="op" id="7377423">{</span><span class="ident" id="7377424">GOARCH</span><span class="op" id="7377430">:</span>&nbsp;<span class="string" id="7377432">&#34;arm&#34;</span><span class="op" id="7377437">,</span>&nbsp;<span class="ident" id="7377439">GOOS</span><span class="op" id="7377443">:</span>&nbsp;<span class="string" id="7377445">&#34;android&#34;</span><span class="op" id="7377454">}</span><br>
<span class="lineno"></span><span class="op" id="7377456">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="7377459">var</span>&nbsp;<span class="ident" id="7377463">matchFileTests</span>&nbsp;<span class="op" id="7377478">=</span>&nbsp;<span class="op" id="7377480">[</span><span class="op" id="7377481">]</span><span class="keyword" id="7377482">struct</span>&nbsp;<span class="op" id="7377489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7377492">ctxt</span>&nbsp;&nbsp;<span class="ident" id="7377498">Context</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7377507">name</span>&nbsp;&nbsp;<span class="builtintype" id="7377513">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7377521">data</span>&nbsp;&nbsp;<span class="builtintype" id="7377527">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7377535">match</span>&nbsp;<span class="builtintype" id="7377541">bool</span><br>
<span class="lineno">180</span><span class="op" id="7377546">}</span><span class="op" id="7377547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7377550">{</span><span class="ident" id="7377551">ctxtP9</span><span class="op" id="7377557">,</span>&nbsp;<span class="string" id="7377559">&#34;foo_arm.go&#34;</span><span class="op" id="7377571">,</span>&nbsp;<span class="string" id="7377573">&#34;&#34;</span><span class="op" id="7377575">,</span>&nbsp;<span class="builtintype" id="7377577">true</span><span class="op" id="7377581">}</span><span class="op" id="7377582">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7377585">{</span><span class="ident" id="7377586">ctxtP9</span><span class="op" id="7377592">,</span>&nbsp;<span class="string" id="7377594">&#34;foo1_arm.go&#34;</span><span class="op" id="7377607">,</span>&nbsp;<span class="string" id="7377609">&#34;//&nbsp;+build&nbsp;linux\n\npackage&nbsp;main\n&#34;</span><span class="op" id="7377644">,</span>&nbsp;<span class="builtintype" id="7377646">false</span><span class="op" id="7377651">}</span><span class="op" id="7377652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7377655">{</span><span class="ident" id="7377656">ctxtP9</span><span class="op" id="7377662">,</span>&nbsp;<span class="string" id="7377664">&#34;foo_darwin.go&#34;</span><span class="op" id="7377679">,</span>&nbsp;<span class="string" id="7377681">&#34;&#34;</span><span class="op" id="7377683">,</span>&nbsp;<span class="builtintype" id="7377685">false</span><span class="op" id="7377690">}</span><span class="op" id="7377691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7377694">{</span><span class="ident" id="7377695">ctxtP9</span><span class="op" id="7377701">,</span>&nbsp;<span class="string" id="7377703">&#34;foo.go&#34;</span><span class="op" id="7377711">,</span>&nbsp;<span class="string" id="7377713">&#34;&#34;</span><span class="op" id="7377715">,</span>&nbsp;<span class="builtintype" id="7377717">true</span><span class="op" id="7377721">}</span><span class="op" id="7377722">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7377725">{</span><span class="ident" id="7377726">ctxtP9</span><span class="op" id="7377732">,</span>&nbsp;<span class="string" id="7377734">&#34;foo1.go&#34;</span><span class="op" id="7377743">,</span>&nbsp;<span class="string" id="7377745">&#34;//&nbsp;+build&nbsp;linux\n\npackage&nbsp;main\n&#34;</span><span class="op" id="7377780">,</span>&nbsp;<span class="builtintype" id="7377782">false</span><span class="op" id="7377787">}</span><span class="op" id="7377788">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7377791">{</span><span class="ident" id="7377792">ctxtP9</span><span class="op" id="7377798">,</span>&nbsp;<span class="string" id="7377800">&#34;foo.badsuffix&#34;</span><span class="op" id="7377815">,</span>&nbsp;<span class="string" id="7377817">&#34;&#34;</span><span class="op" id="7377819">,</span>&nbsp;<span class="builtintype" id="7377821">false</span><span class="op" id="7377826">}</span><span class="op" id="7377827">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7377830">{</span><span class="ident" id="7377831">ctxtAndroid</span><span class="op" id="7377842">,</span>&nbsp;<span class="string" id="7377844">&#34;foo_linux.go&#34;</span><span class="op" id="7377858">,</span>&nbsp;<span class="string" id="7377860">&#34;&#34;</span><span class="op" id="7377862">,</span>&nbsp;<span class="builtintype" id="7377864">true</span><span class="op" id="7377868">}</span><span class="op" id="7377869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7377872">{</span><span class="ident" id="7377873">ctxtAndroid</span><span class="op" id="7377884">,</span>&nbsp;<span class="string" id="7377886">&#34;foo_android.go&#34;</span><span class="op" id="7377902">,</span>&nbsp;<span class="string" id="7377904">&#34;&#34;</span><span class="op" id="7377906">,</span>&nbsp;<span class="builtintype" id="7377908">true</span><span class="op" id="7377912">}</span><span class="op" id="7377913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7377916">{</span><span class="ident" id="7377917">ctxtAndroid</span><span class="op" id="7377928">,</span>&nbsp;<span class="string" id="7377930">&#34;foo_plan9.go&#34;</span><span class="op" id="7377944">,</span>&nbsp;<span class="string" id="7377946">&#34;&#34;</span><span class="op" id="7377948">,</span>&nbsp;<span class="builtintype" id="7377950">false</span><span class="op" id="7377955">}</span><span class="op" id="7377956">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7377959">{</span><span class="ident" id="7377960">ctxtAndroid</span><span class="op" id="7377971">,</span>&nbsp;<span class="string" id="7377973">&#34;android.go&#34;</span><span class="op" id="7377985">,</span>&nbsp;<span class="string" id="7377987">&#34;&#34;</span><span class="op" id="7377989">,</span>&nbsp;<span class="builtintype" id="7377991">true</span><span class="op" id="7377995">}</span><span class="op" id="7377996">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7377999">{</span><span class="ident" id="7378000">ctxtAndroid</span><span class="op" id="7378011">,</span>&nbsp;<span class="string" id="7378013">&#34;plan9.go&#34;</span><span class="op" id="7378023">,</span>&nbsp;<span class="string" id="7378025">&#34;&#34;</span><span class="op" id="7378027">,</span>&nbsp;<span class="builtintype" id="7378029">true</span><span class="op" id="7378033">}</span><span class="op" id="7378034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7378037">{</span><span class="ident" id="7378038">ctxtAndroid</span><span class="op" id="7378049">,</span>&nbsp;<span class="string" id="7378051">&#34;plan9_test.go&#34;</span><span class="op" id="7378066">,</span>&nbsp;<span class="string" id="7378068">&#34;&#34;</span><span class="op" id="7378070">,</span>&nbsp;<span class="builtintype" id="7378072">true</span><span class="op" id="7378076">}</span><span class="op" id="7378077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7378080">{</span><span class="ident" id="7378081">ctxtAndroid</span><span class="op" id="7378092">,</span>&nbsp;<span class="string" id="7378094">&#34;arm.s&#34;</span><span class="op" id="7378101">,</span>&nbsp;<span class="string" id="7378103">&#34;&#34;</span><span class="op" id="7378105">,</span>&nbsp;<span class="builtintype" id="7378107">true</span><span class="op" id="7378111">}</span><span class="op" id="7378112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7378115">{</span><span class="ident" id="7378116">ctxtAndroid</span><span class="op" id="7378127">,</span>&nbsp;<span class="string" id="7378129">&#34;amd64.s&#34;</span><span class="op" id="7378138">,</span>&nbsp;<span class="string" id="7378140">&#34;&#34;</span><span class="op" id="7378142">,</span>&nbsp;<span class="builtintype" id="7378144">true</span><span class="op" id="7378148">}</span><span class="op" id="7378149">,</span><br>
<span class="lineno">195</span><span class="op" id="7378151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7378154">func</span>&nbsp;<span class="ident" id="7378159">TestMatchFile</span><span class="op" id="7378172">(</span><span class="ident" id="7378173">t</span>&nbsp;<span class="op" id="7378175">*</span><span class="ident" id="7378176">testing</span><span class="op" id="7378183">.</span><span class="ident" id="7378184">T</span><span class="op" id="7378185">)</span>&nbsp;<span class="op" id="7378187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7378190">for</span>&nbsp;<span class="ident" id="7378194">_</span><span class="op" id="7378195">,</span>&nbsp;<span class="ident" id="7378197">tt</span>&nbsp;<span class="op" id="7378200">:=</span>&nbsp;<span class="keyword" id="7378203">range</span>&nbsp;<span class="ident" id="7378209">matchFileTests</span>&nbsp;<span class="op" id="7378224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7378228">ctxt</span>&nbsp;<span class="op" id="7378233">:=</span>&nbsp;<span class="ident" id="7378236">tt</span><span class="op" id="7378238">.</span><span class="ident" id="7378239">ctxt</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7378246">ctxt</span><span class="op" id="7378250">.</span><span class="ident" id="7378251">OpenFile</span>&nbsp;<span class="op" id="7378260">=</span>&nbsp;<span class="keyword" id="7378262">func</span><span class="op" id="7378266">(</span><span class="ident" id="7378267">path</span>&nbsp;<span class="builtintype" id="7378272">string</span><span class="op" id="7378278">)</span>&nbsp;<span class="op" id="7378280">(</span><span class="ident" id="7378281">r</span>&nbsp;<span class="ident" id="7378283">io</span><span class="op" id="7378285">.</span><span class="ident" id="7378286">ReadCloser</span><span class="op" id="7378296">,</span>&nbsp;<span class="ident" id="7378298">err</span>&nbsp;<span class="builtintype" id="7378302">error</span><span class="op" id="7378307">)</span>&nbsp;<span class="op" id="7378309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7378314">if</span>&nbsp;<span class="ident" id="7378317">path</span>&nbsp;<span class="op" id="7378322">!=</span>&nbsp;<span class="string" id="7378325">&#34;x+&#34;</span><span class="op" id="7378329">+</span><span class="ident" id="7378330">tt</span><span class="op" id="7378332">.</span><span class="ident" id="7378333">name</span>&nbsp;<span class="op" id="7378338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7378344">t</span><span class="op" id="7378345">.</span><span class="ident" id="7378346">Fatalf</span><span class="op" id="7378352">(</span><span class="string" id="7378353">&#34;OpenFile&nbsp;asked&nbsp;for&nbsp;%q,&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="7378389">,</span>&nbsp;<span class="ident" id="7378391">path</span><span class="op" id="7378395">,</span>&nbsp;<span class="string" id="7378397">&#34;x+&#34;</span><span class="op" id="7378401">+</span><span class="ident" id="7378402">tt</span><span class="op" id="7378404">.</span><span class="ident" id="7378405">name</span><span class="op" id="7378409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7378414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7378419">return</span>&nbsp;<span class="op" id="7378426">&amp;</span><span class="ident" id="7378427">readNopCloser</span><span class="op" id="7378440">{</span><span class="ident" id="7378441">strings</span><span class="op" id="7378448">.</span><span class="ident" id="7378449">NewReader</span><span class="op" id="7378458">(</span><span class="ident" id="7378459">tt</span><span class="op" id="7378461">.</span><span class="ident" id="7378462">data</span><span class="op" id="7378466">)</span><span class="op" id="7378467">}</span><span class="op" id="7378468">,</span>&nbsp;<span class="builtintype" id="7378470">nil</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7378476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7378480">ctxt</span><span class="op" id="7378484">.</span><span class="ident" id="7378485">JoinPath</span>&nbsp;<span class="op" id="7378494">=</span>&nbsp;<span class="keyword" id="7378496">func</span><span class="op" id="7378500">(</span><span class="ident" id="7378501">elem</span>&nbsp;<span class="op" id="7378506">...</span><span class="builtintype" id="7378509">string</span><span class="op" id="7378515">)</span>&nbsp;<span class="builtintype" id="7378517">string</span>&nbsp;<span class="op" id="7378524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7378529">return</span>&nbsp;<span class="ident" id="7378536">strings</span><span class="op" id="7378543">.</span><span class="ident" id="7378544">Join</span><span class="op" id="7378548">(</span><span class="ident" id="7378549">elem</span><span class="op" id="7378553">,</span>&nbsp;<span class="string" id="7378555">&#34;+&#34;</span><span class="op" id="7378558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7378562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7378566">match</span><span class="op" id="7378571">,</span>&nbsp;<span class="ident" id="7378573">err</span>&nbsp;<span class="op" id="7378577">:=</span>&nbsp;<span class="ident" id="7378580">ctxt</span><span class="op" id="7378584">.</span><span class="ident" id="7378585">MatchFile</span><span class="op" id="7378594">(</span><span class="string" id="7378595">&#34;x&#34;</span><span class="op" id="7378598">,</span>&nbsp;<span class="ident" id="7378600">tt</span><span class="op" id="7378602">.</span><span class="ident" id="7378603">name</span><span class="op" id="7378607">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7378611">if</span>&nbsp;<span class="ident" id="7378614">match</span>&nbsp;<span class="op" id="7378620">!=</span>&nbsp;<span class="ident" id="7378623">tt</span><span class="op" id="7378625">.</span><span class="ident" id="7378626">match</span>&nbsp;<span class="op" id="7378632">||</span>&nbsp;<span class="ident" id="7378635">err</span>&nbsp;<span class="op" id="7378639">!=</span>&nbsp;<span class="builtintype" id="7378642">nil</span>&nbsp;<span class="op" id="7378646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7378651">t</span><span class="op" id="7378652">.</span><span class="ident" id="7378653">Fatalf</span><span class="op" id="7378659">(</span><span class="string" id="7378660">&#34;MatchFile(%q)&nbsp;=&nbsp;%v,&nbsp;%v,&nbsp;want&nbsp;%v,&nbsp;nil&#34;</span><span class="op" id="7378698">,</span>&nbsp;<span class="ident" id="7378700">tt</span><span class="op" id="7378702">.</span><span class="ident" id="7378703">name</span><span class="op" id="7378707">,</span>&nbsp;<span class="ident" id="7378709">match</span><span class="op" id="7378714">,</span>&nbsp;<span class="ident" id="7378716">err</span><span class="op" id="7378719">,</span>&nbsp;<span class="ident" id="7378721">tt</span><span class="op" id="7378723">.</span><span class="ident" id="7378724">match</span><span class="op" id="7378729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7378733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7378736">}</span><br>
<span class="lineno"></span><span class="op" id="7378738">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="7378741">func</span>&nbsp;<span class="ident" id="7378746">TestImportCmd</span><span class="op" id="7378759">(</span><span class="ident" id="7378760">t</span>&nbsp;<span class="op" id="7378762">*</span><span class="ident" id="7378763">testing</span><span class="op" id="7378770">.</span><span class="ident" id="7378771">T</span><span class="op" id="7378772">)</span>&nbsp;<span class="op" id="7378774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7378777">p</span><span class="op" id="7378778">,</span>&nbsp;<span class="ident" id="7378780">err</span>&nbsp;<span class="op" id="7378784">:=</span>&nbsp;<span class="ident" id="7378787">Import</span><span class="op" id="7378793">(</span><span class="string" id="7378794">&#34;cmd/internal/objfile&#34;</span><span class="op" id="7378816">,</span>&nbsp;<span class="string" id="7378818">&#34;&#34;</span><span class="op" id="7378820">,</span>&nbsp;<span class="num" id="7378822">0</span><span class="op" id="7378823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7378826">if</span>&nbsp;<span class="ident" id="7378829">err</span>&nbsp;<span class="op" id="7378833">!=</span>&nbsp;<span class="builtintype" id="7378836">nil</span>&nbsp;<span class="op" id="7378840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7378844">t</span><span class="op" id="7378845">.</span><span class="ident" id="7378846">Fatal</span><span class="op" id="7378851">(</span><span class="ident" id="7378852">err</span><span class="op" id="7378855">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7378858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7378861">if</span>&nbsp;<span class="op" id="7378864">!</span><span class="ident" id="7378865">strings</span><span class="op" id="7378872">.</span><span class="ident" id="7378873">HasSuffix</span><span class="op" id="7378882">(</span><span class="ident" id="7378883">filepath</span><span class="op" id="7378891">.</span><span class="ident" id="7378892">ToSlash</span><span class="op" id="7378899">(</span><span class="ident" id="7378900">p</span><span class="op" id="7378901">.</span><span class="ident" id="7378902">Dir</span><span class="op" id="7378905">)</span><span class="op" id="7378906">,</span>&nbsp;<span class="string" id="7378908">&#34;src/cmd/internal/objfile&#34;</span><span class="op" id="7378934">)</span>&nbsp;<span class="op" id="7378936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7378940">t</span><span class="op" id="7378941">.</span><span class="ident" id="7378942">Fatalf</span><span class="op" id="7378948">(</span><span class="string" id="7378949">&#34;Import&nbsp;cmd/internal/objfile&nbsp;returned&nbsp;Dir=%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7379003">,</span>&nbsp;<span class="ident" id="7379005">filepath</span><span class="op" id="7379013">.</span><span class="ident" id="7379014">ToSlash</span><span class="op" id="7379021">(</span><span class="ident" id="7379022">p</span><span class="op" id="7379023">.</span><span class="ident" id="7379024">Dir</span><span class="op" id="7379027">)</span><span class="op" id="7379028">,</span>&nbsp;<span class="string" id="7379030">&#34;.../src/cmd/internal/objfile&#34;</span><span class="op" id="7379060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7379063">}</span><br>
<span class="lineno"></span><span class="op" id="7379065">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
