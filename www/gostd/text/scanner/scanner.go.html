<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/scanner</h2>
<ul>
<li><a href="/gostd/text/scanner/scanner.go.html" class="current">scanner.go</a></li>
<li><a href="/gostd/text/scanner/scanner_test.go.html">scanner_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6225320">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6225375">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6225429">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6225480">//&nbsp;Package&nbsp;scanner&nbsp;provides&nbsp;a&nbsp;scanner&nbsp;and&nbsp;tokenizer&nbsp;for&nbsp;UTF-8-encoded&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="6225556">//&nbsp;It&nbsp;takes&nbsp;an&nbsp;io.Reader&nbsp;providing&nbsp;the&nbsp;source,&nbsp;which&nbsp;then&nbsp;can&nbsp;be&nbsp;tokenized</span><br>
<span class="lineno"></span><span class="comment" id="6225631">//&nbsp;through&nbsp;repeated&nbsp;calls&nbsp;to&nbsp;the&nbsp;Scan&nbsp;function.&nbsp;&nbsp;For&nbsp;compatibility&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="6225703">//&nbsp;existing&nbsp;tools,&nbsp;the&nbsp;NUL&nbsp;character&nbsp;is&nbsp;not&nbsp;allowed.&nbsp;If&nbsp;the&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="6225779">//&nbsp;in&nbsp;the&nbsp;source&nbsp;is&nbsp;a&nbsp;UTF-8&nbsp;encoded&nbsp;byte&nbsp;order&nbsp;mark&nbsp;(BOM),&nbsp;it&nbsp;is&nbsp;discarded.</span><br>
<span class="lineno">10</span><span class="comment" id="6225855">//</span><br>
<span class="lineno"></span><span class="comment" id="6225858">//&nbsp;By&nbsp;default,&nbsp;a&nbsp;Scanner&nbsp;skips&nbsp;white&nbsp;space&nbsp;and&nbsp;Go&nbsp;comments&nbsp;and&nbsp;recognizes&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="6225936">//&nbsp;literals&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;Go&nbsp;language&nbsp;specification.&nbsp;&nbsp;It&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="6226004">//&nbsp;customized&nbsp;to&nbsp;recognize&nbsp;only&nbsp;a&nbsp;subset&nbsp;of&nbsp;those&nbsp;literals&nbsp;and&nbsp;to&nbsp;recognize</span><br>
<span class="lineno"></span><span class="comment" id="6226080">//&nbsp;different&nbsp;identifier&nbsp;and&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno">15</span><span class="comment" id="6226132">//</span><br>
<span class="lineno"></span><span class="comment" id="6226135">//&nbsp;Basic&nbsp;usage&nbsp;pattern:</span><br>
<span class="lineno"></span><span class="comment" id="6226159">//</span><br>
<span class="lineno"></span><span class="comment" id="6226162">//&nbsp;&nbsp;&nbsp;&nbspvar&nbsp;s&nbsp;scanner.Scanner</span><br>
<span class="lineno"></span><span class="comment" id="6226187">//&nbsp;&nbsp;&nbsp;&nbsps.Init(src)</span><br>
<span class="lineno">20</span><span class="comment" id="6226202">//&nbsp;&nbsp;&nbsp;&nbsptok&nbsp;:=&nbsp;s.Scan()</span><br>
<span class="lineno"></span><span class="comment" id="6226221">//&nbsp;&nbsp;&nbsp;&nbspfor&nbsp;tok&nbsp;!=&nbsp;scanner.EOF&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6226249">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;do&nbsp;something&nbsp;with&nbsp;tok</span><br>
<span class="lineno"></span><span class="comment" id="6226278">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsptok&nbsp;=&nbsp;s.Scan()</span><br>
<span class="lineno"></span><span class="comment" id="6226297">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno">25</span><span class="comment" id="6226302">//</span><br>
<span class="lineno"></span><span class="keyword" id="6226305">package</span>&nbsp;<span class="ident" id="6226313">scanner</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6226322">import</span>&nbsp;<span class="op" id="6226329">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6226332">&#34;bytes&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6226341">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6226348">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6226354">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6226360">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6226371">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">35</span><span class="op" id="6226386">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6226389">//&nbsp;A&nbsp;source&nbsp;position&nbsp;is&nbsp;represented&nbsp;by&nbsp;a&nbsp;Position&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="6226446">//&nbsp;A&nbsp;position&nbsp;is&nbsp;valid&nbsp;if&nbsp;Line&nbsp;&gt;&nbsp;0.</span><br>
<span class="lineno"></span><span class="keyword" id="6226482">type</span>&nbsp;<span class="ident" id="6226487">Position</span>&nbsp;<span class="keyword" id="6226496">struct</span>&nbsp;<span class="op" id="6226503">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226506">Filename</span>&nbsp;<span class="builtintype" id="6226515">string</span>&nbsp;<span class="comment" id="6226522">//&nbsp;filename,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226543">Offset</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6226552">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6226559">//&nbsp;byte&nbsp;offset,&nbsp;starting&nbsp;at&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226590">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6226599">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6226606">//&nbsp;line&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226637">Column</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6226646">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6226653">//&nbsp;column&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1&nbsp;(character&nbsp;count&nbsp;per&nbsp;line)</span><br>
<span class="lineno"></span><span class="op" id="6226712">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="6226715">//&nbsp;IsValid&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;position&nbsp;is&nbsp;valid.</span><br>
<span class="lineno"></span><span class="keyword" id="6226765">func</span>&nbsp;<span class="op" id="6226770">(</span><span class="ident" id="6226771">pos</span>&nbsp;<span class="op" id="6226775">*</span><span class="ident" id="6226776">Position</span><span class="op" id="6226784">)</span>&nbsp;<span class="ident" id="6226786">IsValid</span><span class="op" id="6226793">(</span><span class="op" id="6226794">)</span>&nbsp;<span class="builtintype" id="6226796">bool</span>&nbsp;<span class="op" id="6226801">{</span>&nbsp;<span class="keyword" id="6226803">return</span>&nbsp;<span class="ident" id="6226810">pos</span><span class="op" id="6226813">.</span><span class="ident" id="6226814">Line</span>&nbsp;<span class="op" id="6226819">&gt;</span>&nbsp;<span class="num" id="6226821">0</span>&nbsp;<span class="op" id="6226823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6226826">func</span>&nbsp;<span class="op" id="6226831">(</span><span class="ident" id="6226832">pos</span>&nbsp;<span class="ident" id="6226836">Position</span><span class="op" id="6226844">)</span>&nbsp;<span class="ident" id="6226846">String</span><span class="op" id="6226852">(</span><span class="op" id="6226853">)</span>&nbsp;<span class="builtintype" id="6226855">string</span>&nbsp;<span class="op" id="6226862">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226865">s</span>&nbsp;<span class="op" id="6226867">:=</span>&nbsp;<span class="ident" id="6226870">pos</span><span class="op" id="6226873">.</span><span class="ident" id="6226874">Filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226884">if</span>&nbsp;<span class="ident" id="6226887">pos</span><span class="op" id="6226890">.</span><span class="ident" id="6226891">IsValid</span><span class="op" id="6226898">(</span><span class="op" id="6226899">)</span>&nbsp;<span class="op" id="6226901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226905">if</span>&nbsp;<span class="ident" id="6226908">s</span>&nbsp;<span class="op" id="6226910">!=</span>&nbsp;<span class="string" id="6226913">&#34;&#34;</span>&nbsp;<span class="op" id="6226916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226921">s</span>&nbsp;<span class="op" id="6226923">+=</span>&nbsp;<span class="string" id="6226926">&#34;:&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6226932">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226936">s</span>&nbsp;<span class="op" id="6226938">+=</span>&nbsp;<span class="ident" id="6226941">fmt</span><span class="op" id="6226944">.</span><span class="ident" id="6226945">Sprintf</span><span class="op" id="6226952">(</span><span class="string" id="6226953">&#34;%d:%d&#34;</span><span class="op" id="6226960">,</span>&nbsp;<span class="ident" id="6226962">pos</span><span class="op" id="6226965">.</span><span class="ident" id="6226966">Line</span><span class="op" id="6226970">,</span>&nbsp;<span class="ident" id="6226972">pos</span><span class="op" id="6226975">.</span><span class="ident" id="6226976">Column</span><span class="op" id="6226982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6226985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226988">if</span>&nbsp;<span class="ident" id="6226991">s</span>&nbsp;<span class="op" id="6226993">==</span>&nbsp;<span class="string" id="6226996">&#34;&#34;</span>&nbsp;<span class="op" id="6226999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6227003">s</span>&nbsp;<span class="op" id="6227005">=</span>&nbsp;<span class="string" id="6227007">&#34;???&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6227014">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6227017">return</span>&nbsp;<span class="ident" id="6227024">s</span><br>
<span class="lineno"></span><span class="op" id="6227026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6227029">//&nbsp;Predefined&nbsp;mode&nbsp;bits&nbsp;to&nbsp;control&nbsp;recognition&nbsp;of&nbsp;tokens.&nbsp;For&nbsp;instance,</span><br>
<span class="lineno"></span><span class="comment" id="6227101">//&nbsp;to&nbsp;configure&nbsp;a&nbsp;Scanner&nbsp;such&nbsp;that&nbsp;it&nbsp;only&nbsp;recognizes&nbsp;(Go)&nbsp;identifiers,</span><br>
<span class="lineno">65</span><span class="comment" id="6227174">//&nbsp;integers,&nbsp;and&nbsp;skips&nbsp;comments,&nbsp;set&nbsp;the&nbsp;Scanner&#39;s&nbsp;Mode&nbsp;field&nbsp;to:</span><br>
<span class="lineno"></span><span class="comment" id="6227240">//</span><br>
<span class="lineno"></span><span class="comment" id="6227243">//&nbsp;&nbsp;&nbsp;&nbspScanIdents&nbsp;|&nbsp;ScanInts&nbsp;|&nbsp;SkipComments</span><br>
<span class="lineno"></span><span class="comment" id="6227283">//</span><br>
<span class="lineno"></span><span class="comment" id="6227286">//&nbsp;With&nbsp;the&nbsp;exceptions&nbsp;of&nbsp;comments,&nbsp;which&nbsp;are&nbsp;skipped&nbsp;if&nbsp;SkipComments&nbsp;is</span><br>
<span class="lineno">70</span><span class="comment" id="6227359">//&nbsp;set,&nbsp;unrecognized&nbsp;tokens&nbsp;are&nbsp;not&nbsp;ignored.&nbsp;Instead,&nbsp;the&nbsp;scanner&nbsp;simply</span><br>
<span class="lineno"></span><span class="comment" id="6227432">//&nbsp;returns&nbsp;the&nbsp;respective&nbsp;individual&nbsp;characters&nbsp;(or&nbsp;possibly&nbsp;sub-tokens).</span><br>
<span class="lineno"></span><span class="comment" id="6227506">//&nbsp;For&nbsp;instance,&nbsp;if&nbsp;the&nbsp;mode&nbsp;is&nbsp;ScanIdents&nbsp;(not&nbsp;ScanStrings),&nbsp;the&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="6227579">//&nbsp;&#34;foo&#34;&nbsp;is&nbsp;scanned&nbsp;as&nbsp;the&nbsp;token&nbsp;sequence&nbsp;&#39;&#34;&#39;&nbsp;Ident&nbsp;&#39;&#34;&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="6227636">//</span><br>
<span class="lineno">75</span><span class="keyword" id="6227639">const</span>&nbsp;<span class="op" id="6227645">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6227648">ScanIdents</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6227663">=</span>&nbsp;<span class="num" id="6227665">1</span>&nbsp;<span class="op" id="6227667">&lt;&lt;</span>&nbsp;<span class="op" id="6227670">-</span><span class="ident" id="6227671">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6227678">ScanInts</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6227693">=</span>&nbsp;<span class="num" id="6227695">1</span>&nbsp;<span class="op" id="6227697">&lt;&lt;</span>&nbsp;<span class="op" id="6227700">-</span><span class="ident" id="6227701">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6227706">ScanFloats</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6227721">=</span>&nbsp;<span class="num" id="6227723">1</span>&nbsp;<span class="op" id="6227725">&lt;&lt;</span>&nbsp;<span class="op" id="6227728">-</span><span class="ident" id="6227729">Float</span>&nbsp;<span class="comment" id="6227735">//&nbsp;includes&nbsp;Ints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6227753">ScanChars</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6227768">=</span>&nbsp;<span class="num" id="6227770">1</span>&nbsp;<span class="op" id="6227772">&lt;&lt;</span>&nbsp;<span class="op" id="6227775">-</span><span class="ident" id="6227776">Char</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6227782">ScanStrings</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6227797">=</span>&nbsp;<span class="num" id="6227799">1</span>&nbsp;<span class="op" id="6227801">&lt;&lt;</span>&nbsp;<span class="op" id="6227804">-</span><span class="ident" id="6227805">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6227813">ScanRawStrings</span>&nbsp;<span class="op" id="6227828">=</span>&nbsp;<span class="num" id="6227830">1</span>&nbsp;<span class="op" id="6227832">&lt;&lt;</span>&nbsp;<span class="op" id="6227835">-</span><span class="ident" id="6227836">RawString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6227847">ScanComments</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6227862">=</span>&nbsp;<span class="num" id="6227864">1</span>&nbsp;<span class="op" id="6227866">&lt;&lt;</span>&nbsp;<span class="op" id="6227869">-</span><span class="ident" id="6227870">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6227879">SkipComments</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6227894">=</span>&nbsp;<span class="num" id="6227896">1</span>&nbsp;<span class="op" id="6227898">&lt;&lt;</span>&nbsp;<span class="op" id="6227901">-</span><span class="ident" id="6227902">skipComment</span>&nbsp;<span class="comment" id="6227914">//&nbsp;if&nbsp;set&nbsp;with&nbsp;ScanComments,&nbsp;comments&nbsp;become&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6227972">GoTokens</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6227987">=</span>&nbsp;<span class="ident" id="6227989">ScanIdents</span>&nbsp;<span class="op" id="6228000">|</span>&nbsp;<span class="ident" id="6228002">ScanFloats</span>&nbsp;<span class="op" id="6228013">|</span>&nbsp;<span class="ident" id="6228015">ScanChars</span>&nbsp;<span class="op" id="6228025">|</span>&nbsp;<span class="ident" id="6228027">ScanStrings</span>&nbsp;<span class="op" id="6228039">|</span>&nbsp;<span class="ident" id="6228041">ScanRawStrings</span>&nbsp;<span class="op" id="6228056">|</span>&nbsp;<span class="ident" id="6228058">ScanComments</span>&nbsp;<span class="op" id="6228071">|</span>&nbsp;<span class="ident" id="6228073">SkipComments</span><br>
<span class="lineno">85</span><span class="op" id="6228086">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6228089">//&nbsp;The&nbsp;result&nbsp;of&nbsp;Scan&nbsp;is&nbsp;one&nbsp;of&nbsp;the&nbsp;following&nbsp;tokens&nbsp;or&nbsp;a&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="6228166">const</span>&nbsp;<span class="op" id="6228172">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228175">EOF</span>&nbsp;<span class="op" id="6228179">=</span>&nbsp;<span class="op" id="6228181">-</span><span class="op" id="6228182">(</span><span class="ident" id="6228183">iota</span>&nbsp;<span class="op" id="6228188">+</span>&nbsp;<span class="num" id="6228190">1</span><span class="op" id="6228191">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228194">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228201">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228206">Float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228213">Char</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228219">String</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228227">RawString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228238">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228247">skipComment</span><br>
<span class="lineno"></span><span class="op" id="6228259">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="6228262">var</span>&nbsp;<span class="ident" id="6228266">tokenString</span>&nbsp;<span class="op" id="6228278">=</span>&nbsp;<span class="keyword" id="6228280">map</span><span class="op" id="6228283">[</span><span class="builtintype" id="6228284">rune</span><span class="op" id="6228288">]</span><span class="builtintype" id="6228289">string</span><span class="op" id="6228295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228298">EOF</span><span class="op" id="6228301">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6228309">&#34;EOF&#34;</span><span class="op" id="6228314">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228317">Ident</span><span class="op" id="6228322">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6228328">&#34;Ident&#34;</span><span class="op" id="6228335">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228338">Int</span><span class="op" id="6228341">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6228349">&#34;Int&#34;</span><span class="op" id="6228354">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228357">Float</span><span class="op" id="6228362">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6228368">&#34;Float&#34;</span><span class="op" id="6228375">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228378">Char</span><span class="op" id="6228382">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6228389">&#34;Char&#34;</span><span class="op" id="6228395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228398">String</span><span class="op" id="6228404">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6228409">&#34;String&#34;</span><span class="op" id="6228417">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228420">RawString</span><span class="op" id="6228429">:</span>&nbsp;<span class="string" id="6228431">&#34;RawString&#34;</span><span class="op" id="6228442">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228445">Comment</span><span class="op" id="6228452">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6228456">&#34;Comment&#34;</span><span class="op" id="6228465">,</span><br>
<span class="lineno"></span><span class="op" id="6228467">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="6228470">//&nbsp;TokenString&nbsp;returns&nbsp;a&nbsp;printable&nbsp;string&nbsp;for&nbsp;a&nbsp;token&nbsp;or&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="6228546">func</span>&nbsp;<span class="ident" id="6228551">TokenString</span><span class="op" id="6228562">(</span><span class="ident" id="6228563">tok</span>&nbsp;<span class="builtintype" id="6228567">rune</span><span class="op" id="6228571">)</span>&nbsp;<span class="builtintype" id="6228573">string</span>&nbsp;<span class="op" id="6228580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6228583">if</span>&nbsp;<span class="ident" id="6228586">s</span><span class="op" id="6228587">,</span>&nbsp;<span class="ident" id="6228589">found</span>&nbsp;<span class="op" id="6228595">:=</span>&nbsp;<span class="ident" id="6228598">tokenString</span><span class="op" id="6228609">[</span><span class="ident" id="6228610">tok</span><span class="op" id="6228613">]</span><span class="op" id="6228614">;</span>&nbsp;<span class="ident" id="6228616">found</span>&nbsp;<span class="op" id="6228622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6228626">return</span>&nbsp;<span class="ident" id="6228633">s</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6228636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6228639">return</span>&nbsp;<span class="ident" id="6228646">fmt</span><span class="op" id="6228649">.</span><span class="ident" id="6228650">Sprintf</span><span class="op" id="6228657">(</span><span class="string" id="6228658">&#34;%q&#34;</span><span class="op" id="6228662">,</span>&nbsp;<span class="builtintype" id="6228664">string</span><span class="op" id="6228670">(</span><span class="ident" id="6228671">tok</span><span class="op" id="6228674">)</span><span class="op" id="6228675">)</span><br>
<span class="lineno"></span><span class="op" id="6228677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6228680">//&nbsp;GoWhitespace&nbsp;is&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;the&nbsp;Scanner&#39;s&nbsp;Whitespace&nbsp;field.</span><br>
<span class="lineno">120</span><span class="comment" id="6228753">//&nbsp;Its&nbsp;value&nbsp;selects&nbsp;Go&#39;s&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="6228803">const</span>&nbsp;<span class="ident" id="6228809">GoWhitespace</span>&nbsp;<span class="op" id="6228822">=</span>&nbsp;<span class="num" id="6228824">1</span><span class="op" id="6228825">&lt;&lt;</span><span class="string" id="6228827">&#39;\t&#39;</span>&nbsp;<span class="op" id="6228832">|</span>&nbsp;<span class="num" id="6228834">1</span><span class="op" id="6228835">&lt;&lt;</span><span class="string" id="6228837">&#39;\n&#39;</span>&nbsp;<span class="op" id="6228842">|</span>&nbsp;<span class="num" id="6228844">1</span><span class="op" id="6228845">&lt;&lt;</span><span class="string" id="6228847">&#39;\r&#39;</span>&nbsp;<span class="op" id="6228852">|</span>&nbsp;<span class="num" id="6228854">1</span><span class="op" id="6228855">&lt;&lt;</span><span class="string" id="6228857">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6228862">const</span>&nbsp;<span class="ident" id="6228868">bufLen</span>&nbsp;<span class="op" id="6228875">=</span>&nbsp;<span class="num" id="6228877">1024</span>&nbsp;<span class="comment" id="6228882">//&nbsp;at&nbsp;least&nbsp;utf8.UTFMax</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="6228907">//&nbsp;A&nbsp;Scanner&nbsp;implements&nbsp;reading&nbsp;of&nbsp;Unicode&nbsp;characters&nbsp;and&nbsp;tokens&nbsp;from&nbsp;an&nbsp;io.Reader.</span><br>
<span class="lineno"></span><span class="keyword" id="6228991">type</span>&nbsp;<span class="ident" id="6228996">Scanner</span>&nbsp;<span class="keyword" id="6229004">struct</span>&nbsp;<span class="op" id="6229011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6229014">//&nbsp;Input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6229024">src</span>&nbsp;<span class="ident" id="6229028">io</span><span class="op" id="6229030">.</span><span class="ident" id="6229031">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6229040">//&nbsp;Source&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6229058">srcBuf</span>&nbsp;<span class="op" id="6229065">[</span><span class="ident" id="6229066">bufLen</span>&nbsp;<span class="op" id="6229073">+</span>&nbsp;<span class="num" id="6229075">1</span><span class="op" id="6229076">]</span><span class="builtintype" id="6229077">byte</span>&nbsp;<span class="comment" id="6229082">//&nbsp;+1&nbsp;for&nbsp;sentinel&nbsp;for&nbsp;common&nbsp;case&nbsp;of&nbsp;s.next()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6229130">srcPos</span>&nbsp;<span class="builtintype" id="6229137">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6229154">//&nbsp;reading&nbsp;position&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6229190">srcEnd</span>&nbsp;<span class="builtintype" id="6229197">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6229214">//&nbsp;source&nbsp;end&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6229245">//&nbsp;Source&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6229265">srcBufOffset</span>&nbsp;<span class="builtintype" id="6229278">int</span>&nbsp;<span class="comment" id="6229282">//&nbsp;byte&nbsp;offset&nbsp;of&nbsp;srcBuf[0]&nbsp;in&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6229321">line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6229334">int</span>&nbsp;<span class="comment" id="6229338">//&nbsp;line&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6229353">column</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6229366">int</span>&nbsp;<span class="comment" id="6229370">//&nbsp;character&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6229390">lastLineLen</span>&nbsp;&nbsp;<span class="builtintype" id="6229403">int</span>&nbsp;<span class="comment" id="6229407">//&nbsp;length&nbsp;of&nbsp;last&nbsp;line&nbsp;in&nbsp;characters&nbsp;(for&nbsp;correct&nbsp;column&nbsp;reporting)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6229476">lastCharLen</span>&nbsp;&nbsp;<span class="builtintype" id="6229489">int</span>&nbsp;<span class="comment" id="6229493">//&nbsp;length&nbsp;of&nbsp;last&nbsp;character&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6229532">//&nbsp;Token&nbsp;text&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6229554">//&nbsp;Typically,&nbsp;token&nbsp;text&nbsp;is&nbsp;stored&nbsp;completely&nbsp;in&nbsp;srcBuf,&nbsp;but&nbsp;in&nbsp;general</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6229627">//&nbsp;the&nbsp;token&nbsp;text&#39;s&nbsp;head&nbsp;may&nbsp;be&nbsp;buffered&nbsp;in&nbsp;tokBuf&nbsp;while&nbsp;the&nbsp;token&nbsp;text&#39;s</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6229702">//&nbsp;tail&nbsp;is&nbsp;stored&nbsp;in&nbsp;srcBuf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6229732">tokBuf</span>&nbsp;<span class="ident" id="6229739">bytes</span><span class="op" id="6229744">.</span><span class="ident" id="6229745">Buffer</span>&nbsp;<span class="comment" id="6229752">//&nbsp;token&nbsp;text&nbsp;head&nbsp;that&nbsp;is&nbsp;not&nbsp;in&nbsp;srcBuf&nbsp;anymore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6229802">tokPos</span>&nbsp;<span class="builtintype" id="6229809">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6229822">//&nbsp;token&nbsp;text&nbsp;tail&nbsp;position&nbsp;(srcBuf&nbsp;index);&nbsp;valid&nbsp;if&nbsp;&gt;=&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6229881">tokEnd</span>&nbsp;<span class="builtintype" id="6229888">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6229901">//&nbsp;token&nbsp;text&nbsp;tail&nbsp;end&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6229941">//&nbsp;One&nbsp;character&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6229970">ch</span>&nbsp;<span class="builtintype" id="6229973">rune</span>&nbsp;<span class="comment" id="6229978">//&nbsp;character&nbsp;before&nbsp;current&nbsp;srcPos</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6230015">//&nbsp;Error&nbsp;is&nbsp;called&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered.&nbsp;If&nbsp;no&nbsp;Error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6230075">//&nbsp;function&nbsp;is&nbsp;set,&nbsp;the&nbsp;error&nbsp;is&nbsp;reported&nbsp;to&nbsp;os.Stderr.</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230132">Error</span>&nbsp;<span class="keyword" id="6230138">func</span><span class="op" id="6230142">(</span><span class="ident" id="6230143">s</span>&nbsp;<span class="op" id="6230145">*</span><span class="ident" id="6230146">Scanner</span><span class="op" id="6230153">,</span>&nbsp;<span class="ident" id="6230155">msg</span>&nbsp;<span class="builtintype" id="6230159">string</span><span class="op" id="6230165">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6230169">//&nbsp;ErrorCount&nbsp;is&nbsp;incremented&nbsp;by&nbsp;one&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230234">ErrorCount</span>&nbsp;<span class="builtintype" id="6230245">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6230251">//&nbsp;The&nbsp;Mode&nbsp;field&nbsp;controls&nbsp;which&nbsp;tokens&nbsp;are&nbsp;recognized.&nbsp;For&nbsp;instance,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6230322">//&nbsp;to&nbsp;recognize&nbsp;Ints,&nbsp;set&nbsp;the&nbsp;ScanInts&nbsp;bit&nbsp;in&nbsp;Mode.&nbsp;The&nbsp;field&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6230392">//&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230417">Mode</span>&nbsp;<span class="builtintype" id="6230422">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6230429">//&nbsp;The&nbsp;Whitespace&nbsp;field&nbsp;controls&nbsp;which&nbsp;characters&nbsp;are&nbsp;recognized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6230495">//&nbsp;as&nbsp;white&nbsp;space.&nbsp;To&nbsp;recognize&nbsp;a&nbsp;character&nbsp;ch&nbsp;&lt;=&nbsp;&#39;&nbsp;&#39;&nbsp;as&nbsp;white&nbsp;space,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6230566">//&nbsp;set&nbsp;the&nbsp;ch&#39;th&nbsp;bit&nbsp;in&nbsp;Whitespace&nbsp;(the&nbsp;Scanner&#39;s&nbsp;behavior&nbsp;is&nbsp;undefined</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6230639">//&nbsp;for&nbsp;values&nbsp;ch&nbsp;&gt;&nbsp;&#39;&nbsp;&#39;).&nbsp;The&nbsp;field&nbsp;may&nbsp;be&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230703">Whitespace</span>&nbsp;<span class="ident" id="6230714">uint64</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6230723">//&nbsp;IsIdentRune&nbsp;is&nbsp;a&nbsp;predicate&nbsp;controlling&nbsp;the&nbsp;characters&nbsp;accepted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6230790">//&nbsp;as&nbsp;the&nbsp;ith&nbsp;rune&nbsp;in&nbsp;an&nbsp;identifier.&nbsp;The&nbsp;set&nbsp;of&nbsp;valid&nbsp;characters</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6230856">//&nbsp;must&nbsp;not&nbsp;intersect&nbsp;with&nbsp;the&nbsp;set&nbsp;of&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6230919">//&nbsp;If&nbsp;no&nbsp;IsIdentRune&nbsp;function&nbsp;is&nbsp;set,&nbsp;regular&nbsp;Go&nbsp;identifiers&nbsp;are</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6230985">//&nbsp;accepted&nbsp;instead.&nbsp;The&nbsp;field&nbsp;may&nbsp;be&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6231045">IsIdentRune</span>&nbsp;<span class="keyword" id="6231057">func</span><span class="op" id="6231061">(</span><span class="ident" id="6231062">ch</span>&nbsp;<span class="builtintype" id="6231065">rune</span><span class="op" id="6231069">,</span>&nbsp;<span class="ident" id="6231071">i</span>&nbsp;<span class="builtintype" id="6231073">int</span><span class="op" id="6231076">)</span>&nbsp;<span class="builtintype" id="6231078">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6231085">//&nbsp;Start&nbsp;position&nbsp;of&nbsp;most&nbsp;recently&nbsp;scanned&nbsp;token;&nbsp;set&nbsp;by&nbsp;Scan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6231149">//&nbsp;Calling&nbsp;Init&nbsp;or&nbsp;Next&nbsp;invalidates&nbsp;the&nbsp;position&nbsp;(Line&nbsp;==&nbsp;0).</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6231212">//&nbsp;The&nbsp;Filename&nbsp;field&nbsp;is&nbsp;always&nbsp;left&nbsp;untouched&nbsp;by&nbsp;the&nbsp;Scanner.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6231276">//&nbsp;If&nbsp;an&nbsp;error&nbsp;is&nbsp;reported&nbsp;(via&nbsp;Error)&nbsp;and&nbsp;Position&nbsp;is&nbsp;invalid,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6231341">//&nbsp;the&nbsp;scanner&nbsp;is&nbsp;not&nbsp;inside&nbsp;a&nbsp;token.&nbsp;Call&nbsp;Pos&nbsp;to&nbsp;obtain&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6231408">//&nbsp;position&nbsp;in&nbsp;that&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6231435">Position</span><br>
<span class="lineno">185</span><span class="op" id="6231444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6231447">//&nbsp;Init&nbsp;initializes&nbsp;a&nbsp;Scanner&nbsp;with&nbsp;a&nbsp;new&nbsp;source&nbsp;and&nbsp;returns&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="6231510">//&nbsp;Error&nbsp;is&nbsp;set&nbsp;to&nbsp;nil,&nbsp;ErrorCount&nbsp;is&nbsp;set&nbsp;to&nbsp;0,&nbsp;Mode&nbsp;is&nbsp;set&nbsp;to&nbsp;GoTokens,</span><br>
<span class="lineno"></span><span class="comment" id="6231583">//&nbsp;and&nbsp;Whitespace&nbsp;is&nbsp;set&nbsp;to&nbsp;GoWhitespace.</span><br>
<span class="lineno">190</span><span class="keyword" id="6231625">func</span>&nbsp;<span class="op" id="6231630">(</span><span class="ident" id="6231631">s</span>&nbsp;<span class="op" id="6231633">*</span><span class="ident" id="6231634">Scanner</span><span class="op" id="6231641">)</span>&nbsp;<span class="ident" id="6231643">Init</span><span class="op" id="6231647">(</span><span class="ident" id="6231648">src</span>&nbsp;<span class="ident" id="6231652">io</span><span class="op" id="6231654">.</span><span class="ident" id="6231655">Reader</span><span class="op" id="6231661">)</span>&nbsp;<span class="op" id="6231663">*</span><span class="ident" id="6231664">Scanner</span>&nbsp;<span class="op" id="6231672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6231675">s</span><span class="op" id="6231676">.</span><span class="ident" id="6231677">src</span>&nbsp;<span class="op" id="6231681">=</span>&nbsp;<span class="ident" id="6231683">src</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6231689">//&nbsp;initialize&nbsp;source&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6231718">//&nbsp;(the&nbsp;first&nbsp;call&nbsp;to&nbsp;next()&nbsp;will&nbsp;fill&nbsp;it&nbsp;by&nbsp;calling&nbsp;src.Read)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6231782">s</span><span class="op" id="6231783">.</span><span class="ident" id="6231784">srcBuf</span><span class="op" id="6231790">[</span><span class="num" id="6231791">0</span><span class="op" id="6231792">]</span>&nbsp;<span class="op" id="6231794">=</span>&nbsp;<span class="ident" id="6231796">utf8</span><span class="op" id="6231800">.</span><span class="ident" id="6231801">RuneSelf</span>&nbsp;<span class="comment" id="6231810">//&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6231823">s</span><span class="op" id="6231824">.</span><span class="ident" id="6231825">srcPos</span>&nbsp;<span class="op" id="6231832">=</span>&nbsp;<span class="num" id="6231834">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6231837">s</span><span class="op" id="6231838">.</span><span class="ident" id="6231839">srcEnd</span>&nbsp;<span class="op" id="6231846">=</span>&nbsp;<span class="num" id="6231848">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6231852">//&nbsp;initialize&nbsp;source&nbsp;position</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6231883">s</span><span class="op" id="6231884">.</span><span class="ident" id="6231885">srcBufOffset</span>&nbsp;<span class="op" id="6231898">=</span>&nbsp;<span class="num" id="6231900">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6231903">s</span><span class="op" id="6231904">.</span><span class="ident" id="6231905">line</span>&nbsp;<span class="op" id="6231910">=</span>&nbsp;<span class="num" id="6231912">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6231915">s</span><span class="op" id="6231916">.</span><span class="ident" id="6231917">column</span>&nbsp;<span class="op" id="6231924">=</span>&nbsp;<span class="num" id="6231926">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6231929">s</span><span class="op" id="6231930">.</span><span class="ident" id="6231931">lastLineLen</span>&nbsp;<span class="op" id="6231943">=</span>&nbsp;<span class="num" id="6231945">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6231948">s</span><span class="op" id="6231949">.</span><span class="ident" id="6231950">lastCharLen</span>&nbsp;<span class="op" id="6231962">=</span>&nbsp;<span class="num" id="6231964">0</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6231968">//&nbsp;initialize&nbsp;token&nbsp;text&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6232001">//&nbsp;(required&nbsp;for&nbsp;first&nbsp;call&nbsp;to&nbsp;next()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6232042">s</span><span class="op" id="6232043">.</span><span class="ident" id="6232044">tokPos</span>&nbsp;<span class="op" id="6232051">=</span>&nbsp;<span class="op" id="6232053">-</span><span class="num" id="6232054">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6232058">//&nbsp;initialize&nbsp;one&nbsp;character&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6232098">s</span><span class="op" id="6232099">.</span><span class="ident" id="6232100">ch</span>&nbsp;<span class="op" id="6232103">=</span>&nbsp;<span class="op" id="6232105">-</span><span class="num" id="6232106">1</span>&nbsp;<span class="comment" id="6232108">//&nbsp;no&nbsp;char&nbsp;read&nbsp;yet</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6232130">//&nbsp;initialize&nbsp;public&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6232159">s</span><span class="op" id="6232160">.</span><span class="ident" id="6232161">Error</span>&nbsp;<span class="op" id="6232167">=</span>&nbsp;<span class="ident" id="6232169">nil</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6232174">s</span><span class="op" id="6232175">.</span><span class="ident" id="6232176">ErrorCount</span>&nbsp;<span class="op" id="6232187">=</span>&nbsp;<span class="num" id="6232189">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6232192">s</span><span class="op" id="6232193">.</span><span class="ident" id="6232194">Mode</span>&nbsp;<span class="op" id="6232199">=</span>&nbsp;<span class="ident" id="6232201">GoTokens</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6232211">s</span><span class="op" id="6232212">.</span><span class="ident" id="6232213">Whitespace</span>&nbsp;<span class="op" id="6232224">=</span>&nbsp;<span class="ident" id="6232226">GoWhitespace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6232240">s</span><span class="op" id="6232241">.</span><span class="ident" id="6232242">Line</span>&nbsp;<span class="op" id="6232247">=</span>&nbsp;<span class="num" id="6232249">0</span>&nbsp;<span class="comment" id="6232251">//&nbsp;invalidate&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6232282">return</span>&nbsp;<span class="ident" id="6232289">s</span><br>
<span class="lineno"></span><span class="op" id="6232291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6232294">//&nbsp;next&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character.&nbsp;It&nbsp;is&nbsp;designed&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="6232368">//&nbsp;that&nbsp;only&nbsp;a&nbsp;minimal&nbsp;amount&nbsp;of&nbsp;work&nbsp;needs&nbsp;to&nbsp;be&nbsp;done&nbsp;in&nbsp;the&nbsp;common&nbsp;ASCII</span><br>
<span class="lineno">225</span><span class="comment" id="6232443">//&nbsp;case&nbsp;(one&nbsp;test&nbsp;to&nbsp;check&nbsp;for&nbsp;both&nbsp;ASCII&nbsp;and&nbsp;end-of-buffer,&nbsp;and&nbsp;one&nbsp;test</span><br>
<span class="lineno"></span><span class="comment" id="6232517">//&nbsp;to&nbsp;check&nbsp;for&nbsp;newlines).</span><br>
<span class="lineno"></span><span class="keyword" id="6232544">func</span>&nbsp;<span class="op" id="6232549">(</span><span class="ident" id="6232550">s</span>&nbsp;<span class="op" id="6232552">*</span><span class="ident" id="6232553">Scanner</span><span class="op" id="6232560">)</span>&nbsp;<span class="ident" id="6232562">next</span><span class="op" id="6232566">(</span><span class="op" id="6232567">)</span>&nbsp;<span class="builtintype" id="6232569">rune</span>&nbsp;<span class="op" id="6232574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6232577">ch</span><span class="op" id="6232579">,</span>&nbsp;<span class="ident" id="6232581">width</span>&nbsp;<span class="op" id="6232587">:=</span>&nbsp;<span class="builtintype" id="6232590">rune</span><span class="op" id="6232594">(</span><span class="ident" id="6232595">s</span><span class="op" id="6232596">.</span><span class="ident" id="6232597">srcBuf</span><span class="op" id="6232603">[</span><span class="ident" id="6232604">s</span><span class="op" id="6232605">.</span><span class="ident" id="6232606">srcPos</span><span class="op" id="6232612">]</span><span class="op" id="6232613">)</span><span class="op" id="6232614">,</span>&nbsp;<span class="num" id="6232616">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6232620">if</span>&nbsp;<span class="ident" id="6232623">ch</span>&nbsp;<span class="op" id="6232626">&gt;=</span>&nbsp;<span class="ident" id="6232629">utf8</span><span class="op" id="6232633">.</span><span class="ident" id="6232634">RuneSelf</span>&nbsp;<span class="op" id="6232643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6232647">//&nbsp;uncommon&nbsp;case:&nbsp;not&nbsp;ASCII&nbsp;or&nbsp;not&nbsp;enough&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6232697">for</span>&nbsp;<span class="ident" id="6232701">s</span><span class="op" id="6232702">.</span><span class="ident" id="6232703">srcPos</span><span class="op" id="6232709">+</span><span class="ident" id="6232710">utf8</span><span class="op" id="6232714">.</span><span class="ident" id="6232715">UTFMax</span>&nbsp;<span class="op" id="6232722">&gt;</span>&nbsp;<span class="ident" id="6232724">s</span><span class="op" id="6232725">.</span><span class="ident" id="6232726">srcEnd</span>&nbsp;<span class="op" id="6232733">&amp;&amp;</span>&nbsp;<span class="op" id="6232736">!</span><span class="ident" id="6232737">utf8</span><span class="op" id="6232741">.</span><span class="ident" id="6232742">FullRune</span><span class="op" id="6232750">(</span><span class="ident" id="6232751">s</span><span class="op" id="6232752">.</span><span class="ident" id="6232753">srcBuf</span><span class="op" id="6232759">[</span><span class="ident" id="6232760">s</span><span class="op" id="6232761">.</span><span class="ident" id="6232762">srcPos</span><span class="op" id="6232768">:</span><span class="ident" id="6232769">s</span><span class="op" id="6232770">.</span><span class="ident" id="6232771">srcEnd</span><span class="op" id="6232777">]</span><span class="op" id="6232778">)</span>&nbsp;<span class="op" id="6232780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6232785">//&nbsp;not&nbsp;enough&nbsp;bytes:&nbsp;read&nbsp;some&nbsp;more,&nbsp;but&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6232835">//&nbsp;save&nbsp;away&nbsp;token&nbsp;text&nbsp;if&nbsp;any</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6232869">if</span>&nbsp;<span class="ident" id="6232872">s</span><span class="op" id="6232873">.</span><span class="ident" id="6232874">tokPos</span>&nbsp;<span class="op" id="6232881">&gt;=</span>&nbsp;<span class="num" id="6232884">0</span>&nbsp;<span class="op" id="6232886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6232892">s</span><span class="op" id="6232893">.</span><span class="ident" id="6232894">tokBuf</span><span class="op" id="6232900">.</span><span class="ident" id="6232901">Write</span><span class="op" id="6232906">(</span><span class="ident" id="6232907">s</span><span class="op" id="6232908">.</span><span class="ident" id="6232909">srcBuf</span><span class="op" id="6232915">[</span><span class="ident" id="6232916">s</span><span class="op" id="6232917">.</span><span class="ident" id="6232918">tokPos</span><span class="op" id="6232924">:</span><span class="ident" id="6232925">s</span><span class="op" id="6232926">.</span><span class="ident" id="6232927">srcPos</span><span class="op" id="6232933">]</span><span class="op" id="6232934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6232940">s</span><span class="op" id="6232941">.</span><span class="ident" id="6232942">tokPos</span>&nbsp;<span class="op" id="6232949">=</span>&nbsp;<span class="num" id="6232951">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6232957">//&nbsp;s.tokEnd&nbsp;is&nbsp;set&nbsp;by&nbsp;Scan()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6232989">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6232994">//&nbsp;move&nbsp;unread&nbsp;bytes&nbsp;to&nbsp;beginning&nbsp;of&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6233041">copy</span><span class="op" id="6233045">(</span><span class="ident" id="6233046">s</span><span class="op" id="6233047">.</span><span class="ident" id="6233048">srcBuf</span><span class="op" id="6233054">[</span><span class="num" id="6233055">0</span><span class="op" id="6233056">:</span><span class="op" id="6233057">]</span><span class="op" id="6233058">,</span>&nbsp;<span class="ident" id="6233060">s</span><span class="op" id="6233061">.</span><span class="ident" id="6233062">srcBuf</span><span class="op" id="6233068">[</span><span class="ident" id="6233069">s</span><span class="op" id="6233070">.</span><span class="ident" id="6233071">srcPos</span><span class="op" id="6233077">:</span><span class="ident" id="6233078">s</span><span class="op" id="6233079">.</span><span class="ident" id="6233080">srcEnd</span><span class="op" id="6233086">]</span><span class="op" id="6233087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6233092">s</span><span class="op" id="6233093">.</span><span class="ident" id="6233094">srcBufOffset</span>&nbsp;<span class="op" id="6233107">+=</span>&nbsp;<span class="ident" id="6233110">s</span><span class="op" id="6233111">.</span><span class="ident" id="6233112">srcPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6233122">//&nbsp;read&nbsp;more&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6233144">//&nbsp;(an&nbsp;io.Reader&nbsp;must&nbsp;return&nbsp;io.EOF&nbsp;when&nbsp;it&nbsp;reaches</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6233199">//&nbsp;the&nbsp;end&nbsp;of&nbsp;what&nbsp;it&nbsp;is&nbsp;reading&nbsp;-&nbsp;simply&nbsp;returning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6233254">//&nbsp;n&nbsp;==&nbsp;0&nbsp;will&nbsp;make&nbsp;this&nbsp;loop&nbsp;retry&nbsp;forever;&nbsp;but&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6233310">//&nbsp;error&nbsp;is&nbsp;in&nbsp;the&nbsp;reader&nbsp;implementation&nbsp;in&nbsp;that&nbsp;case)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6233368">i</span>&nbsp;<span class="op" id="6233370">:=</span>&nbsp;<span class="ident" id="6233373">s</span><span class="op" id="6233374">.</span><span class="ident" id="6233375">srcEnd</span>&nbsp;<span class="op" id="6233382">-</span>&nbsp;<span class="ident" id="6233384">s</span><span class="op" id="6233385">.</span><span class="ident" id="6233386">srcPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6233396">n</span><span class="op" id="6233397">,</span>&nbsp;<span class="ident" id="6233399">err</span>&nbsp;<span class="op" id="6233403">:=</span>&nbsp;<span class="ident" id="6233406">s</span><span class="op" id="6233407">.</span><span class="ident" id="6233408">src</span><span class="op" id="6233411">.</span><span class="ident" id="6233412">Read</span><span class="op" id="6233416">(</span><span class="ident" id="6233417">s</span><span class="op" id="6233418">.</span><span class="ident" id="6233419">srcBuf</span><span class="op" id="6233425">[</span><span class="ident" id="6233426">i</span><span class="op" id="6233427">:</span><span class="ident" id="6233428">bufLen</span><span class="op" id="6233434">]</span><span class="op" id="6233435">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6233440">s</span><span class="op" id="6233441">.</span><span class="ident" id="6233442">srcPos</span>&nbsp;<span class="op" id="6233449">=</span>&nbsp;<span class="num" id="6233451">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6233456">s</span><span class="op" id="6233457">.</span><span class="ident" id="6233458">srcEnd</span>&nbsp;<span class="op" id="6233465">=</span>&nbsp;<span class="ident" id="6233467">i</span>&nbsp;<span class="op" id="6233469">+</span>&nbsp;<span class="ident" id="6233471">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6233476">s</span><span class="op" id="6233477">.</span><span class="ident" id="6233478">srcBuf</span><span class="op" id="6233484">[</span><span class="ident" id="6233485">s</span><span class="op" id="6233486">.</span><span class="ident" id="6233487">srcEnd</span><span class="op" id="6233493">]</span>&nbsp;<span class="op" id="6233495">=</span>&nbsp;<span class="ident" id="6233497">utf8</span><span class="op" id="6233501">.</span><span class="ident" id="6233502">RuneSelf</span>&nbsp;<span class="comment" id="6233511">//&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6233526">if</span>&nbsp;<span class="ident" id="6233529">err</span>&nbsp;<span class="op" id="6233533">!=</span>&nbsp;<span class="ident" id="6233536">nil</span>&nbsp;<span class="op" id="6233540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6233546">if</span>&nbsp;<span class="ident" id="6233549">err</span>&nbsp;<span class="op" id="6233553">!=</span>&nbsp;<span class="ident" id="6233556">io</span><span class="op" id="6233558">.</span><span class="ident" id="6233559">EOF</span>&nbsp;<span class="op" id="6233563">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6233570">s</span><span class="op" id="6233571">.</span><span class="builtintype" id="6233572">error</span><span class="op" id="6233577">(</span><span class="ident" id="6233578">err</span><span class="op" id="6233581">.</span><span class="ident" id="6233582">Error</span><span class="op" id="6233587">(</span><span class="op" id="6233588">)</span><span class="op" id="6233589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6233595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6233601">if</span>&nbsp;<span class="ident" id="6233604">s</span><span class="op" id="6233605">.</span><span class="ident" id="6233606">srcEnd</span>&nbsp;<span class="op" id="6233613">==</span>&nbsp;<span class="num" id="6233616">0</span>&nbsp;<span class="op" id="6233618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6233625">if</span>&nbsp;<span class="ident" id="6233628">s</span><span class="op" id="6233629">.</span><span class="ident" id="6233630">lastCharLen</span>&nbsp;<span class="op" id="6233642">&gt;</span>&nbsp;<span class="num" id="6233644">0</span>&nbsp;<span class="op" id="6233646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6233654">//&nbsp;previous&nbsp;character&nbsp;was&nbsp;not&nbsp;EOF</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6233694">s</span><span class="op" id="6233695">.</span><span class="ident" id="6233696">column</span><span class="op" id="6233702">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6233710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6233717">s</span><span class="op" id="6233718">.</span><span class="ident" id="6233719">lastCharLen</span>&nbsp;<span class="op" id="6233731">=</span>&nbsp;<span class="num" id="6233733">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6233740">return</span>&nbsp;<span class="ident" id="6233747">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6233755">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6233761">//&nbsp;If&nbsp;err&nbsp;==&nbsp;EOF,&nbsp;we&nbsp;won&#39;t&nbsp;be&nbsp;getting&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6233808">//&nbsp;bytes;&nbsp;break&nbsp;to&nbsp;avoid&nbsp;infinite&nbsp;loop.&nbsp;If</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6233855">//&nbsp;err&nbsp;is&nbsp;something&nbsp;else,&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6233902">//&nbsp;we&nbsp;can&nbsp;get&nbsp;more&nbsp;bytes;&nbsp;thus&nbsp;also&nbsp;break.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6233949">break</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6233958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6233962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6233966">//&nbsp;at&nbsp;least&nbsp;one&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6233989">ch</span>&nbsp;<span class="op" id="6233992">=</span>&nbsp;<span class="builtintype" id="6233994">rune</span><span class="op" id="6233998">(</span><span class="ident" id="6233999">s</span><span class="op" id="6234000">.</span><span class="ident" id="6234001">srcBuf</span><span class="op" id="6234007">[</span><span class="ident" id="6234008">s</span><span class="op" id="6234009">.</span><span class="ident" id="6234010">srcPos</span><span class="op" id="6234016">]</span><span class="op" id="6234017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6234021">if</span>&nbsp;<span class="ident" id="6234024">ch</span>&nbsp;<span class="op" id="6234027">&gt;=</span>&nbsp;<span class="ident" id="6234030">utf8</span><span class="op" id="6234034">.</span><span class="ident" id="6234035">RuneSelf</span>&nbsp;<span class="op" id="6234044">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6234049">//&nbsp;uncommon&nbsp;case:&nbsp;not&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234080">ch</span><span class="op" id="6234082">,</span>&nbsp;<span class="ident" id="6234084">width</span>&nbsp;<span class="op" id="6234090">=</span>&nbsp;<span class="ident" id="6234092">utf8</span><span class="op" id="6234096">.</span><span class="ident" id="6234097">DecodeRune</span><span class="op" id="6234107">(</span><span class="ident" id="6234108">s</span><span class="op" id="6234109">.</span><span class="ident" id="6234110">srcBuf</span><span class="op" id="6234116">[</span><span class="ident" id="6234117">s</span><span class="op" id="6234118">.</span><span class="ident" id="6234119">srcPos</span><span class="op" id="6234125">:</span><span class="ident" id="6234126">s</span><span class="op" id="6234127">.</span><span class="ident" id="6234128">srcEnd</span><span class="op" id="6234134">]</span><span class="op" id="6234135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6234140">if</span>&nbsp;<span class="ident" id="6234143">ch</span>&nbsp;<span class="op" id="6234146">==</span>&nbsp;<span class="ident" id="6234149">utf8</span><span class="op" id="6234153">.</span><span class="ident" id="6234154">RuneError</span>&nbsp;<span class="op" id="6234164">&amp;&amp;</span>&nbsp;<span class="ident" id="6234167">width</span>&nbsp;<span class="op" id="6234173">==</span>&nbsp;<span class="num" id="6234176">1</span>&nbsp;<span class="op" id="6234178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6234184">//&nbsp;advance&nbsp;for&nbsp;correct&nbsp;error&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234226">s</span><span class="op" id="6234227">.</span><span class="ident" id="6234228">srcPos</span>&nbsp;<span class="op" id="6234235">+=</span>&nbsp;<span class="ident" id="6234238">width</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234248">s</span><span class="op" id="6234249">.</span><span class="ident" id="6234250">lastCharLen</span>&nbsp;<span class="op" id="6234262">=</span>&nbsp;<span class="ident" id="6234264">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234274">s</span><span class="op" id="6234275">.</span><span class="ident" id="6234276">column</span><span class="op" id="6234282">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234289">s</span><span class="op" id="6234290">.</span><span class="builtintype" id="6234291">error</span><span class="op" id="6234296">(</span><span class="string" id="6234297">&#34;illegal&nbsp;UTF-8&nbsp;encoding&#34;</span><span class="op" id="6234321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6234327">return</span>&nbsp;<span class="ident" id="6234334">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6234340">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6234344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6234347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6234351">//&nbsp;advance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234363">s</span><span class="op" id="6234364">.</span><span class="ident" id="6234365">srcPos</span>&nbsp;<span class="op" id="6234372">+=</span>&nbsp;<span class="ident" id="6234375">width</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234382">s</span><span class="op" id="6234383">.</span><span class="ident" id="6234384">lastCharLen</span>&nbsp;<span class="op" id="6234396">=</span>&nbsp;<span class="ident" id="6234398">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234405">s</span><span class="op" id="6234406">.</span><span class="ident" id="6234407">column</span><span class="op" id="6234413">++</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6234418">//&nbsp;special&nbsp;situations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6234441">switch</span>&nbsp;<span class="ident" id="6234448">ch</span>&nbsp;<span class="op" id="6234451">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6234454">case</span>&nbsp;<span class="num" id="6234459">0</span><span class="op" id="6234460">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6234464">//&nbsp;for&nbsp;compatibility&nbsp;with&nbsp;other&nbsp;tools</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234504">s</span><span class="op" id="6234505">.</span><span class="builtintype" id="6234506">error</span><span class="op" id="6234511">(</span><span class="string" id="6234512">&#34;illegal&nbsp;character&nbsp;NUL&#34;</span><span class="op" id="6234535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6234538">case</span>&nbsp;<span class="string" id="6234543">&#39;\n&#39;</span><span class="op" id="6234547">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234551">s</span><span class="op" id="6234552">.</span><span class="ident" id="6234553">line</span><span class="op" id="6234557">++</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234562">s</span><span class="op" id="6234563">.</span><span class="ident" id="6234564">lastLineLen</span>&nbsp;<span class="op" id="6234576">=</span>&nbsp;<span class="ident" id="6234578">s</span><span class="op" id="6234579">.</span><span class="ident" id="6234580">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234589">s</span><span class="op" id="6234590">.</span><span class="ident" id="6234591">column</span>&nbsp;<span class="op" id="6234598">=</span>&nbsp;<span class="num" id="6234600">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6234603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6234607">return</span>&nbsp;<span class="ident" id="6234614">ch</span><br>
<span class="lineno">305</span><span class="op" id="6234617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6234620">//&nbsp;Next&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="6234674">//&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source.&nbsp;It&nbsp;reports</span><br>
<span class="lineno"></span><span class="comment" id="6234729">//&nbsp;a&nbsp;read&nbsp;error&nbsp;by&nbsp;calling&nbsp;s.Error,&nbsp;if&nbsp;not&nbsp;nil;&nbsp;otherwise</span><br>
<span class="lineno">310</span><span class="comment" id="6234787">//&nbsp;it&nbsp;prints&nbsp;an&nbsp;error&nbsp;message&nbsp;to&nbsp;os.Stderr.&nbsp;Next&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="6234845">//&nbsp;update&nbsp;the&nbsp;Scanner&#39;s&nbsp;Position&nbsp;field;&nbsp;use&nbsp;Pos()&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="6234898">//&nbsp;get&nbsp;the&nbsp;current&nbsp;position.</span><br>
<span class="lineno"></span><span class="keyword" id="6234927">func</span>&nbsp;<span class="op" id="6234932">(</span><span class="ident" id="6234933">s</span>&nbsp;<span class="op" id="6234935">*</span><span class="ident" id="6234936">Scanner</span><span class="op" id="6234943">)</span>&nbsp;<span class="ident" id="6234945">Next</span><span class="op" id="6234949">(</span><span class="op" id="6234950">)</span>&nbsp;<span class="builtintype" id="6234952">rune</span>&nbsp;<span class="op" id="6234957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234960">s</span><span class="op" id="6234961">.</span><span class="ident" id="6234962">tokPos</span>&nbsp;<span class="op" id="6234969">=</span>&nbsp;<span class="op" id="6234971">-</span><span class="num" id="6234972">1</span>&nbsp;<span class="comment" id="6234974">//&nbsp;don&#39;t&nbsp;collect&nbsp;token&nbsp;text</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6235003">s</span><span class="op" id="6235004">.</span><span class="ident" id="6235005">Line</span>&nbsp;<span class="op" id="6235010">=</span>&nbsp;<span class="num" id="6235012">0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6235017">//&nbsp;invalidate&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6235047">ch</span>&nbsp;<span class="op" id="6235050">:=</span>&nbsp;<span class="ident" id="6235053">s</span><span class="op" id="6235054">.</span><span class="ident" id="6235055">Peek</span><span class="op" id="6235059">(</span><span class="op" id="6235060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6235063">s</span><span class="op" id="6235064">.</span><span class="ident" id="6235065">ch</span>&nbsp;<span class="op" id="6235068">=</span>&nbsp;<span class="ident" id="6235070">s</span><span class="op" id="6235071">.</span><span class="ident" id="6235072">next</span><span class="op" id="6235076">(</span><span class="op" id="6235077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235080">return</span>&nbsp;<span class="ident" id="6235087">ch</span><br>
<span class="lineno"></span><span class="op" id="6235090">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="6235093">//&nbsp;Peek&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character&nbsp;in&nbsp;the&nbsp;source&nbsp;without&nbsp;advancing</span><br>
<span class="lineno"></span><span class="comment" id="6235168">//&nbsp;the&nbsp;scanner.&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;if&nbsp;the&nbsp;scanner&#39;s&nbsp;position&nbsp;is&nbsp;at&nbsp;the&nbsp;last</span><br>
<span class="lineno"></span><span class="comment" id="6235240">//&nbsp;character&nbsp;of&nbsp;the&nbsp;source.</span><br>
<span class="lineno"></span><span class="keyword" id="6235268">func</span>&nbsp;<span class="op" id="6235273">(</span><span class="ident" id="6235274">s</span>&nbsp;<span class="op" id="6235276">*</span><span class="ident" id="6235277">Scanner</span><span class="op" id="6235284">)</span>&nbsp;<span class="ident" id="6235286">Peek</span><span class="op" id="6235290">(</span><span class="op" id="6235291">)</span>&nbsp;<span class="builtintype" id="6235293">rune</span>&nbsp;<span class="op" id="6235298">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235301">if</span>&nbsp;<span class="ident" id="6235304">s</span><span class="op" id="6235305">.</span><span class="ident" id="6235306">ch</span>&nbsp;<span class="op" id="6235309">&lt;</span>&nbsp;<span class="num" id="6235311">0</span>&nbsp;<span class="op" id="6235313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6235317">//&nbsp;this&nbsp;code&nbsp;is&nbsp;only&nbsp;run&nbsp;for&nbsp;the&nbsp;very&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6235373">s</span><span class="op" id="6235374">.</span><span class="ident" id="6235375">ch</span>&nbsp;<span class="op" id="6235378">=</span>&nbsp;<span class="ident" id="6235380">s</span><span class="op" id="6235381">.</span><span class="ident" id="6235382">next</span><span class="op" id="6235386">(</span><span class="op" id="6235387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235391">if</span>&nbsp;<span class="ident" id="6235394">s</span><span class="op" id="6235395">.</span><span class="ident" id="6235396">ch</span>&nbsp;<span class="op" id="6235399">==</span>&nbsp;<span class="string" id="6235402">&#39;\uFEFF&#39;</span>&nbsp;<span class="op" id="6235411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6235416">s</span><span class="op" id="6235417">.</span><span class="ident" id="6235418">ch</span>&nbsp;<span class="op" id="6235421">=</span>&nbsp;<span class="ident" id="6235423">s</span><span class="op" id="6235424">.</span><span class="ident" id="6235425">next</span><span class="op" id="6235429">(</span><span class="op" id="6235430">)</span>&nbsp;<span class="comment" id="6235432">//&nbsp;ignore&nbsp;BOM</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6235448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6235451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235454">return</span>&nbsp;<span class="ident" id="6235461">s</span><span class="op" id="6235462">.</span><span class="ident" id="6235463">ch</span><br>
<span class="lineno"></span><span class="op" id="6235466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="6235469">func</span>&nbsp;<span class="op" id="6235474">(</span><span class="ident" id="6235475">s</span>&nbsp;<span class="op" id="6235477">*</span><span class="ident" id="6235478">Scanner</span><span class="op" id="6235485">)</span>&nbsp;<span class="builtintype" id="6235487">error</span><span class="op" id="6235492">(</span><span class="ident" id="6235493">msg</span>&nbsp;<span class="builtintype" id="6235497">string</span><span class="op" id="6235503">)</span>&nbsp;<span class="op" id="6235505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6235508">s</span><span class="op" id="6235509">.</span><span class="ident" id="6235510">ErrorCount</span><span class="op" id="6235520">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235524">if</span>&nbsp;<span class="ident" id="6235527">s</span><span class="op" id="6235528">.</span><span class="ident" id="6235529">Error</span>&nbsp;<span class="op" id="6235535">!=</span>&nbsp;<span class="ident" id="6235538">nil</span>&nbsp;<span class="op" id="6235542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6235546">s</span><span class="op" id="6235547">.</span><span class="ident" id="6235548">Error</span><span class="op" id="6235553">(</span><span class="ident" id="6235554">s</span><span class="op" id="6235555">,</span>&nbsp;<span class="ident" id="6235557">msg</span><span class="op" id="6235560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235564">return</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6235572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6235575">pos</span>&nbsp;<span class="op" id="6235579">:=</span>&nbsp;<span class="ident" id="6235582">s</span><span class="op" id="6235583">.</span><span class="ident" id="6235584">Position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235594">if</span>&nbsp;<span class="op" id="6235597">!</span><span class="ident" id="6235598">pos</span><span class="op" id="6235601">.</span><span class="ident" id="6235602">IsValid</span><span class="op" id="6235609">(</span><span class="op" id="6235610">)</span>&nbsp;<span class="op" id="6235612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6235616">pos</span>&nbsp;<span class="op" id="6235620">=</span>&nbsp;<span class="ident" id="6235622">s</span><span class="op" id="6235623">.</span><span class="ident" id="6235624">Pos</span><span class="op" id="6235627">(</span><span class="op" id="6235628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6235631">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6235634">fmt</span><span class="op" id="6235637">.</span><span class="ident" id="6235638">Fprintf</span><span class="op" id="6235645">(</span><span class="ident" id="6235646">os</span><span class="op" id="6235648">.</span><span class="ident" id="6235649">Stderr</span><span class="op" id="6235655">,</span>&nbsp;<span class="string" id="6235657">&#34;%s:&nbsp;%s\n&#34;</span><span class="op" id="6235667">,</span>&nbsp;<span class="ident" id="6235669">pos</span><span class="op" id="6235672">,</span>&nbsp;<span class="ident" id="6235674">msg</span><span class="op" id="6235677">)</span><br>
<span class="lineno"></span><span class="op" id="6235679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6235682">func</span>&nbsp;<span class="op" id="6235687">(</span><span class="ident" id="6235688">s</span>&nbsp;<span class="op" id="6235690">*</span><span class="ident" id="6235691">Scanner</span><span class="op" id="6235698">)</span>&nbsp;<span class="ident" id="6235700">isIdentRune</span><span class="op" id="6235711">(</span><span class="ident" id="6235712">ch</span>&nbsp;<span class="builtintype" id="6235715">rune</span><span class="op" id="6235719">,</span>&nbsp;<span class="ident" id="6235721">i</span>&nbsp;<span class="builtintype" id="6235723">int</span><span class="op" id="6235726">)</span>&nbsp;<span class="builtintype" id="6235728">bool</span>&nbsp;<span class="op" id="6235733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235736">if</span>&nbsp;<span class="ident" id="6235739">s</span><span class="op" id="6235740">.</span><span class="ident" id="6235741">IsIdentRune</span>&nbsp;<span class="op" id="6235753">!=</span>&nbsp;<span class="ident" id="6235756">nil</span>&nbsp;<span class="op" id="6235760">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235764">return</span>&nbsp;<span class="ident" id="6235771">s</span><span class="op" id="6235772">.</span><span class="ident" id="6235773">IsIdentRune</span><span class="op" id="6235784">(</span><span class="ident" id="6235785">ch</span><span class="op" id="6235787">,</span>&nbsp;<span class="ident" id="6235789">i</span><span class="op" id="6235790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6235793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235796">return</span>&nbsp;<span class="ident" id="6235803">ch</span>&nbsp;<span class="op" id="6235806">==</span>&nbsp;<span class="string" id="6235809">&#39;_&#39;</span>&nbsp;<span class="op" id="6235813">||</span>&nbsp;<span class="ident" id="6235816">unicode</span><span class="op" id="6235823">.</span><span class="ident" id="6235824">IsLetter</span><span class="op" id="6235832">(</span><span class="ident" id="6235833">ch</span><span class="op" id="6235835">)</span>&nbsp;<span class="op" id="6235837">||</span>&nbsp;<span class="ident" id="6235840">unicode</span><span class="op" id="6235847">.</span><span class="ident" id="6235848">IsDigit</span><span class="op" id="6235855">(</span><span class="ident" id="6235856">ch</span><span class="op" id="6235858">)</span>&nbsp;<span class="op" id="6235860">&amp;&amp;</span>&nbsp;<span class="ident" id="6235863">i</span>&nbsp;<span class="op" id="6235865">&gt;</span>&nbsp;<span class="num" id="6235867">0</span><br>
<span class="lineno"></span><span class="op" id="6235869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="keyword" id="6235872">func</span>&nbsp;<span class="op" id="6235877">(</span><span class="ident" id="6235878">s</span>&nbsp;<span class="op" id="6235880">*</span><span class="ident" id="6235881">Scanner</span><span class="op" id="6235888">)</span>&nbsp;<span class="ident" id="6235890">scanIdentifier</span><span class="op" id="6235904">(</span><span class="op" id="6235905">)</span>&nbsp;<span class="builtintype" id="6235907">rune</span>&nbsp;<span class="op" id="6235912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6235915">//&nbsp;we&nbsp;know&nbsp;the&nbsp;zero&#39;th&nbsp;rune&nbsp;is&nbsp;OK;&nbsp;start&nbsp;scanning&nbsp;at&nbsp;the&nbsp;next&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6235982">ch</span>&nbsp;<span class="op" id="6235985">:=</span>&nbsp;<span class="ident" id="6235988">s</span><span class="op" id="6235989">.</span><span class="ident" id="6235990">next</span><span class="op" id="6235994">(</span><span class="op" id="6235995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235998">for</span>&nbsp;<span class="ident" id="6236002">i</span>&nbsp;<span class="op" id="6236004">:=</span>&nbsp;<span class="num" id="6236007">1</span><span class="op" id="6236008">;</span>&nbsp;<span class="ident" id="6236010">s</span><span class="op" id="6236011">.</span><span class="ident" id="6236012">isIdentRune</span><span class="op" id="6236023">(</span><span class="ident" id="6236024">ch</span><span class="op" id="6236026">,</span>&nbsp;<span class="ident" id="6236028">i</span><span class="op" id="6236029">)</span><span class="op" id="6236030">;</span>&nbsp;<span class="ident" id="6236032">i</span><span class="op" id="6236033">++</span>&nbsp;<span class="op" id="6236036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236040">ch</span>&nbsp;<span class="op" id="6236043">=</span>&nbsp;<span class="ident" id="6236045">s</span><span class="op" id="6236046">.</span><span class="ident" id="6236047">next</span><span class="op" id="6236051">(</span><span class="op" id="6236052">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6236055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236058">return</span>&nbsp;<span class="ident" id="6236065">ch</span><br>
<span class="lineno"></span><span class="op" id="6236068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6236071">func</span>&nbsp;<span class="ident" id="6236076">digitVal</span><span class="op" id="6236084">(</span><span class="ident" id="6236085">ch</span>&nbsp;<span class="builtintype" id="6236088">rune</span><span class="op" id="6236092">)</span>&nbsp;<span class="builtintype" id="6236094">int</span>&nbsp;<span class="op" id="6236098">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236101">switch</span>&nbsp;<span class="op" id="6236108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236111">case</span>&nbsp;<span class="string" id="6236116">&#39;0&#39;</span>&nbsp;<span class="op" id="6236120">&lt;=</span>&nbsp;<span class="ident" id="6236123">ch</span>&nbsp;<span class="op" id="6236126">&amp;&amp;</span>&nbsp;<span class="ident" id="6236129">ch</span>&nbsp;<span class="op" id="6236132">&lt;=</span>&nbsp;<span class="string" id="6236135">&#39;9&#39;</span><span class="op" id="6236138">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236142">return</span>&nbsp;<span class="builtintype" id="6236149">int</span><span class="op" id="6236152">(</span><span class="ident" id="6236153">ch</span>&nbsp;<span class="op" id="6236156">-</span>&nbsp;<span class="string" id="6236158">&#39;0&#39;</span><span class="op" id="6236161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236164">case</span>&nbsp;<span class="string" id="6236169">&#39;a&#39;</span>&nbsp;<span class="op" id="6236173">&lt;=</span>&nbsp;<span class="ident" id="6236176">ch</span>&nbsp;<span class="op" id="6236179">&amp;&amp;</span>&nbsp;<span class="ident" id="6236182">ch</span>&nbsp;<span class="op" id="6236185">&lt;=</span>&nbsp;<span class="string" id="6236188">&#39;f&#39;</span><span class="op" id="6236191">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236195">return</span>&nbsp;<span class="builtintype" id="6236202">int</span><span class="op" id="6236205">(</span><span class="ident" id="6236206">ch</span>&nbsp;<span class="op" id="6236209">-</span>&nbsp;<span class="string" id="6236211">&#39;a&#39;</span>&nbsp;<span class="op" id="6236215">+</span>&nbsp;<span class="num" id="6236217">10</span><span class="op" id="6236219">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236222">case</span>&nbsp;<span class="string" id="6236227">&#39;A&#39;</span>&nbsp;<span class="op" id="6236231">&lt;=</span>&nbsp;<span class="ident" id="6236234">ch</span>&nbsp;<span class="op" id="6236237">&amp;&amp;</span>&nbsp;<span class="ident" id="6236240">ch</span>&nbsp;<span class="op" id="6236243">&lt;=</span>&nbsp;<span class="string" id="6236246">&#39;F&#39;</span><span class="op" id="6236249">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236253">return</span>&nbsp;<span class="builtintype" id="6236260">int</span><span class="op" id="6236263">(</span><span class="ident" id="6236264">ch</span>&nbsp;<span class="op" id="6236267">-</span>&nbsp;<span class="string" id="6236269">&#39;A&#39;</span>&nbsp;<span class="op" id="6236273">+</span>&nbsp;<span class="num" id="6236275">10</span><span class="op" id="6236277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6236280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236283">return</span>&nbsp;<span class="num" id="6236290">16</span>&nbsp;<span class="comment" id="6236293">//&nbsp;larger&nbsp;than&nbsp;any&nbsp;legal&nbsp;digit&nbsp;val</span><br>
<span class="lineno"></span><span class="op" id="6236328">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span><span class="keyword" id="6236331">func</span>&nbsp;<span class="ident" id="6236336">isDecimal</span><span class="op" id="6236345">(</span><span class="ident" id="6236346">ch</span>&nbsp;<span class="builtintype" id="6236349">rune</span><span class="op" id="6236353">)</span>&nbsp;<span class="builtintype" id="6236355">bool</span>&nbsp;<span class="op" id="6236360">{</span>&nbsp;<span class="keyword" id="6236362">return</span>&nbsp;<span class="string" id="6236369">&#39;0&#39;</span>&nbsp;<span class="op" id="6236373">&lt;=</span>&nbsp;<span class="ident" id="6236376">ch</span>&nbsp;<span class="op" id="6236379">&amp;&amp;</span>&nbsp;<span class="ident" id="6236382">ch</span>&nbsp;<span class="op" id="6236385">&lt;=</span>&nbsp;<span class="string" id="6236388">&#39;9&#39;</span>&nbsp;<span class="op" id="6236392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6236395">func</span>&nbsp;<span class="op" id="6236400">(</span><span class="ident" id="6236401">s</span>&nbsp;<span class="op" id="6236403">*</span><span class="ident" id="6236404">Scanner</span><span class="op" id="6236411">)</span>&nbsp;<span class="ident" id="6236413">scanMantissa</span><span class="op" id="6236425">(</span><span class="ident" id="6236426">ch</span>&nbsp;<span class="builtintype" id="6236429">rune</span><span class="op" id="6236433">)</span>&nbsp;<span class="builtintype" id="6236435">rune</span>&nbsp;<span class="op" id="6236440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236443">for</span>&nbsp;<span class="ident" id="6236447">isDecimal</span><span class="op" id="6236456">(</span><span class="ident" id="6236457">ch</span><span class="op" id="6236459">)</span>&nbsp;<span class="op" id="6236461">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236465">ch</span>&nbsp;<span class="op" id="6236468">=</span>&nbsp;<span class="ident" id="6236470">s</span><span class="op" id="6236471">.</span><span class="ident" id="6236472">next</span><span class="op" id="6236476">(</span><span class="op" id="6236477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6236480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236483">return</span>&nbsp;<span class="ident" id="6236490">ch</span><br>
<span class="lineno"></span><span class="op" id="6236493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="6236496">func</span>&nbsp;<span class="op" id="6236501">(</span><span class="ident" id="6236502">s</span>&nbsp;<span class="op" id="6236504">*</span><span class="ident" id="6236505">Scanner</span><span class="op" id="6236512">)</span>&nbsp;<span class="ident" id="6236514">scanFraction</span><span class="op" id="6236526">(</span><span class="ident" id="6236527">ch</span>&nbsp;<span class="builtintype" id="6236530">rune</span><span class="op" id="6236534">)</span>&nbsp;<span class="builtintype" id="6236536">rune</span>&nbsp;<span class="op" id="6236541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236544">if</span>&nbsp;<span class="ident" id="6236547">ch</span>&nbsp;<span class="op" id="6236550">==</span>&nbsp;<span class="string" id="6236553">&#39;.&#39;</span>&nbsp;<span class="op" id="6236557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236561">ch</span>&nbsp;<span class="op" id="6236564">=</span>&nbsp;<span class="ident" id="6236566">s</span><span class="op" id="6236567">.</span><span class="ident" id="6236568">scanMantissa</span><span class="op" id="6236580">(</span><span class="ident" id="6236581">s</span><span class="op" id="6236582">.</span><span class="ident" id="6236583">next</span><span class="op" id="6236587">(</span><span class="op" id="6236588">)</span><span class="op" id="6236589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6236592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236595">return</span>&nbsp;<span class="ident" id="6236602">ch</span><br>
<span class="lineno">390</span><span class="op" id="6236605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6236608">func</span>&nbsp;<span class="op" id="6236613">(</span><span class="ident" id="6236614">s</span>&nbsp;<span class="op" id="6236616">*</span><span class="ident" id="6236617">Scanner</span><span class="op" id="6236624">)</span>&nbsp;<span class="ident" id="6236626">scanExponent</span><span class="op" id="6236638">(</span><span class="ident" id="6236639">ch</span>&nbsp;<span class="builtintype" id="6236642">rune</span><span class="op" id="6236646">)</span>&nbsp;<span class="builtintype" id="6236648">rune</span>&nbsp;<span class="op" id="6236653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236656">if</span>&nbsp;<span class="ident" id="6236659">ch</span>&nbsp;<span class="op" id="6236662">==</span>&nbsp;<span class="string" id="6236665">&#39;e&#39;</span>&nbsp;<span class="op" id="6236669">||</span>&nbsp;<span class="ident" id="6236672">ch</span>&nbsp;<span class="op" id="6236675">==</span>&nbsp;<span class="string" id="6236678">&#39;E&#39;</span>&nbsp;<span class="op" id="6236682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236686">ch</span>&nbsp;<span class="op" id="6236689">=</span>&nbsp;<span class="ident" id="6236691">s</span><span class="op" id="6236692">.</span><span class="ident" id="6236693">next</span><span class="op" id="6236697">(</span><span class="op" id="6236698">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236702">if</span>&nbsp;<span class="ident" id="6236705">ch</span>&nbsp;<span class="op" id="6236708">==</span>&nbsp;<span class="string" id="6236711">&#39;-&#39;</span>&nbsp;<span class="op" id="6236715">||</span>&nbsp;<span class="ident" id="6236718">ch</span>&nbsp;<span class="op" id="6236721">==</span>&nbsp;<span class="string" id="6236724">&#39;+&#39;</span>&nbsp;<span class="op" id="6236728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236733">ch</span>&nbsp;<span class="op" id="6236736">=</span>&nbsp;<span class="ident" id="6236738">s</span><span class="op" id="6236739">.</span><span class="ident" id="6236740">next</span><span class="op" id="6236744">(</span><span class="op" id="6236745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6236749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236753">ch</span>&nbsp;<span class="op" id="6236756">=</span>&nbsp;<span class="ident" id="6236758">s</span><span class="op" id="6236759">.</span><span class="ident" id="6236760">scanMantissa</span><span class="op" id="6236772">(</span><span class="ident" id="6236773">ch</span><span class="op" id="6236775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6236778">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236781">return</span>&nbsp;<span class="ident" id="6236788">ch</span><br>
<span class="lineno"></span><span class="op" id="6236791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6236794">func</span>&nbsp;<span class="op" id="6236799">(</span><span class="ident" id="6236800">s</span>&nbsp;<span class="op" id="6236802">*</span><span class="ident" id="6236803">Scanner</span><span class="op" id="6236810">)</span>&nbsp;<span class="ident" id="6236812">scanNumber</span><span class="op" id="6236822">(</span><span class="ident" id="6236823">ch</span>&nbsp;<span class="builtintype" id="6236826">rune</span><span class="op" id="6236830">)</span>&nbsp;<span class="op" id="6236832">(</span><span class="builtintype" id="6236833">rune</span><span class="op" id="6236837">,</span>&nbsp;<span class="builtintype" id="6236839">rune</span><span class="op" id="6236843">)</span>&nbsp;<span class="op" id="6236845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6236848">//&nbsp;isDecimal(ch)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236866">if</span>&nbsp;<span class="ident" id="6236869">ch</span>&nbsp;<span class="op" id="6236872">==</span>&nbsp;<span class="string" id="6236875">&#39;0&#39;</span>&nbsp;<span class="op" id="6236879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6236883">//&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236901">ch</span>&nbsp;<span class="op" id="6236904">=</span>&nbsp;<span class="ident" id="6236906">s</span><span class="op" id="6236907">.</span><span class="ident" id="6236908">next</span><span class="op" id="6236912">(</span><span class="op" id="6236913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236917">if</span>&nbsp;<span class="ident" id="6236920">ch</span>&nbsp;<span class="op" id="6236923">==</span>&nbsp;<span class="string" id="6236926">&#39;x&#39;</span>&nbsp;<span class="op" id="6236930">||</span>&nbsp;<span class="ident" id="6236933">ch</span>&nbsp;<span class="op" id="6236936">==</span>&nbsp;<span class="string" id="6236939">&#39;X&#39;</span>&nbsp;<span class="op" id="6236943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6236948">//&nbsp;hexadecimal&nbsp;int</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236970">ch</span>&nbsp;<span class="op" id="6236973">=</span>&nbsp;<span class="ident" id="6236975">s</span><span class="op" id="6236976">.</span><span class="ident" id="6236977">next</span><span class="op" id="6236981">(</span><span class="op" id="6236982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236987">hasMantissa</span>&nbsp;<span class="op" id="6236999">:=</span>&nbsp;<span class="builtintype" id="6237002">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6237011">for</span>&nbsp;<span class="ident" id="6237015">digitVal</span><span class="op" id="6237023">(</span><span class="ident" id="6237024">ch</span><span class="op" id="6237026">)</span>&nbsp;<span class="op" id="6237028">&lt;</span>&nbsp;<span class="num" id="6237030">16</span>&nbsp;<span class="op" id="6237033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237039">ch</span>&nbsp;<span class="op" id="6237042">=</span>&nbsp;<span class="ident" id="6237044">s</span><span class="op" id="6237045">.</span><span class="ident" id="6237046">next</span><span class="op" id="6237050">(</span><span class="op" id="6237051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237057">hasMantissa</span>&nbsp;<span class="op" id="6237069">=</span>&nbsp;<span class="builtintype" id="6237071">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6237079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6237084">if</span>&nbsp;<span class="op" id="6237087">!</span><span class="ident" id="6237088">hasMantissa</span>&nbsp;<span class="op" id="6237100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237106">s</span><span class="op" id="6237107">.</span><span class="builtintype" id="6237108">error</span><span class="op" id="6237113">(</span><span class="string" id="6237114">&#34;illegal&nbsp;hexadecimal&nbsp;number&#34;</span><span class="op" id="6237142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6237147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6237151">}</span>&nbsp;<span class="keyword" id="6237153">else</span>&nbsp;<span class="op" id="6237158">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6237163">//&nbsp;octal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237188">has8or9</span>&nbsp;<span class="op" id="6237196">:=</span>&nbsp;<span class="builtintype" id="6237199">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6237208">for</span>&nbsp;<span class="ident" id="6237212">isDecimal</span><span class="op" id="6237221">(</span><span class="ident" id="6237222">ch</span><span class="op" id="6237224">)</span>&nbsp;<span class="op" id="6237226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6237232">if</span>&nbsp;<span class="ident" id="6237235">ch</span>&nbsp;<span class="op" id="6237238">&gt;</span>&nbsp;<span class="string" id="6237240">&#39;7&#39;</span>&nbsp;<span class="op" id="6237244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237251">has8or9</span>&nbsp;<span class="op" id="6237259">=</span>&nbsp;<span class="builtintype" id="6237261">true</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6237270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237276">ch</span>&nbsp;<span class="op" id="6237279">=</span>&nbsp;<span class="ident" id="6237281">s</span><span class="op" id="6237282">.</span><span class="ident" id="6237283">next</span><span class="op" id="6237287">(</span><span class="op" id="6237288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6237293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6237298">if</span>&nbsp;<span class="ident" id="6237301">s</span><span class="op" id="6237302">.</span><span class="ident" id="6237303">Mode</span><span class="op" id="6237307">&amp;</span><span class="ident" id="6237308">ScanFloats</span>&nbsp;<span class="op" id="6237319">!=</span>&nbsp;<span class="num" id="6237322">0</span>&nbsp;<span class="op" id="6237324">&amp;&amp;</span>&nbsp;<span class="op" id="6237327">(</span><span class="ident" id="6237328">ch</span>&nbsp;<span class="op" id="6237331">==</span>&nbsp;<span class="string" id="6237334">&#39;.&#39;</span>&nbsp;<span class="op" id="6237338">||</span>&nbsp;<span class="ident" id="6237341">ch</span>&nbsp;<span class="op" id="6237344">==</span>&nbsp;<span class="string" id="6237347">&#39;e&#39;</span>&nbsp;<span class="op" id="6237351">||</span>&nbsp;<span class="ident" id="6237354">ch</span>&nbsp;<span class="op" id="6237357">==</span>&nbsp;<span class="string" id="6237360">&#39;E&#39;</span><span class="op" id="6237363">)</span>&nbsp;<span class="op" id="6237365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6237371">//&nbsp;float</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237384">ch</span>&nbsp;<span class="op" id="6237387">=</span>&nbsp;<span class="ident" id="6237389">s</span><span class="op" id="6237390">.</span><span class="ident" id="6237391">scanFraction</span><span class="op" id="6237403">(</span><span class="ident" id="6237404">ch</span><span class="op" id="6237406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237412">ch</span>&nbsp;<span class="op" id="6237415">=</span>&nbsp;<span class="ident" id="6237417">s</span><span class="op" id="6237418">.</span><span class="ident" id="6237419">scanExponent</span><span class="op" id="6237431">(</span><span class="ident" id="6237432">ch</span><span class="op" id="6237434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6237440">return</span>&nbsp;<span class="ident" id="6237447">Float</span><span class="op" id="6237452">,</span>&nbsp;<span class="ident" id="6237454">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6237460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6237465">//&nbsp;octal&nbsp;int</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6237481">if</span>&nbsp;<span class="ident" id="6237484">has8or9</span>&nbsp;<span class="op" id="6237492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237498">s</span><span class="op" id="6237499">.</span><span class="builtintype" id="6237500">error</span><span class="op" id="6237505">(</span><span class="string" id="6237506">&#34;illegal&nbsp;octal&nbsp;number&#34;</span><span class="op" id="6237528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6237533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6237537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6237541">return</span>&nbsp;<span class="ident" id="6237548">Int</span><span class="op" id="6237551">,</span>&nbsp;<span class="ident" id="6237553">ch</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6237557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6237560">//&nbsp;decimal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237585">ch</span>&nbsp;<span class="op" id="6237588">=</span>&nbsp;<span class="ident" id="6237590">s</span><span class="op" id="6237591">.</span><span class="ident" id="6237592">scanMantissa</span><span class="op" id="6237604">(</span><span class="ident" id="6237605">ch</span><span class="op" id="6237607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6237610">if</span>&nbsp;<span class="ident" id="6237613">s</span><span class="op" id="6237614">.</span><span class="ident" id="6237615">Mode</span><span class="op" id="6237619">&amp;</span><span class="ident" id="6237620">ScanFloats</span>&nbsp;<span class="op" id="6237631">!=</span>&nbsp;<span class="num" id="6237634">0</span>&nbsp;<span class="op" id="6237636">&amp;&amp;</span>&nbsp;<span class="op" id="6237639">(</span><span class="ident" id="6237640">ch</span>&nbsp;<span class="op" id="6237643">==</span>&nbsp;<span class="string" id="6237646">&#39;.&#39;</span>&nbsp;<span class="op" id="6237650">||</span>&nbsp;<span class="ident" id="6237653">ch</span>&nbsp;<span class="op" id="6237656">==</span>&nbsp;<span class="string" id="6237659">&#39;e&#39;</span>&nbsp;<span class="op" id="6237663">||</span>&nbsp;<span class="ident" id="6237666">ch</span>&nbsp;<span class="op" id="6237669">==</span>&nbsp;<span class="string" id="6237672">&#39;E&#39;</span><span class="op" id="6237675">)</span>&nbsp;<span class="op" id="6237677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6237681">//&nbsp;float</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237692">ch</span>&nbsp;<span class="op" id="6237695">=</span>&nbsp;<span class="ident" id="6237697">s</span><span class="op" id="6237698">.</span><span class="ident" id="6237699">scanFraction</span><span class="op" id="6237711">(</span><span class="ident" id="6237712">ch</span><span class="op" id="6237714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237718">ch</span>&nbsp;<span class="op" id="6237721">=</span>&nbsp;<span class="ident" id="6237723">s</span><span class="op" id="6237724">.</span><span class="ident" id="6237725">scanExponent</span><span class="op" id="6237737">(</span><span class="ident" id="6237738">ch</span><span class="op" id="6237740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6237744">return</span>&nbsp;<span class="ident" id="6237751">Float</span><span class="op" id="6237756">,</span>&nbsp;<span class="ident" id="6237758">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6237762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6237765">return</span>&nbsp;<span class="ident" id="6237772">Int</span><span class="op" id="6237775">,</span>&nbsp;<span class="ident" id="6237777">ch</span><br>
<span class="lineno">450</span><span class="op" id="6237780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6237783">func</span>&nbsp;<span class="op" id="6237788">(</span><span class="ident" id="6237789">s</span>&nbsp;<span class="op" id="6237791">*</span><span class="ident" id="6237792">Scanner</span><span class="op" id="6237799">)</span>&nbsp;<span class="ident" id="6237801">scanDigits</span><span class="op" id="6237811">(</span><span class="ident" id="6237812">ch</span>&nbsp;<span class="builtintype" id="6237815">rune</span><span class="op" id="6237819">,</span>&nbsp;<span class="ident" id="6237821">base</span><span class="op" id="6237825">,</span>&nbsp;<span class="ident" id="6237827">n</span>&nbsp;<span class="builtintype" id="6237829">int</span><span class="op" id="6237832">)</span>&nbsp;<span class="builtintype" id="6237834">rune</span>&nbsp;<span class="op" id="6237839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6237842">for</span>&nbsp;<span class="ident" id="6237846">n</span>&nbsp;<span class="op" id="6237848">&gt;</span>&nbsp;<span class="num" id="6237850">0</span>&nbsp;<span class="op" id="6237852">&amp;&amp;</span>&nbsp;<span class="ident" id="6237855">digitVal</span><span class="op" id="6237863">(</span><span class="ident" id="6237864">ch</span><span class="op" id="6237866">)</span>&nbsp;<span class="op" id="6237868">&lt;</span>&nbsp;<span class="ident" id="6237870">base</span>&nbsp;<span class="op" id="6237875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237879">ch</span>&nbsp;<span class="op" id="6237882">=</span>&nbsp;<span class="ident" id="6237884">s</span><span class="op" id="6237885">.</span><span class="ident" id="6237886">next</span><span class="op" id="6237890">(</span><span class="op" id="6237891">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237895">n</span><span class="op" id="6237896">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6237900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6237903">if</span>&nbsp;<span class="ident" id="6237906">n</span>&nbsp;<span class="op" id="6237908">&gt;</span>&nbsp;<span class="num" id="6237910">0</span>&nbsp;<span class="op" id="6237912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237916">s</span><span class="op" id="6237917">.</span><span class="builtintype" id="6237918">error</span><span class="op" id="6237923">(</span><span class="string" id="6237924">&#34;illegal&nbsp;char&nbsp;escape&#34;</span><span class="op" id="6237945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6237948">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6237951">return</span>&nbsp;<span class="ident" id="6237958">ch</span><br>
<span class="lineno"></span><span class="op" id="6237961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6237964">func</span>&nbsp;<span class="op" id="6237969">(</span><span class="ident" id="6237970">s</span>&nbsp;<span class="op" id="6237972">*</span><span class="ident" id="6237973">Scanner</span><span class="op" id="6237980">)</span>&nbsp;<span class="ident" id="6237982">scanEscape</span><span class="op" id="6237992">(</span><span class="ident" id="6237993">quote</span>&nbsp;<span class="builtintype" id="6237999">rune</span><span class="op" id="6238003">)</span>&nbsp;<span class="builtintype" id="6238005">rune</span>&nbsp;<span class="op" id="6238010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238013">ch</span>&nbsp;<span class="op" id="6238016">:=</span>&nbsp;<span class="ident" id="6238019">s</span><span class="op" id="6238020">.</span><span class="ident" id="6238021">next</span><span class="op" id="6238025">(</span><span class="op" id="6238026">)</span>&nbsp;<span class="comment" id="6238028">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#39;/&#39;</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6238057">switch</span>&nbsp;<span class="ident" id="6238064">ch</span>&nbsp;<span class="op" id="6238067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6238070">case</span>&nbsp;<span class="string" id="6238075">&#39;a&#39;</span><span class="op" id="6238078">,</span>&nbsp;<span class="string" id="6238080">&#39;b&#39;</span><span class="op" id="6238083">,</span>&nbsp;<span class="string" id="6238085">&#39;f&#39;</span><span class="op" id="6238088">,</span>&nbsp;<span class="string" id="6238090">&#39;n&#39;</span><span class="op" id="6238093">,</span>&nbsp;<span class="string" id="6238095">&#39;r&#39;</span><span class="op" id="6238098">,</span>&nbsp;<span class="string" id="6238100">&#39;t&#39;</span><span class="op" id="6238103">,</span>&nbsp;<span class="string" id="6238105">&#39;v&#39;</span><span class="op" id="6238108">,</span>&nbsp;<span class="string" id="6238110">&#39;\\&#39;</span><span class="op" id="6238114">,</span>&nbsp;<span class="ident" id="6238116">quote</span><span class="op" id="6238121">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6238125">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238144">ch</span>&nbsp;<span class="op" id="6238147">=</span>&nbsp;<span class="ident" id="6238149">s</span><span class="op" id="6238150">.</span><span class="ident" id="6238151">next</span><span class="op" id="6238155">(</span><span class="op" id="6238156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6238159">case</span>&nbsp;<span class="string" id="6238164">&#39;0&#39;</span><span class="op" id="6238167">,</span>&nbsp;<span class="string" id="6238169">&#39;1&#39;</span><span class="op" id="6238172">,</span>&nbsp;<span class="string" id="6238174">&#39;2&#39;</span><span class="op" id="6238177">,</span>&nbsp;<span class="string" id="6238179">&#39;3&#39;</span><span class="op" id="6238182">,</span>&nbsp;<span class="string" id="6238184">&#39;4&#39;</span><span class="op" id="6238187">,</span>&nbsp;<span class="string" id="6238189">&#39;5&#39;</span><span class="op" id="6238192">,</span>&nbsp;<span class="string" id="6238194">&#39;6&#39;</span><span class="op" id="6238197">,</span>&nbsp;<span class="string" id="6238199">&#39;7&#39;</span><span class="op" id="6238202">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238206">ch</span>&nbsp;<span class="op" id="6238209">=</span>&nbsp;<span class="ident" id="6238211">s</span><span class="op" id="6238212">.</span><span class="ident" id="6238213">scanDigits</span><span class="op" id="6238223">(</span><span class="ident" id="6238224">ch</span><span class="op" id="6238226">,</span>&nbsp;<span class="num" id="6238228">8</span><span class="op" id="6238229">,</span>&nbsp;<span class="num" id="6238231">3</span><span class="op" id="6238232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6238235">case</span>&nbsp;<span class="string" id="6238240">&#39;x&#39;</span><span class="op" id="6238243">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238247">ch</span>&nbsp;<span class="op" id="6238250">=</span>&nbsp;<span class="ident" id="6238252">s</span><span class="op" id="6238253">.</span><span class="ident" id="6238254">scanDigits</span><span class="op" id="6238264">(</span><span class="ident" id="6238265">s</span><span class="op" id="6238266">.</span><span class="ident" id="6238267">next</span><span class="op" id="6238271">(</span><span class="op" id="6238272">)</span><span class="op" id="6238273">,</span>&nbsp;<span class="num" id="6238275">16</span><span class="op" id="6238277">,</span>&nbsp;<span class="num" id="6238279">2</span><span class="op" id="6238280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6238283">case</span>&nbsp;<span class="string" id="6238288">&#39;u&#39;</span><span class="op" id="6238291">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238295">ch</span>&nbsp;<span class="op" id="6238298">=</span>&nbsp;<span class="ident" id="6238300">s</span><span class="op" id="6238301">.</span><span class="ident" id="6238302">scanDigits</span><span class="op" id="6238312">(</span><span class="ident" id="6238313">s</span><span class="op" id="6238314">.</span><span class="ident" id="6238315">next</span><span class="op" id="6238319">(</span><span class="op" id="6238320">)</span><span class="op" id="6238321">,</span>&nbsp;<span class="num" id="6238323">16</span><span class="op" id="6238325">,</span>&nbsp;<span class="num" id="6238327">4</span><span class="op" id="6238328">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6238331">case</span>&nbsp;<span class="string" id="6238336">&#39;U&#39;</span><span class="op" id="6238339">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238343">ch</span>&nbsp;<span class="op" id="6238346">=</span>&nbsp;<span class="ident" id="6238348">s</span><span class="op" id="6238349">.</span><span class="ident" id="6238350">scanDigits</span><span class="op" id="6238360">(</span><span class="ident" id="6238361">s</span><span class="op" id="6238362">.</span><span class="ident" id="6238363">next</span><span class="op" id="6238367">(</span><span class="op" id="6238368">)</span><span class="op" id="6238369">,</span>&nbsp;<span class="num" id="6238371">16</span><span class="op" id="6238373">,</span>&nbsp;<span class="num" id="6238375">8</span><span class="op" id="6238376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6238379">default</span><span class="op" id="6238386">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238390">s</span><span class="op" id="6238391">.</span><span class="builtintype" id="6238392">error</span><span class="op" id="6238397">(</span><span class="string" id="6238398">&#34;illegal&nbsp;char&nbsp;escape&#34;</span><span class="op" id="6238419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6238422">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6238425">return</span>&nbsp;<span class="ident" id="6238432">ch</span><br>
<span class="lineno"></span><span class="op" id="6238435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6238438">func</span>&nbsp;<span class="op" id="6238443">(</span><span class="ident" id="6238444">s</span>&nbsp;<span class="op" id="6238446">*</span><span class="ident" id="6238447">Scanner</span><span class="op" id="6238454">)</span>&nbsp;<span class="ident" id="6238456">scanString</span><span class="op" id="6238466">(</span><span class="ident" id="6238467">quote</span>&nbsp;<span class="builtintype" id="6238473">rune</span><span class="op" id="6238477">)</span>&nbsp;<span class="op" id="6238479">(</span><span class="ident" id="6238480">n</span>&nbsp;<span class="builtintype" id="6238482">int</span><span class="op" id="6238485">)</span>&nbsp;<span class="op" id="6238487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238490">ch</span>&nbsp;<span class="op" id="6238493">:=</span>&nbsp;<span class="ident" id="6238496">s</span><span class="op" id="6238497">.</span><span class="ident" id="6238498">next</span><span class="op" id="6238502">(</span><span class="op" id="6238503">)</span>&nbsp;<span class="comment" id="6238505">//&nbsp;read&nbsp;character&nbsp;after&nbsp;quote</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6238536">for</span>&nbsp;<span class="ident" id="6238540">ch</span>&nbsp;<span class="op" id="6238543">!=</span>&nbsp;<span class="ident" id="6238546">quote</span>&nbsp;<span class="op" id="6238552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6238556">if</span>&nbsp;<span class="ident" id="6238559">ch</span>&nbsp;<span class="op" id="6238562">==</span>&nbsp;<span class="string" id="6238565">&#39;\n&#39;</span>&nbsp;<span class="op" id="6238570">||</span>&nbsp;<span class="ident" id="6238573">ch</span>&nbsp;<span class="op" id="6238576">&lt;</span>&nbsp;<span class="num" id="6238578">0</span>&nbsp;<span class="op" id="6238580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238585">s</span><span class="op" id="6238586">.</span><span class="builtintype" id="6238587">error</span><span class="op" id="6238592">(</span><span class="string" id="6238593">&#34;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="6238617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6238622">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6238631">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6238635">if</span>&nbsp;<span class="ident" id="6238638">ch</span>&nbsp;<span class="op" id="6238641">==</span>&nbsp;<span class="string" id="6238644">&#39;\\&#39;</span>&nbsp;<span class="op" id="6238649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238654">ch</span>&nbsp;<span class="op" id="6238657">=</span>&nbsp;<span class="ident" id="6238659">s</span><span class="op" id="6238660">.</span><span class="ident" id="6238661">scanEscape</span><span class="op" id="6238671">(</span><span class="ident" id="6238672">quote</span><span class="op" id="6238677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6238681">}</span>&nbsp;<span class="keyword" id="6238683">else</span>&nbsp;<span class="op" id="6238688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238693">ch</span>&nbsp;<span class="op" id="6238696">=</span>&nbsp;<span class="ident" id="6238698">s</span><span class="op" id="6238699">.</span><span class="ident" id="6238700">next</span><span class="op" id="6238704">(</span><span class="op" id="6238705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6238709">}</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238713">n</span><span class="op" id="6238714">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6238718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6238721">return</span><br>
<span class="lineno"></span><span class="op" id="6238728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="6238731">func</span>&nbsp;<span class="op" id="6238736">(</span><span class="ident" id="6238737">s</span>&nbsp;<span class="op" id="6238739">*</span><span class="ident" id="6238740">Scanner</span><span class="op" id="6238747">)</span>&nbsp;<span class="ident" id="6238749">scanRawString</span><span class="op" id="6238762">(</span><span class="op" id="6238763">)</span>&nbsp;<span class="op" id="6238765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238768">ch</span>&nbsp;<span class="op" id="6238771">:=</span>&nbsp;<span class="ident" id="6238774">s</span><span class="op" id="6238775">.</span><span class="ident" id="6238776">next</span><span class="op" id="6238780">(</span><span class="op" id="6238781">)</span>&nbsp;<span class="comment" id="6238783">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#39;`&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6238812">for</span>&nbsp;<span class="ident" id="6238816">ch</span>&nbsp;<span class="op" id="6238819">!=</span>&nbsp;<span class="string" id="6238822">&#39;`&#39;</span>&nbsp;<span class="op" id="6238826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6238830">if</span>&nbsp;<span class="ident" id="6238833">ch</span>&nbsp;<span class="op" id="6238836">&lt;</span>&nbsp;<span class="num" id="6238838">0</span>&nbsp;<span class="op" id="6238840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238845">s</span><span class="op" id="6238846">.</span><span class="builtintype" id="6238847">error</span><span class="op" id="6238852">(</span><span class="string" id="6238853">&#34;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="6238877">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6238882">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6238891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238895">ch</span>&nbsp;<span class="op" id="6238898">=</span>&nbsp;<span class="ident" id="6238900">s</span><span class="op" id="6238901">.</span><span class="ident" id="6238902">next</span><span class="op" id="6238906">(</span><span class="op" id="6238907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6238910">}</span><br>
<span class="lineno"></span><span class="op" id="6238912">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span><span class="keyword" id="6238915">func</span>&nbsp;<span class="op" id="6238920">(</span><span class="ident" id="6238921">s</span>&nbsp;<span class="op" id="6238923">*</span><span class="ident" id="6238924">Scanner</span><span class="op" id="6238931">)</span>&nbsp;<span class="ident" id="6238933">scanChar</span><span class="op" id="6238941">(</span><span class="op" id="6238942">)</span>&nbsp;<span class="op" id="6238944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6238947">if</span>&nbsp;<span class="ident" id="6238950">s</span><span class="op" id="6238951">.</span><span class="ident" id="6238952">scanString</span><span class="op" id="6238962">(</span><span class="string" id="6238963">&#39;\&#39;&#39;</span><span class="op" id="6238967">)</span>&nbsp;<span class="op" id="6238969">!=</span>&nbsp;<span class="num" id="6238972">1</span>&nbsp;<span class="op" id="6238974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238978">s</span><span class="op" id="6238979">.</span><span class="builtintype" id="6238980">error</span><span class="op" id="6238985">(</span><span class="string" id="6238986">&#34;illegal&nbsp;char&nbsp;literal&#34;</span><span class="op" id="6239008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6239011">}</span><br>
<span class="lineno">515</span><span class="op" id="6239013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6239016">func</span>&nbsp;<span class="op" id="6239021">(</span><span class="ident" id="6239022">s</span>&nbsp;<span class="op" id="6239024">*</span><span class="ident" id="6239025">Scanner</span><span class="op" id="6239032">)</span>&nbsp;<span class="ident" id="6239034">scanComment</span><span class="op" id="6239045">(</span><span class="ident" id="6239046">ch</span>&nbsp;<span class="builtintype" id="6239049">rune</span><span class="op" id="6239053">)</span>&nbsp;<span class="builtintype" id="6239055">rune</span>&nbsp;<span class="op" id="6239060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6239063">//&nbsp;ch&nbsp;==&nbsp;&#39;/&#39;&nbsp;||&nbsp;ch&nbsp;==&nbsp;&#39;*&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239090">if</span>&nbsp;<span class="ident" id="6239093">ch</span>&nbsp;<span class="op" id="6239096">==</span>&nbsp;<span class="string" id="6239099">&#39;/&#39;</span>&nbsp;<span class="op" id="6239103">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6239107">//&nbsp;line&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6239125">ch</span>&nbsp;<span class="op" id="6239128">=</span>&nbsp;<span class="ident" id="6239130">s</span><span class="op" id="6239131">.</span><span class="ident" id="6239132">next</span><span class="op" id="6239136">(</span><span class="op" id="6239137">)</span>&nbsp;<span class="comment" id="6239139">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#34;//&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239170">for</span>&nbsp;<span class="ident" id="6239174">ch</span>&nbsp;<span class="op" id="6239177">!=</span>&nbsp;<span class="string" id="6239180">&#39;\n&#39;</span>&nbsp;<span class="op" id="6239185">&amp;&amp;</span>&nbsp;<span class="ident" id="6239188">ch</span>&nbsp;<span class="op" id="6239191">&gt;=</span>&nbsp;<span class="num" id="6239194">0</span>&nbsp;<span class="op" id="6239196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6239201">ch</span>&nbsp;<span class="op" id="6239204">=</span>&nbsp;<span class="ident" id="6239206">s</span><span class="op" id="6239207">.</span><span class="ident" id="6239208">next</span><span class="op" id="6239212">(</span><span class="op" id="6239213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6239217">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239221">return</span>&nbsp;<span class="ident" id="6239228">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6239232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6239236">//&nbsp;general&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6239256">ch</span>&nbsp;<span class="op" id="6239259">=</span>&nbsp;<span class="ident" id="6239261">s</span><span class="op" id="6239262">.</span><span class="ident" id="6239263">next</span><span class="op" id="6239267">(</span><span class="op" id="6239268">)</span>&nbsp;<span class="comment" id="6239270">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#34;/*&#34;</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239300">for</span>&nbsp;<span class="op" id="6239304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239308">if</span>&nbsp;<span class="ident" id="6239311">ch</span>&nbsp;<span class="op" id="6239314">&lt;</span>&nbsp;<span class="num" id="6239316">0</span>&nbsp;<span class="op" id="6239318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6239323">s</span><span class="op" id="6239324">.</span><span class="builtintype" id="6239325">error</span><span class="op" id="6239330">(</span><span class="string" id="6239331">&#34;comment&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="6239355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239360">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6239368">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6239372">ch0</span>&nbsp;<span class="op" id="6239376">:=</span>&nbsp;<span class="ident" id="6239379">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6239384">ch</span>&nbsp;<span class="op" id="6239387">=</span>&nbsp;<span class="ident" id="6239389">s</span><span class="op" id="6239390">.</span><span class="ident" id="6239391">next</span><span class="op" id="6239395">(</span><span class="op" id="6239396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239400">if</span>&nbsp;<span class="ident" id="6239403">ch0</span>&nbsp;<span class="op" id="6239407">==</span>&nbsp;<span class="string" id="6239410">&#39;*&#39;</span>&nbsp;<span class="op" id="6239414">&amp;&amp;</span>&nbsp;<span class="ident" id="6239417">ch</span>&nbsp;<span class="op" id="6239420">==</span>&nbsp;<span class="string" id="6239423">&#39;/&#39;</span>&nbsp;<span class="op" id="6239427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6239432">ch</span>&nbsp;<span class="op" id="6239435">=</span>&nbsp;<span class="ident" id="6239437">s</span><span class="op" id="6239438">.</span><span class="ident" id="6239439">next</span><span class="op" id="6239443">(</span><span class="op" id="6239444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239449">break</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6239457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6239460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239463">return</span>&nbsp;<span class="ident" id="6239470">ch</span><br>
<span class="lineno"></span><span class="op" id="6239473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span><span class="comment" id="6239476">//&nbsp;Scan&nbsp;reads&nbsp;the&nbsp;next&nbsp;token&nbsp;or&nbsp;Unicode&nbsp;character&nbsp;from&nbsp;source&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="6239554">//&nbsp;It&nbsp;only&nbsp;recognizes&nbsp;tokens&nbsp;t&nbsp;for&nbsp;which&nbsp;the&nbsp;respective&nbsp;Mode&nbsp;bit&nbsp;(1&lt;&lt;-t)&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="6239635">//&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source.&nbsp;It&nbsp;reports&nbsp;scanner&nbsp;errors&nbsp;(read&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6239715">//&nbsp;token&nbsp;errors)&nbsp;by&nbsp;calling&nbsp;s.Error,&nbsp;if&nbsp;not&nbsp;nil;&nbsp;otherwise&nbsp;it&nbsp;prints&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="6239793">//&nbsp;message&nbsp;to&nbsp;os.Stderr.</span><br>
<span class="lineno">550</span><span class="keyword" id="6239818">func</span>&nbsp;<span class="op" id="6239823">(</span><span class="ident" id="6239824">s</span>&nbsp;<span class="op" id="6239826">*</span><span class="ident" id="6239827">Scanner</span><span class="op" id="6239834">)</span>&nbsp;<span class="ident" id="6239836">Scan</span><span class="op" id="6239840">(</span><span class="op" id="6239841">)</span>&nbsp;<span class="builtintype" id="6239843">rune</span>&nbsp;<span class="op" id="6239848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6239851">ch</span>&nbsp;<span class="op" id="6239854">:=</span>&nbsp;<span class="ident" id="6239857">s</span><span class="op" id="6239858">.</span><span class="ident" id="6239859">Peek</span><span class="op" id="6239863">(</span><span class="op" id="6239864">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6239868">//&nbsp;reset&nbsp;token&nbsp;text&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6239898">s</span><span class="op" id="6239899">.</span><span class="ident" id="6239900">tokPos</span>&nbsp;<span class="op" id="6239907">=</span>&nbsp;<span class="op" id="6239909">-</span><span class="num" id="6239910">1</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6239913">s</span><span class="op" id="6239914">.</span><span class="ident" id="6239915">Line</span>&nbsp;<span class="op" id="6239920">=</span>&nbsp;<span class="num" id="6239922">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="6239925">redo</span><span class="op" id="6239929">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6239932">//&nbsp;skip&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239953">for</span>&nbsp;<span class="ident" id="6239957">s</span><span class="op" id="6239958">.</span><span class="ident" id="6239959">Whitespace</span><span class="op" id="6239969">&amp;</span><span class="op" id="6239970">(</span><span class="num" id="6239971">1</span><span class="op" id="6239972">&lt;&lt;</span><span class="builtintype" id="6239974">uint</span><span class="op" id="6239978">(</span><span class="ident" id="6239979">ch</span><span class="op" id="6239981">)</span><span class="op" id="6239982">)</span>&nbsp;<span class="op" id="6239984">!=</span>&nbsp;<span class="num" id="6239987">0</span>&nbsp;<span class="op" id="6239989">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6239993">ch</span>&nbsp;<span class="op" id="6239996">=</span>&nbsp;<span class="ident" id="6239998">s</span><span class="op" id="6239999">.</span><span class="ident" id="6240000">next</span><span class="op" id="6240004">(</span><span class="op" id="6240005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6240008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6240012">//&nbsp;start&nbsp;collecting&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240044">s</span><span class="op" id="6240045">.</span><span class="ident" id="6240046">tokBuf</span><span class="op" id="6240052">.</span><span class="ident" id="6240053">Reset</span><span class="op" id="6240058">(</span><span class="op" id="6240059">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240062">s</span><span class="op" id="6240063">.</span><span class="ident" id="6240064">tokPos</span>&nbsp;<span class="op" id="6240071">=</span>&nbsp;<span class="ident" id="6240073">s</span><span class="op" id="6240074">.</span><span class="ident" id="6240075">srcPos</span>&nbsp;<span class="op" id="6240082">-</span>&nbsp;<span class="ident" id="6240084">s</span><span class="op" id="6240085">.</span><span class="ident" id="6240086">lastCharLen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6240100">//&nbsp;set&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6240123">//&nbsp;(this&nbsp;is&nbsp;a&nbsp;slightly&nbsp;optimized&nbsp;version&nbsp;of&nbsp;the&nbsp;code&nbsp;in&nbsp;Pos())</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240187">s</span><span class="op" id="6240188">.</span><span class="ident" id="6240189">Offset</span>&nbsp;<span class="op" id="6240196">=</span>&nbsp;<span class="ident" id="6240198">s</span><span class="op" id="6240199">.</span><span class="ident" id="6240200">srcBufOffset</span>&nbsp;<span class="op" id="6240213">+</span>&nbsp;<span class="ident" id="6240215">s</span><span class="op" id="6240216">.</span><span class="ident" id="6240217">tokPos</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240225">if</span>&nbsp;<span class="ident" id="6240228">s</span><span class="op" id="6240229">.</span><span class="ident" id="6240230">column</span>&nbsp;<span class="op" id="6240237">&gt;</span>&nbsp;<span class="num" id="6240239">0</span>&nbsp;<span class="op" id="6240241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6240245">//&nbsp;common&nbsp;case:&nbsp;last&nbsp;character&nbsp;was&nbsp;not&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240293">s</span><span class="op" id="6240294">.</span><span class="ident" id="6240295">Line</span>&nbsp;<span class="op" id="6240300">=</span>&nbsp;<span class="ident" id="6240302">s</span><span class="op" id="6240303">.</span><span class="ident" id="6240304">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240311">s</span><span class="op" id="6240312">.</span><span class="ident" id="6240313">Column</span>&nbsp;<span class="op" id="6240320">=</span>&nbsp;<span class="ident" id="6240322">s</span><span class="op" id="6240323">.</span><span class="ident" id="6240324">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6240332">}</span>&nbsp;<span class="keyword" id="6240334">else</span>&nbsp;<span class="op" id="6240339">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6240343">//&nbsp;last&nbsp;character&nbsp;was&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6240374">//&nbsp;(we&nbsp;cannot&nbsp;be&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6240424">//&nbsp;since&nbsp;we&nbsp;have&nbsp;called&nbsp;next()&nbsp;at&nbsp;least&nbsp;once)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240472">s</span><span class="op" id="6240473">.</span><span class="ident" id="6240474">Line</span>&nbsp;<span class="op" id="6240479">=</span>&nbsp;<span class="ident" id="6240481">s</span><span class="op" id="6240482">.</span><span class="ident" id="6240483">line</span>&nbsp;<span class="op" id="6240488">-</span>&nbsp;<span class="num" id="6240490">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240494">s</span><span class="op" id="6240495">.</span><span class="ident" id="6240496">Column</span>&nbsp;<span class="op" id="6240503">=</span>&nbsp;<span class="ident" id="6240505">s</span><span class="op" id="6240506">.</span><span class="ident" id="6240507">lastLineLen</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6240520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6240524">//&nbsp;determine&nbsp;token&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240550">tok</span>&nbsp;<span class="op" id="6240554">:=</span>&nbsp;<span class="ident" id="6240557">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240561">switch</span>&nbsp;<span class="op" id="6240568">{</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240571">case</span>&nbsp;<span class="ident" id="6240576">s</span><span class="op" id="6240577">.</span><span class="ident" id="6240578">isIdentRune</span><span class="op" id="6240589">(</span><span class="ident" id="6240590">ch</span><span class="op" id="6240592">,</span>&nbsp;<span class="num" id="6240594">0</span><span class="op" id="6240595">)</span><span class="op" id="6240596">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240600">if</span>&nbsp;<span class="ident" id="6240603">s</span><span class="op" id="6240604">.</span><span class="ident" id="6240605">Mode</span><span class="op" id="6240609">&amp;</span><span class="ident" id="6240610">ScanIdents</span>&nbsp;<span class="op" id="6240621">!=</span>&nbsp;<span class="num" id="6240624">0</span>&nbsp;<span class="op" id="6240626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240631">tok</span>&nbsp;<span class="op" id="6240635">=</span>&nbsp;<span class="ident" id="6240637">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240646">ch</span>&nbsp;<span class="op" id="6240649">=</span>&nbsp;<span class="ident" id="6240651">s</span><span class="op" id="6240652">.</span><span class="ident" id="6240653">scanIdentifier</span><span class="op" id="6240667">(</span><span class="op" id="6240668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6240672">}</span>&nbsp;<span class="keyword" id="6240674">else</span>&nbsp;<span class="op" id="6240679">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240684">ch</span>&nbsp;<span class="op" id="6240687">=</span>&nbsp;<span class="ident" id="6240689">s</span><span class="op" id="6240690">.</span><span class="ident" id="6240691">next</span><span class="op" id="6240695">(</span><span class="op" id="6240696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6240700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240703">case</span>&nbsp;<span class="ident" id="6240708">isDecimal</span><span class="op" id="6240717">(</span><span class="ident" id="6240718">ch</span><span class="op" id="6240720">)</span><span class="op" id="6240721">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240725">if</span>&nbsp;<span class="ident" id="6240728">s</span><span class="op" id="6240729">.</span><span class="ident" id="6240730">Mode</span><span class="op" id="6240734">&amp;</span><span class="op" id="6240735">(</span><span class="ident" id="6240736">ScanInts</span><span class="op" id="6240744">|</span><span class="ident" id="6240745">ScanFloats</span><span class="op" id="6240755">)</span>&nbsp;<span class="op" id="6240757">!=</span>&nbsp;<span class="num" id="6240760">0</span>&nbsp;<span class="op" id="6240762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240767">tok</span><span class="op" id="6240770">,</span>&nbsp;<span class="ident" id="6240772">ch</span>&nbsp;<span class="op" id="6240775">=</span>&nbsp;<span class="ident" id="6240777">s</span><span class="op" id="6240778">.</span><span class="ident" id="6240779">scanNumber</span><span class="op" id="6240789">(</span><span class="ident" id="6240790">ch</span><span class="op" id="6240792">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6240796">}</span>&nbsp;<span class="keyword" id="6240798">else</span>&nbsp;<span class="op" id="6240803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240808">ch</span>&nbsp;<span class="op" id="6240811">=</span>&nbsp;<span class="ident" id="6240813">s</span><span class="op" id="6240814">.</span><span class="ident" id="6240815">next</span><span class="op" id="6240819">(</span><span class="op" id="6240820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6240824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240827">default</span><span class="op" id="6240834">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240838">switch</span>&nbsp;<span class="ident" id="6240845">ch</span>&nbsp;<span class="op" id="6240848">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240852">case</span>&nbsp;<span class="string" id="6240857">&#39;&#34;&#39;</span><span class="op" id="6240860">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240865">if</span>&nbsp;<span class="ident" id="6240868">s</span><span class="op" id="6240869">.</span><span class="ident" id="6240870">Mode</span><span class="op" id="6240874">&amp;</span><span class="ident" id="6240875">ScanStrings</span>&nbsp;<span class="op" id="6240887">!=</span>&nbsp;<span class="num" id="6240890">0</span>&nbsp;<span class="op" id="6240892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240898">s</span><span class="op" id="6240899">.</span><span class="ident" id="6240900">scanString</span><span class="op" id="6240910">(</span><span class="string" id="6240911">&#39;&#34;&#39;</span><span class="op" id="6240914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240920">tok</span>&nbsp;<span class="op" id="6240924">=</span>&nbsp;<span class="ident" id="6240926">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6240936">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240941">ch</span>&nbsp;<span class="op" id="6240944">=</span>&nbsp;<span class="ident" id="6240946">s</span><span class="op" id="6240947">.</span><span class="ident" id="6240948">next</span><span class="op" id="6240952">(</span><span class="op" id="6240953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240957">case</span>&nbsp;<span class="string" id="6240962">&#39;\&#39;&#39;</span><span class="op" id="6240966">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240971">if</span>&nbsp;<span class="ident" id="6240974">s</span><span class="op" id="6240975">.</span><span class="ident" id="6240976">Mode</span><span class="op" id="6240980">&amp;</span><span class="ident" id="6240981">ScanChars</span>&nbsp;<span class="op" id="6240991">!=</span>&nbsp;<span class="num" id="6240994">0</span>&nbsp;<span class="op" id="6240996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241002">s</span><span class="op" id="6241003">.</span><span class="ident" id="6241004">scanChar</span><span class="op" id="6241012">(</span><span class="op" id="6241013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241019">tok</span>&nbsp;<span class="op" id="6241023">=</span>&nbsp;<span class="ident" id="6241025">Char</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6241033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241038">ch</span>&nbsp;<span class="op" id="6241041">=</span>&nbsp;<span class="ident" id="6241043">s</span><span class="op" id="6241044">.</span><span class="ident" id="6241045">next</span><span class="op" id="6241049">(</span><span class="op" id="6241050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241054">case</span>&nbsp;<span class="string" id="6241059">&#39;.&#39;</span><span class="op" id="6241062">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241067">ch</span>&nbsp;<span class="op" id="6241070">=</span>&nbsp;<span class="ident" id="6241072">s</span><span class="op" id="6241073">.</span><span class="ident" id="6241074">next</span><span class="op" id="6241078">(</span><span class="op" id="6241079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241084">if</span>&nbsp;<span class="ident" id="6241087">isDecimal</span><span class="op" id="6241096">(</span><span class="ident" id="6241097">ch</span><span class="op" id="6241099">)</span>&nbsp;<span class="op" id="6241101">&amp;&amp;</span>&nbsp;<span class="ident" id="6241104">s</span><span class="op" id="6241105">.</span><span class="ident" id="6241106">Mode</span><span class="op" id="6241110">&amp;</span><span class="ident" id="6241111">ScanFloats</span>&nbsp;<span class="op" id="6241122">!=</span>&nbsp;<span class="num" id="6241125">0</span>&nbsp;<span class="op" id="6241127">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241133">tok</span>&nbsp;<span class="op" id="6241137">=</span>&nbsp;<span class="ident" id="6241139">Float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241149">ch</span>&nbsp;<span class="op" id="6241152">=</span>&nbsp;<span class="ident" id="6241154">s</span><span class="op" id="6241155">.</span><span class="ident" id="6241156">scanMantissa</span><span class="op" id="6241168">(</span><span class="ident" id="6241169">ch</span><span class="op" id="6241171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241177">ch</span>&nbsp;<span class="op" id="6241180">=</span>&nbsp;<span class="ident" id="6241182">s</span><span class="op" id="6241183">.</span><span class="ident" id="6241184">scanExponent</span><span class="op" id="6241196">(</span><span class="ident" id="6241197">ch</span><span class="op" id="6241199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6241204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241208">case</span>&nbsp;<span class="string" id="6241213">&#39;/&#39;</span><span class="op" id="6241216">:</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241221">ch</span>&nbsp;<span class="op" id="6241224">=</span>&nbsp;<span class="ident" id="6241226">s</span><span class="op" id="6241227">.</span><span class="ident" id="6241228">next</span><span class="op" id="6241232">(</span><span class="op" id="6241233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241238">if</span>&nbsp;<span class="op" id="6241241">(</span><span class="ident" id="6241242">ch</span>&nbsp;<span class="op" id="6241245">==</span>&nbsp;<span class="string" id="6241248">&#39;/&#39;</span>&nbsp;<span class="op" id="6241252">||</span>&nbsp;<span class="ident" id="6241255">ch</span>&nbsp;<span class="op" id="6241258">==</span>&nbsp;<span class="string" id="6241261">&#39;*&#39;</span><span class="op" id="6241264">)</span>&nbsp;<span class="op" id="6241266">&amp;&amp;</span>&nbsp;<span class="ident" id="6241269">s</span><span class="op" id="6241270">.</span><span class="ident" id="6241271">Mode</span><span class="op" id="6241275">&amp;</span><span class="ident" id="6241276">ScanComments</span>&nbsp;<span class="op" id="6241289">!=</span>&nbsp;<span class="num" id="6241292">0</span>&nbsp;<span class="op" id="6241294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241300">if</span>&nbsp;<span class="ident" id="6241303">s</span><span class="op" id="6241304">.</span><span class="ident" id="6241305">Mode</span><span class="op" id="6241309">&amp;</span><span class="ident" id="6241310">SkipComments</span>&nbsp;<span class="op" id="6241323">!=</span>&nbsp;<span class="num" id="6241326">0</span>&nbsp;<span class="op" id="6241328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241335">s</span><span class="op" id="6241336">.</span><span class="ident" id="6241337">tokPos</span>&nbsp;<span class="op" id="6241344">=</span>&nbsp;<span class="op" id="6241346">-</span><span class="num" id="6241347">1</span>&nbsp;<span class="comment" id="6241349">//&nbsp;don&#39;t&nbsp;collect&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241382">ch</span>&nbsp;<span class="op" id="6241385">=</span>&nbsp;<span class="ident" id="6241387">s</span><span class="op" id="6241388">.</span><span class="ident" id="6241389">scanComment</span><span class="op" id="6241400">(</span><span class="ident" id="6241401">ch</span><span class="op" id="6241403">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241410">goto</span>&nbsp;<span class="ident" id="6241415">redo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6241424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241430">ch</span>&nbsp;<span class="op" id="6241433">=</span>&nbsp;<span class="ident" id="6241435">s</span><span class="op" id="6241436">.</span><span class="ident" id="6241437">scanComment</span><span class="op" id="6241448">(</span><span class="ident" id="6241449">ch</span><span class="op" id="6241451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241457">tok</span>&nbsp;<span class="op" id="6241461">=</span>&nbsp;<span class="ident" id="6241463">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6241474">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241478">case</span>&nbsp;<span class="string" id="6241483">&#39;`&#39;</span><span class="op" id="6241486">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241491">if</span>&nbsp;<span class="ident" id="6241494">s</span><span class="op" id="6241495">.</span><span class="ident" id="6241496">Mode</span><span class="op" id="6241500">&amp;</span><span class="ident" id="6241501">ScanRawStrings</span>&nbsp;<span class="op" id="6241516">!=</span>&nbsp;<span class="num" id="6241519">0</span>&nbsp;<span class="op" id="6241521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241527">s</span><span class="op" id="6241528">.</span><span class="ident" id="6241529">scanRawString</span><span class="op" id="6241542">(</span><span class="op" id="6241543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241549">tok</span>&nbsp;<span class="op" id="6241553">=</span>&nbsp;<span class="ident" id="6241555">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6241565">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241570">ch</span>&nbsp;<span class="op" id="6241573">=</span>&nbsp;<span class="ident" id="6241575">s</span><span class="op" id="6241576">.</span><span class="ident" id="6241577">next</span><span class="op" id="6241581">(</span><span class="op" id="6241582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241586">default</span><span class="op" id="6241593">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241598">ch</span>&nbsp;<span class="op" id="6241601">=</span>&nbsp;<span class="ident" id="6241603">s</span><span class="op" id="6241604">.</span><span class="ident" id="6241605">next</span><span class="op" id="6241609">(</span><span class="op" id="6241610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6241614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6241617">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6241621">//&nbsp;end&nbsp;of&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241643">s</span><span class="op" id="6241644">.</span><span class="ident" id="6241645">tokEnd</span>&nbsp;<span class="op" id="6241652">=</span>&nbsp;<span class="ident" id="6241654">s</span><span class="op" id="6241655">.</span><span class="ident" id="6241656">srcPos</span>&nbsp;<span class="op" id="6241663">-</span>&nbsp;<span class="ident" id="6241665">s</span><span class="op" id="6241666">.</span><span class="ident" id="6241667">lastCharLen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241681">s</span><span class="op" id="6241682">.</span><span class="ident" id="6241683">ch</span>&nbsp;<span class="op" id="6241686">=</span>&nbsp;<span class="ident" id="6241688">ch</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241692">return</span>&nbsp;<span class="ident" id="6241699">tok</span><br>
<span class="lineno"></span><span class="op" id="6241703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6241706">//&nbsp;Pos&nbsp;returns&nbsp;the&nbsp;position&nbsp;of&nbsp;the&nbsp;character&nbsp;immediately&nbsp;after</span><br>
<span class="lineno"></span><span class="comment" id="6241769">//&nbsp;the&nbsp;character&nbsp;or&nbsp;token&nbsp;returned&nbsp;by&nbsp;the&nbsp;last&nbsp;call&nbsp;to&nbsp;Next&nbsp;or&nbsp;Scan.</span><br>
<span class="lineno">650</span><span class="keyword" id="6241838">func</span>&nbsp;<span class="op" id="6241843">(</span><span class="ident" id="6241844">s</span>&nbsp;<span class="op" id="6241846">*</span><span class="ident" id="6241847">Scanner</span><span class="op" id="6241854">)</span>&nbsp;<span class="ident" id="6241856">Pos</span><span class="op" id="6241859">(</span><span class="op" id="6241860">)</span>&nbsp;<span class="op" id="6241862">(</span><span class="ident" id="6241863">pos</span>&nbsp;<span class="ident" id="6241867">Position</span><span class="op" id="6241875">)</span>&nbsp;<span class="op" id="6241877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241880">pos</span><span class="op" id="6241883">.</span><span class="ident" id="6241884">Filename</span>&nbsp;<span class="op" id="6241893">=</span>&nbsp;<span class="ident" id="6241895">s</span><span class="op" id="6241896">.</span><span class="ident" id="6241897">Filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241907">pos</span><span class="op" id="6241910">.</span><span class="ident" id="6241911">Offset</span>&nbsp;<span class="op" id="6241918">=</span>&nbsp;<span class="ident" id="6241920">s</span><span class="op" id="6241921">.</span><span class="ident" id="6241922">srcBufOffset</span>&nbsp;<span class="op" id="6241935">+</span>&nbsp;<span class="ident" id="6241937">s</span><span class="op" id="6241938">.</span><span class="ident" id="6241939">srcPos</span>&nbsp;<span class="op" id="6241946">-</span>&nbsp;<span class="ident" id="6241948">s</span><span class="op" id="6241949">.</span><span class="ident" id="6241950">lastCharLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241963">switch</span>&nbsp;<span class="op" id="6241970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241973">case</span>&nbsp;<span class="ident" id="6241978">s</span><span class="op" id="6241979">.</span><span class="ident" id="6241980">column</span>&nbsp;<span class="op" id="6241987">&gt;</span>&nbsp;<span class="num" id="6241989">0</span><span class="op" id="6241990">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6241994">//&nbsp;common&nbsp;case:&nbsp;last&nbsp;character&nbsp;was&nbsp;not&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6242042">pos</span><span class="op" id="6242045">.</span><span class="ident" id="6242046">Line</span>&nbsp;<span class="op" id="6242051">=</span>&nbsp;<span class="ident" id="6242053">s</span><span class="op" id="6242054">.</span><span class="ident" id="6242055">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6242062">pos</span><span class="op" id="6242065">.</span><span class="ident" id="6242066">Column</span>&nbsp;<span class="op" id="6242073">=</span>&nbsp;<span class="ident" id="6242075">s</span><span class="op" id="6242076">.</span><span class="ident" id="6242077">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242085">case</span>&nbsp;<span class="ident" id="6242090">s</span><span class="op" id="6242091">.</span><span class="ident" id="6242092">lastLineLen</span>&nbsp;<span class="op" id="6242104">&gt;</span>&nbsp;<span class="num" id="6242106">0</span><span class="op" id="6242107">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6242111">//&nbsp;last&nbsp;character&nbsp;was&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6242142">pos</span><span class="op" id="6242145">.</span><span class="ident" id="6242146">Line</span>&nbsp;<span class="op" id="6242151">=</span>&nbsp;<span class="ident" id="6242153">s</span><span class="op" id="6242154">.</span><span class="ident" id="6242155">line</span>&nbsp;<span class="op" id="6242160">-</span>&nbsp;<span class="num" id="6242162">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6242166">pos</span><span class="op" id="6242169">.</span><span class="ident" id="6242170">Column</span>&nbsp;<span class="op" id="6242177">=</span>&nbsp;<span class="ident" id="6242179">s</span><span class="op" id="6242180">.</span><span class="ident" id="6242181">lastLineLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242194">default</span><span class="op" id="6242201">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6242205">//&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6242241">pos</span><span class="op" id="6242244">.</span><span class="ident" id="6242245">Line</span>&nbsp;<span class="op" id="6242250">=</span>&nbsp;<span class="num" id="6242252">1</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6242256">pos</span><span class="op" id="6242259">.</span><span class="ident" id="6242260">Column</span>&nbsp;<span class="op" id="6242267">=</span>&nbsp;<span class="num" id="6242269">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6242272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242275">return</span><br>
<span class="lineno"></span><span class="op" id="6242282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="comment" id="6242285">//&nbsp;TokenText&nbsp;returns&nbsp;the&nbsp;string&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;most&nbsp;recently&nbsp;scanned&nbsp;token.</span><br>
<span class="lineno"></span><span class="comment" id="6242367">//&nbsp;Valid&nbsp;after&nbsp;calling&nbsp;Scan().</span><br>
<span class="lineno"></span><span class="keyword" id="6242398">func</span>&nbsp;<span class="op" id="6242403">(</span><span class="ident" id="6242404">s</span>&nbsp;<span class="op" id="6242406">*</span><span class="ident" id="6242407">Scanner</span><span class="op" id="6242414">)</span>&nbsp;<span class="ident" id="6242416">TokenText</span><span class="op" id="6242425">(</span><span class="op" id="6242426">)</span>&nbsp;<span class="builtintype" id="6242428">string</span>&nbsp;<span class="op" id="6242435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242438">if</span>&nbsp;<span class="ident" id="6242441">s</span><span class="op" id="6242442">.</span><span class="ident" id="6242443">tokPos</span>&nbsp;<span class="op" id="6242450">&lt;</span>&nbsp;<span class="num" id="6242452">0</span>&nbsp;<span class="op" id="6242454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6242458">//&nbsp;no&nbsp;token&nbsp;text</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242477">return</span>&nbsp;<span class="string" id="6242484">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6242488">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242492">if</span>&nbsp;<span class="ident" id="6242495">s</span><span class="op" id="6242496">.</span><span class="ident" id="6242497">tokEnd</span>&nbsp;<span class="op" id="6242504">&lt;</span>&nbsp;<span class="num" id="6242506">0</span>&nbsp;<span class="op" id="6242508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6242512">//&nbsp;if&nbsp;EOF&nbsp;was&nbsp;reached,&nbsp;s.tokEnd&nbsp;is&nbsp;set&nbsp;to&nbsp;-1&nbsp;(s.srcPos&nbsp;==&nbsp;0)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6242575">s</span><span class="op" id="6242576">.</span><span class="ident" id="6242577">tokEnd</span>&nbsp;<span class="op" id="6242584">=</span>&nbsp;<span class="ident" id="6242586">s</span><span class="op" id="6242587">.</span><span class="ident" id="6242588">tokPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6242596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242600">if</span>&nbsp;<span class="ident" id="6242603">s</span><span class="op" id="6242604">.</span><span class="ident" id="6242605">tokBuf</span><span class="op" id="6242611">.</span><span class="ident" id="6242612">Len</span><span class="op" id="6242615">(</span><span class="op" id="6242616">)</span>&nbsp;<span class="op" id="6242618">==</span>&nbsp;<span class="num" id="6242621">0</span>&nbsp;<span class="op" id="6242623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6242627">//&nbsp;common&nbsp;case:&nbsp;the&nbsp;entire&nbsp;token&nbsp;text&nbsp;is&nbsp;still&nbsp;in&nbsp;srcBuf</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242686">return</span>&nbsp;<span class="builtintype" id="6242693">string</span><span class="op" id="6242699">(</span><span class="ident" id="6242700">s</span><span class="op" id="6242701">.</span><span class="ident" id="6242702">srcBuf</span><span class="op" id="6242708">[</span><span class="ident" id="6242709">s</span><span class="op" id="6242710">.</span><span class="ident" id="6242711">tokPos</span><span class="op" id="6242717">:</span><span class="ident" id="6242718">s</span><span class="op" id="6242719">.</span><span class="ident" id="6242720">tokEnd</span><span class="op" id="6242726">]</span><span class="op" id="6242727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6242730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6242734">//&nbsp;part&nbsp;of&nbsp;the&nbsp;token&nbsp;text&nbsp;was&nbsp;saved&nbsp;in&nbsp;tokBuf:&nbsp;save&nbsp;the&nbsp;rest&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6242799">//&nbsp;tokBuf&nbsp;as&nbsp;well&nbsp;and&nbsp;return&nbsp;its&nbsp;content</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6242841">s</span><span class="op" id="6242842">.</span><span class="ident" id="6242843">tokBuf</span><span class="op" id="6242849">.</span><span class="ident" id="6242850">Write</span><span class="op" id="6242855">(</span><span class="ident" id="6242856">s</span><span class="op" id="6242857">.</span><span class="ident" id="6242858">srcBuf</span><span class="op" id="6242864">[</span><span class="ident" id="6242865">s</span><span class="op" id="6242866">.</span><span class="ident" id="6242867">tokPos</span><span class="op" id="6242873">:</span><span class="ident" id="6242874">s</span><span class="op" id="6242875">.</span><span class="ident" id="6242876">tokEnd</span><span class="op" id="6242882">]</span><span class="op" id="6242883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6242886">s</span><span class="op" id="6242887">.</span><span class="ident" id="6242888">tokPos</span>&nbsp;<span class="op" id="6242895">=</span>&nbsp;<span class="ident" id="6242897">s</span><span class="op" id="6242898">.</span><span class="ident" id="6242899">tokEnd</span>&nbsp;<span class="comment" id="6242906">//&nbsp;ensure&nbsp;idempotency&nbsp;of&nbsp;TokenText()&nbsp;call</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242949">return</span>&nbsp;<span class="ident" id="6242956">s</span><span class="op" id="6242957">.</span><span class="ident" id="6242958">tokBuf</span><span class="op" id="6242964">.</span><span class="ident" id="6242965">String</span><span class="op" id="6242971">(</span><span class="op" id="6242972">)</span><br>
<span class="lineno"></span><span class="op" id="6242974">}</span>
</div>
</body>
</html>
