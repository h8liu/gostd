<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8534942">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8534998">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8535052">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8535103">package</span>&nbsp;<span class="ident" id="8535111">jsonrpc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8535120">import</span>&nbsp;<span class="op" id="8535127">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8535130">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8535139">&#34;encoding/json&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8535156">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8535166">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8535173">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8535179">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8535192">&#34;net&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8535199">&#34;net/rpc&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8535210">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8535221">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8535231">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="8535234">type</span>&nbsp;<span class="ident" id="8535239">Args</span>&nbsp;<span class="keyword" id="8535244">struct</span>&nbsp;<span class="op" id="8535251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535254">A</span><span class="op" id="8535255">,</span>&nbsp;<span class="ident" id="8535257">B</span>&nbsp;<span class="builtintype" id="8535259">int</span><br>
<span class="lineno"></span><span class="op" id="8535263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8535266">type</span>&nbsp;<span class="ident" id="8535271">Reply</span>&nbsp;<span class="keyword" id="8535277">struct</span>&nbsp;<span class="op" id="8535284">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535287">C</span>&nbsp;<span class="builtintype" id="8535289">int</span><br>
<span class="lineno"></span><span class="op" id="8535293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8535296">type</span>&nbsp;<span class="ident" id="8535301">Arith</span>&nbsp;<span class="builtintype" id="8535307">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="8535312">type</span>&nbsp;<span class="ident" id="8535317">ArithAddResp</span>&nbsp;<span class="keyword" id="8535330">struct</span>&nbsp;<span class="op" id="8535337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535340">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8535347">interface</span><span class="op" id="8535356">{</span><span class="op" id="8535357">}</span>&nbsp;<span class="string" id="8535359">`json:&#34;id&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535372">Result</span>&nbsp;<span class="ident" id="8535379"><a href="/net/rpc/jsonrpc/all_test.go.html#8535271">Reply</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8535391">`json:&#34;result&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535408">Error</span>&nbsp;&nbsp;<span class="keyword" id="8535415">interface</span><span class="op" id="8535424">{</span><span class="op" id="8535425">}</span>&nbsp;<span class="string" id="8535427">`json:&#34;error&#34;`</span><br>
<span class="lineno"></span><span class="op" id="8535442">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="8535445">func</span>&nbsp;<span class="op" id="8535450">(</span><span class="ident" id="8535451">t</span>&nbsp;<span class="op" id="8535453">*</span><span class="ident" id="8535454"><a href="/net/rpc/jsonrpc/all_test.go.html#8535301">Arith</a></span><span class="op" id="8535459">)</span>&nbsp;<span class="ident" id="8535461">Add</span><span class="op" id="8535464">(</span><span class="ident" id="8535465">args</span>&nbsp;<span class="op" id="8535470">*</span><span class="ident" id="8535471"><a href="/net/rpc/jsonrpc/all_test.go.html#8535239">Args</a></span><span class="op" id="8535475">,</span>&nbsp;<span class="ident" id="8535477">reply</span>&nbsp;<span class="op" id="8535483">*</span><span class="ident" id="8535484"><a href="/net/rpc/jsonrpc/all_test.go.html#8535271">Reply</a></span><span class="op" id="8535489">)</span>&nbsp;<span class="builtintype" id="8535491">error</span>&nbsp;<span class="op" id="8535497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535500"><a href="/net/rpc/jsonrpc/all_test.go.html#8535477">reply</a></span><span class="op" id="8535505">.</span><span class="ident" id="8535506">C</span>&nbsp;<span class="op" id="8535508">=</span>&nbsp;<span class="ident" id="8535510"><a href="/net/rpc/jsonrpc/all_test.go.html#8535465">args</a></span><span class="op" id="8535514">.</span><span class="ident" id="8535515">A</span>&nbsp;<span class="op" id="8535517">+</span>&nbsp;<span class="ident" id="8535519"><a href="/net/rpc/jsonrpc/all_test.go.html#8535465">args</a></span><span class="op" id="8535523">.</span><span class="ident" id="8535524">B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535527">return</span>&nbsp;<span class="ident" id="8535534">nil</span><br>
<span class="lineno"></span><span class="op" id="8535538">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="8535541">func</span>&nbsp;<span class="op" id="8535546">(</span><span class="ident" id="8535547">t</span>&nbsp;<span class="op" id="8535549">*</span><span class="ident" id="8535550"><a href="/net/rpc/jsonrpc/all_test.go.html#8535301">Arith</a></span><span class="op" id="8535555">)</span>&nbsp;<span class="ident" id="8535557">Mul</span><span class="op" id="8535560">(</span><span class="ident" id="8535561">args</span>&nbsp;<span class="op" id="8535566">*</span><span class="ident" id="8535567"><a href="/net/rpc/jsonrpc/all_test.go.html#8535239">Args</a></span><span class="op" id="8535571">,</span>&nbsp;<span class="ident" id="8535573">reply</span>&nbsp;<span class="op" id="8535579">*</span><span class="ident" id="8535580"><a href="/net/rpc/jsonrpc/all_test.go.html#8535271">Reply</a></span><span class="op" id="8535585">)</span>&nbsp;<span class="builtintype" id="8535587">error</span>&nbsp;<span class="op" id="8535593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535596"><a href="/net/rpc/jsonrpc/all_test.go.html#8535573">reply</a></span><span class="op" id="8535601">.</span><span class="ident" id="8535602">C</span>&nbsp;<span class="op" id="8535604">=</span>&nbsp;<span class="ident" id="8535606"><a href="/net/rpc/jsonrpc/all_test.go.html#8535561">args</a></span><span class="op" id="8535610">.</span><span class="ident" id="8535611">A</span>&nbsp;<span class="op" id="8535613">*</span>&nbsp;<span class="ident" id="8535615"><a href="/net/rpc/jsonrpc/all_test.go.html#8535561">args</a></span><span class="op" id="8535619">.</span><span class="ident" id="8535620">B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535623">return</span>&nbsp;<span class="ident" id="8535630">nil</span><br>
<span class="lineno"></span><span class="op" id="8535634">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="8535637">func</span>&nbsp;<span class="op" id="8535642">(</span><span class="ident" id="8535643">t</span>&nbsp;<span class="op" id="8535645">*</span><span class="ident" id="8535646"><a href="/net/rpc/jsonrpc/all_test.go.html#8535301">Arith</a></span><span class="op" id="8535651">)</span>&nbsp;<span class="ident" id="8535653">Div</span><span class="op" id="8535656">(</span><span class="ident" id="8535657">args</span>&nbsp;<span class="op" id="8535662">*</span><span class="ident" id="8535663"><a href="/net/rpc/jsonrpc/all_test.go.html#8535239">Args</a></span><span class="op" id="8535667">,</span>&nbsp;<span class="ident" id="8535669">reply</span>&nbsp;<span class="op" id="8535675">*</span><span class="ident" id="8535676"><a href="/net/rpc/jsonrpc/all_test.go.html#8535271">Reply</a></span><span class="op" id="8535681">)</span>&nbsp;<span class="builtintype" id="8535683">error</span>&nbsp;<span class="op" id="8535689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535692">if</span>&nbsp;<span class="ident" id="8535695"><a href="/net/rpc/jsonrpc/all_test.go.html#8535657">args</a></span><span class="op" id="8535699">.</span><span class="ident" id="8535700">B</span>&nbsp;<span class="op" id="8535702">==</span>&nbsp;<span class="num" id="8535705">0</span>&nbsp;<span class="op" id="8535707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535711">return</span>&nbsp;<span class="ident" id="8535718"><a href="/net/rpc/jsonrpc/all_test.go.html#8535156">errors</a></span><span class="op" id="8535724">.</span><span class="ident" id="8535725">New</span><span class="op" id="8535728">(</span><span class="string" id="8535729">&#34;divide&nbsp;by&nbsp;zero&#34;</span><span class="op" id="8535745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535748">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535751"><a href="/net/rpc/jsonrpc/all_test.go.html#8535669">reply</a></span><span class="op" id="8535756">.</span><span class="ident" id="8535757">C</span>&nbsp;<span class="op" id="8535759">=</span>&nbsp;<span class="ident" id="8535761"><a href="/net/rpc/jsonrpc/all_test.go.html#8535657">args</a></span><span class="op" id="8535765">.</span><span class="ident" id="8535766">A</span>&nbsp;<span class="op" id="8535768">/</span>&nbsp;<span class="ident" id="8535770"><a href="/net/rpc/jsonrpc/all_test.go.html#8535657">args</a></span><span class="op" id="8535774">.</span><span class="ident" id="8535775">B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535778">return</span>&nbsp;<span class="ident" id="8535785">nil</span><br>
<span class="lineno"></span><span class="op" id="8535789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8535792">func</span>&nbsp;<span class="op" id="8535797">(</span><span class="ident" id="8535798">t</span>&nbsp;<span class="op" id="8535800">*</span><span class="ident" id="8535801"><a href="/net/rpc/jsonrpc/all_test.go.html#8535301">Arith</a></span><span class="op" id="8535806">)</span>&nbsp;<span class="ident" id="8535808">Error</span><span class="op" id="8535813">(</span><span class="ident" id="8535814">args</span>&nbsp;<span class="op" id="8535819">*</span><span class="ident" id="8535820"><a href="/net/rpc/jsonrpc/all_test.go.html#8535239">Args</a></span><span class="op" id="8535824">,</span>&nbsp;<span class="ident" id="8535826">reply</span>&nbsp;<span class="op" id="8535832">*</span><span class="ident" id="8535833"><a href="/net/rpc/jsonrpc/all_test.go.html#8535271">Reply</a></span><span class="op" id="8535838">)</span>&nbsp;<span class="builtintype" id="8535840">error</span>&nbsp;<span class="op" id="8535846">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8535849">panic</span><span class="op" id="8535854">(</span><span class="string" id="8535855">&#34;ERROR&#34;</span><span class="op" id="8535862">)</span><br>
<span class="lineno"></span><span class="op" id="8535864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8535867">func</span>&nbsp;<span class="ident" id="8535872">init</span><span class="op" id="8535876">(</span><span class="op" id="8535877">)</span>&nbsp;<span class="op" id="8535879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535882"><a href="/net/rpc/jsonrpc/all_test.go.html#8535199">rpc</a></span><span class="op" id="8535885">.</span><span class="ident" id="8535886">Register</span><span class="op" id="8535894">(</span><span class="builtinfunc" id="8535895">new</span><span class="op" id="8535898">(</span><span class="ident" id="8535899"><a href="/net/rpc/jsonrpc/all_test.go.html#8535301">Arith</a></span><span class="op" id="8535904">)</span><span class="op" id="8535905">)</span><br>
<span class="lineno">60</span><span class="op" id="8535907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8535910">func</span>&nbsp;<span class="ident" id="8535915">TestServerNoParams</span><span class="op" id="8535933">(</span><span class="ident" id="8535934">t</span>&nbsp;<span class="op" id="8535936">*</span><span class="ident" id="8535937"><a href="/net/rpc/jsonrpc/all_test.go.html#8535221">testing</a></span><span class="op" id="8535944">.</span><span class="ident" id="8535945">T</span><span class="op" id="8535946">)</span>&nbsp;<span class="op" id="8535948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535951">cli</span><span class="op" id="8535954">,</span>&nbsp;<span class="ident" id="8535956">srv</span>&nbsp;<span class="op" id="8535960">:=</span>&nbsp;<span class="ident" id="8535963"><a href="/net/rpc/jsonrpc/all_test.go.html#8535192">net</a></span><span class="op" id="8535966">.</span><span class="ident" id="8535967">Pipe</span><span class="op" id="8535971">(</span><span class="op" id="8535972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535975">defer</span>&nbsp;<span class="ident" id="8535981"><a href="/net/rpc/jsonrpc/all_test.go.html#8535951">cli</a></span><span class="op" id="8535984">.</span><span class="ident" id="8535985">Close</span><span class="op" id="8535990">(</span><span class="op" id="8535991">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535994">go</span>&nbsp;<span class="ident" id="8535997"><a href="/net/rpc/jsonrpc/server.go.html#6280188">ServeConn</a></span><span class="op" id="8536006">(</span><span class="ident" id="8536007"><a href="/net/rpc/jsonrpc/all_test.go.html#8535956">srv</a></span><span class="op" id="8536010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536013">dec</span>&nbsp;<span class="op" id="8536017">:=</span>&nbsp;<span class="ident" id="8536020"><a href="/net/rpc/jsonrpc/all_test.go.html#8535139">json</a></span><span class="op" id="8536024">.</span><span class="ident" id="8536025">NewDecoder</span><span class="op" id="8536035">(</span><span class="ident" id="8536036"><a href="/net/rpc/jsonrpc/all_test.go.html#8535951">cli</a></span><span class="op" id="8536039">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536043"><a href="/net/rpc/jsonrpc/all_test.go.html#8535166">fmt</a></span><span class="op" id="8536046">.</span><span class="ident" id="8536047">Fprintf</span><span class="op" id="8536054">(</span><span class="ident" id="8536055"><a href="/net/rpc/jsonrpc/all_test.go.html#8535951">cli</a></span><span class="op" id="8536058">,</span>&nbsp;<span class="string" id="8536060">`{&#34;method&#34;:&nbsp;&#34;Arith.Add&#34;,&nbsp;&#34;id&#34;:&nbsp;&#34;123&#34;}`</span><span class="op" id="8536098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8536101">var</span>&nbsp;<span class="ident" id="8536105">resp</span>&nbsp;<span class="ident" id="8536110"><a href="/net/rpc/jsonrpc/all_test.go.html#8535317">ArithAddResp</a></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8536124">if</span>&nbsp;<span class="ident" id="8536127">err</span>&nbsp;<span class="op" id="8536131">:=</span>&nbsp;<span class="ident" id="8536134"><a href="/net/rpc/jsonrpc/all_test.go.html#8536013">dec</a></span><span class="op" id="8536137">.</span><span class="ident" id="8536138">Decode</span><span class="op" id="8536144">(</span><span class="op" id="8536145">&amp;</span><span class="ident" id="8536146"><a href="/net/rpc/jsonrpc/all_test.go.html#8536105">resp</a></span><span class="op" id="8536150">)</span><span class="op" id="8536151">;</span>&nbsp;<span class="ident" id="8536153"><a href="/net/rpc/jsonrpc/all_test.go.html#8536127">err</a></span>&nbsp;<span class="op" id="8536157">!=</span>&nbsp;<span class="ident" id="8536160">nil</span>&nbsp;<span class="op" id="8536164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536168"><a href="/net/rpc/jsonrpc/all_test.go.html#8535934">t</a></span><span class="op" id="8536169">.</span><span class="ident" id="8536170">Fatalf</span><span class="op" id="8536176">(</span><span class="string" id="8536177">&#34;Decode&nbsp;after&nbsp;no&nbsp;params:&nbsp;%s&#34;</span><span class="op" id="8536205">,</span>&nbsp;<span class="ident" id="8536207"><a href="/net/rpc/jsonrpc/all_test.go.html#8536127">err</a></span><span class="op" id="8536210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8536216">if</span>&nbsp;<span class="ident" id="8536219"><a href="/net/rpc/jsonrpc/all_test.go.html#8536105">resp</a></span><span class="op" id="8536223">.</span><span class="ident" id="8536224">Error</span>&nbsp;<span class="op" id="8536230">==</span>&nbsp;<span class="ident" id="8536233">nil</span>&nbsp;<span class="op" id="8536237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536241"><a href="/net/rpc/jsonrpc/all_test.go.html#8535934">t</a></span><span class="op" id="8536242">.</span><span class="ident" id="8536243">Fatalf</span><span class="op" id="8536249">(</span><span class="string" id="8536250">&#34;Expected&nbsp;error,&nbsp;got&nbsp;nil&#34;</span><span class="op" id="8536275">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536278">}</span><br>
<span class="lineno"></span><span class="op" id="8536280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8536283">func</span>&nbsp;<span class="ident" id="8536288">TestServerEmptyMessage</span><span class="op" id="8536310">(</span><span class="ident" id="8536311">t</span>&nbsp;<span class="op" id="8536313">*</span><span class="ident" id="8536314"><a href="/net/rpc/jsonrpc/all_test.go.html#8535221">testing</a></span><span class="op" id="8536321">.</span><span class="ident" id="8536322">T</span><span class="op" id="8536323">)</span>&nbsp;<span class="op" id="8536325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536328">cli</span><span class="op" id="8536331">,</span>&nbsp;<span class="ident" id="8536333">srv</span>&nbsp;<span class="op" id="8536337">:=</span>&nbsp;<span class="ident" id="8536340"><a href="/net/rpc/jsonrpc/all_test.go.html#8535192">net</a></span><span class="op" id="8536343">.</span><span class="ident" id="8536344">Pipe</span><span class="op" id="8536348">(</span><span class="op" id="8536349">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8536352">defer</span>&nbsp;<span class="ident" id="8536358"><a href="/net/rpc/jsonrpc/all_test.go.html#8536328">cli</a></span><span class="op" id="8536361">.</span><span class="ident" id="8536362">Close</span><span class="op" id="8536367">(</span><span class="op" id="8536368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8536371">go</span>&nbsp;<span class="ident" id="8536374"><a href="/net/rpc/jsonrpc/server.go.html#6280188">ServeConn</a></span><span class="op" id="8536383">(</span><span class="ident" id="8536384"><a href="/net/rpc/jsonrpc/all_test.go.html#8536333">srv</a></span><span class="op" id="8536387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536390">dec</span>&nbsp;<span class="op" id="8536394">:=</span>&nbsp;<span class="ident" id="8536397"><a href="/net/rpc/jsonrpc/all_test.go.html#8535139">json</a></span><span class="op" id="8536401">.</span><span class="ident" id="8536402">NewDecoder</span><span class="op" id="8536412">(</span><span class="ident" id="8536413"><a href="/net/rpc/jsonrpc/all_test.go.html#8536328">cli</a></span><span class="op" id="8536416">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536420"><a href="/net/rpc/jsonrpc/all_test.go.html#8535166">fmt</a></span><span class="op" id="8536423">.</span><span class="ident" id="8536424">Fprintf</span><span class="op" id="8536431">(</span><span class="ident" id="8536432"><a href="/net/rpc/jsonrpc/all_test.go.html#8536328">cli</a></span><span class="op" id="8536435">,</span>&nbsp;<span class="string" id="8536437">&#34;{}&#34;</span><span class="op" id="8536441">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8536444">var</span>&nbsp;<span class="ident" id="8536448">resp</span>&nbsp;<span class="ident" id="8536453"><a href="/net/rpc/jsonrpc/all_test.go.html#8535317">ArithAddResp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8536467">if</span>&nbsp;<span class="ident" id="8536470">err</span>&nbsp;<span class="op" id="8536474">:=</span>&nbsp;<span class="ident" id="8536477"><a href="/net/rpc/jsonrpc/all_test.go.html#8536390">dec</a></span><span class="op" id="8536480">.</span><span class="ident" id="8536481">Decode</span><span class="op" id="8536487">(</span><span class="op" id="8536488">&amp;</span><span class="ident" id="8536489"><a href="/net/rpc/jsonrpc/all_test.go.html#8536448">resp</a></span><span class="op" id="8536493">)</span><span class="op" id="8536494">;</span>&nbsp;<span class="ident" id="8536496"><a href="/net/rpc/jsonrpc/all_test.go.html#8536470">err</a></span>&nbsp;<span class="op" id="8536500">!=</span>&nbsp;<span class="ident" id="8536503">nil</span>&nbsp;<span class="op" id="8536507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536511"><a href="/net/rpc/jsonrpc/all_test.go.html#8536311">t</a></span><span class="op" id="8536512">.</span><span class="ident" id="8536513">Fatalf</span><span class="op" id="8536519">(</span><span class="string" id="8536520">&#34;Decode&nbsp;after&nbsp;empty:&nbsp;%s&#34;</span><span class="op" id="8536544">,</span>&nbsp;<span class="ident" id="8536546"><a href="/net/rpc/jsonrpc/all_test.go.html#8536470">err</a></span><span class="op" id="8536549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8536555">if</span>&nbsp;<span class="ident" id="8536558"><a href="/net/rpc/jsonrpc/all_test.go.html#8536448">resp</a></span><span class="op" id="8536562">.</span><span class="ident" id="8536563">Error</span>&nbsp;<span class="op" id="8536569">==</span>&nbsp;<span class="ident" id="8536572">nil</span>&nbsp;<span class="op" id="8536576">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536580"><a href="/net/rpc/jsonrpc/all_test.go.html#8536311">t</a></span><span class="op" id="8536581">.</span><span class="ident" id="8536582">Fatalf</span><span class="op" id="8536588">(</span><span class="string" id="8536589">&#34;Expected&nbsp;error,&nbsp;got&nbsp;nil&#34;</span><span class="op" id="8536614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536617">}</span><br>
<span class="lineno"></span><span class="op" id="8536619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8536622">func</span>&nbsp;<span class="ident" id="8536627">TestServer</span><span class="op" id="8536637">(</span><span class="ident" id="8536638">t</span>&nbsp;<span class="op" id="8536640">*</span><span class="ident" id="8536641"><a href="/net/rpc/jsonrpc/all_test.go.html#8535221">testing</a></span><span class="op" id="8536648">.</span><span class="ident" id="8536649">T</span><span class="op" id="8536650">)</span>&nbsp;<span class="op" id="8536652">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536655">cli</span><span class="op" id="8536658">,</span>&nbsp;<span class="ident" id="8536660">srv</span>&nbsp;<span class="op" id="8536664">:=</span>&nbsp;<span class="ident" id="8536667"><a href="/net/rpc/jsonrpc/all_test.go.html#8535192">net</a></span><span class="op" id="8536670">.</span><span class="ident" id="8536671">Pipe</span><span class="op" id="8536675">(</span><span class="op" id="8536676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8536679">defer</span>&nbsp;<span class="ident" id="8536685"><a href="/net/rpc/jsonrpc/all_test.go.html#8536655">cli</a></span><span class="op" id="8536688">.</span><span class="ident" id="8536689">Close</span><span class="op" id="8536694">(</span><span class="op" id="8536695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8536698">go</span>&nbsp;<span class="ident" id="8536701"><a href="/net/rpc/jsonrpc/server.go.html#6280188">ServeConn</a></span><span class="op" id="8536710">(</span><span class="ident" id="8536711"><a href="/net/rpc/jsonrpc/all_test.go.html#8536660">srv</a></span><span class="op" id="8536714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536717">dec</span>&nbsp;<span class="op" id="8536721">:=</span>&nbsp;<span class="ident" id="8536724"><a href="/net/rpc/jsonrpc/all_test.go.html#8535139">json</a></span><span class="op" id="8536728">.</span><span class="ident" id="8536729">NewDecoder</span><span class="op" id="8536739">(</span><span class="ident" id="8536740"><a href="/net/rpc/jsonrpc/all_test.go.html#8536655">cli</a></span><span class="op" id="8536743">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8536747">//&nbsp;Send&nbsp;hand-coded&nbsp;requests&nbsp;to&nbsp;server,&nbsp;parse&nbsp;responses.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8536804">for</span>&nbsp;<span class="ident" id="8536808">i</span>&nbsp;<span class="op" id="8536810">:=</span>&nbsp;<span class="num" id="8536813">0</span><span class="op" id="8536814">;</span>&nbsp;<span class="ident" id="8536816"><a href="/net/rpc/jsonrpc/all_test.go.html#8536808">i</a></span>&nbsp;<span class="op" id="8536818">&lt;</span>&nbsp;<span class="num" id="8536820">10</span><span class="op" id="8536822">;</span>&nbsp;<span class="ident" id="8536824"><a href="/net/rpc/jsonrpc/all_test.go.html#8536808">i</a></span><span class="op" id="8536825">++</span>&nbsp;<span class="op" id="8536828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536832"><a href="/net/rpc/jsonrpc/all_test.go.html#8535166">fmt</a></span><span class="op" id="8536835">.</span><span class="ident" id="8536836">Fprintf</span><span class="op" id="8536843">(</span><span class="ident" id="8536844"><a href="/net/rpc/jsonrpc/all_test.go.html#8536655">cli</a></span><span class="op" id="8536847">,</span>&nbsp;<span class="string" id="8536849">`{&#34;method&#34;:&nbsp;&#34;Arith.Add&#34;,&nbsp;&#34;id&#34;:&nbsp;&#34;\u%04d&#34;,&nbsp;&#34;params&#34;:&nbsp;[{&#34;A&#34;:&nbsp;%d,&nbsp;&#34;B&#34;:&nbsp;%d}]}`</span><span class="op" id="8536922">,</span>&nbsp;<span class="ident" id="8536924"><a href="/net/rpc/jsonrpc/all_test.go.html#8536808">i</a></span><span class="op" id="8536925">,</span>&nbsp;<span class="ident" id="8536927"><a href="/net/rpc/jsonrpc/all_test.go.html#8536808">i</a></span><span class="op" id="8536928">,</span>&nbsp;<span class="ident" id="8536930"><a href="/net/rpc/jsonrpc/all_test.go.html#8536808">i</a></span><span class="op" id="8536931">+</span><span class="num" id="8536932">1</span><span class="op" id="8536933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8536937">var</span>&nbsp;<span class="ident" id="8536941">resp</span>&nbsp;<span class="ident" id="8536946"><a href="/net/rpc/jsonrpc/all_test.go.html#8535317">ArithAddResp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536961">err</span>&nbsp;<span class="op" id="8536965">:=</span>&nbsp;<span class="ident" id="8536968"><a href="/net/rpc/jsonrpc/all_test.go.html#8536717">dec</a></span><span class="op" id="8536971">.</span><span class="ident" id="8536972">Decode</span><span class="op" id="8536978">(</span><span class="op" id="8536979">&amp;</span><span class="ident" id="8536980"><a href="/net/rpc/jsonrpc/all_test.go.html#8536941">resp</a></span><span class="op" id="8536984">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8536988">if</span>&nbsp;<span class="ident" id="8536991"><a href="/net/rpc/jsonrpc/all_test.go.html#8536961">err</a></span>&nbsp;<span class="op" id="8536995">!=</span>&nbsp;<span class="ident" id="8536998">nil</span>&nbsp;<span class="op" id="8537002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537007"><a href="/net/rpc/jsonrpc/all_test.go.html#8536638">t</a></span><span class="op" id="8537008">.</span><span class="ident" id="8537009">Fatalf</span><span class="op" id="8537015">(</span><span class="string" id="8537016">&#34;Decode:&nbsp;%s&#34;</span><span class="op" id="8537028">,</span>&nbsp;<span class="ident" id="8537030"><a href="/net/rpc/jsonrpc/all_test.go.html#8536961">err</a></span><span class="op" id="8537033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537041">if</span>&nbsp;<span class="ident" id="8537044"><a href="/net/rpc/jsonrpc/all_test.go.html#8536941">resp</a></span><span class="op" id="8537048">.</span><span class="ident" id="8537049">Error</span>&nbsp;<span class="op" id="8537055">!=</span>&nbsp;<span class="ident" id="8537058">nil</span>&nbsp;<span class="op" id="8537062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537067"><a href="/net/rpc/jsonrpc/all_test.go.html#8536638">t</a></span><span class="op" id="8537068">.</span><span class="ident" id="8537069">Fatalf</span><span class="op" id="8537075">(</span><span class="string" id="8537076">&#34;resp.Error:&nbsp;%s&#34;</span><span class="op" id="8537092">,</span>&nbsp;<span class="ident" id="8537094"><a href="/net/rpc/jsonrpc/all_test.go.html#8536941">resp</a></span><span class="op" id="8537098">.</span><span class="ident" id="8537099">Error</span><span class="op" id="8537104">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537112">if</span>&nbsp;<span class="ident" id="8537115"><a href="/net/rpc/jsonrpc/all_test.go.html#8536941">resp</a></span><span class="op" id="8537119">.</span><span class="ident" id="8537120">Id</span><span class="op" id="8537122">.</span><span class="op" id="8537123">(</span><span class="builtintype" id="8537124">string</span><span class="op" id="8537130">)</span>&nbsp;<span class="op" id="8537132">!=</span>&nbsp;<span class="builtintype" id="8537135">string</span><span class="op" id="8537141">(</span><span class="ident" id="8537142"><a href="/net/rpc/jsonrpc/all_test.go.html#8536808">i</a></span><span class="op" id="8537143">)</span>&nbsp;<span class="op" id="8537145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537150"><a href="/net/rpc/jsonrpc/all_test.go.html#8536638">t</a></span><span class="op" id="8537151">.</span><span class="ident" id="8537152">Fatalf</span><span class="op" id="8537158">(</span><span class="string" id="8537159">&#34;resp:&nbsp;bad&nbsp;id&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8537184">,</span>&nbsp;<span class="ident" id="8537186"><a href="/net/rpc/jsonrpc/all_test.go.html#8536941">resp</a></span><span class="op" id="8537190">.</span><span class="ident" id="8537191">Id</span><span class="op" id="8537193">.</span><span class="op" id="8537194">(</span><span class="builtintype" id="8537195">string</span><span class="op" id="8537201">)</span><span class="op" id="8537202">,</span>&nbsp;<span class="builtintype" id="8537204">string</span><span class="op" id="8537210">(</span><span class="ident" id="8537211"><a href="/net/rpc/jsonrpc/all_test.go.html#8536808">i</a></span><span class="op" id="8537212">)</span><span class="op" id="8537213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537221">if</span>&nbsp;<span class="ident" id="8537224"><a href="/net/rpc/jsonrpc/all_test.go.html#8536941">resp</a></span><span class="op" id="8537228">.</span><span class="ident" id="8537229">Result</span><span class="op" id="8537235">.</span><span class="ident" id="8537236">C</span>&nbsp;<span class="op" id="8537238">!=</span>&nbsp;<span class="num" id="8537241">2</span><span class="op" id="8537242">*</span><span class="ident" id="8537243"><a href="/net/rpc/jsonrpc/all_test.go.html#8536808">i</a></span><span class="op" id="8537244">+</span><span class="num" id="8537245">1</span>&nbsp;<span class="op" id="8537247">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537252"><a href="/net/rpc/jsonrpc/all_test.go.html#8536638">t</a></span><span class="op" id="8537253">.</span><span class="ident" id="8537254">Fatalf</span><span class="op" id="8537260">(</span><span class="string" id="8537261">&#34;resp:&nbsp;bad&nbsp;result:&nbsp;%d+%d=%d&#34;</span><span class="op" id="8537289">,</span>&nbsp;<span class="ident" id="8537291"><a href="/net/rpc/jsonrpc/all_test.go.html#8536808">i</a></span><span class="op" id="8537292">,</span>&nbsp;<span class="ident" id="8537294"><a href="/net/rpc/jsonrpc/all_test.go.html#8536808">i</a></span><span class="op" id="8537295">+</span><span class="num" id="8537296">1</span><span class="op" id="8537297">,</span>&nbsp;<span class="ident" id="8537299"><a href="/net/rpc/jsonrpc/all_test.go.html#8536941">resp</a></span><span class="op" id="8537303">.</span><span class="ident" id="8537304">Result</span><span class="op" id="8537310">.</span><span class="ident" id="8537311">C</span><span class="op" id="8537312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537319">}</span><br>
<span class="lineno"></span><span class="op" id="8537321">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="keyword" id="8537324">func</span>&nbsp;<span class="ident" id="8537329">TestClient</span><span class="op" id="8537339">(</span><span class="ident" id="8537340">t</span>&nbsp;<span class="op" id="8537342">*</span><span class="ident" id="8537343"><a href="/net/rpc/jsonrpc/all_test.go.html#8535221">testing</a></span><span class="op" id="8537350">.</span><span class="ident" id="8537351">T</span><span class="op" id="8537352">)</span>&nbsp;<span class="op" id="8537354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8537357">//&nbsp;Assume&nbsp;server&nbsp;is&nbsp;okay&nbsp;(TestServer&nbsp;is&nbsp;above).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8537406">//&nbsp;Test&nbsp;client&nbsp;against&nbsp;server.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537438">cli</span><span class="op" id="8537441">,</span>&nbsp;<span class="ident" id="8537443">srv</span>&nbsp;<span class="op" id="8537447">:=</span>&nbsp;<span class="ident" id="8537450"><a href="/net/rpc/jsonrpc/all_test.go.html#8535192">net</a></span><span class="op" id="8537453">.</span><span class="ident" id="8537454">Pipe</span><span class="op" id="8537458">(</span><span class="op" id="8537459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537462">go</span>&nbsp;<span class="ident" id="8537465"><a href="/net/rpc/jsonrpc/server.go.html#6280188">ServeConn</a></span><span class="op" id="8537474">(</span><span class="ident" id="8537475"><a href="/net/rpc/jsonrpc/all_test.go.html#8537443">srv</a></span><span class="op" id="8537478">)</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537482">client</span>&nbsp;<span class="op" id="8537489">:=</span>&nbsp;<span class="ident" id="8537492"><a href="/net/rpc/jsonrpc/client.go.html#6276644">NewClient</a></span><span class="op" id="8537501">(</span><span class="ident" id="8537502"><a href="/net/rpc/jsonrpc/all_test.go.html#8537438">cli</a></span><span class="op" id="8537505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537508">defer</span>&nbsp;<span class="ident" id="8537514"><a href="/net/rpc/jsonrpc/all_test.go.html#8537482">client</a></span><span class="op" id="8537520">.</span><span class="ident" id="8537521">Close</span><span class="op" id="8537526">(</span><span class="op" id="8537527">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8537531">//&nbsp;Synchronous&nbsp;calls</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537553">args</span>&nbsp;<span class="op" id="8537558">:=</span>&nbsp;<span class="op" id="8537561">&amp;</span><span class="ident" id="8537562"><a href="/net/rpc/jsonrpc/all_test.go.html#8535239">Args</a></span><span class="op" id="8537566">{</span><span class="num" id="8537567">7</span><span class="op" id="8537568">,</span>&nbsp;<span class="num" id="8537570">8</span><span class="op" id="8537571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537574">reply</span>&nbsp;<span class="op" id="8537580">:=</span>&nbsp;<span class="builtinfunc" id="8537583">new</span><span class="op" id="8537586">(</span><span class="ident" id="8537587"><a href="/net/rpc/jsonrpc/all_test.go.html#8535271">Reply</a></span><span class="op" id="8537592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537595">err</span>&nbsp;<span class="op" id="8537599">:=</span>&nbsp;<span class="ident" id="8537602"><a href="/net/rpc/jsonrpc/all_test.go.html#8537482">client</a></span><span class="op" id="8537608">.</span><span class="ident" id="8537609">Call</span><span class="op" id="8537613">(</span><span class="string" id="8537614">&#34;Arith.Add&#34;</span><span class="op" id="8537625">,</span>&nbsp;<span class="ident" id="8537627"><a href="/net/rpc/jsonrpc/all_test.go.html#8537553">args</a></span><span class="op" id="8537631">,</span>&nbsp;<span class="ident" id="8537633"><a href="/net/rpc/jsonrpc/all_test.go.html#8537574">reply</a></span><span class="op" id="8537638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537641">if</span>&nbsp;<span class="ident" id="8537644"><a href="/net/rpc/jsonrpc/all_test.go.html#8537595">err</a></span>&nbsp;<span class="op" id="8537648">!=</span>&nbsp;<span class="ident" id="8537651">nil</span>&nbsp;<span class="op" id="8537655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537659"><a href="/net/rpc/jsonrpc/all_test.go.html#8537340">t</a></span><span class="op" id="8537660">.</span><span class="ident" id="8537661">Errorf</span><span class="op" id="8537667">(</span><span class="string" id="8537668">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="8537710">,</span>&nbsp;<span class="ident" id="8537712"><a href="/net/rpc/jsonrpc/all_test.go.html#8537595">err</a></span><span class="op" id="8537715">.</span><span class="ident" id="8537716">Error</span><span class="op" id="8537721">(</span><span class="op" id="8537722">)</span><span class="op" id="8537723">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537729">if</span>&nbsp;<span class="ident" id="8537732"><a href="/net/rpc/jsonrpc/all_test.go.html#8537574">reply</a></span><span class="op" id="8537737">.</span><span class="ident" id="8537738">C</span>&nbsp;<span class="op" id="8537740">!=</span>&nbsp;<span class="ident" id="8537743"><a href="/net/rpc/jsonrpc/all_test.go.html#8537553">args</a></span><span class="op" id="8537747">.</span><span class="ident" id="8537748">A</span><span class="op" id="8537749">+</span><span class="ident" id="8537750"><a href="/net/rpc/jsonrpc/all_test.go.html#8537553">args</a></span><span class="op" id="8537754">.</span><span class="ident" id="8537755">B</span>&nbsp;<span class="op" id="8537757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537761"><a href="/net/rpc/jsonrpc/all_test.go.html#8537340">t</a></span><span class="op" id="8537762">.</span><span class="ident" id="8537763">Errorf</span><span class="op" id="8537769">(</span><span class="string" id="8537770">&#34;Add:&nbsp;got&nbsp;%d&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="8537795">,</span>&nbsp;<span class="ident" id="8537797"><a href="/net/rpc/jsonrpc/all_test.go.html#8537574">reply</a></span><span class="op" id="8537802">.</span><span class="ident" id="8537803">C</span><span class="op" id="8537804">,</span>&nbsp;<span class="ident" id="8537806"><a href="/net/rpc/jsonrpc/all_test.go.html#8537553">args</a></span><span class="op" id="8537810">.</span><span class="ident" id="8537811">A</span><span class="op" id="8537812">+</span><span class="ident" id="8537813"><a href="/net/rpc/jsonrpc/all_test.go.html#8537553">args</a></span><span class="op" id="8537817">.</span><span class="ident" id="8537818">B</span><span class="op" id="8537819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537826"><a href="/net/rpc/jsonrpc/all_test.go.html#8537553">args</a></span>&nbsp;<span class="op" id="8537831">=</span>&nbsp;<span class="op" id="8537833">&amp;</span><span class="ident" id="8537834"><a href="/net/rpc/jsonrpc/all_test.go.html#8535239">Args</a></span><span class="op" id="8537838">{</span><span class="num" id="8537839">7</span><span class="op" id="8537840">,</span>&nbsp;<span class="num" id="8537842">8</span><span class="op" id="8537843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537846"><a href="/net/rpc/jsonrpc/all_test.go.html#8537574">reply</a></span>&nbsp;<span class="op" id="8537852">=</span>&nbsp;<span class="builtinfunc" id="8537854">new</span><span class="op" id="8537857">(</span><span class="ident" id="8537858"><a href="/net/rpc/jsonrpc/all_test.go.html#8535271">Reply</a></span><span class="op" id="8537863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537866"><a href="/net/rpc/jsonrpc/all_test.go.html#8537595">err</a></span>&nbsp;<span class="op" id="8537870">=</span>&nbsp;<span class="ident" id="8537872"><a href="/net/rpc/jsonrpc/all_test.go.html#8537482">client</a></span><span class="op" id="8537878">.</span><span class="ident" id="8537879">Call</span><span class="op" id="8537883">(</span><span class="string" id="8537884">&#34;Arith.Mul&#34;</span><span class="op" id="8537895">,</span>&nbsp;<span class="ident" id="8537897"><a href="/net/rpc/jsonrpc/all_test.go.html#8537553">args</a></span><span class="op" id="8537901">,</span>&nbsp;<span class="ident" id="8537903"><a href="/net/rpc/jsonrpc/all_test.go.html#8537574">reply</a></span><span class="op" id="8537908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537911">if</span>&nbsp;<span class="ident" id="8537914"><a href="/net/rpc/jsonrpc/all_test.go.html#8537595">err</a></span>&nbsp;<span class="op" id="8537918">!=</span>&nbsp;<span class="ident" id="8537921">nil</span>&nbsp;<span class="op" id="8537925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537929"><a href="/net/rpc/jsonrpc/all_test.go.html#8537340">t</a></span><span class="op" id="8537930">.</span><span class="ident" id="8537931">Errorf</span><span class="op" id="8537937">(</span><span class="string" id="8537938">&#34;Mul:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="8537980">,</span>&nbsp;<span class="ident" id="8537982"><a href="/net/rpc/jsonrpc/all_test.go.html#8537595">err</a></span><span class="op" id="8537985">.</span><span class="ident" id="8537986">Error</span><span class="op" id="8537991">(</span><span class="op" id="8537992">)</span><span class="op" id="8537993">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537999">if</span>&nbsp;<span class="ident" id="8538002"><a href="/net/rpc/jsonrpc/all_test.go.html#8537574">reply</a></span><span class="op" id="8538007">.</span><span class="ident" id="8538008">C</span>&nbsp;<span class="op" id="8538010">!=</span>&nbsp;<span class="ident" id="8538013"><a href="/net/rpc/jsonrpc/all_test.go.html#8537553">args</a></span><span class="op" id="8538017">.</span><span class="ident" id="8538018">A</span><span class="op" id="8538019">*</span><span class="ident" id="8538020"><a href="/net/rpc/jsonrpc/all_test.go.html#8537553">args</a></span><span class="op" id="8538024">.</span><span class="ident" id="8538025">B</span>&nbsp;<span class="op" id="8538027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538031"><a href="/net/rpc/jsonrpc/all_test.go.html#8537340">t</a></span><span class="op" id="8538032">.</span><span class="ident" id="8538033">Errorf</span><span class="op" id="8538039">(</span><span class="string" id="8538040">&#34;Mul:&nbsp;got&nbsp;%d&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="8538065">,</span>&nbsp;<span class="ident" id="8538067"><a href="/net/rpc/jsonrpc/all_test.go.html#8537574">reply</a></span><span class="op" id="8538072">.</span><span class="ident" id="8538073">C</span><span class="op" id="8538074">,</span>&nbsp;<span class="ident" id="8538076"><a href="/net/rpc/jsonrpc/all_test.go.html#8537553">args</a></span><span class="op" id="8538080">.</span><span class="ident" id="8538081">A</span><span class="op" id="8538082">*</span><span class="ident" id="8538083"><a href="/net/rpc/jsonrpc/all_test.go.html#8537553">args</a></span><span class="op" id="8538087">.</span><span class="ident" id="8538088">B</span><span class="op" id="8538089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8538092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8538096">//&nbsp;Out&nbsp;of&nbsp;order.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538114"><a href="/net/rpc/jsonrpc/all_test.go.html#8537553">args</a></span>&nbsp;<span class="op" id="8538119">=</span>&nbsp;<span class="op" id="8538121">&amp;</span><span class="ident" id="8538122"><a href="/net/rpc/jsonrpc/all_test.go.html#8535239">Args</a></span><span class="op" id="8538126">{</span><span class="num" id="8538127">7</span><span class="op" id="8538128">,</span>&nbsp;<span class="num" id="8538130">8</span><span class="op" id="8538131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538134">mulReply</span>&nbsp;<span class="op" id="8538143">:=</span>&nbsp;<span class="builtinfunc" id="8538146">new</span><span class="op" id="8538149">(</span><span class="ident" id="8538150"><a href="/net/rpc/jsonrpc/all_test.go.html#8535271">Reply</a></span><span class="op" id="8538155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538158">mulCall</span>&nbsp;<span class="op" id="8538166">:=</span>&nbsp;<span class="ident" id="8538169"><a href="/net/rpc/jsonrpc/all_test.go.html#8537482">client</a></span><span class="op" id="8538175">.</span><span class="ident" id="8538176">Go</span><span class="op" id="8538178">(</span><span class="string" id="8538179">&#34;Arith.Mul&#34;</span><span class="op" id="8538190">,</span>&nbsp;<span class="ident" id="8538192"><a href="/net/rpc/jsonrpc/all_test.go.html#8537553">args</a></span><span class="op" id="8538196">,</span>&nbsp;<span class="ident" id="8538198"><a href="/net/rpc/jsonrpc/all_test.go.html#8538134">mulReply</a></span><span class="op" id="8538206">,</span>&nbsp;<span class="ident" id="8538208">nil</span><span class="op" id="8538211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538214">addReply</span>&nbsp;<span class="op" id="8538223">:=</span>&nbsp;<span class="builtinfunc" id="8538226">new</span><span class="op" id="8538229">(</span><span class="ident" id="8538230"><a href="/net/rpc/jsonrpc/all_test.go.html#8535271">Reply</a></span><span class="op" id="8538235">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538238">addCall</span>&nbsp;<span class="op" id="8538246">:=</span>&nbsp;<span class="ident" id="8538249"><a href="/net/rpc/jsonrpc/all_test.go.html#8537482">client</a></span><span class="op" id="8538255">.</span><span class="ident" id="8538256">Go</span><span class="op" id="8538258">(</span><span class="string" id="8538259">&#34;Arith.Add&#34;</span><span class="op" id="8538270">,</span>&nbsp;<span class="ident" id="8538272"><a href="/net/rpc/jsonrpc/all_test.go.html#8537553">args</a></span><span class="op" id="8538276">,</span>&nbsp;<span class="ident" id="8538278"><a href="/net/rpc/jsonrpc/all_test.go.html#8538214">addReply</a></span><span class="op" id="8538286">,</span>&nbsp;<span class="ident" id="8538288">nil</span><span class="op" id="8538291">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538295"><a href="/net/rpc/jsonrpc/all_test.go.html#8538238">addCall</a></span>&nbsp;<span class="op" id="8538303">=</span>&nbsp;<span class="op" id="8538305">&lt;-</span><span class="ident" id="8538307"><a href="/net/rpc/jsonrpc/all_test.go.html#8538238">addCall</a></span><span class="op" id="8538314">.</span><span class="ident" id="8538315">Done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8538321">if</span>&nbsp;<span class="ident" id="8538324"><a href="/net/rpc/jsonrpc/all_test.go.html#8538238">addCall</a></span><span class="op" id="8538331">.</span><span class="ident" id="8538332">Error</span>&nbsp;<span class="op" id="8538338">!=</span>&nbsp;<span class="ident" id="8538341">nil</span>&nbsp;<span class="op" id="8538345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538349"><a href="/net/rpc/jsonrpc/all_test.go.html#8537340">t</a></span><span class="op" id="8538350">.</span><span class="ident" id="8538351">Errorf</span><span class="op" id="8538357">(</span><span class="string" id="8538358">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="8538400">,</span>&nbsp;<span class="ident" id="8538402"><a href="/net/rpc/jsonrpc/all_test.go.html#8538238">addCall</a></span><span class="op" id="8538409">.</span><span class="ident" id="8538410">Error</span><span class="op" id="8538415">.</span><span class="ident" id="8538416">Error</span><span class="op" id="8538421">(</span><span class="op" id="8538422">)</span><span class="op" id="8538423">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8538426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8538429">if</span>&nbsp;<span class="ident" id="8538432"><a href="/net/rpc/jsonrpc/all_test.go.html#8538214">addReply</a></span><span class="op" id="8538440">.</span><span class="ident" id="8538441">C</span>&nbsp;<span class="op" id="8538443">!=</span>&nbsp;<span class="ident" id="8538446"><a href="/net/rpc/jsonrpc/all_test.go.html#8537553">args</a></span><span class="op" id="8538450">.</span><span class="ident" id="8538451">A</span><span class="op" id="8538452">+</span><span class="ident" id="8538453"><a href="/net/rpc/jsonrpc/all_test.go.html#8537553">args</a></span><span class="op" id="8538457">.</span><span class="ident" id="8538458">B</span>&nbsp;<span class="op" id="8538460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538464"><a href="/net/rpc/jsonrpc/all_test.go.html#8537340">t</a></span><span class="op" id="8538465">.</span><span class="ident" id="8538466">Errorf</span><span class="op" id="8538472">(</span><span class="string" id="8538473">&#34;Add:&nbsp;got&nbsp;%d&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="8538498">,</span>&nbsp;<span class="ident" id="8538500"><a href="/net/rpc/jsonrpc/all_test.go.html#8538214">addReply</a></span><span class="op" id="8538508">.</span><span class="ident" id="8538509">C</span><span class="op" id="8538510">,</span>&nbsp;<span class="ident" id="8538512"><a href="/net/rpc/jsonrpc/all_test.go.html#8537553">args</a></span><span class="op" id="8538516">.</span><span class="ident" id="8538517">A</span><span class="op" id="8538518">+</span><span class="ident" id="8538519"><a href="/net/rpc/jsonrpc/all_test.go.html#8537553">args</a></span><span class="op" id="8538523">.</span><span class="ident" id="8538524">B</span><span class="op" id="8538525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8538528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538532"><a href="/net/rpc/jsonrpc/all_test.go.html#8538158">mulCall</a></span>&nbsp;<span class="op" id="8538540">=</span>&nbsp;<span class="op" id="8538542">&lt;-</span><span class="ident" id="8538544"><a href="/net/rpc/jsonrpc/all_test.go.html#8538158">mulCall</a></span><span class="op" id="8538551">.</span><span class="ident" id="8538552">Done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8538558">if</span>&nbsp;<span class="ident" id="8538561"><a href="/net/rpc/jsonrpc/all_test.go.html#8538158">mulCall</a></span><span class="op" id="8538568">.</span><span class="ident" id="8538569">Error</span>&nbsp;<span class="op" id="8538575">!=</span>&nbsp;<span class="ident" id="8538578">nil</span>&nbsp;<span class="op" id="8538582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538586"><a href="/net/rpc/jsonrpc/all_test.go.html#8537340">t</a></span><span class="op" id="8538587">.</span><span class="ident" id="8538588">Errorf</span><span class="op" id="8538594">(</span><span class="string" id="8538595">&#34;Mul:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="8538637">,</span>&nbsp;<span class="ident" id="8538639"><a href="/net/rpc/jsonrpc/all_test.go.html#8538158">mulCall</a></span><span class="op" id="8538646">.</span><span class="ident" id="8538647">Error</span><span class="op" id="8538652">.</span><span class="ident" id="8538653">Error</span><span class="op" id="8538658">(</span><span class="op" id="8538659">)</span><span class="op" id="8538660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8538663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8538666">if</span>&nbsp;<span class="ident" id="8538669"><a href="/net/rpc/jsonrpc/all_test.go.html#8538134">mulReply</a></span><span class="op" id="8538677">.</span><span class="ident" id="8538678">C</span>&nbsp;<span class="op" id="8538680">!=</span>&nbsp;<span class="ident" id="8538683"><a href="/net/rpc/jsonrpc/all_test.go.html#8537553">args</a></span><span class="op" id="8538687">.</span><span class="ident" id="8538688">A</span><span class="op" id="8538689">*</span><span class="ident" id="8538690"><a href="/net/rpc/jsonrpc/all_test.go.html#8537553">args</a></span><span class="op" id="8538694">.</span><span class="ident" id="8538695">B</span>&nbsp;<span class="op" id="8538697">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538701"><a href="/net/rpc/jsonrpc/all_test.go.html#8537340">t</a></span><span class="op" id="8538702">.</span><span class="ident" id="8538703">Errorf</span><span class="op" id="8538709">(</span><span class="string" id="8538710">&#34;Mul:&nbsp;got&nbsp;%d&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="8538735">,</span>&nbsp;<span class="ident" id="8538737"><a href="/net/rpc/jsonrpc/all_test.go.html#8538134">mulReply</a></span><span class="op" id="8538745">.</span><span class="ident" id="8538746">C</span><span class="op" id="8538747">,</span>&nbsp;<span class="ident" id="8538749"><a href="/net/rpc/jsonrpc/all_test.go.html#8537553">args</a></span><span class="op" id="8538753">.</span><span class="ident" id="8538754">A</span><span class="op" id="8538755">*</span><span class="ident" id="8538756"><a href="/net/rpc/jsonrpc/all_test.go.html#8537553">args</a></span><span class="op" id="8538760">.</span><span class="ident" id="8538761">B</span><span class="op" id="8538762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8538765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8538769">//&nbsp;Error&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538784"><a href="/net/rpc/jsonrpc/all_test.go.html#8537553">args</a></span>&nbsp;<span class="op" id="8538789">=</span>&nbsp;<span class="op" id="8538791">&amp;</span><span class="ident" id="8538792"><a href="/net/rpc/jsonrpc/all_test.go.html#8535239">Args</a></span><span class="op" id="8538796">{</span><span class="num" id="8538797">7</span><span class="op" id="8538798">,</span>&nbsp;<span class="num" id="8538800">0</span><span class="op" id="8538801">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538804"><a href="/net/rpc/jsonrpc/all_test.go.html#8537574">reply</a></span>&nbsp;<span class="op" id="8538810">=</span>&nbsp;<span class="builtinfunc" id="8538812">new</span><span class="op" id="8538815">(</span><span class="ident" id="8538816"><a href="/net/rpc/jsonrpc/all_test.go.html#8535271">Reply</a></span><span class="op" id="8538821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538824"><a href="/net/rpc/jsonrpc/all_test.go.html#8537595">err</a></span>&nbsp;<span class="op" id="8538828">=</span>&nbsp;<span class="ident" id="8538830"><a href="/net/rpc/jsonrpc/all_test.go.html#8537482">client</a></span><span class="op" id="8538836">.</span><span class="ident" id="8538837">Call</span><span class="op" id="8538841">(</span><span class="string" id="8538842">&#34;Arith.Div&#34;</span><span class="op" id="8538853">,</span>&nbsp;<span class="ident" id="8538855"><a href="/net/rpc/jsonrpc/all_test.go.html#8537553">args</a></span><span class="op" id="8538859">,</span>&nbsp;<span class="ident" id="8538861"><a href="/net/rpc/jsonrpc/all_test.go.html#8537574">reply</a></span><span class="op" id="8538866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8538869">//&nbsp;expect&nbsp;an&nbsp;error:&nbsp;zero&nbsp;divide</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8538902">if</span>&nbsp;<span class="ident" id="8538905"><a href="/net/rpc/jsonrpc/all_test.go.html#8537595">err</a></span>&nbsp;<span class="op" id="8538909">==</span>&nbsp;<span class="ident" id="8538912">nil</span>&nbsp;<span class="op" id="8538916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538920"><a href="/net/rpc/jsonrpc/all_test.go.html#8537340">t</a></span><span class="op" id="8538921">.</span><span class="ident" id="8538922">Error</span><span class="op" id="8538927">(</span><span class="string" id="8538928">&#34;Div:&nbsp;expected&nbsp;error&#34;</span><span class="op" id="8538949">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8538952">}</span>&nbsp;<span class="keyword" id="8538954">else</span>&nbsp;<span class="keyword" id="8538959">if</span>&nbsp;<span class="ident" id="8538962"><a href="/net/rpc/jsonrpc/all_test.go.html#8537595">err</a></span><span class="op" id="8538965">.</span><span class="ident" id="8538966">Error</span><span class="op" id="8538971">(</span><span class="op" id="8538972">)</span>&nbsp;<span class="op" id="8538974">!=</span>&nbsp;<span class="string" id="8538977">&#34;divide&nbsp;by&nbsp;zero&#34;</span>&nbsp;<span class="op" id="8538994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538998"><a href="/net/rpc/jsonrpc/all_test.go.html#8537340">t</a></span><span class="op" id="8538999">.</span><span class="ident" id="8539000">Error</span><span class="op" id="8539005">(</span><span class="string" id="8539006">&#34;Div:&nbsp;expected&nbsp;divide&nbsp;by&nbsp;zero&nbsp;error;&nbsp;got&#34;</span><span class="op" id="8539047">,</span>&nbsp;<span class="ident" id="8539049"><a href="/net/rpc/jsonrpc/all_test.go.html#8537595">err</a></span><span class="op" id="8539052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8539055">}</span><br>
<span class="lineno"></span><span class="op" id="8539057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="8539060">func</span>&nbsp;<span class="ident" id="8539065">TestMalformedInput</span><span class="op" id="8539083">(</span><span class="ident" id="8539084">t</span>&nbsp;<span class="op" id="8539086">*</span><span class="ident" id="8539087"><a href="/net/rpc/jsonrpc/all_test.go.html#8535221">testing</a></span><span class="op" id="8539094">.</span><span class="ident" id="8539095">T</span><span class="op" id="8539096">)</span>&nbsp;<span class="op" id="8539098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539101">cli</span><span class="op" id="8539104">,</span>&nbsp;<span class="ident" id="8539106">srv</span>&nbsp;<span class="op" id="8539110">:=</span>&nbsp;<span class="ident" id="8539113"><a href="/net/rpc/jsonrpc/all_test.go.html#8535192">net</a></span><span class="op" id="8539116">.</span><span class="ident" id="8539117">Pipe</span><span class="op" id="8539121">(</span><span class="op" id="8539122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8539125">go</span>&nbsp;<span class="ident" id="8539128"><a href="/net/rpc/jsonrpc/all_test.go.html#8539101">cli</a></span><span class="op" id="8539131">.</span><span class="ident" id="8539132">Write</span><span class="op" id="8539137">(</span><span class="op" id="8539138">[</span><span class="op" id="8539139">]</span><span class="builtintype" id="8539140">byte</span><span class="op" id="8539144">(</span><span class="string" id="8539145">`{id:1}`</span><span class="op" id="8539153">)</span><span class="op" id="8539154">)</span>&nbsp;<span class="comment" id="8539156">//&nbsp;invalid&nbsp;json</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539173"><a href="/net/rpc/jsonrpc/server.go.html#6280188">ServeConn</a></span><span class="op" id="8539182">(</span><span class="ident" id="8539183"><a href="/net/rpc/jsonrpc/all_test.go.html#8539106">srv</a></span><span class="op" id="8539186">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8539204">//&nbsp;must&nbsp;return,&nbsp;not&nbsp;loop</span><br>
<span class="lineno"></span><span class="op" id="8539229">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="keyword" id="8539232">func</span>&nbsp;<span class="ident" id="8539237">TestMalformedOutput</span><span class="op" id="8539256">(</span><span class="ident" id="8539257">t</span>&nbsp;<span class="op" id="8539259">*</span><span class="ident" id="8539260"><a href="/net/rpc/jsonrpc/all_test.go.html#8535221">testing</a></span><span class="op" id="8539267">.</span><span class="ident" id="8539268">T</span><span class="op" id="8539269">)</span>&nbsp;<span class="op" id="8539271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539274">cli</span><span class="op" id="8539277">,</span>&nbsp;<span class="ident" id="8539279">srv</span>&nbsp;<span class="op" id="8539283">:=</span>&nbsp;<span class="ident" id="8539286"><a href="/net/rpc/jsonrpc/all_test.go.html#8535192">net</a></span><span class="op" id="8539289">.</span><span class="ident" id="8539290">Pipe</span><span class="op" id="8539294">(</span><span class="op" id="8539295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8539298">go</span>&nbsp;<span class="ident" id="8539301"><a href="/net/rpc/jsonrpc/all_test.go.html#8539279">srv</a></span><span class="op" id="8539304">.</span><span class="ident" id="8539305">Write</span><span class="op" id="8539310">(</span><span class="op" id="8539311">[</span><span class="op" id="8539312">]</span><span class="builtintype" id="8539313">byte</span><span class="op" id="8539317">(</span><span class="string" id="8539318">`{&#34;id&#34;:0,&#34;result&#34;:null,&#34;error&#34;:null}`</span><span class="op" id="8539355">)</span><span class="op" id="8539356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8539359">go</span>&nbsp;<span class="ident" id="8539362"><a href="/net/rpc/jsonrpc/all_test.go.html#8535179">ioutil</a></span><span class="op" id="8539368">.</span><span class="ident" id="8539369">ReadAll</span><span class="op" id="8539376">(</span><span class="ident" id="8539377"><a href="/net/rpc/jsonrpc/all_test.go.html#8539279">srv</a></span><span class="op" id="8539380">)</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539384">client</span>&nbsp;<span class="op" id="8539391">:=</span>&nbsp;<span class="ident" id="8539394"><a href="/net/rpc/jsonrpc/client.go.html#6276644">NewClient</a></span><span class="op" id="8539403">(</span><span class="ident" id="8539404"><a href="/net/rpc/jsonrpc/all_test.go.html#8539274">cli</a></span><span class="op" id="8539407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8539410">defer</span>&nbsp;<span class="ident" id="8539416"><a href="/net/rpc/jsonrpc/all_test.go.html#8539384">client</a></span><span class="op" id="8539422">.</span><span class="ident" id="8539423">Close</span><span class="op" id="8539428">(</span><span class="op" id="8539429">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539433">args</span>&nbsp;<span class="op" id="8539438">:=</span>&nbsp;<span class="op" id="8539441">&amp;</span><span class="ident" id="8539442"><a href="/net/rpc/jsonrpc/all_test.go.html#8535239">Args</a></span><span class="op" id="8539446">{</span><span class="num" id="8539447">7</span><span class="op" id="8539448">,</span>&nbsp;<span class="num" id="8539450">8</span><span class="op" id="8539451">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539454">reply</span>&nbsp;<span class="op" id="8539460">:=</span>&nbsp;<span class="builtinfunc" id="8539463">new</span><span class="op" id="8539466">(</span><span class="ident" id="8539467"><a href="/net/rpc/jsonrpc/all_test.go.html#8535271">Reply</a></span><span class="op" id="8539472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539475">err</span>&nbsp;<span class="op" id="8539479">:=</span>&nbsp;<span class="ident" id="8539482"><a href="/net/rpc/jsonrpc/all_test.go.html#8539384">client</a></span><span class="op" id="8539488">.</span><span class="ident" id="8539489">Call</span><span class="op" id="8539493">(</span><span class="string" id="8539494">&#34;Arith.Add&#34;</span><span class="op" id="8539505">,</span>&nbsp;<span class="ident" id="8539507"><a href="/net/rpc/jsonrpc/all_test.go.html#8539433">args</a></span><span class="op" id="8539511">,</span>&nbsp;<span class="ident" id="8539513"><a href="/net/rpc/jsonrpc/all_test.go.html#8539454">reply</a></span><span class="op" id="8539518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8539521">if</span>&nbsp;<span class="ident" id="8539524"><a href="/net/rpc/jsonrpc/all_test.go.html#8539475">err</a></span>&nbsp;<span class="op" id="8539528">==</span>&nbsp;<span class="ident" id="8539531">nil</span>&nbsp;<span class="op" id="8539535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539539"><a href="/net/rpc/jsonrpc/all_test.go.html#8539257">t</a></span><span class="op" id="8539540">.</span><span class="ident" id="8539541">Error</span><span class="op" id="8539546">(</span><span class="string" id="8539547">&#34;expected&nbsp;error&#34;</span><span class="op" id="8539563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8539566">}</span><br>
<span class="lineno">205</span><span class="op" id="8539568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8539571">func</span>&nbsp;<span class="ident" id="8539576">TestServerErrorHasNullResult</span><span class="op" id="8539604">(</span><span class="ident" id="8539605">t</span>&nbsp;<span class="op" id="8539607">*</span><span class="ident" id="8539608"><a href="/net/rpc/jsonrpc/all_test.go.html#8535221">testing</a></span><span class="op" id="8539615">.</span><span class="ident" id="8539616">T</span><span class="op" id="8539617">)</span>&nbsp;<span class="op" id="8539619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8539622">var</span>&nbsp;<span class="ident" id="8539626">out</span>&nbsp;<span class="ident" id="8539630"><a href="/net/rpc/jsonrpc/all_test.go.html#8535130">bytes</a></span><span class="op" id="8539635">.</span><span class="ident" id="8539636">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539644">sc</span>&nbsp;<span class="op" id="8539647">:=</span>&nbsp;<span class="ident" id="8539650"><a href="/net/rpc/jsonrpc/server.go.html#6277994">NewServerCodec</a></span><span class="op" id="8539664">(</span><span class="keyword" id="8539665">struct</span>&nbsp;<span class="op" id="8539672">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539676"><a href="/net/rpc/jsonrpc/all_test.go.html#8535173">io</a></span><span class="op" id="8539678">.</span><span class="ident" id="8539679">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539688"><a href="/net/rpc/jsonrpc/all_test.go.html#8535173">io</a></span><span class="op" id="8539690">.</span><span class="ident" id="8539691">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539700"><a href="/net/rpc/jsonrpc/all_test.go.html#8535173">io</a></span><span class="op" id="8539702">.</span><span class="ident" id="8539703">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8539711">}</span><span class="op" id="8539712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539716">Reader</span><span class="op" id="8539722">:</span>&nbsp;<span class="ident" id="8539724"><a href="/net/rpc/jsonrpc/all_test.go.html#8535210">strings</a></span><span class="op" id="8539731">.</span><span class="ident" id="8539732">NewReader</span><span class="op" id="8539741">(</span><span class="string" id="8539742">`{&#34;method&#34;:&nbsp;&#34;Arith.Add&#34;,&nbsp;&#34;id&#34;:&nbsp;&#34;123&#34;,&nbsp;&#34;params&#34;:&nbsp;[]}`</span><span class="op" id="8539794">)</span><span class="op" id="8539795">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539799">Writer</span><span class="op" id="8539805">:</span>&nbsp;<span class="op" id="8539807">&amp;</span><span class="ident" id="8539808"><a href="/net/rpc/jsonrpc/all_test.go.html#8539626">out</a></span><span class="op" id="8539811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539815">Closer</span><span class="op" id="8539821">:</span>&nbsp;<span class="ident" id="8539823"><a href="/net/rpc/jsonrpc/all_test.go.html#8535179">ioutil</a></span><span class="op" id="8539829">.</span><span class="ident" id="8539830">NopCloser</span><span class="op" id="8539839">(</span><span class="ident" id="8539840">nil</span><span class="op" id="8539843">)</span><span class="op" id="8539844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8539847">}</span><span class="op" id="8539848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539851">r</span>&nbsp;<span class="op" id="8539853">:=</span>&nbsp;<span class="builtinfunc" id="8539856">new</span><span class="op" id="8539859">(</span><span class="ident" id="8539860"><a href="/net/rpc/jsonrpc/all_test.go.html#8535199">rpc</a></span><span class="op" id="8539863">.</span><span class="ident" id="8539864">Request</span><span class="op" id="8539871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8539874">if</span>&nbsp;<span class="ident" id="8539877">err</span>&nbsp;<span class="op" id="8539881">:=</span>&nbsp;<span class="ident" id="8539884"><a href="/net/rpc/jsonrpc/all_test.go.html#8539644">sc</a></span><span class="op" id="8539886">.</span><span class="ident" id="8539887">ReadRequestHeader</span><span class="op" id="8539904">(</span><span class="ident" id="8539905"><a href="/net/rpc/jsonrpc/all_test.go.html#8539851">r</a></span><span class="op" id="8539906">)</span><span class="op" id="8539907">;</span>&nbsp;<span class="ident" id="8539909"><a href="/net/rpc/jsonrpc/all_test.go.html#8539877">err</a></span>&nbsp;<span class="op" id="8539913">!=</span>&nbsp;<span class="ident" id="8539916">nil</span>&nbsp;<span class="op" id="8539920">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539924"><a href="/net/rpc/jsonrpc/all_test.go.html#8539605">t</a></span><span class="op" id="8539925">.</span><span class="ident" id="8539926">Fatal</span><span class="op" id="8539931">(</span><span class="ident" id="8539932"><a href="/net/rpc/jsonrpc/all_test.go.html#8539877">err</a></span><span class="op" id="8539935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8539938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8539941">const</span>&nbsp;<span class="ident" id="8539947">valueText</span>&nbsp;<span class="op" id="8539957">=</span>&nbsp;<span class="string" id="8539959">&#34;the&nbsp;value&nbsp;we&nbsp;don&#39;t&nbsp;want&nbsp;to&nbsp;see&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8539993">const</span>&nbsp;<span class="ident" id="8539999">errorText</span>&nbsp;<span class="op" id="8540009">=</span>&nbsp;<span class="string" id="8540011">&#34;some&nbsp;error&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540025">err</span>&nbsp;<span class="op" id="8540029">:=</span>&nbsp;<span class="ident" id="8540032"><a href="/net/rpc/jsonrpc/all_test.go.html#8539644">sc</a></span><span class="op" id="8540034">.</span><span class="ident" id="8540035">WriteResponse</span><span class="op" id="8540048">(</span><span class="op" id="8540049">&amp;</span><span class="ident" id="8540050"><a href="/net/rpc/jsonrpc/all_test.go.html#8535199">rpc</a></span><span class="op" id="8540053">.</span><span class="ident" id="8540054">Response</span><span class="op" id="8540062">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540066">ServiceMethod</span><span class="op" id="8540079">:</span>&nbsp;<span class="string" id="8540081">&#34;Method&#34;</span><span class="op" id="8540089">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540093">Seq</span><span class="op" id="8540096">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8540108">1</span><span class="op" id="8540109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540113">Error</span><span class="op" id="8540118">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540128"><a href="/net/rpc/jsonrpc/all_test.go.html#8539999">errorText</a></span><span class="op" id="8540137">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8540140">}</span><span class="op" id="8540141">,</span>&nbsp;<span class="ident" id="8540143"><a href="/net/rpc/jsonrpc/all_test.go.html#8539947">valueText</a></span><span class="op" id="8540152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8540155">if</span>&nbsp;<span class="ident" id="8540158"><a href="/net/rpc/jsonrpc/all_test.go.html#8540025">err</a></span>&nbsp;<span class="op" id="8540162">!=</span>&nbsp;<span class="ident" id="8540165">nil</span>&nbsp;<span class="op" id="8540169">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540173"><a href="/net/rpc/jsonrpc/all_test.go.html#8539605">t</a></span><span class="op" id="8540174">.</span><span class="ident" id="8540175">Fatal</span><span class="op" id="8540180">(</span><span class="ident" id="8540181"><a href="/net/rpc/jsonrpc/all_test.go.html#8540025">err</a></span><span class="op" id="8540184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8540187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8540190">if</span>&nbsp;<span class="op" id="8540193">!</span><span class="ident" id="8540194"><a href="/net/rpc/jsonrpc/all_test.go.html#8535210">strings</a></span><span class="op" id="8540201">.</span><span class="ident" id="8540202">Contains</span><span class="op" id="8540210">(</span><span class="ident" id="8540211"><a href="/net/rpc/jsonrpc/all_test.go.html#8539626">out</a></span><span class="op" id="8540214">.</span><span class="ident" id="8540215">String</span><span class="op" id="8540221">(</span><span class="op" id="8540222">)</span><span class="op" id="8540223">,</span>&nbsp;<span class="ident" id="8540225"><a href="/net/rpc/jsonrpc/all_test.go.html#8539999">errorText</a></span><span class="op" id="8540234">)</span>&nbsp;<span class="op" id="8540236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540240"><a href="/net/rpc/jsonrpc/all_test.go.html#8539605">t</a></span><span class="op" id="8540241">.</span><span class="ident" id="8540242">Fatalf</span><span class="op" id="8540248">(</span><span class="string" id="8540249">&#34;Response&nbsp;didn&#39;t&nbsp;contain&nbsp;expected&nbsp;error&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="8540296">,</span>&nbsp;<span class="ident" id="8540298"><a href="/net/rpc/jsonrpc/all_test.go.html#8539999">errorText</a></span><span class="op" id="8540307">,</span>&nbsp;<span class="op" id="8540309">&amp;</span><span class="ident" id="8540310"><a href="/net/rpc/jsonrpc/all_test.go.html#8539626">out</a></span><span class="op" id="8540313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8540316">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8540319">if</span>&nbsp;<span class="ident" id="8540322"><a href="/net/rpc/jsonrpc/all_test.go.html#8535210">strings</a></span><span class="op" id="8540329">.</span><span class="ident" id="8540330">Contains</span><span class="op" id="8540338">(</span><span class="ident" id="8540339"><a href="/net/rpc/jsonrpc/all_test.go.html#8539626">out</a></span><span class="op" id="8540342">.</span><span class="ident" id="8540343">String</span><span class="op" id="8540349">(</span><span class="op" id="8540350">)</span><span class="op" id="8540351">,</span>&nbsp;<span class="ident" id="8540353"><a href="/net/rpc/jsonrpc/all_test.go.html#8539947">valueText</a></span><span class="op" id="8540362">)</span>&nbsp;<span class="op" id="8540364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540368"><a href="/net/rpc/jsonrpc/all_test.go.html#8539605">t</a></span><span class="op" id="8540369">.</span><span class="ident" id="8540370">Errorf</span><span class="op" id="8540376">(</span><span class="string" id="8540377">&#34;Response&nbsp;contains&nbsp;both&nbsp;an&nbsp;error&nbsp;and&nbsp;value:&nbsp;%s&#34;</span><span class="op" id="8540424">,</span>&nbsp;<span class="op" id="8540426">&amp;</span><span class="ident" id="8540427"><a href="/net/rpc/jsonrpc/all_test.go.html#8539626">out</a></span><span class="op" id="8540430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8540433">}</span><br>
<span class="lineno"></span><span class="op" id="8540435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="8540438">func</span>&nbsp;<span class="ident" id="8540443">TestUnexpectedError</span><span class="op" id="8540462">(</span><span class="ident" id="8540463">t</span>&nbsp;<span class="op" id="8540465">*</span><span class="ident" id="8540466"><a href="/net/rpc/jsonrpc/all_test.go.html#8535221">testing</a></span><span class="op" id="8540473">.</span><span class="ident" id="8540474">T</span><span class="op" id="8540475">)</span>&nbsp;<span class="op" id="8540477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540480">cli</span><span class="op" id="8540483">,</span>&nbsp;<span class="ident" id="8540485">srv</span>&nbsp;<span class="op" id="8540489">:=</span>&nbsp;<span class="ident" id="8540492"><a href="/net/rpc/jsonrpc/all_test.go.html#8540726">myPipe</a></span><span class="op" id="8540498">(</span><span class="op" id="8540499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8540502">go</span>&nbsp;<span class="ident" id="8540505"><a href="/net/rpc/jsonrpc/all_test.go.html#8540480">cli</a></span><span class="op" id="8540508">.</span><span class="ident" id="8540509">PipeWriter</span><span class="op" id="8540519">.</span><span class="ident" id="8540520">CloseWithError</span><span class="op" id="8540534">(</span><span class="ident" id="8540535"><a href="/net/rpc/jsonrpc/all_test.go.html#8535156">errors</a></span><span class="op" id="8540541">.</span><span class="ident" id="8540542">New</span><span class="op" id="8540545">(</span><span class="string" id="8540546">&#34;unexpected&nbsp;error!&#34;</span><span class="op" id="8540565">)</span><span class="op" id="8540566">)</span>&nbsp;<span class="comment" id="8540568">//&nbsp;reader&nbsp;will&nbsp;get&nbsp;this&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540599"><a href="/net/rpc/jsonrpc/server.go.html#6280188">ServeConn</a></span><span class="op" id="8540608">(</span><span class="ident" id="8540609"><a href="/net/rpc/jsonrpc/all_test.go.html#8540485">srv</a></span><span class="op" id="8540612">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8540665">//&nbsp;must&nbsp;return,&nbsp;not&nbsp;loop</span><br>
<span class="lineno"></span><span class="op" id="8540690">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="comment" id="8540693">//&nbsp;Copied&nbsp;from&nbsp;package&nbsp;net.</span><br>
<span class="lineno"></span><span class="keyword" id="8540721">func</span>&nbsp;<span class="ident" id="8540726">myPipe</span><span class="op" id="8540732">(</span><span class="op" id="8540733">)</span>&nbsp;<span class="op" id="8540735">(</span><span class="op" id="8540736">*</span><span class="ident" id="8540737"><a href="/net/rpc/jsonrpc/all_test.go.html#8540840">pipe</a></span><span class="op" id="8540741">,</span>&nbsp;<span class="op" id="8540743">*</span><span class="ident" id="8540744"><a href="/net/rpc/jsonrpc/all_test.go.html#8540840">pipe</a></span><span class="op" id="8540748">)</span>&nbsp;<span class="op" id="8540750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540753">r1</span><span class="op" id="8540755">,</span>&nbsp;<span class="ident" id="8540757">w1</span>&nbsp;<span class="op" id="8540760">:=</span>&nbsp;<span class="ident" id="8540763"><a href="/net/rpc/jsonrpc/all_test.go.html#8535173">io</a></span><span class="op" id="8540765">.</span><span class="ident" id="8540766">Pipe</span><span class="op" id="8540770">(</span><span class="op" id="8540771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540774">r2</span><span class="op" id="8540776">,</span>&nbsp;<span class="ident" id="8540778">w2</span>&nbsp;<span class="op" id="8540781">:=</span>&nbsp;<span class="ident" id="8540784"><a href="/net/rpc/jsonrpc/all_test.go.html#8535173">io</a></span><span class="op" id="8540786">.</span><span class="ident" id="8540787">Pipe</span><span class="op" id="8540791">(</span><span class="op" id="8540792">)</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8540796">return</span>&nbsp;<span class="op" id="8540803">&amp;</span><span class="ident" id="8540804"><a href="/net/rpc/jsonrpc/all_test.go.html#8540840">pipe</a></span><span class="op" id="8540808">{</span><span class="ident" id="8540809"><a href="/net/rpc/jsonrpc/all_test.go.html#8540753">r1</a></span><span class="op" id="8540811">,</span>&nbsp;<span class="ident" id="8540813"><a href="/net/rpc/jsonrpc/all_test.go.html#8540778">w2</a></span><span class="op" id="8540815">}</span><span class="op" id="8540816">,</span>&nbsp;<span class="op" id="8540818">&amp;</span><span class="ident" id="8540819"><a href="/net/rpc/jsonrpc/all_test.go.html#8540840">pipe</a></span><span class="op" id="8540823">{</span><span class="ident" id="8540824"><a href="/net/rpc/jsonrpc/all_test.go.html#8540774">r2</a></span><span class="op" id="8540826">,</span>&nbsp;<span class="ident" id="8540828"><a href="/net/rpc/jsonrpc/all_test.go.html#8540757">w1</a></span><span class="op" id="8540830">}</span><br>
<span class="lineno"></span><span class="op" id="8540832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8540835">type</span>&nbsp;<span class="ident" id="8540840">pipe</span>&nbsp;<span class="keyword" id="8540845">struct</span>&nbsp;<span class="op" id="8540852">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8540855">*</span><span class="ident" id="8540856"><a href="/net/rpc/jsonrpc/all_test.go.html#8535173">io</a></span><span class="op" id="8540858">.</span><span class="ident" id="8540859">PipeReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8540871">*</span><span class="ident" id="8540872"><a href="/net/rpc/jsonrpc/all_test.go.html#8535173">io</a></span><span class="op" id="8540874">.</span><span class="ident" id="8540875">PipeWriter</span><br>
<span class="lineno"></span><span class="op" id="8540886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8540889">type</span>&nbsp;<span class="ident" id="8540894">pipeAddr</span>&nbsp;<span class="builtintype" id="8540903">int</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="8540908">func</span>&nbsp;<span class="op" id="8540913">(</span><span class="ident" id="8540914"><a href="/net/rpc/jsonrpc/all_test.go.html#8540894">pipeAddr</a></span><span class="op" id="8540922">)</span>&nbsp;<span class="ident" id="8540924">Network</span><span class="op" id="8540931">(</span><span class="op" id="8540932">)</span>&nbsp;<span class="builtintype" id="8540934">string</span>&nbsp;<span class="op" id="8540941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8540944">return</span>&nbsp;<span class="string" id="8540951">&#34;pipe&#34;</span><br>
<span class="lineno"></span><span class="op" id="8540958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="8540961">func</span>&nbsp;<span class="op" id="8540966">(</span><span class="ident" id="8540967"><a href="/net/rpc/jsonrpc/all_test.go.html#8540894">pipeAddr</a></span><span class="op" id="8540975">)</span>&nbsp;<span class="ident" id="8540977">String</span><span class="op" id="8540983">(</span><span class="op" id="8540984">)</span>&nbsp;<span class="builtintype" id="8540986">string</span>&nbsp;<span class="op" id="8540993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8540996">return</span>&nbsp;<span class="string" id="8541003">&#34;pipe&#34;</span><br>
<span class="lineno"></span><span class="op" id="8541010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8541013">func</span>&nbsp;<span class="op" id="8541018">(</span><span class="ident" id="8541019">p</span>&nbsp;<span class="op" id="8541021">*</span><span class="ident" id="8541022"><a href="/net/rpc/jsonrpc/all_test.go.html#8540840">pipe</a></span><span class="op" id="8541026">)</span>&nbsp;<span class="ident" id="8541028">Close</span><span class="op" id="8541033">(</span><span class="op" id="8541034">)</span>&nbsp;<span class="builtintype" id="8541036">error</span>&nbsp;<span class="op" id="8541042">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8541045">err</span>&nbsp;<span class="op" id="8541049">:=</span>&nbsp;<span class="ident" id="8541052"><a href="/net/rpc/jsonrpc/all_test.go.html#8541019">p</a></span><span class="op" id="8541053">.</span><span class="ident" id="8541054">PipeReader</span><span class="op" id="8541064">.</span><span class="ident" id="8541065">Close</span><span class="op" id="8541070">(</span><span class="op" id="8541071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8541074">err1</span>&nbsp;<span class="op" id="8541079">:=</span>&nbsp;<span class="ident" id="8541082"><a href="/net/rpc/jsonrpc/all_test.go.html#8541019">p</a></span><span class="op" id="8541083">.</span><span class="ident" id="8541084">PipeWriter</span><span class="op" id="8541094">.</span><span class="ident" id="8541095">Close</span><span class="op" id="8541100">(</span><span class="op" id="8541101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8541104">if</span>&nbsp;<span class="ident" id="8541107"><a href="/net/rpc/jsonrpc/all_test.go.html#8541045">err</a></span>&nbsp;<span class="op" id="8541111">==</span>&nbsp;<span class="ident" id="8541114">nil</span>&nbsp;<span class="op" id="8541118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8541122"><a href="/net/rpc/jsonrpc/all_test.go.html#8541045">err</a></span>&nbsp;<span class="op" id="8541126">=</span>&nbsp;<span class="ident" id="8541128"><a href="/net/rpc/jsonrpc/all_test.go.html#8541074">err1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8541134">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8541137">return</span>&nbsp;<span class="ident" id="8541144"><a href="/net/rpc/jsonrpc/all_test.go.html#8541045">err</a></span><br>
<span class="lineno"></span><span class="op" id="8541148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8541151">func</span>&nbsp;<span class="op" id="8541156">(</span><span class="ident" id="8541157">p</span>&nbsp;<span class="op" id="8541159">*</span><span class="ident" id="8541160"><a href="/net/rpc/jsonrpc/all_test.go.html#8540840">pipe</a></span><span class="op" id="8541164">)</span>&nbsp;<span class="ident" id="8541166">LocalAddr</span><span class="op" id="8541175">(</span><span class="op" id="8541176">)</span>&nbsp;<span class="ident" id="8541178"><a href="/net/rpc/jsonrpc/all_test.go.html#8535192">net</a></span><span class="op" id="8541181">.</span><span class="ident" id="8541182">Addr</span>&nbsp;<span class="op" id="8541187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8541190">return</span>&nbsp;<span class="ident" id="8541197"><a href="/net/rpc/jsonrpc/all_test.go.html#8540894">pipeAddr</a></span><span class="op" id="8541205">(</span><span class="num" id="8541206">0</span><span class="op" id="8541207">)</span><br>
<span class="lineno">280</span><span class="op" id="8541209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8541212">func</span>&nbsp;<span class="op" id="8541217">(</span><span class="ident" id="8541218">p</span>&nbsp;<span class="op" id="8541220">*</span><span class="ident" id="8541221"><a href="/net/rpc/jsonrpc/all_test.go.html#8540840">pipe</a></span><span class="op" id="8541225">)</span>&nbsp;<span class="ident" id="8541227">RemoteAddr</span><span class="op" id="8541237">(</span><span class="op" id="8541238">)</span>&nbsp;<span class="ident" id="8541240"><a href="/net/rpc/jsonrpc/all_test.go.html#8535192">net</a></span><span class="op" id="8541243">.</span><span class="ident" id="8541244">Addr</span>&nbsp;<span class="op" id="8541249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8541252">return</span>&nbsp;<span class="ident" id="8541259"><a href="/net/rpc/jsonrpc/all_test.go.html#8540894">pipeAddr</a></span><span class="op" id="8541267">(</span><span class="num" id="8541268">0</span><span class="op" id="8541269">)</span><br>
<span class="lineno"></span><span class="op" id="8541271">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="keyword" id="8541274">func</span>&nbsp;<span class="op" id="8541279">(</span><span class="ident" id="8541280">p</span>&nbsp;<span class="op" id="8541282">*</span><span class="ident" id="8541283"><a href="/net/rpc/jsonrpc/all_test.go.html#8540840">pipe</a></span><span class="op" id="8541287">)</span>&nbsp;<span class="ident" id="8541289">SetTimeout</span><span class="op" id="8541299">(</span><span class="ident" id="8541300">nsec</span>&nbsp;<span class="ident" id="8541305">int64</span><span class="op" id="8541310">)</span>&nbsp;<span class="builtintype" id="8541312">error</span>&nbsp;<span class="op" id="8541318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8541321">return</span>&nbsp;<span class="ident" id="8541328"><a href="/net/rpc/jsonrpc/all_test.go.html#8535156">errors</a></span><span class="op" id="8541334">.</span><span class="ident" id="8541335">New</span><span class="op" id="8541338">(</span><span class="string" id="8541339">&#34;net.Pipe&nbsp;does&nbsp;not&nbsp;support&nbsp;timeouts&#34;</span><span class="op" id="8541375">)</span><br>
<span class="lineno"></span><span class="op" id="8541377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="keyword" id="8541380">func</span>&nbsp;<span class="op" id="8541385">(</span><span class="ident" id="8541386">p</span>&nbsp;<span class="op" id="8541388">*</span><span class="ident" id="8541389"><a href="/net/rpc/jsonrpc/all_test.go.html#8540840">pipe</a></span><span class="op" id="8541393">)</span>&nbsp;<span class="ident" id="8541395">SetReadTimeout</span><span class="op" id="8541409">(</span><span class="ident" id="8541410">nsec</span>&nbsp;<span class="ident" id="8541415">int64</span><span class="op" id="8541420">)</span>&nbsp;<span class="builtintype" id="8541422">error</span>&nbsp;<span class="op" id="8541428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8541431">return</span>&nbsp;<span class="ident" id="8541438"><a href="/net/rpc/jsonrpc/all_test.go.html#8535156">errors</a></span><span class="op" id="8541444">.</span><span class="ident" id="8541445">New</span><span class="op" id="8541448">(</span><span class="string" id="8541449">&#34;net.Pipe&nbsp;does&nbsp;not&nbsp;support&nbsp;timeouts&#34;</span><span class="op" id="8541485">)</span><br>
<span class="lineno"></span><span class="op" id="8541487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8541490">func</span>&nbsp;<span class="op" id="8541495">(</span><span class="ident" id="8541496">p</span>&nbsp;<span class="op" id="8541498">*</span><span class="ident" id="8541499"><a href="/net/rpc/jsonrpc/all_test.go.html#8540840">pipe</a></span><span class="op" id="8541503">)</span>&nbsp;<span class="ident" id="8541505">SetWriteTimeout</span><span class="op" id="8541520">(</span><span class="ident" id="8541521">nsec</span>&nbsp;<span class="ident" id="8541526">int64</span><span class="op" id="8541531">)</span>&nbsp;<span class="builtintype" id="8541533">error</span>&nbsp;<span class="op" id="8541539">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8541542">return</span>&nbsp;<span class="ident" id="8541549"><a href="/net/rpc/jsonrpc/all_test.go.html#8535156">errors</a></span><span class="op" id="8541555">.</span><span class="ident" id="8541556">New</span><span class="op" id="8541559">(</span><span class="string" id="8541560">&#34;net.Pipe&nbsp;does&nbsp;not&nbsp;support&nbsp;timeouts&#34;</span><span class="op" id="8541596">)</span><br>
<span class="lineno"></span><span class="op" id="8541598">}</span>
</div>
</body>
</html>
