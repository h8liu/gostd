<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html" class="current">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7442606">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7442661">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7442715">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7442766">package</span>&nbsp;<span class="ident" id="7442774">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7442780">import</span>&nbsp;<span class="op" id="7442787">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7442790">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7442801">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="7442811">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7442814">func</span>&nbsp;<span class="ident" id="7442819">TestConsumeToken</span><span class="op" id="7442835">(</span><span class="ident" id="7442836">t</span>&nbsp;<span class="op" id="7442838">*</span><span class="ident" id="7442839">testing</span><span class="op" id="7442846">.</span><span class="ident" id="7442847">T</span><span class="op" id="7442848">)</span>&nbsp;<span class="op" id="7442850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7442853">tests</span>&nbsp;<span class="op" id="7442859">:=</span>&nbsp;<span class="op" id="7442862">[</span><span class="op" id="7442863">...</span><span class="op" id="7442866">]</span><span class="op" id="7442867">[</span><span class="num" id="7442868">3</span><span class="op" id="7442869">]</span><span class="builtintype" id="7442870">string</span><span class="op" id="7442876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7442880">{</span><span class="string" id="7442881">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7442890">,</span>&nbsp;<span class="string" id="7442892">&#34;foo&#34;</span><span class="op" id="7442897">,</span>&nbsp;<span class="string" id="7442899">&#34;&nbsp;bar&#34;</span><span class="op" id="7442905">}</span><span class="op" id="7442906">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7442910">{</span><span class="string" id="7442911">&#34;bar&#34;</span><span class="op" id="7442916">,</span>&nbsp;<span class="string" id="7442918">&#34;bar&#34;</span><span class="op" id="7442923">,</span>&nbsp;<span class="string" id="7442925">&#34;&#34;</span><span class="op" id="7442927">}</span><span class="op" id="7442928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7442932">{</span><span class="string" id="7442933">&#34;&#34;</span><span class="op" id="7442935">,</span>&nbsp;<span class="string" id="7442937">&#34;&#34;</span><span class="op" id="7442939">,</span>&nbsp;<span class="string" id="7442941">&#34;&#34;</span><span class="op" id="7442943">}</span><span class="op" id="7442944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7442948">{</span><span class="string" id="7442949">&#34;&nbsp;foo&#34;</span><span class="op" id="7442955">,</span>&nbsp;<span class="string" id="7442957">&#34;&#34;</span><span class="op" id="7442959">,</span>&nbsp;<span class="string" id="7442961">&#34;&nbsp;foo&#34;</span><span class="op" id="7442967">}</span><span class="op" id="7442968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7442971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7442974">for</span>&nbsp;<span class="ident" id="7442978">_</span><span class="op" id="7442979">,</span>&nbsp;<span class="ident" id="7442981">test</span>&nbsp;<span class="op" id="7442986">:=</span>&nbsp;<span class="keyword" id="7442989">range</span>&nbsp;<span class="ident" id="7442995">tests</span>&nbsp;<span class="op" id="7443001">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7443005">token</span><span class="op" id="7443010">,</span>&nbsp;<span class="ident" id="7443012">rest</span>&nbsp;<span class="op" id="7443017">:=</span>&nbsp;<span class="ident" id="7443020">consumeToken</span><span class="op" id="7443032">(</span><span class="ident" id="7443033">test</span><span class="op" id="7443037">[</span><span class="num" id="7443038">0</span><span class="op" id="7443039">]</span><span class="op" id="7443040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7443044">expectedToken</span>&nbsp;<span class="op" id="7443058">:=</span>&nbsp;<span class="ident" id="7443061">test</span><span class="op" id="7443065">[</span><span class="num" id="7443066">1</span><span class="op" id="7443067">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7443071">expectedRest</span>&nbsp;<span class="op" id="7443084">:=</span>&nbsp;<span class="ident" id="7443087">test</span><span class="op" id="7443091">[</span><span class="num" id="7443092">2</span><span class="op" id="7443093">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7443097">if</span>&nbsp;<span class="ident" id="7443100">token</span>&nbsp;<span class="op" id="7443106">!=</span>&nbsp;<span class="ident" id="7443109">expectedToken</span>&nbsp;<span class="op" id="7443123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7443128">t</span><span class="op" id="7443129">.</span><span class="ident" id="7443130">Errorf</span><span class="op" id="7443136">(</span><span class="string" id="7443137">&#34;expected&nbsp;to&nbsp;consume&nbsp;token&nbsp;&#39;%s&#39;,&nbsp;not&nbsp;&#39;%s&#39;&nbsp;from&nbsp;&#39;%s&#39;&#34;</span><span class="op" id="7443189">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7443195">expectedToken</span><span class="op" id="7443208">,</span>&nbsp;<span class="ident" id="7443210">token</span><span class="op" id="7443215">,</span>&nbsp;<span class="ident" id="7443217">test</span><span class="op" id="7443221">[</span><span class="num" id="7443222">0</span><span class="op" id="7443223">]</span><span class="op" id="7443224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7443228">}</span>&nbsp;<span class="keyword" id="7443230">else</span>&nbsp;<span class="keyword" id="7443235">if</span>&nbsp;<span class="ident" id="7443238">rest</span>&nbsp;<span class="op" id="7443243">!=</span>&nbsp;<span class="ident" id="7443246">expectedRest</span>&nbsp;<span class="op" id="7443259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7443264">t</span><span class="op" id="7443265">.</span><span class="ident" id="7443266">Errorf</span><span class="op" id="7443272">(</span><span class="string" id="7443273">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;&#39;%s&#39;,&nbsp;not&nbsp;&#39;%s&#39;&nbsp;after&nbsp;reading&nbsp;token&nbsp;&#39;%s&#39;&nbsp;from&nbsp;&#39;%s&#39;&#34;</span><span class="op" id="7443346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7443352">expectedRest</span><span class="op" id="7443364">,</span>&nbsp;<span class="ident" id="7443366">rest</span><span class="op" id="7443370">,</span>&nbsp;<span class="ident" id="7443372">token</span><span class="op" id="7443377">,</span>&nbsp;<span class="ident" id="7443379">test</span><span class="op" id="7443383">[</span><span class="num" id="7443384">0</span><span class="op" id="7443385">]</span><span class="op" id="7443386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7443390">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7443393">}</span><br>
<span class="lineno"></span><span class="op" id="7443395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7443398">func</span>&nbsp;<span class="ident" id="7443403">TestConsumeValue</span><span class="op" id="7443419">(</span><span class="ident" id="7443420">t</span>&nbsp;<span class="op" id="7443422">*</span><span class="ident" id="7443423">testing</span><span class="op" id="7443430">.</span><span class="ident" id="7443431">T</span><span class="op" id="7443432">)</span>&nbsp;<span class="op" id="7443434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7443437">tests</span>&nbsp;<span class="op" id="7443443">:=</span>&nbsp;<span class="op" id="7443446">[</span><span class="op" id="7443447">...</span><span class="op" id="7443450">]</span><span class="op" id="7443451">[</span><span class="num" id="7443452">3</span><span class="op" id="7443453">]</span><span class="builtintype" id="7443454">string</span><span class="op" id="7443460">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7443464">{</span><span class="string" id="7443465">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7443474">,</span>&nbsp;<span class="string" id="7443476">&#34;foo&#34;</span><span class="op" id="7443481">,</span>&nbsp;<span class="string" id="7443483">&#34;&nbsp;bar&#34;</span><span class="op" id="7443489">}</span><span class="op" id="7443490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7443494">{</span><span class="string" id="7443495">&#34;bar&#34;</span><span class="op" id="7443500">,</span>&nbsp;<span class="string" id="7443502">&#34;bar&#34;</span><span class="op" id="7443507">,</span>&nbsp;<span class="string" id="7443509">&#34;&#34;</span><span class="op" id="7443511">}</span><span class="op" id="7443512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7443516">{</span><span class="string" id="7443517">&#34;&nbsp;bar&nbsp;&#34;</span><span class="op" id="7443524">,</span>&nbsp;<span class="string" id="7443526">&#34;&#34;</span><span class="op" id="7443528">,</span>&nbsp;<span class="string" id="7443530">&#34;&nbsp;bar&nbsp;&#34;</span><span class="op" id="7443537">}</span><span class="op" id="7443538">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7443542">{</span><span class="string" id="7443543">`&#34;My&nbsp;value&#34;end`</span><span class="op" id="7443558">,</span>&nbsp;<span class="string" id="7443560">&#34;My&nbsp;value&#34;</span><span class="op" id="7443570">,</span>&nbsp;<span class="string" id="7443572">&#34;end&#34;</span><span class="op" id="7443577">}</span><span class="op" id="7443578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7443582">{</span><span class="string" id="7443583">`&#34;My&nbsp;value&#34;&nbsp;end`</span><span class="op" id="7443599">,</span>&nbsp;<span class="string" id="7443601">&#34;My&nbsp;value&#34;</span><span class="op" id="7443611">,</span>&nbsp;<span class="string" id="7443613">&#34;&nbsp;end&#34;</span><span class="op" id="7443619">}</span><span class="op" id="7443620">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7443624">{</span><span class="string" id="7443625">`&#34;\\&#34;&nbsp;rest`</span><span class="op" id="7443636">,</span>&nbsp;<span class="string" id="7443638">&#34;\\&#34;</span><span class="op" id="7443642">,</span>&nbsp;<span class="string" id="7443644">&#34;&nbsp;rest&#34;</span><span class="op" id="7443651">}</span><span class="op" id="7443652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7443656">{</span><span class="string" id="7443657">`&#34;My&nbsp;\&#34;&nbsp;value&#34;end`</span><span class="op" id="7443675">,</span>&nbsp;<span class="string" id="7443677">&#34;My&nbsp;\&#34;&nbsp;value&#34;</span><span class="op" id="7443690">,</span>&nbsp;<span class="string" id="7443692">&#34;end&#34;</span><span class="op" id="7443697">}</span><span class="op" id="7443698">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7443702">{</span><span class="string" id="7443703">`&#34;\&#34;&nbsp;rest`</span><span class="op" id="7443713">,</span>&nbsp;<span class="string" id="7443715">&#34;&#34;</span><span class="op" id="7443717">,</span>&nbsp;<span class="string" id="7443719">`&#34;\&#34;&nbsp;rest`</span><span class="op" id="7443729">}</span><span class="op" id="7443730">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7443733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7443736">for</span>&nbsp;<span class="ident" id="7443740">_</span><span class="op" id="7443741">,</span>&nbsp;<span class="ident" id="7443743">test</span>&nbsp;<span class="op" id="7443748">:=</span>&nbsp;<span class="keyword" id="7443751">range</span>&nbsp;<span class="ident" id="7443757">tests</span>&nbsp;<span class="op" id="7443763">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7443767">value</span><span class="op" id="7443772">,</span>&nbsp;<span class="ident" id="7443774">rest</span>&nbsp;<span class="op" id="7443779">:=</span>&nbsp;<span class="ident" id="7443782">consumeValue</span><span class="op" id="7443794">(</span><span class="ident" id="7443795">test</span><span class="op" id="7443799">[</span><span class="num" id="7443800">0</span><span class="op" id="7443801">]</span><span class="op" id="7443802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7443806">expectedValue</span>&nbsp;<span class="op" id="7443820">:=</span>&nbsp;<span class="ident" id="7443823">test</span><span class="op" id="7443827">[</span><span class="num" id="7443828">1</span><span class="op" id="7443829">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7443833">expectedRest</span>&nbsp;<span class="op" id="7443846">:=</span>&nbsp;<span class="ident" id="7443849">test</span><span class="op" id="7443853">[</span><span class="num" id="7443854">2</span><span class="op" id="7443855">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7443859">if</span>&nbsp;<span class="ident" id="7443862">value</span>&nbsp;<span class="op" id="7443868">!=</span>&nbsp;<span class="ident" id="7443871">expectedValue</span>&nbsp;<span class="op" id="7443885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7443890">t</span><span class="op" id="7443891">.</span><span class="ident" id="7443892">Errorf</span><span class="op" id="7443898">(</span><span class="string" id="7443899">&#34;expected&nbsp;to&nbsp;consume&nbsp;value&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7443951">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7443957">expectedValue</span><span class="op" id="7443970">,</span>&nbsp;<span class="ident" id="7443972">value</span><span class="op" id="7443977">,</span>&nbsp;<span class="ident" id="7443979">test</span><span class="op" id="7443983">[</span><span class="num" id="7443984">0</span><span class="op" id="7443985">]</span><span class="op" id="7443986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7443990">}</span>&nbsp;<span class="keyword" id="7443992">else</span>&nbsp;<span class="keyword" id="7443997">if</span>&nbsp;<span class="ident" id="7444000">rest</span>&nbsp;<span class="op" id="7444005">!=</span>&nbsp;<span class="ident" id="7444008">expectedRest</span>&nbsp;<span class="op" id="7444021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7444026">t</span><span class="op" id="7444027">.</span><span class="ident" id="7444028">Errorf</span><span class="op" id="7444034">(</span><span class="string" id="7444035">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;after&nbsp;reading&nbsp;value&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7444108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7444114">expectedRest</span><span class="op" id="7444126">,</span>&nbsp;<span class="ident" id="7444128">rest</span><span class="op" id="7444132">,</span>&nbsp;<span class="ident" id="7444134">value</span><span class="op" id="7444139">,</span>&nbsp;<span class="ident" id="7444141">test</span><span class="op" id="7444145">[</span><span class="num" id="7444146">0</span><span class="op" id="7444147">]</span><span class="op" id="7444148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7444152">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7444155">}</span><br>
<span class="lineno"></span><span class="op" id="7444157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7444160">func</span>&nbsp;<span class="ident" id="7444165">TestConsumeMediaParam</span><span class="op" id="7444186">(</span><span class="ident" id="7444187">t</span>&nbsp;<span class="op" id="7444189">*</span><span class="ident" id="7444190">testing</span><span class="op" id="7444197">.</span><span class="ident" id="7444198">T</span><span class="op" id="7444199">)</span>&nbsp;<span class="op" id="7444201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7444204">tests</span>&nbsp;<span class="op" id="7444210">:=</span>&nbsp;<span class="op" id="7444213">[</span><span class="op" id="7444214">...</span><span class="op" id="7444217">]</span><span class="op" id="7444218">[</span><span class="num" id="7444219">4</span><span class="op" id="7444220">]</span><span class="builtintype" id="7444221">string</span><span class="op" id="7444227">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7444231">{</span><span class="string" id="7444232">&#34;&nbsp;;&nbsp;foo=bar&#34;</span><span class="op" id="7444244">,</span>&nbsp;<span class="string" id="7444246">&#34;foo&#34;</span><span class="op" id="7444251">,</span>&nbsp;<span class="string" id="7444253">&#34;bar&#34;</span><span class="op" id="7444258">,</span>&nbsp;<span class="string" id="7444260">&#34;&#34;</span><span class="op" id="7444262">}</span><span class="op" id="7444263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7444267">{</span><span class="string" id="7444268">&#34;;&nbsp;foo=bar&#34;</span><span class="op" id="7444279">,</span>&nbsp;<span class="string" id="7444281">&#34;foo&#34;</span><span class="op" id="7444286">,</span>&nbsp;<span class="string" id="7444288">&#34;bar&#34;</span><span class="op" id="7444293">,</span>&nbsp;<span class="string" id="7444295">&#34;&#34;</span><span class="op" id="7444297">}</span><span class="op" id="7444298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7444302">{</span><span class="string" id="7444303">&#34;;foo=bar&#34;</span><span class="op" id="7444313">,</span>&nbsp;<span class="string" id="7444315">&#34;foo&#34;</span><span class="op" id="7444320">,</span>&nbsp;<span class="string" id="7444322">&#34;bar&#34;</span><span class="op" id="7444327">,</span>&nbsp;<span class="string" id="7444329">&#34;&#34;</span><span class="op" id="7444331">}</span><span class="op" id="7444332">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7444336">{</span><span class="string" id="7444337">&#34;;FOO=bar&#34;</span><span class="op" id="7444347">,</span>&nbsp;<span class="string" id="7444349">&#34;foo&#34;</span><span class="op" id="7444354">,</span>&nbsp;<span class="string" id="7444356">&#34;bar&#34;</span><span class="op" id="7444361">,</span>&nbsp;<span class="string" id="7444363">&#34;&#34;</span><span class="op" id="7444365">}</span><span class="op" id="7444366">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7444370">{</span><span class="string" id="7444371">`;foo=&#34;bar&#34;`</span><span class="op" id="7444383">,</span>&nbsp;<span class="string" id="7444385">&#34;foo&#34;</span><span class="op" id="7444390">,</span>&nbsp;<span class="string" id="7444392">&#34;bar&#34;</span><span class="op" id="7444397">,</span>&nbsp;<span class="string" id="7444399">&#34;&#34;</span><span class="op" id="7444401">}</span><span class="op" id="7444402">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7444406">{</span><span class="string" id="7444407">`;foo=&#34;bar&#34;;&nbsp;`</span><span class="op" id="7444421">,</span>&nbsp;<span class="string" id="7444423">&#34;foo&#34;</span><span class="op" id="7444428">,</span>&nbsp;<span class="string" id="7444430">&#34;bar&#34;</span><span class="op" id="7444435">,</span>&nbsp;<span class="string" id="7444437">&#34;;&nbsp;&#34;</span><span class="op" id="7444441">}</span><span class="op" id="7444442">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7444446">{</span><span class="string" id="7444447">`;foo=&#34;bar&#34;;&nbsp;foo=baz`</span><span class="op" id="7444468">,</span>&nbsp;<span class="string" id="7444470">&#34;foo&#34;</span><span class="op" id="7444475">,</span>&nbsp;<span class="string" id="7444477">&#34;bar&#34;</span><span class="op" id="7444482">,</span>&nbsp;<span class="string" id="7444484">&#34;;&nbsp;foo=baz&#34;</span><span class="op" id="7444495">}</span><span class="op" id="7444496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7444500">{</span><span class="string" id="7444501">`&nbsp;;&nbsp;boundary=----CUT;`</span><span class="op" id="7444523">,</span>&nbsp;<span class="string" id="7444525">&#34;boundary&#34;</span><span class="op" id="7444535">,</span>&nbsp;<span class="string" id="7444537">&#34;----CUT&#34;</span><span class="op" id="7444546">,</span>&nbsp;<span class="string" id="7444548">&#34;;&#34;</span><span class="op" id="7444551">}</span><span class="op" id="7444552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7444556">{</span><span class="string" id="7444557">`&nbsp;;&nbsp;key=value;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7444598">,</span>&nbsp;<span class="string" id="7444600">&#34;key&#34;</span><span class="op" id="7444605">,</span>&nbsp;<span class="string" id="7444607">&#34;value&#34;</span><span class="op" id="7444614">,</span>&nbsp;<span class="string" id="7444616">`;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7444645">}</span><span class="op" id="7444646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7444650">{</span><span class="string" id="7444651">`;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7444680">,</span>&nbsp;<span class="string" id="7444682">&#34;blah&#34;</span><span class="op" id="7444688">,</span>&nbsp;<span class="string" id="7444690">&#34;value&#34;</span><span class="op" id="7444697">,</span>&nbsp;<span class="string" id="7444699">`;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7444713">}</span><span class="op" id="7444714">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7444718">{</span><span class="string" id="7444719">`;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7444733">,</span>&nbsp;<span class="string" id="7444735">&#34;name&#34;</span><span class="op" id="7444741">,</span>&nbsp;<span class="string" id="7444743">&#34;foo&#34;</span><span class="op" id="7444748">,</span>&nbsp;<span class="string" id="7444750">`&nbsp;`</span><span class="op" id="7444753">}</span><span class="op" id="7444754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7444757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7444760">for</span>&nbsp;<span class="ident" id="7444764">_</span><span class="op" id="7444765">,</span>&nbsp;<span class="ident" id="7444767">test</span>&nbsp;<span class="op" id="7444772">:=</span>&nbsp;<span class="keyword" id="7444775">range</span>&nbsp;<span class="ident" id="7444781">tests</span>&nbsp;<span class="op" id="7444787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7444791">param</span><span class="op" id="7444796">,</span>&nbsp;<span class="ident" id="7444798">value</span><span class="op" id="7444803">,</span>&nbsp;<span class="ident" id="7444805">rest</span>&nbsp;<span class="op" id="7444810">:=</span>&nbsp;<span class="ident" id="7444813">consumeMediaParam</span><span class="op" id="7444830">(</span><span class="ident" id="7444831">test</span><span class="op" id="7444835">[</span><span class="num" id="7444836">0</span><span class="op" id="7444837">]</span><span class="op" id="7444838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7444842">expectedParam</span>&nbsp;<span class="op" id="7444856">:=</span>&nbsp;<span class="ident" id="7444859">test</span><span class="op" id="7444863">[</span><span class="num" id="7444864">1</span><span class="op" id="7444865">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7444869">expectedValue</span>&nbsp;<span class="op" id="7444883">:=</span>&nbsp;<span class="ident" id="7444886">test</span><span class="op" id="7444890">[</span><span class="num" id="7444891">2</span><span class="op" id="7444892">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7444896">expectedRest</span>&nbsp;<span class="op" id="7444909">:=</span>&nbsp;<span class="ident" id="7444912">test</span><span class="op" id="7444916">[</span><span class="num" id="7444917">3</span><span class="op" id="7444918">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7444922">if</span>&nbsp;<span class="ident" id="7444925">param</span>&nbsp;<span class="op" id="7444931">!=</span>&nbsp;<span class="ident" id="7444934">expectedParam</span>&nbsp;<span class="op" id="7444948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7444953">t</span><span class="op" id="7444954">.</span><span class="ident" id="7444955">Errorf</span><span class="op" id="7444961">(</span><span class="string" id="7444962">&#34;expected&nbsp;to&nbsp;consume&nbsp;param&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7445014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7445020">expectedParam</span><span class="op" id="7445033">,</span>&nbsp;<span class="ident" id="7445035">param</span><span class="op" id="7445040">,</span>&nbsp;<span class="ident" id="7445042">test</span><span class="op" id="7445046">[</span><span class="num" id="7445047">0</span><span class="op" id="7445048">]</span><span class="op" id="7445049">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7445053">}</span>&nbsp;<span class="keyword" id="7445055">else</span>&nbsp;<span class="keyword" id="7445060">if</span>&nbsp;<span class="ident" id="7445063">value</span>&nbsp;<span class="op" id="7445069">!=</span>&nbsp;<span class="ident" id="7445072">expectedValue</span>&nbsp;<span class="op" id="7445086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7445091">t</span><span class="op" id="7445092">.</span><span class="ident" id="7445093">Errorf</span><span class="op" id="7445099">(</span><span class="string" id="7445100">&#34;expected&nbsp;to&nbsp;consume&nbsp;value&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7445152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7445158">expectedValue</span><span class="op" id="7445171">,</span>&nbsp;<span class="ident" id="7445173">value</span><span class="op" id="7445178">,</span>&nbsp;<span class="ident" id="7445180">test</span><span class="op" id="7445184">[</span><span class="num" id="7445185">0</span><span class="op" id="7445186">]</span><span class="op" id="7445187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7445191">}</span>&nbsp;<span class="keyword" id="7445193">else</span>&nbsp;<span class="keyword" id="7445198">if</span>&nbsp;<span class="ident" id="7445201">rest</span>&nbsp;<span class="op" id="7445206">!=</span>&nbsp;<span class="ident" id="7445209">expectedRest</span>&nbsp;<span class="op" id="7445222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7445227">t</span><span class="op" id="7445228">.</span><span class="ident" id="7445229">Errorf</span><span class="op" id="7445235">(</span><span class="string" id="7445236">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;after&nbsp;reading&nbsp;[%s/%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7445306">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7445312">expectedRest</span><span class="op" id="7445324">,</span>&nbsp;<span class="ident" id="7445326">rest</span><span class="op" id="7445330">,</span>&nbsp;<span class="ident" id="7445332">param</span><span class="op" id="7445337">,</span>&nbsp;<span class="ident" id="7445339">value</span><span class="op" id="7445344">,</span>&nbsp;<span class="ident" id="7445346">test</span><span class="op" id="7445350">[</span><span class="num" id="7445351">0</span><span class="op" id="7445352">]</span><span class="op" id="7445353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7445357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7445360">}</span><br>
<span class="lineno"></span><span class="op" id="7445362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="7445365">type</span>&nbsp;<span class="ident" id="7445370">mediaTypeTest</span>&nbsp;<span class="keyword" id="7445384">struct</span>&nbsp;<span class="op" id="7445391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7445394">in</span>&nbsp;<span class="builtintype" id="7445397">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7445405">t</span>&nbsp;&nbsp;<span class="builtintype" id="7445408">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7445416">p</span>&nbsp;&nbsp;<span class="keyword" id="7445419">map</span><span class="op" id="7445422">[</span><span class="builtintype" id="7445423">string</span><span class="op" id="7445429">]</span><span class="builtintype" id="7445430">string</span><br>
<span class="lineno"></span><span class="op" id="7445437">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="7445440">func</span>&nbsp;<span class="ident" id="7445445">TestParseMediaType</span><span class="op" id="7445463">(</span><span class="ident" id="7445464">t</span>&nbsp;<span class="op" id="7445466">*</span><span class="ident" id="7445467">testing</span><span class="op" id="7445474">.</span><span class="ident" id="7445475">T</span><span class="op" id="7445476">)</span>&nbsp;<span class="op" id="7445478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7445481">//&nbsp;Convenience&nbsp;map&nbsp;initializer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7445513">m</span>&nbsp;<span class="op" id="7445515">:=</span>&nbsp;<span class="keyword" id="7445518">func</span><span class="op" id="7445522">(</span><span class="ident" id="7445523">s</span>&nbsp;<span class="op" id="7445525">...</span><span class="builtintype" id="7445528">string</span><span class="op" id="7445534">)</span>&nbsp;<span class="keyword" id="7445536">map</span><span class="op" id="7445539">[</span><span class="builtintype" id="7445540">string</span><span class="op" id="7445546">]</span><span class="builtintype" id="7445547">string</span>&nbsp;<span class="op" id="7445554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7445558">sm</span>&nbsp;<span class="op" id="7445561">:=</span>&nbsp;<span class="builtinfunc" id="7445564">make</span><span class="op" id="7445568">(</span><span class="keyword" id="7445569">map</span><span class="op" id="7445572">[</span><span class="builtintype" id="7445573">string</span><span class="op" id="7445579">]</span><span class="builtintype" id="7445580">string</span><span class="op" id="7445586">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7445590">for</span>&nbsp;<span class="ident" id="7445594">i</span>&nbsp;<span class="op" id="7445596">:=</span>&nbsp;<span class="num" id="7445599">0</span><span class="op" id="7445600">;</span>&nbsp;<span class="ident" id="7445602">i</span>&nbsp;<span class="op" id="7445604">&lt;</span>&nbsp;<span class="builtinfunc" id="7445606">len</span><span class="op" id="7445609">(</span><span class="ident" id="7445610">s</span><span class="op" id="7445611">)</span><span class="op" id="7445612">;</span>&nbsp;<span class="ident" id="7445614">i</span>&nbsp;<span class="op" id="7445616">+=</span>&nbsp;<span class="num" id="7445619">2</span>&nbsp;<span class="op" id="7445621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7445626">sm</span><span class="op" id="7445628">[</span><span class="ident" id="7445629">s</span><span class="op" id="7445630">[</span><span class="ident" id="7445631">i</span><span class="op" id="7445632">]</span><span class="op" id="7445633">]</span>&nbsp;<span class="op" id="7445635">=</span>&nbsp;<span class="ident" id="7445637">s</span><span class="op" id="7445638">[</span><span class="ident" id="7445639">i</span><span class="op" id="7445640">+</span><span class="num" id="7445641">1</span><span class="op" id="7445642">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7445646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7445650">return</span>&nbsp;<span class="ident" id="7445657">sm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7445661">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7445665">nameFoo</span>&nbsp;<span class="op" id="7445673">:=</span>&nbsp;<span class="keyword" id="7445676">map</span><span class="op" id="7445679">[</span><span class="builtintype" id="7445680">string</span><span class="op" id="7445686">]</span><span class="builtintype" id="7445687">string</span><span class="op" id="7445693">{</span><span class="string" id="7445694">&#34;name&#34;</span><span class="op" id="7445700">:</span>&nbsp;<span class="string" id="7445702">&#34;foo&#34;</span><span class="op" id="7445707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7445710">tests</span>&nbsp;<span class="op" id="7445716">:=</span>&nbsp;<span class="op" id="7445719">[</span><span class="op" id="7445720">]</span><span class="ident" id="7445721">mediaTypeTest</span><span class="op" id="7445734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7445738">{</span><span class="string" id="7445739">`form-data;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="7445762">,</span>&nbsp;<span class="string" id="7445764">&#34;form-data&#34;</span><span class="op" id="7445775">,</span>&nbsp;<span class="ident" id="7445777">nameFoo</span><span class="op" id="7445784">}</span><span class="op" id="7445785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7445789">{</span><span class="string" id="7445790">`&nbsp;form-data&nbsp;;&nbsp;name=foo`</span><span class="op" id="7445813">,</span>&nbsp;<span class="string" id="7445815">&#34;form-data&#34;</span><span class="op" id="7445826">,</span>&nbsp;<span class="ident" id="7445828">nameFoo</span><span class="op" id="7445835">}</span><span class="op" id="7445836">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7445840">{</span><span class="string" id="7445841">`FORM-DATA;name=&#34;foo&#34;`</span><span class="op" id="7445863">,</span>&nbsp;<span class="string" id="7445865">&#34;form-data&#34;</span><span class="op" id="7445876">,</span>&nbsp;<span class="ident" id="7445878">nameFoo</span><span class="op" id="7445885">}</span><span class="op" id="7445886">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7445890">{</span><span class="string" id="7445891">`&nbsp;FORM-DATA&nbsp;;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="7445916">,</span>&nbsp;<span class="string" id="7445918">&#34;form-data&#34;</span><span class="op" id="7445929">,</span>&nbsp;<span class="ident" id="7445931">nameFoo</span><span class="op" id="7445938">}</span><span class="op" id="7445939">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7445943">{</span><span class="string" id="7445944">`&nbsp;FORM-DATA&nbsp;;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="7445969">,</span>&nbsp;<span class="string" id="7445971">&#34;form-data&#34;</span><span class="op" id="7445982">,</span>&nbsp;<span class="ident" id="7445984">nameFoo</span><span class="op" id="7445991">}</span><span class="op" id="7445992">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7445997">{</span><span class="string" id="7445998">`form-data;&nbsp;key=value;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7446047">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7446052">&#34;form-data&#34;</span><span class="op" id="7446063">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7446068">m</span><span class="op" id="7446069">(</span><span class="string" id="7446070">&#34;key&#34;</span><span class="op" id="7446075">,</span>&nbsp;<span class="string" id="7446077">&#34;value&#34;</span><span class="op" id="7446084">,</span>&nbsp;<span class="string" id="7446086">&#34;blah&#34;</span><span class="op" id="7446092">,</span>&nbsp;<span class="string" id="7446094">&#34;value&#34;</span><span class="op" id="7446101">,</span>&nbsp;<span class="string" id="7446103">&#34;name&#34;</span><span class="op" id="7446109">,</span>&nbsp;<span class="string" id="7446111">&#34;foo&#34;</span><span class="op" id="7446116">)</span><span class="op" id="7446117">}</span><span class="op" id="7446118">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7446123">{</span><span class="string" id="7446124">`foo;&nbsp;key=val1;&nbsp;key=the-key-appears-again-which-is-bogus`</span><span class="op" id="7446181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7446186">&#34;&#34;</span><span class="op" id="7446188">,</span>&nbsp;<span class="ident" id="7446190">m</span><span class="op" id="7446191">(</span><span class="op" id="7446192">)</span><span class="op" id="7446193">}</span><span class="op" id="7446194">,</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7446199">//&nbsp;From&nbsp;RFC&nbsp;2231:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7446219">{</span><span class="string" id="7446220">`application/x-stuff;&nbsp;title*=us-ascii&#39;en-us&#39;This%20is%20%2A%2A%2Afun%2A%2A%2A`</span><span class="op" id="7446298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7446303">&#34;application/x-stuff&#34;</span><span class="op" id="7446324">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7446329">m</span><span class="op" id="7446330">(</span><span class="string" id="7446331">&#34;title&#34;</span><span class="op" id="7446338">,</span>&nbsp;<span class="string" id="7446340">&#34;This&nbsp;is&nbsp;***fun***&#34;</span><span class="op" id="7446359">)</span><span class="op" id="7446360">}</span><span class="op" id="7446361">,</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7446366">{</span><span class="string" id="7446367">`message/external-body;&nbsp;access-type=URL;&nbsp;`</span>&nbsp;<span class="op" id="7446410">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7446415">`URL*0=&#34;ftp://&#34;;`</span>&nbsp;<span class="op" id="7446433">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7446438">`URL*1=&#34;cs.utk.edu/pub/moore/bulk-mailer/bulk-mailer.tar&#34;`</span><span class="op" id="7446496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7446501">&#34;message/external-body&#34;</span><span class="op" id="7446524">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7446529">m</span><span class="op" id="7446530">(</span><span class="string" id="7446531">&#34;access-type&#34;</span><span class="op" id="7446544">,</span>&nbsp;<span class="string" id="7446546">&#34;URL&#34;</span><span class="op" id="7446551">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7446557">&#34;url&#34;</span><span class="op" id="7446562">,</span>&nbsp;<span class="string" id="7446564">&#34;ftp://cs.utk.edu/pub/moore/bulk-mailer/bulk-mailer.tar&#34;</span><span class="op" id="7446620">)</span><span class="op" id="7446621">}</span><span class="op" id="7446622">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7446627">{</span><span class="string" id="7446628">`application/x-stuff;&nbsp;`</span>&nbsp;<span class="op" id="7446652">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7446657">`title*0*=us-ascii&#39;en&#39;This%20is%20even%20more%20;&nbsp;`</span>&nbsp;<span class="op" id="7446709">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7446714">`title*1*=%2A%2A%2Afun%2A%2A%2A%20;&nbsp;`</span>&nbsp;<span class="op" id="7446752">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7446757">`title*2=&#34;isn&#39;t&nbsp;it!&#34;`</span><span class="op" id="7446778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7446783">&#34;application/x-stuff&#34;</span><span class="op" id="7446804">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7446809">m</span><span class="op" id="7446810">(</span><span class="string" id="7446811">&#34;title&#34;</span><span class="op" id="7446818">,</span>&nbsp;<span class="string" id="7446820">&#34;This&nbsp;is&nbsp;even&nbsp;more&nbsp;***fun***&nbsp;isn&#39;t&nbsp;it!&#34;</span><span class="op" id="7446859">)</span><span class="op" id="7446860">}</span><span class="op" id="7446861">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7446866">//&nbsp;Tests&nbsp;from&nbsp;http://greenbytes.de/tech/tc2231/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7446916">//&nbsp;TODO(bradfitz):&nbsp;add&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;tests&nbsp;from&nbsp;that&nbsp;site.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7446979">{</span><span class="string" id="7446980">`attachment;&nbsp;filename=&#34;f\oo.html&#34;`</span><span class="op" id="7447014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7447019">&#34;attachment&#34;</span><span class="op" id="7447031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7447036">m</span><span class="op" id="7447037">(</span><span class="string" id="7447038">&#34;filename&#34;</span><span class="op" id="7447048">,</span>&nbsp;<span class="string" id="7447050">&#34;foo.html&#34;</span><span class="op" id="7447060">)</span><span class="op" id="7447061">}</span><span class="op" id="7447062">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7447066">{</span><span class="string" id="7447067">`attachment;&nbsp;filename=&#34;\&#34;quoting\&#34;&nbsp;tested.html&#34;`</span><span class="op" id="7447115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7447120">&#34;attachment&#34;</span><span class="op" id="7447132">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7447137">m</span><span class="op" id="7447138">(</span><span class="string" id="7447139">&#34;filename&#34;</span><span class="op" id="7447149">,</span>&nbsp;<span class="string" id="7447151">`&#34;quoting&#34;&nbsp;tested.html`</span><span class="op" id="7447174">)</span><span class="op" id="7447175">}</span><span class="op" id="7447176">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7447180">{</span><span class="string" id="7447181">`attachment;&nbsp;filename=&#34;Here&#39;s&nbsp;a&nbsp;semicolon;.html&#34;`</span><span class="op" id="7447230">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7447235">&#34;attachment&#34;</span><span class="op" id="7447247">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7447252">m</span><span class="op" id="7447253">(</span><span class="string" id="7447254">&#34;filename&#34;</span><span class="op" id="7447264">,</span>&nbsp;<span class="string" id="7447266">&#34;Here&#39;s&nbsp;a&nbsp;semicolon;.html&#34;</span><span class="op" id="7447292">)</span><span class="op" id="7447293">}</span><span class="op" id="7447294">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7447298">{</span><span class="string" id="7447299">`attachment;&nbsp;foo=&#34;\&#34;\\&#34;;filename=&#34;foo.html&#34;`</span><span class="op" id="7447343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7447348">&#34;attachment&#34;</span><span class="op" id="7447360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7447365">m</span><span class="op" id="7447366">(</span><span class="string" id="7447367">&#34;foo&#34;</span><span class="op" id="7447372">,</span>&nbsp;<span class="string" id="7447374">&#34;\&#34;\\&#34;</span><span class="op" id="7447380">,</span>&nbsp;<span class="string" id="7447382">&#34;filename&#34;</span><span class="op" id="7447392">,</span>&nbsp;<span class="string" id="7447394">&#34;foo.html&#34;</span><span class="op" id="7447404">)</span><span class="op" id="7447405">}</span><span class="op" id="7447406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7447410">{</span><span class="string" id="7447411">`attachment;&nbsp;filename=foo.html`</span><span class="op" id="7447442">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7447447">&#34;attachment&#34;</span><span class="op" id="7447459">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7447464">m</span><span class="op" id="7447465">(</span><span class="string" id="7447466">&#34;filename&#34;</span><span class="op" id="7447476">,</span>&nbsp;<span class="string" id="7447478">&#34;foo.html&#34;</span><span class="op" id="7447488">)</span><span class="op" id="7447489">}</span><span class="op" id="7447490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7447494">{</span><span class="string" id="7447495">`attachment;&nbsp;filename=foo.html&nbsp;;`</span><span class="op" id="7447528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7447533">&#34;attachment&#34;</span><span class="op" id="7447545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7447550">m</span><span class="op" id="7447551">(</span><span class="string" id="7447552">&#34;filename&#34;</span><span class="op" id="7447562">,</span>&nbsp;<span class="string" id="7447564">&#34;foo.html&#34;</span><span class="op" id="7447574">)</span><span class="op" id="7447575">}</span><span class="op" id="7447576">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7447580">{</span><span class="string" id="7447581">`attachment;&nbsp;filename=&#39;foo.html&#39;`</span><span class="op" id="7447614">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7447619">&#34;attachment&#34;</span><span class="op" id="7447631">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7447636">m</span><span class="op" id="7447637">(</span><span class="string" id="7447638">&#34;filename&#34;</span><span class="op" id="7447648">,</span>&nbsp;<span class="string" id="7447650">&#34;foo.html&#34;</span><span class="op" id="7447660">)</span><span class="op" id="7447661">}</span><span class="op" id="7447662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7447666">{</span><span class="string" id="7447667">`attachment;&nbsp;filename=&#34;foo-%41.html&#34;`</span><span class="op" id="7447704">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7447709">&#34;attachment&#34;</span><span class="op" id="7447721">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7447726">m</span><span class="op" id="7447727">(</span><span class="string" id="7447728">&#34;filename&#34;</span><span class="op" id="7447738">,</span>&nbsp;<span class="string" id="7447740">&#34;foo-%41.html&#34;</span><span class="op" id="7447754">)</span><span class="op" id="7447755">}</span><span class="op" id="7447756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7447760">{</span><span class="string" id="7447761">`attachment;&nbsp;filename=&#34;foo-%\41.html&#34;`</span><span class="op" id="7447799">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7447804">&#34;attachment&#34;</span><span class="op" id="7447816">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7447821">m</span><span class="op" id="7447822">(</span><span class="string" id="7447823">&#34;filename&#34;</span><span class="op" id="7447833">,</span>&nbsp;<span class="string" id="7447835">&#34;foo-%41.html&#34;</span><span class="op" id="7447849">)</span><span class="op" id="7447850">}</span><span class="op" id="7447851">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7447855">{</span><span class="string" id="7447856">`filename=foo.html`</span><span class="op" id="7447875">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7447880">&#34;&#34;</span><span class="op" id="7447882">,</span>&nbsp;<span class="ident" id="7447884">m</span><span class="op" id="7447885">(</span><span class="op" id="7447886">)</span><span class="op" id="7447887">}</span><span class="op" id="7447888">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7447892">{</span><span class="string" id="7447893">`x=y;&nbsp;filename=foo.html`</span><span class="op" id="7447917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7447922">&#34;&#34;</span><span class="op" id="7447924">,</span>&nbsp;<span class="ident" id="7447926">m</span><span class="op" id="7447927">(</span><span class="op" id="7447928">)</span><span class="op" id="7447929">}</span><span class="op" id="7447930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7447934">{</span><span class="string" id="7447935">`&#34;foo;&nbsp;filename=bar;baz&#34;;&nbsp;filename=qux`</span><span class="op" id="7447974">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7447979">&#34;&#34;</span><span class="op" id="7447981">,</span>&nbsp;<span class="ident" id="7447983">m</span><span class="op" id="7447984">(</span><span class="op" id="7447985">)</span><span class="op" id="7447986">}</span><span class="op" id="7447987">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7447991">{</span><span class="string" id="7447992">`inline;&nbsp;attachment;&nbsp;filename=foo.html`</span><span class="op" id="7448031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7448036">&#34;&#34;</span><span class="op" id="7448038">,</span>&nbsp;<span class="ident" id="7448040">m</span><span class="op" id="7448041">(</span><span class="op" id="7448042">)</span><span class="op" id="7448043">}</span><span class="op" id="7448044">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7448048">{</span><span class="string" id="7448049">`attachment;&nbsp;filename=&#34;foo.html&#34;.txt`</span><span class="op" id="7448086">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7448091">&#34;&#34;</span><span class="op" id="7448093">,</span>&nbsp;<span class="ident" id="7448095">m</span><span class="op" id="7448096">(</span><span class="op" id="7448097">)</span><span class="op" id="7448098">}</span><span class="op" id="7448099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7448103">{</span><span class="string" id="7448104">`attachment;&nbsp;filename=&#34;bar`</span><span class="op" id="7448131">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7448136">&#34;&#34;</span><span class="op" id="7448138">,</span>&nbsp;<span class="ident" id="7448140">m</span><span class="op" id="7448141">(</span><span class="op" id="7448142">)</span><span class="op" id="7448143">}</span><span class="op" id="7448144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7448148">{</span><span class="string" id="7448149">`attachment;&nbsp;creation-date=&#34;Wed,&nbsp;12&nbsp;Feb&nbsp;1997&nbsp;16:29:51&nbsp;-0500&#34;`</span><span class="op" id="7448210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7448215">&#34;attachment&#34;</span><span class="op" id="7448227">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7448232">m</span><span class="op" id="7448233">(</span><span class="string" id="7448234">&#34;creation-date&#34;</span><span class="op" id="7448249">,</span>&nbsp;<span class="string" id="7448251">&#34;Wed,&nbsp;12&nbsp;Feb&nbsp;1997&nbsp;16:29:51&nbsp;-0500&#34;</span><span class="op" id="7448284">)</span><span class="op" id="7448285">}</span><span class="op" id="7448286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7448290">{</span><span class="string" id="7448291">`foobar`</span><span class="op" id="7448299">,</span>&nbsp;<span class="string" id="7448301">&#34;foobar&#34;</span><span class="op" id="7448309">,</span>&nbsp;<span class="ident" id="7448311">m</span><span class="op" id="7448312">(</span><span class="op" id="7448313">)</span><span class="op" id="7448314">}</span><span class="op" id="7448315">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7448319">{</span><span class="string" id="7448320">`attachment;&nbsp;filename*&nbsp;=UTF-8&#39;&#39;foo-%c3%a4.html`</span><span class="op" id="7448367">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7448372">&#34;attachment&#34;</span><span class="op" id="7448384">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7448389">m</span><span class="op" id="7448390">(</span><span class="string" id="7448391">&#34;filename&#34;</span><span class="op" id="7448401">,</span>&nbsp;<span class="string" id="7448403">&#34;foo-ä.html&#34;</span><span class="op" id="7448416">)</span><span class="op" id="7448417">}</span><span class="op" id="7448418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7448422">{</span><span class="string" id="7448423">`attachment;&nbsp;filename*=UTF-8&#39;&#39;A-%2541.html`</span><span class="op" id="7448466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7448471">&#34;attachment&#34;</span><span class="op" id="7448483">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7448488">m</span><span class="op" id="7448489">(</span><span class="string" id="7448490">&#34;filename&#34;</span><span class="op" id="7448500">,</span>&nbsp;<span class="string" id="7448502">&#34;A-%41.html&#34;</span><span class="op" id="7448514">)</span><span class="op" id="7448515">}</span><span class="op" id="7448516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7448520">{</span><span class="string" id="7448521">`attachment;&nbsp;filename*0=&#34;foo.&#34;;&nbsp;filename*1=&#34;html&#34;`</span><span class="op" id="7448571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7448576">&#34;attachment&#34;</span><span class="op" id="7448588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7448593">m</span><span class="op" id="7448594">(</span><span class="string" id="7448595">&#34;filename&#34;</span><span class="op" id="7448605">,</span>&nbsp;<span class="string" id="7448607">&#34;foo.html&#34;</span><span class="op" id="7448617">)</span><span class="op" id="7448618">}</span><span class="op" id="7448619">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7448623">{</span><span class="string" id="7448624">`attachment;&nbsp;filename*0*=UTF-8&#39;&#39;foo-%c3%a4;&nbsp;filename*1=&#34;.html&#34;`</span><span class="op" id="7448687">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7448692">&#34;attachment&#34;</span><span class="op" id="7448704">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7448709">m</span><span class="op" id="7448710">(</span><span class="string" id="7448711">&#34;filename&#34;</span><span class="op" id="7448721">,</span>&nbsp;<span class="string" id="7448723">&#34;foo-ä.html&#34;</span><span class="op" id="7448736">)</span><span class="op" id="7448737">}</span><span class="op" id="7448738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7448742">{</span><span class="string" id="7448743">`attachment;&nbsp;filename*0=&#34;foo&#34;;&nbsp;filename*01=&#34;bar&#34;`</span><span class="op" id="7448792">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7448797">&#34;attachment&#34;</span><span class="op" id="7448809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7448814">m</span><span class="op" id="7448815">(</span><span class="string" id="7448816">&#34;filename&#34;</span><span class="op" id="7448826">,</span>&nbsp;<span class="string" id="7448828">&#34;foo&#34;</span><span class="op" id="7448833">)</span><span class="op" id="7448834">}</span><span class="op" id="7448835">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7448839">{</span><span class="string" id="7448840">`attachment;&nbsp;filename*0=&#34;foo&#34;;&nbsp;filename*2=&#34;bar&#34;`</span><span class="op" id="7448888">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7448893">&#34;attachment&#34;</span><span class="op" id="7448905">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7448910">m</span><span class="op" id="7448911">(</span><span class="string" id="7448912">&#34;filename&#34;</span><span class="op" id="7448922">,</span>&nbsp;<span class="string" id="7448924">&#34;foo&#34;</span><span class="op" id="7448929">)</span><span class="op" id="7448930">}</span><span class="op" id="7448931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7448935">{</span><span class="string" id="7448936">`attachment;&nbsp;filename*1=&#34;foo&#34;;&nbsp;filename*2=&#34;bar&#34;`</span><span class="op" id="7448984">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7448989">&#34;attachment&#34;</span><span class="op" id="7449001">,</span>&nbsp;<span class="ident" id="7449003">m</span><span class="op" id="7449004">(</span><span class="op" id="7449005">)</span><span class="op" id="7449006">}</span><span class="op" id="7449007">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7449011">{</span><span class="string" id="7449012">`attachment;&nbsp;filename*1=&#34;bar&#34;;&nbsp;filename*0=&#34;foo&#34;`</span><span class="op" id="7449060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7449065">&#34;attachment&#34;</span><span class="op" id="7449077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7449082">m</span><span class="op" id="7449083">(</span><span class="string" id="7449084">&#34;filename&#34;</span><span class="op" id="7449094">,</span>&nbsp;<span class="string" id="7449096">&#34;foobar&#34;</span><span class="op" id="7449104">)</span><span class="op" id="7449105">}</span><span class="op" id="7449106">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7449110">{</span><span class="string" id="7449111">`attachment;&nbsp;filename=&#34;foo-ae.html&#34;;&nbsp;filename*=UTF-8&#39;&#39;foo-%c3%a4.html`</span><span class="op" id="7449181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7449186">&#34;attachment&#34;</span><span class="op" id="7449198">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7449203">m</span><span class="op" id="7449204">(</span><span class="string" id="7449205">&#34;filename&#34;</span><span class="op" id="7449215">,</span>&nbsp;<span class="string" id="7449217">&#34;foo-ä.html&#34;</span><span class="op" id="7449230">)</span><span class="op" id="7449231">}</span><span class="op" id="7449232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7449236">{</span><span class="string" id="7449237">`attachment;&nbsp;filename*=UTF-8&#39;&#39;foo-%c3%a4.html;&nbsp;filename=&#34;foo-ae.html&#34;`</span><span class="op" id="7449307">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7449312">&#34;attachment&#34;</span><span class="op" id="7449324">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7449329">m</span><span class="op" id="7449330">(</span><span class="string" id="7449331">&#34;filename&#34;</span><span class="op" id="7449341">,</span>&nbsp;<span class="string" id="7449343">&#34;foo-ä.html&#34;</span><span class="op" id="7449356">)</span><span class="op" id="7449357">}</span><span class="op" id="7449358">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7449363">//&nbsp;Browsers&nbsp;also&nbsp;just&nbsp;send&nbsp;UTF-8&nbsp;directly&nbsp;without&nbsp;RFC&nbsp;2231,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7449425">//&nbsp;at&nbsp;least&nbsp;when&nbsp;the&nbsp;source&nbsp;page&nbsp;is&nbsp;served&nbsp;with&nbsp;UTF-8.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7449482">{</span><span class="string" id="7449483">`form-data;&nbsp;firstname=&#34;Брэд&#34;;&nbsp;lastname=&#34;Фицпатрик&#34;`</span><span class="op" id="7449547">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7449552">&#34;form-data&#34;</span><span class="op" id="7449563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7449568">m</span><span class="op" id="7449569">(</span><span class="string" id="7449570">&#34;firstname&#34;</span><span class="op" id="7449581">,</span>&nbsp;<span class="string" id="7449583">&#34;Брэд&#34;</span><span class="op" id="7449593">,</span>&nbsp;<span class="string" id="7449595">&#34;lastname&#34;</span><span class="op" id="7449605">,</span>&nbsp;<span class="string" id="7449607">&#34;Фицпатрик&#34;</span><span class="op" id="7449627">)</span><span class="op" id="7449628">}</span><span class="op" id="7449629">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7449632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7449635">for</span>&nbsp;<span class="ident" id="7449639">_</span><span class="op" id="7449640">,</span>&nbsp;<span class="ident" id="7449642">test</span>&nbsp;<span class="op" id="7449647">:=</span>&nbsp;<span class="keyword" id="7449650">range</span>&nbsp;<span class="ident" id="7449656">tests</span>&nbsp;<span class="op" id="7449662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7449666">mt</span><span class="op" id="7449668">,</span>&nbsp;<span class="ident" id="7449670">params</span><span class="op" id="7449676">,</span>&nbsp;<span class="ident" id="7449678">err</span>&nbsp;<span class="op" id="7449682">:=</span>&nbsp;<span class="ident" id="7449685">ParseMediaType</span><span class="op" id="7449699">(</span><span class="ident" id="7449700">test</span><span class="op" id="7449704">.</span><span class="ident" id="7449705">in</span><span class="op" id="7449707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7449711">if</span>&nbsp;<span class="ident" id="7449714">err</span>&nbsp;<span class="op" id="7449718">!=</span>&nbsp;<span class="ident" id="7449721">nil</span>&nbsp;<span class="op" id="7449725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7449730">if</span>&nbsp;<span class="ident" id="7449733">test</span><span class="op" id="7449737">.</span><span class="ident" id="7449738">t</span>&nbsp;<span class="op" id="7449740">!=</span>&nbsp;<span class="string" id="7449743">&#34;&#34;</span>&nbsp;<span class="op" id="7449746">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7449752">t</span><span class="op" id="7449753">.</span><span class="ident" id="7449754">Errorf</span><span class="op" id="7449760">(</span><span class="string" id="7449761">&#34;for&nbsp;input&nbsp;%q,&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7449797">,</span>&nbsp;<span class="ident" id="7449799">test</span><span class="op" id="7449803">.</span><span class="ident" id="7449804">in</span><span class="op" id="7449806">,</span>&nbsp;<span class="ident" id="7449808">err</span><span class="op" id="7449811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7449817">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7449829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7449834">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7449845">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7449849">if</span>&nbsp;<span class="ident" id="7449852">g</span><span class="op" id="7449853">,</span>&nbsp;<span class="ident" id="7449855">e</span>&nbsp;<span class="op" id="7449857">:=</span>&nbsp;<span class="ident" id="7449860">mt</span><span class="op" id="7449862">,</span>&nbsp;<span class="ident" id="7449864">test</span><span class="op" id="7449868">.</span><span class="ident" id="7449869">t</span><span class="op" id="7449870">;</span>&nbsp;<span class="ident" id="7449872">g</span>&nbsp;<span class="op" id="7449874">!=</span>&nbsp;<span class="ident" id="7449877">e</span>&nbsp;<span class="op" id="7449879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7449884">t</span><span class="op" id="7449885">.</span><span class="ident" id="7449886">Errorf</span><span class="op" id="7449892">(</span><span class="string" id="7449893">&#34;for&nbsp;input&nbsp;%q,&nbsp;expected&nbsp;type&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7449933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7449939">test</span><span class="op" id="7449943">.</span><span class="ident" id="7449944">in</span><span class="op" id="7449946">,</span>&nbsp;<span class="ident" id="7449948">e</span><span class="op" id="7449949">,</span>&nbsp;<span class="ident" id="7449951">g</span><span class="op" id="7449952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7449957">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7449968">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7449972">if</span>&nbsp;<span class="builtinfunc" id="7449975">len</span><span class="op" id="7449978">(</span><span class="ident" id="7449979">params</span><span class="op" id="7449985">)</span>&nbsp;<span class="op" id="7449987">==</span>&nbsp;<span class="num" id="7449990">0</span>&nbsp;<span class="op" id="7449992">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="7449995">len</span><span class="op" id="7449998">(</span><span class="ident" id="7449999">test</span><span class="op" id="7450003">.</span><span class="ident" id="7450004">p</span><span class="op" id="7450005">)</span>&nbsp;<span class="op" id="7450007">==</span>&nbsp;<span class="num" id="7450010">0</span>&nbsp;<span class="op" id="7450012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7450017">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7450028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7450032">if</span>&nbsp;<span class="op" id="7450035">!</span><span class="ident" id="7450036">reflect</span><span class="op" id="7450043">.</span><span class="ident" id="7450044">DeepEqual</span><span class="op" id="7450053">(</span><span class="ident" id="7450054">params</span><span class="op" id="7450060">,</span>&nbsp;<span class="ident" id="7450062">test</span><span class="op" id="7450066">.</span><span class="ident" id="7450067">p</span><span class="op" id="7450068">)</span>&nbsp;<span class="op" id="7450070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7450075">t</span><span class="op" id="7450076">.</span><span class="ident" id="7450077">Errorf</span><span class="op" id="7450083">(</span><span class="string" id="7450084">&#34;for&nbsp;input&nbsp;%q,&nbsp;wrong&nbsp;params.\n&#34;</span><span class="op" id="7450115">+</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7450121">&#34;expected:&nbsp;%#v\n&#34;</span><span class="op" id="7450138">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7450144">&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;got:&nbsp;%#v&#34;</span><span class="op" id="7450159">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7450165">test</span><span class="op" id="7450169">.</span><span class="ident" id="7450170">in</span><span class="op" id="7450172">,</span>&nbsp;<span class="ident" id="7450174">test</span><span class="op" id="7450178">.</span><span class="ident" id="7450179">p</span><span class="op" id="7450180">,</span>&nbsp;<span class="ident" id="7450182">params</span><span class="op" id="7450188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7450192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7450195">}</span><br>
<span class="lineno">245</span><span class="op" id="7450197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7450200">type</span>&nbsp;<span class="ident" id="7450205">badMediaTypeTest</span>&nbsp;<span class="keyword" id="7450222">struct</span>&nbsp;<span class="op" id="7450229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7450232">in</span>&nbsp;&nbsp;<span class="builtintype" id="7450236">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7450244">err</span>&nbsp;<span class="builtintype" id="7450248">string</span><br>
<span class="lineno">250</span><span class="op" id="7450255">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7450258">var</span>&nbsp;<span class="ident" id="7450262">badMediaTypeTests</span>&nbsp;<span class="op" id="7450280">=</span>&nbsp;<span class="op" id="7450282">[</span><span class="op" id="7450283">]</span><span class="ident" id="7450284">badMediaTypeTest</span><span class="op" id="7450300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7450303">{</span><span class="string" id="7450304">&#34;bogus&nbsp;;=========&#34;</span><span class="op" id="7450322">,</span>&nbsp;<span class="string" id="7450324">&#34;mime:&nbsp;invalid&nbsp;media&nbsp;parameter&#34;</span><span class="op" id="7450355">}</span><span class="op" id="7450356">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7450359">{</span><span class="string" id="7450360">&#34;bogus/&lt;script&gt;alert&lt;/script&gt;&#34;</span><span class="op" id="7450390">,</span>&nbsp;<span class="string" id="7450392">&#34;mime:&nbsp;expected&nbsp;token&nbsp;after&nbsp;slash&#34;</span><span class="op" id="7450426">}</span><span class="op" id="7450427">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7450430">{</span><span class="string" id="7450431">&#34;bogus/bogus&lt;script&gt;alert&lt;/script&gt;&#34;</span><span class="op" id="7450466">,</span>&nbsp;<span class="string" id="7450468">&#34;mime:&nbsp;unexpected&nbsp;content&nbsp;after&nbsp;media&nbsp;subtype&#34;</span><span class="op" id="7450514">}</span><span class="op" id="7450515">,</span><br>
<span class="lineno"></span><span class="op" id="7450517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7450520">func</span>&nbsp;<span class="ident" id="7450525">TestParseMediaTypeBogus</span><span class="op" id="7450548">(</span><span class="ident" id="7450549">t</span>&nbsp;<span class="op" id="7450551">*</span><span class="ident" id="7450552">testing</span><span class="op" id="7450559">.</span><span class="ident" id="7450560">T</span><span class="op" id="7450561">)</span>&nbsp;<span class="op" id="7450563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7450566">for</span>&nbsp;<span class="ident" id="7450570">_</span><span class="op" id="7450571">,</span>&nbsp;<span class="ident" id="7450573">tt</span>&nbsp;<span class="op" id="7450576">:=</span>&nbsp;<span class="keyword" id="7450579">range</span>&nbsp;<span class="ident" id="7450585">badMediaTypeTests</span>&nbsp;<span class="op" id="7450603">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7450607">mt</span><span class="op" id="7450609">,</span>&nbsp;<span class="ident" id="7450611">params</span><span class="op" id="7450617">,</span>&nbsp;<span class="ident" id="7450619">err</span>&nbsp;<span class="op" id="7450623">:=</span>&nbsp;<span class="ident" id="7450626">ParseMediaType</span><span class="op" id="7450640">(</span><span class="ident" id="7450641">tt</span><span class="op" id="7450643">.</span><span class="ident" id="7450644">in</span><span class="op" id="7450646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7450650">if</span>&nbsp;<span class="ident" id="7450653">err</span>&nbsp;<span class="op" id="7450657">==</span>&nbsp;<span class="ident" id="7450660">nil</span>&nbsp;<span class="op" id="7450664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7450669">t</span><span class="op" id="7450670">.</span><span class="ident" id="7450671">Errorf</span><span class="op" id="7450677">(</span><span class="string" id="7450678">&#34;ParseMediaType(%q)&nbsp;=&nbsp;nil&nbsp;error;&nbsp;want&nbsp;parse&nbsp;error&#34;</span><span class="op" id="7450728">,</span>&nbsp;<span class="ident" id="7450730">tt</span><span class="op" id="7450732">.</span><span class="ident" id="7450733">in</span><span class="op" id="7450735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7450740">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7450751">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7450755">if</span>&nbsp;<span class="ident" id="7450758">err</span><span class="op" id="7450761">.</span><span class="ident" id="7450762">Error</span><span class="op" id="7450767">(</span><span class="op" id="7450768">)</span>&nbsp;<span class="op" id="7450770">!=</span>&nbsp;<span class="ident" id="7450773">tt</span><span class="op" id="7450775">.</span><span class="ident" id="7450776">err</span>&nbsp;<span class="op" id="7450780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7450785">t</span><span class="op" id="7450786">.</span><span class="ident" id="7450787">Errorf</span><span class="op" id="7450793">(</span><span class="string" id="7450794">&#34;ParseMediaType(%q)&nbsp;=&nbsp;err&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7450832">,</span>&nbsp;<span class="ident" id="7450834">tt</span><span class="op" id="7450836">.</span><span class="ident" id="7450837">in</span><span class="op" id="7450839">,</span>&nbsp;<span class="ident" id="7450841">err</span><span class="op" id="7450844">.</span><span class="ident" id="7450845">Error</span><span class="op" id="7450850">(</span><span class="op" id="7450851">)</span><span class="op" id="7450852">,</span>&nbsp;<span class="ident" id="7450854">tt</span><span class="op" id="7450856">.</span><span class="ident" id="7450857">err</span><span class="op" id="7450860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7450864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7450868">if</span>&nbsp;<span class="ident" id="7450871">params</span>&nbsp;<span class="op" id="7450878">!=</span>&nbsp;<span class="ident" id="7450881">nil</span>&nbsp;<span class="op" id="7450885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7450890">t</span><span class="op" id="7450891">.</span><span class="ident" id="7450892">Errorf</span><span class="op" id="7450898">(</span><span class="string" id="7450899">&#34;ParseMediaType(%q):&nbsp;got&nbsp;non-nil&nbsp;params&nbsp;on&nbsp;error&#34;</span><span class="op" id="7450948">,</span>&nbsp;<span class="ident" id="7450950">tt</span><span class="op" id="7450952">.</span><span class="ident" id="7450953">in</span><span class="op" id="7450955">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7450959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7450963">if</span>&nbsp;<span class="ident" id="7450966">mt</span>&nbsp;<span class="op" id="7450969">!=</span>&nbsp;<span class="string" id="7450972">&#34;&#34;</span>&nbsp;<span class="op" id="7450975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7450980">t</span><span class="op" id="7450981">.</span><span class="ident" id="7450982">Errorf</span><span class="op" id="7450988">(</span><span class="string" id="7450989">&#34;ParseMediaType(%q):&nbsp;got&nbsp;non-empty&nbsp;media&nbsp;type&nbsp;string&nbsp;on&nbsp;error&#34;</span><span class="op" id="7451051">,</span>&nbsp;<span class="ident" id="7451053">tt</span><span class="op" id="7451055">.</span><span class="ident" id="7451056">in</span><span class="op" id="7451058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7451062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7451065">}</span><br>
<span class="lineno">275</span><span class="op" id="7451067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7451070">type</span>&nbsp;<span class="ident" id="7451075">formatTest</span>&nbsp;<span class="keyword" id="7451086">struct</span>&nbsp;<span class="op" id="7451093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7451096">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7451103">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7451111">params</span>&nbsp;<span class="keyword" id="7451118">map</span><span class="op" id="7451121">[</span><span class="builtintype" id="7451122">string</span><span class="op" id="7451128">]</span><span class="builtintype" id="7451129">string</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7451137">want</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7451144">string</span><br>
<span class="lineno"></span><span class="op" id="7451151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7451154">var</span>&nbsp;<span class="ident" id="7451158">formatTests</span>&nbsp;<span class="op" id="7451170">=</span>&nbsp;<span class="op" id="7451172">[</span><span class="op" id="7451173">]</span><span class="ident" id="7451174">formatTest</span><span class="op" id="7451184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7451187">{</span><span class="string" id="7451188">&#34;noslash&#34;</span><span class="op" id="7451197">,</span>&nbsp;<span class="ident" id="7451199">nil</span><span class="op" id="7451202">,</span>&nbsp;<span class="string" id="7451204">&#34;&#34;</span><span class="op" id="7451206">}</span><span class="op" id="7451207">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7451210">{</span><span class="string" id="7451211">&#34;foo&nbsp;bar/baz&#34;</span><span class="op" id="7451224">,</span>&nbsp;<span class="ident" id="7451226">nil</span><span class="op" id="7451229">,</span>&nbsp;<span class="string" id="7451231">&#34;&#34;</span><span class="op" id="7451233">}</span><span class="op" id="7451234">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7451237">{</span><span class="string" id="7451238">&#34;foo/bar&nbsp;baz&#34;</span><span class="op" id="7451251">,</span>&nbsp;<span class="ident" id="7451253">nil</span><span class="op" id="7451256">,</span>&nbsp;<span class="string" id="7451258">&#34;&#34;</span><span class="op" id="7451260">}</span><span class="op" id="7451261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7451264">{</span><span class="string" id="7451265">&#34;foo/BAR&#34;</span><span class="op" id="7451274">,</span>&nbsp;<span class="ident" id="7451276">nil</span><span class="op" id="7451279">,</span>&nbsp;<span class="string" id="7451281">&#34;foo/bar&#34;</span><span class="op" id="7451290">}</span><span class="op" id="7451291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7451294">{</span><span class="string" id="7451295">&#34;foo/BAR&#34;</span><span class="op" id="7451304">,</span>&nbsp;<span class="keyword" id="7451306">map</span><span class="op" id="7451309">[</span><span class="builtintype" id="7451310">string</span><span class="op" id="7451316">]</span><span class="builtintype" id="7451317">string</span><span class="op" id="7451323">{</span><span class="string" id="7451324">&#34;X&#34;</span><span class="op" id="7451327">:</span>&nbsp;<span class="string" id="7451329">&#34;Y&#34;</span><span class="op" id="7451332">}</span><span class="op" id="7451333">,</span>&nbsp;<span class="string" id="7451335">&#34;foo/bar;&nbsp;x=Y&#34;</span><span class="op" id="7451349">}</span><span class="op" id="7451350">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7451353">{</span><span class="string" id="7451354">&#34;foo/BAR&#34;</span><span class="op" id="7451363">,</span>&nbsp;<span class="keyword" id="7451365">map</span><span class="op" id="7451368">[</span><span class="builtintype" id="7451369">string</span><span class="op" id="7451375">]</span><span class="builtintype" id="7451376">string</span><span class="op" id="7451382">{</span><span class="string" id="7451383">&#34;space&#34;</span><span class="op" id="7451390">:</span>&nbsp;<span class="string" id="7451392">&#34;With&nbsp;space&#34;</span><span class="op" id="7451404">}</span><span class="op" id="7451405">,</span>&nbsp;<span class="string" id="7451407">`foo/bar;&nbsp;space=&#34;With&nbsp;space&#34;`</span><span class="op" id="7451436">}</span><span class="op" id="7451437">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7451440">{</span><span class="string" id="7451441">&#34;foo/BAR&#34;</span><span class="op" id="7451450">,</span>&nbsp;<span class="keyword" id="7451452">map</span><span class="op" id="7451455">[</span><span class="builtintype" id="7451456">string</span><span class="op" id="7451462">]</span><span class="builtintype" id="7451463">string</span><span class="op" id="7451469">{</span><span class="string" id="7451470">&#34;quote&#34;</span><span class="op" id="7451477">:</span>&nbsp;<span class="string" id="7451479">`With&nbsp;&#34;quote`</span><span class="op" id="7451492">}</span><span class="op" id="7451493">,</span>&nbsp;<span class="string" id="7451495">`foo/bar;&nbsp;quote=&#34;With&nbsp;\&#34;quote&#34;`</span><span class="op" id="7451526">}</span><span class="op" id="7451527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7451530">{</span><span class="string" id="7451531">&#34;foo/BAR&#34;</span><span class="op" id="7451540">,</span>&nbsp;<span class="keyword" id="7451542">map</span><span class="op" id="7451545">[</span><span class="builtintype" id="7451546">string</span><span class="op" id="7451552">]</span><span class="builtintype" id="7451553">string</span><span class="op" id="7451559">{</span><span class="string" id="7451560">&#34;bslash&#34;</span><span class="op" id="7451568">:</span>&nbsp;<span class="string" id="7451570">`With&nbsp;\backslash`</span><span class="op" id="7451587">}</span><span class="op" id="7451588">,</span>&nbsp;<span class="string" id="7451590">`foo/bar;&nbsp;bslash=&#34;With&nbsp;\\backslash&#34;`</span><span class="op" id="7451626">}</span><span class="op" id="7451627">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7451630">{</span><span class="string" id="7451631">&#34;foo/BAR&#34;</span><span class="op" id="7451640">,</span>&nbsp;<span class="keyword" id="7451642">map</span><span class="op" id="7451645">[</span><span class="builtintype" id="7451646">string</span><span class="op" id="7451652">]</span><span class="builtintype" id="7451653">string</span><span class="op" id="7451659">{</span><span class="string" id="7451660">&#34;both&#34;</span><span class="op" id="7451666">:</span>&nbsp;<span class="string" id="7451668">`With&nbsp;\backslash&nbsp;and&nbsp;&#34;quote`</span><span class="op" id="7451696">}</span><span class="op" id="7451697">,</span>&nbsp;<span class="string" id="7451699">`foo/bar;&nbsp;both=&#34;With&nbsp;\\backslash&nbsp;and&nbsp;\&#34;quote&#34;`</span><span class="op" id="7451745">}</span><span class="op" id="7451746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7451749">{</span><span class="string" id="7451750">&#34;foo/BAR&#34;</span><span class="op" id="7451759">,</span>&nbsp;<span class="keyword" id="7451761">map</span><span class="op" id="7451764">[</span><span class="builtintype" id="7451765">string</span><span class="op" id="7451771">]</span><span class="builtintype" id="7451772">string</span><span class="op" id="7451778">{</span><span class="string" id="7451779">&#34;&#34;</span><span class="op" id="7451781">:</span>&nbsp;<span class="string" id="7451783">&#34;empty&nbsp;attribute&#34;</span><span class="op" id="7451800">}</span><span class="op" id="7451801">,</span>&nbsp;<span class="string" id="7451803">&#34;&#34;</span><span class="op" id="7451805">}</span><span class="op" id="7451806">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7451809">{</span><span class="string" id="7451810">&#34;foo/BAR&#34;</span><span class="op" id="7451819">,</span>&nbsp;<span class="keyword" id="7451821">map</span><span class="op" id="7451824">[</span><span class="builtintype" id="7451825">string</span><span class="op" id="7451831">]</span><span class="builtintype" id="7451832">string</span><span class="op" id="7451838">{</span><span class="string" id="7451839">&#34;bad&nbsp;attribute&#34;</span><span class="op" id="7451854">:</span>&nbsp;<span class="string" id="7451856">&#34;baz&#34;</span><span class="op" id="7451861">}</span><span class="op" id="7451862">,</span>&nbsp;<span class="string" id="7451864">&#34;&#34;</span><span class="op" id="7451866">}</span><span class="op" id="7451867">,</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7451870">{</span><span class="string" id="7451871">&#34;foo/BAR&#34;</span><span class="op" id="7451880">,</span>&nbsp;<span class="keyword" id="7451882">map</span><span class="op" id="7451885">[</span><span class="builtintype" id="7451886">string</span><span class="op" id="7451892">]</span><span class="builtintype" id="7451893">string</span><span class="op" id="7451899">{</span><span class="string" id="7451900">&#34;nonascii&#34;</span><span class="op" id="7451910">:</span>&nbsp;<span class="string" id="7451912">&#34;not&nbsp;an&nbsp;ascii&nbsp;character:&nbsp;ä&#34;</span><span class="op" id="7451940">}</span><span class="op" id="7451941">,</span>&nbsp;<span class="string" id="7451943">&#34;&#34;</span><span class="op" id="7451945">}</span><span class="op" id="7451946">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7451949">{</span><span class="string" id="7451950">&#34;foo/bar&#34;</span><span class="op" id="7451959">,</span>&nbsp;<span class="keyword" id="7451961">map</span><span class="op" id="7451964">[</span><span class="builtintype" id="7451965">string</span><span class="op" id="7451971">]</span><span class="builtintype" id="7451972">string</span><span class="op" id="7451978">{</span><span class="string" id="7451979">&#34;a&#34;</span><span class="op" id="7451982">:</span>&nbsp;<span class="string" id="7451984">&#34;av&#34;</span><span class="op" id="7451988">,</span>&nbsp;<span class="string" id="7451990">&#34;b&#34;</span><span class="op" id="7451993">:</span>&nbsp;<span class="string" id="7451995">&#34;bv&#34;</span><span class="op" id="7451999">,</span>&nbsp;<span class="string" id="7452001">&#34;c&#34;</span><span class="op" id="7452004">:</span>&nbsp;<span class="string" id="7452006">&#34;cv&#34;</span><span class="op" id="7452010">}</span><span class="op" id="7452011">,</span>&nbsp;<span class="string" id="7452013">&#34;foo/bar;&nbsp;a=av;&nbsp;b=bv;&nbsp;c=cv&#34;</span><span class="op" id="7452040">}</span><span class="op" id="7452041">,</span><br>
<span class="lineno"></span><span class="op" id="7452043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7452046">func</span>&nbsp;<span class="ident" id="7452051">TestFormatMediaType</span><span class="op" id="7452070">(</span><span class="ident" id="7452071">t</span>&nbsp;<span class="op" id="7452073">*</span><span class="ident" id="7452074">testing</span><span class="op" id="7452081">.</span><span class="ident" id="7452082">T</span><span class="op" id="7452083">)</span>&nbsp;<span class="op" id="7452085">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7452088">for</span>&nbsp;<span class="ident" id="7452092">i</span><span class="op" id="7452093">,</span>&nbsp;<span class="ident" id="7452095">tt</span>&nbsp;<span class="op" id="7452098">:=</span>&nbsp;<span class="keyword" id="7452101">range</span>&nbsp;<span class="ident" id="7452107">formatTests</span>&nbsp;<span class="op" id="7452119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7452123">got</span>&nbsp;<span class="op" id="7452127">:=</span>&nbsp;<span class="ident" id="7452130">FormatMediaType</span><span class="op" id="7452145">(</span><span class="ident" id="7452146">tt</span><span class="op" id="7452148">.</span><span class="ident" id="7452149">typ</span><span class="op" id="7452152">,</span>&nbsp;<span class="ident" id="7452154">tt</span><span class="op" id="7452156">.</span><span class="ident" id="7452157">params</span><span class="op" id="7452163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7452167">if</span>&nbsp;<span class="ident" id="7452170">got</span>&nbsp;<span class="op" id="7452174">!=</span>&nbsp;<span class="ident" id="7452177">tt</span><span class="op" id="7452179">.</span><span class="ident" id="7452180">want</span>&nbsp;<span class="op" id="7452185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7452190">t</span><span class="op" id="7452191">.</span><span class="ident" id="7452192">Errorf</span><span class="op" id="7452198">(</span><span class="string" id="7452199">&#34;%d.&nbsp;FormatMediaType(%q,&nbsp;%v)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7452242">,</span>&nbsp;<span class="ident" id="7452244">i</span><span class="op" id="7452245">,</span>&nbsp;<span class="ident" id="7452247">tt</span><span class="op" id="7452249">.</span><span class="ident" id="7452250">typ</span><span class="op" id="7452253">,</span>&nbsp;<span class="ident" id="7452255">tt</span><span class="op" id="7452257">.</span><span class="ident" id="7452258">params</span><span class="op" id="7452264">,</span>&nbsp;<span class="ident" id="7452266">got</span><span class="op" id="7452269">,</span>&nbsp;<span class="ident" id="7452271">tt</span><span class="op" id="7452273">.</span><span class="ident" id="7452274">want</span><span class="op" id="7452278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7452282">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7452285">}</span><br>
<span class="lineno"></span><span class="op" id="7452287">}</span>
</div>
</body>
</html>
