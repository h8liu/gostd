<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/rand</h2>
<ul>
<li><a href="/gostd/math/rand/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/math/rand/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/rand/normal.go.html">normal.go</a></li>
<li><a href="/gostd/math/rand/rand.go.html">rand.go</a></li>
<li><a href="/gostd/math/rand/rand_test.go.html">rand_test.go</a></li>
<li><a href="/gostd/math/rand/regress_test.go.html">regress_test.go</a></li>
<li><a href="/gostd/math/rand/rng.go.html">rng.go</a></li>
<li><a href="/gostd/math/rand/zipf.go.html" class="current">zipf.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3434299">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3434354">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3434408">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3434459">//&nbsp;W.Hormann,&nbsp;G.Derflinger:</span><br>
<span class="lineno"></span><span class="comment" id="3434487">//&nbsp;&#34;Rejection-Inversion&nbsp;to&nbsp;Generate&nbsp;Variates</span><br>
<span class="lineno"></span><span class="comment" id="3434532">//&nbsp;from&nbsp;Monotone&nbsp;Discrete&nbsp;Distributions&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3434573">//&nbsp;http://eeyore.wu-wien.ac.at/papers/96-04-04.wh-der.ps.gz</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="3434634">package</span>&nbsp;<span class="ident" id="3434642">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3434648">import</span>&nbsp;<span class="string" id="3434655">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3434663">//&nbsp;A&nbsp;Zipf&nbsp;generates&nbsp;Zipf&nbsp;distributed&nbsp;variates.</span><br>
<span class="lineno">15</span><span class="keyword" id="3434710">type</span>&nbsp;<span class="ident" id="3434715">Zipf</span>&nbsp;<span class="keyword" id="3434720">struct</span>&nbsp;<span class="op" id="3434727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434730">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3434743">*</span><span class="ident" id="3434744">Rand</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434750">imax</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3434763">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434772">v</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3434785">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434794">q</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3434807">float64</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434816">s</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3434829">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434838">oneminusQ</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3434851">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434860">oneminusQinv</span>&nbsp;<span class="builtintype" id="3434873">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434882">hxm</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3434895">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434904">hx0minusHxm</span>&nbsp;&nbsp;<span class="builtintype" id="3434917">float64</span><br>
<span class="lineno">25</span><span class="op" id="3434925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3434928">func</span>&nbsp;<span class="op" id="3434933">(</span><span class="ident" id="3434934">z</span>&nbsp;<span class="op" id="3434936">*</span><span class="ident" id="3434937">Zipf</span><span class="op" id="3434941">)</span>&nbsp;<span class="ident" id="3434943">h</span><span class="op" id="3434944">(</span><span class="ident" id="3434945">x</span>&nbsp;<span class="builtintype" id="3434947">float64</span><span class="op" id="3434954">)</span>&nbsp;<span class="builtintype" id="3434956">float64</span>&nbsp;<span class="op" id="3434964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3434967">return</span>&nbsp;<span class="ident" id="3434974">math</span><span class="op" id="3434978">.</span><span class="ident" id="3434979">Exp</span><span class="op" id="3434982">(</span><span class="ident" id="3434983">z</span><span class="op" id="3434984">.</span><span class="ident" id="3434985">oneminusQ</span><span class="op" id="3434994">*</span><span class="ident" id="3434995">math</span><span class="op" id="3434999">.</span><span class="ident" id="3435000">Log</span><span class="op" id="3435003">(</span><span class="ident" id="3435004">z</span><span class="op" id="3435005">.</span><span class="ident" id="3435006">v</span><span class="op" id="3435007">+</span><span class="ident" id="3435008">x</span><span class="op" id="3435009">)</span><span class="op" id="3435010">)</span>&nbsp;<span class="op" id="3435012">*</span>&nbsp;<span class="ident" id="3435014">z</span><span class="op" id="3435015">.</span><span class="ident" id="3435016">oneminusQinv</span><br>
<span class="lineno"></span><span class="op" id="3435029">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="3435032">func</span>&nbsp;<span class="op" id="3435037">(</span><span class="ident" id="3435038">z</span>&nbsp;<span class="op" id="3435040">*</span><span class="ident" id="3435041">Zipf</span><span class="op" id="3435045">)</span>&nbsp;<span class="ident" id="3435047">hinv</span><span class="op" id="3435051">(</span><span class="ident" id="3435052">x</span>&nbsp;<span class="builtintype" id="3435054">float64</span><span class="op" id="3435061">)</span>&nbsp;<span class="builtintype" id="3435063">float64</span>&nbsp;<span class="op" id="3435071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435074">return</span>&nbsp;<span class="ident" id="3435081">math</span><span class="op" id="3435085">.</span><span class="ident" id="3435086">Exp</span><span class="op" id="3435089">(</span><span class="ident" id="3435090">z</span><span class="op" id="3435091">.</span><span class="ident" id="3435092">oneminusQinv</span><span class="op" id="3435104">*</span><span class="ident" id="3435105">math</span><span class="op" id="3435109">.</span><span class="ident" id="3435110">Log</span><span class="op" id="3435113">(</span><span class="ident" id="3435114">z</span><span class="op" id="3435115">.</span><span class="ident" id="3435116">oneminusQ</span><span class="op" id="3435125">*</span><span class="ident" id="3435126">x</span><span class="op" id="3435127">)</span><span class="op" id="3435128">)</span>&nbsp;<span class="op" id="3435130">-</span>&nbsp;<span class="ident" id="3435132">z</span><span class="op" id="3435133">.</span><span class="ident" id="3435134">v</span><br>
<span class="lineno"></span><span class="op" id="3435136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="3435139">//&nbsp;NewZipf&nbsp;returns&nbsp;a&nbsp;Zipf&nbsp;generating&nbsp;variates&nbsp;p(k)&nbsp;on&nbsp;[0,&nbsp;imax]</span><br>
<span class="lineno"></span><span class="comment" id="3435203">//&nbsp;proportional&nbsp;to&nbsp;(v+k)**(-s)&nbsp;where&nbsp;s&gt;1&nbsp;and&nbsp;k&gt;=0,&nbsp;and&nbsp;v&gt;=1.</span><br>
<span class="lineno"></span><span class="keyword" id="3435264">func</span>&nbsp;<span class="ident" id="3435269">NewZipf</span><span class="op" id="3435276">(</span><span class="ident" id="3435277">r</span>&nbsp;<span class="op" id="3435279">*</span><span class="ident" id="3435280">Rand</span><span class="op" id="3435284">,</span>&nbsp;<span class="ident" id="3435286">s</span>&nbsp;<span class="builtintype" id="3435288">float64</span><span class="op" id="3435295">,</span>&nbsp;<span class="ident" id="3435297">v</span>&nbsp;<span class="builtintype" id="3435299">float64</span><span class="op" id="3435306">,</span>&nbsp;<span class="ident" id="3435308">imax</span>&nbsp;<span class="ident" id="3435313">uint64</span><span class="op" id="3435319">)</span>&nbsp;<span class="op" id="3435321">*</span><span class="ident" id="3435322">Zipf</span>&nbsp;<span class="op" id="3435327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435330">z</span>&nbsp;<span class="op" id="3435332">:=</span>&nbsp;<span class="builtinfunc" id="3435335">new</span><span class="op" id="3435338">(</span><span class="ident" id="3435339">Zipf</span><span class="op" id="3435343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435346">if</span>&nbsp;<span class="ident" id="3435349">s</span>&nbsp;<span class="op" id="3435351">&lt;=</span>&nbsp;<span class="num" id="3435354">1.0</span>&nbsp;<span class="op" id="3435358">||</span>&nbsp;<span class="ident" id="3435361">v</span>&nbsp;<span class="op" id="3435363">&lt;</span>&nbsp;<span class="num" id="3435365">1</span>&nbsp;<span class="op" id="3435367">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435371">return</span>&nbsp;<span class="builtintype" id="3435378">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3435383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435386">z</span><span class="op" id="3435387">.</span><span class="ident" id="3435388">r</span>&nbsp;<span class="op" id="3435390">=</span>&nbsp;<span class="ident" id="3435392">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435395">z</span><span class="op" id="3435396">.</span><span class="ident" id="3435397">imax</span>&nbsp;<span class="op" id="3435402">=</span>&nbsp;<span class="builtintype" id="3435404">float64</span><span class="op" id="3435411">(</span><span class="ident" id="3435412">imax</span><span class="op" id="3435416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435419">z</span><span class="op" id="3435420">.</span><span class="ident" id="3435421">v</span>&nbsp;<span class="op" id="3435423">=</span>&nbsp;<span class="ident" id="3435425">v</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435428">z</span><span class="op" id="3435429">.</span><span class="ident" id="3435430">q</span>&nbsp;<span class="op" id="3435432">=</span>&nbsp;<span class="ident" id="3435434">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435437">z</span><span class="op" id="3435438">.</span><span class="ident" id="3435439">oneminusQ</span>&nbsp;<span class="op" id="3435449">=</span>&nbsp;<span class="num" id="3435451">1.0</span>&nbsp;<span class="op" id="3435455">-</span>&nbsp;<span class="ident" id="3435457">z</span><span class="op" id="3435458">.</span><span class="ident" id="3435459">q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435462">z</span><span class="op" id="3435463">.</span><span class="ident" id="3435464">oneminusQinv</span>&nbsp;<span class="op" id="3435477">=</span>&nbsp;<span class="num" id="3435479">1.0</span>&nbsp;<span class="op" id="3435483">/</span>&nbsp;<span class="ident" id="3435485">z</span><span class="op" id="3435486">.</span><span class="ident" id="3435487">oneminusQ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435498">z</span><span class="op" id="3435499">.</span><span class="ident" id="3435500">hxm</span>&nbsp;<span class="op" id="3435504">=</span>&nbsp;<span class="ident" id="3435506">z</span><span class="op" id="3435507">.</span><span class="ident" id="3435508">h</span><span class="op" id="3435509">(</span><span class="ident" id="3435510">z</span><span class="op" id="3435511">.</span><span class="ident" id="3435512">imax</span>&nbsp;<span class="op" id="3435517">+</span>&nbsp;<span class="num" id="3435519">0.5</span><span class="op" id="3435522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435525">z</span><span class="op" id="3435526">.</span><span class="ident" id="3435527">hx0minusHxm</span>&nbsp;<span class="op" id="3435539">=</span>&nbsp;<span class="ident" id="3435541">z</span><span class="op" id="3435542">.</span><span class="ident" id="3435543">h</span><span class="op" id="3435544">(</span><span class="num" id="3435545">0.5</span><span class="op" id="3435548">)</span>&nbsp;<span class="op" id="3435550">-</span>&nbsp;<span class="ident" id="3435552">math</span><span class="op" id="3435556">.</span><span class="ident" id="3435557">Exp</span><span class="op" id="3435560">(</span><span class="ident" id="3435561">math</span><span class="op" id="3435565">.</span><span class="ident" id="3435566">Log</span><span class="op" id="3435569">(</span><span class="ident" id="3435570">z</span><span class="op" id="3435571">.</span><span class="ident" id="3435572">v</span><span class="op" id="3435573">)</span><span class="op" id="3435574">*</span><span class="op" id="3435575">(</span><span class="op" id="3435576">-</span><span class="ident" id="3435577">z</span><span class="op" id="3435578">.</span><span class="ident" id="3435579">q</span><span class="op" id="3435580">)</span><span class="op" id="3435581">)</span>&nbsp;<span class="op" id="3435583">-</span>&nbsp;<span class="ident" id="3435585">z</span><span class="op" id="3435586">.</span><span class="ident" id="3435587">hxm</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435592">z</span><span class="op" id="3435593">.</span><span class="ident" id="3435594">s</span>&nbsp;<span class="op" id="3435596">=</span>&nbsp;<span class="num" id="3435598">1</span>&nbsp;<span class="op" id="3435600">-</span>&nbsp;<span class="ident" id="3435602">z</span><span class="op" id="3435603">.</span><span class="ident" id="3435604">hinv</span><span class="op" id="3435608">(</span><span class="ident" id="3435609">z</span><span class="op" id="3435610">.</span><span class="ident" id="3435611">h</span><span class="op" id="3435612">(</span><span class="num" id="3435613">1.5</span><span class="op" id="3435616">)</span><span class="op" id="3435617">-</span><span class="ident" id="3435618">math</span><span class="op" id="3435622">.</span><span class="ident" id="3435623">Exp</span><span class="op" id="3435626">(</span><span class="op" id="3435627">-</span><span class="ident" id="3435628">z</span><span class="op" id="3435629">.</span><span class="ident" id="3435630">q</span><span class="op" id="3435631">*</span><span class="ident" id="3435632">math</span><span class="op" id="3435636">.</span><span class="ident" id="3435637">Log</span><span class="op" id="3435640">(</span><span class="ident" id="3435641">z</span><span class="op" id="3435642">.</span><span class="ident" id="3435643">v</span><span class="op" id="3435644">+</span><span class="num" id="3435645">1.0</span><span class="op" id="3435648">)</span><span class="op" id="3435649">)</span><span class="op" id="3435650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435653">return</span>&nbsp;<span class="ident" id="3435660">z</span><br>
<span class="lineno"></span><span class="op" id="3435662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3435665">//&nbsp;Uint64&nbsp;returns&nbsp;a&nbsp;value&nbsp;drawn&nbsp;from&nbsp;the&nbsp;Zipf&nbsp;distribution&nbsp;described</span><br>
<span class="lineno">55</span><span class="comment" id="3435734">//&nbsp;by&nbsp;the&nbsp;Zipf&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="3435757">func</span>&nbsp;<span class="op" id="3435762">(</span><span class="ident" id="3435763">z</span>&nbsp;<span class="op" id="3435765">*</span><span class="ident" id="3435766">Zipf</span><span class="op" id="3435770">)</span>&nbsp;<span class="ident" id="3435772">Uint64</span><span class="op" id="3435778">(</span><span class="op" id="3435779">)</span>&nbsp;<span class="ident" id="3435781">uint64</span>&nbsp;<span class="op" id="3435788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435791">if</span>&nbsp;<span class="ident" id="3435794">z</span>&nbsp;<span class="op" id="3435796">==</span>&nbsp;<span class="builtintype" id="3435799">nil</span>&nbsp;<span class="op" id="3435803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3435807">panic</span><span class="op" id="3435812">(</span><span class="string" id="3435813">&#34;rand:&nbsp;nil&nbsp;Zipf&#34;</span><span class="op" id="3435829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3435832">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435835">k</span>&nbsp;<span class="op" id="3435837">:=</span>&nbsp;<span class="num" id="3435840">0.0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435846">for</span>&nbsp;<span class="op" id="3435850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435854">r</span>&nbsp;<span class="op" id="3435856">:=</span>&nbsp;<span class="ident" id="3435859">z</span><span class="op" id="3435860">.</span><span class="ident" id="3435861">r</span><span class="op" id="3435862">.</span><span class="ident" id="3435863">Float64</span><span class="op" id="3435870">(</span><span class="op" id="3435871">)</span>&nbsp;<span class="comment" id="3435873">//&nbsp;r&nbsp;on&nbsp;[0,1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435889">ur</span>&nbsp;<span class="op" id="3435892">:=</span>&nbsp;<span class="ident" id="3435895">z</span><span class="op" id="3435896">.</span><span class="ident" id="3435897">hxm</span>&nbsp;<span class="op" id="3435901">+</span>&nbsp;<span class="ident" id="3435903">r</span><span class="op" id="3435904">*</span><span class="ident" id="3435905">z</span><span class="op" id="3435906">.</span><span class="ident" id="3435907">hx0minusHxm</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435921">x</span>&nbsp;<span class="op" id="3435923">:=</span>&nbsp;<span class="ident" id="3435926">z</span><span class="op" id="3435927">.</span><span class="ident" id="3435928">hinv</span><span class="op" id="3435932">(</span><span class="ident" id="3435933">ur</span><span class="op" id="3435935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435939">k</span>&nbsp;<span class="op" id="3435941">=</span>&nbsp;<span class="ident" id="3435943">math</span><span class="op" id="3435947">.</span><span class="ident" id="3435948">Floor</span><span class="op" id="3435953">(</span><span class="ident" id="3435954">x</span>&nbsp;<span class="op" id="3435956">+</span>&nbsp;<span class="num" id="3435958">0.5</span><span class="op" id="3435961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435965">if</span>&nbsp;<span class="ident" id="3435968">k</span><span class="op" id="3435969">-</span><span class="ident" id="3435970">x</span>&nbsp;<span class="op" id="3435972">&lt;=</span>&nbsp;<span class="ident" id="3435975">z</span><span class="op" id="3435976">.</span><span class="ident" id="3435977">s</span>&nbsp;<span class="op" id="3435979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435984">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3435992">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435996">if</span>&nbsp;<span class="ident" id="3435999">ur</span>&nbsp;<span class="op" id="3436002">&gt;=</span>&nbsp;<span class="ident" id="3436005">z</span><span class="op" id="3436006">.</span><span class="ident" id="3436007">h</span><span class="op" id="3436008">(</span><span class="ident" id="3436009">k</span><span class="op" id="3436010">+</span><span class="num" id="3436011">0.5</span><span class="op" id="3436014">)</span><span class="op" id="3436015">-</span><span class="ident" id="3436016">math</span><span class="op" id="3436020">.</span><span class="ident" id="3436021">Exp</span><span class="op" id="3436024">(</span><span class="op" id="3436025">-</span><span class="ident" id="3436026">math</span><span class="op" id="3436030">.</span><span class="ident" id="3436031">Log</span><span class="op" id="3436034">(</span><span class="ident" id="3436035">k</span><span class="op" id="3436036">+</span><span class="ident" id="3436037">z</span><span class="op" id="3436038">.</span><span class="ident" id="3436039">v</span><span class="op" id="3436040">)</span><span class="op" id="3436041">*</span><span class="ident" id="3436042">z</span><span class="op" id="3436043">.</span><span class="ident" id="3436044">q</span><span class="op" id="3436045">)</span>&nbsp;<span class="op" id="3436047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3436052">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3436060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3436063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3436066">return</span>&nbsp;<span class="ident" id="3436073">uint64</span><span class="op" id="3436079">(</span><span class="ident" id="3436080">k</span><span class="op" id="3436081">)</span><br>
<span class="lineno">75</span><span class="op" id="3436083">}</span>
</div>
</body>
</html>
