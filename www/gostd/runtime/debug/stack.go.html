<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime/debug</h2>
<ul>
<li><a href="/gostd/runtime/debug/garbage.go.html">garbage.go</a></li>
<li><a href="/gostd/runtime/debug/garbage_test.go.html">garbage_test.go</a></li>
<li><a href="/gostd/runtime/debug/heapdump_test.go.html">heapdump_test.go</a></li>
<li><a href="/gostd/runtime/debug/stack.go.html" class="current">stack.go</a></li>
<li><a href="/gostd/runtime/debug/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/debug/stubs.go.html">stubs.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5655588">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5655643">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5655697">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5655748">//&nbsp;Package&nbsp;debug&nbsp;contains&nbsp;facilities&nbsp;for&nbsp;programs&nbsp;to&nbsp;debug&nbsp;themselves&nbsp;while</span><br>
<span class="lineno"></span><span class="comment" id="5655824">//&nbsp;they&nbsp;are&nbsp;running.</span><br>
<span class="lineno"></span><span class="keyword" id="5655845">package</span>&nbsp;<span class="ident" id="5655853">debug</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5655860">import</span>&nbsp;<span class="op" id="5655867">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5655870">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5655879">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5655886">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5655899">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5655905">&#34;runtime&#34;</span><br>
<span class="lineno">15</span><span class="op" id="5655915">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5655918">var</span>&nbsp;<span class="op" id="5655922">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5655925">dunno</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5655935">=</span>&nbsp;<span class="op" id="5655937">[</span><span class="op" id="5655938">]</span><span class="builtintype" id="5655939">byte</span><span class="op" id="5655943">(</span><span class="string" id="5655944">&#34;???&#34;</span><span class="op" id="5655949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5655952">centerDot</span>&nbsp;<span class="op" id="5655962">=</span>&nbsp;<span class="op" id="5655964">[</span><span class="op" id="5655965">]</span><span class="builtintype" id="5655966">byte</span><span class="op" id="5655970">(</span><span class="string" id="5655971">&#34;·&#34;</span><span class="op" id="5655975">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5655978">dot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5655988">=</span>&nbsp;<span class="op" id="5655990">[</span><span class="op" id="5655991">]</span><span class="builtintype" id="5655992">byte</span><span class="op" id="5655996">(</span><span class="string" id="5655997">&#34;.&#34;</span><span class="op" id="5656000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5656003">slash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5656013">=</span>&nbsp;<span class="op" id="5656015">[</span><span class="op" id="5656016">]</span><span class="builtintype" id="5656017">byte</span><span class="op" id="5656021">(</span><span class="string" id="5656022">&#34;/&#34;</span><span class="op" id="5656025">)</span><br>
<span class="lineno"></span><span class="op" id="5656027">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5656030">//&nbsp;PrintStack&nbsp;prints&nbsp;to&nbsp;standard&nbsp;error&nbsp;the&nbsp;stack&nbsp;trace&nbsp;returned&nbsp;by&nbsp;Stack.</span><br>
<span class="lineno">25</span><span class="keyword" id="5656104">func</span>&nbsp;<span class="ident" id="5656109">PrintStack</span><span class="op" id="5656119">(</span><span class="op" id="5656120">)</span>&nbsp;<span class="op" id="5656122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5656125">os</span><span class="op" id="5656127">.</span><span class="ident" id="5656128">Stderr</span><span class="op" id="5656134">.</span><span class="ident" id="5656135">Write</span><span class="op" id="5656140">(</span><span class="ident" id="5656141">stack</span><span class="op" id="5656146">(</span><span class="op" id="5656147">)</span><span class="op" id="5656148">)</span><br>
<span class="lineno"></span><span class="op" id="5656150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5656153">//&nbsp;Stack&nbsp;returns&nbsp;a&nbsp;formatted&nbsp;stack&nbsp;trace&nbsp;of&nbsp;the&nbsp;goroutine&nbsp;that&nbsp;calls&nbsp;it.</span><br>
<span class="lineno">30</span><span class="comment" id="5656226">//&nbsp;For&nbsp;each&nbsp;routine,&nbsp;it&nbsp;includes&nbsp;the&nbsp;source&nbsp;line&nbsp;information&nbsp;and&nbsp;PC&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="5656301">//&nbsp;then&nbsp;attempts&nbsp;to&nbsp;discover,&nbsp;for&nbsp;Go&nbsp;functions,&nbsp;the&nbsp;calling&nbsp;function&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5656373">//&nbsp;method&nbsp;and&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;line&nbsp;containing&nbsp;the&nbsp;invocation.</span><br>
<span class="lineno"></span><span class="comment" id="5656435">//</span><br>
<span class="lineno"></span><span class="comment" id="5656438">//&nbsp;This&nbsp;function&nbsp;is&nbsp;deprecated.&nbsp;Use&nbsp;package&nbsp;runtime&#39;s&nbsp;Stack&nbsp;instead.</span><br>
<span class="lineno">35</span><span class="keyword" id="5656507">func</span>&nbsp;<span class="ident" id="5656512">Stack</span><span class="op" id="5656517">(</span><span class="op" id="5656518">)</span>&nbsp;<span class="op" id="5656520">[</span><span class="op" id="5656521">]</span><span class="builtintype" id="5656522">byte</span>&nbsp;<span class="op" id="5656527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5656530">return</span>&nbsp;<span class="ident" id="5656537">stack</span><span class="op" id="5656542">(</span><span class="op" id="5656543">)</span><br>
<span class="lineno"></span><span class="op" id="5656545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5656548">//&nbsp;stack&nbsp;implements&nbsp;Stack,&nbsp;skipping&nbsp;2&nbsp;frames</span><br>
<span class="lineno">40</span><span class="keyword" id="5656593">func</span>&nbsp;<span class="ident" id="5656598">stack</span><span class="op" id="5656603">(</span><span class="op" id="5656604">)</span>&nbsp;<span class="op" id="5656606">[</span><span class="op" id="5656607">]</span><span class="builtintype" id="5656608">byte</span>&nbsp;<span class="op" id="5656613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5656616">buf</span>&nbsp;<span class="op" id="5656620">:=</span>&nbsp;<span class="builtinfunc" id="5656623">new</span><span class="op" id="5656626">(</span><span class="ident" id="5656627">bytes</span><span class="op" id="5656632">.</span><span class="ident" id="5656633">Buffer</span><span class="op" id="5656639">)</span>&nbsp;<span class="comment" id="5656641">//&nbsp;the&nbsp;returned&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5656663">//&nbsp;As&nbsp;we&nbsp;loop,&nbsp;we&nbsp;open&nbsp;files&nbsp;and&nbsp;read&nbsp;them.&nbsp;These&nbsp;variables&nbsp;record&nbsp;the&nbsp;currently</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5656745">//&nbsp;loaded&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5656762">var</span>&nbsp;<span class="ident" id="5656766">lines</span>&nbsp;<span class="op" id="5656772">[</span><span class="op" id="5656773">]</span><span class="op" id="5656774">[</span><span class="op" id="5656775">]</span><span class="builtintype" id="5656776">byte</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5656782">var</span>&nbsp;<span class="ident" id="5656786">lastFile</span>&nbsp;<span class="builtintype" id="5656795">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5656803">for</span>&nbsp;<span class="ident" id="5656807">i</span>&nbsp;<span class="op" id="5656809">:=</span>&nbsp;<span class="num" id="5656812">2</span><span class="op" id="5656813">;</span>&nbsp;<span class="op" id="5656815">;</span>&nbsp;<span class="ident" id="5656817">i</span><span class="op" id="5656818">++</span>&nbsp;<span class="op" id="5656821">{</span>&nbsp;<span class="comment" id="5656823">//&nbsp;Caller&nbsp;we&nbsp;care&nbsp;about&nbsp;is&nbsp;the&nbsp;user,&nbsp;2&nbsp;frames&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5656874">pc</span><span class="op" id="5656876">,</span>&nbsp;<span class="ident" id="5656878">file</span><span class="op" id="5656882">,</span>&nbsp;<span class="ident" id="5656884">line</span><span class="op" id="5656888">,</span>&nbsp;<span class="ident" id="5656890">ok</span>&nbsp;<span class="op" id="5656893">:=</span>&nbsp;<span class="ident" id="5656896">runtime</span><span class="op" id="5656903">.</span><span class="ident" id="5656904">Caller</span><span class="op" id="5656910">(</span><span class="ident" id="5656911">i</span><span class="op" id="5656912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5656916">if</span>&nbsp;<span class="op" id="5656919">!</span><span class="ident" id="5656920">ok</span>&nbsp;<span class="op" id="5656923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5656928">break</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5656936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5656940">//&nbsp;Print&nbsp;this&nbsp;much&nbsp;at&nbsp;least.&nbsp;&nbsp;If&nbsp;we&nbsp;can&#39;t&nbsp;find&nbsp;the&nbsp;source,&nbsp;it&nbsp;won&#39;t&nbsp;show.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5657016">fmt</span><span class="op" id="5657019">.</span><span class="ident" id="5657020">Fprintf</span><span class="op" id="5657027">(</span><span class="ident" id="5657028">buf</span><span class="op" id="5657031">,</span>&nbsp;<span class="string" id="5657033">&#34;%s:%d&nbsp;(0x%x)\n&#34;</span><span class="op" id="5657049">,</span>&nbsp;<span class="ident" id="5657051">file</span><span class="op" id="5657055">,</span>&nbsp;<span class="ident" id="5657057">line</span><span class="op" id="5657061">,</span>&nbsp;<span class="ident" id="5657063">pc</span><span class="op" id="5657065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5657069">if</span>&nbsp;<span class="ident" id="5657072">file</span>&nbsp;<span class="op" id="5657077">!=</span>&nbsp;<span class="ident" id="5657080">lastFile</span>&nbsp;<span class="op" id="5657089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5657094">data</span><span class="op" id="5657098">,</span>&nbsp;<span class="ident" id="5657100">err</span>&nbsp;<span class="op" id="5657104">:=</span>&nbsp;<span class="ident" id="5657107">ioutil</span><span class="op" id="5657113">.</span><span class="ident" id="5657114">ReadFile</span><span class="op" id="5657122">(</span><span class="ident" id="5657123">file</span><span class="op" id="5657127">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5657132">if</span>&nbsp;<span class="ident" id="5657135">err</span>&nbsp;<span class="op" id="5657139">!=</span>&nbsp;<span class="ident" id="5657142">nil</span>&nbsp;<span class="op" id="5657146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5657152">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5657164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5657169">lines</span>&nbsp;<span class="op" id="5657175">=</span>&nbsp;<span class="ident" id="5657177">bytes</span><span class="op" id="5657182">.</span><span class="ident" id="5657183">Split</span><span class="op" id="5657188">(</span><span class="ident" id="5657189">data</span><span class="op" id="5657193">,</span>&nbsp;<span class="op" id="5657195">[</span><span class="op" id="5657196">]</span><span class="builtintype" id="5657197">byte</span><span class="op" id="5657201">{</span><span class="string" id="5657202">&#39;\n&#39;</span><span class="op" id="5657206">}</span><span class="op" id="5657207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5657212">lastFile</span>&nbsp;<span class="op" id="5657221">=</span>&nbsp;<span class="ident" id="5657223">file</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5657230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5657234">line</span><span class="op" id="5657238">--</span>&nbsp;<span class="comment" id="5657241">//&nbsp;in&nbsp;stack&nbsp;trace,&nbsp;lines&nbsp;are&nbsp;1-indexed&nbsp;but&nbsp;our&nbsp;array&nbsp;is&nbsp;0-indexed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5657309">fmt</span><span class="op" id="5657312">.</span><span class="ident" id="5657313">Fprintf</span><span class="op" id="5657320">(</span><span class="ident" id="5657321">buf</span><span class="op" id="5657324">,</span>&nbsp;<span class="string" id="5657326">&#34;\t%s:&nbsp;%s\n&#34;</span><span class="op" id="5657338">,</span>&nbsp;<span class="ident" id="5657340">function</span><span class="op" id="5657348">(</span><span class="ident" id="5657349">pc</span><span class="op" id="5657351">)</span><span class="op" id="5657352">,</span>&nbsp;<span class="ident" id="5657354">source</span><span class="op" id="5657360">(</span><span class="ident" id="5657361">lines</span><span class="op" id="5657366">,</span>&nbsp;<span class="ident" id="5657368">line</span><span class="op" id="5657372">)</span><span class="op" id="5657373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5657376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5657379">return</span>&nbsp;<span class="ident" id="5657386">buf</span><span class="op" id="5657389">.</span><span class="ident" id="5657390">Bytes</span><span class="op" id="5657395">(</span><span class="op" id="5657396">)</span><br>
<span class="lineno">65</span><span class="op" id="5657398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5657401">//&nbsp;source&nbsp;returns&nbsp;a&nbsp;space-trimmed&nbsp;slice&nbsp;of&nbsp;the&nbsp;n&#39;th&nbsp;line.</span><br>
<span class="lineno"></span><span class="keyword" id="5657459">func</span>&nbsp;<span class="ident" id="5657464">source</span><span class="op" id="5657470">(</span><span class="ident" id="5657471">lines</span>&nbsp;<span class="op" id="5657477">[</span><span class="op" id="5657478">]</span><span class="op" id="5657479">[</span><span class="op" id="5657480">]</span><span class="builtintype" id="5657481">byte</span><span class="op" id="5657485">,</span>&nbsp;<span class="ident" id="5657487">n</span>&nbsp;<span class="builtintype" id="5657489">int</span><span class="op" id="5657492">)</span>&nbsp;<span class="op" id="5657494">[</span><span class="op" id="5657495">]</span><span class="builtintype" id="5657496">byte</span>&nbsp;<span class="op" id="5657501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5657504">if</span>&nbsp;<span class="ident" id="5657507">n</span>&nbsp;<span class="op" id="5657509">&lt;</span>&nbsp;<span class="num" id="5657511">0</span>&nbsp;<span class="op" id="5657513">||</span>&nbsp;<span class="ident" id="5657516">n</span>&nbsp;<span class="op" id="5657518">&gt;=</span>&nbsp;<span class="builtinfunc" id="5657521">len</span><span class="op" id="5657524">(</span><span class="ident" id="5657525">lines</span><span class="op" id="5657530">)</span>&nbsp;<span class="op" id="5657532">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5657536">return</span>&nbsp;<span class="ident" id="5657543">dunno</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5657550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5657553">return</span>&nbsp;<span class="ident" id="5657560">bytes</span><span class="op" id="5657565">.</span><span class="ident" id="5657566">Trim</span><span class="op" id="5657570">(</span><span class="ident" id="5657571">lines</span><span class="op" id="5657576">[</span><span class="ident" id="5657577">n</span><span class="op" id="5657578">]</span><span class="op" id="5657579">,</span>&nbsp;<span class="string" id="5657581">&#34;&nbsp;\t&#34;</span><span class="op" id="5657586">)</span><br>
<span class="lineno"></span><span class="op" id="5657588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="5657591">//&nbsp;function&nbsp;returns,&nbsp;if&nbsp;possible,&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;function&nbsp;containing&nbsp;the&nbsp;PC.</span><br>
<span class="lineno"></span><span class="keyword" id="5657669">func</span>&nbsp;<span class="ident" id="5657674">function</span><span class="op" id="5657682">(</span><span class="ident" id="5657683">pc</span>&nbsp;<span class="builtintype" id="5657686">uintptr</span><span class="op" id="5657693">)</span>&nbsp;<span class="op" id="5657695">[</span><span class="op" id="5657696">]</span><span class="builtintype" id="5657697">byte</span>&nbsp;<span class="op" id="5657702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5657705">fn</span>&nbsp;<span class="op" id="5657708">:=</span>&nbsp;<span class="ident" id="5657711">runtime</span><span class="op" id="5657718">.</span><span class="ident" id="5657719">FuncForPC</span><span class="op" id="5657728">(</span><span class="ident" id="5657729">pc</span><span class="op" id="5657731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5657734">if</span>&nbsp;<span class="ident" id="5657737">fn</span>&nbsp;<span class="op" id="5657740">==</span>&nbsp;<span class="ident" id="5657743">nil</span>&nbsp;<span class="op" id="5657747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5657751">return</span>&nbsp;<span class="ident" id="5657758">dunno</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5657765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5657768">name</span>&nbsp;<span class="op" id="5657773">:=</span>&nbsp;<span class="op" id="5657776">[</span><span class="op" id="5657777">]</span><span class="builtintype" id="5657778">byte</span><span class="op" id="5657782">(</span><span class="ident" id="5657783">fn</span><span class="op" id="5657785">.</span><span class="ident" id="5657786">Name</span><span class="op" id="5657790">(</span><span class="op" id="5657791">)</span><span class="op" id="5657792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5657795">//&nbsp;The&nbsp;name&nbsp;includes&nbsp;the&nbsp;path&nbsp;name&nbsp;to&nbsp;the&nbsp;package,&nbsp;which&nbsp;is&nbsp;unnecessary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5657868">//&nbsp;since&nbsp;the&nbsp;file&nbsp;name&nbsp;is&nbsp;already&nbsp;included.&nbsp;&nbsp;Plus,&nbsp;it&nbsp;has&nbsp;center&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5657940">//&nbsp;That&nbsp;is,&nbsp;we&nbsp;see</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5657960">//&nbsp;&nbsp;&nbsp;&nbsp;runtime/debug.*T·ptrmethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5657992">//&nbsp;and&nbsp;want</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5658005">//&nbsp;&nbsp;&nbsp;&nbsp;*T.ptrmethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5658022">//&nbsp;Since&nbsp;the&nbsp;package&nbsp;path&nbsp;might&nbsp;contains&nbsp;dots&nbsp;(e.g.&nbsp;code.google.com/...),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5658097">//&nbsp;we&nbsp;first&nbsp;remove&nbsp;the&nbsp;path&nbsp;prefix&nbsp;if&nbsp;there&nbsp;is&nbsp;one.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5658150">if</span>&nbsp;<span class="ident" id="5658153">lastslash</span>&nbsp;<span class="op" id="5658163">:=</span>&nbsp;<span class="ident" id="5658166">bytes</span><span class="op" id="5658171">.</span><span class="ident" id="5658172">LastIndex</span><span class="op" id="5658181">(</span><span class="ident" id="5658182">name</span><span class="op" id="5658186">,</span>&nbsp;<span class="ident" id="5658188">slash</span><span class="op" id="5658193">)</span><span class="op" id="5658194">;</span>&nbsp;<span class="ident" id="5658196">lastslash</span>&nbsp;<span class="op" id="5658206">&gt;=</span>&nbsp;<span class="num" id="5658209">0</span>&nbsp;<span class="op" id="5658211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5658215">name</span>&nbsp;<span class="op" id="5658220">=</span>&nbsp;<span class="ident" id="5658222">name</span><span class="op" id="5658226">[</span><span class="ident" id="5658227">lastslash</span><span class="op" id="5658236">+</span><span class="num" id="5658237">1</span><span class="op" id="5658238">:</span><span class="op" id="5658239">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5658242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5658245">if</span>&nbsp;<span class="ident" id="5658248">period</span>&nbsp;<span class="op" id="5658255">:=</span>&nbsp;<span class="ident" id="5658258">bytes</span><span class="op" id="5658263">.</span><span class="ident" id="5658264">Index</span><span class="op" id="5658269">(</span><span class="ident" id="5658270">name</span><span class="op" id="5658274">,</span>&nbsp;<span class="ident" id="5658276">dot</span><span class="op" id="5658279">)</span><span class="op" id="5658280">;</span>&nbsp;<span class="ident" id="5658282">period</span>&nbsp;<span class="op" id="5658289">&gt;=</span>&nbsp;<span class="num" id="5658292">0</span>&nbsp;<span class="op" id="5658294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5658298">name</span>&nbsp;<span class="op" id="5658303">=</span>&nbsp;<span class="ident" id="5658305">name</span><span class="op" id="5658309">[</span><span class="ident" id="5658310">period</span><span class="op" id="5658316">+</span><span class="num" id="5658317">1</span><span class="op" id="5658318">:</span><span class="op" id="5658319">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5658322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5658325">name</span>&nbsp;<span class="op" id="5658330">=</span>&nbsp;<span class="ident" id="5658332">bytes</span><span class="op" id="5658337">.</span><span class="ident" id="5658338">Replace</span><span class="op" id="5658345">(</span><span class="ident" id="5658346">name</span><span class="op" id="5658350">,</span>&nbsp;<span class="ident" id="5658352">centerDot</span><span class="op" id="5658361">,</span>&nbsp;<span class="ident" id="5658363">dot</span><span class="op" id="5658366">,</span>&nbsp;<span class="op" id="5658368">-</span><span class="num" id="5658369">1</span><span class="op" id="5658370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5658373">return</span>&nbsp;<span class="ident" id="5658380">name</span><br>
<span class="lineno"></span><span class="op" id="5658385">}</span>
</div>
</body>
</html>
