<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rand</h2>
<ul>
<li><a href="/gostd/crypto/rand/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand.go.html">rand.go</a></li>
<li><a href="/gostd/crypto/rand/rand_linux.go.html">rand_linux.go</a></li>
<li><a href="/gostd/crypto/rand/rand_test.go.html">rand_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand_unix.go.html">rand_unix.go</a></li>
<li><a href="/gostd/crypto/rand/util.go.html">util.go</a></li>
<li><a href="/gostd/crypto/rand/util_test.go.html">util_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3829268">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3829324">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3829378">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3829429">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;plan9&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3829505">//&nbsp;Unix&nbsp;cryptographically&nbsp;secure&nbsp;pseudorandom&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="3829558">//&nbsp;generator.</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="3829573">package</span>&nbsp;<span class="ident" id="3829581">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3829587">import</span>&nbsp;<span class="op" id="3829594">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3829597">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3829606">&#34;crypto/aes&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3829620">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3829637">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3829643">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3829649">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3829660">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3829668">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3829675">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3829678">const</span>&nbsp;<span class="ident" id="3829684">urandomDevice</span>&nbsp;<span class="op" id="3829698">=</span>&nbsp;<span class="string" id="3829700">&#34;/dev/urandom&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3829716">//&nbsp;Easy&nbsp;implementation:&nbsp;read&nbsp;from&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><span class="comment" id="3829764">//&nbsp;This&nbsp;is&nbsp;sufficient&nbsp;on&nbsp;Linux,&nbsp;OS&nbsp;X,&nbsp;and&nbsp;FreeBSD.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3829816">func</span>&nbsp;<span class="ident" id="3829821">init</span><span class="op" id="3829825">(</span><span class="op" id="3829826">)</span>&nbsp;<span class="op" id="3829828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3829831">if</span>&nbsp;<span class="ident" id="3829834">runtime</span><span class="op" id="3829841">.</span><span class="ident" id="3829842">GOOS</span>&nbsp;<span class="op" id="3829847">==</span>&nbsp;<span class="string" id="3829850">&#34;plan9&#34;</span>&nbsp;<span class="op" id="3829858">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829862">Reader</span>&nbsp;<span class="op" id="3829869">=</span>&nbsp;<span class="ident" id="3829871">newReader</span><span class="op" id="3829880">(</span><span class="ident" id="3829881">nil</span><span class="op" id="3829884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3829887">}</span>&nbsp;<span class="keyword" id="3829889">else</span>&nbsp;<span class="op" id="3829894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829898">Reader</span>&nbsp;<span class="op" id="3829905">=</span>&nbsp;<span class="op" id="3829907">&amp;</span><span class="ident" id="3829908">devReader</span><span class="op" id="3829917">{</span><span class="ident" id="3829918">name</span><span class="op" id="3829922">:</span>&nbsp;<span class="ident" id="3829924">urandomDevice</span><span class="op" id="3829937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3829940">}</span><br>
<span class="lineno"></span><span class="op" id="3829942">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3829945">//&nbsp;A&nbsp;devReader&nbsp;satisfies&nbsp;reads&nbsp;by&nbsp;reading&nbsp;the&nbsp;file&nbsp;named&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3830008">type</span>&nbsp;<span class="ident" id="3830013">devReader</span>&nbsp;<span class="keyword" id="3830023">struct</span>&nbsp;<span class="op" id="3830030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830033">name</span>&nbsp;<span class="builtintype" id="3830038">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830046">f</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3830051">io</span><span class="op" id="3830053">.</span><span class="ident" id="3830054">Reader</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830062">mu</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3830067">sync</span><span class="op" id="3830071">.</span><span class="ident" id="3830072">Mutex</span><br>
<span class="lineno"></span><span class="op" id="3830078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3830081">//&nbsp;altGetRandom&nbsp;if&nbsp;non-nil&nbsp;specifies&nbsp;an&nbsp;OS-specific&nbsp;function&nbsp;to&nbsp;get</span><br>
<span class="lineno"></span><span class="comment" id="3830149">//&nbsp;urandom-style&nbsp;randomness.</span><br>
<span class="lineno">45</span><span class="keyword" id="3830178">var</span>&nbsp;<span class="ident" id="3830182">altGetRandom</span>&nbsp;<span class="keyword" id="3830195">func</span><span class="op" id="3830199">(</span><span class="op" id="3830200">[</span><span class="op" id="3830201">]</span><span class="builtintype" id="3830202">byte</span><span class="op" id="3830206">)</span>&nbsp;<span class="op" id="3830208">(</span><span class="ident" id="3830209">ok</span>&nbsp;<span class="builtintype" id="3830212">bool</span><span class="op" id="3830216">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3830219">func</span>&nbsp;<span class="op" id="3830224">(</span><span class="ident" id="3830225">r</span>&nbsp;<span class="op" id="3830227">*</span><span class="ident" id="3830228">devReader</span><span class="op" id="3830237">)</span>&nbsp;<span class="ident" id="3830239">Read</span><span class="op" id="3830243">(</span><span class="ident" id="3830244">b</span>&nbsp;<span class="op" id="3830246">[</span><span class="op" id="3830247">]</span><span class="builtintype" id="3830248">byte</span><span class="op" id="3830252">)</span>&nbsp;<span class="op" id="3830254">(</span><span class="ident" id="3830255">n</span>&nbsp;<span class="builtintype" id="3830257">int</span><span class="op" id="3830260">,</span>&nbsp;<span class="ident" id="3830262">err</span>&nbsp;<span class="builtintype" id="3830266">error</span><span class="op" id="3830271">)</span>&nbsp;<span class="op" id="3830273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3830276">if</span>&nbsp;<span class="ident" id="3830279">altGetRandom</span>&nbsp;<span class="op" id="3830292">!=</span>&nbsp;<span class="ident" id="3830295">nil</span>&nbsp;<span class="op" id="3830299">&amp;&amp;</span>&nbsp;<span class="ident" id="3830302">r</span><span class="op" id="3830303">.</span><span class="ident" id="3830304">name</span>&nbsp;<span class="op" id="3830309">==</span>&nbsp;<span class="ident" id="3830312">urandomDevice</span>&nbsp;<span class="op" id="3830326">&amp;&amp;</span>&nbsp;<span class="ident" id="3830329">altGetRandom</span><span class="op" id="3830341">(</span><span class="ident" id="3830342">b</span><span class="op" id="3830343">)</span>&nbsp;<span class="op" id="3830345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3830349">return</span>&nbsp;<span class="builtinfunc" id="3830356">len</span><span class="op" id="3830359">(</span><span class="ident" id="3830360">b</span><span class="op" id="3830361">)</span><span class="op" id="3830362">,</span>&nbsp;<span class="ident" id="3830364">nil</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3830369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830372">r</span><span class="op" id="3830373">.</span><span class="ident" id="3830374">mu</span><span class="op" id="3830376">.</span><span class="ident" id="3830377">Lock</span><span class="op" id="3830381">(</span><span class="op" id="3830382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3830385">defer</span>&nbsp;<span class="ident" id="3830391">r</span><span class="op" id="3830392">.</span><span class="ident" id="3830393">mu</span><span class="op" id="3830395">.</span><span class="ident" id="3830396">Unlock</span><span class="op" id="3830402">(</span><span class="op" id="3830403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3830406">if</span>&nbsp;<span class="ident" id="3830409">r</span><span class="op" id="3830410">.</span><span class="ident" id="3830411">f</span>&nbsp;<span class="op" id="3830413">==</span>&nbsp;<span class="ident" id="3830416">nil</span>&nbsp;<span class="op" id="3830420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830424">f</span><span class="op" id="3830425">,</span>&nbsp;<span class="ident" id="3830427">err</span>&nbsp;<span class="op" id="3830431">:=</span>&nbsp;<span class="ident" id="3830434">os</span><span class="op" id="3830436">.</span><span class="ident" id="3830437">Open</span><span class="op" id="3830441">(</span><span class="ident" id="3830442">r</span><span class="op" id="3830443">.</span><span class="ident" id="3830444">name</span><span class="op" id="3830448">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3830452">if</span>&nbsp;<span class="ident" id="3830455">f</span>&nbsp;<span class="op" id="3830457">==</span>&nbsp;<span class="ident" id="3830460">nil</span>&nbsp;<span class="op" id="3830464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3830469">return</span>&nbsp;<span class="num" id="3830476">0</span><span class="op" id="3830477">,</span>&nbsp;<span class="ident" id="3830479">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3830485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3830489">if</span>&nbsp;<span class="ident" id="3830492">runtime</span><span class="op" id="3830499">.</span><span class="ident" id="3830500">GOOS</span>&nbsp;<span class="op" id="3830505">==</span>&nbsp;<span class="string" id="3830508">&#34;plan9&#34;</span>&nbsp;<span class="op" id="3830516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830521">r</span><span class="op" id="3830522">.</span><span class="ident" id="3830523">f</span>&nbsp;<span class="op" id="3830525">=</span>&nbsp;<span class="ident" id="3830527">f</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3830531">}</span>&nbsp;<span class="keyword" id="3830533">else</span>&nbsp;<span class="op" id="3830538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830543">r</span><span class="op" id="3830544">.</span><span class="ident" id="3830545">f</span>&nbsp;<span class="op" id="3830547">=</span>&nbsp;<span class="ident" id="3830549">bufio</span><span class="op" id="3830554">.</span><span class="ident" id="3830555">NewReader</span><span class="op" id="3830564">(</span><span class="ident" id="3830565">f</span><span class="op" id="3830566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3830570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3830573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3830576">return</span>&nbsp;<span class="ident" id="3830583">r</span><span class="op" id="3830584">.</span><span class="ident" id="3830585">f</span><span class="op" id="3830586">.</span><span class="ident" id="3830587">Read</span><span class="op" id="3830591">(</span><span class="ident" id="3830592">b</span><span class="op" id="3830593">)</span><br>
<span class="lineno">65</span><span class="op" id="3830595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3830598">//&nbsp;Alternate&nbsp;pseudo-random&nbsp;implementation&nbsp;for&nbsp;use&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="3830651">//&nbsp;systems&nbsp;without&nbsp;a&nbsp;reliable&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="3830696">//&nbsp;newReader&nbsp;returns&nbsp;a&nbsp;new&nbsp;pseudorandom&nbsp;generator&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3830751">//&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;entropy.&nbsp;&nbsp;If&nbsp;entropy&nbsp;==&nbsp;nil,</span><br>
<span class="lineno"></span><span class="comment" id="3830812">//&nbsp;the&nbsp;generator&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;the&nbsp;system&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3830871">//&nbsp;random&nbsp;number&nbsp;generator,&nbsp;typically&nbsp;/dev/random.</span><br>
<span class="lineno"></span><span class="comment" id="3830922">//&nbsp;The&nbsp;Read&nbsp;method&nbsp;on&nbsp;the&nbsp;returned&nbsp;reader&nbsp;always&nbsp;returns</span><br>
<span class="lineno">75</span><span class="comment" id="3830979">//&nbsp;the&nbsp;full&nbsp;amount&nbsp;asked&nbsp;for,&nbsp;or&nbsp;else&nbsp;it&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3831038">//</span><br>
<span class="lineno"></span><span class="comment" id="3831041">//&nbsp;The&nbsp;generator&nbsp;uses&nbsp;the&nbsp;X9.31&nbsp;algorithm&nbsp;with&nbsp;AES-128,</span><br>
<span class="lineno"></span><span class="comment" id="3831097">//&nbsp;reseeding&nbsp;after&nbsp;every&nbsp;1&nbsp;MB&nbsp;of&nbsp;generated&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3831146">func</span>&nbsp;<span class="ident" id="3831151">newReader</span><span class="op" id="3831160">(</span><span class="ident" id="3831161">entropy</span>&nbsp;<span class="ident" id="3831169">io</span><span class="op" id="3831171">.</span><span class="ident" id="3831172">Reader</span><span class="op" id="3831178">)</span>&nbsp;<span class="ident" id="3831180">io</span><span class="op" id="3831182">.</span><span class="ident" id="3831183">Reader</span>&nbsp;<span class="op" id="3831190">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831193">if</span>&nbsp;<span class="ident" id="3831196">entropy</span>&nbsp;<span class="op" id="3831204">==</span>&nbsp;<span class="ident" id="3831207">nil</span>&nbsp;<span class="op" id="3831211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831215">entropy</span>&nbsp;<span class="op" id="3831223">=</span>&nbsp;<span class="op" id="3831225">&amp;</span><span class="ident" id="3831226">devReader</span><span class="op" id="3831235">{</span><span class="ident" id="3831236">name</span><span class="op" id="3831240">:</span>&nbsp;<span class="string" id="3831242">&#34;/dev/random&#34;</span><span class="op" id="3831255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3831258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831261">return</span>&nbsp;<span class="op" id="3831268">&amp;</span><span class="ident" id="3831269">reader</span><span class="op" id="3831275">{</span><span class="ident" id="3831276">entropy</span><span class="op" id="3831283">:</span>&nbsp;<span class="ident" id="3831285">entropy</span><span class="op" id="3831292">}</span><br>
<span class="lineno"></span><span class="op" id="3831294">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="3831297">type</span>&nbsp;<span class="ident" id="3831302">reader</span>&nbsp;<span class="keyword" id="3831309">struct</span>&nbsp;<span class="op" id="3831316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831319">mu</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3831340">sync</span><span class="op" id="3831344">.</span><span class="ident" id="3831345">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831352">budget</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3831373">int</span>&nbsp;<span class="comment" id="3831377">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;that&nbsp;can&nbsp;be&nbsp;generated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831419">cipher</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3831440">cipher</span><span class="op" id="3831446">.</span><span class="ident" id="3831447">Block</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831454">entropy</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3831475">io</span><span class="op" id="3831477">.</span><span class="ident" id="3831478">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831486">time</span><span class="op" id="3831490">,</span>&nbsp;<span class="ident" id="3831492">seed</span><span class="op" id="3831496">,</span>&nbsp;<span class="ident" id="3831498">dst</span><span class="op" id="3831501">,</span>&nbsp;<span class="ident" id="3831503">key</span>&nbsp;<span class="op" id="3831507">[</span><span class="ident" id="3831508">aes</span><span class="op" id="3831511">.</span><span class="ident" id="3831512">BlockSize</span><span class="op" id="3831521">]</span><span class="builtintype" id="3831522">byte</span><br>
<span class="lineno"></span><span class="op" id="3831527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3831530">func</span>&nbsp;<span class="op" id="3831535">(</span><span class="ident" id="3831536">r</span>&nbsp;<span class="op" id="3831538">*</span><span class="ident" id="3831539">reader</span><span class="op" id="3831545">)</span>&nbsp;<span class="ident" id="3831547">Read</span><span class="op" id="3831551">(</span><span class="ident" id="3831552">b</span>&nbsp;<span class="op" id="3831554">[</span><span class="op" id="3831555">]</span><span class="builtintype" id="3831556">byte</span><span class="op" id="3831560">)</span>&nbsp;<span class="op" id="3831562">(</span><span class="ident" id="3831563">n</span>&nbsp;<span class="builtintype" id="3831565">int</span><span class="op" id="3831568">,</span>&nbsp;<span class="ident" id="3831570">err</span>&nbsp;<span class="builtintype" id="3831574">error</span><span class="op" id="3831579">)</span>&nbsp;<span class="op" id="3831581">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831584">r</span><span class="op" id="3831585">.</span><span class="ident" id="3831586">mu</span><span class="op" id="3831588">.</span><span class="ident" id="3831589">Lock</span><span class="op" id="3831593">(</span><span class="op" id="3831594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831597">defer</span>&nbsp;<span class="ident" id="3831603">r</span><span class="op" id="3831604">.</span><span class="ident" id="3831605">mu</span><span class="op" id="3831607">.</span><span class="ident" id="3831608">Unlock</span><span class="op" id="3831614">(</span><span class="op" id="3831615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831618">n</span>&nbsp;<span class="op" id="3831620">=</span>&nbsp;<span class="builtinfunc" id="3831622">len</span><span class="op" id="3831625">(</span><span class="ident" id="3831626">b</span><span class="op" id="3831627">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831631">for</span>&nbsp;<span class="builtinfunc" id="3831635">len</span><span class="op" id="3831638">(</span><span class="ident" id="3831639">b</span><span class="op" id="3831640">)</span>&nbsp;<span class="op" id="3831642">&gt;</span>&nbsp;<span class="num" id="3831644">0</span>&nbsp;<span class="op" id="3831646">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831650">if</span>&nbsp;<span class="ident" id="3831653">r</span><span class="op" id="3831654">.</span><span class="ident" id="3831655">budget</span>&nbsp;<span class="op" id="3831662">==</span>&nbsp;<span class="num" id="3831665">0</span>&nbsp;<span class="op" id="3831667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831672">_</span><span class="op" id="3831673">,</span>&nbsp;<span class="ident" id="3831675">err</span>&nbsp;<span class="op" id="3831679">:=</span>&nbsp;<span class="ident" id="3831682">io</span><span class="op" id="3831684">.</span><span class="ident" id="3831685">ReadFull</span><span class="op" id="3831693">(</span><span class="ident" id="3831694">r</span><span class="op" id="3831695">.</span><span class="ident" id="3831696">entropy</span><span class="op" id="3831703">,</span>&nbsp;<span class="ident" id="3831705">r</span><span class="op" id="3831706">.</span><span class="ident" id="3831707">seed</span><span class="op" id="3831711">[</span><span class="num" id="3831712">0</span><span class="op" id="3831713">:</span><span class="op" id="3831714">]</span><span class="op" id="3831715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831720">if</span>&nbsp;<span class="ident" id="3831723">err</span>&nbsp;<span class="op" id="3831727">!=</span>&nbsp;<span class="ident" id="3831730">nil</span>&nbsp;<span class="op" id="3831734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831740">return</span>&nbsp;<span class="ident" id="3831747">n</span>&nbsp;<span class="op" id="3831749">-</span>&nbsp;<span class="builtinfunc" id="3831751">len</span><span class="op" id="3831754">(</span><span class="ident" id="3831755">b</span><span class="op" id="3831756">)</span><span class="op" id="3831757">,</span>&nbsp;<span class="ident" id="3831759">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3831766">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831771">_</span><span class="op" id="3831772">,</span>&nbsp;<span class="ident" id="3831774">err</span>&nbsp;<span class="op" id="3831778">=</span>&nbsp;<span class="ident" id="3831780">io</span><span class="op" id="3831782">.</span><span class="ident" id="3831783">ReadFull</span><span class="op" id="3831791">(</span><span class="ident" id="3831792">r</span><span class="op" id="3831793">.</span><span class="ident" id="3831794">entropy</span><span class="op" id="3831801">,</span>&nbsp;<span class="ident" id="3831803">r</span><span class="op" id="3831804">.</span><span class="ident" id="3831805">key</span><span class="op" id="3831808">[</span><span class="num" id="3831809">0</span><span class="op" id="3831810">:</span><span class="op" id="3831811">]</span><span class="op" id="3831812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831817">if</span>&nbsp;<span class="ident" id="3831820">err</span>&nbsp;<span class="op" id="3831824">!=</span>&nbsp;<span class="ident" id="3831827">nil</span>&nbsp;<span class="op" id="3831831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831837">return</span>&nbsp;<span class="ident" id="3831844">n</span>&nbsp;<span class="op" id="3831846">-</span>&nbsp;<span class="builtinfunc" id="3831848">len</span><span class="op" id="3831851">(</span><span class="ident" id="3831852">b</span><span class="op" id="3831853">)</span><span class="op" id="3831854">,</span>&nbsp;<span class="ident" id="3831856">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3831863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831868">r</span><span class="op" id="3831869">.</span><span class="ident" id="3831870">cipher</span><span class="op" id="3831876">,</span>&nbsp;<span class="ident" id="3831878">err</span>&nbsp;<span class="op" id="3831882">=</span>&nbsp;<span class="ident" id="3831884">aes</span><span class="op" id="3831887">.</span><span class="ident" id="3831888">NewCipher</span><span class="op" id="3831897">(</span><span class="ident" id="3831898">r</span><span class="op" id="3831899">.</span><span class="ident" id="3831900">key</span><span class="op" id="3831903">[</span><span class="num" id="3831904">0</span><span class="op" id="3831905">:</span><span class="op" id="3831906">]</span><span class="op" id="3831907">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831912">if</span>&nbsp;<span class="ident" id="3831915">err</span>&nbsp;<span class="op" id="3831919">!=</span>&nbsp;<span class="ident" id="3831922">nil</span>&nbsp;<span class="op" id="3831926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831932">return</span>&nbsp;<span class="ident" id="3831939">n</span>&nbsp;<span class="op" id="3831941">-</span>&nbsp;<span class="builtinfunc" id="3831943">len</span><span class="op" id="3831946">(</span><span class="ident" id="3831947">b</span><span class="op" id="3831948">)</span><span class="op" id="3831949">,</span>&nbsp;<span class="ident" id="3831951">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3831958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831963">r</span><span class="op" id="3831964">.</span><span class="ident" id="3831965">budget</span>&nbsp;<span class="op" id="3831972">=</span>&nbsp;<span class="num" id="3831974">1</span>&nbsp;<span class="op" id="3831976">&lt;&lt;</span>&nbsp;<span class="num" id="3831979">20</span>&nbsp;<span class="comment" id="3831982">//&nbsp;reseed&nbsp;after&nbsp;generating&nbsp;1MB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3832015">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832019">r</span><span class="op" id="3832020">.</span><span class="ident" id="3832021">budget</span>&nbsp;<span class="op" id="3832028">-=</span>&nbsp;<span class="ident" id="3832031">aes</span><span class="op" id="3832034">.</span><span class="ident" id="3832035">BlockSize</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832048">//&nbsp;ANSI&nbsp;X9.31&nbsp;(==&nbsp;X9.17)&nbsp;algorithm,&nbsp;but&nbsp;using&nbsp;AES&nbsp;in&nbsp;place&nbsp;of&nbsp;3DES.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832118">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832123">//&nbsp;single&nbsp;block:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832142">//&nbsp;t&nbsp;=&nbsp;encrypt(time)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832165">//&nbsp;dst&nbsp;=&nbsp;encrypt(t^seed)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832192">//&nbsp;seed&nbsp;=&nbsp;encrypt(t^dst)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832219">ns</span>&nbsp;<span class="op" id="3832222">:=</span>&nbsp;<span class="ident" id="3832225">time</span><span class="op" id="3832229">.</span><span class="ident" id="3832230">Now</span><span class="op" id="3832233">(</span><span class="op" id="3832234">)</span><span class="op" id="3832235">.</span><span class="ident" id="3832236">UnixNano</span><span class="op" id="3832244">(</span><span class="op" id="3832245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832249">r</span><span class="op" id="3832250">.</span><span class="ident" id="3832251">time</span><span class="op" id="3832255">[</span><span class="num" id="3832256">0</span><span class="op" id="3832257">]</span>&nbsp;<span class="op" id="3832259">=</span>&nbsp;<span class="builtintype" id="3832261">byte</span><span class="op" id="3832265">(</span><span class="ident" id="3832266">ns</span>&nbsp;<span class="op" id="3832269">&gt;&gt;</span>&nbsp;<span class="num" id="3832272">56</span><span class="op" id="3832274">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832278">r</span><span class="op" id="3832279">.</span><span class="ident" id="3832280">time</span><span class="op" id="3832284">[</span><span class="num" id="3832285">1</span><span class="op" id="3832286">]</span>&nbsp;<span class="op" id="3832288">=</span>&nbsp;<span class="builtintype" id="3832290">byte</span><span class="op" id="3832294">(</span><span class="ident" id="3832295">ns</span>&nbsp;<span class="op" id="3832298">&gt;&gt;</span>&nbsp;<span class="num" id="3832301">48</span><span class="op" id="3832303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832307">r</span><span class="op" id="3832308">.</span><span class="ident" id="3832309">time</span><span class="op" id="3832313">[</span><span class="num" id="3832314">2</span><span class="op" id="3832315">]</span>&nbsp;<span class="op" id="3832317">=</span>&nbsp;<span class="builtintype" id="3832319">byte</span><span class="op" id="3832323">(</span><span class="ident" id="3832324">ns</span>&nbsp;<span class="op" id="3832327">&gt;&gt;</span>&nbsp;<span class="num" id="3832330">40</span><span class="op" id="3832332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832336">r</span><span class="op" id="3832337">.</span><span class="ident" id="3832338">time</span><span class="op" id="3832342">[</span><span class="num" id="3832343">3</span><span class="op" id="3832344">]</span>&nbsp;<span class="op" id="3832346">=</span>&nbsp;<span class="builtintype" id="3832348">byte</span><span class="op" id="3832352">(</span><span class="ident" id="3832353">ns</span>&nbsp;<span class="op" id="3832356">&gt;&gt;</span>&nbsp;<span class="num" id="3832359">32</span><span class="op" id="3832361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832365">r</span><span class="op" id="3832366">.</span><span class="ident" id="3832367">time</span><span class="op" id="3832371">[</span><span class="num" id="3832372">4</span><span class="op" id="3832373">]</span>&nbsp;<span class="op" id="3832375">=</span>&nbsp;<span class="builtintype" id="3832377">byte</span><span class="op" id="3832381">(</span><span class="ident" id="3832382">ns</span>&nbsp;<span class="op" id="3832385">&gt;&gt;</span>&nbsp;<span class="num" id="3832388">24</span><span class="op" id="3832390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832394">r</span><span class="op" id="3832395">.</span><span class="ident" id="3832396">time</span><span class="op" id="3832400">[</span><span class="num" id="3832401">5</span><span class="op" id="3832402">]</span>&nbsp;<span class="op" id="3832404">=</span>&nbsp;<span class="builtintype" id="3832406">byte</span><span class="op" id="3832410">(</span><span class="ident" id="3832411">ns</span>&nbsp;<span class="op" id="3832414">&gt;&gt;</span>&nbsp;<span class="num" id="3832417">16</span><span class="op" id="3832419">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832423">r</span><span class="op" id="3832424">.</span><span class="ident" id="3832425">time</span><span class="op" id="3832429">[</span><span class="num" id="3832430">6</span><span class="op" id="3832431">]</span>&nbsp;<span class="op" id="3832433">=</span>&nbsp;<span class="builtintype" id="3832435">byte</span><span class="op" id="3832439">(</span><span class="ident" id="3832440">ns</span>&nbsp;<span class="op" id="3832443">&gt;&gt;</span>&nbsp;<span class="num" id="3832446">8</span><span class="op" id="3832447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832451">r</span><span class="op" id="3832452">.</span><span class="ident" id="3832453">time</span><span class="op" id="3832457">[</span><span class="num" id="3832458">7</span><span class="op" id="3832459">]</span>&nbsp;<span class="op" id="3832461">=</span>&nbsp;<span class="builtintype" id="3832463">byte</span><span class="op" id="3832467">(</span><span class="ident" id="3832468">ns</span><span class="op" id="3832470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832474">r</span><span class="op" id="3832475">.</span><span class="ident" id="3832476">cipher</span><span class="op" id="3832482">.</span><span class="ident" id="3832483">Encrypt</span><span class="op" id="3832490">(</span><span class="ident" id="3832491">r</span><span class="op" id="3832492">.</span><span class="ident" id="3832493">time</span><span class="op" id="3832497">[</span><span class="num" id="3832498">0</span><span class="op" id="3832499">:</span><span class="op" id="3832500">]</span><span class="op" id="3832501">,</span>&nbsp;<span class="ident" id="3832503">r</span><span class="op" id="3832504">.</span><span class="ident" id="3832505">time</span><span class="op" id="3832509">[</span><span class="num" id="3832510">0</span><span class="op" id="3832511">:</span><span class="op" id="3832512">]</span><span class="op" id="3832513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3832517">for</span>&nbsp;<span class="ident" id="3832521">i</span>&nbsp;<span class="op" id="3832523">:=</span>&nbsp;<span class="num" id="3832526">0</span><span class="op" id="3832527">;</span>&nbsp;<span class="ident" id="3832529">i</span>&nbsp;<span class="op" id="3832531">&lt;</span>&nbsp;<span class="ident" id="3832533">aes</span><span class="op" id="3832536">.</span><span class="ident" id="3832537">BlockSize</span><span class="op" id="3832546">;</span>&nbsp;<span class="ident" id="3832548">i</span><span class="op" id="3832549">++</span>&nbsp;<span class="op" id="3832552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832557">r</span><span class="op" id="3832558">.</span><span class="ident" id="3832559">dst</span><span class="op" id="3832562">[</span><span class="ident" id="3832563">i</span><span class="op" id="3832564">]</span>&nbsp;<span class="op" id="3832566">=</span>&nbsp;<span class="ident" id="3832568">r</span><span class="op" id="3832569">.</span><span class="ident" id="3832570">time</span><span class="op" id="3832574">[</span><span class="ident" id="3832575">i</span><span class="op" id="3832576">]</span>&nbsp;<span class="op" id="3832578">^</span>&nbsp;<span class="ident" id="3832580">r</span><span class="op" id="3832581">.</span><span class="ident" id="3832582">seed</span><span class="op" id="3832586">[</span><span class="ident" id="3832587">i</span><span class="op" id="3832588">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3832592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832596">r</span><span class="op" id="3832597">.</span><span class="ident" id="3832598">cipher</span><span class="op" id="3832604">.</span><span class="ident" id="3832605">Encrypt</span><span class="op" id="3832612">(</span><span class="ident" id="3832613">r</span><span class="op" id="3832614">.</span><span class="ident" id="3832615">dst</span><span class="op" id="3832618">[</span><span class="num" id="3832619">0</span><span class="op" id="3832620">:</span><span class="op" id="3832621">]</span><span class="op" id="3832622">,</span>&nbsp;<span class="ident" id="3832624">r</span><span class="op" id="3832625">.</span><span class="ident" id="3832626">dst</span><span class="op" id="3832629">[</span><span class="num" id="3832630">0</span><span class="op" id="3832631">:</span><span class="op" id="3832632">]</span><span class="op" id="3832633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3832637">for</span>&nbsp;<span class="ident" id="3832641">i</span>&nbsp;<span class="op" id="3832643">:=</span>&nbsp;<span class="num" id="3832646">0</span><span class="op" id="3832647">;</span>&nbsp;<span class="ident" id="3832649">i</span>&nbsp;<span class="op" id="3832651">&lt;</span>&nbsp;<span class="ident" id="3832653">aes</span><span class="op" id="3832656">.</span><span class="ident" id="3832657">BlockSize</span><span class="op" id="3832666">;</span>&nbsp;<span class="ident" id="3832668">i</span><span class="op" id="3832669">++</span>&nbsp;<span class="op" id="3832672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832677">r</span><span class="op" id="3832678">.</span><span class="ident" id="3832679">seed</span><span class="op" id="3832683">[</span><span class="ident" id="3832684">i</span><span class="op" id="3832685">]</span>&nbsp;<span class="op" id="3832687">=</span>&nbsp;<span class="ident" id="3832689">r</span><span class="op" id="3832690">.</span><span class="ident" id="3832691">time</span><span class="op" id="3832695">[</span><span class="ident" id="3832696">i</span><span class="op" id="3832697">]</span>&nbsp;<span class="op" id="3832699">^</span>&nbsp;<span class="ident" id="3832701">r</span><span class="op" id="3832702">.</span><span class="ident" id="3832703">dst</span><span class="op" id="3832706">[</span><span class="ident" id="3832707">i</span><span class="op" id="3832708">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3832712">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832716">r</span><span class="op" id="3832717">.</span><span class="ident" id="3832718">cipher</span><span class="op" id="3832724">.</span><span class="ident" id="3832725">Encrypt</span><span class="op" id="3832732">(</span><span class="ident" id="3832733">r</span><span class="op" id="3832734">.</span><span class="ident" id="3832735">seed</span><span class="op" id="3832739">[</span><span class="num" id="3832740">0</span><span class="op" id="3832741">:</span><span class="op" id="3832742">]</span><span class="op" id="3832743">,</span>&nbsp;<span class="ident" id="3832745">r</span><span class="op" id="3832746">.</span><span class="ident" id="3832747">seed</span><span class="op" id="3832751">[</span><span class="num" id="3832752">0</span><span class="op" id="3832753">:</span><span class="op" id="3832754">]</span><span class="op" id="3832755">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832760">m</span>&nbsp;<span class="op" id="3832762">:=</span>&nbsp;<span class="builtinfunc" id="3832765">copy</span><span class="op" id="3832769">(</span><span class="ident" id="3832770">b</span><span class="op" id="3832771">,</span>&nbsp;<span class="ident" id="3832773">r</span><span class="op" id="3832774">.</span><span class="ident" id="3832775">dst</span><span class="op" id="3832778">[</span><span class="num" id="3832779">0</span><span class="op" id="3832780">:</span><span class="op" id="3832781">]</span><span class="op" id="3832782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832786">b</span>&nbsp;<span class="op" id="3832788">=</span>&nbsp;<span class="ident" id="3832790">b</span><span class="op" id="3832791">[</span><span class="ident" id="3832792">m</span><span class="op" id="3832793">:</span><span class="op" id="3832794">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3832797">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3832801">return</span>&nbsp;<span class="ident" id="3832808">n</span><span class="op" id="3832809">,</span>&nbsp;<span class="ident" id="3832811">nil</span><br>
<span class="lineno"></span><span class="op" id="3832815">}</span>
</div>
</body>
</html>
