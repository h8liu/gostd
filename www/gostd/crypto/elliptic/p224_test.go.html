<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html" class="current">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7092749">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7092805">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7092859">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7092910">package</span>&nbsp;<span class="ident" id="7092918">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7092928">import</span>&nbsp;<span class="op" id="7092935">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7092938">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7092950">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="7092960">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7092963">var</span>&nbsp;<span class="ident" id="7092967">toFromBigTests</span>&nbsp;<span class="op" id="7092982">=</span>&nbsp;<span class="op" id="7092984">[</span><span class="op" id="7092985">]</span><span class="builtintype" id="7092986">string</span><span class="op" id="7092992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7092995">&#34;0&#34;</span><span class="op" id="7092998">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7093001">&#34;1&#34;</span><span class="op" id="7093004">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7093007">&#34;23&#34;</span><span class="op" id="7093011">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7093014">&#34;b70e0cb46bb4bf7f321390b94a03c1d356c01122343280d6105c1d21&#34;</span><span class="op" id="7093072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7093075">&#34;706a46d476dcb76798e6046d89474788d164c18032d268fd10704fa6&#34;</span><span class="op" id="7093133">,</span><br>
<span class="lineno"></span><span class="op" id="7093135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="7093138">func</span>&nbsp;<span class="ident" id="7093143">p224AlternativeToBig</span><span class="op" id="7093163">(</span><span class="ident" id="7093164">in</span>&nbsp;<span class="op" id="7093167">*</span><span class="ident" id="7093168">p224FieldElement</span><span class="op" id="7093184">)</span>&nbsp;<span class="op" id="7093186">*</span><span class="ident" id="7093187">big</span><span class="op" id="7093190">.</span><span class="ident" id="7093191">Int</span>&nbsp;<span class="op" id="7093195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7093198">ret</span>&nbsp;<span class="op" id="7093202">:=</span>&nbsp;<span class="builtinfunc" id="7093205">new</span><span class="op" id="7093208">(</span><span class="ident" id="7093209">big</span><span class="op" id="7093212">.</span><span class="ident" id="7093213">Int</span><span class="op" id="7093216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7093219">tmp</span>&nbsp;<span class="op" id="7093223">:=</span>&nbsp;<span class="builtinfunc" id="7093226">new</span><span class="op" id="7093229">(</span><span class="ident" id="7093230">big</span><span class="op" id="7093233">.</span><span class="ident" id="7093234">Int</span><span class="op" id="7093237">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7093241">for</span>&nbsp;<span class="ident" id="7093245">i</span>&nbsp;<span class="op" id="7093247">:=</span>&nbsp;<span class="builtintype" id="7093250">uint</span><span class="op" id="7093254">(</span><span class="num" id="7093255">0</span><span class="op" id="7093256">)</span><span class="op" id="7093257">;</span>&nbsp;<span class="ident" id="7093259">i</span>&nbsp;<span class="op" id="7093261">&lt;</span>&nbsp;<span class="num" id="7093263">8</span><span class="op" id="7093264">;</span>&nbsp;<span class="ident" id="7093266">i</span><span class="op" id="7093267">++</span>&nbsp;<span class="op" id="7093270">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7093274">tmp</span><span class="op" id="7093277">.</span><span class="ident" id="7093278">SetInt64</span><span class="op" id="7093286">(</span><span class="ident" id="7093287">int64</span><span class="op" id="7093292">(</span><span class="ident" id="7093293">in</span><span class="op" id="7093295">[</span><span class="ident" id="7093296">i</span><span class="op" id="7093297">]</span><span class="op" id="7093298">)</span><span class="op" id="7093299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7093303">tmp</span><span class="op" id="7093306">.</span><span class="ident" id="7093307">Lsh</span><span class="op" id="7093310">(</span><span class="ident" id="7093311">tmp</span><span class="op" id="7093314">,</span>&nbsp;<span class="num" id="7093316">28</span><span class="op" id="7093318">*</span><span class="ident" id="7093319">i</span><span class="op" id="7093320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7093324">ret</span><span class="op" id="7093327">.</span><span class="ident" id="7093328">Add</span><span class="op" id="7093331">(</span><span class="ident" id="7093332">ret</span><span class="op" id="7093335">,</span>&nbsp;<span class="ident" id="7093337">tmp</span><span class="op" id="7093340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7093343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7093346">ret</span><span class="op" id="7093349">.</span><span class="ident" id="7093350">Mod</span><span class="op" id="7093353">(</span><span class="ident" id="7093354">ret</span><span class="op" id="7093357">,</span>&nbsp;<span class="ident" id="7093359">p224</span><span class="op" id="7093363">.</span><span class="ident" id="7093364">P</span><span class="op" id="7093365">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7093368">return</span>&nbsp;<span class="ident" id="7093375">ret</span><br>
<span class="lineno"></span><span class="op" id="7093379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7093382">func</span>&nbsp;<span class="ident" id="7093387">TestToFromBig</span><span class="op" id="7093400">(</span><span class="ident" id="7093401">t</span>&nbsp;<span class="op" id="7093403">*</span><span class="ident" id="7093404">testing</span><span class="op" id="7093411">.</span><span class="ident" id="7093412">T</span><span class="op" id="7093413">)</span>&nbsp;<span class="op" id="7093415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7093418">for</span>&nbsp;<span class="ident" id="7093422">i</span><span class="op" id="7093423">,</span>&nbsp;<span class="ident" id="7093425">test</span>&nbsp;<span class="op" id="7093430">:=</span>&nbsp;<span class="keyword" id="7093433">range</span>&nbsp;<span class="ident" id="7093439">toFromBigTests</span>&nbsp;<span class="op" id="7093454">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7093458">n</span><span class="op" id="7093459">,</span>&nbsp;<span class="ident" id="7093461">_</span>&nbsp;<span class="op" id="7093463">:=</span>&nbsp;<span class="builtinfunc" id="7093466">new</span><span class="op" id="7093469">(</span><span class="ident" id="7093470">big</span><span class="op" id="7093473">.</span><span class="ident" id="7093474">Int</span><span class="op" id="7093477">)</span><span class="op" id="7093478">.</span><span class="ident" id="7093479">SetString</span><span class="op" id="7093488">(</span><span class="ident" id="7093489">test</span><span class="op" id="7093493">,</span>&nbsp;<span class="num" id="7093495">16</span><span class="op" id="7093497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7093501">var</span>&nbsp;<span class="ident" id="7093505">x</span>&nbsp;<span class="ident" id="7093507">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7093526">p224FromBig</span><span class="op" id="7093537">(</span><span class="op" id="7093538">&amp;</span><span class="ident" id="7093539">x</span><span class="op" id="7093540">,</span>&nbsp;<span class="ident" id="7093542">n</span><span class="op" id="7093543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7093547">m</span>&nbsp;<span class="op" id="7093549">:=</span>&nbsp;<span class="ident" id="7093552">p224ToBig</span><span class="op" id="7093561">(</span><span class="op" id="7093562">&amp;</span><span class="ident" id="7093563">x</span><span class="op" id="7093564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7093568">if</span>&nbsp;<span class="ident" id="7093571">n</span><span class="op" id="7093572">.</span><span class="ident" id="7093573">Cmp</span><span class="op" id="7093576">(</span><span class="ident" id="7093577">m</span><span class="op" id="7093578">)</span>&nbsp;<span class="op" id="7093580">!=</span>&nbsp;<span class="num" id="7093583">0</span>&nbsp;<span class="op" id="7093585">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7093590">t</span><span class="op" id="7093591">.</span><span class="ident" id="7093592">Errorf</span><span class="op" id="7093598">(</span><span class="string" id="7093599">&#34;#%d:&nbsp;%x&nbsp;!=&nbsp;%x&#34;</span><span class="op" id="7093614">,</span>&nbsp;<span class="ident" id="7093616">i</span><span class="op" id="7093617">,</span>&nbsp;<span class="ident" id="7093619">n</span><span class="op" id="7093620">,</span>&nbsp;<span class="ident" id="7093622">m</span><span class="op" id="7093623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7093627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7093631">q</span>&nbsp;<span class="op" id="7093633">:=</span>&nbsp;<span class="ident" id="7093636">p224AlternativeToBig</span><span class="op" id="7093656">(</span><span class="op" id="7093657">&amp;</span><span class="ident" id="7093658">x</span><span class="op" id="7093659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7093663">if</span>&nbsp;<span class="ident" id="7093666">n</span><span class="op" id="7093667">.</span><span class="ident" id="7093668">Cmp</span><span class="op" id="7093671">(</span><span class="ident" id="7093672">q</span><span class="op" id="7093673">)</span>&nbsp;<span class="op" id="7093675">!=</span>&nbsp;<span class="num" id="7093678">0</span>&nbsp;<span class="op" id="7093680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7093685">t</span><span class="op" id="7093686">.</span><span class="ident" id="7093687">Errorf</span><span class="op" id="7093693">(</span><span class="string" id="7093694">&#34;#%d:&nbsp;%x&nbsp;!=&nbsp;%x&nbsp;(alternative)&#34;</span><span class="op" id="7093723">,</span>&nbsp;<span class="ident" id="7093725">i</span><span class="op" id="7093726">,</span>&nbsp;<span class="ident" id="7093728">n</span><span class="op" id="7093729">,</span>&nbsp;<span class="ident" id="7093731">m</span><span class="op" id="7093732">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7093736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7093739">}</span><br>
<span class="lineno"></span><span class="op" id="7093741">}</span>
</div>
</body>
</html>
