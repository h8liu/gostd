<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html" class="current">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3937110">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3937166">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3937220">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3937271">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3937349">package</span>&nbsp;<span class="ident" id="3937357">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3937362">import</span>&nbsp;<span class="op" id="3937369">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3937372">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3937383">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3937390">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3937393">//&nbsp;BUG(mikio):&nbsp;On&nbsp;every&nbsp;POSIX&nbsp;platform,&nbsp;reads&nbsp;from&nbsp;the&nbsp;&#34;ip4&#34;&nbsp;network</span><br>
<span class="lineno">15</span><span class="comment" id="3937462">//&nbsp;using&nbsp;the&nbsp;ReadFrom&nbsp;or&nbsp;ReadFromIP&nbsp;method&nbsp;might&nbsp;not&nbsp;return&nbsp;a&nbsp;complete</span><br>
<span class="lineno"></span><span class="comment" id="3937533">//&nbsp;IPv4&nbsp;packet,&nbsp;including&nbsp;its&nbsp;header,&nbsp;even&nbsp;if&nbsp;there&nbsp;is&nbsp;space</span><br>
<span class="lineno"></span><span class="comment" id="3937594">//&nbsp;available.&nbsp;This&nbsp;can&nbsp;occur&nbsp;even&nbsp;in&nbsp;cases&nbsp;where&nbsp;Read&nbsp;or&nbsp;ReadMsgIP</span><br>
<span class="lineno"></span><span class="comment" id="3937661">//&nbsp;could&nbsp;return&nbsp;a&nbsp;complete&nbsp;packet.&nbsp;For&nbsp;this&nbsp;reason,&nbsp;it&nbsp;is&nbsp;recommended</span><br>
<span class="lineno"></span><span class="comment" id="3937731">//&nbsp;that&nbsp;you&nbsp;do&nbsp;not&nbsp;uses&nbsp;these&nbsp;methods&nbsp;if&nbsp;it&nbsp;is&nbsp;important&nbsp;to&nbsp;receive&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="3937801">//&nbsp;full&nbsp;packet.</span><br>
<span class="lineno"></span><span class="comment" id="3937817">//</span><br>
<span class="lineno"></span><span class="comment" id="3937820">//&nbsp;The&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines&nbsp;make&nbsp;it&nbsp;impossible&nbsp;for&nbsp;us&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3937886">//&nbsp;change&nbsp;the&nbsp;behavior&nbsp;of&nbsp;these&nbsp;methods;&nbsp;use&nbsp;Read&nbsp;or&nbsp;ReadMsgIP</span><br>
<span class="lineno"></span><span class="comment" id="3937949">//&nbsp;instead.</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="3937962">func</span>&nbsp;<span class="ident" id="3937967">sockaddrToIP</span><span class="op" id="3937979">(</span><span class="ident" id="3937980">sa</span>&nbsp;<span class="ident" id="3937983">syscall</span><span class="op" id="3937990">.</span><span class="ident" id="3937991">Sockaddr</span><span class="op" id="3937999">)</span>&nbsp;<span class="ident" id="3938001">Addr</span>&nbsp;<span class="op" id="3938006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938009">switch</span>&nbsp;<span class="ident" id="3938016">sa</span>&nbsp;<span class="op" id="3938019">:=</span>&nbsp;<span class="ident" id="3938022">sa</span><span class="op" id="3938024">.</span><span class="op" id="3938025">(</span><span class="keyword" id="3938026">type</span><span class="op" id="3938030">)</span>&nbsp;<span class="op" id="3938032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938035">case</span>&nbsp;<span class="op" id="3938040">*</span><span class="ident" id="3938041">syscall</span><span class="op" id="3938048">.</span><span class="ident" id="3938049">SockaddrInet4</span><span class="op" id="3938062">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938066">return</span>&nbsp;<span class="op" id="3938073">&amp;</span><span class="ident" id="3938074">IPAddr</span><span class="op" id="3938080">{</span><span class="ident" id="3938081">IP</span><span class="op" id="3938083">:</span>&nbsp;<span class="ident" id="3938085">sa</span><span class="op" id="3938087">.</span><span class="ident" id="3938088">Addr</span><span class="op" id="3938092">[</span><span class="num" id="3938093">0</span><span class="op" id="3938094">:</span><span class="op" id="3938095">]</span><span class="op" id="3938096">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938099">case</span>&nbsp;<span class="op" id="3938104">*</span><span class="ident" id="3938105">syscall</span><span class="op" id="3938112">.</span><span class="ident" id="3938113">SockaddrInet6</span><span class="op" id="3938126">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938130">return</span>&nbsp;<span class="op" id="3938137">&amp;</span><span class="ident" id="3938138">IPAddr</span><span class="op" id="3938144">{</span><span class="ident" id="3938145">IP</span><span class="op" id="3938147">:</span>&nbsp;<span class="ident" id="3938149">sa</span><span class="op" id="3938151">.</span><span class="ident" id="3938152">Addr</span><span class="op" id="3938156">[</span><span class="num" id="3938157">0</span><span class="op" id="3938158">:</span><span class="op" id="3938159">]</span><span class="op" id="3938160">,</span>&nbsp;<span class="ident" id="3938162">Zone</span><span class="op" id="3938166">:</span>&nbsp;<span class="ident" id="3938168">zoneToString</span><span class="op" id="3938180">(</span><span class="builtintype" id="3938181">int</span><span class="op" id="3938184">(</span><span class="ident" id="3938185">sa</span><span class="op" id="3938187">.</span><span class="ident" id="3938188">ZoneId</span><span class="op" id="3938194">)</span><span class="op" id="3938195">)</span><span class="op" id="3938196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3938199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938202">return</span>&nbsp;<span class="builtintype" id="3938209">nil</span><br>
<span class="lineno"></span><span class="op" id="3938213">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="3938216">func</span>&nbsp;<span class="op" id="3938221">(</span><span class="ident" id="3938222">a</span>&nbsp;<span class="op" id="3938224">*</span><span class="ident" id="3938225">IPAddr</span><span class="op" id="3938231">)</span>&nbsp;<span class="ident" id="3938233">family</span><span class="op" id="3938239">(</span><span class="op" id="3938240">)</span>&nbsp;<span class="builtintype" id="3938242">int</span>&nbsp;<span class="op" id="3938246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938249">if</span>&nbsp;<span class="ident" id="3938252">a</span>&nbsp;<span class="op" id="3938254">==</span>&nbsp;<span class="builtintype" id="3938257">nil</span>&nbsp;<span class="op" id="3938261">||</span>&nbsp;<span class="builtinfunc" id="3938264">len</span><span class="op" id="3938267">(</span><span class="ident" id="3938268">a</span><span class="op" id="3938269">.</span><span class="ident" id="3938270">IP</span><span class="op" id="3938272">)</span>&nbsp;<span class="op" id="3938274">&lt;=</span>&nbsp;<span class="ident" id="3938277">IPv4len</span>&nbsp;<span class="op" id="3938285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938289">return</span>&nbsp;<span class="ident" id="3938296">syscall</span><span class="op" id="3938303">.</span><span class="ident" id="3938304">AF_INET</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3938313">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938316">if</span>&nbsp;<span class="ident" id="3938319">a</span><span class="op" id="3938320">.</span><span class="ident" id="3938321">IP</span><span class="op" id="3938323">.</span><span class="ident" id="3938324">To4</span><span class="op" id="3938327">(</span><span class="op" id="3938328">)</span>&nbsp;<span class="op" id="3938330">!=</span>&nbsp;<span class="builtintype" id="3938333">nil</span>&nbsp;<span class="op" id="3938337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938341">return</span>&nbsp;<span class="ident" id="3938348">syscall</span><span class="op" id="3938355">.</span><span class="ident" id="3938356">AF_INET</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3938365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938368">return</span>&nbsp;<span class="ident" id="3938375">syscall</span><span class="op" id="3938382">.</span><span class="ident" id="3938383">AF_INET6</span><br>
<span class="lineno"></span><span class="op" id="3938392">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="3938395">func</span>&nbsp;<span class="op" id="3938400">(</span><span class="ident" id="3938401">a</span>&nbsp;<span class="op" id="3938403">*</span><span class="ident" id="3938404">IPAddr</span><span class="op" id="3938410">)</span>&nbsp;<span class="ident" id="3938412">isWildcard</span><span class="op" id="3938422">(</span><span class="op" id="3938423">)</span>&nbsp;<span class="builtintype" id="3938425">bool</span>&nbsp;<span class="op" id="3938430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938433">if</span>&nbsp;<span class="ident" id="3938436">a</span>&nbsp;<span class="op" id="3938438">==</span>&nbsp;<span class="builtintype" id="3938441">nil</span>&nbsp;<span class="op" id="3938445">||</span>&nbsp;<span class="ident" id="3938448">a</span><span class="op" id="3938449">.</span><span class="ident" id="3938450">IP</span>&nbsp;<span class="op" id="3938453">==</span>&nbsp;<span class="builtintype" id="3938456">nil</span>&nbsp;<span class="op" id="3938460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938464">return</span>&nbsp;<span class="builtintype" id="3938471">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3938477">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938480">return</span>&nbsp;<span class="ident" id="3938487">a</span><span class="op" id="3938488">.</span><span class="ident" id="3938489">IP</span><span class="op" id="3938491">.</span><span class="ident" id="3938492">IsUnspecified</span><span class="op" id="3938505">(</span><span class="op" id="3938506">)</span><br>
<span class="lineno"></span><span class="op" id="3938508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3938511">func</span>&nbsp;<span class="op" id="3938516">(</span><span class="ident" id="3938517">a</span>&nbsp;<span class="op" id="3938519">*</span><span class="ident" id="3938520">IPAddr</span><span class="op" id="3938526">)</span>&nbsp;<span class="ident" id="3938528">sockaddr</span><span class="op" id="3938536">(</span><span class="ident" id="3938537">family</span>&nbsp;<span class="builtintype" id="3938544">int</span><span class="op" id="3938547">)</span>&nbsp;<span class="op" id="3938549">(</span><span class="ident" id="3938550">syscall</span><span class="op" id="3938557">.</span><span class="ident" id="3938558">Sockaddr</span><span class="op" id="3938566">,</span>&nbsp;<span class="builtintype" id="3938568">error</span><span class="op" id="3938573">)</span>&nbsp;<span class="op" id="3938575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938578">if</span>&nbsp;<span class="ident" id="3938581">a</span>&nbsp;<span class="op" id="3938583">==</span>&nbsp;<span class="builtintype" id="3938586">nil</span>&nbsp;<span class="op" id="3938590">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938594">return</span>&nbsp;<span class="builtintype" id="3938601">nil</span><span class="op" id="3938604">,</span>&nbsp;<span class="builtintype" id="3938606">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3938611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938614">return</span>&nbsp;<span class="ident" id="3938621">ipToSockaddr</span><span class="op" id="3938633">(</span><span class="ident" id="3938634">family</span><span class="op" id="3938640">,</span>&nbsp;<span class="ident" id="3938642">a</span><span class="op" id="3938643">.</span><span class="ident" id="3938644">IP</span><span class="op" id="3938646">,</span>&nbsp;<span class="num" id="3938648">0</span><span class="op" id="3938649">,</span>&nbsp;<span class="ident" id="3938651">a</span><span class="op" id="3938652">.</span><span class="ident" id="3938653">Zone</span><span class="op" id="3938657">)</span><br>
<span class="lineno"></span><span class="op" id="3938659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="3938662">//&nbsp;IPConn&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;the&nbsp;Conn&nbsp;and&nbsp;PacketConn&nbsp;interfaces</span><br>
<span class="lineno"></span><span class="comment" id="3938732">//&nbsp;for&nbsp;IP&nbsp;network&nbsp;connections.</span><br>
<span class="lineno"></span><span class="keyword" id="3938763">type</span>&nbsp;<span class="ident" id="3938768">IPConn</span>&nbsp;<span class="keyword" id="3938775">struct</span>&nbsp;<span class="op" id="3938782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938785">conn</span><br>
<span class="lineno"></span><span class="op" id="3938790">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="3938793">func</span>&nbsp;<span class="ident" id="3938798">newIPConn</span><span class="op" id="3938807">(</span><span class="ident" id="3938808">fd</span>&nbsp;<span class="op" id="3938811">*</span><span class="ident" id="3938812">netFD</span><span class="op" id="3938817">)</span>&nbsp;<span class="op" id="3938819">*</span><span class="ident" id="3938820">IPConn</span>&nbsp;<span class="op" id="3938827">{</span>&nbsp;<span class="keyword" id="3938829">return</span>&nbsp;<span class="op" id="3938836">&amp;</span><span class="ident" id="3938837">IPConn</span><span class="op" id="3938843">{</span><span class="ident" id="3938844">conn</span><span class="op" id="3938848">{</span><span class="ident" id="3938849">fd</span><span class="op" id="3938851">}</span><span class="op" id="3938852">}</span>&nbsp;<span class="op" id="3938854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3938857">//&nbsp;ReadFromIP&nbsp;reads&nbsp;an&nbsp;IP&nbsp;packet&nbsp;from&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload&nbsp;into&nbsp;b.</span><br>
<span class="lineno"></span><span class="comment" id="3938926">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;b&nbsp;and&nbsp;the&nbsp;return&nbsp;address</span><br>
<span class="lineno">70</span><span class="comment" id="3938997">//&nbsp;that&nbsp;was&nbsp;on&nbsp;the&nbsp;packet.</span><br>
<span class="lineno"></span><span class="comment" id="3939024">//</span><br>
<span class="lineno"></span><span class="comment" id="3939027">//&nbsp;ReadFromIP&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;an&nbsp;error&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="3939090">//&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3939157">//&nbsp;SetReadDeadline.</span><br>
<span class="lineno">75</span><span class="keyword" id="3939177">func</span>&nbsp;<span class="op" id="3939182">(</span><span class="ident" id="3939183">c</span>&nbsp;<span class="op" id="3939185">*</span><span class="ident" id="3939186">IPConn</span><span class="op" id="3939192">)</span>&nbsp;<span class="ident" id="3939194">ReadFromIP</span><span class="op" id="3939204">(</span><span class="ident" id="3939205">b</span>&nbsp;<span class="op" id="3939207">[</span><span class="op" id="3939208">]</span><span class="builtintype" id="3939209">byte</span><span class="op" id="3939213">)</span>&nbsp;<span class="op" id="3939215">(</span><span class="builtintype" id="3939216">int</span><span class="op" id="3939219">,</span>&nbsp;<span class="op" id="3939221">*</span><span class="ident" id="3939222">IPAddr</span><span class="op" id="3939228">,</span>&nbsp;<span class="builtintype" id="3939230">error</span><span class="op" id="3939235">)</span>&nbsp;<span class="op" id="3939237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3939240">if</span>&nbsp;<span class="op" id="3939243">!</span><span class="ident" id="3939244">c</span><span class="op" id="3939245">.</span><span class="ident" id="3939246">ok</span><span class="op" id="3939248">(</span><span class="op" id="3939249">)</span>&nbsp;<span class="op" id="3939251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3939255">return</span>&nbsp;<span class="num" id="3939262">0</span><span class="op" id="3939263">,</span>&nbsp;<span class="builtintype" id="3939265">nil</span><span class="op" id="3939268">,</span>&nbsp;<span class="ident" id="3939270">syscall</span><span class="op" id="3939277">.</span><span class="ident" id="3939278">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3939286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3939289">//&nbsp;TODO(cw,rsc):&nbsp;consider&nbsp;using&nbsp;readv&nbsp;if&nbsp;we&nbsp;know&nbsp;the&nbsp;family</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3939350">//&nbsp;type&nbsp;to&nbsp;avoid&nbsp;the&nbsp;header&nbsp;trim/copy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3939389">var</span>&nbsp;<span class="ident" id="3939393">addr</span>&nbsp;<span class="op" id="3939398">*</span><span class="ident" id="3939399">IPAddr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939407">n</span><span class="op" id="3939408">,</span>&nbsp;<span class="ident" id="3939410">sa</span><span class="op" id="3939412">,</span>&nbsp;<span class="ident" id="3939414">err</span>&nbsp;<span class="op" id="3939418">:=</span>&nbsp;<span class="ident" id="3939421">c</span><span class="op" id="3939422">.</span><span class="ident" id="3939423">fd</span><span class="op" id="3939425">.</span><span class="ident" id="3939426">readFrom</span><span class="op" id="3939434">(</span><span class="ident" id="3939435">b</span><span class="op" id="3939436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3939439">switch</span>&nbsp;<span class="ident" id="3939446">sa</span>&nbsp;<span class="op" id="3939449">:=</span>&nbsp;<span class="ident" id="3939452">sa</span><span class="op" id="3939454">.</span><span class="op" id="3939455">(</span><span class="keyword" id="3939456">type</span><span class="op" id="3939460">)</span>&nbsp;<span class="op" id="3939462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3939465">case</span>&nbsp;<span class="op" id="3939470">*</span><span class="ident" id="3939471">syscall</span><span class="op" id="3939478">.</span><span class="ident" id="3939479">SockaddrInet4</span><span class="op" id="3939492">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939496">addr</span>&nbsp;<span class="op" id="3939501">=</span>&nbsp;<span class="op" id="3939503">&amp;</span><span class="ident" id="3939504">IPAddr</span><span class="op" id="3939510">{</span><span class="ident" id="3939511">IP</span><span class="op" id="3939513">:</span>&nbsp;<span class="ident" id="3939515">sa</span><span class="op" id="3939517">.</span><span class="ident" id="3939518">Addr</span><span class="op" id="3939522">[</span><span class="num" id="3939523">0</span><span class="op" id="3939524">:</span><span class="op" id="3939525">]</span><span class="op" id="3939526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3939530">if</span>&nbsp;<span class="builtinfunc" id="3939533">len</span><span class="op" id="3939536">(</span><span class="ident" id="3939537">b</span><span class="op" id="3939538">)</span>&nbsp;<span class="op" id="3939540">&gt;=</span>&nbsp;<span class="ident" id="3939543">IPv4len</span>&nbsp;<span class="op" id="3939551">{</span>&nbsp;<span class="comment" id="3939553">//&nbsp;discard&nbsp;ipv4&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939579">hsize</span>&nbsp;<span class="op" id="3939585">:=</span>&nbsp;<span class="op" id="3939588">(</span><span class="builtintype" id="3939589">int</span><span class="op" id="3939592">(</span><span class="ident" id="3939593">b</span><span class="op" id="3939594">[</span><span class="num" id="3939595">0</span><span class="op" id="3939596">]</span><span class="op" id="3939597">)</span>&nbsp;<span class="op" id="3939599">&amp;</span>&nbsp;<span class="num" id="3939601">0xf</span><span class="op" id="3939604">)</span>&nbsp;<span class="op" id="3939606">*</span>&nbsp;<span class="num" id="3939608">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3939613">copy</span><span class="op" id="3939617">(</span><span class="ident" id="3939618">b</span><span class="op" id="3939619">,</span>&nbsp;<span class="ident" id="3939621">b</span><span class="op" id="3939622">[</span><span class="ident" id="3939623">hsize</span><span class="op" id="3939628">:</span><span class="op" id="3939629">]</span><span class="op" id="3939630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939635">n</span>&nbsp;<span class="op" id="3939637">-=</span>&nbsp;<span class="ident" id="3939640">hsize</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3939648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3939651">case</span>&nbsp;<span class="op" id="3939656">*</span><span class="ident" id="3939657">syscall</span><span class="op" id="3939664">.</span><span class="ident" id="3939665">SockaddrInet6</span><span class="op" id="3939678">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939682">addr</span>&nbsp;<span class="op" id="3939687">=</span>&nbsp;<span class="op" id="3939689">&amp;</span><span class="ident" id="3939690">IPAddr</span><span class="op" id="3939696">{</span><span class="ident" id="3939697">IP</span><span class="op" id="3939699">:</span>&nbsp;<span class="ident" id="3939701">sa</span><span class="op" id="3939703">.</span><span class="ident" id="3939704">Addr</span><span class="op" id="3939708">[</span><span class="num" id="3939709">0</span><span class="op" id="3939710">:</span><span class="op" id="3939711">]</span><span class="op" id="3939712">,</span>&nbsp;<span class="ident" id="3939714">Zone</span><span class="op" id="3939718">:</span>&nbsp;<span class="ident" id="3939720">zoneToString</span><span class="op" id="3939732">(</span><span class="builtintype" id="3939733">int</span><span class="op" id="3939736">(</span><span class="ident" id="3939737">sa</span><span class="op" id="3939739">.</span><span class="ident" id="3939740">ZoneId</span><span class="op" id="3939746">)</span><span class="op" id="3939747">)</span><span class="op" id="3939748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3939751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3939754">return</span>&nbsp;<span class="ident" id="3939761">n</span><span class="op" id="3939762">,</span>&nbsp;<span class="ident" id="3939764">addr</span><span class="op" id="3939768">,</span>&nbsp;<span class="ident" id="3939770">err</span><br>
<span class="lineno">95</span><span class="op" id="3939774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3939777">//&nbsp;ReadFrom&nbsp;implements&nbsp;the&nbsp;PacketConn&nbsp;ReadFrom&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="3939832">func</span>&nbsp;<span class="op" id="3939837">(</span><span class="ident" id="3939838">c</span>&nbsp;<span class="op" id="3939840">*</span><span class="ident" id="3939841">IPConn</span><span class="op" id="3939847">)</span>&nbsp;<span class="ident" id="3939849">ReadFrom</span><span class="op" id="3939857">(</span><span class="ident" id="3939858">b</span>&nbsp;<span class="op" id="3939860">[</span><span class="op" id="3939861">]</span><span class="builtintype" id="3939862">byte</span><span class="op" id="3939866">)</span>&nbsp;<span class="op" id="3939868">(</span><span class="builtintype" id="3939869">int</span><span class="op" id="3939872">,</span>&nbsp;<span class="ident" id="3939874">Addr</span><span class="op" id="3939878">,</span>&nbsp;<span class="builtintype" id="3939880">error</span><span class="op" id="3939885">)</span>&nbsp;<span class="op" id="3939887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3939890">if</span>&nbsp;<span class="op" id="3939893">!</span><span class="ident" id="3939894">c</span><span class="op" id="3939895">.</span><span class="ident" id="3939896">ok</span><span class="op" id="3939898">(</span><span class="op" id="3939899">)</span>&nbsp;<span class="op" id="3939901">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3939905">return</span>&nbsp;<span class="num" id="3939912">0</span><span class="op" id="3939913">,</span>&nbsp;<span class="builtintype" id="3939915">nil</span><span class="op" id="3939918">,</span>&nbsp;<span class="ident" id="3939920">syscall</span><span class="op" id="3939927">.</span><span class="ident" id="3939928">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3939936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939939">n</span><span class="op" id="3939940">,</span>&nbsp;<span class="ident" id="3939942">addr</span><span class="op" id="3939946">,</span>&nbsp;<span class="ident" id="3939948">err</span>&nbsp;<span class="op" id="3939952">:=</span>&nbsp;<span class="ident" id="3939955">c</span><span class="op" id="3939956">.</span><span class="ident" id="3939957">ReadFromIP</span><span class="op" id="3939967">(</span><span class="ident" id="3939968">b</span><span class="op" id="3939969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3939972">return</span>&nbsp;<span class="ident" id="3939979">n</span><span class="op" id="3939980">,</span>&nbsp;<span class="ident" id="3939982">addr</span><span class="op" id="3939986">.</span><span class="ident" id="3939987">toAddr</span><span class="op" id="3939993">(</span><span class="op" id="3939994">)</span><span class="op" id="3939995">,</span>&nbsp;<span class="ident" id="3939997">err</span><br>
<span class="lineno"></span><span class="op" id="3940001">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="3940004">//&nbsp;ReadMsgIP&nbsp;reads&nbsp;a&nbsp;packet&nbsp;from&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload&nbsp;into&nbsp;b&nbsp;and&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3940075">//&nbsp;associated&nbsp;out-of-band&nbsp;data&nbsp;into&nbsp;oob.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3940142">//&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;b,&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;oob,&nbsp;the&nbsp;flags</span><br>
<span class="lineno"></span><span class="comment" id="3940213">//&nbsp;that&nbsp;were&nbsp;set&nbsp;on&nbsp;the&nbsp;packet&nbsp;and&nbsp;the&nbsp;source&nbsp;address&nbsp;of&nbsp;the&nbsp;packet.</span><br>
<span class="lineno">110</span><span class="keyword" id="3940282">func</span>&nbsp;<span class="op" id="3940287">(</span><span class="ident" id="3940288">c</span>&nbsp;<span class="op" id="3940290">*</span><span class="ident" id="3940291">IPConn</span><span class="op" id="3940297">)</span>&nbsp;<span class="ident" id="3940299">ReadMsgIP</span><span class="op" id="3940308">(</span><span class="ident" id="3940309">b</span><span class="op" id="3940310">,</span>&nbsp;<span class="ident" id="3940312">oob</span>&nbsp;<span class="op" id="3940316">[</span><span class="op" id="3940317">]</span><span class="builtintype" id="3940318">byte</span><span class="op" id="3940322">)</span>&nbsp;<span class="op" id="3940324">(</span><span class="ident" id="3940325">n</span><span class="op" id="3940326">,</span>&nbsp;<span class="ident" id="3940328">oobn</span><span class="op" id="3940332">,</span>&nbsp;<span class="ident" id="3940334">flags</span>&nbsp;<span class="builtintype" id="3940340">int</span><span class="op" id="3940343">,</span>&nbsp;<span class="ident" id="3940345">addr</span>&nbsp;<span class="op" id="3940350">*</span><span class="ident" id="3940351">IPAddr</span><span class="op" id="3940357">,</span>&nbsp;<span class="ident" id="3940359">err</span>&nbsp;<span class="builtintype" id="3940363">error</span><span class="op" id="3940368">)</span>&nbsp;<span class="op" id="3940370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3940373">if</span>&nbsp;<span class="op" id="3940376">!</span><span class="ident" id="3940377">c</span><span class="op" id="3940378">.</span><span class="ident" id="3940379">ok</span><span class="op" id="3940381">(</span><span class="op" id="3940382">)</span>&nbsp;<span class="op" id="3940384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3940388">return</span>&nbsp;<span class="num" id="3940395">0</span><span class="op" id="3940396">,</span>&nbsp;<span class="num" id="3940398">0</span><span class="op" id="3940399">,</span>&nbsp;<span class="num" id="3940401">0</span><span class="op" id="3940402">,</span>&nbsp;<span class="builtintype" id="3940404">nil</span><span class="op" id="3940407">,</span>&nbsp;<span class="ident" id="3940409">syscall</span><span class="op" id="3940416">.</span><span class="ident" id="3940417">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3940425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3940428">var</span>&nbsp;<span class="ident" id="3940432">sa</span>&nbsp;<span class="ident" id="3940435">syscall</span><span class="op" id="3940442">.</span><span class="ident" id="3940443">Sockaddr</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940453">n</span><span class="op" id="3940454">,</span>&nbsp;<span class="ident" id="3940456">oobn</span><span class="op" id="3940460">,</span>&nbsp;<span class="ident" id="3940462">flags</span><span class="op" id="3940467">,</span>&nbsp;<span class="ident" id="3940469">sa</span><span class="op" id="3940471">,</span>&nbsp;<span class="ident" id="3940473">err</span>&nbsp;<span class="op" id="3940477">=</span>&nbsp;<span class="ident" id="3940479">c</span><span class="op" id="3940480">.</span><span class="ident" id="3940481">fd</span><span class="op" id="3940483">.</span><span class="ident" id="3940484">readMsg</span><span class="op" id="3940491">(</span><span class="ident" id="3940492">b</span><span class="op" id="3940493">,</span>&nbsp;<span class="ident" id="3940495">oob</span><span class="op" id="3940498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3940501">switch</span>&nbsp;<span class="ident" id="3940508">sa</span>&nbsp;<span class="op" id="3940511">:=</span>&nbsp;<span class="ident" id="3940514">sa</span><span class="op" id="3940516">.</span><span class="op" id="3940517">(</span><span class="keyword" id="3940518">type</span><span class="op" id="3940522">)</span>&nbsp;<span class="op" id="3940524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3940527">case</span>&nbsp;<span class="op" id="3940532">*</span><span class="ident" id="3940533">syscall</span><span class="op" id="3940540">.</span><span class="ident" id="3940541">SockaddrInet4</span><span class="op" id="3940554">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940558">addr</span>&nbsp;<span class="op" id="3940563">=</span>&nbsp;<span class="op" id="3940565">&amp;</span><span class="ident" id="3940566">IPAddr</span><span class="op" id="3940572">{</span><span class="ident" id="3940573">IP</span><span class="op" id="3940575">:</span>&nbsp;<span class="ident" id="3940577">sa</span><span class="op" id="3940579">.</span><span class="ident" id="3940580">Addr</span><span class="op" id="3940584">[</span><span class="num" id="3940585">0</span><span class="op" id="3940586">:</span><span class="op" id="3940587">]</span><span class="op" id="3940588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3940591">case</span>&nbsp;<span class="op" id="3940596">*</span><span class="ident" id="3940597">syscall</span><span class="op" id="3940604">.</span><span class="ident" id="3940605">SockaddrInet6</span><span class="op" id="3940618">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940622">addr</span>&nbsp;<span class="op" id="3940627">=</span>&nbsp;<span class="op" id="3940629">&amp;</span><span class="ident" id="3940630">IPAddr</span><span class="op" id="3940636">{</span><span class="ident" id="3940637">IP</span><span class="op" id="3940639">:</span>&nbsp;<span class="ident" id="3940641">sa</span><span class="op" id="3940643">.</span><span class="ident" id="3940644">Addr</span><span class="op" id="3940648">[</span><span class="num" id="3940649">0</span><span class="op" id="3940650">:</span><span class="op" id="3940651">]</span><span class="op" id="3940652">,</span>&nbsp;<span class="ident" id="3940654">Zone</span><span class="op" id="3940658">:</span>&nbsp;<span class="ident" id="3940660">zoneToString</span><span class="op" id="3940672">(</span><span class="builtintype" id="3940673">int</span><span class="op" id="3940676">(</span><span class="ident" id="3940677">sa</span><span class="op" id="3940679">.</span><span class="ident" id="3940680">ZoneId</span><span class="op" id="3940686">)</span><span class="op" id="3940687">)</span><span class="op" id="3940688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3940691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3940694">return</span><br>
<span class="lineno"></span><span class="op" id="3940701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="3940704">//&nbsp;WriteToIP&nbsp;writes&nbsp;an&nbsp;IP&nbsp;packet&nbsp;to&nbsp;addr&nbsp;via&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload</span><br>
<span class="lineno"></span><span class="comment" id="3940772">//&nbsp;from&nbsp;b.</span><br>
<span class="lineno"></span><span class="comment" id="3940783">//</span><br>
<span class="lineno"></span><span class="comment" id="3940786">//&nbsp;WriteToIP&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;an&nbsp;error&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="3940848">//&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and</span><br>
<span class="lineno">130</span><span class="comment" id="3940915">//&nbsp;SetWriteDeadline.&nbsp;&nbsp;On&nbsp;packet-oriented&nbsp;connections,&nbsp;write&nbsp;timeouts</span><br>
<span class="lineno"></span><span class="comment" id="3940984">//&nbsp;are&nbsp;rare.</span><br>
<span class="lineno"></span><span class="keyword" id="3940997">func</span>&nbsp;<span class="op" id="3941002">(</span><span class="ident" id="3941003">c</span>&nbsp;<span class="op" id="3941005">*</span><span class="ident" id="3941006">IPConn</span><span class="op" id="3941012">)</span>&nbsp;<span class="ident" id="3941014">WriteToIP</span><span class="op" id="3941023">(</span><span class="ident" id="3941024">b</span>&nbsp;<span class="op" id="3941026">[</span><span class="op" id="3941027">]</span><span class="builtintype" id="3941028">byte</span><span class="op" id="3941032">,</span>&nbsp;<span class="ident" id="3941034">addr</span>&nbsp;<span class="op" id="3941039">*</span><span class="ident" id="3941040">IPAddr</span><span class="op" id="3941046">)</span>&nbsp;<span class="op" id="3941048">(</span><span class="builtintype" id="3941049">int</span><span class="op" id="3941052">,</span>&nbsp;<span class="builtintype" id="3941054">error</span><span class="op" id="3941059">)</span>&nbsp;<span class="op" id="3941061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3941064">if</span>&nbsp;<span class="op" id="3941067">!</span><span class="ident" id="3941068">c</span><span class="op" id="3941069">.</span><span class="ident" id="3941070">ok</span><span class="op" id="3941072">(</span><span class="op" id="3941073">)</span>&nbsp;<span class="op" id="3941075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3941079">return</span>&nbsp;<span class="num" id="3941086">0</span><span class="op" id="3941087">,</span>&nbsp;<span class="ident" id="3941089">syscall</span><span class="op" id="3941096">.</span><span class="ident" id="3941097">EINVAL</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3941105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3941108">if</span>&nbsp;<span class="ident" id="3941111">c</span><span class="op" id="3941112">.</span><span class="ident" id="3941113">fd</span><span class="op" id="3941115">.</span><span class="ident" id="3941116">isConnected</span>&nbsp;<span class="op" id="3941128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3941132">return</span>&nbsp;<span class="num" id="3941139">0</span><span class="op" id="3941140">,</span>&nbsp;<span class="op" id="3941142">&amp;</span><span class="ident" id="3941143">OpError</span><span class="op" id="3941150">{</span><span class="ident" id="3941151">Op</span><span class="op" id="3941153">:</span>&nbsp;<span class="string" id="3941155">&#34;write&#34;</span><span class="op" id="3941162">,</span>&nbsp;<span class="ident" id="3941164">Net</span><span class="op" id="3941167">:</span>&nbsp;<span class="ident" id="3941169">c</span><span class="op" id="3941170">.</span><span class="ident" id="3941171">fd</span><span class="op" id="3941173">.</span><span class="ident" id="3941174">net</span><span class="op" id="3941177">,</span>&nbsp;<span class="ident" id="3941179">Addr</span><span class="op" id="3941183">:</span>&nbsp;<span class="ident" id="3941185">addr</span><span class="op" id="3941189">,</span>&nbsp;<span class="ident" id="3941191">Err</span><span class="op" id="3941194">:</span>&nbsp;<span class="ident" id="3941196">ErrWriteToConnected</span><span class="op" id="3941215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3941218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3941221">if</span>&nbsp;<span class="ident" id="3941224">addr</span>&nbsp;<span class="op" id="3941229">==</span>&nbsp;<span class="builtintype" id="3941232">nil</span>&nbsp;<span class="op" id="3941236">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3941240">return</span>&nbsp;<span class="num" id="3941247">0</span><span class="op" id="3941248">,</span>&nbsp;<span class="op" id="3941250">&amp;</span><span class="ident" id="3941251">OpError</span><span class="op" id="3941258">{</span><span class="ident" id="3941259">Op</span><span class="op" id="3941261">:</span>&nbsp;<span class="string" id="3941263">&#34;write&#34;</span><span class="op" id="3941270">,</span>&nbsp;<span class="ident" id="3941272">Net</span><span class="op" id="3941275">:</span>&nbsp;<span class="ident" id="3941277">c</span><span class="op" id="3941278">.</span><span class="ident" id="3941279">fd</span><span class="op" id="3941281">.</span><span class="ident" id="3941282">net</span><span class="op" id="3941285">,</span>&nbsp;<span class="ident" id="3941287">Addr</span><span class="op" id="3941291">:</span>&nbsp;<span class="builtintype" id="3941293">nil</span><span class="op" id="3941296">,</span>&nbsp;<span class="ident" id="3941298">Err</span><span class="op" id="3941301">:</span>&nbsp;<span class="ident" id="3941303">errMissingAddress</span><span class="op" id="3941320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3941323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941326">sa</span><span class="op" id="3941328">,</span>&nbsp;<span class="ident" id="3941330">err</span>&nbsp;<span class="op" id="3941334">:=</span>&nbsp;<span class="ident" id="3941337">addr</span><span class="op" id="3941341">.</span><span class="ident" id="3941342">sockaddr</span><span class="op" id="3941350">(</span><span class="ident" id="3941351">c</span><span class="op" id="3941352">.</span><span class="ident" id="3941353">fd</span><span class="op" id="3941355">.</span><span class="ident" id="3941356">family</span><span class="op" id="3941362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3941365">if</span>&nbsp;<span class="ident" id="3941368">err</span>&nbsp;<span class="op" id="3941372">!=</span>&nbsp;<span class="builtintype" id="3941375">nil</span>&nbsp;<span class="op" id="3941379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3941383">return</span>&nbsp;<span class="num" id="3941390">0</span><span class="op" id="3941391">,</span>&nbsp;<span class="op" id="3941393">&amp;</span><span class="ident" id="3941394">OpError</span><span class="op" id="3941401">{</span><span class="string" id="3941402">&#34;write&#34;</span><span class="op" id="3941409">,</span>&nbsp;<span class="ident" id="3941411">c</span><span class="op" id="3941412">.</span><span class="ident" id="3941413">fd</span><span class="op" id="3941415">.</span><span class="ident" id="3941416">net</span><span class="op" id="3941419">,</span>&nbsp;<span class="ident" id="3941421">addr</span><span class="op" id="3941425">,</span>&nbsp;<span class="ident" id="3941427">err</span><span class="op" id="3941430">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3941433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3941436">return</span>&nbsp;<span class="ident" id="3941443">c</span><span class="op" id="3941444">.</span><span class="ident" id="3941445">fd</span><span class="op" id="3941447">.</span><span class="ident" id="3941448">writeTo</span><span class="op" id="3941455">(</span><span class="ident" id="3941456">b</span><span class="op" id="3941457">,</span>&nbsp;<span class="ident" id="3941459">sa</span><span class="op" id="3941461">)</span><br>
<span class="lineno"></span><span class="op" id="3941463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3941466">//&nbsp;WriteTo&nbsp;implements&nbsp;the&nbsp;PacketConn&nbsp;WriteTo&nbsp;method.</span><br>
<span class="lineno">150</span><span class="keyword" id="3941519">func</span>&nbsp;<span class="op" id="3941524">(</span><span class="ident" id="3941525">c</span>&nbsp;<span class="op" id="3941527">*</span><span class="ident" id="3941528">IPConn</span><span class="op" id="3941534">)</span>&nbsp;<span class="ident" id="3941536">WriteTo</span><span class="op" id="3941543">(</span><span class="ident" id="3941544">b</span>&nbsp;<span class="op" id="3941546">[</span><span class="op" id="3941547">]</span><span class="builtintype" id="3941548">byte</span><span class="op" id="3941552">,</span>&nbsp;<span class="ident" id="3941554">addr</span>&nbsp;<span class="ident" id="3941559">Addr</span><span class="op" id="3941563">)</span>&nbsp;<span class="op" id="3941565">(</span><span class="builtintype" id="3941566">int</span><span class="op" id="3941569">,</span>&nbsp;<span class="builtintype" id="3941571">error</span><span class="op" id="3941576">)</span>&nbsp;<span class="op" id="3941578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3941581">if</span>&nbsp;<span class="op" id="3941584">!</span><span class="ident" id="3941585">c</span><span class="op" id="3941586">.</span><span class="ident" id="3941587">ok</span><span class="op" id="3941589">(</span><span class="op" id="3941590">)</span>&nbsp;<span class="op" id="3941592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3941596">return</span>&nbsp;<span class="num" id="3941603">0</span><span class="op" id="3941604">,</span>&nbsp;<span class="ident" id="3941606">syscall</span><span class="op" id="3941613">.</span><span class="ident" id="3941614">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3941622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941625">a</span><span class="op" id="3941626">,</span>&nbsp;<span class="ident" id="3941628">ok</span>&nbsp;<span class="op" id="3941631">:=</span>&nbsp;<span class="ident" id="3941634">addr</span><span class="op" id="3941638">.</span><span class="op" id="3941639">(</span><span class="op" id="3941640">*</span><span class="ident" id="3941641">IPAddr</span><span class="op" id="3941647">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3941650">if</span>&nbsp;<span class="op" id="3941653">!</span><span class="ident" id="3941654">ok</span>&nbsp;<span class="op" id="3941657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3941661">return</span>&nbsp;<span class="num" id="3941668">0</span><span class="op" id="3941669">,</span>&nbsp;<span class="op" id="3941671">&amp;</span><span class="ident" id="3941672">OpError</span><span class="op" id="3941679">{</span><span class="string" id="3941680">&#34;write&#34;</span><span class="op" id="3941687">,</span>&nbsp;<span class="ident" id="3941689">c</span><span class="op" id="3941690">.</span><span class="ident" id="3941691">fd</span><span class="op" id="3941693">.</span><span class="ident" id="3941694">net</span><span class="op" id="3941697">,</span>&nbsp;<span class="ident" id="3941699">addr</span><span class="op" id="3941703">,</span>&nbsp;<span class="ident" id="3941705">syscall</span><span class="op" id="3941712">.</span><span class="ident" id="3941713">EINVAL</span><span class="op" id="3941719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3941722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3941725">return</span>&nbsp;<span class="ident" id="3941732">c</span><span class="op" id="3941733">.</span><span class="ident" id="3941734">WriteToIP</span><span class="op" id="3941743">(</span><span class="ident" id="3941744">b</span><span class="op" id="3941745">,</span>&nbsp;<span class="ident" id="3941747">a</span><span class="op" id="3941748">)</span><br>
<span class="lineno"></span><span class="op" id="3941750">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="comment" id="3941753">//&nbsp;WriteMsgIP&nbsp;writes&nbsp;a&nbsp;packet&nbsp;to&nbsp;addr&nbsp;via&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="3941823">//&nbsp;b&nbsp;and&nbsp;the&nbsp;associated&nbsp;out-of-band&nbsp;data&nbsp;from&nbsp;oob.&nbsp;&nbsp;It&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3941890">//&nbsp;number&nbsp;of&nbsp;payload&nbsp;and&nbsp;out-of-band&nbsp;bytes&nbsp;written.</span><br>
<span class="lineno"></span><span class="keyword" id="3941942">func</span>&nbsp;<span class="op" id="3941947">(</span><span class="ident" id="3941948">c</span>&nbsp;<span class="op" id="3941950">*</span><span class="ident" id="3941951">IPConn</span><span class="op" id="3941957">)</span>&nbsp;<span class="ident" id="3941959">WriteMsgIP</span><span class="op" id="3941969">(</span><span class="ident" id="3941970">b</span><span class="op" id="3941971">,</span>&nbsp;<span class="ident" id="3941973">oob</span>&nbsp;<span class="op" id="3941977">[</span><span class="op" id="3941978">]</span><span class="builtintype" id="3941979">byte</span><span class="op" id="3941983">,</span>&nbsp;<span class="ident" id="3941985">addr</span>&nbsp;<span class="op" id="3941990">*</span><span class="ident" id="3941991">IPAddr</span><span class="op" id="3941997">)</span>&nbsp;<span class="op" id="3941999">(</span><span class="ident" id="3942000">n</span><span class="op" id="3942001">,</span>&nbsp;<span class="ident" id="3942003">oobn</span>&nbsp;<span class="builtintype" id="3942008">int</span><span class="op" id="3942011">,</span>&nbsp;<span class="ident" id="3942013">err</span>&nbsp;<span class="builtintype" id="3942017">error</span><span class="op" id="3942022">)</span>&nbsp;<span class="op" id="3942024">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942027">if</span>&nbsp;<span class="op" id="3942030">!</span><span class="ident" id="3942031">c</span><span class="op" id="3942032">.</span><span class="ident" id="3942033">ok</span><span class="op" id="3942035">(</span><span class="op" id="3942036">)</span>&nbsp;<span class="op" id="3942038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942042">return</span>&nbsp;<span class="num" id="3942049">0</span><span class="op" id="3942050">,</span>&nbsp;<span class="num" id="3942052">0</span><span class="op" id="3942053">,</span>&nbsp;<span class="ident" id="3942055">syscall</span><span class="op" id="3942062">.</span><span class="ident" id="3942063">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3942071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942074">if</span>&nbsp;<span class="ident" id="3942077">c</span><span class="op" id="3942078">.</span><span class="ident" id="3942079">fd</span><span class="op" id="3942081">.</span><span class="ident" id="3942082">isConnected</span>&nbsp;<span class="op" id="3942094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942098">return</span>&nbsp;<span class="num" id="3942105">0</span><span class="op" id="3942106">,</span>&nbsp;<span class="num" id="3942108">0</span><span class="op" id="3942109">,</span>&nbsp;<span class="op" id="3942111">&amp;</span><span class="ident" id="3942112">OpError</span><span class="op" id="3942119">{</span><span class="ident" id="3942120">Op</span><span class="op" id="3942122">:</span>&nbsp;<span class="string" id="3942124">&#34;write&#34;</span><span class="op" id="3942131">,</span>&nbsp;<span class="ident" id="3942133">Net</span><span class="op" id="3942136">:</span>&nbsp;<span class="ident" id="3942138">c</span><span class="op" id="3942139">.</span><span class="ident" id="3942140">fd</span><span class="op" id="3942142">.</span><span class="ident" id="3942143">net</span><span class="op" id="3942146">,</span>&nbsp;<span class="ident" id="3942148">Addr</span><span class="op" id="3942152">:</span>&nbsp;<span class="ident" id="3942154">addr</span><span class="op" id="3942158">,</span>&nbsp;<span class="ident" id="3942160">Err</span><span class="op" id="3942163">:</span>&nbsp;<span class="ident" id="3942165">ErrWriteToConnected</span><span class="op" id="3942184">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3942187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942190">if</span>&nbsp;<span class="ident" id="3942193">addr</span>&nbsp;<span class="op" id="3942198">==</span>&nbsp;<span class="builtintype" id="3942201">nil</span>&nbsp;<span class="op" id="3942205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942209">return</span>&nbsp;<span class="num" id="3942216">0</span><span class="op" id="3942217">,</span>&nbsp;<span class="num" id="3942219">0</span><span class="op" id="3942220">,</span>&nbsp;<span class="op" id="3942222">&amp;</span><span class="ident" id="3942223">OpError</span><span class="op" id="3942230">{</span><span class="ident" id="3942231">Op</span><span class="op" id="3942233">:</span>&nbsp;<span class="string" id="3942235">&#34;write&#34;</span><span class="op" id="3942242">,</span>&nbsp;<span class="ident" id="3942244">Net</span><span class="op" id="3942247">:</span>&nbsp;<span class="ident" id="3942249">c</span><span class="op" id="3942250">.</span><span class="ident" id="3942251">fd</span><span class="op" id="3942253">.</span><span class="ident" id="3942254">net</span><span class="op" id="3942257">,</span>&nbsp;<span class="ident" id="3942259">Addr</span><span class="op" id="3942263">:</span>&nbsp;<span class="builtintype" id="3942265">nil</span><span class="op" id="3942268">,</span>&nbsp;<span class="ident" id="3942270">Err</span><span class="op" id="3942273">:</span>&nbsp;<span class="ident" id="3942275">errMissingAddress</span><span class="op" id="3942292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3942295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942298">sa</span><span class="op" id="3942300">,</span>&nbsp;<span class="ident" id="3942302">err</span>&nbsp;<span class="op" id="3942306">:=</span>&nbsp;<span class="ident" id="3942309">addr</span><span class="op" id="3942313">.</span><span class="ident" id="3942314">sockaddr</span><span class="op" id="3942322">(</span><span class="ident" id="3942323">c</span><span class="op" id="3942324">.</span><span class="ident" id="3942325">fd</span><span class="op" id="3942327">.</span><span class="ident" id="3942328">family</span><span class="op" id="3942334">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942337">if</span>&nbsp;<span class="ident" id="3942340">err</span>&nbsp;<span class="op" id="3942344">!=</span>&nbsp;<span class="builtintype" id="3942347">nil</span>&nbsp;<span class="op" id="3942351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942355">return</span>&nbsp;<span class="num" id="3942362">0</span><span class="op" id="3942363">,</span>&nbsp;<span class="num" id="3942365">0</span><span class="op" id="3942366">,</span>&nbsp;<span class="op" id="3942368">&amp;</span><span class="ident" id="3942369">OpError</span><span class="op" id="3942376">{</span><span class="string" id="3942377">&#34;write&#34;</span><span class="op" id="3942384">,</span>&nbsp;<span class="ident" id="3942386">c</span><span class="op" id="3942387">.</span><span class="ident" id="3942388">fd</span><span class="op" id="3942390">.</span><span class="ident" id="3942391">net</span><span class="op" id="3942394">,</span>&nbsp;<span class="ident" id="3942396">addr</span><span class="op" id="3942400">,</span>&nbsp;<span class="ident" id="3942402">err</span><span class="op" id="3942405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3942408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942411">return</span>&nbsp;<span class="ident" id="3942418">c</span><span class="op" id="3942419">.</span><span class="ident" id="3942420">fd</span><span class="op" id="3942422">.</span><span class="ident" id="3942423">writeMsg</span><span class="op" id="3942431">(</span><span class="ident" id="3942432">b</span><span class="op" id="3942433">,</span>&nbsp;<span class="ident" id="3942435">oob</span><span class="op" id="3942438">,</span>&nbsp;<span class="ident" id="3942440">sa</span><span class="op" id="3942442">)</span><br>
<span class="lineno"></span><span class="op" id="3942444">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="3942447">//&nbsp;DialIP&nbsp;connects&nbsp;to&nbsp;the&nbsp;remote&nbsp;address&nbsp;raddr&nbsp;on&nbsp;the&nbsp;network&nbsp;protocol</span><br>
<span class="lineno"></span><span class="comment" id="3942518">//&nbsp;netProto,&nbsp;which&nbsp;must&nbsp;be&nbsp;&#34;ip&#34;,&nbsp;&#34;ip4&#34;,&nbsp;or&nbsp;&#34;ip6&#34;&nbsp;followed&nbsp;by&nbsp;a&nbsp;colon</span><br>
<span class="lineno"></span><span class="comment" id="3942587">//&nbsp;and&nbsp;a&nbsp;protocol&nbsp;number&nbsp;or&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3942621">func</span>&nbsp;<span class="ident" id="3942626">DialIP</span><span class="op" id="3942632">(</span><span class="ident" id="3942633">netProto</span>&nbsp;<span class="builtintype" id="3942642">string</span><span class="op" id="3942648">,</span>&nbsp;<span class="ident" id="3942650">laddr</span><span class="op" id="3942655">,</span>&nbsp;<span class="ident" id="3942657">raddr</span>&nbsp;<span class="op" id="3942663">*</span><span class="ident" id="3942664">IPAddr</span><span class="op" id="3942670">)</span>&nbsp;<span class="op" id="3942672">(</span><span class="op" id="3942673">*</span><span class="ident" id="3942674">IPConn</span><span class="op" id="3942680">,</span>&nbsp;<span class="builtintype" id="3942682">error</span><span class="op" id="3942687">)</span>&nbsp;<span class="op" id="3942689">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942692">return</span>&nbsp;<span class="ident" id="3942699">dialIP</span><span class="op" id="3942705">(</span><span class="ident" id="3942706">netProto</span><span class="op" id="3942714">,</span>&nbsp;<span class="ident" id="3942716">laddr</span><span class="op" id="3942721">,</span>&nbsp;<span class="ident" id="3942723">raddr</span><span class="op" id="3942728">,</span>&nbsp;<span class="ident" id="3942730">noDeadline</span><span class="op" id="3942740">)</span><br>
<span class="lineno"></span><span class="op" id="3942742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3942745">func</span>&nbsp;<span class="ident" id="3942750">dialIP</span><span class="op" id="3942756">(</span><span class="ident" id="3942757">netProto</span>&nbsp;<span class="builtintype" id="3942766">string</span><span class="op" id="3942772">,</span>&nbsp;<span class="ident" id="3942774">laddr</span><span class="op" id="3942779">,</span>&nbsp;<span class="ident" id="3942781">raddr</span>&nbsp;<span class="op" id="3942787">*</span><span class="ident" id="3942788">IPAddr</span><span class="op" id="3942794">,</span>&nbsp;<span class="ident" id="3942796">deadline</span>&nbsp;<span class="ident" id="3942805">time</span><span class="op" id="3942809">.</span><span class="ident" id="3942810">Time</span><span class="op" id="3942814">)</span>&nbsp;<span class="op" id="3942816">(</span><span class="op" id="3942817">*</span><span class="ident" id="3942818">IPConn</span><span class="op" id="3942824">,</span>&nbsp;<span class="builtintype" id="3942826">error</span><span class="op" id="3942831">)</span>&nbsp;<span class="op" id="3942833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942836">net</span><span class="op" id="3942839">,</span>&nbsp;<span class="ident" id="3942841">proto</span><span class="op" id="3942846">,</span>&nbsp;<span class="ident" id="3942848">err</span>&nbsp;<span class="op" id="3942852">:=</span>&nbsp;<span class="ident" id="3942855">parseNetwork</span><span class="op" id="3942867">(</span><span class="ident" id="3942868">netProto</span><span class="op" id="3942876">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942879">if</span>&nbsp;<span class="ident" id="3942882">err</span>&nbsp;<span class="op" id="3942886">!=</span>&nbsp;<span class="builtintype" id="3942889">nil</span>&nbsp;<span class="op" id="3942893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942897">return</span>&nbsp;<span class="builtintype" id="3942904">nil</span><span class="op" id="3942907">,</span>&nbsp;<span class="op" id="3942909">&amp;</span><span class="ident" id="3942910">OpError</span><span class="op" id="3942917">{</span><span class="ident" id="3942918">Op</span><span class="op" id="3942920">:</span>&nbsp;<span class="string" id="3942922">&#34;dial&#34;</span><span class="op" id="3942928">,</span>&nbsp;<span class="ident" id="3942930">Net</span><span class="op" id="3942933">:</span>&nbsp;<span class="ident" id="3942935">netProto</span><span class="op" id="3942943">,</span>&nbsp;<span class="ident" id="3942945">Addr</span><span class="op" id="3942949">:</span>&nbsp;<span class="ident" id="3942951">raddr</span><span class="op" id="3942956">,</span>&nbsp;<span class="ident" id="3942958">Err</span><span class="op" id="3942961">:</span>&nbsp;<span class="ident" id="3942963">err</span><span class="op" id="3942966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3942969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942972">switch</span>&nbsp;<span class="ident" id="3942979">net</span>&nbsp;<span class="op" id="3942983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942986">case</span>&nbsp;<span class="string" id="3942991">&#34;ip&#34;</span><span class="op" id="3942995">,</span>&nbsp;<span class="string" id="3942997">&#34;ip4&#34;</span><span class="op" id="3943002">,</span>&nbsp;<span class="string" id="3943004">&#34;ip6&#34;</span><span class="op" id="3943009">:</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943012">default</span><span class="op" id="3943019">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943023">return</span>&nbsp;<span class="builtintype" id="3943030">nil</span><span class="op" id="3943033">,</span>&nbsp;<span class="op" id="3943035">&amp;</span><span class="ident" id="3943036">OpError</span><span class="op" id="3943043">{</span><span class="ident" id="3943044">Op</span><span class="op" id="3943046">:</span>&nbsp;<span class="string" id="3943048">&#34;dial&#34;</span><span class="op" id="3943054">,</span>&nbsp;<span class="ident" id="3943056">Net</span><span class="op" id="3943059">:</span>&nbsp;<span class="ident" id="3943061">netProto</span><span class="op" id="3943069">,</span>&nbsp;<span class="ident" id="3943071">Addr</span><span class="op" id="3943075">:</span>&nbsp;<span class="ident" id="3943077">raddr</span><span class="op" id="3943082">,</span>&nbsp;<span class="ident" id="3943084">Err</span><span class="op" id="3943087">:</span>&nbsp;<span class="ident" id="3943089">UnknownNetworkError</span><span class="op" id="3943108">(</span><span class="ident" id="3943109">netProto</span><span class="op" id="3943117">)</span><span class="op" id="3943118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3943121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943124">if</span>&nbsp;<span class="ident" id="3943127">raddr</span>&nbsp;<span class="op" id="3943133">==</span>&nbsp;<span class="builtintype" id="3943136">nil</span>&nbsp;<span class="op" id="3943140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943144">return</span>&nbsp;<span class="builtintype" id="3943151">nil</span><span class="op" id="3943154">,</span>&nbsp;<span class="op" id="3943156">&amp;</span><span class="ident" id="3943157">OpError</span><span class="op" id="3943164">{</span><span class="ident" id="3943165">Op</span><span class="op" id="3943167">:</span>&nbsp;<span class="string" id="3943169">&#34;dial&#34;</span><span class="op" id="3943175">,</span>&nbsp;<span class="ident" id="3943177">Net</span><span class="op" id="3943180">:</span>&nbsp;<span class="ident" id="3943182">netProto</span><span class="op" id="3943190">,</span>&nbsp;<span class="ident" id="3943192">Addr</span><span class="op" id="3943196">:</span>&nbsp;<span class="builtintype" id="3943198">nil</span><span class="op" id="3943201">,</span>&nbsp;<span class="ident" id="3943203">Err</span><span class="op" id="3943206">:</span>&nbsp;<span class="ident" id="3943208">errMissingAddress</span><span class="op" id="3943225">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3943228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3943231">fd</span><span class="op" id="3943233">,</span>&nbsp;<span class="ident" id="3943235">err</span>&nbsp;<span class="op" id="3943239">:=</span>&nbsp;<span class="ident" id="3943242">internetSocket</span><span class="op" id="3943256">(</span><span class="ident" id="3943257">net</span><span class="op" id="3943260">,</span>&nbsp;<span class="ident" id="3943262">laddr</span><span class="op" id="3943267">,</span>&nbsp;<span class="ident" id="3943269">raddr</span><span class="op" id="3943274">,</span>&nbsp;<span class="ident" id="3943276">deadline</span><span class="op" id="3943284">,</span>&nbsp;<span class="ident" id="3943286">syscall</span><span class="op" id="3943293">.</span><span class="ident" id="3943294">SOCK_RAW</span><span class="op" id="3943302">,</span>&nbsp;<span class="ident" id="3943304">proto</span><span class="op" id="3943309">,</span>&nbsp;<span class="string" id="3943311">&#34;dial&#34;</span><span class="op" id="3943317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943320">if</span>&nbsp;<span class="ident" id="3943323">err</span>&nbsp;<span class="op" id="3943327">!=</span>&nbsp;<span class="builtintype" id="3943330">nil</span>&nbsp;<span class="op" id="3943334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943338">return</span>&nbsp;<span class="builtintype" id="3943345">nil</span><span class="op" id="3943348">,</span>&nbsp;<span class="op" id="3943350">&amp;</span><span class="ident" id="3943351">OpError</span><span class="op" id="3943358">{</span><span class="ident" id="3943359">Op</span><span class="op" id="3943361">:</span>&nbsp;<span class="string" id="3943363">&#34;dial&#34;</span><span class="op" id="3943369">,</span>&nbsp;<span class="ident" id="3943371">Net</span><span class="op" id="3943374">:</span>&nbsp;<span class="ident" id="3943376">netProto</span><span class="op" id="3943384">,</span>&nbsp;<span class="ident" id="3943386">Addr</span><span class="op" id="3943390">:</span>&nbsp;<span class="ident" id="3943392">raddr</span><span class="op" id="3943397">,</span>&nbsp;<span class="ident" id="3943399">Err</span><span class="op" id="3943402">:</span>&nbsp;<span class="ident" id="3943404">err</span><span class="op" id="3943407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3943410">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943413">return</span>&nbsp;<span class="ident" id="3943420">newIPConn</span><span class="op" id="3943429">(</span><span class="ident" id="3943430">fd</span><span class="op" id="3943432">)</span><span class="op" id="3943433">,</span>&nbsp;<span class="builtintype" id="3943435">nil</span><br>
<span class="lineno"></span><span class="op" id="3943439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3943442">//&nbsp;ListenIP&nbsp;listens&nbsp;for&nbsp;incoming&nbsp;IP&nbsp;packets&nbsp;addressed&nbsp;to&nbsp;the&nbsp;local</span><br>
<span class="lineno"></span><span class="comment" id="3943509">//&nbsp;address&nbsp;laddr.&nbsp;&nbsp;The&nbsp;returned&nbsp;connection&#39;s&nbsp;ReadFrom&nbsp;and&nbsp;WriteTo</span><br>
<span class="lineno">210</span><span class="comment" id="3943575">//&nbsp;methods&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;receive&nbsp;and&nbsp;send&nbsp;IP&nbsp;packets&nbsp;with&nbsp;per-packet</span><br>
<span class="lineno"></span><span class="comment" id="3943645">//&nbsp;addressing.</span><br>
<span class="lineno"></span><span class="keyword" id="3943660">func</span>&nbsp;<span class="ident" id="3943665">ListenIP</span><span class="op" id="3943673">(</span><span class="ident" id="3943674">netProto</span>&nbsp;<span class="builtintype" id="3943683">string</span><span class="op" id="3943689">,</span>&nbsp;<span class="ident" id="3943691">laddr</span>&nbsp;<span class="op" id="3943697">*</span><span class="ident" id="3943698">IPAddr</span><span class="op" id="3943704">)</span>&nbsp;<span class="op" id="3943706">(</span><span class="op" id="3943707">*</span><span class="ident" id="3943708">IPConn</span><span class="op" id="3943714">,</span>&nbsp;<span class="builtintype" id="3943716">error</span><span class="op" id="3943721">)</span>&nbsp;<span class="op" id="3943723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3943726">net</span><span class="op" id="3943729">,</span>&nbsp;<span class="ident" id="3943731">proto</span><span class="op" id="3943736">,</span>&nbsp;<span class="ident" id="3943738">err</span>&nbsp;<span class="op" id="3943742">:=</span>&nbsp;<span class="ident" id="3943745">parseNetwork</span><span class="op" id="3943757">(</span><span class="ident" id="3943758">netProto</span><span class="op" id="3943766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943769">if</span>&nbsp;<span class="ident" id="3943772">err</span>&nbsp;<span class="op" id="3943776">!=</span>&nbsp;<span class="builtintype" id="3943779">nil</span>&nbsp;<span class="op" id="3943783">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943787">return</span>&nbsp;<span class="builtintype" id="3943794">nil</span><span class="op" id="3943797">,</span>&nbsp;<span class="op" id="3943799">&amp;</span><span class="ident" id="3943800">OpError</span><span class="op" id="3943807">{</span><span class="ident" id="3943808">Op</span><span class="op" id="3943810">:</span>&nbsp;<span class="string" id="3943812">&#34;dial&#34;</span><span class="op" id="3943818">,</span>&nbsp;<span class="ident" id="3943820">Net</span><span class="op" id="3943823">:</span>&nbsp;<span class="ident" id="3943825">netProto</span><span class="op" id="3943833">,</span>&nbsp;<span class="ident" id="3943835">Addr</span><span class="op" id="3943839">:</span>&nbsp;<span class="ident" id="3943841">laddr</span><span class="op" id="3943846">,</span>&nbsp;<span class="ident" id="3943848">Err</span><span class="op" id="3943851">:</span>&nbsp;<span class="ident" id="3943853">err</span><span class="op" id="3943856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3943859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943862">switch</span>&nbsp;<span class="ident" id="3943869">net</span>&nbsp;<span class="op" id="3943873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943876">case</span>&nbsp;<span class="string" id="3943881">&#34;ip&#34;</span><span class="op" id="3943885">,</span>&nbsp;<span class="string" id="3943887">&#34;ip4&#34;</span><span class="op" id="3943892">,</span>&nbsp;<span class="string" id="3943894">&#34;ip6&#34;</span><span class="op" id="3943899">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943902">default</span><span class="op" id="3943909">:</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943913">return</span>&nbsp;<span class="builtintype" id="3943920">nil</span><span class="op" id="3943923">,</span>&nbsp;<span class="op" id="3943925">&amp;</span><span class="ident" id="3943926">OpError</span><span class="op" id="3943933">{</span><span class="ident" id="3943934">Op</span><span class="op" id="3943936">:</span>&nbsp;<span class="string" id="3943938">&#34;listen&#34;</span><span class="op" id="3943946">,</span>&nbsp;<span class="ident" id="3943948">Net</span><span class="op" id="3943951">:</span>&nbsp;<span class="ident" id="3943953">netProto</span><span class="op" id="3943961">,</span>&nbsp;<span class="ident" id="3943963">Addr</span><span class="op" id="3943967">:</span>&nbsp;<span class="ident" id="3943969">laddr</span><span class="op" id="3943974">,</span>&nbsp;<span class="ident" id="3943976">Err</span><span class="op" id="3943979">:</span>&nbsp;<span class="ident" id="3943981">UnknownNetworkError</span><span class="op" id="3944000">(</span><span class="ident" id="3944001">netProto</span><span class="op" id="3944009">)</span><span class="op" id="3944010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3944013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944016">fd</span><span class="op" id="3944018">,</span>&nbsp;<span class="ident" id="3944020">err</span>&nbsp;<span class="op" id="3944024">:=</span>&nbsp;<span class="ident" id="3944027">internetSocket</span><span class="op" id="3944041">(</span><span class="ident" id="3944042">net</span><span class="op" id="3944045">,</span>&nbsp;<span class="ident" id="3944047">laddr</span><span class="op" id="3944052">,</span>&nbsp;<span class="builtintype" id="3944054">nil</span><span class="op" id="3944057">,</span>&nbsp;<span class="ident" id="3944059">noDeadline</span><span class="op" id="3944069">,</span>&nbsp;<span class="ident" id="3944071">syscall</span><span class="op" id="3944078">.</span><span class="ident" id="3944079">SOCK_RAW</span><span class="op" id="3944087">,</span>&nbsp;<span class="ident" id="3944089">proto</span><span class="op" id="3944094">,</span>&nbsp;<span class="string" id="3944096">&#34;listen&#34;</span><span class="op" id="3944104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944107">if</span>&nbsp;<span class="ident" id="3944110">err</span>&nbsp;<span class="op" id="3944114">!=</span>&nbsp;<span class="builtintype" id="3944117">nil</span>&nbsp;<span class="op" id="3944121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944125">return</span>&nbsp;<span class="builtintype" id="3944132">nil</span><span class="op" id="3944135">,</span>&nbsp;<span class="op" id="3944137">&amp;</span><span class="ident" id="3944138">OpError</span><span class="op" id="3944145">{</span><span class="ident" id="3944146">Op</span><span class="op" id="3944148">:</span>&nbsp;<span class="string" id="3944150">&#34;listen&#34;</span><span class="op" id="3944158">,</span>&nbsp;<span class="ident" id="3944160">Net</span><span class="op" id="3944163">:</span>&nbsp;<span class="ident" id="3944165">netProto</span><span class="op" id="3944173">,</span>&nbsp;<span class="ident" id="3944175">Addr</span><span class="op" id="3944179">:</span>&nbsp;<span class="ident" id="3944181">laddr</span><span class="op" id="3944186">,</span>&nbsp;<span class="ident" id="3944188">Err</span><span class="op" id="3944191">:</span>&nbsp;<span class="ident" id="3944193">err</span><span class="op" id="3944196">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3944199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944202">return</span>&nbsp;<span class="ident" id="3944209">newIPConn</span><span class="op" id="3944218">(</span><span class="ident" id="3944219">fd</span><span class="op" id="3944221">)</span><span class="op" id="3944222">,</span>&nbsp;<span class="builtintype" id="3944224">nil</span><br>
<span class="lineno"></span><span class="op" id="3944228">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
