<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime/multipart</h2>
<ul>
<li><a href="/gostd/mime/multipart/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/mime/multipart/formdata.go.html">formdata.go</a></li>
<li><a href="/gostd/mime/multipart/formdata_test.go.html">formdata_test.go</a></li>
<li><a href="/gostd/mime/multipart/multipart.go.html">multipart.go</a></li>
<li><a href="/gostd/mime/multipart/multipart_test.go.html">multipart_test.go</a></li>
<li><a href="/gostd/mime/multipart/quotedprintable.go.html">quotedprintable.go</a></li>
<li><a href="/gostd/mime/multipart/quotedprintable_test.go.html" class="current">quotedprintable_test.go</a></li>
<li><a href="/gostd/mime/multipart/writer.go.html">writer.go</a></li>
<li><a href="/gostd/mime/multipart/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8029790">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8029845">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8029899">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8029950">package</span>&nbsp;<span class="ident" id="8029958">multipart</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8029969">import</span>&nbsp;<span class="op" id="8029976">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8029979">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8029988">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8029997">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8030007">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8030015">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8030022">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8030028">&#34;os/exec&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8030039">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8030049">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8030057">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8030068">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8030079">&#34;time&#34;</span><br>
<span class="lineno">20</span><span class="op" id="8030086">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8030089">func</span>&nbsp;<span class="ident" id="8030094">TestQuotedPrintable</span><span class="op" id="8030113">(</span><span class="ident" id="8030114">t</span>&nbsp;<span class="op" id="8030116">*</span><span class="ident" id="8030117">testing</span><span class="op" id="8030124">.</span><span class="ident" id="8030125">T</span><span class="op" id="8030126">)</span>&nbsp;<span class="op" id="8030128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8030131">tests</span>&nbsp;<span class="op" id="8030137">:=</span>&nbsp;<span class="op" id="8030140">[</span><span class="op" id="8030141">]</span><span class="keyword" id="8030142">struct</span>&nbsp;<span class="op" id="8030149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8030153">in</span><span class="op" id="8030155">,</span>&nbsp;<span class="ident" id="8030157">want</span>&nbsp;<span class="builtintype" id="8030162">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8030171">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8030180">interface</span><span class="op" id="8030189">{</span><span class="op" id="8030190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8030193">}</span><span class="op" id="8030194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8030198">{</span><span class="ident" id="8030199">in</span><span class="op" id="8030201">:</span>&nbsp;<span class="string" id="8030203">&#34;&#34;</span><span class="op" id="8030205">,</span>&nbsp;<span class="ident" id="8030207">want</span><span class="op" id="8030211">:</span>&nbsp;<span class="string" id="8030213">&#34;&#34;</span><span class="op" id="8030215">}</span><span class="op" id="8030216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8030220">{</span><span class="ident" id="8030221">in</span><span class="op" id="8030223">:</span>&nbsp;<span class="string" id="8030225">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8030234">,</span>&nbsp;<span class="ident" id="8030236">want</span><span class="op" id="8030240">:</span>&nbsp;<span class="string" id="8030242">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8030251">}</span><span class="op" id="8030252">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8030256">{</span><span class="ident" id="8030257">in</span><span class="op" id="8030259">:</span>&nbsp;<span class="string" id="8030261">&#34;foo&nbsp;bar=3D&#34;</span><span class="op" id="8030273">,</span>&nbsp;<span class="ident" id="8030275">want</span><span class="op" id="8030279">:</span>&nbsp;<span class="string" id="8030281">&#34;foo&nbsp;bar=&#34;</span><span class="op" id="8030291">}</span><span class="op" id="8030292">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8030296">{</span><span class="ident" id="8030297">in</span><span class="op" id="8030299">:</span>&nbsp;<span class="string" id="8030301">&#34;foo&nbsp;bar=\n&#34;</span><span class="op" id="8030313">,</span>&nbsp;<span class="ident" id="8030315">want</span><span class="op" id="8030319">:</span>&nbsp;<span class="string" id="8030321">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8030330">}</span><span class="op" id="8030331">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8030335">{</span><span class="ident" id="8030336">in</span><span class="op" id="8030338">:</span>&nbsp;<span class="string" id="8030340">&#34;foo&nbsp;bar\n&#34;</span><span class="op" id="8030351">,</span>&nbsp;<span class="ident" id="8030353">want</span><span class="op" id="8030357">:</span>&nbsp;<span class="string" id="8030359">&#34;foo&nbsp;bar\n&#34;</span><span class="op" id="8030370">}</span><span class="op" id="8030371">,</span>&nbsp;<span class="comment" id="8030373">//&nbsp;somewhat&nbsp;lax.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8030392">{</span><span class="ident" id="8030393">in</span><span class="op" id="8030395">:</span>&nbsp;<span class="string" id="8030397">&#34;foo&nbsp;bar=0&#34;</span><span class="op" id="8030408">,</span>&nbsp;<span class="ident" id="8030410">want</span><span class="op" id="8030414">:</span>&nbsp;<span class="string" id="8030416">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8030425">,</span>&nbsp;<span class="ident" id="8030427">err</span><span class="op" id="8030430">:</span>&nbsp;<span class="ident" id="8030432">io</span><span class="op" id="8030434">.</span><span class="ident" id="8030435">ErrUnexpectedEOF</span><span class="op" id="8030451">}</span><span class="op" id="8030452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8030456">{</span><span class="ident" id="8030457">in</span><span class="op" id="8030459">:</span>&nbsp;<span class="string" id="8030461">&#34;foo&nbsp;bar=ab&#34;</span><span class="op" id="8030473">,</span>&nbsp;<span class="ident" id="8030475">want</span><span class="op" id="8030479">:</span>&nbsp;<span class="string" id="8030481">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8030490">,</span>&nbsp;<span class="ident" id="8030492">err</span><span class="op" id="8030495">:</span>&nbsp;<span class="string" id="8030497">&#34;multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x61&#34;</span><span class="op" id="8030548">}</span><span class="op" id="8030549">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8030553">{</span><span class="ident" id="8030554">in</span><span class="op" id="8030556">:</span>&nbsp;<span class="string" id="8030558">&#34;foo&nbsp;bar=0D=0A&#34;</span><span class="op" id="8030573">,</span>&nbsp;<span class="ident" id="8030575">want</span><span class="op" id="8030579">:</span>&nbsp;<span class="string" id="8030581">&#34;foo&nbsp;bar\r\n&#34;</span><span class="op" id="8030594">}</span><span class="op" id="8030595">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8030599">{</span><span class="ident" id="8030600">in</span><span class="op" id="8030602">:</span>&nbsp;<span class="string" id="8030604">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;C&nbsp;&#34;</span><span class="op" id="8030625">,</span>&nbsp;<span class="ident" id="8030627">want</span><span class="op" id="8030631">:</span>&nbsp;<span class="string" id="8030633">&#34;&nbsp;A&nbsp;B\r\n&nbsp;C&#34;</span><span class="op" id="8030645">}</span><span class="op" id="8030646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8030650">{</span><span class="ident" id="8030651">in</span><span class="op" id="8030653">:</span>&nbsp;<span class="string" id="8030655">&#34;&nbsp;A&nbsp;B&nbsp;=\r\n&nbsp;C&nbsp;&#34;</span><span class="op" id="8030670">,</span>&nbsp;<span class="ident" id="8030672">want</span><span class="op" id="8030676">:</span>&nbsp;<span class="string" id="8030678">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;C&#34;</span><span class="op" id="8030687">}</span><span class="op" id="8030688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8030692">{</span><span class="ident" id="8030693">in</span><span class="op" id="8030695">:</span>&nbsp;<span class="string" id="8030697">&#34;&nbsp;A&nbsp;B&nbsp;=\n&nbsp;C&nbsp;&#34;</span><span class="op" id="8030710">,</span>&nbsp;<span class="ident" id="8030712">want</span><span class="op" id="8030716">:</span>&nbsp;<span class="string" id="8030718">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;C&#34;</span><span class="op" id="8030727">}</span><span class="op" id="8030728">,</span>&nbsp;<span class="comment" id="8030730">//&nbsp;lax.&nbsp;treating&nbsp;LF&nbsp;as&nbsp;CRLF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8030760">{</span><span class="ident" id="8030761">in</span><span class="op" id="8030763">:</span>&nbsp;<span class="string" id="8030765">&#34;foo=\nbar&#34;</span><span class="op" id="8030776">,</span>&nbsp;<span class="ident" id="8030778">want</span><span class="op" id="8030782">:</span>&nbsp;<span class="string" id="8030784">&#34;foobar&#34;</span><span class="op" id="8030792">}</span><span class="op" id="8030793">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8030797">{</span><span class="ident" id="8030798">in</span><span class="op" id="8030800">:</span>&nbsp;<span class="string" id="8030802">&#34;foo\x00bar&#34;</span><span class="op" id="8030814">,</span>&nbsp;<span class="ident" id="8030816">want</span><span class="op" id="8030820">:</span>&nbsp;<span class="string" id="8030822">&#34;foo&#34;</span><span class="op" id="8030827">,</span>&nbsp;<span class="ident" id="8030829">err</span><span class="op" id="8030832">:</span>&nbsp;<span class="string" id="8030834">&#34;multipart:&nbsp;invalid&nbsp;unescaped&nbsp;byte&nbsp;0x00&nbsp;in&nbsp;quoted-printable&nbsp;body&#34;</span><span class="op" id="8030899">}</span><span class="op" id="8030900">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8030904">{</span><span class="ident" id="8030905">in</span><span class="op" id="8030907">:</span>&nbsp;<span class="string" id="8030909">&#34;foo&nbsp;bar\xff&#34;</span><span class="op" id="8030922">,</span>&nbsp;<span class="ident" id="8030924">want</span><span class="op" id="8030928">:</span>&nbsp;<span class="string" id="8030930">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8030939">,</span>&nbsp;<span class="ident" id="8030941">err</span><span class="op" id="8030944">:</span>&nbsp;<span class="string" id="8030946">&#34;multipart:&nbsp;invalid&nbsp;unescaped&nbsp;byte&nbsp;0xff&nbsp;in&nbsp;quoted-printable&nbsp;body&#34;</span><span class="op" id="8031011">}</span><span class="op" id="8031012">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8031017">//&nbsp;Equal&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8031034">{</span><span class="ident" id="8031035">in</span><span class="op" id="8031037">:</span>&nbsp;<span class="string" id="8031039">&#34;=3D30\n&#34;</span><span class="op" id="8031048">,</span>&nbsp;<span class="ident" id="8031050">want</span><span class="op" id="8031054">:</span>&nbsp;<span class="string" id="8031056">&#34;=30\n&#34;</span><span class="op" id="8031063">}</span><span class="op" id="8031064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8031068">{</span><span class="ident" id="8031069">in</span><span class="op" id="8031071">:</span>&nbsp;<span class="string" id="8031073">&#34;=00=FF0=\n&#34;</span><span class="op" id="8031085">,</span>&nbsp;<span class="ident" id="8031087">want</span><span class="op" id="8031091">:</span>&nbsp;<span class="string" id="8031093">&#34;\x00\xff0&#34;</span><span class="op" id="8031104">}</span><span class="op" id="8031105">,</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8031110">//&nbsp;Trailing&nbsp;whitespace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8031135">{</span><span class="ident" id="8031136">in</span><span class="op" id="8031138">:</span>&nbsp;<span class="string" id="8031140">&#34;foo&nbsp;&nbsp;\n&#34;</span><span class="op" id="8031149">,</span>&nbsp;<span class="ident" id="8031151">want</span><span class="op" id="8031155">:</span>&nbsp;<span class="string" id="8031157">&#34;foo\n&#34;</span><span class="op" id="8031164">}</span><span class="op" id="8031165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8031169">{</span><span class="ident" id="8031170">in</span><span class="op" id="8031172">:</span>&nbsp;<span class="string" id="8031174">&#34;foo&nbsp;&nbsp;\n\nfoo&nbsp;=\n\nfoo=20\n\n&#34;</span><span class="op" id="8031204">,</span>&nbsp;<span class="ident" id="8031206">want</span><span class="op" id="8031210">:</span>&nbsp;<span class="string" id="8031212">&#34;foo\n\nfoo&nbsp;\nfoo&nbsp;\n\n&#34;</span><span class="op" id="8031235">}</span><span class="op" id="8031236">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8031241">//&nbsp;Tests&nbsp;that&nbsp;we&nbsp;allow&nbsp;bare&nbsp;\n&nbsp;and&nbsp;\r&nbsp;through,&nbsp;despite&nbsp;it&nbsp;being&nbsp;strictly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8031316">//&nbsp;not&nbsp;permitted&nbsp;per&nbsp;RFC&nbsp;2045,&nbsp;Section&nbsp;6.7&nbsp;Page&nbsp;22&nbsp;bullet&nbsp;(4).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8031381">{</span><span class="ident" id="8031382">in</span><span class="op" id="8031384">:</span>&nbsp;<span class="string" id="8031386">&#34;foo\nbar&#34;</span><span class="op" id="8031396">,</span>&nbsp;<span class="ident" id="8031398">want</span><span class="op" id="8031402">:</span>&nbsp;<span class="string" id="8031404">&#34;foo\nbar&#34;</span><span class="op" id="8031414">}</span><span class="op" id="8031415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8031419">{</span><span class="ident" id="8031420">in</span><span class="op" id="8031422">:</span>&nbsp;<span class="string" id="8031424">&#34;foo\rbar&#34;</span><span class="op" id="8031434">,</span>&nbsp;<span class="ident" id="8031436">want</span><span class="op" id="8031440">:</span>&nbsp;<span class="string" id="8031442">&#34;foo\rbar&#34;</span><span class="op" id="8031452">}</span><span class="op" id="8031453">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8031457">{</span><span class="ident" id="8031458">in</span><span class="op" id="8031460">:</span>&nbsp;<span class="string" id="8031462">&#34;foo\r\nbar&#34;</span><span class="op" id="8031474">,</span>&nbsp;<span class="ident" id="8031476">want</span><span class="op" id="8031480">:</span>&nbsp;<span class="string" id="8031482">&#34;foo\r\nbar&#34;</span><span class="op" id="8031494">}</span><span class="op" id="8031495">,</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8031500">//&nbsp;Different&nbsp;types&nbsp;of&nbsp;soft&nbsp;line-breaks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8031542">{</span><span class="ident" id="8031543">in</span><span class="op" id="8031545">:</span>&nbsp;<span class="string" id="8031547">&#34;foo=\r\nbar&#34;</span><span class="op" id="8031560">,</span>&nbsp;<span class="ident" id="8031562">want</span><span class="op" id="8031566">:</span>&nbsp;<span class="string" id="8031568">&#34;foobar&#34;</span><span class="op" id="8031576">}</span><span class="op" id="8031577">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8031581">{</span><span class="ident" id="8031582">in</span><span class="op" id="8031584">:</span>&nbsp;<span class="string" id="8031586">&#34;foo=\nbar&#34;</span><span class="op" id="8031597">,</span>&nbsp;<span class="ident" id="8031599">want</span><span class="op" id="8031603">:</span>&nbsp;<span class="string" id="8031605">&#34;foobar&#34;</span><span class="op" id="8031613">}</span><span class="op" id="8031614">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8031618">{</span><span class="ident" id="8031619">in</span><span class="op" id="8031621">:</span>&nbsp;<span class="string" id="8031623">&#34;foo=\rbar&#34;</span><span class="op" id="8031634">,</span>&nbsp;<span class="ident" id="8031636">want</span><span class="op" id="8031640">:</span>&nbsp;<span class="string" id="8031642">&#34;foo&#34;</span><span class="op" id="8031647">,</span>&nbsp;<span class="ident" id="8031649">err</span><span class="op" id="8031652">:</span>&nbsp;<span class="string" id="8031654">&#34;multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0d&#34;</span><span class="op" id="8031705">}</span><span class="op" id="8031706">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8031710">{</span><span class="ident" id="8031711">in</span><span class="op" id="8031713">:</span>&nbsp;<span class="string" id="8031715">&#34;foo=\r\r\r&nbsp;\nbar&#34;</span><span class="op" id="8031733">,</span>&nbsp;<span class="ident" id="8031735">want</span><span class="op" id="8031739">:</span>&nbsp;<span class="string" id="8031741">&#34;foo&#34;</span><span class="op" id="8031746">,</span>&nbsp;<span class="ident" id="8031748">err</span><span class="op" id="8031751">:</span>&nbsp;<span class="string" id="8031753">`multipart:&nbsp;invalid&nbsp;bytes&nbsp;after&nbsp;=:&nbsp;&#34;\r\r\r&nbsp;\n&#34;`</span><span class="op" id="8031800">}</span><span class="op" id="8031801">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8031806">//&nbsp;Example&nbsp;from&nbsp;RFC&nbsp;2045:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8031834">{</span><span class="ident" id="8031835">in</span><span class="op" id="8031837">:</span>&nbsp;<span class="string" id="8031839">&#34;Now&#39;s&nbsp;the&nbsp;time&nbsp;=\n&#34;</span>&nbsp;<span class="op" id="8031860">+</span>&nbsp;<span class="string" id="8031862">&#34;for&nbsp;all&nbsp;folk&nbsp;to&nbsp;come=\n&#34;</span>&nbsp;<span class="op" id="8031888">+</span>&nbsp;<span class="string" id="8031890">&#34;&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="8031921">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8031926">want</span><span class="op" id="8031930">:</span>&nbsp;<span class="string" id="8031932">&#34;Now&#39;s&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;folk&nbsp;to&nbsp;come&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="8031998">}</span><span class="op" id="8031999">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8032002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8032005">for</span>&nbsp;<span class="ident" id="8032009">_</span><span class="op" id="8032010">,</span>&nbsp;<span class="ident" id="8032012">tt</span>&nbsp;<span class="op" id="8032015">:=</span>&nbsp;<span class="keyword" id="8032018">range</span>&nbsp;<span class="ident" id="8032024">tests</span>&nbsp;<span class="op" id="8032030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8032034">var</span>&nbsp;<span class="ident" id="8032038">buf</span>&nbsp;<span class="ident" id="8032042">bytes</span><span class="op" id="8032047">.</span><span class="ident" id="8032048">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032057">_</span><span class="op" id="8032058">,</span>&nbsp;<span class="ident" id="8032060">err</span>&nbsp;<span class="op" id="8032064">:=</span>&nbsp;<span class="ident" id="8032067">io</span><span class="op" id="8032069">.</span><span class="ident" id="8032070">Copy</span><span class="op" id="8032074">(</span><span class="op" id="8032075">&amp;</span><span class="ident" id="8032076">buf</span><span class="op" id="8032079">,</span>&nbsp;<span class="ident" id="8032081">newQuotedPrintableReader</span><span class="op" id="8032105">(</span><span class="ident" id="8032106">strings</span><span class="op" id="8032113">.</span><span class="ident" id="8032114">NewReader</span><span class="op" id="8032123">(</span><span class="ident" id="8032124">tt</span><span class="op" id="8032126">.</span><span class="ident" id="8032127">in</span><span class="op" id="8032129">)</span><span class="op" id="8032130">)</span><span class="op" id="8032131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8032135">if</span>&nbsp;<span class="ident" id="8032138">got</span>&nbsp;<span class="op" id="8032142">:=</span>&nbsp;<span class="ident" id="8032145">buf</span><span class="op" id="8032148">.</span><span class="ident" id="8032149">String</span><span class="op" id="8032155">(</span><span class="op" id="8032156">)</span><span class="op" id="8032157">;</span>&nbsp;<span class="ident" id="8032159">got</span>&nbsp;<span class="op" id="8032163">!=</span>&nbsp;<span class="ident" id="8032166">tt</span><span class="op" id="8032168">.</span><span class="ident" id="8032169">want</span>&nbsp;<span class="op" id="8032174">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032179">t</span><span class="op" id="8032180">.</span><span class="ident" id="8032181">Errorf</span><span class="op" id="8032187">(</span><span class="string" id="8032188">&#34;for&nbsp;%q,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8032213">,</span>&nbsp;<span class="ident" id="8032215">tt</span><span class="op" id="8032217">.</span><span class="ident" id="8032218">in</span><span class="op" id="8032220">,</span>&nbsp;<span class="ident" id="8032222">got</span><span class="op" id="8032225">,</span>&nbsp;<span class="ident" id="8032227">tt</span><span class="op" id="8032229">.</span><span class="ident" id="8032230">want</span><span class="op" id="8032234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8032238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8032242">switch</span>&nbsp;<span class="ident" id="8032249">verr</span>&nbsp;<span class="op" id="8032254">:=</span>&nbsp;<span class="ident" id="8032257">tt</span><span class="op" id="8032259">.</span><span class="ident" id="8032260">err</span><span class="op" id="8032263">.</span><span class="op" id="8032264">(</span><span class="keyword" id="8032265">type</span><span class="op" id="8032269">)</span>&nbsp;<span class="op" id="8032271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8032275">case</span>&nbsp;<span class="builtintype" id="8032280">nil</span><span class="op" id="8032283">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8032288">if</span>&nbsp;<span class="ident" id="8032291">err</span>&nbsp;<span class="op" id="8032295">!=</span>&nbsp;<span class="builtintype" id="8032298">nil</span>&nbsp;<span class="op" id="8032302">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032308">t</span><span class="op" id="8032309">.</span><span class="ident" id="8032310">Errorf</span><span class="op" id="8032316">(</span><span class="string" id="8032317">&#34;for&nbsp;%q,&nbsp;got&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8032351">,</span>&nbsp;<span class="ident" id="8032353">tt</span><span class="op" id="8032355">.</span><span class="ident" id="8032356">in</span><span class="op" id="8032358">,</span>&nbsp;<span class="ident" id="8032360">err</span><span class="op" id="8032363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8032368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8032372">case</span>&nbsp;<span class="builtintype" id="8032377">string</span><span class="op" id="8032383">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8032388">if</span>&nbsp;<span class="ident" id="8032391">got</span>&nbsp;<span class="op" id="8032395">:=</span>&nbsp;<span class="ident" id="8032398">fmt</span><span class="op" id="8032401">.</span><span class="ident" id="8032402">Sprint</span><span class="op" id="8032408">(</span><span class="ident" id="8032409">err</span><span class="op" id="8032412">)</span><span class="op" id="8032413">;</span>&nbsp;<span class="ident" id="8032415">got</span>&nbsp;<span class="op" id="8032419">!=</span>&nbsp;<span class="ident" id="8032422">verr</span>&nbsp;<span class="op" id="8032427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032433">t</span><span class="op" id="8032434">.</span><span class="ident" id="8032435">Errorf</span><span class="op" id="8032441">(</span><span class="string" id="8032442">&#34;for&nbsp;%q,&nbsp;got&nbsp;error&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8032473">,</span>&nbsp;<span class="ident" id="8032475">tt</span><span class="op" id="8032477">.</span><span class="ident" id="8032478">in</span><span class="op" id="8032480">,</span>&nbsp;<span class="ident" id="8032482">got</span><span class="op" id="8032485">,</span>&nbsp;<span class="ident" id="8032487">verr</span><span class="op" id="8032491">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8032496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8032500">case</span>&nbsp;<span class="builtintype" id="8032505">error</span><span class="op" id="8032510">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8032515">if</span>&nbsp;<span class="ident" id="8032518">err</span>&nbsp;<span class="op" id="8032522">!=</span>&nbsp;<span class="ident" id="8032525">verr</span>&nbsp;<span class="op" id="8032530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032536">t</span><span class="op" id="8032537">.</span><span class="ident" id="8032538">Errorf</span><span class="op" id="8032544">(</span><span class="string" id="8032545">&#34;for&nbsp;%q,&nbsp;got&nbsp;error&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8032576">,</span>&nbsp;<span class="ident" id="8032578">tt</span><span class="op" id="8032580">.</span><span class="ident" id="8032581">in</span><span class="op" id="8032583">,</span>&nbsp;<span class="ident" id="8032585">err</span><span class="op" id="8032588">,</span>&nbsp;<span class="ident" id="8032590">verr</span><span class="op" id="8032594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8032599">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8032603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8032606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="8032609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="8032612">func</span>&nbsp;<span class="ident" id="8032617">everySequence</span><span class="op" id="8032630">(</span><span class="ident" id="8032631">base</span><span class="op" id="8032635">,</span>&nbsp;<span class="ident" id="8032637">alpha</span>&nbsp;<span class="builtintype" id="8032643">string</span><span class="op" id="8032649">,</span>&nbsp;<span class="ident" id="8032651">length</span>&nbsp;<span class="builtintype" id="8032658">int</span><span class="op" id="8032661">,</span>&nbsp;<span class="ident" id="8032663">fn</span>&nbsp;<span class="keyword" id="8032666">func</span><span class="op" id="8032670">(</span><span class="builtintype" id="8032671">string</span><span class="op" id="8032677">)</span><span class="op" id="8032678">)</span>&nbsp;<span class="op" id="8032680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8032683">if</span>&nbsp;<span class="builtinfunc" id="8032686">len</span><span class="op" id="8032689">(</span><span class="ident" id="8032690">base</span><span class="op" id="8032694">)</span>&nbsp;<span class="op" id="8032696">==</span>&nbsp;<span class="ident" id="8032699">length</span>&nbsp;<span class="op" id="8032706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032710">fn</span><span class="op" id="8032712">(</span><span class="ident" id="8032713">base</span><span class="op" id="8032717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8032721">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8032729">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8032732">for</span>&nbsp;<span class="ident" id="8032736">i</span>&nbsp;<span class="op" id="8032738">:=</span>&nbsp;<span class="num" id="8032741">0</span><span class="op" id="8032742">;</span>&nbsp;<span class="ident" id="8032744">i</span>&nbsp;<span class="op" id="8032746">&lt;</span>&nbsp;<span class="builtinfunc" id="8032748">len</span><span class="op" id="8032751">(</span><span class="ident" id="8032752">alpha</span><span class="op" id="8032757">)</span><span class="op" id="8032758">;</span>&nbsp;<span class="ident" id="8032760">i</span><span class="op" id="8032761">++</span>&nbsp;<span class="op" id="8032764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032768">everySequence</span><span class="op" id="8032781">(</span><span class="ident" id="8032782">base</span><span class="op" id="8032786">+</span><span class="ident" id="8032787">alpha</span><span class="op" id="8032792">[</span><span class="ident" id="8032793">i</span><span class="op" id="8032794">:</span><span class="ident" id="8032795">i</span><span class="op" id="8032796">+</span><span class="num" id="8032797">1</span><span class="op" id="8032798">]</span><span class="op" id="8032799">,</span>&nbsp;<span class="ident" id="8032801">alpha</span><span class="op" id="8032806">,</span>&nbsp;<span class="ident" id="8032808">length</span><span class="op" id="8032814">,</span>&nbsp;<span class="ident" id="8032816">fn</span><span class="op" id="8032818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8032821">}</span><br>
<span class="lineno"></span><span class="op" id="8032823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="8032826">var</span>&nbsp;<span class="ident" id="8032830">useQprint</span>&nbsp;<span class="op" id="8032840">=</span>&nbsp;<span class="ident" id="8032842">flag</span><span class="op" id="8032846">.</span><span class="ident" id="8032847">Bool</span><span class="op" id="8032851">(</span><span class="string" id="8032852">&#34;qprint&#34;</span><span class="op" id="8032860">,</span>&nbsp;<span class="builtintype" id="8032862">false</span><span class="op" id="8032867">,</span>&nbsp;<span class="string" id="8032869">&#34;Compare&nbsp;against&nbsp;the&nbsp;&#39;qprint&#39;&nbsp;program.&#34;</span><span class="op" id="8032908">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8032911">var</span>&nbsp;<span class="ident" id="8032915">badSoftRx</span>&nbsp;<span class="op" id="8032925">=</span>&nbsp;<span class="ident" id="8032927">regexp</span><span class="op" id="8032933">.</span><span class="ident" id="8032934">MustCompile</span><span class="op" id="8032945">(</span><span class="string" id="8032946">`=([^\r\n]+?\n)|([^\r\n]+$)|(\r$)|(\r[^\n]+\n)|(&nbsp;\r\n)`</span><span class="op" id="8033001">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8033004">func</span>&nbsp;<span class="ident" id="8033009">TestQPExhaustive</span><span class="op" id="8033025">(</span><span class="ident" id="8033026">t</span>&nbsp;<span class="op" id="8033028">*</span><span class="ident" id="8033029">testing</span><span class="op" id="8033036">.</span><span class="ident" id="8033037">T</span><span class="op" id="8033038">)</span>&nbsp;<span class="op" id="8033040">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8033043">if</span>&nbsp;<span class="op" id="8033046">*</span><span class="ident" id="8033047">useQprint</span>&nbsp;<span class="op" id="8033057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033061">_</span><span class="op" id="8033062">,</span>&nbsp;<span class="ident" id="8033064">err</span>&nbsp;<span class="op" id="8033068">:=</span>&nbsp;<span class="ident" id="8033071">exec</span><span class="op" id="8033075">.</span><span class="ident" id="8033076">LookPath</span><span class="op" id="8033084">(</span><span class="string" id="8033085">&#34;qprint&#34;</span><span class="op" id="8033093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8033097">if</span>&nbsp;<span class="ident" id="8033100">err</span>&nbsp;<span class="op" id="8033104">!=</span>&nbsp;<span class="builtintype" id="8033107">nil</span>&nbsp;<span class="op" id="8033111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033116">t</span><span class="op" id="8033117">.</span><span class="ident" id="8033118">Fatalf</span><span class="op" id="8033124">(</span><span class="string" id="8033125">&#34;Error&nbsp;looking&nbsp;for&nbsp;qprint:&nbsp;%v&#34;</span><span class="op" id="8033155">,</span>&nbsp;<span class="ident" id="8033157">err</span><span class="op" id="8033160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8033164">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8033167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8033171">var</span>&nbsp;<span class="ident" id="8033175">buf</span>&nbsp;<span class="ident" id="8033179">bytes</span><span class="op" id="8033184">.</span><span class="ident" id="8033185">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033193">res</span>&nbsp;<span class="op" id="8033197">:=</span>&nbsp;<span class="builtinfunc" id="8033200">make</span><span class="op" id="8033204">(</span><span class="keyword" id="8033205">map</span><span class="op" id="8033208">[</span><span class="builtintype" id="8033209">string</span><span class="op" id="8033215">]</span><span class="builtintype" id="8033216">int</span><span class="op" id="8033219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033222">everySequence</span><span class="op" id="8033235">(</span><span class="string" id="8033236">&#34;&#34;</span><span class="op" id="8033238">,</span>&nbsp;<span class="string" id="8033240">&#34;0A&nbsp;\r\n=&#34;</span><span class="op" id="8033250">,</span>&nbsp;<span class="num" id="8033252">6</span><span class="op" id="8033253">,</span>&nbsp;<span class="keyword" id="8033255">func</span><span class="op" id="8033259">(</span><span class="ident" id="8033260">s</span>&nbsp;<span class="builtintype" id="8033262">string</span><span class="op" id="8033268">)</span>&nbsp;<span class="op" id="8033270">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8033274">if</span>&nbsp;<span class="ident" id="8033277">strings</span><span class="op" id="8033284">.</span><span class="ident" id="8033285">HasSuffix</span><span class="op" id="8033294">(</span><span class="ident" id="8033295">s</span><span class="op" id="8033296">,</span>&nbsp;<span class="string" id="8033298">&#34;=&#34;</span><span class="op" id="8033301">)</span>&nbsp;<span class="op" id="8033303">||</span>&nbsp;<span class="ident" id="8033306">strings</span><span class="op" id="8033313">.</span><span class="ident" id="8033314">Contains</span><span class="op" id="8033322">(</span><span class="ident" id="8033323">s</span><span class="op" id="8033324">,</span>&nbsp;<span class="string" id="8033326">&#34;==&#34;</span><span class="op" id="8033330">)</span>&nbsp;<span class="op" id="8033332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8033337">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8033346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033350">buf</span><span class="op" id="8033353">.</span><span class="ident" id="8033354">Reset</span><span class="op" id="8033359">(</span><span class="op" id="8033360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033364">_</span><span class="op" id="8033365">,</span>&nbsp;<span class="ident" id="8033367">err</span>&nbsp;<span class="op" id="8033371">:=</span>&nbsp;<span class="ident" id="8033374">io</span><span class="op" id="8033376">.</span><span class="ident" id="8033377">Copy</span><span class="op" id="8033381">(</span><span class="op" id="8033382">&amp;</span><span class="ident" id="8033383">buf</span><span class="op" id="8033386">,</span>&nbsp;<span class="ident" id="8033388">newQuotedPrintableReader</span><span class="op" id="8033412">(</span><span class="ident" id="8033413">strings</span><span class="op" id="8033420">.</span><span class="ident" id="8033421">NewReader</span><span class="op" id="8033430">(</span><span class="ident" id="8033431">s</span><span class="op" id="8033432">)</span><span class="op" id="8033433">)</span><span class="op" id="8033434">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8033438">if</span>&nbsp;<span class="ident" id="8033441">err</span>&nbsp;<span class="op" id="8033445">!=</span>&nbsp;<span class="builtintype" id="8033448">nil</span>&nbsp;<span class="op" id="8033452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033457">errStr</span>&nbsp;<span class="op" id="8033464">:=</span>&nbsp;<span class="ident" id="8033467">err</span><span class="op" id="8033470">.</span><span class="ident" id="8033471">Error</span><span class="op" id="8033476">(</span><span class="op" id="8033477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8033482">if</span>&nbsp;<span class="ident" id="8033485">strings</span><span class="op" id="8033492">.</span><span class="ident" id="8033493">Contains</span><span class="op" id="8033501">(</span><span class="ident" id="8033502">errStr</span><span class="op" id="8033508">,</span>&nbsp;<span class="string" id="8033510">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=:&#34;</span><span class="op" id="8033534">)</span>&nbsp;<span class="op" id="8033536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033542">errStr</span>&nbsp;<span class="op" id="8033549">=</span>&nbsp;<span class="string" id="8033551">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8033578">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033583">res</span><span class="op" id="8033586">[</span><span class="ident" id="8033587">errStr</span><span class="op" id="8033593">]</span><span class="op" id="8033594">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8033600">if</span>&nbsp;<span class="ident" id="8033603">strings</span><span class="op" id="8033610">.</span><span class="ident" id="8033611">Contains</span><span class="op" id="8033619">(</span><span class="ident" id="8033620">errStr</span><span class="op" id="8033626">,</span>&nbsp;<span class="string" id="8033628">&#34;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;&#34;</span><span class="op" id="8033664">)</span>&nbsp;<span class="op" id="8033666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8033672">if</span>&nbsp;<span class="ident" id="8033675">strings</span><span class="op" id="8033682">.</span><span class="ident" id="8033683">HasSuffix</span><span class="op" id="8033692">(</span><span class="ident" id="8033693">errStr</span><span class="op" id="8033699">,</span>&nbsp;<span class="string" id="8033701">&#34;0x20&#34;</span><span class="op" id="8033707">)</span>&nbsp;<span class="op" id="8033709">&amp;&amp;</span>&nbsp;<span class="op" id="8033712">(</span><span class="ident" id="8033713">strings</span><span class="op" id="8033720">.</span><span class="ident" id="8033721">Contains</span><span class="op" id="8033729">(</span><span class="ident" id="8033730">s</span><span class="op" id="8033731">,</span>&nbsp;<span class="string" id="8033733">&#34;=0&nbsp;&#34;</span><span class="op" id="8033738">)</span>&nbsp;<span class="op" id="8033740">||</span>&nbsp;<span class="ident" id="8033743">strings</span><span class="op" id="8033750">.</span><span class="ident" id="8033751">Contains</span><span class="op" id="8033759">(</span><span class="ident" id="8033760">s</span><span class="op" id="8033761">,</span>&nbsp;<span class="string" id="8033763">&#34;=A&nbsp;&#34;</span><span class="op" id="8033768">)</span>&nbsp;<span class="op" id="8033770">||</span>&nbsp;<span class="ident" id="8033773">strings</span><span class="op" id="8033780">.</span><span class="ident" id="8033781">Contains</span><span class="op" id="8033789">(</span><span class="ident" id="8033790">s</span><span class="op" id="8033791">,</span>&nbsp;<span class="string" id="8033793">&#34;=&nbsp;&#34;</span><span class="op" id="8033797">)</span><span class="op" id="8033798">)</span>&nbsp;<span class="op" id="8033800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8033807">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8033818">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8033824">if</span>&nbsp;<span class="ident" id="8033827">strings</span><span class="op" id="8033834">.</span><span class="ident" id="8033835">HasSuffix</span><span class="op" id="8033844">(</span><span class="ident" id="8033845">errStr</span><span class="op" id="8033851">,</span>&nbsp;<span class="string" id="8033853">&#34;0x3d&#34;</span><span class="op" id="8033859">)</span>&nbsp;<span class="op" id="8033861">&amp;&amp;</span>&nbsp;<span class="op" id="8033864">(</span><span class="ident" id="8033865">strings</span><span class="op" id="8033872">.</span><span class="ident" id="8033873">Contains</span><span class="op" id="8033881">(</span><span class="ident" id="8033882">s</span><span class="op" id="8033883">,</span>&nbsp;<span class="string" id="8033885">&#34;=0=&#34;</span><span class="op" id="8033890">)</span>&nbsp;<span class="op" id="8033892">||</span>&nbsp;<span class="ident" id="8033895">strings</span><span class="op" id="8033902">.</span><span class="ident" id="8033903">Contains</span><span class="op" id="8033911">(</span><span class="ident" id="8033912">s</span><span class="op" id="8033913">,</span>&nbsp;<span class="string" id="8033915">&#34;=A=&#34;</span><span class="op" id="8033920">)</span><span class="op" id="8033921">)</span>&nbsp;<span class="op" id="8033923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8033930">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8033941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8033947">if</span>&nbsp;<span class="ident" id="8033950">strings</span><span class="op" id="8033957">.</span><span class="ident" id="8033958">HasSuffix</span><span class="op" id="8033967">(</span><span class="ident" id="8033968">errStr</span><span class="op" id="8033974">,</span>&nbsp;<span class="string" id="8033976">&#34;0x0a&#34;</span><span class="op" id="8033982">)</span>&nbsp;<span class="op" id="8033984">||</span>&nbsp;<span class="ident" id="8033987">strings</span><span class="op" id="8033994">.</span><span class="ident" id="8033995">HasSuffix</span><span class="op" id="8034004">(</span><span class="ident" id="8034005">errStr</span><span class="op" id="8034011">,</span>&nbsp;<span class="string" id="8034013">&#34;0x0d&#34;</span><span class="op" id="8034019">)</span>&nbsp;<span class="op" id="8034021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8034028">//&nbsp;bunch&nbsp;of&nbsp;cases;&nbsp;since&nbsp;whitespace&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;line&nbsp;before&nbsp;\n&nbsp;is&nbsp;removed.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8034112">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8034123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8034128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8034133">if</span>&nbsp;<span class="ident" id="8034136">strings</span><span class="op" id="8034143">.</span><span class="ident" id="8034144">Contains</span><span class="op" id="8034152">(</span><span class="ident" id="8034153">errStr</span><span class="op" id="8034159">,</span>&nbsp;<span class="string" id="8034161">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="8034177">)</span>&nbsp;<span class="op" id="8034179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8034185">return</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8034195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8034200">if</span>&nbsp;<span class="ident" id="8034203">errStr</span>&nbsp;<span class="op" id="8034210">==</span>&nbsp;<span class="string" id="8034213">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=&#34;</span>&nbsp;<span class="op" id="8034237">&amp;&amp;</span>&nbsp;<span class="ident" id="8034240">badSoftRx</span><span class="op" id="8034249">.</span><span class="ident" id="8034250">MatchString</span><span class="op" id="8034261">(</span><span class="ident" id="8034262">s</span><span class="op" id="8034263">)</span>&nbsp;<span class="op" id="8034265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8034271">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8034281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8034286">t</span><span class="op" id="8034287">.</span><span class="ident" id="8034288">Errorf</span><span class="op" id="8034294">(</span><span class="string" id="8034295">&#34;decode(%q)&nbsp;=&nbsp;%v&#34;</span><span class="op" id="8034312">,</span>&nbsp;<span class="ident" id="8034314">s</span><span class="op" id="8034315">,</span>&nbsp;<span class="ident" id="8034317">err</span><span class="op" id="8034320">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8034325">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8034334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8034338">if</span>&nbsp;<span class="op" id="8034341">*</span><span class="ident" id="8034342">useQprint</span>&nbsp;<span class="op" id="8034352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8034357">cmd</span>&nbsp;<span class="op" id="8034361">:=</span>&nbsp;<span class="ident" id="8034364">exec</span><span class="op" id="8034368">.</span><span class="ident" id="8034369">Command</span><span class="op" id="8034376">(</span><span class="string" id="8034377">&#34;qprint&#34;</span><span class="op" id="8034385">,</span>&nbsp;<span class="string" id="8034387">&#34;-d&#34;</span><span class="op" id="8034391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8034396">cmd</span><span class="op" id="8034399">.</span><span class="ident" id="8034400">Stdin</span>&nbsp;<span class="op" id="8034406">=</span>&nbsp;<span class="ident" id="8034408">strings</span><span class="op" id="8034415">.</span><span class="ident" id="8034416">NewReader</span><span class="op" id="8034425">(</span><span class="ident" id="8034426">s</span><span class="op" id="8034427">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8034432">stderr</span><span class="op" id="8034438">,</span>&nbsp;<span class="ident" id="8034440">err</span>&nbsp;<span class="op" id="8034444">:=</span>&nbsp;<span class="ident" id="8034447">cmd</span><span class="op" id="8034450">.</span><span class="ident" id="8034451">StderrPipe</span><span class="op" id="8034461">(</span><span class="op" id="8034462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8034467">if</span>&nbsp;<span class="ident" id="8034470">err</span>&nbsp;<span class="op" id="8034474">!=</span>&nbsp;<span class="builtintype" id="8034477">nil</span>&nbsp;<span class="op" id="8034481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8034487">panic</span><span class="op" id="8034492">(</span><span class="ident" id="8034493">err</span><span class="op" id="8034496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8034501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8034506">qpres</span>&nbsp;<span class="op" id="8034512">:=</span>&nbsp;<span class="builtinfunc" id="8034515">make</span><span class="op" id="8034519">(</span><span class="keyword" id="8034520">chan</span>&nbsp;<span class="keyword" id="8034525">interface</span><span class="op" id="8034534">{</span><span class="op" id="8034535">}</span><span class="op" id="8034536">,</span>&nbsp;<span class="num" id="8034538">2</span><span class="op" id="8034539">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8034544">go</span>&nbsp;<span class="keyword" id="8034547">func</span><span class="op" id="8034551">(</span><span class="op" id="8034552">)</span>&nbsp;<span class="op" id="8034554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8034560">br</span>&nbsp;<span class="op" id="8034563">:=</span>&nbsp;<span class="ident" id="8034566">bufio</span><span class="op" id="8034571">.</span><span class="ident" id="8034572">NewReader</span><span class="op" id="8034581">(</span><span class="ident" id="8034582">stderr</span><span class="op" id="8034588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8034594">s</span><span class="op" id="8034595">,</span>&nbsp;<span class="ident" id="8034597">_</span>&nbsp;<span class="op" id="8034599">:=</span>&nbsp;<span class="ident" id="8034602">br</span><span class="op" id="8034604">.</span><span class="ident" id="8034605">ReadString</span><span class="op" id="8034615">(</span><span class="string" id="8034616">&#39;\n&#39;</span><span class="op" id="8034620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8034626">if</span>&nbsp;<span class="ident" id="8034629">s</span>&nbsp;<span class="op" id="8034631">!=</span>&nbsp;<span class="string" id="8034634">&#34;&#34;</span>&nbsp;<span class="op" id="8034637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8034644">qpres</span>&nbsp;<span class="op" id="8034650">&lt;-</span>&nbsp;<span class="ident" id="8034653">errors</span><span class="op" id="8034659">.</span><span class="ident" id="8034660">New</span><span class="op" id="8034663">(</span><span class="ident" id="8034664">s</span><span class="op" id="8034665">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8034672">if</span>&nbsp;<span class="ident" id="8034675">cmd</span><span class="op" id="8034678">.</span><span class="ident" id="8034679">Process</span>&nbsp;<span class="op" id="8034687">!=</span>&nbsp;<span class="builtintype" id="8034690">nil</span>&nbsp;<span class="op" id="8034694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8034702">//&nbsp;It&nbsp;can&nbsp;get&nbsp;stuck&nbsp;on&nbsp;invalid&nbsp;input,&nbsp;like:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8034752">//&nbsp;echo&nbsp;-n&nbsp;&#34;0000=&nbsp;&#34;&nbsp;|&nbsp;qprint&nbsp;-d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8034790">cmd</span><span class="op" id="8034793">.</span><span class="ident" id="8034794">Process</span><span class="op" id="8034801">.</span><span class="ident" id="8034802">Kill</span><span class="op" id="8034806">(</span><span class="op" id="8034807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8034814">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8034820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8034825">}</span><span class="op" id="8034826">(</span><span class="op" id="8034827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8034832">go</span>&nbsp;<span class="keyword" id="8034835">func</span><span class="op" id="8034839">(</span><span class="op" id="8034840">)</span>&nbsp;<span class="op" id="8034842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8034848">want</span><span class="op" id="8034852">,</span>&nbsp;<span class="ident" id="8034854">err</span>&nbsp;<span class="op" id="8034858">:=</span>&nbsp;<span class="ident" id="8034861">cmd</span><span class="op" id="8034864">.</span><span class="ident" id="8034865">Output</span><span class="op" id="8034871">(</span><span class="op" id="8034872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8034878">if</span>&nbsp;<span class="ident" id="8034881">err</span>&nbsp;<span class="op" id="8034885">==</span>&nbsp;<span class="builtintype" id="8034888">nil</span>&nbsp;<span class="op" id="8034892">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8034899">qpres</span>&nbsp;<span class="op" id="8034905">&lt;-</span>&nbsp;<span class="ident" id="8034908">want</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8034917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8034922">}</span><span class="op" id="8034923">(</span><span class="op" id="8034924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8034929">select</span>&nbsp;<span class="op" id="8034936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8034941">case</span>&nbsp;<span class="ident" id="8034946">got</span>&nbsp;<span class="op" id="8034950">:=</span>&nbsp;<span class="op" id="8034953">&lt;-</span><span class="ident" id="8034955">qpres</span><span class="op" id="8034960">:</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8034966">if</span>&nbsp;<span class="ident" id="8034969">want</span><span class="op" id="8034973">,</span>&nbsp;<span class="ident" id="8034975">ok</span>&nbsp;<span class="op" id="8034978">:=</span>&nbsp;<span class="ident" id="8034981">got</span><span class="op" id="8034984">.</span><span class="op" id="8034985">(</span><span class="op" id="8034986">[</span><span class="op" id="8034987">]</span><span class="builtintype" id="8034988">byte</span><span class="op" id="8034992">)</span><span class="op" id="8034993">;</span>&nbsp;<span class="ident" id="8034995">ok</span>&nbsp;<span class="op" id="8034998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8035005">if</span>&nbsp;<span class="builtintype" id="8035008">string</span><span class="op" id="8035014">(</span><span class="ident" id="8035015">want</span><span class="op" id="8035019">)</span>&nbsp;<span class="op" id="8035021">!=</span>&nbsp;<span class="ident" id="8035024">buf</span><span class="op" id="8035027">.</span><span class="ident" id="8035028">String</span><span class="op" id="8035034">(</span><span class="op" id="8035035">)</span>&nbsp;<span class="op" id="8035037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035045">t</span><span class="op" id="8035046">.</span><span class="ident" id="8035047">Errorf</span><span class="op" id="8035053">(</span><span class="string" id="8035054">&#34;go&nbsp;decode(%q)&nbsp;=&nbsp;%q;&nbsp;qprint&nbsp;=&nbsp;%q&#34;</span><span class="op" id="8035087">,</span>&nbsp;<span class="ident" id="8035089">s</span><span class="op" id="8035090">,</span>&nbsp;<span class="ident" id="8035092">want</span><span class="op" id="8035096">,</span>&nbsp;<span class="ident" id="8035098">buf</span><span class="op" id="8035101">.</span><span class="ident" id="8035102">String</span><span class="op" id="8035108">(</span><span class="op" id="8035109">)</span><span class="op" id="8035110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8035117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8035123">}</span>&nbsp;<span class="keyword" id="8035125">else</span>&nbsp;<span class="op" id="8035130">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035137">t</span><span class="op" id="8035138">.</span><span class="ident" id="8035139">Logf</span><span class="op" id="8035143">(</span><span class="string" id="8035144">&#34;qprint&nbsp;-d(%q)&nbsp;=&nbsp;%v&#34;</span><span class="op" id="8035164">,</span>&nbsp;<span class="ident" id="8035166">s</span><span class="op" id="8035167">,</span>&nbsp;<span class="ident" id="8035169">got</span><span class="op" id="8035172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8035178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8035183">case</span>&nbsp;<span class="op" id="8035188">&lt;-</span><span class="ident" id="8035190">time</span><span class="op" id="8035194">.</span><span class="ident" id="8035195">After</span><span class="op" id="8035200">(</span><span class="num" id="8035201">5</span>&nbsp;<span class="op" id="8035203">*</span>&nbsp;<span class="ident" id="8035205">time</span><span class="op" id="8035209">.</span><span class="ident" id="8035210">Second</span><span class="op" id="8035216">)</span><span class="op" id="8035217">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035223">t</span><span class="op" id="8035224">.</span><span class="ident" id="8035225">Logf</span><span class="op" id="8035229">(</span><span class="string" id="8035230">&#34;qprint&nbsp;timeout&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8035252">,</span>&nbsp;<span class="ident" id="8035254">s</span><span class="op" id="8035255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8035260">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8035264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035268">res</span><span class="op" id="8035271">[</span><span class="string" id="8035272">&#34;OK&#34;</span><span class="op" id="8035276">]</span><span class="op" id="8035277">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8035281">}</span><span class="op" id="8035282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8035285">var</span>&nbsp;<span class="ident" id="8035289">outcomes</span>&nbsp;<span class="op" id="8035298">[</span><span class="op" id="8035299">]</span><span class="builtintype" id="8035300">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8035308">for</span>&nbsp;<span class="ident" id="8035312">k</span><span class="op" id="8035313">,</span>&nbsp;<span class="ident" id="8035315">v</span>&nbsp;<span class="op" id="8035317">:=</span>&nbsp;<span class="keyword" id="8035320">range</span>&nbsp;<span class="ident" id="8035326">res</span>&nbsp;<span class="op" id="8035330">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035334">outcomes</span>&nbsp;<span class="op" id="8035343">=</span>&nbsp;<span class="builtinfunc" id="8035345">append</span><span class="op" id="8035351">(</span><span class="ident" id="8035352">outcomes</span><span class="op" id="8035360">,</span>&nbsp;<span class="ident" id="8035362">fmt</span><span class="op" id="8035365">.</span><span class="ident" id="8035366">Sprintf</span><span class="op" id="8035373">(</span><span class="string" id="8035374">&#34;%v:&nbsp;%d&#34;</span><span class="op" id="8035382">,</span>&nbsp;<span class="ident" id="8035384">k</span><span class="op" id="8035385">,</span>&nbsp;<span class="ident" id="8035387">v</span><span class="op" id="8035388">)</span><span class="op" id="8035389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8035392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035395">sort</span><span class="op" id="8035399">.</span><span class="ident" id="8035400">Strings</span><span class="op" id="8035407">(</span><span class="ident" id="8035408">outcomes</span><span class="op" id="8035416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035419">got</span>&nbsp;<span class="op" id="8035423">:=</span>&nbsp;<span class="ident" id="8035426">strings</span><span class="op" id="8035433">.</span><span class="ident" id="8035434">Join</span><span class="op" id="8035438">(</span><span class="ident" id="8035439">outcomes</span><span class="op" id="8035447">,</span>&nbsp;<span class="string" id="8035449">&#34;\n&#34;</span><span class="op" id="8035453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035456">want</span>&nbsp;<span class="op" id="8035461">:=</span>&nbsp;<span class="string" id="8035464">`OK:&nbsp;21576<br>
<span class="lineno">195</span>invalid&nbsp;bytes&nbsp;after&nbsp;=:&nbsp;3397<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0a:&nbsp;1400<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0d:&nbsp;2700<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x20:&nbsp;2490<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x3d:&nbsp;440<br>
<span class="lineno">200</span>unexpected&nbsp;EOF:&nbsp;3122`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8035749">if</span>&nbsp;<span class="ident" id="8035752">got</span>&nbsp;<span class="op" id="8035756">!=</span>&nbsp;<span class="ident" id="8035759">want</span>&nbsp;<span class="op" id="8035764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035768">t</span><span class="op" id="8035769">.</span><span class="ident" id="8035770">Errorf</span><span class="op" id="8035776">(</span><span class="string" id="8035777">&#34;Got:\n%s\nWant:\n%s&#34;</span><span class="op" id="8035798">,</span>&nbsp;<span class="ident" id="8035800">got</span><span class="op" id="8035803">,</span>&nbsp;<span class="ident" id="8035805">want</span><span class="op" id="8035809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8035812">}</span><br>
<span class="lineno"></span><span class="op" id="8035814">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
