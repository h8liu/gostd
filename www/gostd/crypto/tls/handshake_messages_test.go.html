<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html" class="current">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7073856">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7073911">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7073965">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7074016">package</span>&nbsp;<span class="ident" id="7074024">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7074029">import</span>&nbsp;<span class="op" id="7074036">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7074039">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7074052">&#34;reflect&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7074063">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7074074">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="7074090">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7074093">var</span>&nbsp;<span class="ident" id="7074097">tests</span>&nbsp;<span class="op" id="7074103">=</span>&nbsp;<span class="op" id="7074105">[</span><span class="op" id="7074106">]</span><span class="keyword" id="7074107">interface</span><span class="op" id="7074116">{</span><span class="op" id="7074117">}</span><span class="op" id="7074118">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7074121">&amp;</span><span class="ident" id="7074122">clientHelloMsg</span><span class="op" id="7074136">{</span><span class="op" id="7074137">}</span><span class="op" id="7074138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7074141">&amp;</span><span class="ident" id="7074142">serverHelloMsg</span><span class="op" id="7074156">{</span><span class="op" id="7074157">}</span><span class="op" id="7074158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7074161">&amp;</span><span class="ident" id="7074162">finishedMsg</span><span class="op" id="7074173">{</span><span class="op" id="7074174">}</span><span class="op" id="7074175">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7074179">&amp;</span><span class="ident" id="7074180">certificateMsg</span><span class="op" id="7074194">{</span><span class="op" id="7074195">}</span><span class="op" id="7074196">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7074199">&amp;</span><span class="ident" id="7074200">certificateRequestMsg</span><span class="op" id="7074221">{</span><span class="op" id="7074222">}</span><span class="op" id="7074223">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7074226">&amp;</span><span class="ident" id="7074227">certificateVerifyMsg</span><span class="op" id="7074247">{</span><span class="op" id="7074248">}</span><span class="op" id="7074249">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7074252">&amp;</span><span class="ident" id="7074253">certificateStatusMsg</span><span class="op" id="7074273">{</span><span class="op" id="7074274">}</span><span class="op" id="7074275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7074278">&amp;</span><span class="ident" id="7074279">clientKeyExchangeMsg</span><span class="op" id="7074299">{</span><span class="op" id="7074300">}</span><span class="op" id="7074301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7074304">&amp;</span><span class="ident" id="7074305">nextProtoMsg</span><span class="op" id="7074317">{</span><span class="op" id="7074318">}</span><span class="op" id="7074319">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7074322">&amp;</span><span class="ident" id="7074323">newSessionTicketMsg</span><span class="op" id="7074342">{</span><span class="op" id="7074343">}</span><span class="op" id="7074344">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7074347">&amp;</span><span class="ident" id="7074348">sessionState</span><span class="op" id="7074360">{</span><span class="op" id="7074361">}</span><span class="op" id="7074362">,</span><br>
<span class="lineno"></span><span class="op" id="7074364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7074367">type</span>&nbsp;<span class="ident" id="7074372">testMessage</span>&nbsp;<span class="keyword" id="7074384">interface</span>&nbsp;<span class="op" id="7074394">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7074397">marshal</span><span class="op" id="7074404">(</span><span class="op" id="7074405">)</span>&nbsp;<span class="op" id="7074407">[</span><span class="op" id="7074408">]</span><span class="builtintype" id="7074409">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7074415">unmarshal</span><span class="op" id="7074424">(</span><span class="op" id="7074425">[</span><span class="op" id="7074426">]</span><span class="builtintype" id="7074427">byte</span><span class="op" id="7074431">)</span>&nbsp;<span class="builtintype" id="7074433">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7074439">equal</span><span class="op" id="7074444">(</span><span class="keyword" id="7074445">interface</span><span class="op" id="7074454">{</span><span class="op" id="7074455">}</span><span class="op" id="7074456">)</span>&nbsp;<span class="builtintype" id="7074458">bool</span><br>
<span class="lineno"></span><span class="op" id="7074463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="7074466">func</span>&nbsp;<span class="ident" id="7074471">TestMarshalUnmarshal</span><span class="op" id="7074491">(</span><span class="ident" id="7074492">t</span>&nbsp;<span class="op" id="7074494">*</span><span class="ident" id="7074495">testing</span><span class="op" id="7074502">.</span><span class="ident" id="7074503">T</span><span class="op" id="7074504">)</span>&nbsp;<span class="op" id="7074506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7074509">rand</span>&nbsp;<span class="op" id="7074514">:=</span>&nbsp;<span class="ident" id="7074517">rand</span><span class="op" id="7074521">.</span><span class="ident" id="7074522">New</span><span class="op" id="7074525">(</span><span class="ident" id="7074526">rand</span><span class="op" id="7074530">.</span><span class="ident" id="7074531">NewSource</span><span class="op" id="7074540">(</span><span class="num" id="7074541">0</span><span class="op" id="7074542">)</span><span class="op" id="7074543">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7074547">for</span>&nbsp;<span class="ident" id="7074551">i</span><span class="op" id="7074552">,</span>&nbsp;<span class="ident" id="7074554">iface</span>&nbsp;<span class="op" id="7074560">:=</span>&nbsp;<span class="keyword" id="7074563">range</span>&nbsp;<span class="ident" id="7074569">tests</span>&nbsp;<span class="op" id="7074575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7074579">ty</span>&nbsp;<span class="op" id="7074582">:=</span>&nbsp;<span class="ident" id="7074585">reflect</span><span class="op" id="7074592">.</span><span class="ident" id="7074593">ValueOf</span><span class="op" id="7074600">(</span><span class="ident" id="7074601">iface</span><span class="op" id="7074606">)</span><span class="op" id="7074607">.</span><span class="ident" id="7074608">Type</span><span class="op" id="7074612">(</span><span class="op" id="7074613">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7074618">n</span>&nbsp;<span class="op" id="7074620">:=</span>&nbsp;<span class="num" id="7074623">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7074629">if</span>&nbsp;<span class="ident" id="7074632">testing</span><span class="op" id="7074639">.</span><span class="ident" id="7074640">Short</span><span class="op" id="7074645">(</span><span class="op" id="7074646">)</span>&nbsp;<span class="op" id="7074648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7074653">n</span>&nbsp;<span class="op" id="7074655">=</span>&nbsp;<span class="num" id="7074657">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7074661">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7074665">for</span>&nbsp;<span class="ident" id="7074669">j</span>&nbsp;<span class="op" id="7074671">:=</span>&nbsp;<span class="num" id="7074674">0</span><span class="op" id="7074675">;</span>&nbsp;<span class="ident" id="7074677">j</span>&nbsp;<span class="op" id="7074679">&lt;</span>&nbsp;<span class="ident" id="7074681">n</span><span class="op" id="7074682">;</span>&nbsp;<span class="ident" id="7074684">j</span><span class="op" id="7074685">++</span>&nbsp;<span class="op" id="7074688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7074693">v</span><span class="op" id="7074694">,</span>&nbsp;<span class="ident" id="7074696">ok</span>&nbsp;<span class="op" id="7074699">:=</span>&nbsp;<span class="ident" id="7074702">quick</span><span class="op" id="7074707">.</span><span class="ident" id="7074708">Value</span><span class="op" id="7074713">(</span><span class="ident" id="7074714">ty</span><span class="op" id="7074716">,</span>&nbsp;<span class="ident" id="7074718">rand</span><span class="op" id="7074722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7074727">if</span>&nbsp;<span class="op" id="7074730">!</span><span class="ident" id="7074731">ok</span>&nbsp;<span class="op" id="7074734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7074740">t</span><span class="op" id="7074741">.</span><span class="ident" id="7074742">Errorf</span><span class="op" id="7074748">(</span><span class="string" id="7074749">&#34;#%d:&nbsp;failed&nbsp;to&nbsp;create&nbsp;value&#34;</span><span class="op" id="7074778">,</span>&nbsp;<span class="ident" id="7074780">i</span><span class="op" id="7074781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7074787">break</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7074796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7074802">m1</span>&nbsp;<span class="op" id="7074805">:=</span>&nbsp;<span class="ident" id="7074808">v</span><span class="op" id="7074809">.</span><span class="ident" id="7074810">Interface</span><span class="op" id="7074819">(</span><span class="op" id="7074820">)</span><span class="op" id="7074821">.</span><span class="op" id="7074822">(</span><span class="ident" id="7074823">testMessage</span><span class="op" id="7074834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7074839">marshaled</span>&nbsp;<span class="op" id="7074849">:=</span>&nbsp;<span class="ident" id="7074852">m1</span><span class="op" id="7074854">.</span><span class="ident" id="7074855">marshal</span><span class="op" id="7074862">(</span><span class="op" id="7074863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7074868">m2</span>&nbsp;<span class="op" id="7074871">:=</span>&nbsp;<span class="ident" id="7074874">iface</span><span class="op" id="7074879">.</span><span class="op" id="7074880">(</span><span class="ident" id="7074881">testMessage</span><span class="op" id="7074892">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7074897">if</span>&nbsp;<span class="op" id="7074900">!</span><span class="ident" id="7074901">m2</span><span class="op" id="7074903">.</span><span class="ident" id="7074904">unmarshal</span><span class="op" id="7074913">(</span><span class="ident" id="7074914">marshaled</span><span class="op" id="7074923">)</span>&nbsp;<span class="op" id="7074925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7074931">t</span><span class="op" id="7074932">.</span><span class="ident" id="7074933">Errorf</span><span class="op" id="7074939">(</span><span class="string" id="7074940">&#34;#%d&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;%#v&nbsp;%x&#34;</span><span class="op" id="7074972">,</span>&nbsp;<span class="ident" id="7074974">i</span><span class="op" id="7074975">,</span>&nbsp;<span class="ident" id="7074977">m1</span><span class="op" id="7074979">,</span>&nbsp;<span class="ident" id="7074981">marshaled</span><span class="op" id="7074990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7074996">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7075005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7075010">m2</span><span class="op" id="7075012">.</span><span class="ident" id="7075013">marshal</span><span class="op" id="7075020">(</span><span class="op" id="7075021">)</span>&nbsp;<span class="comment" id="7075023">//&nbsp;to&nbsp;fill&nbsp;any&nbsp;marshal&nbsp;cache&nbsp;in&nbsp;the&nbsp;message</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7075071">if</span>&nbsp;<span class="op" id="7075074">!</span><span class="ident" id="7075075">m1</span><span class="op" id="7075077">.</span><span class="ident" id="7075078">equal</span><span class="op" id="7075083">(</span><span class="ident" id="7075084">m2</span><span class="op" id="7075086">)</span>&nbsp;<span class="op" id="7075088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7075094">t</span><span class="op" id="7075095">.</span><span class="ident" id="7075096">Errorf</span><span class="op" id="7075102">(</span><span class="string" id="7075103">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&nbsp;%x&#34;</span><span class="op" id="7075128">,</span>&nbsp;<span class="ident" id="7075130">i</span><span class="op" id="7075131">,</span>&nbsp;<span class="ident" id="7075133">m2</span><span class="op" id="7075135">,</span>&nbsp;<span class="ident" id="7075137">m1</span><span class="op" id="7075139">,</span>&nbsp;<span class="ident" id="7075141">marshaled</span><span class="op" id="7075150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7075156">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7075165">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7075171">if</span>&nbsp;<span class="ident" id="7075174">i</span>&nbsp;<span class="op" id="7075176">&gt;=</span>&nbsp;<span class="num" id="7075179">3</span>&nbsp;<span class="op" id="7075181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7075187">//&nbsp;The&nbsp;first&nbsp;three&nbsp;message&nbsp;types&nbsp;(ClientHello,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7075238">//&nbsp;ServerHello&nbsp;and&nbsp;Finished)&nbsp;are&nbsp;allowed&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7075286">//&nbsp;have&nbsp;parsable&nbsp;prefixes&nbsp;because&nbsp;the&nbsp;extension</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7075338">//&nbsp;data&nbsp;is&nbsp;optional&nbsp;and&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7075384">//&nbsp;Finished&nbsp;varies&nbsp;across&nbsp;versions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7075424">for</span>&nbsp;<span class="ident" id="7075428">j</span>&nbsp;<span class="op" id="7075430">:=</span>&nbsp;<span class="num" id="7075433">0</span><span class="op" id="7075434">;</span>&nbsp;<span class="ident" id="7075436">j</span>&nbsp;<span class="op" id="7075438">&lt;</span>&nbsp;<span class="builtinfunc" id="7075440">len</span><span class="op" id="7075443">(</span><span class="ident" id="7075444">marshaled</span><span class="op" id="7075453">)</span><span class="op" id="7075454">;</span>&nbsp;<span class="ident" id="7075456">j</span><span class="op" id="7075457">++</span>&nbsp;<span class="op" id="7075460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7075467">if</span>&nbsp;<span class="ident" id="7075470">m2</span><span class="op" id="7075472">.</span><span class="ident" id="7075473">unmarshal</span><span class="op" id="7075482">(</span><span class="ident" id="7075483">marshaled</span><span class="op" id="7075492">[</span><span class="num" id="7075493">0</span><span class="op" id="7075494">:</span><span class="ident" id="7075495">j</span><span class="op" id="7075496">]</span><span class="op" id="7075497">)</span>&nbsp;<span class="op" id="7075499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7075507">t</span><span class="op" id="7075508">.</span><span class="ident" id="7075509">Errorf</span><span class="op" id="7075515">(</span><span class="string" id="7075516">&#34;#%d&nbsp;unmarshaled&nbsp;a&nbsp;prefix&nbsp;of&nbsp;length&nbsp;%d&nbsp;of&nbsp;%#v&#34;</span><span class="op" id="7075562">,</span>&nbsp;<span class="ident" id="7075564">i</span><span class="op" id="7075565">,</span>&nbsp;<span class="ident" id="7075567">j</span><span class="op" id="7075568">,</span>&nbsp;<span class="ident" id="7075570">m1</span><span class="op" id="7075572">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7075580">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7075591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7075597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7075602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7075606">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7075609">}</span><br>
<span class="lineno"></span><span class="op" id="7075611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7075614">func</span>&nbsp;<span class="ident" id="7075619">TestFuzz</span><span class="op" id="7075627">(</span><span class="ident" id="7075628">t</span>&nbsp;<span class="op" id="7075630">*</span><span class="ident" id="7075631">testing</span><span class="op" id="7075638">.</span><span class="ident" id="7075639">T</span><span class="op" id="7075640">)</span>&nbsp;<span class="op" id="7075642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7075645">rand</span>&nbsp;<span class="op" id="7075650">:=</span>&nbsp;<span class="ident" id="7075653">rand</span><span class="op" id="7075657">.</span><span class="ident" id="7075658">New</span><span class="op" id="7075661">(</span><span class="ident" id="7075662">rand</span><span class="op" id="7075666">.</span><span class="ident" id="7075667">NewSource</span><span class="op" id="7075676">(</span><span class="num" id="7075677">0</span><span class="op" id="7075678">)</span><span class="op" id="7075679">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7075682">for</span>&nbsp;<span class="ident" id="7075686">_</span><span class="op" id="7075687">,</span>&nbsp;<span class="ident" id="7075689">iface</span>&nbsp;<span class="op" id="7075695">:=</span>&nbsp;<span class="keyword" id="7075698">range</span>&nbsp;<span class="ident" id="7075704">tests</span>&nbsp;<span class="op" id="7075710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7075714">m</span>&nbsp;<span class="op" id="7075716">:=</span>&nbsp;<span class="ident" id="7075719">iface</span><span class="op" id="7075724">.</span><span class="op" id="7075725">(</span><span class="ident" id="7075726">testMessage</span><span class="op" id="7075737">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7075742">for</span>&nbsp;<span class="ident" id="7075746">j</span>&nbsp;<span class="op" id="7075748">:=</span>&nbsp;<span class="num" id="7075751">0</span><span class="op" id="7075752">;</span>&nbsp;<span class="ident" id="7075754">j</span>&nbsp;<span class="op" id="7075756">&lt;</span>&nbsp;<span class="num" id="7075758">1000</span><span class="op" id="7075762">;</span>&nbsp;<span class="ident" id="7075764">j</span><span class="op" id="7075765">++</span>&nbsp;<span class="op" id="7075768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7075773">len</span>&nbsp;<span class="op" id="7075777">:=</span>&nbsp;<span class="ident" id="7075780">rand</span><span class="op" id="7075784">.</span><span class="ident" id="7075785">Intn</span><span class="op" id="7075789">(</span><span class="num" id="7075790">100</span><span class="op" id="7075793">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7075798">bytes</span>&nbsp;<span class="op" id="7075804">:=</span>&nbsp;<span class="ident" id="7075807">randomBytes</span><span class="op" id="7075818">(</span><span class="builtinfunc" id="7075819">len</span><span class="op" id="7075822">,</span>&nbsp;<span class="ident" id="7075824">rand</span><span class="op" id="7075828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7075833">//&nbsp;This&nbsp;just&nbsp;looks&nbsp;for&nbsp;crashes&nbsp;due&nbsp;to&nbsp;bounds&nbsp;errors&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7075893">m</span><span class="op" id="7075894">.</span><span class="ident" id="7075895">unmarshal</span><span class="op" id="7075904">(</span><span class="ident" id="7075905">bytes</span><span class="op" id="7075910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7075914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7075917">}</span><br>
<span class="lineno">95</span><span class="op" id="7075919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7075922">func</span>&nbsp;<span class="ident" id="7075927">randomBytes</span><span class="op" id="7075938">(</span><span class="ident" id="7075939">n</span>&nbsp;<span class="builtintype" id="7075941">int</span><span class="op" id="7075944">,</span>&nbsp;<span class="ident" id="7075946">rand</span>&nbsp;<span class="op" id="7075951">*</span><span class="ident" id="7075952">rand</span><span class="op" id="7075956">.</span><span class="ident" id="7075957">Rand</span><span class="op" id="7075961">)</span>&nbsp;<span class="op" id="7075963">[</span><span class="op" id="7075964">]</span><span class="builtintype" id="7075965">byte</span>&nbsp;<span class="op" id="7075970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7075973">r</span>&nbsp;<span class="op" id="7075975">:=</span>&nbsp;<span class="builtinfunc" id="7075978">make</span><span class="op" id="7075982">(</span><span class="op" id="7075983">[</span><span class="op" id="7075984">]</span><span class="builtintype" id="7075985">byte</span><span class="op" id="7075989">,</span>&nbsp;<span class="ident" id="7075991">n</span><span class="op" id="7075992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7075995">for</span>&nbsp;<span class="ident" id="7075999">i</span>&nbsp;<span class="op" id="7076001">:=</span>&nbsp;<span class="num" id="7076004">0</span><span class="op" id="7076005">;</span>&nbsp;<span class="ident" id="7076007">i</span>&nbsp;<span class="op" id="7076009">&lt;</span>&nbsp;<span class="ident" id="7076011">n</span><span class="op" id="7076012">;</span>&nbsp;<span class="ident" id="7076014">i</span><span class="op" id="7076015">++</span>&nbsp;<span class="op" id="7076018">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7076022">r</span><span class="op" id="7076023">[</span><span class="ident" id="7076024">i</span><span class="op" id="7076025">]</span>&nbsp;<span class="op" id="7076027">=</span>&nbsp;<span class="builtintype" id="7076029">byte</span><span class="op" id="7076033">(</span><span class="ident" id="7076034">rand</span><span class="op" id="7076038">.</span><span class="ident" id="7076039">Int31</span><span class="op" id="7076044">(</span><span class="op" id="7076045">)</span><span class="op" id="7076046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7076049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7076052">return</span>&nbsp;<span class="ident" id="7076059">r</span><br>
<span class="lineno"></span><span class="op" id="7076061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="7076064">func</span>&nbsp;<span class="ident" id="7076069">randomString</span><span class="op" id="7076081">(</span><span class="ident" id="7076082">n</span>&nbsp;<span class="builtintype" id="7076084">int</span><span class="op" id="7076087">,</span>&nbsp;<span class="ident" id="7076089">rand</span>&nbsp;<span class="op" id="7076094">*</span><span class="ident" id="7076095">rand</span><span class="op" id="7076099">.</span><span class="ident" id="7076100">Rand</span><span class="op" id="7076104">)</span>&nbsp;<span class="builtintype" id="7076106">string</span>&nbsp;<span class="op" id="7076113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7076116">b</span>&nbsp;<span class="op" id="7076118">:=</span>&nbsp;<span class="ident" id="7076121">randomBytes</span><span class="op" id="7076132">(</span><span class="ident" id="7076133">n</span><span class="op" id="7076134">,</span>&nbsp;<span class="ident" id="7076136">rand</span><span class="op" id="7076140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7076143">return</span>&nbsp;<span class="builtintype" id="7076150">string</span><span class="op" id="7076156">(</span><span class="ident" id="7076157">b</span><span class="op" id="7076158">)</span><br>
<span class="lineno"></span><span class="op" id="7076160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="7076163">func</span>&nbsp;<span class="op" id="7076168">(</span><span class="op" id="7076169">*</span><span class="ident" id="7076170">clientHelloMsg</span><span class="op" id="7076184">)</span>&nbsp;<span class="ident" id="7076186">Generate</span><span class="op" id="7076194">(</span><span class="ident" id="7076195">rand</span>&nbsp;<span class="op" id="7076200">*</span><span class="ident" id="7076201">rand</span><span class="op" id="7076205">.</span><span class="ident" id="7076206">Rand</span><span class="op" id="7076210">,</span>&nbsp;<span class="ident" id="7076212">size</span>&nbsp;<span class="builtintype" id="7076217">int</span><span class="op" id="7076220">)</span>&nbsp;<span class="ident" id="7076222">reflect</span><span class="op" id="7076229">.</span><span class="ident" id="7076230">Value</span>&nbsp;<span class="op" id="7076236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7076239">m</span>&nbsp;<span class="op" id="7076241">:=</span>&nbsp;<span class="op" id="7076244">&amp;</span><span class="ident" id="7076245">clientHelloMsg</span><span class="op" id="7076259">{</span><span class="op" id="7076260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7076263">m</span><span class="op" id="7076264">.</span><span class="ident" id="7076265">vers</span>&nbsp;<span class="op" id="7076270">=</span>&nbsp;<span class="builtintype" id="7076272">uint16</span><span class="op" id="7076278">(</span><span class="ident" id="7076279">rand</span><span class="op" id="7076283">.</span><span class="ident" id="7076284">Intn</span><span class="op" id="7076288">(</span><span class="num" id="7076289">65536</span><span class="op" id="7076294">)</span><span class="op" id="7076295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7076298">m</span><span class="op" id="7076299">.</span><span class="ident" id="7076300">random</span>&nbsp;<span class="op" id="7076307">=</span>&nbsp;<span class="ident" id="7076309">randomBytes</span><span class="op" id="7076320">(</span><span class="num" id="7076321">32</span><span class="op" id="7076323">,</span>&nbsp;<span class="ident" id="7076325">rand</span><span class="op" id="7076329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7076332">m</span><span class="op" id="7076333">.</span><span class="ident" id="7076334">sessionId</span>&nbsp;<span class="op" id="7076344">=</span>&nbsp;<span class="ident" id="7076346">randomBytes</span><span class="op" id="7076357">(</span><span class="ident" id="7076358">rand</span><span class="op" id="7076362">.</span><span class="ident" id="7076363">Intn</span><span class="op" id="7076367">(</span><span class="num" id="7076368">32</span><span class="op" id="7076370">)</span><span class="op" id="7076371">,</span>&nbsp;<span class="ident" id="7076373">rand</span><span class="op" id="7076377">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7076380">m</span><span class="op" id="7076381">.</span><span class="ident" id="7076382">cipherSuites</span>&nbsp;<span class="op" id="7076395">=</span>&nbsp;<span class="builtinfunc" id="7076397">make</span><span class="op" id="7076401">(</span><span class="op" id="7076402">[</span><span class="op" id="7076403">]</span><span class="builtintype" id="7076404">uint16</span><span class="op" id="7076410">,</span>&nbsp;<span class="ident" id="7076412">rand</span><span class="op" id="7076416">.</span><span class="ident" id="7076417">Intn</span><span class="op" id="7076421">(</span><span class="num" id="7076422">63</span><span class="op" id="7076424">)</span><span class="op" id="7076425">+</span><span class="num" id="7076426">1</span><span class="op" id="7076427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7076430">for</span>&nbsp;<span class="ident" id="7076434">i</span>&nbsp;<span class="op" id="7076436">:=</span>&nbsp;<span class="num" id="7076439">0</span><span class="op" id="7076440">;</span>&nbsp;<span class="ident" id="7076442">i</span>&nbsp;<span class="op" id="7076444">&lt;</span>&nbsp;<span class="builtinfunc" id="7076446">len</span><span class="op" id="7076449">(</span><span class="ident" id="7076450">m</span><span class="op" id="7076451">.</span><span class="ident" id="7076452">cipherSuites</span><span class="op" id="7076464">)</span><span class="op" id="7076465">;</span>&nbsp;<span class="ident" id="7076467">i</span><span class="op" id="7076468">++</span>&nbsp;<span class="op" id="7076471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7076475">m</span><span class="op" id="7076476">.</span><span class="ident" id="7076477">cipherSuites</span><span class="op" id="7076489">[</span><span class="ident" id="7076490">i</span><span class="op" id="7076491">]</span>&nbsp;<span class="op" id="7076493">=</span>&nbsp;<span class="builtintype" id="7076495">uint16</span><span class="op" id="7076501">(</span><span class="ident" id="7076502">rand</span><span class="op" id="7076506">.</span><span class="ident" id="7076507">Int31</span><span class="op" id="7076512">(</span><span class="op" id="7076513">)</span><span class="op" id="7076514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7076517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7076520">m</span><span class="op" id="7076521">.</span><span class="ident" id="7076522">compressionMethods</span>&nbsp;<span class="op" id="7076541">=</span>&nbsp;<span class="ident" id="7076543">randomBytes</span><span class="op" id="7076554">(</span><span class="ident" id="7076555">rand</span><span class="op" id="7076559">.</span><span class="ident" id="7076560">Intn</span><span class="op" id="7076564">(</span><span class="num" id="7076565">63</span><span class="op" id="7076567">)</span><span class="op" id="7076568">+</span><span class="num" id="7076569">1</span><span class="op" id="7076570">,</span>&nbsp;<span class="ident" id="7076572">rand</span><span class="op" id="7076576">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7076579">if</span>&nbsp;<span class="ident" id="7076582">rand</span><span class="op" id="7076586">.</span><span class="ident" id="7076587">Intn</span><span class="op" id="7076591">(</span><span class="num" id="7076592">10</span><span class="op" id="7076594">)</span>&nbsp;<span class="op" id="7076596">&gt;</span>&nbsp;<span class="num" id="7076598">5</span>&nbsp;<span class="op" id="7076600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7076604">m</span><span class="op" id="7076605">.</span><span class="ident" id="7076606">nextProtoNeg</span>&nbsp;<span class="op" id="7076619">=</span>&nbsp;<span class="builtintype" id="7076621">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7076627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7076630">if</span>&nbsp;<span class="ident" id="7076633">rand</span><span class="op" id="7076637">.</span><span class="ident" id="7076638">Intn</span><span class="op" id="7076642">(</span><span class="num" id="7076643">10</span><span class="op" id="7076645">)</span>&nbsp;<span class="op" id="7076647">&gt;</span>&nbsp;<span class="num" id="7076649">5</span>&nbsp;<span class="op" id="7076651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7076655">m</span><span class="op" id="7076656">.</span><span class="ident" id="7076657">serverName</span>&nbsp;<span class="op" id="7076668">=</span>&nbsp;<span class="ident" id="7076670">randomString</span><span class="op" id="7076682">(</span><span class="ident" id="7076683">rand</span><span class="op" id="7076687">.</span><span class="ident" id="7076688">Intn</span><span class="op" id="7076692">(</span><span class="num" id="7076693">255</span><span class="op" id="7076696">)</span><span class="op" id="7076697">,</span>&nbsp;<span class="ident" id="7076699">rand</span><span class="op" id="7076703">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7076706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7076709">m</span><span class="op" id="7076710">.</span><span class="ident" id="7076711">ocspStapling</span>&nbsp;<span class="op" id="7076724">=</span>&nbsp;<span class="ident" id="7076726">rand</span><span class="op" id="7076730">.</span><span class="ident" id="7076731">Intn</span><span class="op" id="7076735">(</span><span class="num" id="7076736">10</span><span class="op" id="7076738">)</span>&nbsp;<span class="op" id="7076740">&gt;</span>&nbsp;<span class="num" id="7076742">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7076745">m</span><span class="op" id="7076746">.</span><span class="ident" id="7076747">supportedPoints</span>&nbsp;<span class="op" id="7076763">=</span>&nbsp;<span class="ident" id="7076765">randomBytes</span><span class="op" id="7076776">(</span><span class="ident" id="7076777">rand</span><span class="op" id="7076781">.</span><span class="ident" id="7076782">Intn</span><span class="op" id="7076786">(</span><span class="num" id="7076787">5</span><span class="op" id="7076788">)</span><span class="op" id="7076789">+</span><span class="num" id="7076790">1</span><span class="op" id="7076791">,</span>&nbsp;<span class="ident" id="7076793">rand</span><span class="op" id="7076797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7076800">m</span><span class="op" id="7076801">.</span><span class="ident" id="7076802">supportedCurves</span>&nbsp;<span class="op" id="7076818">=</span>&nbsp;<span class="builtinfunc" id="7076820">make</span><span class="op" id="7076824">(</span><span class="op" id="7076825">[</span><span class="op" id="7076826">]</span><span class="ident" id="7076827">CurveID</span><span class="op" id="7076834">,</span>&nbsp;<span class="ident" id="7076836">rand</span><span class="op" id="7076840">.</span><span class="ident" id="7076841">Intn</span><span class="op" id="7076845">(</span><span class="num" id="7076846">5</span><span class="op" id="7076847">)</span><span class="op" id="7076848">+</span><span class="num" id="7076849">1</span><span class="op" id="7076850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7076853">for</span>&nbsp;<span class="ident" id="7076857">i</span>&nbsp;<span class="op" id="7076859">:=</span>&nbsp;<span class="keyword" id="7076862">range</span>&nbsp;<span class="ident" id="7076868">m</span><span class="op" id="7076869">.</span><span class="ident" id="7076870">supportedCurves</span>&nbsp;<span class="op" id="7076886">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7076890">m</span><span class="op" id="7076891">.</span><span class="ident" id="7076892">supportedCurves</span><span class="op" id="7076907">[</span><span class="ident" id="7076908">i</span><span class="op" id="7076909">]</span>&nbsp;<span class="op" id="7076911">=</span>&nbsp;<span class="ident" id="7076913">CurveID</span><span class="op" id="7076920">(</span><span class="ident" id="7076921">rand</span><span class="op" id="7076925">.</span><span class="ident" id="7076926">Intn</span><span class="op" id="7076930">(</span><span class="num" id="7076931">30000</span><span class="op" id="7076936">)</span><span class="op" id="7076937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7076940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7076943">if</span>&nbsp;<span class="ident" id="7076946">rand</span><span class="op" id="7076950">.</span><span class="ident" id="7076951">Intn</span><span class="op" id="7076955">(</span><span class="num" id="7076956">10</span><span class="op" id="7076958">)</span>&nbsp;<span class="op" id="7076960">&gt;</span>&nbsp;<span class="num" id="7076962">5</span>&nbsp;<span class="op" id="7076964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7076968">m</span><span class="op" id="7076969">.</span><span class="ident" id="7076970">ticketSupported</span>&nbsp;<span class="op" id="7076986">=</span>&nbsp;<span class="builtintype" id="7076988">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7076995">if</span>&nbsp;<span class="ident" id="7076998">rand</span><span class="op" id="7077002">.</span><span class="ident" id="7077003">Intn</span><span class="op" id="7077007">(</span><span class="num" id="7077008">10</span><span class="op" id="7077010">)</span>&nbsp;<span class="op" id="7077012">&gt;</span>&nbsp;<span class="num" id="7077014">5</span>&nbsp;<span class="op" id="7077016">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7077021">m</span><span class="op" id="7077022">.</span><span class="ident" id="7077023">sessionTicket</span>&nbsp;<span class="op" id="7077037">=</span>&nbsp;<span class="ident" id="7077039">randomBytes</span><span class="op" id="7077050">(</span><span class="ident" id="7077051">rand</span><span class="op" id="7077055">.</span><span class="ident" id="7077056">Intn</span><span class="op" id="7077060">(</span><span class="num" id="7077061">300</span><span class="op" id="7077064">)</span><span class="op" id="7077065">,</span>&nbsp;<span class="ident" id="7077067">rand</span><span class="op" id="7077071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7077075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7077078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7077081">if</span>&nbsp;<span class="ident" id="7077084">rand</span><span class="op" id="7077088">.</span><span class="ident" id="7077089">Intn</span><span class="op" id="7077093">(</span><span class="num" id="7077094">10</span><span class="op" id="7077096">)</span>&nbsp;<span class="op" id="7077098">&gt;</span>&nbsp;<span class="num" id="7077100">5</span>&nbsp;<span class="op" id="7077102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7077106">m</span><span class="op" id="7077107">.</span><span class="ident" id="7077108">signatureAndHashes</span>&nbsp;<span class="op" id="7077127">=</span>&nbsp;<span class="ident" id="7077129">supportedSKXSignatureAlgorithms</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7077162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7077165">m</span><span class="op" id="7077166">.</span><span class="ident" id="7077167">alpnProtocols</span>&nbsp;<span class="op" id="7077181">=</span>&nbsp;<span class="builtinfunc" id="7077183">make</span><span class="op" id="7077187">(</span><span class="op" id="7077188">[</span><span class="op" id="7077189">]</span><span class="builtintype" id="7077190">string</span><span class="op" id="7077196">,</span>&nbsp;<span class="ident" id="7077198">rand</span><span class="op" id="7077202">.</span><span class="ident" id="7077203">Intn</span><span class="op" id="7077207">(</span><span class="num" id="7077208">5</span><span class="op" id="7077209">)</span><span class="op" id="7077210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7077213">for</span>&nbsp;<span class="ident" id="7077217">i</span>&nbsp;<span class="op" id="7077219">:=</span>&nbsp;<span class="keyword" id="7077222">range</span>&nbsp;<span class="ident" id="7077228">m</span><span class="op" id="7077229">.</span><span class="ident" id="7077230">alpnProtocols</span>&nbsp;<span class="op" id="7077244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7077248">m</span><span class="op" id="7077249">.</span><span class="ident" id="7077250">alpnProtocols</span><span class="op" id="7077263">[</span><span class="ident" id="7077264">i</span><span class="op" id="7077265">]</span>&nbsp;<span class="op" id="7077267">=</span>&nbsp;<span class="ident" id="7077269">randomString</span><span class="op" id="7077281">(</span><span class="ident" id="7077282">rand</span><span class="op" id="7077286">.</span><span class="ident" id="7077287">Intn</span><span class="op" id="7077291">(</span><span class="num" id="7077292">20</span><span class="op" id="7077294">)</span><span class="op" id="7077295">+</span><span class="num" id="7077296">1</span><span class="op" id="7077297">,</span>&nbsp;<span class="ident" id="7077299">rand</span><span class="op" id="7077303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7077306">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7077310">return</span>&nbsp;<span class="ident" id="7077317">reflect</span><span class="op" id="7077324">.</span><span class="ident" id="7077325">ValueOf</span><span class="op" id="7077332">(</span><span class="ident" id="7077333">m</span><span class="op" id="7077334">)</span><br>
<span class="lineno"></span><span class="op" id="7077336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7077339">func</span>&nbsp;<span class="op" id="7077344">(</span><span class="op" id="7077345">*</span><span class="ident" id="7077346">serverHelloMsg</span><span class="op" id="7077360">)</span>&nbsp;<span class="ident" id="7077362">Generate</span><span class="op" id="7077370">(</span><span class="ident" id="7077371">rand</span>&nbsp;<span class="op" id="7077376">*</span><span class="ident" id="7077377">rand</span><span class="op" id="7077381">.</span><span class="ident" id="7077382">Rand</span><span class="op" id="7077386">,</span>&nbsp;<span class="ident" id="7077388">size</span>&nbsp;<span class="builtintype" id="7077393">int</span><span class="op" id="7077396">)</span>&nbsp;<span class="ident" id="7077398">reflect</span><span class="op" id="7077405">.</span><span class="ident" id="7077406">Value</span>&nbsp;<span class="op" id="7077412">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7077415">m</span>&nbsp;<span class="op" id="7077417">:=</span>&nbsp;<span class="op" id="7077420">&amp;</span><span class="ident" id="7077421">serverHelloMsg</span><span class="op" id="7077435">{</span><span class="op" id="7077436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7077439">m</span><span class="op" id="7077440">.</span><span class="ident" id="7077441">vers</span>&nbsp;<span class="op" id="7077446">=</span>&nbsp;<span class="builtintype" id="7077448">uint16</span><span class="op" id="7077454">(</span><span class="ident" id="7077455">rand</span><span class="op" id="7077459">.</span><span class="ident" id="7077460">Intn</span><span class="op" id="7077464">(</span><span class="num" id="7077465">65536</span><span class="op" id="7077470">)</span><span class="op" id="7077471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7077474">m</span><span class="op" id="7077475">.</span><span class="ident" id="7077476">random</span>&nbsp;<span class="op" id="7077483">=</span>&nbsp;<span class="ident" id="7077485">randomBytes</span><span class="op" id="7077496">(</span><span class="num" id="7077497">32</span><span class="op" id="7077499">,</span>&nbsp;<span class="ident" id="7077501">rand</span><span class="op" id="7077505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7077508">m</span><span class="op" id="7077509">.</span><span class="ident" id="7077510">sessionId</span>&nbsp;<span class="op" id="7077520">=</span>&nbsp;<span class="ident" id="7077522">randomBytes</span><span class="op" id="7077533">(</span><span class="ident" id="7077534">rand</span><span class="op" id="7077538">.</span><span class="ident" id="7077539">Intn</span><span class="op" id="7077543">(</span><span class="num" id="7077544">32</span><span class="op" id="7077546">)</span><span class="op" id="7077547">,</span>&nbsp;<span class="ident" id="7077549">rand</span><span class="op" id="7077553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7077556">m</span><span class="op" id="7077557">.</span><span class="ident" id="7077558">cipherSuite</span>&nbsp;<span class="op" id="7077570">=</span>&nbsp;<span class="builtintype" id="7077572">uint16</span><span class="op" id="7077578">(</span><span class="ident" id="7077579">rand</span><span class="op" id="7077583">.</span><span class="ident" id="7077584">Int31</span><span class="op" id="7077589">(</span><span class="op" id="7077590">)</span><span class="op" id="7077591">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7077594">m</span><span class="op" id="7077595">.</span><span class="ident" id="7077596">compressionMethod</span>&nbsp;<span class="op" id="7077614">=</span>&nbsp;<span class="builtintype" id="7077616">uint8</span><span class="op" id="7077621">(</span><span class="ident" id="7077622">rand</span><span class="op" id="7077626">.</span><span class="ident" id="7077627">Intn</span><span class="op" id="7077631">(</span><span class="num" id="7077632">256</span><span class="op" id="7077635">)</span><span class="op" id="7077636">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7077640">if</span>&nbsp;<span class="ident" id="7077643">rand</span><span class="op" id="7077647">.</span><span class="ident" id="7077648">Intn</span><span class="op" id="7077652">(</span><span class="num" id="7077653">10</span><span class="op" id="7077655">)</span>&nbsp;<span class="op" id="7077657">&gt;</span>&nbsp;<span class="num" id="7077659">5</span>&nbsp;<span class="op" id="7077661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7077665">m</span><span class="op" id="7077666">.</span><span class="ident" id="7077667">nextProtoNeg</span>&nbsp;<span class="op" id="7077680">=</span>&nbsp;<span class="builtintype" id="7077682">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7077690">n</span>&nbsp;<span class="op" id="7077692">:=</span>&nbsp;<span class="ident" id="7077695">rand</span><span class="op" id="7077699">.</span><span class="ident" id="7077700">Intn</span><span class="op" id="7077704">(</span><span class="num" id="7077705">10</span><span class="op" id="7077707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7077711">m</span><span class="op" id="7077712">.</span><span class="ident" id="7077713">nextProtos</span>&nbsp;<span class="op" id="7077724">=</span>&nbsp;<span class="builtinfunc" id="7077726">make</span><span class="op" id="7077730">(</span><span class="op" id="7077731">[</span><span class="op" id="7077732">]</span><span class="builtintype" id="7077733">string</span><span class="op" id="7077739">,</span>&nbsp;<span class="ident" id="7077741">n</span><span class="op" id="7077742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7077746">for</span>&nbsp;<span class="ident" id="7077750">i</span>&nbsp;<span class="op" id="7077752">:=</span>&nbsp;<span class="num" id="7077755">0</span><span class="op" id="7077756">;</span>&nbsp;<span class="ident" id="7077758">i</span>&nbsp;<span class="op" id="7077760">&lt;</span>&nbsp;<span class="ident" id="7077762">n</span><span class="op" id="7077763">;</span>&nbsp;<span class="ident" id="7077765">i</span><span class="op" id="7077766">++</span>&nbsp;<span class="op" id="7077769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7077774">m</span><span class="op" id="7077775">.</span><span class="ident" id="7077776">nextProtos</span><span class="op" id="7077786">[</span><span class="ident" id="7077787">i</span><span class="op" id="7077788">]</span>&nbsp;<span class="op" id="7077790">=</span>&nbsp;<span class="ident" id="7077792">randomString</span><span class="op" id="7077804">(</span><span class="num" id="7077805">20</span><span class="op" id="7077807">,</span>&nbsp;<span class="ident" id="7077809">rand</span><span class="op" id="7077813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7077817">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7077820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7077824">if</span>&nbsp;<span class="ident" id="7077827">rand</span><span class="op" id="7077831">.</span><span class="ident" id="7077832">Intn</span><span class="op" id="7077836">(</span><span class="num" id="7077837">10</span><span class="op" id="7077839">)</span>&nbsp;<span class="op" id="7077841">&gt;</span>&nbsp;<span class="num" id="7077843">5</span>&nbsp;<span class="op" id="7077845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7077849">m</span><span class="op" id="7077850">.</span><span class="ident" id="7077851">ocspStapling</span>&nbsp;<span class="op" id="7077864">=</span>&nbsp;<span class="builtintype" id="7077866">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7077872">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7077875">if</span>&nbsp;<span class="ident" id="7077878">rand</span><span class="op" id="7077882">.</span><span class="ident" id="7077883">Intn</span><span class="op" id="7077887">(</span><span class="num" id="7077888">10</span><span class="op" id="7077890">)</span>&nbsp;<span class="op" id="7077892">&gt;</span>&nbsp;<span class="num" id="7077894">5</span>&nbsp;<span class="op" id="7077896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7077900">m</span><span class="op" id="7077901">.</span><span class="ident" id="7077902">ticketSupported</span>&nbsp;<span class="op" id="7077918">=</span>&nbsp;<span class="builtintype" id="7077920">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7077926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7077929">m</span><span class="op" id="7077930">.</span><span class="ident" id="7077931">alpnProtocol</span>&nbsp;<span class="op" id="7077944">=</span>&nbsp;<span class="ident" id="7077946">randomString</span><span class="op" id="7077958">(</span><span class="ident" id="7077959">rand</span><span class="op" id="7077963">.</span><span class="ident" id="7077964">Intn</span><span class="op" id="7077968">(</span><span class="num" id="7077969">32</span><span class="op" id="7077971">)</span><span class="op" id="7077972">+</span><span class="num" id="7077973">1</span><span class="op" id="7077974">,</span>&nbsp;<span class="ident" id="7077976">rand</span><span class="op" id="7077980">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7077984">return</span>&nbsp;<span class="ident" id="7077991">reflect</span><span class="op" id="7077998">.</span><span class="ident" id="7077999">ValueOf</span><span class="op" id="7078006">(</span><span class="ident" id="7078007">m</span><span class="op" id="7078008">)</span><br>
<span class="lineno"></span><span class="op" id="7078010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7078013">func</span>&nbsp;<span class="op" id="7078018">(</span><span class="op" id="7078019">*</span><span class="ident" id="7078020">certificateMsg</span><span class="op" id="7078034">)</span>&nbsp;<span class="ident" id="7078036">Generate</span><span class="op" id="7078044">(</span><span class="ident" id="7078045">rand</span>&nbsp;<span class="op" id="7078050">*</span><span class="ident" id="7078051">rand</span><span class="op" id="7078055">.</span><span class="ident" id="7078056">Rand</span><span class="op" id="7078060">,</span>&nbsp;<span class="ident" id="7078062">size</span>&nbsp;<span class="builtintype" id="7078067">int</span><span class="op" id="7078070">)</span>&nbsp;<span class="ident" id="7078072">reflect</span><span class="op" id="7078079">.</span><span class="ident" id="7078080">Value</span>&nbsp;<span class="op" id="7078086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7078089">m</span>&nbsp;<span class="op" id="7078091">:=</span>&nbsp;<span class="op" id="7078094">&amp;</span><span class="ident" id="7078095">certificateMsg</span><span class="op" id="7078109">{</span><span class="op" id="7078110">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7078113">numCerts</span>&nbsp;<span class="op" id="7078122">:=</span>&nbsp;<span class="ident" id="7078125">rand</span><span class="op" id="7078129">.</span><span class="ident" id="7078130">Intn</span><span class="op" id="7078134">(</span><span class="num" id="7078135">20</span><span class="op" id="7078137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7078140">m</span><span class="op" id="7078141">.</span><span class="ident" id="7078142">certificates</span>&nbsp;<span class="op" id="7078155">=</span>&nbsp;<span class="builtinfunc" id="7078157">make</span><span class="op" id="7078161">(</span><span class="op" id="7078162">[</span><span class="op" id="7078163">]</span><span class="op" id="7078164">[</span><span class="op" id="7078165">]</span><span class="builtintype" id="7078166">byte</span><span class="op" id="7078170">,</span>&nbsp;<span class="ident" id="7078172">numCerts</span><span class="op" id="7078180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7078183">for</span>&nbsp;<span class="ident" id="7078187">i</span>&nbsp;<span class="op" id="7078189">:=</span>&nbsp;<span class="num" id="7078192">0</span><span class="op" id="7078193">;</span>&nbsp;<span class="ident" id="7078195">i</span>&nbsp;<span class="op" id="7078197">&lt;</span>&nbsp;<span class="ident" id="7078199">numCerts</span><span class="op" id="7078207">;</span>&nbsp;<span class="ident" id="7078209">i</span><span class="op" id="7078210">++</span>&nbsp;<span class="op" id="7078213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7078217">m</span><span class="op" id="7078218">.</span><span class="ident" id="7078219">certificates</span><span class="op" id="7078231">[</span><span class="ident" id="7078232">i</span><span class="op" id="7078233">]</span>&nbsp;<span class="op" id="7078235">=</span>&nbsp;<span class="ident" id="7078237">randomBytes</span><span class="op" id="7078248">(</span><span class="ident" id="7078249">rand</span><span class="op" id="7078253">.</span><span class="ident" id="7078254">Intn</span><span class="op" id="7078258">(</span><span class="num" id="7078259">10</span><span class="op" id="7078261">)</span><span class="op" id="7078262">+</span><span class="num" id="7078263">1</span><span class="op" id="7078264">,</span>&nbsp;<span class="ident" id="7078266">rand</span><span class="op" id="7078270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7078273">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7078276">return</span>&nbsp;<span class="ident" id="7078283">reflect</span><span class="op" id="7078290">.</span><span class="ident" id="7078291">ValueOf</span><span class="op" id="7078298">(</span><span class="ident" id="7078299">m</span><span class="op" id="7078300">)</span><br>
<span class="lineno"></span><span class="op" id="7078302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7078305">func</span>&nbsp;<span class="op" id="7078310">(</span><span class="op" id="7078311">*</span><span class="ident" id="7078312">certificateRequestMsg</span><span class="op" id="7078333">)</span>&nbsp;<span class="ident" id="7078335">Generate</span><span class="op" id="7078343">(</span><span class="ident" id="7078344">rand</span>&nbsp;<span class="op" id="7078349">*</span><span class="ident" id="7078350">rand</span><span class="op" id="7078354">.</span><span class="ident" id="7078355">Rand</span><span class="op" id="7078359">,</span>&nbsp;<span class="ident" id="7078361">size</span>&nbsp;<span class="builtintype" id="7078366">int</span><span class="op" id="7078369">)</span>&nbsp;<span class="ident" id="7078371">reflect</span><span class="op" id="7078378">.</span><span class="ident" id="7078379">Value</span>&nbsp;<span class="op" id="7078385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7078388">m</span>&nbsp;<span class="op" id="7078390">:=</span>&nbsp;<span class="op" id="7078393">&amp;</span><span class="ident" id="7078394">certificateRequestMsg</span><span class="op" id="7078415">{</span><span class="op" id="7078416">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7078419">m</span><span class="op" id="7078420">.</span><span class="ident" id="7078421">certificateTypes</span>&nbsp;<span class="op" id="7078438">=</span>&nbsp;<span class="ident" id="7078440">randomBytes</span><span class="op" id="7078451">(</span><span class="ident" id="7078452">rand</span><span class="op" id="7078456">.</span><span class="ident" id="7078457">Intn</span><span class="op" id="7078461">(</span><span class="num" id="7078462">5</span><span class="op" id="7078463">)</span><span class="op" id="7078464">+</span><span class="num" id="7078465">1</span><span class="op" id="7078466">,</span>&nbsp;<span class="ident" id="7078468">rand</span><span class="op" id="7078472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7078475">numCAs</span>&nbsp;<span class="op" id="7078482">:=</span>&nbsp;<span class="ident" id="7078485">rand</span><span class="op" id="7078489">.</span><span class="ident" id="7078490">Intn</span><span class="op" id="7078494">(</span><span class="num" id="7078495">100</span><span class="op" id="7078498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7078501">m</span><span class="op" id="7078502">.</span><span class="ident" id="7078503">certificateAuthorities</span>&nbsp;<span class="op" id="7078526">=</span>&nbsp;<span class="builtinfunc" id="7078528">make</span><span class="op" id="7078532">(</span><span class="op" id="7078533">[</span><span class="op" id="7078534">]</span><span class="op" id="7078535">[</span><span class="op" id="7078536">]</span><span class="builtintype" id="7078537">byte</span><span class="op" id="7078541">,</span>&nbsp;<span class="ident" id="7078543">numCAs</span><span class="op" id="7078549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7078552">for</span>&nbsp;<span class="ident" id="7078556">i</span>&nbsp;<span class="op" id="7078558">:=</span>&nbsp;<span class="num" id="7078561">0</span><span class="op" id="7078562">;</span>&nbsp;<span class="ident" id="7078564">i</span>&nbsp;<span class="op" id="7078566">&lt;</span>&nbsp;<span class="ident" id="7078568">numCAs</span><span class="op" id="7078574">;</span>&nbsp;<span class="ident" id="7078576">i</span><span class="op" id="7078577">++</span>&nbsp;<span class="op" id="7078580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7078584">m</span><span class="op" id="7078585">.</span><span class="ident" id="7078586">certificateAuthorities</span><span class="op" id="7078608">[</span><span class="ident" id="7078609">i</span><span class="op" id="7078610">]</span>&nbsp;<span class="op" id="7078612">=</span>&nbsp;<span class="ident" id="7078614">randomBytes</span><span class="op" id="7078625">(</span><span class="ident" id="7078626">rand</span><span class="op" id="7078630">.</span><span class="ident" id="7078631">Intn</span><span class="op" id="7078635">(</span><span class="num" id="7078636">15</span><span class="op" id="7078638">)</span><span class="op" id="7078639">+</span><span class="num" id="7078640">1</span><span class="op" id="7078641">,</span>&nbsp;<span class="ident" id="7078643">rand</span><span class="op" id="7078647">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7078650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7078653">return</span>&nbsp;<span class="ident" id="7078660">reflect</span><span class="op" id="7078667">.</span><span class="ident" id="7078668">ValueOf</span><span class="op" id="7078675">(</span><span class="ident" id="7078676">m</span><span class="op" id="7078677">)</span><br>
<span class="lineno"></span><span class="op" id="7078679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7078682">func</span>&nbsp;<span class="op" id="7078687">(</span><span class="op" id="7078688">*</span><span class="ident" id="7078689">certificateVerifyMsg</span><span class="op" id="7078709">)</span>&nbsp;<span class="ident" id="7078711">Generate</span><span class="op" id="7078719">(</span><span class="ident" id="7078720">rand</span>&nbsp;<span class="op" id="7078725">*</span><span class="ident" id="7078726">rand</span><span class="op" id="7078730">.</span><span class="ident" id="7078731">Rand</span><span class="op" id="7078735">,</span>&nbsp;<span class="ident" id="7078737">size</span>&nbsp;<span class="builtintype" id="7078742">int</span><span class="op" id="7078745">)</span>&nbsp;<span class="ident" id="7078747">reflect</span><span class="op" id="7078754">.</span><span class="ident" id="7078755">Value</span>&nbsp;<span class="op" id="7078761">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7078764">m</span>&nbsp;<span class="op" id="7078766">:=</span>&nbsp;<span class="op" id="7078769">&amp;</span><span class="ident" id="7078770">certificateVerifyMsg</span><span class="op" id="7078790">{</span><span class="op" id="7078791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7078794">m</span><span class="op" id="7078795">.</span><span class="ident" id="7078796">signature</span>&nbsp;<span class="op" id="7078806">=</span>&nbsp;<span class="ident" id="7078808">randomBytes</span><span class="op" id="7078819">(</span><span class="ident" id="7078820">rand</span><span class="op" id="7078824">.</span><span class="ident" id="7078825">Intn</span><span class="op" id="7078829">(</span><span class="num" id="7078830">15</span><span class="op" id="7078832">)</span><span class="op" id="7078833">+</span><span class="num" id="7078834">1</span><span class="op" id="7078835">,</span>&nbsp;<span class="ident" id="7078837">rand</span><span class="op" id="7078841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7078844">return</span>&nbsp;<span class="ident" id="7078851">reflect</span><span class="op" id="7078858">.</span><span class="ident" id="7078859">ValueOf</span><span class="op" id="7078866">(</span><span class="ident" id="7078867">m</span><span class="op" id="7078868">)</span><br>
<span class="lineno"></span><span class="op" id="7078870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="keyword" id="7078873">func</span>&nbsp;<span class="op" id="7078878">(</span><span class="op" id="7078879">*</span><span class="ident" id="7078880">certificateStatusMsg</span><span class="op" id="7078900">)</span>&nbsp;<span class="ident" id="7078902">Generate</span><span class="op" id="7078910">(</span><span class="ident" id="7078911">rand</span>&nbsp;<span class="op" id="7078916">*</span><span class="ident" id="7078917">rand</span><span class="op" id="7078921">.</span><span class="ident" id="7078922">Rand</span><span class="op" id="7078926">,</span>&nbsp;<span class="ident" id="7078928">size</span>&nbsp;<span class="builtintype" id="7078933">int</span><span class="op" id="7078936">)</span>&nbsp;<span class="ident" id="7078938">reflect</span><span class="op" id="7078945">.</span><span class="ident" id="7078946">Value</span>&nbsp;<span class="op" id="7078952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7078955">m</span>&nbsp;<span class="op" id="7078957">:=</span>&nbsp;<span class="op" id="7078960">&amp;</span><span class="ident" id="7078961">certificateStatusMsg</span><span class="op" id="7078981">{</span><span class="op" id="7078982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7078985">if</span>&nbsp;<span class="ident" id="7078988">rand</span><span class="op" id="7078992">.</span><span class="ident" id="7078993">Intn</span><span class="op" id="7078997">(</span><span class="num" id="7078998">10</span><span class="op" id="7079000">)</span>&nbsp;<span class="op" id="7079002">&gt;</span>&nbsp;<span class="num" id="7079004">5</span>&nbsp;<span class="op" id="7079006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7079010">m</span><span class="op" id="7079011">.</span><span class="ident" id="7079012">statusType</span>&nbsp;<span class="op" id="7079023">=</span>&nbsp;<span class="ident" id="7079025">statusTypeOCSP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7079042">m</span><span class="op" id="7079043">.</span><span class="ident" id="7079044">response</span>&nbsp;<span class="op" id="7079053">=</span>&nbsp;<span class="ident" id="7079055">randomBytes</span><span class="op" id="7079066">(</span><span class="ident" id="7079067">rand</span><span class="op" id="7079071">.</span><span class="ident" id="7079072">Intn</span><span class="op" id="7079076">(</span><span class="num" id="7079077">10</span><span class="op" id="7079079">)</span><span class="op" id="7079080">+</span><span class="num" id="7079081">1</span><span class="op" id="7079082">,</span>&nbsp;<span class="ident" id="7079084">rand</span><span class="op" id="7079088">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7079091">}</span>&nbsp;<span class="keyword" id="7079093">else</span>&nbsp;<span class="op" id="7079098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7079102">m</span><span class="op" id="7079103">.</span><span class="ident" id="7079104">statusType</span>&nbsp;<span class="op" id="7079115">=</span>&nbsp;<span class="num" id="7079117">42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7079121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7079124">return</span>&nbsp;<span class="ident" id="7079131">reflect</span><span class="op" id="7079138">.</span><span class="ident" id="7079139">ValueOf</span><span class="op" id="7079146">(</span><span class="ident" id="7079147">m</span><span class="op" id="7079148">)</span><br>
<span class="lineno"></span><span class="op" id="7079150">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="7079153">func</span>&nbsp;<span class="op" id="7079158">(</span><span class="op" id="7079159">*</span><span class="ident" id="7079160">clientKeyExchangeMsg</span><span class="op" id="7079180">)</span>&nbsp;<span class="ident" id="7079182">Generate</span><span class="op" id="7079190">(</span><span class="ident" id="7079191">rand</span>&nbsp;<span class="op" id="7079196">*</span><span class="ident" id="7079197">rand</span><span class="op" id="7079201">.</span><span class="ident" id="7079202">Rand</span><span class="op" id="7079206">,</span>&nbsp;<span class="ident" id="7079208">size</span>&nbsp;<span class="builtintype" id="7079213">int</span><span class="op" id="7079216">)</span>&nbsp;<span class="ident" id="7079218">reflect</span><span class="op" id="7079225">.</span><span class="ident" id="7079226">Value</span>&nbsp;<span class="op" id="7079232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7079235">m</span>&nbsp;<span class="op" id="7079237">:=</span>&nbsp;<span class="op" id="7079240">&amp;</span><span class="ident" id="7079241">clientKeyExchangeMsg</span><span class="op" id="7079261">{</span><span class="op" id="7079262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7079265">m</span><span class="op" id="7079266">.</span><span class="ident" id="7079267">ciphertext</span>&nbsp;<span class="op" id="7079278">=</span>&nbsp;<span class="ident" id="7079280">randomBytes</span><span class="op" id="7079291">(</span><span class="ident" id="7079292">rand</span><span class="op" id="7079296">.</span><span class="ident" id="7079297">Intn</span><span class="op" id="7079301">(</span><span class="num" id="7079302">1000</span><span class="op" id="7079306">)</span><span class="op" id="7079307">+</span><span class="num" id="7079308">1</span><span class="op" id="7079309">,</span>&nbsp;<span class="ident" id="7079311">rand</span><span class="op" id="7079315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7079318">return</span>&nbsp;<span class="ident" id="7079325">reflect</span><span class="op" id="7079332">.</span><span class="ident" id="7079333">ValueOf</span><span class="op" id="7079340">(</span><span class="ident" id="7079341">m</span><span class="op" id="7079342">)</span><br>
<span class="lineno">220</span><span class="op" id="7079344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7079347">func</span>&nbsp;<span class="op" id="7079352">(</span><span class="op" id="7079353">*</span><span class="ident" id="7079354">finishedMsg</span><span class="op" id="7079365">)</span>&nbsp;<span class="ident" id="7079367">Generate</span><span class="op" id="7079375">(</span><span class="ident" id="7079376">rand</span>&nbsp;<span class="op" id="7079381">*</span><span class="ident" id="7079382">rand</span><span class="op" id="7079386">.</span><span class="ident" id="7079387">Rand</span><span class="op" id="7079391">,</span>&nbsp;<span class="ident" id="7079393">size</span>&nbsp;<span class="builtintype" id="7079398">int</span><span class="op" id="7079401">)</span>&nbsp;<span class="ident" id="7079403">reflect</span><span class="op" id="7079410">.</span><span class="ident" id="7079411">Value</span>&nbsp;<span class="op" id="7079417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7079420">m</span>&nbsp;<span class="op" id="7079422">:=</span>&nbsp;<span class="op" id="7079425">&amp;</span><span class="ident" id="7079426">finishedMsg</span><span class="op" id="7079437">{</span><span class="op" id="7079438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7079441">m</span><span class="op" id="7079442">.</span><span class="ident" id="7079443">verifyData</span>&nbsp;<span class="op" id="7079454">=</span>&nbsp;<span class="ident" id="7079456">randomBytes</span><span class="op" id="7079467">(</span><span class="num" id="7079468">12</span><span class="op" id="7079470">,</span>&nbsp;<span class="ident" id="7079472">rand</span><span class="op" id="7079476">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7079479">return</span>&nbsp;<span class="ident" id="7079486">reflect</span><span class="op" id="7079493">.</span><span class="ident" id="7079494">ValueOf</span><span class="op" id="7079501">(</span><span class="ident" id="7079502">m</span><span class="op" id="7079503">)</span><br>
<span class="lineno"></span><span class="op" id="7079505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7079508">func</span>&nbsp;<span class="op" id="7079513">(</span><span class="op" id="7079514">*</span><span class="ident" id="7079515">nextProtoMsg</span><span class="op" id="7079527">)</span>&nbsp;<span class="ident" id="7079529">Generate</span><span class="op" id="7079537">(</span><span class="ident" id="7079538">rand</span>&nbsp;<span class="op" id="7079543">*</span><span class="ident" id="7079544">rand</span><span class="op" id="7079548">.</span><span class="ident" id="7079549">Rand</span><span class="op" id="7079553">,</span>&nbsp;<span class="ident" id="7079555">size</span>&nbsp;<span class="builtintype" id="7079560">int</span><span class="op" id="7079563">)</span>&nbsp;<span class="ident" id="7079565">reflect</span><span class="op" id="7079572">.</span><span class="ident" id="7079573">Value</span>&nbsp;<span class="op" id="7079579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7079582">m</span>&nbsp;<span class="op" id="7079584">:=</span>&nbsp;<span class="op" id="7079587">&amp;</span><span class="ident" id="7079588">nextProtoMsg</span><span class="op" id="7079600">{</span><span class="op" id="7079601">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7079604">m</span><span class="op" id="7079605">.</span><span class="ident" id="7079606">proto</span>&nbsp;<span class="op" id="7079612">=</span>&nbsp;<span class="ident" id="7079614">randomString</span><span class="op" id="7079626">(</span><span class="ident" id="7079627">rand</span><span class="op" id="7079631">.</span><span class="ident" id="7079632">Intn</span><span class="op" id="7079636">(</span><span class="num" id="7079637">255</span><span class="op" id="7079640">)</span><span class="op" id="7079641">,</span>&nbsp;<span class="ident" id="7079643">rand</span><span class="op" id="7079647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7079650">return</span>&nbsp;<span class="ident" id="7079657">reflect</span><span class="op" id="7079664">.</span><span class="ident" id="7079665">ValueOf</span><span class="op" id="7079672">(</span><span class="ident" id="7079673">m</span><span class="op" id="7079674">)</span><br>
<span class="lineno"></span><span class="op" id="7079676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7079679">func</span>&nbsp;<span class="op" id="7079684">(</span><span class="op" id="7079685">*</span><span class="ident" id="7079686">newSessionTicketMsg</span><span class="op" id="7079705">)</span>&nbsp;<span class="ident" id="7079707">Generate</span><span class="op" id="7079715">(</span><span class="ident" id="7079716">rand</span>&nbsp;<span class="op" id="7079721">*</span><span class="ident" id="7079722">rand</span><span class="op" id="7079726">.</span><span class="ident" id="7079727">Rand</span><span class="op" id="7079731">,</span>&nbsp;<span class="ident" id="7079733">size</span>&nbsp;<span class="builtintype" id="7079738">int</span><span class="op" id="7079741">)</span>&nbsp;<span class="ident" id="7079743">reflect</span><span class="op" id="7079750">.</span><span class="ident" id="7079751">Value</span>&nbsp;<span class="op" id="7079757">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7079760">m</span>&nbsp;<span class="op" id="7079762">:=</span>&nbsp;<span class="op" id="7079765">&amp;</span><span class="ident" id="7079766">newSessionTicketMsg</span><span class="op" id="7079785">{</span><span class="op" id="7079786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7079789">m</span><span class="op" id="7079790">.</span><span class="ident" id="7079791">ticket</span>&nbsp;<span class="op" id="7079798">=</span>&nbsp;<span class="ident" id="7079800">randomBytes</span><span class="op" id="7079811">(</span><span class="ident" id="7079812">rand</span><span class="op" id="7079816">.</span><span class="ident" id="7079817">Intn</span><span class="op" id="7079821">(</span><span class="num" id="7079822">4</span><span class="op" id="7079823">)</span><span class="op" id="7079824">,</span>&nbsp;<span class="ident" id="7079826">rand</span><span class="op" id="7079830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7079833">return</span>&nbsp;<span class="ident" id="7079840">reflect</span><span class="op" id="7079847">.</span><span class="ident" id="7079848">ValueOf</span><span class="op" id="7079855">(</span><span class="ident" id="7079856">m</span><span class="op" id="7079857">)</span><br>
<span class="lineno"></span><span class="op" id="7079859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="7079862">func</span>&nbsp;<span class="op" id="7079867">(</span><span class="op" id="7079868">*</span><span class="ident" id="7079869">sessionState</span><span class="op" id="7079881">)</span>&nbsp;<span class="ident" id="7079883">Generate</span><span class="op" id="7079891">(</span><span class="ident" id="7079892">rand</span>&nbsp;<span class="op" id="7079897">*</span><span class="ident" id="7079898">rand</span><span class="op" id="7079902">.</span><span class="ident" id="7079903">Rand</span><span class="op" id="7079907">,</span>&nbsp;<span class="ident" id="7079909">size</span>&nbsp;<span class="builtintype" id="7079914">int</span><span class="op" id="7079917">)</span>&nbsp;<span class="ident" id="7079919">reflect</span><span class="op" id="7079926">.</span><span class="ident" id="7079927">Value</span>&nbsp;<span class="op" id="7079933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7079936">s</span>&nbsp;<span class="op" id="7079938">:=</span>&nbsp;<span class="op" id="7079941">&amp;</span><span class="ident" id="7079942">sessionState</span><span class="op" id="7079954">{</span><span class="op" id="7079955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7079958">s</span><span class="op" id="7079959">.</span><span class="ident" id="7079960">vers</span>&nbsp;<span class="op" id="7079965">=</span>&nbsp;<span class="builtintype" id="7079967">uint16</span><span class="op" id="7079973">(</span><span class="ident" id="7079974">rand</span><span class="op" id="7079978">.</span><span class="ident" id="7079979">Intn</span><span class="op" id="7079983">(</span><span class="num" id="7079984">10000</span><span class="op" id="7079989">)</span><span class="op" id="7079990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7079993">s</span><span class="op" id="7079994">.</span><span class="ident" id="7079995">cipherSuite</span>&nbsp;<span class="op" id="7080007">=</span>&nbsp;<span class="builtintype" id="7080009">uint16</span><span class="op" id="7080015">(</span><span class="ident" id="7080016">rand</span><span class="op" id="7080020">.</span><span class="ident" id="7080021">Intn</span><span class="op" id="7080025">(</span><span class="num" id="7080026">10000</span><span class="op" id="7080031">)</span><span class="op" id="7080032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7080035">s</span><span class="op" id="7080036">.</span><span class="ident" id="7080037">masterSecret</span>&nbsp;<span class="op" id="7080050">=</span>&nbsp;<span class="ident" id="7080052">randomBytes</span><span class="op" id="7080063">(</span><span class="ident" id="7080064">rand</span><span class="op" id="7080068">.</span><span class="ident" id="7080069">Intn</span><span class="op" id="7080073">(</span><span class="num" id="7080074">100</span><span class="op" id="7080077">)</span><span class="op" id="7080078">,</span>&nbsp;<span class="ident" id="7080080">rand</span><span class="op" id="7080084">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7080087">numCerts</span>&nbsp;<span class="op" id="7080096">:=</span>&nbsp;<span class="ident" id="7080099">rand</span><span class="op" id="7080103">.</span><span class="ident" id="7080104">Intn</span><span class="op" id="7080108">(</span><span class="num" id="7080109">20</span><span class="op" id="7080111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7080114">s</span><span class="op" id="7080115">.</span><span class="ident" id="7080116">certificates</span>&nbsp;<span class="op" id="7080129">=</span>&nbsp;<span class="builtinfunc" id="7080131">make</span><span class="op" id="7080135">(</span><span class="op" id="7080136">[</span><span class="op" id="7080137">]</span><span class="op" id="7080138">[</span><span class="op" id="7080139">]</span><span class="builtintype" id="7080140">byte</span><span class="op" id="7080144">,</span>&nbsp;<span class="ident" id="7080146">numCerts</span><span class="op" id="7080154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7080157">for</span>&nbsp;<span class="ident" id="7080161">i</span>&nbsp;<span class="op" id="7080163">:=</span>&nbsp;<span class="num" id="7080166">0</span><span class="op" id="7080167">;</span>&nbsp;<span class="ident" id="7080169">i</span>&nbsp;<span class="op" id="7080171">&lt;</span>&nbsp;<span class="ident" id="7080173">numCerts</span><span class="op" id="7080181">;</span>&nbsp;<span class="ident" id="7080183">i</span><span class="op" id="7080184">++</span>&nbsp;<span class="op" id="7080187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7080191">s</span><span class="op" id="7080192">.</span><span class="ident" id="7080193">certificates</span><span class="op" id="7080205">[</span><span class="ident" id="7080206">i</span><span class="op" id="7080207">]</span>&nbsp;<span class="op" id="7080209">=</span>&nbsp;<span class="ident" id="7080211">randomBytes</span><span class="op" id="7080222">(</span><span class="ident" id="7080223">rand</span><span class="op" id="7080227">.</span><span class="ident" id="7080228">Intn</span><span class="op" id="7080232">(</span><span class="num" id="7080233">10</span><span class="op" id="7080235">)</span><span class="op" id="7080236">+</span><span class="num" id="7080237">1</span><span class="op" id="7080238">,</span>&nbsp;<span class="ident" id="7080240">rand</span><span class="op" id="7080244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7080247">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7080250">return</span>&nbsp;<span class="ident" id="7080257">reflect</span><span class="op" id="7080264">.</span><span class="ident" id="7080265">ValueOf</span><span class="op" id="7080272">(</span><span class="ident" id="7080273">s</span><span class="op" id="7080274">)</span><br>
<span class="lineno"></span><span class="op" id="7080276">}</span>
</div>
</body>
</html>
