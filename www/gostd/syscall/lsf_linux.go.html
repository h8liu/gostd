<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>syscall</h2>
<ul>
<li><a href="/gostd/syscall/creds_test.go.html">creds_test.go</a></li>
<li><a href="/gostd/syscall/env_unix.go.html">env_unix.go</a></li>
<li><a href="/gostd/syscall/exec_linux.go.html">exec_linux.go</a></li>
<li><a href="/gostd/syscall/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/syscall/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/syscall/flock.go.html">flock.go</a></li>
<li><a href="/gostd/syscall/lsf_linux.go.html">lsf_linux.go</a></li>
<li><a href="/gostd/syscall/mmap_unix_test.go.html">mmap_unix_test.go</a></li>
<li><a href="/gostd/syscall/netlink_linux.go.html">netlink_linux.go</a></li>
<li><a href="/gostd/syscall/race0.go.html">race0.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_linux.go.html">sockcmsg_linux.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_unix.go.html">sockcmsg_unix.go</a></li>
<li><a href="/gostd/syscall/str.go.html">str.go</a></li>
<li><a href="/gostd/syscall/syscall.go.html">syscall.go</a></li>
<li><a href="/gostd/syscall/syscall_linux.go.html">syscall_linux.go</a></li>
<li><a href="/gostd/syscall/syscall_linux_amd64.go.html">syscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/syscall_test.go.html">syscall_test.go</a></li>
<li><a href="/gostd/syscall/syscall_unix.go.html">syscall_unix.go</a></li>
<li><a href="/gostd/syscall/syscall_unix_test.go.html">syscall_unix_test.go</a></li>
<li><a href="/gostd/syscall/zerrors_linux_amd64.go.html">zerrors_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsyscall_linux_amd64.go.html">zsyscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsysnum_linux_amd64.go.html">zsysnum_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/ztypes_linux_amd64.go.html">ztypes_linux_amd64.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2528388">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2528444">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2528498">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2528549">//&nbsp;Linux&nbsp;socket&nbsp;filter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2528573">package</span>&nbsp;<span class="ident" id="2528581">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2528590">import</span>&nbsp;<span class="op" id="2528597">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2528600">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="2528609">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2528612">func</span>&nbsp;<span class="ident" id="2528617">LsfStmt</span><span class="op" id="2528624">(</span><span class="ident" id="2528625">code</span><span class="op" id="2528629">,</span>&nbsp;<span class="ident" id="2528631">k</span>&nbsp;<span class="builtintype" id="2528633">int</span><span class="op" id="2528636">)</span>&nbsp;<span class="op" id="2528638">*</span><span class="ident" id="2528639">SockFilter</span>&nbsp;<span class="op" id="2528650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528653">return</span>&nbsp;<span class="op" id="2528660">&amp;</span><span class="ident" id="2528661">SockFilter</span><span class="op" id="2528671">{</span><span class="ident" id="2528672">Code</span><span class="op" id="2528676">:</span>&nbsp;<span class="builtintype" id="2528678">uint16</span><span class="op" id="2528684">(</span><span class="ident" id="2528685">code</span><span class="op" id="2528689">)</span><span class="op" id="2528690">,</span>&nbsp;<span class="ident" id="2528692">K</span><span class="op" id="2528693">:</span>&nbsp;<span class="builtintype" id="2528695">uint32</span><span class="op" id="2528701">(</span><span class="ident" id="2528702">k</span><span class="op" id="2528703">)</span><span class="op" id="2528704">}</span><br>
<span class="lineno">15</span><span class="op" id="2528706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2528709">func</span>&nbsp;<span class="ident" id="2528714">LsfJump</span><span class="op" id="2528721">(</span><span class="ident" id="2528722">code</span><span class="op" id="2528726">,</span>&nbsp;<span class="ident" id="2528728">k</span><span class="op" id="2528729">,</span>&nbsp;<span class="ident" id="2528731">jt</span><span class="op" id="2528733">,</span>&nbsp;<span class="ident" id="2528735">jf</span>&nbsp;<span class="builtintype" id="2528738">int</span><span class="op" id="2528741">)</span>&nbsp;<span class="op" id="2528743">*</span><span class="ident" id="2528744">SockFilter</span>&nbsp;<span class="op" id="2528755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528758">return</span>&nbsp;<span class="op" id="2528765">&amp;</span><span class="ident" id="2528766">SockFilter</span><span class="op" id="2528776">{</span><span class="ident" id="2528777">Code</span><span class="op" id="2528781">:</span>&nbsp;<span class="builtintype" id="2528783">uint16</span><span class="op" id="2528789">(</span><span class="ident" id="2528790">code</span><span class="op" id="2528794">)</span><span class="op" id="2528795">,</span>&nbsp;<span class="ident" id="2528797">Jt</span><span class="op" id="2528799">:</span>&nbsp;<span class="builtintype" id="2528801">uint8</span><span class="op" id="2528806">(</span><span class="ident" id="2528807">jt</span><span class="op" id="2528809">)</span><span class="op" id="2528810">,</span>&nbsp;<span class="ident" id="2528812">Jf</span><span class="op" id="2528814">:</span>&nbsp;<span class="builtintype" id="2528816">uint8</span><span class="op" id="2528821">(</span><span class="ident" id="2528822">jf</span><span class="op" id="2528824">)</span><span class="op" id="2528825">,</span>&nbsp;<span class="ident" id="2528827">K</span><span class="op" id="2528828">:</span>&nbsp;<span class="builtintype" id="2528830">uint32</span><span class="op" id="2528836">(</span><span class="ident" id="2528837">k</span><span class="op" id="2528838">)</span><span class="op" id="2528839">}</span><br>
<span class="lineno"></span><span class="op" id="2528841">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="2528844">func</span>&nbsp;<span class="ident" id="2528849">LsfSocket</span><span class="op" id="2528858">(</span><span class="ident" id="2528859">ifindex</span><span class="op" id="2528866">,</span>&nbsp;<span class="ident" id="2528868">proto</span>&nbsp;<span class="builtintype" id="2528874">int</span><span class="op" id="2528877">)</span>&nbsp;<span class="op" id="2528879">(</span><span class="builtintype" id="2528880">int</span><span class="op" id="2528883">,</span>&nbsp;<span class="builtintype" id="2528885">error</span><span class="op" id="2528890">)</span>&nbsp;<span class="op" id="2528892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528895">var</span>&nbsp;<span class="ident" id="2528899">lsall</span>&nbsp;<span class="ident" id="2528905">SockaddrLinklayer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2528924">s</span><span class="op" id="2528925">,</span>&nbsp;<span class="ident" id="2528927">e</span>&nbsp;<span class="op" id="2528929">:=</span>&nbsp;<span class="ident" id="2528932">Socket</span><span class="op" id="2528938">(</span><span class="ident" id="2528939">AF_PACKET</span><span class="op" id="2528948">,</span>&nbsp;<span class="ident" id="2528950">SOCK_RAW</span><span class="op" id="2528958">,</span>&nbsp;<span class="ident" id="2528960">proto</span><span class="op" id="2528965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528968">if</span>&nbsp;<span class="ident" id="2528971">e</span>&nbsp;<span class="op" id="2528973">!=</span>&nbsp;<span class="ident" id="2528976">nil</span>&nbsp;<span class="op" id="2528980">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528984">return</span>&nbsp;<span class="num" id="2528991">0</span><span class="op" id="2528992">,</span>&nbsp;<span class="ident" id="2528994">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2528997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529000">p</span>&nbsp;<span class="op" id="2529002">:=</span>&nbsp;<span class="op" id="2529005">(</span><span class="op" id="2529006">*</span><span class="op" id="2529007">[</span><span class="num" id="2529008">2</span><span class="op" id="2529009">]</span><span class="builtintype" id="2529010">byte</span><span class="op" id="2529014">)</span><span class="op" id="2529015">(</span><span class="ident" id="2529016">unsafe</span><span class="op" id="2529022">.</span><span class="ident" id="2529023">Pointer</span><span class="op" id="2529030">(</span><span class="op" id="2529031">&amp;</span><span class="ident" id="2529032">lsall</span><span class="op" id="2529037">.</span><span class="ident" id="2529038">Protocol</span><span class="op" id="2529046">)</span><span class="op" id="2529047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529050">p</span><span class="op" id="2529051">[</span><span class="num" id="2529052">0</span><span class="op" id="2529053">]</span>&nbsp;<span class="op" id="2529055">=</span>&nbsp;<span class="builtintype" id="2529057">byte</span><span class="op" id="2529061">(</span><span class="ident" id="2529062">proto</span>&nbsp;<span class="op" id="2529068">&gt;&gt;</span>&nbsp;<span class="num" id="2529071">8</span><span class="op" id="2529072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529075">p</span><span class="op" id="2529076">[</span><span class="num" id="2529077">1</span><span class="op" id="2529078">]</span>&nbsp;<span class="op" id="2529080">=</span>&nbsp;<span class="builtintype" id="2529082">byte</span><span class="op" id="2529086">(</span><span class="ident" id="2529087">proto</span><span class="op" id="2529092">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529095">lsall</span><span class="op" id="2529100">.</span><span class="ident" id="2529101">Ifindex</span>&nbsp;<span class="op" id="2529109">=</span>&nbsp;<span class="ident" id="2529111">ifindex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529120">e</span>&nbsp;<span class="op" id="2529122">=</span>&nbsp;<span class="ident" id="2529124">Bind</span><span class="op" id="2529128">(</span><span class="ident" id="2529129">s</span><span class="op" id="2529130">,</span>&nbsp;<span class="op" id="2529132">&amp;</span><span class="ident" id="2529133">lsall</span><span class="op" id="2529138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529141">if</span>&nbsp;<span class="ident" id="2529144">e</span>&nbsp;<span class="op" id="2529146">!=</span>&nbsp;<span class="ident" id="2529149">nil</span>&nbsp;<span class="op" id="2529153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529157">Close</span><span class="op" id="2529162">(</span><span class="ident" id="2529163">s</span><span class="op" id="2529164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529168">return</span>&nbsp;<span class="num" id="2529175">0</span><span class="op" id="2529176">,</span>&nbsp;<span class="ident" id="2529178">e</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529184">return</span>&nbsp;<span class="ident" id="2529191">s</span><span class="op" id="2529192">,</span>&nbsp;<span class="ident" id="2529194">nil</span><br>
<span class="lineno"></span><span class="op" id="2529198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2529201">type</span>&nbsp;<span class="ident" id="2529206">iflags</span>&nbsp;<span class="keyword" id="2529213">struct</span>&nbsp;<span class="op" id="2529220">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529223">name</span>&nbsp;&nbsp;<span class="op" id="2529229">[</span><span class="ident" id="2529230">IFNAMSIZ</span><span class="op" id="2529238">]</span><span class="builtintype" id="2529239">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529245">flags</span>&nbsp;<span class="builtintype" id="2529251">uint16</span><br>
<span class="lineno"></span><span class="op" id="2529258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2529261">func</span>&nbsp;<span class="ident" id="2529266">SetLsfPromisc</span><span class="op" id="2529279">(</span><span class="ident" id="2529280">name</span>&nbsp;<span class="builtintype" id="2529285">string</span><span class="op" id="2529291">,</span>&nbsp;<span class="ident" id="2529293">m</span>&nbsp;<span class="builtintype" id="2529295">bool</span><span class="op" id="2529299">)</span>&nbsp;<span class="builtintype" id="2529301">error</span>&nbsp;<span class="op" id="2529307">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529310">s</span><span class="op" id="2529311">,</span>&nbsp;<span class="ident" id="2529313">e</span>&nbsp;<span class="op" id="2529315">:=</span>&nbsp;<span class="ident" id="2529318">Socket</span><span class="op" id="2529324">(</span><span class="ident" id="2529325">AF_INET</span><span class="op" id="2529332">,</span>&nbsp;<span class="ident" id="2529334">SOCK_DGRAM</span><span class="op" id="2529344">,</span>&nbsp;<span class="num" id="2529346">0</span><span class="op" id="2529347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529350">if</span>&nbsp;<span class="ident" id="2529353">e</span>&nbsp;<span class="op" id="2529355">!=</span>&nbsp;<span class="ident" id="2529358">nil</span>&nbsp;<span class="op" id="2529362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529366">return</span>&nbsp;<span class="ident" id="2529373">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529379">defer</span>&nbsp;<span class="ident" id="2529385">Close</span><span class="op" id="2529390">(</span><span class="ident" id="2529391">s</span><span class="op" id="2529392">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529395">var</span>&nbsp;<span class="ident" id="2529399">ifl</span>&nbsp;<span class="ident" id="2529403">iflags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2529411">copy</span><span class="op" id="2529415">(</span><span class="ident" id="2529416">ifl</span><span class="op" id="2529419">.</span><span class="ident" id="2529420">name</span><span class="op" id="2529424">[</span><span class="op" id="2529425">:</span><span class="op" id="2529426">]</span><span class="op" id="2529427">,</span>&nbsp;<span class="op" id="2529429">[</span><span class="op" id="2529430">]</span><span class="builtintype" id="2529431">byte</span><span class="op" id="2529435">(</span><span class="ident" id="2529436">name</span><span class="op" id="2529440">)</span><span class="op" id="2529441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529444">_</span><span class="op" id="2529445">,</span>&nbsp;<span class="ident" id="2529447">_</span><span class="op" id="2529448">,</span>&nbsp;<span class="ident" id="2529450">ep</span>&nbsp;<span class="op" id="2529453">:=</span>&nbsp;<span class="ident" id="2529456">Syscall</span><span class="op" id="2529463">(</span><span class="ident" id="2529464">SYS_IOCTL</span><span class="op" id="2529473">,</span>&nbsp;<span class="builtintype" id="2529475">uintptr</span><span class="op" id="2529482">(</span><span class="ident" id="2529483">s</span><span class="op" id="2529484">)</span><span class="op" id="2529485">,</span>&nbsp;<span class="ident" id="2529487">SIOCGIFFLAGS</span><span class="op" id="2529499">,</span>&nbsp;<span class="builtintype" id="2529501">uintptr</span><span class="op" id="2529508">(</span><span class="ident" id="2529509">unsafe</span><span class="op" id="2529515">.</span><span class="ident" id="2529516">Pointer</span><span class="op" id="2529523">(</span><span class="op" id="2529524">&amp;</span><span class="ident" id="2529525">ifl</span><span class="op" id="2529528">)</span><span class="op" id="2529529">)</span><span class="op" id="2529530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529533">if</span>&nbsp;<span class="ident" id="2529536">ep</span>&nbsp;<span class="op" id="2529539">!=</span>&nbsp;<span class="num" id="2529542">0</span>&nbsp;<span class="op" id="2529544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529548">return</span>&nbsp;<span class="ident" id="2529555">Errno</span><span class="op" id="2529560">(</span><span class="ident" id="2529561">ep</span><span class="op" id="2529563">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529569">if</span>&nbsp;<span class="ident" id="2529572">m</span>&nbsp;<span class="op" id="2529574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529578">ifl</span><span class="op" id="2529581">.</span><span class="ident" id="2529582">flags</span>&nbsp;<span class="op" id="2529588">|=</span>&nbsp;<span class="builtintype" id="2529591">uint16</span><span class="op" id="2529597">(</span><span class="ident" id="2529598">IFF_PROMISC</span><span class="op" id="2529609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529612">}</span>&nbsp;<span class="keyword" id="2529614">else</span>&nbsp;<span class="op" id="2529619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529623">ifl</span><span class="op" id="2529626">.</span><span class="ident" id="2529627">flags</span>&nbsp;<span class="op" id="2529633">&amp;=</span>&nbsp;<span class="op" id="2529636">^</span><span class="builtintype" id="2529637">uint16</span><span class="op" id="2529643">(</span><span class="ident" id="2529644">IFF_PROMISC</span><span class="op" id="2529655">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529661">_</span><span class="op" id="2529662">,</span>&nbsp;<span class="ident" id="2529664">_</span><span class="op" id="2529665">,</span>&nbsp;<span class="ident" id="2529667">ep</span>&nbsp;<span class="op" id="2529670">=</span>&nbsp;<span class="ident" id="2529672">Syscall</span><span class="op" id="2529679">(</span><span class="ident" id="2529680">SYS_IOCTL</span><span class="op" id="2529689">,</span>&nbsp;<span class="builtintype" id="2529691">uintptr</span><span class="op" id="2529698">(</span><span class="ident" id="2529699">s</span><span class="op" id="2529700">)</span><span class="op" id="2529701">,</span>&nbsp;<span class="ident" id="2529703">SIOCSIFFLAGS</span><span class="op" id="2529715">,</span>&nbsp;<span class="builtintype" id="2529717">uintptr</span><span class="op" id="2529724">(</span><span class="ident" id="2529725">unsafe</span><span class="op" id="2529731">.</span><span class="ident" id="2529732">Pointer</span><span class="op" id="2529739">(</span><span class="op" id="2529740">&amp;</span><span class="ident" id="2529741">ifl</span><span class="op" id="2529744">)</span><span class="op" id="2529745">)</span><span class="op" id="2529746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529749">if</span>&nbsp;<span class="ident" id="2529752">ep</span>&nbsp;<span class="op" id="2529755">!=</span>&nbsp;<span class="num" id="2529758">0</span>&nbsp;<span class="op" id="2529760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529764">return</span>&nbsp;<span class="ident" id="2529771">Errno</span><span class="op" id="2529776">(</span><span class="ident" id="2529777">ep</span><span class="op" id="2529779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529782">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529785">return</span>&nbsp;<span class="ident" id="2529792">nil</span><br>
<span class="lineno"></span><span class="op" id="2529796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2529799">func</span>&nbsp;<span class="ident" id="2529804">AttachLsf</span><span class="op" id="2529813">(</span><span class="ident" id="2529814">fd</span>&nbsp;<span class="builtintype" id="2529817">int</span><span class="op" id="2529820">,</span>&nbsp;<span class="ident" id="2529822">i</span>&nbsp;<span class="op" id="2529824">[</span><span class="op" id="2529825">]</span><span class="ident" id="2529826">SockFilter</span><span class="op" id="2529836">)</span>&nbsp;<span class="builtintype" id="2529838">error</span>&nbsp;<span class="op" id="2529844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529847">var</span>&nbsp;<span class="ident" id="2529851">p</span>&nbsp;<span class="ident" id="2529853">SockFprog</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529864">p</span><span class="op" id="2529865">.</span><span class="ident" id="2529866">Len</span>&nbsp;<span class="op" id="2529870">=</span>&nbsp;<span class="builtintype" id="2529872">uint16</span><span class="op" id="2529878">(</span><span class="builtinfunc" id="2529879">len</span><span class="op" id="2529882">(</span><span class="ident" id="2529883">i</span><span class="op" id="2529884">)</span><span class="op" id="2529885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529888">p</span><span class="op" id="2529889">.</span><span class="ident" id="2529890">Filter</span>&nbsp;<span class="op" id="2529897">=</span>&nbsp;<span class="op" id="2529899">(</span><span class="op" id="2529900">*</span><span class="ident" id="2529901">SockFilter</span><span class="op" id="2529911">)</span><span class="op" id="2529912">(</span><span class="ident" id="2529913">unsafe</span><span class="op" id="2529919">.</span><span class="ident" id="2529920">Pointer</span><span class="op" id="2529927">(</span><span class="op" id="2529928">&amp;</span><span class="ident" id="2529929">i</span><span class="op" id="2529930">[</span><span class="num" id="2529931">0</span><span class="op" id="2529932">]</span><span class="op" id="2529933">)</span><span class="op" id="2529934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529937">return</span>&nbsp;<span class="ident" id="2529944">setsockopt</span><span class="op" id="2529954">(</span><span class="ident" id="2529955">fd</span><span class="op" id="2529957">,</span>&nbsp;<span class="ident" id="2529959">SOL_SOCKET</span><span class="op" id="2529969">,</span>&nbsp;<span class="ident" id="2529971">SO_ATTACH_FILTER</span><span class="op" id="2529987">,</span>&nbsp;<span class="ident" id="2529989">unsafe</span><span class="op" id="2529995">.</span><span class="ident" id="2529996">Pointer</span><span class="op" id="2530003">(</span><span class="op" id="2530004">&amp;</span><span class="ident" id="2530005">p</span><span class="op" id="2530006">)</span><span class="op" id="2530007">,</span>&nbsp;<span class="ident" id="2530009">unsafe</span><span class="op" id="2530015">.</span><span class="ident" id="2530016">Sizeof</span><span class="op" id="2530022">(</span><span class="ident" id="2530023">p</span><span class="op" id="2530024">)</span><span class="op" id="2530025">)</span><br>
<span class="lineno"></span><span class="op" id="2530027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="2530030">func</span>&nbsp;<span class="ident" id="2530035">DetachLsf</span><span class="op" id="2530044">(</span><span class="ident" id="2530045">fd</span>&nbsp;<span class="builtintype" id="2530048">int</span><span class="op" id="2530051">)</span>&nbsp;<span class="builtintype" id="2530053">error</span>&nbsp;<span class="op" id="2530059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530062">var</span>&nbsp;<span class="ident" id="2530066">dummy</span>&nbsp;<span class="builtintype" id="2530072">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530077">return</span>&nbsp;<span class="ident" id="2530084">setsockopt</span><span class="op" id="2530094">(</span><span class="ident" id="2530095">fd</span><span class="op" id="2530097">,</span>&nbsp;<span class="ident" id="2530099">SOL_SOCKET</span><span class="op" id="2530109">,</span>&nbsp;<span class="ident" id="2530111">SO_DETACH_FILTER</span><span class="op" id="2530127">,</span>&nbsp;<span class="ident" id="2530129">unsafe</span><span class="op" id="2530135">.</span><span class="ident" id="2530136">Pointer</span><span class="op" id="2530143">(</span><span class="op" id="2530144">&amp;</span><span class="ident" id="2530145">dummy</span><span class="op" id="2530150">)</span><span class="op" id="2530151">,</span>&nbsp;<span class="ident" id="2530153">unsafe</span><span class="op" id="2530159">.</span><span class="ident" id="2530160">Sizeof</span><span class="op" id="2530166">(</span><span class="ident" id="2530167">dummy</span><span class="op" id="2530172">)</span><span class="op" id="2530173">)</span><br>
<span class="lineno"></span><span class="op" id="2530175">}</span>
</div>
</body>
</html>
