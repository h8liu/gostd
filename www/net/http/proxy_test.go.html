<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7048177">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7048232">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7048286">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7048337">package</span>&nbsp;<span class="ident" id="7048345">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7048351">import</span>&nbsp;<span class="op" id="7048358">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7048361">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7048372">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7048378">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7048388">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7048391">//&nbsp;TODO(mattn):</span><br>
<span class="lineno"></span><span class="comment" id="7048407">//&nbsp;&nbsp;&nbsp;&nbsptest&nbsp;ProxyAuth</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7048426">var</span>&nbsp;<span class="ident" id="7048430">UseProxyTests</span>&nbsp;<span class="op" id="7048444">=</span>&nbsp;<span class="op" id="7048446">[</span><span class="op" id="7048447">]</span><span class="keyword" id="7048448">struct</span>&nbsp;<span class="op" id="7048455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7048458">host</span>&nbsp;&nbsp;<span class="builtintype" id="7048464">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7048472">match</span>&nbsp;<span class="builtintype" id="7048478">bool</span><br>
<span class="lineno"></span><span class="op" id="7048483">}</span><span class="op" id="7048484">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7048487">//&nbsp;Never&nbsp;proxy&nbsp;localhost:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7048514">{</span><span class="string" id="7048515">&#34;localhost:80&#34;</span><span class="op" id="7048529">,</span>&nbsp;<span class="builtintype" id="7048531">false</span><span class="op" id="7048536">}</span><span class="op" id="7048537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7048540">{</span><span class="string" id="7048541">&#34;127.0.0.1&#34;</span><span class="op" id="7048552">,</span>&nbsp;<span class="builtintype" id="7048554">false</span><span class="op" id="7048559">}</span><span class="op" id="7048560">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7048563">{</span><span class="string" id="7048564">&#34;127.0.0.2&#34;</span><span class="op" id="7048575">,</span>&nbsp;<span class="builtintype" id="7048577">false</span><span class="op" id="7048582">}</span><span class="op" id="7048583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7048586">{</span><span class="string" id="7048587">&#34;[::1]&#34;</span><span class="op" id="7048594">,</span>&nbsp;<span class="builtintype" id="7048596">false</span><span class="op" id="7048601">}</span><span class="op" id="7048602">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7048605">{</span><span class="string" id="7048606">&#34;[::2]&#34;</span><span class="op" id="7048613">,</span>&nbsp;<span class="builtintype" id="7048615">true</span><span class="op" id="7048619">}</span><span class="op" id="7048620">,</span>&nbsp;<span class="comment" id="7048622">//&nbsp;not&nbsp;a&nbsp;loopback&nbsp;address</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7048650">{</span><span class="string" id="7048651">&#34;barbaz.net&#34;</span><span class="op" id="7048663">,</span>&nbsp;<span class="builtintype" id="7048665">false</span><span class="op" id="7048670">}</span><span class="op" id="7048671">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7048677">//&nbsp;match&nbsp;as&nbsp;.barbaz.net</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7048702">{</span><span class="string" id="7048703">&#34;foobar.com&#34;</span><span class="op" id="7048715">,</span>&nbsp;<span class="builtintype" id="7048717">false</span><span class="op" id="7048722">}</span><span class="op" id="7048723">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7048729">//&nbsp;have&nbsp;a&nbsp;port&nbsp;but&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7048755">{</span><span class="string" id="7048756">&#34;foofoobar.com&#34;</span><span class="op" id="7048771">,</span>&nbsp;<span class="builtintype" id="7048773">true</span><span class="op" id="7048777">}</span><span class="op" id="7048778">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="7048782">//&nbsp;not&nbsp;match&nbsp;as&nbsp;a&nbsp;part&nbsp;of&nbsp;foobar.com</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7048820">{</span><span class="string" id="7048821">&#34;baz.com&#34;</span><span class="op" id="7048830">,</span>&nbsp;<span class="builtintype" id="7048832">true</span><span class="op" id="7048836">}</span><span class="op" id="7048837">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7048847">//&nbsp;not&nbsp;match&nbsp;as&nbsp;a&nbsp;part&nbsp;of&nbsp;barbaz.com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7048885">{</span><span class="string" id="7048886">&#34;localhost.net&#34;</span><span class="op" id="7048901">,</span>&nbsp;<span class="builtintype" id="7048903">true</span><span class="op" id="7048907">}</span><span class="op" id="7048908">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="7048912">//&nbsp;not&nbsp;match&nbsp;as&nbsp;suffix&nbsp;of&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7048947">{</span><span class="string" id="7048948">&#34;local.localhost&#34;</span><span class="op" id="7048965">,</span>&nbsp;<span class="builtintype" id="7048967">true</span><span class="op" id="7048971">}</span><span class="op" id="7048972">,</span>&nbsp;<span class="comment" id="7048974">//&nbsp;not&nbsp;match&nbsp;as&nbsp;prefix&nbsp;as&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7049009">{</span><span class="string" id="7049010">&#34;barbarbaz.net&#34;</span><span class="op" id="7049025">,</span>&nbsp;<span class="builtintype" id="7049027">true</span><span class="op" id="7049031">}</span><span class="op" id="7049032">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="7049036">//&nbsp;not&nbsp;match&nbsp;because&nbsp;NO_PROXY&nbsp;have&nbsp;a&nbsp;&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7049078">{</span><span class="string" id="7049079">&#34;www.foobar.com&#34;</span><span class="op" id="7049095">,</span>&nbsp;<span class="builtintype" id="7049097">false</span><span class="op" id="7049102">}</span><span class="op" id="7049103">,</span>&nbsp;<span class="comment" id="7049105">//&nbsp;match&nbsp;because&nbsp;NO_PROXY&nbsp;includes&nbsp;&#34;foobar.com&#34;</span><br>
<span class="lineno">35</span><span class="op" id="7049153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7049156">func</span>&nbsp;<span class="ident" id="7049161">TestUseProxy</span><span class="op" id="7049173">(</span><span class="ident" id="7049174">t</span>&nbsp;<span class="op" id="7049176">*</span><span class="ident" id="7049177"><a href="/net/http/proxy_test.go.html#7048378">testing</a></span><span class="op" id="7049184">.</span><span class="ident" id="7049185">T</span><span class="op" id="7049186">)</span>&nbsp;<span class="op" id="7049188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7049191"><a href="/net/http/proxy_test.go.html#7050165">ResetProxyEnv</a></span><span class="op" id="7049204">(</span><span class="op" id="7049205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7049208"><a href="/net/http/proxy_test.go.html#7048372">os</a></span><span class="op" id="7049210">.</span><span class="ident" id="7049211">Setenv</span><span class="op" id="7049217">(</span><span class="string" id="7049218">&#34;NO_PROXY&#34;</span><span class="op" id="7049228">,</span>&nbsp;<span class="string" id="7049230">&#34;foobar.com,&nbsp;.barbaz.net&#34;</span><span class="op" id="7049255">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7049258">for</span>&nbsp;<span class="ident" id="7049262">_</span><span class="op" id="7049263">,</span>&nbsp;<span class="ident" id="7049265">test</span>&nbsp;<span class="op" id="7049270">:=</span>&nbsp;<span class="keyword" id="7049273">range</span>&nbsp;<span class="ident" id="7049279"><a href="/net/http/proxy_test.go.html#7048430">UseProxyTests</a></span>&nbsp;<span class="op" id="7049293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7049297">if</span>&nbsp;<span class="ident" id="7049300"><a href="/net/http/transport.go.html#3508060">useProxy</a></span><span class="op" id="7049308">(</span><span class="ident" id="7049309"><a href="/net/http/proxy_test.go.html#7049265">test</a></span><span class="op" id="7049313">.</span><span class="ident" id="7049314">host</span><span class="op" id="7049318">+</span><span class="string" id="7049319">&#34;:80&#34;</span><span class="op" id="7049324">)</span>&nbsp;<span class="op" id="7049326">!=</span>&nbsp;<span class="ident" id="7049329"><a href="/net/http/proxy_test.go.html#7049265">test</a></span><span class="op" id="7049333">.</span><span class="ident" id="7049334">match</span>&nbsp;<span class="op" id="7049340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7049345"><a href="/net/http/proxy_test.go.html#7049174">t</a></span><span class="op" id="7049346">.</span><span class="ident" id="7049347">Errorf</span><span class="op" id="7049353">(</span><span class="string" id="7049354">&#34;useProxy(%v)&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7049382">,</span>&nbsp;<span class="ident" id="7049384"><a href="/net/http/proxy_test.go.html#7049265">test</a></span><span class="op" id="7049388">.</span><span class="ident" id="7049389">host</span><span class="op" id="7049393">,</span>&nbsp;<span class="op" id="7049395">!</span><span class="ident" id="7049396"><a href="/net/http/proxy_test.go.html#7049265">test</a></span><span class="op" id="7049400">.</span><span class="ident" id="7049401">match</span><span class="op" id="7049406">,</span>&nbsp;<span class="ident" id="7049408"><a href="/net/http/proxy_test.go.html#7049265">test</a></span><span class="op" id="7049412">.</span><span class="ident" id="7049413">match</span><span class="op" id="7049418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7049422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7049425">}</span><br>
<span class="lineno">45</span><span class="op" id="7049427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7049430">var</span>&nbsp;<span class="ident" id="7049434">cacheKeysTests</span>&nbsp;<span class="op" id="7049449">=</span>&nbsp;<span class="op" id="7049451">[</span><span class="op" id="7049452">]</span><span class="keyword" id="7049453">struct</span>&nbsp;<span class="op" id="7049460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7049463">proxy</span>&nbsp;&nbsp;<span class="builtintype" id="7049470">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7049478">scheme</span>&nbsp;<span class="builtintype" id="7049485">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7049493">addr</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7049500">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7049508">key</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7049515">string</span><br>
<span class="lineno"></span><span class="op" id="7049522">}</span><span class="op" id="7049523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7049526">{</span><span class="string" id="7049527">&#34;&#34;</span><span class="op" id="7049529">,</span>&nbsp;<span class="string" id="7049531">&#34;http&#34;</span><span class="op" id="7049537">,</span>&nbsp;<span class="string" id="7049539">&#34;foo.com&#34;</span><span class="op" id="7049548">,</span>&nbsp;<span class="string" id="7049550">&#34;|http|foo.com&#34;</span><span class="op" id="7049565">}</span><span class="op" id="7049566">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7049569">{</span><span class="string" id="7049570">&#34;&#34;</span><span class="op" id="7049572">,</span>&nbsp;<span class="string" id="7049574">&#34;https&#34;</span><span class="op" id="7049581">,</span>&nbsp;<span class="string" id="7049583">&#34;foo.com&#34;</span><span class="op" id="7049592">,</span>&nbsp;<span class="string" id="7049594">&#34;|https|foo.com&#34;</span><span class="op" id="7049610">}</span><span class="op" id="7049611">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7049614">{</span><span class="string" id="7049615">&#34;http://foo.com&#34;</span><span class="op" id="7049631">,</span>&nbsp;<span class="string" id="7049633">&#34;http&#34;</span><span class="op" id="7049639">,</span>&nbsp;<span class="string" id="7049641">&#34;foo.com&#34;</span><span class="op" id="7049650">,</span>&nbsp;<span class="string" id="7049652">&#34;http://foo.com|http|&#34;</span><span class="op" id="7049674">}</span><span class="op" id="7049675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7049678">{</span><span class="string" id="7049679">&#34;http://foo.com&#34;</span><span class="op" id="7049695">,</span>&nbsp;<span class="string" id="7049697">&#34;https&#34;</span><span class="op" id="7049704">,</span>&nbsp;<span class="string" id="7049706">&#34;foo.com&#34;</span><span class="op" id="7049715">,</span>&nbsp;<span class="string" id="7049717">&#34;http://foo.com|https|foo.com&#34;</span><span class="op" id="7049747">}</span><span class="op" id="7049748">,</span><br>
<span class="lineno"></span><span class="op" id="7049750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7049753">func</span>&nbsp;<span class="ident" id="7049758">TestCacheKeys</span><span class="op" id="7049771">(</span><span class="ident" id="7049772">t</span>&nbsp;<span class="op" id="7049774">*</span><span class="ident" id="7049775"><a href="/net/http/proxy_test.go.html#7048378">testing</a></span><span class="op" id="7049782">.</span><span class="ident" id="7049783">T</span><span class="op" id="7049784">)</span>&nbsp;<span class="op" id="7049786">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7049789">for</span>&nbsp;<span class="ident" id="7049793">_</span><span class="op" id="7049794">,</span>&nbsp;<span class="ident" id="7049796">tt</span>&nbsp;<span class="op" id="7049799">:=</span>&nbsp;<span class="keyword" id="7049802">range</span>&nbsp;<span class="ident" id="7049808"><a href="/net/http/proxy_test.go.html#7049434">cacheKeysTests</a></span>&nbsp;<span class="op" id="7049823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7049827">var</span>&nbsp;<span class="ident" id="7049831">proxy</span>&nbsp;<span class="op" id="7049837">*</span><span class="ident" id="7049838"><a href="/net/http/proxy_test.go.html#7048361">url</a></span><span class="op" id="7049841">.</span><span class="ident" id="7049842">URL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7049848">if</span>&nbsp;<span class="ident" id="7049851"><a href="/net/http/proxy_test.go.html#7049796">tt</a></span><span class="op" id="7049853">.</span><span class="ident" id="7049854">proxy</span>&nbsp;<span class="op" id="7049860">!=</span>&nbsp;<span class="string" id="7049863">&#34;&#34;</span>&nbsp;<span class="op" id="7049866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7049871">u</span><span class="op" id="7049872">,</span>&nbsp;<span class="ident" id="7049874">err</span>&nbsp;<span class="op" id="7049878">:=</span>&nbsp;<span class="ident" id="7049881"><a href="/net/http/proxy_test.go.html#7048361">url</a></span><span class="op" id="7049884">.</span><span class="ident" id="7049885">Parse</span><span class="op" id="7049890">(</span><span class="ident" id="7049891"><a href="/net/http/proxy_test.go.html#7049796">tt</a></span><span class="op" id="7049893">.</span><span class="ident" id="7049894">proxy</span><span class="op" id="7049899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7049904">if</span>&nbsp;<span class="ident" id="7049907"><a href="/net/http/proxy_test.go.html#7049874">err</a></span>&nbsp;<span class="op" id="7049911">!=</span>&nbsp;<span class="ident" id="7049914">nil</span>&nbsp;<span class="op" id="7049918">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7049924"><a href="/net/http/proxy_test.go.html#7049772">t</a></span><span class="op" id="7049925">.</span><span class="ident" id="7049926">Fatal</span><span class="op" id="7049931">(</span><span class="ident" id="7049932"><a href="/net/http/proxy_test.go.html#7049874">err</a></span><span class="op" id="7049935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7049940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7049945"><a href="/net/http/proxy_test.go.html#7049831">proxy</a></span>&nbsp;<span class="op" id="7049951">=</span>&nbsp;<span class="ident" id="7049953"><a href="/net/http/proxy_test.go.html#7049871">u</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7049957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7049961">cm</span>&nbsp;<span class="op" id="7049964">:=</span>&nbsp;<span class="ident" id="7049967"><a href="/net/http/transport.go.html#3509705">connectMethod</a></span><span class="op" id="7049980">{</span><span class="ident" id="7049981"><a href="/net/http/proxy_test.go.html#7049831">proxy</a></span><span class="op" id="7049986">,</span>&nbsp;<span class="ident" id="7049988"><a href="/net/http/proxy_test.go.html#7049796">tt</a></span><span class="op" id="7049990">.</span><span class="ident" id="7049991">scheme</span><span class="op" id="7049997">,</span>&nbsp;<span class="ident" id="7049999"><a href="/net/http/proxy_test.go.html#7049796">tt</a></span><span class="op" id="7050001">.</span><span class="ident" id="7050002">addr</span><span class="op" id="7050006">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7050010">if</span>&nbsp;<span class="ident" id="7050013">got</span>&nbsp;<span class="op" id="7050017">:=</span>&nbsp;<span class="ident" id="7050020"><a href="/net/http/proxy_test.go.html#7049961">cm</a></span><span class="op" id="7050022">.</span><span class="ident" id="7050023">key</span><span class="op" id="7050026">(</span><span class="op" id="7050027">)</span><span class="op" id="7050028">.</span><span class="ident" id="7050029">String</span><span class="op" id="7050035">(</span><span class="op" id="7050036">)</span><span class="op" id="7050037">;</span>&nbsp;<span class="ident" id="7050039"><a href="/net/http/proxy_test.go.html#7050013">got</a></span>&nbsp;<span class="op" id="7050043">!=</span>&nbsp;<span class="ident" id="7050046"><a href="/net/http/proxy_test.go.html#7049796">tt</a></span><span class="op" id="7050048">.</span><span class="ident" id="7050049">key</span>&nbsp;<span class="op" id="7050053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7050058"><a href="/net/http/proxy_test.go.html#7049772">t</a></span><span class="op" id="7050059">.</span><span class="ident" id="7050060">Fatalf</span><span class="op" id="7050066">(</span><span class="string" id="7050067">&#34;{%q,&nbsp;%q,&nbsp;%q}&nbsp;cache&nbsp;key&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7050105">,</span>&nbsp;<span class="ident" id="7050107"><a href="/net/http/proxy_test.go.html#7049796">tt</a></span><span class="op" id="7050109">.</span><span class="ident" id="7050110">proxy</span><span class="op" id="7050115">,</span>&nbsp;<span class="ident" id="7050117"><a href="/net/http/proxy_test.go.html#7049796">tt</a></span><span class="op" id="7050119">.</span><span class="ident" id="7050120">scheme</span><span class="op" id="7050126">,</span>&nbsp;<span class="ident" id="7050128"><a href="/net/http/proxy_test.go.html#7049796">tt</a></span><span class="op" id="7050130">.</span><span class="ident" id="7050131">addr</span><span class="op" id="7050135">,</span>&nbsp;<span class="ident" id="7050137"><a href="/net/http/proxy_test.go.html#7050013">got</a></span><span class="op" id="7050140">,</span>&nbsp;<span class="ident" id="7050142"><a href="/net/http/proxy_test.go.html#7049796">tt</a></span><span class="op" id="7050144">.</span><span class="ident" id="7050145">key</span><span class="op" id="7050148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7050152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7050155">}</span><br>
<span class="lineno"></span><span class="op" id="7050157">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="7050160">func</span>&nbsp;<span class="ident" id="7050165">ResetProxyEnv</span><span class="op" id="7050178">(</span><span class="op" id="7050179">)</span>&nbsp;<span class="op" id="7050181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7050184">for</span>&nbsp;<span class="ident" id="7050188">_</span><span class="op" id="7050189">,</span>&nbsp;<span class="ident" id="7050191">v</span>&nbsp;<span class="op" id="7050193">:=</span>&nbsp;<span class="keyword" id="7050196">range</span>&nbsp;<span class="op" id="7050202">[</span><span class="op" id="7050203">]</span><span class="builtintype" id="7050204">string</span><span class="op" id="7050210">{</span><span class="string" id="7050211">&#34;HTTP_PROXY&#34;</span><span class="op" id="7050223">,</span>&nbsp;<span class="string" id="7050225">&#34;http_proxy&#34;</span><span class="op" id="7050237">,</span>&nbsp;<span class="string" id="7050239">&#34;NO_PROXY&#34;</span><span class="op" id="7050249">,</span>&nbsp;<span class="string" id="7050251">&#34;no_proxy&#34;</span><span class="op" id="7050261">}</span>&nbsp;<span class="op" id="7050263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7050267"><a href="/net/http/proxy_test.go.html#7048372">os</a></span><span class="op" id="7050269">.</span><span class="ident" id="7050270">Setenv</span><span class="op" id="7050276">(</span><span class="ident" id="7050277"><a href="/net/http/proxy_test.go.html#7050191">v</a></span><span class="op" id="7050278">,</span>&nbsp;<span class="string" id="7050280">&#34;&#34;</span><span class="op" id="7050282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7050285">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7050288"><a href="/net/http/export_test.go.html#7040463">ResetCachedEnvironment</a></span><span class="op" id="7050310">(</span><span class="op" id="7050311">)</span><br>
<span class="lineno"></span><span class="op" id="7050313">}</span>
</div>
</body>
</html>
