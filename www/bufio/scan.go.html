<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3110167">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3110222">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3110276">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3110327">package</span>&nbsp;<span class="ident" id="3110335">bufio</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3110342">import</span>&nbsp;<span class="op" id="3110349">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3110352">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3110361">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3110371">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3110377">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3110392">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3110395">//&nbsp;Scanner&nbsp;provides&nbsp;a&nbsp;convenient&nbsp;interface&nbsp;for&nbsp;reading&nbsp;data&nbsp;such&nbsp;as</span><br>
<span class="lineno">15</span><span class="comment" id="3110463">//&nbsp;a&nbsp;file&nbsp;of&nbsp;newline-delimited&nbsp;lines&nbsp;of&nbsp;text.&nbsp;Successive&nbsp;calls&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3110529">//&nbsp;the&nbsp;Scan&nbsp;method&nbsp;will&nbsp;step&nbsp;through&nbsp;the&nbsp;&#39;tokens&#39;&nbsp;of&nbsp;a&nbsp;file,&nbsp;skipping</span><br>
<span class="lineno"></span><span class="comment" id="3110599">//&nbsp;the&nbsp;bytes&nbsp;between&nbsp;the&nbsp;tokens.&nbsp;The&nbsp;specification&nbsp;of&nbsp;a&nbsp;token&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3110664">//&nbsp;defined&nbsp;by&nbsp;a&nbsp;split&nbsp;function&nbsp;of&nbsp;type&nbsp;SplitFunc;&nbsp;the&nbsp;default&nbsp;split</span><br>
<span class="lineno"></span><span class="comment" id="3110732">//&nbsp;function&nbsp;breaks&nbsp;the&nbsp;input&nbsp;into&nbsp;lines&nbsp;with&nbsp;line&nbsp;termination&nbsp;stripped.&nbsp;Split</span><br>
<span class="lineno">20</span><span class="comment" id="3110810">//&nbsp;functions&nbsp;are&nbsp;defined&nbsp;in&nbsp;this&nbsp;package&nbsp;for&nbsp;scanning&nbsp;a&nbsp;file&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="3110876">//&nbsp;lines,&nbsp;bytes,&nbsp;UTF-8-encoded&nbsp;runes,&nbsp;and&nbsp;space-delimited&nbsp;words.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="3110945">//&nbsp;client&nbsp;may&nbsp;instead&nbsp;provide&nbsp;a&nbsp;custom&nbsp;split&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="3111000">//</span><br>
<span class="lineno"></span><span class="comment" id="3111003">//&nbsp;Scanning&nbsp;stops&nbsp;unrecoverably&nbsp;at&nbsp;EOF,&nbsp;the&nbsp;first&nbsp;I/O&nbsp;error,&nbsp;or&nbsp;a&nbsp;token&nbsp;too</span><br>
<span class="lineno">25</span><span class="comment" id="3111079">//&nbsp;large&nbsp;to&nbsp;fit&nbsp;in&nbsp;the&nbsp;buffer.&nbsp;When&nbsp;a&nbsp;scan&nbsp;stops,&nbsp;the&nbsp;reader&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="3111149">//&nbsp;advanced&nbsp;arbitrarily&nbsp;far&nbsp;past&nbsp;the&nbsp;last&nbsp;token.&nbsp;Programs&nbsp;that&nbsp;need&nbsp;more</span><br>
<span class="lineno"></span><span class="comment" id="3111222">//&nbsp;control&nbsp;over&nbsp;error&nbsp;handling&nbsp;or&nbsp;large&nbsp;tokens,&nbsp;or&nbsp;must&nbsp;run&nbsp;sequential&nbsp;scans</span><br>
<span class="lineno"></span><span class="comment" id="3111299">//&nbsp;on&nbsp;a&nbsp;reader,&nbsp;should&nbsp;use&nbsp;bufio.Reader&nbsp;instead.</span><br>
<span class="lineno"></span><span class="comment" id="3111348">//</span><br>
<span class="lineno">30</span><span class="keyword" id="3111351">type</span>&nbsp;<span class="ident" id="3111356">Scanner</span>&nbsp;<span class="keyword" id="3111364">struct</span>&nbsp;<span class="op" id="3111371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3111374">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3111387">io</span><span class="op" id="3111389">.</span><span class="ident" id="3111390">Reader</span>&nbsp;<span class="comment" id="3111397">//&nbsp;The&nbsp;reader&nbsp;provided&nbsp;by&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3111436">split</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3111449">SplitFunc</span>&nbsp;<span class="comment" id="3111459">//&nbsp;The&nbsp;function&nbsp;to&nbsp;split&nbsp;the&nbsp;tokens.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3111497">maxTokenSize</span>&nbsp;<span class="builtintype" id="3111510">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3111520">//&nbsp;Maximum&nbsp;size&nbsp;of&nbsp;a&nbsp;token;&nbsp;modified&nbsp;by&nbsp;tests.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3111568">token</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3111581">[</span><span class="op" id="3111582">]</span><span class="builtintype" id="3111583">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3111591">//&nbsp;Last&nbsp;token&nbsp;returned&nbsp;by&nbsp;split.</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3111625">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3111638">[</span><span class="op" id="3111639">]</span><span class="builtintype" id="3111640">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3111648">//&nbsp;Buffer&nbsp;used&nbsp;as&nbsp;argument&nbsp;to&nbsp;split.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3111686">start</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3111699">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3111709">//&nbsp;First&nbsp;non-processed&nbsp;byte&nbsp;in&nbsp;buf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3111746">end</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3111759">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3111769">//&nbsp;End&nbsp;of&nbsp;data&nbsp;in&nbsp;buf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3111793">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3111806">error</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3111816">//&nbsp;Sticky&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3111834">empties</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3111847">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3111857">//&nbsp;Count&nbsp;of&nbsp;successive&nbsp;empty&nbsp;tokens.</span><br>
<span class="lineno">40</span><span class="op" id="3111894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3111897">//&nbsp;SplitFunc&nbsp;is&nbsp;the&nbsp;signature&nbsp;of&nbsp;the&nbsp;split&nbsp;function&nbsp;used&nbsp;to&nbsp;tokenize&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3111970">//&nbsp;input.&nbsp;The&nbsp;arguments&nbsp;are&nbsp;an&nbsp;initial&nbsp;substring&nbsp;of&nbsp;the&nbsp;remaining&nbsp;unprocessed</span><br>
<span class="lineno"></span><span class="comment" id="3112048">//&nbsp;data&nbsp;and&nbsp;a&nbsp;flag,&nbsp;atEOF,&nbsp;that&nbsp;reports&nbsp;whether&nbsp;the&nbsp;Reader&nbsp;has&nbsp;no&nbsp;more&nbsp;data</span><br>
<span class="lineno">45</span><span class="comment" id="3112124">//&nbsp;to&nbsp;give.&nbsp;The&nbsp;return&nbsp;values&nbsp;are&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;to&nbsp;advance&nbsp;the&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="3112199">//&nbsp;and&nbsp;the&nbsp;next&nbsp;token&nbsp;to&nbsp;return&nbsp;to&nbsp;the&nbsp;user,&nbsp;plus&nbsp;an&nbsp;error,&nbsp;if&nbsp;any.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3112274">//&nbsp;data&nbsp;does&nbsp;not&nbsp;yet&nbsp;hold&nbsp;a&nbsp;complete&nbsp;token,&nbsp;for&nbsp;instance&nbsp;if&nbsp;it&nbsp;has&nbsp;no&nbsp;newline</span><br>
<span class="lineno"></span><span class="comment" id="3112352">//&nbsp;while&nbsp;scanning&nbsp;lines,&nbsp;SplitFunc&nbsp;can&nbsp;return&nbsp;(0,&nbsp;nil,&nbsp;nil)&nbsp;to&nbsp;signal&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3112426">//&nbsp;Scanner&nbsp;to&nbsp;read&nbsp;more&nbsp;data&nbsp;into&nbsp;the&nbsp;slice&nbsp;and&nbsp;try&nbsp;again&nbsp;with&nbsp;a&nbsp;longer&nbsp;slice</span><br>
<span class="lineno">50</span><span class="comment" id="3112504">//&nbsp;starting&nbsp;at&nbsp;the&nbsp;same&nbsp;point&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="3112548">//</span><br>
<span class="lineno"></span><span class="comment" id="3112551">//&nbsp;If&nbsp;the&nbsp;returned&nbsp;error&nbsp;is&nbsp;non-nil,&nbsp;scanning&nbsp;stops&nbsp;and&nbsp;the&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="3112617">//&nbsp;is&nbsp;returned&nbsp;to&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span><span class="comment" id="3112647">//</span><br>
<span class="lineno">55</span><span class="comment" id="3112650">//&nbsp;The&nbsp;function&nbsp;is&nbsp;never&nbsp;called&nbsp;with&nbsp;an&nbsp;empty&nbsp;data&nbsp;slice&nbsp;unless&nbsp;atEOF</span><br>
<span class="lineno"></span><span class="comment" id="3112720">//&nbsp;is&nbsp;true.&nbsp;If&nbsp;atEOF&nbsp;is&nbsp;true,&nbsp;however,&nbsp;data&nbsp;may&nbsp;be&nbsp;non-empty&nbsp;and,</span><br>
<span class="lineno"></span><span class="comment" id="3112786">//&nbsp;as&nbsp;always,&nbsp;holds&nbsp;unprocessed&nbsp;text.</span><br>
<span class="lineno"></span><span class="keyword" id="3112824">type</span>&nbsp;<span class="ident" id="3112829">SplitFunc</span>&nbsp;<span class="keyword" id="3112839">func</span><span class="op" id="3112843">(</span><span class="ident" id="3112844">data</span>&nbsp;<span class="op" id="3112849">[</span><span class="op" id="3112850">]</span><span class="builtintype" id="3112851">byte</span><span class="op" id="3112855">,</span>&nbsp;<span class="ident" id="3112857">atEOF</span>&nbsp;<span class="builtintype" id="3112863">bool</span><span class="op" id="3112867">)</span>&nbsp;<span class="op" id="3112869">(</span><span class="ident" id="3112870">advance</span>&nbsp;<span class="builtintype" id="3112878">int</span><span class="op" id="3112881">,</span>&nbsp;<span class="ident" id="3112883">token</span>&nbsp;<span class="op" id="3112889">[</span><span class="op" id="3112890">]</span><span class="builtintype" id="3112891">byte</span><span class="op" id="3112895">,</span>&nbsp;<span class="ident" id="3112897">err</span>&nbsp;<span class="builtintype" id="3112901">error</span><span class="op" id="3112906">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="3112909">//&nbsp;Errors&nbsp;returned&nbsp;by&nbsp;Scanner.</span><br>
<span class="lineno"></span><span class="keyword" id="3112940">var</span>&nbsp;<span class="op" id="3112944">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112947">ErrTooLong</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3112966">=</span>&nbsp;<span class="ident" id="3112968">errors</span><span class="op" id="3112974">.</span><span class="ident" id="3112975">New</span><span class="op" id="3112978">(</span><span class="string" id="3112979">&#34;bufio.Scanner:&nbsp;token&nbsp;too&nbsp;long&#34;</span><span class="op" id="3113010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3113013">ErrNegativeAdvance</span>&nbsp;<span class="op" id="3113032">=</span>&nbsp;<span class="ident" id="3113034">errors</span><span class="op" id="3113040">.</span><span class="ident" id="3113041">New</span><span class="op" id="3113044">(</span><span class="string" id="3113045">&#34;bufio.Scanner:&nbsp;SplitFunc&nbsp;returns&nbsp;negative&nbsp;advance&nbsp;count&#34;</span><span class="op" id="3113102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3113105">ErrAdvanceTooFar</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3113124">=</span>&nbsp;<span class="ident" id="3113126">errors</span><span class="op" id="3113132">.</span><span class="ident" id="3113133">New</span><span class="op" id="3113136">(</span><span class="string" id="3113137">&#34;bufio.Scanner:&nbsp;SplitFunc&nbsp;returns&nbsp;advance&nbsp;count&nbsp;beyond&nbsp;input&#34;</span><span class="op" id="3113198">)</span><br>
<span class="lineno">65</span><span class="op" id="3113200">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3113203">const</span>&nbsp;<span class="op" id="3113209">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3113212">//&nbsp;MaxScanTokenSize&nbsp;is&nbsp;the&nbsp;maximum&nbsp;size&nbsp;used&nbsp;to&nbsp;buffer&nbsp;a&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3113277">//&nbsp;The&nbsp;actual&nbsp;maximum&nbsp;token&nbsp;size&nbsp;may&nbsp;be&nbsp;smaller&nbsp;as&nbsp;the&nbsp;buffer</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3113340">//&nbsp;may&nbsp;need&nbsp;to&nbsp;include,&nbsp;for&nbsp;instance,&nbsp;a&nbsp;newline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3113390">MaxScanTokenSize</span>&nbsp;<span class="op" id="3113407">=</span>&nbsp;<span class="num" id="3113409">64</span>&nbsp;<span class="op" id="3113412">*</span>&nbsp;<span class="num" id="3113414">1024</span><br>
<span class="lineno"></span><span class="op" id="3113419">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3113422">//&nbsp;NewScanner&nbsp;returns&nbsp;a&nbsp;new&nbsp;Scanner&nbsp;to&nbsp;read&nbsp;from&nbsp;r.</span><br>
<span class="lineno">75</span><span class="comment" id="3113474">//&nbsp;The&nbsp;split&nbsp;function&nbsp;defaults&nbsp;to&nbsp;ScanLines.</span><br>
<span class="lineno"></span><span class="keyword" id="3113519">func</span>&nbsp;<span class="ident" id="3113524">NewScanner</span><span class="op" id="3113534">(</span><span class="ident" id="3113535">r</span>&nbsp;<span class="ident" id="3113537">io</span><span class="op" id="3113539">.</span><span class="ident" id="3113540">Reader</span><span class="op" id="3113546">)</span>&nbsp;<span class="op" id="3113548">*</span><span class="ident" id="3113549">Scanner</span>&nbsp;<span class="op" id="3113557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113560">return</span>&nbsp;<span class="op" id="3113567">&amp;</span><span class="ident" id="3113568">Scanner</span><span class="op" id="3113575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3113579">r</span><span class="op" id="3113580">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3113593">r</span><span class="op" id="3113594">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3113598">split</span><span class="op" id="3113603">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3113612">ScanLines</span><span class="op" id="3113621">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3113625">maxTokenSize</span><span class="op" id="3113637">:</span>&nbsp;<span class="ident" id="3113639">MaxScanTokenSize</span><span class="op" id="3113655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3113659">buf</span><span class="op" id="3113662">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3113673">make</span><span class="op" id="3113677">(</span><span class="op" id="3113678">[</span><span class="op" id="3113679">]</span><span class="builtintype" id="3113680">byte</span><span class="op" id="3113684">,</span>&nbsp;<span class="num" id="3113686">4096</span><span class="op" id="3113690">)</span><span class="op" id="3113691">,</span>&nbsp;<span class="comment" id="3113693">//&nbsp;Plausible&nbsp;starting&nbsp;size;&nbsp;needn&#39;t&nbsp;be&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3113740">}</span><br>
<span class="lineno"></span><span class="op" id="3113742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3113745">//&nbsp;Err&nbsp;returns&nbsp;the&nbsp;first&nbsp;non-EOF&nbsp;error&nbsp;that&nbsp;was&nbsp;encountered&nbsp;by&nbsp;the&nbsp;Scanner.</span><br>
<span class="lineno"></span><span class="keyword" id="3113821">func</span>&nbsp;<span class="op" id="3113826">(</span><span class="ident" id="3113827">s</span>&nbsp;<span class="op" id="3113829">*</span><span class="ident" id="3113830">Scanner</span><span class="op" id="3113837">)</span>&nbsp;<span class="ident" id="3113839">Err</span><span class="op" id="3113842">(</span><span class="op" id="3113843">)</span>&nbsp;<span class="builtintype" id="3113845">error</span>&nbsp;<span class="op" id="3113851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113854">if</span>&nbsp;<span class="ident" id="3113857">s</span><span class="op" id="3113858">.</span><span class="ident" id="3113859">err</span>&nbsp;<span class="op" id="3113863">==</span>&nbsp;<span class="ident" id="3113866">io</span><span class="op" id="3113868">.</span><span class="ident" id="3113869">EOF</span>&nbsp;<span class="op" id="3113873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113877">return</span>&nbsp;<span class="ident" id="3113884">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3113889">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113892">return</span>&nbsp;<span class="ident" id="3113899">s</span><span class="op" id="3113900">.</span><span class="ident" id="3113901">err</span><br>
<span class="lineno"></span><span class="op" id="3113905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3113908">//&nbsp;Bytes&nbsp;returns&nbsp;the&nbsp;most&nbsp;recent&nbsp;token&nbsp;generated&nbsp;by&nbsp;a&nbsp;call&nbsp;to&nbsp;Scan.</span><br>
<span class="lineno"></span><span class="comment" id="3113976">//&nbsp;The&nbsp;underlying&nbsp;array&nbsp;may&nbsp;point&nbsp;to&nbsp;data&nbsp;that&nbsp;will&nbsp;be&nbsp;overwritten</span><br>
<span class="lineno">95</span><span class="comment" id="3114043">//&nbsp;by&nbsp;a&nbsp;subsequent&nbsp;call&nbsp;to&nbsp;Scan.&nbsp;It&nbsp;does&nbsp;no&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="3114099">func</span>&nbsp;<span class="op" id="3114104">(</span><span class="ident" id="3114105">s</span>&nbsp;<span class="op" id="3114107">*</span><span class="ident" id="3114108">Scanner</span><span class="op" id="3114115">)</span>&nbsp;<span class="ident" id="3114117">Bytes</span><span class="op" id="3114122">(</span><span class="op" id="3114123">)</span>&nbsp;<span class="op" id="3114125">[</span><span class="op" id="3114126">]</span><span class="builtintype" id="3114127">byte</span>&nbsp;<span class="op" id="3114132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3114135">return</span>&nbsp;<span class="ident" id="3114142">s</span><span class="op" id="3114143">.</span><span class="ident" id="3114144">token</span><br>
<span class="lineno"></span><span class="op" id="3114150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="3114153">//&nbsp;Text&nbsp;returns&nbsp;the&nbsp;most&nbsp;recent&nbsp;token&nbsp;generated&nbsp;by&nbsp;a&nbsp;call&nbsp;to&nbsp;Scan</span><br>
<span class="lineno"></span><span class="comment" id="3114219">//&nbsp;as&nbsp;a&nbsp;newly&nbsp;allocated&nbsp;string&nbsp;holding&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3114269">func</span>&nbsp;<span class="op" id="3114274">(</span><span class="ident" id="3114275">s</span>&nbsp;<span class="op" id="3114277">*</span><span class="ident" id="3114278">Scanner</span><span class="op" id="3114285">)</span>&nbsp;<span class="ident" id="3114287">Text</span><span class="op" id="3114291">(</span><span class="op" id="3114292">)</span>&nbsp;<span class="builtintype" id="3114294">string</span>&nbsp;<span class="op" id="3114301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3114304">return</span>&nbsp;<span class="builtintype" id="3114311">string</span><span class="op" id="3114317">(</span><span class="ident" id="3114318">s</span><span class="op" id="3114319">.</span><span class="ident" id="3114320">token</span><span class="op" id="3114325">)</span><br>
<span class="lineno"></span><span class="op" id="3114327">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="3114330">//&nbsp;Scan&nbsp;advances&nbsp;the&nbsp;Scanner&nbsp;to&nbsp;the&nbsp;next&nbsp;token,&nbsp;which&nbsp;will&nbsp;then&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="3114397">//&nbsp;available&nbsp;through&nbsp;the&nbsp;Bytes&nbsp;or&nbsp;Text&nbsp;method.&nbsp;It&nbsp;returns&nbsp;false&nbsp;when&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3114470">//&nbsp;scan&nbsp;stops,&nbsp;either&nbsp;by&nbsp;reaching&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;input&nbsp;or&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3114538">//&nbsp;After&nbsp;Scan&nbsp;returns&nbsp;false,&nbsp;the&nbsp;Err&nbsp;method&nbsp;will&nbsp;return&nbsp;any&nbsp;error&nbsp;that</span><br>
<span class="lineno">110</span><span class="comment" id="3114609">//&nbsp;occurred&nbsp;during&nbsp;scanning,&nbsp;except&nbsp;that&nbsp;if&nbsp;it&nbsp;was&nbsp;io.EOF,&nbsp;Err</span><br>
<span class="lineno"></span><span class="comment" id="3114672">//&nbsp;will&nbsp;return&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="3114692">//&nbsp;Split&nbsp;panics&nbsp;if&nbsp;the&nbsp;split&nbsp;function&nbsp;returns&nbsp;100&nbsp;empty&nbsp;tokens&nbsp;without</span><br>
<span class="lineno"></span><span class="comment" id="3114763">//&nbsp;advancing&nbsp;the&nbsp;input.&nbsp;This&nbsp;is&nbsp;a&nbsp;common&nbsp;error&nbsp;mode&nbsp;for&nbsp;scanners.</span><br>
<span class="lineno"></span><span class="keyword" id="3114829">func</span>&nbsp;<span class="op" id="3114834">(</span><span class="ident" id="3114835">s</span>&nbsp;<span class="op" id="3114837">*</span><span class="ident" id="3114838">Scanner</span><span class="op" id="3114845">)</span>&nbsp;<span class="ident" id="3114847">Scan</span><span class="op" id="3114851">(</span><span class="op" id="3114852">)</span>&nbsp;<span class="builtintype" id="3114854">bool</span>&nbsp;<span class="op" id="3114859">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3114862">//&nbsp;Loop&nbsp;until&nbsp;we&nbsp;have&nbsp;a&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3114894">for</span>&nbsp;<span class="op" id="3114898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3114902">//&nbsp;See&nbsp;if&nbsp;we&nbsp;can&nbsp;get&nbsp;a&nbsp;token&nbsp;with&nbsp;what&nbsp;we&nbsp;already&nbsp;have.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3114960">//&nbsp;If&nbsp;we&#39;ve&nbsp;run&nbsp;out&nbsp;of&nbsp;data&nbsp;but&nbsp;have&nbsp;an&nbsp;error,&nbsp;give&nbsp;the&nbsp;split&nbsp;function</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3115033">//&nbsp;a&nbsp;chance&nbsp;to&nbsp;recover&nbsp;any&nbsp;remaining,&nbsp;possibly&nbsp;empty&nbsp;token.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3115095">if</span>&nbsp;<span class="ident" id="3115098">s</span><span class="op" id="3115099">.</span><span class="ident" id="3115100">end</span>&nbsp;<span class="op" id="3115104">&gt;</span>&nbsp;<span class="ident" id="3115106">s</span><span class="op" id="3115107">.</span><span class="ident" id="3115108">start</span>&nbsp;<span class="op" id="3115114">||</span>&nbsp;<span class="ident" id="3115117">s</span><span class="op" id="3115118">.</span><span class="ident" id="3115119">err</span>&nbsp;<span class="op" id="3115123">!=</span>&nbsp;<span class="ident" id="3115126">nil</span>&nbsp;<span class="op" id="3115130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3115135">advance</span><span class="op" id="3115142">,</span>&nbsp;<span class="ident" id="3115144">token</span><span class="op" id="3115149">,</span>&nbsp;<span class="ident" id="3115151">err</span>&nbsp;<span class="op" id="3115155">:=</span>&nbsp;<span class="ident" id="3115158">s</span><span class="op" id="3115159">.</span><span class="ident" id="3115160">split</span><span class="op" id="3115165">(</span><span class="ident" id="3115166">s</span><span class="op" id="3115167">.</span><span class="ident" id="3115168">buf</span><span class="op" id="3115171">[</span><span class="ident" id="3115172">s</span><span class="op" id="3115173">.</span><span class="ident" id="3115174">start</span><span class="op" id="3115179">:</span><span class="ident" id="3115180">s</span><span class="op" id="3115181">.</span><span class="ident" id="3115182">end</span><span class="op" id="3115185">]</span><span class="op" id="3115186">,</span>&nbsp;<span class="ident" id="3115188">s</span><span class="op" id="3115189">.</span><span class="ident" id="3115190">err</span>&nbsp;<span class="op" id="3115194">!=</span>&nbsp;<span class="ident" id="3115197">nil</span><span class="op" id="3115200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3115205">if</span>&nbsp;<span class="ident" id="3115208">err</span>&nbsp;<span class="op" id="3115212">!=</span>&nbsp;<span class="ident" id="3115215">nil</span>&nbsp;<span class="op" id="3115219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3115225">s</span><span class="op" id="3115226">.</span><span class="ident" id="3115227">setErr</span><span class="op" id="3115233">(</span><span class="ident" id="3115234">err</span><span class="op" id="3115237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3115243">return</span>&nbsp;<span class="ident" id="3115250">false</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3115259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3115264">if</span>&nbsp;<span class="op" id="3115267">!</span><span class="ident" id="3115268">s</span><span class="op" id="3115269">.</span><span class="ident" id="3115270">advance</span><span class="op" id="3115277">(</span><span class="ident" id="3115278">advance</span><span class="op" id="3115285">)</span>&nbsp;<span class="op" id="3115287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3115293">return</span>&nbsp;<span class="ident" id="3115300">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3115309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3115314">s</span><span class="op" id="3115315">.</span><span class="ident" id="3115316">token</span>&nbsp;<span class="op" id="3115322">=</span>&nbsp;<span class="ident" id="3115324">token</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3115333">if</span>&nbsp;<span class="ident" id="3115336">token</span>&nbsp;<span class="op" id="3115342">!=</span>&nbsp;<span class="ident" id="3115345">nil</span>&nbsp;<span class="op" id="3115349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3115355">if</span>&nbsp;<span class="ident" id="3115358">s</span><span class="op" id="3115359">.</span><span class="ident" id="3115360">err</span>&nbsp;<span class="op" id="3115364">==</span>&nbsp;<span class="ident" id="3115367">nil</span>&nbsp;<span class="op" id="3115371">||</span>&nbsp;<span class="ident" id="3115374">advance</span>&nbsp;<span class="op" id="3115382">&gt;</span>&nbsp;<span class="num" id="3115384">0</span>&nbsp;<span class="op" id="3115386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3115393">s</span><span class="op" id="3115394">.</span><span class="ident" id="3115395">empties</span>&nbsp;<span class="op" id="3115403">=</span>&nbsp;<span class="num" id="3115405">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3115411">}</span>&nbsp;<span class="keyword" id="3115413">else</span>&nbsp;<span class="op" id="3115418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3115425">//&nbsp;Returning&nbsp;tokens&nbsp;not&nbsp;advancing&nbsp;input&nbsp;at&nbsp;EOF.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3115478">s</span><span class="op" id="3115479">.</span><span class="ident" id="3115480">empties</span><span class="op" id="3115487">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3115495">if</span>&nbsp;<span class="ident" id="3115498">s</span><span class="op" id="3115499">.</span><span class="ident" id="3115500">empties</span>&nbsp;<span class="op" id="3115508">&gt;</span>&nbsp;<span class="num" id="3115510">100</span>&nbsp;<span class="op" id="3115514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3115522">panic</span><span class="op" id="3115527">(</span><span class="string" id="3115528">&#34;bufio.Scan:&nbsp;100&nbsp;empty&nbsp;tokens&nbsp;without&nbsp;progressing&#34;</span><span class="op" id="3115578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3115585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3115591">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3115597">return</span>&nbsp;<span class="ident" id="3115604">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3115612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3115616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3115620">//&nbsp;We&nbsp;cannot&nbsp;generate&nbsp;a&nbsp;token&nbsp;with&nbsp;what&nbsp;we&nbsp;are&nbsp;holding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3115678">//&nbsp;If&nbsp;we&#39;ve&nbsp;already&nbsp;hit&nbsp;EOF&nbsp;or&nbsp;an&nbsp;I/O&nbsp;error,&nbsp;we&nbsp;are&nbsp;done.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3115738">if</span>&nbsp;<span class="ident" id="3115741">s</span><span class="op" id="3115742">.</span><span class="ident" id="3115743">err</span>&nbsp;<span class="op" id="3115747">!=</span>&nbsp;<span class="ident" id="3115750">nil</span>&nbsp;<span class="op" id="3115754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3115759">//&nbsp;Shut&nbsp;it&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3115779">s</span><span class="op" id="3115780">.</span><span class="ident" id="3115781">start</span>&nbsp;<span class="op" id="3115787">=</span>&nbsp;<span class="num" id="3115789">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3115794">s</span><span class="op" id="3115795">.</span><span class="ident" id="3115796">end</span>&nbsp;<span class="op" id="3115800">=</span>&nbsp;<span class="num" id="3115802">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3115807">return</span>&nbsp;<span class="ident" id="3115814">false</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3115822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3115826">//&nbsp;Must&nbsp;read&nbsp;more&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3115852">//&nbsp;First,&nbsp;shift&nbsp;data&nbsp;to&nbsp;beginning&nbsp;of&nbsp;buffer&nbsp;if&nbsp;there&#39;s&nbsp;lots&nbsp;of&nbsp;empty&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3115929">//&nbsp;or&nbsp;space&nbsp;is&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3115954">if</span>&nbsp;<span class="ident" id="3115957">s</span><span class="op" id="3115958">.</span><span class="ident" id="3115959">start</span>&nbsp;<span class="op" id="3115965">&gt;</span>&nbsp;<span class="num" id="3115967">0</span>&nbsp;<span class="op" id="3115969">&amp;&amp;</span>&nbsp;<span class="op" id="3115972">(</span><span class="ident" id="3115973">s</span><span class="op" id="3115974">.</span><span class="ident" id="3115975">end</span>&nbsp;<span class="op" id="3115979">==</span>&nbsp;<span class="builtinfunc" id="3115982">len</span><span class="op" id="3115985">(</span><span class="ident" id="3115986">s</span><span class="op" id="3115987">.</span><span class="ident" id="3115988">buf</span><span class="op" id="3115991">)</span>&nbsp;<span class="op" id="3115993">||</span>&nbsp;<span class="ident" id="3115996">s</span><span class="op" id="3115997">.</span><span class="ident" id="3115998">start</span>&nbsp;<span class="op" id="3116004">&gt;</span>&nbsp;<span class="builtinfunc" id="3116006">len</span><span class="op" id="3116009">(</span><span class="ident" id="3116010">s</span><span class="op" id="3116011">.</span><span class="ident" id="3116012">buf</span><span class="op" id="3116015">)</span><span class="op" id="3116016">/</span><span class="num" id="3116017">2</span><span class="op" id="3116018">)</span>&nbsp;<span class="op" id="3116020">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3116025">copy</span><span class="op" id="3116029">(</span><span class="ident" id="3116030">s</span><span class="op" id="3116031">.</span><span class="ident" id="3116032">buf</span><span class="op" id="3116035">,</span>&nbsp;<span class="ident" id="3116037">s</span><span class="op" id="3116038">.</span><span class="ident" id="3116039">buf</span><span class="op" id="3116042">[</span><span class="ident" id="3116043">s</span><span class="op" id="3116044">.</span><span class="ident" id="3116045">start</span><span class="op" id="3116050">:</span><span class="ident" id="3116051">s</span><span class="op" id="3116052">.</span><span class="ident" id="3116053">end</span><span class="op" id="3116056">]</span><span class="op" id="3116057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116062">s</span><span class="op" id="3116063">.</span><span class="ident" id="3116064">end</span>&nbsp;<span class="op" id="3116068">-=</span>&nbsp;<span class="ident" id="3116071">s</span><span class="op" id="3116072">.</span><span class="ident" id="3116073">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116082">s</span><span class="op" id="3116083">.</span><span class="ident" id="3116084">start</span>&nbsp;<span class="op" id="3116090">=</span>&nbsp;<span class="num" id="3116092">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3116096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3116100">//&nbsp;Is&nbsp;the&nbsp;buffer&nbsp;full?&nbsp;If&nbsp;so,&nbsp;resize.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116140">if</span>&nbsp;<span class="ident" id="3116143">s</span><span class="op" id="3116144">.</span><span class="ident" id="3116145">end</span>&nbsp;<span class="op" id="3116149">==</span>&nbsp;<span class="builtinfunc" id="3116152">len</span><span class="op" id="3116155">(</span><span class="ident" id="3116156">s</span><span class="op" id="3116157">.</span><span class="ident" id="3116158">buf</span><span class="op" id="3116161">)</span>&nbsp;<span class="op" id="3116163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116168">if</span>&nbsp;<span class="builtinfunc" id="3116171">len</span><span class="op" id="3116174">(</span><span class="ident" id="3116175">s</span><span class="op" id="3116176">.</span><span class="ident" id="3116177">buf</span><span class="op" id="3116180">)</span>&nbsp;<span class="op" id="3116182">&gt;=</span>&nbsp;<span class="ident" id="3116185">s</span><span class="op" id="3116186">.</span><span class="ident" id="3116187">maxTokenSize</span>&nbsp;<span class="op" id="3116200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116206">s</span><span class="op" id="3116207">.</span><span class="ident" id="3116208">setErr</span><span class="op" id="3116214">(</span><span class="ident" id="3116215">ErrTooLong</span><span class="op" id="3116225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116231">return</span>&nbsp;<span class="ident" id="3116238">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3116247">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116252">newSize</span>&nbsp;<span class="op" id="3116260">:=</span>&nbsp;<span class="builtinfunc" id="3116263">len</span><span class="op" id="3116266">(</span><span class="ident" id="3116267">s</span><span class="op" id="3116268">.</span><span class="ident" id="3116269">buf</span><span class="op" id="3116272">)</span>&nbsp;<span class="op" id="3116274">*</span>&nbsp;<span class="num" id="3116276">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116281">if</span>&nbsp;<span class="ident" id="3116284">newSize</span>&nbsp;<span class="op" id="3116292">&gt;</span>&nbsp;<span class="ident" id="3116294">s</span><span class="op" id="3116295">.</span><span class="ident" id="3116296">maxTokenSize</span>&nbsp;<span class="op" id="3116309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116315">newSize</span>&nbsp;<span class="op" id="3116323">=</span>&nbsp;<span class="ident" id="3116325">s</span><span class="op" id="3116326">.</span><span class="ident" id="3116327">maxTokenSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3116343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116348">newBuf</span>&nbsp;<span class="op" id="3116355">:=</span>&nbsp;<span class="builtinfunc" id="3116358">make</span><span class="op" id="3116362">(</span><span class="op" id="3116363">[</span><span class="op" id="3116364">]</span><span class="builtintype" id="3116365">byte</span><span class="op" id="3116369">,</span>&nbsp;<span class="ident" id="3116371">newSize</span><span class="op" id="3116378">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3116383">copy</span><span class="op" id="3116387">(</span><span class="ident" id="3116388">newBuf</span><span class="op" id="3116394">,</span>&nbsp;<span class="ident" id="3116396">s</span><span class="op" id="3116397">.</span><span class="ident" id="3116398">buf</span><span class="op" id="3116401">[</span><span class="ident" id="3116402">s</span><span class="op" id="3116403">.</span><span class="ident" id="3116404">start</span><span class="op" id="3116409">:</span><span class="ident" id="3116410">s</span><span class="op" id="3116411">.</span><span class="ident" id="3116412">end</span><span class="op" id="3116415">]</span><span class="op" id="3116416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116421">s</span><span class="op" id="3116422">.</span><span class="ident" id="3116423">buf</span>&nbsp;<span class="op" id="3116427">=</span>&nbsp;<span class="ident" id="3116429">newBuf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116439">s</span><span class="op" id="3116440">.</span><span class="ident" id="3116441">end</span>&nbsp;<span class="op" id="3116445">-=</span>&nbsp;<span class="ident" id="3116448">s</span><span class="op" id="3116449">.</span><span class="ident" id="3116450">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116459">s</span><span class="op" id="3116460">.</span><span class="ident" id="3116461">start</span>&nbsp;<span class="op" id="3116467">=</span>&nbsp;<span class="num" id="3116469">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116474">continue</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3116485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3116489">//&nbsp;Finally&nbsp;we&nbsp;can&nbsp;read&nbsp;some&nbsp;input.&nbsp;Make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;get&nbsp;stuck&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3116560">//&nbsp;a&nbsp;misbehaving&nbsp;Reader.&nbsp;Officially&nbsp;we&nbsp;don&#39;t&nbsp;need&nbsp;to&nbsp;do&nbsp;this,&nbsp;but&nbsp;let&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3116634">//&nbsp;be&nbsp;extra&nbsp;careful:&nbsp;Scanner&nbsp;is&nbsp;for&nbsp;safe,&nbsp;simple&nbsp;jobs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116691">for</span>&nbsp;<span class="ident" id="3116695">loop</span>&nbsp;<span class="op" id="3116700">:=</span>&nbsp;<span class="num" id="3116703">0</span><span class="op" id="3116704">;</span>&nbsp;<span class="op" id="3116706">;</span>&nbsp;<span class="op" id="3116708">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116713">n</span><span class="op" id="3116714">,</span>&nbsp;<span class="ident" id="3116716">err</span>&nbsp;<span class="op" id="3116720">:=</span>&nbsp;<span class="ident" id="3116723">s</span><span class="op" id="3116724">.</span><span class="ident" id="3116725">r</span><span class="op" id="3116726">.</span><span class="ident" id="3116727">Read</span><span class="op" id="3116731">(</span><span class="ident" id="3116732">s</span><span class="op" id="3116733">.</span><span class="ident" id="3116734">buf</span><span class="op" id="3116737">[</span><span class="ident" id="3116738">s</span><span class="op" id="3116739">.</span><span class="ident" id="3116740">end</span><span class="op" id="3116743">:</span><span class="builtinfunc" id="3116744">len</span><span class="op" id="3116747">(</span><span class="ident" id="3116748">s</span><span class="op" id="3116749">.</span><span class="ident" id="3116750">buf</span><span class="op" id="3116753">)</span><span class="op" id="3116754">]</span><span class="op" id="3116755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116760">s</span><span class="op" id="3116761">.</span><span class="ident" id="3116762">end</span>&nbsp;<span class="op" id="3116766">+=</span>&nbsp;<span class="ident" id="3116769">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116774">if</span>&nbsp;<span class="ident" id="3116777">err</span>&nbsp;<span class="op" id="3116781">!=</span>&nbsp;<span class="ident" id="3116784">nil</span>&nbsp;<span class="op" id="3116788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116794">s</span><span class="op" id="3116795">.</span><span class="ident" id="3116796">setErr</span><span class="op" id="3116802">(</span><span class="ident" id="3116803">err</span><span class="op" id="3116806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116812">break</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3116821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116826">if</span>&nbsp;<span class="ident" id="3116829">n</span>&nbsp;<span class="op" id="3116831">&gt;</span>&nbsp;<span class="num" id="3116833">0</span>&nbsp;<span class="op" id="3116835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116841">s</span><span class="op" id="3116842">.</span><span class="ident" id="3116843">empties</span>&nbsp;<span class="op" id="3116851">=</span>&nbsp;<span class="num" id="3116853">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116859">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3116868">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116873">loop</span><span class="op" id="3116877">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116883">if</span>&nbsp;<span class="ident" id="3116886">loop</span>&nbsp;<span class="op" id="3116891">&gt;</span>&nbsp;<span class="ident" id="3116893">maxConsecutiveEmptyReads</span>&nbsp;<span class="op" id="3116918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116924">s</span><span class="op" id="3116925">.</span><span class="ident" id="3116926">setErr</span><span class="op" id="3116932">(</span><span class="ident" id="3116933">io</span><span class="op" id="3116935">.</span><span class="ident" id="3116936">ErrNoProgress</span><span class="op" id="3116949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116955">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3116964">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3116968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3116971">}</span><br>
<span class="lineno"></span><span class="op" id="3116973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3116976">//&nbsp;advance&nbsp;consumes&nbsp;n&nbsp;bytes&nbsp;of&nbsp;the&nbsp;buffer.&nbsp;It&nbsp;reports&nbsp;whether&nbsp;the&nbsp;advance&nbsp;was&nbsp;legal.</span><br>
<span class="lineno">200</span><span class="keyword" id="3117061">func</span>&nbsp;<span class="op" id="3117066">(</span><span class="ident" id="3117067">s</span>&nbsp;<span class="op" id="3117069">*</span><span class="ident" id="3117070">Scanner</span><span class="op" id="3117077">)</span>&nbsp;<span class="ident" id="3117079">advance</span><span class="op" id="3117086">(</span><span class="ident" id="3117087">n</span>&nbsp;<span class="builtintype" id="3117089">int</span><span class="op" id="3117092">)</span>&nbsp;<span class="builtintype" id="3117094">bool</span>&nbsp;<span class="op" id="3117099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3117102">if</span>&nbsp;<span class="ident" id="3117105">n</span>&nbsp;<span class="op" id="3117107">&lt;</span>&nbsp;<span class="num" id="3117109">0</span>&nbsp;<span class="op" id="3117111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117115">s</span><span class="op" id="3117116">.</span><span class="ident" id="3117117">setErr</span><span class="op" id="3117123">(</span><span class="ident" id="3117124">ErrNegativeAdvance</span><span class="op" id="3117142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3117146">return</span>&nbsp;<span class="ident" id="3117153">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3117160">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3117163">if</span>&nbsp;<span class="ident" id="3117166">n</span>&nbsp;<span class="op" id="3117168">&gt;</span>&nbsp;<span class="ident" id="3117170">s</span><span class="op" id="3117171">.</span><span class="ident" id="3117172">end</span><span class="op" id="3117175">-</span><span class="ident" id="3117176">s</span><span class="op" id="3117177">.</span><span class="ident" id="3117178">start</span>&nbsp;<span class="op" id="3117184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117188">s</span><span class="op" id="3117189">.</span><span class="ident" id="3117190">setErr</span><span class="op" id="3117196">(</span><span class="ident" id="3117197">ErrAdvanceTooFar</span><span class="op" id="3117213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3117217">return</span>&nbsp;<span class="ident" id="3117224">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3117231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117234">s</span><span class="op" id="3117235">.</span><span class="ident" id="3117236">start</span>&nbsp;<span class="op" id="3117242">+=</span>&nbsp;<span class="ident" id="3117245">n</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3117248">return</span>&nbsp;<span class="ident" id="3117255">true</span><br>
<span class="lineno"></span><span class="op" id="3117260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3117263">//&nbsp;setErr&nbsp;records&nbsp;the&nbsp;first&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="keyword" id="3117310">func</span>&nbsp;<span class="op" id="3117315">(</span><span class="ident" id="3117316">s</span>&nbsp;<span class="op" id="3117318">*</span><span class="ident" id="3117319">Scanner</span><span class="op" id="3117326">)</span>&nbsp;<span class="ident" id="3117328">setErr</span><span class="op" id="3117334">(</span><span class="ident" id="3117335">err</span>&nbsp;<span class="builtintype" id="3117339">error</span><span class="op" id="3117344">)</span>&nbsp;<span class="op" id="3117346">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3117349">if</span>&nbsp;<span class="ident" id="3117352">s</span><span class="op" id="3117353">.</span><span class="ident" id="3117354">err</span>&nbsp;<span class="op" id="3117358">==</span>&nbsp;<span class="ident" id="3117361">nil</span>&nbsp;<span class="op" id="3117365">||</span>&nbsp;<span class="ident" id="3117368">s</span><span class="op" id="3117369">.</span><span class="ident" id="3117370">err</span>&nbsp;<span class="op" id="3117374">==</span>&nbsp;<span class="ident" id="3117377">io</span><span class="op" id="3117379">.</span><span class="ident" id="3117380">EOF</span>&nbsp;<span class="op" id="3117384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117388">s</span><span class="op" id="3117389">.</span><span class="ident" id="3117390">err</span>&nbsp;<span class="op" id="3117394">=</span>&nbsp;<span class="ident" id="3117396">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3117401">}</span><br>
<span class="lineno"></span><span class="op" id="3117403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="3117406">//&nbsp;Split&nbsp;sets&nbsp;the&nbsp;split&nbsp;function&nbsp;for&nbsp;the&nbsp;Scanner.&nbsp;If&nbsp;called,&nbsp;it&nbsp;must&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="3117478">//&nbsp;called&nbsp;before&nbsp;Scan.&nbsp;The&nbsp;default&nbsp;split&nbsp;function&nbsp;is&nbsp;ScanLines.</span><br>
<span class="lineno"></span><span class="keyword" id="3117542">func</span>&nbsp;<span class="op" id="3117547">(</span><span class="ident" id="3117548">s</span>&nbsp;<span class="op" id="3117550">*</span><span class="ident" id="3117551">Scanner</span><span class="op" id="3117558">)</span>&nbsp;<span class="ident" id="3117560">Split</span><span class="op" id="3117565">(</span><span class="ident" id="3117566">split</span>&nbsp;<span class="ident" id="3117572">SplitFunc</span><span class="op" id="3117581">)</span>&nbsp;<span class="op" id="3117583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117586">s</span><span class="op" id="3117587">.</span><span class="ident" id="3117588">split</span>&nbsp;<span class="op" id="3117594">=</span>&nbsp;<span class="ident" id="3117596">split</span><br>
<span class="lineno"></span><span class="op" id="3117602">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="3117605">//&nbsp;Split&nbsp;functions</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3117625">//&nbsp;ScanBytes&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each&nbsp;byte&nbsp;as&nbsp;a&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="3117707">func</span>&nbsp;<span class="ident" id="3117712">ScanBytes</span><span class="op" id="3117721">(</span><span class="ident" id="3117722">data</span>&nbsp;<span class="op" id="3117727">[</span><span class="op" id="3117728">]</span><span class="builtintype" id="3117729">byte</span><span class="op" id="3117733">,</span>&nbsp;<span class="ident" id="3117735">atEOF</span>&nbsp;<span class="builtintype" id="3117741">bool</span><span class="op" id="3117745">)</span>&nbsp;<span class="op" id="3117747">(</span><span class="ident" id="3117748">advance</span>&nbsp;<span class="builtintype" id="3117756">int</span><span class="op" id="3117759">,</span>&nbsp;<span class="ident" id="3117761">token</span>&nbsp;<span class="op" id="3117767">[</span><span class="op" id="3117768">]</span><span class="builtintype" id="3117769">byte</span><span class="op" id="3117773">,</span>&nbsp;<span class="ident" id="3117775">err</span>&nbsp;<span class="builtintype" id="3117779">error</span><span class="op" id="3117784">)</span>&nbsp;<span class="op" id="3117786">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3117789">if</span>&nbsp;<span class="ident" id="3117792">atEOF</span>&nbsp;<span class="op" id="3117798">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3117801">len</span><span class="op" id="3117804">(</span><span class="ident" id="3117805">data</span><span class="op" id="3117809">)</span>&nbsp;<span class="op" id="3117811">==</span>&nbsp;<span class="num" id="3117814">0</span>&nbsp;<span class="op" id="3117816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3117820">return</span>&nbsp;<span class="num" id="3117827">0</span><span class="op" id="3117828">,</span>&nbsp;<span class="ident" id="3117830">nil</span><span class="op" id="3117833">,</span>&nbsp;<span class="ident" id="3117835">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3117840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3117843">return</span>&nbsp;<span class="num" id="3117850">1</span><span class="op" id="3117851">,</span>&nbsp;<span class="ident" id="3117853">data</span><span class="op" id="3117857">[</span><span class="num" id="3117858">0</span><span class="op" id="3117859">:</span><span class="num" id="3117860">1</span><span class="op" id="3117861">]</span><span class="op" id="3117862">,</span>&nbsp;<span class="ident" id="3117864">nil</span><br>
<span class="lineno"></span><span class="op" id="3117868">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="3117871">var</span>&nbsp;<span class="ident" id="3117875">errorRune</span>&nbsp;<span class="op" id="3117885">=</span>&nbsp;<span class="op" id="3117887">[</span><span class="op" id="3117888">]</span><span class="builtintype" id="3117889">byte</span><span class="op" id="3117893">(</span><span class="builtintype" id="3117894">string</span><span class="op" id="3117900">(</span><span class="ident" id="3117901">utf8</span><span class="op" id="3117905">.</span><span class="ident" id="3117906">RuneError</span><span class="op" id="3117915">)</span><span class="op" id="3117916">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3117919">//&nbsp;ScanRunes&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each</span><br>
<span class="lineno"></span><span class="comment" id="3117984">//&nbsp;UTF-8-encoded&nbsp;rune&nbsp;as&nbsp;a&nbsp;token.&nbsp;The&nbsp;sequence&nbsp;of&nbsp;runes&nbsp;returned&nbsp;is</span><br>
<span class="lineno">240</span><span class="comment" id="3118052">//&nbsp;equivalent&nbsp;to&nbsp;that&nbsp;from&nbsp;a&nbsp;range&nbsp;loop&nbsp;over&nbsp;the&nbsp;input&nbsp;as&nbsp;a&nbsp;string,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="3118126">//&nbsp;means&nbsp;that&nbsp;erroneous&nbsp;UTF-8&nbsp;encodings&nbsp;translate&nbsp;to&nbsp;U+FFFD&nbsp;=&nbsp;&#34;\xef\xbf\xbd&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3118204">//&nbsp;Because&nbsp;of&nbsp;the&nbsp;Scan&nbsp;interface,&nbsp;this&nbsp;makes&nbsp;it&nbsp;impossible&nbsp;for&nbsp;the&nbsp;client&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3118281">//&nbsp;distinguish&nbsp;correctly&nbsp;encoded&nbsp;replacement&nbsp;runes&nbsp;from&nbsp;encoding&nbsp;errors.</span><br>
<span class="lineno"></span><span class="keyword" id="3118354">func</span>&nbsp;<span class="ident" id="3118359">ScanRunes</span><span class="op" id="3118368">(</span><span class="ident" id="3118369">data</span>&nbsp;<span class="op" id="3118374">[</span><span class="op" id="3118375">]</span><span class="builtintype" id="3118376">byte</span><span class="op" id="3118380">,</span>&nbsp;<span class="ident" id="3118382">atEOF</span>&nbsp;<span class="builtintype" id="3118388">bool</span><span class="op" id="3118392">)</span>&nbsp;<span class="op" id="3118394">(</span><span class="ident" id="3118395">advance</span>&nbsp;<span class="builtintype" id="3118403">int</span><span class="op" id="3118406">,</span>&nbsp;<span class="ident" id="3118408">token</span>&nbsp;<span class="op" id="3118414">[</span><span class="op" id="3118415">]</span><span class="builtintype" id="3118416">byte</span><span class="op" id="3118420">,</span>&nbsp;<span class="ident" id="3118422">err</span>&nbsp;<span class="builtintype" id="3118426">error</span><span class="op" id="3118431">)</span>&nbsp;<span class="op" id="3118433">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3118436">if</span>&nbsp;<span class="ident" id="3118439">atEOF</span>&nbsp;<span class="op" id="3118445">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3118448">len</span><span class="op" id="3118451">(</span><span class="ident" id="3118452">data</span><span class="op" id="3118456">)</span>&nbsp;<span class="op" id="3118458">==</span>&nbsp;<span class="num" id="3118461">0</span>&nbsp;<span class="op" id="3118463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3118467">return</span>&nbsp;<span class="num" id="3118474">0</span><span class="op" id="3118475">,</span>&nbsp;<span class="ident" id="3118477">nil</span><span class="op" id="3118480">,</span>&nbsp;<span class="ident" id="3118482">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3118487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3118491">//&nbsp;Fast&nbsp;path&nbsp;1:&nbsp;ASCII.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3118515">if</span>&nbsp;<span class="ident" id="3118518">data</span><span class="op" id="3118522">[</span><span class="num" id="3118523">0</span><span class="op" id="3118524">]</span>&nbsp;<span class="op" id="3118526">&lt;</span>&nbsp;<span class="ident" id="3118528">utf8</span><span class="op" id="3118532">.</span><span class="ident" id="3118533">RuneSelf</span>&nbsp;<span class="op" id="3118542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3118546">return</span>&nbsp;<span class="num" id="3118553">1</span><span class="op" id="3118554">,</span>&nbsp;<span class="ident" id="3118556">data</span><span class="op" id="3118560">[</span><span class="num" id="3118561">0</span><span class="op" id="3118562">:</span><span class="num" id="3118563">1</span><span class="op" id="3118564">]</span><span class="op" id="3118565">,</span>&nbsp;<span class="ident" id="3118567">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3118572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3118576">//&nbsp;Fast&nbsp;path&nbsp;2:&nbsp;Correct&nbsp;UTF-8&nbsp;decode&nbsp;without&nbsp;error.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3118629">_</span><span class="op" id="3118630">,</span>&nbsp;<span class="ident" id="3118632">width</span>&nbsp;<span class="op" id="3118638">:=</span>&nbsp;<span class="ident" id="3118641">utf8</span><span class="op" id="3118645">.</span><span class="ident" id="3118646">DecodeRune</span><span class="op" id="3118656">(</span><span class="ident" id="3118657">data</span><span class="op" id="3118661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3118664">if</span>&nbsp;<span class="ident" id="3118667">width</span>&nbsp;<span class="op" id="3118673">&gt;</span>&nbsp;<span class="num" id="3118675">1</span>&nbsp;<span class="op" id="3118677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3118681">//&nbsp;It&#39;s&nbsp;a&nbsp;valid&nbsp;encoding.&nbsp;Width&nbsp;cannot&nbsp;be&nbsp;one&nbsp;for&nbsp;a&nbsp;correctly&nbsp;encoded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3118753">//&nbsp;non-ASCII&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3118774">return</span>&nbsp;<span class="ident" id="3118781">width</span><span class="op" id="3118786">,</span>&nbsp;<span class="ident" id="3118788">data</span><span class="op" id="3118792">[</span><span class="num" id="3118793">0</span><span class="op" id="3118794">:</span><span class="ident" id="3118795">width</span><span class="op" id="3118800">]</span><span class="op" id="3118801">,</span>&nbsp;<span class="ident" id="3118803">nil</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3118808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3118812">//&nbsp;We&nbsp;know&nbsp;it&#39;s&nbsp;an&nbsp;error:&nbsp;we&nbsp;have&nbsp;width==1&nbsp;and&nbsp;implicitly&nbsp;r==utf8.RuneError.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3118890">//&nbsp;Is&nbsp;the&nbsp;error&nbsp;because&nbsp;there&nbsp;wasn&#39;t&nbsp;a&nbsp;full&nbsp;rune&nbsp;to&nbsp;be&nbsp;decoded?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3118955">//&nbsp;FullRune&nbsp;distinguishes&nbsp;correctly&nbsp;between&nbsp;erroneous&nbsp;and&nbsp;incomplete&nbsp;encodings.</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3119036">if</span>&nbsp;<span class="op" id="3119039">!</span><span class="ident" id="3119040">atEOF</span>&nbsp;<span class="op" id="3119046">&amp;&amp;</span>&nbsp;<span class="op" id="3119049">!</span><span class="ident" id="3119050">utf8</span><span class="op" id="3119054">.</span><span class="ident" id="3119055">FullRune</span><span class="op" id="3119063">(</span><span class="ident" id="3119064">data</span><span class="op" id="3119068">)</span>&nbsp;<span class="op" id="3119070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3119074">//&nbsp;Incomplete;&nbsp;get&nbsp;more&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3119107">return</span>&nbsp;<span class="num" id="3119114">0</span><span class="op" id="3119115">,</span>&nbsp;<span class="ident" id="3119117">nil</span><span class="op" id="3119120">,</span>&nbsp;<span class="ident" id="3119122">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3119127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3119131">//&nbsp;We&nbsp;have&nbsp;a&nbsp;real&nbsp;UTF-8&nbsp;encoding&nbsp;error.&nbsp;Return&nbsp;a&nbsp;properly&nbsp;encoded&nbsp;error&nbsp;rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3119209">//&nbsp;but&nbsp;advance&nbsp;only&nbsp;one&nbsp;byte.&nbsp;This&nbsp;matches&nbsp;the&nbsp;behavior&nbsp;of&nbsp;a&nbsp;range&nbsp;loop&nbsp;over</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3119287">//&nbsp;an&nbsp;incorrectly&nbsp;encoded&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3119322">return</span>&nbsp;<span class="num" id="3119329">1</span><span class="op" id="3119330">,</span>&nbsp;<span class="ident" id="3119332">errorRune</span><span class="op" id="3119341">,</span>&nbsp;<span class="ident" id="3119343">nil</span><br>
<span class="lineno"></span><span class="op" id="3119347">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="comment" id="3119350">//&nbsp;dropCR&nbsp;drops&nbsp;a&nbsp;terminal&nbsp;\r&nbsp;from&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3119395">func</span>&nbsp;<span class="ident" id="3119400">dropCR</span><span class="op" id="3119406">(</span><span class="ident" id="3119407">data</span>&nbsp;<span class="op" id="3119412">[</span><span class="op" id="3119413">]</span><span class="builtintype" id="3119414">byte</span><span class="op" id="3119418">)</span>&nbsp;<span class="op" id="3119420">[</span><span class="op" id="3119421">]</span><span class="builtintype" id="3119422">byte</span>&nbsp;<span class="op" id="3119427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3119430">if</span>&nbsp;<span class="builtinfunc" id="3119433">len</span><span class="op" id="3119436">(</span><span class="ident" id="3119437">data</span><span class="op" id="3119441">)</span>&nbsp;<span class="op" id="3119443">&gt;</span>&nbsp;<span class="num" id="3119445">0</span>&nbsp;<span class="op" id="3119447">&amp;&amp;</span>&nbsp;<span class="ident" id="3119450">data</span><span class="op" id="3119454">[</span><span class="builtinfunc" id="3119455">len</span><span class="op" id="3119458">(</span><span class="ident" id="3119459">data</span><span class="op" id="3119463">)</span><span class="op" id="3119464">-</span><span class="num" id="3119465">1</span><span class="op" id="3119466">]</span>&nbsp;<span class="op" id="3119468">==</span>&nbsp;<span class="string" id="3119471">&#39;\r&#39;</span>&nbsp;<span class="op" id="3119476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3119480">return</span>&nbsp;<span class="ident" id="3119487">data</span><span class="op" id="3119491">[</span><span class="num" id="3119492">0</span>&nbsp;<span class="op" id="3119494">:</span>&nbsp;<span class="builtinfunc" id="3119496">len</span><span class="op" id="3119499">(</span><span class="ident" id="3119500">data</span><span class="op" id="3119504">)</span><span class="op" id="3119505">-</span><span class="num" id="3119506">1</span><span class="op" id="3119507">]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3119510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3119513">return</span>&nbsp;<span class="ident" id="3119520">data</span><br>
<span class="lineno"></span><span class="op" id="3119525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3119528">//&nbsp;ScanLines&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each&nbsp;line&nbsp;of</span><br>
<span class="lineno">285</span><span class="comment" id="3119601">//&nbsp;text,&nbsp;stripped&nbsp;of&nbsp;any&nbsp;trailing&nbsp;end-of-line&nbsp;marker.&nbsp;The&nbsp;returned&nbsp;line&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="3119677">//&nbsp;be&nbsp;empty.&nbsp;The&nbsp;end-of-line&nbsp;marker&nbsp;is&nbsp;one&nbsp;optional&nbsp;carriage&nbsp;return&nbsp;followed</span><br>
<span class="lineno"></span><span class="comment" id="3119754">//&nbsp;by&nbsp;one&nbsp;mandatory&nbsp;newline.&nbsp;In&nbsp;regular&nbsp;expression&nbsp;notation,&nbsp;it&nbsp;is&nbsp;`\r?\n`.</span><br>
<span class="lineno"></span><span class="comment" id="3119830">//&nbsp;The&nbsp;last&nbsp;non-empty&nbsp;line&nbsp;of&nbsp;input&nbsp;will&nbsp;be&nbsp;returned&nbsp;even&nbsp;if&nbsp;it&nbsp;has&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="3119901">//&nbsp;newline.</span><br>
<span class="lineno">290</span><span class="keyword" id="3119913">func</span>&nbsp;<span class="ident" id="3119918">ScanLines</span><span class="op" id="3119927">(</span><span class="ident" id="3119928">data</span>&nbsp;<span class="op" id="3119933">[</span><span class="op" id="3119934">]</span><span class="builtintype" id="3119935">byte</span><span class="op" id="3119939">,</span>&nbsp;<span class="ident" id="3119941">atEOF</span>&nbsp;<span class="builtintype" id="3119947">bool</span><span class="op" id="3119951">)</span>&nbsp;<span class="op" id="3119953">(</span><span class="ident" id="3119954">advance</span>&nbsp;<span class="builtintype" id="3119962">int</span><span class="op" id="3119965">,</span>&nbsp;<span class="ident" id="3119967">token</span>&nbsp;<span class="op" id="3119973">[</span><span class="op" id="3119974">]</span><span class="builtintype" id="3119975">byte</span><span class="op" id="3119979">,</span>&nbsp;<span class="ident" id="3119981">err</span>&nbsp;<span class="builtintype" id="3119985">error</span><span class="op" id="3119990">)</span>&nbsp;<span class="op" id="3119992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3119995">if</span>&nbsp;<span class="ident" id="3119998">atEOF</span>&nbsp;<span class="op" id="3120004">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3120007">len</span><span class="op" id="3120010">(</span><span class="ident" id="3120011">data</span><span class="op" id="3120015">)</span>&nbsp;<span class="op" id="3120017">==</span>&nbsp;<span class="num" id="3120020">0</span>&nbsp;<span class="op" id="3120022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3120026">return</span>&nbsp;<span class="num" id="3120033">0</span><span class="op" id="3120034">,</span>&nbsp;<span class="ident" id="3120036">nil</span><span class="op" id="3120039">,</span>&nbsp;<span class="ident" id="3120041">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3120046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3120049">if</span>&nbsp;<span class="ident" id="3120052">i</span>&nbsp;<span class="op" id="3120054">:=</span>&nbsp;<span class="ident" id="3120057">bytes</span><span class="op" id="3120062">.</span><span class="ident" id="3120063">IndexByte</span><span class="op" id="3120072">(</span><span class="ident" id="3120073">data</span><span class="op" id="3120077">,</span>&nbsp;<span class="string" id="3120079">&#39;\n&#39;</span><span class="op" id="3120083">)</span><span class="op" id="3120084">;</span>&nbsp;<span class="ident" id="3120086">i</span>&nbsp;<span class="op" id="3120088">&gt;=</span>&nbsp;<span class="num" id="3120091">0</span>&nbsp;<span class="op" id="3120093">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3120097">//&nbsp;We&nbsp;have&nbsp;a&nbsp;full&nbsp;newline-terminated&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3120142">return</span>&nbsp;<span class="ident" id="3120149">i</span>&nbsp;<span class="op" id="3120151">+</span>&nbsp;<span class="num" id="3120153">1</span><span class="op" id="3120154">,</span>&nbsp;<span class="ident" id="3120156">dropCR</span><span class="op" id="3120162">(</span><span class="ident" id="3120163">data</span><span class="op" id="3120167">[</span><span class="num" id="3120168">0</span><span class="op" id="3120169">:</span><span class="ident" id="3120170">i</span><span class="op" id="3120171">]</span><span class="op" id="3120172">)</span><span class="op" id="3120173">,</span>&nbsp;<span class="ident" id="3120175">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3120180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3120183">//&nbsp;If&nbsp;we&#39;re&nbsp;at&nbsp;EOF,&nbsp;we&nbsp;have&nbsp;a&nbsp;final,&nbsp;non-terminated&nbsp;line.&nbsp;Return&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3120253">if</span>&nbsp;<span class="ident" id="3120256">atEOF</span>&nbsp;<span class="op" id="3120262">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3120266">return</span>&nbsp;<span class="builtinfunc" id="3120273">len</span><span class="op" id="3120276">(</span><span class="ident" id="3120277">data</span><span class="op" id="3120281">)</span><span class="op" id="3120282">,</span>&nbsp;<span class="ident" id="3120284">dropCR</span><span class="op" id="3120290">(</span><span class="ident" id="3120291">data</span><span class="op" id="3120295">)</span><span class="op" id="3120296">,</span>&nbsp;<span class="ident" id="3120298">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3120303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3120306">//&nbsp;Request&nbsp;more&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3120329">return</span>&nbsp;<span class="num" id="3120336">0</span><span class="op" id="3120337">,</span>&nbsp;<span class="ident" id="3120339">nil</span><span class="op" id="3120342">,</span>&nbsp;<span class="ident" id="3120344">nil</span><br>
<span class="lineno"></span><span class="op" id="3120348">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="comment" id="3120351">//&nbsp;isSpace&nbsp;reports&nbsp;whether&nbsp;the&nbsp;character&nbsp;is&nbsp;a&nbsp;Unicode&nbsp;white&nbsp;space&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="3120428">//&nbsp;We&nbsp;avoid&nbsp;dependency&nbsp;on&nbsp;the&nbsp;unicode&nbsp;package,&nbsp;but&nbsp;check&nbsp;validity&nbsp;of&nbsp;the&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="3120516">//&nbsp;in&nbsp;the&nbsp;tests.</span><br>
<span class="lineno"></span><span class="keyword" id="3120533">func</span>&nbsp;<span class="ident" id="3120538">isSpace</span><span class="op" id="3120545">(</span><span class="ident" id="3120546">r</span>&nbsp;<span class="builtintype" id="3120548">rune</span><span class="op" id="3120552">)</span>&nbsp;<span class="builtintype" id="3120554">bool</span>&nbsp;<span class="op" id="3120559">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3120562">if</span>&nbsp;<span class="ident" id="3120565">r</span>&nbsp;<span class="op" id="3120567">&lt;=</span>&nbsp;<span class="string" id="3120570">&#39;\u00FF&#39;</span>&nbsp;<span class="op" id="3120579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3120583">//&nbsp;Obvious&nbsp;ASCII&nbsp;ones:&nbsp;\t&nbsp;through&nbsp;\r&nbsp;plus&nbsp;space.&nbsp;Plus&nbsp;two&nbsp;Latin-1&nbsp;oddballs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3120661">switch</span>&nbsp;<span class="ident" id="3120668">r</span>&nbsp;<span class="op" id="3120670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3120674">case</span>&nbsp;<span class="string" id="3120679">&#39;&nbsp;&#39;</span><span class="op" id="3120682">,</span>&nbsp;<span class="string" id="3120684">&#39;\t&#39;</span><span class="op" id="3120688">,</span>&nbsp;<span class="string" id="3120690">&#39;\n&#39;</span><span class="op" id="3120694">,</span>&nbsp;<span class="string" id="3120696">&#39;\v&#39;</span><span class="op" id="3120700">,</span>&nbsp;<span class="string" id="3120702">&#39;\f&#39;</span><span class="op" id="3120706">,</span>&nbsp;<span class="string" id="3120708">&#39;\r&#39;</span><span class="op" id="3120712">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3120717">return</span>&nbsp;<span class="ident" id="3120724">true</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3120731">case</span>&nbsp;<span class="string" id="3120736">&#39;\u0085&#39;</span><span class="op" id="3120744">,</span>&nbsp;<span class="string" id="3120746">&#39;\u00A0&#39;</span><span class="op" id="3120754">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3120759">return</span>&nbsp;<span class="ident" id="3120766">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3120773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3120777">return</span>&nbsp;<span class="ident" id="3120784">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3120791">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3120794">//&nbsp;High-valued&nbsp;ones.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3120816">if</span>&nbsp;<span class="string" id="3120819">&#39;\u2000&#39;</span>&nbsp;<span class="op" id="3120828">&lt;=</span>&nbsp;<span class="ident" id="3120831">r</span>&nbsp;<span class="op" id="3120833">&amp;&amp;</span>&nbsp;<span class="ident" id="3120836">r</span>&nbsp;<span class="op" id="3120838">&lt;=</span>&nbsp;<span class="string" id="3120841">&#39;\u200a&#39;</span>&nbsp;<span class="op" id="3120850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3120854">return</span>&nbsp;<span class="ident" id="3120861">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3120867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3120870">switch</span>&nbsp;<span class="ident" id="3120877">r</span>&nbsp;<span class="op" id="3120879">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3120882">case</span>&nbsp;<span class="string" id="3120887">&#39;\u1680&#39;</span><span class="op" id="3120895">,</span>&nbsp;<span class="string" id="3120897">&#39;\u2028&#39;</span><span class="op" id="3120905">,</span>&nbsp;<span class="string" id="3120907">&#39;\u2029&#39;</span><span class="op" id="3120915">,</span>&nbsp;<span class="string" id="3120917">&#39;\u202f&#39;</span><span class="op" id="3120925">,</span>&nbsp;<span class="string" id="3120927">&#39;\u205f&#39;</span><span class="op" id="3120935">,</span>&nbsp;<span class="string" id="3120937">&#39;\u3000&#39;</span><span class="op" id="3120945">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3120949">return</span>&nbsp;<span class="ident" id="3120956">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3120962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3120965">return</span>&nbsp;<span class="ident" id="3120972">false</span><br>
<span class="lineno"></span><span class="op" id="3120978">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="comment" id="3120981">//&nbsp;ScanWords&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each</span><br>
<span class="lineno"></span><span class="comment" id="3121046">//&nbsp;space-separated&nbsp;word&nbsp;of&nbsp;text,&nbsp;with&nbsp;surrounding&nbsp;spaces&nbsp;deleted.&nbsp;It&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="3121120">//&nbsp;never&nbsp;return&nbsp;an&nbsp;empty&nbsp;string.&nbsp;The&nbsp;definition&nbsp;of&nbsp;space&nbsp;is&nbsp;set&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3121187">//&nbsp;unicode.IsSpace.</span><br>
<span class="lineno">335</span><span class="keyword" id="3121207">func</span>&nbsp;<span class="ident" id="3121212">ScanWords</span><span class="op" id="3121221">(</span><span class="ident" id="3121222">data</span>&nbsp;<span class="op" id="3121227">[</span><span class="op" id="3121228">]</span><span class="builtintype" id="3121229">byte</span><span class="op" id="3121233">,</span>&nbsp;<span class="ident" id="3121235">atEOF</span>&nbsp;<span class="builtintype" id="3121241">bool</span><span class="op" id="3121245">)</span>&nbsp;<span class="op" id="3121247">(</span><span class="ident" id="3121248">advance</span>&nbsp;<span class="builtintype" id="3121256">int</span><span class="op" id="3121259">,</span>&nbsp;<span class="ident" id="3121261">token</span>&nbsp;<span class="op" id="3121267">[</span><span class="op" id="3121268">]</span><span class="builtintype" id="3121269">byte</span><span class="op" id="3121273">,</span>&nbsp;<span class="ident" id="3121275">err</span>&nbsp;<span class="builtintype" id="3121279">error</span><span class="op" id="3121284">)</span>&nbsp;<span class="op" id="3121286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3121289">//&nbsp;Skip&nbsp;leading&nbsp;spaces.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3121314">start</span>&nbsp;<span class="op" id="3121320">:=</span>&nbsp;<span class="num" id="3121323">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121326">for</span>&nbsp;<span class="ident" id="3121330">width</span>&nbsp;<span class="op" id="3121336">:=</span>&nbsp;<span class="num" id="3121339">0</span><span class="op" id="3121340">;</span>&nbsp;<span class="ident" id="3121342">start</span>&nbsp;<span class="op" id="3121348">&lt;</span>&nbsp;<span class="builtinfunc" id="3121350">len</span><span class="op" id="3121353">(</span><span class="ident" id="3121354">data</span><span class="op" id="3121358">)</span><span class="op" id="3121359">;</span>&nbsp;<span class="ident" id="3121361">start</span>&nbsp;<span class="op" id="3121367">+=</span>&nbsp;<span class="ident" id="3121370">width</span>&nbsp;<span class="op" id="3121376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121380">var</span>&nbsp;<span class="ident" id="3121384">r</span>&nbsp;<span class="builtintype" id="3121386">rune</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3121393">r</span><span class="op" id="3121394">,</span>&nbsp;<span class="ident" id="3121396">width</span>&nbsp;<span class="op" id="3121402">=</span>&nbsp;<span class="ident" id="3121404">utf8</span><span class="op" id="3121408">.</span><span class="ident" id="3121409">DecodeRune</span><span class="op" id="3121419">(</span><span class="ident" id="3121420">data</span><span class="op" id="3121424">[</span><span class="ident" id="3121425">start</span><span class="op" id="3121430">:</span><span class="op" id="3121431">]</span><span class="op" id="3121432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121436">if</span>&nbsp;<span class="op" id="3121439">!</span><span class="ident" id="3121440">isSpace</span><span class="op" id="3121447">(</span><span class="ident" id="3121448">r</span><span class="op" id="3121449">)</span>&nbsp;<span class="op" id="3121451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121456">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3121464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3121467">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3121470">//&nbsp;Scan&nbsp;until&nbsp;space,&nbsp;marking&nbsp;end&nbsp;of&nbsp;word.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121513">for</span>&nbsp;<span class="ident" id="3121517">width</span><span class="op" id="3121522">,</span>&nbsp;<span class="ident" id="3121524">i</span>&nbsp;<span class="op" id="3121526">:=</span>&nbsp;<span class="num" id="3121529">0</span><span class="op" id="3121530">,</span>&nbsp;<span class="ident" id="3121532">start</span><span class="op" id="3121537">;</span>&nbsp;<span class="ident" id="3121539">i</span>&nbsp;<span class="op" id="3121541">&lt;</span>&nbsp;<span class="builtinfunc" id="3121543">len</span><span class="op" id="3121546">(</span><span class="ident" id="3121547">data</span><span class="op" id="3121551">)</span><span class="op" id="3121552">;</span>&nbsp;<span class="ident" id="3121554">i</span>&nbsp;<span class="op" id="3121556">+=</span>&nbsp;<span class="ident" id="3121559">width</span>&nbsp;<span class="op" id="3121565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121569">var</span>&nbsp;<span class="ident" id="3121573">r</span>&nbsp;<span class="builtintype" id="3121575">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3121582">r</span><span class="op" id="3121583">,</span>&nbsp;<span class="ident" id="3121585">width</span>&nbsp;<span class="op" id="3121591">=</span>&nbsp;<span class="ident" id="3121593">utf8</span><span class="op" id="3121597">.</span><span class="ident" id="3121598">DecodeRune</span><span class="op" id="3121608">(</span><span class="ident" id="3121609">data</span><span class="op" id="3121613">[</span><span class="ident" id="3121614">i</span><span class="op" id="3121615">:</span><span class="op" id="3121616">]</span><span class="op" id="3121617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121621">if</span>&nbsp;<span class="ident" id="3121624">isSpace</span><span class="op" id="3121631">(</span><span class="ident" id="3121632">r</span><span class="op" id="3121633">)</span>&nbsp;<span class="op" id="3121635">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121640">return</span>&nbsp;<span class="ident" id="3121647">i</span>&nbsp;<span class="op" id="3121649">+</span>&nbsp;<span class="ident" id="3121651">width</span><span class="op" id="3121656">,</span>&nbsp;<span class="ident" id="3121658">data</span><span class="op" id="3121662">[</span><span class="ident" id="3121663">start</span><span class="op" id="3121668">:</span><span class="ident" id="3121669">i</span><span class="op" id="3121670">]</span><span class="op" id="3121671">,</span>&nbsp;<span class="ident" id="3121673">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3121679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3121682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3121685">//&nbsp;If&nbsp;we&#39;re&nbsp;at&nbsp;EOF,&nbsp;we&nbsp;have&nbsp;a&nbsp;final,&nbsp;non-empty,&nbsp;non-terminated&nbsp;word.&nbsp;Return&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121766">if</span>&nbsp;<span class="ident" id="3121769">atEOF</span>&nbsp;<span class="op" id="3121775">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3121778">len</span><span class="op" id="3121781">(</span><span class="ident" id="3121782">data</span><span class="op" id="3121786">)</span>&nbsp;<span class="op" id="3121788">&gt;</span>&nbsp;<span class="ident" id="3121790">start</span>&nbsp;<span class="op" id="3121796">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121800">return</span>&nbsp;<span class="builtinfunc" id="3121807">len</span><span class="op" id="3121810">(</span><span class="ident" id="3121811">data</span><span class="op" id="3121815">)</span><span class="op" id="3121816">,</span>&nbsp;<span class="ident" id="3121818">data</span><span class="op" id="3121822">[</span><span class="ident" id="3121823">start</span><span class="op" id="3121828">:</span><span class="op" id="3121829">]</span><span class="op" id="3121830">,</span>&nbsp;<span class="ident" id="3121832">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3121837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3121840">//&nbsp;Request&nbsp;more&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3121863">return</span>&nbsp;<span class="ident" id="3121870">start</span><span class="op" id="3121875">,</span>&nbsp;<span class="ident" id="3121877">nil</span><span class="op" id="3121880">,</span>&nbsp;<span class="ident" id="3121882">nil</span><br>
<span class="lineno"></span><span class="op" id="3121886">}</span>
</div>
</body>
</html>
