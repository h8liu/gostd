<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/build</h2>
<ul>
<li><a href="/gostd/go/build/build.go.html">build.go</a></li>
<li><a href="/gostd/go/build/build_test.go.html">build_test.go</a></li>
<li><a href="/gostd/go/build/deps_test.go.html">deps_test.go</a></li>
<li><a href="/gostd/go/build/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/build/read.go.html" class="current">read.go</a></li>
<li><a href="/gostd/go/build/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/go/build/syslist.go.html">syslist.go</a></li>
<li><a href="/gostd/go/build/syslist_test.go.html">syslist_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3183690">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3183746">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3183800">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3183851">package</span>&nbsp;<span class="ident" id="3183859">build</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3183866">import</span>&nbsp;<span class="op" id="3183873">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3183876">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3183885">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3183895">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="3183900">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3183903">type</span>&nbsp;<span class="ident" id="3183908">importReader</span>&nbsp;<span class="keyword" id="3183921">struct</span>&nbsp;<span class="op" id="3183928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3183931">b</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3183936">*</span><span class="ident" id="3183937">bufio</span><span class="op" id="3183942">.</span><span class="ident" id="3183943">Reader</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3183951">buf</span>&nbsp;&nbsp;<span class="op" id="3183956">[</span><span class="op" id="3183957">]</span><span class="builtintype" id="3183958">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3183964">peek</span>&nbsp;<span class="builtintype" id="3183969">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3183975">err</span>&nbsp;&nbsp;<span class="builtintype" id="3183980">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3183987">eof</span>&nbsp;&nbsp;<span class="builtintype" id="3183992">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3183998">nerr</span>&nbsp;<span class="builtintype" id="3184003">int</span><br>
<span class="lineno">20</span><span class="op" id="3184007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3184010">func</span>&nbsp;<span class="ident" id="3184015">isIdent</span><span class="op" id="3184022">(</span><span class="ident" id="3184023">c</span>&nbsp;<span class="builtintype" id="3184025">byte</span><span class="op" id="3184029">)</span>&nbsp;<span class="builtintype" id="3184031">bool</span>&nbsp;<span class="op" id="3184036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3184039">return</span>&nbsp;<span class="string" id="3184046">&#39;A&#39;</span>&nbsp;<span class="op" id="3184050">&lt;=</span>&nbsp;<span class="ident" id="3184053">c</span>&nbsp;<span class="op" id="3184055">&amp;&amp;</span>&nbsp;<span class="ident" id="3184058">c</span>&nbsp;<span class="op" id="3184060">&lt;=</span>&nbsp;<span class="string" id="3184063">&#39;Z&#39;</span>&nbsp;<span class="op" id="3184067">||</span>&nbsp;<span class="string" id="3184070">&#39;a&#39;</span>&nbsp;<span class="op" id="3184074">&lt;=</span>&nbsp;<span class="ident" id="3184077">c</span>&nbsp;<span class="op" id="3184079">&amp;&amp;</span>&nbsp;<span class="ident" id="3184082">c</span>&nbsp;<span class="op" id="3184084">&lt;=</span>&nbsp;<span class="string" id="3184087">&#39;z&#39;</span>&nbsp;<span class="op" id="3184091">||</span>&nbsp;<span class="string" id="3184094">&#39;0&#39;</span>&nbsp;<span class="op" id="3184098">&lt;=</span>&nbsp;<span class="ident" id="3184101">c</span>&nbsp;<span class="op" id="3184103">&amp;&amp;</span>&nbsp;<span class="ident" id="3184106">c</span>&nbsp;<span class="op" id="3184108">&lt;=</span>&nbsp;<span class="string" id="3184111">&#39;9&#39;</span>&nbsp;<span class="op" id="3184115">||</span>&nbsp;<span class="ident" id="3184118">c</span>&nbsp;<span class="op" id="3184120">==</span>&nbsp;<span class="string" id="3184123">&#39;_&#39;</span>&nbsp;<span class="op" id="3184127">||</span>&nbsp;<span class="ident" id="3184130">c</span>&nbsp;<span class="op" id="3184132">&gt;=</span>&nbsp;<span class="num" id="3184135">0x80</span><br>
<span class="lineno"></span><span class="op" id="3184140">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="3184143">var</span>&nbsp;<span class="op" id="3184147">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3184150">errSyntax</span>&nbsp;<span class="op" id="3184160">=</span>&nbsp;<span class="ident" id="3184162">errors</span><span class="op" id="3184168">.</span><span class="ident" id="3184169">New</span><span class="op" id="3184172">(</span><span class="string" id="3184173">&#34;syntax&nbsp;error&#34;</span><span class="op" id="3184187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3184190">errNUL</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3184200">=</span>&nbsp;<span class="ident" id="3184202">errors</span><span class="op" id="3184208">.</span><span class="ident" id="3184209">New</span><span class="op" id="3184212">(</span><span class="string" id="3184213">&#34;unexpected&nbsp;NUL&nbsp;in&nbsp;input&#34;</span><span class="op" id="3184238">)</span><br>
<span class="lineno"></span><span class="op" id="3184240">)</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="3184243">//&nbsp;syntaxError&nbsp;records&nbsp;a&nbsp;syntax&nbsp;error,&nbsp;but&nbsp;only&nbsp;if&nbsp;an&nbsp;I/O&nbsp;error&nbsp;has&nbsp;not&nbsp;already&nbsp;been&nbsp;recorded.</span><br>
<span class="lineno"></span><span class="keyword" id="3184338">func</span>&nbsp;<span class="op" id="3184343">(</span><span class="ident" id="3184344">r</span>&nbsp;<span class="op" id="3184346">*</span><span class="ident" id="3184347">importReader</span><span class="op" id="3184359">)</span>&nbsp;<span class="ident" id="3184361">syntaxError</span><span class="op" id="3184372">(</span><span class="op" id="3184373">)</span>&nbsp;<span class="op" id="3184375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3184378">if</span>&nbsp;<span class="ident" id="3184381">r</span><span class="op" id="3184382">.</span><span class="ident" id="3184383">err</span>&nbsp;<span class="op" id="3184387">==</span>&nbsp;<span class="builtintype" id="3184390">nil</span>&nbsp;<span class="op" id="3184394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3184398">r</span><span class="op" id="3184399">.</span><span class="ident" id="3184400">err</span>&nbsp;<span class="op" id="3184404">=</span>&nbsp;<span class="ident" id="3184406">errSyntax</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3184417">}</span><br>
<span class="lineno"></span><span class="op" id="3184419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3184422">//&nbsp;readByte&nbsp;reads&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input,&nbsp;saves&nbsp;it&nbsp;in&nbsp;buf,&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="3184503">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;readByte&nbsp;records&nbsp;the&nbsp;error&nbsp;in&nbsp;r.err&nbsp;and&nbsp;returns&nbsp;0.</span><br>
<span class="lineno">40</span><span class="keyword" id="3184577">func</span>&nbsp;<span class="op" id="3184582">(</span><span class="ident" id="3184583">r</span>&nbsp;<span class="op" id="3184585">*</span><span class="ident" id="3184586">importReader</span><span class="op" id="3184598">)</span>&nbsp;<span class="ident" id="3184600">readByte</span><span class="op" id="3184608">(</span><span class="op" id="3184609">)</span>&nbsp;<span class="builtintype" id="3184611">byte</span>&nbsp;<span class="op" id="3184616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3184619">c</span><span class="op" id="3184620">,</span>&nbsp;<span class="ident" id="3184622">err</span>&nbsp;<span class="op" id="3184626">:=</span>&nbsp;<span class="ident" id="3184629">r</span><span class="op" id="3184630">.</span><span class="ident" id="3184631">b</span><span class="op" id="3184632">.</span><span class="ident" id="3184633">ReadByte</span><span class="op" id="3184641">(</span><span class="op" id="3184642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3184645">if</span>&nbsp;<span class="ident" id="3184648">err</span>&nbsp;<span class="op" id="3184652">==</span>&nbsp;<span class="builtintype" id="3184655">nil</span>&nbsp;<span class="op" id="3184659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3184663">r</span><span class="op" id="3184664">.</span><span class="ident" id="3184665">buf</span>&nbsp;<span class="op" id="3184669">=</span>&nbsp;<span class="builtinfunc" id="3184671">append</span><span class="op" id="3184677">(</span><span class="ident" id="3184678">r</span><span class="op" id="3184679">.</span><span class="ident" id="3184680">buf</span><span class="op" id="3184683">,</span>&nbsp;<span class="ident" id="3184685">c</span><span class="op" id="3184686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3184690">if</span>&nbsp;<span class="ident" id="3184693">c</span>&nbsp;<span class="op" id="3184695">==</span>&nbsp;<span class="num" id="3184698">0</span>&nbsp;<span class="op" id="3184700">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3184705">err</span>&nbsp;<span class="op" id="3184709">=</span>&nbsp;<span class="ident" id="3184711">errNUL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3184720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3184723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3184726">if</span>&nbsp;<span class="ident" id="3184729">err</span>&nbsp;<span class="op" id="3184733">!=</span>&nbsp;<span class="builtintype" id="3184736">nil</span>&nbsp;<span class="op" id="3184740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3184744">if</span>&nbsp;<span class="ident" id="3184747">err</span>&nbsp;<span class="op" id="3184751">==</span>&nbsp;<span class="ident" id="3184754">io</span><span class="op" id="3184756">.</span><span class="ident" id="3184757">EOF</span>&nbsp;<span class="op" id="3184761">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3184766">r</span><span class="op" id="3184767">.</span><span class="ident" id="3184768">eof</span>&nbsp;<span class="op" id="3184772">=</span>&nbsp;<span class="builtintype" id="3184774">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3184781">}</span>&nbsp;<span class="keyword" id="3184783">else</span>&nbsp;<span class="keyword" id="3184788">if</span>&nbsp;<span class="ident" id="3184791">r</span><span class="op" id="3184792">.</span><span class="ident" id="3184793">err</span>&nbsp;<span class="op" id="3184797">==</span>&nbsp;<span class="builtintype" id="3184800">nil</span>&nbsp;<span class="op" id="3184804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3184809">r</span><span class="op" id="3184810">.</span><span class="ident" id="3184811">err</span>&nbsp;<span class="op" id="3184815">=</span>&nbsp;<span class="ident" id="3184817">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3184823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3184827">c</span>&nbsp;<span class="op" id="3184829">=</span>&nbsp;<span class="num" id="3184831">0</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3184834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3184837">return</span>&nbsp;<span class="ident" id="3184844">c</span><br>
<span class="lineno"></span><span class="op" id="3184846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3184849">//&nbsp;peekByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input&nbsp;reader&nbsp;but&nbsp;does&nbsp;not&nbsp;advance&nbsp;beyond&nbsp;it.</span><br>
<span class="lineno">60</span><span class="comment" id="3184937">//&nbsp;If&nbsp;skipSpace&nbsp;is&nbsp;set,&nbsp;peekByte&nbsp;skips&nbsp;leading&nbsp;spaces&nbsp;and&nbsp;comments.</span><br>
<span class="lineno"></span><span class="keyword" id="3185005">func</span>&nbsp;<span class="op" id="3185010">(</span><span class="ident" id="3185011">r</span>&nbsp;<span class="op" id="3185013">*</span><span class="ident" id="3185014">importReader</span><span class="op" id="3185026">)</span>&nbsp;<span class="ident" id="3185028">peekByte</span><span class="op" id="3185036">(</span><span class="ident" id="3185037">skipSpace</span>&nbsp;<span class="builtintype" id="3185047">bool</span><span class="op" id="3185051">)</span>&nbsp;<span class="builtintype" id="3185053">byte</span>&nbsp;<span class="op" id="3185058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3185061">if</span>&nbsp;<span class="ident" id="3185064">r</span><span class="op" id="3185065">.</span><span class="ident" id="3185066">err</span>&nbsp;<span class="op" id="3185070">!=</span>&nbsp;<span class="builtintype" id="3185073">nil</span>&nbsp;<span class="op" id="3185077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3185081">if</span>&nbsp;<span class="ident" id="3185084">r</span><span class="op" id="3185085">.</span><span class="ident" id="3185086">nerr</span><span class="op" id="3185090">++</span><span class="op" id="3185092">;</span>&nbsp;<span class="ident" id="3185094">r</span><span class="op" id="3185095">.</span><span class="ident" id="3185096">nerr</span>&nbsp;<span class="op" id="3185101">&gt;</span>&nbsp;<span class="num" id="3185103">10000</span>&nbsp;<span class="op" id="3185109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3185114">panic</span><span class="op" id="3185119">(</span><span class="string" id="3185120">&#34;go/build:&nbsp;import&nbsp;reader&nbsp;looping&#34;</span><span class="op" id="3185153">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3185157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3185161">return</span>&nbsp;<span class="num" id="3185168">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3185171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3185175">//&nbsp;Use&nbsp;r.peek&nbsp;as&nbsp;first&nbsp;input&nbsp;byte.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3185211">//&nbsp;Don&#39;t&nbsp;just&nbsp;return&nbsp;r.peek&nbsp;here:&nbsp;it&nbsp;might&nbsp;have&nbsp;been&nbsp;left&nbsp;by&nbsp;peekByte(false)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3185289">//&nbsp;and&nbsp;this&nbsp;might&nbsp;be&nbsp;peekByte(true).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3185327">c</span>&nbsp;<span class="op" id="3185329">:=</span>&nbsp;<span class="ident" id="3185332">r</span><span class="op" id="3185333">.</span><span class="ident" id="3185334">peek</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3185340">if</span>&nbsp;<span class="ident" id="3185343">c</span>&nbsp;<span class="op" id="3185345">==</span>&nbsp;<span class="num" id="3185348">0</span>&nbsp;<span class="op" id="3185350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3185354">c</span>&nbsp;<span class="op" id="3185356">=</span>&nbsp;<span class="ident" id="3185358">r</span><span class="op" id="3185359">.</span><span class="ident" id="3185360">readByte</span><span class="op" id="3185368">(</span><span class="op" id="3185369">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3185372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3185375">for</span>&nbsp;<span class="ident" id="3185379">r</span><span class="op" id="3185380">.</span><span class="ident" id="3185381">err</span>&nbsp;<span class="op" id="3185385">==</span>&nbsp;<span class="builtintype" id="3185388">nil</span>&nbsp;<span class="op" id="3185392">&amp;&amp;</span>&nbsp;<span class="op" id="3185395">!</span><span class="ident" id="3185396">r</span><span class="op" id="3185397">.</span><span class="ident" id="3185398">eof</span>&nbsp;<span class="op" id="3185402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3185406">if</span>&nbsp;<span class="ident" id="3185409">skipSpace</span>&nbsp;<span class="op" id="3185419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3185424">//&nbsp;For&nbsp;the&nbsp;purposes&nbsp;of&nbsp;this&nbsp;reader,&nbsp;semicolons&nbsp;are&nbsp;never&nbsp;necessary&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3185497">//&nbsp;understand&nbsp;the&nbsp;input&nbsp;and&nbsp;are&nbsp;treated&nbsp;as&nbsp;spaces.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3185551">switch</span>&nbsp;<span class="ident" id="3185558">c</span>&nbsp;<span class="op" id="3185560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3185565">case</span>&nbsp;<span class="string" id="3185570">&#39;&nbsp;&#39;</span><span class="op" id="3185573">,</span>&nbsp;<span class="string" id="3185575">&#39;\f&#39;</span><span class="op" id="3185579">,</span>&nbsp;<span class="string" id="3185581">&#39;\t&#39;</span><span class="op" id="3185585">,</span>&nbsp;<span class="string" id="3185587">&#39;\r&#39;</span><span class="op" id="3185591">,</span>&nbsp;<span class="string" id="3185593">&#39;\n&#39;</span><span class="op" id="3185597">,</span>&nbsp;<span class="string" id="3185599">&#39;;&#39;</span><span class="op" id="3185602">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3185608">c</span>&nbsp;<span class="op" id="3185610">=</span>&nbsp;<span class="ident" id="3185612">r</span><span class="op" id="3185613">.</span><span class="ident" id="3185614">readByte</span><span class="op" id="3185622">(</span><span class="op" id="3185623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3185629">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3185642">case</span>&nbsp;<span class="string" id="3185647">&#39;/&#39;</span><span class="op" id="3185650">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3185656">c</span>&nbsp;<span class="op" id="3185658">=</span>&nbsp;<span class="ident" id="3185660">r</span><span class="op" id="3185661">.</span><span class="ident" id="3185662">readByte</span><span class="op" id="3185670">(</span><span class="op" id="3185671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3185677">if</span>&nbsp;<span class="ident" id="3185680">c</span>&nbsp;<span class="op" id="3185682">==</span>&nbsp;<span class="string" id="3185685">&#39;/&#39;</span>&nbsp;<span class="op" id="3185689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3185696">for</span>&nbsp;<span class="ident" id="3185700">c</span>&nbsp;<span class="op" id="3185702">!=</span>&nbsp;<span class="string" id="3185705">&#39;\n&#39;</span>&nbsp;<span class="op" id="3185710">&amp;&amp;</span>&nbsp;<span class="ident" id="3185713">r</span><span class="op" id="3185714">.</span><span class="ident" id="3185715">err</span>&nbsp;<span class="op" id="3185719">==</span>&nbsp;<span class="builtintype" id="3185722">nil</span>&nbsp;<span class="op" id="3185726">&amp;&amp;</span>&nbsp;<span class="op" id="3185729">!</span><span class="ident" id="3185730">r</span><span class="op" id="3185731">.</span><span class="ident" id="3185732">eof</span>&nbsp;<span class="op" id="3185736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3185744">c</span>&nbsp;<span class="op" id="3185746">=</span>&nbsp;<span class="ident" id="3185748">r</span><span class="op" id="3185749">.</span><span class="ident" id="3185750">readByte</span><span class="op" id="3185758">(</span><span class="op" id="3185759">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3185766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3185772">}</span>&nbsp;<span class="keyword" id="3185774">else</span>&nbsp;<span class="keyword" id="3185779">if</span>&nbsp;<span class="ident" id="3185782">c</span>&nbsp;<span class="op" id="3185784">==</span>&nbsp;<span class="string" id="3185787">&#39;*&#39;</span>&nbsp;<span class="op" id="3185791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3185798">var</span>&nbsp;<span class="ident" id="3185802">c1</span>&nbsp;<span class="builtintype" id="3185805">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3185815">for</span>&nbsp;<span class="op" id="3185819">(</span><span class="ident" id="3185820">c</span>&nbsp;<span class="op" id="3185822">!=</span>&nbsp;<span class="string" id="3185825">&#39;*&#39;</span>&nbsp;<span class="op" id="3185829">||</span>&nbsp;<span class="ident" id="3185832">c1</span>&nbsp;<span class="op" id="3185835">!=</span>&nbsp;<span class="string" id="3185838">&#39;/&#39;</span><span class="op" id="3185841">)</span>&nbsp;<span class="op" id="3185843">&amp;&amp;</span>&nbsp;<span class="ident" id="3185846">r</span><span class="op" id="3185847">.</span><span class="ident" id="3185848">err</span>&nbsp;<span class="op" id="3185852">==</span>&nbsp;<span class="builtintype" id="3185855">nil</span>&nbsp;<span class="op" id="3185859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3185867">if</span>&nbsp;<span class="ident" id="3185870">r</span><span class="op" id="3185871">.</span><span class="ident" id="3185872">eof</span>&nbsp;<span class="op" id="3185876">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3185885">r</span><span class="op" id="3185886">.</span><span class="ident" id="3185887">syntaxError</span><span class="op" id="3185898">(</span><span class="op" id="3185899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3185907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3185915">c</span><span class="op" id="3185916">,</span>&nbsp;<span class="ident" id="3185918">c1</span>&nbsp;<span class="op" id="3185921">=</span>&nbsp;<span class="ident" id="3185923">c1</span><span class="op" id="3185925">,</span>&nbsp;<span class="ident" id="3185927">r</span><span class="op" id="3185928">.</span><span class="ident" id="3185929">readByte</span><span class="op" id="3185937">(</span><span class="op" id="3185938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3185945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3185951">}</span>&nbsp;<span class="keyword" id="3185953">else</span>&nbsp;<span class="op" id="3185958">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3185965">r</span><span class="op" id="3185966">.</span><span class="ident" id="3185967">syntaxError</span><span class="op" id="3185978">(</span><span class="op" id="3185979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3185985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3185991">c</span>&nbsp;<span class="op" id="3185993">=</span>&nbsp;<span class="ident" id="3185995">r</span><span class="op" id="3185996">.</span><span class="ident" id="3185997">readByte</span><span class="op" id="3186005">(</span><span class="op" id="3186006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3186012">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3186024">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3186028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3186032">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3186039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3186042">r</span><span class="op" id="3186043">.</span><span class="ident" id="3186044">peek</span>&nbsp;<span class="op" id="3186049">=</span>&nbsp;<span class="ident" id="3186051">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3186054">return</span>&nbsp;<span class="ident" id="3186061">r</span><span class="op" id="3186062">.</span><span class="ident" id="3186063">peek</span><br>
<span class="lineno">110</span><span class="op" id="3186068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3186071">//&nbsp;nextByte&nbsp;is&nbsp;like&nbsp;peekByte&nbsp;but&nbsp;advances&nbsp;beyond&nbsp;the&nbsp;returned&nbsp;byte.</span><br>
<span class="lineno"></span><span class="keyword" id="3186139">func</span>&nbsp;<span class="op" id="3186144">(</span><span class="ident" id="3186145">r</span>&nbsp;<span class="op" id="3186147">*</span><span class="ident" id="3186148">importReader</span><span class="op" id="3186160">)</span>&nbsp;<span class="ident" id="3186162">nextByte</span><span class="op" id="3186170">(</span><span class="ident" id="3186171">skipSpace</span>&nbsp;<span class="builtintype" id="3186181">bool</span><span class="op" id="3186185">)</span>&nbsp;<span class="builtintype" id="3186187">byte</span>&nbsp;<span class="op" id="3186192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3186195">c</span>&nbsp;<span class="op" id="3186197">:=</span>&nbsp;<span class="ident" id="3186200">r</span><span class="op" id="3186201">.</span><span class="ident" id="3186202">peekByte</span><span class="op" id="3186210">(</span><span class="ident" id="3186211">skipSpace</span><span class="op" id="3186220">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3186223">r</span><span class="op" id="3186224">.</span><span class="ident" id="3186225">peek</span>&nbsp;<span class="op" id="3186230">=</span>&nbsp;<span class="num" id="3186232">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3186235">return</span>&nbsp;<span class="ident" id="3186242">c</span><br>
<span class="lineno"></span><span class="op" id="3186244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3186247">//&nbsp;readKeyword&nbsp;reads&nbsp;the&nbsp;given&nbsp;keyword&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">120</span><span class="comment" id="3186302">//&nbsp;If&nbsp;the&nbsp;keyword&nbsp;is&nbsp;not&nbsp;present,&nbsp;readKeyword&nbsp;records&nbsp;a&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3186372">func</span>&nbsp;<span class="op" id="3186377">(</span><span class="ident" id="3186378">r</span>&nbsp;<span class="op" id="3186380">*</span><span class="ident" id="3186381">importReader</span><span class="op" id="3186393">)</span>&nbsp;<span class="ident" id="3186395">readKeyword</span><span class="op" id="3186406">(</span><span class="ident" id="3186407">kw</span>&nbsp;<span class="builtintype" id="3186410">string</span><span class="op" id="3186416">)</span>&nbsp;<span class="op" id="3186418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3186421">r</span><span class="op" id="3186422">.</span><span class="ident" id="3186423">peekByte</span><span class="op" id="3186431">(</span><span class="builtintype" id="3186432">true</span><span class="op" id="3186436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3186439">for</span>&nbsp;<span class="ident" id="3186443">i</span>&nbsp;<span class="op" id="3186445">:=</span>&nbsp;<span class="num" id="3186448">0</span><span class="op" id="3186449">;</span>&nbsp;<span class="ident" id="3186451">i</span>&nbsp;<span class="op" id="3186453">&lt;</span>&nbsp;<span class="builtinfunc" id="3186455">len</span><span class="op" id="3186458">(</span><span class="ident" id="3186459">kw</span><span class="op" id="3186461">)</span><span class="op" id="3186462">;</span>&nbsp;<span class="ident" id="3186464">i</span><span class="op" id="3186465">++</span>&nbsp;<span class="op" id="3186468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3186472">if</span>&nbsp;<span class="ident" id="3186475">r</span><span class="op" id="3186476">.</span><span class="ident" id="3186477">nextByte</span><span class="op" id="3186485">(</span><span class="builtintype" id="3186486">false</span><span class="op" id="3186491">)</span>&nbsp;<span class="op" id="3186493">!=</span>&nbsp;<span class="ident" id="3186496">kw</span><span class="op" id="3186498">[</span><span class="ident" id="3186499">i</span><span class="op" id="3186500">]</span>&nbsp;<span class="op" id="3186502">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3186507">r</span><span class="op" id="3186508">.</span><span class="ident" id="3186509">syntaxError</span><span class="op" id="3186520">(</span><span class="op" id="3186521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3186526">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3186535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3186538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3186541">if</span>&nbsp;<span class="ident" id="3186544">isIdent</span><span class="op" id="3186551">(</span><span class="ident" id="3186552">r</span><span class="op" id="3186553">.</span><span class="ident" id="3186554">peekByte</span><span class="op" id="3186562">(</span><span class="builtintype" id="3186563">false</span><span class="op" id="3186568">)</span><span class="op" id="3186569">)</span>&nbsp;<span class="op" id="3186571">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3186575">r</span><span class="op" id="3186576">.</span><span class="ident" id="3186577">syntaxError</span><span class="op" id="3186588">(</span><span class="op" id="3186589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3186592">}</span><br>
<span class="lineno"></span><span class="op" id="3186594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3186597">//&nbsp;readIdent&nbsp;reads&nbsp;an&nbsp;identifier&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">135</span><span class="comment" id="3186646">//&nbsp;If&nbsp;an&nbsp;identifier&nbsp;is&nbsp;not&nbsp;present,&nbsp;readIdent&nbsp;records&nbsp;a&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3186716">func</span>&nbsp;<span class="op" id="3186721">(</span><span class="ident" id="3186722">r</span>&nbsp;<span class="op" id="3186724">*</span><span class="ident" id="3186725">importReader</span><span class="op" id="3186737">)</span>&nbsp;<span class="ident" id="3186739">readIdent</span><span class="op" id="3186748">(</span><span class="op" id="3186749">)</span>&nbsp;<span class="op" id="3186751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3186754">c</span>&nbsp;<span class="op" id="3186756">:=</span>&nbsp;<span class="ident" id="3186759">r</span><span class="op" id="3186760">.</span><span class="ident" id="3186761">peekByte</span><span class="op" id="3186769">(</span><span class="builtintype" id="3186770">true</span><span class="op" id="3186774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3186777">if</span>&nbsp;<span class="op" id="3186780">!</span><span class="ident" id="3186781">isIdent</span><span class="op" id="3186788">(</span><span class="ident" id="3186789">c</span><span class="op" id="3186790">)</span>&nbsp;<span class="op" id="3186792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3186796">r</span><span class="op" id="3186797">.</span><span class="ident" id="3186798">syntaxError</span><span class="op" id="3186809">(</span><span class="op" id="3186810">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3186814">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3186822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3186825">for</span>&nbsp;<span class="ident" id="3186829">isIdent</span><span class="op" id="3186836">(</span><span class="ident" id="3186837">r</span><span class="op" id="3186838">.</span><span class="ident" id="3186839">peekByte</span><span class="op" id="3186847">(</span><span class="builtintype" id="3186848">false</span><span class="op" id="3186853">)</span><span class="op" id="3186854">)</span>&nbsp;<span class="op" id="3186856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3186860">r</span><span class="op" id="3186861">.</span><span class="ident" id="3186862">peek</span>&nbsp;<span class="op" id="3186867">=</span>&nbsp;<span class="num" id="3186869">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3186872">}</span><br>
<span class="lineno">145</span><span class="op" id="3186874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3186877">//&nbsp;readString&nbsp;reads&nbsp;a&nbsp;quoted&nbsp;string&nbsp;literal&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="3186937">//&nbsp;If&nbsp;an&nbsp;identifier&nbsp;is&nbsp;not&nbsp;present,&nbsp;readString&nbsp;records&nbsp;a&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3187008">func</span>&nbsp;<span class="op" id="3187013">(</span><span class="ident" id="3187014">r</span>&nbsp;<span class="op" id="3187016">*</span><span class="ident" id="3187017">importReader</span><span class="op" id="3187029">)</span>&nbsp;<span class="ident" id="3187031">readString</span><span class="op" id="3187041">(</span><span class="op" id="3187042">)</span>&nbsp;<span class="op" id="3187044">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187047">switch</span>&nbsp;<span class="ident" id="3187054">r</span><span class="op" id="3187055">.</span><span class="ident" id="3187056">nextByte</span><span class="op" id="3187064">(</span><span class="builtintype" id="3187065">true</span><span class="op" id="3187069">)</span>&nbsp;<span class="op" id="3187071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187074">case</span>&nbsp;<span class="string" id="3187079">&#39;`&#39;</span><span class="op" id="3187082">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187086">for</span>&nbsp;<span class="ident" id="3187090">r</span><span class="op" id="3187091">.</span><span class="ident" id="3187092">err</span>&nbsp;<span class="op" id="3187096">==</span>&nbsp;<span class="builtintype" id="3187099">nil</span>&nbsp;<span class="op" id="3187103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187108">if</span>&nbsp;<span class="ident" id="3187111">r</span><span class="op" id="3187112">.</span><span class="ident" id="3187113">nextByte</span><span class="op" id="3187121">(</span><span class="builtintype" id="3187122">false</span><span class="op" id="3187127">)</span>&nbsp;<span class="op" id="3187129">==</span>&nbsp;<span class="string" id="3187132">&#39;`&#39;</span>&nbsp;<span class="op" id="3187136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187142">break</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3187151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187156">if</span>&nbsp;<span class="ident" id="3187159">r</span><span class="op" id="3187160">.</span><span class="ident" id="3187161">eof</span>&nbsp;<span class="op" id="3187165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3187171">r</span><span class="op" id="3187172">.</span><span class="ident" id="3187173">syntaxError</span><span class="op" id="3187184">(</span><span class="op" id="3187185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3187190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3187194">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187197">case</span>&nbsp;<span class="string" id="3187202">&#39;&#34;&#39;</span><span class="op" id="3187205">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187209">for</span>&nbsp;<span class="ident" id="3187213">r</span><span class="op" id="3187214">.</span><span class="ident" id="3187215">err</span>&nbsp;<span class="op" id="3187219">==</span>&nbsp;<span class="builtintype" id="3187222">nil</span>&nbsp;<span class="op" id="3187226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3187231">c</span>&nbsp;<span class="op" id="3187233">:=</span>&nbsp;<span class="ident" id="3187236">r</span><span class="op" id="3187237">.</span><span class="ident" id="3187238">nextByte</span><span class="op" id="3187246">(</span><span class="builtintype" id="3187247">false</span><span class="op" id="3187252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187257">if</span>&nbsp;<span class="ident" id="3187260">c</span>&nbsp;<span class="op" id="3187262">==</span>&nbsp;<span class="string" id="3187265">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3187269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187275">break</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3187284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187289">if</span>&nbsp;<span class="ident" id="3187292">r</span><span class="op" id="3187293">.</span><span class="ident" id="3187294">eof</span>&nbsp;<span class="op" id="3187298">||</span>&nbsp;<span class="ident" id="3187301">c</span>&nbsp;<span class="op" id="3187303">==</span>&nbsp;<span class="string" id="3187306">&#39;\n&#39;</span>&nbsp;<span class="op" id="3187311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3187317">r</span><span class="op" id="3187318">.</span><span class="ident" id="3187319">syntaxError</span><span class="op" id="3187330">(</span><span class="op" id="3187331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3187336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187341">if</span>&nbsp;<span class="ident" id="3187344">c</span>&nbsp;<span class="op" id="3187346">==</span>&nbsp;<span class="string" id="3187349">&#39;\\&#39;</span>&nbsp;<span class="op" id="3187354">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3187360">r</span><span class="op" id="3187361">.</span><span class="ident" id="3187362">nextByte</span><span class="op" id="3187370">(</span><span class="builtintype" id="3187371">false</span><span class="op" id="3187376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3187381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3187385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187388">default</span><span class="op" id="3187395">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3187399">r</span><span class="op" id="3187400">.</span><span class="ident" id="3187401">syntaxError</span><span class="op" id="3187412">(</span><span class="op" id="3187413">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3187416">}</span><br>
<span class="lineno"></span><span class="op" id="3187418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3187421">//&nbsp;readImport&nbsp;reads&nbsp;an&nbsp;import&nbsp;clause&nbsp;-&nbsp;optional&nbsp;identifier&nbsp;followed&nbsp;by&nbsp;quoted&nbsp;string&nbsp;-</span><br>
<span class="lineno"></span><span class="comment" id="3187508">//&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">180</span><span class="keyword" id="3187527">func</span>&nbsp;<span class="op" id="3187532">(</span><span class="ident" id="3187533">r</span>&nbsp;<span class="op" id="3187535">*</span><span class="ident" id="3187536">importReader</span><span class="op" id="3187548">)</span>&nbsp;<span class="ident" id="3187550">readImport</span><span class="op" id="3187560">(</span><span class="op" id="3187561">)</span>&nbsp;<span class="op" id="3187563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3187566">c</span>&nbsp;<span class="op" id="3187568">:=</span>&nbsp;<span class="ident" id="3187571">r</span><span class="op" id="3187572">.</span><span class="ident" id="3187573">peekByte</span><span class="op" id="3187581">(</span><span class="builtintype" id="3187582">true</span><span class="op" id="3187586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187589">if</span>&nbsp;<span class="ident" id="3187592">c</span>&nbsp;<span class="op" id="3187594">==</span>&nbsp;<span class="string" id="3187597">&#39;.&#39;</span>&nbsp;<span class="op" id="3187601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3187605">r</span><span class="op" id="3187606">.</span><span class="ident" id="3187607">peek</span>&nbsp;<span class="op" id="3187612">=</span>&nbsp;<span class="num" id="3187614">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3187617">}</span>&nbsp;<span class="keyword" id="3187619">else</span>&nbsp;<span class="keyword" id="3187624">if</span>&nbsp;<span class="ident" id="3187627">isIdent</span><span class="op" id="3187634">(</span><span class="ident" id="3187635">c</span><span class="op" id="3187636">)</span>&nbsp;<span class="op" id="3187638">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3187642">r</span><span class="op" id="3187643">.</span><span class="ident" id="3187644">readIdent</span><span class="op" id="3187653">(</span><span class="op" id="3187654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3187657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3187660">r</span><span class="op" id="3187661">.</span><span class="ident" id="3187662">readString</span><span class="op" id="3187672">(</span><span class="op" id="3187673">)</span><br>
<span class="lineno"></span><span class="op" id="3187675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="3187678">//&nbsp;readComments&nbsp;is&nbsp;like&nbsp;ioutil.ReadAll,&nbsp;except&nbsp;that&nbsp;it&nbsp;only&nbsp;reads&nbsp;the&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="3187756">//&nbsp;block&nbsp;of&nbsp;comments&nbsp;in&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="3187790">func</span>&nbsp;<span class="ident" id="3187795">readComments</span><span class="op" id="3187807">(</span><span class="ident" id="3187808">f</span>&nbsp;<span class="ident" id="3187810">io</span><span class="op" id="3187812">.</span><span class="ident" id="3187813">Reader</span><span class="op" id="3187819">)</span>&nbsp;<span class="op" id="3187821">(</span><span class="op" id="3187822">[</span><span class="op" id="3187823">]</span><span class="builtintype" id="3187824">byte</span><span class="op" id="3187828">,</span>&nbsp;<span class="builtintype" id="3187830">error</span><span class="op" id="3187835">)</span>&nbsp;<span class="op" id="3187837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3187840">r</span>&nbsp;<span class="op" id="3187842">:=</span>&nbsp;<span class="op" id="3187845">&amp;</span><span class="ident" id="3187846">importReader</span><span class="op" id="3187858">{</span><span class="ident" id="3187859">b</span><span class="op" id="3187860">:</span>&nbsp;<span class="ident" id="3187862">bufio</span><span class="op" id="3187867">.</span><span class="ident" id="3187868">NewReader</span><span class="op" id="3187877">(</span><span class="ident" id="3187878">f</span><span class="op" id="3187879">)</span><span class="op" id="3187880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3187883">r</span><span class="op" id="3187884">.</span><span class="ident" id="3187885">peekByte</span><span class="op" id="3187893">(</span><span class="builtintype" id="3187894">true</span><span class="op" id="3187898">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187901">if</span>&nbsp;<span class="ident" id="3187904">r</span><span class="op" id="3187905">.</span><span class="ident" id="3187906">err</span>&nbsp;<span class="op" id="3187910">==</span>&nbsp;<span class="builtintype" id="3187913">nil</span>&nbsp;<span class="op" id="3187917">&amp;&amp;</span>&nbsp;<span class="op" id="3187920">!</span><span class="ident" id="3187921">r</span><span class="op" id="3187922">.</span><span class="ident" id="3187923">eof</span>&nbsp;<span class="op" id="3187927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3187931">//&nbsp;Didn&#39;t&nbsp;reach&nbsp;EOF,&nbsp;so&nbsp;must&nbsp;have&nbsp;found&nbsp;a&nbsp;non-space&nbsp;byte.&nbsp;Remove&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188002">r</span><span class="op" id="3188003">.</span><span class="ident" id="3188004">buf</span>&nbsp;<span class="op" id="3188008">=</span>&nbsp;<span class="ident" id="3188010">r</span><span class="op" id="3188011">.</span><span class="ident" id="3188012">buf</span><span class="op" id="3188015">[</span><span class="op" id="3188016">:</span><span class="builtinfunc" id="3188017">len</span><span class="op" id="3188020">(</span><span class="ident" id="3188021">r</span><span class="op" id="3188022">.</span><span class="ident" id="3188023">buf</span><span class="op" id="3188026">)</span><span class="op" id="3188027">-</span><span class="num" id="3188028">1</span><span class="op" id="3188029">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3188032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3188035">return</span>&nbsp;<span class="ident" id="3188042">r</span><span class="op" id="3188043">.</span><span class="ident" id="3188044">buf</span><span class="op" id="3188047">,</span>&nbsp;<span class="ident" id="3188049">r</span><span class="op" id="3188050">.</span><span class="ident" id="3188051">err</span><br>
<span class="lineno">200</span><span class="op" id="3188055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3188058">//&nbsp;readImports&nbsp;is&nbsp;like&nbsp;ioutil.ReadAll,&nbsp;except&nbsp;that&nbsp;it&nbsp;expects&nbsp;a&nbsp;Go&nbsp;file&nbsp;as&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="3188139">//&nbsp;and&nbsp;stops&nbsp;reading&nbsp;the&nbsp;input&nbsp;once&nbsp;the&nbsp;imports&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="keyword" id="3188203">func</span>&nbsp;<span class="ident" id="3188208">readImports</span><span class="op" id="3188219">(</span><span class="ident" id="3188220">f</span>&nbsp;<span class="ident" id="3188222">io</span><span class="op" id="3188224">.</span><span class="ident" id="3188225">Reader</span><span class="op" id="3188231">,</span>&nbsp;<span class="ident" id="3188233">reportSyntaxError</span>&nbsp;<span class="builtintype" id="3188251">bool</span><span class="op" id="3188255">)</span>&nbsp;<span class="op" id="3188257">(</span><span class="op" id="3188258">[</span><span class="op" id="3188259">]</span><span class="builtintype" id="3188260">byte</span><span class="op" id="3188264">,</span>&nbsp;<span class="builtintype" id="3188266">error</span><span class="op" id="3188271">)</span>&nbsp;<span class="op" id="3188273">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188276">r</span>&nbsp;<span class="op" id="3188278">:=</span>&nbsp;<span class="op" id="3188281">&amp;</span><span class="ident" id="3188282">importReader</span><span class="op" id="3188294">{</span><span class="ident" id="3188295">b</span><span class="op" id="3188296">:</span>&nbsp;<span class="ident" id="3188298">bufio</span><span class="op" id="3188303">.</span><span class="ident" id="3188304">NewReader</span><span class="op" id="3188313">(</span><span class="ident" id="3188314">f</span><span class="op" id="3188315">)</span><span class="op" id="3188316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188320">r</span><span class="op" id="3188321">.</span><span class="ident" id="3188322">readKeyword</span><span class="op" id="3188333">(</span><span class="string" id="3188334">&#34;package&#34;</span><span class="op" id="3188343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188346">r</span><span class="op" id="3188347">.</span><span class="ident" id="3188348">readIdent</span><span class="op" id="3188357">(</span><span class="op" id="3188358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3188361">for</span>&nbsp;<span class="ident" id="3188365">r</span><span class="op" id="3188366">.</span><span class="ident" id="3188367">peekByte</span><span class="op" id="3188375">(</span><span class="builtintype" id="3188376">true</span><span class="op" id="3188380">)</span>&nbsp;<span class="op" id="3188382">==</span>&nbsp;<span class="string" id="3188385">&#39;i&#39;</span>&nbsp;<span class="op" id="3188389">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188393">r</span><span class="op" id="3188394">.</span><span class="ident" id="3188395">readKeyword</span><span class="op" id="3188406">(</span><span class="string" id="3188407">&#34;import&#34;</span><span class="op" id="3188415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3188419">if</span>&nbsp;<span class="ident" id="3188422">r</span><span class="op" id="3188423">.</span><span class="ident" id="3188424">peekByte</span><span class="op" id="3188432">(</span><span class="builtintype" id="3188433">true</span><span class="op" id="3188437">)</span>&nbsp;<span class="op" id="3188439">==</span>&nbsp;<span class="string" id="3188442">&#39;(&#39;</span>&nbsp;<span class="op" id="3188446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188451">r</span><span class="op" id="3188452">.</span><span class="ident" id="3188453">nextByte</span><span class="op" id="3188461">(</span><span class="builtintype" id="3188462">false</span><span class="op" id="3188467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3188472">for</span>&nbsp;<span class="ident" id="3188476">r</span><span class="op" id="3188477">.</span><span class="ident" id="3188478">peekByte</span><span class="op" id="3188486">(</span><span class="builtintype" id="3188487">true</span><span class="op" id="3188491">)</span>&nbsp;<span class="op" id="3188493">!=</span>&nbsp;<span class="string" id="3188496">&#39;)&#39;</span>&nbsp;<span class="op" id="3188500">&amp;&amp;</span>&nbsp;<span class="ident" id="3188503">r</span><span class="op" id="3188504">.</span><span class="ident" id="3188505">err</span>&nbsp;<span class="op" id="3188509">==</span>&nbsp;<span class="builtintype" id="3188512">nil</span>&nbsp;<span class="op" id="3188516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188522">r</span><span class="op" id="3188523">.</span><span class="ident" id="3188524">readImport</span><span class="op" id="3188534">(</span><span class="op" id="3188535">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3188540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188545">r</span><span class="op" id="3188546">.</span><span class="ident" id="3188547">nextByte</span><span class="op" id="3188555">(</span><span class="builtintype" id="3188556">false</span><span class="op" id="3188561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3188565">}</span>&nbsp;<span class="keyword" id="3188567">else</span>&nbsp;<span class="op" id="3188572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188577">r</span><span class="op" id="3188578">.</span><span class="ident" id="3188579">readImport</span><span class="op" id="3188589">(</span><span class="op" id="3188590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3188594">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3188597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3188601">//&nbsp;If&nbsp;we&nbsp;stopped&nbsp;successfully&nbsp;before&nbsp;EOF,&nbsp;we&nbsp;read&nbsp;a&nbsp;byte&nbsp;that&nbsp;told&nbsp;us&nbsp;we&nbsp;were&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3188686">//&nbsp;Return&nbsp;all&nbsp;but&nbsp;that&nbsp;last&nbsp;byte,&nbsp;which&nbsp;would&nbsp;cause&nbsp;a&nbsp;syntax&nbsp;error&nbsp;if&nbsp;we&nbsp;let&nbsp;it&nbsp;through.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3188776">if</span>&nbsp;<span class="ident" id="3188779">r</span><span class="op" id="3188780">.</span><span class="ident" id="3188781">err</span>&nbsp;<span class="op" id="3188785">==</span>&nbsp;<span class="builtintype" id="3188788">nil</span>&nbsp;<span class="op" id="3188792">&amp;&amp;</span>&nbsp;<span class="op" id="3188795">!</span><span class="ident" id="3188796">r</span><span class="op" id="3188797">.</span><span class="ident" id="3188798">eof</span>&nbsp;<span class="op" id="3188802">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3188806">return</span>&nbsp;<span class="ident" id="3188813">r</span><span class="op" id="3188814">.</span><span class="ident" id="3188815">buf</span><span class="op" id="3188818">[</span><span class="op" id="3188819">:</span><span class="builtinfunc" id="3188820">len</span><span class="op" id="3188823">(</span><span class="ident" id="3188824">r</span><span class="op" id="3188825">.</span><span class="ident" id="3188826">buf</span><span class="op" id="3188829">)</span><span class="op" id="3188830">-</span><span class="num" id="3188831">1</span><span class="op" id="3188832">]</span><span class="op" id="3188833">,</span>&nbsp;<span class="builtintype" id="3188835">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3188840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3188844">//&nbsp;If&nbsp;we&nbsp;stopped&nbsp;for&nbsp;a&nbsp;syntax&nbsp;error,&nbsp;consume&nbsp;the&nbsp;whole&nbsp;file&nbsp;so&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3188913">//&nbsp;we&nbsp;are&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;change&nbsp;the&nbsp;errors&nbsp;that&nbsp;go/parser&nbsp;returns.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3188980">if</span>&nbsp;<span class="ident" id="3188983">r</span><span class="op" id="3188984">.</span><span class="ident" id="3188985">err</span>&nbsp;<span class="op" id="3188989">==</span>&nbsp;<span class="ident" id="3188992">errSyntax</span>&nbsp;<span class="op" id="3189002">&amp;&amp;</span>&nbsp;<span class="op" id="3189005">!</span><span class="ident" id="3189006">reportSyntaxError</span>&nbsp;<span class="op" id="3189024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3189028">r</span><span class="op" id="3189029">.</span><span class="ident" id="3189030">err</span>&nbsp;<span class="op" id="3189034">=</span>&nbsp;<span class="builtintype" id="3189036">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3189042">for</span>&nbsp;<span class="ident" id="3189046">r</span><span class="op" id="3189047">.</span><span class="ident" id="3189048">err</span>&nbsp;<span class="op" id="3189052">==</span>&nbsp;<span class="builtintype" id="3189055">nil</span>&nbsp;<span class="op" id="3189059">&amp;&amp;</span>&nbsp;<span class="op" id="3189062">!</span><span class="ident" id="3189063">r</span><span class="op" id="3189064">.</span><span class="ident" id="3189065">eof</span>&nbsp;<span class="op" id="3189069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3189074">r</span><span class="op" id="3189075">.</span><span class="ident" id="3189076">readByte</span><span class="op" id="3189084">(</span><span class="op" id="3189085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3189089">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3189092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3189096">return</span>&nbsp;<span class="ident" id="3189103">r</span><span class="op" id="3189104">.</span><span class="ident" id="3189105">buf</span><span class="op" id="3189108">,</span>&nbsp;<span class="ident" id="3189110">r</span><span class="op" id="3189111">.</span><span class="ident" id="3189112">err</span><br>
<span class="lineno"></span><span class="op" id="3189116">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
