<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/asn1</h2>
<ul>
<li><a href="/gostd/encoding/asn1/asn1.go.html" class="current">asn1.go</a></li>
<li><a href="/gostd/encoding/asn1/asn1_test.go.html">asn1_test.go</a></li>
<li><a href="/gostd/encoding/asn1/common.go.html">common.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal_test.go.html">marshal_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4607238">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4607293">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4607347">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4607398">//&nbsp;Package&nbsp;asn1&nbsp;implements&nbsp;parsing&nbsp;of&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structures,</span><br>
<span class="lineno"></span><span class="comment" id="4607471">//&nbsp;as&nbsp;defined&nbsp;in&nbsp;ITU-T&nbsp;Rec&nbsp;X.690.</span><br>
<span class="lineno"></span><span class="comment" id="4607505">//</span><br>
<span class="lineno"></span><span class="comment" id="4607508">//&nbsp;See&nbsp;also&nbsp;``A&nbsp;Layman&#39;s&nbsp;Guide&nbsp;to&nbsp;a&nbsp;Subset&nbsp;of&nbsp;ASN.1,&nbsp;BER,&nbsp;and&nbsp;DER,&#39;&#39;</span><br>
<span class="lineno"></span><span class="comment" id="4607577">//&nbsp;http://luca.ntop.org/Teaching/Appunti/asn1.html.</span><br>
<span class="lineno">10</span><span class="keyword" id="4607629">package</span>&nbsp;<span class="ident" id="4607637">asn1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4607643">//&nbsp;ASN.1&nbsp;is&nbsp;a&nbsp;syntax&nbsp;for&nbsp;specifying&nbsp;abstract&nbsp;objects&nbsp;and&nbsp;BER,&nbsp;DER,&nbsp;PER,&nbsp;XER&nbsp;etc</span><br>
<span class="lineno"></span><span class="comment" id="4607723">//&nbsp;are&nbsp;different&nbsp;encoding&nbsp;formats&nbsp;for&nbsp;those&nbsp;objects.&nbsp;Here,&nbsp;we&#39;ll&nbsp;be&nbsp;dealing</span><br>
<span class="lineno"></span><span class="comment" id="4607799">//&nbsp;with&nbsp;DER,&nbsp;the&nbsp;Distinguished&nbsp;Encoding&nbsp;Rules.&nbsp;DER&nbsp;is&nbsp;used&nbsp;in&nbsp;X.509&nbsp;because</span><br>
<span class="lineno">15</span><span class="comment" id="4607875">//&nbsp;it&#39;s&nbsp;fast&nbsp;to&nbsp;parse&nbsp;and,&nbsp;unlike&nbsp;BER,&nbsp;has&nbsp;a&nbsp;unique&nbsp;encoding&nbsp;for&nbsp;every&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="4607954">//&nbsp;When&nbsp;calculating&nbsp;hashes&nbsp;over&nbsp;objects,&nbsp;it&#39;s&nbsp;important&nbsp;that&nbsp;the&nbsp;resulting</span><br>
<span class="lineno"></span><span class="comment" id="4608029">//&nbsp;bytes&nbsp;be&nbsp;the&nbsp;same&nbsp;at&nbsp;both&nbsp;ends&nbsp;and&nbsp;DER&nbsp;removes&nbsp;this&nbsp;margin&nbsp;of&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4608101">//</span><br>
<span class="lineno"></span><span class="comment" id="4608104">//&nbsp;ASN.1&nbsp;is&nbsp;very&nbsp;complex&nbsp;and&nbsp;this&nbsp;package&nbsp;doesn&#39;t&nbsp;attempt&nbsp;to&nbsp;implement</span><br>
<span class="lineno">20</span><span class="comment" id="4608175">//&nbsp;everything&nbsp;by&nbsp;any&nbsp;means.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4608204">import</span>&nbsp;<span class="op" id="4608211">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4608214">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4608221">&#34;math/big&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4608233">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4608244">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4608255">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4608262">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="4608265">//&nbsp;A&nbsp;StructuralError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;valid,&nbsp;but&nbsp;the&nbsp;Go&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="4608341">//&nbsp;which&nbsp;is&nbsp;receiving&nbsp;it&nbsp;doesn&#39;t&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="4608381">type</span>&nbsp;<span class="ident" id="4608386">StructuralError</span>&nbsp;<span class="keyword" id="4608402">struct</span>&nbsp;<span class="op" id="4608409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4608412">Msg</span>&nbsp;<span class="builtintype" id="4608416">string</span><br>
<span class="lineno"></span><span class="op" id="4608423">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="4608426">func</span>&nbsp;<span class="op" id="4608431">(</span><span class="ident" id="4608432">e</span>&nbsp;<span class="ident" id="4608434">StructuralError</span><span class="op" id="4608449">)</span>&nbsp;<span class="ident" id="4608451">Error</span><span class="op" id="4608456">(</span><span class="op" id="4608457">)</span>&nbsp;<span class="builtintype" id="4608459">string</span>&nbsp;<span class="op" id="4608466">{</span>&nbsp;<span class="keyword" id="4608468">return</span>&nbsp;<span class="string" id="4608475">&#34;asn1:&nbsp;structure&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="4608501">+</span>&nbsp;<span class="ident" id="4608503">e</span><span class="op" id="4608504">.</span><span class="ident" id="4608505">Msg</span>&nbsp;<span class="op" id="4608509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4608512">//&nbsp;A&nbsp;SyntaxError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="4608570">type</span>&nbsp;<span class="ident" id="4608575">SyntaxError</span>&nbsp;<span class="keyword" id="4608587">struct</span>&nbsp;<span class="op" id="4608594">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4608597">Msg</span>&nbsp;<span class="builtintype" id="4608601">string</span><br>
<span class="lineno"></span><span class="op" id="4608608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4608611">func</span>&nbsp;<span class="op" id="4608616">(</span><span class="ident" id="4608617">e</span>&nbsp;<span class="ident" id="4608619">SyntaxError</span><span class="op" id="4608630">)</span>&nbsp;<span class="ident" id="4608632">Error</span><span class="op" id="4608637">(</span><span class="op" id="4608638">)</span>&nbsp;<span class="builtintype" id="4608640">string</span>&nbsp;<span class="op" id="4608647">{</span>&nbsp;<span class="keyword" id="4608649">return</span>&nbsp;<span class="string" id="4608656">&#34;asn1:&nbsp;syntax&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="4608679">+</span>&nbsp;<span class="ident" id="4608681">e</span><span class="op" id="4608682">.</span><span class="ident" id="4608683">Msg</span>&nbsp;<span class="op" id="4608687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="4608690">//&nbsp;We&nbsp;start&nbsp;by&nbsp;dealing&nbsp;with&nbsp;each&nbsp;of&nbsp;the&nbsp;primitive&nbsp;types&nbsp;in&nbsp;turn.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4608756">//&nbsp;BOOLEAN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4608768">func</span>&nbsp;<span class="ident" id="4608773">parseBool</span><span class="op" id="4608782">(</span><span class="ident" id="4608783">bytes</span>&nbsp;<span class="op" id="4608789">[</span><span class="op" id="4608790">]</span><span class="builtintype" id="4608791">byte</span><span class="op" id="4608795">)</span>&nbsp;<span class="op" id="4608797">(</span><span class="ident" id="4608798">ret</span>&nbsp;<span class="builtintype" id="4608802">bool</span><span class="op" id="4608806">,</span>&nbsp;<span class="ident" id="4608808">err</span>&nbsp;<span class="builtintype" id="4608812">error</span><span class="op" id="4608817">)</span>&nbsp;<span class="op" id="4608819">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4608822">if</span>&nbsp;<span class="builtinfunc" id="4608825">len</span><span class="op" id="4608828">(</span><span class="ident" id="4608829">bytes</span><span class="op" id="4608834">)</span>&nbsp;<span class="op" id="4608836">!=</span>&nbsp;<span class="num" id="4608839">1</span>&nbsp;<span class="op" id="4608841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4608845">err</span>&nbsp;<span class="op" id="4608849">=</span>&nbsp;<span class="ident" id="4608851">SyntaxError</span><span class="op" id="4608862">{</span><span class="string" id="4608863">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="4608880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4608884">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4608892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4608896">//&nbsp;DER&nbsp;demands&nbsp;that&nbsp;&#34;If&nbsp;the&nbsp;encoding&nbsp;represents&nbsp;the&nbsp;boolean&nbsp;value&nbsp;TRUE,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4608969">//&nbsp;its&nbsp;single&nbsp;contents&nbsp;octet&nbsp;shall&nbsp;have&nbsp;all&nbsp;eight&nbsp;bits&nbsp;set&nbsp;to&nbsp;one.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4609038">//&nbsp;Thus&nbsp;only&nbsp;0&nbsp;and&nbsp;255&nbsp;are&nbsp;valid&nbsp;encoded&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4609088">switch</span>&nbsp;<span class="ident" id="4609095">bytes</span><span class="op" id="4609100">[</span><span class="num" id="4609101">0</span><span class="op" id="4609102">]</span>&nbsp;<span class="op" id="4609104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4609107">case</span>&nbsp;<span class="num" id="4609112">0</span><span class="op" id="4609113">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4609117">ret</span>&nbsp;<span class="op" id="4609121">=</span>&nbsp;<span class="builtintype" id="4609123">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4609130">case</span>&nbsp;<span class="num" id="4609135">0xff</span><span class="op" id="4609139">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4609143">ret</span>&nbsp;<span class="op" id="4609147">=</span>&nbsp;<span class="builtintype" id="4609149">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4609155">default</span><span class="op" id="4609162">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4609166">err</span>&nbsp;<span class="op" id="4609170">=</span>&nbsp;<span class="ident" id="4609172">SyntaxError</span><span class="op" id="4609183">{</span><span class="string" id="4609184">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="4609201">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4609204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4609208">return</span><br>
<span class="lineno"></span><span class="op" id="4609215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="4609218">//&nbsp;INTEGER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4609230">//&nbsp;parseInt64&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4609303">//&nbsp;returns&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4609326">func</span>&nbsp;<span class="ident" id="4609331">parseInt64</span><span class="op" id="4609341">(</span><span class="ident" id="4609342">bytes</span>&nbsp;<span class="op" id="4609348">[</span><span class="op" id="4609349">]</span><span class="builtintype" id="4609350">byte</span><span class="op" id="4609354">)</span>&nbsp;<span class="op" id="4609356">(</span><span class="ident" id="4609357">ret</span>&nbsp;<span class="ident" id="4609361">int64</span><span class="op" id="4609366">,</span>&nbsp;<span class="ident" id="4609368">err</span>&nbsp;<span class="builtintype" id="4609372">error</span><span class="op" id="4609377">)</span>&nbsp;<span class="op" id="4609379">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4609382">if</span>&nbsp;<span class="builtinfunc" id="4609385">len</span><span class="op" id="4609388">(</span><span class="ident" id="4609389">bytes</span><span class="op" id="4609394">)</span>&nbsp;<span class="op" id="4609396">&gt;</span>&nbsp;<span class="num" id="4609398">8</span>&nbsp;<span class="op" id="4609400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4609404">//&nbsp;We&#39;ll&nbsp;overflow&nbsp;an&nbsp;int64&nbsp;in&nbsp;this&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4609447">err</span>&nbsp;<span class="op" id="4609451">=</span>&nbsp;<span class="ident" id="4609453">StructuralError</span><span class="op" id="4609468">{</span><span class="string" id="4609469">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4609488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4609492">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4609500">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4609503">for</span>&nbsp;<span class="ident" id="4609507">bytesRead</span>&nbsp;<span class="op" id="4609517">:=</span>&nbsp;<span class="num" id="4609520">0</span><span class="op" id="4609521">;</span>&nbsp;<span class="ident" id="4609523">bytesRead</span>&nbsp;<span class="op" id="4609533">&lt;</span>&nbsp;<span class="builtinfunc" id="4609535">len</span><span class="op" id="4609538">(</span><span class="ident" id="4609539">bytes</span><span class="op" id="4609544">)</span><span class="op" id="4609545">;</span>&nbsp;<span class="ident" id="4609547">bytesRead</span><span class="op" id="4609556">++</span>&nbsp;<span class="op" id="4609559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4609563">ret</span>&nbsp;<span class="op" id="4609567">&lt;&lt;=</span>&nbsp;<span class="num" id="4609571">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4609575">ret</span>&nbsp;<span class="op" id="4609579">|=</span>&nbsp;<span class="ident" id="4609582">int64</span><span class="op" id="4609587">(</span><span class="ident" id="4609588">bytes</span><span class="op" id="4609593">[</span><span class="ident" id="4609594">bytesRead</span><span class="op" id="4609603">]</span><span class="op" id="4609604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4609607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4609611">//&nbsp;Shift&nbsp;up&nbsp;and&nbsp;down&nbsp;in&nbsp;order&nbsp;to&nbsp;sign&nbsp;extend&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4609669">ret</span>&nbsp;<span class="op" id="4609673">&lt;&lt;=</span>&nbsp;<span class="num" id="4609677">64</span>&nbsp;<span class="op" id="4609680">-</span>&nbsp;<span class="builtintype" id="4609682">uint8</span><span class="op" id="4609687">(</span><span class="builtinfunc" id="4609688">len</span><span class="op" id="4609691">(</span><span class="ident" id="4609692">bytes</span><span class="op" id="4609697">)</span><span class="op" id="4609698">)</span><span class="op" id="4609699">*</span><span class="num" id="4609700">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4609703">ret</span>&nbsp;<span class="op" id="4609707">&gt;&gt;=</span>&nbsp;<span class="num" id="4609711">64</span>&nbsp;<span class="op" id="4609714">-</span>&nbsp;<span class="builtintype" id="4609716">uint8</span><span class="op" id="4609721">(</span><span class="builtinfunc" id="4609722">len</span><span class="op" id="4609725">(</span><span class="ident" id="4609726">bytes</span><span class="op" id="4609731">)</span><span class="op" id="4609732">)</span><span class="op" id="4609733">*</span><span class="num" id="4609734">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4609737">return</span><br>
<span class="lineno"></span><span class="op" id="4609744">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="4609747">//&nbsp;parseInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4609826">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4609841">func</span>&nbsp;<span class="ident" id="4609846">parseInt32</span><span class="op" id="4609856">(</span><span class="ident" id="4609857">bytes</span>&nbsp;<span class="op" id="4609863">[</span><span class="op" id="4609864">]</span><span class="builtintype" id="4609865">byte</span><span class="op" id="4609869">)</span>&nbsp;<span class="op" id="4609871">(</span><span class="builtintype" id="4609872">int32</span><span class="op" id="4609877">,</span>&nbsp;<span class="builtintype" id="4609879">error</span><span class="op" id="4609884">)</span>&nbsp;<span class="op" id="4609886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4609889">ret64</span><span class="op" id="4609894">,</span>&nbsp;<span class="ident" id="4609896">err</span>&nbsp;<span class="op" id="4609900">:=</span>&nbsp;<span class="ident" id="4609903">parseInt64</span><span class="op" id="4609913">(</span><span class="ident" id="4609914">bytes</span><span class="op" id="4609919">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4609922">if</span>&nbsp;<span class="ident" id="4609925">err</span>&nbsp;<span class="op" id="4609929">!=</span>&nbsp;<span class="builtintype" id="4609932">nil</span>&nbsp;<span class="op" id="4609936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4609940">return</span>&nbsp;<span class="num" id="4609947">0</span><span class="op" id="4609948">,</span>&nbsp;<span class="ident" id="4609950">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4609955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4609958">if</span>&nbsp;<span class="ident" id="4609961">ret64</span>&nbsp;<span class="op" id="4609967">!=</span>&nbsp;<span class="ident" id="4609970">int64</span><span class="op" id="4609975">(</span><span class="builtintype" id="4609976">int32</span><span class="op" id="4609981">(</span><span class="ident" id="4609982">ret64</span><span class="op" id="4609987">)</span><span class="op" id="4609988">)</span>&nbsp;<span class="op" id="4609990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4609994">return</span>&nbsp;<span class="num" id="4610001">0</span><span class="op" id="4610002">,</span>&nbsp;<span class="ident" id="4610004">StructuralError</span><span class="op" id="4610019">{</span><span class="string" id="4610020">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4610039">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4610042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4610045">return</span>&nbsp;<span class="builtintype" id="4610052">int32</span><span class="op" id="4610057">(</span><span class="ident" id="4610058">ret64</span><span class="op" id="4610063">)</span><span class="op" id="4610064">,</span>&nbsp;<span class="builtintype" id="4610066">nil</span><br>
<span class="lineno"></span><span class="op" id="4610070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4610073">var</span>&nbsp;<span class="ident" id="4610077">bigOne</span>&nbsp;<span class="op" id="4610084">=</span>&nbsp;<span class="ident" id="4610086">big</span><span class="op" id="4610089">.</span><span class="ident" id="4610090">NewInt</span><span class="op" id="4610096">(</span><span class="num" id="4610097">1</span><span class="op" id="4610098">)</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="4610101">//&nbsp;parseBigInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4610183">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4610198">func</span>&nbsp;<span class="ident" id="4610203">parseBigInt</span><span class="op" id="4610214">(</span><span class="ident" id="4610215">bytes</span>&nbsp;<span class="op" id="4610221">[</span><span class="op" id="4610222">]</span><span class="builtintype" id="4610223">byte</span><span class="op" id="4610227">)</span>&nbsp;<span class="op" id="4610229">*</span><span class="ident" id="4610230">big</span><span class="op" id="4610233">.</span><span class="ident" id="4610234">Int</span>&nbsp;<span class="op" id="4610238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4610241">ret</span>&nbsp;<span class="op" id="4610245">:=</span>&nbsp;<span class="builtinfunc" id="4610248">new</span><span class="op" id="4610251">(</span><span class="ident" id="4610252">big</span><span class="op" id="4610255">.</span><span class="ident" id="4610256">Int</span><span class="op" id="4610259">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4610262">if</span>&nbsp;<span class="builtinfunc" id="4610265">len</span><span class="op" id="4610268">(</span><span class="ident" id="4610269">bytes</span><span class="op" id="4610274">)</span>&nbsp;<span class="op" id="4610276">&gt;</span>&nbsp;<span class="num" id="4610278">0</span>&nbsp;<span class="op" id="4610280">&amp;&amp;</span>&nbsp;<span class="ident" id="4610283">bytes</span><span class="op" id="4610288">[</span><span class="num" id="4610289">0</span><span class="op" id="4610290">]</span><span class="op" id="4610291">&amp;</span><span class="num" id="4610292">0x80</span>&nbsp;<span class="op" id="4610297">==</span>&nbsp;<span class="num" id="4610300">0x80</span>&nbsp;<span class="op" id="4610305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4610309">//&nbsp;This&nbsp;is&nbsp;a&nbsp;negative&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4610341">notBytes</span>&nbsp;<span class="op" id="4610350">:=</span>&nbsp;<span class="builtinfunc" id="4610353">make</span><span class="op" id="4610357">(</span><span class="op" id="4610358">[</span><span class="op" id="4610359">]</span><span class="builtintype" id="4610360">byte</span><span class="op" id="4610364">,</span>&nbsp;<span class="builtinfunc" id="4610366">len</span><span class="op" id="4610369">(</span><span class="ident" id="4610370">bytes</span><span class="op" id="4610375">)</span><span class="op" id="4610376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4610380">for</span>&nbsp;<span class="ident" id="4610384">i</span>&nbsp;<span class="op" id="4610386">:=</span>&nbsp;<span class="keyword" id="4610389">range</span>&nbsp;<span class="ident" id="4610395">notBytes</span>&nbsp;<span class="op" id="4610404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4610409">notBytes</span><span class="op" id="4610417">[</span><span class="ident" id="4610418">i</span><span class="op" id="4610419">]</span>&nbsp;<span class="op" id="4610421">=</span>&nbsp;<span class="op" id="4610423">^</span><span class="ident" id="4610424">bytes</span><span class="op" id="4610429">[</span><span class="ident" id="4610430">i</span><span class="op" id="4610431">]</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4610435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4610439">ret</span><span class="op" id="4610442">.</span><span class="ident" id="4610443">SetBytes</span><span class="op" id="4610451">(</span><span class="ident" id="4610452">notBytes</span><span class="op" id="4610460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4610464">ret</span><span class="op" id="4610467">.</span><span class="ident" id="4610468">Add</span><span class="op" id="4610471">(</span><span class="ident" id="4610472">ret</span><span class="op" id="4610475">,</span>&nbsp;<span class="ident" id="4610477">bigOne</span><span class="op" id="4610483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4610487">ret</span><span class="op" id="4610490">.</span><span class="ident" id="4610491">Neg</span><span class="op" id="4610494">(</span><span class="ident" id="4610495">ret</span><span class="op" id="4610498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4610502">return</span>&nbsp;<span class="ident" id="4610509">ret</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4610514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4610517">ret</span><span class="op" id="4610520">.</span><span class="ident" id="4610521">SetBytes</span><span class="op" id="4610529">(</span><span class="ident" id="4610530">bytes</span><span class="op" id="4610535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4610538">return</span>&nbsp;<span class="ident" id="4610545">ret</span><br>
<span class="lineno"></span><span class="op" id="4610549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="4610552">//&nbsp;BIT&nbsp;STRING</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4610567">//&nbsp;BitString&nbsp;is&nbsp;the&nbsp;structure&nbsp;to&nbsp;use&nbsp;when&nbsp;you&nbsp;want&nbsp;an&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;type.&nbsp;A</span><br>
<span class="lineno"></span><span class="comment" id="4610646">//&nbsp;bit&nbsp;string&nbsp;is&nbsp;padded&nbsp;up&nbsp;to&nbsp;the&nbsp;nearest&nbsp;byte&nbsp;in&nbsp;memory&nbsp;and&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4610721">//&nbsp;valid&nbsp;bits&nbsp;is&nbsp;recorded.&nbsp;Padding&nbsp;bits&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno">130</span><span class="keyword" id="4610775">type</span>&nbsp;<span class="ident" id="4610780">BitString</span>&nbsp;<span class="keyword" id="4610790">struct</span>&nbsp;<span class="op" id="4610797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4610800">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4610810">[</span><span class="op" id="4610811">]</span><span class="builtintype" id="4610812">byte</span>&nbsp;<span class="comment" id="4610817">//&nbsp;bits&nbsp;packed&nbsp;into&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4610845">BitLength</span>&nbsp;<span class="builtintype" id="4610855">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4610862">//&nbsp;length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span><span class="op" id="4610881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="4610884">//&nbsp;At&nbsp;returns&nbsp;the&nbsp;bit&nbsp;at&nbsp;the&nbsp;given&nbsp;index.&nbsp;If&nbsp;the&nbsp;index&nbsp;is&nbsp;out&nbsp;of&nbsp;range&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4610958">//&nbsp;returns&nbsp;false.</span><br>
<span class="lineno"></span><span class="keyword" id="4610976">func</span>&nbsp;<span class="op" id="4610981">(</span><span class="ident" id="4610982">b</span>&nbsp;<span class="ident" id="4610984">BitString</span><span class="op" id="4610993">)</span>&nbsp;<span class="ident" id="4610995">At</span><span class="op" id="4610997">(</span><span class="ident" id="4610998">i</span>&nbsp;<span class="builtintype" id="4611000">int</span><span class="op" id="4611003">)</span>&nbsp;<span class="builtintype" id="4611005">int</span>&nbsp;<span class="op" id="4611009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4611012">if</span>&nbsp;<span class="ident" id="4611015">i</span>&nbsp;<span class="op" id="4611017">&lt;</span>&nbsp;<span class="num" id="4611019">0</span>&nbsp;<span class="op" id="4611021">||</span>&nbsp;<span class="ident" id="4611024">i</span>&nbsp;<span class="op" id="4611026">&gt;=</span>&nbsp;<span class="ident" id="4611029">b</span><span class="op" id="4611030">.</span><span class="ident" id="4611031">BitLength</span>&nbsp;<span class="op" id="4611041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4611045">return</span>&nbsp;<span class="num" id="4611052">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4611055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4611058">x</span>&nbsp;<span class="op" id="4611060">:=</span>&nbsp;<span class="ident" id="4611063">i</span>&nbsp;<span class="op" id="4611065">/</span>&nbsp;<span class="num" id="4611067">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4611070">y</span>&nbsp;<span class="op" id="4611072">:=</span>&nbsp;<span class="num" id="4611075">7</span>&nbsp;<span class="op" id="4611077">-</span>&nbsp;<span class="builtintype" id="4611079">uint</span><span class="op" id="4611083">(</span><span class="ident" id="4611084">i</span><span class="op" id="4611085">%</span><span class="num" id="4611086">8</span><span class="op" id="4611087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4611090">return</span>&nbsp;<span class="builtintype" id="4611097">int</span><span class="op" id="4611100">(</span><span class="ident" id="4611101">b</span><span class="op" id="4611102">.</span><span class="ident" id="4611103">Bytes</span><span class="op" id="4611108">[</span><span class="ident" id="4611109">x</span><span class="op" id="4611110">]</span><span class="op" id="4611111">&gt;&gt;</span><span class="ident" id="4611113">y</span><span class="op" id="4611114">)</span>&nbsp;<span class="op" id="4611116">&amp;</span>&nbsp;<span class="num" id="4611118">1</span><br>
<span class="lineno"></span><span class="op" id="4611120">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="4611123">//&nbsp;RightAlign&nbsp;returns&nbsp;a&nbsp;slice&nbsp;where&nbsp;the&nbsp;padding&nbsp;bits&nbsp;are&nbsp;at&nbsp;the&nbsp;beginning.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4611202">//&nbsp;slice&nbsp;may&nbsp;share&nbsp;memory&nbsp;with&nbsp;the&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="keyword" id="4611248">func</span>&nbsp;<span class="op" id="4611253">(</span><span class="ident" id="4611254">b</span>&nbsp;<span class="ident" id="4611256">BitString</span><span class="op" id="4611265">)</span>&nbsp;<span class="ident" id="4611267">RightAlign</span><span class="op" id="4611277">(</span><span class="op" id="4611278">)</span>&nbsp;<span class="op" id="4611280">[</span><span class="op" id="4611281">]</span><span class="builtintype" id="4611282">byte</span>&nbsp;<span class="op" id="4611287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4611290">shift</span>&nbsp;<span class="op" id="4611296">:=</span>&nbsp;<span class="builtintype" id="4611299">uint</span><span class="op" id="4611303">(</span><span class="num" id="4611304">8</span>&nbsp;<span class="op" id="4611306">-</span>&nbsp;<span class="op" id="4611308">(</span><span class="ident" id="4611309">b</span><span class="op" id="4611310">.</span><span class="ident" id="4611311">BitLength</span>&nbsp;<span class="op" id="4611321">%</span>&nbsp;<span class="num" id="4611323">8</span><span class="op" id="4611324">)</span><span class="op" id="4611325">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4611328">if</span>&nbsp;<span class="ident" id="4611331">shift</span>&nbsp;<span class="op" id="4611337">==</span>&nbsp;<span class="num" id="4611340">8</span>&nbsp;<span class="op" id="4611342">||</span>&nbsp;<span class="builtinfunc" id="4611345">len</span><span class="op" id="4611348">(</span><span class="ident" id="4611349">b</span><span class="op" id="4611350">.</span><span class="ident" id="4611351">Bytes</span><span class="op" id="4611356">)</span>&nbsp;<span class="op" id="4611358">==</span>&nbsp;<span class="num" id="4611361">0</span>&nbsp;<span class="op" id="4611363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4611367">return</span>&nbsp;<span class="ident" id="4611374">b</span><span class="op" id="4611375">.</span><span class="ident" id="4611376">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4611383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4611387">a</span>&nbsp;<span class="op" id="4611389">:=</span>&nbsp;<span class="builtinfunc" id="4611392">make</span><span class="op" id="4611396">(</span><span class="op" id="4611397">[</span><span class="op" id="4611398">]</span><span class="builtintype" id="4611399">byte</span><span class="op" id="4611403">,</span>&nbsp;<span class="builtinfunc" id="4611405">len</span><span class="op" id="4611408">(</span><span class="ident" id="4611409">b</span><span class="op" id="4611410">.</span><span class="ident" id="4611411">Bytes</span><span class="op" id="4611416">)</span><span class="op" id="4611417">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4611420">a</span><span class="op" id="4611421">[</span><span class="num" id="4611422">0</span><span class="op" id="4611423">]</span>&nbsp;<span class="op" id="4611425">=</span>&nbsp;<span class="ident" id="4611427">b</span><span class="op" id="4611428">.</span><span class="ident" id="4611429">Bytes</span><span class="op" id="4611434">[</span><span class="num" id="4611435">0</span><span class="op" id="4611436">]</span>&nbsp;<span class="op" id="4611438">&gt;&gt;</span>&nbsp;<span class="ident" id="4611441">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4611448">for</span>&nbsp;<span class="ident" id="4611452">i</span>&nbsp;<span class="op" id="4611454">:=</span>&nbsp;<span class="num" id="4611457">1</span><span class="op" id="4611458">;</span>&nbsp;<span class="ident" id="4611460">i</span>&nbsp;<span class="op" id="4611462">&lt;</span>&nbsp;<span class="builtinfunc" id="4611464">len</span><span class="op" id="4611467">(</span><span class="ident" id="4611468">b</span><span class="op" id="4611469">.</span><span class="ident" id="4611470">Bytes</span><span class="op" id="4611475">)</span><span class="op" id="4611476">;</span>&nbsp;<span class="ident" id="4611478">i</span><span class="op" id="4611479">++</span>&nbsp;<span class="op" id="4611482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4611486">a</span><span class="op" id="4611487">[</span><span class="ident" id="4611488">i</span><span class="op" id="4611489">]</span>&nbsp;<span class="op" id="4611491">=</span>&nbsp;<span class="ident" id="4611493">b</span><span class="op" id="4611494">.</span><span class="ident" id="4611495">Bytes</span><span class="op" id="4611500">[</span><span class="ident" id="4611501">i</span><span class="op" id="4611502">-</span><span class="num" id="4611503">1</span><span class="op" id="4611504">]</span>&nbsp;<span class="op" id="4611506">&lt;&lt;</span>&nbsp;<span class="op" id="4611509">(</span><span class="num" id="4611510">8</span>&nbsp;<span class="op" id="4611512">-</span>&nbsp;<span class="ident" id="4611514">shift</span><span class="op" id="4611519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4611523">a</span><span class="op" id="4611524">[</span><span class="ident" id="4611525">i</span><span class="op" id="4611526">]</span>&nbsp;<span class="op" id="4611528">|=</span>&nbsp;<span class="ident" id="4611531">b</span><span class="op" id="4611532">.</span><span class="ident" id="4611533">Bytes</span><span class="op" id="4611538">[</span><span class="ident" id="4611539">i</span><span class="op" id="4611540">]</span>&nbsp;<span class="op" id="4611542">&gt;&gt;</span>&nbsp;<span class="ident" id="4611545">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4611552">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4611556">return</span>&nbsp;<span class="ident" id="4611563">a</span><br>
<span class="lineno"></span><span class="op" id="4611565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4611568">//&nbsp;parseBitString&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;bit&nbsp;string&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno">165</span><span class="keyword" id="4611655">func</span>&nbsp;<span class="ident" id="4611660">parseBitString</span><span class="op" id="4611674">(</span><span class="ident" id="4611675">bytes</span>&nbsp;<span class="op" id="4611681">[</span><span class="op" id="4611682">]</span><span class="builtintype" id="4611683">byte</span><span class="op" id="4611687">)</span>&nbsp;<span class="op" id="4611689">(</span><span class="ident" id="4611690">ret</span>&nbsp;<span class="ident" id="4611694">BitString</span><span class="op" id="4611703">,</span>&nbsp;<span class="ident" id="4611705">err</span>&nbsp;<span class="builtintype" id="4611709">error</span><span class="op" id="4611714">)</span>&nbsp;<span class="op" id="4611716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4611719">if</span>&nbsp;<span class="builtinfunc" id="4611722">len</span><span class="op" id="4611725">(</span><span class="ident" id="4611726">bytes</span><span class="op" id="4611731">)</span>&nbsp;<span class="op" id="4611733">==</span>&nbsp;<span class="num" id="4611736">0</span>&nbsp;<span class="op" id="4611738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4611742">err</span>&nbsp;<span class="op" id="4611746">=</span>&nbsp;<span class="ident" id="4611748">SyntaxError</span><span class="op" id="4611759">{</span><span class="string" id="4611760">&#34;zero&nbsp;length&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="4611784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4611788">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4611796">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4611799">paddingBits</span>&nbsp;<span class="op" id="4611811">:=</span>&nbsp;<span class="builtintype" id="4611814">int</span><span class="op" id="4611817">(</span><span class="ident" id="4611818">bytes</span><span class="op" id="4611823">[</span><span class="num" id="4611824">0</span><span class="op" id="4611825">]</span><span class="op" id="4611826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4611829">if</span>&nbsp;<span class="ident" id="4611832">paddingBits</span>&nbsp;<span class="op" id="4611844">&gt;</span>&nbsp;<span class="num" id="4611846">7</span>&nbsp;<span class="op" id="4611848">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4611853">len</span><span class="op" id="4611856">(</span><span class="ident" id="4611857">bytes</span><span class="op" id="4611862">)</span>&nbsp;<span class="op" id="4611864">==</span>&nbsp;<span class="num" id="4611867">1</span>&nbsp;<span class="op" id="4611869">&amp;&amp;</span>&nbsp;<span class="ident" id="4611872">paddingBits</span>&nbsp;<span class="op" id="4611884">&gt;</span>&nbsp;<span class="num" id="4611886">0</span>&nbsp;<span class="op" id="4611888">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4611893">bytes</span><span class="op" id="4611898">[</span><span class="builtinfunc" id="4611899">len</span><span class="op" id="4611902">(</span><span class="ident" id="4611903">bytes</span><span class="op" id="4611908">)</span><span class="op" id="4611909">-</span><span class="num" id="4611910">1</span><span class="op" id="4611911">]</span><span class="op" id="4611912">&amp;</span><span class="op" id="4611913">(</span><span class="op" id="4611914">(</span><span class="num" id="4611915">1</span><span class="op" id="4611916">&lt;&lt;</span><span class="ident" id="4611918">bytes</span><span class="op" id="4611923">[</span><span class="num" id="4611924">0</span><span class="op" id="4611925">]</span><span class="op" id="4611926">)</span><span class="op" id="4611927">-</span><span class="num" id="4611928">1</span><span class="op" id="4611929">)</span>&nbsp;<span class="op" id="4611931">!=</span>&nbsp;<span class="num" id="4611934">0</span>&nbsp;<span class="op" id="4611936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4611940">err</span>&nbsp;<span class="op" id="4611944">=</span>&nbsp;<span class="ident" id="4611946">SyntaxError</span><span class="op" id="4611957">{</span><span class="string" id="4611958">&#34;invalid&nbsp;padding&nbsp;bits&nbsp;in&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="4611994">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4611998">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4612006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4612009">ret</span><span class="op" id="4612012">.</span><span class="ident" id="4612013">BitLength</span>&nbsp;<span class="op" id="4612023">=</span>&nbsp;<span class="op" id="4612025">(</span><span class="builtinfunc" id="4612026">len</span><span class="op" id="4612029">(</span><span class="ident" id="4612030">bytes</span><span class="op" id="4612035">)</span><span class="op" id="4612036">-</span><span class="num" id="4612037">1</span><span class="op" id="4612038">)</span><span class="op" id="4612039">*</span><span class="num" id="4612040">8</span>&nbsp;<span class="op" id="4612042">-</span>&nbsp;<span class="ident" id="4612044">paddingBits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4612057">ret</span><span class="op" id="4612060">.</span><span class="ident" id="4612061">Bytes</span>&nbsp;<span class="op" id="4612067">=</span>&nbsp;<span class="ident" id="4612069">bytes</span><span class="op" id="4612074">[</span><span class="num" id="4612075">1</span><span class="op" id="4612076">:</span><span class="op" id="4612077">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4612080">return</span><br>
<span class="lineno">180</span><span class="op" id="4612087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4612090">//&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4612112">//&nbsp;An&nbsp;ObjectIdentifier&nbsp;represents&nbsp;an&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER.</span><br>
<span class="lineno">185</span><span class="keyword" id="4612174">type</span>&nbsp;<span class="ident" id="4612179">ObjectIdentifier</span>&nbsp;<span class="op" id="4612196">[</span><span class="op" id="4612197">]</span><span class="builtintype" id="4612198">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4612203">//&nbsp;Equal&nbsp;reports&nbsp;whether&nbsp;oi&nbsp;and&nbsp;other&nbsp;represent&nbsp;the&nbsp;same&nbsp;identifier.</span><br>
<span class="lineno"></span><span class="keyword" id="4612272">func</span>&nbsp;<span class="op" id="4612277">(</span><span class="ident" id="4612278">oi</span>&nbsp;<span class="ident" id="4612281">ObjectIdentifier</span><span class="op" id="4612297">)</span>&nbsp;<span class="ident" id="4612299">Equal</span><span class="op" id="4612304">(</span><span class="ident" id="4612305">other</span>&nbsp;<span class="ident" id="4612311">ObjectIdentifier</span><span class="op" id="4612327">)</span>&nbsp;<span class="builtintype" id="4612329">bool</span>&nbsp;<span class="op" id="4612334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4612337">if</span>&nbsp;<span class="builtinfunc" id="4612340">len</span><span class="op" id="4612343">(</span><span class="ident" id="4612344">oi</span><span class="op" id="4612346">)</span>&nbsp;<span class="op" id="4612348">!=</span>&nbsp;<span class="builtinfunc" id="4612351">len</span><span class="op" id="4612354">(</span><span class="ident" id="4612355">other</span><span class="op" id="4612360">)</span>&nbsp;<span class="op" id="4612362">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4612366">return</span>&nbsp;<span class="builtintype" id="4612373">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4612380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4612383">for</span>&nbsp;<span class="ident" id="4612387">i</span>&nbsp;<span class="op" id="4612389">:=</span>&nbsp;<span class="num" id="4612392">0</span><span class="op" id="4612393">;</span>&nbsp;<span class="ident" id="4612395">i</span>&nbsp;<span class="op" id="4612397">&lt;</span>&nbsp;<span class="builtinfunc" id="4612399">len</span><span class="op" id="4612402">(</span><span class="ident" id="4612403">oi</span><span class="op" id="4612405">)</span><span class="op" id="4612406">;</span>&nbsp;<span class="ident" id="4612408">i</span><span class="op" id="4612409">++</span>&nbsp;<span class="op" id="4612412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4612416">if</span>&nbsp;<span class="ident" id="4612419">oi</span><span class="op" id="4612421">[</span><span class="ident" id="4612422">i</span><span class="op" id="4612423">]</span>&nbsp;<span class="op" id="4612425">!=</span>&nbsp;<span class="ident" id="4612428">other</span><span class="op" id="4612433">[</span><span class="ident" id="4612434">i</span><span class="op" id="4612435">]</span>&nbsp;<span class="op" id="4612437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4612442">return</span>&nbsp;<span class="builtintype" id="4612449">false</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4612457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4612460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4612464">return</span>&nbsp;<span class="builtintype" id="4612471">true</span><br>
<span class="lineno"></span><span class="op" id="4612476">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="4612479">func</span>&nbsp;<span class="op" id="4612484">(</span><span class="ident" id="4612485">oi</span>&nbsp;<span class="ident" id="4612488">ObjectIdentifier</span><span class="op" id="4612504">)</span>&nbsp;<span class="ident" id="4612506">String</span><span class="op" id="4612512">(</span><span class="op" id="4612513">)</span>&nbsp;<span class="builtintype" id="4612515">string</span>&nbsp;<span class="op" id="4612522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4612525">var</span>&nbsp;<span class="ident" id="4612529">s</span>&nbsp;<span class="builtintype" id="4612531">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4612540">for</span>&nbsp;<span class="ident" id="4612544">i</span><span class="op" id="4612545">,</span>&nbsp;<span class="ident" id="4612547">v</span>&nbsp;<span class="op" id="4612549">:=</span>&nbsp;<span class="keyword" id="4612552">range</span>&nbsp;<span class="ident" id="4612558">oi</span>&nbsp;<span class="op" id="4612561">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4612565">if</span>&nbsp;<span class="ident" id="4612568">i</span>&nbsp;<span class="op" id="4612570">&gt;</span>&nbsp;<span class="num" id="4612572">0</span>&nbsp;<span class="op" id="4612574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4612579">s</span>&nbsp;<span class="op" id="4612581">+=</span>&nbsp;<span class="string" id="4612584">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4612590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4612594">s</span>&nbsp;<span class="op" id="4612596">+=</span>&nbsp;<span class="ident" id="4612599">strconv</span><span class="op" id="4612606">.</span><span class="ident" id="4612607">Itoa</span><span class="op" id="4612611">(</span><span class="ident" id="4612612">v</span><span class="op" id="4612613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4612616">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4612620">return</span>&nbsp;<span class="ident" id="4612627">s</span><br>
<span class="lineno"></span><span class="op" id="4612629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4612632">//&nbsp;parseObjectIdentifier&nbsp;parses&nbsp;an&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes&nbsp;and</span><br>
<span class="lineno">215</span><span class="comment" id="4612710">//&nbsp;returns&nbsp;it.&nbsp;An&nbsp;object&nbsp;identifier&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;variable&nbsp;length&nbsp;integers</span><br>
<span class="lineno"></span><span class="comment" id="4612788">//&nbsp;that&nbsp;are&nbsp;assigned&nbsp;in&nbsp;a&nbsp;hierarchy.</span><br>
<span class="lineno"></span><span class="keyword" id="4612825">func</span>&nbsp;<span class="ident" id="4612830">parseObjectIdentifier</span><span class="op" id="4612851">(</span><span class="ident" id="4612852">bytes</span>&nbsp;<span class="op" id="4612858">[</span><span class="op" id="4612859">]</span><span class="builtintype" id="4612860">byte</span><span class="op" id="4612864">)</span>&nbsp;<span class="op" id="4612866">(</span><span class="ident" id="4612867">s</span>&nbsp;<span class="op" id="4612869">[</span><span class="op" id="4612870">]</span><span class="builtintype" id="4612871">int</span><span class="op" id="4612874">,</span>&nbsp;<span class="ident" id="4612876">err</span>&nbsp;<span class="builtintype" id="4612880">error</span><span class="op" id="4612885">)</span>&nbsp;<span class="op" id="4612887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4612890">if</span>&nbsp;<span class="builtinfunc" id="4612893">len</span><span class="op" id="4612896">(</span><span class="ident" id="4612897">bytes</span><span class="op" id="4612902">)</span>&nbsp;<span class="op" id="4612904">==</span>&nbsp;<span class="num" id="4612907">0</span>&nbsp;<span class="op" id="4612909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4612913">err</span>&nbsp;<span class="op" id="4612917">=</span>&nbsp;<span class="ident" id="4612919">SyntaxError</span><span class="op" id="4612930">{</span><span class="string" id="4612931">&#34;zero&nbsp;length&nbsp;OBJECT&nbsp;IDENTIFIER&#34;</span><span class="op" id="4612962">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4612966">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4612974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4612978">//&nbsp;In&nbsp;the&nbsp;worst&nbsp;case,&nbsp;we&nbsp;get&nbsp;two&nbsp;elements&nbsp;from&nbsp;the&nbsp;first&nbsp;byte&nbsp;(which&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4613051">//&nbsp;encoded&nbsp;differently)&nbsp;and&nbsp;then&nbsp;every&nbsp;varint&nbsp;is&nbsp;a&nbsp;single&nbsp;byte&nbsp;long.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4613121">s</span>&nbsp;<span class="op" id="4613123">=</span>&nbsp;<span class="builtinfunc" id="4613125">make</span><span class="op" id="4613129">(</span><span class="op" id="4613130">[</span><span class="op" id="4613131">]</span><span class="builtintype" id="4613132">int</span><span class="op" id="4613135">,</span>&nbsp;<span class="builtinfunc" id="4613137">len</span><span class="op" id="4613140">(</span><span class="ident" id="4613141">bytes</span><span class="op" id="4613146">)</span><span class="op" id="4613147">+</span><span class="num" id="4613148">1</span><span class="op" id="4613149">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4613153">//&nbsp;The&nbsp;first&nbsp;varint&nbsp;is&nbsp;40*value1&nbsp;+&nbsp;value2:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4613197">//&nbsp;According&nbsp;to&nbsp;this&nbsp;packing,&nbsp;value1&nbsp;can&nbsp;take&nbsp;the&nbsp;values&nbsp;0,&nbsp;1&nbsp;and&nbsp;2&nbsp;only.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4613272">//&nbsp;When&nbsp;value1&nbsp;=&nbsp;0&nbsp;or&nbsp;value1&nbsp;=&nbsp;1,&nbsp;then&nbsp;value2&nbsp;is&nbsp;&lt;=&nbsp;39.&nbsp;When&nbsp;value1&nbsp;=&nbsp;2,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4613346">//&nbsp;then&nbsp;there&nbsp;are&nbsp;no&nbsp;restrictions&nbsp;on&nbsp;value2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4613392">v</span><span class="op" id="4613393">,</span>&nbsp;<span class="ident" id="4613395">offset</span><span class="op" id="4613401">,</span>&nbsp;<span class="ident" id="4613403">err</span>&nbsp;<span class="op" id="4613407">:=</span>&nbsp;<span class="ident" id="4613410">parseBase128Int</span><span class="op" id="4613425">(</span><span class="ident" id="4613426">bytes</span><span class="op" id="4613431">,</span>&nbsp;<span class="num" id="4613433">0</span><span class="op" id="4613434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4613437">if</span>&nbsp;<span class="ident" id="4613440">err</span>&nbsp;<span class="op" id="4613444">!=</span>&nbsp;<span class="builtintype" id="4613447">nil</span>&nbsp;<span class="op" id="4613451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4613455">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4613463">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4613466">if</span>&nbsp;<span class="ident" id="4613469">v</span>&nbsp;<span class="op" id="4613471">&lt;</span>&nbsp;<span class="num" id="4613473">80</span>&nbsp;<span class="op" id="4613476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4613480">s</span><span class="op" id="4613481">[</span><span class="num" id="4613482">0</span><span class="op" id="4613483">]</span>&nbsp;<span class="op" id="4613485">=</span>&nbsp;<span class="ident" id="4613487">v</span>&nbsp;<span class="op" id="4613489">/</span>&nbsp;<span class="num" id="4613491">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4613496">s</span><span class="op" id="4613497">[</span><span class="num" id="4613498">1</span><span class="op" id="4613499">]</span>&nbsp;<span class="op" id="4613501">=</span>&nbsp;<span class="ident" id="4613503">v</span>&nbsp;<span class="op" id="4613505">%</span>&nbsp;<span class="num" id="4613507">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4613511">}</span>&nbsp;<span class="keyword" id="4613513">else</span>&nbsp;<span class="op" id="4613518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4613522">s</span><span class="op" id="4613523">[</span><span class="num" id="4613524">0</span><span class="op" id="4613525">]</span>&nbsp;<span class="op" id="4613527">=</span>&nbsp;<span class="num" id="4613529">2</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4613533">s</span><span class="op" id="4613534">[</span><span class="num" id="4613535">1</span><span class="op" id="4613536">]</span>&nbsp;<span class="op" id="4613538">=</span>&nbsp;<span class="ident" id="4613540">v</span>&nbsp;<span class="op" id="4613542">-</span>&nbsp;<span class="num" id="4613544">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4613548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4613552">i</span>&nbsp;<span class="op" id="4613554">:=</span>&nbsp;<span class="num" id="4613557">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4613560">for</span>&nbsp;<span class="op" id="4613564">;</span>&nbsp;<span class="ident" id="4613566">offset</span>&nbsp;<span class="op" id="4613573">&lt;</span>&nbsp;<span class="builtinfunc" id="4613575">len</span><span class="op" id="4613578">(</span><span class="ident" id="4613579">bytes</span><span class="op" id="4613584">)</span><span class="op" id="4613585">;</span>&nbsp;<span class="ident" id="4613587">i</span><span class="op" id="4613588">++</span>&nbsp;<span class="op" id="4613591">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4613595">v</span><span class="op" id="4613596">,</span>&nbsp;<span class="ident" id="4613598">offset</span><span class="op" id="4613604">,</span>&nbsp;<span class="ident" id="4613606">err</span>&nbsp;<span class="op" id="4613610">=</span>&nbsp;<span class="ident" id="4613612">parseBase128Int</span><span class="op" id="4613627">(</span><span class="ident" id="4613628">bytes</span><span class="op" id="4613633">,</span>&nbsp;<span class="ident" id="4613635">offset</span><span class="op" id="4613641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4613645">if</span>&nbsp;<span class="ident" id="4613648">err</span>&nbsp;<span class="op" id="4613652">!=</span>&nbsp;<span class="builtintype" id="4613655">nil</span>&nbsp;<span class="op" id="4613659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4613664">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4613673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4613677">s</span><span class="op" id="4613678">[</span><span class="ident" id="4613679">i</span><span class="op" id="4613680">]</span>&nbsp;<span class="op" id="4613682">=</span>&nbsp;<span class="ident" id="4613684">v</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4613687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4613690">s</span>&nbsp;<span class="op" id="4613692">=</span>&nbsp;<span class="ident" id="4613694">s</span><span class="op" id="4613695">[</span><span class="num" id="4613696">0</span><span class="op" id="4613697">:</span><span class="ident" id="4613698">i</span><span class="op" id="4613699">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4613702">return</span><br>
<span class="lineno"></span><span class="op" id="4613709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="4613712">//&nbsp;ENUMERATED</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4613727">//&nbsp;An&nbsp;Enumerated&nbsp;is&nbsp;represented&nbsp;as&nbsp;a&nbsp;plain&nbsp;int.</span><br>
<span class="lineno"></span><span class="keyword" id="4613775">type</span>&nbsp;<span class="ident" id="4613780">Enumerated</span>&nbsp;<span class="builtintype" id="4613791">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="4613796">//&nbsp;FLAG</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4613805">//&nbsp;A&nbsp;Flag&nbsp;accepts&nbsp;any&nbsp;data&nbsp;and&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="4613863">type</span>&nbsp;<span class="ident" id="4613868">Flag</span>&nbsp;<span class="builtintype" id="4613873">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="4613879">//&nbsp;parseBase128Int&nbsp;parses&nbsp;a&nbsp;base-128&nbsp;encoded&nbsp;int&nbsp;from&nbsp;the&nbsp;given&nbsp;offset&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4613957">//&nbsp;given&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;value&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.</span><br>
<span class="lineno"></span><span class="keyword" id="4614019">func</span>&nbsp;<span class="ident" id="4614024">parseBase128Int</span><span class="op" id="4614039">(</span><span class="ident" id="4614040">bytes</span>&nbsp;<span class="op" id="4614046">[</span><span class="op" id="4614047">]</span><span class="builtintype" id="4614048">byte</span><span class="op" id="4614052">,</span>&nbsp;<span class="ident" id="4614054">initOffset</span>&nbsp;<span class="builtintype" id="4614065">int</span><span class="op" id="4614068">)</span>&nbsp;<span class="op" id="4614070">(</span><span class="ident" id="4614071">ret</span><span class="op" id="4614074">,</span>&nbsp;<span class="ident" id="4614076">offset</span>&nbsp;<span class="builtintype" id="4614083">int</span><span class="op" id="4614086">,</span>&nbsp;<span class="ident" id="4614088">err</span>&nbsp;<span class="builtintype" id="4614092">error</span><span class="op" id="4614097">)</span>&nbsp;<span class="op" id="4614099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4614102">offset</span>&nbsp;<span class="op" id="4614109">=</span>&nbsp;<span class="ident" id="4614111">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4614123">for</span>&nbsp;<span class="ident" id="4614127">shifted</span>&nbsp;<span class="op" id="4614135">:=</span>&nbsp;<span class="num" id="4614138">0</span><span class="op" id="4614139">;</span>&nbsp;<span class="ident" id="4614141">offset</span>&nbsp;<span class="op" id="4614148">&lt;</span>&nbsp;<span class="builtinfunc" id="4614150">len</span><span class="op" id="4614153">(</span><span class="ident" id="4614154">bytes</span><span class="op" id="4614159">)</span><span class="op" id="4614160">;</span>&nbsp;<span class="ident" id="4614162">shifted</span><span class="op" id="4614169">++</span>&nbsp;<span class="op" id="4614172">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4614176">if</span>&nbsp;<span class="ident" id="4614179">shifted</span>&nbsp;<span class="op" id="4614187">&gt;</span>&nbsp;<span class="num" id="4614189">4</span>&nbsp;<span class="op" id="4614191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4614196">err</span>&nbsp;<span class="op" id="4614200">=</span>&nbsp;<span class="ident" id="4614202">StructuralError</span><span class="op" id="4614217">{</span><span class="string" id="4614218">&#34;base&nbsp;128&nbsp;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4614246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4614251">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4614260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4614264">ret</span>&nbsp;<span class="op" id="4614268">&lt;&lt;=</span>&nbsp;<span class="num" id="4614272">7</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4614276">b</span>&nbsp;<span class="op" id="4614278">:=</span>&nbsp;<span class="ident" id="4614281">bytes</span><span class="op" id="4614286">[</span><span class="ident" id="4614287">offset</span><span class="op" id="4614293">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4614297">ret</span>&nbsp;<span class="op" id="4614301">|=</span>&nbsp;<span class="builtintype" id="4614304">int</span><span class="op" id="4614307">(</span><span class="ident" id="4614308">b</span>&nbsp;<span class="op" id="4614310">&amp;</span>&nbsp;<span class="num" id="4614312">0x7f</span><span class="op" id="4614316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4614320">offset</span><span class="op" id="4614326">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4614331">if</span>&nbsp;<span class="ident" id="4614334">b</span><span class="op" id="4614335">&amp;</span><span class="num" id="4614336">0x80</span>&nbsp;<span class="op" id="4614341">==</span>&nbsp;<span class="num" id="4614344">0</span>&nbsp;<span class="op" id="4614346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4614351">return</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4614360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4614363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4614366">err</span>&nbsp;<span class="op" id="4614370">=</span>&nbsp;<span class="ident" id="4614372">SyntaxError</span><span class="op" id="4614383">{</span><span class="string" id="4614384">&#34;truncated&nbsp;base&nbsp;128&nbsp;integer&#34;</span><span class="op" id="4614412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4614415">return</span><br>
<span class="lineno"></span><span class="op" id="4614422">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="4614425">//&nbsp;UTCTime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4614437">func</span>&nbsp;<span class="ident" id="4614442">parseUTCTime</span><span class="op" id="4614454">(</span><span class="ident" id="4614455">bytes</span>&nbsp;<span class="op" id="4614461">[</span><span class="op" id="4614462">]</span><span class="builtintype" id="4614463">byte</span><span class="op" id="4614467">)</span>&nbsp;<span class="op" id="4614469">(</span><span class="ident" id="4614470">ret</span>&nbsp;<span class="ident" id="4614474">time</span><span class="op" id="4614478">.</span><span class="ident" id="4614479">Time</span><span class="op" id="4614483">,</span>&nbsp;<span class="ident" id="4614485">err</span>&nbsp;<span class="builtintype" id="4614489">error</span><span class="op" id="4614494">)</span>&nbsp;<span class="op" id="4614496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4614499">s</span>&nbsp;<span class="op" id="4614501">:=</span>&nbsp;<span class="builtintype" id="4614504">string</span><span class="op" id="4614510">(</span><span class="ident" id="4614511">bytes</span><span class="op" id="4614516">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4614519">ret</span><span class="op" id="4614522">,</span>&nbsp;<span class="ident" id="4614524">err</span>&nbsp;<span class="op" id="4614528">=</span>&nbsp;<span class="ident" id="4614530">time</span><span class="op" id="4614534">.</span><span class="ident" id="4614535">Parse</span><span class="op" id="4614540">(</span><span class="string" id="4614541">&#34;0601021504Z0700&#34;</span><span class="op" id="4614558">,</span>&nbsp;<span class="ident" id="4614560">s</span><span class="op" id="4614561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4614564">if</span>&nbsp;<span class="ident" id="4614567">err</span>&nbsp;<span class="op" id="4614571">!=</span>&nbsp;<span class="builtintype" id="4614574">nil</span>&nbsp;<span class="op" id="4614578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4614582">ret</span><span class="op" id="4614585">,</span>&nbsp;<span class="ident" id="4614587">err</span>&nbsp;<span class="op" id="4614591">=</span>&nbsp;<span class="ident" id="4614593">time</span><span class="op" id="4614597">.</span><span class="ident" id="4614598">Parse</span><span class="op" id="4614603">(</span><span class="string" id="4614604">&#34;060102150405Z0700&#34;</span><span class="op" id="4614623">,</span>&nbsp;<span class="ident" id="4614625">s</span><span class="op" id="4614626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4614629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4614632">if</span>&nbsp;<span class="ident" id="4614635">err</span>&nbsp;<span class="op" id="4614639">==</span>&nbsp;<span class="builtintype" id="4614642">nil</span>&nbsp;<span class="op" id="4614646">&amp;&amp;</span>&nbsp;<span class="ident" id="4614649">ret</span><span class="op" id="4614652">.</span><span class="ident" id="4614653">Year</span><span class="op" id="4614657">(</span><span class="op" id="4614658">)</span>&nbsp;<span class="op" id="4614660">&gt;=</span>&nbsp;<span class="num" id="4614663">2050</span>&nbsp;<span class="op" id="4614668">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4614672">//&nbsp;UTCTime&nbsp;only&nbsp;encodes&nbsp;times&nbsp;prior&nbsp;to&nbsp;2050.&nbsp;See&nbsp;https://tools.ietf.org/html/rfc5280#section-4.1.2.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4614777">ret</span>&nbsp;<span class="op" id="4614781">=</span>&nbsp;<span class="ident" id="4614783">ret</span><span class="op" id="4614786">.</span><span class="ident" id="4614787">AddDate</span><span class="op" id="4614794">(</span><span class="op" id="4614795">-</span><span class="num" id="4614796">100</span><span class="op" id="4614799">,</span>&nbsp;<span class="num" id="4614801">0</span><span class="op" id="4614802">,</span>&nbsp;<span class="num" id="4614804">0</span><span class="op" id="4614805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4614808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4614812">return</span><br>
<span class="lineno">300</span><span class="op" id="4614819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4614822">//&nbsp;parseGeneralizedTime&nbsp;parses&nbsp;the&nbsp;GeneralizedTime&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="4614899">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="4614934">func</span>&nbsp;<span class="ident" id="4614939">parseGeneralizedTime</span><span class="op" id="4614959">(</span><span class="ident" id="4614960">bytes</span>&nbsp;<span class="op" id="4614966">[</span><span class="op" id="4614967">]</span><span class="builtintype" id="4614968">byte</span><span class="op" id="4614972">)</span>&nbsp;<span class="op" id="4614974">(</span><span class="ident" id="4614975">ret</span>&nbsp;<span class="ident" id="4614979">time</span><span class="op" id="4614983">.</span><span class="ident" id="4614984">Time</span><span class="op" id="4614988">,</span>&nbsp;<span class="ident" id="4614990">err</span>&nbsp;<span class="builtintype" id="4614994">error</span><span class="op" id="4614999">)</span>&nbsp;<span class="op" id="4615001">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4615004">return</span>&nbsp;<span class="ident" id="4615011">time</span><span class="op" id="4615015">.</span><span class="ident" id="4615016">Parse</span><span class="op" id="4615021">(</span><span class="string" id="4615022">&#34;20060102150405Z0700&#34;</span><span class="op" id="4615043">,</span>&nbsp;<span class="builtintype" id="4615045">string</span><span class="op" id="4615051">(</span><span class="ident" id="4615052">bytes</span><span class="op" id="4615057">)</span><span class="op" id="4615058">)</span><br>
<span class="lineno"></span><span class="op" id="4615060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4615063">//&nbsp;PrintableString</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="4615083">//&nbsp;parsePrintableString&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;PrintableString&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="4615158">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4615183">func</span>&nbsp;<span class="ident" id="4615188">parsePrintableString</span><span class="op" id="4615208">(</span><span class="ident" id="4615209">bytes</span>&nbsp;<span class="op" id="4615215">[</span><span class="op" id="4615216">]</span><span class="builtintype" id="4615217">byte</span><span class="op" id="4615221">)</span>&nbsp;<span class="op" id="4615223">(</span><span class="ident" id="4615224">ret</span>&nbsp;<span class="builtintype" id="4615228">string</span><span class="op" id="4615234">,</span>&nbsp;<span class="ident" id="4615236">err</span>&nbsp;<span class="builtintype" id="4615240">error</span><span class="op" id="4615245">)</span>&nbsp;<span class="op" id="4615247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4615250">for</span>&nbsp;<span class="ident" id="4615254">_</span><span class="op" id="4615255">,</span>&nbsp;<span class="ident" id="4615257">b</span>&nbsp;<span class="op" id="4615259">:=</span>&nbsp;<span class="keyword" id="4615262">range</span>&nbsp;<span class="ident" id="4615268">bytes</span>&nbsp;<span class="op" id="4615274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4615278">if</span>&nbsp;<span class="op" id="4615281">!</span><span class="ident" id="4615282">isPrintable</span><span class="op" id="4615293">(</span><span class="ident" id="4615294">b</span><span class="op" id="4615295">)</span>&nbsp;<span class="op" id="4615297">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4615302">err</span>&nbsp;<span class="op" id="4615306">=</span>&nbsp;<span class="ident" id="4615308">SyntaxError</span><span class="op" id="4615319">{</span><span class="string" id="4615320">&#34;PrintableString&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4615364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4615369">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4615378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4615381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4615384">ret</span>&nbsp;<span class="op" id="4615388">=</span>&nbsp;<span class="builtintype" id="4615390">string</span><span class="op" id="4615396">(</span><span class="ident" id="4615397">bytes</span><span class="op" id="4615402">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4615405">return</span><br>
<span class="lineno"></span><span class="op" id="4615412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4615415">//&nbsp;isPrintable&nbsp;returns&nbsp;true&nbsp;iff&nbsp;the&nbsp;given&nbsp;b&nbsp;is&nbsp;in&nbsp;the&nbsp;ASN.1&nbsp;PrintableString&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="4615496">func</span>&nbsp;<span class="ident" id="4615501">isPrintable</span><span class="op" id="4615512">(</span><span class="ident" id="4615513">b</span>&nbsp;<span class="builtintype" id="4615515">byte</span><span class="op" id="4615519">)</span>&nbsp;<span class="builtintype" id="4615521">bool</span>&nbsp;<span class="op" id="4615526">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4615529">return</span>&nbsp;<span class="string" id="4615536">&#39;a&#39;</span>&nbsp;<span class="op" id="4615540">&lt;=</span>&nbsp;<span class="ident" id="4615543">b</span>&nbsp;<span class="op" id="4615545">&amp;&amp;</span>&nbsp;<span class="ident" id="4615548">b</span>&nbsp;<span class="op" id="4615550">&lt;=</span>&nbsp;<span class="string" id="4615553">&#39;z&#39;</span>&nbsp;<span class="op" id="4615557">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4615562">&#39;A&#39;</span>&nbsp;<span class="op" id="4615566">&lt;=</span>&nbsp;<span class="ident" id="4615569">b</span>&nbsp;<span class="op" id="4615571">&amp;&amp;</span>&nbsp;<span class="ident" id="4615574">b</span>&nbsp;<span class="op" id="4615576">&lt;=</span>&nbsp;<span class="string" id="4615579">&#39;Z&#39;</span>&nbsp;<span class="op" id="4615583">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4615588">&#39;0&#39;</span>&nbsp;<span class="op" id="4615592">&lt;=</span>&nbsp;<span class="ident" id="4615595">b</span>&nbsp;<span class="op" id="4615597">&amp;&amp;</span>&nbsp;<span class="ident" id="4615600">b</span>&nbsp;<span class="op" id="4615602">&lt;=</span>&nbsp;<span class="string" id="4615605">&#39;9&#39;</span>&nbsp;<span class="op" id="4615609">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4615614">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="4615619">&lt;=</span>&nbsp;<span class="ident" id="4615622">b</span>&nbsp;<span class="op" id="4615624">&amp;&amp;</span>&nbsp;<span class="ident" id="4615627">b</span>&nbsp;<span class="op" id="4615629">&lt;=</span>&nbsp;<span class="string" id="4615632">&#39;)&#39;</span>&nbsp;<span class="op" id="4615636">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4615641">&#39;+&#39;</span>&nbsp;<span class="op" id="4615645">&lt;=</span>&nbsp;<span class="ident" id="4615648">b</span>&nbsp;<span class="op" id="4615650">&amp;&amp;</span>&nbsp;<span class="ident" id="4615653">b</span>&nbsp;<span class="op" id="4615655">&lt;=</span>&nbsp;<span class="string" id="4615658">&#39;/&#39;</span>&nbsp;<span class="op" id="4615662">||</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4615667">b</span>&nbsp;<span class="op" id="4615669">==</span>&nbsp;<span class="string" id="4615672">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4615676">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4615681">b</span>&nbsp;<span class="op" id="4615683">==</span>&nbsp;<span class="string" id="4615686">&#39;:&#39;</span>&nbsp;<span class="op" id="4615690">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4615695">b</span>&nbsp;<span class="op" id="4615697">==</span>&nbsp;<span class="string" id="4615700">&#39;=&#39;</span>&nbsp;<span class="op" id="4615704">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4615709">b</span>&nbsp;<span class="op" id="4615711">==</span>&nbsp;<span class="string" id="4615714">&#39;?&#39;</span>&nbsp;<span class="op" id="4615718">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4615723">//&nbsp;This&nbsp;is&nbsp;technically&nbsp;not&nbsp;allowed&nbsp;in&nbsp;a&nbsp;PrintableString.</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4615782">//&nbsp;However,&nbsp;x509&nbsp;certificates&nbsp;with&nbsp;wildcard&nbsp;strings&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4615842">//&nbsp;always&nbsp;use&nbsp;the&nbsp;correct&nbsp;string&nbsp;type&nbsp;so&nbsp;we&nbsp;permit&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4615899">b</span>&nbsp;<span class="op" id="4615901">==</span>&nbsp;<span class="string" id="4615904">&#39;*&#39;</span><br>
<span class="lineno"></span><span class="op" id="4615908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="comment" id="4615911">//&nbsp;IA5String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4615925">//&nbsp;parseIA5String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;IA5String&nbsp;(ASCII&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4615998">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4616028">func</span>&nbsp;<span class="ident" id="4616033">parseIA5String</span><span class="op" id="4616047">(</span><span class="ident" id="4616048">bytes</span>&nbsp;<span class="op" id="4616054">[</span><span class="op" id="4616055">]</span><span class="builtintype" id="4616056">byte</span><span class="op" id="4616060">)</span>&nbsp;<span class="op" id="4616062">(</span><span class="ident" id="4616063">ret</span>&nbsp;<span class="builtintype" id="4616067">string</span><span class="op" id="4616073">,</span>&nbsp;<span class="ident" id="4616075">err</span>&nbsp;<span class="builtintype" id="4616079">error</span><span class="op" id="4616084">)</span>&nbsp;<span class="op" id="4616086">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4616089">for</span>&nbsp;<span class="ident" id="4616093">_</span><span class="op" id="4616094">,</span>&nbsp;<span class="ident" id="4616096">b</span>&nbsp;<span class="op" id="4616098">:=</span>&nbsp;<span class="keyword" id="4616101">range</span>&nbsp;<span class="ident" id="4616107">bytes</span>&nbsp;<span class="op" id="4616113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4616117">if</span>&nbsp;<span class="ident" id="4616120">b</span>&nbsp;<span class="op" id="4616122">&gt;=</span>&nbsp;<span class="num" id="4616125">0x80</span>&nbsp;<span class="op" id="4616130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4616135">err</span>&nbsp;<span class="op" id="4616139">=</span>&nbsp;<span class="ident" id="4616141">SyntaxError</span><span class="op" id="4616152">{</span><span class="string" id="4616153">&#34;IA5String&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4616191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4616196">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4616205">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4616208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4616211">ret</span>&nbsp;<span class="op" id="4616215">=</span>&nbsp;<span class="builtintype" id="4616217">string</span><span class="op" id="4616223">(</span><span class="ident" id="4616224">bytes</span><span class="op" id="4616229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4616232">return</span><br>
<span class="lineno"></span><span class="op" id="4616239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="4616242">//&nbsp;T61String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4616256">//&nbsp;parseT61String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;T61String&nbsp;(8-bit&nbsp;clean&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4616335">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4616365">func</span>&nbsp;<span class="ident" id="4616370">parseT61String</span><span class="op" id="4616384">(</span><span class="ident" id="4616385">bytes</span>&nbsp;<span class="op" id="4616391">[</span><span class="op" id="4616392">]</span><span class="builtintype" id="4616393">byte</span><span class="op" id="4616397">)</span>&nbsp;<span class="op" id="4616399">(</span><span class="ident" id="4616400">ret</span>&nbsp;<span class="builtintype" id="4616404">string</span><span class="op" id="4616410">,</span>&nbsp;<span class="ident" id="4616412">err</span>&nbsp;<span class="builtintype" id="4616416">error</span><span class="op" id="4616421">)</span>&nbsp;<span class="op" id="4616423">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4616426">return</span>&nbsp;<span class="builtintype" id="4616433">string</span><span class="op" id="4616439">(</span><span class="ident" id="4616440">bytes</span><span class="op" id="4616445">)</span><span class="op" id="4616446">,</span>&nbsp;<span class="builtintype" id="4616448">nil</span><br>
<span class="lineno"></span><span class="op" id="4616452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4616455">//&nbsp;UTF8String</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="4616470">//&nbsp;parseUTF8String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;UTF8String&nbsp;(raw&nbsp;UTF-8)&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="4616547">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4616572">func</span>&nbsp;<span class="ident" id="4616577">parseUTF8String</span><span class="op" id="4616592">(</span><span class="ident" id="4616593">bytes</span>&nbsp;<span class="op" id="4616599">[</span><span class="op" id="4616600">]</span><span class="builtintype" id="4616601">byte</span><span class="op" id="4616605">)</span>&nbsp;<span class="op" id="4616607">(</span><span class="ident" id="4616608">ret</span>&nbsp;<span class="builtintype" id="4616612">string</span><span class="op" id="4616618">,</span>&nbsp;<span class="ident" id="4616620">err</span>&nbsp;<span class="builtintype" id="4616624">error</span><span class="op" id="4616629">)</span>&nbsp;<span class="op" id="4616631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4616634">return</span>&nbsp;<span class="builtintype" id="4616641">string</span><span class="op" id="4616647">(</span><span class="ident" id="4616648">bytes</span><span class="op" id="4616653">)</span><span class="op" id="4616654">,</span>&nbsp;<span class="builtintype" id="4616656">nil</span><br>
<span class="lineno"></span><span class="op" id="4616660">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="4616663">//&nbsp;A&nbsp;RawValue&nbsp;represents&nbsp;an&nbsp;undecoded&nbsp;ASN.1&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="4616715">type</span>&nbsp;<span class="ident" id="4616720">RawValue</span>&nbsp;<span class="keyword" id="4616729">struct</span>&nbsp;<span class="op" id="4616736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4616739">Class</span><span class="op" id="4616744">,</span>&nbsp;<span class="ident" id="4616746">Tag</span>&nbsp;<span class="builtintype" id="4616750">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4616755">IsCompound</span>&nbsp;<span class="builtintype" id="4616766">bool</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4616772">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4616783">[</span><span class="op" id="4616784">]</span><span class="builtintype" id="4616785">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4616791">FullBytes</span>&nbsp;&nbsp;<span class="op" id="4616802">[</span><span class="op" id="4616803">]</span><span class="builtintype" id="4616804">byte</span>&nbsp;<span class="comment" id="4616809">//&nbsp;includes&nbsp;the&nbsp;tag&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span><span class="op" id="4616840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4616843">//&nbsp;RawContent&nbsp;is&nbsp;used&nbsp;to&nbsp;signal&nbsp;that&nbsp;the&nbsp;undecoded,&nbsp;DER&nbsp;data&nbsp;needs&nbsp;to&nbsp;be</span><br>
<span class="lineno">380</span><span class="comment" id="4616916">//&nbsp;preserved&nbsp;for&nbsp;a&nbsp;struct.&nbsp;To&nbsp;use&nbsp;it,&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;the&nbsp;struct&nbsp;must&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="4616994">//&nbsp;this&nbsp;type.&nbsp;It&#39;s&nbsp;an&nbsp;error&nbsp;for&nbsp;any&nbsp;of&nbsp;the&nbsp;other&nbsp;fields&nbsp;to&nbsp;have&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4617069">type</span>&nbsp;<span class="ident" id="4617074">RawContent</span>&nbsp;<span class="op" id="4617085">[</span><span class="op" id="4617086">]</span><span class="builtintype" id="4617087">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4617093">//&nbsp;Tagging</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span><span class="comment" id="4617105">//&nbsp;parseTagAndLength&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;tag&nbsp;and&nbsp;length&nbsp;pair&nbsp;from&nbsp;the&nbsp;given&nbsp;offset</span><br>
<span class="lineno"></span><span class="comment" id="4617184">//&nbsp;into&nbsp;a&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;parsed&nbsp;data&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.&nbsp;SET&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4617261">//&nbsp;SET&nbsp;OF&nbsp;(tag&nbsp;17)&nbsp;are&nbsp;mapped&nbsp;to&nbsp;SEQUENCE&nbsp;and&nbsp;SEQUENCE&nbsp;OF&nbsp;(tag&nbsp;16)&nbsp;since&nbsp;we</span><br>
<span class="lineno"></span><span class="comment" id="4617337">//&nbsp;don&#39;t&nbsp;distinguish&nbsp;between&nbsp;ordered&nbsp;and&nbsp;unordered&nbsp;objects&nbsp;in&nbsp;this&nbsp;code.</span><br>
<span class="lineno">390</span><span class="keyword" id="4617410">func</span>&nbsp;<span class="ident" id="4617415">parseTagAndLength</span><span class="op" id="4617432">(</span><span class="ident" id="4617433">bytes</span>&nbsp;<span class="op" id="4617439">[</span><span class="op" id="4617440">]</span><span class="builtintype" id="4617441">byte</span><span class="op" id="4617445">,</span>&nbsp;<span class="ident" id="4617447">initOffset</span>&nbsp;<span class="builtintype" id="4617458">int</span><span class="op" id="4617461">)</span>&nbsp;<span class="op" id="4617463">(</span><span class="ident" id="4617464">ret</span>&nbsp;<span class="ident" id="4617468">tagAndLength</span><span class="op" id="4617480">,</span>&nbsp;<span class="ident" id="4617482">offset</span>&nbsp;<span class="builtintype" id="4617489">int</span><span class="op" id="4617492">,</span>&nbsp;<span class="ident" id="4617494">err</span>&nbsp;<span class="builtintype" id="4617498">error</span><span class="op" id="4617503">)</span>&nbsp;<span class="op" id="4617505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617508">offset</span>&nbsp;<span class="op" id="4617515">=</span>&nbsp;<span class="ident" id="4617517">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617529">b</span>&nbsp;<span class="op" id="4617531">:=</span>&nbsp;<span class="ident" id="4617534">bytes</span><span class="op" id="4617539">[</span><span class="ident" id="4617540">offset</span><span class="op" id="4617546">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617549">offset</span><span class="op" id="4617555">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617559">ret</span><span class="op" id="4617562">.</span><span class="ident" id="4617563">class</span>&nbsp;<span class="op" id="4617569">=</span>&nbsp;<span class="builtintype" id="4617571">int</span><span class="op" id="4617574">(</span><span class="ident" id="4617575">b</span>&nbsp;<span class="op" id="4617577">&gt;&gt;</span>&nbsp;<span class="num" id="4617580">6</span><span class="op" id="4617581">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617584">ret</span><span class="op" id="4617587">.</span><span class="ident" id="4617588">isCompound</span>&nbsp;<span class="op" id="4617599">=</span>&nbsp;<span class="ident" id="4617601">b</span><span class="op" id="4617602">&amp;</span><span class="num" id="4617603">0x20</span>&nbsp;<span class="op" id="4617608">==</span>&nbsp;<span class="num" id="4617611">0x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617617">ret</span><span class="op" id="4617620">.</span><span class="ident" id="4617621">tag</span>&nbsp;<span class="op" id="4617625">=</span>&nbsp;<span class="builtintype" id="4617627">int</span><span class="op" id="4617630">(</span><span class="ident" id="4617631">b</span>&nbsp;<span class="op" id="4617633">&amp;</span>&nbsp;<span class="num" id="4617635">0x1f</span><span class="op" id="4617639">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4617643">//&nbsp;If&nbsp;the&nbsp;bottom&nbsp;five&nbsp;bits&nbsp;are&nbsp;set,&nbsp;then&nbsp;the&nbsp;tag&nbsp;number&nbsp;is&nbsp;actually&nbsp;base&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4617721">//&nbsp;encoded&nbsp;afterwards</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4617744">if</span>&nbsp;<span class="ident" id="4617747">ret</span><span class="op" id="4617750">.</span><span class="ident" id="4617751">tag</span>&nbsp;<span class="op" id="4617755">==</span>&nbsp;<span class="num" id="4617758">0x1f</span>&nbsp;<span class="op" id="4617763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617767">ret</span><span class="op" id="4617770">.</span><span class="ident" id="4617771">tag</span><span class="op" id="4617774">,</span>&nbsp;<span class="ident" id="4617776">offset</span><span class="op" id="4617782">,</span>&nbsp;<span class="ident" id="4617784">err</span>&nbsp;<span class="op" id="4617788">=</span>&nbsp;<span class="ident" id="4617790">parseBase128Int</span><span class="op" id="4617805">(</span><span class="ident" id="4617806">bytes</span><span class="op" id="4617811">,</span>&nbsp;<span class="ident" id="4617813">offset</span><span class="op" id="4617819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4617823">if</span>&nbsp;<span class="ident" id="4617826">err</span>&nbsp;<span class="op" id="4617830">!=</span>&nbsp;<span class="builtintype" id="4617833">nil</span>&nbsp;<span class="op" id="4617837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4617842">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4617851">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4617854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4617857">if</span>&nbsp;<span class="ident" id="4617860">offset</span>&nbsp;<span class="op" id="4617867">&gt;=</span>&nbsp;<span class="builtinfunc" id="4617870">len</span><span class="op" id="4617873">(</span><span class="ident" id="4617874">bytes</span><span class="op" id="4617879">)</span>&nbsp;<span class="op" id="4617881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617885">err</span>&nbsp;<span class="op" id="4617889">=</span>&nbsp;<span class="ident" id="4617891">SyntaxError</span><span class="op" id="4617902">{</span><span class="string" id="4617903">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="4617928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4617932">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4617940">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617943">b</span>&nbsp;<span class="op" id="4617945">=</span>&nbsp;<span class="ident" id="4617947">bytes</span><span class="op" id="4617952">[</span><span class="ident" id="4617953">offset</span><span class="op" id="4617959">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617962">offset</span><span class="op" id="4617968">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4617972">if</span>&nbsp;<span class="ident" id="4617975">b</span><span class="op" id="4617976">&amp;</span><span class="num" id="4617977">0x80</span>&nbsp;<span class="op" id="4617982">==</span>&nbsp;<span class="num" id="4617985">0</span>&nbsp;<span class="op" id="4617987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4617991">//&nbsp;The&nbsp;length&nbsp;is&nbsp;encoded&nbsp;in&nbsp;the&nbsp;bottom&nbsp;7&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4618040">ret</span><span class="op" id="4618043">.</span><span class="ident" id="4618044">length</span>&nbsp;<span class="op" id="4618051">=</span>&nbsp;<span class="builtintype" id="4618053">int</span><span class="op" id="4618056">(</span><span class="ident" id="4618057">b</span>&nbsp;<span class="op" id="4618059">&amp;</span>&nbsp;<span class="num" id="4618061">0x7f</span><span class="op" id="4618065">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4618068">}</span>&nbsp;<span class="keyword" id="4618070">else</span>&nbsp;<span class="op" id="4618075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4618079">//&nbsp;Bottom&nbsp;7&nbsp;bits&nbsp;give&nbsp;the&nbsp;number&nbsp;of&nbsp;length&nbsp;bytes&nbsp;to&nbsp;follow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4618141">numBytes</span>&nbsp;<span class="op" id="4618150">:=</span>&nbsp;<span class="builtintype" id="4618153">int</span><span class="op" id="4618156">(</span><span class="ident" id="4618157">b</span>&nbsp;<span class="op" id="4618159">&amp;</span>&nbsp;<span class="num" id="4618161">0x7f</span><span class="op" id="4618165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4618169">if</span>&nbsp;<span class="ident" id="4618172">numBytes</span>&nbsp;<span class="op" id="4618181">==</span>&nbsp;<span class="num" id="4618184">0</span>&nbsp;<span class="op" id="4618186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4618191">err</span>&nbsp;<span class="op" id="4618195">=</span>&nbsp;<span class="ident" id="4618197">SyntaxError</span><span class="op" id="4618208">{</span><span class="string" id="4618209">&#34;indefinite&nbsp;length&nbsp;found&nbsp;(not&nbsp;DER)&#34;</span><span class="op" id="4618244">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4618249">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4618258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4618262">ret</span><span class="op" id="4618265">.</span><span class="ident" id="4618266">length</span>&nbsp;<span class="op" id="4618273">=</span>&nbsp;<span class="num" id="4618275">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4618279">for</span>&nbsp;<span class="ident" id="4618283">i</span>&nbsp;<span class="op" id="4618285">:=</span>&nbsp;<span class="num" id="4618288">0</span><span class="op" id="4618289">;</span>&nbsp;<span class="ident" id="4618291">i</span>&nbsp;<span class="op" id="4618293">&lt;</span>&nbsp;<span class="ident" id="4618295">numBytes</span><span class="op" id="4618303">;</span>&nbsp;<span class="ident" id="4618305">i</span><span class="op" id="4618306">++</span>&nbsp;<span class="op" id="4618309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4618314">if</span>&nbsp;<span class="ident" id="4618317">offset</span>&nbsp;<span class="op" id="4618324">&gt;=</span>&nbsp;<span class="builtinfunc" id="4618327">len</span><span class="op" id="4618330">(</span><span class="ident" id="4618331">bytes</span><span class="op" id="4618336">)</span>&nbsp;<span class="op" id="4618338">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4618344">err</span>&nbsp;<span class="op" id="4618348">=</span>&nbsp;<span class="ident" id="4618350">SyntaxError</span><span class="op" id="4618361">{</span><span class="string" id="4618362">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="4618387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4618393">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4618403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4618408">b</span>&nbsp;<span class="op" id="4618410">=</span>&nbsp;<span class="ident" id="4618412">bytes</span><span class="op" id="4618417">[</span><span class="ident" id="4618418">offset</span><span class="op" id="4618424">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4618429">offset</span><span class="op" id="4618435">++</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4618441">if</span>&nbsp;<span class="ident" id="4618444">ret</span><span class="op" id="4618447">.</span><span class="ident" id="4618448">length</span>&nbsp;<span class="op" id="4618455">&gt;=</span>&nbsp;<span class="num" id="4618458">1</span><span class="op" id="4618459">&lt;&lt;</span><span class="num" id="4618461">23</span>&nbsp;<span class="op" id="4618464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4618470">//&nbsp;We&nbsp;can&#39;t&nbsp;shift&nbsp;ret.length&nbsp;up&nbsp;without</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4618514">//&nbsp;overflowing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4618534">err</span>&nbsp;<span class="op" id="4618538">=</span>&nbsp;<span class="ident" id="4618540">StructuralError</span><span class="op" id="4618555">{</span><span class="string" id="4618556">&#34;length&nbsp;too&nbsp;large&#34;</span><span class="op" id="4618574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4618580">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4618590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4618595">ret</span><span class="op" id="4618598">.</span><span class="ident" id="4618599">length</span>&nbsp;<span class="op" id="4618606">&lt;&lt;=</span>&nbsp;<span class="num" id="4618610">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4618615">ret</span><span class="op" id="4618618">.</span><span class="ident" id="4618619">length</span>&nbsp;<span class="op" id="4618626">|=</span>&nbsp;<span class="builtintype" id="4618629">int</span><span class="op" id="4618632">(</span><span class="ident" id="4618633">b</span><span class="op" id="4618634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4618639">if</span>&nbsp;<span class="ident" id="4618642">ret</span><span class="op" id="4618645">.</span><span class="ident" id="4618646">length</span>&nbsp;<span class="op" id="4618653">==</span>&nbsp;<span class="num" id="4618656">0</span>&nbsp;<span class="op" id="4618658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4618664">//&nbsp;DER&nbsp;requires&nbsp;that&nbsp;lengths&nbsp;be&nbsp;minimal.</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4618709">err</span>&nbsp;<span class="op" id="4618713">=</span>&nbsp;<span class="ident" id="4618715">StructuralError</span><span class="op" id="4618730">{</span><span class="string" id="4618731">&#34;superfluous&nbsp;leading&nbsp;zeros&nbsp;in&nbsp;length&#34;</span><span class="op" id="4618768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4618774">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4618784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4618788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4618791">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4618795">return</span><br>
<span class="lineno"></span><span class="op" id="4618802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4618805">//&nbsp;parseSequenceOf&nbsp;is&nbsp;used&nbsp;for&nbsp;SEQUENCE&nbsp;OF&nbsp;and&nbsp;SET&nbsp;OF&nbsp;values.&nbsp;It&nbsp;tries&nbsp;to&nbsp;parse</span><br>
<span class="lineno">450</span><span class="comment" id="4618885">//&nbsp;a&nbsp;number&nbsp;of&nbsp;ASN.1&nbsp;values&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;them&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4618961">//&nbsp;slice&nbsp;of&nbsp;Go&nbsp;values&nbsp;of&nbsp;the&nbsp;given&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4619002">func</span>&nbsp;<span class="ident" id="4619007">parseSequenceOf</span><span class="op" id="4619022">(</span><span class="ident" id="4619023">bytes</span>&nbsp;<span class="op" id="4619029">[</span><span class="op" id="4619030">]</span><span class="builtintype" id="4619031">byte</span><span class="op" id="4619035">,</span>&nbsp;<span class="ident" id="4619037">sliceType</span>&nbsp;<span class="ident" id="4619047">reflect</span><span class="op" id="4619054">.</span><span class="ident" id="4619055">Type</span><span class="op" id="4619059">,</span>&nbsp;<span class="ident" id="4619061">elemType</span>&nbsp;<span class="ident" id="4619070">reflect</span><span class="op" id="4619077">.</span><span class="ident" id="4619078">Type</span><span class="op" id="4619082">)</span>&nbsp;<span class="op" id="4619084">(</span><span class="ident" id="4619085">ret</span>&nbsp;<span class="ident" id="4619089">reflect</span><span class="op" id="4619096">.</span><span class="ident" id="4619097">Value</span><span class="op" id="4619102">,</span>&nbsp;<span class="ident" id="4619104">err</span>&nbsp;<span class="builtintype" id="4619108">error</span><span class="op" id="4619113">)</span>&nbsp;<span class="op" id="4619115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4619118">expectedTag</span><span class="op" id="4619129">,</span>&nbsp;<span class="ident" id="4619131">compoundType</span><span class="op" id="4619143">,</span>&nbsp;<span class="ident" id="4619145">ok</span>&nbsp;<span class="op" id="4619148">:=</span>&nbsp;<span class="ident" id="4619151">getUniversalType</span><span class="op" id="4619167">(</span><span class="ident" id="4619168">elemType</span><span class="op" id="4619176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4619179">if</span>&nbsp;<span class="op" id="4619182">!</span><span class="ident" id="4619183">ok</span>&nbsp;<span class="op" id="4619186">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4619190">err</span>&nbsp;<span class="op" id="4619194">=</span>&nbsp;<span class="ident" id="4619196">StructuralError</span><span class="op" id="4619211">{</span><span class="string" id="4619212">&#34;unknown&nbsp;Go&nbsp;type&nbsp;for&nbsp;slice&#34;</span><span class="op" id="4619239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4619243">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4619251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4619255">//&nbsp;First&nbsp;we&nbsp;iterate&nbsp;over&nbsp;the&nbsp;input&nbsp;and&nbsp;count&nbsp;the&nbsp;number&nbsp;of&nbsp;elements,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4619325">//&nbsp;checking&nbsp;that&nbsp;the&nbsp;types&nbsp;are&nbsp;correct&nbsp;in&nbsp;each&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4619379">numElements</span>&nbsp;<span class="op" id="4619391">:=</span>&nbsp;<span class="num" id="4619394">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4619397">for</span>&nbsp;<span class="ident" id="4619401">offset</span>&nbsp;<span class="op" id="4619408">:=</span>&nbsp;<span class="num" id="4619411">0</span><span class="op" id="4619412">;</span>&nbsp;<span class="ident" id="4619414">offset</span>&nbsp;<span class="op" id="4619421">&lt;</span>&nbsp;<span class="builtinfunc" id="4619423">len</span><span class="op" id="4619426">(</span><span class="ident" id="4619427">bytes</span><span class="op" id="4619432">)</span><span class="op" id="4619433">;</span>&nbsp;<span class="op" id="4619435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4619439">var</span>&nbsp;<span class="ident" id="4619443">t</span>&nbsp;<span class="ident" id="4619445">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4619460">t</span><span class="op" id="4619461">,</span>&nbsp;<span class="ident" id="4619463">offset</span><span class="op" id="4619469">,</span>&nbsp;<span class="ident" id="4619471">err</span>&nbsp;<span class="op" id="4619475">=</span>&nbsp;<span class="ident" id="4619477">parseTagAndLength</span><span class="op" id="4619494">(</span><span class="ident" id="4619495">bytes</span><span class="op" id="4619500">,</span>&nbsp;<span class="ident" id="4619502">offset</span><span class="op" id="4619508">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4619512">if</span>&nbsp;<span class="ident" id="4619515">err</span>&nbsp;<span class="op" id="4619519">!=</span>&nbsp;<span class="builtintype" id="4619522">nil</span>&nbsp;<span class="op" id="4619526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4619531">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4619540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4619544">switch</span>&nbsp;<span class="ident" id="4619551">t</span><span class="op" id="4619552">.</span><span class="ident" id="4619553">tag</span>&nbsp;<span class="op" id="4619557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4619561">case</span>&nbsp;<span class="ident" id="4619566">tagIA5String</span><span class="op" id="4619578">,</span>&nbsp;<span class="ident" id="4619580">tagGeneralString</span><span class="op" id="4619596">,</span>&nbsp;<span class="ident" id="4619598">tagT61String</span><span class="op" id="4619610">,</span>&nbsp;<span class="ident" id="4619612">tagUTF8String</span><span class="op" id="4619625">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4619630">//&nbsp;We&nbsp;pretend&nbsp;that&nbsp;various&nbsp;other&nbsp;string&nbsp;types&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4619683">//&nbsp;PRINTABLE&nbsp;STRINGs&nbsp;so&nbsp;that&nbsp;a&nbsp;sequence&nbsp;of&nbsp;them&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4619741">//&nbsp;parsed&nbsp;into&nbsp;a&nbsp;[]string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4619771">t</span><span class="op" id="4619772">.</span><span class="ident" id="4619773">tag</span>&nbsp;<span class="op" id="4619777">=</span>&nbsp;<span class="ident" id="4619779">tagPrintableString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4619800">case</span>&nbsp;<span class="ident" id="4619805">tagGeneralizedTime</span><span class="op" id="4619823">,</span>&nbsp;<span class="ident" id="4619825">tagUTCTime</span><span class="op" id="4619835">:</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4619840">//&nbsp;Likewise,&nbsp;both&nbsp;time&nbsp;types&nbsp;are&nbsp;treated&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4619894">t</span><span class="op" id="4619895">.</span><span class="ident" id="4619896">tag</span>&nbsp;<span class="op" id="4619900">=</span>&nbsp;<span class="ident" id="4619902">tagUTCTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4619915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4619920">if</span>&nbsp;<span class="ident" id="4619923">t</span><span class="op" id="4619924">.</span><span class="ident" id="4619925">class</span>&nbsp;<span class="op" id="4619931">!=</span>&nbsp;<span class="ident" id="4619934">classUniversal</span>&nbsp;<span class="op" id="4619949">||</span>&nbsp;<span class="ident" id="4619952">t</span><span class="op" id="4619953">.</span><span class="ident" id="4619954">isCompound</span>&nbsp;<span class="op" id="4619965">!=</span>&nbsp;<span class="ident" id="4619968">compoundType</span>&nbsp;<span class="op" id="4619981">||</span>&nbsp;<span class="ident" id="4619984">t</span><span class="op" id="4619985">.</span><span class="ident" id="4619986">tag</span>&nbsp;<span class="op" id="4619990">!=</span>&nbsp;<span class="ident" id="4619993">expectedTag</span>&nbsp;<span class="op" id="4620005">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4620010">err</span>&nbsp;<span class="op" id="4620014">=</span>&nbsp;<span class="ident" id="4620016">StructuralError</span><span class="op" id="4620031">{</span><span class="string" id="4620032">&#34;sequence&nbsp;tag&nbsp;mismatch&#34;</span><span class="op" id="4620055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4620060">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4620069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4620073">if</span>&nbsp;<span class="ident" id="4620076">invalidLength</span><span class="op" id="4620089">(</span><span class="ident" id="4620090">offset</span><span class="op" id="4620096">,</span>&nbsp;<span class="ident" id="4620098">t</span><span class="op" id="4620099">.</span><span class="ident" id="4620100">length</span><span class="op" id="4620106">,</span>&nbsp;<span class="builtinfunc" id="4620108">len</span><span class="op" id="4620111">(</span><span class="ident" id="4620112">bytes</span><span class="op" id="4620117">)</span><span class="op" id="4620118">)</span>&nbsp;<span class="op" id="4620120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4620125">err</span>&nbsp;<span class="op" id="4620129">=</span>&nbsp;<span class="ident" id="4620131">SyntaxError</span><span class="op" id="4620142">{</span><span class="string" id="4620143">&#34;truncated&nbsp;sequence&#34;</span><span class="op" id="4620163">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4620168">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4620177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4620181">offset</span>&nbsp;<span class="op" id="4620188">+=</span>&nbsp;<span class="ident" id="4620191">t</span><span class="op" id="4620192">.</span><span class="ident" id="4620193">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4620202">numElements</span><span class="op" id="4620213">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4620217">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4620220">ret</span>&nbsp;<span class="op" id="4620224">=</span>&nbsp;<span class="ident" id="4620226">reflect</span><span class="op" id="4620233">.</span><span class="ident" id="4620234">MakeSlice</span><span class="op" id="4620243">(</span><span class="ident" id="4620244">sliceType</span><span class="op" id="4620253">,</span>&nbsp;<span class="ident" id="4620255">numElements</span><span class="op" id="4620266">,</span>&nbsp;<span class="ident" id="4620268">numElements</span><span class="op" id="4620279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4620282">params</span>&nbsp;<span class="op" id="4620289">:=</span>&nbsp;<span class="ident" id="4620292">fieldParameters</span><span class="op" id="4620307">{</span><span class="op" id="4620308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4620311">offset</span>&nbsp;<span class="op" id="4620318">:=</span>&nbsp;<span class="num" id="4620321">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4620324">for</span>&nbsp;<span class="ident" id="4620328">i</span>&nbsp;<span class="op" id="4620330">:=</span>&nbsp;<span class="num" id="4620333">0</span><span class="op" id="4620334">;</span>&nbsp;<span class="ident" id="4620336">i</span>&nbsp;<span class="op" id="4620338">&lt;</span>&nbsp;<span class="ident" id="4620340">numElements</span><span class="op" id="4620351">;</span>&nbsp;<span class="ident" id="4620353">i</span><span class="op" id="4620354">++</span>&nbsp;<span class="op" id="4620357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4620361">offset</span><span class="op" id="4620367">,</span>&nbsp;<span class="ident" id="4620369">err</span>&nbsp;<span class="op" id="4620373">=</span>&nbsp;<span class="ident" id="4620375">parseField</span><span class="op" id="4620385">(</span><span class="ident" id="4620386">ret</span><span class="op" id="4620389">.</span><span class="ident" id="4620390">Index</span><span class="op" id="4620395">(</span><span class="ident" id="4620396">i</span><span class="op" id="4620397">)</span><span class="op" id="4620398">,</span>&nbsp;<span class="ident" id="4620400">bytes</span><span class="op" id="4620405">,</span>&nbsp;<span class="ident" id="4620407">offset</span><span class="op" id="4620413">,</span>&nbsp;<span class="ident" id="4620415">params</span><span class="op" id="4620421">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4620425">if</span>&nbsp;<span class="ident" id="4620428">err</span>&nbsp;<span class="op" id="4620432">!=</span>&nbsp;<span class="builtintype" id="4620435">nil</span>&nbsp;<span class="op" id="4620439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4620444">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4620453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4620456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4620459">return</span><br>
<span class="lineno">500</span><span class="op" id="4620466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4620469">var</span>&nbsp;<span class="op" id="4620473">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4620476">bitStringType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4620497">=</span>&nbsp;<span class="ident" id="4620499">reflect</span><span class="op" id="4620506">.</span><span class="ident" id="4620507">TypeOf</span><span class="op" id="4620513">(</span><span class="ident" id="4620514">BitString</span><span class="op" id="4620523">{</span><span class="op" id="4620524">}</span><span class="op" id="4620525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4620528">objectIdentifierType</span>&nbsp;<span class="op" id="4620549">=</span>&nbsp;<span class="ident" id="4620551">reflect</span><span class="op" id="4620558">.</span><span class="ident" id="4620559">TypeOf</span><span class="op" id="4620565">(</span><span class="ident" id="4620566">ObjectIdentifier</span><span class="op" id="4620582">{</span><span class="op" id="4620583">}</span><span class="op" id="4620584">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4620587">enumeratedType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4620608">=</span>&nbsp;<span class="ident" id="4620610">reflect</span><span class="op" id="4620617">.</span><span class="ident" id="4620618">TypeOf</span><span class="op" id="4620624">(</span><span class="ident" id="4620625">Enumerated</span><span class="op" id="4620635">(</span><span class="num" id="4620636">0</span><span class="op" id="4620637">)</span><span class="op" id="4620638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4620641">flagType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4620662">=</span>&nbsp;<span class="ident" id="4620664">reflect</span><span class="op" id="4620671">.</span><span class="ident" id="4620672">TypeOf</span><span class="op" id="4620678">(</span><span class="ident" id="4620679">Flag</span><span class="op" id="4620683">(</span><span class="builtintype" id="4620684">false</span><span class="op" id="4620689">)</span><span class="op" id="4620690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4620693">timeType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4620714">=</span>&nbsp;<span class="ident" id="4620716">reflect</span><span class="op" id="4620723">.</span><span class="ident" id="4620724">TypeOf</span><span class="op" id="4620730">(</span><span class="ident" id="4620731">time</span><span class="op" id="4620735">.</span><span class="ident" id="4620736">Time</span><span class="op" id="4620740">{</span><span class="op" id="4620741">}</span><span class="op" id="4620742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4620745">rawValueType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4620766">=</span>&nbsp;<span class="ident" id="4620768">reflect</span><span class="op" id="4620775">.</span><span class="ident" id="4620776">TypeOf</span><span class="op" id="4620782">(</span><span class="ident" id="4620783">RawValue</span><span class="op" id="4620791">{</span><span class="op" id="4620792">}</span><span class="op" id="4620793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4620796">rawContentsType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4620817">=</span>&nbsp;<span class="ident" id="4620819">reflect</span><span class="op" id="4620826">.</span><span class="ident" id="4620827">TypeOf</span><span class="op" id="4620833">(</span><span class="ident" id="4620834">RawContent</span><span class="op" id="4620844">(</span><span class="builtintype" id="4620845">nil</span><span class="op" id="4620848">)</span><span class="op" id="4620849">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4620852">bigIntType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4620873">=</span>&nbsp;<span class="ident" id="4620875">reflect</span><span class="op" id="4620882">.</span><span class="ident" id="4620883">TypeOf</span><span class="op" id="4620889">(</span><span class="builtinfunc" id="4620890">new</span><span class="op" id="4620893">(</span><span class="ident" id="4620894">big</span><span class="op" id="4620897">.</span><span class="ident" id="4620898">Int</span><span class="op" id="4620901">)</span><span class="op" id="4620902">)</span><br>
<span class="lineno"></span><span class="op" id="4620904">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4620907">//&nbsp;invalidLength&nbsp;returns&nbsp;true&nbsp;iff&nbsp;offset&nbsp;+&nbsp;length&nbsp;&gt;&nbsp;sliceLength,&nbsp;or&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4620982">//&nbsp;addition&nbsp;would&nbsp;overflow.</span><br>
<span class="lineno">515</span><span class="keyword" id="4621010">func</span>&nbsp;<span class="ident" id="4621015">invalidLength</span><span class="op" id="4621028">(</span><span class="ident" id="4621029">offset</span><span class="op" id="4621035">,</span>&nbsp;<span class="ident" id="4621037">length</span><span class="op" id="4621043">,</span>&nbsp;<span class="ident" id="4621045">sliceLength</span>&nbsp;<span class="builtintype" id="4621057">int</span><span class="op" id="4621060">)</span>&nbsp;<span class="builtintype" id="4621062">bool</span>&nbsp;<span class="op" id="4621067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4621070">return</span>&nbsp;<span class="ident" id="4621077">offset</span><span class="op" id="4621083">+</span><span class="ident" id="4621084">length</span>&nbsp;<span class="op" id="4621091">&lt;</span>&nbsp;<span class="ident" id="4621093">offset</span>&nbsp;<span class="op" id="4621100">||</span>&nbsp;<span class="ident" id="4621103">offset</span><span class="op" id="4621109">+</span><span class="ident" id="4621110">length</span>&nbsp;<span class="op" id="4621117">&gt;</span>&nbsp;<span class="ident" id="4621119">sliceLength</span><br>
<span class="lineno"></span><span class="op" id="4621131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4621134">//&nbsp;parseField&nbsp;is&nbsp;the&nbsp;main&nbsp;parsing&nbsp;function.&nbsp;Given&nbsp;a&nbsp;byte&nbsp;slice&nbsp;and&nbsp;an&nbsp;offset</span><br>
<span class="lineno">520</span><span class="comment" id="4621211">//&nbsp;into&nbsp;the&nbsp;array,&nbsp;it&nbsp;will&nbsp;try&nbsp;to&nbsp;parse&nbsp;a&nbsp;suitable&nbsp;ASN.1&nbsp;value&nbsp;out&nbsp;and&nbsp;store&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4621291">//&nbsp;in&nbsp;the&nbsp;given&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="4621314">func</span>&nbsp;<span class="ident" id="4621319">parseField</span><span class="op" id="4621329">(</span><span class="ident" id="4621330">v</span>&nbsp;<span class="ident" id="4621332">reflect</span><span class="op" id="4621339">.</span><span class="ident" id="4621340">Value</span><span class="op" id="4621345">,</span>&nbsp;<span class="ident" id="4621347">bytes</span>&nbsp;<span class="op" id="4621353">[</span><span class="op" id="4621354">]</span><span class="builtintype" id="4621355">byte</span><span class="op" id="4621359">,</span>&nbsp;<span class="ident" id="4621361">initOffset</span>&nbsp;<span class="builtintype" id="4621372">int</span><span class="op" id="4621375">,</span>&nbsp;<span class="ident" id="4621377">params</span>&nbsp;<span class="ident" id="4621384">fieldParameters</span><span class="op" id="4621399">)</span>&nbsp;<span class="op" id="4621401">(</span><span class="ident" id="4621402">offset</span>&nbsp;<span class="builtintype" id="4621409">int</span><span class="op" id="4621412">,</span>&nbsp;<span class="ident" id="4621414">err</span>&nbsp;<span class="builtintype" id="4621418">error</span><span class="op" id="4621423">)</span>&nbsp;<span class="op" id="4621425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4621428">offset</span>&nbsp;<span class="op" id="4621435">=</span>&nbsp;<span class="ident" id="4621437">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4621449">fieldType</span>&nbsp;<span class="op" id="4621459">:=</span>&nbsp;<span class="ident" id="4621462">v</span><span class="op" id="4621463">.</span><span class="ident" id="4621464">Type</span><span class="op" id="4621468">(</span><span class="op" id="4621469">)</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4621473">//&nbsp;If&nbsp;we&nbsp;have&nbsp;run&nbsp;out&nbsp;of&nbsp;data,&nbsp;it&nbsp;may&nbsp;be&nbsp;that&nbsp;there&nbsp;are&nbsp;optional&nbsp;elements&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4621560">if</span>&nbsp;<span class="ident" id="4621563">offset</span>&nbsp;<span class="op" id="4621570">==</span>&nbsp;<span class="builtinfunc" id="4621573">len</span><span class="op" id="4621576">(</span><span class="ident" id="4621577">bytes</span><span class="op" id="4621582">)</span>&nbsp;<span class="op" id="4621584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4621588">if</span>&nbsp;<span class="op" id="4621591">!</span><span class="ident" id="4621592">setDefaultValue</span><span class="op" id="4621607">(</span><span class="ident" id="4621608">v</span><span class="op" id="4621609">,</span>&nbsp;<span class="ident" id="4621611">params</span><span class="op" id="4621617">)</span>&nbsp;<span class="op" id="4621619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4621624">err</span>&nbsp;<span class="op" id="4621628">=</span>&nbsp;<span class="ident" id="4621630">SyntaxError</span><span class="op" id="4621641">{</span><span class="string" id="4621642">&#34;sequence&nbsp;truncated&#34;</span><span class="op" id="4621662">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4621666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4621670">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4621678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4621682">//&nbsp;Deal&nbsp;with&nbsp;raw&nbsp;values.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4621708">if</span>&nbsp;<span class="ident" id="4621711">fieldType</span>&nbsp;<span class="op" id="4621721">==</span>&nbsp;<span class="ident" id="4621724">rawValueType</span>&nbsp;<span class="op" id="4621737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4621741">var</span>&nbsp;<span class="ident" id="4621745">t</span>&nbsp;<span class="ident" id="4621747">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4621762">t</span><span class="op" id="4621763">,</span>&nbsp;<span class="ident" id="4621765">offset</span><span class="op" id="4621771">,</span>&nbsp;<span class="ident" id="4621773">err</span>&nbsp;<span class="op" id="4621777">=</span>&nbsp;<span class="ident" id="4621779">parseTagAndLength</span><span class="op" id="4621796">(</span><span class="ident" id="4621797">bytes</span><span class="op" id="4621802">,</span>&nbsp;<span class="ident" id="4621804">offset</span><span class="op" id="4621810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4621814">if</span>&nbsp;<span class="ident" id="4621817">err</span>&nbsp;<span class="op" id="4621821">!=</span>&nbsp;<span class="builtintype" id="4621824">nil</span>&nbsp;<span class="op" id="4621828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4621833">return</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4621842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4621846">if</span>&nbsp;<span class="ident" id="4621849">invalidLength</span><span class="op" id="4621862">(</span><span class="ident" id="4621863">offset</span><span class="op" id="4621869">,</span>&nbsp;<span class="ident" id="4621871">t</span><span class="op" id="4621872">.</span><span class="ident" id="4621873">length</span><span class="op" id="4621879">,</span>&nbsp;<span class="builtinfunc" id="4621881">len</span><span class="op" id="4621884">(</span><span class="ident" id="4621885">bytes</span><span class="op" id="4621890">)</span><span class="op" id="4621891">)</span>&nbsp;<span class="op" id="4621893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4621898">err</span>&nbsp;<span class="op" id="4621902">=</span>&nbsp;<span class="ident" id="4621904">SyntaxError</span><span class="op" id="4621915">{</span><span class="string" id="4621916">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4621932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4621937">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4621946">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4621950">result</span>&nbsp;<span class="op" id="4621957">:=</span>&nbsp;<span class="ident" id="4621960">RawValue</span><span class="op" id="4621968">{</span><span class="ident" id="4621969">t</span><span class="op" id="4621970">.</span><span class="ident" id="4621971">class</span><span class="op" id="4621976">,</span>&nbsp;<span class="ident" id="4621978">t</span><span class="op" id="4621979">.</span><span class="ident" id="4621980">tag</span><span class="op" id="4621983">,</span>&nbsp;<span class="ident" id="4621985">t</span><span class="op" id="4621986">.</span><span class="ident" id="4621987">isCompound</span><span class="op" id="4621997">,</span>&nbsp;<span class="ident" id="4621999">bytes</span><span class="op" id="4622004">[</span><span class="ident" id="4622005">offset</span>&nbsp;<span class="op" id="4622012">:</span>&nbsp;<span class="ident" id="4622014">offset</span><span class="op" id="4622020">+</span><span class="ident" id="4622021">t</span><span class="op" id="4622022">.</span><span class="ident" id="4622023">length</span><span class="op" id="4622029">]</span><span class="op" id="4622030">,</span>&nbsp;<span class="ident" id="4622032">bytes</span><span class="op" id="4622037">[</span><span class="ident" id="4622038">initOffset</span>&nbsp;<span class="op" id="4622049">:</span>&nbsp;<span class="ident" id="4622051">offset</span><span class="op" id="4622057">+</span><span class="ident" id="4622058">t</span><span class="op" id="4622059">.</span><span class="ident" id="4622060">length</span><span class="op" id="4622066">]</span><span class="op" id="4622067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4622071">offset</span>&nbsp;<span class="op" id="4622078">+=</span>&nbsp;<span class="ident" id="4622081">t</span><span class="op" id="4622082">.</span><span class="ident" id="4622083">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4622092">v</span><span class="op" id="4622093">.</span><span class="ident" id="4622094">Set</span><span class="op" id="4622097">(</span><span class="ident" id="4622098">reflect</span><span class="op" id="4622105">.</span><span class="ident" id="4622106">ValueOf</span><span class="op" id="4622113">(</span><span class="ident" id="4622114">result</span><span class="op" id="4622120">)</span><span class="op" id="4622121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4622125">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4622133">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4622137">//&nbsp;Deal&nbsp;with&nbsp;the&nbsp;ANY&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4622165">if</span>&nbsp;<span class="ident" id="4622168">ifaceType</span>&nbsp;<span class="op" id="4622178">:=</span>&nbsp;<span class="ident" id="4622181">fieldType</span><span class="op" id="4622190">;</span>&nbsp;<span class="ident" id="4622192">ifaceType</span><span class="op" id="4622201">.</span><span class="ident" id="4622202">Kind</span><span class="op" id="4622206">(</span><span class="op" id="4622207">)</span>&nbsp;<span class="op" id="4622209">==</span>&nbsp;<span class="ident" id="4622212">reflect</span><span class="op" id="4622219">.</span><span class="ident" id="4622220">Interface</span>&nbsp;<span class="op" id="4622230">&amp;&amp;</span>&nbsp;<span class="ident" id="4622233">ifaceType</span><span class="op" id="4622242">.</span><span class="ident" id="4622243">NumMethod</span><span class="op" id="4622252">(</span><span class="op" id="4622253">)</span>&nbsp;<span class="op" id="4622255">==</span>&nbsp;<span class="num" id="4622258">0</span>&nbsp;<span class="op" id="4622260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4622264">var</span>&nbsp;<span class="ident" id="4622268">t</span>&nbsp;<span class="ident" id="4622270">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4622285">t</span><span class="op" id="4622286">,</span>&nbsp;<span class="ident" id="4622288">offset</span><span class="op" id="4622294">,</span>&nbsp;<span class="ident" id="4622296">err</span>&nbsp;<span class="op" id="4622300">=</span>&nbsp;<span class="ident" id="4622302">parseTagAndLength</span><span class="op" id="4622319">(</span><span class="ident" id="4622320">bytes</span><span class="op" id="4622325">,</span>&nbsp;<span class="ident" id="4622327">offset</span><span class="op" id="4622333">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4622337">if</span>&nbsp;<span class="ident" id="4622340">err</span>&nbsp;<span class="op" id="4622344">!=</span>&nbsp;<span class="builtintype" id="4622347">nil</span>&nbsp;<span class="op" id="4622351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4622356">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4622365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4622369">if</span>&nbsp;<span class="ident" id="4622372">invalidLength</span><span class="op" id="4622385">(</span><span class="ident" id="4622386">offset</span><span class="op" id="4622392">,</span>&nbsp;<span class="ident" id="4622394">t</span><span class="op" id="4622395">.</span><span class="ident" id="4622396">length</span><span class="op" id="4622402">,</span>&nbsp;<span class="builtinfunc" id="4622404">len</span><span class="op" id="4622407">(</span><span class="ident" id="4622408">bytes</span><span class="op" id="4622413">)</span><span class="op" id="4622414">)</span>&nbsp;<span class="op" id="4622416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4622421">err</span>&nbsp;<span class="op" id="4622425">=</span>&nbsp;<span class="ident" id="4622427">SyntaxError</span><span class="op" id="4622438">{</span><span class="string" id="4622439">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4622455">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4622460">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4622469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4622473">var</span>&nbsp;<span class="ident" id="4622477">result</span>&nbsp;<span class="keyword" id="4622484">interface</span><span class="op" id="4622493">{</span><span class="op" id="4622494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4622498">if</span>&nbsp;<span class="op" id="4622501">!</span><span class="ident" id="4622502">t</span><span class="op" id="4622503">.</span><span class="ident" id="4622504">isCompound</span>&nbsp;<span class="op" id="4622515">&amp;&amp;</span>&nbsp;<span class="ident" id="4622518">t</span><span class="op" id="4622519">.</span><span class="ident" id="4622520">class</span>&nbsp;<span class="op" id="4622526">==</span>&nbsp;<span class="ident" id="4622529">classUniversal</span>&nbsp;<span class="op" id="4622544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4622549">innerBytes</span>&nbsp;<span class="op" id="4622560">:=</span>&nbsp;<span class="ident" id="4622563">bytes</span><span class="op" id="4622568">[</span><span class="ident" id="4622569">offset</span>&nbsp;<span class="op" id="4622576">:</span>&nbsp;<span class="ident" id="4622578">offset</span><span class="op" id="4622584">+</span><span class="ident" id="4622585">t</span><span class="op" id="4622586">.</span><span class="ident" id="4622587">length</span><span class="op" id="4622593">]</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4622598">switch</span>&nbsp;<span class="ident" id="4622605">t</span><span class="op" id="4622606">.</span><span class="ident" id="4622607">tag</span>&nbsp;<span class="op" id="4622611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4622616">case</span>&nbsp;<span class="ident" id="4622621">tagPrintableString</span><span class="op" id="4622639">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4622645">result</span><span class="op" id="4622651">,</span>&nbsp;<span class="ident" id="4622653">err</span>&nbsp;<span class="op" id="4622657">=</span>&nbsp;<span class="ident" id="4622659">parsePrintableString</span><span class="op" id="4622679">(</span><span class="ident" id="4622680">innerBytes</span><span class="op" id="4622690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4622695">case</span>&nbsp;<span class="ident" id="4622700">tagIA5String</span><span class="op" id="4622712">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4622718">result</span><span class="op" id="4622724">,</span>&nbsp;<span class="ident" id="4622726">err</span>&nbsp;<span class="op" id="4622730">=</span>&nbsp;<span class="ident" id="4622732">parseIA5String</span><span class="op" id="4622746">(</span><span class="ident" id="4622747">innerBytes</span><span class="op" id="4622757">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4622762">case</span>&nbsp;<span class="ident" id="4622767">tagT61String</span><span class="op" id="4622779">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4622785">result</span><span class="op" id="4622791">,</span>&nbsp;<span class="ident" id="4622793">err</span>&nbsp;<span class="op" id="4622797">=</span>&nbsp;<span class="ident" id="4622799">parseT61String</span><span class="op" id="4622813">(</span><span class="ident" id="4622814">innerBytes</span><span class="op" id="4622824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4622829">case</span>&nbsp;<span class="ident" id="4622834">tagUTF8String</span><span class="op" id="4622847">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4622853">result</span><span class="op" id="4622859">,</span>&nbsp;<span class="ident" id="4622861">err</span>&nbsp;<span class="op" id="4622865">=</span>&nbsp;<span class="ident" id="4622867">parseUTF8String</span><span class="op" id="4622882">(</span><span class="ident" id="4622883">innerBytes</span><span class="op" id="4622893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4622898">case</span>&nbsp;<span class="ident" id="4622903">tagInteger</span><span class="op" id="4622913">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4622919">result</span><span class="op" id="4622925">,</span>&nbsp;<span class="ident" id="4622927">err</span>&nbsp;<span class="op" id="4622931">=</span>&nbsp;<span class="ident" id="4622933">parseInt64</span><span class="op" id="4622943">(</span><span class="ident" id="4622944">innerBytes</span><span class="op" id="4622954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4622959">case</span>&nbsp;<span class="ident" id="4622964">tagBitString</span><span class="op" id="4622976">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4622982">result</span><span class="op" id="4622988">,</span>&nbsp;<span class="ident" id="4622990">err</span>&nbsp;<span class="op" id="4622994">=</span>&nbsp;<span class="ident" id="4622996">parseBitString</span><span class="op" id="4623010">(</span><span class="ident" id="4623011">innerBytes</span><span class="op" id="4623021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4623026">case</span>&nbsp;<span class="ident" id="4623031">tagOID</span><span class="op" id="4623037">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4623043">result</span><span class="op" id="4623049">,</span>&nbsp;<span class="ident" id="4623051">err</span>&nbsp;<span class="op" id="4623055">=</span>&nbsp;<span class="ident" id="4623057">parseObjectIdentifier</span><span class="op" id="4623078">(</span><span class="ident" id="4623079">innerBytes</span><span class="op" id="4623089">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4623094">case</span>&nbsp;<span class="ident" id="4623099">tagUTCTime</span><span class="op" id="4623109">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4623115">result</span><span class="op" id="4623121">,</span>&nbsp;<span class="ident" id="4623123">err</span>&nbsp;<span class="op" id="4623127">=</span>&nbsp;<span class="ident" id="4623129">parseUTCTime</span><span class="op" id="4623141">(</span><span class="ident" id="4623142">innerBytes</span><span class="op" id="4623152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4623157">case</span>&nbsp;<span class="ident" id="4623162">tagOctetString</span><span class="op" id="4623176">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4623182">result</span>&nbsp;<span class="op" id="4623189">=</span>&nbsp;<span class="ident" id="4623191">innerBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4623205">default</span><span class="op" id="4623212">:</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4623218">//&nbsp;If&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;how&nbsp;to&nbsp;handle&nbsp;the&nbsp;type,&nbsp;we&nbsp;just&nbsp;leave&nbsp;Value&nbsp;as&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4623293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4623297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4623301">offset</span>&nbsp;<span class="op" id="4623308">+=</span>&nbsp;<span class="ident" id="4623311">t</span><span class="op" id="4623312">.</span><span class="ident" id="4623313">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4623322">if</span>&nbsp;<span class="ident" id="4623325">err</span>&nbsp;<span class="op" id="4623329">!=</span>&nbsp;<span class="builtintype" id="4623332">nil</span>&nbsp;<span class="op" id="4623336">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4623341">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4623350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4623354">if</span>&nbsp;<span class="ident" id="4623357">result</span>&nbsp;<span class="op" id="4623364">!=</span>&nbsp;<span class="builtintype" id="4623367">nil</span>&nbsp;<span class="op" id="4623371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4623376">v</span><span class="op" id="4623377">.</span><span class="ident" id="4623378">Set</span><span class="op" id="4623381">(</span><span class="ident" id="4623382">reflect</span><span class="op" id="4623389">.</span><span class="ident" id="4623390">ValueOf</span><span class="op" id="4623397">(</span><span class="ident" id="4623398">result</span><span class="op" id="4623404">)</span><span class="op" id="4623405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4623409">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4623413">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4623421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4623424">universalTag</span><span class="op" id="4623436">,</span>&nbsp;<span class="ident" id="4623438">compoundType</span><span class="op" id="4623450">,</span>&nbsp;<span class="ident" id="4623452">ok1</span>&nbsp;<span class="op" id="4623456">:=</span>&nbsp;<span class="ident" id="4623459">getUniversalType</span><span class="op" id="4623475">(</span><span class="ident" id="4623476">fieldType</span><span class="op" id="4623485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4623488">if</span>&nbsp;<span class="op" id="4623491">!</span><span class="ident" id="4623492">ok1</span>&nbsp;<span class="op" id="4623496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4623500">err</span>&nbsp;<span class="op" id="4623504">=</span>&nbsp;<span class="ident" id="4623506">StructuralError</span><span class="op" id="4623521">{</span><span class="ident" id="4623522">fmt</span><span class="op" id="4623525">.</span><span class="ident" id="4623526">Sprintf</span><span class="op" id="4623533">(</span><span class="string" id="4623534">&#34;unknown&nbsp;Go&nbsp;type:&nbsp;%v&#34;</span><span class="op" id="4623555">,</span>&nbsp;<span class="ident" id="4623557">fieldType</span><span class="op" id="4623566">)</span><span class="op" id="4623567">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4623571">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4623579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4623583">t</span><span class="op" id="4623584">,</span>&nbsp;<span class="ident" id="4623586">offset</span><span class="op" id="4623592">,</span>&nbsp;<span class="ident" id="4623594">err</span>&nbsp;<span class="op" id="4623598">:=</span>&nbsp;<span class="ident" id="4623601">parseTagAndLength</span><span class="op" id="4623618">(</span><span class="ident" id="4623619">bytes</span><span class="op" id="4623624">,</span>&nbsp;<span class="ident" id="4623626">offset</span><span class="op" id="4623632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4623635">if</span>&nbsp;<span class="ident" id="4623638">err</span>&nbsp;<span class="op" id="4623642">!=</span>&nbsp;<span class="builtintype" id="4623645">nil</span>&nbsp;<span class="op" id="4623649">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4623653">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4623661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4623664">if</span>&nbsp;<span class="ident" id="4623667">params</span><span class="op" id="4623673">.</span><span class="ident" id="4623674">explicit</span>&nbsp;<span class="op" id="4623683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4623687">expectedClass</span>&nbsp;<span class="op" id="4623701">:=</span>&nbsp;<span class="ident" id="4623704">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4623727">if</span>&nbsp;<span class="ident" id="4623730">params</span><span class="op" id="4623736">.</span><span class="ident" id="4623737">application</span>&nbsp;<span class="op" id="4623749">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4623754">expectedClass</span>&nbsp;<span class="op" id="4623768">=</span>&nbsp;<span class="ident" id="4623770">classApplication</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4623789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4623793">if</span>&nbsp;<span class="ident" id="4623796">t</span><span class="op" id="4623797">.</span><span class="ident" id="4623798">class</span>&nbsp;<span class="op" id="4623804">==</span>&nbsp;<span class="ident" id="4623807">expectedClass</span>&nbsp;<span class="op" id="4623821">&amp;&amp;</span>&nbsp;<span class="ident" id="4623824">t</span><span class="op" id="4623825">.</span><span class="ident" id="4623826">tag</span>&nbsp;<span class="op" id="4623830">==</span>&nbsp;<span class="op" id="4623833">*</span><span class="ident" id="4623834">params</span><span class="op" id="4623840">.</span><span class="ident" id="4623841">tag</span>&nbsp;<span class="op" id="4623845">&amp;&amp;</span>&nbsp;<span class="op" id="4623848">(</span><span class="ident" id="4623849">t</span><span class="op" id="4623850">.</span><span class="ident" id="4623851">length</span>&nbsp;<span class="op" id="4623858">==</span>&nbsp;<span class="num" id="4623861">0</span>&nbsp;<span class="op" id="4623863">||</span>&nbsp;<span class="ident" id="4623866">t</span><span class="op" id="4623867">.</span><span class="ident" id="4623868">isCompound</span><span class="op" id="4623878">)</span>&nbsp;<span class="op" id="4623880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4623885">if</span>&nbsp;<span class="ident" id="4623888">t</span><span class="op" id="4623889">.</span><span class="ident" id="4623890">length</span>&nbsp;<span class="op" id="4623897">&gt;</span>&nbsp;<span class="num" id="4623899">0</span>&nbsp;<span class="op" id="4623901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4623907">t</span><span class="op" id="4623908">,</span>&nbsp;<span class="ident" id="4623910">offset</span><span class="op" id="4623916">,</span>&nbsp;<span class="ident" id="4623918">err</span>&nbsp;<span class="op" id="4623922">=</span>&nbsp;<span class="ident" id="4623924">parseTagAndLength</span><span class="op" id="4623941">(</span><span class="ident" id="4623942">bytes</span><span class="op" id="4623947">,</span>&nbsp;<span class="ident" id="4623949">offset</span><span class="op" id="4623955">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4623961">if</span>&nbsp;<span class="ident" id="4623964">err</span>&nbsp;<span class="op" id="4623968">!=</span>&nbsp;<span class="builtintype" id="4623971">nil</span>&nbsp;<span class="op" id="4623975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4623982">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4623993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4623998">}</span>&nbsp;<span class="keyword" id="4624000">else</span>&nbsp;<span class="op" id="4624005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4624011">if</span>&nbsp;<span class="ident" id="4624014">fieldType</span>&nbsp;<span class="op" id="4624024">!=</span>&nbsp;<span class="ident" id="4624027">flagType</span>&nbsp;<span class="op" id="4624036">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4624043">err</span>&nbsp;<span class="op" id="4624047">=</span>&nbsp;<span class="ident" id="4624049">StructuralError</span><span class="op" id="4624064">{</span><span class="string" id="4624065">&#34;zero&nbsp;length&nbsp;explicit&nbsp;tag&nbsp;was&nbsp;not&nbsp;an&nbsp;asn1.Flag&#34;</span><span class="op" id="4624112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4624119">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4624130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4624136">v</span><span class="op" id="4624137">.</span><span class="ident" id="4624138">SetBool</span><span class="op" id="4624145">(</span><span class="builtintype" id="4624146">true</span><span class="op" id="4624150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4624156">return</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4624166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4624170">}</span>&nbsp;<span class="keyword" id="4624172">else</span>&nbsp;<span class="op" id="4624177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4624182">//&nbsp;The&nbsp;tags&nbsp;didn&#39;t&nbsp;match,&nbsp;it&nbsp;might&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4624244">ok</span>&nbsp;<span class="op" id="4624247">:=</span>&nbsp;<span class="ident" id="4624250">setDefaultValue</span><span class="op" id="4624265">(</span><span class="ident" id="4624266">v</span><span class="op" id="4624267">,</span>&nbsp;<span class="ident" id="4624269">params</span><span class="op" id="4624275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4624280">if</span>&nbsp;<span class="ident" id="4624283">ok</span>&nbsp;<span class="op" id="4624286">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4624292">offset</span>&nbsp;<span class="op" id="4624299">=</span>&nbsp;<span class="ident" id="4624301">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4624315">}</span>&nbsp;<span class="keyword" id="4624317">else</span>&nbsp;<span class="op" id="4624322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4624328">err</span>&nbsp;<span class="op" id="4624332">=</span>&nbsp;<span class="ident" id="4624334">StructuralError</span><span class="op" id="4624349">{</span><span class="string" id="4624350">&#34;explicitly&nbsp;tagged&nbsp;member&nbsp;didn&#39;t&nbsp;match&#34;</span><span class="op" id="4624389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4624394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4624399">return</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4624408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4624411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4624415">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;strings:&nbsp;all&nbsp;the&nbsp;ASN.1&nbsp;string&nbsp;types&nbsp;map&nbsp;to&nbsp;the&nbsp;Go</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4624486">//&nbsp;type&nbsp;string.&nbsp;getUniversalType&nbsp;returns&nbsp;the&nbsp;tag&nbsp;for&nbsp;PrintableString</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4624556">//&nbsp;when&nbsp;it&nbsp;sees&nbsp;a&nbsp;string,&nbsp;so&nbsp;if&nbsp;we&nbsp;see&nbsp;a&nbsp;different&nbsp;string&nbsp;type&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4624627">//&nbsp;wire,&nbsp;we&nbsp;change&nbsp;the&nbsp;universal&nbsp;type&nbsp;to&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4624676">if</span>&nbsp;<span class="ident" id="4624679">universalTag</span>&nbsp;<span class="op" id="4624692">==</span>&nbsp;<span class="ident" id="4624695">tagPrintableString</span>&nbsp;<span class="op" id="4624714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4624718">if</span>&nbsp;<span class="ident" id="4624721">t</span><span class="op" id="4624722">.</span><span class="ident" id="4624723">class</span>&nbsp;<span class="op" id="4624729">==</span>&nbsp;<span class="ident" id="4624732">classUniversal</span>&nbsp;<span class="op" id="4624747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4624752">switch</span>&nbsp;<span class="ident" id="4624759">t</span><span class="op" id="4624760">.</span><span class="ident" id="4624761">tag</span>&nbsp;<span class="op" id="4624765">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4624770">case</span>&nbsp;<span class="ident" id="4624775">tagIA5String</span><span class="op" id="4624787">,</span>&nbsp;<span class="ident" id="4624789">tagGeneralString</span><span class="op" id="4624805">,</span>&nbsp;<span class="ident" id="4624807">tagT61String</span><span class="op" id="4624819">,</span>&nbsp;<span class="ident" id="4624821">tagUTF8String</span><span class="op" id="4624834">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4624840">universalTag</span>&nbsp;<span class="op" id="4624853">=</span>&nbsp;<span class="ident" id="4624855">t</span><span class="op" id="4624856">.</span><span class="ident" id="4624857">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4624864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4624868">}</span>&nbsp;<span class="keyword" id="4624870">else</span>&nbsp;<span class="keyword" id="4624875">if</span>&nbsp;<span class="ident" id="4624878">params</span><span class="op" id="4624884">.</span><span class="ident" id="4624885">stringType</span>&nbsp;<span class="op" id="4624896">!=</span>&nbsp;<span class="num" id="4624899">0</span>&nbsp;<span class="op" id="4624901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4624906">universalTag</span>&nbsp;<span class="op" id="4624919">=</span>&nbsp;<span class="ident" id="4624921">params</span><span class="op" id="4624927">.</span><span class="ident" id="4624928">stringType</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4624941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4624944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4624948">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;time:&nbsp;UTCTime&nbsp;and&nbsp;GeneralizedTime&nbsp;both&nbsp;map&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4625019">//&nbsp;Go&nbsp;type&nbsp;time.Time.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4625042">if</span>&nbsp;<span class="ident" id="4625045">universalTag</span>&nbsp;<span class="op" id="4625058">==</span>&nbsp;<span class="ident" id="4625061">tagUTCTime</span>&nbsp;<span class="op" id="4625072">&amp;&amp;</span>&nbsp;<span class="ident" id="4625075">t</span><span class="op" id="4625076">.</span><span class="ident" id="4625077">tag</span>&nbsp;<span class="op" id="4625081">==</span>&nbsp;<span class="ident" id="4625084">tagGeneralizedTime</span>&nbsp;<span class="op" id="4625103">&amp;&amp;</span>&nbsp;<span class="ident" id="4625106">t</span><span class="op" id="4625107">.</span><span class="ident" id="4625108">class</span>&nbsp;<span class="op" id="4625114">==</span>&nbsp;<span class="ident" id="4625117">classUniversal</span>&nbsp;<span class="op" id="4625132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4625136">universalTag</span>&nbsp;<span class="op" id="4625149">=</span>&nbsp;<span class="ident" id="4625151">tagGeneralizedTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4625171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4625175">if</span>&nbsp;<span class="ident" id="4625178">params</span><span class="op" id="4625184">.</span><span class="ident" id="4625185">set</span>&nbsp;<span class="op" id="4625189">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4625193">universalTag</span>&nbsp;<span class="op" id="4625206">=</span>&nbsp;<span class="ident" id="4625208">tagSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4625216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4625220">expectedClass</span>&nbsp;<span class="op" id="4625234">:=</span>&nbsp;<span class="ident" id="4625237">classUniversal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4625253">expectedTag</span>&nbsp;<span class="op" id="4625265">:=</span>&nbsp;<span class="ident" id="4625268">universalTag</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4625283">if</span>&nbsp;<span class="op" id="4625286">!</span><span class="ident" id="4625287">params</span><span class="op" id="4625293">.</span><span class="ident" id="4625294">explicit</span>&nbsp;<span class="op" id="4625303">&amp;&amp;</span>&nbsp;<span class="ident" id="4625306">params</span><span class="op" id="4625312">.</span><span class="ident" id="4625313">tag</span>&nbsp;<span class="op" id="4625317">!=</span>&nbsp;<span class="builtintype" id="4625320">nil</span>&nbsp;<span class="op" id="4625324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4625328">expectedClass</span>&nbsp;<span class="op" id="4625342">=</span>&nbsp;<span class="ident" id="4625344">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4625367">expectedTag</span>&nbsp;<span class="op" id="4625379">=</span>&nbsp;<span class="op" id="4625381">*</span><span class="ident" id="4625382">params</span><span class="op" id="4625388">.</span><span class="ident" id="4625389">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4625394">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4625398">if</span>&nbsp;<span class="op" id="4625401">!</span><span class="ident" id="4625402">params</span><span class="op" id="4625408">.</span><span class="ident" id="4625409">explicit</span>&nbsp;<span class="op" id="4625418">&amp;&amp;</span>&nbsp;<span class="ident" id="4625421">params</span><span class="op" id="4625427">.</span><span class="ident" id="4625428">application</span>&nbsp;<span class="op" id="4625440">&amp;&amp;</span>&nbsp;<span class="ident" id="4625443">params</span><span class="op" id="4625449">.</span><span class="ident" id="4625450">tag</span>&nbsp;<span class="op" id="4625454">!=</span>&nbsp;<span class="builtintype" id="4625457">nil</span>&nbsp;<span class="op" id="4625461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4625465">expectedClass</span>&nbsp;<span class="op" id="4625479">=</span>&nbsp;<span class="ident" id="4625481">classApplication</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4625500">expectedTag</span>&nbsp;<span class="op" id="4625512">=</span>&nbsp;<span class="op" id="4625514">*</span><span class="ident" id="4625515">params</span><span class="op" id="4625521">.</span><span class="ident" id="4625522">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4625527">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4625531">//&nbsp;We&nbsp;have&nbsp;unwrapped&nbsp;any&nbsp;explicit&nbsp;tagging&nbsp;at&nbsp;this&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4625589">if</span>&nbsp;<span class="ident" id="4625592">t</span><span class="op" id="4625593">.</span><span class="ident" id="4625594">class</span>&nbsp;<span class="op" id="4625600">!=</span>&nbsp;<span class="ident" id="4625603">expectedClass</span>&nbsp;<span class="op" id="4625617">||</span>&nbsp;<span class="ident" id="4625620">t</span><span class="op" id="4625621">.</span><span class="ident" id="4625622">tag</span>&nbsp;<span class="op" id="4625626">!=</span>&nbsp;<span class="ident" id="4625629">expectedTag</span>&nbsp;<span class="op" id="4625641">||</span>&nbsp;<span class="ident" id="4625644">t</span><span class="op" id="4625645">.</span><span class="ident" id="4625646">isCompound</span>&nbsp;<span class="op" id="4625657">!=</span>&nbsp;<span class="ident" id="4625660">compoundType</span>&nbsp;<span class="op" id="4625673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4625677">//&nbsp;Tags&nbsp;don&#39;t&nbsp;match.&nbsp;Again,&nbsp;it&nbsp;could&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4625740">ok</span>&nbsp;<span class="op" id="4625743">:=</span>&nbsp;<span class="ident" id="4625746">setDefaultValue</span><span class="op" id="4625761">(</span><span class="ident" id="4625762">v</span><span class="op" id="4625763">,</span>&nbsp;<span class="ident" id="4625765">params</span><span class="op" id="4625771">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4625775">if</span>&nbsp;<span class="ident" id="4625778">ok</span>&nbsp;<span class="op" id="4625781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4625786">offset</span>&nbsp;<span class="op" id="4625793">=</span>&nbsp;<span class="ident" id="4625795">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4625808">}</span>&nbsp;<span class="keyword" id="4625810">else</span>&nbsp;<span class="op" id="4625815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4625820">err</span>&nbsp;<span class="op" id="4625824">=</span>&nbsp;<span class="ident" id="4625826">StructuralError</span><span class="op" id="4625841">{</span><span class="ident" id="4625842">fmt</span><span class="op" id="4625845">.</span><span class="ident" id="4625846">Sprintf</span><span class="op" id="4625853">(</span><span class="string" id="4625854">&#34;tags&nbsp;don&#39;t&nbsp;match&nbsp;(%d&nbsp;vs&nbsp;%+v)&nbsp;%+v&nbsp;%s&nbsp;@%d&#34;</span><span class="op" id="4625895">,</span>&nbsp;<span class="ident" id="4625897">expectedTag</span><span class="op" id="4625908">,</span>&nbsp;<span class="ident" id="4625910">t</span><span class="op" id="4625911">,</span>&nbsp;<span class="ident" id="4625913">params</span><span class="op" id="4625919">,</span>&nbsp;<span class="ident" id="4625921">fieldType</span><span class="op" id="4625930">.</span><span class="ident" id="4625931">Name</span><span class="op" id="4625935">(</span><span class="op" id="4625936">)</span><span class="op" id="4625937">,</span>&nbsp;<span class="ident" id="4625939">offset</span><span class="op" id="4625945">)</span><span class="op" id="4625946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4625950">}</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4625954">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4625962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4625965">if</span>&nbsp;<span class="ident" id="4625968">invalidLength</span><span class="op" id="4625981">(</span><span class="ident" id="4625982">offset</span><span class="op" id="4625988">,</span>&nbsp;<span class="ident" id="4625990">t</span><span class="op" id="4625991">.</span><span class="ident" id="4625992">length</span><span class="op" id="4625998">,</span>&nbsp;<span class="builtinfunc" id="4626000">len</span><span class="op" id="4626003">(</span><span class="ident" id="4626004">bytes</span><span class="op" id="4626009">)</span><span class="op" id="4626010">)</span>&nbsp;<span class="op" id="4626012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626016">err</span>&nbsp;<span class="op" id="4626020">=</span>&nbsp;<span class="ident" id="4626022">SyntaxError</span><span class="op" id="4626033">{</span><span class="string" id="4626034">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4626050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4626054">return</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4626062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626065">innerBytes</span>&nbsp;<span class="op" id="4626076">:=</span>&nbsp;<span class="ident" id="4626079">bytes</span><span class="op" id="4626084">[</span><span class="ident" id="4626085">offset</span>&nbsp;<span class="op" id="4626092">:</span>&nbsp;<span class="ident" id="4626094">offset</span><span class="op" id="4626100">+</span><span class="ident" id="4626101">t</span><span class="op" id="4626102">.</span><span class="ident" id="4626103">length</span><span class="op" id="4626109">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626112">offset</span>&nbsp;<span class="op" id="4626119">+=</span>&nbsp;<span class="ident" id="4626122">t</span><span class="op" id="4626123">.</span><span class="ident" id="4626124">length</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4626133">//&nbsp;We&nbsp;deal&nbsp;with&nbsp;the&nbsp;structures&nbsp;defined&nbsp;in&nbsp;this&nbsp;package&nbsp;first.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4626196">switch</span>&nbsp;<span class="ident" id="4626203">fieldType</span>&nbsp;<span class="op" id="4626213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4626216">case</span>&nbsp;<span class="ident" id="4626221">objectIdentifierType</span><span class="op" id="4626241">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626245">newSlice</span><span class="op" id="4626253">,</span>&nbsp;<span class="ident" id="4626255">err1</span>&nbsp;<span class="op" id="4626260">:=</span>&nbsp;<span class="ident" id="4626263">parseObjectIdentifier</span><span class="op" id="4626284">(</span><span class="ident" id="4626285">innerBytes</span><span class="op" id="4626295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626299">v</span><span class="op" id="4626300">.</span><span class="ident" id="4626301">Set</span><span class="op" id="4626304">(</span><span class="ident" id="4626305">reflect</span><span class="op" id="4626312">.</span><span class="ident" id="4626313">MakeSlice</span><span class="op" id="4626322">(</span><span class="ident" id="4626323">v</span><span class="op" id="4626324">.</span><span class="ident" id="4626325">Type</span><span class="op" id="4626329">(</span><span class="op" id="4626330">)</span><span class="op" id="4626331">,</span>&nbsp;<span class="builtinfunc" id="4626333">len</span><span class="op" id="4626336">(</span><span class="ident" id="4626337">newSlice</span><span class="op" id="4626345">)</span><span class="op" id="4626346">,</span>&nbsp;<span class="builtinfunc" id="4626348">len</span><span class="op" id="4626351">(</span><span class="ident" id="4626352">newSlice</span><span class="op" id="4626360">)</span><span class="op" id="4626361">)</span><span class="op" id="4626362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4626366">if</span>&nbsp;<span class="ident" id="4626369">err1</span>&nbsp;<span class="op" id="4626374">==</span>&nbsp;<span class="builtintype" id="4626377">nil</span>&nbsp;<span class="op" id="4626381">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626386">reflect</span><span class="op" id="4626393">.</span><span class="ident" id="4626394">Copy</span><span class="op" id="4626398">(</span><span class="ident" id="4626399">v</span><span class="op" id="4626400">,</span>&nbsp;<span class="ident" id="4626402">reflect</span><span class="op" id="4626409">.</span><span class="ident" id="4626410">ValueOf</span><span class="op" id="4626417">(</span><span class="ident" id="4626418">newSlice</span><span class="op" id="4626426">)</span><span class="op" id="4626427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4626431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626435">err</span>&nbsp;<span class="op" id="4626439">=</span>&nbsp;<span class="ident" id="4626441">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4626448">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4626456">case</span>&nbsp;<span class="ident" id="4626461">bitStringType</span><span class="op" id="4626474">:</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626478">bs</span><span class="op" id="4626480">,</span>&nbsp;<span class="ident" id="4626482">err1</span>&nbsp;<span class="op" id="4626487">:=</span>&nbsp;<span class="ident" id="4626490">parseBitString</span><span class="op" id="4626504">(</span><span class="ident" id="4626505">innerBytes</span><span class="op" id="4626515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4626519">if</span>&nbsp;<span class="ident" id="4626522">err1</span>&nbsp;<span class="op" id="4626527">==</span>&nbsp;<span class="builtintype" id="4626530">nil</span>&nbsp;<span class="op" id="4626534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626539">v</span><span class="op" id="4626540">.</span><span class="ident" id="4626541">Set</span><span class="op" id="4626544">(</span><span class="ident" id="4626545">reflect</span><span class="op" id="4626552">.</span><span class="ident" id="4626553">ValueOf</span><span class="op" id="4626560">(</span><span class="ident" id="4626561">bs</span><span class="op" id="4626563">)</span><span class="op" id="4626564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4626568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626572">err</span>&nbsp;<span class="op" id="4626576">=</span>&nbsp;<span class="ident" id="4626578">err1</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4626585">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4626593">case</span>&nbsp;<span class="ident" id="4626598">timeType</span><span class="op" id="4626606">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4626610">var</span>&nbsp;<span class="ident" id="4626614">time</span>&nbsp;<span class="ident" id="4626619">time</span><span class="op" id="4626623">.</span><span class="ident" id="4626624">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4626631">var</span>&nbsp;<span class="ident" id="4626635">err1</span>&nbsp;<span class="builtintype" id="4626640">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4626648">if</span>&nbsp;<span class="ident" id="4626651">universalTag</span>&nbsp;<span class="op" id="4626664">==</span>&nbsp;<span class="ident" id="4626667">tagUTCTime</span>&nbsp;<span class="op" id="4626678">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626683">time</span><span class="op" id="4626687">,</span>&nbsp;<span class="ident" id="4626689">err1</span>&nbsp;<span class="op" id="4626694">=</span>&nbsp;<span class="ident" id="4626696">parseUTCTime</span><span class="op" id="4626708">(</span><span class="ident" id="4626709">innerBytes</span><span class="op" id="4626719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4626723">}</span>&nbsp;<span class="keyword" id="4626725">else</span>&nbsp;<span class="op" id="4626730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626735">time</span><span class="op" id="4626739">,</span>&nbsp;<span class="ident" id="4626741">err1</span>&nbsp;<span class="op" id="4626746">=</span>&nbsp;<span class="ident" id="4626748">parseGeneralizedTime</span><span class="op" id="4626768">(</span><span class="ident" id="4626769">innerBytes</span><span class="op" id="4626779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4626783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4626787">if</span>&nbsp;<span class="ident" id="4626790">err1</span>&nbsp;<span class="op" id="4626795">==</span>&nbsp;<span class="builtintype" id="4626798">nil</span>&nbsp;<span class="op" id="4626802">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626807">v</span><span class="op" id="4626808">.</span><span class="ident" id="4626809">Set</span><span class="op" id="4626812">(</span><span class="ident" id="4626813">reflect</span><span class="op" id="4626820">.</span><span class="ident" id="4626821">ValueOf</span><span class="op" id="4626828">(</span><span class="ident" id="4626829">time</span><span class="op" id="4626833">)</span><span class="op" id="4626834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4626838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626842">err</span>&nbsp;<span class="op" id="4626846">=</span>&nbsp;<span class="ident" id="4626848">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4626855">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4626863">case</span>&nbsp;<span class="ident" id="4626868">enumeratedType</span><span class="op" id="4626882">:</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626886">parsedInt</span><span class="op" id="4626895">,</span>&nbsp;<span class="ident" id="4626897">err1</span>&nbsp;<span class="op" id="4626902">:=</span>&nbsp;<span class="ident" id="4626905">parseInt32</span><span class="op" id="4626915">(</span><span class="ident" id="4626916">innerBytes</span><span class="op" id="4626926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4626930">if</span>&nbsp;<span class="ident" id="4626933">err1</span>&nbsp;<span class="op" id="4626938">==</span>&nbsp;<span class="builtintype" id="4626941">nil</span>&nbsp;<span class="op" id="4626945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626950">v</span><span class="op" id="4626951">.</span><span class="ident" id="4626952">SetInt</span><span class="op" id="4626958">(</span><span class="ident" id="4626959">int64</span><span class="op" id="4626964">(</span><span class="ident" id="4626965">parsedInt</span><span class="op" id="4626974">)</span><span class="op" id="4626975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4626979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4626983">err</span>&nbsp;<span class="op" id="4626987">=</span>&nbsp;<span class="ident" id="4626989">err1</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4626996">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627004">case</span>&nbsp;<span class="ident" id="4627009">flagType</span><span class="op" id="4627017">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627021">v</span><span class="op" id="4627022">.</span><span class="ident" id="4627023">SetBool</span><span class="op" id="4627030">(</span><span class="builtintype" id="4627031">true</span><span class="op" id="4627035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627039">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627047">case</span>&nbsp;<span class="ident" id="4627052">bigIntType</span><span class="op" id="4627062">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627066">parsedInt</span>&nbsp;<span class="op" id="4627076">:=</span>&nbsp;<span class="ident" id="4627079">parseBigInt</span><span class="op" id="4627090">(</span><span class="ident" id="4627091">innerBytes</span><span class="op" id="4627101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627105">v</span><span class="op" id="4627106">.</span><span class="ident" id="4627107">Set</span><span class="op" id="4627110">(</span><span class="ident" id="4627111">reflect</span><span class="op" id="4627118">.</span><span class="ident" id="4627119">ValueOf</span><span class="op" id="4627126">(</span><span class="ident" id="4627127">parsedInt</span><span class="op" id="4627136">)</span><span class="op" id="4627137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627141">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4627149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627152">switch</span>&nbsp;<span class="ident" id="4627159">val</span>&nbsp;<span class="op" id="4627163">:=</span>&nbsp;<span class="ident" id="4627166">v</span><span class="op" id="4627167">;</span>&nbsp;<span class="ident" id="4627169">val</span><span class="op" id="4627172">.</span><span class="ident" id="4627173">Kind</span><span class="op" id="4627177">(</span><span class="op" id="4627178">)</span>&nbsp;<span class="op" id="4627180">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627183">case</span>&nbsp;<span class="ident" id="4627188">reflect</span><span class="op" id="4627195">.</span><span class="ident" id="4627196">Bool</span><span class="op" id="4627200">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627204">parsedBool</span><span class="op" id="4627214">,</span>&nbsp;<span class="ident" id="4627216">err1</span>&nbsp;<span class="op" id="4627221">:=</span>&nbsp;<span class="ident" id="4627224">parseBool</span><span class="op" id="4627233">(</span><span class="ident" id="4627234">innerBytes</span><span class="op" id="4627244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627248">if</span>&nbsp;<span class="ident" id="4627251">err1</span>&nbsp;<span class="op" id="4627256">==</span>&nbsp;<span class="builtintype" id="4627259">nil</span>&nbsp;<span class="op" id="4627263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627268">val</span><span class="op" id="4627271">.</span><span class="ident" id="4627272">SetBool</span><span class="op" id="4627279">(</span><span class="ident" id="4627280">parsedBool</span><span class="op" id="4627290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4627294">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627298">err</span>&nbsp;<span class="op" id="4627302">=</span>&nbsp;<span class="ident" id="4627304">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627311">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627319">case</span>&nbsp;<span class="ident" id="4627324">reflect</span><span class="op" id="4627331">.</span><span class="ident" id="4627332">Int</span><span class="op" id="4627335">,</span>&nbsp;<span class="ident" id="4627337">reflect</span><span class="op" id="4627344">.</span><span class="ident" id="4627345">Int32</span><span class="op" id="4627350">,</span>&nbsp;<span class="ident" id="4627352">reflect</span><span class="op" id="4627359">.</span><span class="ident" id="4627360">Int64</span><span class="op" id="4627365">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627369">if</span>&nbsp;<span class="ident" id="4627372">val</span><span class="op" id="4627375">.</span><span class="ident" id="4627376">Type</span><span class="op" id="4627380">(</span><span class="op" id="4627381">)</span><span class="op" id="4627382">.</span><span class="ident" id="4627383">Size</span><span class="op" id="4627387">(</span><span class="op" id="4627388">)</span>&nbsp;<span class="op" id="4627390">==</span>&nbsp;<span class="num" id="4627393">4</span>&nbsp;<span class="op" id="4627395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627400">parsedInt</span><span class="op" id="4627409">,</span>&nbsp;<span class="ident" id="4627411">err1</span>&nbsp;<span class="op" id="4627416">:=</span>&nbsp;<span class="ident" id="4627419">parseInt32</span><span class="op" id="4627429">(</span><span class="ident" id="4627430">innerBytes</span><span class="op" id="4627440">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627445">if</span>&nbsp;<span class="ident" id="4627448">err1</span>&nbsp;<span class="op" id="4627453">==</span>&nbsp;<span class="builtintype" id="4627456">nil</span>&nbsp;<span class="op" id="4627460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627466">val</span><span class="op" id="4627469">.</span><span class="ident" id="4627470">SetInt</span><span class="op" id="4627476">(</span><span class="ident" id="4627477">int64</span><span class="op" id="4627482">(</span><span class="ident" id="4627483">parsedInt</span><span class="op" id="4627492">)</span><span class="op" id="4627493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4627498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627503">err</span>&nbsp;<span class="op" id="4627507">=</span>&nbsp;<span class="ident" id="4627509">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4627516">}</span>&nbsp;<span class="keyword" id="4627518">else</span>&nbsp;<span class="op" id="4627523">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627528">parsedInt</span><span class="op" id="4627537">,</span>&nbsp;<span class="ident" id="4627539">err1</span>&nbsp;<span class="op" id="4627544">:=</span>&nbsp;<span class="ident" id="4627547">parseInt64</span><span class="op" id="4627557">(</span><span class="ident" id="4627558">innerBytes</span><span class="op" id="4627568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627573">if</span>&nbsp;<span class="ident" id="4627576">err1</span>&nbsp;<span class="op" id="4627581">==</span>&nbsp;<span class="builtintype" id="4627584">nil</span>&nbsp;<span class="op" id="4627588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627594">val</span><span class="op" id="4627597">.</span><span class="ident" id="4627598">SetInt</span><span class="op" id="4627604">(</span><span class="ident" id="4627605">parsedInt</span><span class="op" id="4627614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4627619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627624">err</span>&nbsp;<span class="op" id="4627628">=</span>&nbsp;<span class="ident" id="4627630">err1</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4627637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627641">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4627649">//&nbsp;TODO(dfc)&nbsp;Add&nbsp;support&nbsp;for&nbsp;the&nbsp;remaining&nbsp;integer&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627707">case</span>&nbsp;<span class="ident" id="4627712">reflect</span><span class="op" id="4627719">.</span><span class="ident" id="4627720">Struct</span><span class="op" id="4627726">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627730">structType</span>&nbsp;<span class="op" id="4627741">:=</span>&nbsp;<span class="ident" id="4627744">fieldType</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627757">if</span>&nbsp;<span class="ident" id="4627760">structType</span><span class="op" id="4627770">.</span><span class="ident" id="4627771">NumField</span><span class="op" id="4627779">(</span><span class="op" id="4627780">)</span>&nbsp;<span class="op" id="4627782">&gt;</span>&nbsp;<span class="num" id="4627784">0</span>&nbsp;<span class="op" id="4627786">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627792">structType</span><span class="op" id="4627802">.</span><span class="ident" id="4627803">Field</span><span class="op" id="4627808">(</span><span class="num" id="4627809">0</span><span class="op" id="4627810">)</span><span class="op" id="4627811">.</span><span class="ident" id="4627812">Type</span>&nbsp;<span class="op" id="4627817">==</span>&nbsp;<span class="ident" id="4627820">rawContentsType</span>&nbsp;<span class="op" id="4627836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627841">bytes</span>&nbsp;<span class="op" id="4627847">:=</span>&nbsp;<span class="ident" id="4627850">bytes</span><span class="op" id="4627855">[</span><span class="ident" id="4627856">initOffset</span><span class="op" id="4627866">:</span><span class="ident" id="4627867">offset</span><span class="op" id="4627873">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627878">val</span><span class="op" id="4627881">.</span><span class="ident" id="4627882">Field</span><span class="op" id="4627887">(</span><span class="num" id="4627888">0</span><span class="op" id="4627889">)</span><span class="op" id="4627890">.</span><span class="ident" id="4627891">Set</span><span class="op" id="4627894">(</span><span class="ident" id="4627895">reflect</span><span class="op" id="4627902">.</span><span class="ident" id="4627903">ValueOf</span><span class="op" id="4627910">(</span><span class="ident" id="4627911">RawContent</span><span class="op" id="4627921">(</span><span class="ident" id="4627922">bytes</span><span class="op" id="4627927">)</span><span class="op" id="4627928">)</span><span class="op" id="4627929">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4627933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4627938">innerOffset</span>&nbsp;<span class="op" id="4627950">:=</span>&nbsp;<span class="num" id="4627953">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4627957">for</span>&nbsp;<span class="ident" id="4627961">i</span>&nbsp;<span class="op" id="4627963">:=</span>&nbsp;<span class="num" id="4627966">0</span><span class="op" id="4627967">;</span>&nbsp;<span class="ident" id="4627969">i</span>&nbsp;<span class="op" id="4627971">&lt;</span>&nbsp;<span class="ident" id="4627973">structType</span><span class="op" id="4627983">.</span><span class="ident" id="4627984">NumField</span><span class="op" id="4627992">(</span><span class="op" id="4627993">)</span><span class="op" id="4627994">;</span>&nbsp;<span class="ident" id="4627996">i</span><span class="op" id="4627997">++</span>&nbsp;<span class="op" id="4628000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628005">field</span>&nbsp;<span class="op" id="4628011">:=</span>&nbsp;<span class="ident" id="4628014">structType</span><span class="op" id="4628024">.</span><span class="ident" id="4628025">Field</span><span class="op" id="4628030">(</span><span class="ident" id="4628031">i</span><span class="op" id="4628032">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628037">if</span>&nbsp;<span class="ident" id="4628040">i</span>&nbsp;<span class="op" id="4628042">==</span>&nbsp;<span class="num" id="4628045">0</span>&nbsp;<span class="op" id="4628047">&amp;&amp;</span>&nbsp;<span class="ident" id="4628050">field</span><span class="op" id="4628055">.</span><span class="ident" id="4628056">Type</span>&nbsp;<span class="op" id="4628061">==</span>&nbsp;<span class="ident" id="4628064">rawContentsType</span>&nbsp;<span class="op" id="4628080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628086">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4628098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628103">innerOffset</span><span class="op" id="4628114">,</span>&nbsp;<span class="ident" id="4628116">err</span>&nbsp;<span class="op" id="4628120">=</span>&nbsp;<span class="ident" id="4628122">parseField</span><span class="op" id="4628132">(</span><span class="ident" id="4628133">val</span><span class="op" id="4628136">.</span><span class="ident" id="4628137">Field</span><span class="op" id="4628142">(</span><span class="ident" id="4628143">i</span><span class="op" id="4628144">)</span><span class="op" id="4628145">,</span>&nbsp;<span class="ident" id="4628147">innerBytes</span><span class="op" id="4628157">,</span>&nbsp;<span class="ident" id="4628159">innerOffset</span><span class="op" id="4628170">,</span>&nbsp;<span class="ident" id="4628172">parseFieldParameters</span><span class="op" id="4628192">(</span><span class="ident" id="4628193">field</span><span class="op" id="4628198">.</span><span class="ident" id="4628199">Tag</span><span class="op" id="4628202">.</span><span class="ident" id="4628203">Get</span><span class="op" id="4628206">(</span><span class="string" id="4628207">&#34;asn1&#34;</span><span class="op" id="4628213">)</span><span class="op" id="4628214">)</span><span class="op" id="4628215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628220">if</span>&nbsp;<span class="ident" id="4628223">err</span>&nbsp;<span class="op" id="4628227">!=</span>&nbsp;<span class="builtintype" id="4628230">nil</span>&nbsp;<span class="op" id="4628234">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628240">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4628250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4628254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4628258">//&nbsp;We&nbsp;allow&nbsp;extra&nbsp;bytes&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;SEQUENCE&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4628319">//&nbsp;adding&nbsp;elements&nbsp;to&nbsp;the&nbsp;end&nbsp;has&nbsp;been&nbsp;used&nbsp;in&nbsp;X.509&nbsp;as&nbsp;the</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4628381">//&nbsp;version&nbsp;numbers&nbsp;have&nbsp;increased.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628418">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628426">case</span>&nbsp;<span class="ident" id="4628431">reflect</span><span class="op" id="4628438">.</span><span class="ident" id="4628439">Slice</span><span class="op" id="4628444">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628448">sliceType</span>&nbsp;<span class="op" id="4628458">:=</span>&nbsp;<span class="ident" id="4628461">fieldType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628473">if</span>&nbsp;<span class="ident" id="4628476">sliceType</span><span class="op" id="4628485">.</span><span class="ident" id="4628486">Elem</span><span class="op" id="4628490">(</span><span class="op" id="4628491">)</span><span class="op" id="4628492">.</span><span class="ident" id="4628493">Kind</span><span class="op" id="4628497">(</span><span class="op" id="4628498">)</span>&nbsp;<span class="op" id="4628500">==</span>&nbsp;<span class="ident" id="4628503">reflect</span><span class="op" id="4628510">.</span><span class="ident" id="4628511">Uint8</span>&nbsp;<span class="op" id="4628517">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628522">val</span><span class="op" id="4628525">.</span><span class="ident" id="4628526">Set</span><span class="op" id="4628529">(</span><span class="ident" id="4628530">reflect</span><span class="op" id="4628537">.</span><span class="ident" id="4628538">MakeSlice</span><span class="op" id="4628547">(</span><span class="ident" id="4628548">sliceType</span><span class="op" id="4628557">,</span>&nbsp;<span class="builtinfunc" id="4628559">len</span><span class="op" id="4628562">(</span><span class="ident" id="4628563">innerBytes</span><span class="op" id="4628573">)</span><span class="op" id="4628574">,</span>&nbsp;<span class="builtinfunc" id="4628576">len</span><span class="op" id="4628579">(</span><span class="ident" id="4628580">innerBytes</span><span class="op" id="4628590">)</span><span class="op" id="4628591">)</span><span class="op" id="4628592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628597">reflect</span><span class="op" id="4628604">.</span><span class="ident" id="4628605">Copy</span><span class="op" id="4628609">(</span><span class="ident" id="4628610">val</span><span class="op" id="4628613">,</span>&nbsp;<span class="ident" id="4628615">reflect</span><span class="op" id="4628622">.</span><span class="ident" id="4628623">ValueOf</span><span class="op" id="4628630">(</span><span class="ident" id="4628631">innerBytes</span><span class="op" id="4628641">)</span><span class="op" id="4628642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628647">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4628656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628660">newSlice</span><span class="op" id="4628668">,</span>&nbsp;<span class="ident" id="4628670">err1</span>&nbsp;<span class="op" id="4628675">:=</span>&nbsp;<span class="ident" id="4628678">parseSequenceOf</span><span class="op" id="4628693">(</span><span class="ident" id="4628694">innerBytes</span><span class="op" id="4628704">,</span>&nbsp;<span class="ident" id="4628706">sliceType</span><span class="op" id="4628715">,</span>&nbsp;<span class="ident" id="4628717">sliceType</span><span class="op" id="4628726">.</span><span class="ident" id="4628727">Elem</span><span class="op" id="4628731">(</span><span class="op" id="4628732">)</span><span class="op" id="4628733">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628737">if</span>&nbsp;<span class="ident" id="4628740">err1</span>&nbsp;<span class="op" id="4628745">==</span>&nbsp;<span class="builtintype" id="4628748">nil</span>&nbsp;<span class="op" id="4628752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628757">val</span><span class="op" id="4628760">.</span><span class="ident" id="4628761">Set</span><span class="op" id="4628764">(</span><span class="ident" id="4628765">newSlice</span><span class="op" id="4628773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4628777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628781">err</span>&nbsp;<span class="op" id="4628785">=</span>&nbsp;<span class="ident" id="4628787">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628794">return</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628802">case</span>&nbsp;<span class="ident" id="4628807">reflect</span><span class="op" id="4628814">.</span><span class="ident" id="4628815">String</span><span class="op" id="4628821">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628825">var</span>&nbsp;<span class="ident" id="4628829">v</span>&nbsp;<span class="builtintype" id="4628831">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628840">switch</span>&nbsp;<span class="ident" id="4628847">universalTag</span>&nbsp;<span class="op" id="4628860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628864">case</span>&nbsp;<span class="ident" id="4628869">tagPrintableString</span><span class="op" id="4628887">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628892">v</span><span class="op" id="4628893">,</span>&nbsp;<span class="ident" id="4628895">err</span>&nbsp;<span class="op" id="4628899">=</span>&nbsp;<span class="ident" id="4628901">parsePrintableString</span><span class="op" id="4628921">(</span><span class="ident" id="4628922">innerBytes</span><span class="op" id="4628932">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628936">case</span>&nbsp;<span class="ident" id="4628941">tagIA5String</span><span class="op" id="4628953">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4628958">v</span><span class="op" id="4628959">,</span>&nbsp;<span class="ident" id="4628961">err</span>&nbsp;<span class="op" id="4628965">=</span>&nbsp;<span class="ident" id="4628967">parseIA5String</span><span class="op" id="4628981">(</span><span class="ident" id="4628982">innerBytes</span><span class="op" id="4628992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4628996">case</span>&nbsp;<span class="ident" id="4629001">tagT61String</span><span class="op" id="4629013">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4629018">v</span><span class="op" id="4629019">,</span>&nbsp;<span class="ident" id="4629021">err</span>&nbsp;<span class="op" id="4629025">=</span>&nbsp;<span class="ident" id="4629027">parseT61String</span><span class="op" id="4629041">(</span><span class="ident" id="4629042">innerBytes</span><span class="op" id="4629052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4629056">case</span>&nbsp;<span class="ident" id="4629061">tagUTF8String</span><span class="op" id="4629074">:</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4629079">v</span><span class="op" id="4629080">,</span>&nbsp;<span class="ident" id="4629082">err</span>&nbsp;<span class="op" id="4629086">=</span>&nbsp;<span class="ident" id="4629088">parseUTF8String</span><span class="op" id="4629103">(</span><span class="ident" id="4629104">innerBytes</span><span class="op" id="4629114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4629118">case</span>&nbsp;<span class="ident" id="4629123">tagGeneralString</span><span class="op" id="4629139">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4629144">//&nbsp;GeneralString&nbsp;is&nbsp;specified&nbsp;in&nbsp;ISO-2022/ECMA-35,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4629198">//&nbsp;A&nbsp;brief&nbsp;review&nbsp;suggests&nbsp;that&nbsp;it&nbsp;includes&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4629256">//&nbsp;that&nbsp;allow&nbsp;the&nbsp;encoding&nbsp;to&nbsp;change&nbsp;midstring&nbsp;and</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4629310">//&nbsp;such.&nbsp;We&nbsp;give&nbsp;up&nbsp;and&nbsp;pass&nbsp;it&nbsp;as&nbsp;an&nbsp;8-bit&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4629365">v</span><span class="op" id="4629366">,</span>&nbsp;<span class="ident" id="4629368">err</span>&nbsp;<span class="op" id="4629372">=</span>&nbsp;<span class="ident" id="4629374">parseT61String</span><span class="op" id="4629388">(</span><span class="ident" id="4629389">innerBytes</span><span class="op" id="4629399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4629403">default</span><span class="op" id="4629410">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4629415">err</span>&nbsp;<span class="op" id="4629419">=</span>&nbsp;<span class="ident" id="4629421">SyntaxError</span><span class="op" id="4629432">{</span><span class="ident" id="4629433">fmt</span><span class="op" id="4629436">.</span><span class="ident" id="4629437">Sprintf</span><span class="op" id="4629444">(</span><span class="string" id="4629445">&#34;internal&nbsp;error:&nbsp;unknown&nbsp;string&nbsp;type&nbsp;%d&#34;</span><span class="op" id="4629485">,</span>&nbsp;<span class="ident" id="4629487">universalTag</span><span class="op" id="4629499">)</span><span class="op" id="4629500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4629504">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4629508">if</span>&nbsp;<span class="ident" id="4629511">err</span>&nbsp;<span class="op" id="4629515">==</span>&nbsp;<span class="builtintype" id="4629518">nil</span>&nbsp;<span class="op" id="4629522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4629527">val</span><span class="op" id="4629530">.</span><span class="ident" id="4629531">SetString</span><span class="op" id="4629540">(</span><span class="ident" id="4629541">v</span><span class="op" id="4629542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4629546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4629550">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4629558">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4629561">err</span>&nbsp;<span class="op" id="4629565">=</span>&nbsp;<span class="ident" id="4629567">StructuralError</span><span class="op" id="4629582">{</span><span class="string" id="4629583">&#34;unsupported:&nbsp;&#34;</span>&nbsp;<span class="op" id="4629599">+</span>&nbsp;<span class="ident" id="4629601">v</span><span class="op" id="4629602">.</span><span class="ident" id="4629603">Type</span><span class="op" id="4629607">(</span><span class="op" id="4629608">)</span><span class="op" id="4629609">.</span><span class="ident" id="4629610">String</span><span class="op" id="4629616">(</span><span class="op" id="4629617">)</span><span class="op" id="4629618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4629621">return</span><br>
<span class="lineno"></span><span class="op" id="4629628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4629631">//&nbsp;canHaveDefaultValue&nbsp;reports&nbsp;whether&nbsp;k&nbsp;is&nbsp;a&nbsp;Kind&nbsp;that&nbsp;we&nbsp;will&nbsp;set&nbsp;a&nbsp;default</span><br>
<span class="lineno">830</span><span class="comment" id="4629709">//&nbsp;value&nbsp;for.&nbsp;(A&nbsp;signed&nbsp;integer,&nbsp;essentially.)</span><br>
<span class="lineno"></span><span class="keyword" id="4629756">func</span>&nbsp;<span class="ident" id="4629761">canHaveDefaultValue</span><span class="op" id="4629780">(</span><span class="ident" id="4629781">k</span>&nbsp;<span class="ident" id="4629783">reflect</span><span class="op" id="4629790">.</span><span class="ident" id="4629791">Kind</span><span class="op" id="4629795">)</span>&nbsp;<span class="builtintype" id="4629797">bool</span>&nbsp;<span class="op" id="4629802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4629805">switch</span>&nbsp;<span class="ident" id="4629812">k</span>&nbsp;<span class="op" id="4629814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4629817">case</span>&nbsp;<span class="ident" id="4629822">reflect</span><span class="op" id="4629829">.</span><span class="ident" id="4629830">Int</span><span class="op" id="4629833">,</span>&nbsp;<span class="ident" id="4629835">reflect</span><span class="op" id="4629842">.</span><span class="ident" id="4629843">Int8</span><span class="op" id="4629847">,</span>&nbsp;<span class="ident" id="4629849">reflect</span><span class="op" id="4629856">.</span><span class="ident" id="4629857">Int16</span><span class="op" id="4629862">,</span>&nbsp;<span class="ident" id="4629864">reflect</span><span class="op" id="4629871">.</span><span class="ident" id="4629872">Int32</span><span class="op" id="4629877">,</span>&nbsp;<span class="ident" id="4629879">reflect</span><span class="op" id="4629886">.</span><span class="ident" id="4629887">Int64</span><span class="op" id="4629892">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4629896">return</span>&nbsp;<span class="builtintype" id="4629903">true</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4629909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4629913">return</span>&nbsp;<span class="builtintype" id="4629920">false</span><br>
<span class="lineno"></span><span class="op" id="4629926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="4629929">//&nbsp;setDefaultValue&nbsp;is&nbsp;used&nbsp;to&nbsp;install&nbsp;a&nbsp;default&nbsp;value,&nbsp;from&nbsp;a&nbsp;tag&nbsp;string,&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="4630008">//&nbsp;a&nbsp;Value.&nbsp;It&nbsp;is&nbsp;successful&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;optional,&nbsp;even&nbsp;if&nbsp;a&nbsp;default&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="4630088">//&nbsp;wasn&#39;t&nbsp;provided&nbsp;or&nbsp;it&nbsp;failed&nbsp;to&nbsp;install&nbsp;it&nbsp;into&nbsp;the&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="4630150">func</span>&nbsp;<span class="ident" id="4630155">setDefaultValue</span><span class="op" id="4630170">(</span><span class="ident" id="4630171">v</span>&nbsp;<span class="ident" id="4630173">reflect</span><span class="op" id="4630180">.</span><span class="ident" id="4630181">Value</span><span class="op" id="4630186">,</span>&nbsp;<span class="ident" id="4630188">params</span>&nbsp;<span class="ident" id="4630195">fieldParameters</span><span class="op" id="4630210">)</span>&nbsp;<span class="op" id="4630212">(</span><span class="ident" id="4630213">ok</span>&nbsp;<span class="builtintype" id="4630216">bool</span><span class="op" id="4630220">)</span>&nbsp;<span class="op" id="4630222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4630225">if</span>&nbsp;<span class="op" id="4630228">!</span><span class="ident" id="4630229">params</span><span class="op" id="4630235">.</span><span class="ident" id="4630236">optional</span>&nbsp;<span class="op" id="4630245">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4630249">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4630257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630260">ok</span>&nbsp;<span class="op" id="4630263">=</span>&nbsp;<span class="builtintype" id="4630265">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4630271">if</span>&nbsp;<span class="ident" id="4630274">params</span><span class="op" id="4630280">.</span><span class="ident" id="4630281">defaultValue</span>&nbsp;<span class="op" id="4630294">==</span>&nbsp;<span class="builtintype" id="4630297">nil</span>&nbsp;<span class="op" id="4630301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4630305">return</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4630313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4630316">if</span>&nbsp;<span class="ident" id="4630319">canHaveDefaultValue</span><span class="op" id="4630338">(</span><span class="ident" id="4630339">v</span><span class="op" id="4630340">.</span><span class="ident" id="4630341">Kind</span><span class="op" id="4630345">(</span><span class="op" id="4630346">)</span><span class="op" id="4630347">)</span>&nbsp;<span class="op" id="4630349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4630353">v</span><span class="op" id="4630354">.</span><span class="ident" id="4630355">SetInt</span><span class="op" id="4630361">(</span><span class="op" id="4630362">*</span><span class="ident" id="4630363">params</span><span class="op" id="4630369">.</span><span class="ident" id="4630370">defaultValue</span><span class="op" id="4630382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4630385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4630388">return</span><br>
<span class="lineno">855</span><span class="op" id="4630395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4630398">//&nbsp;Unmarshal&nbsp;parses&nbsp;the&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structure&nbsp;b</span><br>
<span class="lineno"></span><span class="comment" id="4630457">//&nbsp;and&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package&nbsp;to&nbsp;fill&nbsp;in&nbsp;an&nbsp;arbitrary&nbsp;value&nbsp;pointed&nbsp;at&nbsp;by&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment" id="4630538">//&nbsp;Because&nbsp;Unmarshal&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package,&nbsp;the&nbsp;structs</span><br>
<span class="lineno">860</span><span class="comment" id="4630597">//&nbsp;being&nbsp;written&nbsp;to&nbsp;must&nbsp;use&nbsp;upper&nbsp;case&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span><span class="comment" id="4630650">//</span><br>
<span class="lineno"></span><span class="comment" id="4630653">//&nbsp;An&nbsp;ASN.1&nbsp;INTEGER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;int,&nbsp;int32,&nbsp;int64,</span><br>
<span class="lineno"></span><span class="comment" id="4630713">//&nbsp;or&nbsp;*big.Int&nbsp;(from&nbsp;the&nbsp;math/big&nbsp;package).</span><br>
<span class="lineno"></span><span class="comment" id="4630757">//&nbsp;If&nbsp;the&nbsp;encoded&nbsp;value&nbsp;does&nbsp;not&nbsp;fit&nbsp;in&nbsp;the&nbsp;Go&nbsp;type,</span><br>
<span class="lineno">865</span><span class="comment" id="4630810">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4630846">//</span><br>
<span class="lineno"></span><span class="comment" id="4630849">//&nbsp;An&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="comment" id="4630903">//</span><br>
<span class="lineno"></span><span class="comment" id="4630906">//&nbsp;An&nbsp;ASN.1&nbsp;OCTET&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;[]byte.</span><br>
<span class="lineno">870</span><span class="comment" id="4630959">//</span><br>
<span class="lineno"></span><span class="comment" id="4630962">//&nbsp;An&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4631013">//&nbsp;ObjectIdentifier.</span><br>
<span class="lineno"></span><span class="comment" id="4631034">//</span><br>
<span class="lineno"></span><span class="comment" id="4631037">//&nbsp;An&nbsp;ASN.1&nbsp;ENUMERATED&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;Enumerated.</span><br>
<span class="lineno">875</span><span class="comment" id="4631093">//</span><br>
<span class="lineno"></span><span class="comment" id="4631096">//&nbsp;An&nbsp;ASN.1&nbsp;UTCTIME&nbsp;or&nbsp;GENERALIZEDTIME&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;time.Time.</span><br>
<span class="lineno"></span><span class="comment" id="4631166">//</span><br>
<span class="lineno"></span><span class="comment" id="4631169">//&nbsp;An&nbsp;ASN.1&nbsp;PrintableString&nbsp;or&nbsp;IA5String&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="4631238">//</span><br>
<span class="lineno">880</span><span class="comment" id="4631241">//&nbsp;Any&nbsp;of&nbsp;the&nbsp;above&nbsp;ASN.1&nbsp;values&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="4631308">//&nbsp;The&nbsp;value&nbsp;stored&nbsp;in&nbsp;the&nbsp;interface&nbsp;has&nbsp;the&nbsp;corresponding&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4631376">//&nbsp;For&nbsp;integers,&nbsp;that&nbsp;type&nbsp;is&nbsp;int64.</span><br>
<span class="lineno"></span><span class="comment" id="4631413">//</span><br>
<span class="lineno"></span><span class="comment" id="4631416">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;OF&nbsp;x&nbsp;or&nbsp;SET&nbsp;OF&nbsp;x&nbsp;can&nbsp;be&nbsp;written</span><br>
<span class="lineno">885</span><span class="comment" id="4631469">//&nbsp;to&nbsp;a&nbsp;slice&nbsp;if&nbsp;an&nbsp;x&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;the&nbsp;slice&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4631535">//</span><br>
<span class="lineno"></span><span class="comment" id="4631538">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;or&nbsp;SET&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span><span class="comment" id="4631593">//&nbsp;if&nbsp;each&nbsp;of&nbsp;the&nbsp;elements&nbsp;in&nbsp;the&nbsp;sequence&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4631643">//&nbsp;written&nbsp;to&nbsp;the&nbsp;corresponding&nbsp;element&nbsp;in&nbsp;the&nbsp;struct.</span><br>
<span class="lineno">890</span><span class="comment" id="4631698">//</span><br>
<span class="lineno"></span><span class="comment" id="4631701">//&nbsp;The&nbsp;following&nbsp;tags&nbsp;on&nbsp;struct&nbsp;fields&nbsp;have&nbsp;special&nbsp;meaning&nbsp;to&nbsp;Unmarshal:</span><br>
<span class="lineno"></span><span class="comment" id="4631775">//</span><br>
<span class="lineno"></span><span class="comment" id="4631778">//&nbsp;&nbsp;&nbsp;&nbsp;application&nbsp;&nbsp;&nbsp;&nbsp;specifies&nbsp;that&nbsp;a&nbsp;APPLICATION&nbsp;tag&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span><span class="comment" id="4631834">//&nbsp;&nbsp;&nbsp;&nbsp;default:x&nbsp;&nbsp;&nbsp;&nbsp;sets&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;optional&nbsp;integer&nbsp;fields</span><br>
<span class="lineno">895</span><span class="comment" id="4631898">//&nbsp;&nbsp;&nbsp;&nbsp;explicit&nbsp;&nbsp;&nbsp;&nbsp;specifies&nbsp;that&nbsp;an&nbsp;additional,&nbsp;explicit&nbsp;tag&nbsp;wraps&nbsp;the&nbsp;implicit&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="4631976">//&nbsp;&nbsp;&nbsp;&nbsp;optional&nbsp;&nbsp;&nbsp;&nbsp;marks&nbsp;the&nbsp;field&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL</span><br>
<span class="lineno"></span><span class="comment" id="4632022">//&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;causes&nbsp;a&nbsp;SET,&nbsp;rather&nbsp;than&nbsp;a&nbsp;SEQUENCE&nbsp;type&nbsp;to&nbsp;be&nbsp;expected</span><br>
<span class="lineno"></span><span class="comment" id="4632087">//&nbsp;&nbsp;&nbsp;&nbsp;tag:x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;specifies&nbsp;the&nbsp;ASN.1&nbsp;tag&nbsp;number;&nbsp;implies&nbsp;ASN.1&nbsp;CONTEXT&nbsp;SPECIFIC</span><br>
<span class="lineno"></span><span class="comment" id="4632160">//</span><br>
<span class="lineno">900</span><span class="comment" id="4632163">//&nbsp;If&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;a&nbsp;structure&nbsp;is&nbsp;RawContent&nbsp;then&nbsp;the&nbsp;raw</span><br>
<span class="lineno"></span><span class="comment" id="4632239">//&nbsp;ASN1&nbsp;contents&nbsp;of&nbsp;the&nbsp;struct&nbsp;will&nbsp;be&nbsp;stored&nbsp;in&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="4632292">//</span><br>
<span class="lineno"></span><span class="comment" id="4632295">//&nbsp;If&nbsp;the&nbsp;type&nbsp;name&nbsp;of&nbsp;a&nbsp;slice&nbsp;element&nbsp;ends&nbsp;with&nbsp;&#34;SET&#34;&nbsp;then&nbsp;it&#39;s&nbsp;treated&nbsp;as&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="4632374">//&nbsp;the&nbsp;&#34;set&#34;&nbsp;tag&nbsp;was&nbsp;set&nbsp;on&nbsp;it.&nbsp;This&nbsp;can&nbsp;be&nbsp;used&nbsp;with&nbsp;nested&nbsp;slices&nbsp;where&nbsp;a</span><br>
<span class="lineno">905</span><span class="comment" id="4632450">//&nbsp;struct&nbsp;tag&nbsp;cannot&nbsp;be&nbsp;given.</span><br>
<span class="lineno"></span><span class="comment" id="4632481">//</span><br>
<span class="lineno"></span><span class="comment" id="4632484">//&nbsp;Other&nbsp;ASN.1&nbsp;types&nbsp;are&nbsp;not&nbsp;supported;&nbsp;if&nbsp;it&nbsp;encounters&nbsp;them,</span><br>
<span class="lineno"></span><span class="comment" id="4632547">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="4632583">func</span>&nbsp;<span class="ident" id="4632588">Unmarshal</span><span class="op" id="4632597">(</span><span class="ident" id="4632598">b</span>&nbsp;<span class="op" id="4632600">[</span><span class="op" id="4632601">]</span><span class="builtintype" id="4632602">byte</span><span class="op" id="4632606">,</span>&nbsp;<span class="ident" id="4632608">val</span>&nbsp;<span class="keyword" id="4632612">interface</span><span class="op" id="4632621">{</span><span class="op" id="4632622">}</span><span class="op" id="4632623">)</span>&nbsp;<span class="op" id="4632625">(</span><span class="ident" id="4632626">rest</span>&nbsp;<span class="op" id="4632631">[</span><span class="op" id="4632632">]</span><span class="builtintype" id="4632633">byte</span><span class="op" id="4632637">,</span>&nbsp;<span class="ident" id="4632639">err</span>&nbsp;<span class="builtintype" id="4632643">error</span><span class="op" id="4632648">)</span>&nbsp;<span class="op" id="4632650">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4632653">return</span>&nbsp;<span class="ident" id="4632660">UnmarshalWithParams</span><span class="op" id="4632679">(</span><span class="ident" id="4632680">b</span><span class="op" id="4632681">,</span>&nbsp;<span class="ident" id="4632683">val</span><span class="op" id="4632686">,</span>&nbsp;<span class="string" id="4632688">&#34;&#34;</span><span class="op" id="4632690">)</span><br>
<span class="lineno"></span><span class="op" id="4632692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4632695">//&nbsp;UnmarshalWithParams&nbsp;allows&nbsp;field&nbsp;parameters&nbsp;to&nbsp;be&nbsp;specified&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4632766">//&nbsp;top-level&nbsp;element.&nbsp;The&nbsp;form&nbsp;of&nbsp;the&nbsp;params&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;field&nbsp;tags.</span><br>
<span class="lineno">915</span><span class="keyword" id="4632842">func</span>&nbsp;<span class="ident" id="4632847">UnmarshalWithParams</span><span class="op" id="4632866">(</span><span class="ident" id="4632867">b</span>&nbsp;<span class="op" id="4632869">[</span><span class="op" id="4632870">]</span><span class="builtintype" id="4632871">byte</span><span class="op" id="4632875">,</span>&nbsp;<span class="ident" id="4632877">val</span>&nbsp;<span class="keyword" id="4632881">interface</span><span class="op" id="4632890">{</span><span class="op" id="4632891">}</span><span class="op" id="4632892">,</span>&nbsp;<span class="ident" id="4632894">params</span>&nbsp;<span class="builtintype" id="4632901">string</span><span class="op" id="4632907">)</span>&nbsp;<span class="op" id="4632909">(</span><span class="ident" id="4632910">rest</span>&nbsp;<span class="op" id="4632915">[</span><span class="op" id="4632916">]</span><span class="builtintype" id="4632917">byte</span><span class="op" id="4632921">,</span>&nbsp;<span class="ident" id="4632923">err</span>&nbsp;<span class="builtintype" id="4632927">error</span><span class="op" id="4632932">)</span>&nbsp;<span class="op" id="4632934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632937">v</span>&nbsp;<span class="op" id="4632939">:=</span>&nbsp;<span class="ident" id="4632942">reflect</span><span class="op" id="4632949">.</span><span class="ident" id="4632950">ValueOf</span><span class="op" id="4632957">(</span><span class="ident" id="4632958">val</span><span class="op" id="4632961">)</span><span class="op" id="4632962">.</span><span class="ident" id="4632963">Elem</span><span class="op" id="4632967">(</span><span class="op" id="4632968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4632971">offset</span><span class="op" id="4632977">,</span>&nbsp;<span class="ident" id="4632979">err</span>&nbsp;<span class="op" id="4632983">:=</span>&nbsp;<span class="ident" id="4632986">parseField</span><span class="op" id="4632996">(</span><span class="ident" id="4632997">v</span><span class="op" id="4632998">,</span>&nbsp;<span class="ident" id="4633000">b</span><span class="op" id="4633001">,</span>&nbsp;<span class="num" id="4633003">0</span><span class="op" id="4633004">,</span>&nbsp;<span class="ident" id="4633006">parseFieldParameters</span><span class="op" id="4633026">(</span><span class="ident" id="4633027">params</span><span class="op" id="4633033">)</span><span class="op" id="4633034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4633037">if</span>&nbsp;<span class="ident" id="4633040">err</span>&nbsp;<span class="op" id="4633044">!=</span>&nbsp;<span class="builtintype" id="4633047">nil</span>&nbsp;<span class="op" id="4633051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4633055">return</span>&nbsp;<span class="builtintype" id="4633062">nil</span><span class="op" id="4633065">,</span>&nbsp;<span class="ident" id="4633067">err</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4633072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4633075">return</span>&nbsp;<span class="ident" id="4633082">b</span><span class="op" id="4633083">[</span><span class="ident" id="4633084">offset</span><span class="op" id="4633090">:</span><span class="op" id="4633091">]</span><span class="op" id="4633092">,</span>&nbsp;<span class="builtintype" id="4633094">nil</span><br>
<span class="lineno"></span><span class="op" id="4633098">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
