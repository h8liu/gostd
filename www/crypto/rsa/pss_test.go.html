<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7680008">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7680063">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7680117">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7680168">package</span>&nbsp;<span class="ident" id="7680176">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7680181">import</span>&nbsp;<span class="op" id="7680188">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7680191">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7680200">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7680209">&#34;compress/bzip2&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7680227">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7680237">_</span>&nbsp;<span class="string" id="7680239">&#34;crypto/md5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7680253">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7680268">&#34;crypto/sha1&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7680283">_</span>&nbsp;<span class="string" id="7680285">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7680302">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7680318">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7680330">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7680336">&#34;strconv&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7680347">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7680358">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7680368">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7680371">func</span>&nbsp;<span class="ident" id="7680376">TestEMSAPSS</span><span class="op" id="7680387">(</span><span class="ident" id="7680388">t</span>&nbsp;<span class="op" id="7680390">*</span><span class="ident" id="7680391"><a href="/crypto/rsa/pss_test.go.html#7680358">testing</a></span><span class="op" id="7680398">.</span><span class="ident" id="7680399">T</span><span class="op" id="7680400">)</span>&nbsp;<span class="op" id="7680402">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7680405">//&nbsp;Test&nbsp;vector&nbsp;in&nbsp;file&nbsp;pss-int.txt&nbsp;from:&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7680508">msg</span>&nbsp;<span class="op" id="7680512">:=</span>&nbsp;<span class="op" id="7680515">[</span><span class="op" id="7680516">]</span><span class="builtintype" id="7680517">byte</span><span class="op" id="7680521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7680525">0x85</span><span class="op" id="7680529">,</span>&nbsp;<span class="num" id="7680531">0x9e</span><span class="op" id="7680535">,</span>&nbsp;<span class="num" id="7680537">0xef</span><span class="op" id="7680541">,</span>&nbsp;<span class="num" id="7680543">0x2f</span><span class="op" id="7680547">,</span>&nbsp;<span class="num" id="7680549">0xd7</span><span class="op" id="7680553">,</span>&nbsp;<span class="num" id="7680555">0x8a</span><span class="op" id="7680559">,</span>&nbsp;<span class="num" id="7680561">0xca</span><span class="op" id="7680565">,</span>&nbsp;<span class="num" id="7680567">0x00</span><span class="op" id="7680571">,</span>&nbsp;<span class="num" id="7680573">0x30</span><span class="op" id="7680577">,</span>&nbsp;<span class="num" id="7680579">0x8b</span><span class="op" id="7680583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7680587">0xdc</span><span class="op" id="7680591">,</span>&nbsp;<span class="num" id="7680593">0x47</span><span class="op" id="7680597">,</span>&nbsp;<span class="num" id="7680599">0x11</span><span class="op" id="7680603">,</span>&nbsp;<span class="num" id="7680605">0x93</span><span class="op" id="7680609">,</span>&nbsp;<span class="num" id="7680611">0xbf</span><span class="op" id="7680615">,</span>&nbsp;<span class="num" id="7680617">0x55</span><span class="op" id="7680621">,</span>&nbsp;<span class="num" id="7680623">0xbf</span><span class="op" id="7680627">,</span>&nbsp;<span class="num" id="7680629">0x9d</span><span class="op" id="7680633">,</span>&nbsp;<span class="num" id="7680635">0x78</span><span class="op" id="7680639">,</span>&nbsp;<span class="num" id="7680641">0xdb</span><span class="op" id="7680645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7680649">0x8f</span><span class="op" id="7680653">,</span>&nbsp;<span class="num" id="7680655">0x8a</span><span class="op" id="7680659">,</span>&nbsp;<span class="num" id="7680661">0x67</span><span class="op" id="7680665">,</span>&nbsp;<span class="num" id="7680667">0x2b</span><span class="op" id="7680671">,</span>&nbsp;<span class="num" id="7680673">0x48</span><span class="op" id="7680677">,</span>&nbsp;<span class="num" id="7680679">0x46</span><span class="op" id="7680683">,</span>&nbsp;<span class="num" id="7680685">0x34</span><span class="op" id="7680689">,</span>&nbsp;<span class="num" id="7680691">0xf3</span><span class="op" id="7680695">,</span>&nbsp;<span class="num" id="7680697">0xc9</span><span class="op" id="7680701">,</span>&nbsp;<span class="num" id="7680703">0xc2</span><span class="op" id="7680707">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7680711">0x6e</span><span class="op" id="7680715">,</span>&nbsp;<span class="num" id="7680717">0x64</span><span class="op" id="7680721">,</span>&nbsp;<span class="num" id="7680723">0x78</span><span class="op" id="7680727">,</span>&nbsp;<span class="num" id="7680729">0xae</span><span class="op" id="7680733">,</span>&nbsp;<span class="num" id="7680735">0x10</span><span class="op" id="7680739">,</span>&nbsp;<span class="num" id="7680741">0x26</span><span class="op" id="7680745">,</span>&nbsp;<span class="num" id="7680747">0x0f</span><span class="op" id="7680751">,</span>&nbsp;<span class="num" id="7680753">0xe0</span><span class="op" id="7680757">,</span>&nbsp;<span class="num" id="7680759">0xdd</span><span class="op" id="7680763">,</span>&nbsp;<span class="num" id="7680765">0x8c</span><span class="op" id="7680769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7680773">0x08</span><span class="op" id="7680777">,</span>&nbsp;<span class="num" id="7680779">0x2e</span><span class="op" id="7680783">,</span>&nbsp;<span class="num" id="7680785">0x53</span><span class="op" id="7680789">,</span>&nbsp;<span class="num" id="7680791">0xa5</span><span class="op" id="7680795">,</span>&nbsp;<span class="num" id="7680797">0x29</span><span class="op" id="7680801">,</span>&nbsp;<span class="num" id="7680803">0x3a</span><span class="op" id="7680807">,</span>&nbsp;<span class="num" id="7680809">0xf2</span><span class="op" id="7680813">,</span>&nbsp;<span class="num" id="7680815">0x17</span><span class="op" id="7680819">,</span>&nbsp;<span class="num" id="7680821">0x3c</span><span class="op" id="7680825">,</span>&nbsp;<span class="num" id="7680827">0xd5</span><span class="op" id="7680831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7680835">0x0c</span><span class="op" id="7680839">,</span>&nbsp;<span class="num" id="7680841">0x6d</span><span class="op" id="7680845">,</span>&nbsp;<span class="num" id="7680847">0x5d</span><span class="op" id="7680851">,</span>&nbsp;<span class="num" id="7680853">0x35</span><span class="op" id="7680857">,</span>&nbsp;<span class="num" id="7680859">0x4f</span><span class="op" id="7680863">,</span>&nbsp;<span class="num" id="7680865">0xeb</span><span class="op" id="7680869">,</span>&nbsp;<span class="num" id="7680871">0xf7</span><span class="op" id="7680875">,</span>&nbsp;<span class="num" id="7680877">0x8b</span><span class="op" id="7680881">,</span>&nbsp;<span class="num" id="7680883">0x26</span><span class="op" id="7680887">,</span>&nbsp;<span class="num" id="7680889">0x02</span><span class="op" id="7680893">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7680897">0x1c</span><span class="op" id="7680901">,</span>&nbsp;<span class="num" id="7680903">0x25</span><span class="op" id="7680907">,</span>&nbsp;<span class="num" id="7680909">0xc0</span><span class="op" id="7680913">,</span>&nbsp;<span class="num" id="7680915">0x27</span><span class="op" id="7680919">,</span>&nbsp;<span class="num" id="7680921">0x12</span><span class="op" id="7680925">,</span>&nbsp;<span class="num" id="7680927">0xe7</span><span class="op" id="7680931">,</span>&nbsp;<span class="num" id="7680933">0x8c</span><span class="op" id="7680937">,</span>&nbsp;<span class="num" id="7680939">0xd4</span><span class="op" id="7680943">,</span>&nbsp;<span class="num" id="7680945">0x69</span><span class="op" id="7680949">,</span>&nbsp;<span class="num" id="7680951">0x4c</span><span class="op" id="7680955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7680959">0x9f</span><span class="op" id="7680963">,</span>&nbsp;<span class="num" id="7680965">0x46</span><span class="op" id="7680969">,</span>&nbsp;<span class="num" id="7680971">0x97</span><span class="op" id="7680975">,</span>&nbsp;<span class="num" id="7680977">0x77</span><span class="op" id="7680981">,</span>&nbsp;<span class="num" id="7680983">0xe4</span><span class="op" id="7680987">,</span>&nbsp;<span class="num" id="7680989">0x51</span><span class="op" id="7680993">,</span>&nbsp;<span class="num" id="7680995">0xe7</span><span class="op" id="7680999">,</span>&nbsp;<span class="num" id="7681001">0xf8</span><span class="op" id="7681005">,</span>&nbsp;<span class="num" id="7681007">0xe9</span><span class="op" id="7681011">,</span>&nbsp;<span class="num" id="7681013">0xe0</span><span class="op" id="7681017">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7681021">0x4c</span><span class="op" id="7681025">,</span>&nbsp;<span class="num" id="7681027">0xd3</span><span class="op" id="7681031">,</span>&nbsp;<span class="num" id="7681033">0x73</span><span class="op" id="7681037">,</span>&nbsp;<span class="num" id="7681039">0x9c</span><span class="op" id="7681043">,</span>&nbsp;<span class="num" id="7681045">0x6b</span><span class="op" id="7681049">,</span>&nbsp;<span class="num" id="7681051">0xbf</span><span class="op" id="7681055">,</span>&nbsp;<span class="num" id="7681057">0xed</span><span class="op" id="7681061">,</span>&nbsp;<span class="num" id="7681063">0xae</span><span class="op" id="7681067">,</span>&nbsp;<span class="num" id="7681069">0x48</span><span class="op" id="7681073">,</span>&nbsp;<span class="num" id="7681075">0x7f</span><span class="op" id="7681079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7681083">0xb5</span><span class="op" id="7681087">,</span>&nbsp;<span class="num" id="7681089">0x56</span><span class="op" id="7681093">,</span>&nbsp;<span class="num" id="7681095">0x44</span><span class="op" id="7681099">,</span>&nbsp;<span class="num" id="7681101">0xe9</span><span class="op" id="7681105">,</span>&nbsp;<span class="num" id="7681107">0xca</span><span class="op" id="7681111">,</span>&nbsp;<span class="num" id="7681113">0x74</span><span class="op" id="7681117">,</span>&nbsp;<span class="num" id="7681119">0xff</span><span class="op" id="7681123">,</span>&nbsp;<span class="num" id="7681125">0x77</span><span class="op" id="7681129">,</span>&nbsp;<span class="num" id="7681131">0xa5</span><span class="op" id="7681135">,</span>&nbsp;<span class="num" id="7681137">0x3c</span><span class="op" id="7681141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7681145">0xb7</span><span class="op" id="7681149">,</span>&nbsp;<span class="num" id="7681151">0x29</span><span class="op" id="7681155">,</span>&nbsp;<span class="num" id="7681157">0x80</span><span class="op" id="7681161">,</span>&nbsp;<span class="num" id="7681163">0x2f</span><span class="op" id="7681167">,</span>&nbsp;<span class="num" id="7681169">0x6e</span><span class="op" id="7681173">,</span>&nbsp;<span class="num" id="7681175">0xd4</span><span class="op" id="7681179">,</span>&nbsp;<span class="num" id="7681181">0xa5</span><span class="op" id="7681185">,</span>&nbsp;<span class="num" id="7681187">0xff</span><span class="op" id="7681191">,</span>&nbsp;<span class="num" id="7681193">0xa8</span><span class="op" id="7681197">,</span>&nbsp;<span class="num" id="7681199">0xba</span><span class="op" id="7681203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7681207">0x15</span><span class="op" id="7681211">,</span>&nbsp;<span class="num" id="7681213">0x98</span><span class="op" id="7681217">,</span>&nbsp;<span class="num" id="7681219">0x90</span><span class="op" id="7681223">,</span>&nbsp;<span class="num" id="7681225">0xfc</span><span class="op" id="7681229">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7681232">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7681235">salt</span>&nbsp;<span class="op" id="7681240">:=</span>&nbsp;<span class="op" id="7681243">[</span><span class="op" id="7681244">]</span><span class="builtintype" id="7681245">byte</span><span class="op" id="7681249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7681253">0xe3</span><span class="op" id="7681257">,</span>&nbsp;<span class="num" id="7681259">0xb5</span><span class="op" id="7681263">,</span>&nbsp;<span class="num" id="7681265">0xd5</span><span class="op" id="7681269">,</span>&nbsp;<span class="num" id="7681271">0xd0</span><span class="op" id="7681275">,</span>&nbsp;<span class="num" id="7681277">0x02</span><span class="op" id="7681281">,</span>&nbsp;<span class="num" id="7681283">0xc1</span><span class="op" id="7681287">,</span>&nbsp;<span class="num" id="7681289">0xbc</span><span class="op" id="7681293">,</span>&nbsp;<span class="num" id="7681295">0xe5</span><span class="op" id="7681299">,</span>&nbsp;<span class="num" id="7681301">0x0c</span><span class="op" id="7681305">,</span>&nbsp;<span class="num" id="7681307">0x2b</span><span class="op" id="7681311">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7681315">0x65</span><span class="op" id="7681319">,</span>&nbsp;<span class="num" id="7681321">0xef</span><span class="op" id="7681325">,</span>&nbsp;<span class="num" id="7681327">0x88</span><span class="op" id="7681331">,</span>&nbsp;<span class="num" id="7681333">0xa1</span><span class="op" id="7681337">,</span>&nbsp;<span class="num" id="7681339">0x88</span><span class="op" id="7681343">,</span>&nbsp;<span class="num" id="7681345">0xd8</span><span class="op" id="7681349">,</span>&nbsp;<span class="num" id="7681351">0x3b</span><span class="op" id="7681355">,</span>&nbsp;<span class="num" id="7681357">0xce</span><span class="op" id="7681361">,</span>&nbsp;<span class="num" id="7681363">0x7e</span><span class="op" id="7681367">,</span>&nbsp;<span class="num" id="7681369">0x61</span><span class="op" id="7681373">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7681376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7681379">expected</span>&nbsp;<span class="op" id="7681388">:=</span>&nbsp;<span class="op" id="7681391">[</span><span class="op" id="7681392">]</span><span class="builtintype" id="7681393">byte</span><span class="op" id="7681397">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7681401">0x66</span><span class="op" id="7681405">,</span>&nbsp;<span class="num" id="7681407">0xe4</span><span class="op" id="7681411">,</span>&nbsp;<span class="num" id="7681413">0x67</span><span class="op" id="7681417">,</span>&nbsp;<span class="num" id="7681419">0x2e</span><span class="op" id="7681423">,</span>&nbsp;<span class="num" id="7681425">0x83</span><span class="op" id="7681429">,</span>&nbsp;<span class="num" id="7681431">0x6a</span><span class="op" id="7681435">,</span>&nbsp;<span class="num" id="7681437">0xd1</span><span class="op" id="7681441">,</span>&nbsp;<span class="num" id="7681443">0x21</span><span class="op" id="7681447">,</span>&nbsp;<span class="num" id="7681449">0xba</span><span class="op" id="7681453">,</span>&nbsp;<span class="num" id="7681455">0x24</span><span class="op" id="7681459">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7681463">0x4b</span><span class="op" id="7681467">,</span>&nbsp;<span class="num" id="7681469">0xed</span><span class="op" id="7681473">,</span>&nbsp;<span class="num" id="7681475">0x65</span><span class="op" id="7681479">,</span>&nbsp;<span class="num" id="7681481">0x76</span><span class="op" id="7681485">,</span>&nbsp;<span class="num" id="7681487">0xb8</span><span class="op" id="7681491">,</span>&nbsp;<span class="num" id="7681493">0x67</span><span class="op" id="7681497">,</span>&nbsp;<span class="num" id="7681499">0xd9</span><span class="op" id="7681503">,</span>&nbsp;<span class="num" id="7681505">0xa4</span><span class="op" id="7681509">,</span>&nbsp;<span class="num" id="7681511">0x47</span><span class="op" id="7681515">,</span>&nbsp;<span class="num" id="7681517">0xc2</span><span class="op" id="7681521">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7681525">0x8a</span><span class="op" id="7681529">,</span>&nbsp;<span class="num" id="7681531">0x6e</span><span class="op" id="7681535">,</span>&nbsp;<span class="num" id="7681537">0x66</span><span class="op" id="7681541">,</span>&nbsp;<span class="num" id="7681543">0xa5</span><span class="op" id="7681547">,</span>&nbsp;<span class="num" id="7681549">0xb8</span><span class="op" id="7681553">,</span>&nbsp;<span class="num" id="7681555">0x7d</span><span class="op" id="7681559">,</span>&nbsp;<span class="num" id="7681561">0xee</span><span class="op" id="7681565">,</span>&nbsp;<span class="num" id="7681567">0x7f</span><span class="op" id="7681571">,</span>&nbsp;<span class="num" id="7681573">0xbc</span><span class="op" id="7681577">,</span>&nbsp;<span class="num" id="7681579">0x7e</span><span class="op" id="7681583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7681587">0x65</span><span class="op" id="7681591">,</span>&nbsp;<span class="num" id="7681593">0xaf</span><span class="op" id="7681597">,</span>&nbsp;<span class="num" id="7681599">0x50</span><span class="op" id="7681603">,</span>&nbsp;<span class="num" id="7681605">0x57</span><span class="op" id="7681609">,</span>&nbsp;<span class="num" id="7681611">0xf8</span><span class="op" id="7681615">,</span>&nbsp;<span class="num" id="7681617">0x6f</span><span class="op" id="7681621">,</span>&nbsp;<span class="num" id="7681623">0xae</span><span class="op" id="7681627">,</span>&nbsp;<span class="num" id="7681629">0x89</span><span class="op" id="7681633">,</span>&nbsp;<span class="num" id="7681635">0x84</span><span class="op" id="7681639">,</span>&nbsp;<span class="num" id="7681641">0xd9</span><span class="op" id="7681645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7681649">0xba</span><span class="op" id="7681653">,</span>&nbsp;<span class="num" id="7681655">0x7f</span><span class="op" id="7681659">,</span>&nbsp;<span class="num" id="7681661">0x96</span><span class="op" id="7681665">,</span>&nbsp;<span class="num" id="7681667">0x9a</span><span class="op" id="7681671">,</span>&nbsp;<span class="num" id="7681673">0xd6</span><span class="op" id="7681677">,</span>&nbsp;<span class="num" id="7681679">0xfe</span><span class="op" id="7681683">,</span>&nbsp;<span class="num" id="7681685">0x02</span><span class="op" id="7681689">,</span>&nbsp;<span class="num" id="7681691">0xa4</span><span class="op" id="7681695">,</span>&nbsp;<span class="num" id="7681697">0xd7</span><span class="op" id="7681701">,</span>&nbsp;<span class="num" id="7681703">0x5f</span><span class="op" id="7681707">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7681711">0x74</span><span class="op" id="7681715">,</span>&nbsp;<span class="num" id="7681717">0x45</span><span class="op" id="7681721">,</span>&nbsp;<span class="num" id="7681723">0xfe</span><span class="op" id="7681727">,</span>&nbsp;<span class="num" id="7681729">0xfd</span><span class="op" id="7681733">,</span>&nbsp;<span class="num" id="7681735">0xd8</span><span class="op" id="7681739">,</span>&nbsp;<span class="num" id="7681741">0x5b</span><span class="op" id="7681745">,</span>&nbsp;<span class="num" id="7681747">0x6d</span><span class="op" id="7681751">,</span>&nbsp;<span class="num" id="7681753">0x3a</span><span class="op" id="7681757">,</span>&nbsp;<span class="num" id="7681759">0x47</span><span class="op" id="7681763">,</span>&nbsp;<span class="num" id="7681765">0x7c</span><span class="op" id="7681769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7681773">0x28</span><span class="op" id="7681777">,</span>&nbsp;<span class="num" id="7681779">0xd2</span><span class="op" id="7681783">,</span>&nbsp;<span class="num" id="7681785">0x4b</span><span class="op" id="7681789">,</span>&nbsp;<span class="num" id="7681791">0xa1</span><span class="op" id="7681795">,</span>&nbsp;<span class="num" id="7681797">0xe3</span><span class="op" id="7681801">,</span>&nbsp;<span class="num" id="7681803">0x75</span><span class="op" id="7681807">,</span>&nbsp;<span class="num" id="7681809">0x6f</span><span class="op" id="7681813">,</span>&nbsp;<span class="num" id="7681815">0x79</span><span class="op" id="7681819">,</span>&nbsp;<span class="num" id="7681821">0x2d</span><span class="op" id="7681825">,</span>&nbsp;<span class="num" id="7681827">0xd1</span><span class="op" id="7681831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7681835">0xdc</span><span class="op" id="7681839">,</span>&nbsp;<span class="num" id="7681841">0xe8</span><span class="op" id="7681845">,</span>&nbsp;<span class="num" id="7681847">0xca</span><span class="op" id="7681851">,</span>&nbsp;<span class="num" id="7681853">0x94</span><span class="op" id="7681857">,</span>&nbsp;<span class="num" id="7681859">0x44</span><span class="op" id="7681863">,</span>&nbsp;<span class="num" id="7681865">0x0e</span><span class="op" id="7681869">,</span>&nbsp;<span class="num" id="7681871">0xcb</span><span class="op" id="7681875">,</span>&nbsp;<span class="num" id="7681877">0x52</span><span class="op" id="7681881">,</span>&nbsp;<span class="num" id="7681883">0x79</span><span class="op" id="7681887">,</span>&nbsp;<span class="num" id="7681889">0xec</span><span class="op" id="7681893">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7681897">0xd3</span><span class="op" id="7681901">,</span>&nbsp;<span class="num" id="7681903">0x18</span><span class="op" id="7681907">,</span>&nbsp;<span class="num" id="7681909">0x3a</span><span class="op" id="7681913">,</span>&nbsp;<span class="num" id="7681915">0x31</span><span class="op" id="7681919">,</span>&nbsp;<span class="num" id="7681921">0x1f</span><span class="op" id="7681925">,</span>&nbsp;<span class="num" id="7681927">0xc8</span><span class="op" id="7681931">,</span>&nbsp;<span class="num" id="7681933">0x96</span><span class="op" id="7681937">,</span>&nbsp;<span class="num" id="7681939">0xda</span><span class="op" id="7681943">,</span>&nbsp;<span class="num" id="7681945">0x1c</span><span class="op" id="7681949">,</span>&nbsp;<span class="num" id="7681951">0xb3</span><span class="op" id="7681955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7681959">0x93</span><span class="op" id="7681963">,</span>&nbsp;<span class="num" id="7681965">0x11</span><span class="op" id="7681969">,</span>&nbsp;<span class="num" id="7681971">0xaf</span><span class="op" id="7681975">,</span>&nbsp;<span class="num" id="7681977">0x37</span><span class="op" id="7681981">,</span>&nbsp;<span class="num" id="7681983">0xea</span><span class="op" id="7681987">,</span>&nbsp;<span class="num" id="7681989">0x4a</span><span class="op" id="7681993">,</span>&nbsp;<span class="num" id="7681995">0x75</span><span class="op" id="7681999">,</span>&nbsp;<span class="num" id="7682001">0xe2</span><span class="op" id="7682005">,</span>&nbsp;<span class="num" id="7682007">0x4b</span><span class="op" id="7682011">,</span>&nbsp;<span class="num" id="7682013">0xdb</span><span class="op" id="7682017">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7682021">0xfd</span><span class="op" id="7682025">,</span>&nbsp;<span class="num" id="7682027">0x5c</span><span class="op" id="7682031">,</span>&nbsp;<span class="num" id="7682033">0x1d</span><span class="op" id="7682037">,</span>&nbsp;<span class="num" id="7682039">0xa0</span><span class="op" id="7682043">,</span>&nbsp;<span class="num" id="7682045">0xde</span><span class="op" id="7682049">,</span>&nbsp;<span class="num" id="7682051">0x7c</span><span class="op" id="7682055">,</span>&nbsp;<span class="num" id="7682057">0xec</span><span class="op" id="7682061">,</span>&nbsp;<span class="num" id="7682063">0xdf</span><span class="op" id="7682067">,</span>&nbsp;<span class="num" id="7682069">0x1a</span><span class="op" id="7682073">,</span>&nbsp;<span class="num" id="7682075">0x89</span><span class="op" id="7682079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7682083">0x6f</span><span class="op" id="7682087">,</span>&nbsp;<span class="num" id="7682089">0x9d</span><span class="op" id="7682093">,</span>&nbsp;<span class="num" id="7682095">0x8b</span><span class="op" id="7682099">,</span>&nbsp;<span class="num" id="7682101">0xc8</span><span class="op" id="7682105">,</span>&nbsp;<span class="num" id="7682107">0x16</span><span class="op" id="7682111">,</span>&nbsp;<span class="num" id="7682113">0xd9</span><span class="op" id="7682117">,</span>&nbsp;<span class="num" id="7682119">0x7c</span><span class="op" id="7682123">,</span>&nbsp;<span class="num" id="7682125">0xd7</span><span class="op" id="7682129">,</span>&nbsp;<span class="num" id="7682131">0xa2</span><span class="op" id="7682135">,</span>&nbsp;<span class="num" id="7682137">0xc4</span><span class="op" id="7682141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7682145">0x3b</span><span class="op" id="7682149">,</span>&nbsp;<span class="num" id="7682151">0xad</span><span class="op" id="7682155">,</span>&nbsp;<span class="num" id="7682157">0x54</span><span class="op" id="7682161">,</span>&nbsp;<span class="num" id="7682163">0x6f</span><span class="op" id="7682167">,</span>&nbsp;<span class="num" id="7682169">0xbe</span><span class="op" id="7682173">,</span>&nbsp;<span class="num" id="7682175">0x8c</span><span class="op" id="7682179">,</span>&nbsp;<span class="num" id="7682181">0xfe</span><span class="op" id="7682185">,</span>&nbsp;<span class="num" id="7682187">0xbc</span><span class="op" id="7682191">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7682194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7682198">hash</span>&nbsp;<span class="op" id="7682203">:=</span>&nbsp;<span class="ident" id="7682206"><a href="/crypto/rsa/pss_test.go.html#7680268">sha1</a></span><span class="op" id="7682210">.</span><span class="ident" id="7682211">New</span><span class="op" id="7682214">(</span><span class="op" id="7682215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7682218"><a href="/crypto/rsa/pss_test.go.html#7682198">hash</a></span><span class="op" id="7682222">.</span><span class="ident" id="7682223">Write</span><span class="op" id="7682228">(</span><span class="ident" id="7682229"><a href="/crypto/rsa/pss_test.go.html#7680508">msg</a></span><span class="op" id="7682232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7682235">hashed</span>&nbsp;<span class="op" id="7682242">:=</span>&nbsp;<span class="ident" id="7682245"><a href="/crypto/rsa/pss_test.go.html#7682198">hash</a></span><span class="op" id="7682249">.</span><span class="ident" id="7682250">Sum</span><span class="op" id="7682253">(</span><span class="ident" id="7682254">nil</span><span class="op" id="7682257">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7682261">encoded</span><span class="op" id="7682268">,</span>&nbsp;<span class="ident" id="7682270">err</span>&nbsp;<span class="op" id="7682274">:=</span>&nbsp;<span class="ident" id="7682277"><a href="/crypto/rsa/pss.go.html#4118800">emsaPSSEncode</a></span><span class="op" id="7682290">(</span><span class="ident" id="7682291"><a href="/crypto/rsa/pss_test.go.html#7682235">hashed</a></span><span class="op" id="7682297">,</span>&nbsp;<span class="num" id="7682299">1023</span><span class="op" id="7682303">,</span>&nbsp;<span class="ident" id="7682305"><a href="/crypto/rsa/pss_test.go.html#7681235">salt</a></span><span class="op" id="7682309">,</span>&nbsp;<span class="ident" id="7682311"><a href="/crypto/rsa/pss_test.go.html#7680268">sha1</a></span><span class="op" id="7682315">.</span><span class="ident" id="7682316">New</span><span class="op" id="7682319">(</span><span class="op" id="7682320">)</span><span class="op" id="7682321">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7682324">if</span>&nbsp;<span class="ident" id="7682327"><a href="/crypto/rsa/pss_test.go.html#7682270">err</a></span>&nbsp;<span class="op" id="7682331">!=</span>&nbsp;<span class="ident" id="7682334">nil</span>&nbsp;<span class="op" id="7682338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7682342"><a href="/crypto/rsa/pss_test.go.html#7680388">t</a></span><span class="op" id="7682343">.</span><span class="ident" id="7682344">Errorf</span><span class="op" id="7682350">(</span><span class="string" id="7682351">&#34;Error&nbsp;from&nbsp;emsaPSSEncode:&nbsp;%s\n&#34;</span><span class="op" id="7682383">,</span>&nbsp;<span class="ident" id="7682385"><a href="/crypto/rsa/pss_test.go.html#7682270">err</a></span><span class="op" id="7682388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7682391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7682394">if</span>&nbsp;<span class="op" id="7682397">!</span><span class="ident" id="7682398"><a href="/crypto/rsa/pss_test.go.html#7680200">bytes</a></span><span class="op" id="7682403">.</span><span class="ident" id="7682404">Equal</span><span class="op" id="7682409">(</span><span class="ident" id="7682410"><a href="/crypto/rsa/pss_test.go.html#7682261">encoded</a></span><span class="op" id="7682417">,</span>&nbsp;<span class="ident" id="7682419"><a href="/crypto/rsa/pss_test.go.html#7681379">expected</a></span><span class="op" id="7682427">)</span>&nbsp;<span class="op" id="7682429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7682433"><a href="/crypto/rsa/pss_test.go.html#7680388">t</a></span><span class="op" id="7682434">.</span><span class="ident" id="7682435">Errorf</span><span class="op" id="7682441">(</span><span class="string" id="7682442">&#34;Bad&nbsp;encoding.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="7682473">,</span>&nbsp;<span class="ident" id="7682475"><a href="/crypto/rsa/pss_test.go.html#7682261">encoded</a></span><span class="op" id="7682482">,</span>&nbsp;<span class="ident" id="7682484"><a href="/crypto/rsa/pss_test.go.html#7681379">expected</a></span><span class="op" id="7682492">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7682495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7682499">if</span>&nbsp;<span class="ident" id="7682502"><a href="/crypto/rsa/pss_test.go.html#7682270">err</a></span>&nbsp;<span class="op" id="7682506">=</span>&nbsp;<span class="ident" id="7682508"><a href="/crypto/rsa/pss.go.html#4120700">emsaPSSVerify</a></span><span class="op" id="7682521">(</span><span class="ident" id="7682522"><a href="/crypto/rsa/pss_test.go.html#7682235">hashed</a></span><span class="op" id="7682528">,</span>&nbsp;<span class="ident" id="7682530"><a href="/crypto/rsa/pss_test.go.html#7682261">encoded</a></span><span class="op" id="7682537">,</span>&nbsp;<span class="num" id="7682539">1023</span><span class="op" id="7682543">,</span>&nbsp;<span class="builtinfunc" id="7682545">len</span><span class="op" id="7682548">(</span><span class="ident" id="7682549"><a href="/crypto/rsa/pss_test.go.html#7681235">salt</a></span><span class="op" id="7682553">)</span><span class="op" id="7682554">,</span>&nbsp;<span class="ident" id="7682556"><a href="/crypto/rsa/pss_test.go.html#7680268">sha1</a></span><span class="op" id="7682560">.</span><span class="ident" id="7682561">New</span><span class="op" id="7682564">(</span><span class="op" id="7682565">)</span><span class="op" id="7682566">)</span><span class="op" id="7682567">;</span>&nbsp;<span class="ident" id="7682569"><a href="/crypto/rsa/pss_test.go.html#7682270">err</a></span>&nbsp;<span class="op" id="7682573">!=</span>&nbsp;<span class="ident" id="7682576">nil</span>&nbsp;<span class="op" id="7682580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7682584"><a href="/crypto/rsa/pss_test.go.html#7680388">t</a></span><span class="op" id="7682585">.</span><span class="ident" id="7682586">Errorf</span><span class="op" id="7682592">(</span><span class="string" id="7682593">&#34;Bad&nbsp;verification:&nbsp;%s&#34;</span><span class="op" id="7682615">,</span>&nbsp;<span class="ident" id="7682617"><a href="/crypto/rsa/pss_test.go.html#7682270">err</a></span><span class="op" id="7682620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7682623">}</span><br>
<span class="lineno">75</span><span class="op" id="7682625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7682628">//&nbsp;TestPSSGolden&nbsp;tests&nbsp;all&nbsp;the&nbsp;test&nbsp;vectors&nbsp;in&nbsp;pss-vect.txt&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="7682693">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span><span class="keyword" id="7682757">func</span>&nbsp;<span class="ident" id="7682762">TestPSSGolden</span><span class="op" id="7682775">(</span><span class="ident" id="7682776">t</span>&nbsp;<span class="op" id="7682778">*</span><span class="ident" id="7682779"><a href="/crypto/rsa/pss_test.go.html#7680358">testing</a></span><span class="op" id="7682786">.</span><span class="ident" id="7682787">T</span><span class="op" id="7682788">)</span>&nbsp;<span class="op" id="7682790">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7682793">inFile</span><span class="op" id="7682799">,</span>&nbsp;<span class="ident" id="7682801">err</span>&nbsp;<span class="op" id="7682805">:=</span>&nbsp;<span class="ident" id="7682808"><a href="/crypto/rsa/pss_test.go.html#7680330">os</a></span><span class="op" id="7682810">.</span><span class="ident" id="7682811">Open</span><span class="op" id="7682815">(</span><span class="string" id="7682816">&#34;testdata/pss-vect.txt.bz2&#34;</span><span class="op" id="7682843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7682846">if</span>&nbsp;<span class="ident" id="7682849"><a href="/crypto/rsa/pss_test.go.html#7682801">err</a></span>&nbsp;<span class="op" id="7682853">!=</span>&nbsp;<span class="ident" id="7682856">nil</span>&nbsp;<span class="op" id="7682860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7682864"><a href="/crypto/rsa/pss_test.go.html#7682776">t</a></span><span class="op" id="7682865">.</span><span class="ident" id="7682866">Fatalf</span><span class="op" id="7682872">(</span><span class="string" id="7682873">&#34;Failed&nbsp;to&nbsp;open&nbsp;input&nbsp;file:&nbsp;%s&#34;</span><span class="op" id="7682904">,</span>&nbsp;<span class="ident" id="7682906"><a href="/crypto/rsa/pss_test.go.html#7682801">err</a></span><span class="op" id="7682909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7682912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7682915">defer</span>&nbsp;<span class="ident" id="7682921"><a href="/crypto/rsa/pss_test.go.html#7682793">inFile</a></span><span class="op" id="7682927">.</span><span class="ident" id="7682928">Close</span><span class="op" id="7682933">(</span><span class="op" id="7682934">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7682938">//&nbsp;The&nbsp;pss-vect.txt&nbsp;file&nbsp;contains&nbsp;RSA&nbsp;keys&nbsp;and&nbsp;then&nbsp;a&nbsp;series&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7683003">//&nbsp;signatures.&nbsp;A&nbsp;goroutine&nbsp;is&nbsp;used&nbsp;to&nbsp;preprocess&nbsp;the&nbsp;input&nbsp;by&nbsp;merging</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7683074">//&nbsp;lines,&nbsp;removing&nbsp;spaces&nbsp;in&nbsp;hex&nbsp;values&nbsp;and&nbsp;identifying&nbsp;the&nbsp;start&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7683144">//&nbsp;new&nbsp;keys&nbsp;and&nbsp;signature&nbsp;blocks.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7683179">const</span>&nbsp;<span class="ident" id="7683185">newKeyMarker</span>&nbsp;<span class="op" id="7683198">=</span>&nbsp;<span class="string" id="7683200">&#34;START&nbsp;NEW&nbsp;KEY&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7683217">const</span>&nbsp;<span class="ident" id="7683223">newSignatureMarker</span>&nbsp;<span class="op" id="7683242">=</span>&nbsp;<span class="string" id="7683244">&#34;START&nbsp;NEW&nbsp;SIGNATURE&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683268">values</span>&nbsp;<span class="op" id="7683275">:=</span>&nbsp;<span class="builtinfunc" id="7683278">make</span><span class="op" id="7683282">(</span><span class="keyword" id="7683283">chan</span>&nbsp;<span class="builtintype" id="7683288">string</span><span class="op" id="7683294">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7683298">go</span>&nbsp;<span class="keyword" id="7683301">func</span><span class="op" id="7683305">(</span><span class="op" id="7683306">)</span>&nbsp;<span class="op" id="7683308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7683312">defer</span>&nbsp;<span class="builtinfunc" id="7683318">close</span><span class="op" id="7683323">(</span><span class="ident" id="7683324"><a href="/crypto/rsa/pss_test.go.html#7683268">values</a></span><span class="op" id="7683330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683334">scanner</span>&nbsp;<span class="op" id="7683342">:=</span>&nbsp;<span class="ident" id="7683345"><a href="/crypto/rsa/pss_test.go.html#7680191">bufio</a></span><span class="op" id="7683350">.</span><span class="ident" id="7683351">NewScanner</span><span class="op" id="7683361">(</span><span class="ident" id="7683362"><a href="/crypto/rsa/pss_test.go.html#7680209">bzip2</a></span><span class="op" id="7683367">.</span><span class="ident" id="7683368">NewReader</span><span class="op" id="7683377">(</span><span class="ident" id="7683378"><a href="/crypto/rsa/pss_test.go.html#7682793">inFile</a></span><span class="op" id="7683384">)</span><span class="op" id="7683385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7683389">var</span>&nbsp;<span class="ident" id="7683393">partialValue</span>&nbsp;<span class="builtintype" id="7683406">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683415">lastWasValue</span>&nbsp;<span class="op" id="7683428">:=</span>&nbsp;<span class="builtintype" id="7683431">true</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7683439">for</span>&nbsp;<span class="ident" id="7683443"><a href="/crypto/rsa/pss_test.go.html#7683334">scanner</a></span><span class="op" id="7683450">.</span><span class="ident" id="7683451">Scan</span><span class="op" id="7683455">(</span><span class="op" id="7683456">)</span>&nbsp;<span class="op" id="7683458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683463">line</span>&nbsp;<span class="op" id="7683468">:=</span>&nbsp;<span class="ident" id="7683471"><a href="/crypto/rsa/pss_test.go.html#7683334">scanner</a></span><span class="op" id="7683478">.</span><span class="ident" id="7683479">Text</span><span class="op" id="7683483">(</span><span class="op" id="7683484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7683489">switch</span>&nbsp;<span class="op" id="7683496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7683501">case</span>&nbsp;<span class="builtinfunc" id="7683506">len</span><span class="op" id="7683509">(</span><span class="ident" id="7683510"><a href="/crypto/rsa/pss_test.go.html#7683463">line</a></span><span class="op" id="7683514">)</span>&nbsp;<span class="op" id="7683516">==</span>&nbsp;<span class="num" id="7683519">0</span><span class="op" id="7683520">:</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7683526">if</span>&nbsp;<span class="builtinfunc" id="7683529">len</span><span class="op" id="7683532">(</span><span class="ident" id="7683533"><a href="/crypto/rsa/pss_test.go.html#7683393">partialValue</a></span><span class="op" id="7683545">)</span>&nbsp;<span class="op" id="7683547">&gt;</span>&nbsp;<span class="num" id="7683549">0</span>&nbsp;<span class="op" id="7683551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683558"><a href="/crypto/rsa/pss_test.go.html#7683268">values</a></span>&nbsp;<span class="op" id="7683565">&lt;-</span>&nbsp;<span class="ident" id="7683568"><a href="/crypto/rsa/pss_test.go.html#7680347">strings</a></span><span class="op" id="7683575">.</span><span class="ident" id="7683576">Replace</span><span class="op" id="7683583">(</span><span class="ident" id="7683584"><a href="/crypto/rsa/pss_test.go.html#7683393">partialValue</a></span><span class="op" id="7683596">,</span>&nbsp;<span class="string" id="7683598">&#34;&nbsp;&#34;</span><span class="op" id="7683601">,</span>&nbsp;<span class="string" id="7683603">&#34;&#34;</span><span class="op" id="7683605">,</span>&nbsp;<span class="op" id="7683607">-</span><span class="num" id="7683608">1</span><span class="op" id="7683609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683616"><a href="/crypto/rsa/pss_test.go.html#7683393">partialValue</a></span>&nbsp;<span class="op" id="7683629">=</span>&nbsp;<span class="string" id="7683631">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683639"><a href="/crypto/rsa/pss_test.go.html#7683415">lastWasValue</a></span>&nbsp;<span class="op" id="7683652">=</span>&nbsp;<span class="builtintype" id="7683654">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7683663">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7683669">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7683681">case</span>&nbsp;<span class="ident" id="7683686"><a href="/crypto/rsa/pss_test.go.html#7680347">strings</a></span><span class="op" id="7683693">.</span><span class="ident" id="7683694">HasPrefix</span><span class="op" id="7683703">(</span><span class="ident" id="7683704"><a href="/crypto/rsa/pss_test.go.html#7683463">line</a></span><span class="op" id="7683708">,</span>&nbsp;<span class="string" id="7683710">&#34;#&nbsp;======&#34;</span><span class="op" id="7683720">)</span>&nbsp;<span class="op" id="7683722">&amp;&amp;</span>&nbsp;<span class="ident" id="7683725"><a href="/crypto/rsa/pss_test.go.html#7683415">lastWasValue</a></span><span class="op" id="7683737">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683743"><a href="/crypto/rsa/pss_test.go.html#7683268">values</a></span>&nbsp;<span class="op" id="7683750">&lt;-</span>&nbsp;<span class="ident" id="7683753"><a href="/crypto/rsa/pss_test.go.html#7683185">newKeyMarker</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683770"><a href="/crypto/rsa/pss_test.go.html#7683415">lastWasValue</a></span>&nbsp;<span class="op" id="7683783">=</span>&nbsp;<span class="builtintype" id="7683785">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7683794">case</span>&nbsp;<span class="ident" id="7683799"><a href="/crypto/rsa/pss_test.go.html#7680347">strings</a></span><span class="op" id="7683806">.</span><span class="ident" id="7683807">HasPrefix</span><span class="op" id="7683816">(</span><span class="ident" id="7683817"><a href="/crypto/rsa/pss_test.go.html#7683463">line</a></span><span class="op" id="7683821">,</span>&nbsp;<span class="string" id="7683823">&#34;#&nbsp;------&#34;</span><span class="op" id="7683833">)</span>&nbsp;<span class="op" id="7683835">&amp;&amp;</span>&nbsp;<span class="ident" id="7683838"><a href="/crypto/rsa/pss_test.go.html#7683415">lastWasValue</a></span><span class="op" id="7683850">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683856"><a href="/crypto/rsa/pss_test.go.html#7683268">values</a></span>&nbsp;<span class="op" id="7683863">&lt;-</span>&nbsp;<span class="ident" id="7683866"><a href="/crypto/rsa/pss_test.go.html#7683223">newSignatureMarker</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683889"><a href="/crypto/rsa/pss_test.go.html#7683415">lastWasValue</a></span>&nbsp;<span class="op" id="7683902">=</span>&nbsp;<span class="builtintype" id="7683904">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7683913">case</span>&nbsp;<span class="ident" id="7683918"><a href="/crypto/rsa/pss_test.go.html#7680347">strings</a></span><span class="op" id="7683925">.</span><span class="ident" id="7683926">HasPrefix</span><span class="op" id="7683935">(</span><span class="ident" id="7683936"><a href="/crypto/rsa/pss_test.go.html#7683463">line</a></span><span class="op" id="7683940">,</span>&nbsp;<span class="string" id="7683942">&#34;#&#34;</span><span class="op" id="7683945">)</span><span class="op" id="7683946">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7683952">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7683964">default</span><span class="op" id="7683971">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7683977"><a href="/crypto/rsa/pss_test.go.html#7683393">partialValue</a></span>&nbsp;<span class="op" id="7683990">+=</span>&nbsp;<span class="ident" id="7683993"><a href="/crypto/rsa/pss_test.go.html#7683463">line</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7684001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7684005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7684009">if</span>&nbsp;<span class="ident" id="7684012">err</span>&nbsp;<span class="op" id="7684016">:=</span>&nbsp;<span class="ident" id="7684019"><a href="/crypto/rsa/pss_test.go.html#7683334">scanner</a></span><span class="op" id="7684026">.</span><span class="ident" id="7684027">Err</span><span class="op" id="7684030">(</span><span class="op" id="7684031">)</span><span class="op" id="7684032">;</span>&nbsp;<span class="ident" id="7684034"><a href="/crypto/rsa/pss_test.go.html#7684012">err</a></span>&nbsp;<span class="op" id="7684038">!=</span>&nbsp;<span class="ident" id="7684041">nil</span>&nbsp;<span class="op" id="7684045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7684050">panic</span><span class="op" id="7684055">(</span><span class="ident" id="7684056"><a href="/crypto/rsa/pss_test.go.html#7684012">err</a></span><span class="op" id="7684059">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7684063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7684066">}</span><span class="op" id="7684067">(</span><span class="op" id="7684068">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7684072">var</span>&nbsp;<span class="ident" id="7684076">key</span>&nbsp;<span class="op" id="7684080">*</span><span class="ident" id="7684081"><a href="/crypto/rsa/rsa.go.html#4127377">PublicKey</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7684092">var</span>&nbsp;<span class="ident" id="7684096">hashed</span>&nbsp;<span class="op" id="7684103">[</span><span class="op" id="7684104">]</span><span class="builtintype" id="7684105">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684111">hash</span>&nbsp;<span class="op" id="7684116">:=</span>&nbsp;<span class="ident" id="7684119"><a href="/crypto/rsa/pss_test.go.html#7680227">crypto</a></span><span class="op" id="7684125">.</span><span class="ident" id="7684126">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684132">h</span>&nbsp;<span class="op" id="7684134">:=</span>&nbsp;<span class="ident" id="7684137"><a href="/crypto/rsa/pss_test.go.html#7684111">hash</a></span><span class="op" id="7684141">.</span><span class="ident" id="7684142">New</span><span class="op" id="7684145">(</span><span class="op" id="7684146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684149">opts</span>&nbsp;<span class="op" id="7684154">:=</span>&nbsp;<span class="op" id="7684157">&amp;</span><span class="ident" id="7684158"><a href="/crypto/rsa/pss.go.html#4124433">PSSOptions</a></span><span class="op" id="7684168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684172">SaltLength</span><span class="op" id="7684182">:</span>&nbsp;<span class="ident" id="7684184"><a href="/crypto/rsa/pss.go.html#4124322">PSSSaltLengthEqualsHash</a></span><span class="op" id="7684207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7684210">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7684214">for</span>&nbsp;<span class="ident" id="7684218">marker</span>&nbsp;<span class="op" id="7684225">:=</span>&nbsp;<span class="keyword" id="7684228">range</span>&nbsp;<span class="ident" id="7684234"><a href="/crypto/rsa/pss_test.go.html#7683268">values</a></span>&nbsp;<span class="op" id="7684241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7684245">switch</span>&nbsp;<span class="ident" id="7684252"><a href="/crypto/rsa/pss_test.go.html#7684218">marker</a></span>&nbsp;<span class="op" id="7684259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7684263">case</span>&nbsp;<span class="ident" id="7684268"><a href="/crypto/rsa/pss_test.go.html#7683185">newKeyMarker</a></span><span class="op" id="7684280">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684285"><a href="/crypto/rsa/pss_test.go.html#7684076">key</a></span>&nbsp;<span class="op" id="7684289">=</span>&nbsp;<span class="builtinfunc" id="7684291">new</span><span class="op" id="7684294">(</span><span class="ident" id="7684295"><a href="/crypto/rsa/rsa.go.html#4127377">PublicKey</a></span><span class="op" id="7684304">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684309">nHex</span><span class="op" id="7684313">,</span>&nbsp;<span class="ident" id="7684315">ok</span>&nbsp;<span class="op" id="7684318">:=</span>&nbsp;<span class="op" id="7684321">&lt;-</span><span class="ident" id="7684323"><a href="/crypto/rsa/pss_test.go.html#7683268">values</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7684333">if</span>&nbsp;<span class="op" id="7684336">!</span><span class="ident" id="7684337"><a href="/crypto/rsa/pss_test.go.html#7684315">ok</a></span>&nbsp;<span class="op" id="7684340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7684346">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7684358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684363"><a href="/crypto/rsa/pss_test.go.html#7684076">key</a></span><span class="op" id="7684366">.</span><span class="ident" id="7684367">N</span>&nbsp;<span class="op" id="7684369">=</span>&nbsp;<span class="ident" id="7684371"><a href="/crypto/rsa/pss_test.go.html#7686763">bigFromHex</a></span><span class="op" id="7684381">(</span><span class="ident" id="7684382"><a href="/crypto/rsa/pss_test.go.html#7684309">nHex</a></span><span class="op" id="7684386">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684391"><a href="/crypto/rsa/pss_test.go.html#7684076">key</a></span><span class="op" id="7684394">.</span><span class="ident" id="7684395">E</span>&nbsp;<span class="op" id="7684397">=</span>&nbsp;<span class="ident" id="7684399"><a href="/crypto/rsa/pss_test.go.html#7686897">intFromHex</a></span><span class="op" id="7684409">(</span><span class="op" id="7684410">&lt;-</span><span class="ident" id="7684412"><a href="/crypto/rsa/pss_test.go.html#7683268">values</a></span><span class="op" id="7684418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7684423">//&nbsp;We&nbsp;don&#39;t&nbsp;care&nbsp;for&nbsp;d,&nbsp;p,&nbsp;q,&nbsp;dP,&nbsp;dQ&nbsp;or&nbsp;qInv.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7684472">for</span>&nbsp;<span class="ident" id="7684476">i</span>&nbsp;<span class="op" id="7684478">:=</span>&nbsp;<span class="num" id="7684481">0</span><span class="op" id="7684482">;</span>&nbsp;<span class="ident" id="7684484"><a href="/crypto/rsa/pss_test.go.html#7684476">i</a></span>&nbsp;<span class="op" id="7684486">&lt;</span>&nbsp;<span class="num" id="7684488">6</span><span class="op" id="7684489">;</span>&nbsp;<span class="ident" id="7684491"><a href="/crypto/rsa/pss_test.go.html#7684476">i</a></span><span class="op" id="7684492">++</span>&nbsp;<span class="op" id="7684495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7684501">&lt;-</span><span class="ident" id="7684503"><a href="/crypto/rsa/pss_test.go.html#7683268">values</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7684513">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7684517">case</span>&nbsp;<span class="ident" id="7684522"><a href="/crypto/rsa/pss_test.go.html#7683223">newSignatureMarker</a></span><span class="op" id="7684540">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684545">msg</span>&nbsp;<span class="op" id="7684549">:=</span>&nbsp;<span class="ident" id="7684552"><a href="/crypto/rsa/pss_test.go.html#7687023">fromHex</a></span><span class="op" id="7684559">(</span><span class="op" id="7684560">&lt;-</span><span class="ident" id="7684562"><a href="/crypto/rsa/pss_test.go.html#7683268">values</a></span><span class="op" id="7684568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7684573">&lt;-</span><span class="ident" id="7684575"><a href="/crypto/rsa/pss_test.go.html#7683268">values</a></span>&nbsp;<span class="comment" id="7684582">//&nbsp;skip&nbsp;salt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684598">sig</span>&nbsp;<span class="op" id="7684602">:=</span>&nbsp;<span class="ident" id="7684605"><a href="/crypto/rsa/pss_test.go.html#7687023">fromHex</a></span><span class="op" id="7684612">(</span><span class="op" id="7684613">&lt;-</span><span class="ident" id="7684615"><a href="/crypto/rsa/pss_test.go.html#7683268">values</a></span><span class="op" id="7684621">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684627"><a href="/crypto/rsa/pss_test.go.html#7684132">h</a></span><span class="op" id="7684628">.</span><span class="ident" id="7684629">Reset</span><span class="op" id="7684634">(</span><span class="op" id="7684635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684640"><a href="/crypto/rsa/pss_test.go.html#7684132">h</a></span><span class="op" id="7684641">.</span><span class="ident" id="7684642">Write</span><span class="op" id="7684647">(</span><span class="ident" id="7684648"><a href="/crypto/rsa/pss_test.go.html#7684545">msg</a></span><span class="op" id="7684651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684656"><a href="/crypto/rsa/pss_test.go.html#7684096">hashed</a></span>&nbsp;<span class="op" id="7684663">=</span>&nbsp;<span class="ident" id="7684665"><a href="/crypto/rsa/pss_test.go.html#7684132">h</a></span><span class="op" id="7684666">.</span><span class="ident" id="7684667">Sum</span><span class="op" id="7684670">(</span><span class="ident" id="7684671"><a href="/crypto/rsa/pss_test.go.html#7684096">hashed</a></span><span class="op" id="7684677">[</span><span class="op" id="7684678">:</span><span class="num" id="7684679">0</span><span class="op" id="7684680">]</span><span class="op" id="7684681">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7684687">if</span>&nbsp;<span class="ident" id="7684690">err</span>&nbsp;<span class="op" id="7684694">:=</span>&nbsp;<span class="ident" id="7684697"><a href="/crypto/rsa/pss.go.html#4126157">VerifyPSS</a></span><span class="op" id="7684706">(</span><span class="ident" id="7684707"><a href="/crypto/rsa/pss_test.go.html#7684076">key</a></span><span class="op" id="7684710">,</span>&nbsp;<span class="ident" id="7684712"><a href="/crypto/rsa/pss_test.go.html#7684111">hash</a></span><span class="op" id="7684716">,</span>&nbsp;<span class="ident" id="7684718"><a href="/crypto/rsa/pss_test.go.html#7684096">hashed</a></span><span class="op" id="7684724">,</span>&nbsp;<span class="ident" id="7684726"><a href="/crypto/rsa/pss_test.go.html#7684598">sig</a></span><span class="op" id="7684729">,</span>&nbsp;<span class="ident" id="7684731"><a href="/crypto/rsa/pss_test.go.html#7684149">opts</a></span><span class="op" id="7684735">)</span><span class="op" id="7684736">;</span>&nbsp;<span class="ident" id="7684738"><a href="/crypto/rsa/pss_test.go.html#7684690">err</a></span>&nbsp;<span class="op" id="7684742">!=</span>&nbsp;<span class="ident" id="7684745">nil</span>&nbsp;<span class="op" id="7684749">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684755"><a href="/crypto/rsa/pss_test.go.html#7682776">t</a></span><span class="op" id="7684756">.</span><span class="ident" id="7684757">Error</span><span class="op" id="7684762">(</span><span class="ident" id="7684763"><a href="/crypto/rsa/pss_test.go.html#7684690">err</a></span><span class="op" id="7684766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7684771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7684775">default</span><span class="op" id="7684782">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7684787"><a href="/crypto/rsa/pss_test.go.html#7682776">t</a></span><span class="op" id="7684788">.</span><span class="ident" id="7684789">Fatalf</span><span class="op" id="7684795">(</span><span class="string" id="7684796">&#34;unknown&nbsp;marker:&nbsp;&#34;</span>&nbsp;<span class="op" id="7684815">+</span>&nbsp;<span class="ident" id="7684817"><a href="/crypto/rsa/pss_test.go.html#7684218">marker</a></span><span class="op" id="7684823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7684827">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7684830">}</span><br>
<span class="lineno"></span><span class="op" id="7684832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7684835">//&nbsp;TestPSSOpenSSL&nbsp;ensures&nbsp;that&nbsp;we&nbsp;can&nbsp;verify&nbsp;a&nbsp;PSS&nbsp;signature&nbsp;from&nbsp;OpenSSL&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="7684914">//&nbsp;the&nbsp;default&nbsp;options.&nbsp;OpenSSL&nbsp;sets&nbsp;the&nbsp;salt&nbsp;length&nbsp;to&nbsp;be&nbsp;maximal.</span><br>
<span class="lineno">170</span><span class="keyword" id="7684982">func</span>&nbsp;<span class="ident" id="7684987">TestPSSOpenSSL</span><span class="op" id="7685001">(</span><span class="ident" id="7685002">t</span>&nbsp;<span class="op" id="7685004">*</span><span class="ident" id="7685005"><a href="/crypto/rsa/pss_test.go.html#7680358">testing</a></span><span class="op" id="7685012">.</span><span class="ident" id="7685013">T</span><span class="op" id="7685014">)</span>&nbsp;<span class="op" id="7685016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7685019">hash</span>&nbsp;<span class="op" id="7685024">:=</span>&nbsp;<span class="ident" id="7685027"><a href="/crypto/rsa/pss_test.go.html#7680227">crypto</a></span><span class="op" id="7685033">.</span><span class="ident" id="7685034">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7685042">h</span>&nbsp;<span class="op" id="7685044">:=</span>&nbsp;<span class="ident" id="7685047"><a href="/crypto/rsa/pss_test.go.html#7685019">hash</a></span><span class="op" id="7685051">.</span><span class="ident" id="7685052">New</span><span class="op" id="7685055">(</span><span class="op" id="7685056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7685059"><a href="/crypto/rsa/pss_test.go.html#7685042">h</a></span><span class="op" id="7685060">.</span><span class="ident" id="7685061">Write</span><span class="op" id="7685066">(</span><span class="op" id="7685067">[</span><span class="op" id="7685068">]</span><span class="builtintype" id="7685069">byte</span><span class="op" id="7685073">(</span><span class="string" id="7685074">&#34;testing&#34;</span><span class="op" id="7685083">)</span><span class="op" id="7685084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7685087">hashed</span>&nbsp;<span class="op" id="7685094">:=</span>&nbsp;<span class="ident" id="7685097"><a href="/crypto/rsa/pss_test.go.html#7685042">h</a></span><span class="op" id="7685098">.</span><span class="ident" id="7685099">Sum</span><span class="op" id="7685102">(</span><span class="ident" id="7685103">nil</span><span class="op" id="7685106">)</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7685110">//&nbsp;Generated&nbsp;with&nbsp;`echo&nbsp;-n&nbsp;testing&nbsp;|&nbsp;openssl&nbsp;dgst&nbsp;-sign&nbsp;key.pem&nbsp;-sigopt&nbsp;rsa_padding_mode:pss&nbsp;-sha256&nbsp;&gt;&nbsp;sig`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7685219">sig</span>&nbsp;<span class="op" id="7685223">:=</span>&nbsp;<span class="op" id="7685226">[</span><span class="op" id="7685227">]</span><span class="builtintype" id="7685228">byte</span><span class="op" id="7685232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7685236">0x95</span><span class="op" id="7685240">,</span>&nbsp;<span class="num" id="7685242">0x59</span><span class="op" id="7685246">,</span>&nbsp;<span class="num" id="7685248">0x6f</span><span class="op" id="7685252">,</span>&nbsp;<span class="num" id="7685254">0xd3</span><span class="op" id="7685258">,</span>&nbsp;<span class="num" id="7685260">0x10</span><span class="op" id="7685264">,</span>&nbsp;<span class="num" id="7685266">0xa2</span><span class="op" id="7685270">,</span>&nbsp;<span class="num" id="7685272">0xe7</span><span class="op" id="7685276">,</span>&nbsp;<span class="num" id="7685278">0xa2</span><span class="op" id="7685282">,</span>&nbsp;<span class="num" id="7685284">0x92</span><span class="op" id="7685288">,</span>&nbsp;<span class="num" id="7685290">0x9d</span><span class="op" id="7685294">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7685298">0x4a</span><span class="op" id="7685302">,</span>&nbsp;<span class="num" id="7685304">0x07</span><span class="op" id="7685308">,</span>&nbsp;<span class="num" id="7685310">0x2e</span><span class="op" id="7685314">,</span>&nbsp;<span class="num" id="7685316">0x2b</span><span class="op" id="7685320">,</span>&nbsp;<span class="num" id="7685322">0x27</span><span class="op" id="7685326">,</span>&nbsp;<span class="num" id="7685328">0xcc</span><span class="op" id="7685332">,</span>&nbsp;<span class="num" id="7685334">0x06</span><span class="op" id="7685338">,</span>&nbsp;<span class="num" id="7685340">0xc2</span><span class="op" id="7685344">,</span>&nbsp;<span class="num" id="7685346">0x87</span><span class="op" id="7685350">,</span>&nbsp;<span class="num" id="7685352">0x2c</span><span class="op" id="7685356">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7685360">0x52</span><span class="op" id="7685364">,</span>&nbsp;<span class="num" id="7685366">0xf0</span><span class="op" id="7685370">,</span>&nbsp;<span class="num" id="7685372">0x4a</span><span class="op" id="7685376">,</span>&nbsp;<span class="num" id="7685378">0xcc</span><span class="op" id="7685382">,</span>&nbsp;<span class="num" id="7685384">0x05</span><span class="op" id="7685388">,</span>&nbsp;<span class="num" id="7685390">0x94</span><span class="op" id="7685394">,</span>&nbsp;<span class="num" id="7685396">0xf2</span><span class="op" id="7685400">,</span>&nbsp;<span class="num" id="7685402">0xc3</span><span class="op" id="7685406">,</span>&nbsp;<span class="num" id="7685408">0x2e</span><span class="op" id="7685412">,</span>&nbsp;<span class="num" id="7685414">0x20</span><span class="op" id="7685418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7685422">0xd7</span><span class="op" id="7685426">,</span>&nbsp;<span class="num" id="7685428">0x3e</span><span class="op" id="7685432">,</span>&nbsp;<span class="num" id="7685434">0x66</span><span class="op" id="7685438">,</span>&nbsp;<span class="num" id="7685440">0x62</span><span class="op" id="7685444">,</span>&nbsp;<span class="num" id="7685446">0xb5</span><span class="op" id="7685450">,</span>&nbsp;<span class="num" id="7685452">0x95</span><span class="op" id="7685456">,</span>&nbsp;<span class="num" id="7685458">0x2b</span><span class="op" id="7685462">,</span>&nbsp;<span class="num" id="7685464">0xa3</span><span class="op" id="7685468">,</span>&nbsp;<span class="num" id="7685470">0x93</span><span class="op" id="7685474">,</span>&nbsp;<span class="num" id="7685476">0x9a</span><span class="op" id="7685480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7685484">0x66</span><span class="op" id="7685488">,</span>&nbsp;<span class="num" id="7685490">0x64</span><span class="op" id="7685494">,</span>&nbsp;<span class="num" id="7685496">0x25</span><span class="op" id="7685500">,</span>&nbsp;<span class="num" id="7685502">0xe0</span><span class="op" id="7685506">,</span>&nbsp;<span class="num" id="7685508">0x74</span><span class="op" id="7685512">,</span>&nbsp;<span class="num" id="7685514">0x66</span><span class="op" id="7685518">,</span>&nbsp;<span class="num" id="7685520">0x8c</span><span class="op" id="7685524">,</span>&nbsp;<span class="num" id="7685526">0x3e</span><span class="op" id="7685530">,</span>&nbsp;<span class="num" id="7685532">0x92</span><span class="op" id="7685536">,</span>&nbsp;<span class="num" id="7685538">0xeb</span><span class="op" id="7685542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7685546">0xc6</span><span class="op" id="7685550">,</span>&nbsp;<span class="num" id="7685552">0xe6</span><span class="op" id="7685556">,</span>&nbsp;<span class="num" id="7685558">0xc0</span><span class="op" id="7685562">,</span>&nbsp;<span class="num" id="7685564">0x44</span><span class="op" id="7685568">,</span>&nbsp;<span class="num" id="7685570">0xf3</span><span class="op" id="7685574">,</span>&nbsp;<span class="num" id="7685576">0xb4</span><span class="op" id="7685580">,</span>&nbsp;<span class="num" id="7685582">0xb4</span><span class="op" id="7685586">,</span>&nbsp;<span class="num" id="7685588">0x2e</span><span class="op" id="7685592">,</span>&nbsp;<span class="num" id="7685594">0x8c</span><span class="op" id="7685598">,</span>&nbsp;<span class="num" id="7685600">0x66</span><span class="op" id="7685604">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7685608">0x0a</span><span class="op" id="7685612">,</span>&nbsp;<span class="num" id="7685614">0x37</span><span class="op" id="7685618">,</span>&nbsp;<span class="num" id="7685620">0x9c</span><span class="op" id="7685624">,</span>&nbsp;<span class="num" id="7685626">0x69</span><span class="op" id="7685630">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7685633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7685637">if</span>&nbsp;<span class="ident" id="7685640">err</span>&nbsp;<span class="op" id="7685644">:=</span>&nbsp;<span class="ident" id="7685647"><a href="/crypto/rsa/pss.go.html#4126157">VerifyPSS</a></span><span class="op" id="7685656">(</span><span class="op" id="7685657">&amp;</span><span class="ident" id="7685658"><a href="/crypto/rsa/pkcs1v15_test.go.html#7679373">rsaPrivateKey</a></span><span class="op" id="7685671">.</span><span class="ident" id="7685672">PublicKey</span><span class="op" id="7685681">,</span>&nbsp;<span class="ident" id="7685683"><a href="/crypto/rsa/pss_test.go.html#7685019">hash</a></span><span class="op" id="7685687">,</span>&nbsp;<span class="ident" id="7685689"><a href="/crypto/rsa/pss_test.go.html#7685087">hashed</a></span><span class="op" id="7685695">,</span>&nbsp;<span class="ident" id="7685697"><a href="/crypto/rsa/pss_test.go.html#7685219">sig</a></span><span class="op" id="7685700">,</span>&nbsp;<span class="ident" id="7685702">nil</span><span class="op" id="7685705">)</span><span class="op" id="7685706">;</span>&nbsp;<span class="ident" id="7685708"><a href="/crypto/rsa/pss_test.go.html#7685640">err</a></span>&nbsp;<span class="op" id="7685712">!=</span>&nbsp;<span class="ident" id="7685715">nil</span>&nbsp;<span class="op" id="7685719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7685723"><a href="/crypto/rsa/pss_test.go.html#7685002">t</a></span><span class="op" id="7685724">.</span><span class="ident" id="7685725">Error</span><span class="op" id="7685730">(</span><span class="ident" id="7685731"><a href="/crypto/rsa/pss_test.go.html#7685640">err</a></span><span class="op" id="7685734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7685737">}</span><br>
<span class="lineno">190</span><span class="op" id="7685739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7685742">func</span>&nbsp;<span class="ident" id="7685747">TestPSSSigning</span><span class="op" id="7685761">(</span><span class="ident" id="7685762">t</span>&nbsp;<span class="op" id="7685764">*</span><span class="ident" id="7685765"><a href="/crypto/rsa/pss_test.go.html#7680358">testing</a></span><span class="op" id="7685772">.</span><span class="ident" id="7685773">T</span><span class="op" id="7685774">)</span>&nbsp;<span class="op" id="7685776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7685779">var</span>&nbsp;<span class="ident" id="7685783">saltLengthCombinations</span>&nbsp;<span class="op" id="7685806">=</span>&nbsp;<span class="op" id="7685808">[</span><span class="op" id="7685809">]</span><span class="keyword" id="7685810">struct</span>&nbsp;<span class="op" id="7685817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7685821">signSaltLength</span><span class="op" id="7685835">,</span>&nbsp;<span class="ident" id="7685837">verifySaltLength</span>&nbsp;<span class="builtintype" id="7685854">int</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7685860">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7685893">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7685899">}</span><span class="op" id="7685900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7685904">{</span><span class="ident" id="7685905"><a href="/crypto/rsa/pss.go.html#4124189">PSSSaltLengthAuto</a></span><span class="op" id="7685922">,</span>&nbsp;<span class="ident" id="7685924"><a href="/crypto/rsa/pss.go.html#4124189">PSSSaltLengthAuto</a></span><span class="op" id="7685941">,</span>&nbsp;<span class="builtintype" id="7685943">true</span><span class="op" id="7685947">}</span><span class="op" id="7685948">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7685952">{</span><span class="ident" id="7685953"><a href="/crypto/rsa/pss.go.html#4124322">PSSSaltLengthEqualsHash</a></span><span class="op" id="7685976">,</span>&nbsp;<span class="ident" id="7685978"><a href="/crypto/rsa/pss.go.html#4124189">PSSSaltLengthAuto</a></span><span class="op" id="7685995">,</span>&nbsp;<span class="builtintype" id="7685997">true</span><span class="op" id="7686001">}</span><span class="op" id="7686002">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7686006">{</span><span class="ident" id="7686007"><a href="/crypto/rsa/pss.go.html#4124322">PSSSaltLengthEqualsHash</a></span><span class="op" id="7686030">,</span>&nbsp;<span class="ident" id="7686032"><a href="/crypto/rsa/pss.go.html#4124322">PSSSaltLengthEqualsHash</a></span><span class="op" id="7686055">,</span>&nbsp;<span class="builtintype" id="7686057">true</span><span class="op" id="7686061">}</span><span class="op" id="7686062">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7686066">{</span><span class="ident" id="7686067"><a href="/crypto/rsa/pss.go.html#4124322">PSSSaltLengthEqualsHash</a></span><span class="op" id="7686090">,</span>&nbsp;<span class="num" id="7686092">8</span><span class="op" id="7686093">,</span>&nbsp;<span class="builtintype" id="7686095">false</span><span class="op" id="7686100">}</span><span class="op" id="7686101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7686105">{</span><span class="ident" id="7686106"><a href="/crypto/rsa/pss.go.html#4124189">PSSSaltLengthAuto</a></span><span class="op" id="7686123">,</span>&nbsp;<span class="ident" id="7686125"><a href="/crypto/rsa/pss.go.html#4124322">PSSSaltLengthEqualsHash</a></span><span class="op" id="7686148">,</span>&nbsp;<span class="builtintype" id="7686150">false</span><span class="op" id="7686155">}</span><span class="op" id="7686156">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7686160">{</span><span class="num" id="7686161">8</span><span class="op" id="7686162">,</span>&nbsp;<span class="num" id="7686164">8</span><span class="op" id="7686165">,</span>&nbsp;<span class="builtintype" id="7686167">true</span><span class="op" id="7686171">}</span><span class="op" id="7686172">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7686175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7686179">hash</span>&nbsp;<span class="op" id="7686184">:=</span>&nbsp;<span class="ident" id="7686187"><a href="/crypto/rsa/pss_test.go.html#7680227">crypto</a></span><span class="op" id="7686193">.</span><span class="ident" id="7686194">MD5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7686199">h</span>&nbsp;<span class="op" id="7686201">:=</span>&nbsp;<span class="ident" id="7686204"><a href="/crypto/rsa/pss_test.go.html#7686179">hash</a></span><span class="op" id="7686208">.</span><span class="ident" id="7686209">New</span><span class="op" id="7686212">(</span><span class="op" id="7686213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7686216"><a href="/crypto/rsa/pss_test.go.html#7686199">h</a></span><span class="op" id="7686217">.</span><span class="ident" id="7686218">Write</span><span class="op" id="7686223">(</span><span class="op" id="7686224">[</span><span class="op" id="7686225">]</span><span class="builtintype" id="7686226">byte</span><span class="op" id="7686230">(</span><span class="string" id="7686231">&#34;testing&#34;</span><span class="op" id="7686240">)</span><span class="op" id="7686241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7686244">hashed</span>&nbsp;<span class="op" id="7686251">:=</span>&nbsp;<span class="ident" id="7686254"><a href="/crypto/rsa/pss_test.go.html#7686199">h</a></span><span class="op" id="7686255">.</span><span class="ident" id="7686256">Sum</span><span class="op" id="7686259">(</span><span class="ident" id="7686260">nil</span><span class="op" id="7686263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7686266">var</span>&nbsp;<span class="ident" id="7686270">opts</span>&nbsp;<span class="ident" id="7686275"><a href="/crypto/rsa/pss.go.html#4124433">PSSOptions</a></span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7686288">for</span>&nbsp;<span class="ident" id="7686292">i</span><span class="op" id="7686293">,</span>&nbsp;<span class="ident" id="7686295">test</span>&nbsp;<span class="op" id="7686300">:=</span>&nbsp;<span class="keyword" id="7686303">range</span>&nbsp;<span class="ident" id="7686309"><a href="/crypto/rsa/pss_test.go.html#7685783">saltLengthCombinations</a></span>&nbsp;<span class="op" id="7686332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7686336"><a href="/crypto/rsa/pss_test.go.html#7686270">opts</a></span><span class="op" id="7686340">.</span><span class="ident" id="7686341">SaltLength</span>&nbsp;<span class="op" id="7686352">=</span>&nbsp;<span class="ident" id="7686354"><a href="/crypto/rsa/pss_test.go.html#7686295">test</a></span><span class="op" id="7686358">.</span><span class="ident" id="7686359">signSaltLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7686376">sig</span><span class="op" id="7686379">,</span>&nbsp;<span class="ident" id="7686381">err</span>&nbsp;<span class="op" id="7686385">:=</span>&nbsp;<span class="ident" id="7686388"><a href="/crypto/rsa/pss.go.html#4125353">SignPSS</a></span><span class="op" id="7686395">(</span><span class="ident" id="7686396"><a href="/crypto/rsa/pss_test.go.html#7680253">rand</a></span><span class="op" id="7686400">.</span><span class="ident" id="7686401">Reader</span><span class="op" id="7686407">,</span>&nbsp;<span class="ident" id="7686409"><a href="/crypto/rsa/pkcs1v15_test.go.html#7679373">rsaPrivateKey</a></span><span class="op" id="7686422">,</span>&nbsp;<span class="ident" id="7686424"><a href="/crypto/rsa/pss_test.go.html#7686179">hash</a></span><span class="op" id="7686428">,</span>&nbsp;<span class="ident" id="7686430"><a href="/crypto/rsa/pss_test.go.html#7686244">hashed</a></span><span class="op" id="7686436">,</span>&nbsp;<span class="op" id="7686438">&amp;</span><span class="ident" id="7686439"><a href="/crypto/rsa/pss_test.go.html#7686270">opts</a></span><span class="op" id="7686443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7686447">if</span>&nbsp;<span class="ident" id="7686450"><a href="/crypto/rsa/pss_test.go.html#7686381">err</a></span>&nbsp;<span class="op" id="7686454">!=</span>&nbsp;<span class="ident" id="7686457">nil</span>&nbsp;<span class="op" id="7686461">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7686466"><a href="/crypto/rsa/pss_test.go.html#7685762">t</a></span><span class="op" id="7686467">.</span><span class="ident" id="7686468">Errorf</span><span class="op" id="7686474">(</span><span class="string" id="7686475">&#34;#%d:&nbsp;error&nbsp;while&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="7686505">,</span>&nbsp;<span class="ident" id="7686507"><a href="/crypto/rsa/pss_test.go.html#7686292">i</a></span><span class="op" id="7686508">,</span>&nbsp;<span class="ident" id="7686510"><a href="/crypto/rsa/pss_test.go.html#7686381">err</a></span><span class="op" id="7686513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7686518">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7686529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7686534"><a href="/crypto/rsa/pss_test.go.html#7686270">opts</a></span><span class="op" id="7686538">.</span><span class="ident" id="7686539">SaltLength</span>&nbsp;<span class="op" id="7686550">=</span>&nbsp;<span class="ident" id="7686552"><a href="/crypto/rsa/pss_test.go.html#7686295">test</a></span><span class="op" id="7686556">.</span><span class="ident" id="7686557">verifySaltLength</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7686576"><a href="/crypto/rsa/pss_test.go.html#7686381">err</a></span>&nbsp;<span class="op" id="7686580">=</span>&nbsp;<span class="ident" id="7686582"><a href="/crypto/rsa/pss.go.html#4126157">VerifyPSS</a></span><span class="op" id="7686591">(</span><span class="op" id="7686592">&amp;</span><span class="ident" id="7686593"><a href="/crypto/rsa/pkcs1v15_test.go.html#7679373">rsaPrivateKey</a></span><span class="op" id="7686606">.</span><span class="ident" id="7686607">PublicKey</span><span class="op" id="7686616">,</span>&nbsp;<span class="ident" id="7686618"><a href="/crypto/rsa/pss_test.go.html#7686179">hash</a></span><span class="op" id="7686622">,</span>&nbsp;<span class="ident" id="7686624"><a href="/crypto/rsa/pss_test.go.html#7686244">hashed</a></span><span class="op" id="7686630">,</span>&nbsp;<span class="ident" id="7686632"><a href="/crypto/rsa/pss_test.go.html#7686376">sig</a></span><span class="op" id="7686635">,</span>&nbsp;<span class="op" id="7686637">&amp;</span><span class="ident" id="7686638"><a href="/crypto/rsa/pss_test.go.html#7686270">opts</a></span><span class="op" id="7686642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7686646">if</span>&nbsp;<span class="op" id="7686649">(</span><span class="ident" id="7686650"><a href="/crypto/rsa/pss_test.go.html#7686381">err</a></span>&nbsp;<span class="op" id="7686654">==</span>&nbsp;<span class="ident" id="7686657">nil</span><span class="op" id="7686660">)</span>&nbsp;<span class="op" id="7686662">!=</span>&nbsp;<span class="ident" id="7686665"><a href="/crypto/rsa/pss_test.go.html#7686295">test</a></span><span class="op" id="7686669">.</span><span class="ident" id="7686670">good</span>&nbsp;<span class="op" id="7686675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7686680"><a href="/crypto/rsa/pss_test.go.html#7685762">t</a></span><span class="op" id="7686681">.</span><span class="ident" id="7686682">Errorf</span><span class="op" id="7686688">(</span><span class="string" id="7686689">&#34;#%d:&nbsp;bad&nbsp;result,&nbsp;wanted:&nbsp;%t,&nbsp;got:&nbsp;%s&#34;</span><span class="op" id="7686727">,</span>&nbsp;<span class="ident" id="7686729"><a href="/crypto/rsa/pss_test.go.html#7686292">i</a></span><span class="op" id="7686730">,</span>&nbsp;<span class="ident" id="7686732"><a href="/crypto/rsa/pss_test.go.html#7686295">test</a></span><span class="op" id="7686736">.</span><span class="ident" id="7686737">good</span><span class="op" id="7686741">,</span>&nbsp;<span class="ident" id="7686743"><a href="/crypto/rsa/pss_test.go.html#7686381">err</a></span><span class="op" id="7686746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7686750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7686753">}</span><br>
<span class="lineno">225</span><span class="op" id="7686755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7686758">func</span>&nbsp;<span class="ident" id="7686763">bigFromHex</span><span class="op" id="7686773">(</span><span class="ident" id="7686774">hex</span>&nbsp;<span class="builtintype" id="7686778">string</span><span class="op" id="7686784">)</span>&nbsp;<span class="op" id="7686786">*</span><span class="ident" id="7686787"><a href="/crypto/rsa/pss_test.go.html#7680318">big</a></span><span class="op" id="7686790">.</span><span class="ident" id="7686791">Int</span>&nbsp;<span class="op" id="7686795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7686798">n</span><span class="op" id="7686799">,</span>&nbsp;<span class="ident" id="7686801">ok</span>&nbsp;<span class="op" id="7686804">:=</span>&nbsp;<span class="builtinfunc" id="7686807">new</span><span class="op" id="7686810">(</span><span class="ident" id="7686811"><a href="/crypto/rsa/pss_test.go.html#7680318">big</a></span><span class="op" id="7686814">.</span><span class="ident" id="7686815">Int</span><span class="op" id="7686818">)</span><span class="op" id="7686819">.</span><span class="ident" id="7686820">SetString</span><span class="op" id="7686829">(</span><span class="ident" id="7686830"><a href="/crypto/rsa/pss_test.go.html#7686774">hex</a></span><span class="op" id="7686833">,</span>&nbsp;<span class="num" id="7686835">16</span><span class="op" id="7686837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7686840">if</span>&nbsp;<span class="op" id="7686843">!</span><span class="ident" id="7686844"><a href="/crypto/rsa/pss_test.go.html#7686801">ok</a></span>&nbsp;<span class="op" id="7686847">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7686851">panic</span><span class="op" id="7686856">(</span><span class="string" id="7686857">&#34;bad&nbsp;hex:&nbsp;&#34;</span>&nbsp;<span class="op" id="7686869">+</span>&nbsp;<span class="ident" id="7686871"><a href="/crypto/rsa/pss_test.go.html#7686774">hex</a></span><span class="op" id="7686874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7686877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7686880">return</span>&nbsp;<span class="ident" id="7686887"><a href="/crypto/rsa/pss_test.go.html#7686798">n</a></span><br>
<span class="lineno"></span><span class="op" id="7686889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="7686892">func</span>&nbsp;<span class="ident" id="7686897">intFromHex</span><span class="op" id="7686907">(</span><span class="ident" id="7686908">hex</span>&nbsp;<span class="builtintype" id="7686912">string</span><span class="op" id="7686918">)</span>&nbsp;<span class="builtintype" id="7686920">int</span>&nbsp;<span class="op" id="7686924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7686927">i</span><span class="op" id="7686928">,</span>&nbsp;<span class="ident" id="7686930">err</span>&nbsp;<span class="op" id="7686934">:=</span>&nbsp;<span class="ident" id="7686937"><a href="/crypto/rsa/pss_test.go.html#7680336">strconv</a></span><span class="op" id="7686944">.</span><span class="ident" id="7686945">ParseInt</span><span class="op" id="7686953">(</span><span class="ident" id="7686954"><a href="/crypto/rsa/pss_test.go.html#7686908">hex</a></span><span class="op" id="7686957">,</span>&nbsp;<span class="num" id="7686959">16</span><span class="op" id="7686961">,</span>&nbsp;<span class="num" id="7686963">32</span><span class="op" id="7686965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7686968">if</span>&nbsp;<span class="ident" id="7686971"><a href="/crypto/rsa/pss_test.go.html#7686930">err</a></span>&nbsp;<span class="op" id="7686975">!=</span>&nbsp;<span class="ident" id="7686978">nil</span>&nbsp;<span class="op" id="7686982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7686986">panic</span><span class="op" id="7686991">(</span><span class="ident" id="7686992"><a href="/crypto/rsa/pss_test.go.html#7686930">err</a></span><span class="op" id="7686995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7686998">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7687001">return</span>&nbsp;<span class="builtintype" id="7687008">int</span><span class="op" id="7687011">(</span><span class="ident" id="7687012"><a href="/crypto/rsa/pss_test.go.html#7686927">i</a></span><span class="op" id="7687013">)</span><br>
<span class="lineno"></span><span class="op" id="7687015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7687018">func</span>&nbsp;<span class="ident" id="7687023">fromHex</span><span class="op" id="7687030">(</span><span class="ident" id="7687031">hexStr</span>&nbsp;<span class="builtintype" id="7687038">string</span><span class="op" id="7687044">)</span>&nbsp;<span class="op" id="7687046">[</span><span class="op" id="7687047">]</span><span class="builtintype" id="7687048">byte</span>&nbsp;<span class="op" id="7687053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7687056">s</span><span class="op" id="7687057">,</span>&nbsp;<span class="ident" id="7687059">err</span>&nbsp;<span class="op" id="7687063">:=</span>&nbsp;<span class="ident" id="7687066"><a href="/crypto/rsa/pss_test.go.html#7680302">hex</a></span><span class="op" id="7687069">.</span><span class="ident" id="7687070">DecodeString</span><span class="op" id="7687082">(</span><span class="ident" id="7687083"><a href="/crypto/rsa/pss_test.go.html#7687031">hexStr</a></span><span class="op" id="7687089">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7687092">if</span>&nbsp;<span class="ident" id="7687095"><a href="/crypto/rsa/pss_test.go.html#7687059">err</a></span>&nbsp;<span class="op" id="7687099">!=</span>&nbsp;<span class="ident" id="7687102">nil</span>&nbsp;<span class="op" id="7687106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7687110">panic</span><span class="op" id="7687115">(</span><span class="ident" id="7687116"><a href="/crypto/rsa/pss_test.go.html#7687059">err</a></span><span class="op" id="7687119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7687122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7687125">return</span>&nbsp;<span class="ident" id="7687132"><a href="/crypto/rsa/pss_test.go.html#7687056">s</a></span><br>
<span class="lineno"></span><span class="op" id="7687134">}</span>
</div>
</body>
</html>
