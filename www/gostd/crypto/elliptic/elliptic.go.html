<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3917439">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3917494">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3917548">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3917599">//&nbsp;Package&nbsp;elliptic&nbsp;implements&nbsp;several&nbsp;standard&nbsp;elliptic&nbsp;curves&nbsp;over&nbsp;prime</span><br>
<span class="lineno"></span><span class="comment" id="3917674">//&nbsp;fields.</span><br>
<span class="lineno"></span><span class="keyword" id="3917685">package</span>&nbsp;<span class="ident" id="3917693">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3917703">//&nbsp;This&nbsp;package&nbsp;operates,&nbsp;internally,&nbsp;on&nbsp;Jacobian&nbsp;coordinates.&nbsp;For&nbsp;a&nbsp;given</span><br>
<span class="lineno">10</span><span class="comment" id="3917778">//&nbsp;(x,&nbsp;y)&nbsp;position&nbsp;on&nbsp;the&nbsp;curve,&nbsp;the&nbsp;Jacobian&nbsp;coordinates&nbsp;are&nbsp;(x1,&nbsp;y1,&nbsp;z1)</span><br>
<span class="lineno"></span><span class="comment" id="3917853">//&nbsp;where&nbsp;x&nbsp;=&nbsp;x1/z1²&nbsp;and&nbsp;y&nbsp;=&nbsp;y1/z1³.&nbsp;The&nbsp;greatest&nbsp;speedups&nbsp;come&nbsp;when&nbsp;the&nbsp;whole</span><br>
<span class="lineno"></span><span class="comment" id="3917933">//&nbsp;calculation&nbsp;can&nbsp;be&nbsp;performed&nbsp;within&nbsp;the&nbsp;transform&nbsp;(as&nbsp;in&nbsp;ScalarMult&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3918008">//&nbsp;ScalarBaseMult).&nbsp;But&nbsp;even&nbsp;for&nbsp;Add&nbsp;and&nbsp;Double,&nbsp;it&#39;s&nbsp;faster&nbsp;to&nbsp;apply&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3918082">//&nbsp;reverse&nbsp;the&nbsp;transform&nbsp;than&nbsp;to&nbsp;operate&nbsp;in&nbsp;affine&nbsp;coordinates.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="3918147">import</span>&nbsp;<span class="op" id="3918154">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3918157">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3918163">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3918175">&#34;sync&#34;</span><br>
<span class="lineno">20</span><span class="op" id="3918182">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3918185">//&nbsp;A&nbsp;Curve&nbsp;represents&nbsp;a&nbsp;short-form&nbsp;Weierstrass&nbsp;curve&nbsp;with&nbsp;a=-3.</span><br>
<span class="lineno"></span><span class="comment" id="3918249">//&nbsp;See&nbsp;http://www.hyperelliptic.org/EFD/g1p/auto-shortw.html</span><br>
<span class="lineno"></span><span class="keyword" id="3918310">type</span>&nbsp;<span class="ident" id="3918315">Curve</span>&nbsp;<span class="keyword" id="3918321">interface</span>&nbsp;<span class="op" id="3918331">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3918334">//&nbsp;Params&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;for&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3918383">Params</span><span class="op" id="3918389">(</span><span class="op" id="3918390">)</span>&nbsp;<span class="op" id="3918392">*</span><span class="ident" id="3918393">CurveParams</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3918406">//&nbsp;IsOnCurve&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;given&nbsp;(x,y)&nbsp;lies&nbsp;on&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3918471">IsOnCurve</span><span class="op" id="3918480">(</span><span class="ident" id="3918481">x</span><span class="op" id="3918482">,</span>&nbsp;<span class="ident" id="3918484">y</span>&nbsp;<span class="op" id="3918486">*</span><span class="ident" id="3918487">big</span><span class="op" id="3918490">.</span><span class="ident" id="3918491">Int</span><span class="op" id="3918494">)</span>&nbsp;<span class="builtintype" id="3918496">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3918502">//&nbsp;Add&nbsp;returns&nbsp;the&nbsp;sum&nbsp;of&nbsp;(x1,y1)&nbsp;and&nbsp;(x2,y2)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3918549">Add</span><span class="op" id="3918552">(</span><span class="ident" id="3918553">x1</span><span class="op" id="3918555">,</span>&nbsp;<span class="ident" id="3918557">y1</span><span class="op" id="3918559">,</span>&nbsp;<span class="ident" id="3918561">x2</span><span class="op" id="3918563">,</span>&nbsp;<span class="ident" id="3918565">y2</span>&nbsp;<span class="op" id="3918568">*</span><span class="ident" id="3918569">big</span><span class="op" id="3918572">.</span><span class="ident" id="3918573">Int</span><span class="op" id="3918576">)</span>&nbsp;<span class="op" id="3918578">(</span><span class="ident" id="3918579">x</span><span class="op" id="3918580">,</span>&nbsp;<span class="ident" id="3918582">y</span>&nbsp;<span class="op" id="3918584">*</span><span class="ident" id="3918585">big</span><span class="op" id="3918588">.</span><span class="ident" id="3918589">Int</span><span class="op" id="3918592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3918595">//&nbsp;Double&nbsp;returns&nbsp;2*(x,y)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3918622">Double</span><span class="op" id="3918628">(</span><span class="ident" id="3918629">x1</span><span class="op" id="3918631">,</span>&nbsp;<span class="ident" id="3918633">y1</span>&nbsp;<span class="op" id="3918636">*</span><span class="ident" id="3918637">big</span><span class="op" id="3918640">.</span><span class="ident" id="3918641">Int</span><span class="op" id="3918644">)</span>&nbsp;<span class="op" id="3918646">(</span><span class="ident" id="3918647">x</span><span class="op" id="3918648">,</span>&nbsp;<span class="ident" id="3918650">y</span>&nbsp;<span class="op" id="3918652">*</span><span class="ident" id="3918653">big</span><span class="op" id="3918656">.</span><span class="ident" id="3918657">Int</span><span class="op" id="3918660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3918663">//&nbsp;ScalarMult&nbsp;returns&nbsp;k*(Bx,By)&nbsp;where&nbsp;k&nbsp;is&nbsp;a&nbsp;number&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3918736">ScalarMult</span><span class="op" id="3918746">(</span><span class="ident" id="3918747">x1</span><span class="op" id="3918749">,</span>&nbsp;<span class="ident" id="3918751">y1</span>&nbsp;<span class="op" id="3918754">*</span><span class="ident" id="3918755">big</span><span class="op" id="3918758">.</span><span class="ident" id="3918759">Int</span><span class="op" id="3918762">,</span>&nbsp;<span class="ident" id="3918764">k</span>&nbsp;<span class="op" id="3918766">[</span><span class="op" id="3918767">]</span><span class="builtintype" id="3918768">byte</span><span class="op" id="3918772">)</span>&nbsp;<span class="op" id="3918774">(</span><span class="ident" id="3918775">x</span><span class="op" id="3918776">,</span>&nbsp;<span class="ident" id="3918778">y</span>&nbsp;<span class="op" id="3918780">*</span><span class="ident" id="3918781">big</span><span class="op" id="3918784">.</span><span class="ident" id="3918785">Int</span><span class="op" id="3918788">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3918791">//&nbsp;ScalarBaseMult&nbsp;returns&nbsp;k*G,&nbsp;where&nbsp;G&nbsp;is&nbsp;the&nbsp;base&nbsp;point&nbsp;of&nbsp;the&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3918862">//&nbsp;and&nbsp;k&nbsp;is&nbsp;an&nbsp;integer&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3918906">ScalarBaseMult</span><span class="op" id="3918920">(</span><span class="ident" id="3918921">k</span>&nbsp;<span class="op" id="3918923">[</span><span class="op" id="3918924">]</span><span class="builtintype" id="3918925">byte</span><span class="op" id="3918929">)</span>&nbsp;<span class="op" id="3918931">(</span><span class="ident" id="3918932">x</span><span class="op" id="3918933">,</span>&nbsp;<span class="ident" id="3918935">y</span>&nbsp;<span class="op" id="3918937">*</span><span class="ident" id="3918938">big</span><span class="op" id="3918941">.</span><span class="ident" id="3918942">Int</span><span class="op" id="3918945">)</span><br>
<span class="lineno"></span><span class="op" id="3918947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="3918950">//&nbsp;CurveParams&nbsp;contains&nbsp;the&nbsp;parameters&nbsp;of&nbsp;an&nbsp;elliptic&nbsp;curve&nbsp;and&nbsp;also&nbsp;provides</span><br>
<span class="lineno"></span><span class="comment" id="3919028">//&nbsp;a&nbsp;generic,&nbsp;non-constant&nbsp;time&nbsp;implementation&nbsp;of&nbsp;Curve.</span><br>
<span class="lineno"></span><span class="keyword" id="3919085">type</span>&nbsp;<span class="ident" id="3919090">CurveParams</span>&nbsp;<span class="keyword" id="3919102">struct</span>&nbsp;<span class="op" id="3919109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3919112">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3919120">*</span><span class="ident" id="3919121">big</span><span class="op" id="3919124">.</span><span class="ident" id="3919125">Int</span>&nbsp;<span class="comment" id="3919129">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3919167">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3919175">*</span><span class="ident" id="3919176">big</span><span class="op" id="3919179">.</span><span class="ident" id="3919180">Int</span>&nbsp;<span class="comment" id="3919184">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3919216">B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3919224">*</span><span class="ident" id="3919225">big</span><span class="op" id="3919228">.</span><span class="ident" id="3919229">Int</span>&nbsp;<span class="comment" id="3919233">//&nbsp;the&nbsp;constant&nbsp;of&nbsp;the&nbsp;curve&nbsp;equation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3919272">Gx</span><span class="op" id="3919274">,</span>&nbsp;<span class="ident" id="3919276">Gy</span>&nbsp;&nbsp;<span class="op" id="3919280">*</span><span class="ident" id="3919281">big</span><span class="op" id="3919284">.</span><span class="ident" id="3919285">Int</span>&nbsp;<span class="comment" id="3919289">//&nbsp;(x,y)&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3919317">BitSize</span>&nbsp;<span class="builtintype" id="3919325">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3919334">//&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="3919370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="3919373">func</span>&nbsp;<span class="op" id="3919378">(</span><span class="ident" id="3919379">curve</span>&nbsp;<span class="op" id="3919385">*</span><span class="ident" id="3919386">CurveParams</span><span class="op" id="3919397">)</span>&nbsp;<span class="ident" id="3919399">Params</span><span class="op" id="3919405">(</span><span class="op" id="3919406">)</span>&nbsp;<span class="op" id="3919408">*</span><span class="ident" id="3919409">CurveParams</span>&nbsp;<span class="op" id="3919421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3919424">return</span>&nbsp;<span class="ident" id="3919431">curve</span><br>
<span class="lineno"></span><span class="op" id="3919437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3919440">func</span>&nbsp;<span class="op" id="3919445">(</span><span class="ident" id="3919446">curve</span>&nbsp;<span class="op" id="3919452">*</span><span class="ident" id="3919453">CurveParams</span><span class="op" id="3919464">)</span>&nbsp;<span class="ident" id="3919466">IsOnCurve</span><span class="op" id="3919475">(</span><span class="ident" id="3919476">x</span><span class="op" id="3919477">,</span>&nbsp;<span class="ident" id="3919479">y</span>&nbsp;<span class="op" id="3919481">*</span><span class="ident" id="3919482">big</span><span class="op" id="3919485">.</span><span class="ident" id="3919486">Int</span><span class="op" id="3919489">)</span>&nbsp;<span class="builtintype" id="3919491">bool</span>&nbsp;<span class="op" id="3919496">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3919499">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3919522">y2</span>&nbsp;<span class="op" id="3919525">:=</span>&nbsp;<span class="builtinfunc" id="3919528">new</span><span class="op" id="3919531">(</span><span class="ident" id="3919532">big</span><span class="op" id="3919535">.</span><span class="ident" id="3919536">Int</span><span class="op" id="3919539">)</span><span class="op" id="3919540">.</span><span class="ident" id="3919541">Mul</span><span class="op" id="3919544">(</span><span class="ident" id="3919545">y</span><span class="op" id="3919546">,</span>&nbsp;<span class="ident" id="3919548">y</span><span class="op" id="3919549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3919552">y2</span><span class="op" id="3919554">.</span><span class="ident" id="3919555">Mod</span><span class="op" id="3919558">(</span><span class="ident" id="3919559">y2</span><span class="op" id="3919561">,</span>&nbsp;<span class="ident" id="3919563">curve</span><span class="op" id="3919568">.</span><span class="ident" id="3919569">P</span><span class="op" id="3919570">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3919574">x3</span>&nbsp;<span class="op" id="3919577">:=</span>&nbsp;<span class="builtinfunc" id="3919580">new</span><span class="op" id="3919583">(</span><span class="ident" id="3919584">big</span><span class="op" id="3919587">.</span><span class="ident" id="3919588">Int</span><span class="op" id="3919591">)</span><span class="op" id="3919592">.</span><span class="ident" id="3919593">Mul</span><span class="op" id="3919596">(</span><span class="ident" id="3919597">x</span><span class="op" id="3919598">,</span>&nbsp;<span class="ident" id="3919600">x</span><span class="op" id="3919601">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3919604">x3</span><span class="op" id="3919606">.</span><span class="ident" id="3919607">Mul</span><span class="op" id="3919610">(</span><span class="ident" id="3919611">x3</span><span class="op" id="3919613">,</span>&nbsp;<span class="ident" id="3919615">x</span><span class="op" id="3919616">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3919620">threeX</span>&nbsp;<span class="op" id="3919627">:=</span>&nbsp;<span class="builtinfunc" id="3919630">new</span><span class="op" id="3919633">(</span><span class="ident" id="3919634">big</span><span class="op" id="3919637">.</span><span class="ident" id="3919638">Int</span><span class="op" id="3919641">)</span><span class="op" id="3919642">.</span><span class="ident" id="3919643">Lsh</span><span class="op" id="3919646">(</span><span class="ident" id="3919647">x</span><span class="op" id="3919648">,</span>&nbsp;<span class="num" id="3919650">1</span><span class="op" id="3919651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3919654">threeX</span><span class="op" id="3919660">.</span><span class="ident" id="3919661">Add</span><span class="op" id="3919664">(</span><span class="ident" id="3919665">threeX</span><span class="op" id="3919671">,</span>&nbsp;<span class="ident" id="3919673">x</span><span class="op" id="3919674">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3919678">x3</span><span class="op" id="3919680">.</span><span class="ident" id="3919681">Sub</span><span class="op" id="3919684">(</span><span class="ident" id="3919685">x3</span><span class="op" id="3919687">,</span>&nbsp;<span class="ident" id="3919689">threeX</span><span class="op" id="3919695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3919698">x3</span><span class="op" id="3919700">.</span><span class="ident" id="3919701">Add</span><span class="op" id="3919704">(</span><span class="ident" id="3919705">x3</span><span class="op" id="3919707">,</span>&nbsp;<span class="ident" id="3919709">curve</span><span class="op" id="3919714">.</span><span class="ident" id="3919715">B</span><span class="op" id="3919716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3919719">x3</span><span class="op" id="3919721">.</span><span class="ident" id="3919722">Mod</span><span class="op" id="3919725">(</span><span class="ident" id="3919726">x3</span><span class="op" id="3919728">,</span>&nbsp;<span class="ident" id="3919730">curve</span><span class="op" id="3919735">.</span><span class="ident" id="3919736">P</span><span class="op" id="3919737">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3919741">return</span>&nbsp;<span class="ident" id="3919748">x3</span><span class="op" id="3919750">.</span><span class="ident" id="3919751">Cmp</span><span class="op" id="3919754">(</span><span class="ident" id="3919755">y2</span><span class="op" id="3919757">)</span>&nbsp;<span class="op" id="3919759">==</span>&nbsp;<span class="num" id="3919762">0</span><br>
<span class="lineno">70</span><span class="op" id="3919764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3919767">//&nbsp;zForAffine&nbsp;returns&nbsp;a&nbsp;Jacobian&nbsp;Z&nbsp;value&nbsp;for&nbsp;the&nbsp;affine&nbsp;point&nbsp;(x,&nbsp;y).&nbsp;If&nbsp;x&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3919846">//&nbsp;y&nbsp;are&nbsp;zero,&nbsp;it&nbsp;assumes&nbsp;that&nbsp;they&nbsp;represent&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;because&nbsp;(0,</span><br>
<span class="lineno"></span><span class="comment" id="3919926">//&nbsp;0)&nbsp;is&nbsp;not&nbsp;on&nbsp;the&nbsp;any&nbsp;of&nbsp;the&nbsp;curves&nbsp;handled&nbsp;here.</span><br>
<span class="lineno">75</span><span class="keyword" id="3919978">func</span>&nbsp;<span class="ident" id="3919983">zForAffine</span><span class="op" id="3919993">(</span><span class="ident" id="3919994">x</span><span class="op" id="3919995">,</span>&nbsp;<span class="ident" id="3919997">y</span>&nbsp;<span class="op" id="3919999">*</span><span class="ident" id="3920000">big</span><span class="op" id="3920003">.</span><span class="ident" id="3920004">Int</span><span class="op" id="3920007">)</span>&nbsp;<span class="op" id="3920009">*</span><span class="ident" id="3920010">big</span><span class="op" id="3920013">.</span><span class="ident" id="3920014">Int</span>&nbsp;<span class="op" id="3920018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3920021">z</span>&nbsp;<span class="op" id="3920023">:=</span>&nbsp;<span class="builtinfunc" id="3920026">new</span><span class="op" id="3920029">(</span><span class="ident" id="3920030">big</span><span class="op" id="3920033">.</span><span class="ident" id="3920034">Int</span><span class="op" id="3920037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3920040">if</span>&nbsp;<span class="ident" id="3920043">x</span><span class="op" id="3920044">.</span><span class="ident" id="3920045">Sign</span><span class="op" id="3920049">(</span><span class="op" id="3920050">)</span>&nbsp;<span class="op" id="3920052">!=</span>&nbsp;<span class="num" id="3920055">0</span>&nbsp;<span class="op" id="3920057">||</span>&nbsp;<span class="ident" id="3920060">y</span><span class="op" id="3920061">.</span><span class="ident" id="3920062">Sign</span><span class="op" id="3920066">(</span><span class="op" id="3920067">)</span>&nbsp;<span class="op" id="3920069">!=</span>&nbsp;<span class="num" id="3920072">0</span>&nbsp;<span class="op" id="3920074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3920078">z</span><span class="op" id="3920079">.</span><span class="ident" id="3920080">SetInt64</span><span class="op" id="3920088">(</span><span class="num" id="3920089">1</span><span class="op" id="3920090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3920093">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3920096">return</span>&nbsp;<span class="ident" id="3920103">z</span><br>
<span class="lineno"></span><span class="op" id="3920105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3920108">//&nbsp;affineFromJacobian&nbsp;reverses&nbsp;the&nbsp;Jacobian&nbsp;transform.&nbsp;See&nbsp;the&nbsp;comment&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3920186">//&nbsp;top&nbsp;of&nbsp;the&nbsp;file.&nbsp;If&nbsp;the&nbsp;point&nbsp;is&nbsp;∞&nbsp;it&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">85</span><span class="keyword" id="3920243">func</span>&nbsp;<span class="op" id="3920248">(</span><span class="ident" id="3920249">curve</span>&nbsp;<span class="op" id="3920255">*</span><span class="ident" id="3920256">CurveParams</span><span class="op" id="3920267">)</span>&nbsp;<span class="ident" id="3920269">affineFromJacobian</span><span class="op" id="3920287">(</span><span class="ident" id="3920288">x</span><span class="op" id="3920289">,</span>&nbsp;<span class="ident" id="3920291">y</span><span class="op" id="3920292">,</span>&nbsp;<span class="ident" id="3920294">z</span>&nbsp;<span class="op" id="3920296">*</span><span class="ident" id="3920297">big</span><span class="op" id="3920300">.</span><span class="ident" id="3920301">Int</span><span class="op" id="3920304">)</span>&nbsp;<span class="op" id="3920306">(</span><span class="ident" id="3920307">xOut</span><span class="op" id="3920311">,</span>&nbsp;<span class="ident" id="3920313">yOut</span>&nbsp;<span class="op" id="3920318">*</span><span class="ident" id="3920319">big</span><span class="op" id="3920322">.</span><span class="ident" id="3920323">Int</span><span class="op" id="3920326">)</span>&nbsp;<span class="op" id="3920328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3920331">if</span>&nbsp;<span class="ident" id="3920334">z</span><span class="op" id="3920335">.</span><span class="ident" id="3920336">Sign</span><span class="op" id="3920340">(</span><span class="op" id="3920341">)</span>&nbsp;<span class="op" id="3920343">==</span>&nbsp;<span class="num" id="3920346">0</span>&nbsp;<span class="op" id="3920348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3920352">return</span>&nbsp;<span class="builtinfunc" id="3920359">new</span><span class="op" id="3920362">(</span><span class="ident" id="3920363">big</span><span class="op" id="3920366">.</span><span class="ident" id="3920367">Int</span><span class="op" id="3920370">)</span><span class="op" id="3920371">,</span>&nbsp;<span class="builtinfunc" id="3920373">new</span><span class="op" id="3920376">(</span><span class="ident" id="3920377">big</span><span class="op" id="3920380">.</span><span class="ident" id="3920381">Int</span><span class="op" id="3920384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3920387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3920391">zinv</span>&nbsp;<span class="op" id="3920396">:=</span>&nbsp;<span class="builtinfunc" id="3920399">new</span><span class="op" id="3920402">(</span><span class="ident" id="3920403">big</span><span class="op" id="3920406">.</span><span class="ident" id="3920407">Int</span><span class="op" id="3920410">)</span><span class="op" id="3920411">.</span><span class="ident" id="3920412">ModInverse</span><span class="op" id="3920422">(</span><span class="ident" id="3920423">z</span><span class="op" id="3920424">,</span>&nbsp;<span class="ident" id="3920426">curve</span><span class="op" id="3920431">.</span><span class="ident" id="3920432">P</span><span class="op" id="3920433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3920436">zinvsq</span>&nbsp;<span class="op" id="3920443">:=</span>&nbsp;<span class="builtinfunc" id="3920446">new</span><span class="op" id="3920449">(</span><span class="ident" id="3920450">big</span><span class="op" id="3920453">.</span><span class="ident" id="3920454">Int</span><span class="op" id="3920457">)</span><span class="op" id="3920458">.</span><span class="ident" id="3920459">Mul</span><span class="op" id="3920462">(</span><span class="ident" id="3920463">zinv</span><span class="op" id="3920467">,</span>&nbsp;<span class="ident" id="3920469">zinv</span><span class="op" id="3920473">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3920477">xOut</span>&nbsp;<span class="op" id="3920482">=</span>&nbsp;<span class="builtinfunc" id="3920484">new</span><span class="op" id="3920487">(</span><span class="ident" id="3920488">big</span><span class="op" id="3920491">.</span><span class="ident" id="3920492">Int</span><span class="op" id="3920495">)</span><span class="op" id="3920496">.</span><span class="ident" id="3920497">Mul</span><span class="op" id="3920500">(</span><span class="ident" id="3920501">x</span><span class="op" id="3920502">,</span>&nbsp;<span class="ident" id="3920504">zinvsq</span><span class="op" id="3920510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3920513">xOut</span><span class="op" id="3920517">.</span><span class="ident" id="3920518">Mod</span><span class="op" id="3920521">(</span><span class="ident" id="3920522">xOut</span><span class="op" id="3920526">,</span>&nbsp;<span class="ident" id="3920528">curve</span><span class="op" id="3920533">.</span><span class="ident" id="3920534">P</span><span class="op" id="3920535">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3920538">zinvsq</span><span class="op" id="3920544">.</span><span class="ident" id="3920545">Mul</span><span class="op" id="3920548">(</span><span class="ident" id="3920549">zinvsq</span><span class="op" id="3920555">,</span>&nbsp;<span class="ident" id="3920557">zinv</span><span class="op" id="3920561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3920564">yOut</span>&nbsp;<span class="op" id="3920569">=</span>&nbsp;<span class="builtinfunc" id="3920571">new</span><span class="op" id="3920574">(</span><span class="ident" id="3920575">big</span><span class="op" id="3920578">.</span><span class="ident" id="3920579">Int</span><span class="op" id="3920582">)</span><span class="op" id="3920583">.</span><span class="ident" id="3920584">Mul</span><span class="op" id="3920587">(</span><span class="ident" id="3920588">y</span><span class="op" id="3920589">,</span>&nbsp;<span class="ident" id="3920591">zinvsq</span><span class="op" id="3920597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3920600">yOut</span><span class="op" id="3920604">.</span><span class="ident" id="3920605">Mod</span><span class="op" id="3920608">(</span><span class="ident" id="3920609">yOut</span><span class="op" id="3920613">,</span>&nbsp;<span class="ident" id="3920615">curve</span><span class="op" id="3920620">.</span><span class="ident" id="3920621">P</span><span class="op" id="3920622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3920625">return</span><br>
<span class="lineno"></span><span class="op" id="3920632">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="3920635">func</span>&nbsp;<span class="op" id="3920640">(</span><span class="ident" id="3920641">curve</span>&nbsp;<span class="op" id="3920647">*</span><span class="ident" id="3920648">CurveParams</span><span class="op" id="3920659">)</span>&nbsp;<span class="ident" id="3920661">Add</span><span class="op" id="3920664">(</span><span class="ident" id="3920665">x1</span><span class="op" id="3920667">,</span>&nbsp;<span class="ident" id="3920669">y1</span><span class="op" id="3920671">,</span>&nbsp;<span class="ident" id="3920673">x2</span><span class="op" id="3920675">,</span>&nbsp;<span class="ident" id="3920677">y2</span>&nbsp;<span class="op" id="3920680">*</span><span class="ident" id="3920681">big</span><span class="op" id="3920684">.</span><span class="ident" id="3920685">Int</span><span class="op" id="3920688">)</span>&nbsp;<span class="op" id="3920690">(</span><span class="op" id="3920691">*</span><span class="ident" id="3920692">big</span><span class="op" id="3920695">.</span><span class="ident" id="3920696">Int</span><span class="op" id="3920699">,</span>&nbsp;<span class="op" id="3920701">*</span><span class="ident" id="3920702">big</span><span class="op" id="3920705">.</span><span class="ident" id="3920706">Int</span><span class="op" id="3920709">)</span>&nbsp;<span class="op" id="3920711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3920714">z1</span>&nbsp;<span class="op" id="3920717">:=</span>&nbsp;<span class="ident" id="3920720">zForAffine</span><span class="op" id="3920730">(</span><span class="ident" id="3920731">x1</span><span class="op" id="3920733">,</span>&nbsp;<span class="ident" id="3920735">y1</span><span class="op" id="3920737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3920740">z2</span>&nbsp;<span class="op" id="3920743">:=</span>&nbsp;<span class="ident" id="3920746">zForAffine</span><span class="op" id="3920756">(</span><span class="ident" id="3920757">x2</span><span class="op" id="3920759">,</span>&nbsp;<span class="ident" id="3920761">y2</span><span class="op" id="3920763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3920766">return</span>&nbsp;<span class="ident" id="3920773">curve</span><span class="op" id="3920778">.</span><span class="ident" id="3920779">affineFromJacobian</span><span class="op" id="3920797">(</span><span class="ident" id="3920798">curve</span><span class="op" id="3920803">.</span><span class="ident" id="3920804">addJacobian</span><span class="op" id="3920815">(</span><span class="ident" id="3920816">x1</span><span class="op" id="3920818">,</span>&nbsp;<span class="ident" id="3920820">y1</span><span class="op" id="3920822">,</span>&nbsp;<span class="ident" id="3920824">z1</span><span class="op" id="3920826">,</span>&nbsp;<span class="ident" id="3920828">x2</span><span class="op" id="3920830">,</span>&nbsp;<span class="ident" id="3920832">y2</span><span class="op" id="3920834">,</span>&nbsp;<span class="ident" id="3920836">z2</span><span class="op" id="3920838">)</span><span class="op" id="3920839">)</span><br>
<span class="lineno">105</span><span class="op" id="3920841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3920844">//&nbsp;addJacobian&nbsp;takes&nbsp;two&nbsp;points&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x1,&nbsp;y1,&nbsp;z1)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3920918">//&nbsp;(x2,&nbsp;y2,&nbsp;z2)&nbsp;and&nbsp;returns&nbsp;their&nbsp;sum,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="3920980">func</span>&nbsp;<span class="op" id="3920985">(</span><span class="ident" id="3920986">curve</span>&nbsp;<span class="op" id="3920992">*</span><span class="ident" id="3920993">CurveParams</span><span class="op" id="3921004">)</span>&nbsp;<span class="ident" id="3921006">addJacobian</span><span class="op" id="3921017">(</span><span class="ident" id="3921018">x1</span><span class="op" id="3921020">,</span>&nbsp;<span class="ident" id="3921022">y1</span><span class="op" id="3921024">,</span>&nbsp;<span class="ident" id="3921026">z1</span><span class="op" id="3921028">,</span>&nbsp;<span class="ident" id="3921030">x2</span><span class="op" id="3921032">,</span>&nbsp;<span class="ident" id="3921034">y2</span><span class="op" id="3921036">,</span>&nbsp;<span class="ident" id="3921038">z2</span>&nbsp;<span class="op" id="3921041">*</span><span class="ident" id="3921042">big</span><span class="op" id="3921045">.</span><span class="ident" id="3921046">Int</span><span class="op" id="3921049">)</span>&nbsp;<span class="op" id="3921051">(</span><span class="op" id="3921052">*</span><span class="ident" id="3921053">big</span><span class="op" id="3921056">.</span><span class="ident" id="3921057">Int</span><span class="op" id="3921060">,</span>&nbsp;<span class="op" id="3921062">*</span><span class="ident" id="3921063">big</span><span class="op" id="3921066">.</span><span class="ident" id="3921067">Int</span><span class="op" id="3921070">,</span>&nbsp;<span class="op" id="3921072">*</span><span class="ident" id="3921073">big</span><span class="op" id="3921076">.</span><span class="ident" id="3921077">Int</span><span class="op" id="3921080">)</span>&nbsp;<span class="op" id="3921082">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3921085">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-add-2007-bl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921175">x3</span><span class="op" id="3921177">,</span>&nbsp;<span class="ident" id="3921179">y3</span><span class="op" id="3921181">,</span>&nbsp;<span class="ident" id="3921183">z3</span>&nbsp;<span class="op" id="3921186">:=</span>&nbsp;<span class="builtinfunc" id="3921189">new</span><span class="op" id="3921192">(</span><span class="ident" id="3921193">big</span><span class="op" id="3921196">.</span><span class="ident" id="3921197">Int</span><span class="op" id="3921200">)</span><span class="op" id="3921201">,</span>&nbsp;<span class="builtinfunc" id="3921203">new</span><span class="op" id="3921206">(</span><span class="ident" id="3921207">big</span><span class="op" id="3921210">.</span><span class="ident" id="3921211">Int</span><span class="op" id="3921214">)</span><span class="op" id="3921215">,</span>&nbsp;<span class="builtinfunc" id="3921217">new</span><span class="op" id="3921220">(</span><span class="ident" id="3921221">big</span><span class="op" id="3921224">.</span><span class="ident" id="3921225">Int</span><span class="op" id="3921228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3921231">if</span>&nbsp;<span class="ident" id="3921234">z1</span><span class="op" id="3921236">.</span><span class="ident" id="3921237">Sign</span><span class="op" id="3921241">(</span><span class="op" id="3921242">)</span>&nbsp;<span class="op" id="3921244">==</span>&nbsp;<span class="num" id="3921247">0</span>&nbsp;<span class="op" id="3921249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921253">x3</span><span class="op" id="3921255">.</span><span class="ident" id="3921256">Set</span><span class="op" id="3921259">(</span><span class="ident" id="3921260">x2</span><span class="op" id="3921262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921266">y3</span><span class="op" id="3921268">.</span><span class="ident" id="3921269">Set</span><span class="op" id="3921272">(</span><span class="ident" id="3921273">y2</span><span class="op" id="3921275">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921279">z3</span><span class="op" id="3921281">.</span><span class="ident" id="3921282">Set</span><span class="op" id="3921285">(</span><span class="ident" id="3921286">z2</span><span class="op" id="3921288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3921292">return</span>&nbsp;<span class="ident" id="3921299">x3</span><span class="op" id="3921301">,</span>&nbsp;<span class="ident" id="3921303">y3</span><span class="op" id="3921305">,</span>&nbsp;<span class="ident" id="3921307">z3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3921311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3921314">if</span>&nbsp;<span class="ident" id="3921317">z2</span><span class="op" id="3921319">.</span><span class="ident" id="3921320">Sign</span><span class="op" id="3921324">(</span><span class="op" id="3921325">)</span>&nbsp;<span class="op" id="3921327">==</span>&nbsp;<span class="num" id="3921330">0</span>&nbsp;<span class="op" id="3921332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921336">x3</span><span class="op" id="3921338">.</span><span class="ident" id="3921339">Set</span><span class="op" id="3921342">(</span><span class="ident" id="3921343">x1</span><span class="op" id="3921345">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921349">y3</span><span class="op" id="3921351">.</span><span class="ident" id="3921352">Set</span><span class="op" id="3921355">(</span><span class="ident" id="3921356">y1</span><span class="op" id="3921358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921362">z3</span><span class="op" id="3921364">.</span><span class="ident" id="3921365">Set</span><span class="op" id="3921368">(</span><span class="ident" id="3921369">z1</span><span class="op" id="3921371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3921375">return</span>&nbsp;<span class="ident" id="3921382">x3</span><span class="op" id="3921384">,</span>&nbsp;<span class="ident" id="3921386">y3</span><span class="op" id="3921388">,</span>&nbsp;<span class="ident" id="3921390">z3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3921394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921398">z1z1</span>&nbsp;<span class="op" id="3921403">:=</span>&nbsp;<span class="builtinfunc" id="3921406">new</span><span class="op" id="3921409">(</span><span class="ident" id="3921410">big</span><span class="op" id="3921413">.</span><span class="ident" id="3921414">Int</span><span class="op" id="3921417">)</span><span class="op" id="3921418">.</span><span class="ident" id="3921419">Mul</span><span class="op" id="3921422">(</span><span class="ident" id="3921423">z1</span><span class="op" id="3921425">,</span>&nbsp;<span class="ident" id="3921427">z1</span><span class="op" id="3921429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921432">z1z1</span><span class="op" id="3921436">.</span><span class="ident" id="3921437">Mod</span><span class="op" id="3921440">(</span><span class="ident" id="3921441">z1z1</span><span class="op" id="3921445">,</span>&nbsp;<span class="ident" id="3921447">curve</span><span class="op" id="3921452">.</span><span class="ident" id="3921453">P</span><span class="op" id="3921454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921457">z2z2</span>&nbsp;<span class="op" id="3921462">:=</span>&nbsp;<span class="builtinfunc" id="3921465">new</span><span class="op" id="3921468">(</span><span class="ident" id="3921469">big</span><span class="op" id="3921472">.</span><span class="ident" id="3921473">Int</span><span class="op" id="3921476">)</span><span class="op" id="3921477">.</span><span class="ident" id="3921478">Mul</span><span class="op" id="3921481">(</span><span class="ident" id="3921482">z2</span><span class="op" id="3921484">,</span>&nbsp;<span class="ident" id="3921486">z2</span><span class="op" id="3921488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921491">z2z2</span><span class="op" id="3921495">.</span><span class="ident" id="3921496">Mod</span><span class="op" id="3921499">(</span><span class="ident" id="3921500">z2z2</span><span class="op" id="3921504">,</span>&nbsp;<span class="ident" id="3921506">curve</span><span class="op" id="3921511">.</span><span class="ident" id="3921512">P</span><span class="op" id="3921513">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921517">u1</span>&nbsp;<span class="op" id="3921520">:=</span>&nbsp;<span class="builtinfunc" id="3921523">new</span><span class="op" id="3921526">(</span><span class="ident" id="3921527">big</span><span class="op" id="3921530">.</span><span class="ident" id="3921531">Int</span><span class="op" id="3921534">)</span><span class="op" id="3921535">.</span><span class="ident" id="3921536">Mul</span><span class="op" id="3921539">(</span><span class="ident" id="3921540">x1</span><span class="op" id="3921542">,</span>&nbsp;<span class="ident" id="3921544">z2z2</span><span class="op" id="3921548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921551">u1</span><span class="op" id="3921553">.</span><span class="ident" id="3921554">Mod</span><span class="op" id="3921557">(</span><span class="ident" id="3921558">u1</span><span class="op" id="3921560">,</span>&nbsp;<span class="ident" id="3921562">curve</span><span class="op" id="3921567">.</span><span class="ident" id="3921568">P</span><span class="op" id="3921569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921572">u2</span>&nbsp;<span class="op" id="3921575">:=</span>&nbsp;<span class="builtinfunc" id="3921578">new</span><span class="op" id="3921581">(</span><span class="ident" id="3921582">big</span><span class="op" id="3921585">.</span><span class="ident" id="3921586">Int</span><span class="op" id="3921589">)</span><span class="op" id="3921590">.</span><span class="ident" id="3921591">Mul</span><span class="op" id="3921594">(</span><span class="ident" id="3921595">x2</span><span class="op" id="3921597">,</span>&nbsp;<span class="ident" id="3921599">z1z1</span><span class="op" id="3921603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921606">u2</span><span class="op" id="3921608">.</span><span class="ident" id="3921609">Mod</span><span class="op" id="3921612">(</span><span class="ident" id="3921613">u2</span><span class="op" id="3921615">,</span>&nbsp;<span class="ident" id="3921617">curve</span><span class="op" id="3921622">.</span><span class="ident" id="3921623">P</span><span class="op" id="3921624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921627">h</span>&nbsp;<span class="op" id="3921629">:=</span>&nbsp;<span class="builtinfunc" id="3921632">new</span><span class="op" id="3921635">(</span><span class="ident" id="3921636">big</span><span class="op" id="3921639">.</span><span class="ident" id="3921640">Int</span><span class="op" id="3921643">)</span><span class="op" id="3921644">.</span><span class="ident" id="3921645">Sub</span><span class="op" id="3921648">(</span><span class="ident" id="3921649">u2</span><span class="op" id="3921651">,</span>&nbsp;<span class="ident" id="3921653">u1</span><span class="op" id="3921655">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921658">xEqual</span>&nbsp;<span class="op" id="3921665">:=</span>&nbsp;<span class="ident" id="3921668">h</span><span class="op" id="3921669">.</span><span class="ident" id="3921670">Sign</span><span class="op" id="3921674">(</span><span class="op" id="3921675">)</span>&nbsp;<span class="op" id="3921677">==</span>&nbsp;<span class="num" id="3921680">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3921683">if</span>&nbsp;<span class="ident" id="3921686">h</span><span class="op" id="3921687">.</span><span class="ident" id="3921688">Sign</span><span class="op" id="3921692">(</span><span class="op" id="3921693">)</span>&nbsp;<span class="op" id="3921695">==</span>&nbsp;<span class="op" id="3921698">-</span><span class="num" id="3921699">1</span>&nbsp;<span class="op" id="3921701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921705">h</span><span class="op" id="3921706">.</span><span class="ident" id="3921707">Add</span><span class="op" id="3921710">(</span><span class="ident" id="3921711">h</span><span class="op" id="3921712">,</span>&nbsp;<span class="ident" id="3921714">curve</span><span class="op" id="3921719">.</span><span class="ident" id="3921720">P</span><span class="op" id="3921721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3921724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921727">i</span>&nbsp;<span class="op" id="3921729">:=</span>&nbsp;<span class="builtinfunc" id="3921732">new</span><span class="op" id="3921735">(</span><span class="ident" id="3921736">big</span><span class="op" id="3921739">.</span><span class="ident" id="3921740">Int</span><span class="op" id="3921743">)</span><span class="op" id="3921744">.</span><span class="ident" id="3921745">Lsh</span><span class="op" id="3921748">(</span><span class="ident" id="3921749">h</span><span class="op" id="3921750">,</span>&nbsp;<span class="num" id="3921752">1</span><span class="op" id="3921753">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921756">i</span><span class="op" id="3921757">.</span><span class="ident" id="3921758">Mul</span><span class="op" id="3921761">(</span><span class="ident" id="3921762">i</span><span class="op" id="3921763">,</span>&nbsp;<span class="ident" id="3921765">i</span><span class="op" id="3921766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921769">j</span>&nbsp;<span class="op" id="3921771">:=</span>&nbsp;<span class="builtinfunc" id="3921774">new</span><span class="op" id="3921777">(</span><span class="ident" id="3921778">big</span><span class="op" id="3921781">.</span><span class="ident" id="3921782">Int</span><span class="op" id="3921785">)</span><span class="op" id="3921786">.</span><span class="ident" id="3921787">Mul</span><span class="op" id="3921790">(</span><span class="ident" id="3921791">h</span><span class="op" id="3921792">,</span>&nbsp;<span class="ident" id="3921794">i</span><span class="op" id="3921795">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921799">s1</span>&nbsp;<span class="op" id="3921802">:=</span>&nbsp;<span class="builtinfunc" id="3921805">new</span><span class="op" id="3921808">(</span><span class="ident" id="3921809">big</span><span class="op" id="3921812">.</span><span class="ident" id="3921813">Int</span><span class="op" id="3921816">)</span><span class="op" id="3921817">.</span><span class="ident" id="3921818">Mul</span><span class="op" id="3921821">(</span><span class="ident" id="3921822">y1</span><span class="op" id="3921824">,</span>&nbsp;<span class="ident" id="3921826">z2</span><span class="op" id="3921828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921831">s1</span><span class="op" id="3921833">.</span><span class="ident" id="3921834">Mul</span><span class="op" id="3921837">(</span><span class="ident" id="3921838">s1</span><span class="op" id="3921840">,</span>&nbsp;<span class="ident" id="3921842">z2z2</span><span class="op" id="3921846">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921849">s1</span><span class="op" id="3921851">.</span><span class="ident" id="3921852">Mod</span><span class="op" id="3921855">(</span><span class="ident" id="3921856">s1</span><span class="op" id="3921858">,</span>&nbsp;<span class="ident" id="3921860">curve</span><span class="op" id="3921865">.</span><span class="ident" id="3921866">P</span><span class="op" id="3921867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921870">s2</span>&nbsp;<span class="op" id="3921873">:=</span>&nbsp;<span class="builtinfunc" id="3921876">new</span><span class="op" id="3921879">(</span><span class="ident" id="3921880">big</span><span class="op" id="3921883">.</span><span class="ident" id="3921884">Int</span><span class="op" id="3921887">)</span><span class="op" id="3921888">.</span><span class="ident" id="3921889">Mul</span><span class="op" id="3921892">(</span><span class="ident" id="3921893">y2</span><span class="op" id="3921895">,</span>&nbsp;<span class="ident" id="3921897">z1</span><span class="op" id="3921899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921902">s2</span><span class="op" id="3921904">.</span><span class="ident" id="3921905">Mul</span><span class="op" id="3921908">(</span><span class="ident" id="3921909">s2</span><span class="op" id="3921911">,</span>&nbsp;<span class="ident" id="3921913">z1z1</span><span class="op" id="3921917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921920">s2</span><span class="op" id="3921922">.</span><span class="ident" id="3921923">Mod</span><span class="op" id="3921926">(</span><span class="ident" id="3921927">s2</span><span class="op" id="3921929">,</span>&nbsp;<span class="ident" id="3921931">curve</span><span class="op" id="3921936">.</span><span class="ident" id="3921937">P</span><span class="op" id="3921938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921941">r</span>&nbsp;<span class="op" id="3921943">:=</span>&nbsp;<span class="builtinfunc" id="3921946">new</span><span class="op" id="3921949">(</span><span class="ident" id="3921950">big</span><span class="op" id="3921953">.</span><span class="ident" id="3921954">Int</span><span class="op" id="3921957">)</span><span class="op" id="3921958">.</span><span class="ident" id="3921959">Sub</span><span class="op" id="3921962">(</span><span class="ident" id="3921963">s2</span><span class="op" id="3921965">,</span>&nbsp;<span class="ident" id="3921967">s1</span><span class="op" id="3921969">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3921972">if</span>&nbsp;<span class="ident" id="3921975">r</span><span class="op" id="3921976">.</span><span class="ident" id="3921977">Sign</span><span class="op" id="3921981">(</span><span class="op" id="3921982">)</span>&nbsp;<span class="op" id="3921984">==</span>&nbsp;<span class="op" id="3921987">-</span><span class="num" id="3921988">1</span>&nbsp;<span class="op" id="3921990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3921994">r</span><span class="op" id="3921995">.</span><span class="ident" id="3921996">Add</span><span class="op" id="3921999">(</span><span class="ident" id="3922000">r</span><span class="op" id="3922001">,</span>&nbsp;<span class="ident" id="3922003">curve</span><span class="op" id="3922008">.</span><span class="ident" id="3922009">P</span><span class="op" id="3922010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3922013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922016">yEqual</span>&nbsp;<span class="op" id="3922023">:=</span>&nbsp;<span class="ident" id="3922026">r</span><span class="op" id="3922027">.</span><span class="ident" id="3922028">Sign</span><span class="op" id="3922032">(</span><span class="op" id="3922033">)</span>&nbsp;<span class="op" id="3922035">==</span>&nbsp;<span class="num" id="3922038">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3922041">if</span>&nbsp;<span class="ident" id="3922044">xEqual</span>&nbsp;<span class="op" id="3922051">&amp;&amp;</span>&nbsp;<span class="ident" id="3922054">yEqual</span>&nbsp;<span class="op" id="3922061">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3922065">return</span>&nbsp;<span class="ident" id="3922072">curve</span><span class="op" id="3922077">.</span><span class="ident" id="3922078">doubleJacobian</span><span class="op" id="3922092">(</span><span class="ident" id="3922093">x1</span><span class="op" id="3922095">,</span>&nbsp;<span class="ident" id="3922097">y1</span><span class="op" id="3922099">,</span>&nbsp;<span class="ident" id="3922101">z1</span><span class="op" id="3922103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3922106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922109">r</span><span class="op" id="3922110">.</span><span class="ident" id="3922111">Lsh</span><span class="op" id="3922114">(</span><span class="ident" id="3922115">r</span><span class="op" id="3922116">,</span>&nbsp;<span class="num" id="3922118">1</span><span class="op" id="3922119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922122">v</span>&nbsp;<span class="op" id="3922124">:=</span>&nbsp;<span class="builtinfunc" id="3922127">new</span><span class="op" id="3922130">(</span><span class="ident" id="3922131">big</span><span class="op" id="3922134">.</span><span class="ident" id="3922135">Int</span><span class="op" id="3922138">)</span><span class="op" id="3922139">.</span><span class="ident" id="3922140">Mul</span><span class="op" id="3922143">(</span><span class="ident" id="3922144">u1</span><span class="op" id="3922146">,</span>&nbsp;<span class="ident" id="3922148">i</span><span class="op" id="3922149">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922153">x3</span><span class="op" id="3922155">.</span><span class="ident" id="3922156">Set</span><span class="op" id="3922159">(</span><span class="ident" id="3922160">r</span><span class="op" id="3922161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922164">x3</span><span class="op" id="3922166">.</span><span class="ident" id="3922167">Mul</span><span class="op" id="3922170">(</span><span class="ident" id="3922171">x3</span><span class="op" id="3922173">,</span>&nbsp;<span class="ident" id="3922175">x3</span><span class="op" id="3922177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922180">x3</span><span class="op" id="3922182">.</span><span class="ident" id="3922183">Sub</span><span class="op" id="3922186">(</span><span class="ident" id="3922187">x3</span><span class="op" id="3922189">,</span>&nbsp;<span class="ident" id="3922191">j</span><span class="op" id="3922192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922195">x3</span><span class="op" id="3922197">.</span><span class="ident" id="3922198">Sub</span><span class="op" id="3922201">(</span><span class="ident" id="3922202">x3</span><span class="op" id="3922204">,</span>&nbsp;<span class="ident" id="3922206">v</span><span class="op" id="3922207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922210">x3</span><span class="op" id="3922212">.</span><span class="ident" id="3922213">Sub</span><span class="op" id="3922216">(</span><span class="ident" id="3922217">x3</span><span class="op" id="3922219">,</span>&nbsp;<span class="ident" id="3922221">v</span><span class="op" id="3922222">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922225">x3</span><span class="op" id="3922227">.</span><span class="ident" id="3922228">Mod</span><span class="op" id="3922231">(</span><span class="ident" id="3922232">x3</span><span class="op" id="3922234">,</span>&nbsp;<span class="ident" id="3922236">curve</span><span class="op" id="3922241">.</span><span class="ident" id="3922242">P</span><span class="op" id="3922243">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922247">y3</span><span class="op" id="3922249">.</span><span class="ident" id="3922250">Set</span><span class="op" id="3922253">(</span><span class="ident" id="3922254">r</span><span class="op" id="3922255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922258">v</span><span class="op" id="3922259">.</span><span class="ident" id="3922260">Sub</span><span class="op" id="3922263">(</span><span class="ident" id="3922264">v</span><span class="op" id="3922265">,</span>&nbsp;<span class="ident" id="3922267">x3</span><span class="op" id="3922269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922272">y3</span><span class="op" id="3922274">.</span><span class="ident" id="3922275">Mul</span><span class="op" id="3922278">(</span><span class="ident" id="3922279">y3</span><span class="op" id="3922281">,</span>&nbsp;<span class="ident" id="3922283">v</span><span class="op" id="3922284">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922287">s1</span><span class="op" id="3922289">.</span><span class="ident" id="3922290">Mul</span><span class="op" id="3922293">(</span><span class="ident" id="3922294">s1</span><span class="op" id="3922296">,</span>&nbsp;<span class="ident" id="3922298">j</span><span class="op" id="3922299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922302">s1</span><span class="op" id="3922304">.</span><span class="ident" id="3922305">Lsh</span><span class="op" id="3922308">(</span><span class="ident" id="3922309">s1</span><span class="op" id="3922311">,</span>&nbsp;<span class="num" id="3922313">1</span><span class="op" id="3922314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922317">y3</span><span class="op" id="3922319">.</span><span class="ident" id="3922320">Sub</span><span class="op" id="3922323">(</span><span class="ident" id="3922324">y3</span><span class="op" id="3922326">,</span>&nbsp;<span class="ident" id="3922328">s1</span><span class="op" id="3922330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922333">y3</span><span class="op" id="3922335">.</span><span class="ident" id="3922336">Mod</span><span class="op" id="3922339">(</span><span class="ident" id="3922340">y3</span><span class="op" id="3922342">,</span>&nbsp;<span class="ident" id="3922344">curve</span><span class="op" id="3922349">.</span><span class="ident" id="3922350">P</span><span class="op" id="3922351">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922355">z3</span><span class="op" id="3922357">.</span><span class="ident" id="3922358">Add</span><span class="op" id="3922361">(</span><span class="ident" id="3922362">z1</span><span class="op" id="3922364">,</span>&nbsp;<span class="ident" id="3922366">z2</span><span class="op" id="3922368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922371">z3</span><span class="op" id="3922373">.</span><span class="ident" id="3922374">Mul</span><span class="op" id="3922377">(</span><span class="ident" id="3922378">z3</span><span class="op" id="3922380">,</span>&nbsp;<span class="ident" id="3922382">z3</span><span class="op" id="3922384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922387">z3</span><span class="op" id="3922389">.</span><span class="ident" id="3922390">Sub</span><span class="op" id="3922393">(</span><span class="ident" id="3922394">z3</span><span class="op" id="3922396">,</span>&nbsp;<span class="ident" id="3922398">z1z1</span><span class="op" id="3922402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922405">z3</span><span class="op" id="3922407">.</span><span class="ident" id="3922408">Sub</span><span class="op" id="3922411">(</span><span class="ident" id="3922412">z3</span><span class="op" id="3922414">,</span>&nbsp;<span class="ident" id="3922416">z2z2</span><span class="op" id="3922420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922423">z3</span><span class="op" id="3922425">.</span><span class="ident" id="3922426">Mul</span><span class="op" id="3922429">(</span><span class="ident" id="3922430">z3</span><span class="op" id="3922432">,</span>&nbsp;<span class="ident" id="3922434">h</span><span class="op" id="3922435">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922438">z3</span><span class="op" id="3922440">.</span><span class="ident" id="3922441">Mod</span><span class="op" id="3922444">(</span><span class="ident" id="3922445">z3</span><span class="op" id="3922447">,</span>&nbsp;<span class="ident" id="3922449">curve</span><span class="op" id="3922454">.</span><span class="ident" id="3922455">P</span><span class="op" id="3922456">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3922460">return</span>&nbsp;<span class="ident" id="3922467">x3</span><span class="op" id="3922469">,</span>&nbsp;<span class="ident" id="3922471">y3</span><span class="op" id="3922473">,</span>&nbsp;<span class="ident" id="3922475">z3</span><br>
<span class="lineno"></span><span class="op" id="3922478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="3922481">func</span>&nbsp;<span class="op" id="3922486">(</span><span class="ident" id="3922487">curve</span>&nbsp;<span class="op" id="3922493">*</span><span class="ident" id="3922494">CurveParams</span><span class="op" id="3922505">)</span>&nbsp;<span class="ident" id="3922507">Double</span><span class="op" id="3922513">(</span><span class="ident" id="3922514">x1</span><span class="op" id="3922516">,</span>&nbsp;<span class="ident" id="3922518">y1</span>&nbsp;<span class="op" id="3922521">*</span><span class="ident" id="3922522">big</span><span class="op" id="3922525">.</span><span class="ident" id="3922526">Int</span><span class="op" id="3922529">)</span>&nbsp;<span class="op" id="3922531">(</span><span class="op" id="3922532">*</span><span class="ident" id="3922533">big</span><span class="op" id="3922536">.</span><span class="ident" id="3922537">Int</span><span class="op" id="3922540">,</span>&nbsp;<span class="op" id="3922542">*</span><span class="ident" id="3922543">big</span><span class="op" id="3922546">.</span><span class="ident" id="3922547">Int</span><span class="op" id="3922550">)</span>&nbsp;<span class="op" id="3922552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922555">z1</span>&nbsp;<span class="op" id="3922558">:=</span>&nbsp;<span class="ident" id="3922561">zForAffine</span><span class="op" id="3922571">(</span><span class="ident" id="3922572">x1</span><span class="op" id="3922574">,</span>&nbsp;<span class="ident" id="3922576">y1</span><span class="op" id="3922578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3922581">return</span>&nbsp;<span class="ident" id="3922588">curve</span><span class="op" id="3922593">.</span><span class="ident" id="3922594">affineFromJacobian</span><span class="op" id="3922612">(</span><span class="ident" id="3922613">curve</span><span class="op" id="3922618">.</span><span class="ident" id="3922619">doubleJacobian</span><span class="op" id="3922633">(</span><span class="ident" id="3922634">x1</span><span class="op" id="3922636">,</span>&nbsp;<span class="ident" id="3922638">y1</span><span class="op" id="3922640">,</span>&nbsp;<span class="ident" id="3922642">z1</span><span class="op" id="3922644">)</span><span class="op" id="3922645">)</span><br>
<span class="lineno"></span><span class="op" id="3922647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="3922650">//&nbsp;doubleJacobian&nbsp;takes&nbsp;a&nbsp;point&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x,&nbsp;y,&nbsp;z),&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3922722">//&nbsp;returns&nbsp;its&nbsp;double,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="3922768">func</span>&nbsp;<span class="op" id="3922773">(</span><span class="ident" id="3922774">curve</span>&nbsp;<span class="op" id="3922780">*</span><span class="ident" id="3922781">CurveParams</span><span class="op" id="3922792">)</span>&nbsp;<span class="ident" id="3922794">doubleJacobian</span><span class="op" id="3922808">(</span><span class="ident" id="3922809">x</span><span class="op" id="3922810">,</span>&nbsp;<span class="ident" id="3922812">y</span><span class="op" id="3922813">,</span>&nbsp;<span class="ident" id="3922815">z</span>&nbsp;<span class="op" id="3922817">*</span><span class="ident" id="3922818">big</span><span class="op" id="3922821">.</span><span class="ident" id="3922822">Int</span><span class="op" id="3922825">)</span>&nbsp;<span class="op" id="3922827">(</span><span class="op" id="3922828">*</span><span class="ident" id="3922829">big</span><span class="op" id="3922832">.</span><span class="ident" id="3922833">Int</span><span class="op" id="3922836">,</span>&nbsp;<span class="op" id="3922838">*</span><span class="ident" id="3922839">big</span><span class="op" id="3922842">.</span><span class="ident" id="3922843">Int</span><span class="op" id="3922846">,</span>&nbsp;<span class="op" id="3922848">*</span><span class="ident" id="3922849">big</span><span class="op" id="3922852">.</span><span class="ident" id="3922853">Int</span><span class="op" id="3922856">)</span>&nbsp;<span class="op" id="3922858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3922861">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#doubling-dbl-2001-b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922950">delta</span>&nbsp;<span class="op" id="3922956">:=</span>&nbsp;<span class="builtinfunc" id="3922959">new</span><span class="op" id="3922962">(</span><span class="ident" id="3922963">big</span><span class="op" id="3922966">.</span><span class="ident" id="3922967">Int</span><span class="op" id="3922970">)</span><span class="op" id="3922971">.</span><span class="ident" id="3922972">Mul</span><span class="op" id="3922975">(</span><span class="ident" id="3922976">z</span><span class="op" id="3922977">,</span>&nbsp;<span class="ident" id="3922979">z</span><span class="op" id="3922980">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3922983">delta</span><span class="op" id="3922988">.</span><span class="ident" id="3922989">Mod</span><span class="op" id="3922992">(</span><span class="ident" id="3922993">delta</span><span class="op" id="3922998">,</span>&nbsp;<span class="ident" id="3923000">curve</span><span class="op" id="3923005">.</span><span class="ident" id="3923006">P</span><span class="op" id="3923007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923010">gamma</span>&nbsp;<span class="op" id="3923016">:=</span>&nbsp;<span class="builtinfunc" id="3923019">new</span><span class="op" id="3923022">(</span><span class="ident" id="3923023">big</span><span class="op" id="3923026">.</span><span class="ident" id="3923027">Int</span><span class="op" id="3923030">)</span><span class="op" id="3923031">.</span><span class="ident" id="3923032">Mul</span><span class="op" id="3923035">(</span><span class="ident" id="3923036">y</span><span class="op" id="3923037">,</span>&nbsp;<span class="ident" id="3923039">y</span><span class="op" id="3923040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923043">gamma</span><span class="op" id="3923048">.</span><span class="ident" id="3923049">Mod</span><span class="op" id="3923052">(</span><span class="ident" id="3923053">gamma</span><span class="op" id="3923058">,</span>&nbsp;<span class="ident" id="3923060">curve</span><span class="op" id="3923065">.</span><span class="ident" id="3923066">P</span><span class="op" id="3923067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923070">alpha</span>&nbsp;<span class="op" id="3923076">:=</span>&nbsp;<span class="builtinfunc" id="3923079">new</span><span class="op" id="3923082">(</span><span class="ident" id="3923083">big</span><span class="op" id="3923086">.</span><span class="ident" id="3923087">Int</span><span class="op" id="3923090">)</span><span class="op" id="3923091">.</span><span class="ident" id="3923092">Sub</span><span class="op" id="3923095">(</span><span class="ident" id="3923096">x</span><span class="op" id="3923097">,</span>&nbsp;<span class="ident" id="3923099">delta</span><span class="op" id="3923104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3923107">if</span>&nbsp;<span class="ident" id="3923110">alpha</span><span class="op" id="3923115">.</span><span class="ident" id="3923116">Sign</span><span class="op" id="3923120">(</span><span class="op" id="3923121">)</span>&nbsp;<span class="op" id="3923123">==</span>&nbsp;<span class="op" id="3923126">-</span><span class="num" id="3923127">1</span>&nbsp;<span class="op" id="3923129">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923133">alpha</span><span class="op" id="3923138">.</span><span class="ident" id="3923139">Add</span><span class="op" id="3923142">(</span><span class="ident" id="3923143">alpha</span><span class="op" id="3923148">,</span>&nbsp;<span class="ident" id="3923150">curve</span><span class="op" id="3923155">.</span><span class="ident" id="3923156">P</span><span class="op" id="3923157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3923160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923163">alpha2</span>&nbsp;<span class="op" id="3923170">:=</span>&nbsp;<span class="builtinfunc" id="3923173">new</span><span class="op" id="3923176">(</span><span class="ident" id="3923177">big</span><span class="op" id="3923180">.</span><span class="ident" id="3923181">Int</span><span class="op" id="3923184">)</span><span class="op" id="3923185">.</span><span class="ident" id="3923186">Add</span><span class="op" id="3923189">(</span><span class="ident" id="3923190">x</span><span class="op" id="3923191">,</span>&nbsp;<span class="ident" id="3923193">delta</span><span class="op" id="3923198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923201">alpha</span><span class="op" id="3923206">.</span><span class="ident" id="3923207">Mul</span><span class="op" id="3923210">(</span><span class="ident" id="3923211">alpha</span><span class="op" id="3923216">,</span>&nbsp;<span class="ident" id="3923218">alpha2</span><span class="op" id="3923224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923227">alpha2</span><span class="op" id="3923233">.</span><span class="ident" id="3923234">Set</span><span class="op" id="3923237">(</span><span class="ident" id="3923238">alpha</span><span class="op" id="3923243">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923246">alpha</span><span class="op" id="3923251">.</span><span class="ident" id="3923252">Lsh</span><span class="op" id="3923255">(</span><span class="ident" id="3923256">alpha</span><span class="op" id="3923261">,</span>&nbsp;<span class="num" id="3923263">1</span><span class="op" id="3923264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923267">alpha</span><span class="op" id="3923272">.</span><span class="ident" id="3923273">Add</span><span class="op" id="3923276">(</span><span class="ident" id="3923277">alpha</span><span class="op" id="3923282">,</span>&nbsp;<span class="ident" id="3923284">alpha2</span><span class="op" id="3923290">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923294">beta</span>&nbsp;<span class="op" id="3923299">:=</span>&nbsp;<span class="ident" id="3923302">alpha2</span><span class="op" id="3923308">.</span><span class="ident" id="3923309">Mul</span><span class="op" id="3923312">(</span><span class="ident" id="3923313">x</span><span class="op" id="3923314">,</span>&nbsp;<span class="ident" id="3923316">gamma</span><span class="op" id="3923321">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923325">x3</span>&nbsp;<span class="op" id="3923328">:=</span>&nbsp;<span class="builtinfunc" id="3923331">new</span><span class="op" id="3923334">(</span><span class="ident" id="3923335">big</span><span class="op" id="3923338">.</span><span class="ident" id="3923339">Int</span><span class="op" id="3923342">)</span><span class="op" id="3923343">.</span><span class="ident" id="3923344">Mul</span><span class="op" id="3923347">(</span><span class="ident" id="3923348">alpha</span><span class="op" id="3923353">,</span>&nbsp;<span class="ident" id="3923355">alpha</span><span class="op" id="3923360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923363">beta8</span>&nbsp;<span class="op" id="3923369">:=</span>&nbsp;<span class="builtinfunc" id="3923372">new</span><span class="op" id="3923375">(</span><span class="ident" id="3923376">big</span><span class="op" id="3923379">.</span><span class="ident" id="3923380">Int</span><span class="op" id="3923383">)</span><span class="op" id="3923384">.</span><span class="ident" id="3923385">Lsh</span><span class="op" id="3923388">(</span><span class="ident" id="3923389">beta</span><span class="op" id="3923393">,</span>&nbsp;<span class="num" id="3923395">3</span><span class="op" id="3923396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923399">x3</span><span class="op" id="3923401">.</span><span class="ident" id="3923402">Sub</span><span class="op" id="3923405">(</span><span class="ident" id="3923406">x3</span><span class="op" id="3923408">,</span>&nbsp;<span class="ident" id="3923410">beta8</span><span class="op" id="3923415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3923418">for</span>&nbsp;<span class="ident" id="3923422">x3</span><span class="op" id="3923424">.</span><span class="ident" id="3923425">Sign</span><span class="op" id="3923429">(</span><span class="op" id="3923430">)</span>&nbsp;<span class="op" id="3923432">==</span>&nbsp;<span class="op" id="3923435">-</span><span class="num" id="3923436">1</span>&nbsp;<span class="op" id="3923438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923442">x3</span><span class="op" id="3923444">.</span><span class="ident" id="3923445">Add</span><span class="op" id="3923448">(</span><span class="ident" id="3923449">x3</span><span class="op" id="3923451">,</span>&nbsp;<span class="ident" id="3923453">curve</span><span class="op" id="3923458">.</span><span class="ident" id="3923459">P</span><span class="op" id="3923460">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3923463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923466">x3</span><span class="op" id="3923468">.</span><span class="ident" id="3923469">Mod</span><span class="op" id="3923472">(</span><span class="ident" id="3923473">x3</span><span class="op" id="3923475">,</span>&nbsp;<span class="ident" id="3923477">curve</span><span class="op" id="3923482">.</span><span class="ident" id="3923483">P</span><span class="op" id="3923484">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923488">z3</span>&nbsp;<span class="op" id="3923491">:=</span>&nbsp;<span class="builtinfunc" id="3923494">new</span><span class="op" id="3923497">(</span><span class="ident" id="3923498">big</span><span class="op" id="3923501">.</span><span class="ident" id="3923502">Int</span><span class="op" id="3923505">)</span><span class="op" id="3923506">.</span><span class="ident" id="3923507">Add</span><span class="op" id="3923510">(</span><span class="ident" id="3923511">y</span><span class="op" id="3923512">,</span>&nbsp;<span class="ident" id="3923514">z</span><span class="op" id="3923515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923518">z3</span><span class="op" id="3923520">.</span><span class="ident" id="3923521">Mul</span><span class="op" id="3923524">(</span><span class="ident" id="3923525">z3</span><span class="op" id="3923527">,</span>&nbsp;<span class="ident" id="3923529">z3</span><span class="op" id="3923531">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923534">z3</span><span class="op" id="3923536">.</span><span class="ident" id="3923537">Sub</span><span class="op" id="3923540">(</span><span class="ident" id="3923541">z3</span><span class="op" id="3923543">,</span>&nbsp;<span class="ident" id="3923545">gamma</span><span class="op" id="3923550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3923553">if</span>&nbsp;<span class="ident" id="3923556">z3</span><span class="op" id="3923558">.</span><span class="ident" id="3923559">Sign</span><span class="op" id="3923563">(</span><span class="op" id="3923564">)</span>&nbsp;<span class="op" id="3923566">==</span>&nbsp;<span class="op" id="3923569">-</span><span class="num" id="3923570">1</span>&nbsp;<span class="op" id="3923572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923576">z3</span><span class="op" id="3923578">.</span><span class="ident" id="3923579">Add</span><span class="op" id="3923582">(</span><span class="ident" id="3923583">z3</span><span class="op" id="3923585">,</span>&nbsp;<span class="ident" id="3923587">curve</span><span class="op" id="3923592">.</span><span class="ident" id="3923593">P</span><span class="op" id="3923594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3923597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923600">z3</span><span class="op" id="3923602">.</span><span class="ident" id="3923603">Sub</span><span class="op" id="3923606">(</span><span class="ident" id="3923607">z3</span><span class="op" id="3923609">,</span>&nbsp;<span class="ident" id="3923611">delta</span><span class="op" id="3923616">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3923619">if</span>&nbsp;<span class="ident" id="3923622">z3</span><span class="op" id="3923624">.</span><span class="ident" id="3923625">Sign</span><span class="op" id="3923629">(</span><span class="op" id="3923630">)</span>&nbsp;<span class="op" id="3923632">==</span>&nbsp;<span class="op" id="3923635">-</span><span class="num" id="3923636">1</span>&nbsp;<span class="op" id="3923638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923642">z3</span><span class="op" id="3923644">.</span><span class="ident" id="3923645">Add</span><span class="op" id="3923648">(</span><span class="ident" id="3923649">z3</span><span class="op" id="3923651">,</span>&nbsp;<span class="ident" id="3923653">curve</span><span class="op" id="3923658">.</span><span class="ident" id="3923659">P</span><span class="op" id="3923660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3923663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923666">z3</span><span class="op" id="3923668">.</span><span class="ident" id="3923669">Mod</span><span class="op" id="3923672">(</span><span class="ident" id="3923673">z3</span><span class="op" id="3923675">,</span>&nbsp;<span class="ident" id="3923677">curve</span><span class="op" id="3923682">.</span><span class="ident" id="3923683">P</span><span class="op" id="3923684">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923688">beta</span><span class="op" id="3923692">.</span><span class="ident" id="3923693">Lsh</span><span class="op" id="3923696">(</span><span class="ident" id="3923697">beta</span><span class="op" id="3923701">,</span>&nbsp;<span class="num" id="3923703">2</span><span class="op" id="3923704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923707">beta</span><span class="op" id="3923711">.</span><span class="ident" id="3923712">Sub</span><span class="op" id="3923715">(</span><span class="ident" id="3923716">beta</span><span class="op" id="3923720">,</span>&nbsp;<span class="ident" id="3923722">x3</span><span class="op" id="3923724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3923727">if</span>&nbsp;<span class="ident" id="3923730">beta</span><span class="op" id="3923734">.</span><span class="ident" id="3923735">Sign</span><span class="op" id="3923739">(</span><span class="op" id="3923740">)</span>&nbsp;<span class="op" id="3923742">==</span>&nbsp;<span class="op" id="3923745">-</span><span class="num" id="3923746">1</span>&nbsp;<span class="op" id="3923748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923752">beta</span><span class="op" id="3923756">.</span><span class="ident" id="3923757">Add</span><span class="op" id="3923760">(</span><span class="ident" id="3923761">beta</span><span class="op" id="3923765">,</span>&nbsp;<span class="ident" id="3923767">curve</span><span class="op" id="3923772">.</span><span class="ident" id="3923773">P</span><span class="op" id="3923774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3923777">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923780">y3</span>&nbsp;<span class="op" id="3923783">:=</span>&nbsp;<span class="ident" id="3923786">alpha</span><span class="op" id="3923791">.</span><span class="ident" id="3923792">Mul</span><span class="op" id="3923795">(</span><span class="ident" id="3923796">alpha</span><span class="op" id="3923801">,</span>&nbsp;<span class="ident" id="3923803">beta</span><span class="op" id="3923807">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923811">gamma</span><span class="op" id="3923816">.</span><span class="ident" id="3923817">Mul</span><span class="op" id="3923820">(</span><span class="ident" id="3923821">gamma</span><span class="op" id="3923826">,</span>&nbsp;<span class="ident" id="3923828">gamma</span><span class="op" id="3923833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923836">gamma</span><span class="op" id="3923841">.</span><span class="ident" id="3923842">Lsh</span><span class="op" id="3923845">(</span><span class="ident" id="3923846">gamma</span><span class="op" id="3923851">,</span>&nbsp;<span class="num" id="3923853">3</span><span class="op" id="3923854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923857">gamma</span><span class="op" id="3923862">.</span><span class="ident" id="3923863">Mod</span><span class="op" id="3923866">(</span><span class="ident" id="3923867">gamma</span><span class="op" id="3923872">,</span>&nbsp;<span class="ident" id="3923874">curve</span><span class="op" id="3923879">.</span><span class="ident" id="3923880">P</span><span class="op" id="3923881">)</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923885">y3</span><span class="op" id="3923887">.</span><span class="ident" id="3923888">Sub</span><span class="op" id="3923891">(</span><span class="ident" id="3923892">y3</span><span class="op" id="3923894">,</span>&nbsp;<span class="ident" id="3923896">gamma</span><span class="op" id="3923901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3923904">if</span>&nbsp;<span class="ident" id="3923907">y3</span><span class="op" id="3923909">.</span><span class="ident" id="3923910">Sign</span><span class="op" id="3923914">(</span><span class="op" id="3923915">)</span>&nbsp;<span class="op" id="3923917">==</span>&nbsp;<span class="op" id="3923920">-</span><span class="num" id="3923921">1</span>&nbsp;<span class="op" id="3923923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923927">y3</span><span class="op" id="3923929">.</span><span class="ident" id="3923930">Add</span><span class="op" id="3923933">(</span><span class="ident" id="3923934">y3</span><span class="op" id="3923936">,</span>&nbsp;<span class="ident" id="3923938">curve</span><span class="op" id="3923943">.</span><span class="ident" id="3923944">P</span><span class="op" id="3923945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3923948">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3923951">y3</span><span class="op" id="3923953">.</span><span class="ident" id="3923954">Mod</span><span class="op" id="3923957">(</span><span class="ident" id="3923958">y3</span><span class="op" id="3923960">,</span>&nbsp;<span class="ident" id="3923962">curve</span><span class="op" id="3923967">.</span><span class="ident" id="3923968">P</span><span class="op" id="3923969">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3923973">return</span>&nbsp;<span class="ident" id="3923980">x3</span><span class="op" id="3923982">,</span>&nbsp;<span class="ident" id="3923984">y3</span><span class="op" id="3923986">,</span>&nbsp;<span class="ident" id="3923988">z3</span><br>
<span class="lineno"></span><span class="op" id="3923991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="3923994">func</span>&nbsp;<span class="op" id="3923999">(</span><span class="ident" id="3924000">curve</span>&nbsp;<span class="op" id="3924006">*</span><span class="ident" id="3924007">CurveParams</span><span class="op" id="3924018">)</span>&nbsp;<span class="ident" id="3924020">ScalarMult</span><span class="op" id="3924030">(</span><span class="ident" id="3924031">Bx</span><span class="op" id="3924033">,</span>&nbsp;<span class="ident" id="3924035">By</span>&nbsp;<span class="op" id="3924038">*</span><span class="ident" id="3924039">big</span><span class="op" id="3924042">.</span><span class="ident" id="3924043">Int</span><span class="op" id="3924046">,</span>&nbsp;<span class="ident" id="3924048">k</span>&nbsp;<span class="op" id="3924050">[</span><span class="op" id="3924051">]</span><span class="builtintype" id="3924052">byte</span><span class="op" id="3924056">)</span>&nbsp;<span class="op" id="3924058">(</span><span class="op" id="3924059">*</span><span class="ident" id="3924060">big</span><span class="op" id="3924063">.</span><span class="ident" id="3924064">Int</span><span class="op" id="3924067">,</span>&nbsp;<span class="op" id="3924069">*</span><span class="ident" id="3924070">big</span><span class="op" id="3924073">.</span><span class="ident" id="3924074">Int</span><span class="op" id="3924077">)</span>&nbsp;<span class="op" id="3924079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3924082">Bz</span>&nbsp;<span class="op" id="3924085">:=</span>&nbsp;<span class="builtinfunc" id="3924088">new</span><span class="op" id="3924091">(</span><span class="ident" id="3924092">big</span><span class="op" id="3924095">.</span><span class="ident" id="3924096">Int</span><span class="op" id="3924099">)</span><span class="op" id="3924100">.</span><span class="ident" id="3924101">SetInt64</span><span class="op" id="3924109">(</span><span class="num" id="3924110">1</span><span class="op" id="3924111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3924114">x</span><span class="op" id="3924115">,</span>&nbsp;<span class="ident" id="3924117">y</span><span class="op" id="3924118">,</span>&nbsp;<span class="ident" id="3924120">z</span>&nbsp;<span class="op" id="3924122">:=</span>&nbsp;<span class="builtinfunc" id="3924125">new</span><span class="op" id="3924128">(</span><span class="ident" id="3924129">big</span><span class="op" id="3924132">.</span><span class="ident" id="3924133">Int</span><span class="op" id="3924136">)</span><span class="op" id="3924137">,</span>&nbsp;<span class="builtinfunc" id="3924139">new</span><span class="op" id="3924142">(</span><span class="ident" id="3924143">big</span><span class="op" id="3924146">.</span><span class="ident" id="3924147">Int</span><span class="op" id="3924150">)</span><span class="op" id="3924151">,</span>&nbsp;<span class="builtinfunc" id="3924153">new</span><span class="op" id="3924156">(</span><span class="ident" id="3924157">big</span><span class="op" id="3924160">.</span><span class="ident" id="3924161">Int</span><span class="op" id="3924164">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3924168">for</span>&nbsp;<span class="ident" id="3924172">_</span><span class="op" id="3924173">,</span>&nbsp;<span class="builtintype" id="3924175">byte</span>&nbsp;<span class="op" id="3924180">:=</span>&nbsp;<span class="keyword" id="3924183">range</span>&nbsp;<span class="ident" id="3924189">k</span>&nbsp;<span class="op" id="3924191">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3924195">for</span>&nbsp;<span class="ident" id="3924199">bitNum</span>&nbsp;<span class="op" id="3924206">:=</span>&nbsp;<span class="num" id="3924209">0</span><span class="op" id="3924210">;</span>&nbsp;<span class="ident" id="3924212">bitNum</span>&nbsp;<span class="op" id="3924219">&lt;</span>&nbsp;<span class="num" id="3924221">8</span><span class="op" id="3924222">;</span>&nbsp;<span class="ident" id="3924224">bitNum</span><span class="op" id="3924230">++</span>&nbsp;<span class="op" id="3924233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3924238">x</span><span class="op" id="3924239">,</span>&nbsp;<span class="ident" id="3924241">y</span><span class="op" id="3924242">,</span>&nbsp;<span class="ident" id="3924244">z</span>&nbsp;<span class="op" id="3924246">=</span>&nbsp;<span class="ident" id="3924248">curve</span><span class="op" id="3924253">.</span><span class="ident" id="3924254">doubleJacobian</span><span class="op" id="3924268">(</span><span class="ident" id="3924269">x</span><span class="op" id="3924270">,</span>&nbsp;<span class="ident" id="3924272">y</span><span class="op" id="3924273">,</span>&nbsp;<span class="ident" id="3924275">z</span><span class="op" id="3924276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3924281">if</span>&nbsp;<span class="builtintype" id="3924284">byte</span><span class="op" id="3924288">&amp;</span><span class="num" id="3924289">0x80</span>&nbsp;<span class="op" id="3924294">==</span>&nbsp;<span class="num" id="3924297">0x80</span>&nbsp;<span class="op" id="3924302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3924308">x</span><span class="op" id="3924309">,</span>&nbsp;<span class="ident" id="3924311">y</span><span class="op" id="3924312">,</span>&nbsp;<span class="ident" id="3924314">z</span>&nbsp;<span class="op" id="3924316">=</span>&nbsp;<span class="ident" id="3924318">curve</span><span class="op" id="3924323">.</span><span class="ident" id="3924324">addJacobian</span><span class="op" id="3924335">(</span><span class="ident" id="3924336">Bx</span><span class="op" id="3924338">,</span>&nbsp;<span class="ident" id="3924340">By</span><span class="op" id="3924342">,</span>&nbsp;<span class="ident" id="3924344">Bz</span><span class="op" id="3924346">,</span>&nbsp;<span class="ident" id="3924348">x</span><span class="op" id="3924349">,</span>&nbsp;<span class="ident" id="3924351">y</span><span class="op" id="3924352">,</span>&nbsp;<span class="ident" id="3924354">z</span><span class="op" id="3924355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3924360">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="3924365">byte</span>&nbsp;<span class="op" id="3924370">&lt;&lt;=</span>&nbsp;<span class="num" id="3924374">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3924378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3924381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3924385">return</span>&nbsp;<span class="ident" id="3924392">curve</span><span class="op" id="3924397">.</span><span class="ident" id="3924398">affineFromJacobian</span><span class="op" id="3924416">(</span><span class="ident" id="3924417">x</span><span class="op" id="3924418">,</span>&nbsp;<span class="ident" id="3924420">y</span><span class="op" id="3924421">,</span>&nbsp;<span class="ident" id="3924423">z</span><span class="op" id="3924424">)</span><br>
<span class="lineno">265</span><span class="op" id="3924426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3924429">func</span>&nbsp;<span class="op" id="3924434">(</span><span class="ident" id="3924435">curve</span>&nbsp;<span class="op" id="3924441">*</span><span class="ident" id="3924442">CurveParams</span><span class="op" id="3924453">)</span>&nbsp;<span class="ident" id="3924455">ScalarBaseMult</span><span class="op" id="3924469">(</span><span class="ident" id="3924470">k</span>&nbsp;<span class="op" id="3924472">[</span><span class="op" id="3924473">]</span><span class="builtintype" id="3924474">byte</span><span class="op" id="3924478">)</span>&nbsp;<span class="op" id="3924480">(</span><span class="op" id="3924481">*</span><span class="ident" id="3924482">big</span><span class="op" id="3924485">.</span><span class="ident" id="3924486">Int</span><span class="op" id="3924489">,</span>&nbsp;<span class="op" id="3924491">*</span><span class="ident" id="3924492">big</span><span class="op" id="3924495">.</span><span class="ident" id="3924496">Int</span><span class="op" id="3924499">)</span>&nbsp;<span class="op" id="3924501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3924504">return</span>&nbsp;<span class="ident" id="3924511">curve</span><span class="op" id="3924516">.</span><span class="ident" id="3924517">ScalarMult</span><span class="op" id="3924527">(</span><span class="ident" id="3924528">curve</span><span class="op" id="3924533">.</span><span class="ident" id="3924534">Gx</span><span class="op" id="3924536">,</span>&nbsp;<span class="ident" id="3924538">curve</span><span class="op" id="3924543">.</span><span class="ident" id="3924544">Gy</span><span class="op" id="3924546">,</span>&nbsp;<span class="ident" id="3924548">k</span><span class="op" id="3924549">)</span><br>
<span class="lineno"></span><span class="op" id="3924551">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="keyword" id="3924554">var</span>&nbsp;<span class="ident" id="3924558">mask</span>&nbsp;<span class="op" id="3924563">=</span>&nbsp;<span class="op" id="3924565">[</span><span class="op" id="3924566">]</span><span class="builtintype" id="3924567">byte</span><span class="op" id="3924571">{</span><span class="num" id="3924572">0xff</span><span class="op" id="3924576">,</span>&nbsp;<span class="num" id="3924578">0x1</span><span class="op" id="3924581">,</span>&nbsp;<span class="num" id="3924583">0x3</span><span class="op" id="3924586">,</span>&nbsp;<span class="num" id="3924588">0x7</span><span class="op" id="3924591">,</span>&nbsp;<span class="num" id="3924593">0xf</span><span class="op" id="3924596">,</span>&nbsp;<span class="num" id="3924598">0x1f</span><span class="op" id="3924602">,</span>&nbsp;<span class="num" id="3924604">0x3f</span><span class="op" id="3924608">,</span>&nbsp;<span class="num" id="3924610">0x7f</span><span class="op" id="3924614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3924617">//&nbsp;GenerateKey&nbsp;returns&nbsp;a&nbsp;public/private&nbsp;key&nbsp;pair.&nbsp;The&nbsp;private&nbsp;key&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3924686">//&nbsp;generated&nbsp;using&nbsp;the&nbsp;given&nbsp;reader,&nbsp;which&nbsp;must&nbsp;return&nbsp;random&nbsp;data.</span><br>
<span class="lineno">275</span><span class="keyword" id="3924754">func</span>&nbsp;<span class="ident" id="3924759">GenerateKey</span><span class="op" id="3924770">(</span><span class="ident" id="3924771">curve</span>&nbsp;<span class="ident" id="3924777">Curve</span><span class="op" id="3924782">,</span>&nbsp;<span class="ident" id="3924784">rand</span>&nbsp;<span class="ident" id="3924789">io</span><span class="op" id="3924791">.</span><span class="ident" id="3924792">Reader</span><span class="op" id="3924798">)</span>&nbsp;<span class="op" id="3924800">(</span><span class="ident" id="3924801">priv</span>&nbsp;<span class="op" id="3924806">[</span><span class="op" id="3924807">]</span><span class="builtintype" id="3924808">byte</span><span class="op" id="3924812">,</span>&nbsp;<span class="ident" id="3924814">x</span><span class="op" id="3924815">,</span>&nbsp;<span class="ident" id="3924817">y</span>&nbsp;<span class="op" id="3924819">*</span><span class="ident" id="3924820">big</span><span class="op" id="3924823">.</span><span class="ident" id="3924824">Int</span><span class="op" id="3924827">,</span>&nbsp;<span class="ident" id="3924829">err</span>&nbsp;<span class="builtintype" id="3924833">error</span><span class="op" id="3924838">)</span>&nbsp;<span class="op" id="3924840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3924843">bitSize</span>&nbsp;<span class="op" id="3924851">:=</span>&nbsp;<span class="ident" id="3924854">curve</span><span class="op" id="3924859">.</span><span class="ident" id="3924860">Params</span><span class="op" id="3924866">(</span><span class="op" id="3924867">)</span><span class="op" id="3924868">.</span><span class="ident" id="3924869">BitSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3924878">byteLen</span>&nbsp;<span class="op" id="3924886">:=</span>&nbsp;<span class="op" id="3924889">(</span><span class="ident" id="3924890">bitSize</span>&nbsp;<span class="op" id="3924898">+</span>&nbsp;<span class="num" id="3924900">7</span><span class="op" id="3924901">)</span>&nbsp;<span class="op" id="3924903">&gt;&gt;</span>&nbsp;<span class="num" id="3924906">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3924909">priv</span>&nbsp;<span class="op" id="3924914">=</span>&nbsp;<span class="builtinfunc" id="3924916">make</span><span class="op" id="3924920">(</span><span class="op" id="3924921">[</span><span class="op" id="3924922">]</span><span class="builtintype" id="3924923">byte</span><span class="op" id="3924927">,</span>&nbsp;<span class="ident" id="3924929">byteLen</span><span class="op" id="3924936">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3924940">for</span>&nbsp;<span class="ident" id="3924944">x</span>&nbsp;<span class="op" id="3924946">==</span>&nbsp;<span class="ident" id="3924949">nil</span>&nbsp;<span class="op" id="3924953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3924957">_</span><span class="op" id="3924958">,</span>&nbsp;<span class="ident" id="3924960">err</span>&nbsp;<span class="op" id="3924964">=</span>&nbsp;<span class="ident" id="3924966">io</span><span class="op" id="3924968">.</span><span class="ident" id="3924969">ReadFull</span><span class="op" id="3924977">(</span><span class="ident" id="3924978">rand</span><span class="op" id="3924982">,</span>&nbsp;<span class="ident" id="3924984">priv</span><span class="op" id="3924988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3924992">if</span>&nbsp;<span class="ident" id="3924995">err</span>&nbsp;<span class="op" id="3924999">!=</span>&nbsp;<span class="ident" id="3925002">nil</span>&nbsp;<span class="op" id="3925006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3925011">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3925020">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3925024">//&nbsp;We&nbsp;have&nbsp;to&nbsp;mask&nbsp;off&nbsp;any&nbsp;excess&nbsp;bits&nbsp;in&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;size&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3925098">//&nbsp;underlying&nbsp;field&nbsp;is&nbsp;not&nbsp;a&nbsp;whole&nbsp;number&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3925152">priv</span><span class="op" id="3925156">[</span><span class="num" id="3925157">0</span><span class="op" id="3925158">]</span>&nbsp;<span class="op" id="3925160">&amp;=</span>&nbsp;<span class="ident" id="3925163">mask</span><span class="op" id="3925167">[</span><span class="ident" id="3925168">bitSize</span><span class="op" id="3925175">%</span><span class="num" id="3925176">8</span><span class="op" id="3925177">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3925181">//&nbsp;This&nbsp;is&nbsp;because,&nbsp;in&nbsp;tests,&nbsp;rand&nbsp;will&nbsp;return&nbsp;all&nbsp;zeros&nbsp;and&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3925253">//&nbsp;want&nbsp;to&nbsp;get&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;and&nbsp;loop&nbsp;forever.</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3925310">priv</span><span class="op" id="3925314">[</span><span class="num" id="3925315">1</span><span class="op" id="3925316">]</span>&nbsp;<span class="op" id="3925318">^=</span>&nbsp;<span class="num" id="3925321">0x42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3925328">x</span><span class="op" id="3925329">,</span>&nbsp;<span class="ident" id="3925331">y</span>&nbsp;<span class="op" id="3925333">=</span>&nbsp;<span class="ident" id="3925335">curve</span><span class="op" id="3925340">.</span><span class="ident" id="3925341">ScalarBaseMult</span><span class="op" id="3925355">(</span><span class="ident" id="3925356">priv</span><span class="op" id="3925360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3925363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3925366">return</span><br>
<span class="lineno"></span><span class="op" id="3925373">}</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span><span class="comment" id="3925376">//&nbsp;Marshal&nbsp;converts&nbsp;a&nbsp;point&nbsp;into&nbsp;the&nbsp;form&nbsp;specified&nbsp;in&nbsp;section&nbsp;4.3.6&nbsp;of&nbsp;ANSI&nbsp;X9.62.</span><br>
<span class="lineno"></span><span class="keyword" id="3925460">func</span>&nbsp;<span class="ident" id="3925465">Marshal</span><span class="op" id="3925472">(</span><span class="ident" id="3925473">curve</span>&nbsp;<span class="ident" id="3925479">Curve</span><span class="op" id="3925484">,</span>&nbsp;<span class="ident" id="3925486">x</span><span class="op" id="3925487">,</span>&nbsp;<span class="ident" id="3925489">y</span>&nbsp;<span class="op" id="3925491">*</span><span class="ident" id="3925492">big</span><span class="op" id="3925495">.</span><span class="ident" id="3925496">Int</span><span class="op" id="3925499">)</span>&nbsp;<span class="op" id="3925501">[</span><span class="op" id="3925502">]</span><span class="builtintype" id="3925503">byte</span>&nbsp;<span class="op" id="3925508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3925511">byteLen</span>&nbsp;<span class="op" id="3925519">:=</span>&nbsp;<span class="op" id="3925522">(</span><span class="ident" id="3925523">curve</span><span class="op" id="3925528">.</span><span class="ident" id="3925529">Params</span><span class="op" id="3925535">(</span><span class="op" id="3925536">)</span><span class="op" id="3925537">.</span><span class="ident" id="3925538">BitSize</span>&nbsp;<span class="op" id="3925546">+</span>&nbsp;<span class="num" id="3925548">7</span><span class="op" id="3925549">)</span>&nbsp;<span class="op" id="3925551">&gt;&gt;</span>&nbsp;<span class="num" id="3925554">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3925558">ret</span>&nbsp;<span class="op" id="3925562">:=</span>&nbsp;<span class="builtinfunc" id="3925565">make</span><span class="op" id="3925569">(</span><span class="op" id="3925570">[</span><span class="op" id="3925571">]</span><span class="builtintype" id="3925572">byte</span><span class="op" id="3925576">,</span>&nbsp;<span class="num" id="3925578">1</span><span class="op" id="3925579">+</span><span class="num" id="3925580">2</span><span class="op" id="3925581">*</span><span class="ident" id="3925582">byteLen</span><span class="op" id="3925589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3925592">ret</span><span class="op" id="3925595">[</span><span class="num" id="3925596">0</span><span class="op" id="3925597">]</span>&nbsp;<span class="op" id="3925599">=</span>&nbsp;<span class="num" id="3925601">4</span>&nbsp;<span class="comment" id="3925603">//&nbsp;uncompressed&nbsp;point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3925627">xBytes</span>&nbsp;<span class="op" id="3925634">:=</span>&nbsp;<span class="ident" id="3925637">x</span><span class="op" id="3925638">.</span><span class="ident" id="3925639">Bytes</span><span class="op" id="3925644">(</span><span class="op" id="3925645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3925648">copy</span><span class="op" id="3925652">(</span><span class="ident" id="3925653">ret</span><span class="op" id="3925656">[</span><span class="num" id="3925657">1</span><span class="op" id="3925658">+</span><span class="ident" id="3925659">byteLen</span><span class="op" id="3925666">-</span><span class="builtinfunc" id="3925667">len</span><span class="op" id="3925670">(</span><span class="ident" id="3925671">xBytes</span><span class="op" id="3925677">)</span><span class="op" id="3925678">:</span><span class="op" id="3925679">]</span><span class="op" id="3925680">,</span>&nbsp;<span class="ident" id="3925682">xBytes</span><span class="op" id="3925688">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3925691">yBytes</span>&nbsp;<span class="op" id="3925698">:=</span>&nbsp;<span class="ident" id="3925701">y</span><span class="op" id="3925702">.</span><span class="ident" id="3925703">Bytes</span><span class="op" id="3925708">(</span><span class="op" id="3925709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3925712">copy</span><span class="op" id="3925716">(</span><span class="ident" id="3925717">ret</span><span class="op" id="3925720">[</span><span class="num" id="3925721">1</span><span class="op" id="3925722">+</span><span class="num" id="3925723">2</span><span class="op" id="3925724">*</span><span class="ident" id="3925725">byteLen</span><span class="op" id="3925732">-</span><span class="builtinfunc" id="3925733">len</span><span class="op" id="3925736">(</span><span class="ident" id="3925737">yBytes</span><span class="op" id="3925743">)</span><span class="op" id="3925744">:</span><span class="op" id="3925745">]</span><span class="op" id="3925746">,</span>&nbsp;<span class="ident" id="3925748">yBytes</span><span class="op" id="3925754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3925757">return</span>&nbsp;<span class="ident" id="3925764">ret</span><br>
<span class="lineno"></span><span class="op" id="3925768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="3925771">//&nbsp;Unmarshal&nbsp;converts&nbsp;a&nbsp;point,&nbsp;serialized&nbsp;by&nbsp;Marshal,&nbsp;into&nbsp;an&nbsp;x,&nbsp;y&nbsp;pair.&nbsp;On&nbsp;error,&nbsp;x&nbsp;=&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="3925863">func</span>&nbsp;<span class="ident" id="3925868">Unmarshal</span><span class="op" id="3925877">(</span><span class="ident" id="3925878">curve</span>&nbsp;<span class="ident" id="3925884">Curve</span><span class="op" id="3925889">,</span>&nbsp;<span class="ident" id="3925891">data</span>&nbsp;<span class="op" id="3925896">[</span><span class="op" id="3925897">]</span><span class="builtintype" id="3925898">byte</span><span class="op" id="3925902">)</span>&nbsp;<span class="op" id="3925904">(</span><span class="ident" id="3925905">x</span><span class="op" id="3925906">,</span>&nbsp;<span class="ident" id="3925908">y</span>&nbsp;<span class="op" id="3925910">*</span><span class="ident" id="3925911">big</span><span class="op" id="3925914">.</span><span class="ident" id="3925915">Int</span><span class="op" id="3925918">)</span>&nbsp;<span class="op" id="3925920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3925923">byteLen</span>&nbsp;<span class="op" id="3925931">:=</span>&nbsp;<span class="op" id="3925934">(</span><span class="ident" id="3925935">curve</span><span class="op" id="3925940">.</span><span class="ident" id="3925941">Params</span><span class="op" id="3925947">(</span><span class="op" id="3925948">)</span><span class="op" id="3925949">.</span><span class="ident" id="3925950">BitSize</span>&nbsp;<span class="op" id="3925958">+</span>&nbsp;<span class="num" id="3925960">7</span><span class="op" id="3925961">)</span>&nbsp;<span class="op" id="3925963">&gt;&gt;</span>&nbsp;<span class="num" id="3925966">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3925969">if</span>&nbsp;<span class="builtinfunc" id="3925972">len</span><span class="op" id="3925975">(</span><span class="ident" id="3925976">data</span><span class="op" id="3925980">)</span>&nbsp;<span class="op" id="3925982">!=</span>&nbsp;<span class="num" id="3925985">1</span><span class="op" id="3925986">+</span><span class="num" id="3925987">2</span><span class="op" id="3925988">*</span><span class="ident" id="3925989">byteLen</span>&nbsp;<span class="op" id="3925997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3926001">return</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3926009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3926012">if</span>&nbsp;<span class="ident" id="3926015">data</span><span class="op" id="3926019">[</span><span class="num" id="3926020">0</span><span class="op" id="3926021">]</span>&nbsp;<span class="op" id="3926023">!=</span>&nbsp;<span class="num" id="3926026">4</span>&nbsp;<span class="op" id="3926028">{</span>&nbsp;<span class="comment" id="3926030">//&nbsp;uncompressed&nbsp;form</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3926053">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3926061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3926064">x</span>&nbsp;<span class="op" id="3926066">=</span>&nbsp;<span class="builtinfunc" id="3926068">new</span><span class="op" id="3926071">(</span><span class="ident" id="3926072">big</span><span class="op" id="3926075">.</span><span class="ident" id="3926076">Int</span><span class="op" id="3926079">)</span><span class="op" id="3926080">.</span><span class="ident" id="3926081">SetBytes</span><span class="op" id="3926089">(</span><span class="ident" id="3926090">data</span><span class="op" id="3926094">[</span><span class="num" id="3926095">1</span>&nbsp;<span class="op" id="3926097">:</span>&nbsp;<span class="num" id="3926099">1</span><span class="op" id="3926100">+</span><span class="ident" id="3926101">byteLen</span><span class="op" id="3926108">]</span><span class="op" id="3926109">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3926112">y</span>&nbsp;<span class="op" id="3926114">=</span>&nbsp;<span class="builtinfunc" id="3926116">new</span><span class="op" id="3926119">(</span><span class="ident" id="3926120">big</span><span class="op" id="3926123">.</span><span class="ident" id="3926124">Int</span><span class="op" id="3926127">)</span><span class="op" id="3926128">.</span><span class="ident" id="3926129">SetBytes</span><span class="op" id="3926137">(</span><span class="ident" id="3926138">data</span><span class="op" id="3926142">[</span><span class="num" id="3926143">1</span><span class="op" id="3926144">+</span><span class="ident" id="3926145">byteLen</span><span class="op" id="3926152">:</span><span class="op" id="3926153">]</span><span class="op" id="3926154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3926157">return</span><br>
<span class="lineno"></span><span class="op" id="3926164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3926167">var</span>&nbsp;<span class="ident" id="3926171">initonce</span>&nbsp;<span class="ident" id="3926180">sync</span><span class="op" id="3926184">.</span><span class="ident" id="3926185">Once</span><br>
<span class="lineno">325</span><span class="keyword" id="3926190">var</span>&nbsp;<span class="ident" id="3926194">p384</span>&nbsp;<span class="op" id="3926199">*</span><span class="ident" id="3926200">CurveParams</span><br>
<span class="lineno"></span><span class="keyword" id="3926212">var</span>&nbsp;<span class="ident" id="3926216">p521</span>&nbsp;<span class="op" id="3926221">*</span><span class="ident" id="3926222">CurveParams</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3926235">func</span>&nbsp;<span class="ident" id="3926240">initAll</span><span class="op" id="3926247">(</span><span class="op" id="3926248">)</span>&nbsp;<span class="op" id="3926250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3926253">initP224</span><span class="op" id="3926261">(</span><span class="op" id="3926262">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3926265">initP256</span><span class="op" id="3926273">(</span><span class="op" id="3926274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3926277">initP384</span><span class="op" id="3926285">(</span><span class="op" id="3926286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3926289">initP521</span><span class="op" id="3926297">(</span><span class="op" id="3926298">)</span><br>
<span class="lineno"></span><span class="op" id="3926300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="3926303">func</span>&nbsp;<span class="ident" id="3926308">initP384</span><span class="op" id="3926316">(</span><span class="op" id="3926317">)</span>&nbsp;<span class="op" id="3926319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3926322">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3926356">p384</span>&nbsp;<span class="op" id="3926361">=</span>&nbsp;<span class="builtinfunc" id="3926363">new</span><span class="op" id="3926366">(</span><span class="ident" id="3926367">CurveParams</span><span class="op" id="3926378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3926381">p384</span><span class="op" id="3926385">.</span><span class="ident" id="3926386">P</span><span class="op" id="3926387">,</span>&nbsp;<span class="ident" id="3926389">_</span>&nbsp;<span class="op" id="3926391">=</span>&nbsp;<span class="builtinfunc" id="3926393">new</span><span class="op" id="3926396">(</span><span class="ident" id="3926397">big</span><span class="op" id="3926400">.</span><span class="ident" id="3926401">Int</span><span class="op" id="3926404">)</span><span class="op" id="3926405">.</span><span class="ident" id="3926406">SetString</span><span class="op" id="3926415">(</span><span class="string" id="3926416">&#34;39402006196394479212279040100143613805079739270465446667948293404245721771496870329047266088258938001861606973112319&#34;</span><span class="op" id="3926534">,</span>&nbsp;<span class="num" id="3926536">10</span><span class="op" id="3926538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3926541">p384</span><span class="op" id="3926545">.</span><span class="ident" id="3926546">N</span><span class="op" id="3926547">,</span>&nbsp;<span class="ident" id="3926549">_</span>&nbsp;<span class="op" id="3926551">=</span>&nbsp;<span class="builtinfunc" id="3926553">new</span><span class="op" id="3926556">(</span><span class="ident" id="3926557">big</span><span class="op" id="3926560">.</span><span class="ident" id="3926561">Int</span><span class="op" id="3926564">)</span><span class="op" id="3926565">.</span><span class="ident" id="3926566">SetString</span><span class="op" id="3926575">(</span><span class="string" id="3926576">&#34;39402006196394479212279040100143613805079739270465446667946905279627659399113263569398956308152294913554433653942643&#34;</span><span class="op" id="3926694">,</span>&nbsp;<span class="num" id="3926696">10</span><span class="op" id="3926698">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3926701">p384</span><span class="op" id="3926705">.</span><span class="ident" id="3926706">B</span><span class="op" id="3926707">,</span>&nbsp;<span class="ident" id="3926709">_</span>&nbsp;<span class="op" id="3926711">=</span>&nbsp;<span class="builtinfunc" id="3926713">new</span><span class="op" id="3926716">(</span><span class="ident" id="3926717">big</span><span class="op" id="3926720">.</span><span class="ident" id="3926721">Int</span><span class="op" id="3926724">)</span><span class="op" id="3926725">.</span><span class="ident" id="3926726">SetString</span><span class="op" id="3926735">(</span><span class="string" id="3926736">&#34;b3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef&#34;</span><span class="op" id="3926834">,</span>&nbsp;<span class="num" id="3926836">16</span><span class="op" id="3926838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3926841">p384</span><span class="op" id="3926845">.</span><span class="ident" id="3926846">Gx</span><span class="op" id="3926848">,</span>&nbsp;<span class="ident" id="3926850">_</span>&nbsp;<span class="op" id="3926852">=</span>&nbsp;<span class="builtinfunc" id="3926854">new</span><span class="op" id="3926857">(</span><span class="ident" id="3926858">big</span><span class="op" id="3926861">.</span><span class="ident" id="3926862">Int</span><span class="op" id="3926865">)</span><span class="op" id="3926866">.</span><span class="ident" id="3926867">SetString</span><span class="op" id="3926876">(</span><span class="string" id="3926877">&#34;aa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7&#34;</span><span class="op" id="3926975">,</span>&nbsp;<span class="num" id="3926977">16</span><span class="op" id="3926979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3926982">p384</span><span class="op" id="3926986">.</span><span class="ident" id="3926987">Gy</span><span class="op" id="3926989">,</span>&nbsp;<span class="ident" id="3926991">_</span>&nbsp;<span class="op" id="3926993">=</span>&nbsp;<span class="builtinfunc" id="3926995">new</span><span class="op" id="3926998">(</span><span class="ident" id="3926999">big</span><span class="op" id="3927002">.</span><span class="ident" id="3927003">Int</span><span class="op" id="3927006">)</span><span class="op" id="3927007">.</span><span class="ident" id="3927008">SetString</span><span class="op" id="3927017">(</span><span class="string" id="3927018">&#34;3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f&#34;</span><span class="op" id="3927116">,</span>&nbsp;<span class="num" id="3927118">16</span><span class="op" id="3927120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3927123">p384</span><span class="op" id="3927127">.</span><span class="ident" id="3927128">BitSize</span>&nbsp;<span class="op" id="3927136">=</span>&nbsp;<span class="num" id="3927138">384</span><br>
<span class="lineno"></span><span class="op" id="3927142">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="3927145">func</span>&nbsp;<span class="ident" id="3927150">initP521</span><span class="op" id="3927158">(</span><span class="op" id="3927159">)</span>&nbsp;<span class="op" id="3927161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3927164">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3927198">p521</span>&nbsp;<span class="op" id="3927203">=</span>&nbsp;<span class="builtinfunc" id="3927205">new</span><span class="op" id="3927208">(</span><span class="ident" id="3927209">CurveParams</span><span class="op" id="3927220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3927223">p521</span><span class="op" id="3927227">.</span><span class="ident" id="3927228">P</span><span class="op" id="3927229">,</span>&nbsp;<span class="ident" id="3927231">_</span>&nbsp;<span class="op" id="3927233">=</span>&nbsp;<span class="builtinfunc" id="3927235">new</span><span class="op" id="3927238">(</span><span class="ident" id="3927239">big</span><span class="op" id="3927242">.</span><span class="ident" id="3927243">Int</span><span class="op" id="3927246">)</span><span class="op" id="3927247">.</span><span class="ident" id="3927248">SetString</span><span class="op" id="3927257">(</span><span class="string" id="3927258">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151&#34;</span><span class="op" id="3927417">,</span>&nbsp;<span class="num" id="3927419">10</span><span class="op" id="3927421">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3927424">p521</span><span class="op" id="3927428">.</span><span class="ident" id="3927429">N</span><span class="op" id="3927430">,</span>&nbsp;<span class="ident" id="3927432">_</span>&nbsp;<span class="op" id="3927434">=</span>&nbsp;<span class="builtinfunc" id="3927436">new</span><span class="op" id="3927439">(</span><span class="ident" id="3927440">big</span><span class="op" id="3927443">.</span><span class="ident" id="3927444">Int</span><span class="op" id="3927447">)</span><span class="op" id="3927448">.</span><span class="ident" id="3927449">SetString</span><span class="op" id="3927458">(</span><span class="string" id="3927459">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397655394245057746333217197532963996371363321113864768612440380340372808892707005449&#34;</span><span class="op" id="3927618">,</span>&nbsp;<span class="num" id="3927620">10</span><span class="op" id="3927622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3927625">p521</span><span class="op" id="3927629">.</span><span class="ident" id="3927630">B</span><span class="op" id="3927631">,</span>&nbsp;<span class="ident" id="3927633">_</span>&nbsp;<span class="op" id="3927635">=</span>&nbsp;<span class="builtinfunc" id="3927637">new</span><span class="op" id="3927640">(</span><span class="ident" id="3927641">big</span><span class="op" id="3927644">.</span><span class="ident" id="3927645">Int</span><span class="op" id="3927648">)</span><span class="op" id="3927649">.</span><span class="ident" id="3927650">SetString</span><span class="op" id="3927659">(</span><span class="string" id="3927660">&#34;051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00&#34;</span><span class="op" id="3927793">,</span>&nbsp;<span class="num" id="3927795">16</span><span class="op" id="3927797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3927800">p521</span><span class="op" id="3927804">.</span><span class="ident" id="3927805">Gx</span><span class="op" id="3927807">,</span>&nbsp;<span class="ident" id="3927809">_</span>&nbsp;<span class="op" id="3927811">=</span>&nbsp;<span class="builtinfunc" id="3927813">new</span><span class="op" id="3927816">(</span><span class="ident" id="3927817">big</span><span class="op" id="3927820">.</span><span class="ident" id="3927821">Int</span><span class="op" id="3927824">)</span><span class="op" id="3927825">.</span><span class="ident" id="3927826">SetString</span><span class="op" id="3927835">(</span><span class="string" id="3927836">&#34;c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66&#34;</span><span class="op" id="3927968">,</span>&nbsp;<span class="num" id="3927970">16</span><span class="op" id="3927972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3927975">p521</span><span class="op" id="3927979">.</span><span class="ident" id="3927980">Gy</span><span class="op" id="3927982">,</span>&nbsp;<span class="ident" id="3927984">_</span>&nbsp;<span class="op" id="3927986">=</span>&nbsp;<span class="builtinfunc" id="3927988">new</span><span class="op" id="3927991">(</span><span class="ident" id="3927992">big</span><span class="op" id="3927995">.</span><span class="ident" id="3927996">Int</span><span class="op" id="3927999">)</span><span class="op" id="3928000">.</span><span class="ident" id="3928001">SetString</span><span class="op" id="3928010">(</span><span class="string" id="3928011">&#34;11839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650&#34;</span><span class="op" id="3928144">,</span>&nbsp;<span class="num" id="3928146">16</span><span class="op" id="3928148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3928151">p521</span><span class="op" id="3928155">.</span><span class="ident" id="3928156">BitSize</span>&nbsp;<span class="op" id="3928164">=</span>&nbsp;<span class="num" id="3928166">521</span><br>
<span class="lineno">355</span><span class="op" id="3928170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3928173">//&nbsp;P256&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-256&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.3)</span><br>
<span class="lineno"></span><span class="keyword" id="3928252">func</span>&nbsp;<span class="ident" id="3928257">P256</span><span class="op" id="3928261">(</span><span class="op" id="3928262">)</span>&nbsp;<span class="ident" id="3928264">Curve</span>&nbsp;<span class="op" id="3928270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3928273">initonce</span><span class="op" id="3928281">.</span><span class="ident" id="3928282">Do</span><span class="op" id="3928284">(</span><span class="ident" id="3928285">initAll</span><span class="op" id="3928292">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3928295">return</span>&nbsp;<span class="ident" id="3928302">p256</span><br>
<span class="lineno"></span><span class="op" id="3928307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3928310">//&nbsp;P384&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-384&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4)</span><br>
<span class="lineno"></span><span class="keyword" id="3928389">func</span>&nbsp;<span class="ident" id="3928394">P384</span><span class="op" id="3928398">(</span><span class="op" id="3928399">)</span>&nbsp;<span class="ident" id="3928401">Curve</span>&nbsp;<span class="op" id="3928407">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3928410">initonce</span><span class="op" id="3928418">.</span><span class="ident" id="3928419">Do</span><span class="op" id="3928421">(</span><span class="ident" id="3928422">initAll</span><span class="op" id="3928429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3928432">return</span>&nbsp;<span class="ident" id="3928439">p384</span><br>
<span class="lineno"></span><span class="op" id="3928444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3928447">//&nbsp;P521&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-521&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5)</span><br>
<span class="lineno">370</span><span class="keyword" id="3928526">func</span>&nbsp;<span class="ident" id="3928531">P521</span><span class="op" id="3928535">(</span><span class="op" id="3928536">)</span>&nbsp;<span class="ident" id="3928538">Curve</span>&nbsp;<span class="op" id="3928544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3928547">initonce</span><span class="op" id="3928555">.</span><span class="ident" id="3928556">Do</span><span class="op" id="3928558">(</span><span class="ident" id="3928559">initAll</span><span class="op" id="3928566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3928569">return</span>&nbsp;<span class="ident" id="3928576">p521</span><br>
<span class="lineno"></span><span class="op" id="3928581">}</span>
</div>
</body>
</html>
