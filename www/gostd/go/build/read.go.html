<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/build</h2>
<ul>
<li><a href="/gostd/go/build/build.go.html">build.go</a></li>
<li><a href="/gostd/go/build/build_test.go.html">build_test.go</a></li>
<li><a href="/gostd/go/build/deps_test.go.html">deps_test.go</a></li>
<li><a href="/gostd/go/build/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/build/read.go.html">read.go</a></li>
<li><a href="/gostd/go/build/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/go/build/syslist.go.html">syslist.go</a></li>
<li><a href="/gostd/go/build/syslist_test.go.html">syslist_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5801708">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5801764">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5801818">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5801869">package</span>&nbsp;<span class="ident" id="5801877">build</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5801884">import</span>&nbsp;<span class="op" id="5801891">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5801894">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5801903">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5801913">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="5801918">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5801921">type</span>&nbsp;<span class="ident" id="5801926">importReader</span>&nbsp;<span class="keyword" id="5801939">struct</span>&nbsp;<span class="op" id="5801946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5801949">b</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5801954">*</span><span class="ident" id="5801955">bufio</span><span class="op" id="5801960">.</span><span class="ident" id="5801961">Reader</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5801969">buf</span>&nbsp;&nbsp;<span class="op" id="5801974">[</span><span class="op" id="5801975">]</span><span class="builtintype" id="5801976">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5801982">peek</span>&nbsp;<span class="builtintype" id="5801987">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5801993">err</span>&nbsp;&nbsp;<span class="builtintype" id="5801998">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802005">eof</span>&nbsp;&nbsp;<span class="builtintype" id="5802010">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802016">nerr</span>&nbsp;<span class="builtintype" id="5802021">int</span><br>
<span class="lineno">20</span><span class="op" id="5802025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5802028">func</span>&nbsp;<span class="ident" id="5802033">isIdent</span><span class="op" id="5802040">(</span><span class="ident" id="5802041">c</span>&nbsp;<span class="builtintype" id="5802043">byte</span><span class="op" id="5802047">)</span>&nbsp;<span class="builtintype" id="5802049">bool</span>&nbsp;<span class="op" id="5802054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5802057">return</span>&nbsp;<span class="string" id="5802064">&#39;A&#39;</span>&nbsp;<span class="op" id="5802068">&lt;=</span>&nbsp;<span class="ident" id="5802071">c</span>&nbsp;<span class="op" id="5802073">&amp;&amp;</span>&nbsp;<span class="ident" id="5802076">c</span>&nbsp;<span class="op" id="5802078">&lt;=</span>&nbsp;<span class="string" id="5802081">&#39;Z&#39;</span>&nbsp;<span class="op" id="5802085">||</span>&nbsp;<span class="string" id="5802088">&#39;a&#39;</span>&nbsp;<span class="op" id="5802092">&lt;=</span>&nbsp;<span class="ident" id="5802095">c</span>&nbsp;<span class="op" id="5802097">&amp;&amp;</span>&nbsp;<span class="ident" id="5802100">c</span>&nbsp;<span class="op" id="5802102">&lt;=</span>&nbsp;<span class="string" id="5802105">&#39;z&#39;</span>&nbsp;<span class="op" id="5802109">||</span>&nbsp;<span class="string" id="5802112">&#39;0&#39;</span>&nbsp;<span class="op" id="5802116">&lt;=</span>&nbsp;<span class="ident" id="5802119">c</span>&nbsp;<span class="op" id="5802121">&amp;&amp;</span>&nbsp;<span class="ident" id="5802124">c</span>&nbsp;<span class="op" id="5802126">&lt;=</span>&nbsp;<span class="string" id="5802129">&#39;9&#39;</span>&nbsp;<span class="op" id="5802133">||</span>&nbsp;<span class="ident" id="5802136">c</span>&nbsp;<span class="op" id="5802138">==</span>&nbsp;<span class="string" id="5802141">&#39;_&#39;</span>&nbsp;<span class="op" id="5802145">||</span>&nbsp;<span class="ident" id="5802148">c</span>&nbsp;<span class="op" id="5802150">&gt;=</span>&nbsp;<span class="num" id="5802153">0x80</span><br>
<span class="lineno"></span><span class="op" id="5802158">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="5802161">var</span>&nbsp;<span class="op" id="5802165">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802168">errSyntax</span>&nbsp;<span class="op" id="5802178">=</span>&nbsp;<span class="ident" id="5802180">errors</span><span class="op" id="5802186">.</span><span class="ident" id="5802187">New</span><span class="op" id="5802190">(</span><span class="string" id="5802191">&#34;syntax&nbsp;error&#34;</span><span class="op" id="5802205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802208">errNUL</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5802218">=</span>&nbsp;<span class="ident" id="5802220">errors</span><span class="op" id="5802226">.</span><span class="ident" id="5802227">New</span><span class="op" id="5802230">(</span><span class="string" id="5802231">&#34;unexpected&nbsp;NUL&nbsp;in&nbsp;input&#34;</span><span class="op" id="5802256">)</span><br>
<span class="lineno"></span><span class="op" id="5802258">)</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5802261">//&nbsp;syntaxError&nbsp;records&nbsp;a&nbsp;syntax&nbsp;error,&nbsp;but&nbsp;only&nbsp;if&nbsp;an&nbsp;I/O&nbsp;error&nbsp;has&nbsp;not&nbsp;already&nbsp;been&nbsp;recorded.</span><br>
<span class="lineno"></span><span class="keyword" id="5802356">func</span>&nbsp;<span class="op" id="5802361">(</span><span class="ident" id="5802362">r</span>&nbsp;<span class="op" id="5802364">*</span><span class="ident" id="5802365">importReader</span><span class="op" id="5802377">)</span>&nbsp;<span class="ident" id="5802379">syntaxError</span><span class="op" id="5802390">(</span><span class="op" id="5802391">)</span>&nbsp;<span class="op" id="5802393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5802396">if</span>&nbsp;<span class="ident" id="5802399">r</span><span class="op" id="5802400">.</span><span class="ident" id="5802401">err</span>&nbsp;<span class="op" id="5802405">==</span>&nbsp;<span class="ident" id="5802408">nil</span>&nbsp;<span class="op" id="5802412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802416">r</span><span class="op" id="5802417">.</span><span class="ident" id="5802418">err</span>&nbsp;<span class="op" id="5802422">=</span>&nbsp;<span class="ident" id="5802424">errSyntax</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5802435">}</span><br>
<span class="lineno"></span><span class="op" id="5802437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5802440">//&nbsp;readByte&nbsp;reads&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input,&nbsp;saves&nbsp;it&nbsp;in&nbsp;buf,&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="5802521">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;readByte&nbsp;records&nbsp;the&nbsp;error&nbsp;in&nbsp;r.err&nbsp;and&nbsp;returns&nbsp;0.</span><br>
<span class="lineno">40</span><span class="keyword" id="5802595">func</span>&nbsp;<span class="op" id="5802600">(</span><span class="ident" id="5802601">r</span>&nbsp;<span class="op" id="5802603">*</span><span class="ident" id="5802604">importReader</span><span class="op" id="5802616">)</span>&nbsp;<span class="ident" id="5802618">readByte</span><span class="op" id="5802626">(</span><span class="op" id="5802627">)</span>&nbsp;<span class="builtintype" id="5802629">byte</span>&nbsp;<span class="op" id="5802634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802637">c</span><span class="op" id="5802638">,</span>&nbsp;<span class="ident" id="5802640">err</span>&nbsp;<span class="op" id="5802644">:=</span>&nbsp;<span class="ident" id="5802647">r</span><span class="op" id="5802648">.</span><span class="ident" id="5802649">b</span><span class="op" id="5802650">.</span><span class="ident" id="5802651">ReadByte</span><span class="op" id="5802659">(</span><span class="op" id="5802660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5802663">if</span>&nbsp;<span class="ident" id="5802666">err</span>&nbsp;<span class="op" id="5802670">==</span>&nbsp;<span class="ident" id="5802673">nil</span>&nbsp;<span class="op" id="5802677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802681">r</span><span class="op" id="5802682">.</span><span class="ident" id="5802683">buf</span>&nbsp;<span class="op" id="5802687">=</span>&nbsp;<span class="builtinfunc" id="5802689">append</span><span class="op" id="5802695">(</span><span class="ident" id="5802696">r</span><span class="op" id="5802697">.</span><span class="ident" id="5802698">buf</span><span class="op" id="5802701">,</span>&nbsp;<span class="ident" id="5802703">c</span><span class="op" id="5802704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5802708">if</span>&nbsp;<span class="ident" id="5802711">c</span>&nbsp;<span class="op" id="5802713">==</span>&nbsp;<span class="num" id="5802716">0</span>&nbsp;<span class="op" id="5802718">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802723">err</span>&nbsp;<span class="op" id="5802727">=</span>&nbsp;<span class="ident" id="5802729">errNUL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5802738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5802741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5802744">if</span>&nbsp;<span class="ident" id="5802747">err</span>&nbsp;<span class="op" id="5802751">!=</span>&nbsp;<span class="ident" id="5802754">nil</span>&nbsp;<span class="op" id="5802758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5802762">if</span>&nbsp;<span class="ident" id="5802765">err</span>&nbsp;<span class="op" id="5802769">==</span>&nbsp;<span class="ident" id="5802772">io</span><span class="op" id="5802774">.</span><span class="ident" id="5802775">EOF</span>&nbsp;<span class="op" id="5802779">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802784">r</span><span class="op" id="5802785">.</span><span class="ident" id="5802786">eof</span>&nbsp;<span class="op" id="5802790">=</span>&nbsp;<span class="builtintype" id="5802792">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5802799">}</span>&nbsp;<span class="keyword" id="5802801">else</span>&nbsp;<span class="keyword" id="5802806">if</span>&nbsp;<span class="ident" id="5802809">r</span><span class="op" id="5802810">.</span><span class="ident" id="5802811">err</span>&nbsp;<span class="op" id="5802815">==</span>&nbsp;<span class="ident" id="5802818">nil</span>&nbsp;<span class="op" id="5802822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802827">r</span><span class="op" id="5802828">.</span><span class="ident" id="5802829">err</span>&nbsp;<span class="op" id="5802833">=</span>&nbsp;<span class="ident" id="5802835">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5802841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5802845">c</span>&nbsp;<span class="op" id="5802847">=</span>&nbsp;<span class="num" id="5802849">0</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5802852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5802855">return</span>&nbsp;<span class="ident" id="5802862">c</span><br>
<span class="lineno"></span><span class="op" id="5802864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5802867">//&nbsp;peekByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input&nbsp;reader&nbsp;but&nbsp;does&nbsp;not&nbsp;advance&nbsp;beyond&nbsp;it.</span><br>
<span class="lineno">60</span><span class="comment" id="5802955">//&nbsp;If&nbsp;skipSpace&nbsp;is&nbsp;set,&nbsp;peekByte&nbsp;skips&nbsp;leading&nbsp;spaces&nbsp;and&nbsp;comments.</span><br>
<span class="lineno"></span><span class="keyword" id="5803023">func</span>&nbsp;<span class="op" id="5803028">(</span><span class="ident" id="5803029">r</span>&nbsp;<span class="op" id="5803031">*</span><span class="ident" id="5803032">importReader</span><span class="op" id="5803044">)</span>&nbsp;<span class="ident" id="5803046">peekByte</span><span class="op" id="5803054">(</span><span class="ident" id="5803055">skipSpace</span>&nbsp;<span class="builtintype" id="5803065">bool</span><span class="op" id="5803069">)</span>&nbsp;<span class="builtintype" id="5803071">byte</span>&nbsp;<span class="op" id="5803076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803079">if</span>&nbsp;<span class="ident" id="5803082">r</span><span class="op" id="5803083">.</span><span class="ident" id="5803084">err</span>&nbsp;<span class="op" id="5803088">!=</span>&nbsp;<span class="ident" id="5803091">nil</span>&nbsp;<span class="op" id="5803095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803099">if</span>&nbsp;<span class="ident" id="5803102">r</span><span class="op" id="5803103">.</span><span class="ident" id="5803104">nerr</span><span class="op" id="5803108">++</span><span class="op" id="5803110">;</span>&nbsp;<span class="ident" id="5803112">r</span><span class="op" id="5803113">.</span><span class="ident" id="5803114">nerr</span>&nbsp;<span class="op" id="5803119">&gt;</span>&nbsp;<span class="num" id="5803121">10000</span>&nbsp;<span class="op" id="5803127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5803132">panic</span><span class="op" id="5803137">(</span><span class="string" id="5803138">&#34;go/build:&nbsp;import&nbsp;reader&nbsp;looping&#34;</span><span class="op" id="5803171">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5803175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803179">return</span>&nbsp;<span class="num" id="5803186">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5803189">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5803193">//&nbsp;Use&nbsp;r.peek&nbsp;as&nbsp;first&nbsp;input&nbsp;byte.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5803229">//&nbsp;Don&#39;t&nbsp;just&nbsp;return&nbsp;r.peek&nbsp;here:&nbsp;it&nbsp;might&nbsp;have&nbsp;been&nbsp;left&nbsp;by&nbsp;peekByte(false)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5803307">//&nbsp;and&nbsp;this&nbsp;might&nbsp;be&nbsp;peekByte(true).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5803345">c</span>&nbsp;<span class="op" id="5803347">:=</span>&nbsp;<span class="ident" id="5803350">r</span><span class="op" id="5803351">.</span><span class="ident" id="5803352">peek</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803358">if</span>&nbsp;<span class="ident" id="5803361">c</span>&nbsp;<span class="op" id="5803363">==</span>&nbsp;<span class="num" id="5803366">0</span>&nbsp;<span class="op" id="5803368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5803372">c</span>&nbsp;<span class="op" id="5803374">=</span>&nbsp;<span class="ident" id="5803376">r</span><span class="op" id="5803377">.</span><span class="ident" id="5803378">readByte</span><span class="op" id="5803386">(</span><span class="op" id="5803387">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5803390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803393">for</span>&nbsp;<span class="ident" id="5803397">r</span><span class="op" id="5803398">.</span><span class="ident" id="5803399">err</span>&nbsp;<span class="op" id="5803403">==</span>&nbsp;<span class="ident" id="5803406">nil</span>&nbsp;<span class="op" id="5803410">&amp;&amp;</span>&nbsp;<span class="op" id="5803413">!</span><span class="ident" id="5803414">r</span><span class="op" id="5803415">.</span><span class="ident" id="5803416">eof</span>&nbsp;<span class="op" id="5803420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803424">if</span>&nbsp;<span class="ident" id="5803427">skipSpace</span>&nbsp;<span class="op" id="5803437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5803442">//&nbsp;For&nbsp;the&nbsp;purposes&nbsp;of&nbsp;this&nbsp;reader,&nbsp;semicolons&nbsp;are&nbsp;never&nbsp;necessary&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5803515">//&nbsp;understand&nbsp;the&nbsp;input&nbsp;and&nbsp;are&nbsp;treated&nbsp;as&nbsp;spaces.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803569">switch</span>&nbsp;<span class="ident" id="5803576">c</span>&nbsp;<span class="op" id="5803578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803583">case</span>&nbsp;<span class="string" id="5803588">&#39;&nbsp;&#39;</span><span class="op" id="5803591">,</span>&nbsp;<span class="string" id="5803593">&#39;\f&#39;</span><span class="op" id="5803597">,</span>&nbsp;<span class="string" id="5803599">&#39;\t&#39;</span><span class="op" id="5803603">,</span>&nbsp;<span class="string" id="5803605">&#39;\r&#39;</span><span class="op" id="5803609">,</span>&nbsp;<span class="string" id="5803611">&#39;\n&#39;</span><span class="op" id="5803615">,</span>&nbsp;<span class="string" id="5803617">&#39;;&#39;</span><span class="op" id="5803620">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5803626">c</span>&nbsp;<span class="op" id="5803628">=</span>&nbsp;<span class="ident" id="5803630">r</span><span class="op" id="5803631">.</span><span class="ident" id="5803632">readByte</span><span class="op" id="5803640">(</span><span class="op" id="5803641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803647">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803660">case</span>&nbsp;<span class="string" id="5803665">&#39;/&#39;</span><span class="op" id="5803668">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5803674">c</span>&nbsp;<span class="op" id="5803676">=</span>&nbsp;<span class="ident" id="5803678">r</span><span class="op" id="5803679">.</span><span class="ident" id="5803680">readByte</span><span class="op" id="5803688">(</span><span class="op" id="5803689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803695">if</span>&nbsp;<span class="ident" id="5803698">c</span>&nbsp;<span class="op" id="5803700">==</span>&nbsp;<span class="string" id="5803703">&#39;/&#39;</span>&nbsp;<span class="op" id="5803707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803714">for</span>&nbsp;<span class="ident" id="5803718">c</span>&nbsp;<span class="op" id="5803720">!=</span>&nbsp;<span class="string" id="5803723">&#39;\n&#39;</span>&nbsp;<span class="op" id="5803728">&amp;&amp;</span>&nbsp;<span class="ident" id="5803731">r</span><span class="op" id="5803732">.</span><span class="ident" id="5803733">err</span>&nbsp;<span class="op" id="5803737">==</span>&nbsp;<span class="ident" id="5803740">nil</span>&nbsp;<span class="op" id="5803744">&amp;&amp;</span>&nbsp;<span class="op" id="5803747">!</span><span class="ident" id="5803748">r</span><span class="op" id="5803749">.</span><span class="ident" id="5803750">eof</span>&nbsp;<span class="op" id="5803754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5803762">c</span>&nbsp;<span class="op" id="5803764">=</span>&nbsp;<span class="ident" id="5803766">r</span><span class="op" id="5803767">.</span><span class="ident" id="5803768">readByte</span><span class="op" id="5803776">(</span><span class="op" id="5803777">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5803784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5803790">}</span>&nbsp;<span class="keyword" id="5803792">else</span>&nbsp;<span class="keyword" id="5803797">if</span>&nbsp;<span class="ident" id="5803800">c</span>&nbsp;<span class="op" id="5803802">==</span>&nbsp;<span class="string" id="5803805">&#39;*&#39;</span>&nbsp;<span class="op" id="5803809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803816">var</span>&nbsp;<span class="ident" id="5803820">c1</span>&nbsp;<span class="builtintype" id="5803823">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803833">for</span>&nbsp;<span class="op" id="5803837">(</span><span class="ident" id="5803838">c</span>&nbsp;<span class="op" id="5803840">!=</span>&nbsp;<span class="string" id="5803843">&#39;*&#39;</span>&nbsp;<span class="op" id="5803847">||</span>&nbsp;<span class="ident" id="5803850">c1</span>&nbsp;<span class="op" id="5803853">!=</span>&nbsp;<span class="string" id="5803856">&#39;/&#39;</span><span class="op" id="5803859">)</span>&nbsp;<span class="op" id="5803861">&amp;&amp;</span>&nbsp;<span class="ident" id="5803864">r</span><span class="op" id="5803865">.</span><span class="ident" id="5803866">err</span>&nbsp;<span class="op" id="5803870">==</span>&nbsp;<span class="ident" id="5803873">nil</span>&nbsp;<span class="op" id="5803877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5803885">if</span>&nbsp;<span class="ident" id="5803888">r</span><span class="op" id="5803889">.</span><span class="ident" id="5803890">eof</span>&nbsp;<span class="op" id="5803894">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5803903">r</span><span class="op" id="5803904">.</span><span class="ident" id="5803905">syntaxError</span><span class="op" id="5803916">(</span><span class="op" id="5803917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5803925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5803933">c</span><span class="op" id="5803934">,</span>&nbsp;<span class="ident" id="5803936">c1</span>&nbsp;<span class="op" id="5803939">=</span>&nbsp;<span class="ident" id="5803941">c1</span><span class="op" id="5803943">,</span>&nbsp;<span class="ident" id="5803945">r</span><span class="op" id="5803946">.</span><span class="ident" id="5803947">readByte</span><span class="op" id="5803955">(</span><span class="op" id="5803956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5803963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5803969">}</span>&nbsp;<span class="keyword" id="5803971">else</span>&nbsp;<span class="op" id="5803976">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5803983">r</span><span class="op" id="5803984">.</span><span class="ident" id="5803985">syntaxError</span><span class="op" id="5803996">(</span><span class="op" id="5803997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5804003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5804009">c</span>&nbsp;<span class="op" id="5804011">=</span>&nbsp;<span class="ident" id="5804013">r</span><span class="op" id="5804014">.</span><span class="ident" id="5804015">readByte</span><span class="op" id="5804023">(</span><span class="op" id="5804024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5804030">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5804042">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5804046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5804050">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5804057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5804060">r</span><span class="op" id="5804061">.</span><span class="ident" id="5804062">peek</span>&nbsp;<span class="op" id="5804067">=</span>&nbsp;<span class="ident" id="5804069">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5804072">return</span>&nbsp;<span class="ident" id="5804079">r</span><span class="op" id="5804080">.</span><span class="ident" id="5804081">peek</span><br>
<span class="lineno">110</span><span class="op" id="5804086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5804089">//&nbsp;nextByte&nbsp;is&nbsp;like&nbsp;peekByte&nbsp;but&nbsp;advances&nbsp;beyond&nbsp;the&nbsp;returned&nbsp;byte.</span><br>
<span class="lineno"></span><span class="keyword" id="5804157">func</span>&nbsp;<span class="op" id="5804162">(</span><span class="ident" id="5804163">r</span>&nbsp;<span class="op" id="5804165">*</span><span class="ident" id="5804166">importReader</span><span class="op" id="5804178">)</span>&nbsp;<span class="ident" id="5804180">nextByte</span><span class="op" id="5804188">(</span><span class="ident" id="5804189">skipSpace</span>&nbsp;<span class="builtintype" id="5804199">bool</span><span class="op" id="5804203">)</span>&nbsp;<span class="builtintype" id="5804205">byte</span>&nbsp;<span class="op" id="5804210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5804213">c</span>&nbsp;<span class="op" id="5804215">:=</span>&nbsp;<span class="ident" id="5804218">r</span><span class="op" id="5804219">.</span><span class="ident" id="5804220">peekByte</span><span class="op" id="5804228">(</span><span class="ident" id="5804229">skipSpace</span><span class="op" id="5804238">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5804241">r</span><span class="op" id="5804242">.</span><span class="ident" id="5804243">peek</span>&nbsp;<span class="op" id="5804248">=</span>&nbsp;<span class="num" id="5804250">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5804253">return</span>&nbsp;<span class="ident" id="5804260">c</span><br>
<span class="lineno"></span><span class="op" id="5804262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5804265">//&nbsp;readKeyword&nbsp;reads&nbsp;the&nbsp;given&nbsp;keyword&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">120</span><span class="comment" id="5804320">//&nbsp;If&nbsp;the&nbsp;keyword&nbsp;is&nbsp;not&nbsp;present,&nbsp;readKeyword&nbsp;records&nbsp;a&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5804390">func</span>&nbsp;<span class="op" id="5804395">(</span><span class="ident" id="5804396">r</span>&nbsp;<span class="op" id="5804398">*</span><span class="ident" id="5804399">importReader</span><span class="op" id="5804411">)</span>&nbsp;<span class="ident" id="5804413">readKeyword</span><span class="op" id="5804424">(</span><span class="ident" id="5804425">kw</span>&nbsp;<span class="builtintype" id="5804428">string</span><span class="op" id="5804434">)</span>&nbsp;<span class="op" id="5804436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5804439">r</span><span class="op" id="5804440">.</span><span class="ident" id="5804441">peekByte</span><span class="op" id="5804449">(</span><span class="builtintype" id="5804450">true</span><span class="op" id="5804454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5804457">for</span>&nbsp;<span class="ident" id="5804461">i</span>&nbsp;<span class="op" id="5804463">:=</span>&nbsp;<span class="num" id="5804466">0</span><span class="op" id="5804467">;</span>&nbsp;<span class="ident" id="5804469">i</span>&nbsp;<span class="op" id="5804471">&lt;</span>&nbsp;<span class="builtinfunc" id="5804473">len</span><span class="op" id="5804476">(</span><span class="ident" id="5804477">kw</span><span class="op" id="5804479">)</span><span class="op" id="5804480">;</span>&nbsp;<span class="ident" id="5804482">i</span><span class="op" id="5804483">++</span>&nbsp;<span class="op" id="5804486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5804490">if</span>&nbsp;<span class="ident" id="5804493">r</span><span class="op" id="5804494">.</span><span class="ident" id="5804495">nextByte</span><span class="op" id="5804503">(</span><span class="builtintype" id="5804504">false</span><span class="op" id="5804509">)</span>&nbsp;<span class="op" id="5804511">!=</span>&nbsp;<span class="ident" id="5804514">kw</span><span class="op" id="5804516">[</span><span class="ident" id="5804517">i</span><span class="op" id="5804518">]</span>&nbsp;<span class="op" id="5804520">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5804525">r</span><span class="op" id="5804526">.</span><span class="ident" id="5804527">syntaxError</span><span class="op" id="5804538">(</span><span class="op" id="5804539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5804544">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5804553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5804556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5804559">if</span>&nbsp;<span class="ident" id="5804562">isIdent</span><span class="op" id="5804569">(</span><span class="ident" id="5804570">r</span><span class="op" id="5804571">.</span><span class="ident" id="5804572">peekByte</span><span class="op" id="5804580">(</span><span class="builtintype" id="5804581">false</span><span class="op" id="5804586">)</span><span class="op" id="5804587">)</span>&nbsp;<span class="op" id="5804589">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5804593">r</span><span class="op" id="5804594">.</span><span class="ident" id="5804595">syntaxError</span><span class="op" id="5804606">(</span><span class="op" id="5804607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5804610">}</span><br>
<span class="lineno"></span><span class="op" id="5804612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5804615">//&nbsp;readIdent&nbsp;reads&nbsp;an&nbsp;identifier&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">135</span><span class="comment" id="5804664">//&nbsp;If&nbsp;an&nbsp;identifier&nbsp;is&nbsp;not&nbsp;present,&nbsp;readIdent&nbsp;records&nbsp;a&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5804734">func</span>&nbsp;<span class="op" id="5804739">(</span><span class="ident" id="5804740">r</span>&nbsp;<span class="op" id="5804742">*</span><span class="ident" id="5804743">importReader</span><span class="op" id="5804755">)</span>&nbsp;<span class="ident" id="5804757">readIdent</span><span class="op" id="5804766">(</span><span class="op" id="5804767">)</span>&nbsp;<span class="op" id="5804769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5804772">c</span>&nbsp;<span class="op" id="5804774">:=</span>&nbsp;<span class="ident" id="5804777">r</span><span class="op" id="5804778">.</span><span class="ident" id="5804779">peekByte</span><span class="op" id="5804787">(</span><span class="builtintype" id="5804788">true</span><span class="op" id="5804792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5804795">if</span>&nbsp;<span class="op" id="5804798">!</span><span class="ident" id="5804799">isIdent</span><span class="op" id="5804806">(</span><span class="ident" id="5804807">c</span><span class="op" id="5804808">)</span>&nbsp;<span class="op" id="5804810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5804814">r</span><span class="op" id="5804815">.</span><span class="ident" id="5804816">syntaxError</span><span class="op" id="5804827">(</span><span class="op" id="5804828">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5804832">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5804840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5804843">for</span>&nbsp;<span class="ident" id="5804847">isIdent</span><span class="op" id="5804854">(</span><span class="ident" id="5804855">r</span><span class="op" id="5804856">.</span><span class="ident" id="5804857">peekByte</span><span class="op" id="5804865">(</span><span class="builtintype" id="5804866">false</span><span class="op" id="5804871">)</span><span class="op" id="5804872">)</span>&nbsp;<span class="op" id="5804874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5804878">r</span><span class="op" id="5804879">.</span><span class="ident" id="5804880">peek</span>&nbsp;<span class="op" id="5804885">=</span>&nbsp;<span class="num" id="5804887">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5804890">}</span><br>
<span class="lineno">145</span><span class="op" id="5804892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5804895">//&nbsp;readString&nbsp;reads&nbsp;a&nbsp;quoted&nbsp;string&nbsp;literal&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="5804955">//&nbsp;If&nbsp;an&nbsp;identifier&nbsp;is&nbsp;not&nbsp;present,&nbsp;readString&nbsp;records&nbsp;a&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5805026">func</span>&nbsp;<span class="op" id="5805031">(</span><span class="ident" id="5805032">r</span>&nbsp;<span class="op" id="5805034">*</span><span class="ident" id="5805035">importReader</span><span class="op" id="5805047">)</span>&nbsp;<span class="ident" id="5805049">readString</span><span class="op" id="5805059">(</span><span class="op" id="5805060">)</span>&nbsp;<span class="op" id="5805062">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805065">switch</span>&nbsp;<span class="ident" id="5805072">r</span><span class="op" id="5805073">.</span><span class="ident" id="5805074">nextByte</span><span class="op" id="5805082">(</span><span class="builtintype" id="5805083">true</span><span class="op" id="5805087">)</span>&nbsp;<span class="op" id="5805089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805092">case</span>&nbsp;<span class="string" id="5805097">&#39;`&#39;</span><span class="op" id="5805100">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805104">for</span>&nbsp;<span class="ident" id="5805108">r</span><span class="op" id="5805109">.</span><span class="ident" id="5805110">err</span>&nbsp;<span class="op" id="5805114">==</span>&nbsp;<span class="ident" id="5805117">nil</span>&nbsp;<span class="op" id="5805121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805126">if</span>&nbsp;<span class="ident" id="5805129">r</span><span class="op" id="5805130">.</span><span class="ident" id="5805131">nextByte</span><span class="op" id="5805139">(</span><span class="builtintype" id="5805140">false</span><span class="op" id="5805145">)</span>&nbsp;<span class="op" id="5805147">==</span>&nbsp;<span class="string" id="5805150">&#39;`&#39;</span>&nbsp;<span class="op" id="5805154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805160">break</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5805169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805174">if</span>&nbsp;<span class="ident" id="5805177">r</span><span class="op" id="5805178">.</span><span class="ident" id="5805179">eof</span>&nbsp;<span class="op" id="5805183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5805189">r</span><span class="op" id="5805190">.</span><span class="ident" id="5805191">syntaxError</span><span class="op" id="5805202">(</span><span class="op" id="5805203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5805208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5805212">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805215">case</span>&nbsp;<span class="string" id="5805220">&#39;&#34;&#39;</span><span class="op" id="5805223">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805227">for</span>&nbsp;<span class="ident" id="5805231">r</span><span class="op" id="5805232">.</span><span class="ident" id="5805233">err</span>&nbsp;<span class="op" id="5805237">==</span>&nbsp;<span class="ident" id="5805240">nil</span>&nbsp;<span class="op" id="5805244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5805249">c</span>&nbsp;<span class="op" id="5805251">:=</span>&nbsp;<span class="ident" id="5805254">r</span><span class="op" id="5805255">.</span><span class="ident" id="5805256">nextByte</span><span class="op" id="5805264">(</span><span class="builtintype" id="5805265">false</span><span class="op" id="5805270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805275">if</span>&nbsp;<span class="ident" id="5805278">c</span>&nbsp;<span class="op" id="5805280">==</span>&nbsp;<span class="string" id="5805283">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5805287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805293">break</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5805302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805307">if</span>&nbsp;<span class="ident" id="5805310">r</span><span class="op" id="5805311">.</span><span class="ident" id="5805312">eof</span>&nbsp;<span class="op" id="5805316">||</span>&nbsp;<span class="ident" id="5805319">c</span>&nbsp;<span class="op" id="5805321">==</span>&nbsp;<span class="string" id="5805324">&#39;\n&#39;</span>&nbsp;<span class="op" id="5805329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5805335">r</span><span class="op" id="5805336">.</span><span class="ident" id="5805337">syntaxError</span><span class="op" id="5805348">(</span><span class="op" id="5805349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5805354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805359">if</span>&nbsp;<span class="ident" id="5805362">c</span>&nbsp;<span class="op" id="5805364">==</span>&nbsp;<span class="string" id="5805367">&#39;\\&#39;</span>&nbsp;<span class="op" id="5805372">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5805378">r</span><span class="op" id="5805379">.</span><span class="ident" id="5805380">nextByte</span><span class="op" id="5805388">(</span><span class="builtintype" id="5805389">false</span><span class="op" id="5805394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5805399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5805403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805406">default</span><span class="op" id="5805413">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5805417">r</span><span class="op" id="5805418">.</span><span class="ident" id="5805419">syntaxError</span><span class="op" id="5805430">(</span><span class="op" id="5805431">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5805434">}</span><br>
<span class="lineno"></span><span class="op" id="5805436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5805439">//&nbsp;readImport&nbsp;reads&nbsp;an&nbsp;import&nbsp;clause&nbsp;-&nbsp;optional&nbsp;identifier&nbsp;followed&nbsp;by&nbsp;quoted&nbsp;string&nbsp;-</span><br>
<span class="lineno"></span><span class="comment" id="5805526">//&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">180</span><span class="keyword" id="5805545">func</span>&nbsp;<span class="op" id="5805550">(</span><span class="ident" id="5805551">r</span>&nbsp;<span class="op" id="5805553">*</span><span class="ident" id="5805554">importReader</span><span class="op" id="5805566">)</span>&nbsp;<span class="ident" id="5805568">readImport</span><span class="op" id="5805578">(</span><span class="op" id="5805579">)</span>&nbsp;<span class="op" id="5805581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5805584">c</span>&nbsp;<span class="op" id="5805586">:=</span>&nbsp;<span class="ident" id="5805589">r</span><span class="op" id="5805590">.</span><span class="ident" id="5805591">peekByte</span><span class="op" id="5805599">(</span><span class="builtintype" id="5805600">true</span><span class="op" id="5805604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805607">if</span>&nbsp;<span class="ident" id="5805610">c</span>&nbsp;<span class="op" id="5805612">==</span>&nbsp;<span class="string" id="5805615">&#39;.&#39;</span>&nbsp;<span class="op" id="5805619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5805623">r</span><span class="op" id="5805624">.</span><span class="ident" id="5805625">peek</span>&nbsp;<span class="op" id="5805630">=</span>&nbsp;<span class="num" id="5805632">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5805635">}</span>&nbsp;<span class="keyword" id="5805637">else</span>&nbsp;<span class="keyword" id="5805642">if</span>&nbsp;<span class="ident" id="5805645">isIdent</span><span class="op" id="5805652">(</span><span class="ident" id="5805653">c</span><span class="op" id="5805654">)</span>&nbsp;<span class="op" id="5805656">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5805660">r</span><span class="op" id="5805661">.</span><span class="ident" id="5805662">readIdent</span><span class="op" id="5805671">(</span><span class="op" id="5805672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5805675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5805678">r</span><span class="op" id="5805679">.</span><span class="ident" id="5805680">readString</span><span class="op" id="5805690">(</span><span class="op" id="5805691">)</span><br>
<span class="lineno"></span><span class="op" id="5805693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="5805696">//&nbsp;readComments&nbsp;is&nbsp;like&nbsp;ioutil.ReadAll,&nbsp;except&nbsp;that&nbsp;it&nbsp;only&nbsp;reads&nbsp;the&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="5805774">//&nbsp;block&nbsp;of&nbsp;comments&nbsp;in&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5805808">func</span>&nbsp;<span class="ident" id="5805813">readComments</span><span class="op" id="5805825">(</span><span class="ident" id="5805826">f</span>&nbsp;<span class="ident" id="5805828">io</span><span class="op" id="5805830">.</span><span class="ident" id="5805831">Reader</span><span class="op" id="5805837">)</span>&nbsp;<span class="op" id="5805839">(</span><span class="op" id="5805840">[</span><span class="op" id="5805841">]</span><span class="builtintype" id="5805842">byte</span><span class="op" id="5805846">,</span>&nbsp;<span class="builtintype" id="5805848">error</span><span class="op" id="5805853">)</span>&nbsp;<span class="op" id="5805855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5805858">r</span>&nbsp;<span class="op" id="5805860">:=</span>&nbsp;<span class="op" id="5805863">&amp;</span><span class="ident" id="5805864">importReader</span><span class="op" id="5805876">{</span><span class="ident" id="5805877">b</span><span class="op" id="5805878">:</span>&nbsp;<span class="ident" id="5805880">bufio</span><span class="op" id="5805885">.</span><span class="ident" id="5805886">NewReader</span><span class="op" id="5805895">(</span><span class="ident" id="5805896">f</span><span class="op" id="5805897">)</span><span class="op" id="5805898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5805901">r</span><span class="op" id="5805902">.</span><span class="ident" id="5805903">peekByte</span><span class="op" id="5805911">(</span><span class="builtintype" id="5805912">true</span><span class="op" id="5805916">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5805919">if</span>&nbsp;<span class="ident" id="5805922">r</span><span class="op" id="5805923">.</span><span class="ident" id="5805924">err</span>&nbsp;<span class="op" id="5805928">==</span>&nbsp;<span class="ident" id="5805931">nil</span>&nbsp;<span class="op" id="5805935">&amp;&amp;</span>&nbsp;<span class="op" id="5805938">!</span><span class="ident" id="5805939">r</span><span class="op" id="5805940">.</span><span class="ident" id="5805941">eof</span>&nbsp;<span class="op" id="5805945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5805949">//&nbsp;Didn&#39;t&nbsp;reach&nbsp;EOF,&nbsp;so&nbsp;must&nbsp;have&nbsp;found&nbsp;a&nbsp;non-space&nbsp;byte.&nbsp;Remove&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5806020">r</span><span class="op" id="5806021">.</span><span class="ident" id="5806022">buf</span>&nbsp;<span class="op" id="5806026">=</span>&nbsp;<span class="ident" id="5806028">r</span><span class="op" id="5806029">.</span><span class="ident" id="5806030">buf</span><span class="op" id="5806033">[</span><span class="op" id="5806034">:</span><span class="builtinfunc" id="5806035">len</span><span class="op" id="5806038">(</span><span class="ident" id="5806039">r</span><span class="op" id="5806040">.</span><span class="ident" id="5806041">buf</span><span class="op" id="5806044">)</span><span class="op" id="5806045">-</span><span class="num" id="5806046">1</span><span class="op" id="5806047">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5806050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5806053">return</span>&nbsp;<span class="ident" id="5806060">r</span><span class="op" id="5806061">.</span><span class="ident" id="5806062">buf</span><span class="op" id="5806065">,</span>&nbsp;<span class="ident" id="5806067">r</span><span class="op" id="5806068">.</span><span class="ident" id="5806069">err</span><br>
<span class="lineno">200</span><span class="op" id="5806073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5806076">//&nbsp;readImports&nbsp;is&nbsp;like&nbsp;ioutil.ReadAll,&nbsp;except&nbsp;that&nbsp;it&nbsp;expects&nbsp;a&nbsp;Go&nbsp;file&nbsp;as&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="5806157">//&nbsp;and&nbsp;stops&nbsp;reading&nbsp;the&nbsp;input&nbsp;once&nbsp;the&nbsp;imports&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="keyword" id="5806221">func</span>&nbsp;<span class="ident" id="5806226">readImports</span><span class="op" id="5806237">(</span><span class="ident" id="5806238">f</span>&nbsp;<span class="ident" id="5806240">io</span><span class="op" id="5806242">.</span><span class="ident" id="5806243">Reader</span><span class="op" id="5806249">,</span>&nbsp;<span class="ident" id="5806251">reportSyntaxError</span>&nbsp;<span class="builtintype" id="5806269">bool</span><span class="op" id="5806273">)</span>&nbsp;<span class="op" id="5806275">(</span><span class="op" id="5806276">[</span><span class="op" id="5806277">]</span><span class="builtintype" id="5806278">byte</span><span class="op" id="5806282">,</span>&nbsp;<span class="builtintype" id="5806284">error</span><span class="op" id="5806289">)</span>&nbsp;<span class="op" id="5806291">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5806294">r</span>&nbsp;<span class="op" id="5806296">:=</span>&nbsp;<span class="op" id="5806299">&amp;</span><span class="ident" id="5806300">importReader</span><span class="op" id="5806312">{</span><span class="ident" id="5806313">b</span><span class="op" id="5806314">:</span>&nbsp;<span class="ident" id="5806316">bufio</span><span class="op" id="5806321">.</span><span class="ident" id="5806322">NewReader</span><span class="op" id="5806331">(</span><span class="ident" id="5806332">f</span><span class="op" id="5806333">)</span><span class="op" id="5806334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5806338">r</span><span class="op" id="5806339">.</span><span class="ident" id="5806340">readKeyword</span><span class="op" id="5806351">(</span><span class="string" id="5806352">&#34;package&#34;</span><span class="op" id="5806361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5806364">r</span><span class="op" id="5806365">.</span><span class="ident" id="5806366">readIdent</span><span class="op" id="5806375">(</span><span class="op" id="5806376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5806379">for</span>&nbsp;<span class="ident" id="5806383">r</span><span class="op" id="5806384">.</span><span class="ident" id="5806385">peekByte</span><span class="op" id="5806393">(</span><span class="builtintype" id="5806394">true</span><span class="op" id="5806398">)</span>&nbsp;<span class="op" id="5806400">==</span>&nbsp;<span class="string" id="5806403">&#39;i&#39;</span>&nbsp;<span class="op" id="5806407">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5806411">r</span><span class="op" id="5806412">.</span><span class="ident" id="5806413">readKeyword</span><span class="op" id="5806424">(</span><span class="string" id="5806425">&#34;import&#34;</span><span class="op" id="5806433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5806437">if</span>&nbsp;<span class="ident" id="5806440">r</span><span class="op" id="5806441">.</span><span class="ident" id="5806442">peekByte</span><span class="op" id="5806450">(</span><span class="builtintype" id="5806451">true</span><span class="op" id="5806455">)</span>&nbsp;<span class="op" id="5806457">==</span>&nbsp;<span class="string" id="5806460">&#39;(&#39;</span>&nbsp;<span class="op" id="5806464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5806469">r</span><span class="op" id="5806470">.</span><span class="ident" id="5806471">nextByte</span><span class="op" id="5806479">(</span><span class="builtintype" id="5806480">false</span><span class="op" id="5806485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5806490">for</span>&nbsp;<span class="ident" id="5806494">r</span><span class="op" id="5806495">.</span><span class="ident" id="5806496">peekByte</span><span class="op" id="5806504">(</span><span class="builtintype" id="5806505">true</span><span class="op" id="5806509">)</span>&nbsp;<span class="op" id="5806511">!=</span>&nbsp;<span class="string" id="5806514">&#39;)&#39;</span>&nbsp;<span class="op" id="5806518">&amp;&amp;</span>&nbsp;<span class="ident" id="5806521">r</span><span class="op" id="5806522">.</span><span class="ident" id="5806523">err</span>&nbsp;<span class="op" id="5806527">==</span>&nbsp;<span class="ident" id="5806530">nil</span>&nbsp;<span class="op" id="5806534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5806540">r</span><span class="op" id="5806541">.</span><span class="ident" id="5806542">readImport</span><span class="op" id="5806552">(</span><span class="op" id="5806553">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5806558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5806563">r</span><span class="op" id="5806564">.</span><span class="ident" id="5806565">nextByte</span><span class="op" id="5806573">(</span><span class="builtintype" id="5806574">false</span><span class="op" id="5806579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5806583">}</span>&nbsp;<span class="keyword" id="5806585">else</span>&nbsp;<span class="op" id="5806590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5806595">r</span><span class="op" id="5806596">.</span><span class="ident" id="5806597">readImport</span><span class="op" id="5806607">(</span><span class="op" id="5806608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5806612">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5806615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5806619">//&nbsp;If&nbsp;we&nbsp;stopped&nbsp;successfully&nbsp;before&nbsp;EOF,&nbsp;we&nbsp;read&nbsp;a&nbsp;byte&nbsp;that&nbsp;told&nbsp;us&nbsp;we&nbsp;were&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5806704">//&nbsp;Return&nbsp;all&nbsp;but&nbsp;that&nbsp;last&nbsp;byte,&nbsp;which&nbsp;would&nbsp;cause&nbsp;a&nbsp;syntax&nbsp;error&nbsp;if&nbsp;we&nbsp;let&nbsp;it&nbsp;through.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5806794">if</span>&nbsp;<span class="ident" id="5806797">r</span><span class="op" id="5806798">.</span><span class="ident" id="5806799">err</span>&nbsp;<span class="op" id="5806803">==</span>&nbsp;<span class="ident" id="5806806">nil</span>&nbsp;<span class="op" id="5806810">&amp;&amp;</span>&nbsp;<span class="op" id="5806813">!</span><span class="ident" id="5806814">r</span><span class="op" id="5806815">.</span><span class="ident" id="5806816">eof</span>&nbsp;<span class="op" id="5806820">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5806824">return</span>&nbsp;<span class="ident" id="5806831">r</span><span class="op" id="5806832">.</span><span class="ident" id="5806833">buf</span><span class="op" id="5806836">[</span><span class="op" id="5806837">:</span><span class="builtinfunc" id="5806838">len</span><span class="op" id="5806841">(</span><span class="ident" id="5806842">r</span><span class="op" id="5806843">.</span><span class="ident" id="5806844">buf</span><span class="op" id="5806847">)</span><span class="op" id="5806848">-</span><span class="num" id="5806849">1</span><span class="op" id="5806850">]</span><span class="op" id="5806851">,</span>&nbsp;<span class="ident" id="5806853">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5806858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5806862">//&nbsp;If&nbsp;we&nbsp;stopped&nbsp;for&nbsp;a&nbsp;syntax&nbsp;error,&nbsp;consume&nbsp;the&nbsp;whole&nbsp;file&nbsp;so&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5806931">//&nbsp;we&nbsp;are&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;change&nbsp;the&nbsp;errors&nbsp;that&nbsp;go/parser&nbsp;returns.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5806998">if</span>&nbsp;<span class="ident" id="5807001">r</span><span class="op" id="5807002">.</span><span class="ident" id="5807003">err</span>&nbsp;<span class="op" id="5807007">==</span>&nbsp;<span class="ident" id="5807010">errSyntax</span>&nbsp;<span class="op" id="5807020">&amp;&amp;</span>&nbsp;<span class="op" id="5807023">!</span><span class="ident" id="5807024">reportSyntaxError</span>&nbsp;<span class="op" id="5807042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5807046">r</span><span class="op" id="5807047">.</span><span class="ident" id="5807048">err</span>&nbsp;<span class="op" id="5807052">=</span>&nbsp;<span class="ident" id="5807054">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5807060">for</span>&nbsp;<span class="ident" id="5807064">r</span><span class="op" id="5807065">.</span><span class="ident" id="5807066">err</span>&nbsp;<span class="op" id="5807070">==</span>&nbsp;<span class="ident" id="5807073">nil</span>&nbsp;<span class="op" id="5807077">&amp;&amp;</span>&nbsp;<span class="op" id="5807080">!</span><span class="ident" id="5807081">r</span><span class="op" id="5807082">.</span><span class="ident" id="5807083">eof</span>&nbsp;<span class="op" id="5807087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5807092">r</span><span class="op" id="5807093">.</span><span class="ident" id="5807094">readByte</span><span class="op" id="5807102">(</span><span class="op" id="5807103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5807107">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5807110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5807114">return</span>&nbsp;<span class="ident" id="5807121">r</span><span class="op" id="5807122">.</span><span class="ident" id="5807123">buf</span><span class="op" id="5807126">,</span>&nbsp;<span class="ident" id="5807128">r</span><span class="op" id="5807129">.</span><span class="ident" id="5807130">err</span><br>
<span class="lineno"></span><span class="op" id="5807134">}</span>
</div>
</body>
</html>
