<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7212219">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7212274">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7212328">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7212379">package</span>&nbsp;<span class="ident" id="7212387">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7212393">import</span>&nbsp;<span class="op" id="7212400">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7212403">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7212412">&#34;crypto/dsa&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7212426">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7212442">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7212461">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7212476">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212490">_</span>&nbsp;<span class="string" id="7212492">&#34;crypto/sha256&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212509">_</span>&nbsp;<span class="string" id="7212511">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7212528">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7212548">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7212565">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7212584">&#34;encoding/hex&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7212600">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7212616">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7212628">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7212635">&#34;os/exec&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7212646">&#34;reflect&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7212657">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7212668">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7212679">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7212686">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="7212689">func</span>&nbsp;<span class="ident" id="7212694">TestParsePKCS1PrivateKey</span><span class="op" id="7212718">(</span><span class="ident" id="7212719">t</span>&nbsp;<span class="op" id="7212721">*</span><span class="ident" id="7212722">testing</span><span class="op" id="7212729">.</span><span class="ident" id="7212730">T</span><span class="op" id="7212731">)</span>&nbsp;<span class="op" id="7212733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212736">block</span><span class="op" id="7212741">,</span>&nbsp;<span class="ident" id="7212743">_</span>&nbsp;<span class="op" id="7212745">:=</span>&nbsp;<span class="ident" id="7212748">pem</span><span class="op" id="7212751">.</span><span class="ident" id="7212752">Decode</span><span class="op" id="7212758">(</span><span class="op" id="7212759">[</span><span class="op" id="7212760">]</span><span class="builtintype" id="7212761">byte</span><span class="op" id="7212765">(</span><span class="ident" id="7212766">pemPrivateKey</span><span class="op" id="7212779">)</span><span class="op" id="7212780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212783">priv</span><span class="op" id="7212787">,</span>&nbsp;<span class="ident" id="7212789">err</span>&nbsp;<span class="op" id="7212793">:=</span>&nbsp;<span class="ident" id="7212796">ParsePKCS1PrivateKey</span><span class="op" id="7212816">(</span><span class="ident" id="7212817">block</span><span class="op" id="7212822">.</span><span class="ident" id="7212823">Bytes</span><span class="op" id="7212828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7212831">if</span>&nbsp;<span class="ident" id="7212834">err</span>&nbsp;<span class="op" id="7212838">!=</span>&nbsp;<span class="ident" id="7212841">nil</span>&nbsp;<span class="op" id="7212845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212849">t</span><span class="op" id="7212850">.</span><span class="ident" id="7212851">Errorf</span><span class="op" id="7212857">(</span><span class="string" id="7212858">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7212891">,</span>&nbsp;<span class="ident" id="7212893">err</span><span class="op" id="7212896">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7212900">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7212908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7212911">if</span>&nbsp;<span class="ident" id="7212914">priv</span><span class="op" id="7212918">.</span><span class="ident" id="7212919">PublicKey</span><span class="op" id="7212928">.</span><span class="ident" id="7212929">N</span><span class="op" id="7212930">.</span><span class="ident" id="7212931">Cmp</span><span class="op" id="7212934">(</span><span class="ident" id="7212935">rsaPrivateKey</span><span class="op" id="7212948">.</span><span class="ident" id="7212949">PublicKey</span><span class="op" id="7212958">.</span><span class="ident" id="7212959">N</span><span class="op" id="7212960">)</span>&nbsp;<span class="op" id="7212962">!=</span>&nbsp;<span class="num" id="7212965">0</span>&nbsp;<span class="op" id="7212967">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7212972">priv</span><span class="op" id="7212976">.</span><span class="ident" id="7212977">PublicKey</span><span class="op" id="7212986">.</span><span class="ident" id="7212987">E</span>&nbsp;<span class="op" id="7212989">!=</span>&nbsp;<span class="ident" id="7212992">rsaPrivateKey</span><span class="op" id="7213005">.</span><span class="ident" id="7213006">PublicKey</span><span class="op" id="7213015">.</span><span class="ident" id="7213016">E</span>&nbsp;<span class="op" id="7213018">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7213023">priv</span><span class="op" id="7213027">.</span><span class="ident" id="7213028">D</span><span class="op" id="7213029">.</span><span class="ident" id="7213030">Cmp</span><span class="op" id="7213033">(</span><span class="ident" id="7213034">rsaPrivateKey</span><span class="op" id="7213047">.</span><span class="ident" id="7213048">D</span><span class="op" id="7213049">)</span>&nbsp;<span class="op" id="7213051">!=</span>&nbsp;<span class="num" id="7213054">0</span>&nbsp;<span class="op" id="7213056">||</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7213061">priv</span><span class="op" id="7213065">.</span><span class="ident" id="7213066">Primes</span><span class="op" id="7213072">[</span><span class="num" id="7213073">0</span><span class="op" id="7213074">]</span><span class="op" id="7213075">.</span><span class="ident" id="7213076">Cmp</span><span class="op" id="7213079">(</span><span class="ident" id="7213080">rsaPrivateKey</span><span class="op" id="7213093">.</span><span class="ident" id="7213094">Primes</span><span class="op" id="7213100">[</span><span class="num" id="7213101">0</span><span class="op" id="7213102">]</span><span class="op" id="7213103">)</span>&nbsp;<span class="op" id="7213105">!=</span>&nbsp;<span class="num" id="7213108">0</span>&nbsp;<span class="op" id="7213110">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7213115">priv</span><span class="op" id="7213119">.</span><span class="ident" id="7213120">Primes</span><span class="op" id="7213126">[</span><span class="num" id="7213127">1</span><span class="op" id="7213128">]</span><span class="op" id="7213129">.</span><span class="ident" id="7213130">Cmp</span><span class="op" id="7213133">(</span><span class="ident" id="7213134">rsaPrivateKey</span><span class="op" id="7213147">.</span><span class="ident" id="7213148">Primes</span><span class="op" id="7213154">[</span><span class="num" id="7213155">1</span><span class="op" id="7213156">]</span><span class="op" id="7213157">)</span>&nbsp;<span class="op" id="7213159">!=</span>&nbsp;<span class="num" id="7213162">0</span>&nbsp;<span class="op" id="7213164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7213168">t</span><span class="op" id="7213169">.</span><span class="ident" id="7213170">Errorf</span><span class="op" id="7213176">(</span><span class="string" id="7213177">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="7213195">,</span>&nbsp;<span class="ident" id="7213197">priv</span><span class="op" id="7213201">,</span>&nbsp;<span class="ident" id="7213203">rsaPrivateKey</span><span class="op" id="7213216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7213219">}</span><br>
<span class="lineno"></span><span class="op" id="7213221">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7213224">func</span>&nbsp;<span class="ident" id="7213229">TestParsePKIXPublicKey</span><span class="op" id="7213251">(</span><span class="ident" id="7213252">t</span>&nbsp;<span class="op" id="7213254">*</span><span class="ident" id="7213255">testing</span><span class="op" id="7213262">.</span><span class="ident" id="7213263">T</span><span class="op" id="7213264">)</span>&nbsp;<span class="op" id="7213266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7213269">block</span><span class="op" id="7213274">,</span>&nbsp;<span class="ident" id="7213276">_</span>&nbsp;<span class="op" id="7213278">:=</span>&nbsp;<span class="ident" id="7213281">pem</span><span class="op" id="7213284">.</span><span class="ident" id="7213285">Decode</span><span class="op" id="7213291">(</span><span class="op" id="7213292">[</span><span class="op" id="7213293">]</span><span class="builtintype" id="7213294">byte</span><span class="op" id="7213298">(</span><span class="ident" id="7213299">pemPublicKey</span><span class="op" id="7213311">)</span><span class="op" id="7213312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7213315">pub</span><span class="op" id="7213318">,</span>&nbsp;<span class="ident" id="7213320">err</span>&nbsp;<span class="op" id="7213324">:=</span>&nbsp;<span class="ident" id="7213327">ParsePKIXPublicKey</span><span class="op" id="7213345">(</span><span class="ident" id="7213346">block</span><span class="op" id="7213351">.</span><span class="ident" id="7213352">Bytes</span><span class="op" id="7213357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7213360">if</span>&nbsp;<span class="ident" id="7213363">err</span>&nbsp;<span class="op" id="7213367">!=</span>&nbsp;<span class="ident" id="7213370">nil</span>&nbsp;<span class="op" id="7213374">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7213378">t</span><span class="op" id="7213379">.</span><span class="ident" id="7213380">Errorf</span><span class="op" id="7213386">(</span><span class="string" id="7213387">&#34;Failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;public&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7213423">,</span>&nbsp;<span class="ident" id="7213425">err</span><span class="op" id="7213428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7213432">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7213440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7213443">rsaPub</span><span class="op" id="7213449">,</span>&nbsp;<span class="ident" id="7213451">ok</span>&nbsp;<span class="op" id="7213454">:=</span>&nbsp;<span class="ident" id="7213457">pub</span><span class="op" id="7213460">.</span><span class="op" id="7213461">(</span><span class="op" id="7213462">*</span><span class="ident" id="7213463">rsa</span><span class="op" id="7213466">.</span><span class="ident" id="7213467">PublicKey</span><span class="op" id="7213476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7213479">if</span>&nbsp;<span class="op" id="7213482">!</span><span class="ident" id="7213483">ok</span>&nbsp;<span class="op" id="7213486">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7213490">t</span><span class="op" id="7213491">.</span><span class="ident" id="7213492">Errorf</span><span class="op" id="7213498">(</span><span class="string" id="7213499">&#34;Value&nbsp;returned&nbsp;from&nbsp;ParsePKIXPublicKey&nbsp;was&nbsp;not&nbsp;an&nbsp;RSA&nbsp;public&nbsp;key&#34;</span><span class="op" id="7213565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7213569">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7213577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7213581">pubBytes2</span><span class="op" id="7213590">,</span>&nbsp;<span class="ident" id="7213592">err</span>&nbsp;<span class="op" id="7213596">:=</span>&nbsp;<span class="ident" id="7213599">MarshalPKIXPublicKey</span><span class="op" id="7213619">(</span><span class="ident" id="7213620">rsaPub</span><span class="op" id="7213626">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7213629">if</span>&nbsp;<span class="ident" id="7213632">err</span>&nbsp;<span class="op" id="7213636">!=</span>&nbsp;<span class="ident" id="7213639">nil</span>&nbsp;<span class="op" id="7213643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7213647">t</span><span class="op" id="7213648">.</span><span class="ident" id="7213649">Errorf</span><span class="op" id="7213655">(</span><span class="string" id="7213656">&#34;Failed&nbsp;to&nbsp;marshal&nbsp;RSA&nbsp;public&nbsp;key&nbsp;for&nbsp;the&nbsp;second&nbsp;time:&nbsp;%s&#34;</span><span class="op" id="7213714">,</span>&nbsp;<span class="ident" id="7213716">err</span><span class="op" id="7213719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7213723">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7213731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7213734">if</span>&nbsp;<span class="op" id="7213737">!</span><span class="ident" id="7213738">bytes</span><span class="op" id="7213743">.</span><span class="ident" id="7213744">Equal</span><span class="op" id="7213749">(</span><span class="ident" id="7213750">pubBytes2</span><span class="op" id="7213759">,</span>&nbsp;<span class="ident" id="7213761">block</span><span class="op" id="7213766">.</span><span class="ident" id="7213767">Bytes</span><span class="op" id="7213772">)</span>&nbsp;<span class="op" id="7213774">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7213778">t</span><span class="op" id="7213779">.</span><span class="ident" id="7213780">Errorf</span><span class="op" id="7213786">(</span><span class="string" id="7213787">&#34;Reserialization&nbsp;of&nbsp;public&nbsp;key&nbsp;didn&#39;t&nbsp;match.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="7213848">,</span>&nbsp;<span class="ident" id="7213850">pubBytes2</span><span class="op" id="7213859">,</span>&nbsp;<span class="ident" id="7213861">block</span><span class="op" id="7213866">.</span><span class="ident" id="7213867">Bytes</span><span class="op" id="7213872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7213875">}</span><br>
<span class="lineno"></span><span class="op" id="7213877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7213880">var</span>&nbsp;<span class="ident" id="7213884">pemPublicKey</span>&nbsp;<span class="op" id="7213897">=</span>&nbsp;<span class="string" id="7213899">`-----BEGIN&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno">70</span>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3VoPN9PKUjKFLMwOge6+<br>
<span class="lineno"></span>wnDi8sbETGIx2FKXGgqtAKpzmem53kRGEQg8WeqRmp12wgp74TGpkEXsGae7RS1k<br>
<span class="lineno"></span>enJCnma4fii+noGH7R0qKgHvPrI2Bwa9hzsH8tHxpyM3qrXslOmD45EH9SxIDUBJ<br>
<span class="lineno"></span>FehNdaPbLP1gFyahKMsdfxFJLUvbUycuZSJ2ZnIgeVxwm4qbSvZInL9Iu4FzuPtg<br>
<span class="lineno"></span>fINKcbbovy1qq4KvPIrXzhbY3PWDc6btxCf3SE0JdE1MCPThntB62/bLMSQ7xdDR<br>
<span class="lineno">75</span>FF53oIpvxe/SCOymfWq/LW849Ytv3Xwod0+wzAP8STXG4HSELS4UedPYeHJJJYcZ<br>
<span class="lineno"></span>+QIDAQAB<br>
<span class="lineno"></span>-----END&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="7214354">var</span>&nbsp;<span class="ident" id="7214358">pemPrivateKey</span>&nbsp;<span class="op" id="7214372">=</span>&nbsp;<span class="string" id="7214374">`-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0<br>
<span class="lineno"></span>fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu<br>
<span class="lineno"></span>/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu<br>
<span class="lineno"></span>RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/<br>
<span class="lineno">85</span>EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A<br>
<span class="lineno"></span>IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS<br>
<span class="lineno"></span>tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V<br>
<span class="lineno"></span>-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="7214871">func</span>&nbsp;<span class="ident" id="7214876">bigFromString</span><span class="op" id="7214889">(</span><span class="ident" id="7214890">s</span>&nbsp;<span class="builtintype" id="7214892">string</span><span class="op" id="7214898">)</span>&nbsp;<span class="op" id="7214900">*</span><span class="ident" id="7214901">big</span><span class="op" id="7214904">.</span><span class="ident" id="7214905">Int</span>&nbsp;<span class="op" id="7214909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7214912">ret</span>&nbsp;<span class="op" id="7214916">:=</span>&nbsp;<span class="builtinfunc" id="7214919">new</span><span class="op" id="7214922">(</span><span class="ident" id="7214923">big</span><span class="op" id="7214926">.</span><span class="ident" id="7214927">Int</span><span class="op" id="7214930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7214933">ret</span><span class="op" id="7214936">.</span><span class="ident" id="7214937">SetString</span><span class="op" id="7214946">(</span><span class="ident" id="7214947">s</span><span class="op" id="7214948">,</span>&nbsp;<span class="num" id="7214950">10</span><span class="op" id="7214952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7214955">return</span>&nbsp;<span class="ident" id="7214962">ret</span><br>
<span class="lineno">95</span><span class="op" id="7214966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7214969">func</span>&nbsp;<span class="ident" id="7214974">fromBase10</span><span class="op" id="7214984">(</span><span class="ident" id="7214985">base10</span>&nbsp;<span class="builtintype" id="7214992">string</span><span class="op" id="7214998">)</span>&nbsp;<span class="op" id="7215000">*</span><span class="ident" id="7215001">big</span><span class="op" id="7215004">.</span><span class="ident" id="7215005">Int</span>&nbsp;<span class="op" id="7215009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7215012">i</span>&nbsp;<span class="op" id="7215014">:=</span>&nbsp;<span class="builtinfunc" id="7215017">new</span><span class="op" id="7215020">(</span><span class="ident" id="7215021">big</span><span class="op" id="7215024">.</span><span class="ident" id="7215025">Int</span><span class="op" id="7215028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7215031">i</span><span class="op" id="7215032">.</span><span class="ident" id="7215033">SetString</span><span class="op" id="7215042">(</span><span class="ident" id="7215043">base10</span><span class="op" id="7215049">,</span>&nbsp;<span class="num" id="7215051">10</span><span class="op" id="7215053">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7215056">return</span>&nbsp;<span class="ident" id="7215063">i</span><br>
<span class="lineno"></span><span class="op" id="7215065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7215068">func</span>&nbsp;<span class="ident" id="7215073">bigFromHexString</span><span class="op" id="7215089">(</span><span class="ident" id="7215090">s</span>&nbsp;<span class="builtintype" id="7215092">string</span><span class="op" id="7215098">)</span>&nbsp;<span class="op" id="7215100">*</span><span class="ident" id="7215101">big</span><span class="op" id="7215104">.</span><span class="ident" id="7215105">Int</span>&nbsp;<span class="op" id="7215109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7215112">ret</span>&nbsp;<span class="op" id="7215116">:=</span>&nbsp;<span class="builtinfunc" id="7215119">new</span><span class="op" id="7215122">(</span><span class="ident" id="7215123">big</span><span class="op" id="7215126">.</span><span class="ident" id="7215127">Int</span><span class="op" id="7215130">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7215133">ret</span><span class="op" id="7215136">.</span><span class="ident" id="7215137">SetString</span><span class="op" id="7215146">(</span><span class="ident" id="7215147">s</span><span class="op" id="7215148">,</span>&nbsp;<span class="num" id="7215150">16</span><span class="op" id="7215152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7215155">return</span>&nbsp;<span class="ident" id="7215162">ret</span><br>
<span class="lineno"></span><span class="op" id="7215166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7215169">var</span>&nbsp;<span class="ident" id="7215173">rsaPrivateKey</span>&nbsp;<span class="op" id="7215187">=</span>&nbsp;<span class="op" id="7215189">&amp;</span><span class="ident" id="7215190">rsa</span><span class="op" id="7215193">.</span><span class="ident" id="7215194">PrivateKey</span><span class="op" id="7215204">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7215207">PublicKey</span><span class="op" id="7215216">:</span>&nbsp;<span class="ident" id="7215218">rsa</span><span class="op" id="7215221">.</span><span class="ident" id="7215222">PublicKey</span><span class="op" id="7215231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7215235">N</span><span class="op" id="7215236">:</span>&nbsp;<span class="ident" id="7215238">bigFromString</span><span class="op" id="7215251">(</span><span class="string" id="7215252">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="7215408">)</span><span class="op" id="7215409">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7215413">E</span><span class="op" id="7215414">:</span>&nbsp;<span class="num" id="7215416">65537</span><span class="op" id="7215421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7215424">}</span><span class="op" id="7215425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7215428">D</span><span class="op" id="7215429">:</span>&nbsp;<span class="ident" id="7215431">bigFromString</span><span class="op" id="7215444">(</span><span class="string" id="7215445">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="7215601">)</span><span class="op" id="7215602">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7215605">Primes</span><span class="op" id="7215611">:</span>&nbsp;<span class="op" id="7215613">[</span><span class="op" id="7215614">]</span><span class="op" id="7215615">*</span><span class="ident" id="7215616">big</span><span class="op" id="7215619">.</span><span class="ident" id="7215620">Int</span><span class="op" id="7215623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7215627">bigFromString</span><span class="op" id="7215640">(</span><span class="string" id="7215641">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="7215720">)</span><span class="op" id="7215721">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7215725">bigFromString</span><span class="op" id="7215738">(</span><span class="string" id="7215739">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="7215818">)</span><span class="op" id="7215819">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7215822">}</span><span class="op" id="7215823">,</span><br>
<span class="lineno"></span><span class="op" id="7215825">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="7215828">func</span>&nbsp;<span class="ident" id="7215833">TestMarshalRSAPrivateKey</span><span class="op" id="7215857">(</span><span class="ident" id="7215858">t</span>&nbsp;<span class="op" id="7215860">*</span><span class="ident" id="7215861">testing</span><span class="op" id="7215868">.</span><span class="ident" id="7215869">T</span><span class="op" id="7215870">)</span>&nbsp;<span class="op" id="7215872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7215875">priv</span>&nbsp;<span class="op" id="7215880">:=</span>&nbsp;<span class="op" id="7215883">&amp;</span><span class="ident" id="7215884">rsa</span><span class="op" id="7215887">.</span><span class="ident" id="7215888">PrivateKey</span><span class="op" id="7215898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7215902">PublicKey</span><span class="op" id="7215911">:</span>&nbsp;<span class="ident" id="7215913">rsa</span><span class="op" id="7215916">.</span><span class="ident" id="7215917">PublicKey</span><span class="op" id="7215926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7215931">N</span><span class="op" id="7215932">:</span>&nbsp;<span class="ident" id="7215934">fromBase10</span><span class="op" id="7215944">(</span><span class="string" id="7215945">&#34;16346378922382193400538269749936049106320265317511766357599732575277382844051791096569333808598921852351577762718529818072849191122419410612033592401403764925096136759934497687765453905884149505175426053037420486697072448609022753683683718057795566811401938833367954642951433473337066311978821180526439641496973296037000052546108507805269279414789035461158073156772151892452251106173507240488993608650881929629163465099476849643165682709047462010581308719577053905787496296934240246311806555924593059995202856826239801816771116902778517096212527979497399966526283516447337775509777558018145573127308919204297111496233&#34;</span><span class="op" id="7216564">)</span><span class="op" id="7216565">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7216570">E</span><span class="op" id="7216571">:</span>&nbsp;<span class="num" id="7216573">3</span><span class="op" id="7216574">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7216578">}</span><span class="op" id="7216579">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7216583">D</span><span class="op" id="7216584">:</span>&nbsp;<span class="ident" id="7216586">fromBase10</span><span class="op" id="7216596">(</span><span class="string" id="7216597">&#34;10897585948254795600358846499957366070880176878341177571733155050184921896034527397712889205732614568234385175145686545381899460748279607074689061600935843283397424506622998458510302603922766336783617368686090042765718290914099334449154829375179958369993407724946186243249568928237086215759259909861748642124071874879861299389874230489928271621259294894142840428407196932444474088857746123104978617098858619445675532587787023228852383149557470077802718705420275739737958953794088728369933811184572620857678792001136676902250566845618813972833750098806496641114644760255910789397593428910198080271317419213080834885003&#34;</span><span class="op" id="7217216">)</span><span class="op" id="7217217">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7217221">Primes</span><span class="op" id="7217227">:</span>&nbsp;<span class="op" id="7217229">[</span><span class="op" id="7217230">]</span><span class="op" id="7217231">*</span><span class="ident" id="7217232">big</span><span class="op" id="7217235">.</span><span class="ident" id="7217236">Int</span><span class="op" id="7217239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7217244">fromBase10</span><span class="op" id="7217254">(</span><span class="string" id="7217255">&#34;1025363189502892836833747188838978207017355117492483312747347695538428729137306368764177201532277413433182799108299960196606011786562992097313508180436744488171474690412562218914213688661311117337381958560443&#34;</span><span class="op" id="7217465">)</span><span class="op" id="7217466">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7217471">fromBase10</span><span class="op" id="7217481">(</span><span class="string" id="7217482">&#34;3467903426626310123395340254094941045497208049900750380025518552334536945536837294961497712862519984786362199788654739924501424784631315081391467293694361474867825728031147665777546570788493758372218019373&#34;</span><span class="op" id="7217689">)</span><span class="op" id="7217690">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7217695">fromBase10</span><span class="op" id="7217705">(</span><span class="string" id="7217706">&#34;4597024781409332673052708605078359346966325141767460991205742124888960305710298765592730135879076084498363772408626791576005136245060321874472727132746643162385746062759369754202494417496879741537284589047&#34;</span><span class="op" id="7217913">)</span><span class="op" id="7217914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7217918">}</span><span class="op" id="7217919">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7217922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7217926">derBytes</span>&nbsp;<span class="op" id="7217935">:=</span>&nbsp;<span class="ident" id="7217938">MarshalPKCS1PrivateKey</span><span class="op" id="7217960">(</span><span class="ident" id="7217961">priv</span><span class="op" id="7217965">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7217969">priv2</span><span class="op" id="7217974">,</span>&nbsp;<span class="ident" id="7217976">err</span>&nbsp;<span class="op" id="7217980">:=</span>&nbsp;<span class="ident" id="7217983">ParsePKCS1PrivateKey</span><span class="op" id="7218003">(</span><span class="ident" id="7218004">derBytes</span><span class="op" id="7218012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218015">if</span>&nbsp;<span class="ident" id="7218018">err</span>&nbsp;<span class="op" id="7218022">!=</span>&nbsp;<span class="ident" id="7218025">nil</span>&nbsp;<span class="op" id="7218029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218033">t</span><span class="op" id="7218034">.</span><span class="ident" id="7218035">Errorf</span><span class="op" id="7218041">(</span><span class="string" id="7218042">&#34;error&nbsp;parsing&nbsp;serialized&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7218076">,</span>&nbsp;<span class="ident" id="7218078">err</span><span class="op" id="7218081">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218085">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218096">if</span>&nbsp;<span class="ident" id="7218099">priv</span><span class="op" id="7218103">.</span><span class="ident" id="7218104">PublicKey</span><span class="op" id="7218113">.</span><span class="ident" id="7218114">N</span><span class="op" id="7218115">.</span><span class="ident" id="7218116">Cmp</span><span class="op" id="7218119">(</span><span class="ident" id="7218120">priv2</span><span class="op" id="7218125">.</span><span class="ident" id="7218126">PublicKey</span><span class="op" id="7218135">.</span><span class="ident" id="7218136">N</span><span class="op" id="7218137">)</span>&nbsp;<span class="op" id="7218139">!=</span>&nbsp;<span class="num" id="7218142">0</span>&nbsp;<span class="op" id="7218144">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218149">priv</span><span class="op" id="7218153">.</span><span class="ident" id="7218154">PublicKey</span><span class="op" id="7218163">.</span><span class="ident" id="7218164">E</span>&nbsp;<span class="op" id="7218166">!=</span>&nbsp;<span class="ident" id="7218169">priv2</span><span class="op" id="7218174">.</span><span class="ident" id="7218175">PublicKey</span><span class="op" id="7218184">.</span><span class="ident" id="7218185">E</span>&nbsp;<span class="op" id="7218187">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218192">priv</span><span class="op" id="7218196">.</span><span class="ident" id="7218197">D</span><span class="op" id="7218198">.</span><span class="ident" id="7218199">Cmp</span><span class="op" id="7218202">(</span><span class="ident" id="7218203">priv2</span><span class="op" id="7218208">.</span><span class="ident" id="7218209">D</span><span class="op" id="7218210">)</span>&nbsp;<span class="op" id="7218212">!=</span>&nbsp;<span class="num" id="7218215">0</span>&nbsp;<span class="op" id="7218217">||</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7218222">len</span><span class="op" id="7218225">(</span><span class="ident" id="7218226">priv2</span><span class="op" id="7218231">.</span><span class="ident" id="7218232">Primes</span><span class="op" id="7218238">)</span>&nbsp;<span class="op" id="7218240">!=</span>&nbsp;<span class="num" id="7218243">3</span>&nbsp;<span class="op" id="7218245">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218250">priv</span><span class="op" id="7218254">.</span><span class="ident" id="7218255">Primes</span><span class="op" id="7218261">[</span><span class="num" id="7218262">0</span><span class="op" id="7218263">]</span><span class="op" id="7218264">.</span><span class="ident" id="7218265">Cmp</span><span class="op" id="7218268">(</span><span class="ident" id="7218269">priv2</span><span class="op" id="7218274">.</span><span class="ident" id="7218275">Primes</span><span class="op" id="7218281">[</span><span class="num" id="7218282">0</span><span class="op" id="7218283">]</span><span class="op" id="7218284">)</span>&nbsp;<span class="op" id="7218286">!=</span>&nbsp;<span class="num" id="7218289">0</span>&nbsp;<span class="op" id="7218291">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218296">priv</span><span class="op" id="7218300">.</span><span class="ident" id="7218301">Primes</span><span class="op" id="7218307">[</span><span class="num" id="7218308">1</span><span class="op" id="7218309">]</span><span class="op" id="7218310">.</span><span class="ident" id="7218311">Cmp</span><span class="op" id="7218314">(</span><span class="ident" id="7218315">priv2</span><span class="op" id="7218320">.</span><span class="ident" id="7218321">Primes</span><span class="op" id="7218327">[</span><span class="num" id="7218328">1</span><span class="op" id="7218329">]</span><span class="op" id="7218330">)</span>&nbsp;<span class="op" id="7218332">!=</span>&nbsp;<span class="num" id="7218335">0</span>&nbsp;<span class="op" id="7218337">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218342">priv</span><span class="op" id="7218346">.</span><span class="ident" id="7218347">Primes</span><span class="op" id="7218353">[</span><span class="num" id="7218354">2</span><span class="op" id="7218355">]</span><span class="op" id="7218356">.</span><span class="ident" id="7218357">Cmp</span><span class="op" id="7218360">(</span><span class="ident" id="7218361">priv2</span><span class="op" id="7218366">.</span><span class="ident" id="7218367">Primes</span><span class="op" id="7218373">[</span><span class="num" id="7218374">2</span><span class="op" id="7218375">]</span><span class="op" id="7218376">)</span>&nbsp;<span class="op" id="7218378">!=</span>&nbsp;<span class="num" id="7218381">0</span>&nbsp;<span class="op" id="7218383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218387">t</span><span class="op" id="7218388">.</span><span class="ident" id="7218389">Errorf</span><span class="op" id="7218395">(</span><span class="string" id="7218396">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="7218414">,</span>&nbsp;<span class="ident" id="7218416">priv</span><span class="op" id="7218420">,</span>&nbsp;<span class="ident" id="7218422">priv2</span><span class="op" id="7218427">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218430">}</span><br>
<span class="lineno"></span><span class="op" id="7218432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7218435">type</span>&nbsp;<span class="ident" id="7218440">matchHostnamesTest</span>&nbsp;<span class="keyword" id="7218459">struct</span>&nbsp;<span class="op" id="7218466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218469">pattern</span><span class="op" id="7218476">,</span>&nbsp;<span class="ident" id="7218478">host</span>&nbsp;<span class="builtintype" id="7218483">string</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218491">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7218505">bool</span><br>
<span class="lineno"></span><span class="op" id="7218510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7218513">var</span>&nbsp;<span class="ident" id="7218517">matchHostnamesTests</span>&nbsp;<span class="op" id="7218537">=</span>&nbsp;<span class="op" id="7218539">[</span><span class="op" id="7218540">]</span><span class="ident" id="7218541">matchHostnamesTest</span><span class="op" id="7218559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218562">{</span><span class="string" id="7218563">&#34;a.b.c&#34;</span><span class="op" id="7218570">,</span>&nbsp;<span class="string" id="7218572">&#34;a.b.c&#34;</span><span class="op" id="7218579">,</span>&nbsp;<span class="builtintype" id="7218581">true</span><span class="op" id="7218585">}</span><span class="op" id="7218586">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218589">{</span><span class="string" id="7218590">&#34;a.b.c&#34;</span><span class="op" id="7218597">,</span>&nbsp;<span class="string" id="7218599">&#34;b.b.c&#34;</span><span class="op" id="7218606">,</span>&nbsp;<span class="builtintype" id="7218608">false</span><span class="op" id="7218613">}</span><span class="op" id="7218614">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218617">{</span><span class="string" id="7218618">&#34;&#34;</span><span class="op" id="7218620">,</span>&nbsp;<span class="string" id="7218622">&#34;b.b.c&#34;</span><span class="op" id="7218629">,</span>&nbsp;<span class="builtintype" id="7218631">false</span><span class="op" id="7218636">}</span><span class="op" id="7218637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218640">{</span><span class="string" id="7218641">&#34;a.b.c&#34;</span><span class="op" id="7218648">,</span>&nbsp;<span class="string" id="7218650">&#34;&#34;</span><span class="op" id="7218652">,</span>&nbsp;<span class="builtintype" id="7218654">false</span><span class="op" id="7218659">}</span><span class="op" id="7218660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218663">{</span><span class="string" id="7218664">&#34;example.com&#34;</span><span class="op" id="7218677">,</span>&nbsp;<span class="string" id="7218679">&#34;example.com&#34;</span><span class="op" id="7218692">,</span>&nbsp;<span class="builtintype" id="7218694">true</span><span class="op" id="7218698">}</span><span class="op" id="7218699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218702">{</span><span class="string" id="7218703">&#34;example.com&#34;</span><span class="op" id="7218716">,</span>&nbsp;<span class="string" id="7218718">&#34;www.example.com&#34;</span><span class="op" id="7218735">,</span>&nbsp;<span class="builtintype" id="7218737">false</span><span class="op" id="7218742">}</span><span class="op" id="7218743">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218746">{</span><span class="string" id="7218747">&#34;*.example.com&#34;</span><span class="op" id="7218762">,</span>&nbsp;<span class="string" id="7218764">&#34;www.example.com&#34;</span><span class="op" id="7218781">,</span>&nbsp;<span class="builtintype" id="7218783">true</span><span class="op" id="7218787">}</span><span class="op" id="7218788">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218791">{</span><span class="string" id="7218792">&#34;*.example.com&#34;</span><span class="op" id="7218807">,</span>&nbsp;<span class="string" id="7218809">&#34;xyz.www.example.com&#34;</span><span class="op" id="7218830">,</span>&nbsp;<span class="builtintype" id="7218832">false</span><span class="op" id="7218837">}</span><span class="op" id="7218838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218841">{</span><span class="string" id="7218842">&#34;*.*.example.com&#34;</span><span class="op" id="7218859">,</span>&nbsp;<span class="string" id="7218861">&#34;xyz.www.example.com&#34;</span><span class="op" id="7218882">,</span>&nbsp;<span class="builtintype" id="7218884">true</span><span class="op" id="7218888">}</span><span class="op" id="7218889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218892">{</span><span class="string" id="7218893">&#34;*.www.*.com&#34;</span><span class="op" id="7218906">,</span>&nbsp;<span class="string" id="7218908">&#34;xyz.www.example.com&#34;</span><span class="op" id="7218929">,</span>&nbsp;<span class="builtintype" id="7218931">true</span><span class="op" id="7218935">}</span><span class="op" id="7218936">,</span><br>
<span class="lineno"></span><span class="op" id="7218938">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="7218941">func</span>&nbsp;<span class="ident" id="7218946">TestMatchHostnames</span><span class="op" id="7218964">(</span><span class="ident" id="7218965">t</span>&nbsp;<span class="op" id="7218967">*</span><span class="ident" id="7218968">testing</span><span class="op" id="7218975">.</span><span class="ident" id="7218976">T</span><span class="op" id="7218977">)</span>&nbsp;<span class="op" id="7218979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218982">for</span>&nbsp;<span class="ident" id="7218986">i</span><span class="op" id="7218987">,</span>&nbsp;<span class="ident" id="7218989">test</span>&nbsp;<span class="op" id="7218994">:=</span>&nbsp;<span class="keyword" id="7218997">range</span>&nbsp;<span class="ident" id="7219003">matchHostnamesTests</span>&nbsp;<span class="op" id="7219023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219027">r</span>&nbsp;<span class="op" id="7219029">:=</span>&nbsp;<span class="ident" id="7219032">matchHostnames</span><span class="op" id="7219046">(</span><span class="ident" id="7219047">test</span><span class="op" id="7219051">.</span><span class="ident" id="7219052">pattern</span><span class="op" id="7219059">,</span>&nbsp;<span class="ident" id="7219061">test</span><span class="op" id="7219065">.</span><span class="ident" id="7219066">host</span><span class="op" id="7219070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7219074">if</span>&nbsp;<span class="ident" id="7219077">r</span>&nbsp;<span class="op" id="7219079">!=</span>&nbsp;<span class="ident" id="7219082">test</span><span class="op" id="7219086">.</span><span class="ident" id="7219087">ok</span>&nbsp;<span class="op" id="7219090">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219095">t</span><span class="op" id="7219096">.</span><span class="ident" id="7219097">Errorf</span><span class="op" id="7219103">(</span><span class="string" id="7219104">&#34;#%d&nbsp;mismatch&nbsp;got:&nbsp;%t&nbsp;want:&nbsp;%t&#34;</span><span class="op" id="7219135">,</span>&nbsp;<span class="ident" id="7219137">i</span><span class="op" id="7219138">,</span>&nbsp;<span class="ident" id="7219140">r</span><span class="op" id="7219141">,</span>&nbsp;<span class="ident" id="7219143">test</span><span class="op" id="7219147">.</span><span class="ident" id="7219148">ok</span><span class="op" id="7219150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219157">}</span><br>
<span class="lineno"></span><span class="op" id="7219159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="7219162">func</span>&nbsp;<span class="ident" id="7219167">TestMatchIP</span><span class="op" id="7219178">(</span><span class="ident" id="7219179">t</span>&nbsp;<span class="op" id="7219181">*</span><span class="ident" id="7219182">testing</span><span class="op" id="7219189">.</span><span class="ident" id="7219190">T</span><span class="op" id="7219191">)</span>&nbsp;<span class="op" id="7219193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7219196">//&nbsp;Check&nbsp;that&nbsp;pattern&nbsp;matching&nbsp;is&nbsp;working.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219240">c</span>&nbsp;<span class="op" id="7219242">:=</span>&nbsp;<span class="op" id="7219245">&amp;</span><span class="ident" id="7219246">Certificate</span><span class="op" id="7219257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219261">DNSNames</span><span class="op" id="7219269">:</span>&nbsp;<span class="op" id="7219271">[</span><span class="op" id="7219272">]</span><span class="builtintype" id="7219273">string</span><span class="op" id="7219279">{</span><span class="string" id="7219280">&#34;*.foo.bar.baz&#34;</span><span class="op" id="7219295">}</span><span class="op" id="7219296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219300">Subject</span><span class="op" id="7219307">:</span>&nbsp;<span class="ident" id="7219309">pkix</span><span class="op" id="7219313">.</span><span class="ident" id="7219314">Name</span><span class="op" id="7219318">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219323">CommonName</span><span class="op" id="7219333">:</span>&nbsp;<span class="string" id="7219335">&#34;*.foo.bar.baz&#34;</span><span class="op" id="7219350">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219354">}</span><span class="op" id="7219355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219361">err</span>&nbsp;<span class="op" id="7219365">:=</span>&nbsp;<span class="ident" id="7219368">c</span><span class="op" id="7219369">.</span><span class="ident" id="7219370">VerifyHostname</span><span class="op" id="7219384">(</span><span class="string" id="7219385">&#34;quux.foo.bar.baz&#34;</span><span class="op" id="7219403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7219406">if</span>&nbsp;<span class="ident" id="7219409">err</span>&nbsp;<span class="op" id="7219413">!=</span>&nbsp;<span class="ident" id="7219416">nil</span>&nbsp;<span class="op" id="7219420">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219424">t</span><span class="op" id="7219425">.</span><span class="ident" id="7219426">Fatalf</span><span class="op" id="7219432">(</span><span class="string" id="7219433">&#34;VerifyHostname(quux.foo.bar.baz):&nbsp;%v&#34;</span><span class="op" id="7219471">,</span>&nbsp;<span class="ident" id="7219473">err</span><span class="op" id="7219476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7219483">//&nbsp;But&nbsp;check&nbsp;that&nbsp;if&nbsp;we&nbsp;change&nbsp;it&nbsp;to&nbsp;be&nbsp;matching&nbsp;against&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7219556">//&nbsp;it&nbsp;is&nbsp;rejected.</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219576">c</span>&nbsp;<span class="op" id="7219578">=</span>&nbsp;<span class="op" id="7219580">&amp;</span><span class="ident" id="7219581">Certificate</span><span class="op" id="7219592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219596">DNSNames</span><span class="op" id="7219604">:</span>&nbsp;<span class="op" id="7219606">[</span><span class="op" id="7219607">]</span><span class="builtintype" id="7219608">string</span><span class="op" id="7219614">{</span><span class="string" id="7219615">&#34;*.2.3.4&#34;</span><span class="op" id="7219624">}</span><span class="op" id="7219625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219629">Subject</span><span class="op" id="7219636">:</span>&nbsp;<span class="ident" id="7219638">pkix</span><span class="op" id="7219642">.</span><span class="ident" id="7219643">Name</span><span class="op" id="7219647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219652">CommonName</span><span class="op" id="7219662">:</span>&nbsp;<span class="string" id="7219664">&#34;*.2.3.4&#34;</span><span class="op" id="7219673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219677">}</span><span class="op" id="7219678">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219684">err</span>&nbsp;<span class="op" id="7219688">=</span>&nbsp;<span class="ident" id="7219690">c</span><span class="op" id="7219691">.</span><span class="ident" id="7219692">VerifyHostname</span><span class="op" id="7219706">(</span><span class="string" id="7219707">&#34;1.2.3.4&#34;</span><span class="op" id="7219716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7219719">if</span>&nbsp;<span class="ident" id="7219722">err</span>&nbsp;<span class="op" id="7219726">==</span>&nbsp;<span class="ident" id="7219729">nil</span>&nbsp;<span class="op" id="7219733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219737">t</span><span class="op" id="7219738">.</span><span class="ident" id="7219739">Fatalf</span><span class="op" id="7219745">(</span><span class="string" id="7219746">&#34;VerifyHostname(1.2.3.4)&nbsp;should&nbsp;have&nbsp;failed,&nbsp;did&nbsp;not&#34;</span><span class="op" id="7219799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219802">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219806">c</span>&nbsp;<span class="op" id="7219808">=</span>&nbsp;<span class="op" id="7219810">&amp;</span><span class="ident" id="7219811">Certificate</span><span class="op" id="7219822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219826">IPAddresses</span><span class="op" id="7219837">:</span>&nbsp;<span class="op" id="7219839">[</span><span class="op" id="7219840">]</span><span class="ident" id="7219841">net</span><span class="op" id="7219844">.</span><span class="ident" id="7219845">IP</span><span class="op" id="7219847">{</span><span class="ident" id="7219848">net</span><span class="op" id="7219851">.</span><span class="ident" id="7219852">ParseIP</span><span class="op" id="7219859">(</span><span class="string" id="7219860">&#34;127.0.0.1&#34;</span><span class="op" id="7219871">)</span><span class="op" id="7219872">,</span>&nbsp;<span class="ident" id="7219874">net</span><span class="op" id="7219877">.</span><span class="ident" id="7219878">ParseIP</span><span class="op" id="7219885">(</span><span class="string" id="7219886">&#34;::1&#34;</span><span class="op" id="7219891">)</span><span class="op" id="7219892">}</span><span class="op" id="7219893">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219899">err</span>&nbsp;<span class="op" id="7219903">=</span>&nbsp;<span class="ident" id="7219905">c</span><span class="op" id="7219906">.</span><span class="ident" id="7219907">VerifyHostname</span><span class="op" id="7219921">(</span><span class="string" id="7219922">&#34;127.0.0.1&#34;</span><span class="op" id="7219933">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7219936">if</span>&nbsp;<span class="ident" id="7219939">err</span>&nbsp;<span class="op" id="7219943">!=</span>&nbsp;<span class="ident" id="7219946">nil</span>&nbsp;<span class="op" id="7219950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219954">t</span><span class="op" id="7219955">.</span><span class="ident" id="7219956">Fatalf</span><span class="op" id="7219962">(</span><span class="string" id="7219963">&#34;VerifyHostname(127.0.0.1):&nbsp;%v&#34;</span><span class="op" id="7219994">,</span>&nbsp;<span class="ident" id="7219996">err</span><span class="op" id="7219999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7220002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220005">err</span>&nbsp;<span class="op" id="7220009">=</span>&nbsp;<span class="ident" id="7220011">c</span><span class="op" id="7220012">.</span><span class="ident" id="7220013">VerifyHostname</span><span class="op" id="7220027">(</span><span class="string" id="7220028">&#34;::1&#34;</span><span class="op" id="7220033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220036">if</span>&nbsp;<span class="ident" id="7220039">err</span>&nbsp;<span class="op" id="7220043">!=</span>&nbsp;<span class="ident" id="7220046">nil</span>&nbsp;<span class="op" id="7220050">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220054">t</span><span class="op" id="7220055">.</span><span class="ident" id="7220056">Fatalf</span><span class="op" id="7220062">(</span><span class="string" id="7220063">&#34;VerifyHostname(::1):&nbsp;%v&#34;</span><span class="op" id="7220088">,</span>&nbsp;<span class="ident" id="7220090">err</span><span class="op" id="7220093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7220096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220099">err</span>&nbsp;<span class="op" id="7220103">=</span>&nbsp;<span class="ident" id="7220105">c</span><span class="op" id="7220106">.</span><span class="ident" id="7220107">VerifyHostname</span><span class="op" id="7220121">(</span><span class="string" id="7220122">&#34;[::1]&#34;</span><span class="op" id="7220129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220132">if</span>&nbsp;<span class="ident" id="7220135">err</span>&nbsp;<span class="op" id="7220139">!=</span>&nbsp;<span class="ident" id="7220142">nil</span>&nbsp;<span class="op" id="7220146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220150">t</span><span class="op" id="7220151">.</span><span class="ident" id="7220152">Fatalf</span><span class="op" id="7220158">(</span><span class="string" id="7220159">&#34;VerifyHostname([::1]):&nbsp;%v&#34;</span><span class="op" id="7220186">,</span>&nbsp;<span class="ident" id="7220188">err</span><span class="op" id="7220191">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7220194">}</span><br>
<span class="lineno"></span><span class="op" id="7220196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7220199">func</span>&nbsp;<span class="ident" id="7220204">TestCertificateParse</span><span class="op" id="7220224">(</span><span class="ident" id="7220225">t</span>&nbsp;<span class="op" id="7220227">*</span><span class="ident" id="7220228">testing</span><span class="op" id="7220235">.</span><span class="ident" id="7220236">T</span><span class="op" id="7220237">)</span>&nbsp;<span class="op" id="7220239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220242">s</span><span class="op" id="7220243">,</span>&nbsp;<span class="ident" id="7220245">_</span>&nbsp;<span class="op" id="7220247">:=</span>&nbsp;<span class="ident" id="7220250">hex</span><span class="op" id="7220253">.</span><span class="ident" id="7220254">DecodeString</span><span class="op" id="7220266">(</span><span class="ident" id="7220267">certBytes</span><span class="op" id="7220276">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220279">certs</span><span class="op" id="7220284">,</span>&nbsp;<span class="ident" id="7220286">err</span>&nbsp;<span class="op" id="7220290">:=</span>&nbsp;<span class="ident" id="7220293">ParseCertificates</span><span class="op" id="7220310">(</span><span class="ident" id="7220311">s</span><span class="op" id="7220312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220315">if</span>&nbsp;<span class="ident" id="7220318">err</span>&nbsp;<span class="op" id="7220322">!=</span>&nbsp;<span class="ident" id="7220325">nil</span>&nbsp;<span class="op" id="7220329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220333">t</span><span class="op" id="7220334">.</span><span class="ident" id="7220335">Error</span><span class="op" id="7220340">(</span><span class="ident" id="7220341">err</span><span class="op" id="7220344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7220347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220350">if</span>&nbsp;<span class="builtinfunc" id="7220353">len</span><span class="op" id="7220356">(</span><span class="ident" id="7220357">certs</span><span class="op" id="7220362">)</span>&nbsp;<span class="op" id="7220364">!=</span>&nbsp;<span class="num" id="7220367">2</span>&nbsp;<span class="op" id="7220369">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220373">t</span><span class="op" id="7220374">.</span><span class="ident" id="7220375">Errorf</span><span class="op" id="7220381">(</span><span class="string" id="7220382">&#34;Wrong&nbsp;number&nbsp;of&nbsp;certs:&nbsp;got&nbsp;%d&nbsp;want&nbsp;2&#34;</span><span class="op" id="7220420">,</span>&nbsp;<span class="builtinfunc" id="7220422">len</span><span class="op" id="7220425">(</span><span class="ident" id="7220426">certs</span><span class="op" id="7220431">)</span><span class="op" id="7220432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220436">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7220444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220448">err</span>&nbsp;<span class="op" id="7220452">=</span>&nbsp;<span class="ident" id="7220454">certs</span><span class="op" id="7220459">[</span><span class="num" id="7220460">0</span><span class="op" id="7220461">]</span><span class="op" id="7220462">.</span><span class="ident" id="7220463">CheckSignatureFrom</span><span class="op" id="7220481">(</span><span class="ident" id="7220482">certs</span><span class="op" id="7220487">[</span><span class="num" id="7220488">1</span><span class="op" id="7220489">]</span><span class="op" id="7220490">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220493">if</span>&nbsp;<span class="ident" id="7220496">err</span>&nbsp;<span class="op" id="7220500">!=</span>&nbsp;<span class="ident" id="7220503">nil</span>&nbsp;<span class="op" id="7220507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220511">t</span><span class="op" id="7220512">.</span><span class="ident" id="7220513">Error</span><span class="op" id="7220518">(</span><span class="ident" id="7220519">err</span><span class="op" id="7220522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7220525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220529">if</span>&nbsp;<span class="ident" id="7220532">err</span>&nbsp;<span class="op" id="7220536">:=</span>&nbsp;<span class="ident" id="7220539">certs</span><span class="op" id="7220544">[</span><span class="num" id="7220545">0</span><span class="op" id="7220546">]</span><span class="op" id="7220547">.</span><span class="ident" id="7220548">VerifyHostname</span><span class="op" id="7220562">(</span><span class="string" id="7220563">&#34;mail.google.com&#34;</span><span class="op" id="7220580">)</span><span class="op" id="7220581">;</span>&nbsp;<span class="ident" id="7220583">err</span>&nbsp;<span class="op" id="7220587">!=</span>&nbsp;<span class="ident" id="7220590">nil</span>&nbsp;<span class="op" id="7220594">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220598">t</span><span class="op" id="7220599">.</span><span class="ident" id="7220600">Error</span><span class="op" id="7220605">(</span><span class="ident" id="7220606">err</span><span class="op" id="7220609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7220612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220616">const</span>&nbsp;<span class="ident" id="7220622">expectedExtensions</span>&nbsp;<span class="op" id="7220641">=</span>&nbsp;<span class="num" id="7220643">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220646">if</span>&nbsp;<span class="ident" id="7220649">n</span>&nbsp;<span class="op" id="7220651">:=</span>&nbsp;<span class="builtinfunc" id="7220654">len</span><span class="op" id="7220657">(</span><span class="ident" id="7220658">certs</span><span class="op" id="7220663">[</span><span class="num" id="7220664">0</span><span class="op" id="7220665">]</span><span class="op" id="7220666">.</span><span class="ident" id="7220667">Extensions</span><span class="op" id="7220677">)</span><span class="op" id="7220678">;</span>&nbsp;<span class="ident" id="7220680">n</span>&nbsp;<span class="op" id="7220682">!=</span>&nbsp;<span class="ident" id="7220685">expectedExtensions</span>&nbsp;<span class="op" id="7220704">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220708">t</span><span class="op" id="7220709">.</span><span class="ident" id="7220710">Errorf</span><span class="op" id="7220716">(</span><span class="string" id="7220717">&#34;want&nbsp;%d&nbsp;extensions,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7220745">,</span>&nbsp;<span class="ident" id="7220747">expectedExtensions</span><span class="op" id="7220765">,</span>&nbsp;<span class="ident" id="7220767">n</span><span class="op" id="7220768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7220771">}</span><br>
<span class="lineno"></span><span class="op" id="7220773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7220776">var</span>&nbsp;<span class="ident" id="7220780">certBytes</span>&nbsp;<span class="op" id="7220790">=</span>&nbsp;<span class="string" id="7220792">&#34;308203223082028ba00302010202106edf0d9499fd4533dd1297fc42a93be1300d06092a864886&#34;</span>&nbsp;<span class="op" id="7220873">+</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7220876">&#34;f70d0101050500304c310b3009060355040613025a4131253023060355040a131c546861777465&#34;</span>&nbsp;<span class="op" id="7220957">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7220960">&#34;20436f6e73756c74696e67202850747929204c74642e311630140603550403130d546861777465&#34;</span>&nbsp;<span class="op" id="7221041">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7221044">&#34;20534743204341301e170d3039303332353136343932395a170d3130303332353136343932395a&#34;</span>&nbsp;<span class="op" id="7221125">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7221128">&#34;3069310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630&#34;</span>&nbsp;<span class="op" id="7221209">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7221212">&#34;140603550407130d4d6f756e7461696e205669657731133011060355040a130a476f6f676c6520&#34;</span>&nbsp;<span class="op" id="7221293">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7221296">&#34;496e63311830160603550403130f6d61696c2e676f6f676c652e636f6d30819f300d06092a8648&#34;</span>&nbsp;<span class="op" id="7221377">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7221380">&#34;86f70d010101050003818d0030818902818100c5d6f892fccaf5614b064149e80a2c9581a218ef&#34;</span>&nbsp;<span class="op" id="7221461">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7221464">&#34;41ec35bd7a58125ae76f9ea54ddc893abbeb029f6b73616bf0ffd868791fba7af9c4aebf3706ba&#34;</span>&nbsp;<span class="op" id="7221545">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7221548">&#34;3eeaeed27435b4ddcfb157c05f351d66aa87fee0de072d66d773affbd36ab78bef090e0cc861a9&#34;</span>&nbsp;<span class="op" id="7221629">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7221632">&#34;03ac90dd98b51c9c41566c017f0beec3bff391051ffba0f5cc6850ad2a590203010001a381e730&#34;</span>&nbsp;<span class="op" id="7221713">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7221716">&#34;81e430280603551d250421301f06082b0601050507030106082b06010505070302060960864801&#34;</span>&nbsp;<span class="op" id="7221797">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7221800">&#34;86f842040130360603551d1f042f302d302ba029a0278625687474703a2f2f63726c2e74686177&#34;</span>&nbsp;<span class="op" id="7221881">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7221884">&#34;74652e636f6d2f54686177746553474343412e63726c307206082b060105050701010466306430&#34;</span>&nbsp;<span class="op" id="7221965">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7221968">&#34;2206082b060105050730018616687474703a2f2f6f6373702e7468617774652e636f6d303e0608&#34;</span>&nbsp;<span class="op" id="7222049">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7222052">&#34;2b060105050730028632687474703a2f2f7777772e7468617774652e636f6d2f7265706f736974&#34;</span>&nbsp;<span class="op" id="7222133">+</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7222136">&#34;6f72792f5468617774655f5347435f43412e637274300c0603551d130101ff04023000300d0609&#34;</span>&nbsp;<span class="op" id="7222217">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7222220">&#34;2a864886f70d01010505000381810062f1f3050ebc105e497c7aedf87e24d2f4a986bb3b837bd1&#34;</span>&nbsp;<span class="op" id="7222301">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7222304">&#34;9b91ebcad98b065992f6bd2b49b7d6d3cb2e427a99d606c7b1d46352527fac39e6a8b6726de5bf&#34;</span>&nbsp;<span class="op" id="7222385">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7222388">&#34;70212a52cba07634a5e332011bd1868e78eb5e3c93cf03072276786f207494feaa0ed9d53b2110&#34;</span>&nbsp;<span class="op" id="7222469">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7222472">&#34;a76571f90209cdae884385c882587030ee15f33d761e2e45a6bc308203233082028ca003020102&#34;</span>&nbsp;<span class="op" id="7222553">+</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7222556">&#34;020430000002300d06092a864886f70d0101050500305f310b3009060355040613025553311730&#34;</span>&nbsp;<span class="op" id="7222637">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7222640">&#34;15060355040a130e566572695369676e2c20496e632e31373035060355040b132e436c61737320&#34;</span>&nbsp;<span class="op" id="7222721">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7222724">&#34;33205075626c6963205072696d6172792043657274696669636174696f6e20417574686f726974&#34;</span>&nbsp;<span class="op" id="7222805">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7222808">&#34;79301e170d3034303531333030303030305a170d3134303531323233353935395a304c310b3009&#34;</span>&nbsp;<span class="op" id="7222889">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7222892">&#34;060355040613025a4131253023060355040a131c54686177746520436f6e73756c74696e672028&#34;</span>&nbsp;<span class="op" id="7222973">+</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7222976">&#34;50747929204c74642e311630140603550403130d5468617774652053474320434130819f300d06&#34;</span>&nbsp;<span class="op" id="7223057">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7223060">&#34;092a864886f70d010101050003818d0030818902818100d4d367d08d157faecd31fe7d1d91a13f&#34;</span>&nbsp;<span class="op" id="7223141">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7223144">&#34;0b713cacccc864fb63fc324b0794bd6f80ba2fe10493c033fc093323e90b742b71c403c6d2cde2&#34;</span>&nbsp;<span class="op" id="7223225">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7223228">&#34;2ff50963cdff48a500bfe0e7f388b72d32de9836e60aad007bc4644a3b847503f270927d0e62f5&#34;</span>&nbsp;<span class="op" id="7223309">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7223312">&#34;21ab693684317590f8bfc76c881b06957cc9e5a8de75a12c7a68dfd5ca1c875860190203010001&#34;</span>&nbsp;<span class="op" id="7223393">+</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7223396">&#34;a381fe3081fb30120603551d130101ff040830060101ff020100300b0603551d0f040403020106&#34;</span>&nbsp;<span class="op" id="7223477">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7223480">&#34;301106096086480186f842010104040302010630280603551d110421301fa41d301b3119301706&#34;</span>&nbsp;<span class="op" id="7223561">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7223564">&#34;035504031310507269766174654c6162656c332d313530310603551d1f042a30283026a024a022&#34;</span>&nbsp;<span class="op" id="7223645">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7223648">&#34;8620687474703a2f2f63726c2e766572697369676e2e636f6d2f706361332e63726c303206082b&#34;</span>&nbsp;<span class="op" id="7223729">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7223732">&#34;0601050507010104263024302206082b060105050730018616687474703a2f2f6f6373702e7468&#34;</span>&nbsp;<span class="op" id="7223813">+</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7223816">&#34;617774652e636f6d30340603551d25042d302b06082b0601050507030106082b06010505070302&#34;</span>&nbsp;<span class="op" id="7223897">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7223900">&#34;06096086480186f8420401060a6086480186f845010801300d06092a864886f70d010105050003&#34;</span>&nbsp;<span class="op" id="7223981">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7223984">&#34;81810055ac63eadea1ddd2905f9f0bce76be13518f93d9052bc81b774bad6950a1eededcfddb07&#34;</span>&nbsp;<span class="op" id="7224065">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7224068">&#34;e9e83994dcab72792f06bfab8170c4a8edea5334edef1e53d906c7562bd15cf4d18a8eb42bb137&#34;</span>&nbsp;<span class="op" id="7224149">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7224152">&#34;9048084225c53e8acb7feb6f04d16dc574a2f7a27c7b603c77cd0ece48027f012fb69b37e02a2a&#34;</span>&nbsp;<span class="op" id="7224233">+</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7224236">&#34;36dcd585d6ace53f546f961e05af&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7224268">func</span>&nbsp;<span class="ident" id="7224273">TestCreateSelfSignedCertificate</span><span class="op" id="7224304">(</span><span class="ident" id="7224305">t</span>&nbsp;<span class="op" id="7224307">*</span><span class="ident" id="7224308">testing</span><span class="op" id="7224315">.</span><span class="ident" id="7224316">T</span><span class="op" id="7224317">)</span>&nbsp;<span class="op" id="7224319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224322">random</span>&nbsp;<span class="op" id="7224329">:=</span>&nbsp;<span class="ident" id="7224332">rand</span><span class="op" id="7224336">.</span><span class="ident" id="7224337">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224346">block</span><span class="op" id="7224351">,</span>&nbsp;<span class="ident" id="7224353">_</span>&nbsp;<span class="op" id="7224355">:=</span>&nbsp;<span class="ident" id="7224358">pem</span><span class="op" id="7224361">.</span><span class="ident" id="7224362">Decode</span><span class="op" id="7224368">(</span><span class="op" id="7224369">[</span><span class="op" id="7224370">]</span><span class="builtintype" id="7224371">byte</span><span class="op" id="7224375">(</span><span class="ident" id="7224376">pemPrivateKey</span><span class="op" id="7224389">)</span><span class="op" id="7224390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224393">rsaPriv</span><span class="op" id="7224400">,</span>&nbsp;<span class="ident" id="7224402">err</span>&nbsp;<span class="op" id="7224406">:=</span>&nbsp;<span class="ident" id="7224409">ParsePKCS1PrivateKey</span><span class="op" id="7224429">(</span><span class="ident" id="7224430">block</span><span class="op" id="7224435">.</span><span class="ident" id="7224436">Bytes</span><span class="op" id="7224441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7224444">if</span>&nbsp;<span class="ident" id="7224447">err</span>&nbsp;<span class="op" id="7224451">!=</span>&nbsp;<span class="ident" id="7224454">nil</span>&nbsp;<span class="op" id="7224458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224462">t</span><span class="op" id="7224463">.</span><span class="ident" id="7224464">Fatalf</span><span class="op" id="7224470">(</span><span class="string" id="7224471">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7224504">,</span>&nbsp;<span class="ident" id="7224506">err</span><span class="op" id="7224509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7224512">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224516">ecdsaPriv</span><span class="op" id="7224525">,</span>&nbsp;<span class="ident" id="7224527">err</span>&nbsp;<span class="op" id="7224531">:=</span>&nbsp;<span class="ident" id="7224534">ecdsa</span><span class="op" id="7224539">.</span><span class="ident" id="7224540">GenerateKey</span><span class="op" id="7224551">(</span><span class="ident" id="7224552">elliptic</span><span class="op" id="7224560">.</span><span class="ident" id="7224561">P256</span><span class="op" id="7224565">(</span><span class="op" id="7224566">)</span><span class="op" id="7224567">,</span>&nbsp;<span class="ident" id="7224569">rand</span><span class="op" id="7224573">.</span><span class="ident" id="7224574">Reader</span><span class="op" id="7224580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7224583">if</span>&nbsp;<span class="ident" id="7224586">err</span>&nbsp;<span class="op" id="7224590">!=</span>&nbsp;<span class="ident" id="7224593">nil</span>&nbsp;<span class="op" id="7224597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224601">t</span><span class="op" id="7224602">.</span><span class="ident" id="7224603">Fatalf</span><span class="op" id="7224609">(</span><span class="string" id="7224610">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7224644">,</span>&nbsp;<span class="ident" id="7224646">err</span><span class="op" id="7224649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7224652">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224656">tests</span>&nbsp;<span class="op" id="7224662">:=</span>&nbsp;<span class="op" id="7224665">[</span><span class="op" id="7224666">]</span><span class="keyword" id="7224667">struct</span>&nbsp;<span class="op" id="7224674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224678">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7224688">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224697">pub</span><span class="op" id="7224700">,</span>&nbsp;<span class="ident" id="7224702">priv</span>&nbsp;<span class="keyword" id="7224707">interface</span><span class="op" id="7224716">{</span><span class="op" id="7224717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224721">checkSig</span>&nbsp;&nbsp;<span class="builtintype" id="7224731">bool</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224738">sigAlgo</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7224748">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7224768">}</span><span class="op" id="7224769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7224773">{</span><span class="string" id="7224774">&#34;RSA/RSA&#34;</span><span class="op" id="7224783">,</span>&nbsp;<span class="op" id="7224785">&amp;</span><span class="ident" id="7224786">rsaPriv</span><span class="op" id="7224793">.</span><span class="ident" id="7224794">PublicKey</span><span class="op" id="7224803">,</span>&nbsp;<span class="ident" id="7224805">rsaPriv</span><span class="op" id="7224812">,</span>&nbsp;<span class="builtintype" id="7224814">true</span><span class="op" id="7224818">,</span>&nbsp;<span class="ident" id="7224820">SHA1WithRSA</span><span class="op" id="7224831">}</span><span class="op" id="7224832">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7224836">{</span><span class="string" id="7224837">&#34;RSA/ECDSA&#34;</span><span class="op" id="7224848">,</span>&nbsp;<span class="op" id="7224850">&amp;</span><span class="ident" id="7224851">rsaPriv</span><span class="op" id="7224858">.</span><span class="ident" id="7224859">PublicKey</span><span class="op" id="7224868">,</span>&nbsp;<span class="ident" id="7224870">ecdsaPriv</span><span class="op" id="7224879">,</span>&nbsp;<span class="builtintype" id="7224881">false</span><span class="op" id="7224886">,</span>&nbsp;<span class="ident" id="7224888">ECDSAWithSHA384</span><span class="op" id="7224903">}</span><span class="op" id="7224904">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7224908">{</span><span class="string" id="7224909">&#34;ECDSA/RSA&#34;</span><span class="op" id="7224920">,</span>&nbsp;<span class="op" id="7224922">&amp;</span><span class="ident" id="7224923">ecdsaPriv</span><span class="op" id="7224932">.</span><span class="ident" id="7224933">PublicKey</span><span class="op" id="7224942">,</span>&nbsp;<span class="ident" id="7224944">rsaPriv</span><span class="op" id="7224951">,</span>&nbsp;<span class="builtintype" id="7224953">false</span><span class="op" id="7224958">,</span>&nbsp;<span class="ident" id="7224960">SHA256WithRSA</span><span class="op" id="7224973">}</span><span class="op" id="7224974">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7224978">{</span><span class="string" id="7224979">&#34;ECDSA/ECDSA&#34;</span><span class="op" id="7224992">,</span>&nbsp;<span class="op" id="7224994">&amp;</span><span class="ident" id="7224995">ecdsaPriv</span><span class="op" id="7225004">.</span><span class="ident" id="7225005">PublicKey</span><span class="op" id="7225014">,</span>&nbsp;<span class="ident" id="7225016">ecdsaPriv</span><span class="op" id="7225025">,</span>&nbsp;<span class="builtintype" id="7225027">true</span><span class="op" id="7225031">,</span>&nbsp;<span class="ident" id="7225033">ECDSAWithSHA1</span><span class="op" id="7225046">}</span><span class="op" id="7225047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7225050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225054">testExtKeyUsage</span>&nbsp;<span class="op" id="7225070">:=</span>&nbsp;<span class="op" id="7225073">[</span><span class="op" id="7225074">]</span><span class="ident" id="7225075">ExtKeyUsage</span><span class="op" id="7225086">{</span><span class="ident" id="7225087">ExtKeyUsageClientAuth</span><span class="op" id="7225108">,</span>&nbsp;<span class="ident" id="7225110">ExtKeyUsageServerAuth</span><span class="op" id="7225131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225134">testUnknownExtKeyUsage</span>&nbsp;<span class="op" id="7225157">:=</span>&nbsp;<span class="op" id="7225160">[</span><span class="op" id="7225161">]</span><span class="ident" id="7225162">asn1</span><span class="op" id="7225166">.</span><span class="ident" id="7225167">ObjectIdentifier</span><span class="op" id="7225183">{</span><span class="op" id="7225184">[</span><span class="op" id="7225185">]</span><span class="builtintype" id="7225186">int</span><span class="op" id="7225189">{</span><span class="num" id="7225190">1</span><span class="op" id="7225191">,</span>&nbsp;<span class="num" id="7225193">2</span><span class="op" id="7225194">,</span>&nbsp;<span class="num" id="7225196">3</span><span class="op" id="7225197">}</span><span class="op" id="7225198">,</span>&nbsp;<span class="op" id="7225200">[</span><span class="op" id="7225201">]</span><span class="builtintype" id="7225202">int</span><span class="op" id="7225205">{</span><span class="num" id="7225206">2</span><span class="op" id="7225207">,</span>&nbsp;<span class="num" id="7225209">59</span><span class="op" id="7225211">,</span>&nbsp;<span class="num" id="7225213">1</span><span class="op" id="7225214">}</span><span class="op" id="7225215">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225218">extraExtensionData</span>&nbsp;<span class="op" id="7225237">:=</span>&nbsp;<span class="op" id="7225240">[</span><span class="op" id="7225241">]</span><span class="builtintype" id="7225242">byte</span><span class="op" id="7225246">(</span><span class="string" id="7225247">&#34;extra&nbsp;extension&#34;</span><span class="op" id="7225264">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7225268">for</span>&nbsp;<span class="ident" id="7225272">_</span><span class="op" id="7225273">,</span>&nbsp;<span class="ident" id="7225275">test</span>&nbsp;<span class="op" id="7225280">:=</span>&nbsp;<span class="keyword" id="7225283">range</span>&nbsp;<span class="ident" id="7225289">tests</span>&nbsp;<span class="op" id="7225295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225299">commonName</span>&nbsp;<span class="op" id="7225310">:=</span>&nbsp;<span class="string" id="7225313">&#34;test.example.com&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225334">template</span>&nbsp;<span class="op" id="7225343">:=</span>&nbsp;<span class="ident" id="7225346">Certificate</span><span class="op" id="7225357">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225362">SerialNumber</span><span class="op" id="7225374">:</span>&nbsp;<span class="ident" id="7225376">big</span><span class="op" id="7225379">.</span><span class="ident" id="7225380">NewInt</span><span class="op" id="7225386">(</span><span class="num" id="7225387">1</span><span class="op" id="7225388">)</span><span class="op" id="7225389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225394">Subject</span><span class="op" id="7225401">:</span>&nbsp;<span class="ident" id="7225403">pkix</span><span class="op" id="7225407">.</span><span class="ident" id="7225408">Name</span><span class="op" id="7225412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225418">CommonName</span><span class="op" id="7225428">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7225432">commonName</span><span class="op" id="7225442">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225448">Organization</span><span class="op" id="7225460">:</span>&nbsp;<span class="op" id="7225462">[</span><span class="op" id="7225463">]</span><span class="builtintype" id="7225464">string</span><span class="op" id="7225470">{</span><span class="string" id="7225471">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7225483">}</span><span class="op" id="7225484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7225489">}</span><span class="op" id="7225490">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225495">NotBefore</span><span class="op" id="7225504">:</span>&nbsp;<span class="ident" id="7225506">time</span><span class="op" id="7225510">.</span><span class="ident" id="7225511">Unix</span><span class="op" id="7225515">(</span><span class="num" id="7225516">1000</span><span class="op" id="7225520">,</span>&nbsp;<span class="num" id="7225522">0</span><span class="op" id="7225523">)</span><span class="op" id="7225524">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225529">NotAfter</span><span class="op" id="7225537">:</span>&nbsp;&nbsp;<span class="ident" id="7225540">time</span><span class="op" id="7225544">.</span><span class="ident" id="7225545">Unix</span><span class="op" id="7225549">(</span><span class="num" id="7225550">100000</span><span class="op" id="7225556">,</span>&nbsp;<span class="num" id="7225558">0</span><span class="op" id="7225559">)</span><span class="op" id="7225560">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225566">SignatureAlgorithm</span><span class="op" id="7225584">:</span>&nbsp;<span class="ident" id="7225586">test</span><span class="op" id="7225590">.</span><span class="ident" id="7225591">sigAlgo</span><span class="op" id="7225598">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225604">SubjectKeyId</span><span class="op" id="7225616">:</span>&nbsp;<span class="op" id="7225618">[</span><span class="op" id="7225619">]</span><span class="builtintype" id="7225620">byte</span><span class="op" id="7225624">{</span><span class="num" id="7225625">1</span><span class="op" id="7225626">,</span>&nbsp;<span class="num" id="7225628">2</span><span class="op" id="7225629">,</span>&nbsp;<span class="num" id="7225631">3</span><span class="op" id="7225632">,</span>&nbsp;<span class="num" id="7225634">4</span><span class="op" id="7225635">}</span><span class="op" id="7225636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225641">KeyUsage</span><span class="op" id="7225649">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7225655">KeyUsageCertSign</span><span class="op" id="7225671">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225677">ExtKeyUsage</span><span class="op" id="7225688">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7225697">testExtKeyUsage</span><span class="op" id="7225712">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225717">UnknownExtKeyUsage</span><span class="op" id="7225735">:</span>&nbsp;<span class="ident" id="7225737">testUnknownExtKeyUsage</span><span class="op" id="7225759">,</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225765">BasicConstraintsValid</span><span class="op" id="7225786">:</span>&nbsp;<span class="builtintype" id="7225788">true</span><span class="op" id="7225792">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225797">IsCA</span><span class="op" id="7225801">:</span>&nbsp;<span class="builtintype" id="7225803">true</span><span class="op" id="7225807">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225813">OCSPServer</span><span class="op" id="7225823">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7225836">[</span><span class="op" id="7225837">]</span><span class="builtintype" id="7225838">string</span><span class="op" id="7225844">{</span><span class="string" id="7225845">&#34;http://ocsp.example.com&#34;</span><span class="op" id="7225870">}</span><span class="op" id="7225871">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225876">IssuingCertificateURL</span><span class="op" id="7225897">:</span>&nbsp;<span class="op" id="7225899">[</span><span class="op" id="7225900">]</span><span class="builtintype" id="7225901">string</span><span class="op" id="7225907">{</span><span class="string" id="7225908">&#34;http://crt.example.com/ca1.crt&#34;</span><span class="op" id="7225940">}</span><span class="op" id="7225941">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225947">DNSNames</span><span class="op" id="7225955">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7225963">[</span><span class="op" id="7225964">]</span><span class="builtintype" id="7225965">string</span><span class="op" id="7225971">{</span><span class="string" id="7225972">&#34;test.example.com&#34;</span><span class="op" id="7225990">}</span><span class="op" id="7225991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225996">EmailAddresses</span><span class="op" id="7226010">:</span>&nbsp;<span class="op" id="7226012">[</span><span class="op" id="7226013">]</span><span class="builtintype" id="7226014">string</span><span class="op" id="7226020">{</span><span class="string" id="7226021">&#34;gopher@golang.org&#34;</span><span class="op" id="7226040">}</span><span class="op" id="7226041">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226046">IPAddresses</span><span class="op" id="7226057">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7226062">[</span><span class="op" id="7226063">]</span><span class="ident" id="7226064">net</span><span class="op" id="7226067">.</span><span class="ident" id="7226068">IP</span><span class="op" id="7226070">{</span><span class="ident" id="7226071">net</span><span class="op" id="7226074">.</span><span class="ident" id="7226075">IPv4</span><span class="op" id="7226079">(</span><span class="num" id="7226080">127</span><span class="op" id="7226083">,</span>&nbsp;<span class="num" id="7226085">0</span><span class="op" id="7226086">,</span>&nbsp;<span class="num" id="7226088">0</span><span class="op" id="7226089">,</span>&nbsp;<span class="num" id="7226091">1</span><span class="op" id="7226092">)</span><span class="op" id="7226093">.</span><span class="ident" id="7226094">To4</span><span class="op" id="7226097">(</span><span class="op" id="7226098">)</span><span class="op" id="7226099">,</span>&nbsp;<span class="ident" id="7226101">net</span><span class="op" id="7226104">.</span><span class="ident" id="7226105">ParseIP</span><span class="op" id="7226112">(</span><span class="string" id="7226113">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="7226135">)</span><span class="op" id="7226136">}</span><span class="op" id="7226137">,</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226143">PolicyIdentifiers</span><span class="op" id="7226160">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7226164">[</span><span class="op" id="7226165">]</span><span class="ident" id="7226166">asn1</span><span class="op" id="7226170">.</span><span class="ident" id="7226171">ObjectIdentifier</span><span class="op" id="7226187">{</span><span class="op" id="7226188">[</span><span class="op" id="7226189">]</span><span class="builtintype" id="7226190">int</span><span class="op" id="7226193">{</span><span class="num" id="7226194">1</span><span class="op" id="7226195">,</span>&nbsp;<span class="num" id="7226197">2</span><span class="op" id="7226198">,</span>&nbsp;<span class="num" id="7226200">3</span><span class="op" id="7226201">}</span><span class="op" id="7226202">}</span><span class="op" id="7226203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226208">PermittedDNSDomains</span><span class="op" id="7226227">:</span>&nbsp;<span class="op" id="7226229">[</span><span class="op" id="7226230">]</span><span class="builtintype" id="7226231">string</span><span class="op" id="7226237">{</span><span class="string" id="7226238">&#34;.example.com&#34;</span><span class="op" id="7226252">,</span>&nbsp;<span class="string" id="7226254">&#34;example.com&#34;</span><span class="op" id="7226267">}</span><span class="op" id="7226268">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226274">CRLDistributionPoints</span><span class="op" id="7226295">:</span>&nbsp;<span class="op" id="7226297">[</span><span class="op" id="7226298">]</span><span class="builtintype" id="7226299">string</span><span class="op" id="7226305">{</span><span class="string" id="7226306">&#34;http://crl1.example.com/ca1.crl&#34;</span><span class="op" id="7226339">,</span>&nbsp;<span class="string" id="7226341">&#34;http://crl2.example.com/ca1.crl&#34;</span><span class="op" id="7226374">}</span><span class="op" id="7226375">,</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226381">ExtraExtensions</span><span class="op" id="7226396">:</span>&nbsp;<span class="op" id="7226398">[</span><span class="op" id="7226399">]</span><span class="ident" id="7226400">pkix</span><span class="op" id="7226404">.</span><span class="ident" id="7226405">Extension</span><span class="op" id="7226414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7226420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226427">Id</span><span class="op" id="7226429">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7226434">[</span><span class="op" id="7226435">]</span><span class="builtintype" id="7226436">int</span><span class="op" id="7226439">{</span><span class="num" id="7226440">1</span><span class="op" id="7226441">,</span>&nbsp;<span class="num" id="7226443">2</span><span class="op" id="7226444">,</span>&nbsp;<span class="num" id="7226446">3</span><span class="op" id="7226447">,</span>&nbsp;<span class="num" id="7226449">4</span><span class="op" id="7226450">}</span><span class="op" id="7226451">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226458">Value</span><span class="op" id="7226463">:</span>&nbsp;<span class="ident" id="7226465">extraExtensionData</span><span class="op" id="7226483">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7226489">}</span><span class="op" id="7226490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7226496">//&nbsp;This&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;SubjectKeyId,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7226559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226566">Id</span><span class="op" id="7226568">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7226576">oidExtensionSubjectKeyId</span><span class="op" id="7226600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226607">Critical</span><span class="op" id="7226615">:</span>&nbsp;<span class="builtintype" id="7226617">false</span><span class="op" id="7226622">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226629">Value</span><span class="op" id="7226634">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7226639">[</span><span class="op" id="7226640">]</span><span class="builtintype" id="7226641">byte</span><span class="op" id="7226645">{</span><span class="num" id="7226646">0x04</span><span class="op" id="7226650">,</span>&nbsp;<span class="num" id="7226652">0x04</span><span class="op" id="7226656">,</span>&nbsp;<span class="num" id="7226658">4</span><span class="op" id="7226659">,</span>&nbsp;<span class="num" id="7226661">3</span><span class="op" id="7226662">,</span>&nbsp;<span class="num" id="7226664">2</span><span class="op" id="7226665">,</span>&nbsp;<span class="num" id="7226667">1</span><span class="op" id="7226668">}</span><span class="op" id="7226669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7226675">}</span><span class="op" id="7226676">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7226681">}</span><span class="op" id="7226682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7226686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226691">derBytes</span><span class="op" id="7226699">,</span>&nbsp;<span class="ident" id="7226701">err</span>&nbsp;<span class="op" id="7226705">:=</span>&nbsp;<span class="ident" id="7226708">CreateCertificate</span><span class="op" id="7226725">(</span><span class="ident" id="7226726">random</span><span class="op" id="7226732">,</span>&nbsp;<span class="op" id="7226734">&amp;</span><span class="ident" id="7226735">template</span><span class="op" id="7226743">,</span>&nbsp;<span class="op" id="7226745">&amp;</span><span class="ident" id="7226746">template</span><span class="op" id="7226754">,</span>&nbsp;<span class="ident" id="7226756">test</span><span class="op" id="7226760">.</span><span class="ident" id="7226761">pub</span><span class="op" id="7226764">,</span>&nbsp;<span class="ident" id="7226766">test</span><span class="op" id="7226770">.</span><span class="ident" id="7226771">priv</span><span class="op" id="7226775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7226779">if</span>&nbsp;<span class="ident" id="7226782">err</span>&nbsp;<span class="op" id="7226786">!=</span>&nbsp;<span class="ident" id="7226789">nil</span>&nbsp;<span class="op" id="7226793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226798">t</span><span class="op" id="7226799">.</span><span class="ident" id="7226800">Errorf</span><span class="op" id="7226806">(</span><span class="string" id="7226807">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7226845">,</span>&nbsp;<span class="ident" id="7226847">test</span><span class="op" id="7226851">.</span><span class="ident" id="7226852">name</span><span class="op" id="7226856">,</span>&nbsp;<span class="ident" id="7226858">err</span><span class="op" id="7226861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7226866">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7226877">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226882">cert</span><span class="op" id="7226886">,</span>&nbsp;<span class="ident" id="7226888">err</span>&nbsp;<span class="op" id="7226892">:=</span>&nbsp;<span class="ident" id="7226895">ParseCertificate</span><span class="op" id="7226911">(</span><span class="ident" id="7226912">derBytes</span><span class="op" id="7226920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7226924">if</span>&nbsp;<span class="ident" id="7226927">err</span>&nbsp;<span class="op" id="7226931">!=</span>&nbsp;<span class="ident" id="7226934">nil</span>&nbsp;<span class="op" id="7226938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226943">t</span><span class="op" id="7226944">.</span><span class="ident" id="7226945">Errorf</span><span class="op" id="7226951">(</span><span class="string" id="7226952">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7226989">,</span>&nbsp;<span class="ident" id="7226991">test</span><span class="op" id="7226995">.</span><span class="ident" id="7226996">name</span><span class="op" id="7227000">,</span>&nbsp;<span class="ident" id="7227002">err</span><span class="op" id="7227005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7227010">continue</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7227021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7227026">if</span>&nbsp;<span class="builtinfunc" id="7227029">len</span><span class="op" id="7227032">(</span><span class="ident" id="7227033">cert</span><span class="op" id="7227037">.</span><span class="ident" id="7227038">PolicyIdentifiers</span><span class="op" id="7227055">)</span>&nbsp;<span class="op" id="7227057">!=</span>&nbsp;<span class="num" id="7227060">1</span>&nbsp;<span class="op" id="7227062">||</span>&nbsp;<span class="op" id="7227065">!</span><span class="ident" id="7227066">cert</span><span class="op" id="7227070">.</span><span class="ident" id="7227071">PolicyIdentifiers</span><span class="op" id="7227088">[</span><span class="num" id="7227089">0</span><span class="op" id="7227090">]</span><span class="op" id="7227091">.</span><span class="ident" id="7227092">Equal</span><span class="op" id="7227097">(</span><span class="ident" id="7227098">template</span><span class="op" id="7227106">.</span><span class="ident" id="7227107">PolicyIdentifiers</span><span class="op" id="7227124">[</span><span class="num" id="7227125">0</span><span class="op" id="7227126">]</span><span class="op" id="7227127">)</span>&nbsp;<span class="op" id="7227129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227134">t</span><span class="op" id="7227135">.</span><span class="ident" id="7227136">Errorf</span><span class="op" id="7227142">(</span><span class="string" id="7227143">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;policy&nbsp;identifiers:&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="7227201">,</span>&nbsp;<span class="ident" id="7227203">test</span><span class="op" id="7227207">.</span><span class="ident" id="7227208">name</span><span class="op" id="7227212">,</span>&nbsp;<span class="ident" id="7227214">cert</span><span class="op" id="7227218">.</span><span class="ident" id="7227219">PolicyIdentifiers</span><span class="op" id="7227236">,</span>&nbsp;<span class="ident" id="7227238">template</span><span class="op" id="7227246">.</span><span class="ident" id="7227247">PolicyIdentifiers</span><span class="op" id="7227264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7227268">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7227273">if</span>&nbsp;<span class="builtinfunc" id="7227276">len</span><span class="op" id="7227279">(</span><span class="ident" id="7227280">cert</span><span class="op" id="7227284">.</span><span class="ident" id="7227285">PermittedDNSDomains</span><span class="op" id="7227304">)</span>&nbsp;<span class="op" id="7227306">!=</span>&nbsp;<span class="num" id="7227309">2</span>&nbsp;<span class="op" id="7227311">||</span>&nbsp;<span class="ident" id="7227314">cert</span><span class="op" id="7227318">.</span><span class="ident" id="7227319">PermittedDNSDomains</span><span class="op" id="7227338">[</span><span class="num" id="7227339">0</span><span class="op" id="7227340">]</span>&nbsp;<span class="op" id="7227342">!=</span>&nbsp;<span class="string" id="7227345">&#34;.example.com&#34;</span>&nbsp;<span class="op" id="7227360">||</span>&nbsp;<span class="ident" id="7227363">cert</span><span class="op" id="7227367">.</span><span class="ident" id="7227368">PermittedDNSDomains</span><span class="op" id="7227387">[</span><span class="num" id="7227388">1</span><span class="op" id="7227389">]</span>&nbsp;<span class="op" id="7227391">!=</span>&nbsp;<span class="string" id="7227394">&#34;example.com&#34;</span>&nbsp;<span class="op" id="7227408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227413">t</span><span class="op" id="7227414">.</span><span class="ident" id="7227415">Errorf</span><span class="op" id="7227421">(</span><span class="string" id="7227422">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;name&nbsp;constraints:&nbsp;%#v&#34;</span><span class="op" id="7227465">,</span>&nbsp;<span class="ident" id="7227467">test</span><span class="op" id="7227471">.</span><span class="ident" id="7227472">name</span><span class="op" id="7227476">,</span>&nbsp;<span class="ident" id="7227478">cert</span><span class="op" id="7227482">.</span><span class="ident" id="7227483">PermittedDNSDomains</span><span class="op" id="7227502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7227506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7227511">if</span>&nbsp;<span class="ident" id="7227514">cert</span><span class="op" id="7227518">.</span><span class="ident" id="7227519">Subject</span><span class="op" id="7227526">.</span><span class="ident" id="7227527">CommonName</span>&nbsp;<span class="op" id="7227538">!=</span>&nbsp;<span class="ident" id="7227541">commonName</span>&nbsp;<span class="op" id="7227552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227557">t</span><span class="op" id="7227558">.</span><span class="ident" id="7227559">Errorf</span><span class="op" id="7227565">(</span><span class="string" id="7227566">&#34;%s:&nbsp;subject&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7227638">,</span>&nbsp;<span class="ident" id="7227640">test</span><span class="op" id="7227644">.</span><span class="ident" id="7227645">name</span><span class="op" id="7227649">,</span>&nbsp;<span class="ident" id="7227651">cert</span><span class="op" id="7227655">.</span><span class="ident" id="7227656">Subject</span><span class="op" id="7227663">.</span><span class="ident" id="7227664">CommonName</span><span class="op" id="7227674">,</span>&nbsp;<span class="ident" id="7227676">commonName</span><span class="op" id="7227686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7227690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7227695">if</span>&nbsp;<span class="ident" id="7227698">cert</span><span class="op" id="7227702">.</span><span class="ident" id="7227703">Issuer</span><span class="op" id="7227709">.</span><span class="ident" id="7227710">CommonName</span>&nbsp;<span class="op" id="7227721">!=</span>&nbsp;<span class="ident" id="7227724">commonName</span>&nbsp;<span class="op" id="7227735">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227740">t</span><span class="op" id="7227741">.</span><span class="ident" id="7227742">Errorf</span><span class="op" id="7227748">(</span><span class="string" id="7227749">&#34;%s:&nbsp;issuer&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7227820">,</span>&nbsp;<span class="ident" id="7227822">test</span><span class="op" id="7227826">.</span><span class="ident" id="7227827">name</span><span class="op" id="7227831">,</span>&nbsp;<span class="ident" id="7227833">cert</span><span class="op" id="7227837">.</span><span class="ident" id="7227838">Issuer</span><span class="op" id="7227844">.</span><span class="ident" id="7227845">CommonName</span><span class="op" id="7227855">,</span>&nbsp;<span class="ident" id="7227857">commonName</span><span class="op" id="7227867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7227871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7227876">if</span>&nbsp;<span class="ident" id="7227879">cert</span><span class="op" id="7227883">.</span><span class="ident" id="7227884">SignatureAlgorithm</span>&nbsp;<span class="op" id="7227903">!=</span>&nbsp;<span class="ident" id="7227906">test</span><span class="op" id="7227910">.</span><span class="ident" id="7227911">sigAlgo</span>&nbsp;<span class="op" id="7227919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227924">t</span><span class="op" id="7227925">.</span><span class="ident" id="7227926">Errorf</span><span class="op" id="7227932">(</span><span class="string" id="7227933">&#34;%s:&nbsp;SignatureAlgorithm&nbsp;wasn&#39;t&nbsp;copied&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7228002">,</span>&nbsp;<span class="ident" id="7228004">test</span><span class="op" id="7228008">.</span><span class="ident" id="7228009">name</span><span class="op" id="7228013">,</span>&nbsp;<span class="ident" id="7228015">cert</span><span class="op" id="7228019">.</span><span class="ident" id="7228020">SignatureAlgorithm</span><span class="op" id="7228038">,</span>&nbsp;<span class="ident" id="7228040">test</span><span class="op" id="7228044">.</span><span class="ident" id="7228045">sigAlgo</span><span class="op" id="7228052">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7228056">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7228061">if</span>&nbsp;<span class="op" id="7228064">!</span><span class="ident" id="7228065">reflect</span><span class="op" id="7228072">.</span><span class="ident" id="7228073">DeepEqual</span><span class="op" id="7228082">(</span><span class="ident" id="7228083">cert</span><span class="op" id="7228087">.</span><span class="ident" id="7228088">ExtKeyUsage</span><span class="op" id="7228099">,</span>&nbsp;<span class="ident" id="7228101">testExtKeyUsage</span><span class="op" id="7228116">)</span>&nbsp;<span class="op" id="7228118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7228123">t</span><span class="op" id="7228124">.</span><span class="ident" id="7228125">Errorf</span><span class="op" id="7228131">(</span><span class="string" id="7228132">&#34;%s:&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7228208">,</span>&nbsp;<span class="ident" id="7228210">test</span><span class="op" id="7228214">.</span><span class="ident" id="7228215">name</span><span class="op" id="7228219">,</span>&nbsp;<span class="ident" id="7228221">cert</span><span class="op" id="7228225">.</span><span class="ident" id="7228226">ExtKeyUsage</span><span class="op" id="7228237">,</span>&nbsp;<span class="ident" id="7228239">testExtKeyUsage</span><span class="op" id="7228254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7228258">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7228263">if</span>&nbsp;<span class="op" id="7228266">!</span><span class="ident" id="7228267">reflect</span><span class="op" id="7228274">.</span><span class="ident" id="7228275">DeepEqual</span><span class="op" id="7228284">(</span><span class="ident" id="7228285">cert</span><span class="op" id="7228289">.</span><span class="ident" id="7228290">UnknownExtKeyUsage</span><span class="op" id="7228308">,</span>&nbsp;<span class="ident" id="7228310">testUnknownExtKeyUsage</span><span class="op" id="7228332">)</span>&nbsp;<span class="op" id="7228334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7228339">t</span><span class="op" id="7228340">.</span><span class="ident" id="7228341">Errorf</span><span class="op" id="7228347">(</span><span class="string" id="7228348">&#34;%s:&nbsp;unknown&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7228432">,</span>&nbsp;<span class="ident" id="7228434">test</span><span class="op" id="7228438">.</span><span class="ident" id="7228439">name</span><span class="op" id="7228443">,</span>&nbsp;<span class="ident" id="7228445">cert</span><span class="op" id="7228449">.</span><span class="ident" id="7228450">UnknownExtKeyUsage</span><span class="op" id="7228468">,</span>&nbsp;<span class="ident" id="7228470">testUnknownExtKeyUsage</span><span class="op" id="7228492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7228496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7228501">if</span>&nbsp;<span class="op" id="7228504">!</span><span class="ident" id="7228505">reflect</span><span class="op" id="7228512">.</span><span class="ident" id="7228513">DeepEqual</span><span class="op" id="7228522">(</span><span class="ident" id="7228523">cert</span><span class="op" id="7228527">.</span><span class="ident" id="7228528">OCSPServer</span><span class="op" id="7228538">,</span>&nbsp;<span class="ident" id="7228540">template</span><span class="op" id="7228548">.</span><span class="ident" id="7228549">OCSPServer</span><span class="op" id="7228559">)</span>&nbsp;<span class="op" id="7228561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7228566">t</span><span class="op" id="7228567">.</span><span class="ident" id="7228568">Errorf</span><span class="op" id="7228574">(</span><span class="string" id="7228575">&#34;%s:&nbsp;OCSP&nbsp;servers&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7228631">,</span>&nbsp;<span class="ident" id="7228633">test</span><span class="op" id="7228637">.</span><span class="ident" id="7228638">name</span><span class="op" id="7228642">,</span>&nbsp;<span class="ident" id="7228644">cert</span><span class="op" id="7228648">.</span><span class="ident" id="7228649">OCSPServer</span><span class="op" id="7228659">,</span>&nbsp;<span class="ident" id="7228661">template</span><span class="op" id="7228669">.</span><span class="ident" id="7228670">OCSPServer</span><span class="op" id="7228680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7228684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7228689">if</span>&nbsp;<span class="op" id="7228692">!</span><span class="ident" id="7228693">reflect</span><span class="op" id="7228700">.</span><span class="ident" id="7228701">DeepEqual</span><span class="op" id="7228710">(</span><span class="ident" id="7228711">cert</span><span class="op" id="7228715">.</span><span class="ident" id="7228716">IssuingCertificateURL</span><span class="op" id="7228737">,</span>&nbsp;<span class="ident" id="7228739">template</span><span class="op" id="7228747">.</span><span class="ident" id="7228748">IssuingCertificateURL</span><span class="op" id="7228769">)</span>&nbsp;<span class="op" id="7228771">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7228776">t</span><span class="op" id="7228777">.</span><span class="ident" id="7228778">Errorf</span><span class="op" id="7228784">(</span><span class="string" id="7228785">&#34;%s:&nbsp;Issuing&nbsp;certificate&nbsp;URLs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7228853">,</span>&nbsp;<span class="ident" id="7228855">test</span><span class="op" id="7228859">.</span><span class="ident" id="7228860">name</span><span class="op" id="7228864">,</span>&nbsp;<span class="ident" id="7228866">cert</span><span class="op" id="7228870">.</span><span class="ident" id="7228871">IssuingCertificateURL</span><span class="op" id="7228892">,</span>&nbsp;<span class="ident" id="7228894">template</span><span class="op" id="7228902">.</span><span class="ident" id="7228903">IssuingCertificateURL</span><span class="op" id="7228924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7228928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7228933">if</span>&nbsp;<span class="op" id="7228936">!</span><span class="ident" id="7228937">reflect</span><span class="op" id="7228944">.</span><span class="ident" id="7228945">DeepEqual</span><span class="op" id="7228954">(</span><span class="ident" id="7228955">cert</span><span class="op" id="7228959">.</span><span class="ident" id="7228960">DNSNames</span><span class="op" id="7228968">,</span>&nbsp;<span class="ident" id="7228970">template</span><span class="op" id="7228978">.</span><span class="ident" id="7228979">DNSNames</span><span class="op" id="7228987">)</span>&nbsp;<span class="op" id="7228989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7228994">t</span><span class="op" id="7228995">.</span><span class="ident" id="7228996">Errorf</span><span class="op" id="7229002">(</span><span class="string" id="7229003">&#34;%s:&nbsp;SAN&nbsp;DNS&nbsp;names&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7229060">,</span>&nbsp;<span class="ident" id="7229062">test</span><span class="op" id="7229066">.</span><span class="ident" id="7229067">name</span><span class="op" id="7229071">,</span>&nbsp;<span class="ident" id="7229073">cert</span><span class="op" id="7229077">.</span><span class="ident" id="7229078">DNSNames</span><span class="op" id="7229086">,</span>&nbsp;<span class="ident" id="7229088">template</span><span class="op" id="7229096">.</span><span class="ident" id="7229097">DNSNames</span><span class="op" id="7229105">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7229109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7229114">if</span>&nbsp;<span class="op" id="7229117">!</span><span class="ident" id="7229118">reflect</span><span class="op" id="7229125">.</span><span class="ident" id="7229126">DeepEqual</span><span class="op" id="7229135">(</span><span class="ident" id="7229136">cert</span><span class="op" id="7229140">.</span><span class="ident" id="7229141">EmailAddresses</span><span class="op" id="7229155">,</span>&nbsp;<span class="ident" id="7229157">template</span><span class="op" id="7229165">.</span><span class="ident" id="7229166">EmailAddresses</span><span class="op" id="7229180">)</span>&nbsp;<span class="op" id="7229182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7229187">t</span><span class="op" id="7229188">.</span><span class="ident" id="7229189">Errorf</span><span class="op" id="7229195">(</span><span class="string" id="7229196">&#34;%s:&nbsp;SAN&nbsp;emails&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7229250">,</span>&nbsp;<span class="ident" id="7229252">test</span><span class="op" id="7229256">.</span><span class="ident" id="7229257">name</span><span class="op" id="7229261">,</span>&nbsp;<span class="ident" id="7229263">cert</span><span class="op" id="7229267">.</span><span class="ident" id="7229268">EmailAddresses</span><span class="op" id="7229282">,</span>&nbsp;<span class="ident" id="7229284">template</span><span class="op" id="7229292">.</span><span class="ident" id="7229293">EmailAddresses</span><span class="op" id="7229307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7229311">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7229316">if</span>&nbsp;<span class="op" id="7229319">!</span><span class="ident" id="7229320">reflect</span><span class="op" id="7229327">.</span><span class="ident" id="7229328">DeepEqual</span><span class="op" id="7229337">(</span><span class="ident" id="7229338">cert</span><span class="op" id="7229342">.</span><span class="ident" id="7229343">IPAddresses</span><span class="op" id="7229354">,</span>&nbsp;<span class="ident" id="7229356">template</span><span class="op" id="7229364">.</span><span class="ident" id="7229365">IPAddresses</span><span class="op" id="7229376">)</span>&nbsp;<span class="op" id="7229378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7229383">t</span><span class="op" id="7229384">.</span><span class="ident" id="7229385">Errorf</span><span class="op" id="7229391">(</span><span class="string" id="7229392">&#34;%s:&nbsp;SAN&nbsp;IPs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7229443">,</span>&nbsp;<span class="ident" id="7229445">test</span><span class="op" id="7229449">.</span><span class="ident" id="7229450">name</span><span class="op" id="7229454">,</span>&nbsp;<span class="ident" id="7229456">cert</span><span class="op" id="7229460">.</span><span class="ident" id="7229461">IPAddresses</span><span class="op" id="7229472">,</span>&nbsp;<span class="ident" id="7229474">template</span><span class="op" id="7229482">.</span><span class="ident" id="7229483">IPAddresses</span><span class="op" id="7229494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7229498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7229503">if</span>&nbsp;<span class="op" id="7229506">!</span><span class="ident" id="7229507">reflect</span><span class="op" id="7229514">.</span><span class="ident" id="7229515">DeepEqual</span><span class="op" id="7229524">(</span><span class="ident" id="7229525">cert</span><span class="op" id="7229529">.</span><span class="ident" id="7229530">CRLDistributionPoints</span><span class="op" id="7229551">,</span>&nbsp;<span class="ident" id="7229553">template</span><span class="op" id="7229561">.</span><span class="ident" id="7229562">CRLDistributionPoints</span><span class="op" id="7229583">)</span>&nbsp;<span class="op" id="7229585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7229590">t</span><span class="op" id="7229591">.</span><span class="ident" id="7229592">Errorf</span><span class="op" id="7229598">(</span><span class="string" id="7229599">&#34;%s:&nbsp;CRL&nbsp;distribution&nbsp;points&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7229666">,</span>&nbsp;<span class="ident" id="7229668">test</span><span class="op" id="7229672">.</span><span class="ident" id="7229673">name</span><span class="op" id="7229677">,</span>&nbsp;<span class="ident" id="7229679">cert</span><span class="op" id="7229683">.</span><span class="ident" id="7229684">CRLDistributionPoints</span><span class="op" id="7229705">,</span>&nbsp;<span class="ident" id="7229707">template</span><span class="op" id="7229715">.</span><span class="ident" id="7229716">CRLDistributionPoints</span><span class="op" id="7229737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7229741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7229746">if</span>&nbsp;<span class="op" id="7229749">!</span><span class="ident" id="7229750">bytes</span><span class="op" id="7229755">.</span><span class="ident" id="7229756">Equal</span><span class="op" id="7229761">(</span><span class="ident" id="7229762">cert</span><span class="op" id="7229766">.</span><span class="ident" id="7229767">SubjectKeyId</span><span class="op" id="7229779">,</span>&nbsp;<span class="op" id="7229781">[</span><span class="op" id="7229782">]</span><span class="builtintype" id="7229783">byte</span><span class="op" id="7229787">{</span><span class="num" id="7229788">4</span><span class="op" id="7229789">,</span>&nbsp;<span class="num" id="7229791">3</span><span class="op" id="7229792">,</span>&nbsp;<span class="num" id="7229794">2</span><span class="op" id="7229795">,</span>&nbsp;<span class="num" id="7229797">1</span><span class="op" id="7229798">}</span><span class="op" id="7229799">)</span>&nbsp;<span class="op" id="7229801">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7229806">t</span><span class="op" id="7229807">.</span><span class="ident" id="7229808">Errorf</span><span class="op" id="7229814">(</span><span class="string" id="7229815">&#34;%s:&nbsp;ExtraExtensions&nbsp;didn&#39;t&nbsp;override&nbsp;SubjectKeyId&#34;</span><span class="op" id="7229865">,</span>&nbsp;<span class="ident" id="7229867">test</span><span class="op" id="7229871">.</span><span class="ident" id="7229872">name</span><span class="op" id="7229876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7229880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7229885">if</span>&nbsp;<span class="ident" id="7229888">bytes</span><span class="op" id="7229893">.</span><span class="ident" id="7229894">Index</span><span class="op" id="7229899">(</span><span class="ident" id="7229900">derBytes</span><span class="op" id="7229908">,</span>&nbsp;<span class="ident" id="7229910">extraExtensionData</span><span class="op" id="7229928">)</span>&nbsp;<span class="op" id="7229930">==</span>&nbsp;<span class="op" id="7229933">-</span><span class="num" id="7229934">1</span>&nbsp;<span class="op" id="7229936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7229941">t</span><span class="op" id="7229942">.</span><span class="ident" id="7229943">Errorf</span><span class="op" id="7229949">(</span><span class="string" id="7229950">&#34;%s:&nbsp;didn&#39;t&nbsp;find&nbsp;extra&nbsp;extension&nbsp;in&nbsp;DER&nbsp;output&#34;</span><span class="op" id="7229997">,</span>&nbsp;<span class="ident" id="7229999">test</span><span class="op" id="7230003">.</span><span class="ident" id="7230004">name</span><span class="op" id="7230008">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7230012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7230017">if</span>&nbsp;<span class="ident" id="7230020">test</span><span class="op" id="7230024">.</span><span class="ident" id="7230025">checkSig</span>&nbsp;<span class="op" id="7230034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7230039">err</span>&nbsp;<span class="op" id="7230043">=</span>&nbsp;<span class="ident" id="7230045">cert</span><span class="op" id="7230049">.</span><span class="ident" id="7230050">CheckSignatureFrom</span><span class="op" id="7230068">(</span><span class="ident" id="7230069">cert</span><span class="op" id="7230073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7230078">if</span>&nbsp;<span class="ident" id="7230081">err</span>&nbsp;<span class="op" id="7230085">!=</span>&nbsp;<span class="ident" id="7230088">nil</span>&nbsp;<span class="op" id="7230092">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7230098">t</span><span class="op" id="7230099">.</span><span class="ident" id="7230100">Errorf</span><span class="op" id="7230106">(</span><span class="string" id="7230107">&#34;%s:&nbsp;signature&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7230146">,</span>&nbsp;<span class="ident" id="7230148">test</span><span class="op" id="7230152">.</span><span class="ident" id="7230153">name</span><span class="op" id="7230157">,</span>&nbsp;<span class="ident" id="7230159">err</span><span class="op" id="7230162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7230167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7230171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7230174">}</span><br>
<span class="lineno"></span><span class="op" id="7230176">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="comment" id="7230179">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA1&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno"></span><span class="keyword" id="7230240">var</span>&nbsp;<span class="ident" id="7230244">ecdsaSHA1CertPem</span>&nbsp;<span class="op" id="7230261">=</span>&nbsp;<span class="string" id="7230263">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDjCCAbUCCQDF6SfN0nsnrjAJBgcqhkjOPQQBMIGPMQswCQYDVQQGEwJVUzET<br>
<span class="lineno">455</span>MBEGA1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwNTW91bnRhaW4gVmlldzEVMBMG<br>
<span class="lineno"></span>A1UECgwMR29vZ2xlLCBJbmMuMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIwMjAyMDUw<br>
<span class="lineno"></span>WhcNMjIwNTE4MjAyMDUwWjCBjzELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTATBgNVBAoMDEdvb2dsZSwg<br>
<span class="lineno">460</span>SW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAhBgkqhkiG9w0BCQEWFGdv<br>
<span class="lineno"></span>bGFuZy1kZXZAZ21haWwuY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE/Wgn<br>
<span class="lineno"></span>WQDo5+bz71T0327ERgd5SDDXFbXLpzIZDXTkjpe8QTEbsF+ezsQfrekrpDPC4Cd3<br>
<span class="lineno"></span>P9LY0tG+aI8IyVKdUjAJBgcqhkjOPQQBA0gAMEUCIGlsqMcRqWVIWTD6wXwe6Jk2<br>
<span class="lineno"></span>DKxL46r/FLgJYnzBEH99AiEA3fBouObsvV1R3oVkb4BQYnD4/4LeId6lAT43YvyV<br>
<span class="lineno">465</span>a/A=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7231042">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno">470</span><span class="keyword" id="7231105">var</span>&nbsp;<span class="ident" id="7231109">ecdsaSHA256p256CertPem</span>&nbsp;<span class="op" id="7231132">=</span>&nbsp;<span class="string" id="7231134">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDzCCAbYCCQDlsuMWvgQzhTAKBggqhkjOPQQDAjCBjzELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTAT<br>
<span class="lineno"></span>BgNVBAoMDEdvb2dsZSwgSW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAh<br>
<span class="lineno">475</span>BgkqhkiG9w0BCQEWFGdvbGFuZy1kZXZAZ21haWwuY29tMB4XDTEyMDUyMTAwMTkx<br>
<span class="lineno"></span>NloXDTIyMDUxOTAwMTkxNlowgY8xCzAJBgNVBAYTAlVTMRMwEQYDVQQIDApDYWxp<br>
<span class="lineno"></span>Zm9ybmlhMRYwFAYDVQQHDA1Nb3VudGFpbiBWaWV3MRUwEwYDVQQKDAxHb29nbGUs<br>
<span class="lineno"></span>IEluYy4xFzAVBgNVBAMMDnd3dy5nb29nbGUuY29tMSMwIQYJKoZIhvcNAQkBFhRn<br>
<span class="lineno"></span>b2xhbmctZGV2QGdtYWlsLmNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABPMt<br>
<span class="lineno">480</span>2ErhxAty5EJRu9yM+MTy+hUXm3pdW1ensAv382KoGExSXAFWP7pjJnNtHO+XSwVm<br>
<span class="lineno"></span>YNtqjcAGFKpweoN//kQwCgYIKoZIzj0EAwIDRwAwRAIgIYSaUA/IB81gjbIw/hUV<br>
<span class="lineno"></span>70twxJr5EcgOo0hLp3Jm+EYCIFDO3NNcgmURbJ1kfoS3N/0O+irUtoPw38YoNkqJ<br>
<span class="lineno"></span>h5wi<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno">485</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7231913">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp384r1</span><br>
<span class="lineno"></span><span class="keyword" id="7231976">var</span>&nbsp;<span class="ident" id="7231980">ecdsaSHA256p384CertPem</span>&nbsp;<span class="op" id="7232003">=</span>&nbsp;<span class="string" id="7232005">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno">490</span>MIICSjCCAdECCQDje/no7mXkVzAKBggqhkjOPQQDAjCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMDYxMDM0<br>
<span class="lineno"></span>WhcNMjIwNTE5MDYxMDM0WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno">495</span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno"></span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wdjAQBgcqhkjOPQIBBgUrgQQAIgNiAARRuzRNIKRK<br>
<span class="lineno"></span>jIktEmXanNmrTR/q/FaHXLhWRZ6nHWe26Fw7Rsrbk+VjGy4vfWtNn7xSFKrOu5ze<br>
<span class="lineno"></span>qxKnmE0h5E480MNgrUiRkaGO2GMJJVmxx20aqkXOk59U8yGA4CghE6MwCgYIKoZI<br>
<span class="lineno">500</span>zj0EAwIDZwAwZAIwBZEN8gvmRmfeP/9C1PRLzODIY4JqWub2PLRT4mv9GU+yw3Gr<br>
<span class="lineno"></span>PU9A3CHMdEcdw/MEAjBBO1lId8KOCh9UZunsSMfqXiVurpzmhWd6VYZ/32G+M+Mh<br>
<span class="lineno"></span>3yILeYQzllt/g0rKVRk=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="7232865">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA384&nbsp;&amp;&nbsp;secp521r1</span><br>
<span class="lineno"></span><span class="keyword" id="7232928">var</span>&nbsp;<span class="ident" id="7232932">ecdsaSHA384p521CertPem</span>&nbsp;<span class="op" id="7232955">=</span>&nbsp;<span class="string" id="7232957">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICljCCAfcCCQDhp1AFD/ahKjAKBggqhkjOPQQDAzCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno">510</span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMTUwNDI5<br>
<span class="lineno"></span>WhcNMjIwNTE5MTUwNDI5WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno">515</span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABACqx9Rv<br>
<span class="lineno"></span>IssRs1LWYcNN+WffwlHw4Tv3y8/LIAA9MF1ZScIonU9nRMxt4a2uGJVCPDw6JHpz<br>
<span class="lineno"></span>PaYc0E9puLoE9AfKpwFr59Jkot7dBg55SKPEFkddoip/rvmN7NPAWjMBirOwjOkm<br>
<span class="lineno"></span>8FPthvPhGPqsu9AvgVuHu3PosWiHGNrhh379pva8MzAKBggqhkjOPQQDAwOBjAAw<br>
<span class="lineno">520</span>gYgCQgEHNmswkUdPpHqrVxp9PvLVl+xxPuHBkT+75z9JizyxtqykHQo9Uh6SWCYH<br>
<span class="lineno"></span>BF9KLolo01wMt8DjoYP5Fb3j5MH7xwJCAbWZzTOp4l4DPkIvAh4LeC4VWbwPPyqh<br>
<span class="lineno"></span>kBg71w/iEcSY3wUKgHGcJJrObZw7wys91I5kENljqw/Samdr3ka+jBJa<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span><span class="keyword" id="7233918">var</span>&nbsp;<span class="ident" id="7233922">ecdsaTests</span>&nbsp;<span class="op" id="7233933">=</span>&nbsp;<span class="op" id="7233935">[</span><span class="op" id="7233936">]</span><span class="keyword" id="7233937">struct</span>&nbsp;<span class="op" id="7233944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7233947">sigAlgo</span>&nbsp;<span class="ident" id="7233955">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7233975">pemCert</span>&nbsp;<span class="builtintype" id="7233983">string</span><br>
<span class="lineno"></span><span class="op" id="7233990">}</span><span class="op" id="7233991">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7233994">{</span><span class="ident" id="7233995">ECDSAWithSHA1</span><span class="op" id="7234008">,</span>&nbsp;<span class="ident" id="7234010">ecdsaSHA1CertPem</span><span class="op" id="7234026">}</span><span class="op" id="7234027">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7234030">{</span><span class="ident" id="7234031">ECDSAWithSHA256</span><span class="op" id="7234046">,</span>&nbsp;<span class="ident" id="7234048">ecdsaSHA256p256CertPem</span><span class="op" id="7234070">}</span><span class="op" id="7234071">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7234074">{</span><span class="ident" id="7234075">ECDSAWithSHA256</span><span class="op" id="7234090">,</span>&nbsp;<span class="ident" id="7234092">ecdsaSHA256p384CertPem</span><span class="op" id="7234114">}</span><span class="op" id="7234115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7234118">{</span><span class="ident" id="7234119">ECDSAWithSHA384</span><span class="op" id="7234134">,</span>&nbsp;<span class="ident" id="7234136">ecdsaSHA384p521CertPem</span><span class="op" id="7234158">}</span><span class="op" id="7234159">,</span><br>
<span class="lineno"></span><span class="op" id="7234161">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="7234164">func</span>&nbsp;<span class="ident" id="7234169">TestECDSA</span><span class="op" id="7234178">(</span><span class="ident" id="7234179">t</span>&nbsp;<span class="op" id="7234181">*</span><span class="ident" id="7234182">testing</span><span class="op" id="7234189">.</span><span class="ident" id="7234190">T</span><span class="op" id="7234191">)</span>&nbsp;<span class="op" id="7234193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7234196">for</span>&nbsp;<span class="ident" id="7234200">i</span><span class="op" id="7234201">,</span>&nbsp;<span class="ident" id="7234203">test</span>&nbsp;<span class="op" id="7234208">:=</span>&nbsp;<span class="keyword" id="7234211">range</span>&nbsp;<span class="ident" id="7234217">ecdsaTests</span>&nbsp;<span class="op" id="7234228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7234232">pemBlock</span><span class="op" id="7234240">,</span>&nbsp;<span class="ident" id="7234242">_</span>&nbsp;<span class="op" id="7234244">:=</span>&nbsp;<span class="ident" id="7234247">pem</span><span class="op" id="7234250">.</span><span class="ident" id="7234251">Decode</span><span class="op" id="7234257">(</span><span class="op" id="7234258">[</span><span class="op" id="7234259">]</span><span class="builtintype" id="7234260">byte</span><span class="op" id="7234264">(</span><span class="ident" id="7234265">test</span><span class="op" id="7234269">.</span><span class="ident" id="7234270">pemCert</span><span class="op" id="7234277">)</span><span class="op" id="7234278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7234282">cert</span><span class="op" id="7234286">,</span>&nbsp;<span class="ident" id="7234288">err</span>&nbsp;<span class="op" id="7234292">:=</span>&nbsp;<span class="ident" id="7234295">ParseCertificate</span><span class="op" id="7234311">(</span><span class="ident" id="7234312">pemBlock</span><span class="op" id="7234320">.</span><span class="ident" id="7234321">Bytes</span><span class="op" id="7234326">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7234330">if</span>&nbsp;<span class="ident" id="7234333">err</span>&nbsp;<span class="op" id="7234337">!=</span>&nbsp;<span class="ident" id="7234340">nil</span>&nbsp;<span class="op" id="7234344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7234349">t</span><span class="op" id="7234350">.</span><span class="ident" id="7234351">Errorf</span><span class="op" id="7234357">(</span><span class="string" id="7234358">&#34;%d:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7234395">,</span>&nbsp;<span class="ident" id="7234397">i</span><span class="op" id="7234398">,</span>&nbsp;<span class="ident" id="7234400">err</span><span class="op" id="7234403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7234408">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7234419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7234423">if</span>&nbsp;<span class="ident" id="7234426">sa</span>&nbsp;<span class="op" id="7234429">:=</span>&nbsp;<span class="ident" id="7234432">cert</span><span class="op" id="7234436">.</span><span class="ident" id="7234437">SignatureAlgorithm</span><span class="op" id="7234455">;</span>&nbsp;<span class="ident" id="7234457">sa</span>&nbsp;<span class="op" id="7234460">!=</span>&nbsp;<span class="ident" id="7234463">test</span><span class="op" id="7234467">.</span><span class="ident" id="7234468">sigAlgo</span>&nbsp;<span class="op" id="7234476">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7234481">t</span><span class="op" id="7234482">.</span><span class="ident" id="7234483">Errorf</span><span class="op" id="7234489">(</span><span class="string" id="7234490">&#34;%d:&nbsp;signature&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7234530">,</span>&nbsp;<span class="ident" id="7234532">i</span><span class="op" id="7234533">,</span>&nbsp;<span class="ident" id="7234535">sa</span><span class="op" id="7234537">,</span>&nbsp;<span class="ident" id="7234539">test</span><span class="op" id="7234543">.</span><span class="ident" id="7234544">sigAlgo</span><span class="op" id="7234551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7234555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7234559">if</span>&nbsp;<span class="ident" id="7234562">parsedKey</span><span class="op" id="7234571">,</span>&nbsp;<span class="ident" id="7234573">ok</span>&nbsp;<span class="op" id="7234576">:=</span>&nbsp;<span class="ident" id="7234579">cert</span><span class="op" id="7234583">.</span><span class="ident" id="7234584">PublicKey</span><span class="op" id="7234593">.</span><span class="op" id="7234594">(</span><span class="op" id="7234595">*</span><span class="ident" id="7234596">ecdsa</span><span class="op" id="7234601">.</span><span class="ident" id="7234602">PublicKey</span><span class="op" id="7234611">)</span><span class="op" id="7234612">;</span>&nbsp;<span class="op" id="7234614">!</span><span class="ident" id="7234615">ok</span>&nbsp;<span class="op" id="7234618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7234623">t</span><span class="op" id="7234624">.</span><span class="ident" id="7234625">Errorf</span><span class="op" id="7234631">(</span><span class="string" id="7234632">&#34;%d:&nbsp;wanted&nbsp;an&nbsp;ECDSA&nbsp;public&nbsp;key&nbsp;but&nbsp;found:&nbsp;%#v&#34;</span><span class="op" id="7234679">,</span>&nbsp;<span class="ident" id="7234681">i</span><span class="op" id="7234682">,</span>&nbsp;<span class="ident" id="7234684">parsedKey</span><span class="op" id="7234693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7234697">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7234701">if</span>&nbsp;<span class="ident" id="7234704">pka</span>&nbsp;<span class="op" id="7234708">:=</span>&nbsp;<span class="ident" id="7234711">cert</span><span class="op" id="7234715">.</span><span class="ident" id="7234716">PublicKeyAlgorithm</span><span class="op" id="7234734">;</span>&nbsp;<span class="ident" id="7234736">pka</span>&nbsp;<span class="op" id="7234740">!=</span>&nbsp;<span class="ident" id="7234743">ECDSA</span>&nbsp;<span class="op" id="7234749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7234754">t</span><span class="op" id="7234755">.</span><span class="ident" id="7234756">Errorf</span><span class="op" id="7234762">(</span><span class="string" id="7234763">&#34;%d:&nbsp;public&nbsp;key&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;ECDSA&#34;</span><span class="op" id="7234807">,</span>&nbsp;<span class="ident" id="7234809">i</span><span class="op" id="7234810">,</span>&nbsp;<span class="ident" id="7234812">pka</span><span class="op" id="7234815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7234819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7234823">if</span>&nbsp;<span class="ident" id="7234826">err</span>&nbsp;<span class="op" id="7234830">=</span>&nbsp;<span class="ident" id="7234832">cert</span><span class="op" id="7234836">.</span><span class="ident" id="7234837">CheckSignatureFrom</span><span class="op" id="7234855">(</span><span class="ident" id="7234856">cert</span><span class="op" id="7234860">)</span><span class="op" id="7234861">;</span>&nbsp;<span class="ident" id="7234863">err</span>&nbsp;<span class="op" id="7234867">!=</span>&nbsp;<span class="ident" id="7234870">nil</span>&nbsp;<span class="op" id="7234874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7234879">t</span><span class="op" id="7234880">.</span><span class="ident" id="7234881">Errorf</span><span class="op" id="7234887">(</span><span class="string" id="7234888">&#34;%d:&nbsp;certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7234929">,</span>&nbsp;<span class="ident" id="7234931">i</span><span class="op" id="7234932">,</span>&nbsp;<span class="ident" id="7234934">err</span><span class="op" id="7234937">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7234941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7234944">}</span><br>
<span class="lineno"></span><span class="op" id="7234946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7234949">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;DSA&nbsp;with&nbsp;SHA1</span><br>
<span class="lineno">560</span><span class="keyword" id="7234996">var</span>&nbsp;<span class="ident" id="7235000">dsaCertPem</span>&nbsp;<span class="op" id="7235011">=</span>&nbsp;<span class="string" id="7235013">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIEDTCCA82gAwIBAgIJALHPghaoxeDhMAkGByqGSM44BAMweTELMAkGA1UEBhMC<br>
<span class="lineno"></span>VVMxCzAJBgNVBAgTAk5DMQ8wDQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2ds<br>
<span class="lineno"></span>ZSwgSW5jMRIwEAYDVQQDEwlKb24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFs<br>
<span class="lineno"></span>bGllQGdvb2dsZS5jb20wHhcNMTEwNTE0MDMwMTQ1WhcNMTEwNjEzMDMwMTQ1WjB5<br>
<span class="lineno">565</span>MQswCQYDVQQGEwJVUzELMAkGA1UECBMCTkMxDzANBgNVBAcTBk5ld3RvbjEUMBIG<br>
<span class="lineno"></span>A1UEChMLR29vZ2xlLCBJbmMxEjAQBgNVBAMTCUpvbiBBbGxpZTEiMCAGCSqGSIb3<br>
<span class="lineno"></span>DQEJARYTam9uYWxsaWVAZ29vZ2xlLmNvbTCCAbcwggEsBgcqhkjOOAQBMIIBHwKB<br>
<span class="lineno"></span>gQC8hLUnQ7FpFYu4WXTj6DKvXvz8QrJkNJCVMTpKAT7uBpobk32S5RrPKXocd4gN<br>
<span class="lineno"></span>8lyGB9ggS03EVlEwXvSmO0DH2MQtke2jl9j1HLydClMf4sbx5V6TV9IFw505U1iW<br>
<span class="lineno">570</span>jL7awRMgxge+FsudtJK254FjMFo03ZnOQ8ZJJ9E6AEDrlwIVAJpnBn9moyP11Ox5<br>
<span class="lineno"></span>Asc/5dnjb6dPAoGBAJFHd4KVv1iTVCvEG6gGiYop5DJh28hUQcN9kul+2A0yPUSC<br>
<span class="lineno"></span>X93oN00P8Vh3eYgSaCWZsha7zDG53MrVJ0Zf6v/X/CoZNhLldeNOepivTRAzn+Rz<br>
<span class="lineno"></span>kKUYy5l1sxYLHQKF0UGNCXfFKZT0PCmgU+PWhYNBBMn6/cIh44vp85ideo5CA4GE<br>
<span class="lineno"></span>AAKBgFmifCafzeRaohYKXJgMGSEaggCVCRq5xdyDCat+wbOkjC4mfG01/um3G8u5<br>
<span class="lineno">575</span>LxasjlWRKTR/tcAL7t0QuokVyQaYdVypZXNaMtx1db7YBuHjj3aP+8JOQRI9xz8c<br>
<span class="lineno"></span>bp5NDJ5pISiFOv4p3GZfqZPcqckDt78AtkQrmnal2txhhjF6o4HeMIHbMB0GA1Ud<br>
<span class="lineno"></span>DgQWBBQVyyr7hO11ZFFpWX50298Sa3V+rzCBqwYDVR0jBIGjMIGggBQVyyr7hO11<br>
<span class="lineno"></span>ZFFpWX50298Sa3V+r6F9pHsweTELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAk5DMQ8w<br>
<span class="lineno"></span>DQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2dsZSwgSW5jMRIwEAYDVQQDEwlK<br>
<span class="lineno">580</span>b24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFsbGllQGdvb2dsZS5jb22CCQCx<br>
<span class="lineno"></span>z4IWqMXg4TAMBgNVHRMEBTADAQH/MAkGByqGSM44BAMDLwAwLAIUPtn/5j8Q1jJI<br>
<span class="lineno"></span>7ggOIsgrhgUdjGQCFCsmDq1H11q9+9Wp9IMeGrTSKHIM<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span><span class="keyword" id="7236481">func</span>&nbsp;<span class="ident" id="7236486">TestParseCertificateWithDsaPublicKey</span><span class="op" id="7236522">(</span><span class="ident" id="7236523">t</span>&nbsp;<span class="op" id="7236525">*</span><span class="ident" id="7236526">testing</span><span class="op" id="7236533">.</span><span class="ident" id="7236534">T</span><span class="op" id="7236535">)</span>&nbsp;<span class="op" id="7236537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7236540">expectedKey</span>&nbsp;<span class="op" id="7236552">:=</span>&nbsp;<span class="op" id="7236555">&amp;</span><span class="ident" id="7236556">dsa</span><span class="op" id="7236559">.</span><span class="ident" id="7236560">PublicKey</span><span class="op" id="7236569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7236573">Parameters</span><span class="op" id="7236583">:</span>&nbsp;<span class="ident" id="7236585">dsa</span><span class="op" id="7236588">.</span><span class="ident" id="7236589">Parameters</span><span class="op" id="7236599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7236604">P</span><span class="op" id="7236605">:</span>&nbsp;<span class="ident" id="7236607">bigFromHexString</span><span class="op" id="7236623">(</span><span class="string" id="7236624">&#34;00BC84B52743B169158BB85974E3E832AF5EFCFC42B264349095313A4A013EEE069A1B937D92E51ACF297A1C77880DF25C8607D8204B4DC45651305EF4A63B40C7D8C42D91EDA397D8F51CBC9D0A531FE2C6F1E55E9357D205C39D395358968CBEDAC11320C607BE16CB9DB492B6E78163305A34DD99CE43C64927D13A0040EB97&#34;</span><span class="op" id="7236884">)</span><span class="op" id="7236885">,</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7236890">Q</span><span class="op" id="7236891">:</span>&nbsp;<span class="ident" id="7236893">bigFromHexString</span><span class="op" id="7236909">(</span><span class="string" id="7236910">&#34;009A67067F66A323F5D4EC7902C73FE5D9E36FA74F&#34;</span><span class="op" id="7236954">)</span><span class="op" id="7236955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7236960">G</span><span class="op" id="7236961">:</span>&nbsp;<span class="ident" id="7236963">bigFromHexString</span><span class="op" id="7236979">(</span><span class="string" id="7236980">&#34;009147778295BF5893542BC41BA806898A29E43261DBC85441C37D92E97ED80D323D44825FDDE8374D0FF15877798812682599B216BBCC31B9DCCAD527465FEAFFD7FC2A193612E575E34E7A98AF4D10339FE47390A518CB9975B3160B1D0285D1418D0977C52994F43C29A053E3D685834104C9FAFDC221E38BE9F3989D7A8E42&#34;</span><span class="op" id="7237240">)</span><span class="op" id="7237241">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7237245">}</span><span class="op" id="7237246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7237250">Y</span><span class="op" id="7237251">:</span>&nbsp;<span class="ident" id="7237253">bigFromHexString</span><span class="op" id="7237269">(</span><span class="string" id="7237270">&#34;59A27C269FCDE45AA2160A5C980C19211A820095091AB9C5DC8309AB7EC1B3A48C2E267C6D35FEE9B71BCBB92F16AC8E559129347FB5C00BEEDD10BA8915C90698755CA965735A32DC7575BED806E1E38F768FFBC24E41123DC73F1C6E9E4D0C9E692128853AFE29DC665FA993DCA9C903B7BF00B6442B9A76A5DADC6186317A&#34;</span><span class="op" id="7237528">)</span><span class="op" id="7237529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7237532">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7237535">pemBlock</span><span class="op" id="7237543">,</span>&nbsp;<span class="ident" id="7237545">_</span>&nbsp;<span class="op" id="7237547">:=</span>&nbsp;<span class="ident" id="7237550">pem</span><span class="op" id="7237553">.</span><span class="ident" id="7237554">Decode</span><span class="op" id="7237560">(</span><span class="op" id="7237561">[</span><span class="op" id="7237562">]</span><span class="builtintype" id="7237563">byte</span><span class="op" id="7237567">(</span><span class="ident" id="7237568">dsaCertPem</span><span class="op" id="7237578">)</span><span class="op" id="7237579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7237582">cert</span><span class="op" id="7237586">,</span>&nbsp;<span class="ident" id="7237588">err</span>&nbsp;<span class="op" id="7237592">:=</span>&nbsp;<span class="ident" id="7237595">ParseCertificate</span><span class="op" id="7237611">(</span><span class="ident" id="7237612">pemBlock</span><span class="op" id="7237620">.</span><span class="ident" id="7237621">Bytes</span><span class="op" id="7237626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7237629">if</span>&nbsp;<span class="ident" id="7237632">err</span>&nbsp;<span class="op" id="7237636">!=</span>&nbsp;<span class="ident" id="7237639">nil</span>&nbsp;<span class="op" id="7237643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7237647">t</span><span class="op" id="7237648">.</span><span class="ident" id="7237649">Fatalf</span><span class="op" id="7237655">(</span><span class="string" id="7237656">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7237689">,</span>&nbsp;<span class="ident" id="7237691">err</span><span class="op" id="7237694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7237697">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7237700">if</span>&nbsp;<span class="ident" id="7237703">cert</span><span class="op" id="7237707">.</span><span class="ident" id="7237708">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="7237727">!=</span>&nbsp;<span class="ident" id="7237730">DSA</span>&nbsp;<span class="op" id="7237734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7237738">t</span><span class="op" id="7237739">.</span><span class="ident" id="7237740">Errorf</span><span class="op" id="7237746">(</span><span class="string" id="7237747">&#34;Parsed&nbsp;key&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSA&#34;</span><span class="op" id="7237781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7237784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7237787">parsedKey</span><span class="op" id="7237796">,</span>&nbsp;<span class="ident" id="7237798">ok</span>&nbsp;<span class="op" id="7237801">:=</span>&nbsp;<span class="ident" id="7237804">cert</span><span class="op" id="7237808">.</span><span class="ident" id="7237809">PublicKey</span><span class="op" id="7237818">.</span><span class="op" id="7237819">(</span><span class="op" id="7237820">*</span><span class="ident" id="7237821">dsa</span><span class="op" id="7237824">.</span><span class="ident" id="7237825">PublicKey</span><span class="op" id="7237834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7237837">if</span>&nbsp;<span class="op" id="7237840">!</span><span class="ident" id="7237841">ok</span>&nbsp;<span class="op" id="7237844">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7237848">t</span><span class="op" id="7237849">.</span><span class="ident" id="7237850">Fatalf</span><span class="op" id="7237856">(</span><span class="string" id="7237857">&#34;Parsed&nbsp;key&nbsp;was&nbsp;not&nbsp;a&nbsp;DSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7237891">,</span>&nbsp;<span class="ident" id="7237893">err</span><span class="op" id="7237896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7237899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7237902">if</span>&nbsp;<span class="ident" id="7237905">expectedKey</span><span class="op" id="7237916">.</span><span class="ident" id="7237917">Y</span><span class="op" id="7237918">.</span><span class="ident" id="7237919">Cmp</span><span class="op" id="7237922">(</span><span class="ident" id="7237923">parsedKey</span><span class="op" id="7237932">.</span><span class="ident" id="7237933">Y</span><span class="op" id="7237934">)</span>&nbsp;<span class="op" id="7237936">!=</span>&nbsp;<span class="num" id="7237939">0</span>&nbsp;<span class="op" id="7237941">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7237946">expectedKey</span><span class="op" id="7237957">.</span><span class="ident" id="7237958">P</span><span class="op" id="7237959">.</span><span class="ident" id="7237960">Cmp</span><span class="op" id="7237963">(</span><span class="ident" id="7237964">parsedKey</span><span class="op" id="7237973">.</span><span class="ident" id="7237974">P</span><span class="op" id="7237975">)</span>&nbsp;<span class="op" id="7237977">!=</span>&nbsp;<span class="num" id="7237980">0</span>&nbsp;<span class="op" id="7237982">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7237987">expectedKey</span><span class="op" id="7237998">.</span><span class="ident" id="7237999">Q</span><span class="op" id="7238000">.</span><span class="ident" id="7238001">Cmp</span><span class="op" id="7238004">(</span><span class="ident" id="7238005">parsedKey</span><span class="op" id="7238014">.</span><span class="ident" id="7238015">Q</span><span class="op" id="7238016">)</span>&nbsp;<span class="op" id="7238018">!=</span>&nbsp;<span class="num" id="7238021">0</span>&nbsp;<span class="op" id="7238023">||</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7238028">expectedKey</span><span class="op" id="7238039">.</span><span class="ident" id="7238040">G</span><span class="op" id="7238041">.</span><span class="ident" id="7238042">Cmp</span><span class="op" id="7238045">(</span><span class="ident" id="7238046">parsedKey</span><span class="op" id="7238055">.</span><span class="ident" id="7238056">G</span><span class="op" id="7238057">)</span>&nbsp;<span class="op" id="7238059">!=</span>&nbsp;<span class="num" id="7238062">0</span>&nbsp;<span class="op" id="7238064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7238068">t</span><span class="op" id="7238069">.</span><span class="ident" id="7238070">Fatal</span><span class="op" id="7238075">(</span><span class="string" id="7238076">&#34;Parsed&nbsp;key&nbsp;differs&nbsp;from&nbsp;expected&nbsp;key&#34;</span><span class="op" id="7238114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7238117">}</span><br>
<span class="lineno"></span><span class="op" id="7238119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="7238122">func</span>&nbsp;<span class="ident" id="7238127">TestParseCertificateWithDSASignatureAlgorithm</span><span class="op" id="7238172">(</span><span class="ident" id="7238173">t</span>&nbsp;<span class="op" id="7238175">*</span><span class="ident" id="7238176">testing</span><span class="op" id="7238183">.</span><span class="ident" id="7238184">T</span><span class="op" id="7238185">)</span>&nbsp;<span class="op" id="7238187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7238190">pemBlock</span><span class="op" id="7238198">,</span>&nbsp;<span class="ident" id="7238200">_</span>&nbsp;<span class="op" id="7238202">:=</span>&nbsp;<span class="ident" id="7238205">pem</span><span class="op" id="7238208">.</span><span class="ident" id="7238209">Decode</span><span class="op" id="7238215">(</span><span class="op" id="7238216">[</span><span class="op" id="7238217">]</span><span class="builtintype" id="7238218">byte</span><span class="op" id="7238222">(</span><span class="ident" id="7238223">dsaCertPem</span><span class="op" id="7238233">)</span><span class="op" id="7238234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7238237">cert</span><span class="op" id="7238241">,</span>&nbsp;<span class="ident" id="7238243">err</span>&nbsp;<span class="op" id="7238247">:=</span>&nbsp;<span class="ident" id="7238250">ParseCertificate</span><span class="op" id="7238266">(</span><span class="ident" id="7238267">pemBlock</span><span class="op" id="7238275">.</span><span class="ident" id="7238276">Bytes</span><span class="op" id="7238281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7238284">if</span>&nbsp;<span class="ident" id="7238287">err</span>&nbsp;<span class="op" id="7238291">!=</span>&nbsp;<span class="ident" id="7238294">nil</span>&nbsp;<span class="op" id="7238298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7238302">t</span><span class="op" id="7238303">.</span><span class="ident" id="7238304">Fatalf</span><span class="op" id="7238310">(</span><span class="string" id="7238311">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7238344">,</span>&nbsp;<span class="ident" id="7238346">err</span><span class="op" id="7238349">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7238352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7238355">if</span>&nbsp;<span class="ident" id="7238358">cert</span><span class="op" id="7238362">.</span><span class="ident" id="7238363">SignatureAlgorithm</span>&nbsp;<span class="op" id="7238382">!=</span>&nbsp;<span class="ident" id="7238385">DSAWithSHA1</span>&nbsp;<span class="op" id="7238397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7238401">t</span><span class="op" id="7238402">.</span><span class="ident" id="7238403">Errorf</span><span class="op" id="7238409">(</span><span class="string" id="7238410">&#34;Parsed&nbsp;signature&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSAWithSHA1&#34;</span><span class="op" id="7238458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7238461">}</span><br>
<span class="lineno"></span><span class="op" id="7238463">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="7238466">func</span>&nbsp;<span class="ident" id="7238471">TestVerifyCertificateWithDSASignature</span><span class="op" id="7238508">(</span><span class="ident" id="7238509">t</span>&nbsp;<span class="op" id="7238511">*</span><span class="ident" id="7238512">testing</span><span class="op" id="7238519">.</span><span class="ident" id="7238520">T</span><span class="op" id="7238521">)</span>&nbsp;<span class="op" id="7238523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7238526">pemBlock</span><span class="op" id="7238534">,</span>&nbsp;<span class="ident" id="7238536">_</span>&nbsp;<span class="op" id="7238538">:=</span>&nbsp;<span class="ident" id="7238541">pem</span><span class="op" id="7238544">.</span><span class="ident" id="7238545">Decode</span><span class="op" id="7238551">(</span><span class="op" id="7238552">[</span><span class="op" id="7238553">]</span><span class="builtintype" id="7238554">byte</span><span class="op" id="7238558">(</span><span class="ident" id="7238559">dsaCertPem</span><span class="op" id="7238569">)</span><span class="op" id="7238570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7238573">cert</span><span class="op" id="7238577">,</span>&nbsp;<span class="ident" id="7238579">err</span>&nbsp;<span class="op" id="7238583">:=</span>&nbsp;<span class="ident" id="7238586">ParseCertificate</span><span class="op" id="7238602">(</span><span class="ident" id="7238603">pemBlock</span><span class="op" id="7238611">.</span><span class="ident" id="7238612">Bytes</span><span class="op" id="7238617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7238620">if</span>&nbsp;<span class="ident" id="7238623">err</span>&nbsp;<span class="op" id="7238627">!=</span>&nbsp;<span class="ident" id="7238630">nil</span>&nbsp;<span class="op" id="7238634">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7238638">t</span><span class="op" id="7238639">.</span><span class="ident" id="7238640">Fatalf</span><span class="op" id="7238646">(</span><span class="string" id="7238647">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7238680">,</span>&nbsp;<span class="ident" id="7238682">err</span><span class="op" id="7238685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7238688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7238691">//&nbsp;test&nbsp;cert&nbsp;is&nbsp;self-signed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7238720">if</span>&nbsp;<span class="ident" id="7238723">err</span>&nbsp;<span class="op" id="7238727">=</span>&nbsp;<span class="ident" id="7238729">cert</span><span class="op" id="7238733">.</span><span class="ident" id="7238734">CheckSignatureFrom</span><span class="op" id="7238752">(</span><span class="ident" id="7238753">cert</span><span class="op" id="7238757">)</span><span class="op" id="7238758">;</span>&nbsp;<span class="ident" id="7238760">err</span>&nbsp;<span class="op" id="7238764">!=</span>&nbsp;<span class="ident" id="7238767">nil</span>&nbsp;<span class="op" id="7238771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7238775">t</span><span class="op" id="7238776">.</span><span class="ident" id="7238777">Fatalf</span><span class="op" id="7238783">(</span><span class="string" id="7238784">&#34;DSA&nbsp;Certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7238825">,</span>&nbsp;<span class="ident" id="7238827">err</span><span class="op" id="7238830">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7238833">}</span><br>
<span class="lineno"></span><span class="op" id="7238835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7238838">const</span>&nbsp;<span class="ident" id="7238844">pemCertificate</span>&nbsp;<span class="op" id="7238859">=</span>&nbsp;<span class="string" id="7238861">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIB5DCCAZCgAwIBAgIBATALBgkqhkiG9w0BAQUwLTEQMA4GA1UEChMHQWNtZSBDbzEZMBcGA1UE<br>
<span class="lineno">640</span>AxMQdGVzdC5leGFtcGxlLmNvbTAeFw03MDAxMDEwMDE2NDBaFw03MDAxMDIwMzQ2NDBaMC0xEDAO<br>
<span class="lineno"></span>BgNVBAoTB0FjbWUgQ28xGTAXBgNVBAMTEHRlc3QuZXhhbXBsZS5jb20wWjALBgkqhkiG9w0BAQED<br>
<span class="lineno"></span>SwAwSAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0fd7Ai2KW5ToIwzFo<br>
<span class="lineno"></span>fvJcS/STa6HA5gQenRUCAwEAAaOBnjCBmzAOBgNVHQ8BAf8EBAMCAAQwDwYDVR0TAQH/BAUwAwEB<br>
<span class="lineno"></span>/zANBgNVHQ4EBgQEAQIDBDAPBgNVHSMECDAGgAQBAgMEMBsGA1UdEQQUMBKCEHRlc3QuZXhhbXBs<br>
<span class="lineno">645</span>ZS5jb20wDwYDVR0gBAgwBjAEBgIqAzAqBgNVHR4EIzAhoB8wDoIMLmV4YW1wbGUuY29tMA2CC2V4<br>
<span class="lineno"></span>YW1wbGUuY29tMAsGCSqGSIb3DQEBBQNBAHKZKoS1wEQOGhgklx4+/yFYQlnqwKXvar/ZecQvJwui<br>
<span class="lineno"></span>0seMQnwBhwdBkHfVIU2Fu5VUMRyxlf0ZNaDXcpU581k=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----`</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="keyword" id="7239579">func</span>&nbsp;<span class="ident" id="7239584">TestCRLCreation</span><span class="op" id="7239599">(</span><span class="ident" id="7239600">t</span>&nbsp;<span class="op" id="7239602">*</span><span class="ident" id="7239603">testing</span><span class="op" id="7239610">.</span><span class="ident" id="7239611">T</span><span class="op" id="7239612">)</span>&nbsp;<span class="op" id="7239614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7239617">block</span><span class="op" id="7239622">,</span>&nbsp;<span class="ident" id="7239624">_</span>&nbsp;<span class="op" id="7239626">:=</span>&nbsp;<span class="ident" id="7239629">pem</span><span class="op" id="7239632">.</span><span class="ident" id="7239633">Decode</span><span class="op" id="7239639">(</span><span class="op" id="7239640">[</span><span class="op" id="7239641">]</span><span class="builtintype" id="7239642">byte</span><span class="op" id="7239646">(</span><span class="ident" id="7239647">pemPrivateKey</span><span class="op" id="7239660">)</span><span class="op" id="7239661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7239664">priv</span><span class="op" id="7239668">,</span>&nbsp;<span class="ident" id="7239670">_</span>&nbsp;<span class="op" id="7239672">:=</span>&nbsp;<span class="ident" id="7239675">ParsePKCS1PrivateKey</span><span class="op" id="7239695">(</span><span class="ident" id="7239696">block</span><span class="op" id="7239701">.</span><span class="ident" id="7239702">Bytes</span><span class="op" id="7239707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7239710">block</span><span class="op" id="7239715">,</span>&nbsp;<span class="ident" id="7239717">_</span>&nbsp;<span class="op" id="7239719">=</span>&nbsp;<span class="ident" id="7239721">pem</span><span class="op" id="7239724">.</span><span class="ident" id="7239725">Decode</span><span class="op" id="7239731">(</span><span class="op" id="7239732">[</span><span class="op" id="7239733">]</span><span class="builtintype" id="7239734">byte</span><span class="op" id="7239738">(</span><span class="ident" id="7239739">pemCertificate</span><span class="op" id="7239753">)</span><span class="op" id="7239754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7239757">cert</span><span class="op" id="7239761">,</span>&nbsp;<span class="ident" id="7239763">_</span>&nbsp;<span class="op" id="7239765">:=</span>&nbsp;<span class="ident" id="7239768">ParseCertificate</span><span class="op" id="7239784">(</span><span class="ident" id="7239785">block</span><span class="op" id="7239790">.</span><span class="ident" id="7239791">Bytes</span><span class="op" id="7239796">)</span><br>
<span class="lineno">655</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7239800">now</span>&nbsp;<span class="op" id="7239804">:=</span>&nbsp;<span class="ident" id="7239807">time</span><span class="op" id="7239811">.</span><span class="ident" id="7239812">Unix</span><span class="op" id="7239816">(</span><span class="num" id="7239817">1000</span><span class="op" id="7239821">,</span>&nbsp;<span class="num" id="7239823">0</span><span class="op" id="7239824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7239827">expiry</span>&nbsp;<span class="op" id="7239834">:=</span>&nbsp;<span class="ident" id="7239837">time</span><span class="op" id="7239841">.</span><span class="ident" id="7239842">Unix</span><span class="op" id="7239846">(</span><span class="num" id="7239847">10000</span><span class="op" id="7239852">,</span>&nbsp;<span class="num" id="7239854">0</span><span class="op" id="7239855">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7239859">revokedCerts</span>&nbsp;<span class="op" id="7239872">:=</span>&nbsp;<span class="op" id="7239875">[</span><span class="op" id="7239876">]</span><span class="ident" id="7239877">pkix</span><span class="op" id="7239881">.</span><span class="ident" id="7239882">RevokedCertificate</span><span class="op" id="7239900">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7239904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7239909">SerialNumber</span><span class="op" id="7239921">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7239925">big</span><span class="op" id="7239928">.</span><span class="ident" id="7239929">NewInt</span><span class="op" id="7239935">(</span><span class="num" id="7239936">1</span><span class="op" id="7239937">)</span><span class="op" id="7239938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7239943">RevocationTime</span><span class="op" id="7239957">:</span>&nbsp;<span class="ident" id="7239959">now</span><span class="op" id="7239962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7239966">}</span><span class="op" id="7239967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7239971">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7239976">SerialNumber</span><span class="op" id="7239988">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7239992">big</span><span class="op" id="7239995">.</span><span class="ident" id="7239996">NewInt</span><span class="op" id="7240002">(</span><span class="num" id="7240003">42</span><span class="op" id="7240005">)</span><span class="op" id="7240006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7240011">RevocationTime</span><span class="op" id="7240025">:</span>&nbsp;<span class="ident" id="7240027">now</span><span class="op" id="7240030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7240034">}</span><span class="op" id="7240035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7240038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7240042">crlBytes</span><span class="op" id="7240050">,</span>&nbsp;<span class="ident" id="7240052">err</span>&nbsp;<span class="op" id="7240056">:=</span>&nbsp;<span class="ident" id="7240059">cert</span><span class="op" id="7240063">.</span><span class="ident" id="7240064">CreateCRL</span><span class="op" id="7240073">(</span><span class="ident" id="7240074">rand</span><span class="op" id="7240078">.</span><span class="ident" id="7240079">Reader</span><span class="op" id="7240085">,</span>&nbsp;<span class="ident" id="7240087">priv</span><span class="op" id="7240091">,</span>&nbsp;<span class="ident" id="7240093">revokedCerts</span><span class="op" id="7240105">,</span>&nbsp;<span class="ident" id="7240107">now</span><span class="op" id="7240110">,</span>&nbsp;<span class="ident" id="7240112">expiry</span><span class="op" id="7240118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7240121">if</span>&nbsp;<span class="ident" id="7240124">err</span>&nbsp;<span class="op" id="7240128">!=</span>&nbsp;<span class="ident" id="7240131">nil</span>&nbsp;<span class="op" id="7240135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7240139">t</span><span class="op" id="7240140">.</span><span class="ident" id="7240141">Errorf</span><span class="op" id="7240147">(</span><span class="string" id="7240148">&#34;error&nbsp;creating&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="7240172">,</span>&nbsp;<span class="ident" id="7240174">err</span><span class="op" id="7240177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7240180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7240184">_</span><span class="op" id="7240185">,</span>&nbsp;<span class="ident" id="7240187">err</span>&nbsp;<span class="op" id="7240191">=</span>&nbsp;<span class="ident" id="7240193">ParseDERCRL</span><span class="op" id="7240204">(</span><span class="ident" id="7240205">crlBytes</span><span class="op" id="7240213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7240216">if</span>&nbsp;<span class="ident" id="7240219">err</span>&nbsp;<span class="op" id="7240223">!=</span>&nbsp;<span class="ident" id="7240226">nil</span>&nbsp;<span class="op" id="7240230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7240234">t</span><span class="op" id="7240235">.</span><span class="ident" id="7240236">Errorf</span><span class="op" id="7240242">(</span><span class="string" id="7240243">&#34;error&nbsp;reparsing&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="7240268">,</span>&nbsp;<span class="ident" id="7240270">err</span><span class="op" id="7240273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7240276">}</span><br>
<span class="lineno"></span><span class="op" id="7240278">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="7240281">func</span>&nbsp;<span class="ident" id="7240286">fromBase64</span><span class="op" id="7240296">(</span><span class="ident" id="7240297">in</span>&nbsp;<span class="builtintype" id="7240300">string</span><span class="op" id="7240306">)</span>&nbsp;<span class="op" id="7240308">[</span><span class="op" id="7240309">]</span><span class="builtintype" id="7240310">byte</span>&nbsp;<span class="op" id="7240315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7240318">out</span>&nbsp;<span class="op" id="7240322">:=</span>&nbsp;<span class="builtinfunc" id="7240325">make</span><span class="op" id="7240329">(</span><span class="op" id="7240330">[</span><span class="op" id="7240331">]</span><span class="builtintype" id="7240332">byte</span><span class="op" id="7240336">,</span>&nbsp;<span class="ident" id="7240338">base64</span><span class="op" id="7240344">.</span><span class="ident" id="7240345">StdEncoding</span><span class="op" id="7240356">.</span><span class="ident" id="7240357">DecodedLen</span><span class="op" id="7240367">(</span><span class="builtinfunc" id="7240368">len</span><span class="op" id="7240371">(</span><span class="ident" id="7240372">in</span><span class="op" id="7240374">)</span><span class="op" id="7240375">)</span><span class="op" id="7240376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7240379">n</span><span class="op" id="7240380">,</span>&nbsp;<span class="ident" id="7240382">err</span>&nbsp;<span class="op" id="7240386">:=</span>&nbsp;<span class="ident" id="7240389">base64</span><span class="op" id="7240395">.</span><span class="ident" id="7240396">StdEncoding</span><span class="op" id="7240407">.</span><span class="ident" id="7240408">Decode</span><span class="op" id="7240414">(</span><span class="ident" id="7240415">out</span><span class="op" id="7240418">,</span>&nbsp;<span class="op" id="7240420">[</span><span class="op" id="7240421">]</span><span class="builtintype" id="7240422">byte</span><span class="op" id="7240426">(</span><span class="ident" id="7240427">in</span><span class="op" id="7240429">)</span><span class="op" id="7240430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7240433">if</span>&nbsp;<span class="ident" id="7240436">err</span>&nbsp;<span class="op" id="7240440">!=</span>&nbsp;<span class="ident" id="7240443">nil</span>&nbsp;<span class="op" id="7240447">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7240451">panic</span><span class="op" id="7240456">(</span><span class="string" id="7240457">&#34;failed&nbsp;to&nbsp;base64&nbsp;decode&#34;</span><span class="op" id="7240482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7240485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7240488">return</span>&nbsp;<span class="ident" id="7240495">out</span><span class="op" id="7240498">[</span><span class="op" id="7240499">:</span><span class="ident" id="7240500">n</span><span class="op" id="7240501">]</span><br>
<span class="lineno"></span><span class="op" id="7240503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="7240506">func</span>&nbsp;<span class="ident" id="7240511">TestParseDERCRL</span><span class="op" id="7240526">(</span><span class="ident" id="7240527">t</span>&nbsp;<span class="op" id="7240529">*</span><span class="ident" id="7240530">testing</span><span class="op" id="7240537">.</span><span class="ident" id="7240538">T</span><span class="op" id="7240539">)</span>&nbsp;<span class="op" id="7240541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7240544">derBytes</span>&nbsp;<span class="op" id="7240553">:=</span>&nbsp;<span class="ident" id="7240556">fromBase64</span><span class="op" id="7240566">(</span><span class="ident" id="7240567">derCRLBase64</span><span class="op" id="7240579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7240582">certList</span><span class="op" id="7240590">,</span>&nbsp;<span class="ident" id="7240592">err</span>&nbsp;<span class="op" id="7240596">:=</span>&nbsp;<span class="ident" id="7240599">ParseDERCRL</span><span class="op" id="7240610">(</span><span class="ident" id="7240611">derBytes</span><span class="op" id="7240619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7240622">if</span>&nbsp;<span class="ident" id="7240625">err</span>&nbsp;<span class="op" id="7240629">!=</span>&nbsp;<span class="ident" id="7240632">nil</span>&nbsp;<span class="op" id="7240636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7240640">t</span><span class="op" id="7240641">.</span><span class="ident" id="7240642">Errorf</span><span class="op" id="7240648">(</span><span class="string" id="7240649">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="7240668">,</span>&nbsp;<span class="ident" id="7240670">err</span><span class="op" id="7240673">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7240677">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7240685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7240688">numCerts</span>&nbsp;<span class="op" id="7240697">:=</span>&nbsp;<span class="builtinfunc" id="7240700">len</span><span class="op" id="7240703">(</span><span class="ident" id="7240704">certList</span><span class="op" id="7240712">.</span><span class="ident" id="7240713">TBSCertList</span><span class="op" id="7240724">.</span><span class="ident" id="7240725">RevokedCertificates</span><span class="op" id="7240744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7240747">expected</span>&nbsp;<span class="op" id="7240756">:=</span>&nbsp;<span class="num" id="7240759">88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7240763">if</span>&nbsp;<span class="ident" id="7240766">numCerts</span>&nbsp;<span class="op" id="7240775">!=</span>&nbsp;<span class="ident" id="7240778">expected</span>&nbsp;<span class="op" id="7240787">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7240791">t</span><span class="op" id="7240792">.</span><span class="ident" id="7240793">Errorf</span><span class="op" id="7240799">(</span><span class="string" id="7240800">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="7240854">,</span>&nbsp;<span class="ident" id="7240856">numCerts</span><span class="op" id="7240864">,</span>&nbsp;<span class="ident" id="7240866">expected</span><span class="op" id="7240874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7240877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7240881">if</span>&nbsp;<span class="ident" id="7240884">certList</span><span class="op" id="7240892">.</span><span class="ident" id="7240893">HasExpired</span><span class="op" id="7240903">(</span><span class="ident" id="7240904">time</span><span class="op" id="7240908">.</span><span class="ident" id="7240909">Unix</span><span class="op" id="7240913">(</span><span class="num" id="7240914">1302517272</span><span class="op" id="7240924">,</span>&nbsp;<span class="num" id="7240926">0</span><span class="op" id="7240927">)</span><span class="op" id="7240928">)</span>&nbsp;<span class="op" id="7240930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7240934">t</span><span class="op" id="7240935">.</span><span class="ident" id="7240936">Errorf</span><span class="op" id="7240942">(</span><span class="string" id="7240943">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="7240981">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7240984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7240988">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="7241047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="7241050">func</span>&nbsp;<span class="ident" id="7241055">TestCRLWithoutExpiry</span><span class="op" id="7241075">(</span><span class="ident" id="7241076">t</span>&nbsp;<span class="op" id="7241078">*</span><span class="ident" id="7241079">testing</span><span class="op" id="7241086">.</span><span class="ident" id="7241087">T</span><span class="op" id="7241088">)</span>&nbsp;<span class="op" id="7241090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7241093">derBytes</span>&nbsp;<span class="op" id="7241102">:=</span>&nbsp;<span class="ident" id="7241105">fromBase64</span><span class="op" id="7241115">(</span><span class="string" id="7241116">&#34;MIHYMIGZMAkGByqGSM44BAMwEjEQMA4GA1UEAxMHQ2FybERTUxcNOTkwODI3MDcwMDAwWjBpMBMCAgDIFw05OTA4MjIwNzAwMDBaMBMCAgDJFw05OTA4MjIwNzAwMDBaMBMCAgDTFw05OTA4MjIwNzAwMDBaMBMCAgDSFw05OTA4MjIwNzAwMDBaMBMCAgDUFw05OTA4MjQwNzAwMDBaMAkGByqGSM44BAMDLwAwLAIUfmVSdjP+NHMX0feW+aDU2G1cfT0CFAJ6W7fVWxjBz4fvftok8yqDnDWh&#34;</span><span class="op" id="7241410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7241413">certList</span><span class="op" id="7241421">,</span>&nbsp;<span class="ident" id="7241423">err</span>&nbsp;<span class="op" id="7241427">:=</span>&nbsp;<span class="ident" id="7241430">ParseDERCRL</span><span class="op" id="7241441">(</span><span class="ident" id="7241442">derBytes</span><span class="op" id="7241450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7241453">if</span>&nbsp;<span class="ident" id="7241456">err</span>&nbsp;<span class="op" id="7241460">!=</span>&nbsp;<span class="ident" id="7241463">nil</span>&nbsp;<span class="op" id="7241467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7241471">t</span><span class="op" id="7241472">.</span><span class="ident" id="7241473">Fatal</span><span class="op" id="7241478">(</span><span class="ident" id="7241479">err</span><span class="op" id="7241482">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7241485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7241488">if</span>&nbsp;<span class="op" id="7241491">!</span><span class="ident" id="7241492">certList</span><span class="op" id="7241500">.</span><span class="ident" id="7241501">TBSCertList</span><span class="op" id="7241512">.</span><span class="ident" id="7241513">NextUpdate</span><span class="op" id="7241523">.</span><span class="ident" id="7241524">IsZero</span><span class="op" id="7241530">(</span><span class="op" id="7241531">)</span>&nbsp;<span class="op" id="7241533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7241537">t</span><span class="op" id="7241538">.</span><span class="ident" id="7241539">Errorf</span><span class="op" id="7241545">(</span><span class="string" id="7241546">&#34;NextUpdate&nbsp;is&nbsp;not&nbsp;the&nbsp;zero&nbsp;value&#34;</span><span class="op" id="7241580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7241583">}</span><br>
<span class="lineno"></span><span class="op" id="7241585">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="7241588">func</span>&nbsp;<span class="ident" id="7241593">TestParsePEMCRL</span><span class="op" id="7241608">(</span><span class="ident" id="7241609">t</span>&nbsp;<span class="op" id="7241611">*</span><span class="ident" id="7241612">testing</span><span class="op" id="7241619">.</span><span class="ident" id="7241620">T</span><span class="op" id="7241621">)</span>&nbsp;<span class="op" id="7241623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7241626">pemBytes</span>&nbsp;<span class="op" id="7241635">:=</span>&nbsp;<span class="ident" id="7241638">fromBase64</span><span class="op" id="7241648">(</span><span class="ident" id="7241649">pemCRLBase64</span><span class="op" id="7241661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7241664">certList</span><span class="op" id="7241672">,</span>&nbsp;<span class="ident" id="7241674">err</span>&nbsp;<span class="op" id="7241678">:=</span>&nbsp;<span class="ident" id="7241681">ParseCRL</span><span class="op" id="7241689">(</span><span class="ident" id="7241690">pemBytes</span><span class="op" id="7241698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7241701">if</span>&nbsp;<span class="ident" id="7241704">err</span>&nbsp;<span class="op" id="7241708">!=</span>&nbsp;<span class="ident" id="7241711">nil</span>&nbsp;<span class="op" id="7241715">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7241719">t</span><span class="op" id="7241720">.</span><span class="ident" id="7241721">Errorf</span><span class="op" id="7241727">(</span><span class="string" id="7241728">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="7241747">,</span>&nbsp;<span class="ident" id="7241749">err</span><span class="op" id="7241752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7241756">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7241764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7241767">numCerts</span>&nbsp;<span class="op" id="7241776">:=</span>&nbsp;<span class="builtinfunc" id="7241779">len</span><span class="op" id="7241782">(</span><span class="ident" id="7241783">certList</span><span class="op" id="7241791">.</span><span class="ident" id="7241792">TBSCertList</span><span class="op" id="7241803">.</span><span class="ident" id="7241804">RevokedCertificates</span><span class="op" id="7241823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7241826">expected</span>&nbsp;<span class="op" id="7241835">:=</span>&nbsp;<span class="num" id="7241838">2</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7241841">if</span>&nbsp;<span class="ident" id="7241844">numCerts</span>&nbsp;<span class="op" id="7241853">!=</span>&nbsp;<span class="ident" id="7241856">expected</span>&nbsp;<span class="op" id="7241865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7241869">t</span><span class="op" id="7241870">.</span><span class="ident" id="7241871">Errorf</span><span class="op" id="7241877">(</span><span class="string" id="7241878">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="7241932">,</span>&nbsp;<span class="ident" id="7241934">numCerts</span><span class="op" id="7241942">,</span>&nbsp;<span class="ident" id="7241944">expected</span><span class="op" id="7241952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7241955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7241959">if</span>&nbsp;<span class="ident" id="7241962">certList</span><span class="op" id="7241970">.</span><span class="ident" id="7241971">HasExpired</span><span class="op" id="7241981">(</span><span class="ident" id="7241982">time</span><span class="op" id="7241986">.</span><span class="ident" id="7241987">Unix</span><span class="op" id="7241991">(</span><span class="num" id="7241992">1302517272</span><span class="op" id="7242002">,</span>&nbsp;<span class="num" id="7242004">0</span><span class="op" id="7242005">)</span><span class="op" id="7242006">)</span>&nbsp;<span class="op" id="7242008">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7242012">t</span><span class="op" id="7242013">.</span><span class="ident" id="7242014">Errorf</span><span class="op" id="7242020">(</span><span class="string" id="7242021">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="7242059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7242062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7242066">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="7242125">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="7242128">func</span>&nbsp;<span class="ident" id="7242133">TestImports</span><span class="op" id="7242144">(</span><span class="ident" id="7242145">t</span>&nbsp;<span class="op" id="7242147">*</span><span class="ident" id="7242148">testing</span><span class="op" id="7242155">.</span><span class="ident" id="7242156">T</span><span class="op" id="7242157">)</span>&nbsp;<span class="op" id="7242159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7242162">switch</span>&nbsp;<span class="ident" id="7242169">runtime</span><span class="op" id="7242176">.</span><span class="ident" id="7242177">GOOS</span>&nbsp;<span class="op" id="7242182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7242185">case</span>&nbsp;<span class="string" id="7242190">&#34;android&#34;</span><span class="op" id="7242199">,</span>&nbsp;<span class="string" id="7242201">&#34;nacl&#34;</span><span class="op" id="7242207">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7242211">t</span><span class="op" id="7242212">.</span><span class="ident" id="7242213">Skipf</span><span class="op" id="7242218">(</span><span class="string" id="7242219">&#34;skipping&nbsp;on&nbsp;%s&#34;</span><span class="op" id="7242235">,</span>&nbsp;<span class="ident" id="7242237">runtime</span><span class="op" id="7242244">.</span><span class="ident" id="7242245">GOOS</span><span class="op" id="7242249">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7242252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7242256">if</span>&nbsp;<span class="ident" id="7242259">err</span>&nbsp;<span class="op" id="7242263">:=</span>&nbsp;<span class="ident" id="7242266">exec</span><span class="op" id="7242270">.</span><span class="ident" id="7242271">Command</span><span class="op" id="7242278">(</span><span class="string" id="7242279">&#34;go&#34;</span><span class="op" id="7242283">,</span>&nbsp;<span class="string" id="7242285">&#34;run&#34;</span><span class="op" id="7242290">,</span>&nbsp;<span class="string" id="7242292">&#34;x509_test_import.go&#34;</span><span class="op" id="7242313">)</span><span class="op" id="7242314">.</span><span class="ident" id="7242315">Run</span><span class="op" id="7242318">(</span><span class="op" id="7242319">)</span><span class="op" id="7242320">;</span>&nbsp;<span class="ident" id="7242322">err</span>&nbsp;<span class="op" id="7242326">!=</span>&nbsp;<span class="ident" id="7242329">nil</span>&nbsp;<span class="op" id="7242333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7242337">t</span><span class="op" id="7242338">.</span><span class="ident" id="7242339">Errorf</span><span class="op" id="7242345">(</span><span class="string" id="7242346">&#34;failed&nbsp;to&nbsp;run&nbsp;x509_test_import.go:&nbsp;%s&#34;</span><span class="op" id="7242385">,</span>&nbsp;<span class="ident" id="7242387">err</span><span class="op" id="7242390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7242393">}</span><br>
<span class="lineno">750</span><span class="op" id="7242395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7242398">const</span>&nbsp;<span class="ident" id="7242404">derCRLBase64</span>&nbsp;<span class="op" id="7242417">=</span>&nbsp;<span class="string" id="7242419">&#34;MIINqzCCDJMCAQEwDQYJKoZIhvcNAQEFBQAwVjEZMBcGA1UEAxMQUEtJIEZJTk1FQ0NBTklDQTEVMBMGA1UEChMMRklOTUVDQ0FOSUNBMRUwEwYDVQQLEwxGSU5NRUNDQU5JQ0ExCzAJBgNVBAYTAklUFw0xMTA1MDQxNjU3NDJaFw0xMTA1MDQyMDU3NDJaMIIMBzAhAg4Ze1od49Lt1qIXBydAzhcNMDkwNzE2MDg0MzIyWjAAMCECDl0HSL9bcZ1Ci/UHJ0DPFw0wOTA3MTYwODQzMTNaMAAwIQIOESB9tVAmX3cY7QcnQNAXDTA5MDcxNjA4NDUyMlowADAhAg4S1tGAQ3mHt8uVBydA1RcNMDkwODA0MTUyNTIyWjAAMCECDlQ249Y7vtC25ScHJ0DWFw0wOTA4MDQxNTI1MzdaMAAwIQIOISMop3NkA4PfYwcnQNkXDTA5MDgwNDExMDAzNFowADAhAg56/BMoS29KEShTBydA2hcNMDkwODA0MTEwMTAzWjAAMCECDnBp/22HPH5CSWoHJ0DbFw0wOTA4MDQxMDU0NDlaMAAwIQIOV9IP+8CD8bK+XAcnQNwXDTA5MDgwNDEwNTcxN1owADAhAg4v5aRz0IxWqYiXBydA3RcNMDkwODA0MTA1NzQ1WjAAMCECDlOU34VzvZAybQwHJ0DeFw0wOTA4MDQxMDU4MjFaMAAwIAINO4CD9lluIxcwBydBAxcNMDkwNzIyMTUzMTU5WjAAMCECDgOllfO8Y1QA7/wHJ0ExFw0wOTA3MjQxMTQxNDNaMAAwIQIOJBX7jbiCdRdyjgcnQUQXDTA5MDkxNjA5MzAwOFowADAhAg5iYSAgmDrlH/RZBydBRRcNMDkwOTE2MDkzMDE3WjAAMCECDmu6k6srP3jcMaQHJ0FRFw0wOTA4MDQxMDU2NDBaMAAwIQIOX8aHlO0V+WVH4QcnQVMXDTA5MDgwNDEwNTcyOVowADAhAg5flK2rg3NnsRgDBydBzhcNMTEwMjAxMTUzMzQ2WjAAMCECDg35yJDL1jOPTgoHJ0HPFw0xMTAyMDExNTM0MjZaMAAwIQIOMyFJ6+e9iiGVBQcnQdAXDTA5MDkxODEzMjAwNVowADAhAg5Emb/Oykucmn8fBydB1xcNMDkwOTIxMTAxMDQ3WjAAMCECDjQKCncV+MnUavMHJ0HaFw0wOTA5MjIwODE1MjZaMAAwIQIOaxiFUt3dpd+tPwcnQfQXDTEwMDYxODA4NDI1MVowADAhAg5G7P8nO0tkrMt7BydB9RcNMTAwNjE4MDg0MjMwWjAAMCECDmTCC3SXhmDRst4HJ0H2Fw0wOTA5MjgxMjA3MjBaMAAwIQIOHoGhUr/pRwzTKgcnQfcXDTA5MDkyODEyMDcyNFowADAhAg50wrcrCiw8mQmPBydCBBcNMTAwMjE2MTMwMTA2WjAAMCECDifWmkvwyhEqwEcHJ0IFFw0xMDAyMTYxMzAxMjBaMAAwIQIOfgPmlW9fg+osNgcnQhwXDTEwMDQxMzA5NTIwMFowADAhAg4YHAGuA6LgCk7tBydCHRcNMTAwNDEzMDk1MTM4WjAAMCECDi1zH1bxkNJhokAHJ0IsFw0xMDA0MTMwOTU5MzBaMAAwIQIOMipNccsb/wo2fwcnQi0XDTEwMDQxMzA5NTkwMFowADAhAg46lCmvPl4GpP6ABydCShcNMTAwMTE5MDk1MjE3WjAAMCECDjaTcaj+wBpcGAsHJ0JLFw0xMDAxMTkwOTUyMzRaMAAwIQIOOMC13EOrBuxIOQcnQloXDTEwMDIwMTA5NDcwNVowADAhAg5KmZl+krz4RsmrBydCWxcNMTAwMjAxMDk0NjQwWjAAMCECDmLG3zQJ/fzdSsUHJ0JiFw0xMDAzMDEwOTUxNDBaMAAwIQIOP39ksgHdojf4owcnQmMXDTEwMDMwMTA5NTExN1owADAhAg4LDQzvWNRlD6v9BydCZBcNMTAwMzAxMDk0NjIyWjAAMCECDkmNfeclaFhIaaUHJ0JlFw0xMDAzMDEwOTQ2MDVaMAAwIQIOT/qWWfpH/m8NTwcnQpQXDTEwMDUxMTA5MTgyMVowADAhAg5m/ksYxvCEgJSvBydClRcNMTAwNTExMDkxODAxWjAAMCECDgvf3Ohq6JOPU9AHJ0KWFw0xMDA1MTEwOTIxMjNaMAAwIQIOKSPas10z4jNVIQcnQpcXDTEwMDUxMTA5MjEwMlowADAhAg4mCWmhoZ3lyKCDBydCohcNMTEwNDI4MTEwMjI1WjAAMCECDkeiyRsBMK0Gvr4HJ0KjFw0xMTA0MjgxMTAyMDdaMAAwIQIOa09b/nH2+55SSwcnQq4XDTExMDQwMTA4Mjk0NlowADAhAg5O7M7iq7gGplr1BydCrxcNMTEwNDAxMDgzMDE3WjAAMCECDjlT6mJxUjTvyogHJ0K1Fw0xMTAxMjcxNTQ4NTJaMAAwIQIODS/l4UUFLe21NAcnQrYXDTExMDEyNzE1NDgyOFowADAhAg5lPRA0XdOUF6lSBydDHhcNMTEwMTI4MTQzNTA1WjAAMCECDixKX4fFGGpENwgHJ0MfFw0xMTAxMjgxNDM1MzBaMAAwIQIORNBkqsPnpKTtbAcnQ08XDTEwMDkwOTA4NDg0MlowADAhAg5QL+EMM3lohedEBydDUBcNMTAwOTA5MDg0ODE5WjAAMCECDlhDnHK+HiTRAXcHJ0NUFw0xMDEwMTkxNjIxNDBaMAAwIQIOdBFqAzq/INz53gcnQ1UXDTEwMTAxOTE2MjA0NFowADAhAg4OjR7s8MgKles1BydDWhcNMTEwMTI3MTY1MzM2WjAAMCECDmfR/elHee+d0SoHJ0NbFw0xMTAxMjcxNjUzNTZaMAAwIQIOBTKv2ui+KFMI+wcnQ5YXDTEwMDkxNTEwMjE1N1owADAhAg49F3c/GSah+oRUBydDmxcNMTEwMTI3MTczMjMzWjAAMCECDggv4I61WwpKFMMHJ0OcFw0xMTAxMjcxNzMyNTVaMAAwIQIOXx/Y8sEvwS10LAcnQ6UXDTExMDEyODExMjkzN1owADAhAg5LSLbnVrSKaw/9BydDphcNMTEwMTI4MTEyOTIwWjAAMCECDmFFoCuhKUeACQQHJ0PfFw0xMTAxMTExMDE3MzdaMAAwIQIOQTDdFh2fSPF6AAcnQ+AXDTExMDExMTEwMTcxMFowADAhAg5B8AOXX61FpvbbBydD5RcNMTAxMDA2MTAxNDM2WjAAMCECDh41P2Gmi7PkwI4HJ0PmFw0xMDEwMDYxMDE2MjVaMAAwIQIOWUHGLQCd+Ale9gcnQ/0XDTExMDUwMjA3NTYxMFowADAhAg5Z2c9AYkikmgWOBydD/hcNMTEwNTAyMDc1NjM0WjAAMCECDmf/UD+/h8nf+74HJ0QVFw0xMTA0MTUwNzI4MzNaMAAwIQIOICvj4epy3MrqfwcnRBYXDTExMDQxNTA3Mjg1NlowADAhAg4bouRMfOYqgv4xBydEHxcNMTEwMzA4MTYyNDI1WjAAMCECDhebWHGoKiTp7pEHJ0QgFw0xMTAzMDgxNjI0NDhaMAAwIQIOX+qnxxAqJ8LtawcnRDcXDTExMDEzMTE1MTIyOFowADAhAg4j0fICqZ+wkOdqBydEOBcNMTEwMTMxMTUxMTQxWjAAMCECDhmXjsV4SUpWtAMHJ0RLFw0xMTAxMjgxMTI0MTJaMAAwIQIODno/w+zG43kkTwcnREwXDTExMDEyODExMjM1MlowADAhAg4b1gc88767Fr+LBydETxcNMTEwMTI4MTEwMjA4WjAAMCECDn+M3Pa1w2nyFeUHJ0RQFw0xMTAxMjgxMDU4NDVaMAAwIQIOaduoyIH61tqybAcnRJUXDTEwMTIxNTA5NDMyMlowADAhAg4nLqQPkyi3ESAKBydElhcNMTAxMjE1MDk0MzM2WjAAMCECDi504NIMH8578gQHJ0SbFw0xMTAyMTQxNDA1NDFaMAAwIQIOGuaM8PDaC5u1egcnRJwXDTExMDIxNDE0MDYwNFowADAhAg4ehYq/BXGnB5PWBydEnxcNMTEwMjA0MDgwOTUxWjAAMCECDkSD4eS4FxW5H20HJ0SgFw0xMTAyMDQwODA5MjVaMAAwIQIOOCcb6ilYObt1egcnRKEXDTExMDEyNjEwNDEyOVowADAhAg58tISWCCwFnKGnBydEohcNMTEwMjA0MDgxMzQyWjAAMCECDn5rjtabY/L/WL0HJ0TJFw0xMTAyMDQxMTAzNDFaMAAwDQYJKoZIhvcNAQEFBQADggEBAGnF2Gs0+LNiYCW1Ipm83OXQYP/bd5tFFRzyz3iepFqNfYs4D68/QihjFoRHQoXEB0OEe1tvaVnnPGnEOpi6krwekquMxo4H88B5SlyiFIqemCOIss0SxlCFs69LmfRYvPPvPEhoXtQ3ZThe0UvKG83GOklhvGl6OaiRf4Mt+m8zOT4Wox/j6aOBK6cw6qKCdmD+Yj1rrNqFGg1CnSWMoD6S6mwNgkzwdBUJZ22BwrzAAo4RHa2Uy3ef1FjwD0XtU5N3uDSxGGBEDvOe5z82rps3E22FpAA8eYl8kaXtmWqyvYU0epp4brGuTxCuBMCAsxt/OjIjeNNQbBGkwxgfYA0=&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7247095">const</span>&nbsp;<span class="ident" id="7247101">pemCRLBase64</span>&nbsp;<span class="op" id="7247114">=</span>&nbsp;<span class="string" id="7247116">&#34;LS0tLS1CRUdJTiBYNTA5IENSTC0tLS0tDQpNSUlCOWpDQ0FWOENBUUV3RFFZSktvWklodmNOQVFFRkJRQXdiREVhTUJnR0ExVUVDaE1SVWxOQklGTmxZM1Z5DQphWFI1SUVsdVl5NHhIakFjQmdOVkJBTVRGVkpUUVNCUWRXSnNhV01nVW05dmRDQkRRU0IyTVRFdU1Dd0dDU3FHDQpTSWIzRFFFSkFSWWZjbk5oYTJWdmJuSnZiM1J6YVdkdVFISnpZWE5sWTNWeWFYUjVMbU52YlJjTk1URXdNakl6DQpNVGt5T0RNd1doY05NVEV3T0RJeU1Ua3lPRE13V2pDQmpEQktBaEVBckRxb2g5RkhKSFhUN09QZ3V1bjQrQmNODQpNRGt4TVRBeU1UUXlOekE1V2pBbU1Bb0dBMVVkRlFRRENnRUpNQmdHQTFVZEdBUVJHQTh5TURBNU1URXdNakUwDQpNalExTlZvd1BnSVJBTEd6blowOTVQQjVhQU9MUGc1N2ZNTVhEVEF5TVRBeU16RTBOVEF4TkZvd0dqQVlCZ05WDQpIUmdFRVJnUE1qQXdNakV3TWpNeE5EVXdNVFJhb0RBd0xqQWZCZ05WSFNNRUdEQVdnQlQxVERGNlVRTS9MTmVMDQpsNWx2cUhHUXEzZzltekFMQmdOVkhSUUVCQUlDQUlRd0RRWUpLb1pJaHZjTkFRRUZCUUFEZ1lFQUZVNUFzNk16DQpxNVBSc2lmYW9iUVBHaDFhSkx5QytNczVBZ2MwYld5QTNHQWR4dXI1U3BQWmVSV0NCamlQL01FSEJXSkNsQkhQDQpHUmNxNXlJZDNFakRrYUV5eFJhK2k2N0x6dmhJNmMyOUVlNks5cFNZd2ppLzdSVWhtbW5Qclh0VHhsTDBsckxyDQptUVFKNnhoRFJhNUczUUE0Q21VZHNITnZicnpnbUNZcHZWRT0NCi0tLS0tRU5EIFg1MDkgQ1JMLS0tLS0NCg0K&#34;</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="keyword" id="7248120">func</span>&nbsp;<span class="ident" id="7248125">TestCreateCertificateRequest</span><span class="op" id="7248153">(</span><span class="ident" id="7248154">t</span>&nbsp;<span class="op" id="7248156">*</span><span class="ident" id="7248157">testing</span><span class="op" id="7248164">.</span><span class="ident" id="7248165">T</span><span class="op" id="7248166">)</span>&nbsp;<span class="op" id="7248168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7248171">random</span>&nbsp;<span class="op" id="7248178">:=</span>&nbsp;<span class="ident" id="7248181">rand</span><span class="op" id="7248185">.</span><span class="ident" id="7248186">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7248195">block</span><span class="op" id="7248200">,</span>&nbsp;<span class="ident" id="7248202">_</span>&nbsp;<span class="op" id="7248204">:=</span>&nbsp;<span class="ident" id="7248207">pem</span><span class="op" id="7248210">.</span><span class="ident" id="7248211">Decode</span><span class="op" id="7248217">(</span><span class="op" id="7248218">[</span><span class="op" id="7248219">]</span><span class="builtintype" id="7248220">byte</span><span class="op" id="7248224">(</span><span class="ident" id="7248225">pemPrivateKey</span><span class="op" id="7248238">)</span><span class="op" id="7248239">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7248242">rsaPriv</span><span class="op" id="7248249">,</span>&nbsp;<span class="ident" id="7248251">err</span>&nbsp;<span class="op" id="7248255">:=</span>&nbsp;<span class="ident" id="7248258">ParsePKCS1PrivateKey</span><span class="op" id="7248278">(</span><span class="ident" id="7248279">block</span><span class="op" id="7248284">.</span><span class="ident" id="7248285">Bytes</span><span class="op" id="7248290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7248293">if</span>&nbsp;<span class="ident" id="7248296">err</span>&nbsp;<span class="op" id="7248300">!=</span>&nbsp;<span class="ident" id="7248303">nil</span>&nbsp;<span class="op" id="7248307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7248311">t</span><span class="op" id="7248312">.</span><span class="ident" id="7248313">Fatalf</span><span class="op" id="7248319">(</span><span class="string" id="7248320">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7248353">,</span>&nbsp;<span class="ident" id="7248355">err</span><span class="op" id="7248358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7248361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7248365">ecdsa256Priv</span><span class="op" id="7248377">,</span>&nbsp;<span class="ident" id="7248379">err</span>&nbsp;<span class="op" id="7248383">:=</span>&nbsp;<span class="ident" id="7248386">ecdsa</span><span class="op" id="7248391">.</span><span class="ident" id="7248392">GenerateKey</span><span class="op" id="7248403">(</span><span class="ident" id="7248404">elliptic</span><span class="op" id="7248412">.</span><span class="ident" id="7248413">P256</span><span class="op" id="7248417">(</span><span class="op" id="7248418">)</span><span class="op" id="7248419">,</span>&nbsp;<span class="ident" id="7248421">rand</span><span class="op" id="7248425">.</span><span class="ident" id="7248426">Reader</span><span class="op" id="7248432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7248435">if</span>&nbsp;<span class="ident" id="7248438">err</span>&nbsp;<span class="op" id="7248442">!=</span>&nbsp;<span class="ident" id="7248445">nil</span>&nbsp;<span class="op" id="7248449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7248453">t</span><span class="op" id="7248454">.</span><span class="ident" id="7248455">Fatalf</span><span class="op" id="7248461">(</span><span class="string" id="7248462">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7248496">,</span>&nbsp;<span class="ident" id="7248498">err</span><span class="op" id="7248501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7248504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7248508">ecdsa384Priv</span><span class="op" id="7248520">,</span>&nbsp;<span class="ident" id="7248522">err</span>&nbsp;<span class="op" id="7248526">:=</span>&nbsp;<span class="ident" id="7248529">ecdsa</span><span class="op" id="7248534">.</span><span class="ident" id="7248535">GenerateKey</span><span class="op" id="7248546">(</span><span class="ident" id="7248547">elliptic</span><span class="op" id="7248555">.</span><span class="ident" id="7248556">P384</span><span class="op" id="7248560">(</span><span class="op" id="7248561">)</span><span class="op" id="7248562">,</span>&nbsp;<span class="ident" id="7248564">rand</span><span class="op" id="7248568">.</span><span class="ident" id="7248569">Reader</span><span class="op" id="7248575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7248578">if</span>&nbsp;<span class="ident" id="7248581">err</span>&nbsp;<span class="op" id="7248585">!=</span>&nbsp;<span class="ident" id="7248588">nil</span>&nbsp;<span class="op" id="7248592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7248596">t</span><span class="op" id="7248597">.</span><span class="ident" id="7248598">Fatalf</span><span class="op" id="7248604">(</span><span class="string" id="7248605">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7248639">,</span>&nbsp;<span class="ident" id="7248641">err</span><span class="op" id="7248644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7248647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7248651">ecdsa521Priv</span><span class="op" id="7248663">,</span>&nbsp;<span class="ident" id="7248665">err</span>&nbsp;<span class="op" id="7248669">:=</span>&nbsp;<span class="ident" id="7248672">ecdsa</span><span class="op" id="7248677">.</span><span class="ident" id="7248678">GenerateKey</span><span class="op" id="7248689">(</span><span class="ident" id="7248690">elliptic</span><span class="op" id="7248698">.</span><span class="ident" id="7248699">P521</span><span class="op" id="7248703">(</span><span class="op" id="7248704">)</span><span class="op" id="7248705">,</span>&nbsp;<span class="ident" id="7248707">rand</span><span class="op" id="7248711">.</span><span class="ident" id="7248712">Reader</span><span class="op" id="7248718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7248721">if</span>&nbsp;<span class="ident" id="7248724">err</span>&nbsp;<span class="op" id="7248728">!=</span>&nbsp;<span class="ident" id="7248731">nil</span>&nbsp;<span class="op" id="7248735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7248739">t</span><span class="op" id="7248740">.</span><span class="ident" id="7248741">Fatalf</span><span class="op" id="7248747">(</span><span class="string" id="7248748">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7248782">,</span>&nbsp;<span class="ident" id="7248784">err</span><span class="op" id="7248787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7248790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7248794">tests</span>&nbsp;<span class="op" id="7248800">:=</span>&nbsp;<span class="op" id="7248803">[</span><span class="op" id="7248804">]</span><span class="keyword" id="7248805">struct</span>&nbsp;<span class="op" id="7248812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7248816">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7248824">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7248833">priv</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7248841">interface</span><span class="op" id="7248850">{</span><span class="op" id="7248851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7248855">sigAlgo</span>&nbsp;<span class="ident" id="7248863">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7248883">}</span><span class="op" id="7248884">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7248888">{</span><span class="string" id="7248889">&#34;RSA&#34;</span><span class="op" id="7248894">,</span>&nbsp;<span class="ident" id="7248896">rsaPriv</span><span class="op" id="7248903">,</span>&nbsp;<span class="ident" id="7248905">SHA1WithRSA</span><span class="op" id="7248916">}</span><span class="op" id="7248917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7248921">{</span><span class="string" id="7248922">&#34;ECDSA-256&#34;</span><span class="op" id="7248933">,</span>&nbsp;<span class="ident" id="7248935">ecdsa256Priv</span><span class="op" id="7248947">,</span>&nbsp;<span class="ident" id="7248949">ECDSAWithSHA1</span><span class="op" id="7248962">}</span><span class="op" id="7248963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7248967">{</span><span class="string" id="7248968">&#34;ECDSA-384&#34;</span><span class="op" id="7248979">,</span>&nbsp;<span class="ident" id="7248981">ecdsa384Priv</span><span class="op" id="7248993">,</span>&nbsp;<span class="ident" id="7248995">ECDSAWithSHA1</span><span class="op" id="7249008">}</span><span class="op" id="7249009">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7249013">{</span><span class="string" id="7249014">&#34;ECDSA-521&#34;</span><span class="op" id="7249025">,</span>&nbsp;<span class="ident" id="7249027">ecdsa521Priv</span><span class="op" id="7249039">,</span>&nbsp;<span class="ident" id="7249041">ECDSAWithSHA1</span><span class="op" id="7249054">}</span><span class="op" id="7249055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7249058">}</span><br>
<span class="lineno">790</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7249062">for</span>&nbsp;<span class="ident" id="7249066">_</span><span class="op" id="7249067">,</span>&nbsp;<span class="ident" id="7249069">test</span>&nbsp;<span class="op" id="7249074">:=</span>&nbsp;<span class="keyword" id="7249077">range</span>&nbsp;<span class="ident" id="7249083">tests</span>&nbsp;<span class="op" id="7249089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7249093">template</span>&nbsp;<span class="op" id="7249102">:=</span>&nbsp;<span class="ident" id="7249105">CertificateRequest</span><span class="op" id="7249123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7249128">Subject</span><span class="op" id="7249135">:</span>&nbsp;<span class="ident" id="7249137">pkix</span><span class="op" id="7249141">.</span><span class="ident" id="7249142">Name</span><span class="op" id="7249146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7249152">CommonName</span><span class="op" id="7249162">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7249166">&#34;test.example.com&#34;</span><span class="op" id="7249184">,</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7249190">Organization</span><span class="op" id="7249202">:</span>&nbsp;<span class="op" id="7249204">[</span><span class="op" id="7249205">]</span><span class="builtintype" id="7249206">string</span><span class="op" id="7249212">{</span><span class="string" id="7249213">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7249225">}</span><span class="op" id="7249226">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7249231">}</span><span class="op" id="7249232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7249237">SignatureAlgorithm</span><span class="op" id="7249255">:</span>&nbsp;<span class="ident" id="7249257">test</span><span class="op" id="7249261">.</span><span class="ident" id="7249262">sigAlgo</span><span class="op" id="7249269">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7249274">DNSNames</span><span class="op" id="7249282">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7249294">[</span><span class="op" id="7249295">]</span><span class="builtintype" id="7249296">string</span><span class="op" id="7249302">{</span><span class="string" id="7249303">&#34;test.example.com&#34;</span><span class="op" id="7249321">}</span><span class="op" id="7249322">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7249327">EmailAddresses</span><span class="op" id="7249341">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7249347">[</span><span class="op" id="7249348">]</span><span class="builtintype" id="7249349">string</span><span class="op" id="7249355">{</span><span class="string" id="7249356">&#34;gopher@golang.org&#34;</span><span class="op" id="7249375">}</span><span class="op" id="7249376">,</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7249381">IPAddresses</span><span class="op" id="7249392">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7249401">[</span><span class="op" id="7249402">]</span><span class="ident" id="7249403">net</span><span class="op" id="7249406">.</span><span class="ident" id="7249407">IP</span><span class="op" id="7249409">{</span><span class="ident" id="7249410">net</span><span class="op" id="7249413">.</span><span class="ident" id="7249414">IPv4</span><span class="op" id="7249418">(</span><span class="num" id="7249419">127</span><span class="op" id="7249422">,</span>&nbsp;<span class="num" id="7249424">0</span><span class="op" id="7249425">,</span>&nbsp;<span class="num" id="7249427">0</span><span class="op" id="7249428">,</span>&nbsp;<span class="num" id="7249430">1</span><span class="op" id="7249431">)</span><span class="op" id="7249432">.</span><span class="ident" id="7249433">To4</span><span class="op" id="7249436">(</span><span class="op" id="7249437">)</span><span class="op" id="7249438">,</span>&nbsp;<span class="ident" id="7249440">net</span><span class="op" id="7249443">.</span><span class="ident" id="7249444">ParseIP</span><span class="op" id="7249451">(</span><span class="string" id="7249452">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="7249474">)</span><span class="op" id="7249475">}</span><span class="op" id="7249476">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7249480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7249485">derBytes</span><span class="op" id="7249493">,</span>&nbsp;<span class="ident" id="7249495">err</span>&nbsp;<span class="op" id="7249499">:=</span>&nbsp;<span class="ident" id="7249502">CreateCertificateRequest</span><span class="op" id="7249526">(</span><span class="ident" id="7249527">random</span><span class="op" id="7249533">,</span>&nbsp;<span class="op" id="7249535">&amp;</span><span class="ident" id="7249536">template</span><span class="op" id="7249544">,</span>&nbsp;<span class="ident" id="7249546">test</span><span class="op" id="7249550">.</span><span class="ident" id="7249551">priv</span><span class="op" id="7249555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7249559">if</span>&nbsp;<span class="ident" id="7249562">err</span>&nbsp;<span class="op" id="7249566">!=</span>&nbsp;<span class="ident" id="7249569">nil</span>&nbsp;<span class="op" id="7249573">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7249578">t</span><span class="op" id="7249579">.</span><span class="ident" id="7249580">Errorf</span><span class="op" id="7249586">(</span><span class="string" id="7249587">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="7249633">,</span>&nbsp;<span class="ident" id="7249635">test</span><span class="op" id="7249639">.</span><span class="ident" id="7249640">name</span><span class="op" id="7249644">,</span>&nbsp;<span class="ident" id="7249646">err</span><span class="op" id="7249649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7249654">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7249665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7249670">out</span><span class="op" id="7249673">,</span>&nbsp;<span class="ident" id="7249675">err</span>&nbsp;<span class="op" id="7249679">:=</span>&nbsp;<span class="ident" id="7249682">ParseCertificateRequest</span><span class="op" id="7249705">(</span><span class="ident" id="7249706">derBytes</span><span class="op" id="7249714">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7249718">if</span>&nbsp;<span class="ident" id="7249721">err</span>&nbsp;<span class="op" id="7249725">!=</span>&nbsp;<span class="ident" id="7249728">nil</span>&nbsp;<span class="op" id="7249732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7249737">t</span><span class="op" id="7249738">.</span><span class="ident" id="7249739">Errorf</span><span class="op" id="7249745">(</span><span class="string" id="7249746">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="7249792">,</span>&nbsp;<span class="ident" id="7249794">test</span><span class="op" id="7249798">.</span><span class="ident" id="7249799">name</span><span class="op" id="7249803">,</span>&nbsp;<span class="ident" id="7249805">err</span><span class="op" id="7249808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7249813">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7249824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7249829">if</span>&nbsp;<span class="ident" id="7249832">out</span><span class="op" id="7249835">.</span><span class="ident" id="7249836">Subject</span><span class="op" id="7249843">.</span><span class="ident" id="7249844">CommonName</span>&nbsp;<span class="op" id="7249855">!=</span>&nbsp;<span class="ident" id="7249858">template</span><span class="op" id="7249866">.</span><span class="ident" id="7249867">Subject</span><span class="op" id="7249874">.</span><span class="ident" id="7249875">CommonName</span>&nbsp;<span class="op" id="7249886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7249891">t</span><span class="op" id="7249892">.</span><span class="ident" id="7249893">Errorf</span><span class="op" id="7249899">(</span><span class="string" id="7249900">&#34;%s:&nbsp;output&nbsp;subject&nbsp;common&nbsp;name&nbsp;and&nbsp;template&nbsp;subject&nbsp;common&nbsp;name&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7249977">,</span>&nbsp;<span class="ident" id="7249979">test</span><span class="op" id="7249983">.</span><span class="ident" id="7249984">name</span><span class="op" id="7249988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7249992">}</span>&nbsp;<span class="keyword" id="7249994">else</span>&nbsp;<span class="keyword" id="7249999">if</span>&nbsp;<span class="builtinfunc" id="7250002">len</span><span class="op" id="7250005">(</span><span class="ident" id="7250006">out</span><span class="op" id="7250009">.</span><span class="ident" id="7250010">Subject</span><span class="op" id="7250017">.</span><span class="ident" id="7250018">Organization</span><span class="op" id="7250030">)</span>&nbsp;<span class="op" id="7250032">!=</span>&nbsp;<span class="builtinfunc" id="7250035">len</span><span class="op" id="7250038">(</span><span class="ident" id="7250039">template</span><span class="op" id="7250047">.</span><span class="ident" id="7250048">Subject</span><span class="op" id="7250055">.</span><span class="ident" id="7250056">Organization</span><span class="op" id="7250068">)</span>&nbsp;<span class="op" id="7250070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7250075">t</span><span class="op" id="7250076">.</span><span class="ident" id="7250077">Errorf</span><span class="op" id="7250083">(</span><span class="string" id="7250084">&#34;%s:&nbsp;output&nbsp;subject&nbsp;organisation&nbsp;and&nbsp;template&nbsp;subject&nbsp;organisation&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7250163">,</span>&nbsp;<span class="ident" id="7250165">test</span><span class="op" id="7250169">.</span><span class="ident" id="7250170">name</span><span class="op" id="7250174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7250178">}</span>&nbsp;<span class="keyword" id="7250180">else</span>&nbsp;<span class="keyword" id="7250185">if</span>&nbsp;<span class="builtinfunc" id="7250188">len</span><span class="op" id="7250191">(</span><span class="ident" id="7250192">out</span><span class="op" id="7250195">.</span><span class="ident" id="7250196">DNSNames</span><span class="op" id="7250204">)</span>&nbsp;<span class="op" id="7250206">!=</span>&nbsp;<span class="builtinfunc" id="7250209">len</span><span class="op" id="7250212">(</span><span class="ident" id="7250213">template</span><span class="op" id="7250221">.</span><span class="ident" id="7250222">DNSNames</span><span class="op" id="7250230">)</span>&nbsp;<span class="op" id="7250232">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7250237">t</span><span class="op" id="7250238">.</span><span class="ident" id="7250239">Errorf</span><span class="op" id="7250245">(</span><span class="string" id="7250246">&#34;%s:&nbsp;output&nbsp;DNS&nbsp;names&nbsp;and&nbsp;template&nbsp;DNS&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7250303">,</span>&nbsp;<span class="ident" id="7250305">test</span><span class="op" id="7250309">.</span><span class="ident" id="7250310">name</span><span class="op" id="7250314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7250318">}</span>&nbsp;<span class="keyword" id="7250320">else</span>&nbsp;<span class="keyword" id="7250325">if</span>&nbsp;<span class="builtinfunc" id="7250328">len</span><span class="op" id="7250331">(</span><span class="ident" id="7250332">out</span><span class="op" id="7250335">.</span><span class="ident" id="7250336">EmailAddresses</span><span class="op" id="7250350">)</span>&nbsp;<span class="op" id="7250352">!=</span>&nbsp;<span class="builtinfunc" id="7250355">len</span><span class="op" id="7250358">(</span><span class="ident" id="7250359">template</span><span class="op" id="7250367">.</span><span class="ident" id="7250368">EmailAddresses</span><span class="op" id="7250382">)</span>&nbsp;<span class="op" id="7250384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7250389">t</span><span class="op" id="7250390">.</span><span class="ident" id="7250391">Errorf</span><span class="op" id="7250397">(</span><span class="string" id="7250398">&#34;%s:&nbsp;output&nbsp;email&nbsp;addresses&nbsp;and&nbsp;template&nbsp;email&nbsp;addresses&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7250467">,</span>&nbsp;<span class="ident" id="7250469">test</span><span class="op" id="7250473">.</span><span class="ident" id="7250474">name</span><span class="op" id="7250478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7250482">}</span>&nbsp;<span class="keyword" id="7250484">else</span>&nbsp;<span class="keyword" id="7250489">if</span>&nbsp;<span class="builtinfunc" id="7250492">len</span><span class="op" id="7250495">(</span><span class="ident" id="7250496">out</span><span class="op" id="7250499">.</span><span class="ident" id="7250500">IPAddresses</span><span class="op" id="7250511">)</span>&nbsp;<span class="op" id="7250513">!=</span>&nbsp;<span class="builtinfunc" id="7250516">len</span><span class="op" id="7250519">(</span><span class="ident" id="7250520">template</span><span class="op" id="7250528">.</span><span class="ident" id="7250529">IPAddresses</span><span class="op" id="7250540">)</span>&nbsp;<span class="op" id="7250542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7250547">t</span><span class="op" id="7250548">.</span><span class="ident" id="7250549">Errorf</span><span class="op" id="7250555">(</span><span class="string" id="7250556">&#34;%s:&nbsp;output&nbsp;IP&nbsp;addresses&nbsp;and&nbsp;template&nbsp;IP&nbsp;addresses&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7250625">,</span>&nbsp;<span class="ident" id="7250627">test</span><span class="op" id="7250631">.</span><span class="ident" id="7250632">name</span><span class="op" id="7250636">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7250640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7250643">}</span><br>
<span class="lineno"></span><span class="op" id="7250645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7250648">func</span>&nbsp;<span class="ident" id="7250653">marshalAndParseCSR</span><span class="op" id="7250671">(</span><span class="ident" id="7250672">t</span>&nbsp;<span class="op" id="7250674">*</span><span class="ident" id="7250675">testing</span><span class="op" id="7250682">.</span><span class="ident" id="7250683">T</span><span class="op" id="7250684">,</span>&nbsp;<span class="ident" id="7250686">template</span>&nbsp;<span class="op" id="7250695">*</span><span class="ident" id="7250696">CertificateRequest</span><span class="op" id="7250714">)</span>&nbsp;<span class="op" id="7250716">*</span><span class="ident" id="7250717">CertificateRequest</span>&nbsp;<span class="op" id="7250736">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7250739">block</span><span class="op" id="7250744">,</span>&nbsp;<span class="ident" id="7250746">_</span>&nbsp;<span class="op" id="7250748">:=</span>&nbsp;<span class="ident" id="7250751">pem</span><span class="op" id="7250754">.</span><span class="ident" id="7250755">Decode</span><span class="op" id="7250761">(</span><span class="op" id="7250762">[</span><span class="op" id="7250763">]</span><span class="builtintype" id="7250764">byte</span><span class="op" id="7250768">(</span><span class="ident" id="7250769">pemPrivateKey</span><span class="op" id="7250782">)</span><span class="op" id="7250783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7250786">rsaPriv</span><span class="op" id="7250793">,</span>&nbsp;<span class="ident" id="7250795">err</span>&nbsp;<span class="op" id="7250799">:=</span>&nbsp;<span class="ident" id="7250802">ParsePKCS1PrivateKey</span><span class="op" id="7250822">(</span><span class="ident" id="7250823">block</span><span class="op" id="7250828">.</span><span class="ident" id="7250829">Bytes</span><span class="op" id="7250834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7250837">if</span>&nbsp;<span class="ident" id="7250840">err</span>&nbsp;<span class="op" id="7250844">!=</span>&nbsp;<span class="ident" id="7250847">nil</span>&nbsp;<span class="op" id="7250851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7250855">t</span><span class="op" id="7250856">.</span><span class="ident" id="7250857">Fatal</span><span class="op" id="7250862">(</span><span class="ident" id="7250863">err</span><span class="op" id="7250866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7250869">}</span><br>
<span class="lineno">835</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7250873">derBytes</span><span class="op" id="7250881">,</span>&nbsp;<span class="ident" id="7250883">err</span>&nbsp;<span class="op" id="7250887">:=</span>&nbsp;<span class="ident" id="7250890">CreateCertificateRequest</span><span class="op" id="7250914">(</span><span class="ident" id="7250915">rand</span><span class="op" id="7250919">.</span><span class="ident" id="7250920">Reader</span><span class="op" id="7250926">,</span>&nbsp;<span class="ident" id="7250928">template</span><span class="op" id="7250936">,</span>&nbsp;<span class="ident" id="7250938">rsaPriv</span><span class="op" id="7250945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7250948">if</span>&nbsp;<span class="ident" id="7250951">err</span>&nbsp;<span class="op" id="7250955">!=</span>&nbsp;<span class="ident" id="7250958">nil</span>&nbsp;<span class="op" id="7250962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7250966">t</span><span class="op" id="7250967">.</span><span class="ident" id="7250968">Fatal</span><span class="op" id="7250973">(</span><span class="ident" id="7250974">err</span><span class="op" id="7250977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7250980">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7250984">csr</span><span class="op" id="7250987">,</span>&nbsp;<span class="ident" id="7250989">err</span>&nbsp;<span class="op" id="7250993">:=</span>&nbsp;<span class="ident" id="7250996">ParseCertificateRequest</span><span class="op" id="7251019">(</span><span class="ident" id="7251020">derBytes</span><span class="op" id="7251028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7251031">if</span>&nbsp;<span class="ident" id="7251034">err</span>&nbsp;<span class="op" id="7251038">!=</span>&nbsp;<span class="ident" id="7251041">nil</span>&nbsp;<span class="op" id="7251045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7251049">t</span><span class="op" id="7251050">.</span><span class="ident" id="7251051">Fatal</span><span class="op" id="7251056">(</span><span class="ident" id="7251057">err</span><span class="op" id="7251060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7251063">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7251067">return</span>&nbsp;<span class="ident" id="7251074">csr</span><br>
<span class="lineno"></span><span class="op" id="7251078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7251081">func</span>&nbsp;<span class="ident" id="7251086">TestCertificateRequestOverrides</span><span class="op" id="7251117">(</span><span class="ident" id="7251118">t</span>&nbsp;<span class="op" id="7251120">*</span><span class="ident" id="7251121">testing</span><span class="op" id="7251128">.</span><span class="ident" id="7251129">T</span><span class="op" id="7251130">)</span>&nbsp;<span class="op" id="7251132">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7251135">sanContents</span><span class="op" id="7251146">,</span>&nbsp;<span class="ident" id="7251148">err</span>&nbsp;<span class="op" id="7251152">:=</span>&nbsp;<span class="ident" id="7251155">marshalSANs</span><span class="op" id="7251166">(</span><span class="op" id="7251167">[</span><span class="op" id="7251168">]</span><span class="builtintype" id="7251169">string</span><span class="op" id="7251175">{</span><span class="string" id="7251176">&#34;foo.example.com&#34;</span><span class="op" id="7251193">}</span><span class="op" id="7251194">,</span>&nbsp;<span class="ident" id="7251196">nil</span><span class="op" id="7251199">,</span>&nbsp;<span class="ident" id="7251201">nil</span><span class="op" id="7251204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7251207">if</span>&nbsp;<span class="ident" id="7251210">err</span>&nbsp;<span class="op" id="7251214">!=</span>&nbsp;<span class="ident" id="7251217">nil</span>&nbsp;<span class="op" id="7251221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7251225">t</span><span class="op" id="7251226">.</span><span class="ident" id="7251227">Fatal</span><span class="op" id="7251232">(</span><span class="ident" id="7251233">err</span><span class="op" id="7251236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7251239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7251243">template</span>&nbsp;<span class="op" id="7251252">:=</span>&nbsp;<span class="ident" id="7251255">CertificateRequest</span><span class="op" id="7251273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7251277">Subject</span><span class="op" id="7251284">:</span>&nbsp;<span class="ident" id="7251286">pkix</span><span class="op" id="7251290">.</span><span class="ident" id="7251291">Name</span><span class="op" id="7251295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7251300">CommonName</span><span class="op" id="7251310">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7251314">&#34;test.example.com&#34;</span><span class="op" id="7251332">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7251337">Organization</span><span class="op" id="7251349">:</span>&nbsp;<span class="op" id="7251351">[</span><span class="op" id="7251352">]</span><span class="builtintype" id="7251353">string</span><span class="op" id="7251359">{</span><span class="string" id="7251360">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7251372">}</span><span class="op" id="7251373">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7251377">}</span><span class="op" id="7251378">,</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7251382">DNSNames</span><span class="op" id="7251390">:</span>&nbsp;<span class="op" id="7251392">[</span><span class="op" id="7251393">]</span><span class="builtintype" id="7251394">string</span><span class="op" id="7251400">{</span><span class="string" id="7251401">&#34;test.example.com&#34;</span><span class="op" id="7251419">}</span><span class="op" id="7251420">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7251425">//&nbsp;An&nbsp;explicit&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;DNSNames&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7251490">//&nbsp;template.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7251505">ExtraExtensions</span><span class="op" id="7251520">:</span>&nbsp;<span class="op" id="7251522">[</span><span class="op" id="7251523">]</span><span class="ident" id="7251524">pkix</span><span class="op" id="7251528">.</span><span class="ident" id="7251529">Extension</span><span class="op" id="7251538">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7251543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7251549">Id</span><span class="op" id="7251551">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7251556">oidExtensionSubjectAltName</span><span class="op" id="7251582">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7251588">Value</span><span class="op" id="7251593">:</span>&nbsp;<span class="ident" id="7251595">sanContents</span><span class="op" id="7251606">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7251611">}</span><span class="op" id="7251612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7251616">}</span><span class="op" id="7251617">,</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7251620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7251624">csr</span>&nbsp;<span class="op" id="7251628">:=</span>&nbsp;<span class="ident" id="7251631">marshalAndParseCSR</span><span class="op" id="7251649">(</span><span class="ident" id="7251650">t</span><span class="op" id="7251651">,</span>&nbsp;<span class="op" id="7251653">&amp;</span><span class="ident" id="7251654">template</span><span class="op" id="7251662">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7251666">if</span>&nbsp;<span class="builtinfunc" id="7251669">len</span><span class="op" id="7251672">(</span><span class="ident" id="7251673">csr</span><span class="op" id="7251676">.</span><span class="ident" id="7251677">DNSNames</span><span class="op" id="7251685">)</span>&nbsp;<span class="op" id="7251687">!=</span>&nbsp;<span class="num" id="7251690">1</span>&nbsp;<span class="op" id="7251692">||</span>&nbsp;<span class="ident" id="7251695">csr</span><span class="op" id="7251698">.</span><span class="ident" id="7251699">DNSNames</span><span class="op" id="7251707">[</span><span class="num" id="7251708">0</span><span class="op" id="7251709">]</span>&nbsp;<span class="op" id="7251711">!=</span>&nbsp;<span class="string" id="7251714">&#34;foo.example.com&#34;</span>&nbsp;<span class="op" id="7251732">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7251736">t</span><span class="op" id="7251737">.</span><span class="ident" id="7251738">Errorf</span><span class="op" id="7251744">(</span><span class="string" id="7251745">&#34;Extension&nbsp;did&nbsp;not&nbsp;override&nbsp;template.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="7251792">,</span>&nbsp;<span class="ident" id="7251794">csr</span><span class="op" id="7251797">.</span><span class="ident" id="7251798">DNSNames</span><span class="op" id="7251806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7251809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7251813">//&nbsp;If&nbsp;there&nbsp;is&nbsp;already&nbsp;an&nbsp;attribute&nbsp;with&nbsp;X.509&nbsp;extensions&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7251881">//&nbsp;extra&nbsp;extensions&nbsp;should&nbsp;be&nbsp;added&nbsp;to&nbsp;it&nbsp;rather&nbsp;than&nbsp;creating&nbsp;a&nbsp;CSR</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7251951">//&nbsp;with&nbsp;two&nbsp;extension&nbsp;attributes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7251987">template</span><span class="op" id="7251995">.</span><span class="ident" id="7251996">Attributes</span>&nbsp;<span class="op" id="7252007">=</span>&nbsp;<span class="op" id="7252009">[</span><span class="op" id="7252010">]</span><span class="ident" id="7252011">pkix</span><span class="op" id="7252015">.</span><span class="ident" id="7252016">AttributeTypeAndValueSET</span><span class="op" id="7252040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7252044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7252049">Type</span><span class="op" id="7252053">:</span>&nbsp;<span class="ident" id="7252055">oidExtensionRequest</span><span class="op" id="7252074">,</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7252079">Value</span><span class="op" id="7252084">:</span>&nbsp;<span class="op" id="7252086">[</span><span class="op" id="7252087">]</span><span class="op" id="7252088">[</span><span class="op" id="7252089">]</span><span class="ident" id="7252090">pkix</span><span class="op" id="7252094">.</span><span class="ident" id="7252095">AttributeTypeAndValue</span><span class="op" id="7252116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7252122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7252129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7252137">Type</span><span class="op" id="7252141">:</span>&nbsp;&nbsp;<span class="ident" id="7252144">oidExtensionAuthorityInfoAccess</span><span class="op" id="7252175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7252183">Value</span><span class="op" id="7252188">:</span>&nbsp;<span class="op" id="7252190">[</span><span class="op" id="7252191">]</span><span class="builtintype" id="7252192">byte</span><span class="op" id="7252196">(</span><span class="string" id="7252197">&#34;foo&#34;</span><span class="op" id="7252202">)</span><span class="op" id="7252203">,</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7252210">}</span><span class="op" id="7252211">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7252217">}</span><span class="op" id="7252218">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7252223">}</span><span class="op" id="7252224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7252228">}</span><span class="op" id="7252229">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7252232">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7252236">csr</span>&nbsp;<span class="op" id="7252240">=</span>&nbsp;<span class="ident" id="7252242">marshalAndParseCSR</span><span class="op" id="7252260">(</span><span class="ident" id="7252261">t</span><span class="op" id="7252262">,</span>&nbsp;<span class="op" id="7252264">&amp;</span><span class="ident" id="7252265">template</span><span class="op" id="7252273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7252276">if</span>&nbsp;<span class="ident" id="7252279">l</span>&nbsp;<span class="op" id="7252281">:=</span>&nbsp;<span class="builtinfunc" id="7252284">len</span><span class="op" id="7252287">(</span><span class="ident" id="7252288">csr</span><span class="op" id="7252291">.</span><span class="ident" id="7252292">Attributes</span><span class="op" id="7252302">)</span><span class="op" id="7252303">;</span>&nbsp;<span class="ident" id="7252305">l</span>&nbsp;<span class="op" id="7252307">!=</span>&nbsp;<span class="num" id="7252310">1</span>&nbsp;<span class="op" id="7252312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7252316">t</span><span class="op" id="7252317">.</span><span class="ident" id="7252318">Errorf</span><span class="op" id="7252324">(</span><span class="string" id="7252325">&#34;incorrect&nbsp;number&nbsp;of&nbsp;attributes:&nbsp;%d\n&#34;</span><span class="op" id="7252363">,</span>&nbsp;<span class="ident" id="7252365">l</span><span class="op" id="7252366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7252369">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7252373">if</span>&nbsp;<span class="op" id="7252376">!</span><span class="ident" id="7252377">csr</span><span class="op" id="7252380">.</span><span class="ident" id="7252381">Attributes</span><span class="op" id="7252391">[</span><span class="num" id="7252392">0</span><span class="op" id="7252393">]</span><span class="op" id="7252394">.</span><span class="ident" id="7252395">Type</span><span class="op" id="7252399">.</span><span class="ident" id="7252400">Equal</span><span class="op" id="7252405">(</span><span class="ident" id="7252406">oidExtensionRequest</span><span class="op" id="7252425">)</span>&nbsp;<span class="op" id="7252427">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7252432">len</span><span class="op" id="7252435">(</span><span class="ident" id="7252436">csr</span><span class="op" id="7252439">.</span><span class="ident" id="7252440">Attributes</span><span class="op" id="7252450">[</span><span class="num" id="7252451">0</span><span class="op" id="7252452">]</span><span class="op" id="7252453">.</span><span class="ident" id="7252454">Value</span><span class="op" id="7252459">)</span>&nbsp;<span class="op" id="7252461">!=</span>&nbsp;<span class="num" id="7252464">1</span>&nbsp;<span class="op" id="7252466">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7252471">len</span><span class="op" id="7252474">(</span><span class="ident" id="7252475">csr</span><span class="op" id="7252478">.</span><span class="ident" id="7252479">Attributes</span><span class="op" id="7252489">[</span><span class="num" id="7252490">0</span><span class="op" id="7252491">]</span><span class="op" id="7252492">.</span><span class="ident" id="7252493">Value</span><span class="op" id="7252498">[</span><span class="num" id="7252499">0</span><span class="op" id="7252500">]</span><span class="op" id="7252501">)</span>&nbsp;<span class="op" id="7252503">!=</span>&nbsp;<span class="num" id="7252506">2</span>&nbsp;<span class="op" id="7252508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7252512">t</span><span class="op" id="7252513">.</span><span class="ident" id="7252514">Errorf</span><span class="op" id="7252520">(</span><span class="string" id="7252521">&#34;bad&nbsp;attributes:&nbsp;%#v\n&#34;</span><span class="op" id="7252544">,</span>&nbsp;<span class="ident" id="7252546">csr</span><span class="op" id="7252549">.</span><span class="ident" id="7252550">Attributes</span><span class="op" id="7252560">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7252563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7252567">sanContents2</span><span class="op" id="7252579">,</span>&nbsp;<span class="ident" id="7252581">err</span>&nbsp;<span class="op" id="7252585">:=</span>&nbsp;<span class="ident" id="7252588">marshalSANs</span><span class="op" id="7252599">(</span><span class="op" id="7252600">[</span><span class="op" id="7252601">]</span><span class="builtintype" id="7252602">string</span><span class="op" id="7252608">{</span><span class="string" id="7252609">&#34;foo2.example.com&#34;</span><span class="op" id="7252627">}</span><span class="op" id="7252628">,</span>&nbsp;<span class="ident" id="7252630">nil</span><span class="op" id="7252633">,</span>&nbsp;<span class="ident" id="7252635">nil</span><span class="op" id="7252638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7252641">if</span>&nbsp;<span class="ident" id="7252644">err</span>&nbsp;<span class="op" id="7252648">!=</span>&nbsp;<span class="ident" id="7252651">nil</span>&nbsp;<span class="op" id="7252655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7252659">t</span><span class="op" id="7252660">.</span><span class="ident" id="7252661">Fatal</span><span class="op" id="7252666">(</span><span class="ident" id="7252667">err</span><span class="op" id="7252670">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7252673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7252677">//&nbsp;Extensions&nbsp;in&nbsp;Attributes&nbsp;should&nbsp;override&nbsp;those&nbsp;in&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7252748">template</span><span class="op" id="7252756">.</span><span class="ident" id="7252757">Attributes</span><span class="op" id="7252767">[</span><span class="num" id="7252768">0</span><span class="op" id="7252769">]</span><span class="op" id="7252770">.</span><span class="ident" id="7252771">Value</span><span class="op" id="7252776">[</span><span class="num" id="7252777">0</span><span class="op" id="7252778">]</span>&nbsp;<span class="op" id="7252780">=</span>&nbsp;<span class="builtinfunc" id="7252782">append</span><span class="op" id="7252788">(</span><span class="ident" id="7252789">template</span><span class="op" id="7252797">.</span><span class="ident" id="7252798">Attributes</span><span class="op" id="7252808">[</span><span class="num" id="7252809">0</span><span class="op" id="7252810">]</span><span class="op" id="7252811">.</span><span class="ident" id="7252812">Value</span><span class="op" id="7252817">[</span><span class="num" id="7252818">0</span><span class="op" id="7252819">]</span><span class="op" id="7252820">,</span>&nbsp;<span class="ident" id="7252822">pkix</span><span class="op" id="7252826">.</span><span class="ident" id="7252827">AttributeTypeAndValue</span><span class="op" id="7252848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7252852">Type</span><span class="op" id="7252856">:</span>&nbsp;&nbsp;<span class="ident" id="7252859">oidExtensionSubjectAltName</span><span class="op" id="7252885">,</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7252889">Value</span><span class="op" id="7252894">:</span>&nbsp;<span class="ident" id="7252896">sanContents2</span><span class="op" id="7252908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7252911">}</span><span class="op" id="7252912">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7252916">csr</span>&nbsp;<span class="op" id="7252920">=</span>&nbsp;<span class="ident" id="7252922">marshalAndParseCSR</span><span class="op" id="7252940">(</span><span class="ident" id="7252941">t</span><span class="op" id="7252942">,</span>&nbsp;<span class="op" id="7252944">&amp;</span><span class="ident" id="7252945">template</span><span class="op" id="7252953">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7252957">if</span>&nbsp;<span class="builtinfunc" id="7252960">len</span><span class="op" id="7252963">(</span><span class="ident" id="7252964">csr</span><span class="op" id="7252967">.</span><span class="ident" id="7252968">DNSNames</span><span class="op" id="7252976">)</span>&nbsp;<span class="op" id="7252978">!=</span>&nbsp;<span class="num" id="7252981">1</span>&nbsp;<span class="op" id="7252983">||</span>&nbsp;<span class="ident" id="7252986">csr</span><span class="op" id="7252989">.</span><span class="ident" id="7252990">DNSNames</span><span class="op" id="7252998">[</span><span class="num" id="7252999">0</span><span class="op" id="7253000">]</span>&nbsp;<span class="op" id="7253002">!=</span>&nbsp;<span class="string" id="7253005">&#34;foo2.example.com&#34;</span>&nbsp;<span class="op" id="7253024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7253028">t</span><span class="op" id="7253029">.</span><span class="ident" id="7253030">Errorf</span><span class="op" id="7253036">(</span><span class="string" id="7253037">&#34;Attributes&nbsp;did&nbsp;not&nbsp;override&nbsp;ExtraExtensions.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="7253092">,</span>&nbsp;<span class="ident" id="7253094">csr</span><span class="op" id="7253097">.</span><span class="ident" id="7253098">DNSNames</span><span class="op" id="7253106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7253109">}</span><br>
<span class="lineno"></span><span class="op" id="7253111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="7253114">func</span>&nbsp;<span class="ident" id="7253119">TestParseCertificateRequest</span><span class="op" id="7253146">(</span><span class="ident" id="7253147">t</span>&nbsp;<span class="op" id="7253149">*</span><span class="ident" id="7253150">testing</span><span class="op" id="7253157">.</span><span class="ident" id="7253158">T</span><span class="op" id="7253159">)</span>&nbsp;<span class="op" id="7253161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7253164">csrBytes</span>&nbsp;<span class="op" id="7253173">:=</span>&nbsp;<span class="ident" id="7253176">fromBase64</span><span class="op" id="7253186">(</span><span class="ident" id="7253187">csrBase64</span><span class="op" id="7253196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7253199">csr</span><span class="op" id="7253202">,</span>&nbsp;<span class="ident" id="7253204">err</span>&nbsp;<span class="op" id="7253208">:=</span>&nbsp;<span class="ident" id="7253211">ParseCertificateRequest</span><span class="op" id="7253234">(</span><span class="ident" id="7253235">csrBytes</span><span class="op" id="7253243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7253246">if</span>&nbsp;<span class="ident" id="7253249">err</span>&nbsp;<span class="op" id="7253253">!=</span>&nbsp;<span class="ident" id="7253256">nil</span>&nbsp;<span class="op" id="7253260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7253264">t</span><span class="op" id="7253265">.</span><span class="ident" id="7253266">Fatalf</span><span class="op" id="7253272">(</span><span class="string" id="7253273">&#34;failed&nbsp;to&nbsp;parse&nbsp;CSR:&nbsp;%s&#34;</span><span class="op" id="7253298">,</span>&nbsp;<span class="ident" id="7253300">err</span><span class="op" id="7253303">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7253306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7253310">if</span>&nbsp;<span class="builtinfunc" id="7253313">len</span><span class="op" id="7253316">(</span><span class="ident" id="7253317">csr</span><span class="op" id="7253320">.</span><span class="ident" id="7253321">EmailAddresses</span><span class="op" id="7253335">)</span>&nbsp;<span class="op" id="7253337">!=</span>&nbsp;<span class="num" id="7253340">1</span>&nbsp;<span class="op" id="7253342">||</span>&nbsp;<span class="ident" id="7253345">csr</span><span class="op" id="7253348">.</span><span class="ident" id="7253349">EmailAddresses</span><span class="op" id="7253363">[</span><span class="num" id="7253364">0</span><span class="op" id="7253365">]</span>&nbsp;<span class="op" id="7253367">!=</span>&nbsp;<span class="string" id="7253370">&#34;gopher@golang.org&#34;</span>&nbsp;<span class="op" id="7253390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7253394">t</span><span class="op" id="7253395">.</span><span class="ident" id="7253396">Errorf</span><span class="op" id="7253402">(</span><span class="string" id="7253403">&#34;incorrect&nbsp;email&nbsp;addresses&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="7253440">,</span>&nbsp;<span class="ident" id="7253442">csr</span><span class="op" id="7253445">.</span><span class="ident" id="7253446">EmailAddresses</span><span class="op" id="7253460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7253463">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7253467">if</span>&nbsp;<span class="builtinfunc" id="7253470">len</span><span class="op" id="7253473">(</span><span class="ident" id="7253474">csr</span><span class="op" id="7253477">.</span><span class="ident" id="7253478">DNSNames</span><span class="op" id="7253486">)</span>&nbsp;<span class="op" id="7253488">!=</span>&nbsp;<span class="num" id="7253491">1</span>&nbsp;<span class="op" id="7253493">||</span>&nbsp;<span class="ident" id="7253496">csr</span><span class="op" id="7253499">.</span><span class="ident" id="7253500">DNSNames</span><span class="op" id="7253508">[</span><span class="num" id="7253509">0</span><span class="op" id="7253510">]</span>&nbsp;<span class="op" id="7253512">!=</span>&nbsp;<span class="string" id="7253515">&#34;test.example.com&#34;</span>&nbsp;<span class="op" id="7253534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7253538">t</span><span class="op" id="7253539">.</span><span class="ident" id="7253540">Errorf</span><span class="op" id="7253546">(</span><span class="string" id="7253547">&#34;incorrect&nbsp;DNS&nbsp;names&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="7253578">,</span>&nbsp;<span class="ident" id="7253580">csr</span><span class="op" id="7253583">.</span><span class="ident" id="7253584">DNSNames</span><span class="op" id="7253592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7253595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7253599">if</span>&nbsp;<span class="builtinfunc" id="7253602">len</span><span class="op" id="7253605">(</span><span class="ident" id="7253606">csr</span><span class="op" id="7253609">.</span><span class="ident" id="7253610">Subject</span><span class="op" id="7253617">.</span><span class="ident" id="7253618">Country</span><span class="op" id="7253625">)</span>&nbsp;<span class="op" id="7253627">!=</span>&nbsp;<span class="num" id="7253630">1</span>&nbsp;<span class="op" id="7253632">||</span>&nbsp;<span class="ident" id="7253635">csr</span><span class="op" id="7253638">.</span><span class="ident" id="7253639">Subject</span><span class="op" id="7253646">.</span><span class="ident" id="7253647">Country</span><span class="op" id="7253654">[</span><span class="num" id="7253655">0</span><span class="op" id="7253656">]</span>&nbsp;<span class="op" id="7253658">!=</span>&nbsp;<span class="string" id="7253661">&#34;AU&#34;</span>&nbsp;<span class="op" id="7253666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7253670">t</span><span class="op" id="7253671">.</span><span class="ident" id="7253672">Errorf</span><span class="op" id="7253678">(</span><span class="string" id="7253679">&#34;incorrect&nbsp;Subject&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7253707">,</span>&nbsp;<span class="ident" id="7253709">csr</span><span class="op" id="7253712">.</span><span class="ident" id="7253713">Subject</span><span class="op" id="7253720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7253723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7253727">found</span>&nbsp;<span class="op" id="7253733">:=</span>&nbsp;<span class="builtintype" id="7253736">false</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7253743">for</span>&nbsp;<span class="ident" id="7253747">_</span><span class="op" id="7253748">,</span>&nbsp;<span class="ident" id="7253750">e</span>&nbsp;<span class="op" id="7253752">:=</span>&nbsp;<span class="keyword" id="7253755">range</span>&nbsp;<span class="ident" id="7253761">csr</span><span class="op" id="7253764">.</span><span class="ident" id="7253765">Extensions</span>&nbsp;<span class="op" id="7253776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7253780">if</span>&nbsp;<span class="ident" id="7253783">e</span><span class="op" id="7253784">.</span><span class="ident" id="7253785">Id</span><span class="op" id="7253787">.</span><span class="ident" id="7253788">Equal</span><span class="op" id="7253793">(</span><span class="ident" id="7253794">oidExtensionBasicConstraints</span><span class="op" id="7253822">)</span>&nbsp;<span class="op" id="7253824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7253829">found</span>&nbsp;<span class="op" id="7253835">=</span>&nbsp;<span class="builtintype" id="7253837">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7253845">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7253853">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7253856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7253859">if</span>&nbsp;<span class="op" id="7253862">!</span><span class="ident" id="7253863">found</span>&nbsp;<span class="op" id="7253869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7253873">t</span><span class="op" id="7253874">.</span><span class="ident" id="7253875">Errorf</span><span class="op" id="7253881">(</span><span class="string" id="7253882">&#34;basic&nbsp;constraints&nbsp;extension&nbsp;not&nbsp;found&nbsp;in&nbsp;CSR&#34;</span><span class="op" id="7253928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7253931">}</span><br>
<span class="lineno"></span><span class="op" id="7253933">}</span><br>
<span class="lineno">955</span><br>
<span class="lineno"></span><span class="keyword" id="7253936">func</span>&nbsp;<span class="ident" id="7253941">TestMaxPathLen</span><span class="op" id="7253955">(</span><span class="ident" id="7253956">t</span>&nbsp;<span class="op" id="7253958">*</span><span class="ident" id="7253959">testing</span><span class="op" id="7253966">.</span><span class="ident" id="7253967">T</span><span class="op" id="7253968">)</span>&nbsp;<span class="op" id="7253970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7253973">block</span><span class="op" id="7253978">,</span>&nbsp;<span class="ident" id="7253980">_</span>&nbsp;<span class="op" id="7253982">:=</span>&nbsp;<span class="ident" id="7253985">pem</span><span class="op" id="7253988">.</span><span class="ident" id="7253989">Decode</span><span class="op" id="7253995">(</span><span class="op" id="7253996">[</span><span class="op" id="7253997">]</span><span class="builtintype" id="7253998">byte</span><span class="op" id="7254002">(</span><span class="ident" id="7254003">pemPrivateKey</span><span class="op" id="7254016">)</span><span class="op" id="7254017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254020">rsaPriv</span><span class="op" id="7254027">,</span>&nbsp;<span class="ident" id="7254029">err</span>&nbsp;<span class="op" id="7254033">:=</span>&nbsp;<span class="ident" id="7254036">ParsePKCS1PrivateKey</span><span class="op" id="7254056">(</span><span class="ident" id="7254057">block</span><span class="op" id="7254062">.</span><span class="ident" id="7254063">Bytes</span><span class="op" id="7254068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7254071">if</span>&nbsp;<span class="ident" id="7254074">err</span>&nbsp;<span class="op" id="7254078">!=</span>&nbsp;<span class="ident" id="7254081">nil</span>&nbsp;<span class="op" id="7254085">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254089">t</span><span class="op" id="7254090">.</span><span class="ident" id="7254091">Fatalf</span><span class="op" id="7254097">(</span><span class="string" id="7254098">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7254131">,</span>&nbsp;<span class="ident" id="7254133">err</span><span class="op" id="7254136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7254139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254143">template</span>&nbsp;<span class="op" id="7254152">:=</span>&nbsp;<span class="op" id="7254155">&amp;</span><span class="ident" id="7254156">Certificate</span><span class="op" id="7254167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254171">SerialNumber</span><span class="op" id="7254183">:</span>&nbsp;<span class="ident" id="7254185">big</span><span class="op" id="7254188">.</span><span class="ident" id="7254189">NewInt</span><span class="op" id="7254195">(</span><span class="num" id="7254196">1</span><span class="op" id="7254197">)</span><span class="op" id="7254198">,</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254202">Subject</span><span class="op" id="7254209">:</span>&nbsp;<span class="ident" id="7254211">pkix</span><span class="op" id="7254215">.</span><span class="ident" id="7254216">Name</span><span class="op" id="7254220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254225">CommonName</span><span class="op" id="7254235">:</span>&nbsp;<span class="string" id="7254237">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7254249">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7254253">}</span><span class="op" id="7254254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254258">NotBefore</span><span class="op" id="7254267">:</span>&nbsp;<span class="ident" id="7254269">time</span><span class="op" id="7254273">.</span><span class="ident" id="7254274">Unix</span><span class="op" id="7254278">(</span><span class="num" id="7254279">1000</span><span class="op" id="7254283">,</span>&nbsp;<span class="num" id="7254285">0</span><span class="op" id="7254286">)</span><span class="op" id="7254287">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254291">NotAfter</span><span class="op" id="7254299">:</span>&nbsp;&nbsp;<span class="ident" id="7254302">time</span><span class="op" id="7254306">.</span><span class="ident" id="7254307">Unix</span><span class="op" id="7254311">(</span><span class="num" id="7254312">100000</span><span class="op" id="7254318">,</span>&nbsp;<span class="num" id="7254320">0</span><span class="op" id="7254321">)</span><span class="op" id="7254322">,</span><br>
<span class="lineno">970</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254327">BasicConstraintsValid</span><span class="op" id="7254348">:</span>&nbsp;<span class="builtintype" id="7254350">true</span><span class="op" id="7254354">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254358">IsCA</span><span class="op" id="7254362">:</span>&nbsp;<span class="builtintype" id="7254364">true</span><span class="op" id="7254368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7254371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254375">serialiseAndParse</span>&nbsp;<span class="op" id="7254393">:=</span>&nbsp;<span class="keyword" id="7254396">func</span><span class="op" id="7254400">(</span><span class="ident" id="7254401">template</span>&nbsp;<span class="op" id="7254410">*</span><span class="ident" id="7254411">Certificate</span><span class="op" id="7254422">)</span>&nbsp;<span class="op" id="7254424">*</span><span class="ident" id="7254425">Certificate</span>&nbsp;<span class="op" id="7254437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254441">derBytes</span><span class="op" id="7254449">,</span>&nbsp;<span class="ident" id="7254451">err</span>&nbsp;<span class="op" id="7254455">:=</span>&nbsp;<span class="ident" id="7254458">CreateCertificate</span><span class="op" id="7254475">(</span><span class="ident" id="7254476">rand</span><span class="op" id="7254480">.</span><span class="ident" id="7254481">Reader</span><span class="op" id="7254487">,</span>&nbsp;<span class="ident" id="7254489">template</span><span class="op" id="7254497">,</span>&nbsp;<span class="ident" id="7254499">template</span><span class="op" id="7254507">,</span>&nbsp;<span class="op" id="7254509">&amp;</span><span class="ident" id="7254510">rsaPriv</span><span class="op" id="7254517">.</span><span class="ident" id="7254518">PublicKey</span><span class="op" id="7254527">,</span>&nbsp;<span class="ident" id="7254529">rsaPriv</span><span class="op" id="7254536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7254540">if</span>&nbsp;<span class="ident" id="7254543">err</span>&nbsp;<span class="op" id="7254547">!=</span>&nbsp;<span class="ident" id="7254550">nil</span>&nbsp;<span class="op" id="7254554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254559">t</span><span class="op" id="7254560">.</span><span class="ident" id="7254561">Fatalf</span><span class="op" id="7254567">(</span><span class="string" id="7254568">&#34;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7254602">,</span>&nbsp;<span class="ident" id="7254604">err</span><span class="op" id="7254607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7254612">return</span>&nbsp;<span class="ident" id="7254619">nil</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7254625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254630">cert</span><span class="op" id="7254634">,</span>&nbsp;<span class="ident" id="7254636">err</span>&nbsp;<span class="op" id="7254640">:=</span>&nbsp;<span class="ident" id="7254643">ParseCertificate</span><span class="op" id="7254659">(</span><span class="ident" id="7254660">derBytes</span><span class="op" id="7254668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7254672">if</span>&nbsp;<span class="ident" id="7254675">err</span>&nbsp;<span class="op" id="7254679">!=</span>&nbsp;<span class="ident" id="7254682">nil</span>&nbsp;<span class="op" id="7254686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254691">t</span><span class="op" id="7254692">.</span><span class="ident" id="7254693">Fatalf</span><span class="op" id="7254699">(</span><span class="string" id="7254700">&#34;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7254733">,</span>&nbsp;<span class="ident" id="7254735">err</span><span class="op" id="7254738">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7254743">return</span>&nbsp;<span class="ident" id="7254750">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7254756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7254761">return</span>&nbsp;<span class="ident" id="7254768">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7254774">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254778">cert1</span>&nbsp;<span class="op" id="7254784">:=</span>&nbsp;<span class="ident" id="7254787">serialiseAndParse</span><span class="op" id="7254804">(</span><span class="ident" id="7254805">template</span><span class="op" id="7254813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7254816">if</span>&nbsp;<span class="ident" id="7254819">m</span>&nbsp;<span class="op" id="7254821">:=</span>&nbsp;<span class="ident" id="7254824">cert1</span><span class="op" id="7254829">.</span><span class="ident" id="7254830">MaxPathLen</span><span class="op" id="7254840">;</span>&nbsp;<span class="ident" id="7254842">m</span>&nbsp;<span class="op" id="7254844">!=</span>&nbsp;<span class="op" id="7254847">-</span><span class="num" id="7254848">1</span>&nbsp;<span class="op" id="7254850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254854">t</span><span class="op" id="7254855">.</span><span class="ident" id="7254856">Errorf</span><span class="op" id="7254862">(</span><span class="string" id="7254863">&#34;Omitting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;turn&nbsp;into&nbsp;-1,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7254912">,</span>&nbsp;<span class="ident" id="7254914">m</span><span class="op" id="7254915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7254918">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7254921">if</span>&nbsp;<span class="ident" id="7254924">cert1</span><span class="op" id="7254929">.</span><span class="ident" id="7254930">MaxPathLenZero</span>&nbsp;<span class="op" id="7254945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254949">t</span><span class="op" id="7254950">.</span><span class="ident" id="7254951">Errorf</span><span class="op" id="7254957">(</span><span class="string" id="7254958">&#34;Omitting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7255006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7255009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255013">template</span><span class="op" id="7255021">.</span><span class="ident" id="7255022">MaxPathLen</span>&nbsp;<span class="op" id="7255033">=</span>&nbsp;<span class="num" id="7255035">1</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255038">cert2</span>&nbsp;<span class="op" id="7255044">:=</span>&nbsp;<span class="ident" id="7255047">serialiseAndParse</span><span class="op" id="7255064">(</span><span class="ident" id="7255065">template</span><span class="op" id="7255073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7255076">if</span>&nbsp;<span class="ident" id="7255079">m</span>&nbsp;<span class="op" id="7255081">:=</span>&nbsp;<span class="ident" id="7255084">cert2</span><span class="op" id="7255089">.</span><span class="ident" id="7255090">MaxPathLen</span><span class="op" id="7255100">;</span>&nbsp;<span class="ident" id="7255102">m</span>&nbsp;<span class="op" id="7255104">!=</span>&nbsp;<span class="num" id="7255107">1</span>&nbsp;<span class="op" id="7255109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255113">t</span><span class="op" id="7255114">.</span><span class="ident" id="7255115">Errorf</span><span class="op" id="7255121">(</span><span class="string" id="7255122">&#34;Setting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;work.&nbsp;Got&nbsp;%d&nbsp;but&nbsp;set&nbsp;1&#34;</span><span class="op" id="7255172">,</span>&nbsp;<span class="ident" id="7255174">m</span><span class="op" id="7255175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7255178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7255181">if</span>&nbsp;<span class="ident" id="7255184">cert2</span><span class="op" id="7255189">.</span><span class="ident" id="7255190">MaxPathLenZero</span>&nbsp;<span class="op" id="7255205">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255209">t</span><span class="op" id="7255210">.</span><span class="ident" id="7255211">Errorf</span><span class="op" id="7255217">(</span><span class="string" id="7255218">&#34;Setting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7255265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7255268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255272">template</span><span class="op" id="7255280">.</span><span class="ident" id="7255281">MaxPathLen</span>&nbsp;<span class="op" id="7255292">=</span>&nbsp;<span class="num" id="7255294">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255297">template</span><span class="op" id="7255305">.</span><span class="ident" id="7255306">MaxPathLenZero</span>&nbsp;<span class="op" id="7255321">=</span>&nbsp;<span class="builtintype" id="7255323">true</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255329">cert3</span>&nbsp;<span class="op" id="7255335">:=</span>&nbsp;<span class="ident" id="7255338">serialiseAndParse</span><span class="op" id="7255355">(</span><span class="ident" id="7255356">template</span><span class="op" id="7255364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7255367">if</span>&nbsp;<span class="ident" id="7255370">m</span>&nbsp;<span class="op" id="7255372">:=</span>&nbsp;<span class="ident" id="7255375">cert3</span><span class="op" id="7255380">.</span><span class="ident" id="7255381">MaxPathLen</span><span class="op" id="7255391">;</span>&nbsp;<span class="ident" id="7255393">m</span>&nbsp;<span class="op" id="7255395">!=</span>&nbsp;<span class="num" id="7255398">0</span>&nbsp;<span class="op" id="7255400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255404">t</span><span class="op" id="7255405">.</span><span class="ident" id="7255406">Errorf</span><span class="op" id="7255412">(</span><span class="string" id="7255413">&#34;Setting&nbsp;MaxPathLenZero&nbsp;didn&#39;t&nbsp;work,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7255457">,</span>&nbsp;<span class="ident" id="7255459">m</span><span class="op" id="7255460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7255463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7255466">if</span>&nbsp;<span class="op" id="7255469">!</span><span class="ident" id="7255470">cert3</span><span class="op" id="7255475">.</span><span class="ident" id="7255476">MaxPathLenZero</span>&nbsp;<span class="op" id="7255491">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255495">t</span><span class="op" id="7255496">.</span><span class="ident" id="7255497">Errorf</span><span class="op" id="7255503">(</span><span class="string" id="7255504">&#34;Setting&nbsp;MaxPathLen&nbsp;to&nbsp;zero&nbsp;didn&#39;t&nbsp;result&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7255564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7255567">}</span><br>
<span class="lineno"></span><span class="op" id="7255569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7255572">//&nbsp;This&nbsp;CSR&nbsp;was&nbsp;generated&nbsp;with&nbsp;OpenSSL:</span><br>
<span class="lineno">1020</span><span class="comment" id="7255612">//&nbsp;&nbsp;openssl&nbsp;req&nbsp;-out&nbsp;CSR.csr&nbsp;-new&nbsp;-newkey&nbsp;rsa:2048&nbsp;-nodes&nbsp;-keyout&nbsp;privateKey.key&nbsp;-config&nbsp;openssl.cnf</span><br>
<span class="lineno"></span><span class="comment" id="7255713">//</span><br>
<span class="lineno"></span><span class="comment" id="7255716">//&nbsp;The&nbsp;openssl.cnf&nbsp;needs&nbsp;to&nbsp;include&nbsp;this&nbsp;section:</span><br>
<span class="lineno"></span><span class="comment" id="7255766">//&nbsp;&nbsp;&nbsp;[&nbsp;v3_req&nbsp;]</span><br>
<span class="lineno"></span><span class="comment" id="7255782">//&nbsp;&nbsp;&nbsp;basicConstraints&nbsp;=&nbsp;CA:FALSE</span><br>
<span class="lineno">1025</span><span class="comment" id="7255815">//&nbsp;&nbsp;&nbsp;keyUsage&nbsp;=&nbsp;nonRepudiation,&nbsp;digitalSignature,&nbsp;keyEncipherment</span><br>
<span class="lineno"></span><span class="comment" id="7255881">//&nbsp;&nbsp;&nbsp;subjectAltName&nbsp;=&nbsp;email:gopher@golang.org,DNS:test.example.com</span><br>
<span class="lineno"></span><span class="keyword" id="7255948">const</span>&nbsp;<span class="ident" id="7255954">csrBase64</span>&nbsp;<span class="op" id="7255964">=</span>&nbsp;<span class="string" id="7255966">&#34;MIIC4zCCAcsCAQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoMGEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOY+MVedRg2JEnyeLcSzcsMv2VcsTfkB5+Etd6hihAh6MrGezNyASMMKuQN6YhCX1icQDiQtGsDLTtheNnSXK06tAhHjAP/hGlszRJp+5+rP2M58fDBAkUBEhskbCUWwpY14jFtVuGNJ8vF8h8IeczdolvQhX9lVai9G0EUXJMliMKdjA899H0mRs9PzHyidyrXFNiZlQXfD8Kg7gETn2Ny965iyI6ujAIYSCvam6TnxRHYH2MBKyVGvsYGbPYUQJCsgdgyajEg6ekihvQY3SzO1HSAlZAd7d1QYO4VeWJ2mY6Wu3Jpmh+AmG19S9CcHqGjd0bhuAX9cpPOKgnEmqn0CAwEAAaBZMFcGCSqGSIb3DQEJDjFKMEgwCQYDVR0TBAIwADALBgNVHQ8EBAMCBeAwLgYDVR0RBCcwJYERZ29waGVyQGdvbGFuZy5vcmeCEHRlc3QuZXhhbXBsZS5jb20wDQYJKoZIhvcNAQEFBQADggEBAC9+QpKfdabxwCWwf4IEe1cKjdXLS1ScSuw27a3kZzQiPV78WJMa6dB8dqhdH5BRwGZ/qsgLrO6ZHlNeIv2Ib41Ccq71ecHW/nXc94A1BzJ/bVdI9LZcmTUvR1/m1jCpN7UqQ0ml1u9VihK7Pe762hEYxuWDQzYEU0l15S/bXmqeq3eF1A59XT/2jwe5+NV0Wwf4UQlkTXsAQMsJ+KzrQafd8Qv2A49o048uRvmjeJDrXLawGVianZ7D5A6Fpd1rZh6XcjqBpmgLw41DRQWENOdzhy+HyphKRv1MlY8OLkNqpGMhu8DdgJVGoT16DGiickoEa7Z3UCPVNgdTkT9jq7U=&#34;</span>
</div>
</body>
</html>
