<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/textproto</h2>
<ul>
<li><a href="/gostd/net/textproto/header.go.html">header.go</a></li>
<li><a href="/gostd/net/textproto/pipeline.go.html">pipeline.go</a></li>
<li><a href="/gostd/net/textproto/reader.go.html">reader.go</a></li>
<li><a href="/gostd/net/textproto/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/net/textproto/textproto.go.html">textproto.go</a></li>
<li><a href="/gostd/net/textproto/writer.go.html">writer.go</a></li>
<li><a href="/gostd/net/textproto/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3073116">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3073172">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3073226">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3073277">//&nbsp;Package&nbsp;textproto&nbsp;implements&nbsp;generic&nbsp;support&nbsp;for&nbsp;text-based&nbsp;request/response</span><br>
<span class="lineno"></span><span class="comment" id="3073357">//&nbsp;protocols&nbsp;in&nbsp;the&nbsp;style&nbsp;of&nbsp;HTTP,&nbsp;NNTP,&nbsp;and&nbsp;SMTP.</span><br>
<span class="lineno"></span><span class="comment" id="3073408">//</span><br>
<span class="lineno"></span><span class="comment" id="3073411">//&nbsp;The&nbsp;package&nbsp;provides:</span><br>
<span class="lineno"></span><span class="comment" id="3073436">//</span><br>
<span class="lineno">10</span><span class="comment" id="3073439">//&nbsp;Error,&nbsp;which&nbsp;represents&nbsp;a&nbsp;numeric&nbsp;error&nbsp;response&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="3073496">//&nbsp;a&nbsp;server.</span><br>
<span class="lineno"></span><span class="comment" id="3073509">//</span><br>
<span class="lineno"></span><span class="comment" id="3073512">//&nbsp;Pipeline,&nbsp;to&nbsp;manage&nbsp;pipelined&nbsp;requests&nbsp;and&nbsp;responses</span><br>
<span class="lineno"></span><span class="comment" id="3073568">//&nbsp;in&nbsp;a&nbsp;client.</span><br>
<span class="lineno">15</span><span class="comment" id="3073584">//</span><br>
<span class="lineno"></span><span class="comment" id="3073587">//&nbsp;Reader,&nbsp;to&nbsp;read&nbsp;numeric&nbsp;response&nbsp;code&nbsp;lines,</span><br>
<span class="lineno"></span><span class="comment" id="3073635">//&nbsp;key:&nbsp;value&nbsp;headers,&nbsp;lines&nbsp;wrapped&nbsp;with&nbsp;leading&nbsp;spaces</span><br>
<span class="lineno"></span><span class="comment" id="3073692">//&nbsp;on&nbsp;continuation&nbsp;lines,&nbsp;and&nbsp;whole&nbsp;text&nbsp;blocks&nbsp;ending</span><br>
<span class="lineno"></span><span class="comment" id="3073747">//&nbsp;with&nbsp;a&nbsp;dot&nbsp;on&nbsp;a&nbsp;line&nbsp;by&nbsp;itself.</span><br>
<span class="lineno">20</span><span class="comment" id="3073782">//</span><br>
<span class="lineno"></span><span class="comment" id="3073785">//&nbsp;Writer,&nbsp;to&nbsp;write&nbsp;dot-encoded&nbsp;text&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="comment" id="3073830">//</span><br>
<span class="lineno"></span><span class="comment" id="3073833">//&nbsp;Conn,&nbsp;a&nbsp;convenient&nbsp;packaging&nbsp;of&nbsp;Reader,&nbsp;Writer,&nbsp;and&nbsp;Pipeline&nbsp;for&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="3073905">//&nbsp;with&nbsp;a&nbsp;single&nbsp;network&nbsp;connection.</span><br>
<span class="lineno">25</span><span class="comment" id="3073942">//</span><br>
<span class="lineno"></span><span class="keyword" id="3073945">package</span>&nbsp;<span class="ident" id="3073953">textproto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3073964">import</span>&nbsp;<span class="op" id="3073971">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3073974">&#34;bufio&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3073983">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3073990">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3073996">&#34;net&#34;</span><br>
<span class="lineno"></span><span class="op" id="3074002">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="3074005">//&nbsp;An&nbsp;Error&nbsp;represents&nbsp;a&nbsp;numeric&nbsp;error&nbsp;response&nbsp;from&nbsp;a&nbsp;server.</span><br>
<span class="lineno"></span><span class="keyword" id="3074068">type</span>&nbsp;<span class="ident" id="3074073">Error</span>&nbsp;<span class="keyword" id="3074079">struct</span>&nbsp;<span class="op" id="3074086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074089">Code</span>&nbsp;<span class="builtintype" id="3074094">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074099">Msg</span>&nbsp;&nbsp;<span class="builtintype" id="3074104">string</span><br>
<span class="lineno"></span><span class="op" id="3074111">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="3074114">func</span>&nbsp;<span class="op" id="3074119">(</span><span class="ident" id="3074120">e</span>&nbsp;<span class="op" id="3074122">*</span><span class="ident" id="3074123">Error</span><span class="op" id="3074128">)</span>&nbsp;<span class="ident" id="3074130">Error</span><span class="op" id="3074135">(</span><span class="op" id="3074136">)</span>&nbsp;<span class="builtintype" id="3074138">string</span>&nbsp;<span class="op" id="3074145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3074148">return</span>&nbsp;<span class="ident" id="3074155">fmt</span><span class="op" id="3074158">.</span><span class="ident" id="3074159">Sprintf</span><span class="op" id="3074166">(</span><span class="string" id="3074167">&#34;%03d&nbsp;%s&#34;</span><span class="op" id="3074176">,</span>&nbsp;<span class="ident" id="3074178">e</span><span class="op" id="3074179">.</span><span class="ident" id="3074180">Code</span><span class="op" id="3074184">,</span>&nbsp;<span class="ident" id="3074186">e</span><span class="op" id="3074187">.</span><span class="ident" id="3074188">Msg</span><span class="op" id="3074191">)</span><br>
<span class="lineno"></span><span class="op" id="3074193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="3074196">//&nbsp;A&nbsp;ProtocolError&nbsp;describes&nbsp;a&nbsp;protocol&nbsp;violation&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="3074251">//&nbsp;as&nbsp;an&nbsp;invalid&nbsp;response&nbsp;or&nbsp;a&nbsp;hung-up&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3074302">type</span>&nbsp;<span class="ident" id="3074307">ProtocolError</span>&nbsp;<span class="builtintype" id="3074321">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3074329">func</span>&nbsp;<span class="op" id="3074334">(</span><span class="ident" id="3074335">p</span>&nbsp;<span class="ident" id="3074337">ProtocolError</span><span class="op" id="3074350">)</span>&nbsp;<span class="ident" id="3074352">Error</span><span class="op" id="3074357">(</span><span class="op" id="3074358">)</span>&nbsp;<span class="builtintype" id="3074360">string</span>&nbsp;<span class="op" id="3074367">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3074370">return</span>&nbsp;<span class="builtintype" id="3074377">string</span><span class="op" id="3074383">(</span><span class="ident" id="3074384">p</span><span class="op" id="3074385">)</span><br>
<span class="lineno"></span><span class="op" id="3074387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3074390">//&nbsp;A&nbsp;Conn&nbsp;represents&nbsp;a&nbsp;textual&nbsp;network&nbsp;protocol&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="3074450">//&nbsp;It&nbsp;consists&nbsp;of&nbsp;a&nbsp;Reader&nbsp;and&nbsp;Writer&nbsp;to&nbsp;manage&nbsp;I/O</span><br>
<span class="lineno">55</span><span class="comment" id="3074502">//&nbsp;and&nbsp;a&nbsp;Pipeline&nbsp;to&nbsp;sequence&nbsp;concurrent&nbsp;requests&nbsp;on&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="3074571">//&nbsp;These&nbsp;embedded&nbsp;types&nbsp;carry&nbsp;methods&nbsp;with&nbsp;them;</span><br>
<span class="lineno"></span><span class="comment" id="3074620">//&nbsp;see&nbsp;the&nbsp;documentation&nbsp;of&nbsp;those&nbsp;types&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span><span class="keyword" id="3074673">type</span>&nbsp;<span class="ident" id="3074678">Conn</span>&nbsp;<span class="keyword" id="3074683">struct</span>&nbsp;<span class="op" id="3074690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074693">Reader</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074701">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074709">Pipeline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074719">conn</span>&nbsp;<span class="ident" id="3074724">io</span><span class="op" id="3074726">.</span><span class="ident" id="3074727">ReadWriteCloser</span><br>
<span class="lineno"></span><span class="op" id="3074743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="3074746">//&nbsp;NewConn&nbsp;returns&nbsp;a&nbsp;new&nbsp;Conn&nbsp;using&nbsp;conn&nbsp;for&nbsp;I/O.</span><br>
<span class="lineno"></span><span class="keyword" id="3074796">func</span>&nbsp;<span class="ident" id="3074801">NewConn</span><span class="op" id="3074808">(</span><span class="ident" id="3074809">conn</span>&nbsp;<span class="ident" id="3074814">io</span><span class="op" id="3074816">.</span><span class="ident" id="3074817">ReadWriteCloser</span><span class="op" id="3074832">)</span>&nbsp;<span class="op" id="3074834">*</span><span class="ident" id="3074835">Conn</span>&nbsp;<span class="op" id="3074840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3074843">return</span>&nbsp;<span class="op" id="3074850">&amp;</span><span class="ident" id="3074851">Conn</span><span class="op" id="3074855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074859">Reader</span><span class="op" id="3074865">:</span>&nbsp;<span class="ident" id="3074867">Reader</span><span class="op" id="3074873">{</span><span class="ident" id="3074874">R</span><span class="op" id="3074875">:</span>&nbsp;<span class="ident" id="3074877">bufio</span><span class="op" id="3074882">.</span><span class="ident" id="3074883">NewReader</span><span class="op" id="3074892">(</span><span class="ident" id="3074893">conn</span><span class="op" id="3074897">)</span><span class="op" id="3074898">}</span><span class="op" id="3074899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074903">Writer</span><span class="op" id="3074909">:</span>&nbsp;<span class="ident" id="3074911">Writer</span><span class="op" id="3074917">{</span><span class="ident" id="3074918">W</span><span class="op" id="3074919">:</span>&nbsp;<span class="ident" id="3074921">bufio</span><span class="op" id="3074926">.</span><span class="ident" id="3074927">NewWriter</span><span class="op" id="3074936">(</span><span class="ident" id="3074937">conn</span><span class="op" id="3074941">)</span><span class="op" id="3074942">}</span><span class="op" id="3074943">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074947">conn</span><span class="op" id="3074951">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3074955">conn</span><span class="op" id="3074959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3074962">}</span><br>
<span class="lineno"></span><span class="op" id="3074964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3074967">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno">75</span><span class="keyword" id="3074999">func</span>&nbsp;<span class="op" id="3075004">(</span><span class="ident" id="3075005">c</span>&nbsp;<span class="op" id="3075007">*</span><span class="ident" id="3075008">Conn</span><span class="op" id="3075012">)</span>&nbsp;<span class="ident" id="3075014">Close</span><span class="op" id="3075019">(</span><span class="op" id="3075020">)</span>&nbsp;<span class="builtintype" id="3075022">error</span>&nbsp;<span class="op" id="3075028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3075031">return</span>&nbsp;<span class="ident" id="3075038">c</span><span class="op" id="3075039">.</span><span class="ident" id="3075040">conn</span><span class="op" id="3075044">.</span><span class="ident" id="3075045">Close</span><span class="op" id="3075050">(</span><span class="op" id="3075051">)</span><br>
<span class="lineno"></span><span class="op" id="3075053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3075056">//&nbsp;Dial&nbsp;connects&nbsp;to&nbsp;the&nbsp;given&nbsp;address&nbsp;on&nbsp;the&nbsp;given&nbsp;network&nbsp;using&nbsp;net.Dial</span><br>
<span class="lineno">80</span><span class="comment" id="3075130">//&nbsp;and&nbsp;then&nbsp;returns&nbsp;a&nbsp;new&nbsp;Conn&nbsp;for&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3075181">func</span>&nbsp;<span class="ident" id="3075186">Dial</span><span class="op" id="3075190">(</span><span class="ident" id="3075191">network</span><span class="op" id="3075198">,</span>&nbsp;<span class="ident" id="3075200">addr</span>&nbsp;<span class="builtintype" id="3075205">string</span><span class="op" id="3075211">)</span>&nbsp;<span class="op" id="3075213">(</span><span class="op" id="3075214">*</span><span class="ident" id="3075215">Conn</span><span class="op" id="3075219">,</span>&nbsp;<span class="builtintype" id="3075221">error</span><span class="op" id="3075226">)</span>&nbsp;<span class="op" id="3075228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3075231">c</span><span class="op" id="3075232">,</span>&nbsp;<span class="ident" id="3075234">err</span>&nbsp;<span class="op" id="3075238">:=</span>&nbsp;<span class="ident" id="3075241">net</span><span class="op" id="3075244">.</span><span class="ident" id="3075245">Dial</span><span class="op" id="3075249">(</span><span class="ident" id="3075250">network</span><span class="op" id="3075257">,</span>&nbsp;<span class="ident" id="3075259">addr</span><span class="op" id="3075263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3075266">if</span>&nbsp;<span class="ident" id="3075269">err</span>&nbsp;<span class="op" id="3075273">!=</span>&nbsp;<span class="ident" id="3075276">nil</span>&nbsp;<span class="op" id="3075280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3075284">return</span>&nbsp;<span class="ident" id="3075291">nil</span><span class="op" id="3075294">,</span>&nbsp;<span class="ident" id="3075296">err</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3075301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3075304">return</span>&nbsp;<span class="ident" id="3075311">NewConn</span><span class="op" id="3075318">(</span><span class="ident" id="3075319">c</span><span class="op" id="3075320">)</span><span class="op" id="3075321">,</span>&nbsp;<span class="ident" id="3075323">nil</span><br>
<span class="lineno"></span><span class="op" id="3075327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3075330">//&nbsp;Cmd&nbsp;is&nbsp;a&nbsp;convenience&nbsp;method&nbsp;that&nbsp;sends&nbsp;a&nbsp;command&nbsp;after</span><br>
<span class="lineno">90</span><span class="comment" id="3075388">//&nbsp;waiting&nbsp;its&nbsp;turn&nbsp;in&nbsp;the&nbsp;pipeline.&nbsp;&nbsp;The&nbsp;command&nbsp;text&nbsp;is&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3075450">//&nbsp;result&nbsp;of&nbsp;formatting&nbsp;format&nbsp;with&nbsp;args&nbsp;and&nbsp;appending&nbsp;\r\n.</span><br>
<span class="lineno"></span><span class="comment" id="3075511">//&nbsp;Cmd&nbsp;returns&nbsp;the&nbsp;id&nbsp;of&nbsp;the&nbsp;command,&nbsp;for&nbsp;use&nbsp;with&nbsp;StartResponse&nbsp;and&nbsp;EndResponse.</span><br>
<span class="lineno"></span><span class="comment" id="3075593">//</span><br>
<span class="lineno"></span><span class="comment" id="3075596">//&nbsp;For&nbsp;example,&nbsp;a&nbsp;client&nbsp;might&nbsp;run&nbsp;a&nbsp;HELP&nbsp;command&nbsp;that&nbsp;returns&nbsp;a&nbsp;dot-body</span><br>
<span class="lineno">95</span><span class="comment" id="3075670">//&nbsp;by&nbsp;using:</span><br>
<span class="lineno"></span><span class="comment" id="3075683">//</span><br>
<span class="lineno"></span><span class="comment" id="3075686">//&nbsp;&nbsp;&nbsp;&nbspid,&nbsp;err&nbsp;:=&nbsp;c.Cmd(&#34;HELP&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="3075714">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3075733">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;nil,&nbsp;err</span><br>
<span class="lineno">100</span><span class="comment" id="3075753">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="3075758">//</span><br>
<span class="lineno"></span><span class="comment" id="3075761">//&nbsp;&nbsp;&nbsp;&nbspc.StartResponse(id)</span><br>
<span class="lineno"></span><span class="comment" id="3075784">//&nbsp;&nbsp;&nbsp;&nbspdefer&nbsp;c.EndResponse(id)</span><br>
<span class="lineno"></span><span class="comment" id="3075811">//</span><br>
<span class="lineno">105</span><span class="comment" id="3075814">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;_,&nbsp;_,&nbsp;err&nbsp;=&nbsp;c.ReadCodeLine(110);&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3075866">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;nil,&nbsp;err</span><br>
<span class="lineno"></span><span class="comment" id="3075886">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="3075891">//&nbsp;&nbsp;&nbsp;&nbsptext,&nbsp;err&nbsp;:=&nbsp;c.ReadDotBytes()</span><br>
<span class="lineno"></span><span class="comment" id="3075924">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno">110</span><span class="comment" id="3075943">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;nil,&nbsp;err</span><br>
<span class="lineno"></span><span class="comment" id="3075963">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="3075968">//&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;c.ReadCodeLine(250)</span><br>
<span class="lineno"></span><span class="comment" id="3075998">//</span><br>
<span class="lineno"></span><span class="keyword" id="3076001">func</span>&nbsp;<span class="op" id="3076006">(</span><span class="ident" id="3076007">c</span>&nbsp;<span class="op" id="3076009">*</span><span class="ident" id="3076010">Conn</span><span class="op" id="3076014">)</span>&nbsp;<span class="ident" id="3076016">Cmd</span><span class="op" id="3076019">(</span><span class="ident" id="3076020">format</span>&nbsp;<span class="builtintype" id="3076027">string</span><span class="op" id="3076033">,</span>&nbsp;<span class="ident" id="3076035">args</span>&nbsp;<span class="op" id="3076040">...</span><span class="keyword" id="3076043">interface</span><span class="op" id="3076052">{</span><span class="op" id="3076053">}</span><span class="op" id="3076054">)</span>&nbsp;<span class="op" id="3076056">(</span><span class="ident" id="3076057">id</span>&nbsp;<span class="builtintype" id="3076060">uint</span><span class="op" id="3076064">,</span>&nbsp;<span class="ident" id="3076066">err</span>&nbsp;<span class="builtintype" id="3076070">error</span><span class="op" id="3076075">)</span>&nbsp;<span class="op" id="3076077">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3076080">id</span>&nbsp;<span class="op" id="3076083">=</span>&nbsp;<span class="ident" id="3076085">c</span><span class="op" id="3076086">.</span><span class="ident" id="3076087">Next</span><span class="op" id="3076091">(</span><span class="op" id="3076092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3076095">c</span><span class="op" id="3076096">.</span><span class="ident" id="3076097">StartRequest</span><span class="op" id="3076109">(</span><span class="ident" id="3076110">id</span><span class="op" id="3076112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3076115">err</span>&nbsp;<span class="op" id="3076119">=</span>&nbsp;<span class="ident" id="3076121">c</span><span class="op" id="3076122">.</span><span class="ident" id="3076123">PrintfLine</span><span class="op" id="3076133">(</span><span class="ident" id="3076134">format</span><span class="op" id="3076140">,</span>&nbsp;<span class="ident" id="3076142">args</span><span class="op" id="3076146">...</span><span class="op" id="3076149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3076152">c</span><span class="op" id="3076153">.</span><span class="ident" id="3076154">EndRequest</span><span class="op" id="3076164">(</span><span class="ident" id="3076165">id</span><span class="op" id="3076167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3076170">if</span>&nbsp;<span class="ident" id="3076173">err</span>&nbsp;<span class="op" id="3076177">!=</span>&nbsp;<span class="ident" id="3076180">nil</span>&nbsp;<span class="op" id="3076184">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3076188">return</span>&nbsp;<span class="num" id="3076195">0</span><span class="op" id="3076196">,</span>&nbsp;<span class="ident" id="3076198">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3076203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3076206">return</span>&nbsp;<span class="ident" id="3076213">id</span><span class="op" id="3076215">,</span>&nbsp;<span class="ident" id="3076217">nil</span><br>
<span class="lineno"></span><span class="op" id="3076221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="3076224">//&nbsp;TrimString&nbsp;returns&nbsp;s&nbsp;without&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="3076290">func</span>&nbsp;<span class="ident" id="3076295">TrimString</span><span class="op" id="3076305">(</span><span class="ident" id="3076306">s</span>&nbsp;<span class="builtintype" id="3076308">string</span><span class="op" id="3076314">)</span>&nbsp;<span class="builtintype" id="3076316">string</span>&nbsp;<span class="op" id="3076323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3076326">for</span>&nbsp;<span class="builtinfunc" id="3076330">len</span><span class="op" id="3076333">(</span><span class="ident" id="3076334">s</span><span class="op" id="3076335">)</span>&nbsp;<span class="op" id="3076337">&gt;</span>&nbsp;<span class="num" id="3076339">0</span>&nbsp;<span class="op" id="3076341">&amp;&amp;</span>&nbsp;<span class="ident" id="3076344">isASCIISpace</span><span class="op" id="3076356">(</span><span class="ident" id="3076357">s</span><span class="op" id="3076358">[</span><span class="num" id="3076359">0</span><span class="op" id="3076360">]</span><span class="op" id="3076361">)</span>&nbsp;<span class="op" id="3076363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3076367">s</span>&nbsp;<span class="op" id="3076369">=</span>&nbsp;<span class="ident" id="3076371">s</span><span class="op" id="3076372">[</span><span class="num" id="3076373">1</span><span class="op" id="3076374">:</span><span class="op" id="3076375">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3076378">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3076381">for</span>&nbsp;<span class="builtinfunc" id="3076385">len</span><span class="op" id="3076388">(</span><span class="ident" id="3076389">s</span><span class="op" id="3076390">)</span>&nbsp;<span class="op" id="3076392">&gt;</span>&nbsp;<span class="num" id="3076394">0</span>&nbsp;<span class="op" id="3076396">&amp;&amp;</span>&nbsp;<span class="ident" id="3076399">isASCIISpace</span><span class="op" id="3076411">(</span><span class="ident" id="3076412">s</span><span class="op" id="3076413">[</span><span class="builtinfunc" id="3076414">len</span><span class="op" id="3076417">(</span><span class="ident" id="3076418">s</span><span class="op" id="3076419">)</span><span class="op" id="3076420">-</span><span class="num" id="3076421">1</span><span class="op" id="3076422">]</span><span class="op" id="3076423">)</span>&nbsp;<span class="op" id="3076425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3076429">s</span>&nbsp;<span class="op" id="3076431">=</span>&nbsp;<span class="ident" id="3076433">s</span><span class="op" id="3076434">[</span><span class="op" id="3076435">:</span><span class="builtinfunc" id="3076436">len</span><span class="op" id="3076439">(</span><span class="ident" id="3076440">s</span><span class="op" id="3076441">)</span><span class="op" id="3076442">-</span><span class="num" id="3076443">1</span><span class="op" id="3076444">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3076447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3076450">return</span>&nbsp;<span class="ident" id="3076457">s</span><br>
<span class="lineno"></span><span class="op" id="3076459">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="3076462">//&nbsp;TrimBytes&nbsp;returns&nbsp;b&nbsp;without&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="3076527">func</span>&nbsp;<span class="ident" id="3076532">TrimBytes</span><span class="op" id="3076541">(</span><span class="ident" id="3076542">b</span>&nbsp;<span class="op" id="3076544">[</span><span class="op" id="3076545">]</span><span class="builtintype" id="3076546">byte</span><span class="op" id="3076550">)</span>&nbsp;<span class="op" id="3076552">[</span><span class="op" id="3076553">]</span><span class="builtintype" id="3076554">byte</span>&nbsp;<span class="op" id="3076559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3076562">for</span>&nbsp;<span class="builtinfunc" id="3076566">len</span><span class="op" id="3076569">(</span><span class="ident" id="3076570">b</span><span class="op" id="3076571">)</span>&nbsp;<span class="op" id="3076573">&gt;</span>&nbsp;<span class="num" id="3076575">0</span>&nbsp;<span class="op" id="3076577">&amp;&amp;</span>&nbsp;<span class="ident" id="3076580">isASCIISpace</span><span class="op" id="3076592">(</span><span class="ident" id="3076593">b</span><span class="op" id="3076594">[</span><span class="num" id="3076595">0</span><span class="op" id="3076596">]</span><span class="op" id="3076597">)</span>&nbsp;<span class="op" id="3076599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3076603">b</span>&nbsp;<span class="op" id="3076605">=</span>&nbsp;<span class="ident" id="3076607">b</span><span class="op" id="3076608">[</span><span class="num" id="3076609">1</span><span class="op" id="3076610">:</span><span class="op" id="3076611">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3076614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3076617">for</span>&nbsp;<span class="builtinfunc" id="3076621">len</span><span class="op" id="3076624">(</span><span class="ident" id="3076625">b</span><span class="op" id="3076626">)</span>&nbsp;<span class="op" id="3076628">&gt;</span>&nbsp;<span class="num" id="3076630">0</span>&nbsp;<span class="op" id="3076632">&amp;&amp;</span>&nbsp;<span class="ident" id="3076635">isASCIISpace</span><span class="op" id="3076647">(</span><span class="ident" id="3076648">b</span><span class="op" id="3076649">[</span><span class="builtinfunc" id="3076650">len</span><span class="op" id="3076653">(</span><span class="ident" id="3076654">b</span><span class="op" id="3076655">)</span><span class="op" id="3076656">-</span><span class="num" id="3076657">1</span><span class="op" id="3076658">]</span><span class="op" id="3076659">)</span>&nbsp;<span class="op" id="3076661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3076665">b</span>&nbsp;<span class="op" id="3076667">=</span>&nbsp;<span class="ident" id="3076669">b</span><span class="op" id="3076670">[</span><span class="op" id="3076671">:</span><span class="builtinfunc" id="3076672">len</span><span class="op" id="3076675">(</span><span class="ident" id="3076676">b</span><span class="op" id="3076677">)</span><span class="op" id="3076678">-</span><span class="num" id="3076679">1</span><span class="op" id="3076680">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3076683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3076686">return</span>&nbsp;<span class="ident" id="3076693">b</span><br>
<span class="lineno">145</span><span class="op" id="3076695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3076698">func</span>&nbsp;<span class="ident" id="3076703">isASCIISpace</span><span class="op" id="3076715">(</span><span class="ident" id="3076716">b</span>&nbsp;<span class="builtintype" id="3076718">byte</span><span class="op" id="3076722">)</span>&nbsp;<span class="builtintype" id="3076724">bool</span>&nbsp;<span class="op" id="3076729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3076732">return</span>&nbsp;<span class="ident" id="3076739">b</span>&nbsp;<span class="op" id="3076741">==</span>&nbsp;<span class="string" id="3076744">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3076748">||</span>&nbsp;<span class="ident" id="3076751">b</span>&nbsp;<span class="op" id="3076753">==</span>&nbsp;<span class="string" id="3076756">&#39;\t&#39;</span>&nbsp;<span class="op" id="3076761">||</span>&nbsp;<span class="ident" id="3076764">b</span>&nbsp;<span class="op" id="3076766">==</span>&nbsp;<span class="string" id="3076769">&#39;\n&#39;</span>&nbsp;<span class="op" id="3076774">||</span>&nbsp;<span class="ident" id="3076777">b</span>&nbsp;<span class="op" id="3076779">==</span>&nbsp;<span class="string" id="3076782">&#39;\r&#39;</span><br>
<span class="lineno"></span><span class="op" id="3076787">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="3076790">func</span>&nbsp;<span class="ident" id="3076795">isASCIILetter</span><span class="op" id="3076808">(</span><span class="ident" id="3076809">b</span>&nbsp;<span class="builtintype" id="3076811">byte</span><span class="op" id="3076815">)</span>&nbsp;<span class="builtintype" id="3076817">bool</span>&nbsp;<span class="op" id="3076822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3076825">b</span>&nbsp;<span class="op" id="3076827">|=</span>&nbsp;<span class="num" id="3076830">0x20</span>&nbsp;<span class="comment" id="3076835">//&nbsp;make&nbsp;lower&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3076855">return</span>&nbsp;<span class="string" id="3076862">&#39;a&#39;</span>&nbsp;<span class="op" id="3076866">&lt;=</span>&nbsp;<span class="ident" id="3076869">b</span>&nbsp;<span class="op" id="3076871">&amp;&amp;</span>&nbsp;<span class="ident" id="3076874">b</span>&nbsp;<span class="op" id="3076876">&lt;=</span>&nbsp;<span class="string" id="3076879">&#39;z&#39;</span><br>
<span class="lineno"></span><span class="op" id="3076883">}</span>
</div>
</body>
</html>
