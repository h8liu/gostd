<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2240094">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2240149">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2240203">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2240254">//&nbsp;Multiprecision&nbsp;decimal&nbsp;numbers.</span><br>
<span class="lineno"></span><span class="comment" id="2240289">//&nbsp;For&nbsp;floating-point&nbsp;formatting&nbsp;only;&nbsp;not&nbsp;general&nbsp;purpose.</span><br>
<span class="lineno"></span><span class="comment" id="2240349">//&nbsp;Only&nbsp;operations&nbsp;are&nbsp;assign&nbsp;and&nbsp;(binary)&nbsp;left/right&nbsp;shift.</span><br>
<span class="lineno"></span><span class="comment" id="2240410">//&nbsp;Can&nbsp;do&nbsp;binary&nbsp;floating&nbsp;point&nbsp;in&nbsp;multiprecision&nbsp;decimal&nbsp;precisely</span><br>
<span class="lineno"></span><span class="comment" id="2240478">//&nbsp;because&nbsp;2&nbsp;divides&nbsp;10;&nbsp;cannot&nbsp;do&nbsp;decimal&nbsp;floating&nbsp;point</span><br>
<span class="lineno">10</span><span class="comment" id="2240536">//&nbsp;in&nbsp;multiprecision&nbsp;binary&nbsp;precisely.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2240576">package</span>&nbsp;<span class="ident" id="2240584">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2240593">type</span>&nbsp;<span class="ident" id="2240598">decimal</span>&nbsp;<span class="keyword" id="2240606">struct</span>&nbsp;<span class="op" id="2240613">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240616">d</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240622">[</span><span class="num" id="2240623">800</span><span class="op" id="2240626">]</span><span class="builtintype" id="2240627">byte</span>&nbsp;<span class="comment" id="2240632">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240643">nd</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2240649">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2240659">//&nbsp;number&nbsp;of&nbsp;digits&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240685">dp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2240691">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2240701">//&nbsp;decimal&nbsp;point</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240719">neg</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2240725">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240731">trunc</span>&nbsp;<span class="builtintype" id="2240737">bool</span>&nbsp;<span class="comment" id="2240742">//&nbsp;discarded&nbsp;nonzero&nbsp;digits&nbsp;beyond&nbsp;d[:nd]</span><br>
<span class="lineno">20</span><span class="op" id="2240784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2240787">func</span>&nbsp;<span class="op" id="2240792">(</span><span class="ident" id="2240793">a</span>&nbsp;<span class="op" id="2240795">*</span><span class="ident" id="2240796">decimal</span><span class="op" id="2240803">)</span>&nbsp;<span class="ident" id="2240805">String</span><span class="op" id="2240811">(</span><span class="op" id="2240812">)</span>&nbsp;<span class="builtintype" id="2240814">string</span>&nbsp;<span class="op" id="2240821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240824">n</span>&nbsp;<span class="op" id="2240826">:=</span>&nbsp;<span class="num" id="2240829">10</span>&nbsp;<span class="op" id="2240832">+</span>&nbsp;<span class="ident" id="2240834">a</span><span class="op" id="2240835">.</span><span class="ident" id="2240836">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240840">if</span>&nbsp;<span class="ident" id="2240843">a</span><span class="op" id="2240844">.</span><span class="ident" id="2240845">dp</span>&nbsp;<span class="op" id="2240848">&gt;</span>&nbsp;<span class="num" id="2240850">0</span>&nbsp;<span class="op" id="2240852">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240856">n</span>&nbsp;<span class="op" id="2240858">+=</span>&nbsp;<span class="ident" id="2240861">a</span><span class="op" id="2240862">.</span><span class="ident" id="2240863">dp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2240867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240870">if</span>&nbsp;<span class="ident" id="2240873">a</span><span class="op" id="2240874">.</span><span class="ident" id="2240875">dp</span>&nbsp;<span class="op" id="2240878">&lt;</span>&nbsp;<span class="num" id="2240880">0</span>&nbsp;<span class="op" id="2240882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240886">n</span>&nbsp;<span class="op" id="2240888">+=</span>&nbsp;<span class="op" id="2240891">-</span><span class="ident" id="2240892">a</span><span class="op" id="2240893">.</span><span class="ident" id="2240894">dp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2240898">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240902">buf</span>&nbsp;<span class="op" id="2240906">:=</span>&nbsp;<span class="builtinfunc" id="2240909">make</span><span class="op" id="2240913">(</span><span class="op" id="2240914">[</span><span class="op" id="2240915">]</span><span class="builtintype" id="2240916">byte</span><span class="op" id="2240920">,</span>&nbsp;<span class="ident" id="2240922">n</span><span class="op" id="2240923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240926">w</span>&nbsp;<span class="op" id="2240928">:=</span>&nbsp;<span class="num" id="2240931">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240934">switch</span>&nbsp;<span class="op" id="2240941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240944">case</span>&nbsp;<span class="ident" id="2240949">a</span><span class="op" id="2240950">.</span><span class="ident" id="2240951">nd</span>&nbsp;<span class="op" id="2240954">==</span>&nbsp;<span class="num" id="2240957">0</span><span class="op" id="2240958">:</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240962">return</span>&nbsp;<span class="string" id="2240969">&#34;0&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240975">case</span>&nbsp;<span class="ident" id="2240980">a</span><span class="op" id="2240981">.</span><span class="ident" id="2240982">dp</span>&nbsp;<span class="op" id="2240985">&lt;=</span>&nbsp;<span class="num" id="2240988">0</span><span class="op" id="2240989">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2240993">//&nbsp;zeros&nbsp;fill&nbsp;space&nbsp;between&nbsp;decimal&nbsp;point&nbsp;and&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241048">buf</span><span class="op" id="2241051">[</span><span class="ident" id="2241052">w</span><span class="op" id="2241053">]</span>&nbsp;<span class="op" id="2241055">=</span>&nbsp;<span class="string" id="2241057">&#39;0&#39;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241063">w</span><span class="op" id="2241064">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241069">buf</span><span class="op" id="2241072">[</span><span class="ident" id="2241073">w</span><span class="op" id="2241074">]</span>&nbsp;<span class="op" id="2241076">=</span>&nbsp;<span class="string" id="2241078">&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241084">w</span><span class="op" id="2241085">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241090">w</span>&nbsp;<span class="op" id="2241092">+=</span>&nbsp;<span class="ident" id="2241095">digitZero</span><span class="op" id="2241104">(</span><span class="ident" id="2241105">buf</span><span class="op" id="2241108">[</span><span class="ident" id="2241109">w</span>&nbsp;<span class="op" id="2241111">:</span>&nbsp;<span class="ident" id="2241113">w</span><span class="op" id="2241114">+</span><span class="op" id="2241115">-</span><span class="ident" id="2241116">a</span><span class="op" id="2241117">.</span><span class="ident" id="2241118">dp</span><span class="op" id="2241120">]</span><span class="op" id="2241121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241125">w</span>&nbsp;<span class="op" id="2241127">+=</span>&nbsp;<span class="builtinfunc" id="2241130">copy</span><span class="op" id="2241134">(</span><span class="ident" id="2241135">buf</span><span class="op" id="2241138">[</span><span class="ident" id="2241139">w</span><span class="op" id="2241140">:</span><span class="op" id="2241141">]</span><span class="op" id="2241142">,</span>&nbsp;<span class="ident" id="2241144">a</span><span class="op" id="2241145">.</span><span class="ident" id="2241146">d</span><span class="op" id="2241147">[</span><span class="num" id="2241148">0</span><span class="op" id="2241149">:</span><span class="ident" id="2241150">a</span><span class="op" id="2241151">.</span><span class="ident" id="2241152">nd</span><span class="op" id="2241154">]</span><span class="op" id="2241155">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241159">case</span>&nbsp;<span class="ident" id="2241164">a</span><span class="op" id="2241165">.</span><span class="ident" id="2241166">dp</span>&nbsp;<span class="op" id="2241169">&lt;</span>&nbsp;<span class="ident" id="2241171">a</span><span class="op" id="2241172">.</span><span class="ident" id="2241173">nd</span><span class="op" id="2241175">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2241179">//&nbsp;decimal&nbsp;point&nbsp;in&nbsp;middle&nbsp;of&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241218">w</span>&nbsp;<span class="op" id="2241220">+=</span>&nbsp;<span class="builtinfunc" id="2241223">copy</span><span class="op" id="2241227">(</span><span class="ident" id="2241228">buf</span><span class="op" id="2241231">[</span><span class="ident" id="2241232">w</span><span class="op" id="2241233">:</span><span class="op" id="2241234">]</span><span class="op" id="2241235">,</span>&nbsp;<span class="ident" id="2241237">a</span><span class="op" id="2241238">.</span><span class="ident" id="2241239">d</span><span class="op" id="2241240">[</span><span class="num" id="2241241">0</span><span class="op" id="2241242">:</span><span class="ident" id="2241243">a</span><span class="op" id="2241244">.</span><span class="ident" id="2241245">dp</span><span class="op" id="2241247">]</span><span class="op" id="2241248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241252">buf</span><span class="op" id="2241255">[</span><span class="ident" id="2241256">w</span><span class="op" id="2241257">]</span>&nbsp;<span class="op" id="2241259">=</span>&nbsp;<span class="string" id="2241261">&#39;.&#39;</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241267">w</span><span class="op" id="2241268">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241273">w</span>&nbsp;<span class="op" id="2241275">+=</span>&nbsp;<span class="builtinfunc" id="2241278">copy</span><span class="op" id="2241282">(</span><span class="ident" id="2241283">buf</span><span class="op" id="2241286">[</span><span class="ident" id="2241287">w</span><span class="op" id="2241288">:</span><span class="op" id="2241289">]</span><span class="op" id="2241290">,</span>&nbsp;<span class="ident" id="2241292">a</span><span class="op" id="2241293">.</span><span class="ident" id="2241294">d</span><span class="op" id="2241295">[</span><span class="ident" id="2241296">a</span><span class="op" id="2241297">.</span><span class="ident" id="2241298">dp</span><span class="op" id="2241300">:</span><span class="ident" id="2241301">a</span><span class="op" id="2241302">.</span><span class="ident" id="2241303">nd</span><span class="op" id="2241305">]</span><span class="op" id="2241306">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241310">default</span><span class="op" id="2241317">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2241321">//&nbsp;zeros&nbsp;fill&nbsp;space&nbsp;between&nbsp;digits&nbsp;and&nbsp;decimal&nbsp;point</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241376">w</span>&nbsp;<span class="op" id="2241378">+=</span>&nbsp;<span class="builtinfunc" id="2241381">copy</span><span class="op" id="2241385">(</span><span class="ident" id="2241386">buf</span><span class="op" id="2241389">[</span><span class="ident" id="2241390">w</span><span class="op" id="2241391">:</span><span class="op" id="2241392">]</span><span class="op" id="2241393">,</span>&nbsp;<span class="ident" id="2241395">a</span><span class="op" id="2241396">.</span><span class="ident" id="2241397">d</span><span class="op" id="2241398">[</span><span class="num" id="2241399">0</span><span class="op" id="2241400">:</span><span class="ident" id="2241401">a</span><span class="op" id="2241402">.</span><span class="ident" id="2241403">nd</span><span class="op" id="2241405">]</span><span class="op" id="2241406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241410">w</span>&nbsp;<span class="op" id="2241412">+=</span>&nbsp;<span class="ident" id="2241415">digitZero</span><span class="op" id="2241424">(</span><span class="ident" id="2241425">buf</span><span class="op" id="2241428">[</span><span class="ident" id="2241429">w</span>&nbsp;<span class="op" id="2241431">:</span>&nbsp;<span class="ident" id="2241433">w</span><span class="op" id="2241434">+</span><span class="ident" id="2241435">a</span><span class="op" id="2241436">.</span><span class="ident" id="2241437">dp</span><span class="op" id="2241439">-</span><span class="ident" id="2241440">a</span><span class="op" id="2241441">.</span><span class="ident" id="2241442">nd</span><span class="op" id="2241444">]</span><span class="op" id="2241445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241451">return</span>&nbsp;<span class="builtintype" id="2241458">string</span><span class="op" id="2241464">(</span><span class="ident" id="2241465">buf</span><span class="op" id="2241468">[</span><span class="num" id="2241469">0</span><span class="op" id="2241470">:</span><span class="ident" id="2241471">w</span><span class="op" id="2241472">]</span><span class="op" id="2241473">)</span><br>
<span class="lineno"></span><span class="op" id="2241475">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="2241478">func</span>&nbsp;<span class="ident" id="2241483">digitZero</span><span class="op" id="2241492">(</span><span class="ident" id="2241493">dst</span>&nbsp;<span class="op" id="2241497">[</span><span class="op" id="2241498">]</span><span class="builtintype" id="2241499">byte</span><span class="op" id="2241503">)</span>&nbsp;<span class="builtintype" id="2241505">int</span>&nbsp;<span class="op" id="2241509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241512">for</span>&nbsp;<span class="ident" id="2241516">i</span>&nbsp;<span class="op" id="2241518">:=</span>&nbsp;<span class="keyword" id="2241521">range</span>&nbsp;<span class="ident" id="2241527">dst</span>&nbsp;<span class="op" id="2241531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241535">dst</span><span class="op" id="2241538">[</span><span class="ident" id="2241539">i</span><span class="op" id="2241540">]</span>&nbsp;<span class="op" id="2241542">=</span>&nbsp;<span class="string" id="2241544">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241549">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241552">return</span>&nbsp;<span class="builtinfunc" id="2241559">len</span><span class="op" id="2241562">(</span><span class="ident" id="2241563">dst</span><span class="op" id="2241566">)</span><br>
<span class="lineno"></span><span class="op" id="2241568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2241571">//&nbsp;trim&nbsp;trailing&nbsp;zeros&nbsp;from&nbsp;number.</span><br>
<span class="lineno"></span><span class="comment" id="2241607">//&nbsp;(They&nbsp;are&nbsp;meaningless;&nbsp;the&nbsp;decimal&nbsp;point&nbsp;is&nbsp;tracked</span><br>
<span class="lineno">70</span><span class="comment" id="2241662">//&nbsp;independent&nbsp;of&nbsp;the&nbsp;number&nbsp;of&nbsp;digits.)</span><br>
<span class="lineno"></span><span class="keyword" id="2241703">func</span>&nbsp;<span class="ident" id="2241708">trim</span><span class="op" id="2241712">(</span><span class="ident" id="2241713">a</span>&nbsp;<span class="op" id="2241715">*</span><span class="ident" id="2241716">decimal</span><span class="op" id="2241723">)</span>&nbsp;<span class="op" id="2241725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241728">for</span>&nbsp;<span class="ident" id="2241732">a</span><span class="op" id="2241733">.</span><span class="ident" id="2241734">nd</span>&nbsp;<span class="op" id="2241737">&gt;</span>&nbsp;<span class="num" id="2241739">0</span>&nbsp;<span class="op" id="2241741">&amp;&amp;</span>&nbsp;<span class="ident" id="2241744">a</span><span class="op" id="2241745">.</span><span class="ident" id="2241746">d</span><span class="op" id="2241747">[</span><span class="ident" id="2241748">a</span><span class="op" id="2241749">.</span><span class="ident" id="2241750">nd</span><span class="op" id="2241752">-</span><span class="num" id="2241753">1</span><span class="op" id="2241754">]</span>&nbsp;<span class="op" id="2241756">==</span>&nbsp;<span class="string" id="2241759">&#39;0&#39;</span>&nbsp;<span class="op" id="2241763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241767">a</span><span class="op" id="2241768">.</span><span class="ident" id="2241769">nd</span><span class="op" id="2241771">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241775">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241778">if</span>&nbsp;<span class="ident" id="2241781">a</span><span class="op" id="2241782">.</span><span class="ident" id="2241783">nd</span>&nbsp;<span class="op" id="2241786">==</span>&nbsp;<span class="num" id="2241789">0</span>&nbsp;<span class="op" id="2241791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241795">a</span><span class="op" id="2241796">.</span><span class="ident" id="2241797">dp</span>&nbsp;<span class="op" id="2241800">=</span>&nbsp;<span class="num" id="2241802">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241805">}</span><br>
<span class="lineno"></span><span class="op" id="2241807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="2241810">//&nbsp;Assign&nbsp;v&nbsp;to&nbsp;a.</span><br>
<span class="lineno"></span><span class="keyword" id="2241828">func</span>&nbsp;<span class="op" id="2241833">(</span><span class="ident" id="2241834">a</span>&nbsp;<span class="op" id="2241836">*</span><span class="ident" id="2241837">decimal</span><span class="op" id="2241844">)</span>&nbsp;<span class="ident" id="2241846">Assign</span><span class="op" id="2241852">(</span><span class="ident" id="2241853">v</span>&nbsp;<span class="ident" id="2241855">uint64</span><span class="op" id="2241861">)</span>&nbsp;<span class="op" id="2241863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241866">var</span>&nbsp;<span class="ident" id="2241870">buf</span>&nbsp;<span class="op" id="2241874">[</span><span class="num" id="2241875">24</span><span class="op" id="2241877">]</span><span class="builtintype" id="2241878">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2241885">//&nbsp;Write&nbsp;reversed&nbsp;decimal&nbsp;in&nbsp;buf.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241920">n</span>&nbsp;<span class="op" id="2241922">:=</span>&nbsp;<span class="num" id="2241925">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241928">for</span>&nbsp;<span class="ident" id="2241932">v</span>&nbsp;<span class="op" id="2241934">&gt;</span>&nbsp;<span class="num" id="2241936">0</span>&nbsp;<span class="op" id="2241938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241942">v1</span>&nbsp;<span class="op" id="2241945">:=</span>&nbsp;<span class="ident" id="2241948">v</span>&nbsp;<span class="op" id="2241950">/</span>&nbsp;<span class="num" id="2241952">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241957">v</span>&nbsp;<span class="op" id="2241959">-=</span>&nbsp;<span class="num" id="2241962">10</span>&nbsp;<span class="op" id="2241965">*</span>&nbsp;<span class="ident" id="2241967">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241972">buf</span><span class="op" id="2241975">[</span><span class="ident" id="2241976">n</span><span class="op" id="2241977">]</span>&nbsp;<span class="op" id="2241979">=</span>&nbsp;<span class="builtintype" id="2241981">byte</span><span class="op" id="2241985">(</span><span class="ident" id="2241986">v</span>&nbsp;<span class="op" id="2241988">+</span>&nbsp;<span class="string" id="2241990">&#39;0&#39;</span><span class="op" id="2241993">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241997">n</span><span class="op" id="2241998">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242003">v</span>&nbsp;<span class="op" id="2242005">=</span>&nbsp;<span class="ident" id="2242007">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2242011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2242015">//&nbsp;Reverse&nbsp;again&nbsp;to&nbsp;produce&nbsp;forward&nbsp;decimal&nbsp;in&nbsp;a.d.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242068">a</span><span class="op" id="2242069">.</span><span class="ident" id="2242070">nd</span>&nbsp;<span class="op" id="2242073">=</span>&nbsp;<span class="num" id="2242075">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2242078">for</span>&nbsp;<span class="ident" id="2242082">n</span><span class="op" id="2242083">--</span><span class="op" id="2242085">;</span>&nbsp;<span class="ident" id="2242087">n</span>&nbsp;<span class="op" id="2242089">&gt;=</span>&nbsp;<span class="num" id="2242092">0</span><span class="op" id="2242093">;</span>&nbsp;<span class="ident" id="2242095">n</span><span class="op" id="2242096">--</span>&nbsp;<span class="op" id="2242099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242103">a</span><span class="op" id="2242104">.</span><span class="ident" id="2242105">d</span><span class="op" id="2242106">[</span><span class="ident" id="2242107">a</span><span class="op" id="2242108">.</span><span class="ident" id="2242109">nd</span><span class="op" id="2242111">]</span>&nbsp;<span class="op" id="2242113">=</span>&nbsp;<span class="ident" id="2242115">buf</span><span class="op" id="2242118">[</span><span class="ident" id="2242119">n</span><span class="op" id="2242120">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242124">a</span><span class="op" id="2242125">.</span><span class="ident" id="2242126">nd</span><span class="op" id="2242128">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2242132">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242135">a</span><span class="op" id="2242136">.</span><span class="ident" id="2242137">dp</span>&nbsp;<span class="op" id="2242140">=</span>&nbsp;<span class="ident" id="2242142">a</span><span class="op" id="2242143">.</span><span class="ident" id="2242144">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242148">trim</span><span class="op" id="2242152">(</span><span class="ident" id="2242153">a</span><span class="op" id="2242154">)</span><br>
<span class="lineno"></span><span class="op" id="2242156">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2242159">//&nbsp;Maximum&nbsp;shift&nbsp;that&nbsp;we&nbsp;can&nbsp;do&nbsp;in&nbsp;one&nbsp;pass&nbsp;without&nbsp;overflow.</span><br>
<span class="lineno">105</span><span class="comment" id="2242221">//&nbsp;Signed&nbsp;int&nbsp;has&nbsp;31&nbsp;bits,&nbsp;and&nbsp;we&nbsp;have&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;accommodate&nbsp;9&lt;&lt;k.</span><br>
<span class="lineno"></span><span class="keyword" id="2242292">const</span>&nbsp;<span class="ident" id="2242298">maxShift</span>&nbsp;<span class="op" id="2242307">=</span>&nbsp;<span class="num" id="2242309">27</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2242313">//&nbsp;Binary&nbsp;shift&nbsp;right&nbsp;(*&nbsp;2)&nbsp;by&nbsp;k&nbsp;bits.&nbsp;&nbsp;k&nbsp;&lt;=&nbsp;maxShift&nbsp;to&nbsp;avoid&nbsp;overflow.</span><br>
<span class="lineno"></span><span class="keyword" id="2242386">func</span>&nbsp;<span class="ident" id="2242391">rightShift</span><span class="op" id="2242401">(</span><span class="ident" id="2242402">a</span>&nbsp;<span class="op" id="2242404">*</span><span class="ident" id="2242405">decimal</span><span class="op" id="2242412">,</span>&nbsp;<span class="ident" id="2242414">k</span>&nbsp;<span class="builtintype" id="2242416">uint</span><span class="op" id="2242420">)</span>&nbsp;<span class="op" id="2242422">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242425">r</span>&nbsp;<span class="op" id="2242427">:=</span>&nbsp;<span class="num" id="2242430">0</span>&nbsp;<span class="comment" id="2242432">//&nbsp;read&nbsp;pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242449">w</span>&nbsp;<span class="op" id="2242451">:=</span>&nbsp;<span class="num" id="2242454">0</span>&nbsp;<span class="comment" id="2242456">//&nbsp;write&nbsp;pointer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2242475">//&nbsp;Pick&nbsp;up&nbsp;enough&nbsp;leading&nbsp;digits&nbsp;to&nbsp;cover&nbsp;first&nbsp;shift.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242531">n</span>&nbsp;<span class="op" id="2242533">:=</span>&nbsp;<span class="num" id="2242536">0</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2242539">for</span>&nbsp;<span class="op" id="2242543">;</span>&nbsp;<span class="ident" id="2242545">n</span><span class="op" id="2242546">&gt;&gt;</span><span class="ident" id="2242548">k</span>&nbsp;<span class="op" id="2242550">==</span>&nbsp;<span class="num" id="2242553">0</span><span class="op" id="2242554">;</span>&nbsp;<span class="ident" id="2242556">r</span><span class="op" id="2242557">++</span>&nbsp;<span class="op" id="2242560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2242564">if</span>&nbsp;<span class="ident" id="2242567">r</span>&nbsp;<span class="op" id="2242569">&gt;=</span>&nbsp;<span class="ident" id="2242572">a</span><span class="op" id="2242573">.</span><span class="ident" id="2242574">nd</span>&nbsp;<span class="op" id="2242577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2242582">if</span>&nbsp;<span class="ident" id="2242585">n</span>&nbsp;<span class="op" id="2242587">==</span>&nbsp;<span class="num" id="2242590">0</span>&nbsp;<span class="op" id="2242592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2242598">//&nbsp;a&nbsp;==&nbsp;0;&nbsp;shouldn&#39;t&nbsp;get&nbsp;here,&nbsp;but&nbsp;handle&nbsp;anyway.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242652">a</span><span class="op" id="2242653">.</span><span class="ident" id="2242654">nd</span>&nbsp;<span class="op" id="2242657">=</span>&nbsp;<span class="num" id="2242659">0</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2242665">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2242675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2242680">for</span>&nbsp;<span class="ident" id="2242684">n</span><span class="op" id="2242685">&gt;&gt;</span><span class="ident" id="2242687">k</span>&nbsp;<span class="op" id="2242689">==</span>&nbsp;<span class="num" id="2242692">0</span>&nbsp;<span class="op" id="2242694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242700">n</span>&nbsp;<span class="op" id="2242702">=</span>&nbsp;<span class="ident" id="2242704">n</span>&nbsp;<span class="op" id="2242706">*</span>&nbsp;<span class="num" id="2242708">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242715">r</span><span class="op" id="2242716">++</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2242722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2242727">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2242735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242739">c</span>&nbsp;<span class="op" id="2242741">:=</span>&nbsp;<span class="builtintype" id="2242744">int</span><span class="op" id="2242747">(</span><span class="ident" id="2242748">a</span><span class="op" id="2242749">.</span><span class="ident" id="2242750">d</span><span class="op" id="2242751">[</span><span class="ident" id="2242752">r</span><span class="op" id="2242753">]</span><span class="op" id="2242754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242758">n</span>&nbsp;<span class="op" id="2242760">=</span>&nbsp;<span class="ident" id="2242762">n</span><span class="op" id="2242763">*</span><span class="num" id="2242764">10</span>&nbsp;<span class="op" id="2242767">+</span>&nbsp;<span class="ident" id="2242769">c</span>&nbsp;<span class="op" id="2242771">-</span>&nbsp;<span class="string" id="2242773">&#39;0&#39;</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2242778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242781">a</span><span class="op" id="2242782">.</span><span class="ident" id="2242783">dp</span>&nbsp;<span class="op" id="2242786">-=</span>&nbsp;<span class="ident" id="2242789">r</span>&nbsp;<span class="op" id="2242791">-</span>&nbsp;<span class="num" id="2242793">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2242797">//&nbsp;Pick&nbsp;up&nbsp;a&nbsp;digit,&nbsp;put&nbsp;down&nbsp;a&nbsp;digit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2242836">for</span>&nbsp;<span class="op" id="2242840">;</span>&nbsp;<span class="ident" id="2242842">r</span>&nbsp;<span class="op" id="2242844">&lt;</span>&nbsp;<span class="ident" id="2242846">a</span><span class="op" id="2242847">.</span><span class="ident" id="2242848">nd</span><span class="op" id="2242850">;</span>&nbsp;<span class="ident" id="2242852">r</span><span class="op" id="2242853">++</span>&nbsp;<span class="op" id="2242856">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242860">c</span>&nbsp;<span class="op" id="2242862">:=</span>&nbsp;<span class="builtintype" id="2242865">int</span><span class="op" id="2242868">(</span><span class="ident" id="2242869">a</span><span class="op" id="2242870">.</span><span class="ident" id="2242871">d</span><span class="op" id="2242872">[</span><span class="ident" id="2242873">r</span><span class="op" id="2242874">]</span><span class="op" id="2242875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242879">dig</span>&nbsp;<span class="op" id="2242883">:=</span>&nbsp;<span class="ident" id="2242886">n</span>&nbsp;<span class="op" id="2242888">&gt;&gt;</span>&nbsp;<span class="ident" id="2242891">k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242895">n</span>&nbsp;<span class="op" id="2242897">-=</span>&nbsp;<span class="ident" id="2242900">dig</span>&nbsp;<span class="op" id="2242904">&lt;&lt;</span>&nbsp;<span class="ident" id="2242907">k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242911">a</span><span class="op" id="2242912">.</span><span class="ident" id="2242913">d</span><span class="op" id="2242914">[</span><span class="ident" id="2242915">w</span><span class="op" id="2242916">]</span>&nbsp;<span class="op" id="2242918">=</span>&nbsp;<span class="builtintype" id="2242920">byte</span><span class="op" id="2242924">(</span><span class="ident" id="2242925">dig</span>&nbsp;<span class="op" id="2242929">+</span>&nbsp;<span class="string" id="2242931">&#39;0&#39;</span><span class="op" id="2242934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242938">w</span><span class="op" id="2242939">++</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242944">n</span>&nbsp;<span class="op" id="2242946">=</span>&nbsp;<span class="ident" id="2242948">n</span><span class="op" id="2242949">*</span><span class="num" id="2242950">10</span>&nbsp;<span class="op" id="2242953">+</span>&nbsp;<span class="ident" id="2242955">c</span>&nbsp;<span class="op" id="2242957">-</span>&nbsp;<span class="string" id="2242959">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2242964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2242968">//&nbsp;Put&nbsp;down&nbsp;extra&nbsp;digits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2242995">for</span>&nbsp;<span class="ident" id="2242999">n</span>&nbsp;<span class="op" id="2243001">&gt;</span>&nbsp;<span class="num" id="2243003">0</span>&nbsp;<span class="op" id="2243005">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2243009">dig</span>&nbsp;<span class="op" id="2243013">:=</span>&nbsp;<span class="ident" id="2243016">n</span>&nbsp;<span class="op" id="2243018">&gt;&gt;</span>&nbsp;<span class="ident" id="2243021">k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2243025">n</span>&nbsp;<span class="op" id="2243027">-=</span>&nbsp;<span class="ident" id="2243030">dig</span>&nbsp;<span class="op" id="2243034">&lt;&lt;</span>&nbsp;<span class="ident" id="2243037">k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2243041">if</span>&nbsp;<span class="ident" id="2243044">w</span>&nbsp;<span class="op" id="2243046">&lt;</span>&nbsp;<span class="builtinfunc" id="2243048">len</span><span class="op" id="2243051">(</span><span class="ident" id="2243052">a</span><span class="op" id="2243053">.</span><span class="ident" id="2243054">d</span><span class="op" id="2243055">)</span>&nbsp;<span class="op" id="2243057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2243062">a</span><span class="op" id="2243063">.</span><span class="ident" id="2243064">d</span><span class="op" id="2243065">[</span><span class="ident" id="2243066">w</span><span class="op" id="2243067">]</span>&nbsp;<span class="op" id="2243069">=</span>&nbsp;<span class="builtintype" id="2243071">byte</span><span class="op" id="2243075">(</span><span class="ident" id="2243076">dig</span>&nbsp;<span class="op" id="2243080">+</span>&nbsp;<span class="string" id="2243082">&#39;0&#39;</span><span class="op" id="2243085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2243090">w</span><span class="op" id="2243091">++</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2243096">}</span>&nbsp;<span class="keyword" id="2243098">else</span>&nbsp;<span class="keyword" id="2243103">if</span>&nbsp;<span class="ident" id="2243106">dig</span>&nbsp;<span class="op" id="2243110">&gt;</span>&nbsp;<span class="num" id="2243112">0</span>&nbsp;<span class="op" id="2243114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2243119">a</span><span class="op" id="2243120">.</span><span class="ident" id="2243121">trunc</span>&nbsp;<span class="op" id="2243127">=</span>&nbsp;<span class="builtintype" id="2243129">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2243136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2243140">n</span>&nbsp;<span class="op" id="2243142">=</span>&nbsp;<span class="ident" id="2243144">n</span>&nbsp;<span class="op" id="2243146">*</span>&nbsp;<span class="num" id="2243148">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2243152">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2243156">a</span><span class="op" id="2243157">.</span><span class="ident" id="2243158">nd</span>&nbsp;<span class="op" id="2243161">=</span>&nbsp;<span class="ident" id="2243163">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2243166">trim</span><span class="op" id="2243170">(</span><span class="ident" id="2243171">a</span><span class="op" id="2243172">)</span><br>
<span class="lineno"></span><span class="op" id="2243174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span><span class="comment" id="2243177">//&nbsp;Cheat&nbsp;sheet&nbsp;for&nbsp;left&nbsp;shift:&nbsp;table&nbsp;indexed&nbsp;by&nbsp;shift&nbsp;count&nbsp;giving</span><br>
<span class="lineno"></span><span class="comment" id="2243244">//&nbsp;number&nbsp;of&nbsp;new&nbsp;digits&nbsp;that&nbsp;will&nbsp;be&nbsp;introduced&nbsp;by&nbsp;that&nbsp;shift.</span><br>
<span class="lineno"></span><span class="comment" id="2243307">//</span><br>
<span class="lineno"></span><span class="comment" id="2243310">//&nbsp;For&nbsp;example,&nbsp;leftcheats[4]&nbsp;=&nbsp;{2,&nbsp;&#34;625&#34;}.&nbsp;&nbsp;That&nbsp;means&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2243371">//&nbsp;if&nbsp;we&nbsp;are&nbsp;shifting&nbsp;by&nbsp;4&nbsp;(multiplying&nbsp;by&nbsp;16),&nbsp;it&nbsp;will&nbsp;add&nbsp;2&nbsp;digits</span><br>
<span class="lineno">165</span><span class="comment" id="2243440">//&nbsp;when&nbsp;the&nbsp;string&nbsp;prefix&nbsp;is&nbsp;&#34;625&#34;&nbsp;through&nbsp;&#34;999&#34;,&nbsp;and&nbsp;one&nbsp;fewer&nbsp;digit</span><br>
<span class="lineno"></span><span class="comment" id="2243510">//&nbsp;if&nbsp;the&nbsp;string&nbsp;prefix&nbsp;is&nbsp;&#34;000&#34;&nbsp;through&nbsp;&#34;624&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2243558">//</span><br>
<span class="lineno"></span><span class="comment" id="2243561">//&nbsp;Credit&nbsp;for&nbsp;this&nbsp;trick&nbsp;goes&nbsp;to&nbsp;Ken.</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="2243600">type</span>&nbsp;<span class="ident" id="2243605">leftCheat</span>&nbsp;<span class="keyword" id="2243615">struct</span>&nbsp;<span class="op" id="2243622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2243625">delta</span>&nbsp;&nbsp;<span class="builtintype" id="2243632">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2243639">//&nbsp;number&nbsp;of&nbsp;new&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2243664">cutoff</span>&nbsp;<span class="builtintype" id="2243671">string</span>&nbsp;<span class="comment" id="2243678">//&nbsp;&nbsp;&nbsp;minus&nbsp;one&nbsp;digit&nbsp;if&nbsp;original&nbsp;&lt;&nbsp;a.</span><br>
<span class="lineno"></span><span class="op" id="2243716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="2243719">var</span>&nbsp;<span class="ident" id="2243723">leftcheats</span>&nbsp;<span class="op" id="2243734">=</span>&nbsp;<span class="op" id="2243736">[</span><span class="op" id="2243737">]</span><span class="ident" id="2243738">leftCheat</span><span class="op" id="2243747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2243750">//&nbsp;Leading&nbsp;digits&nbsp;of&nbsp;1/2^i&nbsp;=&nbsp;5^i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2243785">//&nbsp;5^23&nbsp;is&nbsp;not&nbsp;an&nbsp;exact&nbsp;64-bit&nbsp;floating&nbsp;point&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2243840">//&nbsp;so&nbsp;have&nbsp;to&nbsp;use&nbsp;bc&nbsp;for&nbsp;the&nbsp;math.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2243876">/*<br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspseq&nbsp;27&nbsp;|&nbsp;sed&nbsp;&#39;s/^/5^/&#39;&nbsp;|&nbsp;bc&nbsp;|<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspawk&nbsp;&#39;BEGIN{&nbsp;print&nbsp;&#34;\tleftCheat{&nbsp;0,&nbsp;\&#34;\&#34;&nbsp;},&#34;&nbsp;}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsplog2&nbsp;=&nbsp;log(2)/log(10)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspprintf(&#34;\tleftCheat{&nbsp;%d,&nbsp;\&#34;%s\&#34;&nbsp;},\t//&nbsp;*&nbsp;%d\n&#34;,<br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspint(log2*NR+1),&nbsp;$0,&nbsp;2**NR)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp}&#39;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244080">{</span><span class="num" id="2244081">0</span><span class="op" id="2244082">,</span>&nbsp;<span class="string" id="2244084">&#34;&#34;</span><span class="op" id="2244086">}</span><span class="op" id="2244087">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244090">{</span><span class="num" id="2244091">1</span><span class="op" id="2244092">,</span>&nbsp;<span class="string" id="2244094">&#34;5&#34;</span><span class="op" id="2244097">}</span><span class="op" id="2244098">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244118">//&nbsp;*&nbsp;2</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244126">{</span><span class="num" id="2244127">1</span><span class="op" id="2244128">,</span>&nbsp;<span class="string" id="2244130">&#34;25&#34;</span><span class="op" id="2244134">}</span><span class="op" id="2244135">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244154">//&nbsp;*&nbsp;4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244162">{</span><span class="num" id="2244163">1</span><span class="op" id="2244164">,</span>&nbsp;<span class="string" id="2244166">&#34;125&#34;</span><span class="op" id="2244171">}</span><span class="op" id="2244172">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244190">//&nbsp;*&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244198">{</span><span class="num" id="2244199">2</span><span class="op" id="2244200">,</span>&nbsp;<span class="string" id="2244202">&#34;625&#34;</span><span class="op" id="2244207">}</span><span class="op" id="2244208">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244226">//&nbsp;*&nbsp;16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244235">{</span><span class="num" id="2244236">2</span><span class="op" id="2244237">,</span>&nbsp;<span class="string" id="2244239">&#34;3125&#34;</span><span class="op" id="2244245">}</span><span class="op" id="2244246">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244263">//&nbsp;*&nbsp;32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244272">{</span><span class="num" id="2244273">2</span><span class="op" id="2244274">,</span>&nbsp;<span class="string" id="2244276">&#34;15625&#34;</span><span class="op" id="2244283">}</span><span class="op" id="2244284">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244300">//&nbsp;*&nbsp;64</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244309">{</span><span class="num" id="2244310">3</span><span class="op" id="2244311">,</span>&nbsp;<span class="string" id="2244313">&#34;78125&#34;</span><span class="op" id="2244320">}</span><span class="op" id="2244321">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244337">//&nbsp;*&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244347">{</span><span class="num" id="2244348">3</span><span class="op" id="2244349">,</span>&nbsp;<span class="string" id="2244351">&#34;390625&#34;</span><span class="op" id="2244359">}</span><span class="op" id="2244360">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244375">//&nbsp;*&nbsp;256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244385">{</span><span class="num" id="2244386">3</span><span class="op" id="2244387">,</span>&nbsp;<span class="string" id="2244389">&#34;1953125&#34;</span><span class="op" id="2244398">}</span><span class="op" id="2244399">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244413">//&nbsp;*&nbsp;512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244423">{</span><span class="num" id="2244424">4</span><span class="op" id="2244425">,</span>&nbsp;<span class="string" id="2244427">&#34;9765625&#34;</span><span class="op" id="2244436">}</span><span class="op" id="2244437">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244451">//&nbsp;*&nbsp;1024</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244462">{</span><span class="num" id="2244463">4</span><span class="op" id="2244464">,</span>&nbsp;<span class="string" id="2244466">&#34;48828125&#34;</span><span class="op" id="2244476">}</span><span class="op" id="2244477">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244490">//&nbsp;*&nbsp;2048</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244501">{</span><span class="num" id="2244502">4</span><span class="op" id="2244503">,</span>&nbsp;<span class="string" id="2244505">&#34;244140625&#34;</span><span class="op" id="2244516">}</span><span class="op" id="2244517">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244529">//&nbsp;*&nbsp;4096</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244540">{</span><span class="num" id="2244541">4</span><span class="op" id="2244542">,</span>&nbsp;<span class="string" id="2244544">&#34;1220703125&#34;</span><span class="op" id="2244556">}</span><span class="op" id="2244557">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244568">//&nbsp;*&nbsp;8192</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244579">{</span><span class="num" id="2244580">5</span><span class="op" id="2244581">,</span>&nbsp;<span class="string" id="2244583">&#34;6103515625&#34;</span><span class="op" id="2244595">}</span><span class="op" id="2244596">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244607">//&nbsp;*&nbsp;16384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244619">{</span><span class="num" id="2244620">5</span><span class="op" id="2244621">,</span>&nbsp;<span class="string" id="2244623">&#34;30517578125&#34;</span><span class="op" id="2244636">}</span><span class="op" id="2244637">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244647">//&nbsp;*&nbsp;32768</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244659">{</span><span class="num" id="2244660">5</span><span class="op" id="2244661">,</span>&nbsp;<span class="string" id="2244663">&#34;152587890625&#34;</span><span class="op" id="2244677">}</span><span class="op" id="2244678">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244687">//&nbsp;*&nbsp;65536</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244699">{</span><span class="num" id="2244700">6</span><span class="op" id="2244701">,</span>&nbsp;<span class="string" id="2244703">&#34;762939453125&#34;</span><span class="op" id="2244717">}</span><span class="op" id="2244718">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244727">//&nbsp;*&nbsp;131072</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244740">{</span><span class="num" id="2244741">6</span><span class="op" id="2244742">,</span>&nbsp;<span class="string" id="2244744">&#34;3814697265625&#34;</span><span class="op" id="2244759">}</span><span class="op" id="2244760">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244768">//&nbsp;*&nbsp;262144</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244781">{</span><span class="num" id="2244782">6</span><span class="op" id="2244783">,</span>&nbsp;<span class="string" id="2244785">&#34;19073486328125&#34;</span><span class="op" id="2244801">}</span><span class="op" id="2244802">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244809">//&nbsp;*&nbsp;524288</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244822">{</span><span class="num" id="2244823">7</span><span class="op" id="2244824">,</span>&nbsp;<span class="string" id="2244826">&#34;95367431640625&#34;</span><span class="op" id="2244842">}</span><span class="op" id="2244843">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244850">//&nbsp;*&nbsp;1048576</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244864">{</span><span class="num" id="2244865">7</span><span class="op" id="2244866">,</span>&nbsp;<span class="string" id="2244868">&#34;476837158203125&#34;</span><span class="op" id="2244885">}</span><span class="op" id="2244886">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244892">//&nbsp;*&nbsp;2097152</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244906">{</span><span class="num" id="2244907">7</span><span class="op" id="2244908">,</span>&nbsp;<span class="string" id="2244910">&#34;2384185791015625&#34;</span><span class="op" id="2244928">}</span><span class="op" id="2244929">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2244934">//&nbsp;*&nbsp;4194304</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244948">{</span><span class="num" id="2244949">7</span><span class="op" id="2244950">,</span>&nbsp;<span class="string" id="2244952">&#34;11920928955078125&#34;</span><span class="op" id="2244971">}</span><span class="op" id="2244972">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2244976">//&nbsp;*&nbsp;8388608</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244990">{</span><span class="num" id="2244991">8</span><span class="op" id="2244992">,</span>&nbsp;<span class="string" id="2244994">&#34;59604644775390625&#34;</span><span class="op" id="2245013">}</span><span class="op" id="2245014">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2245018">//&nbsp;*&nbsp;16777216</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2245033">{</span><span class="num" id="2245034">8</span><span class="op" id="2245035">,</span>&nbsp;<span class="string" id="2245037">&#34;298023223876953125&#34;</span><span class="op" id="2245057">}</span><span class="op" id="2245058">,</span>&nbsp;&nbsp;<span class="comment" id="2245061">//&nbsp;*&nbsp;33554432</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2245076">{</span><span class="num" id="2245077">8</span><span class="op" id="2245078">,</span>&nbsp;<span class="string" id="2245080">&#34;1490116119384765625&#34;</span><span class="op" id="2245101">}</span><span class="op" id="2245102">,</span>&nbsp;<span class="comment" id="2245104">//&nbsp;*&nbsp;67108864</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2245119">{</span><span class="num" id="2245120">9</span><span class="op" id="2245121">,</span>&nbsp;<span class="string" id="2245123">&#34;7450580596923828125&#34;</span><span class="op" id="2245144">}</span><span class="op" id="2245145">,</span>&nbsp;<span class="comment" id="2245147">//&nbsp;*&nbsp;134217728</span><br>
<span class="lineno"></span><span class="op" id="2245162">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2245165">//&nbsp;Is&nbsp;the&nbsp;leading&nbsp;prefix&nbsp;of&nbsp;b&nbsp;lexicographically&nbsp;less&nbsp;than&nbsp;s?</span><br>
<span class="lineno"></span><span class="keyword" id="2245226">func</span>&nbsp;<span class="ident" id="2245231">prefixIsLessThan</span><span class="op" id="2245247">(</span><span class="ident" id="2245248">b</span>&nbsp;<span class="op" id="2245250">[</span><span class="op" id="2245251">]</span><span class="builtintype" id="2245252">byte</span><span class="op" id="2245256">,</span>&nbsp;<span class="ident" id="2245258">s</span>&nbsp;<span class="builtintype" id="2245260">string</span><span class="op" id="2245266">)</span>&nbsp;<span class="builtintype" id="2245268">bool</span>&nbsp;<span class="op" id="2245273">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2245276">for</span>&nbsp;<span class="ident" id="2245280">i</span>&nbsp;<span class="op" id="2245282">:=</span>&nbsp;<span class="num" id="2245285">0</span><span class="op" id="2245286">;</span>&nbsp;<span class="ident" id="2245288">i</span>&nbsp;<span class="op" id="2245290">&lt;</span>&nbsp;<span class="builtinfunc" id="2245292">len</span><span class="op" id="2245295">(</span><span class="ident" id="2245296">s</span><span class="op" id="2245297">)</span><span class="op" id="2245298">;</span>&nbsp;<span class="ident" id="2245300">i</span><span class="op" id="2245301">++</span>&nbsp;<span class="op" id="2245304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2245308">if</span>&nbsp;<span class="ident" id="2245311">i</span>&nbsp;<span class="op" id="2245313">&gt;=</span>&nbsp;<span class="builtinfunc" id="2245316">len</span><span class="op" id="2245319">(</span><span class="ident" id="2245320">b</span><span class="op" id="2245321">)</span>&nbsp;<span class="op" id="2245323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2245328">return</span>&nbsp;<span class="builtintype" id="2245335">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2245342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2245346">if</span>&nbsp;<span class="ident" id="2245349">b</span><span class="op" id="2245350">[</span><span class="ident" id="2245351">i</span><span class="op" id="2245352">]</span>&nbsp;<span class="op" id="2245354">!=</span>&nbsp;<span class="ident" id="2245357">s</span><span class="op" id="2245358">[</span><span class="ident" id="2245359">i</span><span class="op" id="2245360">]</span>&nbsp;<span class="op" id="2245362">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2245367">return</span>&nbsp;<span class="ident" id="2245374">b</span><span class="op" id="2245375">[</span><span class="ident" id="2245376">i</span><span class="op" id="2245377">]</span>&nbsp;<span class="op" id="2245379">&lt;</span>&nbsp;<span class="ident" id="2245381">s</span><span class="op" id="2245382">[</span><span class="ident" id="2245383">i</span><span class="op" id="2245384">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2245388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2245391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2245394">return</span>&nbsp;<span class="builtintype" id="2245401">false</span><br>
<span class="lineno"></span><span class="op" id="2245407">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="comment" id="2245410">//&nbsp;Binary&nbsp;shift&nbsp;left&nbsp;(/&nbsp;2)&nbsp;by&nbsp;k&nbsp;bits.&nbsp;&nbsp;k&nbsp;&lt;=&nbsp;maxShift&nbsp;to&nbsp;avoid&nbsp;overflow.</span><br>
<span class="lineno"></span><span class="keyword" id="2245482">func</span>&nbsp;<span class="ident" id="2245487">leftShift</span><span class="op" id="2245496">(</span><span class="ident" id="2245497">a</span>&nbsp;<span class="op" id="2245499">*</span><span class="ident" id="2245500">decimal</span><span class="op" id="2245507">,</span>&nbsp;<span class="ident" id="2245509">k</span>&nbsp;<span class="builtintype" id="2245511">uint</span><span class="op" id="2245515">)</span>&nbsp;<span class="op" id="2245517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2245520">delta</span>&nbsp;<span class="op" id="2245526">:=</span>&nbsp;<span class="ident" id="2245529">leftcheats</span><span class="op" id="2245539">[</span><span class="ident" id="2245540">k</span><span class="op" id="2245541">]</span><span class="op" id="2245542">.</span><span class="ident" id="2245543">delta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2245550">if</span>&nbsp;<span class="ident" id="2245553">prefixIsLessThan</span><span class="op" id="2245569">(</span><span class="ident" id="2245570">a</span><span class="op" id="2245571">.</span><span class="ident" id="2245572">d</span><span class="op" id="2245573">[</span><span class="num" id="2245574">0</span><span class="op" id="2245575">:</span><span class="ident" id="2245576">a</span><span class="op" id="2245577">.</span><span class="ident" id="2245578">nd</span><span class="op" id="2245580">]</span><span class="op" id="2245581">,</span>&nbsp;<span class="ident" id="2245583">leftcheats</span><span class="op" id="2245593">[</span><span class="ident" id="2245594">k</span><span class="op" id="2245595">]</span><span class="op" id="2245596">.</span><span class="ident" id="2245597">cutoff</span><span class="op" id="2245603">)</span>&nbsp;<span class="op" id="2245605">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2245609">delta</span><span class="op" id="2245614">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2245618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2245622">r</span>&nbsp;<span class="op" id="2245624">:=</span>&nbsp;<span class="ident" id="2245627">a</span><span class="op" id="2245628">.</span><span class="ident" id="2245629">nd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2245640">//&nbsp;read&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2245655">w</span>&nbsp;<span class="op" id="2245657">:=</span>&nbsp;<span class="ident" id="2245660">a</span><span class="op" id="2245661">.</span><span class="ident" id="2245662">nd</span>&nbsp;<span class="op" id="2245665">+</span>&nbsp;<span class="ident" id="2245667">delta</span>&nbsp;<span class="comment" id="2245673">//&nbsp;write&nbsp;index</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2245689">n</span>&nbsp;<span class="op" id="2245691">:=</span>&nbsp;<span class="num" id="2245694">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2245698">//&nbsp;Pick&nbsp;up&nbsp;a&nbsp;digit,&nbsp;put&nbsp;down&nbsp;a&nbsp;digit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2245737">for</span>&nbsp;<span class="ident" id="2245741">r</span><span class="op" id="2245742">--</span><span class="op" id="2245744">;</span>&nbsp;<span class="ident" id="2245746">r</span>&nbsp;<span class="op" id="2245748">&gt;=</span>&nbsp;<span class="num" id="2245751">0</span><span class="op" id="2245752">;</span>&nbsp;<span class="ident" id="2245754">r</span><span class="op" id="2245755">--</span>&nbsp;<span class="op" id="2245758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2245762">n</span>&nbsp;<span class="op" id="2245764">+=</span>&nbsp;<span class="op" id="2245767">(</span><span class="builtintype" id="2245768">int</span><span class="op" id="2245771">(</span><span class="ident" id="2245772">a</span><span class="op" id="2245773">.</span><span class="ident" id="2245774">d</span><span class="op" id="2245775">[</span><span class="ident" id="2245776">r</span><span class="op" id="2245777">]</span><span class="op" id="2245778">)</span>&nbsp;<span class="op" id="2245780">-</span>&nbsp;<span class="string" id="2245782">&#39;0&#39;</span><span class="op" id="2245785">)</span>&nbsp;<span class="op" id="2245787">&lt;&lt;</span>&nbsp;<span class="ident" id="2245790">k</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2245794">quo</span>&nbsp;<span class="op" id="2245798">:=</span>&nbsp;<span class="ident" id="2245801">n</span>&nbsp;<span class="op" id="2245803">/</span>&nbsp;<span class="num" id="2245805">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2245810">rem</span>&nbsp;<span class="op" id="2245814">:=</span>&nbsp;<span class="ident" id="2245817">n</span>&nbsp;<span class="op" id="2245819">-</span>&nbsp;<span class="num" id="2245821">10</span><span class="op" id="2245823">*</span><span class="ident" id="2245824">quo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2245830">w</span><span class="op" id="2245831">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2245836">if</span>&nbsp;<span class="ident" id="2245839">w</span>&nbsp;<span class="op" id="2245841">&lt;</span>&nbsp;<span class="builtinfunc" id="2245843">len</span><span class="op" id="2245846">(</span><span class="ident" id="2245847">a</span><span class="op" id="2245848">.</span><span class="ident" id="2245849">d</span><span class="op" id="2245850">)</span>&nbsp;<span class="op" id="2245852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2245857">a</span><span class="op" id="2245858">.</span><span class="ident" id="2245859">d</span><span class="op" id="2245860">[</span><span class="ident" id="2245861">w</span><span class="op" id="2245862">]</span>&nbsp;<span class="op" id="2245864">=</span>&nbsp;<span class="builtintype" id="2245866">byte</span><span class="op" id="2245870">(</span><span class="ident" id="2245871">rem</span>&nbsp;<span class="op" id="2245875">+</span>&nbsp;<span class="string" id="2245877">&#39;0&#39;</span><span class="op" id="2245880">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2245884">}</span>&nbsp;<span class="keyword" id="2245886">else</span>&nbsp;<span class="keyword" id="2245891">if</span>&nbsp;<span class="ident" id="2245894">rem</span>&nbsp;<span class="op" id="2245898">!=</span>&nbsp;<span class="num" id="2245901">0</span>&nbsp;<span class="op" id="2245903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2245908">a</span><span class="op" id="2245909">.</span><span class="ident" id="2245910">trunc</span>&nbsp;<span class="op" id="2245916">=</span>&nbsp;<span class="builtintype" id="2245918">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2245925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2245929">n</span>&nbsp;<span class="op" id="2245931">=</span>&nbsp;<span class="ident" id="2245933">quo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2245938">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2245942">//&nbsp;Put&nbsp;down&nbsp;extra&nbsp;digits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2245969">for</span>&nbsp;<span class="ident" id="2245973">n</span>&nbsp;<span class="op" id="2245975">&gt;</span>&nbsp;<span class="num" id="2245977">0</span>&nbsp;<span class="op" id="2245979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2245983">quo</span>&nbsp;<span class="op" id="2245987">:=</span>&nbsp;<span class="ident" id="2245990">n</span>&nbsp;<span class="op" id="2245992">/</span>&nbsp;<span class="num" id="2245994">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2245999">rem</span>&nbsp;<span class="op" id="2246003">:=</span>&nbsp;<span class="ident" id="2246006">n</span>&nbsp;<span class="op" id="2246008">-</span>&nbsp;<span class="num" id="2246010">10</span><span class="op" id="2246012">*</span><span class="ident" id="2246013">quo</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246019">w</span><span class="op" id="2246020">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246025">if</span>&nbsp;<span class="ident" id="2246028">w</span>&nbsp;<span class="op" id="2246030">&lt;</span>&nbsp;<span class="builtinfunc" id="2246032">len</span><span class="op" id="2246035">(</span><span class="ident" id="2246036">a</span><span class="op" id="2246037">.</span><span class="ident" id="2246038">d</span><span class="op" id="2246039">)</span>&nbsp;<span class="op" id="2246041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246046">a</span><span class="op" id="2246047">.</span><span class="ident" id="2246048">d</span><span class="op" id="2246049">[</span><span class="ident" id="2246050">w</span><span class="op" id="2246051">]</span>&nbsp;<span class="op" id="2246053">=</span>&nbsp;<span class="builtintype" id="2246055">byte</span><span class="op" id="2246059">(</span><span class="ident" id="2246060">rem</span>&nbsp;<span class="op" id="2246064">+</span>&nbsp;<span class="string" id="2246066">&#39;0&#39;</span><span class="op" id="2246069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2246073">}</span>&nbsp;<span class="keyword" id="2246075">else</span>&nbsp;<span class="keyword" id="2246080">if</span>&nbsp;<span class="ident" id="2246083">rem</span>&nbsp;<span class="op" id="2246087">!=</span>&nbsp;<span class="num" id="2246090">0</span>&nbsp;<span class="op" id="2246092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246097">a</span><span class="op" id="2246098">.</span><span class="ident" id="2246099">trunc</span>&nbsp;<span class="op" id="2246105">=</span>&nbsp;<span class="builtintype" id="2246107">true</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2246114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246118">n</span>&nbsp;<span class="op" id="2246120">=</span>&nbsp;<span class="ident" id="2246122">quo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2246127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246131">a</span><span class="op" id="2246132">.</span><span class="ident" id="2246133">nd</span>&nbsp;<span class="op" id="2246136">+=</span>&nbsp;<span class="ident" id="2246139">delta</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246146">if</span>&nbsp;<span class="ident" id="2246149">a</span><span class="op" id="2246150">.</span><span class="ident" id="2246151">nd</span>&nbsp;<span class="op" id="2246154">&gt;=</span>&nbsp;<span class="builtinfunc" id="2246157">len</span><span class="op" id="2246160">(</span><span class="ident" id="2246161">a</span><span class="op" id="2246162">.</span><span class="ident" id="2246163">d</span><span class="op" id="2246164">)</span>&nbsp;<span class="op" id="2246166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246170">a</span><span class="op" id="2246171">.</span><span class="ident" id="2246172">nd</span>&nbsp;<span class="op" id="2246175">=</span>&nbsp;<span class="builtinfunc" id="2246177">len</span><span class="op" id="2246180">(</span><span class="ident" id="2246181">a</span><span class="op" id="2246182">.</span><span class="ident" id="2246183">d</span><span class="op" id="2246184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2246187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246190">a</span><span class="op" id="2246191">.</span><span class="ident" id="2246192">dp</span>&nbsp;<span class="op" id="2246195">+=</span>&nbsp;<span class="ident" id="2246198">delta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246205">trim</span><span class="op" id="2246209">(</span><span class="ident" id="2246210">a</span><span class="op" id="2246211">)</span><br>
<span class="lineno">275</span><span class="op" id="2246213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2246216">//&nbsp;Binary&nbsp;shift&nbsp;left&nbsp;(k&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(k&nbsp;&lt;&nbsp;0).</span><br>
<span class="lineno"></span><span class="keyword" id="2246263">func</span>&nbsp;<span class="op" id="2246268">(</span><span class="ident" id="2246269">a</span>&nbsp;<span class="op" id="2246271">*</span><span class="ident" id="2246272">decimal</span><span class="op" id="2246279">)</span>&nbsp;<span class="ident" id="2246281">Shift</span><span class="op" id="2246286">(</span><span class="ident" id="2246287">k</span>&nbsp;<span class="builtintype" id="2246289">int</span><span class="op" id="2246292">)</span>&nbsp;<span class="op" id="2246294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246297">switch</span>&nbsp;<span class="op" id="2246304">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246307">case</span>&nbsp;<span class="ident" id="2246312">a</span><span class="op" id="2246313">.</span><span class="ident" id="2246314">nd</span>&nbsp;<span class="op" id="2246317">==</span>&nbsp;<span class="num" id="2246320">0</span><span class="op" id="2246321">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2246325">//&nbsp;nothing&nbsp;to&nbsp;do:&nbsp;a&nbsp;==&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246351">case</span>&nbsp;<span class="ident" id="2246356">k</span>&nbsp;<span class="op" id="2246358">&gt;</span>&nbsp;<span class="num" id="2246360">0</span><span class="op" id="2246361">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246365">for</span>&nbsp;<span class="ident" id="2246369">k</span>&nbsp;<span class="op" id="2246371">&gt;</span>&nbsp;<span class="ident" id="2246373">maxShift</span>&nbsp;<span class="op" id="2246382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246387">leftShift</span><span class="op" id="2246396">(</span><span class="ident" id="2246397">a</span><span class="op" id="2246398">,</span>&nbsp;<span class="ident" id="2246400">maxShift</span><span class="op" id="2246408">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246413">k</span>&nbsp;<span class="op" id="2246415">-=</span>&nbsp;<span class="ident" id="2246418">maxShift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2246429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246433">leftShift</span><span class="op" id="2246442">(</span><span class="ident" id="2246443">a</span><span class="op" id="2246444">,</span>&nbsp;<span class="builtintype" id="2246446">uint</span><span class="op" id="2246450">(</span><span class="ident" id="2246451">k</span><span class="op" id="2246452">)</span><span class="op" id="2246453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246456">case</span>&nbsp;<span class="ident" id="2246461">k</span>&nbsp;<span class="op" id="2246463">&lt;</span>&nbsp;<span class="num" id="2246465">0</span><span class="op" id="2246466">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246470">for</span>&nbsp;<span class="ident" id="2246474">k</span>&nbsp;<span class="op" id="2246476">&lt;</span>&nbsp;<span class="op" id="2246478">-</span><span class="ident" id="2246479">maxShift</span>&nbsp;<span class="op" id="2246488">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246493">rightShift</span><span class="op" id="2246503">(</span><span class="ident" id="2246504">a</span><span class="op" id="2246505">,</span>&nbsp;<span class="ident" id="2246507">maxShift</span><span class="op" id="2246515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246520">k</span>&nbsp;<span class="op" id="2246522">+=</span>&nbsp;<span class="ident" id="2246525">maxShift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2246536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246540">rightShift</span><span class="op" id="2246550">(</span><span class="ident" id="2246551">a</span><span class="op" id="2246552">,</span>&nbsp;<span class="builtintype" id="2246554">uint</span><span class="op" id="2246558">(</span><span class="op" id="2246559">-</span><span class="ident" id="2246560">k</span><span class="op" id="2246561">)</span><span class="op" id="2246562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2246565">}</span><br>
<span class="lineno">295</span><span class="op" id="2246567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2246570">//&nbsp;If&nbsp;we&nbsp;chop&nbsp;a&nbsp;at&nbsp;nd&nbsp;digits,&nbsp;should&nbsp;we&nbsp;round&nbsp;up?</span><br>
<span class="lineno"></span><span class="keyword" id="2246620">func</span>&nbsp;<span class="ident" id="2246625">shouldRoundUp</span><span class="op" id="2246638">(</span><span class="ident" id="2246639">a</span>&nbsp;<span class="op" id="2246641">*</span><span class="ident" id="2246642">decimal</span><span class="op" id="2246649">,</span>&nbsp;<span class="ident" id="2246651">nd</span>&nbsp;<span class="builtintype" id="2246654">int</span><span class="op" id="2246657">)</span>&nbsp;<span class="builtintype" id="2246659">bool</span>&nbsp;<span class="op" id="2246664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246667">if</span>&nbsp;<span class="ident" id="2246670">nd</span>&nbsp;<span class="op" id="2246673">&lt;</span>&nbsp;<span class="num" id="2246675">0</span>&nbsp;<span class="op" id="2246677">||</span>&nbsp;<span class="ident" id="2246680">nd</span>&nbsp;<span class="op" id="2246683">&gt;=</span>&nbsp;<span class="ident" id="2246686">a</span><span class="op" id="2246687">.</span><span class="ident" id="2246688">nd</span>&nbsp;<span class="op" id="2246691">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246695">return</span>&nbsp;<span class="builtintype" id="2246702">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2246709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246712">if</span>&nbsp;<span class="ident" id="2246715">a</span><span class="op" id="2246716">.</span><span class="ident" id="2246717">d</span><span class="op" id="2246718">[</span><span class="ident" id="2246719">nd</span><span class="op" id="2246721">]</span>&nbsp;<span class="op" id="2246723">==</span>&nbsp;<span class="string" id="2246726">&#39;5&#39;</span>&nbsp;<span class="op" id="2246730">&amp;&amp;</span>&nbsp;<span class="ident" id="2246733">nd</span><span class="op" id="2246735">+</span><span class="num" id="2246736">1</span>&nbsp;<span class="op" id="2246738">==</span>&nbsp;<span class="ident" id="2246741">a</span><span class="op" id="2246742">.</span><span class="ident" id="2246743">nd</span>&nbsp;<span class="op" id="2246746">{</span>&nbsp;<span class="comment" id="2246748">//&nbsp;exactly&nbsp;halfway&nbsp;-&nbsp;round&nbsp;to&nbsp;even</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2246785">//&nbsp;if&nbsp;we&nbsp;truncated,&nbsp;a&nbsp;little&nbsp;higher&nbsp;than&nbsp;what&#39;s&nbsp;recorded&nbsp;-&nbsp;always&nbsp;round&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246862">if</span>&nbsp;<span class="ident" id="2246865">a</span><span class="op" id="2246866">.</span><span class="ident" id="2246867">trunc</span>&nbsp;<span class="op" id="2246873">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246878">return</span>&nbsp;<span class="builtintype" id="2246885">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2246892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246896">return</span>&nbsp;<span class="ident" id="2246903">nd</span>&nbsp;<span class="op" id="2246906">&gt;</span>&nbsp;<span class="num" id="2246908">0</span>&nbsp;<span class="op" id="2246910">&amp;&amp;</span>&nbsp;<span class="op" id="2246913">(</span><span class="ident" id="2246914">a</span><span class="op" id="2246915">.</span><span class="ident" id="2246916">d</span><span class="op" id="2246917">[</span><span class="ident" id="2246918">nd</span><span class="op" id="2246920">-</span><span class="num" id="2246921">1</span><span class="op" id="2246922">]</span><span class="op" id="2246923">-</span><span class="string" id="2246924">&#39;0&#39;</span><span class="op" id="2246927">)</span><span class="op" id="2246928">%</span><span class="num" id="2246929">2</span>&nbsp;<span class="op" id="2246931">!=</span>&nbsp;<span class="num" id="2246934">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2246937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2246940">//&nbsp;not&nbsp;halfway&nbsp;-&nbsp;digit&nbsp;tells&nbsp;all</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246974">return</span>&nbsp;<span class="ident" id="2246981">a</span><span class="op" id="2246982">.</span><span class="ident" id="2246983">d</span><span class="op" id="2246984">[</span><span class="ident" id="2246985">nd</span><span class="op" id="2246987">]</span>&nbsp;<span class="op" id="2246989">&gt;=</span>&nbsp;<span class="string" id="2246992">&#39;5&#39;</span><br>
<span class="lineno"></span><span class="op" id="2246996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2246999">//&nbsp;Round&nbsp;a&nbsp;to&nbsp;nd&nbsp;digits&nbsp;(or&nbsp;fewer).</span><br>
<span class="lineno"></span><span class="comment" id="2247035">//&nbsp;If&nbsp;nd&nbsp;is&nbsp;zero,&nbsp;it&nbsp;means&nbsp;we&#39;re&nbsp;rounding</span><br>
<span class="lineno">315</span><span class="comment" id="2247077">//&nbsp;just&nbsp;to&nbsp;the&nbsp;left&nbsp;of&nbsp;the&nbsp;digits,&nbsp;as&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2247118">//&nbsp;0.09&nbsp;-&gt;&nbsp;0.1.</span><br>
<span class="lineno"></span><span class="keyword" id="2247134">func</span>&nbsp;<span class="op" id="2247139">(</span><span class="ident" id="2247140">a</span>&nbsp;<span class="op" id="2247142">*</span><span class="ident" id="2247143">decimal</span><span class="op" id="2247150">)</span>&nbsp;<span class="ident" id="2247152">Round</span><span class="op" id="2247157">(</span><span class="ident" id="2247158">nd</span>&nbsp;<span class="builtintype" id="2247161">int</span><span class="op" id="2247164">)</span>&nbsp;<span class="op" id="2247166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247169">if</span>&nbsp;<span class="ident" id="2247172">nd</span>&nbsp;<span class="op" id="2247175">&lt;</span>&nbsp;<span class="num" id="2247177">0</span>&nbsp;<span class="op" id="2247179">||</span>&nbsp;<span class="ident" id="2247182">nd</span>&nbsp;<span class="op" id="2247185">&gt;=</span>&nbsp;<span class="ident" id="2247188">a</span><span class="op" id="2247189">.</span><span class="ident" id="2247190">nd</span>&nbsp;<span class="op" id="2247193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247197">return</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2247205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247208">if</span>&nbsp;<span class="ident" id="2247211">shouldRoundUp</span><span class="op" id="2247224">(</span><span class="ident" id="2247225">a</span><span class="op" id="2247226">,</span>&nbsp;<span class="ident" id="2247228">nd</span><span class="op" id="2247230">)</span>&nbsp;<span class="op" id="2247232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247236">a</span><span class="op" id="2247237">.</span><span class="ident" id="2247238">RoundUp</span><span class="op" id="2247245">(</span><span class="ident" id="2247246">nd</span><span class="op" id="2247248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2247251">}</span>&nbsp;<span class="keyword" id="2247253">else</span>&nbsp;<span class="op" id="2247258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247262">a</span><span class="op" id="2247263">.</span><span class="ident" id="2247264">RoundDown</span><span class="op" id="2247273">(</span><span class="ident" id="2247274">nd</span><span class="op" id="2247276">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2247279">}</span><br>
<span class="lineno"></span><span class="op" id="2247281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2247284">//&nbsp;Round&nbsp;a&nbsp;down&nbsp;to&nbsp;nd&nbsp;digits&nbsp;(or&nbsp;fewer).</span><br>
<span class="lineno"></span><span class="keyword" id="2247325">func</span>&nbsp;<span class="op" id="2247330">(</span><span class="ident" id="2247331">a</span>&nbsp;<span class="op" id="2247333">*</span><span class="ident" id="2247334">decimal</span><span class="op" id="2247341">)</span>&nbsp;<span class="ident" id="2247343">RoundDown</span><span class="op" id="2247352">(</span><span class="ident" id="2247353">nd</span>&nbsp;<span class="builtintype" id="2247356">int</span><span class="op" id="2247359">)</span>&nbsp;<span class="op" id="2247361">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247364">if</span>&nbsp;<span class="ident" id="2247367">nd</span>&nbsp;<span class="op" id="2247370">&lt;</span>&nbsp;<span class="num" id="2247372">0</span>&nbsp;<span class="op" id="2247374">||</span>&nbsp;<span class="ident" id="2247377">nd</span>&nbsp;<span class="op" id="2247380">&gt;=</span>&nbsp;<span class="ident" id="2247383">a</span><span class="op" id="2247384">.</span><span class="ident" id="2247385">nd</span>&nbsp;<span class="op" id="2247388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247392">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2247400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247403">a</span><span class="op" id="2247404">.</span><span class="ident" id="2247405">nd</span>&nbsp;<span class="op" id="2247408">=</span>&nbsp;<span class="ident" id="2247410">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247414">trim</span><span class="op" id="2247418">(</span><span class="ident" id="2247419">a</span><span class="op" id="2247420">)</span><br>
<span class="lineno">335</span><span class="op" id="2247422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2247425">//&nbsp;Round&nbsp;a&nbsp;up&nbsp;to&nbsp;nd&nbsp;digits&nbsp;(or&nbsp;fewer).</span><br>
<span class="lineno"></span><span class="keyword" id="2247464">func</span>&nbsp;<span class="op" id="2247469">(</span><span class="ident" id="2247470">a</span>&nbsp;<span class="op" id="2247472">*</span><span class="ident" id="2247473">decimal</span><span class="op" id="2247480">)</span>&nbsp;<span class="ident" id="2247482">RoundUp</span><span class="op" id="2247489">(</span><span class="ident" id="2247490">nd</span>&nbsp;<span class="builtintype" id="2247493">int</span><span class="op" id="2247496">)</span>&nbsp;<span class="op" id="2247498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247501">if</span>&nbsp;<span class="ident" id="2247504">nd</span>&nbsp;<span class="op" id="2247507">&lt;</span>&nbsp;<span class="num" id="2247509">0</span>&nbsp;<span class="op" id="2247511">||</span>&nbsp;<span class="ident" id="2247514">nd</span>&nbsp;<span class="op" id="2247517">&gt;=</span>&nbsp;<span class="ident" id="2247520">a</span><span class="op" id="2247521">.</span><span class="ident" id="2247522">nd</span>&nbsp;<span class="op" id="2247525">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247529">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2247537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2247541">//&nbsp;round&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247554">for</span>&nbsp;<span class="ident" id="2247558">i</span>&nbsp;<span class="op" id="2247560">:=</span>&nbsp;<span class="ident" id="2247563">nd</span>&nbsp;<span class="op" id="2247566">-</span>&nbsp;<span class="num" id="2247568">1</span><span class="op" id="2247569">;</span>&nbsp;<span class="ident" id="2247571">i</span>&nbsp;<span class="op" id="2247573">&gt;=</span>&nbsp;<span class="num" id="2247576">0</span><span class="op" id="2247577">;</span>&nbsp;<span class="ident" id="2247579">i</span><span class="op" id="2247580">--</span>&nbsp;<span class="op" id="2247583">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247587">c</span>&nbsp;<span class="op" id="2247589">:=</span>&nbsp;<span class="ident" id="2247592">a</span><span class="op" id="2247593">.</span><span class="ident" id="2247594">d</span><span class="op" id="2247595">[</span><span class="ident" id="2247596">i</span><span class="op" id="2247597">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247601">if</span>&nbsp;<span class="ident" id="2247604">c</span>&nbsp;<span class="op" id="2247606">&lt;</span>&nbsp;<span class="string" id="2247608">&#39;9&#39;</span>&nbsp;<span class="op" id="2247612">{</span>&nbsp;<span class="comment" id="2247614">//&nbsp;can&nbsp;stop&nbsp;after&nbsp;this&nbsp;digit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247646">a</span><span class="op" id="2247647">.</span><span class="ident" id="2247648">d</span><span class="op" id="2247649">[</span><span class="ident" id="2247650">i</span><span class="op" id="2247651">]</span><span class="op" id="2247652">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247658">a</span><span class="op" id="2247659">.</span><span class="ident" id="2247660">nd</span>&nbsp;<span class="op" id="2247663">=</span>&nbsp;<span class="ident" id="2247665">i</span>&nbsp;<span class="op" id="2247667">+</span>&nbsp;<span class="num" id="2247669">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247674">return</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2247683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2247686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2247690">//&nbsp;Number&nbsp;is&nbsp;all&nbsp;9s.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2247712">//&nbsp;Change&nbsp;to&nbsp;single&nbsp;1&nbsp;with&nbsp;adjusted&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247764">a</span><span class="op" id="2247765">.</span><span class="ident" id="2247766">d</span><span class="op" id="2247767">[</span><span class="num" id="2247768">0</span><span class="op" id="2247769">]</span>&nbsp;<span class="op" id="2247771">=</span>&nbsp;<span class="string" id="2247773">&#39;1&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247778">a</span><span class="op" id="2247779">.</span><span class="ident" id="2247780">nd</span>&nbsp;<span class="op" id="2247783">=</span>&nbsp;<span class="num" id="2247785">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247788">a</span><span class="op" id="2247789">.</span><span class="ident" id="2247790">dp</span><span class="op" id="2247792">++</span><br>
<span class="lineno"></span><span class="op" id="2247795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">360</span><span class="comment" id="2247798">//&nbsp;Extract&nbsp;integer&nbsp;part,&nbsp;rounded&nbsp;appropriately.</span><br>
<span class="lineno"></span><span class="comment" id="2247846">//&nbsp;No&nbsp;guarantees&nbsp;about&nbsp;overflow.</span><br>
<span class="lineno"></span><span class="keyword" id="2247879">func</span>&nbsp;<span class="op" id="2247884">(</span><span class="ident" id="2247885">a</span>&nbsp;<span class="op" id="2247887">*</span><span class="ident" id="2247888">decimal</span><span class="op" id="2247895">)</span>&nbsp;<span class="ident" id="2247897">RoundedInteger</span><span class="op" id="2247911">(</span><span class="op" id="2247912">)</span>&nbsp;<span class="ident" id="2247914">uint64</span>&nbsp;<span class="op" id="2247921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247924">if</span>&nbsp;<span class="ident" id="2247927">a</span><span class="op" id="2247928">.</span><span class="ident" id="2247929">dp</span>&nbsp;<span class="op" id="2247932">&gt;</span>&nbsp;<span class="num" id="2247934">20</span>&nbsp;<span class="op" id="2247937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247941">return</span>&nbsp;<span class="num" id="2247948">0xFFFFFFFFFFFFFFFF</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2247968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247971">var</span>&nbsp;<span class="ident" id="2247975">i</span>&nbsp;<span class="builtintype" id="2247977">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247982">n</span>&nbsp;<span class="op" id="2247984">:=</span>&nbsp;<span class="ident" id="2247987">uint64</span><span class="op" id="2247993">(</span><span class="num" id="2247994">0</span><span class="op" id="2247995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247998">for</span>&nbsp;<span class="ident" id="2248002">i</span>&nbsp;<span class="op" id="2248004">=</span>&nbsp;<span class="num" id="2248006">0</span><span class="op" id="2248007">;</span>&nbsp;<span class="ident" id="2248009">i</span>&nbsp;<span class="op" id="2248011">&lt;</span>&nbsp;<span class="ident" id="2248013">a</span><span class="op" id="2248014">.</span><span class="ident" id="2248015">dp</span>&nbsp;<span class="op" id="2248018">&amp;&amp;</span>&nbsp;<span class="ident" id="2248021">i</span>&nbsp;<span class="op" id="2248023">&lt;</span>&nbsp;<span class="ident" id="2248025">a</span><span class="op" id="2248026">.</span><span class="ident" id="2248027">nd</span><span class="op" id="2248029">;</span>&nbsp;<span class="ident" id="2248031">i</span><span class="op" id="2248032">++</span>&nbsp;<span class="op" id="2248035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248039">n</span>&nbsp;<span class="op" id="2248041">=</span>&nbsp;<span class="ident" id="2248043">n</span><span class="op" id="2248044">*</span><span class="num" id="2248045">10</span>&nbsp;<span class="op" id="2248048">+</span>&nbsp;<span class="ident" id="2248050">uint64</span><span class="op" id="2248056">(</span><span class="ident" id="2248057">a</span><span class="op" id="2248058">.</span><span class="ident" id="2248059">d</span><span class="op" id="2248060">[</span><span class="ident" id="2248061">i</span><span class="op" id="2248062">]</span><span class="op" id="2248063">-</span><span class="string" id="2248064">&#39;0&#39;</span><span class="op" id="2248067">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2248070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2248073">for</span>&nbsp;<span class="op" id="2248077">;</span>&nbsp;<span class="ident" id="2248079">i</span>&nbsp;<span class="op" id="2248081">&lt;</span>&nbsp;<span class="ident" id="2248083">a</span><span class="op" id="2248084">.</span><span class="ident" id="2248085">dp</span><span class="op" id="2248087">;</span>&nbsp;<span class="ident" id="2248089">i</span><span class="op" id="2248090">++</span>&nbsp;<span class="op" id="2248093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248097">n</span>&nbsp;<span class="op" id="2248099">*=</span>&nbsp;<span class="num" id="2248102">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2248106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2248109">if</span>&nbsp;<span class="ident" id="2248112">shouldRoundUp</span><span class="op" id="2248125">(</span><span class="ident" id="2248126">a</span><span class="op" id="2248127">,</span>&nbsp;<span class="ident" id="2248129">a</span><span class="op" id="2248130">.</span><span class="ident" id="2248131">dp</span><span class="op" id="2248133">)</span>&nbsp;<span class="op" id="2248135">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248139">n</span><span class="op" id="2248140">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2248144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2248147">return</span>&nbsp;<span class="ident" id="2248154">n</span><br>
<span class="lineno"></span><span class="op" id="2248156">}</span>
</div>
</body>
</html>
