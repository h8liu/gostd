<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3757403">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3757458">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3757512">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3757563">//&nbsp;Package&nbsp;big&nbsp;implements&nbsp;multi-precision&nbsp;arithmetic&nbsp;(big&nbsp;numbers).</span><br>
<span class="lineno"></span><span class="comment" id="3757631">//&nbsp;The&nbsp;following&nbsp;numeric&nbsp;types&nbsp;are&nbsp;supported:</span><br>
<span class="lineno"></span><span class="comment" id="3757677">//</span><br>
<span class="lineno"></span><span class="comment" id="3757680">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;Int&nbsp;&nbsp;&nbsp;&nbspsigned&nbsp;integers</span><br>
<span class="lineno"></span><span class="comment" id="3757705">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;Rat&nbsp;&nbsp;&nbsp;&nbsprational&nbsp;numbers</span><br>
<span class="lineno">10</span><span class="comment" id="3757731">//</span><br>
<span class="lineno"></span><span class="comment" id="3757734">//&nbsp;Methods&nbsp;are&nbsp;typically&nbsp;of&nbsp;the&nbsp;form:</span><br>
<span class="lineno"></span><span class="comment" id="3757772">//</span><br>
<span class="lineno"></span><span class="comment" id="3757775">//&nbsp;&nbsp;&nbsp;&nbspfunc&nbsp;(z&nbsp;*Int)&nbsp;Op(x,&nbsp;y&nbsp;*Int)&nbsp;*Int&nbsp;&nbsp;&nbsp;&nbsp(similar&nbsp;for&nbsp;*Rat)</span><br>
<span class="lineno"></span><span class="comment" id="3757830">//</span><br>
<span class="lineno">15</span><span class="comment" id="3757833">//&nbsp;and&nbsp;implement&nbsp;operations&nbsp;z&nbsp;=&nbsp;x&nbsp;Op&nbsp;y&nbsp;with&nbsp;the&nbsp;result&nbsp;as&nbsp;receiver;&nbsp;if&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="3757907">//&nbsp;is&nbsp;one&nbsp;of&nbsp;the&nbsp;operands&nbsp;it&nbsp;may&nbsp;be&nbsp;overwritten&nbsp;(and&nbsp;its&nbsp;memory&nbsp;reused).</span><br>
<span class="lineno"></span><span class="comment" id="3757980">//&nbsp;To&nbsp;enable&nbsp;chaining&nbsp;of&nbsp;operations,&nbsp;the&nbsp;result&nbsp;is&nbsp;also&nbsp;returned.&nbsp;Methods</span><br>
<span class="lineno"></span><span class="comment" id="3758054">//&nbsp;returning&nbsp;a&nbsp;result&nbsp;other&nbsp;than&nbsp;*Int&nbsp;or&nbsp;*Rat&nbsp;take&nbsp;one&nbsp;of&nbsp;the&nbsp;operands&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="3758128">//&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno">20</span><span class="comment" id="3758145">//</span><br>
<span class="lineno"></span><span class="keyword" id="3758148">package</span>&nbsp;<span class="ident" id="3758156">big</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3758161">//&nbsp;This&nbsp;file&nbsp;contains&nbsp;operations&nbsp;on&nbsp;unsigned&nbsp;multi-precision&nbsp;integers.</span><br>
<span class="lineno"></span><span class="comment" id="3758232">//&nbsp;These&nbsp;are&nbsp;the&nbsp;building&nbsp;blocks&nbsp;for&nbsp;the&nbsp;operations&nbsp;on&nbsp;signed&nbsp;integers</span><br>
<span class="lineno">25</span><span class="comment" id="3758303">//&nbsp;and&nbsp;rationals.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3758322">import</span>&nbsp;<span class="op" id="3758329">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3758332">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3758342">&#34;io&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3758348">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3758356">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3758369">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="3758376">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="3758379">//&nbsp;An&nbsp;unsigned&nbsp;integer&nbsp;x&nbsp;of&nbsp;the&nbsp;form</span><br>
<span class="lineno"></span><span class="comment" id="3758416">//</span><br>
<span class="lineno"></span><span class="comment" id="3758419">//&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;x[n-1]*_B^(n-1)&nbsp;+&nbsp;x[n-2]*_B^(n-2)&nbsp;+&nbsp;...&nbsp;+&nbsp;x[1]*_B&nbsp;+&nbsp;x[0]</span><br>
<span class="lineno"></span><span class="comment" id="3758485">//</span><br>
<span class="lineno"></span><span class="comment" id="3758488">//&nbsp;with&nbsp;0&nbsp;&lt;=&nbsp;x[i]&nbsp;&lt;&nbsp;_B&nbsp;and&nbsp;0&nbsp;&lt;=&nbsp;i&nbsp;&lt;&nbsp;n&nbsp;is&nbsp;stored&nbsp;in&nbsp;a&nbsp;slice&nbsp;of&nbsp;length&nbsp;n,</span><br>
<span class="lineno">40</span><span class="comment" id="3758560">//&nbsp;with&nbsp;the&nbsp;digits&nbsp;x[i]&nbsp;as&nbsp;the&nbsp;slice&nbsp;elements.</span><br>
<span class="lineno"></span><span class="comment" id="3758607">//</span><br>
<span class="lineno"></span><span class="comment" id="3758610">//&nbsp;A&nbsp;number&nbsp;is&nbsp;normalized&nbsp;if&nbsp;the&nbsp;slice&nbsp;contains&nbsp;no&nbsp;leading&nbsp;0&nbsp;digits.</span><br>
<span class="lineno"></span><span class="comment" id="3758679">//&nbsp;During&nbsp;arithmetic&nbsp;operations,&nbsp;denormalized&nbsp;values&nbsp;may&nbsp;occur&nbsp;but&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="3758750">//&nbsp;always&nbsp;normalized&nbsp;before&nbsp;returning&nbsp;the&nbsp;final&nbsp;result.&nbsp;The&nbsp;normalized</span><br>
<span class="lineno">45</span><span class="comment" id="3758821">//&nbsp;representation&nbsp;of&nbsp;0&nbsp;is&nbsp;the&nbsp;empty&nbsp;or&nbsp;nil&nbsp;slice&nbsp;(length&nbsp;=&nbsp;0).</span><br>
<span class="lineno"></span><span class="comment" id="3758884">//</span><br>
<span class="lineno"></span><span class="keyword" id="3758887">type</span>&nbsp;<span class="ident" id="3758892">nat</span>&nbsp;<span class="op" id="3758896">[</span><span class="op" id="3758897">]</span><span class="ident" id="3758898"><a href="/math/big/arith.go.html#3727748">Word</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3758904">var</span>&nbsp;<span class="op" id="3758908">(</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3758911">natOne</span>&nbsp;<span class="op" id="3758918">=</span>&nbsp;<span class="ident" id="3758920"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3758923">{</span><span class="num" id="3758924">1</span><span class="op" id="3758925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3758928">natTwo</span>&nbsp;<span class="op" id="3758935">=</span>&nbsp;<span class="ident" id="3758937"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3758940">{</span><span class="num" id="3758941">2</span><span class="op" id="3758942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3758945">natTen</span>&nbsp;<span class="op" id="3758952">=</span>&nbsp;<span class="ident" id="3758954"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3758957">{</span><span class="num" id="3758958">10</span><span class="op" id="3758960">}</span><br>
<span class="lineno"></span><span class="op" id="3758962">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3758965">func</span>&nbsp;<span class="op" id="3758970">(</span><span class="ident" id="3758971">z</span>&nbsp;<span class="ident" id="3758973"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3758976">)</span>&nbsp;<span class="ident" id="3758978">clear</span><span class="op" id="3758983">(</span><span class="op" id="3758984">)</span>&nbsp;<span class="op" id="3758986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758989">for</span>&nbsp;<span class="ident" id="3758993">i</span>&nbsp;<span class="op" id="3758995">:=</span>&nbsp;<span class="keyword" id="3758998">range</span>&nbsp;<span class="ident" id="3759004"><a href="/math/big/nat.go.html#3758971">z</a></span>&nbsp;<span class="op" id="3759006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759010"><a href="/math/big/nat.go.html#3758971">z</a></span><span class="op" id="3759011">[</span><span class="ident" id="3759012"><a href="/math/big/nat.go.html#3758993">i</a></span><span class="op" id="3759013">]</span>&nbsp;<span class="op" id="3759015">=</span>&nbsp;<span class="num" id="3759017">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3759020">}</span><br>
<span class="lineno"></span><span class="op" id="3759022">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="3759025">func</span>&nbsp;<span class="op" id="3759030">(</span><span class="ident" id="3759031">z</span>&nbsp;<span class="ident" id="3759033"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3759036">)</span>&nbsp;<span class="ident" id="3759038">norm</span><span class="op" id="3759042">(</span><span class="op" id="3759043">)</span>&nbsp;<span class="ident" id="3759045"><a href="/math/big/nat.go.html#3758892">nat</a></span>&nbsp;<span class="op" id="3759049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759052">i</span>&nbsp;<span class="op" id="3759054">:=</span>&nbsp;<span class="builtinfunc" id="3759057">len</span><span class="op" id="3759060">(</span><span class="ident" id="3759061"><a href="/math/big/nat.go.html#3759031">z</a></span><span class="op" id="3759062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759065">for</span>&nbsp;<span class="ident" id="3759069"><a href="/math/big/nat.go.html#3759052">i</a></span>&nbsp;<span class="op" id="3759071">&gt;</span>&nbsp;<span class="num" id="3759073">0</span>&nbsp;<span class="op" id="3759075">&amp;&amp;</span>&nbsp;<span class="ident" id="3759078"><a href="/math/big/nat.go.html#3759031">z</a></span><span class="op" id="3759079">[</span><span class="ident" id="3759080"><a href="/math/big/nat.go.html#3759052">i</a></span><span class="op" id="3759081">-</span><span class="num" id="3759082">1</span><span class="op" id="3759083">]</span>&nbsp;<span class="op" id="3759085">==</span>&nbsp;<span class="num" id="3759088">0</span>&nbsp;<span class="op" id="3759090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759094"><a href="/math/big/nat.go.html#3759052">i</a></span><span class="op" id="3759095">--</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3759099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759102">return</span>&nbsp;<span class="ident" id="3759109"><a href="/math/big/nat.go.html#3759031">z</a></span><span class="op" id="3759110">[</span><span class="num" id="3759111">0</span><span class="op" id="3759112">:</span><span class="ident" id="3759113"><a href="/math/big/nat.go.html#3759052">i</a></span><span class="op" id="3759114">]</span><br>
<span class="lineno"></span><span class="op" id="3759116">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3759119">func</span>&nbsp;<span class="op" id="3759124">(</span><span class="ident" id="3759125">z</span>&nbsp;<span class="ident" id="3759127"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3759130">)</span>&nbsp;<span class="builtinfunc" id="3759132">make</span><span class="op" id="3759136">(</span><span class="ident" id="3759137">n</span>&nbsp;<span class="builtintype" id="3759139">int</span><span class="op" id="3759142">)</span>&nbsp;<span class="ident" id="3759144"><a href="/math/big/nat.go.html#3758892">nat</a></span>&nbsp;<span class="op" id="3759148">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759151">if</span>&nbsp;<span class="ident" id="3759154"><a href="/math/big/nat.go.html#3759137">n</a></span>&nbsp;<span class="op" id="3759156">&lt;=</span>&nbsp;<span class="builtinfunc" id="3759159">cap</span><span class="op" id="3759162">(</span><span class="ident" id="3759163"><a href="/math/big/nat.go.html#3759125">z</a></span><span class="op" id="3759164">)</span>&nbsp;<span class="op" id="3759166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759170">return</span>&nbsp;<span class="ident" id="3759177"><a href="/math/big/nat.go.html#3759125">z</a></span><span class="op" id="3759178">[</span><span class="num" id="3759179">0</span><span class="op" id="3759180">:</span><span class="ident" id="3759181"><a href="/math/big/nat.go.html#3759137">n</a></span><span class="op" id="3759182">]</span>&nbsp;<span class="comment" id="3759184">//&nbsp;reuse&nbsp;z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3759196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3759199">//&nbsp;Choosing&nbsp;a&nbsp;good&nbsp;value&nbsp;for&nbsp;e&nbsp;has&nbsp;significant&nbsp;performance&nbsp;impact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3759266">//&nbsp;because&nbsp;it&nbsp;increases&nbsp;the&nbsp;chance&nbsp;that&nbsp;a&nbsp;value&nbsp;can&nbsp;be&nbsp;reused.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759330">const</span>&nbsp;<span class="ident" id="3759336">e</span>&nbsp;<span class="op" id="3759338">=</span>&nbsp;<span class="num" id="3759340">4</span>&nbsp;<span class="comment" id="3759342">//&nbsp;extra&nbsp;capacity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759361">return</span>&nbsp;<span class="builtinfunc" id="3759368">make</span><span class="op" id="3759372">(</span><span class="ident" id="3759373"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3759376">,</span>&nbsp;<span class="ident" id="3759378"><a href="/math/big/nat.go.html#3759137">n</a></span><span class="op" id="3759379">,</span>&nbsp;<span class="ident" id="3759381"><a href="/math/big/nat.go.html#3759137">n</a></span><span class="op" id="3759382">+</span><span class="ident" id="3759383"><a href="/math/big/nat.go.html#3759336">e</a></span><span class="op" id="3759384">)</span><br>
<span class="lineno"></span><span class="op" id="3759386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3759389">func</span>&nbsp;<span class="op" id="3759394">(</span><span class="ident" id="3759395">z</span>&nbsp;<span class="ident" id="3759397"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3759400">)</span>&nbsp;<span class="ident" id="3759402">setWord</span><span class="op" id="3759409">(</span><span class="ident" id="3759410">x</span>&nbsp;<span class="ident" id="3759412"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3759416">)</span>&nbsp;<span class="ident" id="3759418"><a href="/math/big/nat.go.html#3758892">nat</a></span>&nbsp;<span class="op" id="3759422">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759425">if</span>&nbsp;<span class="ident" id="3759428"><a href="/math/big/nat.go.html#3759410">x</a></span>&nbsp;<span class="op" id="3759430">==</span>&nbsp;<span class="num" id="3759433">0</span>&nbsp;<span class="op" id="3759435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759439">return</span>&nbsp;<span class="ident" id="3759446"><a href="/math/big/nat.go.html#3759395">z</a></span><span class="op" id="3759447">.</span><span class="builtinfunc" id="3759448">make</span><span class="op" id="3759452">(</span><span class="num" id="3759453">0</span><span class="op" id="3759454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3759457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759460"><a href="/math/big/nat.go.html#3759395">z</a></span>&nbsp;<span class="op" id="3759462">=</span>&nbsp;<span class="ident" id="3759464"><a href="/math/big/nat.go.html#3759395">z</a></span><span class="op" id="3759465">.</span><span class="builtinfunc" id="3759466">make</span><span class="op" id="3759470">(</span><span class="num" id="3759471">1</span><span class="op" id="3759472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759475"><a href="/math/big/nat.go.html#3759395">z</a></span><span class="op" id="3759476">[</span><span class="num" id="3759477">0</span><span class="op" id="3759478">]</span>&nbsp;<span class="op" id="3759480">=</span>&nbsp;<span class="ident" id="3759482"><a href="/math/big/nat.go.html#3759410">x</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759485">return</span>&nbsp;<span class="ident" id="3759492"><a href="/math/big/nat.go.html#3759395">z</a></span><br>
<span class="lineno"></span><span class="op" id="3759494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3759497">func</span>&nbsp;<span class="op" id="3759502">(</span><span class="ident" id="3759503">z</span>&nbsp;<span class="ident" id="3759505"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3759508">)</span>&nbsp;<span class="ident" id="3759510">setUint64</span><span class="op" id="3759519">(</span><span class="ident" id="3759520">x</span>&nbsp;<span class="ident" id="3759522">uint64</span><span class="op" id="3759528">)</span>&nbsp;<span class="ident" id="3759530"><a href="/math/big/nat.go.html#3758892">nat</a></span>&nbsp;<span class="op" id="3759534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3759537">//&nbsp;single-digit&nbsp;values</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759561">if</span>&nbsp;<span class="ident" id="3759564">w</span>&nbsp;<span class="op" id="3759566">:=</span>&nbsp;<span class="ident" id="3759569"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3759573">(</span><span class="ident" id="3759574"><a href="/math/big/nat.go.html#3759520">x</a></span><span class="op" id="3759575">)</span><span class="op" id="3759576">;</span>&nbsp;<span class="ident" id="3759578">uint64</span><span class="op" id="3759584">(</span><span class="ident" id="3759585"><a href="/math/big/nat.go.html#3759564">w</a></span><span class="op" id="3759586">)</span>&nbsp;<span class="op" id="3759588">==</span>&nbsp;<span class="ident" id="3759591"><a href="/math/big/nat.go.html#3759520">x</a></span>&nbsp;<span class="op" id="3759593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759597">return</span>&nbsp;<span class="ident" id="3759604"><a href="/math/big/nat.go.html#3759503">z</a></span><span class="op" id="3759605">.</span><span class="ident" id="3759606">setWord</span><span class="op" id="3759613">(</span><span class="ident" id="3759614"><a href="/math/big/nat.go.html#3759564">w</a></span><span class="op" id="3759615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3759618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3759622">//&nbsp;compute&nbsp;number&nbsp;of&nbsp;words&nbsp;n&nbsp;required&nbsp;to&nbsp;represent&nbsp;x</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759676">n</span>&nbsp;<span class="op" id="3759678">:=</span>&nbsp;<span class="num" id="3759681">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759684">for</span>&nbsp;<span class="ident" id="3759688">t</span>&nbsp;<span class="op" id="3759690">:=</span>&nbsp;<span class="ident" id="3759693"><a href="/math/big/nat.go.html#3759520">x</a></span><span class="op" id="3759694">;</span>&nbsp;<span class="ident" id="3759696"><a href="/math/big/nat.go.html#3759688">t</a></span>&nbsp;<span class="op" id="3759698">&gt;</span>&nbsp;<span class="num" id="3759700">0</span><span class="op" id="3759701">;</span>&nbsp;<span class="ident" id="3759703"><a href="/math/big/nat.go.html#3759688">t</a></span>&nbsp;<span class="op" id="3759705">&gt;&gt;=</span>&nbsp;<span class="ident" id="3759709"><a href="/math/big/arith.go.html#3727893">_W</a></span>&nbsp;<span class="op" id="3759712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759716"><a href="/math/big/nat.go.html#3759676">n</a></span><span class="op" id="3759717">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3759721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3759725">//&nbsp;split&nbsp;x&nbsp;into&nbsp;n&nbsp;words</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759750"><a href="/math/big/nat.go.html#3759503">z</a></span>&nbsp;<span class="op" id="3759752">=</span>&nbsp;<span class="ident" id="3759754"><a href="/math/big/nat.go.html#3759503">z</a></span><span class="op" id="3759755">.</span><span class="builtinfunc" id="3759756">make</span><span class="op" id="3759760">(</span><span class="ident" id="3759761"><a href="/math/big/nat.go.html#3759676">n</a></span><span class="op" id="3759762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759765">for</span>&nbsp;<span class="ident" id="3759769">i</span>&nbsp;<span class="op" id="3759771">:=</span>&nbsp;<span class="keyword" id="3759774">range</span>&nbsp;<span class="ident" id="3759780"><a href="/math/big/nat.go.html#3759503">z</a></span>&nbsp;<span class="op" id="3759782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759786"><a href="/math/big/nat.go.html#3759503">z</a></span><span class="op" id="3759787">[</span><span class="ident" id="3759788"><a href="/math/big/nat.go.html#3759769">i</a></span><span class="op" id="3759789">]</span>&nbsp;<span class="op" id="3759791">=</span>&nbsp;<span class="ident" id="3759793"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3759797">(</span><span class="ident" id="3759798"><a href="/math/big/nat.go.html#3759520">x</a></span>&nbsp;<span class="op" id="3759800">&amp;</span>&nbsp;<span class="ident" id="3759802"><a href="/math/big/arith.go.html#3727956">_M</a></span><span class="op" id="3759804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759808"><a href="/math/big/nat.go.html#3759520">x</a></span>&nbsp;<span class="op" id="3759810">&gt;&gt;=</span>&nbsp;<span class="ident" id="3759814"><a href="/math/big/arith.go.html#3727893">_W</a></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3759818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759822">return</span>&nbsp;<span class="ident" id="3759829"><a href="/math/big/nat.go.html#3759503">z</a></span><br>
<span class="lineno"></span><span class="op" id="3759831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="3759834">func</span>&nbsp;<span class="op" id="3759839">(</span><span class="ident" id="3759840">z</span>&nbsp;<span class="ident" id="3759842"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3759845">)</span>&nbsp;<span class="ident" id="3759847">set</span><span class="op" id="3759850">(</span><span class="ident" id="3759851">x</span>&nbsp;<span class="ident" id="3759853"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3759856">)</span>&nbsp;<span class="ident" id="3759858"><a href="/math/big/nat.go.html#3758892">nat</a></span>&nbsp;<span class="op" id="3759862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759865"><a href="/math/big/nat.go.html#3759840">z</a></span>&nbsp;<span class="op" id="3759867">=</span>&nbsp;<span class="ident" id="3759869"><a href="/math/big/nat.go.html#3759840">z</a></span><span class="op" id="3759870">.</span><span class="builtinfunc" id="3759871">make</span><span class="op" id="3759875">(</span><span class="builtinfunc" id="3759876">len</span><span class="op" id="3759879">(</span><span class="ident" id="3759880"><a href="/math/big/nat.go.html#3759851">x</a></span><span class="op" id="3759881">)</span><span class="op" id="3759882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3759885">copy</span><span class="op" id="3759889">(</span><span class="ident" id="3759890"><a href="/math/big/nat.go.html#3759840">z</a></span><span class="op" id="3759891">,</span>&nbsp;<span class="ident" id="3759893"><a href="/math/big/nat.go.html#3759851">x</a></span><span class="op" id="3759894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759897">return</span>&nbsp;<span class="ident" id="3759904"><a href="/math/big/nat.go.html#3759840">z</a></span><br>
<span class="lineno"></span><span class="op" id="3759906">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="keyword" id="3759909">func</span>&nbsp;<span class="op" id="3759914">(</span><span class="ident" id="3759915">z</span>&nbsp;<span class="ident" id="3759917"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3759920">)</span>&nbsp;<span class="ident" id="3759922">add</span><span class="op" id="3759925">(</span><span class="ident" id="3759926">x</span><span class="op" id="3759927">,</span>&nbsp;<span class="ident" id="3759929">y</span>&nbsp;<span class="ident" id="3759931"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3759934">)</span>&nbsp;<span class="ident" id="3759936"><a href="/math/big/nat.go.html#3758892">nat</a></span>&nbsp;<span class="op" id="3759940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759943">m</span>&nbsp;<span class="op" id="3759945">:=</span>&nbsp;<span class="builtinfunc" id="3759948">len</span><span class="op" id="3759951">(</span><span class="ident" id="3759952"><a href="/math/big/nat.go.html#3759926">x</a></span><span class="op" id="3759953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759956">n</span>&nbsp;<span class="op" id="3759958">:=</span>&nbsp;<span class="builtinfunc" id="3759961">len</span><span class="op" id="3759964">(</span><span class="ident" id="3759965"><a href="/math/big/nat.go.html#3759929">y</a></span><span class="op" id="3759966">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759970">switch</span>&nbsp;<span class="op" id="3759977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759980">case</span>&nbsp;<span class="ident" id="3759985"><a href="/math/big/nat.go.html#3759943">m</a></span>&nbsp;<span class="op" id="3759987">&lt;</span>&nbsp;<span class="ident" id="3759989"><a href="/math/big/nat.go.html#3759956">n</a></span><span class="op" id="3759990">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759994">return</span>&nbsp;<span class="ident" id="3760001"><a href="/math/big/nat.go.html#3759915">z</a></span><span class="op" id="3760002">.</span><span class="ident" id="3760003">add</span><span class="op" id="3760006">(</span><span class="ident" id="3760007"><a href="/math/big/nat.go.html#3759929">y</a></span><span class="op" id="3760008">,</span>&nbsp;<span class="ident" id="3760010"><a href="/math/big/nat.go.html#3759926">x</a></span><span class="op" id="3760011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760014">case</span>&nbsp;<span class="ident" id="3760019"><a href="/math/big/nat.go.html#3759943">m</a></span>&nbsp;<span class="op" id="3760021">==</span>&nbsp;<span class="num" id="3760024">0</span><span class="op" id="3760025">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3760029">//&nbsp;n&nbsp;==&nbsp;0&nbsp;because&nbsp;m&nbsp;&gt;=&nbsp;n;&nbsp;result&nbsp;is&nbsp;0</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760069">return</span>&nbsp;<span class="ident" id="3760076"><a href="/math/big/nat.go.html#3759915">z</a></span><span class="op" id="3760077">.</span><span class="builtinfunc" id="3760078">make</span><span class="op" id="3760082">(</span><span class="num" id="3760083">0</span><span class="op" id="3760084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760087">case</span>&nbsp;<span class="ident" id="3760092"><a href="/math/big/nat.go.html#3759956">n</a></span>&nbsp;<span class="op" id="3760094">==</span>&nbsp;<span class="num" id="3760097">0</span><span class="op" id="3760098">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3760102">//&nbsp;result&nbsp;is&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760119">return</span>&nbsp;<span class="ident" id="3760126"><a href="/math/big/nat.go.html#3759915">z</a></span><span class="op" id="3760127">.</span><span class="ident" id="3760128">set</span><span class="op" id="3760131">(</span><span class="ident" id="3760132"><a href="/math/big/nat.go.html#3759926">x</a></span><span class="op" id="3760133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3760136">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3760139">//&nbsp;m&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760150"><a href="/math/big/nat.go.html#3759915">z</a></span>&nbsp;<span class="op" id="3760152">=</span>&nbsp;<span class="ident" id="3760154"><a href="/math/big/nat.go.html#3759915">z</a></span><span class="op" id="3760155">.</span><span class="builtinfunc" id="3760156">make</span><span class="op" id="3760160">(</span><span class="ident" id="3760161"><a href="/math/big/nat.go.html#3759943">m</a></span>&nbsp;<span class="op" id="3760163">+</span>&nbsp;<span class="num" id="3760165">1</span><span class="op" id="3760166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760169">c</span>&nbsp;<span class="op" id="3760171">:=</span>&nbsp;<span class="ident" id="3760174"><a href="/math/big/arith_decl.go.html#3731908">addVV</a></span><span class="op" id="3760179">(</span><span class="ident" id="3760180"><a href="/math/big/nat.go.html#3759915">z</a></span><span class="op" id="3760181">[</span><span class="num" id="3760182">0</span><span class="op" id="3760183">:</span><span class="ident" id="3760184"><a href="/math/big/nat.go.html#3759956">n</a></span><span class="op" id="3760185">]</span><span class="op" id="3760186">,</span>&nbsp;<span class="ident" id="3760188"><a href="/math/big/nat.go.html#3759926">x</a></span><span class="op" id="3760189">,</span>&nbsp;<span class="ident" id="3760191"><a href="/math/big/nat.go.html#3759929">y</a></span><span class="op" id="3760192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760195">if</span>&nbsp;<span class="ident" id="3760198"><a href="/math/big/nat.go.html#3759943">m</a></span>&nbsp;<span class="op" id="3760200">&gt;</span>&nbsp;<span class="ident" id="3760202"><a href="/math/big/nat.go.html#3759956">n</a></span>&nbsp;<span class="op" id="3760204">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760208"><a href="/math/big/nat.go.html#3760169">c</a></span>&nbsp;<span class="op" id="3760210">=</span>&nbsp;<span class="ident" id="3760212"><a href="/math/big/arith_decl.go.html#3731980">addVW</a></span><span class="op" id="3760217">(</span><span class="ident" id="3760218"><a href="/math/big/nat.go.html#3759915">z</a></span><span class="op" id="3760219">[</span><span class="ident" id="3760220"><a href="/math/big/nat.go.html#3759956">n</a></span><span class="op" id="3760221">:</span><span class="ident" id="3760222"><a href="/math/big/nat.go.html#3759943">m</a></span><span class="op" id="3760223">]</span><span class="op" id="3760224">,</span>&nbsp;<span class="ident" id="3760226"><a href="/math/big/nat.go.html#3759926">x</a></span><span class="op" id="3760227">[</span><span class="ident" id="3760228"><a href="/math/big/nat.go.html#3759956">n</a></span><span class="op" id="3760229">:</span><span class="op" id="3760230">]</span><span class="op" id="3760231">,</span>&nbsp;<span class="ident" id="3760233"><a href="/math/big/nat.go.html#3760169">c</a></span><span class="op" id="3760234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3760237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760240"><a href="/math/big/nat.go.html#3759915">z</a></span><span class="op" id="3760241">[</span><span class="ident" id="3760242"><a href="/math/big/nat.go.html#3759943">m</a></span><span class="op" id="3760243">]</span>&nbsp;<span class="op" id="3760245">=</span>&nbsp;<span class="ident" id="3760247"><a href="/math/big/nat.go.html#3760169">c</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760251">return</span>&nbsp;<span class="ident" id="3760258"><a href="/math/big/nat.go.html#3759915">z</a></span><span class="op" id="3760259">.</span><span class="ident" id="3760260">norm</span><span class="op" id="3760264">(</span><span class="op" id="3760265">)</span><br>
<span class="lineno">140</span><span class="op" id="3760267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3760270">func</span>&nbsp;<span class="op" id="3760275">(</span><span class="ident" id="3760276">z</span>&nbsp;<span class="ident" id="3760278"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3760281">)</span>&nbsp;<span class="ident" id="3760283">sub</span><span class="op" id="3760286">(</span><span class="ident" id="3760287">x</span><span class="op" id="3760288">,</span>&nbsp;<span class="ident" id="3760290">y</span>&nbsp;<span class="ident" id="3760292"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3760295">)</span>&nbsp;<span class="ident" id="3760297"><a href="/math/big/nat.go.html#3758892">nat</a></span>&nbsp;<span class="op" id="3760301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760304">m</span>&nbsp;<span class="op" id="3760306">:=</span>&nbsp;<span class="builtinfunc" id="3760309">len</span><span class="op" id="3760312">(</span><span class="ident" id="3760313"><a href="/math/big/nat.go.html#3760287">x</a></span><span class="op" id="3760314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760317">n</span>&nbsp;<span class="op" id="3760319">:=</span>&nbsp;<span class="builtinfunc" id="3760322">len</span><span class="op" id="3760325">(</span><span class="ident" id="3760326"><a href="/math/big/nat.go.html#3760290">y</a></span><span class="op" id="3760327">)</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760331">switch</span>&nbsp;<span class="op" id="3760338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760341">case</span>&nbsp;<span class="ident" id="3760346"><a href="/math/big/nat.go.html#3760304">m</a></span>&nbsp;<span class="op" id="3760348">&lt;</span>&nbsp;<span class="ident" id="3760350"><a href="/math/big/nat.go.html#3760317">n</a></span><span class="op" id="3760351">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3760355">panic</span><span class="op" id="3760360">(</span><span class="string" id="3760361">&#34;underflow&#34;</span><span class="op" id="3760372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760375">case</span>&nbsp;<span class="ident" id="3760380"><a href="/math/big/nat.go.html#3760304">m</a></span>&nbsp;<span class="op" id="3760382">==</span>&nbsp;<span class="num" id="3760385">0</span><span class="op" id="3760386">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3760390">//&nbsp;n&nbsp;==&nbsp;0&nbsp;because&nbsp;m&nbsp;&gt;=&nbsp;n;&nbsp;result&nbsp;is&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760430">return</span>&nbsp;<span class="ident" id="3760437"><a href="/math/big/nat.go.html#3760276">z</a></span><span class="op" id="3760438">.</span><span class="builtinfunc" id="3760439">make</span><span class="op" id="3760443">(</span><span class="num" id="3760444">0</span><span class="op" id="3760445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760448">case</span>&nbsp;<span class="ident" id="3760453"><a href="/math/big/nat.go.html#3760317">n</a></span>&nbsp;<span class="op" id="3760455">==</span>&nbsp;<span class="num" id="3760458">0</span><span class="op" id="3760459">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3760463">//&nbsp;result&nbsp;is&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760480">return</span>&nbsp;<span class="ident" id="3760487"><a href="/math/big/nat.go.html#3760276">z</a></span><span class="op" id="3760488">.</span><span class="ident" id="3760489">set</span><span class="op" id="3760492">(</span><span class="ident" id="3760493"><a href="/math/big/nat.go.html#3760287">x</a></span><span class="op" id="3760494">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3760497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3760500">//&nbsp;m&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760511"><a href="/math/big/nat.go.html#3760276">z</a></span>&nbsp;<span class="op" id="3760513">=</span>&nbsp;<span class="ident" id="3760515"><a href="/math/big/nat.go.html#3760276">z</a></span><span class="op" id="3760516">.</span><span class="builtinfunc" id="3760517">make</span><span class="op" id="3760521">(</span><span class="ident" id="3760522"><a href="/math/big/nat.go.html#3760304">m</a></span><span class="op" id="3760523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760526">c</span>&nbsp;<span class="op" id="3760528">:=</span>&nbsp;<span class="ident" id="3760531"><a href="/math/big/arith_decl.go.html#3731944">subVV</a></span><span class="op" id="3760536">(</span><span class="ident" id="3760537"><a href="/math/big/nat.go.html#3760276">z</a></span><span class="op" id="3760538">[</span><span class="num" id="3760539">0</span><span class="op" id="3760540">:</span><span class="ident" id="3760541"><a href="/math/big/nat.go.html#3760317">n</a></span><span class="op" id="3760542">]</span><span class="op" id="3760543">,</span>&nbsp;<span class="ident" id="3760545"><a href="/math/big/nat.go.html#3760287">x</a></span><span class="op" id="3760546">,</span>&nbsp;<span class="ident" id="3760548"><a href="/math/big/nat.go.html#3760290">y</a></span><span class="op" id="3760549">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760552">if</span>&nbsp;<span class="ident" id="3760555"><a href="/math/big/nat.go.html#3760304">m</a></span>&nbsp;<span class="op" id="3760557">&gt;</span>&nbsp;<span class="ident" id="3760559"><a href="/math/big/nat.go.html#3760317">n</a></span>&nbsp;<span class="op" id="3760561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760565"><a href="/math/big/nat.go.html#3760526">c</a></span>&nbsp;<span class="op" id="3760567">=</span>&nbsp;<span class="ident" id="3760569"><a href="/math/big/arith_decl.go.html#3732021">subVW</a></span><span class="op" id="3760574">(</span><span class="ident" id="3760575"><a href="/math/big/nat.go.html#3760276">z</a></span><span class="op" id="3760576">[</span><span class="ident" id="3760577"><a href="/math/big/nat.go.html#3760317">n</a></span><span class="op" id="3760578">:</span><span class="op" id="3760579">]</span><span class="op" id="3760580">,</span>&nbsp;<span class="ident" id="3760582"><a href="/math/big/nat.go.html#3760287">x</a></span><span class="op" id="3760583">[</span><span class="ident" id="3760584"><a href="/math/big/nat.go.html#3760317">n</a></span><span class="op" id="3760585">:</span><span class="op" id="3760586">]</span><span class="op" id="3760587">,</span>&nbsp;<span class="ident" id="3760589"><a href="/math/big/nat.go.html#3760526">c</a></span><span class="op" id="3760590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3760593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760596">if</span>&nbsp;<span class="ident" id="3760599"><a href="/math/big/nat.go.html#3760526">c</a></span>&nbsp;<span class="op" id="3760601">!=</span>&nbsp;<span class="num" id="3760604">0</span>&nbsp;<span class="op" id="3760606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3760610">panic</span><span class="op" id="3760615">(</span><span class="string" id="3760616">&#34;underflow&#34;</span><span class="op" id="3760627">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3760630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760634">return</span>&nbsp;<span class="ident" id="3760641"><a href="/math/big/nat.go.html#3760276">z</a></span><span class="op" id="3760642">.</span><span class="ident" id="3760643">norm</span><span class="op" id="3760647">(</span><span class="op" id="3760648">)</span><br>
<span class="lineno"></span><span class="op" id="3760650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="3760653">func</span>&nbsp;<span class="op" id="3760658">(</span><span class="ident" id="3760659">x</span>&nbsp;<span class="ident" id="3760661"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3760664">)</span>&nbsp;<span class="ident" id="3760666">cmp</span><span class="op" id="3760669">(</span><span class="ident" id="3760670">y</span>&nbsp;<span class="ident" id="3760672"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3760675">)</span>&nbsp;<span class="op" id="3760677">(</span><span class="ident" id="3760678">r</span>&nbsp;<span class="builtintype" id="3760680">int</span><span class="op" id="3760683">)</span>&nbsp;<span class="op" id="3760685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760688">m</span>&nbsp;<span class="op" id="3760690">:=</span>&nbsp;<span class="builtinfunc" id="3760693">len</span><span class="op" id="3760696">(</span><span class="ident" id="3760697"><a href="/math/big/nat.go.html#3760659">x</a></span><span class="op" id="3760698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760701">n</span>&nbsp;<span class="op" id="3760703">:=</span>&nbsp;<span class="builtinfunc" id="3760706">len</span><span class="op" id="3760709">(</span><span class="ident" id="3760710"><a href="/math/big/nat.go.html#3760670">y</a></span><span class="op" id="3760711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760714">if</span>&nbsp;<span class="ident" id="3760717"><a href="/math/big/nat.go.html#3760688">m</a></span>&nbsp;<span class="op" id="3760719">!=</span>&nbsp;<span class="ident" id="3760722"><a href="/math/big/nat.go.html#3760701">n</a></span>&nbsp;<span class="op" id="3760724">||</span>&nbsp;<span class="ident" id="3760727"><a href="/math/big/nat.go.html#3760688">m</a></span>&nbsp;<span class="op" id="3760729">==</span>&nbsp;<span class="num" id="3760732">0</span>&nbsp;<span class="op" id="3760734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760738">switch</span>&nbsp;<span class="op" id="3760745">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760749">case</span>&nbsp;<span class="ident" id="3760754"><a href="/math/big/nat.go.html#3760688">m</a></span>&nbsp;<span class="op" id="3760756">&lt;</span>&nbsp;<span class="ident" id="3760758"><a href="/math/big/nat.go.html#3760701">n</a></span><span class="op" id="3760759">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760764"><a href="/math/big/nat.go.html#3760678">r</a></span>&nbsp;<span class="op" id="3760766">=</span>&nbsp;<span class="op" id="3760768">-</span><span class="num" id="3760769">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760773">case</span>&nbsp;<span class="ident" id="3760778"><a href="/math/big/nat.go.html#3760688">m</a></span>&nbsp;<span class="op" id="3760780">&gt;</span>&nbsp;<span class="ident" id="3760782"><a href="/math/big/nat.go.html#3760701">n</a></span><span class="op" id="3760783">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760788"><a href="/math/big/nat.go.html#3760678">r</a></span>&nbsp;<span class="op" id="3760790">=</span>&nbsp;<span class="num" id="3760792">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3760796">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760800">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3760808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760812">i</span>&nbsp;<span class="op" id="3760814">:=</span>&nbsp;<span class="ident" id="3760817"><a href="/math/big/nat.go.html#3760688">m</a></span>&nbsp;<span class="op" id="3760819">-</span>&nbsp;<span class="num" id="3760821">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760824">for</span>&nbsp;<span class="ident" id="3760828"><a href="/math/big/nat.go.html#3760812">i</a></span>&nbsp;<span class="op" id="3760830">&gt;</span>&nbsp;<span class="num" id="3760832">0</span>&nbsp;<span class="op" id="3760834">&amp;&amp;</span>&nbsp;<span class="ident" id="3760837"><a href="/math/big/nat.go.html#3760659">x</a></span><span class="op" id="3760838">[</span><span class="ident" id="3760839"><a href="/math/big/nat.go.html#3760812">i</a></span><span class="op" id="3760840">]</span>&nbsp;<span class="op" id="3760842">==</span>&nbsp;<span class="ident" id="3760845"><a href="/math/big/nat.go.html#3760670">y</a></span><span class="op" id="3760846">[</span><span class="ident" id="3760847"><a href="/math/big/nat.go.html#3760812">i</a></span><span class="op" id="3760848">]</span>&nbsp;<span class="op" id="3760850">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760854"><a href="/math/big/nat.go.html#3760812">i</a></span><span class="op" id="3760855">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3760859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760863">switch</span>&nbsp;<span class="op" id="3760870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760873">case</span>&nbsp;<span class="ident" id="3760878"><a href="/math/big/nat.go.html#3760659">x</a></span><span class="op" id="3760879">[</span><span class="ident" id="3760880"><a href="/math/big/nat.go.html#3760812">i</a></span><span class="op" id="3760881">]</span>&nbsp;<span class="op" id="3760883">&lt;</span>&nbsp;<span class="ident" id="3760885"><a href="/math/big/nat.go.html#3760670">y</a></span><span class="op" id="3760886">[</span><span class="ident" id="3760887"><a href="/math/big/nat.go.html#3760812">i</a></span><span class="op" id="3760888">]</span><span class="op" id="3760889">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760893"><a href="/math/big/nat.go.html#3760678">r</a></span>&nbsp;<span class="op" id="3760895">=</span>&nbsp;<span class="op" id="3760897">-</span><span class="num" id="3760898">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760901">case</span>&nbsp;<span class="ident" id="3760906"><a href="/math/big/nat.go.html#3760659">x</a></span><span class="op" id="3760907">[</span><span class="ident" id="3760908"><a href="/math/big/nat.go.html#3760812">i</a></span><span class="op" id="3760909">]</span>&nbsp;<span class="op" id="3760911">&gt;</span>&nbsp;<span class="ident" id="3760913"><a href="/math/big/nat.go.html#3760670">y</a></span><span class="op" id="3760914">[</span><span class="ident" id="3760915"><a href="/math/big/nat.go.html#3760812">i</a></span><span class="op" id="3760916">]</span><span class="op" id="3760917">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760921"><a href="/math/big/nat.go.html#3760678">r</a></span>&nbsp;<span class="op" id="3760923">=</span>&nbsp;<span class="num" id="3760925">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3760928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760931">return</span><br>
<span class="lineno">195</span><span class="op" id="3760938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3760941">func</span>&nbsp;<span class="op" id="3760946">(</span><span class="ident" id="3760947">z</span>&nbsp;<span class="ident" id="3760949"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3760952">)</span>&nbsp;<span class="ident" id="3760954">mulAddWW</span><span class="op" id="3760962">(</span><span class="ident" id="3760963">x</span>&nbsp;<span class="ident" id="3760965"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3760968">,</span>&nbsp;<span class="ident" id="3760970">y</span><span class="op" id="3760971">,</span>&nbsp;<span class="ident" id="3760973">r</span>&nbsp;<span class="ident" id="3760975"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3760979">)</span>&nbsp;<span class="ident" id="3760981"><a href="/math/big/nat.go.html#3758892">nat</a></span>&nbsp;<span class="op" id="3760985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760988">m</span>&nbsp;<span class="op" id="3760990">:=</span>&nbsp;<span class="builtinfunc" id="3760993">len</span><span class="op" id="3760996">(</span><span class="ident" id="3760997"><a href="/math/big/nat.go.html#3760963">x</a></span><span class="op" id="3760998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761001">if</span>&nbsp;<span class="ident" id="3761004"><a href="/math/big/nat.go.html#3760988">m</a></span>&nbsp;<span class="op" id="3761006">==</span>&nbsp;<span class="num" id="3761009">0</span>&nbsp;<span class="op" id="3761011">||</span>&nbsp;<span class="ident" id="3761014"><a href="/math/big/nat.go.html#3760970">y</a></span>&nbsp;<span class="op" id="3761016">==</span>&nbsp;<span class="num" id="3761019">0</span>&nbsp;<span class="op" id="3761021">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761025">return</span>&nbsp;<span class="ident" id="3761032"><a href="/math/big/nat.go.html#3760947">z</a></span><span class="op" id="3761033">.</span><span class="ident" id="3761034">setWord</span><span class="op" id="3761041">(</span><span class="ident" id="3761042"><a href="/math/big/nat.go.html#3760973">r</a></span><span class="op" id="3761043">)</span>&nbsp;<span class="comment" id="3761045">//&nbsp;result&nbsp;is&nbsp;r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3761064">//&nbsp;m&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761075"><a href="/math/big/nat.go.html#3760947">z</a></span>&nbsp;<span class="op" id="3761077">=</span>&nbsp;<span class="ident" id="3761079"><a href="/math/big/nat.go.html#3760947">z</a></span><span class="op" id="3761080">.</span><span class="builtinfunc" id="3761081">make</span><span class="op" id="3761085">(</span><span class="ident" id="3761086"><a href="/math/big/nat.go.html#3760988">m</a></span>&nbsp;<span class="op" id="3761088">+</span>&nbsp;<span class="num" id="3761090">1</span><span class="op" id="3761091">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761094"><a href="/math/big/nat.go.html#3760947">z</a></span><span class="op" id="3761095">[</span><span class="ident" id="3761096"><a href="/math/big/nat.go.html#3760988">m</a></span><span class="op" id="3761097">]</span>&nbsp;<span class="op" id="3761099">=</span>&nbsp;<span class="ident" id="3761101"><a href="/math/big/arith_decl.go.html#3732144">mulAddVWW</a></span><span class="op" id="3761110">(</span><span class="ident" id="3761111"><a href="/math/big/nat.go.html#3760947">z</a></span><span class="op" id="3761112">[</span><span class="num" id="3761113">0</span><span class="op" id="3761114">:</span><span class="ident" id="3761115"><a href="/math/big/nat.go.html#3760988">m</a></span><span class="op" id="3761116">]</span><span class="op" id="3761117">,</span>&nbsp;<span class="ident" id="3761119"><a href="/math/big/nat.go.html#3760963">x</a></span><span class="op" id="3761120">,</span>&nbsp;<span class="ident" id="3761122"><a href="/math/big/nat.go.html#3760970">y</a></span><span class="op" id="3761123">,</span>&nbsp;<span class="ident" id="3761125"><a href="/math/big/nat.go.html#3760973">r</a></span><span class="op" id="3761126">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761130">return</span>&nbsp;<span class="ident" id="3761137"><a href="/math/big/nat.go.html#3760947">z</a></span><span class="op" id="3761138">.</span><span class="ident" id="3761139">norm</span><span class="op" id="3761143">(</span><span class="op" id="3761144">)</span><br>
<span class="lineno"></span><span class="op" id="3761146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="comment" id="3761149">//&nbsp;basicMul&nbsp;multiplies&nbsp;x&nbsp;and&nbsp;y&nbsp;and&nbsp;leaves&nbsp;the&nbsp;result&nbsp;in&nbsp;z.</span><br>
<span class="lineno"></span><span class="comment" id="3761208">//&nbsp;The&nbsp;(non-normalized)&nbsp;result&nbsp;is&nbsp;placed&nbsp;in&nbsp;z[0&nbsp;:&nbsp;len(x)&nbsp;+&nbsp;len(y)].</span><br>
<span class="lineno"></span><span class="keyword" id="3761276">func</span>&nbsp;<span class="ident" id="3761281">basicMul</span><span class="op" id="3761289">(</span><span class="ident" id="3761290">z</span><span class="op" id="3761291">,</span>&nbsp;<span class="ident" id="3761293">x</span><span class="op" id="3761294">,</span>&nbsp;<span class="ident" id="3761296">y</span>&nbsp;<span class="ident" id="3761298"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3761301">)</span>&nbsp;<span class="op" id="3761303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761306"><a href="/math/big/nat.go.html#3761290">z</a></span><span class="op" id="3761307">[</span><span class="num" id="3761308">0</span>&nbsp;<span class="op" id="3761310">:</span>&nbsp;<span class="builtinfunc" id="3761312">len</span><span class="op" id="3761315">(</span><span class="ident" id="3761316"><a href="/math/big/nat.go.html#3761293">x</a></span><span class="op" id="3761317">)</span><span class="op" id="3761318">+</span><span class="builtinfunc" id="3761319">len</span><span class="op" id="3761322">(</span><span class="ident" id="3761323"><a href="/math/big/nat.go.html#3761296">y</a></span><span class="op" id="3761324">)</span><span class="op" id="3761325">]</span><span class="op" id="3761326">.</span><span class="ident" id="3761327">clear</span><span class="op" id="3761332">(</span><span class="op" id="3761333">)</span>&nbsp;<span class="comment" id="3761335">//&nbsp;initialize&nbsp;z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761352">for</span>&nbsp;<span class="ident" id="3761356">i</span><span class="op" id="3761357">,</span>&nbsp;<span class="ident" id="3761359">d</span>&nbsp;<span class="op" id="3761361">:=</span>&nbsp;<span class="keyword" id="3761364">range</span>&nbsp;<span class="ident" id="3761370"><a href="/math/big/nat.go.html#3761296">y</a></span>&nbsp;<span class="op" id="3761372">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761376">if</span>&nbsp;<span class="ident" id="3761379"><a href="/math/big/nat.go.html#3761359">d</a></span>&nbsp;<span class="op" id="3761381">!=</span>&nbsp;<span class="num" id="3761384">0</span>&nbsp;<span class="op" id="3761386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761391"><a href="/math/big/nat.go.html#3761290">z</a></span><span class="op" id="3761392">[</span><span class="builtinfunc" id="3761393">len</span><span class="op" id="3761396">(</span><span class="ident" id="3761397"><a href="/math/big/nat.go.html#3761293">x</a></span><span class="op" id="3761398">)</span><span class="op" id="3761399">+</span><span class="ident" id="3761400"><a href="/math/big/nat.go.html#3761356">i</a></span><span class="op" id="3761401">]</span>&nbsp;<span class="op" id="3761403">=</span>&nbsp;<span class="ident" id="3761405"><a href="/math/big/arith_decl.go.html#3732192">addMulVVW</a></span><span class="op" id="3761414">(</span><span class="ident" id="3761415"><a href="/math/big/nat.go.html#3761290">z</a></span><span class="op" id="3761416">[</span><span class="ident" id="3761417"><a href="/math/big/nat.go.html#3761356">i</a></span><span class="op" id="3761418">:</span><span class="ident" id="3761419"><a href="/math/big/nat.go.html#3761356">i</a></span><span class="op" id="3761420">+</span><span class="builtinfunc" id="3761421">len</span><span class="op" id="3761424">(</span><span class="ident" id="3761425"><a href="/math/big/nat.go.html#3761293">x</a></span><span class="op" id="3761426">)</span><span class="op" id="3761427">]</span><span class="op" id="3761428">,</span>&nbsp;<span class="ident" id="3761430"><a href="/math/big/nat.go.html#3761293">x</a></span><span class="op" id="3761431">,</span>&nbsp;<span class="ident" id="3761433"><a href="/math/big/nat.go.html#3761359">d</a></span><span class="op" id="3761434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761441">}</span><br>
<span class="lineno"></span><span class="op" id="3761443">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="3761446">//&nbsp;Fast&nbsp;version&nbsp;of&nbsp;z[0:n+n&gt;&gt;1].add(z[0:n+n&gt;&gt;1],&nbsp;x[0:n])&nbsp;w/o&nbsp;bounds&nbsp;checks.</span><br>
<span class="lineno"></span><span class="comment" id="3761521">//&nbsp;Factored&nbsp;out&nbsp;for&nbsp;readability&nbsp;-&nbsp;do&nbsp;not&nbsp;use&nbsp;outside&nbsp;karatsuba.</span><br>
<span class="lineno"></span><span class="keyword" id="3761585">func</span>&nbsp;<span class="ident" id="3761590">karatsubaAdd</span><span class="op" id="3761602">(</span><span class="ident" id="3761603">z</span><span class="op" id="3761604">,</span>&nbsp;<span class="ident" id="3761606">x</span>&nbsp;<span class="ident" id="3761608"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3761611">,</span>&nbsp;<span class="ident" id="3761613">n</span>&nbsp;<span class="builtintype" id="3761615">int</span><span class="op" id="3761618">)</span>&nbsp;<span class="op" id="3761620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761623">if</span>&nbsp;<span class="ident" id="3761626">c</span>&nbsp;<span class="op" id="3761628">:=</span>&nbsp;<span class="ident" id="3761631"><a href="/math/big/arith_decl.go.html#3731908">addVV</a></span><span class="op" id="3761636">(</span><span class="ident" id="3761637"><a href="/math/big/nat.go.html#3761603">z</a></span><span class="op" id="3761638">[</span><span class="num" id="3761639">0</span><span class="op" id="3761640">:</span><span class="ident" id="3761641"><a href="/math/big/nat.go.html#3761613">n</a></span><span class="op" id="3761642">]</span><span class="op" id="3761643">,</span>&nbsp;<span class="ident" id="3761645"><a href="/math/big/nat.go.html#3761603">z</a></span><span class="op" id="3761646">,</span>&nbsp;<span class="ident" id="3761648"><a href="/math/big/nat.go.html#3761606">x</a></span><span class="op" id="3761649">)</span><span class="op" id="3761650">;</span>&nbsp;<span class="ident" id="3761652"><a href="/math/big/nat.go.html#3761626">c</a></span>&nbsp;<span class="op" id="3761654">!=</span>&nbsp;<span class="num" id="3761657">0</span>&nbsp;<span class="op" id="3761659">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761663"><a href="/math/big/arith_decl.go.html#3731980">addVW</a></span><span class="op" id="3761668">(</span><span class="ident" id="3761669"><a href="/math/big/nat.go.html#3761603">z</a></span><span class="op" id="3761670">[</span><span class="ident" id="3761671"><a href="/math/big/nat.go.html#3761613">n</a></span><span class="op" id="3761672">:</span><span class="ident" id="3761673"><a href="/math/big/nat.go.html#3761613">n</a></span><span class="op" id="3761674">+</span><span class="ident" id="3761675"><a href="/math/big/nat.go.html#3761613">n</a></span><span class="op" id="3761676">&gt;&gt;</span><span class="num" id="3761678">1</span><span class="op" id="3761679">]</span><span class="op" id="3761680">,</span>&nbsp;<span class="ident" id="3761682"><a href="/math/big/nat.go.html#3761603">z</a></span><span class="op" id="3761683">[</span><span class="ident" id="3761684"><a href="/math/big/nat.go.html#3761613">n</a></span><span class="op" id="3761685">:</span><span class="op" id="3761686">]</span><span class="op" id="3761687">,</span>&nbsp;<span class="ident" id="3761689"><a href="/math/big/nat.go.html#3761626">c</a></span><span class="op" id="3761690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761693">}</span><br>
<span class="lineno"></span><span class="op" id="3761695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3761698">//&nbsp;Like&nbsp;karatsubaAdd,&nbsp;but&nbsp;does&nbsp;subtract.</span><br>
<span class="lineno">230</span><span class="keyword" id="3761739">func</span>&nbsp;<span class="ident" id="3761744">karatsubaSub</span><span class="op" id="3761756">(</span><span class="ident" id="3761757">z</span><span class="op" id="3761758">,</span>&nbsp;<span class="ident" id="3761760">x</span>&nbsp;<span class="ident" id="3761762"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3761765">,</span>&nbsp;<span class="ident" id="3761767">n</span>&nbsp;<span class="builtintype" id="3761769">int</span><span class="op" id="3761772">)</span>&nbsp;<span class="op" id="3761774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761777">if</span>&nbsp;<span class="ident" id="3761780">c</span>&nbsp;<span class="op" id="3761782">:=</span>&nbsp;<span class="ident" id="3761785"><a href="/math/big/arith_decl.go.html#3731944">subVV</a></span><span class="op" id="3761790">(</span><span class="ident" id="3761791"><a href="/math/big/nat.go.html#3761757">z</a></span><span class="op" id="3761792">[</span><span class="num" id="3761793">0</span><span class="op" id="3761794">:</span><span class="ident" id="3761795"><a href="/math/big/nat.go.html#3761767">n</a></span><span class="op" id="3761796">]</span><span class="op" id="3761797">,</span>&nbsp;<span class="ident" id="3761799"><a href="/math/big/nat.go.html#3761757">z</a></span><span class="op" id="3761800">,</span>&nbsp;<span class="ident" id="3761802"><a href="/math/big/nat.go.html#3761760">x</a></span><span class="op" id="3761803">)</span><span class="op" id="3761804">;</span>&nbsp;<span class="ident" id="3761806"><a href="/math/big/nat.go.html#3761780">c</a></span>&nbsp;<span class="op" id="3761808">!=</span>&nbsp;<span class="num" id="3761811">0</span>&nbsp;<span class="op" id="3761813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761817"><a href="/math/big/arith_decl.go.html#3732021">subVW</a></span><span class="op" id="3761822">(</span><span class="ident" id="3761823"><a href="/math/big/nat.go.html#3761757">z</a></span><span class="op" id="3761824">[</span><span class="ident" id="3761825"><a href="/math/big/nat.go.html#3761767">n</a></span><span class="op" id="3761826">:</span><span class="ident" id="3761827"><a href="/math/big/nat.go.html#3761767">n</a></span><span class="op" id="3761828">+</span><span class="ident" id="3761829"><a href="/math/big/nat.go.html#3761767">n</a></span><span class="op" id="3761830">&gt;&gt;</span><span class="num" id="3761832">1</span><span class="op" id="3761833">]</span><span class="op" id="3761834">,</span>&nbsp;<span class="ident" id="3761836"><a href="/math/big/nat.go.html#3761757">z</a></span><span class="op" id="3761837">[</span><span class="ident" id="3761838"><a href="/math/big/nat.go.html#3761767">n</a></span><span class="op" id="3761839">:</span><span class="op" id="3761840">]</span><span class="op" id="3761841">,</span>&nbsp;<span class="ident" id="3761843"><a href="/math/big/nat.go.html#3761780">c</a></span><span class="op" id="3761844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761847">}</span><br>
<span class="lineno"></span><span class="op" id="3761849">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="comment" id="3761852">//&nbsp;Operands&nbsp;that&nbsp;are&nbsp;shorter&nbsp;than&nbsp;karatsubaThreshold&nbsp;are&nbsp;multiplied&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="3761926">//&nbsp;&#34;grade&nbsp;school&#34;&nbsp;multiplication;&nbsp;for&nbsp;longer&nbsp;operands&nbsp;the&nbsp;Karatsuba&nbsp;algorithm</span><br>
<span class="lineno"></span><span class="comment" id="3762004">//&nbsp;is&nbsp;used.</span><br>
<span class="lineno"></span><span class="keyword" id="3762016">var</span>&nbsp;<span class="ident" id="3762020">karatsubaThreshold</span>&nbsp;<span class="builtintype" id="3762039">int</span>&nbsp;<span class="op" id="3762043">=</span>&nbsp;<span class="num" id="3762045">40</span>&nbsp;<span class="comment" id="3762048">//&nbsp;computed&nbsp;by&nbsp;calibrate.go</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="comment" id="3762077">//&nbsp;karatsuba&nbsp;multiplies&nbsp;x&nbsp;and&nbsp;y&nbsp;and&nbsp;leaves&nbsp;the&nbsp;result&nbsp;in&nbsp;z.</span><br>
<span class="lineno"></span><span class="comment" id="3762137">//&nbsp;Both&nbsp;x&nbsp;and&nbsp;y&nbsp;must&nbsp;have&nbsp;the&nbsp;same&nbsp;length&nbsp;n&nbsp;and&nbsp;n&nbsp;must&nbsp;be&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3762197">//&nbsp;power&nbsp;of&nbsp;2.&nbsp;The&nbsp;result&nbsp;vector&nbsp;z&nbsp;must&nbsp;have&nbsp;len(z)&nbsp;&gt;=&nbsp;6*n.</span><br>
<span class="lineno"></span><span class="comment" id="3762257">//&nbsp;The&nbsp;(non-normalized)&nbsp;result&nbsp;is&nbsp;placed&nbsp;in&nbsp;z[0&nbsp;:&nbsp;2*n].</span><br>
<span class="lineno">245</span><span class="keyword" id="3762313">func</span>&nbsp;<span class="ident" id="3762318">karatsuba</span><span class="op" id="3762327">(</span><span class="ident" id="3762328">z</span><span class="op" id="3762329">,</span>&nbsp;<span class="ident" id="3762331">x</span><span class="op" id="3762332">,</span>&nbsp;<span class="ident" id="3762334">y</span>&nbsp;<span class="ident" id="3762336"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3762339">)</span>&nbsp;<span class="op" id="3762341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3762344">n</span>&nbsp;<span class="op" id="3762346">:=</span>&nbsp;<span class="builtinfunc" id="3762349">len</span><span class="op" id="3762352">(</span><span class="ident" id="3762353"><a href="/math/big/nat.go.html#3762334">y</a></span><span class="op" id="3762354">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3762358">//&nbsp;Switch&nbsp;to&nbsp;basic&nbsp;multiplication&nbsp;if&nbsp;numbers&nbsp;are&nbsp;odd&nbsp;or&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3762422">//&nbsp;(n&nbsp;is&nbsp;always&nbsp;even&nbsp;if&nbsp;karatsubaThreshold&nbsp;is&nbsp;even,&nbsp;but&nbsp;be</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3762482">//&nbsp;conservative)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3762500">if</span>&nbsp;<span class="ident" id="3762503"><a href="/math/big/nat.go.html#3762344">n</a></span><span class="op" id="3762504">&amp;</span><span class="num" id="3762505">1</span>&nbsp;<span class="op" id="3762507">!=</span>&nbsp;<span class="num" id="3762510">0</span>&nbsp;<span class="op" id="3762512">||</span>&nbsp;<span class="ident" id="3762515"><a href="/math/big/nat.go.html#3762344">n</a></span>&nbsp;<span class="op" id="3762517">&lt;</span>&nbsp;<span class="ident" id="3762519"><a href="/math/big/nat.go.html#3762020">karatsubaThreshold</a></span>&nbsp;<span class="op" id="3762538">||</span>&nbsp;<span class="ident" id="3762541"><a href="/math/big/nat.go.html#3762344">n</a></span>&nbsp;<span class="op" id="3762543">&lt;</span>&nbsp;<span class="num" id="3762545">2</span>&nbsp;<span class="op" id="3762547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3762551"><a href="/math/big/nat.go.html#3761281">basicMul</a></span><span class="op" id="3762559">(</span><span class="ident" id="3762560"><a href="/math/big/nat.go.html#3762328">z</a></span><span class="op" id="3762561">,</span>&nbsp;<span class="ident" id="3762563"><a href="/math/big/nat.go.html#3762331">x</a></span><span class="op" id="3762564">,</span>&nbsp;<span class="ident" id="3762566"><a href="/math/big/nat.go.html#3762334">y</a></span><span class="op" id="3762567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3762571">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3762579">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3762582">//&nbsp;n&amp;1&nbsp;==&nbsp;0&nbsp;&amp;&amp;&nbsp;n&nbsp;&gt;=&nbsp;karatsubaThreshold&nbsp;&amp;&amp;&nbsp;n&nbsp;&gt;=&nbsp;2</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3762633">//&nbsp;Karatsuba&nbsp;multiplication&nbsp;is&nbsp;based&nbsp;on&nbsp;the&nbsp;observation&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3762695">//&nbsp;for&nbsp;two&nbsp;numbers&nbsp;x&nbsp;and&nbsp;y&nbsp;with:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3762729">//</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3762733">//&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;x1*b&nbsp;+&nbsp;x0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3762753">//&nbsp;&nbsp;&nbsp;y&nbsp;=&nbsp;y1*b&nbsp;+&nbsp;y0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3762773">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3762777">//&nbsp;the&nbsp;product&nbsp;x*y&nbsp;can&nbsp;be&nbsp;obtained&nbsp;with&nbsp;3&nbsp;products&nbsp;z2,&nbsp;z1,&nbsp;z0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3762840">//&nbsp;instead&nbsp;of&nbsp;4:</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3762858">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3762862">//&nbsp;&nbsp;&nbsp;x*y&nbsp;=&nbsp;x1*y1*b*b&nbsp;+&nbsp;(x1*y0&nbsp;+&nbsp;x0*y1)*b&nbsp;+&nbsp;x0*y0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3762912">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;z2*b*b&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z1*b&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;z0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3762962">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3762966">//&nbsp;with:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3762976">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3762980">//&nbsp;&nbsp;&nbsp;xd&nbsp;=&nbsp;x1&nbsp;-&nbsp;x0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3762999">//&nbsp;&nbsp;&nbsp;yd&nbsp;=&nbsp;y0&nbsp;-&nbsp;y1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3763018">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3763022">//&nbsp;&nbsp;&nbsp;z1&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xd*yd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;z2&nbsp;+&nbsp;z0</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3763073">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;(x1-x0)*(y0&nbsp;-&nbsp;y1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;z2&nbsp;+&nbsp;z0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3763124">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;x1*y0&nbsp;-&nbsp;x1*y1&nbsp;-&nbsp;x0*y0&nbsp;+&nbsp;x0*y1&nbsp;+&nbsp;z2&nbsp;+&nbsp;z0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3763175">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;x1*y0&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;z2&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;z0&nbsp;+&nbsp;x0*y1&nbsp;+&nbsp;z2&nbsp;+&nbsp;z0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3763226">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;x1*y0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;x0*y1</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3763268">//&nbsp;split&nbsp;x,&nbsp;y&nbsp;into&nbsp;&#34;digits&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3763297">n2</span>&nbsp;<span class="op" id="3763300">:=</span>&nbsp;<span class="ident" id="3763303"><a href="/math/big/nat.go.html#3762344">n</a></span>&nbsp;<span class="op" id="3763305">&gt;&gt;</span>&nbsp;<span class="num" id="3763308">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3763323">//&nbsp;n2&nbsp;&gt;=&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3763335">x1</span><span class="op" id="3763337">,</span>&nbsp;<span class="ident" id="3763339">x0</span>&nbsp;<span class="op" id="3763342">:=</span>&nbsp;<span class="ident" id="3763345"><a href="/math/big/nat.go.html#3762331">x</a></span><span class="op" id="3763346">[</span><span class="ident" id="3763347"><a href="/math/big/nat.go.html#3763297">n2</a></span><span class="op" id="3763349">:</span><span class="op" id="3763350">]</span><span class="op" id="3763351">,</span>&nbsp;<span class="ident" id="3763353"><a href="/math/big/nat.go.html#3762331">x</a></span><span class="op" id="3763354">[</span><span class="num" id="3763355">0</span><span class="op" id="3763356">:</span><span class="ident" id="3763357"><a href="/math/big/nat.go.html#3763297">n2</a></span><span class="op" id="3763359">]</span>&nbsp;<span class="comment" id="3763361">//&nbsp;x&nbsp;=&nbsp;x1*b&nbsp;+&nbsp;y0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3763379">y1</span><span class="op" id="3763381">,</span>&nbsp;<span class="ident" id="3763383">y0</span>&nbsp;<span class="op" id="3763386">:=</span>&nbsp;<span class="ident" id="3763389"><a href="/math/big/nat.go.html#3762334">y</a></span><span class="op" id="3763390">[</span><span class="ident" id="3763391"><a href="/math/big/nat.go.html#3763297">n2</a></span><span class="op" id="3763393">:</span><span class="op" id="3763394">]</span><span class="op" id="3763395">,</span>&nbsp;<span class="ident" id="3763397"><a href="/math/big/nat.go.html#3762334">y</a></span><span class="op" id="3763398">[</span><span class="num" id="3763399">0</span><span class="op" id="3763400">:</span><span class="ident" id="3763401"><a href="/math/big/nat.go.html#3763297">n2</a></span><span class="op" id="3763403">]</span>&nbsp;<span class="comment" id="3763405">//&nbsp;y&nbsp;=&nbsp;y1*b&nbsp;+&nbsp;y0</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3763424">//&nbsp;z&nbsp;is&nbsp;used&nbsp;for&nbsp;the&nbsp;result&nbsp;and&nbsp;temporary&nbsp;storage:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3763476">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3763480">//&nbsp;&nbsp;&nbsp;6*n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5*n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4*n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3*n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2*n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1*n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0*n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3763538">//&nbsp;z&nbsp;=&nbsp;[z2&nbsp;copy|z0&nbsp;copy|&nbsp;xd*yd&nbsp;|&nbsp;yd:xd&nbsp;|&nbsp;x1*y1&nbsp;|&nbsp;x0*y0&nbsp;]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3763596">//</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3763600">//&nbsp;For&nbsp;each&nbsp;recursive&nbsp;call&nbsp;of&nbsp;karatsuba,&nbsp;an&nbsp;unused&nbsp;slice&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3763661">//&nbsp;z&nbsp;is&nbsp;passed&nbsp;in&nbsp;that&nbsp;has&nbsp;(at&nbsp;least)&nbsp;half&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3763723">//&nbsp;caller&#39;s&nbsp;z.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3763740">//&nbsp;compute&nbsp;z0&nbsp;and&nbsp;z2&nbsp;with&nbsp;the&nbsp;result&nbsp;&#34;in&nbsp;place&#34;&nbsp;in&nbsp;z</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3763794"><a href="/math/big/nat.go.html#3762318">karatsuba</a></span><span class="op" id="3763803">(</span><span class="ident" id="3763804"><a href="/math/big/nat.go.html#3762328">z</a></span><span class="op" id="3763805">,</span>&nbsp;<span class="ident" id="3763807"><a href="/math/big/nat.go.html#3763339">x0</a></span><span class="op" id="3763809">,</span>&nbsp;<span class="ident" id="3763811"><a href="/math/big/nat.go.html#3763383">y0</a></span><span class="op" id="3763813">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3763819">//&nbsp;z0&nbsp;=&nbsp;x0*y0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3763834"><a href="/math/big/nat.go.html#3762318">karatsuba</a></span><span class="op" id="3763843">(</span><span class="ident" id="3763844"><a href="/math/big/nat.go.html#3762328">z</a></span><span class="op" id="3763845">[</span><span class="ident" id="3763846"><a href="/math/big/nat.go.html#3762344">n</a></span><span class="op" id="3763847">:</span><span class="op" id="3763848">]</span><span class="op" id="3763849">,</span>&nbsp;<span class="ident" id="3763851"><a href="/math/big/nat.go.html#3763335">x1</a></span><span class="op" id="3763853">,</span>&nbsp;<span class="ident" id="3763855"><a href="/math/big/nat.go.html#3763379">y1</a></span><span class="op" id="3763857">)</span>&nbsp;<span class="comment" id="3763859">//&nbsp;z2&nbsp;=&nbsp;x1*y1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3763875">//&nbsp;compute&nbsp;xd&nbsp;(or&nbsp;the&nbsp;negative&nbsp;value&nbsp;if&nbsp;underflow&nbsp;occurs)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3763934">s</span>&nbsp;<span class="op" id="3763936">:=</span>&nbsp;<span class="num" id="3763939">1</span>&nbsp;<span class="comment" id="3763941">//&nbsp;sign&nbsp;of&nbsp;product&nbsp;xd*yd</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3763967">xd</span>&nbsp;<span class="op" id="3763970">:=</span>&nbsp;<span class="ident" id="3763973"><a href="/math/big/nat.go.html#3762328">z</a></span><span class="op" id="3763974">[</span><span class="num" id="3763975">2</span><span class="op" id="3763976">*</span><span class="ident" id="3763977"><a href="/math/big/nat.go.html#3762344">n</a></span>&nbsp;<span class="op" id="3763979">:</span>&nbsp;<span class="num" id="3763981">2</span><span class="op" id="3763982">*</span><span class="ident" id="3763983"><a href="/math/big/nat.go.html#3762344">n</a></span><span class="op" id="3763984">+</span><span class="ident" id="3763985"><a href="/math/big/nat.go.html#3763297">n2</a></span><span class="op" id="3763987">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3763990">if</span>&nbsp;<span class="ident" id="3763993"><a href="/math/big/arith_decl.go.html#3731944">subVV</a></span><span class="op" id="3763998">(</span><span class="ident" id="3763999"><a href="/math/big/nat.go.html#3763967">xd</a></span><span class="op" id="3764001">,</span>&nbsp;<span class="ident" id="3764003"><a href="/math/big/nat.go.html#3763335">x1</a></span><span class="op" id="3764005">,</span>&nbsp;<span class="ident" id="3764007"><a href="/math/big/nat.go.html#3763339">x0</a></span><span class="op" id="3764009">)</span>&nbsp;<span class="op" id="3764011">!=</span>&nbsp;<span class="num" id="3764014">0</span>&nbsp;<span class="op" id="3764016">{</span>&nbsp;<span class="comment" id="3764018">//&nbsp;x1-x0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3764029"><a href="/math/big/nat.go.html#3763934">s</a></span>&nbsp;<span class="op" id="3764031">=</span>&nbsp;<span class="op" id="3764033">-</span><span class="ident" id="3764034"><a href="/math/big/nat.go.html#3763934">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3764038"><a href="/math/big/arith_decl.go.html#3731944">subVV</a></span><span class="op" id="3764043">(</span><span class="ident" id="3764044"><a href="/math/big/nat.go.html#3763967">xd</a></span><span class="op" id="3764046">,</span>&nbsp;<span class="ident" id="3764048"><a href="/math/big/nat.go.html#3763339">x0</a></span><span class="op" id="3764050">,</span>&nbsp;<span class="ident" id="3764052"><a href="/math/big/nat.go.html#3763335">x1</a></span><span class="op" id="3764054">)</span>&nbsp;<span class="comment" id="3764056">//&nbsp;x0-x1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3764066">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3764070">//&nbsp;compute&nbsp;yd&nbsp;(or&nbsp;the&nbsp;negative&nbsp;value&nbsp;if&nbsp;underflow&nbsp;occurs)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3764129">yd</span>&nbsp;<span class="op" id="3764132">:=</span>&nbsp;<span class="ident" id="3764135"><a href="/math/big/nat.go.html#3762328">z</a></span><span class="op" id="3764136">[</span><span class="num" id="3764137">2</span><span class="op" id="3764138">*</span><span class="ident" id="3764139"><a href="/math/big/nat.go.html#3762344">n</a></span><span class="op" id="3764140">+</span><span class="ident" id="3764141"><a href="/math/big/nat.go.html#3763297">n2</a></span>&nbsp;<span class="op" id="3764144">:</span>&nbsp;<span class="num" id="3764146">3</span><span class="op" id="3764147">*</span><span class="ident" id="3764148"><a href="/math/big/nat.go.html#3762344">n</a></span><span class="op" id="3764149">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3764152">if</span>&nbsp;<span class="ident" id="3764155"><a href="/math/big/arith_decl.go.html#3731944">subVV</a></span><span class="op" id="3764160">(</span><span class="ident" id="3764161"><a href="/math/big/nat.go.html#3764129">yd</a></span><span class="op" id="3764163">,</span>&nbsp;<span class="ident" id="3764165"><a href="/math/big/nat.go.html#3763383">y0</a></span><span class="op" id="3764167">,</span>&nbsp;<span class="ident" id="3764169"><a href="/math/big/nat.go.html#3763379">y1</a></span><span class="op" id="3764171">)</span>&nbsp;<span class="op" id="3764173">!=</span>&nbsp;<span class="num" id="3764176">0</span>&nbsp;<span class="op" id="3764178">{</span>&nbsp;<span class="comment" id="3764180">//&nbsp;y0-y1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3764191"><a href="/math/big/nat.go.html#3763934">s</a></span>&nbsp;<span class="op" id="3764193">=</span>&nbsp;<span class="op" id="3764195">-</span><span class="ident" id="3764196"><a href="/math/big/nat.go.html#3763934">s</a></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3764200"><a href="/math/big/arith_decl.go.html#3731944">subVV</a></span><span class="op" id="3764205">(</span><span class="ident" id="3764206"><a href="/math/big/nat.go.html#3764129">yd</a></span><span class="op" id="3764208">,</span>&nbsp;<span class="ident" id="3764210"><a href="/math/big/nat.go.html#3763379">y1</a></span><span class="op" id="3764212">,</span>&nbsp;<span class="ident" id="3764214"><a href="/math/big/nat.go.html#3763383">y0</a></span><span class="op" id="3764216">)</span>&nbsp;<span class="comment" id="3764218">//&nbsp;y1-y0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3764228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3764232">//&nbsp;p&nbsp;=&nbsp;(x1-x0)*(y0-y1)&nbsp;==&nbsp;x1*y0&nbsp;-&nbsp;x1*y1&nbsp;-&nbsp;x0*y0&nbsp;+&nbsp;x0*y1&nbsp;for&nbsp;s&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3764299">//&nbsp;p&nbsp;=&nbsp;(x0-x1)*(y0-y1)&nbsp;==&nbsp;x0*y0&nbsp;-&nbsp;x0*y1&nbsp;-&nbsp;x1*y0&nbsp;+&nbsp;x1*y1&nbsp;for&nbsp;s&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3764366">p</span>&nbsp;<span class="op" id="3764368">:=</span>&nbsp;<span class="ident" id="3764371"><a href="/math/big/nat.go.html#3762328">z</a></span><span class="op" id="3764372">[</span><span class="ident" id="3764373"><a href="/math/big/nat.go.html#3762344">n</a></span><span class="op" id="3764374">*</span><span class="num" id="3764375">3</span><span class="op" id="3764376">:</span><span class="op" id="3764377">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3764380"><a href="/math/big/nat.go.html#3762318">karatsuba</a></span><span class="op" id="3764389">(</span><span class="ident" id="3764390"><a href="/math/big/nat.go.html#3764366">p</a></span><span class="op" id="3764391">,</span>&nbsp;<span class="ident" id="3764393"><a href="/math/big/nat.go.html#3763967">xd</a></span><span class="op" id="3764395">,</span>&nbsp;<span class="ident" id="3764397"><a href="/math/big/nat.go.html#3764129">yd</a></span><span class="op" id="3764399">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3764403">//&nbsp;save&nbsp;original&nbsp;z2:z0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3764427">//&nbsp;(ok&nbsp;to&nbsp;use&nbsp;upper&nbsp;half&nbsp;of&nbsp;z&nbsp;since&nbsp;we&#39;re&nbsp;done&nbsp;recursing)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3764486">r</span>&nbsp;<span class="op" id="3764488">:=</span>&nbsp;<span class="ident" id="3764491"><a href="/math/big/nat.go.html#3762328">z</a></span><span class="op" id="3764492">[</span><span class="ident" id="3764493"><a href="/math/big/nat.go.html#3762344">n</a></span><span class="op" id="3764494">*</span><span class="num" id="3764495">4</span><span class="op" id="3764496">:</span><span class="op" id="3764497">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3764500">copy</span><span class="op" id="3764504">(</span><span class="ident" id="3764505"><a href="/math/big/nat.go.html#3764486">r</a></span><span class="op" id="3764506">,</span>&nbsp;<span class="ident" id="3764508"><a href="/math/big/nat.go.html#3762328">z</a></span><span class="op" id="3764509">[</span><span class="op" id="3764510">:</span><span class="ident" id="3764511"><a href="/math/big/nat.go.html#3762344">n</a></span><span class="op" id="3764512">*</span><span class="num" id="3764513">2</span><span class="op" id="3764514">]</span><span class="op" id="3764515">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3764519">//&nbsp;add&nbsp;up&nbsp;all&nbsp;partial&nbsp;products</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3764551">//</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3764555">//&nbsp;&nbsp;&nbsp;2*n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3764577">//&nbsp;z&nbsp;=&nbsp;[&nbsp;z2&nbsp;&nbsp;|&nbsp;z0&nbsp;&nbsp;]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3764599">//&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;z0&nbsp;&nbsp;]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3764618">//&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;z2&nbsp;&nbsp;]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3764637">//&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;&nbsp;p&nbsp;&nbsp;]</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3764656">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3764660"><a href="/math/big/nat.go.html#3761590">karatsubaAdd</a></span><span class="op" id="3764672">(</span><span class="ident" id="3764673"><a href="/math/big/nat.go.html#3762328">z</a></span><span class="op" id="3764674">[</span><span class="ident" id="3764675"><a href="/math/big/nat.go.html#3763297">n2</a></span><span class="op" id="3764677">:</span><span class="op" id="3764678">]</span><span class="op" id="3764679">,</span>&nbsp;<span class="ident" id="3764681"><a href="/math/big/nat.go.html#3764486">r</a></span><span class="op" id="3764682">,</span>&nbsp;<span class="ident" id="3764684"><a href="/math/big/nat.go.html#3762344">n</a></span><span class="op" id="3764685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3764688"><a href="/math/big/nat.go.html#3761590">karatsubaAdd</a></span><span class="op" id="3764700">(</span><span class="ident" id="3764701"><a href="/math/big/nat.go.html#3762328">z</a></span><span class="op" id="3764702">[</span><span class="ident" id="3764703"><a href="/math/big/nat.go.html#3763297">n2</a></span><span class="op" id="3764705">:</span><span class="op" id="3764706">]</span><span class="op" id="3764707">,</span>&nbsp;<span class="ident" id="3764709"><a href="/math/big/nat.go.html#3764486">r</a></span><span class="op" id="3764710">[</span><span class="ident" id="3764711"><a href="/math/big/nat.go.html#3762344">n</a></span><span class="op" id="3764712">:</span><span class="op" id="3764713">]</span><span class="op" id="3764714">,</span>&nbsp;<span class="ident" id="3764716"><a href="/math/big/nat.go.html#3762344">n</a></span><span class="op" id="3764717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3764720">if</span>&nbsp;<span class="ident" id="3764723"><a href="/math/big/nat.go.html#3763934">s</a></span>&nbsp;<span class="op" id="3764725">&gt;</span>&nbsp;<span class="num" id="3764727">0</span>&nbsp;<span class="op" id="3764729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3764733"><a href="/math/big/nat.go.html#3761590">karatsubaAdd</a></span><span class="op" id="3764745">(</span><span class="ident" id="3764746"><a href="/math/big/nat.go.html#3762328">z</a></span><span class="op" id="3764747">[</span><span class="ident" id="3764748"><a href="/math/big/nat.go.html#3763297">n2</a></span><span class="op" id="3764750">:</span><span class="op" id="3764751">]</span><span class="op" id="3764752">,</span>&nbsp;<span class="ident" id="3764754"><a href="/math/big/nat.go.html#3764366">p</a></span><span class="op" id="3764755">,</span>&nbsp;<span class="ident" id="3764757"><a href="/math/big/nat.go.html#3762344">n</a></span><span class="op" id="3764758">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3764761">}</span>&nbsp;<span class="keyword" id="3764763">else</span>&nbsp;<span class="op" id="3764768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3764772"><a href="/math/big/nat.go.html#3761744">karatsubaSub</a></span><span class="op" id="3764784">(</span><span class="ident" id="3764785"><a href="/math/big/nat.go.html#3762328">z</a></span><span class="op" id="3764786">[</span><span class="ident" id="3764787"><a href="/math/big/nat.go.html#3763297">n2</a></span><span class="op" id="3764789">:</span><span class="op" id="3764790">]</span><span class="op" id="3764791">,</span>&nbsp;<span class="ident" id="3764793"><a href="/math/big/nat.go.html#3764366">p</a></span><span class="op" id="3764794">,</span>&nbsp;<span class="ident" id="3764796"><a href="/math/big/nat.go.html#3762344">n</a></span><span class="op" id="3764797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3764800">}</span><br>
<span class="lineno"></span><span class="op" id="3764802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="comment" id="3764805">//&nbsp;alias&nbsp;returns&nbsp;true&nbsp;if&nbsp;x&nbsp;and&nbsp;y&nbsp;share&nbsp;the&nbsp;same&nbsp;base&nbsp;array.</span><br>
<span class="lineno"></span><span class="keyword" id="3764865">func</span>&nbsp;<span class="ident" id="3764870">alias</span><span class="op" id="3764875">(</span><span class="ident" id="3764876">x</span><span class="op" id="3764877">,</span>&nbsp;<span class="ident" id="3764879">y</span>&nbsp;<span class="ident" id="3764881"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3764884">)</span>&nbsp;<span class="builtintype" id="3764886">bool</span>&nbsp;<span class="op" id="3764891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3764894">return</span>&nbsp;<span class="builtinfunc" id="3764901">cap</span><span class="op" id="3764904">(</span><span class="ident" id="3764905"><a href="/math/big/nat.go.html#3764876">x</a></span><span class="op" id="3764906">)</span>&nbsp;<span class="op" id="3764908">&gt;</span>&nbsp;<span class="num" id="3764910">0</span>&nbsp;<span class="op" id="3764912">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3764915">cap</span><span class="op" id="3764918">(</span><span class="ident" id="3764919"><a href="/math/big/nat.go.html#3764879">y</a></span><span class="op" id="3764920">)</span>&nbsp;<span class="op" id="3764922">&gt;</span>&nbsp;<span class="num" id="3764924">0</span>&nbsp;<span class="op" id="3764926">&amp;&amp;</span>&nbsp;<span class="op" id="3764929">&amp;</span><span class="ident" id="3764930"><a href="/math/big/nat.go.html#3764876">x</a></span><span class="op" id="3764931">[</span><span class="num" id="3764932">0</span><span class="op" id="3764933">:</span><span class="builtinfunc" id="3764934">cap</span><span class="op" id="3764937">(</span><span class="ident" id="3764938"><a href="/math/big/nat.go.html#3764876">x</a></span><span class="op" id="3764939">)</span><span class="op" id="3764940">]</span><span class="op" id="3764941">[</span><span class="builtinfunc" id="3764942">cap</span><span class="op" id="3764945">(</span><span class="ident" id="3764946"><a href="/math/big/nat.go.html#3764876">x</a></span><span class="op" id="3764947">)</span><span class="op" id="3764948">-</span><span class="num" id="3764949">1</span><span class="op" id="3764950">]</span>&nbsp;<span class="op" id="3764952">==</span>&nbsp;<span class="op" id="3764955">&amp;</span><span class="ident" id="3764956"><a href="/math/big/nat.go.html#3764879">y</a></span><span class="op" id="3764957">[</span><span class="num" id="3764958">0</span><span class="op" id="3764959">:</span><span class="builtinfunc" id="3764960">cap</span><span class="op" id="3764963">(</span><span class="ident" id="3764964"><a href="/math/big/nat.go.html#3764879">y</a></span><span class="op" id="3764965">)</span><span class="op" id="3764966">]</span><span class="op" id="3764967">[</span><span class="builtinfunc" id="3764968">cap</span><span class="op" id="3764971">(</span><span class="ident" id="3764972"><a href="/math/big/nat.go.html#3764879">y</a></span><span class="op" id="3764973">)</span><span class="op" id="3764974">-</span><span class="num" id="3764975">1</span><span class="op" id="3764976">]</span><br>
<span class="lineno"></span><span class="op" id="3764978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="comment" id="3764981">//&nbsp;addAt&nbsp;implements&nbsp;z&nbsp;+=&nbsp;x&lt;&lt;(_W*i);&nbsp;z&nbsp;must&nbsp;be&nbsp;long&nbsp;enough.</span><br>
<span class="lineno"></span><span class="comment" id="3765040">//&nbsp;(we&nbsp;don&#39;t&nbsp;use&nbsp;nat.add&nbsp;because&nbsp;we&nbsp;need&nbsp;z&nbsp;to&nbsp;stay&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="3765100">//&nbsp;slice,&nbsp;and&nbsp;we&nbsp;don&#39;t&nbsp;need&nbsp;to&nbsp;normalize&nbsp;z&nbsp;after&nbsp;each&nbsp;addition)</span><br>
<span class="lineno"></span><span class="keyword" id="3765164">func</span>&nbsp;<span class="ident" id="3765169">addAt</span><span class="op" id="3765174">(</span><span class="ident" id="3765175">z</span><span class="op" id="3765176">,</span>&nbsp;<span class="ident" id="3765178">x</span>&nbsp;<span class="ident" id="3765180"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3765183">,</span>&nbsp;<span class="ident" id="3765185">i</span>&nbsp;<span class="builtintype" id="3765187">int</span><span class="op" id="3765190">)</span>&nbsp;<span class="op" id="3765192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765195">if</span>&nbsp;<span class="ident" id="3765198">n</span>&nbsp;<span class="op" id="3765200">:=</span>&nbsp;<span class="builtinfunc" id="3765203">len</span><span class="op" id="3765206">(</span><span class="ident" id="3765207"><a href="/math/big/nat.go.html#3765178">x</a></span><span class="op" id="3765208">)</span><span class="op" id="3765209">;</span>&nbsp;<span class="ident" id="3765211"><a href="/math/big/nat.go.html#3765198">n</a></span>&nbsp;<span class="op" id="3765213">&gt;</span>&nbsp;<span class="num" id="3765215">0</span>&nbsp;<span class="op" id="3765217">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765221">if</span>&nbsp;<span class="ident" id="3765224">c</span>&nbsp;<span class="op" id="3765226">:=</span>&nbsp;<span class="ident" id="3765229"><a href="/math/big/arith_decl.go.html#3731908">addVV</a></span><span class="op" id="3765234">(</span><span class="ident" id="3765235"><a href="/math/big/nat.go.html#3765175">z</a></span><span class="op" id="3765236">[</span><span class="ident" id="3765237"><a href="/math/big/nat.go.html#3765185">i</a></span><span class="op" id="3765238">:</span><span class="ident" id="3765239"><a href="/math/big/nat.go.html#3765185">i</a></span><span class="op" id="3765240">+</span><span class="ident" id="3765241"><a href="/math/big/nat.go.html#3765198">n</a></span><span class="op" id="3765242">]</span><span class="op" id="3765243">,</span>&nbsp;<span class="ident" id="3765245"><a href="/math/big/nat.go.html#3765175">z</a></span><span class="op" id="3765246">[</span><span class="ident" id="3765247"><a href="/math/big/nat.go.html#3765185">i</a></span><span class="op" id="3765248">:</span><span class="op" id="3765249">]</span><span class="op" id="3765250">,</span>&nbsp;<span class="ident" id="3765252"><a href="/math/big/nat.go.html#3765178">x</a></span><span class="op" id="3765253">)</span><span class="op" id="3765254">;</span>&nbsp;<span class="ident" id="3765256"><a href="/math/big/nat.go.html#3765224">c</a></span>&nbsp;<span class="op" id="3765258">!=</span>&nbsp;<span class="num" id="3765261">0</span>&nbsp;<span class="op" id="3765263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3765268">j</span>&nbsp;<span class="op" id="3765270">:=</span>&nbsp;<span class="ident" id="3765273"><a href="/math/big/nat.go.html#3765185">i</a></span>&nbsp;<span class="op" id="3765275">+</span>&nbsp;<span class="ident" id="3765277"><a href="/math/big/nat.go.html#3765198">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765282">if</span>&nbsp;<span class="ident" id="3765285"><a href="/math/big/nat.go.html#3765268">j</a></span>&nbsp;<span class="op" id="3765287">&lt;</span>&nbsp;<span class="builtinfunc" id="3765289">len</span><span class="op" id="3765292">(</span><span class="ident" id="3765293"><a href="/math/big/nat.go.html#3765175">z</a></span><span class="op" id="3765294">)</span>&nbsp;<span class="op" id="3765296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3765302"><a href="/math/big/arith_decl.go.html#3731980">addVW</a></span><span class="op" id="3765307">(</span><span class="ident" id="3765308"><a href="/math/big/nat.go.html#3765175">z</a></span><span class="op" id="3765309">[</span><span class="ident" id="3765310"><a href="/math/big/nat.go.html#3765268">j</a></span><span class="op" id="3765311">:</span><span class="op" id="3765312">]</span><span class="op" id="3765313">,</span>&nbsp;<span class="ident" id="3765315"><a href="/math/big/nat.go.html#3765175">z</a></span><span class="op" id="3765316">[</span><span class="ident" id="3765317"><a href="/math/big/nat.go.html#3765268">j</a></span><span class="op" id="3765318">:</span><span class="op" id="3765319">]</span><span class="op" id="3765320">,</span>&nbsp;<span class="ident" id="3765322"><a href="/math/big/nat.go.html#3765224">c</a></span><span class="op" id="3765323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3765328">}</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3765332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3765335">}</span><br>
<span class="lineno"></span><span class="op" id="3765337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3765340">func</span>&nbsp;<span class="ident" id="3765345">max</span><span class="op" id="3765348">(</span><span class="ident" id="3765349">x</span><span class="op" id="3765350">,</span>&nbsp;<span class="ident" id="3765352">y</span>&nbsp;<span class="builtintype" id="3765354">int</span><span class="op" id="3765357">)</span>&nbsp;<span class="builtintype" id="3765359">int</span>&nbsp;<span class="op" id="3765363">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765366">if</span>&nbsp;<span class="ident" id="3765369"><a href="/math/big/nat.go.html#3765349">x</a></span>&nbsp;<span class="op" id="3765371">&gt;</span>&nbsp;<span class="ident" id="3765373"><a href="/math/big/nat.go.html#3765352">y</a></span>&nbsp;<span class="op" id="3765375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765379">return</span>&nbsp;<span class="ident" id="3765386"><a href="/math/big/nat.go.html#3765349">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3765389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765392">return</span>&nbsp;<span class="ident" id="3765399"><a href="/math/big/nat.go.html#3765352">y</a></span><br>
<span class="lineno"></span><span class="op" id="3765401">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="comment" id="3765404">//&nbsp;karatsubaLen&nbsp;computes&nbsp;an&nbsp;approximation&nbsp;to&nbsp;the&nbsp;maximum&nbsp;k&nbsp;&lt;=&nbsp;n&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3765478">//&nbsp;k&nbsp;=&nbsp;p&lt;&lt;i&nbsp;for&nbsp;a&nbsp;number&nbsp;p&nbsp;&lt;=&nbsp;karatsubaThreshold&nbsp;and&nbsp;an&nbsp;i&nbsp;&gt;=&nbsp;0.&nbsp;Thus,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3765552">//&nbsp;result&nbsp;is&nbsp;the&nbsp;largest&nbsp;number&nbsp;that&nbsp;can&nbsp;be&nbsp;divided&nbsp;repeatedly&nbsp;by&nbsp;2&nbsp;before</span><br>
<span class="lineno"></span><span class="comment" id="3765627">//&nbsp;becoming&nbsp;about&nbsp;the&nbsp;value&nbsp;of&nbsp;karatsubaThreshold.</span><br>
<span class="lineno">370</span><span class="keyword" id="3765678">func</span>&nbsp;<span class="ident" id="3765683">karatsubaLen</span><span class="op" id="3765695">(</span><span class="ident" id="3765696">n</span>&nbsp;<span class="builtintype" id="3765698">int</span><span class="op" id="3765701">)</span>&nbsp;<span class="builtintype" id="3765703">int</span>&nbsp;<span class="op" id="3765707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3765710">i</span>&nbsp;<span class="op" id="3765712">:=</span>&nbsp;<span class="builtintype" id="3765715">uint</span><span class="op" id="3765719">(</span><span class="num" id="3765720">0</span><span class="op" id="3765721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765724">for</span>&nbsp;<span class="ident" id="3765728"><a href="/math/big/nat.go.html#3765696">n</a></span>&nbsp;<span class="op" id="3765730">&gt;</span>&nbsp;<span class="ident" id="3765732"><a href="/math/big/nat.go.html#3762020">karatsubaThreshold</a></span>&nbsp;<span class="op" id="3765751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3765755"><a href="/math/big/nat.go.html#3765696">n</a></span>&nbsp;<span class="op" id="3765757">&gt;&gt;=</span>&nbsp;<span class="num" id="3765761">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3765765"><a href="/math/big/nat.go.html#3765710">i</a></span><span class="op" id="3765766">++</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3765770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765773">return</span>&nbsp;<span class="ident" id="3765780"><a href="/math/big/nat.go.html#3765696">n</a></span>&nbsp;<span class="op" id="3765782">&lt;&lt;</span>&nbsp;<span class="ident" id="3765785"><a href="/math/big/nat.go.html#3765710">i</a></span><br>
<span class="lineno"></span><span class="op" id="3765787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3765790">func</span>&nbsp;<span class="op" id="3765795">(</span><span class="ident" id="3765796">z</span>&nbsp;<span class="ident" id="3765798"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3765801">)</span>&nbsp;<span class="ident" id="3765803">mul</span><span class="op" id="3765806">(</span><span class="ident" id="3765807">x</span><span class="op" id="3765808">,</span>&nbsp;<span class="ident" id="3765810">y</span>&nbsp;<span class="ident" id="3765812"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3765815">)</span>&nbsp;<span class="ident" id="3765817"><a href="/math/big/nat.go.html#3758892">nat</a></span>&nbsp;<span class="op" id="3765821">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3765824">m</span>&nbsp;<span class="op" id="3765826">:=</span>&nbsp;<span class="builtinfunc" id="3765829">len</span><span class="op" id="3765832">(</span><span class="ident" id="3765833"><a href="/math/big/nat.go.html#3765807">x</a></span><span class="op" id="3765834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3765837">n</span>&nbsp;<span class="op" id="3765839">:=</span>&nbsp;<span class="builtinfunc" id="3765842">len</span><span class="op" id="3765845">(</span><span class="ident" id="3765846"><a href="/math/big/nat.go.html#3765810">y</a></span><span class="op" id="3765847">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765851">switch</span>&nbsp;<span class="op" id="3765858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765861">case</span>&nbsp;<span class="ident" id="3765866"><a href="/math/big/nat.go.html#3765824">m</a></span>&nbsp;<span class="op" id="3765868">&lt;</span>&nbsp;<span class="ident" id="3765870"><a href="/math/big/nat.go.html#3765837">n</a></span><span class="op" id="3765871">:</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765875">return</span>&nbsp;<span class="ident" id="3765882"><a href="/math/big/nat.go.html#3765796">z</a></span><span class="op" id="3765883">.</span><span class="ident" id="3765884">mul</span><span class="op" id="3765887">(</span><span class="ident" id="3765888"><a href="/math/big/nat.go.html#3765810">y</a></span><span class="op" id="3765889">,</span>&nbsp;<span class="ident" id="3765891"><a href="/math/big/nat.go.html#3765807">x</a></span><span class="op" id="3765892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765895">case</span>&nbsp;<span class="ident" id="3765900"><a href="/math/big/nat.go.html#3765824">m</a></span>&nbsp;<span class="op" id="3765902">==</span>&nbsp;<span class="num" id="3765905">0</span>&nbsp;<span class="op" id="3765907">||</span>&nbsp;<span class="ident" id="3765910"><a href="/math/big/nat.go.html#3765837">n</a></span>&nbsp;<span class="op" id="3765912">==</span>&nbsp;<span class="num" id="3765915">0</span><span class="op" id="3765916">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765920">return</span>&nbsp;<span class="ident" id="3765927"><a href="/math/big/nat.go.html#3765796">z</a></span><span class="op" id="3765928">.</span><span class="builtinfunc" id="3765929">make</span><span class="op" id="3765933">(</span><span class="num" id="3765934">0</span><span class="op" id="3765935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765938">case</span>&nbsp;<span class="ident" id="3765943"><a href="/math/big/nat.go.html#3765837">n</a></span>&nbsp;<span class="op" id="3765945">==</span>&nbsp;<span class="num" id="3765948">1</span><span class="op" id="3765949">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3765953">return</span>&nbsp;<span class="ident" id="3765960"><a href="/math/big/nat.go.html#3765796">z</a></span><span class="op" id="3765961">.</span><span class="ident" id="3765962">mulAddWW</span><span class="op" id="3765970">(</span><span class="ident" id="3765971"><a href="/math/big/nat.go.html#3765807">x</a></span><span class="op" id="3765972">,</span>&nbsp;<span class="ident" id="3765974"><a href="/math/big/nat.go.html#3765810">y</a></span><span class="op" id="3765975">[</span><span class="num" id="3765976">0</span><span class="op" id="3765977">]</span><span class="op" id="3765978">,</span>&nbsp;<span class="num" id="3765980">0</span><span class="op" id="3765981">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3765984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3765987">//&nbsp;m&nbsp;&gt;=&nbsp;n&nbsp;&gt;&nbsp;1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3766003">//&nbsp;determine&nbsp;if&nbsp;z&nbsp;can&nbsp;be&nbsp;reused</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3766036">if</span>&nbsp;<span class="ident" id="3766039"><a href="/math/big/nat.go.html#3764870">alias</a></span><span class="op" id="3766044">(</span><span class="ident" id="3766045"><a href="/math/big/nat.go.html#3765796">z</a></span><span class="op" id="3766046">,</span>&nbsp;<span class="ident" id="3766048"><a href="/math/big/nat.go.html#3765807">x</a></span><span class="op" id="3766049">)</span>&nbsp;<span class="op" id="3766051">||</span>&nbsp;<span class="ident" id="3766054"><a href="/math/big/nat.go.html#3764870">alias</a></span><span class="op" id="3766059">(</span><span class="ident" id="3766060"><a href="/math/big/nat.go.html#3765796">z</a></span><span class="op" id="3766061">,</span>&nbsp;<span class="ident" id="3766063"><a href="/math/big/nat.go.html#3765810">y</a></span><span class="op" id="3766064">)</span>&nbsp;<span class="op" id="3766066">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3766070"><a href="/math/big/nat.go.html#3765796">z</a></span>&nbsp;<span class="op" id="3766072">=</span>&nbsp;<span class="ident" id="3766074">nil</span>&nbsp;<span class="comment" id="3766078">//&nbsp;z&nbsp;is&nbsp;an&nbsp;alias&nbsp;for&nbsp;x&nbsp;or&nbsp;y&nbsp;-&nbsp;cannot&nbsp;reuse</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3766122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3766126">//&nbsp;use&nbsp;basic&nbsp;multiplication&nbsp;if&nbsp;the&nbsp;numbers&nbsp;are&nbsp;small</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3766180">if</span>&nbsp;<span class="ident" id="3766183"><a href="/math/big/nat.go.html#3765837">n</a></span>&nbsp;<span class="op" id="3766185">&lt;</span>&nbsp;<span class="ident" id="3766187"><a href="/math/big/nat.go.html#3762020">karatsubaThreshold</a></span>&nbsp;<span class="op" id="3766206">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3766210"><a href="/math/big/nat.go.html#3765796">z</a></span>&nbsp;<span class="op" id="3766212">=</span>&nbsp;<span class="ident" id="3766214"><a href="/math/big/nat.go.html#3765796">z</a></span><span class="op" id="3766215">.</span><span class="builtinfunc" id="3766216">make</span><span class="op" id="3766220">(</span><span class="ident" id="3766221"><a href="/math/big/nat.go.html#3765824">m</a></span>&nbsp;<span class="op" id="3766223">+</span>&nbsp;<span class="ident" id="3766225"><a href="/math/big/nat.go.html#3765837">n</a></span><span class="op" id="3766226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3766230"><a href="/math/big/nat.go.html#3761281">basicMul</a></span><span class="op" id="3766238">(</span><span class="ident" id="3766239"><a href="/math/big/nat.go.html#3765796">z</a></span><span class="op" id="3766240">,</span>&nbsp;<span class="ident" id="3766242"><a href="/math/big/nat.go.html#3765807">x</a></span><span class="op" id="3766243">,</span>&nbsp;<span class="ident" id="3766245"><a href="/math/big/nat.go.html#3765810">y</a></span><span class="op" id="3766246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3766250">return</span>&nbsp;<span class="ident" id="3766257"><a href="/math/big/nat.go.html#3765796">z</a></span><span class="op" id="3766258">.</span><span class="ident" id="3766259">norm</span><span class="op" id="3766263">(</span><span class="op" id="3766264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3766267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3766270">//&nbsp;m&nbsp;&gt;=&nbsp;n&nbsp;&amp;&amp;&nbsp;n&nbsp;&gt;=&nbsp;karatsubaThreshold&nbsp;&amp;&amp;&nbsp;n&nbsp;&gt;=&nbsp;2</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3766319">//&nbsp;determine&nbsp;Karatsuba&nbsp;length&nbsp;k&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3766362">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3766366">//&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;xh*b&nbsp;+&nbsp;x0&nbsp;&nbsp;(0&nbsp;&lt;=&nbsp;x0&nbsp;&lt;&nbsp;b)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3766401">//&nbsp;&nbsp;&nbsp;y&nbsp;=&nbsp;yh*b&nbsp;+&nbsp;y0&nbsp;&nbsp;(0&nbsp;&lt;=&nbsp;y0&nbsp;&lt;&nbsp;b)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3766436">//&nbsp;&nbsp;&nbsp;b&nbsp;=&nbsp;1&lt;&lt;(_W*k)&nbsp;&nbsp;(&#34;base&#34;&nbsp;of&nbsp;digits&nbsp;xi,&nbsp;yi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3766483">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3766487">k</span>&nbsp;<span class="op" id="3766489">:=</span>&nbsp;<span class="ident" id="3766492"><a href="/math/big/nat.go.html#3765683">karatsubaLen</a></span><span class="op" id="3766504">(</span><span class="ident" id="3766505"><a href="/math/big/nat.go.html#3765837">n</a></span><span class="op" id="3766506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3766509">//&nbsp;k&nbsp;&lt;=&nbsp;n</span><br>
<span class="lineno"></span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3766521">//&nbsp;multiply&nbsp;x0&nbsp;and&nbsp;y0&nbsp;via&nbsp;Karatsuba</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3766558">x0</span>&nbsp;<span class="op" id="3766561">:=</span>&nbsp;<span class="ident" id="3766564"><a href="/math/big/nat.go.html#3765807">x</a></span><span class="op" id="3766565">[</span><span class="num" id="3766566">0</span><span class="op" id="3766567">:</span><span class="ident" id="3766568"><a href="/math/big/nat.go.html#3766487">k</a></span><span class="op" id="3766569">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3766584">//&nbsp;x0&nbsp;is&nbsp;not&nbsp;normalized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3766609">y0</span>&nbsp;<span class="op" id="3766612">:=</span>&nbsp;<span class="ident" id="3766615"><a href="/math/big/nat.go.html#3765810">y</a></span><span class="op" id="3766616">[</span><span class="num" id="3766617">0</span><span class="op" id="3766618">:</span><span class="ident" id="3766619"><a href="/math/big/nat.go.html#3766487">k</a></span><span class="op" id="3766620">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3766635">//&nbsp;y0&nbsp;is&nbsp;not&nbsp;normalized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3766660"><a href="/math/big/nat.go.html#3765796">z</a></span>&nbsp;<span class="op" id="3766662">=</span>&nbsp;<span class="ident" id="3766664"><a href="/math/big/nat.go.html#3765796">z</a></span><span class="op" id="3766665">.</span><span class="builtinfunc" id="3766666">make</span><span class="op" id="3766670">(</span><span class="ident" id="3766671"><a href="/math/big/nat.go.html#3765345">max</a></span><span class="op" id="3766674">(</span><span class="num" id="3766675">6</span><span class="op" id="3766676">*</span><span class="ident" id="3766677"><a href="/math/big/nat.go.html#3766487">k</a></span><span class="op" id="3766678">,</span>&nbsp;<span class="ident" id="3766680"><a href="/math/big/nat.go.html#3765824">m</a></span><span class="op" id="3766681">+</span><span class="ident" id="3766682"><a href="/math/big/nat.go.html#3765837">n</a></span><span class="op" id="3766683">)</span><span class="op" id="3766684">)</span>&nbsp;<span class="comment" id="3766686">//&nbsp;enough&nbsp;space&nbsp;for&nbsp;karatsuba&nbsp;of&nbsp;x0*y0&nbsp;and&nbsp;full&nbsp;result&nbsp;of&nbsp;x*y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3766749"><a href="/math/big/nat.go.html#3762318">karatsuba</a></span><span class="op" id="3766758">(</span><span class="ident" id="3766759"><a href="/math/big/nat.go.html#3765796">z</a></span><span class="op" id="3766760">,</span>&nbsp;<span class="ident" id="3766762"><a href="/math/big/nat.go.html#3766558">x0</a></span><span class="op" id="3766764">,</span>&nbsp;<span class="ident" id="3766766"><a href="/math/big/nat.go.html#3766609">y0</a></span><span class="op" id="3766768">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3766771"><a href="/math/big/nat.go.html#3765796">z</a></span>&nbsp;<span class="op" id="3766773">=</span>&nbsp;<span class="ident" id="3766775"><a href="/math/big/nat.go.html#3765796">z</a></span><span class="op" id="3766776">[</span><span class="num" id="3766777">0</span>&nbsp;<span class="op" id="3766779">:</span>&nbsp;<span class="ident" id="3766781"><a href="/math/big/nat.go.html#3765824">m</a></span><span class="op" id="3766782">+</span><span class="ident" id="3766783"><a href="/math/big/nat.go.html#3765837">n</a></span><span class="op" id="3766784">]</span>&nbsp;&nbsp;<span class="comment" id="3766787">//&nbsp;z&nbsp;has&nbsp;final&nbsp;length&nbsp;but&nbsp;may&nbsp;be&nbsp;incomplete</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3766832"><a href="/math/big/nat.go.html#3765796">z</a></span><span class="op" id="3766833">[</span><span class="num" id="3766834">2</span><span class="op" id="3766835">*</span><span class="ident" id="3766836"><a href="/math/big/nat.go.html#3766487">k</a></span><span class="op" id="3766837">:</span><span class="op" id="3766838">]</span><span class="op" id="3766839">.</span><span class="ident" id="3766840">clear</span><span class="op" id="3766845">(</span><span class="op" id="3766846">)</span>&nbsp;<span class="comment" id="3766848">//&nbsp;upper&nbsp;portion&nbsp;of&nbsp;z&nbsp;is&nbsp;garbage&nbsp;(and&nbsp;2*k&nbsp;&lt;=&nbsp;m+n&nbsp;since&nbsp;k&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;m)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3766918">//&nbsp;If&nbsp;xh&nbsp;!=&nbsp;0&nbsp;or&nbsp;yh&nbsp;!=&nbsp;0,&nbsp;add&nbsp;the&nbsp;missing&nbsp;terms&nbsp;to&nbsp;z.&nbsp;For</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3766977">//</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3766981">//&nbsp;&nbsp;&nbsp;xh&nbsp;=&nbsp;xi*b^i&nbsp;+&nbsp;...&nbsp;+&nbsp;x2*b^2&nbsp;+&nbsp;x1*b&nbsp;(0&nbsp;&lt;=&nbsp;xi&nbsp;&lt;&nbsp;b)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3767035">//&nbsp;&nbsp;&nbsp;yh&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y1*b&nbsp;(0&nbsp;&lt;=&nbsp;y1&nbsp;&lt;&nbsp;b)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3767089">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3767093">//&nbsp;the&nbsp;missing&nbsp;terms&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3767119">//</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3767123">//&nbsp;&nbsp;&nbsp;x0*y1*b&nbsp;and&nbsp;xi*y0*b^i,&nbsp;xi*y1*b^(i+1)&nbsp;for&nbsp;i&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3767176">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3767180">//&nbsp;since&nbsp;all&nbsp;the&nbsp;yi&nbsp;for&nbsp;i&nbsp;&gt;&nbsp;1&nbsp;are&nbsp;0&nbsp;by&nbsp;choice&nbsp;of&nbsp;k:&nbsp;If&nbsp;any&nbsp;of&nbsp;them</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3767248">//&nbsp;were&nbsp;&gt;&nbsp;0,&nbsp;then&nbsp;yh&nbsp;&gt;=&nbsp;b^2&nbsp;and&nbsp;thus&nbsp;y&nbsp;&gt;=&nbsp;b^2.&nbsp;Then&nbsp;k&#39;&nbsp;=&nbsp;k*2&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3767316">//&nbsp;be&nbsp;a&nbsp;larger&nbsp;valid&nbsp;threshold&nbsp;contradicting&nbsp;the&nbsp;assumption&nbsp;about&nbsp;k.</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3767386">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3767390">if</span>&nbsp;<span class="ident" id="3767393"><a href="/math/big/nat.go.html#3766487">k</a></span>&nbsp;<span class="op" id="3767395">&lt;</span>&nbsp;<span class="ident" id="3767397"><a href="/math/big/nat.go.html#3765837">n</a></span>&nbsp;<span class="op" id="3767399">||</span>&nbsp;<span class="ident" id="3767402"><a href="/math/big/nat.go.html#3765824">m</a></span>&nbsp;<span class="op" id="3767404">!=</span>&nbsp;<span class="ident" id="3767407"><a href="/math/big/nat.go.html#3765837">n</a></span>&nbsp;<span class="op" id="3767409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3767413">var</span>&nbsp;<span class="ident" id="3767417">t</span>&nbsp;<span class="ident" id="3767419"><a href="/math/big/nat.go.html#3758892">nat</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3767426">//&nbsp;add&nbsp;x0*y1*b</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3767443">x0</span>&nbsp;<span class="op" id="3767446">:=</span>&nbsp;<span class="ident" id="3767449"><a href="/math/big/nat.go.html#3766558">x0</a></span><span class="op" id="3767451">.</span><span class="ident" id="3767452">norm</span><span class="op" id="3767456">(</span><span class="op" id="3767457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3767461">y1</span>&nbsp;<span class="op" id="3767464">:=</span>&nbsp;<span class="ident" id="3767467"><a href="/math/big/nat.go.html#3765810">y</a></span><span class="op" id="3767468">[</span><span class="ident" id="3767469"><a href="/math/big/nat.go.html#3766487">k</a></span><span class="op" id="3767470">:</span><span class="op" id="3767471">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3767479">//&nbsp;y1&nbsp;is&nbsp;normalized&nbsp;because&nbsp;y&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3767514"><a href="/math/big/nat.go.html#3767417">t</a></span>&nbsp;<span class="op" id="3767516">=</span>&nbsp;<span class="ident" id="3767518"><a href="/math/big/nat.go.html#3767417">t</a></span><span class="op" id="3767519">.</span><span class="ident" id="3767520">mul</span><span class="op" id="3767523">(</span><span class="ident" id="3767524"><a href="/math/big/nat.go.html#3767443">x0</a></span><span class="op" id="3767526">,</span>&nbsp;<span class="ident" id="3767528"><a href="/math/big/nat.go.html#3767461">y1</a></span><span class="op" id="3767530">)</span>&nbsp;<span class="comment" id="3767532">//&nbsp;update&nbsp;t&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;lose&nbsp;t&#39;s&nbsp;underlying&nbsp;array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3767584"><a href="/math/big/nat.go.html#3765169">addAt</a></span><span class="op" id="3767589">(</span><span class="ident" id="3767590"><a href="/math/big/nat.go.html#3765796">z</a></span><span class="op" id="3767591">,</span>&nbsp;<span class="ident" id="3767593"><a href="/math/big/nat.go.html#3767417">t</a></span><span class="op" id="3767594">,</span>&nbsp;<span class="ident" id="3767596"><a href="/math/big/nat.go.html#3766487">k</a></span><span class="op" id="3767597">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3767602">//&nbsp;add&nbsp;xi*y0&lt;&lt;i,&nbsp;xi*y1*b&lt;&lt;(i+k)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3767636">y0</span>&nbsp;<span class="op" id="3767639">:=</span>&nbsp;<span class="ident" id="3767642"><a href="/math/big/nat.go.html#3766609">y0</a></span><span class="op" id="3767644">.</span><span class="ident" id="3767645">norm</span><span class="op" id="3767649">(</span><span class="op" id="3767650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3767654">for</span>&nbsp;<span class="ident" id="3767658">i</span>&nbsp;<span class="op" id="3767660">:=</span>&nbsp;<span class="ident" id="3767663"><a href="/math/big/nat.go.html#3766487">k</a></span><span class="op" id="3767664">;</span>&nbsp;<span class="ident" id="3767666"><a href="/math/big/nat.go.html#3767658">i</a></span>&nbsp;<span class="op" id="3767668">&lt;</span>&nbsp;<span class="builtinfunc" id="3767670">len</span><span class="op" id="3767673">(</span><span class="ident" id="3767674"><a href="/math/big/nat.go.html#3765807">x</a></span><span class="op" id="3767675">)</span><span class="op" id="3767676">;</span>&nbsp;<span class="ident" id="3767678"><a href="/math/big/nat.go.html#3767658">i</a></span>&nbsp;<span class="op" id="3767680">+=</span>&nbsp;<span class="ident" id="3767683"><a href="/math/big/nat.go.html#3766487">k</a></span>&nbsp;<span class="op" id="3767685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3767690">xi</span>&nbsp;<span class="op" id="3767693">:=</span>&nbsp;<span class="ident" id="3767696"><a href="/math/big/nat.go.html#3765807">x</a></span><span class="op" id="3767697">[</span><span class="ident" id="3767698"><a href="/math/big/nat.go.html#3767658">i</a></span><span class="op" id="3767699">:</span><span class="op" id="3767700">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3767705">if</span>&nbsp;<span class="builtinfunc" id="3767708">len</span><span class="op" id="3767711">(</span><span class="ident" id="3767712"><a href="/math/big/nat.go.html#3767690">xi</a></span><span class="op" id="3767714">)</span>&nbsp;<span class="op" id="3767716">&gt;</span>&nbsp;<span class="ident" id="3767718"><a href="/math/big/nat.go.html#3766487">k</a></span>&nbsp;<span class="op" id="3767720">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3767726"><a href="/math/big/nat.go.html#3767690">xi</a></span>&nbsp;<span class="op" id="3767729">=</span>&nbsp;<span class="ident" id="3767731"><a href="/math/big/nat.go.html#3767690">xi</a></span><span class="op" id="3767733">[</span><span class="op" id="3767734">:</span><span class="ident" id="3767735"><a href="/math/big/nat.go.html#3766487">k</a></span><span class="op" id="3767736">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3767741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3767746"><a href="/math/big/nat.go.html#3767690">xi</a></span>&nbsp;<span class="op" id="3767749">=</span>&nbsp;<span class="ident" id="3767751"><a href="/math/big/nat.go.html#3767690">xi</a></span><span class="op" id="3767753">.</span><span class="ident" id="3767754">norm</span><span class="op" id="3767758">(</span><span class="op" id="3767759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3767764"><a href="/math/big/nat.go.html#3767417">t</a></span>&nbsp;<span class="op" id="3767766">=</span>&nbsp;<span class="ident" id="3767768"><a href="/math/big/nat.go.html#3767417">t</a></span><span class="op" id="3767769">.</span><span class="ident" id="3767770">mul</span><span class="op" id="3767773">(</span><span class="ident" id="3767774"><a href="/math/big/nat.go.html#3767690">xi</a></span><span class="op" id="3767776">,</span>&nbsp;<span class="ident" id="3767778"><a href="/math/big/nat.go.html#3767636">y0</a></span><span class="op" id="3767780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3767785"><a href="/math/big/nat.go.html#3765169">addAt</a></span><span class="op" id="3767790">(</span><span class="ident" id="3767791"><a href="/math/big/nat.go.html#3765796">z</a></span><span class="op" id="3767792">,</span>&nbsp;<span class="ident" id="3767794"><a href="/math/big/nat.go.html#3767417">t</a></span><span class="op" id="3767795">,</span>&nbsp;<span class="ident" id="3767797"><a href="/math/big/nat.go.html#3767658">i</a></span><span class="op" id="3767798">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3767803"><a href="/math/big/nat.go.html#3767417">t</a></span>&nbsp;<span class="op" id="3767805">=</span>&nbsp;<span class="ident" id="3767807"><a href="/math/big/nat.go.html#3767417">t</a></span><span class="op" id="3767808">.</span><span class="ident" id="3767809">mul</span><span class="op" id="3767812">(</span><span class="ident" id="3767813"><a href="/math/big/nat.go.html#3767690">xi</a></span><span class="op" id="3767815">,</span>&nbsp;<span class="ident" id="3767817"><a href="/math/big/nat.go.html#3767461">y1</a></span><span class="op" id="3767819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3767824"><a href="/math/big/nat.go.html#3765169">addAt</a></span><span class="op" id="3767829">(</span><span class="ident" id="3767830"><a href="/math/big/nat.go.html#3765796">z</a></span><span class="op" id="3767831">,</span>&nbsp;<span class="ident" id="3767833"><a href="/math/big/nat.go.html#3767417">t</a></span><span class="op" id="3767834">,</span>&nbsp;<span class="ident" id="3767836"><a href="/math/big/nat.go.html#3767658">i</a></span><span class="op" id="3767837">+</span><span class="ident" id="3767838"><a href="/math/big/nat.go.html#3766487">k</a></span><span class="op" id="3767839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3767843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3767846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3767850">return</span>&nbsp;<span class="ident" id="3767857"><a href="/math/big/nat.go.html#3765796">z</a></span><span class="op" id="3767858">.</span><span class="ident" id="3767859">norm</span><span class="op" id="3767863">(</span><span class="op" id="3767864">)</span><br>
<span class="lineno"></span><span class="op" id="3767866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3767869">//&nbsp;mulRange&nbsp;computes&nbsp;the&nbsp;product&nbsp;of&nbsp;all&nbsp;the&nbsp;unsigned&nbsp;integers&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3767938">//&nbsp;range&nbsp;[a,&nbsp;b]&nbsp;inclusively.&nbsp;If&nbsp;a&nbsp;&gt;&nbsp;b&nbsp;(empty&nbsp;range),&nbsp;the&nbsp;result&nbsp;is&nbsp;1.</span><br>
<span class="lineno">465</span><span class="keyword" id="3768008">func</span>&nbsp;<span class="op" id="3768013">(</span><span class="ident" id="3768014">z</span>&nbsp;<span class="ident" id="3768016"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3768019">)</span>&nbsp;<span class="ident" id="3768021">mulRange</span><span class="op" id="3768029">(</span><span class="ident" id="3768030">a</span><span class="op" id="3768031">,</span>&nbsp;<span class="ident" id="3768033">b</span>&nbsp;<span class="ident" id="3768035">uint64</span><span class="op" id="3768041">)</span>&nbsp;<span class="ident" id="3768043"><a href="/math/big/nat.go.html#3758892">nat</a></span>&nbsp;<span class="op" id="3768047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768050">switch</span>&nbsp;<span class="op" id="3768057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768060">case</span>&nbsp;<span class="ident" id="3768065"><a href="/math/big/nat.go.html#3768030">a</a></span>&nbsp;<span class="op" id="3768067">==</span>&nbsp;<span class="num" id="3768070">0</span><span class="op" id="3768071">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3768075">//&nbsp;cut&nbsp;long&nbsp;ranges&nbsp;short&nbsp;(optimization)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768117">return</span>&nbsp;<span class="ident" id="3768124"><a href="/math/big/nat.go.html#3768014">z</a></span><span class="op" id="3768125">.</span><span class="ident" id="3768126">setUint64</span><span class="op" id="3768135">(</span><span class="num" id="3768136">0</span><span class="op" id="3768137">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768140">case</span>&nbsp;<span class="ident" id="3768145"><a href="/math/big/nat.go.html#3768030">a</a></span>&nbsp;<span class="op" id="3768147">&gt;</span>&nbsp;<span class="ident" id="3768149"><a href="/math/big/nat.go.html#3768033">b</a></span><span class="op" id="3768150">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768154">return</span>&nbsp;<span class="ident" id="3768161"><a href="/math/big/nat.go.html#3768014">z</a></span><span class="op" id="3768162">.</span><span class="ident" id="3768163">setUint64</span><span class="op" id="3768172">(</span><span class="num" id="3768173">1</span><span class="op" id="3768174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768177">case</span>&nbsp;<span class="ident" id="3768182"><a href="/math/big/nat.go.html#3768030">a</a></span>&nbsp;<span class="op" id="3768184">==</span>&nbsp;<span class="ident" id="3768187"><a href="/math/big/nat.go.html#3768033">b</a></span><span class="op" id="3768188">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768192">return</span>&nbsp;<span class="ident" id="3768199"><a href="/math/big/nat.go.html#3768014">z</a></span><span class="op" id="3768200">.</span><span class="ident" id="3768201">setUint64</span><span class="op" id="3768210">(</span><span class="ident" id="3768211"><a href="/math/big/nat.go.html#3768030">a</a></span><span class="op" id="3768212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768215">case</span>&nbsp;<span class="ident" id="3768220"><a href="/math/big/nat.go.html#3768030">a</a></span><span class="op" id="3768221">+</span><span class="num" id="3768222">1</span>&nbsp;<span class="op" id="3768224">==</span>&nbsp;<span class="ident" id="3768227"><a href="/math/big/nat.go.html#3768033">b</a></span><span class="op" id="3768228">:</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768232">return</span>&nbsp;<span class="ident" id="3768239"><a href="/math/big/nat.go.html#3768014">z</a></span><span class="op" id="3768240">.</span><span class="ident" id="3768241">mul</span><span class="op" id="3768244">(</span><span class="ident" id="3768245"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3768248">(</span><span class="ident" id="3768249">nil</span><span class="op" id="3768252">)</span><span class="op" id="3768253">.</span><span class="ident" id="3768254">setUint64</span><span class="op" id="3768263">(</span><span class="ident" id="3768264"><a href="/math/big/nat.go.html#3768030">a</a></span><span class="op" id="3768265">)</span><span class="op" id="3768266">,</span>&nbsp;<span class="ident" id="3768268"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3768271">(</span><span class="ident" id="3768272">nil</span><span class="op" id="3768275">)</span><span class="op" id="3768276">.</span><span class="ident" id="3768277">setUint64</span><span class="op" id="3768286">(</span><span class="ident" id="3768287"><a href="/math/big/nat.go.html#3768033">b</a></span><span class="op" id="3768288">)</span><span class="op" id="3768289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3768292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3768295">m</span>&nbsp;<span class="op" id="3768297">:=</span>&nbsp;<span class="op" id="3768300">(</span><span class="ident" id="3768301"><a href="/math/big/nat.go.html#3768030">a</a></span>&nbsp;<span class="op" id="3768303">+</span>&nbsp;<span class="ident" id="3768305"><a href="/math/big/nat.go.html#3768033">b</a></span><span class="op" id="3768306">)</span>&nbsp;<span class="op" id="3768308">/</span>&nbsp;<span class="num" id="3768310">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768313">return</span>&nbsp;<span class="ident" id="3768320"><a href="/math/big/nat.go.html#3768014">z</a></span><span class="op" id="3768321">.</span><span class="ident" id="3768322">mul</span><span class="op" id="3768325">(</span><span class="ident" id="3768326"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3768329">(</span><span class="ident" id="3768330">nil</span><span class="op" id="3768333">)</span><span class="op" id="3768334">.</span><span class="ident" id="3768335">mulRange</span><span class="op" id="3768343">(</span><span class="ident" id="3768344"><a href="/math/big/nat.go.html#3768030">a</a></span><span class="op" id="3768345">,</span>&nbsp;<span class="ident" id="3768347"><a href="/math/big/nat.go.html#3768295">m</a></span><span class="op" id="3768348">)</span><span class="op" id="3768349">,</span>&nbsp;<span class="ident" id="3768351"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3768354">(</span><span class="ident" id="3768355">nil</span><span class="op" id="3768358">)</span><span class="op" id="3768359">.</span><span class="ident" id="3768360">mulRange</span><span class="op" id="3768368">(</span><span class="ident" id="3768369"><a href="/math/big/nat.go.html#3768295">m</a></span><span class="op" id="3768370">+</span><span class="num" id="3768371">1</span><span class="op" id="3768372">,</span>&nbsp;<span class="ident" id="3768374"><a href="/math/big/nat.go.html#3768033">b</a></span><span class="op" id="3768375">)</span><span class="op" id="3768376">)</span><br>
<span class="lineno"></span><span class="op" id="3768378">}</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span><span class="comment" id="3768381">//&nbsp;q&nbsp;=&nbsp;(x-r)/y,&nbsp;with&nbsp;0&nbsp;&lt;=&nbsp;r&nbsp;&lt;&nbsp;y</span><br>
<span class="lineno"></span><span class="keyword" id="3768413">func</span>&nbsp;<span class="op" id="3768418">(</span><span class="ident" id="3768419">z</span>&nbsp;<span class="ident" id="3768421"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3768424">)</span>&nbsp;<span class="ident" id="3768426">divW</span><span class="op" id="3768430">(</span><span class="ident" id="3768431">x</span>&nbsp;<span class="ident" id="3768433"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3768436">,</span>&nbsp;<span class="ident" id="3768438">y</span>&nbsp;<span class="ident" id="3768440"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3768444">)</span>&nbsp;<span class="op" id="3768446">(</span><span class="ident" id="3768447">q</span>&nbsp;<span class="ident" id="3768449"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3768452">,</span>&nbsp;<span class="ident" id="3768454">r</span>&nbsp;<span class="ident" id="3768456"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3768460">)</span>&nbsp;<span class="op" id="3768462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3768465">m</span>&nbsp;<span class="op" id="3768467">:=</span>&nbsp;<span class="builtinfunc" id="3768470">len</span><span class="op" id="3768473">(</span><span class="ident" id="3768474"><a href="/math/big/nat.go.html#3768431">x</a></span><span class="op" id="3768475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768478">switch</span>&nbsp;<span class="op" id="3768485">{</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768488">case</span>&nbsp;<span class="ident" id="3768493"><a href="/math/big/nat.go.html#3768438">y</a></span>&nbsp;<span class="op" id="3768495">==</span>&nbsp;<span class="num" id="3768498">0</span><span class="op" id="3768499">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3768503">panic</span><span class="op" id="3768508">(</span><span class="string" id="3768509">&#34;division&nbsp;by&nbsp;zero&#34;</span><span class="op" id="3768527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768530">case</span>&nbsp;<span class="ident" id="3768535"><a href="/math/big/nat.go.html#3768438">y</a></span>&nbsp;<span class="op" id="3768537">==</span>&nbsp;<span class="num" id="3768540">1</span><span class="op" id="3768541">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3768545"><a href="/math/big/nat.go.html#3768447">q</a></span>&nbsp;<span class="op" id="3768547">=</span>&nbsp;<span class="ident" id="3768549"><a href="/math/big/nat.go.html#3768419">z</a></span><span class="op" id="3768550">.</span><span class="ident" id="3768551">set</span><span class="op" id="3768554">(</span><span class="ident" id="3768555"><a href="/math/big/nat.go.html#3768431">x</a></span><span class="op" id="3768556">)</span>&nbsp;<span class="comment" id="3768558">//&nbsp;result&nbsp;is&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768575">return</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768583">case</span>&nbsp;<span class="ident" id="3768588"><a href="/math/big/nat.go.html#3768465">m</a></span>&nbsp;<span class="op" id="3768590">==</span>&nbsp;<span class="num" id="3768593">0</span><span class="op" id="3768594">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3768598"><a href="/math/big/nat.go.html#3768447">q</a></span>&nbsp;<span class="op" id="3768600">=</span>&nbsp;<span class="ident" id="3768602"><a href="/math/big/nat.go.html#3768419">z</a></span><span class="op" id="3768603">.</span><span class="builtinfunc" id="3768604">make</span><span class="op" id="3768608">(</span><span class="num" id="3768609">0</span><span class="op" id="3768610">)</span>&nbsp;<span class="comment" id="3768612">//&nbsp;result&nbsp;is&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768629">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3768637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3768640">//&nbsp;m&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3768650"><a href="/math/big/nat.go.html#3768419">z</a></span>&nbsp;<span class="op" id="3768652">=</span>&nbsp;<span class="ident" id="3768654"><a href="/math/big/nat.go.html#3768419">z</a></span><span class="op" id="3768655">.</span><span class="builtinfunc" id="3768656">make</span><span class="op" id="3768660">(</span><span class="ident" id="3768661"><a href="/math/big/nat.go.html#3768465">m</a></span><span class="op" id="3768662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3768665"><a href="/math/big/nat.go.html#3768454">r</a></span>&nbsp;<span class="op" id="3768667">=</span>&nbsp;<span class="ident" id="3768669"><a href="/math/big/arith_decl.go.html#3732237">divWVW</a></span><span class="op" id="3768675">(</span><span class="ident" id="3768676"><a href="/math/big/nat.go.html#3768419">z</a></span><span class="op" id="3768677">,</span>&nbsp;<span class="num" id="3768679">0</span><span class="op" id="3768680">,</span>&nbsp;<span class="ident" id="3768682"><a href="/math/big/nat.go.html#3768431">x</a></span><span class="op" id="3768683">,</span>&nbsp;<span class="ident" id="3768685"><a href="/math/big/nat.go.html#3768438">y</a></span><span class="op" id="3768686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3768689"><a href="/math/big/nat.go.html#3768447">q</a></span>&nbsp;<span class="op" id="3768691">=</span>&nbsp;<span class="ident" id="3768693"><a href="/math/big/nat.go.html#3768419">z</a></span><span class="op" id="3768694">.</span><span class="ident" id="3768695">norm</span><span class="op" id="3768699">(</span><span class="op" id="3768700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768703">return</span><br>
<span class="lineno"></span><span class="op" id="3768710">}</span><br>
<span class="lineno">500</span><br>
<span class="lineno"></span><span class="keyword" id="3768713">func</span>&nbsp;<span class="op" id="3768718">(</span><span class="ident" id="3768719">z</span>&nbsp;<span class="ident" id="3768721"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3768724">)</span>&nbsp;<span class="ident" id="3768726">div</span><span class="op" id="3768729">(</span><span class="ident" id="3768730">z2</span><span class="op" id="3768732">,</span>&nbsp;<span class="ident" id="3768734">u</span><span class="op" id="3768735">,</span>&nbsp;<span class="ident" id="3768737">v</span>&nbsp;<span class="ident" id="3768739"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3768742">)</span>&nbsp;<span class="op" id="3768744">(</span><span class="ident" id="3768745">q</span><span class="op" id="3768746">,</span>&nbsp;<span class="ident" id="3768748">r</span>&nbsp;<span class="ident" id="3768750"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3768753">)</span>&nbsp;<span class="op" id="3768755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768758">if</span>&nbsp;<span class="builtinfunc" id="3768761">len</span><span class="op" id="3768764">(</span><span class="ident" id="3768765"><a href="/math/big/nat.go.html#3768737">v</a></span><span class="op" id="3768766">)</span>&nbsp;<span class="op" id="3768768">==</span>&nbsp;<span class="num" id="3768771">0</span>&nbsp;<span class="op" id="3768773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3768777">panic</span><span class="op" id="3768782">(</span><span class="string" id="3768783">&#34;division&nbsp;by&nbsp;zero&#34;</span><span class="op" id="3768801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3768804">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768808">if</span>&nbsp;<span class="ident" id="3768811"><a href="/math/big/nat.go.html#3768734">u</a></span><span class="op" id="3768812">.</span><span class="ident" id="3768813">cmp</span><span class="op" id="3768816">(</span><span class="ident" id="3768817"><a href="/math/big/nat.go.html#3768737">v</a></span><span class="op" id="3768818">)</span>&nbsp;<span class="op" id="3768820">&lt;</span>&nbsp;<span class="num" id="3768822">0</span>&nbsp;<span class="op" id="3768824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3768828"><a href="/math/big/nat.go.html#3768745">q</a></span>&nbsp;<span class="op" id="3768830">=</span>&nbsp;<span class="ident" id="3768832"><a href="/math/big/nat.go.html#3768719">z</a></span><span class="op" id="3768833">.</span><span class="builtinfunc" id="3768834">make</span><span class="op" id="3768838">(</span><span class="num" id="3768839">0</span><span class="op" id="3768840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3768844"><a href="/math/big/nat.go.html#3768748">r</a></span>&nbsp;<span class="op" id="3768846">=</span>&nbsp;<span class="ident" id="3768848"><a href="/math/big/nat.go.html#3768730">z2</a></span><span class="op" id="3768850">.</span><span class="ident" id="3768851">set</span><span class="op" id="3768854">(</span><span class="ident" id="3768855"><a href="/math/big/nat.go.html#3768734">u</a></span><span class="op" id="3768856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768860">return</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3768868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768872">if</span>&nbsp;<span class="builtinfunc" id="3768875">len</span><span class="op" id="3768878">(</span><span class="ident" id="3768879"><a href="/math/big/nat.go.html#3768737">v</a></span><span class="op" id="3768880">)</span>&nbsp;<span class="op" id="3768882">==</span>&nbsp;<span class="num" id="3768885">1</span>&nbsp;<span class="op" id="3768887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768891">var</span>&nbsp;<span class="ident" id="3768895">r2</span>&nbsp;<span class="ident" id="3768898"><a href="/math/big/arith.go.html#3727748">Word</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3768905"><a href="/math/big/nat.go.html#3768745">q</a></span><span class="op" id="3768906">,</span>&nbsp;<span class="ident" id="3768908"><a href="/math/big/nat.go.html#3768895">r2</a></span>&nbsp;<span class="op" id="3768911">=</span>&nbsp;<span class="ident" id="3768913"><a href="/math/big/nat.go.html#3768719">z</a></span><span class="op" id="3768914">.</span><span class="ident" id="3768915">divW</span><span class="op" id="3768919">(</span><span class="ident" id="3768920"><a href="/math/big/nat.go.html#3768734">u</a></span><span class="op" id="3768921">,</span>&nbsp;<span class="ident" id="3768923"><a href="/math/big/nat.go.html#3768737">v</a></span><span class="op" id="3768924">[</span><span class="num" id="3768925">0</span><span class="op" id="3768926">]</span><span class="op" id="3768927">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3768931"><a href="/math/big/nat.go.html#3768748">r</a></span>&nbsp;<span class="op" id="3768933">=</span>&nbsp;<span class="ident" id="3768935"><a href="/math/big/nat.go.html#3768730">z2</a></span><span class="op" id="3768937">.</span><span class="ident" id="3768938">setWord</span><span class="op" id="3768945">(</span><span class="ident" id="3768946"><a href="/math/big/nat.go.html#3768895">r2</a></span><span class="op" id="3768948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768952">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3768960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3768964"><a href="/math/big/nat.go.html#3768745">q</a></span><span class="op" id="3768965">,</span>&nbsp;<span class="ident" id="3768967"><a href="/math/big/nat.go.html#3768748">r</a></span>&nbsp;<span class="op" id="3768969">=</span>&nbsp;<span class="ident" id="3768971"><a href="/math/big/nat.go.html#3768719">z</a></span><span class="op" id="3768972">.</span><span class="ident" id="3768973">divLarge</span><span class="op" id="3768981">(</span><span class="ident" id="3768982"><a href="/math/big/nat.go.html#3768730">z2</a></span><span class="op" id="3768984">,</span>&nbsp;<span class="ident" id="3768986"><a href="/math/big/nat.go.html#3768734">u</a></span><span class="op" id="3768987">,</span>&nbsp;<span class="ident" id="3768989"><a href="/math/big/nat.go.html#3768737">v</a></span><span class="op" id="3768990">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3768993">return</span><br>
<span class="lineno"></span><span class="op" id="3769000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3769003">//&nbsp;q&nbsp;=&nbsp;(uIn-r)/v,&nbsp;with&nbsp;0&nbsp;&lt;=&nbsp;r&nbsp;&lt;&nbsp;y</span><br>
<span class="lineno"></span><span class="comment" id="3769037">//&nbsp;Uses&nbsp;z&nbsp;as&nbsp;storage&nbsp;for&nbsp;q,&nbsp;and&nbsp;u&nbsp;as&nbsp;storage&nbsp;for&nbsp;r&nbsp;if&nbsp;possible.</span><br>
<span class="lineno">525</span><span class="comment" id="3769101">//&nbsp;See&nbsp;Knuth,&nbsp;Volume&nbsp;2,&nbsp;section&nbsp;4.3.1,&nbsp;Algorithm&nbsp;D.</span><br>
<span class="lineno"></span><span class="comment" id="3769153">//&nbsp;Preconditions:</span><br>
<span class="lineno"></span><span class="comment" id="3769171">//&nbsp;&nbsp;&nbsp;&nbsp;len(v)&nbsp;&gt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="3769189">//&nbsp;&nbsp;&nbsp;&nbsp;len(uIn)&nbsp;&gt;=&nbsp;len(v)</span><br>
<span class="lineno"></span><span class="keyword" id="3769214">func</span>&nbsp;<span class="op" id="3769219">(</span><span class="ident" id="3769220">z</span>&nbsp;<span class="ident" id="3769222"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3769225">)</span>&nbsp;<span class="ident" id="3769227">divLarge</span><span class="op" id="3769235">(</span><span class="ident" id="3769236">u</span><span class="op" id="3769237">,</span>&nbsp;<span class="ident" id="3769239">uIn</span><span class="op" id="3769242">,</span>&nbsp;<span class="ident" id="3769244">v</span>&nbsp;<span class="ident" id="3769246"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3769249">)</span>&nbsp;<span class="op" id="3769251">(</span><span class="ident" id="3769252">q</span><span class="op" id="3769253">,</span>&nbsp;<span class="ident" id="3769255">r</span>&nbsp;<span class="ident" id="3769257"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3769260">)</span>&nbsp;<span class="op" id="3769262">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3769265">n</span>&nbsp;<span class="op" id="3769267">:=</span>&nbsp;<span class="builtinfunc" id="3769270">len</span><span class="op" id="3769273">(</span><span class="ident" id="3769274"><a href="/math/big/nat.go.html#3769244">v</a></span><span class="op" id="3769275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3769278">m</span>&nbsp;<span class="op" id="3769280">:=</span>&nbsp;<span class="builtinfunc" id="3769283">len</span><span class="op" id="3769286">(</span><span class="ident" id="3769287"><a href="/math/big/nat.go.html#3769239">uIn</a></span><span class="op" id="3769290">)</span>&nbsp;<span class="op" id="3769292">-</span>&nbsp;<span class="ident" id="3769294"><a href="/math/big/nat.go.html#3769265">n</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3769298">//&nbsp;determine&nbsp;if&nbsp;z&nbsp;can&nbsp;be&nbsp;reused</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3769331">//&nbsp;TODO(gri)&nbsp;should&nbsp;find&nbsp;a&nbsp;better&nbsp;solution&nbsp;-&nbsp;this&nbsp;if&nbsp;statement</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3769395">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;very&nbsp;costly&nbsp;(see&nbsp;e.g.&nbsp;time&nbsp;pidigits&nbsp;-s&nbsp;-n&nbsp;10000)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3769461">if</span>&nbsp;<span class="ident" id="3769464"><a href="/math/big/nat.go.html#3764870">alias</a></span><span class="op" id="3769469">(</span><span class="ident" id="3769470"><a href="/math/big/nat.go.html#3769220">z</a></span><span class="op" id="3769471">,</span>&nbsp;<span class="ident" id="3769473"><a href="/math/big/nat.go.html#3769239">uIn</a></span><span class="op" id="3769476">)</span>&nbsp;<span class="op" id="3769478">||</span>&nbsp;<span class="ident" id="3769481"><a href="/math/big/nat.go.html#3764870">alias</a></span><span class="op" id="3769486">(</span><span class="ident" id="3769487"><a href="/math/big/nat.go.html#3769220">z</a></span><span class="op" id="3769488">,</span>&nbsp;<span class="ident" id="3769490"><a href="/math/big/nat.go.html#3769244">v</a></span><span class="op" id="3769491">)</span>&nbsp;<span class="op" id="3769493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3769497"><a href="/math/big/nat.go.html#3769220">z</a></span>&nbsp;<span class="op" id="3769499">=</span>&nbsp;<span class="ident" id="3769501">nil</span>&nbsp;<span class="comment" id="3769505">//&nbsp;z&nbsp;is&nbsp;an&nbsp;alias&nbsp;for&nbsp;uIn&nbsp;or&nbsp;v&nbsp;-&nbsp;cannot&nbsp;reuse</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3769551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3769554"><a href="/math/big/nat.go.html#3769252">q</a></span>&nbsp;<span class="op" id="3769556">=</span>&nbsp;<span class="ident" id="3769558"><a href="/math/big/nat.go.html#3769220">z</a></span><span class="op" id="3769559">.</span><span class="builtinfunc" id="3769560">make</span><span class="op" id="3769564">(</span><span class="ident" id="3769565"><a href="/math/big/nat.go.html#3769278">m</a></span>&nbsp;<span class="op" id="3769567">+</span>&nbsp;<span class="num" id="3769569">1</span><span class="op" id="3769570">)</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3769574">qhatv</span>&nbsp;<span class="op" id="3769580">:=</span>&nbsp;<span class="builtinfunc" id="3769583">make</span><span class="op" id="3769587">(</span><span class="ident" id="3769588"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3769591">,</span>&nbsp;<span class="ident" id="3769593"><a href="/math/big/nat.go.html#3769265">n</a></span><span class="op" id="3769594">+</span><span class="num" id="3769595">1</span><span class="op" id="3769596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3769599">if</span>&nbsp;<span class="ident" id="3769602"><a href="/math/big/nat.go.html#3764870">alias</a></span><span class="op" id="3769607">(</span><span class="ident" id="3769608"><a href="/math/big/nat.go.html#3769236">u</a></span><span class="op" id="3769609">,</span>&nbsp;<span class="ident" id="3769611"><a href="/math/big/nat.go.html#3769239">uIn</a></span><span class="op" id="3769614">)</span>&nbsp;<span class="op" id="3769616">||</span>&nbsp;<span class="ident" id="3769619"><a href="/math/big/nat.go.html#3764870">alias</a></span><span class="op" id="3769624">(</span><span class="ident" id="3769625"><a href="/math/big/nat.go.html#3769236">u</a></span><span class="op" id="3769626">,</span>&nbsp;<span class="ident" id="3769628"><a href="/math/big/nat.go.html#3769244">v</a></span><span class="op" id="3769629">)</span>&nbsp;<span class="op" id="3769631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3769635"><a href="/math/big/nat.go.html#3769236">u</a></span>&nbsp;<span class="op" id="3769637">=</span>&nbsp;<span class="ident" id="3769639">nil</span>&nbsp;<span class="comment" id="3769643">//&nbsp;u&nbsp;is&nbsp;an&nbsp;alias&nbsp;for&nbsp;uIn&nbsp;or&nbsp;v&nbsp;-&nbsp;cannot&nbsp;reuse</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3769689">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3769692"><a href="/math/big/nat.go.html#3769236">u</a></span>&nbsp;<span class="op" id="3769694">=</span>&nbsp;<span class="ident" id="3769696"><a href="/math/big/nat.go.html#3769236">u</a></span><span class="op" id="3769697">.</span><span class="builtinfunc" id="3769698">make</span><span class="op" id="3769702">(</span><span class="builtinfunc" id="3769703">len</span><span class="op" id="3769706">(</span><span class="ident" id="3769707"><a href="/math/big/nat.go.html#3769239">uIn</a></span><span class="op" id="3769710">)</span>&nbsp;<span class="op" id="3769712">+</span>&nbsp;<span class="num" id="3769714">1</span><span class="op" id="3769715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3769718"><a href="/math/big/nat.go.html#3769236">u</a></span><span class="op" id="3769719">.</span><span class="ident" id="3769720">clear</span><span class="op" id="3769725">(</span><span class="op" id="3769726">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3769730">//&nbsp;D1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3769738">shift</span>&nbsp;<span class="op" id="3769744">:=</span>&nbsp;<span class="ident" id="3769747"><a href="/math/big/arith.go.html#3729521">leadingZeros</a></span><span class="op" id="3769759">(</span><span class="ident" id="3769760"><a href="/math/big/nat.go.html#3769244">v</a></span><span class="op" id="3769761">[</span><span class="ident" id="3769762"><a href="/math/big/nat.go.html#3769265">n</a></span><span class="op" id="3769763">-</span><span class="num" id="3769764">1</span><span class="op" id="3769765">]</span><span class="op" id="3769766">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3769769">if</span>&nbsp;<span class="ident" id="3769772"><a href="/math/big/nat.go.html#3769738">shift</a></span>&nbsp;<span class="op" id="3769778">&gt;</span>&nbsp;<span class="num" id="3769780">0</span>&nbsp;<span class="op" id="3769782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3769786">//&nbsp;do&nbsp;not&nbsp;modify&nbsp;v,&nbsp;it&nbsp;may&nbsp;be&nbsp;used&nbsp;by&nbsp;another&nbsp;goroutine&nbsp;simultaneously</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3769859">v1</span>&nbsp;<span class="op" id="3769862">:=</span>&nbsp;<span class="builtinfunc" id="3769865">make</span><span class="op" id="3769869">(</span><span class="ident" id="3769870"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3769873">,</span>&nbsp;<span class="ident" id="3769875"><a href="/math/big/nat.go.html#3769265">n</a></span><span class="op" id="3769876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3769880"><a href="/math/big/arith_decl.go.html#3732062">shlVU</a></span><span class="op" id="3769885">(</span><span class="ident" id="3769886"><a href="/math/big/nat.go.html#3769859">v1</a></span><span class="op" id="3769888">,</span>&nbsp;<span class="ident" id="3769890"><a href="/math/big/nat.go.html#3769244">v</a></span><span class="op" id="3769891">,</span>&nbsp;<span class="ident" id="3769893"><a href="/math/big/nat.go.html#3769738">shift</a></span><span class="op" id="3769898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3769902"><a href="/math/big/nat.go.html#3769244">v</a></span>&nbsp;<span class="op" id="3769904">=</span>&nbsp;<span class="ident" id="3769906"><a href="/math/big/nat.go.html#3769859">v1</a></span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3769910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3769913"><a href="/math/big/nat.go.html#3769236">u</a></span><span class="op" id="3769914">[</span><span class="builtinfunc" id="3769915">len</span><span class="op" id="3769918">(</span><span class="ident" id="3769919"><a href="/math/big/nat.go.html#3769239">uIn</a></span><span class="op" id="3769922">)</span><span class="op" id="3769923">]</span>&nbsp;<span class="op" id="3769925">=</span>&nbsp;<span class="ident" id="3769927"><a href="/math/big/arith_decl.go.html#3732062">shlVU</a></span><span class="op" id="3769932">(</span><span class="ident" id="3769933"><a href="/math/big/nat.go.html#3769236">u</a></span><span class="op" id="3769934">[</span><span class="num" id="3769935">0</span><span class="op" id="3769936">:</span><span class="builtinfunc" id="3769937">len</span><span class="op" id="3769940">(</span><span class="ident" id="3769941"><a href="/math/big/nat.go.html#3769239">uIn</a></span><span class="op" id="3769944">)</span><span class="op" id="3769945">]</span><span class="op" id="3769946">,</span>&nbsp;<span class="ident" id="3769948"><a href="/math/big/nat.go.html#3769239">uIn</a></span><span class="op" id="3769951">,</span>&nbsp;<span class="ident" id="3769953"><a href="/math/big/nat.go.html#3769738">shift</a></span><span class="op" id="3769958">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3769962">//&nbsp;D2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3769970">for</span>&nbsp;<span class="ident" id="3769974">j</span>&nbsp;<span class="op" id="3769976">:=</span>&nbsp;<span class="ident" id="3769979"><a href="/math/big/nat.go.html#3769278">m</a></span><span class="op" id="3769980">;</span>&nbsp;<span class="ident" id="3769982"><a href="/math/big/nat.go.html#3769974">j</a></span>&nbsp;<span class="op" id="3769984">&gt;=</span>&nbsp;<span class="num" id="3769987">0</span><span class="op" id="3769988">;</span>&nbsp;<span class="ident" id="3769990"><a href="/math/big/nat.go.html#3769974">j</a></span><span class="op" id="3769991">--</span>&nbsp;<span class="op" id="3769994">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3769998">//&nbsp;D3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3770007">qhat</span>&nbsp;<span class="op" id="3770012">:=</span>&nbsp;<span class="ident" id="3770015"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3770019">(</span><span class="ident" id="3770020"><a href="/math/big/arith.go.html#3727956">_M</a></span><span class="op" id="3770022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3770026">if</span>&nbsp;<span class="ident" id="3770029"><a href="/math/big/nat.go.html#3769236">u</a></span><span class="op" id="3770030">[</span><span class="ident" id="3770031"><a href="/math/big/nat.go.html#3769974">j</a></span><span class="op" id="3770032">+</span><span class="ident" id="3770033"><a href="/math/big/nat.go.html#3769265">n</a></span><span class="op" id="3770034">]</span>&nbsp;<span class="op" id="3770036">!=</span>&nbsp;<span class="ident" id="3770039"><a href="/math/big/nat.go.html#3769244">v</a></span><span class="op" id="3770040">[</span><span class="ident" id="3770041"><a href="/math/big/nat.go.html#3769265">n</a></span><span class="op" id="3770042">-</span><span class="num" id="3770043">1</span><span class="op" id="3770044">]</span>&nbsp;<span class="op" id="3770046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3770051">var</span>&nbsp;<span class="ident" id="3770055">rhat</span>&nbsp;<span class="ident" id="3770060"><a href="/math/big/arith.go.html#3727748">Word</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3770068"><a href="/math/big/nat.go.html#3770007">qhat</a></span><span class="op" id="3770072">,</span>&nbsp;<span class="ident" id="3770074"><a href="/math/big/nat.go.html#3770055">rhat</a></span>&nbsp;<span class="op" id="3770079">=</span>&nbsp;<span class="ident" id="3770081"><a href="/math/big/arith_decl.go.html#3731869">divWW</a></span><span class="op" id="3770086">(</span><span class="ident" id="3770087"><a href="/math/big/nat.go.html#3769236">u</a></span><span class="op" id="3770088">[</span><span class="ident" id="3770089"><a href="/math/big/nat.go.html#3769974">j</a></span><span class="op" id="3770090">+</span><span class="ident" id="3770091"><a href="/math/big/nat.go.html#3769265">n</a></span><span class="op" id="3770092">]</span><span class="op" id="3770093">,</span>&nbsp;<span class="ident" id="3770095"><a href="/math/big/nat.go.html#3769236">u</a></span><span class="op" id="3770096">[</span><span class="ident" id="3770097"><a href="/math/big/nat.go.html#3769974">j</a></span><span class="op" id="3770098">+</span><span class="ident" id="3770099"><a href="/math/big/nat.go.html#3769265">n</a></span><span class="op" id="3770100">-</span><span class="num" id="3770101">1</span><span class="op" id="3770102">]</span><span class="op" id="3770103">,</span>&nbsp;<span class="ident" id="3770105"><a href="/math/big/nat.go.html#3769244">v</a></span><span class="op" id="3770106">[</span><span class="ident" id="3770107"><a href="/math/big/nat.go.html#3769265">n</a></span><span class="op" id="3770108">-</span><span class="num" id="3770109">1</span><span class="op" id="3770110">]</span><span class="op" id="3770111">)</span><br>
<span class="lineno">565</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3770117">//&nbsp;x1&nbsp;|&nbsp;x2&nbsp;=&nbsp;q̂v_{n-2}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3770144">x1</span><span class="op" id="3770146">,</span>&nbsp;<span class="ident" id="3770148">x2</span>&nbsp;<span class="op" id="3770151">:=</span>&nbsp;<span class="ident" id="3770154"><a href="/math/big/arith_decl.go.html#3731833">mulWW</a></span><span class="op" id="3770159">(</span><span class="ident" id="3770160"><a href="/math/big/nat.go.html#3770007">qhat</a></span><span class="op" id="3770164">,</span>&nbsp;<span class="ident" id="3770166"><a href="/math/big/nat.go.html#3769244">v</a></span><span class="op" id="3770167">[</span><span class="ident" id="3770168"><a href="/math/big/nat.go.html#3769265">n</a></span><span class="op" id="3770169">-</span><span class="num" id="3770170">2</span><span class="op" id="3770171">]</span><span class="op" id="3770172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3770177">//&nbsp;test&nbsp;if&nbsp;q̂v_{n-2}&nbsp;&gt;&nbsp;br̂&nbsp;+&nbsp;u_{j+n-2}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3770221">for</span>&nbsp;<span class="ident" id="3770225"><a href="/math/big/nat.go.html#3785697">greaterThan</a></span><span class="op" id="3770236">(</span><span class="ident" id="3770237"><a href="/math/big/nat.go.html#3770144">x1</a></span><span class="op" id="3770239">,</span>&nbsp;<span class="ident" id="3770241"><a href="/math/big/nat.go.html#3770148">x2</a></span><span class="op" id="3770243">,</span>&nbsp;<span class="ident" id="3770245"><a href="/math/big/nat.go.html#3770055">rhat</a></span><span class="op" id="3770249">,</span>&nbsp;<span class="ident" id="3770251"><a href="/math/big/nat.go.html#3769236">u</a></span><span class="op" id="3770252">[</span><span class="ident" id="3770253"><a href="/math/big/nat.go.html#3769974">j</a></span><span class="op" id="3770254">+</span><span class="ident" id="3770255"><a href="/math/big/nat.go.html#3769265">n</a></span><span class="op" id="3770256">-</span><span class="num" id="3770257">2</span><span class="op" id="3770258">]</span><span class="op" id="3770259">)</span>&nbsp;<span class="op" id="3770261">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3770267"><a href="/math/big/nat.go.html#3770007">qhat</a></span><span class="op" id="3770271">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3770278">prevRhat</span>&nbsp;<span class="op" id="3770287">:=</span>&nbsp;<span class="ident" id="3770290"><a href="/math/big/nat.go.html#3770055">rhat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3770299"><a href="/math/big/nat.go.html#3770055">rhat</a></span>&nbsp;<span class="op" id="3770304">+=</span>&nbsp;<span class="ident" id="3770307"><a href="/math/big/nat.go.html#3769244">v</a></span><span class="op" id="3770308">[</span><span class="ident" id="3770309"><a href="/math/big/nat.go.html#3769265">n</a></span><span class="op" id="3770310">-</span><span class="num" id="3770311">1</span><span class="op" id="3770312">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3770318">//&nbsp;v[n-1]&nbsp;&gt;=&nbsp;0,&nbsp;so&nbsp;this&nbsp;tests&nbsp;for&nbsp;overflow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3770366">if</span>&nbsp;<span class="ident" id="3770369"><a href="/math/big/nat.go.html#3770055">rhat</a></span>&nbsp;<span class="op" id="3770374">&lt;</span>&nbsp;<span class="ident" id="3770376"><a href="/math/big/nat.go.html#3770278">prevRhat</a></span>&nbsp;<span class="op" id="3770385">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3770392">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3770402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3770408"><a href="/math/big/nat.go.html#3770144">x1</a></span><span class="op" id="3770410">,</span>&nbsp;<span class="ident" id="3770412"><a href="/math/big/nat.go.html#3770148">x2</a></span>&nbsp;<span class="op" id="3770415">=</span>&nbsp;<span class="ident" id="3770417"><a href="/math/big/arith_decl.go.html#3731833">mulWW</a></span><span class="op" id="3770422">(</span><span class="ident" id="3770423"><a href="/math/big/nat.go.html#3770007">qhat</a></span><span class="op" id="3770427">,</span>&nbsp;<span class="ident" id="3770429"><a href="/math/big/nat.go.html#3769244">v</a></span><span class="op" id="3770430">[</span><span class="ident" id="3770431"><a href="/math/big/nat.go.html#3769265">n</a></span><span class="op" id="3770432">-</span><span class="num" id="3770433">2</span><span class="op" id="3770434">]</span><span class="op" id="3770435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3770440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3770444">}</span><br>
<span class="lineno">580</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3770449">//&nbsp;D4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3770458"><a href="/math/big/nat.go.html#3769574">qhatv</a></span><span class="op" id="3770463">[</span><span class="ident" id="3770464"><a href="/math/big/nat.go.html#3769265">n</a></span><span class="op" id="3770465">]</span>&nbsp;<span class="op" id="3770467">=</span>&nbsp;<span class="ident" id="3770469"><a href="/math/big/arith_decl.go.html#3732144">mulAddVWW</a></span><span class="op" id="3770478">(</span><span class="ident" id="3770479"><a href="/math/big/nat.go.html#3769574">qhatv</a></span><span class="op" id="3770484">[</span><span class="num" id="3770485">0</span><span class="op" id="3770486">:</span><span class="ident" id="3770487"><a href="/math/big/nat.go.html#3769265">n</a></span><span class="op" id="3770488">]</span><span class="op" id="3770489">,</span>&nbsp;<span class="ident" id="3770491"><a href="/math/big/nat.go.html#3769244">v</a></span><span class="op" id="3770492">,</span>&nbsp;<span class="ident" id="3770494"><a href="/math/big/nat.go.html#3770007">qhat</a></span><span class="op" id="3770498">,</span>&nbsp;<span class="num" id="3770500">0</span><span class="op" id="3770501">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3770506">c</span>&nbsp;<span class="op" id="3770508">:=</span>&nbsp;<span class="ident" id="3770511"><a href="/math/big/arith_decl.go.html#3731944">subVV</a></span><span class="op" id="3770516">(</span><span class="ident" id="3770517"><a href="/math/big/nat.go.html#3769236">u</a></span><span class="op" id="3770518">[</span><span class="ident" id="3770519"><a href="/math/big/nat.go.html#3769974">j</a></span><span class="op" id="3770520">:</span><span class="ident" id="3770521"><a href="/math/big/nat.go.html#3769974">j</a></span><span class="op" id="3770522">+</span><span class="builtinfunc" id="3770523">len</span><span class="op" id="3770526">(</span><span class="ident" id="3770527"><a href="/math/big/nat.go.html#3769574">qhatv</a></span><span class="op" id="3770532">)</span><span class="op" id="3770533">]</span><span class="op" id="3770534">,</span>&nbsp;<span class="ident" id="3770536"><a href="/math/big/nat.go.html#3769236">u</a></span><span class="op" id="3770537">[</span><span class="ident" id="3770538"><a href="/math/big/nat.go.html#3769974">j</a></span><span class="op" id="3770539">:</span><span class="op" id="3770540">]</span><span class="op" id="3770541">,</span>&nbsp;<span class="ident" id="3770543"><a href="/math/big/nat.go.html#3769574">qhatv</a></span><span class="op" id="3770548">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3770552">if</span>&nbsp;<span class="ident" id="3770555"><a href="/math/big/nat.go.html#3770506">c</a></span>&nbsp;<span class="op" id="3770557">!=</span>&nbsp;<span class="num" id="3770560">0</span>&nbsp;<span class="op" id="3770562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3770567">c</span>&nbsp;<span class="op" id="3770569">:=</span>&nbsp;<span class="ident" id="3770572"><a href="/math/big/arith_decl.go.html#3731908">addVV</a></span><span class="op" id="3770577">(</span><span class="ident" id="3770578"><a href="/math/big/nat.go.html#3769236">u</a></span><span class="op" id="3770579">[</span><span class="ident" id="3770580"><a href="/math/big/nat.go.html#3769974">j</a></span><span class="op" id="3770581">:</span><span class="ident" id="3770582"><a href="/math/big/nat.go.html#3769974">j</a></span><span class="op" id="3770583">+</span><span class="ident" id="3770584"><a href="/math/big/nat.go.html#3769265">n</a></span><span class="op" id="3770585">]</span><span class="op" id="3770586">,</span>&nbsp;<span class="ident" id="3770588"><a href="/math/big/nat.go.html#3769236">u</a></span><span class="op" id="3770589">[</span><span class="ident" id="3770590"><a href="/math/big/nat.go.html#3769974">j</a></span><span class="op" id="3770591">:</span><span class="op" id="3770592">]</span><span class="op" id="3770593">,</span>&nbsp;<span class="ident" id="3770595"><a href="/math/big/nat.go.html#3769244">v</a></span><span class="op" id="3770596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3770601"><a href="/math/big/nat.go.html#3769236">u</a></span><span class="op" id="3770602">[</span><span class="ident" id="3770603"><a href="/math/big/nat.go.html#3769974">j</a></span><span class="op" id="3770604">+</span><span class="ident" id="3770605"><a href="/math/big/nat.go.html#3769265">n</a></span><span class="op" id="3770606">]</span>&nbsp;<span class="op" id="3770608">+=</span>&nbsp;<span class="ident" id="3770611"><a href="/math/big/nat.go.html#3770567">c</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3770616"><a href="/math/big/nat.go.html#3770007">qhat</a></span><span class="op" id="3770620">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3770625">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3770630"><a href="/math/big/nat.go.html#3769252">q</a></span><span class="op" id="3770631">[</span><span class="ident" id="3770632"><a href="/math/big/nat.go.html#3769974">j</a></span><span class="op" id="3770633">]</span>&nbsp;<span class="op" id="3770635">=</span>&nbsp;<span class="ident" id="3770637"><a href="/math/big/nat.go.html#3770007">qhat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3770643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3770647"><a href="/math/big/nat.go.html#3769252">q</a></span>&nbsp;<span class="op" id="3770649">=</span>&nbsp;<span class="ident" id="3770651"><a href="/math/big/nat.go.html#3769252">q</a></span><span class="op" id="3770652">.</span><span class="ident" id="3770653">norm</span><span class="op" id="3770657">(</span><span class="op" id="3770658">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3770661"><a href="/math/big/arith_decl.go.html#3732103">shrVU</a></span><span class="op" id="3770666">(</span><span class="ident" id="3770667"><a href="/math/big/nat.go.html#3769236">u</a></span><span class="op" id="3770668">,</span>&nbsp;<span class="ident" id="3770670"><a href="/math/big/nat.go.html#3769236">u</a></span><span class="op" id="3770671">,</span>&nbsp;<span class="ident" id="3770673"><a href="/math/big/nat.go.html#3769738">shift</a></span><span class="op" id="3770678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3770681"><a href="/math/big/nat.go.html#3769255">r</a></span>&nbsp;<span class="op" id="3770683">=</span>&nbsp;<span class="ident" id="3770685"><a href="/math/big/nat.go.html#3769236">u</a></span><span class="op" id="3770686">.</span><span class="ident" id="3770687">norm</span><span class="op" id="3770691">(</span><span class="op" id="3770692">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3770696">return</span>&nbsp;<span class="ident" id="3770703"><a href="/math/big/nat.go.html#3769252">q</a></span><span class="op" id="3770704">,</span>&nbsp;<span class="ident" id="3770706"><a href="/math/big/nat.go.html#3769255">r</a></span><br>
<span class="lineno"></span><span class="op" id="3770708">}</span><br>
<span class="lineno">600</span><br>
<span class="lineno"></span><span class="comment" id="3770711">//&nbsp;Length&nbsp;of&nbsp;x&nbsp;in&nbsp;bits.&nbsp;x&nbsp;must&nbsp;be&nbsp;normalized.</span><br>
<span class="lineno"></span><span class="keyword" id="3770757">func</span>&nbsp;<span class="op" id="3770762">(</span><span class="ident" id="3770763">x</span>&nbsp;<span class="ident" id="3770765"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3770768">)</span>&nbsp;<span class="ident" id="3770770">bitLen</span><span class="op" id="3770776">(</span><span class="op" id="3770777">)</span>&nbsp;<span class="builtintype" id="3770779">int</span>&nbsp;<span class="op" id="3770783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3770786">if</span>&nbsp;<span class="ident" id="3770789">i</span>&nbsp;<span class="op" id="3770791">:=</span>&nbsp;<span class="builtinfunc" id="3770794">len</span><span class="op" id="3770797">(</span><span class="ident" id="3770798"><a href="/math/big/nat.go.html#3770763">x</a></span><span class="op" id="3770799">)</span>&nbsp;<span class="op" id="3770801">-</span>&nbsp;<span class="num" id="3770803">1</span><span class="op" id="3770804">;</span>&nbsp;<span class="ident" id="3770806"><a href="/math/big/nat.go.html#3770789">i</a></span>&nbsp;<span class="op" id="3770808">&gt;=</span>&nbsp;<span class="num" id="3770811">0</span>&nbsp;<span class="op" id="3770813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3770817">return</span>&nbsp;<span class="ident" id="3770824"><a href="/math/big/nat.go.html#3770789">i</a></span><span class="op" id="3770825">*</span><span class="ident" id="3770826"><a href="/math/big/arith.go.html#3727893">_W</a></span>&nbsp;<span class="op" id="3770829">+</span>&nbsp;<span class="ident" id="3770831"><a href="/math/big/arith_decl.go.html#3732295">bitLen</a></span><span class="op" id="3770837">(</span><span class="ident" id="3770838"><a href="/math/big/nat.go.html#3770763">x</a></span><span class="op" id="3770839">[</span><span class="ident" id="3770840"><a href="/math/big/nat.go.html#3770789">i</a></span><span class="op" id="3770841">]</span><span class="op" id="3770842">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3770845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3770848">return</span>&nbsp;<span class="num" id="3770855">0</span><br>
<span class="lineno"></span><span class="op" id="3770857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3770860">//&nbsp;MaxBase&nbsp;is&nbsp;the&nbsp;largest&nbsp;number&nbsp;base&nbsp;accepted&nbsp;for&nbsp;string&nbsp;conversions.</span><br>
<span class="lineno">610</span><span class="keyword" id="3770931">const</span>&nbsp;<span class="ident" id="3770937">MaxBase</span>&nbsp;<span class="op" id="3770945">=</span>&nbsp;<span class="string" id="3770947">&#39;z&#39;</span>&nbsp;<span class="op" id="3770951">-</span>&nbsp;<span class="string" id="3770953">&#39;a&#39;</span>&nbsp;<span class="op" id="3770957">+</span>&nbsp;<span class="num" id="3770959">10</span>&nbsp;<span class="op" id="3770962">+</span>&nbsp;<span class="num" id="3770964">1</span>&nbsp;<span class="comment" id="3770966">//&nbsp;=&nbsp;hexValue(&#39;z&#39;)&nbsp;+&nbsp;1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3770990">func</span>&nbsp;<span class="ident" id="3770995">hexValue</span><span class="op" id="3771003">(</span><span class="ident" id="3771004">ch</span>&nbsp;<span class="builtintype" id="3771007">rune</span><span class="op" id="3771011">)</span>&nbsp;<span class="ident" id="3771013"><a href="/math/big/arith.go.html#3727748">Word</a></span>&nbsp;<span class="op" id="3771018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3771021">d</span>&nbsp;<span class="op" id="3771023">:=</span>&nbsp;<span class="builtintype" id="3771026">int</span><span class="op" id="3771029">(</span><span class="ident" id="3771030"><a href="/math/big/nat.go.html#3770937">MaxBase</a></span>&nbsp;<span class="op" id="3771038">+</span>&nbsp;<span class="num" id="3771040">1</span><span class="op" id="3771041">)</span>&nbsp;<span class="comment" id="3771043">//&nbsp;illegal&nbsp;base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3771060">switch</span>&nbsp;<span class="op" id="3771067">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3771070">case</span>&nbsp;<span class="string" id="3771075">&#39;0&#39;</span>&nbsp;<span class="op" id="3771079">&lt;=</span>&nbsp;<span class="ident" id="3771082"><a href="/math/big/nat.go.html#3771004">ch</a></span>&nbsp;<span class="op" id="3771085">&amp;&amp;</span>&nbsp;<span class="ident" id="3771088"><a href="/math/big/nat.go.html#3771004">ch</a></span>&nbsp;<span class="op" id="3771091">&lt;=</span>&nbsp;<span class="string" id="3771094">&#39;9&#39;</span><span class="op" id="3771097">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3771101"><a href="/math/big/nat.go.html#3771021">d</a></span>&nbsp;<span class="op" id="3771103">=</span>&nbsp;<span class="builtintype" id="3771105">int</span><span class="op" id="3771108">(</span><span class="ident" id="3771109"><a href="/math/big/nat.go.html#3771004">ch</a></span>&nbsp;<span class="op" id="3771112">-</span>&nbsp;<span class="string" id="3771114">&#39;0&#39;</span><span class="op" id="3771117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3771120">case</span>&nbsp;<span class="string" id="3771125">&#39;a&#39;</span>&nbsp;<span class="op" id="3771129">&lt;=</span>&nbsp;<span class="ident" id="3771132"><a href="/math/big/nat.go.html#3771004">ch</a></span>&nbsp;<span class="op" id="3771135">&amp;&amp;</span>&nbsp;<span class="ident" id="3771138"><a href="/math/big/nat.go.html#3771004">ch</a></span>&nbsp;<span class="op" id="3771141">&lt;=</span>&nbsp;<span class="string" id="3771144">&#39;z&#39;</span><span class="op" id="3771147">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3771151"><a href="/math/big/nat.go.html#3771021">d</a></span>&nbsp;<span class="op" id="3771153">=</span>&nbsp;<span class="builtintype" id="3771155">int</span><span class="op" id="3771158">(</span><span class="ident" id="3771159"><a href="/math/big/nat.go.html#3771004">ch</a></span>&nbsp;<span class="op" id="3771162">-</span>&nbsp;<span class="string" id="3771164">&#39;a&#39;</span>&nbsp;<span class="op" id="3771168">+</span>&nbsp;<span class="num" id="3771170">10</span><span class="op" id="3771172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3771175">case</span>&nbsp;<span class="string" id="3771180">&#39;A&#39;</span>&nbsp;<span class="op" id="3771184">&lt;=</span>&nbsp;<span class="ident" id="3771187"><a href="/math/big/nat.go.html#3771004">ch</a></span>&nbsp;<span class="op" id="3771190">&amp;&amp;</span>&nbsp;<span class="ident" id="3771193"><a href="/math/big/nat.go.html#3771004">ch</a></span>&nbsp;<span class="op" id="3771196">&lt;=</span>&nbsp;<span class="string" id="3771199">&#39;Z&#39;</span><span class="op" id="3771202">:</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3771206"><a href="/math/big/nat.go.html#3771021">d</a></span>&nbsp;<span class="op" id="3771208">=</span>&nbsp;<span class="builtintype" id="3771210">int</span><span class="op" id="3771213">(</span><span class="ident" id="3771214"><a href="/math/big/nat.go.html#3771004">ch</a></span>&nbsp;<span class="op" id="3771217">-</span>&nbsp;<span class="string" id="3771219">&#39;A&#39;</span>&nbsp;<span class="op" id="3771223">+</span>&nbsp;<span class="num" id="3771225">10</span><span class="op" id="3771227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3771230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3771233">return</span>&nbsp;<span class="ident" id="3771240"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3771244">(</span><span class="ident" id="3771245"><a href="/math/big/nat.go.html#3771021">d</a></span><span class="op" id="3771246">)</span><br>
<span class="lineno"></span><span class="op" id="3771248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">625</span><span class="comment" id="3771251">//&nbsp;scan&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;natural&nbsp;number&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;longest&nbsp;possible&nbsp;prefix</span><br>
<span class="lineno"></span><span class="comment" id="3771333">//&nbsp;read&nbsp;from&nbsp;r&nbsp;representing&nbsp;an&nbsp;unsigned&nbsp;integer&nbsp;in&nbsp;a&nbsp;given&nbsp;conversion&nbsp;base.</span><br>
<span class="lineno"></span><span class="comment" id="3771409">//&nbsp;It&nbsp;returns&nbsp;z,&nbsp;the&nbsp;actual&nbsp;conversion&nbsp;base&nbsp;used,&nbsp;and&nbsp;an&nbsp;error,&nbsp;if&nbsp;any.&nbsp;In&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3771488">//&nbsp;error&nbsp;case,&nbsp;the&nbsp;value&nbsp;of&nbsp;z&nbsp;is&nbsp;undefined.&nbsp;The&nbsp;syntax&nbsp;follows&nbsp;the&nbsp;syntax&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3771565">//&nbsp;unsigned&nbsp;integer&nbsp;literals&nbsp;in&nbsp;Go.</span><br>
<span class="lineno">630</span><span class="comment" id="3771601">//</span><br>
<span class="lineno"></span><span class="comment" id="3771604">//&nbsp;The&nbsp;base&nbsp;argument&nbsp;must&nbsp;be&nbsp;0&nbsp;or&nbsp;a&nbsp;value&nbsp;from&nbsp;2&nbsp;through&nbsp;MaxBase.&nbsp;If&nbsp;the&nbsp;base</span><br>
<span class="lineno"></span><span class="comment" id="3771682">//&nbsp;is&nbsp;0,&nbsp;the&nbsp;string&nbsp;prefix&nbsp;determines&nbsp;the&nbsp;actual&nbsp;conversion&nbsp;base.&nbsp;A&nbsp;prefix&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3771760">//&nbsp;``0x&#39;&#39;&nbsp;or&nbsp;``0X&#39;&#39;&nbsp;selects&nbsp;base&nbsp;16;&nbsp;the&nbsp;``0&#39;&#39;&nbsp;prefix&nbsp;selects&nbsp;base&nbsp;8,&nbsp;and&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3771836">//&nbsp;``0b&#39;&#39;&nbsp;or&nbsp;``0B&#39;&#39;&nbsp;prefix&nbsp;selects&nbsp;base&nbsp;2.&nbsp;Otherwise&nbsp;the&nbsp;selected&nbsp;base&nbsp;is&nbsp;10.</span><br>
<span class="lineno">635</span><span class="comment" id="3771914">//</span><br>
<span class="lineno"></span><span class="keyword" id="3771917">func</span>&nbsp;<span class="op" id="3771922">(</span><span class="ident" id="3771923">z</span>&nbsp;<span class="ident" id="3771925"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3771928">)</span>&nbsp;<span class="ident" id="3771930">scan</span><span class="op" id="3771934">(</span><span class="ident" id="3771935">r</span>&nbsp;<span class="ident" id="3771937"><a href="/math/big/nat.go.html#3758342">io</a></span><span class="op" id="3771939">.</span><span class="ident" id="3771940">RuneScanner</span><span class="op" id="3771951">,</span>&nbsp;<span class="ident" id="3771953">base</span>&nbsp;<span class="builtintype" id="3771958">int</span><span class="op" id="3771961">)</span>&nbsp;<span class="op" id="3771963">(</span><span class="ident" id="3771964"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3771967">,</span>&nbsp;<span class="builtintype" id="3771969">int</span><span class="op" id="3771972">,</span>&nbsp;<span class="builtintype" id="3771974">error</span><span class="op" id="3771979">)</span>&nbsp;<span class="op" id="3771981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3771984">//&nbsp;reject&nbsp;illegal&nbsp;bases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3772009">if</span>&nbsp;<span class="ident" id="3772012"><a href="/math/big/nat.go.html#3771953">base</a></span>&nbsp;<span class="op" id="3772017">&lt;</span>&nbsp;<span class="num" id="3772019">0</span>&nbsp;<span class="op" id="3772021">||</span>&nbsp;<span class="ident" id="3772024"><a href="/math/big/nat.go.html#3771953">base</a></span>&nbsp;<span class="op" id="3772029">==</span>&nbsp;<span class="num" id="3772032">1</span>&nbsp;<span class="op" id="3772034">||</span>&nbsp;<span class="ident" id="3772037"><a href="/math/big/nat.go.html#3770937">MaxBase</a></span>&nbsp;<span class="op" id="3772045">&lt;</span>&nbsp;<span class="ident" id="3772047"><a href="/math/big/nat.go.html#3771953">base</a></span>&nbsp;<span class="op" id="3772052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3772056">return</span>&nbsp;<span class="ident" id="3772063"><a href="/math/big/nat.go.html#3771923">z</a></span><span class="op" id="3772064">,</span>&nbsp;<span class="num" id="3772066">0</span><span class="op" id="3772067">,</span>&nbsp;<span class="ident" id="3772069"><a href="/math/big/nat.go.html#3758332">errors</a></span><span class="op" id="3772075">.</span><span class="ident" id="3772076">New</span><span class="op" id="3772079">(</span><span class="string" id="3772080">&#34;illegal&nbsp;number&nbsp;base&#34;</span><span class="op" id="3772101">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3772104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3772108">//&nbsp;one&nbsp;char&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3772132">ch</span><span class="op" id="3772134">,</span>&nbsp;<span class="ident" id="3772136">_</span><span class="op" id="3772137">,</span>&nbsp;<span class="ident" id="3772139">err</span>&nbsp;<span class="op" id="3772143">:=</span>&nbsp;<span class="ident" id="3772146"><a href="/math/big/nat.go.html#3771935">r</a></span><span class="op" id="3772147">.</span><span class="ident" id="3772148">ReadRune</span><span class="op" id="3772156">(</span><span class="op" id="3772157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3772160">if</span>&nbsp;<span class="ident" id="3772163"><a href="/math/big/nat.go.html#3772139">err</a></span>&nbsp;<span class="op" id="3772167">!=</span>&nbsp;<span class="ident" id="3772170">nil</span>&nbsp;<span class="op" id="3772174">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3772178">return</span>&nbsp;<span class="ident" id="3772185"><a href="/math/big/nat.go.html#3771923">z</a></span><span class="op" id="3772186">,</span>&nbsp;<span class="num" id="3772188">0</span><span class="op" id="3772189">,</span>&nbsp;<span class="ident" id="3772191"><a href="/math/big/nat.go.html#3772139">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3772196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3772200">//&nbsp;determine&nbsp;base&nbsp;if&nbsp;necessary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3772232">b</span>&nbsp;<span class="op" id="3772234">:=</span>&nbsp;<span class="ident" id="3772237"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3772241">(</span><span class="ident" id="3772242"><a href="/math/big/nat.go.html#3771953">base</a></span><span class="op" id="3772246">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3772249">if</span>&nbsp;<span class="ident" id="3772252"><a href="/math/big/nat.go.html#3771953">base</a></span>&nbsp;<span class="op" id="3772257">==</span>&nbsp;<span class="num" id="3772260">0</span>&nbsp;<span class="op" id="3772262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3772266"><a href="/math/big/nat.go.html#3772232">b</a></span>&nbsp;<span class="op" id="3772268">=</span>&nbsp;<span class="num" id="3772270">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3772275">if</span>&nbsp;<span class="ident" id="3772278"><a href="/math/big/nat.go.html#3772132">ch</a></span>&nbsp;<span class="op" id="3772281">==</span>&nbsp;<span class="string" id="3772284">&#39;0&#39;</span>&nbsp;<span class="op" id="3772288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3772293">switch</span>&nbsp;<span class="ident" id="3772300"><a href="/math/big/nat.go.html#3772132">ch</a></span><span class="op" id="3772302">,</span>&nbsp;<span class="ident" id="3772304">_</span><span class="op" id="3772305">,</span>&nbsp;<span class="ident" id="3772307"><a href="/math/big/nat.go.html#3772139">err</a></span>&nbsp;<span class="op" id="3772311">=</span>&nbsp;<span class="ident" id="3772313"><a href="/math/big/nat.go.html#3771935">r</a></span><span class="op" id="3772314">.</span><span class="ident" id="3772315">ReadRune</span><span class="op" id="3772323">(</span><span class="op" id="3772324">)</span><span class="op" id="3772325">;</span>&nbsp;<span class="ident" id="3772327"><a href="/math/big/nat.go.html#3772139">err</a></span>&nbsp;<span class="op" id="3772331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3772336">case</span>&nbsp;<span class="ident" id="3772341">nil</span><span class="op" id="3772344">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3772350"><a href="/math/big/nat.go.html#3772232">b</a></span>&nbsp;<span class="op" id="3772352">=</span>&nbsp;<span class="num" id="3772354">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3772360">switch</span>&nbsp;<span class="ident" id="3772367"><a href="/math/big/nat.go.html#3772132">ch</a></span>&nbsp;<span class="op" id="3772370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3772376">case</span>&nbsp;<span class="string" id="3772381">&#39;x&#39;</span><span class="op" id="3772384">,</span>&nbsp;<span class="string" id="3772386">&#39;X&#39;</span><span class="op" id="3772389">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3772396"><a href="/math/big/nat.go.html#3772232">b</a></span>&nbsp;<span class="op" id="3772398">=</span>&nbsp;<span class="num" id="3772400">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3772407">case</span>&nbsp;<span class="string" id="3772412">&#39;b&#39;</span><span class="op" id="3772415">,</span>&nbsp;<span class="string" id="3772417">&#39;B&#39;</span><span class="op" id="3772420">:</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3772427"><a href="/math/big/nat.go.html#3772232">b</a></span>&nbsp;<span class="op" id="3772429">=</span>&nbsp;<span class="num" id="3772431">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3772437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3772443">if</span>&nbsp;<span class="ident" id="3772446"><a href="/math/big/nat.go.html#3772232">b</a></span>&nbsp;<span class="op" id="3772448">==</span>&nbsp;<span class="num" id="3772451">2</span>&nbsp;<span class="op" id="3772453">||</span>&nbsp;<span class="ident" id="3772456"><a href="/math/big/nat.go.html#3772232">b</a></span>&nbsp;<span class="op" id="3772458">==</span>&nbsp;<span class="num" id="3772461">16</span>&nbsp;<span class="op" id="3772464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3772471">if</span>&nbsp;<span class="ident" id="3772474"><a href="/math/big/nat.go.html#3772132">ch</a></span><span class="op" id="3772476">,</span>&nbsp;<span class="ident" id="3772478">_</span><span class="op" id="3772479">,</span>&nbsp;<span class="ident" id="3772481"><a href="/math/big/nat.go.html#3772139">err</a></span>&nbsp;<span class="op" id="3772485">=</span>&nbsp;<span class="ident" id="3772487"><a href="/math/big/nat.go.html#3771935">r</a></span><span class="op" id="3772488">.</span><span class="ident" id="3772489">ReadRune</span><span class="op" id="3772497">(</span><span class="op" id="3772498">)</span><span class="op" id="3772499">;</span>&nbsp;<span class="ident" id="3772501"><a href="/math/big/nat.go.html#3772139">err</a></span>&nbsp;<span class="op" id="3772505">!=</span>&nbsp;<span class="ident" id="3772508">nil</span>&nbsp;<span class="op" id="3772512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3772520">return</span>&nbsp;<span class="ident" id="3772527"><a href="/math/big/nat.go.html#3771923">z</a></span><span class="op" id="3772528">,</span>&nbsp;<span class="num" id="3772530">0</span><span class="op" id="3772531">,</span>&nbsp;<span class="ident" id="3772533"><a href="/math/big/nat.go.html#3772139">err</a></span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3772542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3772548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3772553">case</span>&nbsp;<span class="ident" id="3772558"><a href="/math/big/nat.go.html#3758342">io</a></span><span class="op" id="3772560">.</span><span class="ident" id="3772561">EOF</span><span class="op" id="3772564">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3772570">return</span>&nbsp;<span class="ident" id="3772577"><a href="/math/big/nat.go.html#3771923">z</a></span><span class="op" id="3772578">.</span><span class="builtinfunc" id="3772579">make</span><span class="op" id="3772583">(</span><span class="num" id="3772584">0</span><span class="op" id="3772585">)</span><span class="op" id="3772586">,</span>&nbsp;<span class="num" id="3772588">10</span><span class="op" id="3772590">,</span>&nbsp;<span class="ident" id="3772592">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3772599">default</span><span class="op" id="3772606">:</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3772612">return</span>&nbsp;<span class="ident" id="3772619"><a href="/math/big/nat.go.html#3771923">z</a></span><span class="op" id="3772620">,</span>&nbsp;<span class="num" id="3772622">10</span><span class="op" id="3772624">,</span>&nbsp;<span class="ident" id="3772626"><a href="/math/big/nat.go.html#3772139">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3772633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3772637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3772640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3772644">//&nbsp;convert&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3772663">//&nbsp;-&nbsp;group&nbsp;as&nbsp;many&nbsp;digits&nbsp;d&nbsp;as&nbsp;possible&nbsp;together&nbsp;into&nbsp;a&nbsp;&#34;super-digit&#34;&nbsp;dd&nbsp;with&nbsp;&#34;super-base&#34;&nbsp;bb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3772758">//&nbsp;-&nbsp;only&nbsp;when&nbsp;bb&nbsp;does&nbsp;not&nbsp;fit&nbsp;into&nbsp;a&nbsp;word&nbsp;anymore,&nbsp;do&nbsp;a&nbsp;full&nbsp;number&nbsp;mulAddWW&nbsp;using&nbsp;bb&nbsp;and&nbsp;dd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3772853"><a href="/math/big/nat.go.html#3771923">z</a></span>&nbsp;<span class="op" id="3772855">=</span>&nbsp;<span class="ident" id="3772857"><a href="/math/big/nat.go.html#3771923">z</a></span><span class="op" id="3772858">.</span><span class="builtinfunc" id="3772859">make</span><span class="op" id="3772863">(</span><span class="num" id="3772864">0</span><span class="op" id="3772865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3772868">bb</span>&nbsp;<span class="op" id="3772871">:=</span>&nbsp;<span class="ident" id="3772874"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3772878">(</span><span class="num" id="3772879">1</span><span class="op" id="3772880">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3772883">dd</span>&nbsp;<span class="op" id="3772886">:=</span>&nbsp;<span class="ident" id="3772889"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3772893">(</span><span class="num" id="3772894">0</span><span class="op" id="3772895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3772898">for</span>&nbsp;<span class="ident" id="3772902">max</span>&nbsp;<span class="op" id="3772906">:=</span>&nbsp;<span class="ident" id="3772909"><a href="/math/big/arith.go.html#3727956">_M</a></span>&nbsp;<span class="op" id="3772912">/</span>&nbsp;<span class="ident" id="3772914"><a href="/math/big/nat.go.html#3772232">b</a></span><span class="op" id="3772915">;</span>&nbsp;<span class="op" id="3772917">;</span>&nbsp;<span class="op" id="3772919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3772923">d</span>&nbsp;<span class="op" id="3772925">:=</span>&nbsp;<span class="ident" id="3772928"><a href="/math/big/nat.go.html#3770995">hexValue</a></span><span class="op" id="3772936">(</span><span class="ident" id="3772937"><a href="/math/big/nat.go.html#3772132">ch</a></span><span class="op" id="3772939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3772943">if</span>&nbsp;<span class="ident" id="3772946"><a href="/math/big/nat.go.html#3772923">d</a></span>&nbsp;<span class="op" id="3772948">&gt;=</span>&nbsp;<span class="ident" id="3772951"><a href="/math/big/nat.go.html#3772232">b</a></span>&nbsp;<span class="op" id="3772953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3772958"><a href="/math/big/nat.go.html#3771935">r</a></span><span class="op" id="3772959">.</span><span class="ident" id="3772960">UnreadRune</span><span class="op" id="3772970">(</span><span class="op" id="3772971">)</span>&nbsp;<span class="comment" id="3772973">//&nbsp;ch&nbsp;does&nbsp;not&nbsp;belong&nbsp;to&nbsp;number&nbsp;anymore</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3773016">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3773024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3773029">if</span>&nbsp;<span class="ident" id="3773032"><a href="/math/big/nat.go.html#3772868">bb</a></span>&nbsp;<span class="op" id="3773035">&lt;=</span>&nbsp;<span class="ident" id="3773038"><a href="/math/big/nat.go.html#3772902">max</a></span>&nbsp;<span class="op" id="3773042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3773047"><a href="/math/big/nat.go.html#3772868">bb</a></span>&nbsp;<span class="op" id="3773050">*=</span>&nbsp;<span class="ident" id="3773053"><a href="/math/big/nat.go.html#3772232">b</a></span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3773058"><a href="/math/big/nat.go.html#3772883">dd</a></span>&nbsp;<span class="op" id="3773061">=</span>&nbsp;<span class="ident" id="3773063"><a href="/math/big/nat.go.html#3772883">dd</a></span><span class="op" id="3773065">*</span><span class="ident" id="3773066"><a href="/math/big/nat.go.html#3772232">b</a></span>&nbsp;<span class="op" id="3773068">+</span>&nbsp;<span class="ident" id="3773070"><a href="/math/big/nat.go.html#3772923">d</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3773074">}</span>&nbsp;<span class="keyword" id="3773076">else</span>&nbsp;<span class="op" id="3773081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3773086">//&nbsp;bb&nbsp;*&nbsp;b&nbsp;would&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3773114"><a href="/math/big/nat.go.html#3771923">z</a></span>&nbsp;<span class="op" id="3773116">=</span>&nbsp;<span class="ident" id="3773118"><a href="/math/big/nat.go.html#3771923">z</a></span><span class="op" id="3773119">.</span><span class="ident" id="3773120">mulAddWW</span><span class="op" id="3773128">(</span><span class="ident" id="3773129"><a href="/math/big/nat.go.html#3771923">z</a></span><span class="op" id="3773130">,</span>&nbsp;<span class="ident" id="3773132"><a href="/math/big/nat.go.html#3772868">bb</a></span><span class="op" id="3773134">,</span>&nbsp;<span class="ident" id="3773136"><a href="/math/big/nat.go.html#3772883">dd</a></span><span class="op" id="3773138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3773143"><a href="/math/big/nat.go.html#3772868">bb</a></span>&nbsp;<span class="op" id="3773146">=</span>&nbsp;<span class="ident" id="3773148"><a href="/math/big/nat.go.html#3772232">b</a></span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3773153"><a href="/math/big/nat.go.html#3772883">dd</a></span>&nbsp;<span class="op" id="3773156">=</span>&nbsp;<span class="ident" id="3773158"><a href="/math/big/nat.go.html#3772923">d</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3773162">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3773167">if</span>&nbsp;<span class="ident" id="3773170"><a href="/math/big/nat.go.html#3772132">ch</a></span><span class="op" id="3773172">,</span>&nbsp;<span class="ident" id="3773174">_</span><span class="op" id="3773175">,</span>&nbsp;<span class="ident" id="3773177"><a href="/math/big/nat.go.html#3772139">err</a></span>&nbsp;<span class="op" id="3773181">=</span>&nbsp;<span class="ident" id="3773183"><a href="/math/big/nat.go.html#3771935">r</a></span><span class="op" id="3773184">.</span><span class="ident" id="3773185">ReadRune</span><span class="op" id="3773193">(</span><span class="op" id="3773194">)</span><span class="op" id="3773195">;</span>&nbsp;<span class="ident" id="3773197"><a href="/math/big/nat.go.html#3772139">err</a></span>&nbsp;<span class="op" id="3773201">!=</span>&nbsp;<span class="ident" id="3773204">nil</span>&nbsp;<span class="op" id="3773208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3773213">if</span>&nbsp;<span class="ident" id="3773216"><a href="/math/big/nat.go.html#3772139">err</a></span>&nbsp;<span class="op" id="3773220">!=</span>&nbsp;<span class="ident" id="3773223"><a href="/math/big/nat.go.html#3758342">io</a></span><span class="op" id="3773225">.</span><span class="ident" id="3773226">EOF</span>&nbsp;<span class="op" id="3773230">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3773236">return</span>&nbsp;<span class="ident" id="3773243"><a href="/math/big/nat.go.html#3771923">z</a></span><span class="op" id="3773244">,</span>&nbsp;<span class="builtintype" id="3773246">int</span><span class="op" id="3773249">(</span><span class="ident" id="3773250"><a href="/math/big/nat.go.html#3772232">b</a></span><span class="op" id="3773251">)</span><span class="op" id="3773252">,</span>&nbsp;<span class="ident" id="3773254"><a href="/math/big/nat.go.html#3772139">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3773261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3773266">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3773274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3773277">}</span><br>
<span class="lineno">705</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3773281">switch</span>&nbsp;<span class="op" id="3773288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3773291">case</span>&nbsp;<span class="ident" id="3773296"><a href="/math/big/nat.go.html#3772868">bb</a></span>&nbsp;<span class="op" id="3773299">&gt;</span>&nbsp;<span class="num" id="3773301">1</span><span class="op" id="3773302">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3773306">//&nbsp;there&nbsp;was&nbsp;at&nbsp;least&nbsp;one&nbsp;mantissa&nbsp;digit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3773349"><a href="/math/big/nat.go.html#3771923">z</a></span>&nbsp;<span class="op" id="3773351">=</span>&nbsp;<span class="ident" id="3773353"><a href="/math/big/nat.go.html#3771923">z</a></span><span class="op" id="3773354">.</span><span class="ident" id="3773355">mulAddWW</span><span class="op" id="3773363">(</span><span class="ident" id="3773364"><a href="/math/big/nat.go.html#3771923">z</a></span><span class="op" id="3773365">,</span>&nbsp;<span class="ident" id="3773367"><a href="/math/big/nat.go.html#3772868">bb</a></span><span class="op" id="3773369">,</span>&nbsp;<span class="ident" id="3773371"><a href="/math/big/nat.go.html#3772883">dd</a></span><span class="op" id="3773373">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3773376">case</span>&nbsp;<span class="ident" id="3773381"><a href="/math/big/nat.go.html#3771953">base</a></span>&nbsp;<span class="op" id="3773386">==</span>&nbsp;<span class="num" id="3773389">0</span>&nbsp;<span class="op" id="3773391">&amp;&amp;</span>&nbsp;<span class="ident" id="3773394"><a href="/math/big/nat.go.html#3772232">b</a></span>&nbsp;<span class="op" id="3773396">==</span>&nbsp;<span class="num" id="3773399">8</span><span class="op" id="3773400">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3773404">//&nbsp;there&nbsp;was&nbsp;only&nbsp;the&nbsp;octal&nbsp;prefix&nbsp;0&nbsp;(possibly&nbsp;followed&nbsp;by&nbsp;digits&nbsp;&gt;&nbsp;7);</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3773478">//&nbsp;return&nbsp;base&nbsp;10,&nbsp;not&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3773505">return</span>&nbsp;<span class="ident" id="3773512"><a href="/math/big/nat.go.html#3771923">z</a></span><span class="op" id="3773513">,</span>&nbsp;<span class="num" id="3773515">10</span><span class="op" id="3773517">,</span>&nbsp;<span class="ident" id="3773519">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3773524">case</span>&nbsp;<span class="ident" id="3773529"><a href="/math/big/nat.go.html#3771953">base</a></span>&nbsp;<span class="op" id="3773534">!=</span>&nbsp;<span class="num" id="3773537">0</span>&nbsp;<span class="op" id="3773539">||</span>&nbsp;<span class="ident" id="3773542"><a href="/math/big/nat.go.html#3772232">b</a></span>&nbsp;<span class="op" id="3773544">!=</span>&nbsp;<span class="num" id="3773547">8</span><span class="op" id="3773548">:</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3773552">//&nbsp;there&nbsp;was&nbsp;neither&nbsp;a&nbsp;mantissa&nbsp;digit&nbsp;nor&nbsp;the&nbsp;octal&nbsp;prefix&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3773615">return</span>&nbsp;<span class="ident" id="3773622"><a href="/math/big/nat.go.html#3771923">z</a></span><span class="op" id="3773623">,</span>&nbsp;<span class="builtintype" id="3773625">int</span><span class="op" id="3773628">(</span><span class="ident" id="3773629"><a href="/math/big/nat.go.html#3772232">b</a></span><span class="op" id="3773630">)</span><span class="op" id="3773631">,</span>&nbsp;<span class="ident" id="3773633"><a href="/math/big/nat.go.html#3758332">errors</a></span><span class="op" id="3773639">.</span><span class="ident" id="3773640">New</span><span class="op" id="3773643">(</span><span class="string" id="3773644">&#34;syntax&nbsp;error&nbsp;scanning&nbsp;number&#34;</span><span class="op" id="3773674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3773677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3773681">return</span>&nbsp;<span class="ident" id="3773688"><a href="/math/big/nat.go.html#3771923">z</a></span><span class="op" id="3773689">.</span><span class="ident" id="3773690">norm</span><span class="op" id="3773694">(</span><span class="op" id="3773695">)</span><span class="op" id="3773696">,</span>&nbsp;<span class="builtintype" id="3773698">int</span><span class="op" id="3773701">(</span><span class="ident" id="3773702"><a href="/math/big/nat.go.html#3772232">b</a></span><span class="op" id="3773703">)</span><span class="op" id="3773704">,</span>&nbsp;<span class="ident" id="3773706">nil</span><br>
<span class="lineno">720</span><span class="op" id="3773710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3773713">//&nbsp;Character&nbsp;sets&nbsp;for&nbsp;string&nbsp;conversion.</span><br>
<span class="lineno"></span><span class="keyword" id="3773754">const</span>&nbsp;<span class="op" id="3773760">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3773763">lowercaseDigits</span>&nbsp;<span class="op" id="3773779">=</span>&nbsp;<span class="string" id="3773781">&#34;0123456789abcdefghijklmnopqrstuvwxyz&#34;</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3773821">uppercaseDigits</span>&nbsp;<span class="op" id="3773837">=</span>&nbsp;<span class="string" id="3773839">&#34;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;</span><br>
<span class="lineno"></span><span class="op" id="3773878">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3773881">//&nbsp;decimalString&nbsp;returns&nbsp;a&nbsp;decimal&nbsp;representation&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="3773937">//&nbsp;It&nbsp;calls&nbsp;x.string&nbsp;with&nbsp;the&nbsp;charset&nbsp;&#34;0123456789&#34;.</span><br>
<span class="lineno">730</span><span class="keyword" id="3773989">func</span>&nbsp;<span class="op" id="3773994">(</span><span class="ident" id="3773995">x</span>&nbsp;<span class="ident" id="3773997"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3774000">)</span>&nbsp;<span class="ident" id="3774002">decimalString</span><span class="op" id="3774015">(</span><span class="op" id="3774016">)</span>&nbsp;<span class="builtintype" id="3774018">string</span>&nbsp;<span class="op" id="3774025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3774028">return</span>&nbsp;<span class="ident" id="3774035"><a href="/math/big/nat.go.html#3773995">x</a></span><span class="op" id="3774036">.</span><span class="builtintype" id="3774037">string</span><span class="op" id="3774043">(</span><span class="ident" id="3774044"><a href="/math/big/nat.go.html#3773763">lowercaseDigits</a></span><span class="op" id="3774059">[</span><span class="num" id="3774060">0</span><span class="op" id="3774061">:</span><span class="num" id="3774062">10</span><span class="op" id="3774064">]</span><span class="op" id="3774065">)</span><br>
<span class="lineno"></span><span class="op" id="3774067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3774070">//&nbsp;string&nbsp;converts&nbsp;x&nbsp;to&nbsp;a&nbsp;string&nbsp;using&nbsp;digits&nbsp;from&nbsp;a&nbsp;charset;&nbsp;a&nbsp;digit&nbsp;with</span><br>
<span class="lineno">735</span><span class="comment" id="3774145">//&nbsp;value&nbsp;d&nbsp;is&nbsp;represented&nbsp;by&nbsp;charset[d].&nbsp;The&nbsp;conversion&nbsp;base&nbsp;is&nbsp;determined</span><br>
<span class="lineno"></span><span class="comment" id="3774220">//&nbsp;by&nbsp;len(charset),&nbsp;which&nbsp;must&nbsp;be&nbsp;&gt;=&nbsp;2&nbsp;and&nbsp;&lt;=&nbsp;256.</span><br>
<span class="lineno"></span><span class="keyword" id="3774271">func</span>&nbsp;<span class="op" id="3774276">(</span><span class="ident" id="3774277">x</span>&nbsp;<span class="ident" id="3774279"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3774282">)</span>&nbsp;<span class="builtintype" id="3774284">string</span><span class="op" id="3774290">(</span><span class="ident" id="3774291">charset</span>&nbsp;<span class="builtintype" id="3774299">string</span><span class="op" id="3774305">)</span>&nbsp;<span class="builtintype" id="3774307">string</span>&nbsp;<span class="op" id="3774314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3774317">b</span>&nbsp;<span class="op" id="3774319">:=</span>&nbsp;<span class="ident" id="3774322"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3774326">(</span><span class="builtinfunc" id="3774327">len</span><span class="op" id="3774330">(</span><span class="ident" id="3774331"><a href="/math/big/nat.go.html#3774291">charset</a></span><span class="op" id="3774338">)</span><span class="op" id="3774339">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3774343">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3774361">switch</span>&nbsp;<span class="op" id="3774368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3774371">case</span>&nbsp;<span class="ident" id="3774376"><a href="/math/big/nat.go.html#3774317">b</a></span>&nbsp;<span class="op" id="3774378">&lt;</span>&nbsp;<span class="num" id="3774380">2</span>&nbsp;<span class="op" id="3774382">||</span>&nbsp;<span class="ident" id="3774385"><a href="/math/big/nat.go.html#3770937">MaxBase</a></span>&nbsp;<span class="op" id="3774393">&gt;</span>&nbsp;<span class="num" id="3774395">256</span><span class="op" id="3774398">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3774402">panic</span><span class="op" id="3774407">(</span><span class="string" id="3774408">&#34;illegal&nbsp;base&#34;</span><span class="op" id="3774422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3774425">case</span>&nbsp;<span class="builtinfunc" id="3774430">len</span><span class="op" id="3774433">(</span><span class="ident" id="3774434"><a href="/math/big/nat.go.html#3774277">x</a></span><span class="op" id="3774435">)</span>&nbsp;<span class="op" id="3774437">==</span>&nbsp;<span class="num" id="3774440">0</span><span class="op" id="3774441">:</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3774445">return</span>&nbsp;<span class="builtintype" id="3774452">string</span><span class="op" id="3774458">(</span><span class="ident" id="3774459"><a href="/math/big/nat.go.html#3774291">charset</a></span><span class="op" id="3774466">[</span><span class="num" id="3774467">0</span><span class="op" id="3774468">]</span><span class="op" id="3774469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3774472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3774476">//&nbsp;allocate&nbsp;buffer&nbsp;for&nbsp;conversion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3774511">i</span>&nbsp;<span class="op" id="3774513">:=</span>&nbsp;<span class="builtintype" id="3774516">int</span><span class="op" id="3774519">(</span><span class="builtintype" id="3774520">float64</span><span class="op" id="3774527">(</span><span class="ident" id="3774528"><a href="/math/big/nat.go.html#3774277">x</a></span><span class="op" id="3774529">.</span><span class="ident" id="3774530">bitLen</span><span class="op" id="3774536">(</span><span class="op" id="3774537">)</span><span class="op" id="3774538">)</span><span class="op" id="3774539">/</span><span class="ident" id="3774540"><a href="/math/big/nat.go.html#3758348">math</a></span><span class="op" id="3774544">.</span><span class="ident" id="3774545">Log2</span><span class="op" id="3774549">(</span><span class="builtintype" id="3774550">float64</span><span class="op" id="3774557">(</span><span class="ident" id="3774558"><a href="/math/big/nat.go.html#3774317">b</a></span><span class="op" id="3774559">)</span><span class="op" id="3774560">)</span><span class="op" id="3774561">)</span>&nbsp;<span class="op" id="3774563">+</span>&nbsp;<span class="num" id="3774565">1</span>&nbsp;<span class="comment" id="3774567">//&nbsp;off&nbsp;by&nbsp;one&nbsp;at&nbsp;most</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3774590">s</span>&nbsp;<span class="op" id="3774592">:=</span>&nbsp;<span class="builtinfunc" id="3774595">make</span><span class="op" id="3774599">(</span><span class="op" id="3774600">[</span><span class="op" id="3774601">]</span><span class="builtintype" id="3774602">byte</span><span class="op" id="3774606">,</span>&nbsp;<span class="ident" id="3774608"><a href="/math/big/nat.go.html#3774511">i</a></span><span class="op" id="3774609">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3774613">//&nbsp;convert&nbsp;power&nbsp;of&nbsp;two&nbsp;and&nbsp;non&nbsp;power&nbsp;of&nbsp;two&nbsp;bases&nbsp;separately</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3774676">if</span>&nbsp;<span class="ident" id="3774679"><a href="/math/big/nat.go.html#3774317">b</a></span>&nbsp;<span class="op" id="3774681">==</span>&nbsp;<span class="ident" id="3774684"><a href="/math/big/nat.go.html#3774317">b</a></span><span class="op" id="3774685">&amp;</span><span class="op" id="3774686">-</span><span class="ident" id="3774687"><a href="/math/big/nat.go.html#3774317">b</a></span>&nbsp;<span class="op" id="3774689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3774693">//&nbsp;shift&nbsp;is&nbsp;base-b&nbsp;digit&nbsp;size&nbsp;in&nbsp;bits</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3774733">shift</span>&nbsp;<span class="op" id="3774739">:=</span>&nbsp;<span class="ident" id="3774742"><a href="/math/big/nat.go.html#3782771">trailingZeroBits</a></span><span class="op" id="3774758">(</span><span class="ident" id="3774759"><a href="/math/big/nat.go.html#3774317">b</a></span><span class="op" id="3774760">)</span>&nbsp;<span class="comment" id="3774762">//&nbsp;shift&nbsp;&gt;&nbsp;0&nbsp;because&nbsp;b&nbsp;&gt;=&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3774792">mask</span>&nbsp;<span class="op" id="3774797">:=</span>&nbsp;<span class="ident" id="3774800"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3774804">(</span><span class="num" id="3774805">1</span><span class="op" id="3774806">)</span><span class="op" id="3774807">&lt;&lt;</span><span class="ident" id="3774809"><a href="/math/big/nat.go.html#3774733">shift</a></span>&nbsp;<span class="op" id="3774815">-</span>&nbsp;<span class="num" id="3774817">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3774821">w</span>&nbsp;<span class="op" id="3774823">:=</span>&nbsp;<span class="ident" id="3774826"><a href="/math/big/nat.go.html#3774277">x</a></span><span class="op" id="3774827">[</span><span class="num" id="3774828">0</span><span class="op" id="3774829">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3774833">nbits</span>&nbsp;<span class="op" id="3774839">:=</span>&nbsp;<span class="builtintype" id="3774842">uint</span><span class="op" id="3774846">(</span><span class="ident" id="3774847"><a href="/math/big/arith.go.html#3727893">_W</a></span><span class="op" id="3774849">)</span>&nbsp;<span class="comment" id="3774851">//&nbsp;number&nbsp;of&nbsp;unprocessed&nbsp;bits&nbsp;in&nbsp;w</span><br>
<span class="lineno"></span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3774889">//&nbsp;convert&nbsp;less-significant&nbsp;words</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3774925">for</span>&nbsp;<span class="ident" id="3774929">k</span>&nbsp;<span class="op" id="3774931">:=</span>&nbsp;<span class="num" id="3774934">1</span><span class="op" id="3774935">;</span>&nbsp;<span class="ident" id="3774937"><a href="/math/big/nat.go.html#3774929">k</a></span>&nbsp;<span class="op" id="3774939">&lt;</span>&nbsp;<span class="builtinfunc" id="3774941">len</span><span class="op" id="3774944">(</span><span class="ident" id="3774945"><a href="/math/big/nat.go.html#3774277">x</a></span><span class="op" id="3774946">)</span><span class="op" id="3774947">;</span>&nbsp;<span class="ident" id="3774949"><a href="/math/big/nat.go.html#3774929">k</a></span><span class="op" id="3774950">++</span>&nbsp;<span class="op" id="3774953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3774958">//&nbsp;convert&nbsp;full&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3774984">for</span>&nbsp;<span class="ident" id="3774988"><a href="/math/big/nat.go.html#3774833">nbits</a></span>&nbsp;<span class="op" id="3774994">&gt;=</span>&nbsp;<span class="ident" id="3774997"><a href="/math/big/nat.go.html#3774733">shift</a></span>&nbsp;<span class="op" id="3775003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3775009"><a href="/math/big/nat.go.html#3774511">i</a></span><span class="op" id="3775010">--</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3775017"><a href="/math/big/nat.go.html#3774590">s</a></span><span class="op" id="3775018">[</span><span class="ident" id="3775019"><a href="/math/big/nat.go.html#3774511">i</a></span><span class="op" id="3775020">]</span>&nbsp;<span class="op" id="3775022">=</span>&nbsp;<span class="ident" id="3775024"><a href="/math/big/nat.go.html#3774291">charset</a></span><span class="op" id="3775031">[</span><span class="ident" id="3775032"><a href="/math/big/nat.go.html#3774821">w</a></span><span class="op" id="3775033">&amp;</span><span class="ident" id="3775034"><a href="/math/big/nat.go.html#3774792">mask</a></span><span class="op" id="3775038">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3775044"><a href="/math/big/nat.go.html#3774821">w</a></span>&nbsp;<span class="op" id="3775046">&gt;&gt;=</span>&nbsp;<span class="ident" id="3775050"><a href="/math/big/nat.go.html#3774733">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3775060"><a href="/math/big/nat.go.html#3774833">nbits</a></span>&nbsp;<span class="op" id="3775066">-=</span>&nbsp;<span class="ident" id="3775069"><a href="/math/big/nat.go.html#3774733">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3775078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3775084">//&nbsp;convert&nbsp;any&nbsp;partial&nbsp;leading&nbsp;digit&nbsp;and&nbsp;advance&nbsp;to&nbsp;next&nbsp;word</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3775149">if</span>&nbsp;<span class="ident" id="3775152"><a href="/math/big/nat.go.html#3774833">nbits</a></span>&nbsp;<span class="op" id="3775158">==</span>&nbsp;<span class="num" id="3775161">0</span>&nbsp;<span class="op" id="3775163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3775169">//&nbsp;no&nbsp;partial&nbsp;digit&nbsp;remaining,&nbsp;just&nbsp;advance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3775217"><a href="/math/big/nat.go.html#3774821">w</a></span>&nbsp;<span class="op" id="3775219">=</span>&nbsp;<span class="ident" id="3775221"><a href="/math/big/nat.go.html#3774277">x</a></span><span class="op" id="3775222">[</span><span class="ident" id="3775223"><a href="/math/big/nat.go.html#3774929">k</a></span><span class="op" id="3775224">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3775230"><a href="/math/big/nat.go.html#3774833">nbits</a></span>&nbsp;<span class="op" id="3775236">=</span>&nbsp;<span class="ident" id="3775238"><a href="/math/big/arith.go.html#3727893">_W</a></span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3775244">}</span>&nbsp;<span class="keyword" id="3775246">else</span>&nbsp;<span class="op" id="3775251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3775257">//&nbsp;partial&nbsp;digit&nbsp;in&nbsp;current&nbsp;(k-1)&nbsp;and&nbsp;next&nbsp;(k)&nbsp;word</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3775313"><a href="/math/big/nat.go.html#3774821">w</a></span>&nbsp;<span class="op" id="3775315">|=</span>&nbsp;<span class="ident" id="3775318"><a href="/math/big/nat.go.html#3774277">x</a></span><span class="op" id="3775319">[</span><span class="ident" id="3775320"><a href="/math/big/nat.go.html#3774929">k</a></span><span class="op" id="3775321">]</span>&nbsp;<span class="op" id="3775323">&lt;&lt;</span>&nbsp;<span class="ident" id="3775326"><a href="/math/big/nat.go.html#3774833">nbits</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3775336"><a href="/math/big/nat.go.html#3774511">i</a></span><span class="op" id="3775337">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3775344"><a href="/math/big/nat.go.html#3774590">s</a></span><span class="op" id="3775345">[</span><span class="ident" id="3775346"><a href="/math/big/nat.go.html#3774511">i</a></span><span class="op" id="3775347">]</span>&nbsp;<span class="op" id="3775349">=</span>&nbsp;<span class="ident" id="3775351"><a href="/math/big/nat.go.html#3774291">charset</a></span><span class="op" id="3775358">[</span><span class="ident" id="3775359"><a href="/math/big/nat.go.html#3774821">w</a></span><span class="op" id="3775360">&amp;</span><span class="ident" id="3775361"><a href="/math/big/nat.go.html#3774792">mask</a></span><span class="op" id="3775365">]</span><br>
<span class="lineno">780</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3775372">//&nbsp;advance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3775387"><a href="/math/big/nat.go.html#3774821">w</a></span>&nbsp;<span class="op" id="3775389">=</span>&nbsp;<span class="ident" id="3775391"><a href="/math/big/nat.go.html#3774277">x</a></span><span class="op" id="3775392">[</span><span class="ident" id="3775393"><a href="/math/big/nat.go.html#3774929">k</a></span><span class="op" id="3775394">]</span>&nbsp;<span class="op" id="3775396">&gt;&gt;</span>&nbsp;<span class="op" id="3775399">(</span><span class="ident" id="3775400"><a href="/math/big/nat.go.html#3774733">shift</a></span>&nbsp;<span class="op" id="3775406">-</span>&nbsp;<span class="ident" id="3775408"><a href="/math/big/nat.go.html#3774833">nbits</a></span><span class="op" id="3775413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3775419"><a href="/math/big/nat.go.html#3774833">nbits</a></span>&nbsp;<span class="op" id="3775425">=</span>&nbsp;<span class="ident" id="3775427"><a href="/math/big/arith.go.html#3727893">_W</a></span>&nbsp;<span class="op" id="3775430">-</span>&nbsp;<span class="op" id="3775432">(</span><span class="ident" id="3775433"><a href="/math/big/nat.go.html#3774733">shift</a></span>&nbsp;<span class="op" id="3775439">-</span>&nbsp;<span class="ident" id="3775441"><a href="/math/big/nat.go.html#3774833">nbits</a></span><span class="op" id="3775446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3775451">}</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3775455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3775460">//&nbsp;convert&nbsp;digits&nbsp;of&nbsp;most-significant&nbsp;word&nbsp;(omit&nbsp;leading&nbsp;zeros)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3775526">for</span>&nbsp;<span class="ident" id="3775530"><a href="/math/big/nat.go.html#3774833">nbits</a></span>&nbsp;<span class="op" id="3775536">&gt;=</span>&nbsp;<span class="num" id="3775539">0</span>&nbsp;<span class="op" id="3775541">&amp;&amp;</span>&nbsp;<span class="ident" id="3775544"><a href="/math/big/nat.go.html#3774821">w</a></span>&nbsp;<span class="op" id="3775546">!=</span>&nbsp;<span class="num" id="3775549">0</span>&nbsp;<span class="op" id="3775551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3775556"><a href="/math/big/nat.go.html#3774511">i</a></span><span class="op" id="3775557">--</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3775563"><a href="/math/big/nat.go.html#3774590">s</a></span><span class="op" id="3775564">[</span><span class="ident" id="3775565"><a href="/math/big/nat.go.html#3774511">i</a></span><span class="op" id="3775566">]</span>&nbsp;<span class="op" id="3775568">=</span>&nbsp;<span class="ident" id="3775570"><a href="/math/big/nat.go.html#3774291">charset</a></span><span class="op" id="3775577">[</span><span class="ident" id="3775578"><a href="/math/big/nat.go.html#3774821">w</a></span><span class="op" id="3775579">&amp;</span><span class="ident" id="3775580"><a href="/math/big/nat.go.html#3774792">mask</a></span><span class="op" id="3775584">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3775589"><a href="/math/big/nat.go.html#3774821">w</a></span>&nbsp;<span class="op" id="3775591">&gt;&gt;=</span>&nbsp;<span class="ident" id="3775595"><a href="/math/big/nat.go.html#3774733">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3775604"><a href="/math/big/nat.go.html#3774833">nbits</a></span>&nbsp;<span class="op" id="3775610">-=</span>&nbsp;<span class="ident" id="3775613"><a href="/math/big/nat.go.html#3774733">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3775621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3775625">}</span>&nbsp;<span class="keyword" id="3775627">else</span>&nbsp;<span class="op" id="3775632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3775636">//&nbsp;determine&nbsp;&#34;big&nbsp;base&#34;;&nbsp;i.e.,&nbsp;the&nbsp;largest&nbsp;possible&nbsp;value&nbsp;bb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3775699">//&nbsp;that&nbsp;is&nbsp;a&nbsp;power&nbsp;of&nbsp;base&nbsp;b&nbsp;and&nbsp;still&nbsp;fits&nbsp;into&nbsp;a&nbsp;Word</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3775757">//&nbsp;(as&nbsp;in&nbsp;10^19&nbsp;for&nbsp;19&nbsp;decimal&nbsp;digits&nbsp;in&nbsp;a&nbsp;64bit&nbsp;Word)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3775814">bb</span>&nbsp;<span class="op" id="3775817">:=</span>&nbsp;<span class="ident" id="3775820"><a href="/math/big/nat.go.html#3774317">b</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3775827">//&nbsp;big&nbsp;base&nbsp;is&nbsp;b**ndigits</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3775855">ndigits</span>&nbsp;<span class="op" id="3775863">:=</span>&nbsp;<span class="num" id="3775866">1</span>&nbsp;<span class="comment" id="3775868">//&nbsp;number&nbsp;of&nbsp;base&nbsp;b&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3775897">for</span>&nbsp;<span class="ident" id="3775901">max</span>&nbsp;<span class="op" id="3775905">:=</span>&nbsp;<span class="ident" id="3775908"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3775912">(</span><span class="ident" id="3775913"><a href="/math/big/arith.go.html#3727956">_M</a></span>&nbsp;<span class="op" id="3775916">/</span>&nbsp;<span class="ident" id="3775918"><a href="/math/big/nat.go.html#3774317">b</a></span><span class="op" id="3775919">)</span><span class="op" id="3775920">;</span>&nbsp;<span class="ident" id="3775922"><a href="/math/big/nat.go.html#3775814">bb</a></span>&nbsp;<span class="op" id="3775925">&lt;=</span>&nbsp;<span class="ident" id="3775928"><a href="/math/big/nat.go.html#3775901">max</a></span><span class="op" id="3775931">;</span>&nbsp;<span class="ident" id="3775933"><a href="/math/big/nat.go.html#3775814">bb</a></span>&nbsp;<span class="op" id="3775936">*=</span>&nbsp;<span class="ident" id="3775939"><a href="/math/big/nat.go.html#3774317">b</a></span>&nbsp;<span class="op" id="3775941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3775946"><a href="/math/big/nat.go.html#3775855">ndigits</a></span><span class="op" id="3775953">++</span>&nbsp;<span class="comment" id="3775956">//&nbsp;maximize&nbsp;ndigits&nbsp;where&nbsp;bb&nbsp;=&nbsp;b**ndigits,&nbsp;bb&nbsp;&lt;=&nbsp;_M</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3776010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3776015">//&nbsp;construct&nbsp;table&nbsp;of&nbsp;successive&nbsp;squares&nbsp;of&nbsp;bb*leafSize&nbsp;to&nbsp;use&nbsp;in&nbsp;subdivisions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3776096">//&nbsp;result&nbsp;(table&nbsp;!=&nbsp;nil)&nbsp;&lt;=&gt;&nbsp;(len(x)&nbsp;&gt;&nbsp;leafSize&nbsp;&gt;&nbsp;0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3776151">table</span>&nbsp;<span class="op" id="3776157">:=</span>&nbsp;<span class="ident" id="3776160"><a href="/math/big/nat.go.html#3780734">divisors</a></span><span class="op" id="3776168">(</span><span class="builtinfunc" id="3776169">len</span><span class="op" id="3776172">(</span><span class="ident" id="3776173"><a href="/math/big/nat.go.html#3774277">x</a></span><span class="op" id="3776174">)</span><span class="op" id="3776175">,</span>&nbsp;<span class="ident" id="3776177"><a href="/math/big/nat.go.html#3774317">b</a></span><span class="op" id="3776178">,</span>&nbsp;<span class="ident" id="3776180"><a href="/math/big/nat.go.html#3775855">ndigits</a></span><span class="op" id="3776187">,</span>&nbsp;<span class="ident" id="3776189"><a href="/math/big/nat.go.html#3775814">bb</a></span><span class="op" id="3776191">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3776196">//&nbsp;preserve&nbsp;x,&nbsp;create&nbsp;local&nbsp;copy&nbsp;for&nbsp;use&nbsp;by&nbsp;convertWords</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3776255">q</span>&nbsp;<span class="op" id="3776257">:=</span>&nbsp;<span class="ident" id="3776260"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3776263">(</span><span class="ident" id="3776264">nil</span><span class="op" id="3776267">)</span><span class="op" id="3776268">.</span><span class="ident" id="3776269">set</span><span class="op" id="3776272">(</span><span class="ident" id="3776273"><a href="/math/big/nat.go.html#3774277">x</a></span><span class="op" id="3776274">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3776279">//&nbsp;convert&nbsp;q&nbsp;to&nbsp;string&nbsp;s&nbsp;in&nbsp;base&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3776316"><a href="/math/big/nat.go.html#3776255">q</a></span><span class="op" id="3776317">.</span><span class="ident" id="3776318">convertWords</span><span class="op" id="3776330">(</span><span class="ident" id="3776331"><a href="/math/big/nat.go.html#3774590">s</a></span><span class="op" id="3776332">,</span>&nbsp;<span class="ident" id="3776334"><a href="/math/big/nat.go.html#3774291">charset</a></span><span class="op" id="3776341">,</span>&nbsp;<span class="ident" id="3776343"><a href="/math/big/nat.go.html#3774317">b</a></span><span class="op" id="3776344">,</span>&nbsp;<span class="ident" id="3776346"><a href="/math/big/nat.go.html#3775855">ndigits</a></span><span class="op" id="3776353">,</span>&nbsp;<span class="ident" id="3776355"><a href="/math/big/nat.go.html#3775814">bb</a></span><span class="op" id="3776357">,</span>&nbsp;<span class="ident" id="3776359"><a href="/math/big/nat.go.html#3776151">table</a></span><span class="op" id="3776364">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3776369">//&nbsp;strip&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3776394">//&nbsp;(x&nbsp;!=&nbsp;0;&nbsp;thus&nbsp;s&nbsp;must&nbsp;contain&nbsp;at&nbsp;least&nbsp;one&nbsp;non-zero&nbsp;digit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3776456">//&nbsp;and&nbsp;the&nbsp;loop&nbsp;will&nbsp;terminate)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3776490"><a href="/math/big/nat.go.html#3774511">i</a></span>&nbsp;<span class="op" id="3776492">=</span>&nbsp;<span class="num" id="3776494">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3776498">for</span>&nbsp;<span class="ident" id="3776502">zero</span>&nbsp;<span class="op" id="3776507">:=</span>&nbsp;<span class="ident" id="3776510"><a href="/math/big/nat.go.html#3774291">charset</a></span><span class="op" id="3776517">[</span><span class="num" id="3776518">0</span><span class="op" id="3776519">]</span><span class="op" id="3776520">;</span>&nbsp;<span class="ident" id="3776522"><a href="/math/big/nat.go.html#3774590">s</a></span><span class="op" id="3776523">[</span><span class="ident" id="3776524"><a href="/math/big/nat.go.html#3774511">i</a></span><span class="op" id="3776525">]</span>&nbsp;<span class="op" id="3776527">==</span>&nbsp;<span class="ident" id="3776530"><a href="/math/big/nat.go.html#3776502">zero</a></span><span class="op" id="3776534">;</span>&nbsp;<span class="op" id="3776536">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3776541"><a href="/math/big/nat.go.html#3774511">i</a></span><span class="op" id="3776542">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3776547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3776550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3776554">return</span>&nbsp;<span class="builtintype" id="3776561">string</span><span class="op" id="3776567">(</span><span class="ident" id="3776568"><a href="/math/big/nat.go.html#3774590">s</a></span><span class="op" id="3776569">[</span><span class="ident" id="3776570"><a href="/math/big/nat.go.html#3774511">i</a></span><span class="op" id="3776571">:</span><span class="op" id="3776572">]</span><span class="op" id="3776573">)</span><br>
<span class="lineno">825</span><span class="op" id="3776575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3776578">//&nbsp;Convert&nbsp;words&nbsp;of&nbsp;q&nbsp;to&nbsp;base&nbsp;b&nbsp;digits&nbsp;in&nbsp;s.&nbsp;If&nbsp;q&nbsp;is&nbsp;large,&nbsp;it&nbsp;is&nbsp;recursively&nbsp;&#34;split&nbsp;in&nbsp;half&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3776672">//&nbsp;by&nbsp;nat/nat&nbsp;division&nbsp;using&nbsp;tabulated&nbsp;divisors.&nbsp;Otherwise,&nbsp;it&nbsp;is&nbsp;converted&nbsp;iteratively&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="3776766">//&nbsp;repeated&nbsp;nat/Word&nbsp;division.</span><br>
<span class="lineno">830</span><span class="comment" id="3776797">//</span><br>
<span class="lineno"></span><span class="comment" id="3776800">//&nbsp;The&nbsp;iterative&nbsp;method&nbsp;processes&nbsp;n&nbsp;Words&nbsp;by&nbsp;n&nbsp;divW()&nbsp;calls,&nbsp;each&nbsp;of&nbsp;which&nbsp;visits&nbsp;every&nbsp;Word&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3776900">//&nbsp;incrementally&nbsp;shortened&nbsp;q&nbsp;for&nbsp;a&nbsp;total&nbsp;of&nbsp;n&nbsp;+&nbsp;(n-1)&nbsp;+&nbsp;(n-2)&nbsp;...&nbsp;+&nbsp;2&nbsp;+&nbsp;1,&nbsp;or&nbsp;n(n+1)/2&nbsp;divW()&#39;s.</span><br>
<span class="lineno"></span><span class="comment" id="3776997">//&nbsp;Recursive&nbsp;conversion&nbsp;divides&nbsp;q&nbsp;by&nbsp;its&nbsp;approximate&nbsp;square&nbsp;root,&nbsp;yielding&nbsp;two&nbsp;parts,&nbsp;each&nbsp;half</span><br>
<span class="lineno"></span><span class="comment" id="3777093">//&nbsp;the&nbsp;size&nbsp;of&nbsp;q.&nbsp;Using&nbsp;the&nbsp;iterative&nbsp;method&nbsp;on&nbsp;both&nbsp;halves&nbsp;means&nbsp;2&nbsp;*&nbsp;(n/2)(n/2&nbsp;+&nbsp;1)/2&nbsp;divW()&#39;s</span><br>
<span class="lineno">835</span><span class="comment" id="3777189">//&nbsp;plus&nbsp;the&nbsp;expensive&nbsp;long&nbsp;div().&nbsp;Asymptotically,&nbsp;the&nbsp;ratio&nbsp;is&nbsp;favorable&nbsp;at&nbsp;1/2&nbsp;the&nbsp;divW()&#39;s,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3777287">//&nbsp;is&nbsp;made&nbsp;better&nbsp;by&nbsp;splitting&nbsp;the&nbsp;subblocks&nbsp;recursively.&nbsp;Best&nbsp;is&nbsp;to&nbsp;split&nbsp;blocks&nbsp;until&nbsp;one&nbsp;more</span><br>
<span class="lineno"></span><span class="comment" id="3777384">//&nbsp;split&nbsp;would&nbsp;take&nbsp;longer&nbsp;(because&nbsp;of&nbsp;the&nbsp;nat/nat&nbsp;div())&nbsp;than&nbsp;the&nbsp;twice&nbsp;as&nbsp;many&nbsp;divW()&#39;s&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3777481">//&nbsp;iterative&nbsp;approach.&nbsp;This&nbsp;threshold&nbsp;is&nbsp;represented&nbsp;by&nbsp;leafSize.&nbsp;Benchmarking&nbsp;of&nbsp;leafSize&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3777579">//&nbsp;range&nbsp;2..64&nbsp;shows&nbsp;that&nbsp;values&nbsp;of&nbsp;8&nbsp;and&nbsp;16&nbsp;work&nbsp;well,&nbsp;with&nbsp;a&nbsp;4x&nbsp;speedup&nbsp;at&nbsp;medium&nbsp;lengths&nbsp;and</span><br>
<span class="lineno">840</span><span class="comment" id="3777675">//&nbsp;~30x&nbsp;for&nbsp;20000&nbsp;digits.&nbsp;Use&nbsp;nat_test.go&#39;s&nbsp;BenchmarkLeafSize&nbsp;tests&nbsp;to&nbsp;optimize&nbsp;leafSize&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="3777768">//&nbsp;specific&nbsp;hardware.</span><br>
<span class="lineno"></span><span class="comment" id="3777790">//</span><br>
<span class="lineno"></span><span class="keyword" id="3777793">func</span>&nbsp;<span class="op" id="3777798">(</span><span class="ident" id="3777799">q</span>&nbsp;<span class="ident" id="3777801"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3777804">)</span>&nbsp;<span class="ident" id="3777806">convertWords</span><span class="op" id="3777818">(</span><span class="ident" id="3777819">s</span>&nbsp;<span class="op" id="3777821">[</span><span class="op" id="3777822">]</span><span class="builtintype" id="3777823">byte</span><span class="op" id="3777827">,</span>&nbsp;<span class="ident" id="3777829">charset</span>&nbsp;<span class="builtintype" id="3777837">string</span><span class="op" id="3777843">,</span>&nbsp;<span class="ident" id="3777845">b</span>&nbsp;<span class="ident" id="3777847"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3777851">,</span>&nbsp;<span class="ident" id="3777853">ndigits</span>&nbsp;<span class="builtintype" id="3777861">int</span><span class="op" id="3777864">,</span>&nbsp;<span class="ident" id="3777866">bb</span>&nbsp;<span class="ident" id="3777869"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3777873">,</span>&nbsp;<span class="ident" id="3777875">table</span>&nbsp;<span class="op" id="3777881">[</span><span class="op" id="3777882">]</span><span class="ident" id="3777883"><a href="/math/big/nat.go.html#3780252">divisor</a></span><span class="op" id="3777890">)</span>&nbsp;<span class="op" id="3777892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3777895">//&nbsp;split&nbsp;larger&nbsp;blocks&nbsp;recursively</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3777931">if</span>&nbsp;<span class="ident" id="3777934"><a href="/math/big/nat.go.html#3777875">table</a></span>&nbsp;<span class="op" id="3777940">!=</span>&nbsp;<span class="ident" id="3777943">nil</span>&nbsp;<span class="op" id="3777947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3777951">//&nbsp;len(q)&nbsp;&gt;&nbsp;leafSize&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3777978">var</span>&nbsp;<span class="ident" id="3777982">r</span>&nbsp;<span class="ident" id="3777984"><a href="/math/big/nat.go.html#3758892">nat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3777990">index</span>&nbsp;<span class="op" id="3777996">:=</span>&nbsp;<span class="builtinfunc" id="3777999">len</span><span class="op" id="3778002">(</span><span class="ident" id="3778003"><a href="/math/big/nat.go.html#3777875">table</a></span><span class="op" id="3778008">)</span>&nbsp;<span class="op" id="3778010">-</span>&nbsp;<span class="num" id="3778012">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3778016">for</span>&nbsp;<span class="builtinfunc" id="3778020">len</span><span class="op" id="3778023">(</span><span class="ident" id="3778024"><a href="/math/big/nat.go.html#3777799">q</a></span><span class="op" id="3778025">)</span>&nbsp;<span class="op" id="3778027">&gt;</span>&nbsp;<span class="ident" id="3778029"><a href="/math/big/nat.go.html#3780164">leafSize</a></span>&nbsp;<span class="op" id="3778038">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3778043">//&nbsp;find&nbsp;divisor&nbsp;close&nbsp;to&nbsp;sqrt(q)&nbsp;if&nbsp;possible,&nbsp;but&nbsp;in&nbsp;any&nbsp;case&nbsp;&lt;&nbsp;q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3778112">maxLength</span>&nbsp;<span class="op" id="3778122">:=</span>&nbsp;<span class="ident" id="3778125"><a href="/math/big/nat.go.html#3777799">q</a></span><span class="op" id="3778126">.</span><span class="ident" id="3778127">bitLen</span><span class="op" id="3778133">(</span><span class="op" id="3778134">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3778140">//&nbsp;~=&nbsp;log2&nbsp;q,&nbsp;or&nbsp;at&nbsp;of&nbsp;least&nbsp;largest&nbsp;possible&nbsp;q&nbsp;of&nbsp;this&nbsp;bit&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3778210">minLength</span>&nbsp;<span class="op" id="3778220">:=</span>&nbsp;<span class="ident" id="3778223"><a href="/math/big/nat.go.html#3778112">maxLength</a></span>&nbsp;<span class="op" id="3778233">&gt;&gt;</span>&nbsp;<span class="num" id="3778236">1</span>&nbsp;<span class="comment" id="3778238">//&nbsp;~=&nbsp;log2&nbsp;sqrt(q)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3778260">for</span>&nbsp;<span class="ident" id="3778264"><a href="/math/big/nat.go.html#3777990">index</a></span>&nbsp;<span class="op" id="3778270">&gt;</span>&nbsp;<span class="num" id="3778272">0</span>&nbsp;<span class="op" id="3778274">&amp;&amp;</span>&nbsp;<span class="ident" id="3778277"><a href="/math/big/nat.go.html#3777875">table</a></span><span class="op" id="3778282">[</span><span class="ident" id="3778283"><a href="/math/big/nat.go.html#3777990">index</a></span><span class="op" id="3778288">-</span><span class="num" id="3778289">1</span><span class="op" id="3778290">]</span><span class="op" id="3778291">.</span><span class="ident" id="3778292">nbits</span>&nbsp;<span class="op" id="3778298">&gt;</span>&nbsp;<span class="ident" id="3778300"><a href="/math/big/nat.go.html#3778210">minLength</a></span>&nbsp;<span class="op" id="3778310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3778316"><a href="/math/big/nat.go.html#3777990">index</a></span><span class="op" id="3778321">--</span>&nbsp;<span class="comment" id="3778324">//&nbsp;desired</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3778338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3778343">if</span>&nbsp;<span class="ident" id="3778346"><a href="/math/big/nat.go.html#3777875">table</a></span><span class="op" id="3778351">[</span><span class="ident" id="3778352"><a href="/math/big/nat.go.html#3777990">index</a></span><span class="op" id="3778357">]</span><span class="op" id="3778358">.</span><span class="ident" id="3778359">nbits</span>&nbsp;<span class="op" id="3778365">&gt;=</span>&nbsp;<span class="ident" id="3778368"><a href="/math/big/nat.go.html#3778112">maxLength</a></span>&nbsp;<span class="op" id="3778378">&amp;&amp;</span>&nbsp;<span class="ident" id="3778381"><a href="/math/big/nat.go.html#3777875">table</a></span><span class="op" id="3778386">[</span><span class="ident" id="3778387"><a href="/math/big/nat.go.html#3777990">index</a></span><span class="op" id="3778392">]</span><span class="op" id="3778393">.</span><span class="ident" id="3778394">bbb</span><span class="op" id="3778397">.</span><span class="ident" id="3778398">cmp</span><span class="op" id="3778401">(</span><span class="ident" id="3778402"><a href="/math/big/nat.go.html#3777799">q</a></span><span class="op" id="3778403">)</span>&nbsp;<span class="op" id="3778405">&gt;=</span>&nbsp;<span class="num" id="3778408">0</span>&nbsp;<span class="op" id="3778410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3778416"><a href="/math/big/nat.go.html#3777990">index</a></span><span class="op" id="3778421">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3778428">if</span>&nbsp;<span class="ident" id="3778431"><a href="/math/big/nat.go.html#3777990">index</a></span>&nbsp;<span class="op" id="3778437">&lt;</span>&nbsp;<span class="num" id="3778439">0</span>&nbsp;<span class="op" id="3778441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3778448">panic</span><span class="op" id="3778453">(</span><span class="string" id="3778454">&#34;internal&nbsp;inconsistency&#34;</span><span class="op" id="3778478">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3778484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3778489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3778495">//&nbsp;split&nbsp;q&nbsp;into&nbsp;the&nbsp;two&nbsp;digit&nbsp;number&nbsp;(q&#39;*bbb&nbsp;+&nbsp;r)&nbsp;to&nbsp;form&nbsp;independent&nbsp;subblocks</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3778578"><a href="/math/big/nat.go.html#3777799">q</a></span><span class="op" id="3778579">,</span>&nbsp;<span class="ident" id="3778581"><a href="/math/big/nat.go.html#3777982">r</a></span>&nbsp;<span class="op" id="3778583">=</span>&nbsp;<span class="ident" id="3778585"><a href="/math/big/nat.go.html#3777799">q</a></span><span class="op" id="3778586">.</span><span class="ident" id="3778587">div</span><span class="op" id="3778590">(</span><span class="ident" id="3778591"><a href="/math/big/nat.go.html#3777982">r</a></span><span class="op" id="3778592">,</span>&nbsp;<span class="ident" id="3778594"><a href="/math/big/nat.go.html#3777799">q</a></span><span class="op" id="3778595">,</span>&nbsp;<span class="ident" id="3778597"><a href="/math/big/nat.go.html#3777875">table</a></span><span class="op" id="3778602">[</span><span class="ident" id="3778603"><a href="/math/big/nat.go.html#3777990">index</a></span><span class="op" id="3778608">]</span><span class="op" id="3778609">.</span><span class="ident" id="3778610">bbb</span><span class="op" id="3778613">)</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3778619">//&nbsp;convert&nbsp;subblocks&nbsp;and&nbsp;collect&nbsp;results&nbsp;in&nbsp;s[:h]&nbsp;and&nbsp;s[h:]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3778682">h</span>&nbsp;<span class="op" id="3778684">:=</span>&nbsp;<span class="builtinfunc" id="3778687">len</span><span class="op" id="3778690">(</span><span class="ident" id="3778691"><a href="/math/big/nat.go.html#3777819">s</a></span><span class="op" id="3778692">)</span>&nbsp;<span class="op" id="3778694">-</span>&nbsp;<span class="ident" id="3778696"><a href="/math/big/nat.go.html#3777875">table</a></span><span class="op" id="3778701">[</span><span class="ident" id="3778702"><a href="/math/big/nat.go.html#3777990">index</a></span><span class="op" id="3778707">]</span><span class="op" id="3778708">.</span><span class="ident" id="3778709">ndigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3778720"><a href="/math/big/nat.go.html#3777982">r</a></span><span class="op" id="3778721">.</span><span class="ident" id="3778722">convertWords</span><span class="op" id="3778734">(</span><span class="ident" id="3778735"><a href="/math/big/nat.go.html#3777819">s</a></span><span class="op" id="3778736">[</span><span class="ident" id="3778737"><a href="/math/big/nat.go.html#3778682">h</a></span><span class="op" id="3778738">:</span><span class="op" id="3778739">]</span><span class="op" id="3778740">,</span>&nbsp;<span class="ident" id="3778742"><a href="/math/big/nat.go.html#3777829">charset</a></span><span class="op" id="3778749">,</span>&nbsp;<span class="ident" id="3778751"><a href="/math/big/nat.go.html#3777845">b</a></span><span class="op" id="3778752">,</span>&nbsp;<span class="ident" id="3778754"><a href="/math/big/nat.go.html#3777853">ndigits</a></span><span class="op" id="3778761">,</span>&nbsp;<span class="ident" id="3778763"><a href="/math/big/nat.go.html#3777866">bb</a></span><span class="op" id="3778765">,</span>&nbsp;<span class="ident" id="3778767"><a href="/math/big/nat.go.html#3777875">table</a></span><span class="op" id="3778772">[</span><span class="num" id="3778773">0</span><span class="op" id="3778774">:</span><span class="ident" id="3778775"><a href="/math/big/nat.go.html#3777990">index</a></span><span class="op" id="3778780">]</span><span class="op" id="3778781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3778786"><a href="/math/big/nat.go.html#3777819">s</a></span>&nbsp;<span class="op" id="3778788">=</span>&nbsp;<span class="ident" id="3778790"><a href="/math/big/nat.go.html#3777819">s</a></span><span class="op" id="3778791">[</span><span class="op" id="3778792">:</span><span class="ident" id="3778793"><a href="/math/big/nat.go.html#3778682">h</a></span><span class="op" id="3778794">]</span>&nbsp;<span class="comment" id="3778796">//&nbsp;==&nbsp;q.convertWords(s,&nbsp;charset,&nbsp;b,&nbsp;ndigits,&nbsp;bb,&nbsp;table[0:index+1])</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3778865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3778868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3778872">//&nbsp;having&nbsp;split&nbsp;any&nbsp;large&nbsp;blocks&nbsp;now&nbsp;process&nbsp;the&nbsp;remaining&nbsp;(small)&nbsp;block&nbsp;iteratively</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3778958">i</span>&nbsp;<span class="op" id="3778960">:=</span>&nbsp;<span class="builtinfunc" id="3778963">len</span><span class="op" id="3778966">(</span><span class="ident" id="3778967"><a href="/math/big/nat.go.html#3777819">s</a></span><span class="op" id="3778968">)</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3778971">var</span>&nbsp;<span class="ident" id="3778975">r</span>&nbsp;<span class="ident" id="3778977"><a href="/math/big/arith.go.html#3727748">Word</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3778983">if</span>&nbsp;<span class="ident" id="3778986"><a href="/math/big/nat.go.html#3777845">b</a></span>&nbsp;<span class="op" id="3778988">==</span>&nbsp;<span class="num" id="3778991">10</span>&nbsp;<span class="op" id="3778994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3778998">//&nbsp;hard-coding&nbsp;for&nbsp;10&nbsp;here&nbsp;speeds&nbsp;this&nbsp;up&nbsp;by&nbsp;1.25x&nbsp;(allows&nbsp;for&nbsp;/&nbsp;and&nbsp;%&nbsp;by&nbsp;constants)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3779085">for</span>&nbsp;<span class="builtinfunc" id="3779089">len</span><span class="op" id="3779092">(</span><span class="ident" id="3779093"><a href="/math/big/nat.go.html#3777799">q</a></span><span class="op" id="3779094">)</span>&nbsp;<span class="op" id="3779096">&gt;</span>&nbsp;<span class="num" id="3779098">0</span>&nbsp;<span class="op" id="3779100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3779105">//&nbsp;extract&nbsp;least&nbsp;significant,&nbsp;base&nbsp;bb&nbsp;&#34;digit&#34;</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3779154"><a href="/math/big/nat.go.html#3777799">q</a></span><span class="op" id="3779155">,</span>&nbsp;<span class="ident" id="3779157"><a href="/math/big/nat.go.html#3778975">r</a></span>&nbsp;<span class="op" id="3779159">=</span>&nbsp;<span class="ident" id="3779161"><a href="/math/big/nat.go.html#3777799">q</a></span><span class="op" id="3779162">.</span><span class="ident" id="3779163">divW</span><span class="op" id="3779167">(</span><span class="ident" id="3779168"><a href="/math/big/nat.go.html#3777799">q</a></span><span class="op" id="3779169">,</span>&nbsp;<span class="ident" id="3779171"><a href="/math/big/nat.go.html#3777866">bb</a></span><span class="op" id="3779173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3779178">for</span>&nbsp;<span class="ident" id="3779182">j</span>&nbsp;<span class="op" id="3779184">:=</span>&nbsp;<span class="num" id="3779187">0</span><span class="op" id="3779188">;</span>&nbsp;<span class="ident" id="3779190"><a href="/math/big/nat.go.html#3779182">j</a></span>&nbsp;<span class="op" id="3779192">&lt;</span>&nbsp;<span class="ident" id="3779194"><a href="/math/big/nat.go.html#3777853">ndigits</a></span>&nbsp;<span class="op" id="3779202">&amp;&amp;</span>&nbsp;<span class="ident" id="3779205"><a href="/math/big/nat.go.html#3778958">i</a></span>&nbsp;<span class="op" id="3779207">&gt;</span>&nbsp;<span class="num" id="3779209">0</span><span class="op" id="3779210">;</span>&nbsp;<span class="ident" id="3779212"><a href="/math/big/nat.go.html#3779182">j</a></span><span class="op" id="3779213">++</span>&nbsp;<span class="op" id="3779216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3779222"><a href="/math/big/nat.go.html#3778958">i</a></span><span class="op" id="3779223">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3779230">//&nbsp;avoid&nbsp;%&nbsp;computation&nbsp;since&nbsp;r%10&nbsp;==&nbsp;r&nbsp;-&nbsp;int(r/10)*10;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3779289">//&nbsp;this&nbsp;appears&nbsp;to&nbsp;be&nbsp;faster&nbsp;for&nbsp;BenchmarkString10000Base10</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3779353">//&nbsp;and&nbsp;smaller&nbsp;strings&nbsp;(but&nbsp;a&nbsp;bit&nbsp;slower&nbsp;for&nbsp;larger&nbsp;ones)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3779415">t</span>&nbsp;<span class="op" id="3779417">:=</span>&nbsp;<span class="ident" id="3779420"><a href="/math/big/nat.go.html#3778975">r</a></span>&nbsp;<span class="op" id="3779422">/</span>&nbsp;<span class="num" id="3779424">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3779431"><a href="/math/big/nat.go.html#3777819">s</a></span><span class="op" id="3779432">[</span><span class="ident" id="3779433"><a href="/math/big/nat.go.html#3778958">i</a></span><span class="op" id="3779434">]</span>&nbsp;<span class="op" id="3779436">=</span>&nbsp;<span class="ident" id="3779438"><a href="/math/big/nat.go.html#3777829">charset</a></span><span class="op" id="3779445">[</span><span class="ident" id="3779446"><a href="/math/big/nat.go.html#3778975">r</a></span><span class="op" id="3779447">-</span><span class="ident" id="3779448"><a href="/math/big/nat.go.html#3779415">t</a></span><span class="op" id="3779449">&lt;&lt;</span><span class="num" id="3779451">3</span><span class="op" id="3779452">-</span><span class="ident" id="3779453"><a href="/math/big/nat.go.html#3779415">t</a></span><span class="op" id="3779454">-</span><span class="ident" id="3779455"><a href="/math/big/nat.go.html#3779415">t</a></span><span class="op" id="3779456">]</span>&nbsp;<span class="comment" id="3779458">//&nbsp;TODO(gri)&nbsp;replace&nbsp;w/&nbsp;t*10&nbsp;once&nbsp;compiler&nbsp;produces&nbsp;better&nbsp;code</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3779526"><a href="/math/big/nat.go.html#3778975">r</a></span>&nbsp;<span class="op" id="3779528">=</span>&nbsp;<span class="ident" id="3779530"><a href="/math/big/nat.go.html#3779415">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3779535">}</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3779539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3779542">}</span>&nbsp;<span class="keyword" id="3779544">else</span>&nbsp;<span class="op" id="3779549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3779553">for</span>&nbsp;<span class="builtinfunc" id="3779557">len</span><span class="op" id="3779560">(</span><span class="ident" id="3779561"><a href="/math/big/nat.go.html#3777799">q</a></span><span class="op" id="3779562">)</span>&nbsp;<span class="op" id="3779564">&gt;</span>&nbsp;<span class="num" id="3779566">0</span>&nbsp;<span class="op" id="3779568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3779573">//&nbsp;extract&nbsp;least&nbsp;significant,&nbsp;base&nbsp;bb&nbsp;&#34;digit&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3779622"><a href="/math/big/nat.go.html#3777799">q</a></span><span class="op" id="3779623">,</span>&nbsp;<span class="ident" id="3779625"><a href="/math/big/nat.go.html#3778975">r</a></span>&nbsp;<span class="op" id="3779627">=</span>&nbsp;<span class="ident" id="3779629"><a href="/math/big/nat.go.html#3777799">q</a></span><span class="op" id="3779630">.</span><span class="ident" id="3779631">divW</span><span class="op" id="3779635">(</span><span class="ident" id="3779636"><a href="/math/big/nat.go.html#3777799">q</a></span><span class="op" id="3779637">,</span>&nbsp;<span class="ident" id="3779639"><a href="/math/big/nat.go.html#3777866">bb</a></span><span class="op" id="3779641">)</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3779646">for</span>&nbsp;<span class="ident" id="3779650">j</span>&nbsp;<span class="op" id="3779652">:=</span>&nbsp;<span class="num" id="3779655">0</span><span class="op" id="3779656">;</span>&nbsp;<span class="ident" id="3779658"><a href="/math/big/nat.go.html#3779650">j</a></span>&nbsp;<span class="op" id="3779660">&lt;</span>&nbsp;<span class="ident" id="3779662"><a href="/math/big/nat.go.html#3777853">ndigits</a></span>&nbsp;<span class="op" id="3779670">&amp;&amp;</span>&nbsp;<span class="ident" id="3779673"><a href="/math/big/nat.go.html#3778958">i</a></span>&nbsp;<span class="op" id="3779675">&gt;</span>&nbsp;<span class="num" id="3779677">0</span><span class="op" id="3779678">;</span>&nbsp;<span class="ident" id="3779680"><a href="/math/big/nat.go.html#3779650">j</a></span><span class="op" id="3779681">++</span>&nbsp;<span class="op" id="3779684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3779690"><a href="/math/big/nat.go.html#3778958">i</a></span><span class="op" id="3779691">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3779698"><a href="/math/big/nat.go.html#3777819">s</a></span><span class="op" id="3779699">[</span><span class="ident" id="3779700"><a href="/math/big/nat.go.html#3778958">i</a></span><span class="op" id="3779701">]</span>&nbsp;<span class="op" id="3779703">=</span>&nbsp;<span class="ident" id="3779705"><a href="/math/big/nat.go.html#3777829">charset</a></span><span class="op" id="3779712">[</span><span class="ident" id="3779713"><a href="/math/big/nat.go.html#3778975">r</a></span><span class="op" id="3779714">%</span><span class="ident" id="3779715"><a href="/math/big/nat.go.html#3777845">b</a></span><span class="op" id="3779716">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3779722"><a href="/math/big/nat.go.html#3778975">r</a></span>&nbsp;<span class="op" id="3779724">/=</span>&nbsp;<span class="ident" id="3779727"><a href="/math/big/nat.go.html#3777845">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3779732">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3779736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3779739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3779743">//&nbsp;prepend&nbsp;high-order&nbsp;zeroes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3779773">zero</span>&nbsp;<span class="op" id="3779778">:=</span>&nbsp;<span class="ident" id="3779781"><a href="/math/big/nat.go.html#3777829">charset</a></span><span class="op" id="3779788">[</span><span class="num" id="3779789">0</span><span class="op" id="3779790">]</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3779793">for</span>&nbsp;<span class="ident" id="3779797"><a href="/math/big/nat.go.html#3778958">i</a></span>&nbsp;<span class="op" id="3779799">&gt;</span>&nbsp;<span class="num" id="3779801">0</span>&nbsp;<span class="op" id="3779803">{</span>&nbsp;<span class="comment" id="3779805">//&nbsp;while&nbsp;need&nbsp;more&nbsp;leading&nbsp;zeroes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3779841"><a href="/math/big/nat.go.html#3778958">i</a></span><span class="op" id="3779842">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3779847"><a href="/math/big/nat.go.html#3777819">s</a></span><span class="op" id="3779848">[</span><span class="ident" id="3779849"><a href="/math/big/nat.go.html#3778958">i</a></span><span class="op" id="3779850">]</span>&nbsp;<span class="op" id="3779852">=</span>&nbsp;<span class="ident" id="3779854"><a href="/math/big/nat.go.html#3779773">zero</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3779860">}</span><br>
<span class="lineno"></span><span class="op" id="3779862">}</span><br>
<span class="lineno">910</span><br>
<span class="lineno"></span><span class="comment" id="3779865">//&nbsp;Split&nbsp;blocks&nbsp;greater&nbsp;than&nbsp;leafSize&nbsp;Words&nbsp;(or&nbsp;set&nbsp;to&nbsp;0&nbsp;to&nbsp;disable&nbsp;recursive&nbsp;conversion)</span><br>
<span class="lineno"></span><span class="comment" id="3779955">//&nbsp;Benchmark&nbsp;and&nbsp;configure&nbsp;leafSize&nbsp;using:&nbsp;go&nbsp;test&nbsp;-bench=&#34;Leaf&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3780020">//&nbsp;&nbsp;&nbsp;8&nbsp;and&nbsp;16&nbsp;effective&nbsp;on&nbsp;3.0&nbsp;GHz&nbsp;Xeon&nbsp;&#34;Clovertown&#34;&nbsp;CPU&nbsp;(128&nbsp;byte&nbsp;cache&nbsp;lines)</span><br>
<span class="lineno"></span><span class="comment" id="3780100">//&nbsp;&nbsp;&nbsp;8&nbsp;and&nbsp;16&nbsp;effective&nbsp;on&nbsp;2.66&nbsp;GHz&nbsp;Core&nbsp;2&nbsp;Duo&nbsp;&#34;Penryn&#34;&nbsp;CPU</span><br>
<span class="lineno">915</span><span class="keyword" id="3780160">var</span>&nbsp;<span class="ident" id="3780164">leafSize</span>&nbsp;<span class="builtintype" id="3780173">int</span>&nbsp;<span class="op" id="3780177">=</span>&nbsp;<span class="num" id="3780179">8</span>&nbsp;<span class="comment" id="3780181">//&nbsp;number&nbsp;of&nbsp;Word-size&nbsp;binary&nbsp;values&nbsp;treat&nbsp;as&nbsp;a&nbsp;monolithic&nbsp;block</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3780247">type</span>&nbsp;<span class="ident" id="3780252">divisor</span>&nbsp;<span class="keyword" id="3780260">struct</span>&nbsp;<span class="op" id="3780267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3780270">bbb</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3780278"><a href="/math/big/nat.go.html#3758892">nat</a></span>&nbsp;<span class="comment" id="3780282">//&nbsp;divisor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3780294">nbits</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3780302">int</span>&nbsp;<span class="comment" id="3780306">//&nbsp;bit&nbsp;length&nbsp;of&nbsp;divisor&nbsp;(discounting&nbsp;leading&nbsp;zeroes)&nbsp;~=&nbsp;log2(bbb)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3780374">ndigits</span>&nbsp;<span class="builtintype" id="3780382">int</span>&nbsp;<span class="comment" id="3780386">//&nbsp;digit&nbsp;length&nbsp;of&nbsp;divisor&nbsp;in&nbsp;terms&nbsp;of&nbsp;output&nbsp;base&nbsp;digits</span><br>
<span class="lineno"></span><span class="op" id="3780444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3780447">var</span>&nbsp;<span class="ident" id="3780451">cacheBase10</span>&nbsp;<span class="keyword" id="3780463">struct</span>&nbsp;<span class="op" id="3780470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3780473"><a href="/math/big/nat.go.html#3758369">sync</a></span><span class="op" id="3780477">.</span><span class="ident" id="3780478">Mutex</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3780485">table</span>&nbsp;<span class="op" id="3780491">[</span><span class="num" id="3780492">64</span><span class="op" id="3780494">]</span><span class="ident" id="3780495"><a href="/math/big/nat.go.html#3780252">divisor</a></span>&nbsp;<span class="comment" id="3780503">//&nbsp;cached&nbsp;divisors&nbsp;for&nbsp;base&nbsp;10</span><br>
<span class="lineno"></span><span class="op" id="3780534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3780537">//&nbsp;expWW&nbsp;computes&nbsp;x**y</span><br>
<span class="lineno"></span><span class="keyword" id="3780560">func</span>&nbsp;<span class="op" id="3780565">(</span><span class="ident" id="3780566">z</span>&nbsp;<span class="ident" id="3780568"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3780571">)</span>&nbsp;<span class="ident" id="3780573">expWW</span><span class="op" id="3780578">(</span><span class="ident" id="3780579">x</span><span class="op" id="3780580">,</span>&nbsp;<span class="ident" id="3780582">y</span>&nbsp;<span class="ident" id="3780584"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3780588">)</span>&nbsp;<span class="ident" id="3780590"><a href="/math/big/nat.go.html#3758892">nat</a></span>&nbsp;<span class="op" id="3780594">{</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3780597">return</span>&nbsp;<span class="ident" id="3780604"><a href="/math/big/nat.go.html#3780566">z</a></span><span class="op" id="3780605">.</span><span class="ident" id="3780606">expNN</span><span class="op" id="3780611">(</span><span class="ident" id="3780612"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3780615">(</span><span class="ident" id="3780616">nil</span><span class="op" id="3780619">)</span><span class="op" id="3780620">.</span><span class="ident" id="3780621">setWord</span><span class="op" id="3780628">(</span><span class="ident" id="3780629"><a href="/math/big/nat.go.html#3780579">x</a></span><span class="op" id="3780630">)</span><span class="op" id="3780631">,</span>&nbsp;<span class="ident" id="3780633"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3780636">(</span><span class="ident" id="3780637">nil</span><span class="op" id="3780640">)</span><span class="op" id="3780641">.</span><span class="ident" id="3780642">setWord</span><span class="op" id="3780649">(</span><span class="ident" id="3780650"><a href="/math/big/nat.go.html#3780582">y</a></span><span class="op" id="3780651">)</span><span class="op" id="3780652">,</span>&nbsp;<span class="ident" id="3780654">nil</span><span class="op" id="3780657">)</span><br>
<span class="lineno"></span><span class="op" id="3780659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3780662">//&nbsp;construct&nbsp;table&nbsp;of&nbsp;powers&nbsp;of&nbsp;bb*leafSize&nbsp;to&nbsp;use&nbsp;in&nbsp;subdivisions</span><br>
<span class="lineno"></span><span class="keyword" id="3780729">func</span>&nbsp;<span class="ident" id="3780734">divisors</span><span class="op" id="3780742">(</span><span class="ident" id="3780743">m</span>&nbsp;<span class="builtintype" id="3780745">int</span><span class="op" id="3780748">,</span>&nbsp;<span class="ident" id="3780750">b</span>&nbsp;<span class="ident" id="3780752"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3780756">,</span>&nbsp;<span class="ident" id="3780758">ndigits</span>&nbsp;<span class="builtintype" id="3780766">int</span><span class="op" id="3780769">,</span>&nbsp;<span class="ident" id="3780771">bb</span>&nbsp;<span class="ident" id="3780774"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3780778">)</span>&nbsp;<span class="op" id="3780780">[</span><span class="op" id="3780781">]</span><span class="ident" id="3780782"><a href="/math/big/nat.go.html#3780252">divisor</a></span>&nbsp;<span class="op" id="3780790">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3780793">//&nbsp;only&nbsp;compute&nbsp;table&nbsp;when&nbsp;recursive&nbsp;conversion&nbsp;is&nbsp;enabled&nbsp;and&nbsp;x&nbsp;is&nbsp;large</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3780868">if</span>&nbsp;<span class="ident" id="3780871"><a href="/math/big/nat.go.html#3780164">leafSize</a></span>&nbsp;<span class="op" id="3780880">==</span>&nbsp;<span class="num" id="3780883">0</span>&nbsp;<span class="op" id="3780885">||</span>&nbsp;<span class="ident" id="3780888"><a href="/math/big/nat.go.html#3780743">m</a></span>&nbsp;<span class="op" id="3780890">&lt;=</span>&nbsp;<span class="ident" id="3780893"><a href="/math/big/nat.go.html#3780164">leafSize</a></span>&nbsp;<span class="op" id="3780902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3780906">return</span>&nbsp;<span class="ident" id="3780913">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3780918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3780922">//&nbsp;determine&nbsp;k&nbsp;where&nbsp;(bb**leafSize)**(2**k)&nbsp;&gt;=&nbsp;sqrt(x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3780978">k</span>&nbsp;<span class="op" id="3780980">:=</span>&nbsp;<span class="num" id="3780983">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3780986">for</span>&nbsp;<span class="ident" id="3780990">words</span>&nbsp;<span class="op" id="3780996">:=</span>&nbsp;<span class="ident" id="3780999"><a href="/math/big/nat.go.html#3780164">leafSize</a></span><span class="op" id="3781007">;</span>&nbsp;<span class="ident" id="3781009"><a href="/math/big/nat.go.html#3780990">words</a></span>&nbsp;<span class="op" id="3781015">&lt;</span>&nbsp;<span class="ident" id="3781017"><a href="/math/big/nat.go.html#3780743">m</a></span><span class="op" id="3781018">&gt;&gt;</span><span class="num" id="3781020">1</span>&nbsp;<span class="op" id="3781022">&amp;&amp;</span>&nbsp;<span class="ident" id="3781025"><a href="/math/big/nat.go.html#3780978">k</a></span>&nbsp;<span class="op" id="3781027">&lt;</span>&nbsp;<span class="builtinfunc" id="3781029">len</span><span class="op" id="3781032">(</span><span class="ident" id="3781033"><a href="/math/big/nat.go.html#3780451">cacheBase10</a></span><span class="op" id="3781044">.</span><span class="ident" id="3781045">table</span><span class="op" id="3781050">)</span><span class="op" id="3781051">;</span>&nbsp;<span class="ident" id="3781053"><a href="/math/big/nat.go.html#3780990">words</a></span>&nbsp;<span class="op" id="3781059">&lt;&lt;=</span>&nbsp;<span class="num" id="3781063">1</span>&nbsp;<span class="op" id="3781065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3781069"><a href="/math/big/nat.go.html#3780978">k</a></span><span class="op" id="3781070">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3781074">}</span><br>
<span class="lineno">945</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3781078">//&nbsp;reuse&nbsp;and&nbsp;extend&nbsp;existing&nbsp;table&nbsp;of&nbsp;divisors&nbsp;or&nbsp;create&nbsp;new&nbsp;table&nbsp;as&nbsp;appropriate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3781161">var</span>&nbsp;<span class="ident" id="3781165">table</span>&nbsp;<span class="op" id="3781171">[</span><span class="op" id="3781172">]</span><span class="ident" id="3781173"><a href="/math/big/nat.go.html#3780252">divisor</a></span>&nbsp;<span class="comment" id="3781181">//&nbsp;for&nbsp;b&nbsp;==&nbsp;10,&nbsp;table&nbsp;overlaps&nbsp;with&nbsp;cacheBase10.table</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3781236">if</span>&nbsp;<span class="ident" id="3781239"><a href="/math/big/nat.go.html#3780750">b</a></span>&nbsp;<span class="op" id="3781241">==</span>&nbsp;<span class="num" id="3781244">10</span>&nbsp;<span class="op" id="3781247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3781251"><a href="/math/big/nat.go.html#3780451">cacheBase10</a></span><span class="op" id="3781262">.</span><span class="ident" id="3781263">Lock</span><span class="op" id="3781267">(</span><span class="op" id="3781268">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3781272"><a href="/math/big/nat.go.html#3781165">table</a></span>&nbsp;<span class="op" id="3781278">=</span>&nbsp;<span class="ident" id="3781280"><a href="/math/big/nat.go.html#3780451">cacheBase10</a></span><span class="op" id="3781291">.</span><span class="ident" id="3781292">table</span><span class="op" id="3781297">[</span><span class="num" id="3781298">0</span><span class="op" id="3781299">:</span><span class="ident" id="3781300"><a href="/math/big/nat.go.html#3780978">k</a></span><span class="op" id="3781301">]</span>&nbsp;<span class="comment" id="3781303">//&nbsp;reuse&nbsp;old&nbsp;table&nbsp;for&nbsp;this&nbsp;conversion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3781343">}</span>&nbsp;<span class="keyword" id="3781345">else</span>&nbsp;<span class="op" id="3781350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3781354"><a href="/math/big/nat.go.html#3781165">table</a></span>&nbsp;<span class="op" id="3781360">=</span>&nbsp;<span class="builtinfunc" id="3781362">make</span><span class="op" id="3781366">(</span><span class="op" id="3781367">[</span><span class="op" id="3781368">]</span><span class="ident" id="3781369"><a href="/math/big/nat.go.html#3780252">divisor</a></span><span class="op" id="3781376">,</span>&nbsp;<span class="ident" id="3781378"><a href="/math/big/nat.go.html#3780978">k</a></span><span class="op" id="3781379">)</span>&nbsp;<span class="comment" id="3781381">//&nbsp;create&nbsp;new&nbsp;table&nbsp;for&nbsp;this&nbsp;conversion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3781422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3781426">//&nbsp;extend&nbsp;table</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3781443">if</span>&nbsp;<span class="ident" id="3781446"><a href="/math/big/nat.go.html#3781165">table</a></span><span class="op" id="3781451">[</span><span class="ident" id="3781452"><a href="/math/big/nat.go.html#3780978">k</a></span><span class="op" id="3781453">-</span><span class="num" id="3781454">1</span><span class="op" id="3781455">]</span><span class="op" id="3781456">.</span><span class="ident" id="3781457">ndigits</span>&nbsp;<span class="op" id="3781465">==</span>&nbsp;<span class="num" id="3781468">0</span>&nbsp;<span class="op" id="3781470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3781474">//&nbsp;add&nbsp;new&nbsp;entries&nbsp;as&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3781505">var</span>&nbsp;<span class="ident" id="3781509">larger</span>&nbsp;<span class="ident" id="3781516"><a href="/math/big/nat.go.html#3758892">nat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3781522">for</span>&nbsp;<span class="ident" id="3781526">i</span>&nbsp;<span class="op" id="3781528">:=</span>&nbsp;<span class="num" id="3781531">0</span><span class="op" id="3781532">;</span>&nbsp;<span class="ident" id="3781534"><a href="/math/big/nat.go.html#3781526">i</a></span>&nbsp;<span class="op" id="3781536">&lt;</span>&nbsp;<span class="ident" id="3781538"><a href="/math/big/nat.go.html#3780978">k</a></span><span class="op" id="3781539">;</span>&nbsp;<span class="ident" id="3781541"><a href="/math/big/nat.go.html#3781526">i</a></span><span class="op" id="3781542">++</span>&nbsp;<span class="op" id="3781545">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3781550">if</span>&nbsp;<span class="ident" id="3781553"><a href="/math/big/nat.go.html#3781165">table</a></span><span class="op" id="3781558">[</span><span class="ident" id="3781559"><a href="/math/big/nat.go.html#3781526">i</a></span><span class="op" id="3781560">]</span><span class="op" id="3781561">.</span><span class="ident" id="3781562">ndigits</span>&nbsp;<span class="op" id="3781570">==</span>&nbsp;<span class="num" id="3781573">0</span>&nbsp;<span class="op" id="3781575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3781581">if</span>&nbsp;<span class="ident" id="3781584"><a href="/math/big/nat.go.html#3781526">i</a></span>&nbsp;<span class="op" id="3781586">==</span>&nbsp;<span class="num" id="3781589">0</span>&nbsp;<span class="op" id="3781591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3781598"><a href="/math/big/nat.go.html#3781165">table</a></span><span class="op" id="3781603">[</span><span class="num" id="3781604">0</span><span class="op" id="3781605">]</span><span class="op" id="3781606">.</span><span class="ident" id="3781607">bbb</span>&nbsp;<span class="op" id="3781611">=</span>&nbsp;<span class="ident" id="3781613"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3781616">(</span><span class="ident" id="3781617">nil</span><span class="op" id="3781620">)</span><span class="op" id="3781621">.</span><span class="ident" id="3781622">expWW</span><span class="op" id="3781627">(</span><span class="ident" id="3781628"><a href="/math/big/nat.go.html#3780771">bb</a></span><span class="op" id="3781630">,</span>&nbsp;<span class="ident" id="3781632"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3781636">(</span><span class="ident" id="3781637"><a href="/math/big/nat.go.html#3780164">leafSize</a></span><span class="op" id="3781645">)</span><span class="op" id="3781646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3781653"><a href="/math/big/nat.go.html#3781165">table</a></span><span class="op" id="3781658">[</span><span class="num" id="3781659">0</span><span class="op" id="3781660">]</span><span class="op" id="3781661">.</span><span class="ident" id="3781662">ndigits</span>&nbsp;<span class="op" id="3781670">=</span>&nbsp;<span class="ident" id="3781672"><a href="/math/big/nat.go.html#3780758">ndigits</a></span>&nbsp;<span class="op" id="3781680">*</span>&nbsp;<span class="ident" id="3781682"><a href="/math/big/nat.go.html#3780164">leafSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3781695">}</span>&nbsp;<span class="keyword" id="3781697">else</span>&nbsp;<span class="op" id="3781702">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3781709"><a href="/math/big/nat.go.html#3781165">table</a></span><span class="op" id="3781714">[</span><span class="ident" id="3781715"><a href="/math/big/nat.go.html#3781526">i</a></span><span class="op" id="3781716">]</span><span class="op" id="3781717">.</span><span class="ident" id="3781718">bbb</span>&nbsp;<span class="op" id="3781722">=</span>&nbsp;<span class="ident" id="3781724"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3781727">(</span><span class="ident" id="3781728">nil</span><span class="op" id="3781731">)</span><span class="op" id="3781732">.</span><span class="ident" id="3781733">mul</span><span class="op" id="3781736">(</span><span class="ident" id="3781737"><a href="/math/big/nat.go.html#3781165">table</a></span><span class="op" id="3781742">[</span><span class="ident" id="3781743"><a href="/math/big/nat.go.html#3781526">i</a></span><span class="op" id="3781744">-</span><span class="num" id="3781745">1</span><span class="op" id="3781746">]</span><span class="op" id="3781747">.</span><span class="ident" id="3781748">bbb</span><span class="op" id="3781751">,</span>&nbsp;<span class="ident" id="3781753"><a href="/math/big/nat.go.html#3781165">table</a></span><span class="op" id="3781758">[</span><span class="ident" id="3781759"><a href="/math/big/nat.go.html#3781526">i</a></span><span class="op" id="3781760">-</span><span class="num" id="3781761">1</span><span class="op" id="3781762">]</span><span class="op" id="3781763">.</span><span class="ident" id="3781764">bbb</span><span class="op" id="3781767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3781774"><a href="/math/big/nat.go.html#3781165">table</a></span><span class="op" id="3781779">[</span><span class="ident" id="3781780"><a href="/math/big/nat.go.html#3781526">i</a></span><span class="op" id="3781781">]</span><span class="op" id="3781782">.</span><span class="ident" id="3781783">ndigits</span>&nbsp;<span class="op" id="3781791">=</span>&nbsp;<span class="num" id="3781793">2</span>&nbsp;<span class="op" id="3781795">*</span>&nbsp;<span class="ident" id="3781797"><a href="/math/big/nat.go.html#3781165">table</a></span><span class="op" id="3781802">[</span><span class="ident" id="3781803"><a href="/math/big/nat.go.html#3781526">i</a></span><span class="op" id="3781804">-</span><span class="num" id="3781805">1</span><span class="op" id="3781806">]</span><span class="op" id="3781807">.</span><span class="ident" id="3781808">ndigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3781820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3781827">//&nbsp;optimization:&nbsp;exploit&nbsp;aggregated&nbsp;extra&nbsp;bits&nbsp;in&nbsp;macro&nbsp;blocks</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3781894"><a href="/math/big/nat.go.html#3781509">larger</a></span>&nbsp;<span class="op" id="3781901">=</span>&nbsp;<span class="ident" id="3781903"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3781906">(</span><span class="ident" id="3781907">nil</span><span class="op" id="3781910">)</span><span class="op" id="3781911">.</span><span class="ident" id="3781912">set</span><span class="op" id="3781915">(</span><span class="ident" id="3781916"><a href="/math/big/nat.go.html#3781165">table</a></span><span class="op" id="3781921">[</span><span class="ident" id="3781922"><a href="/math/big/nat.go.html#3781526">i</a></span><span class="op" id="3781923">]</span><span class="op" id="3781924">.</span><span class="ident" id="3781925">bbb</span><span class="op" id="3781928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3781934">for</span>&nbsp;<span class="ident" id="3781938"><a href="/math/big/arith_decl.go.html#3732144">mulAddVWW</a></span><span class="op" id="3781947">(</span><span class="ident" id="3781948"><a href="/math/big/nat.go.html#3781509">larger</a></span><span class="op" id="3781954">,</span>&nbsp;<span class="ident" id="3781956"><a href="/math/big/nat.go.html#3781509">larger</a></span><span class="op" id="3781962">,</span>&nbsp;<span class="ident" id="3781964"><a href="/math/big/nat.go.html#3780750">b</a></span><span class="op" id="3781965">,</span>&nbsp;<span class="num" id="3781967">0</span><span class="op" id="3781968">)</span>&nbsp;<span class="op" id="3781970">==</span>&nbsp;<span class="num" id="3781973">0</span>&nbsp;<span class="op" id="3781975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3781982"><a href="/math/big/nat.go.html#3781165">table</a></span><span class="op" id="3781987">[</span><span class="ident" id="3781988"><a href="/math/big/nat.go.html#3781526">i</a></span><span class="op" id="3781989">]</span><span class="op" id="3781990">.</span><span class="ident" id="3781991">bbb</span>&nbsp;<span class="op" id="3781995">=</span>&nbsp;<span class="ident" id="3781997"><a href="/math/big/nat.go.html#3781165">table</a></span><span class="op" id="3782002">[</span><span class="ident" id="3782003"><a href="/math/big/nat.go.html#3781526">i</a></span><span class="op" id="3782004">]</span><span class="op" id="3782005">.</span><span class="ident" id="3782006">bbb</span><span class="op" id="3782009">.</span><span class="ident" id="3782010">set</span><span class="op" id="3782013">(</span><span class="ident" id="3782014"><a href="/math/big/nat.go.html#3781509">larger</a></span><span class="op" id="3782020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3782027"><a href="/math/big/nat.go.html#3781165">table</a></span><span class="op" id="3782032">[</span><span class="ident" id="3782033"><a href="/math/big/nat.go.html#3781526">i</a></span><span class="op" id="3782034">]</span><span class="op" id="3782035">.</span><span class="ident" id="3782036">ndigits</span><span class="op" id="3782043">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3782050">}</span><br>
<span class="lineno">975</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3782057"><a href="/math/big/nat.go.html#3781165">table</a></span><span class="op" id="3782062">[</span><span class="ident" id="3782063"><a href="/math/big/nat.go.html#3781526">i</a></span><span class="op" id="3782064">]</span><span class="op" id="3782065">.</span><span class="ident" id="3782066">nbits</span>&nbsp;<span class="op" id="3782072">=</span>&nbsp;<span class="ident" id="3782074"><a href="/math/big/nat.go.html#3781165">table</a></span><span class="op" id="3782079">[</span><span class="ident" id="3782080"><a href="/math/big/nat.go.html#3781526">i</a></span><span class="op" id="3782081">]</span><span class="op" id="3782082">.</span><span class="ident" id="3782083">bbb</span><span class="op" id="3782086">.</span><span class="ident" id="3782087">bitLen</span><span class="op" id="3782093">(</span><span class="op" id="3782094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3782099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3782103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3782106">}</span><br>
<span class="lineno">980</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3782110">if</span>&nbsp;<span class="ident" id="3782113"><a href="/math/big/nat.go.html#3780750">b</a></span>&nbsp;<span class="op" id="3782115">==</span>&nbsp;<span class="num" id="3782118">10</span>&nbsp;<span class="op" id="3782121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3782125"><a href="/math/big/nat.go.html#3780451">cacheBase10</a></span><span class="op" id="3782136">.</span><span class="ident" id="3782137">Unlock</span><span class="op" id="3782143">(</span><span class="op" id="3782144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3782147">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3782151">return</span>&nbsp;<span class="ident" id="3782158"><a href="/math/big/nat.go.html#3781165">table</a></span><br>
<span class="lineno"></span><span class="op" id="3782164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3782167">const</span>&nbsp;<span class="ident" id="3782173">deBruijn32</span>&nbsp;<span class="op" id="3782184">=</span>&nbsp;<span class="num" id="3782186">0x077CB531</span><br>
<span class="lineno"></span><br>
<span class="lineno">990</span><span class="keyword" id="3782198">var</span>&nbsp;<span class="ident" id="3782202">deBruijn32Lookup</span>&nbsp;<span class="op" id="3782219">=</span>&nbsp;<span class="op" id="3782221">[</span><span class="op" id="3782222">]</span><span class="builtintype" id="3782223">byte</span><span class="op" id="3782227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3782230">0</span><span class="op" id="3782231">,</span>&nbsp;<span class="num" id="3782233">1</span><span class="op" id="3782234">,</span>&nbsp;<span class="num" id="3782236">28</span><span class="op" id="3782238">,</span>&nbsp;<span class="num" id="3782240">2</span><span class="op" id="3782241">,</span>&nbsp;<span class="num" id="3782243">29</span><span class="op" id="3782245">,</span>&nbsp;<span class="num" id="3782247">14</span><span class="op" id="3782249">,</span>&nbsp;<span class="num" id="3782251">24</span><span class="op" id="3782253">,</span>&nbsp;<span class="num" id="3782255">3</span><span class="op" id="3782256">,</span>&nbsp;<span class="num" id="3782258">30</span><span class="op" id="3782260">,</span>&nbsp;<span class="num" id="3782262">22</span><span class="op" id="3782264">,</span>&nbsp;<span class="num" id="3782266">20</span><span class="op" id="3782268">,</span>&nbsp;<span class="num" id="3782270">15</span><span class="op" id="3782272">,</span>&nbsp;<span class="num" id="3782274">25</span><span class="op" id="3782276">,</span>&nbsp;<span class="num" id="3782278">17</span><span class="op" id="3782280">,</span>&nbsp;<span class="num" id="3782282">4</span><span class="op" id="3782283">,</span>&nbsp;<span class="num" id="3782285">8</span><span class="op" id="3782286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3782289">31</span><span class="op" id="3782291">,</span>&nbsp;<span class="num" id="3782293">27</span><span class="op" id="3782295">,</span>&nbsp;<span class="num" id="3782297">13</span><span class="op" id="3782299">,</span>&nbsp;<span class="num" id="3782301">23</span><span class="op" id="3782303">,</span>&nbsp;<span class="num" id="3782305">21</span><span class="op" id="3782307">,</span>&nbsp;<span class="num" id="3782309">19</span><span class="op" id="3782311">,</span>&nbsp;<span class="num" id="3782313">16</span><span class="op" id="3782315">,</span>&nbsp;<span class="num" id="3782317">7</span><span class="op" id="3782318">,</span>&nbsp;<span class="num" id="3782320">26</span><span class="op" id="3782322">,</span>&nbsp;<span class="num" id="3782324">12</span><span class="op" id="3782326">,</span>&nbsp;<span class="num" id="3782328">18</span><span class="op" id="3782330">,</span>&nbsp;<span class="num" id="3782332">6</span><span class="op" id="3782333">,</span>&nbsp;<span class="num" id="3782335">11</span><span class="op" id="3782337">,</span>&nbsp;<span class="num" id="3782339">5</span><span class="op" id="3782340">,</span>&nbsp;<span class="num" id="3782342">10</span><span class="op" id="3782344">,</span>&nbsp;<span class="num" id="3782346">9</span><span class="op" id="3782347">,</span><br>
<span class="lineno"></span><span class="op" id="3782349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">995</span><span class="keyword" id="3782352">const</span>&nbsp;<span class="ident" id="3782358">deBruijn64</span>&nbsp;<span class="op" id="3782369">=</span>&nbsp;<span class="num" id="3782371">0x03f79d71b4ca8b09</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3782391">var</span>&nbsp;<span class="ident" id="3782395">deBruijn64Lookup</span>&nbsp;<span class="op" id="3782412">=</span>&nbsp;<span class="op" id="3782414">[</span><span class="op" id="3782415">]</span><span class="builtintype" id="3782416">byte</span><span class="op" id="3782420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3782423">0</span><span class="op" id="3782424">,</span>&nbsp;<span class="num" id="3782426">1</span><span class="op" id="3782427">,</span>&nbsp;<span class="num" id="3782429">56</span><span class="op" id="3782431">,</span>&nbsp;<span class="num" id="3782433">2</span><span class="op" id="3782434">,</span>&nbsp;<span class="num" id="3782436">57</span><span class="op" id="3782438">,</span>&nbsp;<span class="num" id="3782440">49</span><span class="op" id="3782442">,</span>&nbsp;<span class="num" id="3782444">28</span><span class="op" id="3782446">,</span>&nbsp;<span class="num" id="3782448">3</span><span class="op" id="3782449">,</span>&nbsp;<span class="num" id="3782451">61</span><span class="op" id="3782453">,</span>&nbsp;<span class="num" id="3782455">58</span><span class="op" id="3782457">,</span>&nbsp;<span class="num" id="3782459">42</span><span class="op" id="3782461">,</span>&nbsp;<span class="num" id="3782463">50</span><span class="op" id="3782465">,</span>&nbsp;<span class="num" id="3782467">38</span><span class="op" id="3782469">,</span>&nbsp;<span class="num" id="3782471">29</span><span class="op" id="3782473">,</span>&nbsp;<span class="num" id="3782475">17</span><span class="op" id="3782477">,</span>&nbsp;<span class="num" id="3782479">4</span><span class="op" id="3782480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3782483">62</span><span class="op" id="3782485">,</span>&nbsp;<span class="num" id="3782487">47</span><span class="op" id="3782489">,</span>&nbsp;<span class="num" id="3782491">59</span><span class="op" id="3782493">,</span>&nbsp;<span class="num" id="3782495">36</span><span class="op" id="3782497">,</span>&nbsp;<span class="num" id="3782499">45</span><span class="op" id="3782501">,</span>&nbsp;<span class="num" id="3782503">43</span><span class="op" id="3782505">,</span>&nbsp;<span class="num" id="3782507">51</span><span class="op" id="3782509">,</span>&nbsp;<span class="num" id="3782511">22</span><span class="op" id="3782513">,</span>&nbsp;<span class="num" id="3782515">53</span><span class="op" id="3782517">,</span>&nbsp;<span class="num" id="3782519">39</span><span class="op" id="3782521">,</span>&nbsp;<span class="num" id="3782523">33</span><span class="op" id="3782525">,</span>&nbsp;<span class="num" id="3782527">30</span><span class="op" id="3782529">,</span>&nbsp;<span class="num" id="3782531">24</span><span class="op" id="3782533">,</span>&nbsp;<span class="num" id="3782535">18</span><span class="op" id="3782537">,</span>&nbsp;<span class="num" id="3782539">12</span><span class="op" id="3782541">,</span>&nbsp;<span class="num" id="3782543">5</span><span class="op" id="3782544">,</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3782547">63</span><span class="op" id="3782549">,</span>&nbsp;<span class="num" id="3782551">55</span><span class="op" id="3782553">,</span>&nbsp;<span class="num" id="3782555">48</span><span class="op" id="3782557">,</span>&nbsp;<span class="num" id="3782559">27</span><span class="op" id="3782561">,</span>&nbsp;<span class="num" id="3782563">60</span><span class="op" id="3782565">,</span>&nbsp;<span class="num" id="3782567">41</span><span class="op" id="3782569">,</span>&nbsp;<span class="num" id="3782571">37</span><span class="op" id="3782573">,</span>&nbsp;<span class="num" id="3782575">16</span><span class="op" id="3782577">,</span>&nbsp;<span class="num" id="3782579">46</span><span class="op" id="3782581">,</span>&nbsp;<span class="num" id="3782583">35</span><span class="op" id="3782585">,</span>&nbsp;<span class="num" id="3782587">44</span><span class="op" id="3782589">,</span>&nbsp;<span class="num" id="3782591">21</span><span class="op" id="3782593">,</span>&nbsp;<span class="num" id="3782595">52</span><span class="op" id="3782597">,</span>&nbsp;<span class="num" id="3782599">32</span><span class="op" id="3782601">,</span>&nbsp;<span class="num" id="3782603">23</span><span class="op" id="3782605">,</span>&nbsp;<span class="num" id="3782607">11</span><span class="op" id="3782609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3782612">54</span><span class="op" id="3782614">,</span>&nbsp;<span class="num" id="3782616">26</span><span class="op" id="3782618">,</span>&nbsp;<span class="num" id="3782620">40</span><span class="op" id="3782622">,</span>&nbsp;<span class="num" id="3782624">15</span><span class="op" id="3782626">,</span>&nbsp;<span class="num" id="3782628">34</span><span class="op" id="3782630">,</span>&nbsp;<span class="num" id="3782632">20</span><span class="op" id="3782634">,</span>&nbsp;<span class="num" id="3782636">31</span><span class="op" id="3782638">,</span>&nbsp;<span class="num" id="3782640">10</span><span class="op" id="3782642">,</span>&nbsp;<span class="num" id="3782644">25</span><span class="op" id="3782646">,</span>&nbsp;<span class="num" id="3782648">14</span><span class="op" id="3782650">,</span>&nbsp;<span class="num" id="3782652">19</span><span class="op" id="3782654">,</span>&nbsp;<span class="num" id="3782656">9</span><span class="op" id="3782657">,</span>&nbsp;<span class="num" id="3782659">13</span><span class="op" id="3782661">,</span>&nbsp;<span class="num" id="3782663">8</span><span class="op" id="3782664">,</span>&nbsp;<span class="num" id="3782666">7</span><span class="op" id="3782667">,</span>&nbsp;<span class="num" id="3782669">6</span><span class="op" id="3782670">,</span><br>
<span class="lineno"></span><span class="op" id="3782672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3782675">//&nbsp;trailingZeroBits&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;consecutive&nbsp;least&nbsp;significant&nbsp;zero</span><br>
<span class="lineno">1005</span><span class="comment" id="3782752">//&nbsp;bits&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="3782766">func</span>&nbsp;<span class="ident" id="3782771">trailingZeroBits</span><span class="op" id="3782787">(</span><span class="ident" id="3782788">x</span>&nbsp;<span class="ident" id="3782790"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3782794">)</span>&nbsp;<span class="builtintype" id="3782796">uint</span>&nbsp;<span class="op" id="3782801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3782804">//&nbsp;x&nbsp;&amp;&nbsp;-x&nbsp;leaves&nbsp;only&nbsp;the&nbsp;right-most&nbsp;bit&nbsp;set&nbsp;in&nbsp;the&nbsp;word.&nbsp;Let&nbsp;k&nbsp;be&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3782876">//&nbsp;index&nbsp;of&nbsp;that&nbsp;bit.&nbsp;Since&nbsp;only&nbsp;a&nbsp;single&nbsp;bit&nbsp;is&nbsp;set,&nbsp;the&nbsp;value&nbsp;is&nbsp;two</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3782948">//&nbsp;to&nbsp;the&nbsp;power&nbsp;of&nbsp;k.&nbsp;Multiplying&nbsp;by&nbsp;a&nbsp;power&nbsp;of&nbsp;two&nbsp;is&nbsp;equivalent&nbsp;to</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3783018">//&nbsp;left&nbsp;shifting,&nbsp;in&nbsp;this&nbsp;case&nbsp;by&nbsp;k&nbsp;bits.&nbsp;&nbsp;The&nbsp;de&nbsp;Bruijn&nbsp;constant&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3783088">//&nbsp;such&nbsp;that&nbsp;all&nbsp;six&nbsp;bit,&nbsp;consecutive&nbsp;substrings&nbsp;are&nbsp;distinct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3783152">//&nbsp;Therefore,&nbsp;if&nbsp;we&nbsp;have&nbsp;a&nbsp;left&nbsp;shifted&nbsp;version&nbsp;of&nbsp;this&nbsp;constant&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3783225">//&nbsp;find&nbsp;by&nbsp;how&nbsp;many&nbsp;bits&nbsp;it&nbsp;was&nbsp;shifted&nbsp;by&nbsp;looking&nbsp;at&nbsp;which&nbsp;six&nbsp;bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3783294">//&nbsp;substring&nbsp;ended&nbsp;up&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;word.</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3783341">//&nbsp;(Knuth,&nbsp;volume&nbsp;4,&nbsp;section&nbsp;7.3.1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3783378">switch</span>&nbsp;<span class="ident" id="3783385"><a href="/math/big/arith.go.html#3727893">_W</a></span>&nbsp;<span class="op" id="3783388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3783391">case</span>&nbsp;<span class="num" id="3783396">32</span><span class="op" id="3783398">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3783402">return</span>&nbsp;<span class="builtintype" id="3783409">uint</span><span class="op" id="3783413">(</span><span class="ident" id="3783414"><a href="/math/big/nat.go.html#3782202">deBruijn32Lookup</a></span><span class="op" id="3783430">[</span><span class="op" id="3783431">(</span><span class="op" id="3783432">(</span><span class="ident" id="3783433"><a href="/math/big/nat.go.html#3782788">x</a></span><span class="op" id="3783434">&amp;</span><span class="op" id="3783435">-</span><span class="ident" id="3783436"><a href="/math/big/nat.go.html#3782788">x</a></span><span class="op" id="3783437">)</span><span class="op" id="3783438">*</span><span class="ident" id="3783439"><a href="/math/big/nat.go.html#3782173">deBruijn32</a></span><span class="op" id="3783449">)</span><span class="op" id="3783450">&gt;&gt;</span><span class="num" id="3783452">27</span><span class="op" id="3783454">]</span><span class="op" id="3783455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3783458">case</span>&nbsp;<span class="num" id="3783463">64</span><span class="op" id="3783465">:</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3783469">return</span>&nbsp;<span class="builtintype" id="3783476">uint</span><span class="op" id="3783480">(</span><span class="ident" id="3783481"><a href="/math/big/nat.go.html#3782395">deBruijn64Lookup</a></span><span class="op" id="3783497">[</span><span class="op" id="3783498">(</span><span class="op" id="3783499">(</span><span class="ident" id="3783500"><a href="/math/big/nat.go.html#3782788">x</a></span><span class="op" id="3783501">&amp;</span><span class="op" id="3783502">-</span><span class="ident" id="3783503"><a href="/math/big/nat.go.html#3782788">x</a></span><span class="op" id="3783504">)</span><span class="op" id="3783505">*</span><span class="op" id="3783506">(</span><span class="ident" id="3783507"><a href="/math/big/nat.go.html#3782358">deBruijn64</a></span><span class="op" id="3783517">&amp;</span><span class="ident" id="3783518"><a href="/math/big/arith.go.html#3727956">_M</a></span><span class="op" id="3783520">)</span><span class="op" id="3783521">)</span><span class="op" id="3783522">&gt;&gt;</span><span class="num" id="3783524">58</span><span class="op" id="3783526">]</span><span class="op" id="3783527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3783530">default</span><span class="op" id="3783537">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3783541">panic</span><span class="op" id="3783546">(</span><span class="string" id="3783547">&#34;unknown&nbsp;word&nbsp;size&#34;</span><span class="op" id="3783566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3783569">}</span><br>
<span class="lineno"></span><span class="op" id="3783571">}</span><br>
<span class="lineno">1025</span><br>
<span class="lineno"></span><span class="comment" id="3783574">//&nbsp;trailingZeroBits&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;consecutive&nbsp;least&nbsp;significant&nbsp;zero</span><br>
<span class="lineno"></span><span class="comment" id="3783651">//&nbsp;bits&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="3783665">func</span>&nbsp;<span class="op" id="3783670">(</span><span class="ident" id="3783671">x</span>&nbsp;<span class="ident" id="3783673"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3783676">)</span>&nbsp;<span class="ident" id="3783678">trailingZeroBits</span><span class="op" id="3783694">(</span><span class="op" id="3783695">)</span>&nbsp;<span class="builtintype" id="3783697">uint</span>&nbsp;<span class="op" id="3783702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3783705">if</span>&nbsp;<span class="builtinfunc" id="3783708">len</span><span class="op" id="3783711">(</span><span class="ident" id="3783712"><a href="/math/big/nat.go.html#3783671">x</a></span><span class="op" id="3783713">)</span>&nbsp;<span class="op" id="3783715">==</span>&nbsp;<span class="num" id="3783718">0</span>&nbsp;<span class="op" id="3783720">{</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3783724">return</span>&nbsp;<span class="num" id="3783731">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3783734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3783737">var</span>&nbsp;<span class="ident" id="3783741">i</span>&nbsp;<span class="builtintype" id="3783743">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3783749">for</span>&nbsp;<span class="ident" id="3783753"><a href="/math/big/nat.go.html#3783671">x</a></span><span class="op" id="3783754">[</span><span class="ident" id="3783755"><a href="/math/big/nat.go.html#3783741">i</a></span><span class="op" id="3783756">]</span>&nbsp;<span class="op" id="3783758">==</span>&nbsp;<span class="num" id="3783761">0</span>&nbsp;<span class="op" id="3783763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3783767"><a href="/math/big/nat.go.html#3783741">i</a></span><span class="op" id="3783768">++</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3783772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3783775">//&nbsp;x[i]&nbsp;!=&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3783789">return</span>&nbsp;<span class="ident" id="3783796"><a href="/math/big/nat.go.html#3783741">i</a></span><span class="op" id="3783797">*</span><span class="ident" id="3783798"><a href="/math/big/arith.go.html#3727893">_W</a></span>&nbsp;<span class="op" id="3783801">+</span>&nbsp;<span class="ident" id="3783803"><a href="/math/big/nat.go.html#3782771">trailingZeroBits</a></span><span class="op" id="3783819">(</span><span class="ident" id="3783820"><a href="/math/big/nat.go.html#3783671">x</a></span><span class="op" id="3783821">[</span><span class="ident" id="3783822"><a href="/math/big/nat.go.html#3783741">i</a></span><span class="op" id="3783823">]</span><span class="op" id="3783824">)</span><br>
<span class="lineno"></span><span class="op" id="3783826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1040</span><span class="comment" id="3783829">//&nbsp;z&nbsp;=&nbsp;x&nbsp;&lt;&lt;&nbsp;s</span><br>
<span class="lineno"></span><span class="keyword" id="3783843">func</span>&nbsp;<span class="op" id="3783848">(</span><span class="ident" id="3783849">z</span>&nbsp;<span class="ident" id="3783851"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3783854">)</span>&nbsp;<span class="ident" id="3783856">shl</span><span class="op" id="3783859">(</span><span class="ident" id="3783860">x</span>&nbsp;<span class="ident" id="3783862"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3783865">,</span>&nbsp;<span class="ident" id="3783867">s</span>&nbsp;<span class="builtintype" id="3783869">uint</span><span class="op" id="3783873">)</span>&nbsp;<span class="ident" id="3783875"><a href="/math/big/nat.go.html#3758892">nat</a></span>&nbsp;<span class="op" id="3783879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3783882">m</span>&nbsp;<span class="op" id="3783884">:=</span>&nbsp;<span class="builtinfunc" id="3783887">len</span><span class="op" id="3783890">(</span><span class="ident" id="3783891"><a href="/math/big/nat.go.html#3783860">x</a></span><span class="op" id="3783892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3783895">if</span>&nbsp;<span class="ident" id="3783898"><a href="/math/big/nat.go.html#3783882">m</a></span>&nbsp;<span class="op" id="3783900">==</span>&nbsp;<span class="num" id="3783903">0</span>&nbsp;<span class="op" id="3783905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3783909">return</span>&nbsp;<span class="ident" id="3783916"><a href="/math/big/nat.go.html#3783849">z</a></span><span class="op" id="3783917">.</span><span class="builtinfunc" id="3783918">make</span><span class="op" id="3783922">(</span><span class="num" id="3783923">0</span><span class="op" id="3783924">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3783927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3783930">//&nbsp;m&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3783941">n</span>&nbsp;<span class="op" id="3783943">:=</span>&nbsp;<span class="ident" id="3783946"><a href="/math/big/nat.go.html#3783882">m</a></span>&nbsp;<span class="op" id="3783948">+</span>&nbsp;<span class="builtintype" id="3783950">int</span><span class="op" id="3783953">(</span><span class="ident" id="3783954"><a href="/math/big/nat.go.html#3783867">s</a></span><span class="op" id="3783955">/</span><span class="ident" id="3783956"><a href="/math/big/arith.go.html#3727893">_W</a></span><span class="op" id="3783958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3783961"><a href="/math/big/nat.go.html#3783849">z</a></span>&nbsp;<span class="op" id="3783963">=</span>&nbsp;<span class="ident" id="3783965"><a href="/math/big/nat.go.html#3783849">z</a></span><span class="op" id="3783966">.</span><span class="builtinfunc" id="3783967">make</span><span class="op" id="3783971">(</span><span class="ident" id="3783972"><a href="/math/big/nat.go.html#3783941">n</a></span>&nbsp;<span class="op" id="3783974">+</span>&nbsp;<span class="num" id="3783976">1</span><span class="op" id="3783977">)</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3783980"><a href="/math/big/nat.go.html#3783849">z</a></span><span class="op" id="3783981">[</span><span class="ident" id="3783982"><a href="/math/big/nat.go.html#3783941">n</a></span><span class="op" id="3783983">]</span>&nbsp;<span class="op" id="3783985">=</span>&nbsp;<span class="ident" id="3783987"><a href="/math/big/arith_decl.go.html#3732062">shlVU</a></span><span class="op" id="3783992">(</span><span class="ident" id="3783993"><a href="/math/big/nat.go.html#3783849">z</a></span><span class="op" id="3783994">[</span><span class="ident" id="3783995"><a href="/math/big/nat.go.html#3783941">n</a></span><span class="op" id="3783996">-</span><span class="ident" id="3783997"><a href="/math/big/nat.go.html#3783882">m</a></span><span class="op" id="3783998">:</span><span class="ident" id="3783999"><a href="/math/big/nat.go.html#3783941">n</a></span><span class="op" id="3784000">]</span><span class="op" id="3784001">,</span>&nbsp;<span class="ident" id="3784003"><a href="/math/big/nat.go.html#3783860">x</a></span><span class="op" id="3784004">,</span>&nbsp;<span class="ident" id="3784006"><a href="/math/big/nat.go.html#3783867">s</a></span><span class="op" id="3784007">%</span><span class="ident" id="3784008"><a href="/math/big/arith.go.html#3727893">_W</a></span><span class="op" id="3784010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784013"><a href="/math/big/nat.go.html#3783849">z</a></span><span class="op" id="3784014">[</span><span class="num" id="3784015">0</span>&nbsp;<span class="op" id="3784017">:</span>&nbsp;<span class="ident" id="3784019"><a href="/math/big/nat.go.html#3783941">n</a></span><span class="op" id="3784020">-</span><span class="ident" id="3784021"><a href="/math/big/nat.go.html#3783882">m</a></span><span class="op" id="3784022">]</span><span class="op" id="3784023">.</span><span class="ident" id="3784024">clear</span><span class="op" id="3784029">(</span><span class="op" id="3784030">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784034">return</span>&nbsp;<span class="ident" id="3784041"><a href="/math/big/nat.go.html#3783849">z</a></span><span class="op" id="3784042">.</span><span class="ident" id="3784043">norm</span><span class="op" id="3784047">(</span><span class="op" id="3784048">)</span><br>
<span class="lineno"></span><span class="op" id="3784050">}</span><br>
<span class="lineno">1055</span><br>
<span class="lineno"></span><span class="comment" id="3784053">//&nbsp;z&nbsp;=&nbsp;x&nbsp;&gt;&gt;&nbsp;s</span><br>
<span class="lineno"></span><span class="keyword" id="3784067">func</span>&nbsp;<span class="op" id="3784072">(</span><span class="ident" id="3784073">z</span>&nbsp;<span class="ident" id="3784075"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3784078">)</span>&nbsp;<span class="ident" id="3784080">shr</span><span class="op" id="3784083">(</span><span class="ident" id="3784084">x</span>&nbsp;<span class="ident" id="3784086"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3784089">,</span>&nbsp;<span class="ident" id="3784091">s</span>&nbsp;<span class="builtintype" id="3784093">uint</span><span class="op" id="3784097">)</span>&nbsp;<span class="ident" id="3784099"><a href="/math/big/nat.go.html#3758892">nat</a></span>&nbsp;<span class="op" id="3784103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784106">m</span>&nbsp;<span class="op" id="3784108">:=</span>&nbsp;<span class="builtinfunc" id="3784111">len</span><span class="op" id="3784114">(</span><span class="ident" id="3784115"><a href="/math/big/nat.go.html#3784084">x</a></span><span class="op" id="3784116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784119">n</span>&nbsp;<span class="op" id="3784121">:=</span>&nbsp;<span class="ident" id="3784124"><a href="/math/big/nat.go.html#3784106">m</a></span>&nbsp;<span class="op" id="3784126">-</span>&nbsp;<span class="builtintype" id="3784128">int</span><span class="op" id="3784131">(</span><span class="ident" id="3784132"><a href="/math/big/nat.go.html#3784091">s</a></span><span class="op" id="3784133">/</span><span class="ident" id="3784134"><a href="/math/big/arith.go.html#3727893">_W</a></span><span class="op" id="3784136">)</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784139">if</span>&nbsp;<span class="ident" id="3784142"><a href="/math/big/nat.go.html#3784119">n</a></span>&nbsp;<span class="op" id="3784144">&lt;=</span>&nbsp;<span class="num" id="3784147">0</span>&nbsp;<span class="op" id="3784149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784153">return</span>&nbsp;<span class="ident" id="3784160"><a href="/math/big/nat.go.html#3784073">z</a></span><span class="op" id="3784161">.</span><span class="builtinfunc" id="3784162">make</span><span class="op" id="3784166">(</span><span class="num" id="3784167">0</span><span class="op" id="3784168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3784171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3784174">//&nbsp;n&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784185"><a href="/math/big/nat.go.html#3784073">z</a></span>&nbsp;<span class="op" id="3784187">=</span>&nbsp;<span class="ident" id="3784189"><a href="/math/big/nat.go.html#3784073">z</a></span><span class="op" id="3784190">.</span><span class="builtinfunc" id="3784191">make</span><span class="op" id="3784195">(</span><span class="ident" id="3784196"><a href="/math/big/nat.go.html#3784119">n</a></span><span class="op" id="3784197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784200"><a href="/math/big/arith_decl.go.html#3732103">shrVU</a></span><span class="op" id="3784205">(</span><span class="ident" id="3784206"><a href="/math/big/nat.go.html#3784073">z</a></span><span class="op" id="3784207">,</span>&nbsp;<span class="ident" id="3784209"><a href="/math/big/nat.go.html#3784084">x</a></span><span class="op" id="3784210">[</span><span class="ident" id="3784211"><a href="/math/big/nat.go.html#3784106">m</a></span><span class="op" id="3784212">-</span><span class="ident" id="3784213"><a href="/math/big/nat.go.html#3784119">n</a></span><span class="op" id="3784214">:</span><span class="op" id="3784215">]</span><span class="op" id="3784216">,</span>&nbsp;<span class="ident" id="3784218"><a href="/math/big/nat.go.html#3784091">s</a></span><span class="op" id="3784219">%</span><span class="ident" id="3784220"><a href="/math/big/arith.go.html#3727893">_W</a></span><span class="op" id="3784222">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784226">return</span>&nbsp;<span class="ident" id="3784233"><a href="/math/big/nat.go.html#3784073">z</a></span><span class="op" id="3784234">.</span><span class="ident" id="3784235">norm</span><span class="op" id="3784239">(</span><span class="op" id="3784240">)</span><br>
<span class="lineno"></span><span class="op" id="3784242">}</span><br>
<span class="lineno">1070</span><br>
<span class="lineno"></span><span class="keyword" id="3784245">func</span>&nbsp;<span class="op" id="3784250">(</span><span class="ident" id="3784251">z</span>&nbsp;<span class="ident" id="3784253"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3784256">)</span>&nbsp;<span class="ident" id="3784258">setBit</span><span class="op" id="3784264">(</span><span class="ident" id="3784265">x</span>&nbsp;<span class="ident" id="3784267"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3784270">,</span>&nbsp;<span class="ident" id="3784272">i</span>&nbsp;<span class="builtintype" id="3784274">uint</span><span class="op" id="3784278">,</span>&nbsp;<span class="ident" id="3784280">b</span>&nbsp;<span class="builtintype" id="3784282">uint</span><span class="op" id="3784286">)</span>&nbsp;<span class="ident" id="3784288"><a href="/math/big/nat.go.html#3758892">nat</a></span>&nbsp;<span class="op" id="3784292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784295">j</span>&nbsp;<span class="op" id="3784297">:=</span>&nbsp;<span class="builtintype" id="3784300">int</span><span class="op" id="3784303">(</span><span class="ident" id="3784304"><a href="/math/big/nat.go.html#3784272">i</a></span>&nbsp;<span class="op" id="3784306">/</span>&nbsp;<span class="ident" id="3784308"><a href="/math/big/arith.go.html#3727893">_W</a></span><span class="op" id="3784310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784313">m</span>&nbsp;<span class="op" id="3784315">:=</span>&nbsp;<span class="ident" id="3784318"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3784322">(</span><span class="num" id="3784323">1</span><span class="op" id="3784324">)</span>&nbsp;<span class="op" id="3784326">&lt;&lt;</span>&nbsp;<span class="op" id="3784329">(</span><span class="ident" id="3784330"><a href="/math/big/nat.go.html#3784272">i</a></span>&nbsp;<span class="op" id="3784332">%</span>&nbsp;<span class="ident" id="3784334"><a href="/math/big/arith.go.html#3727893">_W</a></span><span class="op" id="3784336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784339">n</span>&nbsp;<span class="op" id="3784341">:=</span>&nbsp;<span class="builtinfunc" id="3784344">len</span><span class="op" id="3784347">(</span><span class="ident" id="3784348"><a href="/math/big/nat.go.html#3784265">x</a></span><span class="op" id="3784349">)</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784352">switch</span>&nbsp;<span class="ident" id="3784359"><a href="/math/big/nat.go.html#3784280">b</a></span>&nbsp;<span class="op" id="3784361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784364">case</span>&nbsp;<span class="num" id="3784369">0</span><span class="op" id="3784370">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784374"><a href="/math/big/nat.go.html#3784251">z</a></span>&nbsp;<span class="op" id="3784376">=</span>&nbsp;<span class="ident" id="3784378"><a href="/math/big/nat.go.html#3784251">z</a></span><span class="op" id="3784379">.</span><span class="builtinfunc" id="3784380">make</span><span class="op" id="3784384">(</span><span class="ident" id="3784385"><a href="/math/big/nat.go.html#3784339">n</a></span><span class="op" id="3784386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3784390">copy</span><span class="op" id="3784394">(</span><span class="ident" id="3784395"><a href="/math/big/nat.go.html#3784251">z</a></span><span class="op" id="3784396">,</span>&nbsp;<span class="ident" id="3784398"><a href="/math/big/nat.go.html#3784265">x</a></span><span class="op" id="3784399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784403">if</span>&nbsp;<span class="ident" id="3784406"><a href="/math/big/nat.go.html#3784295">j</a></span>&nbsp;<span class="op" id="3784408">&gt;=</span>&nbsp;<span class="ident" id="3784411"><a href="/math/big/nat.go.html#3784339">n</a></span>&nbsp;<span class="op" id="3784413">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3784418">//&nbsp;no&nbsp;need&nbsp;to&nbsp;grow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784440">return</span>&nbsp;<span class="ident" id="3784447"><a href="/math/big/nat.go.html#3784251">z</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3784451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784455"><a href="/math/big/nat.go.html#3784251">z</a></span><span class="op" id="3784456">[</span><span class="ident" id="3784457"><a href="/math/big/nat.go.html#3784295">j</a></span><span class="op" id="3784458">]</span>&nbsp;<span class="op" id="3784460">&amp;^=</span>&nbsp;<span class="ident" id="3784464"><a href="/math/big/nat.go.html#3784313">m</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784468">return</span>&nbsp;<span class="ident" id="3784475"><a href="/math/big/nat.go.html#3784251">z</a></span><span class="op" id="3784476">.</span><span class="ident" id="3784477">norm</span><span class="op" id="3784481">(</span><span class="op" id="3784482">)</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784485">case</span>&nbsp;<span class="num" id="3784490">1</span><span class="op" id="3784491">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784495">if</span>&nbsp;<span class="ident" id="3784498"><a href="/math/big/nat.go.html#3784295">j</a></span>&nbsp;<span class="op" id="3784500">&gt;=</span>&nbsp;<span class="ident" id="3784503"><a href="/math/big/nat.go.html#3784339">n</a></span>&nbsp;<span class="op" id="3784505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784510"><a href="/math/big/nat.go.html#3784251">z</a></span>&nbsp;<span class="op" id="3784512">=</span>&nbsp;<span class="ident" id="3784514"><a href="/math/big/nat.go.html#3784251">z</a></span><span class="op" id="3784515">.</span><span class="builtinfunc" id="3784516">make</span><span class="op" id="3784520">(</span><span class="ident" id="3784521"><a href="/math/big/nat.go.html#3784295">j</a></span>&nbsp;<span class="op" id="3784523">+</span>&nbsp;<span class="num" id="3784525">1</span><span class="op" id="3784526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784531"><a href="/math/big/nat.go.html#3784251">z</a></span><span class="op" id="3784532">[</span><span class="ident" id="3784533"><a href="/math/big/nat.go.html#3784339">n</a></span><span class="op" id="3784534">:</span><span class="op" id="3784535">]</span><span class="op" id="3784536">.</span><span class="ident" id="3784537">clear</span><span class="op" id="3784542">(</span><span class="op" id="3784543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3784547">}</span>&nbsp;<span class="keyword" id="3784549">else</span>&nbsp;<span class="op" id="3784554">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784559"><a href="/math/big/nat.go.html#3784251">z</a></span>&nbsp;<span class="op" id="3784561">=</span>&nbsp;<span class="ident" id="3784563"><a href="/math/big/nat.go.html#3784251">z</a></span><span class="op" id="3784564">.</span><span class="builtinfunc" id="3784565">make</span><span class="op" id="3784569">(</span><span class="ident" id="3784570"><a href="/math/big/nat.go.html#3784339">n</a></span><span class="op" id="3784571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3784575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3784579">copy</span><span class="op" id="3784583">(</span><span class="ident" id="3784584"><a href="/math/big/nat.go.html#3784251">z</a></span><span class="op" id="3784585">,</span>&nbsp;<span class="ident" id="3784587"><a href="/math/big/nat.go.html#3784265">x</a></span><span class="op" id="3784588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784592"><a href="/math/big/nat.go.html#3784251">z</a></span><span class="op" id="3784593">[</span><span class="ident" id="3784594"><a href="/math/big/nat.go.html#3784295">j</a></span><span class="op" id="3784595">]</span>&nbsp;<span class="op" id="3784597">|=</span>&nbsp;<span class="ident" id="3784600"><a href="/math/big/nat.go.html#3784313">m</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3784604">//&nbsp;no&nbsp;need&nbsp;to&nbsp;normalize</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784630">return</span>&nbsp;<span class="ident" id="3784637"><a href="/math/big/nat.go.html#3784251">z</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3784640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3784643">panic</span><span class="op" id="3784648">(</span><span class="string" id="3784649">&#34;set&nbsp;bit&nbsp;is&nbsp;not&nbsp;0&nbsp;or&nbsp;1&#34;</span><span class="op" id="3784672">)</span><br>
<span class="lineno"></span><span class="op" id="3784674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1100</span><span class="keyword" id="3784677">func</span>&nbsp;<span class="op" id="3784682">(</span><span class="ident" id="3784683">z</span>&nbsp;<span class="ident" id="3784685"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3784688">)</span>&nbsp;<span class="ident" id="3784690">bit</span><span class="op" id="3784693">(</span><span class="ident" id="3784694">i</span>&nbsp;<span class="builtintype" id="3784696">uint</span><span class="op" id="3784700">)</span>&nbsp;<span class="builtintype" id="3784702">uint</span>&nbsp;<span class="op" id="3784707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784710">j</span>&nbsp;<span class="op" id="3784712">:=</span>&nbsp;<span class="builtintype" id="3784715">int</span><span class="op" id="3784718">(</span><span class="ident" id="3784719"><a href="/math/big/nat.go.html#3784694">i</a></span>&nbsp;<span class="op" id="3784721">/</span>&nbsp;<span class="ident" id="3784723"><a href="/math/big/arith.go.html#3727893">_W</a></span><span class="op" id="3784725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784728">if</span>&nbsp;<span class="ident" id="3784731"><a href="/math/big/nat.go.html#3784710">j</a></span>&nbsp;<span class="op" id="3784733">&gt;=</span>&nbsp;<span class="builtinfunc" id="3784736">len</span><span class="op" id="3784739">(</span><span class="ident" id="3784740"><a href="/math/big/nat.go.html#3784683">z</a></span><span class="op" id="3784741">)</span>&nbsp;<span class="op" id="3784743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784747">return</span>&nbsp;<span class="num" id="3784754">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3784757">}</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784760">return</span>&nbsp;<span class="builtintype" id="3784767">uint</span><span class="op" id="3784771">(</span><span class="ident" id="3784772"><a href="/math/big/nat.go.html#3784683">z</a></span><span class="op" id="3784773">[</span><span class="ident" id="3784774"><a href="/math/big/nat.go.html#3784710">j</a></span><span class="op" id="3784775">]</span>&nbsp;<span class="op" id="3784777">&gt;&gt;</span>&nbsp;<span class="op" id="3784780">(</span><span class="ident" id="3784781"><a href="/math/big/nat.go.html#3784694">i</a></span>&nbsp;<span class="op" id="3784783">%</span>&nbsp;<span class="ident" id="3784785"><a href="/math/big/arith.go.html#3727893">_W</a></span><span class="op" id="3784787">)</span>&nbsp;<span class="op" id="3784789">&amp;</span>&nbsp;<span class="num" id="3784791">1</span><span class="op" id="3784792">)</span><br>
<span class="lineno"></span><span class="op" id="3784794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3784797">func</span>&nbsp;<span class="op" id="3784802">(</span><span class="ident" id="3784803">z</span>&nbsp;<span class="ident" id="3784805"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3784808">)</span>&nbsp;<span class="ident" id="3784810">and</span><span class="op" id="3784813">(</span><span class="ident" id="3784814">x</span><span class="op" id="3784815">,</span>&nbsp;<span class="ident" id="3784817">y</span>&nbsp;<span class="ident" id="3784819"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3784822">)</span>&nbsp;<span class="ident" id="3784824"><a href="/math/big/nat.go.html#3758892">nat</a></span>&nbsp;<span class="op" id="3784828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784831">m</span>&nbsp;<span class="op" id="3784833">:=</span>&nbsp;<span class="builtinfunc" id="3784836">len</span><span class="op" id="3784839">(</span><span class="ident" id="3784840"><a href="/math/big/nat.go.html#3784814">x</a></span><span class="op" id="3784841">)</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784844">n</span>&nbsp;<span class="op" id="3784846">:=</span>&nbsp;<span class="builtinfunc" id="3784849">len</span><span class="op" id="3784852">(</span><span class="ident" id="3784853"><a href="/math/big/nat.go.html#3784817">y</a></span><span class="op" id="3784854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784857">if</span>&nbsp;<span class="ident" id="3784860"><a href="/math/big/nat.go.html#3784831">m</a></span>&nbsp;<span class="op" id="3784862">&gt;</span>&nbsp;<span class="ident" id="3784864"><a href="/math/big/nat.go.html#3784844">n</a></span>&nbsp;<span class="op" id="3784866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784870"><a href="/math/big/nat.go.html#3784831">m</a></span>&nbsp;<span class="op" id="3784872">=</span>&nbsp;<span class="ident" id="3784874"><a href="/math/big/nat.go.html#3784844">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3784877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3784880">//&nbsp;m&nbsp;&lt;=&nbsp;n</span><br>
<span class="lineno">1115</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784892"><a href="/math/big/nat.go.html#3784803">z</a></span>&nbsp;<span class="op" id="3784894">=</span>&nbsp;<span class="ident" id="3784896"><a href="/math/big/nat.go.html#3784803">z</a></span><span class="op" id="3784897">.</span><span class="builtinfunc" id="3784898">make</span><span class="op" id="3784902">(</span><span class="ident" id="3784903"><a href="/math/big/nat.go.html#3784831">m</a></span><span class="op" id="3784904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784907">for</span>&nbsp;<span class="ident" id="3784911">i</span>&nbsp;<span class="op" id="3784913">:=</span>&nbsp;<span class="num" id="3784916">0</span><span class="op" id="3784917">;</span>&nbsp;<span class="ident" id="3784919"><a href="/math/big/nat.go.html#3784911">i</a></span>&nbsp;<span class="op" id="3784921">&lt;</span>&nbsp;<span class="ident" id="3784923"><a href="/math/big/nat.go.html#3784831">m</a></span><span class="op" id="3784924">;</span>&nbsp;<span class="ident" id="3784926"><a href="/math/big/nat.go.html#3784911">i</a></span><span class="op" id="3784927">++</span>&nbsp;<span class="op" id="3784930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784934"><a href="/math/big/nat.go.html#3784803">z</a></span><span class="op" id="3784935">[</span><span class="ident" id="3784936"><a href="/math/big/nat.go.html#3784911">i</a></span><span class="op" id="3784937">]</span>&nbsp;<span class="op" id="3784939">=</span>&nbsp;<span class="ident" id="3784941"><a href="/math/big/nat.go.html#3784814">x</a></span><span class="op" id="3784942">[</span><span class="ident" id="3784943"><a href="/math/big/nat.go.html#3784911">i</a></span><span class="op" id="3784944">]</span>&nbsp;<span class="op" id="3784946">&amp;</span>&nbsp;<span class="ident" id="3784948"><a href="/math/big/nat.go.html#3784817">y</a></span><span class="op" id="3784949">[</span><span class="ident" id="3784950"><a href="/math/big/nat.go.html#3784911">i</a></span><span class="op" id="3784951">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3784954">}</span><br>
<span class="lineno">1120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784958">return</span>&nbsp;<span class="ident" id="3784965"><a href="/math/big/nat.go.html#3784803">z</a></span><span class="op" id="3784966">.</span><span class="ident" id="3784967">norm</span><span class="op" id="3784971">(</span><span class="op" id="3784972">)</span><br>
<span class="lineno"></span><span class="op" id="3784974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3784977">func</span>&nbsp;<span class="op" id="3784982">(</span><span class="ident" id="3784983">z</span>&nbsp;<span class="ident" id="3784985"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3784988">)</span>&nbsp;<span class="ident" id="3784990">andNot</span><span class="op" id="3784996">(</span><span class="ident" id="3784997">x</span><span class="op" id="3784998">,</span>&nbsp;<span class="ident" id="3785000">y</span>&nbsp;<span class="ident" id="3785002"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3785005">)</span>&nbsp;<span class="ident" id="3785007"><a href="/math/big/nat.go.html#3758892">nat</a></span>&nbsp;<span class="op" id="3785011">{</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785014">m</span>&nbsp;<span class="op" id="3785016">:=</span>&nbsp;<span class="builtinfunc" id="3785019">len</span><span class="op" id="3785022">(</span><span class="ident" id="3785023"><a href="/math/big/nat.go.html#3784997">x</a></span><span class="op" id="3785024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785027">n</span>&nbsp;<span class="op" id="3785029">:=</span>&nbsp;<span class="builtinfunc" id="3785032">len</span><span class="op" id="3785035">(</span><span class="ident" id="3785036"><a href="/math/big/nat.go.html#3785000">y</a></span><span class="op" id="3785037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785040">if</span>&nbsp;<span class="ident" id="3785043"><a href="/math/big/nat.go.html#3785027">n</a></span>&nbsp;<span class="op" id="3785045">&gt;</span>&nbsp;<span class="ident" id="3785047"><a href="/math/big/nat.go.html#3785014">m</a></span>&nbsp;<span class="op" id="3785049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785053"><a href="/math/big/nat.go.html#3785027">n</a></span>&nbsp;<span class="op" id="3785055">=</span>&nbsp;<span class="ident" id="3785057"><a href="/math/big/nat.go.html#3785014">m</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3785060">}</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3785063">//&nbsp;m&nbsp;&gt;=&nbsp;n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785075"><a href="/math/big/nat.go.html#3784983">z</a></span>&nbsp;<span class="op" id="3785077">=</span>&nbsp;<span class="ident" id="3785079"><a href="/math/big/nat.go.html#3784983">z</a></span><span class="op" id="3785080">.</span><span class="builtinfunc" id="3785081">make</span><span class="op" id="3785085">(</span><span class="ident" id="3785086"><a href="/math/big/nat.go.html#3785014">m</a></span><span class="op" id="3785087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785090">for</span>&nbsp;<span class="ident" id="3785094">i</span>&nbsp;<span class="op" id="3785096">:=</span>&nbsp;<span class="num" id="3785099">0</span><span class="op" id="3785100">;</span>&nbsp;<span class="ident" id="3785102"><a href="/math/big/nat.go.html#3785094">i</a></span>&nbsp;<span class="op" id="3785104">&lt;</span>&nbsp;<span class="ident" id="3785106"><a href="/math/big/nat.go.html#3785027">n</a></span><span class="op" id="3785107">;</span>&nbsp;<span class="ident" id="3785109"><a href="/math/big/nat.go.html#3785094">i</a></span><span class="op" id="3785110">++</span>&nbsp;<span class="op" id="3785113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785117"><a href="/math/big/nat.go.html#3784983">z</a></span><span class="op" id="3785118">[</span><span class="ident" id="3785119"><a href="/math/big/nat.go.html#3785094">i</a></span><span class="op" id="3785120">]</span>&nbsp;<span class="op" id="3785122">=</span>&nbsp;<span class="ident" id="3785124"><a href="/math/big/nat.go.html#3784997">x</a></span><span class="op" id="3785125">[</span><span class="ident" id="3785126"><a href="/math/big/nat.go.html#3785094">i</a></span><span class="op" id="3785127">]</span>&nbsp;<span class="op" id="3785129">&amp;^</span>&nbsp;<span class="ident" id="3785132"><a href="/math/big/nat.go.html#3785000">y</a></span><span class="op" id="3785133">[</span><span class="ident" id="3785134"><a href="/math/big/nat.go.html#3785094">i</a></span><span class="op" id="3785135">]</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3785138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3785141">copy</span><span class="op" id="3785145">(</span><span class="ident" id="3785146"><a href="/math/big/nat.go.html#3784983">z</a></span><span class="op" id="3785147">[</span><span class="ident" id="3785148"><a href="/math/big/nat.go.html#3785027">n</a></span><span class="op" id="3785149">:</span><span class="ident" id="3785150"><a href="/math/big/nat.go.html#3785014">m</a></span><span class="op" id="3785151">]</span><span class="op" id="3785152">,</span>&nbsp;<span class="ident" id="3785154"><a href="/math/big/nat.go.html#3784997">x</a></span><span class="op" id="3785155">[</span><span class="ident" id="3785156"><a href="/math/big/nat.go.html#3785027">n</a></span><span class="op" id="3785157">:</span><span class="ident" id="3785158"><a href="/math/big/nat.go.html#3785014">m</a></span><span class="op" id="3785159">]</span><span class="op" id="3785160">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785164">return</span>&nbsp;<span class="ident" id="3785171"><a href="/math/big/nat.go.html#3784983">z</a></span><span class="op" id="3785172">.</span><span class="ident" id="3785173">norm</span><span class="op" id="3785177">(</span><span class="op" id="3785178">)</span><br>
<span class="lineno"></span><span class="op" id="3785180">}</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span><span class="keyword" id="3785183">func</span>&nbsp;<span class="op" id="3785188">(</span><span class="ident" id="3785189">z</span>&nbsp;<span class="ident" id="3785191"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3785194">)</span>&nbsp;<span class="ident" id="3785196">or</span><span class="op" id="3785198">(</span><span class="ident" id="3785199">x</span><span class="op" id="3785200">,</span>&nbsp;<span class="ident" id="3785202">y</span>&nbsp;<span class="ident" id="3785204"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3785207">)</span>&nbsp;<span class="ident" id="3785209"><a href="/math/big/nat.go.html#3758892">nat</a></span>&nbsp;<span class="op" id="3785213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785216">m</span>&nbsp;<span class="op" id="3785218">:=</span>&nbsp;<span class="builtinfunc" id="3785221">len</span><span class="op" id="3785224">(</span><span class="ident" id="3785225"><a href="/math/big/nat.go.html#3785199">x</a></span><span class="op" id="3785226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785229">n</span>&nbsp;<span class="op" id="3785231">:=</span>&nbsp;<span class="builtinfunc" id="3785234">len</span><span class="op" id="3785237">(</span><span class="ident" id="3785238"><a href="/math/big/nat.go.html#3785202">y</a></span><span class="op" id="3785239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785242">s</span>&nbsp;<span class="op" id="3785244">:=</span>&nbsp;<span class="ident" id="3785247"><a href="/math/big/nat.go.html#3785199">x</a></span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785250">if</span>&nbsp;<span class="ident" id="3785253"><a href="/math/big/nat.go.html#3785216">m</a></span>&nbsp;<span class="op" id="3785255">&lt;</span>&nbsp;<span class="ident" id="3785257"><a href="/math/big/nat.go.html#3785229">n</a></span>&nbsp;<span class="op" id="3785259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785263"><a href="/math/big/nat.go.html#3785229">n</a></span><span class="op" id="3785264">,</span>&nbsp;<span class="ident" id="3785266"><a href="/math/big/nat.go.html#3785216">m</a></span>&nbsp;<span class="op" id="3785268">=</span>&nbsp;<span class="ident" id="3785270"><a href="/math/big/nat.go.html#3785216">m</a></span><span class="op" id="3785271">,</span>&nbsp;<span class="ident" id="3785273"><a href="/math/big/nat.go.html#3785229">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785277"><a href="/math/big/nat.go.html#3785242">s</a></span>&nbsp;<span class="op" id="3785279">=</span>&nbsp;<span class="ident" id="3785281"><a href="/math/big/nat.go.html#3785202">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3785284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3785287">//&nbsp;m&nbsp;&gt;=&nbsp;n</span><br>
<span class="lineno">1150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785299"><a href="/math/big/nat.go.html#3785189">z</a></span>&nbsp;<span class="op" id="3785301">=</span>&nbsp;<span class="ident" id="3785303"><a href="/math/big/nat.go.html#3785189">z</a></span><span class="op" id="3785304">.</span><span class="builtinfunc" id="3785305">make</span><span class="op" id="3785309">(</span><span class="ident" id="3785310"><a href="/math/big/nat.go.html#3785216">m</a></span><span class="op" id="3785311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785314">for</span>&nbsp;<span class="ident" id="3785318">i</span>&nbsp;<span class="op" id="3785320">:=</span>&nbsp;<span class="num" id="3785323">0</span><span class="op" id="3785324">;</span>&nbsp;<span class="ident" id="3785326"><a href="/math/big/nat.go.html#3785318">i</a></span>&nbsp;<span class="op" id="3785328">&lt;</span>&nbsp;<span class="ident" id="3785330"><a href="/math/big/nat.go.html#3785229">n</a></span><span class="op" id="3785331">;</span>&nbsp;<span class="ident" id="3785333"><a href="/math/big/nat.go.html#3785318">i</a></span><span class="op" id="3785334">++</span>&nbsp;<span class="op" id="3785337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785341"><a href="/math/big/nat.go.html#3785189">z</a></span><span class="op" id="3785342">[</span><span class="ident" id="3785343"><a href="/math/big/nat.go.html#3785318">i</a></span><span class="op" id="3785344">]</span>&nbsp;<span class="op" id="3785346">=</span>&nbsp;<span class="ident" id="3785348"><a href="/math/big/nat.go.html#3785199">x</a></span><span class="op" id="3785349">[</span><span class="ident" id="3785350"><a href="/math/big/nat.go.html#3785318">i</a></span><span class="op" id="3785351">]</span>&nbsp;<span class="op" id="3785353">|</span>&nbsp;<span class="ident" id="3785355"><a href="/math/big/nat.go.html#3785202">y</a></span><span class="op" id="3785356">[</span><span class="ident" id="3785357"><a href="/math/big/nat.go.html#3785318">i</a></span><span class="op" id="3785358">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3785361">}</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3785364">copy</span><span class="op" id="3785368">(</span><span class="ident" id="3785369"><a href="/math/big/nat.go.html#3785189">z</a></span><span class="op" id="3785370">[</span><span class="ident" id="3785371"><a href="/math/big/nat.go.html#3785229">n</a></span><span class="op" id="3785372">:</span><span class="ident" id="3785373"><a href="/math/big/nat.go.html#3785216">m</a></span><span class="op" id="3785374">]</span><span class="op" id="3785375">,</span>&nbsp;<span class="ident" id="3785377"><a href="/math/big/nat.go.html#3785242">s</a></span><span class="op" id="3785378">[</span><span class="ident" id="3785379"><a href="/math/big/nat.go.html#3785229">n</a></span><span class="op" id="3785380">:</span><span class="ident" id="3785381"><a href="/math/big/nat.go.html#3785216">m</a></span><span class="op" id="3785382">]</span><span class="op" id="3785383">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785387">return</span>&nbsp;<span class="ident" id="3785394"><a href="/math/big/nat.go.html#3785189">z</a></span><span class="op" id="3785395">.</span><span class="ident" id="3785396">norm</span><span class="op" id="3785400">(</span><span class="op" id="3785401">)</span><br>
<span class="lineno"></span><span class="op" id="3785403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1160</span><span class="keyword" id="3785406">func</span>&nbsp;<span class="op" id="3785411">(</span><span class="ident" id="3785412">z</span>&nbsp;<span class="ident" id="3785414"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3785417">)</span>&nbsp;<span class="ident" id="3785419">xor</span><span class="op" id="3785422">(</span><span class="ident" id="3785423">x</span><span class="op" id="3785424">,</span>&nbsp;<span class="ident" id="3785426">y</span>&nbsp;<span class="ident" id="3785428"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3785431">)</span>&nbsp;<span class="ident" id="3785433"><a href="/math/big/nat.go.html#3758892">nat</a></span>&nbsp;<span class="op" id="3785437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785440">m</span>&nbsp;<span class="op" id="3785442">:=</span>&nbsp;<span class="builtinfunc" id="3785445">len</span><span class="op" id="3785448">(</span><span class="ident" id="3785449"><a href="/math/big/nat.go.html#3785423">x</a></span><span class="op" id="3785450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785453">n</span>&nbsp;<span class="op" id="3785455">:=</span>&nbsp;<span class="builtinfunc" id="3785458">len</span><span class="op" id="3785461">(</span><span class="ident" id="3785462"><a href="/math/big/nat.go.html#3785426">y</a></span><span class="op" id="3785463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785466">s</span>&nbsp;<span class="op" id="3785468">:=</span>&nbsp;<span class="ident" id="3785471"><a href="/math/big/nat.go.html#3785423">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785474">if</span>&nbsp;<span class="ident" id="3785477"><a href="/math/big/nat.go.html#3785440">m</a></span>&nbsp;<span class="op" id="3785479">&lt;</span>&nbsp;<span class="ident" id="3785481"><a href="/math/big/nat.go.html#3785453">n</a></span>&nbsp;<span class="op" id="3785483">{</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785487"><a href="/math/big/nat.go.html#3785453">n</a></span><span class="op" id="3785488">,</span>&nbsp;<span class="ident" id="3785490"><a href="/math/big/nat.go.html#3785440">m</a></span>&nbsp;<span class="op" id="3785492">=</span>&nbsp;<span class="ident" id="3785494"><a href="/math/big/nat.go.html#3785440">m</a></span><span class="op" id="3785495">,</span>&nbsp;<span class="ident" id="3785497"><a href="/math/big/nat.go.html#3785453">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785501"><a href="/math/big/nat.go.html#3785466">s</a></span>&nbsp;<span class="op" id="3785503">=</span>&nbsp;<span class="ident" id="3785505"><a href="/math/big/nat.go.html#3785426">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3785508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3785511">//&nbsp;m&nbsp;&gt;=&nbsp;n</span><br>
<span class="lineno"></span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785523"><a href="/math/big/nat.go.html#3785412">z</a></span>&nbsp;<span class="op" id="3785525">=</span>&nbsp;<span class="ident" id="3785527"><a href="/math/big/nat.go.html#3785412">z</a></span><span class="op" id="3785528">.</span><span class="builtinfunc" id="3785529">make</span><span class="op" id="3785533">(</span><span class="ident" id="3785534"><a href="/math/big/nat.go.html#3785440">m</a></span><span class="op" id="3785535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785538">for</span>&nbsp;<span class="ident" id="3785542">i</span>&nbsp;<span class="op" id="3785544">:=</span>&nbsp;<span class="num" id="3785547">0</span><span class="op" id="3785548">;</span>&nbsp;<span class="ident" id="3785550"><a href="/math/big/nat.go.html#3785542">i</a></span>&nbsp;<span class="op" id="3785552">&lt;</span>&nbsp;<span class="ident" id="3785554"><a href="/math/big/nat.go.html#3785453">n</a></span><span class="op" id="3785555">;</span>&nbsp;<span class="ident" id="3785557"><a href="/math/big/nat.go.html#3785542">i</a></span><span class="op" id="3785558">++</span>&nbsp;<span class="op" id="3785561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785565"><a href="/math/big/nat.go.html#3785412">z</a></span><span class="op" id="3785566">[</span><span class="ident" id="3785567"><a href="/math/big/nat.go.html#3785542">i</a></span><span class="op" id="3785568">]</span>&nbsp;<span class="op" id="3785570">=</span>&nbsp;<span class="ident" id="3785572"><a href="/math/big/nat.go.html#3785423">x</a></span><span class="op" id="3785573">[</span><span class="ident" id="3785574"><a href="/math/big/nat.go.html#3785542">i</a></span><span class="op" id="3785575">]</span>&nbsp;<span class="op" id="3785577">^</span>&nbsp;<span class="ident" id="3785579"><a href="/math/big/nat.go.html#3785426">y</a></span><span class="op" id="3785580">[</span><span class="ident" id="3785581"><a href="/math/big/nat.go.html#3785542">i</a></span><span class="op" id="3785582">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3785585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3785588">copy</span><span class="op" id="3785592">(</span><span class="ident" id="3785593"><a href="/math/big/nat.go.html#3785412">z</a></span><span class="op" id="3785594">[</span><span class="ident" id="3785595"><a href="/math/big/nat.go.html#3785453">n</a></span><span class="op" id="3785596">:</span><span class="ident" id="3785597"><a href="/math/big/nat.go.html#3785440">m</a></span><span class="op" id="3785598">]</span><span class="op" id="3785599">,</span>&nbsp;<span class="ident" id="3785601"><a href="/math/big/nat.go.html#3785466">s</a></span><span class="op" id="3785602">[</span><span class="ident" id="3785603"><a href="/math/big/nat.go.html#3785453">n</a></span><span class="op" id="3785604">:</span><span class="ident" id="3785605"><a href="/math/big/nat.go.html#3785440">m</a></span><span class="op" id="3785606">]</span><span class="op" id="3785607">)</span><br>
<span class="lineno">1175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785611">return</span>&nbsp;<span class="ident" id="3785618"><a href="/math/big/nat.go.html#3785412">z</a></span><span class="op" id="3785619">.</span><span class="ident" id="3785620">norm</span><span class="op" id="3785624">(</span><span class="op" id="3785625">)</span><br>
<span class="lineno"></span><span class="op" id="3785627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3785630">//&nbsp;greaterThan&nbsp;returns&nbsp;true&nbsp;iff&nbsp;(x1&lt;&lt;_W&nbsp;+&nbsp;x2)&nbsp;&gt;&nbsp;(y1&lt;&lt;_W&nbsp;+&nbsp;y2)</span><br>
<span class="lineno">1180</span><span class="keyword" id="3785692">func</span>&nbsp;<span class="ident" id="3785697">greaterThan</span><span class="op" id="3785708">(</span><span class="ident" id="3785709">x1</span><span class="op" id="3785711">,</span>&nbsp;<span class="ident" id="3785713">x2</span><span class="op" id="3785715">,</span>&nbsp;<span class="ident" id="3785717">y1</span><span class="op" id="3785719">,</span>&nbsp;<span class="ident" id="3785721">y2</span>&nbsp;<span class="ident" id="3785724"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3785728">)</span>&nbsp;<span class="builtintype" id="3785730">bool</span>&nbsp;<span class="op" id="3785735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785738">return</span>&nbsp;<span class="ident" id="3785745"><a href="/math/big/nat.go.html#3785709">x1</a></span>&nbsp;<span class="op" id="3785748">&gt;</span>&nbsp;<span class="ident" id="3785750"><a href="/math/big/nat.go.html#3785717">y1</a></span>&nbsp;<span class="op" id="3785753">||</span>&nbsp;<span class="ident" id="3785756"><a href="/math/big/nat.go.html#3785709">x1</a></span>&nbsp;<span class="op" id="3785759">==</span>&nbsp;<span class="ident" id="3785762"><a href="/math/big/nat.go.html#3785717">y1</a></span>&nbsp;<span class="op" id="3785765">&amp;&amp;</span>&nbsp;<span class="ident" id="3785768"><a href="/math/big/nat.go.html#3785713">x2</a></span>&nbsp;<span class="op" id="3785771">&gt;</span>&nbsp;<span class="ident" id="3785773"><a href="/math/big/nat.go.html#3785721">y2</a></span><br>
<span class="lineno"></span><span class="op" id="3785776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3785779">//&nbsp;modW&nbsp;returns&nbsp;x&nbsp;%&nbsp;d.</span><br>
<span class="lineno">1185</span><span class="keyword" id="3785802">func</span>&nbsp;<span class="op" id="3785807">(</span><span class="ident" id="3785808">x</span>&nbsp;<span class="ident" id="3785810"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3785813">)</span>&nbsp;<span class="ident" id="3785815">modW</span><span class="op" id="3785819">(</span><span class="ident" id="3785820">d</span>&nbsp;<span class="ident" id="3785822"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3785826">)</span>&nbsp;<span class="op" id="3785828">(</span><span class="ident" id="3785829">r</span>&nbsp;<span class="ident" id="3785831"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3785835">)</span>&nbsp;<span class="op" id="3785837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3785840">//&nbsp;TODO(agl):&nbsp;we&nbsp;don&#39;t&nbsp;actually&nbsp;need&nbsp;to&nbsp;store&nbsp;the&nbsp;q&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785900">var</span>&nbsp;<span class="ident" id="3785904">q</span>&nbsp;<span class="ident" id="3785906"><a href="/math/big/nat.go.html#3758892">nat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785911"><a href="/math/big/nat.go.html#3785904">q</a></span>&nbsp;<span class="op" id="3785913">=</span>&nbsp;<span class="ident" id="3785915"><a href="/math/big/nat.go.html#3785904">q</a></span><span class="op" id="3785916">.</span><span class="builtinfunc" id="3785917">make</span><span class="op" id="3785921">(</span><span class="builtinfunc" id="3785922">len</span><span class="op" id="3785925">(</span><span class="ident" id="3785926"><a href="/math/big/nat.go.html#3785808">x</a></span><span class="op" id="3785927">)</span><span class="op" id="3785928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785931">return</span>&nbsp;<span class="ident" id="3785938"><a href="/math/big/arith_decl.go.html#3732237">divWVW</a></span><span class="op" id="3785944">(</span><span class="ident" id="3785945"><a href="/math/big/nat.go.html#3785904">q</a></span><span class="op" id="3785946">,</span>&nbsp;<span class="num" id="3785948">0</span><span class="op" id="3785949">,</span>&nbsp;<span class="ident" id="3785951"><a href="/math/big/nat.go.html#3785808">x</a></span><span class="op" id="3785952">,</span>&nbsp;<span class="ident" id="3785954"><a href="/math/big/nat.go.html#3785820">d</a></span><span class="op" id="3785955">)</span><br>
<span class="lineno">1190</span><span class="op" id="3785957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3785960">//&nbsp;random&nbsp;creates&nbsp;a&nbsp;random&nbsp;integer&nbsp;in&nbsp;[0..limit),&nbsp;using&nbsp;the&nbsp;space&nbsp;in&nbsp;z&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="3786034">//&nbsp;possible.&nbsp;n&nbsp;is&nbsp;the&nbsp;bit&nbsp;length&nbsp;of&nbsp;limit.</span><br>
<span class="lineno"></span><span class="keyword" id="3786077">func</span>&nbsp;<span class="op" id="3786082">(</span><span class="ident" id="3786083">z</span>&nbsp;<span class="ident" id="3786085"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3786088">)</span>&nbsp;<span class="ident" id="3786090">random</span><span class="op" id="3786096">(</span><span class="ident" id="3786097">rand</span>&nbsp;<span class="op" id="3786102">*</span><span class="ident" id="3786103"><a href="/math/big/nat.go.html#3758356">rand</a></span><span class="op" id="3786107">.</span><span class="ident" id="3786108">Rand</span><span class="op" id="3786112">,</span>&nbsp;<span class="ident" id="3786114">limit</span>&nbsp;<span class="ident" id="3786120"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3786123">,</span>&nbsp;<span class="ident" id="3786125">n</span>&nbsp;<span class="builtintype" id="3786127">int</span><span class="op" id="3786130">)</span>&nbsp;<span class="ident" id="3786132"><a href="/math/big/nat.go.html#3758892">nat</a></span>&nbsp;<span class="op" id="3786136">{</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786139">if</span>&nbsp;<span class="ident" id="3786142"><a href="/math/big/nat.go.html#3764870">alias</a></span><span class="op" id="3786147">(</span><span class="ident" id="3786148"><a href="/math/big/nat.go.html#3786083">z</a></span><span class="op" id="3786149">,</span>&nbsp;<span class="ident" id="3786151"><a href="/math/big/nat.go.html#3786114">limit</a></span><span class="op" id="3786156">)</span>&nbsp;<span class="op" id="3786158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3786162"><a href="/math/big/nat.go.html#3786083">z</a></span>&nbsp;<span class="op" id="3786164">=</span>&nbsp;<span class="ident" id="3786166">nil</span>&nbsp;<span class="comment" id="3786170">//&nbsp;z&nbsp;is&nbsp;an&nbsp;alias&nbsp;for&nbsp;limit&nbsp;-&nbsp;cannot&nbsp;reuse</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3786213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3786216"><a href="/math/big/nat.go.html#3786083">z</a></span>&nbsp;<span class="op" id="3786218">=</span>&nbsp;<span class="ident" id="3786220"><a href="/math/big/nat.go.html#3786083">z</a></span><span class="op" id="3786221">.</span><span class="builtinfunc" id="3786222">make</span><span class="op" id="3786226">(</span><span class="builtinfunc" id="3786227">len</span><span class="op" id="3786230">(</span><span class="ident" id="3786231"><a href="/math/big/nat.go.html#3786114">limit</a></span><span class="op" id="3786236">)</span><span class="op" id="3786237">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3786241">bitLengthOfMSW</span>&nbsp;<span class="op" id="3786256">:=</span>&nbsp;<span class="builtintype" id="3786259">uint</span><span class="op" id="3786263">(</span><span class="ident" id="3786264"><a href="/math/big/nat.go.html#3786125">n</a></span>&nbsp;<span class="op" id="3786266">%</span>&nbsp;<span class="ident" id="3786268"><a href="/math/big/arith.go.html#3727893">_W</a></span><span class="op" id="3786270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786273">if</span>&nbsp;<span class="ident" id="3786276"><a href="/math/big/nat.go.html#3786241">bitLengthOfMSW</a></span>&nbsp;<span class="op" id="3786291">==</span>&nbsp;<span class="num" id="3786294">0</span>&nbsp;<span class="op" id="3786296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3786300"><a href="/math/big/nat.go.html#3786241">bitLengthOfMSW</a></span>&nbsp;<span class="op" id="3786315">=</span>&nbsp;<span class="ident" id="3786317"><a href="/math/big/arith.go.html#3727893">_W</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3786321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3786324">mask</span>&nbsp;<span class="op" id="3786329">:=</span>&nbsp;<span class="ident" id="3786332"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3786336">(</span><span class="op" id="3786337">(</span><span class="num" id="3786338">1</span>&nbsp;<span class="op" id="3786340">&lt;&lt;</span>&nbsp;<span class="ident" id="3786343"><a href="/math/big/nat.go.html#3786241">bitLengthOfMSW</a></span><span class="op" id="3786357">)</span>&nbsp;<span class="op" id="3786359">-</span>&nbsp;<span class="num" id="3786361">1</span><span class="op" id="3786362">)</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786366">for</span>&nbsp;<span class="op" id="3786370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786374">switch</span>&nbsp;<span class="ident" id="3786381"><a href="/math/big/arith.go.html#3727893">_W</a></span>&nbsp;<span class="op" id="3786384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786388">case</span>&nbsp;<span class="num" id="3786393">32</span><span class="op" id="3786395">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786400">for</span>&nbsp;<span class="ident" id="3786404">i</span>&nbsp;<span class="op" id="3786406">:=</span>&nbsp;<span class="keyword" id="3786409">range</span>&nbsp;<span class="ident" id="3786415"><a href="/math/big/nat.go.html#3786083">z</a></span>&nbsp;<span class="op" id="3786417">{</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3786423"><a href="/math/big/nat.go.html#3786083">z</a></span><span class="op" id="3786424">[</span><span class="ident" id="3786425"><a href="/math/big/nat.go.html#3786404">i</a></span><span class="op" id="3786426">]</span>&nbsp;<span class="op" id="3786428">=</span>&nbsp;<span class="ident" id="3786430"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3786434">(</span><span class="ident" id="3786435"><a href="/math/big/nat.go.html#3786097">rand</a></span><span class="op" id="3786439">.</span><span class="ident" id="3786440">Uint32</span><span class="op" id="3786446">(</span><span class="op" id="3786447">)</span><span class="op" id="3786448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3786453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786457">case</span>&nbsp;<span class="num" id="3786462">64</span><span class="op" id="3786464">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786469">for</span>&nbsp;<span class="ident" id="3786473">i</span>&nbsp;<span class="op" id="3786475">:=</span>&nbsp;<span class="keyword" id="3786478">range</span>&nbsp;<span class="ident" id="3786484"><a href="/math/big/nat.go.html#3786083">z</a></span>&nbsp;<span class="op" id="3786486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3786492"><a href="/math/big/nat.go.html#3786083">z</a></span><span class="op" id="3786493">[</span><span class="ident" id="3786494"><a href="/math/big/nat.go.html#3786473">i</a></span><span class="op" id="3786495">]</span>&nbsp;<span class="op" id="3786497">=</span>&nbsp;<span class="ident" id="3786499"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3786503">(</span><span class="ident" id="3786504"><a href="/math/big/nat.go.html#3786097">rand</a></span><span class="op" id="3786508">.</span><span class="ident" id="3786509">Uint32</span><span class="op" id="3786515">(</span><span class="op" id="3786516">)</span><span class="op" id="3786517">)</span>&nbsp;<span class="op" id="3786519">|</span>&nbsp;<span class="ident" id="3786521"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3786525">(</span><span class="ident" id="3786526"><a href="/math/big/nat.go.html#3786097">rand</a></span><span class="op" id="3786530">.</span><span class="ident" id="3786531">Uint32</span><span class="op" id="3786537">(</span><span class="op" id="3786538">)</span><span class="op" id="3786539">)</span><span class="op" id="3786540">&lt;&lt;</span><span class="num" id="3786542">32</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3786548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786552">default</span><span class="op" id="3786559">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3786564">panic</span><span class="op" id="3786569">(</span><span class="string" id="3786570">&#34;unknown&nbsp;word&nbsp;size&#34;</span><span class="op" id="3786589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3786593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3786597"><a href="/math/big/nat.go.html#3786083">z</a></span><span class="op" id="3786598">[</span><span class="builtinfunc" id="3786599">len</span><span class="op" id="3786602">(</span><span class="ident" id="3786603"><a href="/math/big/nat.go.html#3786114">limit</a></span><span class="op" id="3786608">)</span><span class="op" id="3786609">-</span><span class="num" id="3786610">1</span><span class="op" id="3786611">]</span>&nbsp;<span class="op" id="3786613">&amp;=</span>&nbsp;<span class="ident" id="3786616"><a href="/math/big/nat.go.html#3786324">mask</a></span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786623">if</span>&nbsp;<span class="ident" id="3786626"><a href="/math/big/nat.go.html#3786083">z</a></span><span class="op" id="3786627">.</span><span class="ident" id="3786628">cmp</span><span class="op" id="3786631">(</span><span class="ident" id="3786632"><a href="/math/big/nat.go.html#3786114">limit</a></span><span class="op" id="3786637">)</span>&nbsp;<span class="op" id="3786639">&lt;</span>&nbsp;<span class="num" id="3786641">0</span>&nbsp;<span class="op" id="3786643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786648">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3786656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3786659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786663">return</span>&nbsp;<span class="ident" id="3786670"><a href="/math/big/nat.go.html#3786083">z</a></span><span class="op" id="3786671">.</span><span class="ident" id="3786672">norm</span><span class="op" id="3786676">(</span><span class="op" id="3786677">)</span><br>
<span class="lineno"></span><span class="op" id="3786679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3786682">//&nbsp;If&nbsp;m&nbsp;!=&nbsp;0&nbsp;(i.e.,&nbsp;len(m)&nbsp;!=&nbsp;0),&nbsp;expNN&nbsp;sets&nbsp;z&nbsp;to&nbsp;x**y&nbsp;mod&nbsp;m;</span><br>
<span class="lineno"></span><span class="comment" id="3786744">//&nbsp;otherwise&nbsp;it&nbsp;sets&nbsp;z&nbsp;to&nbsp;x**y.&nbsp;The&nbsp;result&nbsp;is&nbsp;the&nbsp;value&nbsp;of&nbsp;z.</span><br>
<span class="lineno">1230</span><span class="keyword" id="3786806">func</span>&nbsp;<span class="op" id="3786811">(</span><span class="ident" id="3786812">z</span>&nbsp;<span class="ident" id="3786814"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3786817">)</span>&nbsp;<span class="ident" id="3786819">expNN</span><span class="op" id="3786824">(</span><span class="ident" id="3786825">x</span><span class="op" id="3786826">,</span>&nbsp;<span class="ident" id="3786828">y</span><span class="op" id="3786829">,</span>&nbsp;<span class="ident" id="3786831">m</span>&nbsp;<span class="ident" id="3786833"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3786836">)</span>&nbsp;<span class="ident" id="3786838"><a href="/math/big/nat.go.html#3758892">nat</a></span>&nbsp;<span class="op" id="3786842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786845">if</span>&nbsp;<span class="ident" id="3786848"><a href="/math/big/nat.go.html#3764870">alias</a></span><span class="op" id="3786853">(</span><span class="ident" id="3786854"><a href="/math/big/nat.go.html#3786812">z</a></span><span class="op" id="3786855">,</span>&nbsp;<span class="ident" id="3786857"><a href="/math/big/nat.go.html#3786825">x</a></span><span class="op" id="3786858">)</span>&nbsp;<span class="op" id="3786860">||</span>&nbsp;<span class="ident" id="3786863"><a href="/math/big/nat.go.html#3764870">alias</a></span><span class="op" id="3786868">(</span><span class="ident" id="3786869"><a href="/math/big/nat.go.html#3786812">z</a></span><span class="op" id="3786870">,</span>&nbsp;<span class="ident" id="3786872"><a href="/math/big/nat.go.html#3786828">y</a></span><span class="op" id="3786873">)</span>&nbsp;<span class="op" id="3786875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3786879">//&nbsp;We&nbsp;cannot&nbsp;allow&nbsp;in-place&nbsp;modification&nbsp;of&nbsp;x&nbsp;or&nbsp;y.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3786933"><a href="/math/big/nat.go.html#3786812">z</a></span>&nbsp;<span class="op" id="3786935">=</span>&nbsp;<span class="ident" id="3786937">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3786942">}</span><br>
<span class="lineno">1235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3786946">//&nbsp;x**y&nbsp;mod&nbsp;1&nbsp;==&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786966">if</span>&nbsp;<span class="builtinfunc" id="3786969">len</span><span class="op" id="3786972">(</span><span class="ident" id="3786973"><a href="/math/big/nat.go.html#3786831">m</a></span><span class="op" id="3786974">)</span>&nbsp;<span class="op" id="3786976">==</span>&nbsp;<span class="num" id="3786979">1</span>&nbsp;<span class="op" id="3786981">&amp;&amp;</span>&nbsp;<span class="ident" id="3786984"><a href="/math/big/nat.go.html#3786831">m</a></span><span class="op" id="3786985">[</span><span class="num" id="3786986">0</span><span class="op" id="3786987">]</span>&nbsp;<span class="op" id="3786989">==</span>&nbsp;<span class="num" id="3786992">1</span>&nbsp;<span class="op" id="3786994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3786998">return</span>&nbsp;<span class="ident" id="3787005"><a href="/math/big/nat.go.html#3786812">z</a></span><span class="op" id="3787006">.</span><span class="ident" id="3787007">setWord</span><span class="op" id="3787014">(</span><span class="num" id="3787015">0</span><span class="op" id="3787016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3787019">}</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3787022">//&nbsp;m&nbsp;==&nbsp;0&nbsp;||&nbsp;m&nbsp;&gt;&nbsp;1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3787043">//&nbsp;x**0&nbsp;==&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3787057">if</span>&nbsp;<span class="builtinfunc" id="3787060">len</span><span class="op" id="3787063">(</span><span class="ident" id="3787064"><a href="/math/big/nat.go.html#3786828">y</a></span><span class="op" id="3787065">)</span>&nbsp;<span class="op" id="3787067">==</span>&nbsp;<span class="num" id="3787070">0</span>&nbsp;<span class="op" id="3787072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3787076">return</span>&nbsp;<span class="ident" id="3787083"><a href="/math/big/nat.go.html#3786812">z</a></span><span class="op" id="3787084">.</span><span class="ident" id="3787085">setWord</span><span class="op" id="3787092">(</span><span class="num" id="3787093">1</span><span class="op" id="3787094">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3787097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3787100">//&nbsp;y&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3787111">if</span>&nbsp;<span class="builtinfunc" id="3787114">len</span><span class="op" id="3787117">(</span><span class="ident" id="3787118"><a href="/math/big/nat.go.html#3786831">m</a></span><span class="op" id="3787119">)</span>&nbsp;<span class="op" id="3787121">!=</span>&nbsp;<span class="num" id="3787124">0</span>&nbsp;<span class="op" id="3787126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3787130">//&nbsp;We&nbsp;likely&nbsp;end&nbsp;up&nbsp;being&nbsp;as&nbsp;long&nbsp;as&nbsp;the&nbsp;modulus.</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3787182"><a href="/math/big/nat.go.html#3786812">z</a></span>&nbsp;<span class="op" id="3787184">=</span>&nbsp;<span class="ident" id="3787186"><a href="/math/big/nat.go.html#3786812">z</a></span><span class="op" id="3787187">.</span><span class="builtinfunc" id="3787188">make</span><span class="op" id="3787192">(</span><span class="builtinfunc" id="3787193">len</span><span class="op" id="3787196">(</span><span class="ident" id="3787197"><a href="/math/big/nat.go.html#3786831">m</a></span><span class="op" id="3787198">)</span><span class="op" id="3787199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3787202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3787205"><a href="/math/big/nat.go.html#3786812">z</a></span>&nbsp;<span class="op" id="3787207">=</span>&nbsp;<span class="ident" id="3787209"><a href="/math/big/nat.go.html#3786812">z</a></span><span class="op" id="3787210">.</span><span class="ident" id="3787211">set</span><span class="op" id="3787214">(</span><span class="ident" id="3787215"><a href="/math/big/nat.go.html#3786825">x</a></span><span class="op" id="3787216">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3787220">//&nbsp;If&nbsp;the&nbsp;base&nbsp;is&nbsp;non-trivial&nbsp;and&nbsp;the&nbsp;exponent&nbsp;is&nbsp;large,&nbsp;we&nbsp;use</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3787285">//&nbsp;4-bit,&nbsp;windowed&nbsp;exponentiation.&nbsp;This&nbsp;involves&nbsp;precomputing&nbsp;14&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3787358">//&nbsp;(x^2...x^15)&nbsp;but&nbsp;then&nbsp;reduces&nbsp;the&nbsp;number&nbsp;of&nbsp;multiply-reduces&nbsp;by&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3787428">//&nbsp;third.&nbsp;Even&nbsp;for&nbsp;a&nbsp;32-bit&nbsp;exponent,&nbsp;this&nbsp;reduces&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3787494">//&nbsp;operations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3787510">if</span>&nbsp;<span class="builtinfunc" id="3787513">len</span><span class="op" id="3787516">(</span><span class="ident" id="3787517"><a href="/math/big/nat.go.html#3786825">x</a></span><span class="op" id="3787518">)</span>&nbsp;<span class="op" id="3787520">&gt;</span>&nbsp;<span class="num" id="3787522">1</span>&nbsp;<span class="op" id="3787524">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3787527">len</span><span class="op" id="3787530">(</span><span class="ident" id="3787531"><a href="/math/big/nat.go.html#3786828">y</a></span><span class="op" id="3787532">)</span>&nbsp;<span class="op" id="3787534">&gt;</span>&nbsp;<span class="num" id="3787536">1</span>&nbsp;<span class="op" id="3787538">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3787541">len</span><span class="op" id="3787544">(</span><span class="ident" id="3787545"><a href="/math/big/nat.go.html#3786831">m</a></span><span class="op" id="3787546">)</span>&nbsp;<span class="op" id="3787548">&gt;</span>&nbsp;<span class="num" id="3787550">0</span>&nbsp;<span class="op" id="3787552">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3787556">return</span>&nbsp;<span class="ident" id="3787563"><a href="/math/big/nat.go.html#3786812">z</a></span><span class="op" id="3787564">.</span><span class="ident" id="3787565">expNNWindowed</span><span class="op" id="3787578">(</span><span class="ident" id="3787579"><a href="/math/big/nat.go.html#3786825">x</a></span><span class="op" id="3787580">,</span>&nbsp;<span class="ident" id="3787582"><a href="/math/big/nat.go.html#3786828">y</a></span><span class="op" id="3787583">,</span>&nbsp;<span class="ident" id="3787585"><a href="/math/big/nat.go.html#3786831">m</a></span><span class="op" id="3787586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3787589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3787593">v</span>&nbsp;<span class="op" id="3787595">:=</span>&nbsp;<span class="ident" id="3787598"><a href="/math/big/nat.go.html#3786828">y</a></span><span class="op" id="3787599">[</span><span class="builtinfunc" id="3787600">len</span><span class="op" id="3787603">(</span><span class="ident" id="3787604"><a href="/math/big/nat.go.html#3786828">y</a></span><span class="op" id="3787605">)</span><span class="op" id="3787606">-</span><span class="num" id="3787607">1</span><span class="op" id="3787608">]</span>&nbsp;<span class="comment" id="3787610">//&nbsp;v&nbsp;&gt;&nbsp;0&nbsp;because&nbsp;y&nbsp;is&nbsp;normalized&nbsp;and&nbsp;y&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3787654">shift</span>&nbsp;<span class="op" id="3787660">:=</span>&nbsp;<span class="ident" id="3787663"><a href="/math/big/arith.go.html#3729521">leadingZeros</a></span><span class="op" id="3787675">(</span><span class="ident" id="3787676"><a href="/math/big/nat.go.html#3787593">v</a></span><span class="op" id="3787677">)</span>&nbsp;<span class="op" id="3787679">+</span>&nbsp;<span class="num" id="3787681">1</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3787684"><a href="/math/big/nat.go.html#3787593">v</a></span>&nbsp;<span class="op" id="3787686">&lt;&lt;=</span>&nbsp;<span class="ident" id="3787690"><a href="/math/big/nat.go.html#3787654">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3787697">var</span>&nbsp;<span class="ident" id="3787701">q</span>&nbsp;<span class="ident" id="3787703"><a href="/math/big/nat.go.html#3758892">nat</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3787709">const</span>&nbsp;<span class="ident" id="3787715">mask</span>&nbsp;<span class="op" id="3787720">=</span>&nbsp;<span class="num" id="3787722">1</span>&nbsp;<span class="op" id="3787724">&lt;&lt;</span>&nbsp;<span class="op" id="3787727">(</span><span class="ident" id="3787728"><a href="/math/big/arith.go.html#3727893">_W</a></span>&nbsp;<span class="op" id="3787731">-</span>&nbsp;<span class="num" id="3787733">1</span><span class="op" id="3787734">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3787738">//&nbsp;We&nbsp;walk&nbsp;through&nbsp;the&nbsp;bits&nbsp;of&nbsp;the&nbsp;exponent&nbsp;one&nbsp;by&nbsp;one.&nbsp;Each&nbsp;time&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3787808">//&nbsp;see&nbsp;a&nbsp;bit,&nbsp;we&nbsp;square,&nbsp;thus&nbsp;doubling&nbsp;the&nbsp;power.&nbsp;If&nbsp;the&nbsp;bit&nbsp;is&nbsp;a&nbsp;one,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3787880">//&nbsp;we&nbsp;also&nbsp;multiply&nbsp;by&nbsp;x,&nbsp;thus&nbsp;adding&nbsp;one&nbsp;to&nbsp;the&nbsp;power.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3787938">w</span>&nbsp;<span class="op" id="3787940">:=</span>&nbsp;<span class="ident" id="3787943"><a href="/math/big/arith.go.html#3727893">_W</a></span>&nbsp;<span class="op" id="3787946">-</span>&nbsp;<span class="builtintype" id="3787948">int</span><span class="op" id="3787951">(</span><span class="ident" id="3787952"><a href="/math/big/nat.go.html#3787654">shift</a></span><span class="op" id="3787957">)</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3787960">//&nbsp;zz&nbsp;and&nbsp;r&nbsp;are&nbsp;used&nbsp;to&nbsp;avoid&nbsp;allocating&nbsp;in&nbsp;mul&nbsp;and&nbsp;div&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3788020">//&nbsp;otherwise&nbsp;the&nbsp;arguments&nbsp;would&nbsp;alias.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3788061">var</span>&nbsp;<span class="ident" id="3788065">zz</span><span class="op" id="3788067">,</span>&nbsp;<span class="ident" id="3788069">r</span>&nbsp;<span class="ident" id="3788071"><a href="/math/big/nat.go.html#3758892">nat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3788076">for</span>&nbsp;<span class="ident" id="3788080">j</span>&nbsp;<span class="op" id="3788082">:=</span>&nbsp;<span class="num" id="3788085">0</span><span class="op" id="3788086">;</span>&nbsp;<span class="ident" id="3788088"><a href="/math/big/nat.go.html#3788080">j</a></span>&nbsp;<span class="op" id="3788090">&lt;</span>&nbsp;<span class="ident" id="3788092"><a href="/math/big/nat.go.html#3787938">w</a></span><span class="op" id="3788093">;</span>&nbsp;<span class="ident" id="3788095"><a href="/math/big/nat.go.html#3788080">j</a></span><span class="op" id="3788096">++</span>&nbsp;<span class="op" id="3788099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3788103"><a href="/math/big/nat.go.html#3788065">zz</a></span>&nbsp;<span class="op" id="3788106">=</span>&nbsp;<span class="ident" id="3788108"><a href="/math/big/nat.go.html#3788065">zz</a></span><span class="op" id="3788110">.</span><span class="ident" id="3788111">mul</span><span class="op" id="3788114">(</span><span class="ident" id="3788115"><a href="/math/big/nat.go.html#3786812">z</a></span><span class="op" id="3788116">,</span>&nbsp;<span class="ident" id="3788118"><a href="/math/big/nat.go.html#3786812">z</a></span><span class="op" id="3788119">)</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3788123"><a href="/math/big/nat.go.html#3788065">zz</a></span><span class="op" id="3788125">,</span>&nbsp;<span class="ident" id="3788127"><a href="/math/big/nat.go.html#3786812">z</a></span>&nbsp;<span class="op" id="3788129">=</span>&nbsp;<span class="ident" id="3788131"><a href="/math/big/nat.go.html#3786812">z</a></span><span class="op" id="3788132">,</span>&nbsp;<span class="ident" id="3788134"><a href="/math/big/nat.go.html#3788065">zz</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3788140">if</span>&nbsp;<span class="ident" id="3788143"><a href="/math/big/nat.go.html#3787593">v</a></span><span class="op" id="3788144">&amp;</span><span class="ident" id="3788145"><a href="/math/big/nat.go.html#3787715">mask</a></span>&nbsp;<span class="op" id="3788150">!=</span>&nbsp;<span class="num" id="3788153">0</span>&nbsp;<span class="op" id="3788155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3788160"><a href="/math/big/nat.go.html#3788065">zz</a></span>&nbsp;<span class="op" id="3788163">=</span>&nbsp;<span class="ident" id="3788165"><a href="/math/big/nat.go.html#3788065">zz</a></span><span class="op" id="3788167">.</span><span class="ident" id="3788168">mul</span><span class="op" id="3788171">(</span><span class="ident" id="3788172"><a href="/math/big/nat.go.html#3786812">z</a></span><span class="op" id="3788173">,</span>&nbsp;<span class="ident" id="3788175"><a href="/math/big/nat.go.html#3786825">x</a></span><span class="op" id="3788176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3788181"><a href="/math/big/nat.go.html#3788065">zz</a></span><span class="op" id="3788183">,</span>&nbsp;<span class="ident" id="3788185"><a href="/math/big/nat.go.html#3786812">z</a></span>&nbsp;<span class="op" id="3788187">=</span>&nbsp;<span class="ident" id="3788189"><a href="/math/big/nat.go.html#3786812">z</a></span><span class="op" id="3788190">,</span>&nbsp;<span class="ident" id="3788192"><a href="/math/big/nat.go.html#3788065">zz</a></span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3788197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3788202">if</span>&nbsp;<span class="builtinfunc" id="3788205">len</span><span class="op" id="3788208">(</span><span class="ident" id="3788209"><a href="/math/big/nat.go.html#3786831">m</a></span><span class="op" id="3788210">)</span>&nbsp;<span class="op" id="3788212">!=</span>&nbsp;<span class="num" id="3788215">0</span>&nbsp;<span class="op" id="3788217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3788222"><a href="/math/big/nat.go.html#3788065">zz</a></span><span class="op" id="3788224">,</span>&nbsp;<span class="ident" id="3788226"><a href="/math/big/nat.go.html#3788069">r</a></span>&nbsp;<span class="op" id="3788228">=</span>&nbsp;<span class="ident" id="3788230"><a href="/math/big/nat.go.html#3788065">zz</a></span><span class="op" id="3788232">.</span><span class="ident" id="3788233">div</span><span class="op" id="3788236">(</span><span class="ident" id="3788237"><a href="/math/big/nat.go.html#3788069">r</a></span><span class="op" id="3788238">,</span>&nbsp;<span class="ident" id="3788240"><a href="/math/big/nat.go.html#3786812">z</a></span><span class="op" id="3788241">,</span>&nbsp;<span class="ident" id="3788243"><a href="/math/big/nat.go.html#3786831">m</a></span><span class="op" id="3788244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3788249"><a href="/math/big/nat.go.html#3788065">zz</a></span><span class="op" id="3788251">,</span>&nbsp;<span class="ident" id="3788253"><a href="/math/big/nat.go.html#3788069">r</a></span><span class="op" id="3788254">,</span>&nbsp;<span class="ident" id="3788256"><a href="/math/big/nat.go.html#3787701">q</a></span><span class="op" id="3788257">,</span>&nbsp;<span class="ident" id="3788259"><a href="/math/big/nat.go.html#3786812">z</a></span>&nbsp;<span class="op" id="3788261">=</span>&nbsp;<span class="ident" id="3788263"><a href="/math/big/nat.go.html#3787701">q</a></span><span class="op" id="3788264">,</span>&nbsp;<span class="ident" id="3788266"><a href="/math/big/nat.go.html#3786812">z</a></span><span class="op" id="3788267">,</span>&nbsp;<span class="ident" id="3788269"><a href="/math/big/nat.go.html#3788065">zz</a></span><span class="op" id="3788271">,</span>&nbsp;<span class="ident" id="3788273"><a href="/math/big/nat.go.html#3788069">r</a></span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3788277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3788282"><a href="/math/big/nat.go.html#3787593">v</a></span>&nbsp;<span class="op" id="3788284">&lt;&lt;=</span>&nbsp;<span class="num" id="3788288">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3788291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3788295">for</span>&nbsp;<span class="ident" id="3788299">i</span>&nbsp;<span class="op" id="3788301">:=</span>&nbsp;<span class="builtinfunc" id="3788304">len</span><span class="op" id="3788307">(</span><span class="ident" id="3788308"><a href="/math/big/nat.go.html#3786828">y</a></span><span class="op" id="3788309">)</span>&nbsp;<span class="op" id="3788311">-</span>&nbsp;<span class="num" id="3788313">2</span><span class="op" id="3788314">;</span>&nbsp;<span class="ident" id="3788316"><a href="/math/big/nat.go.html#3788299">i</a></span>&nbsp;<span class="op" id="3788318">&gt;=</span>&nbsp;<span class="num" id="3788321">0</span><span class="op" id="3788322">;</span>&nbsp;<span class="ident" id="3788324"><a href="/math/big/nat.go.html#3788299">i</a></span><span class="op" id="3788325">--</span>&nbsp;<span class="op" id="3788328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3788332"><a href="/math/big/nat.go.html#3787593">v</a></span>&nbsp;<span class="op" id="3788334">=</span>&nbsp;<span class="ident" id="3788336"><a href="/math/big/nat.go.html#3786828">y</a></span><span class="op" id="3788337">[</span><span class="ident" id="3788338"><a href="/math/big/nat.go.html#3788299">i</a></span><span class="op" id="3788339">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3788344">for</span>&nbsp;<span class="ident" id="3788348">j</span>&nbsp;<span class="op" id="3788350">:=</span>&nbsp;<span class="num" id="3788353">0</span><span class="op" id="3788354">;</span>&nbsp;<span class="ident" id="3788356"><a href="/math/big/nat.go.html#3788348">j</a></span>&nbsp;<span class="op" id="3788358">&lt;</span>&nbsp;<span class="ident" id="3788360"><a href="/math/big/arith.go.html#3727893">_W</a></span><span class="op" id="3788362">;</span>&nbsp;<span class="ident" id="3788364"><a href="/math/big/nat.go.html#3788348">j</a></span><span class="op" id="3788365">++</span>&nbsp;<span class="op" id="3788368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3788373"><a href="/math/big/nat.go.html#3788065">zz</a></span>&nbsp;<span class="op" id="3788376">=</span>&nbsp;<span class="ident" id="3788378"><a href="/math/big/nat.go.html#3788065">zz</a></span><span class="op" id="3788380">.</span><span class="ident" id="3788381">mul</span><span class="op" id="3788384">(</span><span class="ident" id="3788385"><a href="/math/big/nat.go.html#3786812">z</a></span><span class="op" id="3788386">,</span>&nbsp;<span class="ident" id="3788388"><a href="/math/big/nat.go.html#3786812">z</a></span><span class="op" id="3788389">)</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3788394"><a href="/math/big/nat.go.html#3788065">zz</a></span><span class="op" id="3788396">,</span>&nbsp;<span class="ident" id="3788398"><a href="/math/big/nat.go.html#3786812">z</a></span>&nbsp;<span class="op" id="3788400">=</span>&nbsp;<span class="ident" id="3788402"><a href="/math/big/nat.go.html#3786812">z</a></span><span class="op" id="3788403">,</span>&nbsp;<span class="ident" id="3788405"><a href="/math/big/nat.go.html#3788065">zz</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3788412">if</span>&nbsp;<span class="ident" id="3788415"><a href="/math/big/nat.go.html#3787593">v</a></span><span class="op" id="3788416">&amp;</span><span class="ident" id="3788417"><a href="/math/big/nat.go.html#3787715">mask</a></span>&nbsp;<span class="op" id="3788422">!=</span>&nbsp;<span class="num" id="3788425">0</span>&nbsp;<span class="op" id="3788427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3788433"><a href="/math/big/nat.go.html#3788065">zz</a></span>&nbsp;<span class="op" id="3788436">=</span>&nbsp;<span class="ident" id="3788438"><a href="/math/big/nat.go.html#3788065">zz</a></span><span class="op" id="3788440">.</span><span class="ident" id="3788441">mul</span><span class="op" id="3788444">(</span><span class="ident" id="3788445"><a href="/math/big/nat.go.html#3786812">z</a></span><span class="op" id="3788446">,</span>&nbsp;<span class="ident" id="3788448"><a href="/math/big/nat.go.html#3786825">x</a></span><span class="op" id="3788449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3788455"><a href="/math/big/nat.go.html#3788065">zz</a></span><span class="op" id="3788457">,</span>&nbsp;<span class="ident" id="3788459"><a href="/math/big/nat.go.html#3786812">z</a></span>&nbsp;<span class="op" id="3788461">=</span>&nbsp;<span class="ident" id="3788463"><a href="/math/big/nat.go.html#3786812">z</a></span><span class="op" id="3788464">,</span>&nbsp;<span class="ident" id="3788466"><a href="/math/big/nat.go.html#3788065">zz</a></span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3788472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3788478">if</span>&nbsp;<span class="builtinfunc" id="3788481">len</span><span class="op" id="3788484">(</span><span class="ident" id="3788485"><a href="/math/big/nat.go.html#3786831">m</a></span><span class="op" id="3788486">)</span>&nbsp;<span class="op" id="3788488">!=</span>&nbsp;<span class="num" id="3788491">0</span>&nbsp;<span class="op" id="3788493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3788499"><a href="/math/big/nat.go.html#3788065">zz</a></span><span class="op" id="3788501">,</span>&nbsp;<span class="ident" id="3788503"><a href="/math/big/nat.go.html#3788069">r</a></span>&nbsp;<span class="op" id="3788505">=</span>&nbsp;<span class="ident" id="3788507"><a href="/math/big/nat.go.html#3788065">zz</a></span><span class="op" id="3788509">.</span><span class="ident" id="3788510">div</span><span class="op" id="3788513">(</span><span class="ident" id="3788514"><a href="/math/big/nat.go.html#3788069">r</a></span><span class="op" id="3788515">,</span>&nbsp;<span class="ident" id="3788517"><a href="/math/big/nat.go.html#3786812">z</a></span><span class="op" id="3788518">,</span>&nbsp;<span class="ident" id="3788520"><a href="/math/big/nat.go.html#3786831">m</a></span><span class="op" id="3788521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3788527"><a href="/math/big/nat.go.html#3788065">zz</a></span><span class="op" id="3788529">,</span>&nbsp;<span class="ident" id="3788531"><a href="/math/big/nat.go.html#3788069">r</a></span><span class="op" id="3788532">,</span>&nbsp;<span class="ident" id="3788534"><a href="/math/big/nat.go.html#3787701">q</a></span><span class="op" id="3788535">,</span>&nbsp;<span class="ident" id="3788537"><a href="/math/big/nat.go.html#3786812">z</a></span>&nbsp;<span class="op" id="3788539">=</span>&nbsp;<span class="ident" id="3788541"><a href="/math/big/nat.go.html#3787701">q</a></span><span class="op" id="3788542">,</span>&nbsp;<span class="ident" id="3788544"><a href="/math/big/nat.go.html#3786812">z</a></span><span class="op" id="3788545">,</span>&nbsp;<span class="ident" id="3788547"><a href="/math/big/nat.go.html#3788065">zz</a></span><span class="op" id="3788549">,</span>&nbsp;<span class="ident" id="3788551"><a href="/math/big/nat.go.html#3788069">r</a></span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3788556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3788562"><a href="/math/big/nat.go.html#3787593">v</a></span>&nbsp;<span class="op" id="3788564">&lt;&lt;=</span>&nbsp;<span class="num" id="3788568">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3788572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3788575">}</span><br>
<span class="lineno">1315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3788579">return</span>&nbsp;<span class="ident" id="3788586"><a href="/math/big/nat.go.html#3786812">z</a></span><span class="op" id="3788587">.</span><span class="ident" id="3788588">norm</span><span class="op" id="3788592">(</span><span class="op" id="3788593">)</span><br>
<span class="lineno"></span><span class="op" id="3788595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3788598">//&nbsp;expNNWindowed&nbsp;calculates&nbsp;x**y&nbsp;mod&nbsp;m&nbsp;using&nbsp;a&nbsp;fixed,&nbsp;4-bit&nbsp;window.</span><br>
<span class="lineno">1320</span><span class="keyword" id="3788666">func</span>&nbsp;<span class="op" id="3788671">(</span><span class="ident" id="3788672">z</span>&nbsp;<span class="ident" id="3788674"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3788677">)</span>&nbsp;<span class="ident" id="3788679">expNNWindowed</span><span class="op" id="3788692">(</span><span class="ident" id="3788693">x</span><span class="op" id="3788694">,</span>&nbsp;<span class="ident" id="3788696">y</span><span class="op" id="3788697">,</span>&nbsp;<span class="ident" id="3788699">m</span>&nbsp;<span class="ident" id="3788701"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3788704">)</span>&nbsp;<span class="ident" id="3788706"><a href="/math/big/nat.go.html#3758892">nat</a></span>&nbsp;<span class="op" id="3788710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3788713">//&nbsp;zz&nbsp;and&nbsp;r&nbsp;are&nbsp;used&nbsp;to&nbsp;avoid&nbsp;allocating&nbsp;in&nbsp;mul&nbsp;and&nbsp;div&nbsp;as&nbsp;otherwise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3788783">//&nbsp;the&nbsp;arguments&nbsp;would&nbsp;alias.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3788814">var</span>&nbsp;<span class="ident" id="3788818">zz</span><span class="op" id="3788820">,</span>&nbsp;<span class="ident" id="3788822">r</span>&nbsp;<span class="ident" id="3788824"><a href="/math/big/nat.go.html#3758892">nat</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3788830">const</span>&nbsp;<span class="ident" id="3788836">n</span>&nbsp;<span class="op" id="3788838">=</span>&nbsp;<span class="num" id="3788840">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3788843">//&nbsp;powers[i]&nbsp;contains&nbsp;x^i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3788871">var</span>&nbsp;<span class="ident" id="3788875">powers</span>&nbsp;<span class="op" id="3788882">[</span><span class="num" id="3788883">1</span>&nbsp;<span class="op" id="3788885">&lt;&lt;</span>&nbsp;<span class="ident" id="3788888"><a href="/math/big/nat.go.html#3788836">n</a></span><span class="op" id="3788889">]</span><span class="ident" id="3788890"><a href="/math/big/nat.go.html#3758892">nat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3788895"><a href="/math/big/nat.go.html#3788875">powers</a></span><span class="op" id="3788901">[</span><span class="num" id="3788902">0</span><span class="op" id="3788903">]</span>&nbsp;<span class="op" id="3788905">=</span>&nbsp;<span class="ident" id="3788907"><a href="/math/big/nat.go.html#3758911">natOne</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3788915"><a href="/math/big/nat.go.html#3788875">powers</a></span><span class="op" id="3788921">[</span><span class="num" id="3788922">1</span><span class="op" id="3788923">]</span>&nbsp;<span class="op" id="3788925">=</span>&nbsp;<span class="ident" id="3788927"><a href="/math/big/nat.go.html#3788693">x</a></span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3788930">for</span>&nbsp;<span class="ident" id="3788934">i</span>&nbsp;<span class="op" id="3788936">:=</span>&nbsp;<span class="num" id="3788939">2</span><span class="op" id="3788940">;</span>&nbsp;<span class="ident" id="3788942"><a href="/math/big/nat.go.html#3788934">i</a></span>&nbsp;<span class="op" id="3788944">&lt;</span>&nbsp;<span class="num" id="3788946">1</span><span class="op" id="3788947">&lt;&lt;</span><span class="ident" id="3788949"><a href="/math/big/nat.go.html#3788836">n</a></span><span class="op" id="3788950">;</span>&nbsp;<span class="ident" id="3788952"><a href="/math/big/nat.go.html#3788934">i</a></span>&nbsp;<span class="op" id="3788954">+=</span>&nbsp;<span class="num" id="3788957">2</span>&nbsp;<span class="op" id="3788959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3788963">p2</span><span class="op" id="3788965">,</span>&nbsp;<span class="ident" id="3788967">p</span><span class="op" id="3788968">,</span>&nbsp;<span class="ident" id="3788970">p1</span>&nbsp;<span class="op" id="3788973">:=</span>&nbsp;<span class="op" id="3788976">&amp;</span><span class="ident" id="3788977"><a href="/math/big/nat.go.html#3788875">powers</a></span><span class="op" id="3788983">[</span><span class="ident" id="3788984"><a href="/math/big/nat.go.html#3788934">i</a></span><span class="op" id="3788985">/</span><span class="num" id="3788986">2</span><span class="op" id="3788987">]</span><span class="op" id="3788988">,</span>&nbsp;<span class="op" id="3788990">&amp;</span><span class="ident" id="3788991"><a href="/math/big/nat.go.html#3788875">powers</a></span><span class="op" id="3788997">[</span><span class="ident" id="3788998"><a href="/math/big/nat.go.html#3788934">i</a></span><span class="op" id="3788999">]</span><span class="op" id="3789000">,</span>&nbsp;<span class="op" id="3789002">&amp;</span><span class="ident" id="3789003"><a href="/math/big/nat.go.html#3788875">powers</a></span><span class="op" id="3789009">[</span><span class="ident" id="3789010"><a href="/math/big/nat.go.html#3788934">i</a></span><span class="op" id="3789011">+</span><span class="num" id="3789012">1</span><span class="op" id="3789013">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3789017">*</span><span class="ident" id="3789018"><a href="/math/big/nat.go.html#3788967">p</a></span>&nbsp;<span class="op" id="3789020">=</span>&nbsp;<span class="ident" id="3789022"><a href="/math/big/nat.go.html#3788967">p</a></span><span class="op" id="3789023">.</span><span class="ident" id="3789024">mul</span><span class="op" id="3789027">(</span><span class="op" id="3789028">*</span><span class="ident" id="3789029"><a href="/math/big/nat.go.html#3788963">p2</a></span><span class="op" id="3789031">,</span>&nbsp;<span class="op" id="3789033">*</span><span class="ident" id="3789034"><a href="/math/big/nat.go.html#3788963">p2</a></span><span class="op" id="3789036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789040"><a href="/math/big/nat.go.html#3788818">zz</a></span><span class="op" id="3789042">,</span>&nbsp;<span class="ident" id="3789044"><a href="/math/big/nat.go.html#3788822">r</a></span>&nbsp;<span class="op" id="3789046">=</span>&nbsp;<span class="ident" id="3789048"><a href="/math/big/nat.go.html#3788818">zz</a></span><span class="op" id="3789050">.</span><span class="ident" id="3789051">div</span><span class="op" id="3789054">(</span><span class="ident" id="3789055"><a href="/math/big/nat.go.html#3788822">r</a></span><span class="op" id="3789056">,</span>&nbsp;<span class="op" id="3789058">*</span><span class="ident" id="3789059"><a href="/math/big/nat.go.html#3788967">p</a></span><span class="op" id="3789060">,</span>&nbsp;<span class="ident" id="3789062"><a href="/math/big/nat.go.html#3788699">m</a></span><span class="op" id="3789063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3789067">*</span><span class="ident" id="3789068"><a href="/math/big/nat.go.html#3788967">p</a></span><span class="op" id="3789069">,</span>&nbsp;<span class="ident" id="3789071"><a href="/math/big/nat.go.html#3788822">r</a></span>&nbsp;<span class="op" id="3789073">=</span>&nbsp;<span class="ident" id="3789075"><a href="/math/big/nat.go.html#3788822">r</a></span><span class="op" id="3789076">,</span>&nbsp;<span class="op" id="3789078">*</span><span class="ident" id="3789079"><a href="/math/big/nat.go.html#3788967">p</a></span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3789083">*</span><span class="ident" id="3789084"><a href="/math/big/nat.go.html#3788970">p1</a></span>&nbsp;<span class="op" id="3789087">=</span>&nbsp;<span class="ident" id="3789089"><a href="/math/big/nat.go.html#3788970">p1</a></span><span class="op" id="3789091">.</span><span class="ident" id="3789092">mul</span><span class="op" id="3789095">(</span><span class="op" id="3789096">*</span><span class="ident" id="3789097"><a href="/math/big/nat.go.html#3788967">p</a></span><span class="op" id="3789098">,</span>&nbsp;<span class="ident" id="3789100"><a href="/math/big/nat.go.html#3788693">x</a></span><span class="op" id="3789101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789105"><a href="/math/big/nat.go.html#3788818">zz</a></span><span class="op" id="3789107">,</span>&nbsp;<span class="ident" id="3789109"><a href="/math/big/nat.go.html#3788822">r</a></span>&nbsp;<span class="op" id="3789111">=</span>&nbsp;<span class="ident" id="3789113"><a href="/math/big/nat.go.html#3788818">zz</a></span><span class="op" id="3789115">.</span><span class="ident" id="3789116">div</span><span class="op" id="3789119">(</span><span class="ident" id="3789120"><a href="/math/big/nat.go.html#3788822">r</a></span><span class="op" id="3789121">,</span>&nbsp;<span class="op" id="3789123">*</span><span class="ident" id="3789124"><a href="/math/big/nat.go.html#3788970">p1</a></span><span class="op" id="3789126">,</span>&nbsp;<span class="ident" id="3789128"><a href="/math/big/nat.go.html#3788699">m</a></span><span class="op" id="3789129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3789133">*</span><span class="ident" id="3789134"><a href="/math/big/nat.go.html#3788970">p1</a></span><span class="op" id="3789136">,</span>&nbsp;<span class="ident" id="3789138"><a href="/math/big/nat.go.html#3788822">r</a></span>&nbsp;<span class="op" id="3789140">=</span>&nbsp;<span class="ident" id="3789142"><a href="/math/big/nat.go.html#3788822">r</a></span><span class="op" id="3789143">,</span>&nbsp;<span class="op" id="3789145">*</span><span class="ident" id="3789146"><a href="/math/big/nat.go.html#3788970">p1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3789150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789154"><a href="/math/big/nat.go.html#3788672">z</a></span>&nbsp;<span class="op" id="3789156">=</span>&nbsp;<span class="ident" id="3789158"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789159">.</span><span class="ident" id="3789160">setWord</span><span class="op" id="3789167">(</span><span class="num" id="3789168">1</span><span class="op" id="3789169">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3789173">for</span>&nbsp;<span class="ident" id="3789177">i</span>&nbsp;<span class="op" id="3789179">:=</span>&nbsp;<span class="builtinfunc" id="3789182">len</span><span class="op" id="3789185">(</span><span class="ident" id="3789186"><a href="/math/big/nat.go.html#3788696">y</a></span><span class="op" id="3789187">)</span>&nbsp;<span class="op" id="3789189">-</span>&nbsp;<span class="num" id="3789191">1</span><span class="op" id="3789192">;</span>&nbsp;<span class="ident" id="3789194"><a href="/math/big/nat.go.html#3789177">i</a></span>&nbsp;<span class="op" id="3789196">&gt;=</span>&nbsp;<span class="num" id="3789199">0</span><span class="op" id="3789200">;</span>&nbsp;<span class="ident" id="3789202"><a href="/math/big/nat.go.html#3789177">i</a></span><span class="op" id="3789203">--</span>&nbsp;<span class="op" id="3789206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789210">yi</span>&nbsp;<span class="op" id="3789213">:=</span>&nbsp;<span class="ident" id="3789216"><a href="/math/big/nat.go.html#3788696">y</a></span><span class="op" id="3789217">[</span><span class="ident" id="3789218"><a href="/math/big/nat.go.html#3789177">i</a></span><span class="op" id="3789219">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3789223">for</span>&nbsp;<span class="ident" id="3789227">j</span>&nbsp;<span class="op" id="3789229">:=</span>&nbsp;<span class="num" id="3789232">0</span><span class="op" id="3789233">;</span>&nbsp;<span class="ident" id="3789235"><a href="/math/big/nat.go.html#3789227">j</a></span>&nbsp;<span class="op" id="3789237">&lt;</span>&nbsp;<span class="ident" id="3789239"><a href="/math/big/arith.go.html#3727893">_W</a></span><span class="op" id="3789241">;</span>&nbsp;<span class="ident" id="3789243"><a href="/math/big/nat.go.html#3789227">j</a></span>&nbsp;<span class="op" id="3789245">+=</span>&nbsp;<span class="ident" id="3789248"><a href="/math/big/nat.go.html#3788836">n</a></span>&nbsp;<span class="op" id="3789250">{</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3789255">if</span>&nbsp;<span class="ident" id="3789258"><a href="/math/big/nat.go.html#3789177">i</a></span>&nbsp;<span class="op" id="3789260">!=</span>&nbsp;<span class="builtinfunc" id="3789263">len</span><span class="op" id="3789266">(</span><span class="ident" id="3789267"><a href="/math/big/nat.go.html#3788696">y</a></span><span class="op" id="3789268">)</span><span class="op" id="3789269">-</span><span class="num" id="3789270">1</span>&nbsp;<span class="op" id="3789272">||</span>&nbsp;<span class="ident" id="3789275"><a href="/math/big/nat.go.html#3789227">j</a></span>&nbsp;<span class="op" id="3789277">!=</span>&nbsp;<span class="num" id="3789280">0</span>&nbsp;<span class="op" id="3789282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3789288">//&nbsp;Unrolled&nbsp;loop&nbsp;for&nbsp;significant&nbsp;performance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3789337">//&nbsp;gain.&nbsp;&nbsp;Use&nbsp;go&nbsp;test&nbsp;-bench=&#34;.*&#34;&nbsp;in&nbsp;crypto/rsa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3789389">//&nbsp;to&nbsp;check&nbsp;performance&nbsp;before&nbsp;making&nbsp;changes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789440"><a href="/math/big/nat.go.html#3788818">zz</a></span>&nbsp;<span class="op" id="3789443">=</span>&nbsp;<span class="ident" id="3789445"><a href="/math/big/nat.go.html#3788818">zz</a></span><span class="op" id="3789447">.</span><span class="ident" id="3789448">mul</span><span class="op" id="3789451">(</span><span class="ident" id="3789452"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789453">,</span>&nbsp;<span class="ident" id="3789455"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789456">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789462"><a href="/math/big/nat.go.html#3788818">zz</a></span><span class="op" id="3789464">,</span>&nbsp;<span class="ident" id="3789466"><a href="/math/big/nat.go.html#3788672">z</a></span>&nbsp;<span class="op" id="3789468">=</span>&nbsp;<span class="ident" id="3789470"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789471">,</span>&nbsp;<span class="ident" id="3789473"><a href="/math/big/nat.go.html#3788818">zz</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789480"><a href="/math/big/nat.go.html#3788818">zz</a></span><span class="op" id="3789482">,</span>&nbsp;<span class="ident" id="3789484"><a href="/math/big/nat.go.html#3788822">r</a></span>&nbsp;<span class="op" id="3789486">=</span>&nbsp;<span class="ident" id="3789488"><a href="/math/big/nat.go.html#3788818">zz</a></span><span class="op" id="3789490">.</span><span class="ident" id="3789491">div</span><span class="op" id="3789494">(</span><span class="ident" id="3789495"><a href="/math/big/nat.go.html#3788822">r</a></span><span class="op" id="3789496">,</span>&nbsp;<span class="ident" id="3789498"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789499">,</span>&nbsp;<span class="ident" id="3789501"><a href="/math/big/nat.go.html#3788699">m</a></span><span class="op" id="3789502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789508"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789509">,</span>&nbsp;<span class="ident" id="3789511"><a href="/math/big/nat.go.html#3788822">r</a></span>&nbsp;<span class="op" id="3789513">=</span>&nbsp;<span class="ident" id="3789515"><a href="/math/big/nat.go.html#3788822">r</a></span><span class="op" id="3789516">,</span>&nbsp;<span class="ident" id="3789518"><a href="/math/big/nat.go.html#3788672">z</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789525"><a href="/math/big/nat.go.html#3788818">zz</a></span>&nbsp;<span class="op" id="3789528">=</span>&nbsp;<span class="ident" id="3789530"><a href="/math/big/nat.go.html#3788818">zz</a></span><span class="op" id="3789532">.</span><span class="ident" id="3789533">mul</span><span class="op" id="3789536">(</span><span class="ident" id="3789537"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789538">,</span>&nbsp;<span class="ident" id="3789540"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789541">)</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789547"><a href="/math/big/nat.go.html#3788818">zz</a></span><span class="op" id="3789549">,</span>&nbsp;<span class="ident" id="3789551"><a href="/math/big/nat.go.html#3788672">z</a></span>&nbsp;<span class="op" id="3789553">=</span>&nbsp;<span class="ident" id="3789555"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789556">,</span>&nbsp;<span class="ident" id="3789558"><a href="/math/big/nat.go.html#3788818">zz</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789565"><a href="/math/big/nat.go.html#3788818">zz</a></span><span class="op" id="3789567">,</span>&nbsp;<span class="ident" id="3789569"><a href="/math/big/nat.go.html#3788822">r</a></span>&nbsp;<span class="op" id="3789571">=</span>&nbsp;<span class="ident" id="3789573"><a href="/math/big/nat.go.html#3788818">zz</a></span><span class="op" id="3789575">.</span><span class="ident" id="3789576">div</span><span class="op" id="3789579">(</span><span class="ident" id="3789580"><a href="/math/big/nat.go.html#3788822">r</a></span><span class="op" id="3789581">,</span>&nbsp;<span class="ident" id="3789583"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789584">,</span>&nbsp;<span class="ident" id="3789586"><a href="/math/big/nat.go.html#3788699">m</a></span><span class="op" id="3789587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789593"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789594">,</span>&nbsp;<span class="ident" id="3789596"><a href="/math/big/nat.go.html#3788822">r</a></span>&nbsp;<span class="op" id="3789598">=</span>&nbsp;<span class="ident" id="3789600"><a href="/math/big/nat.go.html#3788822">r</a></span><span class="op" id="3789601">,</span>&nbsp;<span class="ident" id="3789603"><a href="/math/big/nat.go.html#3788672">z</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789610"><a href="/math/big/nat.go.html#3788818">zz</a></span>&nbsp;<span class="op" id="3789613">=</span>&nbsp;<span class="ident" id="3789615"><a href="/math/big/nat.go.html#3788818">zz</a></span><span class="op" id="3789617">.</span><span class="ident" id="3789618">mul</span><span class="op" id="3789621">(</span><span class="ident" id="3789622"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789623">,</span>&nbsp;<span class="ident" id="3789625"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789626">)</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789632"><a href="/math/big/nat.go.html#3788818">zz</a></span><span class="op" id="3789634">,</span>&nbsp;<span class="ident" id="3789636"><a href="/math/big/nat.go.html#3788672">z</a></span>&nbsp;<span class="op" id="3789638">=</span>&nbsp;<span class="ident" id="3789640"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789641">,</span>&nbsp;<span class="ident" id="3789643"><a href="/math/big/nat.go.html#3788818">zz</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789650"><a href="/math/big/nat.go.html#3788818">zz</a></span><span class="op" id="3789652">,</span>&nbsp;<span class="ident" id="3789654"><a href="/math/big/nat.go.html#3788822">r</a></span>&nbsp;<span class="op" id="3789656">=</span>&nbsp;<span class="ident" id="3789658"><a href="/math/big/nat.go.html#3788818">zz</a></span><span class="op" id="3789660">.</span><span class="ident" id="3789661">div</span><span class="op" id="3789664">(</span><span class="ident" id="3789665"><a href="/math/big/nat.go.html#3788822">r</a></span><span class="op" id="3789666">,</span>&nbsp;<span class="ident" id="3789668"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789669">,</span>&nbsp;<span class="ident" id="3789671"><a href="/math/big/nat.go.html#3788699">m</a></span><span class="op" id="3789672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789678"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789679">,</span>&nbsp;<span class="ident" id="3789681"><a href="/math/big/nat.go.html#3788822">r</a></span>&nbsp;<span class="op" id="3789683">=</span>&nbsp;<span class="ident" id="3789685"><a href="/math/big/nat.go.html#3788822">r</a></span><span class="op" id="3789686">,</span>&nbsp;<span class="ident" id="3789688"><a href="/math/big/nat.go.html#3788672">z</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789695"><a href="/math/big/nat.go.html#3788818">zz</a></span>&nbsp;<span class="op" id="3789698">=</span>&nbsp;<span class="ident" id="3789700"><a href="/math/big/nat.go.html#3788818">zz</a></span><span class="op" id="3789702">.</span><span class="ident" id="3789703">mul</span><span class="op" id="3789706">(</span><span class="ident" id="3789707"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789708">,</span>&nbsp;<span class="ident" id="3789710"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789711">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789717"><a href="/math/big/nat.go.html#3788818">zz</a></span><span class="op" id="3789719">,</span>&nbsp;<span class="ident" id="3789721"><a href="/math/big/nat.go.html#3788672">z</a></span>&nbsp;<span class="op" id="3789723">=</span>&nbsp;<span class="ident" id="3789725"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789726">,</span>&nbsp;<span class="ident" id="3789728"><a href="/math/big/nat.go.html#3788818">zz</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789735"><a href="/math/big/nat.go.html#3788818">zz</a></span><span class="op" id="3789737">,</span>&nbsp;<span class="ident" id="3789739"><a href="/math/big/nat.go.html#3788822">r</a></span>&nbsp;<span class="op" id="3789741">=</span>&nbsp;<span class="ident" id="3789743"><a href="/math/big/nat.go.html#3788818">zz</a></span><span class="op" id="3789745">.</span><span class="ident" id="3789746">div</span><span class="op" id="3789749">(</span><span class="ident" id="3789750"><a href="/math/big/nat.go.html#3788822">r</a></span><span class="op" id="3789751">,</span>&nbsp;<span class="ident" id="3789753"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789754">,</span>&nbsp;<span class="ident" id="3789756"><a href="/math/big/nat.go.html#3788699">m</a></span><span class="op" id="3789757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789763"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789764">,</span>&nbsp;<span class="ident" id="3789766"><a href="/math/big/nat.go.html#3788822">r</a></span>&nbsp;<span class="op" id="3789768">=</span>&nbsp;<span class="ident" id="3789770"><a href="/math/big/nat.go.html#3788822">r</a></span><span class="op" id="3789771">,</span>&nbsp;<span class="ident" id="3789773"><a href="/math/big/nat.go.html#3788672">z</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3789778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789784"><a href="/math/big/nat.go.html#3788818">zz</a></span>&nbsp;<span class="op" id="3789787">=</span>&nbsp;<span class="ident" id="3789789"><a href="/math/big/nat.go.html#3788818">zz</a></span><span class="op" id="3789791">.</span><span class="ident" id="3789792">mul</span><span class="op" id="3789795">(</span><span class="ident" id="3789796"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789797">,</span>&nbsp;<span class="ident" id="3789799"><a href="/math/big/nat.go.html#3788875">powers</a></span><span class="op" id="3789805">[</span><span class="ident" id="3789806"><a href="/math/big/nat.go.html#3789210">yi</a></span><span class="op" id="3789808">&gt;&gt;</span><span class="op" id="3789810">(</span><span class="ident" id="3789811"><a href="/math/big/arith.go.html#3727893">_W</a></span><span class="op" id="3789813">-</span><span class="ident" id="3789814"><a href="/math/big/nat.go.html#3788836">n</a></span><span class="op" id="3789815">)</span><span class="op" id="3789816">]</span><span class="op" id="3789817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789822"><a href="/math/big/nat.go.html#3788818">zz</a></span><span class="op" id="3789824">,</span>&nbsp;<span class="ident" id="3789826"><a href="/math/big/nat.go.html#3788672">z</a></span>&nbsp;<span class="op" id="3789828">=</span>&nbsp;<span class="ident" id="3789830"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789831">,</span>&nbsp;<span class="ident" id="3789833"><a href="/math/big/nat.go.html#3788818">zz</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789839"><a href="/math/big/nat.go.html#3788818">zz</a></span><span class="op" id="3789841">,</span>&nbsp;<span class="ident" id="3789843"><a href="/math/big/nat.go.html#3788822">r</a></span>&nbsp;<span class="op" id="3789845">=</span>&nbsp;<span class="ident" id="3789847"><a href="/math/big/nat.go.html#3788818">zz</a></span><span class="op" id="3789849">.</span><span class="ident" id="3789850">div</span><span class="op" id="3789853">(</span><span class="ident" id="3789854"><a href="/math/big/nat.go.html#3788822">r</a></span><span class="op" id="3789855">,</span>&nbsp;<span class="ident" id="3789857"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789858">,</span>&nbsp;<span class="ident" id="3789860"><a href="/math/big/nat.go.html#3788699">m</a></span><span class="op" id="3789861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789866"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789867">,</span>&nbsp;<span class="ident" id="3789869"><a href="/math/big/nat.go.html#3788822">r</a></span>&nbsp;<span class="op" id="3789871">=</span>&nbsp;<span class="ident" id="3789873"><a href="/math/big/nat.go.html#3788822">r</a></span><span class="op" id="3789874">,</span>&nbsp;<span class="ident" id="3789876"><a href="/math/big/nat.go.html#3788672">z</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789882"><a href="/math/big/nat.go.html#3789210">yi</a></span>&nbsp;<span class="op" id="3789885">&lt;&lt;=</span>&nbsp;<span class="ident" id="3789889"><a href="/math/big/nat.go.html#3788836">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3789893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3789896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3789900">return</span>&nbsp;<span class="ident" id="3789907"><a href="/math/big/nat.go.html#3788672">z</a></span><span class="op" id="3789908">.</span><span class="ident" id="3789909">norm</span><span class="op" id="3789913">(</span><span class="op" id="3789914">)</span><br>
<span class="lineno">1380</span><span class="op" id="3789916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3789919">//&nbsp;probablyPrime&nbsp;performs&nbsp;reps&nbsp;Miller-Rabin&nbsp;tests&nbsp;to&nbsp;check&nbsp;whether&nbsp;n&nbsp;is&nbsp;prime.</span><br>
<span class="lineno"></span><span class="comment" id="3789998">//&nbsp;If&nbsp;it&nbsp;returns&nbsp;true,&nbsp;n&nbsp;is&nbsp;prime&nbsp;with&nbsp;probability&nbsp;1&nbsp;-&nbsp;1/4^reps.</span><br>
<span class="lineno"></span><span class="comment" id="3790063">//&nbsp;If&nbsp;it&nbsp;returns&nbsp;false,&nbsp;n&nbsp;is&nbsp;not&nbsp;prime.</span><br>
<span class="lineno">1385</span><span class="keyword" id="3790103">func</span>&nbsp;<span class="op" id="3790108">(</span><span class="ident" id="3790109">n</span>&nbsp;<span class="ident" id="3790111"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3790114">)</span>&nbsp;<span class="ident" id="3790116">probablyPrime</span><span class="op" id="3790129">(</span><span class="ident" id="3790130">reps</span>&nbsp;<span class="builtintype" id="3790135">int</span><span class="op" id="3790138">)</span>&nbsp;<span class="builtintype" id="3790140">bool</span>&nbsp;<span class="op" id="3790145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3790148">if</span>&nbsp;<span class="builtinfunc" id="3790151">len</span><span class="op" id="3790154">(</span><span class="ident" id="3790155"><a href="/math/big/nat.go.html#3790109">n</a></span><span class="op" id="3790156">)</span>&nbsp;<span class="op" id="3790158">==</span>&nbsp;<span class="num" id="3790161">0</span>&nbsp;<span class="op" id="3790163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3790167">return</span>&nbsp;<span class="builtintype" id="3790174">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3790181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3790185">if</span>&nbsp;<span class="builtinfunc" id="3790188">len</span><span class="op" id="3790191">(</span><span class="ident" id="3790192"><a href="/math/big/nat.go.html#3790109">n</a></span><span class="op" id="3790193">)</span>&nbsp;<span class="op" id="3790195">==</span>&nbsp;<span class="num" id="3790198">1</span>&nbsp;<span class="op" id="3790200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3790204">if</span>&nbsp;<span class="ident" id="3790207"><a href="/math/big/nat.go.html#3790109">n</a></span><span class="op" id="3790208">[</span><span class="num" id="3790209">0</span><span class="op" id="3790210">]</span>&nbsp;<span class="op" id="3790212">&lt;</span>&nbsp;<span class="num" id="3790214">2</span>&nbsp;<span class="op" id="3790216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3790221">return</span>&nbsp;<span class="builtintype" id="3790228">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3790236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3790241">if</span>&nbsp;<span class="ident" id="3790244"><a href="/math/big/nat.go.html#3790109">n</a></span><span class="op" id="3790245">[</span><span class="num" id="3790246">0</span><span class="op" id="3790247">]</span><span class="op" id="3790248">%</span><span class="num" id="3790249">2</span>&nbsp;<span class="op" id="3790251">==</span>&nbsp;<span class="num" id="3790254">0</span>&nbsp;<span class="op" id="3790256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3790261">return</span>&nbsp;<span class="ident" id="3790268"><a href="/math/big/nat.go.html#3790109">n</a></span><span class="op" id="3790269">[</span><span class="num" id="3790270">0</span><span class="op" id="3790271">]</span>&nbsp;<span class="op" id="3790273">==</span>&nbsp;<span class="num" id="3790276">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3790280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3790285">//&nbsp;We&nbsp;have&nbsp;to&nbsp;exclude&nbsp;these&nbsp;cases&nbsp;because&nbsp;we&nbsp;reject&nbsp;all</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3790343">//&nbsp;multiples&nbsp;of&nbsp;these&nbsp;numbers&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3790382">switch</span>&nbsp;<span class="ident" id="3790389"><a href="/math/big/nat.go.html#3790109">n</a></span><span class="op" id="3790390">[</span><span class="num" id="3790391">0</span><span class="op" id="3790392">]</span>&nbsp;<span class="op" id="3790394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3790398">case</span>&nbsp;<span class="num" id="3790403">3</span><span class="op" id="3790404">,</span>&nbsp;<span class="num" id="3790406">5</span><span class="op" id="3790407">,</span>&nbsp;<span class="num" id="3790409">7</span><span class="op" id="3790410">,</span>&nbsp;<span class="num" id="3790412">11</span><span class="op" id="3790414">,</span>&nbsp;<span class="num" id="3790416">13</span><span class="op" id="3790418">,</span>&nbsp;<span class="num" id="3790420">17</span><span class="op" id="3790422">,</span>&nbsp;<span class="num" id="3790424">19</span><span class="op" id="3790426">,</span>&nbsp;<span class="num" id="3790428">23</span><span class="op" id="3790430">,</span>&nbsp;<span class="num" id="3790432">29</span><span class="op" id="3790434">,</span>&nbsp;<span class="num" id="3790436">31</span><span class="op" id="3790438">,</span>&nbsp;<span class="num" id="3790440">37</span><span class="op" id="3790442">,</span>&nbsp;<span class="num" id="3790444">41</span><span class="op" id="3790446">,</span>&nbsp;<span class="num" id="3790448">43</span><span class="op" id="3790450">,</span>&nbsp;<span class="num" id="3790452">47</span><span class="op" id="3790454">,</span>&nbsp;<span class="num" id="3790456">53</span><span class="op" id="3790458">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3790463">return</span>&nbsp;<span class="builtintype" id="3790470">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3790477">}</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3790480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3790484">const</span>&nbsp;<span class="ident" id="3790490">primesProduct32</span>&nbsp;<span class="op" id="3790506">=</span>&nbsp;<span class="num" id="3790508">0xC0CFD797</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3790527">//&nbsp;Π&nbsp;{p&nbsp;∈&nbsp;primes,&nbsp;2&nbsp;&lt;&nbsp;p&nbsp;&lt;=&nbsp;29}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3790562">const</span>&nbsp;<span class="ident" id="3790568">primesProduct64</span>&nbsp;<span class="op" id="3790584">=</span>&nbsp;<span class="num" id="3790586">0xE221F97C30E94E1D</span>&nbsp;<span class="comment" id="3790605">//&nbsp;Π&nbsp;{p&nbsp;∈&nbsp;primes,&nbsp;2&nbsp;&lt;&nbsp;p&nbsp;&lt;=&nbsp;53}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3790641">var</span>&nbsp;<span class="ident" id="3790645">r</span>&nbsp;<span class="ident" id="3790647"><a href="/math/big/arith.go.html#3727748">Word</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3790653">switch</span>&nbsp;<span class="ident" id="3790660"><a href="/math/big/arith.go.html#3727893">_W</a></span>&nbsp;<span class="op" id="3790663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3790666">case</span>&nbsp;<span class="num" id="3790671">32</span><span class="op" id="3790673">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790677"><a href="/math/big/nat.go.html#3790645">r</a></span>&nbsp;<span class="op" id="3790679">=</span>&nbsp;<span class="ident" id="3790681"><a href="/math/big/nat.go.html#3790109">n</a></span><span class="op" id="3790682">.</span><span class="ident" id="3790683">modW</span><span class="op" id="3790687">(</span><span class="ident" id="3790688"><a href="/math/big/nat.go.html#3790490">primesProduct32</a></span><span class="op" id="3790703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3790706">case</span>&nbsp;<span class="num" id="3790711">64</span><span class="op" id="3790713">:</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790717"><a href="/math/big/nat.go.html#3790645">r</a></span>&nbsp;<span class="op" id="3790719">=</span>&nbsp;<span class="ident" id="3790721"><a href="/math/big/nat.go.html#3790109">n</a></span><span class="op" id="3790722">.</span><span class="ident" id="3790723">modW</span><span class="op" id="3790727">(</span><span class="ident" id="3790728"><a href="/math/big/nat.go.html#3790568">primesProduct64</a></span>&nbsp;<span class="op" id="3790744">&amp;</span>&nbsp;<span class="ident" id="3790746"><a href="/math/big/arith.go.html#3727956">_M</a></span><span class="op" id="3790748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3790751">default</span><span class="op" id="3790758">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3790762">panic</span><span class="op" id="3790767">(</span><span class="string" id="3790768">&#34;Unknown&nbsp;word&nbsp;size&#34;</span><span class="op" id="3790787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3790790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3790794">if</span>&nbsp;<span class="ident" id="3790797"><a href="/math/big/nat.go.html#3790645">r</a></span><span class="op" id="3790798">%</span><span class="num" id="3790799">3</span>&nbsp;<span class="op" id="3790801">==</span>&nbsp;<span class="num" id="3790804">0</span>&nbsp;<span class="op" id="3790806">||</span>&nbsp;<span class="ident" id="3790809"><a href="/math/big/nat.go.html#3790645">r</a></span><span class="op" id="3790810">%</span><span class="num" id="3790811">5</span>&nbsp;<span class="op" id="3790813">==</span>&nbsp;<span class="num" id="3790816">0</span>&nbsp;<span class="op" id="3790818">||</span>&nbsp;<span class="ident" id="3790821"><a href="/math/big/nat.go.html#3790645">r</a></span><span class="op" id="3790822">%</span><span class="num" id="3790823">7</span>&nbsp;<span class="op" id="3790825">==</span>&nbsp;<span class="num" id="3790828">0</span>&nbsp;<span class="op" id="3790830">||</span>&nbsp;<span class="ident" id="3790833"><a href="/math/big/nat.go.html#3790645">r</a></span><span class="op" id="3790834">%</span><span class="num" id="3790835">11</span>&nbsp;<span class="op" id="3790838">==</span>&nbsp;<span class="num" id="3790841">0</span>&nbsp;<span class="op" id="3790843">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790848"><a href="/math/big/nat.go.html#3790645">r</a></span><span class="op" id="3790849">%</span><span class="num" id="3790850">13</span>&nbsp;<span class="op" id="3790853">==</span>&nbsp;<span class="num" id="3790856">0</span>&nbsp;<span class="op" id="3790858">||</span>&nbsp;<span class="ident" id="3790861"><a href="/math/big/nat.go.html#3790645">r</a></span><span class="op" id="3790862">%</span><span class="num" id="3790863">17</span>&nbsp;<span class="op" id="3790866">==</span>&nbsp;<span class="num" id="3790869">0</span>&nbsp;<span class="op" id="3790871">||</span>&nbsp;<span class="ident" id="3790874"><a href="/math/big/nat.go.html#3790645">r</a></span><span class="op" id="3790875">%</span><span class="num" id="3790876">19</span>&nbsp;<span class="op" id="3790879">==</span>&nbsp;<span class="num" id="3790882">0</span>&nbsp;<span class="op" id="3790884">||</span>&nbsp;<span class="ident" id="3790887"><a href="/math/big/nat.go.html#3790645">r</a></span><span class="op" id="3790888">%</span><span class="num" id="3790889">23</span>&nbsp;<span class="op" id="3790892">==</span>&nbsp;<span class="num" id="3790895">0</span>&nbsp;<span class="op" id="3790897">||</span>&nbsp;<span class="ident" id="3790900"><a href="/math/big/nat.go.html#3790645">r</a></span><span class="op" id="3790901">%</span><span class="num" id="3790902">29</span>&nbsp;<span class="op" id="3790905">==</span>&nbsp;<span class="num" id="3790908">0</span>&nbsp;<span class="op" id="3790910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3790914">return</span>&nbsp;<span class="builtintype" id="3790921">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3790928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3790932">if</span>&nbsp;<span class="ident" id="3790935"><a href="/math/big/arith.go.html#3727893">_W</a></span>&nbsp;<span class="op" id="3790938">==</span>&nbsp;<span class="num" id="3790941">64</span>&nbsp;<span class="op" id="3790944">&amp;&amp;</span>&nbsp;<span class="op" id="3790947">(</span><span class="ident" id="3790948"><a href="/math/big/nat.go.html#3790645">r</a></span><span class="op" id="3790949">%</span><span class="num" id="3790950">31</span>&nbsp;<span class="op" id="3790953">==</span>&nbsp;<span class="num" id="3790956">0</span>&nbsp;<span class="op" id="3790958">||</span>&nbsp;<span class="ident" id="3790961"><a href="/math/big/nat.go.html#3790645">r</a></span><span class="op" id="3790962">%</span><span class="num" id="3790963">37</span>&nbsp;<span class="op" id="3790966">==</span>&nbsp;<span class="num" id="3790969">0</span>&nbsp;<span class="op" id="3790971">||</span>&nbsp;<span class="ident" id="3790974"><a href="/math/big/nat.go.html#3790645">r</a></span><span class="op" id="3790975">%</span><span class="num" id="3790976">41</span>&nbsp;<span class="op" id="3790979">==</span>&nbsp;<span class="num" id="3790982">0</span>&nbsp;<span class="op" id="3790984">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790989"><a href="/math/big/nat.go.html#3790645">r</a></span><span class="op" id="3790990">%</span><span class="num" id="3790991">43</span>&nbsp;<span class="op" id="3790994">==</span>&nbsp;<span class="num" id="3790997">0</span>&nbsp;<span class="op" id="3790999">||</span>&nbsp;<span class="ident" id="3791002"><a href="/math/big/nat.go.html#3790645">r</a></span><span class="op" id="3791003">%</span><span class="num" id="3791004">47</span>&nbsp;<span class="op" id="3791007">==</span>&nbsp;<span class="num" id="3791010">0</span>&nbsp;<span class="op" id="3791012">||</span>&nbsp;<span class="ident" id="3791015"><a href="/math/big/nat.go.html#3790645">r</a></span><span class="op" id="3791016">%</span><span class="num" id="3791017">53</span>&nbsp;<span class="op" id="3791020">==</span>&nbsp;<span class="num" id="3791023">0</span><span class="op" id="3791024">)</span>&nbsp;<span class="op" id="3791026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3791030">return</span>&nbsp;<span class="builtintype" id="3791037">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3791044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3791048">nm1</span>&nbsp;<span class="op" id="3791052">:=</span>&nbsp;<span class="ident" id="3791055"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3791058">(</span><span class="ident" id="3791059">nil</span><span class="op" id="3791062">)</span><span class="op" id="3791063">.</span><span class="ident" id="3791064">sub</span><span class="op" id="3791067">(</span><span class="ident" id="3791068"><a href="/math/big/nat.go.html#3790109">n</a></span><span class="op" id="3791069">,</span>&nbsp;<span class="ident" id="3791071"><a href="/math/big/nat.go.html#3758911">natOne</a></span><span class="op" id="3791077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3791080">//&nbsp;determine&nbsp;q,&nbsp;k&nbsp;such&nbsp;that&nbsp;nm1&nbsp;=&nbsp;q&nbsp;&lt;&lt;&nbsp;k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3791122">k</span>&nbsp;<span class="op" id="3791124">:=</span>&nbsp;<span class="ident" id="3791127"><a href="/math/big/nat.go.html#3791048">nm1</a></span><span class="op" id="3791130">.</span><span class="ident" id="3791131">trailingZeroBits</span><span class="op" id="3791147">(</span><span class="op" id="3791148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3791151">q</span>&nbsp;<span class="op" id="3791153">:=</span>&nbsp;<span class="ident" id="3791156"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3791159">(</span><span class="ident" id="3791160">nil</span><span class="op" id="3791163">)</span><span class="op" id="3791164">.</span><span class="ident" id="3791165">shr</span><span class="op" id="3791168">(</span><span class="ident" id="3791169"><a href="/math/big/nat.go.html#3791048">nm1</a></span><span class="op" id="3791172">,</span>&nbsp;<span class="ident" id="3791174"><a href="/math/big/nat.go.html#3791122">k</a></span><span class="op" id="3791175">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3791179">nm3</span>&nbsp;<span class="op" id="3791183">:=</span>&nbsp;<span class="ident" id="3791186"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3791189">(</span><span class="ident" id="3791190">nil</span><span class="op" id="3791193">)</span><span class="op" id="3791194">.</span><span class="ident" id="3791195">sub</span><span class="op" id="3791198">(</span><span class="ident" id="3791199"><a href="/math/big/nat.go.html#3791048">nm1</a></span><span class="op" id="3791202">,</span>&nbsp;<span class="ident" id="3791204"><a href="/math/big/nat.go.html#3758928">natTwo</a></span><span class="op" id="3791210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3791213">rand</span>&nbsp;<span class="op" id="3791218">:=</span>&nbsp;<span class="ident" id="3791221"><a href="/math/big/nat.go.html#3758356">rand</a></span><span class="op" id="3791225">.</span><span class="ident" id="3791226">New</span><span class="op" id="3791229">(</span><span class="ident" id="3791230"><a href="/math/big/nat.go.html#3758356">rand</a></span><span class="op" id="3791234">.</span><span class="ident" id="3791235">NewSource</span><span class="op" id="3791244">(</span><span class="ident" id="3791245">int64</span><span class="op" id="3791250">(</span><span class="ident" id="3791251"><a href="/math/big/nat.go.html#3790109">n</a></span><span class="op" id="3791252">[</span><span class="num" id="3791253">0</span><span class="op" id="3791254">]</span><span class="op" id="3791255">)</span><span class="op" id="3791256">)</span><span class="op" id="3791257">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3791261">var</span>&nbsp;<span class="ident" id="3791265">x</span><span class="op" id="3791266">,</span>&nbsp;<span class="ident" id="3791268">y</span><span class="op" id="3791269">,</span>&nbsp;<span class="ident" id="3791271">quotient</span>&nbsp;<span class="ident" id="3791280"><a href="/math/big/nat.go.html#3758892">nat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3791285">nm3Len</span>&nbsp;<span class="op" id="3791292">:=</span>&nbsp;<span class="ident" id="3791295"><a href="/math/big/nat.go.html#3791179">nm3</a></span><span class="op" id="3791298">.</span><span class="ident" id="3791299">bitLen</span><span class="op" id="3791305">(</span><span class="op" id="3791306">)</span><br>
<span class="lineno">1440</span><br>
<span class="lineno"></span><span class="ident" id="3791309">NextRandom</span><span class="op" id="3791319">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3791322">for</span>&nbsp;<span class="ident" id="3791326">i</span>&nbsp;<span class="op" id="3791328">:=</span>&nbsp;<span class="num" id="3791331">0</span><span class="op" id="3791332">;</span>&nbsp;<span class="ident" id="3791334"><a href="/math/big/nat.go.html#3791326">i</a></span>&nbsp;<span class="op" id="3791336">&lt;</span>&nbsp;<span class="ident" id="3791338"><a href="/math/big/nat.go.html#3790130">reps</a></span><span class="op" id="3791342">;</span>&nbsp;<span class="ident" id="3791344"><a href="/math/big/nat.go.html#3791326">i</a></span><span class="op" id="3791345">++</span>&nbsp;<span class="op" id="3791348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3791352"><a href="/math/big/nat.go.html#3791265">x</a></span>&nbsp;<span class="op" id="3791354">=</span>&nbsp;<span class="ident" id="3791356"><a href="/math/big/nat.go.html#3791265">x</a></span><span class="op" id="3791357">.</span><span class="ident" id="3791358">random</span><span class="op" id="3791364">(</span><span class="ident" id="3791365"><a href="/math/big/nat.go.html#3791213">rand</a></span><span class="op" id="3791369">,</span>&nbsp;<span class="ident" id="3791371"><a href="/math/big/nat.go.html#3791179">nm3</a></span><span class="op" id="3791374">,</span>&nbsp;<span class="ident" id="3791376"><a href="/math/big/nat.go.html#3791285">nm3Len</a></span><span class="op" id="3791382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3791386"><a href="/math/big/nat.go.html#3791265">x</a></span>&nbsp;<span class="op" id="3791388">=</span>&nbsp;<span class="ident" id="3791390"><a href="/math/big/nat.go.html#3791265">x</a></span><span class="op" id="3791391">.</span><span class="ident" id="3791392">add</span><span class="op" id="3791395">(</span><span class="ident" id="3791396"><a href="/math/big/nat.go.html#3791265">x</a></span><span class="op" id="3791397">,</span>&nbsp;<span class="ident" id="3791399"><a href="/math/big/nat.go.html#3758928">natTwo</a></span><span class="op" id="3791405">)</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3791409"><a href="/math/big/nat.go.html#3791268">y</a></span>&nbsp;<span class="op" id="3791411">=</span>&nbsp;<span class="ident" id="3791413"><a href="/math/big/nat.go.html#3791268">y</a></span><span class="op" id="3791414">.</span><span class="ident" id="3791415">expNN</span><span class="op" id="3791420">(</span><span class="ident" id="3791421"><a href="/math/big/nat.go.html#3791265">x</a></span><span class="op" id="3791422">,</span>&nbsp;<span class="ident" id="3791424"><a href="/math/big/nat.go.html#3791151">q</a></span><span class="op" id="3791425">,</span>&nbsp;<span class="ident" id="3791427"><a href="/math/big/nat.go.html#3790109">n</a></span><span class="op" id="3791428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3791432">if</span>&nbsp;<span class="ident" id="3791435"><a href="/math/big/nat.go.html#3791268">y</a></span><span class="op" id="3791436">.</span><span class="ident" id="3791437">cmp</span><span class="op" id="3791440">(</span><span class="ident" id="3791441"><a href="/math/big/nat.go.html#3758911">natOne</a></span><span class="op" id="3791447">)</span>&nbsp;<span class="op" id="3791449">==</span>&nbsp;<span class="num" id="3791452">0</span>&nbsp;<span class="op" id="3791454">||</span>&nbsp;<span class="ident" id="3791457"><a href="/math/big/nat.go.html#3791268">y</a></span><span class="op" id="3791458">.</span><span class="ident" id="3791459">cmp</span><span class="op" id="3791462">(</span><span class="ident" id="3791463"><a href="/math/big/nat.go.html#3791048">nm1</a></span><span class="op" id="3791466">)</span>&nbsp;<span class="op" id="3791468">==</span>&nbsp;<span class="num" id="3791471">0</span>&nbsp;<span class="op" id="3791473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3791478">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3791489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3791493">for</span>&nbsp;<span class="ident" id="3791497">j</span>&nbsp;<span class="op" id="3791499">:=</span>&nbsp;<span class="builtintype" id="3791502">uint</span><span class="op" id="3791506">(</span><span class="num" id="3791507">1</span><span class="op" id="3791508">)</span><span class="op" id="3791509">;</span>&nbsp;<span class="ident" id="3791511"><a href="/math/big/nat.go.html#3791497">j</a></span>&nbsp;<span class="op" id="3791513">&lt;</span>&nbsp;<span class="ident" id="3791515"><a href="/math/big/nat.go.html#3791122">k</a></span><span class="op" id="3791516">;</span>&nbsp;<span class="ident" id="3791518"><a href="/math/big/nat.go.html#3791497">j</a></span><span class="op" id="3791519">++</span>&nbsp;<span class="op" id="3791522">{</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3791527"><a href="/math/big/nat.go.html#3791268">y</a></span>&nbsp;<span class="op" id="3791529">=</span>&nbsp;<span class="ident" id="3791531"><a href="/math/big/nat.go.html#3791268">y</a></span><span class="op" id="3791532">.</span><span class="ident" id="3791533">mul</span><span class="op" id="3791536">(</span><span class="ident" id="3791537"><a href="/math/big/nat.go.html#3791268">y</a></span><span class="op" id="3791538">,</span>&nbsp;<span class="ident" id="3791540"><a href="/math/big/nat.go.html#3791268">y</a></span><span class="op" id="3791541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3791546"><a href="/math/big/nat.go.html#3791271">quotient</a></span><span class="op" id="3791554">,</span>&nbsp;<span class="ident" id="3791556"><a href="/math/big/nat.go.html#3791268">y</a></span>&nbsp;<span class="op" id="3791558">=</span>&nbsp;<span class="ident" id="3791560"><a href="/math/big/nat.go.html#3791271">quotient</a></span><span class="op" id="3791568">.</span><span class="ident" id="3791569">div</span><span class="op" id="3791572">(</span><span class="ident" id="3791573"><a href="/math/big/nat.go.html#3791268">y</a></span><span class="op" id="3791574">,</span>&nbsp;<span class="ident" id="3791576"><a href="/math/big/nat.go.html#3791268">y</a></span><span class="op" id="3791577">,</span>&nbsp;<span class="ident" id="3791579"><a href="/math/big/nat.go.html#3790109">n</a></span><span class="op" id="3791580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3791585">if</span>&nbsp;<span class="ident" id="3791588"><a href="/math/big/nat.go.html#3791268">y</a></span><span class="op" id="3791589">.</span><span class="ident" id="3791590">cmp</span><span class="op" id="3791593">(</span><span class="ident" id="3791594"><a href="/math/big/nat.go.html#3791048">nm1</a></span><span class="op" id="3791597">)</span>&nbsp;<span class="op" id="3791599">==</span>&nbsp;<span class="num" id="3791602">0</span>&nbsp;<span class="op" id="3791604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3791610">continue</span>&nbsp;<span class="ident" id="3791619">NextRandom</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3791633">}</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3791638">if</span>&nbsp;<span class="ident" id="3791641"><a href="/math/big/nat.go.html#3791268">y</a></span><span class="op" id="3791642">.</span><span class="ident" id="3791643">cmp</span><span class="op" id="3791646">(</span><span class="ident" id="3791647"><a href="/math/big/nat.go.html#3758911">natOne</a></span><span class="op" id="3791653">)</span>&nbsp;<span class="op" id="3791655">==</span>&nbsp;<span class="num" id="3791658">0</span>&nbsp;<span class="op" id="3791660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3791666">return</span>&nbsp;<span class="builtintype" id="3791673">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3791682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3791686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3791690">return</span>&nbsp;<span class="builtintype" id="3791697">false</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3791704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3791708">return</span>&nbsp;<span class="builtintype" id="3791715">true</span><br>
<span class="lineno"></span><span class="op" id="3791720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1465</span><span class="comment" id="3791723">//&nbsp;bytes&nbsp;writes&nbsp;the&nbsp;value&nbsp;of&nbsp;z&nbsp;into&nbsp;buf&nbsp;using&nbsp;big-endian&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="3791790">//&nbsp;len(buf)&nbsp;must&nbsp;be&nbsp;&gt;=&nbsp;len(z)*_S.&nbsp;The&nbsp;value&nbsp;of&nbsp;z&nbsp;is&nbsp;encoded&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3791857">//&nbsp;slice&nbsp;buf[i:].&nbsp;The&nbsp;number&nbsp;i&nbsp;of&nbsp;unused&nbsp;bytes&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3791924">//&nbsp;buf&nbsp;is&nbsp;returned&nbsp;as&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="3791954">func</span>&nbsp;<span class="op" id="3791959">(</span><span class="ident" id="3791960">z</span>&nbsp;<span class="ident" id="3791962"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3791965">)</span>&nbsp;<span class="ident" id="3791967">bytes</span><span class="op" id="3791972">(</span><span class="ident" id="3791973">buf</span>&nbsp;<span class="op" id="3791977">[</span><span class="op" id="3791978">]</span><span class="builtintype" id="3791979">byte</span><span class="op" id="3791983">)</span>&nbsp;<span class="op" id="3791985">(</span><span class="ident" id="3791986">i</span>&nbsp;<span class="builtintype" id="3791988">int</span><span class="op" id="3791991">)</span>&nbsp;<span class="op" id="3791993">{</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3791996"><a href="/math/big/nat.go.html#3791986">i</a></span>&nbsp;<span class="op" id="3791998">=</span>&nbsp;<span class="builtinfunc" id="3792000">len</span><span class="op" id="3792003">(</span><span class="ident" id="3792004"><a href="/math/big/nat.go.html#3791973">buf</a></span><span class="op" id="3792007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3792010">for</span>&nbsp;<span class="ident" id="3792014">_</span><span class="op" id="3792015">,</span>&nbsp;<span class="ident" id="3792017">d</span>&nbsp;<span class="op" id="3792019">:=</span>&nbsp;<span class="keyword" id="3792022">range</span>&nbsp;<span class="ident" id="3792028"><a href="/math/big/nat.go.html#3791960">z</a></span>&nbsp;<span class="op" id="3792030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3792034">for</span>&nbsp;<span class="ident" id="3792038">j</span>&nbsp;<span class="op" id="3792040">:=</span>&nbsp;<span class="num" id="3792043">0</span><span class="op" id="3792044">;</span>&nbsp;<span class="ident" id="3792046"><a href="/math/big/nat.go.html#3792038">j</a></span>&nbsp;<span class="op" id="3792048">&lt;</span>&nbsp;<span class="ident" id="3792050"><a href="/math/big/arith.go.html#3727872">_S</a></span><span class="op" id="3792052">;</span>&nbsp;<span class="ident" id="3792054"><a href="/math/big/nat.go.html#3792038">j</a></span><span class="op" id="3792055">++</span>&nbsp;<span class="op" id="3792058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3792063"><a href="/math/big/nat.go.html#3791986">i</a></span><span class="op" id="3792064">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3792070"><a href="/math/big/nat.go.html#3791973">buf</a></span><span class="op" id="3792073">[</span><span class="ident" id="3792074"><a href="/math/big/nat.go.html#3791986">i</a></span><span class="op" id="3792075">]</span>&nbsp;<span class="op" id="3792077">=</span>&nbsp;<span class="builtintype" id="3792079">byte</span><span class="op" id="3792083">(</span><span class="ident" id="3792084"><a href="/math/big/nat.go.html#3792017">d</a></span><span class="op" id="3792085">)</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3792090"><a href="/math/big/nat.go.html#3792017">d</a></span>&nbsp;<span class="op" id="3792092">&gt;&gt;=</span>&nbsp;<span class="num" id="3792096">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3792100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3792103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3792107">for</span>&nbsp;<span class="ident" id="3792111"><a href="/math/big/nat.go.html#3791986">i</a></span>&nbsp;<span class="op" id="3792113">&lt;</span>&nbsp;<span class="builtinfunc" id="3792115">len</span><span class="op" id="3792118">(</span><span class="ident" id="3792119"><a href="/math/big/nat.go.html#3791973">buf</a></span><span class="op" id="3792122">)</span>&nbsp;<span class="op" id="3792124">&amp;&amp;</span>&nbsp;<span class="ident" id="3792127"><a href="/math/big/nat.go.html#3791973">buf</a></span><span class="op" id="3792130">[</span><span class="ident" id="3792131"><a href="/math/big/nat.go.html#3791986">i</a></span><span class="op" id="3792132">]</span>&nbsp;<span class="op" id="3792134">==</span>&nbsp;<span class="num" id="3792137">0</span>&nbsp;<span class="op" id="3792139">{</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3792143"><a href="/math/big/nat.go.html#3791986">i</a></span><span class="op" id="3792144">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3792148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3792152">return</span><br>
<span class="lineno"></span><span class="op" id="3792159">}</span><br>
<span class="lineno">1485</span><br>
<span class="lineno"></span><span class="comment" id="3792162">//&nbsp;setBytes&nbsp;interprets&nbsp;buf&nbsp;as&nbsp;the&nbsp;bytes&nbsp;of&nbsp;a&nbsp;big-endian&nbsp;unsigned</span><br>
<span class="lineno"></span><span class="comment" id="3792227">//&nbsp;integer,&nbsp;sets&nbsp;z&nbsp;to&nbsp;that&nbsp;value,&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword" id="3792276">func</span>&nbsp;<span class="op" id="3792281">(</span><span class="ident" id="3792282">z</span>&nbsp;<span class="ident" id="3792284"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3792287">)</span>&nbsp;<span class="ident" id="3792289">setBytes</span><span class="op" id="3792297">(</span><span class="ident" id="3792298">buf</span>&nbsp;<span class="op" id="3792302">[</span><span class="op" id="3792303">]</span><span class="builtintype" id="3792304">byte</span><span class="op" id="3792308">)</span>&nbsp;<span class="ident" id="3792310"><a href="/math/big/nat.go.html#3758892">nat</a></span>&nbsp;<span class="op" id="3792314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3792317"><a href="/math/big/nat.go.html#3792282">z</a></span>&nbsp;<span class="op" id="3792319">=</span>&nbsp;<span class="ident" id="3792321"><a href="/math/big/nat.go.html#3792282">z</a></span><span class="op" id="3792322">.</span><span class="builtinfunc" id="3792323">make</span><span class="op" id="3792327">(</span><span class="op" id="3792328">(</span><span class="builtinfunc" id="3792329">len</span><span class="op" id="3792332">(</span><span class="ident" id="3792333"><a href="/math/big/nat.go.html#3792298">buf</a></span><span class="op" id="3792336">)</span>&nbsp;<span class="op" id="3792338">+</span>&nbsp;<span class="ident" id="3792340"><a href="/math/big/arith.go.html#3727872">_S</a></span>&nbsp;<span class="op" id="3792343">-</span>&nbsp;<span class="num" id="3792345">1</span><span class="op" id="3792346">)</span>&nbsp;<span class="op" id="3792348">/</span>&nbsp;<span class="ident" id="3792350"><a href="/math/big/arith.go.html#3727872">_S</a></span><span class="op" id="3792352">)</span><br>
<span class="lineno">1490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3792356">k</span>&nbsp;<span class="op" id="3792358">:=</span>&nbsp;<span class="num" id="3792361">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3792364">s</span>&nbsp;<span class="op" id="3792366">:=</span>&nbsp;<span class="builtintype" id="3792369">uint</span><span class="op" id="3792373">(</span><span class="num" id="3792374">0</span><span class="op" id="3792375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3792378">var</span>&nbsp;<span class="ident" id="3792382">d</span>&nbsp;<span class="ident" id="3792384"><a href="/math/big/arith.go.html#3727748">Word</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3792390">for</span>&nbsp;<span class="ident" id="3792394">i</span>&nbsp;<span class="op" id="3792396">:=</span>&nbsp;<span class="builtinfunc" id="3792399">len</span><span class="op" id="3792402">(</span><span class="ident" id="3792403"><a href="/math/big/nat.go.html#3792298">buf</a></span><span class="op" id="3792406">)</span><span class="op" id="3792407">;</span>&nbsp;<span class="ident" id="3792409"><a href="/math/big/nat.go.html#3792394">i</a></span>&nbsp;<span class="op" id="3792411">&gt;</span>&nbsp;<span class="num" id="3792413">0</span><span class="op" id="3792414">;</span>&nbsp;<span class="ident" id="3792416"><a href="/math/big/nat.go.html#3792394">i</a></span><span class="op" id="3792417">--</span>&nbsp;<span class="op" id="3792420">{</span><br>
<span class="lineno">1495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3792424"><a href="/math/big/nat.go.html#3792382">d</a></span>&nbsp;<span class="op" id="3792426">|=</span>&nbsp;<span class="ident" id="3792429"><a href="/math/big/arith.go.html#3727748">Word</a></span><span class="op" id="3792433">(</span><span class="ident" id="3792434"><a href="/math/big/nat.go.html#3792298">buf</a></span><span class="op" id="3792437">[</span><span class="ident" id="3792438"><a href="/math/big/nat.go.html#3792394">i</a></span><span class="op" id="3792439">-</span><span class="num" id="3792440">1</span><span class="op" id="3792441">]</span><span class="op" id="3792442">)</span>&nbsp;<span class="op" id="3792444">&lt;&lt;</span>&nbsp;<span class="ident" id="3792447"><a href="/math/big/nat.go.html#3792364">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3792451">if</span>&nbsp;<span class="ident" id="3792454"><a href="/math/big/nat.go.html#3792364">s</a></span>&nbsp;<span class="op" id="3792456">+=</span>&nbsp;<span class="num" id="3792459">8</span><span class="op" id="3792460">;</span>&nbsp;<span class="ident" id="3792462"><a href="/math/big/nat.go.html#3792364">s</a></span>&nbsp;<span class="op" id="3792464">==</span>&nbsp;<span class="ident" id="3792467"><a href="/math/big/arith.go.html#3727872">_S</a></span><span class="op" id="3792469">*</span><span class="num" id="3792470">8</span>&nbsp;<span class="op" id="3792472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3792477"><a href="/math/big/nat.go.html#3792282">z</a></span><span class="op" id="3792478">[</span><span class="ident" id="3792479"><a href="/math/big/nat.go.html#3792356">k</a></span><span class="op" id="3792480">]</span>&nbsp;<span class="op" id="3792482">=</span>&nbsp;<span class="ident" id="3792484"><a href="/math/big/nat.go.html#3792382">d</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3792489"><a href="/math/big/nat.go.html#3792356">k</a></span><span class="op" id="3792490">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3792496"><a href="/math/big/nat.go.html#3792364">s</a></span>&nbsp;<span class="op" id="3792498">=</span>&nbsp;<span class="num" id="3792500">0</span><br>
<span class="lineno">1500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3792505"><a href="/math/big/nat.go.html#3792382">d</a></span>&nbsp;<span class="op" id="3792507">=</span>&nbsp;<span class="num" id="3792509">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3792513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3792516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3792519">if</span>&nbsp;<span class="ident" id="3792522"><a href="/math/big/nat.go.html#3792356">k</a></span>&nbsp;<span class="op" id="3792524">&lt;</span>&nbsp;<span class="builtinfunc" id="3792526">len</span><span class="op" id="3792529">(</span><span class="ident" id="3792530"><a href="/math/big/nat.go.html#3792282">z</a></span><span class="op" id="3792531">)</span>&nbsp;<span class="op" id="3792533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3792537"><a href="/math/big/nat.go.html#3792282">z</a></span><span class="op" id="3792538">[</span><span class="ident" id="3792539"><a href="/math/big/nat.go.html#3792356">k</a></span><span class="op" id="3792540">]</span>&nbsp;<span class="op" id="3792542">=</span>&nbsp;<span class="ident" id="3792544"><a href="/math/big/nat.go.html#3792382">d</a></span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3792547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3792551">return</span>&nbsp;<span class="ident" id="3792558"><a href="/math/big/nat.go.html#3792282">z</a></span><span class="op" id="3792559">.</span><span class="ident" id="3792560">norm</span><span class="op" id="3792564">(</span><span class="op" id="3792565">)</span><br>
<span class="lineno"></span><span class="op" id="3792567">}</span>
</div>
</body>
</html>
