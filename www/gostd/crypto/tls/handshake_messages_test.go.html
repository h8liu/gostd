<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8173275">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8173330">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8173384">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8173435">package</span>&nbsp;<span class="ident" id="8173443">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8173448">import</span>&nbsp;<span class="op" id="8173455">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8173458">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8173471">&#34;reflect&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8173482">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8173493">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="8173509">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8173512">var</span>&nbsp;<span class="ident" id="8173516">tests</span>&nbsp;<span class="op" id="8173522">=</span>&nbsp;<span class="op" id="8173524">[</span><span class="op" id="8173525">]</span><span class="keyword" id="8173526">interface</span><span class="op" id="8173535">{</span><span class="op" id="8173536">}</span><span class="op" id="8173537">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8173540">&amp;</span><span class="ident" id="8173541">clientHelloMsg</span><span class="op" id="8173555">{</span><span class="op" id="8173556">}</span><span class="op" id="8173557">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8173560">&amp;</span><span class="ident" id="8173561">serverHelloMsg</span><span class="op" id="8173575">{</span><span class="op" id="8173576">}</span><span class="op" id="8173577">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8173580">&amp;</span><span class="ident" id="8173581">finishedMsg</span><span class="op" id="8173592">{</span><span class="op" id="8173593">}</span><span class="op" id="8173594">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8173598">&amp;</span><span class="ident" id="8173599">certificateMsg</span><span class="op" id="8173613">{</span><span class="op" id="8173614">}</span><span class="op" id="8173615">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8173618">&amp;</span><span class="ident" id="8173619">certificateRequestMsg</span><span class="op" id="8173640">{</span><span class="op" id="8173641">}</span><span class="op" id="8173642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8173645">&amp;</span><span class="ident" id="8173646">certificateVerifyMsg</span><span class="op" id="8173666">{</span><span class="op" id="8173667">}</span><span class="op" id="8173668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8173671">&amp;</span><span class="ident" id="8173672">certificateStatusMsg</span><span class="op" id="8173692">{</span><span class="op" id="8173693">}</span><span class="op" id="8173694">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8173697">&amp;</span><span class="ident" id="8173698">clientKeyExchangeMsg</span><span class="op" id="8173718">{</span><span class="op" id="8173719">}</span><span class="op" id="8173720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8173723">&amp;</span><span class="ident" id="8173724">nextProtoMsg</span><span class="op" id="8173736">{</span><span class="op" id="8173737">}</span><span class="op" id="8173738">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8173741">&amp;</span><span class="ident" id="8173742">newSessionTicketMsg</span><span class="op" id="8173761">{</span><span class="op" id="8173762">}</span><span class="op" id="8173763">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8173766">&amp;</span><span class="ident" id="8173767">sessionState</span><span class="op" id="8173779">{</span><span class="op" id="8173780">}</span><span class="op" id="8173781">,</span><br>
<span class="lineno"></span><span class="op" id="8173783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8173786">type</span>&nbsp;<span class="ident" id="8173791">testMessage</span>&nbsp;<span class="keyword" id="8173803">interface</span>&nbsp;<span class="op" id="8173813">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173816">marshal</span><span class="op" id="8173823">(</span><span class="op" id="8173824">)</span>&nbsp;<span class="op" id="8173826">[</span><span class="op" id="8173827">]</span><span class="builtintype" id="8173828">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173834">unmarshal</span><span class="op" id="8173843">(</span><span class="op" id="8173844">[</span><span class="op" id="8173845">]</span><span class="builtintype" id="8173846">byte</span><span class="op" id="8173850">)</span>&nbsp;<span class="builtintype" id="8173852">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173858">equal</span><span class="op" id="8173863">(</span><span class="keyword" id="8173864">interface</span><span class="op" id="8173873">{</span><span class="op" id="8173874">}</span><span class="op" id="8173875">)</span>&nbsp;<span class="builtintype" id="8173877">bool</span><br>
<span class="lineno"></span><span class="op" id="8173882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="8173885">func</span>&nbsp;<span class="ident" id="8173890">TestMarshalUnmarshal</span><span class="op" id="8173910">(</span><span class="ident" id="8173911">t</span>&nbsp;<span class="op" id="8173913">*</span><span class="ident" id="8173914">testing</span><span class="op" id="8173921">.</span><span class="ident" id="8173922">T</span><span class="op" id="8173923">)</span>&nbsp;<span class="op" id="8173925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173928">rand</span>&nbsp;<span class="op" id="8173933">:=</span>&nbsp;<span class="ident" id="8173936">rand</span><span class="op" id="8173940">.</span><span class="ident" id="8173941">New</span><span class="op" id="8173944">(</span><span class="ident" id="8173945">rand</span><span class="op" id="8173949">.</span><span class="ident" id="8173950">NewSource</span><span class="op" id="8173959">(</span><span class="num" id="8173960">0</span><span class="op" id="8173961">)</span><span class="op" id="8173962">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8173966">for</span>&nbsp;<span class="ident" id="8173970">i</span><span class="op" id="8173971">,</span>&nbsp;<span class="ident" id="8173973">iface</span>&nbsp;<span class="op" id="8173979">:=</span>&nbsp;<span class="keyword" id="8173982">range</span>&nbsp;<span class="ident" id="8173988">tests</span>&nbsp;<span class="op" id="8173994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173998">ty</span>&nbsp;<span class="op" id="8174001">:=</span>&nbsp;<span class="ident" id="8174004">reflect</span><span class="op" id="8174011">.</span><span class="ident" id="8174012">ValueOf</span><span class="op" id="8174019">(</span><span class="ident" id="8174020">iface</span><span class="op" id="8174025">)</span><span class="op" id="8174026">.</span><span class="ident" id="8174027">Type</span><span class="op" id="8174031">(</span><span class="op" id="8174032">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8174037">n</span>&nbsp;<span class="op" id="8174039">:=</span>&nbsp;<span class="num" id="8174042">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8174048">if</span>&nbsp;<span class="ident" id="8174051">testing</span><span class="op" id="8174058">.</span><span class="ident" id="8174059">Short</span><span class="op" id="8174064">(</span><span class="op" id="8174065">)</span>&nbsp;<span class="op" id="8174067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8174072">n</span>&nbsp;<span class="op" id="8174074">=</span>&nbsp;<span class="num" id="8174076">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8174080">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8174084">for</span>&nbsp;<span class="ident" id="8174088">j</span>&nbsp;<span class="op" id="8174090">:=</span>&nbsp;<span class="num" id="8174093">0</span><span class="op" id="8174094">;</span>&nbsp;<span class="ident" id="8174096">j</span>&nbsp;<span class="op" id="8174098">&lt;</span>&nbsp;<span class="ident" id="8174100">n</span><span class="op" id="8174101">;</span>&nbsp;<span class="ident" id="8174103">j</span><span class="op" id="8174104">++</span>&nbsp;<span class="op" id="8174107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8174112">v</span><span class="op" id="8174113">,</span>&nbsp;<span class="ident" id="8174115">ok</span>&nbsp;<span class="op" id="8174118">:=</span>&nbsp;<span class="ident" id="8174121">quick</span><span class="op" id="8174126">.</span><span class="ident" id="8174127">Value</span><span class="op" id="8174132">(</span><span class="ident" id="8174133">ty</span><span class="op" id="8174135">,</span>&nbsp;<span class="ident" id="8174137">rand</span><span class="op" id="8174141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8174146">if</span>&nbsp;<span class="op" id="8174149">!</span><span class="ident" id="8174150">ok</span>&nbsp;<span class="op" id="8174153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8174159">t</span><span class="op" id="8174160">.</span><span class="ident" id="8174161">Errorf</span><span class="op" id="8174167">(</span><span class="string" id="8174168">&#34;#%d:&nbsp;failed&nbsp;to&nbsp;create&nbsp;value&#34;</span><span class="op" id="8174197">,</span>&nbsp;<span class="ident" id="8174199">i</span><span class="op" id="8174200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8174206">break</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8174215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8174221">m1</span>&nbsp;<span class="op" id="8174224">:=</span>&nbsp;<span class="ident" id="8174227">v</span><span class="op" id="8174228">.</span><span class="ident" id="8174229">Interface</span><span class="op" id="8174238">(</span><span class="op" id="8174239">)</span><span class="op" id="8174240">.</span><span class="op" id="8174241">(</span><span class="ident" id="8174242">testMessage</span><span class="op" id="8174253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8174258">marshaled</span>&nbsp;<span class="op" id="8174268">:=</span>&nbsp;<span class="ident" id="8174271">m1</span><span class="op" id="8174273">.</span><span class="ident" id="8174274">marshal</span><span class="op" id="8174281">(</span><span class="op" id="8174282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8174287">m2</span>&nbsp;<span class="op" id="8174290">:=</span>&nbsp;<span class="ident" id="8174293">iface</span><span class="op" id="8174298">.</span><span class="op" id="8174299">(</span><span class="ident" id="8174300">testMessage</span><span class="op" id="8174311">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8174316">if</span>&nbsp;<span class="op" id="8174319">!</span><span class="ident" id="8174320">m2</span><span class="op" id="8174322">.</span><span class="ident" id="8174323">unmarshal</span><span class="op" id="8174332">(</span><span class="ident" id="8174333">marshaled</span><span class="op" id="8174342">)</span>&nbsp;<span class="op" id="8174344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8174350">t</span><span class="op" id="8174351">.</span><span class="ident" id="8174352">Errorf</span><span class="op" id="8174358">(</span><span class="string" id="8174359">&#34;#%d&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;%#v&nbsp;%x&#34;</span><span class="op" id="8174391">,</span>&nbsp;<span class="ident" id="8174393">i</span><span class="op" id="8174394">,</span>&nbsp;<span class="ident" id="8174396">m1</span><span class="op" id="8174398">,</span>&nbsp;<span class="ident" id="8174400">marshaled</span><span class="op" id="8174409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8174415">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8174424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8174429">m2</span><span class="op" id="8174431">.</span><span class="ident" id="8174432">marshal</span><span class="op" id="8174439">(</span><span class="op" id="8174440">)</span>&nbsp;<span class="comment" id="8174442">//&nbsp;to&nbsp;fill&nbsp;any&nbsp;marshal&nbsp;cache&nbsp;in&nbsp;the&nbsp;message</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8174490">if</span>&nbsp;<span class="op" id="8174493">!</span><span class="ident" id="8174494">m1</span><span class="op" id="8174496">.</span><span class="ident" id="8174497">equal</span><span class="op" id="8174502">(</span><span class="ident" id="8174503">m2</span><span class="op" id="8174505">)</span>&nbsp;<span class="op" id="8174507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8174513">t</span><span class="op" id="8174514">.</span><span class="ident" id="8174515">Errorf</span><span class="op" id="8174521">(</span><span class="string" id="8174522">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&nbsp;%x&#34;</span><span class="op" id="8174547">,</span>&nbsp;<span class="ident" id="8174549">i</span><span class="op" id="8174550">,</span>&nbsp;<span class="ident" id="8174552">m2</span><span class="op" id="8174554">,</span>&nbsp;<span class="ident" id="8174556">m1</span><span class="op" id="8174558">,</span>&nbsp;<span class="ident" id="8174560">marshaled</span><span class="op" id="8174569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8174575">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8174584">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8174590">if</span>&nbsp;<span class="ident" id="8174593">i</span>&nbsp;<span class="op" id="8174595">&gt;=</span>&nbsp;<span class="num" id="8174598">3</span>&nbsp;<span class="op" id="8174600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8174606">//&nbsp;The&nbsp;first&nbsp;three&nbsp;message&nbsp;types&nbsp;(ClientHello,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8174657">//&nbsp;ServerHello&nbsp;and&nbsp;Finished)&nbsp;are&nbsp;allowed&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8174705">//&nbsp;have&nbsp;parsable&nbsp;prefixes&nbsp;because&nbsp;the&nbsp;extension</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8174757">//&nbsp;data&nbsp;is&nbsp;optional&nbsp;and&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8174803">//&nbsp;Finished&nbsp;varies&nbsp;across&nbsp;versions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8174843">for</span>&nbsp;<span class="ident" id="8174847">j</span>&nbsp;<span class="op" id="8174849">:=</span>&nbsp;<span class="num" id="8174852">0</span><span class="op" id="8174853">;</span>&nbsp;<span class="ident" id="8174855">j</span>&nbsp;<span class="op" id="8174857">&lt;</span>&nbsp;<span class="builtinfunc" id="8174859">len</span><span class="op" id="8174862">(</span><span class="ident" id="8174863">marshaled</span><span class="op" id="8174872">)</span><span class="op" id="8174873">;</span>&nbsp;<span class="ident" id="8174875">j</span><span class="op" id="8174876">++</span>&nbsp;<span class="op" id="8174879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8174886">if</span>&nbsp;<span class="ident" id="8174889">m2</span><span class="op" id="8174891">.</span><span class="ident" id="8174892">unmarshal</span><span class="op" id="8174901">(</span><span class="ident" id="8174902">marshaled</span><span class="op" id="8174911">[</span><span class="num" id="8174912">0</span><span class="op" id="8174913">:</span><span class="ident" id="8174914">j</span><span class="op" id="8174915">]</span><span class="op" id="8174916">)</span>&nbsp;<span class="op" id="8174918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8174926">t</span><span class="op" id="8174927">.</span><span class="ident" id="8174928">Errorf</span><span class="op" id="8174934">(</span><span class="string" id="8174935">&#34;#%d&nbsp;unmarshaled&nbsp;a&nbsp;prefix&nbsp;of&nbsp;length&nbsp;%d&nbsp;of&nbsp;%#v&#34;</span><span class="op" id="8174981">,</span>&nbsp;<span class="ident" id="8174983">i</span><span class="op" id="8174984">,</span>&nbsp;<span class="ident" id="8174986">j</span><span class="op" id="8174987">,</span>&nbsp;<span class="ident" id="8174989">m1</span><span class="op" id="8174991">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8174999">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8175010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8175016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8175021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8175025">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8175028">}</span><br>
<span class="lineno"></span><span class="op" id="8175030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8175033">func</span>&nbsp;<span class="ident" id="8175038">TestFuzz</span><span class="op" id="8175046">(</span><span class="ident" id="8175047">t</span>&nbsp;<span class="op" id="8175049">*</span><span class="ident" id="8175050">testing</span><span class="op" id="8175057">.</span><span class="ident" id="8175058">T</span><span class="op" id="8175059">)</span>&nbsp;<span class="op" id="8175061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8175064">rand</span>&nbsp;<span class="op" id="8175069">:=</span>&nbsp;<span class="ident" id="8175072">rand</span><span class="op" id="8175076">.</span><span class="ident" id="8175077">New</span><span class="op" id="8175080">(</span><span class="ident" id="8175081">rand</span><span class="op" id="8175085">.</span><span class="ident" id="8175086">NewSource</span><span class="op" id="8175095">(</span><span class="num" id="8175096">0</span><span class="op" id="8175097">)</span><span class="op" id="8175098">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8175101">for</span>&nbsp;<span class="ident" id="8175105">_</span><span class="op" id="8175106">,</span>&nbsp;<span class="ident" id="8175108">iface</span>&nbsp;<span class="op" id="8175114">:=</span>&nbsp;<span class="keyword" id="8175117">range</span>&nbsp;<span class="ident" id="8175123">tests</span>&nbsp;<span class="op" id="8175129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8175133">m</span>&nbsp;<span class="op" id="8175135">:=</span>&nbsp;<span class="ident" id="8175138">iface</span><span class="op" id="8175143">.</span><span class="op" id="8175144">(</span><span class="ident" id="8175145">testMessage</span><span class="op" id="8175156">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8175161">for</span>&nbsp;<span class="ident" id="8175165">j</span>&nbsp;<span class="op" id="8175167">:=</span>&nbsp;<span class="num" id="8175170">0</span><span class="op" id="8175171">;</span>&nbsp;<span class="ident" id="8175173">j</span>&nbsp;<span class="op" id="8175175">&lt;</span>&nbsp;<span class="num" id="8175177">1000</span><span class="op" id="8175181">;</span>&nbsp;<span class="ident" id="8175183">j</span><span class="op" id="8175184">++</span>&nbsp;<span class="op" id="8175187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8175192">len</span>&nbsp;<span class="op" id="8175196">:=</span>&nbsp;<span class="ident" id="8175199">rand</span><span class="op" id="8175203">.</span><span class="ident" id="8175204">Intn</span><span class="op" id="8175208">(</span><span class="num" id="8175209">100</span><span class="op" id="8175212">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8175217">bytes</span>&nbsp;<span class="op" id="8175223">:=</span>&nbsp;<span class="ident" id="8175226">randomBytes</span><span class="op" id="8175237">(</span><span class="builtinfunc" id="8175238">len</span><span class="op" id="8175241">,</span>&nbsp;<span class="ident" id="8175243">rand</span><span class="op" id="8175247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8175252">//&nbsp;This&nbsp;just&nbsp;looks&nbsp;for&nbsp;crashes&nbsp;due&nbsp;to&nbsp;bounds&nbsp;errors&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8175312">m</span><span class="op" id="8175313">.</span><span class="ident" id="8175314">unmarshal</span><span class="op" id="8175323">(</span><span class="ident" id="8175324">bytes</span><span class="op" id="8175329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8175333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8175336">}</span><br>
<span class="lineno">95</span><span class="op" id="8175338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8175341">func</span>&nbsp;<span class="ident" id="8175346">randomBytes</span><span class="op" id="8175357">(</span><span class="ident" id="8175358">n</span>&nbsp;<span class="builtintype" id="8175360">int</span><span class="op" id="8175363">,</span>&nbsp;<span class="ident" id="8175365">rand</span>&nbsp;<span class="op" id="8175370">*</span><span class="ident" id="8175371">rand</span><span class="op" id="8175375">.</span><span class="ident" id="8175376">Rand</span><span class="op" id="8175380">)</span>&nbsp;<span class="op" id="8175382">[</span><span class="op" id="8175383">]</span><span class="builtintype" id="8175384">byte</span>&nbsp;<span class="op" id="8175389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8175392">r</span>&nbsp;<span class="op" id="8175394">:=</span>&nbsp;<span class="builtinfunc" id="8175397">make</span><span class="op" id="8175401">(</span><span class="op" id="8175402">[</span><span class="op" id="8175403">]</span><span class="builtintype" id="8175404">byte</span><span class="op" id="8175408">,</span>&nbsp;<span class="ident" id="8175410">n</span><span class="op" id="8175411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8175414">for</span>&nbsp;<span class="ident" id="8175418">i</span>&nbsp;<span class="op" id="8175420">:=</span>&nbsp;<span class="num" id="8175423">0</span><span class="op" id="8175424">;</span>&nbsp;<span class="ident" id="8175426">i</span>&nbsp;<span class="op" id="8175428">&lt;</span>&nbsp;<span class="ident" id="8175430">n</span><span class="op" id="8175431">;</span>&nbsp;<span class="ident" id="8175433">i</span><span class="op" id="8175434">++</span>&nbsp;<span class="op" id="8175437">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8175441">r</span><span class="op" id="8175442">[</span><span class="ident" id="8175443">i</span><span class="op" id="8175444">]</span>&nbsp;<span class="op" id="8175446">=</span>&nbsp;<span class="builtintype" id="8175448">byte</span><span class="op" id="8175452">(</span><span class="ident" id="8175453">rand</span><span class="op" id="8175457">.</span><span class="ident" id="8175458">Int31</span><span class="op" id="8175463">(</span><span class="op" id="8175464">)</span><span class="op" id="8175465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8175468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8175471">return</span>&nbsp;<span class="ident" id="8175478">r</span><br>
<span class="lineno"></span><span class="op" id="8175480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="8175483">func</span>&nbsp;<span class="ident" id="8175488">randomString</span><span class="op" id="8175500">(</span><span class="ident" id="8175501">n</span>&nbsp;<span class="builtintype" id="8175503">int</span><span class="op" id="8175506">,</span>&nbsp;<span class="ident" id="8175508">rand</span>&nbsp;<span class="op" id="8175513">*</span><span class="ident" id="8175514">rand</span><span class="op" id="8175518">.</span><span class="ident" id="8175519">Rand</span><span class="op" id="8175523">)</span>&nbsp;<span class="builtintype" id="8175525">string</span>&nbsp;<span class="op" id="8175532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8175535">b</span>&nbsp;<span class="op" id="8175537">:=</span>&nbsp;<span class="ident" id="8175540">randomBytes</span><span class="op" id="8175551">(</span><span class="ident" id="8175552">n</span><span class="op" id="8175553">,</span>&nbsp;<span class="ident" id="8175555">rand</span><span class="op" id="8175559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8175562">return</span>&nbsp;<span class="builtintype" id="8175569">string</span><span class="op" id="8175575">(</span><span class="ident" id="8175576">b</span><span class="op" id="8175577">)</span><br>
<span class="lineno"></span><span class="op" id="8175579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="8175582">func</span>&nbsp;<span class="op" id="8175587">(</span><span class="op" id="8175588">*</span><span class="ident" id="8175589">clientHelloMsg</span><span class="op" id="8175603">)</span>&nbsp;<span class="ident" id="8175605">Generate</span><span class="op" id="8175613">(</span><span class="ident" id="8175614">rand</span>&nbsp;<span class="op" id="8175619">*</span><span class="ident" id="8175620">rand</span><span class="op" id="8175624">.</span><span class="ident" id="8175625">Rand</span><span class="op" id="8175629">,</span>&nbsp;<span class="ident" id="8175631">size</span>&nbsp;<span class="builtintype" id="8175636">int</span><span class="op" id="8175639">)</span>&nbsp;<span class="ident" id="8175641">reflect</span><span class="op" id="8175648">.</span><span class="ident" id="8175649">Value</span>&nbsp;<span class="op" id="8175655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8175658">m</span>&nbsp;<span class="op" id="8175660">:=</span>&nbsp;<span class="op" id="8175663">&amp;</span><span class="ident" id="8175664">clientHelloMsg</span><span class="op" id="8175678">{</span><span class="op" id="8175679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8175682">m</span><span class="op" id="8175683">.</span><span class="ident" id="8175684">vers</span>&nbsp;<span class="op" id="8175689">=</span>&nbsp;<span class="builtintype" id="8175691">uint16</span><span class="op" id="8175697">(</span><span class="ident" id="8175698">rand</span><span class="op" id="8175702">.</span><span class="ident" id="8175703">Intn</span><span class="op" id="8175707">(</span><span class="num" id="8175708">65536</span><span class="op" id="8175713">)</span><span class="op" id="8175714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8175717">m</span><span class="op" id="8175718">.</span><span class="ident" id="8175719">random</span>&nbsp;<span class="op" id="8175726">=</span>&nbsp;<span class="ident" id="8175728">randomBytes</span><span class="op" id="8175739">(</span><span class="num" id="8175740">32</span><span class="op" id="8175742">,</span>&nbsp;<span class="ident" id="8175744">rand</span><span class="op" id="8175748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8175751">m</span><span class="op" id="8175752">.</span><span class="ident" id="8175753">sessionId</span>&nbsp;<span class="op" id="8175763">=</span>&nbsp;<span class="ident" id="8175765">randomBytes</span><span class="op" id="8175776">(</span><span class="ident" id="8175777">rand</span><span class="op" id="8175781">.</span><span class="ident" id="8175782">Intn</span><span class="op" id="8175786">(</span><span class="num" id="8175787">32</span><span class="op" id="8175789">)</span><span class="op" id="8175790">,</span>&nbsp;<span class="ident" id="8175792">rand</span><span class="op" id="8175796">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8175799">m</span><span class="op" id="8175800">.</span><span class="ident" id="8175801">cipherSuites</span>&nbsp;<span class="op" id="8175814">=</span>&nbsp;<span class="builtinfunc" id="8175816">make</span><span class="op" id="8175820">(</span><span class="op" id="8175821">[</span><span class="op" id="8175822">]</span><span class="builtintype" id="8175823">uint16</span><span class="op" id="8175829">,</span>&nbsp;<span class="ident" id="8175831">rand</span><span class="op" id="8175835">.</span><span class="ident" id="8175836">Intn</span><span class="op" id="8175840">(</span><span class="num" id="8175841">63</span><span class="op" id="8175843">)</span><span class="op" id="8175844">+</span><span class="num" id="8175845">1</span><span class="op" id="8175846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8175849">for</span>&nbsp;<span class="ident" id="8175853">i</span>&nbsp;<span class="op" id="8175855">:=</span>&nbsp;<span class="num" id="8175858">0</span><span class="op" id="8175859">;</span>&nbsp;<span class="ident" id="8175861">i</span>&nbsp;<span class="op" id="8175863">&lt;</span>&nbsp;<span class="builtinfunc" id="8175865">len</span><span class="op" id="8175868">(</span><span class="ident" id="8175869">m</span><span class="op" id="8175870">.</span><span class="ident" id="8175871">cipherSuites</span><span class="op" id="8175883">)</span><span class="op" id="8175884">;</span>&nbsp;<span class="ident" id="8175886">i</span><span class="op" id="8175887">++</span>&nbsp;<span class="op" id="8175890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8175894">m</span><span class="op" id="8175895">.</span><span class="ident" id="8175896">cipherSuites</span><span class="op" id="8175908">[</span><span class="ident" id="8175909">i</span><span class="op" id="8175910">]</span>&nbsp;<span class="op" id="8175912">=</span>&nbsp;<span class="builtintype" id="8175914">uint16</span><span class="op" id="8175920">(</span><span class="ident" id="8175921">rand</span><span class="op" id="8175925">.</span><span class="ident" id="8175926">Int31</span><span class="op" id="8175931">(</span><span class="op" id="8175932">)</span><span class="op" id="8175933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8175936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8175939">m</span><span class="op" id="8175940">.</span><span class="ident" id="8175941">compressionMethods</span>&nbsp;<span class="op" id="8175960">=</span>&nbsp;<span class="ident" id="8175962">randomBytes</span><span class="op" id="8175973">(</span><span class="ident" id="8175974">rand</span><span class="op" id="8175978">.</span><span class="ident" id="8175979">Intn</span><span class="op" id="8175983">(</span><span class="num" id="8175984">63</span><span class="op" id="8175986">)</span><span class="op" id="8175987">+</span><span class="num" id="8175988">1</span><span class="op" id="8175989">,</span>&nbsp;<span class="ident" id="8175991">rand</span><span class="op" id="8175995">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8175998">if</span>&nbsp;<span class="ident" id="8176001">rand</span><span class="op" id="8176005">.</span><span class="ident" id="8176006">Intn</span><span class="op" id="8176010">(</span><span class="num" id="8176011">10</span><span class="op" id="8176013">)</span>&nbsp;<span class="op" id="8176015">&gt;</span>&nbsp;<span class="num" id="8176017">5</span>&nbsp;<span class="op" id="8176019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8176023">m</span><span class="op" id="8176024">.</span><span class="ident" id="8176025">nextProtoNeg</span>&nbsp;<span class="op" id="8176038">=</span>&nbsp;<span class="builtintype" id="8176040">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8176046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8176049">if</span>&nbsp;<span class="ident" id="8176052">rand</span><span class="op" id="8176056">.</span><span class="ident" id="8176057">Intn</span><span class="op" id="8176061">(</span><span class="num" id="8176062">10</span><span class="op" id="8176064">)</span>&nbsp;<span class="op" id="8176066">&gt;</span>&nbsp;<span class="num" id="8176068">5</span>&nbsp;<span class="op" id="8176070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8176074">m</span><span class="op" id="8176075">.</span><span class="ident" id="8176076">serverName</span>&nbsp;<span class="op" id="8176087">=</span>&nbsp;<span class="ident" id="8176089">randomString</span><span class="op" id="8176101">(</span><span class="ident" id="8176102">rand</span><span class="op" id="8176106">.</span><span class="ident" id="8176107">Intn</span><span class="op" id="8176111">(</span><span class="num" id="8176112">255</span><span class="op" id="8176115">)</span><span class="op" id="8176116">,</span>&nbsp;<span class="ident" id="8176118">rand</span><span class="op" id="8176122">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8176125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8176128">m</span><span class="op" id="8176129">.</span><span class="ident" id="8176130">ocspStapling</span>&nbsp;<span class="op" id="8176143">=</span>&nbsp;<span class="ident" id="8176145">rand</span><span class="op" id="8176149">.</span><span class="ident" id="8176150">Intn</span><span class="op" id="8176154">(</span><span class="num" id="8176155">10</span><span class="op" id="8176157">)</span>&nbsp;<span class="op" id="8176159">&gt;</span>&nbsp;<span class="num" id="8176161">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8176164">m</span><span class="op" id="8176165">.</span><span class="ident" id="8176166">supportedPoints</span>&nbsp;<span class="op" id="8176182">=</span>&nbsp;<span class="ident" id="8176184">randomBytes</span><span class="op" id="8176195">(</span><span class="ident" id="8176196">rand</span><span class="op" id="8176200">.</span><span class="ident" id="8176201">Intn</span><span class="op" id="8176205">(</span><span class="num" id="8176206">5</span><span class="op" id="8176207">)</span><span class="op" id="8176208">+</span><span class="num" id="8176209">1</span><span class="op" id="8176210">,</span>&nbsp;<span class="ident" id="8176212">rand</span><span class="op" id="8176216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8176219">m</span><span class="op" id="8176220">.</span><span class="ident" id="8176221">supportedCurves</span>&nbsp;<span class="op" id="8176237">=</span>&nbsp;<span class="builtinfunc" id="8176239">make</span><span class="op" id="8176243">(</span><span class="op" id="8176244">[</span><span class="op" id="8176245">]</span><span class="ident" id="8176246">CurveID</span><span class="op" id="8176253">,</span>&nbsp;<span class="ident" id="8176255">rand</span><span class="op" id="8176259">.</span><span class="ident" id="8176260">Intn</span><span class="op" id="8176264">(</span><span class="num" id="8176265">5</span><span class="op" id="8176266">)</span><span class="op" id="8176267">+</span><span class="num" id="8176268">1</span><span class="op" id="8176269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8176272">for</span>&nbsp;<span class="ident" id="8176276">i</span>&nbsp;<span class="op" id="8176278">:=</span>&nbsp;<span class="keyword" id="8176281">range</span>&nbsp;<span class="ident" id="8176287">m</span><span class="op" id="8176288">.</span><span class="ident" id="8176289">supportedCurves</span>&nbsp;<span class="op" id="8176305">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8176309">m</span><span class="op" id="8176310">.</span><span class="ident" id="8176311">supportedCurves</span><span class="op" id="8176326">[</span><span class="ident" id="8176327">i</span><span class="op" id="8176328">]</span>&nbsp;<span class="op" id="8176330">=</span>&nbsp;<span class="ident" id="8176332">CurveID</span><span class="op" id="8176339">(</span><span class="ident" id="8176340">rand</span><span class="op" id="8176344">.</span><span class="ident" id="8176345">Intn</span><span class="op" id="8176349">(</span><span class="num" id="8176350">30000</span><span class="op" id="8176355">)</span><span class="op" id="8176356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8176359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8176362">if</span>&nbsp;<span class="ident" id="8176365">rand</span><span class="op" id="8176369">.</span><span class="ident" id="8176370">Intn</span><span class="op" id="8176374">(</span><span class="num" id="8176375">10</span><span class="op" id="8176377">)</span>&nbsp;<span class="op" id="8176379">&gt;</span>&nbsp;<span class="num" id="8176381">5</span>&nbsp;<span class="op" id="8176383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8176387">m</span><span class="op" id="8176388">.</span><span class="ident" id="8176389">ticketSupported</span>&nbsp;<span class="op" id="8176405">=</span>&nbsp;<span class="builtintype" id="8176407">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8176414">if</span>&nbsp;<span class="ident" id="8176417">rand</span><span class="op" id="8176421">.</span><span class="ident" id="8176422">Intn</span><span class="op" id="8176426">(</span><span class="num" id="8176427">10</span><span class="op" id="8176429">)</span>&nbsp;<span class="op" id="8176431">&gt;</span>&nbsp;<span class="num" id="8176433">5</span>&nbsp;<span class="op" id="8176435">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8176440">m</span><span class="op" id="8176441">.</span><span class="ident" id="8176442">sessionTicket</span>&nbsp;<span class="op" id="8176456">=</span>&nbsp;<span class="ident" id="8176458">randomBytes</span><span class="op" id="8176469">(</span><span class="ident" id="8176470">rand</span><span class="op" id="8176474">.</span><span class="ident" id="8176475">Intn</span><span class="op" id="8176479">(</span><span class="num" id="8176480">300</span><span class="op" id="8176483">)</span><span class="op" id="8176484">,</span>&nbsp;<span class="ident" id="8176486">rand</span><span class="op" id="8176490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8176494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8176497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8176500">if</span>&nbsp;<span class="ident" id="8176503">rand</span><span class="op" id="8176507">.</span><span class="ident" id="8176508">Intn</span><span class="op" id="8176512">(</span><span class="num" id="8176513">10</span><span class="op" id="8176515">)</span>&nbsp;<span class="op" id="8176517">&gt;</span>&nbsp;<span class="num" id="8176519">5</span>&nbsp;<span class="op" id="8176521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8176525">m</span><span class="op" id="8176526">.</span><span class="ident" id="8176527">signatureAndHashes</span>&nbsp;<span class="op" id="8176546">=</span>&nbsp;<span class="ident" id="8176548">supportedSKXSignatureAlgorithms</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8176581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8176584">m</span><span class="op" id="8176585">.</span><span class="ident" id="8176586">alpnProtocols</span>&nbsp;<span class="op" id="8176600">=</span>&nbsp;<span class="builtinfunc" id="8176602">make</span><span class="op" id="8176606">(</span><span class="op" id="8176607">[</span><span class="op" id="8176608">]</span><span class="builtintype" id="8176609">string</span><span class="op" id="8176615">,</span>&nbsp;<span class="ident" id="8176617">rand</span><span class="op" id="8176621">.</span><span class="ident" id="8176622">Intn</span><span class="op" id="8176626">(</span><span class="num" id="8176627">5</span><span class="op" id="8176628">)</span><span class="op" id="8176629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8176632">for</span>&nbsp;<span class="ident" id="8176636">i</span>&nbsp;<span class="op" id="8176638">:=</span>&nbsp;<span class="keyword" id="8176641">range</span>&nbsp;<span class="ident" id="8176647">m</span><span class="op" id="8176648">.</span><span class="ident" id="8176649">alpnProtocols</span>&nbsp;<span class="op" id="8176663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8176667">m</span><span class="op" id="8176668">.</span><span class="ident" id="8176669">alpnProtocols</span><span class="op" id="8176682">[</span><span class="ident" id="8176683">i</span><span class="op" id="8176684">]</span>&nbsp;<span class="op" id="8176686">=</span>&nbsp;<span class="ident" id="8176688">randomString</span><span class="op" id="8176700">(</span><span class="ident" id="8176701">rand</span><span class="op" id="8176705">.</span><span class="ident" id="8176706">Intn</span><span class="op" id="8176710">(</span><span class="num" id="8176711">20</span><span class="op" id="8176713">)</span><span class="op" id="8176714">+</span><span class="num" id="8176715">1</span><span class="op" id="8176716">,</span>&nbsp;<span class="ident" id="8176718">rand</span><span class="op" id="8176722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8176725">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8176729">return</span>&nbsp;<span class="ident" id="8176736">reflect</span><span class="op" id="8176743">.</span><span class="ident" id="8176744">ValueOf</span><span class="op" id="8176751">(</span><span class="ident" id="8176752">m</span><span class="op" id="8176753">)</span><br>
<span class="lineno"></span><span class="op" id="8176755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8176758">func</span>&nbsp;<span class="op" id="8176763">(</span><span class="op" id="8176764">*</span><span class="ident" id="8176765">serverHelloMsg</span><span class="op" id="8176779">)</span>&nbsp;<span class="ident" id="8176781">Generate</span><span class="op" id="8176789">(</span><span class="ident" id="8176790">rand</span>&nbsp;<span class="op" id="8176795">*</span><span class="ident" id="8176796">rand</span><span class="op" id="8176800">.</span><span class="ident" id="8176801">Rand</span><span class="op" id="8176805">,</span>&nbsp;<span class="ident" id="8176807">size</span>&nbsp;<span class="builtintype" id="8176812">int</span><span class="op" id="8176815">)</span>&nbsp;<span class="ident" id="8176817">reflect</span><span class="op" id="8176824">.</span><span class="ident" id="8176825">Value</span>&nbsp;<span class="op" id="8176831">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8176834">m</span>&nbsp;<span class="op" id="8176836">:=</span>&nbsp;<span class="op" id="8176839">&amp;</span><span class="ident" id="8176840">serverHelloMsg</span><span class="op" id="8176854">{</span><span class="op" id="8176855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8176858">m</span><span class="op" id="8176859">.</span><span class="ident" id="8176860">vers</span>&nbsp;<span class="op" id="8176865">=</span>&nbsp;<span class="builtintype" id="8176867">uint16</span><span class="op" id="8176873">(</span><span class="ident" id="8176874">rand</span><span class="op" id="8176878">.</span><span class="ident" id="8176879">Intn</span><span class="op" id="8176883">(</span><span class="num" id="8176884">65536</span><span class="op" id="8176889">)</span><span class="op" id="8176890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8176893">m</span><span class="op" id="8176894">.</span><span class="ident" id="8176895">random</span>&nbsp;<span class="op" id="8176902">=</span>&nbsp;<span class="ident" id="8176904">randomBytes</span><span class="op" id="8176915">(</span><span class="num" id="8176916">32</span><span class="op" id="8176918">,</span>&nbsp;<span class="ident" id="8176920">rand</span><span class="op" id="8176924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8176927">m</span><span class="op" id="8176928">.</span><span class="ident" id="8176929">sessionId</span>&nbsp;<span class="op" id="8176939">=</span>&nbsp;<span class="ident" id="8176941">randomBytes</span><span class="op" id="8176952">(</span><span class="ident" id="8176953">rand</span><span class="op" id="8176957">.</span><span class="ident" id="8176958">Intn</span><span class="op" id="8176962">(</span><span class="num" id="8176963">32</span><span class="op" id="8176965">)</span><span class="op" id="8176966">,</span>&nbsp;<span class="ident" id="8176968">rand</span><span class="op" id="8176972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8176975">m</span><span class="op" id="8176976">.</span><span class="ident" id="8176977">cipherSuite</span>&nbsp;<span class="op" id="8176989">=</span>&nbsp;<span class="builtintype" id="8176991">uint16</span><span class="op" id="8176997">(</span><span class="ident" id="8176998">rand</span><span class="op" id="8177002">.</span><span class="ident" id="8177003">Int31</span><span class="op" id="8177008">(</span><span class="op" id="8177009">)</span><span class="op" id="8177010">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8177013">m</span><span class="op" id="8177014">.</span><span class="ident" id="8177015">compressionMethod</span>&nbsp;<span class="op" id="8177033">=</span>&nbsp;<span class="builtintype" id="8177035">uint8</span><span class="op" id="8177040">(</span><span class="ident" id="8177041">rand</span><span class="op" id="8177045">.</span><span class="ident" id="8177046">Intn</span><span class="op" id="8177050">(</span><span class="num" id="8177051">256</span><span class="op" id="8177054">)</span><span class="op" id="8177055">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8177059">if</span>&nbsp;<span class="ident" id="8177062">rand</span><span class="op" id="8177066">.</span><span class="ident" id="8177067">Intn</span><span class="op" id="8177071">(</span><span class="num" id="8177072">10</span><span class="op" id="8177074">)</span>&nbsp;<span class="op" id="8177076">&gt;</span>&nbsp;<span class="num" id="8177078">5</span>&nbsp;<span class="op" id="8177080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8177084">m</span><span class="op" id="8177085">.</span><span class="ident" id="8177086">nextProtoNeg</span>&nbsp;<span class="op" id="8177099">=</span>&nbsp;<span class="builtintype" id="8177101">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8177109">n</span>&nbsp;<span class="op" id="8177111">:=</span>&nbsp;<span class="ident" id="8177114">rand</span><span class="op" id="8177118">.</span><span class="ident" id="8177119">Intn</span><span class="op" id="8177123">(</span><span class="num" id="8177124">10</span><span class="op" id="8177126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8177130">m</span><span class="op" id="8177131">.</span><span class="ident" id="8177132">nextProtos</span>&nbsp;<span class="op" id="8177143">=</span>&nbsp;<span class="builtinfunc" id="8177145">make</span><span class="op" id="8177149">(</span><span class="op" id="8177150">[</span><span class="op" id="8177151">]</span><span class="builtintype" id="8177152">string</span><span class="op" id="8177158">,</span>&nbsp;<span class="ident" id="8177160">n</span><span class="op" id="8177161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8177165">for</span>&nbsp;<span class="ident" id="8177169">i</span>&nbsp;<span class="op" id="8177171">:=</span>&nbsp;<span class="num" id="8177174">0</span><span class="op" id="8177175">;</span>&nbsp;<span class="ident" id="8177177">i</span>&nbsp;<span class="op" id="8177179">&lt;</span>&nbsp;<span class="ident" id="8177181">n</span><span class="op" id="8177182">;</span>&nbsp;<span class="ident" id="8177184">i</span><span class="op" id="8177185">++</span>&nbsp;<span class="op" id="8177188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8177193">m</span><span class="op" id="8177194">.</span><span class="ident" id="8177195">nextProtos</span><span class="op" id="8177205">[</span><span class="ident" id="8177206">i</span><span class="op" id="8177207">]</span>&nbsp;<span class="op" id="8177209">=</span>&nbsp;<span class="ident" id="8177211">randomString</span><span class="op" id="8177223">(</span><span class="num" id="8177224">20</span><span class="op" id="8177226">,</span>&nbsp;<span class="ident" id="8177228">rand</span><span class="op" id="8177232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177236">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8177243">if</span>&nbsp;<span class="ident" id="8177246">rand</span><span class="op" id="8177250">.</span><span class="ident" id="8177251">Intn</span><span class="op" id="8177255">(</span><span class="num" id="8177256">10</span><span class="op" id="8177258">)</span>&nbsp;<span class="op" id="8177260">&gt;</span>&nbsp;<span class="num" id="8177262">5</span>&nbsp;<span class="op" id="8177264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8177268">m</span><span class="op" id="8177269">.</span><span class="ident" id="8177270">ocspStapling</span>&nbsp;<span class="op" id="8177283">=</span>&nbsp;<span class="builtintype" id="8177285">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177291">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8177294">if</span>&nbsp;<span class="ident" id="8177297">rand</span><span class="op" id="8177301">.</span><span class="ident" id="8177302">Intn</span><span class="op" id="8177306">(</span><span class="num" id="8177307">10</span><span class="op" id="8177309">)</span>&nbsp;<span class="op" id="8177311">&gt;</span>&nbsp;<span class="num" id="8177313">5</span>&nbsp;<span class="op" id="8177315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8177319">m</span><span class="op" id="8177320">.</span><span class="ident" id="8177321">ticketSupported</span>&nbsp;<span class="op" id="8177337">=</span>&nbsp;<span class="builtintype" id="8177339">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8177348">m</span><span class="op" id="8177349">.</span><span class="ident" id="8177350">alpnProtocol</span>&nbsp;<span class="op" id="8177363">=</span>&nbsp;<span class="ident" id="8177365">randomString</span><span class="op" id="8177377">(</span><span class="ident" id="8177378">rand</span><span class="op" id="8177382">.</span><span class="ident" id="8177383">Intn</span><span class="op" id="8177387">(</span><span class="num" id="8177388">32</span><span class="op" id="8177390">)</span><span class="op" id="8177391">+</span><span class="num" id="8177392">1</span><span class="op" id="8177393">,</span>&nbsp;<span class="ident" id="8177395">rand</span><span class="op" id="8177399">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8177403">return</span>&nbsp;<span class="ident" id="8177410">reflect</span><span class="op" id="8177417">.</span><span class="ident" id="8177418">ValueOf</span><span class="op" id="8177425">(</span><span class="ident" id="8177426">m</span><span class="op" id="8177427">)</span><br>
<span class="lineno"></span><span class="op" id="8177429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8177432">func</span>&nbsp;<span class="op" id="8177437">(</span><span class="op" id="8177438">*</span><span class="ident" id="8177439">certificateMsg</span><span class="op" id="8177453">)</span>&nbsp;<span class="ident" id="8177455">Generate</span><span class="op" id="8177463">(</span><span class="ident" id="8177464">rand</span>&nbsp;<span class="op" id="8177469">*</span><span class="ident" id="8177470">rand</span><span class="op" id="8177474">.</span><span class="ident" id="8177475">Rand</span><span class="op" id="8177479">,</span>&nbsp;<span class="ident" id="8177481">size</span>&nbsp;<span class="builtintype" id="8177486">int</span><span class="op" id="8177489">)</span>&nbsp;<span class="ident" id="8177491">reflect</span><span class="op" id="8177498">.</span><span class="ident" id="8177499">Value</span>&nbsp;<span class="op" id="8177505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8177508">m</span>&nbsp;<span class="op" id="8177510">:=</span>&nbsp;<span class="op" id="8177513">&amp;</span><span class="ident" id="8177514">certificateMsg</span><span class="op" id="8177528">{</span><span class="op" id="8177529">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8177532">numCerts</span>&nbsp;<span class="op" id="8177541">:=</span>&nbsp;<span class="ident" id="8177544">rand</span><span class="op" id="8177548">.</span><span class="ident" id="8177549">Intn</span><span class="op" id="8177553">(</span><span class="num" id="8177554">20</span><span class="op" id="8177556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8177559">m</span><span class="op" id="8177560">.</span><span class="ident" id="8177561">certificates</span>&nbsp;<span class="op" id="8177574">=</span>&nbsp;<span class="builtinfunc" id="8177576">make</span><span class="op" id="8177580">(</span><span class="op" id="8177581">[</span><span class="op" id="8177582">]</span><span class="op" id="8177583">[</span><span class="op" id="8177584">]</span><span class="builtintype" id="8177585">byte</span><span class="op" id="8177589">,</span>&nbsp;<span class="ident" id="8177591">numCerts</span><span class="op" id="8177599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8177602">for</span>&nbsp;<span class="ident" id="8177606">i</span>&nbsp;<span class="op" id="8177608">:=</span>&nbsp;<span class="num" id="8177611">0</span><span class="op" id="8177612">;</span>&nbsp;<span class="ident" id="8177614">i</span>&nbsp;<span class="op" id="8177616">&lt;</span>&nbsp;<span class="ident" id="8177618">numCerts</span><span class="op" id="8177626">;</span>&nbsp;<span class="ident" id="8177628">i</span><span class="op" id="8177629">++</span>&nbsp;<span class="op" id="8177632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8177636">m</span><span class="op" id="8177637">.</span><span class="ident" id="8177638">certificates</span><span class="op" id="8177650">[</span><span class="ident" id="8177651">i</span><span class="op" id="8177652">]</span>&nbsp;<span class="op" id="8177654">=</span>&nbsp;<span class="ident" id="8177656">randomBytes</span><span class="op" id="8177667">(</span><span class="ident" id="8177668">rand</span><span class="op" id="8177672">.</span><span class="ident" id="8177673">Intn</span><span class="op" id="8177677">(</span><span class="num" id="8177678">10</span><span class="op" id="8177680">)</span><span class="op" id="8177681">+</span><span class="num" id="8177682">1</span><span class="op" id="8177683">,</span>&nbsp;<span class="ident" id="8177685">rand</span><span class="op" id="8177689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8177692">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8177695">return</span>&nbsp;<span class="ident" id="8177702">reflect</span><span class="op" id="8177709">.</span><span class="ident" id="8177710">ValueOf</span><span class="op" id="8177717">(</span><span class="ident" id="8177718">m</span><span class="op" id="8177719">)</span><br>
<span class="lineno"></span><span class="op" id="8177721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8177724">func</span>&nbsp;<span class="op" id="8177729">(</span><span class="op" id="8177730">*</span><span class="ident" id="8177731">certificateRequestMsg</span><span class="op" id="8177752">)</span>&nbsp;<span class="ident" id="8177754">Generate</span><span class="op" id="8177762">(</span><span class="ident" id="8177763">rand</span>&nbsp;<span class="op" id="8177768">*</span><span class="ident" id="8177769">rand</span><span class="op" id="8177773">.</span><span class="ident" id="8177774">Rand</span><span class="op" id="8177778">,</span>&nbsp;<span class="ident" id="8177780">size</span>&nbsp;<span class="builtintype" id="8177785">int</span><span class="op" id="8177788">)</span>&nbsp;<span class="ident" id="8177790">reflect</span><span class="op" id="8177797">.</span><span class="ident" id="8177798">Value</span>&nbsp;<span class="op" id="8177804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8177807">m</span>&nbsp;<span class="op" id="8177809">:=</span>&nbsp;<span class="op" id="8177812">&amp;</span><span class="ident" id="8177813">certificateRequestMsg</span><span class="op" id="8177834">{</span><span class="op" id="8177835">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8177838">m</span><span class="op" id="8177839">.</span><span class="ident" id="8177840">certificateTypes</span>&nbsp;<span class="op" id="8177857">=</span>&nbsp;<span class="ident" id="8177859">randomBytes</span><span class="op" id="8177870">(</span><span class="ident" id="8177871">rand</span><span class="op" id="8177875">.</span><span class="ident" id="8177876">Intn</span><span class="op" id="8177880">(</span><span class="num" id="8177881">5</span><span class="op" id="8177882">)</span><span class="op" id="8177883">+</span><span class="num" id="8177884">1</span><span class="op" id="8177885">,</span>&nbsp;<span class="ident" id="8177887">rand</span><span class="op" id="8177891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8177894">numCAs</span>&nbsp;<span class="op" id="8177901">:=</span>&nbsp;<span class="ident" id="8177904">rand</span><span class="op" id="8177908">.</span><span class="ident" id="8177909">Intn</span><span class="op" id="8177913">(</span><span class="num" id="8177914">100</span><span class="op" id="8177917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8177920">m</span><span class="op" id="8177921">.</span><span class="ident" id="8177922">certificateAuthorities</span>&nbsp;<span class="op" id="8177945">=</span>&nbsp;<span class="builtinfunc" id="8177947">make</span><span class="op" id="8177951">(</span><span class="op" id="8177952">[</span><span class="op" id="8177953">]</span><span class="op" id="8177954">[</span><span class="op" id="8177955">]</span><span class="builtintype" id="8177956">byte</span><span class="op" id="8177960">,</span>&nbsp;<span class="ident" id="8177962">numCAs</span><span class="op" id="8177968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8177971">for</span>&nbsp;<span class="ident" id="8177975">i</span>&nbsp;<span class="op" id="8177977">:=</span>&nbsp;<span class="num" id="8177980">0</span><span class="op" id="8177981">;</span>&nbsp;<span class="ident" id="8177983">i</span>&nbsp;<span class="op" id="8177985">&lt;</span>&nbsp;<span class="ident" id="8177987">numCAs</span><span class="op" id="8177993">;</span>&nbsp;<span class="ident" id="8177995">i</span><span class="op" id="8177996">++</span>&nbsp;<span class="op" id="8177999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178003">m</span><span class="op" id="8178004">.</span><span class="ident" id="8178005">certificateAuthorities</span><span class="op" id="8178027">[</span><span class="ident" id="8178028">i</span><span class="op" id="8178029">]</span>&nbsp;<span class="op" id="8178031">=</span>&nbsp;<span class="ident" id="8178033">randomBytes</span><span class="op" id="8178044">(</span><span class="ident" id="8178045">rand</span><span class="op" id="8178049">.</span><span class="ident" id="8178050">Intn</span><span class="op" id="8178054">(</span><span class="num" id="8178055">15</span><span class="op" id="8178057">)</span><span class="op" id="8178058">+</span><span class="num" id="8178059">1</span><span class="op" id="8178060">,</span>&nbsp;<span class="ident" id="8178062">rand</span><span class="op" id="8178066">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8178069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8178072">return</span>&nbsp;<span class="ident" id="8178079">reflect</span><span class="op" id="8178086">.</span><span class="ident" id="8178087">ValueOf</span><span class="op" id="8178094">(</span><span class="ident" id="8178095">m</span><span class="op" id="8178096">)</span><br>
<span class="lineno"></span><span class="op" id="8178098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8178101">func</span>&nbsp;<span class="op" id="8178106">(</span><span class="op" id="8178107">*</span><span class="ident" id="8178108">certificateVerifyMsg</span><span class="op" id="8178128">)</span>&nbsp;<span class="ident" id="8178130">Generate</span><span class="op" id="8178138">(</span><span class="ident" id="8178139">rand</span>&nbsp;<span class="op" id="8178144">*</span><span class="ident" id="8178145">rand</span><span class="op" id="8178149">.</span><span class="ident" id="8178150">Rand</span><span class="op" id="8178154">,</span>&nbsp;<span class="ident" id="8178156">size</span>&nbsp;<span class="builtintype" id="8178161">int</span><span class="op" id="8178164">)</span>&nbsp;<span class="ident" id="8178166">reflect</span><span class="op" id="8178173">.</span><span class="ident" id="8178174">Value</span>&nbsp;<span class="op" id="8178180">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178183">m</span>&nbsp;<span class="op" id="8178185">:=</span>&nbsp;<span class="op" id="8178188">&amp;</span><span class="ident" id="8178189">certificateVerifyMsg</span><span class="op" id="8178209">{</span><span class="op" id="8178210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178213">m</span><span class="op" id="8178214">.</span><span class="ident" id="8178215">signature</span>&nbsp;<span class="op" id="8178225">=</span>&nbsp;<span class="ident" id="8178227">randomBytes</span><span class="op" id="8178238">(</span><span class="ident" id="8178239">rand</span><span class="op" id="8178243">.</span><span class="ident" id="8178244">Intn</span><span class="op" id="8178248">(</span><span class="num" id="8178249">15</span><span class="op" id="8178251">)</span><span class="op" id="8178252">+</span><span class="num" id="8178253">1</span><span class="op" id="8178254">,</span>&nbsp;<span class="ident" id="8178256">rand</span><span class="op" id="8178260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8178263">return</span>&nbsp;<span class="ident" id="8178270">reflect</span><span class="op" id="8178277">.</span><span class="ident" id="8178278">ValueOf</span><span class="op" id="8178285">(</span><span class="ident" id="8178286">m</span><span class="op" id="8178287">)</span><br>
<span class="lineno"></span><span class="op" id="8178289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="keyword" id="8178292">func</span>&nbsp;<span class="op" id="8178297">(</span><span class="op" id="8178298">*</span><span class="ident" id="8178299">certificateStatusMsg</span><span class="op" id="8178319">)</span>&nbsp;<span class="ident" id="8178321">Generate</span><span class="op" id="8178329">(</span><span class="ident" id="8178330">rand</span>&nbsp;<span class="op" id="8178335">*</span><span class="ident" id="8178336">rand</span><span class="op" id="8178340">.</span><span class="ident" id="8178341">Rand</span><span class="op" id="8178345">,</span>&nbsp;<span class="ident" id="8178347">size</span>&nbsp;<span class="builtintype" id="8178352">int</span><span class="op" id="8178355">)</span>&nbsp;<span class="ident" id="8178357">reflect</span><span class="op" id="8178364">.</span><span class="ident" id="8178365">Value</span>&nbsp;<span class="op" id="8178371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178374">m</span>&nbsp;<span class="op" id="8178376">:=</span>&nbsp;<span class="op" id="8178379">&amp;</span><span class="ident" id="8178380">certificateStatusMsg</span><span class="op" id="8178400">{</span><span class="op" id="8178401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8178404">if</span>&nbsp;<span class="ident" id="8178407">rand</span><span class="op" id="8178411">.</span><span class="ident" id="8178412">Intn</span><span class="op" id="8178416">(</span><span class="num" id="8178417">10</span><span class="op" id="8178419">)</span>&nbsp;<span class="op" id="8178421">&gt;</span>&nbsp;<span class="num" id="8178423">5</span>&nbsp;<span class="op" id="8178425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178429">m</span><span class="op" id="8178430">.</span><span class="ident" id="8178431">statusType</span>&nbsp;<span class="op" id="8178442">=</span>&nbsp;<span class="ident" id="8178444">statusTypeOCSP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178461">m</span><span class="op" id="8178462">.</span><span class="ident" id="8178463">response</span>&nbsp;<span class="op" id="8178472">=</span>&nbsp;<span class="ident" id="8178474">randomBytes</span><span class="op" id="8178485">(</span><span class="ident" id="8178486">rand</span><span class="op" id="8178490">.</span><span class="ident" id="8178491">Intn</span><span class="op" id="8178495">(</span><span class="num" id="8178496">10</span><span class="op" id="8178498">)</span><span class="op" id="8178499">+</span><span class="num" id="8178500">1</span><span class="op" id="8178501">,</span>&nbsp;<span class="ident" id="8178503">rand</span><span class="op" id="8178507">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8178510">}</span>&nbsp;<span class="keyword" id="8178512">else</span>&nbsp;<span class="op" id="8178517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178521">m</span><span class="op" id="8178522">.</span><span class="ident" id="8178523">statusType</span>&nbsp;<span class="op" id="8178534">=</span>&nbsp;<span class="num" id="8178536">42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8178540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8178543">return</span>&nbsp;<span class="ident" id="8178550">reflect</span><span class="op" id="8178557">.</span><span class="ident" id="8178558">ValueOf</span><span class="op" id="8178565">(</span><span class="ident" id="8178566">m</span><span class="op" id="8178567">)</span><br>
<span class="lineno"></span><span class="op" id="8178569">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="8178572">func</span>&nbsp;<span class="op" id="8178577">(</span><span class="op" id="8178578">*</span><span class="ident" id="8178579">clientKeyExchangeMsg</span><span class="op" id="8178599">)</span>&nbsp;<span class="ident" id="8178601">Generate</span><span class="op" id="8178609">(</span><span class="ident" id="8178610">rand</span>&nbsp;<span class="op" id="8178615">*</span><span class="ident" id="8178616">rand</span><span class="op" id="8178620">.</span><span class="ident" id="8178621">Rand</span><span class="op" id="8178625">,</span>&nbsp;<span class="ident" id="8178627">size</span>&nbsp;<span class="builtintype" id="8178632">int</span><span class="op" id="8178635">)</span>&nbsp;<span class="ident" id="8178637">reflect</span><span class="op" id="8178644">.</span><span class="ident" id="8178645">Value</span>&nbsp;<span class="op" id="8178651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178654">m</span>&nbsp;<span class="op" id="8178656">:=</span>&nbsp;<span class="op" id="8178659">&amp;</span><span class="ident" id="8178660">clientKeyExchangeMsg</span><span class="op" id="8178680">{</span><span class="op" id="8178681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178684">m</span><span class="op" id="8178685">.</span><span class="ident" id="8178686">ciphertext</span>&nbsp;<span class="op" id="8178697">=</span>&nbsp;<span class="ident" id="8178699">randomBytes</span><span class="op" id="8178710">(</span><span class="ident" id="8178711">rand</span><span class="op" id="8178715">.</span><span class="ident" id="8178716">Intn</span><span class="op" id="8178720">(</span><span class="num" id="8178721">1000</span><span class="op" id="8178725">)</span><span class="op" id="8178726">+</span><span class="num" id="8178727">1</span><span class="op" id="8178728">,</span>&nbsp;<span class="ident" id="8178730">rand</span><span class="op" id="8178734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8178737">return</span>&nbsp;<span class="ident" id="8178744">reflect</span><span class="op" id="8178751">.</span><span class="ident" id="8178752">ValueOf</span><span class="op" id="8178759">(</span><span class="ident" id="8178760">m</span><span class="op" id="8178761">)</span><br>
<span class="lineno">220</span><span class="op" id="8178763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8178766">func</span>&nbsp;<span class="op" id="8178771">(</span><span class="op" id="8178772">*</span><span class="ident" id="8178773">finishedMsg</span><span class="op" id="8178784">)</span>&nbsp;<span class="ident" id="8178786">Generate</span><span class="op" id="8178794">(</span><span class="ident" id="8178795">rand</span>&nbsp;<span class="op" id="8178800">*</span><span class="ident" id="8178801">rand</span><span class="op" id="8178805">.</span><span class="ident" id="8178806">Rand</span><span class="op" id="8178810">,</span>&nbsp;<span class="ident" id="8178812">size</span>&nbsp;<span class="builtintype" id="8178817">int</span><span class="op" id="8178820">)</span>&nbsp;<span class="ident" id="8178822">reflect</span><span class="op" id="8178829">.</span><span class="ident" id="8178830">Value</span>&nbsp;<span class="op" id="8178836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178839">m</span>&nbsp;<span class="op" id="8178841">:=</span>&nbsp;<span class="op" id="8178844">&amp;</span><span class="ident" id="8178845">finishedMsg</span><span class="op" id="8178856">{</span><span class="op" id="8178857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178860">m</span><span class="op" id="8178861">.</span><span class="ident" id="8178862">verifyData</span>&nbsp;<span class="op" id="8178873">=</span>&nbsp;<span class="ident" id="8178875">randomBytes</span><span class="op" id="8178886">(</span><span class="num" id="8178887">12</span><span class="op" id="8178889">,</span>&nbsp;<span class="ident" id="8178891">rand</span><span class="op" id="8178895">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8178898">return</span>&nbsp;<span class="ident" id="8178905">reflect</span><span class="op" id="8178912">.</span><span class="ident" id="8178913">ValueOf</span><span class="op" id="8178920">(</span><span class="ident" id="8178921">m</span><span class="op" id="8178922">)</span><br>
<span class="lineno"></span><span class="op" id="8178924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8178927">func</span>&nbsp;<span class="op" id="8178932">(</span><span class="op" id="8178933">*</span><span class="ident" id="8178934">nextProtoMsg</span><span class="op" id="8178946">)</span>&nbsp;<span class="ident" id="8178948">Generate</span><span class="op" id="8178956">(</span><span class="ident" id="8178957">rand</span>&nbsp;<span class="op" id="8178962">*</span><span class="ident" id="8178963">rand</span><span class="op" id="8178967">.</span><span class="ident" id="8178968">Rand</span><span class="op" id="8178972">,</span>&nbsp;<span class="ident" id="8178974">size</span>&nbsp;<span class="builtintype" id="8178979">int</span><span class="op" id="8178982">)</span>&nbsp;<span class="ident" id="8178984">reflect</span><span class="op" id="8178991">.</span><span class="ident" id="8178992">Value</span>&nbsp;<span class="op" id="8178998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179001">m</span>&nbsp;<span class="op" id="8179003">:=</span>&nbsp;<span class="op" id="8179006">&amp;</span><span class="ident" id="8179007">nextProtoMsg</span><span class="op" id="8179019">{</span><span class="op" id="8179020">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179023">m</span><span class="op" id="8179024">.</span><span class="ident" id="8179025">proto</span>&nbsp;<span class="op" id="8179031">=</span>&nbsp;<span class="ident" id="8179033">randomString</span><span class="op" id="8179045">(</span><span class="ident" id="8179046">rand</span><span class="op" id="8179050">.</span><span class="ident" id="8179051">Intn</span><span class="op" id="8179055">(</span><span class="num" id="8179056">255</span><span class="op" id="8179059">)</span><span class="op" id="8179060">,</span>&nbsp;<span class="ident" id="8179062">rand</span><span class="op" id="8179066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8179069">return</span>&nbsp;<span class="ident" id="8179076">reflect</span><span class="op" id="8179083">.</span><span class="ident" id="8179084">ValueOf</span><span class="op" id="8179091">(</span><span class="ident" id="8179092">m</span><span class="op" id="8179093">)</span><br>
<span class="lineno"></span><span class="op" id="8179095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8179098">func</span>&nbsp;<span class="op" id="8179103">(</span><span class="op" id="8179104">*</span><span class="ident" id="8179105">newSessionTicketMsg</span><span class="op" id="8179124">)</span>&nbsp;<span class="ident" id="8179126">Generate</span><span class="op" id="8179134">(</span><span class="ident" id="8179135">rand</span>&nbsp;<span class="op" id="8179140">*</span><span class="ident" id="8179141">rand</span><span class="op" id="8179145">.</span><span class="ident" id="8179146">Rand</span><span class="op" id="8179150">,</span>&nbsp;<span class="ident" id="8179152">size</span>&nbsp;<span class="builtintype" id="8179157">int</span><span class="op" id="8179160">)</span>&nbsp;<span class="ident" id="8179162">reflect</span><span class="op" id="8179169">.</span><span class="ident" id="8179170">Value</span>&nbsp;<span class="op" id="8179176">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179179">m</span>&nbsp;<span class="op" id="8179181">:=</span>&nbsp;<span class="op" id="8179184">&amp;</span><span class="ident" id="8179185">newSessionTicketMsg</span><span class="op" id="8179204">{</span><span class="op" id="8179205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179208">m</span><span class="op" id="8179209">.</span><span class="ident" id="8179210">ticket</span>&nbsp;<span class="op" id="8179217">=</span>&nbsp;<span class="ident" id="8179219">randomBytes</span><span class="op" id="8179230">(</span><span class="ident" id="8179231">rand</span><span class="op" id="8179235">.</span><span class="ident" id="8179236">Intn</span><span class="op" id="8179240">(</span><span class="num" id="8179241">4</span><span class="op" id="8179242">)</span><span class="op" id="8179243">,</span>&nbsp;<span class="ident" id="8179245">rand</span><span class="op" id="8179249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8179252">return</span>&nbsp;<span class="ident" id="8179259">reflect</span><span class="op" id="8179266">.</span><span class="ident" id="8179267">ValueOf</span><span class="op" id="8179274">(</span><span class="ident" id="8179275">m</span><span class="op" id="8179276">)</span><br>
<span class="lineno"></span><span class="op" id="8179278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="8179281">func</span>&nbsp;<span class="op" id="8179286">(</span><span class="op" id="8179287">*</span><span class="ident" id="8179288">sessionState</span><span class="op" id="8179300">)</span>&nbsp;<span class="ident" id="8179302">Generate</span><span class="op" id="8179310">(</span><span class="ident" id="8179311">rand</span>&nbsp;<span class="op" id="8179316">*</span><span class="ident" id="8179317">rand</span><span class="op" id="8179321">.</span><span class="ident" id="8179322">Rand</span><span class="op" id="8179326">,</span>&nbsp;<span class="ident" id="8179328">size</span>&nbsp;<span class="builtintype" id="8179333">int</span><span class="op" id="8179336">)</span>&nbsp;<span class="ident" id="8179338">reflect</span><span class="op" id="8179345">.</span><span class="ident" id="8179346">Value</span>&nbsp;<span class="op" id="8179352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179355">s</span>&nbsp;<span class="op" id="8179357">:=</span>&nbsp;<span class="op" id="8179360">&amp;</span><span class="ident" id="8179361">sessionState</span><span class="op" id="8179373">{</span><span class="op" id="8179374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179377">s</span><span class="op" id="8179378">.</span><span class="ident" id="8179379">vers</span>&nbsp;<span class="op" id="8179384">=</span>&nbsp;<span class="builtintype" id="8179386">uint16</span><span class="op" id="8179392">(</span><span class="ident" id="8179393">rand</span><span class="op" id="8179397">.</span><span class="ident" id="8179398">Intn</span><span class="op" id="8179402">(</span><span class="num" id="8179403">10000</span><span class="op" id="8179408">)</span><span class="op" id="8179409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179412">s</span><span class="op" id="8179413">.</span><span class="ident" id="8179414">cipherSuite</span>&nbsp;<span class="op" id="8179426">=</span>&nbsp;<span class="builtintype" id="8179428">uint16</span><span class="op" id="8179434">(</span><span class="ident" id="8179435">rand</span><span class="op" id="8179439">.</span><span class="ident" id="8179440">Intn</span><span class="op" id="8179444">(</span><span class="num" id="8179445">10000</span><span class="op" id="8179450">)</span><span class="op" id="8179451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179454">s</span><span class="op" id="8179455">.</span><span class="ident" id="8179456">masterSecret</span>&nbsp;<span class="op" id="8179469">=</span>&nbsp;<span class="ident" id="8179471">randomBytes</span><span class="op" id="8179482">(</span><span class="ident" id="8179483">rand</span><span class="op" id="8179487">.</span><span class="ident" id="8179488">Intn</span><span class="op" id="8179492">(</span><span class="num" id="8179493">100</span><span class="op" id="8179496">)</span><span class="op" id="8179497">,</span>&nbsp;<span class="ident" id="8179499">rand</span><span class="op" id="8179503">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179506">numCerts</span>&nbsp;<span class="op" id="8179515">:=</span>&nbsp;<span class="ident" id="8179518">rand</span><span class="op" id="8179522">.</span><span class="ident" id="8179523">Intn</span><span class="op" id="8179527">(</span><span class="num" id="8179528">20</span><span class="op" id="8179530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179533">s</span><span class="op" id="8179534">.</span><span class="ident" id="8179535">certificates</span>&nbsp;<span class="op" id="8179548">=</span>&nbsp;<span class="builtinfunc" id="8179550">make</span><span class="op" id="8179554">(</span><span class="op" id="8179555">[</span><span class="op" id="8179556">]</span><span class="op" id="8179557">[</span><span class="op" id="8179558">]</span><span class="builtintype" id="8179559">byte</span><span class="op" id="8179563">,</span>&nbsp;<span class="ident" id="8179565">numCerts</span><span class="op" id="8179573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8179576">for</span>&nbsp;<span class="ident" id="8179580">i</span>&nbsp;<span class="op" id="8179582">:=</span>&nbsp;<span class="num" id="8179585">0</span><span class="op" id="8179586">;</span>&nbsp;<span class="ident" id="8179588">i</span>&nbsp;<span class="op" id="8179590">&lt;</span>&nbsp;<span class="ident" id="8179592">numCerts</span><span class="op" id="8179600">;</span>&nbsp;<span class="ident" id="8179602">i</span><span class="op" id="8179603">++</span>&nbsp;<span class="op" id="8179606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179610">s</span><span class="op" id="8179611">.</span><span class="ident" id="8179612">certificates</span><span class="op" id="8179624">[</span><span class="ident" id="8179625">i</span><span class="op" id="8179626">]</span>&nbsp;<span class="op" id="8179628">=</span>&nbsp;<span class="ident" id="8179630">randomBytes</span><span class="op" id="8179641">(</span><span class="ident" id="8179642">rand</span><span class="op" id="8179646">.</span><span class="ident" id="8179647">Intn</span><span class="op" id="8179651">(</span><span class="num" id="8179652">10</span><span class="op" id="8179654">)</span><span class="op" id="8179655">+</span><span class="num" id="8179656">1</span><span class="op" id="8179657">,</span>&nbsp;<span class="ident" id="8179659">rand</span><span class="op" id="8179663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8179666">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8179669">return</span>&nbsp;<span class="ident" id="8179676">reflect</span><span class="op" id="8179683">.</span><span class="ident" id="8179684">ValueOf</span><span class="op" id="8179691">(</span><span class="ident" id="8179692">s</span><span class="op" id="8179693">)</span><br>
<span class="lineno"></span><span class="op" id="8179695">}</span>
</div>
</body>
</html>
