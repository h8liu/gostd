<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html" class="current">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8250571">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8250626">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8250680">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8250731">package</span>&nbsp;<span class="ident" id="8250739">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8250744">import</span>&nbsp;<span class="op" id="8250751">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8250754">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8250764">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="8250767">func</span>&nbsp;<span class="ident" id="8250772">TestRoundUp</span><span class="op" id="8250783">(</span><span class="ident" id="8250784">t</span>&nbsp;<span class="op" id="8250786">*</span><span class="ident" id="8250787">testing</span><span class="op" id="8250794">.</span><span class="ident" id="8250795">T</span><span class="op" id="8250796">)</span>&nbsp;<span class="op" id="8250798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8250801">if</span>&nbsp;<span class="ident" id="8250804">roundUp</span><span class="op" id="8250811">(</span><span class="num" id="8250812">0</span><span class="op" id="8250813">,</span>&nbsp;<span class="num" id="8250815">16</span><span class="op" id="8250817">)</span>&nbsp;<span class="op" id="8250819">!=</span>&nbsp;<span class="num" id="8250822">0</span>&nbsp;<span class="op" id="8250824">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8250829">roundUp</span><span class="op" id="8250836">(</span><span class="num" id="8250837">1</span><span class="op" id="8250838">,</span>&nbsp;<span class="num" id="8250840">16</span><span class="op" id="8250842">)</span>&nbsp;<span class="op" id="8250844">!=</span>&nbsp;<span class="num" id="8250847">16</span>&nbsp;<span class="op" id="8250850">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8250855">roundUp</span><span class="op" id="8250862">(</span><span class="num" id="8250863">15</span><span class="op" id="8250865">,</span>&nbsp;<span class="num" id="8250867">16</span><span class="op" id="8250869">)</span>&nbsp;<span class="op" id="8250871">!=</span>&nbsp;<span class="num" id="8250874">16</span>&nbsp;<span class="op" id="8250877">||</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8250882">roundUp</span><span class="op" id="8250889">(</span><span class="num" id="8250890">16</span><span class="op" id="8250892">,</span>&nbsp;<span class="num" id="8250894">16</span><span class="op" id="8250896">)</span>&nbsp;<span class="op" id="8250898">!=</span>&nbsp;<span class="num" id="8250901">16</span>&nbsp;<span class="op" id="8250904">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8250909">roundUp</span><span class="op" id="8250916">(</span><span class="num" id="8250917">17</span><span class="op" id="8250919">,</span>&nbsp;<span class="num" id="8250921">16</span><span class="op" id="8250923">)</span>&nbsp;<span class="op" id="8250925">!=</span>&nbsp;<span class="num" id="8250928">32</span>&nbsp;<span class="op" id="8250931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8250935">t</span><span class="op" id="8250936">.</span><span class="ident" id="8250937">Error</span><span class="op" id="8250942">(</span><span class="string" id="8250943">&#34;roundUp&nbsp;broken&#34;</span><span class="op" id="8250959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8250962">}</span><br>
<span class="lineno"></span><span class="op" id="8250964">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="8250967">var</span>&nbsp;<span class="ident" id="8250971">paddingTests</span>&nbsp;<span class="op" id="8250984">=</span>&nbsp;<span class="op" id="8250986">[</span><span class="op" id="8250987">]</span><span class="keyword" id="8250988">struct</span>&nbsp;<span class="op" id="8250995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8250998">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8251010">[</span><span class="op" id="8251011">]</span><span class="builtintype" id="8251012">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251018">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8251030">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251036">expectedLen</span>&nbsp;<span class="builtintype" id="8251048">int</span><br>
<span class="lineno">25</span><span class="op" id="8251052">}</span><span class="op" id="8251053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251056">{</span><span class="op" id="8251057">[</span><span class="op" id="8251058">]</span><span class="builtintype" id="8251059">byte</span><span class="op" id="8251063">{</span><span class="num" id="8251064">1</span><span class="op" id="8251065">,</span>&nbsp;<span class="num" id="8251067">2</span><span class="op" id="8251068">,</span>&nbsp;<span class="num" id="8251070">3</span><span class="op" id="8251071">,</span>&nbsp;<span class="num" id="8251073">4</span><span class="op" id="8251074">,</span>&nbsp;<span class="num" id="8251076">0</span><span class="op" id="8251077">}</span><span class="op" id="8251078">,</span>&nbsp;<span class="builtintype" id="8251080">true</span><span class="op" id="8251084">,</span>&nbsp;<span class="num" id="8251086">4</span><span class="op" id="8251087">}</span><span class="op" id="8251088">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251091">{</span><span class="op" id="8251092">[</span><span class="op" id="8251093">]</span><span class="builtintype" id="8251094">byte</span><span class="op" id="8251098">{</span><span class="num" id="8251099">1</span><span class="op" id="8251100">,</span>&nbsp;<span class="num" id="8251102">2</span><span class="op" id="8251103">,</span>&nbsp;<span class="num" id="8251105">3</span><span class="op" id="8251106">,</span>&nbsp;<span class="num" id="8251108">4</span><span class="op" id="8251109">,</span>&nbsp;<span class="num" id="8251111">0</span><span class="op" id="8251112">,</span>&nbsp;<span class="num" id="8251114">1</span><span class="op" id="8251115">}</span><span class="op" id="8251116">,</span>&nbsp;<span class="builtintype" id="8251118">false</span><span class="op" id="8251123">,</span>&nbsp;<span class="num" id="8251125">0</span><span class="op" id="8251126">}</span><span class="op" id="8251127">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251130">{</span><span class="op" id="8251131">[</span><span class="op" id="8251132">]</span><span class="builtintype" id="8251133">byte</span><span class="op" id="8251137">{</span><span class="num" id="8251138">1</span><span class="op" id="8251139">,</span>&nbsp;<span class="num" id="8251141">2</span><span class="op" id="8251142">,</span>&nbsp;<span class="num" id="8251144">3</span><span class="op" id="8251145">,</span>&nbsp;<span class="num" id="8251147">4</span><span class="op" id="8251148">,</span>&nbsp;<span class="num" id="8251150">99</span><span class="op" id="8251152">,</span>&nbsp;<span class="num" id="8251154">99</span><span class="op" id="8251156">}</span><span class="op" id="8251157">,</span>&nbsp;<span class="builtintype" id="8251159">false</span><span class="op" id="8251164">,</span>&nbsp;<span class="num" id="8251166">0</span><span class="op" id="8251167">}</span><span class="op" id="8251168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251171">{</span><span class="op" id="8251172">[</span><span class="op" id="8251173">]</span><span class="builtintype" id="8251174">byte</span><span class="op" id="8251178">{</span><span class="num" id="8251179">1</span><span class="op" id="8251180">,</span>&nbsp;<span class="num" id="8251182">2</span><span class="op" id="8251183">,</span>&nbsp;<span class="num" id="8251185">3</span><span class="op" id="8251186">,</span>&nbsp;<span class="num" id="8251188">4</span><span class="op" id="8251189">,</span>&nbsp;<span class="num" id="8251191">1</span><span class="op" id="8251192">,</span>&nbsp;<span class="num" id="8251194">1</span><span class="op" id="8251195">}</span><span class="op" id="8251196">,</span>&nbsp;<span class="builtintype" id="8251198">true</span><span class="op" id="8251202">,</span>&nbsp;<span class="num" id="8251204">4</span><span class="op" id="8251205">}</span><span class="op" id="8251206">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251209">{</span><span class="op" id="8251210">[</span><span class="op" id="8251211">]</span><span class="builtintype" id="8251212">byte</span><span class="op" id="8251216">{</span><span class="num" id="8251217">1</span><span class="op" id="8251218">,</span>&nbsp;<span class="num" id="8251220">2</span><span class="op" id="8251221">,</span>&nbsp;<span class="num" id="8251223">3</span><span class="op" id="8251224">,</span>&nbsp;<span class="num" id="8251226">2</span><span class="op" id="8251227">,</span>&nbsp;<span class="num" id="8251229">2</span><span class="op" id="8251230">,</span>&nbsp;<span class="num" id="8251232">2</span><span class="op" id="8251233">}</span><span class="op" id="8251234">,</span>&nbsp;<span class="builtintype" id="8251236">true</span><span class="op" id="8251240">,</span>&nbsp;<span class="num" id="8251242">3</span><span class="op" id="8251243">}</span><span class="op" id="8251244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251247">{</span><span class="op" id="8251248">[</span><span class="op" id="8251249">]</span><span class="builtintype" id="8251250">byte</span><span class="op" id="8251254">{</span><span class="num" id="8251255">1</span><span class="op" id="8251256">,</span>&nbsp;<span class="num" id="8251258">2</span><span class="op" id="8251259">,</span>&nbsp;<span class="num" id="8251261">3</span><span class="op" id="8251262">,</span>&nbsp;<span class="num" id="8251264">3</span><span class="op" id="8251265">,</span>&nbsp;<span class="num" id="8251267">3</span><span class="op" id="8251268">,</span>&nbsp;<span class="num" id="8251270">3</span><span class="op" id="8251271">}</span><span class="op" id="8251272">,</span>&nbsp;<span class="builtintype" id="8251274">true</span><span class="op" id="8251278">,</span>&nbsp;<span class="num" id="8251280">2</span><span class="op" id="8251281">}</span><span class="op" id="8251282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251285">{</span><span class="op" id="8251286">[</span><span class="op" id="8251287">]</span><span class="builtintype" id="8251288">byte</span><span class="op" id="8251292">{</span><span class="num" id="8251293">1</span><span class="op" id="8251294">,</span>&nbsp;<span class="num" id="8251296">2</span><span class="op" id="8251297">,</span>&nbsp;<span class="num" id="8251299">3</span><span class="op" id="8251300">,</span>&nbsp;<span class="num" id="8251302">4</span><span class="op" id="8251303">,</span>&nbsp;<span class="num" id="8251305">3</span><span class="op" id="8251306">,</span>&nbsp;<span class="num" id="8251308">3</span><span class="op" id="8251309">}</span><span class="op" id="8251310">,</span>&nbsp;<span class="builtintype" id="8251312">false</span><span class="op" id="8251317">,</span>&nbsp;<span class="num" id="8251319">0</span><span class="op" id="8251320">}</span><span class="op" id="8251321">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251324">{</span><span class="op" id="8251325">[</span><span class="op" id="8251326">]</span><span class="builtintype" id="8251327">byte</span><span class="op" id="8251331">{</span><span class="num" id="8251332">1</span><span class="op" id="8251333">,</span>&nbsp;<span class="num" id="8251335">4</span><span class="op" id="8251336">,</span>&nbsp;<span class="num" id="8251338">4</span><span class="op" id="8251339">,</span>&nbsp;<span class="num" id="8251341">4</span><span class="op" id="8251342">,</span>&nbsp;<span class="num" id="8251344">4</span><span class="op" id="8251345">,</span>&nbsp;<span class="num" id="8251347">4</span><span class="op" id="8251348">}</span><span class="op" id="8251349">,</span>&nbsp;<span class="builtintype" id="8251351">true</span><span class="op" id="8251355">,</span>&nbsp;<span class="num" id="8251357">1</span><span class="op" id="8251358">}</span><span class="op" id="8251359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251362">{</span><span class="op" id="8251363">[</span><span class="op" id="8251364">]</span><span class="builtintype" id="8251365">byte</span><span class="op" id="8251369">{</span><span class="num" id="8251370">5</span><span class="op" id="8251371">,</span>&nbsp;<span class="num" id="8251373">5</span><span class="op" id="8251374">,</span>&nbsp;<span class="num" id="8251376">5</span><span class="op" id="8251377">,</span>&nbsp;<span class="num" id="8251379">5</span><span class="op" id="8251380">,</span>&nbsp;<span class="num" id="8251382">5</span><span class="op" id="8251383">,</span>&nbsp;<span class="num" id="8251385">5</span><span class="op" id="8251386">}</span><span class="op" id="8251387">,</span>&nbsp;<span class="builtintype" id="8251389">true</span><span class="op" id="8251393">,</span>&nbsp;<span class="num" id="8251395">0</span><span class="op" id="8251396">}</span><span class="op" id="8251397">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251400">{</span><span class="op" id="8251401">[</span><span class="op" id="8251402">]</span><span class="builtintype" id="8251403">byte</span><span class="op" id="8251407">{</span><span class="num" id="8251408">6</span><span class="op" id="8251409">,</span>&nbsp;<span class="num" id="8251411">6</span><span class="op" id="8251412">,</span>&nbsp;<span class="num" id="8251414">6</span><span class="op" id="8251415">,</span>&nbsp;<span class="num" id="8251417">6</span><span class="op" id="8251418">,</span>&nbsp;<span class="num" id="8251420">6</span><span class="op" id="8251421">,</span>&nbsp;<span class="num" id="8251423">6</span><span class="op" id="8251424">}</span><span class="op" id="8251425">,</span>&nbsp;<span class="builtintype" id="8251427">false</span><span class="op" id="8251432">,</span>&nbsp;<span class="num" id="8251434">0</span><span class="op" id="8251435">}</span><span class="op" id="8251436">,</span><br>
<span class="lineno"></span><span class="op" id="8251438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8251441">func</span>&nbsp;<span class="ident" id="8251446">TestRemovePadding</span><span class="op" id="8251463">(</span><span class="ident" id="8251464">t</span>&nbsp;<span class="op" id="8251466">*</span><span class="ident" id="8251467">testing</span><span class="op" id="8251474">.</span><span class="ident" id="8251475">T</span><span class="op" id="8251476">)</span>&nbsp;<span class="op" id="8251478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251481">for</span>&nbsp;<span class="ident" id="8251485">i</span><span class="op" id="8251486">,</span>&nbsp;<span class="ident" id="8251488">test</span>&nbsp;<span class="op" id="8251493">:=</span>&nbsp;<span class="keyword" id="8251496">range</span>&nbsp;<span class="ident" id="8251502">paddingTests</span>&nbsp;<span class="op" id="8251515">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251519">payload</span><span class="op" id="8251526">,</span>&nbsp;<span class="ident" id="8251528">good</span>&nbsp;<span class="op" id="8251533">:=</span>&nbsp;<span class="ident" id="8251536">removePadding</span><span class="op" id="8251549">(</span><span class="ident" id="8251550">test</span><span class="op" id="8251554">.</span><span class="ident" id="8251555">in</span><span class="op" id="8251557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251561">expectedGood</span>&nbsp;<span class="op" id="8251574">:=</span>&nbsp;<span class="builtintype" id="8251577">byte</span><span class="op" id="8251581">(</span><span class="num" id="8251582">255</span><span class="op" id="8251585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251589">if</span>&nbsp;<span class="op" id="8251592">!</span><span class="ident" id="8251593">test</span><span class="op" id="8251597">.</span><span class="ident" id="8251598">good</span>&nbsp;<span class="op" id="8251603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251608">expectedGood</span>&nbsp;<span class="op" id="8251621">=</span>&nbsp;<span class="num" id="8251623">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251627">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251631">if</span>&nbsp;<span class="ident" id="8251634">good</span>&nbsp;<span class="op" id="8251639">!=</span>&nbsp;<span class="ident" id="8251642">expectedGood</span>&nbsp;<span class="op" id="8251655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251660">t</span><span class="op" id="8251661">.</span><span class="ident" id="8251662">Errorf</span><span class="op" id="8251668">(</span><span class="string" id="8251669">&#34;#%d:&nbsp;wrong&nbsp;validity,&nbsp;want:%d&nbsp;got:%d&#34;</span><span class="op" id="8251706">,</span>&nbsp;<span class="ident" id="8251708">i</span><span class="op" id="8251709">,</span>&nbsp;<span class="ident" id="8251711">expectedGood</span><span class="op" id="8251723">,</span>&nbsp;<span class="ident" id="8251725">good</span><span class="op" id="8251729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8251737">if</span>&nbsp;<span class="ident" id="8251740">good</span>&nbsp;<span class="op" id="8251745">==</span>&nbsp;<span class="num" id="8251748">255</span>&nbsp;<span class="op" id="8251752">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="8251755">len</span><span class="op" id="8251758">(</span><span class="ident" id="8251759">payload</span><span class="op" id="8251766">)</span>&nbsp;<span class="op" id="8251768">!=</span>&nbsp;<span class="ident" id="8251771">test</span><span class="op" id="8251775">.</span><span class="ident" id="8251776">expectedLen</span>&nbsp;<span class="op" id="8251788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8251793">t</span><span class="op" id="8251794">.</span><span class="ident" id="8251795">Errorf</span><span class="op" id="8251801">(</span><span class="string" id="8251802">&#34;#%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8251824">,</span>&nbsp;<span class="ident" id="8251826">i</span><span class="op" id="8251827">,</span>&nbsp;<span class="builtinfunc" id="8251829">len</span><span class="op" id="8251832">(</span><span class="ident" id="8251833">payload</span><span class="op" id="8251840">)</span><span class="op" id="8251841">,</span>&nbsp;<span class="ident" id="8251843">test</span><span class="op" id="8251847">.</span><span class="ident" id="8251848">expectedLen</span><span class="op" id="8251859">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8251866">}</span><br>
<span class="lineno"></span><span class="op" id="8251868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8251871">var</span>&nbsp;<span class="ident" id="8251875">certExampleCom</span>&nbsp;<span class="op" id="8251890">=</span>&nbsp;<span class="string" id="8251892">`308201403081eda003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313138353835325a170d3132303933303138353835325a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31a301830160603551d11040f300d820b6578616d706c652e636f6d300b06092a864886f70d0101050341001a0b419d2c74474c6450654e5f10b32bf426ffdf55cad1c52602e7a9151513a3424c70f5960dcd682db0c33769cc1daa3fcdd3db10809d2392ed4a1bf50ced18`</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="8252544">var</span>&nbsp;<span class="ident" id="8252548">certWildcardExampleCom</span>&nbsp;<span class="op" id="8252571">=</span>&nbsp;<span class="string" id="8252573">`308201423081efa003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303034365a170d3132303933303139303034365a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31c301a30180603551d110411300f820d2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001676f0c9e7c33c1b656ed5a6476c4e2ee9ec8e62df7407accb1875272b2edd0a22096cb2c22598d11604104d604f810eb4b5987ca6bb319c7e6ce48725c54059`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8253229">var</span>&nbsp;<span class="ident" id="8253233">certFooExampleCom</span>&nbsp;<span class="op" id="8253251">=</span>&nbsp;<span class="string" id="8253253">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303131345a170d3132303933303139303131345a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f666f6f2e6578616d706c652e636f6d300b06092a864886f70d010105034100646a2a51f2aa2477add854b462cf5207ba16d3213ffb5d3d0eed473fbf09935019192d1d5b8ca6a2407b424cf04d97c4cd9197c83ecf81f0eab9464a1109d09f`</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="8253913">var</span>&nbsp;<span class="ident" id="8253917">certDoubleWildcardExampleCom</span>&nbsp;<span class="op" id="8253946">=</span>&nbsp;<span class="string" id="8253948">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303134315a170d3132303933303139303134315a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f2a2e2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001c3de267975f56ef57771c6218ef95ecc65102e57bd1defe6f7efea90d9b26cf40de5bd7ad75e46201c7f2a92aaa3e907451e9409f65e28ddb6db80d726290f6`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8254608">func</span>&nbsp;<span class="ident" id="8254613">TestCertificateSelection</span><span class="op" id="8254637">(</span><span class="ident" id="8254638">t</span>&nbsp;<span class="op" id="8254640">*</span><span class="ident" id="8254641">testing</span><span class="op" id="8254648">.</span><span class="ident" id="8254649">T</span><span class="op" id="8254650">)</span>&nbsp;<span class="op" id="8254652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254655">config</span>&nbsp;<span class="op" id="8254662">:=</span>&nbsp;<span class="ident" id="8254665">Config</span><span class="op" id="8254671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254675">Certificates</span><span class="op" id="8254687">:</span>&nbsp;<span class="op" id="8254689">[</span><span class="op" id="8254690">]</span><span class="ident" id="8254691">Certificate</span><span class="op" id="8254702">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8254707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254713">Certificate</span><span class="op" id="8254724">:</span>&nbsp;<span class="op" id="8254726">[</span><span class="op" id="8254727">]</span><span class="op" id="8254728">[</span><span class="op" id="8254729">]</span><span class="builtintype" id="8254730">byte</span><span class="op" id="8254734">{</span><span class="ident" id="8254735">fromHex</span><span class="op" id="8254742">(</span><span class="ident" id="8254743">certExampleCom</span><span class="op" id="8254757">)</span><span class="op" id="8254758">}</span><span class="op" id="8254759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8254764">}</span><span class="op" id="8254765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8254770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254776">Certificate</span><span class="op" id="8254787">:</span>&nbsp;<span class="op" id="8254789">[</span><span class="op" id="8254790">]</span><span class="op" id="8254791">[</span><span class="op" id="8254792">]</span><span class="builtintype" id="8254793">byte</span><span class="op" id="8254797">{</span><span class="ident" id="8254798">fromHex</span><span class="op" id="8254805">(</span><span class="ident" id="8254806">certWildcardExampleCom</span><span class="op" id="8254828">)</span><span class="op" id="8254829">}</span><span class="op" id="8254830">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8254835">}</span><span class="op" id="8254836">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8254841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254847">Certificate</span><span class="op" id="8254858">:</span>&nbsp;<span class="op" id="8254860">[</span><span class="op" id="8254861">]</span><span class="op" id="8254862">[</span><span class="op" id="8254863">]</span><span class="builtintype" id="8254864">byte</span><span class="op" id="8254868">{</span><span class="ident" id="8254869">fromHex</span><span class="op" id="8254876">(</span><span class="ident" id="8254877">certFooExampleCom</span><span class="op" id="8254894">)</span><span class="op" id="8254895">}</span><span class="op" id="8254896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8254901">}</span><span class="op" id="8254902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8254907">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254913">Certificate</span><span class="op" id="8254924">:</span>&nbsp;<span class="op" id="8254926">[</span><span class="op" id="8254927">]</span><span class="op" id="8254928">[</span><span class="op" id="8254929">]</span><span class="builtintype" id="8254930">byte</span><span class="op" id="8254934">{</span><span class="ident" id="8254935">fromHex</span><span class="op" id="8254942">(</span><span class="ident" id="8254943">certDoubleWildcardExampleCom</span><span class="op" id="8254971">)</span><span class="op" id="8254972">}</span><span class="op" id="8254973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8254978">}</span><span class="op" id="8254979">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8254983">}</span><span class="op" id="8254984">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8254987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8254991">config</span><span class="op" id="8254997">.</span><span class="ident" id="8254998">BuildNameToCertificate</span><span class="op" id="8255020">(</span><span class="op" id="8255021">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8255025">pointerToIndex</span>&nbsp;<span class="op" id="8255040">:=</span>&nbsp;<span class="keyword" id="8255043">func</span><span class="op" id="8255047">(</span><span class="ident" id="8255048">c</span>&nbsp;<span class="op" id="8255050">*</span><span class="ident" id="8255051">Certificate</span><span class="op" id="8255062">)</span>&nbsp;<span class="builtintype" id="8255064">int</span>&nbsp;<span class="op" id="8255068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8255072">for</span>&nbsp;<span class="ident" id="8255076">i</span>&nbsp;<span class="op" id="8255078">:=</span>&nbsp;<span class="keyword" id="8255081">range</span>&nbsp;<span class="ident" id="8255087">config</span><span class="op" id="8255093">.</span><span class="ident" id="8255094">Certificates</span>&nbsp;<span class="op" id="8255107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8255112">if</span>&nbsp;<span class="ident" id="8255115">c</span>&nbsp;<span class="op" id="8255117">==</span>&nbsp;<span class="op" id="8255120">&amp;</span><span class="ident" id="8255121">config</span><span class="op" id="8255127">.</span><span class="ident" id="8255128">Certificates</span><span class="op" id="8255140">[</span><span class="ident" id="8255141">i</span><span class="op" id="8255142">]</span>&nbsp;<span class="op" id="8255144">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8255150">return</span>&nbsp;<span class="ident" id="8255157">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8255162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8255166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8255170">return</span>&nbsp;<span class="op" id="8255177">-</span><span class="num" id="8255178">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8255181">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8255185">certificateForName</span>&nbsp;<span class="op" id="8255204">:=</span>&nbsp;<span class="keyword" id="8255207">func</span><span class="op" id="8255211">(</span><span class="ident" id="8255212">name</span>&nbsp;<span class="builtintype" id="8255217">string</span><span class="op" id="8255223">)</span>&nbsp;<span class="op" id="8255225">*</span><span class="ident" id="8255226">Certificate</span>&nbsp;<span class="op" id="8255238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8255242">clientHello</span>&nbsp;<span class="op" id="8255254">:=</span>&nbsp;<span class="op" id="8255257">&amp;</span><span class="ident" id="8255258">ClientHelloInfo</span><span class="op" id="8255273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8255278">ServerName</span><span class="op" id="8255288">:</span>&nbsp;<span class="ident" id="8255290">name</span><span class="op" id="8255294">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8255298">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8255302">if</span>&nbsp;<span class="ident" id="8255305">cert</span><span class="op" id="8255309">,</span>&nbsp;<span class="ident" id="8255311">err</span>&nbsp;<span class="op" id="8255315">:=</span>&nbsp;<span class="ident" id="8255318">config</span><span class="op" id="8255324">.</span><span class="ident" id="8255325">getCertificate</span><span class="op" id="8255339">(</span><span class="ident" id="8255340">clientHello</span><span class="op" id="8255351">)</span><span class="op" id="8255352">;</span>&nbsp;<span class="ident" id="8255354">err</span>&nbsp;<span class="op" id="8255358">!=</span>&nbsp;<span class="ident" id="8255361">nil</span>&nbsp;<span class="op" id="8255365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8255370">t</span><span class="op" id="8255371">.</span><span class="ident" id="8255372">Errorf</span><span class="op" id="8255378">(</span><span class="string" id="8255379">&#34;unable&nbsp;to&nbsp;get&nbsp;certificate&nbsp;for&nbsp;name&nbsp;&#39;%s&#39;:&nbsp;%s&#34;</span><span class="op" id="8255424">,</span>&nbsp;<span class="ident" id="8255426">name</span><span class="op" id="8255430">,</span>&nbsp;<span class="ident" id="8255432">err</span><span class="op" id="8255435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8255440">return</span>&nbsp;<span class="ident" id="8255447">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8255453">}</span>&nbsp;<span class="keyword" id="8255455">else</span>&nbsp;<span class="op" id="8255460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8255465">return</span>&nbsp;<span class="ident" id="8255472">cert</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8255479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8255482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8255486">if</span>&nbsp;<span class="ident" id="8255489">n</span>&nbsp;<span class="op" id="8255491">:=</span>&nbsp;<span class="ident" id="8255494">pointerToIndex</span><span class="op" id="8255508">(</span><span class="ident" id="8255509">certificateForName</span><span class="op" id="8255527">(</span><span class="string" id="8255528">&#34;example.com&#34;</span><span class="op" id="8255541">)</span><span class="op" id="8255542">)</span><span class="op" id="8255543">;</span>&nbsp;<span class="ident" id="8255545">n</span>&nbsp;<span class="op" id="8255547">!=</span>&nbsp;<span class="num" id="8255550">0</span>&nbsp;<span class="op" id="8255552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8255556">t</span><span class="op" id="8255557">.</span><span class="ident" id="8255558">Errorf</span><span class="op" id="8255564">(</span><span class="string" id="8255565">&#34;example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="8255609">,</span>&nbsp;<span class="ident" id="8255611">n</span><span class="op" id="8255612">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8255615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8255618">if</span>&nbsp;<span class="ident" id="8255621">n</span>&nbsp;<span class="op" id="8255623">:=</span>&nbsp;<span class="ident" id="8255626">pointerToIndex</span><span class="op" id="8255640">(</span><span class="ident" id="8255641">certificateForName</span><span class="op" id="8255659">(</span><span class="string" id="8255660">&#34;bar.example.com&#34;</span><span class="op" id="8255677">)</span><span class="op" id="8255678">)</span><span class="op" id="8255679">;</span>&nbsp;<span class="ident" id="8255681">n</span>&nbsp;<span class="op" id="8255683">!=</span>&nbsp;<span class="num" id="8255686">1</span>&nbsp;<span class="op" id="8255688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8255692">t</span><span class="op" id="8255693">.</span><span class="ident" id="8255694">Errorf</span><span class="op" id="8255700">(</span><span class="string" id="8255701">&#34;bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;1&#34;</span><span class="op" id="8255749">,</span>&nbsp;<span class="ident" id="8255751">n</span><span class="op" id="8255752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8255755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8255758">if</span>&nbsp;<span class="ident" id="8255761">n</span>&nbsp;<span class="op" id="8255763">:=</span>&nbsp;<span class="ident" id="8255766">pointerToIndex</span><span class="op" id="8255780">(</span><span class="ident" id="8255781">certificateForName</span><span class="op" id="8255799">(</span><span class="string" id="8255800">&#34;foo.example.com&#34;</span><span class="op" id="8255817">)</span><span class="op" id="8255818">)</span><span class="op" id="8255819">;</span>&nbsp;<span class="ident" id="8255821">n</span>&nbsp;<span class="op" id="8255823">!=</span>&nbsp;<span class="num" id="8255826">2</span>&nbsp;<span class="op" id="8255828">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8255832">t</span><span class="op" id="8255833">.</span><span class="ident" id="8255834">Errorf</span><span class="op" id="8255840">(</span><span class="string" id="8255841">&#34;foo.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;2&#34;</span><span class="op" id="8255889">,</span>&nbsp;<span class="ident" id="8255891">n</span><span class="op" id="8255892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8255895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8255898">if</span>&nbsp;<span class="ident" id="8255901">n</span>&nbsp;<span class="op" id="8255903">:=</span>&nbsp;<span class="ident" id="8255906">pointerToIndex</span><span class="op" id="8255920">(</span><span class="ident" id="8255921">certificateForName</span><span class="op" id="8255939">(</span><span class="string" id="8255940">&#34;foo.bar.example.com&#34;</span><span class="op" id="8255961">)</span><span class="op" id="8255962">)</span><span class="op" id="8255963">;</span>&nbsp;<span class="ident" id="8255965">n</span>&nbsp;<span class="op" id="8255967">!=</span>&nbsp;<span class="num" id="8255970">3</span>&nbsp;<span class="op" id="8255972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8255976">t</span><span class="op" id="8255977">.</span><span class="ident" id="8255978">Errorf</span><span class="op" id="8255984">(</span><span class="string" id="8255985">&#34;foo.bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;3&#34;</span><span class="op" id="8256037">,</span>&nbsp;<span class="ident" id="8256039">n</span><span class="op" id="8256040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8256043">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8256046">if</span>&nbsp;<span class="ident" id="8256049">n</span>&nbsp;<span class="op" id="8256051">:=</span>&nbsp;<span class="ident" id="8256054">pointerToIndex</span><span class="op" id="8256068">(</span><span class="ident" id="8256069">certificateForName</span><span class="op" id="8256087">(</span><span class="string" id="8256088">&#34;foo.bar.baz.example.com&#34;</span><span class="op" id="8256113">)</span><span class="op" id="8256114">)</span><span class="op" id="8256115">;</span>&nbsp;<span class="ident" id="8256117">n</span>&nbsp;<span class="op" id="8256119">!=</span>&nbsp;<span class="num" id="8256122">0</span>&nbsp;<span class="op" id="8256124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8256128">t</span><span class="op" id="8256129">.</span><span class="ident" id="8256130">Errorf</span><span class="op" id="8256136">(</span><span class="string" id="8256137">&#34;foo.bar.baz.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="8256193">,</span>&nbsp;<span class="ident" id="8256195">n</span><span class="op" id="8256196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8256199">}</span><br>
<span class="lineno"></span><span class="op" id="8256201">}</span>
</div>
</body>
</html>
