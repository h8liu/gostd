<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8669475">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8669530">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8669584">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8669635">package</span>&nbsp;<span class="ident" id="8669643">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8669649">import</span>&nbsp;<span class="op" id="8669656">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8669659">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8669670">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="8669680">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8669683">func</span>&nbsp;<span class="ident" id="8669688">TestConsumeToken</span><span class="op" id="8669704">(</span><span class="ident" id="8669705">t</span>&nbsp;<span class="op" id="8669707">*</span><span class="ident" id="8669708">testing</span><span class="op" id="8669715">.</span><span class="ident" id="8669716">T</span><span class="op" id="8669717">)</span>&nbsp;<span class="op" id="8669719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8669722">tests</span>&nbsp;<span class="op" id="8669728">:=</span>&nbsp;<span class="op" id="8669731">[</span><span class="op" id="8669732">...</span><span class="op" id="8669735">]</span><span class="op" id="8669736">[</span><span class="num" id="8669737">3</span><span class="op" id="8669738">]</span><span class="builtintype" id="8669739">string</span><span class="op" id="8669745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8669749">{</span><span class="string" id="8669750">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8669759">,</span>&nbsp;<span class="string" id="8669761">&#34;foo&#34;</span><span class="op" id="8669766">,</span>&nbsp;<span class="string" id="8669768">&#34;&nbsp;bar&#34;</span><span class="op" id="8669774">}</span><span class="op" id="8669775">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8669779">{</span><span class="string" id="8669780">&#34;bar&#34;</span><span class="op" id="8669785">,</span>&nbsp;<span class="string" id="8669787">&#34;bar&#34;</span><span class="op" id="8669792">,</span>&nbsp;<span class="string" id="8669794">&#34;&#34;</span><span class="op" id="8669796">}</span><span class="op" id="8669797">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8669801">{</span><span class="string" id="8669802">&#34;&#34;</span><span class="op" id="8669804">,</span>&nbsp;<span class="string" id="8669806">&#34;&#34;</span><span class="op" id="8669808">,</span>&nbsp;<span class="string" id="8669810">&#34;&#34;</span><span class="op" id="8669812">}</span><span class="op" id="8669813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8669817">{</span><span class="string" id="8669818">&#34;&nbsp;foo&#34;</span><span class="op" id="8669824">,</span>&nbsp;<span class="string" id="8669826">&#34;&#34;</span><span class="op" id="8669828">,</span>&nbsp;<span class="string" id="8669830">&#34;&nbsp;foo&#34;</span><span class="op" id="8669836">}</span><span class="op" id="8669837">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8669840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8669843">for</span>&nbsp;<span class="ident" id="8669847">_</span><span class="op" id="8669848">,</span>&nbsp;<span class="ident" id="8669850">test</span>&nbsp;<span class="op" id="8669855">:=</span>&nbsp;<span class="keyword" id="8669858">range</span>&nbsp;<span class="ident" id="8669864">tests</span>&nbsp;<span class="op" id="8669870">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8669874">token</span><span class="op" id="8669879">,</span>&nbsp;<span class="ident" id="8669881">rest</span>&nbsp;<span class="op" id="8669886">:=</span>&nbsp;<span class="ident" id="8669889">consumeToken</span><span class="op" id="8669901">(</span><span class="ident" id="8669902">test</span><span class="op" id="8669906">[</span><span class="num" id="8669907">0</span><span class="op" id="8669908">]</span><span class="op" id="8669909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8669913">expectedToken</span>&nbsp;<span class="op" id="8669927">:=</span>&nbsp;<span class="ident" id="8669930">test</span><span class="op" id="8669934">[</span><span class="num" id="8669935">1</span><span class="op" id="8669936">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8669940">expectedRest</span>&nbsp;<span class="op" id="8669953">:=</span>&nbsp;<span class="ident" id="8669956">test</span><span class="op" id="8669960">[</span><span class="num" id="8669961">2</span><span class="op" id="8669962">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8669966">if</span>&nbsp;<span class="ident" id="8669969">token</span>&nbsp;<span class="op" id="8669975">!=</span>&nbsp;<span class="ident" id="8669978">expectedToken</span>&nbsp;<span class="op" id="8669992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8669997">t</span><span class="op" id="8669998">.</span><span class="ident" id="8669999">Errorf</span><span class="op" id="8670005">(</span><span class="string" id="8670006">&#34;expected&nbsp;to&nbsp;consume&nbsp;token&nbsp;&#39;%s&#39;,&nbsp;not&nbsp;&#39;%s&#39;&nbsp;from&nbsp;&#39;%s&#39;&#34;</span><span class="op" id="8670058">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8670064">expectedToken</span><span class="op" id="8670077">,</span>&nbsp;<span class="ident" id="8670079">token</span><span class="op" id="8670084">,</span>&nbsp;<span class="ident" id="8670086">test</span><span class="op" id="8670090">[</span><span class="num" id="8670091">0</span><span class="op" id="8670092">]</span><span class="op" id="8670093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8670097">}</span>&nbsp;<span class="keyword" id="8670099">else</span>&nbsp;<span class="keyword" id="8670104">if</span>&nbsp;<span class="ident" id="8670107">rest</span>&nbsp;<span class="op" id="8670112">!=</span>&nbsp;<span class="ident" id="8670115">expectedRest</span>&nbsp;<span class="op" id="8670128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8670133">t</span><span class="op" id="8670134">.</span><span class="ident" id="8670135">Errorf</span><span class="op" id="8670141">(</span><span class="string" id="8670142">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;&#39;%s&#39;,&nbsp;not&nbsp;&#39;%s&#39;&nbsp;after&nbsp;reading&nbsp;token&nbsp;&#39;%s&#39;&nbsp;from&nbsp;&#39;%s&#39;&#34;</span><span class="op" id="8670215">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8670221">expectedRest</span><span class="op" id="8670233">,</span>&nbsp;<span class="ident" id="8670235">rest</span><span class="op" id="8670239">,</span>&nbsp;<span class="ident" id="8670241">token</span><span class="op" id="8670246">,</span>&nbsp;<span class="ident" id="8670248">test</span><span class="op" id="8670252">[</span><span class="num" id="8670253">0</span><span class="op" id="8670254">]</span><span class="op" id="8670255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8670259">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8670262">}</span><br>
<span class="lineno"></span><span class="op" id="8670264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8670267">func</span>&nbsp;<span class="ident" id="8670272">TestConsumeValue</span><span class="op" id="8670288">(</span><span class="ident" id="8670289">t</span>&nbsp;<span class="op" id="8670291">*</span><span class="ident" id="8670292">testing</span><span class="op" id="8670299">.</span><span class="ident" id="8670300">T</span><span class="op" id="8670301">)</span>&nbsp;<span class="op" id="8670303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8670306">tests</span>&nbsp;<span class="op" id="8670312">:=</span>&nbsp;<span class="op" id="8670315">[</span><span class="op" id="8670316">...</span><span class="op" id="8670319">]</span><span class="op" id="8670320">[</span><span class="num" id="8670321">3</span><span class="op" id="8670322">]</span><span class="builtintype" id="8670323">string</span><span class="op" id="8670329">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8670333">{</span><span class="string" id="8670334">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8670343">,</span>&nbsp;<span class="string" id="8670345">&#34;foo&#34;</span><span class="op" id="8670350">,</span>&nbsp;<span class="string" id="8670352">&#34;&nbsp;bar&#34;</span><span class="op" id="8670358">}</span><span class="op" id="8670359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8670363">{</span><span class="string" id="8670364">&#34;bar&#34;</span><span class="op" id="8670369">,</span>&nbsp;<span class="string" id="8670371">&#34;bar&#34;</span><span class="op" id="8670376">,</span>&nbsp;<span class="string" id="8670378">&#34;&#34;</span><span class="op" id="8670380">}</span><span class="op" id="8670381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8670385">{</span><span class="string" id="8670386">&#34;&nbsp;bar&nbsp;&#34;</span><span class="op" id="8670393">,</span>&nbsp;<span class="string" id="8670395">&#34;&#34;</span><span class="op" id="8670397">,</span>&nbsp;<span class="string" id="8670399">&#34;&nbsp;bar&nbsp;&#34;</span><span class="op" id="8670406">}</span><span class="op" id="8670407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8670411">{</span><span class="string" id="8670412">`&#34;My&nbsp;value&#34;end`</span><span class="op" id="8670427">,</span>&nbsp;<span class="string" id="8670429">&#34;My&nbsp;value&#34;</span><span class="op" id="8670439">,</span>&nbsp;<span class="string" id="8670441">&#34;end&#34;</span><span class="op" id="8670446">}</span><span class="op" id="8670447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8670451">{</span><span class="string" id="8670452">`&#34;My&nbsp;value&#34;&nbsp;end`</span><span class="op" id="8670468">,</span>&nbsp;<span class="string" id="8670470">&#34;My&nbsp;value&#34;</span><span class="op" id="8670480">,</span>&nbsp;<span class="string" id="8670482">&#34;&nbsp;end&#34;</span><span class="op" id="8670488">}</span><span class="op" id="8670489">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8670493">{</span><span class="string" id="8670494">`&#34;\\&#34;&nbsp;rest`</span><span class="op" id="8670505">,</span>&nbsp;<span class="string" id="8670507">&#34;\\&#34;</span><span class="op" id="8670511">,</span>&nbsp;<span class="string" id="8670513">&#34;&nbsp;rest&#34;</span><span class="op" id="8670520">}</span><span class="op" id="8670521">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8670525">{</span><span class="string" id="8670526">`&#34;My&nbsp;\&#34;&nbsp;value&#34;end`</span><span class="op" id="8670544">,</span>&nbsp;<span class="string" id="8670546">&#34;My&nbsp;\&#34;&nbsp;value&#34;</span><span class="op" id="8670559">,</span>&nbsp;<span class="string" id="8670561">&#34;end&#34;</span><span class="op" id="8670566">}</span><span class="op" id="8670567">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8670571">{</span><span class="string" id="8670572">`&#34;\&#34;&nbsp;rest`</span><span class="op" id="8670582">,</span>&nbsp;<span class="string" id="8670584">&#34;&#34;</span><span class="op" id="8670586">,</span>&nbsp;<span class="string" id="8670588">`&#34;\&#34;&nbsp;rest`</span><span class="op" id="8670598">}</span><span class="op" id="8670599">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8670602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8670605">for</span>&nbsp;<span class="ident" id="8670609">_</span><span class="op" id="8670610">,</span>&nbsp;<span class="ident" id="8670612">test</span>&nbsp;<span class="op" id="8670617">:=</span>&nbsp;<span class="keyword" id="8670620">range</span>&nbsp;<span class="ident" id="8670626">tests</span>&nbsp;<span class="op" id="8670632">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8670636">value</span><span class="op" id="8670641">,</span>&nbsp;<span class="ident" id="8670643">rest</span>&nbsp;<span class="op" id="8670648">:=</span>&nbsp;<span class="ident" id="8670651">consumeValue</span><span class="op" id="8670663">(</span><span class="ident" id="8670664">test</span><span class="op" id="8670668">[</span><span class="num" id="8670669">0</span><span class="op" id="8670670">]</span><span class="op" id="8670671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8670675">expectedValue</span>&nbsp;<span class="op" id="8670689">:=</span>&nbsp;<span class="ident" id="8670692">test</span><span class="op" id="8670696">[</span><span class="num" id="8670697">1</span><span class="op" id="8670698">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8670702">expectedRest</span>&nbsp;<span class="op" id="8670715">:=</span>&nbsp;<span class="ident" id="8670718">test</span><span class="op" id="8670722">[</span><span class="num" id="8670723">2</span><span class="op" id="8670724">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8670728">if</span>&nbsp;<span class="ident" id="8670731">value</span>&nbsp;<span class="op" id="8670737">!=</span>&nbsp;<span class="ident" id="8670740">expectedValue</span>&nbsp;<span class="op" id="8670754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8670759">t</span><span class="op" id="8670760">.</span><span class="ident" id="8670761">Errorf</span><span class="op" id="8670767">(</span><span class="string" id="8670768">&#34;expected&nbsp;to&nbsp;consume&nbsp;value&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8670820">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8670826">expectedValue</span><span class="op" id="8670839">,</span>&nbsp;<span class="ident" id="8670841">value</span><span class="op" id="8670846">,</span>&nbsp;<span class="ident" id="8670848">test</span><span class="op" id="8670852">[</span><span class="num" id="8670853">0</span><span class="op" id="8670854">]</span><span class="op" id="8670855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8670859">}</span>&nbsp;<span class="keyword" id="8670861">else</span>&nbsp;<span class="keyword" id="8670866">if</span>&nbsp;<span class="ident" id="8670869">rest</span>&nbsp;<span class="op" id="8670874">!=</span>&nbsp;<span class="ident" id="8670877">expectedRest</span>&nbsp;<span class="op" id="8670890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8670895">t</span><span class="op" id="8670896">.</span><span class="ident" id="8670897">Errorf</span><span class="op" id="8670903">(</span><span class="string" id="8670904">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;after&nbsp;reading&nbsp;value&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8670977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8670983">expectedRest</span><span class="op" id="8670995">,</span>&nbsp;<span class="ident" id="8670997">rest</span><span class="op" id="8671001">,</span>&nbsp;<span class="ident" id="8671003">value</span><span class="op" id="8671008">,</span>&nbsp;<span class="ident" id="8671010">test</span><span class="op" id="8671014">[</span><span class="num" id="8671015">0</span><span class="op" id="8671016">]</span><span class="op" id="8671017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8671021">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8671024">}</span><br>
<span class="lineno"></span><span class="op" id="8671026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8671029">func</span>&nbsp;<span class="ident" id="8671034">TestConsumeMediaParam</span><span class="op" id="8671055">(</span><span class="ident" id="8671056">t</span>&nbsp;<span class="op" id="8671058">*</span><span class="ident" id="8671059">testing</span><span class="op" id="8671066">.</span><span class="ident" id="8671067">T</span><span class="op" id="8671068">)</span>&nbsp;<span class="op" id="8671070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8671073">tests</span>&nbsp;<span class="op" id="8671079">:=</span>&nbsp;<span class="op" id="8671082">[</span><span class="op" id="8671083">...</span><span class="op" id="8671086">]</span><span class="op" id="8671087">[</span><span class="num" id="8671088">4</span><span class="op" id="8671089">]</span><span class="builtintype" id="8671090">string</span><span class="op" id="8671096">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8671100">{</span><span class="string" id="8671101">&#34;&nbsp;;&nbsp;foo=bar&#34;</span><span class="op" id="8671113">,</span>&nbsp;<span class="string" id="8671115">&#34;foo&#34;</span><span class="op" id="8671120">,</span>&nbsp;<span class="string" id="8671122">&#34;bar&#34;</span><span class="op" id="8671127">,</span>&nbsp;<span class="string" id="8671129">&#34;&#34;</span><span class="op" id="8671131">}</span><span class="op" id="8671132">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8671136">{</span><span class="string" id="8671137">&#34;;&nbsp;foo=bar&#34;</span><span class="op" id="8671148">,</span>&nbsp;<span class="string" id="8671150">&#34;foo&#34;</span><span class="op" id="8671155">,</span>&nbsp;<span class="string" id="8671157">&#34;bar&#34;</span><span class="op" id="8671162">,</span>&nbsp;<span class="string" id="8671164">&#34;&#34;</span><span class="op" id="8671166">}</span><span class="op" id="8671167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8671171">{</span><span class="string" id="8671172">&#34;;foo=bar&#34;</span><span class="op" id="8671182">,</span>&nbsp;<span class="string" id="8671184">&#34;foo&#34;</span><span class="op" id="8671189">,</span>&nbsp;<span class="string" id="8671191">&#34;bar&#34;</span><span class="op" id="8671196">,</span>&nbsp;<span class="string" id="8671198">&#34;&#34;</span><span class="op" id="8671200">}</span><span class="op" id="8671201">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8671205">{</span><span class="string" id="8671206">&#34;;FOO=bar&#34;</span><span class="op" id="8671216">,</span>&nbsp;<span class="string" id="8671218">&#34;foo&#34;</span><span class="op" id="8671223">,</span>&nbsp;<span class="string" id="8671225">&#34;bar&#34;</span><span class="op" id="8671230">,</span>&nbsp;<span class="string" id="8671232">&#34;&#34;</span><span class="op" id="8671234">}</span><span class="op" id="8671235">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8671239">{</span><span class="string" id="8671240">`;foo=&#34;bar&#34;`</span><span class="op" id="8671252">,</span>&nbsp;<span class="string" id="8671254">&#34;foo&#34;</span><span class="op" id="8671259">,</span>&nbsp;<span class="string" id="8671261">&#34;bar&#34;</span><span class="op" id="8671266">,</span>&nbsp;<span class="string" id="8671268">&#34;&#34;</span><span class="op" id="8671270">}</span><span class="op" id="8671271">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8671275">{</span><span class="string" id="8671276">`;foo=&#34;bar&#34;;&nbsp;`</span><span class="op" id="8671290">,</span>&nbsp;<span class="string" id="8671292">&#34;foo&#34;</span><span class="op" id="8671297">,</span>&nbsp;<span class="string" id="8671299">&#34;bar&#34;</span><span class="op" id="8671304">,</span>&nbsp;<span class="string" id="8671306">&#34;;&nbsp;&#34;</span><span class="op" id="8671310">}</span><span class="op" id="8671311">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8671315">{</span><span class="string" id="8671316">`;foo=&#34;bar&#34;;&nbsp;foo=baz`</span><span class="op" id="8671337">,</span>&nbsp;<span class="string" id="8671339">&#34;foo&#34;</span><span class="op" id="8671344">,</span>&nbsp;<span class="string" id="8671346">&#34;bar&#34;</span><span class="op" id="8671351">,</span>&nbsp;<span class="string" id="8671353">&#34;;&nbsp;foo=baz&#34;</span><span class="op" id="8671364">}</span><span class="op" id="8671365">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8671369">{</span><span class="string" id="8671370">`&nbsp;;&nbsp;boundary=----CUT;`</span><span class="op" id="8671392">,</span>&nbsp;<span class="string" id="8671394">&#34;boundary&#34;</span><span class="op" id="8671404">,</span>&nbsp;<span class="string" id="8671406">&#34;----CUT&#34;</span><span class="op" id="8671415">,</span>&nbsp;<span class="string" id="8671417">&#34;;&#34;</span><span class="op" id="8671420">}</span><span class="op" id="8671421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8671425">{</span><span class="string" id="8671426">`&nbsp;;&nbsp;key=value;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8671467">,</span>&nbsp;<span class="string" id="8671469">&#34;key&#34;</span><span class="op" id="8671474">,</span>&nbsp;<span class="string" id="8671476">&#34;value&#34;</span><span class="op" id="8671483">,</span>&nbsp;<span class="string" id="8671485">`;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8671514">}</span><span class="op" id="8671515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8671519">{</span><span class="string" id="8671520">`;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8671549">,</span>&nbsp;<span class="string" id="8671551">&#34;blah&#34;</span><span class="op" id="8671557">,</span>&nbsp;<span class="string" id="8671559">&#34;value&#34;</span><span class="op" id="8671566">,</span>&nbsp;<span class="string" id="8671568">`;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8671582">}</span><span class="op" id="8671583">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8671587">{</span><span class="string" id="8671588">`;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8671602">,</span>&nbsp;<span class="string" id="8671604">&#34;name&#34;</span><span class="op" id="8671610">,</span>&nbsp;<span class="string" id="8671612">&#34;foo&#34;</span><span class="op" id="8671617">,</span>&nbsp;<span class="string" id="8671619">`&nbsp;`</span><span class="op" id="8671622">}</span><span class="op" id="8671623">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8671626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8671629">for</span>&nbsp;<span class="ident" id="8671633">_</span><span class="op" id="8671634">,</span>&nbsp;<span class="ident" id="8671636">test</span>&nbsp;<span class="op" id="8671641">:=</span>&nbsp;<span class="keyword" id="8671644">range</span>&nbsp;<span class="ident" id="8671650">tests</span>&nbsp;<span class="op" id="8671656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8671660">param</span><span class="op" id="8671665">,</span>&nbsp;<span class="ident" id="8671667">value</span><span class="op" id="8671672">,</span>&nbsp;<span class="ident" id="8671674">rest</span>&nbsp;<span class="op" id="8671679">:=</span>&nbsp;<span class="ident" id="8671682">consumeMediaParam</span><span class="op" id="8671699">(</span><span class="ident" id="8671700">test</span><span class="op" id="8671704">[</span><span class="num" id="8671705">0</span><span class="op" id="8671706">]</span><span class="op" id="8671707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8671711">expectedParam</span>&nbsp;<span class="op" id="8671725">:=</span>&nbsp;<span class="ident" id="8671728">test</span><span class="op" id="8671732">[</span><span class="num" id="8671733">1</span><span class="op" id="8671734">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8671738">expectedValue</span>&nbsp;<span class="op" id="8671752">:=</span>&nbsp;<span class="ident" id="8671755">test</span><span class="op" id="8671759">[</span><span class="num" id="8671760">2</span><span class="op" id="8671761">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8671765">expectedRest</span>&nbsp;<span class="op" id="8671778">:=</span>&nbsp;<span class="ident" id="8671781">test</span><span class="op" id="8671785">[</span><span class="num" id="8671786">3</span><span class="op" id="8671787">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8671791">if</span>&nbsp;<span class="ident" id="8671794">param</span>&nbsp;<span class="op" id="8671800">!=</span>&nbsp;<span class="ident" id="8671803">expectedParam</span>&nbsp;<span class="op" id="8671817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8671822">t</span><span class="op" id="8671823">.</span><span class="ident" id="8671824">Errorf</span><span class="op" id="8671830">(</span><span class="string" id="8671831">&#34;expected&nbsp;to&nbsp;consume&nbsp;param&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8671883">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8671889">expectedParam</span><span class="op" id="8671902">,</span>&nbsp;<span class="ident" id="8671904">param</span><span class="op" id="8671909">,</span>&nbsp;<span class="ident" id="8671911">test</span><span class="op" id="8671915">[</span><span class="num" id="8671916">0</span><span class="op" id="8671917">]</span><span class="op" id="8671918">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8671922">}</span>&nbsp;<span class="keyword" id="8671924">else</span>&nbsp;<span class="keyword" id="8671929">if</span>&nbsp;<span class="ident" id="8671932">value</span>&nbsp;<span class="op" id="8671938">!=</span>&nbsp;<span class="ident" id="8671941">expectedValue</span>&nbsp;<span class="op" id="8671955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8671960">t</span><span class="op" id="8671961">.</span><span class="ident" id="8671962">Errorf</span><span class="op" id="8671968">(</span><span class="string" id="8671969">&#34;expected&nbsp;to&nbsp;consume&nbsp;value&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8672021">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8672027">expectedValue</span><span class="op" id="8672040">,</span>&nbsp;<span class="ident" id="8672042">value</span><span class="op" id="8672047">,</span>&nbsp;<span class="ident" id="8672049">test</span><span class="op" id="8672053">[</span><span class="num" id="8672054">0</span><span class="op" id="8672055">]</span><span class="op" id="8672056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8672060">}</span>&nbsp;<span class="keyword" id="8672062">else</span>&nbsp;<span class="keyword" id="8672067">if</span>&nbsp;<span class="ident" id="8672070">rest</span>&nbsp;<span class="op" id="8672075">!=</span>&nbsp;<span class="ident" id="8672078">expectedRest</span>&nbsp;<span class="op" id="8672091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8672096">t</span><span class="op" id="8672097">.</span><span class="ident" id="8672098">Errorf</span><span class="op" id="8672104">(</span><span class="string" id="8672105">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;after&nbsp;reading&nbsp;[%s/%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8672175">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8672181">expectedRest</span><span class="op" id="8672193">,</span>&nbsp;<span class="ident" id="8672195">rest</span><span class="op" id="8672199">,</span>&nbsp;<span class="ident" id="8672201">param</span><span class="op" id="8672206">,</span>&nbsp;<span class="ident" id="8672208">value</span><span class="op" id="8672213">,</span>&nbsp;<span class="ident" id="8672215">test</span><span class="op" id="8672219">[</span><span class="num" id="8672220">0</span><span class="op" id="8672221">]</span><span class="op" id="8672222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8672226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8672229">}</span><br>
<span class="lineno"></span><span class="op" id="8672231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="8672234">type</span>&nbsp;<span class="ident" id="8672239">mediaTypeTest</span>&nbsp;<span class="keyword" id="8672253">struct</span>&nbsp;<span class="op" id="8672260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8672263">in</span>&nbsp;<span class="builtintype" id="8672266">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8672274">t</span>&nbsp;&nbsp;<span class="builtintype" id="8672277">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8672285">p</span>&nbsp;&nbsp;<span class="keyword" id="8672288">map</span><span class="op" id="8672291">[</span><span class="builtintype" id="8672292">string</span><span class="op" id="8672298">]</span><span class="builtintype" id="8672299">string</span><br>
<span class="lineno"></span><span class="op" id="8672306">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="8672309">func</span>&nbsp;<span class="ident" id="8672314">TestParseMediaType</span><span class="op" id="8672332">(</span><span class="ident" id="8672333">t</span>&nbsp;<span class="op" id="8672335">*</span><span class="ident" id="8672336">testing</span><span class="op" id="8672343">.</span><span class="ident" id="8672344">T</span><span class="op" id="8672345">)</span>&nbsp;<span class="op" id="8672347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8672350">//&nbsp;Convenience&nbsp;map&nbsp;initializer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8672382">m</span>&nbsp;<span class="op" id="8672384">:=</span>&nbsp;<span class="keyword" id="8672387">func</span><span class="op" id="8672391">(</span><span class="ident" id="8672392">s</span>&nbsp;<span class="op" id="8672394">...</span><span class="builtintype" id="8672397">string</span><span class="op" id="8672403">)</span>&nbsp;<span class="keyword" id="8672405">map</span><span class="op" id="8672408">[</span><span class="builtintype" id="8672409">string</span><span class="op" id="8672415">]</span><span class="builtintype" id="8672416">string</span>&nbsp;<span class="op" id="8672423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8672427">sm</span>&nbsp;<span class="op" id="8672430">:=</span>&nbsp;<span class="builtinfunc" id="8672433">make</span><span class="op" id="8672437">(</span><span class="keyword" id="8672438">map</span><span class="op" id="8672441">[</span><span class="builtintype" id="8672442">string</span><span class="op" id="8672448">]</span><span class="builtintype" id="8672449">string</span><span class="op" id="8672455">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8672459">for</span>&nbsp;<span class="ident" id="8672463">i</span>&nbsp;<span class="op" id="8672465">:=</span>&nbsp;<span class="num" id="8672468">0</span><span class="op" id="8672469">;</span>&nbsp;<span class="ident" id="8672471">i</span>&nbsp;<span class="op" id="8672473">&lt;</span>&nbsp;<span class="builtinfunc" id="8672475">len</span><span class="op" id="8672478">(</span><span class="ident" id="8672479">s</span><span class="op" id="8672480">)</span><span class="op" id="8672481">;</span>&nbsp;<span class="ident" id="8672483">i</span>&nbsp;<span class="op" id="8672485">+=</span>&nbsp;<span class="num" id="8672488">2</span>&nbsp;<span class="op" id="8672490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8672495">sm</span><span class="op" id="8672497">[</span><span class="ident" id="8672498">s</span><span class="op" id="8672499">[</span><span class="ident" id="8672500">i</span><span class="op" id="8672501">]</span><span class="op" id="8672502">]</span>&nbsp;<span class="op" id="8672504">=</span>&nbsp;<span class="ident" id="8672506">s</span><span class="op" id="8672507">[</span><span class="ident" id="8672508">i</span><span class="op" id="8672509">+</span><span class="num" id="8672510">1</span><span class="op" id="8672511">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8672515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8672519">return</span>&nbsp;<span class="ident" id="8672526">sm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8672530">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8672534">nameFoo</span>&nbsp;<span class="op" id="8672542">:=</span>&nbsp;<span class="keyword" id="8672545">map</span><span class="op" id="8672548">[</span><span class="builtintype" id="8672549">string</span><span class="op" id="8672555">]</span><span class="builtintype" id="8672556">string</span><span class="op" id="8672562">{</span><span class="string" id="8672563">&#34;name&#34;</span><span class="op" id="8672569">:</span>&nbsp;<span class="string" id="8672571">&#34;foo&#34;</span><span class="op" id="8672576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8672579">tests</span>&nbsp;<span class="op" id="8672585">:=</span>&nbsp;<span class="op" id="8672588">[</span><span class="op" id="8672589">]</span><span class="ident" id="8672590">mediaTypeTest</span><span class="op" id="8672603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8672607">{</span><span class="string" id="8672608">`form-data;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="8672631">,</span>&nbsp;<span class="string" id="8672633">&#34;form-data&#34;</span><span class="op" id="8672644">,</span>&nbsp;<span class="ident" id="8672646">nameFoo</span><span class="op" id="8672653">}</span><span class="op" id="8672654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8672658">{</span><span class="string" id="8672659">`&nbsp;form-data&nbsp;;&nbsp;name=foo`</span><span class="op" id="8672682">,</span>&nbsp;<span class="string" id="8672684">&#34;form-data&#34;</span><span class="op" id="8672695">,</span>&nbsp;<span class="ident" id="8672697">nameFoo</span><span class="op" id="8672704">}</span><span class="op" id="8672705">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8672709">{</span><span class="string" id="8672710">`FORM-DATA;name=&#34;foo&#34;`</span><span class="op" id="8672732">,</span>&nbsp;<span class="string" id="8672734">&#34;form-data&#34;</span><span class="op" id="8672745">,</span>&nbsp;<span class="ident" id="8672747">nameFoo</span><span class="op" id="8672754">}</span><span class="op" id="8672755">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8672759">{</span><span class="string" id="8672760">`&nbsp;FORM-DATA&nbsp;;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="8672785">,</span>&nbsp;<span class="string" id="8672787">&#34;form-data&#34;</span><span class="op" id="8672798">,</span>&nbsp;<span class="ident" id="8672800">nameFoo</span><span class="op" id="8672807">}</span><span class="op" id="8672808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8672812">{</span><span class="string" id="8672813">`&nbsp;FORM-DATA&nbsp;;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="8672838">,</span>&nbsp;<span class="string" id="8672840">&#34;form-data&#34;</span><span class="op" id="8672851">,</span>&nbsp;<span class="ident" id="8672853">nameFoo</span><span class="op" id="8672860">}</span><span class="op" id="8672861">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8672866">{</span><span class="string" id="8672867">`form-data;&nbsp;key=value;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8672916">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8672921">&#34;form-data&#34;</span><span class="op" id="8672932">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8672937">m</span><span class="op" id="8672938">(</span><span class="string" id="8672939">&#34;key&#34;</span><span class="op" id="8672944">,</span>&nbsp;<span class="string" id="8672946">&#34;value&#34;</span><span class="op" id="8672953">,</span>&nbsp;<span class="string" id="8672955">&#34;blah&#34;</span><span class="op" id="8672961">,</span>&nbsp;<span class="string" id="8672963">&#34;value&#34;</span><span class="op" id="8672970">,</span>&nbsp;<span class="string" id="8672972">&#34;name&#34;</span><span class="op" id="8672978">,</span>&nbsp;<span class="string" id="8672980">&#34;foo&#34;</span><span class="op" id="8672985">)</span><span class="op" id="8672986">}</span><span class="op" id="8672987">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8672992">{</span><span class="string" id="8672993">`foo;&nbsp;key=val1;&nbsp;key=the-key-appears-again-which-is-bogus`</span><span class="op" id="8673050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8673055">&#34;&#34;</span><span class="op" id="8673057">,</span>&nbsp;<span class="ident" id="8673059">m</span><span class="op" id="8673060">(</span><span class="op" id="8673061">)</span><span class="op" id="8673062">}</span><span class="op" id="8673063">,</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8673068">//&nbsp;From&nbsp;RFC&nbsp;2231:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8673088">{</span><span class="string" id="8673089">`application/x-stuff;&nbsp;title*=us-ascii&#39;en-us&#39;This%20is%20%2A%2A%2Afun%2A%2A%2A`</span><span class="op" id="8673167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8673172">&#34;application/x-stuff&#34;</span><span class="op" id="8673193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8673198">m</span><span class="op" id="8673199">(</span><span class="string" id="8673200">&#34;title&#34;</span><span class="op" id="8673207">,</span>&nbsp;<span class="string" id="8673209">&#34;This&nbsp;is&nbsp;***fun***&#34;</span><span class="op" id="8673228">)</span><span class="op" id="8673229">}</span><span class="op" id="8673230">,</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8673235">{</span><span class="string" id="8673236">`message/external-body;&nbsp;access-type=URL;&nbsp;`</span>&nbsp;<span class="op" id="8673279">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8673284">`URL*0=&#34;ftp://&#34;;`</span>&nbsp;<span class="op" id="8673302">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8673307">`URL*1=&#34;cs.utk.edu/pub/moore/bulk-mailer/bulk-mailer.tar&#34;`</span><span class="op" id="8673365">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8673370">&#34;message/external-body&#34;</span><span class="op" id="8673393">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8673398">m</span><span class="op" id="8673399">(</span><span class="string" id="8673400">&#34;access-type&#34;</span><span class="op" id="8673413">,</span>&nbsp;<span class="string" id="8673415">&#34;URL&#34;</span><span class="op" id="8673420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8673426">&#34;url&#34;</span><span class="op" id="8673431">,</span>&nbsp;<span class="string" id="8673433">&#34;ftp://cs.utk.edu/pub/moore/bulk-mailer/bulk-mailer.tar&#34;</span><span class="op" id="8673489">)</span><span class="op" id="8673490">}</span><span class="op" id="8673491">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8673496">{</span><span class="string" id="8673497">`application/x-stuff;&nbsp;`</span>&nbsp;<span class="op" id="8673521">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8673526">`title*0*=us-ascii&#39;en&#39;This%20is%20even%20more%20;&nbsp;`</span>&nbsp;<span class="op" id="8673578">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8673583">`title*1*=%2A%2A%2Afun%2A%2A%2A%20;&nbsp;`</span>&nbsp;<span class="op" id="8673621">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8673626">`title*2=&#34;isn&#39;t&nbsp;it!&#34;`</span><span class="op" id="8673647">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8673652">&#34;application/x-stuff&#34;</span><span class="op" id="8673673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8673678">m</span><span class="op" id="8673679">(</span><span class="string" id="8673680">&#34;title&#34;</span><span class="op" id="8673687">,</span>&nbsp;<span class="string" id="8673689">&#34;This&nbsp;is&nbsp;even&nbsp;more&nbsp;***fun***&nbsp;isn&#39;t&nbsp;it!&#34;</span><span class="op" id="8673728">)</span><span class="op" id="8673729">}</span><span class="op" id="8673730">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8673735">//&nbsp;Tests&nbsp;from&nbsp;http://greenbytes.de/tech/tc2231/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8673785">//&nbsp;TODO(bradfitz):&nbsp;add&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;tests&nbsp;from&nbsp;that&nbsp;site.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8673848">{</span><span class="string" id="8673849">`attachment;&nbsp;filename=&#34;f\oo.html&#34;`</span><span class="op" id="8673883">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8673888">&#34;attachment&#34;</span><span class="op" id="8673900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8673905">m</span><span class="op" id="8673906">(</span><span class="string" id="8673907">&#34;filename&#34;</span><span class="op" id="8673917">,</span>&nbsp;<span class="string" id="8673919">&#34;foo.html&#34;</span><span class="op" id="8673929">)</span><span class="op" id="8673930">}</span><span class="op" id="8673931">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8673935">{</span><span class="string" id="8673936">`attachment;&nbsp;filename=&#34;\&#34;quoting\&#34;&nbsp;tested.html&#34;`</span><span class="op" id="8673984">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8673989">&#34;attachment&#34;</span><span class="op" id="8674001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8674006">m</span><span class="op" id="8674007">(</span><span class="string" id="8674008">&#34;filename&#34;</span><span class="op" id="8674018">,</span>&nbsp;<span class="string" id="8674020">`&#34;quoting&#34;&nbsp;tested.html`</span><span class="op" id="8674043">)</span><span class="op" id="8674044">}</span><span class="op" id="8674045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8674049">{</span><span class="string" id="8674050">`attachment;&nbsp;filename=&#34;Here&#39;s&nbsp;a&nbsp;semicolon;.html&#34;`</span><span class="op" id="8674099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8674104">&#34;attachment&#34;</span><span class="op" id="8674116">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8674121">m</span><span class="op" id="8674122">(</span><span class="string" id="8674123">&#34;filename&#34;</span><span class="op" id="8674133">,</span>&nbsp;<span class="string" id="8674135">&#34;Here&#39;s&nbsp;a&nbsp;semicolon;.html&#34;</span><span class="op" id="8674161">)</span><span class="op" id="8674162">}</span><span class="op" id="8674163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8674167">{</span><span class="string" id="8674168">`attachment;&nbsp;foo=&#34;\&#34;\\&#34;;filename=&#34;foo.html&#34;`</span><span class="op" id="8674212">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8674217">&#34;attachment&#34;</span><span class="op" id="8674229">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8674234">m</span><span class="op" id="8674235">(</span><span class="string" id="8674236">&#34;foo&#34;</span><span class="op" id="8674241">,</span>&nbsp;<span class="string" id="8674243">&#34;\&#34;\\&#34;</span><span class="op" id="8674249">,</span>&nbsp;<span class="string" id="8674251">&#34;filename&#34;</span><span class="op" id="8674261">,</span>&nbsp;<span class="string" id="8674263">&#34;foo.html&#34;</span><span class="op" id="8674273">)</span><span class="op" id="8674274">}</span><span class="op" id="8674275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8674279">{</span><span class="string" id="8674280">`attachment;&nbsp;filename=foo.html`</span><span class="op" id="8674311">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8674316">&#34;attachment&#34;</span><span class="op" id="8674328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8674333">m</span><span class="op" id="8674334">(</span><span class="string" id="8674335">&#34;filename&#34;</span><span class="op" id="8674345">,</span>&nbsp;<span class="string" id="8674347">&#34;foo.html&#34;</span><span class="op" id="8674357">)</span><span class="op" id="8674358">}</span><span class="op" id="8674359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8674363">{</span><span class="string" id="8674364">`attachment;&nbsp;filename=foo.html&nbsp;;`</span><span class="op" id="8674397">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8674402">&#34;attachment&#34;</span><span class="op" id="8674414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8674419">m</span><span class="op" id="8674420">(</span><span class="string" id="8674421">&#34;filename&#34;</span><span class="op" id="8674431">,</span>&nbsp;<span class="string" id="8674433">&#34;foo.html&#34;</span><span class="op" id="8674443">)</span><span class="op" id="8674444">}</span><span class="op" id="8674445">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8674449">{</span><span class="string" id="8674450">`attachment;&nbsp;filename=&#39;foo.html&#39;`</span><span class="op" id="8674483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8674488">&#34;attachment&#34;</span><span class="op" id="8674500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8674505">m</span><span class="op" id="8674506">(</span><span class="string" id="8674507">&#34;filename&#34;</span><span class="op" id="8674517">,</span>&nbsp;<span class="string" id="8674519">&#34;foo.html&#34;</span><span class="op" id="8674529">)</span><span class="op" id="8674530">}</span><span class="op" id="8674531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8674535">{</span><span class="string" id="8674536">`attachment;&nbsp;filename=&#34;foo-%41.html&#34;`</span><span class="op" id="8674573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8674578">&#34;attachment&#34;</span><span class="op" id="8674590">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8674595">m</span><span class="op" id="8674596">(</span><span class="string" id="8674597">&#34;filename&#34;</span><span class="op" id="8674607">,</span>&nbsp;<span class="string" id="8674609">&#34;foo-%41.html&#34;</span><span class="op" id="8674623">)</span><span class="op" id="8674624">}</span><span class="op" id="8674625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8674629">{</span><span class="string" id="8674630">`attachment;&nbsp;filename=&#34;foo-%\41.html&#34;`</span><span class="op" id="8674668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8674673">&#34;attachment&#34;</span><span class="op" id="8674685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8674690">m</span><span class="op" id="8674691">(</span><span class="string" id="8674692">&#34;filename&#34;</span><span class="op" id="8674702">,</span>&nbsp;<span class="string" id="8674704">&#34;foo-%41.html&#34;</span><span class="op" id="8674718">)</span><span class="op" id="8674719">}</span><span class="op" id="8674720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8674724">{</span><span class="string" id="8674725">`filename=foo.html`</span><span class="op" id="8674744">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8674749">&#34;&#34;</span><span class="op" id="8674751">,</span>&nbsp;<span class="ident" id="8674753">m</span><span class="op" id="8674754">(</span><span class="op" id="8674755">)</span><span class="op" id="8674756">}</span><span class="op" id="8674757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8674761">{</span><span class="string" id="8674762">`x=y;&nbsp;filename=foo.html`</span><span class="op" id="8674786">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8674791">&#34;&#34;</span><span class="op" id="8674793">,</span>&nbsp;<span class="ident" id="8674795">m</span><span class="op" id="8674796">(</span><span class="op" id="8674797">)</span><span class="op" id="8674798">}</span><span class="op" id="8674799">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8674803">{</span><span class="string" id="8674804">`&#34;foo;&nbsp;filename=bar;baz&#34;;&nbsp;filename=qux`</span><span class="op" id="8674843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8674848">&#34;&#34;</span><span class="op" id="8674850">,</span>&nbsp;<span class="ident" id="8674852">m</span><span class="op" id="8674853">(</span><span class="op" id="8674854">)</span><span class="op" id="8674855">}</span><span class="op" id="8674856">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8674860">{</span><span class="string" id="8674861">`inline;&nbsp;attachment;&nbsp;filename=foo.html`</span><span class="op" id="8674900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8674905">&#34;&#34;</span><span class="op" id="8674907">,</span>&nbsp;<span class="ident" id="8674909">m</span><span class="op" id="8674910">(</span><span class="op" id="8674911">)</span><span class="op" id="8674912">}</span><span class="op" id="8674913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8674917">{</span><span class="string" id="8674918">`attachment;&nbsp;filename=&#34;foo.html&#34;.txt`</span><span class="op" id="8674955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8674960">&#34;&#34;</span><span class="op" id="8674962">,</span>&nbsp;<span class="ident" id="8674964">m</span><span class="op" id="8674965">(</span><span class="op" id="8674966">)</span><span class="op" id="8674967">}</span><span class="op" id="8674968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8674972">{</span><span class="string" id="8674973">`attachment;&nbsp;filename=&#34;bar`</span><span class="op" id="8675000">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8675005">&#34;&#34;</span><span class="op" id="8675007">,</span>&nbsp;<span class="ident" id="8675009">m</span><span class="op" id="8675010">(</span><span class="op" id="8675011">)</span><span class="op" id="8675012">}</span><span class="op" id="8675013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8675017">{</span><span class="string" id="8675018">`attachment;&nbsp;creation-date=&#34;Wed,&nbsp;12&nbsp;Feb&nbsp;1997&nbsp;16:29:51&nbsp;-0500&#34;`</span><span class="op" id="8675079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8675084">&#34;attachment&#34;</span><span class="op" id="8675096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8675101">m</span><span class="op" id="8675102">(</span><span class="string" id="8675103">&#34;creation-date&#34;</span><span class="op" id="8675118">,</span>&nbsp;<span class="string" id="8675120">&#34;Wed,&nbsp;12&nbsp;Feb&nbsp;1997&nbsp;16:29:51&nbsp;-0500&#34;</span><span class="op" id="8675153">)</span><span class="op" id="8675154">}</span><span class="op" id="8675155">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8675159">{</span><span class="string" id="8675160">`foobar`</span><span class="op" id="8675168">,</span>&nbsp;<span class="string" id="8675170">&#34;foobar&#34;</span><span class="op" id="8675178">,</span>&nbsp;<span class="ident" id="8675180">m</span><span class="op" id="8675181">(</span><span class="op" id="8675182">)</span><span class="op" id="8675183">}</span><span class="op" id="8675184">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8675188">{</span><span class="string" id="8675189">`attachment;&nbsp;filename*&nbsp;=UTF-8&#39;&#39;foo-%c3%a4.html`</span><span class="op" id="8675236">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8675241">&#34;attachment&#34;</span><span class="op" id="8675253">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8675258">m</span><span class="op" id="8675259">(</span><span class="string" id="8675260">&#34;filename&#34;</span><span class="op" id="8675270">,</span>&nbsp;<span class="string" id="8675272">&#34;foo-ä.html&#34;</span><span class="op" id="8675285">)</span><span class="op" id="8675286">}</span><span class="op" id="8675287">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8675291">{</span><span class="string" id="8675292">`attachment;&nbsp;filename*=UTF-8&#39;&#39;A-%2541.html`</span><span class="op" id="8675335">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8675340">&#34;attachment&#34;</span><span class="op" id="8675352">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8675357">m</span><span class="op" id="8675358">(</span><span class="string" id="8675359">&#34;filename&#34;</span><span class="op" id="8675369">,</span>&nbsp;<span class="string" id="8675371">&#34;A-%41.html&#34;</span><span class="op" id="8675383">)</span><span class="op" id="8675384">}</span><span class="op" id="8675385">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8675389">{</span><span class="string" id="8675390">`attachment;&nbsp;filename*0=&#34;foo.&#34;;&nbsp;filename*1=&#34;html&#34;`</span><span class="op" id="8675440">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8675445">&#34;attachment&#34;</span><span class="op" id="8675457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8675462">m</span><span class="op" id="8675463">(</span><span class="string" id="8675464">&#34;filename&#34;</span><span class="op" id="8675474">,</span>&nbsp;<span class="string" id="8675476">&#34;foo.html&#34;</span><span class="op" id="8675486">)</span><span class="op" id="8675487">}</span><span class="op" id="8675488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8675492">{</span><span class="string" id="8675493">`attachment;&nbsp;filename*0*=UTF-8&#39;&#39;foo-%c3%a4;&nbsp;filename*1=&#34;.html&#34;`</span><span class="op" id="8675556">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8675561">&#34;attachment&#34;</span><span class="op" id="8675573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8675578">m</span><span class="op" id="8675579">(</span><span class="string" id="8675580">&#34;filename&#34;</span><span class="op" id="8675590">,</span>&nbsp;<span class="string" id="8675592">&#34;foo-ä.html&#34;</span><span class="op" id="8675605">)</span><span class="op" id="8675606">}</span><span class="op" id="8675607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8675611">{</span><span class="string" id="8675612">`attachment;&nbsp;filename*0=&#34;foo&#34;;&nbsp;filename*01=&#34;bar&#34;`</span><span class="op" id="8675661">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8675666">&#34;attachment&#34;</span><span class="op" id="8675678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8675683">m</span><span class="op" id="8675684">(</span><span class="string" id="8675685">&#34;filename&#34;</span><span class="op" id="8675695">,</span>&nbsp;<span class="string" id="8675697">&#34;foo&#34;</span><span class="op" id="8675702">)</span><span class="op" id="8675703">}</span><span class="op" id="8675704">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8675708">{</span><span class="string" id="8675709">`attachment;&nbsp;filename*0=&#34;foo&#34;;&nbsp;filename*2=&#34;bar&#34;`</span><span class="op" id="8675757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8675762">&#34;attachment&#34;</span><span class="op" id="8675774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8675779">m</span><span class="op" id="8675780">(</span><span class="string" id="8675781">&#34;filename&#34;</span><span class="op" id="8675791">,</span>&nbsp;<span class="string" id="8675793">&#34;foo&#34;</span><span class="op" id="8675798">)</span><span class="op" id="8675799">}</span><span class="op" id="8675800">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8675804">{</span><span class="string" id="8675805">`attachment;&nbsp;filename*1=&#34;foo&#34;;&nbsp;filename*2=&#34;bar&#34;`</span><span class="op" id="8675853">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8675858">&#34;attachment&#34;</span><span class="op" id="8675870">,</span>&nbsp;<span class="ident" id="8675872">m</span><span class="op" id="8675873">(</span><span class="op" id="8675874">)</span><span class="op" id="8675875">}</span><span class="op" id="8675876">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8675880">{</span><span class="string" id="8675881">`attachment;&nbsp;filename*1=&#34;bar&#34;;&nbsp;filename*0=&#34;foo&#34;`</span><span class="op" id="8675929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8675934">&#34;attachment&#34;</span><span class="op" id="8675946">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8675951">m</span><span class="op" id="8675952">(</span><span class="string" id="8675953">&#34;filename&#34;</span><span class="op" id="8675963">,</span>&nbsp;<span class="string" id="8675965">&#34;foobar&#34;</span><span class="op" id="8675973">)</span><span class="op" id="8675974">}</span><span class="op" id="8675975">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8675979">{</span><span class="string" id="8675980">`attachment;&nbsp;filename=&#34;foo-ae.html&#34;;&nbsp;filename*=UTF-8&#39;&#39;foo-%c3%a4.html`</span><span class="op" id="8676050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8676055">&#34;attachment&#34;</span><span class="op" id="8676067">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8676072">m</span><span class="op" id="8676073">(</span><span class="string" id="8676074">&#34;filename&#34;</span><span class="op" id="8676084">,</span>&nbsp;<span class="string" id="8676086">&#34;foo-ä.html&#34;</span><span class="op" id="8676099">)</span><span class="op" id="8676100">}</span><span class="op" id="8676101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8676105">{</span><span class="string" id="8676106">`attachment;&nbsp;filename*=UTF-8&#39;&#39;foo-%c3%a4.html;&nbsp;filename=&#34;foo-ae.html&#34;`</span><span class="op" id="8676176">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8676181">&#34;attachment&#34;</span><span class="op" id="8676193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8676198">m</span><span class="op" id="8676199">(</span><span class="string" id="8676200">&#34;filename&#34;</span><span class="op" id="8676210">,</span>&nbsp;<span class="string" id="8676212">&#34;foo-ä.html&#34;</span><span class="op" id="8676225">)</span><span class="op" id="8676226">}</span><span class="op" id="8676227">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8676232">//&nbsp;Browsers&nbsp;also&nbsp;just&nbsp;send&nbsp;UTF-8&nbsp;directly&nbsp;without&nbsp;RFC&nbsp;2231,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8676294">//&nbsp;at&nbsp;least&nbsp;when&nbsp;the&nbsp;source&nbsp;page&nbsp;is&nbsp;served&nbsp;with&nbsp;UTF-8.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8676351">{</span><span class="string" id="8676352">`form-data;&nbsp;firstname=&#34;Брэд&#34;;&nbsp;lastname=&#34;Фицпатрик&#34;`</span><span class="op" id="8676416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8676421">&#34;form-data&#34;</span><span class="op" id="8676432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8676437">m</span><span class="op" id="8676438">(</span><span class="string" id="8676439">&#34;firstname&#34;</span><span class="op" id="8676450">,</span>&nbsp;<span class="string" id="8676452">&#34;Брэд&#34;</span><span class="op" id="8676462">,</span>&nbsp;<span class="string" id="8676464">&#34;lastname&#34;</span><span class="op" id="8676474">,</span>&nbsp;<span class="string" id="8676476">&#34;Фицпатрик&#34;</span><span class="op" id="8676496">)</span><span class="op" id="8676497">}</span><span class="op" id="8676498">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8676501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8676504">for</span>&nbsp;<span class="ident" id="8676508">_</span><span class="op" id="8676509">,</span>&nbsp;<span class="ident" id="8676511">test</span>&nbsp;<span class="op" id="8676516">:=</span>&nbsp;<span class="keyword" id="8676519">range</span>&nbsp;<span class="ident" id="8676525">tests</span>&nbsp;<span class="op" id="8676531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8676535">mt</span><span class="op" id="8676537">,</span>&nbsp;<span class="ident" id="8676539">params</span><span class="op" id="8676545">,</span>&nbsp;<span class="ident" id="8676547">err</span>&nbsp;<span class="op" id="8676551">:=</span>&nbsp;<span class="ident" id="8676554">ParseMediaType</span><span class="op" id="8676568">(</span><span class="ident" id="8676569">test</span><span class="op" id="8676573">.</span><span class="ident" id="8676574">in</span><span class="op" id="8676576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8676580">if</span>&nbsp;<span class="ident" id="8676583">err</span>&nbsp;<span class="op" id="8676587">!=</span>&nbsp;<span class="ident" id="8676590">nil</span>&nbsp;<span class="op" id="8676594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8676599">if</span>&nbsp;<span class="ident" id="8676602">test</span><span class="op" id="8676606">.</span><span class="ident" id="8676607">t</span>&nbsp;<span class="op" id="8676609">!=</span>&nbsp;<span class="string" id="8676612">&#34;&#34;</span>&nbsp;<span class="op" id="8676615">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8676621">t</span><span class="op" id="8676622">.</span><span class="ident" id="8676623">Errorf</span><span class="op" id="8676629">(</span><span class="string" id="8676630">&#34;for&nbsp;input&nbsp;%q,&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8676666">,</span>&nbsp;<span class="ident" id="8676668">test</span><span class="op" id="8676672">.</span><span class="ident" id="8676673">in</span><span class="op" id="8676675">,</span>&nbsp;<span class="ident" id="8676677">err</span><span class="op" id="8676680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8676686">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8676698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8676703">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8676714">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8676718">if</span>&nbsp;<span class="ident" id="8676721">g</span><span class="op" id="8676722">,</span>&nbsp;<span class="ident" id="8676724">e</span>&nbsp;<span class="op" id="8676726">:=</span>&nbsp;<span class="ident" id="8676729">mt</span><span class="op" id="8676731">,</span>&nbsp;<span class="ident" id="8676733">test</span><span class="op" id="8676737">.</span><span class="ident" id="8676738">t</span><span class="op" id="8676739">;</span>&nbsp;<span class="ident" id="8676741">g</span>&nbsp;<span class="op" id="8676743">!=</span>&nbsp;<span class="ident" id="8676746">e</span>&nbsp;<span class="op" id="8676748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8676753">t</span><span class="op" id="8676754">.</span><span class="ident" id="8676755">Errorf</span><span class="op" id="8676761">(</span><span class="string" id="8676762">&#34;for&nbsp;input&nbsp;%q,&nbsp;expected&nbsp;type&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8676802">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8676808">test</span><span class="op" id="8676812">.</span><span class="ident" id="8676813">in</span><span class="op" id="8676815">,</span>&nbsp;<span class="ident" id="8676817">e</span><span class="op" id="8676818">,</span>&nbsp;<span class="ident" id="8676820">g</span><span class="op" id="8676821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8676826">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8676837">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8676841">if</span>&nbsp;<span class="builtinfunc" id="8676844">len</span><span class="op" id="8676847">(</span><span class="ident" id="8676848">params</span><span class="op" id="8676854">)</span>&nbsp;<span class="op" id="8676856">==</span>&nbsp;<span class="num" id="8676859">0</span>&nbsp;<span class="op" id="8676861">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="8676864">len</span><span class="op" id="8676867">(</span><span class="ident" id="8676868">test</span><span class="op" id="8676872">.</span><span class="ident" id="8676873">p</span><span class="op" id="8676874">)</span>&nbsp;<span class="op" id="8676876">==</span>&nbsp;<span class="num" id="8676879">0</span>&nbsp;<span class="op" id="8676881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8676886">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8676897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8676901">if</span>&nbsp;<span class="op" id="8676904">!</span><span class="ident" id="8676905">reflect</span><span class="op" id="8676912">.</span><span class="ident" id="8676913">DeepEqual</span><span class="op" id="8676922">(</span><span class="ident" id="8676923">params</span><span class="op" id="8676929">,</span>&nbsp;<span class="ident" id="8676931">test</span><span class="op" id="8676935">.</span><span class="ident" id="8676936">p</span><span class="op" id="8676937">)</span>&nbsp;<span class="op" id="8676939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8676944">t</span><span class="op" id="8676945">.</span><span class="ident" id="8676946">Errorf</span><span class="op" id="8676952">(</span><span class="string" id="8676953">&#34;for&nbsp;input&nbsp;%q,&nbsp;wrong&nbsp;params.\n&#34;</span><span class="op" id="8676984">+</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8676990">&#34;expected:&nbsp;%#v\n&#34;</span><span class="op" id="8677007">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8677013">&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;got:&nbsp;%#v&#34;</span><span class="op" id="8677028">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677034">test</span><span class="op" id="8677038">.</span><span class="ident" id="8677039">in</span><span class="op" id="8677041">,</span>&nbsp;<span class="ident" id="8677043">test</span><span class="op" id="8677047">.</span><span class="ident" id="8677048">p</span><span class="op" id="8677049">,</span>&nbsp;<span class="ident" id="8677051">params</span><span class="op" id="8677057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8677061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8677064">}</span><br>
<span class="lineno">245</span><span class="op" id="8677066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8677069">type</span>&nbsp;<span class="ident" id="8677074">badMediaTypeTest</span>&nbsp;<span class="keyword" id="8677091">struct</span>&nbsp;<span class="op" id="8677098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677101">in</span>&nbsp;&nbsp;<span class="builtintype" id="8677105">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677113">err</span>&nbsp;<span class="builtintype" id="8677117">string</span><br>
<span class="lineno">250</span><span class="op" id="8677124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8677127">var</span>&nbsp;<span class="ident" id="8677131">badMediaTypeTests</span>&nbsp;<span class="op" id="8677149">=</span>&nbsp;<span class="op" id="8677151">[</span><span class="op" id="8677152">]</span><span class="ident" id="8677153">badMediaTypeTest</span><span class="op" id="8677169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8677172">{</span><span class="string" id="8677173">&#34;bogus&nbsp;;=========&#34;</span><span class="op" id="8677191">,</span>&nbsp;<span class="string" id="8677193">&#34;mime:&nbsp;invalid&nbsp;media&nbsp;parameter&#34;</span><span class="op" id="8677224">}</span><span class="op" id="8677225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8677228">{</span><span class="string" id="8677229">&#34;bogus/&lt;script&gt;alert&lt;/script&gt;&#34;</span><span class="op" id="8677259">,</span>&nbsp;<span class="string" id="8677261">&#34;mime:&nbsp;expected&nbsp;token&nbsp;after&nbsp;slash&#34;</span><span class="op" id="8677295">}</span><span class="op" id="8677296">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8677299">{</span><span class="string" id="8677300">&#34;bogus/bogus&lt;script&gt;alert&lt;/script&gt;&#34;</span><span class="op" id="8677335">,</span>&nbsp;<span class="string" id="8677337">&#34;mime:&nbsp;unexpected&nbsp;content&nbsp;after&nbsp;media&nbsp;subtype&#34;</span><span class="op" id="8677383">}</span><span class="op" id="8677384">,</span><br>
<span class="lineno"></span><span class="op" id="8677386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8677389">func</span>&nbsp;<span class="ident" id="8677394">TestParseMediaTypeBogus</span><span class="op" id="8677417">(</span><span class="ident" id="8677418">t</span>&nbsp;<span class="op" id="8677420">*</span><span class="ident" id="8677421">testing</span><span class="op" id="8677428">.</span><span class="ident" id="8677429">T</span><span class="op" id="8677430">)</span>&nbsp;<span class="op" id="8677432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8677435">for</span>&nbsp;<span class="ident" id="8677439">_</span><span class="op" id="8677440">,</span>&nbsp;<span class="ident" id="8677442">tt</span>&nbsp;<span class="op" id="8677445">:=</span>&nbsp;<span class="keyword" id="8677448">range</span>&nbsp;<span class="ident" id="8677454">badMediaTypeTests</span>&nbsp;<span class="op" id="8677472">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677476">mt</span><span class="op" id="8677478">,</span>&nbsp;<span class="ident" id="8677480">params</span><span class="op" id="8677486">,</span>&nbsp;<span class="ident" id="8677488">err</span>&nbsp;<span class="op" id="8677492">:=</span>&nbsp;<span class="ident" id="8677495">ParseMediaType</span><span class="op" id="8677509">(</span><span class="ident" id="8677510">tt</span><span class="op" id="8677512">.</span><span class="ident" id="8677513">in</span><span class="op" id="8677515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8677519">if</span>&nbsp;<span class="ident" id="8677522">err</span>&nbsp;<span class="op" id="8677526">==</span>&nbsp;<span class="ident" id="8677529">nil</span>&nbsp;<span class="op" id="8677533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677538">t</span><span class="op" id="8677539">.</span><span class="ident" id="8677540">Errorf</span><span class="op" id="8677546">(</span><span class="string" id="8677547">&#34;ParseMediaType(%q)&nbsp;=&nbsp;nil&nbsp;error;&nbsp;want&nbsp;parse&nbsp;error&#34;</span><span class="op" id="8677597">,</span>&nbsp;<span class="ident" id="8677599">tt</span><span class="op" id="8677601">.</span><span class="ident" id="8677602">in</span><span class="op" id="8677604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8677609">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8677620">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8677624">if</span>&nbsp;<span class="ident" id="8677627">err</span><span class="op" id="8677630">.</span><span class="ident" id="8677631">Error</span><span class="op" id="8677636">(</span><span class="op" id="8677637">)</span>&nbsp;<span class="op" id="8677639">!=</span>&nbsp;<span class="ident" id="8677642">tt</span><span class="op" id="8677644">.</span><span class="ident" id="8677645">err</span>&nbsp;<span class="op" id="8677649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677654">t</span><span class="op" id="8677655">.</span><span class="ident" id="8677656">Errorf</span><span class="op" id="8677662">(</span><span class="string" id="8677663">&#34;ParseMediaType(%q)&nbsp;=&nbsp;err&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8677701">,</span>&nbsp;<span class="ident" id="8677703">tt</span><span class="op" id="8677705">.</span><span class="ident" id="8677706">in</span><span class="op" id="8677708">,</span>&nbsp;<span class="ident" id="8677710">err</span><span class="op" id="8677713">.</span><span class="ident" id="8677714">Error</span><span class="op" id="8677719">(</span><span class="op" id="8677720">)</span><span class="op" id="8677721">,</span>&nbsp;<span class="ident" id="8677723">tt</span><span class="op" id="8677725">.</span><span class="ident" id="8677726">err</span><span class="op" id="8677729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8677733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8677737">if</span>&nbsp;<span class="ident" id="8677740">params</span>&nbsp;<span class="op" id="8677747">!=</span>&nbsp;<span class="ident" id="8677750">nil</span>&nbsp;<span class="op" id="8677754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677759">t</span><span class="op" id="8677760">.</span><span class="ident" id="8677761">Errorf</span><span class="op" id="8677767">(</span><span class="string" id="8677768">&#34;ParseMediaType(%q):&nbsp;got&nbsp;non-nil&nbsp;params&nbsp;on&nbsp;error&#34;</span><span class="op" id="8677817">,</span>&nbsp;<span class="ident" id="8677819">tt</span><span class="op" id="8677821">.</span><span class="ident" id="8677822">in</span><span class="op" id="8677824">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8677828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8677832">if</span>&nbsp;<span class="ident" id="8677835">mt</span>&nbsp;<span class="op" id="8677838">!=</span>&nbsp;<span class="string" id="8677841">&#34;&#34;</span>&nbsp;<span class="op" id="8677844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677849">t</span><span class="op" id="8677850">.</span><span class="ident" id="8677851">Errorf</span><span class="op" id="8677857">(</span><span class="string" id="8677858">&#34;ParseMediaType(%q):&nbsp;got&nbsp;non-empty&nbsp;media&nbsp;type&nbsp;string&nbsp;on&nbsp;error&#34;</span><span class="op" id="8677920">,</span>&nbsp;<span class="ident" id="8677922">tt</span><span class="op" id="8677924">.</span><span class="ident" id="8677925">in</span><span class="op" id="8677927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8677931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8677934">}</span><br>
<span class="lineno">275</span><span class="op" id="8677936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8677939">type</span>&nbsp;<span class="ident" id="8677944">formatTest</span>&nbsp;<span class="keyword" id="8677955">struct</span>&nbsp;<span class="op" id="8677962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677965">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8677972">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8677980">params</span>&nbsp;<span class="keyword" id="8677987">map</span><span class="op" id="8677990">[</span><span class="builtintype" id="8677991">string</span><span class="op" id="8677997">]</span><span class="builtintype" id="8677998">string</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8678006">want</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8678013">string</span><br>
<span class="lineno"></span><span class="op" id="8678020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8678023">var</span>&nbsp;<span class="ident" id="8678027">formatTests</span>&nbsp;<span class="op" id="8678039">=</span>&nbsp;<span class="op" id="8678041">[</span><span class="op" id="8678042">]</span><span class="ident" id="8678043">formatTest</span><span class="op" id="8678053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8678056">{</span><span class="string" id="8678057">&#34;noslash&#34;</span><span class="op" id="8678066">,</span>&nbsp;<span class="ident" id="8678068">nil</span><span class="op" id="8678071">,</span>&nbsp;<span class="string" id="8678073">&#34;&#34;</span><span class="op" id="8678075">}</span><span class="op" id="8678076">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8678079">{</span><span class="string" id="8678080">&#34;foo&nbsp;bar/baz&#34;</span><span class="op" id="8678093">,</span>&nbsp;<span class="ident" id="8678095">nil</span><span class="op" id="8678098">,</span>&nbsp;<span class="string" id="8678100">&#34;&#34;</span><span class="op" id="8678102">}</span><span class="op" id="8678103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8678106">{</span><span class="string" id="8678107">&#34;foo/bar&nbsp;baz&#34;</span><span class="op" id="8678120">,</span>&nbsp;<span class="ident" id="8678122">nil</span><span class="op" id="8678125">,</span>&nbsp;<span class="string" id="8678127">&#34;&#34;</span><span class="op" id="8678129">}</span><span class="op" id="8678130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8678133">{</span><span class="string" id="8678134">&#34;foo/BAR&#34;</span><span class="op" id="8678143">,</span>&nbsp;<span class="ident" id="8678145">nil</span><span class="op" id="8678148">,</span>&nbsp;<span class="string" id="8678150">&#34;foo/bar&#34;</span><span class="op" id="8678159">}</span><span class="op" id="8678160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8678163">{</span><span class="string" id="8678164">&#34;foo/BAR&#34;</span><span class="op" id="8678173">,</span>&nbsp;<span class="keyword" id="8678175">map</span><span class="op" id="8678178">[</span><span class="builtintype" id="8678179">string</span><span class="op" id="8678185">]</span><span class="builtintype" id="8678186">string</span><span class="op" id="8678192">{</span><span class="string" id="8678193">&#34;X&#34;</span><span class="op" id="8678196">:</span>&nbsp;<span class="string" id="8678198">&#34;Y&#34;</span><span class="op" id="8678201">}</span><span class="op" id="8678202">,</span>&nbsp;<span class="string" id="8678204">&#34;foo/bar;&nbsp;x=Y&#34;</span><span class="op" id="8678218">}</span><span class="op" id="8678219">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8678222">{</span><span class="string" id="8678223">&#34;foo/BAR&#34;</span><span class="op" id="8678232">,</span>&nbsp;<span class="keyword" id="8678234">map</span><span class="op" id="8678237">[</span><span class="builtintype" id="8678238">string</span><span class="op" id="8678244">]</span><span class="builtintype" id="8678245">string</span><span class="op" id="8678251">{</span><span class="string" id="8678252">&#34;space&#34;</span><span class="op" id="8678259">:</span>&nbsp;<span class="string" id="8678261">&#34;With&nbsp;space&#34;</span><span class="op" id="8678273">}</span><span class="op" id="8678274">,</span>&nbsp;<span class="string" id="8678276">`foo/bar;&nbsp;space=&#34;With&nbsp;space&#34;`</span><span class="op" id="8678305">}</span><span class="op" id="8678306">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8678309">{</span><span class="string" id="8678310">&#34;foo/BAR&#34;</span><span class="op" id="8678319">,</span>&nbsp;<span class="keyword" id="8678321">map</span><span class="op" id="8678324">[</span><span class="builtintype" id="8678325">string</span><span class="op" id="8678331">]</span><span class="builtintype" id="8678332">string</span><span class="op" id="8678338">{</span><span class="string" id="8678339">&#34;quote&#34;</span><span class="op" id="8678346">:</span>&nbsp;<span class="string" id="8678348">`With&nbsp;&#34;quote`</span><span class="op" id="8678361">}</span><span class="op" id="8678362">,</span>&nbsp;<span class="string" id="8678364">`foo/bar;&nbsp;quote=&#34;With&nbsp;\&#34;quote&#34;`</span><span class="op" id="8678395">}</span><span class="op" id="8678396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8678399">{</span><span class="string" id="8678400">&#34;foo/BAR&#34;</span><span class="op" id="8678409">,</span>&nbsp;<span class="keyword" id="8678411">map</span><span class="op" id="8678414">[</span><span class="builtintype" id="8678415">string</span><span class="op" id="8678421">]</span><span class="builtintype" id="8678422">string</span><span class="op" id="8678428">{</span><span class="string" id="8678429">&#34;bslash&#34;</span><span class="op" id="8678437">:</span>&nbsp;<span class="string" id="8678439">`With&nbsp;\backslash`</span><span class="op" id="8678456">}</span><span class="op" id="8678457">,</span>&nbsp;<span class="string" id="8678459">`foo/bar;&nbsp;bslash=&#34;With&nbsp;\\backslash&#34;`</span><span class="op" id="8678495">}</span><span class="op" id="8678496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8678499">{</span><span class="string" id="8678500">&#34;foo/BAR&#34;</span><span class="op" id="8678509">,</span>&nbsp;<span class="keyword" id="8678511">map</span><span class="op" id="8678514">[</span><span class="builtintype" id="8678515">string</span><span class="op" id="8678521">]</span><span class="builtintype" id="8678522">string</span><span class="op" id="8678528">{</span><span class="string" id="8678529">&#34;both&#34;</span><span class="op" id="8678535">:</span>&nbsp;<span class="string" id="8678537">`With&nbsp;\backslash&nbsp;and&nbsp;&#34;quote`</span><span class="op" id="8678565">}</span><span class="op" id="8678566">,</span>&nbsp;<span class="string" id="8678568">`foo/bar;&nbsp;both=&#34;With&nbsp;\\backslash&nbsp;and&nbsp;\&#34;quote&#34;`</span><span class="op" id="8678614">}</span><span class="op" id="8678615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8678618">{</span><span class="string" id="8678619">&#34;foo/BAR&#34;</span><span class="op" id="8678628">,</span>&nbsp;<span class="keyword" id="8678630">map</span><span class="op" id="8678633">[</span><span class="builtintype" id="8678634">string</span><span class="op" id="8678640">]</span><span class="builtintype" id="8678641">string</span><span class="op" id="8678647">{</span><span class="string" id="8678648">&#34;&#34;</span><span class="op" id="8678650">:</span>&nbsp;<span class="string" id="8678652">&#34;empty&nbsp;attribute&#34;</span><span class="op" id="8678669">}</span><span class="op" id="8678670">,</span>&nbsp;<span class="string" id="8678672">&#34;&#34;</span><span class="op" id="8678674">}</span><span class="op" id="8678675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8678678">{</span><span class="string" id="8678679">&#34;foo/BAR&#34;</span><span class="op" id="8678688">,</span>&nbsp;<span class="keyword" id="8678690">map</span><span class="op" id="8678693">[</span><span class="builtintype" id="8678694">string</span><span class="op" id="8678700">]</span><span class="builtintype" id="8678701">string</span><span class="op" id="8678707">{</span><span class="string" id="8678708">&#34;bad&nbsp;attribute&#34;</span><span class="op" id="8678723">:</span>&nbsp;<span class="string" id="8678725">&#34;baz&#34;</span><span class="op" id="8678730">}</span><span class="op" id="8678731">,</span>&nbsp;<span class="string" id="8678733">&#34;&#34;</span><span class="op" id="8678735">}</span><span class="op" id="8678736">,</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8678739">{</span><span class="string" id="8678740">&#34;foo/BAR&#34;</span><span class="op" id="8678749">,</span>&nbsp;<span class="keyword" id="8678751">map</span><span class="op" id="8678754">[</span><span class="builtintype" id="8678755">string</span><span class="op" id="8678761">]</span><span class="builtintype" id="8678762">string</span><span class="op" id="8678768">{</span><span class="string" id="8678769">&#34;nonascii&#34;</span><span class="op" id="8678779">:</span>&nbsp;<span class="string" id="8678781">&#34;not&nbsp;an&nbsp;ascii&nbsp;character:&nbsp;ä&#34;</span><span class="op" id="8678809">}</span><span class="op" id="8678810">,</span>&nbsp;<span class="string" id="8678812">&#34;&#34;</span><span class="op" id="8678814">}</span><span class="op" id="8678815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8678818">{</span><span class="string" id="8678819">&#34;foo/bar&#34;</span><span class="op" id="8678828">,</span>&nbsp;<span class="keyword" id="8678830">map</span><span class="op" id="8678833">[</span><span class="builtintype" id="8678834">string</span><span class="op" id="8678840">]</span><span class="builtintype" id="8678841">string</span><span class="op" id="8678847">{</span><span class="string" id="8678848">&#34;a&#34;</span><span class="op" id="8678851">:</span>&nbsp;<span class="string" id="8678853">&#34;av&#34;</span><span class="op" id="8678857">,</span>&nbsp;<span class="string" id="8678859">&#34;b&#34;</span><span class="op" id="8678862">:</span>&nbsp;<span class="string" id="8678864">&#34;bv&#34;</span><span class="op" id="8678868">,</span>&nbsp;<span class="string" id="8678870">&#34;c&#34;</span><span class="op" id="8678873">:</span>&nbsp;<span class="string" id="8678875">&#34;cv&#34;</span><span class="op" id="8678879">}</span><span class="op" id="8678880">,</span>&nbsp;<span class="string" id="8678882">&#34;foo/bar;&nbsp;a=av;&nbsp;b=bv;&nbsp;c=cv&#34;</span><span class="op" id="8678909">}</span><span class="op" id="8678910">,</span><br>
<span class="lineno"></span><span class="op" id="8678912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8678915">func</span>&nbsp;<span class="ident" id="8678920">TestFormatMediaType</span><span class="op" id="8678939">(</span><span class="ident" id="8678940">t</span>&nbsp;<span class="op" id="8678942">*</span><span class="ident" id="8678943">testing</span><span class="op" id="8678950">.</span><span class="ident" id="8678951">T</span><span class="op" id="8678952">)</span>&nbsp;<span class="op" id="8678954">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8678957">for</span>&nbsp;<span class="ident" id="8678961">i</span><span class="op" id="8678962">,</span>&nbsp;<span class="ident" id="8678964">tt</span>&nbsp;<span class="op" id="8678967">:=</span>&nbsp;<span class="keyword" id="8678970">range</span>&nbsp;<span class="ident" id="8678976">formatTests</span>&nbsp;<span class="op" id="8678988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8678992">got</span>&nbsp;<span class="op" id="8678996">:=</span>&nbsp;<span class="ident" id="8678999">FormatMediaType</span><span class="op" id="8679014">(</span><span class="ident" id="8679015">tt</span><span class="op" id="8679017">.</span><span class="ident" id="8679018">typ</span><span class="op" id="8679021">,</span>&nbsp;<span class="ident" id="8679023">tt</span><span class="op" id="8679025">.</span><span class="ident" id="8679026">params</span><span class="op" id="8679032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8679036">if</span>&nbsp;<span class="ident" id="8679039">got</span>&nbsp;<span class="op" id="8679043">!=</span>&nbsp;<span class="ident" id="8679046">tt</span><span class="op" id="8679048">.</span><span class="ident" id="8679049">want</span>&nbsp;<span class="op" id="8679054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8679059">t</span><span class="op" id="8679060">.</span><span class="ident" id="8679061">Errorf</span><span class="op" id="8679067">(</span><span class="string" id="8679068">&#34;%d.&nbsp;FormatMediaType(%q,&nbsp;%v)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8679111">,</span>&nbsp;<span class="ident" id="8679113">i</span><span class="op" id="8679114">,</span>&nbsp;<span class="ident" id="8679116">tt</span><span class="op" id="8679118">.</span><span class="ident" id="8679119">typ</span><span class="op" id="8679122">,</span>&nbsp;<span class="ident" id="8679124">tt</span><span class="op" id="8679126">.</span><span class="ident" id="8679127">params</span><span class="op" id="8679133">,</span>&nbsp;<span class="ident" id="8679135">got</span><span class="op" id="8679138">,</span>&nbsp;<span class="ident" id="8679140">tt</span><span class="op" id="8679142">.</span><span class="ident" id="8679143">want</span><span class="op" id="8679147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8679151">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8679154">}</span><br>
<span class="lineno"></span><span class="op" id="8679156">}</span>
</div>
</body>
</html>
