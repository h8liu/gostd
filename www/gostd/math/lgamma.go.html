<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html" class="current">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2180310">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2180365">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2180419">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2180470">package</span>&nbsp;<span class="ident" id="2180478">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2180484">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;Floating-point&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2180540">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2180594">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_lgamma_r.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2180651">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2180706">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2180736">//</span><br>
<span class="lineno"></span><span class="comment" id="2180739">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2180795">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2180864">//</span><br>
<span class="lineno"></span><span class="comment" id="2180867">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2180926">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2180982">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2181039">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2181056">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2181112">//</span><br>
<span class="lineno">25</span><span class="comment" id="2181115">//&nbsp;__ieee754_lgamma_r(x,&nbsp;signgamp)</span><br>
<span class="lineno"></span><span class="comment" id="2181150">//&nbsp;Reentrant&nbsp;version&nbsp;of&nbsp;the&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2181210">//&nbsp;with&nbsp;user&nbsp;provided&nbsp;pointer&nbsp;for&nbsp;the&nbsp;sign&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="2181266">//</span><br>
<span class="lineno"></span><span class="comment" id="2181269">//&nbsp;Method:</span><br>
<span class="lineno">30</span><span class="comment" id="2181280">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;Reduction&nbsp;for&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;=&nbsp;8</span><br>
<span class="lineno"></span><span class="comment" id="2181322">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Since&nbsp;gamma(1+s)=s*gamma(s),&nbsp;for&nbsp;x&nbsp;in&nbsp;[0,8],&nbsp;we&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="2181382">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reduce&nbsp;x&nbsp;to&nbsp;a&nbsp;number&nbsp;in&nbsp;[1.5,2.5]&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2181427">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1+s)&nbsp;=&nbsp;log(s)&nbsp;+&nbsp;lgamma(s)</span><br>
<span class="lineno"></span><span class="comment" id="2181476">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;example,</span><br>
<span class="lineno">35</span><span class="comment" id="2181497">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(7.3)&nbsp;=&nbsp;log(6.3)&nbsp;+&nbsp;lgamma(6.3)</span><br>
<span class="lineno"></span><span class="comment" id="2181550">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3)&nbsp;+&nbsp;lgamma(5.3)</span><br>
<span class="lineno"></span><span class="comment" id="2181607">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3*4.3*3.3*2.3)&nbsp;+&nbsp;lgamma(2.3)</span><br>
<span class="lineno"></span><span class="comment" id="2181676">//&nbsp;&nbsp;&nbsp;2.&nbsp;Polynomial&nbsp;approximation&nbsp;of&nbsp;lgamma&nbsp;around&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="2181730">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;(ymin=1.461632144968362245)&nbsp;to&nbsp;maintain&nbsp;monotonicity.</span><br>
<span class="lineno">40</span><span class="comment" id="2181800">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;[ymin-0.23,&nbsp;ymin+0.27]&nbsp;(i.e.,&nbsp;[1.23164,1.73163]),&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="2181865">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;x-ymin;</span><br>
<span class="lineno"></span><span class="comment" id="2181897">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;-1.214862905358496078218&nbsp;+&nbsp;z**2*poly(z)</span><br>
<span class="lineno"></span><span class="comment" id="2181965">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;poly(z)&nbsp;is&nbsp;a&nbsp;14&nbsp;degree&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="comment" id="2182016">//&nbsp;&nbsp;&nbsp;2.&nbsp;Rational&nbsp;approximation&nbsp;in&nbsp;the&nbsp;primary&nbsp;interval&nbsp;[2,3]</span><br>
<span class="lineno">45</span><span class="comment" id="2182077">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;the&nbsp;following&nbsp;approximation:</span><br>
<span class="lineno"></span><span class="comment" id="2182121">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;=&nbsp;x-2.0;</span><br>
<span class="lineno"></span><span class="comment" id="2182148">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;0.5*s&nbsp;+&nbsp;s*P(s)/Q(s)</span><br>
<span class="lineno"></span><span class="comment" id="2182196">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;accuracy</span><br>
<span class="lineno"></span><span class="comment" id="2182218">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P/Q&nbsp;-&nbsp;(lgamma(x)-0.5s)|&nbsp;&lt;&nbsp;2**-61.71</span><br>
<span class="lineno">50</span><span class="comment" id="2182271">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Our&nbsp;algorithms&nbsp;are&nbsp;based&nbsp;on&nbsp;the&nbsp;following&nbsp;observation</span><br>
<span class="lineno"></span><span class="comment" id="2182333">//</span><br>
<span class="lineno"></span><span class="comment" id="2182336">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zeta(2)-1&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;zeta(3)-1&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno"></span><span class="comment" id="2182400">//&nbsp;lgamma(2+s)&nbsp;=&nbsp;s*(1-Euler)&nbsp;+&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;-&nbsp;&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="2182470">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno">55</span><span class="comment" id="2182525">//</span><br>
<span class="lineno"></span><span class="comment" id="2182528">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;Euler&nbsp;=&nbsp;0.5772156649...&nbsp;is&nbsp;the&nbsp;Euler&nbsp;constant,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="2182595">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;very&nbsp;close&nbsp;to&nbsp;0.5.</span><br>
<span class="lineno"></span><span class="comment" id="2182625">//</span><br>
<span class="lineno"></span><span class="comment" id="2182628">//&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&gt;=8,&nbsp;we&nbsp;have</span><br>
<span class="lineno">60</span><span class="comment" id="2182654">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)log(x)-x+0.5*log(2pi)+1/(12x)-1/(360x**3)+....</span><br>
<span class="lineno"></span><span class="comment" id="2182726">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(better&nbsp;formula:</span><br>
<span class="lineno"></span><span class="comment" id="2182751">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)*(log(x)-1)-.5*(log(2pi)-1)&nbsp;+&nbsp;...)</span><br>
<span class="lineno"></span><span class="comment" id="2182814">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;1/x,&nbsp;then&nbsp;we&nbsp;approximation</span><br>
<span class="lineno"></span><span class="comment" id="2182857">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f(z)&nbsp;=&nbsp;lgamma(x)&nbsp;-&nbsp;(x-0.5)(log(x)-1)</span><br>
<span class="lineno">65</span><span class="comment" id="2182910">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2182921">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11</span><br>
<span class="lineno"></span><span class="comment" id="2182982">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;=&nbsp;w0&nbsp;+&nbsp;w1*z&nbsp;+&nbsp;w2*z&nbsp;&nbsp;+&nbsp;w3*z&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;w6*z</span><br>
<span class="lineno"></span><span class="comment" id="2183041">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2183055">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|w&nbsp;-&nbsp;f(z)|&nbsp;&lt;&nbsp;2**-58.74</span><br>
<span class="lineno">70</span><span class="comment" id="2183094">//</span><br>
<span class="lineno"></span><span class="comment" id="2183097">//&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;negative&nbsp;x,&nbsp;since&nbsp;(G&nbsp;is&nbsp;gamma&nbsp;function)</span><br>
<span class="lineno"></span><span class="comment" id="2183149">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*G(-x)*G(x)&nbsp;=&nbsp;pi/sin(pi*x),</span><br>
<span class="lineno"></span><span class="comment" id="2183195">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;we&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2183211">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G(x)&nbsp;=&nbsp;pi/(sin(pi*x)*(-x)*G(-x))</span><br>
<span class="lineno">75</span><span class="comment" id="2183260">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;since&nbsp;G(-x)&nbsp;is&nbsp;positive,&nbsp;sign(G(x))&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;for&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="2183330">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hence,&nbsp;for&nbsp;x&lt;0,&nbsp;signgam&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2183384">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;log(|Gamma(x)|)</span><br>
<span class="lineno"></span><span class="comment" id="2183428">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(pi/(|x*sin(pi*x)|))&nbsp;-&nbsp;lgamma(-x);</span><br>
<span class="lineno"></span><span class="comment" id="2183494">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note:&nbsp;one&nbsp;should&nbsp;avoid&nbsp;computing&nbsp;pi*(-x)&nbsp;directly&nbsp;in&nbsp;the</span><br>
<span class="lineno">80</span><span class="comment" id="2183559">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;computation&nbsp;of&nbsp;sin(pi*(-x)).</span><br>
<span class="lineno"></span><span class="comment" id="2183602">//</span><br>
<span class="lineno"></span><span class="comment" id="2183605">//&nbsp;&nbsp;&nbsp;5.&nbsp;Special&nbsp;Cases</span><br>
<span class="lineno"></span><span class="comment" id="2183627">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(2+s)&nbsp;~&nbsp;s*(1-Euler)&nbsp;for&nbsp;tiny&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2183680">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1)=lgamma(2)=0</span><br>
<span class="lineno">85</span><span class="comment" id="2183718">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;~&nbsp;-log(x)&nbsp;for&nbsp;tiny&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="2183765">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(0)&nbsp;=&nbsp;lgamma(inf)&nbsp;=&nbsp;inf</span><br>
<span class="lineno"></span><span class="comment" id="2183811">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(-integer)&nbsp;=&nbsp;+-inf</span><br>
<span class="lineno"></span><span class="comment" id="2183852">//</span><br>
<span class="lineno"></span><span class="comment" id="2183855">//</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="2183859">var</span>&nbsp;<span class="ident" id="2183863">_lgamA</span>&nbsp;<span class="op" id="2183870">=</span>&nbsp;<span class="op" id="2183872">[</span><span class="op" id="2183873">...</span><span class="op" id="2183876">]</span><span class="builtintype" id="2183877">float64</span><span class="op" id="2183884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2183887">7.72156649015328655494e-02</span><span class="op" id="2183913">,</span>&nbsp;<span class="comment" id="2183915">//&nbsp;0x3FB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2183938">3.22467033424113591611e-01</span><span class="op" id="2183964">,</span>&nbsp;<span class="comment" id="2183966">//&nbsp;0x3FD4A34CC4A60FAD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2183989">6.73523010531292681824e-02</span><span class="op" id="2184015">,</span>&nbsp;<span class="comment" id="2184017">//&nbsp;0x3FB13E001A5562A7</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2184040">2.05808084325167332806e-02</span><span class="op" id="2184066">,</span>&nbsp;<span class="comment" id="2184068">//&nbsp;0x3F951322AC92547B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2184091">7.38555086081402883957e-03</span><span class="op" id="2184117">,</span>&nbsp;<span class="comment" id="2184119">//&nbsp;0x3F7E404FB68FEFE8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2184142">2.89051383673415629091e-03</span><span class="op" id="2184168">,</span>&nbsp;<span class="comment" id="2184170">//&nbsp;0x3F67ADD8CCB7926B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2184193">1.19270763183362067845e-03</span><span class="op" id="2184219">,</span>&nbsp;<span class="comment" id="2184221">//&nbsp;0x3F538A94116F3F5D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2184244">5.10069792153511336608e-04</span><span class="op" id="2184270">,</span>&nbsp;<span class="comment" id="2184272">//&nbsp;0x3F40B6C689B99C00</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2184295">2.20862790713908385557e-04</span><span class="op" id="2184321">,</span>&nbsp;<span class="comment" id="2184323">//&nbsp;0x3F2CF2ECED10E54D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2184346">1.08011567247583939954e-04</span><span class="op" id="2184372">,</span>&nbsp;<span class="comment" id="2184374">//&nbsp;0x3F1C5088987DFB07</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2184397">2.52144565451257326939e-05</span><span class="op" id="2184423">,</span>&nbsp;<span class="comment" id="2184425">//&nbsp;0x3EFA7074428CFA52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2184448">4.48640949618915160150e-05</span><span class="op" id="2184474">,</span>&nbsp;<span class="comment" id="2184476">//&nbsp;0x3F07858E90A45837</span><br>
<span class="lineno"></span><span class="op" id="2184498">}</span><br>
<span class="lineno">105</span><span class="keyword" id="2184500">var</span>&nbsp;<span class="ident" id="2184504">_lgamR</span>&nbsp;<span class="op" id="2184511">=</span>&nbsp;<span class="op" id="2184513">[</span><span class="op" id="2184514">...</span><span class="op" id="2184517">]</span><span class="builtintype" id="2184518">float64</span><span class="op" id="2184525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2184528">1.0</span><span class="op" id="2184531">,</span>&nbsp;<span class="comment" id="2184533">//&nbsp;placeholder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2184549">1.39200533467621045958e+00</span><span class="op" id="2184575">,</span>&nbsp;<span class="comment" id="2184577">//&nbsp;0x3FF645A762C4AB74</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2184600">7.21935547567138069525e-01</span><span class="op" id="2184626">,</span>&nbsp;<span class="comment" id="2184628">//&nbsp;0x3FE71A1893D3DCDC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2184651">1.71933865632803078993e-01</span><span class="op" id="2184677">,</span>&nbsp;<span class="comment" id="2184679">//&nbsp;0x3FC601EDCCFBDF27</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2184702">1.86459191715652901344e-02</span><span class="op" id="2184728">,</span>&nbsp;<span class="comment" id="2184730">//&nbsp;0x3F9317EA742ED475</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2184753">7.77942496381893596434e-04</span><span class="op" id="2184779">,</span>&nbsp;<span class="comment" id="2184781">//&nbsp;0x3F497DDACA41A95B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2184804">7.32668430744625636189e-06</span><span class="op" id="2184830">,</span>&nbsp;<span class="comment" id="2184832">//&nbsp;0x3EDEBAF7A5B38140</span><br>
<span class="lineno"></span><span class="op" id="2184854">}</span><br>
<span class="lineno"></span><span class="keyword" id="2184856">var</span>&nbsp;<span class="ident" id="2184860">_lgamS</span>&nbsp;<span class="op" id="2184867">=</span>&nbsp;<span class="op" id="2184869">[</span><span class="op" id="2184870">...</span><span class="op" id="2184873">]</span><span class="builtintype" id="2184874">float64</span><span class="op" id="2184881">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2184884">-</span><span class="num" id="2184885">7.72156649015328655494e-02</span><span class="op" id="2184911">,</span>&nbsp;<span class="comment" id="2184913">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2184936">2.14982415960608852501e-01</span><span class="op" id="2184962">,</span>&nbsp;&nbsp;<span class="comment" id="2184965">//&nbsp;0x3FCB848B36E20878</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2184988">3.25778796408930981787e-01</span><span class="op" id="2185014">,</span>&nbsp;&nbsp;<span class="comment" id="2185017">//&nbsp;0x3FD4D98F4F139F59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2185040">1.46350472652464452805e-01</span><span class="op" id="2185066">,</span>&nbsp;&nbsp;<span class="comment" id="2185069">//&nbsp;0x3FC2BB9CBEE5F2F7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2185092">2.66422703033638609560e-02</span><span class="op" id="2185118">,</span>&nbsp;&nbsp;<span class="comment" id="2185121">//&nbsp;0x3F9B481C7E939961</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2185144">1.84028451407337715652e-03</span><span class="op" id="2185170">,</span>&nbsp;&nbsp;<span class="comment" id="2185173">//&nbsp;0x3F5E26B67368F239</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2185196">3.19475326584100867617e-05</span><span class="op" id="2185222">,</span>&nbsp;&nbsp;<span class="comment" id="2185225">//&nbsp;0x3F00BFECDD17E945</span><br>
<span class="lineno"></span><span class="op" id="2185247">}</span><br>
<span class="lineno"></span><span class="keyword" id="2185249">var</span>&nbsp;<span class="ident" id="2185253">_lgamT</span>&nbsp;<span class="op" id="2185260">=</span>&nbsp;<span class="op" id="2185262">[</span><span class="op" id="2185263">...</span><span class="op" id="2185266">]</span><span class="builtintype" id="2185267">float64</span><span class="op" id="2185274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2185277">4.83836122723810047042e-01</span><span class="op" id="2185303">,</span>&nbsp;&nbsp;<span class="comment" id="2185306">//&nbsp;0x3FDEF72BC8EE38A2</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2185329">-</span><span class="num" id="2185330">1.47587722994593911752e-01</span><span class="op" id="2185356">,</span>&nbsp;<span class="comment" id="2185358">//&nbsp;0xBFC2E4278DC6C509</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2185381">6.46249402391333854778e-02</span><span class="op" id="2185407">,</span>&nbsp;&nbsp;<span class="comment" id="2185410">//&nbsp;0x3FB08B4294D5419B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2185433">-</span><span class="num" id="2185434">3.27885410759859649565e-02</span><span class="op" id="2185460">,</span>&nbsp;<span class="comment" id="2185462">//&nbsp;0xBFA0C9A8DF35B713</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2185485">1.79706750811820387126e-02</span><span class="op" id="2185511">,</span>&nbsp;&nbsp;<span class="comment" id="2185514">//&nbsp;0x3F9266E7970AF9EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2185537">-</span><span class="num" id="2185538">1.03142241298341437450e-02</span><span class="op" id="2185564">,</span>&nbsp;<span class="comment" id="2185566">//&nbsp;0xBF851F9FBA91EC6A</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2185589">6.10053870246291332635e-03</span><span class="op" id="2185615">,</span>&nbsp;&nbsp;<span class="comment" id="2185618">//&nbsp;0x3F78FCE0E370E344</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2185641">-</span><span class="num" id="2185642">3.68452016781138256760e-03</span><span class="op" id="2185668">,</span>&nbsp;<span class="comment" id="2185670">//&nbsp;0xBF6E2EFFB3E914D7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2185693">2.25964780900612472250e-03</span><span class="op" id="2185719">,</span>&nbsp;&nbsp;<span class="comment" id="2185722">//&nbsp;0x3F6282D32E15C915</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2185745">-</span><span class="num" id="2185746">1.40346469989232843813e-03</span><span class="op" id="2185772">,</span>&nbsp;<span class="comment" id="2185774">//&nbsp;0xBF56FE8EBF2D1AF1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2185797">8.81081882437654011382e-04</span><span class="op" id="2185823">,</span>&nbsp;&nbsp;<span class="comment" id="2185826">//&nbsp;0x3F4CDF0CEF61A8E9</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2185849">-</span><span class="num" id="2185850">5.38595305356740546715e-04</span><span class="op" id="2185876">,</span>&nbsp;<span class="comment" id="2185878">//&nbsp;0xBF41A6109C73E0EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2185901">3.15632070903625950361e-04</span><span class="op" id="2185927">,</span>&nbsp;&nbsp;<span class="comment" id="2185930">//&nbsp;0x3F34AF6D6C0EBBF7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2185953">-</span><span class="num" id="2185954">3.12754168375120860518e-04</span><span class="op" id="2185980">,</span>&nbsp;<span class="comment" id="2185982">//&nbsp;0xBF347F24ECC38C38</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2186005">3.35529192635519073543e-04</span><span class="op" id="2186031">,</span>&nbsp;&nbsp;<span class="comment" id="2186034">//&nbsp;0x3F35FD3EE8C2D3F4</span><br>
<span class="lineno"></span><span class="op" id="2186056">}</span><br>
<span class="lineno">140</span><span class="keyword" id="2186058">var</span>&nbsp;<span class="ident" id="2186062">_lgamU</span>&nbsp;<span class="op" id="2186069">=</span>&nbsp;<span class="op" id="2186071">[</span><span class="op" id="2186072">...</span><span class="op" id="2186075">]</span><span class="builtintype" id="2186076">float64</span><span class="op" id="2186083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2186086">-</span><span class="num" id="2186087">7.72156649015328655494e-02</span><span class="op" id="2186113">,</span>&nbsp;<span class="comment" id="2186115">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2186138">6.32827064025093366517e-01</span><span class="op" id="2186164">,</span>&nbsp;&nbsp;<span class="comment" id="2186167">//&nbsp;0x3FE4401E8B005DFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2186190">1.45492250137234768737e+00</span><span class="op" id="2186216">,</span>&nbsp;&nbsp;<span class="comment" id="2186219">//&nbsp;0x3FF7475CD119BD6F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2186242">9.77717527963372745603e-01</span><span class="op" id="2186268">,</span>&nbsp;&nbsp;<span class="comment" id="2186271">//&nbsp;0x3FEF497644EA8450</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2186294">2.28963728064692451092e-01</span><span class="op" id="2186320">,</span>&nbsp;&nbsp;<span class="comment" id="2186323">//&nbsp;0x3FCD4EAEF6010924</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2186346">1.33810918536787660377e-02</span><span class="op" id="2186372">,</span>&nbsp;&nbsp;<span class="comment" id="2186375">//&nbsp;0x3F8B678BBF2BAB09</span><br>
<span class="lineno"></span><span class="op" id="2186397">}</span><br>
<span class="lineno"></span><span class="keyword" id="2186399">var</span>&nbsp;<span class="ident" id="2186403">_lgamV</span>&nbsp;<span class="op" id="2186410">=</span>&nbsp;<span class="op" id="2186412">[</span><span class="op" id="2186413">...</span><span class="op" id="2186416">]</span><span class="builtintype" id="2186417">float64</span><span class="op" id="2186424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2186427">1.0</span><span class="op" id="2186430">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2186433">2.45597793713041134822e+00</span><span class="op" id="2186459">,</span>&nbsp;<span class="comment" id="2186461">//&nbsp;0x4003A5D7C2BD619C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2186484">2.12848976379893395361e+00</span><span class="op" id="2186510">,</span>&nbsp;<span class="comment" id="2186512">//&nbsp;0x40010725A42B18F5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2186535">7.69285150456672783825e-01</span><span class="op" id="2186561">,</span>&nbsp;<span class="comment" id="2186563">//&nbsp;0x3FE89DFBE45050AF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2186586">1.04222645593369134254e-01</span><span class="op" id="2186612">,</span>&nbsp;<span class="comment" id="2186614">//&nbsp;0x3FBAAE55D6537C88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2186637">3.21709242282423911810e-03</span><span class="op" id="2186663">,</span>&nbsp;<span class="comment" id="2186665">//&nbsp;0x3F6A5ABB57D0CF61</span><br>
<span class="lineno">155</span><span class="op" id="2186687">}</span><br>
<span class="lineno"></span><span class="keyword" id="2186689">var</span>&nbsp;<span class="ident" id="2186693">_lgamW</span>&nbsp;<span class="op" id="2186700">=</span>&nbsp;<span class="op" id="2186702">[</span><span class="op" id="2186703">...</span><span class="op" id="2186706">]</span><span class="builtintype" id="2186707">float64</span><span class="op" id="2186714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2186717">4.18938533204672725052e-01</span><span class="op" id="2186743">,</span>&nbsp;&nbsp;<span class="comment" id="2186746">//&nbsp;0x3FDACFE390C97D69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2186769">8.33333333333329678849e-02</span><span class="op" id="2186795">,</span>&nbsp;&nbsp;<span class="comment" id="2186798">//&nbsp;0x3FB555555555553B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2186821">-</span><span class="num" id="2186822">2.77777777728775536470e-03</span><span class="op" id="2186848">,</span>&nbsp;<span class="comment" id="2186850">//&nbsp;0xBF66C16C16B02E5C</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2186873">7.93650558643019558500e-04</span><span class="op" id="2186899">,</span>&nbsp;&nbsp;<span class="comment" id="2186902">//&nbsp;0x3F4A019F98CF38B6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2186925">-</span><span class="num" id="2186926">5.95187557450339963135e-04</span><span class="op" id="2186952">,</span>&nbsp;<span class="comment" id="2186954">//&nbsp;0xBF4380CB8C0FE741</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2186977">8.36339918996282139126e-04</span><span class="op" id="2187003">,</span>&nbsp;&nbsp;<span class="comment" id="2187006">//&nbsp;0x3F4B67BA4CDAD5D1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2187029">-</span><span class="num" id="2187030">1.63092934096575273989e-03</span><span class="op" id="2187056">,</span>&nbsp;<span class="comment" id="2187058">//&nbsp;0xBF5AB89D0B9E43E4</span><br>
<span class="lineno"></span><span class="op" id="2187080">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="2187083">//&nbsp;Lgamma&nbsp;returns&nbsp;the&nbsp;natural&nbsp;logarithm&nbsp;and&nbsp;sign&nbsp;(-1&nbsp;or&nbsp;+1)&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="2187156">//</span><br>
<span class="lineno"></span><span class="comment" id="2187159">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2187181">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno">170</span><span class="comment" id="2187204">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2187224">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(-integer)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2187251">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(-Inf)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2187274">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2187295">func</span>&nbsp;<span class="ident" id="2187300">Lgamma</span><span class="op" id="2187306">(</span><span class="ident" id="2187307">x</span>&nbsp;<span class="builtintype" id="2187309">float64</span><span class="op" id="2187316">)</span>&nbsp;<span class="op" id="2187318">(</span><span class="ident" id="2187319">lgamma</span>&nbsp;<span class="builtintype" id="2187326">float64</span><span class="op" id="2187333">,</span>&nbsp;<span class="ident" id="2187335">sign</span>&nbsp;<span class="builtintype" id="2187340">int</span><span class="op" id="2187343">)</span>&nbsp;<span class="op" id="2187345">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2187348">const</span>&nbsp;<span class="op" id="2187354">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2187358">Ymin</span>&nbsp;&nbsp;<span class="op" id="2187364">=</span>&nbsp;<span class="num" id="2187366">1.461632144968362245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2187389">Two52</span>&nbsp;<span class="op" id="2187395">=</span>&nbsp;<span class="num" id="2187397">1</span>&nbsp;<span class="op" id="2187399">&lt;&lt;</span>&nbsp;<span class="num" id="2187402">52</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2187425">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2187461">Two53</span>&nbsp;<span class="op" id="2187467">=</span>&nbsp;<span class="num" id="2187469">1</span>&nbsp;<span class="op" id="2187471">&lt;&lt;</span>&nbsp;<span class="num" id="2187474">53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2187497">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2187533">Two58</span>&nbsp;<span class="op" id="2187539">=</span>&nbsp;<span class="num" id="2187541">1</span>&nbsp;<span class="op" id="2187543">&lt;&lt;</span>&nbsp;<span class="num" id="2187546">58</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2187569">//&nbsp;0x4390000000000000&nbsp;~2.8823e+17</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2187605">Tiny</span>&nbsp;&nbsp;<span class="op" id="2187611">=</span>&nbsp;<span class="num" id="2187613">1.0</span>&nbsp;<span class="op" id="2187617">/</span>&nbsp;<span class="op" id="2187619">(</span><span class="num" id="2187620">1</span>&nbsp;<span class="op" id="2187622">&lt;&lt;</span>&nbsp;<span class="num" id="2187625">70</span><span class="op" id="2187627">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2187641">//&nbsp;0x3b90000000000000&nbsp;~8.47033e-22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2187678">Tc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2187684">=</span>&nbsp;<span class="num" id="2187686">1.46163214496836224576e+00</span>&nbsp;&nbsp;<span class="comment" id="2187714">//&nbsp;0x3FF762D86356BE3F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2187738">Tf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2187744">=</span>&nbsp;<span class="op" id="2187746">-</span><span class="num" id="2187747">1.21486290535849611461e-01</span>&nbsp;<span class="comment" id="2187774">//&nbsp;0xBFBF19B9BCC38A42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2187798">//&nbsp;Tt&nbsp;=&nbsp;-(tail&nbsp;of&nbsp;Tf)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2187822">Tt</span>&nbsp;<span class="op" id="2187825">=</span>&nbsp;<span class="op" id="2187827">-</span><span class="num" id="2187828">3.63867699703950536541e-18</span>&nbsp;<span class="comment" id="2187855">//&nbsp;0xBC50C7CAA48A971F</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2187878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2187881">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2187899">sign</span>&nbsp;<span class="op" id="2187904">=</span>&nbsp;<span class="num" id="2187906">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2187909">switch</span>&nbsp;<span class="op" id="2187916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2187919">case</span>&nbsp;<span class="ident" id="2187924">IsNaN</span><span class="op" id="2187929">(</span><span class="ident" id="2187930">x</span><span class="op" id="2187931">)</span><span class="op" id="2187932">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2187936">lgamma</span>&nbsp;<span class="op" id="2187943">=</span>&nbsp;<span class="ident" id="2187945">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2187949">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2187957">case</span>&nbsp;<span class="ident" id="2187962">IsInf</span><span class="op" id="2187967">(</span><span class="ident" id="2187968">x</span><span class="op" id="2187969">,</span>&nbsp;<span class="num" id="2187971">0</span><span class="op" id="2187972">)</span><span class="op" id="2187973">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2187977">lgamma</span>&nbsp;<span class="op" id="2187984">=</span>&nbsp;<span class="ident" id="2187986">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2187990">return</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2187998">case</span>&nbsp;<span class="ident" id="2188003">x</span>&nbsp;<span class="op" id="2188005">==</span>&nbsp;<span class="num" id="2188008">0</span><span class="op" id="2188009">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2188013">lgamma</span>&nbsp;<span class="op" id="2188020">=</span>&nbsp;<span class="ident" id="2188022">Inf</span><span class="op" id="2188025">(</span><span class="num" id="2188026">1</span><span class="op" id="2188027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188031">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2188039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2188043">neg</span>&nbsp;<span class="op" id="2188047">:=</span>&nbsp;<span class="builtintype" id="2188050">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188057">if</span>&nbsp;<span class="ident" id="2188060">x</span>&nbsp;<span class="op" id="2188062">&lt;</span>&nbsp;<span class="num" id="2188064">0</span>&nbsp;<span class="op" id="2188066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2188070">x</span>&nbsp;<span class="op" id="2188072">=</span>&nbsp;<span class="op" id="2188074">-</span><span class="ident" id="2188075">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2188079">neg</span>&nbsp;<span class="op" id="2188083">=</span>&nbsp;<span class="builtintype" id="2188085">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2188091">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188095">if</span>&nbsp;<span class="ident" id="2188098">x</span>&nbsp;<span class="op" id="2188100">&lt;</span>&nbsp;<span class="ident" id="2188102">Tiny</span>&nbsp;<span class="op" id="2188107">{</span>&nbsp;<span class="comment" id="2188109">//&nbsp;if&nbsp;|x|&nbsp;&lt;&nbsp;2**-70,&nbsp;return&nbsp;-log(|x|)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188148">if</span>&nbsp;<span class="ident" id="2188151">neg</span>&nbsp;<span class="op" id="2188155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2188160">sign</span>&nbsp;<span class="op" id="2188165">=</span>&nbsp;<span class="op" id="2188167">-</span><span class="num" id="2188168">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2188172">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2188176">lgamma</span>&nbsp;<span class="op" id="2188183">=</span>&nbsp;<span class="op" id="2188185">-</span><span class="ident" id="2188186">Log</span><span class="op" id="2188189">(</span><span class="ident" id="2188190">x</span><span class="op" id="2188191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188195">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2188203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188206">var</span>&nbsp;<span class="ident" id="2188210">nadj</span>&nbsp;<span class="builtintype" id="2188215">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188224">if</span>&nbsp;<span class="ident" id="2188227">neg</span>&nbsp;<span class="op" id="2188231">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188235">if</span>&nbsp;<span class="ident" id="2188238">x</span>&nbsp;<span class="op" id="2188240">&gt;=</span>&nbsp;<span class="ident" id="2188243">Two52</span>&nbsp;<span class="op" id="2188249">{</span>&nbsp;<span class="comment" id="2188251">//&nbsp;|x|&nbsp;&gt;=&nbsp;2**52,&nbsp;must&nbsp;be&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2188288">lgamma</span>&nbsp;<span class="op" id="2188295">=</span>&nbsp;<span class="ident" id="2188297">Inf</span><span class="op" id="2188300">(</span><span class="num" id="2188301">1</span><span class="op" id="2188302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188307">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2188316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2188320">t</span>&nbsp;<span class="op" id="2188322">:=</span>&nbsp;<span class="ident" id="2188325">sinPi</span><span class="op" id="2188330">(</span><span class="ident" id="2188331">x</span><span class="op" id="2188332">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188336">if</span>&nbsp;<span class="ident" id="2188339">t</span>&nbsp;<span class="op" id="2188341">==</span>&nbsp;<span class="num" id="2188344">0</span>&nbsp;<span class="op" id="2188346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2188351">lgamma</span>&nbsp;<span class="op" id="2188358">=</span>&nbsp;<span class="ident" id="2188360">Inf</span><span class="op" id="2188363">(</span><span class="num" id="2188364">1</span><span class="op" id="2188365">)</span>&nbsp;<span class="comment" id="2188367">//&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188382">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2188391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2188395">nadj</span>&nbsp;<span class="op" id="2188400">=</span>&nbsp;<span class="ident" id="2188402">Log</span><span class="op" id="2188405">(</span><span class="ident" id="2188406">Pi</span>&nbsp;<span class="op" id="2188409">/</span>&nbsp;<span class="ident" id="2188411">Abs</span><span class="op" id="2188414">(</span><span class="ident" id="2188415">t</span><span class="op" id="2188416">*</span><span class="ident" id="2188417">x</span><span class="op" id="2188418">)</span><span class="op" id="2188419">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188423">if</span>&nbsp;<span class="ident" id="2188426">t</span>&nbsp;<span class="op" id="2188428">&lt;</span>&nbsp;<span class="num" id="2188430">0</span>&nbsp;<span class="op" id="2188432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2188437">sign</span>&nbsp;<span class="op" id="2188442">=</span>&nbsp;<span class="op" id="2188444">-</span><span class="num" id="2188445">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2188449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2188452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188456">switch</span>&nbsp;<span class="op" id="2188463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188466">case</span>&nbsp;<span class="ident" id="2188471">x</span>&nbsp;<span class="op" id="2188473">==</span>&nbsp;<span class="num" id="2188476">1</span>&nbsp;<span class="op" id="2188478">||</span>&nbsp;<span class="ident" id="2188481">x</span>&nbsp;<span class="op" id="2188483">==</span>&nbsp;<span class="num" id="2188486">2</span><span class="op" id="2188487">:</span>&nbsp;<span class="comment" id="2188489">//&nbsp;purge&nbsp;off&nbsp;1&nbsp;and&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2188512">lgamma</span>&nbsp;<span class="op" id="2188519">=</span>&nbsp;<span class="num" id="2188521">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188525">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188533">case</span>&nbsp;<span class="ident" id="2188538">x</span>&nbsp;<span class="op" id="2188540">&lt;</span>&nbsp;<span class="num" id="2188542">2</span><span class="op" id="2188543">:</span>&nbsp;<span class="comment" id="2188545">//&nbsp;use&nbsp;lgamma(x)&nbsp;=&nbsp;lgamma(x+1)&nbsp;-&nbsp;log(x)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188587">var</span>&nbsp;<span class="ident" id="2188591">y</span>&nbsp;<span class="builtintype" id="2188593">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188603">var</span>&nbsp;<span class="ident" id="2188607">i</span>&nbsp;<span class="builtintype" id="2188609">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188615">if</span>&nbsp;<span class="ident" id="2188618">x</span>&nbsp;<span class="op" id="2188620">&lt;=</span>&nbsp;<span class="num" id="2188623">0.9</span>&nbsp;<span class="op" id="2188627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2188632">lgamma</span>&nbsp;<span class="op" id="2188639">=</span>&nbsp;<span class="op" id="2188641">-</span><span class="ident" id="2188642">Log</span><span class="op" id="2188645">(</span><span class="ident" id="2188646">x</span><span class="op" id="2188647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188652">switch</span>&nbsp;<span class="op" id="2188659">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188664">case</span>&nbsp;<span class="ident" id="2188669">x</span>&nbsp;<span class="op" id="2188671">&gt;=</span>&nbsp;<span class="op" id="2188674">(</span><span class="ident" id="2188675">Ymin</span>&nbsp;<span class="op" id="2188680">-</span>&nbsp;<span class="num" id="2188682">1</span>&nbsp;<span class="op" id="2188684">+</span>&nbsp;<span class="num" id="2188686">0.27</span><span class="op" id="2188690">)</span><span class="op" id="2188691">:</span>&nbsp;<span class="comment" id="2188693">//&nbsp;0.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;&nbsp;0.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2188720">y</span>&nbsp;<span class="op" id="2188722">=</span>&nbsp;<span class="num" id="2188724">1</span>&nbsp;<span class="op" id="2188726">-</span>&nbsp;<span class="ident" id="2188728">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2188734">i</span>&nbsp;<span class="op" id="2188736">=</span>&nbsp;<span class="num" id="2188738">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188743">case</span>&nbsp;<span class="ident" id="2188748">x</span>&nbsp;<span class="op" id="2188750">&gt;=</span>&nbsp;<span class="op" id="2188753">(</span><span class="ident" id="2188754">Ymin</span>&nbsp;<span class="op" id="2188759">-</span>&nbsp;<span class="num" id="2188761">1</span>&nbsp;<span class="op" id="2188763">-</span>&nbsp;<span class="num" id="2188765">0.27</span><span class="op" id="2188769">)</span><span class="op" id="2188770">:</span>&nbsp;<span class="comment" id="2188772">//&nbsp;0.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;0.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2188800">y</span>&nbsp;<span class="op" id="2188802">=</span>&nbsp;<span class="ident" id="2188804">x</span>&nbsp;<span class="op" id="2188806">-</span>&nbsp;<span class="op" id="2188808">(</span><span class="ident" id="2188809">Tc</span>&nbsp;<span class="op" id="2188812">-</span>&nbsp;<span class="num" id="2188814">1</span><span class="op" id="2188815">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2188821">i</span>&nbsp;<span class="op" id="2188823">=</span>&nbsp;<span class="num" id="2188825">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188830">default</span><span class="op" id="2188837">:</span>&nbsp;<span class="comment" id="2188839">//&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;0.2316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2188861">y</span>&nbsp;<span class="op" id="2188863">=</span>&nbsp;<span class="ident" id="2188865">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2188871">i</span>&nbsp;<span class="op" id="2188873">=</span>&nbsp;<span class="num" id="2188875">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2188880">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2188884">}</span>&nbsp;<span class="keyword" id="2188886">else</span>&nbsp;<span class="op" id="2188891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2188896">lgamma</span>&nbsp;<span class="op" id="2188903">=</span>&nbsp;<span class="num" id="2188905">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188910">switch</span>&nbsp;<span class="op" id="2188917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188922">case</span>&nbsp;<span class="ident" id="2188927">x</span>&nbsp;<span class="op" id="2188929">&gt;=</span>&nbsp;<span class="op" id="2188932">(</span><span class="ident" id="2188933">Ymin</span>&nbsp;<span class="op" id="2188938">+</span>&nbsp;<span class="num" id="2188940">0.27</span><span class="op" id="2188944">)</span><span class="op" id="2188945">:</span>&nbsp;<span class="comment" id="2188947">//&nbsp;1.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2188970">y</span>&nbsp;<span class="op" id="2188972">=</span>&nbsp;<span class="num" id="2188974">2</span>&nbsp;<span class="op" id="2188976">-</span>&nbsp;<span class="ident" id="2188978">x</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2188984">i</span>&nbsp;<span class="op" id="2188986">=</span>&nbsp;<span class="num" id="2188988">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2188993">case</span>&nbsp;<span class="ident" id="2188998">x</span>&nbsp;<span class="op" id="2189000">&gt;=</span>&nbsp;<span class="op" id="2189003">(</span><span class="ident" id="2189004">Ymin</span>&nbsp;<span class="op" id="2189009">-</span>&nbsp;<span class="num" id="2189011">0.27</span><span class="op" id="2189015">)</span><span class="op" id="2189016">:</span>&nbsp;<span class="comment" id="2189018">//&nbsp;1.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;1.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2189046">y</span>&nbsp;<span class="op" id="2189048">=</span>&nbsp;<span class="ident" id="2189050">x</span>&nbsp;<span class="op" id="2189052">-</span>&nbsp;<span class="ident" id="2189054">Tc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2189061">i</span>&nbsp;<span class="op" id="2189063">=</span>&nbsp;<span class="num" id="2189065">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2189070">default</span><span class="op" id="2189077">:</span>&nbsp;<span class="comment" id="2189079">//&nbsp;0.9&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;1.2316</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2189103">y</span>&nbsp;<span class="op" id="2189105">=</span>&nbsp;<span class="ident" id="2189107">x</span>&nbsp;<span class="op" id="2189109">-</span>&nbsp;<span class="num" id="2189111">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2189117">i</span>&nbsp;<span class="op" id="2189119">=</span>&nbsp;<span class="num" id="2189121">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2189126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2189130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2189134">switch</span>&nbsp;<span class="ident" id="2189141">i</span>&nbsp;<span class="op" id="2189143">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2189147">case</span>&nbsp;<span class="num" id="2189152">0</span><span class="op" id="2189153">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2189158">z</span>&nbsp;<span class="op" id="2189160">:=</span>&nbsp;<span class="ident" id="2189163">y</span>&nbsp;<span class="op" id="2189165">*</span>&nbsp;<span class="ident" id="2189167">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2189172">p1</span>&nbsp;<span class="op" id="2189175">:=</span>&nbsp;<span class="ident" id="2189178">_lgamA</span><span class="op" id="2189184">[</span><span class="num" id="2189185">0</span><span class="op" id="2189186">]</span>&nbsp;<span class="op" id="2189188">+</span>&nbsp;<span class="ident" id="2189190">z</span><span class="op" id="2189191">*</span><span class="op" id="2189192">(</span><span class="ident" id="2189193">_lgamA</span><span class="op" id="2189199">[</span><span class="num" id="2189200">2</span><span class="op" id="2189201">]</span><span class="op" id="2189202">+</span><span class="ident" id="2189203">z</span><span class="op" id="2189204">*</span><span class="op" id="2189205">(</span><span class="ident" id="2189206">_lgamA</span><span class="op" id="2189212">[</span><span class="num" id="2189213">4</span><span class="op" id="2189214">]</span><span class="op" id="2189215">+</span><span class="ident" id="2189216">z</span><span class="op" id="2189217">*</span><span class="op" id="2189218">(</span><span class="ident" id="2189219">_lgamA</span><span class="op" id="2189225">[</span><span class="num" id="2189226">6</span><span class="op" id="2189227">]</span><span class="op" id="2189228">+</span><span class="ident" id="2189229">z</span><span class="op" id="2189230">*</span><span class="op" id="2189231">(</span><span class="ident" id="2189232">_lgamA</span><span class="op" id="2189238">[</span><span class="num" id="2189239">8</span><span class="op" id="2189240">]</span><span class="op" id="2189241">+</span><span class="ident" id="2189242">z</span><span class="op" id="2189243">*</span><span class="ident" id="2189244">_lgamA</span><span class="op" id="2189250">[</span><span class="num" id="2189251">10</span><span class="op" id="2189253">]</span><span class="op" id="2189254">)</span><span class="op" id="2189255">)</span><span class="op" id="2189256">)</span><span class="op" id="2189257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2189262">p2</span>&nbsp;<span class="op" id="2189265">:=</span>&nbsp;<span class="ident" id="2189268">z</span>&nbsp;<span class="op" id="2189270">*</span>&nbsp;<span class="op" id="2189272">(</span><span class="ident" id="2189273">_lgamA</span><span class="op" id="2189279">[</span><span class="num" id="2189280">1</span><span class="op" id="2189281">]</span>&nbsp;<span class="op" id="2189283">+</span>&nbsp;<span class="ident" id="2189285">z</span><span class="op" id="2189286">*</span><span class="op" id="2189287">(</span><span class="op" id="2189288">+</span><span class="ident" id="2189289">_lgamA</span><span class="op" id="2189295">[</span><span class="num" id="2189296">3</span><span class="op" id="2189297">]</span><span class="op" id="2189298">+</span><span class="ident" id="2189299">z</span><span class="op" id="2189300">*</span><span class="op" id="2189301">(</span><span class="ident" id="2189302">_lgamA</span><span class="op" id="2189308">[</span><span class="num" id="2189309">5</span><span class="op" id="2189310">]</span><span class="op" id="2189311">+</span><span class="ident" id="2189312">z</span><span class="op" id="2189313">*</span><span class="op" id="2189314">(</span><span class="ident" id="2189315">_lgamA</span><span class="op" id="2189321">[</span><span class="num" id="2189322">7</span><span class="op" id="2189323">]</span><span class="op" id="2189324">+</span><span class="ident" id="2189325">z</span><span class="op" id="2189326">*</span><span class="op" id="2189327">(</span><span class="ident" id="2189328">_lgamA</span><span class="op" id="2189334">[</span><span class="num" id="2189335">9</span><span class="op" id="2189336">]</span><span class="op" id="2189337">+</span><span class="ident" id="2189338">z</span><span class="op" id="2189339">*</span><span class="ident" id="2189340">_lgamA</span><span class="op" id="2189346">[</span><span class="num" id="2189347">11</span><span class="op" id="2189349">]</span><span class="op" id="2189350">)</span><span class="op" id="2189351">)</span><span class="op" id="2189352">)</span><span class="op" id="2189353">)</span><span class="op" id="2189354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2189359">p</span>&nbsp;<span class="op" id="2189361">:=</span>&nbsp;<span class="ident" id="2189364">y</span><span class="op" id="2189365">*</span><span class="ident" id="2189366">p1</span>&nbsp;<span class="op" id="2189369">+</span>&nbsp;<span class="ident" id="2189371">p2</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2189377">lgamma</span>&nbsp;<span class="op" id="2189384">+=</span>&nbsp;<span class="op" id="2189387">(</span><span class="ident" id="2189388">p</span>&nbsp;<span class="op" id="2189390">-</span>&nbsp;<span class="num" id="2189392">0.5</span><span class="op" id="2189395">*</span><span class="ident" id="2189396">y</span><span class="op" id="2189397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2189401">case</span>&nbsp;<span class="num" id="2189406">1</span><span class="op" id="2189407">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2189412">z</span>&nbsp;<span class="op" id="2189414">:=</span>&nbsp;<span class="ident" id="2189417">y</span>&nbsp;<span class="op" id="2189419">*</span>&nbsp;<span class="ident" id="2189421">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2189426">w</span>&nbsp;<span class="op" id="2189428">:=</span>&nbsp;<span class="ident" id="2189431">z</span>&nbsp;<span class="op" id="2189433">*</span>&nbsp;<span class="ident" id="2189435">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2189440">p1</span>&nbsp;<span class="op" id="2189443">:=</span>&nbsp;<span class="ident" id="2189446">_lgamT</span><span class="op" id="2189452">[</span><span class="num" id="2189453">0</span><span class="op" id="2189454">]</span>&nbsp;<span class="op" id="2189456">+</span>&nbsp;<span class="ident" id="2189458">w</span><span class="op" id="2189459">*</span><span class="op" id="2189460">(</span><span class="ident" id="2189461">_lgamT</span><span class="op" id="2189467">[</span><span class="num" id="2189468">3</span><span class="op" id="2189469">]</span><span class="op" id="2189470">+</span><span class="ident" id="2189471">w</span><span class="op" id="2189472">*</span><span class="op" id="2189473">(</span><span class="ident" id="2189474">_lgamT</span><span class="op" id="2189480">[</span><span class="num" id="2189481">6</span><span class="op" id="2189482">]</span><span class="op" id="2189483">+</span><span class="ident" id="2189484">w</span><span class="op" id="2189485">*</span><span class="op" id="2189486">(</span><span class="ident" id="2189487">_lgamT</span><span class="op" id="2189493">[</span><span class="num" id="2189494">9</span><span class="op" id="2189495">]</span><span class="op" id="2189496">+</span><span class="ident" id="2189497">w</span><span class="op" id="2189498">*</span><span class="ident" id="2189499">_lgamT</span><span class="op" id="2189505">[</span><span class="num" id="2189506">12</span><span class="op" id="2189508">]</span><span class="op" id="2189509">)</span><span class="op" id="2189510">)</span><span class="op" id="2189511">)</span>&nbsp;<span class="comment" id="2189513">//&nbsp;parallel&nbsp;comp</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2189533">p2</span>&nbsp;<span class="op" id="2189536">:=</span>&nbsp;<span class="ident" id="2189539">_lgamT</span><span class="op" id="2189545">[</span><span class="num" id="2189546">1</span><span class="op" id="2189547">]</span>&nbsp;<span class="op" id="2189549">+</span>&nbsp;<span class="ident" id="2189551">w</span><span class="op" id="2189552">*</span><span class="op" id="2189553">(</span><span class="ident" id="2189554">_lgamT</span><span class="op" id="2189560">[</span><span class="num" id="2189561">4</span><span class="op" id="2189562">]</span><span class="op" id="2189563">+</span><span class="ident" id="2189564">w</span><span class="op" id="2189565">*</span><span class="op" id="2189566">(</span><span class="ident" id="2189567">_lgamT</span><span class="op" id="2189573">[</span><span class="num" id="2189574">7</span><span class="op" id="2189575">]</span><span class="op" id="2189576">+</span><span class="ident" id="2189577">w</span><span class="op" id="2189578">*</span><span class="op" id="2189579">(</span><span class="ident" id="2189580">_lgamT</span><span class="op" id="2189586">[</span><span class="num" id="2189587">10</span><span class="op" id="2189589">]</span><span class="op" id="2189590">+</span><span class="ident" id="2189591">w</span><span class="op" id="2189592">*</span><span class="ident" id="2189593">_lgamT</span><span class="op" id="2189599">[</span><span class="num" id="2189600">13</span><span class="op" id="2189602">]</span><span class="op" id="2189603">)</span><span class="op" id="2189604">)</span><span class="op" id="2189605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2189610">p3</span>&nbsp;<span class="op" id="2189613">:=</span>&nbsp;<span class="ident" id="2189616">_lgamT</span><span class="op" id="2189622">[</span><span class="num" id="2189623">2</span><span class="op" id="2189624">]</span>&nbsp;<span class="op" id="2189626">+</span>&nbsp;<span class="ident" id="2189628">w</span><span class="op" id="2189629">*</span><span class="op" id="2189630">(</span><span class="ident" id="2189631">_lgamT</span><span class="op" id="2189637">[</span><span class="num" id="2189638">5</span><span class="op" id="2189639">]</span><span class="op" id="2189640">+</span><span class="ident" id="2189641">w</span><span class="op" id="2189642">*</span><span class="op" id="2189643">(</span><span class="ident" id="2189644">_lgamT</span><span class="op" id="2189650">[</span><span class="num" id="2189651">8</span><span class="op" id="2189652">]</span><span class="op" id="2189653">+</span><span class="ident" id="2189654">w</span><span class="op" id="2189655">*</span><span class="op" id="2189656">(</span><span class="ident" id="2189657">_lgamT</span><span class="op" id="2189663">[</span><span class="num" id="2189664">11</span><span class="op" id="2189666">]</span><span class="op" id="2189667">+</span><span class="ident" id="2189668">w</span><span class="op" id="2189669">*</span><span class="ident" id="2189670">_lgamT</span><span class="op" id="2189676">[</span><span class="num" id="2189677">14</span><span class="op" id="2189679">]</span><span class="op" id="2189680">)</span><span class="op" id="2189681">)</span><span class="op" id="2189682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2189687">p</span>&nbsp;<span class="op" id="2189689">:=</span>&nbsp;<span class="ident" id="2189692">z</span><span class="op" id="2189693">*</span><span class="ident" id="2189694">p1</span>&nbsp;<span class="op" id="2189697">-</span>&nbsp;<span class="op" id="2189699">(</span><span class="ident" id="2189700">Tt</span>&nbsp;<span class="op" id="2189703">-</span>&nbsp;<span class="ident" id="2189705">w</span><span class="op" id="2189706">*</span><span class="op" id="2189707">(</span><span class="ident" id="2189708">p2</span><span class="op" id="2189710">+</span><span class="ident" id="2189711">y</span><span class="op" id="2189712">*</span><span class="ident" id="2189713">p3</span><span class="op" id="2189715">)</span><span class="op" id="2189716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2189721">lgamma</span>&nbsp;<span class="op" id="2189728">+=</span>&nbsp;<span class="op" id="2189731">(</span><span class="ident" id="2189732">Tf</span>&nbsp;<span class="op" id="2189735">+</span>&nbsp;<span class="ident" id="2189737">p</span><span class="op" id="2189738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2189742">case</span>&nbsp;<span class="num" id="2189747">2</span><span class="op" id="2189748">:</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2189753">p1</span>&nbsp;<span class="op" id="2189756">:=</span>&nbsp;<span class="ident" id="2189759">y</span>&nbsp;<span class="op" id="2189761">*</span>&nbsp;<span class="op" id="2189763">(</span><span class="ident" id="2189764">_lgamU</span><span class="op" id="2189770">[</span><span class="num" id="2189771">0</span><span class="op" id="2189772">]</span>&nbsp;<span class="op" id="2189774">+</span>&nbsp;<span class="ident" id="2189776">y</span><span class="op" id="2189777">*</span><span class="op" id="2189778">(</span><span class="ident" id="2189779">_lgamU</span><span class="op" id="2189785">[</span><span class="num" id="2189786">1</span><span class="op" id="2189787">]</span><span class="op" id="2189788">+</span><span class="ident" id="2189789">y</span><span class="op" id="2189790">*</span><span class="op" id="2189791">(</span><span class="ident" id="2189792">_lgamU</span><span class="op" id="2189798">[</span><span class="num" id="2189799">2</span><span class="op" id="2189800">]</span><span class="op" id="2189801">+</span><span class="ident" id="2189802">y</span><span class="op" id="2189803">*</span><span class="op" id="2189804">(</span><span class="ident" id="2189805">_lgamU</span><span class="op" id="2189811">[</span><span class="num" id="2189812">3</span><span class="op" id="2189813">]</span><span class="op" id="2189814">+</span><span class="ident" id="2189815">y</span><span class="op" id="2189816">*</span><span class="op" id="2189817">(</span><span class="ident" id="2189818">_lgamU</span><span class="op" id="2189824">[</span><span class="num" id="2189825">4</span><span class="op" id="2189826">]</span><span class="op" id="2189827">+</span><span class="ident" id="2189828">y</span><span class="op" id="2189829">*</span><span class="ident" id="2189830">_lgamU</span><span class="op" id="2189836">[</span><span class="num" id="2189837">5</span><span class="op" id="2189838">]</span><span class="op" id="2189839">)</span><span class="op" id="2189840">)</span><span class="op" id="2189841">)</span><span class="op" id="2189842">)</span><span class="op" id="2189843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2189848">p2</span>&nbsp;<span class="op" id="2189851">:=</span>&nbsp;<span class="num" id="2189854">1</span>&nbsp;<span class="op" id="2189856">+</span>&nbsp;<span class="ident" id="2189858">y</span><span class="op" id="2189859">*</span><span class="op" id="2189860">(</span><span class="ident" id="2189861">_lgamV</span><span class="op" id="2189867">[</span><span class="num" id="2189868">1</span><span class="op" id="2189869">]</span><span class="op" id="2189870">+</span><span class="ident" id="2189871">y</span><span class="op" id="2189872">*</span><span class="op" id="2189873">(</span><span class="ident" id="2189874">_lgamV</span><span class="op" id="2189880">[</span><span class="num" id="2189881">2</span><span class="op" id="2189882">]</span><span class="op" id="2189883">+</span><span class="ident" id="2189884">y</span><span class="op" id="2189885">*</span><span class="op" id="2189886">(</span><span class="ident" id="2189887">_lgamV</span><span class="op" id="2189893">[</span><span class="num" id="2189894">3</span><span class="op" id="2189895">]</span><span class="op" id="2189896">+</span><span class="ident" id="2189897">y</span><span class="op" id="2189898">*</span><span class="op" id="2189899">(</span><span class="ident" id="2189900">_lgamV</span><span class="op" id="2189906">[</span><span class="num" id="2189907">4</span><span class="op" id="2189908">]</span><span class="op" id="2189909">+</span><span class="ident" id="2189910">y</span><span class="op" id="2189911">*</span><span class="ident" id="2189912">_lgamV</span><span class="op" id="2189918">[</span><span class="num" id="2189919">5</span><span class="op" id="2189920">]</span><span class="op" id="2189921">)</span><span class="op" id="2189922">)</span><span class="op" id="2189923">)</span><span class="op" id="2189924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2189929">lgamma</span>&nbsp;<span class="op" id="2189936">+=</span>&nbsp;<span class="op" id="2189939">(</span><span class="op" id="2189940">-</span><span class="num" id="2189941">0.5</span><span class="op" id="2189944">*</span><span class="ident" id="2189945">y</span>&nbsp;<span class="op" id="2189947">+</span>&nbsp;<span class="ident" id="2189949">p1</span><span class="op" id="2189951">/</span><span class="ident" id="2189952">p2</span><span class="op" id="2189954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2189958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2189961">case</span>&nbsp;<span class="ident" id="2189966">x</span>&nbsp;<span class="op" id="2189968">&lt;</span>&nbsp;<span class="num" id="2189970">8</span><span class="op" id="2189971">:</span>&nbsp;<span class="comment" id="2189973">//&nbsp;2&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;8</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2189989">i</span>&nbsp;<span class="op" id="2189991">:=</span>&nbsp;<span class="builtintype" id="2189994">int</span><span class="op" id="2189997">(</span><span class="ident" id="2189998">x</span><span class="op" id="2189999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190003">y</span>&nbsp;<span class="op" id="2190005">:=</span>&nbsp;<span class="ident" id="2190008">x</span>&nbsp;<span class="op" id="2190010">-</span>&nbsp;<span class="builtintype" id="2190012">float64</span><span class="op" id="2190019">(</span><span class="ident" id="2190020">i</span><span class="op" id="2190021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190025">p</span>&nbsp;<span class="op" id="2190027">:=</span>&nbsp;<span class="ident" id="2190030">y</span>&nbsp;<span class="op" id="2190032">*</span>&nbsp;<span class="op" id="2190034">(</span><span class="ident" id="2190035">_lgamS</span><span class="op" id="2190041">[</span><span class="num" id="2190042">0</span><span class="op" id="2190043">]</span>&nbsp;<span class="op" id="2190045">+</span>&nbsp;<span class="ident" id="2190047">y</span><span class="op" id="2190048">*</span><span class="op" id="2190049">(</span><span class="ident" id="2190050">_lgamS</span><span class="op" id="2190056">[</span><span class="num" id="2190057">1</span><span class="op" id="2190058">]</span><span class="op" id="2190059">+</span><span class="ident" id="2190060">y</span><span class="op" id="2190061">*</span><span class="op" id="2190062">(</span><span class="ident" id="2190063">_lgamS</span><span class="op" id="2190069">[</span><span class="num" id="2190070">2</span><span class="op" id="2190071">]</span><span class="op" id="2190072">+</span><span class="ident" id="2190073">y</span><span class="op" id="2190074">*</span><span class="op" id="2190075">(</span><span class="ident" id="2190076">_lgamS</span><span class="op" id="2190082">[</span><span class="num" id="2190083">3</span><span class="op" id="2190084">]</span><span class="op" id="2190085">+</span><span class="ident" id="2190086">y</span><span class="op" id="2190087">*</span><span class="op" id="2190088">(</span><span class="ident" id="2190089">_lgamS</span><span class="op" id="2190095">[</span><span class="num" id="2190096">4</span><span class="op" id="2190097">]</span><span class="op" id="2190098">+</span><span class="ident" id="2190099">y</span><span class="op" id="2190100">*</span><span class="op" id="2190101">(</span><span class="ident" id="2190102">_lgamS</span><span class="op" id="2190108">[</span><span class="num" id="2190109">5</span><span class="op" id="2190110">]</span><span class="op" id="2190111">+</span><span class="ident" id="2190112">y</span><span class="op" id="2190113">*</span><span class="ident" id="2190114">_lgamS</span><span class="op" id="2190120">[</span><span class="num" id="2190121">6</span><span class="op" id="2190122">]</span><span class="op" id="2190123">)</span><span class="op" id="2190124">)</span><span class="op" id="2190125">)</span><span class="op" id="2190126">)</span><span class="op" id="2190127">)</span><span class="op" id="2190128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190132">q</span>&nbsp;<span class="op" id="2190134">:=</span>&nbsp;<span class="num" id="2190137">1</span>&nbsp;<span class="op" id="2190139">+</span>&nbsp;<span class="ident" id="2190141">y</span><span class="op" id="2190142">*</span><span class="op" id="2190143">(</span><span class="ident" id="2190144">_lgamR</span><span class="op" id="2190150">[</span><span class="num" id="2190151">1</span><span class="op" id="2190152">]</span><span class="op" id="2190153">+</span><span class="ident" id="2190154">y</span><span class="op" id="2190155">*</span><span class="op" id="2190156">(</span><span class="ident" id="2190157">_lgamR</span><span class="op" id="2190163">[</span><span class="num" id="2190164">2</span><span class="op" id="2190165">]</span><span class="op" id="2190166">+</span><span class="ident" id="2190167">y</span><span class="op" id="2190168">*</span><span class="op" id="2190169">(</span><span class="ident" id="2190170">_lgamR</span><span class="op" id="2190176">[</span><span class="num" id="2190177">3</span><span class="op" id="2190178">]</span><span class="op" id="2190179">+</span><span class="ident" id="2190180">y</span><span class="op" id="2190181">*</span><span class="op" id="2190182">(</span><span class="ident" id="2190183">_lgamR</span><span class="op" id="2190189">[</span><span class="num" id="2190190">4</span><span class="op" id="2190191">]</span><span class="op" id="2190192">+</span><span class="ident" id="2190193">y</span><span class="op" id="2190194">*</span><span class="op" id="2190195">(</span><span class="ident" id="2190196">_lgamR</span><span class="op" id="2190202">[</span><span class="num" id="2190203">5</span><span class="op" id="2190204">]</span><span class="op" id="2190205">+</span><span class="ident" id="2190206">y</span><span class="op" id="2190207">*</span><span class="ident" id="2190208">_lgamR</span><span class="op" id="2190214">[</span><span class="num" id="2190215">6</span><span class="op" id="2190216">]</span><span class="op" id="2190217">)</span><span class="op" id="2190218">)</span><span class="op" id="2190219">)</span><span class="op" id="2190220">)</span><span class="op" id="2190221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190225">lgamma</span>&nbsp;<span class="op" id="2190232">=</span>&nbsp;<span class="num" id="2190234">0.5</span><span class="op" id="2190237">*</span><span class="ident" id="2190238">y</span>&nbsp;<span class="op" id="2190240">+</span>&nbsp;<span class="ident" id="2190242">p</span><span class="op" id="2190243">/</span><span class="ident" id="2190244">q</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190248">z</span>&nbsp;<span class="op" id="2190250">:=</span>&nbsp;<span class="num" id="2190253">1.0</span>&nbsp;<span class="comment" id="2190257">//&nbsp;Lgamma(1+s)&nbsp;=&nbsp;Log(s)&nbsp;+&nbsp;Lgamma(s)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2190295">switch</span>&nbsp;<span class="ident" id="2190302">i</span>&nbsp;<span class="op" id="2190304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2190308">case</span>&nbsp;<span class="num" id="2190313">7</span><span class="op" id="2190314">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190319">z</span>&nbsp;<span class="op" id="2190321">*=</span>&nbsp;<span class="op" id="2190324">(</span><span class="ident" id="2190325">y</span>&nbsp;<span class="op" id="2190327">+</span>&nbsp;<span class="num" id="2190329">6</span><span class="op" id="2190330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2190335">fallthrough</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2190349">case</span>&nbsp;<span class="num" id="2190354">6</span><span class="op" id="2190355">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190360">z</span>&nbsp;<span class="op" id="2190362">*=</span>&nbsp;<span class="op" id="2190365">(</span><span class="ident" id="2190366">y</span>&nbsp;<span class="op" id="2190368">+</span>&nbsp;<span class="num" id="2190370">5</span><span class="op" id="2190371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2190376">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2190390">case</span>&nbsp;<span class="num" id="2190395">5</span><span class="op" id="2190396">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190401">z</span>&nbsp;<span class="op" id="2190403">*=</span>&nbsp;<span class="op" id="2190406">(</span><span class="ident" id="2190407">y</span>&nbsp;<span class="op" id="2190409">+</span>&nbsp;<span class="num" id="2190411">4</span><span class="op" id="2190412">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2190417">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2190431">case</span>&nbsp;<span class="num" id="2190436">4</span><span class="op" id="2190437">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190442">z</span>&nbsp;<span class="op" id="2190444">*=</span>&nbsp;<span class="op" id="2190447">(</span><span class="ident" id="2190448">y</span>&nbsp;<span class="op" id="2190450">+</span>&nbsp;<span class="num" id="2190452">3</span><span class="op" id="2190453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2190458">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2190472">case</span>&nbsp;<span class="num" id="2190477">3</span><span class="op" id="2190478">:</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190483">z</span>&nbsp;<span class="op" id="2190485">*=</span>&nbsp;<span class="op" id="2190488">(</span><span class="ident" id="2190489">y</span>&nbsp;<span class="op" id="2190491">+</span>&nbsp;<span class="num" id="2190493">2</span><span class="op" id="2190494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190499">lgamma</span>&nbsp;<span class="op" id="2190506">+=</span>&nbsp;<span class="ident" id="2190509">Log</span><span class="op" id="2190512">(</span><span class="ident" id="2190513">z</span><span class="op" id="2190514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2190518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2190521">case</span>&nbsp;<span class="ident" id="2190526">x</span>&nbsp;<span class="op" id="2190528">&lt;</span>&nbsp;<span class="ident" id="2190530">Two58</span><span class="op" id="2190535">:</span>&nbsp;<span class="comment" id="2190537">//&nbsp;8&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2**58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190557">t</span>&nbsp;<span class="op" id="2190559">:=</span>&nbsp;<span class="ident" id="2190562">Log</span><span class="op" id="2190565">(</span><span class="ident" id="2190566">x</span><span class="op" id="2190567">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190571">z</span>&nbsp;<span class="op" id="2190573">:=</span>&nbsp;<span class="num" id="2190576">1</span>&nbsp;<span class="op" id="2190578">/</span>&nbsp;<span class="ident" id="2190580">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190584">y</span>&nbsp;<span class="op" id="2190586">:=</span>&nbsp;<span class="ident" id="2190589">z</span>&nbsp;<span class="op" id="2190591">*</span>&nbsp;<span class="ident" id="2190593">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190597">w</span>&nbsp;<span class="op" id="2190599">:=</span>&nbsp;<span class="ident" id="2190602">_lgamW</span><span class="op" id="2190608">[</span><span class="num" id="2190609">0</span><span class="op" id="2190610">]</span>&nbsp;<span class="op" id="2190612">+</span>&nbsp;<span class="ident" id="2190614">z</span><span class="op" id="2190615">*</span><span class="op" id="2190616">(</span><span class="ident" id="2190617">_lgamW</span><span class="op" id="2190623">[</span><span class="num" id="2190624">1</span><span class="op" id="2190625">]</span><span class="op" id="2190626">+</span><span class="ident" id="2190627">y</span><span class="op" id="2190628">*</span><span class="op" id="2190629">(</span><span class="ident" id="2190630">_lgamW</span><span class="op" id="2190636">[</span><span class="num" id="2190637">2</span><span class="op" id="2190638">]</span><span class="op" id="2190639">+</span><span class="ident" id="2190640">y</span><span class="op" id="2190641">*</span><span class="op" id="2190642">(</span><span class="ident" id="2190643">_lgamW</span><span class="op" id="2190649">[</span><span class="num" id="2190650">3</span><span class="op" id="2190651">]</span><span class="op" id="2190652">+</span><span class="ident" id="2190653">y</span><span class="op" id="2190654">*</span><span class="op" id="2190655">(</span><span class="ident" id="2190656">_lgamW</span><span class="op" id="2190662">[</span><span class="num" id="2190663">4</span><span class="op" id="2190664">]</span><span class="op" id="2190665">+</span><span class="ident" id="2190666">y</span><span class="op" id="2190667">*</span><span class="op" id="2190668">(</span><span class="ident" id="2190669">_lgamW</span><span class="op" id="2190675">[</span><span class="num" id="2190676">5</span><span class="op" id="2190677">]</span><span class="op" id="2190678">+</span><span class="ident" id="2190679">y</span><span class="op" id="2190680">*</span><span class="ident" id="2190681">_lgamW</span><span class="op" id="2190687">[</span><span class="num" id="2190688">6</span><span class="op" id="2190689">]</span><span class="op" id="2190690">)</span><span class="op" id="2190691">)</span><span class="op" id="2190692">)</span><span class="op" id="2190693">)</span><span class="op" id="2190694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190698">lgamma</span>&nbsp;<span class="op" id="2190705">=</span>&nbsp;<span class="op" id="2190707">(</span><span class="ident" id="2190708">x</span><span class="op" id="2190709">-</span><span class="num" id="2190710">0.5</span><span class="op" id="2190713">)</span><span class="op" id="2190714">*</span><span class="op" id="2190715">(</span><span class="ident" id="2190716">t</span><span class="op" id="2190717">-</span><span class="num" id="2190718">1</span><span class="op" id="2190719">)</span>&nbsp;<span class="op" id="2190721">+</span>&nbsp;<span class="ident" id="2190723">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2190726">default</span><span class="op" id="2190733">:</span>&nbsp;<span class="comment" id="2190735">//&nbsp;2**58&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;Inf</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190758">lgamma</span>&nbsp;<span class="op" id="2190765">=</span>&nbsp;<span class="ident" id="2190767">x</span>&nbsp;<span class="op" id="2190769">*</span>&nbsp;<span class="op" id="2190771">(</span><span class="ident" id="2190772">Log</span><span class="op" id="2190775">(</span><span class="ident" id="2190776">x</span><span class="op" id="2190777">)</span>&nbsp;<span class="op" id="2190779">-</span>&nbsp;<span class="num" id="2190781">1</span><span class="op" id="2190782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2190785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2190788">if</span>&nbsp;<span class="ident" id="2190791">neg</span>&nbsp;<span class="op" id="2190795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190799">lgamma</span>&nbsp;<span class="op" id="2190806">=</span>&nbsp;<span class="ident" id="2190808">nadj</span>&nbsp;<span class="op" id="2190813">-</span>&nbsp;<span class="ident" id="2190815">lgamma</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2190823">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2190826">return</span><br>
<span class="lineno"></span><span class="op" id="2190833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2190836">//&nbsp;sinPi(x)&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;negative&nbsp;x</span><br>
<span class="lineno"></span><span class="keyword" id="2190884">func</span>&nbsp;<span class="ident" id="2190889">sinPi</span><span class="op" id="2190894">(</span><span class="ident" id="2190895">x</span>&nbsp;<span class="builtintype" id="2190897">float64</span><span class="op" id="2190904">)</span>&nbsp;<span class="builtintype" id="2190906">float64</span>&nbsp;<span class="op" id="2190914">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2190917">const</span>&nbsp;<span class="op" id="2190923">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190927">Two52</span>&nbsp;<span class="op" id="2190933">=</span>&nbsp;<span class="num" id="2190935">1</span>&nbsp;<span class="op" id="2190937">&lt;&lt;</span>&nbsp;<span class="num" id="2190940">52</span>&nbsp;<span class="comment" id="2190943">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190979">Two53</span>&nbsp;<span class="op" id="2190985">=</span>&nbsp;<span class="num" id="2190987">1</span>&nbsp;<span class="op" id="2190989">&lt;&lt;</span>&nbsp;<span class="num" id="2190992">53</span>&nbsp;<span class="comment" id="2190995">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2191030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2191033">if</span>&nbsp;<span class="ident" id="2191036">x</span>&nbsp;<span class="op" id="2191038">&lt;</span>&nbsp;<span class="num" id="2191040">0.25</span>&nbsp;<span class="op" id="2191045">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2191049">return</span>&nbsp;<span class="op" id="2191056">-</span><span class="ident" id="2191057">Sin</span><span class="op" id="2191060">(</span><span class="ident" id="2191061">Pi</span>&nbsp;<span class="op" id="2191064">*</span>&nbsp;<span class="ident" id="2191066">x</span><span class="op" id="2191067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2191070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2191074">//&nbsp;argument&nbsp;reduction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191097">z</span>&nbsp;<span class="op" id="2191099">:=</span>&nbsp;<span class="ident" id="2191102">Floor</span><span class="op" id="2191107">(</span><span class="ident" id="2191108">x</span><span class="op" id="2191109">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2191112">var</span>&nbsp;<span class="ident" id="2191116">n</span>&nbsp;<span class="builtintype" id="2191118">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2191123">if</span>&nbsp;<span class="ident" id="2191126">z</span>&nbsp;<span class="op" id="2191128">!=</span>&nbsp;<span class="ident" id="2191131">x</span>&nbsp;<span class="op" id="2191133">{</span>&nbsp;<span class="comment" id="2191135">//&nbsp;inexact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191148">x</span>&nbsp;<span class="op" id="2191150">=</span>&nbsp;<span class="ident" id="2191152">Mod</span><span class="op" id="2191155">(</span><span class="ident" id="2191156">x</span><span class="op" id="2191157">,</span>&nbsp;<span class="num" id="2191159">2</span><span class="op" id="2191160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191164">n</span>&nbsp;<span class="op" id="2191166">=</span>&nbsp;<span class="builtintype" id="2191168">int</span><span class="op" id="2191171">(</span><span class="ident" id="2191172">x</span>&nbsp;<span class="op" id="2191174">*</span>&nbsp;<span class="num" id="2191176">4</span><span class="op" id="2191177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2191180">}</span>&nbsp;<span class="keyword" id="2191182">else</span>&nbsp;<span class="op" id="2191187">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2191191">if</span>&nbsp;<span class="ident" id="2191194">x</span>&nbsp;<span class="op" id="2191196">&gt;=</span>&nbsp;<span class="ident" id="2191199">Two53</span>&nbsp;<span class="op" id="2191205">{</span>&nbsp;<span class="comment" id="2191207">//&nbsp;x&nbsp;must&nbsp;be&nbsp;even</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191228">x</span>&nbsp;<span class="op" id="2191230">=</span>&nbsp;<span class="num" id="2191232">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191237">n</span>&nbsp;<span class="op" id="2191239">=</span>&nbsp;<span class="num" id="2191241">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2191245">}</span>&nbsp;<span class="keyword" id="2191247">else</span>&nbsp;<span class="op" id="2191252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2191257">if</span>&nbsp;<span class="ident" id="2191260">x</span>&nbsp;<span class="op" id="2191262">&lt;</span>&nbsp;<span class="ident" id="2191264">Two52</span>&nbsp;<span class="op" id="2191270">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191276">z</span>&nbsp;<span class="op" id="2191278">=</span>&nbsp;<span class="ident" id="2191280">x</span>&nbsp;<span class="op" id="2191282">+</span>&nbsp;<span class="ident" id="2191284">Two52</span>&nbsp;<span class="comment" id="2191290">//&nbsp;exact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2191302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191307">n</span>&nbsp;<span class="op" id="2191309">=</span>&nbsp;<span class="builtintype" id="2191311">int</span><span class="op" id="2191314">(</span><span class="num" id="2191315">1</span>&nbsp;<span class="op" id="2191317">&amp;</span>&nbsp;<span class="ident" id="2191319">Float64bits</span><span class="op" id="2191330">(</span><span class="ident" id="2191331">z</span><span class="op" id="2191332">)</span><span class="op" id="2191333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191338">x</span>&nbsp;<span class="op" id="2191340">=</span>&nbsp;<span class="builtintype" id="2191342">float64</span><span class="op" id="2191349">(</span><span class="ident" id="2191350">n</span><span class="op" id="2191351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191356">n</span>&nbsp;<span class="op" id="2191358">&lt;&lt;=</span>&nbsp;<span class="num" id="2191362">2</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2191366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2191369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2191372">switch</span>&nbsp;<span class="ident" id="2191379">n</span>&nbsp;<span class="op" id="2191381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2191384">case</span>&nbsp;<span class="num" id="2191389">0</span><span class="op" id="2191390">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191394">x</span>&nbsp;<span class="op" id="2191396">=</span>&nbsp;<span class="ident" id="2191398">Sin</span><span class="op" id="2191401">(</span><span class="ident" id="2191402">Pi</span>&nbsp;<span class="op" id="2191405">*</span>&nbsp;<span class="ident" id="2191407">x</span><span class="op" id="2191408">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2191411">case</span>&nbsp;<span class="num" id="2191416">1</span><span class="op" id="2191417">,</span>&nbsp;<span class="num" id="2191419">2</span><span class="op" id="2191420">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191424">x</span>&nbsp;<span class="op" id="2191426">=</span>&nbsp;<span class="ident" id="2191428">Cos</span><span class="op" id="2191431">(</span><span class="ident" id="2191432">Pi</span>&nbsp;<span class="op" id="2191435">*</span>&nbsp;<span class="op" id="2191437">(</span><span class="num" id="2191438">0.5</span>&nbsp;<span class="op" id="2191442">-</span>&nbsp;<span class="ident" id="2191444">x</span><span class="op" id="2191445">)</span><span class="op" id="2191446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2191449">case</span>&nbsp;<span class="num" id="2191454">3</span><span class="op" id="2191455">,</span>&nbsp;<span class="num" id="2191457">4</span><span class="op" id="2191458">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191462">x</span>&nbsp;<span class="op" id="2191464">=</span>&nbsp;<span class="ident" id="2191466">Sin</span><span class="op" id="2191469">(</span><span class="ident" id="2191470">Pi</span>&nbsp;<span class="op" id="2191473">*</span>&nbsp;<span class="op" id="2191475">(</span><span class="num" id="2191476">1</span>&nbsp;<span class="op" id="2191478">-</span>&nbsp;<span class="ident" id="2191480">x</span><span class="op" id="2191481">)</span><span class="op" id="2191482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2191485">case</span>&nbsp;<span class="num" id="2191490">5</span><span class="op" id="2191491">,</span>&nbsp;<span class="num" id="2191493">6</span><span class="op" id="2191494">:</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191498">x</span>&nbsp;<span class="op" id="2191500">=</span>&nbsp;<span class="op" id="2191502">-</span><span class="ident" id="2191503">Cos</span><span class="op" id="2191506">(</span><span class="ident" id="2191507">Pi</span>&nbsp;<span class="op" id="2191510">*</span>&nbsp;<span class="op" id="2191512">(</span><span class="ident" id="2191513">x</span>&nbsp;<span class="op" id="2191515">-</span>&nbsp;<span class="num" id="2191517">1.5</span><span class="op" id="2191520">)</span><span class="op" id="2191521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2191524">default</span><span class="op" id="2191531">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191535">x</span>&nbsp;<span class="op" id="2191537">=</span>&nbsp;<span class="ident" id="2191539">Sin</span><span class="op" id="2191542">(</span><span class="ident" id="2191543">Pi</span>&nbsp;<span class="op" id="2191546">*</span>&nbsp;<span class="op" id="2191548">(</span><span class="ident" id="2191549">x</span>&nbsp;<span class="op" id="2191551">-</span>&nbsp;<span class="num" id="2191553">2</span><span class="op" id="2191554">)</span><span class="op" id="2191555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2191558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2191561">return</span>&nbsp;<span class="op" id="2191568">-</span><span class="ident" id="2191569">x</span><br>
<span class="lineno">365</span><span class="op" id="2191571">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
