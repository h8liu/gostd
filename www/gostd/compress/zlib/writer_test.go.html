<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>compress/zlib</h2>
<ul>
<li><a href="/gostd/compress/zlib/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/compress/zlib/reader.go.html">reader.go</a></li>
<li><a href="/gostd/compress/zlib/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/compress/zlib/writer.go.html">writer.go</a></li>
<li><a href="/gostd/compress/zlib/writer_test.go.html" class="current">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8530389">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8530444">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8530498">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8530549">package</span>&nbsp;<span class="ident" id="8530557">zlib</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8530563">import</span>&nbsp;<span class="op" id="8530570">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8530573">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8530582">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8530589">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8530595">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8530608">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8530614">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8530624">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="8530627">var</span>&nbsp;<span class="ident" id="8530631">filenames</span>&nbsp;<span class="op" id="8530641">=</span>&nbsp;<span class="op" id="8530643">[</span><span class="op" id="8530644">]</span><span class="builtintype" id="8530645">string</span><span class="op" id="8530651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8530654">&#34;../testdata/e.txt&#34;</span><span class="op" id="8530673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8530676">&#34;../testdata/pi.txt&#34;</span><span class="op" id="8530696">,</span><br>
<span class="lineno"></span><span class="op" id="8530698">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="8530701">var</span>&nbsp;<span class="ident" id="8530705">data</span>&nbsp;<span class="op" id="8530710">=</span>&nbsp;<span class="op" id="8530712">[</span><span class="op" id="8530713">]</span><span class="builtintype" id="8530714">string</span><span class="op" id="8530720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8530723">&#34;test&nbsp;a&nbsp;reasonable&nbsp;sized&nbsp;string&nbsp;that&nbsp;can&nbsp;be&nbsp;compressed&#34;</span><span class="op" id="8530778">,</span><br>
<span class="lineno"></span><span class="op" id="8530780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="8530783">//&nbsp;Tests&nbsp;that&nbsp;compressing&nbsp;and&nbsp;then&nbsp;decompressing&nbsp;the&nbsp;given&nbsp;file&nbsp;at&nbsp;the&nbsp;given&nbsp;compression&nbsp;level&nbsp;and&nbsp;dictionary</span><br>
<span class="lineno"></span><span class="comment" id="8530893">//&nbsp;yields&nbsp;equivalent&nbsp;bytes&nbsp;to&nbsp;the&nbsp;original&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="8530942">func</span>&nbsp;<span class="ident" id="8530947">testFileLevelDict</span><span class="op" id="8530964">(</span><span class="ident" id="8530965">t</span>&nbsp;<span class="op" id="8530967">*</span><span class="ident" id="8530968">testing</span><span class="op" id="8530975">.</span><span class="ident" id="8530976">T</span><span class="op" id="8530977">,</span>&nbsp;<span class="ident" id="8530979">fn</span>&nbsp;<span class="builtintype" id="8530982">string</span><span class="op" id="8530988">,</span>&nbsp;<span class="ident" id="8530990">level</span>&nbsp;<span class="builtintype" id="8530996">int</span><span class="op" id="8530999">,</span>&nbsp;<span class="ident" id="8531001">d</span>&nbsp;<span class="builtintype" id="8531003">string</span><span class="op" id="8531009">)</span>&nbsp;<span class="op" id="8531011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8531014">//&nbsp;Read&nbsp;the&nbsp;file,&nbsp;as&nbsp;golden&nbsp;output.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8531051">golden</span><span class="op" id="8531057">,</span>&nbsp;<span class="ident" id="8531059">err</span>&nbsp;<span class="op" id="8531063">:=</span>&nbsp;<span class="ident" id="8531066">os</span><span class="op" id="8531068">.</span><span class="ident" id="8531069">Open</span><span class="op" id="8531073">(</span><span class="ident" id="8531074">fn</span><span class="op" id="8531076">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8531079">if</span>&nbsp;<span class="ident" id="8531082">err</span>&nbsp;<span class="op" id="8531086">!=</span>&nbsp;<span class="builtintype" id="8531089">nil</span>&nbsp;<span class="op" id="8531093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8531097">t</span><span class="op" id="8531098">.</span><span class="ident" id="8531099">Errorf</span><span class="op" id="8531105">(</span><span class="string" id="8531106">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="8531134">,</span>&nbsp;<span class="ident" id="8531136">fn</span><span class="op" id="8531138">,</span>&nbsp;<span class="ident" id="8531140">level</span><span class="op" id="8531145">,</span>&nbsp;<span class="ident" id="8531147">d</span><span class="op" id="8531148">,</span>&nbsp;<span class="ident" id="8531150">err</span><span class="op" id="8531153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8531157">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8531165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8531168">defer</span>&nbsp;<span class="ident" id="8531174">golden</span><span class="op" id="8531180">.</span><span class="ident" id="8531181">Close</span><span class="op" id="8531186">(</span><span class="op" id="8531187">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8531190">b0</span><span class="op" id="8531192">,</span>&nbsp;<span class="ident" id="8531194">err0</span>&nbsp;<span class="op" id="8531199">:=</span>&nbsp;<span class="ident" id="8531202">ioutil</span><span class="op" id="8531208">.</span><span class="ident" id="8531209">ReadAll</span><span class="op" id="8531216">(</span><span class="ident" id="8531217">golden</span><span class="op" id="8531223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8531226">if</span>&nbsp;<span class="ident" id="8531229">err0</span>&nbsp;<span class="op" id="8531234">!=</span>&nbsp;<span class="builtintype" id="8531237">nil</span>&nbsp;<span class="op" id="8531241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8531245">t</span><span class="op" id="8531246">.</span><span class="ident" id="8531247">Errorf</span><span class="op" id="8531253">(</span><span class="string" id="8531254">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="8531282">,</span>&nbsp;<span class="ident" id="8531284">fn</span><span class="op" id="8531286">,</span>&nbsp;<span class="ident" id="8531288">level</span><span class="op" id="8531293">,</span>&nbsp;<span class="ident" id="8531295">d</span><span class="op" id="8531296">,</span>&nbsp;<span class="ident" id="8531298">err0</span><span class="op" id="8531302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8531306">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8531314">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8531317">testLevelDict</span><span class="op" id="8531330">(</span><span class="ident" id="8531331">t</span><span class="op" id="8531332">,</span>&nbsp;<span class="ident" id="8531334">fn</span><span class="op" id="8531336">,</span>&nbsp;<span class="ident" id="8531338">b0</span><span class="op" id="8531340">,</span>&nbsp;<span class="ident" id="8531342">level</span><span class="op" id="8531347">,</span>&nbsp;<span class="ident" id="8531349">d</span><span class="op" id="8531350">)</span><br>
<span class="lineno"></span><span class="op" id="8531352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8531355">func</span>&nbsp;<span class="ident" id="8531360">testLevelDict</span><span class="op" id="8531373">(</span><span class="ident" id="8531374">t</span>&nbsp;<span class="op" id="8531376">*</span><span class="ident" id="8531377">testing</span><span class="op" id="8531384">.</span><span class="ident" id="8531385">T</span><span class="op" id="8531386">,</span>&nbsp;<span class="ident" id="8531388">fn</span>&nbsp;<span class="builtintype" id="8531391">string</span><span class="op" id="8531397">,</span>&nbsp;<span class="ident" id="8531399">b0</span>&nbsp;<span class="op" id="8531402">[</span><span class="op" id="8531403">]</span><span class="builtintype" id="8531404">byte</span><span class="op" id="8531408">,</span>&nbsp;<span class="ident" id="8531410">level</span>&nbsp;<span class="builtintype" id="8531416">int</span><span class="op" id="8531419">,</span>&nbsp;<span class="ident" id="8531421">d</span>&nbsp;<span class="builtintype" id="8531423">string</span><span class="op" id="8531429">)</span>&nbsp;<span class="op" id="8531431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8531434">//&nbsp;Make&nbsp;dictionary,&nbsp;if&nbsp;given.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8531465">var</span>&nbsp;<span class="ident" id="8531469">dict</span>&nbsp;<span class="op" id="8531474">[</span><span class="op" id="8531475">]</span><span class="builtintype" id="8531476">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8531482">if</span>&nbsp;<span class="ident" id="8531485">d</span>&nbsp;<span class="op" id="8531487">!=</span>&nbsp;<span class="string" id="8531490">&#34;&#34;</span>&nbsp;<span class="op" id="8531493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8531497">dict</span>&nbsp;<span class="op" id="8531502">=</span>&nbsp;<span class="op" id="8531504">[</span><span class="op" id="8531505">]</span><span class="builtintype" id="8531506">byte</span><span class="op" id="8531510">(</span><span class="ident" id="8531511">d</span><span class="op" id="8531512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8531515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8531519">//&nbsp;Push&nbsp;data&nbsp;through&nbsp;a&nbsp;pipe&nbsp;that&nbsp;compresses&nbsp;at&nbsp;the&nbsp;write&nbsp;end,&nbsp;and&nbsp;decompresses&nbsp;at&nbsp;the&nbsp;read&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8531616">piper</span><span class="op" id="8531621">,</span>&nbsp;<span class="ident" id="8531623">pipew</span>&nbsp;<span class="op" id="8531629">:=</span>&nbsp;<span class="ident" id="8531632">io</span><span class="op" id="8531634">.</span><span class="ident" id="8531635">Pipe</span><span class="op" id="8531639">(</span><span class="op" id="8531640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8531643">defer</span>&nbsp;<span class="ident" id="8531649">piper</span><span class="op" id="8531654">.</span><span class="ident" id="8531655">Close</span><span class="op" id="8531660">(</span><span class="op" id="8531661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8531664">go</span>&nbsp;<span class="keyword" id="8531667">func</span><span class="op" id="8531671">(</span><span class="op" id="8531672">)</span>&nbsp;<span class="op" id="8531674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8531678">defer</span>&nbsp;<span class="ident" id="8531684">pipew</span><span class="op" id="8531689">.</span><span class="ident" id="8531690">Close</span><span class="op" id="8531695">(</span><span class="op" id="8531696">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8531700">zlibw</span><span class="op" id="8531705">,</span>&nbsp;<span class="ident" id="8531707">err</span>&nbsp;<span class="op" id="8531711">:=</span>&nbsp;<span class="ident" id="8531714">NewWriterLevelDict</span><span class="op" id="8531732">(</span><span class="ident" id="8531733">pipew</span><span class="op" id="8531738">,</span>&nbsp;<span class="ident" id="8531740">level</span><span class="op" id="8531745">,</span>&nbsp;<span class="ident" id="8531747">dict</span><span class="op" id="8531751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8531755">if</span>&nbsp;<span class="ident" id="8531758">err</span>&nbsp;<span class="op" id="8531762">!=</span>&nbsp;<span class="builtintype" id="8531765">nil</span>&nbsp;<span class="op" id="8531769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8531774">t</span><span class="op" id="8531775">.</span><span class="ident" id="8531776">Errorf</span><span class="op" id="8531782">(</span><span class="string" id="8531783">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="8531811">,</span>&nbsp;<span class="ident" id="8531813">fn</span><span class="op" id="8531815">,</span>&nbsp;<span class="ident" id="8531817">level</span><span class="op" id="8531822">,</span>&nbsp;<span class="ident" id="8531824">d</span><span class="op" id="8531825">,</span>&nbsp;<span class="ident" id="8531827">err</span><span class="op" id="8531830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8531835">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8531844">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8531848">defer</span>&nbsp;<span class="ident" id="8531854">zlibw</span><span class="op" id="8531859">.</span><span class="ident" id="8531860">Close</span><span class="op" id="8531865">(</span><span class="op" id="8531866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8531870">_</span><span class="op" id="8531871">,</span>&nbsp;<span class="ident" id="8531873">err</span>&nbsp;<span class="op" id="8531877">=</span>&nbsp;<span class="ident" id="8531879">zlibw</span><span class="op" id="8531884">.</span><span class="ident" id="8531885">Write</span><span class="op" id="8531890">(</span><span class="ident" id="8531891">b0</span><span class="op" id="8531893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8531897">if</span>&nbsp;<span class="ident" id="8531900">err</span>&nbsp;<span class="op" id="8531904">!=</span>&nbsp;<span class="builtintype" id="8531907">nil</span>&nbsp;<span class="op" id="8531911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8531916">t</span><span class="op" id="8531917">.</span><span class="ident" id="8531918">Errorf</span><span class="op" id="8531924">(</span><span class="string" id="8531925">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="8531953">,</span>&nbsp;<span class="ident" id="8531955">fn</span><span class="op" id="8531957">,</span>&nbsp;<span class="ident" id="8531959">level</span><span class="op" id="8531964">,</span>&nbsp;<span class="ident" id="8531966">d</span><span class="op" id="8531967">,</span>&nbsp;<span class="ident" id="8531969">err</span><span class="op" id="8531972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8531977">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8531986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8531989">}</span><span class="op" id="8531990">(</span><span class="op" id="8531991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8531994">zlibr</span><span class="op" id="8531999">,</span>&nbsp;<span class="ident" id="8532001">err</span>&nbsp;<span class="op" id="8532005">:=</span>&nbsp;<span class="ident" id="8532008">NewReaderDict</span><span class="op" id="8532021">(</span><span class="ident" id="8532022">piper</span><span class="op" id="8532027">,</span>&nbsp;<span class="ident" id="8532029">dict</span><span class="op" id="8532033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8532036">if</span>&nbsp;<span class="ident" id="8532039">err</span>&nbsp;<span class="op" id="8532043">!=</span>&nbsp;<span class="builtintype" id="8532046">nil</span>&nbsp;<span class="op" id="8532050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8532054">t</span><span class="op" id="8532055">.</span><span class="ident" id="8532056">Errorf</span><span class="op" id="8532062">(</span><span class="string" id="8532063">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="8532091">,</span>&nbsp;<span class="ident" id="8532093">fn</span><span class="op" id="8532095">,</span>&nbsp;<span class="ident" id="8532097">level</span><span class="op" id="8532102">,</span>&nbsp;<span class="ident" id="8532104">d</span><span class="op" id="8532105">,</span>&nbsp;<span class="ident" id="8532107">err</span><span class="op" id="8532110">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8532114">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8532122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8532125">defer</span>&nbsp;<span class="ident" id="8532131">zlibr</span><span class="op" id="8532136">.</span><span class="ident" id="8532137">Close</span><span class="op" id="8532142">(</span><span class="op" id="8532143">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8532147">//&nbsp;Compare&nbsp;the&nbsp;decompressed&nbsp;data.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8532182">b1</span><span class="op" id="8532184">,</span>&nbsp;<span class="ident" id="8532186">err1</span>&nbsp;<span class="op" id="8532191">:=</span>&nbsp;<span class="ident" id="8532194">ioutil</span><span class="op" id="8532200">.</span><span class="ident" id="8532201">ReadAll</span><span class="op" id="8532208">(</span><span class="ident" id="8532209">zlibr</span><span class="op" id="8532214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8532217">if</span>&nbsp;<span class="ident" id="8532220">err1</span>&nbsp;<span class="op" id="8532225">!=</span>&nbsp;<span class="builtintype" id="8532228">nil</span>&nbsp;<span class="op" id="8532232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8532236">t</span><span class="op" id="8532237">.</span><span class="ident" id="8532238">Errorf</span><span class="op" id="8532244">(</span><span class="string" id="8532245">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="8532273">,</span>&nbsp;<span class="ident" id="8532275">fn</span><span class="op" id="8532277">,</span>&nbsp;<span class="ident" id="8532279">level</span><span class="op" id="8532284">,</span>&nbsp;<span class="ident" id="8532286">d</span><span class="op" id="8532287">,</span>&nbsp;<span class="ident" id="8532289">err1</span><span class="op" id="8532293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8532297">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8532305">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8532308">if</span>&nbsp;<span class="builtinfunc" id="8532311">len</span><span class="op" id="8532314">(</span><span class="ident" id="8532315">b0</span><span class="op" id="8532317">)</span>&nbsp;<span class="op" id="8532319">!=</span>&nbsp;<span class="builtinfunc" id="8532322">len</span><span class="op" id="8532325">(</span><span class="ident" id="8532326">b1</span><span class="op" id="8532328">)</span>&nbsp;<span class="op" id="8532330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8532334">t</span><span class="op" id="8532335">.</span><span class="ident" id="8532336">Errorf</span><span class="op" id="8532342">(</span><span class="string" id="8532343">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;length&nbsp;mismatch&nbsp;%d&nbsp;versus&nbsp;%d&#34;</span><span class="op" id="8532397">,</span>&nbsp;<span class="ident" id="8532399">fn</span><span class="op" id="8532401">,</span>&nbsp;<span class="ident" id="8532403">level</span><span class="op" id="8532408">,</span>&nbsp;<span class="ident" id="8532410">d</span><span class="op" id="8532411">,</span>&nbsp;<span class="builtinfunc" id="8532413">len</span><span class="op" id="8532416">(</span><span class="ident" id="8532417">b0</span><span class="op" id="8532419">)</span><span class="op" id="8532420">,</span>&nbsp;<span class="builtinfunc" id="8532422">len</span><span class="op" id="8532425">(</span><span class="ident" id="8532426">b1</span><span class="op" id="8532428">)</span><span class="op" id="8532429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8532433">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8532441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8532444">for</span>&nbsp;<span class="ident" id="8532448">i</span>&nbsp;<span class="op" id="8532450">:=</span>&nbsp;<span class="num" id="8532453">0</span><span class="op" id="8532454">;</span>&nbsp;<span class="ident" id="8532456">i</span>&nbsp;<span class="op" id="8532458">&lt;</span>&nbsp;<span class="builtinfunc" id="8532460">len</span><span class="op" id="8532463">(</span><span class="ident" id="8532464">b0</span><span class="op" id="8532466">)</span><span class="op" id="8532467">;</span>&nbsp;<span class="ident" id="8532469">i</span><span class="op" id="8532470">++</span>&nbsp;<span class="op" id="8532473">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8532477">if</span>&nbsp;<span class="ident" id="8532480">b0</span><span class="op" id="8532482">[</span><span class="ident" id="8532483">i</span><span class="op" id="8532484">]</span>&nbsp;<span class="op" id="8532486">!=</span>&nbsp;<span class="ident" id="8532489">b1</span><span class="op" id="8532491">[</span><span class="ident" id="8532492">i</span><span class="op" id="8532493">]</span>&nbsp;<span class="op" id="8532495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8532500">t</span><span class="op" id="8532501">.</span><span class="ident" id="8532502">Errorf</span><span class="op" id="8532508">(</span><span class="string" id="8532509">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;mismatch&nbsp;at&nbsp;%d,&nbsp;0x%02x&nbsp;versus&nbsp;0x%02x\n&#34;</span><span class="op" id="8532573">,</span>&nbsp;<span class="ident" id="8532575">fn</span><span class="op" id="8532577">,</span>&nbsp;<span class="ident" id="8532579">level</span><span class="op" id="8532584">,</span>&nbsp;<span class="ident" id="8532586">d</span><span class="op" id="8532587">,</span>&nbsp;<span class="ident" id="8532589">i</span><span class="op" id="8532590">,</span>&nbsp;<span class="ident" id="8532592">b0</span><span class="op" id="8532594">[</span><span class="ident" id="8532595">i</span><span class="op" id="8532596">]</span><span class="op" id="8532597">,</span>&nbsp;<span class="ident" id="8532599">b1</span><span class="op" id="8532601">[</span><span class="ident" id="8532602">i</span><span class="op" id="8532603">]</span><span class="op" id="8532604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8532609">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8532618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8532621">}</span><br>
<span class="lineno">90</span><span class="op" id="8532623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8532626">func</span>&nbsp;<span class="ident" id="8532631">testFileLevelDictReset</span><span class="op" id="8532653">(</span><span class="ident" id="8532654">t</span>&nbsp;<span class="op" id="8532656">*</span><span class="ident" id="8532657">testing</span><span class="op" id="8532664">.</span><span class="ident" id="8532665">T</span><span class="op" id="8532666">,</span>&nbsp;<span class="ident" id="8532668">fn</span>&nbsp;<span class="builtintype" id="8532671">string</span><span class="op" id="8532677">,</span>&nbsp;<span class="ident" id="8532679">level</span>&nbsp;<span class="builtintype" id="8532685">int</span><span class="op" id="8532688">,</span>&nbsp;<span class="ident" id="8532690">dict</span>&nbsp;<span class="op" id="8532695">[</span><span class="op" id="8532696">]</span><span class="builtintype" id="8532697">byte</span><span class="op" id="8532701">)</span>&nbsp;<span class="op" id="8532703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8532706">var</span>&nbsp;<span class="ident" id="8532710">b0</span>&nbsp;<span class="op" id="8532713">[</span><span class="op" id="8532714">]</span><span class="builtintype" id="8532715">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8532721">var</span>&nbsp;<span class="ident" id="8532725">err</span>&nbsp;<span class="builtintype" id="8532729">error</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8532736">if</span>&nbsp;<span class="ident" id="8532739">fn</span>&nbsp;<span class="op" id="8532742">!=</span>&nbsp;<span class="string" id="8532745">&#34;&#34;</span>&nbsp;<span class="op" id="8532748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8532752">b0</span><span class="op" id="8532754">,</span>&nbsp;<span class="ident" id="8532756">err</span>&nbsp;<span class="op" id="8532760">=</span>&nbsp;<span class="ident" id="8532762">ioutil</span><span class="op" id="8532768">.</span><span class="ident" id="8532769">ReadFile</span><span class="op" id="8532777">(</span><span class="ident" id="8532778">fn</span><span class="op" id="8532780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8532784">if</span>&nbsp;<span class="ident" id="8532787">err</span>&nbsp;<span class="op" id="8532791">!=</span>&nbsp;<span class="builtintype" id="8532794">nil</span>&nbsp;<span class="op" id="8532798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8532803">t</span><span class="op" id="8532804">.</span><span class="ident" id="8532805">Errorf</span><span class="op" id="8532811">(</span><span class="string" id="8532812">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="8532831">,</span>&nbsp;<span class="ident" id="8532833">fn</span><span class="op" id="8532835">,</span>&nbsp;<span class="ident" id="8532837">level</span><span class="op" id="8532842">,</span>&nbsp;<span class="ident" id="8532844">err</span><span class="op" id="8532847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8532852">return</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8532861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8532864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8532868">//&nbsp;Compress&nbsp;once.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8532887">buf</span>&nbsp;<span class="op" id="8532891">:=</span>&nbsp;<span class="builtinfunc" id="8532894">new</span><span class="op" id="8532897">(</span><span class="ident" id="8532898">bytes</span><span class="op" id="8532903">.</span><span class="ident" id="8532904">Buffer</span><span class="op" id="8532910">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8532913">var</span>&nbsp;<span class="ident" id="8532917">zlibw</span>&nbsp;<span class="op" id="8532923">*</span><span class="ident" id="8532924">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8532932">if</span>&nbsp;<span class="ident" id="8532935">dict</span>&nbsp;<span class="op" id="8532940">==</span>&nbsp;<span class="builtintype" id="8532943">nil</span>&nbsp;<span class="op" id="8532947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8532951">zlibw</span><span class="op" id="8532956">,</span>&nbsp;<span class="ident" id="8532958">err</span>&nbsp;<span class="op" id="8532962">=</span>&nbsp;<span class="ident" id="8532964">NewWriterLevel</span><span class="op" id="8532978">(</span><span class="ident" id="8532979">buf</span><span class="op" id="8532982">,</span>&nbsp;<span class="ident" id="8532984">level</span><span class="op" id="8532989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8532992">}</span>&nbsp;<span class="keyword" id="8532994">else</span>&nbsp;<span class="op" id="8532999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8533003">zlibw</span><span class="op" id="8533008">,</span>&nbsp;<span class="ident" id="8533010">err</span>&nbsp;<span class="op" id="8533014">=</span>&nbsp;<span class="ident" id="8533016">NewWriterLevelDict</span><span class="op" id="8533034">(</span><span class="ident" id="8533035">buf</span><span class="op" id="8533038">,</span>&nbsp;<span class="ident" id="8533040">level</span><span class="op" id="8533045">,</span>&nbsp;<span class="ident" id="8533047">dict</span><span class="op" id="8533051">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8533054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8533057">if</span>&nbsp;<span class="ident" id="8533060">err</span>&nbsp;<span class="op" id="8533064">==</span>&nbsp;<span class="builtintype" id="8533067">nil</span>&nbsp;<span class="op" id="8533071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8533075">_</span><span class="op" id="8533076">,</span>&nbsp;<span class="ident" id="8533078">err</span>&nbsp;<span class="op" id="8533082">=</span>&nbsp;<span class="ident" id="8533084">zlibw</span><span class="op" id="8533089">.</span><span class="ident" id="8533090">Write</span><span class="op" id="8533095">(</span><span class="ident" id="8533096">b0</span><span class="op" id="8533098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8533101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8533104">if</span>&nbsp;<span class="ident" id="8533107">err</span>&nbsp;<span class="op" id="8533111">==</span>&nbsp;<span class="builtintype" id="8533114">nil</span>&nbsp;<span class="op" id="8533118">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8533122">err</span>&nbsp;<span class="op" id="8533126">=</span>&nbsp;<span class="ident" id="8533128">zlibw</span><span class="op" id="8533133">.</span><span class="ident" id="8533134">Close</span><span class="op" id="8533139">(</span><span class="op" id="8533140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8533143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8533146">if</span>&nbsp;<span class="ident" id="8533149">err</span>&nbsp;<span class="op" id="8533153">!=</span>&nbsp;<span class="builtintype" id="8533156">nil</span>&nbsp;<span class="op" id="8533160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8533164">t</span><span class="op" id="8533165">.</span><span class="ident" id="8533166">Errorf</span><span class="op" id="8533172">(</span><span class="string" id="8533173">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="8533192">,</span>&nbsp;<span class="ident" id="8533194">fn</span><span class="op" id="8533196">,</span>&nbsp;<span class="ident" id="8533198">level</span><span class="op" id="8533203">,</span>&nbsp;<span class="ident" id="8533205">err</span><span class="op" id="8533208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8533212">return</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8533220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8533223">out</span>&nbsp;<span class="op" id="8533227">:=</span>&nbsp;<span class="ident" id="8533230">buf</span><span class="op" id="8533233">.</span><span class="ident" id="8533234">String</span><span class="op" id="8533240">(</span><span class="op" id="8533241">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8533245">//&nbsp;Reset&nbsp;and&nbsp;compress&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8533275">buf2</span>&nbsp;<span class="op" id="8533280">:=</span>&nbsp;<span class="builtinfunc" id="8533283">new</span><span class="op" id="8533286">(</span><span class="ident" id="8533287">bytes</span><span class="op" id="8533292">.</span><span class="ident" id="8533293">Buffer</span><span class="op" id="8533299">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8533302">zlibw</span><span class="op" id="8533307">.</span><span class="ident" id="8533308">Reset</span><span class="op" id="8533313">(</span><span class="ident" id="8533314">buf2</span><span class="op" id="8533318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8533321">_</span><span class="op" id="8533322">,</span>&nbsp;<span class="ident" id="8533324">err</span>&nbsp;<span class="op" id="8533328">=</span>&nbsp;<span class="ident" id="8533330">zlibw</span><span class="op" id="8533335">.</span><span class="ident" id="8533336">Write</span><span class="op" id="8533341">(</span><span class="ident" id="8533342">b0</span><span class="op" id="8533344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8533347">if</span>&nbsp;<span class="ident" id="8533350">err</span>&nbsp;<span class="op" id="8533354">==</span>&nbsp;<span class="builtintype" id="8533357">nil</span>&nbsp;<span class="op" id="8533361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8533365">err</span>&nbsp;<span class="op" id="8533369">=</span>&nbsp;<span class="ident" id="8533371">zlibw</span><span class="op" id="8533376">.</span><span class="ident" id="8533377">Close</span><span class="op" id="8533382">(</span><span class="op" id="8533383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8533386">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8533389">if</span>&nbsp;<span class="ident" id="8533392">err</span>&nbsp;<span class="op" id="8533396">!=</span>&nbsp;<span class="builtintype" id="8533399">nil</span>&nbsp;<span class="op" id="8533403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8533407">t</span><span class="op" id="8533408">.</span><span class="ident" id="8533409">Errorf</span><span class="op" id="8533415">(</span><span class="string" id="8533416">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="8533435">,</span>&nbsp;<span class="ident" id="8533437">fn</span><span class="op" id="8533439">,</span>&nbsp;<span class="ident" id="8533441">level</span><span class="op" id="8533446">,</span>&nbsp;<span class="ident" id="8533448">err</span><span class="op" id="8533451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8533455">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8533463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8533466">out2</span>&nbsp;<span class="op" id="8533471">:=</span>&nbsp;<span class="ident" id="8533474">buf2</span><span class="op" id="8533478">.</span><span class="ident" id="8533479">String</span><span class="op" id="8533485">(</span><span class="op" id="8533486">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8533490">if</span>&nbsp;<span class="ident" id="8533493">out2</span>&nbsp;<span class="op" id="8533498">!=</span>&nbsp;<span class="ident" id="8533501">out</span>&nbsp;<span class="op" id="8533505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8533509">t</span><span class="op" id="8533510">.</span><span class="ident" id="8533511">Errorf</span><span class="op" id="8533517">(</span><span class="string" id="8533518">&#34;%s&nbsp;(level=%d):&nbsp;different&nbsp;output&nbsp;after&nbsp;reset&nbsp;(got&nbsp;%d&nbsp;bytes,&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="8533590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8533595">fn</span><span class="op" id="8533597">,</span>&nbsp;<span class="ident" id="8533599">level</span><span class="op" id="8533604">,</span>&nbsp;<span class="builtinfunc" id="8533606">len</span><span class="op" id="8533609">(</span><span class="ident" id="8533610">out2</span><span class="op" id="8533614">)</span><span class="op" id="8533615">,</span>&nbsp;<span class="builtinfunc" id="8533617">len</span><span class="op" id="8533620">(</span><span class="ident" id="8533621">out</span><span class="op" id="8533624">)</span><span class="op" id="8533625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8533628">}</span><br>
<span class="lineno">140</span><span class="op" id="8533630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8533633">func</span>&nbsp;<span class="ident" id="8533638">TestWriter</span><span class="op" id="8533648">(</span><span class="ident" id="8533649">t</span>&nbsp;<span class="op" id="8533651">*</span><span class="ident" id="8533652">testing</span><span class="op" id="8533659">.</span><span class="ident" id="8533660">T</span><span class="op" id="8533661">)</span>&nbsp;<span class="op" id="8533663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8533666">for</span>&nbsp;<span class="ident" id="8533670">i</span><span class="op" id="8533671">,</span>&nbsp;<span class="ident" id="8533673">s</span>&nbsp;<span class="op" id="8533675">:=</span>&nbsp;<span class="keyword" id="8533678">range</span>&nbsp;<span class="ident" id="8533684">data</span>&nbsp;<span class="op" id="8533689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8533693">b</span>&nbsp;<span class="op" id="8533695">:=</span>&nbsp;<span class="op" id="8533698">[</span><span class="op" id="8533699">]</span><span class="builtintype" id="8533700">byte</span><span class="op" id="8533704">(</span><span class="ident" id="8533705">s</span><span class="op" id="8533706">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8533710">tag</span>&nbsp;<span class="op" id="8533714">:=</span>&nbsp;<span class="ident" id="8533717">fmt</span><span class="op" id="8533720">.</span><span class="ident" id="8533721">Sprintf</span><span class="op" id="8533728">(</span><span class="string" id="8533729">&#34;#%d&#34;</span><span class="op" id="8533734">,</span>&nbsp;<span class="ident" id="8533736">i</span><span class="op" id="8533737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8533741">testLevelDict</span><span class="op" id="8533754">(</span><span class="ident" id="8533755">t</span><span class="op" id="8533756">,</span>&nbsp;<span class="ident" id="8533758">tag</span><span class="op" id="8533761">,</span>&nbsp;<span class="ident" id="8533763">b</span><span class="op" id="8533764">,</span>&nbsp;<span class="ident" id="8533766">DefaultCompression</span><span class="op" id="8533784">,</span>&nbsp;<span class="string" id="8533786">&#34;&#34;</span><span class="op" id="8533788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8533792">testLevelDict</span><span class="op" id="8533805">(</span><span class="ident" id="8533806">t</span><span class="op" id="8533807">,</span>&nbsp;<span class="ident" id="8533809">tag</span><span class="op" id="8533812">,</span>&nbsp;<span class="ident" id="8533814">b</span><span class="op" id="8533815">,</span>&nbsp;<span class="ident" id="8533817">NoCompression</span><span class="op" id="8533830">,</span>&nbsp;<span class="string" id="8533832">&#34;&#34;</span><span class="op" id="8533834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8533838">for</span>&nbsp;<span class="ident" id="8533842">level</span>&nbsp;<span class="op" id="8533848">:=</span>&nbsp;<span class="ident" id="8533851">BestSpeed</span><span class="op" id="8533860">;</span>&nbsp;<span class="ident" id="8533862">level</span>&nbsp;<span class="op" id="8533868">&lt;=</span>&nbsp;<span class="ident" id="8533871">BestCompression</span><span class="op" id="8533886">;</span>&nbsp;<span class="ident" id="8533888">level</span><span class="op" id="8533893">++</span>&nbsp;<span class="op" id="8533896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8533901">testLevelDict</span><span class="op" id="8533914">(</span><span class="ident" id="8533915">t</span><span class="op" id="8533916">,</span>&nbsp;<span class="ident" id="8533918">tag</span><span class="op" id="8533921">,</span>&nbsp;<span class="ident" id="8533923">b</span><span class="op" id="8533924">,</span>&nbsp;<span class="ident" id="8533926">level</span><span class="op" id="8533931">,</span>&nbsp;<span class="string" id="8533933">&#34;&#34;</span><span class="op" id="8533935">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8533939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8533942">}</span><br>
<span class="lineno"></span><span class="op" id="8533944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8533947">func</span>&nbsp;<span class="ident" id="8533952">TestWriterBig</span><span class="op" id="8533965">(</span><span class="ident" id="8533966">t</span>&nbsp;<span class="op" id="8533968">*</span><span class="ident" id="8533969">testing</span><span class="op" id="8533976">.</span><span class="ident" id="8533977">T</span><span class="op" id="8533978">)</span>&nbsp;<span class="op" id="8533980">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8533983">for</span>&nbsp;<span class="ident" id="8533987">_</span><span class="op" id="8533988">,</span>&nbsp;<span class="ident" id="8533990">fn</span>&nbsp;<span class="op" id="8533993">:=</span>&nbsp;<span class="keyword" id="8533996">range</span>&nbsp;<span class="ident" id="8534002">filenames</span>&nbsp;<span class="op" id="8534012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8534016">testFileLevelDict</span><span class="op" id="8534033">(</span><span class="ident" id="8534034">t</span><span class="op" id="8534035">,</span>&nbsp;<span class="ident" id="8534037">fn</span><span class="op" id="8534039">,</span>&nbsp;<span class="ident" id="8534041">DefaultCompression</span><span class="op" id="8534059">,</span>&nbsp;<span class="string" id="8534061">&#34;&#34;</span><span class="op" id="8534063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8534067">testFileLevelDict</span><span class="op" id="8534084">(</span><span class="ident" id="8534085">t</span><span class="op" id="8534086">,</span>&nbsp;<span class="ident" id="8534088">fn</span><span class="op" id="8534090">,</span>&nbsp;<span class="ident" id="8534092">NoCompression</span><span class="op" id="8534105">,</span>&nbsp;<span class="string" id="8534107">&#34;&#34;</span><span class="op" id="8534109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8534113">for</span>&nbsp;<span class="ident" id="8534117">level</span>&nbsp;<span class="op" id="8534123">:=</span>&nbsp;<span class="ident" id="8534126">BestSpeed</span><span class="op" id="8534135">;</span>&nbsp;<span class="ident" id="8534137">level</span>&nbsp;<span class="op" id="8534143">&lt;=</span>&nbsp;<span class="ident" id="8534146">BestCompression</span><span class="op" id="8534161">;</span>&nbsp;<span class="ident" id="8534163">level</span><span class="op" id="8534168">++</span>&nbsp;<span class="op" id="8534171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8534176">testFileLevelDict</span><span class="op" id="8534193">(</span><span class="ident" id="8534194">t</span><span class="op" id="8534195">,</span>&nbsp;<span class="ident" id="8534197">fn</span><span class="op" id="8534199">,</span>&nbsp;<span class="ident" id="8534201">level</span><span class="op" id="8534206">,</span>&nbsp;<span class="string" id="8534208">&#34;&#34;</span><span class="op" id="8534210">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8534214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8534217">}</span><br>
<span class="lineno"></span><span class="op" id="8534219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8534222">func</span>&nbsp;<span class="ident" id="8534227">TestWriterDict</span><span class="op" id="8534241">(</span><span class="ident" id="8534242">t</span>&nbsp;<span class="op" id="8534244">*</span><span class="ident" id="8534245">testing</span><span class="op" id="8534252">.</span><span class="ident" id="8534253">T</span><span class="op" id="8534254">)</span>&nbsp;<span class="op" id="8534256">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8534259">const</span>&nbsp;<span class="ident" id="8534265">dictionary</span>&nbsp;<span class="op" id="8534276">=</span>&nbsp;<span class="string" id="8534278">&#34;0123456789.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8534293">for</span>&nbsp;<span class="ident" id="8534297">_</span><span class="op" id="8534298">,</span>&nbsp;<span class="ident" id="8534300">fn</span>&nbsp;<span class="op" id="8534303">:=</span>&nbsp;<span class="keyword" id="8534306">range</span>&nbsp;<span class="ident" id="8534312">filenames</span>&nbsp;<span class="op" id="8534322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8534326">testFileLevelDict</span><span class="op" id="8534343">(</span><span class="ident" id="8534344">t</span><span class="op" id="8534345">,</span>&nbsp;<span class="ident" id="8534347">fn</span><span class="op" id="8534349">,</span>&nbsp;<span class="ident" id="8534351">DefaultCompression</span><span class="op" id="8534369">,</span>&nbsp;<span class="ident" id="8534371">dictionary</span><span class="op" id="8534381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8534385">testFileLevelDict</span><span class="op" id="8534402">(</span><span class="ident" id="8534403">t</span><span class="op" id="8534404">,</span>&nbsp;<span class="ident" id="8534406">fn</span><span class="op" id="8534408">,</span>&nbsp;<span class="ident" id="8534410">NoCompression</span><span class="op" id="8534423">,</span>&nbsp;<span class="ident" id="8534425">dictionary</span><span class="op" id="8534435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8534439">for</span>&nbsp;<span class="ident" id="8534443">level</span>&nbsp;<span class="op" id="8534449">:=</span>&nbsp;<span class="ident" id="8534452">BestSpeed</span><span class="op" id="8534461">;</span>&nbsp;<span class="ident" id="8534463">level</span>&nbsp;<span class="op" id="8534469">&lt;=</span>&nbsp;<span class="ident" id="8534472">BestCompression</span><span class="op" id="8534487">;</span>&nbsp;<span class="ident" id="8534489">level</span><span class="op" id="8534494">++</span>&nbsp;<span class="op" id="8534497">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8534502">testFileLevelDict</span><span class="op" id="8534519">(</span><span class="ident" id="8534520">t</span><span class="op" id="8534521">,</span>&nbsp;<span class="ident" id="8534523">fn</span><span class="op" id="8534525">,</span>&nbsp;<span class="ident" id="8534527">level</span><span class="op" id="8534532">,</span>&nbsp;<span class="ident" id="8534534">dictionary</span><span class="op" id="8534544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8534548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8534551">}</span><br>
<span class="lineno"></span><span class="op" id="8534553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="8534556">func</span>&nbsp;<span class="ident" id="8534561">TestWriterReset</span><span class="op" id="8534576">(</span><span class="ident" id="8534577">t</span>&nbsp;<span class="op" id="8534579">*</span><span class="ident" id="8534580">testing</span><span class="op" id="8534587">.</span><span class="ident" id="8534588">T</span><span class="op" id="8534589">)</span>&nbsp;<span class="op" id="8534591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8534594">const</span>&nbsp;<span class="ident" id="8534600">dictionary</span>&nbsp;<span class="op" id="8534611">=</span>&nbsp;<span class="string" id="8534613">&#34;0123456789.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8534628">for</span>&nbsp;<span class="ident" id="8534632">_</span><span class="op" id="8534633">,</span>&nbsp;<span class="ident" id="8534635">fn</span>&nbsp;<span class="op" id="8534638">:=</span>&nbsp;<span class="keyword" id="8534641">range</span>&nbsp;<span class="ident" id="8534647">filenames</span>&nbsp;<span class="op" id="8534657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8534661">testFileLevelDictReset</span><span class="op" id="8534683">(</span><span class="ident" id="8534684">t</span><span class="op" id="8534685">,</span>&nbsp;<span class="ident" id="8534687">fn</span><span class="op" id="8534689">,</span>&nbsp;<span class="ident" id="8534691">NoCompression</span><span class="op" id="8534704">,</span>&nbsp;<span class="builtintype" id="8534706">nil</span><span class="op" id="8534709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8534713">testFileLevelDictReset</span><span class="op" id="8534735">(</span><span class="ident" id="8534736">t</span><span class="op" id="8534737">,</span>&nbsp;<span class="ident" id="8534739">fn</span><span class="op" id="8534741">,</span>&nbsp;<span class="ident" id="8534743">DefaultCompression</span><span class="op" id="8534761">,</span>&nbsp;<span class="builtintype" id="8534763">nil</span><span class="op" id="8534766">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8534770">testFileLevelDictReset</span><span class="op" id="8534792">(</span><span class="ident" id="8534793">t</span><span class="op" id="8534794">,</span>&nbsp;<span class="ident" id="8534796">fn</span><span class="op" id="8534798">,</span>&nbsp;<span class="ident" id="8534800">NoCompression</span><span class="op" id="8534813">,</span>&nbsp;<span class="op" id="8534815">[</span><span class="op" id="8534816">]</span><span class="builtintype" id="8534817">byte</span><span class="op" id="8534821">(</span><span class="ident" id="8534822">dictionary</span><span class="op" id="8534832">)</span><span class="op" id="8534833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8534837">testFileLevelDictReset</span><span class="op" id="8534859">(</span><span class="ident" id="8534860">t</span><span class="op" id="8534861">,</span>&nbsp;<span class="ident" id="8534863">fn</span><span class="op" id="8534865">,</span>&nbsp;<span class="ident" id="8534867">DefaultCompression</span><span class="op" id="8534885">,</span>&nbsp;<span class="op" id="8534887">[</span><span class="op" id="8534888">]</span><span class="builtintype" id="8534889">byte</span><span class="op" id="8534893">(</span><span class="ident" id="8534894">dictionary</span><span class="op" id="8534904">)</span><span class="op" id="8534905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8534909">if</span>&nbsp;<span class="op" id="8534912">!</span><span class="ident" id="8534913">testing</span><span class="op" id="8534920">.</span><span class="ident" id="8534921">Short</span><span class="op" id="8534926">(</span><span class="op" id="8534927">)</span>&nbsp;<span class="op" id="8534929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8534934">for</span>&nbsp;<span class="ident" id="8534938">level</span>&nbsp;<span class="op" id="8534944">:=</span>&nbsp;<span class="ident" id="8534947">BestSpeed</span><span class="op" id="8534956">;</span>&nbsp;<span class="ident" id="8534958">level</span>&nbsp;<span class="op" id="8534964">&lt;=</span>&nbsp;<span class="ident" id="8534967">BestCompression</span><span class="op" id="8534982">;</span>&nbsp;<span class="ident" id="8534984">level</span><span class="op" id="8534989">++</span>&nbsp;<span class="op" id="8534992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8534998">testFileLevelDictReset</span><span class="op" id="8535020">(</span><span class="ident" id="8535021">t</span><span class="op" id="8535022">,</span>&nbsp;<span class="ident" id="8535024">fn</span><span class="op" id="8535026">,</span>&nbsp;<span class="ident" id="8535028">level</span><span class="op" id="8535033">,</span>&nbsp;<span class="builtintype" id="8535035">nil</span><span class="op" id="8535038">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535050">}</span><br>
<span class="lineno"></span><span class="op" id="8535052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="8535055">func</span>&nbsp;<span class="ident" id="8535060">TestWriterDictIsUsed</span><span class="op" id="8535080">(</span><span class="ident" id="8535081">t</span>&nbsp;<span class="op" id="8535083">*</span><span class="ident" id="8535084">testing</span><span class="op" id="8535091">.</span><span class="ident" id="8535092">T</span><span class="op" id="8535093">)</span>&nbsp;<span class="op" id="8535095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8535098">var</span>&nbsp;<span class="ident" id="8535102">input</span>&nbsp;<span class="op" id="8535108">=</span>&nbsp;<span class="op" id="8535110">[</span><span class="op" id="8535111">]</span><span class="builtintype" id="8535112">byte</span><span class="op" id="8535116">(</span><span class="string" id="8535117">&#34;Lorem&nbsp;ipsum&nbsp;dolor&nbsp;sit&nbsp;amet,&nbsp;consectetur&nbsp;adipisicing&nbsp;elit,&nbsp;sed&nbsp;do&nbsp;eiusmod&nbsp;tempor&nbsp;incididunt&nbsp;ut&nbsp;labore&nbsp;et&nbsp;dolore&nbsp;magna&nbsp;aliqua.&#34;</span><span class="op" id="8535243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8535246">var</span>&nbsp;<span class="ident" id="8535250">buf</span>&nbsp;<span class="ident" id="8535254">bytes</span><span class="op" id="8535259">.</span><span class="ident" id="8535260">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535268">compressor</span><span class="op" id="8535278">,</span>&nbsp;<span class="ident" id="8535280">err</span>&nbsp;<span class="op" id="8535284">:=</span>&nbsp;<span class="ident" id="8535287">NewWriterLevelDict</span><span class="op" id="8535305">(</span><span class="op" id="8535306">&amp;</span><span class="ident" id="8535307">buf</span><span class="op" id="8535310">,</span>&nbsp;<span class="ident" id="8535312">BestCompression</span><span class="op" id="8535327">,</span>&nbsp;<span class="ident" id="8535329">input</span><span class="op" id="8535334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8535337">if</span>&nbsp;<span class="ident" id="8535340">err</span>&nbsp;<span class="op" id="8535344">!=</span>&nbsp;<span class="builtintype" id="8535347">nil</span>&nbsp;<span class="op" id="8535351">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535355">t</span><span class="op" id="8535356">.</span><span class="ident" id="8535357">Errorf</span><span class="op" id="8535363">(</span><span class="string" id="8535364">&#34;error&nbsp;in&nbsp;NewWriterLevelDict:&nbsp;%s&#34;</span><span class="op" id="8535397">,</span>&nbsp;<span class="ident" id="8535399">err</span><span class="op" id="8535402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8535406">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535417">compressor</span><span class="op" id="8535427">.</span><span class="ident" id="8535428">Write</span><span class="op" id="8535433">(</span><span class="ident" id="8535434">input</span><span class="op" id="8535439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535442">compressor</span><span class="op" id="8535452">.</span><span class="ident" id="8535453">Close</span><span class="op" id="8535458">(</span><span class="op" id="8535459">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8535462">const</span>&nbsp;<span class="ident" id="8535468">expectedMaxSize</span>&nbsp;<span class="op" id="8535484">=</span>&nbsp;<span class="num" id="8535486">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535490">output</span>&nbsp;<span class="op" id="8535497">:=</span>&nbsp;<span class="ident" id="8535500">buf</span><span class="op" id="8535503">.</span><span class="ident" id="8535504">Bytes</span><span class="op" id="8535509">(</span><span class="op" id="8535510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8535513">if</span>&nbsp;<span class="builtinfunc" id="8535516">len</span><span class="op" id="8535519">(</span><span class="ident" id="8535520">output</span><span class="op" id="8535526">)</span>&nbsp;<span class="op" id="8535528">&gt;</span>&nbsp;<span class="ident" id="8535530">expectedMaxSize</span>&nbsp;<span class="op" id="8535546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535550">t</span><span class="op" id="8535551">.</span><span class="ident" id="8535552">Errorf</span><span class="op" id="8535558">(</span><span class="string" id="8535559">&#34;result&nbsp;too&nbsp;large&nbsp;(got&nbsp;%d,&nbsp;want&nbsp;&lt;=&nbsp;%d&nbsp;bytes).&nbsp;Is&nbsp;the&nbsp;dictionary&nbsp;being&nbsp;used?&#34;</span><span class="op" id="8535635">,</span>&nbsp;<span class="builtinfunc" id="8535637">len</span><span class="op" id="8535640">(</span><span class="ident" id="8535641">output</span><span class="op" id="8535647">)</span><span class="op" id="8535648">,</span>&nbsp;<span class="ident" id="8535650">expectedMaxSize</span><span class="op" id="8535665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535668">}</span><br>
<span class="lineno">205</span><span class="op" id="8535670">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
