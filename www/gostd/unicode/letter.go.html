<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>unicode</h2>
<ul>
<li><a href="/gostd/unicode/casetables.go.html">casetables.go</a></li>
<li><a href="/gostd/unicode/digit.go.html">digit.go</a></li>
<li><a href="/gostd/unicode/digit_test.go.html">digit_test.go</a></li>
<li><a href="/gostd/unicode/graphic.go.html">graphic.go</a></li>
<li><a href="/gostd/unicode/graphic_test.go.html">graphic_test.go</a></li>
<li><a href="/gostd/unicode/letter.go.html" class="current">letter.go</a></li>
<li><a href="/gostd/unicode/letter_test.go.html">letter_test.go</a></li>
<li><a href="/gostd/unicode/script_test.go.html">script_test.go</a></li>
<li><a href="/gostd/unicode/tables.go.html">tables.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1900023">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1900078">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1900132">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1900183">//&nbsp;Package&nbsp;unicode&nbsp;provides&nbsp;data&nbsp;and&nbsp;functions&nbsp;to&nbsp;test&nbsp;some&nbsp;properties&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1900257">//&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="keyword" id="1900281">package</span>&nbsp;<span class="ident" id="1900289">unicode</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1900298">//&nbsp;Tables&nbsp;are&nbsp;regenerated&nbsp;each&nbsp;time&nbsp;we&nbsp;update&nbsp;the&nbsp;Unicode&nbsp;version.</span><br>
<span class="lineno">10</span><span class="comment" id="1900365">//go:generate&nbsp;go&nbsp;run&nbsp;maketables.go&nbsp;-tables=all&nbsp;-output&nbsp;tables.go</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1900431">const</span>&nbsp;<span class="op" id="1900437">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1900440">MaxRune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1900456">=</span>&nbsp;<span class="string" id="1900458">&#39;\U0010FFFF&#39;</span>&nbsp;<span class="comment" id="1900471">//&nbsp;Maximum&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1900509">ReplacementChar</span>&nbsp;<span class="op" id="1900525">=</span>&nbsp;<span class="string" id="1900527">&#39;\uFFFD&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1900540">//&nbsp;Represents&nbsp;invalid&nbsp;code&nbsp;points.</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1900576">MaxASCII</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1900592">=</span>&nbsp;<span class="string" id="1900594">&#39;\u007F&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1900607">//&nbsp;maximum&nbsp;ASCII&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1900632">MaxLatin1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1900648">=</span>&nbsp;<span class="string" id="1900650">&#39;\u00FF&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1900663">//&nbsp;maximum&nbsp;Latin-1&nbsp;value.</span><br>
<span class="lineno"></span><span class="op" id="1900689">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1900692">//&nbsp;RangeTable&nbsp;defines&nbsp;a&nbsp;set&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;by&nbsp;listing&nbsp;the&nbsp;ranges&nbsp;of</span><br>
<span class="lineno">20</span><span class="comment" id="1900768">//&nbsp;code&nbsp;points&nbsp;within&nbsp;the&nbsp;set.&nbsp;The&nbsp;ranges&nbsp;are&nbsp;listed&nbsp;in&nbsp;two&nbsp;slices</span><br>
<span class="lineno"></span><span class="comment" id="1900835">//&nbsp;to&nbsp;save&nbsp;space:&nbsp;a&nbsp;slice&nbsp;of&nbsp;16-bit&nbsp;ranges&nbsp;and&nbsp;a&nbsp;slice&nbsp;of&nbsp;32-bit&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="comment" id="1900908">//&nbsp;The&nbsp;two&nbsp;slices&nbsp;must&nbsp;be&nbsp;in&nbsp;sorted&nbsp;order&nbsp;and&nbsp;non-overlapping.</span><br>
<span class="lineno"></span><span class="comment" id="1900971">//&nbsp;Also,&nbsp;R32&nbsp;should&nbsp;contain&nbsp;only&nbsp;values&nbsp;&gt;=&nbsp;0x10000&nbsp;(1&lt;&lt;16).</span><br>
<span class="lineno"></span><span class="keyword" id="1901031">type</span>&nbsp;<span class="ident" id="1901036">RangeTable</span>&nbsp;<span class="keyword" id="1901047">struct</span>&nbsp;<span class="op" id="1901054">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1901057">R16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1901069">[</span><span class="op" id="1901070">]</span><span class="ident" id="1901071">Range16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1901080">R32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1901092">[</span><span class="op" id="1901093">]</span><span class="ident" id="1901094">Range32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1901103">LatinOffset</span>&nbsp;<span class="builtintype" id="1901115">int</span>&nbsp;<span class="comment" id="1901119">//&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;R16&nbsp;with&nbsp;Hi&nbsp;&lt;=&nbsp;MaxLatin1</span><br>
<span class="lineno"></span><span class="op" id="1901168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="1901171">//&nbsp;Range16&nbsp;represents&nbsp;of&nbsp;a&nbsp;range&nbsp;of&nbsp;16-bit&nbsp;Unicode&nbsp;code&nbsp;points.&nbsp;&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi</span><br>
<span class="lineno"></span><span class="comment" id="1901265">//&nbsp;inclusive&nbsp;and&nbsp;has&nbsp;the&nbsp;specified&nbsp;stride.</span><br>
<span class="lineno"></span><span class="keyword" id="1901308">type</span>&nbsp;<span class="ident" id="1901313">Range16</span>&nbsp;<span class="keyword" id="1901321">struct</span>&nbsp;<span class="op" id="1901328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1901331">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1901338">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1901346">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1901353">uint16</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1901361">Stride</span>&nbsp;<span class="builtintype" id="1901368">uint16</span><br>
<span class="lineno"></span><span class="op" id="1901375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1901378">//&nbsp;Range32&nbsp;represents&nbsp;of&nbsp;a&nbsp;range&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;and&nbsp;is&nbsp;used&nbsp;when&nbsp;one&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1901458">//&nbsp;more&nbsp;of&nbsp;the&nbsp;values&nbsp;will&nbsp;not&nbsp;fit&nbsp;in&nbsp;16&nbsp;bits.&nbsp;&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi</span><br>
<span class="lineno">40</span><span class="comment" id="1901535">//&nbsp;inclusive&nbsp;and&nbsp;has&nbsp;the&nbsp;specified&nbsp;stride.&nbsp;Lo&nbsp;and&nbsp;Hi&nbsp;must&nbsp;always&nbsp;be&nbsp;&gt;=&nbsp;1&lt;&lt;16.</span><br>
<span class="lineno"></span><span class="keyword" id="1901613">type</span>&nbsp;<span class="ident" id="1901618">Range32</span>&nbsp;<span class="keyword" id="1901626">struct</span>&nbsp;<span class="op" id="1901633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1901636">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1901643">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1901651">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1901658">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1901666">Stride</span>&nbsp;<span class="builtintype" id="1901673">uint32</span><br>
<span class="lineno">45</span><span class="op" id="1901680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1901683">//&nbsp;CaseRange&nbsp;represents&nbsp;a&nbsp;range&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;for&nbsp;simple&nbsp;(one</span><br>
<span class="lineno"></span><span class="comment" id="1901754">//&nbsp;code&nbsp;point&nbsp;to&nbsp;one&nbsp;code&nbsp;point)&nbsp;case&nbsp;conversion.</span><br>
<span class="lineno"></span><span class="comment" id="1901804">//&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi&nbsp;inclusive,&nbsp;with&nbsp;a&nbsp;fixed&nbsp;stride&nbsp;of&nbsp;1.&nbsp;&nbsp;Deltas</span><br>
<span class="lineno">50</span><span class="comment" id="1901881">//&nbsp;are&nbsp;the&nbsp;number&nbsp;to&nbsp;add&nbsp;to&nbsp;the&nbsp;code&nbsp;point&nbsp;to&nbsp;reach&nbsp;the&nbsp;code&nbsp;point&nbsp;for&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="1901954">//&nbsp;different&nbsp;case&nbsp;for&nbsp;that&nbsp;character.&nbsp;&nbsp;They&nbsp;may&nbsp;be&nbsp;negative.&nbsp;&nbsp;If&nbsp;zero,&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="1902028">//&nbsp;means&nbsp;the&nbsp;character&nbsp;is&nbsp;in&nbsp;the&nbsp;corresponding&nbsp;case.&nbsp;There&nbsp;is&nbsp;a&nbsp;special</span><br>
<span class="lineno"></span><span class="comment" id="1902100">//&nbsp;case&nbsp;representing&nbsp;sequences&nbsp;of&nbsp;alternating&nbsp;corresponding&nbsp;Upper&nbsp;and&nbsp;Lower</span><br>
<span class="lineno"></span><span class="comment" id="1902176">//&nbsp;pairs.&nbsp;&nbsp;It&nbsp;appears&nbsp;with&nbsp;a&nbsp;fixed&nbsp;Delta&nbsp;of</span><br>
<span class="lineno">55</span><span class="comment" id="1902220">//&nbsp;&nbsp;&nbsp;&nbsp;{UpperLower,&nbsp;UpperLower,&nbsp;UpperLower}</span><br>
<span class="lineno"></span><span class="comment" id="1902260">//&nbsp;The&nbsp;constant&nbsp;UpperLower&nbsp;has&nbsp;an&nbsp;otherwise&nbsp;impossible&nbsp;delta&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="1902328">type</span>&nbsp;<span class="ident" id="1902333">CaseRange</span>&nbsp;<span class="keyword" id="1902343">struct</span>&nbsp;<span class="op" id="1902350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1902353">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1902359">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1902367">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1902373">uint32</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1902381">Delta</span>&nbsp;<span class="ident" id="1902387">d</span><br>
<span class="lineno"></span><span class="op" id="1902389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1902392">//&nbsp;SpecialCase&nbsp;represents&nbsp;language-specific&nbsp;case&nbsp;mappings&nbsp;such&nbsp;as&nbsp;Turkish.</span><br>
<span class="lineno"></span><span class="comment" id="1902467">//&nbsp;Methods&nbsp;of&nbsp;SpecialCase&nbsp;customize&nbsp;(by&nbsp;overriding)&nbsp;the&nbsp;standard&nbsp;mappings.</span><br>
<span class="lineno">65</span><span class="keyword" id="1902542">type</span>&nbsp;<span class="ident" id="1902547">SpecialCase</span>&nbsp;<span class="op" id="1902559">[</span><span class="op" id="1902560">]</span><span class="ident" id="1902561">CaseRange</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1902572">//&nbsp;BUG(r):&nbsp;There&nbsp;is&nbsp;no&nbsp;mechanism&nbsp;for&nbsp;full&nbsp;case&nbsp;folding,&nbsp;that&nbsp;is,&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="1902641">//&nbsp;characters&nbsp;that&nbsp;involve&nbsp;multiple&nbsp;runes&nbsp;in&nbsp;the&nbsp;input&nbsp;or&nbsp;output.</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="1902708">//&nbsp;Indices&nbsp;into&nbsp;the&nbsp;Delta&nbsp;arrays&nbsp;inside&nbsp;CaseRanges&nbsp;for&nbsp;case&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1902777">const</span>&nbsp;<span class="op" id="1902783">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1902786">UpperCase</span>&nbsp;<span class="op" id="1902796">=</span>&nbsp;<span class="ident" id="1902798">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1902804">LowerCase</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1902815">TitleCase</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1902826">MaxCase</span><br>
<span class="lineno"></span><span class="op" id="1902834">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1902837">type</span>&nbsp;<span class="ident" id="1902842">d</span>&nbsp;<span class="op" id="1902844">[</span><span class="ident" id="1902845">MaxCase</span><span class="op" id="1902852">]</span><span class="builtintype" id="1902853">rune</span>&nbsp;<span class="comment" id="1902858">//&nbsp;to&nbsp;make&nbsp;the&nbsp;CaseRanges&nbsp;text&nbsp;shorter</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="1902898">//&nbsp;If&nbsp;the&nbsp;Delta&nbsp;field&nbsp;of&nbsp;a&nbsp;CaseRange&nbsp;is&nbsp;UpperLower,&nbsp;it&nbsp;means</span><br>
<span class="lineno"></span><span class="comment" id="1902959">//&nbsp;this&nbsp;CaseRange&nbsp;represents&nbsp;a&nbsp;sequence&nbsp;of&nbsp;the&nbsp;form&nbsp;(say)</span><br>
<span class="lineno"></span><span class="comment" id="1903017">//&nbsp;Upper&nbsp;Lower&nbsp;Upper&nbsp;Lower.</span><br>
<span class="lineno"></span><span class="keyword" id="1903045">const</span>&nbsp;<span class="op" id="1903051">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1903054">UpperLower</span>&nbsp;<span class="op" id="1903065">=</span>&nbsp;<span class="ident" id="1903067">MaxRune</span>&nbsp;<span class="op" id="1903075">+</span>&nbsp;<span class="num" id="1903077">1</span>&nbsp;<span class="comment" id="1903079">//&nbsp;(Cannot&nbsp;be&nbsp;a&nbsp;valid&nbsp;delta.)</span><br>
<span class="lineno">85</span><span class="op" id="1903109">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1903112">//&nbsp;linearMax&nbsp;is&nbsp;the&nbsp;maximum&nbsp;size&nbsp;table&nbsp;for&nbsp;linear&nbsp;search&nbsp;for&nbsp;non-Latin1&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="1903190">//&nbsp;Derived&nbsp;by&nbsp;running&nbsp;&#39;go&nbsp;test&nbsp;-calibrate&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="1903234">const</span>&nbsp;<span class="ident" id="1903240">linearMax</span>&nbsp;<span class="op" id="1903250">=</span>&nbsp;<span class="num" id="1903252">18</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="1903256">//&nbsp;is16&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;in&nbsp;the&nbsp;sorted&nbsp;slice&nbsp;of&nbsp;16-bit&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="keyword" id="1903323">func</span>&nbsp;<span class="ident" id="1903328">is16</span><span class="op" id="1903332">(</span><span class="ident" id="1903333">ranges</span>&nbsp;<span class="op" id="1903340">[</span><span class="op" id="1903341">]</span><span class="ident" id="1903342">Range16</span><span class="op" id="1903349">,</span>&nbsp;<span class="ident" id="1903351">r</span>&nbsp;<span class="builtintype" id="1903353">uint16</span><span class="op" id="1903359">)</span>&nbsp;<span class="builtintype" id="1903361">bool</span>&nbsp;<span class="op" id="1903366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1903369">if</span>&nbsp;<span class="builtinfunc" id="1903372">len</span><span class="op" id="1903375">(</span><span class="ident" id="1903376">ranges</span><span class="op" id="1903382">)</span>&nbsp;<span class="op" id="1903384">&lt;=</span>&nbsp;<span class="ident" id="1903387">linearMax</span>&nbsp;<span class="op" id="1903397">||</span>&nbsp;<span class="ident" id="1903400">r</span>&nbsp;<span class="op" id="1903402">&lt;=</span>&nbsp;<span class="ident" id="1903405">MaxLatin1</span>&nbsp;<span class="op" id="1903415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1903419">for</span>&nbsp;<span class="ident" id="1903423">i</span>&nbsp;<span class="op" id="1903425">:=</span>&nbsp;<span class="keyword" id="1903428">range</span>&nbsp;<span class="ident" id="1903434">ranges</span>&nbsp;<span class="op" id="1903441">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1903446">range_</span>&nbsp;<span class="op" id="1903453">:=</span>&nbsp;<span class="op" id="1903456">&amp;</span><span class="ident" id="1903457">ranges</span><span class="op" id="1903463">[</span><span class="ident" id="1903464">i</span><span class="op" id="1903465">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1903470">if</span>&nbsp;<span class="ident" id="1903473">r</span>&nbsp;<span class="op" id="1903475">&lt;</span>&nbsp;<span class="ident" id="1903477">range_</span><span class="op" id="1903483">.</span><span class="ident" id="1903484">Lo</span>&nbsp;<span class="op" id="1903487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1903493">return</span>&nbsp;<span class="builtintype" id="1903500">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1903509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1903514">if</span>&nbsp;<span class="ident" id="1903517">r</span>&nbsp;<span class="op" id="1903519">&lt;=</span>&nbsp;<span class="ident" id="1903522">range_</span><span class="op" id="1903528">.</span><span class="ident" id="1903529">Hi</span>&nbsp;<span class="op" id="1903532">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1903538">return</span>&nbsp;<span class="op" id="1903545">(</span><span class="ident" id="1903546">r</span><span class="op" id="1903547">-</span><span class="ident" id="1903548">range_</span><span class="op" id="1903554">.</span><span class="ident" id="1903555">Lo</span><span class="op" id="1903557">)</span><span class="op" id="1903558">%</span><span class="ident" id="1903559">range_</span><span class="op" id="1903565">.</span><span class="ident" id="1903566">Stride</span>&nbsp;<span class="op" id="1903573">==</span>&nbsp;<span class="num" id="1903576">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1903581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1903585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1903589">return</span>&nbsp;<span class="builtintype" id="1903596">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1903603">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1903607">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1903637">lo</span>&nbsp;<span class="op" id="1903640">:=</span>&nbsp;<span class="num" id="1903643">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1903646">hi</span>&nbsp;<span class="op" id="1903649">:=</span>&nbsp;<span class="builtinfunc" id="1903652">len</span><span class="op" id="1903655">(</span><span class="ident" id="1903656">ranges</span><span class="op" id="1903662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1903665">for</span>&nbsp;<span class="ident" id="1903669">lo</span>&nbsp;<span class="op" id="1903672">&lt;</span>&nbsp;<span class="ident" id="1903674">hi</span>&nbsp;<span class="op" id="1903677">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1903681">m</span>&nbsp;<span class="op" id="1903683">:=</span>&nbsp;<span class="ident" id="1903686">lo</span>&nbsp;<span class="op" id="1903689">+</span>&nbsp;<span class="op" id="1903691">(</span><span class="ident" id="1903692">hi</span><span class="op" id="1903694">-</span><span class="ident" id="1903695">lo</span><span class="op" id="1903697">)</span><span class="op" id="1903698">/</span><span class="num" id="1903699">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1903703">range_</span>&nbsp;<span class="op" id="1903710">:=</span>&nbsp;<span class="op" id="1903713">&amp;</span><span class="ident" id="1903714">ranges</span><span class="op" id="1903720">[</span><span class="ident" id="1903721">m</span><span class="op" id="1903722">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1903726">if</span>&nbsp;<span class="ident" id="1903729">range_</span><span class="op" id="1903735">.</span><span class="ident" id="1903736">Lo</span>&nbsp;<span class="op" id="1903739">&lt;=</span>&nbsp;<span class="ident" id="1903742">r</span>&nbsp;<span class="op" id="1903744">&amp;&amp;</span>&nbsp;<span class="ident" id="1903747">r</span>&nbsp;<span class="op" id="1903749">&lt;=</span>&nbsp;<span class="ident" id="1903752">range_</span><span class="op" id="1903758">.</span><span class="ident" id="1903759">Hi</span>&nbsp;<span class="op" id="1903762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1903767">return</span>&nbsp;<span class="op" id="1903774">(</span><span class="ident" id="1903775">r</span><span class="op" id="1903776">-</span><span class="ident" id="1903777">range_</span><span class="op" id="1903783">.</span><span class="ident" id="1903784">Lo</span><span class="op" id="1903786">)</span><span class="op" id="1903787">%</span><span class="ident" id="1903788">range_</span><span class="op" id="1903794">.</span><span class="ident" id="1903795">Stride</span>&nbsp;<span class="op" id="1903802">==</span>&nbsp;<span class="num" id="1903805">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1903809">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1903813">if</span>&nbsp;<span class="ident" id="1903816">r</span>&nbsp;<span class="op" id="1903818">&lt;</span>&nbsp;<span class="ident" id="1903820">range_</span><span class="op" id="1903826">.</span><span class="ident" id="1903827">Lo</span>&nbsp;<span class="op" id="1903830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1903835">hi</span>&nbsp;<span class="op" id="1903838">=</span>&nbsp;<span class="ident" id="1903840">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1903844">}</span>&nbsp;<span class="keyword" id="1903846">else</span>&nbsp;<span class="op" id="1903851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1903856">lo</span>&nbsp;<span class="op" id="1903859">=</span>&nbsp;<span class="ident" id="1903861">m</span>&nbsp;<span class="op" id="1903863">+</span>&nbsp;<span class="num" id="1903865">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1903869">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1903872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1903875">return</span>&nbsp;<span class="builtintype" id="1903882">false</span><br>
<span class="lineno"></span><span class="op" id="1903888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1903891">//&nbsp;is32&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;in&nbsp;the&nbsp;sorted&nbsp;slice&nbsp;of&nbsp;32-bit&nbsp;ranges.</span><br>
<span class="lineno">125</span><span class="keyword" id="1903958">func</span>&nbsp;<span class="ident" id="1903963">is32</span><span class="op" id="1903967">(</span><span class="ident" id="1903968">ranges</span>&nbsp;<span class="op" id="1903975">[</span><span class="op" id="1903976">]</span><span class="ident" id="1903977">Range32</span><span class="op" id="1903984">,</span>&nbsp;<span class="ident" id="1903986">r</span>&nbsp;<span class="builtintype" id="1903988">uint32</span><span class="op" id="1903994">)</span>&nbsp;<span class="builtintype" id="1903996">bool</span>&nbsp;<span class="op" id="1904001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1904004">if</span>&nbsp;<span class="builtinfunc" id="1904007">len</span><span class="op" id="1904010">(</span><span class="ident" id="1904011">ranges</span><span class="op" id="1904017">)</span>&nbsp;<span class="op" id="1904019">&lt;=</span>&nbsp;<span class="ident" id="1904022">linearMax</span>&nbsp;<span class="op" id="1904032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1904036">for</span>&nbsp;<span class="ident" id="1904040">i</span>&nbsp;<span class="op" id="1904042">:=</span>&nbsp;<span class="keyword" id="1904045">range</span>&nbsp;<span class="ident" id="1904051">ranges</span>&nbsp;<span class="op" id="1904058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1904063">range_</span>&nbsp;<span class="op" id="1904070">:=</span>&nbsp;<span class="op" id="1904073">&amp;</span><span class="ident" id="1904074">ranges</span><span class="op" id="1904080">[</span><span class="ident" id="1904081">i</span><span class="op" id="1904082">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1904087">if</span>&nbsp;<span class="ident" id="1904090">r</span>&nbsp;<span class="op" id="1904092">&lt;</span>&nbsp;<span class="ident" id="1904094">range_</span><span class="op" id="1904100">.</span><span class="ident" id="1904101">Lo</span>&nbsp;<span class="op" id="1904104">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1904110">return</span>&nbsp;<span class="builtintype" id="1904117">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1904126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1904131">if</span>&nbsp;<span class="ident" id="1904134">r</span>&nbsp;<span class="op" id="1904136">&lt;=</span>&nbsp;<span class="ident" id="1904139">range_</span><span class="op" id="1904145">.</span><span class="ident" id="1904146">Hi</span>&nbsp;<span class="op" id="1904149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1904155">return</span>&nbsp;<span class="op" id="1904162">(</span><span class="ident" id="1904163">r</span><span class="op" id="1904164">-</span><span class="ident" id="1904165">range_</span><span class="op" id="1904171">.</span><span class="ident" id="1904172">Lo</span><span class="op" id="1904174">)</span><span class="op" id="1904175">%</span><span class="ident" id="1904176">range_</span><span class="op" id="1904182">.</span><span class="ident" id="1904183">Stride</span>&nbsp;<span class="op" id="1904190">==</span>&nbsp;<span class="num" id="1904193">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1904198">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1904202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1904206">return</span>&nbsp;<span class="builtintype" id="1904213">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1904220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1904224">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1904254">lo</span>&nbsp;<span class="op" id="1904257">:=</span>&nbsp;<span class="num" id="1904260">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1904263">hi</span>&nbsp;<span class="op" id="1904266">:=</span>&nbsp;<span class="builtinfunc" id="1904269">len</span><span class="op" id="1904272">(</span><span class="ident" id="1904273">ranges</span><span class="op" id="1904279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1904282">for</span>&nbsp;<span class="ident" id="1904286">lo</span>&nbsp;<span class="op" id="1904289">&lt;</span>&nbsp;<span class="ident" id="1904291">hi</span>&nbsp;<span class="op" id="1904294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1904298">m</span>&nbsp;<span class="op" id="1904300">:=</span>&nbsp;<span class="ident" id="1904303">lo</span>&nbsp;<span class="op" id="1904306">+</span>&nbsp;<span class="op" id="1904308">(</span><span class="ident" id="1904309">hi</span><span class="op" id="1904311">-</span><span class="ident" id="1904312">lo</span><span class="op" id="1904314">)</span><span class="op" id="1904315">/</span><span class="num" id="1904316">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1904320">range_</span>&nbsp;<span class="op" id="1904327">:=</span>&nbsp;<span class="ident" id="1904330">ranges</span><span class="op" id="1904336">[</span><span class="ident" id="1904337">m</span><span class="op" id="1904338">]</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1904342">if</span>&nbsp;<span class="ident" id="1904345">range_</span><span class="op" id="1904351">.</span><span class="ident" id="1904352">Lo</span>&nbsp;<span class="op" id="1904355">&lt;=</span>&nbsp;<span class="ident" id="1904358">r</span>&nbsp;<span class="op" id="1904360">&amp;&amp;</span>&nbsp;<span class="ident" id="1904363">r</span>&nbsp;<span class="op" id="1904365">&lt;=</span>&nbsp;<span class="ident" id="1904368">range_</span><span class="op" id="1904374">.</span><span class="ident" id="1904375">Hi</span>&nbsp;<span class="op" id="1904378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1904383">return</span>&nbsp;<span class="op" id="1904390">(</span><span class="ident" id="1904391">r</span><span class="op" id="1904392">-</span><span class="ident" id="1904393">range_</span><span class="op" id="1904399">.</span><span class="ident" id="1904400">Lo</span><span class="op" id="1904402">)</span><span class="op" id="1904403">%</span><span class="ident" id="1904404">range_</span><span class="op" id="1904410">.</span><span class="ident" id="1904411">Stride</span>&nbsp;<span class="op" id="1904418">==</span>&nbsp;<span class="num" id="1904421">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1904425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1904429">if</span>&nbsp;<span class="ident" id="1904432">r</span>&nbsp;<span class="op" id="1904434">&lt;</span>&nbsp;<span class="ident" id="1904436">range_</span><span class="op" id="1904442">.</span><span class="ident" id="1904443">Lo</span>&nbsp;<span class="op" id="1904446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1904451">hi</span>&nbsp;<span class="op" id="1904454">=</span>&nbsp;<span class="ident" id="1904456">m</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1904460">}</span>&nbsp;<span class="keyword" id="1904462">else</span>&nbsp;<span class="op" id="1904467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1904472">lo</span>&nbsp;<span class="op" id="1904475">=</span>&nbsp;<span class="ident" id="1904477">m</span>&nbsp;<span class="op" id="1904479">+</span>&nbsp;<span class="num" id="1904481">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1904485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1904488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1904491">return</span>&nbsp;<span class="builtintype" id="1904498">false</span><br>
<span class="lineno">155</span><span class="op" id="1904504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1904507">//&nbsp;Is&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;in&nbsp;the&nbsp;specified&nbsp;table&nbsp;of&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="keyword" id="1904575">func</span>&nbsp;<span class="ident" id="1904580">Is</span><span class="op" id="1904582">(</span><span class="ident" id="1904583">rangeTab</span>&nbsp;<span class="op" id="1904592">*</span><span class="ident" id="1904593">RangeTable</span><span class="op" id="1904603">,</span>&nbsp;<span class="ident" id="1904605">r</span>&nbsp;<span class="builtintype" id="1904607">rune</span><span class="op" id="1904611">)</span>&nbsp;<span class="builtintype" id="1904613">bool</span>&nbsp;<span class="op" id="1904618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1904621">r16</span>&nbsp;<span class="op" id="1904625">:=</span>&nbsp;<span class="ident" id="1904628">rangeTab</span><span class="op" id="1904636">.</span><span class="ident" id="1904637">R16</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1904642">if</span>&nbsp;<span class="builtinfunc" id="1904645">len</span><span class="op" id="1904648">(</span><span class="ident" id="1904649">r16</span><span class="op" id="1904652">)</span>&nbsp;<span class="op" id="1904654">&gt;</span>&nbsp;<span class="num" id="1904656">0</span>&nbsp;<span class="op" id="1904658">&amp;&amp;</span>&nbsp;<span class="ident" id="1904661">r</span>&nbsp;<span class="op" id="1904663">&lt;=</span>&nbsp;<span class="builtintype" id="1904666">rune</span><span class="op" id="1904670">(</span><span class="ident" id="1904671">r16</span><span class="op" id="1904674">[</span><span class="builtinfunc" id="1904675">len</span><span class="op" id="1904678">(</span><span class="ident" id="1904679">r16</span><span class="op" id="1904682">)</span><span class="op" id="1904683">-</span><span class="num" id="1904684">1</span><span class="op" id="1904685">]</span><span class="op" id="1904686">.</span><span class="ident" id="1904687">Hi</span><span class="op" id="1904689">)</span>&nbsp;<span class="op" id="1904691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1904695">return</span>&nbsp;<span class="ident" id="1904702">is16</span><span class="op" id="1904706">(</span><span class="ident" id="1904707">r16</span><span class="op" id="1904710">,</span>&nbsp;<span class="builtintype" id="1904712">uint16</span><span class="op" id="1904718">(</span><span class="ident" id="1904719">r</span><span class="op" id="1904720">)</span><span class="op" id="1904721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1904724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1904727">r32</span>&nbsp;<span class="op" id="1904731">:=</span>&nbsp;<span class="ident" id="1904734">rangeTab</span><span class="op" id="1904742">.</span><span class="ident" id="1904743">R32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1904748">if</span>&nbsp;<span class="builtinfunc" id="1904751">len</span><span class="op" id="1904754">(</span><span class="ident" id="1904755">r32</span><span class="op" id="1904758">)</span>&nbsp;<span class="op" id="1904760">&gt;</span>&nbsp;<span class="num" id="1904762">0</span>&nbsp;<span class="op" id="1904764">&amp;&amp;</span>&nbsp;<span class="ident" id="1904767">r</span>&nbsp;<span class="op" id="1904769">&gt;=</span>&nbsp;<span class="builtintype" id="1904772">rune</span><span class="op" id="1904776">(</span><span class="ident" id="1904777">r32</span><span class="op" id="1904780">[</span><span class="num" id="1904781">0</span><span class="op" id="1904782">]</span><span class="op" id="1904783">.</span><span class="ident" id="1904784">Lo</span><span class="op" id="1904786">)</span>&nbsp;<span class="op" id="1904788">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1904792">return</span>&nbsp;<span class="ident" id="1904799">is32</span><span class="op" id="1904803">(</span><span class="ident" id="1904804">r32</span><span class="op" id="1904807">,</span>&nbsp;<span class="builtintype" id="1904809">uint32</span><span class="op" id="1904815">(</span><span class="ident" id="1904816">r</span><span class="op" id="1904817">)</span><span class="op" id="1904818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1904821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1904824">return</span>&nbsp;<span class="builtintype" id="1904831">false</span><br>
<span class="lineno"></span><span class="op" id="1904837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="1904840">func</span>&nbsp;<span class="ident" id="1904845">isExcludingLatin</span><span class="op" id="1904861">(</span><span class="ident" id="1904862">rangeTab</span>&nbsp;<span class="op" id="1904871">*</span><span class="ident" id="1904872">RangeTable</span><span class="op" id="1904882">,</span>&nbsp;<span class="ident" id="1904884">r</span>&nbsp;<span class="builtintype" id="1904886">rune</span><span class="op" id="1904890">)</span>&nbsp;<span class="builtintype" id="1904892">bool</span>&nbsp;<span class="op" id="1904897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1904900">r16</span>&nbsp;<span class="op" id="1904904">:=</span>&nbsp;<span class="ident" id="1904907">rangeTab</span><span class="op" id="1904915">.</span><span class="ident" id="1904916">R16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1904921">if</span>&nbsp;<span class="ident" id="1904924">off</span>&nbsp;<span class="op" id="1904928">:=</span>&nbsp;<span class="ident" id="1904931">rangeTab</span><span class="op" id="1904939">.</span><span class="ident" id="1904940">LatinOffset</span><span class="op" id="1904951">;</span>&nbsp;<span class="builtinfunc" id="1904953">len</span><span class="op" id="1904956">(</span><span class="ident" id="1904957">r16</span><span class="op" id="1904960">)</span>&nbsp;<span class="op" id="1904962">&gt;</span>&nbsp;<span class="ident" id="1904964">off</span>&nbsp;<span class="op" id="1904968">&amp;&amp;</span>&nbsp;<span class="ident" id="1904971">r</span>&nbsp;<span class="op" id="1904973">&lt;=</span>&nbsp;<span class="builtintype" id="1904976">rune</span><span class="op" id="1904980">(</span><span class="ident" id="1904981">r16</span><span class="op" id="1904984">[</span><span class="builtinfunc" id="1904985">len</span><span class="op" id="1904988">(</span><span class="ident" id="1904989">r16</span><span class="op" id="1904992">)</span><span class="op" id="1904993">-</span><span class="num" id="1904994">1</span><span class="op" id="1904995">]</span><span class="op" id="1904996">.</span><span class="ident" id="1904997">Hi</span><span class="op" id="1904999">)</span>&nbsp;<span class="op" id="1905001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1905005">return</span>&nbsp;<span class="ident" id="1905012">is16</span><span class="op" id="1905016">(</span><span class="ident" id="1905017">r16</span><span class="op" id="1905020">[</span><span class="ident" id="1905021">off</span><span class="op" id="1905024">:</span><span class="op" id="1905025">]</span><span class="op" id="1905026">,</span>&nbsp;<span class="builtintype" id="1905028">uint16</span><span class="op" id="1905034">(</span><span class="ident" id="1905035">r</span><span class="op" id="1905036">)</span><span class="op" id="1905037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1905040">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1905043">r32</span>&nbsp;<span class="op" id="1905047">:=</span>&nbsp;<span class="ident" id="1905050">rangeTab</span><span class="op" id="1905058">.</span><span class="ident" id="1905059">R32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1905064">if</span>&nbsp;<span class="builtinfunc" id="1905067">len</span><span class="op" id="1905070">(</span><span class="ident" id="1905071">r32</span><span class="op" id="1905074">)</span>&nbsp;<span class="op" id="1905076">&gt;</span>&nbsp;<span class="num" id="1905078">0</span>&nbsp;<span class="op" id="1905080">&amp;&amp;</span>&nbsp;<span class="ident" id="1905083">r</span>&nbsp;<span class="op" id="1905085">&gt;=</span>&nbsp;<span class="builtintype" id="1905088">rune</span><span class="op" id="1905092">(</span><span class="ident" id="1905093">r32</span><span class="op" id="1905096">[</span><span class="num" id="1905097">0</span><span class="op" id="1905098">]</span><span class="op" id="1905099">.</span><span class="ident" id="1905100">Lo</span><span class="op" id="1905102">)</span>&nbsp;<span class="op" id="1905104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1905108">return</span>&nbsp;<span class="ident" id="1905115">is32</span><span class="op" id="1905119">(</span><span class="ident" id="1905120">r32</span><span class="op" id="1905123">,</span>&nbsp;<span class="builtintype" id="1905125">uint32</span><span class="op" id="1905131">(</span><span class="ident" id="1905132">r</span><span class="op" id="1905133">)</span><span class="op" id="1905134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1905137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1905140">return</span>&nbsp;<span class="builtintype" id="1905147">false</span><br>
<span class="lineno">180</span><span class="op" id="1905153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1905156">//&nbsp;IsUpper&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;an&nbsp;upper&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="1905217">func</span>&nbsp;<span class="ident" id="1905222">IsUpper</span><span class="op" id="1905229">(</span><span class="ident" id="1905230">r</span>&nbsp;<span class="builtintype" id="1905232">rune</span><span class="op" id="1905236">)</span>&nbsp;<span class="builtintype" id="1905238">bool</span>&nbsp;<span class="op" id="1905243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1905246">//&nbsp;See&nbsp;comment&nbsp;in&nbsp;IsGraphic.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1905276">if</span>&nbsp;<span class="builtintype" id="1905279">uint32</span><span class="op" id="1905285">(</span><span class="ident" id="1905286">r</span><span class="op" id="1905287">)</span>&nbsp;<span class="op" id="1905289">&lt;=</span>&nbsp;<span class="ident" id="1905292">MaxLatin1</span>&nbsp;<span class="op" id="1905302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1905306">return</span>&nbsp;<span class="ident" id="1905313">properties</span><span class="op" id="1905323">[</span><span class="builtintype" id="1905324">uint8</span><span class="op" id="1905329">(</span><span class="ident" id="1905330">r</span><span class="op" id="1905331">)</span><span class="op" id="1905332">]</span><span class="op" id="1905333">&amp;</span><span class="ident" id="1905334">pLmask</span>&nbsp;<span class="op" id="1905341">==</span>&nbsp;<span class="ident" id="1905344">pLu</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1905349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1905352">return</span>&nbsp;<span class="ident" id="1905359">isExcludingLatin</span><span class="op" id="1905375">(</span><span class="ident" id="1905376">Upper</span><span class="op" id="1905381">,</span>&nbsp;<span class="ident" id="1905383">r</span><span class="op" id="1905384">)</span><br>
<span class="lineno"></span><span class="op" id="1905386">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="1905389">//&nbsp;IsLower&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;a&nbsp;lower&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="1905449">func</span>&nbsp;<span class="ident" id="1905454">IsLower</span><span class="op" id="1905461">(</span><span class="ident" id="1905462">r</span>&nbsp;<span class="builtintype" id="1905464">rune</span><span class="op" id="1905468">)</span>&nbsp;<span class="builtintype" id="1905470">bool</span>&nbsp;<span class="op" id="1905475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1905478">//&nbsp;See&nbsp;comment&nbsp;in&nbsp;IsGraphic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1905508">if</span>&nbsp;<span class="builtintype" id="1905511">uint32</span><span class="op" id="1905517">(</span><span class="ident" id="1905518">r</span><span class="op" id="1905519">)</span>&nbsp;<span class="op" id="1905521">&lt;=</span>&nbsp;<span class="ident" id="1905524">MaxLatin1</span>&nbsp;<span class="op" id="1905534">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1905538">return</span>&nbsp;<span class="ident" id="1905545">properties</span><span class="op" id="1905555">[</span><span class="builtintype" id="1905556">uint8</span><span class="op" id="1905561">(</span><span class="ident" id="1905562">r</span><span class="op" id="1905563">)</span><span class="op" id="1905564">]</span><span class="op" id="1905565">&amp;</span><span class="ident" id="1905566">pLmask</span>&nbsp;<span class="op" id="1905573">==</span>&nbsp;<span class="ident" id="1905576">pLl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1905581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1905584">return</span>&nbsp;<span class="ident" id="1905591">isExcludingLatin</span><span class="op" id="1905607">(</span><span class="ident" id="1905608">Lower</span><span class="op" id="1905613">,</span>&nbsp;<span class="ident" id="1905615">r</span><span class="op" id="1905616">)</span><br>
<span class="lineno"></span><span class="op" id="1905618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="comment" id="1905621">//&nbsp;IsTitle&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;a&nbsp;title&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="1905681">func</span>&nbsp;<span class="ident" id="1905686">IsTitle</span><span class="op" id="1905693">(</span><span class="ident" id="1905694">r</span>&nbsp;<span class="builtintype" id="1905696">rune</span><span class="op" id="1905700">)</span>&nbsp;<span class="builtintype" id="1905702">bool</span>&nbsp;<span class="op" id="1905707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1905710">if</span>&nbsp;<span class="ident" id="1905713">r</span>&nbsp;<span class="op" id="1905715">&lt;=</span>&nbsp;<span class="ident" id="1905718">MaxLatin1</span>&nbsp;<span class="op" id="1905728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1905732">return</span>&nbsp;<span class="builtintype" id="1905739">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1905746">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1905749">return</span>&nbsp;<span class="ident" id="1905756">isExcludingLatin</span><span class="op" id="1905772">(</span><span class="ident" id="1905773">Title</span><span class="op" id="1905778">,</span>&nbsp;<span class="ident" id="1905780">r</span><span class="op" id="1905781">)</span><br>
<span class="lineno"></span><span class="op" id="1905783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1905786">//&nbsp;to&nbsp;maps&nbsp;the&nbsp;rune&nbsp;using&nbsp;the&nbsp;specified&nbsp;case&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1905840">func</span>&nbsp;<span class="ident" id="1905845">to</span><span class="op" id="1905847">(</span><span class="ident" id="1905848">_case</span>&nbsp;<span class="builtintype" id="1905854">int</span><span class="op" id="1905857">,</span>&nbsp;<span class="ident" id="1905859">r</span>&nbsp;<span class="builtintype" id="1905861">rune</span><span class="op" id="1905865">,</span>&nbsp;<span class="ident" id="1905867">caseRange</span>&nbsp;<span class="op" id="1905877">[</span><span class="op" id="1905878">]</span><span class="ident" id="1905879">CaseRange</span><span class="op" id="1905888">)</span>&nbsp;<span class="builtintype" id="1905890">rune</span>&nbsp;<span class="op" id="1905895">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1905898">if</span>&nbsp;<span class="ident" id="1905901">_case</span>&nbsp;<span class="op" id="1905907">&lt;</span>&nbsp;<span class="num" id="1905909">0</span>&nbsp;<span class="op" id="1905911">||</span>&nbsp;<span class="ident" id="1905914">MaxCase</span>&nbsp;<span class="op" id="1905922">&lt;=</span>&nbsp;<span class="ident" id="1905925">_case</span>&nbsp;<span class="op" id="1905931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1905935">return</span>&nbsp;<span class="ident" id="1905942">ReplacementChar</span>&nbsp;<span class="comment" id="1905958">//&nbsp;as&nbsp;reasonable&nbsp;an&nbsp;error&nbsp;as&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1905992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1905995">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1906025">lo</span>&nbsp;<span class="op" id="1906028">:=</span>&nbsp;<span class="num" id="1906031">0</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1906034">hi</span>&nbsp;<span class="op" id="1906037">:=</span>&nbsp;<span class="builtinfunc" id="1906040">len</span><span class="op" id="1906043">(</span><span class="ident" id="1906044">caseRange</span><span class="op" id="1906053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1906056">for</span>&nbsp;<span class="ident" id="1906060">lo</span>&nbsp;<span class="op" id="1906063">&lt;</span>&nbsp;<span class="ident" id="1906065">hi</span>&nbsp;<span class="op" id="1906068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1906072">m</span>&nbsp;<span class="op" id="1906074">:=</span>&nbsp;<span class="ident" id="1906077">lo</span>&nbsp;<span class="op" id="1906080">+</span>&nbsp;<span class="op" id="1906082">(</span><span class="ident" id="1906083">hi</span><span class="op" id="1906085">-</span><span class="ident" id="1906086">lo</span><span class="op" id="1906088">)</span><span class="op" id="1906089">/</span><span class="num" id="1906090">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1906094">cr</span>&nbsp;<span class="op" id="1906097">:=</span>&nbsp;<span class="ident" id="1906100">caseRange</span><span class="op" id="1906109">[</span><span class="ident" id="1906110">m</span><span class="op" id="1906111">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1906115">if</span>&nbsp;<span class="builtintype" id="1906118">rune</span><span class="op" id="1906122">(</span><span class="ident" id="1906123">cr</span><span class="op" id="1906125">.</span><span class="ident" id="1906126">Lo</span><span class="op" id="1906128">)</span>&nbsp;<span class="op" id="1906130">&lt;=</span>&nbsp;<span class="ident" id="1906133">r</span>&nbsp;<span class="op" id="1906135">&amp;&amp;</span>&nbsp;<span class="ident" id="1906138">r</span>&nbsp;<span class="op" id="1906140">&lt;=</span>&nbsp;<span class="builtintype" id="1906143">rune</span><span class="op" id="1906147">(</span><span class="ident" id="1906148">cr</span><span class="op" id="1906150">.</span><span class="ident" id="1906151">Hi</span><span class="op" id="1906153">)</span>&nbsp;<span class="op" id="1906155">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1906160">delta</span>&nbsp;<span class="op" id="1906166">:=</span>&nbsp;<span class="builtintype" id="1906169">rune</span><span class="op" id="1906173">(</span><span class="ident" id="1906174">cr</span><span class="op" id="1906176">.</span><span class="ident" id="1906177">Delta</span><span class="op" id="1906182">[</span><span class="ident" id="1906183">_case</span><span class="op" id="1906188">]</span><span class="op" id="1906189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1906194">if</span>&nbsp;<span class="ident" id="1906197">delta</span>&nbsp;<span class="op" id="1906203">&gt;</span>&nbsp;<span class="ident" id="1906205">MaxRune</span>&nbsp;<span class="op" id="1906213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1906219">//&nbsp;In&nbsp;an&nbsp;Upper-Lower&nbsp;sequence,&nbsp;which&nbsp;always&nbsp;starts&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1906279">//&nbsp;an&nbsp;UpperCase&nbsp;letter,&nbsp;the&nbsp;real&nbsp;deltas&nbsp;always&nbsp;look&nbsp;like:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1906341">//&nbsp;&nbsp;&nbsp;&nbsp;{0,&nbsp;1,&nbsp;0}&nbsp;&nbsp;&nbsp;&nbsp;UpperCase&nbsp;(Lower&nbsp;is&nbsp;next)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1906387">//&nbsp;&nbsp;&nbsp;&nbsp;{-1,&nbsp;0,&nbsp;-1}&nbsp;&nbsp;LowerCase&nbsp;(Upper,&nbsp;Title&nbsp;are&nbsp;previous)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1906445">//&nbsp;The&nbsp;characters&nbsp;at&nbsp;even&nbsp;offsets&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1906509">//&nbsp;sequence&nbsp;are&nbsp;upper&nbsp;case;&nbsp;the&nbsp;ones&nbsp;at&nbsp;odd&nbsp;offsets&nbsp;are&nbsp;lower.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1906576">//&nbsp;The&nbsp;correct&nbsp;mapping&nbsp;can&nbsp;be&nbsp;done&nbsp;by&nbsp;clearing&nbsp;or&nbsp;setting&nbsp;the&nbsp;low</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1906646">//&nbsp;bit&nbsp;in&nbsp;the&nbsp;sequence&nbsp;offset.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1906681">//&nbsp;The&nbsp;constants&nbsp;UpperCase&nbsp;and&nbsp;TitleCase&nbsp;are&nbsp;even&nbsp;while&nbsp;LowerCase</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1906751">//&nbsp;is&nbsp;odd&nbsp;so&nbsp;we&nbsp;take&nbsp;the&nbsp;low&nbsp;bit&nbsp;from&nbsp;_case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1906800">return</span>&nbsp;<span class="builtintype" id="1906807">rune</span><span class="op" id="1906811">(</span><span class="ident" id="1906812">cr</span><span class="op" id="1906814">.</span><span class="ident" id="1906815">Lo</span><span class="op" id="1906817">)</span>&nbsp;<span class="op" id="1906819">+</span>&nbsp;<span class="op" id="1906821">(</span><span class="op" id="1906822">(</span><span class="ident" id="1906823">r</span><span class="op" id="1906824">-</span><span class="builtintype" id="1906825">rune</span><span class="op" id="1906829">(</span><span class="ident" id="1906830">cr</span><span class="op" id="1906832">.</span><span class="ident" id="1906833">Lo</span><span class="op" id="1906835">)</span><span class="op" id="1906836">)</span><span class="op" id="1906837">&amp;^</span><span class="num" id="1906839">1</span>&nbsp;<span class="op" id="1906841">|</span>&nbsp;<span class="builtintype" id="1906843">rune</span><span class="op" id="1906847">(</span><span class="ident" id="1906848">_case</span><span class="op" id="1906853">&amp;</span><span class="num" id="1906854">1</span><span class="op" id="1906855">)</span><span class="op" id="1906856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1906861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1906866">return</span>&nbsp;<span class="ident" id="1906873">r</span>&nbsp;<span class="op" id="1906875">+</span>&nbsp;<span class="ident" id="1906877">delta</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1906885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1906889">if</span>&nbsp;<span class="ident" id="1906892">r</span>&nbsp;<span class="op" id="1906894">&lt;</span>&nbsp;<span class="builtintype" id="1906896">rune</span><span class="op" id="1906900">(</span><span class="ident" id="1906901">cr</span><span class="op" id="1906903">.</span><span class="ident" id="1906904">Lo</span><span class="op" id="1906906">)</span>&nbsp;<span class="op" id="1906908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1906913">hi</span>&nbsp;<span class="op" id="1906916">=</span>&nbsp;<span class="ident" id="1906918">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1906922">}</span>&nbsp;<span class="keyword" id="1906924">else</span>&nbsp;<span class="op" id="1906929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1906934">lo</span>&nbsp;<span class="op" id="1906937">=</span>&nbsp;<span class="ident" id="1906939">m</span>&nbsp;<span class="op" id="1906941">+</span>&nbsp;<span class="num" id="1906943">1</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1906947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1906950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1906953">return</span>&nbsp;<span class="ident" id="1906960">r</span><br>
<span class="lineno"></span><span class="op" id="1906962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="1906965">//&nbsp;To&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;the&nbsp;specified&nbsp;case:&nbsp;UpperCase,&nbsp;LowerCase,&nbsp;or&nbsp;TitleCase.</span><br>
<span class="lineno"></span><span class="keyword" id="1907044">func</span>&nbsp;<span class="ident" id="1907049">To</span><span class="op" id="1907051">(</span><span class="ident" id="1907052">_case</span>&nbsp;<span class="builtintype" id="1907058">int</span><span class="op" id="1907061">,</span>&nbsp;<span class="ident" id="1907063">r</span>&nbsp;<span class="builtintype" id="1907065">rune</span><span class="op" id="1907069">)</span>&nbsp;<span class="builtintype" id="1907071">rune</span>&nbsp;<span class="op" id="1907076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1907079">return</span>&nbsp;<span class="ident" id="1907086">to</span><span class="op" id="1907088">(</span><span class="ident" id="1907089">_case</span><span class="op" id="1907094">,</span>&nbsp;<span class="ident" id="1907096">r</span><span class="op" id="1907097">,</span>&nbsp;<span class="ident" id="1907099">CaseRanges</span><span class="op" id="1907109">)</span><br>
<span class="lineno"></span><span class="op" id="1907111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="1907114">//&nbsp;ToUpper&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;upper&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1907154">func</span>&nbsp;<span class="ident" id="1907159">ToUpper</span><span class="op" id="1907166">(</span><span class="ident" id="1907167">r</span>&nbsp;<span class="builtintype" id="1907169">rune</span><span class="op" id="1907173">)</span>&nbsp;<span class="builtintype" id="1907175">rune</span>&nbsp;<span class="op" id="1907180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1907183">if</span>&nbsp;<span class="ident" id="1907186">r</span>&nbsp;<span class="op" id="1907188">&lt;=</span>&nbsp;<span class="ident" id="1907191">MaxASCII</span>&nbsp;<span class="op" id="1907200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1907204">if</span>&nbsp;<span class="string" id="1907207">&#39;a&#39;</span>&nbsp;<span class="op" id="1907211">&lt;=</span>&nbsp;<span class="ident" id="1907214">r</span>&nbsp;<span class="op" id="1907216">&amp;&amp;</span>&nbsp;<span class="ident" id="1907219">r</span>&nbsp;<span class="op" id="1907221">&lt;=</span>&nbsp;<span class="string" id="1907224">&#39;z&#39;</span>&nbsp;<span class="op" id="1907228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1907233">r</span>&nbsp;<span class="op" id="1907235">-=</span>&nbsp;<span class="string" id="1907238">&#39;a&#39;</span>&nbsp;<span class="op" id="1907242">-</span>&nbsp;<span class="string" id="1907244">&#39;A&#39;</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1907250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1907254">return</span>&nbsp;<span class="ident" id="1907261">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1907264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1907267">return</span>&nbsp;<span class="ident" id="1907274">To</span><span class="op" id="1907276">(</span><span class="ident" id="1907277">UpperCase</span><span class="op" id="1907286">,</span>&nbsp;<span class="ident" id="1907288">r</span><span class="op" id="1907289">)</span><br>
<span class="lineno"></span><span class="op" id="1907291">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="comment" id="1907294">//&nbsp;ToLower&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1907334">func</span>&nbsp;<span class="ident" id="1907339">ToLower</span><span class="op" id="1907346">(</span><span class="ident" id="1907347">r</span>&nbsp;<span class="builtintype" id="1907349">rune</span><span class="op" id="1907353">)</span>&nbsp;<span class="builtintype" id="1907355">rune</span>&nbsp;<span class="op" id="1907360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1907363">if</span>&nbsp;<span class="ident" id="1907366">r</span>&nbsp;<span class="op" id="1907368">&lt;=</span>&nbsp;<span class="ident" id="1907371">MaxASCII</span>&nbsp;<span class="op" id="1907380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1907384">if</span>&nbsp;<span class="string" id="1907387">&#39;A&#39;</span>&nbsp;<span class="op" id="1907391">&lt;=</span>&nbsp;<span class="ident" id="1907394">r</span>&nbsp;<span class="op" id="1907396">&amp;&amp;</span>&nbsp;<span class="ident" id="1907399">r</span>&nbsp;<span class="op" id="1907401">&lt;=</span>&nbsp;<span class="string" id="1907404">&#39;Z&#39;</span>&nbsp;<span class="op" id="1907408">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1907413">r</span>&nbsp;<span class="op" id="1907415">+=</span>&nbsp;<span class="string" id="1907418">&#39;a&#39;</span>&nbsp;<span class="op" id="1907422">-</span>&nbsp;<span class="string" id="1907424">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1907430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1907434">return</span>&nbsp;<span class="ident" id="1907441">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1907444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1907447">return</span>&nbsp;<span class="ident" id="1907454">To</span><span class="op" id="1907456">(</span><span class="ident" id="1907457">LowerCase</span><span class="op" id="1907466">,</span>&nbsp;<span class="ident" id="1907468">r</span><span class="op" id="1907469">)</span><br>
<span class="lineno">270</span><span class="op" id="1907471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1907474">//&nbsp;ToTitle&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1907514">func</span>&nbsp;<span class="ident" id="1907519">ToTitle</span><span class="op" id="1907526">(</span><span class="ident" id="1907527">r</span>&nbsp;<span class="builtintype" id="1907529">rune</span><span class="op" id="1907533">)</span>&nbsp;<span class="builtintype" id="1907535">rune</span>&nbsp;<span class="op" id="1907540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1907543">if</span>&nbsp;<span class="ident" id="1907546">r</span>&nbsp;<span class="op" id="1907548">&lt;=</span>&nbsp;<span class="ident" id="1907551">MaxASCII</span>&nbsp;<span class="op" id="1907560">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1907564">if</span>&nbsp;<span class="string" id="1907567">&#39;a&#39;</span>&nbsp;<span class="op" id="1907571">&lt;=</span>&nbsp;<span class="ident" id="1907574">r</span>&nbsp;<span class="op" id="1907576">&amp;&amp;</span>&nbsp;<span class="ident" id="1907579">r</span>&nbsp;<span class="op" id="1907581">&lt;=</span>&nbsp;<span class="string" id="1907584">&#39;z&#39;</span>&nbsp;<span class="op" id="1907588">{</span>&nbsp;<span class="comment" id="1907590">//&nbsp;title&nbsp;case&nbsp;is&nbsp;upper&nbsp;case&nbsp;for&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1907631">r</span>&nbsp;<span class="op" id="1907633">-=</span>&nbsp;<span class="string" id="1907636">&#39;a&#39;</span>&nbsp;<span class="op" id="1907640">-</span>&nbsp;<span class="string" id="1907642">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1907648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1907652">return</span>&nbsp;<span class="ident" id="1907659">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1907662">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1907665">return</span>&nbsp;<span class="ident" id="1907672">To</span><span class="op" id="1907674">(</span><span class="ident" id="1907675">TitleCase</span><span class="op" id="1907684">,</span>&nbsp;<span class="ident" id="1907686">r</span><span class="op" id="1907687">)</span><br>
<span class="lineno"></span><span class="op" id="1907689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1907692">//&nbsp;ToUpper&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;upper&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1907771">func</span>&nbsp;<span class="op" id="1907776">(</span><span class="ident" id="1907777">special</span>&nbsp;<span class="ident" id="1907785">SpecialCase</span><span class="op" id="1907796">)</span>&nbsp;<span class="ident" id="1907798">ToUpper</span><span class="op" id="1907805">(</span><span class="ident" id="1907806">r</span>&nbsp;<span class="builtintype" id="1907808">rune</span><span class="op" id="1907812">)</span>&nbsp;<span class="builtintype" id="1907814">rune</span>&nbsp;<span class="op" id="1907819">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1907822">r1</span>&nbsp;<span class="op" id="1907825">:=</span>&nbsp;<span class="ident" id="1907828">to</span><span class="op" id="1907830">(</span><span class="ident" id="1907831">UpperCase</span><span class="op" id="1907840">,</span>&nbsp;<span class="ident" id="1907842">r</span><span class="op" id="1907843">,</span>&nbsp;<span class="op" id="1907845">[</span><span class="op" id="1907846">]</span><span class="ident" id="1907847">CaseRange</span><span class="op" id="1907856">(</span><span class="ident" id="1907857">special</span><span class="op" id="1907864">)</span><span class="op" id="1907865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1907868">if</span>&nbsp;<span class="ident" id="1907871">r1</span>&nbsp;<span class="op" id="1907874">==</span>&nbsp;<span class="ident" id="1907877">r</span>&nbsp;<span class="op" id="1907879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1907883">r1</span>&nbsp;<span class="op" id="1907886">=</span>&nbsp;<span class="ident" id="1907888">ToUpper</span><span class="op" id="1907895">(</span><span class="ident" id="1907896">r</span><span class="op" id="1907897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1907900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1907903">return</span>&nbsp;<span class="ident" id="1907910">r1</span><br>
<span class="lineno">290</span><span class="op" id="1907913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1907916">//&nbsp;ToTitle&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;title&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1907995">func</span>&nbsp;<span class="op" id="1908000">(</span><span class="ident" id="1908001">special</span>&nbsp;<span class="ident" id="1908009">SpecialCase</span><span class="op" id="1908020">)</span>&nbsp;<span class="ident" id="1908022">ToTitle</span><span class="op" id="1908029">(</span><span class="ident" id="1908030">r</span>&nbsp;<span class="builtintype" id="1908032">rune</span><span class="op" id="1908036">)</span>&nbsp;<span class="builtintype" id="1908038">rune</span>&nbsp;<span class="op" id="1908043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1908046">r1</span>&nbsp;<span class="op" id="1908049">:=</span>&nbsp;<span class="ident" id="1908052">to</span><span class="op" id="1908054">(</span><span class="ident" id="1908055">TitleCase</span><span class="op" id="1908064">,</span>&nbsp;<span class="ident" id="1908066">r</span><span class="op" id="1908067">,</span>&nbsp;<span class="op" id="1908069">[</span><span class="op" id="1908070">]</span><span class="ident" id="1908071">CaseRange</span><span class="op" id="1908080">(</span><span class="ident" id="1908081">special</span><span class="op" id="1908088">)</span><span class="op" id="1908089">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1908092">if</span>&nbsp;<span class="ident" id="1908095">r1</span>&nbsp;<span class="op" id="1908098">==</span>&nbsp;<span class="ident" id="1908101">r</span>&nbsp;<span class="op" id="1908103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1908107">r1</span>&nbsp;<span class="op" id="1908110">=</span>&nbsp;<span class="ident" id="1908112">ToTitle</span><span class="op" id="1908119">(</span><span class="ident" id="1908120">r</span><span class="op" id="1908121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1908124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1908127">return</span>&nbsp;<span class="ident" id="1908134">r1</span><br>
<span class="lineno"></span><span class="op" id="1908137">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="1908140">//&nbsp;ToLower&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;lower&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1908219">func</span>&nbsp;<span class="op" id="1908224">(</span><span class="ident" id="1908225">special</span>&nbsp;<span class="ident" id="1908233">SpecialCase</span><span class="op" id="1908244">)</span>&nbsp;<span class="ident" id="1908246">ToLower</span><span class="op" id="1908253">(</span><span class="ident" id="1908254">r</span>&nbsp;<span class="builtintype" id="1908256">rune</span><span class="op" id="1908260">)</span>&nbsp;<span class="builtintype" id="1908262">rune</span>&nbsp;<span class="op" id="1908267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1908270">r1</span>&nbsp;<span class="op" id="1908273">:=</span>&nbsp;<span class="ident" id="1908276">to</span><span class="op" id="1908278">(</span><span class="ident" id="1908279">LowerCase</span><span class="op" id="1908288">,</span>&nbsp;<span class="ident" id="1908290">r</span><span class="op" id="1908291">,</span>&nbsp;<span class="op" id="1908293">[</span><span class="op" id="1908294">]</span><span class="ident" id="1908295">CaseRange</span><span class="op" id="1908304">(</span><span class="ident" id="1908305">special</span><span class="op" id="1908312">)</span><span class="op" id="1908313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1908316">if</span>&nbsp;<span class="ident" id="1908319">r1</span>&nbsp;<span class="op" id="1908322">==</span>&nbsp;<span class="ident" id="1908325">r</span>&nbsp;<span class="op" id="1908327">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1908331">r1</span>&nbsp;<span class="op" id="1908334">=</span>&nbsp;<span class="ident" id="1908336">ToLower</span><span class="op" id="1908343">(</span><span class="ident" id="1908344">r</span><span class="op" id="1908345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1908348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1908351">return</span>&nbsp;<span class="ident" id="1908358">r1</span><br>
<span class="lineno"></span><span class="op" id="1908361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="1908364">//&nbsp;caseOrbit&nbsp;is&nbsp;defined&nbsp;in&nbsp;tables.go&nbsp;as&nbsp;[]foldPair.&nbsp;&nbsp;Right&nbsp;now&nbsp;all&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1908435">//&nbsp;entries&nbsp;fit&nbsp;in&nbsp;uint16,&nbsp;so&nbsp;use&nbsp;uint16.&nbsp;&nbsp;If&nbsp;that&nbsp;changes,&nbsp;compilation</span><br>
<span class="lineno"></span><span class="comment" id="1908506">//&nbsp;will&nbsp;fail&nbsp;(the&nbsp;constants&nbsp;in&nbsp;the&nbsp;composite&nbsp;literal&nbsp;will&nbsp;not&nbsp;fit&nbsp;in&nbsp;uint16)</span><br>
<span class="lineno"></span><span class="comment" id="1908583">//&nbsp;and&nbsp;the&nbsp;types&nbsp;here&nbsp;can&nbsp;change&nbsp;to&nbsp;uint32.</span><br>
<span class="lineno"></span><span class="keyword" id="1908627">type</span>&nbsp;<span class="ident" id="1908632">foldPair</span>&nbsp;<span class="keyword" id="1908641">struct</span>&nbsp;<span class="op" id="1908648">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1908651">From</span>&nbsp;<span class="builtintype" id="1908656">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1908664">To</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1908669">uint16</span><br>
<span class="lineno"></span><span class="op" id="1908676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1908679">//&nbsp;SimpleFold&nbsp;iterates&nbsp;over&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;equivalent&nbsp;under</span><br>
<span class="lineno">320</span><span class="comment" id="1908744">//&nbsp;the&nbsp;Unicode-defined&nbsp;simple&nbsp;case&nbsp;folding.&nbsp;&nbsp;Among&nbsp;the&nbsp;code&nbsp;points</span><br>
<span class="lineno"></span><span class="comment" id="1908811">//&nbsp;equivalent&nbsp;to&nbsp;rune&nbsp;(including&nbsp;rune&nbsp;itself),&nbsp;SimpleFold&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1908881">//&nbsp;smallest&nbsp;rune&nbsp;&gt;&nbsp;r&nbsp;if&nbsp;one&nbsp;exists,&nbsp;or&nbsp;else&nbsp;the&nbsp;smallest&nbsp;rune&nbsp;&gt;=&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="1908949">//</span><br>
<span class="lineno"></span><span class="comment" id="1908952">//&nbsp;For&nbsp;example:</span><br>
<span class="lineno">325</span><span class="comment" id="1908968">//&nbsp;&nbsp;&nbsp;&nbsp;SimpleFold(&#39;A&#39;)&nbsp;=&nbsp;&#39;a&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1908993">//&nbsp;&nbsp;&nbsp;&nbsp;SimpleFold(&#39;a&#39;)&nbsp;=&nbsp;&#39;A&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1909018">//</span><br>
<span class="lineno"></span><span class="comment" id="1909021">//&nbsp;&nbsp;&nbsp;&nbsp;SimpleFold(&#39;K&#39;)&nbsp;=&nbsp;&#39;k&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1909046">//&nbsp;&nbsp;&nbsp;&nbsp;SimpleFold(&#39;k&#39;)&nbsp;=&nbsp;&#39;\u212A&#39;&nbsp;(Kelvin&nbsp;symbol,&nbsp;K)</span><br>
<span class="lineno">330</span><span class="comment" id="1909097">//&nbsp;&nbsp;&nbsp;&nbsp;SimpleFold(&#39;\u212A&#39;)&nbsp;=&nbsp;&#39;K&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1909127">//</span><br>
<span class="lineno"></span><span class="comment" id="1909130">//&nbsp;&nbsp;&nbsp;&nbsp;SimpleFold(&#39;1&#39;)&nbsp;=&nbsp;&#39;1&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1909155">//</span><br>
<span class="lineno"></span><span class="keyword" id="1909158">func</span>&nbsp;<span class="ident" id="1909163">SimpleFold</span><span class="op" id="1909173">(</span><span class="ident" id="1909174">r</span>&nbsp;<span class="builtintype" id="1909176">rune</span><span class="op" id="1909180">)</span>&nbsp;<span class="builtintype" id="1909182">rune</span>&nbsp;<span class="op" id="1909187">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1909190">//&nbsp;Consult&nbsp;caseOrbit&nbsp;table&nbsp;for&nbsp;special&nbsp;cases.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1909237">lo</span>&nbsp;<span class="op" id="1909240">:=</span>&nbsp;<span class="num" id="1909243">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1909246">hi</span>&nbsp;<span class="op" id="1909249">:=</span>&nbsp;<span class="builtinfunc" id="1909252">len</span><span class="op" id="1909255">(</span><span class="ident" id="1909256">caseOrbit</span><span class="op" id="1909265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1909268">for</span>&nbsp;<span class="ident" id="1909272">lo</span>&nbsp;<span class="op" id="1909275">&lt;</span>&nbsp;<span class="ident" id="1909277">hi</span>&nbsp;<span class="op" id="1909280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1909284">m</span>&nbsp;<span class="op" id="1909286">:=</span>&nbsp;<span class="ident" id="1909289">lo</span>&nbsp;<span class="op" id="1909292">+</span>&nbsp;<span class="op" id="1909294">(</span><span class="ident" id="1909295">hi</span><span class="op" id="1909297">-</span><span class="ident" id="1909298">lo</span><span class="op" id="1909300">)</span><span class="op" id="1909301">/</span><span class="num" id="1909302">2</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1909306">if</span>&nbsp;<span class="builtintype" id="1909309">rune</span><span class="op" id="1909313">(</span><span class="ident" id="1909314">caseOrbit</span><span class="op" id="1909323">[</span><span class="ident" id="1909324">m</span><span class="op" id="1909325">]</span><span class="op" id="1909326">.</span><span class="ident" id="1909327">From</span><span class="op" id="1909331">)</span>&nbsp;<span class="op" id="1909333">&lt;</span>&nbsp;<span class="ident" id="1909335">r</span>&nbsp;<span class="op" id="1909337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1909342">lo</span>&nbsp;<span class="op" id="1909345">=</span>&nbsp;<span class="ident" id="1909347">m</span>&nbsp;<span class="op" id="1909349">+</span>&nbsp;<span class="num" id="1909351">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1909355">}</span>&nbsp;<span class="keyword" id="1909357">else</span>&nbsp;<span class="op" id="1909362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1909367">hi</span>&nbsp;<span class="op" id="1909370">=</span>&nbsp;<span class="ident" id="1909372">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1909376">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1909379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1909382">if</span>&nbsp;<span class="ident" id="1909385">lo</span>&nbsp;<span class="op" id="1909388">&lt;</span>&nbsp;<span class="builtinfunc" id="1909390">len</span><span class="op" id="1909393">(</span><span class="ident" id="1909394">caseOrbit</span><span class="op" id="1909403">)</span>&nbsp;<span class="op" id="1909405">&amp;&amp;</span>&nbsp;<span class="builtintype" id="1909408">rune</span><span class="op" id="1909412">(</span><span class="ident" id="1909413">caseOrbit</span><span class="op" id="1909422">[</span><span class="ident" id="1909423">lo</span><span class="op" id="1909425">]</span><span class="op" id="1909426">.</span><span class="ident" id="1909427">From</span><span class="op" id="1909431">)</span>&nbsp;<span class="op" id="1909433">==</span>&nbsp;<span class="ident" id="1909436">r</span>&nbsp;<span class="op" id="1909438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1909442">return</span>&nbsp;<span class="builtintype" id="1909449">rune</span><span class="op" id="1909453">(</span><span class="ident" id="1909454">caseOrbit</span><span class="op" id="1909463">[</span><span class="ident" id="1909464">lo</span><span class="op" id="1909466">]</span><span class="op" id="1909467">.</span><span class="ident" id="1909468">To</span><span class="op" id="1909470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1909473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1909477">//&nbsp;No&nbsp;folding&nbsp;specified.&nbsp;&nbsp;This&nbsp;is&nbsp;a&nbsp;one-&nbsp;or&nbsp;two-element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1909534">//&nbsp;equivalence&nbsp;class&nbsp;containing&nbsp;rune&nbsp;and&nbsp;ToLower(rune)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1909590">//&nbsp;and&nbsp;ToUpper(rune)&nbsp;if&nbsp;they&nbsp;are&nbsp;different&nbsp;from&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1909645">if</span>&nbsp;<span class="ident" id="1909648">l</span>&nbsp;<span class="op" id="1909650">:=</span>&nbsp;<span class="ident" id="1909653">ToLower</span><span class="op" id="1909660">(</span><span class="ident" id="1909661">r</span><span class="op" id="1909662">)</span><span class="op" id="1909663">;</span>&nbsp;<span class="ident" id="1909665">l</span>&nbsp;<span class="op" id="1909667">!=</span>&nbsp;<span class="ident" id="1909670">r</span>&nbsp;<span class="op" id="1909672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1909676">return</span>&nbsp;<span class="ident" id="1909683">l</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1909686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1909689">return</span>&nbsp;<span class="ident" id="1909696">ToUpper</span><span class="op" id="1909703">(</span><span class="ident" id="1909704">r</span><span class="op" id="1909705">)</span><br>
<span class="lineno"></span><span class="op" id="1909707">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
