<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/build</h2>
<ul>
<li><a href="/gostd/go/build/build.go.html">build.go</a></li>
<li><a href="/gostd/go/build/build_test.go.html">build_test.go</a></li>
<li><a href="/gostd/go/build/deps_test.go.html">deps_test.go</a></li>
<li><a href="/gostd/go/build/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/build/read.go.html">read.go</a></li>
<li><a href="/gostd/go/build/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/go/build/syslist.go.html">syslist.go</a></li>
<li><a href="/gostd/go/build/syslist_test.go.html">syslist_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6282359">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6282415">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6282469">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6282520">package</span>&nbsp;<span class="ident" id="6282528">build</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6282535">import</span>&nbsp;<span class="op" id="6282542">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6282545">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6282554">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6282564">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="6282569">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6282572">type</span>&nbsp;<span class="ident" id="6282577">importReader</span>&nbsp;<span class="keyword" id="6282590">struct</span>&nbsp;<span class="op" id="6282597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6282600">b</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6282605">*</span><span class="ident" id="6282606">bufio</span><span class="op" id="6282611">.</span><span class="ident" id="6282612">Reader</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6282620">buf</span>&nbsp;&nbsp;<span class="op" id="6282625">[</span><span class="op" id="6282626">]</span><span class="builtintype" id="6282627">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6282633">peek</span>&nbsp;<span class="builtintype" id="6282638">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6282644">err</span>&nbsp;&nbsp;<span class="builtintype" id="6282649">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6282656">eof</span>&nbsp;&nbsp;<span class="builtintype" id="6282661">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6282667">nerr</span>&nbsp;<span class="builtintype" id="6282672">int</span><br>
<span class="lineno">20</span><span class="op" id="6282676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6282679">func</span>&nbsp;<span class="ident" id="6282684">isIdent</span><span class="op" id="6282691">(</span><span class="ident" id="6282692">c</span>&nbsp;<span class="builtintype" id="6282694">byte</span><span class="op" id="6282698">)</span>&nbsp;<span class="builtintype" id="6282700">bool</span>&nbsp;<span class="op" id="6282705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6282708">return</span>&nbsp;<span class="string" id="6282715">&#39;A&#39;</span>&nbsp;<span class="op" id="6282719">&lt;=</span>&nbsp;<span class="ident" id="6282722">c</span>&nbsp;<span class="op" id="6282724">&amp;&amp;</span>&nbsp;<span class="ident" id="6282727">c</span>&nbsp;<span class="op" id="6282729">&lt;=</span>&nbsp;<span class="string" id="6282732">&#39;Z&#39;</span>&nbsp;<span class="op" id="6282736">||</span>&nbsp;<span class="string" id="6282739">&#39;a&#39;</span>&nbsp;<span class="op" id="6282743">&lt;=</span>&nbsp;<span class="ident" id="6282746">c</span>&nbsp;<span class="op" id="6282748">&amp;&amp;</span>&nbsp;<span class="ident" id="6282751">c</span>&nbsp;<span class="op" id="6282753">&lt;=</span>&nbsp;<span class="string" id="6282756">&#39;z&#39;</span>&nbsp;<span class="op" id="6282760">||</span>&nbsp;<span class="string" id="6282763">&#39;0&#39;</span>&nbsp;<span class="op" id="6282767">&lt;=</span>&nbsp;<span class="ident" id="6282770">c</span>&nbsp;<span class="op" id="6282772">&amp;&amp;</span>&nbsp;<span class="ident" id="6282775">c</span>&nbsp;<span class="op" id="6282777">&lt;=</span>&nbsp;<span class="string" id="6282780">&#39;9&#39;</span>&nbsp;<span class="op" id="6282784">||</span>&nbsp;<span class="ident" id="6282787">c</span>&nbsp;<span class="op" id="6282789">==</span>&nbsp;<span class="string" id="6282792">&#39;_&#39;</span>&nbsp;<span class="op" id="6282796">||</span>&nbsp;<span class="ident" id="6282799">c</span>&nbsp;<span class="op" id="6282801">&gt;=</span>&nbsp;<span class="num" id="6282804">0x80</span><br>
<span class="lineno"></span><span class="op" id="6282809">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="6282812">var</span>&nbsp;<span class="op" id="6282816">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6282819">errSyntax</span>&nbsp;<span class="op" id="6282829">=</span>&nbsp;<span class="ident" id="6282831">errors</span><span class="op" id="6282837">.</span><span class="ident" id="6282838">New</span><span class="op" id="6282841">(</span><span class="string" id="6282842">&#34;syntax&nbsp;error&#34;</span><span class="op" id="6282856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6282859">errNUL</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6282869">=</span>&nbsp;<span class="ident" id="6282871">errors</span><span class="op" id="6282877">.</span><span class="ident" id="6282878">New</span><span class="op" id="6282881">(</span><span class="string" id="6282882">&#34;unexpected&nbsp;NUL&nbsp;in&nbsp;input&#34;</span><span class="op" id="6282907">)</span><br>
<span class="lineno"></span><span class="op" id="6282909">)</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="6282912">//&nbsp;syntaxError&nbsp;records&nbsp;a&nbsp;syntax&nbsp;error,&nbsp;but&nbsp;only&nbsp;if&nbsp;an&nbsp;I/O&nbsp;error&nbsp;has&nbsp;not&nbsp;already&nbsp;been&nbsp;recorded.</span><br>
<span class="lineno"></span><span class="keyword" id="6283007">func</span>&nbsp;<span class="op" id="6283012">(</span><span class="ident" id="6283013">r</span>&nbsp;<span class="op" id="6283015">*</span><span class="ident" id="6283016">importReader</span><span class="op" id="6283028">)</span>&nbsp;<span class="ident" id="6283030">syntaxError</span><span class="op" id="6283041">(</span><span class="op" id="6283042">)</span>&nbsp;<span class="op" id="6283044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6283047">if</span>&nbsp;<span class="ident" id="6283050">r</span><span class="op" id="6283051">.</span><span class="ident" id="6283052">err</span>&nbsp;<span class="op" id="6283056">==</span>&nbsp;<span class="ident" id="6283059">nil</span>&nbsp;<span class="op" id="6283063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6283067">r</span><span class="op" id="6283068">.</span><span class="ident" id="6283069">err</span>&nbsp;<span class="op" id="6283073">=</span>&nbsp;<span class="ident" id="6283075">errSyntax</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6283086">}</span><br>
<span class="lineno"></span><span class="op" id="6283088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6283091">//&nbsp;readByte&nbsp;reads&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input,&nbsp;saves&nbsp;it&nbsp;in&nbsp;buf,&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="6283172">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;readByte&nbsp;records&nbsp;the&nbsp;error&nbsp;in&nbsp;r.err&nbsp;and&nbsp;returns&nbsp;0.</span><br>
<span class="lineno">40</span><span class="keyword" id="6283246">func</span>&nbsp;<span class="op" id="6283251">(</span><span class="ident" id="6283252">r</span>&nbsp;<span class="op" id="6283254">*</span><span class="ident" id="6283255">importReader</span><span class="op" id="6283267">)</span>&nbsp;<span class="ident" id="6283269">readByte</span><span class="op" id="6283277">(</span><span class="op" id="6283278">)</span>&nbsp;<span class="builtintype" id="6283280">byte</span>&nbsp;<span class="op" id="6283285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6283288">c</span><span class="op" id="6283289">,</span>&nbsp;<span class="ident" id="6283291">err</span>&nbsp;<span class="op" id="6283295">:=</span>&nbsp;<span class="ident" id="6283298">r</span><span class="op" id="6283299">.</span><span class="ident" id="6283300">b</span><span class="op" id="6283301">.</span><span class="ident" id="6283302">ReadByte</span><span class="op" id="6283310">(</span><span class="op" id="6283311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6283314">if</span>&nbsp;<span class="ident" id="6283317">err</span>&nbsp;<span class="op" id="6283321">==</span>&nbsp;<span class="ident" id="6283324">nil</span>&nbsp;<span class="op" id="6283328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6283332">r</span><span class="op" id="6283333">.</span><span class="ident" id="6283334">buf</span>&nbsp;<span class="op" id="6283338">=</span>&nbsp;<span class="builtinfunc" id="6283340">append</span><span class="op" id="6283346">(</span><span class="ident" id="6283347">r</span><span class="op" id="6283348">.</span><span class="ident" id="6283349">buf</span><span class="op" id="6283352">,</span>&nbsp;<span class="ident" id="6283354">c</span><span class="op" id="6283355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6283359">if</span>&nbsp;<span class="ident" id="6283362">c</span>&nbsp;<span class="op" id="6283364">==</span>&nbsp;<span class="num" id="6283367">0</span>&nbsp;<span class="op" id="6283369">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6283374">err</span>&nbsp;<span class="op" id="6283378">=</span>&nbsp;<span class="ident" id="6283380">errNUL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6283389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6283392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6283395">if</span>&nbsp;<span class="ident" id="6283398">err</span>&nbsp;<span class="op" id="6283402">!=</span>&nbsp;<span class="ident" id="6283405">nil</span>&nbsp;<span class="op" id="6283409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6283413">if</span>&nbsp;<span class="ident" id="6283416">err</span>&nbsp;<span class="op" id="6283420">==</span>&nbsp;<span class="ident" id="6283423">io</span><span class="op" id="6283425">.</span><span class="ident" id="6283426">EOF</span>&nbsp;<span class="op" id="6283430">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6283435">r</span><span class="op" id="6283436">.</span><span class="ident" id="6283437">eof</span>&nbsp;<span class="op" id="6283441">=</span>&nbsp;<span class="builtintype" id="6283443">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6283450">}</span>&nbsp;<span class="keyword" id="6283452">else</span>&nbsp;<span class="keyword" id="6283457">if</span>&nbsp;<span class="ident" id="6283460">r</span><span class="op" id="6283461">.</span><span class="ident" id="6283462">err</span>&nbsp;<span class="op" id="6283466">==</span>&nbsp;<span class="ident" id="6283469">nil</span>&nbsp;<span class="op" id="6283473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6283478">r</span><span class="op" id="6283479">.</span><span class="ident" id="6283480">err</span>&nbsp;<span class="op" id="6283484">=</span>&nbsp;<span class="ident" id="6283486">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6283492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6283496">c</span>&nbsp;<span class="op" id="6283498">=</span>&nbsp;<span class="num" id="6283500">0</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6283503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6283506">return</span>&nbsp;<span class="ident" id="6283513">c</span><br>
<span class="lineno"></span><span class="op" id="6283515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6283518">//&nbsp;peekByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input&nbsp;reader&nbsp;but&nbsp;does&nbsp;not&nbsp;advance&nbsp;beyond&nbsp;it.</span><br>
<span class="lineno">60</span><span class="comment" id="6283606">//&nbsp;If&nbsp;skipSpace&nbsp;is&nbsp;set,&nbsp;peekByte&nbsp;skips&nbsp;leading&nbsp;spaces&nbsp;and&nbsp;comments.</span><br>
<span class="lineno"></span><span class="keyword" id="6283674">func</span>&nbsp;<span class="op" id="6283679">(</span><span class="ident" id="6283680">r</span>&nbsp;<span class="op" id="6283682">*</span><span class="ident" id="6283683">importReader</span><span class="op" id="6283695">)</span>&nbsp;<span class="ident" id="6283697">peekByte</span><span class="op" id="6283705">(</span><span class="ident" id="6283706">skipSpace</span>&nbsp;<span class="builtintype" id="6283716">bool</span><span class="op" id="6283720">)</span>&nbsp;<span class="builtintype" id="6283722">byte</span>&nbsp;<span class="op" id="6283727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6283730">if</span>&nbsp;<span class="ident" id="6283733">r</span><span class="op" id="6283734">.</span><span class="ident" id="6283735">err</span>&nbsp;<span class="op" id="6283739">!=</span>&nbsp;<span class="ident" id="6283742">nil</span>&nbsp;<span class="op" id="6283746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6283750">if</span>&nbsp;<span class="ident" id="6283753">r</span><span class="op" id="6283754">.</span><span class="ident" id="6283755">nerr</span><span class="op" id="6283759">++</span><span class="op" id="6283761">;</span>&nbsp;<span class="ident" id="6283763">r</span><span class="op" id="6283764">.</span><span class="ident" id="6283765">nerr</span>&nbsp;<span class="op" id="6283770">&gt;</span>&nbsp;<span class="num" id="6283772">10000</span>&nbsp;<span class="op" id="6283778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6283783">panic</span><span class="op" id="6283788">(</span><span class="string" id="6283789">&#34;go/build:&nbsp;import&nbsp;reader&nbsp;looping&#34;</span><span class="op" id="6283822">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6283826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6283830">return</span>&nbsp;<span class="num" id="6283837">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6283840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6283844">//&nbsp;Use&nbsp;r.peek&nbsp;as&nbsp;first&nbsp;input&nbsp;byte.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6283880">//&nbsp;Don&#39;t&nbsp;just&nbsp;return&nbsp;r.peek&nbsp;here:&nbsp;it&nbsp;might&nbsp;have&nbsp;been&nbsp;left&nbsp;by&nbsp;peekByte(false)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6283958">//&nbsp;and&nbsp;this&nbsp;might&nbsp;be&nbsp;peekByte(true).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6283996">c</span>&nbsp;<span class="op" id="6283998">:=</span>&nbsp;<span class="ident" id="6284001">r</span><span class="op" id="6284002">.</span><span class="ident" id="6284003">peek</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6284009">if</span>&nbsp;<span class="ident" id="6284012">c</span>&nbsp;<span class="op" id="6284014">==</span>&nbsp;<span class="num" id="6284017">0</span>&nbsp;<span class="op" id="6284019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6284023">c</span>&nbsp;<span class="op" id="6284025">=</span>&nbsp;<span class="ident" id="6284027">r</span><span class="op" id="6284028">.</span><span class="ident" id="6284029">readByte</span><span class="op" id="6284037">(</span><span class="op" id="6284038">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6284041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6284044">for</span>&nbsp;<span class="ident" id="6284048">r</span><span class="op" id="6284049">.</span><span class="ident" id="6284050">err</span>&nbsp;<span class="op" id="6284054">==</span>&nbsp;<span class="ident" id="6284057">nil</span>&nbsp;<span class="op" id="6284061">&amp;&amp;</span>&nbsp;<span class="op" id="6284064">!</span><span class="ident" id="6284065">r</span><span class="op" id="6284066">.</span><span class="ident" id="6284067">eof</span>&nbsp;<span class="op" id="6284071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6284075">if</span>&nbsp;<span class="ident" id="6284078">skipSpace</span>&nbsp;<span class="op" id="6284088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6284093">//&nbsp;For&nbsp;the&nbsp;purposes&nbsp;of&nbsp;this&nbsp;reader,&nbsp;semicolons&nbsp;are&nbsp;never&nbsp;necessary&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6284166">//&nbsp;understand&nbsp;the&nbsp;input&nbsp;and&nbsp;are&nbsp;treated&nbsp;as&nbsp;spaces.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6284220">switch</span>&nbsp;<span class="ident" id="6284227">c</span>&nbsp;<span class="op" id="6284229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6284234">case</span>&nbsp;<span class="string" id="6284239">&#39;&nbsp;&#39;</span><span class="op" id="6284242">,</span>&nbsp;<span class="string" id="6284244">&#39;\f&#39;</span><span class="op" id="6284248">,</span>&nbsp;<span class="string" id="6284250">&#39;\t&#39;</span><span class="op" id="6284254">,</span>&nbsp;<span class="string" id="6284256">&#39;\r&#39;</span><span class="op" id="6284260">,</span>&nbsp;<span class="string" id="6284262">&#39;\n&#39;</span><span class="op" id="6284266">,</span>&nbsp;<span class="string" id="6284268">&#39;;&#39;</span><span class="op" id="6284271">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6284277">c</span>&nbsp;<span class="op" id="6284279">=</span>&nbsp;<span class="ident" id="6284281">r</span><span class="op" id="6284282">.</span><span class="ident" id="6284283">readByte</span><span class="op" id="6284291">(</span><span class="op" id="6284292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6284298">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6284311">case</span>&nbsp;<span class="string" id="6284316">&#39;/&#39;</span><span class="op" id="6284319">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6284325">c</span>&nbsp;<span class="op" id="6284327">=</span>&nbsp;<span class="ident" id="6284329">r</span><span class="op" id="6284330">.</span><span class="ident" id="6284331">readByte</span><span class="op" id="6284339">(</span><span class="op" id="6284340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6284346">if</span>&nbsp;<span class="ident" id="6284349">c</span>&nbsp;<span class="op" id="6284351">==</span>&nbsp;<span class="string" id="6284354">&#39;/&#39;</span>&nbsp;<span class="op" id="6284358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6284365">for</span>&nbsp;<span class="ident" id="6284369">c</span>&nbsp;<span class="op" id="6284371">!=</span>&nbsp;<span class="string" id="6284374">&#39;\n&#39;</span>&nbsp;<span class="op" id="6284379">&amp;&amp;</span>&nbsp;<span class="ident" id="6284382">r</span><span class="op" id="6284383">.</span><span class="ident" id="6284384">err</span>&nbsp;<span class="op" id="6284388">==</span>&nbsp;<span class="ident" id="6284391">nil</span>&nbsp;<span class="op" id="6284395">&amp;&amp;</span>&nbsp;<span class="op" id="6284398">!</span><span class="ident" id="6284399">r</span><span class="op" id="6284400">.</span><span class="ident" id="6284401">eof</span>&nbsp;<span class="op" id="6284405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6284413">c</span>&nbsp;<span class="op" id="6284415">=</span>&nbsp;<span class="ident" id="6284417">r</span><span class="op" id="6284418">.</span><span class="ident" id="6284419">readByte</span><span class="op" id="6284427">(</span><span class="op" id="6284428">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6284435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6284441">}</span>&nbsp;<span class="keyword" id="6284443">else</span>&nbsp;<span class="keyword" id="6284448">if</span>&nbsp;<span class="ident" id="6284451">c</span>&nbsp;<span class="op" id="6284453">==</span>&nbsp;<span class="string" id="6284456">&#39;*&#39;</span>&nbsp;<span class="op" id="6284460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6284467">var</span>&nbsp;<span class="ident" id="6284471">c1</span>&nbsp;<span class="builtintype" id="6284474">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6284484">for</span>&nbsp;<span class="op" id="6284488">(</span><span class="ident" id="6284489">c</span>&nbsp;<span class="op" id="6284491">!=</span>&nbsp;<span class="string" id="6284494">&#39;*&#39;</span>&nbsp;<span class="op" id="6284498">||</span>&nbsp;<span class="ident" id="6284501">c1</span>&nbsp;<span class="op" id="6284504">!=</span>&nbsp;<span class="string" id="6284507">&#39;/&#39;</span><span class="op" id="6284510">)</span>&nbsp;<span class="op" id="6284512">&amp;&amp;</span>&nbsp;<span class="ident" id="6284515">r</span><span class="op" id="6284516">.</span><span class="ident" id="6284517">err</span>&nbsp;<span class="op" id="6284521">==</span>&nbsp;<span class="ident" id="6284524">nil</span>&nbsp;<span class="op" id="6284528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6284536">if</span>&nbsp;<span class="ident" id="6284539">r</span><span class="op" id="6284540">.</span><span class="ident" id="6284541">eof</span>&nbsp;<span class="op" id="6284545">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6284554">r</span><span class="op" id="6284555">.</span><span class="ident" id="6284556">syntaxError</span><span class="op" id="6284567">(</span><span class="op" id="6284568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6284576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6284584">c</span><span class="op" id="6284585">,</span>&nbsp;<span class="ident" id="6284587">c1</span>&nbsp;<span class="op" id="6284590">=</span>&nbsp;<span class="ident" id="6284592">c1</span><span class="op" id="6284594">,</span>&nbsp;<span class="ident" id="6284596">r</span><span class="op" id="6284597">.</span><span class="ident" id="6284598">readByte</span><span class="op" id="6284606">(</span><span class="op" id="6284607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6284614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6284620">}</span>&nbsp;<span class="keyword" id="6284622">else</span>&nbsp;<span class="op" id="6284627">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6284634">r</span><span class="op" id="6284635">.</span><span class="ident" id="6284636">syntaxError</span><span class="op" id="6284647">(</span><span class="op" id="6284648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6284654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6284660">c</span>&nbsp;<span class="op" id="6284662">=</span>&nbsp;<span class="ident" id="6284664">r</span><span class="op" id="6284665">.</span><span class="ident" id="6284666">readByte</span><span class="op" id="6284674">(</span><span class="op" id="6284675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6284681">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6284693">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6284697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6284701">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6284708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6284711">r</span><span class="op" id="6284712">.</span><span class="ident" id="6284713">peek</span>&nbsp;<span class="op" id="6284718">=</span>&nbsp;<span class="ident" id="6284720">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6284723">return</span>&nbsp;<span class="ident" id="6284730">r</span><span class="op" id="6284731">.</span><span class="ident" id="6284732">peek</span><br>
<span class="lineno">110</span><span class="op" id="6284737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6284740">//&nbsp;nextByte&nbsp;is&nbsp;like&nbsp;peekByte&nbsp;but&nbsp;advances&nbsp;beyond&nbsp;the&nbsp;returned&nbsp;byte.</span><br>
<span class="lineno"></span><span class="keyword" id="6284808">func</span>&nbsp;<span class="op" id="6284813">(</span><span class="ident" id="6284814">r</span>&nbsp;<span class="op" id="6284816">*</span><span class="ident" id="6284817">importReader</span><span class="op" id="6284829">)</span>&nbsp;<span class="ident" id="6284831">nextByte</span><span class="op" id="6284839">(</span><span class="ident" id="6284840">skipSpace</span>&nbsp;<span class="builtintype" id="6284850">bool</span><span class="op" id="6284854">)</span>&nbsp;<span class="builtintype" id="6284856">byte</span>&nbsp;<span class="op" id="6284861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6284864">c</span>&nbsp;<span class="op" id="6284866">:=</span>&nbsp;<span class="ident" id="6284869">r</span><span class="op" id="6284870">.</span><span class="ident" id="6284871">peekByte</span><span class="op" id="6284879">(</span><span class="ident" id="6284880">skipSpace</span><span class="op" id="6284889">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6284892">r</span><span class="op" id="6284893">.</span><span class="ident" id="6284894">peek</span>&nbsp;<span class="op" id="6284899">=</span>&nbsp;<span class="num" id="6284901">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6284904">return</span>&nbsp;<span class="ident" id="6284911">c</span><br>
<span class="lineno"></span><span class="op" id="6284913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6284916">//&nbsp;readKeyword&nbsp;reads&nbsp;the&nbsp;given&nbsp;keyword&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">120</span><span class="comment" id="6284971">//&nbsp;If&nbsp;the&nbsp;keyword&nbsp;is&nbsp;not&nbsp;present,&nbsp;readKeyword&nbsp;records&nbsp;a&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="6285041">func</span>&nbsp;<span class="op" id="6285046">(</span><span class="ident" id="6285047">r</span>&nbsp;<span class="op" id="6285049">*</span><span class="ident" id="6285050">importReader</span><span class="op" id="6285062">)</span>&nbsp;<span class="ident" id="6285064">readKeyword</span><span class="op" id="6285075">(</span><span class="ident" id="6285076">kw</span>&nbsp;<span class="builtintype" id="6285079">string</span><span class="op" id="6285085">)</span>&nbsp;<span class="op" id="6285087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6285090">r</span><span class="op" id="6285091">.</span><span class="ident" id="6285092">peekByte</span><span class="op" id="6285100">(</span><span class="builtintype" id="6285101">true</span><span class="op" id="6285105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6285108">for</span>&nbsp;<span class="ident" id="6285112">i</span>&nbsp;<span class="op" id="6285114">:=</span>&nbsp;<span class="num" id="6285117">0</span><span class="op" id="6285118">;</span>&nbsp;<span class="ident" id="6285120">i</span>&nbsp;<span class="op" id="6285122">&lt;</span>&nbsp;<span class="builtinfunc" id="6285124">len</span><span class="op" id="6285127">(</span><span class="ident" id="6285128">kw</span><span class="op" id="6285130">)</span><span class="op" id="6285131">;</span>&nbsp;<span class="ident" id="6285133">i</span><span class="op" id="6285134">++</span>&nbsp;<span class="op" id="6285137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6285141">if</span>&nbsp;<span class="ident" id="6285144">r</span><span class="op" id="6285145">.</span><span class="ident" id="6285146">nextByte</span><span class="op" id="6285154">(</span><span class="builtintype" id="6285155">false</span><span class="op" id="6285160">)</span>&nbsp;<span class="op" id="6285162">!=</span>&nbsp;<span class="ident" id="6285165">kw</span><span class="op" id="6285167">[</span><span class="ident" id="6285168">i</span><span class="op" id="6285169">]</span>&nbsp;<span class="op" id="6285171">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6285176">r</span><span class="op" id="6285177">.</span><span class="ident" id="6285178">syntaxError</span><span class="op" id="6285189">(</span><span class="op" id="6285190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6285195">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6285204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6285207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6285210">if</span>&nbsp;<span class="ident" id="6285213">isIdent</span><span class="op" id="6285220">(</span><span class="ident" id="6285221">r</span><span class="op" id="6285222">.</span><span class="ident" id="6285223">peekByte</span><span class="op" id="6285231">(</span><span class="builtintype" id="6285232">false</span><span class="op" id="6285237">)</span><span class="op" id="6285238">)</span>&nbsp;<span class="op" id="6285240">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6285244">r</span><span class="op" id="6285245">.</span><span class="ident" id="6285246">syntaxError</span><span class="op" id="6285257">(</span><span class="op" id="6285258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6285261">}</span><br>
<span class="lineno"></span><span class="op" id="6285263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6285266">//&nbsp;readIdent&nbsp;reads&nbsp;an&nbsp;identifier&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">135</span><span class="comment" id="6285315">//&nbsp;If&nbsp;an&nbsp;identifier&nbsp;is&nbsp;not&nbsp;present,&nbsp;readIdent&nbsp;records&nbsp;a&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="6285385">func</span>&nbsp;<span class="op" id="6285390">(</span><span class="ident" id="6285391">r</span>&nbsp;<span class="op" id="6285393">*</span><span class="ident" id="6285394">importReader</span><span class="op" id="6285406">)</span>&nbsp;<span class="ident" id="6285408">readIdent</span><span class="op" id="6285417">(</span><span class="op" id="6285418">)</span>&nbsp;<span class="op" id="6285420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6285423">c</span>&nbsp;<span class="op" id="6285425">:=</span>&nbsp;<span class="ident" id="6285428">r</span><span class="op" id="6285429">.</span><span class="ident" id="6285430">peekByte</span><span class="op" id="6285438">(</span><span class="builtintype" id="6285439">true</span><span class="op" id="6285443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6285446">if</span>&nbsp;<span class="op" id="6285449">!</span><span class="ident" id="6285450">isIdent</span><span class="op" id="6285457">(</span><span class="ident" id="6285458">c</span><span class="op" id="6285459">)</span>&nbsp;<span class="op" id="6285461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6285465">r</span><span class="op" id="6285466">.</span><span class="ident" id="6285467">syntaxError</span><span class="op" id="6285478">(</span><span class="op" id="6285479">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6285483">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6285491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6285494">for</span>&nbsp;<span class="ident" id="6285498">isIdent</span><span class="op" id="6285505">(</span><span class="ident" id="6285506">r</span><span class="op" id="6285507">.</span><span class="ident" id="6285508">peekByte</span><span class="op" id="6285516">(</span><span class="builtintype" id="6285517">false</span><span class="op" id="6285522">)</span><span class="op" id="6285523">)</span>&nbsp;<span class="op" id="6285525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6285529">r</span><span class="op" id="6285530">.</span><span class="ident" id="6285531">peek</span>&nbsp;<span class="op" id="6285536">=</span>&nbsp;<span class="num" id="6285538">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6285541">}</span><br>
<span class="lineno">145</span><span class="op" id="6285543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6285546">//&nbsp;readString&nbsp;reads&nbsp;a&nbsp;quoted&nbsp;string&nbsp;literal&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="6285606">//&nbsp;If&nbsp;an&nbsp;identifier&nbsp;is&nbsp;not&nbsp;present,&nbsp;readString&nbsp;records&nbsp;a&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="6285677">func</span>&nbsp;<span class="op" id="6285682">(</span><span class="ident" id="6285683">r</span>&nbsp;<span class="op" id="6285685">*</span><span class="ident" id="6285686">importReader</span><span class="op" id="6285698">)</span>&nbsp;<span class="ident" id="6285700">readString</span><span class="op" id="6285710">(</span><span class="op" id="6285711">)</span>&nbsp;<span class="op" id="6285713">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6285716">switch</span>&nbsp;<span class="ident" id="6285723">r</span><span class="op" id="6285724">.</span><span class="ident" id="6285725">nextByte</span><span class="op" id="6285733">(</span><span class="builtintype" id="6285734">true</span><span class="op" id="6285738">)</span>&nbsp;<span class="op" id="6285740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6285743">case</span>&nbsp;<span class="string" id="6285748">&#39;`&#39;</span><span class="op" id="6285751">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6285755">for</span>&nbsp;<span class="ident" id="6285759">r</span><span class="op" id="6285760">.</span><span class="ident" id="6285761">err</span>&nbsp;<span class="op" id="6285765">==</span>&nbsp;<span class="ident" id="6285768">nil</span>&nbsp;<span class="op" id="6285772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6285777">if</span>&nbsp;<span class="ident" id="6285780">r</span><span class="op" id="6285781">.</span><span class="ident" id="6285782">nextByte</span><span class="op" id="6285790">(</span><span class="builtintype" id="6285791">false</span><span class="op" id="6285796">)</span>&nbsp;<span class="op" id="6285798">==</span>&nbsp;<span class="string" id="6285801">&#39;`&#39;</span>&nbsp;<span class="op" id="6285805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6285811">break</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6285820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6285825">if</span>&nbsp;<span class="ident" id="6285828">r</span><span class="op" id="6285829">.</span><span class="ident" id="6285830">eof</span>&nbsp;<span class="op" id="6285834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6285840">r</span><span class="op" id="6285841">.</span><span class="ident" id="6285842">syntaxError</span><span class="op" id="6285853">(</span><span class="op" id="6285854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6285859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6285863">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6285866">case</span>&nbsp;<span class="string" id="6285871">&#39;&#34;&#39;</span><span class="op" id="6285874">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6285878">for</span>&nbsp;<span class="ident" id="6285882">r</span><span class="op" id="6285883">.</span><span class="ident" id="6285884">err</span>&nbsp;<span class="op" id="6285888">==</span>&nbsp;<span class="ident" id="6285891">nil</span>&nbsp;<span class="op" id="6285895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6285900">c</span>&nbsp;<span class="op" id="6285902">:=</span>&nbsp;<span class="ident" id="6285905">r</span><span class="op" id="6285906">.</span><span class="ident" id="6285907">nextByte</span><span class="op" id="6285915">(</span><span class="builtintype" id="6285916">false</span><span class="op" id="6285921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6285926">if</span>&nbsp;<span class="ident" id="6285929">c</span>&nbsp;<span class="op" id="6285931">==</span>&nbsp;<span class="string" id="6285934">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="6285938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6285944">break</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6285953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6285958">if</span>&nbsp;<span class="ident" id="6285961">r</span><span class="op" id="6285962">.</span><span class="ident" id="6285963">eof</span>&nbsp;<span class="op" id="6285967">||</span>&nbsp;<span class="ident" id="6285970">c</span>&nbsp;<span class="op" id="6285972">==</span>&nbsp;<span class="string" id="6285975">&#39;\n&#39;</span>&nbsp;<span class="op" id="6285980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6285986">r</span><span class="op" id="6285987">.</span><span class="ident" id="6285988">syntaxError</span><span class="op" id="6285999">(</span><span class="op" id="6286000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6286005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6286010">if</span>&nbsp;<span class="ident" id="6286013">c</span>&nbsp;<span class="op" id="6286015">==</span>&nbsp;<span class="string" id="6286018">&#39;\\&#39;</span>&nbsp;<span class="op" id="6286023">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6286029">r</span><span class="op" id="6286030">.</span><span class="ident" id="6286031">nextByte</span><span class="op" id="6286039">(</span><span class="builtintype" id="6286040">false</span><span class="op" id="6286045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6286050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6286054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6286057">default</span><span class="op" id="6286064">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6286068">r</span><span class="op" id="6286069">.</span><span class="ident" id="6286070">syntaxError</span><span class="op" id="6286081">(</span><span class="op" id="6286082">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6286085">}</span><br>
<span class="lineno"></span><span class="op" id="6286087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6286090">//&nbsp;readImport&nbsp;reads&nbsp;an&nbsp;import&nbsp;clause&nbsp;-&nbsp;optional&nbsp;identifier&nbsp;followed&nbsp;by&nbsp;quoted&nbsp;string&nbsp;-</span><br>
<span class="lineno"></span><span class="comment" id="6286177">//&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">180</span><span class="keyword" id="6286196">func</span>&nbsp;<span class="op" id="6286201">(</span><span class="ident" id="6286202">r</span>&nbsp;<span class="op" id="6286204">*</span><span class="ident" id="6286205">importReader</span><span class="op" id="6286217">)</span>&nbsp;<span class="ident" id="6286219">readImport</span><span class="op" id="6286229">(</span><span class="op" id="6286230">)</span>&nbsp;<span class="op" id="6286232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6286235">c</span>&nbsp;<span class="op" id="6286237">:=</span>&nbsp;<span class="ident" id="6286240">r</span><span class="op" id="6286241">.</span><span class="ident" id="6286242">peekByte</span><span class="op" id="6286250">(</span><span class="builtintype" id="6286251">true</span><span class="op" id="6286255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6286258">if</span>&nbsp;<span class="ident" id="6286261">c</span>&nbsp;<span class="op" id="6286263">==</span>&nbsp;<span class="string" id="6286266">&#39;.&#39;</span>&nbsp;<span class="op" id="6286270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6286274">r</span><span class="op" id="6286275">.</span><span class="ident" id="6286276">peek</span>&nbsp;<span class="op" id="6286281">=</span>&nbsp;<span class="num" id="6286283">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6286286">}</span>&nbsp;<span class="keyword" id="6286288">else</span>&nbsp;<span class="keyword" id="6286293">if</span>&nbsp;<span class="ident" id="6286296">isIdent</span><span class="op" id="6286303">(</span><span class="ident" id="6286304">c</span><span class="op" id="6286305">)</span>&nbsp;<span class="op" id="6286307">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6286311">r</span><span class="op" id="6286312">.</span><span class="ident" id="6286313">readIdent</span><span class="op" id="6286322">(</span><span class="op" id="6286323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6286326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6286329">r</span><span class="op" id="6286330">.</span><span class="ident" id="6286331">readString</span><span class="op" id="6286341">(</span><span class="op" id="6286342">)</span><br>
<span class="lineno"></span><span class="op" id="6286344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="6286347">//&nbsp;readComments&nbsp;is&nbsp;like&nbsp;ioutil.ReadAll,&nbsp;except&nbsp;that&nbsp;it&nbsp;only&nbsp;reads&nbsp;the&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="6286425">//&nbsp;block&nbsp;of&nbsp;comments&nbsp;in&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6286459">func</span>&nbsp;<span class="ident" id="6286464">readComments</span><span class="op" id="6286476">(</span><span class="ident" id="6286477">f</span>&nbsp;<span class="ident" id="6286479">io</span><span class="op" id="6286481">.</span><span class="ident" id="6286482">Reader</span><span class="op" id="6286488">)</span>&nbsp;<span class="op" id="6286490">(</span><span class="op" id="6286491">[</span><span class="op" id="6286492">]</span><span class="builtintype" id="6286493">byte</span><span class="op" id="6286497">,</span>&nbsp;<span class="builtintype" id="6286499">error</span><span class="op" id="6286504">)</span>&nbsp;<span class="op" id="6286506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6286509">r</span>&nbsp;<span class="op" id="6286511">:=</span>&nbsp;<span class="op" id="6286514">&amp;</span><span class="ident" id="6286515">importReader</span><span class="op" id="6286527">{</span><span class="ident" id="6286528">b</span><span class="op" id="6286529">:</span>&nbsp;<span class="ident" id="6286531">bufio</span><span class="op" id="6286536">.</span><span class="ident" id="6286537">NewReader</span><span class="op" id="6286546">(</span><span class="ident" id="6286547">f</span><span class="op" id="6286548">)</span><span class="op" id="6286549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6286552">r</span><span class="op" id="6286553">.</span><span class="ident" id="6286554">peekByte</span><span class="op" id="6286562">(</span><span class="builtintype" id="6286563">true</span><span class="op" id="6286567">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6286570">if</span>&nbsp;<span class="ident" id="6286573">r</span><span class="op" id="6286574">.</span><span class="ident" id="6286575">err</span>&nbsp;<span class="op" id="6286579">==</span>&nbsp;<span class="ident" id="6286582">nil</span>&nbsp;<span class="op" id="6286586">&amp;&amp;</span>&nbsp;<span class="op" id="6286589">!</span><span class="ident" id="6286590">r</span><span class="op" id="6286591">.</span><span class="ident" id="6286592">eof</span>&nbsp;<span class="op" id="6286596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6286600">//&nbsp;Didn&#39;t&nbsp;reach&nbsp;EOF,&nbsp;so&nbsp;must&nbsp;have&nbsp;found&nbsp;a&nbsp;non-space&nbsp;byte.&nbsp;Remove&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6286671">r</span><span class="op" id="6286672">.</span><span class="ident" id="6286673">buf</span>&nbsp;<span class="op" id="6286677">=</span>&nbsp;<span class="ident" id="6286679">r</span><span class="op" id="6286680">.</span><span class="ident" id="6286681">buf</span><span class="op" id="6286684">[</span><span class="op" id="6286685">:</span><span class="builtinfunc" id="6286686">len</span><span class="op" id="6286689">(</span><span class="ident" id="6286690">r</span><span class="op" id="6286691">.</span><span class="ident" id="6286692">buf</span><span class="op" id="6286695">)</span><span class="op" id="6286696">-</span><span class="num" id="6286697">1</span><span class="op" id="6286698">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6286701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6286704">return</span>&nbsp;<span class="ident" id="6286711">r</span><span class="op" id="6286712">.</span><span class="ident" id="6286713">buf</span><span class="op" id="6286716">,</span>&nbsp;<span class="ident" id="6286718">r</span><span class="op" id="6286719">.</span><span class="ident" id="6286720">err</span><br>
<span class="lineno">200</span><span class="op" id="6286724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6286727">//&nbsp;readImports&nbsp;is&nbsp;like&nbsp;ioutil.ReadAll,&nbsp;except&nbsp;that&nbsp;it&nbsp;expects&nbsp;a&nbsp;Go&nbsp;file&nbsp;as&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="6286808">//&nbsp;and&nbsp;stops&nbsp;reading&nbsp;the&nbsp;input&nbsp;once&nbsp;the&nbsp;imports&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="keyword" id="6286872">func</span>&nbsp;<span class="ident" id="6286877">readImports</span><span class="op" id="6286888">(</span><span class="ident" id="6286889">f</span>&nbsp;<span class="ident" id="6286891">io</span><span class="op" id="6286893">.</span><span class="ident" id="6286894">Reader</span><span class="op" id="6286900">,</span>&nbsp;<span class="ident" id="6286902">reportSyntaxError</span>&nbsp;<span class="builtintype" id="6286920">bool</span><span class="op" id="6286924">)</span>&nbsp;<span class="op" id="6286926">(</span><span class="op" id="6286927">[</span><span class="op" id="6286928">]</span><span class="builtintype" id="6286929">byte</span><span class="op" id="6286933">,</span>&nbsp;<span class="builtintype" id="6286935">error</span><span class="op" id="6286940">)</span>&nbsp;<span class="op" id="6286942">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6286945">r</span>&nbsp;<span class="op" id="6286947">:=</span>&nbsp;<span class="op" id="6286950">&amp;</span><span class="ident" id="6286951">importReader</span><span class="op" id="6286963">{</span><span class="ident" id="6286964">b</span><span class="op" id="6286965">:</span>&nbsp;<span class="ident" id="6286967">bufio</span><span class="op" id="6286972">.</span><span class="ident" id="6286973">NewReader</span><span class="op" id="6286982">(</span><span class="ident" id="6286983">f</span><span class="op" id="6286984">)</span><span class="op" id="6286985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6286989">r</span><span class="op" id="6286990">.</span><span class="ident" id="6286991">readKeyword</span><span class="op" id="6287002">(</span><span class="string" id="6287003">&#34;package&#34;</span><span class="op" id="6287012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6287015">r</span><span class="op" id="6287016">.</span><span class="ident" id="6287017">readIdent</span><span class="op" id="6287026">(</span><span class="op" id="6287027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6287030">for</span>&nbsp;<span class="ident" id="6287034">r</span><span class="op" id="6287035">.</span><span class="ident" id="6287036">peekByte</span><span class="op" id="6287044">(</span><span class="builtintype" id="6287045">true</span><span class="op" id="6287049">)</span>&nbsp;<span class="op" id="6287051">==</span>&nbsp;<span class="string" id="6287054">&#39;i&#39;</span>&nbsp;<span class="op" id="6287058">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6287062">r</span><span class="op" id="6287063">.</span><span class="ident" id="6287064">readKeyword</span><span class="op" id="6287075">(</span><span class="string" id="6287076">&#34;import&#34;</span><span class="op" id="6287084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6287088">if</span>&nbsp;<span class="ident" id="6287091">r</span><span class="op" id="6287092">.</span><span class="ident" id="6287093">peekByte</span><span class="op" id="6287101">(</span><span class="builtintype" id="6287102">true</span><span class="op" id="6287106">)</span>&nbsp;<span class="op" id="6287108">==</span>&nbsp;<span class="string" id="6287111">&#39;(&#39;</span>&nbsp;<span class="op" id="6287115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6287120">r</span><span class="op" id="6287121">.</span><span class="ident" id="6287122">nextByte</span><span class="op" id="6287130">(</span><span class="builtintype" id="6287131">false</span><span class="op" id="6287136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6287141">for</span>&nbsp;<span class="ident" id="6287145">r</span><span class="op" id="6287146">.</span><span class="ident" id="6287147">peekByte</span><span class="op" id="6287155">(</span><span class="builtintype" id="6287156">true</span><span class="op" id="6287160">)</span>&nbsp;<span class="op" id="6287162">!=</span>&nbsp;<span class="string" id="6287165">&#39;)&#39;</span>&nbsp;<span class="op" id="6287169">&amp;&amp;</span>&nbsp;<span class="ident" id="6287172">r</span><span class="op" id="6287173">.</span><span class="ident" id="6287174">err</span>&nbsp;<span class="op" id="6287178">==</span>&nbsp;<span class="ident" id="6287181">nil</span>&nbsp;<span class="op" id="6287185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6287191">r</span><span class="op" id="6287192">.</span><span class="ident" id="6287193">readImport</span><span class="op" id="6287203">(</span><span class="op" id="6287204">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6287209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6287214">r</span><span class="op" id="6287215">.</span><span class="ident" id="6287216">nextByte</span><span class="op" id="6287224">(</span><span class="builtintype" id="6287225">false</span><span class="op" id="6287230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6287234">}</span>&nbsp;<span class="keyword" id="6287236">else</span>&nbsp;<span class="op" id="6287241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6287246">r</span><span class="op" id="6287247">.</span><span class="ident" id="6287248">readImport</span><span class="op" id="6287258">(</span><span class="op" id="6287259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6287263">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6287266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6287270">//&nbsp;If&nbsp;we&nbsp;stopped&nbsp;successfully&nbsp;before&nbsp;EOF,&nbsp;we&nbsp;read&nbsp;a&nbsp;byte&nbsp;that&nbsp;told&nbsp;us&nbsp;we&nbsp;were&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6287355">//&nbsp;Return&nbsp;all&nbsp;but&nbsp;that&nbsp;last&nbsp;byte,&nbsp;which&nbsp;would&nbsp;cause&nbsp;a&nbsp;syntax&nbsp;error&nbsp;if&nbsp;we&nbsp;let&nbsp;it&nbsp;through.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6287445">if</span>&nbsp;<span class="ident" id="6287448">r</span><span class="op" id="6287449">.</span><span class="ident" id="6287450">err</span>&nbsp;<span class="op" id="6287454">==</span>&nbsp;<span class="ident" id="6287457">nil</span>&nbsp;<span class="op" id="6287461">&amp;&amp;</span>&nbsp;<span class="op" id="6287464">!</span><span class="ident" id="6287465">r</span><span class="op" id="6287466">.</span><span class="ident" id="6287467">eof</span>&nbsp;<span class="op" id="6287471">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6287475">return</span>&nbsp;<span class="ident" id="6287482">r</span><span class="op" id="6287483">.</span><span class="ident" id="6287484">buf</span><span class="op" id="6287487">[</span><span class="op" id="6287488">:</span><span class="builtinfunc" id="6287489">len</span><span class="op" id="6287492">(</span><span class="ident" id="6287493">r</span><span class="op" id="6287494">.</span><span class="ident" id="6287495">buf</span><span class="op" id="6287498">)</span><span class="op" id="6287499">-</span><span class="num" id="6287500">1</span><span class="op" id="6287501">]</span><span class="op" id="6287502">,</span>&nbsp;<span class="ident" id="6287504">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6287509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6287513">//&nbsp;If&nbsp;we&nbsp;stopped&nbsp;for&nbsp;a&nbsp;syntax&nbsp;error,&nbsp;consume&nbsp;the&nbsp;whole&nbsp;file&nbsp;so&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6287582">//&nbsp;we&nbsp;are&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;change&nbsp;the&nbsp;errors&nbsp;that&nbsp;go/parser&nbsp;returns.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6287649">if</span>&nbsp;<span class="ident" id="6287652">r</span><span class="op" id="6287653">.</span><span class="ident" id="6287654">err</span>&nbsp;<span class="op" id="6287658">==</span>&nbsp;<span class="ident" id="6287661">errSyntax</span>&nbsp;<span class="op" id="6287671">&amp;&amp;</span>&nbsp;<span class="op" id="6287674">!</span><span class="ident" id="6287675">reportSyntaxError</span>&nbsp;<span class="op" id="6287693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6287697">r</span><span class="op" id="6287698">.</span><span class="ident" id="6287699">err</span>&nbsp;<span class="op" id="6287703">=</span>&nbsp;<span class="ident" id="6287705">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6287711">for</span>&nbsp;<span class="ident" id="6287715">r</span><span class="op" id="6287716">.</span><span class="ident" id="6287717">err</span>&nbsp;<span class="op" id="6287721">==</span>&nbsp;<span class="ident" id="6287724">nil</span>&nbsp;<span class="op" id="6287728">&amp;&amp;</span>&nbsp;<span class="op" id="6287731">!</span><span class="ident" id="6287732">r</span><span class="op" id="6287733">.</span><span class="ident" id="6287734">eof</span>&nbsp;<span class="op" id="6287738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6287743">r</span><span class="op" id="6287744">.</span><span class="ident" id="6287745">readByte</span><span class="op" id="6287753">(</span><span class="op" id="6287754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6287758">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6287761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6287765">return</span>&nbsp;<span class="ident" id="6287772">r</span><span class="op" id="6287773">.</span><span class="ident" id="6287774">buf</span><span class="op" id="6287777">,</span>&nbsp;<span class="ident" id="6287779">r</span><span class="op" id="6287780">.</span><span class="ident" id="6287781">err</span><br>
<span class="lineno"></span><span class="op" id="6287785">}</span>
</div>
</body>
</html>
