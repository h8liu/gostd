<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>unicode</h2>
<ul>
<li><a href="/gostd/unicode/casetables.go.html">casetables.go</a></li>
<li><a href="/gostd/unicode/digit.go.html">digit.go</a></li>
<li><a href="/gostd/unicode/digit_test.go.html">digit_test.go</a></li>
<li><a href="/gostd/unicode/graphic.go.html">graphic.go</a></li>
<li><a href="/gostd/unicode/graphic_test.go.html">graphic_test.go</a></li>
<li><a href="/gostd/unicode/letter.go.html" class="current">letter.go</a></li>
<li><a href="/gostd/unicode/letter_test.go.html">letter_test.go</a></li>
<li><a href="/gostd/unicode/script_test.go.html">script_test.go</a></li>
<li><a href="/gostd/unicode/tables.go.html">tables.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1817881">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1817936">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1817990">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1818041">//&nbsp;Package&nbsp;unicode&nbsp;provides&nbsp;data&nbsp;and&nbsp;functions&nbsp;to&nbsp;test&nbsp;some&nbsp;properties&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1818115">//&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="keyword" id="1818139">package</span>&nbsp;<span class="ident" id="1818147">unicode</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1818156">//&nbsp;Tables&nbsp;are&nbsp;regenerated&nbsp;each&nbsp;time&nbsp;we&nbsp;update&nbsp;the&nbsp;Unicode&nbsp;version.</span><br>
<span class="lineno">10</span><span class="comment" id="1818223">//go:generate&nbsp;go&nbsp;run&nbsp;maketables.go&nbsp;-tables=all&nbsp;-output&nbsp;tables.go</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1818289">const</span>&nbsp;<span class="op" id="1818295">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1818298">MaxRune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1818314">=</span>&nbsp;<span class="string" id="1818316">&#39;\U0010FFFF&#39;</span>&nbsp;<span class="comment" id="1818329">//&nbsp;Maximum&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1818367">ReplacementChar</span>&nbsp;<span class="op" id="1818383">=</span>&nbsp;<span class="string" id="1818385">&#39;\uFFFD&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1818398">//&nbsp;Represents&nbsp;invalid&nbsp;code&nbsp;points.</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1818434">MaxASCII</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1818450">=</span>&nbsp;<span class="string" id="1818452">&#39;\u007F&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1818465">//&nbsp;maximum&nbsp;ASCII&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1818490">MaxLatin1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1818506">=</span>&nbsp;<span class="string" id="1818508">&#39;\u00FF&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1818521">//&nbsp;maximum&nbsp;Latin-1&nbsp;value.</span><br>
<span class="lineno"></span><span class="op" id="1818547">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1818550">//&nbsp;RangeTable&nbsp;defines&nbsp;a&nbsp;set&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;by&nbsp;listing&nbsp;the&nbsp;ranges&nbsp;of</span><br>
<span class="lineno">20</span><span class="comment" id="1818626">//&nbsp;code&nbsp;points&nbsp;within&nbsp;the&nbsp;set.&nbsp;The&nbsp;ranges&nbsp;are&nbsp;listed&nbsp;in&nbsp;two&nbsp;slices</span><br>
<span class="lineno"></span><span class="comment" id="1818693">//&nbsp;to&nbsp;save&nbsp;space:&nbsp;a&nbsp;slice&nbsp;of&nbsp;16-bit&nbsp;ranges&nbsp;and&nbsp;a&nbsp;slice&nbsp;of&nbsp;32-bit&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="comment" id="1818766">//&nbsp;The&nbsp;two&nbsp;slices&nbsp;must&nbsp;be&nbsp;in&nbsp;sorted&nbsp;order&nbsp;and&nbsp;non-overlapping.</span><br>
<span class="lineno"></span><span class="comment" id="1818829">//&nbsp;Also,&nbsp;R32&nbsp;should&nbsp;contain&nbsp;only&nbsp;values&nbsp;&gt;=&nbsp;0x10000&nbsp;(1&lt;&lt;16).</span><br>
<span class="lineno"></span><span class="keyword" id="1818889">type</span>&nbsp;<span class="ident" id="1818894">RangeTable</span>&nbsp;<span class="keyword" id="1818905">struct</span>&nbsp;<span class="op" id="1818912">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1818915">R16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1818927">[</span><span class="op" id="1818928">]</span><span class="ident" id="1818929">Range16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1818938">R32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1818950">[</span><span class="op" id="1818951">]</span><span class="ident" id="1818952">Range32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1818961">LatinOffset</span>&nbsp;<span class="builtintype" id="1818973">int</span>&nbsp;<span class="comment" id="1818977">//&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;R16&nbsp;with&nbsp;Hi&nbsp;&lt;=&nbsp;MaxLatin1</span><br>
<span class="lineno"></span><span class="op" id="1819026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="1819029">//&nbsp;Range16&nbsp;represents&nbsp;of&nbsp;a&nbsp;range&nbsp;of&nbsp;16-bit&nbsp;Unicode&nbsp;code&nbsp;points.&nbsp;&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi</span><br>
<span class="lineno"></span><span class="comment" id="1819123">//&nbsp;inclusive&nbsp;and&nbsp;has&nbsp;the&nbsp;specified&nbsp;stride.</span><br>
<span class="lineno"></span><span class="keyword" id="1819166">type</span>&nbsp;<span class="ident" id="1819171">Range16</span>&nbsp;<span class="keyword" id="1819179">struct</span>&nbsp;<span class="op" id="1819186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1819189">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1819196">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1819204">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1819211">uint16</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1819219">Stride</span>&nbsp;<span class="builtintype" id="1819226">uint16</span><br>
<span class="lineno"></span><span class="op" id="1819233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1819236">//&nbsp;Range32&nbsp;represents&nbsp;of&nbsp;a&nbsp;range&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;and&nbsp;is&nbsp;used&nbsp;when&nbsp;one&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1819316">//&nbsp;more&nbsp;of&nbsp;the&nbsp;values&nbsp;will&nbsp;not&nbsp;fit&nbsp;in&nbsp;16&nbsp;bits.&nbsp;&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi</span><br>
<span class="lineno">40</span><span class="comment" id="1819393">//&nbsp;inclusive&nbsp;and&nbsp;has&nbsp;the&nbsp;specified&nbsp;stride.&nbsp;Lo&nbsp;and&nbsp;Hi&nbsp;must&nbsp;always&nbsp;be&nbsp;&gt;=&nbsp;1&lt;&lt;16.</span><br>
<span class="lineno"></span><span class="keyword" id="1819471">type</span>&nbsp;<span class="ident" id="1819476">Range32</span>&nbsp;<span class="keyword" id="1819484">struct</span>&nbsp;<span class="op" id="1819491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1819494">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1819501">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1819509">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1819516">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1819524">Stride</span>&nbsp;<span class="builtintype" id="1819531">uint32</span><br>
<span class="lineno">45</span><span class="op" id="1819538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1819541">//&nbsp;CaseRange&nbsp;represents&nbsp;a&nbsp;range&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;for&nbsp;simple&nbsp;(one</span><br>
<span class="lineno"></span><span class="comment" id="1819612">//&nbsp;code&nbsp;point&nbsp;to&nbsp;one&nbsp;code&nbsp;point)&nbsp;case&nbsp;conversion.</span><br>
<span class="lineno"></span><span class="comment" id="1819662">//&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi&nbsp;inclusive,&nbsp;with&nbsp;a&nbsp;fixed&nbsp;stride&nbsp;of&nbsp;1.&nbsp;&nbsp;Deltas</span><br>
<span class="lineno">50</span><span class="comment" id="1819739">//&nbsp;are&nbsp;the&nbsp;number&nbsp;to&nbsp;add&nbsp;to&nbsp;the&nbsp;code&nbsp;point&nbsp;to&nbsp;reach&nbsp;the&nbsp;code&nbsp;point&nbsp;for&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="1819812">//&nbsp;different&nbsp;case&nbsp;for&nbsp;that&nbsp;character.&nbsp;&nbsp;They&nbsp;may&nbsp;be&nbsp;negative.&nbsp;&nbsp;If&nbsp;zero,&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="1819886">//&nbsp;means&nbsp;the&nbsp;character&nbsp;is&nbsp;in&nbsp;the&nbsp;corresponding&nbsp;case.&nbsp;There&nbsp;is&nbsp;a&nbsp;special</span><br>
<span class="lineno"></span><span class="comment" id="1819958">//&nbsp;case&nbsp;representing&nbsp;sequences&nbsp;of&nbsp;alternating&nbsp;corresponding&nbsp;Upper&nbsp;and&nbsp;Lower</span><br>
<span class="lineno"></span><span class="comment" id="1820034">//&nbsp;pairs.&nbsp;&nbsp;It&nbsp;appears&nbsp;with&nbsp;a&nbsp;fixed&nbsp;Delta&nbsp;of</span><br>
<span class="lineno">55</span><span class="comment" id="1820078">//&nbsp;&nbsp;&nbsp;&nbsp{UpperLower,&nbsp;UpperLower,&nbsp;UpperLower}</span><br>
<span class="lineno"></span><span class="comment" id="1820118">//&nbsp;The&nbsp;constant&nbsp;UpperLower&nbsp;has&nbsp;an&nbsp;otherwise&nbsp;impossible&nbsp;delta&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="1820186">type</span>&nbsp;<span class="ident" id="1820191">CaseRange</span>&nbsp;<span class="keyword" id="1820201">struct</span>&nbsp;<span class="op" id="1820208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1820211">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1820217">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1820225">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1820231">uint32</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1820239">Delta</span>&nbsp;<span class="ident" id="1820245">d</span><br>
<span class="lineno"></span><span class="op" id="1820247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1820250">//&nbsp;SpecialCase&nbsp;represents&nbsp;language-specific&nbsp;case&nbsp;mappings&nbsp;such&nbsp;as&nbsp;Turkish.</span><br>
<span class="lineno"></span><span class="comment" id="1820325">//&nbsp;Methods&nbsp;of&nbsp;SpecialCase&nbsp;customize&nbsp;(by&nbsp;overriding)&nbsp;the&nbsp;standard&nbsp;mappings.</span><br>
<span class="lineno">65</span><span class="keyword" id="1820400">type</span>&nbsp;<span class="ident" id="1820405">SpecialCase</span>&nbsp;<span class="op" id="1820417">[</span><span class="op" id="1820418">]</span><span class="ident" id="1820419">CaseRange</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1820430">//&nbsp;BUG(r):&nbsp;There&nbsp;is&nbsp;no&nbsp;mechanism&nbsp;for&nbsp;full&nbsp;case&nbsp;folding,&nbsp;that&nbsp;is,&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="1820499">//&nbsp;characters&nbsp;that&nbsp;involve&nbsp;multiple&nbsp;runes&nbsp;in&nbsp;the&nbsp;input&nbsp;or&nbsp;output.</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="1820566">//&nbsp;Indices&nbsp;into&nbsp;the&nbsp;Delta&nbsp;arrays&nbsp;inside&nbsp;CaseRanges&nbsp;for&nbsp;case&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1820635">const</span>&nbsp;<span class="op" id="1820641">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1820644">UpperCase</span>&nbsp;<span class="op" id="1820654">=</span>&nbsp;<span class="ident" id="1820656">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1820662">LowerCase</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1820673">TitleCase</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1820684">MaxCase</span><br>
<span class="lineno"></span><span class="op" id="1820692">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1820695">type</span>&nbsp;<span class="ident" id="1820700">d</span>&nbsp;<span class="op" id="1820702">[</span><span class="ident" id="1820703">MaxCase</span><span class="op" id="1820710">]</span><span class="builtintype" id="1820711">rune</span>&nbsp;<span class="comment" id="1820716">//&nbsp;to&nbsp;make&nbsp;the&nbsp;CaseRanges&nbsp;text&nbsp;shorter</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="1820756">//&nbsp;If&nbsp;the&nbsp;Delta&nbsp;field&nbsp;of&nbsp;a&nbsp;CaseRange&nbsp;is&nbsp;UpperLower,&nbsp;it&nbsp;means</span><br>
<span class="lineno"></span><span class="comment" id="1820817">//&nbsp;this&nbsp;CaseRange&nbsp;represents&nbsp;a&nbsp;sequence&nbsp;of&nbsp;the&nbsp;form&nbsp;(say)</span><br>
<span class="lineno"></span><span class="comment" id="1820875">//&nbsp;Upper&nbsp;Lower&nbsp;Upper&nbsp;Lower.</span><br>
<span class="lineno"></span><span class="keyword" id="1820903">const</span>&nbsp;<span class="op" id="1820909">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1820912">UpperLower</span>&nbsp;<span class="op" id="1820923">=</span>&nbsp;<span class="ident" id="1820925">MaxRune</span>&nbsp;<span class="op" id="1820933">+</span>&nbsp;<span class="num" id="1820935">1</span>&nbsp;<span class="comment" id="1820937">//&nbsp;(Cannot&nbsp;be&nbsp;a&nbsp;valid&nbsp;delta.)</span><br>
<span class="lineno">85</span><span class="op" id="1820967">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1820970">//&nbsp;linearMax&nbsp;is&nbsp;the&nbsp;maximum&nbsp;size&nbsp;table&nbsp;for&nbsp;linear&nbsp;search&nbsp;for&nbsp;non-Latin1&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="1821048">//&nbsp;Derived&nbsp;by&nbsp;running&nbsp;&#39;go&nbsp;test&nbsp;-calibrate&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="1821092">const</span>&nbsp;<span class="ident" id="1821098">linearMax</span>&nbsp;<span class="op" id="1821108">=</span>&nbsp;<span class="num" id="1821110">18</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="1821114">//&nbsp;is16&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;in&nbsp;the&nbsp;sorted&nbsp;slice&nbsp;of&nbsp;16-bit&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="keyword" id="1821181">func</span>&nbsp;<span class="ident" id="1821186">is16</span><span class="op" id="1821190">(</span><span class="ident" id="1821191">ranges</span>&nbsp;<span class="op" id="1821198">[</span><span class="op" id="1821199">]</span><span class="ident" id="1821200">Range16</span><span class="op" id="1821207">,</span>&nbsp;<span class="ident" id="1821209">r</span>&nbsp;<span class="builtintype" id="1821211">uint16</span><span class="op" id="1821217">)</span>&nbsp;<span class="builtintype" id="1821219">bool</span>&nbsp;<span class="op" id="1821224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1821227">if</span>&nbsp;<span class="builtinfunc" id="1821230">len</span><span class="op" id="1821233">(</span><span class="ident" id="1821234">ranges</span><span class="op" id="1821240">)</span>&nbsp;<span class="op" id="1821242">&lt;=</span>&nbsp;<span class="ident" id="1821245">linearMax</span>&nbsp;<span class="op" id="1821255">||</span>&nbsp;<span class="ident" id="1821258">r</span>&nbsp;<span class="op" id="1821260">&lt;=</span>&nbsp;<span class="ident" id="1821263">MaxLatin1</span>&nbsp;<span class="op" id="1821273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1821277">for</span>&nbsp;<span class="ident" id="1821281">i</span>&nbsp;<span class="op" id="1821283">:=</span>&nbsp;<span class="keyword" id="1821286">range</span>&nbsp;<span class="ident" id="1821292">ranges</span>&nbsp;<span class="op" id="1821299">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1821304">range_</span>&nbsp;<span class="op" id="1821311">:=</span>&nbsp;<span class="op" id="1821314">&amp;</span><span class="ident" id="1821315">ranges</span><span class="op" id="1821321">[</span><span class="ident" id="1821322">i</span><span class="op" id="1821323">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1821328">if</span>&nbsp;<span class="ident" id="1821331">r</span>&nbsp;<span class="op" id="1821333">&lt;</span>&nbsp;<span class="ident" id="1821335">range_</span><span class="op" id="1821341">.</span><span class="ident" id="1821342">Lo</span>&nbsp;<span class="op" id="1821345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1821351">return</span>&nbsp;<span class="builtintype" id="1821358">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1821367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1821372">if</span>&nbsp;<span class="ident" id="1821375">r</span>&nbsp;<span class="op" id="1821377">&lt;=</span>&nbsp;<span class="ident" id="1821380">range_</span><span class="op" id="1821386">.</span><span class="ident" id="1821387">Hi</span>&nbsp;<span class="op" id="1821390">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1821396">return</span>&nbsp;<span class="op" id="1821403">(</span><span class="ident" id="1821404">r</span><span class="op" id="1821405">-</span><span class="ident" id="1821406">range_</span><span class="op" id="1821412">.</span><span class="ident" id="1821413">Lo</span><span class="op" id="1821415">)</span><span class="op" id="1821416">%</span><span class="ident" id="1821417">range_</span><span class="op" id="1821423">.</span><span class="ident" id="1821424">Stride</span>&nbsp;<span class="op" id="1821431">==</span>&nbsp;<span class="num" id="1821434">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1821439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1821443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1821447">return</span>&nbsp;<span class="builtintype" id="1821454">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1821461">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1821465">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1821495">lo</span>&nbsp;<span class="op" id="1821498">:=</span>&nbsp;<span class="num" id="1821501">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1821504">hi</span>&nbsp;<span class="op" id="1821507">:=</span>&nbsp;<span class="builtinfunc" id="1821510">len</span><span class="op" id="1821513">(</span><span class="ident" id="1821514">ranges</span><span class="op" id="1821520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1821523">for</span>&nbsp;<span class="ident" id="1821527">lo</span>&nbsp;<span class="op" id="1821530">&lt;</span>&nbsp;<span class="ident" id="1821532">hi</span>&nbsp;<span class="op" id="1821535">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1821539">m</span>&nbsp;<span class="op" id="1821541">:=</span>&nbsp;<span class="ident" id="1821544">lo</span>&nbsp;<span class="op" id="1821547">+</span>&nbsp;<span class="op" id="1821549">(</span><span class="ident" id="1821550">hi</span><span class="op" id="1821552">-</span><span class="ident" id="1821553">lo</span><span class="op" id="1821555">)</span><span class="op" id="1821556">/</span><span class="num" id="1821557">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1821561">range_</span>&nbsp;<span class="op" id="1821568">:=</span>&nbsp;<span class="op" id="1821571">&amp;</span><span class="ident" id="1821572">ranges</span><span class="op" id="1821578">[</span><span class="ident" id="1821579">m</span><span class="op" id="1821580">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1821584">if</span>&nbsp;<span class="ident" id="1821587">range_</span><span class="op" id="1821593">.</span><span class="ident" id="1821594">Lo</span>&nbsp;<span class="op" id="1821597">&lt;=</span>&nbsp;<span class="ident" id="1821600">r</span>&nbsp;<span class="op" id="1821602">&amp;&amp;</span>&nbsp;<span class="ident" id="1821605">r</span>&nbsp;<span class="op" id="1821607">&lt;=</span>&nbsp;<span class="ident" id="1821610">range_</span><span class="op" id="1821616">.</span><span class="ident" id="1821617">Hi</span>&nbsp;<span class="op" id="1821620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1821625">return</span>&nbsp;<span class="op" id="1821632">(</span><span class="ident" id="1821633">r</span><span class="op" id="1821634">-</span><span class="ident" id="1821635">range_</span><span class="op" id="1821641">.</span><span class="ident" id="1821642">Lo</span><span class="op" id="1821644">)</span><span class="op" id="1821645">%</span><span class="ident" id="1821646">range_</span><span class="op" id="1821652">.</span><span class="ident" id="1821653">Stride</span>&nbsp;<span class="op" id="1821660">==</span>&nbsp;<span class="num" id="1821663">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1821667">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1821671">if</span>&nbsp;<span class="ident" id="1821674">r</span>&nbsp;<span class="op" id="1821676">&lt;</span>&nbsp;<span class="ident" id="1821678">range_</span><span class="op" id="1821684">.</span><span class="ident" id="1821685">Lo</span>&nbsp;<span class="op" id="1821688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1821693">hi</span>&nbsp;<span class="op" id="1821696">=</span>&nbsp;<span class="ident" id="1821698">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1821702">}</span>&nbsp;<span class="keyword" id="1821704">else</span>&nbsp;<span class="op" id="1821709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1821714">lo</span>&nbsp;<span class="op" id="1821717">=</span>&nbsp;<span class="ident" id="1821719">m</span>&nbsp;<span class="op" id="1821721">+</span>&nbsp;<span class="num" id="1821723">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1821727">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1821730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1821733">return</span>&nbsp;<span class="builtintype" id="1821740">false</span><br>
<span class="lineno"></span><span class="op" id="1821746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1821749">//&nbsp;is32&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;in&nbsp;the&nbsp;sorted&nbsp;slice&nbsp;of&nbsp;32-bit&nbsp;ranges.</span><br>
<span class="lineno">125</span><span class="keyword" id="1821816">func</span>&nbsp;<span class="ident" id="1821821">is32</span><span class="op" id="1821825">(</span><span class="ident" id="1821826">ranges</span>&nbsp;<span class="op" id="1821833">[</span><span class="op" id="1821834">]</span><span class="ident" id="1821835">Range32</span><span class="op" id="1821842">,</span>&nbsp;<span class="ident" id="1821844">r</span>&nbsp;<span class="builtintype" id="1821846">uint32</span><span class="op" id="1821852">)</span>&nbsp;<span class="builtintype" id="1821854">bool</span>&nbsp;<span class="op" id="1821859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1821862">if</span>&nbsp;<span class="builtinfunc" id="1821865">len</span><span class="op" id="1821868">(</span><span class="ident" id="1821869">ranges</span><span class="op" id="1821875">)</span>&nbsp;<span class="op" id="1821877">&lt;=</span>&nbsp;<span class="ident" id="1821880">linearMax</span>&nbsp;<span class="op" id="1821890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1821894">for</span>&nbsp;<span class="ident" id="1821898">i</span>&nbsp;<span class="op" id="1821900">:=</span>&nbsp;<span class="keyword" id="1821903">range</span>&nbsp;<span class="ident" id="1821909">ranges</span>&nbsp;<span class="op" id="1821916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1821921">range_</span>&nbsp;<span class="op" id="1821928">:=</span>&nbsp;<span class="op" id="1821931">&amp;</span><span class="ident" id="1821932">ranges</span><span class="op" id="1821938">[</span><span class="ident" id="1821939">i</span><span class="op" id="1821940">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1821945">if</span>&nbsp;<span class="ident" id="1821948">r</span>&nbsp;<span class="op" id="1821950">&lt;</span>&nbsp;<span class="ident" id="1821952">range_</span><span class="op" id="1821958">.</span><span class="ident" id="1821959">Lo</span>&nbsp;<span class="op" id="1821962">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1821968">return</span>&nbsp;<span class="builtintype" id="1821975">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1821984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1821989">if</span>&nbsp;<span class="ident" id="1821992">r</span>&nbsp;<span class="op" id="1821994">&lt;=</span>&nbsp;<span class="ident" id="1821997">range_</span><span class="op" id="1822003">.</span><span class="ident" id="1822004">Hi</span>&nbsp;<span class="op" id="1822007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1822013">return</span>&nbsp;<span class="op" id="1822020">(</span><span class="ident" id="1822021">r</span><span class="op" id="1822022">-</span><span class="ident" id="1822023">range_</span><span class="op" id="1822029">.</span><span class="ident" id="1822030">Lo</span><span class="op" id="1822032">)</span><span class="op" id="1822033">%</span><span class="ident" id="1822034">range_</span><span class="op" id="1822040">.</span><span class="ident" id="1822041">Stride</span>&nbsp;<span class="op" id="1822048">==</span>&nbsp;<span class="num" id="1822051">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1822056">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1822060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1822064">return</span>&nbsp;<span class="builtintype" id="1822071">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1822078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1822082">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1822112">lo</span>&nbsp;<span class="op" id="1822115">:=</span>&nbsp;<span class="num" id="1822118">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1822121">hi</span>&nbsp;<span class="op" id="1822124">:=</span>&nbsp;<span class="builtinfunc" id="1822127">len</span><span class="op" id="1822130">(</span><span class="ident" id="1822131">ranges</span><span class="op" id="1822137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1822140">for</span>&nbsp;<span class="ident" id="1822144">lo</span>&nbsp;<span class="op" id="1822147">&lt;</span>&nbsp;<span class="ident" id="1822149">hi</span>&nbsp;<span class="op" id="1822152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1822156">m</span>&nbsp;<span class="op" id="1822158">:=</span>&nbsp;<span class="ident" id="1822161">lo</span>&nbsp;<span class="op" id="1822164">+</span>&nbsp;<span class="op" id="1822166">(</span><span class="ident" id="1822167">hi</span><span class="op" id="1822169">-</span><span class="ident" id="1822170">lo</span><span class="op" id="1822172">)</span><span class="op" id="1822173">/</span><span class="num" id="1822174">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1822178">range_</span>&nbsp;<span class="op" id="1822185">:=</span>&nbsp;<span class="ident" id="1822188">ranges</span><span class="op" id="1822194">[</span><span class="ident" id="1822195">m</span><span class="op" id="1822196">]</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1822200">if</span>&nbsp;<span class="ident" id="1822203">range_</span><span class="op" id="1822209">.</span><span class="ident" id="1822210">Lo</span>&nbsp;<span class="op" id="1822213">&lt;=</span>&nbsp;<span class="ident" id="1822216">r</span>&nbsp;<span class="op" id="1822218">&amp;&amp;</span>&nbsp;<span class="ident" id="1822221">r</span>&nbsp;<span class="op" id="1822223">&lt;=</span>&nbsp;<span class="ident" id="1822226">range_</span><span class="op" id="1822232">.</span><span class="ident" id="1822233">Hi</span>&nbsp;<span class="op" id="1822236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1822241">return</span>&nbsp;<span class="op" id="1822248">(</span><span class="ident" id="1822249">r</span><span class="op" id="1822250">-</span><span class="ident" id="1822251">range_</span><span class="op" id="1822257">.</span><span class="ident" id="1822258">Lo</span><span class="op" id="1822260">)</span><span class="op" id="1822261">%</span><span class="ident" id="1822262">range_</span><span class="op" id="1822268">.</span><span class="ident" id="1822269">Stride</span>&nbsp;<span class="op" id="1822276">==</span>&nbsp;<span class="num" id="1822279">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1822283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1822287">if</span>&nbsp;<span class="ident" id="1822290">r</span>&nbsp;<span class="op" id="1822292">&lt;</span>&nbsp;<span class="ident" id="1822294">range_</span><span class="op" id="1822300">.</span><span class="ident" id="1822301">Lo</span>&nbsp;<span class="op" id="1822304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1822309">hi</span>&nbsp;<span class="op" id="1822312">=</span>&nbsp;<span class="ident" id="1822314">m</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1822318">}</span>&nbsp;<span class="keyword" id="1822320">else</span>&nbsp;<span class="op" id="1822325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1822330">lo</span>&nbsp;<span class="op" id="1822333">=</span>&nbsp;<span class="ident" id="1822335">m</span>&nbsp;<span class="op" id="1822337">+</span>&nbsp;<span class="num" id="1822339">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1822343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1822346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1822349">return</span>&nbsp;<span class="builtintype" id="1822356">false</span><br>
<span class="lineno">155</span><span class="op" id="1822362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1822365">//&nbsp;Is&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;in&nbsp;the&nbsp;specified&nbsp;table&nbsp;of&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="keyword" id="1822433">func</span>&nbsp;<span class="ident" id="1822438">Is</span><span class="op" id="1822440">(</span><span class="ident" id="1822441">rangeTab</span>&nbsp;<span class="op" id="1822450">*</span><span class="ident" id="1822451">RangeTable</span><span class="op" id="1822461">,</span>&nbsp;<span class="ident" id="1822463">r</span>&nbsp;<span class="builtintype" id="1822465">rune</span><span class="op" id="1822469">)</span>&nbsp;<span class="builtintype" id="1822471">bool</span>&nbsp;<span class="op" id="1822476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1822479">r16</span>&nbsp;<span class="op" id="1822483">:=</span>&nbsp;<span class="ident" id="1822486">rangeTab</span><span class="op" id="1822494">.</span><span class="ident" id="1822495">R16</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1822500">if</span>&nbsp;<span class="builtinfunc" id="1822503">len</span><span class="op" id="1822506">(</span><span class="ident" id="1822507">r16</span><span class="op" id="1822510">)</span>&nbsp;<span class="op" id="1822512">&gt;</span>&nbsp;<span class="num" id="1822514">0</span>&nbsp;<span class="op" id="1822516">&amp;&amp;</span>&nbsp;<span class="ident" id="1822519">r</span>&nbsp;<span class="op" id="1822521">&lt;=</span>&nbsp;<span class="builtintype" id="1822524">rune</span><span class="op" id="1822528">(</span><span class="ident" id="1822529">r16</span><span class="op" id="1822532">[</span><span class="builtinfunc" id="1822533">len</span><span class="op" id="1822536">(</span><span class="ident" id="1822537">r16</span><span class="op" id="1822540">)</span><span class="op" id="1822541">-</span><span class="num" id="1822542">1</span><span class="op" id="1822543">]</span><span class="op" id="1822544">.</span><span class="ident" id="1822545">Hi</span><span class="op" id="1822547">)</span>&nbsp;<span class="op" id="1822549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1822553">return</span>&nbsp;<span class="ident" id="1822560">is16</span><span class="op" id="1822564">(</span><span class="ident" id="1822565">r16</span><span class="op" id="1822568">,</span>&nbsp;<span class="builtintype" id="1822570">uint16</span><span class="op" id="1822576">(</span><span class="ident" id="1822577">r</span><span class="op" id="1822578">)</span><span class="op" id="1822579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1822582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1822585">r32</span>&nbsp;<span class="op" id="1822589">:=</span>&nbsp;<span class="ident" id="1822592">rangeTab</span><span class="op" id="1822600">.</span><span class="ident" id="1822601">R32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1822606">if</span>&nbsp;<span class="builtinfunc" id="1822609">len</span><span class="op" id="1822612">(</span><span class="ident" id="1822613">r32</span><span class="op" id="1822616">)</span>&nbsp;<span class="op" id="1822618">&gt;</span>&nbsp;<span class="num" id="1822620">0</span>&nbsp;<span class="op" id="1822622">&amp;&amp;</span>&nbsp;<span class="ident" id="1822625">r</span>&nbsp;<span class="op" id="1822627">&gt;=</span>&nbsp;<span class="builtintype" id="1822630">rune</span><span class="op" id="1822634">(</span><span class="ident" id="1822635">r32</span><span class="op" id="1822638">[</span><span class="num" id="1822639">0</span><span class="op" id="1822640">]</span><span class="op" id="1822641">.</span><span class="ident" id="1822642">Lo</span><span class="op" id="1822644">)</span>&nbsp;<span class="op" id="1822646">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1822650">return</span>&nbsp;<span class="ident" id="1822657">is32</span><span class="op" id="1822661">(</span><span class="ident" id="1822662">r32</span><span class="op" id="1822665">,</span>&nbsp;<span class="builtintype" id="1822667">uint32</span><span class="op" id="1822673">(</span><span class="ident" id="1822674">r</span><span class="op" id="1822675">)</span><span class="op" id="1822676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1822679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1822682">return</span>&nbsp;<span class="builtintype" id="1822689">false</span><br>
<span class="lineno"></span><span class="op" id="1822695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="1822698">func</span>&nbsp;<span class="ident" id="1822703">isExcludingLatin</span><span class="op" id="1822719">(</span><span class="ident" id="1822720">rangeTab</span>&nbsp;<span class="op" id="1822729">*</span><span class="ident" id="1822730">RangeTable</span><span class="op" id="1822740">,</span>&nbsp;<span class="ident" id="1822742">r</span>&nbsp;<span class="builtintype" id="1822744">rune</span><span class="op" id="1822748">)</span>&nbsp;<span class="builtintype" id="1822750">bool</span>&nbsp;<span class="op" id="1822755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1822758">r16</span>&nbsp;<span class="op" id="1822762">:=</span>&nbsp;<span class="ident" id="1822765">rangeTab</span><span class="op" id="1822773">.</span><span class="ident" id="1822774">R16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1822779">if</span>&nbsp;<span class="ident" id="1822782">off</span>&nbsp;<span class="op" id="1822786">:=</span>&nbsp;<span class="ident" id="1822789">rangeTab</span><span class="op" id="1822797">.</span><span class="ident" id="1822798">LatinOffset</span><span class="op" id="1822809">;</span>&nbsp;<span class="builtinfunc" id="1822811">len</span><span class="op" id="1822814">(</span><span class="ident" id="1822815">r16</span><span class="op" id="1822818">)</span>&nbsp;<span class="op" id="1822820">&gt;</span>&nbsp;<span class="ident" id="1822822">off</span>&nbsp;<span class="op" id="1822826">&amp;&amp;</span>&nbsp;<span class="ident" id="1822829">r</span>&nbsp;<span class="op" id="1822831">&lt;=</span>&nbsp;<span class="builtintype" id="1822834">rune</span><span class="op" id="1822838">(</span><span class="ident" id="1822839">r16</span><span class="op" id="1822842">[</span><span class="builtinfunc" id="1822843">len</span><span class="op" id="1822846">(</span><span class="ident" id="1822847">r16</span><span class="op" id="1822850">)</span><span class="op" id="1822851">-</span><span class="num" id="1822852">1</span><span class="op" id="1822853">]</span><span class="op" id="1822854">.</span><span class="ident" id="1822855">Hi</span><span class="op" id="1822857">)</span>&nbsp;<span class="op" id="1822859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1822863">return</span>&nbsp;<span class="ident" id="1822870">is16</span><span class="op" id="1822874">(</span><span class="ident" id="1822875">r16</span><span class="op" id="1822878">[</span><span class="ident" id="1822879">off</span><span class="op" id="1822882">:</span><span class="op" id="1822883">]</span><span class="op" id="1822884">,</span>&nbsp;<span class="builtintype" id="1822886">uint16</span><span class="op" id="1822892">(</span><span class="ident" id="1822893">r</span><span class="op" id="1822894">)</span><span class="op" id="1822895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1822898">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1822901">r32</span>&nbsp;<span class="op" id="1822905">:=</span>&nbsp;<span class="ident" id="1822908">rangeTab</span><span class="op" id="1822916">.</span><span class="ident" id="1822917">R32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1822922">if</span>&nbsp;<span class="builtinfunc" id="1822925">len</span><span class="op" id="1822928">(</span><span class="ident" id="1822929">r32</span><span class="op" id="1822932">)</span>&nbsp;<span class="op" id="1822934">&gt;</span>&nbsp;<span class="num" id="1822936">0</span>&nbsp;<span class="op" id="1822938">&amp;&amp;</span>&nbsp;<span class="ident" id="1822941">r</span>&nbsp;<span class="op" id="1822943">&gt;=</span>&nbsp;<span class="builtintype" id="1822946">rune</span><span class="op" id="1822950">(</span><span class="ident" id="1822951">r32</span><span class="op" id="1822954">[</span><span class="num" id="1822955">0</span><span class="op" id="1822956">]</span><span class="op" id="1822957">.</span><span class="ident" id="1822958">Lo</span><span class="op" id="1822960">)</span>&nbsp;<span class="op" id="1822962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1822966">return</span>&nbsp;<span class="ident" id="1822973">is32</span><span class="op" id="1822977">(</span><span class="ident" id="1822978">r32</span><span class="op" id="1822981">,</span>&nbsp;<span class="builtintype" id="1822983">uint32</span><span class="op" id="1822989">(</span><span class="ident" id="1822990">r</span><span class="op" id="1822991">)</span><span class="op" id="1822992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1822995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1822998">return</span>&nbsp;<span class="builtintype" id="1823005">false</span><br>
<span class="lineno">180</span><span class="op" id="1823011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1823014">//&nbsp;IsUpper&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;an&nbsp;upper&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="1823075">func</span>&nbsp;<span class="ident" id="1823080">IsUpper</span><span class="op" id="1823087">(</span><span class="ident" id="1823088">r</span>&nbsp;<span class="builtintype" id="1823090">rune</span><span class="op" id="1823094">)</span>&nbsp;<span class="builtintype" id="1823096">bool</span>&nbsp;<span class="op" id="1823101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1823104">//&nbsp;See&nbsp;comment&nbsp;in&nbsp;IsGraphic.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1823134">if</span>&nbsp;<span class="builtintype" id="1823137">uint32</span><span class="op" id="1823143">(</span><span class="ident" id="1823144">r</span><span class="op" id="1823145">)</span>&nbsp;<span class="op" id="1823147">&lt;=</span>&nbsp;<span class="ident" id="1823150">MaxLatin1</span>&nbsp;<span class="op" id="1823160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1823164">return</span>&nbsp;<span class="ident" id="1823171">properties</span><span class="op" id="1823181">[</span><span class="builtintype" id="1823182">uint8</span><span class="op" id="1823187">(</span><span class="ident" id="1823188">r</span><span class="op" id="1823189">)</span><span class="op" id="1823190">]</span><span class="op" id="1823191">&amp;</span><span class="ident" id="1823192">pLmask</span>&nbsp;<span class="op" id="1823199">==</span>&nbsp;<span class="ident" id="1823202">pLu</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1823207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1823210">return</span>&nbsp;<span class="ident" id="1823217">isExcludingLatin</span><span class="op" id="1823233">(</span><span class="ident" id="1823234">Upper</span><span class="op" id="1823239">,</span>&nbsp;<span class="ident" id="1823241">r</span><span class="op" id="1823242">)</span><br>
<span class="lineno"></span><span class="op" id="1823244">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="1823247">//&nbsp;IsLower&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;a&nbsp;lower&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="1823307">func</span>&nbsp;<span class="ident" id="1823312">IsLower</span><span class="op" id="1823319">(</span><span class="ident" id="1823320">r</span>&nbsp;<span class="builtintype" id="1823322">rune</span><span class="op" id="1823326">)</span>&nbsp;<span class="builtintype" id="1823328">bool</span>&nbsp;<span class="op" id="1823333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1823336">//&nbsp;See&nbsp;comment&nbsp;in&nbsp;IsGraphic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1823366">if</span>&nbsp;<span class="builtintype" id="1823369">uint32</span><span class="op" id="1823375">(</span><span class="ident" id="1823376">r</span><span class="op" id="1823377">)</span>&nbsp;<span class="op" id="1823379">&lt;=</span>&nbsp;<span class="ident" id="1823382">MaxLatin1</span>&nbsp;<span class="op" id="1823392">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1823396">return</span>&nbsp;<span class="ident" id="1823403">properties</span><span class="op" id="1823413">[</span><span class="builtintype" id="1823414">uint8</span><span class="op" id="1823419">(</span><span class="ident" id="1823420">r</span><span class="op" id="1823421">)</span><span class="op" id="1823422">]</span><span class="op" id="1823423">&amp;</span><span class="ident" id="1823424">pLmask</span>&nbsp;<span class="op" id="1823431">==</span>&nbsp;<span class="ident" id="1823434">pLl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1823439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1823442">return</span>&nbsp;<span class="ident" id="1823449">isExcludingLatin</span><span class="op" id="1823465">(</span><span class="ident" id="1823466">Lower</span><span class="op" id="1823471">,</span>&nbsp;<span class="ident" id="1823473">r</span><span class="op" id="1823474">)</span><br>
<span class="lineno"></span><span class="op" id="1823476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="comment" id="1823479">//&nbsp;IsTitle&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;a&nbsp;title&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="1823539">func</span>&nbsp;<span class="ident" id="1823544">IsTitle</span><span class="op" id="1823551">(</span><span class="ident" id="1823552">r</span>&nbsp;<span class="builtintype" id="1823554">rune</span><span class="op" id="1823558">)</span>&nbsp;<span class="builtintype" id="1823560">bool</span>&nbsp;<span class="op" id="1823565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1823568">if</span>&nbsp;<span class="ident" id="1823571">r</span>&nbsp;<span class="op" id="1823573">&lt;=</span>&nbsp;<span class="ident" id="1823576">MaxLatin1</span>&nbsp;<span class="op" id="1823586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1823590">return</span>&nbsp;<span class="builtintype" id="1823597">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1823604">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1823607">return</span>&nbsp;<span class="ident" id="1823614">isExcludingLatin</span><span class="op" id="1823630">(</span><span class="ident" id="1823631">Title</span><span class="op" id="1823636">,</span>&nbsp;<span class="ident" id="1823638">r</span><span class="op" id="1823639">)</span><br>
<span class="lineno"></span><span class="op" id="1823641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1823644">//&nbsp;to&nbsp;maps&nbsp;the&nbsp;rune&nbsp;using&nbsp;the&nbsp;specified&nbsp;case&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1823698">func</span>&nbsp;<span class="ident" id="1823703">to</span><span class="op" id="1823705">(</span><span class="ident" id="1823706">_case</span>&nbsp;<span class="builtintype" id="1823712">int</span><span class="op" id="1823715">,</span>&nbsp;<span class="ident" id="1823717">r</span>&nbsp;<span class="builtintype" id="1823719">rune</span><span class="op" id="1823723">,</span>&nbsp;<span class="ident" id="1823725">caseRange</span>&nbsp;<span class="op" id="1823735">[</span><span class="op" id="1823736">]</span><span class="ident" id="1823737">CaseRange</span><span class="op" id="1823746">)</span>&nbsp;<span class="builtintype" id="1823748">rune</span>&nbsp;<span class="op" id="1823753">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1823756">if</span>&nbsp;<span class="ident" id="1823759">_case</span>&nbsp;<span class="op" id="1823765">&lt;</span>&nbsp;<span class="num" id="1823767">0</span>&nbsp;<span class="op" id="1823769">||</span>&nbsp;<span class="ident" id="1823772">MaxCase</span>&nbsp;<span class="op" id="1823780">&lt;=</span>&nbsp;<span class="ident" id="1823783">_case</span>&nbsp;<span class="op" id="1823789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1823793">return</span>&nbsp;<span class="ident" id="1823800">ReplacementChar</span>&nbsp;<span class="comment" id="1823816">//&nbsp;as&nbsp;reasonable&nbsp;an&nbsp;error&nbsp;as&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1823850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1823853">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1823883">lo</span>&nbsp;<span class="op" id="1823886">:=</span>&nbsp;<span class="num" id="1823889">0</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1823892">hi</span>&nbsp;<span class="op" id="1823895">:=</span>&nbsp;<span class="builtinfunc" id="1823898">len</span><span class="op" id="1823901">(</span><span class="ident" id="1823902">caseRange</span><span class="op" id="1823911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1823914">for</span>&nbsp;<span class="ident" id="1823918">lo</span>&nbsp;<span class="op" id="1823921">&lt;</span>&nbsp;<span class="ident" id="1823923">hi</span>&nbsp;<span class="op" id="1823926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1823930">m</span>&nbsp;<span class="op" id="1823932">:=</span>&nbsp;<span class="ident" id="1823935">lo</span>&nbsp;<span class="op" id="1823938">+</span>&nbsp;<span class="op" id="1823940">(</span><span class="ident" id="1823941">hi</span><span class="op" id="1823943">-</span><span class="ident" id="1823944">lo</span><span class="op" id="1823946">)</span><span class="op" id="1823947">/</span><span class="num" id="1823948">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1823952">cr</span>&nbsp;<span class="op" id="1823955">:=</span>&nbsp;<span class="ident" id="1823958">caseRange</span><span class="op" id="1823967">[</span><span class="ident" id="1823968">m</span><span class="op" id="1823969">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1823973">if</span>&nbsp;<span class="builtintype" id="1823976">rune</span><span class="op" id="1823980">(</span><span class="ident" id="1823981">cr</span><span class="op" id="1823983">.</span><span class="ident" id="1823984">Lo</span><span class="op" id="1823986">)</span>&nbsp;<span class="op" id="1823988">&lt;=</span>&nbsp;<span class="ident" id="1823991">r</span>&nbsp;<span class="op" id="1823993">&amp;&amp;</span>&nbsp;<span class="ident" id="1823996">r</span>&nbsp;<span class="op" id="1823998">&lt;=</span>&nbsp;<span class="builtintype" id="1824001">rune</span><span class="op" id="1824005">(</span><span class="ident" id="1824006">cr</span><span class="op" id="1824008">.</span><span class="ident" id="1824009">Hi</span><span class="op" id="1824011">)</span>&nbsp;<span class="op" id="1824013">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1824018">delta</span>&nbsp;<span class="op" id="1824024">:=</span>&nbsp;<span class="builtintype" id="1824027">rune</span><span class="op" id="1824031">(</span><span class="ident" id="1824032">cr</span><span class="op" id="1824034">.</span><span class="ident" id="1824035">Delta</span><span class="op" id="1824040">[</span><span class="ident" id="1824041">_case</span><span class="op" id="1824046">]</span><span class="op" id="1824047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1824052">if</span>&nbsp;<span class="ident" id="1824055">delta</span>&nbsp;<span class="op" id="1824061">&gt;</span>&nbsp;<span class="ident" id="1824063">MaxRune</span>&nbsp;<span class="op" id="1824071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1824077">//&nbsp;In&nbsp;an&nbsp;Upper-Lower&nbsp;sequence,&nbsp;which&nbsp;always&nbsp;starts&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1824137">//&nbsp;an&nbsp;UpperCase&nbsp;letter,&nbsp;the&nbsp;real&nbsp;deltas&nbsp;always&nbsp;look&nbsp;like:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1824199">//&nbsp;&nbsp;&nbsp;&nbsp{0,&nbsp;1,&nbsp;0}&nbsp;&nbsp;&nbsp;&nbsp;UpperCase&nbsp;(Lower&nbsp;is&nbsp;next)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1824245">//&nbsp;&nbsp;&nbsp;&nbsp{-1,&nbsp;0,&nbsp;-1}&nbsp;&nbsp;LowerCase&nbsp;(Upper,&nbsp;Title&nbsp;are&nbsp;previous)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1824303">//&nbsp;The&nbsp;characters&nbsp;at&nbsp;even&nbsp;offsets&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1824367">//&nbsp;sequence&nbsp;are&nbsp;upper&nbsp;case;&nbsp;the&nbsp;ones&nbsp;at&nbsp;odd&nbsp;offsets&nbsp;are&nbsp;lower.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1824434">//&nbsp;The&nbsp;correct&nbsp;mapping&nbsp;can&nbsp;be&nbsp;done&nbsp;by&nbsp;clearing&nbsp;or&nbsp;setting&nbsp;the&nbsp;low</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1824504">//&nbsp;bit&nbsp;in&nbsp;the&nbsp;sequence&nbsp;offset.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1824539">//&nbsp;The&nbsp;constants&nbsp;UpperCase&nbsp;and&nbsp;TitleCase&nbsp;are&nbsp;even&nbsp;while&nbsp;LowerCase</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1824609">//&nbsp;is&nbsp;odd&nbsp;so&nbsp;we&nbsp;take&nbsp;the&nbsp;low&nbsp;bit&nbsp;from&nbsp;_case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1824658">return</span>&nbsp;<span class="builtintype" id="1824665">rune</span><span class="op" id="1824669">(</span><span class="ident" id="1824670">cr</span><span class="op" id="1824672">.</span><span class="ident" id="1824673">Lo</span><span class="op" id="1824675">)</span>&nbsp;<span class="op" id="1824677">+</span>&nbsp;<span class="op" id="1824679">(</span><span class="op" id="1824680">(</span><span class="ident" id="1824681">r</span><span class="op" id="1824682">-</span><span class="builtintype" id="1824683">rune</span><span class="op" id="1824687">(</span><span class="ident" id="1824688">cr</span><span class="op" id="1824690">.</span><span class="ident" id="1824691">Lo</span><span class="op" id="1824693">)</span><span class="op" id="1824694">)</span><span class="op" id="1824695">&amp;^</span><span class="num" id="1824697">1</span>&nbsp;<span class="op" id="1824699">|</span>&nbsp;<span class="builtintype" id="1824701">rune</span><span class="op" id="1824705">(</span><span class="ident" id="1824706">_case</span><span class="op" id="1824711">&amp;</span><span class="num" id="1824712">1</span><span class="op" id="1824713">)</span><span class="op" id="1824714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1824719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1824724">return</span>&nbsp;<span class="ident" id="1824731">r</span>&nbsp;<span class="op" id="1824733">+</span>&nbsp;<span class="ident" id="1824735">delta</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1824743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1824747">if</span>&nbsp;<span class="ident" id="1824750">r</span>&nbsp;<span class="op" id="1824752">&lt;</span>&nbsp;<span class="builtintype" id="1824754">rune</span><span class="op" id="1824758">(</span><span class="ident" id="1824759">cr</span><span class="op" id="1824761">.</span><span class="ident" id="1824762">Lo</span><span class="op" id="1824764">)</span>&nbsp;<span class="op" id="1824766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1824771">hi</span>&nbsp;<span class="op" id="1824774">=</span>&nbsp;<span class="ident" id="1824776">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1824780">}</span>&nbsp;<span class="keyword" id="1824782">else</span>&nbsp;<span class="op" id="1824787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1824792">lo</span>&nbsp;<span class="op" id="1824795">=</span>&nbsp;<span class="ident" id="1824797">m</span>&nbsp;<span class="op" id="1824799">+</span>&nbsp;<span class="num" id="1824801">1</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1824805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1824808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1824811">return</span>&nbsp;<span class="ident" id="1824818">r</span><br>
<span class="lineno"></span><span class="op" id="1824820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="1824823">//&nbsp;To&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;the&nbsp;specified&nbsp;case:&nbsp;UpperCase,&nbsp;LowerCase,&nbsp;or&nbsp;TitleCase.</span><br>
<span class="lineno"></span><span class="keyword" id="1824902">func</span>&nbsp;<span class="ident" id="1824907">To</span><span class="op" id="1824909">(</span><span class="ident" id="1824910">_case</span>&nbsp;<span class="builtintype" id="1824916">int</span><span class="op" id="1824919">,</span>&nbsp;<span class="ident" id="1824921">r</span>&nbsp;<span class="builtintype" id="1824923">rune</span><span class="op" id="1824927">)</span>&nbsp;<span class="builtintype" id="1824929">rune</span>&nbsp;<span class="op" id="1824934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1824937">return</span>&nbsp;<span class="ident" id="1824944">to</span><span class="op" id="1824946">(</span><span class="ident" id="1824947">_case</span><span class="op" id="1824952">,</span>&nbsp;<span class="ident" id="1824954">r</span><span class="op" id="1824955">,</span>&nbsp;<span class="ident" id="1824957">CaseRanges</span><span class="op" id="1824967">)</span><br>
<span class="lineno"></span><span class="op" id="1824969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="1824972">//&nbsp;ToUpper&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;upper&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1825012">func</span>&nbsp;<span class="ident" id="1825017">ToUpper</span><span class="op" id="1825024">(</span><span class="ident" id="1825025">r</span>&nbsp;<span class="builtintype" id="1825027">rune</span><span class="op" id="1825031">)</span>&nbsp;<span class="builtintype" id="1825033">rune</span>&nbsp;<span class="op" id="1825038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1825041">if</span>&nbsp;<span class="ident" id="1825044">r</span>&nbsp;<span class="op" id="1825046">&lt;=</span>&nbsp;<span class="ident" id="1825049">MaxASCII</span>&nbsp;<span class="op" id="1825058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1825062">if</span>&nbsp;<span class="string" id="1825065">&#39;a&#39;</span>&nbsp;<span class="op" id="1825069">&lt;=</span>&nbsp;<span class="ident" id="1825072">r</span>&nbsp;<span class="op" id="1825074">&amp;&amp;</span>&nbsp;<span class="ident" id="1825077">r</span>&nbsp;<span class="op" id="1825079">&lt;=</span>&nbsp;<span class="string" id="1825082">&#39;z&#39;</span>&nbsp;<span class="op" id="1825086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1825091">r</span>&nbsp;<span class="op" id="1825093">-=</span>&nbsp;<span class="string" id="1825096">&#39;a&#39;</span>&nbsp;<span class="op" id="1825100">-</span>&nbsp;<span class="string" id="1825102">&#39;A&#39;</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1825108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1825112">return</span>&nbsp;<span class="ident" id="1825119">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1825122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1825125">return</span>&nbsp;<span class="ident" id="1825132">To</span><span class="op" id="1825134">(</span><span class="ident" id="1825135">UpperCase</span><span class="op" id="1825144">,</span>&nbsp;<span class="ident" id="1825146">r</span><span class="op" id="1825147">)</span><br>
<span class="lineno"></span><span class="op" id="1825149">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="comment" id="1825152">//&nbsp;ToLower&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1825192">func</span>&nbsp;<span class="ident" id="1825197">ToLower</span><span class="op" id="1825204">(</span><span class="ident" id="1825205">r</span>&nbsp;<span class="builtintype" id="1825207">rune</span><span class="op" id="1825211">)</span>&nbsp;<span class="builtintype" id="1825213">rune</span>&nbsp;<span class="op" id="1825218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1825221">if</span>&nbsp;<span class="ident" id="1825224">r</span>&nbsp;<span class="op" id="1825226">&lt;=</span>&nbsp;<span class="ident" id="1825229">MaxASCII</span>&nbsp;<span class="op" id="1825238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1825242">if</span>&nbsp;<span class="string" id="1825245">&#39;A&#39;</span>&nbsp;<span class="op" id="1825249">&lt;=</span>&nbsp;<span class="ident" id="1825252">r</span>&nbsp;<span class="op" id="1825254">&amp;&amp;</span>&nbsp;<span class="ident" id="1825257">r</span>&nbsp;<span class="op" id="1825259">&lt;=</span>&nbsp;<span class="string" id="1825262">&#39;Z&#39;</span>&nbsp;<span class="op" id="1825266">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1825271">r</span>&nbsp;<span class="op" id="1825273">+=</span>&nbsp;<span class="string" id="1825276">&#39;a&#39;</span>&nbsp;<span class="op" id="1825280">-</span>&nbsp;<span class="string" id="1825282">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1825288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1825292">return</span>&nbsp;<span class="ident" id="1825299">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1825302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1825305">return</span>&nbsp;<span class="ident" id="1825312">To</span><span class="op" id="1825314">(</span><span class="ident" id="1825315">LowerCase</span><span class="op" id="1825324">,</span>&nbsp;<span class="ident" id="1825326">r</span><span class="op" id="1825327">)</span><br>
<span class="lineno">270</span><span class="op" id="1825329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1825332">//&nbsp;ToTitle&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1825372">func</span>&nbsp;<span class="ident" id="1825377">ToTitle</span><span class="op" id="1825384">(</span><span class="ident" id="1825385">r</span>&nbsp;<span class="builtintype" id="1825387">rune</span><span class="op" id="1825391">)</span>&nbsp;<span class="builtintype" id="1825393">rune</span>&nbsp;<span class="op" id="1825398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1825401">if</span>&nbsp;<span class="ident" id="1825404">r</span>&nbsp;<span class="op" id="1825406">&lt;=</span>&nbsp;<span class="ident" id="1825409">MaxASCII</span>&nbsp;<span class="op" id="1825418">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1825422">if</span>&nbsp;<span class="string" id="1825425">&#39;a&#39;</span>&nbsp;<span class="op" id="1825429">&lt;=</span>&nbsp;<span class="ident" id="1825432">r</span>&nbsp;<span class="op" id="1825434">&amp;&amp;</span>&nbsp;<span class="ident" id="1825437">r</span>&nbsp;<span class="op" id="1825439">&lt;=</span>&nbsp;<span class="string" id="1825442">&#39;z&#39;</span>&nbsp;<span class="op" id="1825446">{</span>&nbsp;<span class="comment" id="1825448">//&nbsp;title&nbsp;case&nbsp;is&nbsp;upper&nbsp;case&nbsp;for&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1825489">r</span>&nbsp;<span class="op" id="1825491">-=</span>&nbsp;<span class="string" id="1825494">&#39;a&#39;</span>&nbsp;<span class="op" id="1825498">-</span>&nbsp;<span class="string" id="1825500">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1825506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1825510">return</span>&nbsp;<span class="ident" id="1825517">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1825520">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1825523">return</span>&nbsp;<span class="ident" id="1825530">To</span><span class="op" id="1825532">(</span><span class="ident" id="1825533">TitleCase</span><span class="op" id="1825542">,</span>&nbsp;<span class="ident" id="1825544">r</span><span class="op" id="1825545">)</span><br>
<span class="lineno"></span><span class="op" id="1825547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1825550">//&nbsp;ToUpper&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;upper&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1825629">func</span>&nbsp;<span class="op" id="1825634">(</span><span class="ident" id="1825635">special</span>&nbsp;<span class="ident" id="1825643">SpecialCase</span><span class="op" id="1825654">)</span>&nbsp;<span class="ident" id="1825656">ToUpper</span><span class="op" id="1825663">(</span><span class="ident" id="1825664">r</span>&nbsp;<span class="builtintype" id="1825666">rune</span><span class="op" id="1825670">)</span>&nbsp;<span class="builtintype" id="1825672">rune</span>&nbsp;<span class="op" id="1825677">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1825680">r1</span>&nbsp;<span class="op" id="1825683">:=</span>&nbsp;<span class="ident" id="1825686">to</span><span class="op" id="1825688">(</span><span class="ident" id="1825689">UpperCase</span><span class="op" id="1825698">,</span>&nbsp;<span class="ident" id="1825700">r</span><span class="op" id="1825701">,</span>&nbsp;<span class="op" id="1825703">[</span><span class="op" id="1825704">]</span><span class="ident" id="1825705">CaseRange</span><span class="op" id="1825714">(</span><span class="ident" id="1825715">special</span><span class="op" id="1825722">)</span><span class="op" id="1825723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1825726">if</span>&nbsp;<span class="ident" id="1825729">r1</span>&nbsp;<span class="op" id="1825732">==</span>&nbsp;<span class="ident" id="1825735">r</span>&nbsp;<span class="op" id="1825737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1825741">r1</span>&nbsp;<span class="op" id="1825744">=</span>&nbsp;<span class="ident" id="1825746">ToUpper</span><span class="op" id="1825753">(</span><span class="ident" id="1825754">r</span><span class="op" id="1825755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1825758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1825761">return</span>&nbsp;<span class="ident" id="1825768">r1</span><br>
<span class="lineno">290</span><span class="op" id="1825771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1825774">//&nbsp;ToTitle&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;title&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1825853">func</span>&nbsp;<span class="op" id="1825858">(</span><span class="ident" id="1825859">special</span>&nbsp;<span class="ident" id="1825867">SpecialCase</span><span class="op" id="1825878">)</span>&nbsp;<span class="ident" id="1825880">ToTitle</span><span class="op" id="1825887">(</span><span class="ident" id="1825888">r</span>&nbsp;<span class="builtintype" id="1825890">rune</span><span class="op" id="1825894">)</span>&nbsp;<span class="builtintype" id="1825896">rune</span>&nbsp;<span class="op" id="1825901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1825904">r1</span>&nbsp;<span class="op" id="1825907">:=</span>&nbsp;<span class="ident" id="1825910">to</span><span class="op" id="1825912">(</span><span class="ident" id="1825913">TitleCase</span><span class="op" id="1825922">,</span>&nbsp;<span class="ident" id="1825924">r</span><span class="op" id="1825925">,</span>&nbsp;<span class="op" id="1825927">[</span><span class="op" id="1825928">]</span><span class="ident" id="1825929">CaseRange</span><span class="op" id="1825938">(</span><span class="ident" id="1825939">special</span><span class="op" id="1825946">)</span><span class="op" id="1825947">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1825950">if</span>&nbsp;<span class="ident" id="1825953">r1</span>&nbsp;<span class="op" id="1825956">==</span>&nbsp;<span class="ident" id="1825959">r</span>&nbsp;<span class="op" id="1825961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1825965">r1</span>&nbsp;<span class="op" id="1825968">=</span>&nbsp;<span class="ident" id="1825970">ToTitle</span><span class="op" id="1825977">(</span><span class="ident" id="1825978">r</span><span class="op" id="1825979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1825982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1825985">return</span>&nbsp;<span class="ident" id="1825992">r1</span><br>
<span class="lineno"></span><span class="op" id="1825995">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="1825998">//&nbsp;ToLower&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;lower&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1826077">func</span>&nbsp;<span class="op" id="1826082">(</span><span class="ident" id="1826083">special</span>&nbsp;<span class="ident" id="1826091">SpecialCase</span><span class="op" id="1826102">)</span>&nbsp;<span class="ident" id="1826104">ToLower</span><span class="op" id="1826111">(</span><span class="ident" id="1826112">r</span>&nbsp;<span class="builtintype" id="1826114">rune</span><span class="op" id="1826118">)</span>&nbsp;<span class="builtintype" id="1826120">rune</span>&nbsp;<span class="op" id="1826125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1826128">r1</span>&nbsp;<span class="op" id="1826131">:=</span>&nbsp;<span class="ident" id="1826134">to</span><span class="op" id="1826136">(</span><span class="ident" id="1826137">LowerCase</span><span class="op" id="1826146">,</span>&nbsp;<span class="ident" id="1826148">r</span><span class="op" id="1826149">,</span>&nbsp;<span class="op" id="1826151">[</span><span class="op" id="1826152">]</span><span class="ident" id="1826153">CaseRange</span><span class="op" id="1826162">(</span><span class="ident" id="1826163">special</span><span class="op" id="1826170">)</span><span class="op" id="1826171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1826174">if</span>&nbsp;<span class="ident" id="1826177">r1</span>&nbsp;<span class="op" id="1826180">==</span>&nbsp;<span class="ident" id="1826183">r</span>&nbsp;<span class="op" id="1826185">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1826189">r1</span>&nbsp;<span class="op" id="1826192">=</span>&nbsp;<span class="ident" id="1826194">ToLower</span><span class="op" id="1826201">(</span><span class="ident" id="1826202">r</span><span class="op" id="1826203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1826206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1826209">return</span>&nbsp;<span class="ident" id="1826216">r1</span><br>
<span class="lineno"></span><span class="op" id="1826219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="1826222">//&nbsp;caseOrbit&nbsp;is&nbsp;defined&nbsp;in&nbsp;tables.go&nbsp;as&nbsp;[]foldPair.&nbsp;&nbsp;Right&nbsp;now&nbsp;all&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1826293">//&nbsp;entries&nbsp;fit&nbsp;in&nbsp;uint16,&nbsp;so&nbsp;use&nbsp;uint16.&nbsp;&nbsp;If&nbsp;that&nbsp;changes,&nbsp;compilation</span><br>
<span class="lineno"></span><span class="comment" id="1826364">//&nbsp;will&nbsp;fail&nbsp;(the&nbsp;constants&nbsp;in&nbsp;the&nbsp;composite&nbsp;literal&nbsp;will&nbsp;not&nbsp;fit&nbsp;in&nbsp;uint16)</span><br>
<span class="lineno"></span><span class="comment" id="1826441">//&nbsp;and&nbsp;the&nbsp;types&nbsp;here&nbsp;can&nbsp;change&nbsp;to&nbsp;uint32.</span><br>
<span class="lineno"></span><span class="keyword" id="1826485">type</span>&nbsp;<span class="ident" id="1826490">foldPair</span>&nbsp;<span class="keyword" id="1826499">struct</span>&nbsp;<span class="op" id="1826506">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1826509">From</span>&nbsp;<span class="builtintype" id="1826514">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1826522">To</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1826527">uint16</span><br>
<span class="lineno"></span><span class="op" id="1826534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1826537">//&nbsp;SimpleFold&nbsp;iterates&nbsp;over&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;equivalent&nbsp;under</span><br>
<span class="lineno">320</span><span class="comment" id="1826602">//&nbsp;the&nbsp;Unicode-defined&nbsp;simple&nbsp;case&nbsp;folding.&nbsp;&nbsp;Among&nbsp;the&nbsp;code&nbsp;points</span><br>
<span class="lineno"></span><span class="comment" id="1826669">//&nbsp;equivalent&nbsp;to&nbsp;rune&nbsp;(including&nbsp;rune&nbsp;itself),&nbsp;SimpleFold&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1826739">//&nbsp;smallest&nbsp;rune&nbsp;&gt;&nbsp;r&nbsp;if&nbsp;one&nbsp;exists,&nbsp;or&nbsp;else&nbsp;the&nbsp;smallest&nbsp;rune&nbsp;&gt;=&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="1826807">//</span><br>
<span class="lineno"></span><span class="comment" id="1826810">//&nbsp;For&nbsp;example:</span><br>
<span class="lineno">325</span><span class="comment" id="1826826">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;A&#39;)&nbsp;=&nbsp;&#39;a&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1826851">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;a&#39;)&nbsp;=&nbsp;&#39;A&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1826876">//</span><br>
<span class="lineno"></span><span class="comment" id="1826879">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;K&#39;)&nbsp;=&nbsp;&#39;k&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1826904">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;k&#39;)&nbsp;=&nbsp;&#39;\u212A&#39;&nbsp;(Kelvin&nbsp;symbol,&nbsp;)</span><br>
<span class="lineno">330</span><span class="comment" id="1826955">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;\u212A&#39;)&nbsp;=&nbsp;&#39;K&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1826985">//</span><br>
<span class="lineno"></span><span class="comment" id="1826988">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;1&#39;)&nbsp;=&nbsp;&#39;1&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1827013">//</span><br>
<span class="lineno"></span><span class="keyword" id="1827016">func</span>&nbsp;<span class="ident" id="1827021">SimpleFold</span><span class="op" id="1827031">(</span><span class="ident" id="1827032">r</span>&nbsp;<span class="builtintype" id="1827034">rune</span><span class="op" id="1827038">)</span>&nbsp;<span class="builtintype" id="1827040">rune</span>&nbsp;<span class="op" id="1827045">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1827048">//&nbsp;Consult&nbsp;caseOrbit&nbsp;table&nbsp;for&nbsp;special&nbsp;cases.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1827095">lo</span>&nbsp;<span class="op" id="1827098">:=</span>&nbsp;<span class="num" id="1827101">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1827104">hi</span>&nbsp;<span class="op" id="1827107">:=</span>&nbsp;<span class="builtinfunc" id="1827110">len</span><span class="op" id="1827113">(</span><span class="ident" id="1827114">caseOrbit</span><span class="op" id="1827123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1827126">for</span>&nbsp;<span class="ident" id="1827130">lo</span>&nbsp;<span class="op" id="1827133">&lt;</span>&nbsp;<span class="ident" id="1827135">hi</span>&nbsp;<span class="op" id="1827138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1827142">m</span>&nbsp;<span class="op" id="1827144">:=</span>&nbsp;<span class="ident" id="1827147">lo</span>&nbsp;<span class="op" id="1827150">+</span>&nbsp;<span class="op" id="1827152">(</span><span class="ident" id="1827153">hi</span><span class="op" id="1827155">-</span><span class="ident" id="1827156">lo</span><span class="op" id="1827158">)</span><span class="op" id="1827159">/</span><span class="num" id="1827160">2</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1827164">if</span>&nbsp;<span class="builtintype" id="1827167">rune</span><span class="op" id="1827171">(</span><span class="ident" id="1827172">caseOrbit</span><span class="op" id="1827181">[</span><span class="ident" id="1827182">m</span><span class="op" id="1827183">]</span><span class="op" id="1827184">.</span><span class="ident" id="1827185">From</span><span class="op" id="1827189">)</span>&nbsp;<span class="op" id="1827191">&lt;</span>&nbsp;<span class="ident" id="1827193">r</span>&nbsp;<span class="op" id="1827195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1827200">lo</span>&nbsp;<span class="op" id="1827203">=</span>&nbsp;<span class="ident" id="1827205">m</span>&nbsp;<span class="op" id="1827207">+</span>&nbsp;<span class="num" id="1827209">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1827213">}</span>&nbsp;<span class="keyword" id="1827215">else</span>&nbsp;<span class="op" id="1827220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1827225">hi</span>&nbsp;<span class="op" id="1827228">=</span>&nbsp;<span class="ident" id="1827230">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1827234">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1827237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1827240">if</span>&nbsp;<span class="ident" id="1827243">lo</span>&nbsp;<span class="op" id="1827246">&lt;</span>&nbsp;<span class="builtinfunc" id="1827248">len</span><span class="op" id="1827251">(</span><span class="ident" id="1827252">caseOrbit</span><span class="op" id="1827261">)</span>&nbsp;<span class="op" id="1827263">&amp;&amp;</span>&nbsp;<span class="builtintype" id="1827266">rune</span><span class="op" id="1827270">(</span><span class="ident" id="1827271">caseOrbit</span><span class="op" id="1827280">[</span><span class="ident" id="1827281">lo</span><span class="op" id="1827283">]</span><span class="op" id="1827284">.</span><span class="ident" id="1827285">From</span><span class="op" id="1827289">)</span>&nbsp;<span class="op" id="1827291">==</span>&nbsp;<span class="ident" id="1827294">r</span>&nbsp;<span class="op" id="1827296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1827300">return</span>&nbsp;<span class="builtintype" id="1827307">rune</span><span class="op" id="1827311">(</span><span class="ident" id="1827312">caseOrbit</span><span class="op" id="1827321">[</span><span class="ident" id="1827322">lo</span><span class="op" id="1827324">]</span><span class="op" id="1827325">.</span><span class="ident" id="1827326">To</span><span class="op" id="1827328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1827331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1827335">//&nbsp;No&nbsp;folding&nbsp;specified.&nbsp;&nbsp;This&nbsp;is&nbsp;a&nbsp;one-&nbsp;or&nbsp;two-element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1827392">//&nbsp;equivalence&nbsp;class&nbsp;containing&nbsp;rune&nbsp;and&nbsp;ToLower(rune)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1827448">//&nbsp;and&nbsp;ToUpper(rune)&nbsp;if&nbsp;they&nbsp;are&nbsp;different&nbsp;from&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1827503">if</span>&nbsp;<span class="ident" id="1827506">l</span>&nbsp;<span class="op" id="1827508">:=</span>&nbsp;<span class="ident" id="1827511">ToLower</span><span class="op" id="1827518">(</span><span class="ident" id="1827519">r</span><span class="op" id="1827520">)</span><span class="op" id="1827521">;</span>&nbsp;<span class="ident" id="1827523">l</span>&nbsp;<span class="op" id="1827525">!=</span>&nbsp;<span class="ident" id="1827528">r</span>&nbsp;<span class="op" id="1827530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1827534">return</span>&nbsp;<span class="ident" id="1827541">l</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1827544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1827547">return</span>&nbsp;<span class="ident" id="1827554">ToUpper</span><span class="op" id="1827561">(</span><span class="ident" id="1827562">r</span><span class="op" id="1827563">)</span><br>
<span class="lineno"></span><span class="op" id="1827565">}</span>
</div>
</body>
</html>
