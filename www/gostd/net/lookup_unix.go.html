<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3244071">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3244127">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3244181">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3244232">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3244297">package</span>&nbsp;<span class="ident" id="3244305">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3244310">import</span>&nbsp;<span class="op" id="3244317">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3244320">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3244330">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="3244337">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3244340">var</span>&nbsp;<span class="ident" id="3244344">onceReadProtocols</span>&nbsp;<span class="ident" id="3244362">sync</span><span class="op" id="3244366">.</span><span class="ident" id="3244367">Once</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3244373">//&nbsp;readProtocols&nbsp;loads&nbsp;contents&nbsp;of&nbsp;/etc/protocols&nbsp;into&nbsp;protocols&nbsp;map</span><br>
<span class="lineno"></span><span class="comment" id="3244442">//&nbsp;for&nbsp;quick&nbsp;access.</span><br>
<span class="lineno"></span><span class="keyword" id="3244463">func</span>&nbsp;<span class="ident" id="3244468">readProtocols</span><span class="op" id="3244481">(</span><span class="op" id="3244482">)</span>&nbsp;<span class="op" id="3244484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3244487">if</span>&nbsp;<span class="ident" id="3244490">file</span><span class="op" id="3244494">,</span>&nbsp;<span class="ident" id="3244496">err</span>&nbsp;<span class="op" id="3244500">:=</span>&nbsp;<span class="ident" id="3244503">open</span><span class="op" id="3244507">(</span><span class="string" id="3244508">&#34;/etc/protocols&#34;</span><span class="op" id="3244524">)</span><span class="op" id="3244525">;</span>&nbsp;<span class="ident" id="3244527">err</span>&nbsp;<span class="op" id="3244531">==</span>&nbsp;<span class="ident" id="3244534">nil</span>&nbsp;<span class="op" id="3244538">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3244542">for</span>&nbsp;<span class="ident" id="3244546">line</span><span class="op" id="3244550">,</span>&nbsp;<span class="ident" id="3244552">ok</span>&nbsp;<span class="op" id="3244555">:=</span>&nbsp;<span class="ident" id="3244558">file</span><span class="op" id="3244562">.</span><span class="ident" id="3244563">readLine</span><span class="op" id="3244571">(</span><span class="op" id="3244572">)</span><span class="op" id="3244573">;</span>&nbsp;<span class="ident" id="3244575">ok</span><span class="op" id="3244577">;</span>&nbsp;<span class="ident" id="3244579">line</span><span class="op" id="3244583">,</span>&nbsp;<span class="ident" id="3244585">ok</span>&nbsp;<span class="op" id="3244588">=</span>&nbsp;<span class="ident" id="3244590">file</span><span class="op" id="3244594">.</span><span class="ident" id="3244595">readLine</span><span class="op" id="3244603">(</span><span class="op" id="3244604">)</span>&nbsp;<span class="op" id="3244606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3244611">//&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;TCP&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;transmission&nbsp;control&nbsp;protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3244667">if</span>&nbsp;<span class="ident" id="3244670">i</span>&nbsp;<span class="op" id="3244672">:=</span>&nbsp;<span class="ident" id="3244675">byteIndex</span><span class="op" id="3244684">(</span><span class="ident" id="3244685">line</span><span class="op" id="3244689">,</span>&nbsp;<span class="string" id="3244691">&#39;#&#39;</span><span class="op" id="3244694">)</span><span class="op" id="3244695">;</span>&nbsp;<span class="ident" id="3244697">i</span>&nbsp;<span class="op" id="3244699">&gt;=</span>&nbsp;<span class="num" id="3244702">0</span>&nbsp;<span class="op" id="3244704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3244710">line</span>&nbsp;<span class="op" id="3244715">=</span>&nbsp;<span class="ident" id="3244717">line</span><span class="op" id="3244721">[</span><span class="num" id="3244722">0</span><span class="op" id="3244723">:</span><span class="ident" id="3244724">i</span><span class="op" id="3244725">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3244730">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3244735">f</span>&nbsp;<span class="op" id="3244737">:=</span>&nbsp;<span class="ident" id="3244740">getFields</span><span class="op" id="3244749">(</span><span class="ident" id="3244750">line</span><span class="op" id="3244754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3244759">if</span>&nbsp;<span class="builtinfunc" id="3244762">len</span><span class="op" id="3244765">(</span><span class="ident" id="3244766">f</span><span class="op" id="3244767">)</span>&nbsp;<span class="op" id="3244769">&lt;</span>&nbsp;<span class="num" id="3244771">2</span>&nbsp;<span class="op" id="3244773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3244779">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3244791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3244796">if</span>&nbsp;<span class="ident" id="3244799">proto</span><span class="op" id="3244804">,</span>&nbsp;<span class="ident" id="3244806">_</span><span class="op" id="3244807">,</span>&nbsp;<span class="ident" id="3244809">ok</span>&nbsp;<span class="op" id="3244812">:=</span>&nbsp;<span class="ident" id="3244815">dtoi</span><span class="op" id="3244819">(</span><span class="ident" id="3244820">f</span><span class="op" id="3244821">[</span><span class="num" id="3244822">1</span><span class="op" id="3244823">]</span><span class="op" id="3244824">,</span>&nbsp;<span class="num" id="3244826">0</span><span class="op" id="3244827">)</span><span class="op" id="3244828">;</span>&nbsp;<span class="ident" id="3244830">ok</span>&nbsp;<span class="op" id="3244833">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3244839">if</span>&nbsp;<span class="ident" id="3244842">_</span><span class="op" id="3244843">,</span>&nbsp;<span class="ident" id="3244845">ok</span>&nbsp;<span class="op" id="3244848">:=</span>&nbsp;<span class="ident" id="3244851">protocols</span><span class="op" id="3244860">[</span><span class="ident" id="3244861">f</span><span class="op" id="3244862">[</span><span class="num" id="3244863">0</span><span class="op" id="3244864">]</span><span class="op" id="3244865">]</span><span class="op" id="3244866">;</span>&nbsp;<span class="op" id="3244868">!</span><span class="ident" id="3244869">ok</span>&nbsp;<span class="op" id="3244872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3244879">protocols</span><span class="op" id="3244888">[</span><span class="ident" id="3244889">f</span><span class="op" id="3244890">[</span><span class="num" id="3244891">0</span><span class="op" id="3244892">]</span><span class="op" id="3244893">]</span>&nbsp;<span class="op" id="3244895">=</span>&nbsp;<span class="ident" id="3244897">proto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3244907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3244913">for</span>&nbsp;<span class="ident" id="3244917">_</span><span class="op" id="3244918">,</span>&nbsp;<span class="ident" id="3244920">alias</span>&nbsp;<span class="op" id="3244926">:=</span>&nbsp;<span class="keyword" id="3244929">range</span>&nbsp;<span class="ident" id="3244935">f</span><span class="op" id="3244936">[</span><span class="num" id="3244937">2</span><span class="op" id="3244938">:</span><span class="op" id="3244939">]</span>&nbsp;<span class="op" id="3244941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3244948">if</span>&nbsp;<span class="ident" id="3244951">_</span><span class="op" id="3244952">,</span>&nbsp;<span class="ident" id="3244954">ok</span>&nbsp;<span class="op" id="3244957">:=</span>&nbsp;<span class="ident" id="3244960">protocols</span><span class="op" id="3244969">[</span><span class="ident" id="3244970">alias</span><span class="op" id="3244975">]</span><span class="op" id="3244976">;</span>&nbsp;<span class="op" id="3244978">!</span><span class="ident" id="3244979">ok</span>&nbsp;<span class="op" id="3244982">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3244990">protocols</span><span class="op" id="3244999">[</span><span class="ident" id="3245000">alias</span><span class="op" id="3245005">]</span>&nbsp;<span class="op" id="3245007">=</span>&nbsp;<span class="ident" id="3245009">proto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3245020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3245026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3245031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3245035">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3245039">file</span><span class="op" id="3245043">.</span><span class="builtinfunc" id="3245044">close</span><span class="op" id="3245049">(</span><span class="op" id="3245050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3245053">}</span><br>
<span class="lineno"></span><span class="op" id="3245055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3245058">//&nbsp;lookupProtocol&nbsp;looks&nbsp;up&nbsp;IP&nbsp;protocol&nbsp;name&nbsp;in&nbsp;/etc/protocols&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="3245124">//&nbsp;returns&nbsp;correspondent&nbsp;protocol&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="3245166">func</span>&nbsp;<span class="ident" id="3245171">lookupProtocol</span><span class="op" id="3245185">(</span><span class="ident" id="3245186">name</span>&nbsp;<span class="builtintype" id="3245191">string</span><span class="op" id="3245197">)</span>&nbsp;<span class="op" id="3245199">(</span><span class="ident" id="3245200">proto</span>&nbsp;<span class="builtintype" id="3245206">int</span><span class="op" id="3245209">,</span>&nbsp;<span class="ident" id="3245211">err</span>&nbsp;<span class="builtintype" id="3245215">error</span><span class="op" id="3245220">)</span>&nbsp;<span class="op" id="3245222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3245225">onceReadProtocols</span><span class="op" id="3245242">.</span><span class="ident" id="3245243">Do</span><span class="op" id="3245245">(</span><span class="ident" id="3245246">readProtocols</span><span class="op" id="3245259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3245262">proto</span><span class="op" id="3245267">,</span>&nbsp;<span class="ident" id="3245269">found</span>&nbsp;<span class="op" id="3245275">:=</span>&nbsp;<span class="ident" id="3245278">protocols</span><span class="op" id="3245287">[</span><span class="ident" id="3245288">name</span><span class="op" id="3245292">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245295">if</span>&nbsp;<span class="op" id="3245298">!</span><span class="ident" id="3245299">found</span>&nbsp;<span class="op" id="3245305">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245309">return</span>&nbsp;<span class="num" id="3245316">0</span><span class="op" id="3245317">,</span>&nbsp;<span class="ident" id="3245319">errors</span><span class="op" id="3245325">.</span><span class="ident" id="3245326">New</span><span class="op" id="3245329">(</span><span class="string" id="3245330">&#34;unknown&nbsp;IP&nbsp;protocol&nbsp;specified:&nbsp;&#34;</span>&nbsp;<span class="op" id="3245364">+</span>&nbsp;<span class="ident" id="3245366">name</span><span class="op" id="3245370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3245373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245376">return</span><br>
<span class="lineno"></span><span class="op" id="3245383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3245386">func</span>&nbsp;<span class="ident" id="3245391">lookupHost</span><span class="op" id="3245401">(</span><span class="ident" id="3245402">host</span>&nbsp;<span class="builtintype" id="3245407">string</span><span class="op" id="3245413">)</span>&nbsp;<span class="op" id="3245415">(</span><span class="ident" id="3245416">addrs</span>&nbsp;<span class="op" id="3245422">[</span><span class="op" id="3245423">]</span><span class="builtintype" id="3245424">string</span><span class="op" id="3245430">,</span>&nbsp;<span class="ident" id="3245432">err</span>&nbsp;<span class="builtintype" id="3245436">error</span><span class="op" id="3245441">)</span>&nbsp;<span class="op" id="3245443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3245446">addrs</span><span class="op" id="3245451">,</span>&nbsp;<span class="ident" id="3245453">err</span><span class="op" id="3245456">,</span>&nbsp;<span class="ident" id="3245458">ok</span>&nbsp;<span class="op" id="3245461">:=</span>&nbsp;<span class="ident" id="3245464">cgoLookupHost</span><span class="op" id="3245477">(</span><span class="ident" id="3245478">host</span><span class="op" id="3245482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245485">if</span>&nbsp;<span class="op" id="3245488">!</span><span class="ident" id="3245489">ok</span>&nbsp;<span class="op" id="3245492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3245496">addrs</span><span class="op" id="3245501">,</span>&nbsp;<span class="ident" id="3245503">err</span>&nbsp;<span class="op" id="3245507">=</span>&nbsp;<span class="ident" id="3245509">goLookupHost</span><span class="op" id="3245521">(</span><span class="ident" id="3245522">host</span><span class="op" id="3245526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3245529">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245532">return</span><br>
<span class="lineno"></span><span class="op" id="3245539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3245542">func</span>&nbsp;<span class="ident" id="3245547">lookupIP</span><span class="op" id="3245555">(</span><span class="ident" id="3245556">host</span>&nbsp;<span class="builtintype" id="3245561">string</span><span class="op" id="3245567">)</span>&nbsp;<span class="op" id="3245569">(</span><span class="ident" id="3245570">addrs</span>&nbsp;<span class="op" id="3245576">[</span><span class="op" id="3245577">]</span><span class="ident" id="3245578">IP</span><span class="op" id="3245580">,</span>&nbsp;<span class="ident" id="3245582">err</span>&nbsp;<span class="builtintype" id="3245586">error</span><span class="op" id="3245591">)</span>&nbsp;<span class="op" id="3245593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3245596">addrs</span><span class="op" id="3245601">,</span>&nbsp;<span class="ident" id="3245603">err</span><span class="op" id="3245606">,</span>&nbsp;<span class="ident" id="3245608">ok</span>&nbsp;<span class="op" id="3245611">:=</span>&nbsp;<span class="ident" id="3245614">cgoLookupIP</span><span class="op" id="3245625">(</span><span class="ident" id="3245626">host</span><span class="op" id="3245630">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245633">if</span>&nbsp;<span class="op" id="3245636">!</span><span class="ident" id="3245637">ok</span>&nbsp;<span class="op" id="3245640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3245644">addrs</span><span class="op" id="3245649">,</span>&nbsp;<span class="ident" id="3245651">err</span>&nbsp;<span class="op" id="3245655">=</span>&nbsp;<span class="ident" id="3245657">goLookupIP</span><span class="op" id="3245667">(</span><span class="ident" id="3245668">host</span><span class="op" id="3245672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3245675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245678">return</span><br>
<span class="lineno"></span><span class="op" id="3245685">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="3245688">func</span>&nbsp;<span class="ident" id="3245693">lookupPort</span><span class="op" id="3245703">(</span><span class="ident" id="3245704">network</span><span class="op" id="3245711">,</span>&nbsp;<span class="ident" id="3245713">service</span>&nbsp;<span class="builtintype" id="3245721">string</span><span class="op" id="3245727">)</span>&nbsp;<span class="op" id="3245729">(</span><span class="ident" id="3245730">port</span>&nbsp;<span class="builtintype" id="3245735">int</span><span class="op" id="3245738">,</span>&nbsp;<span class="ident" id="3245740">err</span>&nbsp;<span class="builtintype" id="3245744">error</span><span class="op" id="3245749">)</span>&nbsp;<span class="op" id="3245751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3245754">port</span><span class="op" id="3245758">,</span>&nbsp;<span class="ident" id="3245760">err</span><span class="op" id="3245763">,</span>&nbsp;<span class="ident" id="3245765">ok</span>&nbsp;<span class="op" id="3245768">:=</span>&nbsp;<span class="ident" id="3245771">cgoLookupPort</span><span class="op" id="3245784">(</span><span class="ident" id="3245785">network</span><span class="op" id="3245792">,</span>&nbsp;<span class="ident" id="3245794">service</span><span class="op" id="3245801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245804">if</span>&nbsp;<span class="op" id="3245807">!</span><span class="ident" id="3245808">ok</span>&nbsp;<span class="op" id="3245811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3245815">port</span><span class="op" id="3245819">,</span>&nbsp;<span class="ident" id="3245821">err</span>&nbsp;<span class="op" id="3245825">=</span>&nbsp;<span class="ident" id="3245827">goLookupPort</span><span class="op" id="3245839">(</span><span class="ident" id="3245840">network</span><span class="op" id="3245847">,</span>&nbsp;<span class="ident" id="3245849">service</span><span class="op" id="3245856">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3245859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245862">return</span><br>
<span class="lineno"></span><span class="op" id="3245869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3245872">func</span>&nbsp;<span class="ident" id="3245877">lookupCNAME</span><span class="op" id="3245888">(</span><span class="ident" id="3245889">name</span>&nbsp;<span class="builtintype" id="3245894">string</span><span class="op" id="3245900">)</span>&nbsp;<span class="op" id="3245902">(</span><span class="ident" id="3245903">cname</span>&nbsp;<span class="builtintype" id="3245909">string</span><span class="op" id="3245915">,</span>&nbsp;<span class="ident" id="3245917">err</span>&nbsp;<span class="builtintype" id="3245921">error</span><span class="op" id="3245926">)</span>&nbsp;<span class="op" id="3245928">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3245931">cname</span><span class="op" id="3245936">,</span>&nbsp;<span class="ident" id="3245938">err</span><span class="op" id="3245941">,</span>&nbsp;<span class="ident" id="3245943">ok</span>&nbsp;<span class="op" id="3245946">:=</span>&nbsp;<span class="ident" id="3245949">cgoLookupCNAME</span><span class="op" id="3245963">(</span><span class="ident" id="3245964">name</span><span class="op" id="3245968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3245971">if</span>&nbsp;<span class="op" id="3245974">!</span><span class="ident" id="3245975">ok</span>&nbsp;<span class="op" id="3245978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3245982">cname</span><span class="op" id="3245987">,</span>&nbsp;<span class="ident" id="3245989">err</span>&nbsp;<span class="op" id="3245993">=</span>&nbsp;<span class="ident" id="3245995">goLookupCNAME</span><span class="op" id="3246008">(</span><span class="ident" id="3246009">name</span><span class="op" id="3246013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3246016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246019">return</span><br>
<span class="lineno">85</span><span class="op" id="3246026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3246029">func</span>&nbsp;<span class="ident" id="3246034">lookupSRV</span><span class="op" id="3246043">(</span><span class="ident" id="3246044">service</span><span class="op" id="3246051">,</span>&nbsp;<span class="ident" id="3246053">proto</span><span class="op" id="3246058">,</span>&nbsp;<span class="ident" id="3246060">name</span>&nbsp;<span class="builtintype" id="3246065">string</span><span class="op" id="3246071">)</span>&nbsp;<span class="op" id="3246073">(</span><span class="ident" id="3246074">cname</span>&nbsp;<span class="builtintype" id="3246080">string</span><span class="op" id="3246086">,</span>&nbsp;<span class="ident" id="3246088">addrs</span>&nbsp;<span class="op" id="3246094">[</span><span class="op" id="3246095">]</span><span class="op" id="3246096">*</span><span class="ident" id="3246097">SRV</span><span class="op" id="3246100">,</span>&nbsp;<span class="ident" id="3246102">err</span>&nbsp;<span class="builtintype" id="3246106">error</span><span class="op" id="3246111">)</span>&nbsp;<span class="op" id="3246113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246116">var</span>&nbsp;<span class="ident" id="3246120">target</span>&nbsp;<span class="builtintype" id="3246127">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246135">if</span>&nbsp;<span class="ident" id="3246138">service</span>&nbsp;<span class="op" id="3246146">==</span>&nbsp;<span class="string" id="3246149">&#34;&#34;</span>&nbsp;<span class="op" id="3246152">&amp;&amp;</span>&nbsp;<span class="ident" id="3246155">proto</span>&nbsp;<span class="op" id="3246161">==</span>&nbsp;<span class="string" id="3246164">&#34;&#34;</span>&nbsp;<span class="op" id="3246167">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3246171">target</span>&nbsp;<span class="op" id="3246178">=</span>&nbsp;<span class="ident" id="3246180">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3246186">}</span>&nbsp;<span class="keyword" id="3246188">else</span>&nbsp;<span class="op" id="3246193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3246197">target</span>&nbsp;<span class="op" id="3246204">=</span>&nbsp;<span class="string" id="3246206">&#34;_&#34;</span>&nbsp;<span class="op" id="3246210">+</span>&nbsp;<span class="ident" id="3246212">service</span>&nbsp;<span class="op" id="3246220">+</span>&nbsp;<span class="string" id="3246222">&#34;._&#34;</span>&nbsp;<span class="op" id="3246227">+</span>&nbsp;<span class="ident" id="3246229">proto</span>&nbsp;<span class="op" id="3246235">+</span>&nbsp;<span class="string" id="3246237">&#34;.&#34;</span>&nbsp;<span class="op" id="3246241">+</span>&nbsp;<span class="ident" id="3246243">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3246249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246252">var</span>&nbsp;<span class="ident" id="3246256">records</span>&nbsp;<span class="op" id="3246264">[</span><span class="op" id="3246265">]</span><span class="ident" id="3246266">dnsRR</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3246273">cname</span><span class="op" id="3246278">,</span>&nbsp;<span class="ident" id="3246280">records</span><span class="op" id="3246287">,</span>&nbsp;<span class="ident" id="3246289">err</span>&nbsp;<span class="op" id="3246293">=</span>&nbsp;<span class="ident" id="3246295">lookup</span><span class="op" id="3246301">(</span><span class="ident" id="3246302">target</span><span class="op" id="3246308">,</span>&nbsp;<span class="ident" id="3246310">dnsTypeSRV</span><span class="op" id="3246320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246323">if</span>&nbsp;<span class="ident" id="3246326">err</span>&nbsp;<span class="op" id="3246330">!=</span>&nbsp;<span class="ident" id="3246333">nil</span>&nbsp;<span class="op" id="3246337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246341">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3246349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3246352">addrs</span>&nbsp;<span class="op" id="3246358">=</span>&nbsp;<span class="builtinfunc" id="3246360">make</span><span class="op" id="3246364">(</span><span class="op" id="3246365">[</span><span class="op" id="3246366">]</span><span class="op" id="3246367">*</span><span class="ident" id="3246368">SRV</span><span class="op" id="3246371">,</span>&nbsp;<span class="builtinfunc" id="3246373">len</span><span class="op" id="3246376">(</span><span class="ident" id="3246377">records</span><span class="op" id="3246384">)</span><span class="op" id="3246385">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246388">for</span>&nbsp;<span class="ident" id="3246392">i</span><span class="op" id="3246393">,</span>&nbsp;<span class="ident" id="3246395">rr</span>&nbsp;<span class="op" id="3246398">:=</span>&nbsp;<span class="keyword" id="3246401">range</span>&nbsp;<span class="ident" id="3246407">records</span>&nbsp;<span class="op" id="3246415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3246419">r</span>&nbsp;<span class="op" id="3246421">:=</span>&nbsp;<span class="ident" id="3246424">rr</span><span class="op" id="3246426">.</span><span class="op" id="3246427">(</span><span class="op" id="3246428">*</span><span class="ident" id="3246429">dnsRR_SRV</span><span class="op" id="3246438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3246442">addrs</span><span class="op" id="3246447">[</span><span class="ident" id="3246448">i</span><span class="op" id="3246449">]</span>&nbsp;<span class="op" id="3246451">=</span>&nbsp;<span class="op" id="3246453">&amp;</span><span class="ident" id="3246454">SRV</span><span class="op" id="3246457">{</span><span class="ident" id="3246458">r</span><span class="op" id="3246459">.</span><span class="ident" id="3246460">Target</span><span class="op" id="3246466">,</span>&nbsp;<span class="ident" id="3246468">r</span><span class="op" id="3246469">.</span><span class="ident" id="3246470">Port</span><span class="op" id="3246474">,</span>&nbsp;<span class="ident" id="3246476">r</span><span class="op" id="3246477">.</span><span class="ident" id="3246478">Priority</span><span class="op" id="3246486">,</span>&nbsp;<span class="ident" id="3246488">r</span><span class="op" id="3246489">.</span><span class="ident" id="3246490">Weight</span><span class="op" id="3246496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3246499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3246502">byPriorityWeight</span><span class="op" id="3246518">(</span><span class="ident" id="3246519">addrs</span><span class="op" id="3246524">)</span><span class="op" id="3246525">.</span><span class="ident" id="3246526">sort</span><span class="op" id="3246530">(</span><span class="op" id="3246531">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246534">return</span><br>
<span class="lineno"></span><span class="op" id="3246541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3246544">func</span>&nbsp;<span class="ident" id="3246549">lookupMX</span><span class="op" id="3246557">(</span><span class="ident" id="3246558">name</span>&nbsp;<span class="builtintype" id="3246563">string</span><span class="op" id="3246569">)</span>&nbsp;<span class="op" id="3246571">(</span><span class="ident" id="3246572">mx</span>&nbsp;<span class="op" id="3246575">[</span><span class="op" id="3246576">]</span><span class="op" id="3246577">*</span><span class="ident" id="3246578">MX</span><span class="op" id="3246580">,</span>&nbsp;<span class="ident" id="3246582">err</span>&nbsp;<span class="builtintype" id="3246586">error</span><span class="op" id="3246591">)</span>&nbsp;<span class="op" id="3246593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3246596">_</span><span class="op" id="3246597">,</span>&nbsp;<span class="ident" id="3246599">records</span><span class="op" id="3246606">,</span>&nbsp;<span class="ident" id="3246608">err</span>&nbsp;<span class="op" id="3246612">:=</span>&nbsp;<span class="ident" id="3246615">lookup</span><span class="op" id="3246621">(</span><span class="ident" id="3246622">name</span><span class="op" id="3246626">,</span>&nbsp;<span class="ident" id="3246628">dnsTypeMX</span><span class="op" id="3246637">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246640">if</span>&nbsp;<span class="ident" id="3246643">err</span>&nbsp;<span class="op" id="3246647">!=</span>&nbsp;<span class="ident" id="3246650">nil</span>&nbsp;<span class="op" id="3246654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246658">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3246666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3246669">mx</span>&nbsp;<span class="op" id="3246672">=</span>&nbsp;<span class="builtinfunc" id="3246674">make</span><span class="op" id="3246678">(</span><span class="op" id="3246679">[</span><span class="op" id="3246680">]</span><span class="op" id="3246681">*</span><span class="ident" id="3246682">MX</span><span class="op" id="3246684">,</span>&nbsp;<span class="builtinfunc" id="3246686">len</span><span class="op" id="3246689">(</span><span class="ident" id="3246690">records</span><span class="op" id="3246697">)</span><span class="op" id="3246698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246701">for</span>&nbsp;<span class="ident" id="3246705">i</span><span class="op" id="3246706">,</span>&nbsp;<span class="ident" id="3246708">rr</span>&nbsp;<span class="op" id="3246711">:=</span>&nbsp;<span class="keyword" id="3246714">range</span>&nbsp;<span class="ident" id="3246720">records</span>&nbsp;<span class="op" id="3246728">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3246732">r</span>&nbsp;<span class="op" id="3246734">:=</span>&nbsp;<span class="ident" id="3246737">rr</span><span class="op" id="3246739">.</span><span class="op" id="3246740">(</span><span class="op" id="3246741">*</span><span class="ident" id="3246742">dnsRR_MX</span><span class="op" id="3246750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3246754">mx</span><span class="op" id="3246756">[</span><span class="ident" id="3246757">i</span><span class="op" id="3246758">]</span>&nbsp;<span class="op" id="3246760">=</span>&nbsp;<span class="op" id="3246762">&amp;</span><span class="ident" id="3246763">MX</span><span class="op" id="3246765">{</span><span class="ident" id="3246766">r</span><span class="op" id="3246767">.</span><span class="ident" id="3246768">Mx</span><span class="op" id="3246770">,</span>&nbsp;<span class="ident" id="3246772">r</span><span class="op" id="3246773">.</span><span class="ident" id="3246774">Pref</span><span class="op" id="3246778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3246781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3246784">byPref</span><span class="op" id="3246790">(</span><span class="ident" id="3246791">mx</span><span class="op" id="3246793">)</span><span class="op" id="3246794">.</span><span class="ident" id="3246795">sort</span><span class="op" id="3246799">(</span><span class="op" id="3246800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246803">return</span><br>
<span class="lineno">120</span><span class="op" id="3246810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3246813">func</span>&nbsp;<span class="ident" id="3246818">lookupNS</span><span class="op" id="3246826">(</span><span class="ident" id="3246827">name</span>&nbsp;<span class="builtintype" id="3246832">string</span><span class="op" id="3246838">)</span>&nbsp;<span class="op" id="3246840">(</span><span class="ident" id="3246841">ns</span>&nbsp;<span class="op" id="3246844">[</span><span class="op" id="3246845">]</span><span class="op" id="3246846">*</span><span class="ident" id="3246847">NS</span><span class="op" id="3246849">,</span>&nbsp;<span class="ident" id="3246851">err</span>&nbsp;<span class="builtintype" id="3246855">error</span><span class="op" id="3246860">)</span>&nbsp;<span class="op" id="3246862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3246865">_</span><span class="op" id="3246866">,</span>&nbsp;<span class="ident" id="3246868">records</span><span class="op" id="3246875">,</span>&nbsp;<span class="ident" id="3246877">err</span>&nbsp;<span class="op" id="3246881">:=</span>&nbsp;<span class="ident" id="3246884">lookup</span><span class="op" id="3246890">(</span><span class="ident" id="3246891">name</span><span class="op" id="3246895">,</span>&nbsp;<span class="ident" id="3246897">dnsTypeNS</span><span class="op" id="3246906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246909">if</span>&nbsp;<span class="ident" id="3246912">err</span>&nbsp;<span class="op" id="3246916">!=</span>&nbsp;<span class="ident" id="3246919">nil</span>&nbsp;<span class="op" id="3246923">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246927">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3246935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3246938">ns</span>&nbsp;<span class="op" id="3246941">=</span>&nbsp;<span class="builtinfunc" id="3246943">make</span><span class="op" id="3246947">(</span><span class="op" id="3246948">[</span><span class="op" id="3246949">]</span><span class="op" id="3246950">*</span><span class="ident" id="3246951">NS</span><span class="op" id="3246953">,</span>&nbsp;<span class="builtinfunc" id="3246955">len</span><span class="op" id="3246958">(</span><span class="ident" id="3246959">records</span><span class="op" id="3246966">)</span><span class="op" id="3246967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3246970">for</span>&nbsp;<span class="ident" id="3246974">i</span><span class="op" id="3246975">,</span>&nbsp;<span class="ident" id="3246977">r</span>&nbsp;<span class="op" id="3246979">:=</span>&nbsp;<span class="keyword" id="3246982">range</span>&nbsp;<span class="ident" id="3246988">records</span>&nbsp;<span class="op" id="3246996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3247000">r</span>&nbsp;<span class="op" id="3247002">:=</span>&nbsp;<span class="ident" id="3247005">r</span><span class="op" id="3247006">.</span><span class="op" id="3247007">(</span><span class="op" id="3247008">*</span><span class="ident" id="3247009">dnsRR_NS</span><span class="op" id="3247017">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3247021">ns</span><span class="op" id="3247023">[</span><span class="ident" id="3247024">i</span><span class="op" id="3247025">]</span>&nbsp;<span class="op" id="3247027">=</span>&nbsp;<span class="op" id="3247029">&amp;</span><span class="ident" id="3247030">NS</span><span class="op" id="3247032">{</span><span class="ident" id="3247033">r</span><span class="op" id="3247034">.</span><span class="ident" id="3247035">Ns</span><span class="op" id="3247037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3247040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247043">return</span><br>
<span class="lineno"></span><span class="op" id="3247050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="3247053">func</span>&nbsp;<span class="ident" id="3247058">lookupTXT</span><span class="op" id="3247067">(</span><span class="ident" id="3247068">name</span>&nbsp;<span class="builtintype" id="3247073">string</span><span class="op" id="3247079">)</span>&nbsp;<span class="op" id="3247081">(</span><span class="ident" id="3247082">txt</span>&nbsp;<span class="op" id="3247086">[</span><span class="op" id="3247087">]</span><span class="builtintype" id="3247088">string</span><span class="op" id="3247094">,</span>&nbsp;<span class="ident" id="3247096">err</span>&nbsp;<span class="builtintype" id="3247100">error</span><span class="op" id="3247105">)</span>&nbsp;<span class="op" id="3247107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3247110">_</span><span class="op" id="3247111">,</span>&nbsp;<span class="ident" id="3247113">records</span><span class="op" id="3247120">,</span>&nbsp;<span class="ident" id="3247122">err</span>&nbsp;<span class="op" id="3247126">:=</span>&nbsp;<span class="ident" id="3247129">lookup</span><span class="op" id="3247135">(</span><span class="ident" id="3247136">name</span><span class="op" id="3247140">,</span>&nbsp;<span class="ident" id="3247142">dnsTypeTXT</span><span class="op" id="3247152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247155">if</span>&nbsp;<span class="ident" id="3247158">err</span>&nbsp;<span class="op" id="3247162">!=</span>&nbsp;<span class="ident" id="3247165">nil</span>&nbsp;<span class="op" id="3247169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247173">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3247181">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3247184">txt</span>&nbsp;<span class="op" id="3247188">=</span>&nbsp;<span class="builtinfunc" id="3247190">make</span><span class="op" id="3247194">(</span><span class="op" id="3247195">[</span><span class="op" id="3247196">]</span><span class="builtintype" id="3247197">string</span><span class="op" id="3247203">,</span>&nbsp;<span class="builtinfunc" id="3247205">len</span><span class="op" id="3247208">(</span><span class="ident" id="3247209">records</span><span class="op" id="3247216">)</span><span class="op" id="3247217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247220">for</span>&nbsp;<span class="ident" id="3247224">i</span><span class="op" id="3247225">,</span>&nbsp;<span class="ident" id="3247227">r</span>&nbsp;<span class="op" id="3247229">:=</span>&nbsp;<span class="keyword" id="3247232">range</span>&nbsp;<span class="ident" id="3247238">records</span>&nbsp;<span class="op" id="3247246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3247250">txt</span><span class="op" id="3247253">[</span><span class="ident" id="3247254">i</span><span class="op" id="3247255">]</span>&nbsp;<span class="op" id="3247257">=</span>&nbsp;<span class="ident" id="3247259">r</span><span class="op" id="3247260">.</span><span class="op" id="3247261">(</span><span class="op" id="3247262">*</span><span class="ident" id="3247263">dnsRR_TXT</span><span class="op" id="3247272">)</span><span class="op" id="3247273">.</span><span class="ident" id="3247274">Txt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3247279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247282">return</span><br>
<span class="lineno">145</span><span class="op" id="3247289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3247292">func</span>&nbsp;<span class="ident" id="3247297">lookupAddr</span><span class="op" id="3247307">(</span><span class="ident" id="3247308">addr</span>&nbsp;<span class="builtintype" id="3247313">string</span><span class="op" id="3247319">)</span>&nbsp;<span class="op" id="3247321">(</span><span class="ident" id="3247322">name</span>&nbsp;<span class="op" id="3247327">[</span><span class="op" id="3247328">]</span><span class="builtintype" id="3247329">string</span><span class="op" id="3247335">,</span>&nbsp;<span class="ident" id="3247337">err</span>&nbsp;<span class="builtintype" id="3247341">error</span><span class="op" id="3247346">)</span>&nbsp;<span class="op" id="3247348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3247351">name</span>&nbsp;<span class="op" id="3247356">=</span>&nbsp;<span class="ident" id="3247358">lookupStaticAddr</span><span class="op" id="3247374">(</span><span class="ident" id="3247375">addr</span><span class="op" id="3247379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247382">if</span>&nbsp;<span class="builtinfunc" id="3247385">len</span><span class="op" id="3247388">(</span><span class="ident" id="3247389">name</span><span class="op" id="3247393">)</span>&nbsp;<span class="op" id="3247395">&gt;</span>&nbsp;<span class="num" id="3247397">0</span>&nbsp;<span class="op" id="3247399">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247403">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3247411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247414">var</span>&nbsp;<span class="ident" id="3247418">arpa</span>&nbsp;<span class="builtintype" id="3247423">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3247431">arpa</span><span class="op" id="3247435">,</span>&nbsp;<span class="ident" id="3247437">err</span>&nbsp;<span class="op" id="3247441">=</span>&nbsp;<span class="ident" id="3247443">reverseaddr</span><span class="op" id="3247454">(</span><span class="ident" id="3247455">addr</span><span class="op" id="3247459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247462">if</span>&nbsp;<span class="ident" id="3247465">err</span>&nbsp;<span class="op" id="3247469">!=</span>&nbsp;<span class="ident" id="3247472">nil</span>&nbsp;<span class="op" id="3247476">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247480">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3247488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247491">var</span>&nbsp;<span class="ident" id="3247495">records</span>&nbsp;<span class="op" id="3247503">[</span><span class="op" id="3247504">]</span><span class="ident" id="3247505">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3247512">_</span><span class="op" id="3247513">,</span>&nbsp;<span class="ident" id="3247515">records</span><span class="op" id="3247522">,</span>&nbsp;<span class="ident" id="3247524">err</span>&nbsp;<span class="op" id="3247528">=</span>&nbsp;<span class="ident" id="3247530">lookup</span><span class="op" id="3247536">(</span><span class="ident" id="3247537">arpa</span><span class="op" id="3247541">,</span>&nbsp;<span class="ident" id="3247543">dnsTypePTR</span><span class="op" id="3247553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247556">if</span>&nbsp;<span class="ident" id="3247559">err</span>&nbsp;<span class="op" id="3247563">!=</span>&nbsp;<span class="ident" id="3247566">nil</span>&nbsp;<span class="op" id="3247570">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247574">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3247582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3247585">name</span>&nbsp;<span class="op" id="3247590">=</span>&nbsp;<span class="builtinfunc" id="3247592">make</span><span class="op" id="3247596">(</span><span class="op" id="3247597">[</span><span class="op" id="3247598">]</span><span class="builtintype" id="3247599">string</span><span class="op" id="3247605">,</span>&nbsp;<span class="builtinfunc" id="3247607">len</span><span class="op" id="3247610">(</span><span class="ident" id="3247611">records</span><span class="op" id="3247618">)</span><span class="op" id="3247619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247622">for</span>&nbsp;<span class="ident" id="3247626">i</span>&nbsp;<span class="op" id="3247628">:=</span>&nbsp;<span class="keyword" id="3247631">range</span>&nbsp;<span class="ident" id="3247637">records</span>&nbsp;<span class="op" id="3247645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3247649">r</span>&nbsp;<span class="op" id="3247651">:=</span>&nbsp;<span class="ident" id="3247654">records</span><span class="op" id="3247661">[</span><span class="ident" id="3247662">i</span><span class="op" id="3247663">]</span><span class="op" id="3247664">.</span><span class="op" id="3247665">(</span><span class="op" id="3247666">*</span><span class="ident" id="3247667">dnsRR_PTR</span><span class="op" id="3247676">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3247680">name</span><span class="op" id="3247684">[</span><span class="ident" id="3247685">i</span><span class="op" id="3247686">]</span>&nbsp;<span class="op" id="3247688">=</span>&nbsp;<span class="ident" id="3247690">r</span><span class="op" id="3247691">.</span><span class="ident" id="3247692">Ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3247697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3247700">return</span><br>
<span class="lineno"></span><span class="op" id="3247707">}</span>
</div>
</body>
</html>
