<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2006394">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2006449">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2006503">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2006554">package</span>&nbsp;<span class="ident" id="2006562">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2006568">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2006628">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cprob/gamma.c.</span><br>
<span class="lineno"></span><span class="comment" id="2006693">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">10</span><span class="comment" id="2006751">//</span><br>
<span class="lineno"></span><span class="comment" id="2006754">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tgamma.c</span><br>
<span class="lineno"></span><span class="comment" id="2006771">//</span><br>
<span class="lineno"></span><span class="comment" id="2006774">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2006797">//</span><br>
<span class="lineno">15</span><span class="comment" id="2006800">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2006813">//</span><br>
<span class="lineno"></span><span class="comment" id="2006816">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;tgamma();</span><br>
<span class="lineno"></span><span class="comment" id="2006842">//&nbsp;extern&nbsp;int&nbsp;signgam;</span><br>
<span class="lineno"></span><span class="comment" id="2006865">//</span><br>
<span class="lineno">20</span><span class="comment" id="2006868">//&nbsp;y&nbsp;=&nbsp;tgamma(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="2006888">//</span><br>
<span class="lineno"></span><span class="comment" id="2006891">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2006907">//</span><br>
<span class="lineno"></span><span class="comment" id="2006910">//&nbsp;Returns&nbsp;gamma&nbsp;function&nbsp;of&nbsp;the&nbsp;argument.&nbsp;&nbsp;The&nbsp;result&nbsp;is</span><br>
<span class="lineno">25</span><span class="comment" id="2006968">//&nbsp;correctly&nbsp;signed,&nbsp;and&nbsp;the&nbsp;sign&nbsp;(+1&nbsp;or&nbsp;-1)&nbsp;is&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="2007021">//&nbsp;returned&nbsp;in&nbsp;a&nbsp;global&nbsp;(extern)&nbsp;variable&nbsp;named&nbsp;signgam.</span><br>
<span class="lineno"></span><span class="comment" id="2007078">//&nbsp;This&nbsp;variable&nbsp;is&nbsp;also&nbsp;filled&nbsp;in&nbsp;by&nbsp;the&nbsp;logarithmic&nbsp;gamma</span><br>
<span class="lineno"></span><span class="comment" id="2007138">//&nbsp;function&nbsp;lgamma().</span><br>
<span class="lineno"></span><span class="comment" id="2007160">//</span><br>
<span class="lineno">30</span><span class="comment" id="2007163">//&nbsp;Arguments&nbsp;|x|&nbsp;&lt;=&nbsp;34&nbsp;are&nbsp;reduced&nbsp;by&nbsp;recurrence&nbsp;and&nbsp;the&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2007229">//&nbsp;approximated&nbsp;by&nbsp;a&nbsp;rational&nbsp;function&nbsp;of&nbsp;degree&nbsp;6/7&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2007289">//&nbsp;interval&nbsp;(2,3).&nbsp;&nbsp;Large&nbsp;arguments&nbsp;are&nbsp;handled&nbsp;by&nbsp;Stirling&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="2007351">//&nbsp;formula.&nbsp;Large&nbsp;negative&nbsp;arguments&nbsp;are&nbsp;made&nbsp;positive&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="2007412">//&nbsp;a&nbsp;reflection&nbsp;formula.</span><br>
<span class="lineno">35</span><span class="comment" id="2007437">//</span><br>
<span class="lineno"></span><span class="comment" id="2007440">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2007453">//</span><br>
<span class="lineno"></span><span class="comment" id="2007456">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="2007496">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="2007554">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-34,&nbsp;34&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.3e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.5e-17</span><br>
<span class="lineno"></span><span class="comment" id="2007614">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;-170,-33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.3e-16</span><br>
<span class="lineno"></span><span class="comment" id="2007674">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-33,&nbsp;&nbsp;33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.4e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="2007734">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;33,&nbsp;171.6&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="2007794">//</span><br>
<span class="lineno">45</span><span class="comment" id="2007797">//&nbsp;Error&nbsp;for&nbsp;arguments&nbsp;outside&nbsp;the&nbsp;test&nbsp;range&nbsp;will&nbsp;be&nbsp;larger</span><br>
<span class="lineno"></span><span class="comment" id="2007858">//&nbsp;owing&nbsp;to&nbsp;error&nbsp;amplification&nbsp;by&nbsp;the&nbsp;exponential&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="2007919">//</span><br>
<span class="lineno"></span><span class="comment" id="2007922">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="2007970">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">50</span><span class="comment" id="2008034">//</span><br>
<span class="lineno"></span><span class="comment" id="2008037">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="2008098">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2008168">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="2008243">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">55</span><span class="comment" id="2008310">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="2008383">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2008455">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="2008469">//</span><br>
<span class="lineno"></span><span class="comment" id="2008472">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">60</span><span class="comment" id="2008538">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="2008604">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="2008617">//</span><br>
<span class="lineno"></span><span class="comment" id="2008620">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="2008644">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="2008674">var</span>&nbsp;<span class="ident" id="2008678">_gamP</span>&nbsp;<span class="op" id="2008684">=</span>&nbsp;<span class="op" id="2008686">[</span><span class="op" id="2008687">...</span><span class="op" id="2008690">]</span><span class="builtintype" id="2008691">float64</span><span class="op" id="2008698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2008701">1.60119522476751861407e-04</span><span class="op" id="2008727">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2008730">1.19135147006586384913e-03</span><span class="op" id="2008756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2008759">1.04213797561761569935e-02</span><span class="op" id="2008785">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2008788">4.76367800457137231464e-02</span><span class="op" id="2008814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2008817">2.07448227648435975150e-01</span><span class="op" id="2008843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2008846">4.94214826801497100753e-01</span><span class="op" id="2008872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2008875">9.99999999999999996796e-01</span><span class="op" id="2008901">,</span><br>
<span class="lineno"></span><span class="op" id="2008903">}</span><br>
<span class="lineno">75</span><span class="keyword" id="2008905">var</span>&nbsp;<span class="ident" id="2008909">_gamQ</span>&nbsp;<span class="op" id="2008915">=</span>&nbsp;<span class="op" id="2008917">[</span><span class="op" id="2008918">...</span><span class="op" id="2008921">]</span><span class="builtintype" id="2008922">float64</span><span class="op" id="2008929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2008932">-</span><span class="num" id="2008933">2.31581873324120129819e-05</span><span class="op" id="2008959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2008962">5.39605580493303397842e-04</span><span class="op" id="2008988">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2008991">-</span><span class="num" id="2008992">4.45641913851797240494e-03</span><span class="op" id="2009018">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2009021">1.18139785222060435552e-02</span><span class="op" id="2009047">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2009050">3.58236398605498653373e-02</span><span class="op" id="2009076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2009079">-</span><span class="num" id="2009080">2.34591795718243348568e-01</span><span class="op" id="2009106">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2009109">7.14304917030273074085e-02</span><span class="op" id="2009135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2009138">1.00000000000000000320e+00</span><span class="op" id="2009164">,</span><br>
<span class="lineno"></span><span class="op" id="2009166">}</span><br>
<span class="lineno">85</span><span class="keyword" id="2009168">var</span>&nbsp;<span class="ident" id="2009172">_gamS</span>&nbsp;<span class="op" id="2009178">=</span>&nbsp;<span class="op" id="2009180">[</span><span class="op" id="2009181">...</span><span class="op" id="2009184">]</span><span class="builtintype" id="2009185">float64</span><span class="op" id="2009192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2009195">7.87311395793093628397e-04</span><span class="op" id="2009221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2009224">-</span><span class="num" id="2009225">2.29549961613378126380e-04</span><span class="op" id="2009251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2009254">-</span><span class="num" id="2009255">2.68132617805781232825e-03</span><span class="op" id="2009281">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2009284">3.47222221605458667310e-03</span><span class="op" id="2009310">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2009313">8.33333333333482257126e-02</span><span class="op" id="2009339">,</span><br>
<span class="lineno"></span><span class="op" id="2009341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2009344">//&nbsp;Gamma&nbsp;function&nbsp;computed&nbsp;by&nbsp;Stirling&#39;s&nbsp;formula.</span><br>
<span class="lineno"></span><span class="comment" id="2009394">//&nbsp;The&nbsp;polynomial&nbsp;is&nbsp;valid&nbsp;for&nbsp;33&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;172.</span><br>
<span class="lineno">95</span><span class="keyword" id="2009441">func</span>&nbsp;<span class="ident" id="2009446">stirling</span><span class="op" id="2009454">(</span><span class="ident" id="2009455">x</span>&nbsp;<span class="builtintype" id="2009457">float64</span><span class="op" id="2009464">)</span>&nbsp;<span class="builtintype" id="2009466">float64</span>&nbsp;<span class="op" id="2009474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2009477">const</span>&nbsp;<span class="op" id="2009483">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009487">SqrtTwoPi</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2009499">=</span>&nbsp;<span class="num" id="2009501">2.506628274631000502417</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009527">MaxStirling</span>&nbsp;<span class="op" id="2009539">=</span>&nbsp;<span class="num" id="2009541">143.01608</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2009552">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009555">w</span>&nbsp;<span class="op" id="2009557">:=</span>&nbsp;<span class="num" id="2009560">1</span>&nbsp;<span class="op" id="2009562">/</span>&nbsp;<span class="ident" id="2009564">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009567">w</span>&nbsp;<span class="op" id="2009569">=</span>&nbsp;<span class="num" id="2009571">1</span>&nbsp;<span class="op" id="2009573">+</span>&nbsp;<span class="ident" id="2009575">w</span><span class="op" id="2009576">*</span><span class="op" id="2009577">(</span><span class="op" id="2009578">(</span><span class="op" id="2009579">(</span><span class="op" id="2009580">(</span><span class="ident" id="2009581">_gamS</span><span class="op" id="2009586">[</span><span class="num" id="2009587">0</span><span class="op" id="2009588">]</span><span class="op" id="2009589">*</span><span class="ident" id="2009590">w</span><span class="op" id="2009591">+</span><span class="ident" id="2009592">_gamS</span><span class="op" id="2009597">[</span><span class="num" id="2009598">1</span><span class="op" id="2009599">]</span><span class="op" id="2009600">)</span><span class="op" id="2009601">*</span><span class="ident" id="2009602">w</span><span class="op" id="2009603">+</span><span class="ident" id="2009604">_gamS</span><span class="op" id="2009609">[</span><span class="num" id="2009610">2</span><span class="op" id="2009611">]</span><span class="op" id="2009612">)</span><span class="op" id="2009613">*</span><span class="ident" id="2009614">w</span><span class="op" id="2009615">+</span><span class="ident" id="2009616">_gamS</span><span class="op" id="2009621">[</span><span class="num" id="2009622">3</span><span class="op" id="2009623">]</span><span class="op" id="2009624">)</span><span class="op" id="2009625">*</span><span class="ident" id="2009626">w</span><span class="op" id="2009627">+</span><span class="ident" id="2009628">_gamS</span><span class="op" id="2009633">[</span><span class="num" id="2009634">4</span><span class="op" id="2009635">]</span><span class="op" id="2009636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009639">y</span>&nbsp;<span class="op" id="2009641">:=</span>&nbsp;<span class="ident" id="2009644">Exp</span><span class="op" id="2009647">(</span><span class="ident" id="2009648">x</span><span class="op" id="2009649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2009652">if</span>&nbsp;<span class="ident" id="2009655">x</span>&nbsp;<span class="op" id="2009657">&gt;</span>&nbsp;<span class="ident" id="2009659">MaxStirling</span>&nbsp;<span class="op" id="2009671">{</span>&nbsp;<span class="comment" id="2009673">//&nbsp;avoid&nbsp;Pow()&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009699">v</span>&nbsp;<span class="op" id="2009701">:=</span>&nbsp;<span class="ident" id="2009704">Pow</span><span class="op" id="2009707">(</span><span class="ident" id="2009708">x</span><span class="op" id="2009709">,</span>&nbsp;<span class="num" id="2009711">0.5</span><span class="op" id="2009714">*</span><span class="ident" id="2009715">x</span><span class="op" id="2009716">-</span><span class="num" id="2009717">0.25</span><span class="op" id="2009721">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009725">y</span>&nbsp;<span class="op" id="2009727">=</span>&nbsp;<span class="ident" id="2009729">v</span>&nbsp;<span class="op" id="2009731">*</span>&nbsp;<span class="op" id="2009733">(</span><span class="ident" id="2009734">v</span>&nbsp;<span class="op" id="2009736">/</span>&nbsp;<span class="ident" id="2009738">y</span><span class="op" id="2009739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2009742">}</span>&nbsp;<span class="keyword" id="2009744">else</span>&nbsp;<span class="op" id="2009749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009753">y</span>&nbsp;<span class="op" id="2009755">=</span>&nbsp;<span class="ident" id="2009757">Pow</span><span class="op" id="2009760">(</span><span class="ident" id="2009761">x</span><span class="op" id="2009762">,</span>&nbsp;<span class="ident" id="2009764">x</span><span class="op" id="2009765">-</span><span class="num" id="2009766">0.5</span><span class="op" id="2009769">)</span>&nbsp;<span class="op" id="2009771">/</span>&nbsp;<span class="ident" id="2009773">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2009776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009779">y</span>&nbsp;<span class="op" id="2009781">=</span>&nbsp;<span class="ident" id="2009783">SqrtTwoPi</span>&nbsp;<span class="op" id="2009793">*</span>&nbsp;<span class="ident" id="2009795">y</span>&nbsp;<span class="op" id="2009797">*</span>&nbsp;<span class="ident" id="2009799">w</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2009802">return</span>&nbsp;<span class="ident" id="2009809">y</span><br>
<span class="lineno"></span><span class="op" id="2009811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2009814">//&nbsp;Gamma&nbsp;returns&nbsp;the&nbsp;Gamma&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2009856">//</span><br>
<span class="lineno">115</span><span class="comment" id="2009859">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2009881">//&nbsp;&nbsp;&nbsp;&nbspGamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2009903">//&nbsp;&nbsp;&nbsp;&nbspGamma(+0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2009923">//&nbsp;&nbsp;&nbsp;&nbspGamma(-0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2009943">//&nbsp;&nbsp;&nbsp;&nbspGamma(x)&nbsp;=&nbsp;NaN&nbsp;for&nbsp;integer&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno">120</span><span class="comment" id="2009979">//&nbsp;&nbsp;&nbsp;&nbspGamma(-Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2010000">//&nbsp;&nbsp;&nbsp;&nbspGamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2010020">func</span>&nbsp;<span class="ident" id="2010025">Gamma</span><span class="op" id="2010030">(</span><span class="ident" id="2010031">x</span>&nbsp;<span class="builtintype" id="2010033">float64</span><span class="op" id="2010040">)</span>&nbsp;<span class="builtintype" id="2010042">float64</span>&nbsp;<span class="op" id="2010050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010053">const</span>&nbsp;<span class="ident" id="2010059">Euler</span>&nbsp;<span class="op" id="2010065">=</span>&nbsp;<span class="num" id="2010067">0.57721566490153286060651209008240243104215933593992</span>&nbsp;<span class="comment" id="2010120">//&nbsp;A001620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2010132">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010150">switch</span>&nbsp;<span class="op" id="2010157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010160">case</span>&nbsp;<span class="ident" id="2010165">isNegInt</span><span class="op" id="2010173">(</span><span class="ident" id="2010174">x</span><span class="op" id="2010175">)</span>&nbsp;<span class="op" id="2010177">||</span>&nbsp;<span class="ident" id="2010180">IsInf</span><span class="op" id="2010185">(</span><span class="ident" id="2010186">x</span><span class="op" id="2010187">,</span>&nbsp;<span class="op" id="2010189">-</span><span class="num" id="2010190">1</span><span class="op" id="2010191">)</span>&nbsp;<span class="op" id="2010193">||</span>&nbsp;<span class="ident" id="2010196">IsNaN</span><span class="op" id="2010201">(</span><span class="ident" id="2010202">x</span><span class="op" id="2010203">)</span><span class="op" id="2010204">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010208">return</span>&nbsp;<span class="ident" id="2010215">NaN</span><span class="op" id="2010218">(</span><span class="op" id="2010219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010222">case</span>&nbsp;<span class="ident" id="2010227">x</span>&nbsp;<span class="op" id="2010229">==</span>&nbsp;<span class="num" id="2010232">0</span><span class="op" id="2010233">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010237">if</span>&nbsp;<span class="ident" id="2010240">Signbit</span><span class="op" id="2010247">(</span><span class="ident" id="2010248">x</span><span class="op" id="2010249">)</span>&nbsp;<span class="op" id="2010251">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010256">return</span>&nbsp;<span class="ident" id="2010263">Inf</span><span class="op" id="2010266">(</span><span class="op" id="2010267">-</span><span class="num" id="2010268">1</span><span class="op" id="2010269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2010273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010277">return</span>&nbsp;<span class="ident" id="2010284">Inf</span><span class="op" id="2010287">(</span><span class="num" id="2010288">1</span><span class="op" id="2010289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010292">case</span>&nbsp;<span class="ident" id="2010297">x</span>&nbsp;<span class="op" id="2010299">&lt;</span>&nbsp;<span class="op" id="2010301">-</span><span class="num" id="2010302">170.5674972726612</span>&nbsp;<span class="op" id="2010320">||</span>&nbsp;<span class="ident" id="2010323">x</span>&nbsp;<span class="op" id="2010325">&gt;</span>&nbsp;<span class="num" id="2010327">171.61447887182298</span><span class="op" id="2010345">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010349">return</span>&nbsp;<span class="ident" id="2010356">Inf</span><span class="op" id="2010359">(</span><span class="num" id="2010360">1</span><span class="op" id="2010361">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2010364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010367">q</span>&nbsp;<span class="op" id="2010369">:=</span>&nbsp;<span class="ident" id="2010372">Abs</span><span class="op" id="2010375">(</span><span class="ident" id="2010376">x</span><span class="op" id="2010377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010380">p</span>&nbsp;<span class="op" id="2010382">:=</span>&nbsp;<span class="ident" id="2010385">Floor</span><span class="op" id="2010390">(</span><span class="ident" id="2010391">q</span><span class="op" id="2010392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010395">if</span>&nbsp;<span class="ident" id="2010398">q</span>&nbsp;<span class="op" id="2010400">&gt;</span>&nbsp;<span class="num" id="2010402">33</span>&nbsp;<span class="op" id="2010405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010409">if</span>&nbsp;<span class="ident" id="2010412">x</span>&nbsp;<span class="op" id="2010414">&gt;=</span>&nbsp;<span class="num" id="2010417">0</span>&nbsp;<span class="op" id="2010419">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010424">return</span>&nbsp;<span class="ident" id="2010431">stirling</span><span class="op" id="2010439">(</span><span class="ident" id="2010440">x</span><span class="op" id="2010441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2010445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010449">signgam</span>&nbsp;<span class="op" id="2010457">:=</span>&nbsp;<span class="num" id="2010460">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010464">if</span>&nbsp;<span class="ident" id="2010467">ip</span>&nbsp;<span class="op" id="2010470">:=</span>&nbsp;<span class="builtintype" id="2010473">int</span><span class="op" id="2010476">(</span><span class="ident" id="2010477">p</span><span class="op" id="2010478">)</span><span class="op" id="2010479">;</span>&nbsp;<span class="ident" id="2010481">ip</span><span class="op" id="2010483">&amp;</span><span class="num" id="2010484">1</span>&nbsp;<span class="op" id="2010486">==</span>&nbsp;<span class="num" id="2010489">0</span>&nbsp;<span class="op" id="2010491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010496">signgam</span>&nbsp;<span class="op" id="2010504">=</span>&nbsp;<span class="op" id="2010506">-</span><span class="num" id="2010507">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2010511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010515">z</span>&nbsp;<span class="op" id="2010517">:=</span>&nbsp;<span class="ident" id="2010520">q</span>&nbsp;<span class="op" id="2010522">-</span>&nbsp;<span class="ident" id="2010524">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010528">if</span>&nbsp;<span class="ident" id="2010531">z</span>&nbsp;<span class="op" id="2010533">&gt;</span>&nbsp;<span class="num" id="2010535">0.5</span>&nbsp;<span class="op" id="2010539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010544">p</span>&nbsp;<span class="op" id="2010546">=</span>&nbsp;<span class="ident" id="2010548">p</span>&nbsp;<span class="op" id="2010550">+</span>&nbsp;<span class="num" id="2010552">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010557">z</span>&nbsp;<span class="op" id="2010559">=</span>&nbsp;<span class="ident" id="2010561">q</span>&nbsp;<span class="op" id="2010563">-</span>&nbsp;<span class="ident" id="2010565">p</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2010569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010573">z</span>&nbsp;<span class="op" id="2010575">=</span>&nbsp;<span class="ident" id="2010577">q</span>&nbsp;<span class="op" id="2010579">*</span>&nbsp;<span class="ident" id="2010581">Sin</span><span class="op" id="2010584">(</span><span class="ident" id="2010585">Pi</span><span class="op" id="2010587">*</span><span class="ident" id="2010588">z</span><span class="op" id="2010589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010593">if</span>&nbsp;<span class="ident" id="2010596">z</span>&nbsp;<span class="op" id="2010598">==</span>&nbsp;<span class="num" id="2010601">0</span>&nbsp;<span class="op" id="2010603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010608">return</span>&nbsp;<span class="ident" id="2010615">Inf</span><span class="op" id="2010618">(</span><span class="ident" id="2010619">signgam</span><span class="op" id="2010626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2010630">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010634">z</span>&nbsp;<span class="op" id="2010636">=</span>&nbsp;<span class="ident" id="2010638">Pi</span>&nbsp;<span class="op" id="2010641">/</span>&nbsp;<span class="op" id="2010643">(</span><span class="ident" id="2010644">Abs</span><span class="op" id="2010647">(</span><span class="ident" id="2010648">z</span><span class="op" id="2010649">)</span>&nbsp;<span class="op" id="2010651">*</span>&nbsp;<span class="ident" id="2010653">stirling</span><span class="op" id="2010661">(</span><span class="ident" id="2010662">q</span><span class="op" id="2010663">)</span><span class="op" id="2010664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010668">return</span>&nbsp;<span class="builtintype" id="2010675">float64</span><span class="op" id="2010682">(</span><span class="ident" id="2010683">signgam</span><span class="op" id="2010690">)</span>&nbsp;<span class="op" id="2010692">*</span>&nbsp;<span class="ident" id="2010694">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2010697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2010701">//&nbsp;Reduce&nbsp;argument</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010721">z</span>&nbsp;<span class="op" id="2010723">:=</span>&nbsp;<span class="num" id="2010726">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010731">for</span>&nbsp;<span class="ident" id="2010735">x</span>&nbsp;<span class="op" id="2010737">&gt;=</span>&nbsp;<span class="num" id="2010740">3</span>&nbsp;<span class="op" id="2010742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010746">x</span>&nbsp;<span class="op" id="2010748">=</span>&nbsp;<span class="ident" id="2010750">x</span>&nbsp;<span class="op" id="2010752">-</span>&nbsp;<span class="num" id="2010754">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010758">z</span>&nbsp;<span class="op" id="2010760">=</span>&nbsp;<span class="ident" id="2010762">z</span>&nbsp;<span class="op" id="2010764">*</span>&nbsp;<span class="ident" id="2010766">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2010769">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010772">for</span>&nbsp;<span class="ident" id="2010776">x</span>&nbsp;<span class="op" id="2010778">&lt;</span>&nbsp;<span class="num" id="2010780">0</span>&nbsp;<span class="op" id="2010782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010786">if</span>&nbsp;<span class="ident" id="2010789">x</span>&nbsp;<span class="op" id="2010791">&gt;</span>&nbsp;<span class="op" id="2010793">-</span><span class="num" id="2010794">1e-09</span>&nbsp;<span class="op" id="2010800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010805">goto</span>&nbsp;<span class="ident" id="2010810">small</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2010818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010822">z</span>&nbsp;<span class="op" id="2010824">=</span>&nbsp;<span class="ident" id="2010826">z</span>&nbsp;<span class="op" id="2010828">/</span>&nbsp;<span class="ident" id="2010830">x</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010834">x</span>&nbsp;<span class="op" id="2010836">=</span>&nbsp;<span class="ident" id="2010838">x</span>&nbsp;<span class="op" id="2010840">+</span>&nbsp;<span class="num" id="2010842">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2010845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010848">for</span>&nbsp;<span class="ident" id="2010852">x</span>&nbsp;<span class="op" id="2010854">&lt;</span>&nbsp;<span class="num" id="2010856">2</span>&nbsp;<span class="op" id="2010858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010862">if</span>&nbsp;<span class="ident" id="2010865">x</span>&nbsp;<span class="op" id="2010867">&lt;</span>&nbsp;<span class="num" id="2010869">1e-09</span>&nbsp;<span class="op" id="2010875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010880">goto</span>&nbsp;<span class="ident" id="2010885">small</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2010893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010897">z</span>&nbsp;<span class="op" id="2010899">=</span>&nbsp;<span class="ident" id="2010901">z</span>&nbsp;<span class="op" id="2010903">/</span>&nbsp;<span class="ident" id="2010905">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010909">x</span>&nbsp;<span class="op" id="2010911">=</span>&nbsp;<span class="ident" id="2010913">x</span>&nbsp;<span class="op" id="2010915">+</span>&nbsp;<span class="num" id="2010917">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2010920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010924">if</span>&nbsp;<span class="ident" id="2010927">x</span>&nbsp;<span class="op" id="2010929">==</span>&nbsp;<span class="num" id="2010932">2</span>&nbsp;<span class="op" id="2010934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2010938">return</span>&nbsp;<span class="ident" id="2010945">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2010948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010952">x</span>&nbsp;<span class="op" id="2010954">=</span>&nbsp;<span class="ident" id="2010956">x</span>&nbsp;<span class="op" id="2010958">-</span>&nbsp;<span class="num" id="2010960">2</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2010963">p</span>&nbsp;<span class="op" id="2010965">=</span>&nbsp;<span class="op" id="2010967">(</span><span class="op" id="2010968">(</span><span class="op" id="2010969">(</span><span class="op" id="2010970">(</span><span class="op" id="2010971">(</span><span class="ident" id="2010972">x</span><span class="op" id="2010973">*</span><span class="ident" id="2010974">_gamP</span><span class="op" id="2010979">[</span><span class="num" id="2010980">0</span><span class="op" id="2010981">]</span><span class="op" id="2010982">+</span><span class="ident" id="2010983">_gamP</span><span class="op" id="2010988">[</span><span class="num" id="2010989">1</span><span class="op" id="2010990">]</span><span class="op" id="2010991">)</span><span class="op" id="2010992">*</span><span class="ident" id="2010993">x</span><span class="op" id="2010994">+</span><span class="ident" id="2010995">_gamP</span><span class="op" id="2011000">[</span><span class="num" id="2011001">2</span><span class="op" id="2011002">]</span><span class="op" id="2011003">)</span><span class="op" id="2011004">*</span><span class="ident" id="2011005">x</span><span class="op" id="2011006">+</span><span class="ident" id="2011007">_gamP</span><span class="op" id="2011012">[</span><span class="num" id="2011013">3</span><span class="op" id="2011014">]</span><span class="op" id="2011015">)</span><span class="op" id="2011016">*</span><span class="ident" id="2011017">x</span><span class="op" id="2011018">+</span><span class="ident" id="2011019">_gamP</span><span class="op" id="2011024">[</span><span class="num" id="2011025">4</span><span class="op" id="2011026">]</span><span class="op" id="2011027">)</span><span class="op" id="2011028">*</span><span class="ident" id="2011029">x</span><span class="op" id="2011030">+</span><span class="ident" id="2011031">_gamP</span><span class="op" id="2011036">[</span><span class="num" id="2011037">5</span><span class="op" id="2011038">]</span><span class="op" id="2011039">)</span><span class="op" id="2011040">*</span><span class="ident" id="2011041">x</span>&nbsp;<span class="op" id="2011043">+</span>&nbsp;<span class="ident" id="2011045">_gamP</span><span class="op" id="2011050">[</span><span class="num" id="2011051">6</span><span class="op" id="2011052">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011055">q</span>&nbsp;<span class="op" id="2011057">=</span>&nbsp;<span class="op" id="2011059">(</span><span class="op" id="2011060">(</span><span class="op" id="2011061">(</span><span class="op" id="2011062">(</span><span class="op" id="2011063">(</span><span class="op" id="2011064">(</span><span class="ident" id="2011065">x</span><span class="op" id="2011066">*</span><span class="ident" id="2011067">_gamQ</span><span class="op" id="2011072">[</span><span class="num" id="2011073">0</span><span class="op" id="2011074">]</span><span class="op" id="2011075">+</span><span class="ident" id="2011076">_gamQ</span><span class="op" id="2011081">[</span><span class="num" id="2011082">1</span><span class="op" id="2011083">]</span><span class="op" id="2011084">)</span><span class="op" id="2011085">*</span><span class="ident" id="2011086">x</span><span class="op" id="2011087">+</span><span class="ident" id="2011088">_gamQ</span><span class="op" id="2011093">[</span><span class="num" id="2011094">2</span><span class="op" id="2011095">]</span><span class="op" id="2011096">)</span><span class="op" id="2011097">*</span><span class="ident" id="2011098">x</span><span class="op" id="2011099">+</span><span class="ident" id="2011100">_gamQ</span><span class="op" id="2011105">[</span><span class="num" id="2011106">3</span><span class="op" id="2011107">]</span><span class="op" id="2011108">)</span><span class="op" id="2011109">*</span><span class="ident" id="2011110">x</span><span class="op" id="2011111">+</span><span class="ident" id="2011112">_gamQ</span><span class="op" id="2011117">[</span><span class="num" id="2011118">4</span><span class="op" id="2011119">]</span><span class="op" id="2011120">)</span><span class="op" id="2011121">*</span><span class="ident" id="2011122">x</span><span class="op" id="2011123">+</span><span class="ident" id="2011124">_gamQ</span><span class="op" id="2011129">[</span><span class="num" id="2011130">5</span><span class="op" id="2011131">]</span><span class="op" id="2011132">)</span><span class="op" id="2011133">*</span><span class="ident" id="2011134">x</span><span class="op" id="2011135">+</span><span class="ident" id="2011136">_gamQ</span><span class="op" id="2011141">[</span><span class="num" id="2011142">6</span><span class="op" id="2011143">]</span><span class="op" id="2011144">)</span><span class="op" id="2011145">*</span><span class="ident" id="2011146">x</span>&nbsp;<span class="op" id="2011148">+</span>&nbsp;<span class="ident" id="2011150">_gamQ</span><span class="op" id="2011155">[</span><span class="num" id="2011156">7</span><span class="op" id="2011157">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2011160">return</span>&nbsp;<span class="ident" id="2011167">z</span>&nbsp;<span class="op" id="2011169">*</span>&nbsp;<span class="ident" id="2011171">p</span>&nbsp;<span class="op" id="2011173">/</span>&nbsp;<span class="ident" id="2011175">q</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="2011178">small</span><span class="op" id="2011183">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2011186">if</span>&nbsp;<span class="ident" id="2011189">x</span>&nbsp;<span class="op" id="2011191">==</span>&nbsp;<span class="num" id="2011194">0</span>&nbsp;<span class="op" id="2011196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2011200">return</span>&nbsp;<span class="ident" id="2011207">Inf</span><span class="op" id="2011210">(</span><span class="num" id="2011211">1</span><span class="op" id="2011212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2011215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2011218">return</span>&nbsp;<span class="ident" id="2011225">z</span>&nbsp;<span class="op" id="2011227">/</span>&nbsp;<span class="op" id="2011229">(</span><span class="op" id="2011230">(</span><span class="num" id="2011231">1</span>&nbsp;<span class="op" id="2011233">+</span>&nbsp;<span class="ident" id="2011235">Euler</span><span class="op" id="2011240">*</span><span class="ident" id="2011241">x</span><span class="op" id="2011242">)</span>&nbsp;<span class="op" id="2011244">*</span>&nbsp;<span class="ident" id="2011246">x</span><span class="op" id="2011247">)</span><br>
<span class="lineno"></span><span class="op" id="2011249">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="keyword" id="2011252">func</span>&nbsp;<span class="ident" id="2011257">isNegInt</span><span class="op" id="2011265">(</span><span class="ident" id="2011266">x</span>&nbsp;<span class="builtintype" id="2011268">float64</span><span class="op" id="2011275">)</span>&nbsp;<span class="builtintype" id="2011277">bool</span>&nbsp;<span class="op" id="2011282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2011285">if</span>&nbsp;<span class="ident" id="2011288">x</span>&nbsp;<span class="op" id="2011290">&lt;</span>&nbsp;<span class="num" id="2011292">0</span>&nbsp;<span class="op" id="2011294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2011298">_</span><span class="op" id="2011299">,</span>&nbsp;<span class="ident" id="2011301">xf</span>&nbsp;<span class="op" id="2011304">:=</span>&nbsp;<span class="ident" id="2011307">Modf</span><span class="op" id="2011311">(</span><span class="ident" id="2011312">x</span><span class="op" id="2011313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2011317">return</span>&nbsp;<span class="ident" id="2011324">xf</span>&nbsp;<span class="op" id="2011327">==</span>&nbsp;<span class="num" id="2011330">0</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2011333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2011336">return</span>&nbsp;<span class="ident" id="2011343">false</span><br>
<span class="lineno"></span><span class="op" id="2011349">}</span>
</div>
</body>
</html>
