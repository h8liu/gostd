<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8298922">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8298978">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8299032">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8299083">package</span>&nbsp;<span class="ident" id="8299091">xml</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8299096">import</span>&nbsp;<span class="op" id="8299103">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8299106">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8299115">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8299122">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8299128">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8299139">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8299150">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8299161">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">15</span><span class="op" id="8299176">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8299179">const</span>&nbsp;<span class="ident" id="8299185">testInput</span>&nbsp;<span class="op" id="8299195">=</span>&nbsp;<span class="string" id="8299197">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;?&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno">20</span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;&gt;<br>
<span class="lineno"></span>&lt;body&nbsp;xmlns:foo=&#34;ns1&#34;&nbsp;xmlns=&#34;ns2&#34;&nbsp;xmlns:tag=&#34;ns3&#34;&nbsp;`</span>&nbsp;<span class="op" id="8299414">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8299417">&#34;\r\n\t&#34;</span>&nbsp;<span class="op" id="8299426">+</span>&nbsp;<span class="string" id="8299428">`&nbsp;&nbsp;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;hello&nbsp;lang=&#34;en&#34;&gt;World&nbsp;&amp;lt;&amp;gt;&amp;apos;&amp;quot;&nbsp;&amp;#x767d;&amp;#40300;翔&lt;/hello&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;query&gt;&amp;何;&nbsp;&amp;is-it;&lt;/query&gt;<br>
<span class="lineno">25</span>&nbsp;&nbsp;&lt;goodbye&nbsp;/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;outer&nbsp;foo:attr=&#34;value&#34;&nbsp;xmlns:tag=&#34;ns4&#34;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;inner/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/outer&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;tag:name&gt;<br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;![CDATA[Some&nbsp;text&nbsp;here.]]&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/tag:name&gt;<br>
<span class="lineno"></span>&lt;/body&gt;&lt;!--&nbsp;missing&nbsp;final&nbsp;newline&nbsp;--&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8299718">var</span>&nbsp;<span class="ident" id="8299722">testEntity</span>&nbsp;<span class="op" id="8299733">=</span>&nbsp;<span class="keyword" id="8299735">map</span><span class="op" id="8299738">[</span><span class="builtintype" id="8299739">string</span><span class="op" id="8299745">]</span><span class="builtintype" id="8299746">string</span><span class="op" id="8299752">{</span><span class="string" id="8299753">&#34;何&#34;</span><span class="op" id="8299758">:</span>&nbsp;<span class="string" id="8299760">&#34;What&#34;</span><span class="op" id="8299766">,</span>&nbsp;<span class="string" id="8299768">&#34;is-it&#34;</span><span class="op" id="8299775">:</span>&nbsp;<span class="string" id="8299777">&#34;is&nbsp;it?&#34;</span><span class="op" id="8299785">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="8299788">var</span>&nbsp;<span class="ident" id="8299792">rawTokens</span>&nbsp;<span class="op" id="8299802">=</span>&nbsp;<span class="op" id="8299804">[</span><span class="op" id="8299805">]</span><span class="ident" id="8299806">Token</span><span class="op" id="8299811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8299814">CharData</span><span class="op" id="8299822">(</span><span class="string" id="8299823">&#34;\n&#34;</span><span class="op" id="8299827">)</span><span class="op" id="8299828">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8299831">ProcInst</span><span class="op" id="8299839">{</span><span class="string" id="8299840">&#34;xml&#34;</span><span class="op" id="8299845">,</span>&nbsp;<span class="op" id="8299847">[</span><span class="op" id="8299848">]</span><span class="builtintype" id="8299849">byte</span><span class="op" id="8299853">(</span><span class="string" id="8299854">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="8299886">)</span><span class="op" id="8299887">}</span><span class="op" id="8299888">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8299891">CharData</span><span class="op" id="8299899">(</span><span class="string" id="8299900">&#34;\n&#34;</span><span class="op" id="8299904">)</span><span class="op" id="8299905">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8299908">Directive</span><span class="op" id="8299917">(</span><span class="string" id="8299918">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="8300040">)</span><span class="op" id="8300041">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300044">CharData</span><span class="op" id="8300052">(</span><span class="string" id="8300053">&#34;\n&#34;</span><span class="op" id="8300057">)</span><span class="op" id="8300058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300061">StartElement</span><span class="op" id="8300073">{</span><span class="ident" id="8300074">Name</span><span class="op" id="8300078">{</span><span class="string" id="8300079">&#34;&#34;</span><span class="op" id="8300081">,</span>&nbsp;<span class="string" id="8300083">&#34;body&#34;</span><span class="op" id="8300089">}</span><span class="op" id="8300090">,</span>&nbsp;<span class="op" id="8300092">[</span><span class="op" id="8300093">]</span><span class="ident" id="8300094">Attr</span><span class="op" id="8300098">{</span><span class="op" id="8300099">{</span><span class="ident" id="8300100">Name</span><span class="op" id="8300104">{</span><span class="string" id="8300105">&#34;xmlns&#34;</span><span class="op" id="8300112">,</span>&nbsp;<span class="string" id="8300114">&#34;foo&#34;</span><span class="op" id="8300119">}</span><span class="op" id="8300120">,</span>&nbsp;<span class="string" id="8300122">&#34;ns1&#34;</span><span class="op" id="8300127">}</span><span class="op" id="8300128">,</span>&nbsp;<span class="op" id="8300130">{</span><span class="ident" id="8300131">Name</span><span class="op" id="8300135">{</span><span class="string" id="8300136">&#34;&#34;</span><span class="op" id="8300138">,</span>&nbsp;<span class="string" id="8300140">&#34;xmlns&#34;</span><span class="op" id="8300147">}</span><span class="op" id="8300148">,</span>&nbsp;<span class="string" id="8300150">&#34;ns2&#34;</span><span class="op" id="8300155">}</span><span class="op" id="8300156">,</span>&nbsp;<span class="op" id="8300158">{</span><span class="ident" id="8300159">Name</span><span class="op" id="8300163">{</span><span class="string" id="8300164">&#34;xmlns&#34;</span><span class="op" id="8300171">,</span>&nbsp;<span class="string" id="8300173">&#34;tag&#34;</span><span class="op" id="8300178">}</span><span class="op" id="8300179">,</span>&nbsp;<span class="string" id="8300181">&#34;ns3&#34;</span><span class="op" id="8300186">}</span><span class="op" id="8300187">}</span><span class="op" id="8300188">}</span><span class="op" id="8300189">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300192">CharData</span><span class="op" id="8300200">(</span><span class="string" id="8300201">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8300207">)</span><span class="op" id="8300208">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300211">StartElement</span><span class="op" id="8300223">{</span><span class="ident" id="8300224">Name</span><span class="op" id="8300228">{</span><span class="string" id="8300229">&#34;&#34;</span><span class="op" id="8300231">,</span>&nbsp;<span class="string" id="8300233">&#34;hello&#34;</span><span class="op" id="8300240">}</span><span class="op" id="8300241">,</span>&nbsp;<span class="op" id="8300243">[</span><span class="op" id="8300244">]</span><span class="ident" id="8300245">Attr</span><span class="op" id="8300249">{</span><span class="op" id="8300250">{</span><span class="ident" id="8300251">Name</span><span class="op" id="8300255">{</span><span class="string" id="8300256">&#34;&#34;</span><span class="op" id="8300258">,</span>&nbsp;<span class="string" id="8300260">&#34;lang&#34;</span><span class="op" id="8300266">}</span><span class="op" id="8300267">,</span>&nbsp;<span class="string" id="8300269">&#34;en&#34;</span><span class="op" id="8300273">}</span><span class="op" id="8300274">}</span><span class="op" id="8300275">}</span><span class="op" id="8300276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300279">CharData</span><span class="op" id="8300287">(</span><span class="string" id="8300288">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="8300311">)</span><span class="op" id="8300312">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300315">EndElement</span><span class="op" id="8300325">{</span><span class="ident" id="8300326">Name</span><span class="op" id="8300330">{</span><span class="string" id="8300331">&#34;&#34;</span><span class="op" id="8300333">,</span>&nbsp;<span class="string" id="8300335">&#34;hello&#34;</span><span class="op" id="8300342">}</span><span class="op" id="8300343">}</span><span class="op" id="8300344">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300347">CharData</span><span class="op" id="8300355">(</span><span class="string" id="8300356">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8300362">)</span><span class="op" id="8300363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300366">StartElement</span><span class="op" id="8300378">{</span><span class="ident" id="8300379">Name</span><span class="op" id="8300383">{</span><span class="string" id="8300384">&#34;&#34;</span><span class="op" id="8300386">,</span>&nbsp;<span class="string" id="8300388">&#34;query&#34;</span><span class="op" id="8300395">}</span><span class="op" id="8300396">,</span>&nbsp;<span class="op" id="8300398">[</span><span class="op" id="8300399">]</span><span class="ident" id="8300400">Attr</span><span class="op" id="8300404">{</span><span class="op" id="8300405">}</span><span class="op" id="8300406">}</span><span class="op" id="8300407">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300410">CharData</span><span class="op" id="8300418">(</span><span class="string" id="8300419">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="8300432">)</span><span class="op" id="8300433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300436">EndElement</span><span class="op" id="8300446">{</span><span class="ident" id="8300447">Name</span><span class="op" id="8300451">{</span><span class="string" id="8300452">&#34;&#34;</span><span class="op" id="8300454">,</span>&nbsp;<span class="string" id="8300456">&#34;query&#34;</span><span class="op" id="8300463">}</span><span class="op" id="8300464">}</span><span class="op" id="8300465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300468">CharData</span><span class="op" id="8300476">(</span><span class="string" id="8300477">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8300483">)</span><span class="op" id="8300484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300487">StartElement</span><span class="op" id="8300499">{</span><span class="ident" id="8300500">Name</span><span class="op" id="8300504">{</span><span class="string" id="8300505">&#34;&#34;</span><span class="op" id="8300507">,</span>&nbsp;<span class="string" id="8300509">&#34;goodbye&#34;</span><span class="op" id="8300518">}</span><span class="op" id="8300519">,</span>&nbsp;<span class="op" id="8300521">[</span><span class="op" id="8300522">]</span><span class="ident" id="8300523">Attr</span><span class="op" id="8300527">{</span><span class="op" id="8300528">}</span><span class="op" id="8300529">}</span><span class="op" id="8300530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300533">EndElement</span><span class="op" id="8300543">{</span><span class="ident" id="8300544">Name</span><span class="op" id="8300548">{</span><span class="string" id="8300549">&#34;&#34;</span><span class="op" id="8300551">,</span>&nbsp;<span class="string" id="8300553">&#34;goodbye&#34;</span><span class="op" id="8300562">}</span><span class="op" id="8300563">}</span><span class="op" id="8300564">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300567">CharData</span><span class="op" id="8300575">(</span><span class="string" id="8300576">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8300582">)</span><span class="op" id="8300583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300586">StartElement</span><span class="op" id="8300598">{</span><span class="ident" id="8300599">Name</span><span class="op" id="8300603">{</span><span class="string" id="8300604">&#34;&#34;</span><span class="op" id="8300606">,</span>&nbsp;<span class="string" id="8300608">&#34;outer&#34;</span><span class="op" id="8300615">}</span><span class="op" id="8300616">,</span>&nbsp;<span class="op" id="8300618">[</span><span class="op" id="8300619">]</span><span class="ident" id="8300620">Attr</span><span class="op" id="8300624">{</span><span class="op" id="8300625">{</span><span class="ident" id="8300626">Name</span><span class="op" id="8300630">{</span><span class="string" id="8300631">&#34;foo&#34;</span><span class="op" id="8300636">,</span>&nbsp;<span class="string" id="8300638">&#34;attr&#34;</span><span class="op" id="8300644">}</span><span class="op" id="8300645">,</span>&nbsp;<span class="string" id="8300647">&#34;value&#34;</span><span class="op" id="8300654">}</span><span class="op" id="8300655">,</span>&nbsp;<span class="op" id="8300657">{</span><span class="ident" id="8300658">Name</span><span class="op" id="8300662">{</span><span class="string" id="8300663">&#34;xmlns&#34;</span><span class="op" id="8300670">,</span>&nbsp;<span class="string" id="8300672">&#34;tag&#34;</span><span class="op" id="8300677">}</span><span class="op" id="8300678">,</span>&nbsp;<span class="string" id="8300680">&#34;ns4&#34;</span><span class="op" id="8300685">}</span><span class="op" id="8300686">}</span><span class="op" id="8300687">}</span><span class="op" id="8300688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300691">CharData</span><span class="op" id="8300699">(</span><span class="string" id="8300700">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="8300708">)</span><span class="op" id="8300709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300712">StartElement</span><span class="op" id="8300724">{</span><span class="ident" id="8300725">Name</span><span class="op" id="8300729">{</span><span class="string" id="8300730">&#34;&#34;</span><span class="op" id="8300732">,</span>&nbsp;<span class="string" id="8300734">&#34;inner&#34;</span><span class="op" id="8300741">}</span><span class="op" id="8300742">,</span>&nbsp;<span class="op" id="8300744">[</span><span class="op" id="8300745">]</span><span class="ident" id="8300746">Attr</span><span class="op" id="8300750">{</span><span class="op" id="8300751">}</span><span class="op" id="8300752">}</span><span class="op" id="8300753">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300756">EndElement</span><span class="op" id="8300766">{</span><span class="ident" id="8300767">Name</span><span class="op" id="8300771">{</span><span class="string" id="8300772">&#34;&#34;</span><span class="op" id="8300774">,</span>&nbsp;<span class="string" id="8300776">&#34;inner&#34;</span><span class="op" id="8300783">}</span><span class="op" id="8300784">}</span><span class="op" id="8300785">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300788">CharData</span><span class="op" id="8300796">(</span><span class="string" id="8300797">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8300803">)</span><span class="op" id="8300804">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300807">EndElement</span><span class="op" id="8300817">{</span><span class="ident" id="8300818">Name</span><span class="op" id="8300822">{</span><span class="string" id="8300823">&#34;&#34;</span><span class="op" id="8300825">,</span>&nbsp;<span class="string" id="8300827">&#34;outer&#34;</span><span class="op" id="8300834">}</span><span class="op" id="8300835">}</span><span class="op" id="8300836">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300839">CharData</span><span class="op" id="8300847">(</span><span class="string" id="8300848">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8300854">)</span><span class="op" id="8300855">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300858">StartElement</span><span class="op" id="8300870">{</span><span class="ident" id="8300871">Name</span><span class="op" id="8300875">{</span><span class="string" id="8300876">&#34;tag&#34;</span><span class="op" id="8300881">,</span>&nbsp;<span class="string" id="8300883">&#34;name&#34;</span><span class="op" id="8300889">}</span><span class="op" id="8300890">,</span>&nbsp;<span class="op" id="8300892">[</span><span class="op" id="8300893">]</span><span class="ident" id="8300894">Attr</span><span class="op" id="8300898">{</span><span class="op" id="8300899">}</span><span class="op" id="8300900">}</span><span class="op" id="8300901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300904">CharData</span><span class="op" id="8300912">(</span><span class="string" id="8300913">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="8300921">)</span><span class="op" id="8300922">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300925">CharData</span><span class="op" id="8300933">(</span><span class="string" id="8300934">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="8300951">)</span><span class="op" id="8300952">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300955">CharData</span><span class="op" id="8300963">(</span><span class="string" id="8300964">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8300970">)</span><span class="op" id="8300971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300974">EndElement</span><span class="op" id="8300984">{</span><span class="ident" id="8300985">Name</span><span class="op" id="8300989">{</span><span class="string" id="8300990">&#34;tag&#34;</span><span class="op" id="8300995">,</span>&nbsp;<span class="string" id="8300997">&#34;name&#34;</span><span class="op" id="8301003">}</span><span class="op" id="8301004">}</span><span class="op" id="8301005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301008">CharData</span><span class="op" id="8301016">(</span><span class="string" id="8301017">&#34;\n&#34;</span><span class="op" id="8301021">)</span><span class="op" id="8301022">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301025">EndElement</span><span class="op" id="8301035">{</span><span class="ident" id="8301036">Name</span><span class="op" id="8301040">{</span><span class="string" id="8301041">&#34;&#34;</span><span class="op" id="8301043">,</span>&nbsp;<span class="string" id="8301045">&#34;body&#34;</span><span class="op" id="8301051">}</span><span class="op" id="8301052">}</span><span class="op" id="8301053">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301056">Comment</span><span class="op" id="8301063">(</span><span class="string" id="8301064">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="8301089">)</span><span class="op" id="8301090">,</span><br>
<span class="lineno"></span><span class="op" id="8301092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8301095">var</span>&nbsp;<span class="ident" id="8301099">cookedTokens</span>&nbsp;<span class="op" id="8301112">=</span>&nbsp;<span class="op" id="8301114">[</span><span class="op" id="8301115">]</span><span class="ident" id="8301116">Token</span><span class="op" id="8301121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301124">CharData</span><span class="op" id="8301132">(</span><span class="string" id="8301133">&#34;\n&#34;</span><span class="op" id="8301137">)</span><span class="op" id="8301138">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301141">ProcInst</span><span class="op" id="8301149">{</span><span class="string" id="8301150">&#34;xml&#34;</span><span class="op" id="8301155">,</span>&nbsp;<span class="op" id="8301157">[</span><span class="op" id="8301158">]</span><span class="builtintype" id="8301159">byte</span><span class="op" id="8301163">(</span><span class="string" id="8301164">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="8301196">)</span><span class="op" id="8301197">}</span><span class="op" id="8301198">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301201">CharData</span><span class="op" id="8301209">(</span><span class="string" id="8301210">&#34;\n&#34;</span><span class="op" id="8301214">)</span><span class="op" id="8301215">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301218">Directive</span><span class="op" id="8301227">(</span><span class="string" id="8301228">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="8301350">)</span><span class="op" id="8301351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301354">CharData</span><span class="op" id="8301362">(</span><span class="string" id="8301363">&#34;\n&#34;</span><span class="op" id="8301367">)</span><span class="op" id="8301368">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301371">StartElement</span><span class="op" id="8301383">{</span><span class="ident" id="8301384">Name</span><span class="op" id="8301388">{</span><span class="string" id="8301389">&#34;ns2&#34;</span><span class="op" id="8301394">,</span>&nbsp;<span class="string" id="8301396">&#34;body&#34;</span><span class="op" id="8301402">}</span><span class="op" id="8301403">,</span>&nbsp;<span class="op" id="8301405">[</span><span class="op" id="8301406">]</span><span class="ident" id="8301407">Attr</span><span class="op" id="8301411">{</span><span class="op" id="8301412">{</span><span class="ident" id="8301413">Name</span><span class="op" id="8301417">{</span><span class="string" id="8301418">&#34;xmlns&#34;</span><span class="op" id="8301425">,</span>&nbsp;<span class="string" id="8301427">&#34;foo&#34;</span><span class="op" id="8301432">}</span><span class="op" id="8301433">,</span>&nbsp;<span class="string" id="8301435">&#34;ns1&#34;</span><span class="op" id="8301440">}</span><span class="op" id="8301441">,</span>&nbsp;<span class="op" id="8301443">{</span><span class="ident" id="8301444">Name</span><span class="op" id="8301448">{</span><span class="string" id="8301449">&#34;&#34;</span><span class="op" id="8301451">,</span>&nbsp;<span class="string" id="8301453">&#34;xmlns&#34;</span><span class="op" id="8301460">}</span><span class="op" id="8301461">,</span>&nbsp;<span class="string" id="8301463">&#34;ns2&#34;</span><span class="op" id="8301468">}</span><span class="op" id="8301469">,</span>&nbsp;<span class="op" id="8301471">{</span><span class="ident" id="8301472">Name</span><span class="op" id="8301476">{</span><span class="string" id="8301477">&#34;xmlns&#34;</span><span class="op" id="8301484">,</span>&nbsp;<span class="string" id="8301486">&#34;tag&#34;</span><span class="op" id="8301491">}</span><span class="op" id="8301492">,</span>&nbsp;<span class="string" id="8301494">&#34;ns3&#34;</span><span class="op" id="8301499">}</span><span class="op" id="8301500">}</span><span class="op" id="8301501">}</span><span class="op" id="8301502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301505">CharData</span><span class="op" id="8301513">(</span><span class="string" id="8301514">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8301520">)</span><span class="op" id="8301521">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301524">StartElement</span><span class="op" id="8301536">{</span><span class="ident" id="8301537">Name</span><span class="op" id="8301541">{</span><span class="string" id="8301542">&#34;ns2&#34;</span><span class="op" id="8301547">,</span>&nbsp;<span class="string" id="8301549">&#34;hello&#34;</span><span class="op" id="8301556">}</span><span class="op" id="8301557">,</span>&nbsp;<span class="op" id="8301559">[</span><span class="op" id="8301560">]</span><span class="ident" id="8301561">Attr</span><span class="op" id="8301565">{</span><span class="op" id="8301566">{</span><span class="ident" id="8301567">Name</span><span class="op" id="8301571">{</span><span class="string" id="8301572">&#34;&#34;</span><span class="op" id="8301574">,</span>&nbsp;<span class="string" id="8301576">&#34;lang&#34;</span><span class="op" id="8301582">}</span><span class="op" id="8301583">,</span>&nbsp;<span class="string" id="8301585">&#34;en&#34;</span><span class="op" id="8301589">}</span><span class="op" id="8301590">}</span><span class="op" id="8301591">}</span><span class="op" id="8301592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301595">CharData</span><span class="op" id="8301603">(</span><span class="string" id="8301604">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="8301627">)</span><span class="op" id="8301628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301631">EndElement</span><span class="op" id="8301641">{</span><span class="ident" id="8301642">Name</span><span class="op" id="8301646">{</span><span class="string" id="8301647">&#34;ns2&#34;</span><span class="op" id="8301652">,</span>&nbsp;<span class="string" id="8301654">&#34;hello&#34;</span><span class="op" id="8301661">}</span><span class="op" id="8301662">}</span><span class="op" id="8301663">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301666">CharData</span><span class="op" id="8301674">(</span><span class="string" id="8301675">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8301681">)</span><span class="op" id="8301682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301685">StartElement</span><span class="op" id="8301697">{</span><span class="ident" id="8301698">Name</span><span class="op" id="8301702">{</span><span class="string" id="8301703">&#34;ns2&#34;</span><span class="op" id="8301708">,</span>&nbsp;<span class="string" id="8301710">&#34;query&#34;</span><span class="op" id="8301717">}</span><span class="op" id="8301718">,</span>&nbsp;<span class="op" id="8301720">[</span><span class="op" id="8301721">]</span><span class="ident" id="8301722">Attr</span><span class="op" id="8301726">{</span><span class="op" id="8301727">}</span><span class="op" id="8301728">}</span><span class="op" id="8301729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301732">CharData</span><span class="op" id="8301740">(</span><span class="string" id="8301741">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="8301754">)</span><span class="op" id="8301755">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301758">EndElement</span><span class="op" id="8301768">{</span><span class="ident" id="8301769">Name</span><span class="op" id="8301773">{</span><span class="string" id="8301774">&#34;ns2&#34;</span><span class="op" id="8301779">,</span>&nbsp;<span class="string" id="8301781">&#34;query&#34;</span><span class="op" id="8301788">}</span><span class="op" id="8301789">}</span><span class="op" id="8301790">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301793">CharData</span><span class="op" id="8301801">(</span><span class="string" id="8301802">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8301808">)</span><span class="op" id="8301809">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301812">StartElement</span><span class="op" id="8301824">{</span><span class="ident" id="8301825">Name</span><span class="op" id="8301829">{</span><span class="string" id="8301830">&#34;ns2&#34;</span><span class="op" id="8301835">,</span>&nbsp;<span class="string" id="8301837">&#34;goodbye&#34;</span><span class="op" id="8301846">}</span><span class="op" id="8301847">,</span>&nbsp;<span class="op" id="8301849">[</span><span class="op" id="8301850">]</span><span class="ident" id="8301851">Attr</span><span class="op" id="8301855">{</span><span class="op" id="8301856">}</span><span class="op" id="8301857">}</span><span class="op" id="8301858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301861">EndElement</span><span class="op" id="8301871">{</span><span class="ident" id="8301872">Name</span><span class="op" id="8301876">{</span><span class="string" id="8301877">&#34;ns2&#34;</span><span class="op" id="8301882">,</span>&nbsp;<span class="string" id="8301884">&#34;goodbye&#34;</span><span class="op" id="8301893">}</span><span class="op" id="8301894">}</span><span class="op" id="8301895">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301898">CharData</span><span class="op" id="8301906">(</span><span class="string" id="8301907">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8301913">)</span><span class="op" id="8301914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301917">StartElement</span><span class="op" id="8301929">{</span><span class="ident" id="8301930">Name</span><span class="op" id="8301934">{</span><span class="string" id="8301935">&#34;ns2&#34;</span><span class="op" id="8301940">,</span>&nbsp;<span class="string" id="8301942">&#34;outer&#34;</span><span class="op" id="8301949">}</span><span class="op" id="8301950">,</span>&nbsp;<span class="op" id="8301952">[</span><span class="op" id="8301953">]</span><span class="ident" id="8301954">Attr</span><span class="op" id="8301958">{</span><span class="op" id="8301959">{</span><span class="ident" id="8301960">Name</span><span class="op" id="8301964">{</span><span class="string" id="8301965">&#34;ns1&#34;</span><span class="op" id="8301970">,</span>&nbsp;<span class="string" id="8301972">&#34;attr&#34;</span><span class="op" id="8301978">}</span><span class="op" id="8301979">,</span>&nbsp;<span class="string" id="8301981">&#34;value&#34;</span><span class="op" id="8301988">}</span><span class="op" id="8301989">,</span>&nbsp;<span class="op" id="8301991">{</span><span class="ident" id="8301992">Name</span><span class="op" id="8301996">{</span><span class="string" id="8301997">&#34;xmlns&#34;</span><span class="op" id="8302004">,</span>&nbsp;<span class="string" id="8302006">&#34;tag&#34;</span><span class="op" id="8302011">}</span><span class="op" id="8302012">,</span>&nbsp;<span class="string" id="8302014">&#34;ns4&#34;</span><span class="op" id="8302019">}</span><span class="op" id="8302020">}</span><span class="op" id="8302021">}</span><span class="op" id="8302022">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8302025">CharData</span><span class="op" id="8302033">(</span><span class="string" id="8302034">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="8302042">)</span><span class="op" id="8302043">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8302046">StartElement</span><span class="op" id="8302058">{</span><span class="ident" id="8302059">Name</span><span class="op" id="8302063">{</span><span class="string" id="8302064">&#34;ns2&#34;</span><span class="op" id="8302069">,</span>&nbsp;<span class="string" id="8302071">&#34;inner&#34;</span><span class="op" id="8302078">}</span><span class="op" id="8302079">,</span>&nbsp;<span class="op" id="8302081">[</span><span class="op" id="8302082">]</span><span class="ident" id="8302083">Attr</span><span class="op" id="8302087">{</span><span class="op" id="8302088">}</span><span class="op" id="8302089">}</span><span class="op" id="8302090">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8302093">EndElement</span><span class="op" id="8302103">{</span><span class="ident" id="8302104">Name</span><span class="op" id="8302108">{</span><span class="string" id="8302109">&#34;ns2&#34;</span><span class="op" id="8302114">,</span>&nbsp;<span class="string" id="8302116">&#34;inner&#34;</span><span class="op" id="8302123">}</span><span class="op" id="8302124">}</span><span class="op" id="8302125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8302128">CharData</span><span class="op" id="8302136">(</span><span class="string" id="8302137">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8302143">)</span><span class="op" id="8302144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8302147">EndElement</span><span class="op" id="8302157">{</span><span class="ident" id="8302158">Name</span><span class="op" id="8302162">{</span><span class="string" id="8302163">&#34;ns2&#34;</span><span class="op" id="8302168">,</span>&nbsp;<span class="string" id="8302170">&#34;outer&#34;</span><span class="op" id="8302177">}</span><span class="op" id="8302178">}</span><span class="op" id="8302179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8302182">CharData</span><span class="op" id="8302190">(</span><span class="string" id="8302191">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8302197">)</span><span class="op" id="8302198">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8302201">StartElement</span><span class="op" id="8302213">{</span><span class="ident" id="8302214">Name</span><span class="op" id="8302218">{</span><span class="string" id="8302219">&#34;ns3&#34;</span><span class="op" id="8302224">,</span>&nbsp;<span class="string" id="8302226">&#34;name&#34;</span><span class="op" id="8302232">}</span><span class="op" id="8302233">,</span>&nbsp;<span class="op" id="8302235">[</span><span class="op" id="8302236">]</span><span class="ident" id="8302237">Attr</span><span class="op" id="8302241">{</span><span class="op" id="8302242">}</span><span class="op" id="8302243">}</span><span class="op" id="8302244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8302247">CharData</span><span class="op" id="8302255">(</span><span class="string" id="8302256">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="8302264">)</span><span class="op" id="8302265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8302268">CharData</span><span class="op" id="8302276">(</span><span class="string" id="8302277">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="8302294">)</span><span class="op" id="8302295">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8302298">CharData</span><span class="op" id="8302306">(</span><span class="string" id="8302307">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8302313">)</span><span class="op" id="8302314">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8302317">EndElement</span><span class="op" id="8302327">{</span><span class="ident" id="8302328">Name</span><span class="op" id="8302332">{</span><span class="string" id="8302333">&#34;ns3&#34;</span><span class="op" id="8302338">,</span>&nbsp;<span class="string" id="8302340">&#34;name&#34;</span><span class="op" id="8302346">}</span><span class="op" id="8302347">}</span><span class="op" id="8302348">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8302351">CharData</span><span class="op" id="8302359">(</span><span class="string" id="8302360">&#34;\n&#34;</span><span class="op" id="8302364">)</span><span class="op" id="8302365">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8302368">EndElement</span><span class="op" id="8302378">{</span><span class="ident" id="8302379">Name</span><span class="op" id="8302383">{</span><span class="string" id="8302384">&#34;ns2&#34;</span><span class="op" id="8302389">,</span>&nbsp;<span class="string" id="8302391">&#34;body&#34;</span><span class="op" id="8302397">}</span><span class="op" id="8302398">}</span><span class="op" id="8302399">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8302402">Comment</span><span class="op" id="8302409">(</span><span class="string" id="8302410">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="8302435">)</span><span class="op" id="8302436">,</span><br>
<span class="lineno"></span><span class="op" id="8302438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="8302441">const</span>&nbsp;<span class="ident" id="8302447">testInputAltEncoding</span>&nbsp;<span class="op" id="8302468">=</span>&nbsp;<span class="string" id="8302470">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;?&gt;<br>
<span class="lineno"></span>&lt;TAG&gt;VALUE&lt;/TAG&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8302544">var</span>&nbsp;<span class="ident" id="8302548">rawTokensAltEncoding</span>&nbsp;<span class="op" id="8302569">=</span>&nbsp;<span class="op" id="8302571">[</span><span class="op" id="8302572">]</span><span class="ident" id="8302573">Token</span><span class="op" id="8302578">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8302581">CharData</span><span class="op" id="8302589">(</span><span class="string" id="8302590">&#34;\n&#34;</span><span class="op" id="8302594">)</span><span class="op" id="8302595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8302598">ProcInst</span><span class="op" id="8302606">{</span><span class="string" id="8302607">&#34;xml&#34;</span><span class="op" id="8302612">,</span>&nbsp;<span class="op" id="8302614">[</span><span class="op" id="8302615">]</span><span class="builtintype" id="8302616">byte</span><span class="op" id="8302620">(</span><span class="string" id="8302621">`version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;`</span><span class="op" id="8302667">)</span><span class="op" id="8302668">}</span><span class="op" id="8302669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8302672">CharData</span><span class="op" id="8302680">(</span><span class="string" id="8302681">&#34;\n&#34;</span><span class="op" id="8302685">)</span><span class="op" id="8302686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8302689">StartElement</span><span class="op" id="8302701">{</span><span class="ident" id="8302702">Name</span><span class="op" id="8302706">{</span><span class="string" id="8302707">&#34;&#34;</span><span class="op" id="8302709">,</span>&nbsp;<span class="string" id="8302711">&#34;tag&#34;</span><span class="op" id="8302716">}</span><span class="op" id="8302717">,</span>&nbsp;<span class="op" id="8302719">[</span><span class="op" id="8302720">]</span><span class="ident" id="8302721">Attr</span><span class="op" id="8302725">{</span><span class="op" id="8302726">}</span><span class="op" id="8302727">}</span><span class="op" id="8302728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8302731">CharData</span><span class="op" id="8302739">(</span><span class="string" id="8302740">&#34;value&#34;</span><span class="op" id="8302747">)</span><span class="op" id="8302748">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8302751">EndElement</span><span class="op" id="8302761">{</span><span class="ident" id="8302762">Name</span><span class="op" id="8302766">{</span><span class="string" id="8302767">&#34;&#34;</span><span class="op" id="8302769">,</span>&nbsp;<span class="string" id="8302771">&#34;tag&#34;</span><span class="op" id="8302776">}</span><span class="op" id="8302777">}</span><span class="op" id="8302778">,</span><br>
<span class="lineno"></span><span class="op" id="8302780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8302783">var</span>&nbsp;<span class="ident" id="8302787">xmlInput</span>&nbsp;<span class="op" id="8302796">=</span>&nbsp;<span class="op" id="8302798">[</span><span class="op" id="8302799">]</span><span class="builtintype" id="8302800">string</span><span class="op" id="8302806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8302809">//&nbsp;unexpected&nbsp;EOF&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8302834">&#34;&lt;&#34;</span><span class="op" id="8302837">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8302840">&#34;&lt;t&#34;</span><span class="op" id="8302844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8302847">&#34;&lt;t&nbsp;&#34;</span><span class="op" id="8302852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8302855">&#34;&lt;t/&#34;</span><span class="op" id="8302860">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8302863">&#34;&lt;!&#34;</span><span class="op" id="8302867">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8302870">&#34;&lt;!-&#34;</span><span class="op" id="8302875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8302878">&#34;&lt;!--&#34;</span><span class="op" id="8302884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8302887">&#34;&lt;!--c-&#34;</span><span class="op" id="8302895">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8302898">&#34;&lt;!--c--&#34;</span><span class="op" id="8302907">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8302910">&#34;&lt;!d&#34;</span><span class="op" id="8302915">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8302918">&#34;&lt;t&gt;&lt;/&#34;</span><span class="op" id="8302925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8302928">&#34;&lt;t&gt;&lt;/t&#34;</span><span class="op" id="8302936">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8302939">&#34;&lt;?&#34;</span><span class="op" id="8302943">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8302946">&#34;&lt;?p&#34;</span><span class="op" id="8302951">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8302954">&#34;&lt;t&nbsp;a&#34;</span><span class="op" id="8302960">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8302963">&#34;&lt;t&nbsp;a=&#34;</span><span class="op" id="8302970">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8302973">&#34;&lt;t&nbsp;a=&#39;&#34;</span><span class="op" id="8302981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8302984">&#34;&lt;t&nbsp;a=&#39;&#39;&#34;</span><span class="op" id="8302993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8302996">&#34;&lt;t/&gt;&lt;![&#34;</span><span class="op" id="8303005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8303008">&#34;&lt;t/&gt;&lt;![C&#34;</span><span class="op" id="8303018">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8303021">&#34;&lt;t/&gt;&lt;![CDATA[d&#34;</span><span class="op" id="8303037">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8303040">&#34;&lt;t/&gt;&lt;![CDATA[d]&#34;</span><span class="op" id="8303057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8303060">&#34;&lt;t/&gt;&lt;![CDATA[d]]&#34;</span><span class="op" id="8303078">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8303082">//&nbsp;other&nbsp;Syntax&nbsp;errors</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8303106">&#34;&lt;&gt;&#34;</span><span class="op" id="8303110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8303113">&#34;&lt;t/a&#34;</span><span class="op" id="8303119">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8303122">&#34;&lt;0&nbsp;/&gt;&#34;</span><span class="op" id="8303129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8303132">&#34;&lt;?0&nbsp;&gt;&#34;</span><span class="op" id="8303139">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8303142">//&nbsp;&nbsp;&nbsp;&nbsp&#34;&lt;!0&nbsp;&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8303188">&#34;&lt;/0&gt;&#34;</span><span class="op" id="8303194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8303197">&#34;&lt;t&nbsp;0=&#39;&#39;&gt;&#34;</span><span class="op" id="8303207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8303210">&#34;&lt;t&nbsp;a=&#39;&amp;&#39;&gt;&#34;</span><span class="op" id="8303221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8303224">&#34;&lt;t&nbsp;a=&#39;&lt;&#39;&gt;&#34;</span><span class="op" id="8303235">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8303238">&#34;&lt;t&gt;&amp;nbspc;&lt;/t&gt;&#34;</span><span class="op" id="8303254">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8303257">&#34;&lt;t&nbsp;a&gt;&#34;</span><span class="op" id="8303264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8303267">&#34;&lt;t&nbsp;a=&gt;&#34;</span><span class="op" id="8303275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8303278">&#34;&lt;t&nbsp;a=v&gt;&#34;</span><span class="op" id="8303287">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8303290">//&nbsp;&nbsp;&nbsp;&nbsp&#34;&lt;![CDATA[d]]&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8303344">&#34;&lt;t&gt;&lt;/e&gt;&#34;</span><span class="op" id="8303353">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8303356">&#34;&lt;t&gt;&lt;/&gt;&#34;</span><span class="op" id="8303364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8303367">&#34;&lt;t&gt;&lt;/t!&#34;</span><span class="op" id="8303376">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8303379">&#34;&lt;t&gt;cdata]]&gt;&lt;/t&gt;&#34;</span><span class="op" id="8303396">,</span><br>
<span class="lineno"></span><span class="op" id="8303398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="8303401">func</span>&nbsp;<span class="ident" id="8303406">TestRawToken</span><span class="op" id="8303418">(</span><span class="ident" id="8303419">t</span>&nbsp;<span class="op" id="8303421">*</span><span class="ident" id="8303422">testing</span><span class="op" id="8303429">.</span><span class="ident" id="8303430">T</span><span class="op" id="8303431">)</span>&nbsp;<span class="op" id="8303433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8303436">d</span>&nbsp;<span class="op" id="8303438">:=</span>&nbsp;<span class="ident" id="8303441">NewDecoder</span><span class="op" id="8303451">(</span><span class="ident" id="8303452">strings</span><span class="op" id="8303459">.</span><span class="ident" id="8303460">NewReader</span><span class="op" id="8303469">(</span><span class="ident" id="8303470">testInput</span><span class="op" id="8303479">)</span><span class="op" id="8303480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8303483">d</span><span class="op" id="8303484">.</span><span class="ident" id="8303485">Entity</span>&nbsp;<span class="op" id="8303492">=</span>&nbsp;<span class="ident" id="8303494">testEntity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8303506">testRawToken</span><span class="op" id="8303518">(</span><span class="ident" id="8303519">t</span><span class="op" id="8303520">,</span>&nbsp;<span class="ident" id="8303522">d</span><span class="op" id="8303523">,</span>&nbsp;<span class="ident" id="8303525">testInput</span><span class="op" id="8303534">,</span>&nbsp;<span class="ident" id="8303536">rawTokens</span><span class="op" id="8303545">)</span><br>
<span class="lineno"></span><span class="op" id="8303547">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="8303550">const</span>&nbsp;<span class="ident" id="8303556">nonStrictInput</span>&nbsp;<span class="op" id="8303571">=</span>&nbsp;<span class="string" id="8303573">`<br>
<span class="lineno"></span>&lt;tag&gt;non&amp;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;unknown;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;#123&lt;/tag&gt;<br>
<span class="lineno">180</span>&lt;tag&gt;&amp;#zzz;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;なまえ3;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;lt-gt;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;0a;&lt;/tag&gt;<br>
<span class="lineno">185</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8303735">var</span>&nbsp;<span class="ident" id="8303739">nonStringEntity</span>&nbsp;<span class="op" id="8303755">=</span>&nbsp;<span class="keyword" id="8303757">map</span><span class="op" id="8303760">[</span><span class="builtintype" id="8303761">string</span><span class="op" id="8303767">]</span><span class="builtintype" id="8303768">string</span><span class="op" id="8303774">{</span><span class="string" id="8303775">&#34;&#34;</span><span class="op" id="8303777">:</span>&nbsp;<span class="string" id="8303779">&#34;oops!&#34;</span><span class="op" id="8303786">,</span>&nbsp;<span class="string" id="8303788">&#34;0a&#34;</span><span class="op" id="8303792">:</span>&nbsp;<span class="string" id="8303794">&#34;oops!&#34;</span><span class="op" id="8303801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8303804">var</span>&nbsp;<span class="ident" id="8303808">nonStrictTokens</span>&nbsp;<span class="op" id="8303824">=</span>&nbsp;<span class="op" id="8303826">[</span><span class="op" id="8303827">]</span><span class="ident" id="8303828">Token</span><span class="op" id="8303833">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8303836">CharData</span><span class="op" id="8303844">(</span><span class="string" id="8303845">&#34;\n&#34;</span><span class="op" id="8303849">)</span><span class="op" id="8303850">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8303853">StartElement</span><span class="op" id="8303865">{</span><span class="ident" id="8303866">Name</span><span class="op" id="8303870">{</span><span class="string" id="8303871">&#34;&#34;</span><span class="op" id="8303873">,</span>&nbsp;<span class="string" id="8303875">&#34;tag&#34;</span><span class="op" id="8303880">}</span><span class="op" id="8303881">,</span>&nbsp;<span class="op" id="8303883">[</span><span class="op" id="8303884">]</span><span class="ident" id="8303885">Attr</span><span class="op" id="8303889">{</span><span class="op" id="8303890">}</span><span class="op" id="8303891">}</span><span class="op" id="8303892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8303895">CharData</span><span class="op" id="8303903">(</span><span class="string" id="8303904">&#34;non&amp;entity&#34;</span><span class="op" id="8303916">)</span><span class="op" id="8303917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8303920">EndElement</span><span class="op" id="8303930">{</span><span class="ident" id="8303931">Name</span><span class="op" id="8303935">{</span><span class="string" id="8303936">&#34;&#34;</span><span class="op" id="8303938">,</span>&nbsp;<span class="string" id="8303940">&#34;tag&#34;</span><span class="op" id="8303945">}</span><span class="op" id="8303946">}</span><span class="op" id="8303947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8303950">CharData</span><span class="op" id="8303958">(</span><span class="string" id="8303959">&#34;\n&#34;</span><span class="op" id="8303963">)</span><span class="op" id="8303964">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8303967">StartElement</span><span class="op" id="8303979">{</span><span class="ident" id="8303980">Name</span><span class="op" id="8303984">{</span><span class="string" id="8303985">&#34;&#34;</span><span class="op" id="8303987">,</span>&nbsp;<span class="string" id="8303989">&#34;tag&#34;</span><span class="op" id="8303994">}</span><span class="op" id="8303995">,</span>&nbsp;<span class="op" id="8303997">[</span><span class="op" id="8303998">]</span><span class="ident" id="8303999">Attr</span><span class="op" id="8304003">{</span><span class="op" id="8304004">}</span><span class="op" id="8304005">}</span><span class="op" id="8304006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304009">CharData</span><span class="op" id="8304017">(</span><span class="string" id="8304018">&#34;&amp;unknown;entity&#34;</span><span class="op" id="8304035">)</span><span class="op" id="8304036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304039">EndElement</span><span class="op" id="8304049">{</span><span class="ident" id="8304050">Name</span><span class="op" id="8304054">{</span><span class="string" id="8304055">&#34;&#34;</span><span class="op" id="8304057">,</span>&nbsp;<span class="string" id="8304059">&#34;tag&#34;</span><span class="op" id="8304064">}</span><span class="op" id="8304065">}</span><span class="op" id="8304066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304069">CharData</span><span class="op" id="8304077">(</span><span class="string" id="8304078">&#34;\n&#34;</span><span class="op" id="8304082">)</span><span class="op" id="8304083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304086">StartElement</span><span class="op" id="8304098">{</span><span class="ident" id="8304099">Name</span><span class="op" id="8304103">{</span><span class="string" id="8304104">&#34;&#34;</span><span class="op" id="8304106">,</span>&nbsp;<span class="string" id="8304108">&#34;tag&#34;</span><span class="op" id="8304113">}</span><span class="op" id="8304114">,</span>&nbsp;<span class="op" id="8304116">[</span><span class="op" id="8304117">]</span><span class="ident" id="8304118">Attr</span><span class="op" id="8304122">{</span><span class="op" id="8304123">}</span><span class="op" id="8304124">}</span><span class="op" id="8304125">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304128">CharData</span><span class="op" id="8304136">(</span><span class="string" id="8304137">&#34;&amp;#123&#34;</span><span class="op" id="8304144">)</span><span class="op" id="8304145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304148">EndElement</span><span class="op" id="8304158">{</span><span class="ident" id="8304159">Name</span><span class="op" id="8304163">{</span><span class="string" id="8304164">&#34;&#34;</span><span class="op" id="8304166">,</span>&nbsp;<span class="string" id="8304168">&#34;tag&#34;</span><span class="op" id="8304173">}</span><span class="op" id="8304174">}</span><span class="op" id="8304175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304178">CharData</span><span class="op" id="8304186">(</span><span class="string" id="8304187">&#34;\n&#34;</span><span class="op" id="8304191">)</span><span class="op" id="8304192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304195">StartElement</span><span class="op" id="8304207">{</span><span class="ident" id="8304208">Name</span><span class="op" id="8304212">{</span><span class="string" id="8304213">&#34;&#34;</span><span class="op" id="8304215">,</span>&nbsp;<span class="string" id="8304217">&#34;tag&#34;</span><span class="op" id="8304222">}</span><span class="op" id="8304223">,</span>&nbsp;<span class="op" id="8304225">[</span><span class="op" id="8304226">]</span><span class="ident" id="8304227">Attr</span><span class="op" id="8304231">{</span><span class="op" id="8304232">}</span><span class="op" id="8304233">}</span><span class="op" id="8304234">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304237">CharData</span><span class="op" id="8304245">(</span><span class="string" id="8304246">&#34;&amp;#zzz;&#34;</span><span class="op" id="8304254">)</span><span class="op" id="8304255">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304258">EndElement</span><span class="op" id="8304268">{</span><span class="ident" id="8304269">Name</span><span class="op" id="8304273">{</span><span class="string" id="8304274">&#34;&#34;</span><span class="op" id="8304276">,</span>&nbsp;<span class="string" id="8304278">&#34;tag&#34;</span><span class="op" id="8304283">}</span><span class="op" id="8304284">}</span><span class="op" id="8304285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304288">CharData</span><span class="op" id="8304296">(</span><span class="string" id="8304297">&#34;\n&#34;</span><span class="op" id="8304301">)</span><span class="op" id="8304302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304305">StartElement</span><span class="op" id="8304317">{</span><span class="ident" id="8304318">Name</span><span class="op" id="8304322">{</span><span class="string" id="8304323">&#34;&#34;</span><span class="op" id="8304325">,</span>&nbsp;<span class="string" id="8304327">&#34;tag&#34;</span><span class="op" id="8304332">}</span><span class="op" id="8304333">,</span>&nbsp;<span class="op" id="8304335">[</span><span class="op" id="8304336">]</span><span class="ident" id="8304337">Attr</span><span class="op" id="8304341">{</span><span class="op" id="8304342">}</span><span class="op" id="8304343">}</span><span class="op" id="8304344">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304347">CharData</span><span class="op" id="8304355">(</span><span class="string" id="8304356">&#34;&amp;なまえ3;&#34;</span><span class="op" id="8304370">)</span><span class="op" id="8304371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304374">EndElement</span><span class="op" id="8304384">{</span><span class="ident" id="8304385">Name</span><span class="op" id="8304389">{</span><span class="string" id="8304390">&#34;&#34;</span><span class="op" id="8304392">,</span>&nbsp;<span class="string" id="8304394">&#34;tag&#34;</span><span class="op" id="8304399">}</span><span class="op" id="8304400">}</span><span class="op" id="8304401">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304404">CharData</span><span class="op" id="8304412">(</span><span class="string" id="8304413">&#34;\n&#34;</span><span class="op" id="8304417">)</span><span class="op" id="8304418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304421">StartElement</span><span class="op" id="8304433">{</span><span class="ident" id="8304434">Name</span><span class="op" id="8304438">{</span><span class="string" id="8304439">&#34;&#34;</span><span class="op" id="8304441">,</span>&nbsp;<span class="string" id="8304443">&#34;tag&#34;</span><span class="op" id="8304448">}</span><span class="op" id="8304449">,</span>&nbsp;<span class="op" id="8304451">[</span><span class="op" id="8304452">]</span><span class="ident" id="8304453">Attr</span><span class="op" id="8304457">{</span><span class="op" id="8304458">}</span><span class="op" id="8304459">}</span><span class="op" id="8304460">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304463">CharData</span><span class="op" id="8304471">(</span><span class="string" id="8304472">&#34;&amp;lt-gt;&#34;</span><span class="op" id="8304481">)</span><span class="op" id="8304482">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304485">EndElement</span><span class="op" id="8304495">{</span><span class="ident" id="8304496">Name</span><span class="op" id="8304500">{</span><span class="string" id="8304501">&#34;&#34;</span><span class="op" id="8304503">,</span>&nbsp;<span class="string" id="8304505">&#34;tag&#34;</span><span class="op" id="8304510">}</span><span class="op" id="8304511">}</span><span class="op" id="8304512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304515">CharData</span><span class="op" id="8304523">(</span><span class="string" id="8304524">&#34;\n&#34;</span><span class="op" id="8304528">)</span><span class="op" id="8304529">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304532">StartElement</span><span class="op" id="8304544">{</span><span class="ident" id="8304545">Name</span><span class="op" id="8304549">{</span><span class="string" id="8304550">&#34;&#34;</span><span class="op" id="8304552">,</span>&nbsp;<span class="string" id="8304554">&#34;tag&#34;</span><span class="op" id="8304559">}</span><span class="op" id="8304560">,</span>&nbsp;<span class="op" id="8304562">[</span><span class="op" id="8304563">]</span><span class="ident" id="8304564">Attr</span><span class="op" id="8304568">{</span><span class="op" id="8304569">}</span><span class="op" id="8304570">}</span><span class="op" id="8304571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304574">CharData</span><span class="op" id="8304582">(</span><span class="string" id="8304583">&#34;&amp;;&#34;</span><span class="op" id="8304587">)</span><span class="op" id="8304588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304591">EndElement</span><span class="op" id="8304601">{</span><span class="ident" id="8304602">Name</span><span class="op" id="8304606">{</span><span class="string" id="8304607">&#34;&#34;</span><span class="op" id="8304609">,</span>&nbsp;<span class="string" id="8304611">&#34;tag&#34;</span><span class="op" id="8304616">}</span><span class="op" id="8304617">}</span><span class="op" id="8304618">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304621">CharData</span><span class="op" id="8304629">(</span><span class="string" id="8304630">&#34;\n&#34;</span><span class="op" id="8304634">)</span><span class="op" id="8304635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304638">StartElement</span><span class="op" id="8304650">{</span><span class="ident" id="8304651">Name</span><span class="op" id="8304655">{</span><span class="string" id="8304656">&#34;&#34;</span><span class="op" id="8304658">,</span>&nbsp;<span class="string" id="8304660">&#34;tag&#34;</span><span class="op" id="8304665">}</span><span class="op" id="8304666">,</span>&nbsp;<span class="op" id="8304668">[</span><span class="op" id="8304669">]</span><span class="ident" id="8304670">Attr</span><span class="op" id="8304674">{</span><span class="op" id="8304675">}</span><span class="op" id="8304676">}</span><span class="op" id="8304677">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304680">CharData</span><span class="op" id="8304688">(</span><span class="string" id="8304689">&#34;&amp;0a;&#34;</span><span class="op" id="8304695">)</span><span class="op" id="8304696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304699">EndElement</span><span class="op" id="8304709">{</span><span class="ident" id="8304710">Name</span><span class="op" id="8304714">{</span><span class="string" id="8304715">&#34;&#34;</span><span class="op" id="8304717">,</span>&nbsp;<span class="string" id="8304719">&#34;tag&#34;</span><span class="op" id="8304724">}</span><span class="op" id="8304725">}</span><span class="op" id="8304726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304729">CharData</span><span class="op" id="8304737">(</span><span class="string" id="8304738">&#34;\n&#34;</span><span class="op" id="8304742">)</span><span class="op" id="8304743">,</span><br>
<span class="lineno"></span><span class="op" id="8304745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="8304748">func</span>&nbsp;<span class="ident" id="8304753">TestNonStrictRawToken</span><span class="op" id="8304774">(</span><span class="ident" id="8304775">t</span>&nbsp;<span class="op" id="8304777">*</span><span class="ident" id="8304778">testing</span><span class="op" id="8304785">.</span><span class="ident" id="8304786">T</span><span class="op" id="8304787">)</span>&nbsp;<span class="op" id="8304789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304792">d</span>&nbsp;<span class="op" id="8304794">:=</span>&nbsp;<span class="ident" id="8304797">NewDecoder</span><span class="op" id="8304807">(</span><span class="ident" id="8304808">strings</span><span class="op" id="8304815">.</span><span class="ident" id="8304816">NewReader</span><span class="op" id="8304825">(</span><span class="ident" id="8304826">nonStrictInput</span><span class="op" id="8304840">)</span><span class="op" id="8304841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304844">d</span><span class="op" id="8304845">.</span><span class="ident" id="8304846">Strict</span>&nbsp;<span class="op" id="8304853">=</span>&nbsp;<span class="ident" id="8304855">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304862">testRawToken</span><span class="op" id="8304874">(</span><span class="ident" id="8304875">t</span><span class="op" id="8304876">,</span>&nbsp;<span class="ident" id="8304878">d</span><span class="op" id="8304879">,</span>&nbsp;<span class="ident" id="8304881">nonStrictInput</span><span class="op" id="8304895">,</span>&nbsp;<span class="ident" id="8304897">nonStrictTokens</span><span class="op" id="8304912">)</span><br>
<span class="lineno"></span><span class="op" id="8304914">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="8304917">type</span>&nbsp;<span class="ident" id="8304922">downCaser</span>&nbsp;<span class="keyword" id="8304932">struct</span>&nbsp;<span class="op" id="8304939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304942">t</span>&nbsp;<span class="op" id="8304944">*</span><span class="ident" id="8304945">testing</span><span class="op" id="8304952">.</span><span class="ident" id="8304953">T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8304956">r</span>&nbsp;<span class="ident" id="8304958">io</span><span class="op" id="8304960">.</span><span class="ident" id="8304961">ByteReader</span><br>
<span class="lineno"></span><span class="op" id="8304972">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="8304975">func</span>&nbsp;<span class="op" id="8304980">(</span><span class="ident" id="8304981">d</span>&nbsp;<span class="op" id="8304983">*</span><span class="ident" id="8304984">downCaser</span><span class="op" id="8304993">)</span>&nbsp;<span class="ident" id="8304995">ReadByte</span><span class="op" id="8305003">(</span><span class="op" id="8305004">)</span>&nbsp;<span class="op" id="8305006">(</span><span class="ident" id="8305007">c</span>&nbsp;<span class="builtintype" id="8305009">byte</span><span class="op" id="8305013">,</span>&nbsp;<span class="ident" id="8305015">err</span>&nbsp;<span class="builtintype" id="8305019">error</span><span class="op" id="8305024">)</span>&nbsp;<span class="op" id="8305026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8305029">c</span><span class="op" id="8305030">,</span>&nbsp;<span class="ident" id="8305032">err</span>&nbsp;<span class="op" id="8305036">=</span>&nbsp;<span class="ident" id="8305038">d</span><span class="op" id="8305039">.</span><span class="ident" id="8305040">r</span><span class="op" id="8305041">.</span><span class="ident" id="8305042">ReadByte</span><span class="op" id="8305050">(</span><span class="op" id="8305051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8305054">if</span>&nbsp;<span class="ident" id="8305057">c</span>&nbsp;<span class="op" id="8305059">&gt;=</span>&nbsp;<span class="string" id="8305062">&#39;A&#39;</span>&nbsp;<span class="op" id="8305066">&amp;&amp;</span>&nbsp;<span class="ident" id="8305069">c</span>&nbsp;<span class="op" id="8305071">&lt;=</span>&nbsp;<span class="string" id="8305074">&#39;Z&#39;</span>&nbsp;<span class="op" id="8305078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8305082">c</span>&nbsp;<span class="op" id="8305084">+=</span>&nbsp;<span class="string" id="8305087">&#39;a&#39;</span>&nbsp;<span class="op" id="8305091">-</span>&nbsp;<span class="string" id="8305093">&#39;A&#39;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8305098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8305101">return</span><br>
<span class="lineno"></span><span class="op" id="8305108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8305111">func</span>&nbsp;<span class="op" id="8305116">(</span><span class="ident" id="8305117">d</span>&nbsp;<span class="op" id="8305119">*</span><span class="ident" id="8305120">downCaser</span><span class="op" id="8305129">)</span>&nbsp;<span class="ident" id="8305131">Read</span><span class="op" id="8305135">(</span><span class="ident" id="8305136">p</span>&nbsp;<span class="op" id="8305138">[</span><span class="op" id="8305139">]</span><span class="builtintype" id="8305140">byte</span><span class="op" id="8305144">)</span>&nbsp;<span class="op" id="8305146">(</span><span class="builtintype" id="8305147">int</span><span class="op" id="8305150">,</span>&nbsp;<span class="builtintype" id="8305152">error</span><span class="op" id="8305157">)</span>&nbsp;<span class="op" id="8305159">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8305162">d</span><span class="op" id="8305163">.</span><span class="ident" id="8305164">t</span><span class="op" id="8305165">.</span><span class="ident" id="8305166">Fatalf</span><span class="op" id="8305172">(</span><span class="string" id="8305173">&#34;unexpected&nbsp;Read&nbsp;call&nbsp;on&nbsp;downCaser&nbsp;reader&#34;</span><span class="op" id="8305215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8305218">panic</span><span class="op" id="8305223">(</span><span class="string" id="8305224">&#34;unreachable&#34;</span><span class="op" id="8305237">)</span><br>
<span class="lineno"></span><span class="op" id="8305239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8305242">func</span>&nbsp;<span class="ident" id="8305247">TestRawTokenAltEncoding</span><span class="op" id="8305270">(</span><span class="ident" id="8305271">t</span>&nbsp;<span class="op" id="8305273">*</span><span class="ident" id="8305274">testing</span><span class="op" id="8305281">.</span><span class="ident" id="8305282">T</span><span class="op" id="8305283">)</span>&nbsp;<span class="op" id="8305285">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8305288">d</span>&nbsp;<span class="op" id="8305290">:=</span>&nbsp;<span class="ident" id="8305293">NewDecoder</span><span class="op" id="8305303">(</span><span class="ident" id="8305304">strings</span><span class="op" id="8305311">.</span><span class="ident" id="8305312">NewReader</span><span class="op" id="8305321">(</span><span class="ident" id="8305322">testInputAltEncoding</span><span class="op" id="8305342">)</span><span class="op" id="8305343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8305346">d</span><span class="op" id="8305347">.</span><span class="ident" id="8305348">CharsetReader</span>&nbsp;<span class="op" id="8305362">=</span>&nbsp;<span class="keyword" id="8305364">func</span><span class="op" id="8305368">(</span><span class="ident" id="8305369">charset</span>&nbsp;<span class="builtintype" id="8305377">string</span><span class="op" id="8305383">,</span>&nbsp;<span class="ident" id="8305385">input</span>&nbsp;<span class="ident" id="8305391">io</span><span class="op" id="8305393">.</span><span class="ident" id="8305394">Reader</span><span class="op" id="8305400">)</span>&nbsp;<span class="op" id="8305402">(</span><span class="ident" id="8305403">io</span><span class="op" id="8305405">.</span><span class="ident" id="8305406">Reader</span><span class="op" id="8305412">,</span>&nbsp;<span class="builtintype" id="8305414">error</span><span class="op" id="8305419">)</span>&nbsp;<span class="op" id="8305421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8305425">if</span>&nbsp;<span class="ident" id="8305428">charset</span>&nbsp;<span class="op" id="8305436">!=</span>&nbsp;<span class="string" id="8305439">&#34;x-testing-uppercase&#34;</span>&nbsp;<span class="op" id="8305461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8305466">t</span><span class="op" id="8305467">.</span><span class="ident" id="8305468">Fatalf</span><span class="op" id="8305474">(</span><span class="string" id="8305475">&#34;unexpected&nbsp;charset&nbsp;%q&#34;</span><span class="op" id="8305498">,</span>&nbsp;<span class="ident" id="8305500">charset</span><span class="op" id="8305507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8305511">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8305515">return</span>&nbsp;<span class="op" id="8305522">&amp;</span><span class="ident" id="8305523">downCaser</span><span class="op" id="8305532">{</span><span class="ident" id="8305533">t</span><span class="op" id="8305534">,</span>&nbsp;<span class="ident" id="8305536">input</span><span class="op" id="8305541">.</span><span class="op" id="8305542">(</span><span class="ident" id="8305543">io</span><span class="op" id="8305545">.</span><span class="ident" id="8305546">ByteReader</span><span class="op" id="8305556">)</span><span class="op" id="8305557">}</span><span class="op" id="8305558">,</span>&nbsp;<span class="ident" id="8305560">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8305565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8305568">testRawToken</span><span class="op" id="8305580">(</span><span class="ident" id="8305581">t</span><span class="op" id="8305582">,</span>&nbsp;<span class="ident" id="8305584">d</span><span class="op" id="8305585">,</span>&nbsp;<span class="ident" id="8305587">testInputAltEncoding</span><span class="op" id="8305607">,</span>&nbsp;<span class="ident" id="8305609">rawTokensAltEncoding</span><span class="op" id="8305629">)</span><br>
<span class="lineno"></span><span class="op" id="8305631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="8305634">func</span>&nbsp;<span class="ident" id="8305639">TestRawTokenAltEncodingNoConverter</span><span class="op" id="8305673">(</span><span class="ident" id="8305674">t</span>&nbsp;<span class="op" id="8305676">*</span><span class="ident" id="8305677">testing</span><span class="op" id="8305684">.</span><span class="ident" id="8305685">T</span><span class="op" id="8305686">)</span>&nbsp;<span class="op" id="8305688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8305691">d</span>&nbsp;<span class="op" id="8305693">:=</span>&nbsp;<span class="ident" id="8305696">NewDecoder</span><span class="op" id="8305706">(</span><span class="ident" id="8305707">strings</span><span class="op" id="8305714">.</span><span class="ident" id="8305715">NewReader</span><span class="op" id="8305724">(</span><span class="ident" id="8305725">testInputAltEncoding</span><span class="op" id="8305745">)</span><span class="op" id="8305746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8305749">token</span><span class="op" id="8305754">,</span>&nbsp;<span class="ident" id="8305756">err</span>&nbsp;<span class="op" id="8305760">:=</span>&nbsp;<span class="ident" id="8305763">d</span><span class="op" id="8305764">.</span><span class="ident" id="8305765">RawToken</span><span class="op" id="8305773">(</span><span class="op" id="8305774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8305777">if</span>&nbsp;<span class="ident" id="8305780">token</span>&nbsp;<span class="op" id="8305786">==</span>&nbsp;<span class="ident" id="8305789">nil</span>&nbsp;<span class="op" id="8305793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8305797">t</span><span class="op" id="8305798">.</span><span class="ident" id="8305799">Fatalf</span><span class="op" id="8305805">(</span><span class="string" id="8305806">&#34;expected&nbsp;a&nbsp;token&nbsp;on&nbsp;first&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="8305847">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8305850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8305853">if</span>&nbsp;<span class="ident" id="8305856">err</span>&nbsp;<span class="op" id="8305860">!=</span>&nbsp;<span class="ident" id="8305863">nil</span>&nbsp;<span class="op" id="8305867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8305871">t</span><span class="op" id="8305872">.</span><span class="ident" id="8305873">Fatal</span><span class="op" id="8305878">(</span><span class="ident" id="8305879">err</span><span class="op" id="8305882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8305885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8305888">token</span><span class="op" id="8305893">,</span>&nbsp;<span class="ident" id="8305895">err</span>&nbsp;<span class="op" id="8305899">=</span>&nbsp;<span class="ident" id="8305901">d</span><span class="op" id="8305902">.</span><span class="ident" id="8305903">RawToken</span><span class="op" id="8305911">(</span><span class="op" id="8305912">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8305915">if</span>&nbsp;<span class="ident" id="8305918">token</span>&nbsp;<span class="op" id="8305924">!=</span>&nbsp;<span class="ident" id="8305927">nil</span>&nbsp;<span class="op" id="8305931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8305935">t</span><span class="op" id="8305936">.</span><span class="ident" id="8305937">Errorf</span><span class="op" id="8305943">(</span><span class="string" id="8305944">&#34;expected&nbsp;a&nbsp;nil&nbsp;token;&nbsp;got&nbsp;%#v&#34;</span><span class="op" id="8305975">,</span>&nbsp;<span class="ident" id="8305977">token</span><span class="op" id="8305982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8305985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8305988">if</span>&nbsp;<span class="ident" id="8305991">err</span>&nbsp;<span class="op" id="8305995">==</span>&nbsp;<span class="ident" id="8305998">nil</span>&nbsp;<span class="op" id="8306002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8306006">t</span><span class="op" id="8306007">.</span><span class="ident" id="8306008">Fatalf</span><span class="op" id="8306014">(</span><span class="string" id="8306015">&#34;expected&nbsp;an&nbsp;error&nbsp;on&nbsp;second&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="8306058">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8306061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8306064">const</span>&nbsp;<span class="ident" id="8306070">encoding</span>&nbsp;<span class="op" id="8306079">=</span>&nbsp;<span class="string" id="8306081">&#34;x-testing-uppercase&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8306104">if</span>&nbsp;<span class="op" id="8306107">!</span><span class="ident" id="8306108">strings</span><span class="op" id="8306115">.</span><span class="ident" id="8306116">Contains</span><span class="op" id="8306124">(</span><span class="ident" id="8306125">err</span><span class="op" id="8306128">.</span><span class="ident" id="8306129">Error</span><span class="op" id="8306134">(</span><span class="op" id="8306135">)</span><span class="op" id="8306136">,</span>&nbsp;<span class="ident" id="8306138">encoding</span><span class="op" id="8306146">)</span>&nbsp;<span class="op" id="8306148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8306152">t</span><span class="op" id="8306153">.</span><span class="ident" id="8306154">Errorf</span><span class="op" id="8306160">(</span><span class="string" id="8306161">&#34;expected&nbsp;error&nbsp;to&nbsp;contain&nbsp;%q;&nbsp;got&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8306206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8306211">encoding</span><span class="op" id="8306219">,</span>&nbsp;<span class="ident" id="8306221">err</span><span class="op" id="8306224">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8306227">}</span><br>
<span class="lineno"></span><span class="op" id="8306229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8306232">func</span>&nbsp;<span class="ident" id="8306237">testRawToken</span><span class="op" id="8306249">(</span><span class="ident" id="8306250">t</span>&nbsp;<span class="op" id="8306252">*</span><span class="ident" id="8306253">testing</span><span class="op" id="8306260">.</span><span class="ident" id="8306261">T</span><span class="op" id="8306262">,</span>&nbsp;<span class="ident" id="8306264">d</span>&nbsp;<span class="op" id="8306266">*</span><span class="ident" id="8306267">Decoder</span><span class="op" id="8306274">,</span>&nbsp;<span class="ident" id="8306276">raw</span>&nbsp;<span class="builtintype" id="8306280">string</span><span class="op" id="8306286">,</span>&nbsp;<span class="ident" id="8306288">rawTokens</span>&nbsp;<span class="op" id="8306298">[</span><span class="op" id="8306299">]</span><span class="ident" id="8306300">Token</span><span class="op" id="8306305">)</span>&nbsp;<span class="op" id="8306307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8306310">lastEnd</span>&nbsp;<span class="op" id="8306318">:=</span>&nbsp;<span class="ident" id="8306321">int64</span><span class="op" id="8306326">(</span><span class="num" id="8306327">0</span><span class="op" id="8306328">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8306331">for</span>&nbsp;<span class="ident" id="8306335">i</span><span class="op" id="8306336">,</span>&nbsp;<span class="ident" id="8306338">want</span>&nbsp;<span class="op" id="8306343">:=</span>&nbsp;<span class="keyword" id="8306346">range</span>&nbsp;<span class="ident" id="8306352">rawTokens</span>&nbsp;<span class="op" id="8306362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8306366">start</span>&nbsp;<span class="op" id="8306372">:=</span>&nbsp;<span class="ident" id="8306375">d</span><span class="op" id="8306376">.</span><span class="ident" id="8306377">InputOffset</span><span class="op" id="8306388">(</span><span class="op" id="8306389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8306393">have</span><span class="op" id="8306397">,</span>&nbsp;<span class="ident" id="8306399">err</span>&nbsp;<span class="op" id="8306403">:=</span>&nbsp;<span class="ident" id="8306406">d</span><span class="op" id="8306407">.</span><span class="ident" id="8306408">RawToken</span><span class="op" id="8306416">(</span><span class="op" id="8306417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8306421">end</span>&nbsp;<span class="op" id="8306425">:=</span>&nbsp;<span class="ident" id="8306428">d</span><span class="op" id="8306429">.</span><span class="ident" id="8306430">InputOffset</span><span class="op" id="8306441">(</span><span class="op" id="8306442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8306446">if</span>&nbsp;<span class="ident" id="8306449">err</span>&nbsp;<span class="op" id="8306453">!=</span>&nbsp;<span class="ident" id="8306456">nil</span>&nbsp;<span class="op" id="8306460">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8306465">t</span><span class="op" id="8306466">.</span><span class="ident" id="8306467">Fatalf</span><span class="op" id="8306473">(</span><span class="string" id="8306474">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8306506">,</span>&nbsp;<span class="ident" id="8306508">i</span><span class="op" id="8306509">,</span>&nbsp;<span class="ident" id="8306511">err</span><span class="op" id="8306514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8306518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8306522">if</span>&nbsp;<span class="op" id="8306525">!</span><span class="ident" id="8306526">reflect</span><span class="op" id="8306533">.</span><span class="ident" id="8306534">DeepEqual</span><span class="op" id="8306543">(</span><span class="ident" id="8306544">have</span><span class="op" id="8306548">,</span>&nbsp;<span class="ident" id="8306550">want</span><span class="op" id="8306554">)</span>&nbsp;<span class="op" id="8306556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8306561">var</span>&nbsp;<span class="ident" id="8306565">shave</span><span class="op" id="8306570">,</span>&nbsp;<span class="ident" id="8306572">swant</span>&nbsp;<span class="builtintype" id="8306578">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8306588">if</span>&nbsp;<span class="ident" id="8306591">_</span><span class="op" id="8306592">,</span>&nbsp;<span class="ident" id="8306594">ok</span>&nbsp;<span class="op" id="8306597">:=</span>&nbsp;<span class="ident" id="8306600">have</span><span class="op" id="8306604">.</span><span class="op" id="8306605">(</span><span class="ident" id="8306606">CharData</span><span class="op" id="8306614">)</span><span class="op" id="8306615">;</span>&nbsp;<span class="ident" id="8306617">ok</span>&nbsp;<span class="op" id="8306620">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8306626">shave</span>&nbsp;<span class="op" id="8306632">=</span>&nbsp;<span class="ident" id="8306634">fmt</span><span class="op" id="8306637">.</span><span class="ident" id="8306638">Sprintf</span><span class="op" id="8306645">(</span><span class="string" id="8306646">&#34;CharData(%q)&#34;</span><span class="op" id="8306660">,</span>&nbsp;<span class="ident" id="8306662">have</span><span class="op" id="8306666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8306671">}</span>&nbsp;<span class="keyword" id="8306673">else</span>&nbsp;<span class="op" id="8306678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8306684">shave</span>&nbsp;<span class="op" id="8306690">=</span>&nbsp;<span class="ident" id="8306692">fmt</span><span class="op" id="8306695">.</span><span class="ident" id="8306696">Sprintf</span><span class="op" id="8306703">(</span><span class="string" id="8306704">&#34;%#v&#34;</span><span class="op" id="8306709">,</span>&nbsp;<span class="ident" id="8306711">have</span><span class="op" id="8306715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8306720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8306725">if</span>&nbsp;<span class="ident" id="8306728">_</span><span class="op" id="8306729">,</span>&nbsp;<span class="ident" id="8306731">ok</span>&nbsp;<span class="op" id="8306734">:=</span>&nbsp;<span class="ident" id="8306737">want</span><span class="op" id="8306741">.</span><span class="op" id="8306742">(</span><span class="ident" id="8306743">CharData</span><span class="op" id="8306751">)</span><span class="op" id="8306752">;</span>&nbsp;<span class="ident" id="8306754">ok</span>&nbsp;<span class="op" id="8306757">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8306763">swant</span>&nbsp;<span class="op" id="8306769">=</span>&nbsp;<span class="ident" id="8306771">fmt</span><span class="op" id="8306774">.</span><span class="ident" id="8306775">Sprintf</span><span class="op" id="8306782">(</span><span class="string" id="8306783">&#34;CharData(%q)&#34;</span><span class="op" id="8306797">,</span>&nbsp;<span class="ident" id="8306799">want</span><span class="op" id="8306803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8306808">}</span>&nbsp;<span class="keyword" id="8306810">else</span>&nbsp;<span class="op" id="8306815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8306821">swant</span>&nbsp;<span class="op" id="8306827">=</span>&nbsp;<span class="ident" id="8306829">fmt</span><span class="op" id="8306832">.</span><span class="ident" id="8306833">Sprintf</span><span class="op" id="8306840">(</span><span class="string" id="8306841">&#34;%#v&#34;</span><span class="op" id="8306846">,</span>&nbsp;<span class="ident" id="8306848">want</span><span class="op" id="8306852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8306857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8306862">t</span><span class="op" id="8306863">.</span><span class="ident" id="8306864">Errorf</span><span class="op" id="8306870">(</span><span class="string" id="8306871">&#34;token&nbsp;%d&nbsp;=&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8306895">,</span>&nbsp;<span class="ident" id="8306897">i</span><span class="op" id="8306898">,</span>&nbsp;<span class="ident" id="8306900">shave</span><span class="op" id="8306905">,</span>&nbsp;<span class="ident" id="8306907">swant</span><span class="op" id="8306912">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8306916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8306921">//&nbsp;Check&nbsp;that&nbsp;InputOffset&nbsp;returned&nbsp;actual&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8306972">switch</span>&nbsp;<span class="op" id="8306979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8306983">case</span>&nbsp;<span class="ident" id="8306988">start</span>&nbsp;<span class="op" id="8306994">&lt;</span>&nbsp;<span class="ident" id="8306996">lastEnd</span><span class="op" id="8307003">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8307008">t</span><span class="op" id="8307009">.</span><span class="ident" id="8307010">Errorf</span><span class="op" id="8307016">(</span><span class="string" id="8307017">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;before&nbsp;previous&nbsp;token&#34;</span><span class="op" id="8307077">,</span>&nbsp;<span class="ident" id="8307079">i</span><span class="op" id="8307080">,</span>&nbsp;<span class="ident" id="8307082">start</span><span class="op" id="8307087">,</span>&nbsp;<span class="ident" id="8307089">end</span><span class="op" id="8307092">,</span>&nbsp;<span class="ident" id="8307094">have</span><span class="op" id="8307098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8307102">case</span>&nbsp;<span class="ident" id="8307107">start</span>&nbsp;<span class="op" id="8307113">&gt;=</span>&nbsp;<span class="ident" id="8307116">end</span><span class="op" id="8307119">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8307124">//&nbsp;Special&nbsp;case:&nbsp;EndElement&nbsp;can&nbsp;be&nbsp;synthesized.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8307175">if</span>&nbsp;<span class="ident" id="8307178">start</span>&nbsp;<span class="op" id="8307184">==</span>&nbsp;<span class="ident" id="8307187">end</span>&nbsp;<span class="op" id="8307191">&amp;&amp;</span>&nbsp;<span class="ident" id="8307194">end</span>&nbsp;<span class="op" id="8307198">==</span>&nbsp;<span class="ident" id="8307201">lastEnd</span>&nbsp;<span class="op" id="8307209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8307215">break</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8307224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8307229">t</span><span class="op" id="8307230">.</span><span class="ident" id="8307231">Errorf</span><span class="op" id="8307237">(</span><span class="string" id="8307238">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;empty&#34;</span><span class="op" id="8307282">,</span>&nbsp;<span class="ident" id="8307284">i</span><span class="op" id="8307285">,</span>&nbsp;<span class="ident" id="8307287">start</span><span class="op" id="8307292">,</span>&nbsp;<span class="ident" id="8307294">end</span><span class="op" id="8307297">,</span>&nbsp;<span class="ident" id="8307299">have</span><span class="op" id="8307303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8307307">case</span>&nbsp;<span class="ident" id="8307312">end</span>&nbsp;<span class="op" id="8307316">&gt;</span>&nbsp;<span class="ident" id="8307318">int64</span><span class="op" id="8307323">(</span><span class="builtinfunc" id="8307324">len</span><span class="op" id="8307327">(</span><span class="ident" id="8307328">raw</span><span class="op" id="8307331">)</span><span class="op" id="8307332">)</span><span class="op" id="8307333">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8307338">t</span><span class="op" id="8307339">.</span><span class="ident" id="8307340">Errorf</span><span class="op" id="8307346">(</span><span class="string" id="8307347">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;extends&nbsp;beyond&nbsp;input&#34;</span><span class="op" id="8307403">,</span>&nbsp;<span class="ident" id="8307405">i</span><span class="op" id="8307406">,</span>&nbsp;<span class="ident" id="8307408">start</span><span class="op" id="8307413">,</span>&nbsp;<span class="ident" id="8307415">end</span><span class="op" id="8307418">,</span>&nbsp;<span class="ident" id="8307420">have</span><span class="op" id="8307424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8307428">default</span><span class="op" id="8307435">:</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8307440">text</span>&nbsp;<span class="op" id="8307445">:=</span>&nbsp;<span class="ident" id="8307448">raw</span><span class="op" id="8307451">[</span><span class="ident" id="8307452">start</span><span class="op" id="8307457">:</span><span class="ident" id="8307458">end</span><span class="op" id="8307461">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8307466">if</span>&nbsp;<span class="ident" id="8307469">strings</span><span class="op" id="8307476">.</span><span class="ident" id="8307477">ContainsAny</span><span class="op" id="8307488">(</span><span class="ident" id="8307489">text</span><span class="op" id="8307493">,</span>&nbsp;<span class="string" id="8307495">&#34;&lt;&gt;&#34;</span><span class="op" id="8307499">)</span>&nbsp;<span class="op" id="8307501">&amp;&amp;</span>&nbsp;<span class="op" id="8307504">(</span><span class="op" id="8307505">!</span><span class="ident" id="8307506">strings</span><span class="op" id="8307513">.</span><span class="ident" id="8307514">HasPrefix</span><span class="op" id="8307523">(</span><span class="ident" id="8307524">text</span><span class="op" id="8307528">,</span>&nbsp;<span class="string" id="8307530">&#34;&lt;&#34;</span><span class="op" id="8307533">)</span>&nbsp;<span class="op" id="8307535">||</span>&nbsp;<span class="op" id="8307538">!</span><span class="ident" id="8307539">strings</span><span class="op" id="8307546">.</span><span class="ident" id="8307547">HasSuffix</span><span class="op" id="8307556">(</span><span class="ident" id="8307557">text</span><span class="op" id="8307561">,</span>&nbsp;<span class="string" id="8307563">&#34;&gt;&#34;</span><span class="op" id="8307566">)</span><span class="op" id="8307567">)</span>&nbsp;<span class="op" id="8307569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8307575">t</span><span class="op" id="8307576">.</span><span class="ident" id="8307577">Errorf</span><span class="op" id="8307583">(</span><span class="string" id="8307584">&#34;token&nbsp;%d:&nbsp;misaligned&nbsp;raw&nbsp;token&nbsp;%#q&nbsp;for&nbsp;%T&#34;</span><span class="op" id="8307627">,</span>&nbsp;<span class="ident" id="8307629">i</span><span class="op" id="8307630">,</span>&nbsp;<span class="ident" id="8307632">text</span><span class="op" id="8307636">,</span>&nbsp;<span class="ident" id="8307638">have</span><span class="op" id="8307642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8307647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8307651">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8307655">lastEnd</span>&nbsp;<span class="op" id="8307663">=</span>&nbsp;<span class="ident" id="8307665">end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8307670">}</span><br>
<span class="lineno"></span><span class="op" id="8307672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8307675">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;(specifically&nbsp;!DOCTYPE)&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno">330</span><span class="comment" id="8307746">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives,&nbsp;noting&nbsp;that&nbsp;&lt;&nbsp;and&nbsp;&gt;&nbsp;do&nbsp;not&nbsp;change</span><br>
<span class="lineno"></span><span class="comment" id="8307814">//&nbsp;nesting&nbsp;depth&nbsp;if&nbsp;they&nbsp;are&nbsp;in&nbsp;single&nbsp;or&nbsp;double&nbsp;quotes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8307872">var</span>&nbsp;<span class="ident" id="8307876">nestedDirectivesInput</span>&nbsp;<span class="op" id="8307898">=</span>&nbsp;<span class="string" id="8307900">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno">335</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]&gt;<br>
<span class="lineno">340</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8308166">var</span>&nbsp;<span class="ident" id="8308170">nestedDirectivesTokens</span>&nbsp;<span class="op" id="8308193">=</span>&nbsp;<span class="op" id="8308195">[</span><span class="op" id="8308196">]</span><span class="ident" id="8308197">Token</span><span class="op" id="8308202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8308205">CharData</span><span class="op" id="8308213">(</span><span class="string" id="8308214">&#34;\n&#34;</span><span class="op" id="8308218">)</span><span class="op" id="8308219">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8308222">Directive</span><span class="op" id="8308231">(</span><span class="string" id="8308232">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="8308303">)</span><span class="op" id="8308304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8308307">CharData</span><span class="op" id="8308315">(</span><span class="string" id="8308316">&#34;\n&#34;</span><span class="op" id="8308320">)</span><span class="op" id="8308321">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8308324">Directive</span><span class="op" id="8308333">(</span><span class="string" id="8308334">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]`</span><span class="op" id="8308363">)</span><span class="op" id="8308364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8308367">CharData</span><span class="op" id="8308375">(</span><span class="string" id="8308376">&#34;\n&#34;</span><span class="op" id="8308380">)</span><span class="op" id="8308381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8308384">Directive</span><span class="op" id="8308393">(</span><span class="string" id="8308394">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]`</span><span class="op" id="8308423">)</span><span class="op" id="8308424">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8308427">CharData</span><span class="op" id="8308435">(</span><span class="string" id="8308436">&#34;\n&#34;</span><span class="op" id="8308440">)</span><span class="op" id="8308441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8308444">Directive</span><span class="op" id="8308453">(</span><span class="string" id="8308454">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]`</span><span class="op" id="8308483">)</span><span class="op" id="8308484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8308487">CharData</span><span class="op" id="8308495">(</span><span class="string" id="8308496">&#34;\n&#34;</span><span class="op" id="8308500">)</span><span class="op" id="8308501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8308504">Directive</span><span class="op" id="8308513">(</span><span class="string" id="8308514">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]`</span><span class="op" id="8308543">)</span><span class="op" id="8308544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8308547">CharData</span><span class="op" id="8308555">(</span><span class="string" id="8308556">&#34;\n&#34;</span><span class="op" id="8308560">)</span><span class="op" id="8308561">,</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8308564">Directive</span><span class="op" id="8308573">(</span><span class="string" id="8308574">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]`</span><span class="op" id="8308604">)</span><span class="op" id="8308605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8308608">CharData</span><span class="op" id="8308616">(</span><span class="string" id="8308617">&#34;\n&#34;</span><span class="op" id="8308621">)</span><span class="op" id="8308622">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8308625">Directive</span><span class="op" id="8308634">(</span><span class="string" id="8308635">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]`</span><span class="op" id="8308665">)</span><span class="op" id="8308666">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8308669">CharData</span><span class="op" id="8308677">(</span><span class="string" id="8308678">&#34;\n&#34;</span><span class="op" id="8308682">)</span><span class="op" id="8308683">,</span><br>
<span class="lineno"></span><span class="op" id="8308685">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="8308688">func</span>&nbsp;<span class="ident" id="8308693">TestNestedDirectives</span><span class="op" id="8308713">(</span><span class="ident" id="8308714">t</span>&nbsp;<span class="op" id="8308716">*</span><span class="ident" id="8308717">testing</span><span class="op" id="8308724">.</span><span class="ident" id="8308725">T</span><span class="op" id="8308726">)</span>&nbsp;<span class="op" id="8308728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8308731">d</span>&nbsp;<span class="op" id="8308733">:=</span>&nbsp;<span class="ident" id="8308736">NewDecoder</span><span class="op" id="8308746">(</span><span class="ident" id="8308747">strings</span><span class="op" id="8308754">.</span><span class="ident" id="8308755">NewReader</span><span class="op" id="8308764">(</span><span class="ident" id="8308765">nestedDirectivesInput</span><span class="op" id="8308786">)</span><span class="op" id="8308787">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8308791">for</span>&nbsp;<span class="ident" id="8308795">i</span><span class="op" id="8308796">,</span>&nbsp;<span class="ident" id="8308798">want</span>&nbsp;<span class="op" id="8308803">:=</span>&nbsp;<span class="keyword" id="8308806">range</span>&nbsp;<span class="ident" id="8308812">nestedDirectivesTokens</span>&nbsp;<span class="op" id="8308835">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8308839">have</span><span class="op" id="8308843">,</span>&nbsp;<span class="ident" id="8308845">err</span>&nbsp;<span class="op" id="8308849">:=</span>&nbsp;<span class="ident" id="8308852">d</span><span class="op" id="8308853">.</span><span class="ident" id="8308854">Token</span><span class="op" id="8308859">(</span><span class="op" id="8308860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8308864">if</span>&nbsp;<span class="ident" id="8308867">err</span>&nbsp;<span class="op" id="8308871">!=</span>&nbsp;<span class="ident" id="8308874">nil</span>&nbsp;<span class="op" id="8308878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8308883">t</span><span class="op" id="8308884">.</span><span class="ident" id="8308885">Fatalf</span><span class="op" id="8308891">(</span><span class="string" id="8308892">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8308924">,</span>&nbsp;<span class="ident" id="8308926">i</span><span class="op" id="8308927">,</span>&nbsp;<span class="ident" id="8308929">err</span><span class="op" id="8308932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8308936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8308940">if</span>&nbsp;<span class="op" id="8308943">!</span><span class="ident" id="8308944">reflect</span><span class="op" id="8308951">.</span><span class="ident" id="8308952">DeepEqual</span><span class="op" id="8308961">(</span><span class="ident" id="8308962">have</span><span class="op" id="8308966">,</span>&nbsp;<span class="ident" id="8308968">want</span><span class="op" id="8308972">)</span>&nbsp;<span class="op" id="8308974">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8308979">t</span><span class="op" id="8308980">.</span><span class="ident" id="8308981">Errorf</span><span class="op" id="8308987">(</span><span class="string" id="8308988">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="8309013">,</span>&nbsp;<span class="ident" id="8309015">i</span><span class="op" id="8309016">,</span>&nbsp;<span class="ident" id="8309018">have</span><span class="op" id="8309022">,</span>&nbsp;<span class="ident" id="8309024">want</span><span class="op" id="8309028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8309032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8309035">}</span><br>
<span class="lineno"></span><span class="op" id="8309037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="keyword" id="8309040">func</span>&nbsp;<span class="ident" id="8309045">TestToken</span><span class="op" id="8309054">(</span><span class="ident" id="8309055">t</span>&nbsp;<span class="op" id="8309057">*</span><span class="ident" id="8309058">testing</span><span class="op" id="8309065">.</span><span class="ident" id="8309066">T</span><span class="op" id="8309067">)</span>&nbsp;<span class="op" id="8309069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8309072">d</span>&nbsp;<span class="op" id="8309074">:=</span>&nbsp;<span class="ident" id="8309077">NewDecoder</span><span class="op" id="8309087">(</span><span class="ident" id="8309088">strings</span><span class="op" id="8309095">.</span><span class="ident" id="8309096">NewReader</span><span class="op" id="8309105">(</span><span class="ident" id="8309106">testInput</span><span class="op" id="8309115">)</span><span class="op" id="8309116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8309119">d</span><span class="op" id="8309120">.</span><span class="ident" id="8309121">Entity</span>&nbsp;<span class="op" id="8309128">=</span>&nbsp;<span class="ident" id="8309130">testEntity</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8309143">for</span>&nbsp;<span class="ident" id="8309147">i</span><span class="op" id="8309148">,</span>&nbsp;<span class="ident" id="8309150">want</span>&nbsp;<span class="op" id="8309155">:=</span>&nbsp;<span class="keyword" id="8309158">range</span>&nbsp;<span class="ident" id="8309164">cookedTokens</span>&nbsp;<span class="op" id="8309177">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8309181">have</span><span class="op" id="8309185">,</span>&nbsp;<span class="ident" id="8309187">err</span>&nbsp;<span class="op" id="8309191">:=</span>&nbsp;<span class="ident" id="8309194">d</span><span class="op" id="8309195">.</span><span class="ident" id="8309196">Token</span><span class="op" id="8309201">(</span><span class="op" id="8309202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8309206">if</span>&nbsp;<span class="ident" id="8309209">err</span>&nbsp;<span class="op" id="8309213">!=</span>&nbsp;<span class="ident" id="8309216">nil</span>&nbsp;<span class="op" id="8309220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8309225">t</span><span class="op" id="8309226">.</span><span class="ident" id="8309227">Fatalf</span><span class="op" id="8309233">(</span><span class="string" id="8309234">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8309266">,</span>&nbsp;<span class="ident" id="8309268">i</span><span class="op" id="8309269">,</span>&nbsp;<span class="ident" id="8309271">err</span><span class="op" id="8309274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8309278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8309282">if</span>&nbsp;<span class="op" id="8309285">!</span><span class="ident" id="8309286">reflect</span><span class="op" id="8309293">.</span><span class="ident" id="8309294">DeepEqual</span><span class="op" id="8309303">(</span><span class="ident" id="8309304">have</span><span class="op" id="8309308">,</span>&nbsp;<span class="ident" id="8309310">want</span><span class="op" id="8309314">)</span>&nbsp;<span class="op" id="8309316">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8309321">t</span><span class="op" id="8309322">.</span><span class="ident" id="8309323">Errorf</span><span class="op" id="8309329">(</span><span class="string" id="8309330">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="8309355">,</span>&nbsp;<span class="ident" id="8309357">i</span><span class="op" id="8309358">,</span>&nbsp;<span class="ident" id="8309360">have</span><span class="op" id="8309364">,</span>&nbsp;<span class="ident" id="8309366">want</span><span class="op" id="8309370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8309374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8309377">}</span><br>
<span class="lineno"></span><span class="op" id="8309379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="keyword" id="8309382">func</span>&nbsp;<span class="ident" id="8309387">TestSyntax</span><span class="op" id="8309397">(</span><span class="ident" id="8309398">t</span>&nbsp;<span class="op" id="8309400">*</span><span class="ident" id="8309401">testing</span><span class="op" id="8309408">.</span><span class="ident" id="8309409">T</span><span class="op" id="8309410">)</span>&nbsp;<span class="op" id="8309412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8309415">for</span>&nbsp;<span class="ident" id="8309419">i</span>&nbsp;<span class="op" id="8309421">:=</span>&nbsp;<span class="keyword" id="8309424">range</span>&nbsp;<span class="ident" id="8309430">xmlInput</span>&nbsp;<span class="op" id="8309439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8309443">d</span>&nbsp;<span class="op" id="8309445">:=</span>&nbsp;<span class="ident" id="8309448">NewDecoder</span><span class="op" id="8309458">(</span><span class="ident" id="8309459">strings</span><span class="op" id="8309466">.</span><span class="ident" id="8309467">NewReader</span><span class="op" id="8309476">(</span><span class="ident" id="8309477">xmlInput</span><span class="op" id="8309485">[</span><span class="ident" id="8309486">i</span><span class="op" id="8309487">]</span><span class="op" id="8309488">)</span><span class="op" id="8309489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8309493">var</span>&nbsp;<span class="ident" id="8309497">err</span>&nbsp;<span class="builtintype" id="8309501">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8309509">for</span>&nbsp;<span class="ident" id="8309513">_</span><span class="op" id="8309514">,</span>&nbsp;<span class="ident" id="8309516">err</span>&nbsp;<span class="op" id="8309520">=</span>&nbsp;<span class="ident" id="8309522">d</span><span class="op" id="8309523">.</span><span class="ident" id="8309524">Token</span><span class="op" id="8309529">(</span><span class="op" id="8309530">)</span><span class="op" id="8309531">;</span>&nbsp;<span class="ident" id="8309533">err</span>&nbsp;<span class="op" id="8309537">==</span>&nbsp;<span class="ident" id="8309540">nil</span><span class="op" id="8309543">;</span>&nbsp;<span class="ident" id="8309545">_</span><span class="op" id="8309546">,</span>&nbsp;<span class="ident" id="8309548">err</span>&nbsp;<span class="op" id="8309552">=</span>&nbsp;<span class="ident" id="8309554">d</span><span class="op" id="8309555">.</span><span class="ident" id="8309556">Token</span><span class="op" id="8309561">(</span><span class="op" id="8309562">)</span>&nbsp;<span class="op" id="8309564">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8309568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8309572">if</span>&nbsp;<span class="ident" id="8309575">_</span><span class="op" id="8309576">,</span>&nbsp;<span class="ident" id="8309578">ok</span>&nbsp;<span class="op" id="8309581">:=</span>&nbsp;<span class="ident" id="8309584">err</span><span class="op" id="8309587">.</span><span class="op" id="8309588">(</span><span class="op" id="8309589">*</span><span class="ident" id="8309590">SyntaxError</span><span class="op" id="8309601">)</span><span class="op" id="8309602">;</span>&nbsp;<span class="op" id="8309604">!</span><span class="ident" id="8309605">ok</span>&nbsp;<span class="op" id="8309608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8309613">t</span><span class="op" id="8309614">.</span><span class="ident" id="8309615">Fatalf</span><span class="op" id="8309621">(</span><span class="string" id="8309622">`xmlInput&nbsp;&#34;%s&#34;:&nbsp;expected&nbsp;SyntaxError&nbsp;not&nbsp;received`</span><span class="op" id="8309672">,</span>&nbsp;<span class="ident" id="8309674">xmlInput</span><span class="op" id="8309682">[</span><span class="ident" id="8309683">i</span><span class="op" id="8309684">]</span><span class="op" id="8309685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8309689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8309692">}</span><br>
<span class="lineno">400</span><span class="op" id="8309694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8309697">type</span>&nbsp;<span class="ident" id="8309702">allScalars</span>&nbsp;<span class="keyword" id="8309713">struct</span>&nbsp;<span class="op" id="8309720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8309723">True1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8309733">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8309739">True2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8309749">bool</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8309755">False1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8309765">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8309771">False2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8309781">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8309787">Int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8309797">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8309802">Int8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8309812">int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8309818">Int16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8309828">int16</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8309835">Int32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8309845">int32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8309852">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8309862">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8309869">Uint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8309879">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8309884">Uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8309894">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8309901">Uint16</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8309911">uint16</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8309919">Uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8309929">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8309937">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8309947">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8309955">Uintptr</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8309965">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8309974">Float32</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8309984">float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8309993">Float64</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8310003">float64</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8310012">String</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8310022">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8310030">PtrString</span>&nbsp;<span class="op" id="8310040">*</span><span class="builtintype" id="8310041">string</span><br>
<span class="lineno"></span><span class="op" id="8310048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8310051">var</span>&nbsp;<span class="ident" id="8310055">all</span>&nbsp;<span class="op" id="8310059">=</span>&nbsp;<span class="ident" id="8310061">allScalars</span><span class="op" id="8310071">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8310074">True1</span><span class="op" id="8310079">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8310085">true</span><span class="op" id="8310089">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8310092">True2</span><span class="op" id="8310097">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8310103">true</span><span class="op" id="8310107">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8310110">False1</span><span class="op" id="8310116">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8310121">false</span><span class="op" id="8310126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8310129">False2</span><span class="op" id="8310135">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8310140">false</span><span class="op" id="8310145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8310148">Int</span><span class="op" id="8310151">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8310159">1</span><span class="op" id="8310160">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8310163">Int8</span><span class="op" id="8310167">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8310174">-</span><span class="num" id="8310175">2</span><span class="op" id="8310176">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8310179">Int16</span><span class="op" id="8310184">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8310190">3</span><span class="op" id="8310191">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8310194">Int32</span><span class="op" id="8310199">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8310205">-</span><span class="num" id="8310206">4</span><span class="op" id="8310207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8310210">Int64</span><span class="op" id="8310215">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8310221">5</span><span class="op" id="8310222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8310225">Uint</span><span class="op" id="8310229">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8310236">6</span><span class="op" id="8310237">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8310240">Uint8</span><span class="op" id="8310245">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8310251">7</span><span class="op" id="8310252">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8310255">Uint16</span><span class="op" id="8310261">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8310266">8</span><span class="op" id="8310267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8310270">Uint32</span><span class="op" id="8310276">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8310281">9</span><span class="op" id="8310282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8310285">Uint64</span><span class="op" id="8310291">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8310296">10</span><span class="op" id="8310298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8310301">Uintptr</span><span class="op" id="8310308">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8310312">11</span><span class="op" id="8310314">,</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8310317">Float32</span><span class="op" id="8310324">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8310328">13.0</span><span class="op" id="8310332">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8310335">Float64</span><span class="op" id="8310342">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8310346">14.0</span><span class="op" id="8310350">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8310353">String</span><span class="op" id="8310359">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8310364">&#34;15&#34;</span><span class="op" id="8310368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8310371">PtrString</span><span class="op" id="8310380">:</span>&nbsp;<span class="op" id="8310382">&amp;</span><span class="ident" id="8310383">sixteen</span><span class="op" id="8310390">,</span><br>
<span class="lineno"></span><span class="op" id="8310392">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="8310395">var</span>&nbsp;<span class="ident" id="8310399">sixteen</span>&nbsp;<span class="op" id="8310407">=</span>&nbsp;<span class="string" id="8310409">&#34;16&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8310415">const</span>&nbsp;<span class="ident" id="8310421">testScalarsInput</span>&nbsp;<span class="op" id="8310438">=</span>&nbsp;<span class="string" id="8310440">`&lt;allscalars&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;True1&gt;true&lt;/True1&gt;<br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;True2&gt;1&lt;/True2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;False1&gt;false&lt;/False1&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;False2&gt;0&lt;/False2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int&gt;1&lt;/Int&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int8&gt;-2&lt;/Int8&gt;<br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int16&gt;3&lt;/Int16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int32&gt;-4&lt;/Int32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int64&gt;5&lt;/Int64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint&gt;6&lt;/Uint&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint8&gt;7&lt;/Uint8&gt;<br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint16&gt;8&lt;/Uint16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint32&gt;9&lt;/Uint32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint64&gt;10&lt;/Uint64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uintptr&gt;11&lt;/Uintptr&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float&gt;12.0&lt;/Float&gt;<br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float32&gt;13.0&lt;/Float32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float64&gt;14.0&lt;/Float64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;String&gt;15&lt;/String&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;PtrString&gt;16&lt;/PtrString&gt;<br>
<span class="lineno"></span>&lt;/allscalars&gt;`</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="keyword" id="8310876">func</span>&nbsp;<span class="ident" id="8310881">TestAllScalars</span><span class="op" id="8310895">(</span><span class="ident" id="8310896">t</span>&nbsp;<span class="op" id="8310898">*</span><span class="ident" id="8310899">testing</span><span class="op" id="8310906">.</span><span class="ident" id="8310907">T</span><span class="op" id="8310908">)</span>&nbsp;<span class="op" id="8310910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8310913">var</span>&nbsp;<span class="ident" id="8310917">a</span>&nbsp;<span class="ident" id="8310919">allScalars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8310931">err</span>&nbsp;<span class="op" id="8310935">:=</span>&nbsp;<span class="ident" id="8310938">Unmarshal</span><span class="op" id="8310947">(</span><span class="op" id="8310948">[</span><span class="op" id="8310949">]</span><span class="builtintype" id="8310950">byte</span><span class="op" id="8310954">(</span><span class="ident" id="8310955">testScalarsInput</span><span class="op" id="8310971">)</span><span class="op" id="8310972">,</span>&nbsp;<span class="op" id="8310974">&amp;</span><span class="ident" id="8310975">a</span><span class="op" id="8310976">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8310980">if</span>&nbsp;<span class="ident" id="8310983">err</span>&nbsp;<span class="op" id="8310987">!=</span>&nbsp;<span class="ident" id="8310990">nil</span>&nbsp;<span class="op" id="8310994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8310998">t</span><span class="op" id="8310999">.</span><span class="ident" id="8311000">Fatal</span><span class="op" id="8311005">(</span><span class="ident" id="8311006">err</span><span class="op" id="8311009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8311012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8311015">if</span>&nbsp;<span class="op" id="8311018">!</span><span class="ident" id="8311019">reflect</span><span class="op" id="8311026">.</span><span class="ident" id="8311027">DeepEqual</span><span class="op" id="8311036">(</span><span class="ident" id="8311037">a</span><span class="op" id="8311038">,</span>&nbsp;<span class="ident" id="8311040">all</span><span class="op" id="8311043">)</span>&nbsp;<span class="op" id="8311045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8311049">t</span><span class="op" id="8311050">.</span><span class="ident" id="8311051">Errorf</span><span class="op" id="8311057">(</span><span class="string" id="8311058">&#34;have&nbsp;%+v&nbsp;want&nbsp;%+v&#34;</span><span class="op" id="8311077">,</span>&nbsp;<span class="ident" id="8311079">a</span><span class="op" id="8311080">,</span>&nbsp;<span class="ident" id="8311082">all</span><span class="op" id="8311085">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8311088">}</span><br>
<span class="lineno"></span><span class="op" id="8311090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8311093">type</span>&nbsp;<span class="ident" id="8311098">item</span>&nbsp;<span class="keyword" id="8311103">struct</span>&nbsp;<span class="op" id="8311110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8311113">Field_a</span>&nbsp;<span class="builtintype" id="8311121">string</span><br>
<span class="lineno">485</span><span class="op" id="8311128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8311131">func</span>&nbsp;<span class="ident" id="8311136">TestIssue569</span><span class="op" id="8311148">(</span><span class="ident" id="8311149">t</span>&nbsp;<span class="op" id="8311151">*</span><span class="ident" id="8311152">testing</span><span class="op" id="8311159">.</span><span class="ident" id="8311160">T</span><span class="op" id="8311161">)</span>&nbsp;<span class="op" id="8311163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8311166">data</span>&nbsp;<span class="op" id="8311171">:=</span>&nbsp;<span class="string" id="8311174">`&lt;item&gt;&lt;Field_a&gt;abcd&lt;/Field_a&gt;&lt;/item&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8311214">var</span>&nbsp;<span class="ident" id="8311218">i</span>&nbsp;<span class="ident" id="8311220">item</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8311226">err</span>&nbsp;<span class="op" id="8311230">:=</span>&nbsp;<span class="ident" id="8311233">Unmarshal</span><span class="op" id="8311242">(</span><span class="op" id="8311243">[</span><span class="op" id="8311244">]</span><span class="builtintype" id="8311245">byte</span><span class="op" id="8311249">(</span><span class="ident" id="8311250">data</span><span class="op" id="8311254">)</span><span class="op" id="8311255">,</span>&nbsp;<span class="op" id="8311257">&amp;</span><span class="ident" id="8311258">i</span><span class="op" id="8311259">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8311263">if</span>&nbsp;<span class="ident" id="8311266">err</span>&nbsp;<span class="op" id="8311270">!=</span>&nbsp;<span class="ident" id="8311273">nil</span>&nbsp;<span class="op" id="8311277">||</span>&nbsp;<span class="ident" id="8311280">i</span><span class="op" id="8311281">.</span><span class="ident" id="8311282">Field_a</span>&nbsp;<span class="op" id="8311290">!=</span>&nbsp;<span class="string" id="8311293">&#34;abcd&#34;</span>&nbsp;<span class="op" id="8311300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8311304">t</span><span class="op" id="8311305">.</span><span class="ident" id="8311306">Fatal</span><span class="op" id="8311311">(</span><span class="string" id="8311312">&#34;Expecting&nbsp;abcd&#34;</span><span class="op" id="8311328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8311331">}</span><br>
<span class="lineno">495</span><span class="op" id="8311333">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8311336">func</span>&nbsp;<span class="ident" id="8311341">TestUnquotedAttrs</span><span class="op" id="8311358">(</span><span class="ident" id="8311359">t</span>&nbsp;<span class="op" id="8311361">*</span><span class="ident" id="8311362">testing</span><span class="op" id="8311369">.</span><span class="ident" id="8311370">T</span><span class="op" id="8311371">)</span>&nbsp;<span class="op" id="8311373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8311376">data</span>&nbsp;<span class="op" id="8311381">:=</span>&nbsp;<span class="string" id="8311384">&#34;&lt;tag&nbsp;attr=azAZ09:-_\t&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8311410">d</span>&nbsp;<span class="op" id="8311412">:=</span>&nbsp;<span class="ident" id="8311415">NewDecoder</span><span class="op" id="8311425">(</span><span class="ident" id="8311426">strings</span><span class="op" id="8311433">.</span><span class="ident" id="8311434">NewReader</span><span class="op" id="8311443">(</span><span class="ident" id="8311444">data</span><span class="op" id="8311448">)</span><span class="op" id="8311449">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8311452">d</span><span class="op" id="8311453">.</span><span class="ident" id="8311454">Strict</span>&nbsp;<span class="op" id="8311461">=</span>&nbsp;<span class="ident" id="8311463">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8311470">token</span><span class="op" id="8311475">,</span>&nbsp;<span class="ident" id="8311477">err</span>&nbsp;<span class="op" id="8311481">:=</span>&nbsp;<span class="ident" id="8311484">d</span><span class="op" id="8311485">.</span><span class="ident" id="8311486">Token</span><span class="op" id="8311491">(</span><span class="op" id="8311492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8311495">if</span>&nbsp;<span class="ident" id="8311498">_</span><span class="op" id="8311499">,</span>&nbsp;<span class="ident" id="8311501">ok</span>&nbsp;<span class="op" id="8311504">:=</span>&nbsp;<span class="ident" id="8311507">err</span><span class="op" id="8311510">.</span><span class="op" id="8311511">(</span><span class="op" id="8311512">*</span><span class="ident" id="8311513">SyntaxError</span><span class="op" id="8311524">)</span><span class="op" id="8311525">;</span>&nbsp;<span class="ident" id="8311527">ok</span>&nbsp;<span class="op" id="8311530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8311534">t</span><span class="op" id="8311535">.</span><span class="ident" id="8311536">Errorf</span><span class="op" id="8311542">(</span><span class="string" id="8311543">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8311565">,</span>&nbsp;<span class="ident" id="8311567">err</span><span class="op" id="8311570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8311573">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8311576">if</span>&nbsp;<span class="ident" id="8311579">token</span><span class="op" id="8311584">.</span><span class="op" id="8311585">(</span><span class="ident" id="8311586">StartElement</span><span class="op" id="8311598">)</span><span class="op" id="8311599">.</span><span class="ident" id="8311600">Name</span><span class="op" id="8311604">.</span><span class="ident" id="8311605">Local</span>&nbsp;<span class="op" id="8311611">!=</span>&nbsp;<span class="string" id="8311614">&#34;tag&#34;</span>&nbsp;<span class="op" id="8311620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8311624">t</span><span class="op" id="8311625">.</span><span class="ident" id="8311626">Errorf</span><span class="op" id="8311632">(</span><span class="string" id="8311633">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="8311658">,</span>&nbsp;<span class="ident" id="8311660">token</span><span class="op" id="8311665">.</span><span class="op" id="8311666">(</span><span class="ident" id="8311667">StartElement</span><span class="op" id="8311679">)</span><span class="op" id="8311680">.</span><span class="ident" id="8311681">Name</span><span class="op" id="8311685">.</span><span class="ident" id="8311686">Local</span><span class="op" id="8311691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8311694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8311697">attr</span>&nbsp;<span class="op" id="8311702">:=</span>&nbsp;<span class="ident" id="8311705">token</span><span class="op" id="8311710">.</span><span class="op" id="8311711">(</span><span class="ident" id="8311712">StartElement</span><span class="op" id="8311724">)</span><span class="op" id="8311725">.</span><span class="ident" id="8311726">Attr</span><span class="op" id="8311730">[</span><span class="num" id="8311731">0</span><span class="op" id="8311732">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8311735">if</span>&nbsp;<span class="ident" id="8311738">attr</span><span class="op" id="8311742">.</span><span class="ident" id="8311743">Value</span>&nbsp;<span class="op" id="8311749">!=</span>&nbsp;<span class="string" id="8311752">&#34;azAZ09:-_&#34;</span>&nbsp;<span class="op" id="8311764">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8311768">t</span><span class="op" id="8311769">.</span><span class="ident" id="8311770">Errorf</span><span class="op" id="8311776">(</span><span class="string" id="8311777">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="8311809">,</span>&nbsp;<span class="ident" id="8311811">attr</span><span class="op" id="8311815">.</span><span class="ident" id="8311816">Value</span><span class="op" id="8311821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8311824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8311827">if</span>&nbsp;<span class="ident" id="8311830">attr</span><span class="op" id="8311834">.</span><span class="ident" id="8311835">Name</span><span class="op" id="8311839">.</span><span class="ident" id="8311840">Local</span>&nbsp;<span class="op" id="8311846">!=</span>&nbsp;<span class="string" id="8311849">&#34;attr&#34;</span>&nbsp;<span class="op" id="8311856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8311860">t</span><span class="op" id="8311861">.</span><span class="ident" id="8311862">Errorf</span><span class="op" id="8311868">(</span><span class="string" id="8311869">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="8311900">,</span>&nbsp;<span class="ident" id="8311902">attr</span><span class="op" id="8311906">.</span><span class="ident" id="8311907">Name</span><span class="op" id="8311911">.</span><span class="ident" id="8311912">Local</span><span class="op" id="8311917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8311920">}</span><br>
<span class="lineno">515</span><span class="op" id="8311922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8311925">func</span>&nbsp;<span class="ident" id="8311930">TestValuelessAttrs</span><span class="op" id="8311948">(</span><span class="ident" id="8311949">t</span>&nbsp;<span class="op" id="8311951">*</span><span class="ident" id="8311952">testing</span><span class="op" id="8311959">.</span><span class="ident" id="8311960">T</span><span class="op" id="8311961">)</span>&nbsp;<span class="op" id="8311963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8311966">tests</span>&nbsp;<span class="op" id="8311972">:=</span>&nbsp;<span class="op" id="8311975">[</span><span class="op" id="8311976">]</span><span class="op" id="8311977">[</span><span class="num" id="8311978">3</span><span class="op" id="8311979">]</span><span class="builtintype" id="8311980">string</span><span class="op" id="8311986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8311990">{</span><span class="string" id="8311991">&#34;&lt;p&nbsp;nowrap&gt;&#34;</span><span class="op" id="8312003">,</span>&nbsp;<span class="string" id="8312005">&#34;p&#34;</span><span class="op" id="8312008">,</span>&nbsp;<span class="string" id="8312010">&#34;nowrap&#34;</span><span class="op" id="8312018">}</span><span class="op" id="8312019">,</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8312023">{</span><span class="string" id="8312024">&#34;&lt;p&nbsp;nowrap&nbsp;&gt;&#34;</span><span class="op" id="8312037">,</span>&nbsp;<span class="string" id="8312039">&#34;p&#34;</span><span class="op" id="8312042">,</span>&nbsp;<span class="string" id="8312044">&#34;nowrap&#34;</span><span class="op" id="8312052">}</span><span class="op" id="8312053">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8312057">{</span><span class="string" id="8312058">&#34;&lt;input&nbsp;checked/&gt;&#34;</span><span class="op" id="8312076">,</span>&nbsp;<span class="string" id="8312078">&#34;input&#34;</span><span class="op" id="8312085">,</span>&nbsp;<span class="string" id="8312087">&#34;checked&#34;</span><span class="op" id="8312096">}</span><span class="op" id="8312097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8312101">{</span><span class="string" id="8312102">&#34;&lt;input&nbsp;checked&nbsp;/&gt;&#34;</span><span class="op" id="8312121">,</span>&nbsp;<span class="string" id="8312123">&#34;input&#34;</span><span class="op" id="8312130">,</span>&nbsp;<span class="string" id="8312132">&#34;checked&#34;</span><span class="op" id="8312141">}</span><span class="op" id="8312142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8312145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8312148">for</span>&nbsp;<span class="ident" id="8312152">_</span><span class="op" id="8312153">,</span>&nbsp;<span class="ident" id="8312155">test</span>&nbsp;<span class="op" id="8312160">:=</span>&nbsp;<span class="keyword" id="8312163">range</span>&nbsp;<span class="ident" id="8312169">tests</span>&nbsp;<span class="op" id="8312175">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312179">d</span>&nbsp;<span class="op" id="8312181">:=</span>&nbsp;<span class="ident" id="8312184">NewDecoder</span><span class="op" id="8312194">(</span><span class="ident" id="8312195">strings</span><span class="op" id="8312202">.</span><span class="ident" id="8312203">NewReader</span><span class="op" id="8312212">(</span><span class="ident" id="8312213">test</span><span class="op" id="8312217">[</span><span class="num" id="8312218">0</span><span class="op" id="8312219">]</span><span class="op" id="8312220">)</span><span class="op" id="8312221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312225">d</span><span class="op" id="8312226">.</span><span class="ident" id="8312227">Strict</span>&nbsp;<span class="op" id="8312234">=</span>&nbsp;<span class="ident" id="8312236">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312244">token</span><span class="op" id="8312249">,</span>&nbsp;<span class="ident" id="8312251">err</span>&nbsp;<span class="op" id="8312255">:=</span>&nbsp;<span class="ident" id="8312258">d</span><span class="op" id="8312259">.</span><span class="ident" id="8312260">Token</span><span class="op" id="8312265">(</span><span class="op" id="8312266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8312270">if</span>&nbsp;<span class="ident" id="8312273">_</span><span class="op" id="8312274">,</span>&nbsp;<span class="ident" id="8312276">ok</span>&nbsp;<span class="op" id="8312279">:=</span>&nbsp;<span class="ident" id="8312282">err</span><span class="op" id="8312285">.</span><span class="op" id="8312286">(</span><span class="op" id="8312287">*</span><span class="ident" id="8312288">SyntaxError</span><span class="op" id="8312299">)</span><span class="op" id="8312300">;</span>&nbsp;<span class="ident" id="8312302">ok</span>&nbsp;<span class="op" id="8312305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312310">t</span><span class="op" id="8312311">.</span><span class="ident" id="8312312">Errorf</span><span class="op" id="8312318">(</span><span class="string" id="8312319">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8312341">,</span>&nbsp;<span class="ident" id="8312343">err</span><span class="op" id="8312346">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8312350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8312354">if</span>&nbsp;<span class="ident" id="8312357">token</span><span class="op" id="8312362">.</span><span class="op" id="8312363">(</span><span class="ident" id="8312364">StartElement</span><span class="op" id="8312376">)</span><span class="op" id="8312377">.</span><span class="ident" id="8312378">Name</span><span class="op" id="8312382">.</span><span class="ident" id="8312383">Local</span>&nbsp;<span class="op" id="8312389">!=</span>&nbsp;<span class="ident" id="8312392">test</span><span class="op" id="8312396">[</span><span class="num" id="8312397">1</span><span class="op" id="8312398">]</span>&nbsp;<span class="op" id="8312400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312405">t</span><span class="op" id="8312406">.</span><span class="ident" id="8312407">Errorf</span><span class="op" id="8312413">(</span><span class="string" id="8312414">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="8312439">,</span>&nbsp;<span class="ident" id="8312441">token</span><span class="op" id="8312446">.</span><span class="op" id="8312447">(</span><span class="ident" id="8312448">StartElement</span><span class="op" id="8312460">)</span><span class="op" id="8312461">.</span><span class="ident" id="8312462">Name</span><span class="op" id="8312466">.</span><span class="ident" id="8312467">Local</span><span class="op" id="8312472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8312476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312480">attr</span>&nbsp;<span class="op" id="8312485">:=</span>&nbsp;<span class="ident" id="8312488">token</span><span class="op" id="8312493">.</span><span class="op" id="8312494">(</span><span class="ident" id="8312495">StartElement</span><span class="op" id="8312507">)</span><span class="op" id="8312508">.</span><span class="ident" id="8312509">Attr</span><span class="op" id="8312513">[</span><span class="num" id="8312514">0</span><span class="op" id="8312515">]</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8312519">if</span>&nbsp;<span class="ident" id="8312522">attr</span><span class="op" id="8312526">.</span><span class="ident" id="8312527">Value</span>&nbsp;<span class="op" id="8312533">!=</span>&nbsp;<span class="ident" id="8312536">test</span><span class="op" id="8312540">[</span><span class="num" id="8312541">2</span><span class="op" id="8312542">]</span>&nbsp;<span class="op" id="8312544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312549">t</span><span class="op" id="8312550">.</span><span class="ident" id="8312551">Errorf</span><span class="op" id="8312557">(</span><span class="string" id="8312558">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="8312590">,</span>&nbsp;<span class="ident" id="8312592">attr</span><span class="op" id="8312596">.</span><span class="ident" id="8312597">Value</span><span class="op" id="8312602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8312606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8312610">if</span>&nbsp;<span class="ident" id="8312613">attr</span><span class="op" id="8312617">.</span><span class="ident" id="8312618">Name</span><span class="op" id="8312622">.</span><span class="ident" id="8312623">Local</span>&nbsp;<span class="op" id="8312629">!=</span>&nbsp;<span class="ident" id="8312632">test</span><span class="op" id="8312636">[</span><span class="num" id="8312637">2</span><span class="op" id="8312638">]</span>&nbsp;<span class="op" id="8312640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312645">t</span><span class="op" id="8312646">.</span><span class="ident" id="8312647">Errorf</span><span class="op" id="8312653">(</span><span class="string" id="8312654">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="8312685">,</span>&nbsp;<span class="ident" id="8312687">attr</span><span class="op" id="8312691">.</span><span class="ident" id="8312692">Name</span><span class="op" id="8312696">.</span><span class="ident" id="8312697">Local</span><span class="op" id="8312702">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8312706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8312709">}</span><br>
<span class="lineno"></span><span class="op" id="8312711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8312714">func</span>&nbsp;<span class="ident" id="8312719">TestCopyTokenCharData</span><span class="op" id="8312740">(</span><span class="ident" id="8312741">t</span>&nbsp;<span class="op" id="8312743">*</span><span class="ident" id="8312744">testing</span><span class="op" id="8312751">.</span><span class="ident" id="8312752">T</span><span class="op" id="8312753">)</span>&nbsp;<span class="op" id="8312755">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312758">data</span>&nbsp;<span class="op" id="8312763">:=</span>&nbsp;<span class="op" id="8312766">[</span><span class="op" id="8312767">]</span><span class="builtintype" id="8312768">byte</span><span class="op" id="8312772">(</span><span class="string" id="8312773">&#34;same&nbsp;data&#34;</span><span class="op" id="8312784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8312787">var</span>&nbsp;<span class="ident" id="8312791">tok1</span>&nbsp;<span class="ident" id="8312796">Token</span>&nbsp;<span class="op" id="8312802">=</span>&nbsp;<span class="ident" id="8312804">CharData</span><span class="op" id="8312812">(</span><span class="ident" id="8312813">data</span><span class="op" id="8312817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312820">tok2</span>&nbsp;<span class="op" id="8312825">:=</span>&nbsp;<span class="ident" id="8312828">CopyToken</span><span class="op" id="8312837">(</span><span class="ident" id="8312838">tok1</span><span class="op" id="8312842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8312845">if</span>&nbsp;<span class="op" id="8312848">!</span><span class="ident" id="8312849">reflect</span><span class="op" id="8312856">.</span><span class="ident" id="8312857">DeepEqual</span><span class="op" id="8312866">(</span><span class="ident" id="8312867">tok1</span><span class="op" id="8312871">,</span>&nbsp;<span class="ident" id="8312873">tok2</span><span class="op" id="8312877">)</span>&nbsp;<span class="op" id="8312879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312883">t</span><span class="op" id="8312884">.</span><span class="ident" id="8312885">Error</span><span class="op" id="8312890">(</span><span class="string" id="8312891">&#34;CopyToken(CharData)&nbsp;!=&nbsp;CharData&#34;</span><span class="op" id="8312924">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8312927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312930">data</span><span class="op" id="8312934">[</span><span class="num" id="8312935">1</span><span class="op" id="8312936">]</span>&nbsp;<span class="op" id="8312938">=</span>&nbsp;<span class="string" id="8312940">&#39;o&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8312945">if</span>&nbsp;<span class="ident" id="8312948">reflect</span><span class="op" id="8312955">.</span><span class="ident" id="8312956">DeepEqual</span><span class="op" id="8312965">(</span><span class="ident" id="8312966">tok1</span><span class="op" id="8312970">,</span>&nbsp;<span class="ident" id="8312972">tok2</span><span class="op" id="8312976">)</span>&nbsp;<span class="op" id="8312978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8312982">t</span><span class="op" id="8312983">.</span><span class="ident" id="8312984">Error</span><span class="op" id="8312989">(</span><span class="string" id="8312990">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="8313029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8313032">}</span><br>
<span class="lineno">555</span><span class="op" id="8313034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8313037">func</span>&nbsp;<span class="ident" id="8313042">TestCopyTokenStartElement</span><span class="op" id="8313067">(</span><span class="ident" id="8313068">t</span>&nbsp;<span class="op" id="8313070">*</span><span class="ident" id="8313071">testing</span><span class="op" id="8313078">.</span><span class="ident" id="8313079">T</span><span class="op" id="8313080">)</span>&nbsp;<span class="op" id="8313082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313085">elt</span>&nbsp;<span class="op" id="8313089">:=</span>&nbsp;<span class="ident" id="8313092">StartElement</span><span class="op" id="8313104">{</span><span class="ident" id="8313105">Name</span><span class="op" id="8313109">{</span><span class="string" id="8313110">&#34;&#34;</span><span class="op" id="8313112">,</span>&nbsp;<span class="string" id="8313114">&#34;hello&#34;</span><span class="op" id="8313121">}</span><span class="op" id="8313122">,</span>&nbsp;<span class="op" id="8313124">[</span><span class="op" id="8313125">]</span><span class="ident" id="8313126">Attr</span><span class="op" id="8313130">{</span><span class="op" id="8313131">{</span><span class="ident" id="8313132">Name</span><span class="op" id="8313136">{</span><span class="string" id="8313137">&#34;&#34;</span><span class="op" id="8313139">,</span>&nbsp;<span class="string" id="8313141">&#34;lang&#34;</span><span class="op" id="8313147">}</span><span class="op" id="8313148">,</span>&nbsp;<span class="string" id="8313150">&#34;en&#34;</span><span class="op" id="8313154">}</span><span class="op" id="8313155">}</span><span class="op" id="8313156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8313159">var</span>&nbsp;<span class="ident" id="8313163">tok1</span>&nbsp;<span class="ident" id="8313168">Token</span>&nbsp;<span class="op" id="8313174">=</span>&nbsp;<span class="ident" id="8313176">elt</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313181">tok2</span>&nbsp;<span class="op" id="8313186">:=</span>&nbsp;<span class="ident" id="8313189">CopyToken</span><span class="op" id="8313198">(</span><span class="ident" id="8313199">tok1</span><span class="op" id="8313203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8313206">if</span>&nbsp;<span class="ident" id="8313209">tok1</span><span class="op" id="8313213">.</span><span class="op" id="8313214">(</span><span class="ident" id="8313215">StartElement</span><span class="op" id="8313227">)</span><span class="op" id="8313228">.</span><span class="ident" id="8313229">Attr</span><span class="op" id="8313233">[</span><span class="num" id="8313234">0</span><span class="op" id="8313235">]</span><span class="op" id="8313236">.</span><span class="ident" id="8313237">Value</span>&nbsp;<span class="op" id="8313243">!=</span>&nbsp;<span class="string" id="8313246">&#34;en&#34;</span>&nbsp;<span class="op" id="8313251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313255">t</span><span class="op" id="8313256">.</span><span class="ident" id="8313257">Error</span><span class="op" id="8313262">(</span><span class="string" id="8313263">&#34;CopyToken&nbsp;overwrote&nbsp;Attr[0]&#34;</span><span class="op" id="8313292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8313295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8313298">if</span>&nbsp;<span class="op" id="8313301">!</span><span class="ident" id="8313302">reflect</span><span class="op" id="8313309">.</span><span class="ident" id="8313310">DeepEqual</span><span class="op" id="8313319">(</span><span class="ident" id="8313320">tok1</span><span class="op" id="8313324">,</span>&nbsp;<span class="ident" id="8313326">tok2</span><span class="op" id="8313330">)</span>&nbsp;<span class="op" id="8313332">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313336">t</span><span class="op" id="8313337">.</span><span class="ident" id="8313338">Error</span><span class="op" id="8313343">(</span><span class="string" id="8313344">&#34;CopyToken(StartElement)&nbsp;!=&nbsp;StartElement&#34;</span><span class="op" id="8313385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8313388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313391">tok1</span><span class="op" id="8313395">.</span><span class="op" id="8313396">(</span><span class="ident" id="8313397">StartElement</span><span class="op" id="8313409">)</span><span class="op" id="8313410">.</span><span class="ident" id="8313411">Attr</span><span class="op" id="8313415">[</span><span class="num" id="8313416">0</span><span class="op" id="8313417">]</span>&nbsp;<span class="op" id="8313419">=</span>&nbsp;<span class="ident" id="8313421">Attr</span><span class="op" id="8313425">{</span><span class="ident" id="8313426">Name</span><span class="op" id="8313430">{</span><span class="string" id="8313431">&#34;&#34;</span><span class="op" id="8313433">,</span>&nbsp;<span class="string" id="8313435">&#34;lang&#34;</span><span class="op" id="8313441">}</span><span class="op" id="8313442">,</span>&nbsp;<span class="string" id="8313444">&#34;de&#34;</span><span class="op" id="8313448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8313451">if</span>&nbsp;<span class="ident" id="8313454">reflect</span><span class="op" id="8313461">.</span><span class="ident" id="8313462">DeepEqual</span><span class="op" id="8313471">(</span><span class="ident" id="8313472">tok1</span><span class="op" id="8313476">,</span>&nbsp;<span class="ident" id="8313478">tok2</span><span class="op" id="8313482">)</span>&nbsp;<span class="op" id="8313484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313488">t</span><span class="op" id="8313489">.</span><span class="ident" id="8313490">Error</span><span class="op" id="8313495">(</span><span class="string" id="8313496">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="8313535">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8313538">}</span><br>
<span class="lineno"></span><span class="op" id="8313540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8313543">func</span>&nbsp;<span class="ident" id="8313548">TestSyntaxErrorLineNum</span><span class="op" id="8313570">(</span><span class="ident" id="8313571">t</span>&nbsp;<span class="op" id="8313573">*</span><span class="ident" id="8313574">testing</span><span class="op" id="8313581">.</span><span class="ident" id="8313582">T</span><span class="op" id="8313583">)</span>&nbsp;<span class="op" id="8313585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313588">testInput</span>&nbsp;<span class="op" id="8313598">:=</span>&nbsp;<span class="string" id="8313601">&#34;&lt;P&gt;Foo&lt;P&gt;\n\n&lt;P&gt;Bar&lt;/&gt;\n&#34;</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313629">d</span>&nbsp;<span class="op" id="8313631">:=</span>&nbsp;<span class="ident" id="8313634">NewDecoder</span><span class="op" id="8313644">(</span><span class="ident" id="8313645">strings</span><span class="op" id="8313652">.</span><span class="ident" id="8313653">NewReader</span><span class="op" id="8313662">(</span><span class="ident" id="8313663">testInput</span><span class="op" id="8313672">)</span><span class="op" id="8313673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8313676">var</span>&nbsp;<span class="ident" id="8313680">err</span>&nbsp;<span class="builtintype" id="8313684">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8313691">for</span>&nbsp;<span class="ident" id="8313695">_</span><span class="op" id="8313696">,</span>&nbsp;<span class="ident" id="8313698">err</span>&nbsp;<span class="op" id="8313702">=</span>&nbsp;<span class="ident" id="8313704">d</span><span class="op" id="8313705">.</span><span class="ident" id="8313706">Token</span><span class="op" id="8313711">(</span><span class="op" id="8313712">)</span><span class="op" id="8313713">;</span>&nbsp;<span class="ident" id="8313715">err</span>&nbsp;<span class="op" id="8313719">==</span>&nbsp;<span class="ident" id="8313722">nil</span><span class="op" id="8313725">;</span>&nbsp;<span class="ident" id="8313727">_</span><span class="op" id="8313728">,</span>&nbsp;<span class="ident" id="8313730">err</span>&nbsp;<span class="op" id="8313734">=</span>&nbsp;<span class="ident" id="8313736">d</span><span class="op" id="8313737">.</span><span class="ident" id="8313738">Token</span><span class="op" id="8313743">(</span><span class="op" id="8313744">)</span>&nbsp;<span class="op" id="8313746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8313749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313752">synerr</span><span class="op" id="8313758">,</span>&nbsp;<span class="ident" id="8313760">ok</span>&nbsp;<span class="op" id="8313763">:=</span>&nbsp;<span class="ident" id="8313766">err</span><span class="op" id="8313769">.</span><span class="op" id="8313770">(</span><span class="op" id="8313771">*</span><span class="ident" id="8313772">SyntaxError</span><span class="op" id="8313783">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8313786">if</span>&nbsp;<span class="op" id="8313789">!</span><span class="ident" id="8313790">ok</span>&nbsp;<span class="op" id="8313793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313797">t</span><span class="op" id="8313798">.</span><span class="ident" id="8313799">Error</span><span class="op" id="8313804">(</span><span class="string" id="8313805">&#34;Expected&nbsp;SyntaxError.&#34;</span><span class="op" id="8313828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8313831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8313834">if</span>&nbsp;<span class="ident" id="8313837">synerr</span><span class="op" id="8313843">.</span><span class="ident" id="8313844">Line</span>&nbsp;<span class="op" id="8313849">!=</span>&nbsp;<span class="num" id="8313852">3</span>&nbsp;<span class="op" id="8313854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313858">t</span><span class="op" id="8313859">.</span><span class="ident" id="8313860">Error</span><span class="op" id="8313865">(</span><span class="string" id="8313866">&#34;SyntaxError&nbsp;didn&#39;t&nbsp;have&nbsp;correct&nbsp;line&nbsp;number.&#34;</span><span class="op" id="8313912">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8313915">}</span><br>
<span class="lineno"></span><span class="op" id="8313917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8313920">func</span>&nbsp;<span class="ident" id="8313925">TestTrailingRawToken</span><span class="op" id="8313945">(</span><span class="ident" id="8313946">t</span>&nbsp;<span class="op" id="8313948">*</span><span class="ident" id="8313949">testing</span><span class="op" id="8313956">.</span><span class="ident" id="8313957">T</span><span class="op" id="8313958">)</span>&nbsp;<span class="op" id="8313960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313963">input</span>&nbsp;<span class="op" id="8313969">:=</span>&nbsp;<span class="string" id="8313972">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8313989">d</span>&nbsp;<span class="op" id="8313991">:=</span>&nbsp;<span class="ident" id="8313994">NewDecoder</span><span class="op" id="8314004">(</span><span class="ident" id="8314005">strings</span><span class="op" id="8314012">.</span><span class="ident" id="8314013">NewReader</span><span class="op" id="8314022">(</span><span class="ident" id="8314023">input</span><span class="op" id="8314028">)</span><span class="op" id="8314029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8314032">var</span>&nbsp;<span class="ident" id="8314036">err</span>&nbsp;<span class="builtintype" id="8314040">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8314047">for</span>&nbsp;<span class="ident" id="8314051">_</span><span class="op" id="8314052">,</span>&nbsp;<span class="ident" id="8314054">err</span>&nbsp;<span class="op" id="8314058">=</span>&nbsp;<span class="ident" id="8314060">d</span><span class="op" id="8314061">.</span><span class="ident" id="8314062">RawToken</span><span class="op" id="8314070">(</span><span class="op" id="8314071">)</span><span class="op" id="8314072">;</span>&nbsp;<span class="ident" id="8314074">err</span>&nbsp;<span class="op" id="8314078">==</span>&nbsp;<span class="ident" id="8314081">nil</span><span class="op" id="8314084">;</span>&nbsp;<span class="ident" id="8314086">_</span><span class="op" id="8314087">,</span>&nbsp;<span class="ident" id="8314089">err</span>&nbsp;<span class="op" id="8314093">=</span>&nbsp;<span class="ident" id="8314095">d</span><span class="op" id="8314096">.</span><span class="ident" id="8314097">RawToken</span><span class="op" id="8314105">(</span><span class="op" id="8314106">)</span>&nbsp;<span class="op" id="8314108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8314111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8314114">if</span>&nbsp;<span class="ident" id="8314117">err</span>&nbsp;<span class="op" id="8314121">!=</span>&nbsp;<span class="ident" id="8314124">io</span><span class="op" id="8314126">.</span><span class="ident" id="8314127">EOF</span>&nbsp;<span class="op" id="8314131">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8314135">t</span><span class="op" id="8314136">.</span><span class="ident" id="8314137">Fatalf</span><span class="op" id="8314143">(</span><span class="string" id="8314144">&#34;d.RawToken()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="8314182">,</span>&nbsp;<span class="ident" id="8314184">err</span><span class="op" id="8314187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8314190">}</span><br>
<span class="lineno"></span><span class="op" id="8314192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8314195">func</span>&nbsp;<span class="ident" id="8314200">TestTrailingToken</span><span class="op" id="8314217">(</span><span class="ident" id="8314218">t</span>&nbsp;<span class="op" id="8314220">*</span><span class="ident" id="8314221">testing</span><span class="op" id="8314228">.</span><span class="ident" id="8314229">T</span><span class="op" id="8314230">)</span>&nbsp;<span class="op" id="8314232">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8314235">input</span>&nbsp;<span class="op" id="8314241">:=</span>&nbsp;<span class="string" id="8314244">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8314261">d</span>&nbsp;<span class="op" id="8314263">:=</span>&nbsp;<span class="ident" id="8314266">NewDecoder</span><span class="op" id="8314276">(</span><span class="ident" id="8314277">strings</span><span class="op" id="8314284">.</span><span class="ident" id="8314285">NewReader</span><span class="op" id="8314294">(</span><span class="ident" id="8314295">input</span><span class="op" id="8314300">)</span><span class="op" id="8314301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8314304">var</span>&nbsp;<span class="ident" id="8314308">err</span>&nbsp;<span class="builtintype" id="8314312">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8314319">for</span>&nbsp;<span class="ident" id="8314323">_</span><span class="op" id="8314324">,</span>&nbsp;<span class="ident" id="8314326">err</span>&nbsp;<span class="op" id="8314330">=</span>&nbsp;<span class="ident" id="8314332">d</span><span class="op" id="8314333">.</span><span class="ident" id="8314334">Token</span><span class="op" id="8314339">(</span><span class="op" id="8314340">)</span><span class="op" id="8314341">;</span>&nbsp;<span class="ident" id="8314343">err</span>&nbsp;<span class="op" id="8314347">==</span>&nbsp;<span class="ident" id="8314350">nil</span><span class="op" id="8314353">;</span>&nbsp;<span class="ident" id="8314355">_</span><span class="op" id="8314356">,</span>&nbsp;<span class="ident" id="8314358">err</span>&nbsp;<span class="op" id="8314362">=</span>&nbsp;<span class="ident" id="8314364">d</span><span class="op" id="8314365">.</span><span class="ident" id="8314366">Token</span><span class="op" id="8314371">(</span><span class="op" id="8314372">)</span>&nbsp;<span class="op" id="8314374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8314377">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8314380">if</span>&nbsp;<span class="ident" id="8314383">err</span>&nbsp;<span class="op" id="8314387">!=</span>&nbsp;<span class="ident" id="8314390">io</span><span class="op" id="8314392">.</span><span class="ident" id="8314393">EOF</span>&nbsp;<span class="op" id="8314397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8314401">t</span><span class="op" id="8314402">.</span><span class="ident" id="8314403">Fatalf</span><span class="op" id="8314409">(</span><span class="string" id="8314410">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="8314445">,</span>&nbsp;<span class="ident" id="8314447">err</span><span class="op" id="8314450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8314453">}</span><br>
<span class="lineno"></span><span class="op" id="8314455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span><span class="keyword" id="8314458">func</span>&nbsp;<span class="ident" id="8314463">TestEntityInsideCDATA</span><span class="op" id="8314484">(</span><span class="ident" id="8314485">t</span>&nbsp;<span class="op" id="8314487">*</span><span class="ident" id="8314488">testing</span><span class="op" id="8314495">.</span><span class="ident" id="8314496">T</span><span class="op" id="8314497">)</span>&nbsp;<span class="op" id="8314499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8314502">input</span>&nbsp;<span class="op" id="8314508">:=</span>&nbsp;<span class="string" id="8314511">`&lt;test&gt;&lt;![CDATA[&nbsp;&amp;val=foo&nbsp;]]&gt;&lt;/test&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8314550">d</span>&nbsp;<span class="op" id="8314552">:=</span>&nbsp;<span class="ident" id="8314555">NewDecoder</span><span class="op" id="8314565">(</span><span class="ident" id="8314566">strings</span><span class="op" id="8314573">.</span><span class="ident" id="8314574">NewReader</span><span class="op" id="8314583">(</span><span class="ident" id="8314584">input</span><span class="op" id="8314589">)</span><span class="op" id="8314590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8314593">var</span>&nbsp;<span class="ident" id="8314597">err</span>&nbsp;<span class="builtintype" id="8314601">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8314608">for</span>&nbsp;<span class="ident" id="8314612">_</span><span class="op" id="8314613">,</span>&nbsp;<span class="ident" id="8314615">err</span>&nbsp;<span class="op" id="8314619">=</span>&nbsp;<span class="ident" id="8314621">d</span><span class="op" id="8314622">.</span><span class="ident" id="8314623">Token</span><span class="op" id="8314628">(</span><span class="op" id="8314629">)</span><span class="op" id="8314630">;</span>&nbsp;<span class="ident" id="8314632">err</span>&nbsp;<span class="op" id="8314636">==</span>&nbsp;<span class="ident" id="8314639">nil</span><span class="op" id="8314642">;</span>&nbsp;<span class="ident" id="8314644">_</span><span class="op" id="8314645">,</span>&nbsp;<span class="ident" id="8314647">err</span>&nbsp;<span class="op" id="8314651">=</span>&nbsp;<span class="ident" id="8314653">d</span><span class="op" id="8314654">.</span><span class="ident" id="8314655">Token</span><span class="op" id="8314660">(</span><span class="op" id="8314661">)</span>&nbsp;<span class="op" id="8314663">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8314666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8314669">if</span>&nbsp;<span class="ident" id="8314672">err</span>&nbsp;<span class="op" id="8314676">!=</span>&nbsp;<span class="ident" id="8314679">io</span><span class="op" id="8314681">.</span><span class="ident" id="8314682">EOF</span>&nbsp;<span class="op" id="8314686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8314690">t</span><span class="op" id="8314691">.</span><span class="ident" id="8314692">Fatalf</span><span class="op" id="8314698">(</span><span class="string" id="8314699">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="8314734">,</span>&nbsp;<span class="ident" id="8314736">err</span><span class="op" id="8314739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8314742">}</span><br>
<span class="lineno"></span><span class="op" id="8314744">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span><span class="keyword" id="8314747">var</span>&nbsp;<span class="ident" id="8314751">characterTests</span>&nbsp;<span class="op" id="8314766">=</span>&nbsp;<span class="op" id="8314768">[</span><span class="op" id="8314769">]</span><span class="keyword" id="8314770">struct</span>&nbsp;<span class="op" id="8314777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8314780">in</span>&nbsp;&nbsp;<span class="builtintype" id="8314784">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8314792">err</span>&nbsp;<span class="builtintype" id="8314796">string</span><br>
<span class="lineno"></span><span class="op" id="8314803">}</span><span class="op" id="8314804">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8314807">{</span><span class="string" id="8314808">&#34;\x12&lt;doc/&gt;&#34;</span><span class="op" id="8314820">,</span>&nbsp;<span class="string" id="8314822">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0012&#34;</span><span class="op" id="8314853">}</span><span class="op" id="8314854">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8314857">{</span><span class="string" id="8314858">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;\x0b&lt;doc/&gt;&#34;</span><span class="op" id="8314893">,</span>&nbsp;<span class="string" id="8314895">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+000B&#34;</span><span class="op" id="8314926">}</span><span class="op" id="8314927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8314930">{</span><span class="string" id="8314931">&#34;\xef\xbf\xbe&lt;doc/&gt;&#34;</span><span class="op" id="8314951">,</span>&nbsp;<span class="string" id="8314953">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+FFFE&#34;</span><span class="op" id="8314984">}</span><span class="op" id="8314985">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8314988">{</span><span class="string" id="8314989">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&gt;\r\n&lt;hiya/&gt;\x07&lt;toots/&gt;&lt;/doc&gt;&#34;</span><span class="op" id="8315048">,</span>&nbsp;<span class="string" id="8315050">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0007&#34;</span><span class="op" id="8315081">}</span><span class="op" id="8315082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8315085">{</span><span class="string" id="8315086">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&nbsp;\x12=&#39;value&#39;&gt;what&#39;s&nbsp;up&lt;/doc&gt;&#34;</span><span class="op" id="8315144">,</span>&nbsp;<span class="string" id="8315146">&#34;expected&nbsp;attribute&nbsp;name&nbsp;in&nbsp;element&#34;</span><span class="op" id="8315182">}</span><span class="op" id="8315183">,</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8315186">{</span><span class="string" id="8315187">&#34;&lt;doc&gt;&amp;abc\x01;&lt;/doc&gt;&#34;</span><span class="op" id="8315209">,</span>&nbsp;<span class="string" id="8315211">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;abc&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="8315257">}</span><span class="op" id="8315258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8315261">{</span><span class="string" id="8315262">&#34;&lt;doc&gt;&amp;\x01;&lt;/doc&gt;&#34;</span><span class="op" id="8315281">,</span>&nbsp;<span class="string" id="8315283">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="8315326">}</span><span class="op" id="8315327">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8315330">{</span><span class="string" id="8315331">&#34;&lt;doc&gt;&amp;\xef\xbf\xbe;&lt;/doc&gt;&#34;</span><span class="op" id="8315358">,</span>&nbsp;<span class="string" id="8315360">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;\uFFFE;&#34;</span><span class="op" id="8315395">}</span><span class="op" id="8315396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8315399">{</span><span class="string" id="8315400">&#34;&lt;doc&gt;&amp;hello;&lt;/doc&gt;&#34;</span><span class="op" id="8315420">,</span>&nbsp;<span class="string" id="8315422">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;hello;&#34;</span><span class="op" id="8315456">}</span><span class="op" id="8315457">,</span><br>
<span class="lineno"></span><span class="op" id="8315459">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="keyword" id="8315462">func</span>&nbsp;<span class="ident" id="8315467">TestDisallowedCharacters</span><span class="op" id="8315491">(</span><span class="ident" id="8315492">t</span>&nbsp;<span class="op" id="8315494">*</span><span class="ident" id="8315495">testing</span><span class="op" id="8315502">.</span><span class="ident" id="8315503">T</span><span class="op" id="8315504">)</span>&nbsp;<span class="op" id="8315506">{</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8315510">for</span>&nbsp;<span class="ident" id="8315514">i</span><span class="op" id="8315515">,</span>&nbsp;<span class="ident" id="8315517">tt</span>&nbsp;<span class="op" id="8315520">:=</span>&nbsp;<span class="keyword" id="8315523">range</span>&nbsp;<span class="ident" id="8315529">characterTests</span>&nbsp;<span class="op" id="8315544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8315548">d</span>&nbsp;<span class="op" id="8315550">:=</span>&nbsp;<span class="ident" id="8315553">NewDecoder</span><span class="op" id="8315563">(</span><span class="ident" id="8315564">strings</span><span class="op" id="8315571">.</span><span class="ident" id="8315572">NewReader</span><span class="op" id="8315581">(</span><span class="ident" id="8315582">tt</span><span class="op" id="8315584">.</span><span class="ident" id="8315585">in</span><span class="op" id="8315587">)</span><span class="op" id="8315588">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8315592">var</span>&nbsp;<span class="ident" id="8315596">err</span>&nbsp;<span class="builtintype" id="8315600">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8315609">for</span>&nbsp;<span class="ident" id="8315613">err</span>&nbsp;<span class="op" id="8315617">==</span>&nbsp;<span class="ident" id="8315620">nil</span>&nbsp;<span class="op" id="8315624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8315629">_</span><span class="op" id="8315630">,</span>&nbsp;<span class="ident" id="8315632">err</span>&nbsp;<span class="op" id="8315636">=</span>&nbsp;<span class="ident" id="8315638">d</span><span class="op" id="8315639">.</span><span class="ident" id="8315640">Token</span><span class="op" id="8315645">(</span><span class="op" id="8315646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8315650">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8315654">synerr</span><span class="op" id="8315660">,</span>&nbsp;<span class="ident" id="8315662">ok</span>&nbsp;<span class="op" id="8315665">:=</span>&nbsp;<span class="ident" id="8315668">err</span><span class="op" id="8315671">.</span><span class="op" id="8315672">(</span><span class="op" id="8315673">*</span><span class="ident" id="8315674">SyntaxError</span><span class="op" id="8315685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8315689">if</span>&nbsp;<span class="op" id="8315692">!</span><span class="ident" id="8315693">ok</span>&nbsp;<span class="op" id="8315696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8315701">t</span><span class="op" id="8315702">.</span><span class="ident" id="8315703">Fatalf</span><span class="op" id="8315709">(</span><span class="string" id="8315710">&#34;input&nbsp;%d&nbsp;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;*SyntaxError&#34;</span><span class="op" id="8315760">,</span>&nbsp;<span class="ident" id="8315762">i</span><span class="op" id="8315763">,</span>&nbsp;<span class="ident" id="8315765">err</span><span class="op" id="8315768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8315772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8315776">if</span>&nbsp;<span class="ident" id="8315779">synerr</span><span class="op" id="8315785">.</span><span class="ident" id="8315786">Msg</span>&nbsp;<span class="op" id="8315790">!=</span>&nbsp;<span class="ident" id="8315793">tt</span><span class="op" id="8315795">.</span><span class="ident" id="8315796">err</span>&nbsp;<span class="op" id="8315800">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8315805">t</span><span class="op" id="8315806">.</span><span class="ident" id="8315807">Fatalf</span><span class="op" id="8315813">(</span><span class="string" id="8315814">&#34;input&nbsp;%d&nbsp;synerr.Msg&nbsp;wrong:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8315858">,</span>&nbsp;<span class="ident" id="8315860">i</span><span class="op" id="8315861">,</span>&nbsp;<span class="ident" id="8315863">tt</span><span class="op" id="8315865">.</span><span class="ident" id="8315866">err</span><span class="op" id="8315869">,</span>&nbsp;<span class="ident" id="8315871">synerr</span><span class="op" id="8315877">.</span><span class="ident" id="8315878">Msg</span><span class="op" id="8315881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8315885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8315888">}</span><br>
<span class="lineno"></span><span class="op" id="8315890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="8315893">type</span>&nbsp;<span class="ident" id="8315898">procInstEncodingTest</span>&nbsp;<span class="keyword" id="8315919">struct</span>&nbsp;<span class="op" id="8315926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8315929">expect</span><span class="op" id="8315935">,</span>&nbsp;<span class="ident" id="8315937">got</span>&nbsp;<span class="builtintype" id="8315941">string</span><br>
<span class="lineno"></span><span class="op" id="8315948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8315951">var</span>&nbsp;<span class="ident" id="8315955">procInstTests</span>&nbsp;<span class="op" id="8315969">=</span>&nbsp;<span class="op" id="8315971">[</span><span class="op" id="8315972">]</span><span class="keyword" id="8315973">struct</span>&nbsp;<span class="op" id="8315980">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8315983">input</span><span class="op" id="8315988">,</span>&nbsp;<span class="ident" id="8315990">expect</span>&nbsp;<span class="builtintype" id="8315997">string</span><br>
<span class="lineno"></span><span class="op" id="8316004">}</span><span class="op" id="8316005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8316008">{</span><span class="string" id="8316009">`version=&#34;1.0&#34;&nbsp;encoding=&#34;utf-8&#34;`</span><span class="op" id="8316041">,</span>&nbsp;<span class="string" id="8316043">&#34;utf-8&#34;</span><span class="op" id="8316050">}</span><span class="op" id="8316051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8316054">{</span><span class="string" id="8316055">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;`</span><span class="op" id="8316087">,</span>&nbsp;<span class="string" id="8316089">&#34;utf-8&#34;</span><span class="op" id="8316096">}</span><span class="op" id="8316097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8316100">{</span><span class="string" id="8316101">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;&nbsp;`</span><span class="op" id="8316134">,</span>&nbsp;<span class="string" id="8316136">&#34;utf-8&#34;</span><span class="op" id="8316143">}</span><span class="op" id="8316144">,</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8316147">{</span><span class="string" id="8316148">`version=&#34;1.0&#34;&nbsp;encoding=utf-8`</span><span class="op" id="8316178">,</span>&nbsp;<span class="string" id="8316180">&#34;&#34;</span><span class="op" id="8316182">}</span><span class="op" id="8316183">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8316186">{</span><span class="string" id="8316187">`encoding=&#34;FOO&#34;&nbsp;`</span><span class="op" id="8316204">,</span>&nbsp;<span class="string" id="8316206">&#34;FOO&#34;</span><span class="op" id="8316211">}</span><span class="op" id="8316212">,</span><br>
<span class="lineno"></span><span class="op" id="8316214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8316217">func</span>&nbsp;<span class="ident" id="8316222">TestProcInstEncoding</span><span class="op" id="8316242">(</span><span class="ident" id="8316243">t</span>&nbsp;<span class="op" id="8316245">*</span><span class="ident" id="8316246">testing</span><span class="op" id="8316253">.</span><span class="ident" id="8316254">T</span><span class="op" id="8316255">)</span>&nbsp;<span class="op" id="8316257">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8316260">for</span>&nbsp;<span class="ident" id="8316264">_</span><span class="op" id="8316265">,</span>&nbsp;<span class="ident" id="8316267">test</span>&nbsp;<span class="op" id="8316272">:=</span>&nbsp;<span class="keyword" id="8316275">range</span>&nbsp;<span class="ident" id="8316281">procInstTests</span>&nbsp;<span class="op" id="8316295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8316299">got</span>&nbsp;<span class="op" id="8316303">:=</span>&nbsp;<span class="ident" id="8316306">procInstEncoding</span><span class="op" id="8316322">(</span><span class="ident" id="8316323">test</span><span class="op" id="8316327">.</span><span class="ident" id="8316328">input</span><span class="op" id="8316333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8316337">if</span>&nbsp;<span class="ident" id="8316340">got</span>&nbsp;<span class="op" id="8316344">!=</span>&nbsp;<span class="ident" id="8316347">test</span><span class="op" id="8316351">.</span><span class="ident" id="8316352">expect</span>&nbsp;<span class="op" id="8316359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8316364">t</span><span class="op" id="8316365">.</span><span class="ident" id="8316366">Errorf</span><span class="op" id="8316372">(</span><span class="string" id="8316373">&#34;procInstEncoding(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8316409">,</span>&nbsp;<span class="ident" id="8316411">test</span><span class="op" id="8316415">.</span><span class="ident" id="8316416">input</span><span class="op" id="8316421">,</span>&nbsp;<span class="ident" id="8316423">got</span><span class="op" id="8316426">,</span>&nbsp;<span class="ident" id="8316428">test</span><span class="op" id="8316432">.</span><span class="ident" id="8316433">expect</span><span class="op" id="8316439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8316443">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8316446">}</span><br>
<span class="lineno"></span><span class="op" id="8316448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8316451">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;with&nbsp;comments&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno"></span><span class="comment" id="8316512">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives.</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="8316547">var</span>&nbsp;<span class="ident" id="8316551">directivesWithCommentsInput</span>&nbsp;<span class="op" id="8316579">=</span>&nbsp;<span class="string" id="8316581">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!--&nbsp;a&nbsp;comment&nbsp;--&gt;&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&lt;!----&gt;&nbsp;&lt;!--&gt;--&gt;&nbsp;&lt;!---&gt;--&gt;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno">685</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8316817">var</span>&nbsp;<span class="ident" id="8316821">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="8316850">=</span>&nbsp;<span class="op" id="8316852">[</span><span class="op" id="8316853">]</span><span class="ident" id="8316854">Token</span><span class="op" id="8316859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8316862">CharData</span><span class="op" id="8316870">(</span><span class="string" id="8316871">&#34;\n&#34;</span><span class="op" id="8316875">)</span><span class="op" id="8316876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8316879">Directive</span><span class="op" id="8316888">(</span><span class="string" id="8316889">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="8316960">)</span><span class="op" id="8316961">,</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8316964">CharData</span><span class="op" id="8316972">(</span><span class="string" id="8316973">&#34;\n&#34;</span><span class="op" id="8316977">)</span><span class="op" id="8316978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8316981">Directive</span><span class="op" id="8316990">(</span><span class="string" id="8316991">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="8317024">)</span><span class="op" id="8317025">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8317028">CharData</span><span class="op" id="8317036">(</span><span class="string" id="8317037">&#34;\n&#34;</span><span class="op" id="8317041">)</span><span class="op" id="8317042">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8317045">Directive</span><span class="op" id="8317054">(</span><span class="string" id="8317055">`DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&nbsp;&nbsp;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="8317100">)</span><span class="op" id="8317101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8317104">CharData</span><span class="op" id="8317112">(</span><span class="string" id="8317113">&#34;\n&#34;</span><span class="op" id="8317117">)</span><span class="op" id="8317118">,</span><br>
<span class="lineno">695</span><span class="op" id="8317120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8317123">func</span>&nbsp;<span class="ident" id="8317128">TestDirectivesWithComments</span><span class="op" id="8317154">(</span><span class="ident" id="8317155">t</span>&nbsp;<span class="op" id="8317157">*</span><span class="ident" id="8317158">testing</span><span class="op" id="8317165">.</span><span class="ident" id="8317166">T</span><span class="op" id="8317167">)</span>&nbsp;<span class="op" id="8317169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8317172">d</span>&nbsp;<span class="op" id="8317174">:=</span>&nbsp;<span class="ident" id="8317177">NewDecoder</span><span class="op" id="8317187">(</span><span class="ident" id="8317188">strings</span><span class="op" id="8317195">.</span><span class="ident" id="8317196">NewReader</span><span class="op" id="8317205">(</span><span class="ident" id="8317206">directivesWithCommentsInput</span><span class="op" id="8317233">)</span><span class="op" id="8317234">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8317238">for</span>&nbsp;<span class="ident" id="8317242">i</span><span class="op" id="8317243">,</span>&nbsp;<span class="ident" id="8317245">want</span>&nbsp;<span class="op" id="8317250">:=</span>&nbsp;<span class="keyword" id="8317253">range</span>&nbsp;<span class="ident" id="8317259">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="8317288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8317292">have</span><span class="op" id="8317296">,</span>&nbsp;<span class="ident" id="8317298">err</span>&nbsp;<span class="op" id="8317302">:=</span>&nbsp;<span class="ident" id="8317305">d</span><span class="op" id="8317306">.</span><span class="ident" id="8317307">Token</span><span class="op" id="8317312">(</span><span class="op" id="8317313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8317317">if</span>&nbsp;<span class="ident" id="8317320">err</span>&nbsp;<span class="op" id="8317324">!=</span>&nbsp;<span class="ident" id="8317327">nil</span>&nbsp;<span class="op" id="8317331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8317336">t</span><span class="op" id="8317337">.</span><span class="ident" id="8317338">Fatalf</span><span class="op" id="8317344">(</span><span class="string" id="8317345">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8317377">,</span>&nbsp;<span class="ident" id="8317379">i</span><span class="op" id="8317380">,</span>&nbsp;<span class="ident" id="8317382">err</span><span class="op" id="8317385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8317389">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8317393">if</span>&nbsp;<span class="op" id="8317396">!</span><span class="ident" id="8317397">reflect</span><span class="op" id="8317404">.</span><span class="ident" id="8317405">DeepEqual</span><span class="op" id="8317414">(</span><span class="ident" id="8317415">have</span><span class="op" id="8317419">,</span>&nbsp;<span class="ident" id="8317421">want</span><span class="op" id="8317425">)</span>&nbsp;<span class="op" id="8317427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8317432">t</span><span class="op" id="8317433">.</span><span class="ident" id="8317434">Errorf</span><span class="op" id="8317440">(</span><span class="string" id="8317441">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="8317466">,</span>&nbsp;<span class="ident" id="8317468">i</span><span class="op" id="8317469">,</span>&nbsp;<span class="ident" id="8317471">have</span><span class="op" id="8317475">,</span>&nbsp;<span class="ident" id="8317477">want</span><span class="op" id="8317481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8317485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8317488">}</span><br>
<span class="lineno"></span><span class="op" id="8317490">}</span><br>
<span class="lineno">710</span><br>
<span class="lineno"></span><span class="comment" id="8317493">//&nbsp;Writer&nbsp;whose&nbsp;Write&nbsp;method&nbsp;always&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="8317547">type</span>&nbsp;<span class="ident" id="8317552">errWriter</span>&nbsp;<span class="keyword" id="8317562">struct</span><span class="op" id="8317568">{</span><span class="op" id="8317569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8317572">func</span>&nbsp;<span class="op" id="8317577">(</span><span class="ident" id="8317578">errWriter</span><span class="op" id="8317587">)</span>&nbsp;<span class="ident" id="8317589">Write</span><span class="op" id="8317594">(</span><span class="ident" id="8317595">p</span>&nbsp;<span class="op" id="8317597">[</span><span class="op" id="8317598">]</span><span class="builtintype" id="8317599">byte</span><span class="op" id="8317603">)</span>&nbsp;<span class="op" id="8317605">(</span><span class="ident" id="8317606">n</span>&nbsp;<span class="builtintype" id="8317608">int</span><span class="op" id="8317611">,</span>&nbsp;<span class="ident" id="8317613">err</span>&nbsp;<span class="builtintype" id="8317617">error</span><span class="op" id="8317622">)</span>&nbsp;<span class="op" id="8317624">{</span>&nbsp;<span class="keyword" id="8317626">return</span>&nbsp;<span class="num" id="8317633">0</span><span class="op" id="8317634">,</span>&nbsp;<span class="ident" id="8317636">fmt</span><span class="op" id="8317639">.</span><span class="ident" id="8317640">Errorf</span><span class="op" id="8317646">(</span><span class="string" id="8317647">&#34;unwritable&#34;</span><span class="op" id="8317659">)</span>&nbsp;<span class="op" id="8317661">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="8317664">func</span>&nbsp;<span class="ident" id="8317669">TestEscapeTextIOErrors</span><span class="op" id="8317691">(</span><span class="ident" id="8317692">t</span>&nbsp;<span class="op" id="8317694">*</span><span class="ident" id="8317695">testing</span><span class="op" id="8317702">.</span><span class="ident" id="8317703">T</span><span class="op" id="8317704">)</span>&nbsp;<span class="op" id="8317706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8317709">expectErr</span>&nbsp;<span class="op" id="8317719">:=</span>&nbsp;<span class="string" id="8317722">&#34;unwritable&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8317736">err</span>&nbsp;<span class="op" id="8317740">:=</span>&nbsp;<span class="ident" id="8317743">EscapeText</span><span class="op" id="8317753">(</span><span class="ident" id="8317754">errWriter</span><span class="op" id="8317763">{</span><span class="op" id="8317764">}</span><span class="op" id="8317765">,</span>&nbsp;<span class="op" id="8317767">[</span><span class="op" id="8317768">]</span><span class="builtintype" id="8317769">byte</span><span class="op" id="8317773">{</span><span class="string" id="8317774">&#39;A&#39;</span><span class="op" id="8317777">}</span><span class="op" id="8317778">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8317782">if</span>&nbsp;<span class="ident" id="8317785">err</span>&nbsp;<span class="op" id="8317789">==</span>&nbsp;<span class="ident" id="8317792">nil</span>&nbsp;<span class="op" id="8317796">||</span>&nbsp;<span class="ident" id="8317799">err</span><span class="op" id="8317802">.</span><span class="ident" id="8317803">Error</span><span class="op" id="8317808">(</span><span class="op" id="8317809">)</span>&nbsp;<span class="op" id="8317811">!=</span>&nbsp;<span class="ident" id="8317814">expectErr</span>&nbsp;<span class="op" id="8317824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8317828">t</span><span class="op" id="8317829">.</span><span class="ident" id="8317830">Errorf</span><span class="op" id="8317836">(</span><span class="string" id="8317837">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8317855">,</span>&nbsp;<span class="ident" id="8317857">err</span><span class="op" id="8317860">,</span>&nbsp;<span class="ident" id="8317862">expectErr</span><span class="op" id="8317871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8317874">}</span><br>
<span class="lineno"></span><span class="op" id="8317876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="keyword" id="8317879">func</span>&nbsp;<span class="ident" id="8317884">TestEscapeTextInvalidChar</span><span class="op" id="8317909">(</span><span class="ident" id="8317910">t</span>&nbsp;<span class="op" id="8317912">*</span><span class="ident" id="8317913">testing</span><span class="op" id="8317920">.</span><span class="ident" id="8317921">T</span><span class="op" id="8317922">)</span>&nbsp;<span class="op" id="8317924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8317927">input</span>&nbsp;<span class="op" id="8317933">:=</span>&nbsp;<span class="op" id="8317936">[</span><span class="op" id="8317937">]</span><span class="builtintype" id="8317938">byte</span><span class="op" id="8317942">(</span><span class="string" id="8317943">&#34;A&nbsp;\x00&nbsp;terminated&nbsp;string.&#34;</span><span class="op" id="8317970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8317973">expected</span>&nbsp;<span class="op" id="8317982">:=</span>&nbsp;<span class="string" id="8317985">&#34;A&nbsp;\uFFFD&nbsp;terminated&nbsp;string.&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8318017">buff</span>&nbsp;<span class="op" id="8318022">:=</span>&nbsp;<span class="builtinfunc" id="8318025">new</span><span class="op" id="8318028">(</span><span class="ident" id="8318029">bytes</span><span class="op" id="8318034">.</span><span class="ident" id="8318035">Buffer</span><span class="op" id="8318041">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8318044">if</span>&nbsp;<span class="ident" id="8318047">err</span>&nbsp;<span class="op" id="8318051">:=</span>&nbsp;<span class="ident" id="8318054">EscapeText</span><span class="op" id="8318064">(</span><span class="ident" id="8318065">buff</span><span class="op" id="8318069">,</span>&nbsp;<span class="ident" id="8318071">input</span><span class="op" id="8318076">)</span><span class="op" id="8318077">;</span>&nbsp;<span class="ident" id="8318079">err</span>&nbsp;<span class="op" id="8318083">!=</span>&nbsp;<span class="ident" id="8318086">nil</span>&nbsp;<span class="op" id="8318090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8318094">t</span><span class="op" id="8318095">.</span><span class="ident" id="8318096">Fatalf</span><span class="op" id="8318102">(</span><span class="string" id="8318103">&#34;have&nbsp;%v,&nbsp;want&nbsp;nil&#34;</span><span class="op" id="8318122">,</span>&nbsp;<span class="ident" id="8318124">err</span><span class="op" id="8318127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8318130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8318133">text</span>&nbsp;<span class="op" id="8318138">:=</span>&nbsp;<span class="ident" id="8318141">buff</span><span class="op" id="8318145">.</span><span class="ident" id="8318146">String</span><span class="op" id="8318152">(</span><span class="op" id="8318153">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8318157">if</span>&nbsp;<span class="ident" id="8318160">text</span>&nbsp;<span class="op" id="8318165">!=</span>&nbsp;<span class="ident" id="8318168">expected</span>&nbsp;<span class="op" id="8318177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8318181">t</span><span class="op" id="8318182">.</span><span class="ident" id="8318183">Errorf</span><span class="op" id="8318189">(</span><span class="string" id="8318190">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8318208">,</span>&nbsp;<span class="ident" id="8318210">text</span><span class="op" id="8318214">,</span>&nbsp;<span class="ident" id="8318216">expected</span><span class="op" id="8318224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8318227">}</span><br>
<span class="lineno"></span><span class="op" id="8318229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">740</span><span class="keyword" id="8318232">func</span>&nbsp;<span class="ident" id="8318237">TestIssue5880</span><span class="op" id="8318250">(</span><span class="ident" id="8318251">t</span>&nbsp;<span class="op" id="8318253">*</span><span class="ident" id="8318254">testing</span><span class="op" id="8318261">.</span><span class="ident" id="8318262">T</span><span class="op" id="8318263">)</span>&nbsp;<span class="op" id="8318265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8318268">type</span>&nbsp;<span class="ident" id="8318273">T</span>&nbsp;<span class="op" id="8318275">[</span><span class="op" id="8318276">]</span><span class="builtintype" id="8318277">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8318283">data</span><span class="op" id="8318287">,</span>&nbsp;<span class="ident" id="8318289">err</span>&nbsp;<span class="op" id="8318293">:=</span>&nbsp;<span class="ident" id="8318296">Marshal</span><span class="op" id="8318303">(</span><span class="ident" id="8318304">T</span><span class="op" id="8318305">{</span><span class="num" id="8318306">192</span><span class="op" id="8318309">,</span>&nbsp;<span class="num" id="8318311">168</span><span class="op" id="8318314">,</span>&nbsp;<span class="num" id="8318316">0</span><span class="op" id="8318317">,</span>&nbsp;<span class="num" id="8318319">1</span><span class="op" id="8318320">}</span><span class="op" id="8318321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8318324">if</span>&nbsp;<span class="ident" id="8318327">err</span>&nbsp;<span class="op" id="8318331">!=</span>&nbsp;<span class="ident" id="8318334">nil</span>&nbsp;<span class="op" id="8318338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8318342">t</span><span class="op" id="8318343">.</span><span class="ident" id="8318344">Errorf</span><span class="op" id="8318350">(</span><span class="string" id="8318351">&#34;Marshal&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8318370">,</span>&nbsp;<span class="ident" id="8318372">err</span><span class="op" id="8318375">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8318378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8318381">if</span>&nbsp;<span class="op" id="8318384">!</span><span class="ident" id="8318385">utf8</span><span class="op" id="8318389">.</span><span class="ident" id="8318390">Valid</span><span class="op" id="8318395">(</span><span class="ident" id="8318396">data</span><span class="op" id="8318400">)</span>&nbsp;<span class="op" id="8318402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8318406">t</span><span class="op" id="8318407">.</span><span class="ident" id="8318408">Errorf</span><span class="op" id="8318414">(</span><span class="string" id="8318415">&#34;Marshal&nbsp;generated&nbsp;invalid&nbsp;UTF-8:&nbsp;%x&#34;</span><span class="op" id="8318452">,</span>&nbsp;<span class="ident" id="8318454">data</span><span class="op" id="8318458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8318461">}</span><br>
<span class="lineno"></span><span class="op" id="8318463">}</span>
</div>
</body>
</html>
